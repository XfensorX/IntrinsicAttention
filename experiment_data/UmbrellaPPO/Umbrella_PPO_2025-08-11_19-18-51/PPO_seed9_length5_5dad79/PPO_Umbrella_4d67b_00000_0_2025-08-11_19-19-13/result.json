{"timers": {"training_iteration": 1.8854656249750406, "restore_env_runners": 1.2166914530098438e-05, "training_step": 1.8853050000034273, "env_runner_sampling_timer": 1.7725479160435498, "learner_update_timer": 0.10947762499563396, "synch_weights": 0.0006251248996704817}, "env_runners": {"num_episodes_lifetime": 31375.0, "env_to_module_connector": {"connector_pipeline_timer": 5.60191129491265e-05, "timers": {"connectors": {"add_observations_from_episodes_to_batch": 3.7658028477973014e-06, "add_time_dim_to_batch_and_zero_pad": 2.968684752054015e-06, "batch_individual_items": 7.916984314529918e-06, "numpy_to_tensor": 1.160138368914904e-05, "add_states_from_episodes_to_batch": 1.925275199336227e-06}}}, "num_episodes": 250.0, "env_step_timer": 2.035229622649957e-05, "episode_len_min": 20, "num_agent_steps_sampled": {"default_agent": 5000.0}, "agent_episode_returns_mean": {"default_agent": 2.740000000000001}, "episode_return_mean": 2.740000000000001, "num_env_steps_sampled": 5000.0, "module_to_env_connector": {"timers": {"connectors": {"remove_single_ts_time_rank_from_batch": 6.795980449470639e-07, "un_batch_to_individual_items": 6.585693717918084e-06, "listify_data_for_vector_env": 1.3651423955869514e-05, "normalize_and_clip_actions": 1.5868679450334362e-05, "get_actions": 5.6509650219430473e-05, "tensor_to_numpy": 1.6584511796191492e-05}}, "connector_pipeline_timer": 0.00014023382560264143}, "episode_duration_sec_mean": 0.005930972022004426, "sample": 0.0075488882074708965, "num_module_steps_sampled_lifetime": {"default_policy": 627500.0}, "env_reset_timer": 0.00010415256038499468, "time_between_sampling": 0.0007962082939677841, "episode_len_max": 20, "weights_seq_no": 0.0, "num_env_steps_sampled_lifetime": 627500.0, "env_to_module_sum_episodes_length_in": 10.191744832559449, "episode_len_mean": 20.0, "module_episode_returns_mean": {"default_policy": 2.740000000000001}, "episode_return_min": -5.5, "episode_return_max": 14.5, "num_agent_steps_sampled_lifetime": {"default_agent": 627500.0}, "rlmodule_inference_timer": 5.8363287702800965e-05, "env_to_module_sum_episodes_length_out": 10.191744832559449, "num_module_steps_sampled": {"default_policy": 5000.0}, "num_env_steps_sampled_lifetime_throughput": 2886.854957516658}, "learners": {"default_policy": {"module_train_batch_size_mean": 1000.0, "vf_explained_var": 0.0010921955108642578, "num_module_steps_trained_lifetime": 6000, "entropy": 0.6885873675346375, "curr_kl_coeff": 0.3732481598854065, "vf_loss_unclipped": 30.640653610229492, "diff_num_grad_updates_vs_sampler_policy": 1.0, "default_optimizer_learning_rate": 0.0002847858517, "total_loss": -0.004588165320456028, "mean_kl_loss": 0.0010491644497960806, "vf_loss": 0.09794427454471588, "gradients_default_optimizer_global_norm": 0.18117614090442657, "weights_seq_no": 1.0, "num_module_steps_trained": 6000, "policy_loss": -0.06464065611362457, "curr_entropy_coeff": 0.0090570820258, "num_trainable_parameters": 6003, "num_module_steps_trained_lifetime_throughput": 412996.8279404707}, "__all_modules__": {"num_module_steps_trained": 6000, "num_trainable_parameters": 6003, "learner_connector_sum_episodes_length_in": 5000, "num_env_steps_trained": 31500, "learner_connector": {"timers": {"connectors": {"batch_individual_items": 0.031639166991226375, "numpy_to_tensor": 7.512501906603575e-05, "add_states_from_episodes_to_batch": 3.625056706368923e-06, "add_observations_from_episodes_to_batch": 0.0008036249782890081, "add_columns_from_episodes_to_train_batch": 0.03500912501476705, "add_time_dim_to_batch_and_zero_pad": 1.6417005099356174e-05, "add_one_ts_to_episodes_and_truncate": 0.0075309580424800515, "general_advantage_estimation": 0.007011124980635941}}, "connector_pipeline_timer": 0.08223466598428786}, "num_module_steps_trained_lifetime": 6000, "learner_connector_sum_episodes_length_out": 5250, "num_env_steps_trained_lifetime": 31500, "num_non_trainable_parameters": 0, "num_env_steps_trained_lifetime_throughput": 2117863.7910316377, "num_module_steps_trained_throughput": 406746.5716241031, "num_module_steps_trained_lifetime_throughput": 405268.63738627086}}, "num_training_step_calls_per_iteration": 1, "num_env_steps_sampled_lifetime": 627500.0, "evaluation": {"env_runners": {"num_env_steps_sampled": 400, "env_to_module_connector": {"timers": {"connectors": {"add_states_from_episodes_to_batch": 1.6448348831131085e-06, "add_observations_from_episodes_to_batch": 3.099777077748491e-06, "add_time_dim_to_batch_and_zero_pad": 2.562274984434618e-06, "batch_individual_items": 6.3787044578748326e-06, "numpy_to_tensor": 8.522162482933221e-06}}, "connector_pipeline_timer": 4.518509321712596e-05}, "episode_len_max": 20, "num_module_steps_sampled_lifetime": {"default_policy": 400}, "rlmodule_inference_timer": 3.0277823859871012e-05, "env_to_module_sum_episodes_length_out": 10.216013141322508, "module_to_env_connector": {"connector_pipeline_timer": 0.00010814560417939854, "timers": {"connectors": {"tensor_to_numpy": 1.4615852928485159e-05, "listify_data_for_vector_env": 1.0847513831143334e-05, "get_actions": 3.9908269078802207e-05, "normalize_and_clip_actions": 1.0867393370142442e-05, "remove_single_ts_time_rank_from_batch": 8.212628210744465e-07, "un_batch_to_individual_items": 5.467603043755786e-06}}}, "episode_len_min": 20, "env_reset_timer": 0.00020904093980789185, "episode_return_max": 15.5, "num_episodes_lifetime": 20, "num_episodes": 20, "episode_return_mean": -0.3, "num_module_steps_sampled": {"default_policy": 400}, "episode_duration_sec_mean": 0.004539683519396931, "sample": 0.09980341698974371, "weights_seq_no": 1.0, "module_episode_returns_mean": {"default_policy": -0.3}, "num_agent_steps_sampled_lifetime": {"default_agent": 400}, "env_step_timer": 1.4318998286288968e-05, "num_agent_steps_sampled": {"default_agent": 400}, "agent_episode_returns_mean": {"default_agent": -0.3}, "num_env_steps_sampled_lifetime": 5400, "env_to_module_sum_episodes_length_in": 10.216013141322508, "episode_len_mean": 20.0, "episode_return_min": -13.5}, "num_healthy_workers": 1, "actor_manager_num_outstanding_async_reqs": 0, "num_remote_worker_restarts": 0}, "fault_tolerance": {"num_healthy_workers": 0, "num_remote_worker_restarts": 0}, "env_runner_group": {"actor_manager_num_outstanding_async_reqs": 0}, "done": false, "training_iteration": 1, "trial_id": "4d67b_00000", "date": "2025-08-11_19-22-19", "timestamp": 1754932939, "time_this_iter_s": 1.9969160556793213, "time_total_s": 1.9969160556793213, "pid": 14356, "hostname": "Mac", "node_ip": "127.0.0.1", "config": {"exploration_config": {}, "extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "placement_strategy": "PACK", "num_gpus": 0, "_fake_gpus": false, "num_cpus_for_main_process": 2, "eager_tracing": true, "eager_max_retraces": 20, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "torch_compile_learner": false, "torch_compile_learner_what_to_compile": "forward_train", "torch_compile_learner_dynamo_backend": "aot_eager", "torch_compile_learner_dynamo_mode": null, "torch_compile_worker": false, "torch_compile_worker_dynamo_backend": "aot_eager", "torch_compile_worker_dynamo_mode": null, "torch_ddp_kwargs": {}, "torch_skip_nan_gradients": false, "env": "Umbrella", "env_config": {}, "observation_space": null, "action_space": null, "clip_rewards": null, "normalize_actions": true, "clip_actions": false, "_is_atari": null, "disable_env_checking": false, "render_env": false, "action_mask_key": "action_mask", "env_runner_cls": null, "num_env_runners": 0, "create_local_env_runner": true, "num_envs_per_env_runner": 1, "gym_env_vectorize_mode": "SYNC", "num_cpus_per_env_runner": 1, "num_gpus_per_env_runner": 0, "custom_resources_per_env_runner": {}, "validate_env_runners_after_construction": true, "episodes_to_numpy": true, "max_requests_in_flight_per_env_runner": 1, "sample_timeout_s": 60.0, "_env_to_module_connector": null, "add_default_connectors_to_env_to_module_pipeline": true, "_module_to_env_connector": null, "add_default_connectors_to_module_to_env_pipeline": true, "merge_env_runner_states": "training_only", "broadcast_env_runner_states": true, "episode_lookback_horizon": 1, "rollout_fragment_length": "auto", "batch_mode": "complete_episodes", "compress_observations": false, "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "enable_tf1_exec_eagerly": false, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "preprocessor_pref": "deepmind", "observation_filter": "NoFilter", "update_worker_filter_stats": true, "use_worker_filter_stats": true, "sampler_perf_stats_ema_coef": null, "_is_online": true, "num_learners": 0, "num_gpus_per_learner": 0, "num_cpus_per_learner": "auto", "num_aggregator_actors_per_learner": 0, "max_requests_in_flight_per_aggregator_actor": 3, "local_gpu_idx": 0, "max_requests_in_flight_per_learner": 3, "gamma": 1, "lr": 0.0002847858517, "grad_clip": 0.5, "grad_clip_by": "global_norm", "_train_batch_size_per_learner": 5000, "train_batch_size": 4000, "num_epochs": 1, "minibatch_size": 1000, "shuffle_batch_per_epoch": true, "model": {"fcnet_hiddens": [256, 256], "fcnet_activation": "tanh", "fcnet_weights_initializer": null, "fcnet_weights_initializer_config": null, "fcnet_bias_initializer": null, "fcnet_bias_initializer_config": null, "conv_filters": null, "conv_activation": "relu", "conv_kernel_initializer": null, "conv_kernel_initializer_config": null, "conv_bias_initializer": null, "conv_bias_initializer_config": null, "conv_transpose_kernel_initializer": null, "conv_transpose_kernel_initializer_config": null, "conv_transpose_bias_initializer": null, "conv_transpose_bias_initializer_config": null, "post_fcnet_hiddens": [], "post_fcnet_activation": "relu", "post_fcnet_weights_initializer": null, "post_fcnet_weights_initializer_config": null, "post_fcnet_bias_initializer": null, "post_fcnet_bias_initializer_config": null, "free_log_std": false, "log_std_clip_param": 20.0, "no_final_linear": false, "vf_share_layers": false, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "lstm_weights_initializer": null, "lstm_weights_initializer_config": null, "lstm_bias_initializer": null, "lstm_bias_initializer_config": null, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "attention_use_n_prev_actions": 0, "attention_use_n_prev_rewards": 0, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": null, "custom_model_config": {}, "custom_action_dist": null, "custom_preprocessor": null, "encoder_latent_dim": null, "always_check_shapes": false, "lstm_use_prev_action_reward": -1, "_use_default_native_models": -1, "_disable_preprocessor_api": false, "_disable_action_flattening": false}, "_learner_connector": null, "add_default_connectors_to_learner_pipeline": true, "learner_config_dict": {}, "optimizer": {}, "_learner_class": null, "callbacks_on_algorithm_init": null, "callbacks_on_env_runners_recreated": null, "callbacks_on_offline_eval_runners_recreated": null, "callbacks_on_checkpoint_loaded": null, "callbacks_on_environment_created": null, "callbacks_on_episode_created": null, "callbacks_on_episode_start": null, "callbacks_on_episode_step": null, "callbacks_on_episode_end": null, "callbacks_on_evaluate_start": null, "callbacks_on_evaluate_end": null, "callbacks_on_evaluate_offline_start": null, "callbacks_on_evaluate_offline_end": null, "callbacks_on_sample_end": null, "callbacks_on_train_result": null, "explore": true, "enable_rl_module_and_learner": true, "enable_env_runner_and_connector_v2": true, "_prior_exploration_config": {"type": "StochasticSampling"}, "count_steps_by": "env_steps", "policy_map_capacity": 100, "policy_mapping_fn": "<function AlgorithmConfig.DEFAULT_POLICY_MAPPING_FN at 0x385aedb20>", "policies_to_train": null, "policy_states_are_swappable": false, "observation_fn": null, "offline_data_class": null, "input_read_method": "read_parquet", "input_read_method_kwargs": {}, "input_read_schema": {}, "input_read_episodes": false, "input_read_sample_batches": false, "input_read_batch_size": null, "input_filesystem": null, "input_filesystem_kwargs": {}, "input_compress_columns": ["obs", "new_obs"], "input_spaces_jsonable": true, "materialize_data": false, "materialize_mapped_data": true, "map_batches_kwargs": {}, "iter_batches_kwargs": {}, "ignore_final_observation": false, "prelearner_class": null, "prelearner_buffer_class": null, "prelearner_buffer_kwargs": {}, "prelearner_module_synch_period": 10, "dataset_num_iters_per_learner": null, "input_config": {}, "actions_in_input_normalized": false, "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_config": {}, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "output_max_rows_per_file": null, "output_write_remaining_data": false, "output_write_method": "write_parquet", "output_write_method_kwargs": {}, "output_filesystem": null, "output_filesystem_kwargs": {}, "output_write_episodes": true, "offline_sampling": false, "evaluation_interval": 1, "evaluation_duration": 20, "evaluation_duration_unit": "episodes", "evaluation_sample_timeout_s": 120.0, "evaluation_auto_duration_min_env_steps_per_sample": 100, "evaluation_auto_duration_max_env_steps_per_sample": 2000, "evaluation_parallel_to_training": false, "evaluation_force_reset_envs_before_iteration": true, "evaluation_config": null, "off_policy_estimation_methods": {}, "ope_split_batch_by_episode": true, "evaluation_num_env_runners": 1, "in_evaluation": false, "sync_filters_on_rollout_workers_timeout_s": 10.0, "offline_evaluation_interval": null, "num_offline_eval_runners": 0, "offline_loss_for_module_fn": null, "offline_evaluation_duration": 1, "offline_evaluation_parallel_to_training": false, "offline_evaluation_timeout_s": 120.0, "num_cpus_per_offline_eval_runner": 1, "num_gpus_per_offline_eval_runner": 0, "custom_resources_per_offline_eval_runner": {}, "restart_failed_offline_eval_runners": true, "ignore_offline_eval_runner_failures": false, "max_num_offline_eval_runner_restarts": 1000, "offline_eval_runner_restore_timeout_s": 1800.0, "max_requests_in_flight_per_offline_eval_runner": 1, "validate_offline_eval_runners_after_construction": true, "offline_eval_runner_health_probe_timeout_s": 30.0, "offline_eval_rl_module_inference_only": false, "broadcast_offline_eval_runner_states": false, "offline_eval_batch_size_per_runner": 256, "dataset_num_iters_per_eval_runner": 1, "keep_per_episode_custom_metrics": false, "metrics_episode_collection_timeout_s": 60.0, "metrics_num_episodes_for_smoothing": 100, "min_time_s_per_iteration": null, "min_train_timesteps_per_iteration": 0, "min_sample_timesteps_per_iteration": 0, "log_gradients": true, "export_native_model_files": false, "checkpoint_trainable_policies_only": false, "logger_creator": null, "logger_config": null, "log_level": "WARN", "log_sys_usage": true, "fake_sampler": false, "seed": 9, "restart_failed_env_runners": true, "ignore_env_runner_failures": false, "max_num_env_runner_restarts": 1000, "delay_between_env_runner_restarts_s": 60.0, "restart_failed_sub_environments": false, "num_consecutive_env_runner_failures_tolerance": 100, "env_runner_health_probe_timeout_s": 30.0, "env_runner_restore_timeout_s": 1800.0, "_model_config": {}, "_rl_module_spec": "RLModuleSpec(module_class=None, observation_space=None, action_space=None, inference_only=False, learner_only=False, model_config=DefaultModelConfig(fcnet_hiddens=[60, 90], fcnet_activation='tanh', fcnet_kernel_initializer=None, fcnet_kernel_initializer_kwargs=None, fcnet_bias_initializer=None, fcnet_bias_initializer_kwargs=None, conv_filters=None, conv_activation='relu', conv_kernel_initializer=None, conv_kernel_initializer_kwargs=None, conv_bias_initializer=None, conv_bias_initializer_kwargs=None, head_fcnet_hiddens=[], head_fcnet_activation='relu', head_fcnet_kernel_initializer=None, head_fcnet_kernel_initializer_kwargs=None, head_fcnet_bias_initializer=None, head_fcnet_bias_initializer_kwargs=None, free_log_std=False, log_std_clip_param=20.0, vf_share_layers=True, use_lstm=False, max_seq_len=20, lstm_cell_size=256, lstm_use_prev_action=False, lstm_use_prev_reward=False, lstm_kernel_initializer=None, lstm_kernel_initializer_kwargs=None, lstm_bias_initializer=None, lstm_bias_initializer_kwargs=None), catalog_class=None, load_state_path=None, model_config_dict=None)", "algorithm_config_overrides_per_module": {}, "_per_module_overrides": {}, "_validate_config": true, "_use_msgpack_checkpoints": false, "_torch_grad_scaler_class": null, "_torch_lr_scheduler_classes": null, "_tf_policy_handles_more_than_one_loss": false, "_disable_preprocessor_api": false, "_disable_action_flattening": false, "_disable_initialize_loss_from_dummy_batch": false, "_dont_auto_sync_env_runner_states": false, "env_task_fn": -1, "enable_connectors": -1, "simple_optimizer": false, "policy_map_cache": -1, "worker_cls": -1, "synchronize_filters": -1, "enable_async_evaluation": -1, "custom_async_evaluation_function": -1, "_enable_rl_module_api": -1, "auto_wrap_old_gym_envs": -1, "always_attach_evaluation_results": -1, "replay_sequence_length": null, "_disable_execution_plan_api": -1, "use_critic": true, "use_gae": true, "use_kl_loss": true, "kl_coeff": 0.7464963036515, "kl_target": 0.0270990929592, "vf_loss_coeff": 0.6688075857018, "entropy_coeff": 0.0090570820258, "clip_param": 0.1221781641624, "vf_clip_param": 0.1027808522125, "entropy_coeff_schedule": null, "lr_schedule": null, "sgd_minibatch_size": -1, "vf_share_layers": -1, "__stdout_file__": null, "__stderr_file__": null, "lambda": 0.9099046732075, "input": "sampler", "policies": {"default_policy": [null, null, null, null]}, "callbacks": "<class 'ray.rllib.callbacks.callbacks.RLlibCallback'>", "create_env_on_driver": false, "custom_eval_function": null, "framework": "torch"}, "time_since_restore": 1.9969160556793213, "iterations_since_restore": 1, "perf": {"cpu_util_percent": 17.433333333333334, "ram_util_percent": 78.60000000000001}}
{"timers": {"training_iteration": 1.8828136562253348, "restore_env_runners": 1.211232622154057e-05, "training_step": 1.8826526633428875, "env_runner_sampling_timer": 1.7691403231339062, "learner_update_timer": 0.1102334866556339, "synch_weights": 0.0006245603214483708, "restore_eval_env_runners": 9.584007784724236e-06, "evaluation_iteration": 0.1097533330321312, "synch_eval_env_connectors": 0.00013924995437264442, "synch_env_connectors": 4.625064320862293e-06}, "env_runners": {"num_episodes_lifetime": 500.0, "env_to_module_connector": {"connector_pipeline_timer": 4.509528147876847e-05, "timers": {"connectors": {"add_observations_from_episodes_to_batch": 3.035728477396272e-06, "add_time_dim_to_batch_and_zero_pad": 2.474470333820735e-06, "batch_individual_items": 6.580724670285467e-06, "numpy_to_tensor": 9.078072605015989e-06, "add_states_from_episodes_to_batch": 1.7564977524217768e-06}}}, "num_episodes": 250.0, "env_step_timer": 1.4348343179187147e-05, "episode_len_min": 20, "num_agent_steps_sampled": {"default_agent": 5000.0}, "agent_episode_returns_mean": {"default_agent": 4.5}, "episode_return_mean": 4.5, "num_env_steps_sampled": 5000.0, "module_to_env_connector": {"timers": {"connectors": {"remove_single_ts_time_rank_from_batch": 6.053035622044106e-07, "un_batch_to_individual_items": 5.564265462525701e-06, "listify_data_for_vector_env": 1.1520707496569444e-05, "normalize_and_clip_actions": 9.780190833199899e-06, "get_actions": 4.0604192483471646e-05, "tensor_to_numpy": 1.3634049169971456e-05}}, "connector_pipeline_timer": 0.00010767600008004494}, "episode_duration_sec_mean": 0.004705506342928857, "sample": 0.005795406216141539, "num_module_steps_sampled_lifetime": {"default_policy": 10000.0}, "env_reset_timer": 4.95644437683381e-05, "time_between_sampling": 0.0015819681302977815, "episode_len_max": 20, "weights_seq_no": 1.0, "num_env_steps_sampled_lifetime": 10000.0, "env_to_module_sum_episodes_length_in": 10.36823839457432, "episode_len_mean": 20.0, "module_episode_returns_mean": {"default_policy": 4.5}, "episode_return_min": -5.5, "episode_return_max": 14.5, "num_agent_steps_sampled_lifetime": {"default_agent": 10000.0}, "rlmodule_inference_timer": 2.932891247632248e-05, "env_to_module_sum_episodes_length_out": 10.36823839457432, "num_module_steps_sampled": {"default_policy": 5000.0}, "num_env_steps_sampled_lifetime_throughput": 3556.917396478511}, "learners": {"default_policy": {"module_train_batch_size_mean": 1000.0, "vf_explained_var": 7.56978988647461e-05, "num_module_steps_trained_lifetime": 12000, "entropy": 0.691445529460907, "curr_kl_coeff": 0.18662407994270325, "vf_loss_unclipped": 32.4010124206543, "diff_num_grad_updates_vs_sampler_policy": 1.0, "default_optimizer_learning_rate": 0.0002847858517, "total_loss": -0.019843995571136475, "mean_kl_loss": 0.0011109872721135616, "vf_loss": 0.09875519573688507, "gradients_default_optimizer_global_norm": 0.04752764850854874, "weights_seq_no": 2.0, "num_module_steps_trained": 6000, "policy_loss": -0.08004441857337952, "curr_entropy_coeff": 0.0090570820258, "num_trainable_parameters": 6003, "num_module_steps_trained_lifetime_throughput": 412925.259681057}, "__all_modules__": {"num_module_steps_trained": 6000, "num_trainable_parameters": 6003, "learner_connector_sum_episodes_length_in": 5000.0, "num_env_steps_trained": 31500, "learner_connector": {"timers": {"connectors": {"batch_individual_items": 0.03255079574184492, "numpy_to_tensor": 7.508001872338354e-05, "add_states_from_episodes_to_batch": 3.630466526374221e-06, "add_observations_from_episodes_to_batch": 0.0008034545683767646, "add_columns_from_episodes_to_train_batch": 0.0349992412654683, "add_time_dim_to_batch_and_zero_pad": 1.6390745295211675e-05, "add_one_ts_to_episodes_and_truncate": 0.007530230962438509, "general_advantage_estimation": 0.006998128730338067}}, "connector_pipeline_timer": 0.08312203682377003}, "num_module_steps_trained_lifetime": 12000, "learner_connector_sum_episodes_length_out": 5250.0, "num_env_steps_trained_lifetime": 63000, "num_non_trainable_parameters": 0, "num_env_steps_trained_lifetime_throughput": 2118204.544840213, "num_module_steps_trained_throughput": 406767.6263116256, "num_module_steps_trained_lifetime_throughput": 405307.7335971161}}, "num_training_step_calls_per_iteration": 1, "evaluation": {"env_runners": {"num_env_steps_sampled": 400, "env_to_module_connector": {"timers": {"connectors": {"add_states_from_episodes_to_batch": 1.6102616944257222e-06, "add_observations_from_episodes_to_batch": 2.8649440470502054e-06, "add_time_dim_to_batch_and_zero_pad": 2.3944417192082097e-06, "batch_individual_items": 6.26272152924714e-06, "numpy_to_tensor": 8.6692359786996e-06}}, "connector_pipeline_timer": 4.345268165768209e-05}, "episode_len_max": 20, "num_module_steps_sampled_lifetime": {"default_policy": 800}, "rlmodule_inference_timer": 2.841741805945732e-05, "env_to_module_sum_episodes_length_out": 10.366003441359926, "module_to_env_connector": {"connector_pipeline_timer": 0.00010352582005693272, "timers": {"connectors": {"tensor_to_numpy": 1.3298854012062745e-05, "listify_data_for_vector_env": 1.1631001859425993e-05, "get_actions": 3.695803433740478e-05, "normalize_and_clip_actions": 9.795727886904852e-06, "remove_single_ts_time_rank_from_batch": 6.026679498234356e-07, "un_batch_to_individual_items": 5.433235000995918e-06}}}, "episode_len_min": 20, "env_reset_timer": 0.0002076817804481834, "episode_return_max": 15.5, "num_episodes_lifetime": 40, "num_episodes": 20, "episode_return_mean": -1.3, "num_module_steps_sampled": {"default_policy": 400}, "episode_duration_sec_mean": 0.004657021016464568, "sample": 0.09984912948915735, "weights_seq_no": 2.0, "module_episode_returns_mean": {"default_policy": -1.3}, "num_agent_steps_sampled_lifetime": {"default_agent": 800}, "env_step_timer": 1.4731870346636235e-05, "num_agent_steps_sampled": {"default_agent": 400}, "agent_episode_returns_mean": {"default_agent": -1.3}, "num_env_steps_sampled_lifetime": 10400, "env_to_module_sum_episodes_length_in": 10.366003441359926, "episode_len_mean": 20.0, "episode_return_min": -13.5, "time_between_sampling": 1.6464580000611022}, "num_healthy_workers": 1, "actor_manager_num_outstanding_async_reqs": 0, "num_remote_worker_restarts": 0}, "num_env_steps_sampled_lifetime": 10000.0, "fault_tolerance": {"num_healthy_workers": 0, "num_remote_worker_restarts": 0}, "env_runner_group": {"actor_manager_num_outstanding_async_reqs": 0}, "done": false, "training_iteration": 2, "trial_id": "4d67b_00000", "date": "2025-08-11_19-22-21", "timestamp": 1754932941, "time_this_iter_s": 1.7320709228515625, "time_total_s": 3.728986978530884, "pid": 14356, "hostname": "Mac", "node_ip": "127.0.0.1", "config": {"exploration_config": {}, "extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "placement_strategy": "PACK", "num_gpus": 0, "_fake_gpus": false, "num_cpus_for_main_process": 2, "eager_tracing": true, "eager_max_retraces": 20, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "torch_compile_learner": false, "torch_compile_learner_what_to_compile": "forward_train", "torch_compile_learner_dynamo_backend": "aot_eager", "torch_compile_learner_dynamo_mode": null, "torch_compile_worker": false, "torch_compile_worker_dynamo_backend": "aot_eager", "torch_compile_worker_dynamo_mode": null, "torch_ddp_kwargs": {}, "torch_skip_nan_gradients": false, "env": "Umbrella", "env_config": {}, "observation_space": null, "action_space": null, "clip_rewards": null, "normalize_actions": true, "clip_actions": false, "_is_atari": null, "disable_env_checking": false, "render_env": false, "action_mask_key": "action_mask", "env_runner_cls": null, "num_env_runners": 0, "create_local_env_runner": true, "num_envs_per_env_runner": 1, "gym_env_vectorize_mode": "SYNC", "num_cpus_per_env_runner": 1, "num_gpus_per_env_runner": 0, "custom_resources_per_env_runner": {}, "validate_env_runners_after_construction": true, "episodes_to_numpy": true, "max_requests_in_flight_per_env_runner": 1, "sample_timeout_s": 60.0, "_env_to_module_connector": null, "add_default_connectors_to_env_to_module_pipeline": true, "_module_to_env_connector": null, "add_default_connectors_to_module_to_env_pipeline": true, "merge_env_runner_states": "training_only", "broadcast_env_runner_states": true, "episode_lookback_horizon": 1, "rollout_fragment_length": "auto", "batch_mode": "complete_episodes", "compress_observations": false, "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "enable_tf1_exec_eagerly": false, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "preprocessor_pref": "deepmind", "observation_filter": "NoFilter", "update_worker_filter_stats": true, "use_worker_filter_stats": true, "sampler_perf_stats_ema_coef": null, "_is_online": true, "num_learners": 0, "num_gpus_per_learner": 0, "num_cpus_per_learner": "auto", "num_aggregator_actors_per_learner": 0, "max_requests_in_flight_per_aggregator_actor": 3, "local_gpu_idx": 0, "max_requests_in_flight_per_learner": 3, "gamma": 1, "lr": 0.0002847858517, "grad_clip": 0.5, "grad_clip_by": "global_norm", "_train_batch_size_per_learner": 5000, "train_batch_size": 4000, "num_epochs": 1, "minibatch_size": 1000, "shuffle_batch_per_epoch": true, "model": {"fcnet_hiddens": [256, 256], "fcnet_activation": "tanh", "fcnet_weights_initializer": null, "fcnet_weights_initializer_config": null, "fcnet_bias_initializer": null, "fcnet_bias_initializer_config": null, "conv_filters": null, "conv_activation": "relu", "conv_kernel_initializer": null, "conv_kernel_initializer_config": null, "conv_bias_initializer": null, "conv_bias_initializer_config": null, "conv_transpose_kernel_initializer": null, "conv_transpose_kernel_initializer_config": null, "conv_transpose_bias_initializer": null, "conv_transpose_bias_initializer_config": null, "post_fcnet_hiddens": [], "post_fcnet_activation": "relu", "post_fcnet_weights_initializer": null, "post_fcnet_weights_initializer_config": null, "post_fcnet_bias_initializer": null, "post_fcnet_bias_initializer_config": null, "free_log_std": false, "log_std_clip_param": 20.0, "no_final_linear": false, "vf_share_layers": false, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "lstm_weights_initializer": null, "lstm_weights_initializer_config": null, "lstm_bias_initializer": null, "lstm_bias_initializer_config": null, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "attention_use_n_prev_actions": 0, "attention_use_n_prev_rewards": 0, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": null, "custom_model_config": {}, "custom_action_dist": null, "custom_preprocessor": null, "encoder_latent_dim": null, "always_check_shapes": false, "lstm_use_prev_action_reward": -1, "_use_default_native_models": -1, "_disable_preprocessor_api": false, "_disable_action_flattening": false}, "_learner_connector": null, "add_default_connectors_to_learner_pipeline": true, "learner_config_dict": {}, "optimizer": {}, "_learner_class": null, "callbacks_on_algorithm_init": null, "callbacks_on_env_runners_recreated": null, "callbacks_on_offline_eval_runners_recreated": null, "callbacks_on_checkpoint_loaded": null, "callbacks_on_environment_created": null, "callbacks_on_episode_created": null, "callbacks_on_episode_start": null, "callbacks_on_episode_step": null, "callbacks_on_episode_end": null, "callbacks_on_evaluate_start": null, "callbacks_on_evaluate_end": null, "callbacks_on_evaluate_offline_start": null, "callbacks_on_evaluate_offline_end": null, "callbacks_on_sample_end": null, "callbacks_on_train_result": null, "explore": true, "enable_rl_module_and_learner": true, "enable_env_runner_and_connector_v2": true, "_prior_exploration_config": {"type": "StochasticSampling"}, "count_steps_by": "env_steps", "policy_map_capacity": 100, "policy_mapping_fn": "<function AlgorithmConfig.DEFAULT_POLICY_MAPPING_FN at 0x385aedb20>", "policies_to_train": null, "policy_states_are_swappable": false, "observation_fn": null, "offline_data_class": null, "input_read_method": "read_parquet", "input_read_method_kwargs": {}, "input_read_schema": {}, "input_read_episodes": false, "input_read_sample_batches": false, "input_read_batch_size": null, "input_filesystem": null, "input_filesystem_kwargs": {}, "input_compress_columns": ["obs", "new_obs"], "input_spaces_jsonable": true, "materialize_data": false, "materialize_mapped_data": true, "map_batches_kwargs": {}, "iter_batches_kwargs": {}, "ignore_final_observation": false, "prelearner_class": null, "prelearner_buffer_class": null, "prelearner_buffer_kwargs": {}, "prelearner_module_synch_period": 10, "dataset_num_iters_per_learner": null, "input_config": {}, "actions_in_input_normalized": false, "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_config": {}, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "output_max_rows_per_file": null, "output_write_remaining_data": false, "output_write_method": "write_parquet", "output_write_method_kwargs": {}, "output_filesystem": null, "output_filesystem_kwargs": {}, "output_write_episodes": true, "offline_sampling": false, "evaluation_interval": 1, "evaluation_duration": 20, "evaluation_duration_unit": "episodes", "evaluation_sample_timeout_s": 120.0, "evaluation_auto_duration_min_env_steps_per_sample": 100, "evaluation_auto_duration_max_env_steps_per_sample": 2000, "evaluation_parallel_to_training": false, "evaluation_force_reset_envs_before_iteration": true, "evaluation_config": null, "off_policy_estimation_methods": {}, "ope_split_batch_by_episode": true, "evaluation_num_env_runners": 1, "in_evaluation": false, "sync_filters_on_rollout_workers_timeout_s": 10.0, "offline_evaluation_interval": null, "num_offline_eval_runners": 0, "offline_loss_for_module_fn": null, "offline_evaluation_duration": 1, "offline_evaluation_parallel_to_training": false, "offline_evaluation_timeout_s": 120.0, "num_cpus_per_offline_eval_runner": 1, "num_gpus_per_offline_eval_runner": 0, "custom_resources_per_offline_eval_runner": {}, "restart_failed_offline_eval_runners": true, "ignore_offline_eval_runner_failures": false, "max_num_offline_eval_runner_restarts": 1000, "offline_eval_runner_restore_timeout_s": 1800.0, "max_requests_in_flight_per_offline_eval_runner": 1, "validate_offline_eval_runners_after_construction": true, "offline_eval_runner_health_probe_timeout_s": 30.0, "offline_eval_rl_module_inference_only": false, "broadcast_offline_eval_runner_states": false, "offline_eval_batch_size_per_runner": 256, "dataset_num_iters_per_eval_runner": 1, "keep_per_episode_custom_metrics": false, "metrics_episode_collection_timeout_s": 60.0, "metrics_num_episodes_for_smoothing": 100, "min_time_s_per_iteration": null, "min_train_timesteps_per_iteration": 0, "min_sample_timesteps_per_iteration": 0, "log_gradients": true, "export_native_model_files": false, "checkpoint_trainable_policies_only": false, "logger_creator": null, "logger_config": null, "log_level": "WARN", "log_sys_usage": true, "fake_sampler": false, "seed": 9, "restart_failed_env_runners": true, "ignore_env_runner_failures": false, "max_num_env_runner_restarts": 1000, "delay_between_env_runner_restarts_s": 60.0, "restart_failed_sub_environments": false, "num_consecutive_env_runner_failures_tolerance": 100, "env_runner_health_probe_timeout_s": 30.0, "env_runner_restore_timeout_s": 1800.0, "_model_config": {}, "_rl_module_spec": "RLModuleSpec(module_class=None, observation_space=None, action_space=None, inference_only=False, learner_only=False, model_config=DefaultModelConfig(fcnet_hiddens=[60, 90], fcnet_activation='tanh', fcnet_kernel_initializer=None, fcnet_kernel_initializer_kwargs=None, fcnet_bias_initializer=None, fcnet_bias_initializer_kwargs=None, conv_filters=None, conv_activation='relu', conv_kernel_initializer=None, conv_kernel_initializer_kwargs=None, conv_bias_initializer=None, conv_bias_initializer_kwargs=None, head_fcnet_hiddens=[], head_fcnet_activation='relu', head_fcnet_kernel_initializer=None, head_fcnet_kernel_initializer_kwargs=None, head_fcnet_bias_initializer=None, head_fcnet_bias_initializer_kwargs=None, free_log_std=False, log_std_clip_param=20.0, vf_share_layers=True, use_lstm=False, max_seq_len=20, lstm_cell_size=256, lstm_use_prev_action=False, lstm_use_prev_reward=False, lstm_kernel_initializer=None, lstm_kernel_initializer_kwargs=None, lstm_bias_initializer=None, lstm_bias_initializer_kwargs=None), catalog_class=None, load_state_path=None, model_config_dict=None)", "algorithm_config_overrides_per_module": {}, "_per_module_overrides": {}, "_validate_config": true, "_use_msgpack_checkpoints": false, "_torch_grad_scaler_class": null, "_torch_lr_scheduler_classes": null, "_tf_policy_handles_more_than_one_loss": false, "_disable_preprocessor_api": false, "_disable_action_flattening": false, "_disable_initialize_loss_from_dummy_batch": false, "_dont_auto_sync_env_runner_states": false, "env_task_fn": -1, "enable_connectors": -1, "simple_optimizer": false, "policy_map_cache": -1, "worker_cls": -1, "synchronize_filters": -1, "enable_async_evaluation": -1, "custom_async_evaluation_function": -1, "_enable_rl_module_api": -1, "auto_wrap_old_gym_envs": -1, "always_attach_evaluation_results": -1, "replay_sequence_length": null, "_disable_execution_plan_api": -1, "use_critic": true, "use_gae": true, "use_kl_loss": true, "kl_coeff": 0.7464963036515, "kl_target": 0.0270990929592, "vf_loss_coeff": 0.6688075857018, "entropy_coeff": 0.0090570820258, "clip_param": 0.1221781641624, "vf_clip_param": 0.1027808522125, "entropy_coeff_schedule": null, "lr_schedule": null, "sgd_minibatch_size": -1, "vf_share_layers": -1, "__stdout_file__": null, "__stderr_file__": null, "lambda": 0.9099046732075, "input": "sampler", "policies": {"default_policy": [null, null, null, null]}, "callbacks": "<class 'ray.rllib.callbacks.callbacks.RLlibCallback'>", "create_env_on_driver": false, "custom_eval_function": null, "framework": "torch"}, "time_since_restore": 3.728986978530884, "iterations_since_restore": 2, "perf": {"cpu_util_percent": 29.833333333333332, "ram_util_percent": 78.93333333333334}}
{"timers": {"training_iteration": 1.8802074563329807, "restore_env_runners": 1.2062032369431107e-05, "training_step": 1.8800462308787158, "env_runner_sampling_timer": 1.766732081572071, "learner_update_timer": 0.11003660178950522, "synch_weights": 0.0006240417979308404, "restore_eval_env_runners": 9.576077573001385e-06, "evaluation_iteration": 0.10975292220129632, "synch_eval_env_connectors": 0.00013889912515878676, "synch_env_connectors": 4.622983979061246e-06}, "env_runners": {"num_episodes_lifetime": -30375.0, "env_to_module_connector": {"connector_pipeline_timer": 4.8037960009906234e-05, "timers": {"connectors": {"add_observations_from_episodes_to_batch": 3.2471575172621338e-06, "add_time_dim_to_batch_and_zero_pad": 2.6597156459717107e-06, "batch_individual_items": 7.143897603386506e-06, "numpy_to_tensor": 9.876074512061706e-06, "add_states_from_episodes_to_batch": 1.8336069377361055e-06}}}, "num_episodes": 250.0, "env_step_timer": 1.5631861995621746e-05, "episode_len_min": 20, "num_agent_steps_sampled": {"default_agent": 5000.0}, "agent_episode_returns_mean": {"default_agent": 5.460000000000001}, "episode_return_mean": 5.460000000000001, "num_env_steps_sampled": 5000.0, "module_to_env_connector": {"timers": {"connectors": {"remove_single_ts_time_rank_from_batch": 6.338923184390605e-07, "un_batch_to_individual_items": 5.942190442615744e-06, "listify_data_for_vector_env": 1.2313955943501922e-05, "normalize_and_clip_actions": 1.0298932784374444e-05, "get_actions": 4.423772464309294e-05, "tensor_to_numpy": 1.4585938510377366e-05}}, "connector_pipeline_timer": 0.00011534936023683098}, "episode_duration_sec_mean": 0.005037986974231899, "sample": 0.00541303880601456, "num_module_steps_sampled_lifetime": {"default_policy": -607500.0}, "env_reset_timer": 4.495727165068547e-05, "time_between_sampling": 0.0019168249534118678, "episode_len_max": 20, "weights_seq_no": 2.0, "num_env_steps_sampled_lifetime": -607500.0, "env_to_module_sum_episodes_length_in": 10.36823839457432, "episode_len_mean": 20.0, "module_episode_returns_mean": {"default_policy": 5.460000000000001}, "episode_return_min": -5.5, "episode_return_max": 14.5, "num_agent_steps_sampled_lifetime": {"default_agent": -607500.0}, "rlmodule_inference_timer": 3.067405899492959e-05, "env_to_module_sum_episodes_length_out": 10.36823839457432, "num_module_steps_sampled": {"default_policy": 5000.0}, "num_env_steps_sampled_lifetime_throughput": 3378.7662057656285}, "learners": {"default_policy": {"module_train_batch_size_mean": 1000.0, "vf_explained_var": 0.0010613203048706055, "num_module_steps_trained_lifetime": 18000, "entropy": 0.6914345622062683, "curr_kl_coeff": 0.09331203997135162, "vf_loss_unclipped": 30.6032657623291, "diff_num_grad_updates_vs_sampler_policy": 1.0, "default_optimizer_learning_rate": 0.0002847858517, "total_loss": 0.24234046041965485, "mean_kl_loss": 0.0013817347353324294, "vf_loss": 0.09795084595680237, "gradients_default_optimizer_global_norm": 0.1847822666168213, "weights_seq_no": 3.0, "num_module_steps_trained": 6000, "policy_loss": 0.1828346997499466, "curr_entropy_coeff": 0.0090570820258, "num_trainable_parameters": 6003, "num_module_steps_trained_lifetime_throughput": 413716.53673995927}, "__all_modules__": {"num_module_steps_trained": 6000, "num_trainable_parameters": 6003, "learner_connector_sum_episodes_length_in": 5000.0, "num_env_steps_trained": 31500, "learner_connector": {"timers": {"connectors": {"batch_individual_items": 0.03252407944372389, "numpy_to_tensor": 7.488588866544887e-05, "add_states_from_episodes_to_batch": 3.62416208954528e-06, "add_observations_from_episodes_to_batch": 0.0008038033624296076, "add_columns_from_episodes_to_train_batch": 0.034991907602828, "add_time_dim_to_batch_and_zero_pad": 1.6343917895574123e-05, "add_one_ts_to_episodes_and_truncate": 0.007531690323457587, "general_advantage_estimation": 0.006980793692567386}}, "connector_pipeline_timer": 0.0830715947953635}, "num_module_steps_trained_lifetime": 18000, "learner_connector_sum_episodes_length_out": 5250.0, "num_env_steps_trained_lifetime": 94500, "num_non_trainable_parameters": 0, "num_env_steps_trained_lifetime_throughput": 2123530.7836532053, "num_module_steps_trained_throughput": 407712.58741422696, "num_module_steps_trained_lifetime_throughput": 406281.64683814184}}, "num_training_step_calls_per_iteration": 1, "evaluation": {"env_runners": {"num_env_steps_sampled": 400, "env_to_module_connector": {"timers": {"connectors": {"add_states_from_episodes_to_batch": 1.6137167826952823e-06, "add_observations_from_episodes_to_batch": 2.7879503465791485e-06, "add_time_dim_to_batch_and_zero_pad": 2.3129276409364472e-06, "batch_individual_items": 6.0173961178704724e-06, "numpy_to_tensor": 8.081539530378573e-06}}, "connector_pipeline_timer": 4.18225471578847e-05}, "episode_len_max": 20, "num_module_steps_sampled_lifetime": {"default_policy": 1200}, "rlmodule_inference_timer": 2.6670630540558613e-05, "env_to_module_sum_episodes_length_out": 10.368205581254823, "module_to_env_connector": {"connector_pipeline_timer": 9.732126796488483e-05, "timers": {"connectors": {"tensor_to_numpy": 1.2605380309799419e-05, "listify_data_for_vector_env": 1.0571155479322643e-05, "get_actions": 3.416888293617238e-05, "normalize_and_clip_actions": 9.130829532020222e-06, "remove_single_ts_time_rank_from_batch": 5.69512304603902e-07, "un_batch_to_individual_items": 5.268395029050925e-06}}}, "episode_len_min": 20, "env_reset_timer": 0.0002064078721334226, "episode_return_max": 15.5, "num_episodes_lifetime": 60, "num_episodes": 20, "episode_return_mean": -0.6333333333333333, "num_module_steps_sampled": {"default_policy": 400}, "episode_duration_sec_mean": 0.00457948829474238, "sample": 0.09981504194510635, "weights_seq_no": 3.0, "module_episode_returns_mean": {"default_policy": -0.6333333333333333}, "num_agent_steps_sampled_lifetime": {"default_agent": 1200}, "env_step_timer": 1.358009780818236e-05, "num_agent_steps_sampled": {"default_agent": 400}, "agent_episode_returns_mean": {"default_agent": -0.6333333333333333}, "num_env_steps_sampled_lifetime": 15400, "env_to_module_sum_episodes_length_in": 10.368205581254823, "episode_len_mean": 20.0, "episode_return_min": -13.5, "time_between_sampling": 1.646402400890365}, "num_healthy_workers": 1, "actor_manager_num_outstanding_async_reqs": 0, "num_remote_worker_restarts": 0}, "num_env_steps_sampled_lifetime": -607500.0, "fault_tolerance": {"num_healthy_workers": 0, "num_remote_worker_restarts": 0}, "env_runner_group": {"actor_manager_num_outstanding_async_reqs": 0}, "done": false, "training_iteration": 3, "trial_id": "4d67b_00000", "date": "2025-08-11_19-22-23", "timestamp": 1754932943, "time_this_iter_s": 1.7253501415252686, "time_total_s": 5.454337120056152, "pid": 14356, "hostname": "Mac", "node_ip": "127.0.0.1", "config": {"exploration_config": {}, "extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "placement_strategy": "PACK", "num_gpus": 0, "_fake_gpus": false, "num_cpus_for_main_process": 2, "eager_tracing": true, "eager_max_retraces": 20, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "torch_compile_learner": false, "torch_compile_learner_what_to_compile": "forward_train", "torch_compile_learner_dynamo_backend": "aot_eager", "torch_compile_learner_dynamo_mode": null, "torch_compile_worker": false, "torch_compile_worker_dynamo_backend": "aot_eager", "torch_compile_worker_dynamo_mode": null, "torch_ddp_kwargs": {}, "torch_skip_nan_gradients": false, "env": "Umbrella", "env_config": {}, "observation_space": null, "action_space": null, "clip_rewards": null, "normalize_actions": true, "clip_actions": false, "_is_atari": null, "disable_env_checking": false, "render_env": false, "action_mask_key": "action_mask", "env_runner_cls": null, "num_env_runners": 0, "create_local_env_runner": true, "num_envs_per_env_runner": 1, "gym_env_vectorize_mode": "SYNC", "num_cpus_per_env_runner": 1, "num_gpus_per_env_runner": 0, "custom_resources_per_env_runner": {}, "validate_env_runners_after_construction": true, "episodes_to_numpy": true, "max_requests_in_flight_per_env_runner": 1, "sample_timeout_s": 60.0, "_env_to_module_connector": null, "add_default_connectors_to_env_to_module_pipeline": true, "_module_to_env_connector": null, "add_default_connectors_to_module_to_env_pipeline": true, "merge_env_runner_states": "training_only", "broadcast_env_runner_states": true, "episode_lookback_horizon": 1, "rollout_fragment_length": "auto", "batch_mode": "complete_episodes", "compress_observations": false, "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "enable_tf1_exec_eagerly": false, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "preprocessor_pref": "deepmind", "observation_filter": "NoFilter", "update_worker_filter_stats": true, "use_worker_filter_stats": true, "sampler_perf_stats_ema_coef": null, "_is_online": true, "num_learners": 0, "num_gpus_per_learner": 0, "num_cpus_per_learner": "auto", "num_aggregator_actors_per_learner": 0, "max_requests_in_flight_per_aggregator_actor": 3, "local_gpu_idx": 0, "max_requests_in_flight_per_learner": 3, "gamma": 1, "lr": 0.0002847858517, "grad_clip": 0.5, "grad_clip_by": "global_norm", "_train_batch_size_per_learner": 5000, "train_batch_size": 4000, "num_epochs": 1, "minibatch_size": 1000, "shuffle_batch_per_epoch": true, "model": {"fcnet_hiddens": [256, 256], "fcnet_activation": "tanh", "fcnet_weights_initializer": null, "fcnet_weights_initializer_config": null, "fcnet_bias_initializer": null, "fcnet_bias_initializer_config": null, "conv_filters": null, "conv_activation": "relu", "conv_kernel_initializer": null, "conv_kernel_initializer_config": null, "conv_bias_initializer": null, "conv_bias_initializer_config": null, "conv_transpose_kernel_initializer": null, "conv_transpose_kernel_initializer_config": null, "conv_transpose_bias_initializer": null, "conv_transpose_bias_initializer_config": null, "post_fcnet_hiddens": [], "post_fcnet_activation": "relu", "post_fcnet_weights_initializer": null, "post_fcnet_weights_initializer_config": null, "post_fcnet_bias_initializer": null, "post_fcnet_bias_initializer_config": null, "free_log_std": false, "log_std_clip_param": 20.0, "no_final_linear": false, "vf_share_layers": false, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "lstm_weights_initializer": null, "lstm_weights_initializer_config": null, "lstm_bias_initializer": null, "lstm_bias_initializer_config": null, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "attention_use_n_prev_actions": 0, "attention_use_n_prev_rewards": 0, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": null, "custom_model_config": {}, "custom_action_dist": null, "custom_preprocessor": null, "encoder_latent_dim": null, "always_check_shapes": false, "lstm_use_prev_action_reward": -1, "_use_default_native_models": -1, "_disable_preprocessor_api": false, "_disable_action_flattening": false}, "_learner_connector": null, "add_default_connectors_to_learner_pipeline": true, "learner_config_dict": {}, "optimizer": {}, "_learner_class": null, "callbacks_on_algorithm_init": null, "callbacks_on_env_runners_recreated": null, "callbacks_on_offline_eval_runners_recreated": null, "callbacks_on_checkpoint_loaded": null, "callbacks_on_environment_created": null, "callbacks_on_episode_created": null, "callbacks_on_episode_start": null, "callbacks_on_episode_step": null, "callbacks_on_episode_end": null, "callbacks_on_evaluate_start": null, "callbacks_on_evaluate_end": null, "callbacks_on_evaluate_offline_start": null, "callbacks_on_evaluate_offline_end": null, "callbacks_on_sample_end": null, "callbacks_on_train_result": null, "explore": true, "enable_rl_module_and_learner": true, "enable_env_runner_and_connector_v2": true, "_prior_exploration_config": {"type": "StochasticSampling"}, "count_steps_by": "env_steps", "policy_map_capacity": 100, "policy_mapping_fn": "<function AlgorithmConfig.DEFAULT_POLICY_MAPPING_FN at 0x385aedb20>", "policies_to_train": null, "policy_states_are_swappable": false, "observation_fn": null, "offline_data_class": null, "input_read_method": "read_parquet", "input_read_method_kwargs": {}, "input_read_schema": {}, "input_read_episodes": false, "input_read_sample_batches": false, "input_read_batch_size": null, "input_filesystem": null, "input_filesystem_kwargs": {}, "input_compress_columns": ["obs", "new_obs"], "input_spaces_jsonable": true, "materialize_data": false, "materialize_mapped_data": true, "map_batches_kwargs": {}, "iter_batches_kwargs": {}, "ignore_final_observation": false, "prelearner_class": null, "prelearner_buffer_class": null, "prelearner_buffer_kwargs": {}, "prelearner_module_synch_period": 10, "dataset_num_iters_per_learner": null, "input_config": {}, "actions_in_input_normalized": false, "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_config": {}, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "output_max_rows_per_file": null, "output_write_remaining_data": false, "output_write_method": "write_parquet", "output_write_method_kwargs": {}, "output_filesystem": null, "output_filesystem_kwargs": {}, "output_write_episodes": true, "offline_sampling": false, "evaluation_interval": 1, "evaluation_duration": 20, "evaluation_duration_unit": "episodes", "evaluation_sample_timeout_s": 120.0, "evaluation_auto_duration_min_env_steps_per_sample": 100, "evaluation_auto_duration_max_env_steps_per_sample": 2000, "evaluation_parallel_to_training": false, "evaluation_force_reset_envs_before_iteration": true, "evaluation_config": null, "off_policy_estimation_methods": {}, "ope_split_batch_by_episode": true, "evaluation_num_env_runners": 1, "in_evaluation": false, "sync_filters_on_rollout_workers_timeout_s": 10.0, "offline_evaluation_interval": null, "num_offline_eval_runners": 0, "offline_loss_for_module_fn": null, "offline_evaluation_duration": 1, "offline_evaluation_parallel_to_training": false, "offline_evaluation_timeout_s": 120.0, "num_cpus_per_offline_eval_runner": 1, "num_gpus_per_offline_eval_runner": 0, "custom_resources_per_offline_eval_runner": {}, "restart_failed_offline_eval_runners": true, "ignore_offline_eval_runner_failures": false, "max_num_offline_eval_runner_restarts": 1000, "offline_eval_runner_restore_timeout_s": 1800.0, "max_requests_in_flight_per_offline_eval_runner": 1, "validate_offline_eval_runners_after_construction": true, "offline_eval_runner_health_probe_timeout_s": 30.0, "offline_eval_rl_module_inference_only": false, "broadcast_offline_eval_runner_states": false, "offline_eval_batch_size_per_runner": 256, "dataset_num_iters_per_eval_runner": 1, "keep_per_episode_custom_metrics": false, "metrics_episode_collection_timeout_s": 60.0, "metrics_num_episodes_for_smoothing": 100, "min_time_s_per_iteration": null, "min_train_timesteps_per_iteration": 0, "min_sample_timesteps_per_iteration": 0, "log_gradients": true, "export_native_model_files": false, "checkpoint_trainable_policies_only": false, "logger_creator": null, "logger_config": null, "log_level": "WARN", "log_sys_usage": true, "fake_sampler": false, "seed": 9, "restart_failed_env_runners": true, "ignore_env_runner_failures": false, "max_num_env_runner_restarts": 1000, "delay_between_env_runner_restarts_s": 60.0, "restart_failed_sub_environments": false, "num_consecutive_env_runner_failures_tolerance": 100, "env_runner_health_probe_timeout_s": 30.0, "env_runner_restore_timeout_s": 1800.0, "_model_config": {}, "_rl_module_spec": "RLModuleSpec(module_class=None, observation_space=None, action_space=None, inference_only=False, learner_only=False, model_config=DefaultModelConfig(fcnet_hiddens=[60, 90], fcnet_activation='tanh', fcnet_kernel_initializer=None, fcnet_kernel_initializer_kwargs=None, fcnet_bias_initializer=None, fcnet_bias_initializer_kwargs=None, conv_filters=None, conv_activation='relu', conv_kernel_initializer=None, conv_kernel_initializer_kwargs=None, conv_bias_initializer=None, conv_bias_initializer_kwargs=None, head_fcnet_hiddens=[], head_fcnet_activation='relu', head_fcnet_kernel_initializer=None, head_fcnet_kernel_initializer_kwargs=None, head_fcnet_bias_initializer=None, head_fcnet_bias_initializer_kwargs=None, free_log_std=False, log_std_clip_param=20.0, vf_share_layers=True, use_lstm=False, max_seq_len=20, lstm_cell_size=256, lstm_use_prev_action=False, lstm_use_prev_reward=False, lstm_kernel_initializer=None, lstm_kernel_initializer_kwargs=None, lstm_bias_initializer=None, lstm_bias_initializer_kwargs=None), catalog_class=None, load_state_path=None, model_config_dict=None)", "algorithm_config_overrides_per_module": {}, "_per_module_overrides": {}, "_validate_config": true, "_use_msgpack_checkpoints": false, "_torch_grad_scaler_class": null, "_torch_lr_scheduler_classes": null, "_tf_policy_handles_more_than_one_loss": false, "_disable_preprocessor_api": false, "_disable_action_flattening": false, "_disable_initialize_loss_from_dummy_batch": false, "_dont_auto_sync_env_runner_states": false, "env_task_fn": -1, "enable_connectors": -1, "simple_optimizer": false, "policy_map_cache": -1, "worker_cls": -1, "synchronize_filters": -1, "enable_async_evaluation": -1, "custom_async_evaluation_function": -1, "_enable_rl_module_api": -1, "auto_wrap_old_gym_envs": -1, "always_attach_evaluation_results": -1, "replay_sequence_length": null, "_disable_execution_plan_api": -1, "use_critic": true, "use_gae": true, "use_kl_loss": true, "kl_coeff": 0.7464963036515, "kl_target": 0.0270990929592, "vf_loss_coeff": 0.6688075857018, "entropy_coeff": 0.0090570820258, "clip_param": 0.1221781641624, "vf_clip_param": 0.1027808522125, "entropy_coeff_schedule": null, "lr_schedule": null, "sgd_minibatch_size": -1, "vf_share_layers": -1, "__stdout_file__": null, "__stderr_file__": null, "lambda": 0.9099046732075, "input": "sampler", "policies": {"default_policy": [null, null, null, null]}, "callbacks": "<class 'ray.rllib.callbacks.callbacks.RLlibCallback'>", "create_env_on_driver": false, "custom_eval_function": null, "framework": "torch"}, "time_since_restore": 5.454337120056152, "iterations_since_restore": 3, "perf": {"cpu_util_percent": 48.4, "ram_util_percent": 79.1}}
{"timers": {"training_iteration": 1.8775416192689551, "restore_env_runners": 1.200599228136707e-05, "training_step": 1.877380181069306, "env_runner_sampling_timer": 1.7642433415852927, "learner_update_timer": 0.1098593891012508, "synch_weights": 0.0006239922093962087, "restore_eval_env_runners": 9.562815679237247e-06, "evaluation_iteration": 0.10966631339980522, "synch_eval_env_connectors": 0.00013850138359703122, "synch_env_connectors": 4.61759379832074e-06}, "env_runners": {"num_episodes_lifetime": -61250.0, "env_to_module_connector": {"connector_pipeline_timer": 4.5395124273833854e-05, "timers": {"connectors": {"add_observations_from_episodes_to_batch": 3.0872598175724633e-06, "add_time_dim_to_batch_and_zero_pad": 2.4783403876326774e-06, "batch_individual_items": 6.444793919685632e-06, "numpy_to_tensor": 8.901821726047136e-06, "add_states_from_episodes_to_batch": 1.7522113876803176e-06}}}, "num_episodes": 250.0, "env_step_timer": 1.4390437393024646e-05, "episode_len_min": 20, "num_agent_steps_sampled": {"default_agent": 5000.0}, "agent_episode_returns_mean": {"default_agent": 5.940000000000001}, "episode_return_mean": 5.940000000000001, "num_env_steps_sampled": 5000.0, "module_to_env_connector": {"timers": {"connectors": {"remove_single_ts_time_rank_from_batch": 5.872951930288717e-07, "un_batch_to_individual_items": 5.513200649047646e-06, "listify_data_for_vector_env": 1.1388330841894025e-05, "normalize_and_clip_actions": 9.857542372311658e-06, "get_actions": 4.008477291472804e-05, "tensor_to_numpy": 1.3643663666992872e-05}}, "connector_pipeline_timer": 0.0001073318800729417}, "episode_duration_sec_mean": 0.004737860834691674, "sample": 0.005169318203061449, "num_module_steps_sampled_lifetime": {"default_policy": -1225000.0}, "env_reset_timer": 3.8018964844022326e-05, "time_between_sampling": 0.0017951732024164503, "episode_len_max": 20, "weights_seq_no": 3.0, "num_env_steps_sampled_lifetime": -1225000.0, "env_to_module_sum_episodes_length_in": 10.36823839457432, "episode_len_mean": 20.0, "module_episode_returns_mean": {"default_policy": 5.940000000000001}, "episode_return_min": -5.5, "episode_return_max": 14.5, "num_agent_steps_sampled_lifetime": {"default_agent": -1225000.0}, "rlmodule_inference_timer": 2.9936314208409978e-05, "env_to_module_sum_episodes_length_out": 10.36823839457432, "num_module_steps_sampled": {"default_policy": 5000.0}, "num_env_steps_sampled_lifetime_throughput": 3688.748340893843}, "learners": {"default_policy": {"module_train_batch_size_mean": 1000.0, "vf_explained_var": 0.0005099177360534668, "num_module_steps_trained_lifetime": 24000, "entropy": 0.6874051094055176, "curr_kl_coeff": 0.04665601998567581, "vf_loss_unclipped": 32.7551155090332, "diff_num_grad_updates_vs_sampler_policy": 1.0, "default_optimizer_learning_rate": 0.0002847858517, "total_loss": 0.06070161238312721, "mean_kl_loss": 0.0017084633000195026, "vf_loss": 0.09893853217363358, "gradients_default_optimizer_global_norm": 0.15090256929397583, "weights_seq_no": 4.0, "num_module_steps_trained": 6000, "policy_loss": 0.0005972132785245776, "curr_entropy_coeff": 0.0090570820258, "num_trainable_parameters": 6003, "num_module_steps_trained_lifetime_throughput": 414271.5437261722}, "__all_modules__": {"num_module_steps_trained": 6000, "num_trainable_parameters": 6003, "learner_connector_sum_episodes_length_in": 5000.0, "num_env_steps_trained": 31500, "learner_connector": {"timers": {"connectors": {"batch_individual_items": 0.03250123197978059, "numpy_to_tensor": 7.469661960436496e-05, "add_states_from_episodes_to_batch": 3.6262502133613456e-06, "add_observations_from_episodes_to_batch": 0.0008040528284640749, "add_columns_from_episodes_to_train_batch": 0.03498324519628939, "add_time_dim_to_batch_and_zero_pad": 1.629422812757548e-05, "add_one_ts_to_episodes_and_truncate": 0.007532344670412479, "general_advantage_estimation": 0.006964226584789111}}, "connector_pipeline_timer": 0.08302375342788257}, "num_module_steps_trained_lifetime": 24000, "learner_connector_sum_episodes_length_out": 5250.0, "num_env_steps_trained_lifetime": 126000, "num_non_trainable_parameters": 0, "num_env_steps_trained_lifetime_throughput": 2127901.782031547, "num_module_steps_trained_throughput": 408459.5160061904, "num_module_steps_trained_lifetime_throughput": 407064.1814634788}}, "num_training_step_calls_per_iteration": 1, "evaluation": {"env_runners": {"num_env_steps_sampled": 400, "env_to_module_connector": {"timers": {"connectors": {"add_states_from_episodes_to_batch": 1.6194542585154558e-06, "add_observations_from_episodes_to_batch": 2.815736896236067e-06, "add_time_dim_to_batch_and_zero_pad": 2.384556215881206e-06, "batch_individual_items": 6.08421649186938e-06, "numpy_to_tensor": 8.300603249498394e-06}}, "connector_pipeline_timer": 4.265351597066402e-05}, "episode_len_max": 20, "num_module_steps_sampled_lifetime": {"default_policy": 1600}, "rlmodule_inference_timer": 2.7120637153303623e-05, "env_to_module_sum_episodes_length_out": 10.368237912813044, "module_to_env_connector": {"connector_pipeline_timer": 9.891488397142478e-05, "timers": {"connectors": {"tensor_to_numpy": 1.2697627482209529e-05, "listify_data_for_vector_env": 1.0763321669208915e-05, "get_actions": 3.469272329766505e-05, "normalize_and_clip_actions": 9.394365355042962e-06, "remove_single_ts_time_rank_from_batch": 5.842771079910358e-07, "un_batch_to_individual_items": 5.3725353444883205e-06}}}, "episode_len_min": 20, "env_reset_timer": 0.00020519212350377346, "episode_return_max": 15.5, "num_episodes_lifetime": 80, "num_episodes": 20, "episode_return_mean": -0.8, "num_module_steps_sampled": {"default_policy": 400}, "episode_duration_sec_mean": 0.00454767977935262, "sample": 0.09978990486591799, "weights_seq_no": 4.0, "module_episode_returns_mean": {"default_policy": -0.8}, "num_agent_steps_sampled_lifetime": {"default_agent": 1600}, "env_step_timer": 1.3789219475686841e-05, "num_agent_steps_sampled": {"default_agent": 400}, "agent_episode_returns_mean": {"default_agent": -0.8}, "num_env_steps_sampled_lifetime": 20400, "env_to_module_sum_episodes_length_in": 10.368237912813044, "episode_len_mean": 20.0, "episode_return_min": -13.5, "time_between_sampling": 1.6462396872919518}, "num_healthy_workers": 1, "actor_manager_num_outstanding_async_reqs": 0, "num_remote_worker_restarts": 0}, "num_env_steps_sampled_lifetime": -1225000.0, "fault_tolerance": {"num_healthy_workers": 0, "num_remote_worker_restarts": 0}, "env_runner_group": {"actor_manager_num_outstanding_async_reqs": 0}, "done": false, "training_iteration": 4, "trial_id": "4d67b_00000", "date": "2025-08-11_19-22-25", "timestamp": 1754932945, "time_this_iter_s": 1.7184481620788574, "time_total_s": 7.17278528213501, "pid": 14356, "hostname": "Mac", "node_ip": "127.0.0.1", "config": {"exploration_config": {}, "extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "placement_strategy": "PACK", "num_gpus": 0, "_fake_gpus": false, "num_cpus_for_main_process": 2, "eager_tracing": true, "eager_max_retraces": 20, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "torch_compile_learner": false, "torch_compile_learner_what_to_compile": "forward_train", "torch_compile_learner_dynamo_backend": "aot_eager", "torch_compile_learner_dynamo_mode": null, "torch_compile_worker": false, "torch_compile_worker_dynamo_backend": "aot_eager", "torch_compile_worker_dynamo_mode": null, "torch_ddp_kwargs": {}, "torch_skip_nan_gradients": false, "env": "Umbrella", "env_config": {}, "observation_space": null, "action_space": null, "clip_rewards": null, "normalize_actions": true, "clip_actions": false, "_is_atari": null, "disable_env_checking": false, "render_env": false, "action_mask_key": "action_mask", "env_runner_cls": null, "num_env_runners": 0, "create_local_env_runner": true, "num_envs_per_env_runner": 1, "gym_env_vectorize_mode": "SYNC", "num_cpus_per_env_runner": 1, "num_gpus_per_env_runner": 0, "custom_resources_per_env_runner": {}, "validate_env_runners_after_construction": true, "episodes_to_numpy": true, "max_requests_in_flight_per_env_runner": 1, "sample_timeout_s": 60.0, "_env_to_module_connector": null, "add_default_connectors_to_env_to_module_pipeline": true, "_module_to_env_connector": null, "add_default_connectors_to_module_to_env_pipeline": true, "merge_env_runner_states": "training_only", "broadcast_env_runner_states": true, "episode_lookback_horizon": 1, "rollout_fragment_length": "auto", "batch_mode": "complete_episodes", "compress_observations": false, "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "enable_tf1_exec_eagerly": false, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "preprocessor_pref": "deepmind", "observation_filter": "NoFilter", "update_worker_filter_stats": true, "use_worker_filter_stats": true, "sampler_perf_stats_ema_coef": null, "_is_online": true, "num_learners": 0, "num_gpus_per_learner": 0, "num_cpus_per_learner": "auto", "num_aggregator_actors_per_learner": 0, "max_requests_in_flight_per_aggregator_actor": 3, "local_gpu_idx": 0, "max_requests_in_flight_per_learner": 3, "gamma": 1, "lr": 0.0002847858517, "grad_clip": 0.5, "grad_clip_by": "global_norm", "_train_batch_size_per_learner": 5000, "train_batch_size": 4000, "num_epochs": 1, "minibatch_size": 1000, "shuffle_batch_per_epoch": true, "model": {"fcnet_hiddens": [256, 256], "fcnet_activation": "tanh", "fcnet_weights_initializer": null, "fcnet_weights_initializer_config": null, "fcnet_bias_initializer": null, "fcnet_bias_initializer_config": null, "conv_filters": null, "conv_activation": "relu", "conv_kernel_initializer": null, "conv_kernel_initializer_config": null, "conv_bias_initializer": null, "conv_bias_initializer_config": null, "conv_transpose_kernel_initializer": null, "conv_transpose_kernel_initializer_config": null, "conv_transpose_bias_initializer": null, "conv_transpose_bias_initializer_config": null, "post_fcnet_hiddens": [], "post_fcnet_activation": "relu", "post_fcnet_weights_initializer": null, "post_fcnet_weights_initializer_config": null, "post_fcnet_bias_initializer": null, "post_fcnet_bias_initializer_config": null, "free_log_std": false, "log_std_clip_param": 20.0, "no_final_linear": false, "vf_share_layers": false, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "lstm_weights_initializer": null, "lstm_weights_initializer_config": null, "lstm_bias_initializer": null, "lstm_bias_initializer_config": null, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "attention_use_n_prev_actions": 0, "attention_use_n_prev_rewards": 0, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": null, "custom_model_config": {}, "custom_action_dist": null, "custom_preprocessor": null, "encoder_latent_dim": null, "always_check_shapes": false, "lstm_use_prev_action_reward": -1, "_use_default_native_models": -1, "_disable_preprocessor_api": false, "_disable_action_flattening": false}, "_learner_connector": null, "add_default_connectors_to_learner_pipeline": true, "learner_config_dict": {}, "optimizer": {}, "_learner_class": null, "callbacks_on_algorithm_init": null, "callbacks_on_env_runners_recreated": null, "callbacks_on_offline_eval_runners_recreated": null, "callbacks_on_checkpoint_loaded": null, "callbacks_on_environment_created": null, "callbacks_on_episode_created": null, "callbacks_on_episode_start": null, "callbacks_on_episode_step": null, "callbacks_on_episode_end": null, "callbacks_on_evaluate_start": null, "callbacks_on_evaluate_end": null, "callbacks_on_evaluate_offline_start": null, "callbacks_on_evaluate_offline_end": null, "callbacks_on_sample_end": null, "callbacks_on_train_result": null, "explore": true, "enable_rl_module_and_learner": true, "enable_env_runner_and_connector_v2": true, "_prior_exploration_config": {"type": "StochasticSampling"}, "count_steps_by": "env_steps", "policy_map_capacity": 100, "policy_mapping_fn": "<function AlgorithmConfig.DEFAULT_POLICY_MAPPING_FN at 0x385aedb20>", "policies_to_train": null, "policy_states_are_swappable": false, "observation_fn": null, "offline_data_class": null, "input_read_method": "read_parquet", "input_read_method_kwargs": {}, "input_read_schema": {}, "input_read_episodes": false, "input_read_sample_batches": false, "input_read_batch_size": null, "input_filesystem": null, "input_filesystem_kwargs": {}, "input_compress_columns": ["obs", "new_obs"], "input_spaces_jsonable": true, "materialize_data": false, "materialize_mapped_data": true, "map_batches_kwargs": {}, "iter_batches_kwargs": {}, "ignore_final_observation": false, "prelearner_class": null, "prelearner_buffer_class": null, "prelearner_buffer_kwargs": {}, "prelearner_module_synch_period": 10, "dataset_num_iters_per_learner": null, "input_config": {}, "actions_in_input_normalized": false, "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_config": {}, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "output_max_rows_per_file": null, "output_write_remaining_data": false, "output_write_method": "write_parquet", "output_write_method_kwargs": {}, "output_filesystem": null, "output_filesystem_kwargs": {}, "output_write_episodes": true, "offline_sampling": false, "evaluation_interval": 1, "evaluation_duration": 20, "evaluation_duration_unit": "episodes", "evaluation_sample_timeout_s": 120.0, "evaluation_auto_duration_min_env_steps_per_sample": 100, "evaluation_auto_duration_max_env_steps_per_sample": 2000, "evaluation_parallel_to_training": false, "evaluation_force_reset_envs_before_iteration": true, "evaluation_config": null, "off_policy_estimation_methods": {}, "ope_split_batch_by_episode": true, "evaluation_num_env_runners": 1, "in_evaluation": false, "sync_filters_on_rollout_workers_timeout_s": 10.0, "offline_evaluation_interval": null, "num_offline_eval_runners": 0, "offline_loss_for_module_fn": null, "offline_evaluation_duration": 1, "offline_evaluation_parallel_to_training": false, "offline_evaluation_timeout_s": 120.0, "num_cpus_per_offline_eval_runner": 1, "num_gpus_per_offline_eval_runner": 0, "custom_resources_per_offline_eval_runner": {}, "restart_failed_offline_eval_runners": true, "ignore_offline_eval_runner_failures": false, "max_num_offline_eval_runner_restarts": 1000, "offline_eval_runner_restore_timeout_s": 1800.0, "max_requests_in_flight_per_offline_eval_runner": 1, "validate_offline_eval_runners_after_construction": true, "offline_eval_runner_health_probe_timeout_s": 30.0, "offline_eval_rl_module_inference_only": false, "broadcast_offline_eval_runner_states": false, "offline_eval_batch_size_per_runner": 256, "dataset_num_iters_per_eval_runner": 1, "keep_per_episode_custom_metrics": false, "metrics_episode_collection_timeout_s": 60.0, "metrics_num_episodes_for_smoothing": 100, "min_time_s_per_iteration": null, "min_train_timesteps_per_iteration": 0, "min_sample_timesteps_per_iteration": 0, "log_gradients": true, "export_native_model_files": false, "checkpoint_trainable_policies_only": false, "logger_creator": null, "logger_config": null, "log_level": "WARN", "log_sys_usage": true, "fake_sampler": false, "seed": 9, "restart_failed_env_runners": true, "ignore_env_runner_failures": false, "max_num_env_runner_restarts": 1000, "delay_between_env_runner_restarts_s": 60.0, "restart_failed_sub_environments": false, "num_consecutive_env_runner_failures_tolerance": 100, "env_runner_health_probe_timeout_s": 30.0, "env_runner_restore_timeout_s": 1800.0, "_model_config": {}, "_rl_module_spec": "RLModuleSpec(module_class=None, observation_space=None, action_space=None, inference_only=False, learner_only=False, model_config=DefaultModelConfig(fcnet_hiddens=[60, 90], fcnet_activation='tanh', fcnet_kernel_initializer=None, fcnet_kernel_initializer_kwargs=None, fcnet_bias_initializer=None, fcnet_bias_initializer_kwargs=None, conv_filters=None, conv_activation='relu', conv_kernel_initializer=None, conv_kernel_initializer_kwargs=None, conv_bias_initializer=None, conv_bias_initializer_kwargs=None, head_fcnet_hiddens=[], head_fcnet_activation='relu', head_fcnet_kernel_initializer=None, head_fcnet_kernel_initializer_kwargs=None, head_fcnet_bias_initializer=None, head_fcnet_bias_initializer_kwargs=None, free_log_std=False, log_std_clip_param=20.0, vf_share_layers=True, use_lstm=False, max_seq_len=20, lstm_cell_size=256, lstm_use_prev_action=False, lstm_use_prev_reward=False, lstm_kernel_initializer=None, lstm_kernel_initializer_kwargs=None, lstm_bias_initializer=None, lstm_bias_initializer_kwargs=None), catalog_class=None, load_state_path=None, model_config_dict=None)", "algorithm_config_overrides_per_module": {}, "_per_module_overrides": {}, "_validate_config": true, "_use_msgpack_checkpoints": false, "_torch_grad_scaler_class": null, "_torch_lr_scheduler_classes": null, "_tf_policy_handles_more_than_one_loss": false, "_disable_preprocessor_api": false, "_disable_action_flattening": false, "_disable_initialize_loss_from_dummy_batch": false, "_dont_auto_sync_env_runner_states": false, "env_task_fn": -1, "enable_connectors": -1, "simple_optimizer": false, "policy_map_cache": -1, "worker_cls": -1, "synchronize_filters": -1, "enable_async_evaluation": -1, "custom_async_evaluation_function": -1, "_enable_rl_module_api": -1, "auto_wrap_old_gym_envs": -1, "always_attach_evaluation_results": -1, "replay_sequence_length": null, "_disable_execution_plan_api": -1, "use_critic": true, "use_gae": true, "use_kl_loss": true, "kl_coeff": 0.7464963036515, "kl_target": 0.0270990929592, "vf_loss_coeff": 0.6688075857018, "entropy_coeff": 0.0090570820258, "clip_param": 0.1221781641624, "vf_clip_param": 0.1027808522125, "entropy_coeff_schedule": null, "lr_schedule": null, "sgd_minibatch_size": -1, "vf_share_layers": -1, "__stdout_file__": null, "__stderr_file__": null, "lambda": 0.9099046732075, "input": "sampler", "policies": {"default_policy": [null, null, null, null]}, "callbacks": "<class 'ray.rllib.callbacks.callbacks.RLlibCallback'>", "create_env_on_driver": false, "custom_eval_function": null, "framework": "torch"}, "time_since_restore": 7.17278528213501, "iterations_since_restore": 4, "perf": {"cpu_util_percent": 40.93333333333333, "ram_util_percent": 78.26666666666667}}
{"timers": {"training_iteration": 1.8757401722361462, "restore_env_runners": 1.1947183115979424e-05, "training_step": 1.8755786142586068, "env_runner_sampling_timer": 1.7626279952497321, "learner_update_timer": 0.10967497895935711, "synch_weights": 0.0006232214465253859, "restore_eval_env_runners": 9.586357230786235e-06, "evaluation_iteration": 0.10959602442565362, "synch_eval_env_connectors": 0.0001392684594891034, "synch_env_connectors": 4.615588161745108e-06}, "env_runners": {"num_episodes_lifetime": -92125.0, "env_to_module_connector": {"connector_pipeline_timer": 4.6854145246244986e-05, "timers": {"connectors": {"add_observations_from_episodes_to_batch": 3.155759575158465e-06, "add_time_dim_to_batch_and_zero_pad": 2.6082744078459294e-06, "batch_individual_items": 6.83280647582698e-06, "numpy_to_tensor": 9.516247900206293e-06, "add_states_from_episodes_to_batch": 1.8113977870278151e-06}}}, "num_episodes": 250.0, "env_step_timer": 1.5147182102486865e-05, "episode_len_min": 20, "num_agent_steps_sampled": {"default_agent": 5000.0}, "agent_episode_returns_mean": {"default_agent": 6.5}, "episode_return_mean": 6.5, "num_env_steps_sampled": 5000.0, "module_to_env_connector": {"timers": {"connectors": {"remove_single_ts_time_rank_from_batch": 6.361776929563857e-07, "un_batch_to_individual_items": 5.854045231644556e-06, "listify_data_for_vector_env": 1.1983430538392019e-05, "normalize_and_clip_actions": 1.0214519904893568e-05, "get_actions": 4.2976673586608294e-05, "tensor_to_numpy": 1.4154016315557307e-05}}, "connector_pipeline_timer": 0.00011273335368168778}, "episode_duration_sec_mean": 0.00532941633928567, "sample": 0.00522752004552086, "num_module_steps_sampled_lifetime": {"default_policy": -1842500.0}, "env_reset_timer": 4.222997003091265e-05, "time_between_sampling": 0.0016199926764511197, "episode_len_max": 20, "weights_seq_no": 4.0, "num_env_steps_sampled_lifetime": -1842500.0, "env_to_module_sum_episodes_length_in": 10.36823839457432, "episode_len_mean": 20.0, "module_episode_returns_mean": {"default_policy": 6.5}, "episode_return_min": -5.5, "episode_return_max": 14.5, "num_agent_steps_sampled_lifetime": {"default_agent": -1842500.0}, "rlmodule_inference_timer": 5.036792990611062e-05, "env_to_module_sum_episodes_length_out": 10.36823839457432, "num_module_steps_sampled": {"default_policy": 5000.0}, "num_env_steps_sampled_lifetime_throughput": 3443.732978591808}, "learners": {"default_policy": {"module_train_batch_size_mean": 1000.0, "vf_explained_var": 0.0012282133102416992, "num_module_steps_trained_lifetime": 30000, "entropy": 0.6789590120315552, "curr_kl_coeff": 0.023328009992837906, "vf_loss_unclipped": 32.43641662597656, "diff_num_grad_updates_vs_sampler_policy": 1.0, "default_optimizer_learning_rate": 0.0002847858517, "total_loss": 0.13377542793750763, "mean_kl_loss": 0.0014019616646692157, "vf_loss": 0.09875169396400452, "gradients_default_optimizer_global_norm": 0.07133479416370392, "weights_seq_no": 5.0, "num_module_steps_trained": 6000, "policy_loss": 0.07381351292133331, "curr_entropy_coeff": 0.0090570820258, "num_trainable_parameters": 6003, "num_module_steps_trained_lifetime_throughput": 414814.8294395966}, "__all_modules__": {"num_module_steps_trained": 6000, "num_trainable_parameters": 6003, "learner_connector_sum_episodes_length_in": 5000.0, "num_env_steps_trained": 31500, "learner_connector": {"timers": {"connectors": {"batch_individual_items": 0.032473448830083546, "numpy_to_tensor": 7.459632422292488e-05, "add_states_from_episodes_to_batch": 3.6220682814635803e-06, "add_observations_from_episodes_to_batch": 0.0008041164701535377, "add_columns_from_episodes_to_train_batch": 0.034975303574640286, "add_time_dim_to_batch_and_zero_pad": 1.624503642141004e-05, "add_one_ts_to_episodes_and_truncate": 0.007534789144155868, "general_advantage_estimation": 0.006946015569699688}}, "connector_pipeline_timer": 0.08297178589303146}, "num_module_steps_trained_lifetime": 30000, "learner_connector_sum_episodes_length_out": 5250.0, "num_env_steps_trained_lifetime": 157500, "num_non_trainable_parameters": 0, "num_env_steps_trained_lifetime_throughput": 2132425.0941191046, "num_module_steps_trained_throughput": 409221.569845096, "num_module_steps_trained_lifetime_throughput": 407867.6604740154}}, "num_training_step_calls_per_iteration": 1, "evaluation": {"env_runners": {"num_env_steps_sampled": 400, "env_to_module_connector": {"timers": {"connectors": {"add_states_from_episodes_to_batch": 1.6083782255920477e-06, "add_observations_from_episodes_to_batch": 2.849283037360873e-06, "add_time_dim_to_batch_and_zero_pad": 2.3436335591550424e-06, "batch_individual_items": 6.1066505130277885e-06, "numpy_to_tensor": 8.375275183619558e-06}}, "connector_pipeline_timer": 4.274334084163177e-05}, "episode_len_max": 20, "num_module_steps_sampled_lifetime": {"default_policy": 2000}, "rlmodule_inference_timer": 2.722306744820738e-05, "env_to_module_sum_episodes_length_out": 10.368238387501162, "module_to_env_connector": {"connector_pipeline_timer": 0.00010064001287679368, "timers": {"connectors": {"tensor_to_numpy": 1.2886188386542534e-05, "listify_data_for_vector_env": 1.0834087091654658e-05, "get_actions": 3.6097308578185224e-05, "normalize_and_clip_actions": 9.447952716005909e-06, "remove_single_ts_time_rank_from_batch": 5.763322003009738e-07, "un_batch_to_individual_items": 5.3412707369039414e-06}}}, "episode_len_min": 20, "env_reset_timer": 0.0002039468719733518, "episode_return_max": 15.5, "num_episodes_lifetime": 100, "num_episodes": 20, "episode_return_mean": -0.9, "num_module_steps_sampled": {"default_policy": 400}, "episode_duration_sec_mean": 0.004548591735074297, "sample": 0.09978382873729996, "weights_seq_no": 5.0, "module_episode_returns_mean": {"default_policy": -0.9}, "num_agent_steps_sampled_lifetime": {"default_agent": 2000}, "env_step_timer": 1.3876581268708353e-05, "num_agent_steps_sampled": {"default_agent": 400}, "agent_episode_returns_mean": {"default_agent": -0.9}, "num_env_steps_sampled_lifetime": 25400, "env_to_module_sum_episodes_length_in": 10.368238387501162, "episode_len_mean": 20.0, "episode_return_min": -13.5, "time_between_sampling": 1.6469295137487905}, "num_healthy_workers": 1, "actor_manager_num_outstanding_async_reqs": 0, "num_remote_worker_restarts": 0}, "num_env_steps_sampled_lifetime": -1842500.0, "fault_tolerance": {"num_healthy_workers": 0, "num_remote_worker_restarts": 0}, "env_runner_group": {"actor_manager_num_outstanding_async_reqs": 0}, "done": false, "training_iteration": 5, "trial_id": "4d67b_00000", "date": "2025-08-11_19-22-27", "timestamp": 1754932947, "time_this_iter_s": 1.803433895111084, "time_total_s": 8.976219177246094, "pid": 14356, "hostname": "Mac", "node_ip": "127.0.0.1", "config": {"exploration_config": {}, "extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "placement_strategy": "PACK", "num_gpus": 0, "_fake_gpus": false, "num_cpus_for_main_process": 2, "eager_tracing": true, "eager_max_retraces": 20, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "torch_compile_learner": false, "torch_compile_learner_what_to_compile": "forward_train", "torch_compile_learner_dynamo_backend": "aot_eager", "torch_compile_learner_dynamo_mode": null, "torch_compile_worker": false, "torch_compile_worker_dynamo_backend": "aot_eager", "torch_compile_worker_dynamo_mode": null, "torch_ddp_kwargs": {}, "torch_skip_nan_gradients": false, "env": "Umbrella", "env_config": {}, "observation_space": null, "action_space": null, "clip_rewards": null, "normalize_actions": true, "clip_actions": false, "_is_atari": null, "disable_env_checking": false, "render_env": false, "action_mask_key": "action_mask", "env_runner_cls": null, "num_env_runners": 0, "create_local_env_runner": true, "num_envs_per_env_runner": 1, "gym_env_vectorize_mode": "SYNC", "num_cpus_per_env_runner": 1, "num_gpus_per_env_runner": 0, "custom_resources_per_env_runner": {}, "validate_env_runners_after_construction": true, "episodes_to_numpy": true, "max_requests_in_flight_per_env_runner": 1, "sample_timeout_s": 60.0, "_env_to_module_connector": null, "add_default_connectors_to_env_to_module_pipeline": true, "_module_to_env_connector": null, "add_default_connectors_to_module_to_env_pipeline": true, "merge_env_runner_states": "training_only", "broadcast_env_runner_states": true, "episode_lookback_horizon": 1, "rollout_fragment_length": "auto", "batch_mode": "complete_episodes", "compress_observations": false, "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "enable_tf1_exec_eagerly": false, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "preprocessor_pref": "deepmind", "observation_filter": "NoFilter", "update_worker_filter_stats": true, "use_worker_filter_stats": true, "sampler_perf_stats_ema_coef": null, "_is_online": true, "num_learners": 0, "num_gpus_per_learner": 0, "num_cpus_per_learner": "auto", "num_aggregator_actors_per_learner": 0, "max_requests_in_flight_per_aggregator_actor": 3, "local_gpu_idx": 0, "max_requests_in_flight_per_learner": 3, "gamma": 1, "lr": 0.0002847858517, "grad_clip": 0.5, "grad_clip_by": "global_norm", "_train_batch_size_per_learner": 5000, "train_batch_size": 4000, "num_epochs": 1, "minibatch_size": 1000, "shuffle_batch_per_epoch": true, "model": {"fcnet_hiddens": [256, 256], "fcnet_activation": "tanh", "fcnet_weights_initializer": null, "fcnet_weights_initializer_config": null, "fcnet_bias_initializer": null, "fcnet_bias_initializer_config": null, "conv_filters": null, "conv_activation": "relu", "conv_kernel_initializer": null, "conv_kernel_initializer_config": null, "conv_bias_initializer": null, "conv_bias_initializer_config": null, "conv_transpose_kernel_initializer": null, "conv_transpose_kernel_initializer_config": null, "conv_transpose_bias_initializer": null, "conv_transpose_bias_initializer_config": null, "post_fcnet_hiddens": [], "post_fcnet_activation": "relu", "post_fcnet_weights_initializer": null, "post_fcnet_weights_initializer_config": null, "post_fcnet_bias_initializer": null, "post_fcnet_bias_initializer_config": null, "free_log_std": false, "log_std_clip_param": 20.0, "no_final_linear": false, "vf_share_layers": false, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "lstm_weights_initializer": null, "lstm_weights_initializer_config": null, "lstm_bias_initializer": null, "lstm_bias_initializer_config": null, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "attention_use_n_prev_actions": 0, "attention_use_n_prev_rewards": 0, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": null, "custom_model_config": {}, "custom_action_dist": null, "custom_preprocessor": null, "encoder_latent_dim": null, "always_check_shapes": false, "lstm_use_prev_action_reward": -1, "_use_default_native_models": -1, "_disable_preprocessor_api": false, "_disable_action_flattening": false}, "_learner_connector": null, "add_default_connectors_to_learner_pipeline": true, "learner_config_dict": {}, "optimizer": {}, "_learner_class": null, "callbacks_on_algorithm_init": null, "callbacks_on_env_runners_recreated": null, "callbacks_on_offline_eval_runners_recreated": null, "callbacks_on_checkpoint_loaded": null, "callbacks_on_environment_created": null, "callbacks_on_episode_created": null, "callbacks_on_episode_start": null, "callbacks_on_episode_step": null, "callbacks_on_episode_end": null, "callbacks_on_evaluate_start": null, "callbacks_on_evaluate_end": null, "callbacks_on_evaluate_offline_start": null, "callbacks_on_evaluate_offline_end": null, "callbacks_on_sample_end": null, "callbacks_on_train_result": null, "explore": true, "enable_rl_module_and_learner": true, "enable_env_runner_and_connector_v2": true, "_prior_exploration_config": {"type": "StochasticSampling"}, "count_steps_by": "env_steps", "policy_map_capacity": 100, "policy_mapping_fn": "<function AlgorithmConfig.DEFAULT_POLICY_MAPPING_FN at 0x385aedb20>", "policies_to_train": null, "policy_states_are_swappable": false, "observation_fn": null, "offline_data_class": null, "input_read_method": "read_parquet", "input_read_method_kwargs": {}, "input_read_schema": {}, "input_read_episodes": false, "input_read_sample_batches": false, "input_read_batch_size": null, "input_filesystem": null, "input_filesystem_kwargs": {}, "input_compress_columns": ["obs", "new_obs"], "input_spaces_jsonable": true, "materialize_data": false, "materialize_mapped_data": true, "map_batches_kwargs": {}, "iter_batches_kwargs": {}, "ignore_final_observation": false, "prelearner_class": null, "prelearner_buffer_class": null, "prelearner_buffer_kwargs": {}, "prelearner_module_synch_period": 10, "dataset_num_iters_per_learner": null, "input_config": {}, "actions_in_input_normalized": false, "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_config": {}, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "output_max_rows_per_file": null, "output_write_remaining_data": false, "output_write_method": "write_parquet", "output_write_method_kwargs": {}, "output_filesystem": null, "output_filesystem_kwargs": {}, "output_write_episodes": true, "offline_sampling": false, "evaluation_interval": 1, "evaluation_duration": 20, "evaluation_duration_unit": "episodes", "evaluation_sample_timeout_s": 120.0, "evaluation_auto_duration_min_env_steps_per_sample": 100, "evaluation_auto_duration_max_env_steps_per_sample": 2000, "evaluation_parallel_to_training": false, "evaluation_force_reset_envs_before_iteration": true, "evaluation_config": null, "off_policy_estimation_methods": {}, "ope_split_batch_by_episode": true, "evaluation_num_env_runners": 1, "in_evaluation": false, "sync_filters_on_rollout_workers_timeout_s": 10.0, "offline_evaluation_interval": null, "num_offline_eval_runners": 0, "offline_loss_for_module_fn": null, "offline_evaluation_duration": 1, "offline_evaluation_parallel_to_training": false, "offline_evaluation_timeout_s": 120.0, "num_cpus_per_offline_eval_runner": 1, "num_gpus_per_offline_eval_runner": 0, "custom_resources_per_offline_eval_runner": {}, "restart_failed_offline_eval_runners": true, "ignore_offline_eval_runner_failures": false, "max_num_offline_eval_runner_restarts": 1000, "offline_eval_runner_restore_timeout_s": 1800.0, "max_requests_in_flight_per_offline_eval_runner": 1, "validate_offline_eval_runners_after_construction": true, "offline_eval_runner_health_probe_timeout_s": 30.0, "offline_eval_rl_module_inference_only": false, "broadcast_offline_eval_runner_states": false, "offline_eval_batch_size_per_runner": 256, "dataset_num_iters_per_eval_runner": 1, "keep_per_episode_custom_metrics": false, "metrics_episode_collection_timeout_s": 60.0, "metrics_num_episodes_for_smoothing": 100, "min_time_s_per_iteration": null, "min_train_timesteps_per_iteration": 0, "min_sample_timesteps_per_iteration": 0, "log_gradients": true, "export_native_model_files": false, "checkpoint_trainable_policies_only": false, "logger_creator": null, "logger_config": null, "log_level": "WARN", "log_sys_usage": true, "fake_sampler": false, "seed": 9, "restart_failed_env_runners": true, "ignore_env_runner_failures": false, "max_num_env_runner_restarts": 1000, "delay_between_env_runner_restarts_s": 60.0, "restart_failed_sub_environments": false, "num_consecutive_env_runner_failures_tolerance": 100, "env_runner_health_probe_timeout_s": 30.0, "env_runner_restore_timeout_s": 1800.0, "_model_config": {}, "_rl_module_spec": "RLModuleSpec(module_class=None, observation_space=None, action_space=None, inference_only=False, learner_only=False, model_config=DefaultModelConfig(fcnet_hiddens=[60, 90], fcnet_activation='tanh', fcnet_kernel_initializer=None, fcnet_kernel_initializer_kwargs=None, fcnet_bias_initializer=None, fcnet_bias_initializer_kwargs=None, conv_filters=None, conv_activation='relu', conv_kernel_initializer=None, conv_kernel_initializer_kwargs=None, conv_bias_initializer=None, conv_bias_initializer_kwargs=None, head_fcnet_hiddens=[], head_fcnet_activation='relu', head_fcnet_kernel_initializer=None, head_fcnet_kernel_initializer_kwargs=None, head_fcnet_bias_initializer=None, head_fcnet_bias_initializer_kwargs=None, free_log_std=False, log_std_clip_param=20.0, vf_share_layers=True, use_lstm=False, max_seq_len=20, lstm_cell_size=256, lstm_use_prev_action=False, lstm_use_prev_reward=False, lstm_kernel_initializer=None, lstm_kernel_initializer_kwargs=None, lstm_bias_initializer=None, lstm_bias_initializer_kwargs=None), catalog_class=None, load_state_path=None, model_config_dict=None)", "algorithm_config_overrides_per_module": {}, "_per_module_overrides": {}, "_validate_config": true, "_use_msgpack_checkpoints": false, "_torch_grad_scaler_class": null, "_torch_lr_scheduler_classes": null, "_tf_policy_handles_more_than_one_loss": false, "_disable_preprocessor_api": false, "_disable_action_flattening": false, "_disable_initialize_loss_from_dummy_batch": false, "_dont_auto_sync_env_runner_states": false, "env_task_fn": -1, "enable_connectors": -1, "simple_optimizer": false, "policy_map_cache": -1, "worker_cls": -1, "synchronize_filters": -1, "enable_async_evaluation": -1, "custom_async_evaluation_function": -1, "_enable_rl_module_api": -1, "auto_wrap_old_gym_envs": -1, "always_attach_evaluation_results": -1, "replay_sequence_length": null, "_disable_execution_plan_api": -1, "use_critic": true, "use_gae": true, "use_kl_loss": true, "kl_coeff": 0.7464963036515, "kl_target": 0.0270990929592, "vf_loss_coeff": 0.6688075857018, "entropy_coeff": 0.0090570820258, "clip_param": 0.1221781641624, "vf_clip_param": 0.1027808522125, "entropy_coeff_schedule": null, "lr_schedule": null, "sgd_minibatch_size": -1, "vf_share_layers": -1, "__stdout_file__": null, "__stderr_file__": null, "lambda": 0.9099046732075, "input": "sampler", "policies": {"default_policy": [null, null, null, null]}, "callbacks": "<class 'ray.rllib.callbacks.callbacks.RLlibCallback'>", "create_env_on_driver": false, "custom_eval_function": null, "framework": "torch"}, "time_since_restore": 8.976219177246094, "iterations_since_restore": 5, "perf": {"cpu_util_percent": 51.849999999999994, "ram_util_percent": 78.75}}
{"timers": {"training_iteration": 1.8736467267636159, "restore_env_runners": 1.189230083367565e-05, "training_step": 1.8734846977061914, "env_runner_sampling_timer": 1.7597577065475114, "learner_update_timer": 0.11045009792007683, "synch_weights": 0.0006233521524542994, "restore_eval_env_runners": 9.557164713288658e-06, "evaluation_iteration": 0.10953913585119915, "synch_eval_env_connectors": 0.0001389028548917966, "synch_env_connectors": 4.606092629124177e-06}, "env_runners": {"num_episodes_lifetime": -123000.0, "env_to_module_connector": {"connector_pipeline_timer": 4.5814489989337874e-05, "timers": {"connectors": {"add_observations_from_episodes_to_batch": 3.073740606385454e-06, "add_time_dim_to_batch_and_zero_pad": 2.538532760418613e-06, "batch_individual_items": 6.6367176910131945e-06, "numpy_to_tensor": 9.333057928928617e-06, "add_states_from_episodes_to_batch": 1.8093542959269534e-06}}}, "num_episodes": 250.0, "env_step_timer": 1.4807238402789972e-05, "episode_len_min": 20, "num_agent_steps_sampled": {"default_agent": 5000.0}, "agent_episode_returns_mean": {"default_agent": 6.820000000000002}, "episode_return_mean": 6.820000000000002, "num_env_steps_sampled": 5000.0, "module_to_env_connector": {"timers": {"connectors": {"remove_single_ts_time_rank_from_batch": 5.930521073031736e-07, "un_batch_to_individual_items": 5.6673326412302245e-06, "listify_data_for_vector_env": 1.1766405819233478e-05, "normalize_and_clip_actions": 9.980143784221694e-06, "get_actions": 4.1996025301411264e-05, "tensor_to_numpy": 1.4063681836801823e-05}}, "connector_pipeline_timer": 0.00011062375850930306}, "episode_duration_sec_mean": 0.004839287329930812, "sample": 0.005521725672471059, "num_module_steps_sampled_lifetime": {"default_policy": -2460000.0}, "env_reset_timer": 4.341034869240479e-05, "time_between_sampling": 0.0015566220680782344, "episode_len_max": 20, "weights_seq_no": 5.0, "num_env_steps_sampled_lifetime": -2460000.0, "env_to_module_sum_episodes_length_in": 10.36823839457432, "episode_len_mean": 20.0, "module_episode_returns_mean": {"default_policy": 6.820000000000002}, "episode_return_min": -5.5, "episode_return_max": 14.5, "num_agent_steps_sampled_lifetime": {"default_agent": -2460000.0}, "rlmodule_inference_timer": 3.019259930181752e-05, "env_to_module_sum_episodes_length_out": 10.36823839457432, "num_module_steps_sampled": {"default_policy": 5000.0}, "num_env_steps_sampled_lifetime_throughput": 3499.1911163787486}, "learners": {"default_policy": {"module_train_batch_size_mean": 1000.0, "vf_explained_var": 0.0018221735954284668, "num_module_steps_trained_lifetime": 36000, "entropy": 0.6706355810165405, "curr_kl_coeff": 0.011664004996418953, "vf_loss_unclipped": 33.48452377319336, "diff_num_grad_updates_vs_sampler_policy": 1.0, "default_optimizer_learning_rate": 0.0002847858517, "total_loss": 0.06740652769804001, "mean_kl_loss": 0.000993289751932025, "vf_loss": 0.09929709136486053, "gradients_default_optimizer_global_norm": 0.03585651144385338, "weights_seq_no": 6.0, "num_module_steps_trained": 6000, "policy_loss": 0.007046705111861229, "curr_entropy_coeff": 0.0090570820258, "num_trainable_parameters": 6003, "num_module_steps_trained_lifetime_throughput": 415009.19636908197}, "__all_modules__": {"num_module_steps_trained": 6000, "num_trainable_parameters": 6003, "learner_connector_sum_episodes_length_in": 5000.0, "num_env_steps_trained": 31500, "learner_connector": {"timers": {"connectors": {"batch_individual_items": 0.033385372262309046, "numpy_to_tensor": 7.469870154975965e-05, "add_states_from_episodes_to_batch": 3.617096963486949e-06, "add_observations_from_episodes_to_batch": 0.0008041948957996351, "add_columns_from_episodes_to_train_batch": 0.03496872803907478, "add_time_dim_to_batch_and_zero_pad": 1.619675689161805e-05, "add_one_ts_to_episodes_and_truncate": 0.007535150002651203, "general_advantage_estimation": 0.006933186244516005}}, "connector_pipeline_timer": 0.0838644084444436}, "num_module_steps_trained_lifetime": 36000, "learner_connector_sum_episodes_length_out": 5250.0, "num_env_steps_trained_lifetime": 189000, "num_non_trainable_parameters": 0, "num_env_steps_trained_lifetime_throughput": 2135253.7985390956, "num_module_steps_trained_throughput": 409652.7417398384, "num_module_steps_trained_lifetime_throughput": 408344.13950348797}}, "num_training_step_calls_per_iteration": 1, "evaluation": {"env_runners": {"num_env_steps_sampled": 400, "env_to_module_connector": {"timers": {"connectors": {"add_states_from_episodes_to_batch": 1.765064360377767e-06, "add_observations_from_episodes_to_batch": 3.1774932875592137e-06, "add_time_dim_to_batch_and_zero_pad": 2.7919320200778025e-06, "batch_individual_items": 7.300881815915118e-06, "numpy_to_tensor": 1.0586762036705268e-05}}, "connector_pipeline_timer": 5.0053797032642444e-05}, "episode_len_max": 20, "num_module_steps_sampled_lifetime": {"default_policy": 2400}, "rlmodule_inference_timer": 3.402149298878858e-05, "env_to_module_sum_episodes_length_out": 10.368238394470474, "module_to_env_connector": {"connector_pipeline_timer": 0.00012475495371619546, "timers": {"connectors": {"tensor_to_numpy": 1.7026464242932168e-05, "listify_data_for_vector_env": 1.3539635207259873e-05, "get_actions": 4.7046247592147146e-05, "normalize_and_clip_actions": 1.087114856280246e-05, "remove_single_ts_time_rank_from_batch": 6.593479672190115e-07, "un_batch_to_individual_items": 5.93846930069319e-06}}}, "episode_len_min": 20, "env_reset_timer": 0.00020327240317002276, "episode_return_max": 15.5, "num_episodes_lifetime": 120, "num_episodes": 20, "episode_return_mean": -0.7, "num_module_steps_sampled": {"default_policy": 400}, "episode_duration_sec_mean": 0.0046909816993866114, "sample": 0.09993594753099713, "weights_seq_no": 6.0, "module_episode_returns_mean": {"default_policy": -0.7}, "num_agent_steps_sampled_lifetime": {"default_agent": 2400}, "env_step_timer": 1.769527730637433e-05, "num_agent_steps_sampled": {"default_agent": 400}, "agent_episode_returns_mean": {"default_agent": -0.7}, "num_env_steps_sampled_lifetime": 30400, "env_to_module_sum_episodes_length_in": 10.368238394470474, "episode_len_mean": 20.0, "episode_return_min": -13.5, "time_between_sampling": 1.6473122169413965}, "num_healthy_workers": 1, "actor_manager_num_outstanding_async_reqs": 0, "num_remote_worker_restarts": 0}, "num_env_steps_sampled_lifetime": -2460000.0, "fault_tolerance": {"num_healthy_workers": 0, "num_remote_worker_restarts": 0}, "env_runner_group": {"actor_manager_num_outstanding_async_reqs": 0}, "done": false, "training_iteration": 6, "trial_id": "4d67b_00000", "date": "2025-08-11_19-22-28", "timestamp": 1754932948, "time_this_iter_s": 1.7886919975280762, "time_total_s": 10.76491117477417, "pid": 14356, "hostname": "Mac", "node_ip": "127.0.0.1", "config": {"exploration_config": {}, "extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "placement_strategy": "PACK", "num_gpus": 0, "_fake_gpus": false, "num_cpus_for_main_process": 2, "eager_tracing": true, "eager_max_retraces": 20, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "torch_compile_learner": false, "torch_compile_learner_what_to_compile": "forward_train", "torch_compile_learner_dynamo_backend": "aot_eager", "torch_compile_learner_dynamo_mode": null, "torch_compile_worker": false, "torch_compile_worker_dynamo_backend": "aot_eager", "torch_compile_worker_dynamo_mode": null, "torch_ddp_kwargs": {}, "torch_skip_nan_gradients": false, "env": "Umbrella", "env_config": {}, "observation_space": null, "action_space": null, "clip_rewards": null, "normalize_actions": true, "clip_actions": false, "_is_atari": null, "disable_env_checking": false, "render_env": false, "action_mask_key": "action_mask", "env_runner_cls": null, "num_env_runners": 0, "create_local_env_runner": true, "num_envs_per_env_runner": 1, "gym_env_vectorize_mode": "SYNC", "num_cpus_per_env_runner": 1, "num_gpus_per_env_runner": 0, "custom_resources_per_env_runner": {}, "validate_env_runners_after_construction": true, "episodes_to_numpy": true, "max_requests_in_flight_per_env_runner": 1, "sample_timeout_s": 60.0, "_env_to_module_connector": null, "add_default_connectors_to_env_to_module_pipeline": true, "_module_to_env_connector": null, "add_default_connectors_to_module_to_env_pipeline": true, "merge_env_runner_states": "training_only", "broadcast_env_runner_states": true, "episode_lookback_horizon": 1, "rollout_fragment_length": "auto", "batch_mode": "complete_episodes", "compress_observations": false, "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "enable_tf1_exec_eagerly": false, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "preprocessor_pref": "deepmind", "observation_filter": "NoFilter", "update_worker_filter_stats": true, "use_worker_filter_stats": true, "sampler_perf_stats_ema_coef": null, "_is_online": true, "num_learners": 0, "num_gpus_per_learner": 0, "num_cpus_per_learner": "auto", "num_aggregator_actors_per_learner": 0, "max_requests_in_flight_per_aggregator_actor": 3, "local_gpu_idx": 0, "max_requests_in_flight_per_learner": 3, "gamma": 1, "lr": 0.0002847858517, "grad_clip": 0.5, "grad_clip_by": "global_norm", "_train_batch_size_per_learner": 5000, "train_batch_size": 4000, "num_epochs": 1, "minibatch_size": 1000, "shuffle_batch_per_epoch": true, "model": {"fcnet_hiddens": [256, 256], "fcnet_activation": "tanh", "fcnet_weights_initializer": null, "fcnet_weights_initializer_config": null, "fcnet_bias_initializer": null, "fcnet_bias_initializer_config": null, "conv_filters": null, "conv_activation": "relu", "conv_kernel_initializer": null, "conv_kernel_initializer_config": null, "conv_bias_initializer": null, "conv_bias_initializer_config": null, "conv_transpose_kernel_initializer": null, "conv_transpose_kernel_initializer_config": null, "conv_transpose_bias_initializer": null, "conv_transpose_bias_initializer_config": null, "post_fcnet_hiddens": [], "post_fcnet_activation": "relu", "post_fcnet_weights_initializer": null, "post_fcnet_weights_initializer_config": null, "post_fcnet_bias_initializer": null, "post_fcnet_bias_initializer_config": null, "free_log_std": false, "log_std_clip_param": 20.0, "no_final_linear": false, "vf_share_layers": false, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "lstm_weights_initializer": null, "lstm_weights_initializer_config": null, "lstm_bias_initializer": null, "lstm_bias_initializer_config": null, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "attention_use_n_prev_actions": 0, "attention_use_n_prev_rewards": 0, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": null, "custom_model_config": {}, "custom_action_dist": null, "custom_preprocessor": null, "encoder_latent_dim": null, "always_check_shapes": false, "lstm_use_prev_action_reward": -1, "_use_default_native_models": -1, "_disable_preprocessor_api": false, "_disable_action_flattening": false}, "_learner_connector": null, "add_default_connectors_to_learner_pipeline": true, "learner_config_dict": {}, "optimizer": {}, "_learner_class": null, "callbacks_on_algorithm_init": null, "callbacks_on_env_runners_recreated": null, "callbacks_on_offline_eval_runners_recreated": null, "callbacks_on_checkpoint_loaded": null, "callbacks_on_environment_created": null, "callbacks_on_episode_created": null, "callbacks_on_episode_start": null, "callbacks_on_episode_step": null, "callbacks_on_episode_end": null, "callbacks_on_evaluate_start": null, "callbacks_on_evaluate_end": null, "callbacks_on_evaluate_offline_start": null, "callbacks_on_evaluate_offline_end": null, "callbacks_on_sample_end": null, "callbacks_on_train_result": null, "explore": true, "enable_rl_module_and_learner": true, "enable_env_runner_and_connector_v2": true, "_prior_exploration_config": {"type": "StochasticSampling"}, "count_steps_by": "env_steps", "policy_map_capacity": 100, "policy_mapping_fn": "<function AlgorithmConfig.DEFAULT_POLICY_MAPPING_FN at 0x385aedb20>", "policies_to_train": null, "policy_states_are_swappable": false, "observation_fn": null, "offline_data_class": null, "input_read_method": "read_parquet", "input_read_method_kwargs": {}, "input_read_schema": {}, "input_read_episodes": false, "input_read_sample_batches": false, "input_read_batch_size": null, "input_filesystem": null, "input_filesystem_kwargs": {}, "input_compress_columns": ["obs", "new_obs"], "input_spaces_jsonable": true, "materialize_data": false, "materialize_mapped_data": true, "map_batches_kwargs": {}, "iter_batches_kwargs": {}, "ignore_final_observation": false, "prelearner_class": null, "prelearner_buffer_class": null, "prelearner_buffer_kwargs": {}, "prelearner_module_synch_period": 10, "dataset_num_iters_per_learner": null, "input_config": {}, "actions_in_input_normalized": false, "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_config": {}, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "output_max_rows_per_file": null, "output_write_remaining_data": false, "output_write_method": "write_parquet", "output_write_method_kwargs": {}, "output_filesystem": null, "output_filesystem_kwargs": {}, "output_write_episodes": true, "offline_sampling": false, "evaluation_interval": 1, "evaluation_duration": 20, "evaluation_duration_unit": "episodes", "evaluation_sample_timeout_s": 120.0, "evaluation_auto_duration_min_env_steps_per_sample": 100, "evaluation_auto_duration_max_env_steps_per_sample": 2000, "evaluation_parallel_to_training": false, "evaluation_force_reset_envs_before_iteration": true, "evaluation_config": null, "off_policy_estimation_methods": {}, "ope_split_batch_by_episode": true, "evaluation_num_env_runners": 1, "in_evaluation": false, "sync_filters_on_rollout_workers_timeout_s": 10.0, "offline_evaluation_interval": null, "num_offline_eval_runners": 0, "offline_loss_for_module_fn": null, "offline_evaluation_duration": 1, "offline_evaluation_parallel_to_training": false, "offline_evaluation_timeout_s": 120.0, "num_cpus_per_offline_eval_runner": 1, "num_gpus_per_offline_eval_runner": 0, "custom_resources_per_offline_eval_runner": {}, "restart_failed_offline_eval_runners": true, "ignore_offline_eval_runner_failures": false, "max_num_offline_eval_runner_restarts": 1000, "offline_eval_runner_restore_timeout_s": 1800.0, "max_requests_in_flight_per_offline_eval_runner": 1, "validate_offline_eval_runners_after_construction": true, "offline_eval_runner_health_probe_timeout_s": 30.0, "offline_eval_rl_module_inference_only": false, "broadcast_offline_eval_runner_states": false, "offline_eval_batch_size_per_runner": 256, "dataset_num_iters_per_eval_runner": 1, "keep_per_episode_custom_metrics": false, "metrics_episode_collection_timeout_s": 60.0, "metrics_num_episodes_for_smoothing": 100, "min_time_s_per_iteration": null, "min_train_timesteps_per_iteration": 0, "min_sample_timesteps_per_iteration": 0, "log_gradients": true, "export_native_model_files": false, "checkpoint_trainable_policies_only": false, "logger_creator": null, "logger_config": null, "log_level": "WARN", "log_sys_usage": true, "fake_sampler": false, "seed": 9, "restart_failed_env_runners": true, "ignore_env_runner_failures": false, "max_num_env_runner_restarts": 1000, "delay_between_env_runner_restarts_s": 60.0, "restart_failed_sub_environments": false, "num_consecutive_env_runner_failures_tolerance": 100, "env_runner_health_probe_timeout_s": 30.0, "env_runner_restore_timeout_s": 1800.0, "_model_config": {}, "_rl_module_spec": "RLModuleSpec(module_class=None, observation_space=None, action_space=None, inference_only=False, learner_only=False, model_config=DefaultModelConfig(fcnet_hiddens=[60, 90], fcnet_activation='tanh', fcnet_kernel_initializer=None, fcnet_kernel_initializer_kwargs=None, fcnet_bias_initializer=None, fcnet_bias_initializer_kwargs=None, conv_filters=None, conv_activation='relu', conv_kernel_initializer=None, conv_kernel_initializer_kwargs=None, conv_bias_initializer=None, conv_bias_initializer_kwargs=None, head_fcnet_hiddens=[], head_fcnet_activation='relu', head_fcnet_kernel_initializer=None, head_fcnet_kernel_initializer_kwargs=None, head_fcnet_bias_initializer=None, head_fcnet_bias_initializer_kwargs=None, free_log_std=False, log_std_clip_param=20.0, vf_share_layers=True, use_lstm=False, max_seq_len=20, lstm_cell_size=256, lstm_use_prev_action=False, lstm_use_prev_reward=False, lstm_kernel_initializer=None, lstm_kernel_initializer_kwargs=None, lstm_bias_initializer=None, lstm_bias_initializer_kwargs=None), catalog_class=None, load_state_path=None, model_config_dict=None)", "algorithm_config_overrides_per_module": {}, "_per_module_overrides": {}, "_validate_config": true, "_use_msgpack_checkpoints": false, "_torch_grad_scaler_class": null, "_torch_lr_scheduler_classes": null, "_tf_policy_handles_more_than_one_loss": false, "_disable_preprocessor_api": false, "_disable_action_flattening": false, "_disable_initialize_loss_from_dummy_batch": false, "_dont_auto_sync_env_runner_states": false, "env_task_fn": -1, "enable_connectors": -1, "simple_optimizer": false, "policy_map_cache": -1, "worker_cls": -1, "synchronize_filters": -1, "enable_async_evaluation": -1, "custom_async_evaluation_function": -1, "_enable_rl_module_api": -1, "auto_wrap_old_gym_envs": -1, "always_attach_evaluation_results": -1, "replay_sequence_length": null, "_disable_execution_plan_api": -1, "use_critic": true, "use_gae": true, "use_kl_loss": true, "kl_coeff": 0.7464963036515, "kl_target": 0.0270990929592, "vf_loss_coeff": 0.6688075857018, "entropy_coeff": 0.0090570820258, "clip_param": 0.1221781641624, "vf_clip_param": 0.1027808522125, "entropy_coeff_schedule": null, "lr_schedule": null, "sgd_minibatch_size": -1, "vf_share_layers": -1, "__stdout_file__": null, "__stderr_file__": null, "lambda": 0.9099046732075, "input": "sampler", "policies": {"default_policy": [null, null, null, null]}, "callbacks": "<class 'ray.rllib.callbacks.callbacks.RLlibCallback'>", "create_env_on_driver": false, "custom_eval_function": null, "framework": "torch"}, "time_since_restore": 10.76491117477417, "iterations_since_restore": 6, "perf": {"cpu_util_percent": 44.633333333333326, "ram_util_percent": 79.36666666666667}}
{"timers": {"training_iteration": 1.8726858969964333, "restore_env_runners": 1.1837548279036337e-05, "training_step": 1.8725230057287248, "env_runner_sampling_timer": 1.7589783886425363, "learner_update_timer": 0.11026585111107219, "synch_weights": 0.0006252178008657875, "restore_eval_env_runners": 9.542012770473817e-06, "evaluation_iteration": 0.10964443866207065, "synch_eval_env_connectors": 0.00013859549697732714, "synch_env_connectors": 4.600451102571247e-06}, "env_runners": {"num_episodes_lifetime": -153875.0, "env_to_module_connector": {"connector_pipeline_timer": 5.1641713371585235e-05, "timers": {"connectors": {"add_observations_from_episodes_to_batch": 3.507938374396546e-06, "add_time_dim_to_batch_and_zero_pad": 2.836822861154038e-06, "batch_individual_items": 7.816308897529228e-06, "numpy_to_tensor": 1.097386390998187e-05, "add_states_from_episodes_to_batch": 1.9454620303468256e-06}}}, "num_episodes": 250.0, "env_step_timer": 1.7126551360559065e-05, "episode_len_min": 20, "num_agent_steps_sampled": {"default_agent": 5000.0}, "agent_episode_returns_mean": {"default_agent": 7.54}, "episode_return_mean": 7.54, "num_env_steps_sampled": 5000.0, "module_to_env_connector": {"timers": {"connectors": {"remove_single_ts_time_rank_from_batch": 6.74892553259152e-07, "un_batch_to_individual_items": 6.460663889692254e-06, "listify_data_for_vector_env": 1.3276030637640113e-05, "normalize_and_clip_actions": 1.1100646943049832e-05, "get_actions": 4.8938590754138416e-05, "tensor_to_numpy": 1.6116197989180256e-05}}, "connector_pipeline_timer": 0.00012592349543064882}, "episode_duration_sec_mean": 0.005522652332205323, "sample": 0.00581500332419046, "num_module_steps_sampled_lifetime": {"default_policy": -3077500.0}, "env_reset_timer": 5.2904600523592564e-05, "time_between_sampling": 0.0020420739869781114, "episode_len_max": 20, "weights_seq_no": 6.0, "num_env_steps_sampled_lifetime": -3077500.0, "env_to_module_sum_episodes_length_in": 10.36823839457432, "episode_len_mean": 20.0, "module_episode_returns_mean": {"default_policy": 7.54}, "episode_return_min": -5.5, "episode_return_max": 14.5, "num_agent_steps_sampled_lifetime": {"default_agent": -3077500.0}, "rlmodule_inference_timer": 3.552021540940113e-05, "env_to_module_sum_episodes_length_out": 10.36823839457432, "num_module_steps_sampled": {"default_policy": 5000.0}, "num_env_steps_sampled_lifetime_throughput": 3083.4481482695055}, "learners": {"default_policy": {"module_train_batch_size_mean": 1000.0, "vf_explained_var": 0.0011950135231018066, "num_module_steps_trained_lifetime": 42000, "entropy": 0.6684635877609253, "curr_kl_coeff": 0.0058320024982094765, "vf_loss_unclipped": 36.07630157470703, "diff_num_grad_updates_vs_sampler_policy": 1.0, "default_optimizer_learning_rate": 0.0002847858517, "total_loss": -0.14335104823112488, "mean_kl_loss": 0.0004201476403977722, "vf_loss": 0.100577712059021, "gradients_default_optimizer_global_norm": 0.03081803396344185, "weights_seq_no": 7.0, "num_module_steps_trained": 6000, "policy_loss": -0.2045687586069107, "curr_entropy_coeff": 0.0090570820258, "num_trainable_parameters": 6003, "num_module_steps_trained_lifetime_throughput": 415555.3930820813}, "__all_modules__": {"num_module_steps_trained": 6000, "num_trainable_parameters": 6003, "learner_connector_sum_episodes_length_in": 5000.0, "num_env_steps_trained": 31500, "learner_connector": {"timers": {"connectors": {"batch_individual_items": 0.03335267521000674, "numpy_to_tensor": 7.44750444795432e-05, "add_states_from_episodes_to_batch": 3.609675921730459e-06, "add_observations_from_episodes_to_batch": 0.0008047054473540897, "add_columns_from_episodes_to_train_batch": 0.03496132575847184, "add_time_dim_to_batch_and_zero_pad": 1.6183539000166237e-05, "add_one_ts_to_episodes_and_truncate": 0.00753914850263922, "general_advantage_estimation": 0.006918135212152397}}, "connector_pipeline_timer": 0.08381297686058067}, "num_module_steps_trained_lifetime": 42000, "learner_connector_sum_episodes_length_out": 5250.0, "num_env_steps_trained_lifetime": 220500, "num_non_trainable_parameters": 0, "num_env_steps_trained_lifetime_throughput": 2140006.7004842977, "num_module_steps_trained_throughput": 410447.78355220566, "num_module_steps_trained_lifetime_throughput": 409184.87728785956}}, "num_training_step_calls_per_iteration": 1, "evaluation": {"env_runners": {"num_env_steps_sampled": 400, "env_to_module_connector": {"timers": {"connectors": {"add_states_from_episodes_to_batch": 1.7667319629956752e-06, "add_observations_from_episodes_to_batch": 3.2661660557103404e-06, "add_time_dim_to_batch_and_zero_pad": 2.690212332545e-06, "batch_individual_items": 7.4179973334547656e-06, "numpy_to_tensor": 1.064364693960464e-05}}, "connector_pipeline_timer": 4.939299658131387e-05}, "episode_len_max": 20, "num_module_steps_sampled_lifetime": {"default_policy": 2800}, "rlmodule_inference_timer": 3.268305874678289e-05, "env_to_module_sum_episodes_length_out": 10.368238394572801, "module_to_env_connector": {"connector_pipeline_timer": 0.00012010083388145825, "timers": {"connectors": {"tensor_to_numpy": 1.5275913948738544e-05, "listify_data_for_vector_env": 1.3077683548775117e-05, "get_actions": 4.5213161945242354e-05, "normalize_and_clip_actions": 1.0761409501826772e-05, "remove_single_ts_time_rank_from_batch": 6.563083341748459e-07, "un_batch_to_individual_items": 6.534242125995444e-06}}}, "episode_len_min": 20, "env_reset_timer": 0.0002026859288002897, "episode_return_max": 15.5, "num_episodes_lifetime": 140, "num_episodes": 20, "episode_return_mean": -0.1, "num_module_steps_sampled": {"default_policy": 400}, "episode_duration_sec_mean": 0.004897942489478737, "sample": 0.10021893347660092, "weights_seq_no": 7.0, "module_episode_returns_mean": {"default_policy": -0.1}, "num_agent_steps_sampled_lifetime": {"default_agent": 2800}, "env_step_timer": 1.7112896235113475e-05, "num_agent_steps_sampled": {"default_agent": 400}, "agent_episode_returns_mean": {"default_agent": -0.1}, "num_env_steps_sampled_lifetime": 35400, "env_to_module_sum_episodes_length_in": 10.368238394572801, "episode_len_mean": 20.0, "episode_return_min": -13.5, "time_between_sampling": 1.6488242918518163}, "num_healthy_workers": 1, "actor_manager_num_outstanding_async_reqs": 0, "num_remote_worker_restarts": 0}, "num_env_steps_sampled_lifetime": -3077500.0, "fault_tolerance": {"num_healthy_workers": 0, "num_remote_worker_restarts": 0}, "env_runner_group": {"actor_manager_num_outstanding_async_reqs": 0}, "done": false, "training_iteration": 7, "trial_id": "4d67b_00000", "date": "2025-08-11_19-22-30", "timestamp": 1754932950, "time_this_iter_s": 1.9138681888580322, "time_total_s": 12.678779363632202, "pid": 14356, "hostname": "Mac", "node_ip": "127.0.0.1", "config": {"exploration_config": {}, "extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "placement_strategy": "PACK", "num_gpus": 0, "_fake_gpus": false, "num_cpus_for_main_process": 2, "eager_tracing": true, "eager_max_retraces": 20, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "torch_compile_learner": false, "torch_compile_learner_what_to_compile": "forward_train", "torch_compile_learner_dynamo_backend": "aot_eager", "torch_compile_learner_dynamo_mode": null, "torch_compile_worker": false, "torch_compile_worker_dynamo_backend": "aot_eager", "torch_compile_worker_dynamo_mode": null, "torch_ddp_kwargs": {}, "torch_skip_nan_gradients": false, "env": "Umbrella", "env_config": {}, "observation_space": null, "action_space": null, "clip_rewards": null, "normalize_actions": true, "clip_actions": false, "_is_atari": null, "disable_env_checking": false, "render_env": false, "action_mask_key": "action_mask", "env_runner_cls": null, "num_env_runners": 0, "create_local_env_runner": true, "num_envs_per_env_runner": 1, "gym_env_vectorize_mode": "SYNC", "num_cpus_per_env_runner": 1, "num_gpus_per_env_runner": 0, "custom_resources_per_env_runner": {}, "validate_env_runners_after_construction": true, "episodes_to_numpy": true, "max_requests_in_flight_per_env_runner": 1, "sample_timeout_s": 60.0, "_env_to_module_connector": null, "add_default_connectors_to_env_to_module_pipeline": true, "_module_to_env_connector": null, "add_default_connectors_to_module_to_env_pipeline": true, "merge_env_runner_states": "training_only", "broadcast_env_runner_states": true, "episode_lookback_horizon": 1, "rollout_fragment_length": "auto", "batch_mode": "complete_episodes", "compress_observations": false, "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "enable_tf1_exec_eagerly": false, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "preprocessor_pref": "deepmind", "observation_filter": "NoFilter", "update_worker_filter_stats": true, "use_worker_filter_stats": true, "sampler_perf_stats_ema_coef": null, "_is_online": true, "num_learners": 0, "num_gpus_per_learner": 0, "num_cpus_per_learner": "auto", "num_aggregator_actors_per_learner": 0, "max_requests_in_flight_per_aggregator_actor": 3, "local_gpu_idx": 0, "max_requests_in_flight_per_learner": 3, "gamma": 1, "lr": 0.0002847858517, "grad_clip": 0.5, "grad_clip_by": "global_norm", "_train_batch_size_per_learner": 5000, "train_batch_size": 4000, "num_epochs": 1, "minibatch_size": 1000, "shuffle_batch_per_epoch": true, "model": {"fcnet_hiddens": [256, 256], "fcnet_activation": "tanh", "fcnet_weights_initializer": null, "fcnet_weights_initializer_config": null, "fcnet_bias_initializer": null, "fcnet_bias_initializer_config": null, "conv_filters": null, "conv_activation": "relu", "conv_kernel_initializer": null, "conv_kernel_initializer_config": null, "conv_bias_initializer": null, "conv_bias_initializer_config": null, "conv_transpose_kernel_initializer": null, "conv_transpose_kernel_initializer_config": null, "conv_transpose_bias_initializer": null, "conv_transpose_bias_initializer_config": null, "post_fcnet_hiddens": [], "post_fcnet_activation": "relu", "post_fcnet_weights_initializer": null, "post_fcnet_weights_initializer_config": null, "post_fcnet_bias_initializer": null, "post_fcnet_bias_initializer_config": null, "free_log_std": false, "log_std_clip_param": 20.0, "no_final_linear": false, "vf_share_layers": false, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "lstm_weights_initializer": null, "lstm_weights_initializer_config": null, "lstm_bias_initializer": null, "lstm_bias_initializer_config": null, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "attention_use_n_prev_actions": 0, "attention_use_n_prev_rewards": 0, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": null, "custom_model_config": {}, "custom_action_dist": null, "custom_preprocessor": null, "encoder_latent_dim": null, "always_check_shapes": false, "lstm_use_prev_action_reward": -1, "_use_default_native_models": -1, "_disable_preprocessor_api": false, "_disable_action_flattening": false}, "_learner_connector": null, "add_default_connectors_to_learner_pipeline": true, "learner_config_dict": {}, "optimizer": {}, "_learner_class": null, "callbacks_on_algorithm_init": null, "callbacks_on_env_runners_recreated": null, "callbacks_on_offline_eval_runners_recreated": null, "callbacks_on_checkpoint_loaded": null, "callbacks_on_environment_created": null, "callbacks_on_episode_created": null, "callbacks_on_episode_start": null, "callbacks_on_episode_step": null, "callbacks_on_episode_end": null, "callbacks_on_evaluate_start": null, "callbacks_on_evaluate_end": null, "callbacks_on_evaluate_offline_start": null, "callbacks_on_evaluate_offline_end": null, "callbacks_on_sample_end": null, "callbacks_on_train_result": null, "explore": true, "enable_rl_module_and_learner": true, "enable_env_runner_and_connector_v2": true, "_prior_exploration_config": {"type": "StochasticSampling"}, "count_steps_by": "env_steps", "policy_map_capacity": 100, "policy_mapping_fn": "<function AlgorithmConfig.DEFAULT_POLICY_MAPPING_FN at 0x385aedb20>", "policies_to_train": null, "policy_states_are_swappable": false, "observation_fn": null, "offline_data_class": null, "input_read_method": "read_parquet", "input_read_method_kwargs": {}, "input_read_schema": {}, "input_read_episodes": false, "input_read_sample_batches": false, "input_read_batch_size": null, "input_filesystem": null, "input_filesystem_kwargs": {}, "input_compress_columns": ["obs", "new_obs"], "input_spaces_jsonable": true, "materialize_data": false, "materialize_mapped_data": true, "map_batches_kwargs": {}, "iter_batches_kwargs": {}, "ignore_final_observation": false, "prelearner_class": null, "prelearner_buffer_class": null, "prelearner_buffer_kwargs": {}, "prelearner_module_synch_period": 10, "dataset_num_iters_per_learner": null, "input_config": {}, "actions_in_input_normalized": false, "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_config": {}, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "output_max_rows_per_file": null, "output_write_remaining_data": false, "output_write_method": "write_parquet", "output_write_method_kwargs": {}, "output_filesystem": null, "output_filesystem_kwargs": {}, "output_write_episodes": true, "offline_sampling": false, "evaluation_interval": 1, "evaluation_duration": 20, "evaluation_duration_unit": "episodes", "evaluation_sample_timeout_s": 120.0, "evaluation_auto_duration_min_env_steps_per_sample": 100, "evaluation_auto_duration_max_env_steps_per_sample": 2000, "evaluation_parallel_to_training": false, "evaluation_force_reset_envs_before_iteration": true, "evaluation_config": null, "off_policy_estimation_methods": {}, "ope_split_batch_by_episode": true, "evaluation_num_env_runners": 1, "in_evaluation": false, "sync_filters_on_rollout_workers_timeout_s": 10.0, "offline_evaluation_interval": null, "num_offline_eval_runners": 0, "offline_loss_for_module_fn": null, "offline_evaluation_duration": 1, "offline_evaluation_parallel_to_training": false, "offline_evaluation_timeout_s": 120.0, "num_cpus_per_offline_eval_runner": 1, "num_gpus_per_offline_eval_runner": 0, "custom_resources_per_offline_eval_runner": {}, "restart_failed_offline_eval_runners": true, "ignore_offline_eval_runner_failures": false, "max_num_offline_eval_runner_restarts": 1000, "offline_eval_runner_restore_timeout_s": 1800.0, "max_requests_in_flight_per_offline_eval_runner": 1, "validate_offline_eval_runners_after_construction": true, "offline_eval_runner_health_probe_timeout_s": 30.0, "offline_eval_rl_module_inference_only": false, "broadcast_offline_eval_runner_states": false, "offline_eval_batch_size_per_runner": 256, "dataset_num_iters_per_eval_runner": 1, "keep_per_episode_custom_metrics": false, "metrics_episode_collection_timeout_s": 60.0, "metrics_num_episodes_for_smoothing": 100, "min_time_s_per_iteration": null, "min_train_timesteps_per_iteration": 0, "min_sample_timesteps_per_iteration": 0, "log_gradients": true, "export_native_model_files": false, "checkpoint_trainable_policies_only": false, "logger_creator": null, "logger_config": null, "log_level": "WARN", "log_sys_usage": true, "fake_sampler": false, "seed": 9, "restart_failed_env_runners": true, "ignore_env_runner_failures": false, "max_num_env_runner_restarts": 1000, "delay_between_env_runner_restarts_s": 60.0, "restart_failed_sub_environments": false, "num_consecutive_env_runner_failures_tolerance": 100, "env_runner_health_probe_timeout_s": 30.0, "env_runner_restore_timeout_s": 1800.0, "_model_config": {}, "_rl_module_spec": "RLModuleSpec(module_class=None, observation_space=None, action_space=None, inference_only=False, learner_only=False, model_config=DefaultModelConfig(fcnet_hiddens=[60, 90], fcnet_activation='tanh', fcnet_kernel_initializer=None, fcnet_kernel_initializer_kwargs=None, fcnet_bias_initializer=None, fcnet_bias_initializer_kwargs=None, conv_filters=None, conv_activation='relu', conv_kernel_initializer=None, conv_kernel_initializer_kwargs=None, conv_bias_initializer=None, conv_bias_initializer_kwargs=None, head_fcnet_hiddens=[], head_fcnet_activation='relu', head_fcnet_kernel_initializer=None, head_fcnet_kernel_initializer_kwargs=None, head_fcnet_bias_initializer=None, head_fcnet_bias_initializer_kwargs=None, free_log_std=False, log_std_clip_param=20.0, vf_share_layers=True, use_lstm=False, max_seq_len=20, lstm_cell_size=256, lstm_use_prev_action=False, lstm_use_prev_reward=False, lstm_kernel_initializer=None, lstm_kernel_initializer_kwargs=None, lstm_bias_initializer=None, lstm_bias_initializer_kwargs=None), catalog_class=None, load_state_path=None, model_config_dict=None)", "algorithm_config_overrides_per_module": {}, "_per_module_overrides": {}, "_validate_config": true, "_use_msgpack_checkpoints": false, "_torch_grad_scaler_class": null, "_torch_lr_scheduler_classes": null, "_tf_policy_handles_more_than_one_loss": false, "_disable_preprocessor_api": false, "_disable_action_flattening": false, "_disable_initialize_loss_from_dummy_batch": false, "_dont_auto_sync_env_runner_states": false, "env_task_fn": -1, "enable_connectors": -1, "simple_optimizer": false, "policy_map_cache": -1, "worker_cls": -1, "synchronize_filters": -1, "enable_async_evaluation": -1, "custom_async_evaluation_function": -1, "_enable_rl_module_api": -1, "auto_wrap_old_gym_envs": -1, "always_attach_evaluation_results": -1, "replay_sequence_length": null, "_disable_execution_plan_api": -1, "use_critic": true, "use_gae": true, "use_kl_loss": true, "kl_coeff": 0.7464963036515, "kl_target": 0.0270990929592, "vf_loss_coeff": 0.6688075857018, "entropy_coeff": 0.0090570820258, "clip_param": 0.1221781641624, "vf_clip_param": 0.1027808522125, "entropy_coeff_schedule": null, "lr_schedule": null, "sgd_minibatch_size": -1, "vf_share_layers": -1, "__stdout_file__": null, "__stderr_file__": null, "lambda": 0.9099046732075, "input": "sampler", "policies": {"default_policy": [null, null, null, null]}, "callbacks": "<class 'ray.rllib.callbacks.callbacks.RLlibCallback'>", "create_env_on_driver": false, "custom_eval_function": null, "framework": "torch"}, "time_since_restore": 12.678779363632202, "iterations_since_restore": 7, "perf": {"cpu_util_percent": 53.63333333333333, "ram_util_percent": 79.0}}
{"timers": {"training_iteration": 1.87387953510678, "restore_env_runners": 1.1773342009645264e-05, "training_step": 1.873709836080989, "env_runner_sampling_timer": 1.7577864372554624, "learner_update_timer": 0.11256915842969523, "synch_weights": 0.0006362260429932833, "restore_eval_env_runners": 9.601592658862333e-06, "evaluation_iteration": 0.10988826761591544, "synch_eval_env_connectors": 0.0001388666314588818, "synch_env_connectors": 4.610277051587296e-06}, "env_runners": {"num_episodes_lifetime": -184750.0, "env_to_module_connector": {"connector_pipeline_timer": 4.901784946368784e-05, "timers": {"connectors": {"add_observations_from_episodes_to_batch": 3.288233076600425e-06, "add_time_dim_to_batch_and_zero_pad": 2.680359657543325e-06, "batch_individual_items": 7.015526111512613e-06, "numpy_to_tensor": 9.69089805353101e-06, "add_states_from_episodes_to_batch": 1.8353802575816439e-06}}}, "num_episodes": 250.0, "env_step_timer": 1.6075836494333176e-05, "episode_len_min": 20, "num_agent_steps_sampled": {"default_agent": 5000.0}, "agent_episode_returns_mean": {"default_agent": 8.419999999999998}, "episode_return_mean": 8.419999999999998, "num_env_steps_sampled": 5000.0, "module_to_env_connector": {"timers": {"connectors": {"remove_single_ts_time_rank_from_batch": 6.209926776563686e-07, "un_batch_to_individual_items": 5.8333423580142905e-06, "listify_data_for_vector_env": 1.2115298229523059e-05, "normalize_and_clip_actions": 1.0561180947608345e-05, "get_actions": 4.432799715971517e-05, "tensor_to_numpy": 1.455431238178628e-05}}, "connector_pipeline_timer": 0.00011611039380532026}, "episode_duration_sec_mean": 0.005466223639436065, "sample": 0.005780120134417906, "num_module_steps_sampled_lifetime": {"default_policy": -3695000.0}, "env_reset_timer": 4.4944682397474345e-05, "time_between_sampling": 0.001701459490679889, "episode_len_max": 20, "weights_seq_no": 7.0, "num_env_steps_sampled_lifetime": -3695000.0, "env_to_module_sum_episodes_length_in": 10.36823839457432, "episode_len_mean": 20.0, "module_episode_returns_mean": {"default_policy": 8.419999999999998}, "episode_return_min": -5.5, "episode_return_max": 14.5, "num_agent_steps_sampled_lifetime": {"default_agent": -3695000.0}, "rlmodule_inference_timer": 4.8882556253015224e-05, "env_to_module_sum_episodes_length_out": 10.36823839457432, "num_module_steps_sampled": {"default_policy": 5000.0}, "num_env_steps_sampled_lifetime_throughput": 3439.6495859305396}, "learners": {"default_policy": {"module_train_batch_size_mean": 1000.0, "vf_explained_var": 0.0018621087074279785, "num_module_steps_trained_lifetime": 48000, "entropy": 0.6606499552726746, "curr_kl_coeff": 0.0029160012491047382, "vf_loss_unclipped": 35.76835250854492, "diff_num_grad_updates_vs_sampler_policy": 1.0, "default_optimizer_learning_rate": 0.0002847858517, "total_loss": -0.045362912118434906, "mean_kl_loss": 0.0003812006616499275, "vf_loss": 0.10039109736680984, "gradients_default_optimizer_global_norm": 0.0560244545340538, "weights_seq_no": 8.0, "num_module_steps_trained": 6000, "policy_loss": -0.10652390867471695, "curr_entropy_coeff": 0.0090570820258, "num_trainable_parameters": 6003, "num_module_steps_trained_lifetime_throughput": 413696.46926674416}, "__all_modules__": {"num_module_steps_trained": 6000, "num_trainable_parameters": 6003, "learner_connector_sum_episodes_length_in": 5000.0, "num_env_steps_trained": 31500, "learner_connector": {"timers": {"connectors": {"batch_individual_items": 0.03362797803792124, "numpy_to_tensor": 0.0001489373742611393, "add_states_from_episodes_to_batch": 3.602329090391534e-06, "add_observations_from_episodes_to_batch": 0.0008072688136030633, "add_columns_from_episodes_to_train_batch": 0.03494881542163542, "add_time_dim_to_batch_and_zero_pad": 1.611170313131576e-05, "add_one_ts_to_episodes_and_truncate": 0.0075390749380312835, "general_advantage_estimation": 0.007855324279667241}}, "connector_pipeline_timer": 0.08512363625239412}, "num_module_steps_trained_lifetime": 48000, "learner_connector_sum_episodes_length_out": 5250.0, "num_env_steps_trained_lifetime": 252000, "num_non_trainable_parameters": 0, "num_env_steps_trained_lifetime_throughput": 2132215.8751423815, "num_module_steps_trained_throughput": 408848.684475917, "num_module_steps_trained_lifetime_throughput": 407634.27692729636}}, "num_training_step_calls_per_iteration": 1, "evaluation": {"env_runners": {"num_env_steps_sampled": 400, "env_to_module_connector": {"timers": {"connectors": {"add_states_from_episodes_to_batch": 2.5529099917967875e-06, "add_observations_from_episodes_to_batch": 5.0092853467959175e-06, "add_time_dim_to_batch_and_zero_pad": 4.845464561421059e-06, "batch_individual_items": 9.764820226305883e-06, "numpy_to_tensor": 1.8839539237415002e-05}}, "connector_pipeline_timer": 7.130804549451696e-05}, "episode_len_max": 20, "num_module_steps_sampled_lifetime": {"default_policy": 3200}, "rlmodule_inference_timer": 8.54794563271165e-05, "env_to_module_sum_episodes_length_out": 10.3682383945743, "module_to_env_connector": {"connector_pipeline_timer": 0.00023108475977736404, "timers": {"connectors": {"tensor_to_numpy": 2.8590791492838707e-05, "listify_data_for_vector_env": 2.1596526669502204e-05, "get_actions": 0.00011147512510560289, "normalize_and_clip_actions": 1.5866229465166022e-05, "remove_single_ts_time_rank_from_batch": 8.771301136049023e-07, "un_batch_to_individual_items": 8.719040988296669e-06}}}, "episode_len_min": 20, "env_reset_timer": 0.00020237656920241715, "episode_return_max": 15.5, "num_episodes_lifetime": 160, "num_episodes": 20, "episode_return_mean": -0.1, "num_module_steps_sampled": {"default_policy": 400}, "episode_duration_sec_mean": 0.005851250431733206, "sample": 0.10120016664145061, "weights_seq_no": 8.0, "module_episode_returns_mean": {"default_policy": -0.1}, "num_agent_steps_sampled_lifetime": {"default_agent": 3200}, "env_step_timer": 2.5492797003734385e-05, "num_agent_steps_sampled": {"default_agent": 400}, "agent_episode_returns_mean": {"default_agent": -0.1}, "num_env_steps_sampled_lifetime": 40400, "env_to_module_sum_episodes_length_in": 10.3682383945743, "episode_len_mean": 20.0, "episode_return_min": -13.5, "time_between_sampling": 1.6524961881037734}, "num_healthy_workers": 1, "actor_manager_num_outstanding_async_reqs": 0, "num_remote_worker_restarts": 0}, "num_env_steps_sampled_lifetime": -3695000.0, "fault_tolerance": {"num_healthy_workers": 0, "num_remote_worker_restarts": 0}, "env_runner_group": {"actor_manager_num_outstanding_async_reqs": 0}, "done": false, "training_iteration": 8, "trial_id": "4d67b_00000", "date": "2025-08-11_19-22-32", "timestamp": 1754932952, "time_this_iter_s": 2.2066049575805664, "time_total_s": 14.885384321212769, "pid": 14356, "hostname": "Mac", "node_ip": "127.0.0.1", "config": {"exploration_config": {}, "extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "placement_strategy": "PACK", "num_gpus": 0, "_fake_gpus": false, "num_cpus_for_main_process": 2, "eager_tracing": true, "eager_max_retraces": 20, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "torch_compile_learner": false, "torch_compile_learner_what_to_compile": "forward_train", "torch_compile_learner_dynamo_backend": "aot_eager", "torch_compile_learner_dynamo_mode": null, "torch_compile_worker": false, "torch_compile_worker_dynamo_backend": "aot_eager", "torch_compile_worker_dynamo_mode": null, "torch_ddp_kwargs": {}, "torch_skip_nan_gradients": false, "env": "Umbrella", "env_config": {}, "observation_space": null, "action_space": null, "clip_rewards": null, "normalize_actions": true, "clip_actions": false, "_is_atari": null, "disable_env_checking": false, "render_env": false, "action_mask_key": "action_mask", "env_runner_cls": null, "num_env_runners": 0, "create_local_env_runner": true, "num_envs_per_env_runner": 1, "gym_env_vectorize_mode": "SYNC", "num_cpus_per_env_runner": 1, "num_gpus_per_env_runner": 0, "custom_resources_per_env_runner": {}, "validate_env_runners_after_construction": true, "episodes_to_numpy": true, "max_requests_in_flight_per_env_runner": 1, "sample_timeout_s": 60.0, "_env_to_module_connector": null, "add_default_connectors_to_env_to_module_pipeline": true, "_module_to_env_connector": null, "add_default_connectors_to_module_to_env_pipeline": true, "merge_env_runner_states": "training_only", "broadcast_env_runner_states": true, "episode_lookback_horizon": 1, "rollout_fragment_length": "auto", "batch_mode": "complete_episodes", "compress_observations": false, "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "enable_tf1_exec_eagerly": false, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "preprocessor_pref": "deepmind", "observation_filter": "NoFilter", "update_worker_filter_stats": true, "use_worker_filter_stats": true, "sampler_perf_stats_ema_coef": null, "_is_online": true, "num_learners": 0, "num_gpus_per_learner": 0, "num_cpus_per_learner": "auto", "num_aggregator_actors_per_learner": 0, "max_requests_in_flight_per_aggregator_actor": 3, "local_gpu_idx": 0, "max_requests_in_flight_per_learner": 3, "gamma": 1, "lr": 0.0002847858517, "grad_clip": 0.5, "grad_clip_by": "global_norm", "_train_batch_size_per_learner": 5000, "train_batch_size": 4000, "num_epochs": 1, "minibatch_size": 1000, "shuffle_batch_per_epoch": true, "model": {"fcnet_hiddens": [256, 256], "fcnet_activation": "tanh", "fcnet_weights_initializer": null, "fcnet_weights_initializer_config": null, "fcnet_bias_initializer": null, "fcnet_bias_initializer_config": null, "conv_filters": null, "conv_activation": "relu", "conv_kernel_initializer": null, "conv_kernel_initializer_config": null, "conv_bias_initializer": null, "conv_bias_initializer_config": null, "conv_transpose_kernel_initializer": null, "conv_transpose_kernel_initializer_config": null, "conv_transpose_bias_initializer": null, "conv_transpose_bias_initializer_config": null, "post_fcnet_hiddens": [], "post_fcnet_activation": "relu", "post_fcnet_weights_initializer": null, "post_fcnet_weights_initializer_config": null, "post_fcnet_bias_initializer": null, "post_fcnet_bias_initializer_config": null, "free_log_std": false, "log_std_clip_param": 20.0, "no_final_linear": false, "vf_share_layers": false, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "lstm_weights_initializer": null, "lstm_weights_initializer_config": null, "lstm_bias_initializer": null, "lstm_bias_initializer_config": null, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "attention_use_n_prev_actions": 0, "attention_use_n_prev_rewards": 0, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": null, "custom_model_config": {}, "custom_action_dist": null, "custom_preprocessor": null, "encoder_latent_dim": null, "always_check_shapes": false, "lstm_use_prev_action_reward": -1, "_use_default_native_models": -1, "_disable_preprocessor_api": false, "_disable_action_flattening": false}, "_learner_connector": null, "add_default_connectors_to_learner_pipeline": true, "learner_config_dict": {}, "optimizer": {}, "_learner_class": null, "callbacks_on_algorithm_init": null, "callbacks_on_env_runners_recreated": null, "callbacks_on_offline_eval_runners_recreated": null, "callbacks_on_checkpoint_loaded": null, "callbacks_on_environment_created": null, "callbacks_on_episode_created": null, "callbacks_on_episode_start": null, "callbacks_on_episode_step": null, "callbacks_on_episode_end": null, "callbacks_on_evaluate_start": null, "callbacks_on_evaluate_end": null, "callbacks_on_evaluate_offline_start": null, "callbacks_on_evaluate_offline_end": null, "callbacks_on_sample_end": null, "callbacks_on_train_result": null, "explore": true, "enable_rl_module_and_learner": true, "enable_env_runner_and_connector_v2": true, "_prior_exploration_config": {"type": "StochasticSampling"}, "count_steps_by": "env_steps", "policy_map_capacity": 100, "policy_mapping_fn": "<function AlgorithmConfig.DEFAULT_POLICY_MAPPING_FN at 0x385aedb20>", "policies_to_train": null, "policy_states_are_swappable": false, "observation_fn": null, "offline_data_class": null, "input_read_method": "read_parquet", "input_read_method_kwargs": {}, "input_read_schema": {}, "input_read_episodes": false, "input_read_sample_batches": false, "input_read_batch_size": null, "input_filesystem": null, "input_filesystem_kwargs": {}, "input_compress_columns": ["obs", "new_obs"], "input_spaces_jsonable": true, "materialize_data": false, "materialize_mapped_data": true, "map_batches_kwargs": {}, "iter_batches_kwargs": {}, "ignore_final_observation": false, "prelearner_class": null, "prelearner_buffer_class": null, "prelearner_buffer_kwargs": {}, "prelearner_module_synch_period": 10, "dataset_num_iters_per_learner": null, "input_config": {}, "actions_in_input_normalized": false, "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_config": {}, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "output_max_rows_per_file": null, "output_write_remaining_data": false, "output_write_method": "write_parquet", "output_write_method_kwargs": {}, "output_filesystem": null, "output_filesystem_kwargs": {}, "output_write_episodes": true, "offline_sampling": false, "evaluation_interval": 1, "evaluation_duration": 20, "evaluation_duration_unit": "episodes", "evaluation_sample_timeout_s": 120.0, "evaluation_auto_duration_min_env_steps_per_sample": 100, "evaluation_auto_duration_max_env_steps_per_sample": 2000, "evaluation_parallel_to_training": false, "evaluation_force_reset_envs_before_iteration": true, "evaluation_config": null, "off_policy_estimation_methods": {}, "ope_split_batch_by_episode": true, "evaluation_num_env_runners": 1, "in_evaluation": false, "sync_filters_on_rollout_workers_timeout_s": 10.0, "offline_evaluation_interval": null, "num_offline_eval_runners": 0, "offline_loss_for_module_fn": null, "offline_evaluation_duration": 1, "offline_evaluation_parallel_to_training": false, "offline_evaluation_timeout_s": 120.0, "num_cpus_per_offline_eval_runner": 1, "num_gpus_per_offline_eval_runner": 0, "custom_resources_per_offline_eval_runner": {}, "restart_failed_offline_eval_runners": true, "ignore_offline_eval_runner_failures": false, "max_num_offline_eval_runner_restarts": 1000, "offline_eval_runner_restore_timeout_s": 1800.0, "max_requests_in_flight_per_offline_eval_runner": 1, "validate_offline_eval_runners_after_construction": true, "offline_eval_runner_health_probe_timeout_s": 30.0, "offline_eval_rl_module_inference_only": false, "broadcast_offline_eval_runner_states": false, "offline_eval_batch_size_per_runner": 256, "dataset_num_iters_per_eval_runner": 1, "keep_per_episode_custom_metrics": false, "metrics_episode_collection_timeout_s": 60.0, "metrics_num_episodes_for_smoothing": 100, "min_time_s_per_iteration": null, "min_train_timesteps_per_iteration": 0, "min_sample_timesteps_per_iteration": 0, "log_gradients": true, "export_native_model_files": false, "checkpoint_trainable_policies_only": false, "logger_creator": null, "logger_config": null, "log_level": "WARN", "log_sys_usage": true, "fake_sampler": false, "seed": 9, "restart_failed_env_runners": true, "ignore_env_runner_failures": false, "max_num_env_runner_restarts": 1000, "delay_between_env_runner_restarts_s": 60.0, "restart_failed_sub_environments": false, "num_consecutive_env_runner_failures_tolerance": 100, "env_runner_health_probe_timeout_s": 30.0, "env_runner_restore_timeout_s": 1800.0, "_model_config": {}, "_rl_module_spec": "RLModuleSpec(module_class=None, observation_space=None, action_space=None, inference_only=False, learner_only=False, model_config=DefaultModelConfig(fcnet_hiddens=[60, 90], fcnet_activation='tanh', fcnet_kernel_initializer=None, fcnet_kernel_initializer_kwargs=None, fcnet_bias_initializer=None, fcnet_bias_initializer_kwargs=None, conv_filters=None, conv_activation='relu', conv_kernel_initializer=None, conv_kernel_initializer_kwargs=None, conv_bias_initializer=None, conv_bias_initializer_kwargs=None, head_fcnet_hiddens=[], head_fcnet_activation='relu', head_fcnet_kernel_initializer=None, head_fcnet_kernel_initializer_kwargs=None, head_fcnet_bias_initializer=None, head_fcnet_bias_initializer_kwargs=None, free_log_std=False, log_std_clip_param=20.0, vf_share_layers=True, use_lstm=False, max_seq_len=20, lstm_cell_size=256, lstm_use_prev_action=False, lstm_use_prev_reward=False, lstm_kernel_initializer=None, lstm_kernel_initializer_kwargs=None, lstm_bias_initializer=None, lstm_bias_initializer_kwargs=None), catalog_class=None, load_state_path=None, model_config_dict=None)", "algorithm_config_overrides_per_module": {}, "_per_module_overrides": {}, "_validate_config": true, "_use_msgpack_checkpoints": false, "_torch_grad_scaler_class": null, "_torch_lr_scheduler_classes": null, "_tf_policy_handles_more_than_one_loss": false, "_disable_preprocessor_api": false, "_disable_action_flattening": false, "_disable_initialize_loss_from_dummy_batch": false, "_dont_auto_sync_env_runner_states": false, "env_task_fn": -1, "enable_connectors": -1, "simple_optimizer": false, "policy_map_cache": -1, "worker_cls": -1, "synchronize_filters": -1, "enable_async_evaluation": -1, "custom_async_evaluation_function": -1, "_enable_rl_module_api": -1, "auto_wrap_old_gym_envs": -1, "always_attach_evaluation_results": -1, "replay_sequence_length": null, "_disable_execution_plan_api": -1, "use_critic": true, "use_gae": true, "use_kl_loss": true, "kl_coeff": 0.7464963036515, "kl_target": 0.0270990929592, "vf_loss_coeff": 0.6688075857018, "entropy_coeff": 0.0090570820258, "clip_param": 0.1221781641624, "vf_clip_param": 0.1027808522125, "entropy_coeff_schedule": null, "lr_schedule": null, "sgd_minibatch_size": -1, "vf_share_layers": -1, "__stdout_file__": null, "__stderr_file__": null, "lambda": 0.9099046732075, "input": "sampler", "policies": {"default_policy": [null, null, null, null]}, "callbacks": "<class 'ray.rllib.callbacks.callbacks.RLlibCallback'>", "create_env_on_driver": false, "custom_eval_function": null, "framework": "torch"}, "time_since_restore": 14.885384321212769, "iterations_since_restore": 8, "perf": {"cpu_util_percent": 48.833333333333336, "ram_util_percent": 80.56666666666666}}
{"timers": {"training_iteration": 1.871452658505419, "restore_env_runners": 1.1721858220894084e-05, "training_step": 1.8712826989706965, "env_runner_sampling_timer": 1.7542668128830663, "learner_update_timer": 0.11366419101456317, "synch_weights": 0.0006352262820686319, "restore_eval_env_runners": 1.0130576834719194e-05, "evaluation_iteration": 0.11089708619010825, "synch_eval_env_connectors": 0.00013944796501085305, "synch_env_connectors": 4.641254029806255e-06}, "env_runners": {"num_episodes_lifetime": -215625.0, "env_to_module_connector": {"connector_pipeline_timer": 4.454749301518001e-05, "timers": {"connectors": {"add_observations_from_episodes_to_batch": 2.9737210824244546e-06, "add_time_dim_to_batch_and_zero_pad": 2.481179734691132e-06, "batch_individual_items": 6.422992175427401e-06, "numpy_to_tensor": 8.854415814639653e-06, "add_states_from_episodes_to_batch": 1.7603434072943299e-06}}}, "num_episodes": 250.0, "env_step_timer": 1.3977860419153345e-05, "episode_len_min": 20, "num_agent_steps_sampled": {"default_agent": 5000.0}, "agent_episode_returns_mean": {"default_agent": 8.419999999999998}, "episode_return_mean": 8.419999999999998, "num_env_steps_sampled": 5000.0, "module_to_env_connector": {"timers": {"connectors": {"remove_single_ts_time_rank_from_batch": 5.932205705735911e-07, "un_batch_to_individual_items": 5.451399058471403e-06, "listify_data_for_vector_env": 1.1327771612812502e-05, "normalize_and_clip_actions": 9.63337016251967e-06, "get_actions": 3.907933902101144e-05, "tensor_to_numpy": 1.3263946761205739e-05}}, "connector_pipeline_timer": 0.00010511651735255525}, "episode_duration_sec_mean": 0.004632975219283253, "sample": 0.005292672110283581, "num_module_steps_sampled_lifetime": {"default_policy": -4312500.0}, "env_reset_timer": 4.177436436016795e-05, "time_between_sampling": 0.0029135252519651225, "episode_len_max": 20, "weights_seq_no": 8.0, "num_env_steps_sampled_lifetime": -4312500.0, "env_to_module_sum_episodes_length_in": 10.36823839457432, "episode_len_mean": 20.0, "module_episode_returns_mean": {"default_policy": 8.419999999999998}, "episode_return_min": -5.5, "episode_return_max": 14.5, "num_agent_steps_sampled_lifetime": {"default_agent": -4312500.0}, "rlmodule_inference_timer": 2.9012175357832685e-05, "env_to_module_sum_episodes_length_out": 10.36823839457432, "num_module_steps_sampled": {"default_policy": 5000.0}, "num_env_steps_sampled_lifetime_throughput": 3661.6599172546207}, "learners": {"default_policy": {"module_train_batch_size_mean": 1000.0, "vf_explained_var": 0.0028856992721557617, "num_module_steps_trained_lifetime": 54000, "entropy": 0.6526697874069214, "curr_kl_coeff": 0.0014580006245523691, "vf_loss_unclipped": 35.71833038330078, "diff_num_grad_updates_vs_sampler_policy": 1.0, "default_optimizer_learning_rate": 0.0002847858517, "total_loss": -0.02790551446378231, "mean_kl_loss": 0.00035186053719371557, "vf_loss": 0.10038838535547256, "gradients_default_optimizer_global_norm": 0.0056614866480231285, "weights_seq_no": 9.0, "num_module_steps_trained": 6000, "policy_loss": -0.0891357809305191, "curr_entropy_coeff": 0.0090570820258, "num_trainable_parameters": 6003, "num_module_steps_trained_lifetime_throughput": 412769.63814292033}, "__all_modules__": {"num_module_steps_trained": 6000, "num_trainable_parameters": 6003, "learner_connector_sum_episodes_length_in": 5000.0, "num_env_steps_trained": 31500, "learner_connector": {"timers": {"connectors": {"batch_individual_items": 0.03359160242822095, "numpy_to_tensor": 0.000147955500308347, "add_states_from_episodes_to_batch": 3.597556328478841e-06, "add_observations_from_episodes_to_batch": 0.0008076840352664743, "add_columns_from_episodes_to_train_batch": 0.034937239767090865, "add_time_dim_to_batch_and_zero_pad": 1.603558558308132e-05, "add_one_ts_to_episodes_and_truncate": 0.008852061267925477, "general_advantage_estimation": 0.007828702286779671}}, "connector_pipeline_timer": 0.08636060071932766}, "num_module_steps_trained_lifetime": 54000, "learner_connector_sum_episodes_length_out": 5250.0, "num_env_steps_trained_lifetime": 283500, "num_non_trainable_parameters": 0, "num_env_steps_trained_lifetime_throughput": 2129299.0048649856, "num_module_steps_trained_throughput": 408180.0326227218, "num_module_steps_trained_lifetime_throughput": 407012.7314044598}}, "num_training_step_calls_per_iteration": 1, "evaluation": {"env_runners": {"num_env_steps_sampled": 400, "env_to_module_connector": {"timers": {"connectors": {"add_states_from_episodes_to_batch": 1.629865233565894e-06, "add_observations_from_episodes_to_batch": 2.810487738231773e-06, "add_time_dim_to_batch_and_zero_pad": 2.3479277749217855e-06, "batch_individual_items": 6.03648221372273e-06, "numpy_to_tensor": 8.239625083573199e-06}}, "connector_pipeline_timer": 4.236584377074861e-05}, "episode_len_max": 20, "num_module_steps_sampled_lifetime": {"default_policy": 3600}, "rlmodule_inference_timer": 2.7281906904478895e-05, "env_to_module_sum_episodes_length_out": 10.368238394574323, "module_to_env_connector": {"connector_pipeline_timer": 9.974870463435127e-05, "timers": {"connectors": {"tensor_to_numpy": 1.2877425770841041e-05, "listify_data_for_vector_env": 1.075298363368207e-05, "get_actions": 3.5528595215675944e-05, "normalize_and_clip_actions": 9.322649159920886e-06, "remove_single_ts_time_rank_from_batch": 5.824027866448085e-07, "un_batch_to_individual_items": 5.282452296058706e-06}}}, "episode_len_min": 20, "env_reset_timer": 0.00020103989372473487, "episode_return_max": 15.5, "num_episodes_lifetime": 180, "num_episodes": 20, "episode_return_mean": 0.5, "num_module_steps_sampled": {"default_policy": 400}, "episode_duration_sec_mean": 0.00584311208454892, "sample": 0.10114848914533683, "weights_seq_no": 9.0, "module_episode_returns_mean": {"default_policy": 0.5}, "num_agent_steps_sampled_lifetime": {"default_agent": 3600}, "env_step_timer": 1.3657954602276653e-05, "num_agent_steps_sampled": {"default_agent": 400}, "agent_episode_returns_mean": {"default_agent": 0.5}, "num_env_steps_sampled_lifetime": 45400, "env_to_module_sum_episodes_length_in": 10.368238394574323, "episode_len_mean": 20.0, "episode_return_min": -13.5, "time_between_sampling": 1.6525619703923975}, "num_healthy_workers": 1, "actor_manager_num_outstanding_async_reqs": 0, "num_remote_worker_restarts": 0}, "num_env_steps_sampled_lifetime": -4312500.0, "fault_tolerance": {"num_healthy_workers": 0, "num_remote_worker_restarts": 0}, "env_runner_group": {"actor_manager_num_outstanding_async_reqs": 0}, "done": false, "training_iteration": 9, "trial_id": "4d67b_00000", "date": "2025-08-11_19-22-34", "timestamp": 1754932954, "time_this_iter_s": 1.7347509860992432, "time_total_s": 16.62013530731201, "pid": 14356, "hostname": "Mac", "node_ip": "127.0.0.1", "config": {"exploration_config": {}, "extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "placement_strategy": "PACK", "num_gpus": 0, "_fake_gpus": false, "num_cpus_for_main_process": 2, "eager_tracing": true, "eager_max_retraces": 20, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "torch_compile_learner": false, "torch_compile_learner_what_to_compile": "forward_train", "torch_compile_learner_dynamo_backend": "aot_eager", "torch_compile_learner_dynamo_mode": null, "torch_compile_worker": false, "torch_compile_worker_dynamo_backend": "aot_eager", "torch_compile_worker_dynamo_mode": null, "torch_ddp_kwargs": {}, "torch_skip_nan_gradients": false, "env": "Umbrella", "env_config": {}, "observation_space": null, "action_space": null, "clip_rewards": null, "normalize_actions": true, "clip_actions": false, "_is_atari": null, "disable_env_checking": false, "render_env": false, "action_mask_key": "action_mask", "env_runner_cls": null, "num_env_runners": 0, "create_local_env_runner": true, "num_envs_per_env_runner": 1, "gym_env_vectorize_mode": "SYNC", "num_cpus_per_env_runner": 1, "num_gpus_per_env_runner": 0, "custom_resources_per_env_runner": {}, "validate_env_runners_after_construction": true, "episodes_to_numpy": true, "max_requests_in_flight_per_env_runner": 1, "sample_timeout_s": 60.0, "_env_to_module_connector": null, "add_default_connectors_to_env_to_module_pipeline": true, "_module_to_env_connector": null, "add_default_connectors_to_module_to_env_pipeline": true, "merge_env_runner_states": "training_only", "broadcast_env_runner_states": true, "episode_lookback_horizon": 1, "rollout_fragment_length": "auto", "batch_mode": "complete_episodes", "compress_observations": false, "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "enable_tf1_exec_eagerly": false, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "preprocessor_pref": "deepmind", "observation_filter": "NoFilter", "update_worker_filter_stats": true, "use_worker_filter_stats": true, "sampler_perf_stats_ema_coef": null, "_is_online": true, "num_learners": 0, "num_gpus_per_learner": 0, "num_cpus_per_learner": "auto", "num_aggregator_actors_per_learner": 0, "max_requests_in_flight_per_aggregator_actor": 3, "local_gpu_idx": 0, "max_requests_in_flight_per_learner": 3, "gamma": 1, "lr": 0.0002847858517, "grad_clip": 0.5, "grad_clip_by": "global_norm", "_train_batch_size_per_learner": 5000, "train_batch_size": 4000, "num_epochs": 1, "minibatch_size": 1000, "shuffle_batch_per_epoch": true, "model": {"fcnet_hiddens": [256, 256], "fcnet_activation": "tanh", "fcnet_weights_initializer": null, "fcnet_weights_initializer_config": null, "fcnet_bias_initializer": null, "fcnet_bias_initializer_config": null, "conv_filters": null, "conv_activation": "relu", "conv_kernel_initializer": null, "conv_kernel_initializer_config": null, "conv_bias_initializer": null, "conv_bias_initializer_config": null, "conv_transpose_kernel_initializer": null, "conv_transpose_kernel_initializer_config": null, "conv_transpose_bias_initializer": null, "conv_transpose_bias_initializer_config": null, "post_fcnet_hiddens": [], "post_fcnet_activation": "relu", "post_fcnet_weights_initializer": null, "post_fcnet_weights_initializer_config": null, "post_fcnet_bias_initializer": null, "post_fcnet_bias_initializer_config": null, "free_log_std": false, "log_std_clip_param": 20.0, "no_final_linear": false, "vf_share_layers": false, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "lstm_weights_initializer": null, "lstm_weights_initializer_config": null, "lstm_bias_initializer": null, "lstm_bias_initializer_config": null, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "attention_use_n_prev_actions": 0, "attention_use_n_prev_rewards": 0, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": null, "custom_model_config": {}, "custom_action_dist": null, "custom_preprocessor": null, "encoder_latent_dim": null, "always_check_shapes": false, "lstm_use_prev_action_reward": -1, "_use_default_native_models": -1, "_disable_preprocessor_api": false, "_disable_action_flattening": false}, "_learner_connector": null, "add_default_connectors_to_learner_pipeline": true, "learner_config_dict": {}, "optimizer": {}, "_learner_class": null, "callbacks_on_algorithm_init": null, "callbacks_on_env_runners_recreated": null, "callbacks_on_offline_eval_runners_recreated": null, "callbacks_on_checkpoint_loaded": null, "callbacks_on_environment_created": null, "callbacks_on_episode_created": null, "callbacks_on_episode_start": null, "callbacks_on_episode_step": null, "callbacks_on_episode_end": null, "callbacks_on_evaluate_start": null, "callbacks_on_evaluate_end": null, "callbacks_on_evaluate_offline_start": null, "callbacks_on_evaluate_offline_end": null, "callbacks_on_sample_end": null, "callbacks_on_train_result": null, "explore": true, "enable_rl_module_and_learner": true, "enable_env_runner_and_connector_v2": true, "_prior_exploration_config": {"type": "StochasticSampling"}, "count_steps_by": "env_steps", "policy_map_capacity": 100, "policy_mapping_fn": "<function AlgorithmConfig.DEFAULT_POLICY_MAPPING_FN at 0x385aedb20>", "policies_to_train": null, "policy_states_are_swappable": false, "observation_fn": null, "offline_data_class": null, "input_read_method": "read_parquet", "input_read_method_kwargs": {}, "input_read_schema": {}, "input_read_episodes": false, "input_read_sample_batches": false, "input_read_batch_size": null, "input_filesystem": null, "input_filesystem_kwargs": {}, "input_compress_columns": ["obs", "new_obs"], "input_spaces_jsonable": true, "materialize_data": false, "materialize_mapped_data": true, "map_batches_kwargs": {}, "iter_batches_kwargs": {}, "ignore_final_observation": false, "prelearner_class": null, "prelearner_buffer_class": null, "prelearner_buffer_kwargs": {}, "prelearner_module_synch_period": 10, "dataset_num_iters_per_learner": null, "input_config": {}, "actions_in_input_normalized": false, "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_config": {}, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "output_max_rows_per_file": null, "output_write_remaining_data": false, "output_write_method": "write_parquet", "output_write_method_kwargs": {}, "output_filesystem": null, "output_filesystem_kwargs": {}, "output_write_episodes": true, "offline_sampling": false, "evaluation_interval": 1, "evaluation_duration": 20, "evaluation_duration_unit": "episodes", "evaluation_sample_timeout_s": 120.0, "evaluation_auto_duration_min_env_steps_per_sample": 100, "evaluation_auto_duration_max_env_steps_per_sample": 2000, "evaluation_parallel_to_training": false, "evaluation_force_reset_envs_before_iteration": true, "evaluation_config": null, "off_policy_estimation_methods": {}, "ope_split_batch_by_episode": true, "evaluation_num_env_runners": 1, "in_evaluation": false, "sync_filters_on_rollout_workers_timeout_s": 10.0, "offline_evaluation_interval": null, "num_offline_eval_runners": 0, "offline_loss_for_module_fn": null, "offline_evaluation_duration": 1, "offline_evaluation_parallel_to_training": false, "offline_evaluation_timeout_s": 120.0, "num_cpus_per_offline_eval_runner": 1, "num_gpus_per_offline_eval_runner": 0, "custom_resources_per_offline_eval_runner": {}, "restart_failed_offline_eval_runners": true, "ignore_offline_eval_runner_failures": false, "max_num_offline_eval_runner_restarts": 1000, "offline_eval_runner_restore_timeout_s": 1800.0, "max_requests_in_flight_per_offline_eval_runner": 1, "validate_offline_eval_runners_after_construction": true, "offline_eval_runner_health_probe_timeout_s": 30.0, "offline_eval_rl_module_inference_only": false, "broadcast_offline_eval_runner_states": false, "offline_eval_batch_size_per_runner": 256, "dataset_num_iters_per_eval_runner": 1, "keep_per_episode_custom_metrics": false, "metrics_episode_collection_timeout_s": 60.0, "metrics_num_episodes_for_smoothing": 100, "min_time_s_per_iteration": null, "min_train_timesteps_per_iteration": 0, "min_sample_timesteps_per_iteration": 0, "log_gradients": true, "export_native_model_files": false, "checkpoint_trainable_policies_only": false, "logger_creator": null, "logger_config": null, "log_level": "WARN", "log_sys_usage": true, "fake_sampler": false, "seed": 9, "restart_failed_env_runners": true, "ignore_env_runner_failures": false, "max_num_env_runner_restarts": 1000, "delay_between_env_runner_restarts_s": 60.0, "restart_failed_sub_environments": false, "num_consecutive_env_runner_failures_tolerance": 100, "env_runner_health_probe_timeout_s": 30.0, "env_runner_restore_timeout_s": 1800.0, "_model_config": {}, "_rl_module_spec": "RLModuleSpec(module_class=None, observation_space=None, action_space=None, inference_only=False, learner_only=False, model_config=DefaultModelConfig(fcnet_hiddens=[60, 90], fcnet_activation='tanh', fcnet_kernel_initializer=None, fcnet_kernel_initializer_kwargs=None, fcnet_bias_initializer=None, fcnet_bias_initializer_kwargs=None, conv_filters=None, conv_activation='relu', conv_kernel_initializer=None, conv_kernel_initializer_kwargs=None, conv_bias_initializer=None, conv_bias_initializer_kwargs=None, head_fcnet_hiddens=[], head_fcnet_activation='relu', head_fcnet_kernel_initializer=None, head_fcnet_kernel_initializer_kwargs=None, head_fcnet_bias_initializer=None, head_fcnet_bias_initializer_kwargs=None, free_log_std=False, log_std_clip_param=20.0, vf_share_layers=True, use_lstm=False, max_seq_len=20, lstm_cell_size=256, lstm_use_prev_action=False, lstm_use_prev_reward=False, lstm_kernel_initializer=None, lstm_kernel_initializer_kwargs=None, lstm_bias_initializer=None, lstm_bias_initializer_kwargs=None), catalog_class=None, load_state_path=None, model_config_dict=None)", "algorithm_config_overrides_per_module": {}, "_per_module_overrides": {}, "_validate_config": true, "_use_msgpack_checkpoints": false, "_torch_grad_scaler_class": null, "_torch_lr_scheduler_classes": null, "_tf_policy_handles_more_than_one_loss": false, "_disable_preprocessor_api": false, "_disable_action_flattening": false, "_disable_initialize_loss_from_dummy_batch": false, "_dont_auto_sync_env_runner_states": false, "env_task_fn": -1, "enable_connectors": -1, "simple_optimizer": false, "policy_map_cache": -1, "worker_cls": -1, "synchronize_filters": -1, "enable_async_evaluation": -1, "custom_async_evaluation_function": -1, "_enable_rl_module_api": -1, "auto_wrap_old_gym_envs": -1, "always_attach_evaluation_results": -1, "replay_sequence_length": null, "_disable_execution_plan_api": -1, "use_critic": true, "use_gae": true, "use_kl_loss": true, "kl_coeff": 0.7464963036515, "kl_target": 0.0270990929592, "vf_loss_coeff": 0.6688075857018, "entropy_coeff": 0.0090570820258, "clip_param": 0.1221781641624, "vf_clip_param": 0.1027808522125, "entropy_coeff_schedule": null, "lr_schedule": null, "sgd_minibatch_size": -1, "vf_share_layers": -1, "__stdout_file__": null, "__stderr_file__": null, "lambda": 0.9099046732075, "input": "sampler", "policies": {"default_policy": [null, null, null, null]}, "callbacks": "<class 'ray.rllib.callbacks.callbacks.RLlibCallback'>", "create_env_on_driver": false, "custom_eval_function": null, "framework": "torch"}, "time_since_restore": 16.62013530731201, "iterations_since_restore": 9, "perf": {"cpu_util_percent": 50.8, "ram_util_percent": 82.1}}
{"timers": {"training_iteration": 1.868589819420618, "restore_env_runners": 1.1659640057482279e-05, "training_step": 1.8684195440607743, "env_runner_sampling_timer": 1.7505366639241138, "learner_update_timer": 0.1145274049433664, "synch_weights": 0.000636177348432597, "restore_eval_env_runners": 1.009719125758549e-05, "evaluation_iteration": 0.1108017736682962, "synch_eval_env_connectors": 0.00013898473575786046, "synch_env_connectors": 4.641511227875392e-06}, "env_runners": {"num_episodes_lifetime": -246500.0, "env_to_module_connector": {"connector_pipeline_timer": 4.3919176063427005e-05, "timers": {"connectors": {"add_observations_from_episodes_to_batch": 2.996658635974022e-06, "add_time_dim_to_batch_and_zero_pad": 2.4174184232411316e-06, "batch_individual_items": 6.328142262420493e-06, "numpy_to_tensor": 8.688301924883998e-06, "add_states_from_episodes_to_batch": 1.7445220108539227e-06}}}, "num_episodes": 250.0, "env_step_timer": 1.3874304972209485e-05, "episode_len_min": 20, "num_agent_steps_sampled": {"default_agent": 5000.0}, "agent_episode_returns_mean": {"default_agent": 9.940000000000001}, "episode_return_mean": 9.940000000000001, "num_env_steps_sampled": 5000.0, "module_to_env_connector": {"timers": {"connectors": {"remove_single_ts_time_rank_from_batch": 5.779840285565663e-07, "un_batch_to_individual_items": 5.421848267679348e-06, "listify_data_for_vector_env": 1.1137753925626246e-05, "normalize_and_clip_actions": 9.472026277444977e-06, "get_actions": 3.822393819820105e-05, "tensor_to_numpy": 1.306895293399753e-05}}, "connector_pipeline_timer": 0.00010339839680634619}, "episode_duration_sec_mean": 0.004547510797157883, "sample": 0.004897759037641592, "num_module_steps_sampled_lifetime": {"default_policy": -4930000.0}, "env_reset_timer": 3.537357213899277e-05, "time_between_sampling": 0.0020787883429949252, "episode_len_max": 20, "weights_seq_no": 9.0, "num_env_steps_sampled_lifetime": -4930000.0, "env_to_module_sum_episodes_length_in": 10.36823839457432, "episode_len_mean": 20.0, "module_episode_returns_mean": {"default_policy": 9.940000000000001}, "episode_return_min": -5.5, "episode_return_max": 14.5, "num_agent_steps_sampled_lifetime": {"default_agent": -4930000.0}, "rlmodule_inference_timer": 2.7559632368878905e-05, "env_to_module_sum_episodes_length_out": 10.36823839457432, "num_module_steps_sampled": {"default_policy": 5000.0}, "num_env_steps_sampled_lifetime_throughput": 3722.2458171362837}, "learners": {"default_policy": {"module_train_batch_size_mean": 1000.0, "vf_explained_var": 0.0037711262702941895, "num_module_steps_trained_lifetime": 60000, "entropy": 0.64539635181427, "curr_kl_coeff": 0.0007290003122761846, "vf_loss_unclipped": 35.351341247558594, "diff_num_grad_updates_vs_sampler_policy": 1.0, "default_optimizer_learning_rate": 0.0002847858517, "total_loss": 0.15950974822044373, "mean_kl_loss": 0.00015151759725995362, "vf_loss": 0.10020184516906738, "gradients_default_optimizer_global_norm": 0.06948995590209961, "weights_seq_no": 10.0, "num_module_steps_trained": 6000, "policy_loss": 0.09833916276693344, "curr_entropy_coeff": 0.0090570820258, "num_trainable_parameters": 6003, "num_module_steps_trained_lifetime_throughput": 410771.317778318}, "__all_modules__": {"num_module_steps_trained": 6000, "num_trainable_parameters": 6003, "learner_connector_sum_episodes_length_in": 5000.0, "num_env_steps_trained": 31500, "learner_connector": {"timers": {"connectors": {"batch_individual_items": 0.03458273932476266, "numpy_to_tensor": 0.0001472267752366121, "add_states_from_episodes_to_batch": 3.5965810317013207e-06, "add_observations_from_episodes_to_batch": 0.000807851364789789, "add_columns_from_episodes_to_train_batch": 0.03492996445858019, "add_time_dim_to_batch_and_zero_pad": 1.597772992565947e-05, "add_one_ts_to_episodes_and_truncate": 0.008840218155283698, "general_advantage_estimation": 0.007810872763842509}}, "connector_pipeline_timer": 0.08731345471108848}, "num_module_steps_trained_lifetime": 60000, "learner_connector_sum_episodes_length_out": 5250.0, "num_env_steps_trained_lifetime": 315000, "num_non_trainable_parameters": 0, "num_env_steps_trained_lifetime_throughput": 2120686.0758925807, "num_module_steps_trained_throughput": 406427.84512859554, "num_module_steps_trained_lifetime_throughput": 405307.4572247772}}, "num_training_step_calls_per_iteration": 1, "evaluation": {"env_runners": {"num_env_steps_sampled": 400, "env_to_module_connector": {"timers": {"connectors": {"add_states_from_episodes_to_batch": 1.7796479762452472e-06, "add_observations_from_episodes_to_batch": 3.499786085054485e-06, "add_time_dim_to_batch_and_zero_pad": 2.6682151286891095e-06, "batch_individual_items": 8.175676614574562e-06, "numpy_to_tensor": 1.0741125220252449e-05}}, "connector_pipeline_timer": 5.1156001919111906e-05}, "episode_len_max": 20, "num_module_steps_sampled_lifetime": {"default_policy": 4000}, "rlmodule_inference_timer": 3.2766726596706444e-05, "env_to_module_sum_episodes_length_out": 10.368238394574323, "module_to_env_connector": {"connector_pipeline_timer": 0.000122026472214796, "timers": {"connectors": {"tensor_to_numpy": 1.5202592375179807e-05, "listify_data_for_vector_env": 1.2663618403537908e-05, "get_actions": 4.5947992528814256e-05, "normalize_and_clip_actions": 1.1245063599142716e-05, "remove_single_ts_time_rank_from_batch": 6.947974425895186e-07, "un_batch_to_individual_items": 6.482531641764933e-06}}}, "episode_len_min": 20, "env_reset_timer": 0.00020018074453148556, "episode_return_max": 15.5, "num_episodes_lifetime": 200, "num_episodes": 20, "episode_return_mean": 0.7, "num_module_steps_sampled": {"default_policy": 400}, "episode_duration_sec_mean": 0.006071664574556053, "sample": 0.10137779217442554, "weights_seq_no": 10.0, "module_episode_returns_mean": {"default_policy": 0.7}, "num_agent_steps_sampled_lifetime": {"default_agent": 4000}, "env_step_timer": 1.6951333668431715e-05, "num_agent_steps_sampled": {"default_agent": 400}, "agent_episode_returns_mean": {"default_agent": 0.7}, "num_env_steps_sampled_lifetime": 50400, "env_to_module_sum_episodes_length_in": 10.368238394574323, "episode_len_mean": 20.0, "episode_return_min": -13.5, "time_between_sampling": 1.6520831827689382}, "num_healthy_workers": 1, "actor_manager_num_outstanding_async_reqs": 0, "num_remote_worker_restarts": 0}, "num_env_steps_sampled_lifetime": -4930000.0, "fault_tolerance": {"num_healthy_workers": 0, "num_remote_worker_restarts": 0}, "env_runner_group": {"actor_manager_num_outstanding_async_reqs": 0}, "done": false, "training_iteration": 10, "trial_id": "4d67b_00000", "date": "2025-08-11_19-22-36", "timestamp": 1754932956, "time_this_iter_s": 1.7179110050201416, "time_total_s": 18.338046312332153, "pid": 14356, "hostname": "Mac", "node_ip": "127.0.0.1", "config": {"exploration_config": {}, "extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "placement_strategy": "PACK", "num_gpus": 0, "_fake_gpus": false, "num_cpus_for_main_process": 2, "eager_tracing": true, "eager_max_retraces": 20, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "torch_compile_learner": false, "torch_compile_learner_what_to_compile": "forward_train", "torch_compile_learner_dynamo_backend": "aot_eager", "torch_compile_learner_dynamo_mode": null, "torch_compile_worker": false, "torch_compile_worker_dynamo_backend": "aot_eager", "torch_compile_worker_dynamo_mode": null, "torch_ddp_kwargs": {}, "torch_skip_nan_gradients": false, "env": "Umbrella", "env_config": {}, "observation_space": null, "action_space": null, "clip_rewards": null, "normalize_actions": true, "clip_actions": false, "_is_atari": null, "disable_env_checking": false, "render_env": false, "action_mask_key": "action_mask", "env_runner_cls": null, "num_env_runners": 0, "create_local_env_runner": true, "num_envs_per_env_runner": 1, "gym_env_vectorize_mode": "SYNC", "num_cpus_per_env_runner": 1, "num_gpus_per_env_runner": 0, "custom_resources_per_env_runner": {}, "validate_env_runners_after_construction": true, "episodes_to_numpy": true, "max_requests_in_flight_per_env_runner": 1, "sample_timeout_s": 60.0, "_env_to_module_connector": null, "add_default_connectors_to_env_to_module_pipeline": true, "_module_to_env_connector": null, "add_default_connectors_to_module_to_env_pipeline": true, "merge_env_runner_states": "training_only", "broadcast_env_runner_states": true, "episode_lookback_horizon": 1, "rollout_fragment_length": "auto", "batch_mode": "complete_episodes", "compress_observations": false, "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "enable_tf1_exec_eagerly": false, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "preprocessor_pref": "deepmind", "observation_filter": "NoFilter", "update_worker_filter_stats": true, "use_worker_filter_stats": true, "sampler_perf_stats_ema_coef": null, "_is_online": true, "num_learners": 0, "num_gpus_per_learner": 0, "num_cpus_per_learner": "auto", "num_aggregator_actors_per_learner": 0, "max_requests_in_flight_per_aggregator_actor": 3, "local_gpu_idx": 0, "max_requests_in_flight_per_learner": 3, "gamma": 1, "lr": 0.0002847858517, "grad_clip": 0.5, "grad_clip_by": "global_norm", "_train_batch_size_per_learner": 5000, "train_batch_size": 4000, "num_epochs": 1, "minibatch_size": 1000, "shuffle_batch_per_epoch": true, "model": {"fcnet_hiddens": [256, 256], "fcnet_activation": "tanh", "fcnet_weights_initializer": null, "fcnet_weights_initializer_config": null, "fcnet_bias_initializer": null, "fcnet_bias_initializer_config": null, "conv_filters": null, "conv_activation": "relu", "conv_kernel_initializer": null, "conv_kernel_initializer_config": null, "conv_bias_initializer": null, "conv_bias_initializer_config": null, "conv_transpose_kernel_initializer": null, "conv_transpose_kernel_initializer_config": null, "conv_transpose_bias_initializer": null, "conv_transpose_bias_initializer_config": null, "post_fcnet_hiddens": [], "post_fcnet_activation": "relu", "post_fcnet_weights_initializer": null, "post_fcnet_weights_initializer_config": null, "post_fcnet_bias_initializer": null, "post_fcnet_bias_initializer_config": null, "free_log_std": false, "log_std_clip_param": 20.0, "no_final_linear": false, "vf_share_layers": false, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "lstm_weights_initializer": null, "lstm_weights_initializer_config": null, "lstm_bias_initializer": null, "lstm_bias_initializer_config": null, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "attention_use_n_prev_actions": 0, "attention_use_n_prev_rewards": 0, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": null, "custom_model_config": {}, "custom_action_dist": null, "custom_preprocessor": null, "encoder_latent_dim": null, "always_check_shapes": false, "lstm_use_prev_action_reward": -1, "_use_default_native_models": -1, "_disable_preprocessor_api": false, "_disable_action_flattening": false}, "_learner_connector": null, "add_default_connectors_to_learner_pipeline": true, "learner_config_dict": {}, "optimizer": {}, "_learner_class": null, "callbacks_on_algorithm_init": null, "callbacks_on_env_runners_recreated": null, "callbacks_on_offline_eval_runners_recreated": null, "callbacks_on_checkpoint_loaded": null, "callbacks_on_environment_created": null, "callbacks_on_episode_created": null, "callbacks_on_episode_start": null, "callbacks_on_episode_step": null, "callbacks_on_episode_end": null, "callbacks_on_evaluate_start": null, "callbacks_on_evaluate_end": null, "callbacks_on_evaluate_offline_start": null, "callbacks_on_evaluate_offline_end": null, "callbacks_on_sample_end": null, "callbacks_on_train_result": null, "explore": true, "enable_rl_module_and_learner": true, "enable_env_runner_and_connector_v2": true, "_prior_exploration_config": {"type": "StochasticSampling"}, "count_steps_by": "env_steps", "policy_map_capacity": 100, "policy_mapping_fn": "<function AlgorithmConfig.DEFAULT_POLICY_MAPPING_FN at 0x385aedb20>", "policies_to_train": null, "policy_states_are_swappable": false, "observation_fn": null, "offline_data_class": null, "input_read_method": "read_parquet", "input_read_method_kwargs": {}, "input_read_schema": {}, "input_read_episodes": false, "input_read_sample_batches": false, "input_read_batch_size": null, "input_filesystem": null, "input_filesystem_kwargs": {}, "input_compress_columns": ["obs", "new_obs"], "input_spaces_jsonable": true, "materialize_data": false, "materialize_mapped_data": true, "map_batches_kwargs": {}, "iter_batches_kwargs": {}, "ignore_final_observation": false, "prelearner_class": null, "prelearner_buffer_class": null, "prelearner_buffer_kwargs": {}, "prelearner_module_synch_period": 10, "dataset_num_iters_per_learner": null, "input_config": {}, "actions_in_input_normalized": false, "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_config": {}, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "output_max_rows_per_file": null, "output_write_remaining_data": false, "output_write_method": "write_parquet", "output_write_method_kwargs": {}, "output_filesystem": null, "output_filesystem_kwargs": {}, "output_write_episodes": true, "offline_sampling": false, "evaluation_interval": 1, "evaluation_duration": 20, "evaluation_duration_unit": "episodes", "evaluation_sample_timeout_s": 120.0, "evaluation_auto_duration_min_env_steps_per_sample": 100, "evaluation_auto_duration_max_env_steps_per_sample": 2000, "evaluation_parallel_to_training": false, "evaluation_force_reset_envs_before_iteration": true, "evaluation_config": null, "off_policy_estimation_methods": {}, "ope_split_batch_by_episode": true, "evaluation_num_env_runners": 1, "in_evaluation": false, "sync_filters_on_rollout_workers_timeout_s": 10.0, "offline_evaluation_interval": null, "num_offline_eval_runners": 0, "offline_loss_for_module_fn": null, "offline_evaluation_duration": 1, "offline_evaluation_parallel_to_training": false, "offline_evaluation_timeout_s": 120.0, "num_cpus_per_offline_eval_runner": 1, "num_gpus_per_offline_eval_runner": 0, "custom_resources_per_offline_eval_runner": {}, "restart_failed_offline_eval_runners": true, "ignore_offline_eval_runner_failures": false, "max_num_offline_eval_runner_restarts": 1000, "offline_eval_runner_restore_timeout_s": 1800.0, "max_requests_in_flight_per_offline_eval_runner": 1, "validate_offline_eval_runners_after_construction": true, "offline_eval_runner_health_probe_timeout_s": 30.0, "offline_eval_rl_module_inference_only": false, "broadcast_offline_eval_runner_states": false, "offline_eval_batch_size_per_runner": 256, "dataset_num_iters_per_eval_runner": 1, "keep_per_episode_custom_metrics": false, "metrics_episode_collection_timeout_s": 60.0, "metrics_num_episodes_for_smoothing": 100, "min_time_s_per_iteration": null, "min_train_timesteps_per_iteration": 0, "min_sample_timesteps_per_iteration": 0, "log_gradients": true, "export_native_model_files": false, "checkpoint_trainable_policies_only": false, "logger_creator": null, "logger_config": null, "log_level": "WARN", "log_sys_usage": true, "fake_sampler": false, "seed": 9, "restart_failed_env_runners": true, "ignore_env_runner_failures": false, "max_num_env_runner_restarts": 1000, "delay_between_env_runner_restarts_s": 60.0, "restart_failed_sub_environments": false, "num_consecutive_env_runner_failures_tolerance": 100, "env_runner_health_probe_timeout_s": 30.0, "env_runner_restore_timeout_s": 1800.0, "_model_config": {}, "_rl_module_spec": "RLModuleSpec(module_class=None, observation_space=None, action_space=None, inference_only=False, learner_only=False, model_config=DefaultModelConfig(fcnet_hiddens=[60, 90], fcnet_activation='tanh', fcnet_kernel_initializer=None, fcnet_kernel_initializer_kwargs=None, fcnet_bias_initializer=None, fcnet_bias_initializer_kwargs=None, conv_filters=None, conv_activation='relu', conv_kernel_initializer=None, conv_kernel_initializer_kwargs=None, conv_bias_initializer=None, conv_bias_initializer_kwargs=None, head_fcnet_hiddens=[], head_fcnet_activation='relu', head_fcnet_kernel_initializer=None, head_fcnet_kernel_initializer_kwargs=None, head_fcnet_bias_initializer=None, head_fcnet_bias_initializer_kwargs=None, free_log_std=False, log_std_clip_param=20.0, vf_share_layers=True, use_lstm=False, max_seq_len=20, lstm_cell_size=256, lstm_use_prev_action=False, lstm_use_prev_reward=False, lstm_kernel_initializer=None, lstm_kernel_initializer_kwargs=None, lstm_bias_initializer=None, lstm_bias_initializer_kwargs=None), catalog_class=None, load_state_path=None, model_config_dict=None)", "algorithm_config_overrides_per_module": {}, "_per_module_overrides": {}, "_validate_config": true, "_use_msgpack_checkpoints": false, "_torch_grad_scaler_class": null, "_torch_lr_scheduler_classes": null, "_tf_policy_handles_more_than_one_loss": false, "_disable_preprocessor_api": false, "_disable_action_flattening": false, "_disable_initialize_loss_from_dummy_batch": false, "_dont_auto_sync_env_runner_states": false, "env_task_fn": -1, "enable_connectors": -1, "simple_optimizer": false, "policy_map_cache": -1, "worker_cls": -1, "synchronize_filters": -1, "enable_async_evaluation": -1, "custom_async_evaluation_function": -1, "_enable_rl_module_api": -1, "auto_wrap_old_gym_envs": -1, "always_attach_evaluation_results": -1, "replay_sequence_length": null, "_disable_execution_plan_api": -1, "use_critic": true, "use_gae": true, "use_kl_loss": true, "kl_coeff": 0.7464963036515, "kl_target": 0.0270990929592, "vf_loss_coeff": 0.6688075857018, "entropy_coeff": 0.0090570820258, "clip_param": 0.1221781641624, "vf_clip_param": 0.1027808522125, "entropy_coeff_schedule": null, "lr_schedule": null, "sgd_minibatch_size": -1, "vf_share_layers": -1, "__stdout_file__": null, "__stderr_file__": null, "lambda": 0.9099046732075, "input": "sampler", "policies": {"default_policy": [null, null, null, null]}, "callbacks": "<class 'ray.rllib.callbacks.callbacks.RLlibCallback'>", "create_env_on_driver": false, "custom_eval_function": null, "framework": "torch"}, "time_since_restore": 18.338046312332153, "iterations_since_restore": 10, "perf": {"cpu_util_percent": 44.03333333333333, "ram_util_percent": 79.3}}
{"timers": {"training_iteration": 1.8664967908069023, "restore_env_runners": 1.1601793813220638e-05, "training_step": 1.866326494449464, "env_runner_sampling_timer": 1.748657951874887, "learner_update_timer": 0.11431385381385506, "synch_weights": 0.0006367843253338387, "restore_eval_env_runners": 1.0074129134989093e-05, "evaluation_iteration": 0.11099325302212612, "synch_eval_env_connectors": 0.00013969821873493035, "synch_env_connectors": 4.63343633768712e-06}, "env_runners": {"num_episodes_lifetime": -277375.0, "env_to_module_connector": {"connector_pipeline_timer": 4.824999313083528e-05, "timers": {"connectors": {"add_observations_from_episodes_to_batch": 3.2395544901205736e-06, "add_time_dim_to_batch_and_zero_pad": 2.6910014023057843e-06, "batch_individual_items": 7.0972345442051805e-06, "numpy_to_tensor": 9.95124589062672e-06, "add_states_from_episodes_to_batch": 1.8902237174302568e-06}}}, "num_episodes": 250.0, "env_step_timer": 1.5872623334747083e-05, "episode_len_min": 20, "num_agent_steps_sampled": {"default_agent": 5000.0}, "agent_episode_returns_mean": {"default_agent": 9.460000000000004}, "episode_return_mean": 9.460000000000004, "num_env_steps_sampled": 5000.0, "module_to_env_connector": {"timers": {"connectors": {"remove_single_ts_time_rank_from_batch": 6.311928811372021e-07, "un_batch_to_individual_items": 6.361685271880189e-06, "listify_data_for_vector_env": 1.2581876910748034e-05, "normalize_and_clip_actions": 1.0518619203476658e-05, "get_actions": 4.554386469814945e-05, "tensor_to_numpy": 1.4813665722480348e-05}}, "connector_pipeline_timer": 0.00011823521962700187}, "episode_duration_sec_mean": 0.0051736721377819775, "sample": 0.005335579749516209, "num_module_steps_sampled_lifetime": {"default_policy": -5547500.0}, "env_reset_timer": 4.256512826951389e-05, "time_between_sampling": 0.0020789102425498394, "episode_len_max": 20, "weights_seq_no": 10.0, "num_env_steps_sampled_lifetime": -5547500.0, "env_to_module_sum_episodes_length_in": 10.36823839457432, "episode_len_mean": 20.0, "module_episode_returns_mean": {"default_policy": 9.460000000000004}, "episode_return_min": -5.5, "episode_return_max": 14.5, "num_agent_steps_sampled_lifetime": {"default_agent": -5547500.0}, "rlmodule_inference_timer": 3.2570376100536756e-05, "env_to_module_sum_episodes_length_out": 10.36823839457432, "num_module_steps_sampled": {"default_policy": 5000.0}, "num_env_steps_sampled_lifetime_throughput": 3349.470561829671}, "learners": {"default_policy": {"module_train_batch_size_mean": 1000.0, "vf_explained_var": 0.003722965717315674, "num_module_steps_trained_lifetime": 66000, "entropy": 0.6424030065536499, "curr_kl_coeff": 0.0003645001561380923, "vf_loss_unclipped": 36.1129264831543, "diff_num_grad_updates_vs_sampler_policy": 1.0, "default_optimizer_learning_rate": 0.0002847858517, "total_loss": 0.024965224787592888, "mean_kl_loss": 0.00011596082913456485, "vf_loss": 0.10056816786527634, "gradients_default_optimizer_global_norm": 0.05864938348531723, "weights_seq_no": 11.0, "num_module_steps_trained": 6000, "policy_loss": -0.03647731989622116, "curr_entropy_coeff": 0.0090570820258, "num_trainable_parameters": 6003, "num_module_steps_trained_lifetime_throughput": 409611.8260539466}, "__all_modules__": {"num_module_steps_trained": 6000, "num_trainable_parameters": 6003, "learner_connector_sum_episodes_length_in": 5000.0, "num_env_steps_trained": 31500, "learner_connector": {"timers": {"connectors": {"batch_individual_items": 0.03453706110173121, "numpy_to_tensor": 0.00014626617843504616, "add_states_from_episodes_to_batch": 3.5881148487062663e-06, "add_observations_from_episodes_to_batch": 0.000808156181565276, "add_columns_from_episodes_to_train_batch": 0.03492596023484222, "add_time_dim_to_batch_and_zero_pad": 1.590087293183376e-05, "add_one_ts_to_episodes_and_truncate": 0.008827688054364277, "general_advantage_estimation": 0.0077881302866576}}, "connector_pipeline_timer": 0.08722688225448437}, "num_module_steps_trained_lifetime": 66000, "learner_connector_sum_episodes_length_out": 5250.0, "num_env_steps_trained_lifetime": 346500, "num_non_trainable_parameters": 0, "num_env_steps_trained_lifetime_throughput": 2116404.845790805, "num_module_steps_trained_throughput": 405506.8163698393, "num_module_steps_trained_lifetime_throughput": 404431.1188283203}}, "num_training_step_calls_per_iteration": 1, "evaluation": {"env_runners": {"num_env_steps_sampled": 400, "env_to_module_connector": {"timers": {"connectors": {"add_states_from_episodes_to_batch": 1.6816419005467082e-06, "add_observations_from_episodes_to_batch": 2.7918036889047467e-06, "add_time_dim_to_batch_and_zero_pad": 2.292379847537782e-06, "batch_individual_items": 5.997025922920557e-06, "numpy_to_tensor": 8.179197970298946e-06}}, "connector_pipeline_timer": 4.235028929518901e-05}, "episode_len_max": 20, "num_module_steps_sampled_lifetime": {"default_policy": 4400}, "rlmodule_inference_timer": 2.6619905098150186e-05, "env_to_module_sum_episodes_length_out": 10.368238394574323, "module_to_env_connector": {"connector_pipeline_timer": 9.875389123909267e-05, "timers": {"connectors": {"tensor_to_numpy": 1.2585622330438573e-05, "listify_data_for_vector_env": 1.0607332652430262e-05, "get_actions": 3.511928077451961e-05, "normalize_and_clip_actions": 9.180697777588618e-06, "remove_single_ts_time_rank_from_batch": 5.741419833702995e-07, "un_batch_to_individual_items": 5.279087116456257e-06}}}, "episode_len_min": 20, "env_reset_timer": 0.000198957686904153, "episode_return_max": 15.5, "num_episodes_lifetime": 220, "num_episodes": 20, "episode_return_mean": 1.3, "num_module_steps_sampled": {"default_policy": 400}, "episode_duration_sec_mean": 0.0059101204085163775, "sample": 0.10133223300346732, "weights_seq_no": 11.0, "module_episode_returns_mean": {"default_policy": 1.3}, "num_agent_steps_sampled_lifetime": {"default_agent": 4400}, "env_step_timer": 1.3566152484177762e-05, "num_agent_steps_sampled": {"default_agent": 400}, "agent_episode_returns_mean": {"default_agent": 1.3}, "num_env_steps_sampled_lifetime": 55400, "env_to_module_sum_episodes_length_in": 10.368238394574323, "episode_len_mean": 20.0, "episode_return_min": -13.5, "time_between_sampling": 1.6523528071915585}, "num_healthy_workers": 1, "actor_manager_num_outstanding_async_reqs": 0, "num_remote_worker_restarts": 0}, "num_env_steps_sampled_lifetime": -5547500.0, "fault_tolerance": {"num_healthy_workers": 0, "num_remote_worker_restarts": 0}, "env_runner_group": {"actor_manager_num_outstanding_async_reqs": 0}, "done": false, "training_iteration": 11, "trial_id": "4d67b_00000", "date": "2025-08-11_19-22-38", "timestamp": 1754932958, "time_this_iter_s": 1.763350009918213, "time_total_s": 20.101396322250366, "pid": 14356, "hostname": "Mac", "node_ip": "127.0.0.1", "config": {"exploration_config": {}, "extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "placement_strategy": "PACK", "num_gpus": 0, "_fake_gpus": false, "num_cpus_for_main_process": 2, "eager_tracing": true, "eager_max_retraces": 20, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "torch_compile_learner": false, "torch_compile_learner_what_to_compile": "forward_train", "torch_compile_learner_dynamo_backend": "aot_eager", "torch_compile_learner_dynamo_mode": null, "torch_compile_worker": false, "torch_compile_worker_dynamo_backend": "aot_eager", "torch_compile_worker_dynamo_mode": null, "torch_ddp_kwargs": {}, "torch_skip_nan_gradients": false, "env": "Umbrella", "env_config": {}, "observation_space": null, "action_space": null, "clip_rewards": null, "normalize_actions": true, "clip_actions": false, "_is_atari": null, "disable_env_checking": false, "render_env": false, "action_mask_key": "action_mask", "env_runner_cls": null, "num_env_runners": 0, "create_local_env_runner": true, "num_envs_per_env_runner": 1, "gym_env_vectorize_mode": "SYNC", "num_cpus_per_env_runner": 1, "num_gpus_per_env_runner": 0, "custom_resources_per_env_runner": {}, "validate_env_runners_after_construction": true, "episodes_to_numpy": true, "max_requests_in_flight_per_env_runner": 1, "sample_timeout_s": 60.0, "_env_to_module_connector": null, "add_default_connectors_to_env_to_module_pipeline": true, "_module_to_env_connector": null, "add_default_connectors_to_module_to_env_pipeline": true, "merge_env_runner_states": "training_only", "broadcast_env_runner_states": true, "episode_lookback_horizon": 1, "rollout_fragment_length": "auto", "batch_mode": "complete_episodes", "compress_observations": false, "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "enable_tf1_exec_eagerly": false, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "preprocessor_pref": "deepmind", "observation_filter": "NoFilter", "update_worker_filter_stats": true, "use_worker_filter_stats": true, "sampler_perf_stats_ema_coef": null, "_is_online": true, "num_learners": 0, "num_gpus_per_learner": 0, "num_cpus_per_learner": "auto", "num_aggregator_actors_per_learner": 0, "max_requests_in_flight_per_aggregator_actor": 3, "local_gpu_idx": 0, "max_requests_in_flight_per_learner": 3, "gamma": 1, "lr": 0.0002847858517, "grad_clip": 0.5, "grad_clip_by": "global_norm", "_train_batch_size_per_learner": 5000, "train_batch_size": 4000, "num_epochs": 1, "minibatch_size": 1000, "shuffle_batch_per_epoch": true, "model": {"fcnet_hiddens": [256, 256], "fcnet_activation": "tanh", "fcnet_weights_initializer": null, "fcnet_weights_initializer_config": null, "fcnet_bias_initializer": null, "fcnet_bias_initializer_config": null, "conv_filters": null, "conv_activation": "relu", "conv_kernel_initializer": null, "conv_kernel_initializer_config": null, "conv_bias_initializer": null, "conv_bias_initializer_config": null, "conv_transpose_kernel_initializer": null, "conv_transpose_kernel_initializer_config": null, "conv_transpose_bias_initializer": null, "conv_transpose_bias_initializer_config": null, "post_fcnet_hiddens": [], "post_fcnet_activation": "relu", "post_fcnet_weights_initializer": null, "post_fcnet_weights_initializer_config": null, "post_fcnet_bias_initializer": null, "post_fcnet_bias_initializer_config": null, "free_log_std": false, "log_std_clip_param": 20.0, "no_final_linear": false, "vf_share_layers": false, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "lstm_weights_initializer": null, "lstm_weights_initializer_config": null, "lstm_bias_initializer": null, "lstm_bias_initializer_config": null, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "attention_use_n_prev_actions": 0, "attention_use_n_prev_rewards": 0, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": null, "custom_model_config": {}, "custom_action_dist": null, "custom_preprocessor": null, "encoder_latent_dim": null, "always_check_shapes": false, "lstm_use_prev_action_reward": -1, "_use_default_native_models": -1, "_disable_preprocessor_api": false, "_disable_action_flattening": false}, "_learner_connector": null, "add_default_connectors_to_learner_pipeline": true, "learner_config_dict": {}, "optimizer": {}, "_learner_class": null, "callbacks_on_algorithm_init": null, "callbacks_on_env_runners_recreated": null, "callbacks_on_offline_eval_runners_recreated": null, "callbacks_on_checkpoint_loaded": null, "callbacks_on_environment_created": null, "callbacks_on_episode_created": null, "callbacks_on_episode_start": null, "callbacks_on_episode_step": null, "callbacks_on_episode_end": null, "callbacks_on_evaluate_start": null, "callbacks_on_evaluate_end": null, "callbacks_on_evaluate_offline_start": null, "callbacks_on_evaluate_offline_end": null, "callbacks_on_sample_end": null, "callbacks_on_train_result": null, "explore": true, "enable_rl_module_and_learner": true, "enable_env_runner_and_connector_v2": true, "_prior_exploration_config": {"type": "StochasticSampling"}, "count_steps_by": "env_steps", "policy_map_capacity": 100, "policy_mapping_fn": "<function AlgorithmConfig.DEFAULT_POLICY_MAPPING_FN at 0x385aedb20>", "policies_to_train": null, "policy_states_are_swappable": false, "observation_fn": null, "offline_data_class": null, "input_read_method": "read_parquet", "input_read_method_kwargs": {}, "input_read_schema": {}, "input_read_episodes": false, "input_read_sample_batches": false, "input_read_batch_size": null, "input_filesystem": null, "input_filesystem_kwargs": {}, "input_compress_columns": ["obs", "new_obs"], "input_spaces_jsonable": true, "materialize_data": false, "materialize_mapped_data": true, "map_batches_kwargs": {}, "iter_batches_kwargs": {}, "ignore_final_observation": false, "prelearner_class": null, "prelearner_buffer_class": null, "prelearner_buffer_kwargs": {}, "prelearner_module_synch_period": 10, "dataset_num_iters_per_learner": null, "input_config": {}, "actions_in_input_normalized": false, "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_config": {}, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "output_max_rows_per_file": null, "output_write_remaining_data": false, "output_write_method": "write_parquet", "output_write_method_kwargs": {}, "output_filesystem": null, "output_filesystem_kwargs": {}, "output_write_episodes": true, "offline_sampling": false, "evaluation_interval": 1, "evaluation_duration": 20, "evaluation_duration_unit": "episodes", "evaluation_sample_timeout_s": 120.0, "evaluation_auto_duration_min_env_steps_per_sample": 100, "evaluation_auto_duration_max_env_steps_per_sample": 2000, "evaluation_parallel_to_training": false, "evaluation_force_reset_envs_before_iteration": true, "evaluation_config": null, "off_policy_estimation_methods": {}, "ope_split_batch_by_episode": true, "evaluation_num_env_runners": 1, "in_evaluation": false, "sync_filters_on_rollout_workers_timeout_s": 10.0, "offline_evaluation_interval": null, "num_offline_eval_runners": 0, "offline_loss_for_module_fn": null, "offline_evaluation_duration": 1, "offline_evaluation_parallel_to_training": false, "offline_evaluation_timeout_s": 120.0, "num_cpus_per_offline_eval_runner": 1, "num_gpus_per_offline_eval_runner": 0, "custom_resources_per_offline_eval_runner": {}, "restart_failed_offline_eval_runners": true, "ignore_offline_eval_runner_failures": false, "max_num_offline_eval_runner_restarts": 1000, "offline_eval_runner_restore_timeout_s": 1800.0, "max_requests_in_flight_per_offline_eval_runner": 1, "validate_offline_eval_runners_after_construction": true, "offline_eval_runner_health_probe_timeout_s": 30.0, "offline_eval_rl_module_inference_only": false, "broadcast_offline_eval_runner_states": false, "offline_eval_batch_size_per_runner": 256, "dataset_num_iters_per_eval_runner": 1, "keep_per_episode_custom_metrics": false, "metrics_episode_collection_timeout_s": 60.0, "metrics_num_episodes_for_smoothing": 100, "min_time_s_per_iteration": null, "min_train_timesteps_per_iteration": 0, "min_sample_timesteps_per_iteration": 0, "log_gradients": true, "export_native_model_files": false, "checkpoint_trainable_policies_only": false, "logger_creator": null, "logger_config": null, "log_level": "WARN", "log_sys_usage": true, "fake_sampler": false, "seed": 9, "restart_failed_env_runners": true, "ignore_env_runner_failures": false, "max_num_env_runner_restarts": 1000, "delay_between_env_runner_restarts_s": 60.0, "restart_failed_sub_environments": false, "num_consecutive_env_runner_failures_tolerance": 100, "env_runner_health_probe_timeout_s": 30.0, "env_runner_restore_timeout_s": 1800.0, "_model_config": {}, "_rl_module_spec": "RLModuleSpec(module_class=None, observation_space=None, action_space=None, inference_only=False, learner_only=False, model_config=DefaultModelConfig(fcnet_hiddens=[60, 90], fcnet_activation='tanh', fcnet_kernel_initializer=None, fcnet_kernel_initializer_kwargs=None, fcnet_bias_initializer=None, fcnet_bias_initializer_kwargs=None, conv_filters=None, conv_activation='relu', conv_kernel_initializer=None, conv_kernel_initializer_kwargs=None, conv_bias_initializer=None, conv_bias_initializer_kwargs=None, head_fcnet_hiddens=[], head_fcnet_activation='relu', head_fcnet_kernel_initializer=None, head_fcnet_kernel_initializer_kwargs=None, head_fcnet_bias_initializer=None, head_fcnet_bias_initializer_kwargs=None, free_log_std=False, log_std_clip_param=20.0, vf_share_layers=True, use_lstm=False, max_seq_len=20, lstm_cell_size=256, lstm_use_prev_action=False, lstm_use_prev_reward=False, lstm_kernel_initializer=None, lstm_kernel_initializer_kwargs=None, lstm_bias_initializer=None, lstm_bias_initializer_kwargs=None), catalog_class=None, load_state_path=None, model_config_dict=None)", "algorithm_config_overrides_per_module": {}, "_per_module_overrides": {}, "_validate_config": true, "_use_msgpack_checkpoints": false, "_torch_grad_scaler_class": null, "_torch_lr_scheduler_classes": null, "_tf_policy_handles_more_than_one_loss": false, "_disable_preprocessor_api": false, "_disable_action_flattening": false, "_disable_initialize_loss_from_dummy_batch": false, "_dont_auto_sync_env_runner_states": false, "env_task_fn": -1, "enable_connectors": -1, "simple_optimizer": false, "policy_map_cache": -1, "worker_cls": -1, "synchronize_filters": -1, "enable_async_evaluation": -1, "custom_async_evaluation_function": -1, "_enable_rl_module_api": -1, "auto_wrap_old_gym_envs": -1, "always_attach_evaluation_results": -1, "replay_sequence_length": null, "_disable_execution_plan_api": -1, "use_critic": true, "use_gae": true, "use_kl_loss": true, "kl_coeff": 0.7464963036515, "kl_target": 0.0270990929592, "vf_loss_coeff": 0.6688075857018, "entropy_coeff": 0.0090570820258, "clip_param": 0.1221781641624, "vf_clip_param": 0.1027808522125, "entropy_coeff_schedule": null, "lr_schedule": null, "sgd_minibatch_size": -1, "vf_share_layers": -1, "__stdout_file__": null, "__stderr_file__": null, "lambda": 0.9099046732075, "input": "sampler", "policies": {"default_policy": [null, null, null, null]}, "callbacks": "<class 'ray.rllib.callbacks.callbacks.RLlibCallback'>", "create_env_on_driver": false, "custom_eval_function": null, "framework": "torch"}, "time_since_restore": 20.101396322250366, "iterations_since_restore": 11, "perf": {"cpu_util_percent": 50.3, "ram_util_percent": 79.9}}
{"timers": {"training_iteration": 1.8633194278992138, "restore_env_runners": 1.15424352122216e-05, "training_step": 1.8631491578348414, "env_runner_sampling_timer": 1.7457168990259646, "learner_update_timer": 0.11408109610530781, "synch_weights": 0.0006358535618975569, "restore_eval_env_runners": 1.0045467554301568e-05, "evaluation_iteration": 0.11090150049156929, "synch_eval_env_connectors": 0.00014128123711986014, "synch_env_connectors": 4.632521412121028e-06}, "env_runners": {"num_episodes_lifetime": -308250.0, "env_to_module_connector": {"connector_pipeline_timer": 4.3871368261956995e-05, "timers": {"connectors": {"add_observations_from_episodes_to_batch": 3.0051596449913794e-06, "add_time_dim_to_batch_and_zero_pad": 2.4192832395863905e-06, "batch_individual_items": 6.313867913940785e-06, "numpy_to_tensor": 8.623438038106794e-06, "add_states_from_episodes_to_batch": 1.7396093848300002e-06}}}, "num_episodes": 250.0, "env_step_timer": 1.3731351392999406e-05, "episode_len_min": 20, "num_agent_steps_sampled": {"default_agent": 5000.0}, "agent_episode_returns_mean": {"default_agent": 9.539999999999996}, "episode_return_mean": 9.539999999999996, "num_env_steps_sampled": 5000.0, "module_to_env_connector": {"timers": {"connectors": {"remove_single_ts_time_rank_from_batch": 5.816177001389869e-07, "un_batch_to_individual_items": 5.419539386823875e-06, "listify_data_for_vector_env": 1.1065663940399861e-05, "normalize_and_clip_actions": 9.404627107172169e-06, "get_actions": 3.747488151664727e-05, "tensor_to_numpy": 1.2992094901759742e-05}}, "connector_pipeline_timer": 0.00010233202274591852}, "episode_duration_sec_mean": 0.004516564273275437, "sample": 0.005008524715303782, "num_module_steps_sampled_lifetime": {"default_policy": -6165000.0}, "env_reset_timer": 3.662208944446448e-05, "time_between_sampling": 0.001836266368091296, "episode_len_max": 20, "weights_seq_no": 11.0, "num_env_steps_sampled_lifetime": -6165000.0, "env_to_module_sum_episodes_length_in": 10.36823839457432, "episode_len_mean": 20.0, "module_episode_returns_mean": {"default_policy": 9.539999999999996}, "episode_return_min": -5.5, "episode_return_max": 14.5, "num_agent_steps_sampled_lifetime": {"default_agent": -6165000.0}, "rlmodule_inference_timer": 2.7559080549452184e-05, "env_to_module_sum_episodes_length_out": 10.36823839457432, "num_module_steps_sampled": {"default_policy": 5000.0}, "num_env_steps_sampled_lifetime_throughput": 3731.573146657413}, "learners": {"default_policy": {"module_train_batch_size_mean": 1000.0, "vf_explained_var": 0.0028873085975646973, "num_module_steps_trained_lifetime": 72000, "entropy": 0.6375489234924316, "curr_kl_coeff": 0.00018225007806904614, "vf_loss_unclipped": 37.25564193725586, "diff_num_grad_updates_vs_sampler_policy": 1.0, "default_optimizer_learning_rate": 0.0002847858517, "total_loss": -0.09505714476108551, "mean_kl_loss": 0.0003195784520357847, "vf_loss": 0.10111989825963974, "gradients_default_optimizer_global_norm": 0.030036011710762978, "weights_seq_no": 12.0, "num_module_steps_trained": 6000, "policy_loss": -0.156912699341774, "curr_entropy_coeff": 0.0090570820258, "num_trainable_parameters": 6003, "num_module_steps_trained_lifetime_throughput": 409528.57036536717}, "__all_modules__": {"num_module_steps_trained": 6000, "num_trainable_parameters": 6003, "learner_connector_sum_episodes_length_in": 5000.0, "num_env_steps_trained": 31500, "learner_connector": {"timers": {"connectors": {"batch_individual_items": 0.03449723549014199, "numpy_to_tensor": 0.00014546685697523166, "add_states_from_episodes_to_batch": 3.579314232382585e-06, "add_observations_from_episodes_to_batch": 0.0008083504487723735, "add_columns_from_episodes_to_train_batch": 0.0349177352118174, "add_time_dim_to_batch_and_zero_pad": 1.5875193506450595e-05, "add_one_ts_to_episodes_and_truncate": 0.008815193263081972, "general_advantage_estimation": 0.007763009404158147}}, "connector_pipeline_timer": 0.08713978968185898}, "num_module_steps_trained_lifetime": 72000, "learner_connector_sum_episodes_length_out": 5250.0, "num_env_steps_trained_lifetime": 378000, "num_non_trainable_parameters": 0, "num_env_steps_trained_lifetime_throughput": 2117730.394152444, "num_module_steps_trained_throughput": 405657.45757082535, "num_module_steps_trained_lifetime_throughput": 404624.10382784856}}, "num_training_step_calls_per_iteration": 1, "evaluation": {"env_runners": {"num_env_steps_sampled": 400, "env_to_module_connector": {"timers": {"connectors": {"add_states_from_episodes_to_batch": 1.6510004331886837e-06, "add_observations_from_episodes_to_batch": 2.7889627443474896e-06, "add_time_dim_to_batch_and_zero_pad": 2.3588773360793042e-06, "batch_individual_items": 6.018280074181414e-06, "numpy_to_tensor": 8.210623877567899e-06}}, "connector_pipeline_timer": 4.2882794118795394e-05}, "episode_len_max": 20, "num_module_steps_sampled_lifetime": {"default_policy": 4800}, "rlmodule_inference_timer": 2.6769737997970004e-05, "env_to_module_sum_episodes_length_out": 10.368238394574323, "module_to_env_connector": {"connector_pipeline_timer": 9.803501884116325e-05, "timers": {"connectors": {"tensor_to_numpy": 1.2534332053486707e-05, "listify_data_for_vector_env": 1.0608445502442695e-05, "get_actions": 3.428021870372679e-05, "normalize_and_clip_actions": 9.339059060345663e-06, "remove_single_ts_time_rank_from_batch": 6.419096240217333e-07, "un_batch_to_individual_items": 5.27498391765654e-06}}}, "episode_len_min": 20, "env_reset_timer": 0.000198443109624957, "episode_return_max": 15.5, "num_episodes_lifetime": 240, "num_episodes": 20, "episode_return_mean": 2.3, "num_module_steps_sampled": {"default_policy": 400}, "episode_duration_sec_mean": 0.005638285438762978, "sample": 0.10128918858308776, "weights_seq_no": 12.0, "module_episode_returns_mean": {"default_policy": 2.3}, "num_agent_steps_sampled_lifetime": {"default_agent": 4800}, "env_step_timer": 1.3502763305168293e-05, "num_agent_steps_sampled": {"default_agent": 400}, "agent_episode_returns_mean": {"default_agent": 2.3}, "num_env_steps_sampled_lifetime": 60400, "env_to_module_sum_episodes_length_in": 10.368238394574323, "episode_len_mean": 20.0, "episode_return_min": -13.5, "time_between_sampling": 1.6514849295392917}, "num_healthy_workers": 1, "actor_manager_num_outstanding_async_reqs": 0, "num_remote_worker_restarts": 0}, "num_env_steps_sampled_lifetime": -6165000.0, "fault_tolerance": {"num_healthy_workers": 0, "num_remote_worker_restarts": 0}, "env_runner_group": {"actor_manager_num_outstanding_async_reqs": 0}, "done": false, "training_iteration": 12, "trial_id": "4d67b_00000", "date": "2025-08-11_19-22-39", "timestamp": 1754932959, "time_this_iter_s": 1.6532700061798096, "time_total_s": 21.754666328430176, "pid": 14356, "hostname": "Mac", "node_ip": "127.0.0.1", "config": {"exploration_config": {}, "extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "placement_strategy": "PACK", "num_gpus": 0, "_fake_gpus": false, "num_cpus_for_main_process": 2, "eager_tracing": true, "eager_max_retraces": 20, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "torch_compile_learner": false, "torch_compile_learner_what_to_compile": "forward_train", "torch_compile_learner_dynamo_backend": "aot_eager", "torch_compile_learner_dynamo_mode": null, "torch_compile_worker": false, "torch_compile_worker_dynamo_backend": "aot_eager", "torch_compile_worker_dynamo_mode": null, "torch_ddp_kwargs": {}, "torch_skip_nan_gradients": false, "env": "Umbrella", "env_config": {}, "observation_space": null, "action_space": null, "clip_rewards": null, "normalize_actions": true, "clip_actions": false, "_is_atari": null, "disable_env_checking": false, "render_env": false, "action_mask_key": "action_mask", "env_runner_cls": null, "num_env_runners": 0, "create_local_env_runner": true, "num_envs_per_env_runner": 1, "gym_env_vectorize_mode": "SYNC", "num_cpus_per_env_runner": 1, "num_gpus_per_env_runner": 0, "custom_resources_per_env_runner": {}, "validate_env_runners_after_construction": true, "episodes_to_numpy": true, "max_requests_in_flight_per_env_runner": 1, "sample_timeout_s": 60.0, "_env_to_module_connector": null, "add_default_connectors_to_env_to_module_pipeline": true, "_module_to_env_connector": null, "add_default_connectors_to_module_to_env_pipeline": true, "merge_env_runner_states": "training_only", "broadcast_env_runner_states": true, "episode_lookback_horizon": 1, "rollout_fragment_length": "auto", "batch_mode": "complete_episodes", "compress_observations": false, "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "enable_tf1_exec_eagerly": false, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "preprocessor_pref": "deepmind", "observation_filter": "NoFilter", "update_worker_filter_stats": true, "use_worker_filter_stats": true, "sampler_perf_stats_ema_coef": null, "_is_online": true, "num_learners": 0, "num_gpus_per_learner": 0, "num_cpus_per_learner": "auto", "num_aggregator_actors_per_learner": 0, "max_requests_in_flight_per_aggregator_actor": 3, "local_gpu_idx": 0, "max_requests_in_flight_per_learner": 3, "gamma": 1, "lr": 0.0002847858517, "grad_clip": 0.5, "grad_clip_by": "global_norm", "_train_batch_size_per_learner": 5000, "train_batch_size": 4000, "num_epochs": 1, "minibatch_size": 1000, "shuffle_batch_per_epoch": true, "model": {"fcnet_hiddens": [256, 256], "fcnet_activation": "tanh", "fcnet_weights_initializer": null, "fcnet_weights_initializer_config": null, "fcnet_bias_initializer": null, "fcnet_bias_initializer_config": null, "conv_filters": null, "conv_activation": "relu", "conv_kernel_initializer": null, "conv_kernel_initializer_config": null, "conv_bias_initializer": null, "conv_bias_initializer_config": null, "conv_transpose_kernel_initializer": null, "conv_transpose_kernel_initializer_config": null, "conv_transpose_bias_initializer": null, "conv_transpose_bias_initializer_config": null, "post_fcnet_hiddens": [], "post_fcnet_activation": "relu", "post_fcnet_weights_initializer": null, "post_fcnet_weights_initializer_config": null, "post_fcnet_bias_initializer": null, "post_fcnet_bias_initializer_config": null, "free_log_std": false, "log_std_clip_param": 20.0, "no_final_linear": false, "vf_share_layers": false, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "lstm_weights_initializer": null, "lstm_weights_initializer_config": null, "lstm_bias_initializer": null, "lstm_bias_initializer_config": null, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "attention_use_n_prev_actions": 0, "attention_use_n_prev_rewards": 0, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": null, "custom_model_config": {}, "custom_action_dist": null, "custom_preprocessor": null, "encoder_latent_dim": null, "always_check_shapes": false, "lstm_use_prev_action_reward": -1, "_use_default_native_models": -1, "_disable_preprocessor_api": false, "_disable_action_flattening": false}, "_learner_connector": null, "add_default_connectors_to_learner_pipeline": true, "learner_config_dict": {}, "optimizer": {}, "_learner_class": null, "callbacks_on_algorithm_init": null, "callbacks_on_env_runners_recreated": null, "callbacks_on_offline_eval_runners_recreated": null, "callbacks_on_checkpoint_loaded": null, "callbacks_on_environment_created": null, "callbacks_on_episode_created": null, "callbacks_on_episode_start": null, "callbacks_on_episode_step": null, "callbacks_on_episode_end": null, "callbacks_on_evaluate_start": null, "callbacks_on_evaluate_end": null, "callbacks_on_evaluate_offline_start": null, "callbacks_on_evaluate_offline_end": null, "callbacks_on_sample_end": null, "callbacks_on_train_result": null, "explore": true, "enable_rl_module_and_learner": true, "enable_env_runner_and_connector_v2": true, "_prior_exploration_config": {"type": "StochasticSampling"}, "count_steps_by": "env_steps", "policy_map_capacity": 100, "policy_mapping_fn": "<function AlgorithmConfig.DEFAULT_POLICY_MAPPING_FN at 0x385aedb20>", "policies_to_train": null, "policy_states_are_swappable": false, "observation_fn": null, "offline_data_class": null, "input_read_method": "read_parquet", "input_read_method_kwargs": {}, "input_read_schema": {}, "input_read_episodes": false, "input_read_sample_batches": false, "input_read_batch_size": null, "input_filesystem": null, "input_filesystem_kwargs": {}, "input_compress_columns": ["obs", "new_obs"], "input_spaces_jsonable": true, "materialize_data": false, "materialize_mapped_data": true, "map_batches_kwargs": {}, "iter_batches_kwargs": {}, "ignore_final_observation": false, "prelearner_class": null, "prelearner_buffer_class": null, "prelearner_buffer_kwargs": {}, "prelearner_module_synch_period": 10, "dataset_num_iters_per_learner": null, "input_config": {}, "actions_in_input_normalized": false, "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_config": {}, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "output_max_rows_per_file": null, "output_write_remaining_data": false, "output_write_method": "write_parquet", "output_write_method_kwargs": {}, "output_filesystem": null, "output_filesystem_kwargs": {}, "output_write_episodes": true, "offline_sampling": false, "evaluation_interval": 1, "evaluation_duration": 20, "evaluation_duration_unit": "episodes", "evaluation_sample_timeout_s": 120.0, "evaluation_auto_duration_min_env_steps_per_sample": 100, "evaluation_auto_duration_max_env_steps_per_sample": 2000, "evaluation_parallel_to_training": false, "evaluation_force_reset_envs_before_iteration": true, "evaluation_config": null, "off_policy_estimation_methods": {}, "ope_split_batch_by_episode": true, "evaluation_num_env_runners": 1, "in_evaluation": false, "sync_filters_on_rollout_workers_timeout_s": 10.0, "offline_evaluation_interval": null, "num_offline_eval_runners": 0, "offline_loss_for_module_fn": null, "offline_evaluation_duration": 1, "offline_evaluation_parallel_to_training": false, "offline_evaluation_timeout_s": 120.0, "num_cpus_per_offline_eval_runner": 1, "num_gpus_per_offline_eval_runner": 0, "custom_resources_per_offline_eval_runner": {}, "restart_failed_offline_eval_runners": true, "ignore_offline_eval_runner_failures": false, "max_num_offline_eval_runner_restarts": 1000, "offline_eval_runner_restore_timeout_s": 1800.0, "max_requests_in_flight_per_offline_eval_runner": 1, "validate_offline_eval_runners_after_construction": true, "offline_eval_runner_health_probe_timeout_s": 30.0, "offline_eval_rl_module_inference_only": false, "broadcast_offline_eval_runner_states": false, "offline_eval_batch_size_per_runner": 256, "dataset_num_iters_per_eval_runner": 1, "keep_per_episode_custom_metrics": false, "metrics_episode_collection_timeout_s": 60.0, "metrics_num_episodes_for_smoothing": 100, "min_time_s_per_iteration": null, "min_train_timesteps_per_iteration": 0, "min_sample_timesteps_per_iteration": 0, "log_gradients": true, "export_native_model_files": false, "checkpoint_trainable_policies_only": false, "logger_creator": null, "logger_config": null, "log_level": "WARN", "log_sys_usage": true, "fake_sampler": false, "seed": 9, "restart_failed_env_runners": true, "ignore_env_runner_failures": false, "max_num_env_runner_restarts": 1000, "delay_between_env_runner_restarts_s": 60.0, "restart_failed_sub_environments": false, "num_consecutive_env_runner_failures_tolerance": 100, "env_runner_health_probe_timeout_s": 30.0, "env_runner_restore_timeout_s": 1800.0, "_model_config": {}, "_rl_module_spec": "RLModuleSpec(module_class=None, observation_space=None, action_space=None, inference_only=False, learner_only=False, model_config=DefaultModelConfig(fcnet_hiddens=[60, 90], fcnet_activation='tanh', fcnet_kernel_initializer=None, fcnet_kernel_initializer_kwargs=None, fcnet_bias_initializer=None, fcnet_bias_initializer_kwargs=None, conv_filters=None, conv_activation='relu', conv_kernel_initializer=None, conv_kernel_initializer_kwargs=None, conv_bias_initializer=None, conv_bias_initializer_kwargs=None, head_fcnet_hiddens=[], head_fcnet_activation='relu', head_fcnet_kernel_initializer=None, head_fcnet_kernel_initializer_kwargs=None, head_fcnet_bias_initializer=None, head_fcnet_bias_initializer_kwargs=None, free_log_std=False, log_std_clip_param=20.0, vf_share_layers=True, use_lstm=False, max_seq_len=20, lstm_cell_size=256, lstm_use_prev_action=False, lstm_use_prev_reward=False, lstm_kernel_initializer=None, lstm_kernel_initializer_kwargs=None, lstm_bias_initializer=None, lstm_bias_initializer_kwargs=None), catalog_class=None, load_state_path=None, model_config_dict=None)", "algorithm_config_overrides_per_module": {}, "_per_module_overrides": {}, "_validate_config": true, "_use_msgpack_checkpoints": false, "_torch_grad_scaler_class": null, "_torch_lr_scheduler_classes": null, "_tf_policy_handles_more_than_one_loss": false, "_disable_preprocessor_api": false, "_disable_action_flattening": false, "_disable_initialize_loss_from_dummy_batch": false, "_dont_auto_sync_env_runner_states": false, "env_task_fn": -1, "enable_connectors": -1, "simple_optimizer": false, "policy_map_cache": -1, "worker_cls": -1, "synchronize_filters": -1, "enable_async_evaluation": -1, "custom_async_evaluation_function": -1, "_enable_rl_module_api": -1, "auto_wrap_old_gym_envs": -1, "always_attach_evaluation_results": -1, "replay_sequence_length": null, "_disable_execution_plan_api": -1, "use_critic": true, "use_gae": true, "use_kl_loss": true, "kl_coeff": 0.7464963036515, "kl_target": 0.0270990929592, "vf_loss_coeff": 0.6688075857018, "entropy_coeff": 0.0090570820258, "clip_param": 0.1221781641624, "vf_clip_param": 0.1027808522125, "entropy_coeff_schedule": null, "lr_schedule": null, "sgd_minibatch_size": -1, "vf_share_layers": -1, "__stdout_file__": null, "__stderr_file__": null, "lambda": 0.9099046732075, "input": "sampler", "policies": {"default_policy": [null, null, null, null]}, "callbacks": "<class 'ray.rllib.callbacks.callbacks.RLlibCallback'>", "create_env_on_driver": false, "custom_eval_function": null, "framework": "torch"}, "time_since_restore": 21.754666328430176, "iterations_since_restore": 12, "perf": {"cpu_util_percent": 39.666666666666664, "ram_util_percent": 79.76666666666667}}
{"timers": {"training_iteration": 1.8600245848694508, "restore_env_runners": 1.1481591019584724e-05, "training_step": 1.8598543987564928, "env_runner_sampling_timer": 1.7426666125357482, "learner_update_timer": 0.11383857764431479, "synch_weights": 0.0006346041967303417, "restore_eval_env_runners": 1.0017512848732713e-05, "evaluation_iteration": 0.1108149642361635, "synch_eval_env_connectors": 0.0001416009245530093, "synch_env_connectors": 4.628695939539176e-06}, "env_runners": {"num_episodes_lifetime": -339125.0, "env_to_module_connector": {"connector_pipeline_timer": 4.330873674169226e-05, "timers": {"connectors": {"add_observations_from_episodes_to_batch": 2.9178340940396272e-06, "add_time_dim_to_batch_and_zero_pad": 2.3907099126732305e-06, "batch_individual_items": 6.255104695087587e-06, "numpy_to_tensor": 8.516711285849114e-06, "add_states_from_episodes_to_batch": 1.734815931938045e-06}}}, "num_episodes": 250.0, "env_step_timer": 1.3579757158881825e-05, "episode_len_min": 20, "num_agent_steps_sampled": {"default_agent": 5000.0}, "agent_episode_returns_mean": {"default_agent": 9.460000000000004}, "episode_return_mean": 9.460000000000004, "num_env_steps_sampled": 5000.0, "module_to_env_connector": {"timers": {"connectors": {"remove_single_ts_time_rank_from_batch": 5.732815723014468e-07, "un_batch_to_individual_items": 5.32762776969516e-06, "listify_data_for_vector_env": 1.0976145331035348e-05, "normalize_and_clip_actions": 9.34743355791301e-06, "get_actions": 3.7047481979888346e-05, "tensor_to_numpy": 1.2842164464290328e-05}}, "connector_pipeline_timer": 0.00010131059802886054}, "episode_duration_sec_mean": 0.0044643720095045875, "sample": 0.004793970513018589, "num_module_steps_sampled_lifetime": {"default_policy": -6782500.0}, "env_reset_timer": 3.226898609213211e-05, "time_between_sampling": 0.0016686286418804658, "episode_len_max": 20, "weights_seq_no": 12.0, "num_env_steps_sampled_lifetime": -6782500.0, "env_to_module_sum_episodes_length_in": 10.36823839457432, "episode_len_mean": 20.0, "module_episode_returns_mean": {"default_policy": 9.460000000000004}, "episode_return_min": -5.5, "episode_return_max": 14.5, "num_agent_steps_sampled_lifetime": {"default_agent": -6782500.0}, "rlmodule_inference_timer": 2.7021174637047527e-05, "env_to_module_sum_episodes_length_out": 10.36823839457432, "num_module_steps_sampled": {"default_policy": 5000.0}, "num_env_steps_sampled_lifetime_throughput": 3779.8079858049086}, "learners": {"default_policy": {"module_train_batch_size_mean": 1000.0, "vf_explained_var": 0.004157304763793945, "num_module_steps_trained_lifetime": 78000, "entropy": 0.6236662864685059, "curr_kl_coeff": 9.112503903452307e-05, "vf_loss_unclipped": 36.1948127746582, "diff_num_grad_updates_vs_sampler_policy": 1.0, "default_optimizer_learning_rate": 0.0002847858517, "total_loss": 0.00666135223582387, "mean_kl_loss": 0.00024740456137806177, "vf_loss": 0.10056453198194504, "gradients_default_optimizer_global_norm": 0.024964654818177223, "weights_seq_no": 13.0, "num_module_steps_trained": 6000, "policy_loss": -0.05494841933250427, "curr_entropy_coeff": 0.0090570820258, "num_trainable_parameters": 6003, "num_module_steps_trained_lifetime_throughput": 410094.89171614166}, "__all_modules__": {"num_module_steps_trained": 6000, "num_trainable_parameters": 6003, "learner_connector_sum_episodes_length_in": 5000.0, "num_env_steps_trained": 31500, "learner_connector": {"timers": {"connectors": {"batch_individual_items": 0.03445306271553149, "numpy_to_tensor": 0.0001444846879287912, "add_states_from_episodes_to_batch": 3.569771580977515e-06, "add_observations_from_episodes_to_batch": 0.0008081394442758581, "add_columns_from_episodes_to_train_batch": 0.03490030993993672, "add_time_dim_to_batch_and_zero_pad": 1.579728153501593e-05, "add_one_ts_to_episodes_and_truncate": 0.008802302990837028, "general_advantage_estimation": 0.007737670140179268}}, "connector_pipeline_timer": 0.08703776636516293}, "num_module_steps_trained_lifetime": 78000, "learner_connector_sum_episodes_length_out": 5250.0, "num_env_steps_trained_lifetime": 409500, "num_non_trainable_parameters": 0, "num_env_steps_trained_lifetime_throughput": 2122366.5213733283, "num_module_steps_trained_throughput": 406444.7282850948, "num_module_steps_trained_lifetime_throughput": 405450.43252264877}}, "num_training_step_calls_per_iteration": 1, "evaluation": {"env_runners": {"num_env_steps_sampled": 400, "env_to_module_connector": {"timers": {"connectors": {"add_states_from_episodes_to_batch": 1.5993218477685528e-06, "add_observations_from_episodes_to_batch": 2.820293617897495e-06, "add_time_dim_to_batch_and_zero_pad": 2.3244180677465284e-06, "batch_individual_items": 6.07018057041923e-06, "numpy_to_tensor": 8.302571708353262e-06}}, "connector_pipeline_timer": 4.2585364705389864e-05}, "episode_len_max": 20, "num_module_steps_sampled_lifetime": {"default_policy": 5200}, "rlmodule_inference_timer": 2.6798247164498107e-05, "env_to_module_sum_episodes_length_out": 10.368238394574323, "module_to_env_connector": {"connector_pipeline_timer": 9.959070526986063e-05, "timers": {"connectors": {"tensor_to_numpy": 1.2734624671927392e-05, "listify_data_for_vector_env": 1.071138921133076e-05, "get_actions": 3.5254655060328705e-05, "normalize_and_clip_actions": 9.349762291097728e-06, "remove_single_ts_time_rank_from_batch": 6.342157065597868e-07, "un_batch_to_individual_items": 5.302764695669836e-06}}}, "episode_len_min": 20, "env_reset_timer": 0.00019717533823479337, "episode_return_max": 15.5, "num_episodes_lifetime": 260, "num_episodes": 20, "episode_return_mean": 1.3, "num_module_steps_sampled": {"default_policy": 400}, "episode_duration_sec_mean": 0.004693097902927548, "sample": 0.10124887711804154, "weights_seq_no": 13.0, "module_episode_returns_mean": {"default_policy": 1.3}, "num_agent_steps_sampled_lifetime": {"default_agent": 5200}, "env_step_timer": 1.3787378456711472e-05, "num_agent_steps_sampled": {"default_agent": 400}, "agent_episode_returns_mean": {"default_agent": 1.3}, "num_env_steps_sampled_lifetime": 65400, "env_to_module_sum_episodes_length_in": 10.368238394574323, "episode_len_mean": 20.0, "episode_return_min": -13.5, "time_between_sampling": 1.6504748210744096}, "num_healthy_workers": 1, "actor_manager_num_outstanding_async_reqs": 0, "num_remote_worker_restarts": 0}, "num_env_steps_sampled_lifetime": -6782500.0, "fault_tolerance": {"num_healthy_workers": 0, "num_remote_worker_restarts": 0}, "env_runner_group": {"actor_manager_num_outstanding_async_reqs": 0}, "done": false, "training_iteration": 13, "trial_id": "4d67b_00000", "date": "2025-08-11_19-22-41", "timestamp": 1754932961, "time_this_iter_s": 1.6380629539489746, "time_total_s": 23.39272928237915, "pid": 14356, "hostname": "Mac", "node_ip": "127.0.0.1", "config": {"exploration_config": {}, "extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "placement_strategy": "PACK", "num_gpus": 0, "_fake_gpus": false, "num_cpus_for_main_process": 2, "eager_tracing": true, "eager_max_retraces": 20, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "torch_compile_learner": false, "torch_compile_learner_what_to_compile": "forward_train", "torch_compile_learner_dynamo_backend": "aot_eager", "torch_compile_learner_dynamo_mode": null, "torch_compile_worker": false, "torch_compile_worker_dynamo_backend": "aot_eager", "torch_compile_worker_dynamo_mode": null, "torch_ddp_kwargs": {}, "torch_skip_nan_gradients": false, "env": "Umbrella", "env_config": {}, "observation_space": null, "action_space": null, "clip_rewards": null, "normalize_actions": true, "clip_actions": false, "_is_atari": null, "disable_env_checking": false, "render_env": false, "action_mask_key": "action_mask", "env_runner_cls": null, "num_env_runners": 0, "create_local_env_runner": true, "num_envs_per_env_runner": 1, "gym_env_vectorize_mode": "SYNC", "num_cpus_per_env_runner": 1, "num_gpus_per_env_runner": 0, "custom_resources_per_env_runner": {}, "validate_env_runners_after_construction": true, "episodes_to_numpy": true, "max_requests_in_flight_per_env_runner": 1, "sample_timeout_s": 60.0, "_env_to_module_connector": null, "add_default_connectors_to_env_to_module_pipeline": true, "_module_to_env_connector": null, "add_default_connectors_to_module_to_env_pipeline": true, "merge_env_runner_states": "training_only", "broadcast_env_runner_states": true, "episode_lookback_horizon": 1, "rollout_fragment_length": "auto", "batch_mode": "complete_episodes", "compress_observations": false, "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "enable_tf1_exec_eagerly": false, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "preprocessor_pref": "deepmind", "observation_filter": "NoFilter", "update_worker_filter_stats": true, "use_worker_filter_stats": true, "sampler_perf_stats_ema_coef": null, "_is_online": true, "num_learners": 0, "num_gpus_per_learner": 0, "num_cpus_per_learner": "auto", "num_aggregator_actors_per_learner": 0, "max_requests_in_flight_per_aggregator_actor": 3, "local_gpu_idx": 0, "max_requests_in_flight_per_learner": 3, "gamma": 1, "lr": 0.0002847858517, "grad_clip": 0.5, "grad_clip_by": "global_norm", "_train_batch_size_per_learner": 5000, "train_batch_size": 4000, "num_epochs": 1, "minibatch_size": 1000, "shuffle_batch_per_epoch": true, "model": {"fcnet_hiddens": [256, 256], "fcnet_activation": "tanh", "fcnet_weights_initializer": null, "fcnet_weights_initializer_config": null, "fcnet_bias_initializer": null, "fcnet_bias_initializer_config": null, "conv_filters": null, "conv_activation": "relu", "conv_kernel_initializer": null, "conv_kernel_initializer_config": null, "conv_bias_initializer": null, "conv_bias_initializer_config": null, "conv_transpose_kernel_initializer": null, "conv_transpose_kernel_initializer_config": null, "conv_transpose_bias_initializer": null, "conv_transpose_bias_initializer_config": null, "post_fcnet_hiddens": [], "post_fcnet_activation": "relu", "post_fcnet_weights_initializer": null, "post_fcnet_weights_initializer_config": null, "post_fcnet_bias_initializer": null, "post_fcnet_bias_initializer_config": null, "free_log_std": false, "log_std_clip_param": 20.0, "no_final_linear": false, "vf_share_layers": false, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "lstm_weights_initializer": null, "lstm_weights_initializer_config": null, "lstm_bias_initializer": null, "lstm_bias_initializer_config": null, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "attention_use_n_prev_actions": 0, "attention_use_n_prev_rewards": 0, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": null, "custom_model_config": {}, "custom_action_dist": null, "custom_preprocessor": null, "encoder_latent_dim": null, "always_check_shapes": false, "lstm_use_prev_action_reward": -1, "_use_default_native_models": -1, "_disable_preprocessor_api": false, "_disable_action_flattening": false}, "_learner_connector": null, "add_default_connectors_to_learner_pipeline": true, "learner_config_dict": {}, "optimizer": {}, "_learner_class": null, "callbacks_on_algorithm_init": null, "callbacks_on_env_runners_recreated": null, "callbacks_on_offline_eval_runners_recreated": null, "callbacks_on_checkpoint_loaded": null, "callbacks_on_environment_created": null, "callbacks_on_episode_created": null, "callbacks_on_episode_start": null, "callbacks_on_episode_step": null, "callbacks_on_episode_end": null, "callbacks_on_evaluate_start": null, "callbacks_on_evaluate_end": null, "callbacks_on_evaluate_offline_start": null, "callbacks_on_evaluate_offline_end": null, "callbacks_on_sample_end": null, "callbacks_on_train_result": null, "explore": true, "enable_rl_module_and_learner": true, "enable_env_runner_and_connector_v2": true, "_prior_exploration_config": {"type": "StochasticSampling"}, "count_steps_by": "env_steps", "policy_map_capacity": 100, "policy_mapping_fn": "<function AlgorithmConfig.DEFAULT_POLICY_MAPPING_FN at 0x385aedb20>", "policies_to_train": null, "policy_states_are_swappable": false, "observation_fn": null, "offline_data_class": null, "input_read_method": "read_parquet", "input_read_method_kwargs": {}, "input_read_schema": {}, "input_read_episodes": false, "input_read_sample_batches": false, "input_read_batch_size": null, "input_filesystem": null, "input_filesystem_kwargs": {}, "input_compress_columns": ["obs", "new_obs"], "input_spaces_jsonable": true, "materialize_data": false, "materialize_mapped_data": true, "map_batches_kwargs": {}, "iter_batches_kwargs": {}, "ignore_final_observation": false, "prelearner_class": null, "prelearner_buffer_class": null, "prelearner_buffer_kwargs": {}, "prelearner_module_synch_period": 10, "dataset_num_iters_per_learner": null, "input_config": {}, "actions_in_input_normalized": false, "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_config": {}, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "output_max_rows_per_file": null, "output_write_remaining_data": false, "output_write_method": "write_parquet", "output_write_method_kwargs": {}, "output_filesystem": null, "output_filesystem_kwargs": {}, "output_write_episodes": true, "offline_sampling": false, "evaluation_interval": 1, "evaluation_duration": 20, "evaluation_duration_unit": "episodes", "evaluation_sample_timeout_s": 120.0, "evaluation_auto_duration_min_env_steps_per_sample": 100, "evaluation_auto_duration_max_env_steps_per_sample": 2000, "evaluation_parallel_to_training": false, "evaluation_force_reset_envs_before_iteration": true, "evaluation_config": null, "off_policy_estimation_methods": {}, "ope_split_batch_by_episode": true, "evaluation_num_env_runners": 1, "in_evaluation": false, "sync_filters_on_rollout_workers_timeout_s": 10.0, "offline_evaluation_interval": null, "num_offline_eval_runners": 0, "offline_loss_for_module_fn": null, "offline_evaluation_duration": 1, "offline_evaluation_parallel_to_training": false, "offline_evaluation_timeout_s": 120.0, "num_cpus_per_offline_eval_runner": 1, "num_gpus_per_offline_eval_runner": 0, "custom_resources_per_offline_eval_runner": {}, "restart_failed_offline_eval_runners": true, "ignore_offline_eval_runner_failures": false, "max_num_offline_eval_runner_restarts": 1000, "offline_eval_runner_restore_timeout_s": 1800.0, "max_requests_in_flight_per_offline_eval_runner": 1, "validate_offline_eval_runners_after_construction": true, "offline_eval_runner_health_probe_timeout_s": 30.0, "offline_eval_rl_module_inference_only": false, "broadcast_offline_eval_runner_states": false, "offline_eval_batch_size_per_runner": 256, "dataset_num_iters_per_eval_runner": 1, "keep_per_episode_custom_metrics": false, "metrics_episode_collection_timeout_s": 60.0, "metrics_num_episodes_for_smoothing": 100, "min_time_s_per_iteration": null, "min_train_timesteps_per_iteration": 0, "min_sample_timesteps_per_iteration": 0, "log_gradients": true, "export_native_model_files": false, "checkpoint_trainable_policies_only": false, "logger_creator": null, "logger_config": null, "log_level": "WARN", "log_sys_usage": true, "fake_sampler": false, "seed": 9, "restart_failed_env_runners": true, "ignore_env_runner_failures": false, "max_num_env_runner_restarts": 1000, "delay_between_env_runner_restarts_s": 60.0, "restart_failed_sub_environments": false, "num_consecutive_env_runner_failures_tolerance": 100, "env_runner_health_probe_timeout_s": 30.0, "env_runner_restore_timeout_s": 1800.0, "_model_config": {}, "_rl_module_spec": "RLModuleSpec(module_class=None, observation_space=None, action_space=None, inference_only=False, learner_only=False, model_config=DefaultModelConfig(fcnet_hiddens=[60, 90], fcnet_activation='tanh', fcnet_kernel_initializer=None, fcnet_kernel_initializer_kwargs=None, fcnet_bias_initializer=None, fcnet_bias_initializer_kwargs=None, conv_filters=None, conv_activation='relu', conv_kernel_initializer=None, conv_kernel_initializer_kwargs=None, conv_bias_initializer=None, conv_bias_initializer_kwargs=None, head_fcnet_hiddens=[], head_fcnet_activation='relu', head_fcnet_kernel_initializer=None, head_fcnet_kernel_initializer_kwargs=None, head_fcnet_bias_initializer=None, head_fcnet_bias_initializer_kwargs=None, free_log_std=False, log_std_clip_param=20.0, vf_share_layers=True, use_lstm=False, max_seq_len=20, lstm_cell_size=256, lstm_use_prev_action=False, lstm_use_prev_reward=False, lstm_kernel_initializer=None, lstm_kernel_initializer_kwargs=None, lstm_bias_initializer=None, lstm_bias_initializer_kwargs=None), catalog_class=None, load_state_path=None, model_config_dict=None)", "algorithm_config_overrides_per_module": {}, "_per_module_overrides": {}, "_validate_config": true, "_use_msgpack_checkpoints": false, "_torch_grad_scaler_class": null, "_torch_lr_scheduler_classes": null, "_tf_policy_handles_more_than_one_loss": false, "_disable_preprocessor_api": false, "_disable_action_flattening": false, "_disable_initialize_loss_from_dummy_batch": false, "_dont_auto_sync_env_runner_states": false, "env_task_fn": -1, "enable_connectors": -1, "simple_optimizer": false, "policy_map_cache": -1, "worker_cls": -1, "synchronize_filters": -1, "enable_async_evaluation": -1, "custom_async_evaluation_function": -1, "_enable_rl_module_api": -1, "auto_wrap_old_gym_envs": -1, "always_attach_evaluation_results": -1, "replay_sequence_length": null, "_disable_execution_plan_api": -1, "use_critic": true, "use_gae": true, "use_kl_loss": true, "kl_coeff": 0.7464963036515, "kl_target": 0.0270990929592, "vf_loss_coeff": 0.6688075857018, "entropy_coeff": 0.0090570820258, "clip_param": 0.1221781641624, "vf_clip_param": 0.1027808522125, "entropy_coeff_schedule": null, "lr_schedule": null, "sgd_minibatch_size": -1, "vf_share_layers": -1, "__stdout_file__": null, "__stderr_file__": null, "lambda": 0.9099046732075, "input": "sampler", "policies": {"default_policy": [null, null, null, null]}, "callbacks": "<class 'ray.rllib.callbacks.callbacks.RLlibCallback'>", "create_env_on_driver": false, "custom_eval_function": null, "framework": "torch"}, "time_since_restore": 23.39272928237915, "iterations_since_restore": 13, "perf": {"cpu_util_percent": 39.25, "ram_util_percent": 78.85}}
{"timers": {"training_iteration": 1.8568438073509757, "restore_env_runners": 1.142636462017243e-05, "training_step": 1.8566732318597081, "env_runner_sampling_timer": 1.7388196909999056, "learner_update_timer": 0.11450443061777248, "synch_weights": 0.0006342423237284078, "restore_eval_env_runners": 9.980678132698203e-06, "evaluation_iteration": 0.11072632251393853, "synch_eval_env_connectors": 0.00014115825566420168, "synch_env_connectors": 4.6219890254117235e-06}, "env_runners": {"num_episodes_lifetime": -370000.0, "env_to_module_connector": {"connector_pipeline_timer": 4.360701862012202e-05, "timers": {"connectors": {"add_observations_from_episodes_to_batch": 2.903452060169796e-06, "add_time_dim_to_batch_and_zero_pad": 2.391434438026692e-06, "batch_individual_items": 6.301530974383838e-06, "numpy_to_tensor": 8.618748078984549e-06, "add_states_from_episodes_to_batch": 1.7306841551156768e-06}}}, "num_episodes": 250.0, "env_step_timer": 1.3648047090794984e-05, "episode_len_min": 20, "num_agent_steps_sampled": {"default_agent": 5000.0}, "agent_episode_returns_mean": {"default_agent": 11.859999999999996}, "episode_return_mean": 11.859999999999996, "num_env_steps_sampled": 5000.0, "module_to_env_connector": {"timers": {"connectors": {"remove_single_ts_time_rank_from_batch": 5.649380106420672e-07, "un_batch_to_individual_items": 5.379228581711483e-06, "listify_data_for_vector_env": 1.1028934271330249e-05, "normalize_and_clip_actions": 9.372555293228286e-06, "get_actions": 3.699159431327392e-05, "tensor_to_numpy": 1.2863976613492798e-05}}, "connector_pipeline_timer": 0.00010150800872415203}, "episode_duration_sec_mean": 0.004487335836514832, "sample": 0.004799632456927057, "num_module_steps_sampled_lifetime": {"default_policy": -7400000.0}, "env_reset_timer": 3.2839700450534775e-05, "time_between_sampling": 0.0016599431661522275, "episode_len_max": 20, "weights_seq_no": 13.0, "num_env_steps_sampled_lifetime": -7400000.0, "env_to_module_sum_episodes_length_in": 10.36823839457432, "episode_len_mean": 20.0, "module_episode_returns_mean": {"default_policy": 11.859999999999996}, "episode_return_min": -5.5, "episode_return_max": 14.5, "num_agent_steps_sampled_lifetime": {"default_agent": -7400000.0}, "rlmodule_inference_timer": 2.7436110786577743e-05, "env_to_module_sum_episodes_length_out": 10.36823839457432, "num_module_steps_sampled": {"default_policy": 5000.0}, "num_env_steps_sampled_lifetime_throughput": 3776.258243970425}, "learners": {"default_policy": {"module_train_batch_size_mean": 1000.0, "vf_explained_var": -0.01017308235168457, "num_module_steps_trained_lifetime": 84000, "entropy": 0.6360170841217041, "curr_kl_coeff": 4.5562519517261535e-05, "vf_loss_unclipped": 40.3286018371582, "diff_num_grad_updates_vs_sampler_policy": 1.0, "default_optimizer_learning_rate": 0.0002847858517, "total_loss": -0.26746711134910583, "mean_kl_loss": 0.0002494497748557478, "vf_loss": 0.1025959849357605, "gradients_default_optimizer_global_norm": 0.03703908249735832, "weights_seq_no": 14.0, "num_module_steps_trained": 6000, "policy_loss": -0.3303236663341522, "curr_entropy_coeff": 0.0090570820258, "num_trainable_parameters": 6003, "num_module_steps_trained_lifetime_throughput": 410584.0887528277}, "__all_modules__": {"num_module_steps_trained": 6000, "num_trainable_parameters": 6003, "learner_connector_sum_episodes_length_in": 5000.0, "num_env_steps_trained": 31500, "learner_connector": {"timers": {"connectors": {"batch_individual_items": 0.035295204588710855, "numpy_to_tensor": 0.00014379109124016364, "add_states_from_episodes_to_batch": 3.559074055530074e-06, "add_observations_from_episodes_to_batch": 0.000807969720087643, "add_columns_from_episodes_to_train_batch": 0.034892475590847676, "add_time_dim_to_batch_and_zero_pad": 1.5714308126599555e-05, "add_one_ts_to_episodes_and_truncate": 0.008788871620869438, "general_advantage_estimation": 0.007713787189524768}}, "connector_pipeline_timer": 0.08783302578137046}, "num_module_steps_trained_lifetime": 84000, "learner_connector_sum_episodes_length_out": 5250.0, "num_env_steps_trained_lifetime": 441000, "num_non_trainable_parameters": 0, "num_env_steps_trained_lifetime_throughput": 2126525.201775134, "num_module_steps_trained_throughput": 407144.3565776091, "num_module_steps_trained_lifetime_throughput": 406188.2557426396}}, "num_training_step_calls_per_iteration": 1, "evaluation": {"env_runners": {"num_env_steps_sampled": 400, "env_to_module_connector": {"timers": {"connectors": {"add_states_from_episodes_to_batch": 1.6324651133896475e-06, "add_observations_from_episodes_to_batch": 2.8641596520034472e-06, "add_time_dim_to_batch_and_zero_pad": 2.33480532201446e-06, "batch_individual_items": 6.0677951830657295e-06, "numpy_to_tensor": 8.285410181925766e-06}}, "connector_pipeline_timer": 4.274683157499625e-05}, "episode_len_max": 20, "num_module_steps_sampled_lifetime": {"default_policy": 5600}, "rlmodule_inference_timer": 2.665422080592755e-05, "env_to_module_sum_episodes_length_out": 10.368238394574323, "module_to_env_connector": {"connector_pipeline_timer": 9.892367534890483e-05, "timers": {"connectors": {"tensor_to_numpy": 1.2708679279219703e-05, "listify_data_for_vector_env": 1.0660276292616937e-05, "get_actions": 3.463812930077042e-05, "normalize_and_clip_actions": 9.330397566861663e-06, "remove_single_ts_time_rank_from_batch": 6.529163713242685e-07, "un_batch_to_individual_items": 5.311637130309698e-06}}}, "episode_len_min": 20, "env_reset_timer": 0.00019592275447286996, "episode_return_max": 15.5, "num_episodes_lifetime": 280, "num_episodes": 20, "episode_return_mean": 0.9, "num_module_steps_sampled": {"default_policy": 400}, "episode_duration_sec_mean": 0.004701218755217269, "sample": 0.10120688792642299, "weights_seq_no": 14.0, "module_episode_returns_mean": {"default_policy": 0.9}, "num_agent_steps_sampled_lifetime": {"default_agent": 5600}, "env_step_timer": 1.3653571569249895e-05, "num_agent_steps_sampled": {"default_agent": 400}, "agent_episode_returns_mean": {"default_agent": 0.9}, "num_env_steps_sampled_lifetime": 70400, "env_to_module_sum_episodes_length_in": 10.368238394574323, "episode_len_mean": 20.0, "episode_return_min": -13.5, "time_between_sampling": 1.6495533953647084}, "num_healthy_workers": 1, "actor_manager_num_outstanding_async_reqs": 0, "num_remote_worker_restarts": 0}, "num_env_steps_sampled_lifetime": -7400000.0, "fault_tolerance": {"num_healthy_workers": 0, "num_remote_worker_restarts": 0}, "env_runner_group": {"actor_manager_num_outstanding_async_reqs": 0}, "done": false, "training_iteration": 14, "trial_id": "4d67b_00000", "date": "2025-08-11_19-22-43", "timestamp": 1754932963, "time_this_iter_s": 1.6465163230895996, "time_total_s": 25.03924560546875, "pid": 14356, "hostname": "Mac", "node_ip": "127.0.0.1", "config": {"exploration_config": {}, "extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "placement_strategy": "PACK", "num_gpus": 0, "_fake_gpus": false, "num_cpus_for_main_process": 2, "eager_tracing": true, "eager_max_retraces": 20, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "torch_compile_learner": false, "torch_compile_learner_what_to_compile": "forward_train", "torch_compile_learner_dynamo_backend": "aot_eager", "torch_compile_learner_dynamo_mode": null, "torch_compile_worker": false, "torch_compile_worker_dynamo_backend": "aot_eager", "torch_compile_worker_dynamo_mode": null, "torch_ddp_kwargs": {}, "torch_skip_nan_gradients": false, "env": "Umbrella", "env_config": {}, "observation_space": null, "action_space": null, "clip_rewards": null, "normalize_actions": true, "clip_actions": false, "_is_atari": null, "disable_env_checking": false, "render_env": false, "action_mask_key": "action_mask", "env_runner_cls": null, "num_env_runners": 0, "create_local_env_runner": true, "num_envs_per_env_runner": 1, "gym_env_vectorize_mode": "SYNC", "num_cpus_per_env_runner": 1, "num_gpus_per_env_runner": 0, "custom_resources_per_env_runner": {}, "validate_env_runners_after_construction": true, "episodes_to_numpy": true, "max_requests_in_flight_per_env_runner": 1, "sample_timeout_s": 60.0, "_env_to_module_connector": null, "add_default_connectors_to_env_to_module_pipeline": true, "_module_to_env_connector": null, "add_default_connectors_to_module_to_env_pipeline": true, "merge_env_runner_states": "training_only", "broadcast_env_runner_states": true, "episode_lookback_horizon": 1, "rollout_fragment_length": "auto", "batch_mode": "complete_episodes", "compress_observations": false, "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "enable_tf1_exec_eagerly": false, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "preprocessor_pref": "deepmind", "observation_filter": "NoFilter", "update_worker_filter_stats": true, "use_worker_filter_stats": true, "sampler_perf_stats_ema_coef": null, "_is_online": true, "num_learners": 0, "num_gpus_per_learner": 0, "num_cpus_per_learner": "auto", "num_aggregator_actors_per_learner": 0, "max_requests_in_flight_per_aggregator_actor": 3, "local_gpu_idx": 0, "max_requests_in_flight_per_learner": 3, "gamma": 1, "lr": 0.0002847858517, "grad_clip": 0.5, "grad_clip_by": "global_norm", "_train_batch_size_per_learner": 5000, "train_batch_size": 4000, "num_epochs": 1, "minibatch_size": 1000, "shuffle_batch_per_epoch": true, "model": {"fcnet_hiddens": [256, 256], "fcnet_activation": "tanh", "fcnet_weights_initializer": null, "fcnet_weights_initializer_config": null, "fcnet_bias_initializer": null, "fcnet_bias_initializer_config": null, "conv_filters": null, "conv_activation": "relu", "conv_kernel_initializer": null, "conv_kernel_initializer_config": null, "conv_bias_initializer": null, "conv_bias_initializer_config": null, "conv_transpose_kernel_initializer": null, "conv_transpose_kernel_initializer_config": null, "conv_transpose_bias_initializer": null, "conv_transpose_bias_initializer_config": null, "post_fcnet_hiddens": [], "post_fcnet_activation": "relu", "post_fcnet_weights_initializer": null, "post_fcnet_weights_initializer_config": null, "post_fcnet_bias_initializer": null, "post_fcnet_bias_initializer_config": null, "free_log_std": false, "log_std_clip_param": 20.0, "no_final_linear": false, "vf_share_layers": false, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "lstm_weights_initializer": null, "lstm_weights_initializer_config": null, "lstm_bias_initializer": null, "lstm_bias_initializer_config": null, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "attention_use_n_prev_actions": 0, "attention_use_n_prev_rewards": 0, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": null, "custom_model_config": {}, "custom_action_dist": null, "custom_preprocessor": null, "encoder_latent_dim": null, "always_check_shapes": false, "lstm_use_prev_action_reward": -1, "_use_default_native_models": -1, "_disable_preprocessor_api": false, "_disable_action_flattening": false}, "_learner_connector": null, "add_default_connectors_to_learner_pipeline": true, "learner_config_dict": {}, "optimizer": {}, "_learner_class": null, "callbacks_on_algorithm_init": null, "callbacks_on_env_runners_recreated": null, "callbacks_on_offline_eval_runners_recreated": null, "callbacks_on_checkpoint_loaded": null, "callbacks_on_environment_created": null, "callbacks_on_episode_created": null, "callbacks_on_episode_start": null, "callbacks_on_episode_step": null, "callbacks_on_episode_end": null, "callbacks_on_evaluate_start": null, "callbacks_on_evaluate_end": null, "callbacks_on_evaluate_offline_start": null, "callbacks_on_evaluate_offline_end": null, "callbacks_on_sample_end": null, "callbacks_on_train_result": null, "explore": true, "enable_rl_module_and_learner": true, "enable_env_runner_and_connector_v2": true, "_prior_exploration_config": {"type": "StochasticSampling"}, "count_steps_by": "env_steps", "policy_map_capacity": 100, "policy_mapping_fn": "<function AlgorithmConfig.DEFAULT_POLICY_MAPPING_FN at 0x385aedb20>", "policies_to_train": null, "policy_states_are_swappable": false, "observation_fn": null, "offline_data_class": null, "input_read_method": "read_parquet", "input_read_method_kwargs": {}, "input_read_schema": {}, "input_read_episodes": false, "input_read_sample_batches": false, "input_read_batch_size": null, "input_filesystem": null, "input_filesystem_kwargs": {}, "input_compress_columns": ["obs", "new_obs"], "input_spaces_jsonable": true, "materialize_data": false, "materialize_mapped_data": true, "map_batches_kwargs": {}, "iter_batches_kwargs": {}, "ignore_final_observation": false, "prelearner_class": null, "prelearner_buffer_class": null, "prelearner_buffer_kwargs": {}, "prelearner_module_synch_period": 10, "dataset_num_iters_per_learner": null, "input_config": {}, "actions_in_input_normalized": false, "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_config": {}, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "output_max_rows_per_file": null, "output_write_remaining_data": false, "output_write_method": "write_parquet", "output_write_method_kwargs": {}, "output_filesystem": null, "output_filesystem_kwargs": {}, "output_write_episodes": true, "offline_sampling": false, "evaluation_interval": 1, "evaluation_duration": 20, "evaluation_duration_unit": "episodes", "evaluation_sample_timeout_s": 120.0, "evaluation_auto_duration_min_env_steps_per_sample": 100, "evaluation_auto_duration_max_env_steps_per_sample": 2000, "evaluation_parallel_to_training": false, "evaluation_force_reset_envs_before_iteration": true, "evaluation_config": null, "off_policy_estimation_methods": {}, "ope_split_batch_by_episode": true, "evaluation_num_env_runners": 1, "in_evaluation": false, "sync_filters_on_rollout_workers_timeout_s": 10.0, "offline_evaluation_interval": null, "num_offline_eval_runners": 0, "offline_loss_for_module_fn": null, "offline_evaluation_duration": 1, "offline_evaluation_parallel_to_training": false, "offline_evaluation_timeout_s": 120.0, "num_cpus_per_offline_eval_runner": 1, "num_gpus_per_offline_eval_runner": 0, "custom_resources_per_offline_eval_runner": {}, "restart_failed_offline_eval_runners": true, "ignore_offline_eval_runner_failures": false, "max_num_offline_eval_runner_restarts": 1000, "offline_eval_runner_restore_timeout_s": 1800.0, "max_requests_in_flight_per_offline_eval_runner": 1, "validate_offline_eval_runners_after_construction": true, "offline_eval_runner_health_probe_timeout_s": 30.0, "offline_eval_rl_module_inference_only": false, "broadcast_offline_eval_runner_states": false, "offline_eval_batch_size_per_runner": 256, "dataset_num_iters_per_eval_runner": 1, "keep_per_episode_custom_metrics": false, "metrics_episode_collection_timeout_s": 60.0, "metrics_num_episodes_for_smoothing": 100, "min_time_s_per_iteration": null, "min_train_timesteps_per_iteration": 0, "min_sample_timesteps_per_iteration": 0, "log_gradients": true, "export_native_model_files": false, "checkpoint_trainable_policies_only": false, "logger_creator": null, "logger_config": null, "log_level": "WARN", "log_sys_usage": true, "fake_sampler": false, "seed": 9, "restart_failed_env_runners": true, "ignore_env_runner_failures": false, "max_num_env_runner_restarts": 1000, "delay_between_env_runner_restarts_s": 60.0, "restart_failed_sub_environments": false, "num_consecutive_env_runner_failures_tolerance": 100, "env_runner_health_probe_timeout_s": 30.0, "env_runner_restore_timeout_s": 1800.0, "_model_config": {}, "_rl_module_spec": "RLModuleSpec(module_class=None, observation_space=None, action_space=None, inference_only=False, learner_only=False, model_config=DefaultModelConfig(fcnet_hiddens=[60, 90], fcnet_activation='tanh', fcnet_kernel_initializer=None, fcnet_kernel_initializer_kwargs=None, fcnet_bias_initializer=None, fcnet_bias_initializer_kwargs=None, conv_filters=None, conv_activation='relu', conv_kernel_initializer=None, conv_kernel_initializer_kwargs=None, conv_bias_initializer=None, conv_bias_initializer_kwargs=None, head_fcnet_hiddens=[], head_fcnet_activation='relu', head_fcnet_kernel_initializer=None, head_fcnet_kernel_initializer_kwargs=None, head_fcnet_bias_initializer=None, head_fcnet_bias_initializer_kwargs=None, free_log_std=False, log_std_clip_param=20.0, vf_share_layers=True, use_lstm=False, max_seq_len=20, lstm_cell_size=256, lstm_use_prev_action=False, lstm_use_prev_reward=False, lstm_kernel_initializer=None, lstm_kernel_initializer_kwargs=None, lstm_bias_initializer=None, lstm_bias_initializer_kwargs=None), catalog_class=None, load_state_path=None, model_config_dict=None)", "algorithm_config_overrides_per_module": {}, "_per_module_overrides": {}, "_validate_config": true, "_use_msgpack_checkpoints": false, "_torch_grad_scaler_class": null, "_torch_lr_scheduler_classes": null, "_tf_policy_handles_more_than_one_loss": false, "_disable_preprocessor_api": false, "_disable_action_flattening": false, "_disable_initialize_loss_from_dummy_batch": false, "_dont_auto_sync_env_runner_states": false, "env_task_fn": -1, "enable_connectors": -1, "simple_optimizer": false, "policy_map_cache": -1, "worker_cls": -1, "synchronize_filters": -1, "enable_async_evaluation": -1, "custom_async_evaluation_function": -1, "_enable_rl_module_api": -1, "auto_wrap_old_gym_envs": -1, "always_attach_evaluation_results": -1, "replay_sequence_length": null, "_disable_execution_plan_api": -1, "use_critic": true, "use_gae": true, "use_kl_loss": true, "kl_coeff": 0.7464963036515, "kl_target": 0.0270990929592, "vf_loss_coeff": 0.6688075857018, "entropy_coeff": 0.0090570820258, "clip_param": 0.1221781641624, "vf_clip_param": 0.1027808522125, "entropy_coeff_schedule": null, "lr_schedule": null, "sgd_minibatch_size": -1, "vf_share_layers": -1, "__stdout_file__": null, "__stderr_file__": null, "lambda": 0.9099046732075, "input": "sampler", "policies": {"default_policy": [null, null, null, null]}, "callbacks": "<class 'ray.rllib.callbacks.callbacks.RLlibCallback'>", "create_env_on_driver": false, "custom_eval_function": null, "framework": "torch"}, "time_since_restore": 25.03924560546875, "iterations_since_restore": 14, "perf": {"cpu_util_percent": 38.7, "ram_util_percent": 79.0}}
{"timers": {"training_iteration": 1.8550657963669017, "restore_env_runners": 1.1366690446681791e-05, "training_step": 1.854894873710375, "env_runner_sampling_timer": 1.7362208820100793, "learner_update_timer": 0.11531137964174373, "synch_weights": 0.0006398036500371598, "restore_eval_env_runners": 9.961292219842486e-06, "evaluation_iteration": 0.11064084720883456, "synch_eval_env_connectors": 0.00014088792277541277, "synch_env_connectors": 4.61118966097667e-06}, "env_runners": {"num_episodes_lifetime": -400875.0, "env_to_module_connector": {"connector_pipeline_timer": 4.665996751487953e-05, "timers": {"connectors": {"add_observations_from_episodes_to_batch": 3.167746155732035e-06, "add_time_dim_to_batch_and_zero_pad": 2.5547835838136462e-06, "batch_individual_items": 7.052432100851907e-06, "numpy_to_tensor": 9.46397795145966e-06, "add_states_from_episodes_to_batch": 1.8184466228107045e-06}}}, "num_episodes": 250.0, "env_step_timer": 1.4994206745614754e-05, "episode_len_min": 20, "num_agent_steps_sampled": {"default_agent": 5000.0}, "agent_episode_returns_mean": {"default_agent": 10.5}, "episode_return_mean": 10.5, "num_env_steps_sampled": 5000.0, "module_to_env_connector": {"timers": {"connectors": {"remove_single_ts_time_rank_from_batch": 6.218806911209228e-07, "un_batch_to_individual_items": 5.8062654708464266e-06, "listify_data_for_vector_env": 1.1938242880005314e-05, "normalize_and_clip_actions": 1.0139323358111796e-05, "get_actions": 4.172342964315485e-05, "tensor_to_numpy": 1.3973405377207201e-05}}, "connector_pipeline_timer": 0.00011142329197862657}, "episode_duration_sec_mean": 0.004887361838947982, "sample": 0.005001496058330745, "num_module_steps_sampled_lifetime": {"default_policy": -8017500.0}, "env_reset_timer": 3.5047615751270534e-05, "time_between_sampling": 0.0018320963315777315, "episode_len_max": 20, "weights_seq_no": 14.0, "num_env_steps_sampled_lifetime": -8017500.0, "env_to_module_sum_episodes_length_in": 10.36823839457432, "episode_len_mean": 20.0, "module_episode_returns_mean": {"default_policy": 10.5}, "episode_return_min": -5.5, "episode_return_max": 14.5, "num_agent_steps_sampled_lifetime": {"default_agent": -8017500.0}, "rlmodule_inference_timer": 2.966483442334127e-05, "env_to_module_sum_episodes_length_out": 10.36823839457432, "num_module_steps_sampled": {"default_policy": 5000.0}, "num_env_steps_sampled_lifetime_throughput": 3580.9722088437775}, "learners": {"default_policy": {"module_train_batch_size_mean": 1000.0, "vf_explained_var": 0.0007898807525634766, "num_module_steps_trained_lifetime": 90000, "entropy": 0.6198380589485168, "curr_kl_coeff": 2.2781259758630767e-05, "vf_loss_unclipped": 38.51253128051758, "diff_num_grad_updates_vs_sampler_policy": 1.0, "default_optimizer_learning_rate": 0.0002847858517, "total_loss": -0.16265712678432465, "mean_kl_loss": 0.00010712061339290813, "vf_loss": 0.10167106240987778, "gradients_default_optimizer_global_norm": 0.04398268088698387, "weights_seq_no": 15.0, "num_module_steps_trained": 6000, "policy_loss": -0.22504158318042755, "curr_entropy_coeff": 0.0090570820258, "num_trainable_parameters": 6003, "num_module_steps_trained_lifetime_throughput": 409085.04357231874}, "__all_modules__": {"num_module_steps_trained": 6000, "num_trainable_parameters": 6003, "learner_connector_sum_episodes_length_in": 5000.0, "num_env_steps_trained": 31500, "learner_connector": {"timers": {"connectors": {"batch_individual_items": 0.036182154202833966, "numpy_to_tensor": 0.00014313027006325506, "add_states_from_episodes_to_batch": 3.5555638852106216e-06, "add_observations_from_episodes_to_batch": 0.000808366272527574, "add_columns_from_episodes_to_train_batch": 0.034906658745318966, "add_time_dim_to_batch_and_zero_pad": 1.5691334867892322e-05, "add_one_ts_to_episodes_and_truncate": 0.008777621234434884, "general_advantage_estimation": 0.007694291397984956}}, "connector_pipeline_timer": 0.08870251761337598}, "num_module_steps_trained_lifetime": 90000, "learner_connector_sum_episodes_length_out": 5250.0, "num_env_steps_trained_lifetime": 472500, "num_non_trainable_parameters": 0, "num_env_steps_trained_lifetime_throughput": 2119996.778401667, "num_module_steps_trained_throughput": 405847.51927934116, "num_module_steps_trained_lifetime_throughput": 404928.39907988405}}, "num_training_step_calls_per_iteration": 1, "evaluation": {"env_runners": {"num_env_steps_sampled": 400, "env_to_module_connector": {"timers": {"connectors": {"add_states_from_episodes_to_batch": 1.8053552592057425e-06, "add_observations_from_episodes_to_batch": 3.012728142711349e-06, "add_time_dim_to_batch_and_zero_pad": 2.5178702249663787e-06, "batch_individual_items": 7.578533789381344e-06, "numpy_to_tensor": 9.661104764701286e-06}}, "connector_pipeline_timer": 4.686203159880282e-05}, "episode_len_max": 20, "num_module_steps_sampled_lifetime": {"default_policy": 6000}, "rlmodule_inference_timer": 2.9915406861686215e-05, "env_to_module_sum_episodes_length_out": 10.368238394574323, "module_to_env_connector": {"connector_pipeline_timer": 0.00010871139397146148, "timers": {"connectors": {"tensor_to_numpy": 1.3743495630028845e-05, "listify_data_for_vector_env": 1.159659218671201e-05, "get_actions": 3.97190164909834e-05, "normalize_and_clip_actions": 1.0378131240982547e-05, "remove_single_ts_time_rank_from_batch": 6.732375416538014e-07, "un_batch_to_individual_items": 5.663459229492448e-06}}}, "episode_len_min": 20, "env_reset_timer": 0.0001948964467209722, "episode_return_max": 15.5, "num_episodes_lifetime": 300, "num_episodes": 20, "episode_return_mean": 1.5, "num_module_steps_sampled": {"default_policy": 400}, "episode_duration_sec_mean": 0.004595491673098877, "sample": 0.10132194154690595, "weights_seq_no": 15.0, "module_episode_returns_mean": {"default_policy": 1.5}, "num_agent_steps_sampled_lifetime": {"default_agent": 6000}, "env_step_timer": 1.5067636591157102e-05, "num_agent_steps_sampled": {"default_agent": 400}, "agent_episode_returns_mean": {"default_agent": 1.5}, "num_env_steps_sampled_lifetime": 75400, "env_to_module_sum_episodes_length_in": 10.368238394574323, "episode_len_mean": 20.0, "episode_return_min": -13.5, "time_between_sampling": 1.6500328589117175}, "num_healthy_workers": 1, "actor_manager_num_outstanding_async_reqs": 0, "num_remote_worker_restarts": 0}, "num_env_steps_sampled_lifetime": -8017500.0, "fault_tolerance": {"num_healthy_workers": 0, "num_remote_worker_restarts": 0}, "env_runner_group": {"actor_manager_num_outstanding_async_reqs": 0}, "done": false, "training_iteration": 15, "trial_id": "4d67b_00000", "date": "2025-08-11_19-22-44", "timestamp": 1754932964, "time_this_iter_s": 1.8008370399475098, "time_total_s": 26.84008264541626, "pid": 14356, "hostname": "Mac", "node_ip": "127.0.0.1", "config": {"exploration_config": {}, "extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "placement_strategy": "PACK", "num_gpus": 0, "_fake_gpus": false, "num_cpus_for_main_process": 2, "eager_tracing": true, "eager_max_retraces": 20, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "torch_compile_learner": false, "torch_compile_learner_what_to_compile": "forward_train", "torch_compile_learner_dynamo_backend": "aot_eager", "torch_compile_learner_dynamo_mode": null, "torch_compile_worker": false, "torch_compile_worker_dynamo_backend": "aot_eager", "torch_compile_worker_dynamo_mode": null, "torch_ddp_kwargs": {}, "torch_skip_nan_gradients": false, "env": "Umbrella", "env_config": {}, "observation_space": null, "action_space": null, "clip_rewards": null, "normalize_actions": true, "clip_actions": false, "_is_atari": null, "disable_env_checking": false, "render_env": false, "action_mask_key": "action_mask", "env_runner_cls": null, "num_env_runners": 0, "create_local_env_runner": true, "num_envs_per_env_runner": 1, "gym_env_vectorize_mode": "SYNC", "num_cpus_per_env_runner": 1, "num_gpus_per_env_runner": 0, "custom_resources_per_env_runner": {}, "validate_env_runners_after_construction": true, "episodes_to_numpy": true, "max_requests_in_flight_per_env_runner": 1, "sample_timeout_s": 60.0, "_env_to_module_connector": null, "add_default_connectors_to_env_to_module_pipeline": true, "_module_to_env_connector": null, "add_default_connectors_to_module_to_env_pipeline": true, "merge_env_runner_states": "training_only", "broadcast_env_runner_states": true, "episode_lookback_horizon": 1, "rollout_fragment_length": "auto", "batch_mode": "complete_episodes", "compress_observations": false, "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "enable_tf1_exec_eagerly": false, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "preprocessor_pref": "deepmind", "observation_filter": "NoFilter", "update_worker_filter_stats": true, "use_worker_filter_stats": true, "sampler_perf_stats_ema_coef": null, "_is_online": true, "num_learners": 0, "num_gpus_per_learner": 0, "num_cpus_per_learner": "auto", "num_aggregator_actors_per_learner": 0, "max_requests_in_flight_per_aggregator_actor": 3, "local_gpu_idx": 0, "max_requests_in_flight_per_learner": 3, "gamma": 1, "lr": 0.0002847858517, "grad_clip": 0.5, "grad_clip_by": "global_norm", "_train_batch_size_per_learner": 5000, "train_batch_size": 4000, "num_epochs": 1, "minibatch_size": 1000, "shuffle_batch_per_epoch": true, "model": {"fcnet_hiddens": [256, 256], "fcnet_activation": "tanh", "fcnet_weights_initializer": null, "fcnet_weights_initializer_config": null, "fcnet_bias_initializer": null, "fcnet_bias_initializer_config": null, "conv_filters": null, "conv_activation": "relu", "conv_kernel_initializer": null, "conv_kernel_initializer_config": null, "conv_bias_initializer": null, "conv_bias_initializer_config": null, "conv_transpose_kernel_initializer": null, "conv_transpose_kernel_initializer_config": null, "conv_transpose_bias_initializer": null, "conv_transpose_bias_initializer_config": null, "post_fcnet_hiddens": [], "post_fcnet_activation": "relu", "post_fcnet_weights_initializer": null, "post_fcnet_weights_initializer_config": null, "post_fcnet_bias_initializer": null, "post_fcnet_bias_initializer_config": null, "free_log_std": false, "log_std_clip_param": 20.0, "no_final_linear": false, "vf_share_layers": false, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "lstm_weights_initializer": null, "lstm_weights_initializer_config": null, "lstm_bias_initializer": null, "lstm_bias_initializer_config": null, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "attention_use_n_prev_actions": 0, "attention_use_n_prev_rewards": 0, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": null, "custom_model_config": {}, "custom_action_dist": null, "custom_preprocessor": null, "encoder_latent_dim": null, "always_check_shapes": false, "lstm_use_prev_action_reward": -1, "_use_default_native_models": -1, "_disable_preprocessor_api": false, "_disable_action_flattening": false}, "_learner_connector": null, "add_default_connectors_to_learner_pipeline": true, "learner_config_dict": {}, "optimizer": {}, "_learner_class": null, "callbacks_on_algorithm_init": null, "callbacks_on_env_runners_recreated": null, "callbacks_on_offline_eval_runners_recreated": null, "callbacks_on_checkpoint_loaded": null, "callbacks_on_environment_created": null, "callbacks_on_episode_created": null, "callbacks_on_episode_start": null, "callbacks_on_episode_step": null, "callbacks_on_episode_end": null, "callbacks_on_evaluate_start": null, "callbacks_on_evaluate_end": null, "callbacks_on_evaluate_offline_start": null, "callbacks_on_evaluate_offline_end": null, "callbacks_on_sample_end": null, "callbacks_on_train_result": null, "explore": true, "enable_rl_module_and_learner": true, "enable_env_runner_and_connector_v2": true, "_prior_exploration_config": {"type": "StochasticSampling"}, "count_steps_by": "env_steps", "policy_map_capacity": 100, "policy_mapping_fn": "<function AlgorithmConfig.DEFAULT_POLICY_MAPPING_FN at 0x385aedb20>", "policies_to_train": null, "policy_states_are_swappable": false, "observation_fn": null, "offline_data_class": null, "input_read_method": "read_parquet", "input_read_method_kwargs": {}, "input_read_schema": {}, "input_read_episodes": false, "input_read_sample_batches": false, "input_read_batch_size": null, "input_filesystem": null, "input_filesystem_kwargs": {}, "input_compress_columns": ["obs", "new_obs"], "input_spaces_jsonable": true, "materialize_data": false, "materialize_mapped_data": true, "map_batches_kwargs": {}, "iter_batches_kwargs": {}, "ignore_final_observation": false, "prelearner_class": null, "prelearner_buffer_class": null, "prelearner_buffer_kwargs": {}, "prelearner_module_synch_period": 10, "dataset_num_iters_per_learner": null, "input_config": {}, "actions_in_input_normalized": false, "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_config": {}, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "output_max_rows_per_file": null, "output_write_remaining_data": false, "output_write_method": "write_parquet", "output_write_method_kwargs": {}, "output_filesystem": null, "output_filesystem_kwargs": {}, "output_write_episodes": true, "offline_sampling": false, "evaluation_interval": 1, "evaluation_duration": 20, "evaluation_duration_unit": "episodes", "evaluation_sample_timeout_s": 120.0, "evaluation_auto_duration_min_env_steps_per_sample": 100, "evaluation_auto_duration_max_env_steps_per_sample": 2000, "evaluation_parallel_to_training": false, "evaluation_force_reset_envs_before_iteration": true, "evaluation_config": null, "off_policy_estimation_methods": {}, "ope_split_batch_by_episode": true, "evaluation_num_env_runners": 1, "in_evaluation": false, "sync_filters_on_rollout_workers_timeout_s": 10.0, "offline_evaluation_interval": null, "num_offline_eval_runners": 0, "offline_loss_for_module_fn": null, "offline_evaluation_duration": 1, "offline_evaluation_parallel_to_training": false, "offline_evaluation_timeout_s": 120.0, "num_cpus_per_offline_eval_runner": 1, "num_gpus_per_offline_eval_runner": 0, "custom_resources_per_offline_eval_runner": {}, "restart_failed_offline_eval_runners": true, "ignore_offline_eval_runner_failures": false, "max_num_offline_eval_runner_restarts": 1000, "offline_eval_runner_restore_timeout_s": 1800.0, "max_requests_in_flight_per_offline_eval_runner": 1, "validate_offline_eval_runners_after_construction": true, "offline_eval_runner_health_probe_timeout_s": 30.0, "offline_eval_rl_module_inference_only": false, "broadcast_offline_eval_runner_states": false, "offline_eval_batch_size_per_runner": 256, "dataset_num_iters_per_eval_runner": 1, "keep_per_episode_custom_metrics": false, "metrics_episode_collection_timeout_s": 60.0, "metrics_num_episodes_for_smoothing": 100, "min_time_s_per_iteration": null, "min_train_timesteps_per_iteration": 0, "min_sample_timesteps_per_iteration": 0, "log_gradients": true, "export_native_model_files": false, "checkpoint_trainable_policies_only": false, "logger_creator": null, "logger_config": null, "log_level": "WARN", "log_sys_usage": true, "fake_sampler": false, "seed": 9, "restart_failed_env_runners": true, "ignore_env_runner_failures": false, "max_num_env_runner_restarts": 1000, "delay_between_env_runner_restarts_s": 60.0, "restart_failed_sub_environments": false, "num_consecutive_env_runner_failures_tolerance": 100, "env_runner_health_probe_timeout_s": 30.0, "env_runner_restore_timeout_s": 1800.0, "_model_config": {}, "_rl_module_spec": "RLModuleSpec(module_class=None, observation_space=None, action_space=None, inference_only=False, learner_only=False, model_config=DefaultModelConfig(fcnet_hiddens=[60, 90], fcnet_activation='tanh', fcnet_kernel_initializer=None, fcnet_kernel_initializer_kwargs=None, fcnet_bias_initializer=None, fcnet_bias_initializer_kwargs=None, conv_filters=None, conv_activation='relu', conv_kernel_initializer=None, conv_kernel_initializer_kwargs=None, conv_bias_initializer=None, conv_bias_initializer_kwargs=None, head_fcnet_hiddens=[], head_fcnet_activation='relu', head_fcnet_kernel_initializer=None, head_fcnet_kernel_initializer_kwargs=None, head_fcnet_bias_initializer=None, head_fcnet_bias_initializer_kwargs=None, free_log_std=False, log_std_clip_param=20.0, vf_share_layers=True, use_lstm=False, max_seq_len=20, lstm_cell_size=256, lstm_use_prev_action=False, lstm_use_prev_reward=False, lstm_kernel_initializer=None, lstm_kernel_initializer_kwargs=None, lstm_bias_initializer=None, lstm_bias_initializer_kwargs=None), catalog_class=None, load_state_path=None, model_config_dict=None)", "algorithm_config_overrides_per_module": {}, "_per_module_overrides": {}, "_validate_config": true, "_use_msgpack_checkpoints": false, "_torch_grad_scaler_class": null, "_torch_lr_scheduler_classes": null, "_tf_policy_handles_more_than_one_loss": false, "_disable_preprocessor_api": false, "_disable_action_flattening": false, "_disable_initialize_loss_from_dummy_batch": false, "_dont_auto_sync_env_runner_states": false, "env_task_fn": -1, "enable_connectors": -1, "simple_optimizer": false, "policy_map_cache": -1, "worker_cls": -1, "synchronize_filters": -1, "enable_async_evaluation": -1, "custom_async_evaluation_function": -1, "_enable_rl_module_api": -1, "auto_wrap_old_gym_envs": -1, "always_attach_evaluation_results": -1, "replay_sequence_length": null, "_disable_execution_plan_api": -1, "use_critic": true, "use_gae": true, "use_kl_loss": true, "kl_coeff": 0.7464963036515, "kl_target": 0.0270990929592, "vf_loss_coeff": 0.6688075857018, "entropy_coeff": 0.0090570820258, "clip_param": 0.1221781641624, "vf_clip_param": 0.1027808522125, "entropy_coeff_schedule": null, "lr_schedule": null, "sgd_minibatch_size": -1, "vf_share_layers": -1, "__stdout_file__": null, "__stderr_file__": null, "lambda": 0.9099046732075, "input": "sampler", "policies": {"default_policy": [null, null, null, null]}, "callbacks": "<class 'ray.rllib.callbacks.callbacks.RLlibCallback'>", "create_env_on_driver": false, "custom_eval_function": null, "framework": "torch"}, "time_since_restore": 26.84008264541626, "iterations_since_restore": 15, "perf": {"cpu_util_percent": 43.20000000000001, "ram_util_percent": 79.0}}
{"timers": {"training_iteration": 1.8524210259029172, "restore_env_runners": 1.1329693509016974e-05, "training_step": 1.8522500078922766, "env_runner_sampling_timer": 1.733810252779375, "learner_update_timer": 0.115077371254738, "synch_weights": 0.0006404435344141257, "restore_eval_env_runners": 9.98417964834289e-06, "evaluation_iteration": 0.1107227641565354, "synch_eval_env_connectors": 0.00014071988419502826, "synch_env_connectors": 4.625078221236506e-06}, "env_runners": {"num_episodes_lifetime": -431750.0, "env_to_module_connector": {"connector_pipeline_timer": 4.766694184176942e-05, "timers": {"connectors": {"add_observations_from_episodes_to_batch": 3.1247830299576405e-06, "add_time_dim_to_batch_and_zero_pad": 3.0058391881581287e-06, "batch_individual_items": 6.885260264677487e-06, "numpy_to_tensor": 1.0191236835688993e-05, "add_states_from_episodes_to_batch": 1.805402767211042e-06}}}, "num_episodes": 250.0, "env_step_timer": 1.4923985427679407e-05, "episode_len_min": 20, "num_agent_steps_sampled": {"default_agent": 5000.0}, "agent_episode_returns_mean": {"default_agent": 11.700000000000003}, "episode_return_mean": 11.700000000000003, "num_env_steps_sampled": 5000.0, "module_to_env_connector": {"timers": {"connectors": {"remove_single_ts_time_rank_from_batch": 6.343461253134192e-07, "un_batch_to_individual_items": 5.7400488094081915e-06, "listify_data_for_vector_env": 1.2316195737626823e-05, "normalize_and_clip_actions": 1.0103605286045035e-05, "get_actions": 4.199315099192831e-05, "tensor_to_numpy": 1.403351307457198e-05}}, "connector_pipeline_timer": 0.00011216576733972657}, "episode_duration_sec_mean": 0.004946325357537716, "sample": 0.005406804198723627, "num_module_steps_sampled_lifetime": {"default_policy": -8635000.0}, "env_reset_timer": 4.230370097762046e-05, "time_between_sampling": 0.0020190895580395507, "episode_len_max": 20, "weights_seq_no": 15.0, "num_env_steps_sampled_lifetime": -8635000.0, "env_to_module_sum_episodes_length_in": 10.36823839457432, "episode_len_mean": 20.0, "module_episode_returns_mean": {"default_policy": 11.700000000000003}, "episode_return_min": -5.5, "episode_return_max": 14.5, "num_agent_steps_sampled_lifetime": {"default_agent": -8635000.0}, "rlmodule_inference_timer": 3.0339578470472372e-05, "env_to_module_sum_episodes_length_out": 10.36823839457432, "num_module_steps_sampled": {"default_policy": 5000.0}, "num_env_steps_sampled_lifetime_throughput": 3536.2702143632237}, "learners": {"default_policy": {"module_train_batch_size_mean": 1000.0, "vf_explained_var": 0.003667175769805908, "num_module_steps_trained_lifetime": 96000, "entropy": 0.6082354187965393, "curr_kl_coeff": 1.1390629879315384e-05, "vf_loss_unclipped": 37.72899627685547, "diff_num_grad_updates_vs_sampler_policy": 1.0, "default_optimizer_learning_rate": 0.0002847858517, "total_loss": 0.07125132530927658, "mean_kl_loss": 0.0001255715760635212, "vf_loss": 0.10140769928693771, "gradients_default_optimizer_global_norm": 0.12816815078258514, "weights_seq_no": 16.0, "num_module_steps_trained": 6000, "policy_loss": 0.00893791951239109, "curr_entropy_coeff": 0.0090570820258, "num_trainable_parameters": 6003, "num_module_steps_trained_lifetime_throughput": 408635.91384084144}, "__all_modules__": {"num_module_steps_trained": 6000, "num_trainable_parameters": 6003, "learner_connector_sum_episodes_length_in": 5000.0, "num_env_steps_trained": 31500, "learner_connector": {"timers": {"connectors": {"batch_individual_items": 0.03612007849034873, "numpy_to_tensor": 0.00014227354798918476, "add_states_from_episodes_to_batch": 3.5491784335486904e-06, "add_observations_from_episodes_to_batch": 0.0008084609398288652, "add_columns_from_episodes_to_train_batch": 0.03489394215786354, "add_time_dim_to_batch_and_zero_pad": 1.5798170908191283e-05, "add_one_ts_to_episodes_and_truncate": 0.008768797941083845, "general_advantage_estimation": 0.007671054313200786}}, "connector_pipeline_timer": 0.08859416118708688}, "num_module_steps_trained_lifetime": 96000, "learner_connector_sum_episodes_length_out": 5250.0, "num_env_steps_trained_lifetime": 504000, "num_non_trainable_parameters": 0, "num_env_steps_trained_lifetime_throughput": 2118955.3296036287, "num_module_steps_trained_throughput": 405589.34003113356, "num_module_steps_trained_lifetime_throughput": 404705.37975597853}}, "num_training_step_calls_per_iteration": 1, "evaluation": {"env_runners": {"num_env_steps_sampled": 400, "env_to_module_connector": {"timers": {"connectors": {"add_states_from_episodes_to_batch": 1.612800548993913e-06, "add_observations_from_episodes_to_batch": 2.796347274017277e-06, "add_time_dim_to_batch_and_zero_pad": 2.3421362148611312e-06, "batch_individual_items": 6.126857754298341e-06, "numpy_to_tensor": 8.374593996102515e-06}}, "connector_pipeline_timer": 4.274720779715862e-05}, "episode_len_max": 20, "num_module_steps_sampled_lifetime": {"default_policy": 6400}, "rlmodule_inference_timer": 2.7009665418516104e-05, "env_to_module_sum_episodes_length_out": 10.368238394574323, "module_to_env_connector": {"connector_pipeline_timer": 9.937957190491912e-05, "timers": {"connectors": {"tensor_to_numpy": 1.2726198921577054e-05, "listify_data_for_vector_env": 1.0750557694985545e-05, "get_actions": 3.493618101373188e-05, "normalize_and_clip_actions": 9.4338898801566e-06, "remove_single_ts_time_rank_from_batch": 6.464827815101472e-07, "un_batch_to_individual_items": 5.334299066147537e-06}}}, "episode_len_min": 20, "env_reset_timer": 0.0001950254026161158, "episode_return_max": 15.5, "num_episodes_lifetime": 320, "num_episodes": 20, "episode_return_mean": 1.1, "num_module_steps_sampled": {"default_policy": 400}, "episode_duration_sec_mean": 0.004606567502487451, "sample": 0.10129193713145164, "weights_seq_no": 16.0, "module_episode_returns_mean": {"default_policy": 1.1}, "num_agent_steps_sampled_lifetime": {"default_agent": 6400}, "env_step_timer": 1.3707327489952802e-05, "num_agent_steps_sampled": {"default_agent": 400}, "agent_episode_returns_mean": {"default_agent": 1.1}, "num_env_steps_sampled_lifetime": 80400, "env_to_module_sum_episodes_length_in": 10.368238394574323, "episode_len_mean": 20.0, "episode_return_min": -13.5, "time_between_sampling": 1.6496292353229822}, "num_healthy_workers": 1, "actor_manager_num_outstanding_async_reqs": 0, "num_remote_worker_restarts": 0}, "num_env_steps_sampled_lifetime": -8635000.0, "fault_tolerance": {"num_healthy_workers": 0, "num_remote_worker_restarts": 0}, "env_runner_group": {"actor_manager_num_outstanding_async_reqs": 0}, "done": false, "training_iteration": 16, "trial_id": "4d67b_00000", "date": "2025-08-11_19-22-46", "timestamp": 1754932966, "time_this_iter_s": 1.6975228786468506, "time_total_s": 28.53760552406311, "pid": 14356, "hostname": "Mac", "node_ip": "127.0.0.1", "config": {"exploration_config": {}, "extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "placement_strategy": "PACK", "num_gpus": 0, "_fake_gpus": false, "num_cpus_for_main_process": 2, "eager_tracing": true, "eager_max_retraces": 20, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "torch_compile_learner": false, "torch_compile_learner_what_to_compile": "forward_train", "torch_compile_learner_dynamo_backend": "aot_eager", "torch_compile_learner_dynamo_mode": null, "torch_compile_worker": false, "torch_compile_worker_dynamo_backend": "aot_eager", "torch_compile_worker_dynamo_mode": null, "torch_ddp_kwargs": {}, "torch_skip_nan_gradients": false, "env": "Umbrella", "env_config": {}, "observation_space": null, "action_space": null, "clip_rewards": null, "normalize_actions": true, "clip_actions": false, "_is_atari": null, "disable_env_checking": false, "render_env": false, "action_mask_key": "action_mask", "env_runner_cls": null, "num_env_runners": 0, "create_local_env_runner": true, "num_envs_per_env_runner": 1, "gym_env_vectorize_mode": "SYNC", "num_cpus_per_env_runner": 1, "num_gpus_per_env_runner": 0, "custom_resources_per_env_runner": {}, "validate_env_runners_after_construction": true, "episodes_to_numpy": true, "max_requests_in_flight_per_env_runner": 1, "sample_timeout_s": 60.0, "_env_to_module_connector": null, "add_default_connectors_to_env_to_module_pipeline": true, "_module_to_env_connector": null, "add_default_connectors_to_module_to_env_pipeline": true, "merge_env_runner_states": "training_only", "broadcast_env_runner_states": true, "episode_lookback_horizon": 1, "rollout_fragment_length": "auto", "batch_mode": "complete_episodes", "compress_observations": false, "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "enable_tf1_exec_eagerly": false, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "preprocessor_pref": "deepmind", "observation_filter": "NoFilter", "update_worker_filter_stats": true, "use_worker_filter_stats": true, "sampler_perf_stats_ema_coef": null, "_is_online": true, "num_learners": 0, "num_gpus_per_learner": 0, "num_cpus_per_learner": "auto", "num_aggregator_actors_per_learner": 0, "max_requests_in_flight_per_aggregator_actor": 3, "local_gpu_idx": 0, "max_requests_in_flight_per_learner": 3, "gamma": 1, "lr": 0.0002847858517, "grad_clip": 0.5, "grad_clip_by": "global_norm", "_train_batch_size_per_learner": 5000, "train_batch_size": 4000, "num_epochs": 1, "minibatch_size": 1000, "shuffle_batch_per_epoch": true, "model": {"fcnet_hiddens": [256, 256], "fcnet_activation": "tanh", "fcnet_weights_initializer": null, "fcnet_weights_initializer_config": null, "fcnet_bias_initializer": null, "fcnet_bias_initializer_config": null, "conv_filters": null, "conv_activation": "relu", "conv_kernel_initializer": null, "conv_kernel_initializer_config": null, "conv_bias_initializer": null, "conv_bias_initializer_config": null, "conv_transpose_kernel_initializer": null, "conv_transpose_kernel_initializer_config": null, "conv_transpose_bias_initializer": null, "conv_transpose_bias_initializer_config": null, "post_fcnet_hiddens": [], "post_fcnet_activation": "relu", "post_fcnet_weights_initializer": null, "post_fcnet_weights_initializer_config": null, "post_fcnet_bias_initializer": null, "post_fcnet_bias_initializer_config": null, "free_log_std": false, "log_std_clip_param": 20.0, "no_final_linear": false, "vf_share_layers": false, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "lstm_weights_initializer": null, "lstm_weights_initializer_config": null, "lstm_bias_initializer": null, "lstm_bias_initializer_config": null, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "attention_use_n_prev_actions": 0, "attention_use_n_prev_rewards": 0, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": null, "custom_model_config": {}, "custom_action_dist": null, "custom_preprocessor": null, "encoder_latent_dim": null, "always_check_shapes": false, "lstm_use_prev_action_reward": -1, "_use_default_native_models": -1, "_disable_preprocessor_api": false, "_disable_action_flattening": false}, "_learner_connector": null, "add_default_connectors_to_learner_pipeline": true, "learner_config_dict": {}, "optimizer": {}, "_learner_class": null, "callbacks_on_algorithm_init": null, "callbacks_on_env_runners_recreated": null, "callbacks_on_offline_eval_runners_recreated": null, "callbacks_on_checkpoint_loaded": null, "callbacks_on_environment_created": null, "callbacks_on_episode_created": null, "callbacks_on_episode_start": null, "callbacks_on_episode_step": null, "callbacks_on_episode_end": null, "callbacks_on_evaluate_start": null, "callbacks_on_evaluate_end": null, "callbacks_on_evaluate_offline_start": null, "callbacks_on_evaluate_offline_end": null, "callbacks_on_sample_end": null, "callbacks_on_train_result": null, "explore": true, "enable_rl_module_and_learner": true, "enable_env_runner_and_connector_v2": true, "_prior_exploration_config": {"type": "StochasticSampling"}, "count_steps_by": "env_steps", "policy_map_capacity": 100, "policy_mapping_fn": "<function AlgorithmConfig.DEFAULT_POLICY_MAPPING_FN at 0x385aedb20>", "policies_to_train": null, "policy_states_are_swappable": false, "observation_fn": null, "offline_data_class": null, "input_read_method": "read_parquet", "input_read_method_kwargs": {}, "input_read_schema": {}, "input_read_episodes": false, "input_read_sample_batches": false, "input_read_batch_size": null, "input_filesystem": null, "input_filesystem_kwargs": {}, "input_compress_columns": ["obs", "new_obs"], "input_spaces_jsonable": true, "materialize_data": false, "materialize_mapped_data": true, "map_batches_kwargs": {}, "iter_batches_kwargs": {}, "ignore_final_observation": false, "prelearner_class": null, "prelearner_buffer_class": null, "prelearner_buffer_kwargs": {}, "prelearner_module_synch_period": 10, "dataset_num_iters_per_learner": null, "input_config": {}, "actions_in_input_normalized": false, "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_config": {}, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "output_max_rows_per_file": null, "output_write_remaining_data": false, "output_write_method": "write_parquet", "output_write_method_kwargs": {}, "output_filesystem": null, "output_filesystem_kwargs": {}, "output_write_episodes": true, "offline_sampling": false, "evaluation_interval": 1, "evaluation_duration": 20, "evaluation_duration_unit": "episodes", "evaluation_sample_timeout_s": 120.0, "evaluation_auto_duration_min_env_steps_per_sample": 100, "evaluation_auto_duration_max_env_steps_per_sample": 2000, "evaluation_parallel_to_training": false, "evaluation_force_reset_envs_before_iteration": true, "evaluation_config": null, "off_policy_estimation_methods": {}, "ope_split_batch_by_episode": true, "evaluation_num_env_runners": 1, "in_evaluation": false, "sync_filters_on_rollout_workers_timeout_s": 10.0, "offline_evaluation_interval": null, "num_offline_eval_runners": 0, "offline_loss_for_module_fn": null, "offline_evaluation_duration": 1, "offline_evaluation_parallel_to_training": false, "offline_evaluation_timeout_s": 120.0, "num_cpus_per_offline_eval_runner": 1, "num_gpus_per_offline_eval_runner": 0, "custom_resources_per_offline_eval_runner": {}, "restart_failed_offline_eval_runners": true, "ignore_offline_eval_runner_failures": false, "max_num_offline_eval_runner_restarts": 1000, "offline_eval_runner_restore_timeout_s": 1800.0, "max_requests_in_flight_per_offline_eval_runner": 1, "validate_offline_eval_runners_after_construction": true, "offline_eval_runner_health_probe_timeout_s": 30.0, "offline_eval_rl_module_inference_only": false, "broadcast_offline_eval_runner_states": false, "offline_eval_batch_size_per_runner": 256, "dataset_num_iters_per_eval_runner": 1, "keep_per_episode_custom_metrics": false, "metrics_episode_collection_timeout_s": 60.0, "metrics_num_episodes_for_smoothing": 100, "min_time_s_per_iteration": null, "min_train_timesteps_per_iteration": 0, "min_sample_timesteps_per_iteration": 0, "log_gradients": true, "export_native_model_files": false, "checkpoint_trainable_policies_only": false, "logger_creator": null, "logger_config": null, "log_level": "WARN", "log_sys_usage": true, "fake_sampler": false, "seed": 9, "restart_failed_env_runners": true, "ignore_env_runner_failures": false, "max_num_env_runner_restarts": 1000, "delay_between_env_runner_restarts_s": 60.0, "restart_failed_sub_environments": false, "num_consecutive_env_runner_failures_tolerance": 100, "env_runner_health_probe_timeout_s": 30.0, "env_runner_restore_timeout_s": 1800.0, "_model_config": {}, "_rl_module_spec": "RLModuleSpec(module_class=None, observation_space=None, action_space=None, inference_only=False, learner_only=False, model_config=DefaultModelConfig(fcnet_hiddens=[60, 90], fcnet_activation='tanh', fcnet_kernel_initializer=None, fcnet_kernel_initializer_kwargs=None, fcnet_bias_initializer=None, fcnet_bias_initializer_kwargs=None, conv_filters=None, conv_activation='relu', conv_kernel_initializer=None, conv_kernel_initializer_kwargs=None, conv_bias_initializer=None, conv_bias_initializer_kwargs=None, head_fcnet_hiddens=[], head_fcnet_activation='relu', head_fcnet_kernel_initializer=None, head_fcnet_kernel_initializer_kwargs=None, head_fcnet_bias_initializer=None, head_fcnet_bias_initializer_kwargs=None, free_log_std=False, log_std_clip_param=20.0, vf_share_layers=True, use_lstm=False, max_seq_len=20, lstm_cell_size=256, lstm_use_prev_action=False, lstm_use_prev_reward=False, lstm_kernel_initializer=None, lstm_kernel_initializer_kwargs=None, lstm_bias_initializer=None, lstm_bias_initializer_kwargs=None), catalog_class=None, load_state_path=None, model_config_dict=None)", "algorithm_config_overrides_per_module": {}, "_per_module_overrides": {}, "_validate_config": true, "_use_msgpack_checkpoints": false, "_torch_grad_scaler_class": null, "_torch_lr_scheduler_classes": null, "_tf_policy_handles_more_than_one_loss": false, "_disable_preprocessor_api": false, "_disable_action_flattening": false, "_disable_initialize_loss_from_dummy_batch": false, "_dont_auto_sync_env_runner_states": false, "env_task_fn": -1, "enable_connectors": -1, "simple_optimizer": false, "policy_map_cache": -1, "worker_cls": -1, "synchronize_filters": -1, "enable_async_evaluation": -1, "custom_async_evaluation_function": -1, "_enable_rl_module_api": -1, "auto_wrap_old_gym_envs": -1, "always_attach_evaluation_results": -1, "replay_sequence_length": null, "_disable_execution_plan_api": -1, "use_critic": true, "use_gae": true, "use_kl_loss": true, "kl_coeff": 0.7464963036515, "kl_target": 0.0270990929592, "vf_loss_coeff": 0.6688075857018, "entropy_coeff": 0.0090570820258, "clip_param": 0.1221781641624, "vf_clip_param": 0.1027808522125, "entropy_coeff_schedule": null, "lr_schedule": null, "sgd_minibatch_size": -1, "vf_share_layers": -1, "__stdout_file__": null, "__stderr_file__": null, "lambda": 0.9099046732075, "input": "sampler", "policies": {"default_policy": [null, null, null, null]}, "callbacks": "<class 'ray.rllib.callbacks.callbacks.RLlibCallback'>", "create_env_on_driver": false, "custom_eval_function": null, "framework": "torch"}, "time_since_restore": 28.53760552406311, "iterations_since_restore": 16, "perf": {"cpu_util_percent": 50.95, "ram_util_percent": 81.2}}
{"timers": {"training_iteration": 1.851015248143589, "restore_env_runners": 1.127764616719961e-05, "training_step": 1.8508442182324218, "env_runner_sampling_timer": 1.7326460423309682, "learner_update_timer": 0.11483713254175679, "synch_weights": 0.0006393686891279386, "restore_eval_env_runners": 1.0073087833903562e-05, "evaluation_iteration": 0.11066071360495178, "synch_eval_env_connectors": 0.0001402489357882664, "synch_env_connectors": 4.619248002915671e-06}, "env_runners": {"num_episodes_lifetime": -462625.0, "env_to_module_connector": {"connector_pipeline_timer": 4.658487372681994e-05, "timers": {"connectors": {"add_observations_from_episodes_to_batch": 3.186224029818752e-06, "add_time_dim_to_batch_and_zero_pad": 2.5514332818236313e-06, "batch_individual_items": 6.826394599380621e-06, "numpy_to_tensor": 9.422886379716553e-06, "add_states_from_episodes_to_batch": 1.8453519322251156e-06}}}, "num_episodes": 250.0, "env_step_timer": 1.5033048561233337e-05, "episode_len_min": 20, "num_agent_steps_sampled": {"default_agent": 5000.0}, "agent_episode_returns_mean": {"default_agent": 11.380000000000003}, "episode_return_mean": 11.380000000000003, "num_env_steps_sampled": 5000.0, "module_to_env_connector": {"timers": {"connectors": {"remove_single_ts_time_rank_from_batch": 6.233270291369783e-07, "un_batch_to_individual_items": 5.8233425354182975e-06, "listify_data_for_vector_env": 1.189557469462956e-05, "normalize_and_clip_actions": 1.0086487147466749e-05, "get_actions": 4.2311860688493304e-05, "tensor_to_numpy": 1.4165843095840121e-05}}, "connector_pipeline_timer": 0.00011194135951058801}, "episode_duration_sec_mean": 0.005434737705159931, "sample": 0.005486656591764314, "num_module_steps_sampled_lifetime": {"default_policy": -9252500.0}, "env_reset_timer": 3.9708230330934996e-05, "time_between_sampling": 0.001561451848011834, "episode_len_max": 20, "weights_seq_no": 16.0, "num_env_steps_sampled_lifetime": -9252500.0, "env_to_module_sum_episodes_length_in": 10.36823839457432, "episode_len_mean": 20.0, "module_episode_returns_mean": {"default_policy": 11.380000000000003}, "episode_return_min": -5.5, "episode_return_max": 14.5, "num_agent_steps_sampled_lifetime": {"default_agent": -9252500.0}, "rlmodule_inference_timer": 5.388570274516427e-05, "env_to_module_sum_episodes_length_out": 10.36823839457432, "num_module_steps_sampled": {"default_policy": 5000.0}, "num_env_steps_sampled_lifetime_throughput": 3518.3989226735753}, "learners": {"default_policy": {"module_train_batch_size_mean": 1000.0, "vf_explained_var": 0.004249453544616699, "num_module_steps_trained_lifetime": 102000, "entropy": 0.5945951342582703, "curr_kl_coeff": 5.695314939657692e-06, "vf_loss_unclipped": 37.01144027709961, "diff_num_grad_updates_vs_sampler_policy": 1.0, "default_optimizer_learning_rate": 0.0002847858517, "total_loss": 0.113533154129982, "mean_kl_loss": 0.00019485194934532046, "vf_loss": 0.10092901438474655, "gradients_default_optimizer_global_norm": 0.0712444856762886, "weights_seq_no": 17.0, "num_module_steps_trained": 6000, "policy_loss": 0.05141635611653328, "curr_entropy_coeff": 0.0090570820258, "num_trainable_parameters": 6003, "num_module_steps_trained_lifetime_throughput": 408963.7883893892}, "__all_modules__": {"num_module_steps_trained": 6000, "num_trainable_parameters": 6003, "learner_connector_sum_episodes_length_in": 5000.0, "num_env_steps_trained": 31500, "learner_connector": {"timers": {"connectors": {"batch_individual_items": 0.036055146045179766, "numpy_to_tensor": 0.0001414383129082715, "add_states_from_episodes_to_batch": 3.5440966595808354e-06, "add_observations_from_episodes_to_batch": 0.0008116396606647912, "add_columns_from_episodes_to_train_batch": 0.03488527064620847, "add_time_dim_to_batch_and_zero_pad": 1.5746439135034374e-05, "add_one_ts_to_episodes_and_truncate": 0.008758015791737794, "general_advantage_estimation": 0.007647552519810094}}, "connector_pipeline_timer": 0.08848786707523738}, "num_module_steps_trained_lifetime": 102000, "learner_connector_sum_episodes_length_out": 5250.0, "num_env_steps_trained_lifetime": 535500, "num_non_trainable_parameters": 0, "num_env_steps_trained_lifetime_throughput": 2121998.8517664107, "num_module_steps_trained_throughput": 406103.8875615421, "num_module_steps_trained_lifetime_throughput": 405253.4789716383}}, "num_training_step_calls_per_iteration": 1, "evaluation": {"env_runners": {"num_env_steps_sampled": 400, "env_to_module_connector": {"timers": {"connectors": {"add_states_from_episodes_to_batch": 1.9763329647886183e-06, "add_observations_from_episodes_to_batch": 3.6886370097970703e-06, "add_time_dim_to_batch_and_zero_pad": 3.1586530950307915e-06, "batch_individual_items": 8.055017525989772e-06, "numpy_to_tensor": 1.4043464185642255e-05}}, "connector_pipeline_timer": 5.766959975269777e-05}, "episode_len_max": 20, "num_module_steps_sampled_lifetime": {"default_policy": 6800}, "rlmodule_inference_timer": 4.137134006717838e-05, "env_to_module_sum_episodes_length_out": 10.368238394574323, "module_to_env_connector": {"connector_pipeline_timer": 0.00015151857239631444, "timers": {"connectors": {"tensor_to_numpy": 1.7890837651528744e-05, "listify_data_for_vector_env": 1.3907208107487207e-05, "get_actions": 5.814134105475445e-05, "normalize_and_clip_actions": 1.2438263587224128e-05, "remove_single_ts_time_rank_from_batch": 7.478134699534974e-07, "un_batch_to_individual_items": 6.76048475937116e-06}}}, "episode_len_min": 20, "env_reset_timer": 0.0001938038991913655, "episode_return_max": 15.5, "num_episodes_lifetime": 340, "num_episodes": 20, "episode_return_mean": 0.5, "num_module_steps_sampled": {"default_policy": 400}, "episode_duration_sec_mean": 0.004836873321328312, "sample": 0.1015165148395561, "weights_seq_no": 17.0, "module_episode_returns_mean": {"default_policy": 0.5}, "num_agent_steps_sampled_lifetime": {"default_agent": 6800}, "env_step_timer": 1.9666010580604587e-05, "num_agent_steps_sampled": {"default_agent": 400}, "agent_episode_returns_mean": {"default_agent": 0.5}, "num_env_steps_sampled_lifetime": 85400, "env_to_module_sum_episodes_length_in": 10.368238394574323, "episode_len_mean": 20.0, "episode_return_min": -13.5, "time_between_sampling": 1.650432781300116}, "num_healthy_workers": 1, "actor_manager_num_outstanding_async_reqs": 0, "num_remote_worker_restarts": 0}, "num_env_steps_sampled_lifetime": -9252500.0, "fault_tolerance": {"num_healthy_workers": 0, "num_remote_worker_restarts": 0}, "env_runner_group": {"actor_manager_num_outstanding_async_reqs": 0}, "done": false, "training_iteration": 17, "trial_id": "4d67b_00000", "date": "2025-08-11_19-22-48", "timestamp": 1754932968, "time_this_iter_s": 1.8428096771240234, "time_total_s": 30.380415201187134, "pid": 14356, "hostname": "Mac", "node_ip": "127.0.0.1", "config": {"exploration_config": {}, "extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "placement_strategy": "PACK", "num_gpus": 0, "_fake_gpus": false, "num_cpus_for_main_process": 2, "eager_tracing": true, "eager_max_retraces": 20, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "torch_compile_learner": false, "torch_compile_learner_what_to_compile": "forward_train", "torch_compile_learner_dynamo_backend": "aot_eager", "torch_compile_learner_dynamo_mode": null, "torch_compile_worker": false, "torch_compile_worker_dynamo_backend": "aot_eager", "torch_compile_worker_dynamo_mode": null, "torch_ddp_kwargs": {}, "torch_skip_nan_gradients": false, "env": "Umbrella", "env_config": {}, "observation_space": null, "action_space": null, "clip_rewards": null, "normalize_actions": true, "clip_actions": false, "_is_atari": null, "disable_env_checking": false, "render_env": false, "action_mask_key": "action_mask", "env_runner_cls": null, "num_env_runners": 0, "create_local_env_runner": true, "num_envs_per_env_runner": 1, "gym_env_vectorize_mode": "SYNC", "num_cpus_per_env_runner": 1, "num_gpus_per_env_runner": 0, "custom_resources_per_env_runner": {}, "validate_env_runners_after_construction": true, "episodes_to_numpy": true, "max_requests_in_flight_per_env_runner": 1, "sample_timeout_s": 60.0, "_env_to_module_connector": null, "add_default_connectors_to_env_to_module_pipeline": true, "_module_to_env_connector": null, "add_default_connectors_to_module_to_env_pipeline": true, "merge_env_runner_states": "training_only", "broadcast_env_runner_states": true, "episode_lookback_horizon": 1, "rollout_fragment_length": "auto", "batch_mode": "complete_episodes", "compress_observations": false, "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "enable_tf1_exec_eagerly": false, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "preprocessor_pref": "deepmind", "observation_filter": "NoFilter", "update_worker_filter_stats": true, "use_worker_filter_stats": true, "sampler_perf_stats_ema_coef": null, "_is_online": true, "num_learners": 0, "num_gpus_per_learner": 0, "num_cpus_per_learner": "auto", "num_aggregator_actors_per_learner": 0, "max_requests_in_flight_per_aggregator_actor": 3, "local_gpu_idx": 0, "max_requests_in_flight_per_learner": 3, "gamma": 1, "lr": 0.0002847858517, "grad_clip": 0.5, "grad_clip_by": "global_norm", "_train_batch_size_per_learner": 5000, "train_batch_size": 4000, "num_epochs": 1, "minibatch_size": 1000, "shuffle_batch_per_epoch": true, "model": {"fcnet_hiddens": [256, 256], "fcnet_activation": "tanh", "fcnet_weights_initializer": null, "fcnet_weights_initializer_config": null, "fcnet_bias_initializer": null, "fcnet_bias_initializer_config": null, "conv_filters": null, "conv_activation": "relu", "conv_kernel_initializer": null, "conv_kernel_initializer_config": null, "conv_bias_initializer": null, "conv_bias_initializer_config": null, "conv_transpose_kernel_initializer": null, "conv_transpose_kernel_initializer_config": null, "conv_transpose_bias_initializer": null, "conv_transpose_bias_initializer_config": null, "post_fcnet_hiddens": [], "post_fcnet_activation": "relu", "post_fcnet_weights_initializer": null, "post_fcnet_weights_initializer_config": null, "post_fcnet_bias_initializer": null, "post_fcnet_bias_initializer_config": null, "free_log_std": false, "log_std_clip_param": 20.0, "no_final_linear": false, "vf_share_layers": false, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "lstm_weights_initializer": null, "lstm_weights_initializer_config": null, "lstm_bias_initializer": null, "lstm_bias_initializer_config": null, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "attention_use_n_prev_actions": 0, "attention_use_n_prev_rewards": 0, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": null, "custom_model_config": {}, "custom_action_dist": null, "custom_preprocessor": null, "encoder_latent_dim": null, "always_check_shapes": false, "lstm_use_prev_action_reward": -1, "_use_default_native_models": -1, "_disable_preprocessor_api": false, "_disable_action_flattening": false}, "_learner_connector": null, "add_default_connectors_to_learner_pipeline": true, "learner_config_dict": {}, "optimizer": {}, "_learner_class": null, "callbacks_on_algorithm_init": null, "callbacks_on_env_runners_recreated": null, "callbacks_on_offline_eval_runners_recreated": null, "callbacks_on_checkpoint_loaded": null, "callbacks_on_environment_created": null, "callbacks_on_episode_created": null, "callbacks_on_episode_start": null, "callbacks_on_episode_step": null, "callbacks_on_episode_end": null, "callbacks_on_evaluate_start": null, "callbacks_on_evaluate_end": null, "callbacks_on_evaluate_offline_start": null, "callbacks_on_evaluate_offline_end": null, "callbacks_on_sample_end": null, "callbacks_on_train_result": null, "explore": true, "enable_rl_module_and_learner": true, "enable_env_runner_and_connector_v2": true, "_prior_exploration_config": {"type": "StochasticSampling"}, "count_steps_by": "env_steps", "policy_map_capacity": 100, "policy_mapping_fn": "<function AlgorithmConfig.DEFAULT_POLICY_MAPPING_FN at 0x385aedb20>", "policies_to_train": null, "policy_states_are_swappable": false, "observation_fn": null, "offline_data_class": null, "input_read_method": "read_parquet", "input_read_method_kwargs": {}, "input_read_schema": {}, "input_read_episodes": false, "input_read_sample_batches": false, "input_read_batch_size": null, "input_filesystem": null, "input_filesystem_kwargs": {}, "input_compress_columns": ["obs", "new_obs"], "input_spaces_jsonable": true, "materialize_data": false, "materialize_mapped_data": true, "map_batches_kwargs": {}, "iter_batches_kwargs": {}, "ignore_final_observation": false, "prelearner_class": null, "prelearner_buffer_class": null, "prelearner_buffer_kwargs": {}, "prelearner_module_synch_period": 10, "dataset_num_iters_per_learner": null, "input_config": {}, "actions_in_input_normalized": false, "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_config": {}, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "output_max_rows_per_file": null, "output_write_remaining_data": false, "output_write_method": "write_parquet", "output_write_method_kwargs": {}, "output_filesystem": null, "output_filesystem_kwargs": {}, "output_write_episodes": true, "offline_sampling": false, "evaluation_interval": 1, "evaluation_duration": 20, "evaluation_duration_unit": "episodes", "evaluation_sample_timeout_s": 120.0, "evaluation_auto_duration_min_env_steps_per_sample": 100, "evaluation_auto_duration_max_env_steps_per_sample": 2000, "evaluation_parallel_to_training": false, "evaluation_force_reset_envs_before_iteration": true, "evaluation_config": null, "off_policy_estimation_methods": {}, "ope_split_batch_by_episode": true, "evaluation_num_env_runners": 1, "in_evaluation": false, "sync_filters_on_rollout_workers_timeout_s": 10.0, "offline_evaluation_interval": null, "num_offline_eval_runners": 0, "offline_loss_for_module_fn": null, "offline_evaluation_duration": 1, "offline_evaluation_parallel_to_training": false, "offline_evaluation_timeout_s": 120.0, "num_cpus_per_offline_eval_runner": 1, "num_gpus_per_offline_eval_runner": 0, "custom_resources_per_offline_eval_runner": {}, "restart_failed_offline_eval_runners": true, "ignore_offline_eval_runner_failures": false, "max_num_offline_eval_runner_restarts": 1000, "offline_eval_runner_restore_timeout_s": 1800.0, "max_requests_in_flight_per_offline_eval_runner": 1, "validate_offline_eval_runners_after_construction": true, "offline_eval_runner_health_probe_timeout_s": 30.0, "offline_eval_rl_module_inference_only": false, "broadcast_offline_eval_runner_states": false, "offline_eval_batch_size_per_runner": 256, "dataset_num_iters_per_eval_runner": 1, "keep_per_episode_custom_metrics": false, "metrics_episode_collection_timeout_s": 60.0, "metrics_num_episodes_for_smoothing": 100, "min_time_s_per_iteration": null, "min_train_timesteps_per_iteration": 0, "min_sample_timesteps_per_iteration": 0, "log_gradients": true, "export_native_model_files": false, "checkpoint_trainable_policies_only": false, "logger_creator": null, "logger_config": null, "log_level": "WARN", "log_sys_usage": true, "fake_sampler": false, "seed": 9, "restart_failed_env_runners": true, "ignore_env_runner_failures": false, "max_num_env_runner_restarts": 1000, "delay_between_env_runner_restarts_s": 60.0, "restart_failed_sub_environments": false, "num_consecutive_env_runner_failures_tolerance": 100, "env_runner_health_probe_timeout_s": 30.0, "env_runner_restore_timeout_s": 1800.0, "_model_config": {}, "_rl_module_spec": "RLModuleSpec(module_class=None, observation_space=None, action_space=None, inference_only=False, learner_only=False, model_config=DefaultModelConfig(fcnet_hiddens=[60, 90], fcnet_activation='tanh', fcnet_kernel_initializer=None, fcnet_kernel_initializer_kwargs=None, fcnet_bias_initializer=None, fcnet_bias_initializer_kwargs=None, conv_filters=None, conv_activation='relu', conv_kernel_initializer=None, conv_kernel_initializer_kwargs=None, conv_bias_initializer=None, conv_bias_initializer_kwargs=None, head_fcnet_hiddens=[], head_fcnet_activation='relu', head_fcnet_kernel_initializer=None, head_fcnet_kernel_initializer_kwargs=None, head_fcnet_bias_initializer=None, head_fcnet_bias_initializer_kwargs=None, free_log_std=False, log_std_clip_param=20.0, vf_share_layers=True, use_lstm=False, max_seq_len=20, lstm_cell_size=256, lstm_use_prev_action=False, lstm_use_prev_reward=False, lstm_kernel_initializer=None, lstm_kernel_initializer_kwargs=None, lstm_bias_initializer=None, lstm_bias_initializer_kwargs=None), catalog_class=None, load_state_path=None, model_config_dict=None)", "algorithm_config_overrides_per_module": {}, "_per_module_overrides": {}, "_validate_config": true, "_use_msgpack_checkpoints": false, "_torch_grad_scaler_class": null, "_torch_lr_scheduler_classes": null, "_tf_policy_handles_more_than_one_loss": false, "_disable_preprocessor_api": false, "_disable_action_flattening": false, "_disable_initialize_loss_from_dummy_batch": false, "_dont_auto_sync_env_runner_states": false, "env_task_fn": -1, "enable_connectors": -1, "simple_optimizer": false, "policy_map_cache": -1, "worker_cls": -1, "synchronize_filters": -1, "enable_async_evaluation": -1, "custom_async_evaluation_function": -1, "_enable_rl_module_api": -1, "auto_wrap_old_gym_envs": -1, "always_attach_evaluation_results": -1, "replay_sequence_length": null, "_disable_execution_plan_api": -1, "use_critic": true, "use_gae": true, "use_kl_loss": true, "kl_coeff": 0.7464963036515, "kl_target": 0.0270990929592, "vf_loss_coeff": 0.6688075857018, "entropy_coeff": 0.0090570820258, "clip_param": 0.1221781641624, "vf_clip_param": 0.1027808522125, "entropy_coeff_schedule": null, "lr_schedule": null, "sgd_minibatch_size": -1, "vf_share_layers": -1, "__stdout_file__": null, "__stderr_file__": null, "lambda": 0.9099046732075, "input": "sampler", "policies": {"default_policy": [null, null, null, null]}, "callbacks": "<class 'ray.rllib.callbacks.callbacks.RLlibCallback'>", "create_env_on_driver": false, "custom_eval_function": null, "framework": "torch"}, "time_since_restore": 30.380415201187134, "iterations_since_restore": 17, "perf": {"cpu_util_percent": 28.899999999999995, "ram_util_percent": 80.2}}
{"timers": {"training_iteration": 1.8482792981614589, "restore_env_runners": 1.1224868998243997e-05, "training_step": 1.848108042719762, "env_runner_sampling_timer": 1.7292561110776818, "learner_update_timer": 0.11549046162677233, "synch_weights": 0.0006395487531069615, "restore_eval_env_runners": 1.004026666939905e-05, "evaluation_iteration": 0.11084045271888311, "synch_eval_env_connectors": 0.00014008019738465409, "synch_env_connectors": 4.612225786221623e-06}, "env_runners": {"num_episodes_lifetime": -493500.0, "env_to_module_connector": {"connector_pipeline_timer": 4.4315340535939886e-05, "timers": {"connectors": {"add_observations_from_episodes_to_batch": 2.982754130373269e-06, "add_time_dim_to_batch_and_zero_pad": 2.4369109899673966e-06, "batch_individual_items": 6.405302597571142e-06, "numpy_to_tensor": 8.787400513586223e-06, "add_states_from_episodes_to_batch": 1.7552702623012715e-06}}}, "num_episodes": 250.0, "env_step_timer": 1.4002890603230479e-05, "episode_len_min": 20, "num_agent_steps_sampled": {"default_agent": 5000.0}, "agent_episode_returns_mean": {"default_agent": 12.420000000000002}, "episode_return_mean": 12.420000000000002, "num_env_steps_sampled": 5000.0, "module_to_env_connector": {"timers": {"connectors": {"remove_single_ts_time_rank_from_batch": 5.776110007110938e-07, "un_batch_to_individual_items": 5.3966099813914425e-06, "listify_data_for_vector_env": 1.1280524285514824e-05, "normalize_and_clip_actions": 9.563474859334527e-06, "get_actions": 3.883315002568169e-05, "tensor_to_numpy": 1.3214873272615349e-05}}, "connector_pipeline_timer": 0.00010447529219476921}, "episode_duration_sec_mean": 0.0045981289865449065, "sample": 0.0052642683893237285, "num_module_steps_sampled_lifetime": {"default_policy": -9870000.0}, "env_reset_timer": 3.982653513515431e-05, "time_between_sampling": 0.0016047960144211224, "episode_len_max": 20, "weights_seq_no": 17.0, "num_env_steps_sampled_lifetime": -9870000.0, "env_to_module_sum_episodes_length_in": 10.36823839457432, "episode_len_mean": 20.0, "module_episode_returns_mean": {"default_policy": 12.420000000000002}, "episode_return_min": -5.5, "episode_return_max": 14.5, "num_agent_steps_sampled_lifetime": {"default_agent": -9870000.0}, "rlmodule_inference_timer": 2.8468369574704006e-05, "env_to_module_sum_episodes_length_out": 10.36823839457432, "num_module_steps_sampled": {"default_policy": 5000.0}, "num_env_steps_sampled_lifetime_throughput": 3650.1892790310576}, "learners": {"default_policy": {"module_train_batch_size_mean": 1000.0, "vf_explained_var": -0.004913330078125, "num_module_steps_trained_lifetime": 108000, "entropy": 0.6081311106681824, "curr_kl_coeff": 2.847657469828846e-06, "vf_loss_unclipped": 39.726741790771484, "diff_num_grad_updates_vs_sampler_policy": 1.0, "default_optimizer_learning_rate": 0.0002847858517, "total_loss": -0.1346408873796463, "mean_kl_loss": 0.0001815491123124957, "vf_loss": 0.10222505033016205, "gradients_default_optimizer_global_norm": 0.019866973161697388, "weights_seq_no": 18.0, "num_module_steps_trained": 6000, "policy_loss": -0.19750188291072845, "curr_entropy_coeff": 0.0090570820258, "num_trainable_parameters": 6003, "num_module_steps_trained_lifetime_throughput": 409063.53874222795}, "__all_modules__": {"num_module_steps_trained": 6000, "num_trainable_parameters": 6003, "learner_connector_sum_episodes_length_in": 5000.0, "num_env_steps_trained": 31500, "learner_connector": {"timers": {"connectors": {"batch_individual_items": 0.03686817541378209, "numpy_to_tensor": 0.0001405735102153887, "add_states_from_episodes_to_batch": 3.535745538374155e-06, "add_observations_from_episodes_to_batch": 0.0008117195150593523, "add_columns_from_episodes_to_train_batch": 0.03487170918895826, "add_time_dim_to_batch_and_zero_pad": 1.5675644786630963e-05, "add_one_ts_to_episodes_and_truncate": 0.008745849383839342, "general_advantage_estimation": 0.0076291165855611855}}, "connector_pipeline_timer": 0.0892550638141414}, "num_module_steps_trained_lifetime": 108000, "learner_connector_sum_episodes_length_out": 5250.0, "num_env_steps_trained_lifetime": 567000, "num_non_trainable_parameters": 0, "num_env_steps_trained_lifetime_throughput": 2123816.3219794873, "num_module_steps_trained_throughput": 406381.38185755187, "num_module_steps_trained_lifetime_throughput": 405563.9913719848}}, "num_training_step_calls_per_iteration": 1, "evaluation": {"env_runners": {"num_env_steps_sampled": 400, "env_to_module_connector": {"timers": {"connectors": {"add_states_from_episodes_to_batch": 1.6705584995464932e-06, "add_observations_from_episodes_to_batch": 2.9078697933004525e-06, "add_time_dim_to_batch_and_zero_pad": 2.3684663605402145e-06, "batch_individual_items": 6.158745924902773e-06, "numpy_to_tensor": 8.434716670168158e-06}}, "connector_pipeline_timer": 4.3475951119270785e-05}, "episode_len_max": 20, "num_module_steps_sampled_lifetime": {"default_policy": 7200}, "rlmodule_inference_timer": 2.700347377944382e-05, "env_to_module_sum_episodes_length_out": 10.368238394574323, "module_to_env_connector": {"connector_pipeline_timer": 0.00010011283468173984, "timers": {"connectors": {"tensor_to_numpy": 1.2875014703568103e-05, "listify_data_for_vector_env": 1.0767451513910026e-05, "get_actions": 3.512076953175321e-05, "normalize_and_clip_actions": 9.40718067621092e-06, "remove_single_ts_time_rank_from_batch": 6.036954204263381e-07, "un_batch_to_individual_items": 5.3709650498115495e-06}}}, "episode_len_min": 20, "env_reset_timer": 0.00019271961058852115, "episode_return_max": 15.5, "num_episodes_lifetime": 360, "num_episodes": 20, "episode_return_mean": 1.9, "num_module_steps_sampled": {"default_policy": 400}, "episode_duration_sec_mean": 0.004831559181911871, "sample": 0.10147043177098831, "weights_seq_no": 18.0, "module_episode_returns_mean": {"default_policy": 1.9}, "num_agent_steps_sampled_lifetime": {"default_agent": 7200}, "env_step_timer": 1.3983479823919627e-05, "num_agent_steps_sampled": {"default_agent": 400}, "agent_episode_returns_mean": {"default_agent": 1.9}, "num_env_steps_sampled_lifetime": 90400, "env_to_module_sum_episodes_length_in": 10.368238394574323, "episode_len_mean": 20.0, "episode_return_min": -13.5, "time_between_sampling": 1.6498788347377011}, "num_healthy_workers": 1, "actor_manager_num_outstanding_async_reqs": 0, "num_remote_worker_restarts": 0}, "num_env_steps_sampled_lifetime": -9870000.0, "fault_tolerance": {"num_healthy_workers": 0, "num_remote_worker_restarts": 0}, "env_runner_group": {"actor_manager_num_outstanding_async_reqs": 0}, "done": false, "training_iteration": 18, "trial_id": "4d67b_00000", "date": "2025-08-11_19-22-50", "timestamp": 1754932970, "time_this_iter_s": 1.6820168495178223, "time_total_s": 32.062432050704956, "pid": 14356, "hostname": "Mac", "node_ip": "127.0.0.1", "config": {"exploration_config": {}, "extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "placement_strategy": "PACK", "num_gpus": 0, "_fake_gpus": false, "num_cpus_for_main_process": 2, "eager_tracing": true, "eager_max_retraces": 20, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "torch_compile_learner": false, "torch_compile_learner_what_to_compile": "forward_train", "torch_compile_learner_dynamo_backend": "aot_eager", "torch_compile_learner_dynamo_mode": null, "torch_compile_worker": false, "torch_compile_worker_dynamo_backend": "aot_eager", "torch_compile_worker_dynamo_mode": null, "torch_ddp_kwargs": {}, "torch_skip_nan_gradients": false, "env": "Umbrella", "env_config": {}, "observation_space": null, "action_space": null, "clip_rewards": null, "normalize_actions": true, "clip_actions": false, "_is_atari": null, "disable_env_checking": false, "render_env": false, "action_mask_key": "action_mask", "env_runner_cls": null, "num_env_runners": 0, "create_local_env_runner": true, "num_envs_per_env_runner": 1, "gym_env_vectorize_mode": "SYNC", "num_cpus_per_env_runner": 1, "num_gpus_per_env_runner": 0, "custom_resources_per_env_runner": {}, "validate_env_runners_after_construction": true, "episodes_to_numpy": true, "max_requests_in_flight_per_env_runner": 1, "sample_timeout_s": 60.0, "_env_to_module_connector": null, "add_default_connectors_to_env_to_module_pipeline": true, "_module_to_env_connector": null, "add_default_connectors_to_module_to_env_pipeline": true, "merge_env_runner_states": "training_only", "broadcast_env_runner_states": true, "episode_lookback_horizon": 1, "rollout_fragment_length": "auto", "batch_mode": "complete_episodes", "compress_observations": false, "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "enable_tf1_exec_eagerly": false, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "preprocessor_pref": "deepmind", "observation_filter": "NoFilter", "update_worker_filter_stats": true, "use_worker_filter_stats": true, "sampler_perf_stats_ema_coef": null, "_is_online": true, "num_learners": 0, "num_gpus_per_learner": 0, "num_cpus_per_learner": "auto", "num_aggregator_actors_per_learner": 0, "max_requests_in_flight_per_aggregator_actor": 3, "local_gpu_idx": 0, "max_requests_in_flight_per_learner": 3, "gamma": 1, "lr": 0.0002847858517, "grad_clip": 0.5, "grad_clip_by": "global_norm", "_train_batch_size_per_learner": 5000, "train_batch_size": 4000, "num_epochs": 1, "minibatch_size": 1000, "shuffle_batch_per_epoch": true, "model": {"fcnet_hiddens": [256, 256], "fcnet_activation": "tanh", "fcnet_weights_initializer": null, "fcnet_weights_initializer_config": null, "fcnet_bias_initializer": null, "fcnet_bias_initializer_config": null, "conv_filters": null, "conv_activation": "relu", "conv_kernel_initializer": null, "conv_kernel_initializer_config": null, "conv_bias_initializer": null, "conv_bias_initializer_config": null, "conv_transpose_kernel_initializer": null, "conv_transpose_kernel_initializer_config": null, "conv_transpose_bias_initializer": null, "conv_transpose_bias_initializer_config": null, "post_fcnet_hiddens": [], "post_fcnet_activation": "relu", "post_fcnet_weights_initializer": null, "post_fcnet_weights_initializer_config": null, "post_fcnet_bias_initializer": null, "post_fcnet_bias_initializer_config": null, "free_log_std": false, "log_std_clip_param": 20.0, "no_final_linear": false, "vf_share_layers": false, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "lstm_weights_initializer": null, "lstm_weights_initializer_config": null, "lstm_bias_initializer": null, "lstm_bias_initializer_config": null, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "attention_use_n_prev_actions": 0, "attention_use_n_prev_rewards": 0, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": null, "custom_model_config": {}, "custom_action_dist": null, "custom_preprocessor": null, "encoder_latent_dim": null, "always_check_shapes": false, "lstm_use_prev_action_reward": -1, "_use_default_native_models": -1, "_disable_preprocessor_api": false, "_disable_action_flattening": false}, "_learner_connector": null, "add_default_connectors_to_learner_pipeline": true, "learner_config_dict": {}, "optimizer": {}, "_learner_class": null, "callbacks_on_algorithm_init": null, "callbacks_on_env_runners_recreated": null, "callbacks_on_offline_eval_runners_recreated": null, "callbacks_on_checkpoint_loaded": null, "callbacks_on_environment_created": null, "callbacks_on_episode_created": null, "callbacks_on_episode_start": null, "callbacks_on_episode_step": null, "callbacks_on_episode_end": null, "callbacks_on_evaluate_start": null, "callbacks_on_evaluate_end": null, "callbacks_on_evaluate_offline_start": null, "callbacks_on_evaluate_offline_end": null, "callbacks_on_sample_end": null, "callbacks_on_train_result": null, "explore": true, "enable_rl_module_and_learner": true, "enable_env_runner_and_connector_v2": true, "_prior_exploration_config": {"type": "StochasticSampling"}, "count_steps_by": "env_steps", "policy_map_capacity": 100, "policy_mapping_fn": "<function AlgorithmConfig.DEFAULT_POLICY_MAPPING_FN at 0x385aedb20>", "policies_to_train": null, "policy_states_are_swappable": false, "observation_fn": null, "offline_data_class": null, "input_read_method": "read_parquet", "input_read_method_kwargs": {}, "input_read_schema": {}, "input_read_episodes": false, "input_read_sample_batches": false, "input_read_batch_size": null, "input_filesystem": null, "input_filesystem_kwargs": {}, "input_compress_columns": ["obs", "new_obs"], "input_spaces_jsonable": true, "materialize_data": false, "materialize_mapped_data": true, "map_batches_kwargs": {}, "iter_batches_kwargs": {}, "ignore_final_observation": false, "prelearner_class": null, "prelearner_buffer_class": null, "prelearner_buffer_kwargs": {}, "prelearner_module_synch_period": 10, "dataset_num_iters_per_learner": null, "input_config": {}, "actions_in_input_normalized": false, "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_config": {}, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "output_max_rows_per_file": null, "output_write_remaining_data": false, "output_write_method": "write_parquet", "output_write_method_kwargs": {}, "output_filesystem": null, "output_filesystem_kwargs": {}, "output_write_episodes": true, "offline_sampling": false, "evaluation_interval": 1, "evaluation_duration": 20, "evaluation_duration_unit": "episodes", "evaluation_sample_timeout_s": 120.0, "evaluation_auto_duration_min_env_steps_per_sample": 100, "evaluation_auto_duration_max_env_steps_per_sample": 2000, "evaluation_parallel_to_training": false, "evaluation_force_reset_envs_before_iteration": true, "evaluation_config": null, "off_policy_estimation_methods": {}, "ope_split_batch_by_episode": true, "evaluation_num_env_runners": 1, "in_evaluation": false, "sync_filters_on_rollout_workers_timeout_s": 10.0, "offline_evaluation_interval": null, "num_offline_eval_runners": 0, "offline_loss_for_module_fn": null, "offline_evaluation_duration": 1, "offline_evaluation_parallel_to_training": false, "offline_evaluation_timeout_s": 120.0, "num_cpus_per_offline_eval_runner": 1, "num_gpus_per_offline_eval_runner": 0, "custom_resources_per_offline_eval_runner": {}, "restart_failed_offline_eval_runners": true, "ignore_offline_eval_runner_failures": false, "max_num_offline_eval_runner_restarts": 1000, "offline_eval_runner_restore_timeout_s": 1800.0, "max_requests_in_flight_per_offline_eval_runner": 1, "validate_offline_eval_runners_after_construction": true, "offline_eval_runner_health_probe_timeout_s": 30.0, "offline_eval_rl_module_inference_only": false, "broadcast_offline_eval_runner_states": false, "offline_eval_batch_size_per_runner": 256, "dataset_num_iters_per_eval_runner": 1, "keep_per_episode_custom_metrics": false, "metrics_episode_collection_timeout_s": 60.0, "metrics_num_episodes_for_smoothing": 100, "min_time_s_per_iteration": null, "min_train_timesteps_per_iteration": 0, "min_sample_timesteps_per_iteration": 0, "log_gradients": true, "export_native_model_files": false, "checkpoint_trainable_policies_only": false, "logger_creator": null, "logger_config": null, "log_level": "WARN", "log_sys_usage": true, "fake_sampler": false, "seed": 9, "restart_failed_env_runners": true, "ignore_env_runner_failures": false, "max_num_env_runner_restarts": 1000, "delay_between_env_runner_restarts_s": 60.0, "restart_failed_sub_environments": false, "num_consecutive_env_runner_failures_tolerance": 100, "env_runner_health_probe_timeout_s": 30.0, "env_runner_restore_timeout_s": 1800.0, "_model_config": {}, "_rl_module_spec": "RLModuleSpec(module_class=None, observation_space=None, action_space=None, inference_only=False, learner_only=False, model_config=DefaultModelConfig(fcnet_hiddens=[60, 90], fcnet_activation='tanh', fcnet_kernel_initializer=None, fcnet_kernel_initializer_kwargs=None, fcnet_bias_initializer=None, fcnet_bias_initializer_kwargs=None, conv_filters=None, conv_activation='relu', conv_kernel_initializer=None, conv_kernel_initializer_kwargs=None, conv_bias_initializer=None, conv_bias_initializer_kwargs=None, head_fcnet_hiddens=[], head_fcnet_activation='relu', head_fcnet_kernel_initializer=None, head_fcnet_kernel_initializer_kwargs=None, head_fcnet_bias_initializer=None, head_fcnet_bias_initializer_kwargs=None, free_log_std=False, log_std_clip_param=20.0, vf_share_layers=True, use_lstm=False, max_seq_len=20, lstm_cell_size=256, lstm_use_prev_action=False, lstm_use_prev_reward=False, lstm_kernel_initializer=None, lstm_kernel_initializer_kwargs=None, lstm_bias_initializer=None, lstm_bias_initializer_kwargs=None), catalog_class=None, load_state_path=None, model_config_dict=None)", "algorithm_config_overrides_per_module": {}, "_per_module_overrides": {}, "_validate_config": true, "_use_msgpack_checkpoints": false, "_torch_grad_scaler_class": null, "_torch_lr_scheduler_classes": null, "_tf_policy_handles_more_than_one_loss": false, "_disable_preprocessor_api": false, "_disable_action_flattening": false, "_disable_initialize_loss_from_dummy_batch": false, "_dont_auto_sync_env_runner_states": false, "env_task_fn": -1, "enable_connectors": -1, "simple_optimizer": false, "policy_map_cache": -1, "worker_cls": -1, "synchronize_filters": -1, "enable_async_evaluation": -1, "custom_async_evaluation_function": -1, "_enable_rl_module_api": -1, "auto_wrap_old_gym_envs": -1, "always_attach_evaluation_results": -1, "replay_sequence_length": null, "_disable_execution_plan_api": -1, "use_critic": true, "use_gae": true, "use_kl_loss": true, "kl_coeff": 0.7464963036515, "kl_target": 0.0270990929592, "vf_loss_coeff": 0.6688075857018, "entropy_coeff": 0.0090570820258, "clip_param": 0.1221781641624, "vf_clip_param": 0.1027808522125, "entropy_coeff_schedule": null, "lr_schedule": null, "sgd_minibatch_size": -1, "vf_share_layers": -1, "__stdout_file__": null, "__stderr_file__": null, "lambda": 0.9099046732075, "input": "sampler", "policies": {"default_policy": [null, null, null, null]}, "callbacks": "<class 'ray.rllib.callbacks.callbacks.RLlibCallback'>", "create_env_on_driver": false, "custom_eval_function": null, "framework": "torch"}, "time_since_restore": 32.062432050704956, "iterations_since_restore": 18, "perf": {"cpu_util_percent": 45.8, "ram_util_percent": 80.4}}
{"timers": {"training_iteration": 1.8452439097600348, "restore_env_runners": 1.117261960097794e-05, "training_step": 1.845072639372989, "env_runner_sampling_timer": 1.7255960907966175, "learner_update_timer": 0.11611588243047259, "synch_weights": 0.0006387286852123352, "restore_eval_env_runners": 1.0019034570619904e-05, "evaluation_iteration": 0.11075350986128274, "synch_eval_env_connectors": 0.0001398548153039233, "synch_env_connectors": 4.6015228900252515e-06}, "env_runners": {"num_episodes_lifetime": -524375.0, "env_to_module_connector": {"connector_pipeline_timer": 4.365558122920182e-05, "timers": {"connectors": {"add_observations_from_episodes_to_batch": 2.9463701027377628e-06, "add_time_dim_to_batch_and_zero_pad": 2.402440119373218e-06, "batch_individual_items": 6.2998572200953385e-06, "numpy_to_tensor": 8.590334846245858e-06, "add_states_from_episodes_to_batch": 1.7309251983447582e-06}}}, "num_episodes": 250.0, "env_step_timer": 1.3676007332012651e-05, "episode_len_min": 20, "num_agent_steps_sampled": {"default_agent": 5000.0}, "agent_episode_returns_mean": {"default_agent": 11.940000000000003}, "episode_return_mean": 11.940000000000003, "num_env_steps_sampled": 5000.0, "module_to_env_connector": {"timers": {"connectors": {"remove_single_ts_time_rank_from_batch": 5.83014048371179e-07, "un_batch_to_individual_items": 5.400089574047956e-06, "listify_data_for_vector_env": 1.113786409411735e-05, "normalize_and_clip_actions": 9.378574378819632e-06, "get_actions": 3.739830126344361e-05, "tensor_to_numpy": 1.290202224413569e-05}}, "connector_pipeline_timer": 0.00010210635400941338}, "episode_duration_sec_mean": 0.004511054371483623, "sample": 0.004853202688387963, "num_module_steps_sampled_lifetime": {"default_policy": -10487500.0}, "env_reset_timer": 3.352842384747875e-05, "time_between_sampling": 0.001808618452757219, "episode_len_max": 20, "weights_seq_no": 18.0, "num_env_steps_sampled_lifetime": -10487500.0, "env_to_module_sum_episodes_length_in": 10.36823839457432, "episode_len_mean": 20.0, "module_episode_returns_mean": {"default_policy": 11.940000000000003}, "episode_return_min": -5.5, "episode_return_max": 14.5, "num_agent_steps_sampled_lifetime": {"default_agent": -10487500.0}, "rlmodule_inference_timer": 2.7803944692542337e-05, "env_to_module_sum_episodes_length_out": 10.36823839457432, "num_module_steps_sampled": {"default_policy": 5000.0}, "num_env_steps_sampled_lifetime_throughput": 3772.2128981768583}, "learners": {"default_policy": {"module_train_batch_size_mean": 1000.0, "vf_explained_var": 0.0010715723037719727, "num_module_steps_trained_lifetime": 114000, "entropy": 0.5988801717758179, "curr_kl_coeff": 1.423828734914423e-06, "vf_loss_unclipped": 38.91197967529297, "diff_num_grad_updates_vs_sampler_policy": 1.0, "default_optimizer_learning_rate": 0.0002847858517, "total_loss": -0.05254727974534035, "mean_kl_loss": 4.5508480980060995e-05, "vf_loss": 0.10185413807630539, "gradients_default_optimizer_global_norm": 0.04448277875781059, "weights_seq_no": 19.0, "num_module_steps_trained": 6000, "policy_loss": -0.11524400860071182, "curr_entropy_coeff": 0.0090570820258, "num_trainable_parameters": 6003, "num_module_steps_trained_lifetime_throughput": 409850.9467287473}, "__all_modules__": {"num_module_steps_trained": 6000, "num_trainable_parameters": 6003, "learner_connector_sum_episodes_length_in": 5000.0, "num_env_steps_trained": 31500, "learner_connector": {"timers": {"connectors": {"batch_individual_items": 0.03767505823954276, "numpy_to_tensor": 0.00013985777571062238, "add_states_from_episodes_to_batch": 3.527887710312372e-06, "add_observations_from_episodes_to_batch": 0.0008117906593246964, "add_columns_from_episodes_to_train_batch": 0.03486354084731462, "add_time_dim_to_batch_and_zero_pad": 1.5601388384883748e-05, "add_one_ts_to_episodes_and_truncate": 0.008734402139330842, "general_advantage_estimation": 0.007604423329474617}}, "connector_pipeline_timer": 0.09001616401674435}, "num_module_steps_trained_lifetime": 114000, "learner_connector_sum_episodes_length_out": 5250.0, "num_env_steps_trained_lifetime": 598500, "num_non_trainable_parameters": 0, "num_env_steps_trained_lifetime_throughput": 2129205.374910256, "num_module_steps_trained_throughput": 407339.23274784355, "num_module_steps_trained_lifetime_throughput": 406552.92401195515}}, "num_training_step_calls_per_iteration": 1, "evaluation": {"env_runners": {"num_env_steps_sampled": 400, "env_to_module_connector": {"timers": {"connectors": {"add_states_from_episodes_to_batch": 1.624530426541956e-06, "add_observations_from_episodes_to_batch": 2.914587134751701e-06, "add_time_dim_to_batch_and_zero_pad": 2.385642624588426e-06, "batch_individual_items": 6.17128153908857e-06, "numpy_to_tensor": 8.531179199491519e-06}}, "connector_pipeline_timer": 4.321422931220807e-05}, "episode_len_max": 20, "num_module_steps_sampled_lifetime": {"default_policy": 7600}, "rlmodule_inference_timer": 2.719965579002975e-05, "env_to_module_sum_episodes_length_out": 10.368238394574323, "module_to_env_connector": {"connector_pipeline_timer": 0.00010163772600719321, "timers": {"connectors": {"tensor_to_numpy": 1.3131225247664388e-05, "listify_data_for_vector_env": 1.0999661259226682e-05, "get_actions": 3.5651377434207174e-05, "normalize_and_clip_actions": 9.507771069602901e-06, "remove_single_ts_time_rank_from_batch": 6.310001256815836e-07, "un_batch_to_individual_items": 5.437769297015093e-06}}}, "episode_len_min": 20, "env_reset_timer": 0.00019161908433954188, "episode_return_max": 15.5, "num_episodes_lifetime": 380, "num_episodes": 20, "episode_return_mean": 2.5, "num_module_steps_sampled": {"default_policy": 400}, "episode_duration_sec_mean": 0.004841429169755429, "sample": 0.10144210787320515, "weights_seq_no": 19.0, "module_episode_returns_mean": {"default_policy": 2.5}, "num_agent_steps_sampled_lifetime": {"default_agent": 7600}, "env_step_timer": 1.3964429137902289e-05, "num_agent_steps_sampled": {"default_agent": 400}, "agent_episode_returns_mean": {"default_agent": 2.5}, "num_env_steps_sampled_lifetime": 95400, "env_to_module_sum_episodes_length_in": 10.368238394574323, "episode_len_mean": 20.0, "episode_return_min": -13.5, "time_between_sampling": 1.649002422221332}, "num_healthy_workers": 1, "actor_manager_num_outstanding_async_reqs": 0, "num_remote_worker_restarts": 0}, "num_env_steps_sampled_lifetime": -10487500.0, "fault_tolerance": {"num_healthy_workers": 0, "num_remote_worker_restarts": 0}, "env_runner_group": {"actor_manager_num_outstanding_async_reqs": 0}, "done": false, "training_iteration": 19, "trial_id": "4d67b_00000", "date": "2025-08-11_19-22-51", "timestamp": 1754932971, "time_this_iter_s": 1.651041030883789, "time_total_s": 33.713473081588745, "pid": 14356, "hostname": "Mac", "node_ip": "127.0.0.1", "config": {"exploration_config": {}, "extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "placement_strategy": "PACK", "num_gpus": 0, "_fake_gpus": false, "num_cpus_for_main_process": 2, "eager_tracing": true, "eager_max_retraces": 20, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "torch_compile_learner": false, "torch_compile_learner_what_to_compile": "forward_train", "torch_compile_learner_dynamo_backend": "aot_eager", "torch_compile_learner_dynamo_mode": null, "torch_compile_worker": false, "torch_compile_worker_dynamo_backend": "aot_eager", "torch_compile_worker_dynamo_mode": null, "torch_ddp_kwargs": {}, "torch_skip_nan_gradients": false, "env": "Umbrella", "env_config": {}, "observation_space": null, "action_space": null, "clip_rewards": null, "normalize_actions": true, "clip_actions": false, "_is_atari": null, "disable_env_checking": false, "render_env": false, "action_mask_key": "action_mask", "env_runner_cls": null, "num_env_runners": 0, "create_local_env_runner": true, "num_envs_per_env_runner": 1, "gym_env_vectorize_mode": "SYNC", "num_cpus_per_env_runner": 1, "num_gpus_per_env_runner": 0, "custom_resources_per_env_runner": {}, "validate_env_runners_after_construction": true, "episodes_to_numpy": true, "max_requests_in_flight_per_env_runner": 1, "sample_timeout_s": 60.0, "_env_to_module_connector": null, "add_default_connectors_to_env_to_module_pipeline": true, "_module_to_env_connector": null, "add_default_connectors_to_module_to_env_pipeline": true, "merge_env_runner_states": "training_only", "broadcast_env_runner_states": true, "episode_lookback_horizon": 1, "rollout_fragment_length": "auto", "batch_mode": "complete_episodes", "compress_observations": false, "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "enable_tf1_exec_eagerly": false, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "preprocessor_pref": "deepmind", "observation_filter": "NoFilter", "update_worker_filter_stats": true, "use_worker_filter_stats": true, "sampler_perf_stats_ema_coef": null, "_is_online": true, "num_learners": 0, "num_gpus_per_learner": 0, "num_cpus_per_learner": "auto", "num_aggregator_actors_per_learner": 0, "max_requests_in_flight_per_aggregator_actor": 3, "local_gpu_idx": 0, "max_requests_in_flight_per_learner": 3, "gamma": 1, "lr": 0.0002847858517, "grad_clip": 0.5, "grad_clip_by": "global_norm", "_train_batch_size_per_learner": 5000, "train_batch_size": 4000, "num_epochs": 1, "minibatch_size": 1000, "shuffle_batch_per_epoch": true, "model": {"fcnet_hiddens": [256, 256], "fcnet_activation": "tanh", "fcnet_weights_initializer": null, "fcnet_weights_initializer_config": null, "fcnet_bias_initializer": null, "fcnet_bias_initializer_config": null, "conv_filters": null, "conv_activation": "relu", "conv_kernel_initializer": null, "conv_kernel_initializer_config": null, "conv_bias_initializer": null, "conv_bias_initializer_config": null, "conv_transpose_kernel_initializer": null, "conv_transpose_kernel_initializer_config": null, "conv_transpose_bias_initializer": null, "conv_transpose_bias_initializer_config": null, "post_fcnet_hiddens": [], "post_fcnet_activation": "relu", "post_fcnet_weights_initializer": null, "post_fcnet_weights_initializer_config": null, "post_fcnet_bias_initializer": null, "post_fcnet_bias_initializer_config": null, "free_log_std": false, "log_std_clip_param": 20.0, "no_final_linear": false, "vf_share_layers": false, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "lstm_weights_initializer": null, "lstm_weights_initializer_config": null, "lstm_bias_initializer": null, "lstm_bias_initializer_config": null, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "attention_use_n_prev_actions": 0, "attention_use_n_prev_rewards": 0, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": null, "custom_model_config": {}, "custom_action_dist": null, "custom_preprocessor": null, "encoder_latent_dim": null, "always_check_shapes": false, "lstm_use_prev_action_reward": -1, "_use_default_native_models": -1, "_disable_preprocessor_api": false, "_disable_action_flattening": false}, "_learner_connector": null, "add_default_connectors_to_learner_pipeline": true, "learner_config_dict": {}, "optimizer": {}, "_learner_class": null, "callbacks_on_algorithm_init": null, "callbacks_on_env_runners_recreated": null, "callbacks_on_offline_eval_runners_recreated": null, "callbacks_on_checkpoint_loaded": null, "callbacks_on_environment_created": null, "callbacks_on_episode_created": null, "callbacks_on_episode_start": null, "callbacks_on_episode_step": null, "callbacks_on_episode_end": null, "callbacks_on_evaluate_start": null, "callbacks_on_evaluate_end": null, "callbacks_on_evaluate_offline_start": null, "callbacks_on_evaluate_offline_end": null, "callbacks_on_sample_end": null, "callbacks_on_train_result": null, "explore": true, "enable_rl_module_and_learner": true, "enable_env_runner_and_connector_v2": true, "_prior_exploration_config": {"type": "StochasticSampling"}, "count_steps_by": "env_steps", "policy_map_capacity": 100, "policy_mapping_fn": "<function AlgorithmConfig.DEFAULT_POLICY_MAPPING_FN at 0x385aedb20>", "policies_to_train": null, "policy_states_are_swappable": false, "observation_fn": null, "offline_data_class": null, "input_read_method": "read_parquet", "input_read_method_kwargs": {}, "input_read_schema": {}, "input_read_episodes": false, "input_read_sample_batches": false, "input_read_batch_size": null, "input_filesystem": null, "input_filesystem_kwargs": {}, "input_compress_columns": ["obs", "new_obs"], "input_spaces_jsonable": true, "materialize_data": false, "materialize_mapped_data": true, "map_batches_kwargs": {}, "iter_batches_kwargs": {}, "ignore_final_observation": false, "prelearner_class": null, "prelearner_buffer_class": null, "prelearner_buffer_kwargs": {}, "prelearner_module_synch_period": 10, "dataset_num_iters_per_learner": null, "input_config": {}, "actions_in_input_normalized": false, "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_config": {}, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "output_max_rows_per_file": null, "output_write_remaining_data": false, "output_write_method": "write_parquet", "output_write_method_kwargs": {}, "output_filesystem": null, "output_filesystem_kwargs": {}, "output_write_episodes": true, "offline_sampling": false, "evaluation_interval": 1, "evaluation_duration": 20, "evaluation_duration_unit": "episodes", "evaluation_sample_timeout_s": 120.0, "evaluation_auto_duration_min_env_steps_per_sample": 100, "evaluation_auto_duration_max_env_steps_per_sample": 2000, "evaluation_parallel_to_training": false, "evaluation_force_reset_envs_before_iteration": true, "evaluation_config": null, "off_policy_estimation_methods": {}, "ope_split_batch_by_episode": true, "evaluation_num_env_runners": 1, "in_evaluation": false, "sync_filters_on_rollout_workers_timeout_s": 10.0, "offline_evaluation_interval": null, "num_offline_eval_runners": 0, "offline_loss_for_module_fn": null, "offline_evaluation_duration": 1, "offline_evaluation_parallel_to_training": false, "offline_evaluation_timeout_s": 120.0, "num_cpus_per_offline_eval_runner": 1, "num_gpus_per_offline_eval_runner": 0, "custom_resources_per_offline_eval_runner": {}, "restart_failed_offline_eval_runners": true, "ignore_offline_eval_runner_failures": false, "max_num_offline_eval_runner_restarts": 1000, "offline_eval_runner_restore_timeout_s": 1800.0, "max_requests_in_flight_per_offline_eval_runner": 1, "validate_offline_eval_runners_after_construction": true, "offline_eval_runner_health_probe_timeout_s": 30.0, "offline_eval_rl_module_inference_only": false, "broadcast_offline_eval_runner_states": false, "offline_eval_batch_size_per_runner": 256, "dataset_num_iters_per_eval_runner": 1, "keep_per_episode_custom_metrics": false, "metrics_episode_collection_timeout_s": 60.0, "metrics_num_episodes_for_smoothing": 100, "min_time_s_per_iteration": null, "min_train_timesteps_per_iteration": 0, "min_sample_timesteps_per_iteration": 0, "log_gradients": true, "export_native_model_files": false, "checkpoint_trainable_policies_only": false, "logger_creator": null, "logger_config": null, "log_level": "WARN", "log_sys_usage": true, "fake_sampler": false, "seed": 9, "restart_failed_env_runners": true, "ignore_env_runner_failures": false, "max_num_env_runner_restarts": 1000, "delay_between_env_runner_restarts_s": 60.0, "restart_failed_sub_environments": false, "num_consecutive_env_runner_failures_tolerance": 100, "env_runner_health_probe_timeout_s": 30.0, "env_runner_restore_timeout_s": 1800.0, "_model_config": {}, "_rl_module_spec": "RLModuleSpec(module_class=None, observation_space=None, action_space=None, inference_only=False, learner_only=False, model_config=DefaultModelConfig(fcnet_hiddens=[60, 90], fcnet_activation='tanh', fcnet_kernel_initializer=None, fcnet_kernel_initializer_kwargs=None, fcnet_bias_initializer=None, fcnet_bias_initializer_kwargs=None, conv_filters=None, conv_activation='relu', conv_kernel_initializer=None, conv_kernel_initializer_kwargs=None, conv_bias_initializer=None, conv_bias_initializer_kwargs=None, head_fcnet_hiddens=[], head_fcnet_activation='relu', head_fcnet_kernel_initializer=None, head_fcnet_kernel_initializer_kwargs=None, head_fcnet_bias_initializer=None, head_fcnet_bias_initializer_kwargs=None, free_log_std=False, log_std_clip_param=20.0, vf_share_layers=True, use_lstm=False, max_seq_len=20, lstm_cell_size=256, lstm_use_prev_action=False, lstm_use_prev_reward=False, lstm_kernel_initializer=None, lstm_kernel_initializer_kwargs=None, lstm_bias_initializer=None, lstm_bias_initializer_kwargs=None), catalog_class=None, load_state_path=None, model_config_dict=None)", "algorithm_config_overrides_per_module": {}, "_per_module_overrides": {}, "_validate_config": true, "_use_msgpack_checkpoints": false, "_torch_grad_scaler_class": null, "_torch_lr_scheduler_classes": null, "_tf_policy_handles_more_than_one_loss": false, "_disable_preprocessor_api": false, "_disable_action_flattening": false, "_disable_initialize_loss_from_dummy_batch": false, "_dont_auto_sync_env_runner_states": false, "env_task_fn": -1, "enable_connectors": -1, "simple_optimizer": false, "policy_map_cache": -1, "worker_cls": -1, "synchronize_filters": -1, "enable_async_evaluation": -1, "custom_async_evaluation_function": -1, "_enable_rl_module_api": -1, "auto_wrap_old_gym_envs": -1, "always_attach_evaluation_results": -1, "replay_sequence_length": null, "_disable_execution_plan_api": -1, "use_critic": true, "use_gae": true, "use_kl_loss": true, "kl_coeff": 0.7464963036515, "kl_target": 0.0270990929592, "vf_loss_coeff": 0.6688075857018, "entropy_coeff": 0.0090570820258, "clip_param": 0.1221781641624, "vf_clip_param": 0.1027808522125, "entropy_coeff_schedule": null, "lr_schedule": null, "sgd_minibatch_size": -1, "vf_share_layers": -1, "__stdout_file__": null, "__stderr_file__": null, "lambda": 0.9099046732075, "input": "sampler", "policies": {"default_policy": [null, null, null, null]}, "callbacks": "<class 'ray.rllib.callbacks.callbacks.RLlibCallback'>", "create_env_on_driver": false, "custom_eval_function": null, "framework": "torch"}, "time_since_restore": 33.713473081588745, "iterations_since_restore": 19, "perf": {"cpu_util_percent": 42.79999999999999, "ram_util_percent": 80.0}}
{"timers": {"training_iteration": 1.8418109252424677, "restore_env_runners": 1.1115053305141706e-05, "training_step": 1.8416395250691278, "env_runner_sampling_timer": 1.7223005657191737, "learner_update_timer": 0.11598037568601084, "synch_weights": 0.0006387376484610182, "restore_eval_env_runners": 9.989674799172866e-06, "evaluation_iteration": 0.11068382976313788, "synch_eval_env_connectors": 0.00013939210663998643, "synch_env_connectors": 4.595507965704733e-06}, "env_runners": {"num_episodes_lifetime": -555250.0, "env_to_module_connector": {"connector_pipeline_timer": 4.412758063051356e-05, "timers": {"connectors": {"add_observations_from_episodes_to_batch": 2.980521104604146e-06, "add_time_dim_to_batch_and_zero_pad": 2.4392657377555273e-06, "batch_individual_items": 6.37765159976436e-06, "numpy_to_tensor": 8.769774083202221e-06, "add_states_from_episodes_to_batch": 1.7366493489279499e-06}}}, "num_episodes": 250.0, "env_step_timer": 1.3936063433788971e-05, "episode_len_min": 20, "num_agent_steps_sampled": {"default_agent": 5000.0}, "agent_episode_returns_mean": {"default_agent": 12.5}, "episode_return_mean": 12.5, "num_env_steps_sampled": 5000.0, "module_to_env_connector": {"timers": {"connectors": {"remove_single_ts_time_rank_from_batch": 5.865458940196311e-07, "un_batch_to_individual_items": 5.475291262034164e-06, "listify_data_for_vector_env": 1.110041965675457e-05, "normalize_and_clip_actions": 9.474456657617676e-06, "get_actions": 3.8460146512257026e-05, "tensor_to_numpy": 1.311033418069394e-05}}, "connector_pipeline_timer": 0.00010370863102092307}, "episode_duration_sec_mean": 0.004572760640643536, "sample": 0.004830442042654313, "num_module_steps_sampled_lifetime": {"default_policy": -11105000.0}, "env_reset_timer": 3.387325634929781e-05, "time_between_sampling": 0.0018285054203550676, "episode_len_max": 20, "weights_seq_no": 19.0, "num_env_steps_sampled_lifetime": -11105000.0, "env_to_module_sum_episodes_length_in": 10.36823839457432, "episode_len_mean": 20.0, "module_episode_returns_mean": {"default_policy": 12.5}, "episode_return_min": -5.5, "episode_return_max": 14.5, "num_agent_steps_sampled_lifetime": {"default_agent": -11105000.0}, "rlmodule_inference_timer": 2.7831509086489973e-05, "env_to_module_sum_episodes_length_out": 10.36823839457432, "num_module_steps_sampled": {"default_policy": 5000.0}, "num_env_steps_sampled_lifetime_throughput": 3713.083083933219}, "learners": {"default_policy": {"module_train_batch_size_mean": 1000.0, "vf_explained_var": 0.0011566877365112305, "num_module_steps_trained_lifetime": 120000, "entropy": 0.6000101566314697, "curr_kl_coeff": 7.119143674572115e-07, "vf_loss_unclipped": 38.9202995300293, "diff_num_grad_updates_vs_sampler_policy": 1.0, "default_optimizer_learning_rate": 0.0002847858517, "total_loss": 0.01072325836867094, "mean_kl_loss": 8.406594133703038e-05, "vf_loss": 0.10185357928276062, "gradients_default_optimizer_global_norm": 0.03812684118747711, "weights_seq_no": 20.0, "num_module_steps_trained": 6000, "policy_loss": -0.05196285992860794, "curr_entropy_coeff": 0.0090570820258, "num_trainable_parameters": 6003, "num_module_steps_trained_lifetime_throughput": 409768.93324852263}, "__all_modules__": {"num_module_steps_trained": 6000, "num_trainable_parameters": 6003, "learner_connector_sum_episodes_length_in": 5000.0, "num_env_steps_trained": 31500, "learner_connector": {"timers": {"connectors": {"batch_individual_items": 0.03760426806718907, "numpy_to_tensor": 0.00013916294720041144, "add_states_from_episodes_to_batch": 3.525109662756892e-06, "add_observations_from_episodes_to_batch": 0.0008121481618536333, "add_columns_from_episodes_to_train_batch": 0.03486365418866199, "add_time_dim_to_batch_and_zero_pad": 1.5569125152290162e-05, "add_one_ts_to_episodes_and_truncate": 0.008735495617881655, "general_advantage_estimation": 0.007615865755356518}}, "connector_pipeline_timer": 0.08995710403603877}, "num_module_steps_trained_lifetime": 120000, "learner_connector_sum_episodes_length_out": 5250.0, "num_env_steps_trained_lifetime": 630000, "num_non_trainable_parameters": 0, "num_env_steps_trained_lifetime_throughput": 2130062.5903343675, "num_module_steps_trained_throughput": 407425.48262041825, "num_module_steps_trained_lifetime_throughput": 406671.7589297113}}, "num_training_step_calls_per_iteration": 1, "evaluation": {"env_runners": {"num_env_steps_sampled": 400, "env_to_module_connector": {"timers": {"connectors": {"add_states_from_episodes_to_batch": 1.6589378931129074e-06, "add_observations_from_episodes_to_batch": 3.227362834426876e-06, "add_time_dim_to_batch_and_zero_pad": 2.849857379653618e-06, "batch_individual_items": 6.515324378241383e-06, "numpy_to_tensor": 9.249913893652453e-06}}, "connector_pipeline_timer": 4.709673829611525e-05}, "episode_len_max": 20, "num_module_steps_sampled_lifetime": {"default_policy": 8000}, "rlmodule_inference_timer": 3.266874052315699e-05, "env_to_module_sum_episodes_length_out": 10.368238394574323, "module_to_env_connector": {"connector_pipeline_timer": 0.00011611835914705578, "timers": {"connectors": {"tensor_to_numpy": 1.3939444267391758e-05, "listify_data_for_vector_env": 1.2321692739485344e-05, "get_actions": 4.4511032606995664e-05, "normalize_and_clip_actions": 1.0326876602688901e-05, "remove_single_ts_time_rank_from_batch": 7.068246583497722e-07, "un_batch_to_individual_items": 5.9317193415066825e-06}}}, "episode_len_min": 20, "env_reset_timer": 0.00019044164300954905, "episode_return_max": 15.5, "num_episodes_lifetime": 400, "num_episodes": 20, "episode_return_mean": 2.1, "num_module_steps_sampled": {"default_policy": 400}, "episode_duration_sec_mean": 0.00474504753947258, "sample": 0.10144702096474195, "weights_seq_no": 20.0, "module_episode_returns_mean": {"default_policy": 2.1}, "num_agent_steps_sampled_lifetime": {"default_agent": 8000}, "env_step_timer": 1.589957562035089e-05, "num_agent_steps_sampled": {"default_agent": 400}, "agent_episode_returns_mean": {"default_agent": 2.1}, "num_env_steps_sampled_lifetime": 100400, "env_to_module_sum_episodes_length_in": 10.368238394574323, "episode_len_mean": 20.0, "episode_return_min": -13.5, "time_between_sampling": 1.6477114321689006}, "num_healthy_workers": 1, "actor_manager_num_outstanding_async_reqs": 0, "num_remote_worker_restarts": 0}, "num_env_steps_sampled_lifetime": -11105000.0, "fault_tolerance": {"num_healthy_workers": 0, "num_remote_worker_restarts": 0}, "env_runner_group": {"actor_manager_num_outstanding_async_reqs": 0}, "done": true, "training_iteration": 20, "trial_id": "4d67b_00000", "date": "2025-08-11_19-22-53", "timestamp": 1754932973, "time_this_iter_s": 1.6119489669799805, "time_total_s": 35.325422048568726, "pid": 14356, "hostname": "Mac", "node_ip": "127.0.0.1", "config": {"exploration_config": {}, "extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "placement_strategy": "PACK", "num_gpus": 0, "_fake_gpus": false, "num_cpus_for_main_process": 2, "eager_tracing": true, "eager_max_retraces": 20, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "torch_compile_learner": false, "torch_compile_learner_what_to_compile": "forward_train", "torch_compile_learner_dynamo_backend": "aot_eager", "torch_compile_learner_dynamo_mode": null, "torch_compile_worker": false, "torch_compile_worker_dynamo_backend": "aot_eager", "torch_compile_worker_dynamo_mode": null, "torch_ddp_kwargs": {}, "torch_skip_nan_gradients": false, "env": "Umbrella", "env_config": {}, "observation_space": null, "action_space": null, "clip_rewards": null, "normalize_actions": true, "clip_actions": false, "_is_atari": null, "disable_env_checking": false, "render_env": false, "action_mask_key": "action_mask", "env_runner_cls": null, "num_env_runners": 0, "create_local_env_runner": true, "num_envs_per_env_runner": 1, "gym_env_vectorize_mode": "SYNC", "num_cpus_per_env_runner": 1, "num_gpus_per_env_runner": 0, "custom_resources_per_env_runner": {}, "validate_env_runners_after_construction": true, "episodes_to_numpy": true, "max_requests_in_flight_per_env_runner": 1, "sample_timeout_s": 60.0, "_env_to_module_connector": null, "add_default_connectors_to_env_to_module_pipeline": true, "_module_to_env_connector": null, "add_default_connectors_to_module_to_env_pipeline": true, "merge_env_runner_states": "training_only", "broadcast_env_runner_states": true, "episode_lookback_horizon": 1, "rollout_fragment_length": "auto", "batch_mode": "complete_episodes", "compress_observations": false, "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "enable_tf1_exec_eagerly": false, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "preprocessor_pref": "deepmind", "observation_filter": "NoFilter", "update_worker_filter_stats": true, "use_worker_filter_stats": true, "sampler_perf_stats_ema_coef": null, "_is_online": true, "num_learners": 0, "num_gpus_per_learner": 0, "num_cpus_per_learner": "auto", "num_aggregator_actors_per_learner": 0, "max_requests_in_flight_per_aggregator_actor": 3, "local_gpu_idx": 0, "max_requests_in_flight_per_learner": 3, "gamma": 1, "lr": 0.0002847858517, "grad_clip": 0.5, "grad_clip_by": "global_norm", "_train_batch_size_per_learner": 5000, "train_batch_size": 4000, "num_epochs": 1, "minibatch_size": 1000, "shuffle_batch_per_epoch": true, "model": {"fcnet_hiddens": [256, 256], "fcnet_activation": "tanh", "fcnet_weights_initializer": null, "fcnet_weights_initializer_config": null, "fcnet_bias_initializer": null, "fcnet_bias_initializer_config": null, "conv_filters": null, "conv_activation": "relu", "conv_kernel_initializer": null, "conv_kernel_initializer_config": null, "conv_bias_initializer": null, "conv_bias_initializer_config": null, "conv_transpose_kernel_initializer": null, "conv_transpose_kernel_initializer_config": null, "conv_transpose_bias_initializer": null, "conv_transpose_bias_initializer_config": null, "post_fcnet_hiddens": [], "post_fcnet_activation": "relu", "post_fcnet_weights_initializer": null, "post_fcnet_weights_initializer_config": null, "post_fcnet_bias_initializer": null, "post_fcnet_bias_initializer_config": null, "free_log_std": false, "log_std_clip_param": 20.0, "no_final_linear": false, "vf_share_layers": false, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "lstm_weights_initializer": null, "lstm_weights_initializer_config": null, "lstm_bias_initializer": null, "lstm_bias_initializer_config": null, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "attention_use_n_prev_actions": 0, "attention_use_n_prev_rewards": 0, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": null, "custom_model_config": {}, "custom_action_dist": null, "custom_preprocessor": null, "encoder_latent_dim": null, "always_check_shapes": false, "lstm_use_prev_action_reward": -1, "_use_default_native_models": -1, "_disable_preprocessor_api": false, "_disable_action_flattening": false}, "_learner_connector": null, "add_default_connectors_to_learner_pipeline": true, "learner_config_dict": {}, "optimizer": {}, "_learner_class": null, "callbacks_on_algorithm_init": null, "callbacks_on_env_runners_recreated": null, "callbacks_on_offline_eval_runners_recreated": null, "callbacks_on_checkpoint_loaded": null, "callbacks_on_environment_created": null, "callbacks_on_episode_created": null, "callbacks_on_episode_start": null, "callbacks_on_episode_step": null, "callbacks_on_episode_end": null, "callbacks_on_evaluate_start": null, "callbacks_on_evaluate_end": null, "callbacks_on_evaluate_offline_start": null, "callbacks_on_evaluate_offline_end": null, "callbacks_on_sample_end": null, "callbacks_on_train_result": null, "explore": true, "enable_rl_module_and_learner": true, "enable_env_runner_and_connector_v2": true, "_prior_exploration_config": {"type": "StochasticSampling"}, "count_steps_by": "env_steps", "policy_map_capacity": 100, "policy_mapping_fn": "<function AlgorithmConfig.DEFAULT_POLICY_MAPPING_FN at 0x385aedb20>", "policies_to_train": null, "policy_states_are_swappable": false, "observation_fn": null, "offline_data_class": null, "input_read_method": "read_parquet", "input_read_method_kwargs": {}, "input_read_schema": {}, "input_read_episodes": false, "input_read_sample_batches": false, "input_read_batch_size": null, "input_filesystem": null, "input_filesystem_kwargs": {}, "input_compress_columns": ["obs", "new_obs"], "input_spaces_jsonable": true, "materialize_data": false, "materialize_mapped_data": true, "map_batches_kwargs": {}, "iter_batches_kwargs": {}, "ignore_final_observation": false, "prelearner_class": null, "prelearner_buffer_class": null, "prelearner_buffer_kwargs": {}, "prelearner_module_synch_period": 10, "dataset_num_iters_per_learner": null, "input_config": {}, "actions_in_input_normalized": false, "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_config": {}, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "output_max_rows_per_file": null, "output_write_remaining_data": false, "output_write_method": "write_parquet", "output_write_method_kwargs": {}, "output_filesystem": null, "output_filesystem_kwargs": {}, "output_write_episodes": true, "offline_sampling": false, "evaluation_interval": 1, "evaluation_duration": 20, "evaluation_duration_unit": "episodes", "evaluation_sample_timeout_s": 120.0, "evaluation_auto_duration_min_env_steps_per_sample": 100, "evaluation_auto_duration_max_env_steps_per_sample": 2000, "evaluation_parallel_to_training": false, "evaluation_force_reset_envs_before_iteration": true, "evaluation_config": null, "off_policy_estimation_methods": {}, "ope_split_batch_by_episode": true, "evaluation_num_env_runners": 1, "in_evaluation": false, "sync_filters_on_rollout_workers_timeout_s": 10.0, "offline_evaluation_interval": null, "num_offline_eval_runners": 0, "offline_loss_for_module_fn": null, "offline_evaluation_duration": 1, "offline_evaluation_parallel_to_training": false, "offline_evaluation_timeout_s": 120.0, "num_cpus_per_offline_eval_runner": 1, "num_gpus_per_offline_eval_runner": 0, "custom_resources_per_offline_eval_runner": {}, "restart_failed_offline_eval_runners": true, "ignore_offline_eval_runner_failures": false, "max_num_offline_eval_runner_restarts": 1000, "offline_eval_runner_restore_timeout_s": 1800.0, "max_requests_in_flight_per_offline_eval_runner": 1, "validate_offline_eval_runners_after_construction": true, "offline_eval_runner_health_probe_timeout_s": 30.0, "offline_eval_rl_module_inference_only": false, "broadcast_offline_eval_runner_states": false, "offline_eval_batch_size_per_runner": 256, "dataset_num_iters_per_eval_runner": 1, "keep_per_episode_custom_metrics": false, "metrics_episode_collection_timeout_s": 60.0, "metrics_num_episodes_for_smoothing": 100, "min_time_s_per_iteration": null, "min_train_timesteps_per_iteration": 0, "min_sample_timesteps_per_iteration": 0, "log_gradients": true, "export_native_model_files": false, "checkpoint_trainable_policies_only": false, "logger_creator": null, "logger_config": null, "log_level": "WARN", "log_sys_usage": true, "fake_sampler": false, "seed": 9, "restart_failed_env_runners": true, "ignore_env_runner_failures": false, "max_num_env_runner_restarts": 1000, "delay_between_env_runner_restarts_s": 60.0, "restart_failed_sub_environments": false, "num_consecutive_env_runner_failures_tolerance": 100, "env_runner_health_probe_timeout_s": 30.0, "env_runner_restore_timeout_s": 1800.0, "_model_config": {}, "_rl_module_spec": "RLModuleSpec(module_class=None, observation_space=None, action_space=None, inference_only=False, learner_only=False, model_config=DefaultModelConfig(fcnet_hiddens=[60, 90], fcnet_activation='tanh', fcnet_kernel_initializer=None, fcnet_kernel_initializer_kwargs=None, fcnet_bias_initializer=None, fcnet_bias_initializer_kwargs=None, conv_filters=None, conv_activation='relu', conv_kernel_initializer=None, conv_kernel_initializer_kwargs=None, conv_bias_initializer=None, conv_bias_initializer_kwargs=None, head_fcnet_hiddens=[], head_fcnet_activation='relu', head_fcnet_kernel_initializer=None, head_fcnet_kernel_initializer_kwargs=None, head_fcnet_bias_initializer=None, head_fcnet_bias_initializer_kwargs=None, free_log_std=False, log_std_clip_param=20.0, vf_share_layers=True, use_lstm=False, max_seq_len=20, lstm_cell_size=256, lstm_use_prev_action=False, lstm_use_prev_reward=False, lstm_kernel_initializer=None, lstm_kernel_initializer_kwargs=None, lstm_bias_initializer=None, lstm_bias_initializer_kwargs=None), catalog_class=None, load_state_path=None, model_config_dict=None)", "algorithm_config_overrides_per_module": {}, "_per_module_overrides": {}, "_validate_config": true, "_use_msgpack_checkpoints": false, "_torch_grad_scaler_class": null, "_torch_lr_scheduler_classes": null, "_tf_policy_handles_more_than_one_loss": false, "_disable_preprocessor_api": false, "_disable_action_flattening": false, "_disable_initialize_loss_from_dummy_batch": false, "_dont_auto_sync_env_runner_states": false, "env_task_fn": -1, "enable_connectors": -1, "simple_optimizer": false, "policy_map_cache": -1, "worker_cls": -1, "synchronize_filters": -1, "enable_async_evaluation": -1, "custom_async_evaluation_function": -1, "_enable_rl_module_api": -1, "auto_wrap_old_gym_envs": -1, "always_attach_evaluation_results": -1, "replay_sequence_length": null, "_disable_execution_plan_api": -1, "use_critic": true, "use_gae": true, "use_kl_loss": true, "kl_coeff": 0.7464963036515, "kl_target": 0.0270990929592, "vf_loss_coeff": 0.6688075857018, "entropy_coeff": 0.0090570820258, "clip_param": 0.1221781641624, "vf_clip_param": 0.1027808522125, "entropy_coeff_schedule": null, "lr_schedule": null, "sgd_minibatch_size": -1, "vf_share_layers": -1, "__stdout_file__": null, "__stderr_file__": null, "lambda": 0.9099046732075, "input": "sampler", "policies": {"default_policy": [null, null, null, null]}, "callbacks": "<class 'ray.rllib.callbacks.callbacks.RLlibCallback'>", "create_env_on_driver": false, "custom_eval_function": null, "framework": "torch"}, "time_since_restore": 35.325422048568726, "iterations_since_restore": 20, "perf": {"cpu_util_percent": 44.650000000000006, "ram_util_percent": 79.4}}
