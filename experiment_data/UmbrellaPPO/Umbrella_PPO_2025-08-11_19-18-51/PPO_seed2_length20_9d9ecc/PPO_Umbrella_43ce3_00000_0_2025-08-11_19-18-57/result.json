{"timers": {"training_iteration": 1.6041405410505831, "restore_env_runners": 9.832903742790222e-06, "training_step": 1.6040123749990016, "env_runner_sampling_timer": 1.495350499986671, "learner_update_timer": 0.10576216701883823, "synch_weights": 0.0005501249106600881}, "env_runners": {"weights_seq_no": 0.0, "num_agent_steps_sampled": {"default_agent": 5000.0}, "env_to_module_connector": {"timers": {"connectors": {"numpy_to_tensor": 9.291462679165075e-06, "add_states_from_episodes_to_batch": 1.7445000900600761e-06, "batch_individual_items": 6.4351351479865276e-06, "add_time_dim_to_batch_and_zero_pad": 2.4783240227469176e-06, "add_observations_from_episodes_to_batch": 3.3754226198464924e-06}}, "connector_pipeline_timer": 4.678461046542185e-05}, "module_to_env_connector": {"timers": {"connectors": {"listify_data_for_vector_env": 1.1386758212670406e-05, "tensor_to_numpy": 1.3718723898780708e-05, "remove_single_ts_time_rank_from_batch": 6.084443127157515e-07, "un_batch_to_individual_items": 5.523168644769581e-06, "get_actions": 4.396410828256872e-05, "normalize_and_clip_actions": 1.2653194555438872e-05}}, "connector_pipeline_timer": 0.0001141236642431486}, "agent_episode_returns_mean": {"default_agent": 0.8199999999999998}, "rlmodule_inference_timer": 5.124108114773854e-05, "module_episode_returns_mean": {"default_policy": 0.8199999999999998}, "num_episodes": 250.0, "episode_duration_sec_mean": 0.005005464995279909, "env_reset_timer": 8.28231564547796e-05, "num_agent_steps_sampled_lifetime": {"default_agent": 627500.0}, "episode_return_max": 8.5, "sample": 0.005659945474590357, "num_module_steps_sampled": {"default_policy": 5000.0}, "num_env_steps_sampled": 5000.0, "episode_return_min": -11.5, "env_to_module_sum_episodes_length_out": 10.191744832559449, "num_episodes_lifetime": 31375.0, "episode_len_mean": 20.0, "time_between_sampling": 0.0005180218557142094, "episode_len_max": 20, "env_to_module_sum_episodes_length_in": 10.191744832559449, "num_env_steps_sampled_lifetime": 627500.0, "env_step_timer": 1.481703308303365e-05, "num_module_steps_sampled_lifetime": {"default_policy": 627500.0}, "episode_len_min": 20, "episode_return_mean": 0.8199999999999998, "num_env_steps_sampled_lifetime_throughput": 3441.4488852113313}, "learners": {"default_policy": {"vf_loss": 0.10278083384037018, "num_module_steps_trained": 6000, "entropy": 0.6600642800331116, "gradients_default_optimizer_global_norm": 0.07857398688793182, "curr_kl_coeff": 0.3732481598854065, "vf_loss_unclipped": 28.039243698120117, "diff_num_grad_updates_vs_sampler_policy": 1.0, "vf_explained_var": -0.009175658226013184, "default_optimizer_learning_rate": 0.0002847858517, "total_loss": -0.2051759511232376, "num_module_steps_trained_lifetime": 6000, "num_trainable_parameters": 6003, "module_train_batch_size_mean": 1000.0, "curr_entropy_coeff": 0.0090570820258, "mean_kl_loss": 0.00025177394854836166, "weights_seq_no": 1.0, "policy_loss": -0.2681262493133545, "num_module_steps_trained_lifetime_throughput": 430740.1929922453}, "__all_modules__": {"num_non_trainable_parameters": 0, "num_module_steps_trained_lifetime": 6000, "num_trainable_parameters": 6003, "learner_connector": {"connector_pipeline_timer": 0.08022666606120765, "timers": {"connectors": {"add_columns_from_episodes_to_train_batch": 0.033777124946936965, "add_time_dim_to_batch_and_zero_pad": 1.258309930562973e-05, "add_observations_from_episodes_to_batch": 0.0008076250087469816, "batch_individual_items": 0.030334042035974562, "add_one_ts_to_episodes_and_truncate": 0.007443959009833634, "general_advantage_estimation": 0.007671082974411547, "numpy_to_tensor": 5.987496115267277e-05, "add_states_from_episodes_to_batch": 3.2499665394425392e-06}}}, "num_env_steps_trained_lifetime": 31500, "learner_connector_sum_episodes_length_out": 5250, "num_module_steps_trained": 6000, "learner_connector_sum_episodes_length_in": 5000, "num_env_steps_trained": 31500, "num_env_steps_trained_lifetime_throughput": 2246273.395030824, "num_module_steps_trained_throughput": 430062.0246612795, "num_module_steps_trained_lifetime_throughput": 429234.71154153923}}, "num_training_step_calls_per_iteration": 1, "num_env_steps_sampled_lifetime": 627500.0, "evaluation": {"env_runners": {"num_episodes": 20, "episode_return_max": 14.5, "agent_episode_returns_mean": {"default_agent": -2.2}, "env_to_module_connector": {"timers": {"connectors": {"numpy_to_tensor": 8.487143681314164e-06, "add_states_from_episodes_to_batch": 1.5778729768760745e-06, "add_time_dim_to_batch_and_zero_pad": 2.6337604148248422e-06, "add_observations_from_episodes_to_batch": 3.111040932625176e-06, "batch_individual_items": 6.2780028236660115e-06}}, "connector_pipeline_timer": 4.6000551539255544e-05}, "module_episode_returns_mean": {"default_policy": -2.2}, "num_env_steps_sampled": 400, "module_to_env_connector": {"timers": {"connectors": {"remove_single_ts_time_rank_from_batch": 5.701128391897842e-07, "un_batch_to_individual_items": 5.487294213151088e-06, "tensor_to_numpy": 1.638210126504153e-05, "normalize_and_clip_actions": 1.4420136838292302e-05, "listify_data_for_vector_env": 1.1199885891476105e-05, "get_actions": 5.591224840801849e-05}}, "connector_pipeline_timer": 0.00013007315770305778}, "num_module_steps_sampled": {"default_policy": 400}, "episode_len_mean": 20.0, "episode_len_min": 20, "rlmodule_inference_timer": 3.21119361696751e-05, "episode_duration_sec_mean": 0.00460391248925589, "sample": 0.10148441605269909, "num_agent_steps_sampled": {"default_agent": 400}, "env_to_module_sum_episodes_length_out": 10.216013141322508, "num_episodes_lifetime": 20, "episode_len_max": 20, "env_step_timer": 1.8164451403419273e-05, "episode_return_mean": -2.2, "env_reset_timer": 0.0005404159892350435, "episode_return_min": -14.5, "num_agent_steps_sampled_lifetime": {"default_agent": 400}, "env_to_module_sum_episodes_length_in": 10.216013141322508, "num_env_steps_sampled_lifetime": 5400, "weights_seq_no": 1.0, "num_module_steps_sampled_lifetime": {"default_policy": 400}}, "num_healthy_workers": 1, "actor_manager_num_outstanding_async_reqs": 0, "num_remote_worker_restarts": 0}, "fault_tolerance": {"num_healthy_workers": 0, "num_remote_worker_restarts": 0}, "env_runner_group": {"actor_manager_num_outstanding_async_reqs": 0}, "done": false, "training_iteration": 1, "trial_id": "43ce3_00000", "date": "2025-08-11_19-22-59", "timestamp": 1754932979, "time_this_iter_s": 1.7208590507507324, "time_total_s": 1.7208590507507324, "pid": 14399, "hostname": "Mac", "node_ip": "127.0.0.1", "config": {"exploration_config": {}, "extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "placement_strategy": "PACK", "num_gpus": 0, "_fake_gpus": false, "num_cpus_for_main_process": 2, "eager_tracing": true, "eager_max_retraces": 20, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "torch_compile_learner": false, "torch_compile_learner_what_to_compile": "forward_train", "torch_compile_learner_dynamo_backend": "aot_eager", "torch_compile_learner_dynamo_mode": null, "torch_compile_worker": false, "torch_compile_worker_dynamo_backend": "aot_eager", "torch_compile_worker_dynamo_mode": null, "torch_ddp_kwargs": {}, "torch_skip_nan_gradients": false, "env": "Umbrella", "env_config": {}, "observation_space": null, "action_space": null, "clip_rewards": null, "normalize_actions": true, "clip_actions": false, "_is_atari": null, "disable_env_checking": false, "render_env": false, "action_mask_key": "action_mask", "env_runner_cls": null, "num_env_runners": 0, "create_local_env_runner": true, "num_envs_per_env_runner": 1, "gym_env_vectorize_mode": "SYNC", "num_cpus_per_env_runner": 1, "num_gpus_per_env_runner": 0, "custom_resources_per_env_runner": {}, "validate_env_runners_after_construction": true, "episodes_to_numpy": true, "max_requests_in_flight_per_env_runner": 1, "sample_timeout_s": 60.0, "_env_to_module_connector": null, "add_default_connectors_to_env_to_module_pipeline": true, "_module_to_env_connector": null, "add_default_connectors_to_module_to_env_pipeline": true, "merge_env_runner_states": "training_only", "broadcast_env_runner_states": true, "episode_lookback_horizon": 1, "rollout_fragment_length": "auto", "batch_mode": "complete_episodes", "compress_observations": false, "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "enable_tf1_exec_eagerly": false, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "preprocessor_pref": "deepmind", "observation_filter": "NoFilter", "update_worker_filter_stats": true, "use_worker_filter_stats": true, "sampler_perf_stats_ema_coef": null, "_is_online": true, "num_learners": 0, "num_gpus_per_learner": 0, "num_cpus_per_learner": "auto", "num_aggregator_actors_per_learner": 0, "max_requests_in_flight_per_aggregator_actor": 3, "local_gpu_idx": 0, "max_requests_in_flight_per_learner": 3, "gamma": 1, "lr": 0.0002847858517, "grad_clip": 0.5, "grad_clip_by": "global_norm", "_train_batch_size_per_learner": 5000, "train_batch_size": 4000, "num_epochs": 1, "minibatch_size": 1000, "shuffle_batch_per_epoch": true, "model": {"fcnet_hiddens": [256, 256], "fcnet_activation": "tanh", "fcnet_weights_initializer": null, "fcnet_weights_initializer_config": null, "fcnet_bias_initializer": null, "fcnet_bias_initializer_config": null, "conv_filters": null, "conv_activation": "relu", "conv_kernel_initializer": null, "conv_kernel_initializer_config": null, "conv_bias_initializer": null, "conv_bias_initializer_config": null, "conv_transpose_kernel_initializer": null, "conv_transpose_kernel_initializer_config": null, "conv_transpose_bias_initializer": null, "conv_transpose_bias_initializer_config": null, "post_fcnet_hiddens": [], "post_fcnet_activation": "relu", "post_fcnet_weights_initializer": null, "post_fcnet_weights_initializer_config": null, "post_fcnet_bias_initializer": null, "post_fcnet_bias_initializer_config": null, "free_log_std": false, "log_std_clip_param": 20.0, "no_final_linear": false, "vf_share_layers": false, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "lstm_weights_initializer": null, "lstm_weights_initializer_config": null, "lstm_bias_initializer": null, "lstm_bias_initializer_config": null, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "attention_use_n_prev_actions": 0, "attention_use_n_prev_rewards": 0, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": null, "custom_model_config": {}, "custom_action_dist": null, "custom_preprocessor": null, "encoder_latent_dim": null, "always_check_shapes": false, "lstm_use_prev_action_reward": -1, "_use_default_native_models": -1, "_disable_preprocessor_api": false, "_disable_action_flattening": false}, "_learner_connector": null, "add_default_connectors_to_learner_pipeline": true, "learner_config_dict": {}, "optimizer": {}, "_learner_class": null, "callbacks_on_algorithm_init": null, "callbacks_on_env_runners_recreated": null, "callbacks_on_offline_eval_runners_recreated": null, "callbacks_on_checkpoint_loaded": null, "callbacks_on_environment_created": null, "callbacks_on_episode_created": null, "callbacks_on_episode_start": null, "callbacks_on_episode_step": null, "callbacks_on_episode_end": null, "callbacks_on_evaluate_start": null, "callbacks_on_evaluate_end": null, "callbacks_on_evaluate_offline_start": null, "callbacks_on_evaluate_offline_end": null, "callbacks_on_sample_end": null, "callbacks_on_train_result": null, "explore": true, "enable_rl_module_and_learner": true, "enable_env_runner_and_connector_v2": true, "_prior_exploration_config": {"type": "StochasticSampling"}, "count_steps_by": "env_steps", "policy_map_capacity": 100, "policy_mapping_fn": "<function AlgorithmConfig.DEFAULT_POLICY_MAPPING_FN at 0x388aedb20>", "policies_to_train": null, "policy_states_are_swappable": false, "observation_fn": null, "offline_data_class": null, "input_read_method": "read_parquet", "input_read_method_kwargs": {}, "input_read_schema": {}, "input_read_episodes": false, "input_read_sample_batches": false, "input_read_batch_size": null, "input_filesystem": null, "input_filesystem_kwargs": {}, "input_compress_columns": ["obs", "new_obs"], "input_spaces_jsonable": true, "materialize_data": false, "materialize_mapped_data": true, "map_batches_kwargs": {}, "iter_batches_kwargs": {}, "ignore_final_observation": false, "prelearner_class": null, "prelearner_buffer_class": null, "prelearner_buffer_kwargs": {}, "prelearner_module_synch_period": 10, "dataset_num_iters_per_learner": null, "input_config": {}, "actions_in_input_normalized": false, "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_config": {}, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "output_max_rows_per_file": null, "output_write_remaining_data": false, "output_write_method": "write_parquet", "output_write_method_kwargs": {}, "output_filesystem": null, "output_filesystem_kwargs": {}, "output_write_episodes": true, "offline_sampling": false, "evaluation_interval": 1, "evaluation_duration": 20, "evaluation_duration_unit": "episodes", "evaluation_sample_timeout_s": 120.0, "evaluation_auto_duration_min_env_steps_per_sample": 100, "evaluation_auto_duration_max_env_steps_per_sample": 2000, "evaluation_parallel_to_training": false, "evaluation_force_reset_envs_before_iteration": true, "evaluation_config": null, "off_policy_estimation_methods": {}, "ope_split_batch_by_episode": true, "evaluation_num_env_runners": 1, "in_evaluation": false, "sync_filters_on_rollout_workers_timeout_s": 10.0, "offline_evaluation_interval": null, "num_offline_eval_runners": 0, "offline_loss_for_module_fn": null, "offline_evaluation_duration": 1, "offline_evaluation_parallel_to_training": false, "offline_evaluation_timeout_s": 120.0, "num_cpus_per_offline_eval_runner": 1, "num_gpus_per_offline_eval_runner": 0, "custom_resources_per_offline_eval_runner": {}, "restart_failed_offline_eval_runners": true, "ignore_offline_eval_runner_failures": false, "max_num_offline_eval_runner_restarts": 1000, "offline_eval_runner_restore_timeout_s": 1800.0, "max_requests_in_flight_per_offline_eval_runner": 1, "validate_offline_eval_runners_after_construction": true, "offline_eval_runner_health_probe_timeout_s": 30.0, "offline_eval_rl_module_inference_only": false, "broadcast_offline_eval_runner_states": false, "offline_eval_batch_size_per_runner": 256, "dataset_num_iters_per_eval_runner": 1, "keep_per_episode_custom_metrics": false, "metrics_episode_collection_timeout_s": 60.0, "metrics_num_episodes_for_smoothing": 100, "min_time_s_per_iteration": null, "min_train_timesteps_per_iteration": 0, "min_sample_timesteps_per_iteration": 0, "log_gradients": true, "export_native_model_files": false, "checkpoint_trainable_policies_only": false, "logger_creator": null, "logger_config": null, "log_level": "WARN", "log_sys_usage": true, "fake_sampler": false, "seed": 2, "restart_failed_env_runners": true, "ignore_env_runner_failures": false, "max_num_env_runner_restarts": 1000, "delay_between_env_runner_restarts_s": 60.0, "restart_failed_sub_environments": false, "num_consecutive_env_runner_failures_tolerance": 100, "env_runner_health_probe_timeout_s": 30.0, "env_runner_restore_timeout_s": 1800.0, "_model_config": {}, "_rl_module_spec": "RLModuleSpec(module_class=None, observation_space=None, action_space=None, inference_only=False, learner_only=False, model_config=DefaultModelConfig(fcnet_hiddens=[60, 90], fcnet_activation='tanh', fcnet_kernel_initializer=None, fcnet_kernel_initializer_kwargs=None, fcnet_bias_initializer=None, fcnet_bias_initializer_kwargs=None, conv_filters=None, conv_activation='relu', conv_kernel_initializer=None, conv_kernel_initializer_kwargs=None, conv_bias_initializer=None, conv_bias_initializer_kwargs=None, head_fcnet_hiddens=[], head_fcnet_activation='relu', head_fcnet_kernel_initializer=None, head_fcnet_kernel_initializer_kwargs=None, head_fcnet_bias_initializer=None, head_fcnet_bias_initializer_kwargs=None, free_log_std=False, log_std_clip_param=20.0, vf_share_layers=True, use_lstm=False, max_seq_len=20, lstm_cell_size=256, lstm_use_prev_action=False, lstm_use_prev_reward=False, lstm_kernel_initializer=None, lstm_kernel_initializer_kwargs=None, lstm_bias_initializer=None, lstm_bias_initializer_kwargs=None), catalog_class=None, load_state_path=None, model_config_dict=None)", "algorithm_config_overrides_per_module": {}, "_per_module_overrides": {}, "_validate_config": true, "_use_msgpack_checkpoints": false, "_torch_grad_scaler_class": null, "_torch_lr_scheduler_classes": null, "_tf_policy_handles_more_than_one_loss": false, "_disable_preprocessor_api": false, "_disable_action_flattening": false, "_disable_initialize_loss_from_dummy_batch": false, "_dont_auto_sync_env_runner_states": false, "env_task_fn": -1, "enable_connectors": -1, "simple_optimizer": false, "policy_map_cache": -1, "worker_cls": -1, "synchronize_filters": -1, "enable_async_evaluation": -1, "custom_async_evaluation_function": -1, "_enable_rl_module_api": -1, "auto_wrap_old_gym_envs": -1, "always_attach_evaluation_results": -1, "replay_sequence_length": null, "_disable_execution_plan_api": -1, "use_critic": true, "use_gae": true, "use_kl_loss": true, "kl_coeff": 0.7464963036515, "kl_target": 0.0270990929592, "vf_loss_coeff": 0.6688075857018, "entropy_coeff": 0.0090570820258, "clip_param": 0.1221781641624, "vf_clip_param": 0.1027808522125, "entropy_coeff_schedule": null, "lr_schedule": null, "sgd_minibatch_size": -1, "vf_share_layers": -1, "__stdout_file__": null, "__stderr_file__": null, "lambda": 0.9099046732075, "input": "sampler", "policies": {"default_policy": [null, null, null, null]}, "callbacks": "<class 'ray.rllib.callbacks.callbacks.RLlibCallback'>", "create_env_on_driver": false, "custom_eval_function": null, "framework": "torch"}, "time_since_restore": 1.7208590507507324, "iterations_since_restore": 1, "perf": {"cpu_util_percent": 29.400000000000002, "ram_util_percent": 78.66666666666667}}
{"timers": {"training_iteration": 1.6037141877296381, "restore_env_runners": 9.799153776839375e-06, "training_step": 1.6035855295788497, "env_runner_sampling_timer": 1.4941961266566066, "learner_update_timer": 0.10648838784894905, "synch_weights": 0.0005500590719748289, "restore_eval_env_runners": 8.457922376692295e-06, "evaluation_iteration": 0.1150812910636887, "synch_eval_env_connectors": 0.0001128750154748559, "synch_env_connectors": 4.708999767899513e-06}, "env_runners": {"weights_seq_no": 1.0, "num_agent_steps_sampled": {"default_agent": 5000.0}, "env_to_module_connector": {"timers": {"connectors": {"numpy_to_tensor": 8.575713265016726e-06, "add_states_from_episodes_to_batch": 1.728468981907945e-06, "batch_individual_items": 6.1819558104603716e-06, "add_time_dim_to_batch_and_zero_pad": 2.3423986054028808e-06, "add_observations_from_episodes_to_batch": 2.902993354872862e-06}}, "connector_pipeline_timer": 4.3731594031730075e-05}, "module_to_env_connector": {"timers": {"connectors": {"listify_data_for_vector_env": 1.106606789646263e-05, "tensor_to_numpy": 1.320044529951918e-05, "remove_single_ts_time_rank_from_batch": 5.801590003902046e-07, "un_batch_to_individual_items": 5.312581738945358e-06, "get_actions": 3.8815912040511975e-05, "normalize_and_clip_actions": 9.400690690299223e-06}}, "connector_pipeline_timer": 0.00010451191164066318}, "agent_episode_returns_mean": {"default_agent": 1.2200000000000002}, "rlmodule_inference_timer": 2.7763715862687598e-05, "module_episode_returns_mean": {"default_policy": 1.2200000000000002}, "num_episodes": 250.0, "episode_duration_sec_mean": 0.004543336477130651, "env_reset_timer": 3.9644560123221725e-05, "num_agent_steps_sampled_lifetime": {"default_agent": 10000.0}, "episode_return_max": 8.5, "sample": 0.005249042525776201, "num_module_steps_sampled": {"default_policy": 5000.0}, "num_env_steps_sampled": 5000.0, "episode_return_min": -11.5, "env_to_module_sum_episodes_length_out": 10.36823839457432, "num_episodes_lifetime": 500.0, "episode_len_mean": 20.0, "time_between_sampling": 0.0015260839379008493, "episode_len_max": 20, "env_to_module_sum_episodes_length_in": 10.36823839457432, "num_env_steps_sampled_lifetime": 10000.0, "env_step_timer": 1.3672624347293889e-05, "num_module_steps_sampled_lifetime": {"default_policy": 10000.0}, "episode_len_min": 20, "episode_return_mean": 1.2200000000000002, "num_env_steps_sampled_lifetime_throughput": 3713.4024929238576}, "learners": {"default_policy": {"vf_loss": 0.10278083384037018, "num_module_steps_trained": 6000, "entropy": 0.6536862254142761, "gradients_default_optimizer_global_norm": 0.04126502946019173, "curr_kl_coeff": 0.18662407994270325, "vf_loss_unclipped": 28.439332962036133, "diff_num_grad_updates_vs_sampler_policy": 1.0, "vf_explained_var": -0.012158751487731934, "default_optimizer_learning_rate": 0.0002847858517, "total_loss": 0.05995207279920578, "num_module_steps_trained_lifetime": 12000, "num_trainable_parameters": 6003, "module_train_batch_size_mean": 1000.0, "curr_entropy_coeff": 0.0090570820258, "mean_kl_loss": 0.0004314855032134801, "weights_seq_no": 2.0, "policy_loss": -0.003029095707461238, "num_module_steps_trained_lifetime_throughput": 430914.8874664474}, "__all_modules__": {"num_non_trainable_parameters": 0, "num_module_steps_trained_lifetime": 12000, "num_trainable_parameters": 6003, "learner_connector": {"connector_pipeline_timer": 0.08107628274010495, "timers": {"connectors": {"add_columns_from_episodes_to_train_batch": 0.0337832720275037, "add_time_dim_to_batch_and_zero_pad": 1.2594348518177866e-05, "add_observations_from_episodes_to_batch": 0.0008074891683645546, "batch_individual_items": 0.03119978453614749, "add_one_ts_to_episodes_and_truncate": 0.0074450064997654405, "general_advantage_estimation": 0.007647898814175279, "numpy_to_tensor": 5.997413187287748e-05, "add_states_from_episodes_to_batch": 3.2595463562756774e-06}}}, "num_env_steps_trained_lifetime": 63000, "learner_connector_sum_episodes_length_out": 5250.0, "num_module_steps_trained": 6000, "learner_connector_sum_episodes_length_in": 5000.0, "num_env_steps_trained": 31500, "num_env_steps_trained_lifetime_throughput": 2247448.9832947445, "num_module_steps_trained_throughput": 430257.8378994814, "num_module_steps_trained_lifetime_throughput": 429439.62192759226}}, "num_training_step_calls_per_iteration": 1, "evaluation": {"env_runners": {"num_episodes": 20, "episode_return_max": 14.5, "agent_episode_returns_mean": {"default_agent": 0.3}, "env_to_module_connector": {"timers": {"connectors": {"numpy_to_tensor": 8.418799869983681e-06, "add_states_from_episodes_to_batch": 1.5746279638306956e-06, "add_time_dim_to_batch_and_zero_pad": 2.171425226797854e-06, "add_observations_from_episodes_to_batch": 2.8143069180991043e-06, "batch_individual_items": 6.1384804624400745e-06}}, "connector_pipeline_timer": 4.262682200860306e-05}, "module_episode_returns_mean": {"default_policy": 0.3}, "num_env_steps_sampled": 400, "module_to_env_connector": {"timers": {"connectors": {"remove_single_ts_time_rank_from_batch": 5.735797110537987e-07, "un_batch_to_individual_items": 5.323311429299206e-06, "tensor_to_numpy": 1.2924072570276604e-05, "normalize_and_clip_actions": 9.495464950307372e-06, "listify_data_for_vector_env": 1.094992712154106e-05, "get_actions": 3.549479570954215e-05}}, "connector_pipeline_timer": 0.00010039989088910442}, "num_module_steps_sampled": {"default_policy": 400}, "episode_len_mean": 20.0, "episode_len_min": 20, "rlmodule_inference_timer": 2.6507933944909066e-05, "episode_duration_sec_mean": 0.004536705196369439, "sample": 0.10144483980140648, "num_agent_steps_sampled": {"default_agent": 400}, "env_to_module_sum_episodes_length_out": 10.366003441359926, "num_episodes_lifetime": 40, "episode_len_max": 20, "env_step_timer": 1.424060650221908e-05, "episode_return_mean": 0.3, "env_reset_timer": 0.0005358568287920207, "episode_return_min": -14.5, "num_agent_steps_sampled_lifetime": {"default_agent": 800}, "env_to_module_sum_episodes_length_in": 10.366003441359926, "num_env_steps_sampled_lifetime": 10400, "weights_seq_no": 2.0, "num_module_steps_sampled_lifetime": {"default_policy": 800}, "time_between_sampling": 1.5933801250066608}, "num_healthy_workers": 1, "actor_manager_num_outstanding_async_reqs": 0, "num_remote_worker_restarts": 0}, "num_env_steps_sampled_lifetime": 10000.0, "fault_tolerance": {"num_healthy_workers": 0, "num_remote_worker_restarts": 0}, "env_runner_group": {"actor_manager_num_outstanding_async_reqs": 0}, "done": false, "training_iteration": 2, "trial_id": "43ce3_00000", "date": "2025-08-11_19-23-01", "timestamp": 1754932981, "time_this_iter_s": 1.666457176208496, "time_total_s": 3.3873162269592285, "pid": 14399, "hostname": "Mac", "node_ip": "127.0.0.1", "config": {"exploration_config": {}, "extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "placement_strategy": "PACK", "num_gpus": 0, "_fake_gpus": false, "num_cpus_for_main_process": 2, "eager_tracing": true, "eager_max_retraces": 20, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "torch_compile_learner": false, "torch_compile_learner_what_to_compile": "forward_train", "torch_compile_learner_dynamo_backend": "aot_eager", "torch_compile_learner_dynamo_mode": null, "torch_compile_worker": false, "torch_compile_worker_dynamo_backend": "aot_eager", "torch_compile_worker_dynamo_mode": null, "torch_ddp_kwargs": {}, "torch_skip_nan_gradients": false, "env": "Umbrella", "env_config": {}, "observation_space": null, "action_space": null, "clip_rewards": null, "normalize_actions": true, "clip_actions": false, "_is_atari": null, "disable_env_checking": false, "render_env": false, "action_mask_key": "action_mask", "env_runner_cls": null, "num_env_runners": 0, "create_local_env_runner": true, "num_envs_per_env_runner": 1, "gym_env_vectorize_mode": "SYNC", "num_cpus_per_env_runner": 1, "num_gpus_per_env_runner": 0, "custom_resources_per_env_runner": {}, "validate_env_runners_after_construction": true, "episodes_to_numpy": true, "max_requests_in_flight_per_env_runner": 1, "sample_timeout_s": 60.0, "_env_to_module_connector": null, "add_default_connectors_to_env_to_module_pipeline": true, "_module_to_env_connector": null, "add_default_connectors_to_module_to_env_pipeline": true, "merge_env_runner_states": "training_only", "broadcast_env_runner_states": true, "episode_lookback_horizon": 1, "rollout_fragment_length": "auto", "batch_mode": "complete_episodes", "compress_observations": false, "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "enable_tf1_exec_eagerly": false, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "preprocessor_pref": "deepmind", "observation_filter": "NoFilter", "update_worker_filter_stats": true, "use_worker_filter_stats": true, "sampler_perf_stats_ema_coef": null, "_is_online": true, "num_learners": 0, "num_gpus_per_learner": 0, "num_cpus_per_learner": "auto", "num_aggregator_actors_per_learner": 0, "max_requests_in_flight_per_aggregator_actor": 3, "local_gpu_idx": 0, "max_requests_in_flight_per_learner": 3, "gamma": 1, "lr": 0.0002847858517, "grad_clip": 0.5, "grad_clip_by": "global_norm", "_train_batch_size_per_learner": 5000, "train_batch_size": 4000, "num_epochs": 1, "minibatch_size": 1000, "shuffle_batch_per_epoch": true, "model": {"fcnet_hiddens": [256, 256], "fcnet_activation": "tanh", "fcnet_weights_initializer": null, "fcnet_weights_initializer_config": null, "fcnet_bias_initializer": null, "fcnet_bias_initializer_config": null, "conv_filters": null, "conv_activation": "relu", "conv_kernel_initializer": null, "conv_kernel_initializer_config": null, "conv_bias_initializer": null, "conv_bias_initializer_config": null, "conv_transpose_kernel_initializer": null, "conv_transpose_kernel_initializer_config": null, "conv_transpose_bias_initializer": null, "conv_transpose_bias_initializer_config": null, "post_fcnet_hiddens": [], "post_fcnet_activation": "relu", "post_fcnet_weights_initializer": null, "post_fcnet_weights_initializer_config": null, "post_fcnet_bias_initializer": null, "post_fcnet_bias_initializer_config": null, "free_log_std": false, "log_std_clip_param": 20.0, "no_final_linear": false, "vf_share_layers": false, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "lstm_weights_initializer": null, "lstm_weights_initializer_config": null, "lstm_bias_initializer": null, "lstm_bias_initializer_config": null, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "attention_use_n_prev_actions": 0, "attention_use_n_prev_rewards": 0, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": null, "custom_model_config": {}, "custom_action_dist": null, "custom_preprocessor": null, "encoder_latent_dim": null, "always_check_shapes": false, "lstm_use_prev_action_reward": -1, "_use_default_native_models": -1, "_disable_preprocessor_api": false, "_disable_action_flattening": false}, "_learner_connector": null, "add_default_connectors_to_learner_pipeline": true, "learner_config_dict": {}, "optimizer": {}, "_learner_class": null, "callbacks_on_algorithm_init": null, "callbacks_on_env_runners_recreated": null, "callbacks_on_offline_eval_runners_recreated": null, "callbacks_on_checkpoint_loaded": null, "callbacks_on_environment_created": null, "callbacks_on_episode_created": null, "callbacks_on_episode_start": null, "callbacks_on_episode_step": null, "callbacks_on_episode_end": null, "callbacks_on_evaluate_start": null, "callbacks_on_evaluate_end": null, "callbacks_on_evaluate_offline_start": null, "callbacks_on_evaluate_offline_end": null, "callbacks_on_sample_end": null, "callbacks_on_train_result": null, "explore": true, "enable_rl_module_and_learner": true, "enable_env_runner_and_connector_v2": true, "_prior_exploration_config": {"type": "StochasticSampling"}, "count_steps_by": "env_steps", "policy_map_capacity": 100, "policy_mapping_fn": "<function AlgorithmConfig.DEFAULT_POLICY_MAPPING_FN at 0x388aedb20>", "policies_to_train": null, "policy_states_are_swappable": false, "observation_fn": null, "offline_data_class": null, "input_read_method": "read_parquet", "input_read_method_kwargs": {}, "input_read_schema": {}, "input_read_episodes": false, "input_read_sample_batches": false, "input_read_batch_size": null, "input_filesystem": null, "input_filesystem_kwargs": {}, "input_compress_columns": ["obs", "new_obs"], "input_spaces_jsonable": true, "materialize_data": false, "materialize_mapped_data": true, "map_batches_kwargs": {}, "iter_batches_kwargs": {}, "ignore_final_observation": false, "prelearner_class": null, "prelearner_buffer_class": null, "prelearner_buffer_kwargs": {}, "prelearner_module_synch_period": 10, "dataset_num_iters_per_learner": null, "input_config": {}, "actions_in_input_normalized": false, "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_config": {}, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "output_max_rows_per_file": null, "output_write_remaining_data": false, "output_write_method": "write_parquet", "output_write_method_kwargs": {}, "output_filesystem": null, "output_filesystem_kwargs": {}, "output_write_episodes": true, "offline_sampling": false, "evaluation_interval": 1, "evaluation_duration": 20, "evaluation_duration_unit": "episodes", "evaluation_sample_timeout_s": 120.0, "evaluation_auto_duration_min_env_steps_per_sample": 100, "evaluation_auto_duration_max_env_steps_per_sample": 2000, "evaluation_parallel_to_training": false, "evaluation_force_reset_envs_before_iteration": true, "evaluation_config": null, "off_policy_estimation_methods": {}, "ope_split_batch_by_episode": true, "evaluation_num_env_runners": 1, "in_evaluation": false, "sync_filters_on_rollout_workers_timeout_s": 10.0, "offline_evaluation_interval": null, "num_offline_eval_runners": 0, "offline_loss_for_module_fn": null, "offline_evaluation_duration": 1, "offline_evaluation_parallel_to_training": false, "offline_evaluation_timeout_s": 120.0, "num_cpus_per_offline_eval_runner": 1, "num_gpus_per_offline_eval_runner": 0, "custom_resources_per_offline_eval_runner": {}, "restart_failed_offline_eval_runners": true, "ignore_offline_eval_runner_failures": false, "max_num_offline_eval_runner_restarts": 1000, "offline_eval_runner_restore_timeout_s": 1800.0, "max_requests_in_flight_per_offline_eval_runner": 1, "validate_offline_eval_runners_after_construction": true, "offline_eval_runner_health_probe_timeout_s": 30.0, "offline_eval_rl_module_inference_only": false, "broadcast_offline_eval_runner_states": false, "offline_eval_batch_size_per_runner": 256, "dataset_num_iters_per_eval_runner": 1, "keep_per_episode_custom_metrics": false, "metrics_episode_collection_timeout_s": 60.0, "metrics_num_episodes_for_smoothing": 100, "min_time_s_per_iteration": null, "min_train_timesteps_per_iteration": 0, "min_sample_timesteps_per_iteration": 0, "log_gradients": true, "export_native_model_files": false, "checkpoint_trainable_policies_only": false, "logger_creator": null, "logger_config": null, "log_level": "WARN", "log_sys_usage": true, "fake_sampler": false, "seed": 2, "restart_failed_env_runners": true, "ignore_env_runner_failures": false, "max_num_env_runner_restarts": 1000, "delay_between_env_runner_restarts_s": 60.0, "restart_failed_sub_environments": false, "num_consecutive_env_runner_failures_tolerance": 100, "env_runner_health_probe_timeout_s": 30.0, "env_runner_restore_timeout_s": 1800.0, "_model_config": {}, "_rl_module_spec": "RLModuleSpec(module_class=None, observation_space=None, action_space=None, inference_only=False, learner_only=False, model_config=DefaultModelConfig(fcnet_hiddens=[60, 90], fcnet_activation='tanh', fcnet_kernel_initializer=None, fcnet_kernel_initializer_kwargs=None, fcnet_bias_initializer=None, fcnet_bias_initializer_kwargs=None, conv_filters=None, conv_activation='relu', conv_kernel_initializer=None, conv_kernel_initializer_kwargs=None, conv_bias_initializer=None, conv_bias_initializer_kwargs=None, head_fcnet_hiddens=[], head_fcnet_activation='relu', head_fcnet_kernel_initializer=None, head_fcnet_kernel_initializer_kwargs=None, head_fcnet_bias_initializer=None, head_fcnet_bias_initializer_kwargs=None, free_log_std=False, log_std_clip_param=20.0, vf_share_layers=True, use_lstm=False, max_seq_len=20, lstm_cell_size=256, lstm_use_prev_action=False, lstm_use_prev_reward=False, lstm_kernel_initializer=None, lstm_kernel_initializer_kwargs=None, lstm_bias_initializer=None, lstm_bias_initializer_kwargs=None), catalog_class=None, load_state_path=None, model_config_dict=None)", "algorithm_config_overrides_per_module": {}, "_per_module_overrides": {}, "_validate_config": true, "_use_msgpack_checkpoints": false, "_torch_grad_scaler_class": null, "_torch_lr_scheduler_classes": null, "_tf_policy_handles_more_than_one_loss": false, "_disable_preprocessor_api": false, "_disable_action_flattening": false, "_disable_initialize_loss_from_dummy_batch": false, "_dont_auto_sync_env_runner_states": false, "env_task_fn": -1, "enable_connectors": -1, "simple_optimizer": false, "policy_map_cache": -1, "worker_cls": -1, "synchronize_filters": -1, "enable_async_evaluation": -1, "custom_async_evaluation_function": -1, "_enable_rl_module_api": -1, "auto_wrap_old_gym_envs": -1, "always_attach_evaluation_results": -1, "replay_sequence_length": null, "_disable_execution_plan_api": -1, "use_critic": true, "use_gae": true, "use_kl_loss": true, "kl_coeff": 0.7464963036515, "kl_target": 0.0270990929592, "vf_loss_coeff": 0.6688075857018, "entropy_coeff": 0.0090570820258, "clip_param": 0.1221781641624, "vf_clip_param": 0.1027808522125, "entropy_coeff_schedule": null, "lr_schedule": null, "sgd_minibatch_size": -1, "vf_share_layers": -1, "__stdout_file__": null, "__stderr_file__": null, "lambda": 0.9099046732075, "input": "sampler", "policies": {"default_policy": [null, null, null, null]}, "callbacks": "<class 'ray.rllib.callbacks.callbacks.RLlibCallback'>", "create_env_on_driver": false, "custom_eval_function": null, "framework": "torch"}, "time_since_restore": 3.3873162269592285, "iterations_since_restore": 2, "perf": {"cpu_util_percent": 41.45, "ram_util_percent": 78.7}}
{"timers": {"training_iteration": 1.602642419601488, "restore_env_runners": 9.79074266506359e-06, "training_step": 1.6025124276222662, "env_runner_sampling_timer": 1.4932579362199174, "learner_update_timer": 0.10635009854981908, "synch_weights": 0.0005517847318551503, "restore_eval_env_runners": 8.451263420283795e-06, "evaluation_iteration": 0.11496010857285001, "synch_eval_env_connectors": 0.00011277667479589582, "synch_env_connectors": 4.716078983619809e-06}, "env_runners": {"weights_seq_no": 2.0, "num_agent_steps_sampled": {"default_agent": 5000.0}, "env_to_module_connector": {"timers": {"connectors": {"numpy_to_tensor": 8.596884529273555e-06, "add_states_from_episodes_to_batch": 1.7409300355478234e-06, "batch_individual_items": 6.292612463119059e-06, "add_time_dim_to_batch_and_zero_pad": 2.3734008245238514e-06, "add_observations_from_episodes_to_batch": 2.97162086159208e-06}}, "connector_pipeline_timer": 4.4117941004783024e-05}, "module_to_env_connector": {"timers": {"connectors": {"listify_data_for_vector_env": 1.1158745679831969e-05, "tensor_to_numpy": 1.3349316007450854e-05, "remove_single_ts_time_rank_from_batch": 5.878526527521141e-07, "un_batch_to_individual_items": 5.383244474925941e-06, "get_actions": 3.934719058147655e-05, "normalize_and_clip_actions": 9.419225590280613e-06}}, "connector_pipeline_timer": 0.00010546347778949582}, "agent_episode_returns_mean": {"default_agent": 1.0600000000000005}, "rlmodule_inference_timer": 2.775995494919162e-05, "module_episode_returns_mean": {"default_policy": 1.0600000000000005}, "num_episodes": 250.0, "episode_duration_sec_mean": 0.004601682330481707, "env_reset_timer": 3.71675223352524e-05, "num_agent_steps_sampled_lifetime": {"default_agent": -607500.0}, "episode_return_max": 8.5, "sample": 0.004959934748363416, "num_module_steps_sampled": {"default_policy": 5000.0}, "num_env_steps_sampled": 5000.0, "episode_return_min": -11.5, "env_to_module_sum_episodes_length_out": 10.36823839457432, "num_episodes_lifetime": -30375.0, "episode_len_mean": 20.0, "time_between_sampling": 0.001844826355067358, "episode_len_max": 20, "env_to_module_sum_episodes_length_in": 10.36823839457432, "num_env_steps_sampled_lifetime": -607500.0, "env_step_timer": 1.3886796574439857e-05, "num_module_steps_sampled_lifetime": {"default_policy": -607500.0}, "episode_len_min": 20, "episode_return_mean": 1.0600000000000005, "num_env_steps_sampled_lifetime_throughput": 3679.3062387646933}, "learners": {"default_policy": {"vf_loss": 0.10278083384037018, "num_module_steps_trained": 6000, "entropy": 0.6424447298049927, "gradients_default_optimizer_global_norm": 0.039692364633083344, "curr_kl_coeff": 0.09331203997135162, "vf_loss_unclipped": 28.58755874633789, "diff_num_grad_updates_vs_sampler_policy": 1.0, "vf_explained_var": -0.012941598892211914, "default_optimizer_learning_rate": 0.0002847858517, "total_loss": 0.10348828136920929, "num_module_steps_trained_lifetime": 18000, "num_trainable_parameters": 6003, "module_train_batch_size_mean": 1000.0, "curr_entropy_coeff": 0.0090570820258, "mean_kl_loss": 0.0006657454650849104, "weights_seq_no": 3.0, "policy_loss": 0.04044210910797119, "num_module_steps_trained_lifetime_throughput": 430996.8715125215}, "__all_modules__": {"num_non_trainable_parameters": 0, "num_module_steps_trained_lifetime": 18000, "num_trainable_parameters": 6003, "learner_connector": {"connector_pipeline_timer": 0.08105660616338718, "timers": {"connectors": {"add_columns_from_episodes_to_train_batch": 0.033788511396828105, "add_time_dim_to_batch_and_zero_pad": 1.2586315127555279e-05, "add_observations_from_episodes_to_batch": 0.0008076171866385265, "batch_individual_items": 0.031197954611328894, "add_one_ts_to_episodes_and_truncate": 0.007446326854557265, "general_advantage_estimation": 0.0076237669056514286, "numpy_to_tensor": 5.988397999899462e-05, "add_states_from_episodes_to_batch": 3.2640315010212358e-06}}}, "num_env_steps_trained_lifetime": 94500, "learner_connector_sum_episodes_length_out": 5250.0, "num_module_steps_trained": 6000, "learner_connector_sum_episodes_length_in": 5000.0, "num_env_steps_trained": 31500, "num_env_steps_trained_lifetime_throughput": 2248248.0479657, "num_module_steps_trained_throughput": 430368.01613119396, "num_module_steps_trained_lifetime_throughput": 429563.21298021503}}, "num_training_step_calls_per_iteration": 1, "evaluation": {"env_runners": {"num_episodes": 20, "episode_return_max": 14.5, "agent_episode_returns_mean": {"default_agent": -0.2}, "env_to_module_connector": {"timers": {"connectors": {"numpy_to_tensor": 8.082434165919703e-06, "add_states_from_episodes_to_batch": 1.5306890868901698e-06, "add_time_dim_to_batch_and_zero_pad": 2.1166902216889156e-06, "add_observations_from_episodes_to_batch": 2.7838204965992544e-06, "batch_individual_items": 6.049114343598934e-06}}, "connector_pipeline_timer": 4.177209138022987e-05}, "module_episode_returns_mean": {"default_policy": -0.2}, "num_env_steps_sampled": 400, "module_to_env_connector": {"timers": {"connectors": {"remove_single_ts_time_rank_from_batch": 5.707994871946418e-07, "un_batch_to_individual_items": 5.264343409756491e-06, "tensor_to_numpy": 1.2563570983823009e-05, "normalize_and_clip_actions": 9.202931581417997e-06, "listify_data_for_vector_env": 1.0760140818520168e-05, "get_actions": 3.4551267219319976e-05}}, "connector_pipeline_timer": 9.82484048126937e-05}, "num_module_steps_sampled": {"default_policy": 400}, "episode_len_mean": 20.0, "episode_len_min": 20, "rlmodule_inference_timer": 2.6315882774245235e-05, "episode_duration_sec_mean": 0.004497581217826034, "sample": 0.1013926118128118, "num_agent_steps_sampled": {"default_agent": 400}, "env_to_module_sum_episodes_length_out": 10.368205581254823, "num_episodes_lifetime": 60, "episode_len_max": 20, "env_step_timer": 1.3890237293711496e-05, "episode_return_mean": -0.2, "env_reset_timer": 0.0005312107606907376, "episode_return_min": -14.5, "num_agent_steps_sampled_lifetime": {"default_agent": 1200}, "env_to_module_sum_episodes_length_in": 10.368205581254823, "num_env_steps_sampled_lifetime": 15400, "weights_seq_no": 3.0, "num_module_steps_sampled_lifetime": {"default_policy": 1200}, "time_between_sampling": 1.5926465241657568}, "num_healthy_workers": 1, "actor_manager_num_outstanding_async_reqs": 0, "num_remote_worker_restarts": 0}, "num_env_steps_sampled_lifetime": -607500.0, "fault_tolerance": {"num_healthy_workers": 0, "num_remote_worker_restarts": 0}, "env_runner_group": {"actor_manager_num_outstanding_async_reqs": 0}, "done": false, "training_iteration": 3, "trial_id": "43ce3_00000", "date": "2025-08-11_19-23-03", "timestamp": 1754932983, "time_this_iter_s": 1.5994341373443604, "time_total_s": 4.986750364303589, "pid": 14399, "hostname": "Mac", "node_ip": "127.0.0.1", "config": {"exploration_config": {}, "extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "placement_strategy": "PACK", "num_gpus": 0, "_fake_gpus": false, "num_cpus_for_main_process": 2, "eager_tracing": true, "eager_max_retraces": 20, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "torch_compile_learner": false, "torch_compile_learner_what_to_compile": "forward_train", "torch_compile_learner_dynamo_backend": "aot_eager", "torch_compile_learner_dynamo_mode": null, "torch_compile_worker": false, "torch_compile_worker_dynamo_backend": "aot_eager", "torch_compile_worker_dynamo_mode": null, "torch_ddp_kwargs": {}, "torch_skip_nan_gradients": false, "env": "Umbrella", "env_config": {}, "observation_space": null, "action_space": null, "clip_rewards": null, "normalize_actions": true, "clip_actions": false, "_is_atari": null, "disable_env_checking": false, "render_env": false, "action_mask_key": "action_mask", "env_runner_cls": null, "num_env_runners": 0, "create_local_env_runner": true, "num_envs_per_env_runner": 1, "gym_env_vectorize_mode": "SYNC", "num_cpus_per_env_runner": 1, "num_gpus_per_env_runner": 0, "custom_resources_per_env_runner": {}, "validate_env_runners_after_construction": true, "episodes_to_numpy": true, "max_requests_in_flight_per_env_runner": 1, "sample_timeout_s": 60.0, "_env_to_module_connector": null, "add_default_connectors_to_env_to_module_pipeline": true, "_module_to_env_connector": null, "add_default_connectors_to_module_to_env_pipeline": true, "merge_env_runner_states": "training_only", "broadcast_env_runner_states": true, "episode_lookback_horizon": 1, "rollout_fragment_length": "auto", "batch_mode": "complete_episodes", "compress_observations": false, "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "enable_tf1_exec_eagerly": false, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "preprocessor_pref": "deepmind", "observation_filter": "NoFilter", "update_worker_filter_stats": true, "use_worker_filter_stats": true, "sampler_perf_stats_ema_coef": null, "_is_online": true, "num_learners": 0, "num_gpus_per_learner": 0, "num_cpus_per_learner": "auto", "num_aggregator_actors_per_learner": 0, "max_requests_in_flight_per_aggregator_actor": 3, "local_gpu_idx": 0, "max_requests_in_flight_per_learner": 3, "gamma": 1, "lr": 0.0002847858517, "grad_clip": 0.5, "grad_clip_by": "global_norm", "_train_batch_size_per_learner": 5000, "train_batch_size": 4000, "num_epochs": 1, "minibatch_size": 1000, "shuffle_batch_per_epoch": true, "model": {"fcnet_hiddens": [256, 256], "fcnet_activation": "tanh", "fcnet_weights_initializer": null, "fcnet_weights_initializer_config": null, "fcnet_bias_initializer": null, "fcnet_bias_initializer_config": null, "conv_filters": null, "conv_activation": "relu", "conv_kernel_initializer": null, "conv_kernel_initializer_config": null, "conv_bias_initializer": null, "conv_bias_initializer_config": null, "conv_transpose_kernel_initializer": null, "conv_transpose_kernel_initializer_config": null, "conv_transpose_bias_initializer": null, "conv_transpose_bias_initializer_config": null, "post_fcnet_hiddens": [], "post_fcnet_activation": "relu", "post_fcnet_weights_initializer": null, "post_fcnet_weights_initializer_config": null, "post_fcnet_bias_initializer": null, "post_fcnet_bias_initializer_config": null, "free_log_std": false, "log_std_clip_param": 20.0, "no_final_linear": false, "vf_share_layers": false, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "lstm_weights_initializer": null, "lstm_weights_initializer_config": null, "lstm_bias_initializer": null, "lstm_bias_initializer_config": null, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "attention_use_n_prev_actions": 0, "attention_use_n_prev_rewards": 0, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": null, "custom_model_config": {}, "custom_action_dist": null, "custom_preprocessor": null, "encoder_latent_dim": null, "always_check_shapes": false, "lstm_use_prev_action_reward": -1, "_use_default_native_models": -1, "_disable_preprocessor_api": false, "_disable_action_flattening": false}, "_learner_connector": null, "add_default_connectors_to_learner_pipeline": true, "learner_config_dict": {}, "optimizer": {}, "_learner_class": null, "callbacks_on_algorithm_init": null, "callbacks_on_env_runners_recreated": null, "callbacks_on_offline_eval_runners_recreated": null, "callbacks_on_checkpoint_loaded": null, "callbacks_on_environment_created": null, "callbacks_on_episode_created": null, "callbacks_on_episode_start": null, "callbacks_on_episode_step": null, "callbacks_on_episode_end": null, "callbacks_on_evaluate_start": null, "callbacks_on_evaluate_end": null, "callbacks_on_evaluate_offline_start": null, "callbacks_on_evaluate_offline_end": null, "callbacks_on_sample_end": null, "callbacks_on_train_result": null, "explore": true, "enable_rl_module_and_learner": true, "enable_env_runner_and_connector_v2": true, "_prior_exploration_config": {"type": "StochasticSampling"}, "count_steps_by": "env_steps", "policy_map_capacity": 100, "policy_mapping_fn": "<function AlgorithmConfig.DEFAULT_POLICY_MAPPING_FN at 0x388aedb20>", "policies_to_train": null, "policy_states_are_swappable": false, "observation_fn": null, "offline_data_class": null, "input_read_method": "read_parquet", "input_read_method_kwargs": {}, "input_read_schema": {}, "input_read_episodes": false, "input_read_sample_batches": false, "input_read_batch_size": null, "input_filesystem": null, "input_filesystem_kwargs": {}, "input_compress_columns": ["obs", "new_obs"], "input_spaces_jsonable": true, "materialize_data": false, "materialize_mapped_data": true, "map_batches_kwargs": {}, "iter_batches_kwargs": {}, "ignore_final_observation": false, "prelearner_class": null, "prelearner_buffer_class": null, "prelearner_buffer_kwargs": {}, "prelearner_module_synch_period": 10, "dataset_num_iters_per_learner": null, "input_config": {}, "actions_in_input_normalized": false, "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_config": {}, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "output_max_rows_per_file": null, "output_write_remaining_data": false, "output_write_method": "write_parquet", "output_write_method_kwargs": {}, "output_filesystem": null, "output_filesystem_kwargs": {}, "output_write_episodes": true, "offline_sampling": false, "evaluation_interval": 1, "evaluation_duration": 20, "evaluation_duration_unit": "episodes", "evaluation_sample_timeout_s": 120.0, "evaluation_auto_duration_min_env_steps_per_sample": 100, "evaluation_auto_duration_max_env_steps_per_sample": 2000, "evaluation_parallel_to_training": false, "evaluation_force_reset_envs_before_iteration": true, "evaluation_config": null, "off_policy_estimation_methods": {}, "ope_split_batch_by_episode": true, "evaluation_num_env_runners": 1, "in_evaluation": false, "sync_filters_on_rollout_workers_timeout_s": 10.0, "offline_evaluation_interval": null, "num_offline_eval_runners": 0, "offline_loss_for_module_fn": null, "offline_evaluation_duration": 1, "offline_evaluation_parallel_to_training": false, "offline_evaluation_timeout_s": 120.0, "num_cpus_per_offline_eval_runner": 1, "num_gpus_per_offline_eval_runner": 0, "custom_resources_per_offline_eval_runner": {}, "restart_failed_offline_eval_runners": true, "ignore_offline_eval_runner_failures": false, "max_num_offline_eval_runner_restarts": 1000, "offline_eval_runner_restore_timeout_s": 1800.0, "max_requests_in_flight_per_offline_eval_runner": 1, "validate_offline_eval_runners_after_construction": true, "offline_eval_runner_health_probe_timeout_s": 30.0, "offline_eval_rl_module_inference_only": false, "broadcast_offline_eval_runner_states": false, "offline_eval_batch_size_per_runner": 256, "dataset_num_iters_per_eval_runner": 1, "keep_per_episode_custom_metrics": false, "metrics_episode_collection_timeout_s": 60.0, "metrics_num_episodes_for_smoothing": 100, "min_time_s_per_iteration": null, "min_train_timesteps_per_iteration": 0, "min_sample_timesteps_per_iteration": 0, "log_gradients": true, "export_native_model_files": false, "checkpoint_trainable_policies_only": false, "logger_creator": null, "logger_config": null, "log_level": "WARN", "log_sys_usage": true, "fake_sampler": false, "seed": 2, "restart_failed_env_runners": true, "ignore_env_runner_failures": false, "max_num_env_runner_restarts": 1000, "delay_between_env_runner_restarts_s": 60.0, "restart_failed_sub_environments": false, "num_consecutive_env_runner_failures_tolerance": 100, "env_runner_health_probe_timeout_s": 30.0, "env_runner_restore_timeout_s": 1800.0, "_model_config": {}, "_rl_module_spec": "RLModuleSpec(module_class=None, observation_space=None, action_space=None, inference_only=False, learner_only=False, model_config=DefaultModelConfig(fcnet_hiddens=[60, 90], fcnet_activation='tanh', fcnet_kernel_initializer=None, fcnet_kernel_initializer_kwargs=None, fcnet_bias_initializer=None, fcnet_bias_initializer_kwargs=None, conv_filters=None, conv_activation='relu', conv_kernel_initializer=None, conv_kernel_initializer_kwargs=None, conv_bias_initializer=None, conv_bias_initializer_kwargs=None, head_fcnet_hiddens=[], head_fcnet_activation='relu', head_fcnet_kernel_initializer=None, head_fcnet_kernel_initializer_kwargs=None, head_fcnet_bias_initializer=None, head_fcnet_bias_initializer_kwargs=None, free_log_std=False, log_std_clip_param=20.0, vf_share_layers=True, use_lstm=False, max_seq_len=20, lstm_cell_size=256, lstm_use_prev_action=False, lstm_use_prev_reward=False, lstm_kernel_initializer=None, lstm_kernel_initializer_kwargs=None, lstm_bias_initializer=None, lstm_bias_initializer_kwargs=None), catalog_class=None, load_state_path=None, model_config_dict=None)", "algorithm_config_overrides_per_module": {}, "_per_module_overrides": {}, "_validate_config": true, "_use_msgpack_checkpoints": false, "_torch_grad_scaler_class": null, "_torch_lr_scheduler_classes": null, "_tf_policy_handles_more_than_one_loss": false, "_disable_preprocessor_api": false, "_disable_action_flattening": false, "_disable_initialize_loss_from_dummy_batch": false, "_dont_auto_sync_env_runner_states": false, "env_task_fn": -1, "enable_connectors": -1, "simple_optimizer": false, "policy_map_cache": -1, "worker_cls": -1, "synchronize_filters": -1, "enable_async_evaluation": -1, "custom_async_evaluation_function": -1, "_enable_rl_module_api": -1, "auto_wrap_old_gym_envs": -1, "always_attach_evaluation_results": -1, "replay_sequence_length": null, "_disable_execution_plan_api": -1, "use_critic": true, "use_gae": true, "use_kl_loss": true, "kl_coeff": 0.7464963036515, "kl_target": 0.0270990929592, "vf_loss_coeff": 0.6688075857018, "entropy_coeff": 0.0090570820258, "clip_param": 0.1221781641624, "vf_clip_param": 0.1027808522125, "entropy_coeff_schedule": null, "lr_schedule": null, "sgd_minibatch_size": -1, "vf_share_layers": -1, "__stdout_file__": null, "__stderr_file__": null, "lambda": 0.9099046732075, "input": "sampler", "policies": {"default_policy": [null, null, null, null]}, "callbacks": "<class 'ray.rllib.callbacks.callbacks.RLlibCallback'>", "create_env_on_driver": false, "custom_eval_function": null, "framework": "torch"}, "time_since_restore": 4.986750364303589, "iterations_since_restore": 3, "perf": {"cpu_util_percent": 28.666666666666668, "ram_util_percent": 78.43333333333332}}
{"timers": {"training_iteration": 1.6021481362350734, "restore_env_runners": 9.76242482534144e-06, "training_step": 1.6020177958464457, "env_runner_sampling_timer": 1.4929035793574128, "learner_update_timer": 0.1062085354842412, "synch_weights": 0.000551753963570227, "restore_eval_env_runners": 8.445921353995801e-06, "evaluation_iteration": 0.11481854040719336, "synch_eval_env_connectors": 0.00011260723781306297, "synch_env_connectors": 4.713498277124018e-06}, "env_runners": {"weights_seq_no": 3.0, "num_agent_steps_sampled": {"default_agent": 5000.0}, "env_to_module_connector": {"timers": {"connectors": {"numpy_to_tensor": 8.5005258002864e-06, "add_states_from_episodes_to_batch": 1.7320030022653316e-06, "batch_individual_items": 6.204276122961403e-06, "add_time_dim_to_batch_and_zero_pad": 2.3561794408036724e-06, "add_observations_from_episodes_to_batch": 2.996671431983815e-06}}, "connector_pipeline_timer": 4.374288064724411e-05}, "module_to_env_connector": {"timers": {"connectors": {"listify_data_for_vector_env": 1.1058687335324622e-05, "tensor_to_numpy": 1.3140529698490194e-05, "remove_single_ts_time_rank_from_batch": 5.8758548290673e-07, "un_batch_to_individual_items": 5.3517962830878216e-06, "get_actions": 3.8543938514337494e-05, "normalize_and_clip_actions": 9.367267376825382e-06}}, "connector_pipeline_timer": 0.00010409447106761605}, "agent_episode_returns_mean": {"default_agent": 0.7399999999999999}, "rlmodule_inference_timer": 2.708258622035019e-05, "module_episode_returns_mean": {"default_policy": 0.7399999999999999}, "num_episodes": 250.0, "episode_duration_sec_mean": 0.004545790980570019, "env_reset_timer": 3.350619739166312e-05, "num_agent_steps_sampled_lifetime": {"default_agent": -1225000.0}, "episode_return_max": 8.5, "sample": 0.004855924041541224, "num_module_steps_sampled": {"default_policy": 5000.0}, "num_env_steps_sampled": 5000.0, "episode_return_min": -11.5, "env_to_module_sum_episodes_length_out": 10.36823839457432, "num_episodes_lifetime": -61250.0, "episode_len_mean": 20.0, "time_between_sampling": 0.001760076576616986, "episode_len_max": 20, "env_to_module_sum_episodes_length_in": 10.36823839457432, "num_env_steps_sampled_lifetime": -1225000.0, "env_step_timer": 1.3700507764736278e-05, "num_module_steps_sampled_lifetime": {"default_policy": -1225000.0}, "episode_len_min": 20, "episode_return_mean": 0.7399999999999999, "num_env_steps_sampled_lifetime_throughput": 3724.864824906856}, "learners": {"default_policy": {"vf_loss": 0.10278083384037018, "num_module_steps_trained": 6000, "entropy": 0.6283105611801147, "gradients_default_optimizer_global_norm": 0.0398266464471817, "curr_kl_coeff": 0.04665601998567581, "vf_loss_unclipped": 28.65396499633789, "diff_num_grad_updates_vs_sampler_policy": 1.0, "vf_explained_var": -0.013248324394226074, "default_optimizer_learning_rate": 0.0002847858517, "total_loss": 0.13474135100841522, "num_module_steps_trained_lifetime": 24000, "num_trainable_parameters": 6003, "module_train_batch_size_mean": 1000.0, "curr_entropy_coeff": 0.0090570820258, "mean_kl_loss": 0.0006002793088555336, "weights_seq_no": 4.0, "policy_loss": 0.07163538783788681, "num_module_steps_trained_lifetime_throughput": 431088.48799654504}, "__all_modules__": {"num_non_trainable_parameters": 0, "num_module_steps_trained_lifetime": 24000, "num_trainable_parameters": 6003, "learner_connector": {"connector_pipeline_timer": 0.08103388177126994, "timers": {"connectors": {"add_columns_from_episodes_to_train_batch": 0.0337924125326334, "add_time_dim_to_batch_and_zero_pad": 1.256712100736331e-05, "add_observations_from_episodes_to_batch": 0.0008076643443799111, "batch_individual_items": 0.031193745895329045, "add_one_ts_to_episodes_and_truncate": 0.0074484381655914485, "general_advantage_estimation": 0.00759956173640187, "numpy_to_tensor": 5.9803890365525153e-05, "add_states_from_episodes_to_batch": 3.2818106618942687e-06}}}, "num_env_steps_trained_lifetime": 126000, "learner_connector_sum_episodes_length_out": 5250.0, "num_module_steps_trained": 6000, "learner_connector_sum_episodes_length_in": 5000.0, "num_env_steps_trained": 31500, "num_env_steps_trained_lifetime_throughput": 2249188.084792945, "num_module_steps_trained_throughput": 430494.76977863756, "num_module_steps_trained_lifetime_throughput": 429706.7199448345}}, "num_training_step_calls_per_iteration": 1, "evaluation": {"env_runners": {"num_episodes": 20, "episode_return_max": 14.5, "agent_episode_returns_mean": {"default_agent": 0.3}, "env_to_module_connector": {"timers": {"connectors": {"numpy_to_tensor": 8.144639838932464e-06, "add_states_from_episodes_to_batch": 1.5906635797683533e-06, "add_time_dim_to_batch_and_zero_pad": 2.111430991030087e-06, "add_observations_from_episodes_to_batch": 2.7697135798579734e-06, "batch_individual_items": 6.021186238696655e-06}}, "connector_pipeline_timer": 4.2048568895774335e-05}, "module_episode_returns_mean": {"default_policy": 0.3}, "num_env_steps_sampled": 400, "module_to_env_connector": {"timers": {"connectors": {"remove_single_ts_time_rank_from_batch": 5.701749825591591e-07, "un_batch_to_individual_items": 5.297732973101368e-06, "tensor_to_numpy": 1.2488923353924619e-05, "normalize_and_clip_actions": 9.188875802137058e-06, "listify_data_for_vector_env": 1.074325639013278e-05, "get_actions": 3.4299482239325e-05}}, "connector_pipeline_timer": 9.788931726550462e-05}, "num_module_steps_sampled": {"default_policy": 400}, "episode_len_mean": 20.0, "episode_len_min": 20, "rlmodule_inference_timer": 2.6045258025127352e-05, "episode_duration_sec_mean": 0.004469848923326936, "sample": 0.101334846945044, "num_agent_steps_sampled": {"default_agent": 400}, "env_to_module_sum_episodes_length_out": 10.368237912813044, "num_episodes_lifetime": 80, "episode_len_max": 20, "env_step_timer": 1.3795306526911386e-05, "episode_return_mean": 0.3, "env_reset_timer": 0.0005266469835782192, "episode_return_min": -14.5, "num_agent_steps_sampled_lifetime": {"default_agent": 1600}, "env_to_module_sum_episodes_length_in": 10.368237912813044, "num_env_steps_sampled_lifetime": 20400, "weights_seq_no": 4.0, "num_module_steps_sampled_lifetime": {"default_policy": 1600}, "time_between_sampling": 1.5924093810040967}, "num_healthy_workers": 1, "actor_manager_num_outstanding_async_reqs": 0, "num_remote_worker_restarts": 0}, "num_env_steps_sampled_lifetime": -1225000.0, "fault_tolerance": {"num_healthy_workers": 0, "num_remote_worker_restarts": 0}, "env_runner_group": {"actor_manager_num_outstanding_async_reqs": 0}, "done": false, "training_iteration": 4, "trial_id": "43ce3_00000", "date": "2025-08-11_19-23-04", "timestamp": 1754932984, "time_this_iter_s": 1.6555778980255127, "time_total_s": 6.642328262329102, "pid": 14399, "hostname": "Mac", "node_ip": "127.0.0.1", "config": {"exploration_config": {}, "extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "placement_strategy": "PACK", "num_gpus": 0, "_fake_gpus": false, "num_cpus_for_main_process": 2, "eager_tracing": true, "eager_max_retraces": 20, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "torch_compile_learner": false, "torch_compile_learner_what_to_compile": "forward_train", "torch_compile_learner_dynamo_backend": "aot_eager", "torch_compile_learner_dynamo_mode": null, "torch_compile_worker": false, "torch_compile_worker_dynamo_backend": "aot_eager", "torch_compile_worker_dynamo_mode": null, "torch_ddp_kwargs": {}, "torch_skip_nan_gradients": false, "env": "Umbrella", "env_config": {}, "observation_space": null, "action_space": null, "clip_rewards": null, "normalize_actions": true, "clip_actions": false, "_is_atari": null, "disable_env_checking": false, "render_env": false, "action_mask_key": "action_mask", "env_runner_cls": null, "num_env_runners": 0, "create_local_env_runner": true, "num_envs_per_env_runner": 1, "gym_env_vectorize_mode": "SYNC", "num_cpus_per_env_runner": 1, "num_gpus_per_env_runner": 0, "custom_resources_per_env_runner": {}, "validate_env_runners_after_construction": true, "episodes_to_numpy": true, "max_requests_in_flight_per_env_runner": 1, "sample_timeout_s": 60.0, "_env_to_module_connector": null, "add_default_connectors_to_env_to_module_pipeline": true, "_module_to_env_connector": null, "add_default_connectors_to_module_to_env_pipeline": true, "merge_env_runner_states": "training_only", "broadcast_env_runner_states": true, "episode_lookback_horizon": 1, "rollout_fragment_length": "auto", "batch_mode": "complete_episodes", "compress_observations": false, "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "enable_tf1_exec_eagerly": false, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "preprocessor_pref": "deepmind", "observation_filter": "NoFilter", "update_worker_filter_stats": true, "use_worker_filter_stats": true, "sampler_perf_stats_ema_coef": null, "_is_online": true, "num_learners": 0, "num_gpus_per_learner": 0, "num_cpus_per_learner": "auto", "num_aggregator_actors_per_learner": 0, "max_requests_in_flight_per_aggregator_actor": 3, "local_gpu_idx": 0, "max_requests_in_flight_per_learner": 3, "gamma": 1, "lr": 0.0002847858517, "grad_clip": 0.5, "grad_clip_by": "global_norm", "_train_batch_size_per_learner": 5000, "train_batch_size": 4000, "num_epochs": 1, "minibatch_size": 1000, "shuffle_batch_per_epoch": true, "model": {"fcnet_hiddens": [256, 256], "fcnet_activation": "tanh", "fcnet_weights_initializer": null, "fcnet_weights_initializer_config": null, "fcnet_bias_initializer": null, "fcnet_bias_initializer_config": null, "conv_filters": null, "conv_activation": "relu", "conv_kernel_initializer": null, "conv_kernel_initializer_config": null, "conv_bias_initializer": null, "conv_bias_initializer_config": null, "conv_transpose_kernel_initializer": null, "conv_transpose_kernel_initializer_config": null, "conv_transpose_bias_initializer": null, "conv_transpose_bias_initializer_config": null, "post_fcnet_hiddens": [], "post_fcnet_activation": "relu", "post_fcnet_weights_initializer": null, "post_fcnet_weights_initializer_config": null, "post_fcnet_bias_initializer": null, "post_fcnet_bias_initializer_config": null, "free_log_std": false, "log_std_clip_param": 20.0, "no_final_linear": false, "vf_share_layers": false, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "lstm_weights_initializer": null, "lstm_weights_initializer_config": null, "lstm_bias_initializer": null, "lstm_bias_initializer_config": null, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "attention_use_n_prev_actions": 0, "attention_use_n_prev_rewards": 0, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": null, "custom_model_config": {}, "custom_action_dist": null, "custom_preprocessor": null, "encoder_latent_dim": null, "always_check_shapes": false, "lstm_use_prev_action_reward": -1, "_use_default_native_models": -1, "_disable_preprocessor_api": false, "_disable_action_flattening": false}, "_learner_connector": null, "add_default_connectors_to_learner_pipeline": true, "learner_config_dict": {}, "optimizer": {}, "_learner_class": null, "callbacks_on_algorithm_init": null, "callbacks_on_env_runners_recreated": null, "callbacks_on_offline_eval_runners_recreated": null, "callbacks_on_checkpoint_loaded": null, "callbacks_on_environment_created": null, "callbacks_on_episode_created": null, "callbacks_on_episode_start": null, "callbacks_on_episode_step": null, "callbacks_on_episode_end": null, "callbacks_on_evaluate_start": null, "callbacks_on_evaluate_end": null, "callbacks_on_evaluate_offline_start": null, "callbacks_on_evaluate_offline_end": null, "callbacks_on_sample_end": null, "callbacks_on_train_result": null, "explore": true, "enable_rl_module_and_learner": true, "enable_env_runner_and_connector_v2": true, "_prior_exploration_config": {"type": "StochasticSampling"}, "count_steps_by": "env_steps", "policy_map_capacity": 100, "policy_mapping_fn": "<function AlgorithmConfig.DEFAULT_POLICY_MAPPING_FN at 0x388aedb20>", "policies_to_train": null, "policy_states_are_swappable": false, "observation_fn": null, "offline_data_class": null, "input_read_method": "read_parquet", "input_read_method_kwargs": {}, "input_read_schema": {}, "input_read_episodes": false, "input_read_sample_batches": false, "input_read_batch_size": null, "input_filesystem": null, "input_filesystem_kwargs": {}, "input_compress_columns": ["obs", "new_obs"], "input_spaces_jsonable": true, "materialize_data": false, "materialize_mapped_data": true, "map_batches_kwargs": {}, "iter_batches_kwargs": {}, "ignore_final_observation": false, "prelearner_class": null, "prelearner_buffer_class": null, "prelearner_buffer_kwargs": {}, "prelearner_module_synch_period": 10, "dataset_num_iters_per_learner": null, "input_config": {}, "actions_in_input_normalized": false, "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_config": {}, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "output_max_rows_per_file": null, "output_write_remaining_data": false, "output_write_method": "write_parquet", "output_write_method_kwargs": {}, "output_filesystem": null, "output_filesystem_kwargs": {}, "output_write_episodes": true, "offline_sampling": false, "evaluation_interval": 1, "evaluation_duration": 20, "evaluation_duration_unit": "episodes", "evaluation_sample_timeout_s": 120.0, "evaluation_auto_duration_min_env_steps_per_sample": 100, "evaluation_auto_duration_max_env_steps_per_sample": 2000, "evaluation_parallel_to_training": false, "evaluation_force_reset_envs_before_iteration": true, "evaluation_config": null, "off_policy_estimation_methods": {}, "ope_split_batch_by_episode": true, "evaluation_num_env_runners": 1, "in_evaluation": false, "sync_filters_on_rollout_workers_timeout_s": 10.0, "offline_evaluation_interval": null, "num_offline_eval_runners": 0, "offline_loss_for_module_fn": null, "offline_evaluation_duration": 1, "offline_evaluation_parallel_to_training": false, "offline_evaluation_timeout_s": 120.0, "num_cpus_per_offline_eval_runner": 1, "num_gpus_per_offline_eval_runner": 0, "custom_resources_per_offline_eval_runner": {}, "restart_failed_offline_eval_runners": true, "ignore_offline_eval_runner_failures": false, "max_num_offline_eval_runner_restarts": 1000, "offline_eval_runner_restore_timeout_s": 1800.0, "max_requests_in_flight_per_offline_eval_runner": 1, "validate_offline_eval_runners_after_construction": true, "offline_eval_runner_health_probe_timeout_s": 30.0, "offline_eval_rl_module_inference_only": false, "broadcast_offline_eval_runner_states": false, "offline_eval_batch_size_per_runner": 256, "dataset_num_iters_per_eval_runner": 1, "keep_per_episode_custom_metrics": false, "metrics_episode_collection_timeout_s": 60.0, "metrics_num_episodes_for_smoothing": 100, "min_time_s_per_iteration": null, "min_train_timesteps_per_iteration": 0, "min_sample_timesteps_per_iteration": 0, "log_gradients": true, "export_native_model_files": false, "checkpoint_trainable_policies_only": false, "logger_creator": null, "logger_config": null, "log_level": "WARN", "log_sys_usage": true, "fake_sampler": false, "seed": 2, "restart_failed_env_runners": true, "ignore_env_runner_failures": false, "max_num_env_runner_restarts": 1000, "delay_between_env_runner_restarts_s": 60.0, "restart_failed_sub_environments": false, "num_consecutive_env_runner_failures_tolerance": 100, "env_runner_health_probe_timeout_s": 30.0, "env_runner_restore_timeout_s": 1800.0, "_model_config": {}, "_rl_module_spec": "RLModuleSpec(module_class=None, observation_space=None, action_space=None, inference_only=False, learner_only=False, model_config=DefaultModelConfig(fcnet_hiddens=[60, 90], fcnet_activation='tanh', fcnet_kernel_initializer=None, fcnet_kernel_initializer_kwargs=None, fcnet_bias_initializer=None, fcnet_bias_initializer_kwargs=None, conv_filters=None, conv_activation='relu', conv_kernel_initializer=None, conv_kernel_initializer_kwargs=None, conv_bias_initializer=None, conv_bias_initializer_kwargs=None, head_fcnet_hiddens=[], head_fcnet_activation='relu', head_fcnet_kernel_initializer=None, head_fcnet_kernel_initializer_kwargs=None, head_fcnet_bias_initializer=None, head_fcnet_bias_initializer_kwargs=None, free_log_std=False, log_std_clip_param=20.0, vf_share_layers=True, use_lstm=False, max_seq_len=20, lstm_cell_size=256, lstm_use_prev_action=False, lstm_use_prev_reward=False, lstm_kernel_initializer=None, lstm_kernel_initializer_kwargs=None, lstm_bias_initializer=None, lstm_bias_initializer_kwargs=None), catalog_class=None, load_state_path=None, model_config_dict=None)", "algorithm_config_overrides_per_module": {}, "_per_module_overrides": {}, "_validate_config": true, "_use_msgpack_checkpoints": false, "_torch_grad_scaler_class": null, "_torch_lr_scheduler_classes": null, "_tf_policy_handles_more_than_one_loss": false, "_disable_preprocessor_api": false, "_disable_action_flattening": false, "_disable_initialize_loss_from_dummy_batch": false, "_dont_auto_sync_env_runner_states": false, "env_task_fn": -1, "enable_connectors": -1, "simple_optimizer": false, "policy_map_cache": -1, "worker_cls": -1, "synchronize_filters": -1, "enable_async_evaluation": -1, "custom_async_evaluation_function": -1, "_enable_rl_module_api": -1, "auto_wrap_old_gym_envs": -1, "always_attach_evaluation_results": -1, "replay_sequence_length": null, "_disable_execution_plan_api": -1, "use_critic": true, "use_gae": true, "use_kl_loss": true, "kl_coeff": 0.7464963036515, "kl_target": 0.0270990929592, "vf_loss_coeff": 0.6688075857018, "entropy_coeff": 0.0090570820258, "clip_param": 0.1221781641624, "vf_clip_param": 0.1027808522125, "entropy_coeff_schedule": null, "lr_schedule": null, "sgd_minibatch_size": -1, "vf_share_layers": -1, "__stdout_file__": null, "__stderr_file__": null, "lambda": 0.9099046732075, "input": "sampler", "policies": {"default_policy": [null, null, null, null]}, "callbacks": "<class 'ray.rllib.callbacks.callbacks.RLlibCallback'>", "create_env_on_driver": false, "custom_eval_function": null, "framework": "torch"}, "time_since_restore": 6.642328262329102, "iterations_since_restore": 4, "perf": {"cpu_util_percent": 41.349999999999994, "ram_util_percent": 78.5}}
{"timers": {"training_iteration": 1.6023327907121794, "restore_env_runners": 9.717720654084114e-06, "training_step": 1.6022019491374455, "env_runner_sampling_timer": 1.4932345610640978, "learner_update_timer": 0.10605941137910418, "synch_weights": 0.0005514068439795578, "restore_eval_env_runners": 8.458962300792337e-06, "evaluation_iteration": 0.11467304833305918, "synch_eval_env_connectors": 0.00011249366557761096, "synch_env_connectors": 4.713033032719977e-06}, "env_runners": {"weights_seq_no": 4.0, "num_agent_steps_sampled": {"default_agent": 5000.0}, "env_to_module_connector": {"timers": {"connectors": {"numpy_to_tensor": 8.84130474861211e-06, "add_states_from_episodes_to_batch": 1.7440596889059081e-06, "batch_individual_items": 6.277758516666741e-06, "add_time_dim_to_batch_and_zero_pad": 2.401928167606587e-06, "add_observations_from_episodes_to_batch": 2.99382233561822e-06}}, "connector_pipeline_timer": 4.452629899609163e-05}, "module_to_env_connector": {"timers": {"connectors": {"listify_data_for_vector_env": 1.1380196123160112e-05, "tensor_to_numpy": 1.5310589549236287e-05, "remove_single_ts_time_rank_from_batch": 5.952099661892775e-07, "un_batch_to_individual_items": 5.456883276680641e-06, "get_actions": 4.0291651606461616e-05, "normalize_and_clip_actions": 9.561531998511952e-06}}, "connector_pipeline_timer": 0.00011092258747825106}, "agent_episode_returns_mean": {"default_agent": 2.8199999999999994}, "rlmodule_inference_timer": 4.606657712085735e-05, "module_episode_returns_mean": {"default_policy": 2.8199999999999994}, "num_episodes": 250.0, "episode_duration_sec_mean": 0.005108783292584121, "env_reset_timer": 3.455588407420949e-05, "num_agent_steps_sampled_lifetime": {"default_agent": -1842500.0}, "episode_return_max": 8.5, "sample": 0.004993485090014685, "num_module_steps_sampled": {"default_policy": 5000.0}, "num_env_steps_sampled": 5000.0, "episode_return_min": -11.5, "env_to_module_sum_episodes_length_out": 10.36823839457432, "num_episodes_lifetime": -92125.0, "episode_len_mean": 20.0, "time_between_sampling": 0.0015643598683962884, "episode_len_max": 20, "env_to_module_sum_episodes_length_in": 10.36823839457432, "num_env_steps_sampled_lifetime": -1842500.0, "env_step_timer": 1.4132976306193795e-05, "num_module_steps_sampled_lifetime": {"default_policy": -1842500.0}, "episode_len_min": 20, "episode_return_mean": 2.8199999999999994, "num_env_steps_sampled_lifetime_throughput": 3670.1813940700235}, "learners": {"default_policy": {"vf_loss": 0.10278083384037018, "num_module_steps_trained": 6000, "entropy": 0.6176988482475281, "gradients_default_optimizer_global_norm": 0.029085060581564903, "curr_kl_coeff": 0.023328009992837906, "vf_loss_unclipped": 28.329936981201172, "diff_num_grad_updates_vs_sampler_policy": 1.0, "vf_explained_var": -0.010551810264587402, "default_optimizer_learning_rate": 0.0002847858517, "total_loss": 0.10586991161108017, "num_module_steps_trained_lifetime": 30000, "num_trainable_parameters": 6003, "module_train_batch_size_mean": 1000.0, "curr_entropy_coeff": 0.0090570820258, "mean_kl_loss": 0.0002633107651490718, "weights_seq_no": 5.0, "policy_loss": 0.042711563408374786, "num_module_steps_trained_lifetime_throughput": 431310.6753164197}, "__all_modules__": {"num_non_trainable_parameters": 0, "num_module_steps_trained_lifetime": 30000, "num_trainable_parameters": 6003, "learner_connector": {"connector_pipeline_timer": 0.0810057667036959, "timers": {"connectors": {"add_columns_from_episodes_to_train_batch": 0.03380046132691087, "add_time_dim_to_batch_and_zero_pad": 1.2556449508803196e-05, "add_observations_from_episodes_to_batch": 0.0008075110418266687, "batch_individual_items": 0.03117964426534501, "add_one_ts_to_episodes_and_truncate": 0.0074490825341126336, "general_advantage_estimation": 0.007577241119128004, "numpy_to_tensor": 5.980377103215201e-05, "add_states_from_episodes_to_batch": 3.2835725624707987e-06}}}, "num_env_steps_trained_lifetime": 157500, "learner_connector_sum_episodes_length_out": 5250.0, "num_module_steps_trained": 6000, "learner_connector_sum_episodes_length_in": 5000.0, "num_env_steps_trained": 31500, "num_env_steps_trained_lifetime_throughput": 2250898.312880889, "num_module_steps_trained_throughput": 430759.69698936865, "num_module_steps_trained_lifetime_throughput": 429991.0508135669}}, "num_training_step_calls_per_iteration": 1, "evaluation": {"env_runners": {"num_episodes": 20, "episode_return_max": 14.5, "agent_episode_returns_mean": {"default_agent": 0.4}, "env_to_module_connector": {"timers": {"connectors": {"numpy_to_tensor": 8.15686772470912e-06, "add_states_from_episodes_to_batch": 1.5562850279973582e-06, "add_time_dim_to_batch_and_zero_pad": 2.120480098785476e-06, "add_observations_from_episodes_to_batch": 2.775673936835585e-06, "batch_individual_items": 6.060033623452435e-06}}, "connector_pipeline_timer": 4.177806667206679e-05}, "module_episode_returns_mean": {"default_policy": 0.4}, "num_env_steps_sampled": 400, "module_to_env_connector": {"timers": {"connectors": {"remove_single_ts_time_rank_from_batch": 5.606869888053715e-07, "un_batch_to_individual_items": 5.25523211673722e-06, "tensor_to_numpy": 1.2594059948717187e-05, "normalize_and_clip_actions": 9.228667406394541e-06, "listify_data_for_vector_env": 1.0867646588299307e-05, "get_actions": 3.48461985353182e-05}}, "connector_pipeline_timer": 9.848489207673536e-05}, "num_module_steps_sampled": {"default_policy": 400}, "episode_len_mean": 20.0, "episode_len_min": 20, "rlmodule_inference_timer": 2.6341333354582074e-05, "episode_duration_sec_mean": 0.004453369562979787, "sample": 0.10127775472551309, "num_agent_steps_sampled": {"default_agent": 400}, "env_to_module_sum_episodes_length_out": 10.368238387501162, "num_episodes_lifetime": 100, "episode_len_max": 20, "env_step_timer": 1.3786228616235748e-05, "episode_return_mean": 0.4, "env_reset_timer": 0.0005221096741257807, "episode_return_min": -14.5, "num_agent_steps_sampled_lifetime": {"default_agent": 2000}, "env_to_module_sum_episodes_length_in": 10.368238387501162, "num_env_steps_sampled_lifetime": 25400, "weights_seq_no": 5.0, "num_module_steps_sampled_lifetime": {"default_policy": 2000}, "time_between_sampling": 1.592857703864257}, "num_healthy_workers": 1, "actor_manager_num_outstanding_async_reqs": 0, "num_remote_worker_restarts": 0}, "num_env_steps_sampled_lifetime": -1842500.0, "fault_tolerance": {"num_healthy_workers": 0, "num_remote_worker_restarts": 0}, "env_runner_group": {"actor_manager_num_outstanding_async_reqs": 0}, "done": false, "training_iteration": 5, "trial_id": "43ce3_00000", "date": "2025-08-11_19-23-06", "timestamp": 1754932986, "time_this_iter_s": 1.7229900360107422, "time_total_s": 8.365318298339844, "pid": 14399, "hostname": "Mac", "node_ip": "127.0.0.1", "config": {"exploration_config": {}, "extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "placement_strategy": "PACK", "num_gpus": 0, "_fake_gpus": false, "num_cpus_for_main_process": 2, "eager_tracing": true, "eager_max_retraces": 20, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "torch_compile_learner": false, "torch_compile_learner_what_to_compile": "forward_train", "torch_compile_learner_dynamo_backend": "aot_eager", "torch_compile_learner_dynamo_mode": null, "torch_compile_worker": false, "torch_compile_worker_dynamo_backend": "aot_eager", "torch_compile_worker_dynamo_mode": null, "torch_ddp_kwargs": {}, "torch_skip_nan_gradients": false, "env": "Umbrella", "env_config": {}, "observation_space": null, "action_space": null, "clip_rewards": null, "normalize_actions": true, "clip_actions": false, "_is_atari": null, "disable_env_checking": false, "render_env": false, "action_mask_key": "action_mask", "env_runner_cls": null, "num_env_runners": 0, "create_local_env_runner": true, "num_envs_per_env_runner": 1, "gym_env_vectorize_mode": "SYNC", "num_cpus_per_env_runner": 1, "num_gpus_per_env_runner": 0, "custom_resources_per_env_runner": {}, "validate_env_runners_after_construction": true, "episodes_to_numpy": true, "max_requests_in_flight_per_env_runner": 1, "sample_timeout_s": 60.0, "_env_to_module_connector": null, "add_default_connectors_to_env_to_module_pipeline": true, "_module_to_env_connector": null, "add_default_connectors_to_module_to_env_pipeline": true, "merge_env_runner_states": "training_only", "broadcast_env_runner_states": true, "episode_lookback_horizon": 1, "rollout_fragment_length": "auto", "batch_mode": "complete_episodes", "compress_observations": false, "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "enable_tf1_exec_eagerly": false, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "preprocessor_pref": "deepmind", "observation_filter": "NoFilter", "update_worker_filter_stats": true, "use_worker_filter_stats": true, "sampler_perf_stats_ema_coef": null, "_is_online": true, "num_learners": 0, "num_gpus_per_learner": 0, "num_cpus_per_learner": "auto", "num_aggregator_actors_per_learner": 0, "max_requests_in_flight_per_aggregator_actor": 3, "local_gpu_idx": 0, "max_requests_in_flight_per_learner": 3, "gamma": 1, "lr": 0.0002847858517, "grad_clip": 0.5, "grad_clip_by": "global_norm", "_train_batch_size_per_learner": 5000, "train_batch_size": 4000, "num_epochs": 1, "minibatch_size": 1000, "shuffle_batch_per_epoch": true, "model": {"fcnet_hiddens": [256, 256], "fcnet_activation": "tanh", "fcnet_weights_initializer": null, "fcnet_weights_initializer_config": null, "fcnet_bias_initializer": null, "fcnet_bias_initializer_config": null, "conv_filters": null, "conv_activation": "relu", "conv_kernel_initializer": null, "conv_kernel_initializer_config": null, "conv_bias_initializer": null, "conv_bias_initializer_config": null, "conv_transpose_kernel_initializer": null, "conv_transpose_kernel_initializer_config": null, "conv_transpose_bias_initializer": null, "conv_transpose_bias_initializer_config": null, "post_fcnet_hiddens": [], "post_fcnet_activation": "relu", "post_fcnet_weights_initializer": null, "post_fcnet_weights_initializer_config": null, "post_fcnet_bias_initializer": null, "post_fcnet_bias_initializer_config": null, "free_log_std": false, "log_std_clip_param": 20.0, "no_final_linear": false, "vf_share_layers": false, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "lstm_weights_initializer": null, "lstm_weights_initializer_config": null, "lstm_bias_initializer": null, "lstm_bias_initializer_config": null, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "attention_use_n_prev_actions": 0, "attention_use_n_prev_rewards": 0, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": null, "custom_model_config": {}, "custom_action_dist": null, "custom_preprocessor": null, "encoder_latent_dim": null, "always_check_shapes": false, "lstm_use_prev_action_reward": -1, "_use_default_native_models": -1, "_disable_preprocessor_api": false, "_disable_action_flattening": false}, "_learner_connector": null, "add_default_connectors_to_learner_pipeline": true, "learner_config_dict": {}, "optimizer": {}, "_learner_class": null, "callbacks_on_algorithm_init": null, "callbacks_on_env_runners_recreated": null, "callbacks_on_offline_eval_runners_recreated": null, "callbacks_on_checkpoint_loaded": null, "callbacks_on_environment_created": null, "callbacks_on_episode_created": null, "callbacks_on_episode_start": null, "callbacks_on_episode_step": null, "callbacks_on_episode_end": null, "callbacks_on_evaluate_start": null, "callbacks_on_evaluate_end": null, "callbacks_on_evaluate_offline_start": null, "callbacks_on_evaluate_offline_end": null, "callbacks_on_sample_end": null, "callbacks_on_train_result": null, "explore": true, "enable_rl_module_and_learner": true, "enable_env_runner_and_connector_v2": true, "_prior_exploration_config": {"type": "StochasticSampling"}, "count_steps_by": "env_steps", "policy_map_capacity": 100, "policy_mapping_fn": "<function AlgorithmConfig.DEFAULT_POLICY_MAPPING_FN at 0x388aedb20>", "policies_to_train": null, "policy_states_are_swappable": false, "observation_fn": null, "offline_data_class": null, "input_read_method": "read_parquet", "input_read_method_kwargs": {}, "input_read_schema": {}, "input_read_episodes": false, "input_read_sample_batches": false, "input_read_batch_size": null, "input_filesystem": null, "input_filesystem_kwargs": {}, "input_compress_columns": ["obs", "new_obs"], "input_spaces_jsonable": true, "materialize_data": false, "materialize_mapped_data": true, "map_batches_kwargs": {}, "iter_batches_kwargs": {}, "ignore_final_observation": false, "prelearner_class": null, "prelearner_buffer_class": null, "prelearner_buffer_kwargs": {}, "prelearner_module_synch_period": 10, "dataset_num_iters_per_learner": null, "input_config": {}, "actions_in_input_normalized": false, "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_config": {}, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "output_max_rows_per_file": null, "output_write_remaining_data": false, "output_write_method": "write_parquet", "output_write_method_kwargs": {}, "output_filesystem": null, "output_filesystem_kwargs": {}, "output_write_episodes": true, "offline_sampling": false, "evaluation_interval": 1, "evaluation_duration": 20, "evaluation_duration_unit": "episodes", "evaluation_sample_timeout_s": 120.0, "evaluation_auto_duration_min_env_steps_per_sample": 100, "evaluation_auto_duration_max_env_steps_per_sample": 2000, "evaluation_parallel_to_training": false, "evaluation_force_reset_envs_before_iteration": true, "evaluation_config": null, "off_policy_estimation_methods": {}, "ope_split_batch_by_episode": true, "evaluation_num_env_runners": 1, "in_evaluation": false, "sync_filters_on_rollout_workers_timeout_s": 10.0, "offline_evaluation_interval": null, "num_offline_eval_runners": 0, "offline_loss_for_module_fn": null, "offline_evaluation_duration": 1, "offline_evaluation_parallel_to_training": false, "offline_evaluation_timeout_s": 120.0, "num_cpus_per_offline_eval_runner": 1, "num_gpus_per_offline_eval_runner": 0, "custom_resources_per_offline_eval_runner": {}, "restart_failed_offline_eval_runners": true, "ignore_offline_eval_runner_failures": false, "max_num_offline_eval_runner_restarts": 1000, "offline_eval_runner_restore_timeout_s": 1800.0, "max_requests_in_flight_per_offline_eval_runner": 1, "validate_offline_eval_runners_after_construction": true, "offline_eval_runner_health_probe_timeout_s": 30.0, "offline_eval_rl_module_inference_only": false, "broadcast_offline_eval_runner_states": false, "offline_eval_batch_size_per_runner": 256, "dataset_num_iters_per_eval_runner": 1, "keep_per_episode_custom_metrics": false, "metrics_episode_collection_timeout_s": 60.0, "metrics_num_episodes_for_smoothing": 100, "min_time_s_per_iteration": null, "min_train_timesteps_per_iteration": 0, "min_sample_timesteps_per_iteration": 0, "log_gradients": true, "export_native_model_files": false, "checkpoint_trainable_policies_only": false, "logger_creator": null, "logger_config": null, "log_level": "WARN", "log_sys_usage": true, "fake_sampler": false, "seed": 2, "restart_failed_env_runners": true, "ignore_env_runner_failures": false, "max_num_env_runner_restarts": 1000, "delay_between_env_runner_restarts_s": 60.0, "restart_failed_sub_environments": false, "num_consecutive_env_runner_failures_tolerance": 100, "env_runner_health_probe_timeout_s": 30.0, "env_runner_restore_timeout_s": 1800.0, "_model_config": {}, "_rl_module_spec": "RLModuleSpec(module_class=None, observation_space=None, action_space=None, inference_only=False, learner_only=False, model_config=DefaultModelConfig(fcnet_hiddens=[60, 90], fcnet_activation='tanh', fcnet_kernel_initializer=None, fcnet_kernel_initializer_kwargs=None, fcnet_bias_initializer=None, fcnet_bias_initializer_kwargs=None, conv_filters=None, conv_activation='relu', conv_kernel_initializer=None, conv_kernel_initializer_kwargs=None, conv_bias_initializer=None, conv_bias_initializer_kwargs=None, head_fcnet_hiddens=[], head_fcnet_activation='relu', head_fcnet_kernel_initializer=None, head_fcnet_kernel_initializer_kwargs=None, head_fcnet_bias_initializer=None, head_fcnet_bias_initializer_kwargs=None, free_log_std=False, log_std_clip_param=20.0, vf_share_layers=True, use_lstm=False, max_seq_len=20, lstm_cell_size=256, lstm_use_prev_action=False, lstm_use_prev_reward=False, lstm_kernel_initializer=None, lstm_kernel_initializer_kwargs=None, lstm_bias_initializer=None, lstm_bias_initializer_kwargs=None), catalog_class=None, load_state_path=None, model_config_dict=None)", "algorithm_config_overrides_per_module": {}, "_per_module_overrides": {}, "_validate_config": true, "_use_msgpack_checkpoints": false, "_torch_grad_scaler_class": null, "_torch_lr_scheduler_classes": null, "_tf_policy_handles_more_than_one_loss": false, "_disable_preprocessor_api": false, "_disable_action_flattening": false, "_disable_initialize_loss_from_dummy_batch": false, "_dont_auto_sync_env_runner_states": false, "env_task_fn": -1, "enable_connectors": -1, "simple_optimizer": false, "policy_map_cache": -1, "worker_cls": -1, "synchronize_filters": -1, "enable_async_evaluation": -1, "custom_async_evaluation_function": -1, "_enable_rl_module_api": -1, "auto_wrap_old_gym_envs": -1, "always_attach_evaluation_results": -1, "replay_sequence_length": null, "_disable_execution_plan_api": -1, "use_critic": true, "use_gae": true, "use_kl_loss": true, "kl_coeff": 0.7464963036515, "kl_target": 0.0270990929592, "vf_loss_coeff": 0.6688075857018, "entropy_coeff": 0.0090570820258, "clip_param": 0.1221781641624, "vf_clip_param": 0.1027808522125, "entropy_coeff_schedule": null, "lr_schedule": null, "sgd_minibatch_size": -1, "vf_share_layers": -1, "__stdout_file__": null, "__stderr_file__": null, "lambda": 0.9099046732075, "input": "sampler", "policies": {"default_policy": [null, null, null, null]}, "callbacks": "<class 'ray.rllib.callbacks.callbacks.RLlibCallback'>", "create_env_on_driver": false, "custom_eval_function": null, "framework": "torch"}, "time_since_restore": 8.365318298339844, "iterations_since_restore": 5, "perf": {"cpu_util_percent": 39.05, "ram_util_percent": 78.6}}
{"timers": {"training_iteration": 1.6017977965548753, "restore_env_runners": 9.672633483294734e-06, "training_step": 1.6016666083960924, "env_runner_sampling_timer": 1.4919822496133723, "learner_update_timer": 0.10677530393428171, "synch_weights": 0.0005512965256501799, "restore_eval_env_runners": 8.438121708016843e-06, "evaluation_iteration": 0.11452916576873634, "synch_eval_env_connectors": 0.00011235622887415115, "synch_env_connectors": 4.708402443932136e-06}, "env_runners": {"weights_seq_no": 5.0, "num_agent_steps_sampled": {"default_agent": 5000.0}, "env_to_module_connector": {"timers": {"connectors": {"numpy_to_tensor": 8.445131156438452e-06, "add_states_from_episodes_to_batch": 1.7164774257746304e-06, "batch_individual_items": 6.130299422263707e-06, "add_time_dim_to_batch_and_zero_pad": 2.343354026222942e-06, "add_observations_from_episodes_to_batch": 2.8962198630061533e-06}}, "connector_pipeline_timer": 4.349668366808044e-05}, "module_to_env_connector": {"timers": {"connectors": {"listify_data_for_vector_env": 1.0940261120144943e-05, "tensor_to_numpy": 1.3089204484612305e-05, "remove_single_ts_time_rank_from_batch": 5.771433716093984e-07, "un_batch_to_individual_items": 5.299952445970047e-06, "get_actions": 3.8293810292327214e-05, "normalize_and_clip_actions": 9.30346714015761e-06}}, "connector_pipeline_timer": 0.00010350432164965918}, "agent_episode_returns_mean": {"default_agent": 2.34}, "rlmodule_inference_timer": 2.741262643493022e-05, "module_episode_returns_mean": {"default_policy": 2.34}, "num_episodes": 250.0, "episode_duration_sec_mean": 0.0045130523452535255, "env_reset_timer": 3.419798750968117e-05, "num_agent_steps_sampled_lifetime": {"default_agent": -2460000.0}, "episode_return_max": 8.5, "sample": 0.005234783106097695, "num_module_steps_sampled": {"default_policy": 5000.0}, "num_env_steps_sampled": 5000.0, "episode_return_min": -11.5, "env_to_module_sum_episodes_length_out": 10.36823839457432, "num_episodes_lifetime": -123000.0, "episode_len_mean": 20.0, "time_between_sampling": 0.0014840507686999266, "episode_len_max": 20, "env_to_module_sum_episodes_length_in": 10.36823839457432, "num_env_steps_sampled_lifetime": -2460000.0, "env_step_timer": 1.3555281353532326e-05, "num_module_steps_sampled_lifetime": {"default_policy": -2460000.0}, "episode_len_min": 20, "episode_return_mean": 2.34, "num_env_steps_sampled_lifetime_throughput": 3739.9533138010843}, "learners": {"default_policy": {"vf_loss": 0.10278083384037018, "num_module_steps_trained": 6000, "entropy": 0.6058812141418457, "gradients_default_optimizer_global_norm": 0.044034115970134735, "curr_kl_coeff": 0.011664004996418953, "vf_loss_unclipped": 28.01873207092285, "diff_num_grad_updates_vs_sampler_policy": 1.0, "vf_explained_var": -0.0063784122467041016, "default_optimizer_learning_rate": 0.0002847858517, "total_loss": -0.1386224329471588, "num_module_steps_trained_lifetime": 36000, "num_trainable_parameters": 6003, "module_train_batch_size_mean": 1000.0, "curr_entropy_coeff": 0.0090570820258, "mean_kl_loss": 0.0003197113692294806, "weights_seq_no": 6.0, "policy_loss": -0.2018829733133316, "num_module_steps_trained_lifetime_throughput": 431687.0174032378}, "__all_modules__": {"num_non_trainable_parameters": 0, "num_module_steps_trained_lifetime": 36000, "num_trainable_parameters": 6003, "learner_connector": {"connector_pipeline_timer": 0.08184322194708088, "timers": {"connectors": {"add_columns_from_episodes_to_train_batch": 0.03379978921355377, "add_time_dim_to_batch_and_zero_pad": 1.2514215101078883e-05, "add_observations_from_episodes_to_batch": 0.0008076655214294757, "batch_individual_items": 0.03204026074180497, "add_one_ts_to_episodes_and_truncate": 0.007450817958574365, "general_advantage_estimation": 0.007553298287688663, "numpy_to_tensor": 5.972781413070843e-05, "add_states_from_episodes_to_batch": 3.2803168059690964e-06}}}, "num_env_steps_trained_lifetime": 189000, "learner_connector_sum_episodes_length_out": 5250.0, "num_module_steps_trained": 6000, "learner_connector_sum_episodes_length_in": 5000.0, "num_env_steps_trained": 31500, "num_env_steps_trained_lifetime_throughput": 2253448.4338377374, "num_module_steps_trained_throughput": 431181.8132823271, "num_module_steps_trained_lifetime_throughput": 430433.1617816828}}, "num_training_step_calls_per_iteration": 1, "evaluation": {"env_runners": {"num_episodes": 20, "episode_return_max": 14.5, "agent_episode_returns_mean": {"default_agent": 1.2}, "env_to_module_connector": {"timers": {"connectors": {"numpy_to_tensor": 8.159612736310593e-06, "add_states_from_episodes_to_batch": 1.5515688772970618e-06, "add_time_dim_to_batch_and_zero_pad": 2.1124849866728123e-06, "add_observations_from_episodes_to_batch": 2.7818544786379105e-06, "batch_individual_items": 6.085343395943925e-06}}, "connector_pipeline_timer": 4.165389966270753e-05}, "module_episode_returns_mean": {"default_policy": 1.2}, "num_env_steps_sampled": 400, "module_to_env_connector": {"timers": {"connectors": {"remove_single_ts_time_rank_from_batch": 5.791684051502e-07, "un_batch_to_individual_items": 5.162366330473006e-06, "tensor_to_numpy": 1.2412993263054754e-05, "normalize_and_clip_actions": 9.246630402212883e-06, "listify_data_for_vector_env": 1.072083077842374e-05, "get_actions": 3.460271519336453e-05}}, "connector_pipeline_timer": 9.769812446567382e-05}, "num_module_steps_sampled": {"default_policy": 400}, "episode_len_mean": 20.0, "episode_len_min": 20, "rlmodule_inference_timer": 2.585608092655105e-05, "episode_duration_sec_mean": 0.004408367472933605, "sample": 0.10121844342788781, "num_agent_steps_sampled": {"default_agent": 400}, "env_to_module_sum_episodes_length_out": 10.368238394470474, "num_episodes_lifetime": 120, "episode_len_max": 20, "env_step_timer": 1.3645156747588932e-05, "episode_return_mean": 1.2, "env_reset_timer": 0.0005176289869804147, "episode_return_min": -14.5, "num_agent_steps_sampled_lifetime": {"default_agent": 2400}, "env_to_module_sum_episodes_length_in": 10.368238394470474, "num_env_steps_sampled_lifetime": 30400, "weights_seq_no": 6.0, "num_module_steps_sampled_lifetime": {"default_policy": 2400}, "time_between_sampling": 1.5925779751562166}, "num_healthy_workers": 1, "actor_manager_num_outstanding_async_reqs": 0, "num_remote_worker_restarts": 0}, "num_env_steps_sampled_lifetime": -2460000.0, "fault_tolerance": {"num_healthy_workers": 0, "num_remote_worker_restarts": 0}, "env_runner_group": {"actor_manager_num_outstanding_async_reqs": 0}, "done": false, "training_iteration": 6, "trial_id": "43ce3_00000", "date": "2025-08-11_19-23-08", "timestamp": 1754932988, "time_this_iter_s": 1.651047945022583, "time_total_s": 10.016366243362427, "pid": 14399, "hostname": "Mac", "node_ip": "127.0.0.1", "config": {"exploration_config": {}, "extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "placement_strategy": "PACK", "num_gpus": 0, "_fake_gpus": false, "num_cpus_for_main_process": 2, "eager_tracing": true, "eager_max_retraces": 20, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "torch_compile_learner": false, "torch_compile_learner_what_to_compile": "forward_train", "torch_compile_learner_dynamo_backend": "aot_eager", "torch_compile_learner_dynamo_mode": null, "torch_compile_worker": false, "torch_compile_worker_dynamo_backend": "aot_eager", "torch_compile_worker_dynamo_mode": null, "torch_ddp_kwargs": {}, "torch_skip_nan_gradients": false, "env": "Umbrella", "env_config": {}, "observation_space": null, "action_space": null, "clip_rewards": null, "normalize_actions": true, "clip_actions": false, "_is_atari": null, "disable_env_checking": false, "render_env": false, "action_mask_key": "action_mask", "env_runner_cls": null, "num_env_runners": 0, "create_local_env_runner": true, "num_envs_per_env_runner": 1, "gym_env_vectorize_mode": "SYNC", "num_cpus_per_env_runner": 1, "num_gpus_per_env_runner": 0, "custom_resources_per_env_runner": {}, "validate_env_runners_after_construction": true, "episodes_to_numpy": true, "max_requests_in_flight_per_env_runner": 1, "sample_timeout_s": 60.0, "_env_to_module_connector": null, "add_default_connectors_to_env_to_module_pipeline": true, "_module_to_env_connector": null, "add_default_connectors_to_module_to_env_pipeline": true, "merge_env_runner_states": "training_only", "broadcast_env_runner_states": true, "episode_lookback_horizon": 1, "rollout_fragment_length": "auto", "batch_mode": "complete_episodes", "compress_observations": false, "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "enable_tf1_exec_eagerly": false, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "preprocessor_pref": "deepmind", "observation_filter": "NoFilter", "update_worker_filter_stats": true, "use_worker_filter_stats": true, "sampler_perf_stats_ema_coef": null, "_is_online": true, "num_learners": 0, "num_gpus_per_learner": 0, "num_cpus_per_learner": "auto", "num_aggregator_actors_per_learner": 0, "max_requests_in_flight_per_aggregator_actor": 3, "local_gpu_idx": 0, "max_requests_in_flight_per_learner": 3, "gamma": 1, "lr": 0.0002847858517, "grad_clip": 0.5, "grad_clip_by": "global_norm", "_train_batch_size_per_learner": 5000, "train_batch_size": 4000, "num_epochs": 1, "minibatch_size": 1000, "shuffle_batch_per_epoch": true, "model": {"fcnet_hiddens": [256, 256], "fcnet_activation": "tanh", "fcnet_weights_initializer": null, "fcnet_weights_initializer_config": null, "fcnet_bias_initializer": null, "fcnet_bias_initializer_config": null, "conv_filters": null, "conv_activation": "relu", "conv_kernel_initializer": null, "conv_kernel_initializer_config": null, "conv_bias_initializer": null, "conv_bias_initializer_config": null, "conv_transpose_kernel_initializer": null, "conv_transpose_kernel_initializer_config": null, "conv_transpose_bias_initializer": null, "conv_transpose_bias_initializer_config": null, "post_fcnet_hiddens": [], "post_fcnet_activation": "relu", "post_fcnet_weights_initializer": null, "post_fcnet_weights_initializer_config": null, "post_fcnet_bias_initializer": null, "post_fcnet_bias_initializer_config": null, "free_log_std": false, "log_std_clip_param": 20.0, "no_final_linear": false, "vf_share_layers": false, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "lstm_weights_initializer": null, "lstm_weights_initializer_config": null, "lstm_bias_initializer": null, "lstm_bias_initializer_config": null, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "attention_use_n_prev_actions": 0, "attention_use_n_prev_rewards": 0, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": null, "custom_model_config": {}, "custom_action_dist": null, "custom_preprocessor": null, "encoder_latent_dim": null, "always_check_shapes": false, "lstm_use_prev_action_reward": -1, "_use_default_native_models": -1, "_disable_preprocessor_api": false, "_disable_action_flattening": false}, "_learner_connector": null, "add_default_connectors_to_learner_pipeline": true, "learner_config_dict": {}, "optimizer": {}, "_learner_class": null, "callbacks_on_algorithm_init": null, "callbacks_on_env_runners_recreated": null, "callbacks_on_offline_eval_runners_recreated": null, "callbacks_on_checkpoint_loaded": null, "callbacks_on_environment_created": null, "callbacks_on_episode_created": null, "callbacks_on_episode_start": null, "callbacks_on_episode_step": null, "callbacks_on_episode_end": null, "callbacks_on_evaluate_start": null, "callbacks_on_evaluate_end": null, "callbacks_on_evaluate_offline_start": null, "callbacks_on_evaluate_offline_end": null, "callbacks_on_sample_end": null, "callbacks_on_train_result": null, "explore": true, "enable_rl_module_and_learner": true, "enable_env_runner_and_connector_v2": true, "_prior_exploration_config": {"type": "StochasticSampling"}, "count_steps_by": "env_steps", "policy_map_capacity": 100, "policy_mapping_fn": "<function AlgorithmConfig.DEFAULT_POLICY_MAPPING_FN at 0x388aedb20>", "policies_to_train": null, "policy_states_are_swappable": false, "observation_fn": null, "offline_data_class": null, "input_read_method": "read_parquet", "input_read_method_kwargs": {}, "input_read_schema": {}, "input_read_episodes": false, "input_read_sample_batches": false, "input_read_batch_size": null, "input_filesystem": null, "input_filesystem_kwargs": {}, "input_compress_columns": ["obs", "new_obs"], "input_spaces_jsonable": true, "materialize_data": false, "materialize_mapped_data": true, "map_batches_kwargs": {}, "iter_batches_kwargs": {}, "ignore_final_observation": false, "prelearner_class": null, "prelearner_buffer_class": null, "prelearner_buffer_kwargs": {}, "prelearner_module_synch_period": 10, "dataset_num_iters_per_learner": null, "input_config": {}, "actions_in_input_normalized": false, "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_config": {}, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "output_max_rows_per_file": null, "output_write_remaining_data": false, "output_write_method": "write_parquet", "output_write_method_kwargs": {}, "output_filesystem": null, "output_filesystem_kwargs": {}, "output_write_episodes": true, "offline_sampling": false, "evaluation_interval": 1, "evaluation_duration": 20, "evaluation_duration_unit": "episodes", "evaluation_sample_timeout_s": 120.0, "evaluation_auto_duration_min_env_steps_per_sample": 100, "evaluation_auto_duration_max_env_steps_per_sample": 2000, "evaluation_parallel_to_training": false, "evaluation_force_reset_envs_before_iteration": true, "evaluation_config": null, "off_policy_estimation_methods": {}, "ope_split_batch_by_episode": true, "evaluation_num_env_runners": 1, "in_evaluation": false, "sync_filters_on_rollout_workers_timeout_s": 10.0, "offline_evaluation_interval": null, "num_offline_eval_runners": 0, "offline_loss_for_module_fn": null, "offline_evaluation_duration": 1, "offline_evaluation_parallel_to_training": false, "offline_evaluation_timeout_s": 120.0, "num_cpus_per_offline_eval_runner": 1, "num_gpus_per_offline_eval_runner": 0, "custom_resources_per_offline_eval_runner": {}, "restart_failed_offline_eval_runners": true, "ignore_offline_eval_runner_failures": false, "max_num_offline_eval_runner_restarts": 1000, "offline_eval_runner_restore_timeout_s": 1800.0, "max_requests_in_flight_per_offline_eval_runner": 1, "validate_offline_eval_runners_after_construction": true, "offline_eval_runner_health_probe_timeout_s": 30.0, "offline_eval_rl_module_inference_only": false, "broadcast_offline_eval_runner_states": false, "offline_eval_batch_size_per_runner": 256, "dataset_num_iters_per_eval_runner": 1, "keep_per_episode_custom_metrics": false, "metrics_episode_collection_timeout_s": 60.0, "metrics_num_episodes_for_smoothing": 100, "min_time_s_per_iteration": null, "min_train_timesteps_per_iteration": 0, "min_sample_timesteps_per_iteration": 0, "log_gradients": true, "export_native_model_files": false, "checkpoint_trainable_policies_only": false, "logger_creator": null, "logger_config": null, "log_level": "WARN", "log_sys_usage": true, "fake_sampler": false, "seed": 2, "restart_failed_env_runners": true, "ignore_env_runner_failures": false, "max_num_env_runner_restarts": 1000, "delay_between_env_runner_restarts_s": 60.0, "restart_failed_sub_environments": false, "num_consecutive_env_runner_failures_tolerance": 100, "env_runner_health_probe_timeout_s": 30.0, "env_runner_restore_timeout_s": 1800.0, "_model_config": {}, "_rl_module_spec": "RLModuleSpec(module_class=None, observation_space=None, action_space=None, inference_only=False, learner_only=False, model_config=DefaultModelConfig(fcnet_hiddens=[60, 90], fcnet_activation='tanh', fcnet_kernel_initializer=None, fcnet_kernel_initializer_kwargs=None, fcnet_bias_initializer=None, fcnet_bias_initializer_kwargs=None, conv_filters=None, conv_activation='relu', conv_kernel_initializer=None, conv_kernel_initializer_kwargs=None, conv_bias_initializer=None, conv_bias_initializer_kwargs=None, head_fcnet_hiddens=[], head_fcnet_activation='relu', head_fcnet_kernel_initializer=None, head_fcnet_kernel_initializer_kwargs=None, head_fcnet_bias_initializer=None, head_fcnet_bias_initializer_kwargs=None, free_log_std=False, log_std_clip_param=20.0, vf_share_layers=True, use_lstm=False, max_seq_len=20, lstm_cell_size=256, lstm_use_prev_action=False, lstm_use_prev_reward=False, lstm_kernel_initializer=None, lstm_kernel_initializer_kwargs=None, lstm_bias_initializer=None, lstm_bias_initializer_kwargs=None), catalog_class=None, load_state_path=None, model_config_dict=None)", "algorithm_config_overrides_per_module": {}, "_per_module_overrides": {}, "_validate_config": true, "_use_msgpack_checkpoints": false, "_torch_grad_scaler_class": null, "_torch_lr_scheduler_classes": null, "_tf_policy_handles_more_than_one_loss": false, "_disable_preprocessor_api": false, "_disable_action_flattening": false, "_disable_initialize_loss_from_dummy_batch": false, "_dont_auto_sync_env_runner_states": false, "env_task_fn": -1, "enable_connectors": -1, "simple_optimizer": false, "policy_map_cache": -1, "worker_cls": -1, "synchronize_filters": -1, "enable_async_evaluation": -1, "custom_async_evaluation_function": -1, "_enable_rl_module_api": -1, "auto_wrap_old_gym_envs": -1, "always_attach_evaluation_results": -1, "replay_sequence_length": null, "_disable_execution_plan_api": -1, "use_critic": true, "use_gae": true, "use_kl_loss": true, "kl_coeff": 0.7464963036515, "kl_target": 0.0270990929592, "vf_loss_coeff": 0.6688075857018, "entropy_coeff": 0.0090570820258, "clip_param": 0.1221781641624, "vf_clip_param": 0.1027808522125, "entropy_coeff_schedule": null, "lr_schedule": null, "sgd_minibatch_size": -1, "vf_share_layers": -1, "__stdout_file__": null, "__stderr_file__": null, "lambda": 0.9099046732075, "input": "sampler", "policies": {"default_policy": [null, null, null, null]}, "callbacks": "<class 'ray.rllib.callbacks.callbacks.RLlibCallback'>", "create_env_on_driver": false, "custom_eval_function": null, "framework": "torch"}, "time_since_restore": 10.016366243362427, "iterations_since_restore": 6, "perf": {"cpu_util_percent": 40.766666666666666, "ram_util_percent": 78.60000000000001}}
{"timers": {"training_iteration": 1.6005504685891723, "restore_env_runners": 9.632156703662125e-06, "training_step": 1.6004188335628462, "env_runner_sampling_timer": 1.4908839875375672, "learner_update_timer": 0.10662382756569844, "synch_weights": 0.0005509910610470195, "restore_eval_env_runners": 8.420401068367996e-06, "evaluation_iteration": 0.11438467869202988, "synch_eval_env_connectors": 0.00011219433630611897, "synch_env_connectors": 4.705068461588595e-06}, "env_runners": {"weights_seq_no": 6.0, "num_agent_steps_sampled": {"default_agent": 5000.0}, "env_to_module_connector": {"timers": {"connectors": {"numpy_to_tensor": 8.594097457343812e-06, "add_states_from_episodes_to_batch": 1.7368613617837303e-06, "batch_individual_items": 6.2798504016838e-06, "add_time_dim_to_batch_and_zero_pad": 2.352016764935572e-06, "add_observations_from_episodes_to_batch": 2.9437828185380677e-06}}, "connector_pipeline_timer": 4.3866037595203206e-05}, "module_to_env_connector": {"timers": {"connectors": {"listify_data_for_vector_env": 1.1129516276096807e-05, "tensor_to_numpy": 1.320919036163424e-05, "remove_single_ts_time_rank_from_batch": 5.884894193721563e-07, "un_batch_to_individual_items": 5.3615114416571025e-06, "get_actions": 3.868514387747687e-05, "normalize_and_clip_actions": 9.376902568417018e-06}}, "connector_pipeline_timer": 0.00010437861731195749}, "agent_episode_returns_mean": {"default_agent": 2.259999999999999}, "rlmodule_inference_timer": 2.74378413792708e-05, "module_episode_returns_mean": {"default_policy": 2.259999999999999}, "num_episodes": 250.0, "episode_duration_sec_mean": 0.004562255690339954, "env_reset_timer": 3.284673244651344e-05, "num_agent_steps_sampled_lifetime": {"default_agent": -3077500.0}, "episode_return_max": 8.5, "sample": 0.0048818068169891385, "num_module_steps_sampled": {"default_policy": 5000.0}, "num_env_steps_sampled": 5000.0, "episode_return_min": -11.5, "env_to_module_sum_episodes_length_out": 10.36823839457432, "num_episodes_lifetime": -153875.0, "episode_len_mean": 20.0, "time_between_sampling": 0.0017899912360374657, "episode_len_max": 20, "env_to_module_sum_episodes_length_in": 10.36823839457432, "num_env_steps_sampled_lifetime": -3077500.0, "env_step_timer": 1.3736672350533569e-05, "num_module_steps_sampled_lifetime": {"default_policy": -3077500.0}, "episode_len_min": 20, "episode_return_mean": 2.259999999999999, "num_env_steps_sampled_lifetime_throughput": 3722.351844701644}, "learners": {"default_policy": {"vf_loss": 0.10278083384037018, "num_module_steps_trained": 6000, "entropy": 0.5972712635993958, "gradients_default_optimizer_global_norm": 0.013988404534757137, "curr_kl_coeff": 0.0058320024982094765, "vf_loss_unclipped": 28.27447509765625, "diff_num_grad_updates_vs_sampler_policy": 1.0, "vf_explained_var": -0.008970975875854492, "default_optimizer_learning_rate": 0.0002847858517, "total_loss": 0.03697100281715393, "num_module_steps_trained_lifetime": 42000, "num_trainable_parameters": 6003, "module_train_batch_size_mean": 1000.0, "curr_entropy_coeff": 0.0090570820258, "mean_kl_loss": 0.00020801420032512397, "weights_seq_no": 7.0, "policy_loss": -0.02636248804628849, "num_module_steps_trained_lifetime_throughput": 432214.7923775965}, "__all_modules__": {"num_non_trainable_parameters": 0, "num_module_steps_trained_lifetime": 42000, "num_trainable_parameters": 6003, "learner_connector": {"connector_pipeline_timer": 0.08181280306665273, "timers": {"connectors": {"add_columns_from_episodes_to_train_batch": 0.03380554090162458, "add_time_dim_to_batch_and_zero_pad": 1.2472412350657561e-05, "add_observations_from_episodes_to_batch": 0.0008076305258180763, "batch_individual_items": 0.03202366479461812, "add_one_ts_to_episodes_and_truncate": 0.00745559269933056, "general_advantage_estimation": 0.007529272805277736, "numpy_to_tensor": 5.97434463606751e-05, "add_states_from_episodes_to_batch": 3.2766745118738346e-06}}}, "num_env_steps_trained_lifetime": 220500, "learner_connector_sum_episodes_length_out": 5250.0, "num_module_steps_trained": 6000, "learner_connector_sum_episodes_length_in": 5000.0, "num_env_steps_trained": 31500, "num_env_steps_trained_lifetime_throughput": 2256809.3703544186, "num_module_steps_trained_throughput": 431757.2047375061, "num_module_steps_trained_lifetime_throughput": 431028.7578637921}}, "num_training_step_calls_per_iteration": 1, "evaluation": {"env_runners": {"num_episodes": 20, "episode_return_max": 14.5, "agent_episode_returns_mean": {"default_agent": 0.6}, "env_to_module_connector": {"timers": {"connectors": {"numpy_to_tensor": 8.158571336137575e-06, "add_states_from_episodes_to_batch": 1.54141050551025e-06, "add_time_dim_to_batch_and_zero_pad": 2.1073139989639623e-06, "add_observations_from_episodes_to_batch": 2.750340542000197e-06, "batch_individual_items": 6.049862699366598e-06}}, "connector_pipeline_timer": 4.1977457715631023e-05}, "module_episode_returns_mean": {"default_policy": 0.6}, "num_env_steps_sampled": 400, "module_to_env_connector": {"timers": {"connectors": {"remove_single_ts_time_rank_from_batch": 5.645194271289748e-07, "un_batch_to_individual_items": 5.20831015717452e-06, "tensor_to_numpy": 1.258546080983593e-05, "normalize_and_clip_actions": 9.26754578081585e-06, "listify_data_for_vector_env": 1.085938352325561e-05, "get_actions": 3.4431579040394e-05}}, "connector_pipeline_timer": 9.83254018412384e-05}, "num_module_steps_sampled": {"default_policy": 400}, "episode_len_mean": 20.0, "episode_len_min": 20, "rlmodule_inference_timer": 2.6008140091486953e-05, "episode_duration_sec_mean": 0.004391809543594718, "sample": 0.10116281399318396, "num_agent_steps_sampled": {"default_agent": 400}, "env_to_module_sum_episodes_length_out": 10.368238394572801, "num_episodes_lifetime": 140, "episode_len_max": 20, "env_step_timer": 1.3736769549784087e-05, "episode_return_mean": 0.6, "env_reset_timer": 0.0005131647875153148, "episode_return_min": -14.5, "num_agent_steps_sampled_lifetime": {"default_agent": 2800}, "env_to_module_sum_episodes_length_in": 10.368238394572801, "num_env_steps_sampled_lifetime": 35400, "weights_seq_no": 7.0, "num_module_steps_sampled_lifetime": {"default_policy": 2800}, "time_between_sampling": 1.5915859595743456}, "num_healthy_workers": 1, "actor_manager_num_outstanding_async_reqs": 0, "num_remote_worker_restarts": 0}, "num_env_steps_sampled_lifetime": -3077500.0, "fault_tolerance": {"num_healthy_workers": 0, "num_remote_worker_restarts": 0}, "env_runner_group": {"actor_manager_num_outstanding_async_reqs": 0}, "done": false, "training_iteration": 7, "trial_id": "43ce3_00000", "date": "2025-08-11_19-23-09", "timestamp": 1754932989, "time_this_iter_s": 1.5795857906341553, "time_total_s": 11.595952033996582, "pid": 14399, "hostname": "Mac", "node_ip": "127.0.0.1", "config": {"exploration_config": {}, "extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "placement_strategy": "PACK", "num_gpus": 0, "_fake_gpus": false, "num_cpus_for_main_process": 2, "eager_tracing": true, "eager_max_retraces": 20, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "torch_compile_learner": false, "torch_compile_learner_what_to_compile": "forward_train", "torch_compile_learner_dynamo_backend": "aot_eager", "torch_compile_learner_dynamo_mode": null, "torch_compile_worker": false, "torch_compile_worker_dynamo_backend": "aot_eager", "torch_compile_worker_dynamo_mode": null, "torch_ddp_kwargs": {}, "torch_skip_nan_gradients": false, "env": "Umbrella", "env_config": {}, "observation_space": null, "action_space": null, "clip_rewards": null, "normalize_actions": true, "clip_actions": false, "_is_atari": null, "disable_env_checking": false, "render_env": false, "action_mask_key": "action_mask", "env_runner_cls": null, "num_env_runners": 0, "create_local_env_runner": true, "num_envs_per_env_runner": 1, "gym_env_vectorize_mode": "SYNC", "num_cpus_per_env_runner": 1, "num_gpus_per_env_runner": 0, "custom_resources_per_env_runner": {}, "validate_env_runners_after_construction": true, "episodes_to_numpy": true, "max_requests_in_flight_per_env_runner": 1, "sample_timeout_s": 60.0, "_env_to_module_connector": null, "add_default_connectors_to_env_to_module_pipeline": true, "_module_to_env_connector": null, "add_default_connectors_to_module_to_env_pipeline": true, "merge_env_runner_states": "training_only", "broadcast_env_runner_states": true, "episode_lookback_horizon": 1, "rollout_fragment_length": "auto", "batch_mode": "complete_episodes", "compress_observations": false, "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "enable_tf1_exec_eagerly": false, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "preprocessor_pref": "deepmind", "observation_filter": "NoFilter", "update_worker_filter_stats": true, "use_worker_filter_stats": true, "sampler_perf_stats_ema_coef": null, "_is_online": true, "num_learners": 0, "num_gpus_per_learner": 0, "num_cpus_per_learner": "auto", "num_aggregator_actors_per_learner": 0, "max_requests_in_flight_per_aggregator_actor": 3, "local_gpu_idx": 0, "max_requests_in_flight_per_learner": 3, "gamma": 1, "lr": 0.0002847858517, "grad_clip": 0.5, "grad_clip_by": "global_norm", "_train_batch_size_per_learner": 5000, "train_batch_size": 4000, "num_epochs": 1, "minibatch_size": 1000, "shuffle_batch_per_epoch": true, "model": {"fcnet_hiddens": [256, 256], "fcnet_activation": "tanh", "fcnet_weights_initializer": null, "fcnet_weights_initializer_config": null, "fcnet_bias_initializer": null, "fcnet_bias_initializer_config": null, "conv_filters": null, "conv_activation": "relu", "conv_kernel_initializer": null, "conv_kernel_initializer_config": null, "conv_bias_initializer": null, "conv_bias_initializer_config": null, "conv_transpose_kernel_initializer": null, "conv_transpose_kernel_initializer_config": null, "conv_transpose_bias_initializer": null, "conv_transpose_bias_initializer_config": null, "post_fcnet_hiddens": [], "post_fcnet_activation": "relu", "post_fcnet_weights_initializer": null, "post_fcnet_weights_initializer_config": null, "post_fcnet_bias_initializer": null, "post_fcnet_bias_initializer_config": null, "free_log_std": false, "log_std_clip_param": 20.0, "no_final_linear": false, "vf_share_layers": false, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "lstm_weights_initializer": null, "lstm_weights_initializer_config": null, "lstm_bias_initializer": null, "lstm_bias_initializer_config": null, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "attention_use_n_prev_actions": 0, "attention_use_n_prev_rewards": 0, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": null, "custom_model_config": {}, "custom_action_dist": null, "custom_preprocessor": null, "encoder_latent_dim": null, "always_check_shapes": false, "lstm_use_prev_action_reward": -1, "_use_default_native_models": -1, "_disable_preprocessor_api": false, "_disable_action_flattening": false}, "_learner_connector": null, "add_default_connectors_to_learner_pipeline": true, "learner_config_dict": {}, "optimizer": {}, "_learner_class": null, "callbacks_on_algorithm_init": null, "callbacks_on_env_runners_recreated": null, "callbacks_on_offline_eval_runners_recreated": null, "callbacks_on_checkpoint_loaded": null, "callbacks_on_environment_created": null, "callbacks_on_episode_created": null, "callbacks_on_episode_start": null, "callbacks_on_episode_step": null, "callbacks_on_episode_end": null, "callbacks_on_evaluate_start": null, "callbacks_on_evaluate_end": null, "callbacks_on_evaluate_offline_start": null, "callbacks_on_evaluate_offline_end": null, "callbacks_on_sample_end": null, "callbacks_on_train_result": null, "explore": true, "enable_rl_module_and_learner": true, "enable_env_runner_and_connector_v2": true, "_prior_exploration_config": {"type": "StochasticSampling"}, "count_steps_by": "env_steps", "policy_map_capacity": 100, "policy_mapping_fn": "<function AlgorithmConfig.DEFAULT_POLICY_MAPPING_FN at 0x388aedb20>", "policies_to_train": null, "policy_states_are_swappable": false, "observation_fn": null, "offline_data_class": null, "input_read_method": "read_parquet", "input_read_method_kwargs": {}, "input_read_schema": {}, "input_read_episodes": false, "input_read_sample_batches": false, "input_read_batch_size": null, "input_filesystem": null, "input_filesystem_kwargs": {}, "input_compress_columns": ["obs", "new_obs"], "input_spaces_jsonable": true, "materialize_data": false, "materialize_mapped_data": true, "map_batches_kwargs": {}, "iter_batches_kwargs": {}, "ignore_final_observation": false, "prelearner_class": null, "prelearner_buffer_class": null, "prelearner_buffer_kwargs": {}, "prelearner_module_synch_period": 10, "dataset_num_iters_per_learner": null, "input_config": {}, "actions_in_input_normalized": false, "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_config": {}, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "output_max_rows_per_file": null, "output_write_remaining_data": false, "output_write_method": "write_parquet", "output_write_method_kwargs": {}, "output_filesystem": null, "output_filesystem_kwargs": {}, "output_write_episodes": true, "offline_sampling": false, "evaluation_interval": 1, "evaluation_duration": 20, "evaluation_duration_unit": "episodes", "evaluation_sample_timeout_s": 120.0, "evaluation_auto_duration_min_env_steps_per_sample": 100, "evaluation_auto_duration_max_env_steps_per_sample": 2000, "evaluation_parallel_to_training": false, "evaluation_force_reset_envs_before_iteration": true, "evaluation_config": null, "off_policy_estimation_methods": {}, "ope_split_batch_by_episode": true, "evaluation_num_env_runners": 1, "in_evaluation": false, "sync_filters_on_rollout_workers_timeout_s": 10.0, "offline_evaluation_interval": null, "num_offline_eval_runners": 0, "offline_loss_for_module_fn": null, "offline_evaluation_duration": 1, "offline_evaluation_parallel_to_training": false, "offline_evaluation_timeout_s": 120.0, "num_cpus_per_offline_eval_runner": 1, "num_gpus_per_offline_eval_runner": 0, "custom_resources_per_offline_eval_runner": {}, "restart_failed_offline_eval_runners": true, "ignore_offline_eval_runner_failures": false, "max_num_offline_eval_runner_restarts": 1000, "offline_eval_runner_restore_timeout_s": 1800.0, "max_requests_in_flight_per_offline_eval_runner": 1, "validate_offline_eval_runners_after_construction": true, "offline_eval_runner_health_probe_timeout_s": 30.0, "offline_eval_rl_module_inference_only": false, "broadcast_offline_eval_runner_states": false, "offline_eval_batch_size_per_runner": 256, "dataset_num_iters_per_eval_runner": 1, "keep_per_episode_custom_metrics": false, "metrics_episode_collection_timeout_s": 60.0, "metrics_num_episodes_for_smoothing": 100, "min_time_s_per_iteration": null, "min_train_timesteps_per_iteration": 0, "min_sample_timesteps_per_iteration": 0, "log_gradients": true, "export_native_model_files": false, "checkpoint_trainable_policies_only": false, "logger_creator": null, "logger_config": null, "log_level": "WARN", "log_sys_usage": true, "fake_sampler": false, "seed": 2, "restart_failed_env_runners": true, "ignore_env_runner_failures": false, "max_num_env_runner_restarts": 1000, "delay_between_env_runner_restarts_s": 60.0, "restart_failed_sub_environments": false, "num_consecutive_env_runner_failures_tolerance": 100, "env_runner_health_probe_timeout_s": 30.0, "env_runner_restore_timeout_s": 1800.0, "_model_config": {}, "_rl_module_spec": "RLModuleSpec(module_class=None, observation_space=None, action_space=None, inference_only=False, learner_only=False, model_config=DefaultModelConfig(fcnet_hiddens=[60, 90], fcnet_activation='tanh', fcnet_kernel_initializer=None, fcnet_kernel_initializer_kwargs=None, fcnet_bias_initializer=None, fcnet_bias_initializer_kwargs=None, conv_filters=None, conv_activation='relu', conv_kernel_initializer=None, conv_kernel_initializer_kwargs=None, conv_bias_initializer=None, conv_bias_initializer_kwargs=None, head_fcnet_hiddens=[], head_fcnet_activation='relu', head_fcnet_kernel_initializer=None, head_fcnet_kernel_initializer_kwargs=None, head_fcnet_bias_initializer=None, head_fcnet_bias_initializer_kwargs=None, free_log_std=False, log_std_clip_param=20.0, vf_share_layers=True, use_lstm=False, max_seq_len=20, lstm_cell_size=256, lstm_use_prev_action=False, lstm_use_prev_reward=False, lstm_kernel_initializer=None, lstm_kernel_initializer_kwargs=None, lstm_bias_initializer=None, lstm_bias_initializer_kwargs=None), catalog_class=None, load_state_path=None, model_config_dict=None)", "algorithm_config_overrides_per_module": {}, "_per_module_overrides": {}, "_validate_config": true, "_use_msgpack_checkpoints": false, "_torch_grad_scaler_class": null, "_torch_lr_scheduler_classes": null, "_tf_policy_handles_more_than_one_loss": false, "_disable_preprocessor_api": false, "_disable_action_flattening": false, "_disable_initialize_loss_from_dummy_batch": false, "_dont_auto_sync_env_runner_states": false, "env_task_fn": -1, "enable_connectors": -1, "simple_optimizer": false, "policy_map_cache": -1, "worker_cls": -1, "synchronize_filters": -1, "enable_async_evaluation": -1, "custom_async_evaluation_function": -1, "_enable_rl_module_api": -1, "auto_wrap_old_gym_envs": -1, "always_attach_evaluation_results": -1, "replay_sequence_length": null, "_disable_execution_plan_api": -1, "use_critic": true, "use_gae": true, "use_kl_loss": true, "kl_coeff": 0.7464963036515, "kl_target": 0.0270990929592, "vf_loss_coeff": 0.6688075857018, "entropy_coeff": 0.0090570820258, "clip_param": 0.1221781641624, "vf_clip_param": 0.1027808522125, "entropy_coeff_schedule": null, "lr_schedule": null, "sgd_minibatch_size": -1, "vf_share_layers": -1, "__stdout_file__": null, "__stderr_file__": null, "lambda": 0.9099046732075, "input": "sampler", "policies": {"default_policy": [null, null, null, null]}, "callbacks": "<class 'ray.rllib.callbacks.callbacks.RLlibCallback'>", "create_env_on_driver": false, "custom_eval_function": null, "framework": "torch"}, "time_since_restore": 11.595952033996582, "iterations_since_restore": 7, "perf": {"cpu_util_percent": 39.6, "ram_util_percent": 78.19999999999999}}
{"timers": {"training_iteration": 1.6001297376540233, "restore_env_runners": 9.60624545157287e-06, "training_step": 1.5999976293973956, "env_runner_sampling_timer": 1.4906086797425253, "learner_update_timer": 0.10647694804014822, "synch_weights": 0.0005510094905526925, "restore_eval_env_runners": 8.398696951513542e-06, "evaluation_iteration": 0.11424414981489048, "synch_eval_env_connectors": 0.00011254156245358622, "synch_env_connectors": 4.7013568729824395e-06}, "env_runners": {"weights_seq_no": 7.0, "num_agent_steps_sampled": {"default_agent": 5000.0}, "env_to_module_connector": {"timers": {"connectors": {"numpy_to_tensor": 8.571788014745428e-06, "add_states_from_episodes_to_batch": 1.7236543488013284e-06, "batch_individual_items": 6.221197687909781e-06, "add_time_dim_to_batch_and_zero_pad": 2.3451806593765725e-06, "add_observations_from_episodes_to_batch": 3.0032742142290915e-06}}, "connector_pipeline_timer": 4.385405901390493e-05}, "module_to_env_connector": {"timers": {"connectors": {"listify_data_for_vector_env": 1.1085761255179622e-05, "tensor_to_numpy": 1.3266134829785194e-05, "remove_single_ts_time_rank_from_batch": 5.875082649158025e-07, "un_batch_to_individual_items": 5.36184139979696e-06, "get_actions": 3.8832730032386475e-05, "normalize_and_clip_actions": 9.41089071318477e-06}}, "connector_pipeline_timer": 0.00010470383383659728}, "agent_episode_returns_mean": {"default_agent": 2.899999999999998}, "rlmodule_inference_timer": 4.2667773272472296e-05, "module_episode_returns_mean": {"default_policy": 2.899999999999998}, "num_episodes": 250.0, "episode_duration_sec_mean": 0.0049016814874485145, "env_reset_timer": 3.3596449349701824e-05, "num_agent_steps_sampled_lifetime": {"default_agent": -3695000.0}, "episode_return_max": 8.5, "sample": 0.005148418294933422, "num_module_steps_sampled": {"default_policy": 5000.0}, "num_env_steps_sampled": 5000.0, "episode_return_min": -11.5, "env_to_module_sum_episodes_length_out": 10.36823839457432, "num_episodes_lifetime": -184750.0, "episode_len_mean": 20.0, "time_between_sampling": 0.0015013821540425028, "episode_len_max": 20, "env_to_module_sum_episodes_length_in": 10.36823839457432, "num_env_steps_sampled_lifetime": -3695000.0, "env_step_timer": 1.3747739690227173e-05, "num_module_steps_sampled_lifetime": {"default_policy": -3695000.0}, "episode_len_min": 20, "episode_return_mean": 2.899999999999998, "num_env_steps_sampled_lifetime_throughput": 3703.994651377737}, "learners": {"default_policy": {"vf_loss": 0.10278083384037018, "num_module_steps_trained": 6000, "entropy": 0.5958549976348877, "gradients_default_optimizer_global_norm": 0.025655152276158333, "curr_kl_coeff": 0.0029160012491047382, "vf_loss_unclipped": 28.120574951171875, "diff_num_grad_updates_vs_sampler_policy": 1.0, "vf_explained_var": -0.0067958831787109375, "default_optimizer_learning_rate": 0.0002847858517, "total_loss": -0.009110665880143642, "num_module_steps_trained_lifetime": 48000, "num_trainable_parameters": 6003, "module_train_batch_size_mean": 1000.0, "curr_entropy_coeff": 0.0090570820258, "mean_kl_loss": 9.257249621441588e-05, "weights_seq_no": 8.0, "policy_loss": -0.07245510071516037, "num_module_steps_trained_lifetime_throughput": 432550.7324000229}, "__all_modules__": {"num_non_trainable_parameters": 0, "num_module_steps_trained_lifetime": 48000, "num_trainable_parameters": 6003, "learner_connector": {"connector_pipeline_timer": 0.08177882795564559, "timers": {"connectors": {"add_columns_from_episodes_to_train_batch": 0.03380883049222344, "add_time_dim_to_batch_and_zero_pad": 1.242726857699866e-05, "add_observations_from_episodes_to_batch": 0.0008098721408014004, "batch_individual_items": 0.032002851476669744, "add_one_ts_to_episodes_and_truncate": 0.007457380522452739, "general_advantage_estimation": 0.007509249237300072, "numpy_to_tensor": 5.963559187639865e-05, "add_states_from_episodes_to_batch": 3.2734982132570667e-06}}}, "num_env_steps_trained_lifetime": 252000, "learner_connector_sum_episodes_length_out": 5250.0, "num_module_steps_trained": 6000, "learner_connector_sum_episodes_length_in": 5000.0, "num_env_steps_trained": 31500, "num_env_steps_trained_lifetime_throughput": 2259152.3993117134, "num_module_steps_trained_throughput": 432139.1066491916, "num_module_steps_trained_lifetime_throughput": 431430.8257968501}}, "num_training_step_calls_per_iteration": 1, "evaluation": {"env_runners": {"num_episodes": 20, "episode_return_max": 14.5, "agent_episode_returns_mean": {"default_agent": 1.0}, "env_to_module_connector": {"timers": {"connectors": {"numpy_to_tensor": 8.167854274890133e-06, "add_states_from_episodes_to_batch": 1.5312162231567294e-06, "add_time_dim_to_batch_and_zero_pad": 2.087144832346663e-06, "add_observations_from_episodes_to_batch": 2.751473748064167e-06, "batch_individual_items": 6.009462255480558e-06}}, "connector_pipeline_timer": 4.1637646228353186e-05}, "module_episode_returns_mean": {"default_policy": 1.0}, "num_env_steps_sampled": 400, "module_to_env_connector": {"timers": {"connectors": {"remove_single_ts_time_rank_from_batch": 5.590698336799579e-07, "un_batch_to_individual_items": 5.182215686460584e-06, "tensor_to_numpy": 1.245872850228617e-05, "normalize_and_clip_actions": 9.150324356400786e-06, "listify_data_for_vector_env": 1.0747361399298597e-05, "get_actions": 3.486656947559061e-05}}, "connector_pipeline_timer": 9.80002723984524e-05}, "num_module_steps_sampled": {"default_policy": 400}, "episode_len_mean": 20.0, "episode_len_min": 20, "rlmodule_inference_timer": 2.583146434226548e-05, "episode_duration_sec_mean": 0.0043840012443251905, "sample": 0.10110428627238974, "num_agent_steps_sampled": {"default_agent": 400}, "env_to_module_sum_episodes_length_out": 10.3682383945743, "num_episodes_lifetime": 160, "episode_len_max": 20, "env_step_timer": 1.3706501084377942e-05, "episode_return_mean": 1.0, "env_reset_timer": 0.0005087477294818255, "episode_return_min": -14.5, "num_agent_steps_sampled_lifetime": {"default_agent": 3200}, "env_to_module_sum_episodes_length_in": 10.3682383945743, "num_env_steps_sampled_lifetime": 40400, "weights_seq_no": 8.0, "num_module_steps_sampled_lifetime": {"default_policy": 3200}, "time_between_sampling": 1.5914256645583424}, "num_healthy_workers": 1, "actor_manager_num_outstanding_async_reqs": 0, "num_remote_worker_restarts": 0}, "num_env_steps_sampled_lifetime": -3695000.0, "fault_tolerance": {"num_healthy_workers": 0, "num_remote_worker_restarts": 0}, "env_runner_group": {"actor_manager_num_outstanding_async_reqs": 0}, "done": false, "training_iteration": 8, "trial_id": "43ce3_00000", "date": "2025-08-11_19-23-11", "timestamp": 1754932991, "time_this_iter_s": 1.6606338024139404, "time_total_s": 13.256585836410522, "pid": 14399, "hostname": "Mac", "node_ip": "127.0.0.1", "config": {"exploration_config": {}, "extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "placement_strategy": "PACK", "num_gpus": 0, "_fake_gpus": false, "num_cpus_for_main_process": 2, "eager_tracing": true, "eager_max_retraces": 20, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "torch_compile_learner": false, "torch_compile_learner_what_to_compile": "forward_train", "torch_compile_learner_dynamo_backend": "aot_eager", "torch_compile_learner_dynamo_mode": null, "torch_compile_worker": false, "torch_compile_worker_dynamo_backend": "aot_eager", "torch_compile_worker_dynamo_mode": null, "torch_ddp_kwargs": {}, "torch_skip_nan_gradients": false, "env": "Umbrella", "env_config": {}, "observation_space": null, "action_space": null, "clip_rewards": null, "normalize_actions": true, "clip_actions": false, "_is_atari": null, "disable_env_checking": false, "render_env": false, "action_mask_key": "action_mask", "env_runner_cls": null, "num_env_runners": 0, "create_local_env_runner": true, "num_envs_per_env_runner": 1, "gym_env_vectorize_mode": "SYNC", "num_cpus_per_env_runner": 1, "num_gpus_per_env_runner": 0, "custom_resources_per_env_runner": {}, "validate_env_runners_after_construction": true, "episodes_to_numpy": true, "max_requests_in_flight_per_env_runner": 1, "sample_timeout_s": 60.0, "_env_to_module_connector": null, "add_default_connectors_to_env_to_module_pipeline": true, "_module_to_env_connector": null, "add_default_connectors_to_module_to_env_pipeline": true, "merge_env_runner_states": "training_only", "broadcast_env_runner_states": true, "episode_lookback_horizon": 1, "rollout_fragment_length": "auto", "batch_mode": "complete_episodes", "compress_observations": false, "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "enable_tf1_exec_eagerly": false, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "preprocessor_pref": "deepmind", "observation_filter": "NoFilter", "update_worker_filter_stats": true, "use_worker_filter_stats": true, "sampler_perf_stats_ema_coef": null, "_is_online": true, "num_learners": 0, "num_gpus_per_learner": 0, "num_cpus_per_learner": "auto", "num_aggregator_actors_per_learner": 0, "max_requests_in_flight_per_aggregator_actor": 3, "local_gpu_idx": 0, "max_requests_in_flight_per_learner": 3, "gamma": 1, "lr": 0.0002847858517, "grad_clip": 0.5, "grad_clip_by": "global_norm", "_train_batch_size_per_learner": 5000, "train_batch_size": 4000, "num_epochs": 1, "minibatch_size": 1000, "shuffle_batch_per_epoch": true, "model": {"fcnet_hiddens": [256, 256], "fcnet_activation": "tanh", "fcnet_weights_initializer": null, "fcnet_weights_initializer_config": null, "fcnet_bias_initializer": null, "fcnet_bias_initializer_config": null, "conv_filters": null, "conv_activation": "relu", "conv_kernel_initializer": null, "conv_kernel_initializer_config": null, "conv_bias_initializer": null, "conv_bias_initializer_config": null, "conv_transpose_kernel_initializer": null, "conv_transpose_kernel_initializer_config": null, "conv_transpose_bias_initializer": null, "conv_transpose_bias_initializer_config": null, "post_fcnet_hiddens": [], "post_fcnet_activation": "relu", "post_fcnet_weights_initializer": null, "post_fcnet_weights_initializer_config": null, "post_fcnet_bias_initializer": null, "post_fcnet_bias_initializer_config": null, "free_log_std": false, "log_std_clip_param": 20.0, "no_final_linear": false, "vf_share_layers": false, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "lstm_weights_initializer": null, "lstm_weights_initializer_config": null, "lstm_bias_initializer": null, "lstm_bias_initializer_config": null, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "attention_use_n_prev_actions": 0, "attention_use_n_prev_rewards": 0, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": null, "custom_model_config": {}, "custom_action_dist": null, "custom_preprocessor": null, "encoder_latent_dim": null, "always_check_shapes": false, "lstm_use_prev_action_reward": -1, "_use_default_native_models": -1, "_disable_preprocessor_api": false, "_disable_action_flattening": false}, "_learner_connector": null, "add_default_connectors_to_learner_pipeline": true, "learner_config_dict": {}, "optimizer": {}, "_learner_class": null, "callbacks_on_algorithm_init": null, "callbacks_on_env_runners_recreated": null, "callbacks_on_offline_eval_runners_recreated": null, "callbacks_on_checkpoint_loaded": null, "callbacks_on_environment_created": null, "callbacks_on_episode_created": null, "callbacks_on_episode_start": null, "callbacks_on_episode_step": null, "callbacks_on_episode_end": null, "callbacks_on_evaluate_start": null, "callbacks_on_evaluate_end": null, "callbacks_on_evaluate_offline_start": null, "callbacks_on_evaluate_offline_end": null, "callbacks_on_sample_end": null, "callbacks_on_train_result": null, "explore": true, "enable_rl_module_and_learner": true, "enable_env_runner_and_connector_v2": true, "_prior_exploration_config": {"type": "StochasticSampling"}, "count_steps_by": "env_steps", "policy_map_capacity": 100, "policy_mapping_fn": "<function AlgorithmConfig.DEFAULT_POLICY_MAPPING_FN at 0x388aedb20>", "policies_to_train": null, "policy_states_are_swappable": false, "observation_fn": null, "offline_data_class": null, "input_read_method": "read_parquet", "input_read_method_kwargs": {}, "input_read_schema": {}, "input_read_episodes": false, "input_read_sample_batches": false, "input_read_batch_size": null, "input_filesystem": null, "input_filesystem_kwargs": {}, "input_compress_columns": ["obs", "new_obs"], "input_spaces_jsonable": true, "materialize_data": false, "materialize_mapped_data": true, "map_batches_kwargs": {}, "iter_batches_kwargs": {}, "ignore_final_observation": false, "prelearner_class": null, "prelearner_buffer_class": null, "prelearner_buffer_kwargs": {}, "prelearner_module_synch_period": 10, "dataset_num_iters_per_learner": null, "input_config": {}, "actions_in_input_normalized": false, "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_config": {}, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "output_max_rows_per_file": null, "output_write_remaining_data": false, "output_write_method": "write_parquet", "output_write_method_kwargs": {}, "output_filesystem": null, "output_filesystem_kwargs": {}, "output_write_episodes": true, "offline_sampling": false, "evaluation_interval": 1, "evaluation_duration": 20, "evaluation_duration_unit": "episodes", "evaluation_sample_timeout_s": 120.0, "evaluation_auto_duration_min_env_steps_per_sample": 100, "evaluation_auto_duration_max_env_steps_per_sample": 2000, "evaluation_parallel_to_training": false, "evaluation_force_reset_envs_before_iteration": true, "evaluation_config": null, "off_policy_estimation_methods": {}, "ope_split_batch_by_episode": true, "evaluation_num_env_runners": 1, "in_evaluation": false, "sync_filters_on_rollout_workers_timeout_s": 10.0, "offline_evaluation_interval": null, "num_offline_eval_runners": 0, "offline_loss_for_module_fn": null, "offline_evaluation_duration": 1, "offline_evaluation_parallel_to_training": false, "offline_evaluation_timeout_s": 120.0, "num_cpus_per_offline_eval_runner": 1, "num_gpus_per_offline_eval_runner": 0, "custom_resources_per_offline_eval_runner": {}, "restart_failed_offline_eval_runners": true, "ignore_offline_eval_runner_failures": false, "max_num_offline_eval_runner_restarts": 1000, "offline_eval_runner_restore_timeout_s": 1800.0, "max_requests_in_flight_per_offline_eval_runner": 1, "validate_offline_eval_runners_after_construction": true, "offline_eval_runner_health_probe_timeout_s": 30.0, "offline_eval_rl_module_inference_only": false, "broadcast_offline_eval_runner_states": false, "offline_eval_batch_size_per_runner": 256, "dataset_num_iters_per_eval_runner": 1, "keep_per_episode_custom_metrics": false, "metrics_episode_collection_timeout_s": 60.0, "metrics_num_episodes_for_smoothing": 100, "min_time_s_per_iteration": null, "min_train_timesteps_per_iteration": 0, "min_sample_timesteps_per_iteration": 0, "log_gradients": true, "export_native_model_files": false, "checkpoint_trainable_policies_only": false, "logger_creator": null, "logger_config": null, "log_level": "WARN", "log_sys_usage": true, "fake_sampler": false, "seed": 2, "restart_failed_env_runners": true, "ignore_env_runner_failures": false, "max_num_env_runner_restarts": 1000, "delay_between_env_runner_restarts_s": 60.0, "restart_failed_sub_environments": false, "num_consecutive_env_runner_failures_tolerance": 100, "env_runner_health_probe_timeout_s": 30.0, "env_runner_restore_timeout_s": 1800.0, "_model_config": {}, "_rl_module_spec": "RLModuleSpec(module_class=None, observation_space=None, action_space=None, inference_only=False, learner_only=False, model_config=DefaultModelConfig(fcnet_hiddens=[60, 90], fcnet_activation='tanh', fcnet_kernel_initializer=None, fcnet_kernel_initializer_kwargs=None, fcnet_bias_initializer=None, fcnet_bias_initializer_kwargs=None, conv_filters=None, conv_activation='relu', conv_kernel_initializer=None, conv_kernel_initializer_kwargs=None, conv_bias_initializer=None, conv_bias_initializer_kwargs=None, head_fcnet_hiddens=[], head_fcnet_activation='relu', head_fcnet_kernel_initializer=None, head_fcnet_kernel_initializer_kwargs=None, head_fcnet_bias_initializer=None, head_fcnet_bias_initializer_kwargs=None, free_log_std=False, log_std_clip_param=20.0, vf_share_layers=True, use_lstm=False, max_seq_len=20, lstm_cell_size=256, lstm_use_prev_action=False, lstm_use_prev_reward=False, lstm_kernel_initializer=None, lstm_kernel_initializer_kwargs=None, lstm_bias_initializer=None, lstm_bias_initializer_kwargs=None), catalog_class=None, load_state_path=None, model_config_dict=None)", "algorithm_config_overrides_per_module": {}, "_per_module_overrides": {}, "_validate_config": true, "_use_msgpack_checkpoints": false, "_torch_grad_scaler_class": null, "_torch_lr_scheduler_classes": null, "_tf_policy_handles_more_than_one_loss": false, "_disable_preprocessor_api": false, "_disable_action_flattening": false, "_disable_initialize_loss_from_dummy_batch": false, "_dont_auto_sync_env_runner_states": false, "env_task_fn": -1, "enable_connectors": -1, "simple_optimizer": false, "policy_map_cache": -1, "worker_cls": -1, "synchronize_filters": -1, "enable_async_evaluation": -1, "custom_async_evaluation_function": -1, "_enable_rl_module_api": -1, "auto_wrap_old_gym_envs": -1, "always_attach_evaluation_results": -1, "replay_sequence_length": null, "_disable_execution_plan_api": -1, "use_critic": true, "use_gae": true, "use_kl_loss": true, "kl_coeff": 0.7464963036515, "kl_target": 0.0270990929592, "vf_loss_coeff": 0.6688075857018, "entropy_coeff": 0.0090570820258, "clip_param": 0.1221781641624, "vf_clip_param": 0.1027808522125, "entropy_coeff_schedule": null, "lr_schedule": null, "sgd_minibatch_size": -1, "vf_share_layers": -1, "__stdout_file__": null, "__stderr_file__": null, "lambda": 0.9099046732075, "input": "sampler", "policies": {"default_policy": [null, null, null, null]}, "callbacks": "<class 'ray.rllib.callbacks.callbacks.RLlibCallback'>", "create_env_on_driver": false, "custom_eval_function": null, "framework": "torch"}, "time_since_restore": 13.256585836410522, "iterations_since_restore": 8, "perf": {"cpu_util_percent": 41.15, "ram_util_percent": 78.5}}
{"timers": {"training_iteration": 1.5996491952776628, "restore_env_runners": 9.569772507840695e-06, "training_step": 1.5995166726829366, "env_runner_sampling_timer": 1.4894222400248063, "learner_update_timer": 0.10718191356030865, "synch_weights": 0.0005510131454310243, "restore_eval_env_runners": 8.375129534026585e-06, "evaluation_iteration": 0.1141016587270741, "synch_eval_env_connectors": 0.0001127269868452813, "synch_env_connectors": 4.698503128281226e-06}, "env_runners": {"weights_seq_no": 8.0, "num_agent_steps_sampled": {"default_agent": 5000.0}, "env_to_module_connector": {"timers": {"connectors": {"numpy_to_tensor": 8.472476439582773e-06, "add_states_from_episodes_to_batch": 1.732392388373528e-06, "batch_individual_items": 6.1699089569714e-06, "add_time_dim_to_batch_and_zero_pad": 2.352461808909581e-06, "add_observations_from_episodes_to_batch": 2.9003460640920884e-06}}, "connector_pipeline_timer": 4.353017445730413e-05}, "module_to_env_connector": {"timers": {"connectors": {"listify_data_for_vector_env": 1.0997090791153777e-05, "tensor_to_numpy": 1.3140191035485843e-05, "remove_single_ts_time_rank_from_batch": 5.838452167583911e-07, "un_batch_to_individual_items": 5.3293748846523044e-06, "get_actions": 3.841948940038006e-05, "normalize_and_clip_actions": 9.347709269436722e-06}}, "connector_pipeline_timer": 0.00010385468588505697}, "agent_episode_returns_mean": {"default_agent": 4.740000000000002}, "rlmodule_inference_timer": 2.7388310721086467e-05, "module_episode_returns_mean": {"default_policy": 4.740000000000002}, "num_episodes": 250.0, "episode_duration_sec_mean": 0.004538224500603975, "env_reset_timer": 3.229033493135516e-05, "num_agent_steps_sampled_lifetime": {"default_agent": -4312500.0}, "episode_return_max": 8.5, "sample": 0.004916215321484218, "num_module_steps_sampled": {"default_policy": 5000.0}, "num_env_steps_sampled": 5000.0, "episode_return_min": -11.5, "env_to_module_sum_episodes_length_out": 10.36823839457432, "num_episodes_lifetime": -215625.0, "episode_len_mean": 20.0, "time_between_sampling": 0.0014676780224552285, "episode_len_max": 20, "env_to_module_sum_episodes_length_in": 10.36823839457432, "num_env_steps_sampled_lifetime": -4312500.0, "env_step_timer": 1.362136510090431e-05, "num_module_steps_sampled_lifetime": {"default_policy": -4312500.0}, "episode_len_min": 20, "episode_return_mean": 4.740000000000002, "num_env_steps_sampled_lifetime_throughput": 3748.0888655245253}, "learners": {"default_policy": {"vf_loss": 0.10278083384037018, "num_module_steps_trained": 6000, "entropy": 0.5808447599411011, "gradients_default_optimizer_global_norm": 0.05536004900932312, "curr_kl_coeff": 0.0014580006245523691, "vf_loss_unclipped": 27.78199577331543, "diff_num_grad_updates_vs_sampler_policy": 1.0, "vf_explained_var": 0.0010166168212890625, "default_optimizer_learning_rate": 0.0002847858517, "total_loss": -0.09930161386728287, "num_module_steps_trained_lifetime": 54000, "num_trainable_parameters": 6003, "module_train_batch_size_mean": 1000.0, "curr_entropy_coeff": 0.0090570820258, "mean_kl_loss": 0.0007413393468596041, "weights_seq_no": 9.0, "policy_loss": -0.16278362274169922, "num_module_steps_trained_lifetime_throughput": 432815.2597521774}, "__all_modules__": {"num_non_trainable_parameters": 0, "num_module_steps_trained_lifetime": 54000, "num_trainable_parameters": 6003, "learner_connector": {"connector_pipeline_timer": 0.08259761259634077, "timers": {"connectors": {"add_columns_from_episodes_to_train_batch": 0.033805270937109874, "add_time_dim_to_batch_and_zero_pad": 1.2389665934175609e-05, "add_observations_from_episodes_to_batch": 0.00081012549928778, "batch_individual_items": 0.03198778504187508, "add_one_ts_to_episodes_and_truncate": 0.00831753838765069, "general_advantage_estimation": 0.0074864771549588965, "numpy_to_tensor": 5.964048617027423e-05, "add_states_from_episodes_to_batch": 3.2720137601157184e-06}}}, "num_env_steps_trained_lifetime": 283500, "learner_connector_sum_episodes_length_out": 5250.0, "num_module_steps_trained": 6000, "learner_connector_sum_episodes_length_in": 5000.0, "num_env_steps_trained": 31500, "num_env_steps_trained_lifetime_throughput": 2261129.201020518, "num_module_steps_trained_throughput": 432449.1430701494, "num_module_steps_trained_lifetime_throughput": 431762.34324933996}}, "num_training_step_calls_per_iteration": 1, "evaluation": {"env_runners": {"num_episodes": 20, "episode_return_max": 14.5, "agent_episode_returns_mean": {"default_agent": 0.8}, "env_to_module_connector": {"timers": {"connectors": {"numpy_to_tensor": 8.134346627394468e-06, "add_states_from_episodes_to_batch": 1.5514545852715217e-06, "add_time_dim_to_batch_and_zero_pad": 2.1099870809913397e-06, "add_observations_from_episodes_to_batch": 2.7667258028183727e-06, "batch_individual_items": 6.129264091208334e-06}}, "connector_pipeline_timer": 4.1854976621505396e-05}, "module_episode_returns_mean": {"default_policy": 0.8}, "num_env_steps_sampled": 400, "module_to_env_connector": {"timers": {"connectors": {"remove_single_ts_time_rank_from_batch": 5.703631743591675e-07, "un_batch_to_individual_items": 5.2377799932693936e-06, "tensor_to_numpy": 1.2483658467947238e-05, "normalize_and_clip_actions": 9.305540057179247e-06, "listify_data_for_vector_env": 1.093262271974534e-05, "get_actions": 3.425114809222129e-05}}, "connector_pipeline_timer": 9.82796085137663e-05}, "num_module_steps_sampled": {"default_policy": 400}, "episode_len_mean": 20.0, "episode_len_min": 20, "rlmodule_inference_timer": 2.560100226549467e-05, "episode_duration_sec_mean": 0.004382722052978352, "sample": 0.10104579507957266, "num_agent_steps_sampled": {"default_agent": 400}, "env_to_module_sum_episodes_length_out": 10.368238394574323, "num_episodes_lifetime": 180, "episode_len_max": 20, "env_step_timer": 1.3819759057085642e-05, "episode_return_mean": 0.8, "env_reset_timer": 0.0005043402515440967, "episode_return_min": -14.5, "num_agent_steps_sampled_lifetime": {"default_agent": 3600}, "env_to_module_sum_episodes_length_in": 10.368238394574323, "num_env_steps_sampled_lifetime": 45400, "weights_seq_no": 9.0, "num_module_steps_sampled_lifetime": {"default_policy": 3600}, "time_between_sampling": 1.5912002220820207}, "num_healthy_workers": 1, "actor_manager_num_outstanding_async_reqs": 0, "num_remote_worker_restarts": 0}, "num_env_steps_sampled_lifetime": -4312500.0, "fault_tolerance": {"num_healthy_workers": 0, "num_remote_worker_restarts": 0}, "env_runner_group": {"actor_manager_num_outstanding_async_reqs": 0}, "done": false, "training_iteration": 9, "trial_id": "43ce3_00000", "date": "2025-08-11_19-23-13", "timestamp": 1754932993, "time_this_iter_s": 1.654358148574829, "time_total_s": 14.910943984985352, "pid": 14399, "hostname": "Mac", "node_ip": "127.0.0.1", "config": {"exploration_config": {}, "extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "placement_strategy": "PACK", "num_gpus": 0, "_fake_gpus": false, "num_cpus_for_main_process": 2, "eager_tracing": true, "eager_max_retraces": 20, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "torch_compile_learner": false, "torch_compile_learner_what_to_compile": "forward_train", "torch_compile_learner_dynamo_backend": "aot_eager", "torch_compile_learner_dynamo_mode": null, "torch_compile_worker": false, "torch_compile_worker_dynamo_backend": "aot_eager", "torch_compile_worker_dynamo_mode": null, "torch_ddp_kwargs": {}, "torch_skip_nan_gradients": false, "env": "Umbrella", "env_config": {}, "observation_space": null, "action_space": null, "clip_rewards": null, "normalize_actions": true, "clip_actions": false, "_is_atari": null, "disable_env_checking": false, "render_env": false, "action_mask_key": "action_mask", "env_runner_cls": null, "num_env_runners": 0, "create_local_env_runner": true, "num_envs_per_env_runner": 1, "gym_env_vectorize_mode": "SYNC", "num_cpus_per_env_runner": 1, "num_gpus_per_env_runner": 0, "custom_resources_per_env_runner": {}, "validate_env_runners_after_construction": true, "episodes_to_numpy": true, "max_requests_in_flight_per_env_runner": 1, "sample_timeout_s": 60.0, "_env_to_module_connector": null, "add_default_connectors_to_env_to_module_pipeline": true, "_module_to_env_connector": null, "add_default_connectors_to_module_to_env_pipeline": true, "merge_env_runner_states": "training_only", "broadcast_env_runner_states": true, "episode_lookback_horizon": 1, "rollout_fragment_length": "auto", "batch_mode": "complete_episodes", "compress_observations": false, "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "enable_tf1_exec_eagerly": false, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "preprocessor_pref": "deepmind", "observation_filter": "NoFilter", "update_worker_filter_stats": true, "use_worker_filter_stats": true, "sampler_perf_stats_ema_coef": null, "_is_online": true, "num_learners": 0, "num_gpus_per_learner": 0, "num_cpus_per_learner": "auto", "num_aggregator_actors_per_learner": 0, "max_requests_in_flight_per_aggregator_actor": 3, "local_gpu_idx": 0, "max_requests_in_flight_per_learner": 3, "gamma": 1, "lr": 0.0002847858517, "grad_clip": 0.5, "grad_clip_by": "global_norm", "_train_batch_size_per_learner": 5000, "train_batch_size": 4000, "num_epochs": 1, "minibatch_size": 1000, "shuffle_batch_per_epoch": true, "model": {"fcnet_hiddens": [256, 256], "fcnet_activation": "tanh", "fcnet_weights_initializer": null, "fcnet_weights_initializer_config": null, "fcnet_bias_initializer": null, "fcnet_bias_initializer_config": null, "conv_filters": null, "conv_activation": "relu", "conv_kernel_initializer": null, "conv_kernel_initializer_config": null, "conv_bias_initializer": null, "conv_bias_initializer_config": null, "conv_transpose_kernel_initializer": null, "conv_transpose_kernel_initializer_config": null, "conv_transpose_bias_initializer": null, "conv_transpose_bias_initializer_config": null, "post_fcnet_hiddens": [], "post_fcnet_activation": "relu", "post_fcnet_weights_initializer": null, "post_fcnet_weights_initializer_config": null, "post_fcnet_bias_initializer": null, "post_fcnet_bias_initializer_config": null, "free_log_std": false, "log_std_clip_param": 20.0, "no_final_linear": false, "vf_share_layers": false, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "lstm_weights_initializer": null, "lstm_weights_initializer_config": null, "lstm_bias_initializer": null, "lstm_bias_initializer_config": null, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "attention_use_n_prev_actions": 0, "attention_use_n_prev_rewards": 0, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": null, "custom_model_config": {}, "custom_action_dist": null, "custom_preprocessor": null, "encoder_latent_dim": null, "always_check_shapes": false, "lstm_use_prev_action_reward": -1, "_use_default_native_models": -1, "_disable_preprocessor_api": false, "_disable_action_flattening": false}, "_learner_connector": null, "add_default_connectors_to_learner_pipeline": true, "learner_config_dict": {}, "optimizer": {}, "_learner_class": null, "callbacks_on_algorithm_init": null, "callbacks_on_env_runners_recreated": null, "callbacks_on_offline_eval_runners_recreated": null, "callbacks_on_checkpoint_loaded": null, "callbacks_on_environment_created": null, "callbacks_on_episode_created": null, "callbacks_on_episode_start": null, "callbacks_on_episode_step": null, "callbacks_on_episode_end": null, "callbacks_on_evaluate_start": null, "callbacks_on_evaluate_end": null, "callbacks_on_evaluate_offline_start": null, "callbacks_on_evaluate_offline_end": null, "callbacks_on_sample_end": null, "callbacks_on_train_result": null, "explore": true, "enable_rl_module_and_learner": true, "enable_env_runner_and_connector_v2": true, "_prior_exploration_config": {"type": "StochasticSampling"}, "count_steps_by": "env_steps", "policy_map_capacity": 100, "policy_mapping_fn": "<function AlgorithmConfig.DEFAULT_POLICY_MAPPING_FN at 0x388aedb20>", "policies_to_train": null, "policy_states_are_swappable": false, "observation_fn": null, "offline_data_class": null, "input_read_method": "read_parquet", "input_read_method_kwargs": {}, "input_read_schema": {}, "input_read_episodes": false, "input_read_sample_batches": false, "input_read_batch_size": null, "input_filesystem": null, "input_filesystem_kwargs": {}, "input_compress_columns": ["obs", "new_obs"], "input_spaces_jsonable": true, "materialize_data": false, "materialize_mapped_data": true, "map_batches_kwargs": {}, "iter_batches_kwargs": {}, "ignore_final_observation": false, "prelearner_class": null, "prelearner_buffer_class": null, "prelearner_buffer_kwargs": {}, "prelearner_module_synch_period": 10, "dataset_num_iters_per_learner": null, "input_config": {}, "actions_in_input_normalized": false, "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_config": {}, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "output_max_rows_per_file": null, "output_write_remaining_data": false, "output_write_method": "write_parquet", "output_write_method_kwargs": {}, "output_filesystem": null, "output_filesystem_kwargs": {}, "output_write_episodes": true, "offline_sampling": false, "evaluation_interval": 1, "evaluation_duration": 20, "evaluation_duration_unit": "episodes", "evaluation_sample_timeout_s": 120.0, "evaluation_auto_duration_min_env_steps_per_sample": 100, "evaluation_auto_duration_max_env_steps_per_sample": 2000, "evaluation_parallel_to_training": false, "evaluation_force_reset_envs_before_iteration": true, "evaluation_config": null, "off_policy_estimation_methods": {}, "ope_split_batch_by_episode": true, "evaluation_num_env_runners": 1, "in_evaluation": false, "sync_filters_on_rollout_workers_timeout_s": 10.0, "offline_evaluation_interval": null, "num_offline_eval_runners": 0, "offline_loss_for_module_fn": null, "offline_evaluation_duration": 1, "offline_evaluation_parallel_to_training": false, "offline_evaluation_timeout_s": 120.0, "num_cpus_per_offline_eval_runner": 1, "num_gpus_per_offline_eval_runner": 0, "custom_resources_per_offline_eval_runner": {}, "restart_failed_offline_eval_runners": true, "ignore_offline_eval_runner_failures": false, "max_num_offline_eval_runner_restarts": 1000, "offline_eval_runner_restore_timeout_s": 1800.0, "max_requests_in_flight_per_offline_eval_runner": 1, "validate_offline_eval_runners_after_construction": true, "offline_eval_runner_health_probe_timeout_s": 30.0, "offline_eval_rl_module_inference_only": false, "broadcast_offline_eval_runner_states": false, "offline_eval_batch_size_per_runner": 256, "dataset_num_iters_per_eval_runner": 1, "keep_per_episode_custom_metrics": false, "metrics_episode_collection_timeout_s": 60.0, "metrics_num_episodes_for_smoothing": 100, "min_time_s_per_iteration": null, "min_train_timesteps_per_iteration": 0, "min_sample_timesteps_per_iteration": 0, "log_gradients": true, "export_native_model_files": false, "checkpoint_trainable_policies_only": false, "logger_creator": null, "logger_config": null, "log_level": "WARN", "log_sys_usage": true, "fake_sampler": false, "seed": 2, "restart_failed_env_runners": true, "ignore_env_runner_failures": false, "max_num_env_runner_restarts": 1000, "delay_between_env_runner_restarts_s": 60.0, "restart_failed_sub_environments": false, "num_consecutive_env_runner_failures_tolerance": 100, "env_runner_health_probe_timeout_s": 30.0, "env_runner_restore_timeout_s": 1800.0, "_model_config": {}, "_rl_module_spec": "RLModuleSpec(module_class=None, observation_space=None, action_space=None, inference_only=False, learner_only=False, model_config=DefaultModelConfig(fcnet_hiddens=[60, 90], fcnet_activation='tanh', fcnet_kernel_initializer=None, fcnet_kernel_initializer_kwargs=None, fcnet_bias_initializer=None, fcnet_bias_initializer_kwargs=None, conv_filters=None, conv_activation='relu', conv_kernel_initializer=None, conv_kernel_initializer_kwargs=None, conv_bias_initializer=None, conv_bias_initializer_kwargs=None, head_fcnet_hiddens=[], head_fcnet_activation='relu', head_fcnet_kernel_initializer=None, head_fcnet_kernel_initializer_kwargs=None, head_fcnet_bias_initializer=None, head_fcnet_bias_initializer_kwargs=None, free_log_std=False, log_std_clip_param=20.0, vf_share_layers=True, use_lstm=False, max_seq_len=20, lstm_cell_size=256, lstm_use_prev_action=False, lstm_use_prev_reward=False, lstm_kernel_initializer=None, lstm_kernel_initializer_kwargs=None, lstm_bias_initializer=None, lstm_bias_initializer_kwargs=None), catalog_class=None, load_state_path=None, model_config_dict=None)", "algorithm_config_overrides_per_module": {}, "_per_module_overrides": {}, "_validate_config": true, "_use_msgpack_checkpoints": false, "_torch_grad_scaler_class": null, "_torch_lr_scheduler_classes": null, "_tf_policy_handles_more_than_one_loss": false, "_disable_preprocessor_api": false, "_disable_action_flattening": false, "_disable_initialize_loss_from_dummy_batch": false, "_dont_auto_sync_env_runner_states": false, "env_task_fn": -1, "enable_connectors": -1, "simple_optimizer": false, "policy_map_cache": -1, "worker_cls": -1, "synchronize_filters": -1, "enable_async_evaluation": -1, "custom_async_evaluation_function": -1, "_enable_rl_module_api": -1, "auto_wrap_old_gym_envs": -1, "always_attach_evaluation_results": -1, "replay_sequence_length": null, "_disable_execution_plan_api": -1, "use_critic": true, "use_gae": true, "use_kl_loss": true, "kl_coeff": 0.7464963036515, "kl_target": 0.0270990929592, "vf_loss_coeff": 0.6688075857018, "entropy_coeff": 0.0090570820258, "clip_param": 0.1221781641624, "vf_clip_param": 0.1027808522125, "entropy_coeff_schedule": null, "lr_schedule": null, "sgd_minibatch_size": -1, "vf_share_layers": -1, "__stdout_file__": null, "__stderr_file__": null, "lambda": 0.9099046732075, "input": "sampler", "policies": {"default_policy": [null, null, null, null]}, "callbacks": "<class 'ray.rllib.callbacks.callbacks.RLlibCallback'>", "create_env_on_driver": false, "custom_eval_function": null, "framework": "torch"}, "time_since_restore": 14.910943984985352, "iterations_since_restore": 9, "perf": {"cpu_util_percent": 21.033333333333335, "ram_util_percent": 78.63333333333333}}
{"timers": {"training_iteration": 1.599397362904245, "restore_env_runners": 9.534495498943685e-06, "training_step": 1.5992644851163844, "env_runner_sampling_timer": 1.4884428242950674, "learner_update_timer": 0.10790812609474695, "synch_weights": 0.0005507471738148988, "restore_eval_env_runners": 8.35096891362309e-06, "evaluation_iteration": 0.11396173547967683, "synch_eval_env_connectors": 0.00011252054703848771, "synch_env_connectors": 4.691098142266353e-06}, "env_runners": {"weights_seq_no": 9.0, "num_agent_steps_sampled": {"default_agent": 5000.0}, "env_to_module_connector": {"timers": {"connectors": {"numpy_to_tensor": 8.652573602097782e-06, "add_states_from_episodes_to_batch": 1.7323375691779982e-06, "batch_individual_items": 6.2030802070599e-06, "add_time_dim_to_batch_and_zero_pad": 2.3703049921838776e-06, "add_observations_from_episodes_to_batch": 2.9846187295230647e-06}}, "connector_pipeline_timer": 4.392509748913849e-05}, "module_to_env_connector": {"timers": {"connectors": {"listify_data_for_vector_env": 1.122656581236324e-05, "tensor_to_numpy": 1.329920177147411e-05, "remove_single_ts_time_rank_from_batch": 5.85671885438891e-07, "un_batch_to_individual_items": 5.3476290621248256e-06, "get_actions": 3.945406054878322e-05, "normalize_and_clip_actions": 9.43534554046776e-06}}, "connector_pipeline_timer": 0.00010551490392732104}, "agent_episode_returns_mean": {"default_agent": 3.7}, "rlmodule_inference_timer": 2.733352832598043e-05, "module_episode_returns_mean": {"default_policy": 3.7}, "num_episodes": 250.0, "episode_duration_sec_mean": 0.004589895505923777, "env_reset_timer": 3.244430826362745e-05, "num_agent_steps_sampled_lifetime": {"default_agent": -4930000.0}, "episode_return_max": 8.5, "sample": 0.004868470616273987, "num_module_steps_sampled": {"default_policy": 5000.0}, "num_env_steps_sampled": 5000.0, "episode_return_min": -11.5, "env_to_module_sum_episodes_length_out": 10.36823839457432, "num_episodes_lifetime": -246500.0, "episode_len_mean": 20.0, "time_between_sampling": 0.0017784530656383363, "episode_len_max": 20, "env_to_module_sum_episodes_length_in": 10.36823839457432, "num_env_steps_sampled_lifetime": -4930000.0, "env_step_timer": 1.3879715077138851e-05, "num_module_steps_sampled_lifetime": {"default_policy": -4930000.0}, "episode_len_min": 20, "episode_return_mean": 3.7, "num_env_steps_sampled_lifetime_throughput": 3711.5280934523457}, "learners": {"default_policy": {"vf_loss": 0.10278083384037018, "num_module_steps_trained": 6000, "entropy": 0.5488011240959167, "gradients_default_optimizer_global_norm": 0.05242887884378433, "curr_kl_coeff": 0.0007290003122761846, "vf_loss_unclipped": 28.12540626525879, "diff_num_grad_updates_vs_sampler_policy": 1.0, "vf_explained_var": -0.005507946014404297, "default_optimizer_learning_rate": 0.0002847858517, "total_loss": 0.045452482998371124, "num_module_steps_trained_lifetime": 60000, "num_trainable_parameters": 6003, "module_train_batch_size_mean": 1000.0, "curr_entropy_coeff": 0.0090570820258, "mean_kl_loss": 0.001431760611012578, "weights_seq_no": 10.0, "policy_loss": -0.01831967383623123, "num_module_steps_trained_lifetime_throughput": 432552.25996545365}, "__all_modules__": {"num_non_trainable_parameters": 0, "num_module_steps_trained_lifetime": 60000, "num_trainable_parameters": 6003, "learner_connector": {"connector_pipeline_timer": 0.08342496522019423, "timers": {"connectors": {"add_columns_from_episodes_to_train_batch": 0.033808139898170046, "add_time_dim_to_batch_and_zero_pad": 1.235076992206579e-05, "add_observations_from_episodes_to_batch": 0.0008103392435809876, "batch_individual_items": 0.0328390355315218, "add_one_ts_to_episodes_and_truncate": 0.008312532163598212, "general_advantage_estimation": 0.007464884883345009, "numpy_to_tensor": 5.9580331026268986e-05, "add_states_from_episodes_to_batch": 3.268043550392941e-06}}}, "num_env_steps_trained_lifetime": 315000, "learner_connector_sum_episodes_length_out": 5250.0, "num_module_steps_trained": 6000, "learner_connector_sum_episodes_length_in": 5000.0, "num_env_steps_trained": 31500, "num_env_steps_trained_lifetime_throughput": 2260349.622248802, "num_module_steps_trained_throughput": 432235.04600749974, "num_module_steps_trained_lifetime_throughput": 431569.3010661755}}, "num_training_step_calls_per_iteration": 1, "evaluation": {"env_runners": {"num_episodes": 20, "episode_return_max": 14.5, "agent_episode_returns_mean": {"default_agent": 0.4}, "env_to_module_connector": {"timers": {"connectors": {"numpy_to_tensor": 8.196046463901993e-06, "add_states_from_episodes_to_batch": 1.5552303398130722e-06, "add_time_dim_to_batch_and_zero_pad": 2.1244097342030278e-06, "add_observations_from_episodes_to_batch": 2.765060315479121e-06, "batch_individual_items": 6.069234399577247e-06}}, "connector_pipeline_timer": 4.2020104865451786e-05}, "module_episode_returns_mean": {"default_policy": 0.4}, "num_env_steps_sampled": 400, "module_to_env_connector": {"timers": {"connectors": {"remove_single_ts_time_rank_from_batch": 5.760800691562053e-07, "un_batch_to_individual_items": 5.207934809476494e-06, "tensor_to_numpy": 1.2498162067926207e-05, "normalize_and_clip_actions": 9.20889309233637e-06, "listify_data_for_vector_env": 1.0751322736016742e-05, "get_actions": 3.5240898218477286e-05}}, "connector_pipeline_timer": 9.870052219384886e-05}, "num_module_steps_sampled": {"default_policy": 400}, "episode_len_mean": 20.0, "episode_len_min": 20, "rlmodule_inference_timer": 2.5909730214461948e-05, "episode_duration_sec_mean": 0.004387529578525573, "sample": 0.10099471129882882, "num_agent_steps_sampled": {"default_agent": 400}, "env_to_module_sum_episodes_length_out": 10.368238394574323, "num_episodes_lifetime": 200, "episode_len_max": 20, "env_step_timer": 1.3779794505556907e-05, "episode_return_mean": 0.4, "env_reset_timer": 0.0004999772686450569, "episode_return_min": -14.5, "num_agent_steps_sampled_lifetime": {"default_agent": 4000}, "env_to_module_sum_episodes_length_in": 10.368238394574323, "num_env_steps_sampled_lifetime": 50400, "weights_seq_no": 10.0, "num_module_steps_sampled_lifetime": {"default_policy": 4000}, "time_between_sampling": 1.5911946906912873}, "num_healthy_workers": 1, "actor_manager_num_outstanding_async_reqs": 0, "num_remote_worker_restarts": 0}, "num_env_steps_sampled_lifetime": -4930000.0, "fault_tolerance": {"num_healthy_workers": 0, "num_remote_worker_restarts": 0}, "env_runner_group": {"actor_manager_num_outstanding_async_reqs": 0}, "done": false, "training_iteration": 10, "trial_id": "43ce3_00000", "date": "2025-08-11_19-23-14", "timestamp": 1754932994, "time_this_iter_s": 1.6774840354919434, "time_total_s": 16.588428020477295, "pid": 14399, "hostname": "Mac", "node_ip": "127.0.0.1", "config": {"exploration_config": {}, "extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "placement_strategy": "PACK", "num_gpus": 0, "_fake_gpus": false, "num_cpus_for_main_process": 2, "eager_tracing": true, "eager_max_retraces": 20, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "torch_compile_learner": false, "torch_compile_learner_what_to_compile": "forward_train", "torch_compile_learner_dynamo_backend": "aot_eager", "torch_compile_learner_dynamo_mode": null, "torch_compile_worker": false, "torch_compile_worker_dynamo_backend": "aot_eager", "torch_compile_worker_dynamo_mode": null, "torch_ddp_kwargs": {}, "torch_skip_nan_gradients": false, "env": "Umbrella", "env_config": {}, "observation_space": null, "action_space": null, "clip_rewards": null, "normalize_actions": true, "clip_actions": false, "_is_atari": null, "disable_env_checking": false, "render_env": false, "action_mask_key": "action_mask", "env_runner_cls": null, "num_env_runners": 0, "create_local_env_runner": true, "num_envs_per_env_runner": 1, "gym_env_vectorize_mode": "SYNC", "num_cpus_per_env_runner": 1, "num_gpus_per_env_runner": 0, "custom_resources_per_env_runner": {}, "validate_env_runners_after_construction": true, "episodes_to_numpy": true, "max_requests_in_flight_per_env_runner": 1, "sample_timeout_s": 60.0, "_env_to_module_connector": null, "add_default_connectors_to_env_to_module_pipeline": true, "_module_to_env_connector": null, "add_default_connectors_to_module_to_env_pipeline": true, "merge_env_runner_states": "training_only", "broadcast_env_runner_states": true, "episode_lookback_horizon": 1, "rollout_fragment_length": "auto", "batch_mode": "complete_episodes", "compress_observations": false, "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "enable_tf1_exec_eagerly": false, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "preprocessor_pref": "deepmind", "observation_filter": "NoFilter", "update_worker_filter_stats": true, "use_worker_filter_stats": true, "sampler_perf_stats_ema_coef": null, "_is_online": true, "num_learners": 0, "num_gpus_per_learner": 0, "num_cpus_per_learner": "auto", "num_aggregator_actors_per_learner": 0, "max_requests_in_flight_per_aggregator_actor": 3, "local_gpu_idx": 0, "max_requests_in_flight_per_learner": 3, "gamma": 1, "lr": 0.0002847858517, "grad_clip": 0.5, "grad_clip_by": "global_norm", "_train_batch_size_per_learner": 5000, "train_batch_size": 4000, "num_epochs": 1, "minibatch_size": 1000, "shuffle_batch_per_epoch": true, "model": {"fcnet_hiddens": [256, 256], "fcnet_activation": "tanh", "fcnet_weights_initializer": null, "fcnet_weights_initializer_config": null, "fcnet_bias_initializer": null, "fcnet_bias_initializer_config": null, "conv_filters": null, "conv_activation": "relu", "conv_kernel_initializer": null, "conv_kernel_initializer_config": null, "conv_bias_initializer": null, "conv_bias_initializer_config": null, "conv_transpose_kernel_initializer": null, "conv_transpose_kernel_initializer_config": null, "conv_transpose_bias_initializer": null, "conv_transpose_bias_initializer_config": null, "post_fcnet_hiddens": [], "post_fcnet_activation": "relu", "post_fcnet_weights_initializer": null, "post_fcnet_weights_initializer_config": null, "post_fcnet_bias_initializer": null, "post_fcnet_bias_initializer_config": null, "free_log_std": false, "log_std_clip_param": 20.0, "no_final_linear": false, "vf_share_layers": false, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "lstm_weights_initializer": null, "lstm_weights_initializer_config": null, "lstm_bias_initializer": null, "lstm_bias_initializer_config": null, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "attention_use_n_prev_actions": 0, "attention_use_n_prev_rewards": 0, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": null, "custom_model_config": {}, "custom_action_dist": null, "custom_preprocessor": null, "encoder_latent_dim": null, "always_check_shapes": false, "lstm_use_prev_action_reward": -1, "_use_default_native_models": -1, "_disable_preprocessor_api": false, "_disable_action_flattening": false}, "_learner_connector": null, "add_default_connectors_to_learner_pipeline": true, "learner_config_dict": {}, "optimizer": {}, "_learner_class": null, "callbacks_on_algorithm_init": null, "callbacks_on_env_runners_recreated": null, "callbacks_on_offline_eval_runners_recreated": null, "callbacks_on_checkpoint_loaded": null, "callbacks_on_environment_created": null, "callbacks_on_episode_created": null, "callbacks_on_episode_start": null, "callbacks_on_episode_step": null, "callbacks_on_episode_end": null, "callbacks_on_evaluate_start": null, "callbacks_on_evaluate_end": null, "callbacks_on_evaluate_offline_start": null, "callbacks_on_evaluate_offline_end": null, "callbacks_on_sample_end": null, "callbacks_on_train_result": null, "explore": true, "enable_rl_module_and_learner": true, "enable_env_runner_and_connector_v2": true, "_prior_exploration_config": {"type": "StochasticSampling"}, "count_steps_by": "env_steps", "policy_map_capacity": 100, "policy_mapping_fn": "<function AlgorithmConfig.DEFAULT_POLICY_MAPPING_FN at 0x388aedb20>", "policies_to_train": null, "policy_states_are_swappable": false, "observation_fn": null, "offline_data_class": null, "input_read_method": "read_parquet", "input_read_method_kwargs": {}, "input_read_schema": {}, "input_read_episodes": false, "input_read_sample_batches": false, "input_read_batch_size": null, "input_filesystem": null, "input_filesystem_kwargs": {}, "input_compress_columns": ["obs", "new_obs"], "input_spaces_jsonable": true, "materialize_data": false, "materialize_mapped_data": true, "map_batches_kwargs": {}, "iter_batches_kwargs": {}, "ignore_final_observation": false, "prelearner_class": null, "prelearner_buffer_class": null, "prelearner_buffer_kwargs": {}, "prelearner_module_synch_period": 10, "dataset_num_iters_per_learner": null, "input_config": {}, "actions_in_input_normalized": false, "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_config": {}, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "output_max_rows_per_file": null, "output_write_remaining_data": false, "output_write_method": "write_parquet", "output_write_method_kwargs": {}, "output_filesystem": null, "output_filesystem_kwargs": {}, "output_write_episodes": true, "offline_sampling": false, "evaluation_interval": 1, "evaluation_duration": 20, "evaluation_duration_unit": "episodes", "evaluation_sample_timeout_s": 120.0, "evaluation_auto_duration_min_env_steps_per_sample": 100, "evaluation_auto_duration_max_env_steps_per_sample": 2000, "evaluation_parallel_to_training": false, "evaluation_force_reset_envs_before_iteration": true, "evaluation_config": null, "off_policy_estimation_methods": {}, "ope_split_batch_by_episode": true, "evaluation_num_env_runners": 1, "in_evaluation": false, "sync_filters_on_rollout_workers_timeout_s": 10.0, "offline_evaluation_interval": null, "num_offline_eval_runners": 0, "offline_loss_for_module_fn": null, "offline_evaluation_duration": 1, "offline_evaluation_parallel_to_training": false, "offline_evaluation_timeout_s": 120.0, "num_cpus_per_offline_eval_runner": 1, "num_gpus_per_offline_eval_runner": 0, "custom_resources_per_offline_eval_runner": {}, "restart_failed_offline_eval_runners": true, "ignore_offline_eval_runner_failures": false, "max_num_offline_eval_runner_restarts": 1000, "offline_eval_runner_restore_timeout_s": 1800.0, "max_requests_in_flight_per_offline_eval_runner": 1, "validate_offline_eval_runners_after_construction": true, "offline_eval_runner_health_probe_timeout_s": 30.0, "offline_eval_rl_module_inference_only": false, "broadcast_offline_eval_runner_states": false, "offline_eval_batch_size_per_runner": 256, "dataset_num_iters_per_eval_runner": 1, "keep_per_episode_custom_metrics": false, "metrics_episode_collection_timeout_s": 60.0, "metrics_num_episodes_for_smoothing": 100, "min_time_s_per_iteration": null, "min_train_timesteps_per_iteration": 0, "min_sample_timesteps_per_iteration": 0, "log_gradients": true, "export_native_model_files": false, "checkpoint_trainable_policies_only": false, "logger_creator": null, "logger_config": null, "log_level": "WARN", "log_sys_usage": true, "fake_sampler": false, "seed": 2, "restart_failed_env_runners": true, "ignore_env_runner_failures": false, "max_num_env_runner_restarts": 1000, "delay_between_env_runner_restarts_s": 60.0, "restart_failed_sub_environments": false, "num_consecutive_env_runner_failures_tolerance": 100, "env_runner_health_probe_timeout_s": 30.0, "env_runner_restore_timeout_s": 1800.0, "_model_config": {}, "_rl_module_spec": "RLModuleSpec(module_class=None, observation_space=None, action_space=None, inference_only=False, learner_only=False, model_config=DefaultModelConfig(fcnet_hiddens=[60, 90], fcnet_activation='tanh', fcnet_kernel_initializer=None, fcnet_kernel_initializer_kwargs=None, fcnet_bias_initializer=None, fcnet_bias_initializer_kwargs=None, conv_filters=None, conv_activation='relu', conv_kernel_initializer=None, conv_kernel_initializer_kwargs=None, conv_bias_initializer=None, conv_bias_initializer_kwargs=None, head_fcnet_hiddens=[], head_fcnet_activation='relu', head_fcnet_kernel_initializer=None, head_fcnet_kernel_initializer_kwargs=None, head_fcnet_bias_initializer=None, head_fcnet_bias_initializer_kwargs=None, free_log_std=False, log_std_clip_param=20.0, vf_share_layers=True, use_lstm=False, max_seq_len=20, lstm_cell_size=256, lstm_use_prev_action=False, lstm_use_prev_reward=False, lstm_kernel_initializer=None, lstm_kernel_initializer_kwargs=None, lstm_bias_initializer=None, lstm_bias_initializer_kwargs=None), catalog_class=None, load_state_path=None, model_config_dict=None)", "algorithm_config_overrides_per_module": {}, "_per_module_overrides": {}, "_validate_config": true, "_use_msgpack_checkpoints": false, "_torch_grad_scaler_class": null, "_torch_lr_scheduler_classes": null, "_tf_policy_handles_more_than_one_loss": false, "_disable_preprocessor_api": false, "_disable_action_flattening": false, "_disable_initialize_loss_from_dummy_batch": false, "_dont_auto_sync_env_runner_states": false, "env_task_fn": -1, "enable_connectors": -1, "simple_optimizer": false, "policy_map_cache": -1, "worker_cls": -1, "synchronize_filters": -1, "enable_async_evaluation": -1, "custom_async_evaluation_function": -1, "_enable_rl_module_api": -1, "auto_wrap_old_gym_envs": -1, "always_attach_evaluation_results": -1, "replay_sequence_length": null, "_disable_execution_plan_api": -1, "use_critic": true, "use_gae": true, "use_kl_loss": true, "kl_coeff": 0.7464963036515, "kl_target": 0.0270990929592, "vf_loss_coeff": 0.6688075857018, "entropy_coeff": 0.0090570820258, "clip_param": 0.1221781641624, "vf_clip_param": 0.1027808522125, "entropy_coeff_schedule": null, "lr_schedule": null, "sgd_minibatch_size": -1, "vf_share_layers": -1, "__stdout_file__": null, "__stderr_file__": null, "lambda": 0.9099046732075, "input": "sampler", "policies": {"default_policy": [null, null, null, null]}, "callbacks": "<class 'ray.rllib.callbacks.callbacks.RLlibCallback'>", "create_env_on_driver": false, "custom_eval_function": null, "framework": "torch"}, "time_since_restore": 16.588428020477295, "iterations_since_restore": 10, "perf": {"cpu_util_percent": 30.75, "ram_util_percent": 78.5}}
{"timers": {"training_iteration": 1.5984242001053766, "restore_env_runners": 9.499990355294222e-06, "training_step": 1.5982909723550218, "env_runner_sampling_timer": 1.4876365143829156, "learner_update_timer": 0.10773908024399693, "synch_weights": 0.0005512734523276853, "restore_eval_env_runners": 8.328289722601088e-06, "evaluation_iteration": 0.11383004479501599, "synch_eval_env_connectors": 0.00011229534143622755, "synch_env_connectors": 4.688357462251265e-06}, "env_runners": {"weights_seq_no": 10.0, "num_agent_steps_sampled": {"default_agent": 5000.0}, "env_to_module_connector": {"timers": {"connectors": {"numpy_to_tensor": 8.69536821769892e-06, "add_states_from_episodes_to_batch": 1.7500635775439365e-06, "batch_individual_items": 6.294512482498914e-06, "add_time_dim_to_batch_and_zero_pad": 2.377880626400171e-06, "add_observations_from_episodes_to_batch": 2.993507403823018e-06}}, "connector_pipeline_timer": 4.4212825671187e-05}, "module_to_env_connector": {"timers": {"connectors": {"listify_data_for_vector_env": 1.1149295481683302e-05, "tensor_to_numpy": 1.3362228997336234e-05, "remove_single_ts_time_rank_from_batch": 5.895000164779953e-07, "un_batch_to_individual_items": 5.394819977956708e-06, "get_actions": 3.93772792567742e-05, "normalize_and_clip_actions": 9.485250482458686e-06}}, "connector_pipeline_timer": 0.00010554104111175717}, "agent_episode_returns_mean": {"default_agent": 5.14}, "rlmodule_inference_timer": 2.841407962817411e-05, "module_episode_returns_mean": {"default_policy": 5.14}, "num_episodes": 250.0, "episode_duration_sec_mean": 0.004631161666475238, "env_reset_timer": 3.8725852944689426e-05, "num_agent_steps_sampled_lifetime": {"default_agent": -5547500.0}, "episode_return_max": 8.5, "sample": 0.004973605347201764, "num_module_steps_sampled": {"default_policy": 5000.0}, "num_env_steps_sampled": 5000.0, "episode_return_min": -11.5, "env_to_module_sum_episodes_length_out": 10.36823839457432, "num_episodes_lifetime": -277375.0, "episode_len_mean": 20.0, "time_between_sampling": 0.001844636495421398, "episode_len_max": 20, "env_to_module_sum_episodes_length_in": 10.36823839457432, "num_env_steps_sampled_lifetime": -5547500.0, "env_step_timer": 1.3999475857368032e-05, "num_module_steps_sampled_lifetime": {"default_policy": -5547500.0}, "episode_len_min": 20, "episode_return_mean": 5.14, "num_env_steps_sampled_lifetime_throughput": 3653.13771809781}, "learners": {"default_policy": {"vf_loss": 0.10278083384037018, "num_module_steps_trained": 6000, "entropy": 0.5197477340698242, "gradients_default_optimizer_global_norm": 0.034589968621730804, "curr_kl_coeff": 0.0003645001561380923, "vf_loss_unclipped": 27.9683895111084, "diff_num_grad_updates_vs_sampler_policy": 1.0, "vf_explained_var": -0.0021424293518066406, "default_optimizer_learning_rate": 0.0002847858517, "total_loss": 0.02990320324897766, "num_module_steps_trained_lifetime": 66000, "num_trainable_parameters": 6003, "module_train_batch_size_mean": 1000.0, "curr_entropy_coeff": 0.0090570820258, "mean_kl_loss": 0.0012500360608100891, "weights_seq_no": 11.0, "policy_loss": -0.03413091599941254, "num_module_steps_trained_lifetime_throughput": 432701.2342791563}, "__all_modules__": {"num_non_trainable_parameters": 0, "num_module_steps_trained_lifetime": 66000, "num_trainable_parameters": 6003, "learner_connector": {"connector_pipeline_timer": 0.08337262890715268, "timers": {"connectors": {"add_columns_from_episodes_to_train_batch": 0.03381392099992856, "add_time_dim_to_batch_and_zero_pad": 1.2319343249950581e-05, "add_observations_from_episodes_to_batch": 0.0008102633511524794, "batch_individual_items": 0.03281087475564969, "add_one_ts_to_episodes_and_truncate": 0.00830456892184597, "general_advantage_estimation": 0.007443380205181398, "numpy_to_tensor": 5.9516197654943123e-05, "add_states_from_episodes_to_batch": 3.2657824384823892e-06}}}, "num_env_steps_trained_lifetime": 346500, "learner_connector_sum_episodes_length_out": 5250.0, "num_module_steps_trained": 6000, "learner_connector_sum_episodes_length_in": 5000.0, "num_env_steps_trained": 31500, "num_env_steps_trained_lifetime_throughput": 2261705.8413502173, "num_module_steps_trained_throughput": 432430.37465421617, "num_module_steps_trained_lifetime_throughput": 431784.9237937442}}, "num_training_step_calls_per_iteration": 1, "evaluation": {"env_runners": {"num_episodes": 20, "episode_return_max": 14.5, "agent_episode_returns_mean": {"default_agent": 0.4}, "env_to_module_connector": {"timers": {"connectors": {"numpy_to_tensor": 8.07056994711764e-06, "add_states_from_episodes_to_batch": 1.5403170963002627e-06, "add_time_dim_to_batch_and_zero_pad": 2.137135980873604e-06, "add_observations_from_episodes_to_batch": 2.8095356646433716e-06, "batch_individual_items": 6.078728619784627e-06}}, "connector_pipeline_timer": 4.2055581107705314e-05}, "module_episode_returns_mean": {"default_policy": 0.4}, "num_env_steps_sampled": 400, "module_to_env_connector": {"timers": {"connectors": {"remove_single_ts_time_rank_from_batch": 5.560879049915762e-07, "un_batch_to_individual_items": 5.208956775298475e-06, "tensor_to_numpy": 1.2873380770350893e-05, "normalize_and_clip_actions": 9.210510398923812e-06, "listify_data_for_vector_env": 1.0847373455967685e-05, "get_actions": 3.4955173032011143e-05}}, "connector_pipeline_timer": 9.91038638936816e-05}, "num_module_steps_sampled": {"default_policy": 400}, "episode_len_mean": 20.0, "episode_len_min": 20, "rlmodule_inference_timer": 2.591594403502389e-05, "episode_duration_sec_mean": 0.004394069580594078, "sample": 0.10094425126594891, "num_agent_steps_sampled": {"default_agent": 400}, "env_to_module_sum_episodes_length_out": 10.368238394574323, "num_episodes_lifetime": 220, "episode_len_max": 20, "env_step_timer": 1.3900846622322938e-05, "episode_return_mean": 0.4, "env_reset_timer": 0.0004957604157734165, "episode_return_min": -14.5, "num_agent_steps_sampled_lifetime": {"default_agent": 4400}, "env_to_module_sum_episodes_length_in": 10.368238394574323, "num_env_steps_sampled_lifetime": 55400, "weights_seq_no": 11.0, "num_module_steps_sampled_lifetime": {"default_policy": 4400}, "time_between_sampling": 1.5904892662847496}, "num_healthy_workers": 1, "actor_manager_num_outstanding_async_reqs": 0, "num_remote_worker_restarts": 0}, "num_env_steps_sampled_lifetime": -5547500.0, "fault_tolerance": {"num_healthy_workers": 0, "num_remote_worker_restarts": 0}, "env_runner_group": {"actor_manager_num_outstanding_async_reqs": 0}, "done": false, "training_iteration": 11, "trial_id": "43ce3_00000", "date": "2025-08-11_19-23-16", "timestamp": 1754932996, "time_this_iter_s": 1.6048109531402588, "time_total_s": 18.193238973617554, "pid": 14399, "hostname": "Mac", "node_ip": "127.0.0.1", "config": {"exploration_config": {}, "extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "placement_strategy": "PACK", "num_gpus": 0, "_fake_gpus": false, "num_cpus_for_main_process": 2, "eager_tracing": true, "eager_max_retraces": 20, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "torch_compile_learner": false, "torch_compile_learner_what_to_compile": "forward_train", "torch_compile_learner_dynamo_backend": "aot_eager", "torch_compile_learner_dynamo_mode": null, "torch_compile_worker": false, "torch_compile_worker_dynamo_backend": "aot_eager", "torch_compile_worker_dynamo_mode": null, "torch_ddp_kwargs": {}, "torch_skip_nan_gradients": false, "env": "Umbrella", "env_config": {}, "observation_space": null, "action_space": null, "clip_rewards": null, "normalize_actions": true, "clip_actions": false, "_is_atari": null, "disable_env_checking": false, "render_env": false, "action_mask_key": "action_mask", "env_runner_cls": null, "num_env_runners": 0, "create_local_env_runner": true, "num_envs_per_env_runner": 1, "gym_env_vectorize_mode": "SYNC", "num_cpus_per_env_runner": 1, "num_gpus_per_env_runner": 0, "custom_resources_per_env_runner": {}, "validate_env_runners_after_construction": true, "episodes_to_numpy": true, "max_requests_in_flight_per_env_runner": 1, "sample_timeout_s": 60.0, "_env_to_module_connector": null, "add_default_connectors_to_env_to_module_pipeline": true, "_module_to_env_connector": null, "add_default_connectors_to_module_to_env_pipeline": true, "merge_env_runner_states": "training_only", "broadcast_env_runner_states": true, "episode_lookback_horizon": 1, "rollout_fragment_length": "auto", "batch_mode": "complete_episodes", "compress_observations": false, "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "enable_tf1_exec_eagerly": false, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "preprocessor_pref": "deepmind", "observation_filter": "NoFilter", "update_worker_filter_stats": true, "use_worker_filter_stats": true, "sampler_perf_stats_ema_coef": null, "_is_online": true, "num_learners": 0, "num_gpus_per_learner": 0, "num_cpus_per_learner": "auto", "num_aggregator_actors_per_learner": 0, "max_requests_in_flight_per_aggregator_actor": 3, "local_gpu_idx": 0, "max_requests_in_flight_per_learner": 3, "gamma": 1, "lr": 0.0002847858517, "grad_clip": 0.5, "grad_clip_by": "global_norm", "_train_batch_size_per_learner": 5000, "train_batch_size": 4000, "num_epochs": 1, "minibatch_size": 1000, "shuffle_batch_per_epoch": true, "model": {"fcnet_hiddens": [256, 256], "fcnet_activation": "tanh", "fcnet_weights_initializer": null, "fcnet_weights_initializer_config": null, "fcnet_bias_initializer": null, "fcnet_bias_initializer_config": null, "conv_filters": null, "conv_activation": "relu", "conv_kernel_initializer": null, "conv_kernel_initializer_config": null, "conv_bias_initializer": null, "conv_bias_initializer_config": null, "conv_transpose_kernel_initializer": null, "conv_transpose_kernel_initializer_config": null, "conv_transpose_bias_initializer": null, "conv_transpose_bias_initializer_config": null, "post_fcnet_hiddens": [], "post_fcnet_activation": "relu", "post_fcnet_weights_initializer": null, "post_fcnet_weights_initializer_config": null, "post_fcnet_bias_initializer": null, "post_fcnet_bias_initializer_config": null, "free_log_std": false, "log_std_clip_param": 20.0, "no_final_linear": false, "vf_share_layers": false, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "lstm_weights_initializer": null, "lstm_weights_initializer_config": null, "lstm_bias_initializer": null, "lstm_bias_initializer_config": null, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "attention_use_n_prev_actions": 0, "attention_use_n_prev_rewards": 0, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": null, "custom_model_config": {}, "custom_action_dist": null, "custom_preprocessor": null, "encoder_latent_dim": null, "always_check_shapes": false, "lstm_use_prev_action_reward": -1, "_use_default_native_models": -1, "_disable_preprocessor_api": false, "_disable_action_flattening": false}, "_learner_connector": null, "add_default_connectors_to_learner_pipeline": true, "learner_config_dict": {}, "optimizer": {}, "_learner_class": null, "callbacks_on_algorithm_init": null, "callbacks_on_env_runners_recreated": null, "callbacks_on_offline_eval_runners_recreated": null, "callbacks_on_checkpoint_loaded": null, "callbacks_on_environment_created": null, "callbacks_on_episode_created": null, "callbacks_on_episode_start": null, "callbacks_on_episode_step": null, "callbacks_on_episode_end": null, "callbacks_on_evaluate_start": null, "callbacks_on_evaluate_end": null, "callbacks_on_evaluate_offline_start": null, "callbacks_on_evaluate_offline_end": null, "callbacks_on_sample_end": null, "callbacks_on_train_result": null, "explore": true, "enable_rl_module_and_learner": true, "enable_env_runner_and_connector_v2": true, "_prior_exploration_config": {"type": "StochasticSampling"}, "count_steps_by": "env_steps", "policy_map_capacity": 100, "policy_mapping_fn": "<function AlgorithmConfig.DEFAULT_POLICY_MAPPING_FN at 0x388aedb20>", "policies_to_train": null, "policy_states_are_swappable": false, "observation_fn": null, "offline_data_class": null, "input_read_method": "read_parquet", "input_read_method_kwargs": {}, "input_read_schema": {}, "input_read_episodes": false, "input_read_sample_batches": false, "input_read_batch_size": null, "input_filesystem": null, "input_filesystem_kwargs": {}, "input_compress_columns": ["obs", "new_obs"], "input_spaces_jsonable": true, "materialize_data": false, "materialize_mapped_data": true, "map_batches_kwargs": {}, "iter_batches_kwargs": {}, "ignore_final_observation": false, "prelearner_class": null, "prelearner_buffer_class": null, "prelearner_buffer_kwargs": {}, "prelearner_module_synch_period": 10, "dataset_num_iters_per_learner": null, "input_config": {}, "actions_in_input_normalized": false, "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_config": {}, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "output_max_rows_per_file": null, "output_write_remaining_data": false, "output_write_method": "write_parquet", "output_write_method_kwargs": {}, "output_filesystem": null, "output_filesystem_kwargs": {}, "output_write_episodes": true, "offline_sampling": false, "evaluation_interval": 1, "evaluation_duration": 20, "evaluation_duration_unit": "episodes", "evaluation_sample_timeout_s": 120.0, "evaluation_auto_duration_min_env_steps_per_sample": 100, "evaluation_auto_duration_max_env_steps_per_sample": 2000, "evaluation_parallel_to_training": false, "evaluation_force_reset_envs_before_iteration": true, "evaluation_config": null, "off_policy_estimation_methods": {}, "ope_split_batch_by_episode": true, "evaluation_num_env_runners": 1, "in_evaluation": false, "sync_filters_on_rollout_workers_timeout_s": 10.0, "offline_evaluation_interval": null, "num_offline_eval_runners": 0, "offline_loss_for_module_fn": null, "offline_evaluation_duration": 1, "offline_evaluation_parallel_to_training": false, "offline_evaluation_timeout_s": 120.0, "num_cpus_per_offline_eval_runner": 1, "num_gpus_per_offline_eval_runner": 0, "custom_resources_per_offline_eval_runner": {}, "restart_failed_offline_eval_runners": true, "ignore_offline_eval_runner_failures": false, "max_num_offline_eval_runner_restarts": 1000, "offline_eval_runner_restore_timeout_s": 1800.0, "max_requests_in_flight_per_offline_eval_runner": 1, "validate_offline_eval_runners_after_construction": true, "offline_eval_runner_health_probe_timeout_s": 30.0, "offline_eval_rl_module_inference_only": false, "broadcast_offline_eval_runner_states": false, "offline_eval_batch_size_per_runner": 256, "dataset_num_iters_per_eval_runner": 1, "keep_per_episode_custom_metrics": false, "metrics_episode_collection_timeout_s": 60.0, "metrics_num_episodes_for_smoothing": 100, "min_time_s_per_iteration": null, "min_train_timesteps_per_iteration": 0, "min_sample_timesteps_per_iteration": 0, "log_gradients": true, "export_native_model_files": false, "checkpoint_trainable_policies_only": false, "logger_creator": null, "logger_config": null, "log_level": "WARN", "log_sys_usage": true, "fake_sampler": false, "seed": 2, "restart_failed_env_runners": true, "ignore_env_runner_failures": false, "max_num_env_runner_restarts": 1000, "delay_between_env_runner_restarts_s": 60.0, "restart_failed_sub_environments": false, "num_consecutive_env_runner_failures_tolerance": 100, "env_runner_health_probe_timeout_s": 30.0, "env_runner_restore_timeout_s": 1800.0, "_model_config": {}, "_rl_module_spec": "RLModuleSpec(module_class=None, observation_space=None, action_space=None, inference_only=False, learner_only=False, model_config=DefaultModelConfig(fcnet_hiddens=[60, 90], fcnet_activation='tanh', fcnet_kernel_initializer=None, fcnet_kernel_initializer_kwargs=None, fcnet_bias_initializer=None, fcnet_bias_initializer_kwargs=None, conv_filters=None, conv_activation='relu', conv_kernel_initializer=None, conv_kernel_initializer_kwargs=None, conv_bias_initializer=None, conv_bias_initializer_kwargs=None, head_fcnet_hiddens=[], head_fcnet_activation='relu', head_fcnet_kernel_initializer=None, head_fcnet_kernel_initializer_kwargs=None, head_fcnet_bias_initializer=None, head_fcnet_bias_initializer_kwargs=None, free_log_std=False, log_std_clip_param=20.0, vf_share_layers=True, use_lstm=False, max_seq_len=20, lstm_cell_size=256, lstm_use_prev_action=False, lstm_use_prev_reward=False, lstm_kernel_initializer=None, lstm_kernel_initializer_kwargs=None, lstm_bias_initializer=None, lstm_bias_initializer_kwargs=None), catalog_class=None, load_state_path=None, model_config_dict=None)", "algorithm_config_overrides_per_module": {}, "_per_module_overrides": {}, "_validate_config": true, "_use_msgpack_checkpoints": false, "_torch_grad_scaler_class": null, "_torch_lr_scheduler_classes": null, "_tf_policy_handles_more_than_one_loss": false, "_disable_preprocessor_api": false, "_disable_action_flattening": false, "_disable_initialize_loss_from_dummy_batch": false, "_dont_auto_sync_env_runner_states": false, "env_task_fn": -1, "enable_connectors": -1, "simple_optimizer": false, "policy_map_cache": -1, "worker_cls": -1, "synchronize_filters": -1, "enable_async_evaluation": -1, "custom_async_evaluation_function": -1, "_enable_rl_module_api": -1, "auto_wrap_old_gym_envs": -1, "always_attach_evaluation_results": -1, "replay_sequence_length": null, "_disable_execution_plan_api": -1, "use_critic": true, "use_gae": true, "use_kl_loss": true, "kl_coeff": 0.7464963036515, "kl_target": 0.0270990929592, "vf_loss_coeff": 0.6688075857018, "entropy_coeff": 0.0090570820258, "clip_param": 0.1221781641624, "vf_clip_param": 0.1027808522125, "entropy_coeff_schedule": null, "lr_schedule": null, "sgd_minibatch_size": -1, "vf_share_layers": -1, "__stdout_file__": null, "__stderr_file__": null, "lambda": 0.9099046732075, "input": "sampler", "policies": {"default_policy": [null, null, null, null]}, "callbacks": "<class 'ray.rllib.callbacks.callbacks.RLlibCallback'>", "create_env_on_driver": false, "custom_eval_function": null, "framework": "torch"}, "time_since_restore": 18.193238973617554, "iterations_since_restore": 11, "perf": {"cpu_util_percent": 47.25, "ram_util_percent": 77.45}}
{"timers": {"training_iteration": 1.597781891434378, "restore_env_runners": 9.466650991100135e-06, "training_step": 1.5976482780415775, "env_runner_sampling_timer": 1.4871613988184733, "learner_update_timer": 0.10757000194108013, "synch_weights": 0.0005518561379079285, "restore_eval_env_runners": 8.314177317144986e-06, "evaluation_iteration": 0.11369685892710477, "synch_eval_env_connectors": 0.00011210488871953764, "synch_env_connectors": 4.6814741922084865e-06}, "env_runners": {"weights_seq_no": 11.0, "num_agent_steps_sampled": {"default_agent": 5000.0}, "env_to_module_connector": {"timers": {"connectors": {"numpy_to_tensor": 8.399620375279104e-06, "add_states_from_episodes_to_batch": 1.7128079715462047e-06, "batch_individual_items": 6.156482931527548e-06, "add_time_dim_to_batch_and_zero_pad": 2.316172308017367e-06, "add_observations_from_episodes_to_batch": 2.9773815365519817e-06}}, "connector_pipeline_timer": 4.340964468726512e-05}, "module_to_env_connector": {"timers": {"connectors": {"listify_data_for_vector_env": 1.0942349518266664e-05, "tensor_to_numpy": 1.2993761695555102e-05, "remove_single_ts_time_rank_from_batch": 5.814120716322366e-07, "un_batch_to_individual_items": 5.27123677322901e-06, "get_actions": 3.7922583114709764e-05, "normalize_and_clip_actions": 9.271031068709874e-06}}, "connector_pipeline_timer": 0.00010281659648648927}, "agent_episode_returns_mean": {"default_agent": 4.980000000000002}, "rlmodule_inference_timer": 2.6930853541527958e-05, "module_episode_returns_mean": {"default_policy": 4.980000000000002}, "num_episodes": 250.0, "episode_duration_sec_mean": 0.004494969806168228, "env_reset_timer": 3.27869040323345e-05, "num_agent_steps_sampled_lifetime": {"default_agent": -6165000.0}, "episode_return_max": 8.5, "sample": 0.004848883144081904, "num_module_steps_sampled": {"default_policy": 5000.0}, "num_env_steps_sampled": 5000.0, "episode_return_min": -11.5, "env_to_module_sum_episodes_length_out": 10.36823839457432, "num_episodes_lifetime": -308250.0, "episode_len_mean": 20.0, "time_between_sampling": 0.0017759745426429688, "episode_len_max": 20, "env_to_module_sum_episodes_length_in": 10.36823839457432, "num_env_steps_sampled_lifetime": -6165000.0, "env_step_timer": 1.3520443180947157e-05, "num_module_steps_sampled_lifetime": {"default_policy": -6165000.0}, "episode_len_min": 20, "episode_return_mean": 4.980000000000002, "num_env_steps_sampled_lifetime_throughput": 3761.6254292308854}, "learners": {"default_policy": {"vf_loss": 0.10278083384037018, "num_module_steps_trained": 6000, "entropy": 0.4981132447719574, "gradients_default_optimizer_global_norm": 0.06014768406748772, "curr_kl_coeff": 0.00018225007806904614, "vf_loss_unclipped": 27.940900802612305, "diff_num_grad_updates_vs_sampler_policy": 1.0, "vf_explained_var": -0.00040781497955322266, "default_optimizer_learning_rate": 0.0002847858517, "total_loss": -0.030171997845172882, "num_module_steps_trained_lifetime": 72000, "num_trainable_parameters": 6003, "module_train_batch_size_mean": 1000.0, "curr_entropy_coeff": 0.0090570820258, "mean_kl_loss": 0.0005731904529966414, "weights_seq_no": 12.0, "policy_loss": -0.09440136700868607, "num_module_steps_trained_lifetime_throughput": 433117.2931733909}, "__all_modules__": {"num_non_trainable_parameters": 0, "num_module_steps_trained_lifetime": 72000, "num_trainable_parameters": 6003, "learner_connector": {"connector_pipeline_timer": 0.08331793594811748, "timers": {"connectors": {"add_columns_from_episodes_to_train_batch": 0.033817140960781505, "add_time_dim_to_batch_and_zero_pad": 1.2298229756548242e-05, "add_observations_from_episodes_to_batch": 0.0008104823782117548, "batch_individual_items": 0.03278390017766057, "add_one_ts_to_episodes_and_truncate": 0.00829684032300472, "general_advantage_estimation": 0.0074201872438235195, "numpy_to_tensor": 5.951645581171617e-05, "add_states_from_episodes_to_batch": 3.267704621293038e-06}}}, "num_env_steps_trained_lifetime": 378000, "learner_connector_sum_episodes_length_out": 5250.0, "num_module_steps_trained": 6000, "learner_connector_sum_episodes_length_in": 5000.0, "num_env_steps_trained": 31500, "num_env_steps_trained_lifetime_throughput": 2264457.8936266527, "num_module_steps_trained_throughput": 432892.6646653536, "num_module_steps_trained_lifetime_throughput": 432267.05554169836}}, "num_training_step_calls_per_iteration": 1, "evaluation": {"env_runners": {"num_episodes": 20, "episode_return_max": 14.5, "agent_episode_returns_mean": {"default_agent": 0.2}, "env_to_module_connector": {"timers": {"connectors": {"numpy_to_tensor": 8.244802591515067e-06, "add_states_from_episodes_to_batch": 1.5347084557658668e-06, "add_time_dim_to_batch_and_zero_pad": 2.1374700953889693e-06, "add_observations_from_episodes_to_batch": 2.825088669400418e-06, "batch_individual_items": 6.10234828209392e-06}}, "connector_pipeline_timer": 4.196939261078668e-05}, "module_episode_returns_mean": {"default_policy": 0.2}, "num_env_steps_sampled": 400, "module_to_env_connector": {"timers": {"connectors": {"remove_single_ts_time_rank_from_batch": 5.570566905263271e-07, "un_batch_to_individual_items": 5.3010278229895505e-06, "tensor_to_numpy": 1.267415941494835e-05, "normalize_and_clip_actions": 9.364525751075685e-06, "listify_data_for_vector_env": 1.0923196764438624e-05, "get_actions": 3.507819186149417e-05}}, "connector_pipeline_timer": 9.916606752882822e-05}, "num_module_steps_sampled": {"default_policy": 400}, "episode_len_mean": 20.0, "episode_len_min": 20, "rlmodule_inference_timer": 2.632837724692792e-05, "episode_duration_sec_mean": 0.004397261698031798, "sample": 0.10089700375390068, "num_agent_steps_sampled": {"default_agent": 400}, "env_to_module_sum_episodes_length_out": 10.368238394574323, "num_episodes_lifetime": 240, "episode_len_max": 20, "env_step_timer": 1.4146974283748515e-05, "episode_return_mean": 0.2, "env_reset_timer": 0.0004915548906834341, "episode_return_min": -14.5, "num_agent_steps_sampled_lifetime": {"default_agent": 4800}, "env_to_module_sum_episodes_length_in": 10.368238394574323, "num_env_steps_sampled_lifetime": 60400, "weights_seq_no": 12.0, "num_module_steps_sampled_lifetime": {"default_policy": 4800}, "time_between_sampling": 1.5900914415423093}, "num_healthy_workers": 1, "actor_manager_num_outstanding_async_reqs": 0, "num_remote_worker_restarts": 0}, "num_env_steps_sampled_lifetime": -6165000.0, "fault_tolerance": {"num_healthy_workers": 0, "num_remote_worker_restarts": 0}, "env_runner_group": {"actor_manager_num_outstanding_async_reqs": 0}, "done": false, "training_iteration": 12, "trial_id": "43ce3_00000", "date": "2025-08-11_19-23-18", "timestamp": 1754932998, "time_this_iter_s": 1.637545108795166, "time_total_s": 19.83078408241272, "pid": 14399, "hostname": "Mac", "node_ip": "127.0.0.1", "config": {"exploration_config": {}, "extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "placement_strategy": "PACK", "num_gpus": 0, "_fake_gpus": false, "num_cpus_for_main_process": 2, "eager_tracing": true, "eager_max_retraces": 20, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "torch_compile_learner": false, "torch_compile_learner_what_to_compile": "forward_train", "torch_compile_learner_dynamo_backend": "aot_eager", "torch_compile_learner_dynamo_mode": null, "torch_compile_worker": false, "torch_compile_worker_dynamo_backend": "aot_eager", "torch_compile_worker_dynamo_mode": null, "torch_ddp_kwargs": {}, "torch_skip_nan_gradients": false, "env": "Umbrella", "env_config": {}, "observation_space": null, "action_space": null, "clip_rewards": null, "normalize_actions": true, "clip_actions": false, "_is_atari": null, "disable_env_checking": false, "render_env": false, "action_mask_key": "action_mask", "env_runner_cls": null, "num_env_runners": 0, "create_local_env_runner": true, "num_envs_per_env_runner": 1, "gym_env_vectorize_mode": "SYNC", "num_cpus_per_env_runner": 1, "num_gpus_per_env_runner": 0, "custom_resources_per_env_runner": {}, "validate_env_runners_after_construction": true, "episodes_to_numpy": true, "max_requests_in_flight_per_env_runner": 1, "sample_timeout_s": 60.0, "_env_to_module_connector": null, "add_default_connectors_to_env_to_module_pipeline": true, "_module_to_env_connector": null, "add_default_connectors_to_module_to_env_pipeline": true, "merge_env_runner_states": "training_only", "broadcast_env_runner_states": true, "episode_lookback_horizon": 1, "rollout_fragment_length": "auto", "batch_mode": "complete_episodes", "compress_observations": false, "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "enable_tf1_exec_eagerly": false, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "preprocessor_pref": "deepmind", "observation_filter": "NoFilter", "update_worker_filter_stats": true, "use_worker_filter_stats": true, "sampler_perf_stats_ema_coef": null, "_is_online": true, "num_learners": 0, "num_gpus_per_learner": 0, "num_cpus_per_learner": "auto", "num_aggregator_actors_per_learner": 0, "max_requests_in_flight_per_aggregator_actor": 3, "local_gpu_idx": 0, "max_requests_in_flight_per_learner": 3, "gamma": 1, "lr": 0.0002847858517, "grad_clip": 0.5, "grad_clip_by": "global_norm", "_train_batch_size_per_learner": 5000, "train_batch_size": 4000, "num_epochs": 1, "minibatch_size": 1000, "shuffle_batch_per_epoch": true, "model": {"fcnet_hiddens": [256, 256], "fcnet_activation": "tanh", "fcnet_weights_initializer": null, "fcnet_weights_initializer_config": null, "fcnet_bias_initializer": null, "fcnet_bias_initializer_config": null, "conv_filters": null, "conv_activation": "relu", "conv_kernel_initializer": null, "conv_kernel_initializer_config": null, "conv_bias_initializer": null, "conv_bias_initializer_config": null, "conv_transpose_kernel_initializer": null, "conv_transpose_kernel_initializer_config": null, "conv_transpose_bias_initializer": null, "conv_transpose_bias_initializer_config": null, "post_fcnet_hiddens": [], "post_fcnet_activation": "relu", "post_fcnet_weights_initializer": null, "post_fcnet_weights_initializer_config": null, "post_fcnet_bias_initializer": null, "post_fcnet_bias_initializer_config": null, "free_log_std": false, "log_std_clip_param": 20.0, "no_final_linear": false, "vf_share_layers": false, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "lstm_weights_initializer": null, "lstm_weights_initializer_config": null, "lstm_bias_initializer": null, "lstm_bias_initializer_config": null, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "attention_use_n_prev_actions": 0, "attention_use_n_prev_rewards": 0, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": null, "custom_model_config": {}, "custom_action_dist": null, "custom_preprocessor": null, "encoder_latent_dim": null, "always_check_shapes": false, "lstm_use_prev_action_reward": -1, "_use_default_native_models": -1, "_disable_preprocessor_api": false, "_disable_action_flattening": false}, "_learner_connector": null, "add_default_connectors_to_learner_pipeline": true, "learner_config_dict": {}, "optimizer": {}, "_learner_class": null, "callbacks_on_algorithm_init": null, "callbacks_on_env_runners_recreated": null, "callbacks_on_offline_eval_runners_recreated": null, "callbacks_on_checkpoint_loaded": null, "callbacks_on_environment_created": null, "callbacks_on_episode_created": null, "callbacks_on_episode_start": null, "callbacks_on_episode_step": null, "callbacks_on_episode_end": null, "callbacks_on_evaluate_start": null, "callbacks_on_evaluate_end": null, "callbacks_on_evaluate_offline_start": null, "callbacks_on_evaluate_offline_end": null, "callbacks_on_sample_end": null, "callbacks_on_train_result": null, "explore": true, "enable_rl_module_and_learner": true, "enable_env_runner_and_connector_v2": true, "_prior_exploration_config": {"type": "StochasticSampling"}, "count_steps_by": "env_steps", "policy_map_capacity": 100, "policy_mapping_fn": "<function AlgorithmConfig.DEFAULT_POLICY_MAPPING_FN at 0x388aedb20>", "policies_to_train": null, "policy_states_are_swappable": false, "observation_fn": null, "offline_data_class": null, "input_read_method": "read_parquet", "input_read_method_kwargs": {}, "input_read_schema": {}, "input_read_episodes": false, "input_read_sample_batches": false, "input_read_batch_size": null, "input_filesystem": null, "input_filesystem_kwargs": {}, "input_compress_columns": ["obs", "new_obs"], "input_spaces_jsonable": true, "materialize_data": false, "materialize_mapped_data": true, "map_batches_kwargs": {}, "iter_batches_kwargs": {}, "ignore_final_observation": false, "prelearner_class": null, "prelearner_buffer_class": null, "prelearner_buffer_kwargs": {}, "prelearner_module_synch_period": 10, "dataset_num_iters_per_learner": null, "input_config": {}, "actions_in_input_normalized": false, "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_config": {}, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "output_max_rows_per_file": null, "output_write_remaining_data": false, "output_write_method": "write_parquet", "output_write_method_kwargs": {}, "output_filesystem": null, "output_filesystem_kwargs": {}, "output_write_episodes": true, "offline_sampling": false, "evaluation_interval": 1, "evaluation_duration": 20, "evaluation_duration_unit": "episodes", "evaluation_sample_timeout_s": 120.0, "evaluation_auto_duration_min_env_steps_per_sample": 100, "evaluation_auto_duration_max_env_steps_per_sample": 2000, "evaluation_parallel_to_training": false, "evaluation_force_reset_envs_before_iteration": true, "evaluation_config": null, "off_policy_estimation_methods": {}, "ope_split_batch_by_episode": true, "evaluation_num_env_runners": 1, "in_evaluation": false, "sync_filters_on_rollout_workers_timeout_s": 10.0, "offline_evaluation_interval": null, "num_offline_eval_runners": 0, "offline_loss_for_module_fn": null, "offline_evaluation_duration": 1, "offline_evaluation_parallel_to_training": false, "offline_evaluation_timeout_s": 120.0, "num_cpus_per_offline_eval_runner": 1, "num_gpus_per_offline_eval_runner": 0, "custom_resources_per_offline_eval_runner": {}, "restart_failed_offline_eval_runners": true, "ignore_offline_eval_runner_failures": false, "max_num_offline_eval_runner_restarts": 1000, "offline_eval_runner_restore_timeout_s": 1800.0, "max_requests_in_flight_per_offline_eval_runner": 1, "validate_offline_eval_runners_after_construction": true, "offline_eval_runner_health_probe_timeout_s": 30.0, "offline_eval_rl_module_inference_only": false, "broadcast_offline_eval_runner_states": false, "offline_eval_batch_size_per_runner": 256, "dataset_num_iters_per_eval_runner": 1, "keep_per_episode_custom_metrics": false, "metrics_episode_collection_timeout_s": 60.0, "metrics_num_episodes_for_smoothing": 100, "min_time_s_per_iteration": null, "min_train_timesteps_per_iteration": 0, "min_sample_timesteps_per_iteration": 0, "log_gradients": true, "export_native_model_files": false, "checkpoint_trainable_policies_only": false, "logger_creator": null, "logger_config": null, "log_level": "WARN", "log_sys_usage": true, "fake_sampler": false, "seed": 2, "restart_failed_env_runners": true, "ignore_env_runner_failures": false, "max_num_env_runner_restarts": 1000, "delay_between_env_runner_restarts_s": 60.0, "restart_failed_sub_environments": false, "num_consecutive_env_runner_failures_tolerance": 100, "env_runner_health_probe_timeout_s": 30.0, "env_runner_restore_timeout_s": 1800.0, "_model_config": {}, "_rl_module_spec": "RLModuleSpec(module_class=None, observation_space=None, action_space=None, inference_only=False, learner_only=False, model_config=DefaultModelConfig(fcnet_hiddens=[60, 90], fcnet_activation='tanh', fcnet_kernel_initializer=None, fcnet_kernel_initializer_kwargs=None, fcnet_bias_initializer=None, fcnet_bias_initializer_kwargs=None, conv_filters=None, conv_activation='relu', conv_kernel_initializer=None, conv_kernel_initializer_kwargs=None, conv_bias_initializer=None, conv_bias_initializer_kwargs=None, head_fcnet_hiddens=[], head_fcnet_activation='relu', head_fcnet_kernel_initializer=None, head_fcnet_kernel_initializer_kwargs=None, head_fcnet_bias_initializer=None, head_fcnet_bias_initializer_kwargs=None, free_log_std=False, log_std_clip_param=20.0, vf_share_layers=True, use_lstm=False, max_seq_len=20, lstm_cell_size=256, lstm_use_prev_action=False, lstm_use_prev_reward=False, lstm_kernel_initializer=None, lstm_kernel_initializer_kwargs=None, lstm_bias_initializer=None, lstm_bias_initializer_kwargs=None), catalog_class=None, load_state_path=None, model_config_dict=None)", "algorithm_config_overrides_per_module": {}, "_per_module_overrides": {}, "_validate_config": true, "_use_msgpack_checkpoints": false, "_torch_grad_scaler_class": null, "_torch_lr_scheduler_classes": null, "_tf_policy_handles_more_than_one_loss": false, "_disable_preprocessor_api": false, "_disable_action_flattening": false, "_disable_initialize_loss_from_dummy_batch": false, "_dont_auto_sync_env_runner_states": false, "env_task_fn": -1, "enable_connectors": -1, "simple_optimizer": false, "policy_map_cache": -1, "worker_cls": -1, "synchronize_filters": -1, "enable_async_evaluation": -1, "custom_async_evaluation_function": -1, "_enable_rl_module_api": -1, "auto_wrap_old_gym_envs": -1, "always_attach_evaluation_results": -1, "replay_sequence_length": null, "_disable_execution_plan_api": -1, "use_critic": true, "use_gae": true, "use_kl_loss": true, "kl_coeff": 0.7464963036515, "kl_target": 0.0270990929592, "vf_loss_coeff": 0.6688075857018, "entropy_coeff": 0.0090570820258, "clip_param": 0.1221781641624, "vf_clip_param": 0.1027808522125, "entropy_coeff_schedule": null, "lr_schedule": null, "sgd_minibatch_size": -1, "vf_share_layers": -1, "__stdout_file__": null, "__stderr_file__": null, "lambda": 0.9099046732075, "input": "sampler", "policies": {"default_policy": [null, null, null, null]}, "callbacks": "<class 'ray.rllib.callbacks.callbacks.RLlibCallback'>", "create_env_on_driver": false, "custom_eval_function": null, "framework": "torch"}, "time_since_restore": 19.83078408241272, "iterations_since_restore": 12, "perf": {"cpu_util_percent": 39.53333333333333, "ram_util_percent": 77.26666666666667}}
{"timers": {"training_iteration": 1.5974023816893248, "restore_env_runners": 9.431984938058735e-06, "training_step": 1.597268222341616, "env_runner_sampling_timer": 1.4869516235801779, "learner_update_timer": 0.10739793192220845, "synch_weights": 0.0005521471574360748, "restore_eval_env_runners": 8.294365479047389e-06, "evaluation_iteration": 0.11357072075767029, "synch_eval_env_connectors": 0.00011188549978295623, "synch_env_connectors": 4.677989233070386e-06}, "env_runners": {"weights_seq_no": 12.0, "num_agent_steps_sampled": {"default_agent": 5000.0}, "env_to_module_connector": {"timers": {"connectors": {"numpy_to_tensor": 8.539183306018872e-06, "add_states_from_episodes_to_batch": 1.7455827191458506e-06, "batch_individual_items": 6.216416765807564e-06, "add_time_dim_to_batch_and_zero_pad": 2.367441019141675e-06, "add_observations_from_episodes_to_batch": 2.919552494426777e-06}}, "connector_pipeline_timer": 4.3821285345154277e-05}, "module_to_env_connector": {"timers": {"connectors": {"listify_data_for_vector_env": 1.106703428709942e-05, "tensor_to_numpy": 1.3178656487318415e-05, "remove_single_ts_time_rank_from_batch": 5.828146848068901e-07, "un_batch_to_individual_items": 5.333182191289376e-06, "get_actions": 3.86408811192606e-05, "normalize_and_clip_actions": 9.35286209594623e-06}}, "connector_pipeline_timer": 0.00010425825643939315}, "agent_episode_returns_mean": {"default_agent": 5.619999999999999}, "rlmodule_inference_timer": 2.7253009098260185e-05, "module_episode_returns_mean": {"default_policy": 5.619999999999999}, "num_episodes": 250.0, "episode_duration_sec_mean": 0.004555762695614249, "env_reset_timer": 3.154749312263705e-05, "num_agent_steps_sampled_lifetime": {"default_agent": -6782500.0}, "episode_return_max": 8.5, "sample": 0.004830672602708177, "num_module_steps_sampled": {"default_policy": 5000.0}, "num_env_steps_sampled": 5000.0, "episode_return_min": -11.5, "env_to_module_sum_episodes_length_out": 10.36823839457432, "num_episodes_lifetime": -339125.0, "episode_len_mean": 20.0, "time_between_sampling": 0.0016615688959358027, "episode_len_max": 20, "env_to_module_sum_episodes_length_in": 10.36823839457432, "num_env_steps_sampled_lifetime": -6782500.0, "env_step_timer": 1.3730644371906537e-05, "num_module_steps_sampled_lifetime": {"default_policy": -6782500.0}, "episode_len_min": 20, "episode_return_mean": 5.619999999999999, "num_env_steps_sampled_lifetime_throughput": 3722.4241959050496}, "learners": {"default_policy": {"vf_loss": 0.10278083384037018, "num_module_steps_trained": 6000, "entropy": 0.47185197472572327, "gradients_default_optimizer_global_norm": 0.030830301344394684, "curr_kl_coeff": 9.112503903452307e-05, "vf_loss_unclipped": 28.0755558013916, "diff_num_grad_updates_vs_sampler_policy": 1.0, "vf_explained_var": -0.003191232681274414, "default_optimizer_learning_rate": 0.0002847858517, "total_loss": 0.13146176934242249, "num_module_steps_trained_lifetime": 78000, "num_trainable_parameters": 6003, "module_train_batch_size_mean": 1000.0, "curr_entropy_coeff": 0.0090570820258, "mean_kl_loss": 0.00074898696038872, "weights_seq_no": 13.0, "policy_loss": 0.06699463725090027, "num_module_steps_trained_lifetime_throughput": 433643.4888081971}, "__all_modules__": {"num_non_trainable_parameters": 0, "num_module_steps_trained_lifetime": 78000, "num_trainable_parameters": 6003, "learner_connector": {"connector_pipeline_timer": 0.08325930200906319, "timers": {"connectors": {"add_columns_from_episodes_to_train_batch": 0.033811782461374715, "add_time_dim_to_batch_and_zero_pad": 1.2264407625663573e-05, "add_observations_from_episodes_to_batch": 0.0008101771341915596, "batch_individual_items": 0.03276104450514469, "add_one_ts_to_episodes_and_truncate": 0.008289276920018008, "general_advantage_estimation": 0.0073980891220258105, "numpy_to_tensor": 5.942754190701492e-05, "add_states_from_episodes_to_batch": 3.2633677210256563e-06}}}, "num_env_steps_trained_lifetime": 409500, "learner_connector_sum_episodes_length_out": 5250.0, "num_module_steps_trained": 6000, "learner_connector_sum_episodes_length_in": 5000.0, "num_env_steps_trained": 31500, "num_env_steps_trained_lifetime_throughput": 2267760.837297219, "num_module_steps_trained_throughput": 433463.20993370085, "num_module_steps_trained_lifetime_throughput": 432856.4268615857}}, "num_training_step_calls_per_iteration": 1, "evaluation": {"env_runners": {"num_episodes": 20, "episode_return_max": 14.5, "agent_episode_returns_mean": {"default_agent": -0.4}, "env_to_module_connector": {"timers": {"connectors": {"numpy_to_tensor": 8.071215600740233e-06, "add_states_from_episodes_to_batch": 1.5361293985643284e-06, "add_time_dim_to_batch_and_zero_pad": 2.1205432706461387e-06, "add_observations_from_episodes_to_batch": 2.8026428438289972e-06, "batch_individual_items": 6.050279195287864e-06}}, "connector_pipeline_timer": 4.1848386508130504e-05}, "module_episode_returns_mean": {"default_policy": -0.4}, "num_env_steps_sampled": 400, "module_to_env_connector": {"timers": {"connectors": {"remove_single_ts_time_rank_from_batch": 5.643489403710244e-07, "un_batch_to_individual_items": 5.232168523012623e-06, "tensor_to_numpy": 1.2639775039078914e-05, "normalize_and_clip_actions": 9.265784129560796e-06, "listify_data_for_vector_env": 1.0720086649600327e-05, "get_actions": 3.473507536067942e-05}}, "connector_pipeline_timer": 9.840375129273375e-05}, "num_module_steps_sampled": {"default_policy": 400}, "episode_len_mean": 20.0, "episode_len_min": 20, "rlmodule_inference_timer": 2.604822630043498e-05, "episode_duration_sec_mean": 0.004401350867701694, "sample": 0.10084602871642417, "num_agent_steps_sampled": {"default_agent": 400}, "env_to_module_sum_episodes_length_out": 10.368238394574323, "num_episodes_lifetime": 260, "episode_len_max": 20, "env_step_timer": 1.3865036257398014e-05, "episode_return_mean": -0.4, "env_reset_timer": 0.0004873843416286312, "episode_return_min": -14.5, "num_agent_steps_sampled_lifetime": {"default_agent": 5200}, "env_to_module_sum_episodes_length_in": 10.368238394574323, "num_env_steps_sampled_lifetime": 65400, "weights_seq_no": 13.0, "num_module_steps_sampled_lifetime": {"default_policy": 5200}, "time_between_sampling": 1.5899603983778452}, "num_healthy_workers": 1, "actor_manager_num_outstanding_async_reqs": 0, "num_remote_worker_restarts": 0}, "num_env_steps_sampled_lifetime": -6782500.0, "fault_tolerance": {"num_healthy_workers": 0, "num_remote_worker_restarts": 0}, "env_runner_group": {"actor_manager_num_outstanding_async_reqs": 0}, "done": false, "training_iteration": 13, "trial_id": "43ce3_00000", "date": "2025-08-11_19-23-19", "timestamp": 1754932999, "time_this_iter_s": 1.6625840663909912, "time_total_s": 21.49336814880371, "pid": 14399, "hostname": "Mac", "node_ip": "127.0.0.1", "config": {"exploration_config": {}, "extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "placement_strategy": "PACK", "num_gpus": 0, "_fake_gpus": false, "num_cpus_for_main_process": 2, "eager_tracing": true, "eager_max_retraces": 20, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "torch_compile_learner": false, "torch_compile_learner_what_to_compile": "forward_train", "torch_compile_learner_dynamo_backend": "aot_eager", "torch_compile_learner_dynamo_mode": null, "torch_compile_worker": false, "torch_compile_worker_dynamo_backend": "aot_eager", "torch_compile_worker_dynamo_mode": null, "torch_ddp_kwargs": {}, "torch_skip_nan_gradients": false, "env": "Umbrella", "env_config": {}, "observation_space": null, "action_space": null, "clip_rewards": null, "normalize_actions": true, "clip_actions": false, "_is_atari": null, "disable_env_checking": false, "render_env": false, "action_mask_key": "action_mask", "env_runner_cls": null, "num_env_runners": 0, "create_local_env_runner": true, "num_envs_per_env_runner": 1, "gym_env_vectorize_mode": "SYNC", "num_cpus_per_env_runner": 1, "num_gpus_per_env_runner": 0, "custom_resources_per_env_runner": {}, "validate_env_runners_after_construction": true, "episodes_to_numpy": true, "max_requests_in_flight_per_env_runner": 1, "sample_timeout_s": 60.0, "_env_to_module_connector": null, "add_default_connectors_to_env_to_module_pipeline": true, "_module_to_env_connector": null, "add_default_connectors_to_module_to_env_pipeline": true, "merge_env_runner_states": "training_only", "broadcast_env_runner_states": true, "episode_lookback_horizon": 1, "rollout_fragment_length": "auto", "batch_mode": "complete_episodes", "compress_observations": false, "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "enable_tf1_exec_eagerly": false, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "preprocessor_pref": "deepmind", "observation_filter": "NoFilter", "update_worker_filter_stats": true, "use_worker_filter_stats": true, "sampler_perf_stats_ema_coef": null, "_is_online": true, "num_learners": 0, "num_gpus_per_learner": 0, "num_cpus_per_learner": "auto", "num_aggregator_actors_per_learner": 0, "max_requests_in_flight_per_aggregator_actor": 3, "local_gpu_idx": 0, "max_requests_in_flight_per_learner": 3, "gamma": 1, "lr": 0.0002847858517, "grad_clip": 0.5, "grad_clip_by": "global_norm", "_train_batch_size_per_learner": 5000, "train_batch_size": 4000, "num_epochs": 1, "minibatch_size": 1000, "shuffle_batch_per_epoch": true, "model": {"fcnet_hiddens": [256, 256], "fcnet_activation": "tanh", "fcnet_weights_initializer": null, "fcnet_weights_initializer_config": null, "fcnet_bias_initializer": null, "fcnet_bias_initializer_config": null, "conv_filters": null, "conv_activation": "relu", "conv_kernel_initializer": null, "conv_kernel_initializer_config": null, "conv_bias_initializer": null, "conv_bias_initializer_config": null, "conv_transpose_kernel_initializer": null, "conv_transpose_kernel_initializer_config": null, "conv_transpose_bias_initializer": null, "conv_transpose_bias_initializer_config": null, "post_fcnet_hiddens": [], "post_fcnet_activation": "relu", "post_fcnet_weights_initializer": null, "post_fcnet_weights_initializer_config": null, "post_fcnet_bias_initializer": null, "post_fcnet_bias_initializer_config": null, "free_log_std": false, "log_std_clip_param": 20.0, "no_final_linear": false, "vf_share_layers": false, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "lstm_weights_initializer": null, "lstm_weights_initializer_config": null, "lstm_bias_initializer": null, "lstm_bias_initializer_config": null, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "attention_use_n_prev_actions": 0, "attention_use_n_prev_rewards": 0, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": null, "custom_model_config": {}, "custom_action_dist": null, "custom_preprocessor": null, "encoder_latent_dim": null, "always_check_shapes": false, "lstm_use_prev_action_reward": -1, "_use_default_native_models": -1, "_disable_preprocessor_api": false, "_disable_action_flattening": false}, "_learner_connector": null, "add_default_connectors_to_learner_pipeline": true, "learner_config_dict": {}, "optimizer": {}, "_learner_class": null, "callbacks_on_algorithm_init": null, "callbacks_on_env_runners_recreated": null, "callbacks_on_offline_eval_runners_recreated": null, "callbacks_on_checkpoint_loaded": null, "callbacks_on_environment_created": null, "callbacks_on_episode_created": null, "callbacks_on_episode_start": null, "callbacks_on_episode_step": null, "callbacks_on_episode_end": null, "callbacks_on_evaluate_start": null, "callbacks_on_evaluate_end": null, "callbacks_on_evaluate_offline_start": null, "callbacks_on_evaluate_offline_end": null, "callbacks_on_sample_end": null, "callbacks_on_train_result": null, "explore": true, "enable_rl_module_and_learner": true, "enable_env_runner_and_connector_v2": true, "_prior_exploration_config": {"type": "StochasticSampling"}, "count_steps_by": "env_steps", "policy_map_capacity": 100, "policy_mapping_fn": "<function AlgorithmConfig.DEFAULT_POLICY_MAPPING_FN at 0x388aedb20>", "policies_to_train": null, "policy_states_are_swappable": false, "observation_fn": null, "offline_data_class": null, "input_read_method": "read_parquet", "input_read_method_kwargs": {}, "input_read_schema": {}, "input_read_episodes": false, "input_read_sample_batches": false, "input_read_batch_size": null, "input_filesystem": null, "input_filesystem_kwargs": {}, "input_compress_columns": ["obs", "new_obs"], "input_spaces_jsonable": true, "materialize_data": false, "materialize_mapped_data": true, "map_batches_kwargs": {}, "iter_batches_kwargs": {}, "ignore_final_observation": false, "prelearner_class": null, "prelearner_buffer_class": null, "prelearner_buffer_kwargs": {}, "prelearner_module_synch_period": 10, "dataset_num_iters_per_learner": null, "input_config": {}, "actions_in_input_normalized": false, "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_config": {}, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "output_max_rows_per_file": null, "output_write_remaining_data": false, "output_write_method": "write_parquet", "output_write_method_kwargs": {}, "output_filesystem": null, "output_filesystem_kwargs": {}, "output_write_episodes": true, "offline_sampling": false, "evaluation_interval": 1, "evaluation_duration": 20, "evaluation_duration_unit": "episodes", "evaluation_sample_timeout_s": 120.0, "evaluation_auto_duration_min_env_steps_per_sample": 100, "evaluation_auto_duration_max_env_steps_per_sample": 2000, "evaluation_parallel_to_training": false, "evaluation_force_reset_envs_before_iteration": true, "evaluation_config": null, "off_policy_estimation_methods": {}, "ope_split_batch_by_episode": true, "evaluation_num_env_runners": 1, "in_evaluation": false, "sync_filters_on_rollout_workers_timeout_s": 10.0, "offline_evaluation_interval": null, "num_offline_eval_runners": 0, "offline_loss_for_module_fn": null, "offline_evaluation_duration": 1, "offline_evaluation_parallel_to_training": false, "offline_evaluation_timeout_s": 120.0, "num_cpus_per_offline_eval_runner": 1, "num_gpus_per_offline_eval_runner": 0, "custom_resources_per_offline_eval_runner": {}, "restart_failed_offline_eval_runners": true, "ignore_offline_eval_runner_failures": false, "max_num_offline_eval_runner_restarts": 1000, "offline_eval_runner_restore_timeout_s": 1800.0, "max_requests_in_flight_per_offline_eval_runner": 1, "validate_offline_eval_runners_after_construction": true, "offline_eval_runner_health_probe_timeout_s": 30.0, "offline_eval_rl_module_inference_only": false, "broadcast_offline_eval_runner_states": false, "offline_eval_batch_size_per_runner": 256, "dataset_num_iters_per_eval_runner": 1, "keep_per_episode_custom_metrics": false, "metrics_episode_collection_timeout_s": 60.0, "metrics_num_episodes_for_smoothing": 100, "min_time_s_per_iteration": null, "min_train_timesteps_per_iteration": 0, "min_sample_timesteps_per_iteration": 0, "log_gradients": true, "export_native_model_files": false, "checkpoint_trainable_policies_only": false, "logger_creator": null, "logger_config": null, "log_level": "WARN", "log_sys_usage": true, "fake_sampler": false, "seed": 2, "restart_failed_env_runners": true, "ignore_env_runner_failures": false, "max_num_env_runner_restarts": 1000, "delay_between_env_runner_restarts_s": 60.0, "restart_failed_sub_environments": false, "num_consecutive_env_runner_failures_tolerance": 100, "env_runner_health_probe_timeout_s": 30.0, "env_runner_restore_timeout_s": 1800.0, "_model_config": {}, "_rl_module_spec": "RLModuleSpec(module_class=None, observation_space=None, action_space=None, inference_only=False, learner_only=False, model_config=DefaultModelConfig(fcnet_hiddens=[60, 90], fcnet_activation='tanh', fcnet_kernel_initializer=None, fcnet_kernel_initializer_kwargs=None, fcnet_bias_initializer=None, fcnet_bias_initializer_kwargs=None, conv_filters=None, conv_activation='relu', conv_kernel_initializer=None, conv_kernel_initializer_kwargs=None, conv_bias_initializer=None, conv_bias_initializer_kwargs=None, head_fcnet_hiddens=[], head_fcnet_activation='relu', head_fcnet_kernel_initializer=None, head_fcnet_kernel_initializer_kwargs=None, head_fcnet_bias_initializer=None, head_fcnet_bias_initializer_kwargs=None, free_log_std=False, log_std_clip_param=20.0, vf_share_layers=True, use_lstm=False, max_seq_len=20, lstm_cell_size=256, lstm_use_prev_action=False, lstm_use_prev_reward=False, lstm_kernel_initializer=None, lstm_kernel_initializer_kwargs=None, lstm_bias_initializer=None, lstm_bias_initializer_kwargs=None), catalog_class=None, load_state_path=None, model_config_dict=None)", "algorithm_config_overrides_per_module": {}, "_per_module_overrides": {}, "_validate_config": true, "_use_msgpack_checkpoints": false, "_torch_grad_scaler_class": null, "_torch_lr_scheduler_classes": null, "_tf_policy_handles_more_than_one_loss": false, "_disable_preprocessor_api": false, "_disable_action_flattening": false, "_disable_initialize_loss_from_dummy_batch": false, "_dont_auto_sync_env_runner_states": false, "env_task_fn": -1, "enable_connectors": -1, "simple_optimizer": false, "policy_map_cache": -1, "worker_cls": -1, "synchronize_filters": -1, "enable_async_evaluation": -1, "custom_async_evaluation_function": -1, "_enable_rl_module_api": -1, "auto_wrap_old_gym_envs": -1, "always_attach_evaluation_results": -1, "replay_sequence_length": null, "_disable_execution_plan_api": -1, "use_critic": true, "use_gae": true, "use_kl_loss": true, "kl_coeff": 0.7464963036515, "kl_target": 0.0270990929592, "vf_loss_coeff": 0.6688075857018, "entropy_coeff": 0.0090570820258, "clip_param": 0.1221781641624, "vf_clip_param": 0.1027808522125, "entropy_coeff_schedule": null, "lr_schedule": null, "sgd_minibatch_size": -1, "vf_share_layers": -1, "__stdout_file__": null, "__stderr_file__": null, "lambda": 0.9099046732075, "input": "sampler", "policies": {"default_policy": [null, null, null, null]}, "callbacks": "<class 'ray.rllib.callbacks.callbacks.RLlibCallback'>", "create_env_on_driver": false, "custom_eval_function": null, "framework": "torch"}, "time_since_restore": 21.49336814880371, "iterations_since_restore": 13, "perf": {"cpu_util_percent": 40.6, "ram_util_percent": 77.6}}
{"timers": {"training_iteration": 1.5969447262117353, "restore_env_runners": 9.39224408401027e-06, "training_step": 1.5968102701190683, "env_runner_sampling_timer": 1.485775208184695, "learner_update_timer": 0.10811533010361728, "synch_weights": 0.0005520102763384655, "restore_eval_env_runners": 8.271422281126515e-06, "evaluation_iteration": 0.11343932980042155, "synch_eval_env_connectors": 0.00011165456423530542, "synch_env_connectors": 4.6687090442065745e-06}, "env_runners": {"weights_seq_no": 13.0, "num_agent_steps_sampled": {"default_agent": 5000.0}, "env_to_module_connector": {"timers": {"connectors": {"numpy_to_tensor": 8.527026739912325e-06, "add_states_from_episodes_to_batch": 1.741639898570863e-06, "batch_individual_items": 6.173158632235677e-06, "add_time_dim_to_batch_and_zero_pad": 2.347311283084361e-06, "add_observations_from_episodes_to_batch": 2.890339840745455e-06}}, "connector_pipeline_timer": 4.3599982652021826e-05}, "module_to_env_connector": {"timers": {"connectors": {"listify_data_for_vector_env": 1.0985064322859983e-05, "tensor_to_numpy": 1.3113064554101678e-05, "remove_single_ts_time_rank_from_batch": 5.792008164435454e-07, "un_batch_to_individual_items": 5.289912165841273e-06, "get_actions": 3.822639101723317e-05, "normalize_and_clip_actions": 9.31471074303193e-06}}, "connector_pipeline_timer": 0.0001034232051807559}, "agent_episode_returns_mean": {"default_agent": 5.299999999999998}, "rlmodule_inference_timer": 2.7429334733889655e-05, "module_episode_returns_mean": {"default_policy": 5.299999999999998}, "num_episodes": 250.0, "episode_duration_sec_mean": 0.004526705172844232, "env_reset_timer": 3.228141150333445e-05, "num_agent_steps_sampled_lifetime": {"default_agent": -7400000.0}, "episode_return_max": 8.5, "sample": 0.004846496030788954, "num_module_steps_sampled": {"default_policy": 5000.0}, "num_env_steps_sampled": 5000.0, "episode_return_min": -11.5, "env_to_module_sum_episodes_length_out": 10.36823839457432, "num_episodes_lifetime": -370000.0, "episode_len_mean": 20.0, "time_between_sampling": 0.0016611271938322565, "episode_len_max": 20, "env_to_module_sum_episodes_length_in": 10.36823839457432, "num_env_steps_sampled_lifetime": -7400000.0, "env_step_timer": 1.362220768664886e-05, "num_module_steps_sampled_lifetime": {"default_policy": -7400000.0}, "episode_len_min": 20, "episode_return_mean": 5.299999999999998, "num_env_steps_sampled_lifetime_throughput": 3743.8699334168405}, "learners": {"default_policy": {"vf_loss": 0.10278083384037018, "num_module_steps_trained": 6000, "entropy": 0.4444359540939331, "gradients_default_optimizer_global_norm": 0.011624989099800587, "curr_kl_coeff": 4.5562519517261535e-05, "vf_loss_unclipped": 27.947935104370117, "diff_num_grad_updates_vs_sampler_policy": 1.0, "vf_explained_var": 0.001467287540435791, "default_optimizer_learning_rate": 0.0002847858517, "total_loss": -0.043898805975914, "num_module_steps_trained_lifetime": 84000, "num_trainable_parameters": 6003, "module_train_batch_size_mean": 1000.0, "curr_entropy_coeff": 0.0090570820258, "mean_kl_loss": 0.000890470459125936, "weights_seq_no": 14.0, "policy_loss": -0.10861422121524811, "num_module_steps_trained_lifetime_throughput": 434124.119567018}, "__all_modules__": {"num_non_trainable_parameters": 0, "num_module_steps_trained_lifetime": 84000, "num_trainable_parameters": 6003, "learner_connector": {"connector_pipeline_timer": 0.08408712648892458, "timers": {"connectors": {"add_columns_from_episodes_to_train_batch": 0.03381711088753307, "add_time_dim_to_batch_and_zero_pad": 1.2240093750988057e-05, "add_observations_from_episodes_to_batch": 0.0008102799422029765, "batch_individual_items": 0.03361418697053403, "add_one_ts_to_episodes_and_truncate": 0.008281625401269482, "general_advantage_estimation": 0.007375370311474955, "numpy_to_tensor": 5.9381595459435035e-05, "add_states_from_episodes_to_batch": 3.2590637123819843e-06}}}, "num_env_steps_trained_lifetime": 441000, "learner_connector_sum_episodes_length_out": 5250.0, "num_module_steps_trained": 6000, "learner_connector_sum_episodes_length_in": 5000.0, "num_env_steps_trained": 31500, "num_env_steps_trained_lifetime_throughput": 2270795.140024984, "num_module_steps_trained_throughput": 433983.8213608538, "num_module_steps_trained_lifetime_throughput": 433395.8590509588}}, "num_training_step_calls_per_iteration": 1, "evaluation": {"env_runners": {"num_episodes": 20, "episode_return_max": 14.5, "agent_episode_returns_mean": {"default_agent": -0.4}, "env_to_module_connector": {"timers": {"connectors": {"numpy_to_tensor": 8.200594834023388e-06, "add_states_from_episodes_to_batch": 1.5363038681843922e-06, "add_time_dim_to_batch_and_zero_pad": 2.1161009427980793e-06, "add_observations_from_episodes_to_batch": 2.770454365972143e-06, "batch_individual_items": 6.032615186133329e-06}}, "connector_pipeline_timer": 4.175258364387795e-05}, "module_episode_returns_mean": {"default_policy": -0.4}, "num_env_steps_sampled": 400, "module_to_env_connector": {"timers": {"connectors": {"remove_single_ts_time_rank_from_batch": 5.6107319993685e-07, "un_batch_to_individual_items": 5.228500748087966e-06, "tensor_to_numpy": 1.2565398475735333e-05, "normalize_and_clip_actions": 9.19452718719636e-06, "listify_data_for_vector_env": 1.096423249369993e-05, "get_actions": 3.4367256251267274e-05}}, "connector_pipeline_timer": 9.796798651554081e-05}, "num_module_steps_sampled": {"default_policy": 400}, "episode_len_mean": 20.0, "episode_len_min": 20, "rlmodule_inference_timer": 2.572783633494001e-05, "episode_duration_sec_mean": 0.004400154673494399, "sample": 0.100790062599311, "num_agent_steps_sampled": {"default_agent": 400}, "env_to_module_sum_episodes_length_out": 10.368238394574323, "num_episodes_lifetime": 280, "episode_len_max": 20, "env_step_timer": 1.3951979027820943e-05, "episode_return_mean": -0.4, "env_reset_timer": 0.00048326215818493806, "episode_return_min": -14.5, "num_agent_steps_sampled_lifetime": {"default_agent": 5600}, "env_to_module_sum_episodes_length_in": 10.368238394574323, "num_env_steps_sampled_lifetime": 70400, "weights_seq_no": 14.0, "num_module_steps_sampled_lifetime": {"default_policy": 5600}, "time_between_sampling": 1.5897524727236705}, "num_healthy_workers": 1, "actor_manager_num_outstanding_async_reqs": 0, "num_remote_worker_restarts": 0}, "num_env_steps_sampled_lifetime": -7400000.0, "fault_tolerance": {"num_healthy_workers": 0, "num_remote_worker_restarts": 0}, "env_runner_group": {"actor_manager_num_outstanding_async_reqs": 0}, "done": false, "training_iteration": 14, "trial_id": "43ce3_00000", "date": "2025-08-11_19-23-21", "timestamp": 1754933001, "time_this_iter_s": 1.6540169715881348, "time_total_s": 23.147385120391846, "pid": 14399, "hostname": "Mac", "node_ip": "127.0.0.1", "config": {"exploration_config": {}, "extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "placement_strategy": "PACK", "num_gpus": 0, "_fake_gpus": false, "num_cpus_for_main_process": 2, "eager_tracing": true, "eager_max_retraces": 20, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "torch_compile_learner": false, "torch_compile_learner_what_to_compile": "forward_train", "torch_compile_learner_dynamo_backend": "aot_eager", "torch_compile_learner_dynamo_mode": null, "torch_compile_worker": false, "torch_compile_worker_dynamo_backend": "aot_eager", "torch_compile_worker_dynamo_mode": null, "torch_ddp_kwargs": {}, "torch_skip_nan_gradients": false, "env": "Umbrella", "env_config": {}, "observation_space": null, "action_space": null, "clip_rewards": null, "normalize_actions": true, "clip_actions": false, "_is_atari": null, "disable_env_checking": false, "render_env": false, "action_mask_key": "action_mask", "env_runner_cls": null, "num_env_runners": 0, "create_local_env_runner": true, "num_envs_per_env_runner": 1, "gym_env_vectorize_mode": "SYNC", "num_cpus_per_env_runner": 1, "num_gpus_per_env_runner": 0, "custom_resources_per_env_runner": {}, "validate_env_runners_after_construction": true, "episodes_to_numpy": true, "max_requests_in_flight_per_env_runner": 1, "sample_timeout_s": 60.0, "_env_to_module_connector": null, "add_default_connectors_to_env_to_module_pipeline": true, "_module_to_env_connector": null, "add_default_connectors_to_module_to_env_pipeline": true, "merge_env_runner_states": "training_only", "broadcast_env_runner_states": true, "episode_lookback_horizon": 1, "rollout_fragment_length": "auto", "batch_mode": "complete_episodes", "compress_observations": false, "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "enable_tf1_exec_eagerly": false, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "preprocessor_pref": "deepmind", "observation_filter": "NoFilter", "update_worker_filter_stats": true, "use_worker_filter_stats": true, "sampler_perf_stats_ema_coef": null, "_is_online": true, "num_learners": 0, "num_gpus_per_learner": 0, "num_cpus_per_learner": "auto", "num_aggregator_actors_per_learner": 0, "max_requests_in_flight_per_aggregator_actor": 3, "local_gpu_idx": 0, "max_requests_in_flight_per_learner": 3, "gamma": 1, "lr": 0.0002847858517, "grad_clip": 0.5, "grad_clip_by": "global_norm", "_train_batch_size_per_learner": 5000, "train_batch_size": 4000, "num_epochs": 1, "minibatch_size": 1000, "shuffle_batch_per_epoch": true, "model": {"fcnet_hiddens": [256, 256], "fcnet_activation": "tanh", "fcnet_weights_initializer": null, "fcnet_weights_initializer_config": null, "fcnet_bias_initializer": null, "fcnet_bias_initializer_config": null, "conv_filters": null, "conv_activation": "relu", "conv_kernel_initializer": null, "conv_kernel_initializer_config": null, "conv_bias_initializer": null, "conv_bias_initializer_config": null, "conv_transpose_kernel_initializer": null, "conv_transpose_kernel_initializer_config": null, "conv_transpose_bias_initializer": null, "conv_transpose_bias_initializer_config": null, "post_fcnet_hiddens": [], "post_fcnet_activation": "relu", "post_fcnet_weights_initializer": null, "post_fcnet_weights_initializer_config": null, "post_fcnet_bias_initializer": null, "post_fcnet_bias_initializer_config": null, "free_log_std": false, "log_std_clip_param": 20.0, "no_final_linear": false, "vf_share_layers": false, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "lstm_weights_initializer": null, "lstm_weights_initializer_config": null, "lstm_bias_initializer": null, "lstm_bias_initializer_config": null, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "attention_use_n_prev_actions": 0, "attention_use_n_prev_rewards": 0, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": null, "custom_model_config": {}, "custom_action_dist": null, "custom_preprocessor": null, "encoder_latent_dim": null, "always_check_shapes": false, "lstm_use_prev_action_reward": -1, "_use_default_native_models": -1, "_disable_preprocessor_api": false, "_disable_action_flattening": false}, "_learner_connector": null, "add_default_connectors_to_learner_pipeline": true, "learner_config_dict": {}, "optimizer": {}, "_learner_class": null, "callbacks_on_algorithm_init": null, "callbacks_on_env_runners_recreated": null, "callbacks_on_offline_eval_runners_recreated": null, "callbacks_on_checkpoint_loaded": null, "callbacks_on_environment_created": null, "callbacks_on_episode_created": null, "callbacks_on_episode_start": null, "callbacks_on_episode_step": null, "callbacks_on_episode_end": null, "callbacks_on_evaluate_start": null, "callbacks_on_evaluate_end": null, "callbacks_on_evaluate_offline_start": null, "callbacks_on_evaluate_offline_end": null, "callbacks_on_sample_end": null, "callbacks_on_train_result": null, "explore": true, "enable_rl_module_and_learner": true, "enable_env_runner_and_connector_v2": true, "_prior_exploration_config": {"type": "StochasticSampling"}, "count_steps_by": "env_steps", "policy_map_capacity": 100, "policy_mapping_fn": "<function AlgorithmConfig.DEFAULT_POLICY_MAPPING_FN at 0x388aedb20>", "policies_to_train": null, "policy_states_are_swappable": false, "observation_fn": null, "offline_data_class": null, "input_read_method": "read_parquet", "input_read_method_kwargs": {}, "input_read_schema": {}, "input_read_episodes": false, "input_read_sample_batches": false, "input_read_batch_size": null, "input_filesystem": null, "input_filesystem_kwargs": {}, "input_compress_columns": ["obs", "new_obs"], "input_spaces_jsonable": true, "materialize_data": false, "materialize_mapped_data": true, "map_batches_kwargs": {}, "iter_batches_kwargs": {}, "ignore_final_observation": false, "prelearner_class": null, "prelearner_buffer_class": null, "prelearner_buffer_kwargs": {}, "prelearner_module_synch_period": 10, "dataset_num_iters_per_learner": null, "input_config": {}, "actions_in_input_normalized": false, "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_config": {}, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "output_max_rows_per_file": null, "output_write_remaining_data": false, "output_write_method": "write_parquet", "output_write_method_kwargs": {}, "output_filesystem": null, "output_filesystem_kwargs": {}, "output_write_episodes": true, "offline_sampling": false, "evaluation_interval": 1, "evaluation_duration": 20, "evaluation_duration_unit": "episodes", "evaluation_sample_timeout_s": 120.0, "evaluation_auto_duration_min_env_steps_per_sample": 100, "evaluation_auto_duration_max_env_steps_per_sample": 2000, "evaluation_parallel_to_training": false, "evaluation_force_reset_envs_before_iteration": true, "evaluation_config": null, "off_policy_estimation_methods": {}, "ope_split_batch_by_episode": true, "evaluation_num_env_runners": 1, "in_evaluation": false, "sync_filters_on_rollout_workers_timeout_s": 10.0, "offline_evaluation_interval": null, "num_offline_eval_runners": 0, "offline_loss_for_module_fn": null, "offline_evaluation_duration": 1, "offline_evaluation_parallel_to_training": false, "offline_evaluation_timeout_s": 120.0, "num_cpus_per_offline_eval_runner": 1, "num_gpus_per_offline_eval_runner": 0, "custom_resources_per_offline_eval_runner": {}, "restart_failed_offline_eval_runners": true, "ignore_offline_eval_runner_failures": false, "max_num_offline_eval_runner_restarts": 1000, "offline_eval_runner_restore_timeout_s": 1800.0, "max_requests_in_flight_per_offline_eval_runner": 1, "validate_offline_eval_runners_after_construction": true, "offline_eval_runner_health_probe_timeout_s": 30.0, "offline_eval_rl_module_inference_only": false, "broadcast_offline_eval_runner_states": false, "offline_eval_batch_size_per_runner": 256, "dataset_num_iters_per_eval_runner": 1, "keep_per_episode_custom_metrics": false, "metrics_episode_collection_timeout_s": 60.0, "metrics_num_episodes_for_smoothing": 100, "min_time_s_per_iteration": null, "min_train_timesteps_per_iteration": 0, "min_sample_timesteps_per_iteration": 0, "log_gradients": true, "export_native_model_files": false, "checkpoint_trainable_policies_only": false, "logger_creator": null, "logger_config": null, "log_level": "WARN", "log_sys_usage": true, "fake_sampler": false, "seed": 2, "restart_failed_env_runners": true, "ignore_env_runner_failures": false, "max_num_env_runner_restarts": 1000, "delay_between_env_runner_restarts_s": 60.0, "restart_failed_sub_environments": false, "num_consecutive_env_runner_failures_tolerance": 100, "env_runner_health_probe_timeout_s": 30.0, "env_runner_restore_timeout_s": 1800.0, "_model_config": {}, "_rl_module_spec": "RLModuleSpec(module_class=None, observation_space=None, action_space=None, inference_only=False, learner_only=False, model_config=DefaultModelConfig(fcnet_hiddens=[60, 90], fcnet_activation='tanh', fcnet_kernel_initializer=None, fcnet_kernel_initializer_kwargs=None, fcnet_bias_initializer=None, fcnet_bias_initializer_kwargs=None, conv_filters=None, conv_activation='relu', conv_kernel_initializer=None, conv_kernel_initializer_kwargs=None, conv_bias_initializer=None, conv_bias_initializer_kwargs=None, head_fcnet_hiddens=[], head_fcnet_activation='relu', head_fcnet_kernel_initializer=None, head_fcnet_kernel_initializer_kwargs=None, head_fcnet_bias_initializer=None, head_fcnet_bias_initializer_kwargs=None, free_log_std=False, log_std_clip_param=20.0, vf_share_layers=True, use_lstm=False, max_seq_len=20, lstm_cell_size=256, lstm_use_prev_action=False, lstm_use_prev_reward=False, lstm_kernel_initializer=None, lstm_kernel_initializer_kwargs=None, lstm_bias_initializer=None, lstm_bias_initializer_kwargs=None), catalog_class=None, load_state_path=None, model_config_dict=None)", "algorithm_config_overrides_per_module": {}, "_per_module_overrides": {}, "_validate_config": true, "_use_msgpack_checkpoints": false, "_torch_grad_scaler_class": null, "_torch_lr_scheduler_classes": null, "_tf_policy_handles_more_than_one_loss": false, "_disable_preprocessor_api": false, "_disable_action_flattening": false, "_disable_initialize_loss_from_dummy_batch": false, "_dont_auto_sync_env_runner_states": false, "env_task_fn": -1, "enable_connectors": -1, "simple_optimizer": false, "policy_map_cache": -1, "worker_cls": -1, "synchronize_filters": -1, "enable_async_evaluation": -1, "custom_async_evaluation_function": -1, "_enable_rl_module_api": -1, "auto_wrap_old_gym_envs": -1, "always_attach_evaluation_results": -1, "replay_sequence_length": null, "_disable_execution_plan_api": -1, "use_critic": true, "use_gae": true, "use_kl_loss": true, "kl_coeff": 0.7464963036515, "kl_target": 0.0270990929592, "vf_loss_coeff": 0.6688075857018, "entropy_coeff": 0.0090570820258, "clip_param": 0.1221781641624, "vf_clip_param": 0.1027808522125, "entropy_coeff_schedule": null, "lr_schedule": null, "sgd_minibatch_size": -1, "vf_share_layers": -1, "__stdout_file__": null, "__stderr_file__": null, "lambda": 0.9099046732075, "input": "sampler", "policies": {"default_policy": [null, null, null, null]}, "callbacks": "<class 'ray.rllib.callbacks.callbacks.RLlibCallback'>", "create_env_on_driver": false, "custom_eval_function": null, "framework": "torch"}, "time_since_restore": 23.147385120391846, "iterations_since_restore": 14, "perf": {"cpu_util_percent": 40.05, "ram_util_percent": 77.45}}
{"timers": {"training_iteration": 1.59690096936959, "restore_env_runners": 9.352901802655506e-06, "training_step": 1.596766267418289, "env_runner_sampling_timer": 1.484979355272895, "learner_update_timer": 0.10886595513237819, "synch_weights": 0.0005519255933096482, "restore_eval_env_runners": 8.256207990216945e-06, "evaluation_iteration": 0.11330538442294093, "synch_eval_env_connectors": 0.00011153384806154536, "synch_env_connectors": 4.660351698476027e-06}, "env_runners": {"weights_seq_no": 14.0, "num_agent_steps_sampled": {"default_agent": 5000.0}, "env_to_module_connector": {"timers": {"connectors": {"numpy_to_tensor": 8.763883287904027e-06, "add_states_from_episodes_to_batch": 1.740437244084961e-06, "batch_individual_items": 6.3142008591703335e-06, "add_time_dim_to_batch_and_zero_pad": 2.3703522718185713e-06, "add_observations_from_episodes_to_batch": 3.035663692611803e-06}}, "connector_pipeline_timer": 4.4443640023262674e-05}, "module_to_env_connector": {"timers": {"connectors": {"listify_data_for_vector_env": 1.1157043886722888e-05, "tensor_to_numpy": 1.3632637407739408e-05, "remove_single_ts_time_rank_from_batch": 5.95405530231774e-07, "un_batch_to_individual_items": 5.429417971687224e-06, "get_actions": 3.946509771290434e-05, "normalize_and_clip_actions": 9.468862340931416e-06}}, "connector_pipeline_timer": 0.00010611851182190077}, "agent_episode_returns_mean": {"default_agent": 6.74}, "rlmodule_inference_timer": 2.7780815492208773e-05, "module_episode_returns_mean": {"default_policy": 6.74}, "num_episodes": 250.0, "episode_duration_sec_mean": 0.004629544360563161, "env_reset_timer": 3.448719151688122e-05, "num_agent_steps_sampled_lifetime": {"default_agent": -8017500.0}, "episode_return_max": 8.5, "sample": 0.004921140735917734, "num_module_steps_sampled": {"default_policy": 5000.0}, "num_env_steps_sampled": 5000.0, "episode_return_min": -11.5, "env_to_module_sum_episodes_length_out": 10.36823839457432, "num_episodes_lifetime": -400875.0, "episode_len_mean": 20.0, "time_between_sampling": 0.0018186550303186538, "episode_len_max": 20, "env_to_module_sum_episodes_length_in": 10.36823839457432, "num_env_steps_sampled_lifetime": -8017500.0, "env_step_timer": 1.3936683375987043e-05, "num_module_steps_sampled_lifetime": {"default_policy": -8017500.0}, "episode_len_min": 20, "episode_return_mean": 6.74, "num_env_steps_sampled_lifetime_throughput": 3680.2437756372055}, "learners": {"default_policy": {"vf_loss": 0.10278083384037018, "num_module_steps_trained": 6000, "entropy": 0.4242554008960724, "gradients_default_optimizer_global_norm": 0.04951922968029976, "curr_kl_coeff": 2.2781259758630767e-05, "vf_loss_unclipped": 27.907155990600586, "diff_num_grad_updates_vs_sampler_policy": 1.0, "vf_explained_var": 0.004027366638183594, "default_optimizer_learning_rate": 0.0002847858517, "total_loss": 0.06253442168235779, "num_module_steps_trained_lifetime": 90000, "num_trainable_parameters": 6003, "module_train_batch_size_mean": 1000.0, "curr_entropy_coeff": 0.0090570820258, "mean_kl_loss": 0.00040324131259694695, "weights_seq_no": 15.0, "policy_loss": -0.0023636831901967525, "num_module_steps_trained_lifetime_throughput": 434504.9244181732}, "__all_modules__": {"num_non_trainable_parameters": 0, "num_module_steps_trained_lifetime": 90000, "num_trainable_parameters": 6003, "learner_connector": {"connector_pipeline_timer": 0.08494465355451707, "timers": {"connectors": {"add_columns_from_episodes_to_train_batch": 0.033828021868618316, "add_time_dim_to_batch_and_zero_pad": 1.2225612145118182e-05, "add_observations_from_episodes_to_batch": 0.0008104308924737593, "batch_individual_items": 0.03448980385155237, "add_one_ts_to_episodes_and_truncate": 0.008274970807510789, "general_advantage_estimation": 0.0073530845183035175, "numpy_to_tensor": 5.937110874283822e-05, "add_states_from_episodes_to_batch": 3.2635629967922257e-06}}}, "num_env_steps_trained_lifetime": 472500, "learner_connector_sum_episodes_length_out": 5250.0, "num_module_steps_trained": 6000, "learner_connector_sum_episodes_length_in": 5000.0, "num_env_steps_trained": 31500, "num_env_steps_trained_lifetime_throughput": 2273304.8321237257, "num_module_steps_trained_throughput": 434406.0538893584, "num_module_steps_trained_lifetime_throughput": 433836.0102895727}}, "num_training_step_calls_per_iteration": 1, "evaluation": {"env_runners": {"num_episodes": 20, "episode_return_max": 14.5, "agent_episode_returns_mean": {"default_agent": -0.8}, "env_to_module_connector": {"timers": {"connectors": {"numpy_to_tensor": 8.021127517401654e-06, "add_states_from_episodes_to_batch": 1.5281965197587363e-06, "add_time_dim_to_batch_and_zero_pad": 2.104258373844237e-06, "add_observations_from_episodes_to_batch": 2.7741500716878084e-06, "batch_individual_items": 5.981598216830806e-06}}, "connector_pipeline_timer": 4.155970252020519e-05}, "module_episode_returns_mean": {"default_policy": -0.8}, "num_env_steps_sampled": 400, "module_to_env_connector": {"timers": {"connectors": {"remove_single_ts_time_rank_from_batch": 5.564437860549694e-07, "un_batch_to_individual_items": 5.236595743835515e-06, "tensor_to_numpy": 1.26172421201817e-05, "normalize_and_clip_actions": 9.137992920689693e-06, "listify_data_for_vector_env": 1.0755011298666761e-05, "get_actions": 3.449358118322155e-05}}, "connector_pipeline_timer": 9.794474951839117e-05}, "num_module_steps_sampled": {"default_policy": 400}, "episode_len_mean": 20.0, "episode_len_min": 20, "rlmodule_inference_timer": 2.6151418278217568e-05, "episode_duration_sec_mean": 0.004393730493029579, "sample": 0.1007347465538362, "num_agent_steps_sampled": {"default_agent": 400}, "env_to_module_sum_episodes_length_out": 10.368238394574323, "num_episodes_lifetime": 300, "episode_len_max": 20, "env_step_timer": 1.3807538971593847e-05, "episode_return_mean": -0.8, "env_reset_timer": 0.0004792091164623156, "episode_return_min": -14.5, "num_agent_steps_sampled_lifetime": {"default_agent": 6000}, "env_to_module_sum_episodes_length_in": 10.368238394574323, "num_env_steps_sampled_lifetime": 75400, "weights_seq_no": 15.0, "num_module_steps_sampled_lifetime": {"default_policy": 6000}, "time_between_sampling": 1.5899482738267312}, "num_healthy_workers": 1, "actor_manager_num_outstanding_async_reqs": 0, "num_remote_worker_restarts": 0}, "num_env_steps_sampled_lifetime": -8017500.0, "fault_tolerance": {"num_healthy_workers": 0, "num_remote_worker_restarts": 0}, "env_runner_group": {"actor_manager_num_outstanding_async_reqs": 0}, "done": false, "training_iteration": 15, "trial_id": "43ce3_00000", "date": "2025-08-11_19-23-23", "timestamp": 1754933003, "time_this_iter_s": 1.6950268745422363, "time_total_s": 24.842411994934082, "pid": 14399, "hostname": "Mac", "node_ip": "127.0.0.1", "config": {"exploration_config": {}, "extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "placement_strategy": "PACK", "num_gpus": 0, "_fake_gpus": false, "num_cpus_for_main_process": 2, "eager_tracing": true, "eager_max_retraces": 20, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "torch_compile_learner": false, "torch_compile_learner_what_to_compile": "forward_train", "torch_compile_learner_dynamo_backend": "aot_eager", "torch_compile_learner_dynamo_mode": null, "torch_compile_worker": false, "torch_compile_worker_dynamo_backend": "aot_eager", "torch_compile_worker_dynamo_mode": null, "torch_ddp_kwargs": {}, "torch_skip_nan_gradients": false, "env": "Umbrella", "env_config": {}, "observation_space": null, "action_space": null, "clip_rewards": null, "normalize_actions": true, "clip_actions": false, "_is_atari": null, "disable_env_checking": false, "render_env": false, "action_mask_key": "action_mask", "env_runner_cls": null, "num_env_runners": 0, "create_local_env_runner": true, "num_envs_per_env_runner": 1, "gym_env_vectorize_mode": "SYNC", "num_cpus_per_env_runner": 1, "num_gpus_per_env_runner": 0, "custom_resources_per_env_runner": {}, "validate_env_runners_after_construction": true, "episodes_to_numpy": true, "max_requests_in_flight_per_env_runner": 1, "sample_timeout_s": 60.0, "_env_to_module_connector": null, "add_default_connectors_to_env_to_module_pipeline": true, "_module_to_env_connector": null, "add_default_connectors_to_module_to_env_pipeline": true, "merge_env_runner_states": "training_only", "broadcast_env_runner_states": true, "episode_lookback_horizon": 1, "rollout_fragment_length": "auto", "batch_mode": "complete_episodes", "compress_observations": false, "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "enable_tf1_exec_eagerly": false, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "preprocessor_pref": "deepmind", "observation_filter": "NoFilter", "update_worker_filter_stats": true, "use_worker_filter_stats": true, "sampler_perf_stats_ema_coef": null, "_is_online": true, "num_learners": 0, "num_gpus_per_learner": 0, "num_cpus_per_learner": "auto", "num_aggregator_actors_per_learner": 0, "max_requests_in_flight_per_aggregator_actor": 3, "local_gpu_idx": 0, "max_requests_in_flight_per_learner": 3, "gamma": 1, "lr": 0.0002847858517, "grad_clip": 0.5, "grad_clip_by": "global_norm", "_train_batch_size_per_learner": 5000, "train_batch_size": 4000, "num_epochs": 1, "minibatch_size": 1000, "shuffle_batch_per_epoch": true, "model": {"fcnet_hiddens": [256, 256], "fcnet_activation": "tanh", "fcnet_weights_initializer": null, "fcnet_weights_initializer_config": null, "fcnet_bias_initializer": null, "fcnet_bias_initializer_config": null, "conv_filters": null, "conv_activation": "relu", "conv_kernel_initializer": null, "conv_kernel_initializer_config": null, "conv_bias_initializer": null, "conv_bias_initializer_config": null, "conv_transpose_kernel_initializer": null, "conv_transpose_kernel_initializer_config": null, "conv_transpose_bias_initializer": null, "conv_transpose_bias_initializer_config": null, "post_fcnet_hiddens": [], "post_fcnet_activation": "relu", "post_fcnet_weights_initializer": null, "post_fcnet_weights_initializer_config": null, "post_fcnet_bias_initializer": null, "post_fcnet_bias_initializer_config": null, "free_log_std": false, "log_std_clip_param": 20.0, "no_final_linear": false, "vf_share_layers": false, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "lstm_weights_initializer": null, "lstm_weights_initializer_config": null, "lstm_bias_initializer": null, "lstm_bias_initializer_config": null, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "attention_use_n_prev_actions": 0, "attention_use_n_prev_rewards": 0, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": null, "custom_model_config": {}, "custom_action_dist": null, "custom_preprocessor": null, "encoder_latent_dim": null, "always_check_shapes": false, "lstm_use_prev_action_reward": -1, "_use_default_native_models": -1, "_disable_preprocessor_api": false, "_disable_action_flattening": false}, "_learner_connector": null, "add_default_connectors_to_learner_pipeline": true, "learner_config_dict": {}, "optimizer": {}, "_learner_class": null, "callbacks_on_algorithm_init": null, "callbacks_on_env_runners_recreated": null, "callbacks_on_offline_eval_runners_recreated": null, "callbacks_on_checkpoint_loaded": null, "callbacks_on_environment_created": null, "callbacks_on_episode_created": null, "callbacks_on_episode_start": null, "callbacks_on_episode_step": null, "callbacks_on_episode_end": null, "callbacks_on_evaluate_start": null, "callbacks_on_evaluate_end": null, "callbacks_on_evaluate_offline_start": null, "callbacks_on_evaluate_offline_end": null, "callbacks_on_sample_end": null, "callbacks_on_train_result": null, "explore": true, "enable_rl_module_and_learner": true, "enable_env_runner_and_connector_v2": true, "_prior_exploration_config": {"type": "StochasticSampling"}, "count_steps_by": "env_steps", "policy_map_capacity": 100, "policy_mapping_fn": "<function AlgorithmConfig.DEFAULT_POLICY_MAPPING_FN at 0x388aedb20>", "policies_to_train": null, "policy_states_are_swappable": false, "observation_fn": null, "offline_data_class": null, "input_read_method": "read_parquet", "input_read_method_kwargs": {}, "input_read_schema": {}, "input_read_episodes": false, "input_read_sample_batches": false, "input_read_batch_size": null, "input_filesystem": null, "input_filesystem_kwargs": {}, "input_compress_columns": ["obs", "new_obs"], "input_spaces_jsonable": true, "materialize_data": false, "materialize_mapped_data": true, "map_batches_kwargs": {}, "iter_batches_kwargs": {}, "ignore_final_observation": false, "prelearner_class": null, "prelearner_buffer_class": null, "prelearner_buffer_kwargs": {}, "prelearner_module_synch_period": 10, "dataset_num_iters_per_learner": null, "input_config": {}, "actions_in_input_normalized": false, "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_config": {}, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "output_max_rows_per_file": null, "output_write_remaining_data": false, "output_write_method": "write_parquet", "output_write_method_kwargs": {}, "output_filesystem": null, "output_filesystem_kwargs": {}, "output_write_episodes": true, "offline_sampling": false, "evaluation_interval": 1, "evaluation_duration": 20, "evaluation_duration_unit": "episodes", "evaluation_sample_timeout_s": 120.0, "evaluation_auto_duration_min_env_steps_per_sample": 100, "evaluation_auto_duration_max_env_steps_per_sample": 2000, "evaluation_parallel_to_training": false, "evaluation_force_reset_envs_before_iteration": true, "evaluation_config": null, "off_policy_estimation_methods": {}, "ope_split_batch_by_episode": true, "evaluation_num_env_runners": 1, "in_evaluation": false, "sync_filters_on_rollout_workers_timeout_s": 10.0, "offline_evaluation_interval": null, "num_offline_eval_runners": 0, "offline_loss_for_module_fn": null, "offline_evaluation_duration": 1, "offline_evaluation_parallel_to_training": false, "offline_evaluation_timeout_s": 120.0, "num_cpus_per_offline_eval_runner": 1, "num_gpus_per_offline_eval_runner": 0, "custom_resources_per_offline_eval_runner": {}, "restart_failed_offline_eval_runners": true, "ignore_offline_eval_runner_failures": false, "max_num_offline_eval_runner_restarts": 1000, "offline_eval_runner_restore_timeout_s": 1800.0, "max_requests_in_flight_per_offline_eval_runner": 1, "validate_offline_eval_runners_after_construction": true, "offline_eval_runner_health_probe_timeout_s": 30.0, "offline_eval_rl_module_inference_only": false, "broadcast_offline_eval_runner_states": false, "offline_eval_batch_size_per_runner": 256, "dataset_num_iters_per_eval_runner": 1, "keep_per_episode_custom_metrics": false, "metrics_episode_collection_timeout_s": 60.0, "metrics_num_episodes_for_smoothing": 100, "min_time_s_per_iteration": null, "min_train_timesteps_per_iteration": 0, "min_sample_timesteps_per_iteration": 0, "log_gradients": true, "export_native_model_files": false, "checkpoint_trainable_policies_only": false, "logger_creator": null, "logger_config": null, "log_level": "WARN", "log_sys_usage": true, "fake_sampler": false, "seed": 2, "restart_failed_env_runners": true, "ignore_env_runner_failures": false, "max_num_env_runner_restarts": 1000, "delay_between_env_runner_restarts_s": 60.0, "restart_failed_sub_environments": false, "num_consecutive_env_runner_failures_tolerance": 100, "env_runner_health_probe_timeout_s": 30.0, "env_runner_restore_timeout_s": 1800.0, "_model_config": {}, "_rl_module_spec": "RLModuleSpec(module_class=None, observation_space=None, action_space=None, inference_only=False, learner_only=False, model_config=DefaultModelConfig(fcnet_hiddens=[60, 90], fcnet_activation='tanh', fcnet_kernel_initializer=None, fcnet_kernel_initializer_kwargs=None, fcnet_bias_initializer=None, fcnet_bias_initializer_kwargs=None, conv_filters=None, conv_activation='relu', conv_kernel_initializer=None, conv_kernel_initializer_kwargs=None, conv_bias_initializer=None, conv_bias_initializer_kwargs=None, head_fcnet_hiddens=[], head_fcnet_activation='relu', head_fcnet_kernel_initializer=None, head_fcnet_kernel_initializer_kwargs=None, head_fcnet_bias_initializer=None, head_fcnet_bias_initializer_kwargs=None, free_log_std=False, log_std_clip_param=20.0, vf_share_layers=True, use_lstm=False, max_seq_len=20, lstm_cell_size=256, lstm_use_prev_action=False, lstm_use_prev_reward=False, lstm_kernel_initializer=None, lstm_kernel_initializer_kwargs=None, lstm_bias_initializer=None, lstm_bias_initializer_kwargs=None), catalog_class=None, load_state_path=None, model_config_dict=None)", "algorithm_config_overrides_per_module": {}, "_per_module_overrides": {}, "_validate_config": true, "_use_msgpack_checkpoints": false, "_torch_grad_scaler_class": null, "_torch_lr_scheduler_classes": null, "_tf_policy_handles_more_than_one_loss": false, "_disable_preprocessor_api": false, "_disable_action_flattening": false, "_disable_initialize_loss_from_dummy_batch": false, "_dont_auto_sync_env_runner_states": false, "env_task_fn": -1, "enable_connectors": -1, "simple_optimizer": false, "policy_map_cache": -1, "worker_cls": -1, "synchronize_filters": -1, "enable_async_evaluation": -1, "custom_async_evaluation_function": -1, "_enable_rl_module_api": -1, "auto_wrap_old_gym_envs": -1, "always_attach_evaluation_results": -1, "replay_sequence_length": null, "_disable_execution_plan_api": -1, "use_critic": true, "use_gae": true, "use_kl_loss": true, "kl_coeff": 0.7464963036515, "kl_target": 0.0270990929592, "vf_loss_coeff": 0.6688075857018, "entropy_coeff": 0.0090570820258, "clip_param": 0.1221781641624, "vf_clip_param": 0.1027808522125, "entropy_coeff_schedule": null, "lr_schedule": null, "sgd_minibatch_size": -1, "vf_share_layers": -1, "__stdout_file__": null, "__stderr_file__": null, "lambda": 0.9099046732075, "input": "sampler", "policies": {"default_policy": [null, null, null, null]}, "callbacks": "<class 'ray.rllib.callbacks.callbacks.RLlibCallback'>", "create_env_on_driver": false, "custom_eval_function": null, "framework": "torch"}, "time_since_restore": 24.842411994934082, "iterations_since_restore": 15, "perf": {"cpu_util_percent": 41.16666666666667, "ram_util_percent": 77.96666666666667}}
{"timers": {"training_iteration": 1.5960327363454632, "restore_env_runners": 9.311872602313245e-06, "training_step": 1.5958976139031271, "env_runner_sampling_timer": 1.4841779242202002, "learner_update_timer": 0.1087919568309919, "synch_weights": 0.0005531729965841939, "restore_eval_env_runners": 8.232396066627957e-06, "evaluation_iteration": 0.11317356724912923, "synch_eval_env_connectors": 0.00011131475971153859, "synch_env_connectors": 4.65290796744741e-06}, "env_runners": {"weights_seq_no": 15.0, "num_agent_steps_sampled": {"default_agent": 5000.0}, "env_to_module_connector": {"timers": {"connectors": {"numpy_to_tensor": 8.690759301353314e-06, "add_states_from_episodes_to_batch": 1.7295796109334818e-06, "batch_individual_items": 6.25694923555447e-06, "add_time_dim_to_batch_and_zero_pad": 2.363625727322493e-06, "add_observations_from_episodes_to_batch": 2.9495943392897247e-06}}, "connector_pipeline_timer": 4.4191067537571446e-05}, "module_to_env_connector": {"timers": {"connectors": {"listify_data_for_vector_env": 1.1152533330292148e-05, "tensor_to_numpy": 1.3403689984213508e-05, "remove_single_ts_time_rank_from_batch": 5.932259030905834e-07, "un_batch_to_individual_items": 5.397529805146016e-06, "get_actions": 3.954889416245801e-05, "normalize_and_clip_actions": 9.447826470130786e-06}}, "connector_pipeline_timer": 0.00010595649710182153}, "agent_episode_returns_mean": {"default_agent": 7.059999999999999}, "rlmodule_inference_timer": 2.7650623508218066e-05, "module_episode_returns_mean": {"default_policy": 7.059999999999999}, "num_episodes": 250.0, "episode_duration_sec_mean": 0.004624703971203416, "env_reset_timer": 3.3728036585490144e-05, "num_agent_steps_sampled_lifetime": {"default_agent": -8635000.0}, "episode_return_max": 8.5, "sample": 0.004914073549570677, "num_module_steps_sampled": {"default_policy": 5000.0}, "num_env_steps_sampled": 5000.0, "episode_return_min": -11.5, "env_to_module_sum_episodes_length_out": 10.36823839457432, "num_episodes_lifetime": -431750.0, "episode_len_mean": 20.0, "time_between_sampling": 0.0018424070253364089, "episode_len_max": 20, "env_to_module_sum_episodes_length_in": 10.36823839457432, "num_env_steps_sampled_lifetime": -8635000.0, "env_step_timer": 1.3990706042936452e-05, "num_module_steps_sampled_lifetime": {"default_policy": -8635000.0}, "episode_len_min": 20, "episode_return_mean": 7.059999999999999, "num_env_steps_sampled_lifetime_throughput": 3689.438872336215}, "learners": {"default_policy": {"vf_loss": 0.10278083384037018, "num_module_steps_trained": 6000, "entropy": 0.4163439869880676, "gradients_default_optimizer_global_norm": 0.09217683970928192, "curr_kl_coeff": 1.1390629879315384e-05, "vf_loss_unclipped": 27.8068904876709, "diff_num_grad_updates_vs_sampler_policy": 1.0, "vf_explained_var": 0.010698795318603516, "default_optimizer_learning_rate": 0.0002847858517, "total_loss": -0.009013228118419647, "num_module_steps_trained_lifetime": 96000, "num_trainable_parameters": 6003, "module_train_batch_size_mean": 1000.0, "curr_entropy_coeff": 0.0090570820258, "mean_kl_loss": 6.271064921747893e-05, "weights_seq_no": 16.0, "policy_loss": -0.07398297637701035, "num_module_steps_trained_lifetime_throughput": 433191.17531288386}, "__all_modules__": {"num_non_trainable_parameters": 0, "num_module_steps_trained_lifetime": 96000, "num_trainable_parameters": 6003, "learner_connector": {"connector_pipeline_timer": 0.08493120576879801, "timers": {"connectors": {"add_columns_from_episodes_to_train_batch": 0.03384821872994015, "add_time_dim_to_batch_and_zero_pad": 1.2216695652691267e-05, "add_observations_from_episodes_to_batch": 0.0008107449142389139, "batch_individual_items": 0.034469760403035565, "add_one_ts_to_episodes_and_truncate": 0.00827719234947055, "general_advantage_estimation": 0.007336957843631773, "numpy_to_tensor": 5.936698654526201e-05, "add_states_from_episodes_to_batch": 3.268838016377245e-06}}}, "num_env_steps_trained_lifetime": 504000, "learner_connector_sum_episodes_length_out": 5250.0, "num_module_steps_trained": 6000, "learner_connector_sum_episodes_length_in": 5000.0, "num_env_steps_trained": 31500, "num_env_steps_trained_lifetime_throughput": 2266890.4358236166, "num_module_steps_trained_throughput": 433130.6178251681, "num_module_steps_trained_lifetime_throughput": 432578.16906834324}}, "num_training_step_calls_per_iteration": 1, "evaluation": {"env_runners": {"num_episodes": 20, "episode_return_max": 14.5, "agent_episode_returns_mean": {"default_agent": -1.0}, "env_to_module_connector": {"timers": {"connectors": {"numpy_to_tensor": 8.38434544608463e-06, "add_states_from_episodes_to_batch": 1.5579601538674659e-06, "add_time_dim_to_batch_and_zero_pad": 2.170463327845053e-06, "add_observations_from_episodes_to_batch": 2.83974427267116e-06, "batch_individual_items": 6.160750261217377e-06}}, "connector_pipeline_timer": 4.258717675126762e-05}, "module_episode_returns_mean": {"default_policy": -1.0}, "num_env_steps_sampled": 400, "module_to_env_connector": {"timers": {"connectors": {"remove_single_ts_time_rank_from_batch": 5.707415648456921e-07, "un_batch_to_individual_items": 5.335869491217232e-06, "tensor_to_numpy": 1.2815104133176081e-05, "normalize_and_clip_actions": 9.503477420263152e-06, "listify_data_for_vector_env": 1.1025214441626472e-05, "get_actions": 3.575277568860365e-05}}, "connector_pipeline_timer": 0.00010066788761246899}, "num_module_steps_sampled": {"default_policy": 400}, "episode_len_mean": 20.0, "episode_len_min": 20, "rlmodule_inference_timer": 2.670073733116475e-05, "episode_duration_sec_mean": 0.004446338402340188, "sample": 0.10074819575747927, "num_agent_steps_sampled": {"default_agent": 400}, "env_to_module_sum_episodes_length_out": 10.368238394574323, "num_episodes_lifetime": 320, "episode_len_max": 20, "env_step_timer": 1.4190116699037206e-05, "episode_return_mean": -1.0, "env_reset_timer": 0.0004751682754883528, "episode_return_min": -14.5, "num_agent_steps_sampled_lifetime": {"default_agent": 6400}, "env_to_module_sum_episodes_length_in": 10.368238394574323, "num_env_steps_sampled_lifetime": 80400, "weights_seq_no": 16.0, "num_module_steps_sampled_lifetime": {"default_policy": 6400}, "time_between_sampling": 1.5893198698382567}, "num_healthy_workers": 1, "actor_manager_num_outstanding_async_reqs": 0, "num_remote_worker_restarts": 0}, "num_env_steps_sampled_lifetime": -8635000.0, "fault_tolerance": {"num_healthy_workers": 0, "num_remote_worker_restarts": 0}, "env_runner_group": {"actor_manager_num_outstanding_async_reqs": 0}, "done": false, "training_iteration": 16, "trial_id": "43ce3_00000", "date": "2025-08-11_19-23-24", "timestamp": 1754933004, "time_this_iter_s": 1.6199469566345215, "time_total_s": 26.462358951568604, "pid": 14399, "hostname": "Mac", "node_ip": "127.0.0.1", "config": {"exploration_config": {}, "extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "placement_strategy": "PACK", "num_gpus": 0, "_fake_gpus": false, "num_cpus_for_main_process": 2, "eager_tracing": true, "eager_max_retraces": 20, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "torch_compile_learner": false, "torch_compile_learner_what_to_compile": "forward_train", "torch_compile_learner_dynamo_backend": "aot_eager", "torch_compile_learner_dynamo_mode": null, "torch_compile_worker": false, "torch_compile_worker_dynamo_backend": "aot_eager", "torch_compile_worker_dynamo_mode": null, "torch_ddp_kwargs": {}, "torch_skip_nan_gradients": false, "env": "Umbrella", "env_config": {}, "observation_space": null, "action_space": null, "clip_rewards": null, "normalize_actions": true, "clip_actions": false, "_is_atari": null, "disable_env_checking": false, "render_env": false, "action_mask_key": "action_mask", "env_runner_cls": null, "num_env_runners": 0, "create_local_env_runner": true, "num_envs_per_env_runner": 1, "gym_env_vectorize_mode": "SYNC", "num_cpus_per_env_runner": 1, "num_gpus_per_env_runner": 0, "custom_resources_per_env_runner": {}, "validate_env_runners_after_construction": true, "episodes_to_numpy": true, "max_requests_in_flight_per_env_runner": 1, "sample_timeout_s": 60.0, "_env_to_module_connector": null, "add_default_connectors_to_env_to_module_pipeline": true, "_module_to_env_connector": null, "add_default_connectors_to_module_to_env_pipeline": true, "merge_env_runner_states": "training_only", "broadcast_env_runner_states": true, "episode_lookback_horizon": 1, "rollout_fragment_length": "auto", "batch_mode": "complete_episodes", "compress_observations": false, "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "enable_tf1_exec_eagerly": false, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "preprocessor_pref": "deepmind", "observation_filter": "NoFilter", "update_worker_filter_stats": true, "use_worker_filter_stats": true, "sampler_perf_stats_ema_coef": null, "_is_online": true, "num_learners": 0, "num_gpus_per_learner": 0, "num_cpus_per_learner": "auto", "num_aggregator_actors_per_learner": 0, "max_requests_in_flight_per_aggregator_actor": 3, "local_gpu_idx": 0, "max_requests_in_flight_per_learner": 3, "gamma": 1, "lr": 0.0002847858517, "grad_clip": 0.5, "grad_clip_by": "global_norm", "_train_batch_size_per_learner": 5000, "train_batch_size": 4000, "num_epochs": 1, "minibatch_size": 1000, "shuffle_batch_per_epoch": true, "model": {"fcnet_hiddens": [256, 256], "fcnet_activation": "tanh", "fcnet_weights_initializer": null, "fcnet_weights_initializer_config": null, "fcnet_bias_initializer": null, "fcnet_bias_initializer_config": null, "conv_filters": null, "conv_activation": "relu", "conv_kernel_initializer": null, "conv_kernel_initializer_config": null, "conv_bias_initializer": null, "conv_bias_initializer_config": null, "conv_transpose_kernel_initializer": null, "conv_transpose_kernel_initializer_config": null, "conv_transpose_bias_initializer": null, "conv_transpose_bias_initializer_config": null, "post_fcnet_hiddens": [], "post_fcnet_activation": "relu", "post_fcnet_weights_initializer": null, "post_fcnet_weights_initializer_config": null, "post_fcnet_bias_initializer": null, "post_fcnet_bias_initializer_config": null, "free_log_std": false, "log_std_clip_param": 20.0, "no_final_linear": false, "vf_share_layers": false, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "lstm_weights_initializer": null, "lstm_weights_initializer_config": null, "lstm_bias_initializer": null, "lstm_bias_initializer_config": null, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "attention_use_n_prev_actions": 0, "attention_use_n_prev_rewards": 0, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": null, "custom_model_config": {}, "custom_action_dist": null, "custom_preprocessor": null, "encoder_latent_dim": null, "always_check_shapes": false, "lstm_use_prev_action_reward": -1, "_use_default_native_models": -1, "_disable_preprocessor_api": false, "_disable_action_flattening": false}, "_learner_connector": null, "add_default_connectors_to_learner_pipeline": true, "learner_config_dict": {}, "optimizer": {}, "_learner_class": null, "callbacks_on_algorithm_init": null, "callbacks_on_env_runners_recreated": null, "callbacks_on_offline_eval_runners_recreated": null, "callbacks_on_checkpoint_loaded": null, "callbacks_on_environment_created": null, "callbacks_on_episode_created": null, "callbacks_on_episode_start": null, "callbacks_on_episode_step": null, "callbacks_on_episode_end": null, "callbacks_on_evaluate_start": null, "callbacks_on_evaluate_end": null, "callbacks_on_evaluate_offline_start": null, "callbacks_on_evaluate_offline_end": null, "callbacks_on_sample_end": null, "callbacks_on_train_result": null, "explore": true, "enable_rl_module_and_learner": true, "enable_env_runner_and_connector_v2": true, "_prior_exploration_config": {"type": "StochasticSampling"}, "count_steps_by": "env_steps", "policy_map_capacity": 100, "policy_mapping_fn": "<function AlgorithmConfig.DEFAULT_POLICY_MAPPING_FN at 0x388aedb20>", "policies_to_train": null, "policy_states_are_swappable": false, "observation_fn": null, "offline_data_class": null, "input_read_method": "read_parquet", "input_read_method_kwargs": {}, "input_read_schema": {}, "input_read_episodes": false, "input_read_sample_batches": false, "input_read_batch_size": null, "input_filesystem": null, "input_filesystem_kwargs": {}, "input_compress_columns": ["obs", "new_obs"], "input_spaces_jsonable": true, "materialize_data": false, "materialize_mapped_data": true, "map_batches_kwargs": {}, "iter_batches_kwargs": {}, "ignore_final_observation": false, "prelearner_class": null, "prelearner_buffer_class": null, "prelearner_buffer_kwargs": {}, "prelearner_module_synch_period": 10, "dataset_num_iters_per_learner": null, "input_config": {}, "actions_in_input_normalized": false, "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_config": {}, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "output_max_rows_per_file": null, "output_write_remaining_data": false, "output_write_method": "write_parquet", "output_write_method_kwargs": {}, "output_filesystem": null, "output_filesystem_kwargs": {}, "output_write_episodes": true, "offline_sampling": false, "evaluation_interval": 1, "evaluation_duration": 20, "evaluation_duration_unit": "episodes", "evaluation_sample_timeout_s": 120.0, "evaluation_auto_duration_min_env_steps_per_sample": 100, "evaluation_auto_duration_max_env_steps_per_sample": 2000, "evaluation_parallel_to_training": false, "evaluation_force_reset_envs_before_iteration": true, "evaluation_config": null, "off_policy_estimation_methods": {}, "ope_split_batch_by_episode": true, "evaluation_num_env_runners": 1, "in_evaluation": false, "sync_filters_on_rollout_workers_timeout_s": 10.0, "offline_evaluation_interval": null, "num_offline_eval_runners": 0, "offline_loss_for_module_fn": null, "offline_evaluation_duration": 1, "offline_evaluation_parallel_to_training": false, "offline_evaluation_timeout_s": 120.0, "num_cpus_per_offline_eval_runner": 1, "num_gpus_per_offline_eval_runner": 0, "custom_resources_per_offline_eval_runner": {}, "restart_failed_offline_eval_runners": true, "ignore_offline_eval_runner_failures": false, "max_num_offline_eval_runner_restarts": 1000, "offline_eval_runner_restore_timeout_s": 1800.0, "max_requests_in_flight_per_offline_eval_runner": 1, "validate_offline_eval_runners_after_construction": true, "offline_eval_runner_health_probe_timeout_s": 30.0, "offline_eval_rl_module_inference_only": false, "broadcast_offline_eval_runner_states": false, "offline_eval_batch_size_per_runner": 256, "dataset_num_iters_per_eval_runner": 1, "keep_per_episode_custom_metrics": false, "metrics_episode_collection_timeout_s": 60.0, "metrics_num_episodes_for_smoothing": 100, "min_time_s_per_iteration": null, "min_train_timesteps_per_iteration": 0, "min_sample_timesteps_per_iteration": 0, "log_gradients": true, "export_native_model_files": false, "checkpoint_trainable_policies_only": false, "logger_creator": null, "logger_config": null, "log_level": "WARN", "log_sys_usage": true, "fake_sampler": false, "seed": 2, "restart_failed_env_runners": true, "ignore_env_runner_failures": false, "max_num_env_runner_restarts": 1000, "delay_between_env_runner_restarts_s": 60.0, "restart_failed_sub_environments": false, "num_consecutive_env_runner_failures_tolerance": 100, "env_runner_health_probe_timeout_s": 30.0, "env_runner_restore_timeout_s": 1800.0, "_model_config": {}, "_rl_module_spec": "RLModuleSpec(module_class=None, observation_space=None, action_space=None, inference_only=False, learner_only=False, model_config=DefaultModelConfig(fcnet_hiddens=[60, 90], fcnet_activation='tanh', fcnet_kernel_initializer=None, fcnet_kernel_initializer_kwargs=None, fcnet_bias_initializer=None, fcnet_bias_initializer_kwargs=None, conv_filters=None, conv_activation='relu', conv_kernel_initializer=None, conv_kernel_initializer_kwargs=None, conv_bias_initializer=None, conv_bias_initializer_kwargs=None, head_fcnet_hiddens=[], head_fcnet_activation='relu', head_fcnet_kernel_initializer=None, head_fcnet_kernel_initializer_kwargs=None, head_fcnet_bias_initializer=None, head_fcnet_bias_initializer_kwargs=None, free_log_std=False, log_std_clip_param=20.0, vf_share_layers=True, use_lstm=False, max_seq_len=20, lstm_cell_size=256, lstm_use_prev_action=False, lstm_use_prev_reward=False, lstm_kernel_initializer=None, lstm_kernel_initializer_kwargs=None, lstm_bias_initializer=None, lstm_bias_initializer_kwargs=None), catalog_class=None, load_state_path=None, model_config_dict=None)", "algorithm_config_overrides_per_module": {}, "_per_module_overrides": {}, "_validate_config": true, "_use_msgpack_checkpoints": false, "_torch_grad_scaler_class": null, "_torch_lr_scheduler_classes": null, "_tf_policy_handles_more_than_one_loss": false, "_disable_preprocessor_api": false, "_disable_action_flattening": false, "_disable_initialize_loss_from_dummy_batch": false, "_dont_auto_sync_env_runner_states": false, "env_task_fn": -1, "enable_connectors": -1, "simple_optimizer": false, "policy_map_cache": -1, "worker_cls": -1, "synchronize_filters": -1, "enable_async_evaluation": -1, "custom_async_evaluation_function": -1, "_enable_rl_module_api": -1, "auto_wrap_old_gym_envs": -1, "always_attach_evaluation_results": -1, "replay_sequence_length": null, "_disable_execution_plan_api": -1, "use_critic": true, "use_gae": true, "use_kl_loss": true, "kl_coeff": 0.7464963036515, "kl_target": 0.0270990929592, "vf_loss_coeff": 0.6688075857018, "entropy_coeff": 0.0090570820258, "clip_param": 0.1221781641624, "vf_clip_param": 0.1027808522125, "entropy_coeff_schedule": null, "lr_schedule": null, "sgd_minibatch_size": -1, "vf_share_layers": -1, "__stdout_file__": null, "__stderr_file__": null, "lambda": 0.9099046732075, "input": "sampler", "policies": {"default_policy": [null, null, null, null]}, "callbacks": "<class 'ray.rllib.callbacks.callbacks.RLlibCallback'>", "create_env_on_driver": false, "custom_eval_function": null, "framework": "torch"}, "time_since_restore": 26.462358951568604, "iterations_since_restore": 16, "perf": {"cpu_util_percent": 40.55, "ram_util_percent": 78.4}}
{"timers": {"training_iteration": 1.5980115069017429, "restore_env_runners": 9.280003469562918e-06, "training_step": 1.5978751269247342, "env_runner_sampling_timer": 1.4856013191482558, "learner_update_timer": 0.10931452643251616, "synch_weights": 0.0005619962664940017, "restore_eval_env_runners": 8.235071589040395e-06, "evaluation_iteration": 0.11311330949668774, "synch_eval_env_connectors": 0.00011146495235104232, "synch_env_connectors": 4.647208069444079e-06}, "env_runners": {"weights_seq_no": 16.0, "num_agent_steps_sampled": {"default_agent": 5000.0}, "env_to_module_connector": {"timers": {"connectors": {"numpy_to_tensor": 9.476979629557838e-06, "add_states_from_episodes_to_batch": 1.8262754258887547e-06, "batch_individual_items": 6.757126291858531e-06, "add_time_dim_to_batch_and_zero_pad": 2.523019957807054e-06, "add_observations_from_episodes_to_batch": 3.1858591527564194e-06}}, "connector_pipeline_timer": 4.696825600092338e-05}, "module_to_env_connector": {"timers": {"connectors": {"listify_data_for_vector_env": 1.1871636726813273e-05, "tensor_to_numpy": 1.4449120626465026e-05, "remove_single_ts_time_rank_from_batch": 6.113857435716969e-07, "un_batch_to_individual_items": 5.688955082422406e-06, "get_actions": 4.2879071197305654e-05, "normalize_and_clip_actions": 1.0030174781817346e-05}}, "connector_pipeline_timer": 0.00011305134747735054}, "agent_episode_returns_mean": {"default_agent": 6.9}, "rlmodule_inference_timer": 4.681805504044764e-05, "module_episode_returns_mean": {"default_policy": 6.9}, "num_episodes": 250.0, "episode_duration_sec_mean": 0.0053405323089100445, "env_reset_timer": 3.974493899118284e-05, "num_agent_steps_sampled_lifetime": {"default_agent": -9252500.0}, "episode_return_max": 8.5, "sample": 0.005449367361419124, "num_module_steps_sampled": {"default_policy": 5000.0}, "num_env_steps_sampled": 5000.0, "episode_return_min": -11.5, "env_to_module_sum_episodes_length_out": 10.36823839457432, "num_episodes_lifetime": -462625.0, "episode_len_mean": 20.0, "time_between_sampling": 0.0016211423363138317, "episode_len_max": 20, "env_to_module_sum_episodes_length_in": 10.36823839457432, "num_env_steps_sampled_lifetime": -9252500.0, "env_step_timer": 1.5004940297168496e-05, "num_module_steps_sampled_lifetime": {"default_policy": -9252500.0}, "episode_len_min": 20, "episode_return_mean": 6.9, "num_env_steps_sampled_lifetime_throughput": 3474.2054867863962}, "learners": {"default_policy": {"vf_loss": 0.10278083384037018, "num_module_steps_trained": 6000, "entropy": 0.4231090247631073, "gradients_default_optimizer_global_norm": 0.06734903156757355, "curr_kl_coeff": 5.695314939657692e-06, "vf_loss_unclipped": 27.776878356933594, "diff_num_grad_updates_vs_sampler_policy": 1.0, "vf_explained_var": 0.011242687702178955, "default_optimizer_learning_rate": 0.0002847858517, "total_loss": -0.027786191552877426, "num_module_steps_trained_lifetime": 102000, "num_trainable_parameters": 6003, "module_train_batch_size_mean": 1000.0, "curr_entropy_coeff": 0.0090570820258, "mean_kl_loss": 8.43530724523589e-05, "weights_seq_no": 17.0, "policy_loss": -0.09269465506076813, "num_module_steps_trained_lifetime_throughput": 429107.93965990207}, "__all_modules__": {"num_non_trainable_parameters": 0, "num_module_steps_trained_lifetime": 102000, "num_trainable_parameters": 6003, "learner_connector": {"connector_pipeline_timer": 0.08538424121098724, "timers": {"connectors": {"add_columns_from_episodes_to_train_batch": 0.03409805112244052, "add_time_dim_to_batch_and_zero_pad": 1.2311609510928258e-05, "add_observations_from_episodes_to_batch": 0.0008152616345635419, "batch_individual_items": 0.03459236029900461, "add_one_ts_to_episodes_and_truncate": 0.008355374176576884, "general_advantage_estimation": 0.00733341451515999, "numpy_to_tensor": 5.9827486522782736e-05, "add_states_from_episodes_to_batch": 3.2890592358305963e-06}}}, "num_env_steps_trained_lifetime": 535500, "learner_connector_sum_episodes_length_out": 5250.0, "num_module_steps_trained": 6000, "learner_connector_sum_episodes_length_in": 5000.0, "num_env_steps_trained": 31500, "num_env_steps_trained_lifetime_throughput": 2245745.2705213465, "num_module_steps_trained_throughput": 429075.7927242039, "num_module_steps_trained_lifetime_throughput": 428529.2811907772}}, "num_training_step_calls_per_iteration": 1, "evaluation": {"env_runners": {"num_episodes": 20, "episode_return_max": 14.5, "agent_episode_returns_mean": {"default_agent": -0.4}, "env_to_module_connector": {"timers": {"connectors": {"numpy_to_tensor": 1.4057894531364252e-05, "add_states_from_episodes_to_batch": 2.138609594986511e-06, "add_time_dim_to_batch_and_zero_pad": 3.1089534450087835e-06, "add_observations_from_episodes_to_batch": 3.926682957104793e-06, "batch_individual_items": 9.581941320109092e-06}}, "connector_pipeline_timer": 6.15642791551169e-05}, "module_episode_returns_mean": {"default_policy": -0.4}, "num_env_steps_sampled": 400, "module_to_env_connector": {"timers": {"connectors": {"remove_single_ts_time_rank_from_batch": 7.718509097366837e-07, "un_batch_to_individual_items": 7.688610646250204e-06, "tensor_to_numpy": 1.8654821097741182e-05, "normalize_and_clip_actions": 1.5575269654043956e-05, "listify_data_for_vector_env": 1.753454600230679e-05, "get_actions": 6.648478414538919e-05}}, "connector_pipeline_timer": 0.00016409682376181716}, "num_module_steps_sampled": {"default_policy": 400}, "episode_len_mean": 20.0, "episode_len_min": 20, "rlmodule_inference_timer": 4.489490885708129e-05, "episode_duration_sec_mean": 0.005071369216311723, "sample": 0.10137436172000264, "num_agent_steps_sampled": {"default_agent": 400}, "env_to_module_sum_episodes_length_out": 10.368238394574323, "num_episodes_lifetime": 340, "episode_len_max": 20, "env_step_timer": 2.3502803256719348e-05, "episode_return_mean": -0.4, "env_reset_timer": 0.0004725707628033128, "episode_return_min": -14.5, "num_agent_steps_sampled_lifetime": {"default_agent": 6800}, "env_to_module_sum_episodes_length_in": 10.368238394574323, "num_env_steps_sampled_lifetime": 85400, "weights_seq_no": 17.0, "num_module_steps_sampled_lifetime": {"default_policy": 6800}, "time_between_sampling": 1.591612627389819}, "num_healthy_workers": 1, "actor_manager_num_outstanding_async_reqs": 0, "num_remote_worker_restarts": 0}, "num_env_steps_sampled_lifetime": -9252500.0, "fault_tolerance": {"num_healthy_workers": 0, "num_remote_worker_restarts": 0}, "env_runner_group": {"actor_manager_num_outstanding_async_reqs": 0}, "done": false, "training_iteration": 17, "trial_id": "43ce3_00000", "date": "2025-08-11_19-23-26", "timestamp": 1754933006, "time_this_iter_s": 1.972665786743164, "time_total_s": 28.435024738311768, "pid": 14399, "hostname": "Mac", "node_ip": "127.0.0.1", "config": {"exploration_config": {}, "extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "placement_strategy": "PACK", "num_gpus": 0, "_fake_gpus": false, "num_cpus_for_main_process": 2, "eager_tracing": true, "eager_max_retraces": 20, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "torch_compile_learner": false, "torch_compile_learner_what_to_compile": "forward_train", "torch_compile_learner_dynamo_backend": "aot_eager", "torch_compile_learner_dynamo_mode": null, "torch_compile_worker": false, "torch_compile_worker_dynamo_backend": "aot_eager", "torch_compile_worker_dynamo_mode": null, "torch_ddp_kwargs": {}, "torch_skip_nan_gradients": false, "env": "Umbrella", "env_config": {}, "observation_space": null, "action_space": null, "clip_rewards": null, "normalize_actions": true, "clip_actions": false, "_is_atari": null, "disable_env_checking": false, "render_env": false, "action_mask_key": "action_mask", "env_runner_cls": null, "num_env_runners": 0, "create_local_env_runner": true, "num_envs_per_env_runner": 1, "gym_env_vectorize_mode": "SYNC", "num_cpus_per_env_runner": 1, "num_gpus_per_env_runner": 0, "custom_resources_per_env_runner": {}, "validate_env_runners_after_construction": true, "episodes_to_numpy": true, "max_requests_in_flight_per_env_runner": 1, "sample_timeout_s": 60.0, "_env_to_module_connector": null, "add_default_connectors_to_env_to_module_pipeline": true, "_module_to_env_connector": null, "add_default_connectors_to_module_to_env_pipeline": true, "merge_env_runner_states": "training_only", "broadcast_env_runner_states": true, "episode_lookback_horizon": 1, "rollout_fragment_length": "auto", "batch_mode": "complete_episodes", "compress_observations": false, "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "enable_tf1_exec_eagerly": false, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "preprocessor_pref": "deepmind", "observation_filter": "NoFilter", "update_worker_filter_stats": true, "use_worker_filter_stats": true, "sampler_perf_stats_ema_coef": null, "_is_online": true, "num_learners": 0, "num_gpus_per_learner": 0, "num_cpus_per_learner": "auto", "num_aggregator_actors_per_learner": 0, "max_requests_in_flight_per_aggregator_actor": 3, "local_gpu_idx": 0, "max_requests_in_flight_per_learner": 3, "gamma": 1, "lr": 0.0002847858517, "grad_clip": 0.5, "grad_clip_by": "global_norm", "_train_batch_size_per_learner": 5000, "train_batch_size": 4000, "num_epochs": 1, "minibatch_size": 1000, "shuffle_batch_per_epoch": true, "model": {"fcnet_hiddens": [256, 256], "fcnet_activation": "tanh", "fcnet_weights_initializer": null, "fcnet_weights_initializer_config": null, "fcnet_bias_initializer": null, "fcnet_bias_initializer_config": null, "conv_filters": null, "conv_activation": "relu", "conv_kernel_initializer": null, "conv_kernel_initializer_config": null, "conv_bias_initializer": null, "conv_bias_initializer_config": null, "conv_transpose_kernel_initializer": null, "conv_transpose_kernel_initializer_config": null, "conv_transpose_bias_initializer": null, "conv_transpose_bias_initializer_config": null, "post_fcnet_hiddens": [], "post_fcnet_activation": "relu", "post_fcnet_weights_initializer": null, "post_fcnet_weights_initializer_config": null, "post_fcnet_bias_initializer": null, "post_fcnet_bias_initializer_config": null, "free_log_std": false, "log_std_clip_param": 20.0, "no_final_linear": false, "vf_share_layers": false, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "lstm_weights_initializer": null, "lstm_weights_initializer_config": null, "lstm_bias_initializer": null, "lstm_bias_initializer_config": null, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "attention_use_n_prev_actions": 0, "attention_use_n_prev_rewards": 0, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": null, "custom_model_config": {}, "custom_action_dist": null, "custom_preprocessor": null, "encoder_latent_dim": null, "always_check_shapes": false, "lstm_use_prev_action_reward": -1, "_use_default_native_models": -1, "_disable_preprocessor_api": false, "_disable_action_flattening": false}, "_learner_connector": null, "add_default_connectors_to_learner_pipeline": true, "learner_config_dict": {}, "optimizer": {}, "_learner_class": null, "callbacks_on_algorithm_init": null, "callbacks_on_env_runners_recreated": null, "callbacks_on_offline_eval_runners_recreated": null, "callbacks_on_checkpoint_loaded": null, "callbacks_on_environment_created": null, "callbacks_on_episode_created": null, "callbacks_on_episode_start": null, "callbacks_on_episode_step": null, "callbacks_on_episode_end": null, "callbacks_on_evaluate_start": null, "callbacks_on_evaluate_end": null, "callbacks_on_evaluate_offline_start": null, "callbacks_on_evaluate_offline_end": null, "callbacks_on_sample_end": null, "callbacks_on_train_result": null, "explore": true, "enable_rl_module_and_learner": true, "enable_env_runner_and_connector_v2": true, "_prior_exploration_config": {"type": "StochasticSampling"}, "count_steps_by": "env_steps", "policy_map_capacity": 100, "policy_mapping_fn": "<function AlgorithmConfig.DEFAULT_POLICY_MAPPING_FN at 0x388aedb20>", "policies_to_train": null, "policy_states_are_swappable": false, "observation_fn": null, "offline_data_class": null, "input_read_method": "read_parquet", "input_read_method_kwargs": {}, "input_read_schema": {}, "input_read_episodes": false, "input_read_sample_batches": false, "input_read_batch_size": null, "input_filesystem": null, "input_filesystem_kwargs": {}, "input_compress_columns": ["obs", "new_obs"], "input_spaces_jsonable": true, "materialize_data": false, "materialize_mapped_data": true, "map_batches_kwargs": {}, "iter_batches_kwargs": {}, "ignore_final_observation": false, "prelearner_class": null, "prelearner_buffer_class": null, "prelearner_buffer_kwargs": {}, "prelearner_module_synch_period": 10, "dataset_num_iters_per_learner": null, "input_config": {}, "actions_in_input_normalized": false, "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_config": {}, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "output_max_rows_per_file": null, "output_write_remaining_data": false, "output_write_method": "write_parquet", "output_write_method_kwargs": {}, "output_filesystem": null, "output_filesystem_kwargs": {}, "output_write_episodes": true, "offline_sampling": false, "evaluation_interval": 1, "evaluation_duration": 20, "evaluation_duration_unit": "episodes", "evaluation_sample_timeout_s": 120.0, "evaluation_auto_duration_min_env_steps_per_sample": 100, "evaluation_auto_duration_max_env_steps_per_sample": 2000, "evaluation_parallel_to_training": false, "evaluation_force_reset_envs_before_iteration": true, "evaluation_config": null, "off_policy_estimation_methods": {}, "ope_split_batch_by_episode": true, "evaluation_num_env_runners": 1, "in_evaluation": false, "sync_filters_on_rollout_workers_timeout_s": 10.0, "offline_evaluation_interval": null, "num_offline_eval_runners": 0, "offline_loss_for_module_fn": null, "offline_evaluation_duration": 1, "offline_evaluation_parallel_to_training": false, "offline_evaluation_timeout_s": 120.0, "num_cpus_per_offline_eval_runner": 1, "num_gpus_per_offline_eval_runner": 0, "custom_resources_per_offline_eval_runner": {}, "restart_failed_offline_eval_runners": true, "ignore_offline_eval_runner_failures": false, "max_num_offline_eval_runner_restarts": 1000, "offline_eval_runner_restore_timeout_s": 1800.0, "max_requests_in_flight_per_offline_eval_runner": 1, "validate_offline_eval_runners_after_construction": true, "offline_eval_runner_health_probe_timeout_s": 30.0, "offline_eval_rl_module_inference_only": false, "broadcast_offline_eval_runner_states": false, "offline_eval_batch_size_per_runner": 256, "dataset_num_iters_per_eval_runner": 1, "keep_per_episode_custom_metrics": false, "metrics_episode_collection_timeout_s": 60.0, "metrics_num_episodes_for_smoothing": 100, "min_time_s_per_iteration": null, "min_train_timesteps_per_iteration": 0, "min_sample_timesteps_per_iteration": 0, "log_gradients": true, "export_native_model_files": false, "checkpoint_trainable_policies_only": false, "logger_creator": null, "logger_config": null, "log_level": "WARN", "log_sys_usage": true, "fake_sampler": false, "seed": 2, "restart_failed_env_runners": true, "ignore_env_runner_failures": false, "max_num_env_runner_restarts": 1000, "delay_between_env_runner_restarts_s": 60.0, "restart_failed_sub_environments": false, "num_consecutive_env_runner_failures_tolerance": 100, "env_runner_health_probe_timeout_s": 30.0, "env_runner_restore_timeout_s": 1800.0, "_model_config": {}, "_rl_module_spec": "RLModuleSpec(module_class=None, observation_space=None, action_space=None, inference_only=False, learner_only=False, model_config=DefaultModelConfig(fcnet_hiddens=[60, 90], fcnet_activation='tanh', fcnet_kernel_initializer=None, fcnet_kernel_initializer_kwargs=None, fcnet_bias_initializer=None, fcnet_bias_initializer_kwargs=None, conv_filters=None, conv_activation='relu', conv_kernel_initializer=None, conv_kernel_initializer_kwargs=None, conv_bias_initializer=None, conv_bias_initializer_kwargs=None, head_fcnet_hiddens=[], head_fcnet_activation='relu', head_fcnet_kernel_initializer=None, head_fcnet_kernel_initializer_kwargs=None, head_fcnet_bias_initializer=None, head_fcnet_bias_initializer_kwargs=None, free_log_std=False, log_std_clip_param=20.0, vf_share_layers=True, use_lstm=False, max_seq_len=20, lstm_cell_size=256, lstm_use_prev_action=False, lstm_use_prev_reward=False, lstm_kernel_initializer=None, lstm_kernel_initializer_kwargs=None, lstm_bias_initializer=None, lstm_bias_initializer_kwargs=None), catalog_class=None, load_state_path=None, model_config_dict=None)", "algorithm_config_overrides_per_module": {}, "_per_module_overrides": {}, "_validate_config": true, "_use_msgpack_checkpoints": false, "_torch_grad_scaler_class": null, "_torch_lr_scheduler_classes": null, "_tf_policy_handles_more_than_one_loss": false, "_disable_preprocessor_api": false, "_disable_action_flattening": false, "_disable_initialize_loss_from_dummy_batch": false, "_dont_auto_sync_env_runner_states": false, "env_task_fn": -1, "enable_connectors": -1, "simple_optimizer": false, "policy_map_cache": -1, "worker_cls": -1, "synchronize_filters": -1, "enable_async_evaluation": -1, "custom_async_evaluation_function": -1, "_enable_rl_module_api": -1, "auto_wrap_old_gym_envs": -1, "always_attach_evaluation_results": -1, "replay_sequence_length": null, "_disable_execution_plan_api": -1, "use_critic": true, "use_gae": true, "use_kl_loss": true, "kl_coeff": 0.7464963036515, "kl_target": 0.0270990929592, "vf_loss_coeff": 0.6688075857018, "entropy_coeff": 0.0090570820258, "clip_param": 0.1221781641624, "vf_clip_param": 0.1027808522125, "entropy_coeff_schedule": null, "lr_schedule": null, "sgd_minibatch_size": -1, "vf_share_layers": -1, "__stdout_file__": null, "__stderr_file__": null, "lambda": 0.9099046732075, "input": "sampler", "policies": {"default_policy": [null, null, null, null]}, "callbacks": "<class 'ray.rllib.callbacks.callbacks.RLlibCallback'>", "create_env_on_driver": false, "custom_eval_function": null, "framework": "torch"}, "time_since_restore": 28.435024738311768, "iterations_since_restore": 17, "perf": {"cpu_util_percent": 32.96666666666667, "ram_util_percent": 78.7}}
{"timers": {"training_iteration": 1.599788644742667, "restore_env_runners": 9.254293584836153e-06, "training_step": 1.599651389405189, "env_runner_sampling_timer": 1.4864382234576285, "learner_update_timer": 0.11025134533767836, "synch_weights": 0.0005620842238923487, "restore_eval_env_runners": 8.348970330226183e-06, "evaluation_iteration": 0.11370501682169132, "synch_eval_env_connectors": 0.00011194280389415702, "synch_env_connectors": 4.641566334573999e-06}, "env_runners": {"weights_seq_no": 17.0, "num_agent_steps_sampled": {"default_agent": 5000.0}, "env_to_module_connector": {"timers": {"connectors": {"numpy_to_tensor": 1.0097042364737979e-05, "add_states_from_episodes_to_batch": 1.840445854123706e-06, "batch_individual_items": 7.047803984981926e-06, "add_time_dim_to_batch_and_zero_pad": 2.57821611337607e-06, "add_observations_from_episodes_to_batch": 3.2249910133255088e-06}}, "connector_pipeline_timer": 4.858945116089809e-05}, "module_to_env_connector": {"timers": {"connectors": {"listify_data_for_vector_env": 1.2418583695596297e-05, "tensor_to_numpy": 1.5080564238414674e-05, "remove_single_ts_time_rank_from_batch": 6.240642894469198e-07, "un_batch_to_individual_items": 5.946697370345413e-06, "get_actions": 4.558826904913701e-05, "normalize_and_clip_actions": 1.0476302647511721e-05}}, "connector_pipeline_timer": 0.00011862909438039833}, "agent_episode_returns_mean": {"default_agent": 7.059999999999999}, "rlmodule_inference_timer": 3.160619186515218e-05, "module_episode_returns_mean": {"default_policy": 7.059999999999999}, "num_episodes": 250.0, "episode_duration_sec_mean": 0.005150622323155405, "env_reset_timer": 4.8088954146344546e-05, "num_agent_steps_sampled_lifetime": {"default_agent": -9870000.0}, "episode_return_max": 8.5, "sample": 0.005643103632600453, "num_module_steps_sampled": {"default_policy": 5000.0}, "num_env_steps_sampled": 5000.0, "episode_return_min": -11.5, "env_to_module_sum_episodes_length_out": 10.36823839457432, "num_episodes_lifetime": -493500.0, "episode_len_mean": 20.0, "time_between_sampling": 0.002269116880152691, "episode_len_max": 20, "env_to_module_sum_episodes_length_in": 10.36823839457432, "num_env_steps_sampled_lifetime": -9870000.0, "env_step_timer": 1.5942753647350463e-05, "num_module_steps_sampled_lifetime": {"default_policy": -9870000.0}, "episode_len_min": 20, "episode_return_mean": 7.059999999999999, "num_env_steps_sampled_lifetime_throughput": 3308.3021801738473}, "learners": {"default_policy": {"vf_loss": 0.10278083384037018, "num_module_steps_trained": 6000, "entropy": 0.43428218364715576, "gradients_default_optimizer_global_norm": 0.08864210546016693, "curr_kl_coeff": 2.847657469828846e-06, "vf_loss_unclipped": 27.705440521240234, "diff_num_grad_updates_vs_sampler_policy": 1.0, "vf_explained_var": 0.01639944314956665, "default_optimizer_learning_rate": 0.0002847858517, "total_loss": -0.06480350345373154, "num_module_steps_trained_lifetime": 108000, "num_trainable_parameters": 6003, "module_train_batch_size_mean": 1000.0, "curr_entropy_coeff": 0.0090570820258, "mean_kl_loss": 0.00011860190716106445, "weights_seq_no": 18.0, "policy_loss": -0.1296107918024063, "num_module_steps_trained_lifetime_throughput": 425302.33550942416}, "__all_modules__": {"num_non_trainable_parameters": 0, "num_module_steps_trained_lifetime": 108000, "num_trainable_parameters": 6003, "learner_connector": {"connector_pipeline_timer": 0.08639931712975167, "timers": {"connectors": {"add_columns_from_episodes_to_train_batch": 0.0341003547804281, "add_time_dim_to_batch_and_zero_pad": 1.2291823655472563e-05, "add_observations_from_episodes_to_batch": 0.0008157298487035037, "batch_individual_items": 0.035627769615714636, "add_one_ts_to_episodes_and_truncate": 0.008349359185876846, "general_advantage_estimation": 0.007316375780039843, "numpy_to_tensor": 5.991546251742641e-05, "add_states_from_episodes_to_batch": 3.2874191724635127e-06}}}, "num_env_steps_trained_lifetime": 567000, "learner_connector_sum_episodes_length_out": 5250.0, "num_module_steps_trained": 6000, "learner_connector_sum_episodes_length_in": 5000.0, "num_env_steps_trained": 31500, "num_env_steps_trained_lifetime_throughput": 2226099.0430853497, "num_module_steps_trained_throughput": 425299.9804738096, "num_module_steps_trained_lifetime_throughput": 424762.69240885746}}, "num_training_step_calls_per_iteration": 1, "evaluation": {"env_runners": {"num_episodes": 20, "episode_return_max": 14.5, "agent_episode_returns_mean": {"default_agent": 0.0}, "env_to_module_connector": {"timers": {"connectors": {"numpy_to_tensor": 8.380708583450264e-06, "add_states_from_episodes_to_batch": 1.564232117563553e-06, "add_time_dim_to_batch_and_zero_pad": 2.1484342311377104e-06, "add_observations_from_episodes_to_batch": 2.8180814746659183e-06, "batch_individual_items": 6.141846251948326e-06}}, "connector_pipeline_timer": 4.252730245600958e-05}, "module_episode_returns_mean": {"default_policy": 0.0}, "num_env_steps_sampled": 400, "module_to_env_connector": {"timers": {"connectors": {"remove_single_ts_time_rank_from_batch": 5.665079711771824e-07, "un_batch_to_individual_items": 5.3743727299764615e-06, "tensor_to_numpy": 1.2711491858054136e-05, "normalize_and_clip_actions": 9.411617078001527e-06, "listify_data_for_vector_env": 1.1009891841172948e-05, "get_actions": 3.541297790852128e-05}}, "connector_pipeline_timer": 0.00010012230079848619}, "num_module_steps_sampled": {"default_policy": 400}, "episode_len_mean": 20.0, "episode_len_min": 20, "rlmodule_inference_timer": 2.6908096248562963e-05, "episode_duration_sec_mean": 0.005107895025284961, "sample": 0.10136115227194568, "num_agent_steps_sampled": {"default_agent": 400}, "env_to_module_sum_episodes_length_out": 10.368238394574323, "num_episodes_lifetime": 360, "episode_len_max": 20, "env_step_timer": 1.4321386915020965e-05, "episode_return_mean": 0.0, "env_reset_timer": 0.0004691450557608953, "episode_return_min": -13.5, "num_agent_steps_sampled_lifetime": {"default_agent": 7200}, "env_to_module_sum_episodes_length_in": 10.368238394574323, "num_env_steps_sampled_lifetime": 90400, "weights_seq_no": 18.0, "num_module_steps_sampled_lifetime": {"default_policy": 7200}, "time_between_sampling": 1.5937946877767115}, "num_healthy_workers": 1, "actor_manager_num_outstanding_async_reqs": 0, "num_remote_worker_restarts": 0}, "num_env_steps_sampled_lifetime": -9870000.0, "fault_tolerance": {"num_healthy_workers": 0, "num_remote_worker_restarts": 0}, "env_runner_group": {"actor_manager_num_outstanding_async_reqs": 0}, "done": false, "training_iteration": 18, "trial_id": "43ce3_00000", "date": "2025-08-11_19-23-28", "timestamp": 1754933008, "time_this_iter_s": 1.8834710121154785, "time_total_s": 30.318495750427246, "pid": 14399, "hostname": "Mac", "node_ip": "127.0.0.1", "config": {"exploration_config": {}, "extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "placement_strategy": "PACK", "num_gpus": 0, "_fake_gpus": false, "num_cpus_for_main_process": 2, "eager_tracing": true, "eager_max_retraces": 20, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "torch_compile_learner": false, "torch_compile_learner_what_to_compile": "forward_train", "torch_compile_learner_dynamo_backend": "aot_eager", "torch_compile_learner_dynamo_mode": null, "torch_compile_worker": false, "torch_compile_worker_dynamo_backend": "aot_eager", "torch_compile_worker_dynamo_mode": null, "torch_ddp_kwargs": {}, "torch_skip_nan_gradients": false, "env": "Umbrella", "env_config": {}, "observation_space": null, "action_space": null, "clip_rewards": null, "normalize_actions": true, "clip_actions": false, "_is_atari": null, "disable_env_checking": false, "render_env": false, "action_mask_key": "action_mask", "env_runner_cls": null, "num_env_runners": 0, "create_local_env_runner": true, "num_envs_per_env_runner": 1, "gym_env_vectorize_mode": "SYNC", "num_cpus_per_env_runner": 1, "num_gpus_per_env_runner": 0, "custom_resources_per_env_runner": {}, "validate_env_runners_after_construction": true, "episodes_to_numpy": true, "max_requests_in_flight_per_env_runner": 1, "sample_timeout_s": 60.0, "_env_to_module_connector": null, "add_default_connectors_to_env_to_module_pipeline": true, "_module_to_env_connector": null, "add_default_connectors_to_module_to_env_pipeline": true, "merge_env_runner_states": "training_only", "broadcast_env_runner_states": true, "episode_lookback_horizon": 1, "rollout_fragment_length": "auto", "batch_mode": "complete_episodes", "compress_observations": false, "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "enable_tf1_exec_eagerly": false, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "preprocessor_pref": "deepmind", "observation_filter": "NoFilter", "update_worker_filter_stats": true, "use_worker_filter_stats": true, "sampler_perf_stats_ema_coef": null, "_is_online": true, "num_learners": 0, "num_gpus_per_learner": 0, "num_cpus_per_learner": "auto", "num_aggregator_actors_per_learner": 0, "max_requests_in_flight_per_aggregator_actor": 3, "local_gpu_idx": 0, "max_requests_in_flight_per_learner": 3, "gamma": 1, "lr": 0.0002847858517, "grad_clip": 0.5, "grad_clip_by": "global_norm", "_train_batch_size_per_learner": 5000, "train_batch_size": 4000, "num_epochs": 1, "minibatch_size": 1000, "shuffle_batch_per_epoch": true, "model": {"fcnet_hiddens": [256, 256], "fcnet_activation": "tanh", "fcnet_weights_initializer": null, "fcnet_weights_initializer_config": null, "fcnet_bias_initializer": null, "fcnet_bias_initializer_config": null, "conv_filters": null, "conv_activation": "relu", "conv_kernel_initializer": null, "conv_kernel_initializer_config": null, "conv_bias_initializer": null, "conv_bias_initializer_config": null, "conv_transpose_kernel_initializer": null, "conv_transpose_kernel_initializer_config": null, "conv_transpose_bias_initializer": null, "conv_transpose_bias_initializer_config": null, "post_fcnet_hiddens": [], "post_fcnet_activation": "relu", "post_fcnet_weights_initializer": null, "post_fcnet_weights_initializer_config": null, "post_fcnet_bias_initializer": null, "post_fcnet_bias_initializer_config": null, "free_log_std": false, "log_std_clip_param": 20.0, "no_final_linear": false, "vf_share_layers": false, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "lstm_weights_initializer": null, "lstm_weights_initializer_config": null, "lstm_bias_initializer": null, "lstm_bias_initializer_config": null, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "attention_use_n_prev_actions": 0, "attention_use_n_prev_rewards": 0, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": null, "custom_model_config": {}, "custom_action_dist": null, "custom_preprocessor": null, "encoder_latent_dim": null, "always_check_shapes": false, "lstm_use_prev_action_reward": -1, "_use_default_native_models": -1, "_disable_preprocessor_api": false, "_disable_action_flattening": false}, "_learner_connector": null, "add_default_connectors_to_learner_pipeline": true, "learner_config_dict": {}, "optimizer": {}, "_learner_class": null, "callbacks_on_algorithm_init": null, "callbacks_on_env_runners_recreated": null, "callbacks_on_offline_eval_runners_recreated": null, "callbacks_on_checkpoint_loaded": null, "callbacks_on_environment_created": null, "callbacks_on_episode_created": null, "callbacks_on_episode_start": null, "callbacks_on_episode_step": null, "callbacks_on_episode_end": null, "callbacks_on_evaluate_start": null, "callbacks_on_evaluate_end": null, "callbacks_on_evaluate_offline_start": null, "callbacks_on_evaluate_offline_end": null, "callbacks_on_sample_end": null, "callbacks_on_train_result": null, "explore": true, "enable_rl_module_and_learner": true, "enable_env_runner_and_connector_v2": true, "_prior_exploration_config": {"type": "StochasticSampling"}, "count_steps_by": "env_steps", "policy_map_capacity": 100, "policy_mapping_fn": "<function AlgorithmConfig.DEFAULT_POLICY_MAPPING_FN at 0x388aedb20>", "policies_to_train": null, "policy_states_are_swappable": false, "observation_fn": null, "offline_data_class": null, "input_read_method": "read_parquet", "input_read_method_kwargs": {}, "input_read_schema": {}, "input_read_episodes": false, "input_read_sample_batches": false, "input_read_batch_size": null, "input_filesystem": null, "input_filesystem_kwargs": {}, "input_compress_columns": ["obs", "new_obs"], "input_spaces_jsonable": true, "materialize_data": false, "materialize_mapped_data": true, "map_batches_kwargs": {}, "iter_batches_kwargs": {}, "ignore_final_observation": false, "prelearner_class": null, "prelearner_buffer_class": null, "prelearner_buffer_kwargs": {}, "prelearner_module_synch_period": 10, "dataset_num_iters_per_learner": null, "input_config": {}, "actions_in_input_normalized": false, "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_config": {}, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "output_max_rows_per_file": null, "output_write_remaining_data": false, "output_write_method": "write_parquet", "output_write_method_kwargs": {}, "output_filesystem": null, "output_filesystem_kwargs": {}, "output_write_episodes": true, "offline_sampling": false, "evaluation_interval": 1, "evaluation_duration": 20, "evaluation_duration_unit": "episodes", "evaluation_sample_timeout_s": 120.0, "evaluation_auto_duration_min_env_steps_per_sample": 100, "evaluation_auto_duration_max_env_steps_per_sample": 2000, "evaluation_parallel_to_training": false, "evaluation_force_reset_envs_before_iteration": true, "evaluation_config": null, "off_policy_estimation_methods": {}, "ope_split_batch_by_episode": true, "evaluation_num_env_runners": 1, "in_evaluation": false, "sync_filters_on_rollout_workers_timeout_s": 10.0, "offline_evaluation_interval": null, "num_offline_eval_runners": 0, "offline_loss_for_module_fn": null, "offline_evaluation_duration": 1, "offline_evaluation_parallel_to_training": false, "offline_evaluation_timeout_s": 120.0, "num_cpus_per_offline_eval_runner": 1, "num_gpus_per_offline_eval_runner": 0, "custom_resources_per_offline_eval_runner": {}, "restart_failed_offline_eval_runners": true, "ignore_offline_eval_runner_failures": false, "max_num_offline_eval_runner_restarts": 1000, "offline_eval_runner_restore_timeout_s": 1800.0, "max_requests_in_flight_per_offline_eval_runner": 1, "validate_offline_eval_runners_after_construction": true, "offline_eval_runner_health_probe_timeout_s": 30.0, "offline_eval_rl_module_inference_only": false, "broadcast_offline_eval_runner_states": false, "offline_eval_batch_size_per_runner": 256, "dataset_num_iters_per_eval_runner": 1, "keep_per_episode_custom_metrics": false, "metrics_episode_collection_timeout_s": 60.0, "metrics_num_episodes_for_smoothing": 100, "min_time_s_per_iteration": null, "min_train_timesteps_per_iteration": 0, "min_sample_timesteps_per_iteration": 0, "log_gradients": true, "export_native_model_files": false, "checkpoint_trainable_policies_only": false, "logger_creator": null, "logger_config": null, "log_level": "WARN", "log_sys_usage": true, "fake_sampler": false, "seed": 2, "restart_failed_env_runners": true, "ignore_env_runner_failures": false, "max_num_env_runner_restarts": 1000, "delay_between_env_runner_restarts_s": 60.0, "restart_failed_sub_environments": false, "num_consecutive_env_runner_failures_tolerance": 100, "env_runner_health_probe_timeout_s": 30.0, "env_runner_restore_timeout_s": 1800.0, "_model_config": {}, "_rl_module_spec": "RLModuleSpec(module_class=None, observation_space=None, action_space=None, inference_only=False, learner_only=False, model_config=DefaultModelConfig(fcnet_hiddens=[60, 90], fcnet_activation='tanh', fcnet_kernel_initializer=None, fcnet_kernel_initializer_kwargs=None, fcnet_bias_initializer=None, fcnet_bias_initializer_kwargs=None, conv_filters=None, conv_activation='relu', conv_kernel_initializer=None, conv_kernel_initializer_kwargs=None, conv_bias_initializer=None, conv_bias_initializer_kwargs=None, head_fcnet_hiddens=[], head_fcnet_activation='relu', head_fcnet_kernel_initializer=None, head_fcnet_kernel_initializer_kwargs=None, head_fcnet_bias_initializer=None, head_fcnet_bias_initializer_kwargs=None, free_log_std=False, log_std_clip_param=20.0, vf_share_layers=True, use_lstm=False, max_seq_len=20, lstm_cell_size=256, lstm_use_prev_action=False, lstm_use_prev_reward=False, lstm_kernel_initializer=None, lstm_kernel_initializer_kwargs=None, lstm_bias_initializer=None, lstm_bias_initializer_kwargs=None), catalog_class=None, load_state_path=None, model_config_dict=None)", "algorithm_config_overrides_per_module": {}, "_per_module_overrides": {}, "_validate_config": true, "_use_msgpack_checkpoints": false, "_torch_grad_scaler_class": null, "_torch_lr_scheduler_classes": null, "_tf_policy_handles_more_than_one_loss": false, "_disable_preprocessor_api": false, "_disable_action_flattening": false, "_disable_initialize_loss_from_dummy_batch": false, "_dont_auto_sync_env_runner_states": false, "env_task_fn": -1, "enable_connectors": -1, "simple_optimizer": false, "policy_map_cache": -1, "worker_cls": -1, "synchronize_filters": -1, "enable_async_evaluation": -1, "custom_async_evaluation_function": -1, "_enable_rl_module_api": -1, "auto_wrap_old_gym_envs": -1, "always_attach_evaluation_results": -1, "replay_sequence_length": null, "_disable_execution_plan_api": -1, "use_critic": true, "use_gae": true, "use_kl_loss": true, "kl_coeff": 0.7464963036515, "kl_target": 0.0270990929592, "vf_loss_coeff": 0.6688075857018, "entropy_coeff": 0.0090570820258, "clip_param": 0.1221781641624, "vf_clip_param": 0.1027808522125, "entropy_coeff_schedule": null, "lr_schedule": null, "sgd_minibatch_size": -1, "vf_share_layers": -1, "__stdout_file__": null, "__stderr_file__": null, "lambda": 0.9099046732075, "input": "sampler", "policies": {"default_policy": [null, null, null, null]}, "callbacks": "<class 'ray.rllib.callbacks.callbacks.RLlibCallback'>", "create_env_on_driver": false, "custom_eval_function": null, "framework": "torch"}, "time_since_restore": 30.318495750427246, "iterations_since_restore": 18, "perf": {"cpu_util_percent": 52.53333333333333, "ram_util_percent": 78.76666666666667}}
{"timers": {"training_iteration": 1.6001246957946798, "restore_env_runners": 9.220910587233803e-06, "training_step": 1.599987070100914, "env_runner_sampling_timer": 1.486086134972774, "learner_update_timer": 0.11093823772498344, "synch_weights": 0.0005615887908784271, "restore_eval_env_runners": 8.335900255097033e-06, "evaluation_iteration": 0.11361999082353225, "synch_eval_env_connectors": 0.0001117787964014491, "synch_env_connectors": 4.633900675251573e-06}, "env_runners": {"weights_seq_no": 18.0, "num_agent_steps_sampled": {"default_agent": 5000.0}, "env_to_module_connector": {"timers": {"connectors": {"numpy_to_tensor": 9.026043356514864e-06, "add_states_from_episodes_to_batch": 1.7795722290447623e-06, "batch_individual_items": 6.480437219621845e-06, "add_time_dim_to_batch_and_zero_pad": 2.4762448744818635e-06, "add_observations_from_episodes_to_batch": 3.0659101353438185e-06}}, "connector_pipeline_timer": 4.538363455436749e-05}, "module_to_env_connector": {"timers": {"connectors": {"listify_data_for_vector_env": 1.1658463714181175e-05, "tensor_to_numpy": 1.3963002128467817e-05, "remove_single_ts_time_rank_from_batch": 5.94532640269479e-07, "un_batch_to_individual_items": 5.572562619088683e-06, "get_actions": 4.153086692915553e-05, "normalize_and_clip_actions": 9.724170710384065e-06}}, "connector_pipeline_timer": 0.00010974476220123599}, "agent_episode_returns_mean": {"default_agent": 6.74}, "rlmodule_inference_timer": 3.0055852661771958e-05, "module_episode_returns_mean": {"default_policy": 6.74}, "num_episodes": 250.0, "episode_duration_sec_mean": 0.004795259837992491, "env_reset_timer": 4.175754334649237e-05, "num_agent_steps_sampled_lifetime": {"default_agent": -10487500.0}, "episode_return_max": 8.5, "sample": 0.005165942655352387, "num_module_steps_sampled": {"default_policy": 5000.0}, "num_env_steps_sampled": 5000.0, "episode_return_min": -11.5, "env_to_module_sum_episodes_length_out": 10.36823839457432, "num_episodes_lifetime": -524375.0, "episode_len_mean": 20.0, "time_between_sampling": 0.0020122643399161696, "episode_len_max": 20, "env_to_module_sum_episodes_length_in": 10.36823839457432, "num_env_steps_sampled_lifetime": -10487500.0, "env_step_timer": 1.4534103029847505e-05, "num_module_steps_sampled_lifetime": {"default_policy": -10487500.0}, "episode_len_min": 20, "episode_return_mean": 6.74, "num_env_steps_sampled_lifetime_throughput": 3575.548667908118}, "learners": {"default_policy": {"vf_loss": 0.10278083384037018, "num_module_steps_trained": 6000, "entropy": 0.41222673654556274, "gradients_default_optimizer_global_norm": 0.13775816559791565, "curr_kl_coeff": 1.423828734914423e-06, "vf_loss_unclipped": 27.868133544921875, "diff_num_grad_updates_vs_sampler_policy": 1.0, "vf_explained_var": 0.007687926292419434, "default_optimizer_learning_rate": 0.0002847858517, "total_loss": 0.005777741316705942, "num_module_steps_trained_lifetime": 114000, "num_trainable_parameters": 6003, "module_train_batch_size_mean": 1000.0, "curr_entropy_coeff": 0.0090570820258, "mean_kl_loss": 0.000583978951908648, "weights_seq_no": 19.0, "policy_loss": -0.059229280799627304, "num_module_steps_trained_lifetime_throughput": 422781.8711807428}, "__all_modules__": {"num_non_trainable_parameters": 0, "num_module_steps_trained_lifetime": 114000, "num_trainable_parameters": 6003, "learner_connector": {"connector_pipeline_timer": 0.08718966853905606, "timers": {"connectors": {"add_columns_from_episodes_to_train_batch": 0.034102013313280555, "add_time_dim_to_batch_and_zero_pad": 1.2256825762421192e-05, "add_observations_from_episodes_to_batch": 0.0008158671302551056, "batch_individual_items": 0.03644416484065067, "add_one_ts_to_episodes_and_truncate": 0.00834249267457967, "general_advantage_estimation": 0.00729558410204771, "numpy_to_tensor": 5.996713822630459e-05, "add_states_from_episodes_to_batch": 3.2841249498618833e-06}}}, "num_env_steps_trained_lifetime": 598500, "learner_connector_sum_episodes_length_out": 5250.0, "num_module_steps_trained": 6000, "learner_connector_sum_episodes_length_in": 5000.0, "num_env_steps_trained": 31500, "num_env_steps_trained_lifetime_throughput": 2213207.854193595, "num_module_steps_trained_throughput": 422807.96282455145, "num_module_steps_trained_lifetime_throughput": 422281.7315506042}}, "num_training_step_calls_per_iteration": 1, "evaluation": {"env_runners": {"num_episodes": 20, "episode_return_max": 14.5, "agent_episode_returns_mean": {"default_agent": -0.4}, "env_to_module_connector": {"timers": {"connectors": {"numpy_to_tensor": 8.093294054647089e-06, "add_states_from_episodes_to_batch": 1.5396477697069324e-06, "add_time_dim_to_batch_and_zero_pad": 2.116461051723844e-06, "add_observations_from_episodes_to_batch": 2.8493460601554943e-06, "batch_individual_items": 6.0824083345654745e-06}}, "connector_pipeline_timer": 4.2123810148717985e-05}, "module_episode_returns_mean": {"default_policy": -0.4}, "num_env_steps_sampled": 400, "module_to_env_connector": {"timers": {"connectors": {"remove_single_ts_time_rank_from_batch": 5.661472662556746e-07, "un_batch_to_individual_items": 5.337874814244206e-06, "tensor_to_numpy": 1.2537543204565146e-05, "normalize_and_clip_actions": 9.232490257440041e-06, "listify_data_for_vector_env": 1.0882880331306501e-05, "get_actions": 3.4846610008198086e-05}}, "connector_pipeline_timer": 9.884827714059814e-05}, "num_module_steps_sampled": {"default_policy": 400}, "episode_len_mean": 20.0, "episode_len_min": 20, "rlmodule_inference_timer": 2.6000619420140327e-05, "episode_duration_sec_mean": 0.005113886251347139, "sample": 0.10130548240895243, "num_agent_steps_sampled": {"default_agent": 400}, "env_to_module_sum_episodes_length_out": 10.368238394574323, "num_episodes_lifetime": 380, "episode_len_max": 20, "env_step_timer": 1.3803626431197838e-05, "episode_return_mean": -0.4, "env_reset_timer": 0.0004651698562915927, "episode_return_min": -13.5, "num_agent_steps_sampled_lifetime": {"default_agent": 7600}, "env_to_module_sum_episodes_length_in": 10.368238394574323, "num_env_steps_sampled_lifetime": 95400, "weights_seq_no": 19.0, "num_module_steps_sampled_lifetime": {"default_policy": 7600}, "time_between_sampling": 1.5943834329895004}, "num_healthy_workers": 1, "actor_manager_num_outstanding_async_reqs": 0, "num_remote_worker_restarts": 0}, "num_env_steps_sampled_lifetime": -10487500.0, "fault_tolerance": {"num_healthy_workers": 0, "num_remote_worker_restarts": 0}, "env_runner_group": {"actor_manager_num_outstanding_async_reqs": 0}, "done": false, "training_iteration": 19, "trial_id": "43ce3_00000", "date": "2025-08-11_19-23-30", "timestamp": 1754933010, "time_this_iter_s": 1.7365381717681885, "time_total_s": 32.055033922195435, "pid": 14399, "hostname": "Mac", "node_ip": "127.0.0.1", "config": {"exploration_config": {}, "extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "placement_strategy": "PACK", "num_gpus": 0, "_fake_gpus": false, "num_cpus_for_main_process": 2, "eager_tracing": true, "eager_max_retraces": 20, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "torch_compile_learner": false, "torch_compile_learner_what_to_compile": "forward_train", "torch_compile_learner_dynamo_backend": "aot_eager", "torch_compile_learner_dynamo_mode": null, "torch_compile_worker": false, "torch_compile_worker_dynamo_backend": "aot_eager", "torch_compile_worker_dynamo_mode": null, "torch_ddp_kwargs": {}, "torch_skip_nan_gradients": false, "env": "Umbrella", "env_config": {}, "observation_space": null, "action_space": null, "clip_rewards": null, "normalize_actions": true, "clip_actions": false, "_is_atari": null, "disable_env_checking": false, "render_env": false, "action_mask_key": "action_mask", "env_runner_cls": null, "num_env_runners": 0, "create_local_env_runner": true, "num_envs_per_env_runner": 1, "gym_env_vectorize_mode": "SYNC", "num_cpus_per_env_runner": 1, "num_gpus_per_env_runner": 0, "custom_resources_per_env_runner": {}, "validate_env_runners_after_construction": true, "episodes_to_numpy": true, "max_requests_in_flight_per_env_runner": 1, "sample_timeout_s": 60.0, "_env_to_module_connector": null, "add_default_connectors_to_env_to_module_pipeline": true, "_module_to_env_connector": null, "add_default_connectors_to_module_to_env_pipeline": true, "merge_env_runner_states": "training_only", "broadcast_env_runner_states": true, "episode_lookback_horizon": 1, "rollout_fragment_length": "auto", "batch_mode": "complete_episodes", "compress_observations": false, "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "enable_tf1_exec_eagerly": false, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "preprocessor_pref": "deepmind", "observation_filter": "NoFilter", "update_worker_filter_stats": true, "use_worker_filter_stats": true, "sampler_perf_stats_ema_coef": null, "_is_online": true, "num_learners": 0, "num_gpus_per_learner": 0, "num_cpus_per_learner": "auto", "num_aggregator_actors_per_learner": 0, "max_requests_in_flight_per_aggregator_actor": 3, "local_gpu_idx": 0, "max_requests_in_flight_per_learner": 3, "gamma": 1, "lr": 0.0002847858517, "grad_clip": 0.5, "grad_clip_by": "global_norm", "_train_batch_size_per_learner": 5000, "train_batch_size": 4000, "num_epochs": 1, "minibatch_size": 1000, "shuffle_batch_per_epoch": true, "model": {"fcnet_hiddens": [256, 256], "fcnet_activation": "tanh", "fcnet_weights_initializer": null, "fcnet_weights_initializer_config": null, "fcnet_bias_initializer": null, "fcnet_bias_initializer_config": null, "conv_filters": null, "conv_activation": "relu", "conv_kernel_initializer": null, "conv_kernel_initializer_config": null, "conv_bias_initializer": null, "conv_bias_initializer_config": null, "conv_transpose_kernel_initializer": null, "conv_transpose_kernel_initializer_config": null, "conv_transpose_bias_initializer": null, "conv_transpose_bias_initializer_config": null, "post_fcnet_hiddens": [], "post_fcnet_activation": "relu", "post_fcnet_weights_initializer": null, "post_fcnet_weights_initializer_config": null, "post_fcnet_bias_initializer": null, "post_fcnet_bias_initializer_config": null, "free_log_std": false, "log_std_clip_param": 20.0, "no_final_linear": false, "vf_share_layers": false, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "lstm_weights_initializer": null, "lstm_weights_initializer_config": null, "lstm_bias_initializer": null, "lstm_bias_initializer_config": null, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "attention_use_n_prev_actions": 0, "attention_use_n_prev_rewards": 0, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": null, "custom_model_config": {}, "custom_action_dist": null, "custom_preprocessor": null, "encoder_latent_dim": null, "always_check_shapes": false, "lstm_use_prev_action_reward": -1, "_use_default_native_models": -1, "_disable_preprocessor_api": false, "_disable_action_flattening": false}, "_learner_connector": null, "add_default_connectors_to_learner_pipeline": true, "learner_config_dict": {}, "optimizer": {}, "_learner_class": null, "callbacks_on_algorithm_init": null, "callbacks_on_env_runners_recreated": null, "callbacks_on_offline_eval_runners_recreated": null, "callbacks_on_checkpoint_loaded": null, "callbacks_on_environment_created": null, "callbacks_on_episode_created": null, "callbacks_on_episode_start": null, "callbacks_on_episode_step": null, "callbacks_on_episode_end": null, "callbacks_on_evaluate_start": null, "callbacks_on_evaluate_end": null, "callbacks_on_evaluate_offline_start": null, "callbacks_on_evaluate_offline_end": null, "callbacks_on_sample_end": null, "callbacks_on_train_result": null, "explore": true, "enable_rl_module_and_learner": true, "enable_env_runner_and_connector_v2": true, "_prior_exploration_config": {"type": "StochasticSampling"}, "count_steps_by": "env_steps", "policy_map_capacity": 100, "policy_mapping_fn": "<function AlgorithmConfig.DEFAULT_POLICY_MAPPING_FN at 0x388aedb20>", "policies_to_train": null, "policy_states_are_swappable": false, "observation_fn": null, "offline_data_class": null, "input_read_method": "read_parquet", "input_read_method_kwargs": {}, "input_read_schema": {}, "input_read_episodes": false, "input_read_sample_batches": false, "input_read_batch_size": null, "input_filesystem": null, "input_filesystem_kwargs": {}, "input_compress_columns": ["obs", "new_obs"], "input_spaces_jsonable": true, "materialize_data": false, "materialize_mapped_data": true, "map_batches_kwargs": {}, "iter_batches_kwargs": {}, "ignore_final_observation": false, "prelearner_class": null, "prelearner_buffer_class": null, "prelearner_buffer_kwargs": {}, "prelearner_module_synch_period": 10, "dataset_num_iters_per_learner": null, "input_config": {}, "actions_in_input_normalized": false, "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_config": {}, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "output_max_rows_per_file": null, "output_write_remaining_data": false, "output_write_method": "write_parquet", "output_write_method_kwargs": {}, "output_filesystem": null, "output_filesystem_kwargs": {}, "output_write_episodes": true, "offline_sampling": false, "evaluation_interval": 1, "evaluation_duration": 20, "evaluation_duration_unit": "episodes", "evaluation_sample_timeout_s": 120.0, "evaluation_auto_duration_min_env_steps_per_sample": 100, "evaluation_auto_duration_max_env_steps_per_sample": 2000, "evaluation_parallel_to_training": false, "evaluation_force_reset_envs_before_iteration": true, "evaluation_config": null, "off_policy_estimation_methods": {}, "ope_split_batch_by_episode": true, "evaluation_num_env_runners": 1, "in_evaluation": false, "sync_filters_on_rollout_workers_timeout_s": 10.0, "offline_evaluation_interval": null, "num_offline_eval_runners": 0, "offline_loss_for_module_fn": null, "offline_evaluation_duration": 1, "offline_evaluation_parallel_to_training": false, "offline_evaluation_timeout_s": 120.0, "num_cpus_per_offline_eval_runner": 1, "num_gpus_per_offline_eval_runner": 0, "custom_resources_per_offline_eval_runner": {}, "restart_failed_offline_eval_runners": true, "ignore_offline_eval_runner_failures": false, "max_num_offline_eval_runner_restarts": 1000, "offline_eval_runner_restore_timeout_s": 1800.0, "max_requests_in_flight_per_offline_eval_runner": 1, "validate_offline_eval_runners_after_construction": true, "offline_eval_runner_health_probe_timeout_s": 30.0, "offline_eval_rl_module_inference_only": false, "broadcast_offline_eval_runner_states": false, "offline_eval_batch_size_per_runner": 256, "dataset_num_iters_per_eval_runner": 1, "keep_per_episode_custom_metrics": false, "metrics_episode_collection_timeout_s": 60.0, "metrics_num_episodes_for_smoothing": 100, "min_time_s_per_iteration": null, "min_train_timesteps_per_iteration": 0, "min_sample_timesteps_per_iteration": 0, "log_gradients": true, "export_native_model_files": false, "checkpoint_trainable_policies_only": false, "logger_creator": null, "logger_config": null, "log_level": "WARN", "log_sys_usage": true, "fake_sampler": false, "seed": 2, "restart_failed_env_runners": true, "ignore_env_runner_failures": false, "max_num_env_runner_restarts": 1000, "delay_between_env_runner_restarts_s": 60.0, "restart_failed_sub_environments": false, "num_consecutive_env_runner_failures_tolerance": 100, "env_runner_health_probe_timeout_s": 30.0, "env_runner_restore_timeout_s": 1800.0, "_model_config": {}, "_rl_module_spec": "RLModuleSpec(module_class=None, observation_space=None, action_space=None, inference_only=False, learner_only=False, model_config=DefaultModelConfig(fcnet_hiddens=[60, 90], fcnet_activation='tanh', fcnet_kernel_initializer=None, fcnet_kernel_initializer_kwargs=None, fcnet_bias_initializer=None, fcnet_bias_initializer_kwargs=None, conv_filters=None, conv_activation='relu', conv_kernel_initializer=None, conv_kernel_initializer_kwargs=None, conv_bias_initializer=None, conv_bias_initializer_kwargs=None, head_fcnet_hiddens=[], head_fcnet_activation='relu', head_fcnet_kernel_initializer=None, head_fcnet_kernel_initializer_kwargs=None, head_fcnet_bias_initializer=None, head_fcnet_bias_initializer_kwargs=None, free_log_std=False, log_std_clip_param=20.0, vf_share_layers=True, use_lstm=False, max_seq_len=20, lstm_cell_size=256, lstm_use_prev_action=False, lstm_use_prev_reward=False, lstm_kernel_initializer=None, lstm_kernel_initializer_kwargs=None, lstm_bias_initializer=None, lstm_bias_initializer_kwargs=None), catalog_class=None, load_state_path=None, model_config_dict=None)", "algorithm_config_overrides_per_module": {}, "_per_module_overrides": {}, "_validate_config": true, "_use_msgpack_checkpoints": false, "_torch_grad_scaler_class": null, "_torch_lr_scheduler_classes": null, "_tf_policy_handles_more_than_one_loss": false, "_disable_preprocessor_api": false, "_disable_action_flattening": false, "_disable_initialize_loss_from_dummy_batch": false, "_dont_auto_sync_env_runner_states": false, "env_task_fn": -1, "enable_connectors": -1, "simple_optimizer": false, "policy_map_cache": -1, "worker_cls": -1, "synchronize_filters": -1, "enable_async_evaluation": -1, "custom_async_evaluation_function": -1, "_enable_rl_module_api": -1, "auto_wrap_old_gym_envs": -1, "always_attach_evaluation_results": -1, "replay_sequence_length": null, "_disable_execution_plan_api": -1, "use_critic": true, "use_gae": true, "use_kl_loss": true, "kl_coeff": 0.7464963036515, "kl_target": 0.0270990929592, "vf_loss_coeff": 0.6688075857018, "entropy_coeff": 0.0090570820258, "clip_param": 0.1221781641624, "vf_clip_param": 0.1027808522125, "entropy_coeff_schedule": null, "lr_schedule": null, "sgd_minibatch_size": -1, "vf_share_layers": -1, "__stdout_file__": null, "__stderr_file__": null, "lambda": 0.9099046732075, "input": "sampler", "policies": {"default_policy": [null, null, null, null]}, "callbacks": "<class 'ray.rllib.callbacks.callbacks.RLlibCallback'>", "create_env_on_driver": false, "custom_eval_function": null, "framework": "torch"}, "time_since_restore": 32.055033922195435, "iterations_since_restore": 19, "perf": {"cpu_util_percent": 50.400000000000006, "ram_util_percent": 78.25}}
{"timers": {"training_iteration": 1.598857733836746, "restore_env_runners": 9.181621558357552e-06, "training_step": 1.5987199935701728, "env_runner_sampling_timer": 1.48501432612297, "learner_update_timer": 0.11074149076841552, "synch_weights": 0.0005617437327086919, "restore_eval_env_runners": 8.312541709415665e-06, "evaluation_iteration": 0.11349135216588671, "synch_eval_env_connectors": 0.00011210100776077288, "synch_env_connectors": 4.625481631277745e-06}, "env_runners": {"weights_seq_no": 19.0, "num_agent_steps_sampled": {"default_agent": 5000.0}, "env_to_module_connector": {"timers": {"connectors": {"numpy_to_tensor": 8.554686389620846e-06, "add_states_from_episodes_to_batch": 1.7308926666308721e-06, "batch_individual_items": 6.144697262108657e-06, "add_time_dim_to_batch_and_zero_pad": 2.348807712835745e-06, "add_observations_from_episodes_to_batch": 2.9389282234288095e-06}}, "connector_pipeline_timer": 4.363286426294277e-05}, "module_to_env_connector": {"timers": {"connectors": {"listify_data_for_vector_env": 1.10099467810039e-05, "tensor_to_numpy": 1.3127162346504256e-05, "remove_single_ts_time_rank_from_batch": 5.786256697552359e-07, "un_batch_to_individual_items": 5.308741773907548e-06, "get_actions": 3.8822096349800414e-05, "normalize_and_clip_actions": 9.355554951088194e-06}}, "connector_pipeline_timer": 0.00010416085746040097}, "agent_episode_returns_mean": {"default_agent": 6.5}, "rlmodule_inference_timer": 2.739947606539748e-05, "module_episode_returns_mean": {"default_policy": 6.5}, "num_episodes": 250.0, "episode_duration_sec_mean": 0.004545364998746663, "env_reset_timer": 3.6884257039979526e-05, "num_agent_steps_sampled_lifetime": {"default_agent": -11105000.0}, "episode_return_max": 8.5, "sample": 0.004993916347665065, "num_module_steps_sampled": {"default_policy": 5000.0}, "num_env_steps_sampled": 5000.0, "episode_return_min": -11.5, "env_to_module_sum_episodes_length_out": 10.36823839457432, "num_episodes_lifetime": -555250.0, "episode_len_mean": 20.0, "time_between_sampling": 0.0018487908064844297, "episode_len_max": 20, "env_to_module_sum_episodes_length_in": 10.36823839457432, "num_env_steps_sampled_lifetime": -11105000.0, "env_step_timer": 1.368336814528111e-05, "num_module_steps_sampled_lifetime": {"default_policy": -11105000.0}, "episode_len_min": 20, "episode_return_mean": 6.5, "num_env_steps_sampled_lifetime_throughput": 3716.509044199805}, "learners": {"default_policy": {"vf_loss": 0.10278083384037018, "num_module_steps_trained": 6000, "entropy": 0.37009090185165405, "gradients_default_optimizer_global_norm": 0.04194527864456177, "curr_kl_coeff": 7.119143674572115e-07, "vf_loss_unclipped": 27.988771438598633, "diff_num_grad_updates_vs_sampler_policy": 1.0, "vf_explained_var": 0.004387497901916504, "default_optimizer_learning_rate": 0.0002847858517, "total_loss": 0.03251373767852783, "num_module_steps_trained_lifetime": 120000, "num_trainable_parameters": 6003, "module_train_batch_size_mean": 1000.0, "curr_entropy_coeff": 0.0090570820258, "mean_kl_loss": 0.001483448431827128, "weights_seq_no": 20.0, "policy_loss": -0.0328749418258667, "num_module_steps_trained_lifetime_throughput": 421404.96875079325}, "__all_modules__": {"num_non_trainable_parameters": 0, "num_module_steps_trained_lifetime": 120000, "num_trainable_parameters": 6003, "learner_connector": {"connector_pipeline_timer": 0.0871005510236329, "timers": {"connectors": {"add_columns_from_episodes_to_train_batch": 0.03409809901011493, "add_time_dim_to_batch_and_zero_pad": 1.2222177848300336e-05, "add_observations_from_episodes_to_batch": 0.0008159888793955976, "batch_individual_items": 0.036387579853046075, "add_one_ts_to_episodes_and_truncate": 0.008334302747946899, "general_advantage_estimation": 0.007275456180162103, "numpy_to_tensor": 5.987663602957566e-05, "add_states_from_episodes_to_batch": 3.281704188109861e-06}}}, "num_env_steps_trained_lifetime": 630000, "learner_connector_sum_episodes_length_out": 5250.0, "num_module_steps_trained": 6000, "learner_connector_sum_episodes_length_in": 5000.0, "num_env_steps_trained": 31500, "num_env_steps_trained_lifetime_throughput": 2206331.0754387244, "num_module_steps_trained_throughput": 421459.81514425756, "num_module_steps_trained_lifetime_throughput": 420945.3717381698}}, "num_training_step_calls_per_iteration": 1, "evaluation": {"env_runners": {"num_episodes": 20, "episode_return_max": 14.5, "agent_episode_returns_mean": {"default_agent": 0.2}, "env_to_module_connector": {"timers": {"connectors": {"numpy_to_tensor": 8.13533941648778e-06, "add_states_from_episodes_to_batch": 1.5476536407165678e-06, "add_time_dim_to_batch_and_zero_pad": 2.117581236108339e-06, "add_observations_from_episodes_to_batch": 2.768181960460914e-06, "batch_individual_items": 6.06507723000421e-06}}, "connector_pipeline_timer": 4.1818267603718216e-05}, "module_episode_returns_mean": {"default_policy": 0.2}, "num_env_steps_sampled": 400, "module_to_env_connector": {"timers": {"connectors": {"remove_single_ts_time_rank_from_batch": 6.082404302699474e-07, "un_batch_to_individual_items": 5.2429231974666216e-06, "tensor_to_numpy": 1.2493530810407782e-05, "normalize_and_clip_actions": 9.377646619710757e-06, "listify_data_for_vector_env": 1.0740325804480715e-05, "get_actions": 3.4783709434515794e-05}}, "connector_pipeline_timer": 9.846267004251889e-05}, "num_module_steps_sampled": {"default_policy": 400}, "episode_len_mean": 20.0, "episode_len_min": 20, "rlmodule_inference_timer": 2.592849239288996e-05, "episode_duration_sec_mean": 0.005115986248711124, "sample": 0.10124742716514375, "num_agent_steps_sampled": {"default_agent": 400}, "env_to_module_sum_episodes_length_out": 10.368238394574323, "num_episodes_lifetime": 400, "episode_len_max": 20, "env_step_timer": 1.3682029794221871e-05, "episode_return_mean": 0.2, "env_reset_timer": 0.00046134607788613906, "episode_return_min": -13.5, "num_agent_steps_sampled_lifetime": {"default_agent": 8000}, "env_to_module_sum_episodes_length_in": 10.368238394574323, "num_env_steps_sampled_lifetime": 100400, "weights_seq_no": 20.0, "num_module_steps_sampled_lifetime": {"default_policy": 8000}, "time_between_sampling": 1.5933574640691213}, "num_healthy_workers": 1, "actor_manager_num_outstanding_async_reqs": 0, "num_remote_worker_restarts": 0}, "num_env_steps_sampled_lifetime": -11105000.0, "fault_tolerance": {"num_healthy_workers": 0, "num_remote_worker_restarts": 0}, "env_runner_group": {"actor_manager_num_outstanding_async_reqs": 0}, "done": true, "training_iteration": 20, "trial_id": "43ce3_00000", "date": "2025-08-11_19-23-31", "timestamp": 1754933011, "time_this_iter_s": 1.5776851177215576, "time_total_s": 33.63271903991699, "pid": 14399, "hostname": "Mac", "node_ip": "127.0.0.1", "config": {"exploration_config": {}, "extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "placement_strategy": "PACK", "num_gpus": 0, "_fake_gpus": false, "num_cpus_for_main_process": 2, "eager_tracing": true, "eager_max_retraces": 20, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "torch_compile_learner": false, "torch_compile_learner_what_to_compile": "forward_train", "torch_compile_learner_dynamo_backend": "aot_eager", "torch_compile_learner_dynamo_mode": null, "torch_compile_worker": false, "torch_compile_worker_dynamo_backend": "aot_eager", "torch_compile_worker_dynamo_mode": null, "torch_ddp_kwargs": {}, "torch_skip_nan_gradients": false, "env": "Umbrella", "env_config": {}, "observation_space": null, "action_space": null, "clip_rewards": null, "normalize_actions": true, "clip_actions": false, "_is_atari": null, "disable_env_checking": false, "render_env": false, "action_mask_key": "action_mask", "env_runner_cls": null, "num_env_runners": 0, "create_local_env_runner": true, "num_envs_per_env_runner": 1, "gym_env_vectorize_mode": "SYNC", "num_cpus_per_env_runner": 1, "num_gpus_per_env_runner": 0, "custom_resources_per_env_runner": {}, "validate_env_runners_after_construction": true, "episodes_to_numpy": true, "max_requests_in_flight_per_env_runner": 1, "sample_timeout_s": 60.0, "_env_to_module_connector": null, "add_default_connectors_to_env_to_module_pipeline": true, "_module_to_env_connector": null, "add_default_connectors_to_module_to_env_pipeline": true, "merge_env_runner_states": "training_only", "broadcast_env_runner_states": true, "episode_lookback_horizon": 1, "rollout_fragment_length": "auto", "batch_mode": "complete_episodes", "compress_observations": false, "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "enable_tf1_exec_eagerly": false, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "preprocessor_pref": "deepmind", "observation_filter": "NoFilter", "update_worker_filter_stats": true, "use_worker_filter_stats": true, "sampler_perf_stats_ema_coef": null, "_is_online": true, "num_learners": 0, "num_gpus_per_learner": 0, "num_cpus_per_learner": "auto", "num_aggregator_actors_per_learner": 0, "max_requests_in_flight_per_aggregator_actor": 3, "local_gpu_idx": 0, "max_requests_in_flight_per_learner": 3, "gamma": 1, "lr": 0.0002847858517, "grad_clip": 0.5, "grad_clip_by": "global_norm", "_train_batch_size_per_learner": 5000, "train_batch_size": 4000, "num_epochs": 1, "minibatch_size": 1000, "shuffle_batch_per_epoch": true, "model": {"fcnet_hiddens": [256, 256], "fcnet_activation": "tanh", "fcnet_weights_initializer": null, "fcnet_weights_initializer_config": null, "fcnet_bias_initializer": null, "fcnet_bias_initializer_config": null, "conv_filters": null, "conv_activation": "relu", "conv_kernel_initializer": null, "conv_kernel_initializer_config": null, "conv_bias_initializer": null, "conv_bias_initializer_config": null, "conv_transpose_kernel_initializer": null, "conv_transpose_kernel_initializer_config": null, "conv_transpose_bias_initializer": null, "conv_transpose_bias_initializer_config": null, "post_fcnet_hiddens": [], "post_fcnet_activation": "relu", "post_fcnet_weights_initializer": null, "post_fcnet_weights_initializer_config": null, "post_fcnet_bias_initializer": null, "post_fcnet_bias_initializer_config": null, "free_log_std": false, "log_std_clip_param": 20.0, "no_final_linear": false, "vf_share_layers": false, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "lstm_weights_initializer": null, "lstm_weights_initializer_config": null, "lstm_bias_initializer": null, "lstm_bias_initializer_config": null, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "attention_use_n_prev_actions": 0, "attention_use_n_prev_rewards": 0, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": null, "custom_model_config": {}, "custom_action_dist": null, "custom_preprocessor": null, "encoder_latent_dim": null, "always_check_shapes": false, "lstm_use_prev_action_reward": -1, "_use_default_native_models": -1, "_disable_preprocessor_api": false, "_disable_action_flattening": false}, "_learner_connector": null, "add_default_connectors_to_learner_pipeline": true, "learner_config_dict": {}, "optimizer": {}, "_learner_class": null, "callbacks_on_algorithm_init": null, "callbacks_on_env_runners_recreated": null, "callbacks_on_offline_eval_runners_recreated": null, "callbacks_on_checkpoint_loaded": null, "callbacks_on_environment_created": null, "callbacks_on_episode_created": null, "callbacks_on_episode_start": null, "callbacks_on_episode_step": null, "callbacks_on_episode_end": null, "callbacks_on_evaluate_start": null, "callbacks_on_evaluate_end": null, "callbacks_on_evaluate_offline_start": null, "callbacks_on_evaluate_offline_end": null, "callbacks_on_sample_end": null, "callbacks_on_train_result": null, "explore": true, "enable_rl_module_and_learner": true, "enable_env_runner_and_connector_v2": true, "_prior_exploration_config": {"type": "StochasticSampling"}, "count_steps_by": "env_steps", "policy_map_capacity": 100, "policy_mapping_fn": "<function AlgorithmConfig.DEFAULT_POLICY_MAPPING_FN at 0x388aedb20>", "policies_to_train": null, "policy_states_are_swappable": false, "observation_fn": null, "offline_data_class": null, "input_read_method": "read_parquet", "input_read_method_kwargs": {}, "input_read_schema": {}, "input_read_episodes": false, "input_read_sample_batches": false, "input_read_batch_size": null, "input_filesystem": null, "input_filesystem_kwargs": {}, "input_compress_columns": ["obs", "new_obs"], "input_spaces_jsonable": true, "materialize_data": false, "materialize_mapped_data": true, "map_batches_kwargs": {}, "iter_batches_kwargs": {}, "ignore_final_observation": false, "prelearner_class": null, "prelearner_buffer_class": null, "prelearner_buffer_kwargs": {}, "prelearner_module_synch_period": 10, "dataset_num_iters_per_learner": null, "input_config": {}, "actions_in_input_normalized": false, "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_config": {}, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "output_max_rows_per_file": null, "output_write_remaining_data": false, "output_write_method": "write_parquet", "output_write_method_kwargs": {}, "output_filesystem": null, "output_filesystem_kwargs": {}, "output_write_episodes": true, "offline_sampling": false, "evaluation_interval": 1, "evaluation_duration": 20, "evaluation_duration_unit": "episodes", "evaluation_sample_timeout_s": 120.0, "evaluation_auto_duration_min_env_steps_per_sample": 100, "evaluation_auto_duration_max_env_steps_per_sample": 2000, "evaluation_parallel_to_training": false, "evaluation_force_reset_envs_before_iteration": true, "evaluation_config": null, "off_policy_estimation_methods": {}, "ope_split_batch_by_episode": true, "evaluation_num_env_runners": 1, "in_evaluation": false, "sync_filters_on_rollout_workers_timeout_s": 10.0, "offline_evaluation_interval": null, "num_offline_eval_runners": 0, "offline_loss_for_module_fn": null, "offline_evaluation_duration": 1, "offline_evaluation_parallel_to_training": false, "offline_evaluation_timeout_s": 120.0, "num_cpus_per_offline_eval_runner": 1, "num_gpus_per_offline_eval_runner": 0, "custom_resources_per_offline_eval_runner": {}, "restart_failed_offline_eval_runners": true, "ignore_offline_eval_runner_failures": false, "max_num_offline_eval_runner_restarts": 1000, "offline_eval_runner_restore_timeout_s": 1800.0, "max_requests_in_flight_per_offline_eval_runner": 1, "validate_offline_eval_runners_after_construction": true, "offline_eval_runner_health_probe_timeout_s": 30.0, "offline_eval_rl_module_inference_only": false, "broadcast_offline_eval_runner_states": false, "offline_eval_batch_size_per_runner": 256, "dataset_num_iters_per_eval_runner": 1, "keep_per_episode_custom_metrics": false, "metrics_episode_collection_timeout_s": 60.0, "metrics_num_episodes_for_smoothing": 100, "min_time_s_per_iteration": null, "min_train_timesteps_per_iteration": 0, "min_sample_timesteps_per_iteration": 0, "log_gradients": true, "export_native_model_files": false, "checkpoint_trainable_policies_only": false, "logger_creator": null, "logger_config": null, "log_level": "WARN", "log_sys_usage": true, "fake_sampler": false, "seed": 2, "restart_failed_env_runners": true, "ignore_env_runner_failures": false, "max_num_env_runner_restarts": 1000, "delay_between_env_runner_restarts_s": 60.0, "restart_failed_sub_environments": false, "num_consecutive_env_runner_failures_tolerance": 100, "env_runner_health_probe_timeout_s": 30.0, "env_runner_restore_timeout_s": 1800.0, "_model_config": {}, "_rl_module_spec": "RLModuleSpec(module_class=None, observation_space=None, action_space=None, inference_only=False, learner_only=False, model_config=DefaultModelConfig(fcnet_hiddens=[60, 90], fcnet_activation='tanh', fcnet_kernel_initializer=None, fcnet_kernel_initializer_kwargs=None, fcnet_bias_initializer=None, fcnet_bias_initializer_kwargs=None, conv_filters=None, conv_activation='relu', conv_kernel_initializer=None, conv_kernel_initializer_kwargs=None, conv_bias_initializer=None, conv_bias_initializer_kwargs=None, head_fcnet_hiddens=[], head_fcnet_activation='relu', head_fcnet_kernel_initializer=None, head_fcnet_kernel_initializer_kwargs=None, head_fcnet_bias_initializer=None, head_fcnet_bias_initializer_kwargs=None, free_log_std=False, log_std_clip_param=20.0, vf_share_layers=True, use_lstm=False, max_seq_len=20, lstm_cell_size=256, lstm_use_prev_action=False, lstm_use_prev_reward=False, lstm_kernel_initializer=None, lstm_kernel_initializer_kwargs=None, lstm_bias_initializer=None, lstm_bias_initializer_kwargs=None), catalog_class=None, load_state_path=None, model_config_dict=None)", "algorithm_config_overrides_per_module": {}, "_per_module_overrides": {}, "_validate_config": true, "_use_msgpack_checkpoints": false, "_torch_grad_scaler_class": null, "_torch_lr_scheduler_classes": null, "_tf_policy_handles_more_than_one_loss": false, "_disable_preprocessor_api": false, "_disable_action_flattening": false, "_disable_initialize_loss_from_dummy_batch": false, "_dont_auto_sync_env_runner_states": false, "env_task_fn": -1, "enable_connectors": -1, "simple_optimizer": false, "policy_map_cache": -1, "worker_cls": -1, "synchronize_filters": -1, "enable_async_evaluation": -1, "custom_async_evaluation_function": -1, "_enable_rl_module_api": -1, "auto_wrap_old_gym_envs": -1, "always_attach_evaluation_results": -1, "replay_sequence_length": null, "_disable_execution_plan_api": -1, "use_critic": true, "use_gae": true, "use_kl_loss": true, "kl_coeff": 0.7464963036515, "kl_target": 0.0270990929592, "vf_loss_coeff": 0.6688075857018, "entropy_coeff": 0.0090570820258, "clip_param": 0.1221781641624, "vf_clip_param": 0.1027808522125, "entropy_coeff_schedule": null, "lr_schedule": null, "sgd_minibatch_size": -1, "vf_share_layers": -1, "__stdout_file__": null, "__stderr_file__": null, "lambda": 0.9099046732075, "input": "sampler", "policies": {"default_policy": [null, null, null, null]}, "callbacks": "<class 'ray.rllib.callbacks.callbacks.RLlibCallback'>", "create_env_on_driver": false, "custom_eval_function": null, "framework": "torch"}, "time_since_restore": 33.63271903991699, "iterations_since_restore": 20, "perf": {"cpu_util_percent": 20.6, "ram_util_percent": 78.1}}
