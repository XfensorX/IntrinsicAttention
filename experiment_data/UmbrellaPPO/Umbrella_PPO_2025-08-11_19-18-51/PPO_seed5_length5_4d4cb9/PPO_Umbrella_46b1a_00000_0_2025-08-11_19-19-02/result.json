{"timers": {"training_iteration": 2.5234907920239493, "restore_env_runners": 1.333397813141346e-05, "training_step": 2.5233460830058903, "env_runner_sampling_timer": 2.3670249169226736, "learner_update_timer": 0.1530454580206424, "synch_weights": 0.0006358750397339463}, "env_runners": {"weights_seq_no": 0.0, "episode_return_max": 6.5, "num_episodes": 250.0, "module_to_env_connector": {"timers": {"connectors": {"tensor_to_numpy": 2.2105070966780388e-05, "remove_single_ts_time_rank_from_batch": 8.912661809591829e-07, "listify_data_for_vector_env": 1.7914886924825993e-05, "get_actions": 7.678513268386314e-05, "normalize_and_clip_actions": 1.7975106945250175e-05, "un_batch_to_individual_items": 8.796125606812664e-06}}, "connector_pipeline_timer": 0.00018381960746642303}, "env_to_module_connector": {"timers": {"connectors": {"batch_individual_items": 1.0398189096668988e-05, "add_time_dim_to_batch_and_zero_pad": 3.769393723080069e-06, "numpy_to_tensor": 1.54911825292204e-05, "add_observations_from_episodes_to_batch": 4.5836429281659536e-06, "add_states_from_episodes_to_batch": 2.5126627255649645e-06}}, "connector_pipeline_timer": 7.045099573923594e-05}, "agent_episode_returns_mean": {"default_agent": -3.7400000000000015}, "env_to_module_sum_episodes_length_out": 10.191744832559449, "num_module_steps_sampled": {"default_policy": 5000.0}, "episode_return_min": -13.5, "time_between_sampling": 0.0007467895981772175, "episode_len_min": 20, "episode_len_mean": 20.0, "episode_return_mean": -3.7400000000000015, "episode_len_max": 20, "sample": 0.00875625708810264, "num_env_steps_sampled": 5000.0, "episode_duration_sec_mean": 0.00807943215314299, "env_to_module_sum_episodes_length_in": 10.191744832559449, "env_step_timer": 2.4435308755555034e-05, "num_module_steps_sampled_lifetime": {"default_policy": 627500.0}, "num_episodes_lifetime": 31375.0, "num_env_steps_sampled_lifetime": 627500.0, "num_agent_steps_sampled_lifetime": {"default_agent": 627500.0}, "env_reset_timer": 0.00011457251503846872, "rlmodule_inference_timer": 8.2531140967201e-05, "module_episode_returns_mean": {"default_policy": -3.7400000000000015}, "num_agent_steps_sampled": {"default_agent": 5000.0}, "num_env_steps_sampled_lifetime_throughput": 2351.0676826120107}, "learners": {"default_policy": {"vf_loss_unclipped": 31.674436569213867, "default_optimizer_learning_rate": 0.0002847858517, "module_train_batch_size_mean": 1000.0, "vf_loss": 0.10278083384037018, "entropy": 0.6923456788063049, "total_loss": 0.12488927692174911, "policy_loss": 0.061082545667886734, "vf_explained_var": -0.009245157241821289, "mean_kl_loss": 0.0017906971042975783, "diff_num_grad_updates_vs_sampler_policy": 1.0, "gradients_default_optimizer_global_norm": 0.11001160740852356, "num_module_steps_trained_lifetime": 6000, "curr_entropy_coeff": 0.0090570820258, "num_module_steps_trained": 6000, "num_trainable_parameters": 6003, "curr_kl_coeff": 0.3732481598854065, "weights_seq_no": 1.0, "num_module_steps_trained_lifetime_throughput": 222200.7455209095}, "__all_modules__": {"learner_connector": {"timers": {"connectors": {"add_observations_from_episodes_to_batch": 0.0008414579788222909, "general_advantage_estimation": 0.009866875014267862, "add_one_ts_to_episodes_and_truncate": 0.008154749986715615, "add_columns_from_episodes_to_train_batch": 0.03932483296375722, "numpy_to_tensor": 0.000139000010676682, "add_states_from_episodes_to_batch": 3.500026650726795e-06, "batch_individual_items": 0.04832170903682709, "add_time_dim_to_batch_and_zero_pad": 1.2333039194345474e-05}}, "connector_pipeline_timer": 0.10689154197461903}, "num_env_steps_trained": 31500, "num_env_steps_trained_lifetime": 31500, "num_module_steps_trained_lifetime": 6000, "learner_connector_sum_episodes_length_in": 5000, "num_trainable_parameters": 6003, "learner_connector_sum_episodes_length_out": 5250, "num_module_steps_trained": 6000, "num_non_trainable_parameters": 0, "num_env_steps_trained_lifetime_throughput": 1161780.772289146, "num_module_steps_trained_throughput": 221920.3871973947, "num_module_steps_trained_lifetime_throughput": 221708.74390063068}}, "num_training_step_calls_per_iteration": 1, "num_env_steps_sampled_lifetime": 627500.0, "evaluation": {"env_runners": {"module_to_env_connector": {"connector_pipeline_timer": 0.00015568498302936682, "timers": {"connectors": {"remove_single_ts_time_rank_from_batch": 7.572943781839934e-07, "listify_data_for_vector_env": 1.6235855307764646e-05, "normalize_and_clip_actions": 1.3635649682041555e-05, "get_actions": 6.112720596398274e-05, "tensor_to_numpy": 2.1388164344504937e-05, "un_batch_to_individual_items": 7.814172887799647e-06}}}, "num_episodes_lifetime": 20, "weights_seq_no": 1.0, "episode_return_max": 12.5, "num_env_steps_sampled": 400, "env_to_module_sum_episodes_length_in": 10.216013141322508, "env_to_module_connector": {"timers": {"connectors": {"add_observations_from_episodes_to_batch": 3.911928680234194e-06, "numpy_to_tensor": 1.3121152840185041e-05, "add_states_from_episodes_to_batch": 1.9758644541139404e-06, "batch_individual_items": 8.873431541581857e-06, "add_time_dim_to_batch_and_zero_pad": 3.2614680496790503e-06}}, "connector_pipeline_timer": 5.9716099214909355e-05}, "env_to_module_sum_episodes_length_out": 10.216013141322508, "episode_len_max": 20, "episode_duration_sec_mean": 0.00757245413842611, "env_step_timer": 2.1889686834834853e-05, "num_env_steps_sampled_lifetime": 5400, "rlmodule_inference_timer": 4.3041891378823736e-05, "num_module_steps_sampled_lifetime": {"default_policy": 400}, "num_agent_steps_sampled_lifetime": {"default_agent": 400}, "num_agent_steps_sampled": {"default_agent": 400}, "episode_len_mean": 20.0, "episode_return_mean": -0.3, "agent_episode_returns_mean": {"default_agent": -0.3}, "num_module_steps_sampled": {"default_policy": 400}, "env_reset_timer": 0.00014820799697190523, "num_episodes": 20, "episode_return_min": -15.5, "module_episode_returns_mean": {"default_policy": -0.3}, "episode_len_min": 20, "sample": 0.16518445906694978}, "num_healthy_workers": 1, "actor_manager_num_outstanding_async_reqs": 0, "num_remote_worker_restarts": 0}, "fault_tolerance": {"num_healthy_workers": 0, "num_remote_worker_restarts": 0}, "env_runner_group": {"actor_manager_num_outstanding_async_reqs": 0}, "done": false, "training_iteration": 1, "trial_id": "46b1a_00000", "date": "2025-08-11_19-34-14", "timestamp": 1754933654, "time_this_iter_s": 2.697603225708008, "time_total_s": 2.697603225708008, "pid": 26849, "hostname": "Mac", "node_ip": "127.0.0.1", "config": {"exploration_config": {}, "extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "placement_strategy": "PACK", "num_gpus": 0, "_fake_gpus": false, "num_cpus_for_main_process": 2, "eager_tracing": true, "eager_max_retraces": 20, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "torch_compile_learner": false, "torch_compile_learner_what_to_compile": "forward_train", "torch_compile_learner_dynamo_backend": "aot_eager", "torch_compile_learner_dynamo_mode": null, "torch_compile_worker": false, "torch_compile_worker_dynamo_backend": "aot_eager", "torch_compile_worker_dynamo_mode": null, "torch_ddp_kwargs": {}, "torch_skip_nan_gradients": false, "env": "Umbrella", "env_config": {}, "observation_space": null, "action_space": null, "clip_rewards": null, "normalize_actions": true, "clip_actions": false, "_is_atari": null, "disable_env_checking": false, "render_env": false, "action_mask_key": "action_mask", "env_runner_cls": null, "num_env_runners": 0, "create_local_env_runner": true, "num_envs_per_env_runner": 1, "gym_env_vectorize_mode": "SYNC", "num_cpus_per_env_runner": 1, "num_gpus_per_env_runner": 0, "custom_resources_per_env_runner": {}, "validate_env_runners_after_construction": true, "episodes_to_numpy": true, "max_requests_in_flight_per_env_runner": 1, "sample_timeout_s": 60.0, "_env_to_module_connector": null, "add_default_connectors_to_env_to_module_pipeline": true, "_module_to_env_connector": null, "add_default_connectors_to_module_to_env_pipeline": true, "merge_env_runner_states": "training_only", "broadcast_env_runner_states": true, "episode_lookback_horizon": 1, "rollout_fragment_length": "auto", "batch_mode": "complete_episodes", "compress_observations": false, "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "enable_tf1_exec_eagerly": false, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "preprocessor_pref": "deepmind", "observation_filter": "NoFilter", "update_worker_filter_stats": true, "use_worker_filter_stats": true, "sampler_perf_stats_ema_coef": null, "_is_online": true, "num_learners": 0, "num_gpus_per_learner": 0, "num_cpus_per_learner": "auto", "num_aggregator_actors_per_learner": 0, "max_requests_in_flight_per_aggregator_actor": 3, "local_gpu_idx": 0, "max_requests_in_flight_per_learner": 3, "gamma": 1, "lr": 0.0002847858517, "grad_clip": 0.5, "grad_clip_by": "global_norm", "_train_batch_size_per_learner": 5000, "train_batch_size": 4000, "num_epochs": 1, "minibatch_size": 1000, "shuffle_batch_per_epoch": true, "model": {"fcnet_hiddens": [256, 256], "fcnet_activation": "tanh", "fcnet_weights_initializer": null, "fcnet_weights_initializer_config": null, "fcnet_bias_initializer": null, "fcnet_bias_initializer_config": null, "conv_filters": null, "conv_activation": "relu", "conv_kernel_initializer": null, "conv_kernel_initializer_config": null, "conv_bias_initializer": null, "conv_bias_initializer_config": null, "conv_transpose_kernel_initializer": null, "conv_transpose_kernel_initializer_config": null, "conv_transpose_bias_initializer": null, "conv_transpose_bias_initializer_config": null, "post_fcnet_hiddens": [], "post_fcnet_activation": "relu", "post_fcnet_weights_initializer": null, "post_fcnet_weights_initializer_config": null, "post_fcnet_bias_initializer": null, "post_fcnet_bias_initializer_config": null, "free_log_std": false, "log_std_clip_param": 20.0, "no_final_linear": false, "vf_share_layers": false, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "lstm_weights_initializer": null, "lstm_weights_initializer_config": null, "lstm_bias_initializer": null, "lstm_bias_initializer_config": null, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "attention_use_n_prev_actions": 0, "attention_use_n_prev_rewards": 0, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": null, "custom_model_config": {}, "custom_action_dist": null, "custom_preprocessor": null, "encoder_latent_dim": null, "always_check_shapes": false, "lstm_use_prev_action_reward": -1, "_use_default_native_models": -1, "_disable_preprocessor_api": false, "_disable_action_flattening": false}, "_learner_connector": null, "add_default_connectors_to_learner_pipeline": true, "learner_config_dict": {}, "optimizer": {}, "_learner_class": null, "callbacks_on_algorithm_init": null, "callbacks_on_env_runners_recreated": null, "callbacks_on_offline_eval_runners_recreated": null, "callbacks_on_checkpoint_loaded": null, "callbacks_on_environment_created": null, "callbacks_on_episode_created": null, "callbacks_on_episode_start": null, "callbacks_on_episode_step": null, "callbacks_on_episode_end": null, "callbacks_on_evaluate_start": null, "callbacks_on_evaluate_end": null, "callbacks_on_evaluate_offline_start": null, "callbacks_on_evaluate_offline_end": null, "callbacks_on_sample_end": null, "callbacks_on_train_result": null, "explore": true, "enable_rl_module_and_learner": true, "enable_env_runner_and_connector_v2": true, "_prior_exploration_config": {"type": "StochasticSampling"}, "count_steps_by": "env_steps", "policy_map_capacity": 100, "policy_mapping_fn": "<function AlgorithmConfig.DEFAULT_POLICY_MAPPING_FN at 0x13bfddb20>", "policies_to_train": null, "policy_states_are_swappable": false, "observation_fn": null, "offline_data_class": null, "input_read_method": "read_parquet", "input_read_method_kwargs": {}, "input_read_schema": {}, "input_read_episodes": false, "input_read_sample_batches": false, "input_read_batch_size": null, "input_filesystem": null, "input_filesystem_kwargs": {}, "input_compress_columns": ["obs", "new_obs"], "input_spaces_jsonable": true, "materialize_data": false, "materialize_mapped_data": true, "map_batches_kwargs": {}, "iter_batches_kwargs": {}, "ignore_final_observation": false, "prelearner_class": null, "prelearner_buffer_class": null, "prelearner_buffer_kwargs": {}, "prelearner_module_synch_period": 10, "dataset_num_iters_per_learner": null, "input_config": {}, "actions_in_input_normalized": false, "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_config": {}, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "output_max_rows_per_file": null, "output_write_remaining_data": false, "output_write_method": "write_parquet", "output_write_method_kwargs": {}, "output_filesystem": null, "output_filesystem_kwargs": {}, "output_write_episodes": true, "offline_sampling": false, "evaluation_interval": 1, "evaluation_duration": 20, "evaluation_duration_unit": "episodes", "evaluation_sample_timeout_s": 120.0, "evaluation_auto_duration_min_env_steps_per_sample": 100, "evaluation_auto_duration_max_env_steps_per_sample": 2000, "evaluation_parallel_to_training": false, "evaluation_force_reset_envs_before_iteration": true, "evaluation_config": null, "off_policy_estimation_methods": {}, "ope_split_batch_by_episode": true, "evaluation_num_env_runners": 1, "in_evaluation": false, "sync_filters_on_rollout_workers_timeout_s": 10.0, "offline_evaluation_interval": null, "num_offline_eval_runners": 0, "offline_loss_for_module_fn": null, "offline_evaluation_duration": 1, "offline_evaluation_parallel_to_training": false, "offline_evaluation_timeout_s": 120.0, "num_cpus_per_offline_eval_runner": 1, "num_gpus_per_offline_eval_runner": 0, "custom_resources_per_offline_eval_runner": {}, "restart_failed_offline_eval_runners": true, "ignore_offline_eval_runner_failures": false, "max_num_offline_eval_runner_restarts": 1000, "offline_eval_runner_restore_timeout_s": 1800.0, "max_requests_in_flight_per_offline_eval_runner": 1, "validate_offline_eval_runners_after_construction": true, "offline_eval_runner_health_probe_timeout_s": 30.0, "offline_eval_rl_module_inference_only": false, "broadcast_offline_eval_runner_states": false, "offline_eval_batch_size_per_runner": 256, "dataset_num_iters_per_eval_runner": 1, "keep_per_episode_custom_metrics": false, "metrics_episode_collection_timeout_s": 60.0, "metrics_num_episodes_for_smoothing": 100, "min_time_s_per_iteration": null, "min_train_timesteps_per_iteration": 0, "min_sample_timesteps_per_iteration": 0, "log_gradients": true, "export_native_model_files": false, "checkpoint_trainable_policies_only": false, "logger_creator": null, "logger_config": null, "log_level": "WARN", "log_sys_usage": true, "fake_sampler": false, "seed": 5, "restart_failed_env_runners": true, "ignore_env_runner_failures": false, "max_num_env_runner_restarts": 1000, "delay_between_env_runner_restarts_s": 60.0, "restart_failed_sub_environments": false, "num_consecutive_env_runner_failures_tolerance": 100, "env_runner_health_probe_timeout_s": 30.0, "env_runner_restore_timeout_s": 1800.0, "_model_config": {}, "_rl_module_spec": "RLModuleSpec(module_class=None, observation_space=None, action_space=None, inference_only=False, learner_only=False, model_config=DefaultModelConfig(fcnet_hiddens=[60, 90], fcnet_activation='tanh', fcnet_kernel_initializer=None, fcnet_kernel_initializer_kwargs=None, fcnet_bias_initializer=None, fcnet_bias_initializer_kwargs=None, conv_filters=None, conv_activation='relu', conv_kernel_initializer=None, conv_kernel_initializer_kwargs=None, conv_bias_initializer=None, conv_bias_initializer_kwargs=None, head_fcnet_hiddens=[], head_fcnet_activation='relu', head_fcnet_kernel_initializer=None, head_fcnet_kernel_initializer_kwargs=None, head_fcnet_bias_initializer=None, head_fcnet_bias_initializer_kwargs=None, free_log_std=False, log_std_clip_param=20.0, vf_share_layers=True, use_lstm=False, max_seq_len=20, lstm_cell_size=256, lstm_use_prev_action=False, lstm_use_prev_reward=False, lstm_kernel_initializer=None, lstm_kernel_initializer_kwargs=None, lstm_bias_initializer=None, lstm_bias_initializer_kwargs=None), catalog_class=None, load_state_path=None, model_config_dict=None)", "algorithm_config_overrides_per_module": {}, "_per_module_overrides": {}, "_validate_config": true, "_use_msgpack_checkpoints": false, "_torch_grad_scaler_class": null, "_torch_lr_scheduler_classes": null, "_tf_policy_handles_more_than_one_loss": false, "_disable_preprocessor_api": false, "_disable_action_flattening": false, "_disable_initialize_loss_from_dummy_batch": false, "_dont_auto_sync_env_runner_states": false, "env_task_fn": -1, "enable_connectors": -1, "simple_optimizer": false, "policy_map_cache": -1, "worker_cls": -1, "synchronize_filters": -1, "enable_async_evaluation": -1, "custom_async_evaluation_function": -1, "_enable_rl_module_api": -1, "auto_wrap_old_gym_envs": -1, "always_attach_evaluation_results": -1, "replay_sequence_length": null, "_disable_execution_plan_api": -1, "use_critic": true, "use_gae": true, "use_kl_loss": true, "kl_coeff": 0.7464963036515, "kl_target": 0.0270990929592, "vf_loss_coeff": 0.6688075857018, "entropy_coeff": 0.0090570820258, "clip_param": 0.1221781641624, "vf_clip_param": 0.1027808522125, "entropy_coeff_schedule": null, "lr_schedule": null, "sgd_minibatch_size": -1, "vf_share_layers": -1, "__stdout_file__": null, "__stderr_file__": null, "lambda": 0.9099046732075, "input": "sampler", "policies": {"default_policy": [null, null, null, null]}, "callbacks": "<class 'ray.rllib.callbacks.callbacks.RLlibCallback'>", "create_env_on_driver": false, "custom_eval_function": null, "framework": "torch"}, "time_since_restore": 2.697603225708008, "iterations_since_restore": 1, "perf": {"cpu_util_percent": 48.949999999999996, "ram_util_percent": 77.85}}
{"timers": {"training_iteration": 2.5239291307644454, "restore_env_runners": 1.3272308278828859e-05, "training_step": 2.523783731765579, "env_runner_sampling_timer": 2.3661032673332376, "learner_update_timer": 0.15439591302070765, "synch_weights": 0.0006375000393018126, "restore_eval_env_runners": 9.041978046298027e-06, "evaluation_iteration": 0.1723387079546228, "synch_eval_env_connectors": 0.00012804206926375628, "synch_env_connectors": 5.375011824071407e-06}, "env_runners": {"weights_seq_no": 1.0, "episode_return_max": 6.5, "num_episodes": 250.0, "module_to_env_connector": {"timers": {"connectors": {"tensor_to_numpy": 2.2069172622122964e-05, "remove_single_ts_time_rank_from_batch": 8.958299200140303e-07, "listify_data_for_vector_env": 1.7890912096829054e-05, "get_actions": 7.180147964313135e-05, "normalize_and_clip_actions": 1.4531736406170383e-05, "un_batch_to_individual_items": 8.185772063502565e-06}}, "connector_pipeline_timer": 0.0001740306914347932}, "env_to_module_connector": {"timers": {"connectors": {"batch_individual_items": 1.052915807868505e-05, "add_time_dim_to_batch_and_zero_pad": 3.6990923528263498e-06, "numpy_to_tensor": 1.581059954196494e-05, "add_observations_from_episodes_to_batch": 4.6412001587140205e-06, "add_states_from_episodes_to_batch": 2.467447955466519e-06}}, "connector_pipeline_timer": 6.914253820477812e-05}, "agent_episode_returns_mean": {"default_agent": -3.8199999999999994}, "env_to_module_sum_episodes_length_out": 10.36823839457432, "num_module_steps_sampled": {"default_policy": 5000.0}, "episode_return_min": -13.5, "time_between_sampling": 0.0022254385644439245, "episode_len_min": 20, "episode_len_mean": 20.0, "episode_return_mean": -3.8199999999999994, "episode_len_max": 20, "sample": 0.008504221256457108, "num_env_steps_sampled": 5000.0, "episode_duration_sec_mean": 0.007519235839135944, "env_to_module_sum_episodes_length_in": 10.36823839457432, "env_step_timer": 2.3082289780797912e-05, "num_module_steps_sampled_lifetime": {"default_policy": 10000.0}, "num_episodes_lifetime": 500.0, "num_env_steps_sampled_lifetime": 10000.0, "num_agent_steps_sampled_lifetime": {"default_agent": 10000.0}, "env_reset_timer": 7.469652525001299e-05, "rlmodule_inference_timer": 4.8558402930978186e-05, "module_episode_returns_mean": {"default_policy": -3.8199999999999994}, "num_agent_steps_sampled": {"default_agent": 5000.0}, "num_env_steps_sampled_lifetime_throughput": 2468.632752129569}, "learners": {"default_policy": {"vf_loss_unclipped": 29.594585418701172, "default_optimizer_learning_rate": 0.0002847858517, "module_train_batch_size_mean": 1000.0, "vf_loss": 0.10278083384037018, "entropy": 0.6920329928398132, "total_loss": -0.06935101747512817, "policy_loss": -0.13185341656208038, "vf_explained_var": -0.011589646339416504, "mean_kl_loss": 7.931759319035336e-05, "diff_num_grad_updates_vs_sampler_policy": 1.0, "gradients_default_optimizer_global_norm": 0.14527708292007446, "num_module_steps_trained_lifetime": 12000, "curr_entropy_coeff": 0.0090570820258, "num_module_steps_trained": 6000, "num_trainable_parameters": 6003, "curr_kl_coeff": 0.18662407994270325, "weights_seq_no": 2.0, "num_module_steps_trained_lifetime_throughput": 221146.81597114482}, "__all_modules__": {"learner_connector": {"timers": {"connectors": {"add_observations_from_episodes_to_batch": 0.0008419383992440998, "general_advantage_estimation": 0.009839994594221935, "add_one_ts_to_episodes_and_truncate": 0.008156594986794517, "add_columns_from_episodes_to_train_batch": 0.039300029634032396, "numpy_to_tensor": 0.00013831293093971908, "add_states_from_episodes_to_batch": 3.502526087686419e-06, "batch_individual_items": 0.049785458196420225, "add_time_dim_to_batch_and_zero_pad": 1.2330958852544427e-05}}, "connector_pipeline_timer": 0.10830429447465577}, "num_env_steps_trained": 31500, "num_env_steps_trained_lifetime": 63000, "num_module_steps_trained_lifetime": 12000, "learner_connector_sum_episodes_length_in": 5000.0, "num_trainable_parameters": 6003, "learner_connector_sum_episodes_length_out": 5250.0, "num_module_steps_trained": 6000, "num_non_trainable_parameters": 0, "num_env_steps_trained_lifetime_throughput": 1156314.8928626257, "num_module_steps_trained_throughput": 220872.36040694398, "num_module_steps_trained_lifetime_throughput": 220661.4825958063}}, "num_training_step_calls_per_iteration": 1, "evaluation": {"env_runners": {"module_to_env_connector": {"connector_pipeline_timer": 0.0001588302363599262, "timers": {"connectors": {"remove_single_ts_time_rank_from_batch": 8.63131594657991e-07, "listify_data_for_vector_env": 1.6898881912930298e-05, "normalize_and_clip_actions": 1.3779318181402649e-05, "get_actions": 6.510367038436945e-05, "tensor_to_numpy": 1.977826506123472e-05, "un_batch_to_individual_items": 6.867874505316969e-06}}}, "num_episodes_lifetime": 40, "weights_seq_no": 2.0, "episode_return_max": 12.5, "num_env_steps_sampled": 400, "env_to_module_sum_episodes_length_in": 10.366003441359926, "env_to_module_connector": {"timers": {"connectors": {"add_observations_from_episodes_to_batch": 4.949394501150746e-06, "numpy_to_tensor": 1.2921670109465884e-05, "add_states_from_episodes_to_batch": 2.408556095159915e-06, "batch_individual_items": 8.83924336272328e-06, "add_time_dim_to_batch_and_zero_pad": 3.30036004732279e-06}}, "connector_pipeline_timer": 6.277037568232151e-05}, "env_to_module_sum_episodes_length_out": 10.366003441359926, "episode_len_max": 20, "episode_duration_sec_mean": 0.00754763436561916, "env_step_timer": 2.2592825722411914e-05, "num_env_steps_sampled_lifetime": 10400, "rlmodule_inference_timer": 4.018794145374341e-05, "num_module_steps_sampled_lifetime": {"default_policy": 800}, "num_agent_steps_sampled_lifetime": {"default_agent": 800}, "num_agent_steps_sampled": {"default_agent": 400}, "episode_len_mean": 20.0, "episode_return_mean": -1.3, "agent_episode_returns_mean": {"default_agent": -1.3}, "num_module_steps_sampled": {"default_policy": 400}, "env_reset_timer": 0.00014853549655526876, "num_episodes": 20, "episode_return_min": -15.5, "module_episode_returns_mean": {"default_policy": -1.3}, "episode_len_min": 20, "sample": 0.16515920781646856, "time_between_sampling": 2.60906404198613}, "num_healthy_workers": 1, "actor_manager_num_outstanding_async_reqs": 0, "num_remote_worker_restarts": 0}, "num_env_steps_sampled_lifetime": 10000.0, "fault_tolerance": {"num_healthy_workers": 0, "num_remote_worker_restarts": 0}, "env_runner_group": {"actor_manager_num_outstanding_async_reqs": 0}, "done": false, "training_iteration": 2, "trial_id": "46b1a_00000", "date": "2025-08-11_19-34-17", "timestamp": 1754933657, "time_this_iter_s": 2.7471089363098145, "time_total_s": 5.444712162017822, "pid": 26849, "hostname": "Mac", "node_ip": "127.0.0.1", "config": {"exploration_config": {}, "extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "placement_strategy": "PACK", "num_gpus": 0, "_fake_gpus": false, "num_cpus_for_main_process": 2, "eager_tracing": true, "eager_max_retraces": 20, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "torch_compile_learner": false, "torch_compile_learner_what_to_compile": "forward_train", "torch_compile_learner_dynamo_backend": "aot_eager", "torch_compile_learner_dynamo_mode": null, "torch_compile_worker": false, "torch_compile_worker_dynamo_backend": "aot_eager", "torch_compile_worker_dynamo_mode": null, "torch_ddp_kwargs": {}, "torch_skip_nan_gradients": false, "env": "Umbrella", "env_config": {}, "observation_space": null, "action_space": null, "clip_rewards": null, "normalize_actions": true, "clip_actions": false, "_is_atari": null, "disable_env_checking": false, "render_env": false, "action_mask_key": "action_mask", "env_runner_cls": null, "num_env_runners": 0, "create_local_env_runner": true, "num_envs_per_env_runner": 1, "gym_env_vectorize_mode": "SYNC", "num_cpus_per_env_runner": 1, "num_gpus_per_env_runner": 0, "custom_resources_per_env_runner": {}, "validate_env_runners_after_construction": true, "episodes_to_numpy": true, "max_requests_in_flight_per_env_runner": 1, "sample_timeout_s": 60.0, "_env_to_module_connector": null, "add_default_connectors_to_env_to_module_pipeline": true, "_module_to_env_connector": null, "add_default_connectors_to_module_to_env_pipeline": true, "merge_env_runner_states": "training_only", "broadcast_env_runner_states": true, "episode_lookback_horizon": 1, "rollout_fragment_length": "auto", "batch_mode": "complete_episodes", "compress_observations": false, "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "enable_tf1_exec_eagerly": false, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "preprocessor_pref": "deepmind", "observation_filter": "NoFilter", "update_worker_filter_stats": true, "use_worker_filter_stats": true, "sampler_perf_stats_ema_coef": null, "_is_online": true, "num_learners": 0, "num_gpus_per_learner": 0, "num_cpus_per_learner": "auto", "num_aggregator_actors_per_learner": 0, "max_requests_in_flight_per_aggregator_actor": 3, "local_gpu_idx": 0, "max_requests_in_flight_per_learner": 3, "gamma": 1, "lr": 0.0002847858517, "grad_clip": 0.5, "grad_clip_by": "global_norm", "_train_batch_size_per_learner": 5000, "train_batch_size": 4000, "num_epochs": 1, "minibatch_size": 1000, "shuffle_batch_per_epoch": true, "model": {"fcnet_hiddens": [256, 256], "fcnet_activation": "tanh", "fcnet_weights_initializer": null, "fcnet_weights_initializer_config": null, "fcnet_bias_initializer": null, "fcnet_bias_initializer_config": null, "conv_filters": null, "conv_activation": "relu", "conv_kernel_initializer": null, "conv_kernel_initializer_config": null, "conv_bias_initializer": null, "conv_bias_initializer_config": null, "conv_transpose_kernel_initializer": null, "conv_transpose_kernel_initializer_config": null, "conv_transpose_bias_initializer": null, "conv_transpose_bias_initializer_config": null, "post_fcnet_hiddens": [], "post_fcnet_activation": "relu", "post_fcnet_weights_initializer": null, "post_fcnet_weights_initializer_config": null, "post_fcnet_bias_initializer": null, "post_fcnet_bias_initializer_config": null, "free_log_std": false, "log_std_clip_param": 20.0, "no_final_linear": false, "vf_share_layers": false, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "lstm_weights_initializer": null, "lstm_weights_initializer_config": null, "lstm_bias_initializer": null, "lstm_bias_initializer_config": null, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "attention_use_n_prev_actions": 0, "attention_use_n_prev_rewards": 0, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": null, "custom_model_config": {}, "custom_action_dist": null, "custom_preprocessor": null, "encoder_latent_dim": null, "always_check_shapes": false, "lstm_use_prev_action_reward": -1, "_use_default_native_models": -1, "_disable_preprocessor_api": false, "_disable_action_flattening": false}, "_learner_connector": null, "add_default_connectors_to_learner_pipeline": true, "learner_config_dict": {}, "optimizer": {}, "_learner_class": null, "callbacks_on_algorithm_init": null, "callbacks_on_env_runners_recreated": null, "callbacks_on_offline_eval_runners_recreated": null, "callbacks_on_checkpoint_loaded": null, "callbacks_on_environment_created": null, "callbacks_on_episode_created": null, "callbacks_on_episode_start": null, "callbacks_on_episode_step": null, "callbacks_on_episode_end": null, "callbacks_on_evaluate_start": null, "callbacks_on_evaluate_end": null, "callbacks_on_evaluate_offline_start": null, "callbacks_on_evaluate_offline_end": null, "callbacks_on_sample_end": null, "callbacks_on_train_result": null, "explore": true, "enable_rl_module_and_learner": true, "enable_env_runner_and_connector_v2": true, "_prior_exploration_config": {"type": "StochasticSampling"}, "count_steps_by": "env_steps", "policy_map_capacity": 100, "policy_mapping_fn": "<function AlgorithmConfig.DEFAULT_POLICY_MAPPING_FN at 0x13bfddb20>", "policies_to_train": null, "policy_states_are_swappable": false, "observation_fn": null, "offline_data_class": null, "input_read_method": "read_parquet", "input_read_method_kwargs": {}, "input_read_schema": {}, "input_read_episodes": false, "input_read_sample_batches": false, "input_read_batch_size": null, "input_filesystem": null, "input_filesystem_kwargs": {}, "input_compress_columns": ["obs", "new_obs"], "input_spaces_jsonable": true, "materialize_data": false, "materialize_mapped_data": true, "map_batches_kwargs": {}, "iter_batches_kwargs": {}, "ignore_final_observation": false, "prelearner_class": null, "prelearner_buffer_class": null, "prelearner_buffer_kwargs": {}, "prelearner_module_synch_period": 10, "dataset_num_iters_per_learner": null, "input_config": {}, "actions_in_input_normalized": false, "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_config": {}, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "output_max_rows_per_file": null, "output_write_remaining_data": false, "output_write_method": "write_parquet", "output_write_method_kwargs": {}, "output_filesystem": null, "output_filesystem_kwargs": {}, "output_write_episodes": true, "offline_sampling": false, "evaluation_interval": 1, "evaluation_duration": 20, "evaluation_duration_unit": "episodes", "evaluation_sample_timeout_s": 120.0, "evaluation_auto_duration_min_env_steps_per_sample": 100, "evaluation_auto_duration_max_env_steps_per_sample": 2000, "evaluation_parallel_to_training": false, "evaluation_force_reset_envs_before_iteration": true, "evaluation_config": null, "off_policy_estimation_methods": {}, "ope_split_batch_by_episode": true, "evaluation_num_env_runners": 1, "in_evaluation": false, "sync_filters_on_rollout_workers_timeout_s": 10.0, "offline_evaluation_interval": null, "num_offline_eval_runners": 0, "offline_loss_for_module_fn": null, "offline_evaluation_duration": 1, "offline_evaluation_parallel_to_training": false, "offline_evaluation_timeout_s": 120.0, "num_cpus_per_offline_eval_runner": 1, "num_gpus_per_offline_eval_runner": 0, "custom_resources_per_offline_eval_runner": {}, "restart_failed_offline_eval_runners": true, "ignore_offline_eval_runner_failures": false, "max_num_offline_eval_runner_restarts": 1000, "offline_eval_runner_restore_timeout_s": 1800.0, "max_requests_in_flight_per_offline_eval_runner": 1, "validate_offline_eval_runners_after_construction": true, "offline_eval_runner_health_probe_timeout_s": 30.0, "offline_eval_rl_module_inference_only": false, "broadcast_offline_eval_runner_states": false, "offline_eval_batch_size_per_runner": 256, "dataset_num_iters_per_eval_runner": 1, "keep_per_episode_custom_metrics": false, "metrics_episode_collection_timeout_s": 60.0, "metrics_num_episodes_for_smoothing": 100, "min_time_s_per_iteration": null, "min_train_timesteps_per_iteration": 0, "min_sample_timesteps_per_iteration": 0, "log_gradients": true, "export_native_model_files": false, "checkpoint_trainable_policies_only": false, "logger_creator": null, "logger_config": null, "log_level": "WARN", "log_sys_usage": true, "fake_sampler": false, "seed": 5, "restart_failed_env_runners": true, "ignore_env_runner_failures": false, "max_num_env_runner_restarts": 1000, "delay_between_env_runner_restarts_s": 60.0, "restart_failed_sub_environments": false, "num_consecutive_env_runner_failures_tolerance": 100, "env_runner_health_probe_timeout_s": 30.0, "env_runner_restore_timeout_s": 1800.0, "_model_config": {}, "_rl_module_spec": "RLModuleSpec(module_class=None, observation_space=None, action_space=None, inference_only=False, learner_only=False, model_config=DefaultModelConfig(fcnet_hiddens=[60, 90], fcnet_activation='tanh', fcnet_kernel_initializer=None, fcnet_kernel_initializer_kwargs=None, fcnet_bias_initializer=None, fcnet_bias_initializer_kwargs=None, conv_filters=None, conv_activation='relu', conv_kernel_initializer=None, conv_kernel_initializer_kwargs=None, conv_bias_initializer=None, conv_bias_initializer_kwargs=None, head_fcnet_hiddens=[], head_fcnet_activation='relu', head_fcnet_kernel_initializer=None, head_fcnet_kernel_initializer_kwargs=None, head_fcnet_bias_initializer=None, head_fcnet_bias_initializer_kwargs=None, free_log_std=False, log_std_clip_param=20.0, vf_share_layers=True, use_lstm=False, max_seq_len=20, lstm_cell_size=256, lstm_use_prev_action=False, lstm_use_prev_reward=False, lstm_kernel_initializer=None, lstm_kernel_initializer_kwargs=None, lstm_bias_initializer=None, lstm_bias_initializer_kwargs=None), catalog_class=None, load_state_path=None, model_config_dict=None)", "algorithm_config_overrides_per_module": {}, "_per_module_overrides": {}, "_validate_config": true, "_use_msgpack_checkpoints": false, "_torch_grad_scaler_class": null, "_torch_lr_scheduler_classes": null, "_tf_policy_handles_more_than_one_loss": false, "_disable_preprocessor_api": false, "_disable_action_flattening": false, "_disable_initialize_loss_from_dummy_batch": false, "_dont_auto_sync_env_runner_states": false, "env_task_fn": -1, "enable_connectors": -1, "simple_optimizer": false, "policy_map_cache": -1, "worker_cls": -1, "synchronize_filters": -1, "enable_async_evaluation": -1, "custom_async_evaluation_function": -1, "_enable_rl_module_api": -1, "auto_wrap_old_gym_envs": -1, "always_attach_evaluation_results": -1, "replay_sequence_length": null, "_disable_execution_plan_api": -1, "use_critic": true, "use_gae": true, "use_kl_loss": true, "kl_coeff": 0.7464963036515, "kl_target": 0.0270990929592, "vf_loss_coeff": 0.6688075857018, "entropy_coeff": 0.0090570820258, "clip_param": 0.1221781641624, "vf_clip_param": 0.1027808522125, "entropy_coeff_schedule": null, "lr_schedule": null, "sgd_minibatch_size": -1, "vf_share_layers": -1, "__stdout_file__": null, "__stderr_file__": null, "lambda": 0.9099046732075, "input": "sampler", "policies": {"default_policy": [null, null, null, null]}, "callbacks": "<class 'ray.rllib.callbacks.callbacks.RLlibCallback'>", "create_env_on_driver": false, "custom_eval_function": null, "framework": "torch"}, "time_since_restore": 5.444712162017822, "iterations_since_restore": 2, "perf": {"cpu_util_percent": 69.3, "ram_util_percent": 77.575}}
{"timers": {"training_iteration": 2.5248565102867895, "restore_env_runners": 1.3225415884517133e-05, "training_step": 2.5247100577780275, "env_runner_sampling_timer": 2.3670164938290723, "learner_update_timer": 0.15439246056005357, "synch_weights": 0.0006409142089076339, "restore_eval_env_runners": 9.048228384926915e-06, "evaluation_iteration": 0.1723578837956302, "synch_eval_env_connectors": 0.0001312266488093883, "synch_env_connectors": 5.3866824600845575e-06}, "env_runners": {"weights_seq_no": 2.0, "episode_return_max": 6.5, "num_episodes": 250.0, "module_to_env_connector": {"timers": {"connectors": {"tensor_to_numpy": 2.3508403283909498e-05, "remove_single_ts_time_rank_from_batch": 9.619719739593033e-07, "listify_data_for_vector_env": 1.875915906989222e-05, "get_actions": 8.34760267460868e-05, "normalize_and_clip_actions": 1.5755239621234693e-05, "un_batch_to_individual_items": 8.613843737666541e-06}}, "connector_pipeline_timer": 0.00019154838640836526}, "env_to_module_connector": {"timers": {"connectors": {"batch_individual_items": 1.1375687277644452e-05, "add_time_dim_to_batch_and_zero_pad": 3.7379068421172407e-06, "numpy_to_tensor": 1.8112769943338437e-05, "add_observations_from_episodes_to_batch": 4.8819056441481125e-06, "add_states_from_episodes_to_batch": 2.538066336940579e-06}}, "connector_pipeline_timer": 7.379790133740572e-05}, "agent_episode_returns_mean": {"default_agent": -2.0599999999999996}, "env_to_module_sum_episodes_length_out": 10.36823839457432, "num_module_steps_sampled": {"default_policy": 5000.0}, "episode_return_min": -13.5, "time_between_sampling": 0.002986342466277157, "episode_len_min": 20, "episode_len_mean": 20.0, "episode_return_mean": -2.0599999999999996, "episode_len_max": 20, "sample": 0.008660665535374609, "num_env_steps_sampled": 5000.0, "episode_duration_sec_mean": 0.008222891660407187, "env_to_module_sum_episodes_length_in": 10.36823839457432, "env_step_timer": 2.5121625003514e-05, "num_module_steps_sampled_lifetime": {"default_policy": -607500.0}, "num_episodes_lifetime": -30375.0, "num_env_steps_sampled_lifetime": -607500.0, "num_agent_steps_sampled_lifetime": {"default_agent": -607500.0}, "env_reset_timer": 7.89927502207394e-05, "rlmodule_inference_timer": 5.5267407506054384e-05, "module_episode_returns_mean": {"default_policy": -2.0599999999999996}, "num_agent_steps_sampled": {"default_agent": 5000.0}, "num_env_steps_sampled_lifetime_throughput": 2396.6330639938888}, "learners": {"default_policy": {"vf_loss_unclipped": 31.712276458740234, "default_optimizer_learning_rate": 0.0002847858517, "module_train_batch_size_mean": 1000.0, "vf_loss": 0.10278083384037018, "entropy": 0.6897167563438416, "total_loss": 0.2806500792503357, "policy_loss": 0.21789036691188812, "vf_explained_var": -0.009776949882507324, "mean_kl_loss": 0.0014248319203034043, "diff_num_grad_updates_vs_sampler_policy": 1.0, "gradients_default_optimizer_global_norm": 0.11601883918046951, "num_module_steps_trained_lifetime": 18000, "curr_entropy_coeff": 0.0090570820258, "num_module_steps_trained": 6000, "num_trainable_parameters": 6003, "curr_kl_coeff": 0.09331203997135162, "weights_seq_no": 3.0, "num_module_steps_trained_lifetime_throughput": 219580.83321532432}, "__all_modules__": {"learner_connector": {"timers": {"connectors": {"add_observations_from_episodes_to_batch": 0.0008420094256522134, "general_advantage_estimation": 0.009851149228692522, "add_one_ts_to_episodes_and_truncate": 0.008156482787535061, "add_columns_from_episodes_to_train_batch": 0.03942608183829579, "numpy_to_tensor": 0.0001376860518590547, "add_states_from_episodes_to_batch": 3.5358307999558743e-06, "batch_individual_items": 0.04972734653444495, "add_time_dim_to_batch_and_zero_pad": 1.2427648610901087e-05}}, "connector_pipeline_timer": 0.10838210403037955}, "num_env_steps_trained": 31500, "num_env_steps_trained_lifetime": 94500, "num_module_steps_trained_lifetime": 18000, "learner_connector_sum_episodes_length_in": 5000.0, "num_trainable_parameters": 6003, "learner_connector_sum_episodes_length_out": 5250.0, "num_module_steps_trained": 6000, "num_non_trainable_parameters": 0, "num_env_steps_trained_lifetime_throughput": 1148279.263503506, "num_module_steps_trained_throughput": 219321.04945356713, "num_module_steps_trained_lifetime_throughput": 219116.10306147404}}, "num_training_step_calls_per_iteration": 1, "evaluation": {"env_runners": {"module_to_env_connector": {"connector_pipeline_timer": 0.00013203043464423217, "timers": {"connectors": {"remove_single_ts_time_rank_from_batch": 6.688465735302135e-07, "listify_data_for_vector_env": 1.3971626141238324e-05, "normalize_and_clip_actions": 1.1845645236712387e-05, "get_actions": 5.100583633556355e-05, "tensor_to_numpy": 1.655920354973215e-05, "un_batch_to_individual_items": 6.445385859748594e-06}}}, "num_episodes_lifetime": 60, "weights_seq_no": 3.0, "episode_return_max": 12.5, "num_env_steps_sampled": 400, "env_to_module_sum_episodes_length_in": 10.368205581254823, "env_to_module_connector": {"timers": {"connectors": {"add_observations_from_episodes_to_batch": 4.053241242988995e-06, "numpy_to_tensor": 1.1584236966061829e-05, "add_states_from_episodes_to_batch": 1.9031104134049296e-06, "batch_individual_items": 8.828938842025544e-06, "add_time_dim_to_batch_and_zero_pad": 3.0608216033515895e-06}}, "connector_pipeline_timer": 5.568531898693261e-05}, "env_to_module_sum_episodes_length_out": 10.368205581254823, "episode_len_max": 20, "episode_duration_sec_mean": 0.007207370840478689, "env_step_timer": 1.8544564580306396e-05, "num_env_steps_sampled_lifetime": 15400, "rlmodule_inference_timer": 3.516343658174552e-05, "num_module_steps_sampled_lifetime": {"default_policy": 1200}, "num_agent_steps_sampled_lifetime": {"default_agent": 1200}, "num_agent_steps_sampled": {"default_agent": 400}, "episode_len_mean": 20.0, "episode_return_mean": -0.9666666666666667, "agent_episode_returns_mean": {"default_agent": -0.9666666666666667}, "num_module_steps_sampled": {"default_policy": 400}, "env_reset_timer": 0.00014846764248795807, "num_episodes": 20, "episode_return_min": -15.5, "module_episode_returns_mean": {"default_policy": -0.9666666666666667}, "episode_len_min": 20, "sample": 0.1649292744877632, "time_between_sampling": 2.6096363128162916}, "num_healthy_workers": 1, "actor_manager_num_outstanding_async_reqs": 0, "num_remote_worker_restarts": 0}, "num_env_steps_sampled_lifetime": -607500.0, "fault_tolerance": {"num_healthy_workers": 0, "num_remote_worker_restarts": 0}, "env_runner_group": {"actor_manager_num_outstanding_async_reqs": 0}, "done": false, "training_iteration": 3, "trial_id": "46b1a_00000", "date": "2025-08-11_19-34-20", "timestamp": 1754933660, "time_this_iter_s": 2.7696797847747803, "time_total_s": 8.214391946792603, "pid": 26849, "hostname": "Mac", "node_ip": "127.0.0.1", "config": {"exploration_config": {}, "extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "placement_strategy": "PACK", "num_gpus": 0, "_fake_gpus": false, "num_cpus_for_main_process": 2, "eager_tracing": true, "eager_max_retraces": 20, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "torch_compile_learner": false, "torch_compile_learner_what_to_compile": "forward_train", "torch_compile_learner_dynamo_backend": "aot_eager", "torch_compile_learner_dynamo_mode": null, "torch_compile_worker": false, "torch_compile_worker_dynamo_backend": "aot_eager", "torch_compile_worker_dynamo_mode": null, "torch_ddp_kwargs": {}, "torch_skip_nan_gradients": false, "env": "Umbrella", "env_config": {}, "observation_space": null, "action_space": null, "clip_rewards": null, "normalize_actions": true, "clip_actions": false, "_is_atari": null, "disable_env_checking": false, "render_env": false, "action_mask_key": "action_mask", "env_runner_cls": null, "num_env_runners": 0, "create_local_env_runner": true, "num_envs_per_env_runner": 1, "gym_env_vectorize_mode": "SYNC", "num_cpus_per_env_runner": 1, "num_gpus_per_env_runner": 0, "custom_resources_per_env_runner": {}, "validate_env_runners_after_construction": true, "episodes_to_numpy": true, "max_requests_in_flight_per_env_runner": 1, "sample_timeout_s": 60.0, "_env_to_module_connector": null, "add_default_connectors_to_env_to_module_pipeline": true, "_module_to_env_connector": null, "add_default_connectors_to_module_to_env_pipeline": true, "merge_env_runner_states": "training_only", "broadcast_env_runner_states": true, "episode_lookback_horizon": 1, "rollout_fragment_length": "auto", "batch_mode": "complete_episodes", "compress_observations": false, "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "enable_tf1_exec_eagerly": false, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "preprocessor_pref": "deepmind", "observation_filter": "NoFilter", "update_worker_filter_stats": true, "use_worker_filter_stats": true, "sampler_perf_stats_ema_coef": null, "_is_online": true, "num_learners": 0, "num_gpus_per_learner": 0, "num_cpus_per_learner": "auto", "num_aggregator_actors_per_learner": 0, "max_requests_in_flight_per_aggregator_actor": 3, "local_gpu_idx": 0, "max_requests_in_flight_per_learner": 3, "gamma": 1, "lr": 0.0002847858517, "grad_clip": 0.5, "grad_clip_by": "global_norm", "_train_batch_size_per_learner": 5000, "train_batch_size": 4000, "num_epochs": 1, "minibatch_size": 1000, "shuffle_batch_per_epoch": true, "model": {"fcnet_hiddens": [256, 256], "fcnet_activation": "tanh", "fcnet_weights_initializer": null, "fcnet_weights_initializer_config": null, "fcnet_bias_initializer": null, "fcnet_bias_initializer_config": null, "conv_filters": null, "conv_activation": "relu", "conv_kernel_initializer": null, "conv_kernel_initializer_config": null, "conv_bias_initializer": null, "conv_bias_initializer_config": null, "conv_transpose_kernel_initializer": null, "conv_transpose_kernel_initializer_config": null, "conv_transpose_bias_initializer": null, "conv_transpose_bias_initializer_config": null, "post_fcnet_hiddens": [], "post_fcnet_activation": "relu", "post_fcnet_weights_initializer": null, "post_fcnet_weights_initializer_config": null, "post_fcnet_bias_initializer": null, "post_fcnet_bias_initializer_config": null, "free_log_std": false, "log_std_clip_param": 20.0, "no_final_linear": false, "vf_share_layers": false, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "lstm_weights_initializer": null, "lstm_weights_initializer_config": null, "lstm_bias_initializer": null, "lstm_bias_initializer_config": null, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "attention_use_n_prev_actions": 0, "attention_use_n_prev_rewards": 0, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": null, "custom_model_config": {}, "custom_action_dist": null, "custom_preprocessor": null, "encoder_latent_dim": null, "always_check_shapes": false, "lstm_use_prev_action_reward": -1, "_use_default_native_models": -1, "_disable_preprocessor_api": false, "_disable_action_flattening": false}, "_learner_connector": null, "add_default_connectors_to_learner_pipeline": true, "learner_config_dict": {}, "optimizer": {}, "_learner_class": null, "callbacks_on_algorithm_init": null, "callbacks_on_env_runners_recreated": null, "callbacks_on_offline_eval_runners_recreated": null, "callbacks_on_checkpoint_loaded": null, "callbacks_on_environment_created": null, "callbacks_on_episode_created": null, "callbacks_on_episode_start": null, "callbacks_on_episode_step": null, "callbacks_on_episode_end": null, "callbacks_on_evaluate_start": null, "callbacks_on_evaluate_end": null, "callbacks_on_evaluate_offline_start": null, "callbacks_on_evaluate_offline_end": null, "callbacks_on_sample_end": null, "callbacks_on_train_result": null, "explore": true, "enable_rl_module_and_learner": true, "enable_env_runner_and_connector_v2": true, "_prior_exploration_config": {"type": "StochasticSampling"}, "count_steps_by": "env_steps", "policy_map_capacity": 100, "policy_mapping_fn": "<function AlgorithmConfig.DEFAULT_POLICY_MAPPING_FN at 0x13bfddb20>", "policies_to_train": null, "policy_states_are_swappable": false, "observation_fn": null, "offline_data_class": null, "input_read_method": "read_parquet", "input_read_method_kwargs": {}, "input_read_schema": {}, "input_read_episodes": false, "input_read_sample_batches": false, "input_read_batch_size": null, "input_filesystem": null, "input_filesystem_kwargs": {}, "input_compress_columns": ["obs", "new_obs"], "input_spaces_jsonable": true, "materialize_data": false, "materialize_mapped_data": true, "map_batches_kwargs": {}, "iter_batches_kwargs": {}, "ignore_final_observation": false, "prelearner_class": null, "prelearner_buffer_class": null, "prelearner_buffer_kwargs": {}, "prelearner_module_synch_period": 10, "dataset_num_iters_per_learner": null, "input_config": {}, "actions_in_input_normalized": false, "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_config": {}, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "output_max_rows_per_file": null, "output_write_remaining_data": false, "output_write_method": "write_parquet", "output_write_method_kwargs": {}, "output_filesystem": null, "output_filesystem_kwargs": {}, "output_write_episodes": true, "offline_sampling": false, "evaluation_interval": 1, "evaluation_duration": 20, "evaluation_duration_unit": "episodes", "evaluation_sample_timeout_s": 120.0, "evaluation_auto_duration_min_env_steps_per_sample": 100, "evaluation_auto_duration_max_env_steps_per_sample": 2000, "evaluation_parallel_to_training": false, "evaluation_force_reset_envs_before_iteration": true, "evaluation_config": null, "off_policy_estimation_methods": {}, "ope_split_batch_by_episode": true, "evaluation_num_env_runners": 1, "in_evaluation": false, "sync_filters_on_rollout_workers_timeout_s": 10.0, "offline_evaluation_interval": null, "num_offline_eval_runners": 0, "offline_loss_for_module_fn": null, "offline_evaluation_duration": 1, "offline_evaluation_parallel_to_training": false, "offline_evaluation_timeout_s": 120.0, "num_cpus_per_offline_eval_runner": 1, "num_gpus_per_offline_eval_runner": 0, "custom_resources_per_offline_eval_runner": {}, "restart_failed_offline_eval_runners": true, "ignore_offline_eval_runner_failures": false, "max_num_offline_eval_runner_restarts": 1000, "offline_eval_runner_restore_timeout_s": 1800.0, "max_requests_in_flight_per_offline_eval_runner": 1, "validate_offline_eval_runners_after_construction": true, "offline_eval_runner_health_probe_timeout_s": 30.0, "offline_eval_rl_module_inference_only": false, "broadcast_offline_eval_runner_states": false, "offline_eval_batch_size_per_runner": 256, "dataset_num_iters_per_eval_runner": 1, "keep_per_episode_custom_metrics": false, "metrics_episode_collection_timeout_s": 60.0, "metrics_num_episodes_for_smoothing": 100, "min_time_s_per_iteration": null, "min_train_timesteps_per_iteration": 0, "min_sample_timesteps_per_iteration": 0, "log_gradients": true, "export_native_model_files": false, "checkpoint_trainable_policies_only": false, "logger_creator": null, "logger_config": null, "log_level": "WARN", "log_sys_usage": true, "fake_sampler": false, "seed": 5, "restart_failed_env_runners": true, "ignore_env_runner_failures": false, "max_num_env_runner_restarts": 1000, "delay_between_env_runner_restarts_s": 60.0, "restart_failed_sub_environments": false, "num_consecutive_env_runner_failures_tolerance": 100, "env_runner_health_probe_timeout_s": 30.0, "env_runner_restore_timeout_s": 1800.0, "_model_config": {}, "_rl_module_spec": "RLModuleSpec(module_class=None, observation_space=None, action_space=None, inference_only=False, learner_only=False, model_config=DefaultModelConfig(fcnet_hiddens=[60, 90], fcnet_activation='tanh', fcnet_kernel_initializer=None, fcnet_kernel_initializer_kwargs=None, fcnet_bias_initializer=None, fcnet_bias_initializer_kwargs=None, conv_filters=None, conv_activation='relu', conv_kernel_initializer=None, conv_kernel_initializer_kwargs=None, conv_bias_initializer=None, conv_bias_initializer_kwargs=None, head_fcnet_hiddens=[], head_fcnet_activation='relu', head_fcnet_kernel_initializer=None, head_fcnet_kernel_initializer_kwargs=None, head_fcnet_bias_initializer=None, head_fcnet_bias_initializer_kwargs=None, free_log_std=False, log_std_clip_param=20.0, vf_share_layers=True, use_lstm=False, max_seq_len=20, lstm_cell_size=256, lstm_use_prev_action=False, lstm_use_prev_reward=False, lstm_kernel_initializer=None, lstm_kernel_initializer_kwargs=None, lstm_bias_initializer=None, lstm_bias_initializer_kwargs=None), catalog_class=None, load_state_path=None, model_config_dict=None)", "algorithm_config_overrides_per_module": {}, "_per_module_overrides": {}, "_validate_config": true, "_use_msgpack_checkpoints": false, "_torch_grad_scaler_class": null, "_torch_lr_scheduler_classes": null, "_tf_policy_handles_more_than_one_loss": false, "_disable_preprocessor_api": false, "_disable_action_flattening": false, "_disable_initialize_loss_from_dummy_batch": false, "_dont_auto_sync_env_runner_states": false, "env_task_fn": -1, "enable_connectors": -1, "simple_optimizer": false, "policy_map_cache": -1, "worker_cls": -1, "synchronize_filters": -1, "enable_async_evaluation": -1, "custom_async_evaluation_function": -1, "_enable_rl_module_api": -1, "auto_wrap_old_gym_envs": -1, "always_attach_evaluation_results": -1, "replay_sequence_length": null, "_disable_execution_plan_api": -1, "use_critic": true, "use_gae": true, "use_kl_loss": true, "kl_coeff": 0.7464963036515, "kl_target": 0.0270990929592, "vf_loss_coeff": 0.6688075857018, "entropy_coeff": 0.0090570820258, "clip_param": 0.1221781641624, "vf_clip_param": 0.1027808522125, "entropy_coeff_schedule": null, "lr_schedule": null, "sgd_minibatch_size": -1, "vf_share_layers": -1, "__stdout_file__": null, "__stderr_file__": null, "lambda": 0.9099046732075, "input": "sampler", "policies": {"default_policy": [null, null, null, null]}, "callbacks": "<class 'ray.rllib.callbacks.callbacks.RLlibCallback'>", "create_env_on_driver": false, "custom_eval_function": null, "framework": "torch"}, "time_since_restore": 8.214391946792603, "iterations_since_restore": 3, "perf": {"cpu_util_percent": 74.875, "ram_util_percent": 77.875}}
{"timers": {"training_iteration": 2.523888108093921, "restore_env_runners": 1.3173162334831432e-05, "training_step": 2.523741229700043, "env_runner_sampling_timer": 2.3663295930606703, "learner_update_timer": 0.15411252345444074, "synch_weights": 0.0006405554865794255, "restore_eval_env_runners": 9.049416182097048e-06, "evaluation_iteration": 0.17212333995823284, "synch_eval_env_connectors": 0.00013333105210913346, "synch_env_connectors": 5.385315453168005e-06}, "env_runners": {"weights_seq_no": 3.0, "episode_return_max": 6.5, "num_episodes": 250.0, "module_to_env_connector": {"timers": {"connectors": {"tensor_to_numpy": 2.1333788321341972e-05, "remove_single_ts_time_rank_from_batch": 8.705816702079634e-07, "listify_data_for_vector_env": 1.7232416550627067e-05, "get_actions": 6.840819740569476e-05, "normalize_and_clip_actions": 1.4346210205376578e-05, "un_batch_to_individual_items": 7.949670807467258e-06}}, "connector_pipeline_timer": 0.00016770046795932725}, "env_to_module_connector": {"timers": {"connectors": {"batch_individual_items": 1.0091095744689155e-05, "add_time_dim_to_batch_and_zero_pad": 3.552980918129817e-06, "numpy_to_tensor": 1.4548853805909423e-05, "add_observations_from_episodes_to_batch": 4.552658001213856e-06, "add_states_from_episodes_to_batch": 2.405896123102132e-06}}, "connector_pipeline_timer": 6.60734851443806e-05}, "agent_episode_returns_mean": {"default_agent": -3.0199999999999996}, "env_to_module_sum_episodes_length_out": 10.36823839457432, "num_module_steps_sampled": {"default_policy": 5000.0}, "episode_return_min": -13.5, "time_between_sampling": 0.0027108205172580732, "episode_len_min": 20, "episode_len_mean": 20.0, "episode_return_mean": -3.0199999999999996, "episode_len_max": 20, "sample": 0.007928294484986415, "num_env_steps_sampled": 5000.0, "episode_duration_sec_mean": 0.00724106317665428, "env_to_module_sum_episodes_length_in": 10.36823839457432, "env_step_timer": 2.2825682287458006e-05, "num_module_steps_sampled_lifetime": {"default_policy": -1225000.0}, "num_episodes_lifetime": -61250.0, "num_env_steps_sampled_lifetime": -1225000.0, "num_agent_steps_sampled_lifetime": {"default_agent": -1225000.0}, "env_reset_timer": 7.051027522643896e-05, "rlmodule_inference_timer": 4.5259546102548465e-05, "module_episode_returns_mean": {"default_policy": -3.0199999999999996}, "num_agent_steps_sampled": {"default_agent": 5000.0}, "num_env_steps_sampled_lifetime_throughput": 2554.007656145027}, "learners": {"default_policy": {"vf_loss_unclipped": 27.08785629272461, "default_optimizer_learning_rate": 0.0002847858517, "module_train_batch_size_mean": 1000.0, "vf_loss": 0.10278083384037018, "entropy": 0.6764528751373291, "total_loss": -0.23051778972148895, "policy_loss": -0.29342687129974365, "vf_explained_var": -0.01489114761352539, "mean_kl_loss": 0.003163272514939308, "diff_num_grad_updates_vs_sampler_policy": 1.0, "gradients_default_optimizer_global_norm": 0.11352477222681046, "num_module_steps_trained_lifetime": 24000, "curr_entropy_coeff": 0.0090570820258, "num_module_steps_trained": 6000, "num_trainable_parameters": 6003, "curr_kl_coeff": 0.04665601998567581, "weights_seq_no": 4.0, "num_module_steps_trained_lifetime_throughput": 219776.3763669532}, "__all_modules__": {"learner_connector": {"timers": {"connectors": {"add_observations_from_episodes_to_batch": 0.000842242241287371, "general_advantage_estimation": 0.009848645236947924, "add_one_ts_to_episodes_and_truncate": 0.00815524296011345, "add_columns_from_episodes_to_train_batch": 0.03941777767936023, "numpy_to_tensor": 0.00013839002092170993, "add_states_from_episodes_to_batch": 3.544642793363891e-06, "batch_individual_items": 0.04972201348898862, "add_time_dim_to_batch_and_zero_pad": 1.2424622174934484e-05}}, "connector_pipeline_timer": 0.10836511507032635}, "num_env_steps_trained": 31500, "num_env_steps_trained_lifetime": 126000, "num_module_steps_trained_lifetime": 24000, "learner_connector_sum_episodes_length_in": 5000.0, "num_trainable_parameters": 6003, "learner_connector_sum_episodes_length_out": 5250.0, "num_module_steps_trained": 6000, "num_non_trainable_parameters": 0, "num_env_steps_trained_lifetime_throughput": 1149554.375954482, "num_module_steps_trained_throughput": 219535.6181025467, "num_module_steps_trained_lifetime_throughput": 219336.68111060225}}, "num_training_step_calls_per_iteration": 1, "evaluation": {"env_runners": {"module_to_env_connector": {"connector_pipeline_timer": 0.00014674899000332358, "timers": {"connectors": {"remove_single_ts_time_rank_from_batch": 7.548469534517462e-07, "listify_data_for_vector_env": 1.5080920867299306e-05, "normalize_and_clip_actions": 1.2632043686022734e-05, "get_actions": 5.598934258321304e-05, "tensor_to_numpy": 1.9414786345622322e-05, "un_batch_to_individual_items": 7.421114292727119e-06}}}, "num_episodes_lifetime": 80, "weights_seq_no": 4.0, "episode_return_max": 12.5, "num_env_steps_sampled": 400, "env_to_module_sum_episodes_length_in": 10.368237912813044, "env_to_module_connector": {"timers": {"connectors": {"add_observations_from_episodes_to_batch": 3.772118064462342e-06, "numpy_to_tensor": 1.3064874249458416e-05, "add_states_from_episodes_to_batch": 2.1923130119179063e-06, "batch_individual_items": 8.970777117450015e-06, "add_time_dim_to_batch_and_zero_pad": 3.2359440187153265e-06}}, "connector_pipeline_timer": 5.9616170618963266e-05}, "env_to_module_sum_episodes_length_out": 10.368237912813044, "episode_len_max": 20, "episode_duration_sec_mean": 0.0074453916677157395, "env_step_timer": 2.0316238246545434e-05, "num_env_steps_sampled_lifetime": 20400, "rlmodule_inference_timer": 3.9401587773302046e-05, "num_module_steps_sampled_lifetime": {"default_policy": 1600}, "num_agent_steps_sampled_lifetime": {"default_agent": 1600}, "num_agent_steps_sampled": {"default_agent": 400}, "episode_len_mean": 20.0, "episode_return_mean": -0.8, "agent_episode_returns_mean": {"default_agent": -0.8}, "num_module_steps_sampled": {"default_policy": 400}, "env_reset_timer": 0.0001478275464172475, "num_episodes": 20, "episode_return_min": -15.5, "module_episode_returns_mean": {"default_policy": -0.8}, "episode_len_min": 20, "sample": 0.16505641716233702, "time_between_sampling": 2.608022309688385}, "num_healthy_workers": 1, "actor_manager_num_outstanding_async_reqs": 0, "num_remote_worker_restarts": 0}, "num_env_steps_sampled_lifetime": -1225000.0, "fault_tolerance": {"num_healthy_workers": 0, "num_remote_worker_restarts": 0}, "env_runner_group": {"actor_manager_num_outstanding_async_reqs": 0}, "done": false, "training_iteration": 4, "trial_id": "46b1a_00000", "date": "2025-08-11_19-34-23", "timestamp": 1754933663, "time_this_iter_s": 2.6132490634918213, "time_total_s": 10.827641010284424, "pid": 26849, "hostname": "Mac", "node_ip": "127.0.0.1", "config": {"exploration_config": {}, "extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "placement_strategy": "PACK", "num_gpus": 0, "_fake_gpus": false, "num_cpus_for_main_process": 2, "eager_tracing": true, "eager_max_retraces": 20, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "torch_compile_learner": false, "torch_compile_learner_what_to_compile": "forward_train", "torch_compile_learner_dynamo_backend": "aot_eager", "torch_compile_learner_dynamo_mode": null, "torch_compile_worker": false, "torch_compile_worker_dynamo_backend": "aot_eager", "torch_compile_worker_dynamo_mode": null, "torch_ddp_kwargs": {}, "torch_skip_nan_gradients": false, "env": "Umbrella", "env_config": {}, "observation_space": null, "action_space": null, "clip_rewards": null, "normalize_actions": true, "clip_actions": false, "_is_atari": null, "disable_env_checking": false, "render_env": false, "action_mask_key": "action_mask", "env_runner_cls": null, "num_env_runners": 0, "create_local_env_runner": true, "num_envs_per_env_runner": 1, "gym_env_vectorize_mode": "SYNC", "num_cpus_per_env_runner": 1, "num_gpus_per_env_runner": 0, "custom_resources_per_env_runner": {}, "validate_env_runners_after_construction": true, "episodes_to_numpy": true, "max_requests_in_flight_per_env_runner": 1, "sample_timeout_s": 60.0, "_env_to_module_connector": null, "add_default_connectors_to_env_to_module_pipeline": true, "_module_to_env_connector": null, "add_default_connectors_to_module_to_env_pipeline": true, "merge_env_runner_states": "training_only", "broadcast_env_runner_states": true, "episode_lookback_horizon": 1, "rollout_fragment_length": "auto", "batch_mode": "complete_episodes", "compress_observations": false, "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "enable_tf1_exec_eagerly": false, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "preprocessor_pref": "deepmind", "observation_filter": "NoFilter", "update_worker_filter_stats": true, "use_worker_filter_stats": true, "sampler_perf_stats_ema_coef": null, "_is_online": true, "num_learners": 0, "num_gpus_per_learner": 0, "num_cpus_per_learner": "auto", "num_aggregator_actors_per_learner": 0, "max_requests_in_flight_per_aggregator_actor": 3, "local_gpu_idx": 0, "max_requests_in_flight_per_learner": 3, "gamma": 1, "lr": 0.0002847858517, "grad_clip": 0.5, "grad_clip_by": "global_norm", "_train_batch_size_per_learner": 5000, "train_batch_size": 4000, "num_epochs": 1, "minibatch_size": 1000, "shuffle_batch_per_epoch": true, "model": {"fcnet_hiddens": [256, 256], "fcnet_activation": "tanh", "fcnet_weights_initializer": null, "fcnet_weights_initializer_config": null, "fcnet_bias_initializer": null, "fcnet_bias_initializer_config": null, "conv_filters": null, "conv_activation": "relu", "conv_kernel_initializer": null, "conv_kernel_initializer_config": null, "conv_bias_initializer": null, "conv_bias_initializer_config": null, "conv_transpose_kernel_initializer": null, "conv_transpose_kernel_initializer_config": null, "conv_transpose_bias_initializer": null, "conv_transpose_bias_initializer_config": null, "post_fcnet_hiddens": [], "post_fcnet_activation": "relu", "post_fcnet_weights_initializer": null, "post_fcnet_weights_initializer_config": null, "post_fcnet_bias_initializer": null, "post_fcnet_bias_initializer_config": null, "free_log_std": false, "log_std_clip_param": 20.0, "no_final_linear": false, "vf_share_layers": false, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "lstm_weights_initializer": null, "lstm_weights_initializer_config": null, "lstm_bias_initializer": null, "lstm_bias_initializer_config": null, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "attention_use_n_prev_actions": 0, "attention_use_n_prev_rewards": 0, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": null, "custom_model_config": {}, "custom_action_dist": null, "custom_preprocessor": null, "encoder_latent_dim": null, "always_check_shapes": false, "lstm_use_prev_action_reward": -1, "_use_default_native_models": -1, "_disable_preprocessor_api": false, "_disable_action_flattening": false}, "_learner_connector": null, "add_default_connectors_to_learner_pipeline": true, "learner_config_dict": {}, "optimizer": {}, "_learner_class": null, "callbacks_on_algorithm_init": null, "callbacks_on_env_runners_recreated": null, "callbacks_on_offline_eval_runners_recreated": null, "callbacks_on_checkpoint_loaded": null, "callbacks_on_environment_created": null, "callbacks_on_episode_created": null, "callbacks_on_episode_start": null, "callbacks_on_episode_step": null, "callbacks_on_episode_end": null, "callbacks_on_evaluate_start": null, "callbacks_on_evaluate_end": null, "callbacks_on_evaluate_offline_start": null, "callbacks_on_evaluate_offline_end": null, "callbacks_on_sample_end": null, "callbacks_on_train_result": null, "explore": true, "enable_rl_module_and_learner": true, "enable_env_runner_and_connector_v2": true, "_prior_exploration_config": {"type": "StochasticSampling"}, "count_steps_by": "env_steps", "policy_map_capacity": 100, "policy_mapping_fn": "<function AlgorithmConfig.DEFAULT_POLICY_MAPPING_FN at 0x13bfddb20>", "policies_to_train": null, "policy_states_are_swappable": false, "observation_fn": null, "offline_data_class": null, "input_read_method": "read_parquet", "input_read_method_kwargs": {}, "input_read_schema": {}, "input_read_episodes": false, "input_read_sample_batches": false, "input_read_batch_size": null, "input_filesystem": null, "input_filesystem_kwargs": {}, "input_compress_columns": ["obs", "new_obs"], "input_spaces_jsonable": true, "materialize_data": false, "materialize_mapped_data": true, "map_batches_kwargs": {}, "iter_batches_kwargs": {}, "ignore_final_observation": false, "prelearner_class": null, "prelearner_buffer_class": null, "prelearner_buffer_kwargs": {}, "prelearner_module_synch_period": 10, "dataset_num_iters_per_learner": null, "input_config": {}, "actions_in_input_normalized": false, "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_config": {}, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "output_max_rows_per_file": null, "output_write_remaining_data": false, "output_write_method": "write_parquet", "output_write_method_kwargs": {}, "output_filesystem": null, "output_filesystem_kwargs": {}, "output_write_episodes": true, "offline_sampling": false, "evaluation_interval": 1, "evaluation_duration": 20, "evaluation_duration_unit": "episodes", "evaluation_sample_timeout_s": 120.0, "evaluation_auto_duration_min_env_steps_per_sample": 100, "evaluation_auto_duration_max_env_steps_per_sample": 2000, "evaluation_parallel_to_training": false, "evaluation_force_reset_envs_before_iteration": true, "evaluation_config": null, "off_policy_estimation_methods": {}, "ope_split_batch_by_episode": true, "evaluation_num_env_runners": 1, "in_evaluation": false, "sync_filters_on_rollout_workers_timeout_s": 10.0, "offline_evaluation_interval": null, "num_offline_eval_runners": 0, "offline_loss_for_module_fn": null, "offline_evaluation_duration": 1, "offline_evaluation_parallel_to_training": false, "offline_evaluation_timeout_s": 120.0, "num_cpus_per_offline_eval_runner": 1, "num_gpus_per_offline_eval_runner": 0, "custom_resources_per_offline_eval_runner": {}, "restart_failed_offline_eval_runners": true, "ignore_offline_eval_runner_failures": false, "max_num_offline_eval_runner_restarts": 1000, "offline_eval_runner_restore_timeout_s": 1800.0, "max_requests_in_flight_per_offline_eval_runner": 1, "validate_offline_eval_runners_after_construction": true, "offline_eval_runner_health_probe_timeout_s": 30.0, "offline_eval_rl_module_inference_only": false, "broadcast_offline_eval_runner_states": false, "offline_eval_batch_size_per_runner": 256, "dataset_num_iters_per_eval_runner": 1, "keep_per_episode_custom_metrics": false, "metrics_episode_collection_timeout_s": 60.0, "metrics_num_episodes_for_smoothing": 100, "min_time_s_per_iteration": null, "min_train_timesteps_per_iteration": 0, "min_sample_timesteps_per_iteration": 0, "log_gradients": true, "export_native_model_files": false, "checkpoint_trainable_policies_only": false, "logger_creator": null, "logger_config": null, "log_level": "WARN", "log_sys_usage": true, "fake_sampler": false, "seed": 5, "restart_failed_env_runners": true, "ignore_env_runner_failures": false, "max_num_env_runner_restarts": 1000, "delay_between_env_runner_restarts_s": 60.0, "restart_failed_sub_environments": false, "num_consecutive_env_runner_failures_tolerance": 100, "env_runner_health_probe_timeout_s": 30.0, "env_runner_restore_timeout_s": 1800.0, "_model_config": {}, "_rl_module_spec": "RLModuleSpec(module_class=None, observation_space=None, action_space=None, inference_only=False, learner_only=False, model_config=DefaultModelConfig(fcnet_hiddens=[60, 90], fcnet_activation='tanh', fcnet_kernel_initializer=None, fcnet_kernel_initializer_kwargs=None, fcnet_bias_initializer=None, fcnet_bias_initializer_kwargs=None, conv_filters=None, conv_activation='relu', conv_kernel_initializer=None, conv_kernel_initializer_kwargs=None, conv_bias_initializer=None, conv_bias_initializer_kwargs=None, head_fcnet_hiddens=[], head_fcnet_activation='relu', head_fcnet_kernel_initializer=None, head_fcnet_kernel_initializer_kwargs=None, head_fcnet_bias_initializer=None, head_fcnet_bias_initializer_kwargs=None, free_log_std=False, log_std_clip_param=20.0, vf_share_layers=True, use_lstm=False, max_seq_len=20, lstm_cell_size=256, lstm_use_prev_action=False, lstm_use_prev_reward=False, lstm_kernel_initializer=None, lstm_kernel_initializer_kwargs=None, lstm_bias_initializer=None, lstm_bias_initializer_kwargs=None), catalog_class=None, load_state_path=None, model_config_dict=None)", "algorithm_config_overrides_per_module": {}, "_per_module_overrides": {}, "_validate_config": true, "_use_msgpack_checkpoints": false, "_torch_grad_scaler_class": null, "_torch_lr_scheduler_classes": null, "_tf_policy_handles_more_than_one_loss": false, "_disable_preprocessor_api": false, "_disable_action_flattening": false, "_disable_initialize_loss_from_dummy_batch": false, "_dont_auto_sync_env_runner_states": false, "env_task_fn": -1, "enable_connectors": -1, "simple_optimizer": false, "policy_map_cache": -1, "worker_cls": -1, "synchronize_filters": -1, "enable_async_evaluation": -1, "custom_async_evaluation_function": -1, "_enable_rl_module_api": -1, "auto_wrap_old_gym_envs": -1, "always_attach_evaluation_results": -1, "replay_sequence_length": null, "_disable_execution_plan_api": -1, "use_critic": true, "use_gae": true, "use_kl_loss": true, "kl_coeff": 0.7464963036515, "kl_target": 0.0270990929592, "vf_loss_coeff": 0.6688075857018, "entropy_coeff": 0.0090570820258, "clip_param": 0.1221781641624, "vf_clip_param": 0.1027808522125, "entropy_coeff_schedule": null, "lr_schedule": null, "sgd_minibatch_size": -1, "vf_share_layers": -1, "__stdout_file__": null, "__stderr_file__": null, "lambda": 0.9099046732075, "input": "sampler", "policies": {"default_policy": [null, null, null, null]}, "callbacks": "<class 'ray.rllib.callbacks.callbacks.RLlibCallback'>", "create_env_on_driver": false, "custom_eval_function": null, "framework": "torch"}, "time_since_restore": 10.827641010284424, "iterations_since_restore": 4, "perf": {"cpu_util_percent": 68.5, "ram_util_percent": 77.475}}
{"timers": {"training_iteration": 2.52317260493325, "restore_env_runners": 1.3117261323814747e-05, "training_step": 2.5230243044840694, "env_runner_sampling_timer": 2.3657683750498206, "learner_update_timer": 0.15393685321892783, "synch_weights": 0.0006458253512323553, "restore_eval_env_runners": 9.05809157632757e-06, "evaluation_iteration": 0.1722331619679255, "synch_eval_env_connectors": 0.00013297524146421347, "synch_env_connectors": 5.461881219525822e-06}, "env_runners": {"weights_seq_no": 4.0, "episode_return_max": 6.5, "num_episodes": 250.0, "module_to_env_connector": {"timers": {"connectors": {"tensor_to_numpy": 2.118003995344813e-05, "remove_single_ts_time_rank_from_batch": 8.472369810454075e-07, "listify_data_for_vector_env": 1.6949116808872463e-05, "get_actions": 6.790543394275847e-05, "normalize_and_clip_actions": 1.4082630422916729e-05, "un_batch_to_individual_items": 7.828913751984305e-06}}, "connector_pipeline_timer": 0.00016592876781064463}, "env_to_module_connector": {"timers": {"connectors": {"batch_individual_items": 1.0054722278443195e-05, "add_time_dim_to_batch_and_zero_pad": 3.463843151582599e-06, "numpy_to_tensor": 1.458139615029931e-05, "add_observations_from_episodes_to_batch": 4.389157766338075e-06, "add_states_from_episodes_to_batch": 2.3228416553531154e-06}}, "connector_pipeline_timer": 6.557436999470762e-05}, "agent_episode_returns_mean": {"default_agent": -1.0199999999999996}, "env_to_module_sum_episodes_length_out": 10.36823839457432, "num_module_steps_sampled": {"default_policy": 5000.0}, "episode_return_min": -13.5, "time_between_sampling": 0.0024019345090266625, "episode_len_min": 20, "episode_len_mean": 20.0, "episode_return_mean": -1.0199999999999996, "episode_len_max": 20, "sample": 0.007932392916560421, "num_env_steps_sampled": 5000.0, "episode_duration_sec_mean": 0.0077671725046820905, "env_to_module_sum_episodes_length_in": 10.36823839457432, "env_step_timer": 2.2528391537737743e-05, "num_module_steps_sampled_lifetime": {"default_policy": -1842500.0}, "num_episodes_lifetime": -92125.0, "num_env_steps_sampled_lifetime": -1842500.0, "num_agent_steps_sampled_lifetime": {"default_agent": -1842500.0}, "env_reset_timer": 6.97754902587308e-05, "rlmodule_inference_timer": 7.574102857193734e-05, "module_episode_returns_mean": {"default_policy": -1.0199999999999996}, "num_agent_steps_sampled": {"default_agent": 5000.0}, "num_env_steps_sampled_lifetime_throughput": 2554.5518751766476}, "learners": {"default_policy": {"vf_loss_unclipped": 29.599639892578125, "default_optimizer_learning_rate": 0.0002847858517, "module_train_batch_size_mean": 1000.0, "vf_loss": 0.10278083384037018, "entropy": 0.6639235019683838, "total_loss": 0.17368201911449432, "policy_loss": 0.11087483167648315, "vf_explained_var": -0.012921690940856934, "mean_kl_loss": 0.0017101932317018509, "diff_num_grad_updates_vs_sampler_policy": 1.0, "gradients_default_optimizer_global_norm": 0.16659164428710938, "num_module_steps_trained_lifetime": 30000, "curr_entropy_coeff": 0.0090570820258, "num_module_steps_trained": 6000, "num_trainable_parameters": 6003, "curr_kl_coeff": 0.023328009992837906, "weights_seq_no": 5.0, "num_module_steps_trained_lifetime_throughput": 219397.39094533393}, "__all_modules__": {"learner_connector": {"timers": {"connectors": {"add_observations_from_episodes_to_batch": 0.0008432652388751995, "general_advantage_estimation": 0.009818411284492243, "add_one_ts_to_episodes_and_truncate": 0.008167900110496042, "add_columns_from_episodes_to_train_batch": 0.039507401153378294, "numpy_to_tensor": 0.000138031120368276, "add_states_from_episodes_to_batch": 3.7366963514976663e-06, "batch_individual_items": 0.04962856835411215, "add_time_dim_to_batch_and_zero_pad": 1.242412544028717e-05}}, "connector_pipeline_timer": 0.10834384767030951}, "num_env_steps_trained": 31500, "num_env_steps_trained_lifetime": 157500, "num_module_steps_trained_lifetime": 30000, "learner_connector_sum_episodes_length_in": 5000.0, "num_trainable_parameters": 6003, "learner_connector_sum_episodes_length_out": 5250.0, "num_module_steps_trained": 6000, "num_non_trainable_parameters": 0, "num_env_steps_trained_lifetime_throughput": 1147815.4521373312, "num_module_steps_trained_throughput": 219183.34420738457, "num_module_steps_trained_lifetime_throughput": 218984.6195861786}}, "num_training_step_calls_per_iteration": 1, "evaluation": {"env_runners": {"module_to_env_connector": {"connector_pipeline_timer": 0.00013412218935992054, "timers": {"connectors": {"remove_single_ts_time_rank_from_batch": 7.437734598505518e-07, "listify_data_for_vector_env": 1.4080748923734978e-05, "normalize_and_clip_actions": 1.2013294416445367e-05, "get_actions": 5.038882607925837e-05, "tensor_to_numpy": 1.7879248432837872e-05, "un_batch_to_individual_items": 6.905241687257081e-06}}}, "num_episodes_lifetime": 100, "weights_seq_no": 5.0, "episode_return_max": 12.5, "num_env_steps_sampled": 400, "env_to_module_sum_episodes_length_in": 10.368238387501162, "env_to_module_connector": {"timers": {"connectors": {"add_observations_from_episodes_to_batch": 3.5840432177643404e-06, "numpy_to_tensor": 1.125621777565028e-05, "add_states_from_episodes_to_batch": 1.9626805390045355e-06, "batch_individual_items": 8.131253590141408e-06, "add_time_dim_to_batch_and_zero_pad": 2.862959407307429e-06}}, "connector_pipeline_timer": 5.3249629452003376e-05}, "env_to_module_sum_episodes_length_out": 10.368238387501162, "episode_len_max": 20, "episode_duration_sec_mean": 0.007247596225934103, "env_step_timer": 1.8813634890805074e-05, "num_env_steps_sampled_lifetime": 25400, "rlmodule_inference_timer": 3.717269376064648e-05, "num_module_steps_sampled_lifetime": {"default_policy": 2000}, "num_agent_steps_sampled_lifetime": {"default_agent": 2000}, "num_agent_steps_sampled": {"default_agent": 400}, "episode_len_mean": 20.0, "episode_return_mean": -0.9, "agent_episode_returns_mean": {"default_agent": -0.9}, "num_module_steps_sampled": {"default_policy": 400}, "env_reset_timer": 0.00014754260017930064, "num_episodes": 20, "episode_return_min": -15.5, "module_episode_returns_mean": {"default_policy": -0.9}, "episode_len_min": 20, "sample": 0.16481089423994974, "time_between_sampling": 2.6066924161711937}, "num_healthy_workers": 1, "actor_manager_num_outstanding_async_reqs": 0, "num_remote_worker_restarts": 0}, "num_env_steps_sampled_lifetime": -1842500.0, "fault_tolerance": {"num_healthy_workers": 0, "num_remote_worker_restarts": 0}, "env_runner_group": {"actor_manager_num_outstanding_async_reqs": 0}, "done": false, "training_iteration": 5, "trial_id": "46b1a_00000", "date": "2025-08-11_19-34-25", "timestamp": 1754933665, "time_this_iter_s": 2.602530002593994, "time_total_s": 13.430171012878418, "pid": 26849, "hostname": "Mac", "node_ip": "127.0.0.1", "config": {"exploration_config": {}, "extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "placement_strategy": "PACK", "num_gpus": 0, "_fake_gpus": false, "num_cpus_for_main_process": 2, "eager_tracing": true, "eager_max_retraces": 20, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "torch_compile_learner": false, "torch_compile_learner_what_to_compile": "forward_train", "torch_compile_learner_dynamo_backend": "aot_eager", "torch_compile_learner_dynamo_mode": null, "torch_compile_worker": false, "torch_compile_worker_dynamo_backend": "aot_eager", "torch_compile_worker_dynamo_mode": null, "torch_ddp_kwargs": {}, "torch_skip_nan_gradients": false, "env": "Umbrella", "env_config": {}, "observation_space": null, "action_space": null, "clip_rewards": null, "normalize_actions": true, "clip_actions": false, "_is_atari": null, "disable_env_checking": false, "render_env": false, "action_mask_key": "action_mask", "env_runner_cls": null, "num_env_runners": 0, "create_local_env_runner": true, "num_envs_per_env_runner": 1, "gym_env_vectorize_mode": "SYNC", "num_cpus_per_env_runner": 1, "num_gpus_per_env_runner": 0, "custom_resources_per_env_runner": {}, "validate_env_runners_after_construction": true, "episodes_to_numpy": true, "max_requests_in_flight_per_env_runner": 1, "sample_timeout_s": 60.0, "_env_to_module_connector": null, "add_default_connectors_to_env_to_module_pipeline": true, "_module_to_env_connector": null, "add_default_connectors_to_module_to_env_pipeline": true, "merge_env_runner_states": "training_only", "broadcast_env_runner_states": true, "episode_lookback_horizon": 1, "rollout_fragment_length": "auto", "batch_mode": "complete_episodes", "compress_observations": false, "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "enable_tf1_exec_eagerly": false, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "preprocessor_pref": "deepmind", "observation_filter": "NoFilter", "update_worker_filter_stats": true, "use_worker_filter_stats": true, "sampler_perf_stats_ema_coef": null, "_is_online": true, "num_learners": 0, "num_gpus_per_learner": 0, "num_cpus_per_learner": "auto", "num_aggregator_actors_per_learner": 0, "max_requests_in_flight_per_aggregator_actor": 3, "local_gpu_idx": 0, "max_requests_in_flight_per_learner": 3, "gamma": 1, "lr": 0.0002847858517, "grad_clip": 0.5, "grad_clip_by": "global_norm", "_train_batch_size_per_learner": 5000, "train_batch_size": 4000, "num_epochs": 1, "minibatch_size": 1000, "shuffle_batch_per_epoch": true, "model": {"fcnet_hiddens": [256, 256], "fcnet_activation": "tanh", "fcnet_weights_initializer": null, "fcnet_weights_initializer_config": null, "fcnet_bias_initializer": null, "fcnet_bias_initializer_config": null, "conv_filters": null, "conv_activation": "relu", "conv_kernel_initializer": null, "conv_kernel_initializer_config": null, "conv_bias_initializer": null, "conv_bias_initializer_config": null, "conv_transpose_kernel_initializer": null, "conv_transpose_kernel_initializer_config": null, "conv_transpose_bias_initializer": null, "conv_transpose_bias_initializer_config": null, "post_fcnet_hiddens": [], "post_fcnet_activation": "relu", "post_fcnet_weights_initializer": null, "post_fcnet_weights_initializer_config": null, "post_fcnet_bias_initializer": null, "post_fcnet_bias_initializer_config": null, "free_log_std": false, "log_std_clip_param": 20.0, "no_final_linear": false, "vf_share_layers": false, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "lstm_weights_initializer": null, "lstm_weights_initializer_config": null, "lstm_bias_initializer": null, "lstm_bias_initializer_config": null, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "attention_use_n_prev_actions": 0, "attention_use_n_prev_rewards": 0, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": null, "custom_model_config": {}, "custom_action_dist": null, "custom_preprocessor": null, "encoder_latent_dim": null, "always_check_shapes": false, "lstm_use_prev_action_reward": -1, "_use_default_native_models": -1, "_disable_preprocessor_api": false, "_disable_action_flattening": false}, "_learner_connector": null, "add_default_connectors_to_learner_pipeline": true, "learner_config_dict": {}, "optimizer": {}, "_learner_class": null, "callbacks_on_algorithm_init": null, "callbacks_on_env_runners_recreated": null, "callbacks_on_offline_eval_runners_recreated": null, "callbacks_on_checkpoint_loaded": null, "callbacks_on_environment_created": null, "callbacks_on_episode_created": null, "callbacks_on_episode_start": null, "callbacks_on_episode_step": null, "callbacks_on_episode_end": null, "callbacks_on_evaluate_start": null, "callbacks_on_evaluate_end": null, "callbacks_on_evaluate_offline_start": null, "callbacks_on_evaluate_offline_end": null, "callbacks_on_sample_end": null, "callbacks_on_train_result": null, "explore": true, "enable_rl_module_and_learner": true, "enable_env_runner_and_connector_v2": true, "_prior_exploration_config": {"type": "StochasticSampling"}, "count_steps_by": "env_steps", "policy_map_capacity": 100, "policy_mapping_fn": "<function AlgorithmConfig.DEFAULT_POLICY_MAPPING_FN at 0x13bfddb20>", "policies_to_train": null, "policy_states_are_swappable": false, "observation_fn": null, "offline_data_class": null, "input_read_method": "read_parquet", "input_read_method_kwargs": {}, "input_read_schema": {}, "input_read_episodes": false, "input_read_sample_batches": false, "input_read_batch_size": null, "input_filesystem": null, "input_filesystem_kwargs": {}, "input_compress_columns": ["obs", "new_obs"], "input_spaces_jsonable": true, "materialize_data": false, "materialize_mapped_data": true, "map_batches_kwargs": {}, "iter_batches_kwargs": {}, "ignore_final_observation": false, "prelearner_class": null, "prelearner_buffer_class": null, "prelearner_buffer_kwargs": {}, "prelearner_module_synch_period": 10, "dataset_num_iters_per_learner": null, "input_config": {}, "actions_in_input_normalized": false, "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_config": {}, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "output_max_rows_per_file": null, "output_write_remaining_data": false, "output_write_method": "write_parquet", "output_write_method_kwargs": {}, "output_filesystem": null, "output_filesystem_kwargs": {}, "output_write_episodes": true, "offline_sampling": false, "evaluation_interval": 1, "evaluation_duration": 20, "evaluation_duration_unit": "episodes", "evaluation_sample_timeout_s": 120.0, "evaluation_auto_duration_min_env_steps_per_sample": 100, "evaluation_auto_duration_max_env_steps_per_sample": 2000, "evaluation_parallel_to_training": false, "evaluation_force_reset_envs_before_iteration": true, "evaluation_config": null, "off_policy_estimation_methods": {}, "ope_split_batch_by_episode": true, "evaluation_num_env_runners": 1, "in_evaluation": false, "sync_filters_on_rollout_workers_timeout_s": 10.0, "offline_evaluation_interval": null, "num_offline_eval_runners": 0, "offline_loss_for_module_fn": null, "offline_evaluation_duration": 1, "offline_evaluation_parallel_to_training": false, "offline_evaluation_timeout_s": 120.0, "num_cpus_per_offline_eval_runner": 1, "num_gpus_per_offline_eval_runner": 0, "custom_resources_per_offline_eval_runner": {}, "restart_failed_offline_eval_runners": true, "ignore_offline_eval_runner_failures": false, "max_num_offline_eval_runner_restarts": 1000, "offline_eval_runner_restore_timeout_s": 1800.0, "max_requests_in_flight_per_offline_eval_runner": 1, "validate_offline_eval_runners_after_construction": true, "offline_eval_runner_health_probe_timeout_s": 30.0, "offline_eval_rl_module_inference_only": false, "broadcast_offline_eval_runner_states": false, "offline_eval_batch_size_per_runner": 256, "dataset_num_iters_per_eval_runner": 1, "keep_per_episode_custom_metrics": false, "metrics_episode_collection_timeout_s": 60.0, "metrics_num_episodes_for_smoothing": 100, "min_time_s_per_iteration": null, "min_train_timesteps_per_iteration": 0, "min_sample_timesteps_per_iteration": 0, "log_gradients": true, "export_native_model_files": false, "checkpoint_trainable_policies_only": false, "logger_creator": null, "logger_config": null, "log_level": "WARN", "log_sys_usage": true, "fake_sampler": false, "seed": 5, "restart_failed_env_runners": true, "ignore_env_runner_failures": false, "max_num_env_runner_restarts": 1000, "delay_between_env_runner_restarts_s": 60.0, "restart_failed_sub_environments": false, "num_consecutive_env_runner_failures_tolerance": 100, "env_runner_health_probe_timeout_s": 30.0, "env_runner_restore_timeout_s": 1800.0, "_model_config": {}, "_rl_module_spec": "RLModuleSpec(module_class=None, observation_space=None, action_space=None, inference_only=False, learner_only=False, model_config=DefaultModelConfig(fcnet_hiddens=[60, 90], fcnet_activation='tanh', fcnet_kernel_initializer=None, fcnet_kernel_initializer_kwargs=None, fcnet_bias_initializer=None, fcnet_bias_initializer_kwargs=None, conv_filters=None, conv_activation='relu', conv_kernel_initializer=None, conv_kernel_initializer_kwargs=None, conv_bias_initializer=None, conv_bias_initializer_kwargs=None, head_fcnet_hiddens=[], head_fcnet_activation='relu', head_fcnet_kernel_initializer=None, head_fcnet_kernel_initializer_kwargs=None, head_fcnet_bias_initializer=None, head_fcnet_bias_initializer_kwargs=None, free_log_std=False, log_std_clip_param=20.0, vf_share_layers=True, use_lstm=False, max_seq_len=20, lstm_cell_size=256, lstm_use_prev_action=False, lstm_use_prev_reward=False, lstm_kernel_initializer=None, lstm_kernel_initializer_kwargs=None, lstm_bias_initializer=None, lstm_bias_initializer_kwargs=None), catalog_class=None, load_state_path=None, model_config_dict=None)", "algorithm_config_overrides_per_module": {}, "_per_module_overrides": {}, "_validate_config": true, "_use_msgpack_checkpoints": false, "_torch_grad_scaler_class": null, "_torch_lr_scheduler_classes": null, "_tf_policy_handles_more_than_one_loss": false, "_disable_preprocessor_api": false, "_disable_action_flattening": false, "_disable_initialize_loss_from_dummy_batch": false, "_dont_auto_sync_env_runner_states": false, "env_task_fn": -1, "enable_connectors": -1, "simple_optimizer": false, "policy_map_cache": -1, "worker_cls": -1, "synchronize_filters": -1, "enable_async_evaluation": -1, "custom_async_evaluation_function": -1, "_enable_rl_module_api": -1, "auto_wrap_old_gym_envs": -1, "always_attach_evaluation_results": -1, "replay_sequence_length": null, "_disable_execution_plan_api": -1, "use_critic": true, "use_gae": true, "use_kl_loss": true, "kl_coeff": 0.7464963036515, "kl_target": 0.0270990929592, "vf_loss_coeff": 0.6688075857018, "entropy_coeff": 0.0090570820258, "clip_param": 0.1221781641624, "vf_clip_param": 0.1027808522125, "entropy_coeff_schedule": null, "lr_schedule": null, "sgd_minibatch_size": -1, "vf_share_layers": -1, "__stdout_file__": null, "__stderr_file__": null, "lambda": 0.9099046732075, "input": "sampler", "policies": {"default_policy": [null, null, null, null]}, "callbacks": "<class 'ray.rllib.callbacks.callbacks.RLlibCallback'>", "create_env_on_driver": false, "custom_eval_function": null, "framework": "torch"}, "time_since_restore": 13.430171012878418, "iterations_since_restore": 5, "perf": {"cpu_util_percent": 67.8, "ram_util_percent": 77.025}}
{"timers": {"training_iteration": 2.5221909513843532, "restore_env_runners": 1.305983898110718e-05, "training_step": 2.522040878109285, "env_runner_sampling_timer": 2.363922945889072, "learner_update_timer": 0.154787125107181, "synch_weights": 0.0006476020975611109, "restore_eval_env_runners": 9.03792097551166e-06, "evaluation_iteration": 0.17197421743872623, "synch_eval_env_connectors": 0.00013272882907973486, "synch_env_connectors": 5.450182408181718e-06}, "env_runners": {"weights_seq_no": 5.0, "episode_return_max": 6.5, "num_episodes": 250.0, "module_to_env_connector": {"timers": {"connectors": {"tensor_to_numpy": 2.106349135107805e-05, "remove_single_ts_time_rank_from_batch": 8.997069528880304e-07, "listify_data_for_vector_env": 1.6931193438707195e-05, "get_actions": 6.791151238045617e-05, "normalize_and_clip_actions": 1.4174820922752827e-05, "un_batch_to_individual_items": 7.870478753487359e-06}}, "connector_pipeline_timer": 0.00016641794089973405}, "env_to_module_connector": {"timers": {"connectors": {"batch_individual_items": 1.0015329085187325e-05, "add_time_dim_to_batch_and_zero_pad": 3.607426760513631e-06, "numpy_to_tensor": 1.4449910790501619e-05, "add_observations_from_episodes_to_batch": 4.319672777882338e-06, "add_states_from_episodes_to_batch": 2.4378470830363525e-06}}, "connector_pipeline_timer": 6.598134183536296e-05}, "agent_episode_returns_mean": {"default_agent": 0.5}, "env_to_module_sum_episodes_length_out": 10.36823839457432, "num_module_steps_sampled": {"default_policy": 5000.0}, "episode_return_min": -13.5, "time_between_sampling": 0.002165200280673332, "episode_len_min": 20, "episode_len_mean": 20.0, "episode_return_mean": 0.5, "episode_len_max": 20, "sample": 0.008153327989389413, "num_env_steps_sampled": 5000.0, "episode_duration_sec_mean": 0.007177086677867916, "env_to_module_sum_episodes_length_in": 10.36823839457432, "env_step_timer": 2.263634342817636e-05, "num_module_steps_sampled_lifetime": {"default_policy": -2460000.0}, "num_episodes_lifetime": -123000.0, "num_env_steps_sampled_lifetime": -2460000.0, "num_agent_steps_sampled_lifetime": {"default_agent": -2460000.0}, "env_reset_timer": 6.877565435548e-05, "rlmodule_inference_timer": 4.608382200399419e-05, "module_episode_returns_mean": {"default_policy": 0.5}, "num_agent_steps_sampled": {"default_agent": 5000.0}, "num_env_steps_sampled_lifetime_throughput": 2573.115738434912}, "learners": {"default_policy": {"vf_loss_unclipped": 28.372112274169922, "default_optimizer_learning_rate": 0.0002847858517, "module_train_batch_size_mean": 1000.0, "vf_loss": 0.10278083384037018, "entropy": 0.6570912599563599, "total_loss": 0.20755812525749207, "policy_loss": 0.14476658403873444, "vf_explained_var": -0.013740062713623047, "mean_kl_loss": 9.704682452138513e-05, "diff_num_grad_updates_vs_sampler_policy": 1.0, "gradients_default_optimizer_global_norm": 0.017227962613105774, "num_module_steps_trained_lifetime": 36000, "curr_entropy_coeff": 0.0090570820258, "num_module_steps_trained": 6000, "num_trainable_parameters": 6003, "curr_kl_coeff": 0.011664004996418953, "weights_seq_no": 6.0, "num_module_steps_trained_lifetime_throughput": 219241.36522840627}, "__all_modules__": {"learner_connector": {"timers": {"connectors": {"add_observations_from_episodes_to_batch": 0.0008524909165209121, "general_advantage_estimation": 0.009809684671209152, "add_one_ts_to_episodes_and_truncate": 0.008232410689364079, "add_columns_from_episodes_to_train_batch": 0.03951811630154851, "numpy_to_tensor": 0.0001380812193578726, "add_states_from_episodes_to_batch": 3.7334891358663673e-06, "batch_individual_items": 0.05060082351158608, "add_time_dim_to_batch_and_zero_pad": 1.242404461907238e-05}}, "connector_pipeline_timer": 0.10939196461278881}, "num_env_steps_trained": 31500, "num_env_steps_trained_lifetime": 189000, "num_module_steps_trained_lifetime": 36000, "learner_connector_sum_episodes_length_in": 5000.0, "num_trainable_parameters": 6003, "learner_connector_sum_episodes_length_out": 5250.0, "num_module_steps_trained": 6000, "num_non_trainable_parameters": 0, "num_env_steps_trained_lifetime_throughput": 1147255.8483962899, "num_module_steps_trained_throughput": 219051.44575472068, "num_module_steps_trained_lifetime_throughput": 218855.55164635318}}, "num_training_step_calls_per_iteration": 1, "evaluation": {"env_runners": {"module_to_env_connector": {"connector_pipeline_timer": 0.00014206778536466873, "timers": {"connectors": {"remove_single_ts_time_rank_from_batch": 1.022096873557127e-06, "listify_data_for_vector_env": 1.5298023952155666e-05, "normalize_and_clip_actions": 1.2382417527009256e-05, "get_actions": 5.2770538477703654e-05, "tensor_to_numpy": 1.856526655697863e-05, "un_batch_to_individual_items": 7.529789757563728e-06}}}, "num_episodes_lifetime": 120, "weights_seq_no": 6.0, "episode_return_max": 12.5, "num_env_steps_sampled": 400, "env_to_module_sum_episodes_length_in": 10.368238394470474, "env_to_module_connector": {"timers": {"connectors": {"add_observations_from_episodes_to_batch": 3.936614808012395e-06, "numpy_to_tensor": 1.1593104523315752e-05, "add_states_from_episodes_to_batch": 1.9469901088453506e-06, "batch_individual_items": 8.62837615569226e-06, "add_time_dim_to_batch_and_zero_pad": 2.8391264025797126e-06}}, "connector_pipeline_timer": 5.55167136674994e-05}, "env_to_module_sum_episodes_length_out": 10.368238394470474, "episode_len_max": 20, "episode_duration_sec_mean": 0.007095347070135176, "env_step_timer": 2.0218976948983234e-05, "num_env_steps_sampled_lifetime": 30400, "rlmodule_inference_timer": 4.016439609428844e-05, "num_module_steps_sampled_lifetime": {"default_policy": 2400}, "num_agent_steps_sampled_lifetime": {"default_agent": 2400}, "num_agent_steps_sampled": {"default_agent": 400}, "episode_len_mean": 20.0, "episode_return_mean": -1.5, "agent_episode_returns_mean": {"default_agent": -1.5}, "num_module_steps_sampled": {"default_policy": 400}, "env_reset_timer": 0.0001468546749352317, "num_episodes": 20, "episode_return_min": -15.5, "module_episode_returns_mean": {"default_policy": -1.5}, "episode_len_min": 20, "sample": 0.1646573740481976, "time_between_sampling": 2.6050677507591047}, "num_healthy_workers": 1, "actor_manager_num_outstanding_async_reqs": 0, "num_remote_worker_restarts": 0}, "num_env_steps_sampled_lifetime": -2460000.0, "fault_tolerance": {"num_healthy_workers": 0, "num_remote_worker_restarts": 0}, "env_runner_group": {"actor_manager_num_outstanding_async_reqs": 0}, "done": false, "training_iteration": 6, "trial_id": "46b1a_00000", "date": "2025-08-11_19-34-28", "timestamp": 1754933668, "time_this_iter_s": 2.583836793899536, "time_total_s": 16.014007806777954, "pid": 26849, "hostname": "Mac", "node_ip": "127.0.0.1", "config": {"exploration_config": {}, "extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "placement_strategy": "PACK", "num_gpus": 0, "_fake_gpus": false, "num_cpus_for_main_process": 2, "eager_tracing": true, "eager_max_retraces": 20, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "torch_compile_learner": false, "torch_compile_learner_what_to_compile": "forward_train", "torch_compile_learner_dynamo_backend": "aot_eager", "torch_compile_learner_dynamo_mode": null, "torch_compile_worker": false, "torch_compile_worker_dynamo_backend": "aot_eager", "torch_compile_worker_dynamo_mode": null, "torch_ddp_kwargs": {}, "torch_skip_nan_gradients": false, "env": "Umbrella", "env_config": {}, "observation_space": null, "action_space": null, "clip_rewards": null, "normalize_actions": true, "clip_actions": false, "_is_atari": null, "disable_env_checking": false, "render_env": false, "action_mask_key": "action_mask", "env_runner_cls": null, "num_env_runners": 0, "create_local_env_runner": true, "num_envs_per_env_runner": 1, "gym_env_vectorize_mode": "SYNC", "num_cpus_per_env_runner": 1, "num_gpus_per_env_runner": 0, "custom_resources_per_env_runner": {}, "validate_env_runners_after_construction": true, "episodes_to_numpy": true, "max_requests_in_flight_per_env_runner": 1, "sample_timeout_s": 60.0, "_env_to_module_connector": null, "add_default_connectors_to_env_to_module_pipeline": true, "_module_to_env_connector": null, "add_default_connectors_to_module_to_env_pipeline": true, "merge_env_runner_states": "training_only", "broadcast_env_runner_states": true, "episode_lookback_horizon": 1, "rollout_fragment_length": "auto", "batch_mode": "complete_episodes", "compress_observations": false, "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "enable_tf1_exec_eagerly": false, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "preprocessor_pref": "deepmind", "observation_filter": "NoFilter", "update_worker_filter_stats": true, "use_worker_filter_stats": true, "sampler_perf_stats_ema_coef": null, "_is_online": true, "num_learners": 0, "num_gpus_per_learner": 0, "num_cpus_per_learner": "auto", "num_aggregator_actors_per_learner": 0, "max_requests_in_flight_per_aggregator_actor": 3, "local_gpu_idx": 0, "max_requests_in_flight_per_learner": 3, "gamma": 1, "lr": 0.0002847858517, "grad_clip": 0.5, "grad_clip_by": "global_norm", "_train_batch_size_per_learner": 5000, "train_batch_size": 4000, "num_epochs": 1, "minibatch_size": 1000, "shuffle_batch_per_epoch": true, "model": {"fcnet_hiddens": [256, 256], "fcnet_activation": "tanh", "fcnet_weights_initializer": null, "fcnet_weights_initializer_config": null, "fcnet_bias_initializer": null, "fcnet_bias_initializer_config": null, "conv_filters": null, "conv_activation": "relu", "conv_kernel_initializer": null, "conv_kernel_initializer_config": null, "conv_bias_initializer": null, "conv_bias_initializer_config": null, "conv_transpose_kernel_initializer": null, "conv_transpose_kernel_initializer_config": null, "conv_transpose_bias_initializer": null, "conv_transpose_bias_initializer_config": null, "post_fcnet_hiddens": [], "post_fcnet_activation": "relu", "post_fcnet_weights_initializer": null, "post_fcnet_weights_initializer_config": null, "post_fcnet_bias_initializer": null, "post_fcnet_bias_initializer_config": null, "free_log_std": false, "log_std_clip_param": 20.0, "no_final_linear": false, "vf_share_layers": false, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "lstm_weights_initializer": null, "lstm_weights_initializer_config": null, "lstm_bias_initializer": null, "lstm_bias_initializer_config": null, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "attention_use_n_prev_actions": 0, "attention_use_n_prev_rewards": 0, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": null, "custom_model_config": {}, "custom_action_dist": null, "custom_preprocessor": null, "encoder_latent_dim": null, "always_check_shapes": false, "lstm_use_prev_action_reward": -1, "_use_default_native_models": -1, "_disable_preprocessor_api": false, "_disable_action_flattening": false}, "_learner_connector": null, "add_default_connectors_to_learner_pipeline": true, "learner_config_dict": {}, "optimizer": {}, "_learner_class": null, "callbacks_on_algorithm_init": null, "callbacks_on_env_runners_recreated": null, "callbacks_on_offline_eval_runners_recreated": null, "callbacks_on_checkpoint_loaded": null, "callbacks_on_environment_created": null, "callbacks_on_episode_created": null, "callbacks_on_episode_start": null, "callbacks_on_episode_step": null, "callbacks_on_episode_end": null, "callbacks_on_evaluate_start": null, "callbacks_on_evaluate_end": null, "callbacks_on_evaluate_offline_start": null, "callbacks_on_evaluate_offline_end": null, "callbacks_on_sample_end": null, "callbacks_on_train_result": null, "explore": true, "enable_rl_module_and_learner": true, "enable_env_runner_and_connector_v2": true, "_prior_exploration_config": {"type": "StochasticSampling"}, "count_steps_by": "env_steps", "policy_map_capacity": 100, "policy_mapping_fn": "<function AlgorithmConfig.DEFAULT_POLICY_MAPPING_FN at 0x13bfddb20>", "policies_to_train": null, "policy_states_are_swappable": false, "observation_fn": null, "offline_data_class": null, "input_read_method": "read_parquet", "input_read_method_kwargs": {}, "input_read_schema": {}, "input_read_episodes": false, "input_read_sample_batches": false, "input_read_batch_size": null, "input_filesystem": null, "input_filesystem_kwargs": {}, "input_compress_columns": ["obs", "new_obs"], "input_spaces_jsonable": true, "materialize_data": false, "materialize_mapped_data": true, "map_batches_kwargs": {}, "iter_batches_kwargs": {}, "ignore_final_observation": false, "prelearner_class": null, "prelearner_buffer_class": null, "prelearner_buffer_kwargs": {}, "prelearner_module_synch_period": 10, "dataset_num_iters_per_learner": null, "input_config": {}, "actions_in_input_normalized": false, "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_config": {}, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "output_max_rows_per_file": null, "output_write_remaining_data": false, "output_write_method": "write_parquet", "output_write_method_kwargs": {}, "output_filesystem": null, "output_filesystem_kwargs": {}, "output_write_episodes": true, "offline_sampling": false, "evaluation_interval": 1, "evaluation_duration": 20, "evaluation_duration_unit": "episodes", "evaluation_sample_timeout_s": 120.0, "evaluation_auto_duration_min_env_steps_per_sample": 100, "evaluation_auto_duration_max_env_steps_per_sample": 2000, "evaluation_parallel_to_training": false, "evaluation_force_reset_envs_before_iteration": true, "evaluation_config": null, "off_policy_estimation_methods": {}, "ope_split_batch_by_episode": true, "evaluation_num_env_runners": 1, "in_evaluation": false, "sync_filters_on_rollout_workers_timeout_s": 10.0, "offline_evaluation_interval": null, "num_offline_eval_runners": 0, "offline_loss_for_module_fn": null, "offline_evaluation_duration": 1, "offline_evaluation_parallel_to_training": false, "offline_evaluation_timeout_s": 120.0, "num_cpus_per_offline_eval_runner": 1, "num_gpus_per_offline_eval_runner": 0, "custom_resources_per_offline_eval_runner": {}, "restart_failed_offline_eval_runners": true, "ignore_offline_eval_runner_failures": false, "max_num_offline_eval_runner_restarts": 1000, "offline_eval_runner_restore_timeout_s": 1800.0, "max_requests_in_flight_per_offline_eval_runner": 1, "validate_offline_eval_runners_after_construction": true, "offline_eval_runner_health_probe_timeout_s": 30.0, "offline_eval_rl_module_inference_only": false, "broadcast_offline_eval_runner_states": false, "offline_eval_batch_size_per_runner": 256, "dataset_num_iters_per_eval_runner": 1, "keep_per_episode_custom_metrics": false, "metrics_episode_collection_timeout_s": 60.0, "metrics_num_episodes_for_smoothing": 100, "min_time_s_per_iteration": null, "min_train_timesteps_per_iteration": 0, "min_sample_timesteps_per_iteration": 0, "log_gradients": true, "export_native_model_files": false, "checkpoint_trainable_policies_only": false, "logger_creator": null, "logger_config": null, "log_level": "WARN", "log_sys_usage": true, "fake_sampler": false, "seed": 5, "restart_failed_env_runners": true, "ignore_env_runner_failures": false, "max_num_env_runner_restarts": 1000, "delay_between_env_runner_restarts_s": 60.0, "restart_failed_sub_environments": false, "num_consecutive_env_runner_failures_tolerance": 100, "env_runner_health_probe_timeout_s": 30.0, "env_runner_restore_timeout_s": 1800.0, "_model_config": {}, "_rl_module_spec": "RLModuleSpec(module_class=None, observation_space=None, action_space=None, inference_only=False, learner_only=False, model_config=DefaultModelConfig(fcnet_hiddens=[60, 90], fcnet_activation='tanh', fcnet_kernel_initializer=None, fcnet_kernel_initializer_kwargs=None, fcnet_bias_initializer=None, fcnet_bias_initializer_kwargs=None, conv_filters=None, conv_activation='relu', conv_kernel_initializer=None, conv_kernel_initializer_kwargs=None, conv_bias_initializer=None, conv_bias_initializer_kwargs=None, head_fcnet_hiddens=[], head_fcnet_activation='relu', head_fcnet_kernel_initializer=None, head_fcnet_kernel_initializer_kwargs=None, head_fcnet_bias_initializer=None, head_fcnet_bias_initializer_kwargs=None, free_log_std=False, log_std_clip_param=20.0, vf_share_layers=True, use_lstm=False, max_seq_len=20, lstm_cell_size=256, lstm_use_prev_action=False, lstm_use_prev_reward=False, lstm_kernel_initializer=None, lstm_kernel_initializer_kwargs=None, lstm_bias_initializer=None, lstm_bias_initializer_kwargs=None), catalog_class=None, load_state_path=None, model_config_dict=None)", "algorithm_config_overrides_per_module": {}, "_per_module_overrides": {}, "_validate_config": true, "_use_msgpack_checkpoints": false, "_torch_grad_scaler_class": null, "_torch_lr_scheduler_classes": null, "_tf_policy_handles_more_than_one_loss": false, "_disable_preprocessor_api": false, "_disable_action_flattening": false, "_disable_initialize_loss_from_dummy_batch": false, "_dont_auto_sync_env_runner_states": false, "env_task_fn": -1, "enable_connectors": -1, "simple_optimizer": false, "policy_map_cache": -1, "worker_cls": -1, "synchronize_filters": -1, "enable_async_evaluation": -1, "custom_async_evaluation_function": -1, "_enable_rl_module_api": -1, "auto_wrap_old_gym_envs": -1, "always_attach_evaluation_results": -1, "replay_sequence_length": null, "_disable_execution_plan_api": -1, "use_critic": true, "use_gae": true, "use_kl_loss": true, "kl_coeff": 0.7464963036515, "kl_target": 0.0270990929592, "vf_loss_coeff": 0.6688075857018, "entropy_coeff": 0.0090570820258, "clip_param": 0.1221781641624, "vf_clip_param": 0.1027808522125, "entropy_coeff_schedule": null, "lr_schedule": null, "sgd_minibatch_size": -1, "vf_share_layers": -1, "__stdout_file__": null, "__stderr_file__": null, "lambda": 0.9099046732075, "input": "sampler", "policies": {"default_policy": [null, null, null, null]}, "callbacks": "<class 'ray.rllib.callbacks.callbacks.RLlibCallback'>", "create_env_on_driver": false, "custom_eval_function": null, "framework": "torch"}, "time_since_restore": 16.014007806777954, "iterations_since_restore": 6, "perf": {"cpu_util_percent": 68.6, "ram_util_percent": 77.475}}
{"timers": {"training_iteration": 2.519760922290919, "restore_env_runners": 1.299216074443713e-05, "training_step": 2.519610458497879, "env_runner_sampling_timer": 2.361886994770953, "learner_update_timer": 0.1543928276061618, "synch_weights": 0.0006479773254942878, "restore_eval_env_runners": 9.01754113461786e-06, "evaluation_iteration": 0.17181625193403496, "synch_eval_env_connectors": 0.0001325490407954195, "synch_env_connectors": 5.444430664268148e-06}, "env_runners": {"weights_seq_no": 6.0, "episode_return_max": 6.5, "num_episodes": 250.0, "module_to_env_connector": {"timers": {"connectors": {"tensor_to_numpy": 2.148712857989814e-05, "remove_single_ts_time_rank_from_batch": 8.639992465900115e-07, "listify_data_for_vector_env": 1.711485967114372e-05, "get_actions": 6.740594368283906e-05, "normalize_and_clip_actions": 1.3911876215574024e-05, "un_batch_to_individual_items": 7.965382428337781e-06}}, "connector_pipeline_timer": 0.0001660020372823565}, "env_to_module_connector": {"timers": {"connectors": {"batch_individual_items": 1.0219736789188401e-05, "add_time_dim_to_batch_and_zero_pad": 3.599859600713907e-06, "numpy_to_tensor": 1.4380469930762018e-05, "add_observations_from_episodes_to_batch": 4.287629538295825e-06, "add_states_from_episodes_to_batch": 2.4491533687994653e-06}}, "connector_pipeline_timer": 6.563006268393005e-05}, "agent_episode_returns_mean": {"default_agent": 0.58}, "env_to_module_sum_episodes_length_out": 10.36823839457432, "num_module_steps_sampled": {"default_policy": 5000.0}, "episode_return_min": -13.5, "time_between_sampling": 0.0026485084841584927, "episode_len_min": 20, "episode_len_mean": 20.0, "episode_return_mean": 0.58, "episode_len_max": 20, "sample": 0.007579763952994257, "num_env_steps_sampled": 5000.0, "episode_duration_sec_mean": 0.007201853012200444, "env_to_module_sum_episodes_length_in": 10.36823839457432, "env_step_timer": 2.2271960707493773e-05, "num_module_steps_sampled_lifetime": {"default_policy": -3077500.0}, "num_episodes_lifetime": -153875.0, "num_env_steps_sampled_lifetime": -3077500.0, "num_agent_steps_sampled_lifetime": {"default_agent": -3077500.0}, "env_reset_timer": 6.731284451783145e-05, "rlmodule_inference_timer": 4.5798818545603454e-05, "module_episode_returns_mean": {"default_policy": 0.58}, "num_agent_steps_sampled": {"default_agent": 5000.0}, "num_env_steps_sampled_lifetime_throughput": 2584.979566057946}, "learners": {"default_policy": {"vf_loss_unclipped": 26.70923614501953, "default_optimizer_learning_rate": 0.0002847858517, "module_train_batch_size_mean": 1000.0, "vf_loss": 0.10278083384037018, "entropy": 0.640975832939148, "total_loss": 0.040499333292245865, "policy_loss": -0.022446408867836, "vf_explained_var": -0.016066908836364746, "mean_kl_loss": 0.0009009736822918057, "diff_num_grad_updates_vs_sampler_policy": 1.0, "gradients_default_optimizer_global_norm": 0.058299656957387924, "num_module_steps_trained_lifetime": 42000, "curr_entropy_coeff": 0.0090570820258, "num_module_steps_trained": 6000, "num_trainable_parameters": 6003, "curr_kl_coeff": 0.0058320024982094765, "weights_seq_no": 7.0, "num_module_steps_trained_lifetime_throughput": 219057.1079809289}, "__all_modules__": {"learner_connector": {"timers": {"connectors": {"add_observations_from_episodes_to_batch": 0.0008530172578823846, "general_advantage_estimation": 0.009780569073848114, "add_one_ts_to_episodes_and_truncate": 0.008241153252608826, "add_columns_from_episodes_to_train_batch": 0.03951799054828672, "numpy_to_tensor": 0.00013753124818218087, "add_states_from_episodes_to_batch": 3.741984628404531e-06, "batch_individual_items": 0.05043174194674958, "add_time_dim_to_batch_and_zero_pad": 1.241230444743555e-05}}, "connector_pipeline_timer": 0.10920144038683412}, "num_env_steps_trained": 31500, "num_env_steps_trained_lifetime": 220500, "num_module_steps_trained_lifetime": 42000, "learner_connector_sum_episodes_length_in": 5000.0, "num_trainable_parameters": 6003, "learner_connector_sum_episodes_length_out": 5250.0, "num_module_steps_trained": 6000, "num_non_trainable_parameters": 0, "num_env_steps_trained_lifetime_throughput": 1146527.5210064165, "num_module_steps_trained_throughput": 218888.45566960928, "num_module_steps_trained_lifetime_throughput": 218696.6240781685}}, "num_training_step_calls_per_iteration": 1, "evaluation": {"env_runners": {"module_to_env_connector": {"connector_pipeline_timer": 0.00019763618602180514, "timers": {"connectors": {"remove_single_ts_time_rank_from_batch": 9.323737028870717e-07, "listify_data_for_vector_env": 2.0552849662196692e-05, "normalize_and_clip_actions": 1.532740885656646e-05, "get_actions": 8.269133559083806e-05, "tensor_to_numpy": 2.51758670603489e-05, "un_batch_to_individual_items": 9.508305778146403e-06}}}, "num_episodes_lifetime": 140, "weights_seq_no": 7.0, "episode_return_max": 13.5, "num_env_steps_sampled": 400, "env_to_module_sum_episodes_length_in": 10.368238394572801, "env_to_module_connector": {"timers": {"connectors": {"add_observations_from_episodes_to_batch": 4.752791677984789e-06, "numpy_to_tensor": 1.7366250180756905e-05, "add_states_from_episodes_to_batch": 2.1781678045820707e-06, "batch_individual_items": 1.3075131051523845e-05, "add_time_dim_to_batch_and_zero_pad": 3.8091187770252356e-06}}, "connector_pipeline_timer": 7.647326009756749e-05}, "env_to_module_sum_episodes_length_out": 10.368238394572801, "episode_len_max": 20, "episode_duration_sec_mean": 0.007455579973757267, "env_step_timer": 2.8587060832253547e-05, "num_env_steps_sampled_lifetime": 35400, "rlmodule_inference_timer": 5.625510286330309e-05, "num_module_steps_sampled_lifetime": {"default_policy": 2800}, "num_agent_steps_sampled_lifetime": {"default_agent": 2800}, "num_agent_steps_sampled": {"default_agent": 400}, "episode_len_mean": 20.0, "episode_return_mean": -0.3, "agent_episode_returns_mean": {"default_agent": -0.3}, "num_module_steps_sampled": {"default_policy": 400}, "env_reset_timer": 0.00014623862827439226, "num_episodes": 20, "episode_return_min": -15.5, "module_episode_returns_mean": {"default_policy": -0.3}, "episode_len_min": 20, "sample": 0.16503069655770097, "time_between_sampling": 2.6020155865817536}, "num_healthy_workers": 1, "actor_manager_num_outstanding_async_reqs": 0, "num_remote_worker_restarts": 0}, "num_env_steps_sampled_lifetime": -3077500.0, "fault_tolerance": {"num_healthy_workers": 0, "num_remote_worker_restarts": 0}, "env_runner_group": {"actor_manager_num_outstanding_async_reqs": 0}, "done": false, "training_iteration": 7, "trial_id": "46b1a_00000", "date": "2025-08-11_19-34-30", "timestamp": 1754933670, "time_this_iter_s": 2.488475799560547, "time_total_s": 18.5024836063385, "pid": 26849, "hostname": "Mac", "node_ip": "127.0.0.1", "config": {"exploration_config": {}, "extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "placement_strategy": "PACK", "num_gpus": 0, "_fake_gpus": false, "num_cpus_for_main_process": 2, "eager_tracing": true, "eager_max_retraces": 20, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "torch_compile_learner": false, "torch_compile_learner_what_to_compile": "forward_train", "torch_compile_learner_dynamo_backend": "aot_eager", "torch_compile_learner_dynamo_mode": null, "torch_compile_worker": false, "torch_compile_worker_dynamo_backend": "aot_eager", "torch_compile_worker_dynamo_mode": null, "torch_ddp_kwargs": {}, "torch_skip_nan_gradients": false, "env": "Umbrella", "env_config": {}, "observation_space": null, "action_space": null, "clip_rewards": null, "normalize_actions": true, "clip_actions": false, "_is_atari": null, "disable_env_checking": false, "render_env": false, "action_mask_key": "action_mask", "env_runner_cls": null, "num_env_runners": 0, "create_local_env_runner": true, "num_envs_per_env_runner": 1, "gym_env_vectorize_mode": "SYNC", "num_cpus_per_env_runner": 1, "num_gpus_per_env_runner": 0, "custom_resources_per_env_runner": {}, "validate_env_runners_after_construction": true, "episodes_to_numpy": true, "max_requests_in_flight_per_env_runner": 1, "sample_timeout_s": 60.0, "_env_to_module_connector": null, "add_default_connectors_to_env_to_module_pipeline": true, "_module_to_env_connector": null, "add_default_connectors_to_module_to_env_pipeline": true, "merge_env_runner_states": "training_only", "broadcast_env_runner_states": true, "episode_lookback_horizon": 1, "rollout_fragment_length": "auto", "batch_mode": "complete_episodes", "compress_observations": false, "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "enable_tf1_exec_eagerly": false, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "preprocessor_pref": "deepmind", "observation_filter": "NoFilter", "update_worker_filter_stats": true, "use_worker_filter_stats": true, "sampler_perf_stats_ema_coef": null, "_is_online": true, "num_learners": 0, "num_gpus_per_learner": 0, "num_cpus_per_learner": "auto", "num_aggregator_actors_per_learner": 0, "max_requests_in_flight_per_aggregator_actor": 3, "local_gpu_idx": 0, "max_requests_in_flight_per_learner": 3, "gamma": 1, "lr": 0.0002847858517, "grad_clip": 0.5, "grad_clip_by": "global_norm", "_train_batch_size_per_learner": 5000, "train_batch_size": 4000, "num_epochs": 1, "minibatch_size": 1000, "shuffle_batch_per_epoch": true, "model": {"fcnet_hiddens": [256, 256], "fcnet_activation": "tanh", "fcnet_weights_initializer": null, "fcnet_weights_initializer_config": null, "fcnet_bias_initializer": null, "fcnet_bias_initializer_config": null, "conv_filters": null, "conv_activation": "relu", "conv_kernel_initializer": null, "conv_kernel_initializer_config": null, "conv_bias_initializer": null, "conv_bias_initializer_config": null, "conv_transpose_kernel_initializer": null, "conv_transpose_kernel_initializer_config": null, "conv_transpose_bias_initializer": null, "conv_transpose_bias_initializer_config": null, "post_fcnet_hiddens": [], "post_fcnet_activation": "relu", "post_fcnet_weights_initializer": null, "post_fcnet_weights_initializer_config": null, "post_fcnet_bias_initializer": null, "post_fcnet_bias_initializer_config": null, "free_log_std": false, "log_std_clip_param": 20.0, "no_final_linear": false, "vf_share_layers": false, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "lstm_weights_initializer": null, "lstm_weights_initializer_config": null, "lstm_bias_initializer": null, "lstm_bias_initializer_config": null, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "attention_use_n_prev_actions": 0, "attention_use_n_prev_rewards": 0, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": null, "custom_model_config": {}, "custom_action_dist": null, "custom_preprocessor": null, "encoder_latent_dim": null, "always_check_shapes": false, "lstm_use_prev_action_reward": -1, "_use_default_native_models": -1, "_disable_preprocessor_api": false, "_disable_action_flattening": false}, "_learner_connector": null, "add_default_connectors_to_learner_pipeline": true, "learner_config_dict": {}, "optimizer": {}, "_learner_class": null, "callbacks_on_algorithm_init": null, "callbacks_on_env_runners_recreated": null, "callbacks_on_offline_eval_runners_recreated": null, "callbacks_on_checkpoint_loaded": null, "callbacks_on_environment_created": null, "callbacks_on_episode_created": null, "callbacks_on_episode_start": null, "callbacks_on_episode_step": null, "callbacks_on_episode_end": null, "callbacks_on_evaluate_start": null, "callbacks_on_evaluate_end": null, "callbacks_on_evaluate_offline_start": null, "callbacks_on_evaluate_offline_end": null, "callbacks_on_sample_end": null, "callbacks_on_train_result": null, "explore": true, "enable_rl_module_and_learner": true, "enable_env_runner_and_connector_v2": true, "_prior_exploration_config": {"type": "StochasticSampling"}, "count_steps_by": "env_steps", "policy_map_capacity": 100, "policy_mapping_fn": "<function AlgorithmConfig.DEFAULT_POLICY_MAPPING_FN at 0x13bfddb20>", "policies_to_train": null, "policy_states_are_swappable": false, "observation_fn": null, "offline_data_class": null, "input_read_method": "read_parquet", "input_read_method_kwargs": {}, "input_read_schema": {}, "input_read_episodes": false, "input_read_sample_batches": false, "input_read_batch_size": null, "input_filesystem": null, "input_filesystem_kwargs": {}, "input_compress_columns": ["obs", "new_obs"], "input_spaces_jsonable": true, "materialize_data": false, "materialize_mapped_data": true, "map_batches_kwargs": {}, "iter_batches_kwargs": {}, "ignore_final_observation": false, "prelearner_class": null, "prelearner_buffer_class": null, "prelearner_buffer_kwargs": {}, "prelearner_module_synch_period": 10, "dataset_num_iters_per_learner": null, "input_config": {}, "actions_in_input_normalized": false, "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_config": {}, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "output_max_rows_per_file": null, "output_write_remaining_data": false, "output_write_method": "write_parquet", "output_write_method_kwargs": {}, "output_filesystem": null, "output_filesystem_kwargs": {}, "output_write_episodes": true, "offline_sampling": false, "evaluation_interval": 1, "evaluation_duration": 20, "evaluation_duration_unit": "episodes", "evaluation_sample_timeout_s": 120.0, "evaluation_auto_duration_min_env_steps_per_sample": 100, "evaluation_auto_duration_max_env_steps_per_sample": 2000, "evaluation_parallel_to_training": false, "evaluation_force_reset_envs_before_iteration": true, "evaluation_config": null, "off_policy_estimation_methods": {}, "ope_split_batch_by_episode": true, "evaluation_num_env_runners": 1, "in_evaluation": false, "sync_filters_on_rollout_workers_timeout_s": 10.0, "offline_evaluation_interval": null, "num_offline_eval_runners": 0, "offline_loss_for_module_fn": null, "offline_evaluation_duration": 1, "offline_evaluation_parallel_to_training": false, "offline_evaluation_timeout_s": 120.0, "num_cpus_per_offline_eval_runner": 1, "num_gpus_per_offline_eval_runner": 0, "custom_resources_per_offline_eval_runner": {}, "restart_failed_offline_eval_runners": true, "ignore_offline_eval_runner_failures": false, "max_num_offline_eval_runner_restarts": 1000, "offline_eval_runner_restore_timeout_s": 1800.0, "max_requests_in_flight_per_offline_eval_runner": 1, "validate_offline_eval_runners_after_construction": true, "offline_eval_runner_health_probe_timeout_s": 30.0, "offline_eval_rl_module_inference_only": false, "broadcast_offline_eval_runner_states": false, "offline_eval_batch_size_per_runner": 256, "dataset_num_iters_per_eval_runner": 1, "keep_per_episode_custom_metrics": false, "metrics_episode_collection_timeout_s": 60.0, "metrics_num_episodes_for_smoothing": 100, "min_time_s_per_iteration": null, "min_train_timesteps_per_iteration": 0, "min_sample_timesteps_per_iteration": 0, "log_gradients": true, "export_native_model_files": false, "checkpoint_trainable_policies_only": false, "logger_creator": null, "logger_config": null, "log_level": "WARN", "log_sys_usage": true, "fake_sampler": false, "seed": 5, "restart_failed_env_runners": true, "ignore_env_runner_failures": false, "max_num_env_runner_restarts": 1000, "delay_between_env_runner_restarts_s": 60.0, "restart_failed_sub_environments": false, "num_consecutive_env_runner_failures_tolerance": 100, "env_runner_health_probe_timeout_s": 30.0, "env_runner_restore_timeout_s": 1800.0, "_model_config": {}, "_rl_module_spec": "RLModuleSpec(module_class=None, observation_space=None, action_space=None, inference_only=False, learner_only=False, model_config=DefaultModelConfig(fcnet_hiddens=[60, 90], fcnet_activation='tanh', fcnet_kernel_initializer=None, fcnet_kernel_initializer_kwargs=None, fcnet_bias_initializer=None, fcnet_bias_initializer_kwargs=None, conv_filters=None, conv_activation='relu', conv_kernel_initializer=None, conv_kernel_initializer_kwargs=None, conv_bias_initializer=None, conv_bias_initializer_kwargs=None, head_fcnet_hiddens=[], head_fcnet_activation='relu', head_fcnet_kernel_initializer=None, head_fcnet_kernel_initializer_kwargs=None, head_fcnet_bias_initializer=None, head_fcnet_bias_initializer_kwargs=None, free_log_std=False, log_std_clip_param=20.0, vf_share_layers=True, use_lstm=False, max_seq_len=20, lstm_cell_size=256, lstm_use_prev_action=False, lstm_use_prev_reward=False, lstm_kernel_initializer=None, lstm_kernel_initializer_kwargs=None, lstm_bias_initializer=None, lstm_bias_initializer_kwargs=None), catalog_class=None, load_state_path=None, model_config_dict=None)", "algorithm_config_overrides_per_module": {}, "_per_module_overrides": {}, "_validate_config": true, "_use_msgpack_checkpoints": false, "_torch_grad_scaler_class": null, "_torch_lr_scheduler_classes": null, "_tf_policy_handles_more_than_one_loss": false, "_disable_preprocessor_api": false, "_disable_action_flattening": false, "_disable_initialize_loss_from_dummy_batch": false, "_dont_auto_sync_env_runner_states": false, "env_task_fn": -1, "enable_connectors": -1, "simple_optimizer": false, "policy_map_cache": -1, "worker_cls": -1, "synchronize_filters": -1, "enable_async_evaluation": -1, "custom_async_evaluation_function": -1, "_enable_rl_module_api": -1, "auto_wrap_old_gym_envs": -1, "always_attach_evaluation_results": -1, "replay_sequence_length": null, "_disable_execution_plan_api": -1, "use_critic": true, "use_gae": true, "use_kl_loss": true, "kl_coeff": 0.7464963036515, "kl_target": 0.0270990929592, "vf_loss_coeff": 0.6688075857018, "entropy_coeff": 0.0090570820258, "clip_param": 0.1221781641624, "vf_clip_param": 0.1027808522125, "entropy_coeff_schedule": null, "lr_schedule": null, "sgd_minibatch_size": -1, "vf_share_layers": -1, "__stdout_file__": null, "__stderr_file__": null, "lambda": 0.9099046732075, "input": "sampler", "policies": {"default_policy": [null, null, null, null]}, "callbacks": "<class 'ray.rllib.callbacks.callbacks.RLlibCallback'>", "create_env_on_driver": false, "custom_eval_function": null, "framework": "torch"}, "time_since_restore": 18.5024836063385, "iterations_since_restore": 7, "perf": {"cpu_util_percent": 67.36666666666666, "ram_util_percent": 77.30000000000001}}
{"timers": {"training_iteration": 2.518884670157803, "restore_env_runners": 1.2928078986405199e-05, "training_step": 2.5187328714129693, "env_runner_sampling_timer": 2.3612593302433558, "learner_update_timer": 0.15413805765970065, "synch_weights": 0.0006493567215120508, "restore_eval_env_runners": 8.989025098477317e-06, "evaluation_iteration": 0.1721698231653304, "synch_eval_env_connectors": 0.00013227312997429904, "synch_env_connectors": 5.437067042078715e-06}, "env_runners": {"weights_seq_no": 7.0, "episode_return_max": 6.5, "num_episodes": 250.0, "module_to_env_connector": {"timers": {"connectors": {"tensor_to_numpy": 2.1169505803842956e-05, "remove_single_ts_time_rank_from_batch": 8.647172360933063e-07, "listify_data_for_vector_env": 1.7026712105772877e-05, "get_actions": 6.823849723900102e-05, "normalize_and_clip_actions": 1.4186375231803133e-05, "un_batch_to_individual_items": 8.0849393258478e-06}}, "connector_pipeline_timer": 0.00016735146434641678}, "env_to_module_connector": {"timers": {"connectors": {"batch_individual_items": 1.001737862508778e-05, "add_time_dim_to_batch_and_zero_pad": 3.4880442876393114e-06, "numpy_to_tensor": 1.414356703336131e-05, "add_observations_from_episodes_to_batch": 4.496685406894411e-06, "add_states_from_episodes_to_batch": 2.4172380092463647e-06}}, "connector_pipeline_timer": 6.504541788956789e-05}, "agent_episode_returns_mean": {"default_agent": 0.26}, "env_to_module_sum_episodes_length_out": 10.36823839457432, "num_module_steps_sampled": {"default_policy": 5000.0}, "episode_return_min": -13.5, "time_between_sampling": 0.002356807040336661, "episode_len_min": 20, "episode_len_mean": 20.0, "episode_return_mean": 0.26, "episode_len_max": 20, "sample": 0.008076248414267207, "num_env_steps_sampled": 5000.0, "episode_duration_sec_mean": 0.00770727833919227, "env_to_module_sum_episodes_length_in": 10.36823839457432, "env_step_timer": 2.2288729379574083e-05, "num_module_steps_sampled_lifetime": {"default_policy": -3695000.0}, "num_episodes_lifetime": -184750.0, "num_env_steps_sampled_lifetime": -3695000.0, "num_agent_steps_sampled_lifetime": {"default_agent": -3695000.0}, "env_reset_timer": 6.556610629156445e-05, "rlmodule_inference_timer": 6.939380322962657e-05, "module_episode_returns_mean": {"default_policy": 0.26}, "num_agent_steps_sampled": {"default_agent": 5000.0}, "num_env_steps_sampled_lifetime_throughput": 2565.809021995838}, "learners": {"default_policy": {"vf_loss_unclipped": 26.320615768432617, "default_optimizer_learning_rate": 0.0002847858517, "module_train_batch_size_mean": 1000.0, "vf_loss": 0.10278083384037018, "entropy": 0.6119840741157532, "total_loss": -0.010954849421977997, "policy_loss": -0.0741666927933693, "vf_explained_var": -0.016090035438537598, "mean_kl_loss": 0.002404420170933008, "diff_num_grad_updates_vs_sampler_policy": 1.0, "gradients_default_optimizer_global_norm": 0.0506206676363945, "num_module_steps_trained_lifetime": 48000, "curr_entropy_coeff": 0.0090570820258, "num_module_steps_trained": 6000, "num_trainable_parameters": 6003, "curr_kl_coeff": 0.0029160012491047382, "weights_seq_no": 8.0, "num_module_steps_trained_lifetime_throughput": 220326.70889128922}, "__all_modules__": {"learner_connector": {"timers": {"connectors": {"add_observations_from_episodes_to_batch": 0.0008599212552125462, "general_advantage_estimation": 0.009763426722577353, "add_one_ts_to_episodes_and_truncate": 0.00826485255017554, "add_columns_from_episodes_to_train_batch": 0.03953753022207955, "numpy_to_tensor": 0.00013756426656370076, "add_states_from_episodes_to_batch": 3.7387245300041633e-06, "batch_individual_items": 0.05040786618790235, "add_time_dim_to_batch_and_zero_pad": 1.2403182278627933e-05}}, "connector_pipeline_timer": 0.10920974139384242}, "num_env_steps_trained": 31500, "num_env_steps_trained_lifetime": 252000, "num_module_steps_trained_lifetime": 48000, "learner_connector_sum_episodes_length_in": 5000.0, "num_trainable_parameters": 6003, "learner_connector_sum_episodes_length_out": 5250.0, "num_module_steps_trained": 6000, "num_non_trainable_parameters": 0, "num_env_steps_trained_lifetime_throughput": 1153448.3455501744, "num_module_steps_trained_throughput": 220186.5976632696, "num_module_steps_trained_lifetime_throughput": 219997.12423468084}}, "num_training_step_calls_per_iteration": 1, "evaluation": {"env_runners": {"module_to_env_connector": {"connector_pipeline_timer": 0.0001403527606821734, "timers": {"connectors": {"remove_single_ts_time_rank_from_batch": 7.601827643404835e-07, "listify_data_for_vector_env": 1.4376430957130024e-05, "normalize_and_clip_actions": 1.2825204426644534e-05, "get_actions": 5.313472288718358e-05, "tensor_to_numpy": 1.8484317285365984e-05, "un_batch_to_individual_items": 7.306510252207911e-06}}}, "num_episodes_lifetime": 160, "weights_seq_no": 8.0, "episode_return_max": 13.5, "num_env_steps_sampled": 400, "env_to_module_sum_episodes_length_in": 10.3682383945743, "env_to_module_connector": {"timers": {"connectors": {"add_observations_from_episodes_to_batch": 3.5560275411916016e-06, "numpy_to_tensor": 1.26285828269355e-05, "add_states_from_episodes_to_batch": 2.0454600258269857e-06, "batch_individual_items": 8.513752917971928e-06, "add_time_dim_to_batch_and_zero_pad": 2.8729658595097734e-06}}, "connector_pipeline_timer": 5.674807713652447e-05}, "env_to_module_sum_episodes_length_out": 10.3682383945743, "episode_len_max": 20, "episode_duration_sec_mean": 0.007624919932568446, "env_step_timer": 1.881088798306611e-05, "num_env_steps_sampled_lifetime": 40400, "rlmodule_inference_timer": 3.883097204802263e-05, "num_module_steps_sampled_lifetime": {"default_policy": 3200}, "num_agent_steps_sampled_lifetime": {"default_agent": 3200}, "num_agent_steps_sampled": {"default_agent": 400}, "episode_len_mean": 20.0, "episode_return_mean": -0.3, "agent_episode_returns_mean": {"default_agent": -0.3}, "num_module_steps_sampled": {"default_policy": 400}, "env_reset_timer": 0.00014564040223879543, "num_episodes": 20, "episode_return_min": -15.5, "module_episode_returns_mean": {"default_policy": -0.3}, "episode_len_min": 20, "sample": 0.16498957959257793, "time_between_sampling": 2.6006073532161254}, "num_healthy_workers": 1, "actor_manager_num_outstanding_async_reqs": 0, "num_remote_worker_restarts": 0}, "num_env_steps_sampled_lifetime": -3695000.0, "fault_tolerance": {"num_healthy_workers": 0, "num_remote_worker_restarts": 0}, "env_runner_group": {"actor_manager_num_outstanding_async_reqs": 0}, "done": false, "training_iteration": 8, "trial_id": "46b1a_00000", "date": "2025-08-11_19-34-33", "timestamp": 1754933673, "time_this_iter_s": 2.6038591861724854, "time_total_s": 21.106342792510986, "pid": 26849, "hostname": "Mac", "node_ip": "127.0.0.1", "config": {"exploration_config": {}, "extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "placement_strategy": "PACK", "num_gpus": 0, "_fake_gpus": false, "num_cpus_for_main_process": 2, "eager_tracing": true, "eager_max_retraces": 20, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "torch_compile_learner": false, "torch_compile_learner_what_to_compile": "forward_train", "torch_compile_learner_dynamo_backend": "aot_eager", "torch_compile_learner_dynamo_mode": null, "torch_compile_worker": false, "torch_compile_worker_dynamo_backend": "aot_eager", "torch_compile_worker_dynamo_mode": null, "torch_ddp_kwargs": {}, "torch_skip_nan_gradients": false, "env": "Umbrella", "env_config": {}, "observation_space": null, "action_space": null, "clip_rewards": null, "normalize_actions": true, "clip_actions": false, "_is_atari": null, "disable_env_checking": false, "render_env": false, "action_mask_key": "action_mask", "env_runner_cls": null, "num_env_runners": 0, "create_local_env_runner": true, "num_envs_per_env_runner": 1, "gym_env_vectorize_mode": "SYNC", "num_cpus_per_env_runner": 1, "num_gpus_per_env_runner": 0, "custom_resources_per_env_runner": {}, "validate_env_runners_after_construction": true, "episodes_to_numpy": true, "max_requests_in_flight_per_env_runner": 1, "sample_timeout_s": 60.0, "_env_to_module_connector": null, "add_default_connectors_to_env_to_module_pipeline": true, "_module_to_env_connector": null, "add_default_connectors_to_module_to_env_pipeline": true, "merge_env_runner_states": "training_only", "broadcast_env_runner_states": true, "episode_lookback_horizon": 1, "rollout_fragment_length": "auto", "batch_mode": "complete_episodes", "compress_observations": false, "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "enable_tf1_exec_eagerly": false, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "preprocessor_pref": "deepmind", "observation_filter": "NoFilter", "update_worker_filter_stats": true, "use_worker_filter_stats": true, "sampler_perf_stats_ema_coef": null, "_is_online": true, "num_learners": 0, "num_gpus_per_learner": 0, "num_cpus_per_learner": "auto", "num_aggregator_actors_per_learner": 0, "max_requests_in_flight_per_aggregator_actor": 3, "local_gpu_idx": 0, "max_requests_in_flight_per_learner": 3, "gamma": 1, "lr": 0.0002847858517, "grad_clip": 0.5, "grad_clip_by": "global_norm", "_train_batch_size_per_learner": 5000, "train_batch_size": 4000, "num_epochs": 1, "minibatch_size": 1000, "shuffle_batch_per_epoch": true, "model": {"fcnet_hiddens": [256, 256], "fcnet_activation": "tanh", "fcnet_weights_initializer": null, "fcnet_weights_initializer_config": null, "fcnet_bias_initializer": null, "fcnet_bias_initializer_config": null, "conv_filters": null, "conv_activation": "relu", "conv_kernel_initializer": null, "conv_kernel_initializer_config": null, "conv_bias_initializer": null, "conv_bias_initializer_config": null, "conv_transpose_kernel_initializer": null, "conv_transpose_kernel_initializer_config": null, "conv_transpose_bias_initializer": null, "conv_transpose_bias_initializer_config": null, "post_fcnet_hiddens": [], "post_fcnet_activation": "relu", "post_fcnet_weights_initializer": null, "post_fcnet_weights_initializer_config": null, "post_fcnet_bias_initializer": null, "post_fcnet_bias_initializer_config": null, "free_log_std": false, "log_std_clip_param": 20.0, "no_final_linear": false, "vf_share_layers": false, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "lstm_weights_initializer": null, "lstm_weights_initializer_config": null, "lstm_bias_initializer": null, "lstm_bias_initializer_config": null, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "attention_use_n_prev_actions": 0, "attention_use_n_prev_rewards": 0, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": null, "custom_model_config": {}, "custom_action_dist": null, "custom_preprocessor": null, "encoder_latent_dim": null, "always_check_shapes": false, "lstm_use_prev_action_reward": -1, "_use_default_native_models": -1, "_disable_preprocessor_api": false, "_disable_action_flattening": false}, "_learner_connector": null, "add_default_connectors_to_learner_pipeline": true, "learner_config_dict": {}, "optimizer": {}, "_learner_class": null, "callbacks_on_algorithm_init": null, "callbacks_on_env_runners_recreated": null, "callbacks_on_offline_eval_runners_recreated": null, "callbacks_on_checkpoint_loaded": null, "callbacks_on_environment_created": null, "callbacks_on_episode_created": null, "callbacks_on_episode_start": null, "callbacks_on_episode_step": null, "callbacks_on_episode_end": null, "callbacks_on_evaluate_start": null, "callbacks_on_evaluate_end": null, "callbacks_on_evaluate_offline_start": null, "callbacks_on_evaluate_offline_end": null, "callbacks_on_sample_end": null, "callbacks_on_train_result": null, "explore": true, "enable_rl_module_and_learner": true, "enable_env_runner_and_connector_v2": true, "_prior_exploration_config": {"type": "StochasticSampling"}, "count_steps_by": "env_steps", "policy_map_capacity": 100, "policy_mapping_fn": "<function AlgorithmConfig.DEFAULT_POLICY_MAPPING_FN at 0x13bfddb20>", "policies_to_train": null, "policy_states_are_swappable": false, "observation_fn": null, "offline_data_class": null, "input_read_method": "read_parquet", "input_read_method_kwargs": {}, "input_read_schema": {}, "input_read_episodes": false, "input_read_sample_batches": false, "input_read_batch_size": null, "input_filesystem": null, "input_filesystem_kwargs": {}, "input_compress_columns": ["obs", "new_obs"], "input_spaces_jsonable": true, "materialize_data": false, "materialize_mapped_data": true, "map_batches_kwargs": {}, "iter_batches_kwargs": {}, "ignore_final_observation": false, "prelearner_class": null, "prelearner_buffer_class": null, "prelearner_buffer_kwargs": {}, "prelearner_module_synch_period": 10, "dataset_num_iters_per_learner": null, "input_config": {}, "actions_in_input_normalized": false, "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_config": {}, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "output_max_rows_per_file": null, "output_write_remaining_data": false, "output_write_method": "write_parquet", "output_write_method_kwargs": {}, "output_filesystem": null, "output_filesystem_kwargs": {}, "output_write_episodes": true, "offline_sampling": false, "evaluation_interval": 1, "evaluation_duration": 20, "evaluation_duration_unit": "episodes", "evaluation_sample_timeout_s": 120.0, "evaluation_auto_duration_min_env_steps_per_sample": 100, "evaluation_auto_duration_max_env_steps_per_sample": 2000, "evaluation_parallel_to_training": false, "evaluation_force_reset_envs_before_iteration": true, "evaluation_config": null, "off_policy_estimation_methods": {}, "ope_split_batch_by_episode": true, "evaluation_num_env_runners": 1, "in_evaluation": false, "sync_filters_on_rollout_workers_timeout_s": 10.0, "offline_evaluation_interval": null, "num_offline_eval_runners": 0, "offline_loss_for_module_fn": null, "offline_evaluation_duration": 1, "offline_evaluation_parallel_to_training": false, "offline_evaluation_timeout_s": 120.0, "num_cpus_per_offline_eval_runner": 1, "num_gpus_per_offline_eval_runner": 0, "custom_resources_per_offline_eval_runner": {}, "restart_failed_offline_eval_runners": true, "ignore_offline_eval_runner_failures": false, "max_num_offline_eval_runner_restarts": 1000, "offline_eval_runner_restore_timeout_s": 1800.0, "max_requests_in_flight_per_offline_eval_runner": 1, "validate_offline_eval_runners_after_construction": true, "offline_eval_runner_health_probe_timeout_s": 30.0, "offline_eval_rl_module_inference_only": false, "broadcast_offline_eval_runner_states": false, "offline_eval_batch_size_per_runner": 256, "dataset_num_iters_per_eval_runner": 1, "keep_per_episode_custom_metrics": false, "metrics_episode_collection_timeout_s": 60.0, "metrics_num_episodes_for_smoothing": 100, "min_time_s_per_iteration": null, "min_train_timesteps_per_iteration": 0, "min_sample_timesteps_per_iteration": 0, "log_gradients": true, "export_native_model_files": false, "checkpoint_trainable_policies_only": false, "logger_creator": null, "logger_config": null, "log_level": "WARN", "log_sys_usage": true, "fake_sampler": false, "seed": 5, "restart_failed_env_runners": true, "ignore_env_runner_failures": false, "max_num_env_runner_restarts": 1000, "delay_between_env_runner_restarts_s": 60.0, "restart_failed_sub_environments": false, "num_consecutive_env_runner_failures_tolerance": 100, "env_runner_health_probe_timeout_s": 30.0, "env_runner_restore_timeout_s": 1800.0, "_model_config": {}, "_rl_module_spec": "RLModuleSpec(module_class=None, observation_space=None, action_space=None, inference_only=False, learner_only=False, model_config=DefaultModelConfig(fcnet_hiddens=[60, 90], fcnet_activation='tanh', fcnet_kernel_initializer=None, fcnet_kernel_initializer_kwargs=None, fcnet_bias_initializer=None, fcnet_bias_initializer_kwargs=None, conv_filters=None, conv_activation='relu', conv_kernel_initializer=None, conv_kernel_initializer_kwargs=None, conv_bias_initializer=None, conv_bias_initializer_kwargs=None, head_fcnet_hiddens=[], head_fcnet_activation='relu', head_fcnet_kernel_initializer=None, head_fcnet_kernel_initializer_kwargs=None, head_fcnet_bias_initializer=None, head_fcnet_bias_initializer_kwargs=None, free_log_std=False, log_std_clip_param=20.0, vf_share_layers=True, use_lstm=False, max_seq_len=20, lstm_cell_size=256, lstm_use_prev_action=False, lstm_use_prev_reward=False, lstm_kernel_initializer=None, lstm_kernel_initializer_kwargs=None, lstm_bias_initializer=None, lstm_bias_initializer_kwargs=None), catalog_class=None, load_state_path=None, model_config_dict=None)", "algorithm_config_overrides_per_module": {}, "_per_module_overrides": {}, "_validate_config": true, "_use_msgpack_checkpoints": false, "_torch_grad_scaler_class": null, "_torch_lr_scheduler_classes": null, "_tf_policy_handles_more_than_one_loss": false, "_disable_preprocessor_api": false, "_disable_action_flattening": false, "_disable_initialize_loss_from_dummy_batch": false, "_dont_auto_sync_env_runner_states": false, "env_task_fn": -1, "enable_connectors": -1, "simple_optimizer": false, "policy_map_cache": -1, "worker_cls": -1, "synchronize_filters": -1, "enable_async_evaluation": -1, "custom_async_evaluation_function": -1, "_enable_rl_module_api": -1, "auto_wrap_old_gym_envs": -1, "always_attach_evaluation_results": -1, "replay_sequence_length": null, "_disable_execution_plan_api": -1, "use_critic": true, "use_gae": true, "use_kl_loss": true, "kl_coeff": 0.7464963036515, "kl_target": 0.0270990929592, "vf_loss_coeff": 0.6688075857018, "entropy_coeff": 0.0090570820258, "clip_param": 0.1221781641624, "vf_clip_param": 0.1027808522125, "entropy_coeff_schedule": null, "lr_schedule": null, "sgd_minibatch_size": -1, "vf_share_layers": -1, "__stdout_file__": null, "__stderr_file__": null, "lambda": 0.9099046732075, "input": "sampler", "policies": {"default_policy": [null, null, null, null]}, "callbacks": "<class 'ray.rllib.callbacks.callbacks.RLlibCallback'>", "create_env_on_driver": false, "custom_eval_function": null, "framework": "torch"}, "time_since_restore": 21.106342792510986, "iterations_since_restore": 8, "perf": {"cpu_util_percent": 68.0, "ram_util_percent": 77.2}}
{"timers": {"training_iteration": 2.525816452205478, "restore_env_runners": 1.2856707834230738e-05, "training_step": 2.5256641610288266, "env_runner_sampling_timer": 2.36604781903149, "learner_update_timer": 0.15627860625279202, "synch_weights": 0.0006503202343612717, "restore_eval_env_runners": 8.984554589883058e-06, "evaluation_iteration": 0.17212725326294667, "synch_eval_env_connectors": 0.00013442456831815186, "synch_env_connectors": 5.4310261925143806e-06}, "env_runners": {"weights_seq_no": 8.0, "episode_return_max": 6.5, "num_episodes": 250.0, "module_to_env_connector": {"timers": {"connectors": {"tensor_to_numpy": 2.7366759769459432e-05, "remove_single_ts_time_rank_from_batch": 1.0392450707841701e-06, "listify_data_for_vector_env": 2.052738456935015e-05, "get_actions": 9.181204624788938e-05, "normalize_and_clip_actions": 1.9278264203026225e-05, "un_batch_to_individual_items": 2.755515483612342e-05}}, "connector_pipeline_timer": 0.0002338330104480158}, "env_to_module_connector": {"timers": {"connectors": {"batch_individual_items": 1.3619604834437891e-05, "add_time_dim_to_batch_and_zero_pad": 4.7348727207035645e-06, "numpy_to_tensor": 1.849301380474476e-05, "add_observations_from_episodes_to_batch": 5.506378816301014e-06, "add_states_from_episodes_to_batch": 2.8813346900874804e-06}}, "connector_pipeline_timer": 8.165104489922994e-05}, "agent_episode_returns_mean": {"default_agent": 1.8600000000000003}, "env_to_module_sum_episodes_length_out": 10.36823839457432, "num_module_steps_sampled": {"default_policy": 5000.0}, "episode_return_min": -13.5, "time_between_sampling": 0.002398957873015073, "episode_len_min": 20, "episode_len_mean": 20.0, "episode_return_mean": 1.8600000000000003, "episode_len_max": 20, "sample": 0.00984701016078772, "num_env_steps_sampled": 5000.0, "episode_duration_sec_mean": 0.009586895325221124, "env_to_module_sum_episodes_length_in": 10.36823839457432, "env_step_timer": 2.9455839431574773e-05, "num_module_steps_sampled_lifetime": {"default_policy": -4312500.0}, "num_episodes_lifetime": -215625.0, "num_env_steps_sampled_lifetime": -4312500.0, "num_agent_steps_sampled_lifetime": {"default_agent": -4312500.0}, "env_reset_timer": 7.748083466602108e-05, "rlmodule_inference_timer": 5.990499223215322e-05, "module_episode_returns_mean": {"default_policy": 1.8600000000000003}, "num_agent_steps_sampled": {"default_agent": 5000.0}, "num_env_steps_sampled_lifetime_throughput": 2238.8154671752186}, "learners": {"default_policy": {"vf_loss_unclipped": 26.345033645629883, "default_optimizer_learning_rate": 0.0002847858517, "module_train_batch_size_mean": 1000.0, "vf_loss": 0.10278083384037018, "entropy": 0.5902684926986694, "total_loss": 0.13819031417369843, "policy_loss": 0.07479322701692581, "vf_explained_var": -0.01631009578704834, "mean_kl_loss": 0.0008853764156810939, "diff_num_grad_updates_vs_sampler_policy": 1.0, "gradients_default_optimizer_global_norm": 0.02396991103887558, "num_module_steps_trained_lifetime": 54000, "curr_entropy_coeff": 0.0090570820258, "num_module_steps_trained": 6000, "num_trainable_parameters": 6003, "curr_kl_coeff": 0.0014580006245523691, "weights_seq_no": 9.0, "num_module_steps_trained_lifetime_throughput": 222889.23898606136}, "__all_modules__": {"learner_connector": {"timers": {"connectors": {"add_observations_from_episodes_to_batch": 0.0008644545431226548, "general_advantage_estimation": 0.009762644535083922, "add_one_ts_to_episodes_and_truncate": 0.010727934024802753, "add_columns_from_episodes_to_train_batch": 0.03956723450002234, "numpy_to_tensor": 0.00013776528433184787, "add_states_from_episodes_to_batch": 3.7367566463699666e-06, "batch_individual_items": 0.050301318776515065, "add_time_dim_to_batch_and_zero_pad": 1.2394990685978763e-05}}, "connector_pipeline_timer": 0.1115994810707073}, "num_env_steps_trained": 31500, "num_env_steps_trained_lifetime": 283500, "num_module_steps_trained_lifetime": 54000, "learner_connector_sum_episodes_length_in": 5000.0, "num_trainable_parameters": 6003, "learner_connector_sum_episodes_length_out": 5250.0, "num_module_steps_trained": 6000, "num_non_trainable_parameters": 0, "num_env_steps_trained_lifetime_throughput": 1167148.187256933, "num_module_steps_trained_throughput": 222775.75142523815, "num_module_steps_trained_lifetime_throughput": 222589.79479138838}}, "num_training_step_calls_per_iteration": 1, "evaluation": {"env_runners": {"module_to_env_connector": {"connector_pipeline_timer": 0.00017470820710129633, "timers": {"connectors": {"remove_single_ts_time_rank_from_batch": 8.300375671839132e-07, "listify_data_for_vector_env": 1.7909813250406417e-05, "normalize_and_clip_actions": 1.5788534774812404e-05, "get_actions": 6.980053655577415e-05, "tensor_to_numpy": 2.2221340082335858e-05, "un_batch_to_individual_items": 8.57174395511517e-06}}}, "num_episodes_lifetime": 180, "weights_seq_no": 9.0, "episode_return_max": 13.5, "num_env_steps_sampled": 400, "env_to_module_sum_episodes_length_in": 10.368238394574323, "env_to_module_connector": {"timers": {"connectors": {"add_observations_from_episodes_to_batch": 4.412179499768926e-06, "numpy_to_tensor": 1.609812331174291e-05, "add_states_from_episodes_to_batch": 2.5911309240988966e-06, "batch_individual_items": 1.116044166344123e-05, "add_time_dim_to_batch_and_zero_pad": 4.242880854158964e-06}}, "connector_pipeline_timer": 7.052783745146448e-05}, "env_to_module_sum_episodes_length_out": 10.368238394574323, "episode_len_max": 20, "episode_duration_sec_mean": 0.007695020750397816, "env_step_timer": 2.7924058252596075e-05, "num_env_steps_sampled_lifetime": 45400, "rlmodule_inference_timer": 5.185014136576157e-05, "num_module_steps_sampled_lifetime": {"default_policy": 3600}, "num_agent_steps_sampled_lifetime": {"default_agent": 3600}, "num_agent_steps_sampled": {"default_agent": 400}, "episode_len_mean": 20.0, "episode_return_mean": -0.5, "agent_episode_returns_mean": {"default_agent": -0.5}, "num_module_steps_sampled": {"default_policy": 400}, "env_reset_timer": 0.00014734691752726035, "num_episodes": 20, "episode_return_min": -15.5, "module_episode_returns_mean": {"default_policy": -0.5}, "episode_len_min": 20, "sample": 0.16518641670714182, "time_between_sampling": 2.6069766455137575}, "num_healthy_workers": 1, "actor_manager_num_outstanding_async_reqs": 0, "num_remote_worker_restarts": 0}, "num_env_steps_sampled_lifetime": -4312500.0, "fault_tolerance": {"num_healthy_workers": 0, "num_remote_worker_restarts": 0}, "env_runner_group": {"actor_manager_num_outstanding_async_reqs": 0}, "done": false, "training_iteration": 9, "trial_id": "46b1a_00000", "date": "2025-08-11_19-34-36", "timestamp": 1754933676, "time_this_iter_s": 3.40962815284729, "time_total_s": 24.515970945358276, "pid": 26849, "hostname": "Mac", "node_ip": "127.0.0.1", "config": {"exploration_config": {}, "extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "placement_strategy": "PACK", "num_gpus": 0, "_fake_gpus": false, "num_cpus_for_main_process": 2, "eager_tracing": true, "eager_max_retraces": 20, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "torch_compile_learner": false, "torch_compile_learner_what_to_compile": "forward_train", "torch_compile_learner_dynamo_backend": "aot_eager", "torch_compile_learner_dynamo_mode": null, "torch_compile_worker": false, "torch_compile_worker_dynamo_backend": "aot_eager", "torch_compile_worker_dynamo_mode": null, "torch_ddp_kwargs": {}, "torch_skip_nan_gradients": false, "env": "Umbrella", "env_config": {}, "observation_space": null, "action_space": null, "clip_rewards": null, "normalize_actions": true, "clip_actions": false, "_is_atari": null, "disable_env_checking": false, "render_env": false, "action_mask_key": "action_mask", "env_runner_cls": null, "num_env_runners": 0, "create_local_env_runner": true, "num_envs_per_env_runner": 1, "gym_env_vectorize_mode": "SYNC", "num_cpus_per_env_runner": 1, "num_gpus_per_env_runner": 0, "custom_resources_per_env_runner": {}, "validate_env_runners_after_construction": true, "episodes_to_numpy": true, "max_requests_in_flight_per_env_runner": 1, "sample_timeout_s": 60.0, "_env_to_module_connector": null, "add_default_connectors_to_env_to_module_pipeline": true, "_module_to_env_connector": null, "add_default_connectors_to_module_to_env_pipeline": true, "merge_env_runner_states": "training_only", "broadcast_env_runner_states": true, "episode_lookback_horizon": 1, "rollout_fragment_length": "auto", "batch_mode": "complete_episodes", "compress_observations": false, "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "enable_tf1_exec_eagerly": false, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "preprocessor_pref": "deepmind", "observation_filter": "NoFilter", "update_worker_filter_stats": true, "use_worker_filter_stats": true, "sampler_perf_stats_ema_coef": null, "_is_online": true, "num_learners": 0, "num_gpus_per_learner": 0, "num_cpus_per_learner": "auto", "num_aggregator_actors_per_learner": 0, "max_requests_in_flight_per_aggregator_actor": 3, "local_gpu_idx": 0, "max_requests_in_flight_per_learner": 3, "gamma": 1, "lr": 0.0002847858517, "grad_clip": 0.5, "grad_clip_by": "global_norm", "_train_batch_size_per_learner": 5000, "train_batch_size": 4000, "num_epochs": 1, "minibatch_size": 1000, "shuffle_batch_per_epoch": true, "model": {"fcnet_hiddens": [256, 256], "fcnet_activation": "tanh", "fcnet_weights_initializer": null, "fcnet_weights_initializer_config": null, "fcnet_bias_initializer": null, "fcnet_bias_initializer_config": null, "conv_filters": null, "conv_activation": "relu", "conv_kernel_initializer": null, "conv_kernel_initializer_config": null, "conv_bias_initializer": null, "conv_bias_initializer_config": null, "conv_transpose_kernel_initializer": null, "conv_transpose_kernel_initializer_config": null, "conv_transpose_bias_initializer": null, "conv_transpose_bias_initializer_config": null, "post_fcnet_hiddens": [], "post_fcnet_activation": "relu", "post_fcnet_weights_initializer": null, "post_fcnet_weights_initializer_config": null, "post_fcnet_bias_initializer": null, "post_fcnet_bias_initializer_config": null, "free_log_std": false, "log_std_clip_param": 20.0, "no_final_linear": false, "vf_share_layers": false, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "lstm_weights_initializer": null, "lstm_weights_initializer_config": null, "lstm_bias_initializer": null, "lstm_bias_initializer_config": null, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "attention_use_n_prev_actions": 0, "attention_use_n_prev_rewards": 0, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": null, "custom_model_config": {}, "custom_action_dist": null, "custom_preprocessor": null, "encoder_latent_dim": null, "always_check_shapes": false, "lstm_use_prev_action_reward": -1, "_use_default_native_models": -1, "_disable_preprocessor_api": false, "_disable_action_flattening": false}, "_learner_connector": null, "add_default_connectors_to_learner_pipeline": true, "learner_config_dict": {}, "optimizer": {}, "_learner_class": null, "callbacks_on_algorithm_init": null, "callbacks_on_env_runners_recreated": null, "callbacks_on_offline_eval_runners_recreated": null, "callbacks_on_checkpoint_loaded": null, "callbacks_on_environment_created": null, "callbacks_on_episode_created": null, "callbacks_on_episode_start": null, "callbacks_on_episode_step": null, "callbacks_on_episode_end": null, "callbacks_on_evaluate_start": null, "callbacks_on_evaluate_end": null, "callbacks_on_evaluate_offline_start": null, "callbacks_on_evaluate_offline_end": null, "callbacks_on_sample_end": null, "callbacks_on_train_result": null, "explore": true, "enable_rl_module_and_learner": true, "enable_env_runner_and_connector_v2": true, "_prior_exploration_config": {"type": "StochasticSampling"}, "count_steps_by": "env_steps", "policy_map_capacity": 100, "policy_mapping_fn": "<function AlgorithmConfig.DEFAULT_POLICY_MAPPING_FN at 0x13bfddb20>", "policies_to_train": null, "policy_states_are_swappable": false, "observation_fn": null, "offline_data_class": null, "input_read_method": "read_parquet", "input_read_method_kwargs": {}, "input_read_schema": {}, "input_read_episodes": false, "input_read_sample_batches": false, "input_read_batch_size": null, "input_filesystem": null, "input_filesystem_kwargs": {}, "input_compress_columns": ["obs", "new_obs"], "input_spaces_jsonable": true, "materialize_data": false, "materialize_mapped_data": true, "map_batches_kwargs": {}, "iter_batches_kwargs": {}, "ignore_final_observation": false, "prelearner_class": null, "prelearner_buffer_class": null, "prelearner_buffer_kwargs": {}, "prelearner_module_synch_period": 10, "dataset_num_iters_per_learner": null, "input_config": {}, "actions_in_input_normalized": false, "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_config": {}, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "output_max_rows_per_file": null, "output_write_remaining_data": false, "output_write_method": "write_parquet", "output_write_method_kwargs": {}, "output_filesystem": null, "output_filesystem_kwargs": {}, "output_write_episodes": true, "offline_sampling": false, "evaluation_interval": 1, "evaluation_duration": 20, "evaluation_duration_unit": "episodes", "evaluation_sample_timeout_s": 120.0, "evaluation_auto_duration_min_env_steps_per_sample": 100, "evaluation_auto_duration_max_env_steps_per_sample": 2000, "evaluation_parallel_to_training": false, "evaluation_force_reset_envs_before_iteration": true, "evaluation_config": null, "off_policy_estimation_methods": {}, "ope_split_batch_by_episode": true, "evaluation_num_env_runners": 1, "in_evaluation": false, "sync_filters_on_rollout_workers_timeout_s": 10.0, "offline_evaluation_interval": null, "num_offline_eval_runners": 0, "offline_loss_for_module_fn": null, "offline_evaluation_duration": 1, "offline_evaluation_parallel_to_training": false, "offline_evaluation_timeout_s": 120.0, "num_cpus_per_offline_eval_runner": 1, "num_gpus_per_offline_eval_runner": 0, "custom_resources_per_offline_eval_runner": {}, "restart_failed_offline_eval_runners": true, "ignore_offline_eval_runner_failures": false, "max_num_offline_eval_runner_restarts": 1000, "offline_eval_runner_restore_timeout_s": 1800.0, "max_requests_in_flight_per_offline_eval_runner": 1, "validate_offline_eval_runners_after_construction": true, "offline_eval_runner_health_probe_timeout_s": 30.0, "offline_eval_rl_module_inference_only": false, "broadcast_offline_eval_runner_states": false, "offline_eval_batch_size_per_runner": 256, "dataset_num_iters_per_eval_runner": 1, "keep_per_episode_custom_metrics": false, "metrics_episode_collection_timeout_s": 60.0, "metrics_num_episodes_for_smoothing": 100, "min_time_s_per_iteration": null, "min_train_timesteps_per_iteration": 0, "min_sample_timesteps_per_iteration": 0, "log_gradients": true, "export_native_model_files": false, "checkpoint_trainable_policies_only": false, "logger_creator": null, "logger_config": null, "log_level": "WARN", "log_sys_usage": true, "fake_sampler": false, "seed": 5, "restart_failed_env_runners": true, "ignore_env_runner_failures": false, "max_num_env_runner_restarts": 1000, "delay_between_env_runner_restarts_s": 60.0, "restart_failed_sub_environments": false, "num_consecutive_env_runner_failures_tolerance": 100, "env_runner_health_probe_timeout_s": 30.0, "env_runner_restore_timeout_s": 1800.0, "_model_config": {}, "_rl_module_spec": "RLModuleSpec(module_class=None, observation_space=None, action_space=None, inference_only=False, learner_only=False, model_config=DefaultModelConfig(fcnet_hiddens=[60, 90], fcnet_activation='tanh', fcnet_kernel_initializer=None, fcnet_kernel_initializer_kwargs=None, fcnet_bias_initializer=None, fcnet_bias_initializer_kwargs=None, conv_filters=None, conv_activation='relu', conv_kernel_initializer=None, conv_kernel_initializer_kwargs=None, conv_bias_initializer=None, conv_bias_initializer_kwargs=None, head_fcnet_hiddens=[], head_fcnet_activation='relu', head_fcnet_kernel_initializer=None, head_fcnet_kernel_initializer_kwargs=None, head_fcnet_bias_initializer=None, head_fcnet_bias_initializer_kwargs=None, free_log_std=False, log_std_clip_param=20.0, vf_share_layers=True, use_lstm=False, max_seq_len=20, lstm_cell_size=256, lstm_use_prev_action=False, lstm_use_prev_reward=False, lstm_kernel_initializer=None, lstm_kernel_initializer_kwargs=None, lstm_bias_initializer=None, lstm_bias_initializer_kwargs=None), catalog_class=None, load_state_path=None, model_config_dict=None)", "algorithm_config_overrides_per_module": {}, "_per_module_overrides": {}, "_validate_config": true, "_use_msgpack_checkpoints": false, "_torch_grad_scaler_class": null, "_torch_lr_scheduler_classes": null, "_tf_policy_handles_more_than_one_loss": false, "_disable_preprocessor_api": false, "_disable_action_flattening": false, "_disable_initialize_loss_from_dummy_batch": false, "_dont_auto_sync_env_runner_states": false, "env_task_fn": -1, "enable_connectors": -1, "simple_optimizer": false, "policy_map_cache": -1, "worker_cls": -1, "synchronize_filters": -1, "enable_async_evaluation": -1, "custom_async_evaluation_function": -1, "_enable_rl_module_api": -1, "auto_wrap_old_gym_envs": -1, "always_attach_evaluation_results": -1, "replay_sequence_length": null, "_disable_execution_plan_api": -1, "use_critic": true, "use_gae": true, "use_kl_loss": true, "kl_coeff": 0.7464963036515, "kl_target": 0.0270990929592, "vf_loss_coeff": 0.6688075857018, "entropy_coeff": 0.0090570820258, "clip_param": 0.1221781641624, "vf_clip_param": 0.1027808522125, "entropy_coeff_schedule": null, "lr_schedule": null, "sgd_minibatch_size": -1, "vf_share_layers": -1, "__stdout_file__": null, "__stderr_file__": null, "lambda": 0.9099046732075, "input": "sampler", "policies": {"default_policy": [null, null, null, null]}, "callbacks": "<class 'ray.rllib.callbacks.callbacks.RLlibCallback'>", "create_env_on_driver": false, "custom_eval_function": null, "framework": "torch"}, "time_since_restore": 24.515970945358276, "iterations_since_restore": 9, "perf": {"cpu_util_percent": 73.3, "ram_util_percent": 79.86000000000001}}
{"timers": {"training_iteration": 2.5274059289337747, "restore_env_runners": 1.279188978612086e-05, "training_step": 2.527252984008544, "env_runner_sampling_timer": 2.366429537510791, "learner_update_timer": 0.15746269769058582, "synch_weights": 0.0006563403718461353, "restore_eval_env_runners": 9.035959246416501e-06, "evaluation_iteration": 0.1723596419800349, "synch_eval_env_connectors": 0.00013405240337791065, "synch_env_connectors": 5.417135330327548e-06}, "env_runners": {"weights_seq_no": 9.0, "episode_return_max": 6.5, "num_episodes": 250.0, "module_to_env_connector": {"timers": {"connectors": {"tensor_to_numpy": 2.3959007709884423e-05, "remove_single_ts_time_rank_from_batch": 9.375227501572762e-07, "listify_data_for_vector_env": 1.837719015787493e-05, "get_actions": 7.669558634612343e-05, "normalize_and_clip_actions": 1.6069563717224103e-05, "un_batch_to_individual_items": 8.688348260034138e-06}}, "connector_pipeline_timer": 0.00018631512416245226}, "env_to_module_connector": {"timers": {"connectors": {"batch_individual_items": 1.1162664783404527e-05, "add_time_dim_to_batch_and_zero_pad": 3.973917667987711e-06, "numpy_to_tensor": 1.6566385826643706e-05, "add_observations_from_episodes_to_batch": 4.827093091535728e-06, "add_states_from_episodes_to_batch": 2.814139535250628e-06}}, "connector_pipeline_timer": 7.255573049641456e-05}, "agent_episode_returns_mean": {"default_agent": 2.1}, "env_to_module_sum_episodes_length_out": 10.36823839457432, "num_module_steps_sampled": {"default_policy": 5000.0}, "episode_return_min": -13.5, "time_between_sampling": 0.0033376271756426733, "episode_len_min": 20, "episode_len_mean": 20.0, "episode_return_mean": 2.1, "episode_len_max": 20, "sample": 0.008854769905851734, "num_env_steps_sampled": 5000.0, "episode_duration_sec_mean": 0.00802516599372029, "env_to_module_sum_episodes_length_in": 10.36823839457432, "env_step_timer": 2.4887227494912683e-05, "num_module_steps_sampled_lifetime": {"default_policy": -4930000.0}, "num_episodes_lifetime": -246500.0, "num_env_steps_sampled_lifetime": -4930000.0, "num_agent_steps_sampled_lifetime": {"default_agent": -4930000.0}, "env_reset_timer": 7.446224764130008e-05, "rlmodule_inference_timer": 5.06324429631263e-05, "module_episode_returns_mean": {"default_policy": 2.1}, "num_agent_steps_sampled": {"default_agent": 5000.0}, "num_env_steps_sampled_lifetime_throughput": 2379.6685784752594}, "learners": {"default_policy": {"vf_loss_unclipped": 26.331432342529297, "default_optimizer_learning_rate": 0.0002847858517, "module_train_batch_size_mean": 1000.0, "vf_loss": 0.10278083384037018, "entropy": 0.5677953362464905, "total_loss": 0.14046528935432434, "policy_loss": 0.07686588913202286, "vf_explained_var": -0.016974687576293945, "mean_kl_loss": 0.0009531740797683597, "diff_num_grad_updates_vs_sampler_policy": 1.0, "gradients_default_optimizer_global_norm": 0.14334608614444733, "num_module_steps_trained_lifetime": 60000, "curr_entropy_coeff": 0.0090570820258, "num_module_steps_trained": 6000, "num_trainable_parameters": 6003, "curr_kl_coeff": 0.0007290003122761846, "weights_seq_no": 10.0, "num_module_steps_trained_lifetime_throughput": 223924.47927263766}, "__all_modules__": {"learner_connector": {"timers": {"connectors": {"add_observations_from_episodes_to_batch": 0.000865145416854536, "general_advantage_estimation": 0.009749465169304047, "add_one_ts_to_episodes_and_truncate": 0.010722171764884084, "add_columns_from_episodes_to_train_batch": 0.03957866507560277, "numpy_to_tensor": 0.00013779888088398927, "add_states_from_episodes_to_batch": 3.7681393123643816e-06, "batch_individual_items": 0.05160563183829535, "add_time_dim_to_batch_and_zero_pad": 1.2509789977734527e-05}}, "connector_pipeline_timer": 0.11289706959034464}, "num_env_steps_trained": 31500, "num_env_steps_trained_lifetime": 315000, "num_module_steps_trained_lifetime": 60000, "learner_connector_sum_episodes_length_in": 5000.0, "num_trainable_parameters": 6003, "learner_connector_sum_episodes_length_out": 5250.0, "num_module_steps_trained": 6000, "num_non_trainable_parameters": 0, "num_env_steps_trained_lifetime_throughput": 1172820.0193600953, "num_module_steps_trained_throughput": 223833.5552404913, "num_module_steps_trained_lifetime_throughput": 223651.2549789001}}, "num_training_step_calls_per_iteration": 1, "evaluation": {"env_runners": {"module_to_env_connector": {"connector_pipeline_timer": 0.00012255828966000707, "timers": {"connectors": {"remove_single_ts_time_rank_from_batch": 6.346231604974227e-07, "listify_data_for_vector_env": 1.2560317249328199e-05, "normalize_and_clip_actions": 1.1124418911098066e-05, "get_actions": 4.618414221558527e-05, "tensor_to_numpy": 1.6236492842205314e-05, "un_batch_to_individual_items": 6.162457600202454e-06}}}, "num_episodes_lifetime": 200, "weights_seq_no": 10.0, "episode_return_max": 13.5, "num_env_steps_sampled": 400, "env_to_module_sum_episodes_length_in": 10.368238394574323, "env_to_module_connector": {"timers": {"connectors": {"add_observations_from_episodes_to_batch": 3.1734709319845635e-06, "numpy_to_tensor": 1.0317359681885016e-05, "add_states_from_episodes_to_batch": 1.717438357007417e-06, "batch_individual_items": 7.648198304647961e-06, "add_time_dim_to_batch_and_zero_pad": 2.4450492526486555e-06}}, "connector_pipeline_timer": 4.929541747914008e-05}, "env_to_module_sum_episodes_length_out": 10.368238394574323, "episode_len_max": 20, "episode_duration_sec_mean": 0.007544688278576359, "env_step_timer": 1.7076705386571904e-05, "num_env_steps_sampled_lifetime": 50400, "rlmodule_inference_timer": 3.254094085207708e-05, "num_module_steps_sampled_lifetime": {"default_policy": 4000}, "num_agent_steps_sampled_lifetime": {"default_agent": 4000}, "num_agent_steps_sampled": {"default_agent": 400}, "episode_len_mean": 20.0, "episode_return_mean": -0.3, "agent_episode_returns_mean": {"default_agent": -0.3}, "num_module_steps_sampled": {"default_policy": 400}, "env_reset_timer": 0.0001472180290209438, "num_episodes": 20, "episode_return_min": -15.5, "module_episode_returns_mean": {"default_policy": -0.3}, "episode_len_min": 20, "sample": 0.16478642421089953, "time_between_sampling": 2.608088395729009}, "num_healthy_workers": 1, "actor_manager_num_outstanding_async_reqs": 0, "num_remote_worker_restarts": 0}, "num_env_steps_sampled_lifetime": -4930000.0, "fault_tolerance": {"num_healthy_workers": 0, "num_remote_worker_restarts": 0}, "env_runner_group": {"actor_manager_num_outstanding_async_reqs": 0}, "done": false, "training_iteration": 10, "trial_id": "46b1a_00000", "date": "2025-08-11_19-34-39", "timestamp": 1754933679, "time_this_iter_s": 2.821089029312134, "time_total_s": 27.33705997467041, "pid": 26849, "hostname": "Mac", "node_ip": "127.0.0.1", "config": {"exploration_config": {}, "extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "placement_strategy": "PACK", "num_gpus": 0, "_fake_gpus": false, "num_cpus_for_main_process": 2, "eager_tracing": true, "eager_max_retraces": 20, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "torch_compile_learner": false, "torch_compile_learner_what_to_compile": "forward_train", "torch_compile_learner_dynamo_backend": "aot_eager", "torch_compile_learner_dynamo_mode": null, "torch_compile_worker": false, "torch_compile_worker_dynamo_backend": "aot_eager", "torch_compile_worker_dynamo_mode": null, "torch_ddp_kwargs": {}, "torch_skip_nan_gradients": false, "env": "Umbrella", "env_config": {}, "observation_space": null, "action_space": null, "clip_rewards": null, "normalize_actions": true, "clip_actions": false, "_is_atari": null, "disable_env_checking": false, "render_env": false, "action_mask_key": "action_mask", "env_runner_cls": null, "num_env_runners": 0, "create_local_env_runner": true, "num_envs_per_env_runner": 1, "gym_env_vectorize_mode": "SYNC", "num_cpus_per_env_runner": 1, "num_gpus_per_env_runner": 0, "custom_resources_per_env_runner": {}, "validate_env_runners_after_construction": true, "episodes_to_numpy": true, "max_requests_in_flight_per_env_runner": 1, "sample_timeout_s": 60.0, "_env_to_module_connector": null, "add_default_connectors_to_env_to_module_pipeline": true, "_module_to_env_connector": null, "add_default_connectors_to_module_to_env_pipeline": true, "merge_env_runner_states": "training_only", "broadcast_env_runner_states": true, "episode_lookback_horizon": 1, "rollout_fragment_length": "auto", "batch_mode": "complete_episodes", "compress_observations": false, "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "enable_tf1_exec_eagerly": false, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "preprocessor_pref": "deepmind", "observation_filter": "NoFilter", "update_worker_filter_stats": true, "use_worker_filter_stats": true, "sampler_perf_stats_ema_coef": null, "_is_online": true, "num_learners": 0, "num_gpus_per_learner": 0, "num_cpus_per_learner": "auto", "num_aggregator_actors_per_learner": 0, "max_requests_in_flight_per_aggregator_actor": 3, "local_gpu_idx": 0, "max_requests_in_flight_per_learner": 3, "gamma": 1, "lr": 0.0002847858517, "grad_clip": 0.5, "grad_clip_by": "global_norm", "_train_batch_size_per_learner": 5000, "train_batch_size": 4000, "num_epochs": 1, "minibatch_size": 1000, "shuffle_batch_per_epoch": true, "model": {"fcnet_hiddens": [256, 256], "fcnet_activation": "tanh", "fcnet_weights_initializer": null, "fcnet_weights_initializer_config": null, "fcnet_bias_initializer": null, "fcnet_bias_initializer_config": null, "conv_filters": null, "conv_activation": "relu", "conv_kernel_initializer": null, "conv_kernel_initializer_config": null, "conv_bias_initializer": null, "conv_bias_initializer_config": null, "conv_transpose_kernel_initializer": null, "conv_transpose_kernel_initializer_config": null, "conv_transpose_bias_initializer": null, "conv_transpose_bias_initializer_config": null, "post_fcnet_hiddens": [], "post_fcnet_activation": "relu", "post_fcnet_weights_initializer": null, "post_fcnet_weights_initializer_config": null, "post_fcnet_bias_initializer": null, "post_fcnet_bias_initializer_config": null, "free_log_std": false, "log_std_clip_param": 20.0, "no_final_linear": false, "vf_share_layers": false, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "lstm_weights_initializer": null, "lstm_weights_initializer_config": null, "lstm_bias_initializer": null, "lstm_bias_initializer_config": null, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "attention_use_n_prev_actions": 0, "attention_use_n_prev_rewards": 0, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": null, "custom_model_config": {}, "custom_action_dist": null, "custom_preprocessor": null, "encoder_latent_dim": null, "always_check_shapes": false, "lstm_use_prev_action_reward": -1, "_use_default_native_models": -1, "_disable_preprocessor_api": false, "_disable_action_flattening": false}, "_learner_connector": null, "add_default_connectors_to_learner_pipeline": true, "learner_config_dict": {}, "optimizer": {}, "_learner_class": null, "callbacks_on_algorithm_init": null, "callbacks_on_env_runners_recreated": null, "callbacks_on_offline_eval_runners_recreated": null, "callbacks_on_checkpoint_loaded": null, "callbacks_on_environment_created": null, "callbacks_on_episode_created": null, "callbacks_on_episode_start": null, "callbacks_on_episode_step": null, "callbacks_on_episode_end": null, "callbacks_on_evaluate_start": null, "callbacks_on_evaluate_end": null, "callbacks_on_evaluate_offline_start": null, "callbacks_on_evaluate_offline_end": null, "callbacks_on_sample_end": null, "callbacks_on_train_result": null, "explore": true, "enable_rl_module_and_learner": true, "enable_env_runner_and_connector_v2": true, "_prior_exploration_config": {"type": "StochasticSampling"}, "count_steps_by": "env_steps", "policy_map_capacity": 100, "policy_mapping_fn": "<function AlgorithmConfig.DEFAULT_POLICY_MAPPING_FN at 0x13bfddb20>", "policies_to_train": null, "policy_states_are_swappable": false, "observation_fn": null, "offline_data_class": null, "input_read_method": "read_parquet", "input_read_method_kwargs": {}, "input_read_schema": {}, "input_read_episodes": false, "input_read_sample_batches": false, "input_read_batch_size": null, "input_filesystem": null, "input_filesystem_kwargs": {}, "input_compress_columns": ["obs", "new_obs"], "input_spaces_jsonable": true, "materialize_data": false, "materialize_mapped_data": true, "map_batches_kwargs": {}, "iter_batches_kwargs": {}, "ignore_final_observation": false, "prelearner_class": null, "prelearner_buffer_class": null, "prelearner_buffer_kwargs": {}, "prelearner_module_synch_period": 10, "dataset_num_iters_per_learner": null, "input_config": {}, "actions_in_input_normalized": false, "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_config": {}, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "output_max_rows_per_file": null, "output_write_remaining_data": false, "output_write_method": "write_parquet", "output_write_method_kwargs": {}, "output_filesystem": null, "output_filesystem_kwargs": {}, "output_write_episodes": true, "offline_sampling": false, "evaluation_interval": 1, "evaluation_duration": 20, "evaluation_duration_unit": "episodes", "evaluation_sample_timeout_s": 120.0, "evaluation_auto_duration_min_env_steps_per_sample": 100, "evaluation_auto_duration_max_env_steps_per_sample": 2000, "evaluation_parallel_to_training": false, "evaluation_force_reset_envs_before_iteration": true, "evaluation_config": null, "off_policy_estimation_methods": {}, "ope_split_batch_by_episode": true, "evaluation_num_env_runners": 1, "in_evaluation": false, "sync_filters_on_rollout_workers_timeout_s": 10.0, "offline_evaluation_interval": null, "num_offline_eval_runners": 0, "offline_loss_for_module_fn": null, "offline_evaluation_duration": 1, "offline_evaluation_parallel_to_training": false, "offline_evaluation_timeout_s": 120.0, "num_cpus_per_offline_eval_runner": 1, "num_gpus_per_offline_eval_runner": 0, "custom_resources_per_offline_eval_runner": {}, "restart_failed_offline_eval_runners": true, "ignore_offline_eval_runner_failures": false, "max_num_offline_eval_runner_restarts": 1000, "offline_eval_runner_restore_timeout_s": 1800.0, "max_requests_in_flight_per_offline_eval_runner": 1, "validate_offline_eval_runners_after_construction": true, "offline_eval_runner_health_probe_timeout_s": 30.0, "offline_eval_rl_module_inference_only": false, "broadcast_offline_eval_runner_states": false, "offline_eval_batch_size_per_runner": 256, "dataset_num_iters_per_eval_runner": 1, "keep_per_episode_custom_metrics": false, "metrics_episode_collection_timeout_s": 60.0, "metrics_num_episodes_for_smoothing": 100, "min_time_s_per_iteration": null, "min_train_timesteps_per_iteration": 0, "min_sample_timesteps_per_iteration": 0, "log_gradients": true, "export_native_model_files": false, "checkpoint_trainable_policies_only": false, "logger_creator": null, "logger_config": null, "log_level": "WARN", "log_sys_usage": true, "fake_sampler": false, "seed": 5, "restart_failed_env_runners": true, "ignore_env_runner_failures": false, "max_num_env_runner_restarts": 1000, "delay_between_env_runner_restarts_s": 60.0, "restart_failed_sub_environments": false, "num_consecutive_env_runner_failures_tolerance": 100, "env_runner_health_probe_timeout_s": 30.0, "env_runner_restore_timeout_s": 1800.0, "_model_config": {}, "_rl_module_spec": "RLModuleSpec(module_class=None, observation_space=None, action_space=None, inference_only=False, learner_only=False, model_config=DefaultModelConfig(fcnet_hiddens=[60, 90], fcnet_activation='tanh', fcnet_kernel_initializer=None, fcnet_kernel_initializer_kwargs=None, fcnet_bias_initializer=None, fcnet_bias_initializer_kwargs=None, conv_filters=None, conv_activation='relu', conv_kernel_initializer=None, conv_kernel_initializer_kwargs=None, conv_bias_initializer=None, conv_bias_initializer_kwargs=None, head_fcnet_hiddens=[], head_fcnet_activation='relu', head_fcnet_kernel_initializer=None, head_fcnet_kernel_initializer_kwargs=None, head_fcnet_bias_initializer=None, head_fcnet_bias_initializer_kwargs=None, free_log_std=False, log_std_clip_param=20.0, vf_share_layers=True, use_lstm=False, max_seq_len=20, lstm_cell_size=256, lstm_use_prev_action=False, lstm_use_prev_reward=False, lstm_kernel_initializer=None, lstm_kernel_initializer_kwargs=None, lstm_bias_initializer=None, lstm_bias_initializer_kwargs=None), catalog_class=None, load_state_path=None, model_config_dict=None)", "algorithm_config_overrides_per_module": {}, "_per_module_overrides": {}, "_validate_config": true, "_use_msgpack_checkpoints": false, "_torch_grad_scaler_class": null, "_torch_lr_scheduler_classes": null, "_tf_policy_handles_more_than_one_loss": false, "_disable_preprocessor_api": false, "_disable_action_flattening": false, "_disable_initialize_loss_from_dummy_batch": false, "_dont_auto_sync_env_runner_states": false, "env_task_fn": -1, "enable_connectors": -1, "simple_optimizer": false, "policy_map_cache": -1, "worker_cls": -1, "synchronize_filters": -1, "enable_async_evaluation": -1, "custom_async_evaluation_function": -1, "_enable_rl_module_api": -1, "auto_wrap_old_gym_envs": -1, "always_attach_evaluation_results": -1, "replay_sequence_length": null, "_disable_execution_plan_api": -1, "use_critic": true, "use_gae": true, "use_kl_loss": true, "kl_coeff": 0.7464963036515, "kl_target": 0.0270990929592, "vf_loss_coeff": 0.6688075857018, "entropy_coeff": 0.0090570820258, "clip_param": 0.1221781641624, "vf_clip_param": 0.1027808522125, "entropy_coeff_schedule": null, "lr_schedule": null, "sgd_minibatch_size": -1, "vf_share_layers": -1, "__stdout_file__": null, "__stderr_file__": null, "lambda": 0.9099046732075, "input": "sampler", "policies": {"default_policy": [null, null, null, null]}, "callbacks": "<class 'ray.rllib.callbacks.callbacks.RLlibCallback'>", "create_env_on_driver": false, "custom_eval_function": null, "framework": "torch"}, "time_since_restore": 27.33705997467041, "iterations_since_restore": 10, "perf": {"cpu_util_percent": 69.85, "ram_util_percent": 78.35}}
{"timers": {"training_iteration": 2.5251203679740875, "restore_env_runners": 1.2720220443459988e-05, "training_step": 2.524966929998425, "env_runner_sampling_timer": 2.3646155371349957, "learner_update_timer": 0.1569906719638479, "synch_weights": 0.0006560340576810749, "restore_eval_env_runners": 9.030599137031054e-06, "evaluation_iteration": 0.17195727181038198, "synch_eval_env_connectors": 0.00013460604859836001, "synch_env_connectors": 5.410464920789316e-06}, "env_runners": {"weights_seq_no": 10.0, "episode_return_max": 6.5, "num_episodes": 250.0, "module_to_env_connector": {"timers": {"connectors": {"tensor_to_numpy": 2.1186543979518467e-05, "remove_single_ts_time_rank_from_batch": 8.48801964608073e-07, "listify_data_for_vector_env": 1.7285048505496472e-05, "get_actions": 6.69499111875949e-05, "normalize_and_clip_actions": 1.4008937531809174e-05, "un_batch_to_individual_items": 7.912012657952236e-06}}, "connector_pipeline_timer": 0.00016565220360793763}, "env_to_module_connector": {"timers": {"connectors": {"batch_individual_items": 9.891914732969618e-06, "add_time_dim_to_batch_and_zero_pad": 3.647065685701281e-06, "numpy_to_tensor": 1.4578491038941338e-05, "add_observations_from_episodes_to_batch": 4.385211354212796e-06, "add_states_from_episodes_to_batch": 2.3146360704199293e-06}}, "connector_pipeline_timer": 6.538725026345177e-05}, "agent_episode_returns_mean": {"default_agent": 2.899999999999998}, "env_to_module_sum_episodes_length_out": 10.36823839457432, "num_module_steps_sampled": {"default_policy": 5000.0}, "episode_return_min": -13.5, "time_between_sampling": 0.0027133479721989043, "episode_len_min": 20, "episode_len_mean": 20.0, "episode_return_mean": 2.899999999999998, "episode_len_max": 20, "sample": 0.007875800700475133, "num_env_steps_sampled": 5000.0, "episode_duration_sec_mean": 0.0072119781626388425, "env_to_module_sum_episodes_length_in": 10.36823839457432, "env_step_timer": 2.2221251403625798e-05, "num_module_steps_sampled_lifetime": {"default_policy": -5547500.0}, "num_episodes_lifetime": -277375.0, "num_env_steps_sampled_lifetime": -5547500.0, "num_agent_steps_sampled_lifetime": {"default_agent": -5547500.0}, "env_reset_timer": 6.591864227954784e-05, "rlmodule_inference_timer": 4.583737031859633e-05, "module_episode_returns_mean": {"default_policy": 2.899999999999998}, "num_agent_steps_sampled": {"default_agent": 5000.0}, "num_env_steps_sampled_lifetime_throughput": 2573.8112851114406}, "learners": {"default_policy": {"vf_loss_unclipped": 24.314098358154297, "default_optimizer_learning_rate": 0.0002847858517, "module_train_batch_size_mean": 1000.0, "vf_loss": 0.10278083384037018, "entropy": 0.5282582640647888, "total_loss": 0.02838999032974243, "policy_loss": -0.03556709364056587, "vf_explained_var": -0.0189741849899292, "mean_kl_loss": 0.001295494264923036, "diff_num_grad_updates_vs_sampler_policy": 1.0, "gradients_default_optimizer_global_norm": 0.028718072921037674, "num_module_steps_trained_lifetime": 66000, "curr_entropy_coeff": 0.0090570820258, "num_module_steps_trained": 6000, "num_trainable_parameters": 6003, "curr_kl_coeff": 0.0003645001561380923, "weights_seq_no": 11.0, "num_module_steps_trained_lifetime_throughput": 226367.1858137764}, "__all_modules__": {"learner_connector": {"timers": {"connectors": {"add_observations_from_episodes_to_batch": 0.0008677022925014082, "general_advantage_estimation": 0.00970602551826636, "add_one_ts_to_episodes_and_truncate": 0.010717184637102537, "add_columns_from_episodes_to_train_batch": 0.039621623005452744, "numpy_to_tensor": 0.00013708673183664496, "add_states_from_episodes_to_batch": 3.7646188312776334e-06, "batch_individual_items": 0.05142017926893801, "add_time_dim_to_batch_and_zero_pad": 1.2497191188357859e-05}}, "connector_pipeline_timer": 0.11270714014366237}, "num_env_steps_trained": 31500, "num_env_steps_trained_lifetime": 346500, "num_module_steps_trained_lifetime": 66000, "learner_connector_sum_episodes_length_in": 5000.0, "num_trainable_parameters": 6003, "learner_connector_sum_episodes_length_out": 5250.0, "num_module_steps_trained": 6000, "num_non_trainable_parameters": 0, "num_env_steps_trained_lifetime_throughput": 1185837.6322278206, "num_module_steps_trained_throughput": 226302.3771808315, "num_module_steps_trained_lifetime_throughput": 226123.0729589342}}, "num_training_step_calls_per_iteration": 1, "evaluation": {"env_runners": {"module_to_env_connector": {"connector_pipeline_timer": 0.00017977322943632586, "timers": {"connectors": {"remove_single_ts_time_rank_from_batch": 8.628180116253131e-07, "listify_data_for_vector_env": 1.750093938507874e-05, "normalize_and_clip_actions": 1.5499465952946225e-05, "get_actions": 7.262465768126836e-05, "tensor_to_numpy": 2.3013048255707628e-05, "un_batch_to_individual_items": 8.462791525202625e-06}}}, "num_episodes_lifetime": 220, "weights_seq_no": 11.0, "episode_return_max": 13.5, "num_env_steps_sampled": 400, "env_to_module_sum_episodes_length_in": 10.368238394574323, "env_to_module_connector": {"timers": {"connectors": {"add_observations_from_episodes_to_batch": 5.417232069000626e-06, "numpy_to_tensor": 1.6255782359114545e-05, "add_states_from_episodes_to_batch": 2.690753232052845e-06, "batch_individual_items": 1.185314927910502e-05, "add_time_dim_to_batch_and_zero_pad": 3.962693614730762e-06}}, "connector_pipeline_timer": 7.463847904396842e-05}, "env_to_module_sum_episodes_length_out": 10.368238394574323, "episode_len_max": 20, "episode_duration_sec_mean": 0.007726618289016187, "env_step_timer": 2.6177056580381304e-05, "num_env_steps_sampled_lifetime": 55400, "rlmodule_inference_timer": 4.713091664327767e-05, "num_module_steps_sampled_lifetime": {"default_policy": 4400}, "num_agent_steps_sampled_lifetime": {"default_agent": 4400}, "num_agent_steps_sampled": {"default_agent": 400}, "episode_len_mean": 20.0, "episode_return_mean": 0.9, "agent_episode_returns_mean": {"default_agent": 0.9}, "num_module_steps_sampled": {"default_policy": 400}, "env_reset_timer": 0.00014654584783740975, "num_episodes": 20, "episode_return_min": -15.5, "module_episode_returns_mean": {"default_policy": 0.9}, "episode_len_min": 20, "sample": 0.16481451705854622, "time_between_sampling": 2.6052088584322175}, "num_healthy_workers": 1, "actor_manager_num_outstanding_async_reqs": 0, "num_remote_worker_restarts": 0}, "num_env_steps_sampled_lifetime": -5547500.0, "fault_tolerance": {"num_healthy_workers": 0, "num_remote_worker_restarts": 0}, "env_runner_group": {"actor_manager_num_outstanding_async_reqs": 0}, "done": false, "training_iteration": 11, "trial_id": "46b1a_00000", "date": "2025-08-11_19-34-42", "timestamp": 1754933682, "time_this_iter_s": 2.476078748703003, "time_total_s": 29.813138723373413, "pid": 26849, "hostname": "Mac", "node_ip": "127.0.0.1", "config": {"exploration_config": {}, "extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "placement_strategy": "PACK", "num_gpus": 0, "_fake_gpus": false, "num_cpus_for_main_process": 2, "eager_tracing": true, "eager_max_retraces": 20, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "torch_compile_learner": false, "torch_compile_learner_what_to_compile": "forward_train", "torch_compile_learner_dynamo_backend": "aot_eager", "torch_compile_learner_dynamo_mode": null, "torch_compile_worker": false, "torch_compile_worker_dynamo_backend": "aot_eager", "torch_compile_worker_dynamo_mode": null, "torch_ddp_kwargs": {}, "torch_skip_nan_gradients": false, "env": "Umbrella", "env_config": {}, "observation_space": null, "action_space": null, "clip_rewards": null, "normalize_actions": true, "clip_actions": false, "_is_atari": null, "disable_env_checking": false, "render_env": false, "action_mask_key": "action_mask", "env_runner_cls": null, "num_env_runners": 0, "create_local_env_runner": true, "num_envs_per_env_runner": 1, "gym_env_vectorize_mode": "SYNC", "num_cpus_per_env_runner": 1, "num_gpus_per_env_runner": 0, "custom_resources_per_env_runner": {}, "validate_env_runners_after_construction": true, "episodes_to_numpy": true, "max_requests_in_flight_per_env_runner": 1, "sample_timeout_s": 60.0, "_env_to_module_connector": null, "add_default_connectors_to_env_to_module_pipeline": true, "_module_to_env_connector": null, "add_default_connectors_to_module_to_env_pipeline": true, "merge_env_runner_states": "training_only", "broadcast_env_runner_states": true, "episode_lookback_horizon": 1, "rollout_fragment_length": "auto", "batch_mode": "complete_episodes", "compress_observations": false, "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "enable_tf1_exec_eagerly": false, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "preprocessor_pref": "deepmind", "observation_filter": "NoFilter", "update_worker_filter_stats": true, "use_worker_filter_stats": true, "sampler_perf_stats_ema_coef": null, "_is_online": true, "num_learners": 0, "num_gpus_per_learner": 0, "num_cpus_per_learner": "auto", "num_aggregator_actors_per_learner": 0, "max_requests_in_flight_per_aggregator_actor": 3, "local_gpu_idx": 0, "max_requests_in_flight_per_learner": 3, "gamma": 1, "lr": 0.0002847858517, "grad_clip": 0.5, "grad_clip_by": "global_norm", "_train_batch_size_per_learner": 5000, "train_batch_size": 4000, "num_epochs": 1, "minibatch_size": 1000, "shuffle_batch_per_epoch": true, "model": {"fcnet_hiddens": [256, 256], "fcnet_activation": "tanh", "fcnet_weights_initializer": null, "fcnet_weights_initializer_config": null, "fcnet_bias_initializer": null, "fcnet_bias_initializer_config": null, "conv_filters": null, "conv_activation": "relu", "conv_kernel_initializer": null, "conv_kernel_initializer_config": null, "conv_bias_initializer": null, "conv_bias_initializer_config": null, "conv_transpose_kernel_initializer": null, "conv_transpose_kernel_initializer_config": null, "conv_transpose_bias_initializer": null, "conv_transpose_bias_initializer_config": null, "post_fcnet_hiddens": [], "post_fcnet_activation": "relu", "post_fcnet_weights_initializer": null, "post_fcnet_weights_initializer_config": null, "post_fcnet_bias_initializer": null, "post_fcnet_bias_initializer_config": null, "free_log_std": false, "log_std_clip_param": 20.0, "no_final_linear": false, "vf_share_layers": false, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "lstm_weights_initializer": null, "lstm_weights_initializer_config": null, "lstm_bias_initializer": null, "lstm_bias_initializer_config": null, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "attention_use_n_prev_actions": 0, "attention_use_n_prev_rewards": 0, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": null, "custom_model_config": {}, "custom_action_dist": null, "custom_preprocessor": null, "encoder_latent_dim": null, "always_check_shapes": false, "lstm_use_prev_action_reward": -1, "_use_default_native_models": -1, "_disable_preprocessor_api": false, "_disable_action_flattening": false}, "_learner_connector": null, "add_default_connectors_to_learner_pipeline": true, "learner_config_dict": {}, "optimizer": {}, "_learner_class": null, "callbacks_on_algorithm_init": null, "callbacks_on_env_runners_recreated": null, "callbacks_on_offline_eval_runners_recreated": null, "callbacks_on_checkpoint_loaded": null, "callbacks_on_environment_created": null, "callbacks_on_episode_created": null, "callbacks_on_episode_start": null, "callbacks_on_episode_step": null, "callbacks_on_episode_end": null, "callbacks_on_evaluate_start": null, "callbacks_on_evaluate_end": null, "callbacks_on_evaluate_offline_start": null, "callbacks_on_evaluate_offline_end": null, "callbacks_on_sample_end": null, "callbacks_on_train_result": null, "explore": true, "enable_rl_module_and_learner": true, "enable_env_runner_and_connector_v2": true, "_prior_exploration_config": {"type": "StochasticSampling"}, "count_steps_by": "env_steps", "policy_map_capacity": 100, "policy_mapping_fn": "<function AlgorithmConfig.DEFAULT_POLICY_MAPPING_FN at 0x13bfddb20>", "policies_to_train": null, "policy_states_are_swappable": false, "observation_fn": null, "offline_data_class": null, "input_read_method": "read_parquet", "input_read_method_kwargs": {}, "input_read_schema": {}, "input_read_episodes": false, "input_read_sample_batches": false, "input_read_batch_size": null, "input_filesystem": null, "input_filesystem_kwargs": {}, "input_compress_columns": ["obs", "new_obs"], "input_spaces_jsonable": true, "materialize_data": false, "materialize_mapped_data": true, "map_batches_kwargs": {}, "iter_batches_kwargs": {}, "ignore_final_observation": false, "prelearner_class": null, "prelearner_buffer_class": null, "prelearner_buffer_kwargs": {}, "prelearner_module_synch_period": 10, "dataset_num_iters_per_learner": null, "input_config": {}, "actions_in_input_normalized": false, "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_config": {}, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "output_max_rows_per_file": null, "output_write_remaining_data": false, "output_write_method": "write_parquet", "output_write_method_kwargs": {}, "output_filesystem": null, "output_filesystem_kwargs": {}, "output_write_episodes": true, "offline_sampling": false, "evaluation_interval": 1, "evaluation_duration": 20, "evaluation_duration_unit": "episodes", "evaluation_sample_timeout_s": 120.0, "evaluation_auto_duration_min_env_steps_per_sample": 100, "evaluation_auto_duration_max_env_steps_per_sample": 2000, "evaluation_parallel_to_training": false, "evaluation_force_reset_envs_before_iteration": true, "evaluation_config": null, "off_policy_estimation_methods": {}, "ope_split_batch_by_episode": true, "evaluation_num_env_runners": 1, "in_evaluation": false, "sync_filters_on_rollout_workers_timeout_s": 10.0, "offline_evaluation_interval": null, "num_offline_eval_runners": 0, "offline_loss_for_module_fn": null, "offline_evaluation_duration": 1, "offline_evaluation_parallel_to_training": false, "offline_evaluation_timeout_s": 120.0, "num_cpus_per_offline_eval_runner": 1, "num_gpus_per_offline_eval_runner": 0, "custom_resources_per_offline_eval_runner": {}, "restart_failed_offline_eval_runners": true, "ignore_offline_eval_runner_failures": false, "max_num_offline_eval_runner_restarts": 1000, "offline_eval_runner_restore_timeout_s": 1800.0, "max_requests_in_flight_per_offline_eval_runner": 1, "validate_offline_eval_runners_after_construction": true, "offline_eval_runner_health_probe_timeout_s": 30.0, "offline_eval_rl_module_inference_only": false, "broadcast_offline_eval_runner_states": false, "offline_eval_batch_size_per_runner": 256, "dataset_num_iters_per_eval_runner": 1, "keep_per_episode_custom_metrics": false, "metrics_episode_collection_timeout_s": 60.0, "metrics_num_episodes_for_smoothing": 100, "min_time_s_per_iteration": null, "min_train_timesteps_per_iteration": 0, "min_sample_timesteps_per_iteration": 0, "log_gradients": true, "export_native_model_files": false, "checkpoint_trainable_policies_only": false, "logger_creator": null, "logger_config": null, "log_level": "WARN", "log_sys_usage": true, "fake_sampler": false, "seed": 5, "restart_failed_env_runners": true, "ignore_env_runner_failures": false, "max_num_env_runner_restarts": 1000, "delay_between_env_runner_restarts_s": 60.0, "restart_failed_sub_environments": false, "num_consecutive_env_runner_failures_tolerance": 100, "env_runner_health_probe_timeout_s": 30.0, "env_runner_restore_timeout_s": 1800.0, "_model_config": {}, "_rl_module_spec": "RLModuleSpec(module_class=None, observation_space=None, action_space=None, inference_only=False, learner_only=False, model_config=DefaultModelConfig(fcnet_hiddens=[60, 90], fcnet_activation='tanh', fcnet_kernel_initializer=None, fcnet_kernel_initializer_kwargs=None, fcnet_bias_initializer=None, fcnet_bias_initializer_kwargs=None, conv_filters=None, conv_activation='relu', conv_kernel_initializer=None, conv_kernel_initializer_kwargs=None, conv_bias_initializer=None, conv_bias_initializer_kwargs=None, head_fcnet_hiddens=[], head_fcnet_activation='relu', head_fcnet_kernel_initializer=None, head_fcnet_kernel_initializer_kwargs=None, head_fcnet_bias_initializer=None, head_fcnet_bias_initializer_kwargs=None, free_log_std=False, log_std_clip_param=20.0, vf_share_layers=True, use_lstm=False, max_seq_len=20, lstm_cell_size=256, lstm_use_prev_action=False, lstm_use_prev_reward=False, lstm_kernel_initializer=None, lstm_kernel_initializer_kwargs=None, lstm_bias_initializer=None, lstm_bias_initializer_kwargs=None), catalog_class=None, load_state_path=None, model_config_dict=None)", "algorithm_config_overrides_per_module": {}, "_per_module_overrides": {}, "_validate_config": true, "_use_msgpack_checkpoints": false, "_torch_grad_scaler_class": null, "_torch_lr_scheduler_classes": null, "_tf_policy_handles_more_than_one_loss": false, "_disable_preprocessor_api": false, "_disable_action_flattening": false, "_disable_initialize_loss_from_dummy_batch": false, "_dont_auto_sync_env_runner_states": false, "env_task_fn": -1, "enable_connectors": -1, "simple_optimizer": false, "policy_map_cache": -1, "worker_cls": -1, "synchronize_filters": -1, "enable_async_evaluation": -1, "custom_async_evaluation_function": -1, "_enable_rl_module_api": -1, "auto_wrap_old_gym_envs": -1, "always_attach_evaluation_results": -1, "replay_sequence_length": null, "_disable_execution_plan_api": -1, "use_critic": true, "use_gae": true, "use_kl_loss": true, "kl_coeff": 0.7464963036515, "kl_target": 0.0270990929592, "vf_loss_coeff": 0.6688075857018, "entropy_coeff": 0.0090570820258, "clip_param": 0.1221781641624, "vf_clip_param": 0.1027808522125, "entropy_coeff_schedule": null, "lr_schedule": null, "sgd_minibatch_size": -1, "vf_share_layers": -1, "__stdout_file__": null, "__stderr_file__": null, "lambda": 0.9099046732075, "input": "sampler", "policies": {"default_policy": [null, null, null, null]}, "callbacks": "<class 'ray.rllib.callbacks.callbacks.RLlibCallback'>", "create_env_on_driver": false, "custom_eval_function": null, "framework": "torch"}, "time_since_restore": 29.813138723373413, "iterations_since_restore": 11, "perf": {"cpu_util_percent": 67.4, "ram_util_percent": 77.93333333333334}}
{"timers": {"training_iteration": 2.5289578467952247, "restore_env_runners": 1.2655099037696038e-05, "training_step": 2.5288039661179083, "env_runner_sampling_timer": 2.368792600513482, "learner_update_timer": 0.15664838858371902, "synch_weights": 0.0006559278873201391, "restore_eval_env_runners": 9.006543941159233e-06, "evaluation_iteration": 0.17198497700216797, "synch_eval_env_connectors": 0.00013427581773325928, "synch_env_connectors": 5.3980311360293735e-06}, "env_runners": {"weights_seq_no": 11.0, "episode_return_max": 6.5, "num_episodes": 250.0, "module_to_env_connector": {"timers": {"connectors": {"tensor_to_numpy": 2.3774248723413203e-05, "remove_single_ts_time_rank_from_batch": 9.438300134902388e-07, "listify_data_for_vector_env": 1.8806956622266196e-05, "get_actions": 8.500498670599608e-05, "normalize_and_clip_actions": 1.593522894200813e-05, "un_batch_to_individual_items": 8.722671756533112e-06}}, "connector_pipeline_timer": 0.00019672206242900392}, "env_to_module_connector": {"timers": {"connectors": {"batch_individual_items": 1.1725776519055386e-05, "add_time_dim_to_batch_and_zero_pad": 4.142607106723438e-06, "numpy_to_tensor": 1.6187416501616073e-05, "add_observations_from_episodes_to_batch": 4.961618302523974e-06, "add_states_from_episodes_to_batch": 2.5654458711960374e-06}}, "connector_pipeline_timer": 7.488839818458798e-05}, "agent_episode_returns_mean": {"default_agent": 3.38}, "env_to_module_sum_episodes_length_out": 10.36823839457432, "num_module_steps_sampled": {"default_policy": 5000.0}, "episode_return_min": -13.5, "time_between_sampling": 0.0032100792203253246, "episode_len_min": 20, "episode_len_mean": 20.0, "episode_return_mean": 3.38, "episode_len_max": 20, "sample": 0.008820601865609226, "num_env_steps_sampled": 5000.0, "episode_duration_sec_mean": 0.008520181647036225, "env_to_module_sum_episodes_length_in": 10.36823839457432, "env_step_timer": 2.4858573387603895e-05, "num_module_steps_sampled_lifetime": {"default_policy": -6165000.0}, "num_episodes_lifetime": -308250.0, "num_env_steps_sampled_lifetime": -6165000.0, "num_agent_steps_sampled_lifetime": {"default_agent": -6165000.0}, "env_reset_timer": 7.143835489840253e-05, "rlmodule_inference_timer": 6.431443666285802e-05, "module_episode_returns_mean": {"default_policy": 3.38}, "num_agent_steps_sampled": {"default_agent": 5000.0}, "num_env_steps_sampled_lifetime_throughput": 2391.38881246835}, "learners": {"default_policy": {"vf_loss_unclipped": 23.894079208374023, "default_optimizer_learning_rate": 0.0002847858517, "module_train_batch_size_mean": 1000.0, "vf_loss": 0.10278083384037018, "entropy": 0.493836909532547, "total_loss": 0.010113202035427094, "policy_loss": -0.0541551373898983, "vf_explained_var": -0.02031266689300537, "mean_kl_loss": 0.0012555166613310575, "diff_num_grad_updates_vs_sampler_policy": 1.0, "gradients_default_optimizer_global_norm": 0.04764096066355705, "num_module_steps_trained_lifetime": 72000, "curr_entropy_coeff": 0.0090570820258, "num_module_steps_trained": 6000, "num_trainable_parameters": 6003, "curr_kl_coeff": 0.00018225007806904614, "weights_seq_no": 12.0, "num_module_steps_trained_lifetime_throughput": 229144.73420321645}, "__all_modules__": {"learner_connector": {"timers": {"connectors": {"add_observations_from_episodes_to_batch": 0.0008747606792645986, "general_advantage_estimation": 0.009681336513800666, "add_one_ts_to_episodes_and_truncate": 0.010755954870566152, "add_columns_from_episodes_to_train_batch": 0.03965891719507802, "numpy_to_tensor": 0.00013652002430855598, "add_states_from_episodes_to_batch": 3.7623826914049556e-06, "batch_individual_items": 0.05127023372598935, "add_time_dim_to_batch_and_zero_pad": 1.2516389175177975e-05}}, "connector_pipeline_timer": 0.11261441874278044}, "num_env_steps_trained": 31500, "num_env_steps_trained_lifetime": 378000, "num_module_steps_trained_lifetime": 72000, "learner_connector_sum_episodes_length_in": 5000.0, "num_trainable_parameters": 6003, "learner_connector_sum_episodes_length_out": 5250.0, "num_module_steps_trained": 6000, "num_non_trainable_parameters": 0, "num_env_steps_trained_lifetime_throughput": 1200659.3151985826, "num_module_steps_trained_throughput": 229109.19502211883, "num_module_steps_trained_lifetime_throughput": 228934.35460603188}}, "num_training_step_calls_per_iteration": 1, "evaluation": {"env_runners": {"module_to_env_connector": {"connector_pipeline_timer": 0.0001672606343826906, "timers": {"connectors": {"remove_single_ts_time_rank_from_batch": 9.751589352363387e-07, "listify_data_for_vector_env": 1.698458450810636e-05, "normalize_and_clip_actions": 1.6678056255507633e-05, "get_actions": 6.340020989302924e-05, "tensor_to_numpy": 2.2209700767612704e-05, "un_batch_to_individual_items": 8.005159010298188e-06}}}, "num_episodes_lifetime": 240, "weights_seq_no": 12.0, "episode_return_max": 12.5, "num_env_steps_sampled": 400, "env_to_module_sum_episodes_length_in": 10.368238394574323, "env_to_module_connector": {"timers": {"connectors": {"add_observations_from_episodes_to_batch": 4.0967180620776684e-06, "numpy_to_tensor": 1.5407420326468154e-05, "add_states_from_episodes_to_batch": 2.1558493733492863e-06, "batch_individual_items": 1.1791497869863727e-05, "add_time_dim_to_batch_and_zero_pad": 3.7576529325665524e-06}}, "connector_pipeline_timer": 6.786538949201693e-05}, "env_to_module_sum_episodes_length_out": 10.368238394574323, "episode_len_max": 20, "episode_duration_sec_mean": 0.007659273719182238, "env_step_timer": 2.33523572288335e-05, "num_env_steps_sampled_lifetime": 60400, "rlmodule_inference_timer": 4.389688920784701e-05, "num_module_steps_sampled_lifetime": {"default_policy": 4800}, "num_agent_steps_sampled_lifetime": {"default_agent": 4800}, "num_agent_steps_sampled": {"default_agent": 400}, "episode_len_mean": 20.0, "episode_return_mean": 0.5, "agent_episode_returns_mean": {"default_agent": 0.5}, "num_module_steps_sampled": {"default_policy": 400}, "env_reset_timer": 0.0001495199703117843, "num_episodes": 20, "episode_return_min": -15.5, "module_episode_returns_mean": {"default_policy": 0.5}, "episode_len_min": 20, "sample": 0.16510809730872633, "time_between_sampling": 2.6085142044382423}, "num_healthy_workers": 1, "actor_manager_num_outstanding_async_reqs": 0, "num_remote_worker_restarts": 0}, "num_env_steps_sampled_lifetime": -6165000.0, "fault_tolerance": {"num_healthy_workers": 0, "num_remote_worker_restarts": 0}, "env_runner_group": {"actor_manager_num_outstanding_async_reqs": 0}, "done": false, "training_iteration": 12, "trial_id": "46b1a_00000", "date": "2025-08-11_19-34-45", "timestamp": 1754933685, "time_this_iter_s": 3.1156258583068848, "time_total_s": 32.9287645816803, "pid": 26849, "hostname": "Mac", "node_ip": "127.0.0.1", "config": {"exploration_config": {}, "extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "placement_strategy": "PACK", "num_gpus": 0, "_fake_gpus": false, "num_cpus_for_main_process": 2, "eager_tracing": true, "eager_max_retraces": 20, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "torch_compile_learner": false, "torch_compile_learner_what_to_compile": "forward_train", "torch_compile_learner_dynamo_backend": "aot_eager", "torch_compile_learner_dynamo_mode": null, "torch_compile_worker": false, "torch_compile_worker_dynamo_backend": "aot_eager", "torch_compile_worker_dynamo_mode": null, "torch_ddp_kwargs": {}, "torch_skip_nan_gradients": false, "env": "Umbrella", "env_config": {}, "observation_space": null, "action_space": null, "clip_rewards": null, "normalize_actions": true, "clip_actions": false, "_is_atari": null, "disable_env_checking": false, "render_env": false, "action_mask_key": "action_mask", "env_runner_cls": null, "num_env_runners": 0, "create_local_env_runner": true, "num_envs_per_env_runner": 1, "gym_env_vectorize_mode": "SYNC", "num_cpus_per_env_runner": 1, "num_gpus_per_env_runner": 0, "custom_resources_per_env_runner": {}, "validate_env_runners_after_construction": true, "episodes_to_numpy": true, "max_requests_in_flight_per_env_runner": 1, "sample_timeout_s": 60.0, "_env_to_module_connector": null, "add_default_connectors_to_env_to_module_pipeline": true, "_module_to_env_connector": null, "add_default_connectors_to_module_to_env_pipeline": true, "merge_env_runner_states": "training_only", "broadcast_env_runner_states": true, "episode_lookback_horizon": 1, "rollout_fragment_length": "auto", "batch_mode": "complete_episodes", "compress_observations": false, "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "enable_tf1_exec_eagerly": false, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "preprocessor_pref": "deepmind", "observation_filter": "NoFilter", "update_worker_filter_stats": true, "use_worker_filter_stats": true, "sampler_perf_stats_ema_coef": null, "_is_online": true, "num_learners": 0, "num_gpus_per_learner": 0, "num_cpus_per_learner": "auto", "num_aggregator_actors_per_learner": 0, "max_requests_in_flight_per_aggregator_actor": 3, "local_gpu_idx": 0, "max_requests_in_flight_per_learner": 3, "gamma": 1, "lr": 0.0002847858517, "grad_clip": 0.5, "grad_clip_by": "global_norm", "_train_batch_size_per_learner": 5000, "train_batch_size": 4000, "num_epochs": 1, "minibatch_size": 1000, "shuffle_batch_per_epoch": true, "model": {"fcnet_hiddens": [256, 256], "fcnet_activation": "tanh", "fcnet_weights_initializer": null, "fcnet_weights_initializer_config": null, "fcnet_bias_initializer": null, "fcnet_bias_initializer_config": null, "conv_filters": null, "conv_activation": "relu", "conv_kernel_initializer": null, "conv_kernel_initializer_config": null, "conv_bias_initializer": null, "conv_bias_initializer_config": null, "conv_transpose_kernel_initializer": null, "conv_transpose_kernel_initializer_config": null, "conv_transpose_bias_initializer": null, "conv_transpose_bias_initializer_config": null, "post_fcnet_hiddens": [], "post_fcnet_activation": "relu", "post_fcnet_weights_initializer": null, "post_fcnet_weights_initializer_config": null, "post_fcnet_bias_initializer": null, "post_fcnet_bias_initializer_config": null, "free_log_std": false, "log_std_clip_param": 20.0, "no_final_linear": false, "vf_share_layers": false, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "lstm_weights_initializer": null, "lstm_weights_initializer_config": null, "lstm_bias_initializer": null, "lstm_bias_initializer_config": null, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "attention_use_n_prev_actions": 0, "attention_use_n_prev_rewards": 0, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": null, "custom_model_config": {}, "custom_action_dist": null, "custom_preprocessor": null, "encoder_latent_dim": null, "always_check_shapes": false, "lstm_use_prev_action_reward": -1, "_use_default_native_models": -1, "_disable_preprocessor_api": false, "_disable_action_flattening": false}, "_learner_connector": null, "add_default_connectors_to_learner_pipeline": true, "learner_config_dict": {}, "optimizer": {}, "_learner_class": null, "callbacks_on_algorithm_init": null, "callbacks_on_env_runners_recreated": null, "callbacks_on_offline_eval_runners_recreated": null, "callbacks_on_checkpoint_loaded": null, "callbacks_on_environment_created": null, "callbacks_on_episode_created": null, "callbacks_on_episode_start": null, "callbacks_on_episode_step": null, "callbacks_on_episode_end": null, "callbacks_on_evaluate_start": null, "callbacks_on_evaluate_end": null, "callbacks_on_evaluate_offline_start": null, "callbacks_on_evaluate_offline_end": null, "callbacks_on_sample_end": null, "callbacks_on_train_result": null, "explore": true, "enable_rl_module_and_learner": true, "enable_env_runner_and_connector_v2": true, "_prior_exploration_config": {"type": "StochasticSampling"}, "count_steps_by": "env_steps", "policy_map_capacity": 100, "policy_mapping_fn": "<function AlgorithmConfig.DEFAULT_POLICY_MAPPING_FN at 0x13bfddb20>", "policies_to_train": null, "policy_states_are_swappable": false, "observation_fn": null, "offline_data_class": null, "input_read_method": "read_parquet", "input_read_method_kwargs": {}, "input_read_schema": {}, "input_read_episodes": false, "input_read_sample_batches": false, "input_read_batch_size": null, "input_filesystem": null, "input_filesystem_kwargs": {}, "input_compress_columns": ["obs", "new_obs"], "input_spaces_jsonable": true, "materialize_data": false, "materialize_mapped_data": true, "map_batches_kwargs": {}, "iter_batches_kwargs": {}, "ignore_final_observation": false, "prelearner_class": null, "prelearner_buffer_class": null, "prelearner_buffer_kwargs": {}, "prelearner_module_synch_period": 10, "dataset_num_iters_per_learner": null, "input_config": {}, "actions_in_input_normalized": false, "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_config": {}, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "output_max_rows_per_file": null, "output_write_remaining_data": false, "output_write_method": "write_parquet", "output_write_method_kwargs": {}, "output_filesystem": null, "output_filesystem_kwargs": {}, "output_write_episodes": true, "offline_sampling": false, "evaluation_interval": 1, "evaluation_duration": 20, "evaluation_duration_unit": "episodes", "evaluation_sample_timeout_s": 120.0, "evaluation_auto_duration_min_env_steps_per_sample": 100, "evaluation_auto_duration_max_env_steps_per_sample": 2000, "evaluation_parallel_to_training": false, "evaluation_force_reset_envs_before_iteration": true, "evaluation_config": null, "off_policy_estimation_methods": {}, "ope_split_batch_by_episode": true, "evaluation_num_env_runners": 1, "in_evaluation": false, "sync_filters_on_rollout_workers_timeout_s": 10.0, "offline_evaluation_interval": null, "num_offline_eval_runners": 0, "offline_loss_for_module_fn": null, "offline_evaluation_duration": 1, "offline_evaluation_parallel_to_training": false, "offline_evaluation_timeout_s": 120.0, "num_cpus_per_offline_eval_runner": 1, "num_gpus_per_offline_eval_runner": 0, "custom_resources_per_offline_eval_runner": {}, "restart_failed_offline_eval_runners": true, "ignore_offline_eval_runner_failures": false, "max_num_offline_eval_runner_restarts": 1000, "offline_eval_runner_restore_timeout_s": 1800.0, "max_requests_in_flight_per_offline_eval_runner": 1, "validate_offline_eval_runners_after_construction": true, "offline_eval_runner_health_probe_timeout_s": 30.0, "offline_eval_rl_module_inference_only": false, "broadcast_offline_eval_runner_states": false, "offline_eval_batch_size_per_runner": 256, "dataset_num_iters_per_eval_runner": 1, "keep_per_episode_custom_metrics": false, "metrics_episode_collection_timeout_s": 60.0, "metrics_num_episodes_for_smoothing": 100, "min_time_s_per_iteration": null, "min_train_timesteps_per_iteration": 0, "min_sample_timesteps_per_iteration": 0, "log_gradients": true, "export_native_model_files": false, "checkpoint_trainable_policies_only": false, "logger_creator": null, "logger_config": null, "log_level": "WARN", "log_sys_usage": true, "fake_sampler": false, "seed": 5, "restart_failed_env_runners": true, "ignore_env_runner_failures": false, "max_num_env_runner_restarts": 1000, "delay_between_env_runner_restarts_s": 60.0, "restart_failed_sub_environments": false, "num_consecutive_env_runner_failures_tolerance": 100, "env_runner_health_probe_timeout_s": 30.0, "env_runner_restore_timeout_s": 1800.0, "_model_config": {}, "_rl_module_spec": "RLModuleSpec(module_class=None, observation_space=None, action_space=None, inference_only=False, learner_only=False, model_config=DefaultModelConfig(fcnet_hiddens=[60, 90], fcnet_activation='tanh', fcnet_kernel_initializer=None, fcnet_kernel_initializer_kwargs=None, fcnet_bias_initializer=None, fcnet_bias_initializer_kwargs=None, conv_filters=None, conv_activation='relu', conv_kernel_initializer=None, conv_kernel_initializer_kwargs=None, conv_bias_initializer=None, conv_bias_initializer_kwargs=None, head_fcnet_hiddens=[], head_fcnet_activation='relu', head_fcnet_kernel_initializer=None, head_fcnet_kernel_initializer_kwargs=None, head_fcnet_bias_initializer=None, head_fcnet_bias_initializer_kwargs=None, free_log_std=False, log_std_clip_param=20.0, vf_share_layers=True, use_lstm=False, max_seq_len=20, lstm_cell_size=256, lstm_use_prev_action=False, lstm_use_prev_reward=False, lstm_kernel_initializer=None, lstm_kernel_initializer_kwargs=None, lstm_bias_initializer=None, lstm_bias_initializer_kwargs=None), catalog_class=None, load_state_path=None, model_config_dict=None)", "algorithm_config_overrides_per_module": {}, "_per_module_overrides": {}, "_validate_config": true, "_use_msgpack_checkpoints": false, "_torch_grad_scaler_class": null, "_torch_lr_scheduler_classes": null, "_tf_policy_handles_more_than_one_loss": false, "_disable_preprocessor_api": false, "_disable_action_flattening": false, "_disable_initialize_loss_from_dummy_batch": false, "_dont_auto_sync_env_runner_states": false, "env_task_fn": -1, "enable_connectors": -1, "simple_optimizer": false, "policy_map_cache": -1, "worker_cls": -1, "synchronize_filters": -1, "enable_async_evaluation": -1, "custom_async_evaluation_function": -1, "_enable_rl_module_api": -1, "auto_wrap_old_gym_envs": -1, "always_attach_evaluation_results": -1, "replay_sequence_length": null, "_disable_execution_plan_api": -1, "use_critic": true, "use_gae": true, "use_kl_loss": true, "kl_coeff": 0.7464963036515, "kl_target": 0.0270990929592, "vf_loss_coeff": 0.6688075857018, "entropy_coeff": 0.0090570820258, "clip_param": 0.1221781641624, "vf_clip_param": 0.1027808522125, "entropy_coeff_schedule": null, "lr_schedule": null, "sgd_minibatch_size": -1, "vf_share_layers": -1, "__stdout_file__": null, "__stderr_file__": null, "lambda": 0.9099046732075, "input": "sampler", "policies": {"default_policy": [null, null, null, null]}, "callbacks": "<class 'ray.rllib.callbacks.callbacks.RLlibCallback'>", "create_env_on_driver": false, "custom_eval_function": null, "framework": "torch"}, "time_since_restore": 32.9287645816803, "iterations_since_restore": 12, "perf": {"cpu_util_percent": 74.84, "ram_util_percent": 79.73999999999998}}
{"timers": {"training_iteration": 2.5284276612367456, "restore_env_runners": 1.2601468276605033e-05, "training_step": 2.5282724952073288, "env_runner_sampling_timer": 2.368760261589213, "learner_update_timer": 0.1561361026179025, "synch_weights": 0.0006552144492344527, "restore_eval_env_runners": 8.998568765933903e-06, "evaluation_iteration": 0.1723079959818505, "synch_eval_env_connectors": 0.0001340222296654073, "synch_env_connectors": 5.382800828692393e-06}, "env_runners": {"weights_seq_no": 12.0, "episode_return_max": 6.5, "num_episodes": 250.0, "module_to_env_connector": {"timers": {"connectors": {"tensor_to_numpy": 2.2012144735169815e-05, "remove_single_ts_time_rank_from_batch": 9.009788131427037e-07, "listify_data_for_vector_env": 1.7011010085368074e-05, "get_actions": 7.116878646001204e-05, "normalize_and_clip_actions": 1.4876183424380608e-05, "un_batch_to_individual_items": 8.082252459628003e-06}}, "connector_pipeline_timer": 0.00017290711459131482}, "env_to_module_connector": {"timers": {"connectors": {"batch_individual_items": 1.0518485115215126e-05, "add_time_dim_to_batch_and_zero_pad": 3.71641993378481e-06, "numpy_to_tensor": 1.5095566099955114e-05, "add_observations_from_episodes_to_batch": 4.539684555241117e-06, "add_states_from_episodes_to_batch": 2.5277037455391774e-06}}, "connector_pipeline_timer": 6.817670066570168e-05}, "agent_episode_returns_mean": {"default_agent": 3.7799999999999994}, "env_to_module_sum_episodes_length_out": 10.36823839457432, "num_module_steps_sampled": {"default_policy": 5000.0}, "episode_return_min": -13.5, "time_between_sampling": 0.002723169537560661, "episode_len_min": 20, "episode_len_mean": 20.0, "episode_return_mean": 3.7799999999999994, "episode_len_max": 20, "sample": 0.008205255719992009, "num_env_steps_sampled": 5000.0, "episode_duration_sec_mean": 0.007435752464924007, "env_to_module_sum_episodes_length_in": 10.36823839457432, "env_step_timer": 2.3622348618809932e-05, "num_module_steps_sampled_lifetime": {"default_policy": -6782500.0}, "num_episodes_lifetime": -339125.0, "num_env_steps_sampled_lifetime": -6782500.0, "num_agent_steps_sampled_lifetime": {"default_agent": -6782500.0}, "env_reset_timer": 7.13351245319566e-05, "rlmodule_inference_timer": 4.7202492284760306e-05, "module_episode_returns_mean": {"default_policy": 3.7799999999999994}, "num_agent_steps_sampled": {"default_agent": 5000.0}, "num_env_steps_sampled_lifetime_throughput": 2477.5044187953386}, "learners": {"default_policy": {"vf_loss_unclipped": 23.493480682373047, "default_optimizer_learning_rate": 0.0002847858517, "module_train_batch_size_mean": 1000.0, "vf_loss": 0.10278083384037018, "entropy": 0.47413647174835205, "total_loss": 0.006881259847432375, "policy_loss": -0.0575651116669178, "vf_explained_var": -0.021043896675109863, "mean_kl_loss": 0.00026610048371367157, "diff_num_grad_updates_vs_sampler_policy": 1.0, "gradients_default_optimizer_global_norm": 0.11829666048288345, "num_module_steps_trained_lifetime": 78000, "curr_entropy_coeff": 0.0090570820258, "num_module_steps_trained": 6000, "num_trainable_parameters": 6003, "curr_kl_coeff": 9.112503903452307e-05, "weights_seq_no": 13.0, "num_module_steps_trained_lifetime_throughput": 233089.79822583642}, "__all_modules__": {"learner_connector": {"timers": {"connectors": {"add_observations_from_episodes_to_batch": 0.0008749164126756402, "general_advantage_estimation": 0.00964863939938626, "add_one_ts_to_episodes_and_truncate": 0.010736202401404781, "add_columns_from_episodes_to_train_batch": 0.03964243635282754, "numpy_to_tensor": 0.00013594357395959767, "add_states_from_episodes_to_batch": 3.7560093934821284e-06, "batch_individual_items": 0.05109799346893245, "add_time_dim_to_batch_and_zero_pad": 1.250705503618434e-05}}, "connector_pipeline_timer": 0.11237185080482358}, "num_env_steps_trained": 31500, "num_env_steps_trained_lifetime": 409500, "num_module_steps_trained_lifetime": 78000, "learner_connector_sum_episodes_length_in": 5000.0, "num_trainable_parameters": 6003, "learner_connector_sum_episodes_length_out": 5250.0, "num_module_steps_trained": 6000, "num_non_trainable_parameters": 0, "num_env_steps_trained_lifetime_throughput": 1221576.5555900338, "num_module_steps_trained_throughput": 233079.62131815095, "num_module_steps_trained_lifetime_throughput": 232907.98083285353}}, "num_training_step_calls_per_iteration": 1, "evaluation": {"env_runners": {"module_to_env_connector": {"connector_pipeline_timer": 0.00015885474838416242, "timers": {"connectors": {"remove_single_ts_time_rank_from_batch": 8.772810967290887e-07, "listify_data_for_vector_env": 1.672417004759487e-05, "normalize_and_clip_actions": 1.4753711148124017e-05, "get_actions": 6.096154325013841e-05, "tensor_to_numpy": 2.0194798341081716e-05, "un_batch_to_individual_items": 7.81852618459779e-06}}}, "num_episodes_lifetime": 260, "weights_seq_no": 13.0, "episode_return_max": 12.5, "num_env_steps_sampled": 400, "env_to_module_sum_episodes_length_in": 10.368238394574323, "env_to_module_connector": {"timers": {"connectors": {"add_observations_from_episodes_to_batch": 4.229811077923913e-06, "numpy_to_tensor": 1.3989769671489309e-05, "add_states_from_episodes_to_batch": 2.0889114196421573e-06, "batch_individual_items": 1.0375234928963696e-05, "add_time_dim_to_batch_and_zero_pad": 3.2830323942052273e-06}}, "connector_pipeline_timer": 6.434731113463512e-05}, "env_to_module_sum_episodes_length_out": 10.368238394574323, "episode_len_max": 20, "episode_duration_sec_mean": 0.008031135002383963, "env_step_timer": 2.2182832552496577e-05, "num_env_steps_sampled_lifetime": 65400, "rlmodule_inference_timer": 4.454800721683392e-05, "num_module_steps_sampled_lifetime": {"default_policy": 5200}, "num_agent_steps_sampled_lifetime": {"default_agent": 5200}, "num_agent_steps_sampled": {"default_agent": 400}, "episode_len_mean": 20.0, "episode_return_mean": 1.1, "agent_episode_returns_mean": {"default_agent": 1.1}, "num_module_steps_sampled": {"default_policy": 400}, "env_reset_timer": 0.00014894311054659178, "num_episodes": 20, "episode_return_min": -15.5, "module_episode_returns_mean": {"default_policy": 1.1}, "episode_len_min": 20, "sample": 0.16545448508539878, "time_between_sampling": 2.607448778223845}, "num_healthy_workers": 1, "actor_manager_num_outstanding_async_reqs": 0, "num_remote_worker_restarts": 0}, "num_env_steps_sampled_lifetime": -6782500.0, "fault_tolerance": {"num_healthy_workers": 0, "num_remote_worker_restarts": 0}, "env_runner_group": {"actor_manager_num_outstanding_async_reqs": 0}, "done": false, "training_iteration": 13, "trial_id": "46b1a_00000", "date": "2025-08-11_19-34-48", "timestamp": 1754933688, "time_this_iter_s": 2.6855409145355225, "time_total_s": 35.61430549621582, "pid": 26849, "hostname": "Mac", "node_ip": "127.0.0.1", "config": {"exploration_config": {}, "extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "placement_strategy": "PACK", "num_gpus": 0, "_fake_gpus": false, "num_cpus_for_main_process": 2, "eager_tracing": true, "eager_max_retraces": 20, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "torch_compile_learner": false, "torch_compile_learner_what_to_compile": "forward_train", "torch_compile_learner_dynamo_backend": "aot_eager", "torch_compile_learner_dynamo_mode": null, "torch_compile_worker": false, "torch_compile_worker_dynamo_backend": "aot_eager", "torch_compile_worker_dynamo_mode": null, "torch_ddp_kwargs": {}, "torch_skip_nan_gradients": false, "env": "Umbrella", "env_config": {}, "observation_space": null, "action_space": null, "clip_rewards": null, "normalize_actions": true, "clip_actions": false, "_is_atari": null, "disable_env_checking": false, "render_env": false, "action_mask_key": "action_mask", "env_runner_cls": null, "num_env_runners": 0, "create_local_env_runner": true, "num_envs_per_env_runner": 1, "gym_env_vectorize_mode": "SYNC", "num_cpus_per_env_runner": 1, "num_gpus_per_env_runner": 0, "custom_resources_per_env_runner": {}, "validate_env_runners_after_construction": true, "episodes_to_numpy": true, "max_requests_in_flight_per_env_runner": 1, "sample_timeout_s": 60.0, "_env_to_module_connector": null, "add_default_connectors_to_env_to_module_pipeline": true, "_module_to_env_connector": null, "add_default_connectors_to_module_to_env_pipeline": true, "merge_env_runner_states": "training_only", "broadcast_env_runner_states": true, "episode_lookback_horizon": 1, "rollout_fragment_length": "auto", "batch_mode": "complete_episodes", "compress_observations": false, "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "enable_tf1_exec_eagerly": false, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "preprocessor_pref": "deepmind", "observation_filter": "NoFilter", "update_worker_filter_stats": true, "use_worker_filter_stats": true, "sampler_perf_stats_ema_coef": null, "_is_online": true, "num_learners": 0, "num_gpus_per_learner": 0, "num_cpus_per_learner": "auto", "num_aggregator_actors_per_learner": 0, "max_requests_in_flight_per_aggregator_actor": 3, "local_gpu_idx": 0, "max_requests_in_flight_per_learner": 3, "gamma": 1, "lr": 0.0002847858517, "grad_clip": 0.5, "grad_clip_by": "global_norm", "_train_batch_size_per_learner": 5000, "train_batch_size": 4000, "num_epochs": 1, "minibatch_size": 1000, "shuffle_batch_per_epoch": true, "model": {"fcnet_hiddens": [256, 256], "fcnet_activation": "tanh", "fcnet_weights_initializer": null, "fcnet_weights_initializer_config": null, "fcnet_bias_initializer": null, "fcnet_bias_initializer_config": null, "conv_filters": null, "conv_activation": "relu", "conv_kernel_initializer": null, "conv_kernel_initializer_config": null, "conv_bias_initializer": null, "conv_bias_initializer_config": null, "conv_transpose_kernel_initializer": null, "conv_transpose_kernel_initializer_config": null, "conv_transpose_bias_initializer": null, "conv_transpose_bias_initializer_config": null, "post_fcnet_hiddens": [], "post_fcnet_activation": "relu", "post_fcnet_weights_initializer": null, "post_fcnet_weights_initializer_config": null, "post_fcnet_bias_initializer": null, "post_fcnet_bias_initializer_config": null, "free_log_std": false, "log_std_clip_param": 20.0, "no_final_linear": false, "vf_share_layers": false, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "lstm_weights_initializer": null, "lstm_weights_initializer_config": null, "lstm_bias_initializer": null, "lstm_bias_initializer_config": null, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "attention_use_n_prev_actions": 0, "attention_use_n_prev_rewards": 0, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": null, "custom_model_config": {}, "custom_action_dist": null, "custom_preprocessor": null, "encoder_latent_dim": null, "always_check_shapes": false, "lstm_use_prev_action_reward": -1, "_use_default_native_models": -1, "_disable_preprocessor_api": false, "_disable_action_flattening": false}, "_learner_connector": null, "add_default_connectors_to_learner_pipeline": true, "learner_config_dict": {}, "optimizer": {}, "_learner_class": null, "callbacks_on_algorithm_init": null, "callbacks_on_env_runners_recreated": null, "callbacks_on_offline_eval_runners_recreated": null, "callbacks_on_checkpoint_loaded": null, "callbacks_on_environment_created": null, "callbacks_on_episode_created": null, "callbacks_on_episode_start": null, "callbacks_on_episode_step": null, "callbacks_on_episode_end": null, "callbacks_on_evaluate_start": null, "callbacks_on_evaluate_end": null, "callbacks_on_evaluate_offline_start": null, "callbacks_on_evaluate_offline_end": null, "callbacks_on_sample_end": null, "callbacks_on_train_result": null, "explore": true, "enable_rl_module_and_learner": true, "enable_env_runner_and_connector_v2": true, "_prior_exploration_config": {"type": "StochasticSampling"}, "count_steps_by": "env_steps", "policy_map_capacity": 100, "policy_mapping_fn": "<function AlgorithmConfig.DEFAULT_POLICY_MAPPING_FN at 0x13bfddb20>", "policies_to_train": null, "policy_states_are_swappable": false, "observation_fn": null, "offline_data_class": null, "input_read_method": "read_parquet", "input_read_method_kwargs": {}, "input_read_schema": {}, "input_read_episodes": false, "input_read_sample_batches": false, "input_read_batch_size": null, "input_filesystem": null, "input_filesystem_kwargs": {}, "input_compress_columns": ["obs", "new_obs"], "input_spaces_jsonable": true, "materialize_data": false, "materialize_mapped_data": true, "map_batches_kwargs": {}, "iter_batches_kwargs": {}, "ignore_final_observation": false, "prelearner_class": null, "prelearner_buffer_class": null, "prelearner_buffer_kwargs": {}, "prelearner_module_synch_period": 10, "dataset_num_iters_per_learner": null, "input_config": {}, "actions_in_input_normalized": false, "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_config": {}, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "output_max_rows_per_file": null, "output_write_remaining_data": false, "output_write_method": "write_parquet", "output_write_method_kwargs": {}, "output_filesystem": null, "output_filesystem_kwargs": {}, "output_write_episodes": true, "offline_sampling": false, "evaluation_interval": 1, "evaluation_duration": 20, "evaluation_duration_unit": "episodes", "evaluation_sample_timeout_s": 120.0, "evaluation_auto_duration_min_env_steps_per_sample": 100, "evaluation_auto_duration_max_env_steps_per_sample": 2000, "evaluation_parallel_to_training": false, "evaluation_force_reset_envs_before_iteration": true, "evaluation_config": null, "off_policy_estimation_methods": {}, "ope_split_batch_by_episode": true, "evaluation_num_env_runners": 1, "in_evaluation": false, "sync_filters_on_rollout_workers_timeout_s": 10.0, "offline_evaluation_interval": null, "num_offline_eval_runners": 0, "offline_loss_for_module_fn": null, "offline_evaluation_duration": 1, "offline_evaluation_parallel_to_training": false, "offline_evaluation_timeout_s": 120.0, "num_cpus_per_offline_eval_runner": 1, "num_gpus_per_offline_eval_runner": 0, "custom_resources_per_offline_eval_runner": {}, "restart_failed_offline_eval_runners": true, "ignore_offline_eval_runner_failures": false, "max_num_offline_eval_runner_restarts": 1000, "offline_eval_runner_restore_timeout_s": 1800.0, "max_requests_in_flight_per_offline_eval_runner": 1, "validate_offline_eval_runners_after_construction": true, "offline_eval_runner_health_probe_timeout_s": 30.0, "offline_eval_rl_module_inference_only": false, "broadcast_offline_eval_runner_states": false, "offline_eval_batch_size_per_runner": 256, "dataset_num_iters_per_eval_runner": 1, "keep_per_episode_custom_metrics": false, "metrics_episode_collection_timeout_s": 60.0, "metrics_num_episodes_for_smoothing": 100, "min_time_s_per_iteration": null, "min_train_timesteps_per_iteration": 0, "min_sample_timesteps_per_iteration": 0, "log_gradients": true, "export_native_model_files": false, "checkpoint_trainable_policies_only": false, "logger_creator": null, "logger_config": null, "log_level": "WARN", "log_sys_usage": true, "fake_sampler": false, "seed": 5, "restart_failed_env_runners": true, "ignore_env_runner_failures": false, "max_num_env_runner_restarts": 1000, "delay_between_env_runner_restarts_s": 60.0, "restart_failed_sub_environments": false, "num_consecutive_env_runner_failures_tolerance": 100, "env_runner_health_probe_timeout_s": 30.0, "env_runner_restore_timeout_s": 1800.0, "_model_config": {}, "_rl_module_spec": "RLModuleSpec(module_class=None, observation_space=None, action_space=None, inference_only=False, learner_only=False, model_config=DefaultModelConfig(fcnet_hiddens=[60, 90], fcnet_activation='tanh', fcnet_kernel_initializer=None, fcnet_kernel_initializer_kwargs=None, fcnet_bias_initializer=None, fcnet_bias_initializer_kwargs=None, conv_filters=None, conv_activation='relu', conv_kernel_initializer=None, conv_kernel_initializer_kwargs=None, conv_bias_initializer=None, conv_bias_initializer_kwargs=None, head_fcnet_hiddens=[], head_fcnet_activation='relu', head_fcnet_kernel_initializer=None, head_fcnet_kernel_initializer_kwargs=None, head_fcnet_bias_initializer=None, head_fcnet_bias_initializer_kwargs=None, free_log_std=False, log_std_clip_param=20.0, vf_share_layers=True, use_lstm=False, max_seq_len=20, lstm_cell_size=256, lstm_use_prev_action=False, lstm_use_prev_reward=False, lstm_kernel_initializer=None, lstm_kernel_initializer_kwargs=None, lstm_bias_initializer=None, lstm_bias_initializer_kwargs=None), catalog_class=None, load_state_path=None, model_config_dict=None)", "algorithm_config_overrides_per_module": {}, "_per_module_overrides": {}, "_validate_config": true, "_use_msgpack_checkpoints": false, "_torch_grad_scaler_class": null, "_torch_lr_scheduler_classes": null, "_tf_policy_handles_more_than_one_loss": false, "_disable_preprocessor_api": false, "_disable_action_flattening": false, "_disable_initialize_loss_from_dummy_batch": false, "_dont_auto_sync_env_runner_states": false, "env_task_fn": -1, "enable_connectors": -1, "simple_optimizer": false, "policy_map_cache": -1, "worker_cls": -1, "synchronize_filters": -1, "enable_async_evaluation": -1, "custom_async_evaluation_function": -1, "_enable_rl_module_api": -1, "auto_wrap_old_gym_envs": -1, "always_attach_evaluation_results": -1, "replay_sequence_length": null, "_disable_execution_plan_api": -1, "use_critic": true, "use_gae": true, "use_kl_loss": true, "kl_coeff": 0.7464963036515, "kl_target": 0.0270990929592, "vf_loss_coeff": 0.6688075857018, "entropy_coeff": 0.0090570820258, "clip_param": 0.1221781641624, "vf_clip_param": 0.1027808522125, "entropy_coeff_schedule": null, "lr_schedule": null, "sgd_minibatch_size": -1, "vf_share_layers": -1, "__stdout_file__": null, "__stderr_file__": null, "lambda": 0.9099046732075, "input": "sampler", "policies": {"default_policy": [null, null, null, null]}, "callbacks": "<class 'ray.rllib.callbacks.callbacks.RLlibCallback'>", "create_env_on_driver": false, "custom_eval_function": null, "framework": "torch"}, "time_since_restore": 35.61430549621582, "iterations_since_restore": 13, "perf": {"cpu_util_percent": 68.525, "ram_util_percent": 78.57500000000002}}
{"timers": {"training_iteration": 2.52803701920329, "restore_env_runners": 1.253920378822463e-05, "training_step": 2.527881336915045, "env_runner_sampling_timer": 2.367296083143254, "learner_update_timer": 0.1572063649327269, "synch_weights": 0.0006558877148235543, "restore_eval_env_runners": 8.976922364646629e-06, "evaluation_iteration": 0.17264615935285899, "synch_eval_env_connectors": 0.00013554158793213455, "synch_env_connectors": 5.369393384296999e-06}, "env_runners": {"weights_seq_no": 13.0, "episode_return_max": 6.5, "num_episodes": 250.0, "module_to_env_connector": {"timers": {"connectors": {"tensor_to_numpy": 2.1382456172467526e-05, "remove_single_ts_time_rank_from_batch": 8.521747287929202e-07, "listify_data_for_vector_env": 1.7070235239724585e-05, "get_actions": 6.870373143216513e-05, "normalize_and_clip_actions": 1.4041521072577635e-05, "un_batch_to_individual_items": 8.063180490845301e-06}}, "connector_pipeline_timer": 0.00016728815766517475}, "env_to_module_connector": {"timers": {"connectors": {"batch_individual_items": 1.0142539174410533e-05, "add_time_dim_to_batch_and_zero_pad": 3.5277506633656677e-06, "numpy_to_tensor": 1.4718524735769454e-05, "add_observations_from_episodes_to_batch": 4.442427760085315e-06, "add_states_from_episodes_to_batch": 2.648459352644456e-06}}, "connector_pipeline_timer": 6.631977508013687e-05}, "agent_episode_returns_mean": {"default_agent": 4.18}, "env_to_module_sum_episodes_length_out": 10.36823839457432, "num_module_steps_sampled": {"default_policy": 5000.0}, "episode_return_min": -13.5, "time_between_sampling": 0.0025923320041468714, "episode_len_min": 20, "episode_len_mean": 20.0, "episode_return_mean": 4.18, "episode_len_max": 20, "sample": 0.007730484262077673, "num_env_steps_sampled": 5000.0, "episode_duration_sec_mean": 0.007360134837217632, "env_to_module_sum_episodes_length_in": 10.36823839457432, "env_step_timer": 2.2660572330706587e-05, "num_module_steps_sampled_lifetime": {"default_policy": -7400000.0}, "num_episodes_lifetime": -370000.0, "num_env_steps_sampled_lifetime": -7400000.0, "num_agent_steps_sampled_lifetime": {"default_agent": -7400000.0}, "env_reset_timer": 6.713477309225541e-05, "rlmodule_inference_timer": 4.673047055445654e-05, "module_episode_returns_mean": {"default_policy": 4.18}, "num_agent_steps_sampled": {"default_agent": 5000.0}, "num_env_steps_sampled_lifetime_throughput": 2547.2173283634156}, "learners": {"default_policy": {"vf_loss_unclipped": 23.913816452026367, "default_optimizer_learning_rate": 0.0002847858517, "module_train_batch_size_mean": 1000.0, "vf_loss": 0.10278083384037018, "entropy": 0.47302621603012085, "total_loss": 0.11405530571937561, "policy_loss": 0.04959893226623535, "vf_explained_var": -0.019382357597351074, "mean_kl_loss": 4.542641545413062e-05, "diff_num_grad_updates_vs_sampler_policy": 1.0, "gradients_default_optimizer_global_norm": 0.035817701369524, "num_module_steps_trained_lifetime": 84000, "curr_entropy_coeff": 0.0090570820258, "num_module_steps_trained": 6000, "num_trainable_parameters": 6003, "curr_kl_coeff": 4.5562519517261535e-05, "weights_seq_no": 14.0, "num_module_steps_trained_lifetime_throughput": 235222.67198614767}, "__all_modules__": {"learner_connector": {"timers": {"connectors": {"add_observations_from_episodes_to_batch": 0.000876608498018179, "general_advantage_estimation": 0.009641228006116222, "add_one_ts_to_episodes_and_truncate": 0.010737777457176126, "add_columns_from_episodes_to_train_batch": 0.03975099073896749, "numpy_to_tensor": 0.00013566454807651483, "add_states_from_episodes_to_batch": 3.7901203924300596e-06, "batch_individual_items": 0.052200443114126936, "add_time_dim_to_batch_and_zero_pad": 1.2607404130088863e-05}}, "connector_pipeline_timer": 0.11357841020583442}, "num_env_steps_trained": 31500, "num_env_steps_trained_lifetime": 441000, "num_module_steps_trained_lifetime": 84000, "learner_connector_sum_episodes_length_in": 5000.0, "num_trainable_parameters": 6003, "learner_connector_sum_episodes_length_out": 5250.0, "num_module_steps_trained": 6000, "num_non_trainable_parameters": 0, "num_env_steps_trained_lifetime_throughput": 1232963.1025764016, "num_module_steps_trained_throughput": 235232.7972779505, "num_module_steps_trained_lifetime_throughput": 235066.34878581966}}, "num_training_step_calls_per_iteration": 1, "evaluation": {"env_runners": {"module_to_env_connector": {"connector_pipeline_timer": 0.00013357086734548743, "timers": {"connectors": {"remove_single_ts_time_rank_from_batch": 6.955364853736538e-07, "listify_data_for_vector_env": 1.4773824259056871e-05, "normalize_and_clip_actions": 1.142205983342572e-05, "get_actions": 5.127510453878639e-05, "tensor_to_numpy": 1.694725296589553e-05, "un_batch_to_individual_items": 7.009568515285778e-06}}}, "num_episodes_lifetime": 280, "weights_seq_no": 14.0, "episode_return_max": 12.5, "num_env_steps_sampled": 400, "env_to_module_sum_episodes_length_in": 10.368238394574323, "env_to_module_connector": {"timers": {"connectors": {"add_observations_from_episodes_to_batch": 3.4149760587240214e-06, "numpy_to_tensor": 1.2126536491486104e-05, "add_states_from_episodes_to_batch": 2.029286645232134e-06, "batch_individual_items": 9.622792073940484e-06, "add_time_dim_to_batch_and_zero_pad": 2.743589691825162e-06}}, "connector_pipeline_timer": 5.670046210553875e-05}, "env_to_module_sum_episodes_length_out": 10.368238394574323, "episode_len_max": 20, "episode_duration_sec_mean": 0.007793907526647672, "env_step_timer": 1.8903796997527255e-05, "num_env_steps_sampled_lifetime": 70400, "rlmodule_inference_timer": 3.8450426927826214e-05, "num_module_steps_sampled_lifetime": {"default_policy": 5600}, "num_agent_steps_sampled_lifetime": {"default_agent": 5600}, "num_agent_steps_sampled": {"default_agent": 400}, "episode_len_mean": 20.0, "episode_return_mean": 1.9, "agent_episode_returns_mean": {"default_agent": 1.9}, "num_module_steps_sampled": {"default_policy": 400}, "env_reset_timer": 0.00014823159921786356, "num_episodes": 20, "episode_return_min": -15.5, "module_episode_returns_mean": {"default_policy": 1.9}, "episode_len_min": 20, "sample": 0.1654049493940837, "time_between_sampling": 2.606471466691444}, "num_healthy_workers": 1, "actor_manager_num_outstanding_async_reqs": 0, "num_remote_worker_restarts": 0}, "num_env_steps_sampled_lifetime": -7400000.0, "fault_tolerance": {"num_healthy_workers": 0, "num_remote_worker_restarts": 0}, "env_runner_group": {"actor_manager_num_outstanding_async_reqs": 0}, "done": false, "training_iteration": 14, "trial_id": "46b1a_00000", "date": "2025-08-11_19-34-50", "timestamp": 1754933690, "time_this_iter_s": 2.6585659980773926, "time_total_s": 38.27287149429321, "pid": 26849, "hostname": "Mac", "node_ip": "127.0.0.1", "config": {"exploration_config": {}, "extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "placement_strategy": "PACK", "num_gpus": 0, "_fake_gpus": false, "num_cpus_for_main_process": 2, "eager_tracing": true, "eager_max_retraces": 20, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "torch_compile_learner": false, "torch_compile_learner_what_to_compile": "forward_train", "torch_compile_learner_dynamo_backend": "aot_eager", "torch_compile_learner_dynamo_mode": null, "torch_compile_worker": false, "torch_compile_worker_dynamo_backend": "aot_eager", "torch_compile_worker_dynamo_mode": null, "torch_ddp_kwargs": {}, "torch_skip_nan_gradients": false, "env": "Umbrella", "env_config": {}, "observation_space": null, "action_space": null, "clip_rewards": null, "normalize_actions": true, "clip_actions": false, "_is_atari": null, "disable_env_checking": false, "render_env": false, "action_mask_key": "action_mask", "env_runner_cls": null, "num_env_runners": 0, "create_local_env_runner": true, "num_envs_per_env_runner": 1, "gym_env_vectorize_mode": "SYNC", "num_cpus_per_env_runner": 1, "num_gpus_per_env_runner": 0, "custom_resources_per_env_runner": {}, "validate_env_runners_after_construction": true, "episodes_to_numpy": true, "max_requests_in_flight_per_env_runner": 1, "sample_timeout_s": 60.0, "_env_to_module_connector": null, "add_default_connectors_to_env_to_module_pipeline": true, "_module_to_env_connector": null, "add_default_connectors_to_module_to_env_pipeline": true, "merge_env_runner_states": "training_only", "broadcast_env_runner_states": true, "episode_lookback_horizon": 1, "rollout_fragment_length": "auto", "batch_mode": "complete_episodes", "compress_observations": false, "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "enable_tf1_exec_eagerly": false, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "preprocessor_pref": "deepmind", "observation_filter": "NoFilter", "update_worker_filter_stats": true, "use_worker_filter_stats": true, "sampler_perf_stats_ema_coef": null, "_is_online": true, "num_learners": 0, "num_gpus_per_learner": 0, "num_cpus_per_learner": "auto", "num_aggregator_actors_per_learner": 0, "max_requests_in_flight_per_aggregator_actor": 3, "local_gpu_idx": 0, "max_requests_in_flight_per_learner": 3, "gamma": 1, "lr": 0.0002847858517, "grad_clip": 0.5, "grad_clip_by": "global_norm", "_train_batch_size_per_learner": 5000, "train_batch_size": 4000, "num_epochs": 1, "minibatch_size": 1000, "shuffle_batch_per_epoch": true, "model": {"fcnet_hiddens": [256, 256], "fcnet_activation": "tanh", "fcnet_weights_initializer": null, "fcnet_weights_initializer_config": null, "fcnet_bias_initializer": null, "fcnet_bias_initializer_config": null, "conv_filters": null, "conv_activation": "relu", "conv_kernel_initializer": null, "conv_kernel_initializer_config": null, "conv_bias_initializer": null, "conv_bias_initializer_config": null, "conv_transpose_kernel_initializer": null, "conv_transpose_kernel_initializer_config": null, "conv_transpose_bias_initializer": null, "conv_transpose_bias_initializer_config": null, "post_fcnet_hiddens": [], "post_fcnet_activation": "relu", "post_fcnet_weights_initializer": null, "post_fcnet_weights_initializer_config": null, "post_fcnet_bias_initializer": null, "post_fcnet_bias_initializer_config": null, "free_log_std": false, "log_std_clip_param": 20.0, "no_final_linear": false, "vf_share_layers": false, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "lstm_weights_initializer": null, "lstm_weights_initializer_config": null, "lstm_bias_initializer": null, "lstm_bias_initializer_config": null, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "attention_use_n_prev_actions": 0, "attention_use_n_prev_rewards": 0, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": null, "custom_model_config": {}, "custom_action_dist": null, "custom_preprocessor": null, "encoder_latent_dim": null, "always_check_shapes": false, "lstm_use_prev_action_reward": -1, "_use_default_native_models": -1, "_disable_preprocessor_api": false, "_disable_action_flattening": false}, "_learner_connector": null, "add_default_connectors_to_learner_pipeline": true, "learner_config_dict": {}, "optimizer": {}, "_learner_class": null, "callbacks_on_algorithm_init": null, "callbacks_on_env_runners_recreated": null, "callbacks_on_offline_eval_runners_recreated": null, "callbacks_on_checkpoint_loaded": null, "callbacks_on_environment_created": null, "callbacks_on_episode_created": null, "callbacks_on_episode_start": null, "callbacks_on_episode_step": null, "callbacks_on_episode_end": null, "callbacks_on_evaluate_start": null, "callbacks_on_evaluate_end": null, "callbacks_on_evaluate_offline_start": null, "callbacks_on_evaluate_offline_end": null, "callbacks_on_sample_end": null, "callbacks_on_train_result": null, "explore": true, "enable_rl_module_and_learner": true, "enable_env_runner_and_connector_v2": true, "_prior_exploration_config": {"type": "StochasticSampling"}, "count_steps_by": "env_steps", "policy_map_capacity": 100, "policy_mapping_fn": "<function AlgorithmConfig.DEFAULT_POLICY_MAPPING_FN at 0x13bfddb20>", "policies_to_train": null, "policy_states_are_swappable": false, "observation_fn": null, "offline_data_class": null, "input_read_method": "read_parquet", "input_read_method_kwargs": {}, "input_read_schema": {}, "input_read_episodes": false, "input_read_sample_batches": false, "input_read_batch_size": null, "input_filesystem": null, "input_filesystem_kwargs": {}, "input_compress_columns": ["obs", "new_obs"], "input_spaces_jsonable": true, "materialize_data": false, "materialize_mapped_data": true, "map_batches_kwargs": {}, "iter_batches_kwargs": {}, "ignore_final_observation": false, "prelearner_class": null, "prelearner_buffer_class": null, "prelearner_buffer_kwargs": {}, "prelearner_module_synch_period": 10, "dataset_num_iters_per_learner": null, "input_config": {}, "actions_in_input_normalized": false, "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_config": {}, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "output_max_rows_per_file": null, "output_write_remaining_data": false, "output_write_method": "write_parquet", "output_write_method_kwargs": {}, "output_filesystem": null, "output_filesystem_kwargs": {}, "output_write_episodes": true, "offline_sampling": false, "evaluation_interval": 1, "evaluation_duration": 20, "evaluation_duration_unit": "episodes", "evaluation_sample_timeout_s": 120.0, "evaluation_auto_duration_min_env_steps_per_sample": 100, "evaluation_auto_duration_max_env_steps_per_sample": 2000, "evaluation_parallel_to_training": false, "evaluation_force_reset_envs_before_iteration": true, "evaluation_config": null, "off_policy_estimation_methods": {}, "ope_split_batch_by_episode": true, "evaluation_num_env_runners": 1, "in_evaluation": false, "sync_filters_on_rollout_workers_timeout_s": 10.0, "offline_evaluation_interval": null, "num_offline_eval_runners": 0, "offline_loss_for_module_fn": null, "offline_evaluation_duration": 1, "offline_evaluation_parallel_to_training": false, "offline_evaluation_timeout_s": 120.0, "num_cpus_per_offline_eval_runner": 1, "num_gpus_per_offline_eval_runner": 0, "custom_resources_per_offline_eval_runner": {}, "restart_failed_offline_eval_runners": true, "ignore_offline_eval_runner_failures": false, "max_num_offline_eval_runner_restarts": 1000, "offline_eval_runner_restore_timeout_s": 1800.0, "max_requests_in_flight_per_offline_eval_runner": 1, "validate_offline_eval_runners_after_construction": true, "offline_eval_runner_health_probe_timeout_s": 30.0, "offline_eval_rl_module_inference_only": false, "broadcast_offline_eval_runner_states": false, "offline_eval_batch_size_per_runner": 256, "dataset_num_iters_per_eval_runner": 1, "keep_per_episode_custom_metrics": false, "metrics_episode_collection_timeout_s": 60.0, "metrics_num_episodes_for_smoothing": 100, "min_time_s_per_iteration": null, "min_train_timesteps_per_iteration": 0, "min_sample_timesteps_per_iteration": 0, "log_gradients": true, "export_native_model_files": false, "checkpoint_trainable_policies_only": false, "logger_creator": null, "logger_config": null, "log_level": "WARN", "log_sys_usage": true, "fake_sampler": false, "seed": 5, "restart_failed_env_runners": true, "ignore_env_runner_failures": false, "max_num_env_runner_restarts": 1000, "delay_between_env_runner_restarts_s": 60.0, "restart_failed_sub_environments": false, "num_consecutive_env_runner_failures_tolerance": 100, "env_runner_health_probe_timeout_s": 30.0, "env_runner_restore_timeout_s": 1800.0, "_model_config": {}, "_rl_module_spec": "RLModuleSpec(module_class=None, observation_space=None, action_space=None, inference_only=False, learner_only=False, model_config=DefaultModelConfig(fcnet_hiddens=[60, 90], fcnet_activation='tanh', fcnet_kernel_initializer=None, fcnet_kernel_initializer_kwargs=None, fcnet_bias_initializer=None, fcnet_bias_initializer_kwargs=None, conv_filters=None, conv_activation='relu', conv_kernel_initializer=None, conv_kernel_initializer_kwargs=None, conv_bias_initializer=None, conv_bias_initializer_kwargs=None, head_fcnet_hiddens=[], head_fcnet_activation='relu', head_fcnet_kernel_initializer=None, head_fcnet_kernel_initializer_kwargs=None, head_fcnet_bias_initializer=None, head_fcnet_bias_initializer_kwargs=None, free_log_std=False, log_std_clip_param=20.0, vf_share_layers=True, use_lstm=False, max_seq_len=20, lstm_cell_size=256, lstm_use_prev_action=False, lstm_use_prev_reward=False, lstm_kernel_initializer=None, lstm_kernel_initializer_kwargs=None, lstm_bias_initializer=None, lstm_bias_initializer_kwargs=None), catalog_class=None, load_state_path=None, model_config_dict=None)", "algorithm_config_overrides_per_module": {}, "_per_module_overrides": {}, "_validate_config": true, "_use_msgpack_checkpoints": false, "_torch_grad_scaler_class": null, "_torch_lr_scheduler_classes": null, "_tf_policy_handles_more_than_one_loss": false, "_disable_preprocessor_api": false, "_disable_action_flattening": false, "_disable_initialize_loss_from_dummy_batch": false, "_dont_auto_sync_env_runner_states": false, "env_task_fn": -1, "enable_connectors": -1, "simple_optimizer": false, "policy_map_cache": -1, "worker_cls": -1, "synchronize_filters": -1, "enable_async_evaluation": -1, "custom_async_evaluation_function": -1, "_enable_rl_module_api": -1, "auto_wrap_old_gym_envs": -1, "always_attach_evaluation_results": -1, "replay_sequence_length": null, "_disable_execution_plan_api": -1, "use_critic": true, "use_gae": true, "use_kl_loss": true, "kl_coeff": 0.7464963036515, "kl_target": 0.0270990929592, "vf_loss_coeff": 0.6688075857018, "entropy_coeff": 0.0090570820258, "clip_param": 0.1221781641624, "vf_clip_param": 0.1027808522125, "entropy_coeff_schedule": null, "lr_schedule": null, "sgd_minibatch_size": -1, "vf_share_layers": -1, "__stdout_file__": null, "__stderr_file__": null, "lambda": 0.9099046732075, "input": "sampler", "policies": {"default_policy": [null, null, null, null]}, "callbacks": "<class 'ray.rllib.callbacks.callbacks.RLlibCallback'>", "create_env_on_driver": false, "custom_eval_function": null, "framework": "torch"}, "time_since_restore": 38.27287149429321, "iterations_since_restore": 14, "perf": {"cpu_util_percent": 67.96666666666667, "ram_util_percent": 78.10000000000001}}
{"timers": {"training_iteration": 2.5276829177618256, "restore_env_runners": 1.2485481679071918e-05, "training_step": 2.5275266789660527, "env_runner_sampling_timer": 2.3660465956418033, "learner_update_timer": 0.15809989419370243, "synch_weights": 0.0006554259271745538, "restore_eval_env_runners": 8.960073370286118e-06, "evaluation_iteration": 0.17258135275881004, "synch_eval_env_connectors": 0.00013527700108062983, "synch_env_connectors": 5.358619451305184e-06}, "env_runners": {"weights_seq_no": 14.0, "episode_return_max": 6.5, "num_episodes": 250.0, "module_to_env_connector": {"timers": {"connectors": {"tensor_to_numpy": 2.1935248456087514e-05, "remove_single_ts_time_rank_from_batch": 9.038067058328595e-07, "listify_data_for_vector_env": 1.7682503729964087e-05, "get_actions": 7.070916718390327e-05, "normalize_and_clip_actions": 1.5277967384542914e-05, "un_batch_to_individual_items": 8.431107575869277e-06}}, "connector_pipeline_timer": 0.00017360169911078115}, "env_to_module_connector": {"timers": {"connectors": {"batch_individual_items": 1.045624797921755e-05, "add_time_dim_to_batch_and_zero_pad": 3.5869598929486565e-06, "numpy_to_tensor": 1.5030638495979782e-05, "add_observations_from_episodes_to_batch": 4.613126590757644e-06, "add_states_from_episodes_to_batch": 2.4579265288215253e-06}}, "connector_pipeline_timer": 6.736189151480045e-05}, "agent_episode_returns_mean": {"default_agent": 4.019999999999998}, "env_to_module_sum_episodes_length_out": 10.36823839457432, "num_module_steps_sampled": {"default_policy": 5000.0}, "episode_return_min": -13.5, "time_between_sampling": 0.0028300123007111377, "episode_len_min": 20, "episode_len_mean": 20.0, "episode_return_mean": 4.019999999999998, "episode_len_max": 20, "sample": 0.008016307110614317, "num_env_steps_sampled": 5000.0, "episode_duration_sec_mean": 0.007403445820789782, "env_to_module_sum_episodes_length_in": 10.36823839457432, "env_step_timer": 2.3482177566159835e-05, "num_module_steps_sampled_lifetime": {"default_policy": -8017500.0}, "num_episodes_lifetime": -400875.0, "num_env_steps_sampled_lifetime": -8017500.0, "num_agent_steps_sampled_lifetime": {"default_agent": -8017500.0}, "env_reset_timer": 6.956276769679159e-05, "rlmodule_inference_timer": 4.73146837734246e-05, "module_episode_returns_mean": {"default_policy": 4.019999999999998}, "num_agent_steps_sampled": {"default_agent": 5000.0}, "num_env_steps_sampled_lifetime_throughput": 2506.994424132396}, "learners": {"default_policy": {"vf_loss_unclipped": 23.113862991333008, "default_optimizer_learning_rate": 0.0002847858517, "module_train_batch_size_mean": 1000.0, "vf_loss": 0.10278083384037018, "entropy": 0.452986478805542, "total_loss": 0.004048810340464115, "policy_loss": -0.06058907508850098, "vf_explained_var": -0.02093040943145752, "mean_kl_loss": 0.00023884468828327954, "diff_num_grad_updates_vs_sampler_policy": 1.0, "gradients_default_optimizer_global_norm": 0.042700961232185364, "num_module_steps_trained_lifetime": 90000, "curr_entropy_coeff": 0.0090570820258, "num_module_steps_trained": 6000, "num_trainable_parameters": 6003, "curr_kl_coeff": 2.2781259758630767e-05, "weights_seq_no": 15.0, "num_module_steps_trained_lifetime_throughput": 237302.400540205}, "__all_modules__": {"learner_connector": {"timers": {"connectors": {"add_observations_from_episodes_to_batch": 0.0008773103221505699, "general_advantage_estimation": 0.009605901555566345, "add_one_ts_to_episodes_and_truncate": 0.01072163301291748, "add_columns_from_episodes_to_train_batch": 0.039748038331835905, "numpy_to_tensor": 0.0001351341521933438, "add_states_from_episodes_to_batch": 3.7859691544566058e-06, "batch_individual_items": 0.05338754076318926, "add_time_dim_to_batch_and_zero_pad": 1.260007953781754e-05}}, "connector_pipeline_timer": 0.11471035152372767}, "num_env_steps_trained": 31500, "num_env_steps_trained_lifetime": 472500, "num_module_steps_trained_lifetime": 90000, "learner_connector_sum_episodes_length_in": 5000.0, "num_trainable_parameters": 6003, "learner_connector_sum_episodes_length_out": 5250.0, "num_module_steps_trained": 6000, "num_non_trainable_parameters": 0, "num_env_steps_trained_lifetime_throughput": 1244068.4771514502, "num_module_steps_trained_throughput": 237334.2265071349, "num_module_steps_trained_lifetime_throughput": 237172.5706338626}}, "num_training_step_calls_per_iteration": 1, "evaluation": {"env_runners": {"module_to_env_connector": {"connector_pipeline_timer": 0.00013601017012314105, "timers": {"connectors": {"remove_single_ts_time_rank_from_batch": 7.954877884258506e-07, "listify_data_for_vector_env": 1.4560725665792944e-05, "normalize_and_clip_actions": 1.225824283357276e-05, "get_actions": 5.1551440771906104e-05, "tensor_to_numpy": 1.79622165867764e-05, "un_batch_to_individual_items": 6.983320279799397e-06}}}, "num_episodes_lifetime": 300, "weights_seq_no": 15.0, "episode_return_max": 12.5, "num_env_steps_sampled": 400, "env_to_module_sum_episodes_length_in": 10.368238394574323, "env_to_module_connector": {"timers": {"connectors": {"add_observations_from_episodes_to_batch": 3.6412273275218567e-06, "numpy_to_tensor": 1.2244713637320927e-05, "add_states_from_episodes_to_batch": 1.899037757963424e-06, "batch_individual_items": 8.70333007044125e-06, "add_time_dim_to_batch_and_zero_pad": 2.8595648467029394e-06}}, "connector_pipeline_timer": 5.5952415931210286e-05}, "env_to_module_sum_episodes_length_out": 10.368238394574323, "episode_len_max": 20, "episode_duration_sec_mean": 0.008230509205022827, "env_step_timer": 1.95794946596102e-05, "num_env_steps_sampled_lifetime": 75400, "rlmodule_inference_timer": 3.7647717732764755e-05, "num_module_steps_sampled_lifetime": {"default_policy": 6000}, "num_agent_steps_sampled_lifetime": {"default_agent": 6000}, "num_agent_steps_sampled": {"default_agent": 400}, "episode_len_mean": 20.0, "episode_return_mean": 2.5, "agent_episode_returns_mean": {"default_agent": 2.5}, "num_module_steps_sampled": {"default_policy": 400}, "env_reset_timer": 0.00014863220326736526, "num_episodes": 20, "episode_return_min": -15.5, "module_episode_returns_mean": {"default_policy": 2.5}, "episode_len_min": 20, "sample": 0.1654757274004359, "time_between_sampling": 2.605608864944181}, "num_healthy_workers": 1, "actor_manager_num_outstanding_async_reqs": 0, "num_remote_worker_restarts": 0}, "num_env_steps_sampled_lifetime": -8017500.0, "fault_tolerance": {"num_healthy_workers": 0, "num_remote_worker_restarts": 0}, "env_runner_group": {"actor_manager_num_outstanding_async_reqs": 0}, "done": false, "training_iteration": 15, "trial_id": "46b1a_00000", "date": "2025-08-11_19-34-53", "timestamp": 1754933693, "time_this_iter_s": 2.6748759746551514, "time_total_s": 40.947747468948364, "pid": 26849, "hostname": "Mac", "node_ip": "127.0.0.1", "config": {"exploration_config": {}, "extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "placement_strategy": "PACK", "num_gpus": 0, "_fake_gpus": false, "num_cpus_for_main_process": 2, "eager_tracing": true, "eager_max_retraces": 20, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "torch_compile_learner": false, "torch_compile_learner_what_to_compile": "forward_train", "torch_compile_learner_dynamo_backend": "aot_eager", "torch_compile_learner_dynamo_mode": null, "torch_compile_worker": false, "torch_compile_worker_dynamo_backend": "aot_eager", "torch_compile_worker_dynamo_mode": null, "torch_ddp_kwargs": {}, "torch_skip_nan_gradients": false, "env": "Umbrella", "env_config": {}, "observation_space": null, "action_space": null, "clip_rewards": null, "normalize_actions": true, "clip_actions": false, "_is_atari": null, "disable_env_checking": false, "render_env": false, "action_mask_key": "action_mask", "env_runner_cls": null, "num_env_runners": 0, "create_local_env_runner": true, "num_envs_per_env_runner": 1, "gym_env_vectorize_mode": "SYNC", "num_cpus_per_env_runner": 1, "num_gpus_per_env_runner": 0, "custom_resources_per_env_runner": {}, "validate_env_runners_after_construction": true, "episodes_to_numpy": true, "max_requests_in_flight_per_env_runner": 1, "sample_timeout_s": 60.0, "_env_to_module_connector": null, "add_default_connectors_to_env_to_module_pipeline": true, "_module_to_env_connector": null, "add_default_connectors_to_module_to_env_pipeline": true, "merge_env_runner_states": "training_only", "broadcast_env_runner_states": true, "episode_lookback_horizon": 1, "rollout_fragment_length": "auto", "batch_mode": "complete_episodes", "compress_observations": false, "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "enable_tf1_exec_eagerly": false, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "preprocessor_pref": "deepmind", "observation_filter": "NoFilter", "update_worker_filter_stats": true, "use_worker_filter_stats": true, "sampler_perf_stats_ema_coef": null, "_is_online": true, "num_learners": 0, "num_gpus_per_learner": 0, "num_cpus_per_learner": "auto", "num_aggregator_actors_per_learner": 0, "max_requests_in_flight_per_aggregator_actor": 3, "local_gpu_idx": 0, "max_requests_in_flight_per_learner": 3, "gamma": 1, "lr": 0.0002847858517, "grad_clip": 0.5, "grad_clip_by": "global_norm", "_train_batch_size_per_learner": 5000, "train_batch_size": 4000, "num_epochs": 1, "minibatch_size": 1000, "shuffle_batch_per_epoch": true, "model": {"fcnet_hiddens": [256, 256], "fcnet_activation": "tanh", "fcnet_weights_initializer": null, "fcnet_weights_initializer_config": null, "fcnet_bias_initializer": null, "fcnet_bias_initializer_config": null, "conv_filters": null, "conv_activation": "relu", "conv_kernel_initializer": null, "conv_kernel_initializer_config": null, "conv_bias_initializer": null, "conv_bias_initializer_config": null, "conv_transpose_kernel_initializer": null, "conv_transpose_kernel_initializer_config": null, "conv_transpose_bias_initializer": null, "conv_transpose_bias_initializer_config": null, "post_fcnet_hiddens": [], "post_fcnet_activation": "relu", "post_fcnet_weights_initializer": null, "post_fcnet_weights_initializer_config": null, "post_fcnet_bias_initializer": null, "post_fcnet_bias_initializer_config": null, "free_log_std": false, "log_std_clip_param": 20.0, "no_final_linear": false, "vf_share_layers": false, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "lstm_weights_initializer": null, "lstm_weights_initializer_config": null, "lstm_bias_initializer": null, "lstm_bias_initializer_config": null, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "attention_use_n_prev_actions": 0, "attention_use_n_prev_rewards": 0, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": null, "custom_model_config": {}, "custom_action_dist": null, "custom_preprocessor": null, "encoder_latent_dim": null, "always_check_shapes": false, "lstm_use_prev_action_reward": -1, "_use_default_native_models": -1, "_disable_preprocessor_api": false, "_disable_action_flattening": false}, "_learner_connector": null, "add_default_connectors_to_learner_pipeline": true, "learner_config_dict": {}, "optimizer": {}, "_learner_class": null, "callbacks_on_algorithm_init": null, "callbacks_on_env_runners_recreated": null, "callbacks_on_offline_eval_runners_recreated": null, "callbacks_on_checkpoint_loaded": null, "callbacks_on_environment_created": null, "callbacks_on_episode_created": null, "callbacks_on_episode_start": null, "callbacks_on_episode_step": null, "callbacks_on_episode_end": null, "callbacks_on_evaluate_start": null, "callbacks_on_evaluate_end": null, "callbacks_on_evaluate_offline_start": null, "callbacks_on_evaluate_offline_end": null, "callbacks_on_sample_end": null, "callbacks_on_train_result": null, "explore": true, "enable_rl_module_and_learner": true, "enable_env_runner_and_connector_v2": true, "_prior_exploration_config": {"type": "StochasticSampling"}, "count_steps_by": "env_steps", "policy_map_capacity": 100, "policy_mapping_fn": "<function AlgorithmConfig.DEFAULT_POLICY_MAPPING_FN at 0x13bfddb20>", "policies_to_train": null, "policy_states_are_swappable": false, "observation_fn": null, "offline_data_class": null, "input_read_method": "read_parquet", "input_read_method_kwargs": {}, "input_read_schema": {}, "input_read_episodes": false, "input_read_sample_batches": false, "input_read_batch_size": null, "input_filesystem": null, "input_filesystem_kwargs": {}, "input_compress_columns": ["obs", "new_obs"], "input_spaces_jsonable": true, "materialize_data": false, "materialize_mapped_data": true, "map_batches_kwargs": {}, "iter_batches_kwargs": {}, "ignore_final_observation": false, "prelearner_class": null, "prelearner_buffer_class": null, "prelearner_buffer_kwargs": {}, "prelearner_module_synch_period": 10, "dataset_num_iters_per_learner": null, "input_config": {}, "actions_in_input_normalized": false, "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_config": {}, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "output_max_rows_per_file": null, "output_write_remaining_data": false, "output_write_method": "write_parquet", "output_write_method_kwargs": {}, "output_filesystem": null, "output_filesystem_kwargs": {}, "output_write_episodes": true, "offline_sampling": false, "evaluation_interval": 1, "evaluation_duration": 20, "evaluation_duration_unit": "episodes", "evaluation_sample_timeout_s": 120.0, "evaluation_auto_duration_min_env_steps_per_sample": 100, "evaluation_auto_duration_max_env_steps_per_sample": 2000, "evaluation_parallel_to_training": false, "evaluation_force_reset_envs_before_iteration": true, "evaluation_config": null, "off_policy_estimation_methods": {}, "ope_split_batch_by_episode": true, "evaluation_num_env_runners": 1, "in_evaluation": false, "sync_filters_on_rollout_workers_timeout_s": 10.0, "offline_evaluation_interval": null, "num_offline_eval_runners": 0, "offline_loss_for_module_fn": null, "offline_evaluation_duration": 1, "offline_evaluation_parallel_to_training": false, "offline_evaluation_timeout_s": 120.0, "num_cpus_per_offline_eval_runner": 1, "num_gpus_per_offline_eval_runner": 0, "custom_resources_per_offline_eval_runner": {}, "restart_failed_offline_eval_runners": true, "ignore_offline_eval_runner_failures": false, "max_num_offline_eval_runner_restarts": 1000, "offline_eval_runner_restore_timeout_s": 1800.0, "max_requests_in_flight_per_offline_eval_runner": 1, "validate_offline_eval_runners_after_construction": true, "offline_eval_runner_health_probe_timeout_s": 30.0, "offline_eval_rl_module_inference_only": false, "broadcast_offline_eval_runner_states": false, "offline_eval_batch_size_per_runner": 256, "dataset_num_iters_per_eval_runner": 1, "keep_per_episode_custom_metrics": false, "metrics_episode_collection_timeout_s": 60.0, "metrics_num_episodes_for_smoothing": 100, "min_time_s_per_iteration": null, "min_train_timesteps_per_iteration": 0, "min_sample_timesteps_per_iteration": 0, "log_gradients": true, "export_native_model_files": false, "checkpoint_trainable_policies_only": false, "logger_creator": null, "logger_config": null, "log_level": "WARN", "log_sys_usage": true, "fake_sampler": false, "seed": 5, "restart_failed_env_runners": true, "ignore_env_runner_failures": false, "max_num_env_runner_restarts": 1000, "delay_between_env_runner_restarts_s": 60.0, "restart_failed_sub_environments": false, "num_consecutive_env_runner_failures_tolerance": 100, "env_runner_health_probe_timeout_s": 30.0, "env_runner_restore_timeout_s": 1800.0, "_model_config": {}, "_rl_module_spec": "RLModuleSpec(module_class=None, observation_space=None, action_space=None, inference_only=False, learner_only=False, model_config=DefaultModelConfig(fcnet_hiddens=[60, 90], fcnet_activation='tanh', fcnet_kernel_initializer=None, fcnet_kernel_initializer_kwargs=None, fcnet_bias_initializer=None, fcnet_bias_initializer_kwargs=None, conv_filters=None, conv_activation='relu', conv_kernel_initializer=None, conv_kernel_initializer_kwargs=None, conv_bias_initializer=None, conv_bias_initializer_kwargs=None, head_fcnet_hiddens=[], head_fcnet_activation='relu', head_fcnet_kernel_initializer=None, head_fcnet_kernel_initializer_kwargs=None, head_fcnet_bias_initializer=None, head_fcnet_bias_initializer_kwargs=None, free_log_std=False, log_std_clip_param=20.0, vf_share_layers=True, use_lstm=False, max_seq_len=20, lstm_cell_size=256, lstm_use_prev_action=False, lstm_use_prev_reward=False, lstm_kernel_initializer=None, lstm_kernel_initializer_kwargs=None, lstm_bias_initializer=None, lstm_bias_initializer_kwargs=None), catalog_class=None, load_state_path=None, model_config_dict=None)", "algorithm_config_overrides_per_module": {}, "_per_module_overrides": {}, "_validate_config": true, "_use_msgpack_checkpoints": false, "_torch_grad_scaler_class": null, "_torch_lr_scheduler_classes": null, "_tf_policy_handles_more_than_one_loss": false, "_disable_preprocessor_api": false, "_disable_action_flattening": false, "_disable_initialize_loss_from_dummy_batch": false, "_dont_auto_sync_env_runner_states": false, "env_task_fn": -1, "enable_connectors": -1, "simple_optimizer": false, "policy_map_cache": -1, "worker_cls": -1, "synchronize_filters": -1, "enable_async_evaluation": -1, "custom_async_evaluation_function": -1, "_enable_rl_module_api": -1, "auto_wrap_old_gym_envs": -1, "always_attach_evaluation_results": -1, "replay_sequence_length": null, "_disable_execution_plan_api": -1, "use_critic": true, "use_gae": true, "use_kl_loss": true, "kl_coeff": 0.7464963036515, "kl_target": 0.0270990929592, "vf_loss_coeff": 0.6688075857018, "entropy_coeff": 0.0090570820258, "clip_param": 0.1221781641624, "vf_clip_param": 0.1027808522125, "entropy_coeff_schedule": null, "lr_schedule": null, "sgd_minibatch_size": -1, "vf_share_layers": -1, "__stdout_file__": null, "__stderr_file__": null, "lambda": 0.9099046732075, "input": "sampler", "policies": {"default_policy": [null, null, null, null]}, "callbacks": "<class 'ray.rllib.callbacks.callbacks.RLlibCallback'>", "create_env_on_driver": false, "custom_eval_function": null, "framework": "torch"}, "time_since_restore": 40.947747468948364, "iterations_since_restore": 15, "perf": {"cpu_util_percent": 67.95, "ram_util_percent": 78.325}}
{"timers": {"training_iteration": 2.5338106415049286, "restore_env_runners": 1.2424797315978643e-05, "training_step": 2.533652838006946, "env_runner_sampling_timer": 2.3719295126054774, "learner_update_timer": 0.15832259150277406, "synch_weights": 0.000659933747477721, "restore_eval_env_runners": 8.943382388490247e-06, "evaluation_iteration": 0.17265280423186327, "synch_eval_env_connectors": 0.0001350613107408488, "synch_env_connectors": 5.344622615285818e-06}, "env_runners": {"weights_seq_no": 15.0, "episode_return_max": 6.5, "num_episodes": 250.0, "module_to_env_connector": {"timers": {"connectors": {"tensor_to_numpy": 2.8051127769326934e-05, "remove_single_ts_time_rank_from_batch": 1.1815487413067432e-06, "listify_data_for_vector_env": 2.2602404240663185e-05, "get_actions": 9.528646567300911e-05, "normalize_and_clip_actions": 2.2689617455856693e-05, "un_batch_to_individual_items": 9.99019401959537e-06}}, "connector_pipeline_timer": 0.0002288378006430094}, "env_to_module_connector": {"timers": {"connectors": {"batch_individual_items": 1.3774482451567783e-05, "add_time_dim_to_batch_and_zero_pad": 4.871646410213086e-06, "numpy_to_tensor": 2.1040761037352842e-05, "add_observations_from_episodes_to_batch": 8.528922218921145e-06, "add_states_from_episodes_to_batch": 2.862387948446898e-06}}, "connector_pipeline_timer": 9.00629323935659e-05}, "agent_episode_returns_mean": {"default_agent": 4.66}, "env_to_module_sum_episodes_length_out": 10.36823839457432, "num_module_steps_sampled": {"default_policy": 5000.0}, "episode_return_min": -13.5, "time_between_sampling": 0.002951215824993654, "episode_len_min": 20, "episode_len_mean": 20.0, "episode_return_mean": 4.66, "episode_len_max": 20, "sample": 0.00994861857407036, "num_env_steps_sampled": 5000.0, "episode_duration_sec_mean": 0.009832238367758692, "env_to_module_sum_episodes_length_in": 10.36823839457432, "env_step_timer": 3.12256740128434e-05, "num_module_steps_sampled_lifetime": {"default_policy": -8635000.0}, "num_episodes_lifetime": -431750.0, "num_env_steps_sampled_lifetime": -8635000.0, "num_agent_steps_sampled_lifetime": {"default_agent": -8635000.0}, "env_reset_timer": 8.758468676319921e-05, "rlmodule_inference_timer": 6.358071849479212e-05, "module_episode_returns_mean": {"default_policy": 4.66}, "num_agent_steps_sampled": {"default_agent": 5000.0}, "num_env_steps_sampled_lifetime_throughput": 2133.0835652851324}, "learners": {"default_policy": {"vf_loss_unclipped": 24.324419021606445, "default_optimizer_learning_rate": 0.0002847858517, "module_train_batch_size_mean": 1000.0, "vf_loss": 0.10278083384037018, "entropy": 0.4430331587791443, "total_loss": 0.21866542100906372, "policy_loss": 0.1539374142885208, "vf_explained_var": -0.018616795539855957, "mean_kl_loss": 0.0002914517535828054, "diff_num_grad_updates_vs_sampler_policy": 1.0, "gradients_default_optimizer_global_norm": 0.11287917196750641, "num_module_steps_trained_lifetime": 96000, "curr_entropy_coeff": 0.0090570820258, "num_module_steps_trained": 6000, "num_trainable_parameters": 6003, "curr_kl_coeff": 1.1390629879315384e-05, "weights_seq_no": 16.0, "num_module_steps_trained_lifetime_throughput": 237589.34130246914}, "__all_modules__": {"learner_connector": {"timers": {"connectors": {"add_observations_from_episodes_to_batch": 0.0008906522185213685, "general_advantage_estimation": 0.009616385869322217, "add_one_ts_to_episodes_and_truncate": 0.01074482876194934, "add_columns_from_episodes_to_train_batch": 0.03985233711852592, "numpy_to_tensor": 0.00013478656103850045, "add_states_from_episodes_to_batch": 3.786439207623558e-06, "batch_individual_items": 0.05345023327526802, "add_time_dim_to_batch_and_zero_pad": 1.2664488806972716e-05}}, "connector_pipeline_timer": 0.11492384966788892}, "num_env_steps_trained": 31500, "num_env_steps_trained_lifetime": 504000, "num_module_steps_trained_lifetime": 96000, "learner_connector_sum_episodes_length_in": 5000.0, "num_trainable_parameters": 6003, "learner_connector_sum_episodes_length_out": 5250.0, "num_module_steps_trained": 6000, "num_non_trainable_parameters": 0, "num_env_steps_trained_lifetime_throughput": 1245729.0086450283, "num_module_steps_trained_throughput": 237640.07217796842, "num_module_steps_trained_lifetime_throughput": 237484.01434698197}}, "num_training_step_calls_per_iteration": 1, "evaluation": {"env_runners": {"module_to_env_connector": {"connector_pipeline_timer": 0.0001761126654301867, "timers": {"connectors": {"remove_single_ts_time_rank_from_batch": 8.854895481287918e-07, "listify_data_for_vector_env": 1.7282522166270527e-05, "normalize_and_clip_actions": 1.4253535908430653e-05, "get_actions": 7.290823709489321e-05, "tensor_to_numpy": 2.2361378648144667e-05, "un_batch_to_individual_items": 8.284799125245898e-06}}}, "num_episodes_lifetime": 320, "weights_seq_no": 16.0, "episode_return_max": 12.5, "num_env_steps_sampled": 400, "env_to_module_sum_episodes_length_in": 10.368238394574323, "env_to_module_connector": {"timers": {"connectors": {"add_observations_from_episodes_to_batch": 4.625843173184533e-06, "numpy_to_tensor": 1.4581843485998141e-05, "add_states_from_episodes_to_batch": 2.325604590496442e-06, "batch_individual_items": 9.758842860716389e-06, "add_time_dim_to_batch_and_zero_pad": 3.1437917619542673e-06}}, "connector_pipeline_timer": 6.405031747894312e-05}, "env_to_module_sum_episodes_length_out": 10.368238394574323, "episode_len_max": 20, "episode_duration_sec_mean": 0.008290336711797863, "env_step_timer": 2.394228001468402e-05, "num_env_steps_sampled_lifetime": 80400, "rlmodule_inference_timer": 4.5962870719817385e-05, "num_module_steps_sampled_lifetime": {"default_policy": 6400}, "num_agent_steps_sampled_lifetime": {"default_agent": 6400}, "num_agent_steps_sampled": {"default_agent": 400}, "episode_len_mean": 20.0, "episode_return_mean": 2.7, "agent_episode_returns_mean": {"default_agent": 2.7}, "num_module_steps_sampled": {"default_policy": 400}, "env_reset_timer": 0.00014904713203294683, "num_episodes": 20, "episode_return_min": -15.5, "module_episode_returns_mean": {"default_policy": 2.7}, "episode_len_min": 20, "sample": 0.1655592597164252, "time_between_sampling": 2.6111966042050416}, "num_healthy_workers": 1, "actor_manager_num_outstanding_async_reqs": 0, "num_remote_worker_restarts": 0}, "num_env_steps_sampled_lifetime": -8635000.0, "fault_tolerance": {"num_healthy_workers": 0, "num_remote_worker_restarts": 0}, "env_runner_group": {"actor_manager_num_outstanding_async_reqs": 0}, "done": false, "training_iteration": 16, "trial_id": "46b1a_00000", "date": "2025-08-11_19-34-56", "timestamp": 1754933696, "time_this_iter_s": 3.3281779289245605, "time_total_s": 44.275925397872925, "pid": 26849, "hostname": "Mac", "node_ip": "127.0.0.1", "config": {"exploration_config": {}, "extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "placement_strategy": "PACK", "num_gpus": 0, "_fake_gpus": false, "num_cpus_for_main_process": 2, "eager_tracing": true, "eager_max_retraces": 20, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "torch_compile_learner": false, "torch_compile_learner_what_to_compile": "forward_train", "torch_compile_learner_dynamo_backend": "aot_eager", "torch_compile_learner_dynamo_mode": null, "torch_compile_worker": false, "torch_compile_worker_dynamo_backend": "aot_eager", "torch_compile_worker_dynamo_mode": null, "torch_ddp_kwargs": {}, "torch_skip_nan_gradients": false, "env": "Umbrella", "env_config": {}, "observation_space": null, "action_space": null, "clip_rewards": null, "normalize_actions": true, "clip_actions": false, "_is_atari": null, "disable_env_checking": false, "render_env": false, "action_mask_key": "action_mask", "env_runner_cls": null, "num_env_runners": 0, "create_local_env_runner": true, "num_envs_per_env_runner": 1, "gym_env_vectorize_mode": "SYNC", "num_cpus_per_env_runner": 1, "num_gpus_per_env_runner": 0, "custom_resources_per_env_runner": {}, "validate_env_runners_after_construction": true, "episodes_to_numpy": true, "max_requests_in_flight_per_env_runner": 1, "sample_timeout_s": 60.0, "_env_to_module_connector": null, "add_default_connectors_to_env_to_module_pipeline": true, "_module_to_env_connector": null, "add_default_connectors_to_module_to_env_pipeline": true, "merge_env_runner_states": "training_only", "broadcast_env_runner_states": true, "episode_lookback_horizon": 1, "rollout_fragment_length": "auto", "batch_mode": "complete_episodes", "compress_observations": false, "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "enable_tf1_exec_eagerly": false, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "preprocessor_pref": "deepmind", "observation_filter": "NoFilter", "update_worker_filter_stats": true, "use_worker_filter_stats": true, "sampler_perf_stats_ema_coef": null, "_is_online": true, "num_learners": 0, "num_gpus_per_learner": 0, "num_cpus_per_learner": "auto", "num_aggregator_actors_per_learner": 0, "max_requests_in_flight_per_aggregator_actor": 3, "local_gpu_idx": 0, "max_requests_in_flight_per_learner": 3, "gamma": 1, "lr": 0.0002847858517, "grad_clip": 0.5, "grad_clip_by": "global_norm", "_train_batch_size_per_learner": 5000, "train_batch_size": 4000, "num_epochs": 1, "minibatch_size": 1000, "shuffle_batch_per_epoch": true, "model": {"fcnet_hiddens": [256, 256], "fcnet_activation": "tanh", "fcnet_weights_initializer": null, "fcnet_weights_initializer_config": null, "fcnet_bias_initializer": null, "fcnet_bias_initializer_config": null, "conv_filters": null, "conv_activation": "relu", "conv_kernel_initializer": null, "conv_kernel_initializer_config": null, "conv_bias_initializer": null, "conv_bias_initializer_config": null, "conv_transpose_kernel_initializer": null, "conv_transpose_kernel_initializer_config": null, "conv_transpose_bias_initializer": null, "conv_transpose_bias_initializer_config": null, "post_fcnet_hiddens": [], "post_fcnet_activation": "relu", "post_fcnet_weights_initializer": null, "post_fcnet_weights_initializer_config": null, "post_fcnet_bias_initializer": null, "post_fcnet_bias_initializer_config": null, "free_log_std": false, "log_std_clip_param": 20.0, "no_final_linear": false, "vf_share_layers": false, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "lstm_weights_initializer": null, "lstm_weights_initializer_config": null, "lstm_bias_initializer": null, "lstm_bias_initializer_config": null, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "attention_use_n_prev_actions": 0, "attention_use_n_prev_rewards": 0, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": null, "custom_model_config": {}, "custom_action_dist": null, "custom_preprocessor": null, "encoder_latent_dim": null, "always_check_shapes": false, "lstm_use_prev_action_reward": -1, "_use_default_native_models": -1, "_disable_preprocessor_api": false, "_disable_action_flattening": false}, "_learner_connector": null, "add_default_connectors_to_learner_pipeline": true, "learner_config_dict": {}, "optimizer": {}, "_learner_class": null, "callbacks_on_algorithm_init": null, "callbacks_on_env_runners_recreated": null, "callbacks_on_offline_eval_runners_recreated": null, "callbacks_on_checkpoint_loaded": null, "callbacks_on_environment_created": null, "callbacks_on_episode_created": null, "callbacks_on_episode_start": null, "callbacks_on_episode_step": null, "callbacks_on_episode_end": null, "callbacks_on_evaluate_start": null, "callbacks_on_evaluate_end": null, "callbacks_on_evaluate_offline_start": null, "callbacks_on_evaluate_offline_end": null, "callbacks_on_sample_end": null, "callbacks_on_train_result": null, "explore": true, "enable_rl_module_and_learner": true, "enable_env_runner_and_connector_v2": true, "_prior_exploration_config": {"type": "StochasticSampling"}, "count_steps_by": "env_steps", "policy_map_capacity": 100, "policy_mapping_fn": "<function AlgorithmConfig.DEFAULT_POLICY_MAPPING_FN at 0x13bfddb20>", "policies_to_train": null, "policy_states_are_swappable": false, "observation_fn": null, "offline_data_class": null, "input_read_method": "read_parquet", "input_read_method_kwargs": {}, "input_read_schema": {}, "input_read_episodes": false, "input_read_sample_batches": false, "input_read_batch_size": null, "input_filesystem": null, "input_filesystem_kwargs": {}, "input_compress_columns": ["obs", "new_obs"], "input_spaces_jsonable": true, "materialize_data": false, "materialize_mapped_data": true, "map_batches_kwargs": {}, "iter_batches_kwargs": {}, "ignore_final_observation": false, "prelearner_class": null, "prelearner_buffer_class": null, "prelearner_buffer_kwargs": {}, "prelearner_module_synch_period": 10, "dataset_num_iters_per_learner": null, "input_config": {}, "actions_in_input_normalized": false, "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_config": {}, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "output_max_rows_per_file": null, "output_write_remaining_data": false, "output_write_method": "write_parquet", "output_write_method_kwargs": {}, "output_filesystem": null, "output_filesystem_kwargs": {}, "output_write_episodes": true, "offline_sampling": false, "evaluation_interval": 1, "evaluation_duration": 20, "evaluation_duration_unit": "episodes", "evaluation_sample_timeout_s": 120.0, "evaluation_auto_duration_min_env_steps_per_sample": 100, "evaluation_auto_duration_max_env_steps_per_sample": 2000, "evaluation_parallel_to_training": false, "evaluation_force_reset_envs_before_iteration": true, "evaluation_config": null, "off_policy_estimation_methods": {}, "ope_split_batch_by_episode": true, "evaluation_num_env_runners": 1, "in_evaluation": false, "sync_filters_on_rollout_workers_timeout_s": 10.0, "offline_evaluation_interval": null, "num_offline_eval_runners": 0, "offline_loss_for_module_fn": null, "offline_evaluation_duration": 1, "offline_evaluation_parallel_to_training": false, "offline_evaluation_timeout_s": 120.0, "num_cpus_per_offline_eval_runner": 1, "num_gpus_per_offline_eval_runner": 0, "custom_resources_per_offline_eval_runner": {}, "restart_failed_offline_eval_runners": true, "ignore_offline_eval_runner_failures": false, "max_num_offline_eval_runner_restarts": 1000, "offline_eval_runner_restore_timeout_s": 1800.0, "max_requests_in_flight_per_offline_eval_runner": 1, "validate_offline_eval_runners_after_construction": true, "offline_eval_runner_health_probe_timeout_s": 30.0, "offline_eval_rl_module_inference_only": false, "broadcast_offline_eval_runner_states": false, "offline_eval_batch_size_per_runner": 256, "dataset_num_iters_per_eval_runner": 1, "keep_per_episode_custom_metrics": false, "metrics_episode_collection_timeout_s": 60.0, "metrics_num_episodes_for_smoothing": 100, "min_time_s_per_iteration": null, "min_train_timesteps_per_iteration": 0, "min_sample_timesteps_per_iteration": 0, "log_gradients": true, "export_native_model_files": false, "checkpoint_trainable_policies_only": false, "logger_creator": null, "logger_config": null, "log_level": "WARN", "log_sys_usage": true, "fake_sampler": false, "seed": 5, "restart_failed_env_runners": true, "ignore_env_runner_failures": false, "max_num_env_runner_restarts": 1000, "delay_between_env_runner_restarts_s": 60.0, "restart_failed_sub_environments": false, "num_consecutive_env_runner_failures_tolerance": 100, "env_runner_health_probe_timeout_s": 30.0, "env_runner_restore_timeout_s": 1800.0, "_model_config": {}, "_rl_module_spec": "RLModuleSpec(module_class=None, observation_space=None, action_space=None, inference_only=False, learner_only=False, model_config=DefaultModelConfig(fcnet_hiddens=[60, 90], fcnet_activation='tanh', fcnet_kernel_initializer=None, fcnet_kernel_initializer_kwargs=None, fcnet_bias_initializer=None, fcnet_bias_initializer_kwargs=None, conv_filters=None, conv_activation='relu', conv_kernel_initializer=None, conv_kernel_initializer_kwargs=None, conv_bias_initializer=None, conv_bias_initializer_kwargs=None, head_fcnet_hiddens=[], head_fcnet_activation='relu', head_fcnet_kernel_initializer=None, head_fcnet_kernel_initializer_kwargs=None, head_fcnet_bias_initializer=None, head_fcnet_bias_initializer_kwargs=None, free_log_std=False, log_std_clip_param=20.0, vf_share_layers=True, use_lstm=False, max_seq_len=20, lstm_cell_size=256, lstm_use_prev_action=False, lstm_use_prev_reward=False, lstm_kernel_initializer=None, lstm_kernel_initializer_kwargs=None, lstm_bias_initializer=None, lstm_bias_initializer_kwargs=None), catalog_class=None, load_state_path=None, model_config_dict=None)", "algorithm_config_overrides_per_module": {}, "_per_module_overrides": {}, "_validate_config": true, "_use_msgpack_checkpoints": false, "_torch_grad_scaler_class": null, "_torch_lr_scheduler_classes": null, "_tf_policy_handles_more_than_one_loss": false, "_disable_preprocessor_api": false, "_disable_action_flattening": false, "_disable_initialize_loss_from_dummy_batch": false, "_dont_auto_sync_env_runner_states": false, "env_task_fn": -1, "enable_connectors": -1, "simple_optimizer": false, "policy_map_cache": -1, "worker_cls": -1, "synchronize_filters": -1, "enable_async_evaluation": -1, "custom_async_evaluation_function": -1, "_enable_rl_module_api": -1, "auto_wrap_old_gym_envs": -1, "always_attach_evaluation_results": -1, "replay_sequence_length": null, "_disable_execution_plan_api": -1, "use_critic": true, "use_gae": true, "use_kl_loss": true, "kl_coeff": 0.7464963036515, "kl_target": 0.0270990929592, "vf_loss_coeff": 0.6688075857018, "entropy_coeff": 0.0090570820258, "clip_param": 0.1221781641624, "vf_clip_param": 0.1027808522125, "entropy_coeff_schedule": null, "lr_schedule": null, "sgd_minibatch_size": -1, "vf_share_layers": -1, "__stdout_file__": null, "__stderr_file__": null, "lambda": 0.9099046732075, "input": "sampler", "policies": {"default_policy": [null, null, null, null]}, "callbacks": "<class 'ray.rllib.callbacks.callbacks.RLlibCallback'>", "create_env_on_driver": false, "custom_eval_function": null, "framework": "torch"}, "time_since_restore": 44.275925397872925, "iterations_since_restore": 16, "perf": {"cpu_util_percent": 77.41999999999999, "ram_util_percent": 78.46000000000001}}
{"timers": {"training_iteration": 2.538080484669247, "restore_env_runners": 1.2418879696689844e-05, "training_step": 2.5379215958774664, "env_runner_sampling_timer": 2.3759808133198335, "learner_update_timer": 0.1585357039177693, "synch_weights": 0.0006618019098681627, "restore_eval_env_runners": 9.232278569938173e-06, "evaluation_iteration": 0.17274960243985005, "synch_eval_env_connectors": 0.00013793236773018046, "synch_env_connectors": 5.354506324206812e-06}, "env_runners": {"weights_seq_no": 16.0, "episode_return_max": 6.5, "num_episodes": 250.0, "module_to_env_connector": {"timers": {"connectors": {"tensor_to_numpy": 2.5433819833113918e-05, "remove_single_ts_time_rank_from_batch": 9.923015511844014e-07, "listify_data_for_vector_env": 1.9287941784556604e-05, "get_actions": 8.128333683683886e-05, "normalize_and_clip_actions": 1.64835080510257e-05, "un_batch_to_individual_items": 8.998224587150778e-06}}, "connector_pipeline_timer": 0.00019520093713387332}, "env_to_module_connector": {"timers": {"connectors": {"batch_individual_items": 1.1792521015408617e-05, "add_time_dim_to_batch_and_zero_pad": 4.1298508357021654e-06, "numpy_to_tensor": 1.6671923996089372e-05, "add_observations_from_episodes_to_batch": 5.237092439889747e-06, "add_states_from_episodes_to_batch": 2.707953759600237e-06}}, "connector_pipeline_timer": 7.560611242570822e-05}, "agent_episode_returns_mean": {"default_agent": 4.18}, "env_to_module_sum_episodes_length_out": 10.36823839457432, "num_module_steps_sampled": {"default_policy": 5000.0}, "episode_return_min": -13.5, "time_between_sampling": 0.0027562708678981643, "episode_len_min": 20, "episode_len_mean": 20.0, "episode_return_mean": 4.18, "episode_len_max": 20, "sample": 0.009416723151863366, "num_env_steps_sampled": 5000.0, "episode_duration_sec_mean": 0.009094354494009168, "env_to_module_sum_episodes_length_in": 10.36823839457432, "env_step_timer": 2.6349104418766387e-05, "num_module_steps_sampled_lifetime": {"default_policy": -9252500.0}, "num_episodes_lifetime": -462625.0, "num_env_steps_sampled_lifetime": -9252500.0, "num_agent_steps_sampled_lifetime": {"default_agent": -9252500.0}, "env_reset_timer": 7.868727472614457e-05, "rlmodule_inference_timer": 7.966369831533393e-05, "module_episode_returns_mean": {"default_policy": 4.18}, "num_agent_steps_sampled": {"default_agent": 5000.0}, "num_env_steps_sampled_lifetime_throughput": 2304.6310229539163}, "learners": {"default_policy": {"vf_loss_unclipped": 23.931560516357422, "default_optimizer_learning_rate": 0.0002847858517, "module_train_batch_size_mean": 1000.0, "vf_loss": 0.10278083384037018, "entropy": 0.4135804772377014, "total_loss": 0.11662331223487854, "policy_loss": 0.05162852257490158, "vf_explained_var": -0.019191503524780273, "mean_kl_loss": 0.0007178370142355561, "diff_num_grad_updates_vs_sampler_policy": 1.0, "gradients_default_optimizer_global_norm": 0.03710363060235977, "num_module_steps_trained_lifetime": 102000, "curr_entropy_coeff": 0.0090570820258, "num_module_steps_trained": 6000, "num_trainable_parameters": 6003, "curr_kl_coeff": 5.695314939657692e-06, "weights_seq_no": 17.0, "num_module_steps_trained_lifetime_throughput": 238218.380983768}, "__all_modules__": {"learner_connector": {"timers": {"connectors": {"add_observations_from_episodes_to_batch": 0.0008946515361667917, "general_advantage_estimation": 0.00961443076173563, "add_one_ts_to_episodes_and_truncate": 0.010800070474472748, "add_columns_from_episodes_to_train_batch": 0.040215745827253756, "numpy_to_tensor": 0.00013433119582120808, "add_states_from_episodes_to_batch": 3.7860745190142145e-06, "batch_individual_items": 0.05342805677257447, "add_time_dim_to_batch_and_zero_pad": 1.266200435209107e-05}}, "connector_pipeline_timer": 0.11532192575173995}, "num_env_steps_trained": 31500, "num_env_steps_trained_lifetime": 535500, "num_module_steps_trained_lifetime": 102000, "learner_connector_sum_episodes_length_in": 5000.0, "num_trainable_parameters": 6003, "learner_connector_sum_episodes_length_out": 5250.0, "num_module_steps_trained": 6000, "num_non_trainable_parameters": 0, "num_env_steps_trained_lifetime_throughput": 1249205.2745975032, "num_module_steps_trained_throughput": 238291.67336923737, "num_module_steps_trained_lifetime_throughput": 238140.9843264568}}, "num_training_step_calls_per_iteration": 1, "evaluation": {"env_runners": {"module_to_env_connector": {"connector_pipeline_timer": 0.00012557966010772668, "timers": {"connectors": {"remove_single_ts_time_rank_from_batch": 6.569778686266506e-07, "listify_data_for_vector_env": 1.3002308154139731e-05, "normalize_and_clip_actions": 1.2162195488476557e-05, "get_actions": 4.72961190492522e-05, "tensor_to_numpy": 1.615032014279304e-05, "un_batch_to_individual_items": 6.3189122143320016e-06}}}, "num_episodes_lifetime": 340, "weights_seq_no": 17.0, "episode_return_max": 12.5, "num_env_steps_sampled": 400, "env_to_module_sum_episodes_length_in": 10.368238394574323, "env_to_module_connector": {"timers": {"connectors": {"add_observations_from_episodes_to_batch": 3.244605736405344e-06, "numpy_to_tensor": 1.0702842111792e-05, "add_states_from_episodes_to_batch": 2.008151483732159e-06, "batch_individual_items": 8.314079991718434e-06, "add_time_dim_to_batch_and_zero_pad": 2.629921130785341e-06}}, "connector_pipeline_timer": 5.1672478962572765e-05}, "env_to_module_sum_episodes_length_out": 10.368238394574323, "episode_len_max": 20, "episode_duration_sec_mean": 0.007619114222470671, "env_step_timer": 1.744401332452248e-05, "num_env_steps_sampled_lifetime": 85400, "rlmodule_inference_timer": 3.331184494923449e-05, "num_module_steps_sampled_lifetime": {"default_policy": 6800}, "num_agent_steps_sampled_lifetime": {"default_agent": 6800}, "num_agent_steps_sampled": {"default_agent": 400}, "episode_len_mean": 20.0, "episode_return_mean": 2.5, "agent_episode_returns_mean": {"default_agent": 2.5}, "num_module_steps_sampled": {"default_policy": 400}, "env_reset_timer": 0.00014843915986541186, "num_episodes": 20, "episode_return_min": -15.5, "module_episode_returns_mean": {"default_policy": 2.5}, "episode_len_min": 20, "sample": 0.1651379150284213, "time_between_sampling": 2.614948165662829}, "num_healthy_workers": 1, "actor_manager_num_outstanding_async_reqs": 0, "num_remote_worker_restarts": 0}, "num_env_steps_sampled_lifetime": -9252500.0, "fault_tolerance": {"num_healthy_workers": 0, "num_remote_worker_restarts": 0}, "env_runner_group": {"actor_manager_num_outstanding_async_reqs": 0}, "done": false, "training_iteration": 17, "trial_id": "46b1a_00000", "date": "2025-08-11_19-34-59", "timestamp": 1754933699, "time_this_iter_s": 3.092510938644409, "time_total_s": 47.368436336517334, "pid": 26849, "hostname": "Mac", "node_ip": "127.0.0.1", "config": {"exploration_config": {}, "extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "placement_strategy": "PACK", "num_gpus": 0, "_fake_gpus": false, "num_cpus_for_main_process": 2, "eager_tracing": true, "eager_max_retraces": 20, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "torch_compile_learner": false, "torch_compile_learner_what_to_compile": "forward_train", "torch_compile_learner_dynamo_backend": "aot_eager", "torch_compile_learner_dynamo_mode": null, "torch_compile_worker": false, "torch_compile_worker_dynamo_backend": "aot_eager", "torch_compile_worker_dynamo_mode": null, "torch_ddp_kwargs": {}, "torch_skip_nan_gradients": false, "env": "Umbrella", "env_config": {}, "observation_space": null, "action_space": null, "clip_rewards": null, "normalize_actions": true, "clip_actions": false, "_is_atari": null, "disable_env_checking": false, "render_env": false, "action_mask_key": "action_mask", "env_runner_cls": null, "num_env_runners": 0, "create_local_env_runner": true, "num_envs_per_env_runner": 1, "gym_env_vectorize_mode": "SYNC", "num_cpus_per_env_runner": 1, "num_gpus_per_env_runner": 0, "custom_resources_per_env_runner": {}, "validate_env_runners_after_construction": true, "episodes_to_numpy": true, "max_requests_in_flight_per_env_runner": 1, "sample_timeout_s": 60.0, "_env_to_module_connector": null, "add_default_connectors_to_env_to_module_pipeline": true, "_module_to_env_connector": null, "add_default_connectors_to_module_to_env_pipeline": true, "merge_env_runner_states": "training_only", "broadcast_env_runner_states": true, "episode_lookback_horizon": 1, "rollout_fragment_length": "auto", "batch_mode": "complete_episodes", "compress_observations": false, "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "enable_tf1_exec_eagerly": false, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "preprocessor_pref": "deepmind", "observation_filter": "NoFilter", "update_worker_filter_stats": true, "use_worker_filter_stats": true, "sampler_perf_stats_ema_coef": null, "_is_online": true, "num_learners": 0, "num_gpus_per_learner": 0, "num_cpus_per_learner": "auto", "num_aggregator_actors_per_learner": 0, "max_requests_in_flight_per_aggregator_actor": 3, "local_gpu_idx": 0, "max_requests_in_flight_per_learner": 3, "gamma": 1, "lr": 0.0002847858517, "grad_clip": 0.5, "grad_clip_by": "global_norm", "_train_batch_size_per_learner": 5000, "train_batch_size": 4000, "num_epochs": 1, "minibatch_size": 1000, "shuffle_batch_per_epoch": true, "model": {"fcnet_hiddens": [256, 256], "fcnet_activation": "tanh", "fcnet_weights_initializer": null, "fcnet_weights_initializer_config": null, "fcnet_bias_initializer": null, "fcnet_bias_initializer_config": null, "conv_filters": null, "conv_activation": "relu", "conv_kernel_initializer": null, "conv_kernel_initializer_config": null, "conv_bias_initializer": null, "conv_bias_initializer_config": null, "conv_transpose_kernel_initializer": null, "conv_transpose_kernel_initializer_config": null, "conv_transpose_bias_initializer": null, "conv_transpose_bias_initializer_config": null, "post_fcnet_hiddens": [], "post_fcnet_activation": "relu", "post_fcnet_weights_initializer": null, "post_fcnet_weights_initializer_config": null, "post_fcnet_bias_initializer": null, "post_fcnet_bias_initializer_config": null, "free_log_std": false, "log_std_clip_param": 20.0, "no_final_linear": false, "vf_share_layers": false, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "lstm_weights_initializer": null, "lstm_weights_initializer_config": null, "lstm_bias_initializer": null, "lstm_bias_initializer_config": null, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "attention_use_n_prev_actions": 0, "attention_use_n_prev_rewards": 0, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": null, "custom_model_config": {}, "custom_action_dist": null, "custom_preprocessor": null, "encoder_latent_dim": null, "always_check_shapes": false, "lstm_use_prev_action_reward": -1, "_use_default_native_models": -1, "_disable_preprocessor_api": false, "_disable_action_flattening": false}, "_learner_connector": null, "add_default_connectors_to_learner_pipeline": true, "learner_config_dict": {}, "optimizer": {}, "_learner_class": null, "callbacks_on_algorithm_init": null, "callbacks_on_env_runners_recreated": null, "callbacks_on_offline_eval_runners_recreated": null, "callbacks_on_checkpoint_loaded": null, "callbacks_on_environment_created": null, "callbacks_on_episode_created": null, "callbacks_on_episode_start": null, "callbacks_on_episode_step": null, "callbacks_on_episode_end": null, "callbacks_on_evaluate_start": null, "callbacks_on_evaluate_end": null, "callbacks_on_evaluate_offline_start": null, "callbacks_on_evaluate_offline_end": null, "callbacks_on_sample_end": null, "callbacks_on_train_result": null, "explore": true, "enable_rl_module_and_learner": true, "enable_env_runner_and_connector_v2": true, "_prior_exploration_config": {"type": "StochasticSampling"}, "count_steps_by": "env_steps", "policy_map_capacity": 100, "policy_mapping_fn": "<function AlgorithmConfig.DEFAULT_POLICY_MAPPING_FN at 0x13bfddb20>", "policies_to_train": null, "policy_states_are_swappable": false, "observation_fn": null, "offline_data_class": null, "input_read_method": "read_parquet", "input_read_method_kwargs": {}, "input_read_schema": {}, "input_read_episodes": false, "input_read_sample_batches": false, "input_read_batch_size": null, "input_filesystem": null, "input_filesystem_kwargs": {}, "input_compress_columns": ["obs", "new_obs"], "input_spaces_jsonable": true, "materialize_data": false, "materialize_mapped_data": true, "map_batches_kwargs": {}, "iter_batches_kwargs": {}, "ignore_final_observation": false, "prelearner_class": null, "prelearner_buffer_class": null, "prelearner_buffer_kwargs": {}, "prelearner_module_synch_period": 10, "dataset_num_iters_per_learner": null, "input_config": {}, "actions_in_input_normalized": false, "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_config": {}, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "output_max_rows_per_file": null, "output_write_remaining_data": false, "output_write_method": "write_parquet", "output_write_method_kwargs": {}, "output_filesystem": null, "output_filesystem_kwargs": {}, "output_write_episodes": true, "offline_sampling": false, "evaluation_interval": 1, "evaluation_duration": 20, "evaluation_duration_unit": "episodes", "evaluation_sample_timeout_s": 120.0, "evaluation_auto_duration_min_env_steps_per_sample": 100, "evaluation_auto_duration_max_env_steps_per_sample": 2000, "evaluation_parallel_to_training": false, "evaluation_force_reset_envs_before_iteration": true, "evaluation_config": null, "off_policy_estimation_methods": {}, "ope_split_batch_by_episode": true, "evaluation_num_env_runners": 1, "in_evaluation": false, "sync_filters_on_rollout_workers_timeout_s": 10.0, "offline_evaluation_interval": null, "num_offline_eval_runners": 0, "offline_loss_for_module_fn": null, "offline_evaluation_duration": 1, "offline_evaluation_parallel_to_training": false, "offline_evaluation_timeout_s": 120.0, "num_cpus_per_offline_eval_runner": 1, "num_gpus_per_offline_eval_runner": 0, "custom_resources_per_offline_eval_runner": {}, "restart_failed_offline_eval_runners": true, "ignore_offline_eval_runner_failures": false, "max_num_offline_eval_runner_restarts": 1000, "offline_eval_runner_restore_timeout_s": 1800.0, "max_requests_in_flight_per_offline_eval_runner": 1, "validate_offline_eval_runners_after_construction": true, "offline_eval_runner_health_probe_timeout_s": 30.0, "offline_eval_rl_module_inference_only": false, "broadcast_offline_eval_runner_states": false, "offline_eval_batch_size_per_runner": 256, "dataset_num_iters_per_eval_runner": 1, "keep_per_episode_custom_metrics": false, "metrics_episode_collection_timeout_s": 60.0, "metrics_num_episodes_for_smoothing": 100, "min_time_s_per_iteration": null, "min_train_timesteps_per_iteration": 0, "min_sample_timesteps_per_iteration": 0, "log_gradients": true, "export_native_model_files": false, "checkpoint_trainable_policies_only": false, "logger_creator": null, "logger_config": null, "log_level": "WARN", "log_sys_usage": true, "fake_sampler": false, "seed": 5, "restart_failed_env_runners": true, "ignore_env_runner_failures": false, "max_num_env_runner_restarts": 1000, "delay_between_env_runner_restarts_s": 60.0, "restart_failed_sub_environments": false, "num_consecutive_env_runner_failures_tolerance": 100, "env_runner_health_probe_timeout_s": 30.0, "env_runner_restore_timeout_s": 1800.0, "_model_config": {}, "_rl_module_spec": "RLModuleSpec(module_class=None, observation_space=None, action_space=None, inference_only=False, learner_only=False, model_config=DefaultModelConfig(fcnet_hiddens=[60, 90], fcnet_activation='tanh', fcnet_kernel_initializer=None, fcnet_kernel_initializer_kwargs=None, fcnet_bias_initializer=None, fcnet_bias_initializer_kwargs=None, conv_filters=None, conv_activation='relu', conv_kernel_initializer=None, conv_kernel_initializer_kwargs=None, conv_bias_initializer=None, conv_bias_initializer_kwargs=None, head_fcnet_hiddens=[], head_fcnet_activation='relu', head_fcnet_kernel_initializer=None, head_fcnet_kernel_initializer_kwargs=None, head_fcnet_bias_initializer=None, head_fcnet_bias_initializer_kwargs=None, free_log_std=False, log_std_clip_param=20.0, vf_share_layers=True, use_lstm=False, max_seq_len=20, lstm_cell_size=256, lstm_use_prev_action=False, lstm_use_prev_reward=False, lstm_kernel_initializer=None, lstm_kernel_initializer_kwargs=None, lstm_bias_initializer=None, lstm_bias_initializer_kwargs=None), catalog_class=None, load_state_path=None, model_config_dict=None)", "algorithm_config_overrides_per_module": {}, "_per_module_overrides": {}, "_validate_config": true, "_use_msgpack_checkpoints": false, "_torch_grad_scaler_class": null, "_torch_lr_scheduler_classes": null, "_tf_policy_handles_more_than_one_loss": false, "_disable_preprocessor_api": false, "_disable_action_flattening": false, "_disable_initialize_loss_from_dummy_batch": false, "_dont_auto_sync_env_runner_states": false, "env_task_fn": -1, "enable_connectors": -1, "simple_optimizer": false, "policy_map_cache": -1, "worker_cls": -1, "synchronize_filters": -1, "enable_async_evaluation": -1, "custom_async_evaluation_function": -1, "_enable_rl_module_api": -1, "auto_wrap_old_gym_envs": -1, "always_attach_evaluation_results": -1, "replay_sequence_length": null, "_disable_execution_plan_api": -1, "use_critic": true, "use_gae": true, "use_kl_loss": true, "kl_coeff": 0.7464963036515, "kl_target": 0.0270990929592, "vf_loss_coeff": 0.6688075857018, "entropy_coeff": 0.0090570820258, "clip_param": 0.1221781641624, "vf_clip_param": 0.1027808522125, "entropy_coeff_schedule": null, "lr_schedule": null, "sgd_minibatch_size": -1, "vf_share_layers": -1, "__stdout_file__": null, "__stderr_file__": null, "lambda": 0.9099046732075, "input": "sampler", "policies": {"default_policy": [null, null, null, null]}, "callbacks": "<class 'ray.rllib.callbacks.callbacks.RLlibCallback'>", "create_env_on_driver": false, "custom_eval_function": null, "framework": "torch"}, "time_since_restore": 47.368436336517334, "iterations_since_restore": 17, "perf": {"cpu_util_percent": 71.3, "ram_util_percent": 77.625}}
{"timers": {"training_iteration": 2.5474786523223254, "restore_env_runners": 1.237719094584204e-05, "training_step": 2.547253323248538, "env_runner_sampling_timer": 2.3835698514363832, "learner_update_timer": 0.1602055131293383, "synch_weights": 0.0006760809812045092, "restore_eval_env_runners": 9.199115722484802e-06, "evaluation_iteration": 0.17230961391525254, "synch_eval_env_connectors": 0.00013902762401298645, "synch_env_connectors": 5.343881261815898e-06}, "env_runners": {"weights_seq_no": 17.0, "episode_return_max": 6.5, "num_episodes": 250.0, "module_to_env_connector": {"timers": {"connectors": {"tensor_to_numpy": 2.8500228055201705e-05, "remove_single_ts_time_rank_from_batch": 1.065053980380798e-06, "listify_data_for_vector_env": 2.4472405672217924e-05, "get_actions": 0.00011860756007721437, "normalize_and_clip_actions": 1.8723029141785935e-05, "un_batch_to_individual_items": 1.3707506335745995e-05}}, "connector_pipeline_timer": 0.00025491469320991554}, "env_to_module_connector": {"timers": {"connectors": {"batch_individual_items": 1.378792269787706e-05, "add_time_dim_to_batch_and_zero_pad": 4.72585333098339e-06, "numpy_to_tensor": 2.00156903100299e-05, "add_observations_from_episodes_to_batch": 5.729597498277427e-06, "add_states_from_episodes_to_batch": 3.195665933954748e-06}}, "connector_pipeline_timer": 8.630561077826276e-05}, "agent_episode_returns_mean": {"default_agent": 3.5400000000000005}, "env_to_module_sum_episodes_length_out": 10.36823839457432, "num_module_steps_sampled": {"default_policy": 5000.0}, "episode_return_min": -13.5, "time_between_sampling": 0.002882220494004729, "episode_len_min": 20, "episode_len_mean": 20.0, "episode_return_mean": 3.5400000000000005, "episode_len_max": 20, "sample": 0.010970815505504786, "num_env_steps_sampled": 5000.0, "episode_duration_sec_mean": 0.010529630384873603, "env_to_module_sum_episodes_length_in": 10.36823839457432, "env_step_timer": 3.7824014793707894e-05, "num_module_steps_sampled_lifetime": {"default_policy": -9870000.0}, "num_episodes_lifetime": -493500.0, "num_env_steps_sampled_lifetime": -9870000.0, "num_agent_steps_sampled_lifetime": {"default_agent": -9870000.0}, "env_reset_timer": 8.861803871014931e-05, "rlmodule_inference_timer": 6.935564579431233e-05, "module_episode_returns_mean": {"default_policy": 3.5400000000000005}, "num_agent_steps_sampled": {"default_agent": 5000.0}, "num_env_steps_sampled_lifetime_throughput": 2009.360581536741}, "learners": {"default_policy": {"vf_loss_unclipped": 25.955707550048828, "default_optimizer_learning_rate": 0.0002847858517, "module_train_batch_size_mean": 1000.0, "vf_loss": 0.10278083384037018, "entropy": 0.41199925541877747, "total_loss": 0.271775484085083, "policy_loss": 0.20676639676094055, "vf_explained_var": -0.01664602756500244, "mean_kl_loss": 0.000187661949894391, "diff_num_grad_updates_vs_sampler_policy": 1.0, "gradients_default_optimizer_global_norm": 0.08192838728427887, "num_module_steps_trained_lifetime": 108000, "curr_entropy_coeff": 0.0090570820258, "num_module_steps_trained": 6000, "num_trainable_parameters": 6003, "curr_kl_coeff": 2.847657469828846e-06, "weights_seq_no": 18.0, "num_module_steps_trained_lifetime_throughput": 237475.69740202755}, "__all_modules__": {"learner_connector": {"timers": {"connectors": {"add_observations_from_episodes_to_batch": 0.0008969954304073486, "general_advantage_estimation": 0.009687826863815493, "add_one_ts_to_episodes_and_truncate": 0.010879181849894136, "add_columns_from_episodes_to_train_batch": 0.04039958795909311, "numpy_to_tensor": 0.00013495996407135715, "add_states_from_episodes_to_batch": 3.851134231544829e-06, "batch_individual_items": 0.05477975662489614, "add_time_dim_to_batch_and_zero_pad": 1.3216214871057403e-05}}, "connector_pipeline_timer": 0.11701342565457072}, "num_env_steps_trained": 31500, "num_env_steps_trained_lifetime": 567000, "num_module_steps_trained_lifetime": 108000, "learner_connector_sum_episodes_length_in": 5000.0, "num_trainable_parameters": 6003, "learner_connector_sum_episodes_length_out": 5250.0, "num_module_steps_trained": 6000, "num_non_trainable_parameters": 0, "num_env_steps_trained_lifetime_throughput": 1245477.691011558, "num_module_steps_trained_throughput": 237567.71234196532, "num_module_steps_trained_lifetime_throughput": 237423.31661192238}}, "num_training_step_calls_per_iteration": 1, "evaluation": {"env_runners": {"module_to_env_connector": {"connector_pipeline_timer": 0.00020661681054745737, "timers": {"connectors": {"remove_single_ts_time_rank_from_batch": 7.753495800812477e-07, "listify_data_for_vector_env": 2.325544668384079e-05, "normalize_and_clip_actions": 1.852120071955427e-05, "get_actions": 8.42466919593572e-05, "tensor_to_numpy": 2.494583799566033e-05, "un_batch_to_individual_items": 8.08971921912293e-06}}}, "num_episodes_lifetime": 360, "weights_seq_no": 18.0, "episode_return_max": 12.5, "num_env_steps_sampled": 400, "env_to_module_sum_episodes_length_in": 10.368238394574323, "env_to_module_connector": {"timers": {"connectors": {"add_observations_from_episodes_to_batch": 4.706231844467303e-06, "numpy_to_tensor": 1.6859684251751064e-05, "add_states_from_episodes_to_batch": 2.2333466369758875e-06, "batch_individual_items": 1.0869397797417662e-05, "add_time_dim_to_batch_and_zero_pad": 5.531588922884952e-06}}, "connector_pipeline_timer": 7.28326551071926e-05}, "env_to_module_sum_episodes_length_out": 10.368238394574323, "episode_len_max": 20, "episode_duration_sec_mean": 0.007562475482700393, "env_step_timer": 2.791688397862947e-05, "num_env_steps_sampled_lifetime": 90400, "rlmodule_inference_timer": 4.540688676299128e-05, "num_module_steps_sampled_lifetime": {"default_policy": 7200}, "num_agent_steps_sampled_lifetime": {"default_agent": 7200}, "num_agent_steps_sampled": {"default_agent": 400}, "episode_len_mean": 20.0, "episode_return_mean": 2.5, "agent_episode_returns_mean": {"default_agent": 2.5}, "num_module_steps_sampled": {"default_policy": 400}, "env_reset_timer": 0.00015714976789825202, "num_episodes": 20, "episode_return_min": -15.5, "module_episode_returns_mean": {"default_policy": 2.5}, "episode_len_min": 20, "sample": 0.165453482127732, "time_between_sampling": 2.624525041915353}, "num_healthy_workers": 1, "actor_manager_num_outstanding_async_reqs": 0, "num_remote_worker_restarts": 0}, "num_env_steps_sampled_lifetime": -9870000.0, "fault_tolerance": {"num_healthy_workers": 0, "num_remote_worker_restarts": 0}, "env_runner_group": {"actor_manager_num_outstanding_async_reqs": 0}, "done": false, "training_iteration": 18, "trial_id": "46b1a_00000", "date": "2025-08-11_19-35-03", "timestamp": 1754933703, "time_this_iter_s": 3.757579803466797, "time_total_s": 51.12601613998413, "pid": 26849, "hostname": "Mac", "node_ip": "127.0.0.1", "config": {"exploration_config": {}, "extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "placement_strategy": "PACK", "num_gpus": 0, "_fake_gpus": false, "num_cpus_for_main_process": 2, "eager_tracing": true, "eager_max_retraces": 20, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "torch_compile_learner": false, "torch_compile_learner_what_to_compile": "forward_train", "torch_compile_learner_dynamo_backend": "aot_eager", "torch_compile_learner_dynamo_mode": null, "torch_compile_worker": false, "torch_compile_worker_dynamo_backend": "aot_eager", "torch_compile_worker_dynamo_mode": null, "torch_ddp_kwargs": {}, "torch_skip_nan_gradients": false, "env": "Umbrella", "env_config": {}, "observation_space": null, "action_space": null, "clip_rewards": null, "normalize_actions": true, "clip_actions": false, "_is_atari": null, "disable_env_checking": false, "render_env": false, "action_mask_key": "action_mask", "env_runner_cls": null, "num_env_runners": 0, "create_local_env_runner": true, "num_envs_per_env_runner": 1, "gym_env_vectorize_mode": "SYNC", "num_cpus_per_env_runner": 1, "num_gpus_per_env_runner": 0, "custom_resources_per_env_runner": {}, "validate_env_runners_after_construction": true, "episodes_to_numpy": true, "max_requests_in_flight_per_env_runner": 1, "sample_timeout_s": 60.0, "_env_to_module_connector": null, "add_default_connectors_to_env_to_module_pipeline": true, "_module_to_env_connector": null, "add_default_connectors_to_module_to_env_pipeline": true, "merge_env_runner_states": "training_only", "broadcast_env_runner_states": true, "episode_lookback_horizon": 1, "rollout_fragment_length": "auto", "batch_mode": "complete_episodes", "compress_observations": false, "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "enable_tf1_exec_eagerly": false, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "preprocessor_pref": "deepmind", "observation_filter": "NoFilter", "update_worker_filter_stats": true, "use_worker_filter_stats": true, "sampler_perf_stats_ema_coef": null, "_is_online": true, "num_learners": 0, "num_gpus_per_learner": 0, "num_cpus_per_learner": "auto", "num_aggregator_actors_per_learner": 0, "max_requests_in_flight_per_aggregator_actor": 3, "local_gpu_idx": 0, "max_requests_in_flight_per_learner": 3, "gamma": 1, "lr": 0.0002847858517, "grad_clip": 0.5, "grad_clip_by": "global_norm", "_train_batch_size_per_learner": 5000, "train_batch_size": 4000, "num_epochs": 1, "minibatch_size": 1000, "shuffle_batch_per_epoch": true, "model": {"fcnet_hiddens": [256, 256], "fcnet_activation": "tanh", "fcnet_weights_initializer": null, "fcnet_weights_initializer_config": null, "fcnet_bias_initializer": null, "fcnet_bias_initializer_config": null, "conv_filters": null, "conv_activation": "relu", "conv_kernel_initializer": null, "conv_kernel_initializer_config": null, "conv_bias_initializer": null, "conv_bias_initializer_config": null, "conv_transpose_kernel_initializer": null, "conv_transpose_kernel_initializer_config": null, "conv_transpose_bias_initializer": null, "conv_transpose_bias_initializer_config": null, "post_fcnet_hiddens": [], "post_fcnet_activation": "relu", "post_fcnet_weights_initializer": null, "post_fcnet_weights_initializer_config": null, "post_fcnet_bias_initializer": null, "post_fcnet_bias_initializer_config": null, "free_log_std": false, "log_std_clip_param": 20.0, "no_final_linear": false, "vf_share_layers": false, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "lstm_weights_initializer": null, "lstm_weights_initializer_config": null, "lstm_bias_initializer": null, "lstm_bias_initializer_config": null, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "attention_use_n_prev_actions": 0, "attention_use_n_prev_rewards": 0, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": null, "custom_model_config": {}, "custom_action_dist": null, "custom_preprocessor": null, "encoder_latent_dim": null, "always_check_shapes": false, "lstm_use_prev_action_reward": -1, "_use_default_native_models": -1, "_disable_preprocessor_api": false, "_disable_action_flattening": false}, "_learner_connector": null, "add_default_connectors_to_learner_pipeline": true, "learner_config_dict": {}, "optimizer": {}, "_learner_class": null, "callbacks_on_algorithm_init": null, "callbacks_on_env_runners_recreated": null, "callbacks_on_offline_eval_runners_recreated": null, "callbacks_on_checkpoint_loaded": null, "callbacks_on_environment_created": null, "callbacks_on_episode_created": null, "callbacks_on_episode_start": null, "callbacks_on_episode_step": null, "callbacks_on_episode_end": null, "callbacks_on_evaluate_start": null, "callbacks_on_evaluate_end": null, "callbacks_on_evaluate_offline_start": null, "callbacks_on_evaluate_offline_end": null, "callbacks_on_sample_end": null, "callbacks_on_train_result": null, "explore": true, "enable_rl_module_and_learner": true, "enable_env_runner_and_connector_v2": true, "_prior_exploration_config": {"type": "StochasticSampling"}, "count_steps_by": "env_steps", "policy_map_capacity": 100, "policy_mapping_fn": "<function AlgorithmConfig.DEFAULT_POLICY_MAPPING_FN at 0x13bfddb20>", "policies_to_train": null, "policy_states_are_swappable": false, "observation_fn": null, "offline_data_class": null, "input_read_method": "read_parquet", "input_read_method_kwargs": {}, "input_read_schema": {}, "input_read_episodes": false, "input_read_sample_batches": false, "input_read_batch_size": null, "input_filesystem": null, "input_filesystem_kwargs": {}, "input_compress_columns": ["obs", "new_obs"], "input_spaces_jsonable": true, "materialize_data": false, "materialize_mapped_data": true, "map_batches_kwargs": {}, "iter_batches_kwargs": {}, "ignore_final_observation": false, "prelearner_class": null, "prelearner_buffer_class": null, "prelearner_buffer_kwargs": {}, "prelearner_module_synch_period": 10, "dataset_num_iters_per_learner": null, "input_config": {}, "actions_in_input_normalized": false, "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_config": {}, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "output_max_rows_per_file": null, "output_write_remaining_data": false, "output_write_method": "write_parquet", "output_write_method_kwargs": {}, "output_filesystem": null, "output_filesystem_kwargs": {}, "output_write_episodes": true, "offline_sampling": false, "evaluation_interval": 1, "evaluation_duration": 20, "evaluation_duration_unit": "episodes", "evaluation_sample_timeout_s": 120.0, "evaluation_auto_duration_min_env_steps_per_sample": 100, "evaluation_auto_duration_max_env_steps_per_sample": 2000, "evaluation_parallel_to_training": false, "evaluation_force_reset_envs_before_iteration": true, "evaluation_config": null, "off_policy_estimation_methods": {}, "ope_split_batch_by_episode": true, "evaluation_num_env_runners": 1, "in_evaluation": false, "sync_filters_on_rollout_workers_timeout_s": 10.0, "offline_evaluation_interval": null, "num_offline_eval_runners": 0, "offline_loss_for_module_fn": null, "offline_evaluation_duration": 1, "offline_evaluation_parallel_to_training": false, "offline_evaluation_timeout_s": 120.0, "num_cpus_per_offline_eval_runner": 1, "num_gpus_per_offline_eval_runner": 0, "custom_resources_per_offline_eval_runner": {}, "restart_failed_offline_eval_runners": true, "ignore_offline_eval_runner_failures": false, "max_num_offline_eval_runner_restarts": 1000, "offline_eval_runner_restore_timeout_s": 1800.0, "max_requests_in_flight_per_offline_eval_runner": 1, "validate_offline_eval_runners_after_construction": true, "offline_eval_runner_health_probe_timeout_s": 30.0, "offline_eval_rl_module_inference_only": false, "broadcast_offline_eval_runner_states": false, "offline_eval_batch_size_per_runner": 256, "dataset_num_iters_per_eval_runner": 1, "keep_per_episode_custom_metrics": false, "metrics_episode_collection_timeout_s": 60.0, "metrics_num_episodes_for_smoothing": 100, "min_time_s_per_iteration": null, "min_train_timesteps_per_iteration": 0, "min_sample_timesteps_per_iteration": 0, "log_gradients": true, "export_native_model_files": false, "checkpoint_trainable_policies_only": false, "logger_creator": null, "logger_config": null, "log_level": "WARN", "log_sys_usage": true, "fake_sampler": false, "seed": 5, "restart_failed_env_runners": true, "ignore_env_runner_failures": false, "max_num_env_runner_restarts": 1000, "delay_between_env_runner_restarts_s": 60.0, "restart_failed_sub_environments": false, "num_consecutive_env_runner_failures_tolerance": 100, "env_runner_health_probe_timeout_s": 30.0, "env_runner_restore_timeout_s": 1800.0, "_model_config": {}, "_rl_module_spec": "RLModuleSpec(module_class=None, observation_space=None, action_space=None, inference_only=False, learner_only=False, model_config=DefaultModelConfig(fcnet_hiddens=[60, 90], fcnet_activation='tanh', fcnet_kernel_initializer=None, fcnet_kernel_initializer_kwargs=None, fcnet_bias_initializer=None, fcnet_bias_initializer_kwargs=None, conv_filters=None, conv_activation='relu', conv_kernel_initializer=None, conv_kernel_initializer_kwargs=None, conv_bias_initializer=None, conv_bias_initializer_kwargs=None, head_fcnet_hiddens=[], head_fcnet_activation='relu', head_fcnet_kernel_initializer=None, head_fcnet_kernel_initializer_kwargs=None, head_fcnet_bias_initializer=None, head_fcnet_bias_initializer_kwargs=None, free_log_std=False, log_std_clip_param=20.0, vf_share_layers=True, use_lstm=False, max_seq_len=20, lstm_cell_size=256, lstm_use_prev_action=False, lstm_use_prev_reward=False, lstm_kernel_initializer=None, lstm_kernel_initializer_kwargs=None, lstm_bias_initializer=None, lstm_bias_initializer_kwargs=None), catalog_class=None, load_state_path=None, model_config_dict=None)", "algorithm_config_overrides_per_module": {}, "_per_module_overrides": {}, "_validate_config": true, "_use_msgpack_checkpoints": false, "_torch_grad_scaler_class": null, "_torch_lr_scheduler_classes": null, "_tf_policy_handles_more_than_one_loss": false, "_disable_preprocessor_api": false, "_disable_action_flattening": false, "_disable_initialize_loss_from_dummy_batch": false, "_dont_auto_sync_env_runner_states": false, "env_task_fn": -1, "enable_connectors": -1, "simple_optimizer": false, "policy_map_cache": -1, "worker_cls": -1, "synchronize_filters": -1, "enable_async_evaluation": -1, "custom_async_evaluation_function": -1, "_enable_rl_module_api": -1, "auto_wrap_old_gym_envs": -1, "always_attach_evaluation_results": -1, "replay_sequence_length": null, "_disable_execution_plan_api": -1, "use_critic": true, "use_gae": true, "use_kl_loss": true, "kl_coeff": 0.7464963036515, "kl_target": 0.0270990929592, "vf_loss_coeff": 0.6688075857018, "entropy_coeff": 0.0090570820258, "clip_param": 0.1221781641624, "vf_clip_param": 0.1027808522125, "entropy_coeff_schedule": null, "lr_schedule": null, "sgd_minibatch_size": -1, "vf_share_layers": -1, "__stdout_file__": null, "__stderr_file__": null, "lambda": 0.9099046732075, "input": "sampler", "policies": {"default_policy": [null, null, null, null]}, "callbacks": "<class 'ray.rllib.callbacks.callbacks.RLlibCallback'>", "create_env_on_driver": false, "custom_eval_function": null, "framework": "torch"}, "time_since_restore": 51.12601613998413, "iterations_since_restore": 18, "perf": {"cpu_util_percent": 77.71666666666665, "ram_util_percent": 79.3}}
{"timers": {"training_iteration": 2.5512387957989042, "restore_env_runners": 1.261632866818725e-05, "training_step": 2.551010385015977, "env_runner_sampling_timer": 2.386152438752897, "learner_update_timer": 0.16137436883736228, "synch_weights": 0.0006776614211694682, "restore_eval_env_runners": 9.270875521094938e-06, "evaluation_iteration": 0.1732879090266936, "synch_eval_env_connectors": 0.00015696109793907902, "synch_env_connectors": 5.381273175746769e-06}, "env_runners": {"weights_seq_no": 18.0, "episode_return_max": 6.5, "num_episodes": 250.0, "module_to_env_connector": {"timers": {"connectors": {"tensor_to_numpy": 2.6157661211195873e-05, "remove_single_ts_time_rank_from_batch": 1.0365669109334974e-06, "listify_data_for_vector_env": 2.0456055604830333e-05, "get_actions": 8.613467678282904e-05, "normalize_and_clip_actions": 1.7209141169474426e-05, "un_batch_to_individual_items": 9.437494004371457e-06}}, "connector_pipeline_timer": 0.00020597571416033667}, "env_to_module_connector": {"timers": {"connectors": {"batch_individual_items": 1.2298443492960648e-05, "add_time_dim_to_batch_and_zero_pad": 4.422017537801498e-06, "numpy_to_tensor": 1.799969834706585e-05, "add_observations_from_episodes_to_batch": 5.359084223555842e-06, "add_states_from_episodes_to_batch": 3.0613563212524356e-06}}, "connector_pipeline_timer": 7.886279282221344e-05}, "agent_episode_returns_mean": {"default_agent": 4.259999999999998}, "env_to_module_sum_episodes_length_out": 10.36823839457432, "num_module_steps_sampled": {"default_policy": 5000.0}, "episode_return_min": -13.5, "time_between_sampling": 0.0037813596276883776, "episode_len_min": 20, "episode_len_mean": 20.0, "episode_return_mean": 4.259999999999998, "episode_len_max": 20, "sample": 0.010001473406107006, "num_env_steps_sampled": 5000.0, "episode_duration_sec_mean": 0.008905317839235068, "env_to_module_sum_episodes_length_in": 10.36823839457432, "env_step_timer": 2.841084721232904e-05, "num_module_steps_sampled_lifetime": {"default_policy": -10487500.0}, "num_episodes_lifetime": -524375.0, "num_env_steps_sampled_lifetime": -10487500.0, "num_agent_steps_sampled_lifetime": {"default_agent": -10487500.0}, "env_reset_timer": 8.601954427063872e-05, "rlmodule_inference_timer": 5.837376459404273e-05, "module_episode_returns_mean": {"default_policy": 4.259999999999998}, "num_agent_steps_sampled": {"default_agent": 5000.0}, "num_env_steps_sampled_lifetime_throughput": 2216.653020053432}, "learners": {"default_policy": {"vf_loss_unclipped": 23.938852310180664, "default_optimizer_learning_rate": 0.0002847858517, "module_train_batch_size_mean": 1000.0, "vf_loss": 0.10278083384037018, "entropy": 0.37992289662361145, "total_loss": 0.12606894969940186, "policy_loss": 0.06076934561133385, "vf_explained_var": -0.019092679023742676, "mean_kl_loss": 0.00026499663363210857, "diff_num_grad_updates_vs_sampler_policy": 1.0, "gradients_default_optimizer_global_norm": 0.08828224986791611, "num_module_steps_trained_lifetime": 114000, "curr_entropy_coeff": 0.0090570820258, "num_module_steps_trained": 6000, "num_trainable_parameters": 6003, "curr_kl_coeff": 1.423828734914423e-06, "weights_seq_no": 19.0, "num_module_steps_trained_lifetime_throughput": 237048.5630123249}, "__all_modules__": {"learner_connector": {"timers": {"connectors": {"add_observations_from_episodes_to_batch": 0.0008967125562202176, "general_advantage_estimation": 0.009664301095507996, "add_one_ts_to_episodes_and_truncate": 0.0108495021110882, "add_columns_from_episodes_to_train_batch": 0.04042666207896976, "numpy_to_tensor": 0.0001351232839832678, "add_states_from_episodes_to_batch": 3.8488722921398515e-06, "batch_individual_items": 0.05615665780843715, "add_time_dim_to_batch_and_zero_pad": 1.3191552958828257e-05}}, "connector_pipeline_timer": 0.1183631763980993}, "num_env_steps_trained": 31500, "num_env_steps_trained_lifetime": 598500, "num_module_steps_trained_lifetime": 114000, "learner_connector_sum_episodes_length_in": 5000.0, "num_trainable_parameters": 6003, "learner_connector_sum_episodes_length_out": 5250.0, "num_module_steps_trained": 6000, "num_non_trainable_parameters": 0, "num_env_steps_trained_lifetime_throughput": 1243445.8884693491, "num_module_steps_trained_throughput": 237160.9468637714, "num_module_steps_trained_lifetime_throughput": 237022.5003901114}}, "num_training_step_calls_per_iteration": 1, "evaluation": {"env_runners": {"module_to_env_connector": {"connector_pipeline_timer": 0.0001338072871640543, "timers": {"connectors": {"remove_single_ts_time_rank_from_batch": 6.91886466138768e-07, "listify_data_for_vector_env": 1.53378599054382e-05, "normalize_and_clip_actions": 1.1045893241736887e-05, "get_actions": 5.210188689994566e-05, "tensor_to_numpy": 1.731529179241639e-05, "un_batch_to_individual_items": 6.7531644693432725e-06}}}, "num_episodes_lifetime": 380, "weights_seq_no": 19.0, "episode_return_max": 12.5, "num_env_steps_sampled": 400, "env_to_module_sum_episodes_length_in": 10.368238394574323, "env_to_module_connector": {"timers": {"connectors": {"add_observations_from_episodes_to_batch": 3.790966662979719e-06, "numpy_to_tensor": 1.1919530111355885e-05, "add_states_from_episodes_to_batch": 1.9788963740695346e-06, "batch_individual_items": 9.130126866609903e-06, "add_time_dim_to_batch_and_zero_pad": 3.1487749611231717e-06}}, "connector_pipeline_timer": 5.695065781194878e-05}, "env_to_module_sum_episodes_length_out": 10.368238394574323, "episode_len_max": 20, "episode_duration_sec_mean": 0.0074163725739344955, "env_step_timer": 2.077916463588288e-05, "num_env_steps_sampled_lifetime": 95400, "rlmodule_inference_timer": 3.7900590879547405e-05, "num_module_steps_sampled_lifetime": {"default_policy": 7600}, "num_agent_steps_sampled_lifetime": {"default_agent": 7600}, "num_agent_steps_sampled": {"default_agent": 400}, "episode_len_mean": 20.0, "episode_return_mean": 2.5, "agent_episode_returns_mean": {"default_agent": 2.5}, "num_module_steps_sampled": {"default_policy": 400}, "env_reset_timer": 0.00015763992968947005, "num_episodes": 20, "episode_return_min": -15.5, "module_episode_returns_mean": {"default_policy": 2.5}, "episode_len_min": 20, "sample": 0.16523295688569783, "time_between_sampling": 2.62794870524641}, "num_healthy_workers": 1, "actor_manager_num_outstanding_async_reqs": 0, "num_remote_worker_restarts": 0}, "num_env_steps_sampled_lifetime": -10487500.0, "fault_tolerance": {"num_healthy_workers": 0, "num_remote_worker_restarts": 0}, "env_runner_group": {"actor_manager_num_outstanding_async_reqs": 0}, "done": false, "training_iteration": 19, "trial_id": "46b1a_00000", "date": "2025-08-11_19-35-06", "timestamp": 1754933706, "time_this_iter_s": 3.076387882232666, "time_total_s": 54.2024040222168, "pid": 26849, "hostname": "Mac", "node_ip": "127.0.0.1", "config": {"exploration_config": {}, "extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "placement_strategy": "PACK", "num_gpus": 0, "_fake_gpus": false, "num_cpus_for_main_process": 2, "eager_tracing": true, "eager_max_retraces": 20, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "torch_compile_learner": false, "torch_compile_learner_what_to_compile": "forward_train", "torch_compile_learner_dynamo_backend": "aot_eager", "torch_compile_learner_dynamo_mode": null, "torch_compile_worker": false, "torch_compile_worker_dynamo_backend": "aot_eager", "torch_compile_worker_dynamo_mode": null, "torch_ddp_kwargs": {}, "torch_skip_nan_gradients": false, "env": "Umbrella", "env_config": {}, "observation_space": null, "action_space": null, "clip_rewards": null, "normalize_actions": true, "clip_actions": false, "_is_atari": null, "disable_env_checking": false, "render_env": false, "action_mask_key": "action_mask", "env_runner_cls": null, "num_env_runners": 0, "create_local_env_runner": true, "num_envs_per_env_runner": 1, "gym_env_vectorize_mode": "SYNC", "num_cpus_per_env_runner": 1, "num_gpus_per_env_runner": 0, "custom_resources_per_env_runner": {}, "validate_env_runners_after_construction": true, "episodes_to_numpy": true, "max_requests_in_flight_per_env_runner": 1, "sample_timeout_s": 60.0, "_env_to_module_connector": null, "add_default_connectors_to_env_to_module_pipeline": true, "_module_to_env_connector": null, "add_default_connectors_to_module_to_env_pipeline": true, "merge_env_runner_states": "training_only", "broadcast_env_runner_states": true, "episode_lookback_horizon": 1, "rollout_fragment_length": "auto", "batch_mode": "complete_episodes", "compress_observations": false, "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "enable_tf1_exec_eagerly": false, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "preprocessor_pref": "deepmind", "observation_filter": "NoFilter", "update_worker_filter_stats": true, "use_worker_filter_stats": true, "sampler_perf_stats_ema_coef": null, "_is_online": true, "num_learners": 0, "num_gpus_per_learner": 0, "num_cpus_per_learner": "auto", "num_aggregator_actors_per_learner": 0, "max_requests_in_flight_per_aggregator_actor": 3, "local_gpu_idx": 0, "max_requests_in_flight_per_learner": 3, "gamma": 1, "lr": 0.0002847858517, "grad_clip": 0.5, "grad_clip_by": "global_norm", "_train_batch_size_per_learner": 5000, "train_batch_size": 4000, "num_epochs": 1, "minibatch_size": 1000, "shuffle_batch_per_epoch": true, "model": {"fcnet_hiddens": [256, 256], "fcnet_activation": "tanh", "fcnet_weights_initializer": null, "fcnet_weights_initializer_config": null, "fcnet_bias_initializer": null, "fcnet_bias_initializer_config": null, "conv_filters": null, "conv_activation": "relu", "conv_kernel_initializer": null, "conv_kernel_initializer_config": null, "conv_bias_initializer": null, "conv_bias_initializer_config": null, "conv_transpose_kernel_initializer": null, "conv_transpose_kernel_initializer_config": null, "conv_transpose_bias_initializer": null, "conv_transpose_bias_initializer_config": null, "post_fcnet_hiddens": [], "post_fcnet_activation": "relu", "post_fcnet_weights_initializer": null, "post_fcnet_weights_initializer_config": null, "post_fcnet_bias_initializer": null, "post_fcnet_bias_initializer_config": null, "free_log_std": false, "log_std_clip_param": 20.0, "no_final_linear": false, "vf_share_layers": false, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "lstm_weights_initializer": null, "lstm_weights_initializer_config": null, "lstm_bias_initializer": null, "lstm_bias_initializer_config": null, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "attention_use_n_prev_actions": 0, "attention_use_n_prev_rewards": 0, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": null, "custom_model_config": {}, "custom_action_dist": null, "custom_preprocessor": null, "encoder_latent_dim": null, "always_check_shapes": false, "lstm_use_prev_action_reward": -1, "_use_default_native_models": -1, "_disable_preprocessor_api": false, "_disable_action_flattening": false}, "_learner_connector": null, "add_default_connectors_to_learner_pipeline": true, "learner_config_dict": {}, "optimizer": {}, "_learner_class": null, "callbacks_on_algorithm_init": null, "callbacks_on_env_runners_recreated": null, "callbacks_on_offline_eval_runners_recreated": null, "callbacks_on_checkpoint_loaded": null, "callbacks_on_environment_created": null, "callbacks_on_episode_created": null, "callbacks_on_episode_start": null, "callbacks_on_episode_step": null, "callbacks_on_episode_end": null, "callbacks_on_evaluate_start": null, "callbacks_on_evaluate_end": null, "callbacks_on_evaluate_offline_start": null, "callbacks_on_evaluate_offline_end": null, "callbacks_on_sample_end": null, "callbacks_on_train_result": null, "explore": true, "enable_rl_module_and_learner": true, "enable_env_runner_and_connector_v2": true, "_prior_exploration_config": {"type": "StochasticSampling"}, "count_steps_by": "env_steps", "policy_map_capacity": 100, "policy_mapping_fn": "<function AlgorithmConfig.DEFAULT_POLICY_MAPPING_FN at 0x13bfddb20>", "policies_to_train": null, "policy_states_are_swappable": false, "observation_fn": null, "offline_data_class": null, "input_read_method": "read_parquet", "input_read_method_kwargs": {}, "input_read_schema": {}, "input_read_episodes": false, "input_read_sample_batches": false, "input_read_batch_size": null, "input_filesystem": null, "input_filesystem_kwargs": {}, "input_compress_columns": ["obs", "new_obs"], "input_spaces_jsonable": true, "materialize_data": false, "materialize_mapped_data": true, "map_batches_kwargs": {}, "iter_batches_kwargs": {}, "ignore_final_observation": false, "prelearner_class": null, "prelearner_buffer_class": null, "prelearner_buffer_kwargs": {}, "prelearner_module_synch_period": 10, "dataset_num_iters_per_learner": null, "input_config": {}, "actions_in_input_normalized": false, "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_config": {}, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "output_max_rows_per_file": null, "output_write_remaining_data": false, "output_write_method": "write_parquet", "output_write_method_kwargs": {}, "output_filesystem": null, "output_filesystem_kwargs": {}, "output_write_episodes": true, "offline_sampling": false, "evaluation_interval": 1, "evaluation_duration": 20, "evaluation_duration_unit": "episodes", "evaluation_sample_timeout_s": 120.0, "evaluation_auto_duration_min_env_steps_per_sample": 100, "evaluation_auto_duration_max_env_steps_per_sample": 2000, "evaluation_parallel_to_training": false, "evaluation_force_reset_envs_before_iteration": true, "evaluation_config": null, "off_policy_estimation_methods": {}, "ope_split_batch_by_episode": true, "evaluation_num_env_runners": 1, "in_evaluation": false, "sync_filters_on_rollout_workers_timeout_s": 10.0, "offline_evaluation_interval": null, "num_offline_eval_runners": 0, "offline_loss_for_module_fn": null, "offline_evaluation_duration": 1, "offline_evaluation_parallel_to_training": false, "offline_evaluation_timeout_s": 120.0, "num_cpus_per_offline_eval_runner": 1, "num_gpus_per_offline_eval_runner": 0, "custom_resources_per_offline_eval_runner": {}, "restart_failed_offline_eval_runners": true, "ignore_offline_eval_runner_failures": false, "max_num_offline_eval_runner_restarts": 1000, "offline_eval_runner_restore_timeout_s": 1800.0, "max_requests_in_flight_per_offline_eval_runner": 1, "validate_offline_eval_runners_after_construction": true, "offline_eval_runner_health_probe_timeout_s": 30.0, "offline_eval_rl_module_inference_only": false, "broadcast_offline_eval_runner_states": false, "offline_eval_batch_size_per_runner": 256, "dataset_num_iters_per_eval_runner": 1, "keep_per_episode_custom_metrics": false, "metrics_episode_collection_timeout_s": 60.0, "metrics_num_episodes_for_smoothing": 100, "min_time_s_per_iteration": null, "min_train_timesteps_per_iteration": 0, "min_sample_timesteps_per_iteration": 0, "log_gradients": true, "export_native_model_files": false, "checkpoint_trainable_policies_only": false, "logger_creator": null, "logger_config": null, "log_level": "WARN", "log_sys_usage": true, "fake_sampler": false, "seed": 5, "restart_failed_env_runners": true, "ignore_env_runner_failures": false, "max_num_env_runner_restarts": 1000, "delay_between_env_runner_restarts_s": 60.0, "restart_failed_sub_environments": false, "num_consecutive_env_runner_failures_tolerance": 100, "env_runner_health_probe_timeout_s": 30.0, "env_runner_restore_timeout_s": 1800.0, "_model_config": {}, "_rl_module_spec": "RLModuleSpec(module_class=None, observation_space=None, action_space=None, inference_only=False, learner_only=False, model_config=DefaultModelConfig(fcnet_hiddens=[60, 90], fcnet_activation='tanh', fcnet_kernel_initializer=None, fcnet_kernel_initializer_kwargs=None, fcnet_bias_initializer=None, fcnet_bias_initializer_kwargs=None, conv_filters=None, conv_activation='relu', conv_kernel_initializer=None, conv_kernel_initializer_kwargs=None, conv_bias_initializer=None, conv_bias_initializer_kwargs=None, head_fcnet_hiddens=[], head_fcnet_activation='relu', head_fcnet_kernel_initializer=None, head_fcnet_kernel_initializer_kwargs=None, head_fcnet_bias_initializer=None, head_fcnet_bias_initializer_kwargs=None, free_log_std=False, log_std_clip_param=20.0, vf_share_layers=True, use_lstm=False, max_seq_len=20, lstm_cell_size=256, lstm_use_prev_action=False, lstm_use_prev_reward=False, lstm_kernel_initializer=None, lstm_kernel_initializer_kwargs=None, lstm_bias_initializer=None, lstm_bias_initializer_kwargs=None), catalog_class=None, load_state_path=None, model_config_dict=None)", "algorithm_config_overrides_per_module": {}, "_per_module_overrides": {}, "_validate_config": true, "_use_msgpack_checkpoints": false, "_torch_grad_scaler_class": null, "_torch_lr_scheduler_classes": null, "_tf_policy_handles_more_than_one_loss": false, "_disable_preprocessor_api": false, "_disable_action_flattening": false, "_disable_initialize_loss_from_dummy_batch": false, "_dont_auto_sync_env_runner_states": false, "env_task_fn": -1, "enable_connectors": -1, "simple_optimizer": false, "policy_map_cache": -1, "worker_cls": -1, "synchronize_filters": -1, "enable_async_evaluation": -1, "custom_async_evaluation_function": -1, "_enable_rl_module_api": -1, "auto_wrap_old_gym_envs": -1, "always_attach_evaluation_results": -1, "replay_sequence_length": null, "_disable_execution_plan_api": -1, "use_critic": true, "use_gae": true, "use_kl_loss": true, "kl_coeff": 0.7464963036515, "kl_target": 0.0270990929592, "vf_loss_coeff": 0.6688075857018, "entropy_coeff": 0.0090570820258, "clip_param": 0.1221781641624, "vf_clip_param": 0.1027808522125, "entropy_coeff_schedule": null, "lr_schedule": null, "sgd_minibatch_size": -1, "vf_share_layers": -1, "__stdout_file__": null, "__stderr_file__": null, "lambda": 0.9099046732075, "input": "sampler", "policies": {"default_policy": [null, null, null, null]}, "callbacks": "<class 'ray.rllib.callbacks.callbacks.RLlibCallback'>", "create_env_on_driver": false, "custom_eval_function": null, "framework": "torch"}, "time_since_restore": 54.2024040222168, "iterations_since_restore": 19, "perf": {"cpu_util_percent": 72.1, "ram_util_percent": 78.775}}
{"timers": {"training_iteration": 2.553447892840553, "restore_env_runners": 1.2555995917692071e-05, "training_step": 2.553219225335864, "env_runner_sampling_timer": 2.3889077964453476, "learner_update_timer": 0.16082872139951712, "synch_weights": 0.0006775364664539022, "restore_eval_env_runners": 9.246507216409272e-06, "evaluation_iteration": 0.17305500535672846, "synch_eval_env_connectors": 0.00015666856653258937, "synch_env_connectors": 5.3820394393214235e-06}, "env_runners": {"weights_seq_no": 19.0, "episode_return_max": 6.5, "num_episodes": 250.0, "module_to_env_connector": {"timers": {"connectors": {"tensor_to_numpy": 2.5777775560926113e-05, "remove_single_ts_time_rank_from_batch": 1.293613802933731e-06, "listify_data_for_vector_env": 2.0065044618142163e-05, "get_actions": 8.572633175253065e-05, "normalize_and_clip_actions": 1.6980464372926844e-05, "un_batch_to_individual_items": 9.306520083242627e-06}}, "connector_pipeline_timer": 0.0002045243706752371}, "env_to_module_connector": {"timers": {"connectors": {"batch_individual_items": 1.2505937196788383e-05, "add_time_dim_to_batch_and_zero_pad": 4.452674501372062e-06, "numpy_to_tensor": 1.815721459827776e-05, "add_observations_from_episodes_to_batch": 5.323620711472724e-06, "add_states_from_episodes_to_batch": 2.759524758139521e-06}}, "connector_pipeline_timer": 8.022750721558281e-05}, "agent_episode_returns_mean": {"default_agent": 5.380000000000001}, "env_to_module_sum_episodes_length_out": 10.36823839457432, "num_module_steps_sampled": {"default_policy": 5000.0}, "episode_return_min": -13.5, "time_between_sampling": 0.002966560826638353, "episode_len_min": 20, "episode_len_mean": 20.0, "episode_return_mean": 5.380000000000001, "episode_len_max": 20, "sample": 0.00940870634050571, "num_env_steps_sampled": 5000.0, "episode_duration_sec_mean": 0.008951269033830615, "env_to_module_sum_episodes_length_in": 10.36823839457432, "env_step_timer": 2.9519117604799803e-05, "num_module_steps_sampled_lifetime": {"default_policy": -11105000.0}, "num_episodes_lifetime": -555250.0, "num_env_steps_sampled_lifetime": -11105000.0, "num_agent_steps_sampled_lifetime": {"default_agent": -11105000.0}, "env_reset_timer": 7.9800918935234e-05, "rlmodule_inference_timer": 6.010110106732005e-05, "module_episode_returns_mean": {"default_policy": 5.380000000000001}, "num_agent_steps_sampled": {"default_agent": 5000.0}, "num_env_steps_sampled_lifetime_throughput": 2260.546247886454}, "learners": {"default_policy": {"vf_loss_unclipped": 22.31365966796875, "default_optimizer_learning_rate": 0.0002847858517, "module_train_batch_size_mean": 1000.0, "vf_loss": 0.10278083384037018, "entropy": 0.36841875314712524, "total_loss": 0.05449638143181801, "policy_loss": -0.010907428339123726, "vf_explained_var": -0.02270638942718506, "mean_kl_loss": 1.596551010152325e-05, "diff_num_grad_updates_vs_sampler_policy": 1.0, "gradients_default_optimizer_global_norm": 0.03705389052629471, "num_module_steps_trained_lifetime": 120000, "curr_entropy_coeff": 0.0090570820258, "num_module_steps_trained": 6000, "num_trainable_parameters": 6003, "curr_kl_coeff": 7.119143674572115e-07, "weights_seq_no": 20.0, "num_module_steps_trained_lifetime_throughput": 239284.93858149296}, "__all_modules__": {"learner_connector": {"timers": {"connectors": {"add_observations_from_episodes_to_batch": 0.0008970504304975299, "general_advantage_estimation": 0.009639652254400955, "add_one_ts_to_episodes_and_truncate": 0.01084486458975745, "add_columns_from_episodes_to_train_batch": 0.04042067878890371, "numpy_to_tensor": 0.00013452247129285087, "add_states_from_episodes_to_batch": 3.8453838357257204e-06, "batch_individual_items": 0.05593649289978239, "add_time_dim_to_batch_and_zero_pad": 1.317755800117813e-05}}, "connector_pipeline_timer": 0.11810729379502834}, "num_env_steps_trained": 31500, "num_env_steps_trained_lifetime": 630000, "num_module_steps_trained_lifetime": 120000, "learner_connector_sum_episodes_length_in": 5000.0, "num_trainable_parameters": 6003, "learner_connector_sum_episodes_length_out": 5250.0, "num_module_steps_trained": 6000, "num_non_trainable_parameters": 0, "num_env_steps_trained_lifetime_throughput": 1255387.3059773159, "num_module_steps_trained_throughput": 239420.45105020227, "num_module_steps_trained_lifetime_throughput": 239285.467233194}}, "num_training_step_calls_per_iteration": 1, "evaluation": {"env_runners": {"module_to_env_connector": {"connector_pipeline_timer": 0.0001388819652715135, "timers": {"connectors": {"remove_single_ts_time_rank_from_batch": 7.228274037286955e-07, "listify_data_for_vector_env": 1.5095388361669164e-05, "normalize_and_clip_actions": 1.2571941705425277e-05, "get_actions": 5.268467520865038e-05, "tensor_to_numpy": 1.7565613899643128e-05, "un_batch_to_individual_items": 6.804772239969026e-06}}}, "num_episodes_lifetime": 400, "weights_seq_no": 20.0, "episode_return_max": 12.5, "num_env_steps_sampled": 400, "env_to_module_sum_episodes_length_in": 10.368238394574323, "env_to_module_connector": {"timers": {"connectors": {"add_observations_from_episodes_to_batch": 3.5656213398670803e-06, "numpy_to_tensor": 1.1866230784277818e-05, "add_states_from_episodes_to_batch": 2.012773592446477e-06, "batch_individual_items": 8.682942504782696e-06, "add_time_dim_to_batch_and_zero_pad": 2.8958757130252513e-06}}, "connector_pipeline_timer": 5.5947106220843256e-05}, "env_to_module_sum_episodes_length_out": 10.368238394574323, "episode_len_max": 20, "episode_duration_sec_mean": 0.007483478826470673, "env_step_timer": 1.946070232187875e-05, "num_env_steps_sampled_lifetime": 100400, "rlmodule_inference_timer": 3.815895400557798e-05, "num_module_steps_sampled_lifetime": {"default_policy": 8000}, "num_agent_steps_sampled_lifetime": {"default_agent": 8000}, "num_agent_steps_sampled": {"default_agent": 400}, "episode_len_mean": 20.0, "episode_return_mean": 2.5, "agent_episode_returns_mean": {"default_agent": 2.5}, "num_module_steps_sampled": {"default_policy": 400}, "env_reset_timer": 0.00015680187012404511, "num_episodes": 20, "episode_return_min": -15.5, "module_episode_returns_mean": {"default_policy": 2.5}, "episode_len_min": 20, "sample": 0.1653580398170733, "time_between_sampling": 2.629676515694681}, "num_healthy_workers": 1, "actor_manager_num_outstanding_async_reqs": 0, "num_remote_worker_restarts": 0}, "num_env_steps_sampled_lifetime": -11105000.0, "fault_tolerance": {"num_healthy_workers": 0, "num_remote_worker_restarts": 0}, "env_runner_group": {"actor_manager_num_outstanding_async_reqs": 0}, "done": true, "training_iteration": 20, "trial_id": "46b1a_00000", "date": "2025-08-11_19-35-09", "timestamp": 1754933709, "time_this_iter_s": 2.9610917568206787, "time_total_s": 57.163495779037476, "pid": 26849, "hostname": "Mac", "node_ip": "127.0.0.1", "config": {"exploration_config": {}, "extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "placement_strategy": "PACK", "num_gpus": 0, "_fake_gpus": false, "num_cpus_for_main_process": 2, "eager_tracing": true, "eager_max_retraces": 20, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "torch_compile_learner": false, "torch_compile_learner_what_to_compile": "forward_train", "torch_compile_learner_dynamo_backend": "aot_eager", "torch_compile_learner_dynamo_mode": null, "torch_compile_worker": false, "torch_compile_worker_dynamo_backend": "aot_eager", "torch_compile_worker_dynamo_mode": null, "torch_ddp_kwargs": {}, "torch_skip_nan_gradients": false, "env": "Umbrella", "env_config": {}, "observation_space": null, "action_space": null, "clip_rewards": null, "normalize_actions": true, "clip_actions": false, "_is_atari": null, "disable_env_checking": false, "render_env": false, "action_mask_key": "action_mask", "env_runner_cls": null, "num_env_runners": 0, "create_local_env_runner": true, "num_envs_per_env_runner": 1, "gym_env_vectorize_mode": "SYNC", "num_cpus_per_env_runner": 1, "num_gpus_per_env_runner": 0, "custom_resources_per_env_runner": {}, "validate_env_runners_after_construction": true, "episodes_to_numpy": true, "max_requests_in_flight_per_env_runner": 1, "sample_timeout_s": 60.0, "_env_to_module_connector": null, "add_default_connectors_to_env_to_module_pipeline": true, "_module_to_env_connector": null, "add_default_connectors_to_module_to_env_pipeline": true, "merge_env_runner_states": "training_only", "broadcast_env_runner_states": true, "episode_lookback_horizon": 1, "rollout_fragment_length": "auto", "batch_mode": "complete_episodes", "compress_observations": false, "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "enable_tf1_exec_eagerly": false, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "preprocessor_pref": "deepmind", "observation_filter": "NoFilter", "update_worker_filter_stats": true, "use_worker_filter_stats": true, "sampler_perf_stats_ema_coef": null, "_is_online": true, "num_learners": 0, "num_gpus_per_learner": 0, "num_cpus_per_learner": "auto", "num_aggregator_actors_per_learner": 0, "max_requests_in_flight_per_aggregator_actor": 3, "local_gpu_idx": 0, "max_requests_in_flight_per_learner": 3, "gamma": 1, "lr": 0.0002847858517, "grad_clip": 0.5, "grad_clip_by": "global_norm", "_train_batch_size_per_learner": 5000, "train_batch_size": 4000, "num_epochs": 1, "minibatch_size": 1000, "shuffle_batch_per_epoch": true, "model": {"fcnet_hiddens": [256, 256], "fcnet_activation": "tanh", "fcnet_weights_initializer": null, "fcnet_weights_initializer_config": null, "fcnet_bias_initializer": null, "fcnet_bias_initializer_config": null, "conv_filters": null, "conv_activation": "relu", "conv_kernel_initializer": null, "conv_kernel_initializer_config": null, "conv_bias_initializer": null, "conv_bias_initializer_config": null, "conv_transpose_kernel_initializer": null, "conv_transpose_kernel_initializer_config": null, "conv_transpose_bias_initializer": null, "conv_transpose_bias_initializer_config": null, "post_fcnet_hiddens": [], "post_fcnet_activation": "relu", "post_fcnet_weights_initializer": null, "post_fcnet_weights_initializer_config": null, "post_fcnet_bias_initializer": null, "post_fcnet_bias_initializer_config": null, "free_log_std": false, "log_std_clip_param": 20.0, "no_final_linear": false, "vf_share_layers": false, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "lstm_weights_initializer": null, "lstm_weights_initializer_config": null, "lstm_bias_initializer": null, "lstm_bias_initializer_config": null, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "attention_use_n_prev_actions": 0, "attention_use_n_prev_rewards": 0, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": null, "custom_model_config": {}, "custom_action_dist": null, "custom_preprocessor": null, "encoder_latent_dim": null, "always_check_shapes": false, "lstm_use_prev_action_reward": -1, "_use_default_native_models": -1, "_disable_preprocessor_api": false, "_disable_action_flattening": false}, "_learner_connector": null, "add_default_connectors_to_learner_pipeline": true, "learner_config_dict": {}, "optimizer": {}, "_learner_class": null, "callbacks_on_algorithm_init": null, "callbacks_on_env_runners_recreated": null, "callbacks_on_offline_eval_runners_recreated": null, "callbacks_on_checkpoint_loaded": null, "callbacks_on_environment_created": null, "callbacks_on_episode_created": null, "callbacks_on_episode_start": null, "callbacks_on_episode_step": null, "callbacks_on_episode_end": null, "callbacks_on_evaluate_start": null, "callbacks_on_evaluate_end": null, "callbacks_on_evaluate_offline_start": null, "callbacks_on_evaluate_offline_end": null, "callbacks_on_sample_end": null, "callbacks_on_train_result": null, "explore": true, "enable_rl_module_and_learner": true, "enable_env_runner_and_connector_v2": true, "_prior_exploration_config": {"type": "StochasticSampling"}, "count_steps_by": "env_steps", "policy_map_capacity": 100, "policy_mapping_fn": "<function AlgorithmConfig.DEFAULT_POLICY_MAPPING_FN at 0x13bfddb20>", "policies_to_train": null, "policy_states_are_swappable": false, "observation_fn": null, "offline_data_class": null, "input_read_method": "read_parquet", "input_read_method_kwargs": {}, "input_read_schema": {}, "input_read_episodes": false, "input_read_sample_batches": false, "input_read_batch_size": null, "input_filesystem": null, "input_filesystem_kwargs": {}, "input_compress_columns": ["obs", "new_obs"], "input_spaces_jsonable": true, "materialize_data": false, "materialize_mapped_data": true, "map_batches_kwargs": {}, "iter_batches_kwargs": {}, "ignore_final_observation": false, "prelearner_class": null, "prelearner_buffer_class": null, "prelearner_buffer_kwargs": {}, "prelearner_module_synch_period": 10, "dataset_num_iters_per_learner": null, "input_config": {}, "actions_in_input_normalized": false, "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_config": {}, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "output_max_rows_per_file": null, "output_write_remaining_data": false, "output_write_method": "write_parquet", "output_write_method_kwargs": {}, "output_filesystem": null, "output_filesystem_kwargs": {}, "output_write_episodes": true, "offline_sampling": false, "evaluation_interval": 1, "evaluation_duration": 20, "evaluation_duration_unit": "episodes", "evaluation_sample_timeout_s": 120.0, "evaluation_auto_duration_min_env_steps_per_sample": 100, "evaluation_auto_duration_max_env_steps_per_sample": 2000, "evaluation_parallel_to_training": false, "evaluation_force_reset_envs_before_iteration": true, "evaluation_config": null, "off_policy_estimation_methods": {}, "ope_split_batch_by_episode": true, "evaluation_num_env_runners": 1, "in_evaluation": false, "sync_filters_on_rollout_workers_timeout_s": 10.0, "offline_evaluation_interval": null, "num_offline_eval_runners": 0, "offline_loss_for_module_fn": null, "offline_evaluation_duration": 1, "offline_evaluation_parallel_to_training": false, "offline_evaluation_timeout_s": 120.0, "num_cpus_per_offline_eval_runner": 1, "num_gpus_per_offline_eval_runner": 0, "custom_resources_per_offline_eval_runner": {}, "restart_failed_offline_eval_runners": true, "ignore_offline_eval_runner_failures": false, "max_num_offline_eval_runner_restarts": 1000, "offline_eval_runner_restore_timeout_s": 1800.0, "max_requests_in_flight_per_offline_eval_runner": 1, "validate_offline_eval_runners_after_construction": true, "offline_eval_runner_health_probe_timeout_s": 30.0, "offline_eval_rl_module_inference_only": false, "broadcast_offline_eval_runner_states": false, "offline_eval_batch_size_per_runner": 256, "dataset_num_iters_per_eval_runner": 1, "keep_per_episode_custom_metrics": false, "metrics_episode_collection_timeout_s": 60.0, "metrics_num_episodes_for_smoothing": 100, "min_time_s_per_iteration": null, "min_train_timesteps_per_iteration": 0, "min_sample_timesteps_per_iteration": 0, "log_gradients": true, "export_native_model_files": false, "checkpoint_trainable_policies_only": false, "logger_creator": null, "logger_config": null, "log_level": "WARN", "log_sys_usage": true, "fake_sampler": false, "seed": 5, "restart_failed_env_runners": true, "ignore_env_runner_failures": false, "max_num_env_runner_restarts": 1000, "delay_between_env_runner_restarts_s": 60.0, "restart_failed_sub_environments": false, "num_consecutive_env_runner_failures_tolerance": 100, "env_runner_health_probe_timeout_s": 30.0, "env_runner_restore_timeout_s": 1800.0, "_model_config": {}, "_rl_module_spec": "RLModuleSpec(module_class=None, observation_space=None, action_space=None, inference_only=False, learner_only=False, model_config=DefaultModelConfig(fcnet_hiddens=[60, 90], fcnet_activation='tanh', fcnet_kernel_initializer=None, fcnet_kernel_initializer_kwargs=None, fcnet_bias_initializer=None, fcnet_bias_initializer_kwargs=None, conv_filters=None, conv_activation='relu', conv_kernel_initializer=None, conv_kernel_initializer_kwargs=None, conv_bias_initializer=None, conv_bias_initializer_kwargs=None, head_fcnet_hiddens=[], head_fcnet_activation='relu', head_fcnet_kernel_initializer=None, head_fcnet_kernel_initializer_kwargs=None, head_fcnet_bias_initializer=None, head_fcnet_bias_initializer_kwargs=None, free_log_std=False, log_std_clip_param=20.0, vf_share_layers=True, use_lstm=False, max_seq_len=20, lstm_cell_size=256, lstm_use_prev_action=False, lstm_use_prev_reward=False, lstm_kernel_initializer=None, lstm_kernel_initializer_kwargs=None, lstm_bias_initializer=None, lstm_bias_initializer_kwargs=None), catalog_class=None, load_state_path=None, model_config_dict=None)", "algorithm_config_overrides_per_module": {}, "_per_module_overrides": {}, "_validate_config": true, "_use_msgpack_checkpoints": false, "_torch_grad_scaler_class": null, "_torch_lr_scheduler_classes": null, "_tf_policy_handles_more_than_one_loss": false, "_disable_preprocessor_api": false, "_disable_action_flattening": false, "_disable_initialize_loss_from_dummy_batch": false, "_dont_auto_sync_env_runner_states": false, "env_task_fn": -1, "enable_connectors": -1, "simple_optimizer": false, "policy_map_cache": -1, "worker_cls": -1, "synchronize_filters": -1, "enable_async_evaluation": -1, "custom_async_evaluation_function": -1, "_enable_rl_module_api": -1, "auto_wrap_old_gym_envs": -1, "always_attach_evaluation_results": -1, "replay_sequence_length": null, "_disable_execution_plan_api": -1, "use_critic": true, "use_gae": true, "use_kl_loss": true, "kl_coeff": 0.7464963036515, "kl_target": 0.0270990929592, "vf_loss_coeff": 0.6688075857018, "entropy_coeff": 0.0090570820258, "clip_param": 0.1221781641624, "vf_clip_param": 0.1027808522125, "entropy_coeff_schedule": null, "lr_schedule": null, "sgd_minibatch_size": -1, "vf_share_layers": -1, "__stdout_file__": null, "__stderr_file__": null, "lambda": 0.9099046732075, "input": "sampler", "policies": {"default_policy": [null, null, null, null]}, "callbacks": "<class 'ray.rllib.callbacks.callbacks.RLlibCallback'>", "create_env_on_driver": false, "custom_eval_function": null, "framework": "torch"}, "time_since_restore": 57.163495779037476, "iterations_since_restore": 20, "perf": {"cpu_util_percent": 54.2, "ram_util_percent": 78.60000000000001}}
