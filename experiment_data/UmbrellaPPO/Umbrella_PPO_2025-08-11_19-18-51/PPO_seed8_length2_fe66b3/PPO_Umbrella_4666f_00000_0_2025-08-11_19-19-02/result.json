{"timers": {"training_iteration": 1.5574285419424996, "restore_env_runners": 1.1499971151351929e-05, "training_step": 1.5573106249794364, "env_runner_sampling_timer": 1.4497065410250798, "learner_update_timer": 0.10469829197973013, "synch_weights": 0.000548750045709312}, "env_runners": {"module_to_env_connector": {"timers": {"connectors": {"remove_single_ts_time_rank_from_batch": 5.773131961220416e-07, "un_batch_to_individual_items": 5.541972944899777e-06, "normalize_and_clip_actions": 1.236183375426064e-05, "get_actions": 4.23021713129643e-05, "listify_data_for_vector_env": 1.1165282686891223e-05, "tensor_to_numpy": 1.3305942205891697e-05}}, "connector_pipeline_timer": 0.00011142873182619591}, "episode_duration_sec_mean": 0.004887265523895622, "env_to_module_connector": {"timers": {"connectors": {"add_time_dim_to_batch_and_zero_pad": 2.433557812088278e-06, "numpy_to_tensor": 8.837745970400899e-06, "batch_individual_items": 6.341327369726451e-06, "add_observations_from_episodes_to_batch": 3.1427117024253506e-06, "add_states_from_episodes_to_batch": 1.7642089799009109e-06}}, "connector_pipeline_timer": 4.61017059907702e-05}, "env_reset_timer": 7.262321913814404e-05, "episode_return_min": -11.5, "episode_return_max": 8.5, "rlmodule_inference_timer": 4.86785509894879e-05, "time_between_sampling": 0.0004999954970450613, "num_module_steps_sampled": {"default_policy": 5000.0}, "num_module_steps_sampled_lifetime": {"default_policy": 627500.0}, "episode_len_mean": 20.0, "episode_return_mean": -1.5, "num_env_steps_sampled": 5000.0, "num_agent_steps_sampled": {"default_agent": 5000.0}, "module_episode_returns_mean": {"default_policy": -1.5}, "weights_seq_no": 0.0, "num_env_steps_sampled_lifetime": 627500.0, "env_step_timer": 1.4602768447412497e-05, "num_episodes_lifetime": 31375.0, "env_to_module_sum_episodes_length_out": 10.191744832559449, "num_episodes": 250.0, "sample": 0.005612134809451478, "agent_episode_returns_mean": {"default_agent": -1.5}, "env_to_module_sum_episodes_length_in": 10.191744832559449, "episode_len_max": 20, "episode_len_min": 20, "num_agent_steps_sampled_lifetime": {"default_agent": 627500.0}, "num_env_steps_sampled_lifetime_throughput": 3527.887183241183}, "learners": {"default_policy": {"curr_entropy_coeff": 0.0090570820258, "weights_seq_no": 1.0, "gradients_default_optimizer_global_norm": 0.040778517723083496, "entropy": 0.6905115842819214, "num_module_steps_trained": 6000, "num_trainable_parameters": 6003, "policy_loss": -0.04181544482707977, "mean_kl_loss": 0.0005123130395077169, "vf_loss": 0.10278083384037018, "module_train_batch_size_mean": 1000.0, "vf_explained_var": 0.0005095601081848145, "diff_num_grad_updates_vs_sampler_policy": 1.0, "default_optimizer_learning_rate": 0.0002847858517, "num_module_steps_trained_lifetime": 6000, "vf_loss_unclipped": 28.887786865234375, "total_loss": 0.02105357125401497, "curr_kl_coeff": 0.3732481598854065, "num_module_steps_trained_lifetime_throughput": 383290.31820253754}, "__all_modules__": {"learner_connector": {"connector_pipeline_timer": 0.07921437500044703, "timers": {"connectors": {"numpy_to_tensor": 7.541594095528126e-05, "add_one_ts_to_episodes_and_truncate": 0.007616832968778908, "add_time_dim_to_batch_and_zero_pad": 1.233397051692009e-05, "batch_individual_items": 0.030040499987080693, "general_advantage_estimation": 0.006602333975024521, "add_columns_from_episodes_to_train_batch": 0.033907582983374596, "add_states_from_episodes_to_batch": 3.334018401801586e-06, "add_observations_from_episodes_to_batch": 0.000830290955491364}}}, "num_module_steps_trained": 6000, "num_trainable_parameters": 6003, "learner_connector_sum_episodes_length_in": 5000, "num_module_steps_trained_lifetime": 6000, "num_non_trainable_parameters": 0, "num_env_steps_trained": 31500, "num_env_steps_trained_lifetime": 31500, "learner_connector_sum_episodes_length_out": 5250, "num_env_steps_trained_lifetime_throughput": 1999682.726338921, "num_module_steps_trained_throughput": 382388.78046186233, "num_module_steps_trained_lifetime_throughput": 381841.90744396363}}, "num_training_step_calls_per_iteration": 1, "num_env_steps_sampled_lifetime": 627500.0, "evaluation": {"env_runners": {"module_episode_returns_mean": {"default_policy": -0.25}, "env_to_module_connector": {"timers": {"connectors": {"add_observations_from_episodes_to_batch": 2.884697967521178e-06, "numpy_to_tensor": 8.34895448169156e-06, "add_time_dim_to_batch_and_zero_pad": 2.346616132452331e-06, "batch_individual_items": 6.100710331562419e-06, "add_states_from_episodes_to_batch": 1.5818993852823803e-06}}, "connector_pipeline_timer": 4.3371864378429234e-05}, "module_to_env_connector": {"timers": {"connectors": {"get_actions": 3.948538853126876e-05, "un_batch_to_individual_items": 5.4079688272966295e-06, "listify_data_for_vector_env": 1.10518350474442e-05, "normalize_and_clip_actions": 1.0317121058913578e-05, "tensor_to_numpy": 1.4295584028732622e-05, "remove_single_ts_time_rank_from_batch": 6.218696611960308e-07}}, "connector_pipeline_timer": 0.00010643111730266283}, "num_env_steps_sampled": 400, "num_agent_steps_sampled_lifetime": {"default_agent": 400}, "num_env_steps_sampled_lifetime": 5400, "num_module_steps_sampled": {"default_policy": 400}, "episode_len_max": 20, "episode_duration_sec_mean": 0.004491097899153829, "env_reset_timer": 0.00013916706666350365, "episode_return_max": 14.5, "agent_episode_returns_mean": {"default_agent": -0.25}, "num_episodes_lifetime": 20, "env_to_module_sum_episodes_length_in": 10.216013141322508, "episode_len_min": 20, "rlmodule_inference_timer": 2.9375164213908184e-05, "episode_return_mean": -0.25, "env_step_timer": 1.437722992742066e-05, "env_to_module_sum_episodes_length_out": 10.216013141322508, "num_episodes": 20, "num_agent_steps_sampled": {"default_agent": 400}, "episode_return_min": -12.5, "episode_len_mean": 20.0, "weights_seq_no": 1.0, "num_module_steps_sampled_lifetime": {"default_policy": 400}, "sample": 0.09850520896725357}, "num_healthy_workers": 1, "actor_manager_num_outstanding_async_reqs": 0, "num_remote_worker_restarts": 0}, "fault_tolerance": {"num_healthy_workers": 0, "num_remote_worker_restarts": 0}, "env_runner_group": {"actor_manager_num_outstanding_async_reqs": 0}, "done": false, "training_iteration": 1, "trial_id": "4666f_00000", "date": "2025-08-11_19-23-41", "timestamp": 1754933021, "time_this_iter_s": 1.663694143295288, "time_total_s": 1.663694143295288, "pid": 14463, "hostname": "Mac", "node_ip": "127.0.0.1", "config": {"exploration_config": {}, "extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "placement_strategy": "PACK", "num_gpus": 0, "_fake_gpus": false, "num_cpus_for_main_process": 2, "eager_tracing": true, "eager_max_retraces": 20, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "torch_compile_learner": false, "torch_compile_learner_what_to_compile": "forward_train", "torch_compile_learner_dynamo_backend": "aot_eager", "torch_compile_learner_dynamo_mode": null, "torch_compile_worker": false, "torch_compile_worker_dynamo_backend": "aot_eager", "torch_compile_worker_dynamo_mode": null, "torch_ddp_kwargs": {}, "torch_skip_nan_gradients": false, "env": "Umbrella", "env_config": {}, "observation_space": null, "action_space": null, "clip_rewards": null, "normalize_actions": true, "clip_actions": false, "_is_atari": null, "disable_env_checking": false, "render_env": false, "action_mask_key": "action_mask", "env_runner_cls": null, "num_env_runners": 0, "create_local_env_runner": true, "num_envs_per_env_runner": 1, "gym_env_vectorize_mode": "SYNC", "num_cpus_per_env_runner": 1, "num_gpus_per_env_runner": 0, "custom_resources_per_env_runner": {}, "validate_env_runners_after_construction": true, "episodes_to_numpy": true, "max_requests_in_flight_per_env_runner": 1, "sample_timeout_s": 60.0, "_env_to_module_connector": null, "add_default_connectors_to_env_to_module_pipeline": true, "_module_to_env_connector": null, "add_default_connectors_to_module_to_env_pipeline": true, "merge_env_runner_states": "training_only", "broadcast_env_runner_states": true, "episode_lookback_horizon": 1, "rollout_fragment_length": "auto", "batch_mode": "complete_episodes", "compress_observations": false, "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "enable_tf1_exec_eagerly": false, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "preprocessor_pref": "deepmind", "observation_filter": "NoFilter", "update_worker_filter_stats": true, "use_worker_filter_stats": true, "sampler_perf_stats_ema_coef": null, "_is_online": true, "num_learners": 0, "num_gpus_per_learner": 0, "num_cpus_per_learner": "auto", "num_aggregator_actors_per_learner": 0, "max_requests_in_flight_per_aggregator_actor": 3, "local_gpu_idx": 0, "max_requests_in_flight_per_learner": 3, "gamma": 1, "lr": 0.0002847858517, "grad_clip": 0.5, "grad_clip_by": "global_norm", "_train_batch_size_per_learner": 5000, "train_batch_size": 4000, "num_epochs": 1, "minibatch_size": 1000, "shuffle_batch_per_epoch": true, "model": {"fcnet_hiddens": [256, 256], "fcnet_activation": "tanh", "fcnet_weights_initializer": null, "fcnet_weights_initializer_config": null, "fcnet_bias_initializer": null, "fcnet_bias_initializer_config": null, "conv_filters": null, "conv_activation": "relu", "conv_kernel_initializer": null, "conv_kernel_initializer_config": null, "conv_bias_initializer": null, "conv_bias_initializer_config": null, "conv_transpose_kernel_initializer": null, "conv_transpose_kernel_initializer_config": null, "conv_transpose_bias_initializer": null, "conv_transpose_bias_initializer_config": null, "post_fcnet_hiddens": [], "post_fcnet_activation": "relu", "post_fcnet_weights_initializer": null, "post_fcnet_weights_initializer_config": null, "post_fcnet_bias_initializer": null, "post_fcnet_bias_initializer_config": null, "free_log_std": false, "log_std_clip_param": 20.0, "no_final_linear": false, "vf_share_layers": false, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "lstm_weights_initializer": null, "lstm_weights_initializer_config": null, "lstm_bias_initializer": null, "lstm_bias_initializer_config": null, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "attention_use_n_prev_actions": 0, "attention_use_n_prev_rewards": 0, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": null, "custom_model_config": {}, "custom_action_dist": null, "custom_preprocessor": null, "encoder_latent_dim": null, "always_check_shapes": false, "lstm_use_prev_action_reward": -1, "_use_default_native_models": -1, "_disable_preprocessor_api": false, "_disable_action_flattening": false}, "_learner_connector": null, "add_default_connectors_to_learner_pipeline": true, "learner_config_dict": {}, "optimizer": {}, "_learner_class": null, "callbacks_on_algorithm_init": null, "callbacks_on_env_runners_recreated": null, "callbacks_on_offline_eval_runners_recreated": null, "callbacks_on_checkpoint_loaded": null, "callbacks_on_environment_created": null, "callbacks_on_episode_created": null, "callbacks_on_episode_start": null, "callbacks_on_episode_step": null, "callbacks_on_episode_end": null, "callbacks_on_evaluate_start": null, "callbacks_on_evaluate_end": null, "callbacks_on_evaluate_offline_start": null, "callbacks_on_evaluate_offline_end": null, "callbacks_on_sample_end": null, "callbacks_on_train_result": null, "explore": true, "enable_rl_module_and_learner": true, "enable_env_runner_and_connector_v2": true, "_prior_exploration_config": {"type": "StochasticSampling"}, "count_steps_by": "env_steps", "policy_map_capacity": 100, "policy_mapping_fn": "<function AlgorithmConfig.DEFAULT_POLICY_MAPPING_FN at 0x1551edb20>", "policies_to_train": null, "policy_states_are_swappable": false, "observation_fn": null, "offline_data_class": null, "input_read_method": "read_parquet", "input_read_method_kwargs": {}, "input_read_schema": {}, "input_read_episodes": false, "input_read_sample_batches": false, "input_read_batch_size": null, "input_filesystem": null, "input_filesystem_kwargs": {}, "input_compress_columns": ["obs", "new_obs"], "input_spaces_jsonable": true, "materialize_data": false, "materialize_mapped_data": true, "map_batches_kwargs": {}, "iter_batches_kwargs": {}, "ignore_final_observation": false, "prelearner_class": null, "prelearner_buffer_class": null, "prelearner_buffer_kwargs": {}, "prelearner_module_synch_period": 10, "dataset_num_iters_per_learner": null, "input_config": {}, "actions_in_input_normalized": false, "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_config": {}, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "output_max_rows_per_file": null, "output_write_remaining_data": false, "output_write_method": "write_parquet", "output_write_method_kwargs": {}, "output_filesystem": null, "output_filesystem_kwargs": {}, "output_write_episodes": true, "offline_sampling": false, "evaluation_interval": 1, "evaluation_duration": 20, "evaluation_duration_unit": "episodes", "evaluation_sample_timeout_s": 120.0, "evaluation_auto_duration_min_env_steps_per_sample": 100, "evaluation_auto_duration_max_env_steps_per_sample": 2000, "evaluation_parallel_to_training": false, "evaluation_force_reset_envs_before_iteration": true, "evaluation_config": null, "off_policy_estimation_methods": {}, "ope_split_batch_by_episode": true, "evaluation_num_env_runners": 1, "in_evaluation": false, "sync_filters_on_rollout_workers_timeout_s": 10.0, "offline_evaluation_interval": null, "num_offline_eval_runners": 0, "offline_loss_for_module_fn": null, "offline_evaluation_duration": 1, "offline_evaluation_parallel_to_training": false, "offline_evaluation_timeout_s": 120.0, "num_cpus_per_offline_eval_runner": 1, "num_gpus_per_offline_eval_runner": 0, "custom_resources_per_offline_eval_runner": {}, "restart_failed_offline_eval_runners": true, "ignore_offline_eval_runner_failures": false, "max_num_offline_eval_runner_restarts": 1000, "offline_eval_runner_restore_timeout_s": 1800.0, "max_requests_in_flight_per_offline_eval_runner": 1, "validate_offline_eval_runners_after_construction": true, "offline_eval_runner_health_probe_timeout_s": 30.0, "offline_eval_rl_module_inference_only": false, "broadcast_offline_eval_runner_states": false, "offline_eval_batch_size_per_runner": 256, "dataset_num_iters_per_eval_runner": 1, "keep_per_episode_custom_metrics": false, "metrics_episode_collection_timeout_s": 60.0, "metrics_num_episodes_for_smoothing": 100, "min_time_s_per_iteration": null, "min_train_timesteps_per_iteration": 0, "min_sample_timesteps_per_iteration": 0, "log_gradients": true, "export_native_model_files": false, "checkpoint_trainable_policies_only": false, "logger_creator": null, "logger_config": null, "log_level": "WARN", "log_sys_usage": true, "fake_sampler": false, "seed": 8, "restart_failed_env_runners": true, "ignore_env_runner_failures": false, "max_num_env_runner_restarts": 1000, "delay_between_env_runner_restarts_s": 60.0, "restart_failed_sub_environments": false, "num_consecutive_env_runner_failures_tolerance": 100, "env_runner_health_probe_timeout_s": 30.0, "env_runner_restore_timeout_s": 1800.0, "_model_config": {}, "_rl_module_spec": "RLModuleSpec(module_class=None, observation_space=None, action_space=None, inference_only=False, learner_only=False, model_config=DefaultModelConfig(fcnet_hiddens=[60, 90], fcnet_activation='tanh', fcnet_kernel_initializer=None, fcnet_kernel_initializer_kwargs=None, fcnet_bias_initializer=None, fcnet_bias_initializer_kwargs=None, conv_filters=None, conv_activation='relu', conv_kernel_initializer=None, conv_kernel_initializer_kwargs=None, conv_bias_initializer=None, conv_bias_initializer_kwargs=None, head_fcnet_hiddens=[], head_fcnet_activation='relu', head_fcnet_kernel_initializer=None, head_fcnet_kernel_initializer_kwargs=None, head_fcnet_bias_initializer=None, head_fcnet_bias_initializer_kwargs=None, free_log_std=False, log_std_clip_param=20.0, vf_share_layers=True, use_lstm=False, max_seq_len=20, lstm_cell_size=256, lstm_use_prev_action=False, lstm_use_prev_reward=False, lstm_kernel_initializer=None, lstm_kernel_initializer_kwargs=None, lstm_bias_initializer=None, lstm_bias_initializer_kwargs=None), catalog_class=None, load_state_path=None, model_config_dict=None)", "algorithm_config_overrides_per_module": {}, "_per_module_overrides": {}, "_validate_config": true, "_use_msgpack_checkpoints": false, "_torch_grad_scaler_class": null, "_torch_lr_scheduler_classes": null, "_tf_policy_handles_more_than_one_loss": false, "_disable_preprocessor_api": false, "_disable_action_flattening": false, "_disable_initialize_loss_from_dummy_batch": false, "_dont_auto_sync_env_runner_states": false, "env_task_fn": -1, "enable_connectors": -1, "simple_optimizer": false, "policy_map_cache": -1, "worker_cls": -1, "synchronize_filters": -1, "enable_async_evaluation": -1, "custom_async_evaluation_function": -1, "_enable_rl_module_api": -1, "auto_wrap_old_gym_envs": -1, "always_attach_evaluation_results": -1, "replay_sequence_length": null, "_disable_execution_plan_api": -1, "use_critic": true, "use_gae": true, "use_kl_loss": true, "kl_coeff": 0.7464963036515, "kl_target": 0.0270990929592, "vf_loss_coeff": 0.6688075857018, "entropy_coeff": 0.0090570820258, "clip_param": 0.1221781641624, "vf_clip_param": 0.1027808522125, "entropy_coeff_schedule": null, "lr_schedule": null, "sgd_minibatch_size": -1, "vf_share_layers": -1, "__stdout_file__": null, "__stderr_file__": null, "lambda": 0.9099046732075, "input": "sampler", "policies": {"default_policy": [null, null, null, null]}, "callbacks": "<class 'ray.rllib.callbacks.callbacks.RLlibCallback'>", "create_env_on_driver": false, "custom_eval_function": null, "framework": "torch"}, "time_since_restore": 1.663694143295288, "iterations_since_restore": 1, "perf": {"cpu_util_percent": 13.0, "ram_util_percent": 76.83333333333333}}
{"timers": {"training_iteration": 1.5573312115226872, "restore_env_runners": 1.1449141893535853e-05, "training_step": 1.5572125145595055, "env_runner_sampling_timer": 1.4488220222841484, "learner_update_timer": 0.10548299156012945, "synch_weights": 0.000549137545749545, "restore_eval_env_runners": 8.292030543088913e-06, "evaluation_iteration": 0.10466483293566853, "synch_eval_env_connectors": 0.00014183390885591507, "synch_env_connectors": 4.790956154465675e-06}, "env_runners": {"module_to_env_connector": {"timers": {"connectors": {"remove_single_ts_time_rank_from_batch": 5.665524256037399e-07, "un_batch_to_individual_items": 5.314831949635363e-06, "normalize_and_clip_actions": 9.364718740217872e-06, "get_actions": 3.8173518731339664e-05, "listify_data_for_vector_env": 1.0931557022787251e-05, "tensor_to_numpy": 1.3018241936261664e-05}}, "connector_pipeline_timer": 0.00010299219036584503}, "episode_duration_sec_mean": 0.004493530822452158, "env_to_module_connector": {"timers": {"connectors": {"add_time_dim_to_batch_and_zero_pad": 2.3213015551462618e-06, "numpy_to_tensor": 8.4102718612413e-06, "batch_individual_items": 6.106135038197128e-06, "add_observations_from_episodes_to_batch": 2.9337153372216855e-06, "add_states_from_episodes_to_batch": 1.7436766215287581e-06}}, "connector_pipeline_timer": 4.3115188891601745e-05}, "env_reset_timer": 3.5062884384601695e-05, "episode_return_min": -11.5, "episode_return_max": 8.5, "rlmodule_inference_timer": 2.8089904654548282e-05, "time_between_sampling": 0.0014959640113631051, "num_module_steps_sampled": {"default_policy": 5000.0}, "num_module_steps_sampled_lifetime": {"default_policy": 10000.0}, "episode_len_mean": 20.0, "episode_return_mean": 0.17999999999999997, "num_env_steps_sampled": 5000.0, "num_agent_steps_sampled": {"default_agent": 5000.0}, "module_episode_returns_mean": {"default_policy": 0.17999999999999997}, "weights_seq_no": 1.0, "num_env_steps_sampled_lifetime": 10000.0, "env_step_timer": 1.360360573624586e-05, "num_episodes_lifetime": 500.0, "env_to_module_sum_episodes_length_out": 10.36823839457432, "num_episodes": 250.0, "sample": 0.005152631947681092, "agent_episode_returns_mean": {"default_agent": 0.17999999999999997}, "env_to_module_sum_episodes_length_in": 10.36823839457432, "episode_len_max": 20, "episode_len_min": 20, "num_agent_steps_sampled_lifetime": {"default_agent": 10000.0}, "num_env_steps_sampled_lifetime_throughput": 3764.2967994156415}, "learners": {"default_policy": {"curr_entropy_coeff": 0.0090570820258, "weights_seq_no": 2.0, "gradients_default_optimizer_global_norm": 0.12324754893779755, "entropy": 0.6900495290756226, "num_module_steps_trained": 6000, "num_trainable_parameters": 6003, "policy_loss": 0.1580778807401657, "mean_kl_loss": 5.7608696806710213e-05, "vf_loss": 0.10278083384037018, "module_train_batch_size_mean": 1000.0, "vf_explained_var": 0.0014600753784179688, "diff_num_grad_updates_vs_sampler_policy": 1.0, "default_optimizer_learning_rate": 0.0002847858517, "num_module_steps_trained_lifetime": 12000, "vf_loss_unclipped": 28.989748001098633, "total_loss": 0.22059014439582825, "curr_kl_coeff": 0.18662407994270325, "num_module_steps_trained_lifetime_throughput": 384095.16094521555}, "__all_modules__": {"learner_connector": {"connector_pipeline_timer": 0.08012306208023802, "timers": {"connectors": {"numpy_to_tensor": 7.529344176873565e-05, "add_one_ts_to_episodes_and_truncate": 0.007615970048354939, "add_time_dim_to_batch_and_zero_pad": 1.2330630561336875e-05, "batch_individual_items": 0.030957687078043816, "general_advantage_estimation": 0.006589714805595576, "add_columns_from_episodes_to_train_batch": 0.03391291424399242, "add_states_from_episodes_to_batch": 3.3352687023580076e-06, "add_observations_from_episodes_to_batch": 0.0008303780469577759}}}, "num_module_steps_trained": 6000, "num_trainable_parameters": 6003, "learner_connector_sum_episodes_length_in": 5000.0, "num_module_steps_trained_lifetime": 12000, "num_non_trainable_parameters": 0, "num_env_steps_trained": 31500, "num_env_steps_trained_lifetime": 63000, "learner_connector_sum_episodes_length_out": 5250.0, "num_env_steps_trained_lifetime_throughput": 2004122.7734232082, "num_module_steps_trained_throughput": 383217.57980325975, "num_module_steps_trained_lifetime_throughput": 382674.9482070039}}, "num_training_step_calls_per_iteration": 1, "evaluation": {"env_runners": {"module_episode_returns_mean": {"default_policy": 1.25}, "env_to_module_connector": {"timers": {"connectors": {"add_observations_from_episodes_to_batch": 2.836523825864235e-06, "numpy_to_tensor": 8.477950958274297e-06, "add_time_dim_to_batch_and_zero_pad": 2.3244358435875214e-06, "batch_individual_items": 6.23489472411484e-06, "add_states_from_episodes_to_batch": 1.603041315121606e-06}}, "connector_pipeline_timer": 4.2829316004830186e-05}, "module_to_env_connector": {"timers": {"connectors": {"get_actions": 3.621443108924801e-05, "un_batch_to_individual_items": 5.388486650051226e-06, "listify_data_for_vector_env": 1.1242444619260512e-05, "normalize_and_clip_actions": 9.477321821898368e-06, "tensor_to_numpy": 1.2899371798119152e-05, "remove_single_ts_time_rank_from_batch": 5.779766345745155e-07}}, "connector_pipeline_timer": 0.0001009831826555686}, "num_env_steps_sampled": 400, "num_agent_steps_sampled_lifetime": {"default_agent": 800}, "num_env_steps_sampled_lifetime": 10400, "num_module_steps_sampled": {"default_policy": 400}, "episode_len_max": 20, "episode_duration_sec_mean": 0.004486073946463875, "env_reset_timer": 0.00013857164536602794, "episode_return_max": 14.5, "agent_episode_returns_mean": {"default_agent": 1.25}, "num_episodes_lifetime": 40, "env_to_module_sum_episodes_length_in": 10.366003441359926, "episode_len_min": 20, "rlmodule_inference_timer": 2.747496094615324e-05, "episode_return_mean": 1.25, "env_step_timer": 1.4242352383247006e-05, "env_to_module_sum_episodes_length_out": 10.366003441359926, "num_episodes": 20, "num_agent_steps_sampled": {"default_agent": 400}, "episode_return_min": -14.5, "episode_len_mean": 20.0, "weights_seq_no": 2.0, "num_module_steps_sampled_lifetime": {"default_policy": 800}, "sample": 0.09849861854687333, "time_between_sampling": 1.586630791076459}, "num_healthy_workers": 1, "actor_manager_num_outstanding_async_reqs": 0, "num_remote_worker_restarts": 0}, "num_env_steps_sampled_lifetime": 10000.0, "fault_tolerance": {"num_healthy_workers": 0, "num_remote_worker_restarts": 0}, "env_runner_group": {"actor_manager_num_outstanding_async_reqs": 0}, "done": false, "training_iteration": 2, "trial_id": "4666f_00000", "date": "2025-08-11_19-23-43", "timestamp": 1754933023, "time_this_iter_s": 1.6526210308074951, "time_total_s": 3.316315174102783, "pid": 14463, "hostname": "Mac", "node_ip": "127.0.0.1", "config": {"exploration_config": {}, "extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "placement_strategy": "PACK", "num_gpus": 0, "_fake_gpus": false, "num_cpus_for_main_process": 2, "eager_tracing": true, "eager_max_retraces": 20, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "torch_compile_learner": false, "torch_compile_learner_what_to_compile": "forward_train", "torch_compile_learner_dynamo_backend": "aot_eager", "torch_compile_learner_dynamo_mode": null, "torch_compile_worker": false, "torch_compile_worker_dynamo_backend": "aot_eager", "torch_compile_worker_dynamo_mode": null, "torch_ddp_kwargs": {}, "torch_skip_nan_gradients": false, "env": "Umbrella", "env_config": {}, "observation_space": null, "action_space": null, "clip_rewards": null, "normalize_actions": true, "clip_actions": false, "_is_atari": null, "disable_env_checking": false, "render_env": false, "action_mask_key": "action_mask", "env_runner_cls": null, "num_env_runners": 0, "create_local_env_runner": true, "num_envs_per_env_runner": 1, "gym_env_vectorize_mode": "SYNC", "num_cpus_per_env_runner": 1, "num_gpus_per_env_runner": 0, "custom_resources_per_env_runner": {}, "validate_env_runners_after_construction": true, "episodes_to_numpy": true, "max_requests_in_flight_per_env_runner": 1, "sample_timeout_s": 60.0, "_env_to_module_connector": null, "add_default_connectors_to_env_to_module_pipeline": true, "_module_to_env_connector": null, "add_default_connectors_to_module_to_env_pipeline": true, "merge_env_runner_states": "training_only", "broadcast_env_runner_states": true, "episode_lookback_horizon": 1, "rollout_fragment_length": "auto", "batch_mode": "complete_episodes", "compress_observations": false, "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "enable_tf1_exec_eagerly": false, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "preprocessor_pref": "deepmind", "observation_filter": "NoFilter", "update_worker_filter_stats": true, "use_worker_filter_stats": true, "sampler_perf_stats_ema_coef": null, "_is_online": true, "num_learners": 0, "num_gpus_per_learner": 0, "num_cpus_per_learner": "auto", "num_aggregator_actors_per_learner": 0, "max_requests_in_flight_per_aggregator_actor": 3, "local_gpu_idx": 0, "max_requests_in_flight_per_learner": 3, "gamma": 1, "lr": 0.0002847858517, "grad_clip": 0.5, "grad_clip_by": "global_norm", "_train_batch_size_per_learner": 5000, "train_batch_size": 4000, "num_epochs": 1, "minibatch_size": 1000, "shuffle_batch_per_epoch": true, "model": {"fcnet_hiddens": [256, 256], "fcnet_activation": "tanh", "fcnet_weights_initializer": null, "fcnet_weights_initializer_config": null, "fcnet_bias_initializer": null, "fcnet_bias_initializer_config": null, "conv_filters": null, "conv_activation": "relu", "conv_kernel_initializer": null, "conv_kernel_initializer_config": null, "conv_bias_initializer": null, "conv_bias_initializer_config": null, "conv_transpose_kernel_initializer": null, "conv_transpose_kernel_initializer_config": null, "conv_transpose_bias_initializer": null, "conv_transpose_bias_initializer_config": null, "post_fcnet_hiddens": [], "post_fcnet_activation": "relu", "post_fcnet_weights_initializer": null, "post_fcnet_weights_initializer_config": null, "post_fcnet_bias_initializer": null, "post_fcnet_bias_initializer_config": null, "free_log_std": false, "log_std_clip_param": 20.0, "no_final_linear": false, "vf_share_layers": false, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "lstm_weights_initializer": null, "lstm_weights_initializer_config": null, "lstm_bias_initializer": null, "lstm_bias_initializer_config": null, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "attention_use_n_prev_actions": 0, "attention_use_n_prev_rewards": 0, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": null, "custom_model_config": {}, "custom_action_dist": null, "custom_preprocessor": null, "encoder_latent_dim": null, "always_check_shapes": false, "lstm_use_prev_action_reward": -1, "_use_default_native_models": -1, "_disable_preprocessor_api": false, "_disable_action_flattening": false}, "_learner_connector": null, "add_default_connectors_to_learner_pipeline": true, "learner_config_dict": {}, "optimizer": {}, "_learner_class": null, "callbacks_on_algorithm_init": null, "callbacks_on_env_runners_recreated": null, "callbacks_on_offline_eval_runners_recreated": null, "callbacks_on_checkpoint_loaded": null, "callbacks_on_environment_created": null, "callbacks_on_episode_created": null, "callbacks_on_episode_start": null, "callbacks_on_episode_step": null, "callbacks_on_episode_end": null, "callbacks_on_evaluate_start": null, "callbacks_on_evaluate_end": null, "callbacks_on_evaluate_offline_start": null, "callbacks_on_evaluate_offline_end": null, "callbacks_on_sample_end": null, "callbacks_on_train_result": null, "explore": true, "enable_rl_module_and_learner": true, "enable_env_runner_and_connector_v2": true, "_prior_exploration_config": {"type": "StochasticSampling"}, "count_steps_by": "env_steps", "policy_map_capacity": 100, "policy_mapping_fn": "<function AlgorithmConfig.DEFAULT_POLICY_MAPPING_FN at 0x1551edb20>", "policies_to_train": null, "policy_states_are_swappable": false, "observation_fn": null, "offline_data_class": null, "input_read_method": "read_parquet", "input_read_method_kwargs": {}, "input_read_schema": {}, "input_read_episodes": false, "input_read_sample_batches": false, "input_read_batch_size": null, "input_filesystem": null, "input_filesystem_kwargs": {}, "input_compress_columns": ["obs", "new_obs"], "input_spaces_jsonable": true, "materialize_data": false, "materialize_mapped_data": true, "map_batches_kwargs": {}, "iter_batches_kwargs": {}, "ignore_final_observation": false, "prelearner_class": null, "prelearner_buffer_class": null, "prelearner_buffer_kwargs": {}, "prelearner_module_synch_period": 10, "dataset_num_iters_per_learner": null, "input_config": {}, "actions_in_input_normalized": false, "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_config": {}, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "output_max_rows_per_file": null, "output_write_remaining_data": false, "output_write_method": "write_parquet", "output_write_method_kwargs": {}, "output_filesystem": null, "output_filesystem_kwargs": {}, "output_write_episodes": true, "offline_sampling": false, "evaluation_interval": 1, "evaluation_duration": 20, "evaluation_duration_unit": "episodes", "evaluation_sample_timeout_s": 120.0, "evaluation_auto_duration_min_env_steps_per_sample": 100, "evaluation_auto_duration_max_env_steps_per_sample": 2000, "evaluation_parallel_to_training": false, "evaluation_force_reset_envs_before_iteration": true, "evaluation_config": null, "off_policy_estimation_methods": {}, "ope_split_batch_by_episode": true, "evaluation_num_env_runners": 1, "in_evaluation": false, "sync_filters_on_rollout_workers_timeout_s": 10.0, "offline_evaluation_interval": null, "num_offline_eval_runners": 0, "offline_loss_for_module_fn": null, "offline_evaluation_duration": 1, "offline_evaluation_parallel_to_training": false, "offline_evaluation_timeout_s": 120.0, "num_cpus_per_offline_eval_runner": 1, "num_gpus_per_offline_eval_runner": 0, "custom_resources_per_offline_eval_runner": {}, "restart_failed_offline_eval_runners": true, "ignore_offline_eval_runner_failures": false, "max_num_offline_eval_runner_restarts": 1000, "offline_eval_runner_restore_timeout_s": 1800.0, "max_requests_in_flight_per_offline_eval_runner": 1, "validate_offline_eval_runners_after_construction": true, "offline_eval_runner_health_probe_timeout_s": 30.0, "offline_eval_rl_module_inference_only": false, "broadcast_offline_eval_runner_states": false, "offline_eval_batch_size_per_runner": 256, "dataset_num_iters_per_eval_runner": 1, "keep_per_episode_custom_metrics": false, "metrics_episode_collection_timeout_s": 60.0, "metrics_num_episodes_for_smoothing": 100, "min_time_s_per_iteration": null, "min_train_timesteps_per_iteration": 0, "min_sample_timesteps_per_iteration": 0, "log_gradients": true, "export_native_model_files": false, "checkpoint_trainable_policies_only": false, "logger_creator": null, "logger_config": null, "log_level": "WARN", "log_sys_usage": true, "fake_sampler": false, "seed": 8, "restart_failed_env_runners": true, "ignore_env_runner_failures": false, "max_num_env_runner_restarts": 1000, "delay_between_env_runner_restarts_s": 60.0, "restart_failed_sub_environments": false, "num_consecutive_env_runner_failures_tolerance": 100, "env_runner_health_probe_timeout_s": 30.0, "env_runner_restore_timeout_s": 1800.0, "_model_config": {}, "_rl_module_spec": "RLModuleSpec(module_class=None, observation_space=None, action_space=None, inference_only=False, learner_only=False, model_config=DefaultModelConfig(fcnet_hiddens=[60, 90], fcnet_activation='tanh', fcnet_kernel_initializer=None, fcnet_kernel_initializer_kwargs=None, fcnet_bias_initializer=None, fcnet_bias_initializer_kwargs=None, conv_filters=None, conv_activation='relu', conv_kernel_initializer=None, conv_kernel_initializer_kwargs=None, conv_bias_initializer=None, conv_bias_initializer_kwargs=None, head_fcnet_hiddens=[], head_fcnet_activation='relu', head_fcnet_kernel_initializer=None, head_fcnet_kernel_initializer_kwargs=None, head_fcnet_bias_initializer=None, head_fcnet_bias_initializer_kwargs=None, free_log_std=False, log_std_clip_param=20.0, vf_share_layers=True, use_lstm=False, max_seq_len=20, lstm_cell_size=256, lstm_use_prev_action=False, lstm_use_prev_reward=False, lstm_kernel_initializer=None, lstm_kernel_initializer_kwargs=None, lstm_bias_initializer=None, lstm_bias_initializer_kwargs=None), catalog_class=None, load_state_path=None, model_config_dict=None)", "algorithm_config_overrides_per_module": {}, "_per_module_overrides": {}, "_validate_config": true, "_use_msgpack_checkpoints": false, "_torch_grad_scaler_class": null, "_torch_lr_scheduler_classes": null, "_tf_policy_handles_more_than_one_loss": false, "_disable_preprocessor_api": false, "_disable_action_flattening": false, "_disable_initialize_loss_from_dummy_batch": false, "_dont_auto_sync_env_runner_states": false, "env_task_fn": -1, "enable_connectors": -1, "simple_optimizer": false, "policy_map_cache": -1, "worker_cls": -1, "synchronize_filters": -1, "enable_async_evaluation": -1, "custom_async_evaluation_function": -1, "_enable_rl_module_api": -1, "auto_wrap_old_gym_envs": -1, "always_attach_evaluation_results": -1, "replay_sequence_length": null, "_disable_execution_plan_api": -1, "use_critic": true, "use_gae": true, "use_kl_loss": true, "kl_coeff": 0.7464963036515, "kl_target": 0.0270990929592, "vf_loss_coeff": 0.6688075857018, "entropy_coeff": 0.0090570820258, "clip_param": 0.1221781641624, "vf_clip_param": 0.1027808522125, "entropy_coeff_schedule": null, "lr_schedule": null, "sgd_minibatch_size": -1, "vf_share_layers": -1, "__stdout_file__": null, "__stderr_file__": null, "lambda": 0.9099046732075, "input": "sampler", "policies": {"default_policy": [null, null, null, null]}, "callbacks": "<class 'ray.rllib.callbacks.callbacks.RLlibCallback'>", "create_env_on_driver": false, "custom_eval_function": null, "framework": "torch"}, "time_since_restore": 3.316315174102783, "iterations_since_restore": 2, "perf": {"cpu_util_percent": 39.15, "ram_util_percent": 77.05}}
{"timers": {"training_iteration": 1.5565336177369347, "restore_env_runners": 1.1402980447746813e-05, "training_step": 1.5564143214946262, "env_runner_sampling_timer": 1.4481549904008046, "learner_update_timer": 0.10535048164419132, "synch_weights": 0.0005496124206110835, "restore_eval_env_runners": 8.295360021293164e-06, "evaluation_iteration": 0.10464678252697922, "synch_eval_env_connectors": 0.00014235057053156198, "synch_env_connectors": 4.790136590600014e-06}, "env_runners": {"module_to_env_connector": {"timers": {"connectors": {"remove_single_ts_time_rank_from_batch": 5.705959904665244e-07, "un_batch_to_individual_items": 5.412848992523626e-06, "normalize_and_clip_actions": 9.428249137417285e-06, "get_actions": 3.845860047730122e-05, "listify_data_for_vector_env": 1.1067719662610088e-05, "tensor_to_numpy": 1.3076007196801694e-05}}, "connector_pipeline_timer": 0.00010369603408453293}, "episode_duration_sec_mean": 0.004537352833431214, "env_to_module_connector": {"timers": {"connectors": {"add_time_dim_to_batch_and_zero_pad": 2.3456940523646878e-06, "numpy_to_tensor": 8.458751517452213e-06, "batch_individual_items": 6.1497070080015185e-06, "add_observations_from_episodes_to_batch": 2.9884123535880906e-06, "add_states_from_episodes_to_batch": 1.7428857211296503e-06}}, "connector_pipeline_timer": 4.335532001277107e-05}, "env_reset_timer": 3.390520671902466e-05, "episode_return_min": -11.5, "episode_return_max": 8.5, "rlmodule_inference_timer": 2.7988219355291052e-05, "time_between_sampling": 0.0018224698783209225, "num_module_steps_sampled": {"default_policy": 5000.0}, "num_module_steps_sampled_lifetime": {"default_policy": -607500.0}, "episode_len_mean": 20.0, "episode_return_mean": 0.3400000000000001, "num_env_steps_sampled": 5000.0, "num_agent_steps_sampled": {"default_agent": 5000.0}, "module_episode_returns_mean": {"default_policy": 0.3400000000000001}, "weights_seq_no": 2.0, "num_env_steps_sampled_lifetime": -607500.0, "env_step_timer": 1.3790611465075598e-05, "num_episodes_lifetime": -30375.0, "env_to_module_sum_episodes_length_out": 10.36823839457432, "num_episodes": 250.0, "sample": 0.004877057382182861, "agent_episode_returns_mean": {"default_agent": 0.3400000000000001}, "env_to_module_sum_episodes_length_in": 10.36823839457432, "episode_len_max": 20, "episode_len_min": 20, "num_agent_steps_sampled_lifetime": {"default_agent": -607500.0}, "num_env_steps_sampled_lifetime_throughput": 3732.572393055229}, "learners": {"default_policy": {"curr_entropy_coeff": 0.0090570820258, "weights_seq_no": 3.0, "gradients_default_optimizer_global_norm": 0.11024872958660126, "entropy": 0.6902889013290405, "num_module_steps_trained": 6000, "num_trainable_parameters": 6003, "policy_loss": 0.0031105533707886934, "mean_kl_loss": 7.996203930815682e-05, "vf_loss": 0.10278083384037018, "module_train_batch_size_mean": 1000.0, "vf_explained_var": 0.001783132553100586, "diff_num_grad_updates_vs_sampler_policy": 1.0, "default_optimizer_learning_rate": 0.0002847858517, "num_module_steps_trained_lifetime": 18000, "vf_loss_unclipped": 28.398405075073242, "total_loss": 0.06561407446861267, "curr_kl_coeff": 0.09331203997135162, "num_module_steps_trained_lifetime_throughput": 385612.38018917275}, "__all_modules__": {"learner_connector": {"connector_pipeline_timer": 0.08011541687932332, "timers": {"connectors": {"numpy_to_tensor": 7.519384759943932e-05, "add_one_ts_to_episodes_and_truncate": 0.007618590757984202, "add_time_dim_to_batch_and_zero_pad": 1.2322323967237024e-05, "batch_individual_items": 0.030948543958226216, "general_advantage_estimation": 0.006576205998240038, "add_columns_from_episodes_to_train_batch": 0.033924837602325716, "add_states_from_episodes_to_batch": 3.329415642656386e-06, "add_observations_from_episodes_to_batch": 0.000831148436863441}}}, "num_module_steps_trained": 6000, "num_trainable_parameters": 6003, "learner_connector_sum_episodes_length_in": 5000.0, "num_module_steps_trained_lifetime": 18000, "num_non_trainable_parameters": 0, "num_env_steps_trained": 31500, "num_env_steps_trained_lifetime": 94500, "learner_connector_sum_episodes_length_out": 5250.0, "num_env_steps_trained_lifetime_throughput": 2012427.448115442, "num_module_steps_trained_throughput": 384771.91014283267, "num_module_steps_trained_lifetime_throughput": 384236.96342457173}}, "num_training_step_calls_per_iteration": 1, "evaluation": {"env_runners": {"module_episode_returns_mean": {"default_policy": 1.4166666666666667}, "env_to_module_connector": {"timers": {"connectors": {"add_observations_from_episodes_to_batch": 2.7984974768049538e-06, "numpy_to_tensor": 8.300951113687686e-06, "add_time_dim_to_batch_and_zero_pad": 2.365479606526158e-06, "batch_individual_items": 6.145700405871882e-06, "add_states_from_episodes_to_batch": 1.667396792354512e-06}}, "connector_pipeline_timer": 4.2749921834461724e-05}, "module_to_env_connector": {"timers": {"connectors": {"get_actions": 3.528095795419399e-05, "un_batch_to_individual_items": 5.364137084735057e-06, "listify_data_for_vector_env": 1.1028492476528948e-05, "normalize_and_clip_actions": 9.39400787899155e-06, "tensor_to_numpy": 1.2845237255927507e-05, "remove_single_ts_time_rank_from_batch": 5.828917458247566e-07}}, "connector_pipeline_timer": 0.00010011810708159071}, "num_env_steps_sampled": 400, "num_agent_steps_sampled_lifetime": {"default_agent": 1200}, "num_env_steps_sampled_lifetime": 15400, "num_module_steps_sampled": {"default_policy": 400}, "episode_len_max": 20, "episode_duration_sec_mean": 0.0044748986101088425, "env_reset_timer": 0.000137950928916689, "episode_return_max": 14.5, "agent_episode_returns_mean": {"default_agent": 1.4166666666666667}, "num_episodes_lifetime": 60, "env_to_module_sum_episodes_length_in": 10.368205581254823, "episode_len_min": 20, "rlmodule_inference_timer": 2.7218781085628955e-05, "episode_return_mean": 1.4166666666666667, "env_step_timer": 1.3938478658301423e-05, "env_to_module_sum_episodes_length_out": 10.368205581254823, "num_episodes": 20, "num_agent_steps_sampled": {"default_agent": 400}, "episode_return_min": -14.5, "episode_len_mean": 20.0, "weights_seq_no": 3.0, "num_module_steps_sampled_lifetime": {"default_policy": 1200}, "sample": 0.09848581153117121, "time_between_sampling": 1.5857205552549567}, "num_healthy_workers": 1, "actor_manager_num_outstanding_async_reqs": 0, "num_remote_worker_restarts": 0}, "num_env_steps_sampled_lifetime": -607500.0, "fault_tolerance": {"num_healthy_workers": 0, "num_remote_worker_restarts": 0}, "env_runner_group": {"actor_manager_num_outstanding_async_reqs": 0}, "done": false, "training_iteration": 3, "trial_id": "4666f_00000", "date": "2025-08-11_19-23-44", "timestamp": 1754933024, "time_this_iter_s": 1.5816140174865723, "time_total_s": 4.8979291915893555, "pid": 14463, "hostname": "Mac", "node_ip": "127.0.0.1", "config": {"exploration_config": {}, "extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "placement_strategy": "PACK", "num_gpus": 0, "_fake_gpus": false, "num_cpus_for_main_process": 2, "eager_tracing": true, "eager_max_retraces": 20, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "torch_compile_learner": false, "torch_compile_learner_what_to_compile": "forward_train", "torch_compile_learner_dynamo_backend": "aot_eager", "torch_compile_learner_dynamo_mode": null, "torch_compile_worker": false, "torch_compile_worker_dynamo_backend": "aot_eager", "torch_compile_worker_dynamo_mode": null, "torch_ddp_kwargs": {}, "torch_skip_nan_gradients": false, "env": "Umbrella", "env_config": {}, "observation_space": null, "action_space": null, "clip_rewards": null, "normalize_actions": true, "clip_actions": false, "_is_atari": null, "disable_env_checking": false, "render_env": false, "action_mask_key": "action_mask", "env_runner_cls": null, "num_env_runners": 0, "create_local_env_runner": true, "num_envs_per_env_runner": 1, "gym_env_vectorize_mode": "SYNC", "num_cpus_per_env_runner": 1, "num_gpus_per_env_runner": 0, "custom_resources_per_env_runner": {}, "validate_env_runners_after_construction": true, "episodes_to_numpy": true, "max_requests_in_flight_per_env_runner": 1, "sample_timeout_s": 60.0, "_env_to_module_connector": null, "add_default_connectors_to_env_to_module_pipeline": true, "_module_to_env_connector": null, "add_default_connectors_to_module_to_env_pipeline": true, "merge_env_runner_states": "training_only", "broadcast_env_runner_states": true, "episode_lookback_horizon": 1, "rollout_fragment_length": "auto", "batch_mode": "complete_episodes", "compress_observations": false, "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "enable_tf1_exec_eagerly": false, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "preprocessor_pref": "deepmind", "observation_filter": "NoFilter", "update_worker_filter_stats": true, "use_worker_filter_stats": true, "sampler_perf_stats_ema_coef": null, "_is_online": true, "num_learners": 0, "num_gpus_per_learner": 0, "num_cpus_per_learner": "auto", "num_aggregator_actors_per_learner": 0, "max_requests_in_flight_per_aggregator_actor": 3, "local_gpu_idx": 0, "max_requests_in_flight_per_learner": 3, "gamma": 1, "lr": 0.0002847858517, "grad_clip": 0.5, "grad_clip_by": "global_norm", "_train_batch_size_per_learner": 5000, "train_batch_size": 4000, "num_epochs": 1, "minibatch_size": 1000, "shuffle_batch_per_epoch": true, "model": {"fcnet_hiddens": [256, 256], "fcnet_activation": "tanh", "fcnet_weights_initializer": null, "fcnet_weights_initializer_config": null, "fcnet_bias_initializer": null, "fcnet_bias_initializer_config": null, "conv_filters": null, "conv_activation": "relu", "conv_kernel_initializer": null, "conv_kernel_initializer_config": null, "conv_bias_initializer": null, "conv_bias_initializer_config": null, "conv_transpose_kernel_initializer": null, "conv_transpose_kernel_initializer_config": null, "conv_transpose_bias_initializer": null, "conv_transpose_bias_initializer_config": null, "post_fcnet_hiddens": [], "post_fcnet_activation": "relu", "post_fcnet_weights_initializer": null, "post_fcnet_weights_initializer_config": null, "post_fcnet_bias_initializer": null, "post_fcnet_bias_initializer_config": null, "free_log_std": false, "log_std_clip_param": 20.0, "no_final_linear": false, "vf_share_layers": false, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "lstm_weights_initializer": null, "lstm_weights_initializer_config": null, "lstm_bias_initializer": null, "lstm_bias_initializer_config": null, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "attention_use_n_prev_actions": 0, "attention_use_n_prev_rewards": 0, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": null, "custom_model_config": {}, "custom_action_dist": null, "custom_preprocessor": null, "encoder_latent_dim": null, "always_check_shapes": false, "lstm_use_prev_action_reward": -1, "_use_default_native_models": -1, "_disable_preprocessor_api": false, "_disable_action_flattening": false}, "_learner_connector": null, "add_default_connectors_to_learner_pipeline": true, "learner_config_dict": {}, "optimizer": {}, "_learner_class": null, "callbacks_on_algorithm_init": null, "callbacks_on_env_runners_recreated": null, "callbacks_on_offline_eval_runners_recreated": null, "callbacks_on_checkpoint_loaded": null, "callbacks_on_environment_created": null, "callbacks_on_episode_created": null, "callbacks_on_episode_start": null, "callbacks_on_episode_step": null, "callbacks_on_episode_end": null, "callbacks_on_evaluate_start": null, "callbacks_on_evaluate_end": null, "callbacks_on_evaluate_offline_start": null, "callbacks_on_evaluate_offline_end": null, "callbacks_on_sample_end": null, "callbacks_on_train_result": null, "explore": true, "enable_rl_module_and_learner": true, "enable_env_runner_and_connector_v2": true, "_prior_exploration_config": {"type": "StochasticSampling"}, "count_steps_by": "env_steps", "policy_map_capacity": 100, "policy_mapping_fn": "<function AlgorithmConfig.DEFAULT_POLICY_MAPPING_FN at 0x1551edb20>", "policies_to_train": null, "policy_states_are_swappable": false, "observation_fn": null, "offline_data_class": null, "input_read_method": "read_parquet", "input_read_method_kwargs": {}, "input_read_schema": {}, "input_read_episodes": false, "input_read_sample_batches": false, "input_read_batch_size": null, "input_filesystem": null, "input_filesystem_kwargs": {}, "input_compress_columns": ["obs", "new_obs"], "input_spaces_jsonable": true, "materialize_data": false, "materialize_mapped_data": true, "map_batches_kwargs": {}, "iter_batches_kwargs": {}, "ignore_final_observation": false, "prelearner_class": null, "prelearner_buffer_class": null, "prelearner_buffer_kwargs": {}, "prelearner_module_synch_period": 10, "dataset_num_iters_per_learner": null, "input_config": {}, "actions_in_input_normalized": false, "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_config": {}, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "output_max_rows_per_file": null, "output_write_remaining_data": false, "output_write_method": "write_parquet", "output_write_method_kwargs": {}, "output_filesystem": null, "output_filesystem_kwargs": {}, "output_write_episodes": true, "offline_sampling": false, "evaluation_interval": 1, "evaluation_duration": 20, "evaluation_duration_unit": "episodes", "evaluation_sample_timeout_s": 120.0, "evaluation_auto_duration_min_env_steps_per_sample": 100, "evaluation_auto_duration_max_env_steps_per_sample": 2000, "evaluation_parallel_to_training": false, "evaluation_force_reset_envs_before_iteration": true, "evaluation_config": null, "off_policy_estimation_methods": {}, "ope_split_batch_by_episode": true, "evaluation_num_env_runners": 1, "in_evaluation": false, "sync_filters_on_rollout_workers_timeout_s": 10.0, "offline_evaluation_interval": null, "num_offline_eval_runners": 0, "offline_loss_for_module_fn": null, "offline_evaluation_duration": 1, "offline_evaluation_parallel_to_training": false, "offline_evaluation_timeout_s": 120.0, "num_cpus_per_offline_eval_runner": 1, "num_gpus_per_offline_eval_runner": 0, "custom_resources_per_offline_eval_runner": {}, "restart_failed_offline_eval_runners": true, "ignore_offline_eval_runner_failures": false, "max_num_offline_eval_runner_restarts": 1000, "offline_eval_runner_restore_timeout_s": 1800.0, "max_requests_in_flight_per_offline_eval_runner": 1, "validate_offline_eval_runners_after_construction": true, "offline_eval_runner_health_probe_timeout_s": 30.0, "offline_eval_rl_module_inference_only": false, "broadcast_offline_eval_runner_states": false, "offline_eval_batch_size_per_runner": 256, "dataset_num_iters_per_eval_runner": 1, "keep_per_episode_custom_metrics": false, "metrics_episode_collection_timeout_s": 60.0, "metrics_num_episodes_for_smoothing": 100, "min_time_s_per_iteration": null, "min_train_timesteps_per_iteration": 0, "min_sample_timesteps_per_iteration": 0, "log_gradients": true, "export_native_model_files": false, "checkpoint_trainable_policies_only": false, "logger_creator": null, "logger_config": null, "log_level": "WARN", "log_sys_usage": true, "fake_sampler": false, "seed": 8, "restart_failed_env_runners": true, "ignore_env_runner_failures": false, "max_num_env_runner_restarts": 1000, "delay_between_env_runner_restarts_s": 60.0, "restart_failed_sub_environments": false, "num_consecutive_env_runner_failures_tolerance": 100, "env_runner_health_probe_timeout_s": 30.0, "env_runner_restore_timeout_s": 1800.0, "_model_config": {}, "_rl_module_spec": "RLModuleSpec(module_class=None, observation_space=None, action_space=None, inference_only=False, learner_only=False, model_config=DefaultModelConfig(fcnet_hiddens=[60, 90], fcnet_activation='tanh', fcnet_kernel_initializer=None, fcnet_kernel_initializer_kwargs=None, fcnet_bias_initializer=None, fcnet_bias_initializer_kwargs=None, conv_filters=None, conv_activation='relu', conv_kernel_initializer=None, conv_kernel_initializer_kwargs=None, conv_bias_initializer=None, conv_bias_initializer_kwargs=None, head_fcnet_hiddens=[], head_fcnet_activation='relu', head_fcnet_kernel_initializer=None, head_fcnet_kernel_initializer_kwargs=None, head_fcnet_bias_initializer=None, head_fcnet_bias_initializer_kwargs=None, free_log_std=False, log_std_clip_param=20.0, vf_share_layers=True, use_lstm=False, max_seq_len=20, lstm_cell_size=256, lstm_use_prev_action=False, lstm_use_prev_reward=False, lstm_kernel_initializer=None, lstm_kernel_initializer_kwargs=None, lstm_bias_initializer=None, lstm_bias_initializer_kwargs=None), catalog_class=None, load_state_path=None, model_config_dict=None)", "algorithm_config_overrides_per_module": {}, "_per_module_overrides": {}, "_validate_config": true, "_use_msgpack_checkpoints": false, "_torch_grad_scaler_class": null, "_torch_lr_scheduler_classes": null, "_tf_policy_handles_more_than_one_loss": false, "_disable_preprocessor_api": false, "_disable_action_flattening": false, "_disable_initialize_loss_from_dummy_batch": false, "_dont_auto_sync_env_runner_states": false, "env_task_fn": -1, "enable_connectors": -1, "simple_optimizer": false, "policy_map_cache": -1, "worker_cls": -1, "synchronize_filters": -1, "enable_async_evaluation": -1, "custom_async_evaluation_function": -1, "_enable_rl_module_api": -1, "auto_wrap_old_gym_envs": -1, "always_attach_evaluation_results": -1, "replay_sequence_length": null, "_disable_execution_plan_api": -1, "use_critic": true, "use_gae": true, "use_kl_loss": true, "kl_coeff": 0.7464963036515, "kl_target": 0.0270990929592, "vf_loss_coeff": 0.6688075857018, "entropy_coeff": 0.0090570820258, "clip_param": 0.1221781641624, "vf_clip_param": 0.1027808522125, "entropy_coeff_schedule": null, "lr_schedule": null, "sgd_minibatch_size": -1, "vf_share_layers": -1, "__stdout_file__": null, "__stderr_file__": null, "lambda": 0.9099046732075, "input": "sampler", "policies": {"default_policy": [null, null, null, null]}, "callbacks": "<class 'ray.rllib.callbacks.callbacks.RLlibCallback'>", "create_env_on_driver": false, "custom_eval_function": null, "framework": "torch"}, "time_since_restore": 4.8979291915893555, "iterations_since_restore": 3, "perf": {"cpu_util_percent": 41.333333333333336, "ram_util_percent": 77.43333333333332}}
{"timers": {"training_iteration": 1.5565545607292217, "restore_env_runners": 1.1350620495853945e-05, "training_step": 1.5564347366096907, "env_runner_sampling_timer": 1.4483040392462962, "learner_update_timer": 0.10521993098707254, "synch_weights": 0.0005496300461888314, "restore_eval_env_runners": 8.29115672968328e-06, "evaluation_iteration": 0.10462040261112851, "synch_eval_env_connectors": 0.00014194956504506992, "synch_env_connectors": 4.791405564174056e-06}, "env_runners": {"module_to_env_connector": {"timers": {"connectors": {"remove_single_ts_time_rank_from_batch": 5.799302407118938e-07, "un_batch_to_individual_items": 5.394933226883054e-06, "normalize_and_clip_actions": 9.43502586926935e-06, "get_actions": 3.8493755238486806e-05, "listify_data_for_vector_env": 1.0993732573829685e-05, "tensor_to_numpy": 1.3080209764135322e-05}}, "connector_pipeline_timer": 0.00010365593471581233}, "episode_duration_sec_mean": 0.004545413788408041, "env_to_module_connector": {"timers": {"connectors": {"add_time_dim_to_batch_and_zero_pad": 2.3437308527146987e-06, "numpy_to_tensor": 8.463129673121738e-06, "batch_individual_items": 6.169772587107556e-06, "add_observations_from_episodes_to_batch": 3.056015173007013e-06, "add_states_from_episodes_to_batch": 1.7335384027205667e-06}}, "connector_pipeline_timer": 4.341241755679384e-05}, "env_reset_timer": 3.353378931991212e-05, "episode_return_min": -11.5, "episode_return_max": 8.5, "rlmodule_inference_timer": 2.8012168999970247e-05, "time_between_sampling": 0.001785792263415862, "num_module_steps_sampled": {"default_policy": 5000.0}, "num_module_steps_sampled_lifetime": {"default_policy": -1225000.0}, "episode_len_mean": 20.0, "episode_return_mean": -0.3, "num_env_steps_sampled": 5000.0, "num_agent_steps_sampled": {"default_agent": 5000.0}, "module_episode_returns_mean": {"default_policy": -0.3}, "weights_seq_no": 3.0, "num_env_steps_sampled_lifetime": -1225000.0, "env_step_timer": 1.3815307418540706e-05, "num_episodes_lifetime": -61250.0, "env_to_module_sum_episodes_length_out": 10.36823839457432, "num_episodes": 250.0, "sample": 0.004823744281273754, "agent_episode_returns_mean": {"default_agent": -0.3}, "env_to_module_sum_episodes_length_in": 10.36823839457432, "episode_len_max": 20, "episode_len_min": 20, "num_agent_steps_sampled_lifetime": {"default_agent": -1225000.0}, "num_env_steps_sampled_lifetime_throughput": 3731.6016494297724}, "learners": {"default_policy": {"curr_entropy_coeff": 0.0090570820258, "weights_seq_no": 4.0, "gradients_default_optimizer_global_norm": 0.035478390753269196, "entropy": 0.6886228322982788, "num_module_steps_trained": 6000, "num_trainable_parameters": 6003, "policy_loss": 0.004799160175025463, "mean_kl_loss": 0.00018847151659429073, "vf_loss": 0.10278083384037018, "module_train_batch_size_mean": 1000.0, "vf_explained_var": 0.002683281898498535, "diff_num_grad_updates_vs_sampler_policy": 1.0, "default_optimizer_learning_rate": 0.0002847858517, "num_module_steps_trained_lifetime": 24000, "vf_loss_unclipped": 28.49736213684082, "total_loss": 0.06732043623924255, "curr_kl_coeff": 0.04665601998567581, "num_module_steps_trained_lifetime_throughput": 387125.63020919496}, "__all_modules__": {"learner_connector": {"connector_pipeline_timer": 0.08009766146030255, "timers": {"connectors": {"numpy_to_tensor": 7.504356911801733e-05, "add_one_ts_to_episodes_and_truncate": 0.007620290680946432, "add_time_dim_to_batch_and_zero_pad": 1.2317851340747437e-05, "batch_individual_items": 0.030935399359512606, "general_advantage_estimation": 0.0065644455985766825, "add_columns_from_episodes_to_train_batch": 0.033930744225824955, "add_states_from_episodes_to_batch": 3.336121790809557e-06, "add_observations_from_episodes_to_batch": 0.0008311102925579762}}}, "num_module_steps_trained": 6000, "num_trainable_parameters": 6003, "learner_connector_sum_episodes_length_in": 5000.0, "num_module_steps_trained_lifetime": 24000, "num_non_trainable_parameters": 0, "num_env_steps_trained": 31500, "num_env_steps_trained_lifetime": 126000, "learner_connector_sum_episodes_length_out": 5250.0, "num_env_steps_trained_lifetime_throughput": 2020795.3070975328, "num_module_steps_trained_throughput": 386330.34367561236, "num_module_steps_trained_lifetime_throughput": 385805.8168320075}}, "num_training_step_calls_per_iteration": 1, "evaluation": {"env_runners": {"module_episode_returns_mean": {"default_policy": 1.0}, "env_to_module_connector": {"timers": {"connectors": {"add_observations_from_episodes_to_batch": 2.7788809699171373e-06, "numpy_to_tensor": 8.332669548859866e-06, "add_time_dim_to_batch_and_zero_pad": 2.2962889085404065e-06, "batch_individual_items": 6.095939460874924e-06, "add_states_from_episodes_to_batch": 1.6181009163790798e-06}}, "connector_pipeline_timer": 4.24038823163205e-05}, "module_to_env_connector": {"timers": {"connectors": {"get_actions": 3.545506855898174e-05, "un_batch_to_individual_items": 5.334478197461874e-06, "listify_data_for_vector_env": 1.0978801950564892e-05, "normalize_and_clip_actions": 9.294340431839934e-06, "tensor_to_numpy": 1.2677237890384586e-05, "remove_single_ts_time_rank_from_batch": 5.707738380042692e-07}}, "connector_pipeline_timer": 9.926488522727868e-05}, "num_env_steps_sampled": 400, "num_agent_steps_sampled_lifetime": {"default_agent": 1600}, "num_env_steps_sampled_lifetime": 20400, "num_module_steps_sampled": {"default_policy": 400}, "episode_len_max": 20, "episode_duration_sec_mean": 0.004480393757694401, "env_reset_timer": 0.00013736267012276222, "episode_return_max": 14.5, "agent_episode_returns_mean": {"default_agent": 1.0}, "num_episodes_lifetime": 80, "env_to_module_sum_episodes_length_in": 10.368237912813044, "episode_len_min": 20, "rlmodule_inference_timer": 2.718071236087747e-05, "episode_return_mean": 1.0, "env_step_timer": 1.4033695037907042e-05, "env_to_module_sum_episodes_length_out": 10.368237912813044, "num_episodes": 20, "num_agent_steps_sampled": {"default_agent": 400}, "episode_return_min": -14.5, "episode_len_mean": 20.0, "weights_seq_no": 4.0, "num_module_steps_sampled_lifetime": {"default_policy": 1600}, "sample": 0.0984845584165156, "time_between_sampling": 1.5856103551226783}, "num_healthy_workers": 1, "actor_manager_num_outstanding_async_reqs": 0, "num_remote_worker_restarts": 0}, "num_env_steps_sampled_lifetime": -1225000.0, "fault_tolerance": {"num_healthy_workers": 0, "num_remote_worker_restarts": 0}, "env_runner_group": {"actor_manager_num_outstanding_async_reqs": 0}, "done": false, "training_iteration": 4, "trial_id": "4666f_00000", "date": "2025-08-11_19-23-46", "timestamp": 1754933026, "time_this_iter_s": 1.6637423038482666, "time_total_s": 6.561671495437622, "pid": 14463, "hostname": "Mac", "node_ip": "127.0.0.1", "config": {"exploration_config": {}, "extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "placement_strategy": "PACK", "num_gpus": 0, "_fake_gpus": false, "num_cpus_for_main_process": 2, "eager_tracing": true, "eager_max_retraces": 20, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "torch_compile_learner": false, "torch_compile_learner_what_to_compile": "forward_train", "torch_compile_learner_dynamo_backend": "aot_eager", "torch_compile_learner_dynamo_mode": null, "torch_compile_worker": false, "torch_compile_worker_dynamo_backend": "aot_eager", "torch_compile_worker_dynamo_mode": null, "torch_ddp_kwargs": {}, "torch_skip_nan_gradients": false, "env": "Umbrella", "env_config": {}, "observation_space": null, "action_space": null, "clip_rewards": null, "normalize_actions": true, "clip_actions": false, "_is_atari": null, "disable_env_checking": false, "render_env": false, "action_mask_key": "action_mask", "env_runner_cls": null, "num_env_runners": 0, "create_local_env_runner": true, "num_envs_per_env_runner": 1, "gym_env_vectorize_mode": "SYNC", "num_cpus_per_env_runner": 1, "num_gpus_per_env_runner": 0, "custom_resources_per_env_runner": {}, "validate_env_runners_after_construction": true, "episodes_to_numpy": true, "max_requests_in_flight_per_env_runner": 1, "sample_timeout_s": 60.0, "_env_to_module_connector": null, "add_default_connectors_to_env_to_module_pipeline": true, "_module_to_env_connector": null, "add_default_connectors_to_module_to_env_pipeline": true, "merge_env_runner_states": "training_only", "broadcast_env_runner_states": true, "episode_lookback_horizon": 1, "rollout_fragment_length": "auto", "batch_mode": "complete_episodes", "compress_observations": false, "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "enable_tf1_exec_eagerly": false, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "preprocessor_pref": "deepmind", "observation_filter": "NoFilter", "update_worker_filter_stats": true, "use_worker_filter_stats": true, "sampler_perf_stats_ema_coef": null, "_is_online": true, "num_learners": 0, "num_gpus_per_learner": 0, "num_cpus_per_learner": "auto", "num_aggregator_actors_per_learner": 0, "max_requests_in_flight_per_aggregator_actor": 3, "local_gpu_idx": 0, "max_requests_in_flight_per_learner": 3, "gamma": 1, "lr": 0.0002847858517, "grad_clip": 0.5, "grad_clip_by": "global_norm", "_train_batch_size_per_learner": 5000, "train_batch_size": 4000, "num_epochs": 1, "minibatch_size": 1000, "shuffle_batch_per_epoch": true, "model": {"fcnet_hiddens": [256, 256], "fcnet_activation": "tanh", "fcnet_weights_initializer": null, "fcnet_weights_initializer_config": null, "fcnet_bias_initializer": null, "fcnet_bias_initializer_config": null, "conv_filters": null, "conv_activation": "relu", "conv_kernel_initializer": null, "conv_kernel_initializer_config": null, "conv_bias_initializer": null, "conv_bias_initializer_config": null, "conv_transpose_kernel_initializer": null, "conv_transpose_kernel_initializer_config": null, "conv_transpose_bias_initializer": null, "conv_transpose_bias_initializer_config": null, "post_fcnet_hiddens": [], "post_fcnet_activation": "relu", "post_fcnet_weights_initializer": null, "post_fcnet_weights_initializer_config": null, "post_fcnet_bias_initializer": null, "post_fcnet_bias_initializer_config": null, "free_log_std": false, "log_std_clip_param": 20.0, "no_final_linear": false, "vf_share_layers": false, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "lstm_weights_initializer": null, "lstm_weights_initializer_config": null, "lstm_bias_initializer": null, "lstm_bias_initializer_config": null, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "attention_use_n_prev_actions": 0, "attention_use_n_prev_rewards": 0, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": null, "custom_model_config": {}, "custom_action_dist": null, "custom_preprocessor": null, "encoder_latent_dim": null, "always_check_shapes": false, "lstm_use_prev_action_reward": -1, "_use_default_native_models": -1, "_disable_preprocessor_api": false, "_disable_action_flattening": false}, "_learner_connector": null, "add_default_connectors_to_learner_pipeline": true, "learner_config_dict": {}, "optimizer": {}, "_learner_class": null, "callbacks_on_algorithm_init": null, "callbacks_on_env_runners_recreated": null, "callbacks_on_offline_eval_runners_recreated": null, "callbacks_on_checkpoint_loaded": null, "callbacks_on_environment_created": null, "callbacks_on_episode_created": null, "callbacks_on_episode_start": null, "callbacks_on_episode_step": null, "callbacks_on_episode_end": null, "callbacks_on_evaluate_start": null, "callbacks_on_evaluate_end": null, "callbacks_on_evaluate_offline_start": null, "callbacks_on_evaluate_offline_end": null, "callbacks_on_sample_end": null, "callbacks_on_train_result": null, "explore": true, "enable_rl_module_and_learner": true, "enable_env_runner_and_connector_v2": true, "_prior_exploration_config": {"type": "StochasticSampling"}, "count_steps_by": "env_steps", "policy_map_capacity": 100, "policy_mapping_fn": "<function AlgorithmConfig.DEFAULT_POLICY_MAPPING_FN at 0x1551edb20>", "policies_to_train": null, "policy_states_are_swappable": false, "observation_fn": null, "offline_data_class": null, "input_read_method": "read_parquet", "input_read_method_kwargs": {}, "input_read_schema": {}, "input_read_episodes": false, "input_read_sample_batches": false, "input_read_batch_size": null, "input_filesystem": null, "input_filesystem_kwargs": {}, "input_compress_columns": ["obs", "new_obs"], "input_spaces_jsonable": true, "materialize_data": false, "materialize_mapped_data": true, "map_batches_kwargs": {}, "iter_batches_kwargs": {}, "ignore_final_observation": false, "prelearner_class": null, "prelearner_buffer_class": null, "prelearner_buffer_kwargs": {}, "prelearner_module_synch_period": 10, "dataset_num_iters_per_learner": null, "input_config": {}, "actions_in_input_normalized": false, "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_config": {}, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "output_max_rows_per_file": null, "output_write_remaining_data": false, "output_write_method": "write_parquet", "output_write_method_kwargs": {}, "output_filesystem": null, "output_filesystem_kwargs": {}, "output_write_episodes": true, "offline_sampling": false, "evaluation_interval": 1, "evaluation_duration": 20, "evaluation_duration_unit": "episodes", "evaluation_sample_timeout_s": 120.0, "evaluation_auto_duration_min_env_steps_per_sample": 100, "evaluation_auto_duration_max_env_steps_per_sample": 2000, "evaluation_parallel_to_training": false, "evaluation_force_reset_envs_before_iteration": true, "evaluation_config": null, "off_policy_estimation_methods": {}, "ope_split_batch_by_episode": true, "evaluation_num_env_runners": 1, "in_evaluation": false, "sync_filters_on_rollout_workers_timeout_s": 10.0, "offline_evaluation_interval": null, "num_offline_eval_runners": 0, "offline_loss_for_module_fn": null, "offline_evaluation_duration": 1, "offline_evaluation_parallel_to_training": false, "offline_evaluation_timeout_s": 120.0, "num_cpus_per_offline_eval_runner": 1, "num_gpus_per_offline_eval_runner": 0, "custom_resources_per_offline_eval_runner": {}, "restart_failed_offline_eval_runners": true, "ignore_offline_eval_runner_failures": false, "max_num_offline_eval_runner_restarts": 1000, "offline_eval_runner_restore_timeout_s": 1800.0, "max_requests_in_flight_per_offline_eval_runner": 1, "validate_offline_eval_runners_after_construction": true, "offline_eval_runner_health_probe_timeout_s": 30.0, "offline_eval_rl_module_inference_only": false, "broadcast_offline_eval_runner_states": false, "offline_eval_batch_size_per_runner": 256, "dataset_num_iters_per_eval_runner": 1, "keep_per_episode_custom_metrics": false, "metrics_episode_collection_timeout_s": 60.0, "metrics_num_episodes_for_smoothing": 100, "min_time_s_per_iteration": null, "min_train_timesteps_per_iteration": 0, "min_sample_timesteps_per_iteration": 0, "log_gradients": true, "export_native_model_files": false, "checkpoint_trainable_policies_only": false, "logger_creator": null, "logger_config": null, "log_level": "WARN", "log_sys_usage": true, "fake_sampler": false, "seed": 8, "restart_failed_env_runners": true, "ignore_env_runner_failures": false, "max_num_env_runner_restarts": 1000, "delay_between_env_runner_restarts_s": 60.0, "restart_failed_sub_environments": false, "num_consecutive_env_runner_failures_tolerance": 100, "env_runner_health_probe_timeout_s": 30.0, "env_runner_restore_timeout_s": 1800.0, "_model_config": {}, "_rl_module_spec": "RLModuleSpec(module_class=None, observation_space=None, action_space=None, inference_only=False, learner_only=False, model_config=DefaultModelConfig(fcnet_hiddens=[60, 90], fcnet_activation='tanh', fcnet_kernel_initializer=None, fcnet_kernel_initializer_kwargs=None, fcnet_bias_initializer=None, fcnet_bias_initializer_kwargs=None, conv_filters=None, conv_activation='relu', conv_kernel_initializer=None, conv_kernel_initializer_kwargs=None, conv_bias_initializer=None, conv_bias_initializer_kwargs=None, head_fcnet_hiddens=[], head_fcnet_activation='relu', head_fcnet_kernel_initializer=None, head_fcnet_kernel_initializer_kwargs=None, head_fcnet_bias_initializer=None, head_fcnet_bias_initializer_kwargs=None, free_log_std=False, log_std_clip_param=20.0, vf_share_layers=True, use_lstm=False, max_seq_len=20, lstm_cell_size=256, lstm_use_prev_action=False, lstm_use_prev_reward=False, lstm_kernel_initializer=None, lstm_kernel_initializer_kwargs=None, lstm_bias_initializer=None, lstm_bias_initializer_kwargs=None), catalog_class=None, load_state_path=None, model_config_dict=None)", "algorithm_config_overrides_per_module": {}, "_per_module_overrides": {}, "_validate_config": true, "_use_msgpack_checkpoints": false, "_torch_grad_scaler_class": null, "_torch_lr_scheduler_classes": null, "_tf_policy_handles_more_than_one_loss": false, "_disable_preprocessor_api": false, "_disable_action_flattening": false, "_disable_initialize_loss_from_dummy_batch": false, "_dont_auto_sync_env_runner_states": false, "env_task_fn": -1, "enable_connectors": -1, "simple_optimizer": false, "policy_map_cache": -1, "worker_cls": -1, "synchronize_filters": -1, "enable_async_evaluation": -1, "custom_async_evaluation_function": -1, "_enable_rl_module_api": -1, "auto_wrap_old_gym_envs": -1, "always_attach_evaluation_results": -1, "replay_sequence_length": null, "_disable_execution_plan_api": -1, "use_critic": true, "use_gae": true, "use_kl_loss": true, "kl_coeff": 0.7464963036515, "kl_target": 0.0270990929592, "vf_loss_coeff": 0.6688075857018, "entropy_coeff": 0.0090570820258, "clip_param": 0.1221781641624, "vf_clip_param": 0.1027808522125, "entropy_coeff_schedule": null, "lr_schedule": null, "sgd_minibatch_size": -1, "vf_share_layers": -1, "__stdout_file__": null, "__stderr_file__": null, "lambda": 0.9099046732075, "input": "sampler", "policies": {"default_policy": [null, null, null, null]}, "callbacks": "<class 'ray.rllib.callbacks.callbacks.RLlibCallback'>", "create_env_on_driver": false, "custom_eval_function": null, "framework": "torch"}, "time_since_restore": 6.561671495437622, "iterations_since_restore": 4, "perf": {"cpu_util_percent": 42.150000000000006, "ram_util_percent": 76.94999999999999}}
{"timers": {"training_iteration": 1.5565805330311266, "restore_env_runners": 1.1291274191068951e-05, "training_step": 1.5564600109136721, "env_runner_sampling_timer": 1.4484385509440367, "learner_update_timer": 0.10510476292741601, "synch_weights": 0.0005506774952046573, "restore_eval_env_runners": 8.325325215701016e-06, "evaluation_iteration": 0.10460444483488296, "synch_eval_env_connectors": 0.0001416229892416159, "synch_env_connectors": 4.80474110180512e-06}, "env_runners": {"module_to_env_connector": {"timers": {"connectors": {"remove_single_ts_time_rank_from_batch": 5.725520135224957e-07, "un_batch_to_individual_items": 5.342700373486019e-06, "normalize_and_clip_actions": 9.39886929071017e-06, "get_actions": 3.870215313689281e-05, "listify_data_for_vector_env": 1.096482262416567e-05, "tensor_to_numpy": 1.3104748536855726e-05}}, "connector_pipeline_timer": 0.0001037015625403829}, "episode_duration_sec_mean": 0.004878093652892859, "env_to_module_connector": {"timers": {"connectors": {"add_time_dim_to_batch_and_zero_pad": 2.3567902970834182e-06, "numpy_to_tensor": 8.446466194849987e-06, "batch_individual_items": 6.163253245058791e-06, "add_observations_from_episodes_to_batch": 2.9515007055727712e-06, "add_states_from_episodes_to_batch": 1.7434853187516782e-06}}, "connector_pipeline_timer": 4.3313694075360754e-05}, "env_reset_timer": 3.443273310164617e-05, "episode_return_min": -11.5, "episode_return_max": 8.5, "rlmodule_inference_timer": 4.587370849507683e-05, "time_between_sampling": 0.0015779736959806905, "num_module_steps_sampled": {"default_policy": 5000.0}, "num_module_steps_sampled_lifetime": {"default_policy": -1842500.0}, "episode_len_mean": 20.0, "episode_return_mean": -0.14000000000000007, "num_env_steps_sampled": 5000.0, "num_agent_steps_sampled": {"default_agent": 5000.0}, "module_episode_returns_mean": {"default_policy": -0.14000000000000007}, "weights_seq_no": 4.0, "num_env_steps_sampled_lifetime": -1842500.0, "env_step_timer": 1.3710260562946957e-05, "num_episodes_lifetime": -92125.0, "env_to_module_sum_episodes_length_out": 10.36823839457432, "num_episodes": 250.0, "sample": 0.004906557694297628, "agent_episode_returns_mean": {"default_agent": -0.14000000000000007}, "env_to_module_sum_episodes_length_in": 10.36823839457432, "episode_len_max": 20, "episode_len_min": 20, "num_agent_steps_sampled_lifetime": {"default_agent": -1842500.0}, "num_env_steps_sampled_lifetime_throughput": 3724.910407874071}, "learners": {"default_policy": {"curr_entropy_coeff": 0.0090570820258, "weights_seq_no": 5.0, "gradients_default_optimizer_global_norm": 0.09610242396593094, "entropy": 0.6842040419578552, "num_module_steps_trained": 6000, "num_trainable_parameters": 6003, "policy_loss": 0.03844098374247551, "mean_kl_loss": 0.0005214021657593548, "vf_loss": 0.10278083384037018, "module_train_batch_size_mean": 1000.0, "vf_explained_var": 0.003237903118133545, "diff_num_grad_updates_vs_sampler_policy": 1.0, "default_optimizer_learning_rate": 0.0002847858517, "num_module_steps_trained_lifetime": 30000, "vf_loss_unclipped": 28.689939498901367, "total_loss": 0.10100902616977692, "curr_kl_coeff": 0.023328009992837906, "num_module_steps_trained_lifetime_throughput": 388429.60416839813}, "__all_modules__": {"learner_connector": {"connector_pipeline_timer": 0.0800911277552364, "timers": {"connectors": {"numpy_to_tensor": 7.487980378457111e-05, "add_one_ts_to_episodes_and_truncate": 0.007621884853130139, "add_time_dim_to_batch_and_zero_pad": 1.2283422047934726e-05, "batch_individual_items": 0.030930952446634866, "general_advantage_estimation": 0.006555584892778522, "add_columns_from_episodes_to_train_batch": 0.033936315112763654, "add_states_from_episodes_to_batch": 3.328181022575591e-06, "add_observations_from_episodes_to_batch": 0.0008312204400185601}}}, "num_module_steps_trained": 6000, "num_trainable_parameters": 6003, "learner_connector_sum_episodes_length_in": 5000.0, "num_module_steps_trained_lifetime": 30000, "num_non_trainable_parameters": 0, "num_env_steps_trained": 31500, "num_env_steps_trained_lifetime": 157500, "learner_connector_sum_episodes_length_out": 5250.0, "num_env_steps_trained_lifetime_throughput": 2028123.7149350885, "num_module_steps_trained_throughput": 387685.7852050463, "num_module_steps_trained_lifetime_throughput": 387173.080500393}}, "num_training_step_calls_per_iteration": 1, "evaluation": {"env_runners": {"module_episode_returns_mean": {"default_policy": 1.15}, "env_to_module_connector": {"timers": {"connectors": {"add_observations_from_episodes_to_batch": 2.7974204843756653e-06, "numpy_to_tensor": 8.212780864300638e-06, "add_time_dim_to_batch_and_zero_pad": 2.325952633738064e-06, "batch_individual_items": 6.033431410098041e-06, "add_states_from_episodes_to_batch": 1.6337651029035614e-06}}, "connector_pipeline_timer": 4.211670513247208e-05}, "module_to_env_connector": {"timers": {"connectors": {"get_actions": 3.4773435852308035e-05, "un_batch_to_individual_items": 5.289172971460295e-06, "listify_data_for_vector_env": 1.1011095399340552e-05, "normalize_and_clip_actions": 9.341700962617246e-06, "tensor_to_numpy": 1.2599740013456704e-05, "remove_single_ts_time_rank_from_batch": 5.736776155265457e-07}}, "connector_pipeline_timer": 9.859630653310665e-05}, "num_env_steps_sampled": 400, "num_agent_steps_sampled_lifetime": {"default_agent": 2000}, "num_env_steps_sampled_lifetime": 25400, "num_module_steps_sampled": {"default_policy": 400}, "episode_len_max": 20, "episode_duration_sec_mean": 0.004475924603175372, "env_reset_timer": 0.00013687113279239624, "episode_return_max": 14.5, "agent_episode_returns_mean": {"default_agent": 1.15}, "num_episodes_lifetime": 100, "env_to_module_sum_episodes_length_in": 10.368238387501162, "episode_len_min": 20, "rlmodule_inference_timer": 2.6917761287305246e-05, "episode_return_mean": 1.15, "env_step_timer": 1.3828683030933944e-05, "env_to_module_sum_episodes_length_out": 10.368238387501162, "num_episodes": 20, "num_agent_steps_sampled": {"default_agent": 400}, "episode_return_min": -14.5, "episode_len_mean": 20.0, "weights_seq_no": 5.0, "num_module_steps_sampled_lifetime": {"default_policy": 2000}, "sample": 0.09847402783211709, "time_between_sampling": 1.5855175344916854}, "num_healthy_workers": 1, "actor_manager_num_outstanding_async_reqs": 0, "num_remote_worker_restarts": 0}, "num_env_steps_sampled_lifetime": -1842500.0, "fault_tolerance": {"num_healthy_workers": 0, "num_remote_worker_restarts": 0}, "env_runner_group": {"actor_manager_num_outstanding_async_reqs": 0}, "done": false, "training_iteration": 5, "trial_id": "4666f_00000", "date": "2025-08-11_19-23-48", "timestamp": 1754933028, "time_this_iter_s": 1.6638069152832031, "time_total_s": 8.225478410720825, "pid": 14463, "hostname": "Mac", "node_ip": "127.0.0.1", "config": {"exploration_config": {}, "extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "placement_strategy": "PACK", "num_gpus": 0, "_fake_gpus": false, "num_cpus_for_main_process": 2, "eager_tracing": true, "eager_max_retraces": 20, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "torch_compile_learner": false, "torch_compile_learner_what_to_compile": "forward_train", "torch_compile_learner_dynamo_backend": "aot_eager", "torch_compile_learner_dynamo_mode": null, "torch_compile_worker": false, "torch_compile_worker_dynamo_backend": "aot_eager", "torch_compile_worker_dynamo_mode": null, "torch_ddp_kwargs": {}, "torch_skip_nan_gradients": false, "env": "Umbrella", "env_config": {}, "observation_space": null, "action_space": null, "clip_rewards": null, "normalize_actions": true, "clip_actions": false, "_is_atari": null, "disable_env_checking": false, "render_env": false, "action_mask_key": "action_mask", "env_runner_cls": null, "num_env_runners": 0, "create_local_env_runner": true, "num_envs_per_env_runner": 1, "gym_env_vectorize_mode": "SYNC", "num_cpus_per_env_runner": 1, "num_gpus_per_env_runner": 0, "custom_resources_per_env_runner": {}, "validate_env_runners_after_construction": true, "episodes_to_numpy": true, "max_requests_in_flight_per_env_runner": 1, "sample_timeout_s": 60.0, "_env_to_module_connector": null, "add_default_connectors_to_env_to_module_pipeline": true, "_module_to_env_connector": null, "add_default_connectors_to_module_to_env_pipeline": true, "merge_env_runner_states": "training_only", "broadcast_env_runner_states": true, "episode_lookback_horizon": 1, "rollout_fragment_length": "auto", "batch_mode": "complete_episodes", "compress_observations": false, "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "enable_tf1_exec_eagerly": false, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "preprocessor_pref": "deepmind", "observation_filter": "NoFilter", "update_worker_filter_stats": true, "use_worker_filter_stats": true, "sampler_perf_stats_ema_coef": null, "_is_online": true, "num_learners": 0, "num_gpus_per_learner": 0, "num_cpus_per_learner": "auto", "num_aggregator_actors_per_learner": 0, "max_requests_in_flight_per_aggregator_actor": 3, "local_gpu_idx": 0, "max_requests_in_flight_per_learner": 3, "gamma": 1, "lr": 0.0002847858517, "grad_clip": 0.5, "grad_clip_by": "global_norm", "_train_batch_size_per_learner": 5000, "train_batch_size": 4000, "num_epochs": 1, "minibatch_size": 1000, "shuffle_batch_per_epoch": true, "model": {"fcnet_hiddens": [256, 256], "fcnet_activation": "tanh", "fcnet_weights_initializer": null, "fcnet_weights_initializer_config": null, "fcnet_bias_initializer": null, "fcnet_bias_initializer_config": null, "conv_filters": null, "conv_activation": "relu", "conv_kernel_initializer": null, "conv_kernel_initializer_config": null, "conv_bias_initializer": null, "conv_bias_initializer_config": null, "conv_transpose_kernel_initializer": null, "conv_transpose_kernel_initializer_config": null, "conv_transpose_bias_initializer": null, "conv_transpose_bias_initializer_config": null, "post_fcnet_hiddens": [], "post_fcnet_activation": "relu", "post_fcnet_weights_initializer": null, "post_fcnet_weights_initializer_config": null, "post_fcnet_bias_initializer": null, "post_fcnet_bias_initializer_config": null, "free_log_std": false, "log_std_clip_param": 20.0, "no_final_linear": false, "vf_share_layers": false, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "lstm_weights_initializer": null, "lstm_weights_initializer_config": null, "lstm_bias_initializer": null, "lstm_bias_initializer_config": null, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "attention_use_n_prev_actions": 0, "attention_use_n_prev_rewards": 0, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": null, "custom_model_config": {}, "custom_action_dist": null, "custom_preprocessor": null, "encoder_latent_dim": null, "always_check_shapes": false, "lstm_use_prev_action_reward": -1, "_use_default_native_models": -1, "_disable_preprocessor_api": false, "_disable_action_flattening": false}, "_learner_connector": null, "add_default_connectors_to_learner_pipeline": true, "learner_config_dict": {}, "optimizer": {}, "_learner_class": null, "callbacks_on_algorithm_init": null, "callbacks_on_env_runners_recreated": null, "callbacks_on_offline_eval_runners_recreated": null, "callbacks_on_checkpoint_loaded": null, "callbacks_on_environment_created": null, "callbacks_on_episode_created": null, "callbacks_on_episode_start": null, "callbacks_on_episode_step": null, "callbacks_on_episode_end": null, "callbacks_on_evaluate_start": null, "callbacks_on_evaluate_end": null, "callbacks_on_evaluate_offline_start": null, "callbacks_on_evaluate_offline_end": null, "callbacks_on_sample_end": null, "callbacks_on_train_result": null, "explore": true, "enable_rl_module_and_learner": true, "enable_env_runner_and_connector_v2": true, "_prior_exploration_config": {"type": "StochasticSampling"}, "count_steps_by": "env_steps", "policy_map_capacity": 100, "policy_mapping_fn": "<function AlgorithmConfig.DEFAULT_POLICY_MAPPING_FN at 0x1551edb20>", "policies_to_train": null, "policy_states_are_swappable": false, "observation_fn": null, "offline_data_class": null, "input_read_method": "read_parquet", "input_read_method_kwargs": {}, "input_read_schema": {}, "input_read_episodes": false, "input_read_sample_batches": false, "input_read_batch_size": null, "input_filesystem": null, "input_filesystem_kwargs": {}, "input_compress_columns": ["obs", "new_obs"], "input_spaces_jsonable": true, "materialize_data": false, "materialize_mapped_data": true, "map_batches_kwargs": {}, "iter_batches_kwargs": {}, "ignore_final_observation": false, "prelearner_class": null, "prelearner_buffer_class": null, "prelearner_buffer_kwargs": {}, "prelearner_module_synch_period": 10, "dataset_num_iters_per_learner": null, "input_config": {}, "actions_in_input_normalized": false, "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_config": {}, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "output_max_rows_per_file": null, "output_write_remaining_data": false, "output_write_method": "write_parquet", "output_write_method_kwargs": {}, "output_filesystem": null, "output_filesystem_kwargs": {}, "output_write_episodes": true, "offline_sampling": false, "evaluation_interval": 1, "evaluation_duration": 20, "evaluation_duration_unit": "episodes", "evaluation_sample_timeout_s": 120.0, "evaluation_auto_duration_min_env_steps_per_sample": 100, "evaluation_auto_duration_max_env_steps_per_sample": 2000, "evaluation_parallel_to_training": false, "evaluation_force_reset_envs_before_iteration": true, "evaluation_config": null, "off_policy_estimation_methods": {}, "ope_split_batch_by_episode": true, "evaluation_num_env_runners": 1, "in_evaluation": false, "sync_filters_on_rollout_workers_timeout_s": 10.0, "offline_evaluation_interval": null, "num_offline_eval_runners": 0, "offline_loss_for_module_fn": null, "offline_evaluation_duration": 1, "offline_evaluation_parallel_to_training": false, "offline_evaluation_timeout_s": 120.0, "num_cpus_per_offline_eval_runner": 1, "num_gpus_per_offline_eval_runner": 0, "custom_resources_per_offline_eval_runner": {}, "restart_failed_offline_eval_runners": true, "ignore_offline_eval_runner_failures": false, "max_num_offline_eval_runner_restarts": 1000, "offline_eval_runner_restore_timeout_s": 1800.0, "max_requests_in_flight_per_offline_eval_runner": 1, "validate_offline_eval_runners_after_construction": true, "offline_eval_runner_health_probe_timeout_s": 30.0, "offline_eval_rl_module_inference_only": false, "broadcast_offline_eval_runner_states": false, "offline_eval_batch_size_per_runner": 256, "dataset_num_iters_per_eval_runner": 1, "keep_per_episode_custom_metrics": false, "metrics_episode_collection_timeout_s": 60.0, "metrics_num_episodes_for_smoothing": 100, "min_time_s_per_iteration": null, "min_train_timesteps_per_iteration": 0, "min_sample_timesteps_per_iteration": 0, "log_gradients": true, "export_native_model_files": false, "checkpoint_trainable_policies_only": false, "logger_creator": null, "logger_config": null, "log_level": "WARN", "log_sys_usage": true, "fake_sampler": false, "seed": 8, "restart_failed_env_runners": true, "ignore_env_runner_failures": false, "max_num_env_runner_restarts": 1000, "delay_between_env_runner_restarts_s": 60.0, "restart_failed_sub_environments": false, "num_consecutive_env_runner_failures_tolerance": 100, "env_runner_health_probe_timeout_s": 30.0, "env_runner_restore_timeout_s": 1800.0, "_model_config": {}, "_rl_module_spec": "RLModuleSpec(module_class=None, observation_space=None, action_space=None, inference_only=False, learner_only=False, model_config=DefaultModelConfig(fcnet_hiddens=[60, 90], fcnet_activation='tanh', fcnet_kernel_initializer=None, fcnet_kernel_initializer_kwargs=None, fcnet_bias_initializer=None, fcnet_bias_initializer_kwargs=None, conv_filters=None, conv_activation='relu', conv_kernel_initializer=None, conv_kernel_initializer_kwargs=None, conv_bias_initializer=None, conv_bias_initializer_kwargs=None, head_fcnet_hiddens=[], head_fcnet_activation='relu', head_fcnet_kernel_initializer=None, head_fcnet_kernel_initializer_kwargs=None, head_fcnet_bias_initializer=None, head_fcnet_bias_initializer_kwargs=None, free_log_std=False, log_std_clip_param=20.0, vf_share_layers=True, use_lstm=False, max_seq_len=20, lstm_cell_size=256, lstm_use_prev_action=False, lstm_use_prev_reward=False, lstm_kernel_initializer=None, lstm_kernel_initializer_kwargs=None, lstm_bias_initializer=None, lstm_bias_initializer_kwargs=None), catalog_class=None, load_state_path=None, model_config_dict=None)", "algorithm_config_overrides_per_module": {}, "_per_module_overrides": {}, "_validate_config": true, "_use_msgpack_checkpoints": false, "_torch_grad_scaler_class": null, "_torch_lr_scheduler_classes": null, "_tf_policy_handles_more_than_one_loss": false, "_disable_preprocessor_api": false, "_disable_action_flattening": false, "_disable_initialize_loss_from_dummy_batch": false, "_dont_auto_sync_env_runner_states": false, "env_task_fn": -1, "enable_connectors": -1, "simple_optimizer": false, "policy_map_cache": -1, "worker_cls": -1, "synchronize_filters": -1, "enable_async_evaluation": -1, "custom_async_evaluation_function": -1, "_enable_rl_module_api": -1, "auto_wrap_old_gym_envs": -1, "always_attach_evaluation_results": -1, "replay_sequence_length": null, "_disable_execution_plan_api": -1, "use_critic": true, "use_gae": true, "use_kl_loss": true, "kl_coeff": 0.7464963036515, "kl_target": 0.0270990929592, "vf_loss_coeff": 0.6688075857018, "entropy_coeff": 0.0090570820258, "clip_param": 0.1221781641624, "vf_clip_param": 0.1027808522125, "entropy_coeff_schedule": null, "lr_schedule": null, "sgd_minibatch_size": -1, "vf_share_layers": -1, "__stdout_file__": null, "__stderr_file__": null, "lambda": 0.9099046732075, "input": "sampler", "policies": {"default_policy": [null, null, null, null]}, "callbacks": "<class 'ray.rllib.callbacks.callbacks.RLlibCallback'>", "create_env_on_driver": false, "custom_eval_function": null, "framework": "torch"}, "time_since_restore": 8.225478410720825, "iterations_since_restore": 5, "perf": {"cpu_util_percent": 41.75, "ram_util_percent": 76.94999999999999}}
{"timers": {"training_iteration": 1.5566269106206827, "restore_env_runners": 1.1240442247828911e-05, "training_step": 1.5565056824735284, "env_runner_sampling_timer": 1.4476855541846168, "learner_update_timer": 0.10589997904789963, "synch_weights": 0.0005505119704691991, "restore_eval_env_runners": 8.311652237246746e-06, "evaluation_iteration": 0.10458310080604578, "synch_eval_env_connectors": 0.00014190758836524447, "synch_env_connectors": 4.802524074683896e-06}, "env_runners": {"module_to_env_connector": {"timers": {"connectors": {"remove_single_ts_time_rank_from_batch": 5.6358161555709e-07, "un_batch_to_individual_items": 5.316065033621396e-06, "normalize_and_clip_actions": 9.388217197677674e-06, "get_actions": 3.872091623518391e-05, "listify_data_for_vector_env": 1.0964890644574033e-05, "tensor_to_numpy": 1.3133006294170174e-05}}, "connector_pipeline_timer": 0.0001036889781955869}, "episode_duration_sec_mean": 0.004523283312097191, "env_to_module_connector": {"timers": {"connectors": {"add_time_dim_to_batch_and_zero_pad": 2.350469273214954e-06, "numpy_to_tensor": 8.438499450794175e-06, "batch_individual_items": 6.10511940597427e-06, "add_observations_from_episodes_to_batch": 2.9512704492269145e-06, "add_states_from_episodes_to_batch": 1.7419232373440873e-06}}, "connector_pipeline_timer": 4.311608536503555e-05}, "env_reset_timer": 3.40413395026245e-05, "episode_return_min": -11.5, "episode_return_max": 8.5, "rlmodule_inference_timer": 2.8286174170064544e-05, "time_between_sampling": 0.0015078612892315735, "num_module_steps_sampled": {"default_policy": 5000.0}, "num_module_steps_sampled_lifetime": {"default_policy": -2460000.0}, "episode_len_mean": 20.0, "episode_return_mean": 0.58, "num_env_steps_sampled": 5000.0, "num_agent_steps_sampled": {"default_agent": 5000.0}, "module_episode_returns_mean": {"default_policy": 0.58}, "weights_seq_no": 5.0, "num_env_steps_sampled_lifetime": -2460000.0, "env_step_timer": 1.3714621781730183e-05, "num_episodes_lifetime": -123000.0, "env_to_module_sum_episodes_length_out": 10.36823839457432, "num_episodes": 250.0, "sample": 0.0051109369242253065, "agent_episode_returns_mean": {"default_agent": 0.58}, "env_to_module_sum_episodes_length_in": 10.36823839457432, "episode_len_max": 20, "episode_len_min": 20, "num_agent_steps_sampled_lifetime": {"default_agent": -2460000.0}, "num_env_steps_sampled_lifetime_throughput": 3737.528187418459}, "learners": {"default_policy": {"curr_entropy_coeff": 0.0090570820258, "weights_seq_no": 6.0, "gradients_default_optimizer_global_norm": 0.08454997837543488, "entropy": 0.676906406879425, "num_module_steps_trained": 6000, "num_trainable_parameters": 6003, "policy_loss": -0.08983005583286285, "mean_kl_loss": 0.001113722799345851, "vf_loss": 0.10278083384037018, "module_train_batch_size_mean": 1000.0, "vf_explained_var": 0.003413856029510498, "diff_num_grad_updates_vs_sampler_policy": 1.0, "default_optimizer_learning_rate": 0.0002847858517, "num_module_steps_trained_lifetime": 36000, "vf_loss_unclipped": 27.926227569580078, "total_loss": -0.02719425968825817, "curr_kl_coeff": 0.011664004996418953, "num_module_steps_trained_lifetime_throughput": 389282.5601141838}, "__all_modules__": {"learner_connector": {"connector_pipeline_timer": 0.08098245689864578, "timers": {"connectors": {"numpy_to_tensor": 7.486600552261193e-05, "add_one_ts_to_episodes_and_truncate": 0.0076227789142380925, "add_time_dim_to_batch_and_zero_pad": 1.2250177566673734e-05, "batch_individual_items": 0.03182890917186244, "general_advantage_estimation": 0.006545095702965992, "add_columns_from_episodes_to_train_batch": 0.033939233211686314, "add_states_from_episodes_to_batch": 3.322819098983589e-06, "add_observations_from_episodes_to_batch": 0.0008314848958025642}}}, "num_module_steps_trained": 6000, "num_trainable_parameters": 6003, "learner_connector_sum_episodes_length_in": 5000.0, "num_module_steps_trained_lifetime": 36000, "num_non_trainable_parameters": 0, "num_env_steps_trained": 31500, "num_env_steps_trained_lifetime": 189000, "learner_connector_sum_episodes_length_out": 5250.0, "num_env_steps_trained_lifetime_throughput": 2033122.4277287591, "num_module_steps_trained_throughput": 388593.8074939155, "num_module_steps_trained_lifetime_throughput": 388094.48622968426}}, "num_training_step_calls_per_iteration": 1, "evaluation": {"env_runners": {"module_episode_returns_mean": {"default_policy": 1.55}, "env_to_module_connector": {"timers": {"connectors": {"add_observations_from_episodes_to_batch": 2.8261735088600728e-06, "numpy_to_tensor": 8.556057885044108e-06, "add_time_dim_to_batch_and_zero_pad": 2.333964778863719e-06, "batch_individual_items": 6.190430024879101e-06, "add_states_from_episodes_to_batch": 1.6197535262449705e-06}}, "connector_pipeline_timer": 4.30066478850521e-05}, "module_to_env_connector": {"timers": {"connectors": {"get_actions": 3.643177842258992e-05, "un_batch_to_individual_items": 5.416968440227676e-06, "listify_data_for_vector_env": 1.1050272033608494e-05, "normalize_and_clip_actions": 9.496887774056625e-06, "tensor_to_numpy": 1.3068701675334231e-05, "remove_single_ts_time_rank_from_batch": 5.795022651692248e-07}}, "connector_pipeline_timer": 0.00010154652784630099}, "num_env_steps_sampled": 400, "num_agent_steps_sampled_lifetime": {"default_agent": 2400}, "num_env_steps_sampled_lifetime": 30400, "num_module_steps_sampled": {"default_policy": 400}, "episode_len_max": 20, "episode_duration_sec_mean": 0.004469314587768167, "env_reset_timer": 0.00013626784056395218, "episode_return_max": 14.5, "agent_episode_returns_mean": {"default_agent": 1.55}, "num_episodes_lifetime": 120, "env_to_module_sum_episodes_length_in": 10.368238394470474, "episode_len_min": 20, "rlmodule_inference_timer": 2.701657501353199e-05, "episode_return_mean": 1.55, "env_step_timer": 1.4050999105256914e-05, "env_to_module_sum_episodes_length_out": 10.368238394470474, "num_episodes": 20, "num_agent_steps_sampled": {"default_agent": 400}, "episode_return_min": -14.5, "episode_len_mean": 20.0, "weights_seq_no": 6.0, "num_module_steps_sampled_lifetime": {"default_policy": 2400}, "sample": 0.09846282297370335, "time_between_sampling": 1.5854449687263876}, "num_healthy_workers": 1, "actor_manager_num_outstanding_async_reqs": 0, "num_remote_worker_restarts": 0}, "num_env_steps_sampled_lifetime": -2460000.0, "fault_tolerance": {"num_healthy_workers": 0, "num_remote_worker_restarts": 0}, "env_runner_group": {"actor_manager_num_outstanding_async_reqs": 0}, "done": false, "training_iteration": 6, "trial_id": "4666f_00000", "date": "2025-08-11_19-23-49", "timestamp": 1754933029, "time_this_iter_s": 1.6656067371368408, "time_total_s": 9.891085147857666, "pid": 14463, "hostname": "Mac", "node_ip": "127.0.0.1", "config": {"exploration_config": {}, "extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "placement_strategy": "PACK", "num_gpus": 0, "_fake_gpus": false, "num_cpus_for_main_process": 2, "eager_tracing": true, "eager_max_retraces": 20, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "torch_compile_learner": false, "torch_compile_learner_what_to_compile": "forward_train", "torch_compile_learner_dynamo_backend": "aot_eager", "torch_compile_learner_dynamo_mode": null, "torch_compile_worker": false, "torch_compile_worker_dynamo_backend": "aot_eager", "torch_compile_worker_dynamo_mode": null, "torch_ddp_kwargs": {}, "torch_skip_nan_gradients": false, "env": "Umbrella", "env_config": {}, "observation_space": null, "action_space": null, "clip_rewards": null, "normalize_actions": true, "clip_actions": false, "_is_atari": null, "disable_env_checking": false, "render_env": false, "action_mask_key": "action_mask", "env_runner_cls": null, "num_env_runners": 0, "create_local_env_runner": true, "num_envs_per_env_runner": 1, "gym_env_vectorize_mode": "SYNC", "num_cpus_per_env_runner": 1, "num_gpus_per_env_runner": 0, "custom_resources_per_env_runner": {}, "validate_env_runners_after_construction": true, "episodes_to_numpy": true, "max_requests_in_flight_per_env_runner": 1, "sample_timeout_s": 60.0, "_env_to_module_connector": null, "add_default_connectors_to_env_to_module_pipeline": true, "_module_to_env_connector": null, "add_default_connectors_to_module_to_env_pipeline": true, "merge_env_runner_states": "training_only", "broadcast_env_runner_states": true, "episode_lookback_horizon": 1, "rollout_fragment_length": "auto", "batch_mode": "complete_episodes", "compress_observations": false, "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "enable_tf1_exec_eagerly": false, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "preprocessor_pref": "deepmind", "observation_filter": "NoFilter", "update_worker_filter_stats": true, "use_worker_filter_stats": true, "sampler_perf_stats_ema_coef": null, "_is_online": true, "num_learners": 0, "num_gpus_per_learner": 0, "num_cpus_per_learner": "auto", "num_aggregator_actors_per_learner": 0, "max_requests_in_flight_per_aggregator_actor": 3, "local_gpu_idx": 0, "max_requests_in_flight_per_learner": 3, "gamma": 1, "lr": 0.0002847858517, "grad_clip": 0.5, "grad_clip_by": "global_norm", "_train_batch_size_per_learner": 5000, "train_batch_size": 4000, "num_epochs": 1, "minibatch_size": 1000, "shuffle_batch_per_epoch": true, "model": {"fcnet_hiddens": [256, 256], "fcnet_activation": "tanh", "fcnet_weights_initializer": null, "fcnet_weights_initializer_config": null, "fcnet_bias_initializer": null, "fcnet_bias_initializer_config": null, "conv_filters": null, "conv_activation": "relu", "conv_kernel_initializer": null, "conv_kernel_initializer_config": null, "conv_bias_initializer": null, "conv_bias_initializer_config": null, "conv_transpose_kernel_initializer": null, "conv_transpose_kernel_initializer_config": null, "conv_transpose_bias_initializer": null, "conv_transpose_bias_initializer_config": null, "post_fcnet_hiddens": [], "post_fcnet_activation": "relu", "post_fcnet_weights_initializer": null, "post_fcnet_weights_initializer_config": null, "post_fcnet_bias_initializer": null, "post_fcnet_bias_initializer_config": null, "free_log_std": false, "log_std_clip_param": 20.0, "no_final_linear": false, "vf_share_layers": false, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "lstm_weights_initializer": null, "lstm_weights_initializer_config": null, "lstm_bias_initializer": null, "lstm_bias_initializer_config": null, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "attention_use_n_prev_actions": 0, "attention_use_n_prev_rewards": 0, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": null, "custom_model_config": {}, "custom_action_dist": null, "custom_preprocessor": null, "encoder_latent_dim": null, "always_check_shapes": false, "lstm_use_prev_action_reward": -1, "_use_default_native_models": -1, "_disable_preprocessor_api": false, "_disable_action_flattening": false}, "_learner_connector": null, "add_default_connectors_to_learner_pipeline": true, "learner_config_dict": {}, "optimizer": {}, "_learner_class": null, "callbacks_on_algorithm_init": null, "callbacks_on_env_runners_recreated": null, "callbacks_on_offline_eval_runners_recreated": null, "callbacks_on_checkpoint_loaded": null, "callbacks_on_environment_created": null, "callbacks_on_episode_created": null, "callbacks_on_episode_start": null, "callbacks_on_episode_step": null, "callbacks_on_episode_end": null, "callbacks_on_evaluate_start": null, "callbacks_on_evaluate_end": null, "callbacks_on_evaluate_offline_start": null, "callbacks_on_evaluate_offline_end": null, "callbacks_on_sample_end": null, "callbacks_on_train_result": null, "explore": true, "enable_rl_module_and_learner": true, "enable_env_runner_and_connector_v2": true, "_prior_exploration_config": {"type": "StochasticSampling"}, "count_steps_by": "env_steps", "policy_map_capacity": 100, "policy_mapping_fn": "<function AlgorithmConfig.DEFAULT_POLICY_MAPPING_FN at 0x1551edb20>", "policies_to_train": null, "policy_states_are_swappable": false, "observation_fn": null, "offline_data_class": null, "input_read_method": "read_parquet", "input_read_method_kwargs": {}, "input_read_schema": {}, "input_read_episodes": false, "input_read_sample_batches": false, "input_read_batch_size": null, "input_filesystem": null, "input_filesystem_kwargs": {}, "input_compress_columns": ["obs", "new_obs"], "input_spaces_jsonable": true, "materialize_data": false, "materialize_mapped_data": true, "map_batches_kwargs": {}, "iter_batches_kwargs": {}, "ignore_final_observation": false, "prelearner_class": null, "prelearner_buffer_class": null, "prelearner_buffer_kwargs": {}, "prelearner_module_synch_period": 10, "dataset_num_iters_per_learner": null, "input_config": {}, "actions_in_input_normalized": false, "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_config": {}, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "output_max_rows_per_file": null, "output_write_remaining_data": false, "output_write_method": "write_parquet", "output_write_method_kwargs": {}, "output_filesystem": null, "output_filesystem_kwargs": {}, "output_write_episodes": true, "offline_sampling": false, "evaluation_interval": 1, "evaluation_duration": 20, "evaluation_duration_unit": "episodes", "evaluation_sample_timeout_s": 120.0, "evaluation_auto_duration_min_env_steps_per_sample": 100, "evaluation_auto_duration_max_env_steps_per_sample": 2000, "evaluation_parallel_to_training": false, "evaluation_force_reset_envs_before_iteration": true, "evaluation_config": null, "off_policy_estimation_methods": {}, "ope_split_batch_by_episode": true, "evaluation_num_env_runners": 1, "in_evaluation": false, "sync_filters_on_rollout_workers_timeout_s": 10.0, "offline_evaluation_interval": null, "num_offline_eval_runners": 0, "offline_loss_for_module_fn": null, "offline_evaluation_duration": 1, "offline_evaluation_parallel_to_training": false, "offline_evaluation_timeout_s": 120.0, "num_cpus_per_offline_eval_runner": 1, "num_gpus_per_offline_eval_runner": 0, "custom_resources_per_offline_eval_runner": {}, "restart_failed_offline_eval_runners": true, "ignore_offline_eval_runner_failures": false, "max_num_offline_eval_runner_restarts": 1000, "offline_eval_runner_restore_timeout_s": 1800.0, "max_requests_in_flight_per_offline_eval_runner": 1, "validate_offline_eval_runners_after_construction": true, "offline_eval_runner_health_probe_timeout_s": 30.0, "offline_eval_rl_module_inference_only": false, "broadcast_offline_eval_runner_states": false, "offline_eval_batch_size_per_runner": 256, "dataset_num_iters_per_eval_runner": 1, "keep_per_episode_custom_metrics": false, "metrics_episode_collection_timeout_s": 60.0, "metrics_num_episodes_for_smoothing": 100, "min_time_s_per_iteration": null, "min_train_timesteps_per_iteration": 0, "min_sample_timesteps_per_iteration": 0, "log_gradients": true, "export_native_model_files": false, "checkpoint_trainable_policies_only": false, "logger_creator": null, "logger_config": null, "log_level": "WARN", "log_sys_usage": true, "fake_sampler": false, "seed": 8, "restart_failed_env_runners": true, "ignore_env_runner_failures": false, "max_num_env_runner_restarts": 1000, "delay_between_env_runner_restarts_s": 60.0, "restart_failed_sub_environments": false, "num_consecutive_env_runner_failures_tolerance": 100, "env_runner_health_probe_timeout_s": 30.0, "env_runner_restore_timeout_s": 1800.0, "_model_config": {}, "_rl_module_spec": "RLModuleSpec(module_class=None, observation_space=None, action_space=None, inference_only=False, learner_only=False, model_config=DefaultModelConfig(fcnet_hiddens=[60, 90], fcnet_activation='tanh', fcnet_kernel_initializer=None, fcnet_kernel_initializer_kwargs=None, fcnet_bias_initializer=None, fcnet_bias_initializer_kwargs=None, conv_filters=None, conv_activation='relu', conv_kernel_initializer=None, conv_kernel_initializer_kwargs=None, conv_bias_initializer=None, conv_bias_initializer_kwargs=None, head_fcnet_hiddens=[], head_fcnet_activation='relu', head_fcnet_kernel_initializer=None, head_fcnet_kernel_initializer_kwargs=None, head_fcnet_bias_initializer=None, head_fcnet_bias_initializer_kwargs=None, free_log_std=False, log_std_clip_param=20.0, vf_share_layers=True, use_lstm=False, max_seq_len=20, lstm_cell_size=256, lstm_use_prev_action=False, lstm_use_prev_reward=False, lstm_kernel_initializer=None, lstm_kernel_initializer_kwargs=None, lstm_bias_initializer=None, lstm_bias_initializer_kwargs=None), catalog_class=None, load_state_path=None, model_config_dict=None)", "algorithm_config_overrides_per_module": {}, "_per_module_overrides": {}, "_validate_config": true, "_use_msgpack_checkpoints": false, "_torch_grad_scaler_class": null, "_torch_lr_scheduler_classes": null, "_tf_policy_handles_more_than_one_loss": false, "_disable_preprocessor_api": false, "_disable_action_flattening": false, "_disable_initialize_loss_from_dummy_batch": false, "_dont_auto_sync_env_runner_states": false, "env_task_fn": -1, "enable_connectors": -1, "simple_optimizer": false, "policy_map_cache": -1, "worker_cls": -1, "synchronize_filters": -1, "enable_async_evaluation": -1, "custom_async_evaluation_function": -1, "_enable_rl_module_api": -1, "auto_wrap_old_gym_envs": -1, "always_attach_evaluation_results": -1, "replay_sequence_length": null, "_disable_execution_plan_api": -1, "use_critic": true, "use_gae": true, "use_kl_loss": true, "kl_coeff": 0.7464963036515, "kl_target": 0.0270990929592, "vf_loss_coeff": 0.6688075857018, "entropy_coeff": 0.0090570820258, "clip_param": 0.1221781641624, "vf_clip_param": 0.1027808522125, "entropy_coeff_schedule": null, "lr_schedule": null, "sgd_minibatch_size": -1, "vf_share_layers": -1, "__stdout_file__": null, "__stderr_file__": null, "lambda": 0.9099046732075, "input": "sampler", "policies": {"default_policy": [null, null, null, null]}, "callbacks": "<class 'ray.rllib.callbacks.callbacks.RLlibCallback'>", "create_env_on_driver": false, "custom_eval_function": null, "framework": "torch"}, "time_since_restore": 9.891085147857666, "iterations_since_restore": 6, "perf": {"cpu_util_percent": 27.46666666666667, "ram_util_percent": 77.19999999999999}}
{"timers": {"training_iteration": 1.555786246933847, "restore_env_runners": 1.1187627336134175e-05, "training_step": 1.5556644868988883, "env_runner_sampling_timer": 1.446940447393204, "learner_update_timer": 0.10580192467692215, "synch_weights": 0.000551778101392442, "restore_eval_env_runners": 8.305616627762329e-06, "evaluation_iteration": 0.1045593164685358, "synch_eval_env_connectors": 0.00014149434319048318, "synch_env_connectors": 4.799907794368871e-06}, "env_runners": {"module_to_env_connector": {"timers": {"connectors": {"remove_single_ts_time_rank_from_batch": 5.68137299330876e-07, "un_batch_to_individual_items": 5.4069337365602075e-06, "normalize_and_clip_actions": 9.390933562958756e-06, "get_actions": 3.82227928037047e-05, "listify_data_for_vector_env": 1.1085557464707554e-05, "tensor_to_numpy": 1.3105282083268926e-05}}, "connector_pipeline_timer": 0.0001034345916567797}, "episode_duration_sec_mean": 0.004535143129061905, "env_to_module_connector": {"timers": {"connectors": {"add_time_dim_to_batch_and_zero_pad": 2.349407153363553e-06, "numpy_to_tensor": 8.473623449342606e-06, "batch_individual_items": 6.200414864006376e-06, "add_observations_from_episodes_to_batch": 2.993612328449499e-06, "add_states_from_episodes_to_batch": 1.7455122984978288e-06}}, "connector_pipeline_timer": 4.345647629869498e-05}, "env_reset_timer": 3.2821224261989136e-05, "episode_return_min": -11.5, "episode_return_max": 8.5, "rlmodule_inference_timer": 2.8010758650790072e-05, "time_between_sampling": 0.0018303984303698264, "num_module_steps_sampled": {"default_policy": 5000.0}, "num_module_steps_sampled_lifetime": {"default_policy": -3077500.0}, "episode_len_mean": 20.0, "episode_return_mean": 2.259999999999999, "num_env_steps_sampled": 5000.0, "num_agent_steps_sampled": {"default_agent": 5000.0}, "module_episode_returns_mean": {"default_policy": 2.259999999999999}, "weights_seq_no": 6.0, "num_env_steps_sampled_lifetime": -3077500.0, "env_step_timer": 1.3760885027251267e-05, "num_episodes_lifetime": -153875.0, "env_to_module_sum_episodes_length_out": 10.36823839457432, "num_episodes": 250.0, "sample": 0.00486032780507312, "agent_episode_returns_mean": {"default_agent": 2.259999999999999}, "env_to_module_sum_episodes_length_in": 10.36823839457432, "episode_len_max": 20, "episode_len_min": 20, "num_agent_steps_sampled_lifetime": {"default_agent": -3077500.0}, "num_env_steps_sampled_lifetime_throughput": 3743.1827773531045}, "learners": {"default_policy": {"curr_entropy_coeff": 0.0090570820258, "weights_seq_no": 7.0, "gradients_default_optimizer_global_norm": 0.049868904054164886, "entropy": 0.66071617603302, "num_module_steps_trained": 6000, "num_trainable_parameters": 6003, "policy_loss": 0.03569741174578667, "mean_kl_loss": 0.0023606023751199245, "vf_loss": 0.10278083384037018, "module_train_batch_size_mean": 1000.0, "vf_explained_var": 0.003434121608734131, "diff_num_grad_updates_vs_sampler_policy": 1.0, "default_optimizer_learning_rate": 0.0002847858517, "num_module_steps_trained_lifetime": 42000, "vf_loss_unclipped": 27.751880645751953, "total_loss": 0.09848138689994812, "curr_kl_coeff": 0.0058320024982094765, "num_module_steps_trained_lifetime_throughput": 389277.8578522621}, "__all_modules__": {"learner_connector": {"connector_pipeline_timer": 0.08097116941938155, "timers": {"connectors": {"numpy_to_tensor": 7.47502664683284e-05, "add_one_ts_to_episodes_and_truncate": 0.007624711535144152, "add_time_dim_to_batch_and_zero_pad": 1.224059516071947e-05, "batch_individual_items": 0.03182096674942844, "general_advantage_estimation": 0.006533230576546577, "add_columns_from_episodes_to_train_batch": 0.03394617754001046, "add_states_from_episodes_to_batch": 3.321251218917806e-06, "add_observations_from_episodes_to_batch": 0.0008315171371782388}}}, "num_module_steps_trained": 6000, "num_trainable_parameters": 6003, "learner_connector_sum_episodes_length_in": 5000.0, "num_module_steps_trained_lifetime": 42000, "num_non_trainable_parameters": 0, "num_env_steps_trained": 31500, "num_env_steps_trained_lifetime": 220500, "learner_connector_sum_episodes_length_out": 5250.0, "num_env_steps_trained_lifetime_throughput": 2033630.1513217802, "num_module_steps_trained_throughput": 388643.84753137216, "num_module_steps_trained_lifetime_throughput": 388159.01961241424}}, "num_training_step_calls_per_iteration": 1, "evaluation": {"env_runners": {"module_episode_returns_mean": {"default_policy": 0.35}, "env_to_module_connector": {"timers": {"connectors": {"add_observations_from_episodes_to_batch": 2.8576712562366556e-06, "numpy_to_tensor": 8.523334196247849e-06, "add_time_dim_to_batch_and_zero_pad": 2.3477181979844935e-06, "batch_individual_items": 6.2960282717409015e-06, "add_states_from_episodes_to_batch": 1.6184016048205089e-06}}, "connector_pipeline_timer": 4.367355091051894e-05}, "module_to_env_connector": {"timers": {"connectors": {"get_actions": 3.7008375587040536e-05, "un_batch_to_individual_items": 5.468573352565392e-06, "listify_data_for_vector_env": 1.122991122256423e-05, "normalize_and_clip_actions": 9.512823877695719e-06, "tensor_to_numpy": 1.3389048263857027e-05, "remove_single_ts_time_rank_from_batch": 5.924755161512741e-07}}, "connector_pipeline_timer": 0.00010286373032244946}, "num_env_steps_sampled": 400, "num_agent_steps_sampled_lifetime": {"default_agent": 2800}, "num_env_steps_sampled_lifetime": 35400, "num_module_steps_sampled": {"default_policy": 400}, "episode_len_max": 20, "episode_duration_sec_mean": 0.00448721791151911, "env_reset_timer": 0.0001356264121205382, "episode_return_max": 14.5, "agent_episode_returns_mean": {"default_agent": 0.35}, "num_episodes_lifetime": 140, "env_to_module_sum_episodes_length_in": 10.368238394572801, "episode_len_min": 20, "rlmodule_inference_timer": 2.769924569353883e-05, "episode_return_mean": 0.35, "env_step_timer": 1.448650070616679e-05, "env_to_module_sum_episodes_length_out": 10.368238394572801, "num_episodes": 20, "num_agent_steps_sampled": {"default_agent": 400}, "episode_return_min": -14.5, "episode_len_mean": 20.0, "weights_seq_no": 7.0, "num_module_steps_sampled_lifetime": {"default_policy": 2800}, "sample": 0.09847778933436013, "time_between_sampling": 1.5844824702897347}, "num_healthy_workers": 1, "actor_manager_num_outstanding_async_reqs": 0, "num_remote_worker_restarts": 0}, "num_env_steps_sampled_lifetime": -3077500.0, "fault_tolerance": {"num_healthy_workers": 0, "num_remote_worker_restarts": 0}, "env_runner_group": {"actor_manager_num_outstanding_async_reqs": 0}, "done": false, "training_iteration": 7, "trial_id": "4666f_00000", "date": "2025-08-11_19-23-51", "timestamp": 1754933031, "time_this_iter_s": 1.5794880390167236, "time_total_s": 11.47057318687439, "pid": 14463, "hostname": "Mac", "node_ip": "127.0.0.1", "config": {"exploration_config": {}, "extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "placement_strategy": "PACK", "num_gpus": 0, "_fake_gpus": false, "num_cpus_for_main_process": 2, "eager_tracing": true, "eager_max_retraces": 20, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "torch_compile_learner": false, "torch_compile_learner_what_to_compile": "forward_train", "torch_compile_learner_dynamo_backend": "aot_eager", "torch_compile_learner_dynamo_mode": null, "torch_compile_worker": false, "torch_compile_worker_dynamo_backend": "aot_eager", "torch_compile_worker_dynamo_mode": null, "torch_ddp_kwargs": {}, "torch_skip_nan_gradients": false, "env": "Umbrella", "env_config": {}, "observation_space": null, "action_space": null, "clip_rewards": null, "normalize_actions": true, "clip_actions": false, "_is_atari": null, "disable_env_checking": false, "render_env": false, "action_mask_key": "action_mask", "env_runner_cls": null, "num_env_runners": 0, "create_local_env_runner": true, "num_envs_per_env_runner": 1, "gym_env_vectorize_mode": "SYNC", "num_cpus_per_env_runner": 1, "num_gpus_per_env_runner": 0, "custom_resources_per_env_runner": {}, "validate_env_runners_after_construction": true, "episodes_to_numpy": true, "max_requests_in_flight_per_env_runner": 1, "sample_timeout_s": 60.0, "_env_to_module_connector": null, "add_default_connectors_to_env_to_module_pipeline": true, "_module_to_env_connector": null, "add_default_connectors_to_module_to_env_pipeline": true, "merge_env_runner_states": "training_only", "broadcast_env_runner_states": true, "episode_lookback_horizon": 1, "rollout_fragment_length": "auto", "batch_mode": "complete_episodes", "compress_observations": false, "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "enable_tf1_exec_eagerly": false, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "preprocessor_pref": "deepmind", "observation_filter": "NoFilter", "update_worker_filter_stats": true, "use_worker_filter_stats": true, "sampler_perf_stats_ema_coef": null, "_is_online": true, "num_learners": 0, "num_gpus_per_learner": 0, "num_cpus_per_learner": "auto", "num_aggregator_actors_per_learner": 0, "max_requests_in_flight_per_aggregator_actor": 3, "local_gpu_idx": 0, "max_requests_in_flight_per_learner": 3, "gamma": 1, "lr": 0.0002847858517, "grad_clip": 0.5, "grad_clip_by": "global_norm", "_train_batch_size_per_learner": 5000, "train_batch_size": 4000, "num_epochs": 1, "minibatch_size": 1000, "shuffle_batch_per_epoch": true, "model": {"fcnet_hiddens": [256, 256], "fcnet_activation": "tanh", "fcnet_weights_initializer": null, "fcnet_weights_initializer_config": null, "fcnet_bias_initializer": null, "fcnet_bias_initializer_config": null, "conv_filters": null, "conv_activation": "relu", "conv_kernel_initializer": null, "conv_kernel_initializer_config": null, "conv_bias_initializer": null, "conv_bias_initializer_config": null, "conv_transpose_kernel_initializer": null, "conv_transpose_kernel_initializer_config": null, "conv_transpose_bias_initializer": null, "conv_transpose_bias_initializer_config": null, "post_fcnet_hiddens": [], "post_fcnet_activation": "relu", "post_fcnet_weights_initializer": null, "post_fcnet_weights_initializer_config": null, "post_fcnet_bias_initializer": null, "post_fcnet_bias_initializer_config": null, "free_log_std": false, "log_std_clip_param": 20.0, "no_final_linear": false, "vf_share_layers": false, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "lstm_weights_initializer": null, "lstm_weights_initializer_config": null, "lstm_bias_initializer": null, "lstm_bias_initializer_config": null, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "attention_use_n_prev_actions": 0, "attention_use_n_prev_rewards": 0, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": null, "custom_model_config": {}, "custom_action_dist": null, "custom_preprocessor": null, "encoder_latent_dim": null, "always_check_shapes": false, "lstm_use_prev_action_reward": -1, "_use_default_native_models": -1, "_disable_preprocessor_api": false, "_disable_action_flattening": false}, "_learner_connector": null, "add_default_connectors_to_learner_pipeline": true, "learner_config_dict": {}, "optimizer": {}, "_learner_class": null, "callbacks_on_algorithm_init": null, "callbacks_on_env_runners_recreated": null, "callbacks_on_offline_eval_runners_recreated": null, "callbacks_on_checkpoint_loaded": null, "callbacks_on_environment_created": null, "callbacks_on_episode_created": null, "callbacks_on_episode_start": null, "callbacks_on_episode_step": null, "callbacks_on_episode_end": null, "callbacks_on_evaluate_start": null, "callbacks_on_evaluate_end": null, "callbacks_on_evaluate_offline_start": null, "callbacks_on_evaluate_offline_end": null, "callbacks_on_sample_end": null, "callbacks_on_train_result": null, "explore": true, "enable_rl_module_and_learner": true, "enable_env_runner_and_connector_v2": true, "_prior_exploration_config": {"type": "StochasticSampling"}, "count_steps_by": "env_steps", "policy_map_capacity": 100, "policy_mapping_fn": "<function AlgorithmConfig.DEFAULT_POLICY_MAPPING_FN at 0x1551edb20>", "policies_to_train": null, "policy_states_are_swappable": false, "observation_fn": null, "offline_data_class": null, "input_read_method": "read_parquet", "input_read_method_kwargs": {}, "input_read_schema": {}, "input_read_episodes": false, "input_read_sample_batches": false, "input_read_batch_size": null, "input_filesystem": null, "input_filesystem_kwargs": {}, "input_compress_columns": ["obs", "new_obs"], "input_spaces_jsonable": true, "materialize_data": false, "materialize_mapped_data": true, "map_batches_kwargs": {}, "iter_batches_kwargs": {}, "ignore_final_observation": false, "prelearner_class": null, "prelearner_buffer_class": null, "prelearner_buffer_kwargs": {}, "prelearner_module_synch_period": 10, "dataset_num_iters_per_learner": null, "input_config": {}, "actions_in_input_normalized": false, "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_config": {}, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "output_max_rows_per_file": null, "output_write_remaining_data": false, "output_write_method": "write_parquet", "output_write_method_kwargs": {}, "output_filesystem": null, "output_filesystem_kwargs": {}, "output_write_episodes": true, "offline_sampling": false, "evaluation_interval": 1, "evaluation_duration": 20, "evaluation_duration_unit": "episodes", "evaluation_sample_timeout_s": 120.0, "evaluation_auto_duration_min_env_steps_per_sample": 100, "evaluation_auto_duration_max_env_steps_per_sample": 2000, "evaluation_parallel_to_training": false, "evaluation_force_reset_envs_before_iteration": true, "evaluation_config": null, "off_policy_estimation_methods": {}, "ope_split_batch_by_episode": true, "evaluation_num_env_runners": 1, "in_evaluation": false, "sync_filters_on_rollout_workers_timeout_s": 10.0, "offline_evaluation_interval": null, "num_offline_eval_runners": 0, "offline_loss_for_module_fn": null, "offline_evaluation_duration": 1, "offline_evaluation_parallel_to_training": false, "offline_evaluation_timeout_s": 120.0, "num_cpus_per_offline_eval_runner": 1, "num_gpus_per_offline_eval_runner": 0, "custom_resources_per_offline_eval_runner": {}, "restart_failed_offline_eval_runners": true, "ignore_offline_eval_runner_failures": false, "max_num_offline_eval_runner_restarts": 1000, "offline_eval_runner_restore_timeout_s": 1800.0, "max_requests_in_flight_per_offline_eval_runner": 1, "validate_offline_eval_runners_after_construction": true, "offline_eval_runner_health_probe_timeout_s": 30.0, "offline_eval_rl_module_inference_only": false, "broadcast_offline_eval_runner_states": false, "offline_eval_batch_size_per_runner": 256, "dataset_num_iters_per_eval_runner": 1, "keep_per_episode_custom_metrics": false, "metrics_episode_collection_timeout_s": 60.0, "metrics_num_episodes_for_smoothing": 100, "min_time_s_per_iteration": null, "min_train_timesteps_per_iteration": 0, "min_sample_timesteps_per_iteration": 0, "log_gradients": true, "export_native_model_files": false, "checkpoint_trainable_policies_only": false, "logger_creator": null, "logger_config": null, "log_level": "WARN", "log_sys_usage": true, "fake_sampler": false, "seed": 8, "restart_failed_env_runners": true, "ignore_env_runner_failures": false, "max_num_env_runner_restarts": 1000, "delay_between_env_runner_restarts_s": 60.0, "restart_failed_sub_environments": false, "num_consecutive_env_runner_failures_tolerance": 100, "env_runner_health_probe_timeout_s": 30.0, "env_runner_restore_timeout_s": 1800.0, "_model_config": {}, "_rl_module_spec": "RLModuleSpec(module_class=None, observation_space=None, action_space=None, inference_only=False, learner_only=False, model_config=DefaultModelConfig(fcnet_hiddens=[60, 90], fcnet_activation='tanh', fcnet_kernel_initializer=None, fcnet_kernel_initializer_kwargs=None, fcnet_bias_initializer=None, fcnet_bias_initializer_kwargs=None, conv_filters=None, conv_activation='relu', conv_kernel_initializer=None, conv_kernel_initializer_kwargs=None, conv_bias_initializer=None, conv_bias_initializer_kwargs=None, head_fcnet_hiddens=[], head_fcnet_activation='relu', head_fcnet_kernel_initializer=None, head_fcnet_kernel_initializer_kwargs=None, head_fcnet_bias_initializer=None, head_fcnet_bias_initializer_kwargs=None, free_log_std=False, log_std_clip_param=20.0, vf_share_layers=True, use_lstm=False, max_seq_len=20, lstm_cell_size=256, lstm_use_prev_action=False, lstm_use_prev_reward=False, lstm_kernel_initializer=None, lstm_kernel_initializer_kwargs=None, lstm_bias_initializer=None, lstm_bias_initializer_kwargs=None), catalog_class=None, load_state_path=None, model_config_dict=None)", "algorithm_config_overrides_per_module": {}, "_per_module_overrides": {}, "_validate_config": true, "_use_msgpack_checkpoints": false, "_torch_grad_scaler_class": null, "_torch_lr_scheduler_classes": null, "_tf_policy_handles_more_than_one_loss": false, "_disable_preprocessor_api": false, "_disable_action_flattening": false, "_disable_initialize_loss_from_dummy_batch": false, "_dont_auto_sync_env_runner_states": false, "env_task_fn": -1, "enable_connectors": -1, "simple_optimizer": false, "policy_map_cache": -1, "worker_cls": -1, "synchronize_filters": -1, "enable_async_evaluation": -1, "custom_async_evaluation_function": -1, "_enable_rl_module_api": -1, "auto_wrap_old_gym_envs": -1, "always_attach_evaluation_results": -1, "replay_sequence_length": null, "_disable_execution_plan_api": -1, "use_critic": true, "use_gae": true, "use_kl_loss": true, "kl_coeff": 0.7464963036515, "kl_target": 0.0270990929592, "vf_loss_coeff": 0.6688075857018, "entropy_coeff": 0.0090570820258, "clip_param": 0.1221781641624, "vf_clip_param": 0.1027808522125, "entropy_coeff_schedule": null, "lr_schedule": null, "sgd_minibatch_size": -1, "vf_share_layers": -1, "__stdout_file__": null, "__stderr_file__": null, "lambda": 0.9099046732075, "input": "sampler", "policies": {"default_policy": [null, null, null, null]}, "callbacks": "<class 'ray.rllib.callbacks.callbacks.RLlibCallback'>", "create_env_on_driver": false, "custom_eval_function": null, "framework": "torch"}, "time_since_restore": 11.47057318687439, "iterations_since_restore": 7, "perf": {"cpu_util_percent": 38.6, "ram_util_percent": 77.1}}
{"timers": {"training_iteration": 1.5558512615449678, "restore_env_runners": 1.114283189951595e-05, "training_step": 1.5557287732806409, "env_runner_sampling_timer": 1.4471123904200005, "learner_update_timer": 0.10568745168108112, "synch_weights": 0.0005525828202087934, "restore_eval_env_runners": 8.28255975420109e-06, "evaluation_iteration": 0.10456133997468993, "synch_eval_env_connectors": 0.00014101647907085817, "synch_env_connectors": 4.794818239897371e-06}, "env_runners": {"module_to_env_connector": {"timers": {"connectors": {"remove_single_ts_time_rank_from_batch": 5.833134782459776e-07, "un_batch_to_individual_items": 5.385976855374745e-06, "normalize_and_clip_actions": 9.430307335694244e-06, "get_actions": 3.8469529413675456e-05, "listify_data_for_vector_env": 1.1024320303553037e-05, "tensor_to_numpy": 1.3122244703394872e-05}}, "connector_pipeline_timer": 0.00010375283062436607}, "episode_duration_sec_mean": 0.004883488530758769, "env_to_module_connector": {"timers": {"connectors": {"add_time_dim_to_batch_and_zero_pad": 2.358425719419211e-06, "numpy_to_tensor": 8.446141318559763e-06, "batch_individual_items": 6.1713909715784535e-06, "add_observations_from_episodes_to_batch": 3.003404472686059e-06, "add_states_from_episodes_to_batch": 1.7455705371064579e-06}}, "connector_pipeline_timer": 4.342736494321198e-05}, "env_reset_timer": 3.464051119771366e-05, "episode_return_min": -11.5, "episode_return_max": 8.5, "rlmodule_inference_timer": 4.3483802698769626e-05, "time_between_sampling": 0.0015376150136010654, "num_module_steps_sampled": {"default_policy": 5000.0}, "num_module_steps_sampled_lifetime": {"default_policy": -3695000.0}, "episode_len_mean": 20.0, "episode_return_mean": 1.8600000000000003, "num_env_steps_sampled": 5000.0, "num_agent_steps_sampled": {"default_agent": 5000.0}, "module_episode_returns_mean": {"default_policy": 1.8600000000000003}, "weights_seq_no": 7.0, "num_env_steps_sampled_lifetime": -3695000.0, "env_step_timer": 1.3811933309073928e-05, "num_episodes_lifetime": -184750.0, "env_to_module_sum_episodes_length_out": 10.36823839457432, "num_episodes": 250.0, "sample": 0.005120550130225684, "agent_episode_returns_mean": {"default_agent": 1.8600000000000003}, "env_to_module_sum_episodes_length_in": 10.36823839457432, "episode_len_max": 20, "episode_len_min": 20, "num_agent_steps_sampled_lifetime": {"default_agent": -3695000.0}, "num_env_steps_sampled_lifetime_throughput": 3714.66789165614}, "learners": {"default_policy": {"curr_entropy_coeff": 0.0090570820258, "weights_seq_no": 8.0, "gradients_default_optimizer_global_norm": 0.022608157247304916, "entropy": 0.6383119821548462, "num_module_steps_trained": 6000, "num_trainable_parameters": 6003, "policy_loss": -0.15572355687618256, "mean_kl_loss": 0.002607794012874365, "vf_loss": 0.10278083384037018, "module_train_batch_size_mean": 1000.0, "vf_explained_var": 0.002962470054626465, "diff_num_grad_updates_vs_sampler_policy": 1.0, "default_optimizer_learning_rate": 0.0002847858517, "num_module_steps_trained_lifetime": 48000, "vf_loss_unclipped": 27.20172691345215, "total_loss": -0.0927489772439003, "curr_kl_coeff": 0.0029160012491047382, "num_module_steps_trained_lifetime_throughput": 389845.8724069962}, "__all_modules__": {"learner_connector": {"connector_pipeline_timer": 0.08096539814476107, "timers": {"connectors": {"numpy_to_tensor": 7.476776380796646e-05, "add_one_ts_to_episodes_and_truncate": 0.0076274710795910345, "add_time_dim_to_batch_and_zero_pad": 1.2236938658141839e-05, "batch_individual_items": 0.03181271833268451, "general_advantage_estimation": 0.006525663271746558, "add_columns_from_episodes_to_train_batch": 0.03394979784497272, "add_states_from_episodes_to_batch": 3.3322090081362034e-06, "add_observations_from_episodes_to_batch": 0.0008350811365855952}}}, "num_module_steps_trained": 6000, "num_trainable_parameters": 6003, "learner_connector_sum_episodes_length_in": 5000.0, "num_module_steps_trained_lifetime": 48000, "num_non_trainable_parameters": 0, "num_env_steps_trained": 31500, "num_env_steps_trained_lifetime": 252000, "learner_connector_sum_episodes_length_out": 5250.0, "num_env_steps_trained_lifetime_throughput": 2037137.3386198038, "num_module_steps_trained_throughput": 389266.0231634965, "num_module_steps_trained_lifetime_throughput": 388795.1249425262}}, "num_training_step_calls_per_iteration": 1, "evaluation": {"env_runners": {"module_episode_returns_mean": {"default_policy": 0.95}, "env_to_module_connector": {"timers": {"connectors": {"add_observations_from_episodes_to_batch": 2.8191827934765215e-06, "numpy_to_tensor": 8.437003116412994e-06, "add_time_dim_to_batch_and_zero_pad": 2.31016807037535e-06, "batch_individual_items": 6.1885677083932855e-06, "add_states_from_episodes_to_batch": 1.5863263691440665e-06}}, "connector_pipeline_timer": 4.2668004821687726e-05}, "module_to_env_connector": {"timers": {"connectors": {"get_actions": 3.644098137744407e-05, "un_batch_to_individual_items": 5.375364050977211e-06, "listify_data_for_vector_env": 1.1183037620332875e-05, "normalize_and_clip_actions": 9.500141876425602e-06, "tensor_to_numpy": 1.2922260754893329e-05, "remove_single_ts_time_rank_from_batch": 5.833535261427386e-07}}, "connector_pipeline_timer": 0.0001014359816065946}, "num_env_steps_sampled": 400, "num_agent_steps_sampled_lifetime": {"default_agent": 3200}, "num_env_steps_sampled_lifetime": 40400, "num_module_steps_sampled": {"default_policy": 400}, "episode_len_max": 20, "episode_duration_sec_mean": 0.004521213313564658, "env_reset_timer": 0.0001355497281733468, "episode_return_max": 14.5, "agent_episode_returns_mean": {"default_agent": 0.95}, "num_episodes_lifetime": 160, "env_to_module_sum_episodes_length_in": 10.3682383945743, "episode_len_min": 20, "rlmodule_inference_timer": 2.7563890276130598e-05, "episode_return_mean": 0.95, "env_step_timer": 1.4386608070883184e-05, "env_to_module_sum_episodes_length_out": 10.3682383945743, "num_episodes": 20, "num_agent_steps_sampled": {"default_agent": 400}, "episode_return_min": -14.5, "episode_len_mean": 20.0, "weights_seq_no": 8.0, "num_module_steps_sampled_lifetime": {"default_policy": 3200}, "sample": 0.0985048897815216, "time_between_sampling": 1.5844356439169276}, "num_healthy_workers": 1, "actor_manager_num_outstanding_async_reqs": 0, "num_remote_worker_restarts": 0}, "num_env_steps_sampled_lifetime": -3695000.0, "fault_tolerance": {"num_healthy_workers": 0, "num_remote_worker_restarts": 0}, "env_runner_group": {"actor_manager_num_outstanding_async_reqs": 0}, "done": false, "training_iteration": 8, "trial_id": "4666f_00000", "date": "2025-08-11_19-23-53", "timestamp": 1754933033, "time_this_iter_s": 1.670788049697876, "time_total_s": 13.141361236572266, "pid": 14463, "hostname": "Mac", "node_ip": "127.0.0.1", "config": {"exploration_config": {}, "extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "placement_strategy": "PACK", "num_gpus": 0, "_fake_gpus": false, "num_cpus_for_main_process": 2, "eager_tracing": true, "eager_max_retraces": 20, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "torch_compile_learner": false, "torch_compile_learner_what_to_compile": "forward_train", "torch_compile_learner_dynamo_backend": "aot_eager", "torch_compile_learner_dynamo_mode": null, "torch_compile_worker": false, "torch_compile_worker_dynamo_backend": "aot_eager", "torch_compile_worker_dynamo_mode": null, "torch_ddp_kwargs": {}, "torch_skip_nan_gradients": false, "env": "Umbrella", "env_config": {}, "observation_space": null, "action_space": null, "clip_rewards": null, "normalize_actions": true, "clip_actions": false, "_is_atari": null, "disable_env_checking": false, "render_env": false, "action_mask_key": "action_mask", "env_runner_cls": null, "num_env_runners": 0, "create_local_env_runner": true, "num_envs_per_env_runner": 1, "gym_env_vectorize_mode": "SYNC", "num_cpus_per_env_runner": 1, "num_gpus_per_env_runner": 0, "custom_resources_per_env_runner": {}, "validate_env_runners_after_construction": true, "episodes_to_numpy": true, "max_requests_in_flight_per_env_runner": 1, "sample_timeout_s": 60.0, "_env_to_module_connector": null, "add_default_connectors_to_env_to_module_pipeline": true, "_module_to_env_connector": null, "add_default_connectors_to_module_to_env_pipeline": true, "merge_env_runner_states": "training_only", "broadcast_env_runner_states": true, "episode_lookback_horizon": 1, "rollout_fragment_length": "auto", "batch_mode": "complete_episodes", "compress_observations": false, "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "enable_tf1_exec_eagerly": false, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "preprocessor_pref": "deepmind", "observation_filter": "NoFilter", "update_worker_filter_stats": true, "use_worker_filter_stats": true, "sampler_perf_stats_ema_coef": null, "_is_online": true, "num_learners": 0, "num_gpus_per_learner": 0, "num_cpus_per_learner": "auto", "num_aggregator_actors_per_learner": 0, "max_requests_in_flight_per_aggregator_actor": 3, "local_gpu_idx": 0, "max_requests_in_flight_per_learner": 3, "gamma": 1, "lr": 0.0002847858517, "grad_clip": 0.5, "grad_clip_by": "global_norm", "_train_batch_size_per_learner": 5000, "train_batch_size": 4000, "num_epochs": 1, "minibatch_size": 1000, "shuffle_batch_per_epoch": true, "model": {"fcnet_hiddens": [256, 256], "fcnet_activation": "tanh", "fcnet_weights_initializer": null, "fcnet_weights_initializer_config": null, "fcnet_bias_initializer": null, "fcnet_bias_initializer_config": null, "conv_filters": null, "conv_activation": "relu", "conv_kernel_initializer": null, "conv_kernel_initializer_config": null, "conv_bias_initializer": null, "conv_bias_initializer_config": null, "conv_transpose_kernel_initializer": null, "conv_transpose_kernel_initializer_config": null, "conv_transpose_bias_initializer": null, "conv_transpose_bias_initializer_config": null, "post_fcnet_hiddens": [], "post_fcnet_activation": "relu", "post_fcnet_weights_initializer": null, "post_fcnet_weights_initializer_config": null, "post_fcnet_bias_initializer": null, "post_fcnet_bias_initializer_config": null, "free_log_std": false, "log_std_clip_param": 20.0, "no_final_linear": false, "vf_share_layers": false, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "lstm_weights_initializer": null, "lstm_weights_initializer_config": null, "lstm_bias_initializer": null, "lstm_bias_initializer_config": null, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "attention_use_n_prev_actions": 0, "attention_use_n_prev_rewards": 0, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": null, "custom_model_config": {}, "custom_action_dist": null, "custom_preprocessor": null, "encoder_latent_dim": null, "always_check_shapes": false, "lstm_use_prev_action_reward": -1, "_use_default_native_models": -1, "_disable_preprocessor_api": false, "_disable_action_flattening": false}, "_learner_connector": null, "add_default_connectors_to_learner_pipeline": true, "learner_config_dict": {}, "optimizer": {}, "_learner_class": null, "callbacks_on_algorithm_init": null, "callbacks_on_env_runners_recreated": null, "callbacks_on_offline_eval_runners_recreated": null, "callbacks_on_checkpoint_loaded": null, "callbacks_on_environment_created": null, "callbacks_on_episode_created": null, "callbacks_on_episode_start": null, "callbacks_on_episode_step": null, "callbacks_on_episode_end": null, "callbacks_on_evaluate_start": null, "callbacks_on_evaluate_end": null, "callbacks_on_evaluate_offline_start": null, "callbacks_on_evaluate_offline_end": null, "callbacks_on_sample_end": null, "callbacks_on_train_result": null, "explore": true, "enable_rl_module_and_learner": true, "enable_env_runner_and_connector_v2": true, "_prior_exploration_config": {"type": "StochasticSampling"}, "count_steps_by": "env_steps", "policy_map_capacity": 100, "policy_mapping_fn": "<function AlgorithmConfig.DEFAULT_POLICY_MAPPING_FN at 0x1551edb20>", "policies_to_train": null, "policy_states_are_swappable": false, "observation_fn": null, "offline_data_class": null, "input_read_method": "read_parquet", "input_read_method_kwargs": {}, "input_read_schema": {}, "input_read_episodes": false, "input_read_sample_batches": false, "input_read_batch_size": null, "input_filesystem": null, "input_filesystem_kwargs": {}, "input_compress_columns": ["obs", "new_obs"], "input_spaces_jsonable": true, "materialize_data": false, "materialize_mapped_data": true, "map_batches_kwargs": {}, "iter_batches_kwargs": {}, "ignore_final_observation": false, "prelearner_class": null, "prelearner_buffer_class": null, "prelearner_buffer_kwargs": {}, "prelearner_module_synch_period": 10, "dataset_num_iters_per_learner": null, "input_config": {}, "actions_in_input_normalized": false, "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_config": {}, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "output_max_rows_per_file": null, "output_write_remaining_data": false, "output_write_method": "write_parquet", "output_write_method_kwargs": {}, "output_filesystem": null, "output_filesystem_kwargs": {}, "output_write_episodes": true, "offline_sampling": false, "evaluation_interval": 1, "evaluation_duration": 20, "evaluation_duration_unit": "episodes", "evaluation_sample_timeout_s": 120.0, "evaluation_auto_duration_min_env_steps_per_sample": 100, "evaluation_auto_duration_max_env_steps_per_sample": 2000, "evaluation_parallel_to_training": false, "evaluation_force_reset_envs_before_iteration": true, "evaluation_config": null, "off_policy_estimation_methods": {}, "ope_split_batch_by_episode": true, "evaluation_num_env_runners": 1, "in_evaluation": false, "sync_filters_on_rollout_workers_timeout_s": 10.0, "offline_evaluation_interval": null, "num_offline_eval_runners": 0, "offline_loss_for_module_fn": null, "offline_evaluation_duration": 1, "offline_evaluation_parallel_to_training": false, "offline_evaluation_timeout_s": 120.0, "num_cpus_per_offline_eval_runner": 1, "num_gpus_per_offline_eval_runner": 0, "custom_resources_per_offline_eval_runner": {}, "restart_failed_offline_eval_runners": true, "ignore_offline_eval_runner_failures": false, "max_num_offline_eval_runner_restarts": 1000, "offline_eval_runner_restore_timeout_s": 1800.0, "max_requests_in_flight_per_offline_eval_runner": 1, "validate_offline_eval_runners_after_construction": true, "offline_eval_runner_health_probe_timeout_s": 30.0, "offline_eval_rl_module_inference_only": false, "broadcast_offline_eval_runner_states": false, "offline_eval_batch_size_per_runner": 256, "dataset_num_iters_per_eval_runner": 1, "keep_per_episode_custom_metrics": false, "metrics_episode_collection_timeout_s": 60.0, "metrics_num_episodes_for_smoothing": 100, "min_time_s_per_iteration": null, "min_train_timesteps_per_iteration": 0, "min_sample_timesteps_per_iteration": 0, "log_gradients": true, "export_native_model_files": false, "checkpoint_trainable_policies_only": false, "logger_creator": null, "logger_config": null, "log_level": "WARN", "log_sys_usage": true, "fake_sampler": false, "seed": 8, "restart_failed_env_runners": true, "ignore_env_runner_failures": false, "max_num_env_runner_restarts": 1000, "delay_between_env_runner_restarts_s": 60.0, "restart_failed_sub_environments": false, "num_consecutive_env_runner_failures_tolerance": 100, "env_runner_health_probe_timeout_s": 30.0, "env_runner_restore_timeout_s": 1800.0, "_model_config": {}, "_rl_module_spec": "RLModuleSpec(module_class=None, observation_space=None, action_space=None, inference_only=False, learner_only=False, model_config=DefaultModelConfig(fcnet_hiddens=[60, 90], fcnet_activation='tanh', fcnet_kernel_initializer=None, fcnet_kernel_initializer_kwargs=None, fcnet_bias_initializer=None, fcnet_bias_initializer_kwargs=None, conv_filters=None, conv_activation='relu', conv_kernel_initializer=None, conv_kernel_initializer_kwargs=None, conv_bias_initializer=None, conv_bias_initializer_kwargs=None, head_fcnet_hiddens=[], head_fcnet_activation='relu', head_fcnet_kernel_initializer=None, head_fcnet_kernel_initializer_kwargs=None, head_fcnet_bias_initializer=None, head_fcnet_bias_initializer_kwargs=None, free_log_std=False, log_std_clip_param=20.0, vf_share_layers=True, use_lstm=False, max_seq_len=20, lstm_cell_size=256, lstm_use_prev_action=False, lstm_use_prev_reward=False, lstm_kernel_initializer=None, lstm_kernel_initializer_kwargs=None, lstm_bias_initializer=None, lstm_bias_initializer_kwargs=None), catalog_class=None, load_state_path=None, model_config_dict=None)", "algorithm_config_overrides_per_module": {}, "_per_module_overrides": {}, "_validate_config": true, "_use_msgpack_checkpoints": false, "_torch_grad_scaler_class": null, "_torch_lr_scheduler_classes": null, "_tf_policy_handles_more_than_one_loss": false, "_disable_preprocessor_api": false, "_disable_action_flattening": false, "_disable_initialize_loss_from_dummy_batch": false, "_dont_auto_sync_env_runner_states": false, "env_task_fn": -1, "enable_connectors": -1, "simple_optimizer": false, "policy_map_cache": -1, "worker_cls": -1, "synchronize_filters": -1, "enable_async_evaluation": -1, "custom_async_evaluation_function": -1, "_enable_rl_module_api": -1, "auto_wrap_old_gym_envs": -1, "always_attach_evaluation_results": -1, "replay_sequence_length": null, "_disable_execution_plan_api": -1, "use_critic": true, "use_gae": true, "use_kl_loss": true, "kl_coeff": 0.7464963036515, "kl_target": 0.0270990929592, "vf_loss_coeff": 0.6688075857018, "entropy_coeff": 0.0090570820258, "clip_param": 0.1221781641624, "vf_clip_param": 0.1027808522125, "entropy_coeff_schedule": null, "lr_schedule": null, "sgd_minibatch_size": -1, "vf_share_layers": -1, "__stdout_file__": null, "__stderr_file__": null, "lambda": 0.9099046732075, "input": "sampler", "policies": {"default_policy": [null, null, null, null]}, "callbacks": "<class 'ray.rllib.callbacks.callbacks.RLlibCallback'>", "create_env_on_driver": false, "custom_eval_function": null, "framework": "torch"}, "time_since_restore": 13.141361236572266, "iterations_since_restore": 8, "perf": {"cpu_util_percent": 42.1, "ram_util_percent": 77.15}}
{"timers": {"training_iteration": 1.5558363118495837, "restore_env_runners": 1.1093483215038221e-05, "training_step": 1.5557133088877158, "env_runner_sampling_timer": 1.4463187094254846, "learner_update_timer": 0.10646163050368088, "synch_weights": 0.0005535882419713152, "restore_eval_env_runners": 8.264313228136134e-06, "evaluation_iteration": 0.10457838573517705, "synch_eval_env_connectors": 0.00014067506397802854, "synch_env_connectors": 4.803949653943362e-06}, "env_runners": {"module_to_env_connector": {"timers": {"connectors": {"remove_single_ts_time_rank_from_batch": 5.647754523946407e-07, "un_batch_to_individual_items": 5.307756602020166e-06, "normalize_and_clip_actions": 9.384169697043615e-06, "get_actions": 3.832241270132695e-05, "listify_data_for_vector_env": 1.0959522083534233e-05, "tensor_to_numpy": 1.3054727180508197e-05}}, "connector_pipeline_timer": 0.00010315050348218574}, "episode_duration_sec_mean": 0.004517443821765484, "env_to_module_connector": {"timers": {"connectors": {"add_time_dim_to_batch_and_zero_pad": 2.348141665753112e-06, "numpy_to_tensor": 8.428028785996337e-06, "batch_individual_items": 6.101660443610969e-06, "add_observations_from_episodes_to_batch": 2.9628220259975448e-06, "add_states_from_episodes_to_batch": 1.7397092248770425e-06}}, "connector_pipeline_timer": 4.3158712831064076e-05}, "env_reset_timer": 3.415959764635665e-05, "episode_return_min": -11.5, "episode_return_max": 8.5, "rlmodule_inference_timer": 2.8221442059919377e-05, "time_between_sampling": 0.0015273841097141608, "num_module_steps_sampled": {"default_policy": 5000.0}, "num_module_steps_sampled_lifetime": {"default_policy": -4312500.0}, "episode_len_mean": 20.0, "episode_return_mean": 3.4599999999999995, "num_env_steps_sampled": 5000.0, "num_agent_steps_sampled": {"default_agent": 5000.0}, "module_episode_returns_mean": {"default_policy": 3.4599999999999995}, "weights_seq_no": 8.0, "num_env_steps_sampled_lifetime": -4312500.0, "env_step_timer": 1.3671077487683398e-05, "num_episodes_lifetime": -215625.0, "env_to_module_sum_episodes_length_out": 10.36823839457432, "num_episodes": 250.0, "sample": 0.004903715229068599, "agent_episode_returns_mean": {"default_agent": 3.4599999999999995}, "env_to_module_sum_episodes_length_in": 10.36823839457432, "episode_len_max": 20, "episode_len_min": 20, "num_agent_steps_sampled_lifetime": {"default_agent": -4312500.0}, "num_env_steps_sampled_lifetime_throughput": 3750.149297644151}, "learners": {"default_policy": {"curr_entropy_coeff": 0.0090570820258, "weights_seq_no": 9.0, "gradients_default_optimizer_global_norm": 0.027868833392858505, "entropy": 0.6128119826316833, "num_module_steps_trained": 6000, "num_trainable_parameters": 6003, "policy_loss": -0.11399688571691513, "mean_kl_loss": 0.002018766012042761, "vf_loss": 0.10278083384037018, "module_train_batch_size_mean": 1000.0, "vf_explained_var": 0.002911388874053955, "diff_num_grad_updates_vs_sampler_policy": 1.0, "default_optimizer_learning_rate": 0.0002847858517, "num_module_steps_trained_lifetime": 54000, "vf_loss_unclipped": 26.992969512939453, "total_loss": -0.050800688564777374, "curr_kl_coeff": 0.0014580006245523691, "num_module_steps_trained_lifetime_throughput": 390932.0726672487}, "__all_modules__": {"learner_connector": {"connector_pipeline_timer": 0.08185468999272542, "timers": {"connectors": {"numpy_to_tensor": 7.470425668795725e-05, "add_one_ts_to_episodes_and_truncate": 0.008531501789029923, "add_time_dim_to_batch_and_zero_pad": 1.2212909950520506e-05, "batch_individual_items": 0.031805686149136675, "general_advantage_estimation": 0.006512246228170401, "add_columns_from_episodes_to_train_batch": 0.03395566861738205, "add_states_from_episodes_to_batch": 3.328466887177847e-06, "add_observations_from_episodes_to_batch": 0.0008352244958351887}}}, "num_module_steps_trained": 6000, "num_trainable_parameters": 6003, "learner_connector_sum_episodes_length_in": 5000.0, "num_module_steps_trained_lifetime": 54000, "num_non_trainable_parameters": 0, "num_env_steps_trained": 31500, "num_env_steps_trained_lifetime": 283500, "learner_connector_sum_episodes_length_out": 5250.0, "num_env_steps_trained_lifetime_throughput": 2043375.3647134053, "num_module_steps_trained_throughput": 390408.9424837313, "num_module_steps_trained_lifetime_throughput": 389951.58588906855}}, "num_training_step_calls_per_iteration": 1, "evaluation": {"env_runners": {"module_episode_returns_mean": {"default_policy": 1.95}, "env_to_module_connector": {"timers": {"connectors": {"add_observations_from_episodes_to_batch": 2.7592812323786132e-06, "numpy_to_tensor": 8.081630499643729e-06, "add_time_dim_to_batch_and_zero_pad": 2.2791756820004843e-06, "batch_individual_items": 5.962711647064511e-06, "add_states_from_episodes_to_batch": 1.5985971693163982e-06}}, "connector_pipeline_timer": 4.156489251414857e-05}, "module_to_env_connector": {"timers": {"connectors": {"get_actions": 3.498181366639335e-05, "un_batch_to_individual_items": 5.218489662124705e-06, "listify_data_for_vector_env": 1.0729560247739478e-05, "normalize_and_clip_actions": 9.106945454719145e-06, "tensor_to_numpy": 1.2534692239299229e-05, "remove_single_ts_time_rank_from_batch": 5.690866023646928e-07}}, "connector_pipeline_timer": 9.781109053454125e-05}, "num_env_steps_sampled": 400, "num_agent_steps_sampled_lifetime": {"default_agent": 3600}, "num_env_steps_sampled_lifetime": 45400, "num_module_steps_sampled": {"default_policy": 400}, "episode_len_max": 20, "episode_duration_sec_mean": 0.004508932481985539, "env_reset_timer": 0.00013488881126776152, "episode_return_max": 14.5, "agent_episode_returns_mean": {"default_agent": 1.95}, "num_episodes_lifetime": 180, "env_to_module_sum_episodes_length_in": 10.368238394574323, "episode_len_min": 20, "rlmodule_inference_timer": 2.6730853572287843e-05, "episode_return_mean": 1.95, "env_step_timer": 1.3695219950312216e-05, "env_to_module_sum_episodes_length_out": 10.368238394574323, "num_episodes": 20, "num_agent_steps_sampled": {"default_agent": 400}, "episode_return_min": -14.5, "episode_len_mean": 20.0, "weights_seq_no": 9.0, "num_module_steps_sampled_lifetime": {"default_policy": 3600}, "sample": 0.09848624088374028, "time_between_sampling": 1.5843355074775187}, "num_healthy_workers": 1, "actor_manager_num_outstanding_async_reqs": 0, "num_remote_worker_restarts": 0}, "num_env_steps_sampled_lifetime": -4312500.0, "fault_tolerance": {"num_healthy_workers": 0, "num_remote_worker_restarts": 0}, "env_runner_group": {"actor_manager_num_outstanding_async_reqs": 0}, "done": false, "training_iteration": 9, "trial_id": "4666f_00000", "date": "2025-08-11_19-23-54", "timestamp": 1754933034, "time_this_iter_s": 1.6578092575073242, "time_total_s": 14.79917049407959, "pid": 14463, "hostname": "Mac", "node_ip": "127.0.0.1", "config": {"exploration_config": {}, "extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "placement_strategy": "PACK", "num_gpus": 0, "_fake_gpus": false, "num_cpus_for_main_process": 2, "eager_tracing": true, "eager_max_retraces": 20, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "torch_compile_learner": false, "torch_compile_learner_what_to_compile": "forward_train", "torch_compile_learner_dynamo_backend": "aot_eager", "torch_compile_learner_dynamo_mode": null, "torch_compile_worker": false, "torch_compile_worker_dynamo_backend": "aot_eager", "torch_compile_worker_dynamo_mode": null, "torch_ddp_kwargs": {}, "torch_skip_nan_gradients": false, "env": "Umbrella", "env_config": {}, "observation_space": null, "action_space": null, "clip_rewards": null, "normalize_actions": true, "clip_actions": false, "_is_atari": null, "disable_env_checking": false, "render_env": false, "action_mask_key": "action_mask", "env_runner_cls": null, "num_env_runners": 0, "create_local_env_runner": true, "num_envs_per_env_runner": 1, "gym_env_vectorize_mode": "SYNC", "num_cpus_per_env_runner": 1, "num_gpus_per_env_runner": 0, "custom_resources_per_env_runner": {}, "validate_env_runners_after_construction": true, "episodes_to_numpy": true, "max_requests_in_flight_per_env_runner": 1, "sample_timeout_s": 60.0, "_env_to_module_connector": null, "add_default_connectors_to_env_to_module_pipeline": true, "_module_to_env_connector": null, "add_default_connectors_to_module_to_env_pipeline": true, "merge_env_runner_states": "training_only", "broadcast_env_runner_states": true, "episode_lookback_horizon": 1, "rollout_fragment_length": "auto", "batch_mode": "complete_episodes", "compress_observations": false, "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "enable_tf1_exec_eagerly": false, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "preprocessor_pref": "deepmind", "observation_filter": "NoFilter", "update_worker_filter_stats": true, "use_worker_filter_stats": true, "sampler_perf_stats_ema_coef": null, "_is_online": true, "num_learners": 0, "num_gpus_per_learner": 0, "num_cpus_per_learner": "auto", "num_aggregator_actors_per_learner": 0, "max_requests_in_flight_per_aggregator_actor": 3, "local_gpu_idx": 0, "max_requests_in_flight_per_learner": 3, "gamma": 1, "lr": 0.0002847858517, "grad_clip": 0.5, "grad_clip_by": "global_norm", "_train_batch_size_per_learner": 5000, "train_batch_size": 4000, "num_epochs": 1, "minibatch_size": 1000, "shuffle_batch_per_epoch": true, "model": {"fcnet_hiddens": [256, 256], "fcnet_activation": "tanh", "fcnet_weights_initializer": null, "fcnet_weights_initializer_config": null, "fcnet_bias_initializer": null, "fcnet_bias_initializer_config": null, "conv_filters": null, "conv_activation": "relu", "conv_kernel_initializer": null, "conv_kernel_initializer_config": null, "conv_bias_initializer": null, "conv_bias_initializer_config": null, "conv_transpose_kernel_initializer": null, "conv_transpose_kernel_initializer_config": null, "conv_transpose_bias_initializer": null, "conv_transpose_bias_initializer_config": null, "post_fcnet_hiddens": [], "post_fcnet_activation": "relu", "post_fcnet_weights_initializer": null, "post_fcnet_weights_initializer_config": null, "post_fcnet_bias_initializer": null, "post_fcnet_bias_initializer_config": null, "free_log_std": false, "log_std_clip_param": 20.0, "no_final_linear": false, "vf_share_layers": false, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "lstm_weights_initializer": null, "lstm_weights_initializer_config": null, "lstm_bias_initializer": null, "lstm_bias_initializer_config": null, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "attention_use_n_prev_actions": 0, "attention_use_n_prev_rewards": 0, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": null, "custom_model_config": {}, "custom_action_dist": null, "custom_preprocessor": null, "encoder_latent_dim": null, "always_check_shapes": false, "lstm_use_prev_action_reward": -1, "_use_default_native_models": -1, "_disable_preprocessor_api": false, "_disable_action_flattening": false}, "_learner_connector": null, "add_default_connectors_to_learner_pipeline": true, "learner_config_dict": {}, "optimizer": {}, "_learner_class": null, "callbacks_on_algorithm_init": null, "callbacks_on_env_runners_recreated": null, "callbacks_on_offline_eval_runners_recreated": null, "callbacks_on_checkpoint_loaded": null, "callbacks_on_environment_created": null, "callbacks_on_episode_created": null, "callbacks_on_episode_start": null, "callbacks_on_episode_step": null, "callbacks_on_episode_end": null, "callbacks_on_evaluate_start": null, "callbacks_on_evaluate_end": null, "callbacks_on_evaluate_offline_start": null, "callbacks_on_evaluate_offline_end": null, "callbacks_on_sample_end": null, "callbacks_on_train_result": null, "explore": true, "enable_rl_module_and_learner": true, "enable_env_runner_and_connector_v2": true, "_prior_exploration_config": {"type": "StochasticSampling"}, "count_steps_by": "env_steps", "policy_map_capacity": 100, "policy_mapping_fn": "<function AlgorithmConfig.DEFAULT_POLICY_MAPPING_FN at 0x1551edb20>", "policies_to_train": null, "policy_states_are_swappable": false, "observation_fn": null, "offline_data_class": null, "input_read_method": "read_parquet", "input_read_method_kwargs": {}, "input_read_schema": {}, "input_read_episodes": false, "input_read_sample_batches": false, "input_read_batch_size": null, "input_filesystem": null, "input_filesystem_kwargs": {}, "input_compress_columns": ["obs", "new_obs"], "input_spaces_jsonable": true, "materialize_data": false, "materialize_mapped_data": true, "map_batches_kwargs": {}, "iter_batches_kwargs": {}, "ignore_final_observation": false, "prelearner_class": null, "prelearner_buffer_class": null, "prelearner_buffer_kwargs": {}, "prelearner_module_synch_period": 10, "dataset_num_iters_per_learner": null, "input_config": {}, "actions_in_input_normalized": false, "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_config": {}, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "output_max_rows_per_file": null, "output_write_remaining_data": false, "output_write_method": "write_parquet", "output_write_method_kwargs": {}, "output_filesystem": null, "output_filesystem_kwargs": {}, "output_write_episodes": true, "offline_sampling": false, "evaluation_interval": 1, "evaluation_duration": 20, "evaluation_duration_unit": "episodes", "evaluation_sample_timeout_s": 120.0, "evaluation_auto_duration_min_env_steps_per_sample": 100, "evaluation_auto_duration_max_env_steps_per_sample": 2000, "evaluation_parallel_to_training": false, "evaluation_force_reset_envs_before_iteration": true, "evaluation_config": null, "off_policy_estimation_methods": {}, "ope_split_batch_by_episode": true, "evaluation_num_env_runners": 1, "in_evaluation": false, "sync_filters_on_rollout_workers_timeout_s": 10.0, "offline_evaluation_interval": null, "num_offline_eval_runners": 0, "offline_loss_for_module_fn": null, "offline_evaluation_duration": 1, "offline_evaluation_parallel_to_training": false, "offline_evaluation_timeout_s": 120.0, "num_cpus_per_offline_eval_runner": 1, "num_gpus_per_offline_eval_runner": 0, "custom_resources_per_offline_eval_runner": {}, "restart_failed_offline_eval_runners": true, "ignore_offline_eval_runner_failures": false, "max_num_offline_eval_runner_restarts": 1000, "offline_eval_runner_restore_timeout_s": 1800.0, "max_requests_in_flight_per_offline_eval_runner": 1, "validate_offline_eval_runners_after_construction": true, "offline_eval_runner_health_probe_timeout_s": 30.0, "offline_eval_rl_module_inference_only": false, "broadcast_offline_eval_runner_states": false, "offline_eval_batch_size_per_runner": 256, "dataset_num_iters_per_eval_runner": 1, "keep_per_episode_custom_metrics": false, "metrics_episode_collection_timeout_s": 60.0, "metrics_num_episodes_for_smoothing": 100, "min_time_s_per_iteration": null, "min_train_timesteps_per_iteration": 0, "min_sample_timesteps_per_iteration": 0, "log_gradients": true, "export_native_model_files": false, "checkpoint_trainable_policies_only": false, "logger_creator": null, "logger_config": null, "log_level": "WARN", "log_sys_usage": true, "fake_sampler": false, "seed": 8, "restart_failed_env_runners": true, "ignore_env_runner_failures": false, "max_num_env_runner_restarts": 1000, "delay_between_env_runner_restarts_s": 60.0, "restart_failed_sub_environments": false, "num_consecutive_env_runner_failures_tolerance": 100, "env_runner_health_probe_timeout_s": 30.0, "env_runner_restore_timeout_s": 1800.0, "_model_config": {}, "_rl_module_spec": "RLModuleSpec(module_class=None, observation_space=None, action_space=None, inference_only=False, learner_only=False, model_config=DefaultModelConfig(fcnet_hiddens=[60, 90], fcnet_activation='tanh', fcnet_kernel_initializer=None, fcnet_kernel_initializer_kwargs=None, fcnet_bias_initializer=None, fcnet_bias_initializer_kwargs=None, conv_filters=None, conv_activation='relu', conv_kernel_initializer=None, conv_kernel_initializer_kwargs=None, conv_bias_initializer=None, conv_bias_initializer_kwargs=None, head_fcnet_hiddens=[], head_fcnet_activation='relu', head_fcnet_kernel_initializer=None, head_fcnet_kernel_initializer_kwargs=None, head_fcnet_bias_initializer=None, head_fcnet_bias_initializer_kwargs=None, free_log_std=False, log_std_clip_param=20.0, vf_share_layers=True, use_lstm=False, max_seq_len=20, lstm_cell_size=256, lstm_use_prev_action=False, lstm_use_prev_reward=False, lstm_kernel_initializer=None, lstm_kernel_initializer_kwargs=None, lstm_bias_initializer=None, lstm_bias_initializer_kwargs=None), catalog_class=None, load_state_path=None, model_config_dict=None)", "algorithm_config_overrides_per_module": {}, "_per_module_overrides": {}, "_validate_config": true, "_use_msgpack_checkpoints": false, "_torch_grad_scaler_class": null, "_torch_lr_scheduler_classes": null, "_tf_policy_handles_more_than_one_loss": false, "_disable_preprocessor_api": false, "_disable_action_flattening": false, "_disable_initialize_loss_from_dummy_batch": false, "_dont_auto_sync_env_runner_states": false, "env_task_fn": -1, "enable_connectors": -1, "simple_optimizer": false, "policy_map_cache": -1, "worker_cls": -1, "synchronize_filters": -1, "enable_async_evaluation": -1, "custom_async_evaluation_function": -1, "_enable_rl_module_api": -1, "auto_wrap_old_gym_envs": -1, "always_attach_evaluation_results": -1, "replay_sequence_length": null, "_disable_execution_plan_api": -1, "use_critic": true, "use_gae": true, "use_kl_loss": true, "kl_coeff": 0.7464963036515, "kl_target": 0.0270990929592, "vf_loss_coeff": 0.6688075857018, "entropy_coeff": 0.0090570820258, "clip_param": 0.1221781641624, "vf_clip_param": 0.1027808522125, "entropy_coeff_schedule": null, "lr_schedule": null, "sgd_minibatch_size": -1, "vf_share_layers": -1, "__stdout_file__": null, "__stderr_file__": null, "lambda": 0.9099046732075, "input": "sampler", "policies": {"default_policy": [null, null, null, null]}, "callbacks": "<class 'ray.rllib.callbacks.callbacks.RLlibCallback'>", "create_env_on_driver": false, "custom_eval_function": null, "framework": "torch"}, "time_since_restore": 14.79917049407959, "iterations_since_restore": 9, "perf": {"cpu_util_percent": 50.333333333333336, "ram_util_percent": 77.86666666666666}}
{"timers": {"training_iteration": 1.5558781370613692, "restore_env_runners": 1.1039218197399971e-05, "training_step": 1.5557546887182254, "env_runner_sampling_timer": 1.4456035777506486, "learner_update_timer": 0.10721635169913618, "synch_weights": 0.000553870689070263, "restore_eval_env_runners": 8.245000030928625e-06, "evaluation_iteration": 0.10454527437804448, "synch_eval_env_connectors": 0.00014017039354817404, "synch_env_connectors": 4.79632955714224e-06}, "env_runners": {"module_to_env_connector": {"timers": {"connectors": {"remove_single_ts_time_rank_from_batch": 5.662415693055583e-07, "un_batch_to_individual_items": 5.33062569744036e-06, "normalize_and_clip_actions": 9.432904419472303e-06, "get_actions": 3.85014181207848e-05, "listify_data_for_vector_env": 1.0988285802126225e-05, "tensor_to_numpy": 1.3061266018716169e-05}}, "connector_pipeline_timer": 0.0001035076851630469}, "episode_duration_sec_mean": 0.0045303294849582, "env_to_module_connector": {"timers": {"connectors": {"add_time_dim_to_batch_and_zero_pad": 2.3681585013303117e-06, "numpy_to_tensor": 8.466531165364146e-06, "batch_individual_items": 6.134629362415021e-06, "add_observations_from_episodes_to_batch": 3.0285937457199227e-06, "add_states_from_episodes_to_batch": 1.741676046326089e-06}}, "connector_pipeline_timer": 4.3410870530077405e-05}, "env_reset_timer": 3.322294138560673e-05, "episode_return_min": -11.5, "episode_return_max": 8.5, "rlmodule_inference_timer": 2.780402924891116e-05, "time_between_sampling": 0.0018148971751268891, "num_module_steps_sampled": {"default_policy": 5000.0}, "num_module_steps_sampled_lifetime": {"default_policy": -4930000.0}, "episode_len_mean": 20.0, "episode_return_mean": 3.4599999999999995, "num_env_steps_sampled": 5000.0, "num_agent_steps_sampled": {"default_agent": 5000.0}, "module_episode_returns_mean": {"default_policy": 3.4599999999999995}, "weights_seq_no": 9.0, "num_env_steps_sampled_lifetime": -4930000.0, "env_step_timer": 1.3717741643084855e-05, "num_episodes_lifetime": -246500.0, "env_to_module_sum_episodes_length_out": 10.36823839457432, "num_episodes": 250.0, "sample": 0.004838214791193808, "agent_episode_returns_mean": {"default_agent": 3.4599999999999995}, "env_to_module_sum_episodes_length_in": 10.36823839457432, "episode_len_max": 20, "episode_len_min": 20, "num_agent_steps_sampled_lifetime": {"default_agent": -4930000.0}, "num_env_steps_sampled_lifetime_throughput": 3744.637598321502}, "learners": {"default_policy": {"curr_entropy_coeff": 0.0090570820258, "weights_seq_no": 10.0, "gradients_default_optimizer_global_norm": 0.09449653327465057, "entropy": 0.581646203994751, "num_module_steps_trained": 6000, "num_trainable_parameters": 6003, "policy_loss": -0.2596895098686218, "mean_kl_loss": 0.0023036045022308826, "vf_loss": 0.10278083384037018, "module_train_batch_size_mean": 1000.0, "vf_explained_var": 0.002871870994567871, "diff_num_grad_updates_vs_sampler_policy": 1.0, "default_optimizer_learning_rate": 0.0002847858517, "num_module_steps_trained_lifetime": 60000, "vf_loss_unclipped": 26.41408920288086, "total_loss": -0.19621355831623077, "curr_kl_coeff": 0.0007290003122761846, "num_module_steps_trained_lifetime_throughput": 392198.9191860907}, "__all_modules__": {"learner_connector": {"connector_pipeline_timer": 0.08272108018224696, "timers": {"connectors": {"numpy_to_tensor": 7.458762404352846e-05, "add_one_ts_to_episodes_and_truncate": 0.008524679271027567, "add_time_dim_to_batch_and_zero_pad": 1.2179110976451488e-05, "batch_individual_items": 0.0326883130378575, "general_advantage_estimation": 0.006499645845674982, "add_columns_from_episodes_to_train_batch": 0.03395929651060484, "add_states_from_episodes_to_batch": 3.321851804383401e-06, "add_observations_from_episodes_to_batch": 0.0008352551703541358}}}, "num_module_steps_trained": 6000, "num_trainable_parameters": 6003, "learner_connector_sum_episodes_length_in": 5000.0, "num_module_steps_trained_lifetime": 60000, "num_non_trainable_parameters": 0, "num_env_steps_trained": 31500, "num_env_steps_trained_lifetime": 315000, "learner_connector_sum_episodes_length_out": 5250.0, "num_env_steps_trained_lifetime_throughput": 2050565.0311026417, "num_module_steps_trained_throughput": 391733.4171361689, "num_module_steps_trained_lifetime_throughput": 391289.325345646}}, "num_training_step_calls_per_iteration": 1, "evaluation": {"env_runners": {"module_episode_returns_mean": {"default_policy": 1.95}, "env_to_module_connector": {"timers": {"connectors": {"add_observations_from_episodes_to_batch": 2.757916571329998e-06, "numpy_to_tensor": 8.254970315781895e-06, "add_time_dim_to_batch_and_zero_pad": 2.281422690764876e-06, "batch_individual_items": 6.049944856685539e-06, "add_states_from_episodes_to_batch": 1.580347842351576e-06}}, "connector_pipeline_timer": 4.2114293360696965e-05}, "module_to_env_connector": {"timers": {"connectors": {"get_actions": 3.5148266815341905e-05, "un_batch_to_individual_items": 5.31599454611383e-06, "listify_data_for_vector_env": 1.0873229347198751e-05, "normalize_and_clip_actions": 9.352336683776602e-06, "tensor_to_numpy": 1.2630581843110933e-05, "remove_single_ts_time_rank_from_batch": 6.026180506884234e-07}}, "connector_pipeline_timer": 9.898076382579778e-05}, "num_env_steps_sampled": 400, "num_agent_steps_sampled_lifetime": {"default_agent": 4000}, "num_env_steps_sampled_lifetime": 50400, "num_module_steps_sampled": {"default_policy": 400}, "episode_len_max": 20, "episode_duration_sec_mean": 0.0045110716461203995, "env_reset_timer": 0.00013429659364312853, "episode_return_max": 14.5, "agent_episode_returns_mean": {"default_agent": 1.95}, "num_episodes_lifetime": 200, "env_to_module_sum_episodes_length_in": 10.368238394574323, "episode_len_min": 20, "rlmodule_inference_timer": 2.672865908506171e-05, "episode_return_mean": 1.95, "env_step_timer": 1.3992205292630847e-05, "env_to_module_sum_episodes_length_out": 10.368238394574323, "num_episodes": 20, "num_agent_steps_sampled": {"default_agent": 400}, "episode_return_min": -14.5, "episode_len_mean": 20.0, "weights_seq_no": 10.0, "num_module_steps_sampled_lifetime": {"default_policy": 4000}, "sample": 0.09847535805418767, "time_between_sampling": 1.5842655869928262}, "num_healthy_workers": 1, "actor_manager_num_outstanding_async_reqs": 0, "num_remote_worker_restarts": 0}, "num_env_steps_sampled_lifetime": -4930000.0, "fault_tolerance": {"num_healthy_workers": 0, "num_remote_worker_restarts": 0}, "env_runner_group": {"actor_manager_num_outstanding_async_reqs": 0}, "done": false, "training_iteration": 10, "trial_id": "4666f_00000", "date": "2025-08-11_19-23-56", "timestamp": 1754933036, "time_this_iter_s": 1.6642842292785645, "time_total_s": 16.463454723358154, "pid": 14463, "hostname": "Mac", "node_ip": "127.0.0.1", "config": {"exploration_config": {}, "extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "placement_strategy": "PACK", "num_gpus": 0, "_fake_gpus": false, "num_cpus_for_main_process": 2, "eager_tracing": true, "eager_max_retraces": 20, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "torch_compile_learner": false, "torch_compile_learner_what_to_compile": "forward_train", "torch_compile_learner_dynamo_backend": "aot_eager", "torch_compile_learner_dynamo_mode": null, "torch_compile_worker": false, "torch_compile_worker_dynamo_backend": "aot_eager", "torch_compile_worker_dynamo_mode": null, "torch_ddp_kwargs": {}, "torch_skip_nan_gradients": false, "env": "Umbrella", "env_config": {}, "observation_space": null, "action_space": null, "clip_rewards": null, "normalize_actions": true, "clip_actions": false, "_is_atari": null, "disable_env_checking": false, "render_env": false, "action_mask_key": "action_mask", "env_runner_cls": null, "num_env_runners": 0, "create_local_env_runner": true, "num_envs_per_env_runner": 1, "gym_env_vectorize_mode": "SYNC", "num_cpus_per_env_runner": 1, "num_gpus_per_env_runner": 0, "custom_resources_per_env_runner": {}, "validate_env_runners_after_construction": true, "episodes_to_numpy": true, "max_requests_in_flight_per_env_runner": 1, "sample_timeout_s": 60.0, "_env_to_module_connector": null, "add_default_connectors_to_env_to_module_pipeline": true, "_module_to_env_connector": null, "add_default_connectors_to_module_to_env_pipeline": true, "merge_env_runner_states": "training_only", "broadcast_env_runner_states": true, "episode_lookback_horizon": 1, "rollout_fragment_length": "auto", "batch_mode": "complete_episodes", "compress_observations": false, "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "enable_tf1_exec_eagerly": false, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "preprocessor_pref": "deepmind", "observation_filter": "NoFilter", "update_worker_filter_stats": true, "use_worker_filter_stats": true, "sampler_perf_stats_ema_coef": null, "_is_online": true, "num_learners": 0, "num_gpus_per_learner": 0, "num_cpus_per_learner": "auto", "num_aggregator_actors_per_learner": 0, "max_requests_in_flight_per_aggregator_actor": 3, "local_gpu_idx": 0, "max_requests_in_flight_per_learner": 3, "gamma": 1, "lr": 0.0002847858517, "grad_clip": 0.5, "grad_clip_by": "global_norm", "_train_batch_size_per_learner": 5000, "train_batch_size": 4000, "num_epochs": 1, "minibatch_size": 1000, "shuffle_batch_per_epoch": true, "model": {"fcnet_hiddens": [256, 256], "fcnet_activation": "tanh", "fcnet_weights_initializer": null, "fcnet_weights_initializer_config": null, "fcnet_bias_initializer": null, "fcnet_bias_initializer_config": null, "conv_filters": null, "conv_activation": "relu", "conv_kernel_initializer": null, "conv_kernel_initializer_config": null, "conv_bias_initializer": null, "conv_bias_initializer_config": null, "conv_transpose_kernel_initializer": null, "conv_transpose_kernel_initializer_config": null, "conv_transpose_bias_initializer": null, "conv_transpose_bias_initializer_config": null, "post_fcnet_hiddens": [], "post_fcnet_activation": "relu", "post_fcnet_weights_initializer": null, "post_fcnet_weights_initializer_config": null, "post_fcnet_bias_initializer": null, "post_fcnet_bias_initializer_config": null, "free_log_std": false, "log_std_clip_param": 20.0, "no_final_linear": false, "vf_share_layers": false, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "lstm_weights_initializer": null, "lstm_weights_initializer_config": null, "lstm_bias_initializer": null, "lstm_bias_initializer_config": null, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "attention_use_n_prev_actions": 0, "attention_use_n_prev_rewards": 0, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": null, "custom_model_config": {}, "custom_action_dist": null, "custom_preprocessor": null, "encoder_latent_dim": null, "always_check_shapes": false, "lstm_use_prev_action_reward": -1, "_use_default_native_models": -1, "_disable_preprocessor_api": false, "_disable_action_flattening": false}, "_learner_connector": null, "add_default_connectors_to_learner_pipeline": true, "learner_config_dict": {}, "optimizer": {}, "_learner_class": null, "callbacks_on_algorithm_init": null, "callbacks_on_env_runners_recreated": null, "callbacks_on_offline_eval_runners_recreated": null, "callbacks_on_checkpoint_loaded": null, "callbacks_on_environment_created": null, "callbacks_on_episode_created": null, "callbacks_on_episode_start": null, "callbacks_on_episode_step": null, "callbacks_on_episode_end": null, "callbacks_on_evaluate_start": null, "callbacks_on_evaluate_end": null, "callbacks_on_evaluate_offline_start": null, "callbacks_on_evaluate_offline_end": null, "callbacks_on_sample_end": null, "callbacks_on_train_result": null, "explore": true, "enable_rl_module_and_learner": true, "enable_env_runner_and_connector_v2": true, "_prior_exploration_config": {"type": "StochasticSampling"}, "count_steps_by": "env_steps", "policy_map_capacity": 100, "policy_mapping_fn": "<function AlgorithmConfig.DEFAULT_POLICY_MAPPING_FN at 0x1551edb20>", "policies_to_train": null, "policy_states_are_swappable": false, "observation_fn": null, "offline_data_class": null, "input_read_method": "read_parquet", "input_read_method_kwargs": {}, "input_read_schema": {}, "input_read_episodes": false, "input_read_sample_batches": false, "input_read_batch_size": null, "input_filesystem": null, "input_filesystem_kwargs": {}, "input_compress_columns": ["obs", "new_obs"], "input_spaces_jsonable": true, "materialize_data": false, "materialize_mapped_data": true, "map_batches_kwargs": {}, "iter_batches_kwargs": {}, "ignore_final_observation": false, "prelearner_class": null, "prelearner_buffer_class": null, "prelearner_buffer_kwargs": {}, "prelearner_module_synch_period": 10, "dataset_num_iters_per_learner": null, "input_config": {}, "actions_in_input_normalized": false, "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_config": {}, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "output_max_rows_per_file": null, "output_write_remaining_data": false, "output_write_method": "write_parquet", "output_write_method_kwargs": {}, "output_filesystem": null, "output_filesystem_kwargs": {}, "output_write_episodes": true, "offline_sampling": false, "evaluation_interval": 1, "evaluation_duration": 20, "evaluation_duration_unit": "episodes", "evaluation_sample_timeout_s": 120.0, "evaluation_auto_duration_min_env_steps_per_sample": 100, "evaluation_auto_duration_max_env_steps_per_sample": 2000, "evaluation_parallel_to_training": false, "evaluation_force_reset_envs_before_iteration": true, "evaluation_config": null, "off_policy_estimation_methods": {}, "ope_split_batch_by_episode": true, "evaluation_num_env_runners": 1, "in_evaluation": false, "sync_filters_on_rollout_workers_timeout_s": 10.0, "offline_evaluation_interval": null, "num_offline_eval_runners": 0, "offline_loss_for_module_fn": null, "offline_evaluation_duration": 1, "offline_evaluation_parallel_to_training": false, "offline_evaluation_timeout_s": 120.0, "num_cpus_per_offline_eval_runner": 1, "num_gpus_per_offline_eval_runner": 0, "custom_resources_per_offline_eval_runner": {}, "restart_failed_offline_eval_runners": true, "ignore_offline_eval_runner_failures": false, "max_num_offline_eval_runner_restarts": 1000, "offline_eval_runner_restore_timeout_s": 1800.0, "max_requests_in_flight_per_offline_eval_runner": 1, "validate_offline_eval_runners_after_construction": true, "offline_eval_runner_health_probe_timeout_s": 30.0, "offline_eval_rl_module_inference_only": false, "broadcast_offline_eval_runner_states": false, "offline_eval_batch_size_per_runner": 256, "dataset_num_iters_per_eval_runner": 1, "keep_per_episode_custom_metrics": false, "metrics_episode_collection_timeout_s": 60.0, "metrics_num_episodes_for_smoothing": 100, "min_time_s_per_iteration": null, "min_train_timesteps_per_iteration": 0, "min_sample_timesteps_per_iteration": 0, "log_gradients": true, "export_native_model_files": false, "checkpoint_trainable_policies_only": false, "logger_creator": null, "logger_config": null, "log_level": "WARN", "log_sys_usage": true, "fake_sampler": false, "seed": 8, "restart_failed_env_runners": true, "ignore_env_runner_failures": false, "max_num_env_runner_restarts": 1000, "delay_between_env_runner_restarts_s": 60.0, "restart_failed_sub_environments": false, "num_consecutive_env_runner_failures_tolerance": 100, "env_runner_health_probe_timeout_s": 30.0, "env_runner_restore_timeout_s": 1800.0, "_model_config": {}, "_rl_module_spec": "RLModuleSpec(module_class=None, observation_space=None, action_space=None, inference_only=False, learner_only=False, model_config=DefaultModelConfig(fcnet_hiddens=[60, 90], fcnet_activation='tanh', fcnet_kernel_initializer=None, fcnet_kernel_initializer_kwargs=None, fcnet_bias_initializer=None, fcnet_bias_initializer_kwargs=None, conv_filters=None, conv_activation='relu', conv_kernel_initializer=None, conv_kernel_initializer_kwargs=None, conv_bias_initializer=None, conv_bias_initializer_kwargs=None, head_fcnet_hiddens=[], head_fcnet_activation='relu', head_fcnet_kernel_initializer=None, head_fcnet_kernel_initializer_kwargs=None, head_fcnet_bias_initializer=None, head_fcnet_bias_initializer_kwargs=None, free_log_std=False, log_std_clip_param=20.0, vf_share_layers=True, use_lstm=False, max_seq_len=20, lstm_cell_size=256, lstm_use_prev_action=False, lstm_use_prev_reward=False, lstm_kernel_initializer=None, lstm_kernel_initializer_kwargs=None, lstm_bias_initializer=None, lstm_bias_initializer_kwargs=None), catalog_class=None, load_state_path=None, model_config_dict=None)", "algorithm_config_overrides_per_module": {}, "_per_module_overrides": {}, "_validate_config": true, "_use_msgpack_checkpoints": false, "_torch_grad_scaler_class": null, "_torch_lr_scheduler_classes": null, "_tf_policy_handles_more_than_one_loss": false, "_disable_preprocessor_api": false, "_disable_action_flattening": false, "_disable_initialize_loss_from_dummy_batch": false, "_dont_auto_sync_env_runner_states": false, "env_task_fn": -1, "enable_connectors": -1, "simple_optimizer": false, "policy_map_cache": -1, "worker_cls": -1, "synchronize_filters": -1, "enable_async_evaluation": -1, "custom_async_evaluation_function": -1, "_enable_rl_module_api": -1, "auto_wrap_old_gym_envs": -1, "always_attach_evaluation_results": -1, "replay_sequence_length": null, "_disable_execution_plan_api": -1, "use_critic": true, "use_gae": true, "use_kl_loss": true, "kl_coeff": 0.7464963036515, "kl_target": 0.0270990929592, "vf_loss_coeff": 0.6688075857018, "entropy_coeff": 0.0090570820258, "clip_param": 0.1221781641624, "vf_clip_param": 0.1027808522125, "entropy_coeff_schedule": null, "lr_schedule": null, "sgd_minibatch_size": -1, "vf_share_layers": -1, "__stdout_file__": null, "__stderr_file__": null, "lambda": 0.9099046732075, "input": "sampler", "policies": {"default_policy": [null, null, null, null]}, "callbacks": "<class 'ray.rllib.callbacks.callbacks.RLlibCallback'>", "create_env_on_driver": false, "custom_eval_function": null, "framework": "torch"}, "time_since_restore": 16.463454723358154, "iterations_since_restore": 10, "perf": {"cpu_util_percent": 40.0, "ram_util_percent": 77.75}}
{"timers": {"training_iteration": 1.5551224356907387, "restore_env_runners": 1.0986746130494526e-05, "training_step": 1.5549983201599689, "env_runner_sampling_timer": 1.4449807228032576, "learner_update_timer": 0.10707964859269133, "synch_weights": 0.0005542661519283583, "restore_eval_env_runners": 8.220470145687893e-06, "evaluation_iteration": 0.10452048830361974, "synch_eval_env_connectors": 0.00013970119031036469, "synch_env_connectors": 4.790025484486586e-06}, "env_runners": {"module_to_env_connector": {"timers": {"connectors": {"remove_single_ts_time_rank_from_batch": 5.727117893947367e-07, "un_batch_to_individual_items": 5.38670649786776e-06, "normalize_and_clip_actions": 9.451856784581189e-06, "get_actions": 3.890512655253055e-05, "listify_data_for_vector_env": 1.1069678188476686e-05, "tensor_to_numpy": 1.3209288713230086e-05}}, "connector_pipeline_timer": 0.00010429102411500654}, "episode_duration_sec_mean": 0.004575307548046112, "env_to_module_connector": {"timers": {"connectors": {"add_time_dim_to_batch_and_zero_pad": 2.3658092608017146e-06, "numpy_to_tensor": 8.524693091967867e-06, "batch_individual_items": 6.180019639807452e-06, "add_observations_from_episodes_to_batch": 3.00876006715285e-06, "add_states_from_episodes_to_batch": 1.7447046899329417e-06}}, "connector_pipeline_timer": 4.352699794835694e-05}, "env_reset_timer": 3.4982982900613566e-05, "episode_return_min": -11.5, "episode_return_max": 8.5, "rlmodule_inference_timer": 2.879073128201573e-05, "time_between_sampling": 0.001834502339093504, "num_module_steps_sampled": {"default_policy": 5000.0}, "num_module_steps_sampled_lifetime": {"default_policy": -5547500.0}, "episode_len_mean": 20.0, "episode_return_mean": 4.82, "num_env_steps_sampled": 5000.0, "num_agent_steps_sampled": {"default_agent": 5000.0}, "module_episode_returns_mean": {"default_policy": 4.82}, "weights_seq_no": 10.0, "num_env_steps_sampled_lifetime": -5547500.0, "env_step_timer": 1.3840199460288638e-05, "num_episodes_lifetime": -277375.0, "env_to_module_sum_episodes_length_out": 10.36823839457432, "num_episodes": 250.0, "sample": 0.004880435852709109, "agent_episode_returns_mean": {"default_agent": 4.82}, "env_to_module_sum_episodes_length_in": 10.36823839457432, "episode_len_max": 20, "episode_len_min": 20, "num_agent_steps_sampled_lifetime": {"default_agent": -5547500.0}, "num_env_steps_sampled_lifetime_throughput": 3714.3970421407744}, "learners": {"default_policy": {"curr_entropy_coeff": 0.0090570820258, "weights_seq_no": 11.0, "gradients_default_optimizer_global_norm": 0.13445432484149933, "entropy": 0.5473174452781677, "num_module_steps_trained": 6000, "num_trainable_parameters": 6003, "policy_loss": -0.054561760276556015, "mean_kl_loss": 0.001672356273047626, "vf_loss": 0.10278083384037018, "module_train_batch_size_mean": 1000.0, "vf_explained_var": 0.0033788084983825684, "diff_num_grad_updates_vs_sampler_policy": 1.0, "default_optimizer_learning_rate": 0.0002847858517, "num_module_steps_trained_lifetime": 66000, "vf_loss_unclipped": 26.720659255981445, "total_loss": 0.00922297965735197, "curr_kl_coeff": 0.0003645001561380923, "num_module_steps_trained_lifetime_throughput": 393260.93592170125}, "__all_modules__": {"learner_connector": {"connector_pipeline_timer": 0.08268375188038195, "timers": {"connectors": {"numpy_to_tensor": 7.449841752968847e-05, "add_one_ts_to_episodes_and_truncate": 0.008516002057858975, "add_time_dim_to_batch_and_zero_pad": 1.2164399843856606e-05, "batch_individual_items": 0.03265895781675779, "general_advantage_estimation": 0.006488031047472905, "add_columns_from_episodes_to_train_batch": 0.033971904375155584, "add_states_from_episodes_to_batch": 3.3215532110457875e-06, "add_observations_from_episodes_to_batch": 0.000835341368587935}}}, "num_module_steps_trained": 6000, "num_trainable_parameters": 6003, "learner_connector_sum_episodes_length_in": 5000.0, "num_module_steps_trained_lifetime": 66000, "num_non_trainable_parameters": 0, "num_env_steps_trained": 31500, "num_env_steps_trained_lifetime": 346500, "learner_connector_sum_episodes_length_out": 5250.0, "num_env_steps_trained_lifetime_throughput": 2056656.9879234424, "num_module_steps_trained_throughput": 392849.8917058696, "num_module_steps_trained_lifetime_throughput": 392418.7728938343}}, "num_training_step_calls_per_iteration": 1, "evaluation": {"env_runners": {"module_episode_returns_mean": {"default_policy": 2.35}, "env_to_module_connector": {"timers": {"connectors": {"add_observations_from_episodes_to_batch": 2.7873326617043814e-06, "numpy_to_tensor": 8.188013519514083e-06, "add_time_dim_to_batch_and_zero_pad": 2.346593819319492e-06, "batch_individual_items": 6.002328793074146e-06, "add_states_from_episodes_to_batch": 1.6255604055505695e-06}}, "connector_pipeline_timer": 4.205449029474234e-05}, "module_to_env_connector": {"timers": {"connectors": {"get_actions": 3.457187624413878e-05, "un_batch_to_individual_items": 5.308256049438237e-06, "listify_data_for_vector_env": 1.078743954248786e-05, "normalize_and_clip_actions": 9.231237914455301e-06, "tensor_to_numpy": 1.259471843597283e-05, "remove_single_ts_time_rank_from_batch": 5.781156974651802e-07}}, "connector_pipeline_timer": 9.791882498670511e-05}, "num_env_steps_sampled": 400, "num_agent_steps_sampled_lifetime": {"default_agent": 4400}, "num_env_steps_sampled_lifetime": 55400, "num_module_steps_sampled": {"default_policy": 400}, "episode_len_max": 20, "episode_duration_sec_mean": 0.004501705854199827, "env_reset_timer": 0.0001337457175564077, "episode_return_max": 14.5, "agent_episode_returns_mean": {"default_agent": 2.35}, "num_episodes_lifetime": 220, "env_to_module_sum_episodes_length_in": 10.368238394574323, "episode_len_min": 20, "rlmodule_inference_timer": 2.6460313518764817e-05, "episode_return_mean": 2.35, "env_step_timer": 1.3636784395333867e-05, "env_to_module_sum_episodes_length_out": 10.368238394574323, "num_episodes": 20, "num_agent_steps_sampled": {"default_agent": 400}, "episode_return_min": -14.5, "episode_len_mean": 20.0, "weights_seq_no": 11.0, "num_module_steps_sampled_lifetime": {"default_policy": 4400}, "sample": 0.09845155864408704, "time_between_sampling": 1.5833865373731375}, "num_healthy_workers": 1, "actor_manager_num_outstanding_async_reqs": 0, "num_remote_worker_restarts": 0}, "num_env_steps_sampled_lifetime": -5547500.0, "fault_tolerance": {"num_healthy_workers": 0, "num_remote_worker_restarts": 0}, "env_runner_group": {"actor_manager_num_outstanding_async_reqs": 0}, "done": false, "training_iteration": 11, "trial_id": "4666f_00000", "date": "2025-08-11_19-23-58", "timestamp": 1754933038, "time_this_iter_s": 1.5836529731750488, "time_total_s": 18.047107696533203, "pid": 14463, "hostname": "Mac", "node_ip": "127.0.0.1", "config": {"exploration_config": {}, "extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "placement_strategy": "PACK", "num_gpus": 0, "_fake_gpus": false, "num_cpus_for_main_process": 2, "eager_tracing": true, "eager_max_retraces": 20, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "torch_compile_learner": false, "torch_compile_learner_what_to_compile": "forward_train", "torch_compile_learner_dynamo_backend": "aot_eager", "torch_compile_learner_dynamo_mode": null, "torch_compile_worker": false, "torch_compile_worker_dynamo_backend": "aot_eager", "torch_compile_worker_dynamo_mode": null, "torch_ddp_kwargs": {}, "torch_skip_nan_gradients": false, "env": "Umbrella", "env_config": {}, "observation_space": null, "action_space": null, "clip_rewards": null, "normalize_actions": true, "clip_actions": false, "_is_atari": null, "disable_env_checking": false, "render_env": false, "action_mask_key": "action_mask", "env_runner_cls": null, "num_env_runners": 0, "create_local_env_runner": true, "num_envs_per_env_runner": 1, "gym_env_vectorize_mode": "SYNC", "num_cpus_per_env_runner": 1, "num_gpus_per_env_runner": 0, "custom_resources_per_env_runner": {}, "validate_env_runners_after_construction": true, "episodes_to_numpy": true, "max_requests_in_flight_per_env_runner": 1, "sample_timeout_s": 60.0, "_env_to_module_connector": null, "add_default_connectors_to_env_to_module_pipeline": true, "_module_to_env_connector": null, "add_default_connectors_to_module_to_env_pipeline": true, "merge_env_runner_states": "training_only", "broadcast_env_runner_states": true, "episode_lookback_horizon": 1, "rollout_fragment_length": "auto", "batch_mode": "complete_episodes", "compress_observations": false, "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "enable_tf1_exec_eagerly": false, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "preprocessor_pref": "deepmind", "observation_filter": "NoFilter", "update_worker_filter_stats": true, "use_worker_filter_stats": true, "sampler_perf_stats_ema_coef": null, "_is_online": true, "num_learners": 0, "num_gpus_per_learner": 0, "num_cpus_per_learner": "auto", "num_aggregator_actors_per_learner": 0, "max_requests_in_flight_per_aggregator_actor": 3, "local_gpu_idx": 0, "max_requests_in_flight_per_learner": 3, "gamma": 1, "lr": 0.0002847858517, "grad_clip": 0.5, "grad_clip_by": "global_norm", "_train_batch_size_per_learner": 5000, "train_batch_size": 4000, "num_epochs": 1, "minibatch_size": 1000, "shuffle_batch_per_epoch": true, "model": {"fcnet_hiddens": [256, 256], "fcnet_activation": "tanh", "fcnet_weights_initializer": null, "fcnet_weights_initializer_config": null, "fcnet_bias_initializer": null, "fcnet_bias_initializer_config": null, "conv_filters": null, "conv_activation": "relu", "conv_kernel_initializer": null, "conv_kernel_initializer_config": null, "conv_bias_initializer": null, "conv_bias_initializer_config": null, "conv_transpose_kernel_initializer": null, "conv_transpose_kernel_initializer_config": null, "conv_transpose_bias_initializer": null, "conv_transpose_bias_initializer_config": null, "post_fcnet_hiddens": [], "post_fcnet_activation": "relu", "post_fcnet_weights_initializer": null, "post_fcnet_weights_initializer_config": null, "post_fcnet_bias_initializer": null, "post_fcnet_bias_initializer_config": null, "free_log_std": false, "log_std_clip_param": 20.0, "no_final_linear": false, "vf_share_layers": false, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "lstm_weights_initializer": null, "lstm_weights_initializer_config": null, "lstm_bias_initializer": null, "lstm_bias_initializer_config": null, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "attention_use_n_prev_actions": 0, "attention_use_n_prev_rewards": 0, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": null, "custom_model_config": {}, "custom_action_dist": null, "custom_preprocessor": null, "encoder_latent_dim": null, "always_check_shapes": false, "lstm_use_prev_action_reward": -1, "_use_default_native_models": -1, "_disable_preprocessor_api": false, "_disable_action_flattening": false}, "_learner_connector": null, "add_default_connectors_to_learner_pipeline": true, "learner_config_dict": {}, "optimizer": {}, "_learner_class": null, "callbacks_on_algorithm_init": null, "callbacks_on_env_runners_recreated": null, "callbacks_on_offline_eval_runners_recreated": null, "callbacks_on_checkpoint_loaded": null, "callbacks_on_environment_created": null, "callbacks_on_episode_created": null, "callbacks_on_episode_start": null, "callbacks_on_episode_step": null, "callbacks_on_episode_end": null, "callbacks_on_evaluate_start": null, "callbacks_on_evaluate_end": null, "callbacks_on_evaluate_offline_start": null, "callbacks_on_evaluate_offline_end": null, "callbacks_on_sample_end": null, "callbacks_on_train_result": null, "explore": true, "enable_rl_module_and_learner": true, "enable_env_runner_and_connector_v2": true, "_prior_exploration_config": {"type": "StochasticSampling"}, "count_steps_by": "env_steps", "policy_map_capacity": 100, "policy_mapping_fn": "<function AlgorithmConfig.DEFAULT_POLICY_MAPPING_FN at 0x1551edb20>", "policies_to_train": null, "policy_states_are_swappable": false, "observation_fn": null, "offline_data_class": null, "input_read_method": "read_parquet", "input_read_method_kwargs": {}, "input_read_schema": {}, "input_read_episodes": false, "input_read_sample_batches": false, "input_read_batch_size": null, "input_filesystem": null, "input_filesystem_kwargs": {}, "input_compress_columns": ["obs", "new_obs"], "input_spaces_jsonable": true, "materialize_data": false, "materialize_mapped_data": true, "map_batches_kwargs": {}, "iter_batches_kwargs": {}, "ignore_final_observation": false, "prelearner_class": null, "prelearner_buffer_class": null, "prelearner_buffer_kwargs": {}, "prelearner_module_synch_period": 10, "dataset_num_iters_per_learner": null, "input_config": {}, "actions_in_input_normalized": false, "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_config": {}, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "output_max_rows_per_file": null, "output_write_remaining_data": false, "output_write_method": "write_parquet", "output_write_method_kwargs": {}, "output_filesystem": null, "output_filesystem_kwargs": {}, "output_write_episodes": true, "offline_sampling": false, "evaluation_interval": 1, "evaluation_duration": 20, "evaluation_duration_unit": "episodes", "evaluation_sample_timeout_s": 120.0, "evaluation_auto_duration_min_env_steps_per_sample": 100, "evaluation_auto_duration_max_env_steps_per_sample": 2000, "evaluation_parallel_to_training": false, "evaluation_force_reset_envs_before_iteration": true, "evaluation_config": null, "off_policy_estimation_methods": {}, "ope_split_batch_by_episode": true, "evaluation_num_env_runners": 1, "in_evaluation": false, "sync_filters_on_rollout_workers_timeout_s": 10.0, "offline_evaluation_interval": null, "num_offline_eval_runners": 0, "offline_loss_for_module_fn": null, "offline_evaluation_duration": 1, "offline_evaluation_parallel_to_training": false, "offline_evaluation_timeout_s": 120.0, "num_cpus_per_offline_eval_runner": 1, "num_gpus_per_offline_eval_runner": 0, "custom_resources_per_offline_eval_runner": {}, "restart_failed_offline_eval_runners": true, "ignore_offline_eval_runner_failures": false, "max_num_offline_eval_runner_restarts": 1000, "offline_eval_runner_restore_timeout_s": 1800.0, "max_requests_in_flight_per_offline_eval_runner": 1, "validate_offline_eval_runners_after_construction": true, "offline_eval_runner_health_probe_timeout_s": 30.0, "offline_eval_rl_module_inference_only": false, "broadcast_offline_eval_runner_states": false, "offline_eval_batch_size_per_runner": 256, "dataset_num_iters_per_eval_runner": 1, "keep_per_episode_custom_metrics": false, "metrics_episode_collection_timeout_s": 60.0, "metrics_num_episodes_for_smoothing": 100, "min_time_s_per_iteration": null, "min_train_timesteps_per_iteration": 0, "min_sample_timesteps_per_iteration": 0, "log_gradients": true, "export_native_model_files": false, "checkpoint_trainable_policies_only": false, "logger_creator": null, "logger_config": null, "log_level": "WARN", "log_sys_usage": true, "fake_sampler": false, "seed": 8, "restart_failed_env_runners": true, "ignore_env_runner_failures": false, "max_num_env_runner_restarts": 1000, "delay_between_env_runner_restarts_s": 60.0, "restart_failed_sub_environments": false, "num_consecutive_env_runner_failures_tolerance": 100, "env_runner_health_probe_timeout_s": 30.0, "env_runner_restore_timeout_s": 1800.0, "_model_config": {}, "_rl_module_spec": "RLModuleSpec(module_class=None, observation_space=None, action_space=None, inference_only=False, learner_only=False, model_config=DefaultModelConfig(fcnet_hiddens=[60, 90], fcnet_activation='tanh', fcnet_kernel_initializer=None, fcnet_kernel_initializer_kwargs=None, fcnet_bias_initializer=None, fcnet_bias_initializer_kwargs=None, conv_filters=None, conv_activation='relu', conv_kernel_initializer=None, conv_kernel_initializer_kwargs=None, conv_bias_initializer=None, conv_bias_initializer_kwargs=None, head_fcnet_hiddens=[], head_fcnet_activation='relu', head_fcnet_kernel_initializer=None, head_fcnet_kernel_initializer_kwargs=None, head_fcnet_bias_initializer=None, head_fcnet_bias_initializer_kwargs=None, free_log_std=False, log_std_clip_param=20.0, vf_share_layers=True, use_lstm=False, max_seq_len=20, lstm_cell_size=256, lstm_use_prev_action=False, lstm_use_prev_reward=False, lstm_kernel_initializer=None, lstm_kernel_initializer_kwargs=None, lstm_bias_initializer=None, lstm_bias_initializer_kwargs=None), catalog_class=None, load_state_path=None, model_config_dict=None)", "algorithm_config_overrides_per_module": {}, "_per_module_overrides": {}, "_validate_config": true, "_use_msgpack_checkpoints": false, "_torch_grad_scaler_class": null, "_torch_lr_scheduler_classes": null, "_tf_policy_handles_more_than_one_loss": false, "_disable_preprocessor_api": false, "_disable_action_flattening": false, "_disable_initialize_loss_from_dummy_batch": false, "_dont_auto_sync_env_runner_states": false, "env_task_fn": -1, "enable_connectors": -1, "simple_optimizer": false, "policy_map_cache": -1, "worker_cls": -1, "synchronize_filters": -1, "enable_async_evaluation": -1, "custom_async_evaluation_function": -1, "_enable_rl_module_api": -1, "auto_wrap_old_gym_envs": -1, "always_attach_evaluation_results": -1, "replay_sequence_length": null, "_disable_execution_plan_api": -1, "use_critic": true, "use_gae": true, "use_kl_loss": true, "kl_coeff": 0.7464963036515, "kl_target": 0.0270990929592, "vf_loss_coeff": 0.6688075857018, "entropy_coeff": 0.0090570820258, "clip_param": 0.1221781641624, "vf_clip_param": 0.1027808522125, "entropy_coeff_schedule": null, "lr_schedule": null, "sgd_minibatch_size": -1, "vf_share_layers": -1, "__stdout_file__": null, "__stderr_file__": null, "lambda": 0.9099046732075, "input": "sampler", "policies": {"default_policy": [null, null, null, null]}, "callbacks": "<class 'ray.rllib.callbacks.callbacks.RLlibCallback'>", "create_env_on_driver": false, "custom_eval_function": null, "framework": "torch"}, "time_since_restore": 18.047107696533203, "iterations_since_restore": 11, "perf": {"cpu_util_percent": 40.75, "ram_util_percent": 77.75}}
{"timers": {"training_iteration": 1.5552169796630997, "restore_env_runners": 1.0938959467860232e-05, "training_step": 1.5550921682076957, "env_runner_sampling_timer": 1.4452202568244024, "learner_update_timer": 0.10693052668707768, "synch_weights": 0.0005536522403950676, "restore_eval_env_runners": 8.200346242901664e-06, "evaluation_iteration": 0.10448557383980074, "synch_eval_env_connectors": 0.0001394112578498515, "synch_env_connectors": 4.784205876022503e-06}, "env_runners": {"module_to_env_connector": {"timers": {"connectors": {"remove_single_ts_time_rank_from_batch": 5.776051164682497e-07, "un_batch_to_individual_items": 5.443628356995068e-06, "normalize_and_clip_actions": 9.496721648363281e-06, "get_actions": 3.870037590291568e-05, "listify_data_for_vector_env": 1.1096606145947891e-05, "tensor_to_numpy": 1.3254012035919591e-05}}, "connector_pipeline_timer": 0.00010436243691273714}, "episode_duration_sec_mean": 0.004572819811291991, "env_to_module_connector": {"timers": {"connectors": {"add_time_dim_to_batch_and_zero_pad": 2.362935299375163e-06, "numpy_to_tensor": 8.533804890312427e-06, "batch_individual_items": 6.205773182913913e-06, "add_observations_from_episodes_to_batch": 3.057914489836497e-06, "add_states_from_episodes_to_batch": 1.7496608166248165e-06}}, "connector_pipeline_timer": 4.367947735427376e-05}, "env_reset_timer": 3.477037125766601e-05, "episode_return_min": -11.5, "episode_return_max": 8.5, "rlmodule_inference_timer": 2.82986637124453e-05, "time_between_sampling": 0.0017968715479102723, "num_module_steps_sampled": {"default_policy": 5000.0}, "num_module_steps_sampled_lifetime": {"default_policy": -6165000.0}, "episode_len_mean": 20.0, "episode_return_mean": 5.299999999999998, "num_env_steps_sampled": 5000.0, "num_agent_steps_sampled": {"default_agent": 5000.0}, "module_episode_returns_mean": {"default_policy": 5.299999999999998}, "weights_seq_no": 11.0, "num_env_steps_sampled_lifetime": -6165000.0, "env_step_timer": 1.3901871885649935e-05, "num_episodes_lifetime": -308250.0, "env_to_module_sum_episodes_length_out": 10.36823839457432, "num_episodes": 250.0, "sample": 0.004881960950323069, "agent_episode_returns_mean": {"default_agent": 5.299999999999998}, "env_to_module_sum_episodes_length_in": 10.36823839457432, "episode_len_max": 20, "episode_len_min": 20, "num_agent_steps_sampled_lifetime": {"default_agent": -6165000.0}, "num_env_steps_sampled_lifetime_throughput": 3689.6543849932254}, "learners": {"default_policy": {"curr_entropy_coeff": 0.0090570820258, "weights_seq_no": 12.0, "gradients_default_optimizer_global_norm": 0.016193924471735954, "entropy": 0.5396393537521362, "num_module_steps_trained": 6000, "num_trainable_parameters": 6003, "policy_loss": -0.14379438757896423, "mean_kl_loss": 0.00010483573714736849, "vf_loss": 0.10278083384037018, "module_train_batch_size_mean": 1000.0, "vf_explained_var": 0.0036283135414123535, "diff_num_grad_updates_vs_sampler_policy": 1.0, "default_optimizer_learning_rate": 0.0002847858517, "num_module_steps_trained_lifetime": 72000, "vf_loss_unclipped": 26.306880950927734, "total_loss": -0.0799412950873375, "curr_kl_coeff": 0.00018225007806904614, "num_module_steps_trained_lifetime_throughput": 394169.61655670416}, "__all_modules__": {"learner_connector": {"connector_pipeline_timer": 0.0826379226915191, "timers": {"connectors": {"numpy_to_tensor": 7.438884331491483e-05, "add_one_ts_to_episodes_and_truncate": 0.008507248287289697, "add_time_dim_to_batch_and_zero_pad": 1.2137336309483115e-05, "batch_individual_items": 0.03263264073803417, "general_advantage_estimation": 0.00647714573719666, "add_columns_from_episodes_to_train_batch": 0.033972724080409675, "add_states_from_episodes_to_batch": 3.3162575655690838e-06, "add_observations_from_episodes_to_batch": 0.0008350050357380537}}}, "num_module_steps_trained": 6000, "num_trainable_parameters": 6003, "learner_connector_sum_episodes_length_in": 5000.0, "num_module_steps_trained_lifetime": 72000, "num_non_trainable_parameters": 0, "num_env_steps_trained": 31500, "num_env_steps_trained_lifetime": 378000, "learner_connector_sum_episodes_length_out": 5250.0, "num_env_steps_trained_lifetime_throughput": 2061919.298225269, "num_module_steps_trained_throughput": 393810.3538330583, "num_module_steps_trained_lifetime_throughput": 393391.63031767507}}, "num_training_step_calls_per_iteration": 1, "evaluation": {"env_runners": {"module_episode_returns_mean": {"default_policy": 3.75}, "env_to_module_connector": {"timers": {"connectors": {"add_observations_from_episodes_to_batch": 2.7879522165964964e-06, "numpy_to_tensor": 8.160754448188545e-06, "add_time_dim_to_batch_and_zero_pad": 2.278076242448407e-06, "batch_individual_items": 5.985237994931395e-06, "add_states_from_episodes_to_batch": 1.6092552454054693e-06}}, "connector_pipeline_timer": 4.2235319566787574e-05}, "module_to_env_connector": {"timers": {"connectors": {"get_actions": 3.471973980535396e-05, "un_batch_to_individual_items": 5.232928986813213e-06, "listify_data_for_vector_env": 1.0815749222398058e-05, "normalize_and_clip_actions": 9.250154500684185e-06, "tensor_to_numpy": 1.251664660568338e-05, "remove_single_ts_time_rank_from_batch": 5.725827681862135e-07}}, "connector_pipeline_timer": 9.818350186190198e-05}, "num_env_steps_sampled": 400, "num_agent_steps_sampled_lifetime": {"default_agent": 4800}, "num_env_steps_sampled_lifetime": 60400, "num_module_steps_sampled": {"default_policy": 400}, "episode_len_max": 20, "episode_duration_sec_mean": 0.004466449192259461, "env_reset_timer": 0.0001332195110283736, "episode_return_max": 14.5, "agent_episode_returns_mean": {"default_agent": 3.75}, "num_episodes_lifetime": 240, "env_to_module_sum_episodes_length_in": 10.368238394574323, "episode_len_min": 20, "rlmodule_inference_timer": 2.6403149414711853e-05, "episode_return_mean": 3.75, "env_step_timer": 1.3713834239036112e-05, "env_to_module_sum_episodes_length_out": 10.368238394574323, "num_episodes": 20, "num_agent_steps_sampled": {"default_agent": 400}, "episode_return_min": -13.5, "episode_len_mean": 20.0, "weights_seq_no": 12.0, "num_module_steps_sampled_lifetime": {"default_policy": 4800}, "sample": 0.09842320096805089, "time_between_sampling": 1.5833759211701957}, "num_healthy_workers": 1, "actor_manager_num_outstanding_async_reqs": 0, "num_remote_worker_restarts": 0}, "num_env_steps_sampled_lifetime": -6165000.0, "fault_tolerance": {"num_healthy_workers": 0, "num_remote_worker_restarts": 0}, "env_runner_group": {"actor_manager_num_outstanding_async_reqs": 0}, "done": false, "training_iteration": 12, "trial_id": "4666f_00000", "date": "2025-08-11_19-23-59", "timestamp": 1754933039, "time_this_iter_s": 1.6672608852386475, "time_total_s": 19.71436858177185, "pid": 14463, "hostname": "Mac", "node_ip": "127.0.0.1", "config": {"exploration_config": {}, "extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "placement_strategy": "PACK", "num_gpus": 0, "_fake_gpus": false, "num_cpus_for_main_process": 2, "eager_tracing": true, "eager_max_retraces": 20, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "torch_compile_learner": false, "torch_compile_learner_what_to_compile": "forward_train", "torch_compile_learner_dynamo_backend": "aot_eager", "torch_compile_learner_dynamo_mode": null, "torch_compile_worker": false, "torch_compile_worker_dynamo_backend": "aot_eager", "torch_compile_worker_dynamo_mode": null, "torch_ddp_kwargs": {}, "torch_skip_nan_gradients": false, "env": "Umbrella", "env_config": {}, "observation_space": null, "action_space": null, "clip_rewards": null, "normalize_actions": true, "clip_actions": false, "_is_atari": null, "disable_env_checking": false, "render_env": false, "action_mask_key": "action_mask", "env_runner_cls": null, "num_env_runners": 0, "create_local_env_runner": true, "num_envs_per_env_runner": 1, "gym_env_vectorize_mode": "SYNC", "num_cpus_per_env_runner": 1, "num_gpus_per_env_runner": 0, "custom_resources_per_env_runner": {}, "validate_env_runners_after_construction": true, "episodes_to_numpy": true, "max_requests_in_flight_per_env_runner": 1, "sample_timeout_s": 60.0, "_env_to_module_connector": null, "add_default_connectors_to_env_to_module_pipeline": true, "_module_to_env_connector": null, "add_default_connectors_to_module_to_env_pipeline": true, "merge_env_runner_states": "training_only", "broadcast_env_runner_states": true, "episode_lookback_horizon": 1, "rollout_fragment_length": "auto", "batch_mode": "complete_episodes", "compress_observations": false, "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "enable_tf1_exec_eagerly": false, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "preprocessor_pref": "deepmind", "observation_filter": "NoFilter", "update_worker_filter_stats": true, "use_worker_filter_stats": true, "sampler_perf_stats_ema_coef": null, "_is_online": true, "num_learners": 0, "num_gpus_per_learner": 0, "num_cpus_per_learner": "auto", "num_aggregator_actors_per_learner": 0, "max_requests_in_flight_per_aggregator_actor": 3, "local_gpu_idx": 0, "max_requests_in_flight_per_learner": 3, "gamma": 1, "lr": 0.0002847858517, "grad_clip": 0.5, "grad_clip_by": "global_norm", "_train_batch_size_per_learner": 5000, "train_batch_size": 4000, "num_epochs": 1, "minibatch_size": 1000, "shuffle_batch_per_epoch": true, "model": {"fcnet_hiddens": [256, 256], "fcnet_activation": "tanh", "fcnet_weights_initializer": null, "fcnet_weights_initializer_config": null, "fcnet_bias_initializer": null, "fcnet_bias_initializer_config": null, "conv_filters": null, "conv_activation": "relu", "conv_kernel_initializer": null, "conv_kernel_initializer_config": null, "conv_bias_initializer": null, "conv_bias_initializer_config": null, "conv_transpose_kernel_initializer": null, "conv_transpose_kernel_initializer_config": null, "conv_transpose_bias_initializer": null, "conv_transpose_bias_initializer_config": null, "post_fcnet_hiddens": [], "post_fcnet_activation": "relu", "post_fcnet_weights_initializer": null, "post_fcnet_weights_initializer_config": null, "post_fcnet_bias_initializer": null, "post_fcnet_bias_initializer_config": null, "free_log_std": false, "log_std_clip_param": 20.0, "no_final_linear": false, "vf_share_layers": false, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "lstm_weights_initializer": null, "lstm_weights_initializer_config": null, "lstm_bias_initializer": null, "lstm_bias_initializer_config": null, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "attention_use_n_prev_actions": 0, "attention_use_n_prev_rewards": 0, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": null, "custom_model_config": {}, "custom_action_dist": null, "custom_preprocessor": null, "encoder_latent_dim": null, "always_check_shapes": false, "lstm_use_prev_action_reward": -1, "_use_default_native_models": -1, "_disable_preprocessor_api": false, "_disable_action_flattening": false}, "_learner_connector": null, "add_default_connectors_to_learner_pipeline": true, "learner_config_dict": {}, "optimizer": {}, "_learner_class": null, "callbacks_on_algorithm_init": null, "callbacks_on_env_runners_recreated": null, "callbacks_on_offline_eval_runners_recreated": null, "callbacks_on_checkpoint_loaded": null, "callbacks_on_environment_created": null, "callbacks_on_episode_created": null, "callbacks_on_episode_start": null, "callbacks_on_episode_step": null, "callbacks_on_episode_end": null, "callbacks_on_evaluate_start": null, "callbacks_on_evaluate_end": null, "callbacks_on_evaluate_offline_start": null, "callbacks_on_evaluate_offline_end": null, "callbacks_on_sample_end": null, "callbacks_on_train_result": null, "explore": true, "enable_rl_module_and_learner": true, "enable_env_runner_and_connector_v2": true, "_prior_exploration_config": {"type": "StochasticSampling"}, "count_steps_by": "env_steps", "policy_map_capacity": 100, "policy_mapping_fn": "<function AlgorithmConfig.DEFAULT_POLICY_MAPPING_FN at 0x1551edb20>", "policies_to_train": null, "policy_states_are_swappable": false, "observation_fn": null, "offline_data_class": null, "input_read_method": "read_parquet", "input_read_method_kwargs": {}, "input_read_schema": {}, "input_read_episodes": false, "input_read_sample_batches": false, "input_read_batch_size": null, "input_filesystem": null, "input_filesystem_kwargs": {}, "input_compress_columns": ["obs", "new_obs"], "input_spaces_jsonable": true, "materialize_data": false, "materialize_mapped_data": true, "map_batches_kwargs": {}, "iter_batches_kwargs": {}, "ignore_final_observation": false, "prelearner_class": null, "prelearner_buffer_class": null, "prelearner_buffer_kwargs": {}, "prelearner_module_synch_period": 10, "dataset_num_iters_per_learner": null, "input_config": {}, "actions_in_input_normalized": false, "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_config": {}, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "output_max_rows_per_file": null, "output_write_remaining_data": false, "output_write_method": "write_parquet", "output_write_method_kwargs": {}, "output_filesystem": null, "output_filesystem_kwargs": {}, "output_write_episodes": true, "offline_sampling": false, "evaluation_interval": 1, "evaluation_duration": 20, "evaluation_duration_unit": "episodes", "evaluation_sample_timeout_s": 120.0, "evaluation_auto_duration_min_env_steps_per_sample": 100, "evaluation_auto_duration_max_env_steps_per_sample": 2000, "evaluation_parallel_to_training": false, "evaluation_force_reset_envs_before_iteration": true, "evaluation_config": null, "off_policy_estimation_methods": {}, "ope_split_batch_by_episode": true, "evaluation_num_env_runners": 1, "in_evaluation": false, "sync_filters_on_rollout_workers_timeout_s": 10.0, "offline_evaluation_interval": null, "num_offline_eval_runners": 0, "offline_loss_for_module_fn": null, "offline_evaluation_duration": 1, "offline_evaluation_parallel_to_training": false, "offline_evaluation_timeout_s": 120.0, "num_cpus_per_offline_eval_runner": 1, "num_gpus_per_offline_eval_runner": 0, "custom_resources_per_offline_eval_runner": {}, "restart_failed_offline_eval_runners": true, "ignore_offline_eval_runner_failures": false, "max_num_offline_eval_runner_restarts": 1000, "offline_eval_runner_restore_timeout_s": 1800.0, "max_requests_in_flight_per_offline_eval_runner": 1, "validate_offline_eval_runners_after_construction": true, "offline_eval_runner_health_probe_timeout_s": 30.0, "offline_eval_rl_module_inference_only": false, "broadcast_offline_eval_runner_states": false, "offline_eval_batch_size_per_runner": 256, "dataset_num_iters_per_eval_runner": 1, "keep_per_episode_custom_metrics": false, "metrics_episode_collection_timeout_s": 60.0, "metrics_num_episodes_for_smoothing": 100, "min_time_s_per_iteration": null, "min_train_timesteps_per_iteration": 0, "min_sample_timesteps_per_iteration": 0, "log_gradients": true, "export_native_model_files": false, "checkpoint_trainable_policies_only": false, "logger_creator": null, "logger_config": null, "log_level": "WARN", "log_sys_usage": true, "fake_sampler": false, "seed": 8, "restart_failed_env_runners": true, "ignore_env_runner_failures": false, "max_num_env_runner_restarts": 1000, "delay_between_env_runner_restarts_s": 60.0, "restart_failed_sub_environments": false, "num_consecutive_env_runner_failures_tolerance": 100, "env_runner_health_probe_timeout_s": 30.0, "env_runner_restore_timeout_s": 1800.0, "_model_config": {}, "_rl_module_spec": "RLModuleSpec(module_class=None, observation_space=None, action_space=None, inference_only=False, learner_only=False, model_config=DefaultModelConfig(fcnet_hiddens=[60, 90], fcnet_activation='tanh', fcnet_kernel_initializer=None, fcnet_kernel_initializer_kwargs=None, fcnet_bias_initializer=None, fcnet_bias_initializer_kwargs=None, conv_filters=None, conv_activation='relu', conv_kernel_initializer=None, conv_kernel_initializer_kwargs=None, conv_bias_initializer=None, conv_bias_initializer_kwargs=None, head_fcnet_hiddens=[], head_fcnet_activation='relu', head_fcnet_kernel_initializer=None, head_fcnet_kernel_initializer_kwargs=None, head_fcnet_bias_initializer=None, head_fcnet_bias_initializer_kwargs=None, free_log_std=False, log_std_clip_param=20.0, vf_share_layers=True, use_lstm=False, max_seq_len=20, lstm_cell_size=256, lstm_use_prev_action=False, lstm_use_prev_reward=False, lstm_kernel_initializer=None, lstm_kernel_initializer_kwargs=None, lstm_bias_initializer=None, lstm_bias_initializer_kwargs=None), catalog_class=None, load_state_path=None, model_config_dict=None)", "algorithm_config_overrides_per_module": {}, "_per_module_overrides": {}, "_validate_config": true, "_use_msgpack_checkpoints": false, "_torch_grad_scaler_class": null, "_torch_lr_scheduler_classes": null, "_tf_policy_handles_more_than_one_loss": false, "_disable_preprocessor_api": false, "_disable_action_flattening": false, "_disable_initialize_loss_from_dummy_batch": false, "_dont_auto_sync_env_runner_states": false, "env_task_fn": -1, "enable_connectors": -1, "simple_optimizer": false, "policy_map_cache": -1, "worker_cls": -1, "synchronize_filters": -1, "enable_async_evaluation": -1, "custom_async_evaluation_function": -1, "_enable_rl_module_api": -1, "auto_wrap_old_gym_envs": -1, "always_attach_evaluation_results": -1, "replay_sequence_length": null, "_disable_execution_plan_api": -1, "use_critic": true, "use_gae": true, "use_kl_loss": true, "kl_coeff": 0.7464963036515, "kl_target": 0.0270990929592, "vf_loss_coeff": 0.6688075857018, "entropy_coeff": 0.0090570820258, "clip_param": 0.1221781641624, "vf_clip_param": 0.1027808522125, "entropy_coeff_schedule": null, "lr_schedule": null, "sgd_minibatch_size": -1, "vf_share_layers": -1, "__stdout_file__": null, "__stderr_file__": null, "lambda": 0.9099046732075, "input": "sampler", "policies": {"default_policy": [null, null, null, null]}, "callbacks": "<class 'ray.rllib.callbacks.callbacks.RLlibCallback'>", "create_env_on_driver": false, "custom_eval_function": null, "framework": "torch"}, "time_since_restore": 19.71436858177185, "iterations_since_restore": 12, "perf": {"cpu_util_percent": 41.86666666666667, "ram_util_percent": 77.6}}
{"timers": {"training_iteration": 1.555250308196652, "restore_env_runners": 1.0882069690865922e-05, "training_step": 1.5551251573559375, "env_runner_sampling_timer": 1.4453907967560815, "learner_update_timer": 0.10679089892059641, "synch_weights": 0.0005534711278032991, "restore_eval_env_runners": 8.18251323417009e-06, "evaluation_iteration": 0.10444445143227464, "synch_eval_env_connectors": 0.0001390667248581867, "synch_env_connectors": 4.77844446364306e-06}, "env_runners": {"module_to_env_connector": {"timers": {"connectors": {"remove_single_ts_time_rank_from_batch": 5.706758888342209e-07, "un_batch_to_individual_items": 5.349894508988696e-06, "normalize_and_clip_actions": 9.395508432689626e-06, "get_actions": 3.8417038593038773e-05, "listify_data_for_vector_env": 1.1004515699402273e-05, "tensor_to_numpy": 1.3102924015084922e-05}}, "connector_pipeline_timer": 0.00010352889670679627}, "episode_duration_sec_mean": 0.004525964156724513, "env_to_module_connector": {"timers": {"connectors": {"add_time_dim_to_batch_and_zero_pad": 2.3523290142687347e-06, "numpy_to_tensor": 8.473757170151713e-06, "batch_individual_items": 6.182758810965793e-06, "add_observations_from_episodes_to_batch": 2.9676906016587516e-06, "add_states_from_episodes_to_batch": 1.7491848117397829e-06}}, "connector_pipeline_timer": 4.3410432596859884e-05}, "env_reset_timer": 3.430950093145802e-05, "episode_return_min": -11.5, "episode_return_max": 8.5, "rlmodule_inference_timer": 2.7776764202247103e-05, "time_between_sampling": 0.0016740543971026085, "num_module_steps_sampled": {"default_policy": 5000.0}, "num_module_steps_sampled_lifetime": {"default_policy": -6782500.0}, "episode_len_mean": 20.0, "episode_return_mean": 5.700000000000004, "num_env_steps_sampled": 5000.0, "num_agent_steps_sampled": {"default_agent": 5000.0}, "module_episode_returns_mean": {"default_policy": 5.700000000000004}, "weights_seq_no": 12.0, "num_env_steps_sampled_lifetime": -6782500.0, "env_step_timer": 1.3722803996685028e-05, "num_episodes_lifetime": -339125.0, "env_to_module_sum_episodes_length_out": 10.36823839457432, "num_episodes": 250.0, "sample": 0.004853498227463016, "agent_episode_returns_mean": {"default_agent": 5.700000000000004}, "env_to_module_sum_episodes_length_in": 10.36823839457432, "episode_len_max": 20, "episode_len_min": 20, "num_agent_steps_sampled_lifetime": {"default_agent": -6782500.0}, "num_env_steps_sampled_lifetime_throughput": 3731.459179025338}, "learners": {"default_policy": {"curr_entropy_coeff": 0.0090570820258, "weights_seq_no": 13.0, "gradients_default_optimizer_global_norm": 0.05791241675615311, "entropy": 0.5378057956695557, "num_module_steps_trained": 6000, "num_trainable_parameters": 6003, "policy_loss": -0.10556618124246597, "mean_kl_loss": 4.6311222831718624e-05, "vf_loss": 0.10278083384037018, "module_train_batch_size_mean": 1000.0, "vf_explained_var": 0.004175662994384766, "diff_num_grad_updates_vs_sampler_policy": 1.0, "default_optimizer_learning_rate": 0.0002847858517, "num_module_steps_trained_lifetime": 78000, "vf_loss_unclipped": 26.30040740966797, "total_loss": -0.04169650375843048, "curr_kl_coeff": 9.112503903452307e-05, "num_module_steps_trained_lifetime_throughput": 395177.39896773244}, "__all_modules__": {"learner_connector": {"connector_pipeline_timer": 0.08260080971539865, "timers": {"connectors": {"numpy_to_tensor": 7.418120576361639e-05, "add_one_ts_to_episodes_and_truncate": 0.008498746224477109, "add_time_dim_to_batch_and_zero_pad": 1.2099293033752003e-05, "batch_individual_items": 0.03261406225139609, "general_advantage_estimation": 0.006465660949833367, "add_columns_from_episodes_to_train_batch": 0.03397442141957053, "add_states_from_episodes_to_batch": 3.308925221520353e-06, "add_observations_from_episodes_to_batch": 0.0008352599857108083}}}, "num_module_steps_trained": 6000, "num_trainable_parameters": 6003, "learner_connector_sum_episodes_length_in": 5000.0, "num_module_steps_trained_lifetime": 78000, "num_non_trainable_parameters": 0, "num_env_steps_trained": 31500, "num_env_steps_trained_lifetime": 409500, "learner_connector_sum_episodes_length_out": 5250.0, "num_env_steps_trained_lifetime_throughput": 2067697.241853791, "num_module_steps_trained_throughput": 394870.846121269, "num_module_steps_trained_lifetime_throughput": 394463.8516161887}}, "num_training_step_calls_per_iteration": 1, "evaluation": {"env_runners": {"module_episode_returns_mean": {"default_policy": 2.55}, "env_to_module_connector": {"timers": {"connectors": {"add_observations_from_episodes_to_batch": 2.8178534327054783e-06, "numpy_to_tensor": 8.134923627658519e-06, "add_time_dim_to_batch_and_zero_pad": 2.291722026446231e-06, "batch_individual_items": 6.019232077783421e-06, "add_states_from_episodes_to_batch": 1.6128400344716398e-06}}, "connector_pipeline_timer": 4.2008979698645046e-05}, "module_to_env_connector": {"timers": {"connectors": {"get_actions": 3.4800694030796245e-05, "un_batch_to_individual_items": 5.310557661497394e-06, "listify_data_for_vector_env": 1.0929490605819655e-05, "normalize_and_clip_actions": 9.136098171706006e-06, "tensor_to_numpy": 1.2551185976250544e-05, "remove_single_ts_time_rank_from_batch": 5.740114102354084e-07}}, "connector_pipeline_timer": 9.825610213903485e-05}, "num_env_steps_sampled": 400, "num_agent_steps_sampled_lifetime": {"default_agent": 5200}, "num_env_steps_sampled_lifetime": 65400, "num_module_steps_sampled": {"default_policy": 400}, "episode_len_max": 20, "episode_duration_sec_mean": 0.004421376682585105, "env_reset_timer": 0.0001326002363640387, "episode_return_max": 14.5, "agent_episode_returns_mean": {"default_agent": 2.55}, "num_episodes_lifetime": 260, "env_to_module_sum_episodes_length_in": 10.368238394574323, "episode_len_min": 20, "rlmodule_inference_timer": 2.660252634969554e-05, "episode_return_mean": 2.55, "env_step_timer": 1.3834406136472463e-05, "env_to_module_sum_episodes_length_out": 10.368238394574323, "num_episodes": 20, "num_agent_steps_sampled": {"default_agent": 400}, "episode_return_min": -14.5, "episode_len_mean": 20.0, "weights_seq_no": 13.0, "num_module_steps_sampled_lifetime": {"default_policy": 5200}, "sample": 0.09839557728896849, "time_between_sampling": 1.5832975440385906}, "num_healthy_workers": 1, "actor_manager_num_outstanding_async_reqs": 0, "num_remote_worker_restarts": 0}, "num_env_steps_sampled_lifetime": -6782500.0, "fault_tolerance": {"num_healthy_workers": 0, "num_remote_worker_restarts": 0}, "env_runner_group": {"actor_manager_num_outstanding_async_reqs": 0}, "done": false, "training_iteration": 13, "trial_id": "4666f_00000", "date": "2025-08-11_19-24-01", "timestamp": 1754933041, "time_this_iter_s": 1.661118984222412, "time_total_s": 21.375487565994263, "pid": 14463, "hostname": "Mac", "node_ip": "127.0.0.1", "config": {"exploration_config": {}, "extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "placement_strategy": "PACK", "num_gpus": 0, "_fake_gpus": false, "num_cpus_for_main_process": 2, "eager_tracing": true, "eager_max_retraces": 20, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "torch_compile_learner": false, "torch_compile_learner_what_to_compile": "forward_train", "torch_compile_learner_dynamo_backend": "aot_eager", "torch_compile_learner_dynamo_mode": null, "torch_compile_worker": false, "torch_compile_worker_dynamo_backend": "aot_eager", "torch_compile_worker_dynamo_mode": null, "torch_ddp_kwargs": {}, "torch_skip_nan_gradients": false, "env": "Umbrella", "env_config": {}, "observation_space": null, "action_space": null, "clip_rewards": null, "normalize_actions": true, "clip_actions": false, "_is_atari": null, "disable_env_checking": false, "render_env": false, "action_mask_key": "action_mask", "env_runner_cls": null, "num_env_runners": 0, "create_local_env_runner": true, "num_envs_per_env_runner": 1, "gym_env_vectorize_mode": "SYNC", "num_cpus_per_env_runner": 1, "num_gpus_per_env_runner": 0, "custom_resources_per_env_runner": {}, "validate_env_runners_after_construction": true, "episodes_to_numpy": true, "max_requests_in_flight_per_env_runner": 1, "sample_timeout_s": 60.0, "_env_to_module_connector": null, "add_default_connectors_to_env_to_module_pipeline": true, "_module_to_env_connector": null, "add_default_connectors_to_module_to_env_pipeline": true, "merge_env_runner_states": "training_only", "broadcast_env_runner_states": true, "episode_lookback_horizon": 1, "rollout_fragment_length": "auto", "batch_mode": "complete_episodes", "compress_observations": false, "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "enable_tf1_exec_eagerly": false, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "preprocessor_pref": "deepmind", "observation_filter": "NoFilter", "update_worker_filter_stats": true, "use_worker_filter_stats": true, "sampler_perf_stats_ema_coef": null, "_is_online": true, "num_learners": 0, "num_gpus_per_learner": 0, "num_cpus_per_learner": "auto", "num_aggregator_actors_per_learner": 0, "max_requests_in_flight_per_aggregator_actor": 3, "local_gpu_idx": 0, "max_requests_in_flight_per_learner": 3, "gamma": 1, "lr": 0.0002847858517, "grad_clip": 0.5, "grad_clip_by": "global_norm", "_train_batch_size_per_learner": 5000, "train_batch_size": 4000, "num_epochs": 1, "minibatch_size": 1000, "shuffle_batch_per_epoch": true, "model": {"fcnet_hiddens": [256, 256], "fcnet_activation": "tanh", "fcnet_weights_initializer": null, "fcnet_weights_initializer_config": null, "fcnet_bias_initializer": null, "fcnet_bias_initializer_config": null, "conv_filters": null, "conv_activation": "relu", "conv_kernel_initializer": null, "conv_kernel_initializer_config": null, "conv_bias_initializer": null, "conv_bias_initializer_config": null, "conv_transpose_kernel_initializer": null, "conv_transpose_kernel_initializer_config": null, "conv_transpose_bias_initializer": null, "conv_transpose_bias_initializer_config": null, "post_fcnet_hiddens": [], "post_fcnet_activation": "relu", "post_fcnet_weights_initializer": null, "post_fcnet_weights_initializer_config": null, "post_fcnet_bias_initializer": null, "post_fcnet_bias_initializer_config": null, "free_log_std": false, "log_std_clip_param": 20.0, "no_final_linear": false, "vf_share_layers": false, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "lstm_weights_initializer": null, "lstm_weights_initializer_config": null, "lstm_bias_initializer": null, "lstm_bias_initializer_config": null, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "attention_use_n_prev_actions": 0, "attention_use_n_prev_rewards": 0, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": null, "custom_model_config": {}, "custom_action_dist": null, "custom_preprocessor": null, "encoder_latent_dim": null, "always_check_shapes": false, "lstm_use_prev_action_reward": -1, "_use_default_native_models": -1, "_disable_preprocessor_api": false, "_disable_action_flattening": false}, "_learner_connector": null, "add_default_connectors_to_learner_pipeline": true, "learner_config_dict": {}, "optimizer": {}, "_learner_class": null, "callbacks_on_algorithm_init": null, "callbacks_on_env_runners_recreated": null, "callbacks_on_offline_eval_runners_recreated": null, "callbacks_on_checkpoint_loaded": null, "callbacks_on_environment_created": null, "callbacks_on_episode_created": null, "callbacks_on_episode_start": null, "callbacks_on_episode_step": null, "callbacks_on_episode_end": null, "callbacks_on_evaluate_start": null, "callbacks_on_evaluate_end": null, "callbacks_on_evaluate_offline_start": null, "callbacks_on_evaluate_offline_end": null, "callbacks_on_sample_end": null, "callbacks_on_train_result": null, "explore": true, "enable_rl_module_and_learner": true, "enable_env_runner_and_connector_v2": true, "_prior_exploration_config": {"type": "StochasticSampling"}, "count_steps_by": "env_steps", "policy_map_capacity": 100, "policy_mapping_fn": "<function AlgorithmConfig.DEFAULT_POLICY_MAPPING_FN at 0x1551edb20>", "policies_to_train": null, "policy_states_are_swappable": false, "observation_fn": null, "offline_data_class": null, "input_read_method": "read_parquet", "input_read_method_kwargs": {}, "input_read_schema": {}, "input_read_episodes": false, "input_read_sample_batches": false, "input_read_batch_size": null, "input_filesystem": null, "input_filesystem_kwargs": {}, "input_compress_columns": ["obs", "new_obs"], "input_spaces_jsonable": true, "materialize_data": false, "materialize_mapped_data": true, "map_batches_kwargs": {}, "iter_batches_kwargs": {}, "ignore_final_observation": false, "prelearner_class": null, "prelearner_buffer_class": null, "prelearner_buffer_kwargs": {}, "prelearner_module_synch_period": 10, "dataset_num_iters_per_learner": null, "input_config": {}, "actions_in_input_normalized": false, "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_config": {}, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "output_max_rows_per_file": null, "output_write_remaining_data": false, "output_write_method": "write_parquet", "output_write_method_kwargs": {}, "output_filesystem": null, "output_filesystem_kwargs": {}, "output_write_episodes": true, "offline_sampling": false, "evaluation_interval": 1, "evaluation_duration": 20, "evaluation_duration_unit": "episodes", "evaluation_sample_timeout_s": 120.0, "evaluation_auto_duration_min_env_steps_per_sample": 100, "evaluation_auto_duration_max_env_steps_per_sample": 2000, "evaluation_parallel_to_training": false, "evaluation_force_reset_envs_before_iteration": true, "evaluation_config": null, "off_policy_estimation_methods": {}, "ope_split_batch_by_episode": true, "evaluation_num_env_runners": 1, "in_evaluation": false, "sync_filters_on_rollout_workers_timeout_s": 10.0, "offline_evaluation_interval": null, "num_offline_eval_runners": 0, "offline_loss_for_module_fn": null, "offline_evaluation_duration": 1, "offline_evaluation_parallel_to_training": false, "offline_evaluation_timeout_s": 120.0, "num_cpus_per_offline_eval_runner": 1, "num_gpus_per_offline_eval_runner": 0, "custom_resources_per_offline_eval_runner": {}, "restart_failed_offline_eval_runners": true, "ignore_offline_eval_runner_failures": false, "max_num_offline_eval_runner_restarts": 1000, "offline_eval_runner_restore_timeout_s": 1800.0, "max_requests_in_flight_per_offline_eval_runner": 1, "validate_offline_eval_runners_after_construction": true, "offline_eval_runner_health_probe_timeout_s": 30.0, "offline_eval_rl_module_inference_only": false, "broadcast_offline_eval_runner_states": false, "offline_eval_batch_size_per_runner": 256, "dataset_num_iters_per_eval_runner": 1, "keep_per_episode_custom_metrics": false, "metrics_episode_collection_timeout_s": 60.0, "metrics_num_episodes_for_smoothing": 100, "min_time_s_per_iteration": null, "min_train_timesteps_per_iteration": 0, "min_sample_timesteps_per_iteration": 0, "log_gradients": true, "export_native_model_files": false, "checkpoint_trainable_policies_only": false, "logger_creator": null, "logger_config": null, "log_level": "WARN", "log_sys_usage": true, "fake_sampler": false, "seed": 8, "restart_failed_env_runners": true, "ignore_env_runner_failures": false, "max_num_env_runner_restarts": 1000, "delay_between_env_runner_restarts_s": 60.0, "restart_failed_sub_environments": false, "num_consecutive_env_runner_failures_tolerance": 100, "env_runner_health_probe_timeout_s": 30.0, "env_runner_restore_timeout_s": 1800.0, "_model_config": {}, "_rl_module_spec": "RLModuleSpec(module_class=None, observation_space=None, action_space=None, inference_only=False, learner_only=False, model_config=DefaultModelConfig(fcnet_hiddens=[60, 90], fcnet_activation='tanh', fcnet_kernel_initializer=None, fcnet_kernel_initializer_kwargs=None, fcnet_bias_initializer=None, fcnet_bias_initializer_kwargs=None, conv_filters=None, conv_activation='relu', conv_kernel_initializer=None, conv_kernel_initializer_kwargs=None, conv_bias_initializer=None, conv_bias_initializer_kwargs=None, head_fcnet_hiddens=[], head_fcnet_activation='relu', head_fcnet_kernel_initializer=None, head_fcnet_kernel_initializer_kwargs=None, head_fcnet_bias_initializer=None, head_fcnet_bias_initializer_kwargs=None, free_log_std=False, log_std_clip_param=20.0, vf_share_layers=True, use_lstm=False, max_seq_len=20, lstm_cell_size=256, lstm_use_prev_action=False, lstm_use_prev_reward=False, lstm_kernel_initializer=None, lstm_kernel_initializer_kwargs=None, lstm_bias_initializer=None, lstm_bias_initializer_kwargs=None), catalog_class=None, load_state_path=None, model_config_dict=None)", "algorithm_config_overrides_per_module": {}, "_per_module_overrides": {}, "_validate_config": true, "_use_msgpack_checkpoints": false, "_torch_grad_scaler_class": null, "_torch_lr_scheduler_classes": null, "_tf_policy_handles_more_than_one_loss": false, "_disable_preprocessor_api": false, "_disable_action_flattening": false, "_disable_initialize_loss_from_dummy_batch": false, "_dont_auto_sync_env_runner_states": false, "env_task_fn": -1, "enable_connectors": -1, "simple_optimizer": false, "policy_map_cache": -1, "worker_cls": -1, "synchronize_filters": -1, "enable_async_evaluation": -1, "custom_async_evaluation_function": -1, "_enable_rl_module_api": -1, "auto_wrap_old_gym_envs": -1, "always_attach_evaluation_results": -1, "replay_sequence_length": null, "_disable_execution_plan_api": -1, "use_critic": true, "use_gae": true, "use_kl_loss": true, "kl_coeff": 0.7464963036515, "kl_target": 0.0270990929592, "vf_loss_coeff": 0.6688075857018, "entropy_coeff": 0.0090570820258, "clip_param": 0.1221781641624, "vf_clip_param": 0.1027808522125, "entropy_coeff_schedule": null, "lr_schedule": null, "sgd_minibatch_size": -1, "vf_share_layers": -1, "__stdout_file__": null, "__stderr_file__": null, "lambda": 0.9099046732075, "input": "sampler", "policies": {"default_policy": [null, null, null, null]}, "callbacks": "<class 'ray.rllib.callbacks.callbacks.RLlibCallback'>", "create_env_on_driver": false, "custom_eval_function": null, "framework": "torch"}, "time_since_restore": 21.375487565994263, "iterations_since_restore": 13, "perf": {"cpu_util_percent": 41.5, "ram_util_percent": 77.8}}
{"timers": {"training_iteration": 1.555335693454965, "restore_env_runners": 1.0829088767224771e-05, "training_step": 1.5552100745333124, "env_runner_sampling_timer": 1.4446544800388361, "learner_update_timer": 0.10760994368131721, "synch_weights": 0.0005535955760310059, "restore_eval_env_runners": 8.163187995657615e-06, "evaluation_iteration": 0.10440271899774138, "synch_eval_env_connectors": 0.00013864980774826014, "synch_env_connectors": 4.769830282341738e-06}, "env_runners": {"module_to_env_connector": {"timers": {"connectors": {"remove_single_ts_time_rank_from_batch": 5.68213182714751e-07, "un_batch_to_individual_items": 5.335753572915505e-06, "normalize_and_clip_actions": 9.392806106155355e-06, "get_actions": 3.840433589972635e-05, "listify_data_for_vector_env": 1.097509580260042e-05, "tensor_to_numpy": 1.3132280857064634e-05}}, "connector_pipeline_timer": 0.00010337092490365735}, "episode_duration_sec_mean": 0.00453281136136502, "env_to_module_connector": {"timers": {"connectors": {"add_time_dim_to_batch_and_zero_pad": 2.3393101539473937e-06, "numpy_to_tensor": 8.506701096836725e-06, "batch_individual_items": 6.146248825490086e-06, "add_observations_from_episodes_to_batch": 2.957035721806867e-06, "add_states_from_episodes_to_batch": 1.738071790976317e-06}}, "connector_pipeline_timer": 4.327450733532121e-05}, "env_reset_timer": 3.339579960150551e-05, "episode_return_min": -11.5, "episode_return_max": 8.5, "rlmodule_inference_timer": 2.8283409281538592e-05, "time_between_sampling": 0.0016808550225246852, "num_module_steps_sampled": {"default_policy": 5000.0}, "num_module_steps_sampled_lifetime": {"default_policy": -7400000.0}, "episode_len_mean": 20.0, "episode_return_mean": 5.380000000000001, "num_env_steps_sampled": 5000.0, "num_agent_steps_sampled": {"default_agent": 5000.0}, "module_episode_returns_mean": {"default_policy": 5.380000000000001}, "weights_seq_no": 13.0, "num_env_steps_sampled_lifetime": -7400000.0, "env_step_timer": 1.3690751311800482e-05, "num_episodes_lifetime": -370000.0, "env_to_module_sum_episodes_length_out": 10.36823839457432, "num_episodes": 250.0, "sample": 0.004838405223095626, "agent_episode_returns_mean": {"default_agent": 5.380000000000001}, "env_to_module_sum_episodes_length_in": 10.36823839457432, "episode_len_max": 20, "episode_len_min": 20, "num_agent_steps_sampled_lifetime": {"default_agent": -7400000.0}, "num_env_steps_sampled_lifetime_throughput": 3743.847084627215}, "learners": {"default_policy": {"curr_entropy_coeff": 0.0090570820258, "weights_seq_no": 14.0, "gradients_default_optimizer_global_norm": 0.035145506262779236, "entropy": 0.5194522738456726, "num_module_steps_trained": 6000, "num_trainable_parameters": 6003, "policy_loss": 0.07163506746292114, "mean_kl_loss": 0.00028114247834309936, "vf_loss": 0.10278083384037018, "module_train_batch_size_mean": 1000.0, "vf_explained_var": 0.005130410194396973, "diff_num_grad_updates_vs_sampler_policy": 1.0, "default_optimizer_learning_rate": 0.0002847858517, "num_module_steps_trained_lifetime": 84000, "vf_loss_unclipped": 27.039745330810547, "total_loss": 0.1356709897518158, "curr_kl_coeff": 4.5562519517261535e-05, "num_module_steps_trained_lifetime_throughput": 396113.76657004736}, "__all_modules__": {"learner_connector": {"connector_pipeline_timer": 0.08352214661828446, "timers": {"connectors": {"numpy_to_tensor": 7.40643938084257e-05, "add_one_ts_to_episodes_and_truncate": 0.008489892102130997, "add_time_dim_to_batch_and_zero_pad": 1.2076219358909554e-05, "batch_individual_items": 0.03355780787925697, "general_advantage_estimation": 0.0064528605908372024, "add_columns_from_episodes_to_train_batch": 0.033974022614676865, "add_states_from_episodes_to_batch": 3.3045858971835292e-06, "add_observations_from_episodes_to_batch": 0.0008352828058559669}}}, "num_module_steps_trained": 6000, "num_trainable_parameters": 6003, "learner_connector_sum_episodes_length_in": 5000.0, "num_module_steps_trained_lifetime": 84000, "num_non_trainable_parameters": 0, "num_env_steps_trained": 31500, "num_env_steps_trained_lifetime": 441000, "learner_connector_sum_episodes_length_out": 5250.0, "num_env_steps_trained_lifetime_throughput": 2073070.5795163435, "num_module_steps_trained_throughput": 395857.3788799121, "num_module_steps_trained_lifetime_throughput": 395460.6581367823}}, "num_training_step_calls_per_iteration": 1, "evaluation": {"env_runners": {"module_episode_returns_mean": {"default_policy": 2.75}, "env_to_module_connector": {"timers": {"connectors": {"add_observations_from_episodes_to_batch": 2.7633083831439773e-06, "numpy_to_tensor": 8.16561678511018e-06, "add_time_dim_to_batch_and_zero_pad": 2.3499339161421448e-06, "batch_individual_items": 6.082290076505181e-06, "add_states_from_episodes_to_batch": 1.6001548929466248e-06}}, "connector_pipeline_timer": 4.198637038868903e-05}, "module_to_env_connector": {"timers": {"connectors": {"get_actions": 3.482317883963543e-05, "un_batch_to_individual_items": 5.281582692049495e-06, "listify_data_for_vector_env": 1.0778513745303454e-05, "normalize_and_clip_actions": 9.167300627236357e-06, "tensor_to_numpy": 1.2588638461480249e-05, "remove_single_ts_time_rank_from_batch": 5.770528192250128e-07}}, "connector_pipeline_timer": 9.813607462152831e-05}, "num_env_steps_sampled": 400, "num_agent_steps_sampled_lifetime": {"default_agent": 5600}, "num_env_steps_sampled_lifetime": 70400, "num_module_steps_sampled": {"default_policy": 400}, "episode_len_max": 20, "episode_duration_sec_mean": 0.004412041285540909, "env_reset_timer": 0.00013204923408086458, "episode_return_max": 14.5, "agent_episode_returns_mean": {"default_agent": 2.75}, "num_episodes_lifetime": 280, "env_to_module_sum_episodes_length_in": 10.368238394574323, "episode_len_min": 20, "rlmodule_inference_timer": 2.6419011799841166e-05, "episode_return_mean": 2.75, "env_step_timer": 1.3773139821049097e-05, "env_to_module_sum_episodes_length_out": 10.368238394574323, "num_episodes": 20, "num_agent_steps_sampled": {"default_agent": 400}, "episode_return_min": -14.5, "episode_len_mean": 20.0, "weights_seq_no": 14.0, "num_module_steps_sampled_lifetime": {"default_policy": 5600}, "sample": 0.09836695526654095, "time_between_sampling": 1.5832695410978137}, "num_healthy_workers": 1, "actor_manager_num_outstanding_async_reqs": 0, "num_remote_worker_restarts": 0}, "num_env_steps_sampled_lifetime": -7400000.0, "fault_tolerance": {"num_healthy_workers": 0, "num_remote_worker_restarts": 0}, "env_runner_group": {"actor_manager_num_outstanding_async_reqs": 0}, "done": false, "training_iteration": 14, "trial_id": "4666f_00000", "date": "2025-08-11_19-24-03", "timestamp": 1754933043, "time_this_iter_s": 1.666395902633667, "time_total_s": 23.04188346862793, "pid": 14463, "hostname": "Mac", "node_ip": "127.0.0.1", "config": {"exploration_config": {}, "extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "placement_strategy": "PACK", "num_gpus": 0, "_fake_gpus": false, "num_cpus_for_main_process": 2, "eager_tracing": true, "eager_max_retraces": 20, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "torch_compile_learner": false, "torch_compile_learner_what_to_compile": "forward_train", "torch_compile_learner_dynamo_backend": "aot_eager", "torch_compile_learner_dynamo_mode": null, "torch_compile_worker": false, "torch_compile_worker_dynamo_backend": "aot_eager", "torch_compile_worker_dynamo_mode": null, "torch_ddp_kwargs": {}, "torch_skip_nan_gradients": false, "env": "Umbrella", "env_config": {}, "observation_space": null, "action_space": null, "clip_rewards": null, "normalize_actions": true, "clip_actions": false, "_is_atari": null, "disable_env_checking": false, "render_env": false, "action_mask_key": "action_mask", "env_runner_cls": null, "num_env_runners": 0, "create_local_env_runner": true, "num_envs_per_env_runner": 1, "gym_env_vectorize_mode": "SYNC", "num_cpus_per_env_runner": 1, "num_gpus_per_env_runner": 0, "custom_resources_per_env_runner": {}, "validate_env_runners_after_construction": true, "episodes_to_numpy": true, "max_requests_in_flight_per_env_runner": 1, "sample_timeout_s": 60.0, "_env_to_module_connector": null, "add_default_connectors_to_env_to_module_pipeline": true, "_module_to_env_connector": null, "add_default_connectors_to_module_to_env_pipeline": true, "merge_env_runner_states": "training_only", "broadcast_env_runner_states": true, "episode_lookback_horizon": 1, "rollout_fragment_length": "auto", "batch_mode": "complete_episodes", "compress_observations": false, "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "enable_tf1_exec_eagerly": false, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "preprocessor_pref": "deepmind", "observation_filter": "NoFilter", "update_worker_filter_stats": true, "use_worker_filter_stats": true, "sampler_perf_stats_ema_coef": null, "_is_online": true, "num_learners": 0, "num_gpus_per_learner": 0, "num_cpus_per_learner": "auto", "num_aggregator_actors_per_learner": 0, "max_requests_in_flight_per_aggregator_actor": 3, "local_gpu_idx": 0, "max_requests_in_flight_per_learner": 3, "gamma": 1, "lr": 0.0002847858517, "grad_clip": 0.5, "grad_clip_by": "global_norm", "_train_batch_size_per_learner": 5000, "train_batch_size": 4000, "num_epochs": 1, "minibatch_size": 1000, "shuffle_batch_per_epoch": true, "model": {"fcnet_hiddens": [256, 256], "fcnet_activation": "tanh", "fcnet_weights_initializer": null, "fcnet_weights_initializer_config": null, "fcnet_bias_initializer": null, "fcnet_bias_initializer_config": null, "conv_filters": null, "conv_activation": "relu", "conv_kernel_initializer": null, "conv_kernel_initializer_config": null, "conv_bias_initializer": null, "conv_bias_initializer_config": null, "conv_transpose_kernel_initializer": null, "conv_transpose_kernel_initializer_config": null, "conv_transpose_bias_initializer": null, "conv_transpose_bias_initializer_config": null, "post_fcnet_hiddens": [], "post_fcnet_activation": "relu", "post_fcnet_weights_initializer": null, "post_fcnet_weights_initializer_config": null, "post_fcnet_bias_initializer": null, "post_fcnet_bias_initializer_config": null, "free_log_std": false, "log_std_clip_param": 20.0, "no_final_linear": false, "vf_share_layers": false, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "lstm_weights_initializer": null, "lstm_weights_initializer_config": null, "lstm_bias_initializer": null, "lstm_bias_initializer_config": null, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "attention_use_n_prev_actions": 0, "attention_use_n_prev_rewards": 0, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": null, "custom_model_config": {}, "custom_action_dist": null, "custom_preprocessor": null, "encoder_latent_dim": null, "always_check_shapes": false, "lstm_use_prev_action_reward": -1, "_use_default_native_models": -1, "_disable_preprocessor_api": false, "_disable_action_flattening": false}, "_learner_connector": null, "add_default_connectors_to_learner_pipeline": true, "learner_config_dict": {}, "optimizer": {}, "_learner_class": null, "callbacks_on_algorithm_init": null, "callbacks_on_env_runners_recreated": null, "callbacks_on_offline_eval_runners_recreated": null, "callbacks_on_checkpoint_loaded": null, "callbacks_on_environment_created": null, "callbacks_on_episode_created": null, "callbacks_on_episode_start": null, "callbacks_on_episode_step": null, "callbacks_on_episode_end": null, "callbacks_on_evaluate_start": null, "callbacks_on_evaluate_end": null, "callbacks_on_evaluate_offline_start": null, "callbacks_on_evaluate_offline_end": null, "callbacks_on_sample_end": null, "callbacks_on_train_result": null, "explore": true, "enable_rl_module_and_learner": true, "enable_env_runner_and_connector_v2": true, "_prior_exploration_config": {"type": "StochasticSampling"}, "count_steps_by": "env_steps", "policy_map_capacity": 100, "policy_mapping_fn": "<function AlgorithmConfig.DEFAULT_POLICY_MAPPING_FN at 0x1551edb20>", "policies_to_train": null, "policy_states_are_swappable": false, "observation_fn": null, "offline_data_class": null, "input_read_method": "read_parquet", "input_read_method_kwargs": {}, "input_read_schema": {}, "input_read_episodes": false, "input_read_sample_batches": false, "input_read_batch_size": null, "input_filesystem": null, "input_filesystem_kwargs": {}, "input_compress_columns": ["obs", "new_obs"], "input_spaces_jsonable": true, "materialize_data": false, "materialize_mapped_data": true, "map_batches_kwargs": {}, "iter_batches_kwargs": {}, "ignore_final_observation": false, "prelearner_class": null, "prelearner_buffer_class": null, "prelearner_buffer_kwargs": {}, "prelearner_module_synch_period": 10, "dataset_num_iters_per_learner": null, "input_config": {}, "actions_in_input_normalized": false, "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_config": {}, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "output_max_rows_per_file": null, "output_write_remaining_data": false, "output_write_method": "write_parquet", "output_write_method_kwargs": {}, "output_filesystem": null, "output_filesystem_kwargs": {}, "output_write_episodes": true, "offline_sampling": false, "evaluation_interval": 1, "evaluation_duration": 20, "evaluation_duration_unit": "episodes", "evaluation_sample_timeout_s": 120.0, "evaluation_auto_duration_min_env_steps_per_sample": 100, "evaluation_auto_duration_max_env_steps_per_sample": 2000, "evaluation_parallel_to_training": false, "evaluation_force_reset_envs_before_iteration": true, "evaluation_config": null, "off_policy_estimation_methods": {}, "ope_split_batch_by_episode": true, "evaluation_num_env_runners": 1, "in_evaluation": false, "sync_filters_on_rollout_workers_timeout_s": 10.0, "offline_evaluation_interval": null, "num_offline_eval_runners": 0, "offline_loss_for_module_fn": null, "offline_evaluation_duration": 1, "offline_evaluation_parallel_to_training": false, "offline_evaluation_timeout_s": 120.0, "num_cpus_per_offline_eval_runner": 1, "num_gpus_per_offline_eval_runner": 0, "custom_resources_per_offline_eval_runner": {}, "restart_failed_offline_eval_runners": true, "ignore_offline_eval_runner_failures": false, "max_num_offline_eval_runner_restarts": 1000, "offline_eval_runner_restore_timeout_s": 1800.0, "max_requests_in_flight_per_offline_eval_runner": 1, "validate_offline_eval_runners_after_construction": true, "offline_eval_runner_health_probe_timeout_s": 30.0, "offline_eval_rl_module_inference_only": false, "broadcast_offline_eval_runner_states": false, "offline_eval_batch_size_per_runner": 256, "dataset_num_iters_per_eval_runner": 1, "keep_per_episode_custom_metrics": false, "metrics_episode_collection_timeout_s": 60.0, "metrics_num_episodes_for_smoothing": 100, "min_time_s_per_iteration": null, "min_train_timesteps_per_iteration": 0, "min_sample_timesteps_per_iteration": 0, "log_gradients": true, "export_native_model_files": false, "checkpoint_trainable_policies_only": false, "logger_creator": null, "logger_config": null, "log_level": "WARN", "log_sys_usage": true, "fake_sampler": false, "seed": 8, "restart_failed_env_runners": true, "ignore_env_runner_failures": false, "max_num_env_runner_restarts": 1000, "delay_between_env_runner_restarts_s": 60.0, "restart_failed_sub_environments": false, "num_consecutive_env_runner_failures_tolerance": 100, "env_runner_health_probe_timeout_s": 30.0, "env_runner_restore_timeout_s": 1800.0, "_model_config": {}, "_rl_module_spec": "RLModuleSpec(module_class=None, observation_space=None, action_space=None, inference_only=False, learner_only=False, model_config=DefaultModelConfig(fcnet_hiddens=[60, 90], fcnet_activation='tanh', fcnet_kernel_initializer=None, fcnet_kernel_initializer_kwargs=None, fcnet_bias_initializer=None, fcnet_bias_initializer_kwargs=None, conv_filters=None, conv_activation='relu', conv_kernel_initializer=None, conv_kernel_initializer_kwargs=None, conv_bias_initializer=None, conv_bias_initializer_kwargs=None, head_fcnet_hiddens=[], head_fcnet_activation='relu', head_fcnet_kernel_initializer=None, head_fcnet_kernel_initializer_kwargs=None, head_fcnet_bias_initializer=None, head_fcnet_bias_initializer_kwargs=None, free_log_std=False, log_std_clip_param=20.0, vf_share_layers=True, use_lstm=False, max_seq_len=20, lstm_cell_size=256, lstm_use_prev_action=False, lstm_use_prev_reward=False, lstm_kernel_initializer=None, lstm_kernel_initializer_kwargs=None, lstm_bias_initializer=None, lstm_bias_initializer_kwargs=None), catalog_class=None, load_state_path=None, model_config_dict=None)", "algorithm_config_overrides_per_module": {}, "_per_module_overrides": {}, "_validate_config": true, "_use_msgpack_checkpoints": false, "_torch_grad_scaler_class": null, "_torch_lr_scheduler_classes": null, "_tf_policy_handles_more_than_one_loss": false, "_disable_preprocessor_api": false, "_disable_action_flattening": false, "_disable_initialize_loss_from_dummy_batch": false, "_dont_auto_sync_env_runner_states": false, "env_task_fn": -1, "enable_connectors": -1, "simple_optimizer": false, "policy_map_cache": -1, "worker_cls": -1, "synchronize_filters": -1, "enable_async_evaluation": -1, "custom_async_evaluation_function": -1, "_enable_rl_module_api": -1, "auto_wrap_old_gym_envs": -1, "always_attach_evaluation_results": -1, "replay_sequence_length": null, "_disable_execution_plan_api": -1, "use_critic": true, "use_gae": true, "use_kl_loss": true, "kl_coeff": 0.7464963036515, "kl_target": 0.0270990929592, "vf_loss_coeff": 0.6688075857018, "entropy_coeff": 0.0090570820258, "clip_param": 0.1221781641624, "vf_clip_param": 0.1027808522125, "entropy_coeff_schedule": null, "lr_schedule": null, "sgd_minibatch_size": -1, "vf_share_layers": -1, "__stdout_file__": null, "__stderr_file__": null, "lambda": 0.9099046732075, "input": "sampler", "policies": {"default_policy": [null, null, null, null]}, "callbacks": "<class 'ray.rllib.callbacks.callbacks.RLlibCallback'>", "create_env_on_driver": false, "custom_eval_function": null, "framework": "torch"}, "time_since_restore": 23.04188346862793, "iterations_since_restore": 14, "perf": {"cpu_util_percent": 20.05, "ram_util_percent": 77.45}}
{"timers": {"training_iteration": 1.5555910148515018, "restore_env_runners": 1.0778297735309283e-05, "training_step": 1.5554646954475893, "env_runner_sampling_timer": 1.4440621131585956, "learner_update_timer": 0.10845016633446855, "synch_weights": 0.0005540546193534549, "restore_eval_env_runners": 8.14780574704631e-06, "evaluation_iteration": 0.10436109721699947, "synch_eval_env_connectors": 0.00013818122003616534, "synch_env_connectors": 4.760881983541634e-06}, "env_runners": {"module_to_env_connector": {"timers": {"connectors": {"remove_single_ts_time_rank_from_batch": 5.702626493981834e-07, "un_batch_to_individual_items": 5.414526155486597e-06, "normalize_and_clip_actions": 9.43547619449354e-06, "get_actions": 3.895811943693438e-05, "listify_data_for_vector_env": 1.1075488663579336e-05, "tensor_to_numpy": 1.3216541595197272e-05}}, "connector_pipeline_timer": 0.0001044362191587113}, "episode_duration_sec_mean": 0.004567327823489904, "env_to_module_connector": {"timers": {"connectors": {"add_time_dim_to_batch_and_zero_pad": 2.368478699998172e-06, "numpy_to_tensor": 8.50167710677379e-06, "batch_individual_items": 6.20292488511331e-06, "add_observations_from_episodes_to_batch": 3.069821758291846e-06, "add_states_from_episodes_to_batch": 1.7395003712057492e-06}}, "connector_pipeline_timer": 4.359616242610551e-05}, "env_reset_timer": 3.4220130631700757e-05, "episode_return_min": -11.5, "episode_return_max": 8.5, "rlmodule_inference_timer": 2.8009087076463077e-05, "time_between_sampling": 0.0018488581247792617, "num_module_steps_sampled": {"default_policy": 5000.0}, "num_module_steps_sampled_lifetime": {"default_policy": -8017500.0}, "episode_len_mean": 20.0, "episode_return_mean": 5.460000000000001, "num_env_steps_sampled": 5000.0, "num_agent_steps_sampled": {"default_agent": 5000.0}, "module_episode_returns_mean": {"default_policy": 5.460000000000001}, "weights_seq_no": 14.0, "num_env_steps_sampled_lifetime": -8017500.0, "env_step_timer": 1.3901843426898462e-05, "num_episodes_lifetime": -400875.0, "env_to_module_sum_episodes_length_out": 10.36823839457432, "num_episodes": 250.0, "sample": 0.004859453123351237, "agent_episode_returns_mean": {"default_agent": 5.460000000000001}, "env_to_module_sum_episodes_length_in": 10.36823839457432, "episode_len_max": 20, "episode_len_min": 20, "num_agent_steps_sampled_lifetime": {"default_agent": -8017500.0}, "num_env_steps_sampled_lifetime_throughput": 3712.8350324303883}, "learners": {"default_policy": {"curr_entropy_coeff": 0.0090570820258, "weights_seq_no": 15.0, "gradients_default_optimizer_global_norm": 0.0580829381942749, "entropy": 0.512681782245636, "num_module_steps_trained": 6000, "num_trainable_parameters": 6003, "policy_loss": -0.10267102718353271, "mean_kl_loss": 0.0002160034200642258, "vf_loss": 0.10278083384037018, "module_train_batch_size_mean": 1000.0, "vf_explained_var": 0.005217373371124268, "diff_num_grad_updates_vs_sampler_policy": 1.0, "default_optimizer_learning_rate": 0.0002847858517, "num_module_steps_trained_lifetime": 90000, "vf_loss_unclipped": 26.506343841552734, "total_loss": -0.03857382386922836, "curr_kl_coeff": 2.2781259758630767e-05, "num_module_steps_trained_lifetime_throughput": 396149.6218848327}, "__all_modules__": {"learner_connector": {"connector_pipeline_timer": 0.08444233182237397, "timers": {"connectors": {"numpy_to_tensor": 7.401750020524504e-05, "add_one_ts_to_episodes_and_truncate": 0.008481836511280648, "add_time_dim_to_batch_and_zero_pad": 1.2069626835589352e-05, "batch_individual_items": 0.03448110313112642, "general_advantage_estimation": 0.006444661984280704, "add_columns_from_episodes_to_train_batch": 0.03398742904843891, "add_states_from_episodes_to_batch": 3.303200349135747e-06, "add_observations_from_episodes_to_batch": 0.0008352408082508181}}}, "num_module_steps_trained": 6000, "num_trainable_parameters": 6003, "learner_connector_sum_episodes_length_in": 5000.0, "num_module_steps_trained_lifetime": 90000, "num_non_trainable_parameters": 0, "num_env_steps_trained": 31500, "num_env_steps_trained_lifetime": 472500, "learner_connector_sum_episodes_length_out": 5250.0, "num_env_steps_trained_lifetime_throughput": 2073695.0417719586, "num_module_steps_trained_throughput": 395939.601504524, "num_module_steps_trained_lifetime_throughput": 395553.0457339386}}, "num_training_step_calls_per_iteration": 1, "evaluation": {"env_runners": {"module_episode_returns_mean": {"default_policy": 1.75}, "env_to_module_connector": {"timers": {"connectors": {"add_observations_from_episodes_to_batch": 2.8904549255819476e-06, "numpy_to_tensor": 8.659951124073972e-06, "add_time_dim_to_batch_and_zero_pad": 2.410825877851746e-06, "batch_individual_items": 6.376948193115706e-06, "add_states_from_episodes_to_batch": 1.6804860741352404e-06}}, "connector_pipeline_timer": 4.4194715113134294e-05}, "module_to_env_connector": {"timers": {"connectors": {"get_actions": 3.71090681885074e-05, "un_batch_to_individual_items": 5.663522826956922e-06, "listify_data_for_vector_env": 1.1501241165709802e-05, "normalize_and_clip_actions": 9.567865925014539e-06, "tensor_to_numpy": 1.3313160586762908e-05, "remove_single_ts_time_rank_from_batch": 6.103967825741726e-07}}, "connector_pipeline_timer": 0.00010357882138067636}, "num_env_steps_sampled": 400, "num_agent_steps_sampled_lifetime": {"default_agent": 6000}, "num_env_steps_sampled_lifetime": 75400, "num_module_steps_sampled": {"default_policy": 400}, "episode_len_max": 20, "episode_duration_sec_mean": 0.004449625426204875, "env_reset_timer": 0.00013152790149226093, "episode_return_max": 14.5, "agent_episode_returns_mean": {"default_agent": 1.75}, "num_episodes_lifetime": 300, "env_to_module_sum_episodes_length_in": 10.368238394574323, "episode_len_min": 20, "rlmodule_inference_timer": 2.8212036789789934e-05, "episode_return_mean": 1.75, "env_step_timer": 1.4552559146132155e-05, "env_to_module_sum_episodes_length_out": 10.368238394574323, "num_episodes": 20, "num_agent_steps_sampled": {"default_agent": 400}, "episode_return_min": -14.5, "episode_len_mean": 20.0, "weights_seq_no": 15.0, "num_module_steps_sampled_lifetime": {"default_policy": 6000}, "sample": 0.09839666446394274, "time_between_sampling": 1.5834185344377434}, "num_healthy_workers": 1, "actor_manager_num_outstanding_async_reqs": 0, "num_remote_worker_restarts": 0}, "num_env_steps_sampled_lifetime": -8017500.0, "fault_tolerance": {"num_healthy_workers": 0, "num_remote_worker_restarts": 0}, "env_runner_group": {"actor_manager_num_outstanding_async_reqs": 0}, "done": false, "training_iteration": 15, "trial_id": "4666f_00000", "date": "2025-08-11_19-24-04", "timestamp": 1754933044, "time_this_iter_s": 1.6904098987579346, "time_total_s": 24.732293367385864, "pid": 14463, "hostname": "Mac", "node_ip": "127.0.0.1", "config": {"exploration_config": {}, "extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "placement_strategy": "PACK", "num_gpus": 0, "_fake_gpus": false, "num_cpus_for_main_process": 2, "eager_tracing": true, "eager_max_retraces": 20, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "torch_compile_learner": false, "torch_compile_learner_what_to_compile": "forward_train", "torch_compile_learner_dynamo_backend": "aot_eager", "torch_compile_learner_dynamo_mode": null, "torch_compile_worker": false, "torch_compile_worker_dynamo_backend": "aot_eager", "torch_compile_worker_dynamo_mode": null, "torch_ddp_kwargs": {}, "torch_skip_nan_gradients": false, "env": "Umbrella", "env_config": {}, "observation_space": null, "action_space": null, "clip_rewards": null, "normalize_actions": true, "clip_actions": false, "_is_atari": null, "disable_env_checking": false, "render_env": false, "action_mask_key": "action_mask", "env_runner_cls": null, "num_env_runners": 0, "create_local_env_runner": true, "num_envs_per_env_runner": 1, "gym_env_vectorize_mode": "SYNC", "num_cpus_per_env_runner": 1, "num_gpus_per_env_runner": 0, "custom_resources_per_env_runner": {}, "validate_env_runners_after_construction": true, "episodes_to_numpy": true, "max_requests_in_flight_per_env_runner": 1, "sample_timeout_s": 60.0, "_env_to_module_connector": null, "add_default_connectors_to_env_to_module_pipeline": true, "_module_to_env_connector": null, "add_default_connectors_to_module_to_env_pipeline": true, "merge_env_runner_states": "training_only", "broadcast_env_runner_states": true, "episode_lookback_horizon": 1, "rollout_fragment_length": "auto", "batch_mode": "complete_episodes", "compress_observations": false, "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "enable_tf1_exec_eagerly": false, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "preprocessor_pref": "deepmind", "observation_filter": "NoFilter", "update_worker_filter_stats": true, "use_worker_filter_stats": true, "sampler_perf_stats_ema_coef": null, "_is_online": true, "num_learners": 0, "num_gpus_per_learner": 0, "num_cpus_per_learner": "auto", "num_aggregator_actors_per_learner": 0, "max_requests_in_flight_per_aggregator_actor": 3, "local_gpu_idx": 0, "max_requests_in_flight_per_learner": 3, "gamma": 1, "lr": 0.0002847858517, "grad_clip": 0.5, "grad_clip_by": "global_norm", "_train_batch_size_per_learner": 5000, "train_batch_size": 4000, "num_epochs": 1, "minibatch_size": 1000, "shuffle_batch_per_epoch": true, "model": {"fcnet_hiddens": [256, 256], "fcnet_activation": "tanh", "fcnet_weights_initializer": null, "fcnet_weights_initializer_config": null, "fcnet_bias_initializer": null, "fcnet_bias_initializer_config": null, "conv_filters": null, "conv_activation": "relu", "conv_kernel_initializer": null, "conv_kernel_initializer_config": null, "conv_bias_initializer": null, "conv_bias_initializer_config": null, "conv_transpose_kernel_initializer": null, "conv_transpose_kernel_initializer_config": null, "conv_transpose_bias_initializer": null, "conv_transpose_bias_initializer_config": null, "post_fcnet_hiddens": [], "post_fcnet_activation": "relu", "post_fcnet_weights_initializer": null, "post_fcnet_weights_initializer_config": null, "post_fcnet_bias_initializer": null, "post_fcnet_bias_initializer_config": null, "free_log_std": false, "log_std_clip_param": 20.0, "no_final_linear": false, "vf_share_layers": false, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "lstm_weights_initializer": null, "lstm_weights_initializer_config": null, "lstm_bias_initializer": null, "lstm_bias_initializer_config": null, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "attention_use_n_prev_actions": 0, "attention_use_n_prev_rewards": 0, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": null, "custom_model_config": {}, "custom_action_dist": null, "custom_preprocessor": null, "encoder_latent_dim": null, "always_check_shapes": false, "lstm_use_prev_action_reward": -1, "_use_default_native_models": -1, "_disable_preprocessor_api": false, "_disable_action_flattening": false}, "_learner_connector": null, "add_default_connectors_to_learner_pipeline": true, "learner_config_dict": {}, "optimizer": {}, "_learner_class": null, "callbacks_on_algorithm_init": null, "callbacks_on_env_runners_recreated": null, "callbacks_on_offline_eval_runners_recreated": null, "callbacks_on_checkpoint_loaded": null, "callbacks_on_environment_created": null, "callbacks_on_episode_created": null, "callbacks_on_episode_start": null, "callbacks_on_episode_step": null, "callbacks_on_episode_end": null, "callbacks_on_evaluate_start": null, "callbacks_on_evaluate_end": null, "callbacks_on_evaluate_offline_start": null, "callbacks_on_evaluate_offline_end": null, "callbacks_on_sample_end": null, "callbacks_on_train_result": null, "explore": true, "enable_rl_module_and_learner": true, "enable_env_runner_and_connector_v2": true, "_prior_exploration_config": {"type": "StochasticSampling"}, "count_steps_by": "env_steps", "policy_map_capacity": 100, "policy_mapping_fn": "<function AlgorithmConfig.DEFAULT_POLICY_MAPPING_FN at 0x1551edb20>", "policies_to_train": null, "policy_states_are_swappable": false, "observation_fn": null, "offline_data_class": null, "input_read_method": "read_parquet", "input_read_method_kwargs": {}, "input_read_schema": {}, "input_read_episodes": false, "input_read_sample_batches": false, "input_read_batch_size": null, "input_filesystem": null, "input_filesystem_kwargs": {}, "input_compress_columns": ["obs", "new_obs"], "input_spaces_jsonable": true, "materialize_data": false, "materialize_mapped_data": true, "map_batches_kwargs": {}, "iter_batches_kwargs": {}, "ignore_final_observation": false, "prelearner_class": null, "prelearner_buffer_class": null, "prelearner_buffer_kwargs": {}, "prelearner_module_synch_period": 10, "dataset_num_iters_per_learner": null, "input_config": {}, "actions_in_input_normalized": false, "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_config": {}, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "output_max_rows_per_file": null, "output_write_remaining_data": false, "output_write_method": "write_parquet", "output_write_method_kwargs": {}, "output_filesystem": null, "output_filesystem_kwargs": {}, "output_write_episodes": true, "offline_sampling": false, "evaluation_interval": 1, "evaluation_duration": 20, "evaluation_duration_unit": "episodes", "evaluation_sample_timeout_s": 120.0, "evaluation_auto_duration_min_env_steps_per_sample": 100, "evaluation_auto_duration_max_env_steps_per_sample": 2000, "evaluation_parallel_to_training": false, "evaluation_force_reset_envs_before_iteration": true, "evaluation_config": null, "off_policy_estimation_methods": {}, "ope_split_batch_by_episode": true, "evaluation_num_env_runners": 1, "in_evaluation": false, "sync_filters_on_rollout_workers_timeout_s": 10.0, "offline_evaluation_interval": null, "num_offline_eval_runners": 0, "offline_loss_for_module_fn": null, "offline_evaluation_duration": 1, "offline_evaluation_parallel_to_training": false, "offline_evaluation_timeout_s": 120.0, "num_cpus_per_offline_eval_runner": 1, "num_gpus_per_offline_eval_runner": 0, "custom_resources_per_offline_eval_runner": {}, "restart_failed_offline_eval_runners": true, "ignore_offline_eval_runner_failures": false, "max_num_offline_eval_runner_restarts": 1000, "offline_eval_runner_restore_timeout_s": 1800.0, "max_requests_in_flight_per_offline_eval_runner": 1, "validate_offline_eval_runners_after_construction": true, "offline_eval_runner_health_probe_timeout_s": 30.0, "offline_eval_rl_module_inference_only": false, "broadcast_offline_eval_runner_states": false, "offline_eval_batch_size_per_runner": 256, "dataset_num_iters_per_eval_runner": 1, "keep_per_episode_custom_metrics": false, "metrics_episode_collection_timeout_s": 60.0, "metrics_num_episodes_for_smoothing": 100, "min_time_s_per_iteration": null, "min_train_timesteps_per_iteration": 0, "min_sample_timesteps_per_iteration": 0, "log_gradients": true, "export_native_model_files": false, "checkpoint_trainable_policies_only": false, "logger_creator": null, "logger_config": null, "log_level": "WARN", "log_sys_usage": true, "fake_sampler": false, "seed": 8, "restart_failed_env_runners": true, "ignore_env_runner_failures": false, "max_num_env_runner_restarts": 1000, "delay_between_env_runner_restarts_s": 60.0, "restart_failed_sub_environments": false, "num_consecutive_env_runner_failures_tolerance": 100, "env_runner_health_probe_timeout_s": 30.0, "env_runner_restore_timeout_s": 1800.0, "_model_config": {}, "_rl_module_spec": "RLModuleSpec(module_class=None, observation_space=None, action_space=None, inference_only=False, learner_only=False, model_config=DefaultModelConfig(fcnet_hiddens=[60, 90], fcnet_activation='tanh', fcnet_kernel_initializer=None, fcnet_kernel_initializer_kwargs=None, fcnet_bias_initializer=None, fcnet_bias_initializer_kwargs=None, conv_filters=None, conv_activation='relu', conv_kernel_initializer=None, conv_kernel_initializer_kwargs=None, conv_bias_initializer=None, conv_bias_initializer_kwargs=None, head_fcnet_hiddens=[], head_fcnet_activation='relu', head_fcnet_kernel_initializer=None, head_fcnet_kernel_initializer_kwargs=None, head_fcnet_bias_initializer=None, head_fcnet_bias_initializer_kwargs=None, free_log_std=False, log_std_clip_param=20.0, vf_share_layers=True, use_lstm=False, max_seq_len=20, lstm_cell_size=256, lstm_use_prev_action=False, lstm_use_prev_reward=False, lstm_kernel_initializer=None, lstm_kernel_initializer_kwargs=None, lstm_bias_initializer=None, lstm_bias_initializer_kwargs=None), catalog_class=None, load_state_path=None, model_config_dict=None)", "algorithm_config_overrides_per_module": {}, "_per_module_overrides": {}, "_validate_config": true, "_use_msgpack_checkpoints": false, "_torch_grad_scaler_class": null, "_torch_lr_scheduler_classes": null, "_tf_policy_handles_more_than_one_loss": false, "_disable_preprocessor_api": false, "_disable_action_flattening": false, "_disable_initialize_loss_from_dummy_batch": false, "_dont_auto_sync_env_runner_states": false, "env_task_fn": -1, "enable_connectors": -1, "simple_optimizer": false, "policy_map_cache": -1, "worker_cls": -1, "synchronize_filters": -1, "enable_async_evaluation": -1, "custom_async_evaluation_function": -1, "_enable_rl_module_api": -1, "auto_wrap_old_gym_envs": -1, "always_attach_evaluation_results": -1, "replay_sequence_length": null, "_disable_execution_plan_api": -1, "use_critic": true, "use_gae": true, "use_kl_loss": true, "kl_coeff": 0.7464963036515, "kl_target": 0.0270990929592, "vf_loss_coeff": 0.6688075857018, "entropy_coeff": 0.0090570820258, "clip_param": 0.1221781641624, "vf_clip_param": 0.1027808522125, "entropy_coeff_schedule": null, "lr_schedule": null, "sgd_minibatch_size": -1, "vf_share_layers": -1, "__stdout_file__": null, "__stderr_file__": null, "lambda": 0.9099046732075, "input": "sampler", "policies": {"default_policy": [null, null, null, null]}, "callbacks": "<class 'ray.rllib.callbacks.callbacks.RLlibCallback'>", "create_env_on_driver": false, "custom_eval_function": null, "framework": "torch"}, "time_since_restore": 24.732293367385864, "iterations_since_restore": 15, "perf": {"cpu_util_percent": 42.5, "ram_util_percent": 77.73333333333333}}
{"timers": {"training_iteration": 1.5548485788729192, "restore_env_runners": 1.0726344053844734e-05, "training_step": 1.5547218543336951, "env_runner_sampling_timer": 1.4434833999478098, "learner_update_timer": 0.10828529175156253, "synch_weights": 0.0005538082438562087, "restore_eval_env_runners": 8.140908001351055e-06, "evaluation_iteration": 0.1043850479138718, "synch_eval_env_connectors": 0.00013789732772087282, "synch_env_connectors": 4.753273468285953e-06}, "env_runners": {"module_to_env_connector": {"timers": {"connectors": {"remove_single_ts_time_rank_from_batch": 5.735146347292162e-07, "un_batch_to_individual_items": 5.3718915037093075e-06, "normalize_and_clip_actions": 9.468260758298636e-06, "get_actions": 3.926725833552361e-05, "listify_data_for_vector_env": 1.106638902545526e-05, "tensor_to_numpy": 1.3230139138234222e-05}}, "connector_pipeline_timer": 0.00010477301557935085}, "episode_duration_sec_mean": 0.004575044614728539, "env_to_module_connector": {"timers": {"connectors": {"add_time_dim_to_batch_and_zero_pad": 2.376616570851936e-06, "numpy_to_tensor": 8.583510810984393e-06, "batch_individual_items": 6.1467673194654445e-06, "add_observations_from_episodes_to_batch": 3.0077373065513003e-06, "add_states_from_episodes_to_batch": 1.7479965207160335e-06}}, "connector_pipeline_timer": 4.358072747063877e-05}, "env_reset_timer": 3.565190207590238e-05, "episode_return_min": -11.5, "episode_return_max": 8.5, "rlmodule_inference_timer": 2.8273907718289428e-05, "time_between_sampling": 0.0019130661525299376, "num_module_steps_sampled": {"default_policy": 5000.0}, "num_module_steps_sampled_lifetime": {"default_policy": -8635000.0}, "episode_len_mean": 20.0, "episode_return_mean": 5.619999999999999, "num_env_steps_sampled": 5000.0, "num_agent_steps_sampled": {"default_agent": 5000.0}, "module_episode_returns_mean": {"default_policy": 5.619999999999999}, "weights_seq_no": 15.0, "num_env_steps_sampled_lifetime": -8635000.0, "env_step_timer": 1.3880785864028751e-05, "num_episodes_lifetime": -431750.0, "env_to_module_sum_episodes_length_out": 10.36823839457432, "num_episodes": 250.0, "sample": 0.004902680792772422, "agent_episode_returns_mean": {"default_agent": 5.619999999999999}, "env_to_module_sum_episodes_length_in": 10.36823839457432, "episode_len_max": 20, "episode_len_min": 20, "num_agent_steps_sampled_lifetime": {"default_agent": -8635000.0}, "num_env_steps_sampled_lifetime_throughput": 3702.6937855961733}, "learners": {"default_policy": {"curr_entropy_coeff": 0.0090570820258, "weights_seq_no": 16.0, "gradients_default_optimizer_global_norm": 0.03795118257403374, "entropy": 0.49951738119125366, "num_module_steps_trained": 6000, "num_trainable_parameters": 6003, "policy_loss": -0.2068527191877365, "mean_kl_loss": 0.00046676889178343117, "vf_loss": 0.10278083384037018, "module_train_batch_size_mean": 1000.0, "vf_explained_var": 0.004887521266937256, "diff_num_grad_updates_vs_sampler_policy": 1.0, "default_optimizer_learning_rate": 0.0002847858517, "num_module_steps_trained_lifetime": 96000, "vf_loss_unclipped": 26.065872192382812, "total_loss": -0.1426362693309784, "curr_kl_coeff": 1.1390629879315384e-05, "num_module_steps_trained_lifetime_throughput": 396706.6068213617}, "__all_modules__": {"learner_connector": {"connector_pipeline_timer": 0.08438400891360956, "timers": {"connectors": {"numpy_to_tensor": 7.376440458141005e-05, "add_one_ts_to_episodes_and_truncate": 0.008474857316284772, "add_time_dim_to_batch_and_zero_pad": 1.203310000906755e-05, "batch_individual_items": 0.03444145043972164, "general_advantage_estimation": 0.00643302328458463, "add_columns_from_episodes_to_train_batch": 0.03398808225891177, "add_states_from_episodes_to_batch": 3.297247713654553e-06, "add_observations_from_episodes_to_batch": 0.0008352063203148198}}}, "num_module_steps_trained": 6000, "num_trainable_parameters": 6003, "learner_connector_sum_episodes_length_in": 5000.0, "num_module_steps_trained_lifetime": 96000, "num_non_trainable_parameters": 0, "num_env_steps_trained": 31500, "num_env_steps_trained_lifetime": 504000, "learner_connector_sum_episodes_length_out": 5250.0, "num_env_steps_trained_lifetime_throughput": 2077017.2314089022, "num_module_steps_trained_throughput": 396539.81397803925, "num_module_steps_trained_lifetime_throughput": 396162.2580036688}}, "num_training_step_calls_per_iteration": 1, "evaluation": {"env_runners": {"module_episode_returns_mean": {"default_policy": 1.35}, "env_to_module_connector": {"timers": {"connectors": {"add_observations_from_episodes_to_batch": 2.7816925363054037e-06, "numpy_to_tensor": 8.206354154477584e-06, "add_time_dim_to_batch_and_zero_pad": 2.2415899958106055e-06, "batch_individual_items": 6.0711340050081245e-06, "add_states_from_episodes_to_batch": 1.574397425731702e-06}}, "connector_pipeline_timer": 4.210154785616624e-05}, "module_to_env_connector": {"timers": {"connectors": {"get_actions": 3.47895636345675e-05, "un_batch_to_individual_items": 5.245129026613232e-06, "listify_data_for_vector_env": 1.088240010773439e-05, "normalize_and_clip_actions": 9.186655806864158e-06, "tensor_to_numpy": 1.2620067839199544e-05, "remove_single_ts_time_rank_from_batch": 6.159008939063695e-07}}, "connector_pipeline_timer": 9.830250376031762e-05}, "num_env_steps_sampled": 400, "num_agent_steps_sampled_lifetime": {"default_agent": 6400}, "num_env_steps_sampled_lifetime": 80400, "num_module_steps_sampled": {"default_policy": 400}, "episode_len_max": 20, "episode_duration_sec_mean": 0.004448068719357252, "env_reset_timer": 0.00013096012176632942, "episode_return_max": 14.5, "agent_episode_returns_mean": {"default_agent": 1.35}, "num_episodes_lifetime": 320, "env_to_module_sum_episodes_length_in": 10.368238394574323, "episode_len_min": 20, "rlmodule_inference_timer": 2.6455828802121483e-05, "episode_return_mean": 1.35, "env_step_timer": 1.3796555526325107e-05, "env_to_module_sum_episodes_length_out": 10.368238394574323, "num_episodes": 20, "num_agent_steps_sampled": {"default_agent": 400}, "episode_return_min": -14.5, "episode_len_mean": 20.0, "weights_seq_no": 16.0, "num_module_steps_sampled_lifetime": {"default_policy": 6400}, "sample": 0.09837085031998302, "time_between_sampling": 1.5825846161827104}, "num_healthy_workers": 1, "actor_manager_num_outstanding_async_reqs": 0, "num_remote_worker_restarts": 0}, "num_env_steps_sampled_lifetime": -8635000.0, "fault_tolerance": {"num_healthy_workers": 0, "num_remote_worker_restarts": 0}, "env_runner_group": {"actor_manager_num_outstanding_async_reqs": 0}, "done": false, "training_iteration": 16, "trial_id": "4666f_00000", "date": "2025-08-11_19-24-06", "timestamp": 1754933046, "time_this_iter_s": 1.5843119621276855, "time_total_s": 26.31660532951355, "pid": 14463, "hostname": "Mac", "node_ip": "127.0.0.1", "config": {"exploration_config": {}, "extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "placement_strategy": "PACK", "num_gpus": 0, "_fake_gpus": false, "num_cpus_for_main_process": 2, "eager_tracing": true, "eager_max_retraces": 20, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "torch_compile_learner": false, "torch_compile_learner_what_to_compile": "forward_train", "torch_compile_learner_dynamo_backend": "aot_eager", "torch_compile_learner_dynamo_mode": null, "torch_compile_worker": false, "torch_compile_worker_dynamo_backend": "aot_eager", "torch_compile_worker_dynamo_mode": null, "torch_ddp_kwargs": {}, "torch_skip_nan_gradients": false, "env": "Umbrella", "env_config": {}, "observation_space": null, "action_space": null, "clip_rewards": null, "normalize_actions": true, "clip_actions": false, "_is_atari": null, "disable_env_checking": false, "render_env": false, "action_mask_key": "action_mask", "env_runner_cls": null, "num_env_runners": 0, "create_local_env_runner": true, "num_envs_per_env_runner": 1, "gym_env_vectorize_mode": "SYNC", "num_cpus_per_env_runner": 1, "num_gpus_per_env_runner": 0, "custom_resources_per_env_runner": {}, "validate_env_runners_after_construction": true, "episodes_to_numpy": true, "max_requests_in_flight_per_env_runner": 1, "sample_timeout_s": 60.0, "_env_to_module_connector": null, "add_default_connectors_to_env_to_module_pipeline": true, "_module_to_env_connector": null, "add_default_connectors_to_module_to_env_pipeline": true, "merge_env_runner_states": "training_only", "broadcast_env_runner_states": true, "episode_lookback_horizon": 1, "rollout_fragment_length": "auto", "batch_mode": "complete_episodes", "compress_observations": false, "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "enable_tf1_exec_eagerly": false, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "preprocessor_pref": "deepmind", "observation_filter": "NoFilter", "update_worker_filter_stats": true, "use_worker_filter_stats": true, "sampler_perf_stats_ema_coef": null, "_is_online": true, "num_learners": 0, "num_gpus_per_learner": 0, "num_cpus_per_learner": "auto", "num_aggregator_actors_per_learner": 0, "max_requests_in_flight_per_aggregator_actor": 3, "local_gpu_idx": 0, "max_requests_in_flight_per_learner": 3, "gamma": 1, "lr": 0.0002847858517, "grad_clip": 0.5, "grad_clip_by": "global_norm", "_train_batch_size_per_learner": 5000, "train_batch_size": 4000, "num_epochs": 1, "minibatch_size": 1000, "shuffle_batch_per_epoch": true, "model": {"fcnet_hiddens": [256, 256], "fcnet_activation": "tanh", "fcnet_weights_initializer": null, "fcnet_weights_initializer_config": null, "fcnet_bias_initializer": null, "fcnet_bias_initializer_config": null, "conv_filters": null, "conv_activation": "relu", "conv_kernel_initializer": null, "conv_kernel_initializer_config": null, "conv_bias_initializer": null, "conv_bias_initializer_config": null, "conv_transpose_kernel_initializer": null, "conv_transpose_kernel_initializer_config": null, "conv_transpose_bias_initializer": null, "conv_transpose_bias_initializer_config": null, "post_fcnet_hiddens": [], "post_fcnet_activation": "relu", "post_fcnet_weights_initializer": null, "post_fcnet_weights_initializer_config": null, "post_fcnet_bias_initializer": null, "post_fcnet_bias_initializer_config": null, "free_log_std": false, "log_std_clip_param": 20.0, "no_final_linear": false, "vf_share_layers": false, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "lstm_weights_initializer": null, "lstm_weights_initializer_config": null, "lstm_bias_initializer": null, "lstm_bias_initializer_config": null, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "attention_use_n_prev_actions": 0, "attention_use_n_prev_rewards": 0, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": null, "custom_model_config": {}, "custom_action_dist": null, "custom_preprocessor": null, "encoder_latent_dim": null, "always_check_shapes": false, "lstm_use_prev_action_reward": -1, "_use_default_native_models": -1, "_disable_preprocessor_api": false, "_disable_action_flattening": false}, "_learner_connector": null, "add_default_connectors_to_learner_pipeline": true, "learner_config_dict": {}, "optimizer": {}, "_learner_class": null, "callbacks_on_algorithm_init": null, "callbacks_on_env_runners_recreated": null, "callbacks_on_offline_eval_runners_recreated": null, "callbacks_on_checkpoint_loaded": null, "callbacks_on_environment_created": null, "callbacks_on_episode_created": null, "callbacks_on_episode_start": null, "callbacks_on_episode_step": null, "callbacks_on_episode_end": null, "callbacks_on_evaluate_start": null, "callbacks_on_evaluate_end": null, "callbacks_on_evaluate_offline_start": null, "callbacks_on_evaluate_offline_end": null, "callbacks_on_sample_end": null, "callbacks_on_train_result": null, "explore": true, "enable_rl_module_and_learner": true, "enable_env_runner_and_connector_v2": true, "_prior_exploration_config": {"type": "StochasticSampling"}, "count_steps_by": "env_steps", "policy_map_capacity": 100, "policy_mapping_fn": "<function AlgorithmConfig.DEFAULT_POLICY_MAPPING_FN at 0x1551edb20>", "policies_to_train": null, "policy_states_are_swappable": false, "observation_fn": null, "offline_data_class": null, "input_read_method": "read_parquet", "input_read_method_kwargs": {}, "input_read_schema": {}, "input_read_episodes": false, "input_read_sample_batches": false, "input_read_batch_size": null, "input_filesystem": null, "input_filesystem_kwargs": {}, "input_compress_columns": ["obs", "new_obs"], "input_spaces_jsonable": true, "materialize_data": false, "materialize_mapped_data": true, "map_batches_kwargs": {}, "iter_batches_kwargs": {}, "ignore_final_observation": false, "prelearner_class": null, "prelearner_buffer_class": null, "prelearner_buffer_kwargs": {}, "prelearner_module_synch_period": 10, "dataset_num_iters_per_learner": null, "input_config": {}, "actions_in_input_normalized": false, "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_config": {}, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "output_max_rows_per_file": null, "output_write_remaining_data": false, "output_write_method": "write_parquet", "output_write_method_kwargs": {}, "output_filesystem": null, "output_filesystem_kwargs": {}, "output_write_episodes": true, "offline_sampling": false, "evaluation_interval": 1, "evaluation_duration": 20, "evaluation_duration_unit": "episodes", "evaluation_sample_timeout_s": 120.0, "evaluation_auto_duration_min_env_steps_per_sample": 100, "evaluation_auto_duration_max_env_steps_per_sample": 2000, "evaluation_parallel_to_training": false, "evaluation_force_reset_envs_before_iteration": true, "evaluation_config": null, "off_policy_estimation_methods": {}, "ope_split_batch_by_episode": true, "evaluation_num_env_runners": 1, "in_evaluation": false, "sync_filters_on_rollout_workers_timeout_s": 10.0, "offline_evaluation_interval": null, "num_offline_eval_runners": 0, "offline_loss_for_module_fn": null, "offline_evaluation_duration": 1, "offline_evaluation_parallel_to_training": false, "offline_evaluation_timeout_s": 120.0, "num_cpus_per_offline_eval_runner": 1, "num_gpus_per_offline_eval_runner": 0, "custom_resources_per_offline_eval_runner": {}, "restart_failed_offline_eval_runners": true, "ignore_offline_eval_runner_failures": false, "max_num_offline_eval_runner_restarts": 1000, "offline_eval_runner_restore_timeout_s": 1800.0, "max_requests_in_flight_per_offline_eval_runner": 1, "validate_offline_eval_runners_after_construction": true, "offline_eval_runner_health_probe_timeout_s": 30.0, "offline_eval_rl_module_inference_only": false, "broadcast_offline_eval_runner_states": false, "offline_eval_batch_size_per_runner": 256, "dataset_num_iters_per_eval_runner": 1, "keep_per_episode_custom_metrics": false, "metrics_episode_collection_timeout_s": 60.0, "metrics_num_episodes_for_smoothing": 100, "min_time_s_per_iteration": null, "min_train_timesteps_per_iteration": 0, "min_sample_timesteps_per_iteration": 0, "log_gradients": true, "export_native_model_files": false, "checkpoint_trainable_policies_only": false, "logger_creator": null, "logger_config": null, "log_level": "WARN", "log_sys_usage": true, "fake_sampler": false, "seed": 8, "restart_failed_env_runners": true, "ignore_env_runner_failures": false, "max_num_env_runner_restarts": 1000, "delay_between_env_runner_restarts_s": 60.0, "restart_failed_sub_environments": false, "num_consecutive_env_runner_failures_tolerance": 100, "env_runner_health_probe_timeout_s": 30.0, "env_runner_restore_timeout_s": 1800.0, "_model_config": {}, "_rl_module_spec": "RLModuleSpec(module_class=None, observation_space=None, action_space=None, inference_only=False, learner_only=False, model_config=DefaultModelConfig(fcnet_hiddens=[60, 90], fcnet_activation='tanh', fcnet_kernel_initializer=None, fcnet_kernel_initializer_kwargs=None, fcnet_bias_initializer=None, fcnet_bias_initializer_kwargs=None, conv_filters=None, conv_activation='relu', conv_kernel_initializer=None, conv_kernel_initializer_kwargs=None, conv_bias_initializer=None, conv_bias_initializer_kwargs=None, head_fcnet_hiddens=[], head_fcnet_activation='relu', head_fcnet_kernel_initializer=None, head_fcnet_kernel_initializer_kwargs=None, head_fcnet_bias_initializer=None, head_fcnet_bias_initializer_kwargs=None, free_log_std=False, log_std_clip_param=20.0, vf_share_layers=True, use_lstm=False, max_seq_len=20, lstm_cell_size=256, lstm_use_prev_action=False, lstm_use_prev_reward=False, lstm_kernel_initializer=None, lstm_kernel_initializer_kwargs=None, lstm_bias_initializer=None, lstm_bias_initializer_kwargs=None), catalog_class=None, load_state_path=None, model_config_dict=None)", "algorithm_config_overrides_per_module": {}, "_per_module_overrides": {}, "_validate_config": true, "_use_msgpack_checkpoints": false, "_torch_grad_scaler_class": null, "_torch_lr_scheduler_classes": null, "_tf_policy_handles_more_than_one_loss": false, "_disable_preprocessor_api": false, "_disable_action_flattening": false, "_disable_initialize_loss_from_dummy_batch": false, "_dont_auto_sync_env_runner_states": false, "env_task_fn": -1, "enable_connectors": -1, "simple_optimizer": false, "policy_map_cache": -1, "worker_cls": -1, "synchronize_filters": -1, "enable_async_evaluation": -1, "custom_async_evaluation_function": -1, "_enable_rl_module_api": -1, "auto_wrap_old_gym_envs": -1, "always_attach_evaluation_results": -1, "replay_sequence_length": null, "_disable_execution_plan_api": -1, "use_critic": true, "use_gae": true, "use_kl_loss": true, "kl_coeff": 0.7464963036515, "kl_target": 0.0270990929592, "vf_loss_coeff": 0.6688075857018, "entropy_coeff": 0.0090570820258, "clip_param": 0.1221781641624, "vf_clip_param": 0.1027808522125, "entropy_coeff_schedule": null, "lr_schedule": null, "sgd_minibatch_size": -1, "vf_share_layers": -1, "__stdout_file__": null, "__stderr_file__": null, "lambda": 0.9099046732075, "input": "sampler", "policies": {"default_policy": [null, null, null, null]}, "callbacks": "<class 'ray.rllib.callbacks.callbacks.RLlibCallback'>", "create_env_on_driver": false, "custom_eval_function": null, "framework": "torch"}, "time_since_restore": 26.31660532951355, "iterations_since_restore": 16, "perf": {"cpu_util_percent": 43.55, "ram_util_percent": 77.69999999999999}}
{"timers": {"training_iteration": 1.5548961414143796, "restore_env_runners": 1.0680330206579092e-05, "training_step": 1.554768974129646, "env_runner_sampling_timer": 1.4436890292793474, "learner_update_timer": 0.10812608592414107, "synch_weights": 0.000553630991527213, "restore_eval_env_runners": 8.128668248954237e-06, "evaluation_iteration": 0.10434689409487362, "synch_eval_env_connectors": 0.00013770002467540873, "synch_env_connectors": 4.744079791540358e-06}, "env_runners": {"module_to_env_connector": {"timers": {"connectors": {"remove_single_ts_time_rank_from_batch": 5.768932682349942e-07, "un_batch_to_individual_items": 5.395638843752829e-06, "normalize_and_clip_actions": 9.447706958969318e-06, "get_actions": 3.8561169389602766e-05, "listify_data_for_vector_env": 1.1009952893973902e-05, "tensor_to_numpy": 1.31685768471672e-05}}, "connector_pipeline_timer": 0.00010388439175548738}, "episode_duration_sec_mean": 0.004893148656934501, "env_to_module_connector": {"timers": {"connectors": {"add_time_dim_to_batch_and_zero_pad": 2.3463346460540343e-06, "numpy_to_tensor": 8.506498190521698e-06, "batch_individual_items": 6.1765129682292305e-06, "add_observations_from_episodes_to_batch": 3.064826086392379e-06, "add_states_from_episodes_to_batch": 1.7436990562608166e-06}}, "connector_pipeline_timer": 4.35554264334029e-05}, "env_reset_timer": 3.421748703819621e-05, "episode_return_min": -11.5, "episode_return_max": 8.5, "rlmodule_inference_timer": 4.3479638282565604e-05, "time_between_sampling": 0.0015275662594897725, "num_module_steps_sampled": {"default_policy": 5000.0}, "num_module_steps_sampled_lifetime": {"default_policy": -9252500.0}, "episode_len_mean": 20.0, "episode_return_mean": 7.139999999999999, "num_env_steps_sampled": 5000.0, "num_agent_steps_sampled": {"default_agent": 5000.0}, "module_episode_returns_mean": {"default_policy": 7.139999999999999}, "weights_seq_no": 16.0, "num_env_steps_sampled_lifetime": -9252500.0, "env_step_timer": 1.38465613547729e-05, "num_episodes_lifetime": -462625.0, "env_to_module_sum_episodes_length_out": 10.36823839457432, "num_episodes": 250.0, "sample": 0.005081777859960148, "agent_episode_returns_mean": {"default_agent": 7.139999999999999}, "env_to_module_sum_episodes_length_in": 10.36823839457432, "episode_len_max": 20, "episode_len_min": 20, "num_agent_steps_sampled_lifetime": {"default_agent": -9252500.0}, "num_env_steps_sampled_lifetime_throughput": 3715.836146903775}, "learners": {"default_policy": {"curr_entropy_coeff": 0.0090570820258, "weights_seq_no": 17.0, "gradients_default_optimizer_global_norm": 0.10882989317178726, "entropy": 0.4784937798976898, "num_module_steps_trained": 6000, "num_trainable_parameters": 6003, "policy_loss": -0.1093665286898613, "mean_kl_loss": 0.0006145501974970102, "vf_loss": 0.10278083384037018, "module_train_batch_size_mean": 1000.0, "vf_explained_var": 0.004864335060119629, "diff_num_grad_updates_vs_sampler_policy": 1.0, "default_optimizer_learning_rate": 0.0002847858517, "num_module_steps_trained_lifetime": 102000, "vf_loss_unclipped": 25.952669143676758, "total_loss": -0.044959671795368195, "curr_kl_coeff": 5.695314939657692e-06, "num_module_steps_trained_lifetime_throughput": 397656.21929978416}, "__all_modules__": {"learner_connector": {"connector_pipeline_timer": 0.08432981923418871, "timers": {"connectors": {"numpy_to_tensor": 7.36863406452369e-05, "add_one_ts_to_episodes_and_truncate": 0.008466435413945542, "add_time_dim_to_batch_and_zero_pad": 1.2002348270816264e-05, "batch_individual_items": 0.034400100515399865, "general_advantage_estimation": 0.006422194301961109, "add_columns_from_episodes_to_train_batch": 0.033992638935620434, "add_states_from_episodes_to_batch": 3.292604905084592e-06, "add_observations_from_episodes_to_batch": 0.0008374530071981729}}}, "num_module_steps_trained": 6000, "num_trainable_parameters": 6003, "learner_connector_sum_episodes_length_in": 5000.0, "num_module_steps_trained_lifetime": 102000, "num_non_trainable_parameters": 0, "num_env_steps_trained": 31500, "num_env_steps_trained_lifetime": 535500, "learner_connector_sum_episodes_length_out": 5250.0, "num_env_steps_trained_lifetime_throughput": 2082393.9652178122, "num_module_steps_trained_throughput": 397533.2976507041, "num_module_steps_trained_lifetime_throughput": 397164.3777886175}}, "num_training_step_calls_per_iteration": 1, "evaluation": {"env_runners": {"module_episode_returns_mean": {"default_policy": 1.15}, "env_to_module_connector": {"timers": {"connectors": {"add_observations_from_episodes_to_batch": 2.7948578979384983e-06, "numpy_to_tensor": 8.230012823796027e-06, "add_time_dim_to_batch_and_zero_pad": 2.2950592956157414e-06, "batch_individual_items": 6.134197487123346e-06, "add_states_from_episodes_to_batch": 1.5917856940670388e-06}}, "connector_pipeline_timer": 4.2227584587387315e-05}, "module_to_env_connector": {"timers": {"connectors": {"get_actions": 3.5018237282336834e-05, "un_batch_to_individual_items": 5.274079117879202e-06, "listify_data_for_vector_env": 1.0931850758442172e-05, "normalize_and_clip_actions": 9.319126794207857e-06, "tensor_to_numpy": 1.2715412075475938e-05, "remove_single_ts_time_rank_from_batch": 6.301737655157948e-07}}, "connector_pipeline_timer": 9.904001518330913e-05}, "num_env_steps_sampled": 400, "num_agent_steps_sampled_lifetime": {"default_agent": 6800}, "num_env_steps_sampled_lifetime": 85400, "num_module_steps_sampled": {"default_policy": 400}, "episode_len_max": 20, "episode_duration_sec_mean": 0.004451907479669899, "env_reset_timer": 0.00013038052145063341, "episode_return_max": 14.5, "agent_episode_returns_mean": {"default_agent": 1.15}, "num_episodes_lifetime": 340, "env_to_module_sum_episodes_length_in": 10.368238394574323, "episode_len_min": 20, "rlmodule_inference_timer": 2.666215655656655e-05, "episode_return_mean": 1.15, "env_step_timer": 1.383948028123036e-05, "env_to_module_sum_episodes_length_out": 10.368238394574323, "num_episodes": 20, "num_agent_steps_sampled": {"default_agent": 400}, "episode_return_min": -14.5, "episode_len_mean": 20.0, "weights_seq_no": 17.0, "num_module_steps_sampled_lifetime": {"default_policy": 6800}, "sample": 0.09834860098641315, "time_between_sampling": 1.5825791000215987}, "num_healthy_workers": 1, "actor_manager_num_outstanding_async_reqs": 0, "num_remote_worker_restarts": 0}, "num_env_steps_sampled_lifetime": -9252500.0, "fault_tolerance": {"num_healthy_workers": 0, "num_remote_worker_restarts": 0}, "env_runner_group": {"actor_manager_num_outstanding_async_reqs": 0}, "done": false, "training_iteration": 17, "trial_id": "4666f_00000", "date": "2025-08-11_19-24-08", "timestamp": 1754933048, "time_this_iter_s": 1.6629271507263184, "time_total_s": 27.979532480239868, "pid": 14463, "hostname": "Mac", "node_ip": "127.0.0.1", "config": {"exploration_config": {}, "extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "placement_strategy": "PACK", "num_gpus": 0, "_fake_gpus": false, "num_cpus_for_main_process": 2, "eager_tracing": true, "eager_max_retraces": 20, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "torch_compile_learner": false, "torch_compile_learner_what_to_compile": "forward_train", "torch_compile_learner_dynamo_backend": "aot_eager", "torch_compile_learner_dynamo_mode": null, "torch_compile_worker": false, "torch_compile_worker_dynamo_backend": "aot_eager", "torch_compile_worker_dynamo_mode": null, "torch_ddp_kwargs": {}, "torch_skip_nan_gradients": false, "env": "Umbrella", "env_config": {}, "observation_space": null, "action_space": null, "clip_rewards": null, "normalize_actions": true, "clip_actions": false, "_is_atari": null, "disable_env_checking": false, "render_env": false, "action_mask_key": "action_mask", "env_runner_cls": null, "num_env_runners": 0, "create_local_env_runner": true, "num_envs_per_env_runner": 1, "gym_env_vectorize_mode": "SYNC", "num_cpus_per_env_runner": 1, "num_gpus_per_env_runner": 0, "custom_resources_per_env_runner": {}, "validate_env_runners_after_construction": true, "episodes_to_numpy": true, "max_requests_in_flight_per_env_runner": 1, "sample_timeout_s": 60.0, "_env_to_module_connector": null, "add_default_connectors_to_env_to_module_pipeline": true, "_module_to_env_connector": null, "add_default_connectors_to_module_to_env_pipeline": true, "merge_env_runner_states": "training_only", "broadcast_env_runner_states": true, "episode_lookback_horizon": 1, "rollout_fragment_length": "auto", "batch_mode": "complete_episodes", "compress_observations": false, "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "enable_tf1_exec_eagerly": false, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "preprocessor_pref": "deepmind", "observation_filter": "NoFilter", "update_worker_filter_stats": true, "use_worker_filter_stats": true, "sampler_perf_stats_ema_coef": null, "_is_online": true, "num_learners": 0, "num_gpus_per_learner": 0, "num_cpus_per_learner": "auto", "num_aggregator_actors_per_learner": 0, "max_requests_in_flight_per_aggregator_actor": 3, "local_gpu_idx": 0, "max_requests_in_flight_per_learner": 3, "gamma": 1, "lr": 0.0002847858517, "grad_clip": 0.5, "grad_clip_by": "global_norm", "_train_batch_size_per_learner": 5000, "train_batch_size": 4000, "num_epochs": 1, "minibatch_size": 1000, "shuffle_batch_per_epoch": true, "model": {"fcnet_hiddens": [256, 256], "fcnet_activation": "tanh", "fcnet_weights_initializer": null, "fcnet_weights_initializer_config": null, "fcnet_bias_initializer": null, "fcnet_bias_initializer_config": null, "conv_filters": null, "conv_activation": "relu", "conv_kernel_initializer": null, "conv_kernel_initializer_config": null, "conv_bias_initializer": null, "conv_bias_initializer_config": null, "conv_transpose_kernel_initializer": null, "conv_transpose_kernel_initializer_config": null, "conv_transpose_bias_initializer": null, "conv_transpose_bias_initializer_config": null, "post_fcnet_hiddens": [], "post_fcnet_activation": "relu", "post_fcnet_weights_initializer": null, "post_fcnet_weights_initializer_config": null, "post_fcnet_bias_initializer": null, "post_fcnet_bias_initializer_config": null, "free_log_std": false, "log_std_clip_param": 20.0, "no_final_linear": false, "vf_share_layers": false, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "lstm_weights_initializer": null, "lstm_weights_initializer_config": null, "lstm_bias_initializer": null, "lstm_bias_initializer_config": null, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "attention_use_n_prev_actions": 0, "attention_use_n_prev_rewards": 0, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": null, "custom_model_config": {}, "custom_action_dist": null, "custom_preprocessor": null, "encoder_latent_dim": null, "always_check_shapes": false, "lstm_use_prev_action_reward": -1, "_use_default_native_models": -1, "_disable_preprocessor_api": false, "_disable_action_flattening": false}, "_learner_connector": null, "add_default_connectors_to_learner_pipeline": true, "learner_config_dict": {}, "optimizer": {}, "_learner_class": null, "callbacks_on_algorithm_init": null, "callbacks_on_env_runners_recreated": null, "callbacks_on_offline_eval_runners_recreated": null, "callbacks_on_checkpoint_loaded": null, "callbacks_on_environment_created": null, "callbacks_on_episode_created": null, "callbacks_on_episode_start": null, "callbacks_on_episode_step": null, "callbacks_on_episode_end": null, "callbacks_on_evaluate_start": null, "callbacks_on_evaluate_end": null, "callbacks_on_evaluate_offline_start": null, "callbacks_on_evaluate_offline_end": null, "callbacks_on_sample_end": null, "callbacks_on_train_result": null, "explore": true, "enable_rl_module_and_learner": true, "enable_env_runner_and_connector_v2": true, "_prior_exploration_config": {"type": "StochasticSampling"}, "count_steps_by": "env_steps", "policy_map_capacity": 100, "policy_mapping_fn": "<function AlgorithmConfig.DEFAULT_POLICY_MAPPING_FN at 0x1551edb20>", "policies_to_train": null, "policy_states_are_swappable": false, "observation_fn": null, "offline_data_class": null, "input_read_method": "read_parquet", "input_read_method_kwargs": {}, "input_read_schema": {}, "input_read_episodes": false, "input_read_sample_batches": false, "input_read_batch_size": null, "input_filesystem": null, "input_filesystem_kwargs": {}, "input_compress_columns": ["obs", "new_obs"], "input_spaces_jsonable": true, "materialize_data": false, "materialize_mapped_data": true, "map_batches_kwargs": {}, "iter_batches_kwargs": {}, "ignore_final_observation": false, "prelearner_class": null, "prelearner_buffer_class": null, "prelearner_buffer_kwargs": {}, "prelearner_module_synch_period": 10, "dataset_num_iters_per_learner": null, "input_config": {}, "actions_in_input_normalized": false, "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_config": {}, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "output_max_rows_per_file": null, "output_write_remaining_data": false, "output_write_method": "write_parquet", "output_write_method_kwargs": {}, "output_filesystem": null, "output_filesystem_kwargs": {}, "output_write_episodes": true, "offline_sampling": false, "evaluation_interval": 1, "evaluation_duration": 20, "evaluation_duration_unit": "episodes", "evaluation_sample_timeout_s": 120.0, "evaluation_auto_duration_min_env_steps_per_sample": 100, "evaluation_auto_duration_max_env_steps_per_sample": 2000, "evaluation_parallel_to_training": false, "evaluation_force_reset_envs_before_iteration": true, "evaluation_config": null, "off_policy_estimation_methods": {}, "ope_split_batch_by_episode": true, "evaluation_num_env_runners": 1, "in_evaluation": false, "sync_filters_on_rollout_workers_timeout_s": 10.0, "offline_evaluation_interval": null, "num_offline_eval_runners": 0, "offline_loss_for_module_fn": null, "offline_evaluation_duration": 1, "offline_evaluation_parallel_to_training": false, "offline_evaluation_timeout_s": 120.0, "num_cpus_per_offline_eval_runner": 1, "num_gpus_per_offline_eval_runner": 0, "custom_resources_per_offline_eval_runner": {}, "restart_failed_offline_eval_runners": true, "ignore_offline_eval_runner_failures": false, "max_num_offline_eval_runner_restarts": 1000, "offline_eval_runner_restore_timeout_s": 1800.0, "max_requests_in_flight_per_offline_eval_runner": 1, "validate_offline_eval_runners_after_construction": true, "offline_eval_runner_health_probe_timeout_s": 30.0, "offline_eval_rl_module_inference_only": false, "broadcast_offline_eval_runner_states": false, "offline_eval_batch_size_per_runner": 256, "dataset_num_iters_per_eval_runner": 1, "keep_per_episode_custom_metrics": false, "metrics_episode_collection_timeout_s": 60.0, "metrics_num_episodes_for_smoothing": 100, "min_time_s_per_iteration": null, "min_train_timesteps_per_iteration": 0, "min_sample_timesteps_per_iteration": 0, "log_gradients": true, "export_native_model_files": false, "checkpoint_trainable_policies_only": false, "logger_creator": null, "logger_config": null, "log_level": "WARN", "log_sys_usage": true, "fake_sampler": false, "seed": 8, "restart_failed_env_runners": true, "ignore_env_runner_failures": false, "max_num_env_runner_restarts": 1000, "delay_between_env_runner_restarts_s": 60.0, "restart_failed_sub_environments": false, "num_consecutive_env_runner_failures_tolerance": 100, "env_runner_health_probe_timeout_s": 30.0, "env_runner_restore_timeout_s": 1800.0, "_model_config": {}, "_rl_module_spec": "RLModuleSpec(module_class=None, observation_space=None, action_space=None, inference_only=False, learner_only=False, model_config=DefaultModelConfig(fcnet_hiddens=[60, 90], fcnet_activation='tanh', fcnet_kernel_initializer=None, fcnet_kernel_initializer_kwargs=None, fcnet_bias_initializer=None, fcnet_bias_initializer_kwargs=None, conv_filters=None, conv_activation='relu', conv_kernel_initializer=None, conv_kernel_initializer_kwargs=None, conv_bias_initializer=None, conv_bias_initializer_kwargs=None, head_fcnet_hiddens=[], head_fcnet_activation='relu', head_fcnet_kernel_initializer=None, head_fcnet_kernel_initializer_kwargs=None, head_fcnet_bias_initializer=None, head_fcnet_bias_initializer_kwargs=None, free_log_std=False, log_std_clip_param=20.0, vf_share_layers=True, use_lstm=False, max_seq_len=20, lstm_cell_size=256, lstm_use_prev_action=False, lstm_use_prev_reward=False, lstm_kernel_initializer=None, lstm_kernel_initializer_kwargs=None, lstm_bias_initializer=None, lstm_bias_initializer_kwargs=None), catalog_class=None, load_state_path=None, model_config_dict=None)", "algorithm_config_overrides_per_module": {}, "_per_module_overrides": {}, "_validate_config": true, "_use_msgpack_checkpoints": false, "_torch_grad_scaler_class": null, "_torch_lr_scheduler_classes": null, "_tf_policy_handles_more_than_one_loss": false, "_disable_preprocessor_api": false, "_disable_action_flattening": false, "_disable_initialize_loss_from_dummy_batch": false, "_dont_auto_sync_env_runner_states": false, "env_task_fn": -1, "enable_connectors": -1, "simple_optimizer": false, "policy_map_cache": -1, "worker_cls": -1, "synchronize_filters": -1, "enable_async_evaluation": -1, "custom_async_evaluation_function": -1, "_enable_rl_module_api": -1, "auto_wrap_old_gym_envs": -1, "always_attach_evaluation_results": -1, "replay_sequence_length": null, "_disable_execution_plan_api": -1, "use_critic": true, "use_gae": true, "use_kl_loss": true, "kl_coeff": 0.7464963036515, "kl_target": 0.0270990929592, "vf_loss_coeff": 0.6688075857018, "entropy_coeff": 0.0090570820258, "clip_param": 0.1221781641624, "vf_clip_param": 0.1027808522125, "entropy_coeff_schedule": null, "lr_schedule": null, "sgd_minibatch_size": -1, "vf_share_layers": -1, "__stdout_file__": null, "__stderr_file__": null, "lambda": 0.9099046732075, "input": "sampler", "policies": {"default_policy": [null, null, null, null]}, "callbacks": "<class 'ray.rllib.callbacks.callbacks.RLlibCallback'>", "create_env_on_driver": false, "custom_eval_function": null, "framework": "torch"}, "time_since_restore": 27.979532480239868, "iterations_since_restore": 17, "perf": {"cpu_util_percent": 40.3, "ram_util_percent": 77.53333333333333}}
{"timers": {"training_iteration": 1.5551268866601955, "restore_env_runners": 1.0628527323310435e-05, "training_step": 1.5549992260488394, "env_runner_sampling_timer": 1.443132214397261, "learner_update_timer": 0.10890963756474319, "synch_weights": 0.0005538255215237892, "restore_eval_env_runners": 8.112380897253545e-06, "evaluation_iteration": 0.10431339223424231, "synch_eval_env_connectors": 0.00013734177374580893, "synch_env_connectors": 4.733728915159015e-06}, "env_runners": {"module_to_env_connector": {"timers": {"connectors": {"remove_single_ts_time_rank_from_batch": 5.872893397352035e-07, "un_batch_to_individual_items": 5.405301804457919e-06, "normalize_and_clip_actions": 9.470517253407794e-06, "get_actions": 3.898785510370823e-05, "listify_data_for_vector_env": 1.106628237878866e-05, "tensor_to_numpy": 1.321575314152532e-05}}, "connector_pipeline_timer": 0.00010452976374294434}, "episode_duration_sec_mean": 0.004597858335822822, "env_to_module_connector": {"timers": {"connectors": {"add_time_dim_to_batch_and_zero_pad": 2.3768412257666315e-06, "numpy_to_tensor": 8.680059272461796e-06, "batch_individual_items": 6.167921141286939e-06, "add_observations_from_episodes_to_batch": 3.030229254720837e-06, "add_states_from_episodes_to_batch": 1.7621867374522854e-06}}, "connector_pipeline_timer": 4.3814338276201136e-05}, "env_reset_timer": 3.40849067783049e-05, "episode_return_min": -11.5, "episode_return_max": 8.5, "rlmodule_inference_timer": 2.8975468029988036e-05, "time_between_sampling": 0.00147832468687854, "num_module_steps_sampled": {"default_policy": 5000.0}, "num_module_steps_sampled_lifetime": {"default_policy": -9870000.0}, "episode_len_mean": 20.0, "episode_return_mean": 7.2200000000000015, "num_env_steps_sampled": 5000.0, "num_agent_steps_sampled": {"default_agent": 5000.0}, "module_episode_returns_mean": {"default_policy": 7.2200000000000015}, "weights_seq_no": 17.0, "num_env_steps_sampled_lifetime": -9870000.0, "env_step_timer": 1.3895400945436252e-05, "num_episodes_lifetime": -493500.0, "env_to_module_sum_episodes_length_out": 10.36823839457432, "num_episodes": 250.0, "sample": 0.004971978974831208, "agent_episode_returns_mean": {"default_agent": 7.2200000000000015}, "env_to_module_sum_episodes_length_in": 10.36823839457432, "episode_len_max": 20, "episode_len_min": 20, "num_agent_steps_sampled_lifetime": {"default_agent": -9870000.0}, "num_env_steps_sampled_lifetime_throughput": 3739.6708361500087}, "learners": {"default_policy": {"curr_entropy_coeff": 0.0090570820258, "weights_seq_no": 18.0, "gradients_default_optimizer_global_norm": 0.0484977550804615, "entropy": 0.46768543124198914, "num_module_steps_trained": 6000, "num_trainable_parameters": 6003, "policy_loss": -0.044139228761196136, "mean_kl_loss": 3.0231125492719002e-05, "vf_loss": 0.10278083384037018, "module_train_batch_size_mean": 1000.0, "vf_explained_var": 0.005313515663146973, "diff_num_grad_updates_vs_sampler_policy": 1.0, "default_optimizer_learning_rate": 0.0002847858517, "num_module_steps_trained_lifetime": 108000, "vf_loss_unclipped": 26.084064483642578, "total_loss": 0.0203655194491148, "curr_kl_coeff": 2.847657469828846e-06, "num_module_steps_trained_lifetime_throughput": 398588.6159645578}, "__all_modules__": {"learner_connector": {"connector_pipeline_timer": 0.0852135518720718, "timers": {"connectors": {"numpy_to_tensor": 7.359072659185062e-05, "add_one_ts_to_episodes_and_truncate": 0.008459530220000632, "add_time_dim_to_batch_and_zero_pad": 1.1998995059489837e-05, "batch_individual_items": 0.0353026674200845, "general_advantage_estimation": 0.00641156193928926, "add_columns_from_episodes_to_train_batch": 0.03399199588640913, "add_states_from_episodes_to_batch": 3.2909293850249683e-06, "add_observations_from_episodes_to_batch": 0.0008371209772477101}}}, "num_module_steps_trained": 6000, "num_trainable_parameters": 6003, "learner_connector_sum_episodes_length_in": 5000.0, "num_module_steps_trained_lifetime": 108000, "num_non_trainable_parameters": 0, "num_env_steps_trained": 31500, "num_env_steps_trained_lifetime": 567000, "learner_connector_sum_episodes_length_out": 5250.0, "num_env_steps_trained_lifetime_throughput": 2087643.498091338, "num_module_steps_trained_throughput": 398505.4054920937, "num_module_steps_trained_lifetime_throughput": 398143.8032596569}}, "num_training_step_calls_per_iteration": 1, "evaluation": {"env_runners": {"module_episode_returns_mean": {"default_policy": 1.95}, "env_to_module_connector": {"timers": {"connectors": {"add_observations_from_episodes_to_batch": 2.8892964885186277e-06, "numpy_to_tensor": 8.338771398023899e-06, "add_time_dim_to_batch_and_zero_pad": 2.2852598820073462e-06, "batch_individual_items": 6.123111642373073e-06, "add_states_from_episodes_to_batch": 1.7382743892948986e-06}}, "connector_pipeline_timer": 4.279843200122401e-05}, "module_to_env_connector": {"timers": {"connectors": {"get_actions": 3.588786859747326e-05, "un_batch_to_individual_items": 5.3510913326262926e-06, "listify_data_for_vector_env": 1.1087191980277848e-05, "normalize_and_clip_actions": 9.325708546915038e-06, "tensor_to_numpy": 1.2777214153589381e-05, "remove_single_ts_time_rank_from_batch": 6.281593346759377e-07}}, "connector_pipeline_timer": 0.0001002113393632852}, "num_env_steps_sampled": 400, "num_agent_steps_sampled_lifetime": {"default_agent": 7200}, "num_env_steps_sampled_lifetime": 90400, "num_module_steps_sampled": {"default_policy": 400}, "episode_len_max": 20, "episode_duration_sec_mean": 0.0044586225086823104, "env_reset_timer": 0.00012975129529583222, "episode_return_max": 14.5, "agent_episode_returns_mean": {"default_agent": 1.95}, "num_episodes_lifetime": 360, "env_to_module_sum_episodes_length_in": 10.368238394574323, "episode_len_min": 20, "rlmodule_inference_timer": 2.6710480172102187e-05, "episode_return_mean": 1.95, "env_step_timer": 1.411530195595254e-05, "env_to_module_sum_episodes_length_out": 10.368238394574323, "num_episodes": 20, "num_agent_steps_sampled": {"default_agent": 400}, "episode_return_min": -13.5, "episode_len_mean": 20.0, "weights_seq_no": 18.0, "num_module_steps_sampled_lifetime": {"default_policy": 7200}, "sample": 0.09832939247730138, "time_between_sampling": 1.5826968815216378}, "num_healthy_workers": 1, "actor_manager_num_outstanding_async_reqs": 0, "num_remote_worker_restarts": 0}, "num_env_steps_sampled_lifetime": -9870000.0, "fault_tolerance": {"num_healthy_workers": 0, "num_remote_worker_restarts": 0}, "env_runner_group": {"actor_manager_num_outstanding_async_reqs": 0}, "done": false, "training_iteration": 18, "trial_id": "4666f_00000", "date": "2025-08-11_19-24-09", "timestamp": 1754933049, "time_this_iter_s": 1.6817500591278076, "time_total_s": 29.661282539367676, "pid": 14463, "hostname": "Mac", "node_ip": "127.0.0.1", "config": {"exploration_config": {}, "extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "placement_strategy": "PACK", "num_gpus": 0, "_fake_gpus": false, "num_cpus_for_main_process": 2, "eager_tracing": true, "eager_max_retraces": 20, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "torch_compile_learner": false, "torch_compile_learner_what_to_compile": "forward_train", "torch_compile_learner_dynamo_backend": "aot_eager", "torch_compile_learner_dynamo_mode": null, "torch_compile_worker": false, "torch_compile_worker_dynamo_backend": "aot_eager", "torch_compile_worker_dynamo_mode": null, "torch_ddp_kwargs": {}, "torch_skip_nan_gradients": false, "env": "Umbrella", "env_config": {}, "observation_space": null, "action_space": null, "clip_rewards": null, "normalize_actions": true, "clip_actions": false, "_is_atari": null, "disable_env_checking": false, "render_env": false, "action_mask_key": "action_mask", "env_runner_cls": null, "num_env_runners": 0, "create_local_env_runner": true, "num_envs_per_env_runner": 1, "gym_env_vectorize_mode": "SYNC", "num_cpus_per_env_runner": 1, "num_gpus_per_env_runner": 0, "custom_resources_per_env_runner": {}, "validate_env_runners_after_construction": true, "episodes_to_numpy": true, "max_requests_in_flight_per_env_runner": 1, "sample_timeout_s": 60.0, "_env_to_module_connector": null, "add_default_connectors_to_env_to_module_pipeline": true, "_module_to_env_connector": null, "add_default_connectors_to_module_to_env_pipeline": true, "merge_env_runner_states": "training_only", "broadcast_env_runner_states": true, "episode_lookback_horizon": 1, "rollout_fragment_length": "auto", "batch_mode": "complete_episodes", "compress_observations": false, "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "enable_tf1_exec_eagerly": false, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "preprocessor_pref": "deepmind", "observation_filter": "NoFilter", "update_worker_filter_stats": true, "use_worker_filter_stats": true, "sampler_perf_stats_ema_coef": null, "_is_online": true, "num_learners": 0, "num_gpus_per_learner": 0, "num_cpus_per_learner": "auto", "num_aggregator_actors_per_learner": 0, "max_requests_in_flight_per_aggregator_actor": 3, "local_gpu_idx": 0, "max_requests_in_flight_per_learner": 3, "gamma": 1, "lr": 0.0002847858517, "grad_clip": 0.5, "grad_clip_by": "global_norm", "_train_batch_size_per_learner": 5000, "train_batch_size": 4000, "num_epochs": 1, "minibatch_size": 1000, "shuffle_batch_per_epoch": true, "model": {"fcnet_hiddens": [256, 256], "fcnet_activation": "tanh", "fcnet_weights_initializer": null, "fcnet_weights_initializer_config": null, "fcnet_bias_initializer": null, "fcnet_bias_initializer_config": null, "conv_filters": null, "conv_activation": "relu", "conv_kernel_initializer": null, "conv_kernel_initializer_config": null, "conv_bias_initializer": null, "conv_bias_initializer_config": null, "conv_transpose_kernel_initializer": null, "conv_transpose_kernel_initializer_config": null, "conv_transpose_bias_initializer": null, "conv_transpose_bias_initializer_config": null, "post_fcnet_hiddens": [], "post_fcnet_activation": "relu", "post_fcnet_weights_initializer": null, "post_fcnet_weights_initializer_config": null, "post_fcnet_bias_initializer": null, "post_fcnet_bias_initializer_config": null, "free_log_std": false, "log_std_clip_param": 20.0, "no_final_linear": false, "vf_share_layers": false, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "lstm_weights_initializer": null, "lstm_weights_initializer_config": null, "lstm_bias_initializer": null, "lstm_bias_initializer_config": null, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "attention_use_n_prev_actions": 0, "attention_use_n_prev_rewards": 0, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": null, "custom_model_config": {}, "custom_action_dist": null, "custom_preprocessor": null, "encoder_latent_dim": null, "always_check_shapes": false, "lstm_use_prev_action_reward": -1, "_use_default_native_models": -1, "_disable_preprocessor_api": false, "_disable_action_flattening": false}, "_learner_connector": null, "add_default_connectors_to_learner_pipeline": true, "learner_config_dict": {}, "optimizer": {}, "_learner_class": null, "callbacks_on_algorithm_init": null, "callbacks_on_env_runners_recreated": null, "callbacks_on_offline_eval_runners_recreated": null, "callbacks_on_checkpoint_loaded": null, "callbacks_on_environment_created": null, "callbacks_on_episode_created": null, "callbacks_on_episode_start": null, "callbacks_on_episode_step": null, "callbacks_on_episode_end": null, "callbacks_on_evaluate_start": null, "callbacks_on_evaluate_end": null, "callbacks_on_evaluate_offline_start": null, "callbacks_on_evaluate_offline_end": null, "callbacks_on_sample_end": null, "callbacks_on_train_result": null, "explore": true, "enable_rl_module_and_learner": true, "enable_env_runner_and_connector_v2": true, "_prior_exploration_config": {"type": "StochasticSampling"}, "count_steps_by": "env_steps", "policy_map_capacity": 100, "policy_mapping_fn": "<function AlgorithmConfig.DEFAULT_POLICY_MAPPING_FN at 0x1551edb20>", "policies_to_train": null, "policy_states_are_swappable": false, "observation_fn": null, "offline_data_class": null, "input_read_method": "read_parquet", "input_read_method_kwargs": {}, "input_read_schema": {}, "input_read_episodes": false, "input_read_sample_batches": false, "input_read_batch_size": null, "input_filesystem": null, "input_filesystem_kwargs": {}, "input_compress_columns": ["obs", "new_obs"], "input_spaces_jsonable": true, "materialize_data": false, "materialize_mapped_data": true, "map_batches_kwargs": {}, "iter_batches_kwargs": {}, "ignore_final_observation": false, "prelearner_class": null, "prelearner_buffer_class": null, "prelearner_buffer_kwargs": {}, "prelearner_module_synch_period": 10, "dataset_num_iters_per_learner": null, "input_config": {}, "actions_in_input_normalized": false, "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_config": {}, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "output_max_rows_per_file": null, "output_write_remaining_data": false, "output_write_method": "write_parquet", "output_write_method_kwargs": {}, "output_filesystem": null, "output_filesystem_kwargs": {}, "output_write_episodes": true, "offline_sampling": false, "evaluation_interval": 1, "evaluation_duration": 20, "evaluation_duration_unit": "episodes", "evaluation_sample_timeout_s": 120.0, "evaluation_auto_duration_min_env_steps_per_sample": 100, "evaluation_auto_duration_max_env_steps_per_sample": 2000, "evaluation_parallel_to_training": false, "evaluation_force_reset_envs_before_iteration": true, "evaluation_config": null, "off_policy_estimation_methods": {}, "ope_split_batch_by_episode": true, "evaluation_num_env_runners": 1, "in_evaluation": false, "sync_filters_on_rollout_workers_timeout_s": 10.0, "offline_evaluation_interval": null, "num_offline_eval_runners": 0, "offline_loss_for_module_fn": null, "offline_evaluation_duration": 1, "offline_evaluation_parallel_to_training": false, "offline_evaluation_timeout_s": 120.0, "num_cpus_per_offline_eval_runner": 1, "num_gpus_per_offline_eval_runner": 0, "custom_resources_per_offline_eval_runner": {}, "restart_failed_offline_eval_runners": true, "ignore_offline_eval_runner_failures": false, "max_num_offline_eval_runner_restarts": 1000, "offline_eval_runner_restore_timeout_s": 1800.0, "max_requests_in_flight_per_offline_eval_runner": 1, "validate_offline_eval_runners_after_construction": true, "offline_eval_runner_health_probe_timeout_s": 30.0, "offline_eval_rl_module_inference_only": false, "broadcast_offline_eval_runner_states": false, "offline_eval_batch_size_per_runner": 256, "dataset_num_iters_per_eval_runner": 1, "keep_per_episode_custom_metrics": false, "metrics_episode_collection_timeout_s": 60.0, "metrics_num_episodes_for_smoothing": 100, "min_time_s_per_iteration": null, "min_train_timesteps_per_iteration": 0, "min_sample_timesteps_per_iteration": 0, "log_gradients": true, "export_native_model_files": false, "checkpoint_trainable_policies_only": false, "logger_creator": null, "logger_config": null, "log_level": "WARN", "log_sys_usage": true, "fake_sampler": false, "seed": 8, "restart_failed_env_runners": true, "ignore_env_runner_failures": false, "max_num_env_runner_restarts": 1000, "delay_between_env_runner_restarts_s": 60.0, "restart_failed_sub_environments": false, "num_consecutive_env_runner_failures_tolerance": 100, "env_runner_health_probe_timeout_s": 30.0, "env_runner_restore_timeout_s": 1800.0, "_model_config": {}, "_rl_module_spec": "RLModuleSpec(module_class=None, observation_space=None, action_space=None, inference_only=False, learner_only=False, model_config=DefaultModelConfig(fcnet_hiddens=[60, 90], fcnet_activation='tanh', fcnet_kernel_initializer=None, fcnet_kernel_initializer_kwargs=None, fcnet_bias_initializer=None, fcnet_bias_initializer_kwargs=None, conv_filters=None, conv_activation='relu', conv_kernel_initializer=None, conv_kernel_initializer_kwargs=None, conv_bias_initializer=None, conv_bias_initializer_kwargs=None, head_fcnet_hiddens=[], head_fcnet_activation='relu', head_fcnet_kernel_initializer=None, head_fcnet_kernel_initializer_kwargs=None, head_fcnet_bias_initializer=None, head_fcnet_bias_initializer_kwargs=None, free_log_std=False, log_std_clip_param=20.0, vf_share_layers=True, use_lstm=False, max_seq_len=20, lstm_cell_size=256, lstm_use_prev_action=False, lstm_use_prev_reward=False, lstm_kernel_initializer=None, lstm_kernel_initializer_kwargs=None, lstm_bias_initializer=None, lstm_bias_initializer_kwargs=None), catalog_class=None, load_state_path=None, model_config_dict=None)", "algorithm_config_overrides_per_module": {}, "_per_module_overrides": {}, "_validate_config": true, "_use_msgpack_checkpoints": false, "_torch_grad_scaler_class": null, "_torch_lr_scheduler_classes": null, "_tf_policy_handles_more_than_one_loss": false, "_disable_preprocessor_api": false, "_disable_action_flattening": false, "_disable_initialize_loss_from_dummy_batch": false, "_dont_auto_sync_env_runner_states": false, "env_task_fn": -1, "enable_connectors": -1, "simple_optimizer": false, "policy_map_cache": -1, "worker_cls": -1, "synchronize_filters": -1, "enable_async_evaluation": -1, "custom_async_evaluation_function": -1, "_enable_rl_module_api": -1, "auto_wrap_old_gym_envs": -1, "always_attach_evaluation_results": -1, "replay_sequence_length": null, "_disable_execution_plan_api": -1, "use_critic": true, "use_gae": true, "use_kl_loss": true, "kl_coeff": 0.7464963036515, "kl_target": 0.0270990929592, "vf_loss_coeff": 0.6688075857018, "entropy_coeff": 0.0090570820258, "clip_param": 0.1221781641624, "vf_clip_param": 0.1027808522125, "entropy_coeff_schedule": null, "lr_schedule": null, "sgd_minibatch_size": -1, "vf_share_layers": -1, "__stdout_file__": null, "__stderr_file__": null, "lambda": 0.9099046732075, "input": "sampler", "policies": {"default_policy": [null, null, null, null]}, "callbacks": "<class 'ray.rllib.callbacks.callbacks.RLlibCallback'>", "create_env_on_driver": false, "custom_eval_function": null, "framework": "torch"}, "time_since_restore": 29.661282539367676, "iterations_since_restore": 18, "perf": {"cpu_util_percent": 43.400000000000006, "ram_util_percent": 77.80000000000001}}
{"timers": {"training_iteration": 1.5550580086332, "restore_env_runners": 1.057641242762984e-05, "training_step": 1.5549300183782413, "env_runner_sampling_timer": 1.442354423502435, "learner_update_timer": 0.10961745660965964, "synch_weights": 0.0005542039365061723, "restore_eval_env_runners": 8.100007320739123e-06, "evaluation_iteration": 0.10428418789270384, "synch_eval_env_connectors": 0.0001377846061593741, "synch_env_connectors": 4.725141630030738e-06}, "env_runners": {"module_to_env_connector": {"timers": {"connectors": {"remove_single_ts_time_rank_from_batch": 5.753356703115297e-07, "un_batch_to_individual_items": 5.408264432221178e-06, "normalize_and_clip_actions": 9.402652754959334e-06, "get_actions": 3.785081712114659e-05, "listify_data_for_vector_env": 1.0974781971527986e-05, "tensor_to_numpy": 1.3074551080134998e-05}}, "connector_pipeline_timer": 0.00010284959618266917}, "episode_duration_sec_mean": 0.004515188017860056, "env_to_module_connector": {"timers": {"connectors": {"add_time_dim_to_batch_and_zero_pad": 2.351410791734021e-06, "numpy_to_tensor": 8.462532856512984e-06, "batch_individual_items": 6.137948257372829e-06, "add_observations_from_episodes_to_batch": 2.9757217951771202e-06, "add_states_from_episodes_to_batch": 1.7462183899970702e-06}}, "connector_pipeline_timer": 4.3273340285348094e-05}, "env_reset_timer": 3.28584132089807e-05, "episode_return_min": -11.5, "episode_return_max": 8.5, "rlmodule_inference_timer": 2.8282791849605774e-05, "time_between_sampling": 0.0018217530253993317, "num_module_steps_sampled": {"default_policy": 5000.0}, "num_module_steps_sampled_lifetime": {"default_policy": -10487500.0}, "episode_len_mean": 20.0, "episode_return_mean": 7.2200000000000015, "num_env_steps_sampled": 5000.0, "num_agent_steps_sampled": {"default_agent": 5000.0}, "module_episode_returns_mean": {"default_policy": 7.2200000000000015}, "weights_seq_no": 18.0, "num_env_steps_sampled_lifetime": -10487500.0, "env_step_timer": 1.3677893267761955e-05, "num_episodes_lifetime": -524375.0, "env_to_module_sum_episodes_length_out": 10.36823839457432, "num_episodes": 250.0, "sample": 0.004885020842832352, "agent_episode_returns_mean": {"default_agent": 7.2200000000000015}, "env_to_module_sum_episodes_length_in": 10.36823839457432, "episode_len_max": 20, "episode_len_min": 20, "num_agent_steps_sampled_lifetime": {"default_agent": -10487500.0}, "num_env_steps_sampled_lifetime_throughput": 3756.1842665829613}, "learners": {"default_policy": {"curr_entropy_coeff": 0.0090570820258, "weights_seq_no": 19.0, "gradients_default_optimizer_global_norm": 0.03202617168426514, "entropy": 0.4804908037185669, "num_module_steps_trained": 6000, "num_trainable_parameters": 6003, "policy_loss": -0.044341981410980225, "mean_kl_loss": 0.00025957918842323124, "vf_loss": 0.10278083384037018, "module_train_batch_size_mean": 1000.0, "vf_explained_var": 0.005652189254760742, "diff_num_grad_updates_vs_sampler_policy": 1.0, "default_optimizer_learning_rate": 0.0002847858517, "num_module_steps_trained_lifetime": 114000, "vf_loss_unclipped": 26.0632381439209, "total_loss": 0.02004677802324295, "curr_kl_coeff": 1.423828734914423e-06, "num_module_steps_trained_lifetime_throughput": 399810.978895611}, "__all_modules__": {"learner_connector": {"connector_pipeline_timer": 0.086027536353069, "timers": {"connectors": {"numpy_to_tensor": 7.350190923569425e-05, "add_one_ts_to_episodes_and_truncate": 0.00845029116679964, "add_time_dim_to_batch_and_zero_pad": 1.1965675151841873e-05, "batch_individual_items": 0.03612640574586562, "general_advantage_estimation": 0.0063998913199339175, "add_columns_from_episodes_to_train_batch": 0.03400314925734764, "add_states_from_episodes_to_batch": 3.2871891142116754e-06, "add_observations_from_episodes_to_batch": 0.0008374760178555106}}}, "num_module_steps_trained": 6000, "num_trainable_parameters": 6003, "learner_connector_sum_episodes_length_in": 5000.0, "num_module_steps_trained_lifetime": 114000, "num_non_trainable_parameters": 0, "num_env_steps_trained": 31500, "num_env_steps_trained_lifetime": 598500, "learner_connector_sum_episodes_length_out": 5250.0, "num_env_steps_trained_lifetime_throughput": 2094423.823971115, "num_module_steps_trained_throughput": 399768.61575139844, "num_module_steps_trained_lifetime_throughput": 399414.6287019063}}, "num_training_step_calls_per_iteration": 1, "evaluation": {"env_runners": {"module_episode_returns_mean": {"default_policy": 0.75}, "env_to_module_connector": {"timers": {"connectors": {"add_observations_from_episodes_to_batch": 2.716530574924062e-06, "numpy_to_tensor": 7.968056402331943e-06, "add_time_dim_to_batch_and_zero_pad": 2.21370741675775e-06, "batch_individual_items": 5.8692304874731685e-06, "add_states_from_episodes_to_batch": 1.5399507761629141e-06}}, "connector_pipeline_timer": 4.0944893909561505e-05}, "module_to_env_connector": {"timers": {"connectors": {"get_actions": 3.42915534883307e-05, "un_batch_to_individual_items": 5.170487187944586e-06, "listify_data_for_vector_env": 1.0626839718421045e-05, "normalize_and_clip_actions": 9.114634795387958e-06, "tensor_to_numpy": 1.2382899450714026e-05, "remove_single_ts_time_rank_from_batch": 6.127199116103654e-07}}, "connector_pipeline_timer": 9.670693364938769e-05}, "num_env_steps_sampled": 400, "num_agent_steps_sampled_lifetime": {"default_agent": 7600}, "num_env_steps_sampled_lifetime": 95400, "num_module_steps_sampled": {"default_policy": 400}, "episode_len_max": 20, "episode_duration_sec_mean": 0.004451720385113731, "env_reset_timer": 0.00012913170252231546, "episode_return_max": 14.5, "agent_episode_returns_mean": {"default_agent": 0.75}, "num_episodes_lifetime": 380, "env_to_module_sum_episodes_length_in": 10.368238394574323, "episode_len_min": 20, "rlmodule_inference_timer": 2.6038495907940218e-05, "episode_return_mean": 0.75, "env_step_timer": 1.3439879550654151e-05, "env_to_module_sum_episodes_length_out": 10.368238394574323, "num_episodes": 20, "num_agent_steps_sampled": {"default_agent": 400}, "episode_return_min": -13.5, "episode_len_mean": 20.0, "weights_seq_no": 19.0, "num_module_steps_sampled_lifetime": {"default_policy": 7600}, "sample": 0.09829260647210811, "time_between_sampling": 1.5825330993767024}, "num_healthy_workers": 1, "actor_manager_num_outstanding_async_reqs": 0, "num_remote_worker_restarts": 0}, "num_env_steps_sampled_lifetime": -10487500.0, "fault_tolerance": {"num_healthy_workers": 0, "num_remote_worker_restarts": 0}, "env_runner_group": {"actor_manager_num_outstanding_async_reqs": 0}, "done": false, "training_iteration": 19, "trial_id": "4666f_00000", "date": "2025-08-11_19-24-11", "timestamp": 1754933051, "time_this_iter_s": 1.6502070426940918, "time_total_s": 31.311489582061768, "pid": 14463, "hostname": "Mac", "node_ip": "127.0.0.1", "config": {"exploration_config": {}, "extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "placement_strategy": "PACK", "num_gpus": 0, "_fake_gpus": false, "num_cpus_for_main_process": 2, "eager_tracing": true, "eager_max_retraces": 20, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "torch_compile_learner": false, "torch_compile_learner_what_to_compile": "forward_train", "torch_compile_learner_dynamo_backend": "aot_eager", "torch_compile_learner_dynamo_mode": null, "torch_compile_worker": false, "torch_compile_worker_dynamo_backend": "aot_eager", "torch_compile_worker_dynamo_mode": null, "torch_ddp_kwargs": {}, "torch_skip_nan_gradients": false, "env": "Umbrella", "env_config": {}, "observation_space": null, "action_space": null, "clip_rewards": null, "normalize_actions": true, "clip_actions": false, "_is_atari": null, "disable_env_checking": false, "render_env": false, "action_mask_key": "action_mask", "env_runner_cls": null, "num_env_runners": 0, "create_local_env_runner": true, "num_envs_per_env_runner": 1, "gym_env_vectorize_mode": "SYNC", "num_cpus_per_env_runner": 1, "num_gpus_per_env_runner": 0, "custom_resources_per_env_runner": {}, "validate_env_runners_after_construction": true, "episodes_to_numpy": true, "max_requests_in_flight_per_env_runner": 1, "sample_timeout_s": 60.0, "_env_to_module_connector": null, "add_default_connectors_to_env_to_module_pipeline": true, "_module_to_env_connector": null, "add_default_connectors_to_module_to_env_pipeline": true, "merge_env_runner_states": "training_only", "broadcast_env_runner_states": true, "episode_lookback_horizon": 1, "rollout_fragment_length": "auto", "batch_mode": "complete_episodes", "compress_observations": false, "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "enable_tf1_exec_eagerly": false, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "preprocessor_pref": "deepmind", "observation_filter": "NoFilter", "update_worker_filter_stats": true, "use_worker_filter_stats": true, "sampler_perf_stats_ema_coef": null, "_is_online": true, "num_learners": 0, "num_gpus_per_learner": 0, "num_cpus_per_learner": "auto", "num_aggregator_actors_per_learner": 0, "max_requests_in_flight_per_aggregator_actor": 3, "local_gpu_idx": 0, "max_requests_in_flight_per_learner": 3, "gamma": 1, "lr": 0.0002847858517, "grad_clip": 0.5, "grad_clip_by": "global_norm", "_train_batch_size_per_learner": 5000, "train_batch_size": 4000, "num_epochs": 1, "minibatch_size": 1000, "shuffle_batch_per_epoch": true, "model": {"fcnet_hiddens": [256, 256], "fcnet_activation": "tanh", "fcnet_weights_initializer": null, "fcnet_weights_initializer_config": null, "fcnet_bias_initializer": null, "fcnet_bias_initializer_config": null, "conv_filters": null, "conv_activation": "relu", "conv_kernel_initializer": null, "conv_kernel_initializer_config": null, "conv_bias_initializer": null, "conv_bias_initializer_config": null, "conv_transpose_kernel_initializer": null, "conv_transpose_kernel_initializer_config": null, "conv_transpose_bias_initializer": null, "conv_transpose_bias_initializer_config": null, "post_fcnet_hiddens": [], "post_fcnet_activation": "relu", "post_fcnet_weights_initializer": null, "post_fcnet_weights_initializer_config": null, "post_fcnet_bias_initializer": null, "post_fcnet_bias_initializer_config": null, "free_log_std": false, "log_std_clip_param": 20.0, "no_final_linear": false, "vf_share_layers": false, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "lstm_weights_initializer": null, "lstm_weights_initializer_config": null, "lstm_bias_initializer": null, "lstm_bias_initializer_config": null, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "attention_use_n_prev_actions": 0, "attention_use_n_prev_rewards": 0, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": null, "custom_model_config": {}, "custom_action_dist": null, "custom_preprocessor": null, "encoder_latent_dim": null, "always_check_shapes": false, "lstm_use_prev_action_reward": -1, "_use_default_native_models": -1, "_disable_preprocessor_api": false, "_disable_action_flattening": false}, "_learner_connector": null, "add_default_connectors_to_learner_pipeline": true, "learner_config_dict": {}, "optimizer": {}, "_learner_class": null, "callbacks_on_algorithm_init": null, "callbacks_on_env_runners_recreated": null, "callbacks_on_offline_eval_runners_recreated": null, "callbacks_on_checkpoint_loaded": null, "callbacks_on_environment_created": null, "callbacks_on_episode_created": null, "callbacks_on_episode_start": null, "callbacks_on_episode_step": null, "callbacks_on_episode_end": null, "callbacks_on_evaluate_start": null, "callbacks_on_evaluate_end": null, "callbacks_on_evaluate_offline_start": null, "callbacks_on_evaluate_offline_end": null, "callbacks_on_sample_end": null, "callbacks_on_train_result": null, "explore": true, "enable_rl_module_and_learner": true, "enable_env_runner_and_connector_v2": true, "_prior_exploration_config": {"type": "StochasticSampling"}, "count_steps_by": "env_steps", "policy_map_capacity": 100, "policy_mapping_fn": "<function AlgorithmConfig.DEFAULT_POLICY_MAPPING_FN at 0x1551edb20>", "policies_to_train": null, "policy_states_are_swappable": false, "observation_fn": null, "offline_data_class": null, "input_read_method": "read_parquet", "input_read_method_kwargs": {}, "input_read_schema": {}, "input_read_episodes": false, "input_read_sample_batches": false, "input_read_batch_size": null, "input_filesystem": null, "input_filesystem_kwargs": {}, "input_compress_columns": ["obs", "new_obs"], "input_spaces_jsonable": true, "materialize_data": false, "materialize_mapped_data": true, "map_batches_kwargs": {}, "iter_batches_kwargs": {}, "ignore_final_observation": false, "prelearner_class": null, "prelearner_buffer_class": null, "prelearner_buffer_kwargs": {}, "prelearner_module_synch_period": 10, "dataset_num_iters_per_learner": null, "input_config": {}, "actions_in_input_normalized": false, "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_config": {}, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "output_max_rows_per_file": null, "output_write_remaining_data": false, "output_write_method": "write_parquet", "output_write_method_kwargs": {}, "output_filesystem": null, "output_filesystem_kwargs": {}, "output_write_episodes": true, "offline_sampling": false, "evaluation_interval": 1, "evaluation_duration": 20, "evaluation_duration_unit": "episodes", "evaluation_sample_timeout_s": 120.0, "evaluation_auto_duration_min_env_steps_per_sample": 100, "evaluation_auto_duration_max_env_steps_per_sample": 2000, "evaluation_parallel_to_training": false, "evaluation_force_reset_envs_before_iteration": true, "evaluation_config": null, "off_policy_estimation_methods": {}, "ope_split_batch_by_episode": true, "evaluation_num_env_runners": 1, "in_evaluation": false, "sync_filters_on_rollout_workers_timeout_s": 10.0, "offline_evaluation_interval": null, "num_offline_eval_runners": 0, "offline_loss_for_module_fn": null, "offline_evaluation_duration": 1, "offline_evaluation_parallel_to_training": false, "offline_evaluation_timeout_s": 120.0, "num_cpus_per_offline_eval_runner": 1, "num_gpus_per_offline_eval_runner": 0, "custom_resources_per_offline_eval_runner": {}, "restart_failed_offline_eval_runners": true, "ignore_offline_eval_runner_failures": false, "max_num_offline_eval_runner_restarts": 1000, "offline_eval_runner_restore_timeout_s": 1800.0, "max_requests_in_flight_per_offline_eval_runner": 1, "validate_offline_eval_runners_after_construction": true, "offline_eval_runner_health_probe_timeout_s": 30.0, "offline_eval_rl_module_inference_only": false, "broadcast_offline_eval_runner_states": false, "offline_eval_batch_size_per_runner": 256, "dataset_num_iters_per_eval_runner": 1, "keep_per_episode_custom_metrics": false, "metrics_episode_collection_timeout_s": 60.0, "metrics_num_episodes_for_smoothing": 100, "min_time_s_per_iteration": null, "min_train_timesteps_per_iteration": 0, "min_sample_timesteps_per_iteration": 0, "log_gradients": true, "export_native_model_files": false, "checkpoint_trainable_policies_only": false, "logger_creator": null, "logger_config": null, "log_level": "WARN", "log_sys_usage": true, "fake_sampler": false, "seed": 8, "restart_failed_env_runners": true, "ignore_env_runner_failures": false, "max_num_env_runner_restarts": 1000, "delay_between_env_runner_restarts_s": 60.0, "restart_failed_sub_environments": false, "num_consecutive_env_runner_failures_tolerance": 100, "env_runner_health_probe_timeout_s": 30.0, "env_runner_restore_timeout_s": 1800.0, "_model_config": {}, "_rl_module_spec": "RLModuleSpec(module_class=None, observation_space=None, action_space=None, inference_only=False, learner_only=False, model_config=DefaultModelConfig(fcnet_hiddens=[60, 90], fcnet_activation='tanh', fcnet_kernel_initializer=None, fcnet_kernel_initializer_kwargs=None, fcnet_bias_initializer=None, fcnet_bias_initializer_kwargs=None, conv_filters=None, conv_activation='relu', conv_kernel_initializer=None, conv_kernel_initializer_kwargs=None, conv_bias_initializer=None, conv_bias_initializer_kwargs=None, head_fcnet_hiddens=[], head_fcnet_activation='relu', head_fcnet_kernel_initializer=None, head_fcnet_kernel_initializer_kwargs=None, head_fcnet_bias_initializer=None, head_fcnet_bias_initializer_kwargs=None, free_log_std=False, log_std_clip_param=20.0, vf_share_layers=True, use_lstm=False, max_seq_len=20, lstm_cell_size=256, lstm_use_prev_action=False, lstm_use_prev_reward=False, lstm_kernel_initializer=None, lstm_kernel_initializer_kwargs=None, lstm_bias_initializer=None, lstm_bias_initializer_kwargs=None), catalog_class=None, load_state_path=None, model_config_dict=None)", "algorithm_config_overrides_per_module": {}, "_per_module_overrides": {}, "_validate_config": true, "_use_msgpack_checkpoints": false, "_torch_grad_scaler_class": null, "_torch_lr_scheduler_classes": null, "_tf_policy_handles_more_than_one_loss": false, "_disable_preprocessor_api": false, "_disable_action_flattening": false, "_disable_initialize_loss_from_dummy_batch": false, "_dont_auto_sync_env_runner_states": false, "env_task_fn": -1, "enable_connectors": -1, "simple_optimizer": false, "policy_map_cache": -1, "worker_cls": -1, "synchronize_filters": -1, "enable_async_evaluation": -1, "custom_async_evaluation_function": -1, "_enable_rl_module_api": -1, "auto_wrap_old_gym_envs": -1, "always_attach_evaluation_results": -1, "replay_sequence_length": null, "_disable_execution_plan_api": -1, "use_critic": true, "use_gae": true, "use_kl_loss": true, "kl_coeff": 0.7464963036515, "kl_target": 0.0270990929592, "vf_loss_coeff": 0.6688075857018, "entropy_coeff": 0.0090570820258, "clip_param": 0.1221781641624, "vf_clip_param": 0.1027808522125, "entropy_coeff_schedule": null, "lr_schedule": null, "sgd_minibatch_size": -1, "vf_share_layers": -1, "__stdout_file__": null, "__stderr_file__": null, "lambda": 0.9099046732075, "input": "sampler", "policies": {"default_policy": [null, null, null, null]}, "callbacks": "<class 'ray.rllib.callbacks.callbacks.RLlibCallback'>", "create_env_on_driver": false, "custom_eval_function": null, "framework": "torch"}, "time_since_restore": 31.311489582061768, "iterations_since_restore": 19, "perf": {"cpu_util_percent": 40.9, "ram_util_percent": 77.6}}
{"timers": {"training_iteration": 1.5547143143771343, "restore_env_runners": 1.0531067855381722e-05, "training_step": 1.554585710273402, "env_runner_sampling_timer": 1.4421835250971031, "learner_update_timer": 0.10944171663306079, "synch_weights": 0.0005547243973199245, "restore_eval_env_runners": 8.080677100116332e-06, "evaluation_iteration": 0.10423706018347091, "synch_eval_env_connectors": 0.00013824010001804783, "synch_env_connectors": 4.717889354156947e-06}, "env_runners": {"module_to_env_connector": {"timers": {"connectors": {"remove_single_ts_time_rank_from_batch": 5.811637496064396e-07, "un_batch_to_individual_items": 5.533020188716873e-06, "normalize_and_clip_actions": 9.71500230628293e-06, "get_actions": 4.029531871918421e-05, "listify_data_for_vector_env": 1.1306087314474158e-05, "tensor_to_numpy": 1.351231121322152e-05}}, "connector_pipeline_timer": 0.00010703352417345557}, "episode_duration_sec_mean": 0.004680233564693481, "env_to_module_connector": {"timers": {"connectors": {"add_time_dim_to_batch_and_zero_pad": 2.4078332656669282e-06, "numpy_to_tensor": 8.764004499090056e-06, "batch_individual_items": 6.323708323875689e-06, "add_observations_from_episodes_to_batch": 3.0573778129818998e-06, "add_states_from_episodes_to_batch": 1.7718818718741608e-06}}, "connector_pipeline_timer": 4.432253040169697e-05}, "env_reset_timer": 3.7433222874345816e-05, "episode_return_min": -11.5, "episode_return_max": 8.5, "rlmodule_inference_timer": 2.923761780370982e-05, "time_between_sampling": 0.0018449680964690485, "num_module_steps_sampled": {"default_policy": 5000.0}, "num_module_steps_sampled_lifetime": {"default_policy": -11105000.0}, "episode_len_mean": 20.0, "episode_return_mean": 6.580000000000001, "num_env_steps_sampled": 5000.0, "num_agent_steps_sampled": {"default_agent": 5000.0}, "module_episode_returns_mean": {"default_policy": 6.580000000000001}, "weights_seq_no": 19.0, "num_env_steps_sampled_lifetime": -11105000.0, "env_step_timer": 1.4212537079084069e-05, "num_episodes_lifetime": -555250.0, "env_to_module_sum_episodes_length_out": 10.36823839457432, "num_episodes": 250.0, "sample": 0.0049585516278155585, "agent_episode_returns_mean": {"default_agent": 6.580000000000001}, "env_to_module_sum_episodes_length_in": 10.36823839457432, "episode_len_max": 20, "episode_len_min": 20, "num_agent_steps_sampled_lifetime": {"default_agent": -11105000.0}, "num_env_steps_sampled_lifetime_throughput": 3627.8165293888374}, "learners": {"default_policy": {"curr_entropy_coeff": 0.0090570820258, "weights_seq_no": 20.0, "gradients_default_optimizer_global_norm": 0.044757142663002014, "entropy": 0.4970702528953552, "num_module_steps_trained": 6000, "num_trainable_parameters": 6003, "policy_loss": -0.013586264103651047, "mean_kl_loss": 0.0006841972935944796, "vf_loss": 0.10278083384037018, "module_train_batch_size_mean": 1000.0, "vf_explained_var": 0.006448864936828613, "diff_num_grad_updates_vs_sampler_policy": 1.0, "default_optimizer_learning_rate": 0.0002847858517, "num_module_steps_trained_lifetime": 120000, "vf_loss_unclipped": 26.30100440979004, "total_loss": 0.050652336329221725, "curr_kl_coeff": 7.119143674572115e-07, "num_module_steps_trained_lifetime_throughput": 401354.9281651844}, "__all_modules__": {"learner_connector": {"connector_pipeline_timer": 0.08595619432976555, "timers": {"connectors": {"numpy_to_tensor": 7.373938998143619e-05, "add_one_ts_to_episodes_and_truncate": 0.008449832845025537, "add_time_dim_to_batch_and_zero_pad": 1.196476784935302e-05, "batch_individual_items": 0.036065925438542416, "general_advantage_estimation": 0.006388681156770266, "add_columns_from_episodes_to_train_batch": 0.03400331068460402, "add_states_from_episodes_to_batch": 3.2830671509479383e-06, "add_observations_from_episodes_to_batch": 0.0008379587581835204}}}, "num_module_steps_trained": 6000, "num_trainable_parameters": 6003, "learner_connector_sum_episodes_length_in": 5000.0, "num_module_steps_trained_lifetime": 120000, "num_non_trainable_parameters": 0, "num_env_steps_trained": 31500, "num_env_steps_trained_lifetime": 630000, "learner_connector_sum_episodes_length_out": 5250.0, "num_env_steps_trained_lifetime_throughput": 2102857.8237481564, "num_module_steps_trained_throughput": 401349.18435450486, "num_module_steps_trained_lifetime_throughput": 401002.1129106109}}, "num_training_step_calls_per_iteration": 1, "evaluation": {"env_runners": {"module_episode_returns_mean": {"default_policy": 1.95}, "env_to_module_connector": {"timers": {"connectors": {"add_observations_from_episodes_to_batch": 2.733622600295139e-06, "numpy_to_tensor": 8.140600688487448e-06, "add_time_dim_to_batch_and_zero_pad": 2.268561598532828e-06, "batch_individual_items": 5.934181619290404e-06, "add_states_from_episodes_to_batch": 1.5967723670743662e-06}}, "connector_pipeline_timer": 4.16374125652224e-05}, "module_to_env_connector": {"timers": {"connectors": {"get_actions": 3.47251793490394e-05, "un_batch_to_individual_items": 5.223737109313882e-06, "listify_data_for_vector_env": 1.0767831636008016e-05, "normalize_and_clip_actions": 9.121261942051555e-06, "tensor_to_numpy": 1.2511996696135248e-05, "remove_single_ts_time_rank_from_batch": 6.161439307018381e-07}}, "connector_pipeline_timer": 9.764884783388299e-05}, "num_env_steps_sampled": 400, "num_agent_steps_sampled_lifetime": {"default_agent": 8000}, "num_env_steps_sampled_lifetime": 100400, "num_module_steps_sampled": {"default_policy": 400}, "episode_len_max": 20, "episode_duration_sec_mean": 0.004398281212197617, "env_reset_timer": 0.0001290283049033126, "episode_return_max": 14.5, "agent_episode_returns_mean": {"default_agent": 1.95}, "num_episodes_lifetime": 400, "env_to_module_sum_episodes_length_in": 10.368238394574323, "episode_len_min": 20, "rlmodule_inference_timer": 2.6305081932146668e-05, "episode_return_mean": 1.95, "env_step_timer": 1.363414963745497e-05, "env_to_module_sum_episodes_length_out": 10.368238394574323, "num_episodes": 20, "num_agent_steps_sampled": {"default_agent": 400}, "episode_return_min": -13.5, "episode_len_mean": 20.0, "weights_seq_no": 20.0, "num_module_steps_sampled_lifetime": {"default_policy": 8000}, "sample": 0.09826701206828915, "time_between_sampling": 1.5821088554730756}, "num_healthy_workers": 1, "actor_manager_num_outstanding_async_reqs": 0, "num_remote_worker_restarts": 0}, "num_env_steps_sampled_lifetime": -11105000.0, "fault_tolerance": {"num_healthy_workers": 0, "num_remote_worker_restarts": 0}, "env_runner_group": {"actor_manager_num_outstanding_async_reqs": 0}, "done": true, "training_iteration": 20, "trial_id": "4666f_00000", "date": "2025-08-11_19-24-13", "timestamp": 1754933053, "time_this_iter_s": 1.6246309280395508, "time_total_s": 32.93612051010132, "pid": 14463, "hostname": "Mac", "node_ip": "127.0.0.1", "config": {"exploration_config": {}, "extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "placement_strategy": "PACK", "num_gpus": 0, "_fake_gpus": false, "num_cpus_for_main_process": 2, "eager_tracing": true, "eager_max_retraces": 20, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "torch_compile_learner": false, "torch_compile_learner_what_to_compile": "forward_train", "torch_compile_learner_dynamo_backend": "aot_eager", "torch_compile_learner_dynamo_mode": null, "torch_compile_worker": false, "torch_compile_worker_dynamo_backend": "aot_eager", "torch_compile_worker_dynamo_mode": null, "torch_ddp_kwargs": {}, "torch_skip_nan_gradients": false, "env": "Umbrella", "env_config": {}, "observation_space": null, "action_space": null, "clip_rewards": null, "normalize_actions": true, "clip_actions": false, "_is_atari": null, "disable_env_checking": false, "render_env": false, "action_mask_key": "action_mask", "env_runner_cls": null, "num_env_runners": 0, "create_local_env_runner": true, "num_envs_per_env_runner": 1, "gym_env_vectorize_mode": "SYNC", "num_cpus_per_env_runner": 1, "num_gpus_per_env_runner": 0, "custom_resources_per_env_runner": {}, "validate_env_runners_after_construction": true, "episodes_to_numpy": true, "max_requests_in_flight_per_env_runner": 1, "sample_timeout_s": 60.0, "_env_to_module_connector": null, "add_default_connectors_to_env_to_module_pipeline": true, "_module_to_env_connector": null, "add_default_connectors_to_module_to_env_pipeline": true, "merge_env_runner_states": "training_only", "broadcast_env_runner_states": true, "episode_lookback_horizon": 1, "rollout_fragment_length": "auto", "batch_mode": "complete_episodes", "compress_observations": false, "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "enable_tf1_exec_eagerly": false, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "preprocessor_pref": "deepmind", "observation_filter": "NoFilter", "update_worker_filter_stats": true, "use_worker_filter_stats": true, "sampler_perf_stats_ema_coef": null, "_is_online": true, "num_learners": 0, "num_gpus_per_learner": 0, "num_cpus_per_learner": "auto", "num_aggregator_actors_per_learner": 0, "max_requests_in_flight_per_aggregator_actor": 3, "local_gpu_idx": 0, "max_requests_in_flight_per_learner": 3, "gamma": 1, "lr": 0.0002847858517, "grad_clip": 0.5, "grad_clip_by": "global_norm", "_train_batch_size_per_learner": 5000, "train_batch_size": 4000, "num_epochs": 1, "minibatch_size": 1000, "shuffle_batch_per_epoch": true, "model": {"fcnet_hiddens": [256, 256], "fcnet_activation": "tanh", "fcnet_weights_initializer": null, "fcnet_weights_initializer_config": null, "fcnet_bias_initializer": null, "fcnet_bias_initializer_config": null, "conv_filters": null, "conv_activation": "relu", "conv_kernel_initializer": null, "conv_kernel_initializer_config": null, "conv_bias_initializer": null, "conv_bias_initializer_config": null, "conv_transpose_kernel_initializer": null, "conv_transpose_kernel_initializer_config": null, "conv_transpose_bias_initializer": null, "conv_transpose_bias_initializer_config": null, "post_fcnet_hiddens": [], "post_fcnet_activation": "relu", "post_fcnet_weights_initializer": null, "post_fcnet_weights_initializer_config": null, "post_fcnet_bias_initializer": null, "post_fcnet_bias_initializer_config": null, "free_log_std": false, "log_std_clip_param": 20.0, "no_final_linear": false, "vf_share_layers": false, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "lstm_weights_initializer": null, "lstm_weights_initializer_config": null, "lstm_bias_initializer": null, "lstm_bias_initializer_config": null, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "attention_use_n_prev_actions": 0, "attention_use_n_prev_rewards": 0, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": null, "custom_model_config": {}, "custom_action_dist": null, "custom_preprocessor": null, "encoder_latent_dim": null, "always_check_shapes": false, "lstm_use_prev_action_reward": -1, "_use_default_native_models": -1, "_disable_preprocessor_api": false, "_disable_action_flattening": false}, "_learner_connector": null, "add_default_connectors_to_learner_pipeline": true, "learner_config_dict": {}, "optimizer": {}, "_learner_class": null, "callbacks_on_algorithm_init": null, "callbacks_on_env_runners_recreated": null, "callbacks_on_offline_eval_runners_recreated": null, "callbacks_on_checkpoint_loaded": null, "callbacks_on_environment_created": null, "callbacks_on_episode_created": null, "callbacks_on_episode_start": null, "callbacks_on_episode_step": null, "callbacks_on_episode_end": null, "callbacks_on_evaluate_start": null, "callbacks_on_evaluate_end": null, "callbacks_on_evaluate_offline_start": null, "callbacks_on_evaluate_offline_end": null, "callbacks_on_sample_end": null, "callbacks_on_train_result": null, "explore": true, "enable_rl_module_and_learner": true, "enable_env_runner_and_connector_v2": true, "_prior_exploration_config": {"type": "StochasticSampling"}, "count_steps_by": "env_steps", "policy_map_capacity": 100, "policy_mapping_fn": "<function AlgorithmConfig.DEFAULT_POLICY_MAPPING_FN at 0x1551edb20>", "policies_to_train": null, "policy_states_are_swappable": false, "observation_fn": null, "offline_data_class": null, "input_read_method": "read_parquet", "input_read_method_kwargs": {}, "input_read_schema": {}, "input_read_episodes": false, "input_read_sample_batches": false, "input_read_batch_size": null, "input_filesystem": null, "input_filesystem_kwargs": {}, "input_compress_columns": ["obs", "new_obs"], "input_spaces_jsonable": true, "materialize_data": false, "materialize_mapped_data": true, "map_batches_kwargs": {}, "iter_batches_kwargs": {}, "ignore_final_observation": false, "prelearner_class": null, "prelearner_buffer_class": null, "prelearner_buffer_kwargs": {}, "prelearner_module_synch_period": 10, "dataset_num_iters_per_learner": null, "input_config": {}, "actions_in_input_normalized": false, "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_config": {}, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "output_max_rows_per_file": null, "output_write_remaining_data": false, "output_write_method": "write_parquet", "output_write_method_kwargs": {}, "output_filesystem": null, "output_filesystem_kwargs": {}, "output_write_episodes": true, "offline_sampling": false, "evaluation_interval": 1, "evaluation_duration": 20, "evaluation_duration_unit": "episodes", "evaluation_sample_timeout_s": 120.0, "evaluation_auto_duration_min_env_steps_per_sample": 100, "evaluation_auto_duration_max_env_steps_per_sample": 2000, "evaluation_parallel_to_training": false, "evaluation_force_reset_envs_before_iteration": true, "evaluation_config": null, "off_policy_estimation_methods": {}, "ope_split_batch_by_episode": true, "evaluation_num_env_runners": 1, "in_evaluation": false, "sync_filters_on_rollout_workers_timeout_s": 10.0, "offline_evaluation_interval": null, "num_offline_eval_runners": 0, "offline_loss_for_module_fn": null, "offline_evaluation_duration": 1, "offline_evaluation_parallel_to_training": false, "offline_evaluation_timeout_s": 120.0, "num_cpus_per_offline_eval_runner": 1, "num_gpus_per_offline_eval_runner": 0, "custom_resources_per_offline_eval_runner": {}, "restart_failed_offline_eval_runners": true, "ignore_offline_eval_runner_failures": false, "max_num_offline_eval_runner_restarts": 1000, "offline_eval_runner_restore_timeout_s": 1800.0, "max_requests_in_flight_per_offline_eval_runner": 1, "validate_offline_eval_runners_after_construction": true, "offline_eval_runner_health_probe_timeout_s": 30.0, "offline_eval_rl_module_inference_only": false, "broadcast_offline_eval_runner_states": false, "offline_eval_batch_size_per_runner": 256, "dataset_num_iters_per_eval_runner": 1, "keep_per_episode_custom_metrics": false, "metrics_episode_collection_timeout_s": 60.0, "metrics_num_episodes_for_smoothing": 100, "min_time_s_per_iteration": null, "min_train_timesteps_per_iteration": 0, "min_sample_timesteps_per_iteration": 0, "log_gradients": true, "export_native_model_files": false, "checkpoint_trainable_policies_only": false, "logger_creator": null, "logger_config": null, "log_level": "WARN", "log_sys_usage": true, "fake_sampler": false, "seed": 8, "restart_failed_env_runners": true, "ignore_env_runner_failures": false, "max_num_env_runner_restarts": 1000, "delay_between_env_runner_restarts_s": 60.0, "restart_failed_sub_environments": false, "num_consecutive_env_runner_failures_tolerance": 100, "env_runner_health_probe_timeout_s": 30.0, "env_runner_restore_timeout_s": 1800.0, "_model_config": {}, "_rl_module_spec": "RLModuleSpec(module_class=None, observation_space=None, action_space=None, inference_only=False, learner_only=False, model_config=DefaultModelConfig(fcnet_hiddens=[60, 90], fcnet_activation='tanh', fcnet_kernel_initializer=None, fcnet_kernel_initializer_kwargs=None, fcnet_bias_initializer=None, fcnet_bias_initializer_kwargs=None, conv_filters=None, conv_activation='relu', conv_kernel_initializer=None, conv_kernel_initializer_kwargs=None, conv_bias_initializer=None, conv_bias_initializer_kwargs=None, head_fcnet_hiddens=[], head_fcnet_activation='relu', head_fcnet_kernel_initializer=None, head_fcnet_kernel_initializer_kwargs=None, head_fcnet_bias_initializer=None, head_fcnet_bias_initializer_kwargs=None, free_log_std=False, log_std_clip_param=20.0, vf_share_layers=True, use_lstm=False, max_seq_len=20, lstm_cell_size=256, lstm_use_prev_action=False, lstm_use_prev_reward=False, lstm_kernel_initializer=None, lstm_kernel_initializer_kwargs=None, lstm_bias_initializer=None, lstm_bias_initializer_kwargs=None), catalog_class=None, load_state_path=None, model_config_dict=None)", "algorithm_config_overrides_per_module": {}, "_per_module_overrides": {}, "_validate_config": true, "_use_msgpack_checkpoints": false, "_torch_grad_scaler_class": null, "_torch_lr_scheduler_classes": null, "_tf_policy_handles_more_than_one_loss": false, "_disable_preprocessor_api": false, "_disable_action_flattening": false, "_disable_initialize_loss_from_dummy_batch": false, "_dont_auto_sync_env_runner_states": false, "env_task_fn": -1, "enable_connectors": -1, "simple_optimizer": false, "policy_map_cache": -1, "worker_cls": -1, "synchronize_filters": -1, "enable_async_evaluation": -1, "custom_async_evaluation_function": -1, "_enable_rl_module_api": -1, "auto_wrap_old_gym_envs": -1, "always_attach_evaluation_results": -1, "replay_sequence_length": null, "_disable_execution_plan_api": -1, "use_critic": true, "use_gae": true, "use_kl_loss": true, "kl_coeff": 0.7464963036515, "kl_target": 0.0270990929592, "vf_loss_coeff": 0.6688075857018, "entropy_coeff": 0.0090570820258, "clip_param": 0.1221781641624, "vf_clip_param": 0.1027808522125, "entropy_coeff_schedule": null, "lr_schedule": null, "sgd_minibatch_size": -1, "vf_share_layers": -1, "__stdout_file__": null, "__stderr_file__": null, "lambda": 0.9099046732075, "input": "sampler", "policies": {"default_policy": [null, null, null, null]}, "callbacks": "<class 'ray.rllib.callbacks.callbacks.RLlibCallback'>", "create_env_on_driver": false, "custom_eval_function": null, "framework": "torch"}, "time_since_restore": 32.93612051010132, "iterations_since_restore": 20, "perf": {"cpu_util_percent": 42.199999999999996, "ram_util_percent": 77.10000000000001}}
