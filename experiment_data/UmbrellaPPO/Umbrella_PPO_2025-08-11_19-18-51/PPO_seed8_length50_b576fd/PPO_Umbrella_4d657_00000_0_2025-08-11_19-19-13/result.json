{"timers": {"training_iteration": 2.3381494591012597, "restore_env_runners": 1.5125027857720852e-05, "training_step": 2.3380006249062717, "env_runner_sampling_timer": 2.227929124957882, "learner_update_timer": 0.10670608305372298, "synch_weights": 0.0007335420232266188}, "env_runners": {"sample": 0.014328368523171162, "module_episode_returns_mean": {"default_policy": -1.5}, "env_to_module_connector": {"timers": {"connectors": {"add_states_from_episodes_to_batch": 2.338521123347851e-06, "numpy_to_tensor": 1.6253170741547062e-05, "add_observations_from_episodes_to_batch": 4.327208589401332e-06, "add_time_dim_to_batch_and_zero_pad": 3.6631336596567054e-06, "batch_individual_items": 1.1883763332315213e-05}}, "connector_pipeline_timer": 6.912682673091122e-05}, "env_reset_timer": 0.00014899391146040275, "module_to_env_connector": {"timers": {"connectors": {"tensor_to_numpy": 2.097737605860895e-05, "normalize_and_clip_actions": 1.72679353113243e-05, "listify_data_for_vector_env": 1.5783037823938793e-05, "remove_single_ts_time_rank_from_batch": 8.582202330008294e-07, "un_batch_to_individual_items": 8.458601803914371e-06, "get_actions": 7.626567531029513e-05}}, "connector_pipeline_timer": 0.000176927300501942}, "num_module_steps_sampled": {"default_policy": 5000.0}, "weights_seq_no": 0.0, "agent_episode_returns_mean": {"default_agent": -1.5}, "env_to_module_sum_episodes_length_out": 10.191744832559449, "env_step_timer": 2.3801357477800807e-05, "num_env_steps_sampled": 5000.0, "episode_return_mean": -1.5, "num_episodes_lifetime": 31375.0, "num_module_steps_sampled_lifetime": {"default_policy": 627500.0}, "time_between_sampling": 0.0007419729635657606, "env_to_module_sum_episodes_length_in": 10.191744832559449, "rlmodule_inference_timer": 8.795933163957456e-05, "episode_duration_sec_mean": 0.007623117967974396, "num_env_steps_sampled_lifetime": 627500.0, "episode_len_max": 20, "episode_len_mean": 20.0, "num_episodes": 250.0, "episode_return_max": 8.5, "num_agent_steps_sampled": {"default_agent": 5000.0}, "episode_len_min": 20, "episode_return_min": -11.5, "num_agent_steps_sampled_lifetime": {"default_agent": 627500.0}, "num_env_steps_sampled_lifetime_throughput": 2857.574930946459}, "learners": {"__all_modules__": {"num_env_steps_trained": 31500, "learner_connector": {"timers": {"connectors": {"add_one_ts_to_episodes_and_truncate": 0.007654500077478588, "add_columns_from_episodes_to_train_batch": 0.0341477079782635, "general_advantage_estimation": 0.006572833051905036, "add_states_from_episodes_to_batch": 3.7499703466892242e-06, "add_time_dim_to_batch_and_zero_pad": 1.2375065125524998e-05, "batch_individual_items": 0.030425749951973557, "numpy_to_tensor": 6.941694300621748e-05, "add_observations_from_episodes_to_batch": 0.000800292007625103}}, "connector_pipeline_timer": 0.0798246250487864}, "num_module_steps_trained_lifetime": 6000, "learner_connector_sum_episodes_length_in": 5000, "num_module_steps_trained": 6000, "learner_connector_sum_episodes_length_out": 5250, "num_env_steps_trained_lifetime": 31500, "num_non_trainable_parameters": 0, "num_trainable_parameters": 6003, "num_env_steps_trained_lifetime_throughput": 2321616.8384398594, "num_module_steps_trained_throughput": 444917.4305838883, "num_module_steps_trained_lifetime_throughput": 443924.73824163666}, "default_policy": {"mean_kl_loss": 0.0005123130395077169, "curr_kl_coeff": 0.3732481598854065, "module_train_batch_size_mean": 1000.0, "weights_seq_no": 1.0, "default_optimizer_learning_rate": 0.0002847858517, "num_trainable_parameters": 6003, "num_module_steps_trained_lifetime": 6000, "entropy": 0.6905115842819214, "curr_entropy_coeff": 0.0090570820258, "num_module_steps_trained": 6000, "policy_loss": -0.04181544482707977, "vf_loss": 0.10278083384037018, "total_loss": 0.02105357125401497, "diff_num_grad_updates_vs_sampler_policy": 1.0, "vf_loss_unclipped": 28.887786865234375, "vf_explained_var": 0.0005095601081848145, "gradients_default_optimizer_global_norm": 0.040778517723083496, "num_module_steps_trained_lifetime_throughput": 446318.52488701255}}, "num_training_step_calls_per_iteration": 1, "num_env_steps_sampled_lifetime": 627500.0, "evaluation": {"env_runners": {"module_to_env_connector": {"timers": {"connectors": {"un_batch_to_individual_items": 5.818255584817213e-06, "get_actions": 5.877341218556992e-05, "tensor_to_numpy": 1.7490496863151056e-05, "listify_data_for_vector_env": 1.1924474718431026e-05, "normalize_and_clip_actions": 1.2540256244982273e-05, "remove_single_ts_time_rank_from_batch": 7.662648982994956e-07}}, "connector_pipeline_timer": 0.00013431411990750741}, "env_step_timer": 1.6993115751729326e-05, "env_to_module_connector": {"timers": {"connectors": {"add_observations_from_episodes_to_batch": 4.172907062139472e-06, "add_time_dim_to_batch_and_zero_pad": 3.1598977570869744e-06, "batch_individual_items": 7.125236794514293e-06, "add_states_from_episodes_to_batch": 1.7095004382097277e-06, "numpy_to_tensor": 9.432975321242452e-06}}, "connector_pipeline_timer": 5.129000597217301e-05}, "episode_duration_sec_mean": 0.0051374938164372, "num_episodes": 20, "episode_return_min": -14.5, "agent_episode_returns_mean": {"default_agent": -2.25}, "sample": 0.11404441704507917, "num_agent_steps_sampled_lifetime": {"default_agent": 400}, "env_to_module_sum_episodes_length_out": 10.216013141322508, "num_env_steps_sampled": 400, "module_episode_returns_mean": {"default_policy": -2.25}, "rlmodule_inference_timer": 3.726366980484553e-05, "episode_return_max": 12.5, "env_reset_timer": 0.0010747499763965607, "num_agent_steps_sampled": {"default_agent": 400}, "episode_return_mean": -2.25, "num_episodes_lifetime": 20, "weights_seq_no": 1.0, "env_to_module_sum_episodes_length_in": 10.216013141322508, "num_env_steps_sampled_lifetime": 5400, "num_module_steps_sampled": {"default_policy": 400}, "episode_len_max": 20, "episode_len_mean": 20.0, "episode_len_min": 20, "num_module_steps_sampled_lifetime": {"default_policy": 400}}, "num_healthy_workers": 1, "actor_manager_num_outstanding_async_reqs": 0, "num_remote_worker_restarts": 0}, "fault_tolerance": {"num_healthy_workers": 0, "num_remote_worker_restarts": 0}, "env_runner_group": {"actor_manager_num_outstanding_async_reqs": 0}, "done": false, "training_iteration": 1, "trial_id": "4d657_00000", "date": "2025-08-11_19-20-53", "timestamp": 1754932853, "time_this_iter_s": 2.4690799713134766, "time_total_s": 2.4690799713134766, "pid": 14261, "hostname": "Mac", "node_ip": "127.0.0.1", "config": {"exploration_config": {}, "extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "placement_strategy": "PACK", "num_gpus": 0, "_fake_gpus": false, "num_cpus_for_main_process": 2, "eager_tracing": true, "eager_max_retraces": 20, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "torch_compile_learner": false, "torch_compile_learner_what_to_compile": "forward_train", "torch_compile_learner_dynamo_backend": "aot_eager", "torch_compile_learner_dynamo_mode": null, "torch_compile_worker": false, "torch_compile_worker_dynamo_backend": "aot_eager", "torch_compile_worker_dynamo_mode": null, "torch_ddp_kwargs": {}, "torch_skip_nan_gradients": false, "env": "Umbrella", "env_config": {}, "observation_space": null, "action_space": null, "clip_rewards": null, "normalize_actions": true, "clip_actions": false, "_is_atari": null, "disable_env_checking": false, "render_env": false, "action_mask_key": "action_mask", "env_runner_cls": null, "num_env_runners": 0, "create_local_env_runner": true, "num_envs_per_env_runner": 1, "gym_env_vectorize_mode": "SYNC", "num_cpus_per_env_runner": 1, "num_gpus_per_env_runner": 0, "custom_resources_per_env_runner": {}, "validate_env_runners_after_construction": true, "episodes_to_numpy": true, "max_requests_in_flight_per_env_runner": 1, "sample_timeout_s": 60.0, "_env_to_module_connector": null, "add_default_connectors_to_env_to_module_pipeline": true, "_module_to_env_connector": null, "add_default_connectors_to_module_to_env_pipeline": true, "merge_env_runner_states": "training_only", "broadcast_env_runner_states": true, "episode_lookback_horizon": 1, "rollout_fragment_length": "auto", "batch_mode": "complete_episodes", "compress_observations": false, "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "enable_tf1_exec_eagerly": false, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "preprocessor_pref": "deepmind", "observation_filter": "NoFilter", "update_worker_filter_stats": true, "use_worker_filter_stats": true, "sampler_perf_stats_ema_coef": null, "_is_online": true, "num_learners": 0, "num_gpus_per_learner": 0, "num_cpus_per_learner": "auto", "num_aggregator_actors_per_learner": 0, "max_requests_in_flight_per_aggregator_actor": 3, "local_gpu_idx": 0, "max_requests_in_flight_per_learner": 3, "gamma": 1, "lr": 0.0002847858517, "grad_clip": 0.5, "grad_clip_by": "global_norm", "_train_batch_size_per_learner": 5000, "train_batch_size": 4000, "num_epochs": 1, "minibatch_size": 1000, "shuffle_batch_per_epoch": true, "model": {"fcnet_hiddens": [256, 256], "fcnet_activation": "tanh", "fcnet_weights_initializer": null, "fcnet_weights_initializer_config": null, "fcnet_bias_initializer": null, "fcnet_bias_initializer_config": null, "conv_filters": null, "conv_activation": "relu", "conv_kernel_initializer": null, "conv_kernel_initializer_config": null, "conv_bias_initializer": null, "conv_bias_initializer_config": null, "conv_transpose_kernel_initializer": null, "conv_transpose_kernel_initializer_config": null, "conv_transpose_bias_initializer": null, "conv_transpose_bias_initializer_config": null, "post_fcnet_hiddens": [], "post_fcnet_activation": "relu", "post_fcnet_weights_initializer": null, "post_fcnet_weights_initializer_config": null, "post_fcnet_bias_initializer": null, "post_fcnet_bias_initializer_config": null, "free_log_std": false, "log_std_clip_param": 20.0, "no_final_linear": false, "vf_share_layers": false, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "lstm_weights_initializer": null, "lstm_weights_initializer_config": null, "lstm_bias_initializer": null, "lstm_bias_initializer_config": null, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "attention_use_n_prev_actions": 0, "attention_use_n_prev_rewards": 0, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": null, "custom_model_config": {}, "custom_action_dist": null, "custom_preprocessor": null, "encoder_latent_dim": null, "always_check_shapes": false, "lstm_use_prev_action_reward": -1, "_use_default_native_models": -1, "_disable_preprocessor_api": false, "_disable_action_flattening": false}, "_learner_connector": null, "add_default_connectors_to_learner_pipeline": true, "learner_config_dict": {}, "optimizer": {}, "_learner_class": null, "callbacks_on_algorithm_init": null, "callbacks_on_env_runners_recreated": null, "callbacks_on_offline_eval_runners_recreated": null, "callbacks_on_checkpoint_loaded": null, "callbacks_on_environment_created": null, "callbacks_on_episode_created": null, "callbacks_on_episode_start": null, "callbacks_on_episode_step": null, "callbacks_on_episode_end": null, "callbacks_on_evaluate_start": null, "callbacks_on_evaluate_end": null, "callbacks_on_evaluate_offline_start": null, "callbacks_on_evaluate_offline_end": null, "callbacks_on_sample_end": null, "callbacks_on_train_result": null, "explore": true, "enable_rl_module_and_learner": true, "enable_env_runner_and_connector_v2": true, "_prior_exploration_config": {"type": "StochasticSampling"}, "count_steps_by": "env_steps", "policy_map_capacity": 100, "policy_mapping_fn": "<function AlgorithmConfig.DEFAULT_POLICY_MAPPING_FN at 0x1680e9b20>", "policies_to_train": null, "policy_states_are_swappable": false, "observation_fn": null, "offline_data_class": null, "input_read_method": "read_parquet", "input_read_method_kwargs": {}, "input_read_schema": {}, "input_read_episodes": false, "input_read_sample_batches": false, "input_read_batch_size": null, "input_filesystem": null, "input_filesystem_kwargs": {}, "input_compress_columns": ["obs", "new_obs"], "input_spaces_jsonable": true, "materialize_data": false, "materialize_mapped_data": true, "map_batches_kwargs": {}, "iter_batches_kwargs": {}, "ignore_final_observation": false, "prelearner_class": null, "prelearner_buffer_class": null, "prelearner_buffer_kwargs": {}, "prelearner_module_synch_period": 10, "dataset_num_iters_per_learner": null, "input_config": {}, "actions_in_input_normalized": false, "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_config": {}, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "output_max_rows_per_file": null, "output_write_remaining_data": false, "output_write_method": "write_parquet", "output_write_method_kwargs": {}, "output_filesystem": null, "output_filesystem_kwargs": {}, "output_write_episodes": true, "offline_sampling": false, "evaluation_interval": 1, "evaluation_duration": 20, "evaluation_duration_unit": "episodes", "evaluation_sample_timeout_s": 120.0, "evaluation_auto_duration_min_env_steps_per_sample": 100, "evaluation_auto_duration_max_env_steps_per_sample": 2000, "evaluation_parallel_to_training": false, "evaluation_force_reset_envs_before_iteration": true, "evaluation_config": null, "off_policy_estimation_methods": {}, "ope_split_batch_by_episode": true, "evaluation_num_env_runners": 1, "in_evaluation": false, "sync_filters_on_rollout_workers_timeout_s": 10.0, "offline_evaluation_interval": null, "num_offline_eval_runners": 0, "offline_loss_for_module_fn": null, "offline_evaluation_duration": 1, "offline_evaluation_parallel_to_training": false, "offline_evaluation_timeout_s": 120.0, "num_cpus_per_offline_eval_runner": 1, "num_gpus_per_offline_eval_runner": 0, "custom_resources_per_offline_eval_runner": {}, "restart_failed_offline_eval_runners": true, "ignore_offline_eval_runner_failures": false, "max_num_offline_eval_runner_restarts": 1000, "offline_eval_runner_restore_timeout_s": 1800.0, "max_requests_in_flight_per_offline_eval_runner": 1, "validate_offline_eval_runners_after_construction": true, "offline_eval_runner_health_probe_timeout_s": 30.0, "offline_eval_rl_module_inference_only": false, "broadcast_offline_eval_runner_states": false, "offline_eval_batch_size_per_runner": 256, "dataset_num_iters_per_eval_runner": 1, "keep_per_episode_custom_metrics": false, "metrics_episode_collection_timeout_s": 60.0, "metrics_num_episodes_for_smoothing": 100, "min_time_s_per_iteration": null, "min_train_timesteps_per_iteration": 0, "min_sample_timesteps_per_iteration": 0, "log_gradients": true, "export_native_model_files": false, "checkpoint_trainable_policies_only": false, "logger_creator": null, "logger_config": null, "log_level": "WARN", "log_sys_usage": true, "fake_sampler": false, "seed": 8, "restart_failed_env_runners": true, "ignore_env_runner_failures": false, "max_num_env_runner_restarts": 1000, "delay_between_env_runner_restarts_s": 60.0, "restart_failed_sub_environments": false, "num_consecutive_env_runner_failures_tolerance": 100, "env_runner_health_probe_timeout_s": 30.0, "env_runner_restore_timeout_s": 1800.0, "_model_config": {}, "_rl_module_spec": "RLModuleSpec(module_class=None, observation_space=None, action_space=None, inference_only=False, learner_only=False, model_config=DefaultModelConfig(fcnet_hiddens=[60, 90], fcnet_activation='tanh', fcnet_kernel_initializer=None, fcnet_kernel_initializer_kwargs=None, fcnet_bias_initializer=None, fcnet_bias_initializer_kwargs=None, conv_filters=None, conv_activation='relu', conv_kernel_initializer=None, conv_kernel_initializer_kwargs=None, conv_bias_initializer=None, conv_bias_initializer_kwargs=None, head_fcnet_hiddens=[], head_fcnet_activation='relu', head_fcnet_kernel_initializer=None, head_fcnet_kernel_initializer_kwargs=None, head_fcnet_bias_initializer=None, head_fcnet_bias_initializer_kwargs=None, free_log_std=False, log_std_clip_param=20.0, vf_share_layers=True, use_lstm=False, max_seq_len=20, lstm_cell_size=256, lstm_use_prev_action=False, lstm_use_prev_reward=False, lstm_kernel_initializer=None, lstm_kernel_initializer_kwargs=None, lstm_bias_initializer=None, lstm_bias_initializer_kwargs=None), catalog_class=None, load_state_path=None, model_config_dict=None)", "algorithm_config_overrides_per_module": {}, "_per_module_overrides": {}, "_validate_config": true, "_use_msgpack_checkpoints": false, "_torch_grad_scaler_class": null, "_torch_lr_scheduler_classes": null, "_tf_policy_handles_more_than_one_loss": false, "_disable_preprocessor_api": false, "_disable_action_flattening": false, "_disable_initialize_loss_from_dummy_batch": false, "_dont_auto_sync_env_runner_states": false, "env_task_fn": -1, "enable_connectors": -1, "simple_optimizer": false, "policy_map_cache": -1, "worker_cls": -1, "synchronize_filters": -1, "enable_async_evaluation": -1, "custom_async_evaluation_function": -1, "_enable_rl_module_api": -1, "auto_wrap_old_gym_envs": -1, "always_attach_evaluation_results": -1, "replay_sequence_length": null, "_disable_execution_plan_api": -1, "use_critic": true, "use_gae": true, "use_kl_loss": true, "kl_coeff": 0.7464963036515, "kl_target": 0.0270990929592, "vf_loss_coeff": 0.6688075857018, "entropy_coeff": 0.0090570820258, "clip_param": 0.1221781641624, "vf_clip_param": 0.1027808522125, "entropy_coeff_schedule": null, "lr_schedule": null, "sgd_minibatch_size": -1, "vf_share_layers": -1, "__stdout_file__": null, "__stderr_file__": null, "lambda": 0.9099046732075, "input": "sampler", "policies": {"default_policy": [null, null, null, null]}, "callbacks": "<class 'ray.rllib.callbacks.callbacks.RLlibCallback'>", "create_env_on_driver": false, "custom_eval_function": null, "framework": "torch"}, "time_since_restore": 2.4690799713134766, "iterations_since_restore": 1, "perf": {"cpu_util_percent": 49.474999999999994, "ram_util_percent": 84.0}}
{"timers": {"training_iteration": 2.3320299540902485, "restore_env_runners": 1.5063777100294828e-05, "training_step": 2.331880344076781, "env_runner_sampling_timer": 2.2208416745474095, "learner_update_timer": 0.10767500972375274, "synch_weights": 0.0007319795130752027, "restore_eval_env_runners": 1.1749914847314358e-05, "evaluation_iteration": 0.12925058300606906, "synch_eval_env_connectors": 0.00013412500265985727, "synch_env_connectors": 4.790956154465675e-06}, "env_runners": {"sample": 0.006555183226300778, "module_episode_returns_mean": {"default_policy": 0.17999999999999997}, "env_to_module_connector": {"timers": {"connectors": {"add_states_from_episodes_to_batch": 1.8250616608077759e-06, "numpy_to_tensor": 9.584128699852318e-06, "add_observations_from_episodes_to_batch": 3.219599608253435e-06, "add_time_dim_to_batch_and_zero_pad": 2.5619609360715844e-06, "batch_individual_items": 6.992102448739581e-06}}, "connector_pipeline_timer": 4.7155971651052835e-05}, "env_reset_timer": 5.4842663144510734e-05, "module_to_env_connector": {"timers": {"connectors": {"tensor_to_numpy": 1.4363281233128653e-05, "normalize_and_clip_actions": 1.0130437134341872e-05, "listify_data_for_vector_env": 1.201769263007311e-05, "remove_single_ts_time_rank_from_batch": 6.10152370771554e-07, "un_batch_to_individual_items": 5.840292832109505e-06, "get_actions": 4.313813478826077e-05}}, "connector_pipeline_timer": 0.00011317649087697274}, "num_module_steps_sampled": {"default_policy": 5000.0}, "weights_seq_no": 1.0, "agent_episode_returns_mean": {"default_agent": 0.17999999999999997}, "env_to_module_sum_episodes_length_out": 10.36823839457432, "env_step_timer": 1.5427957589940427e-05, "num_env_steps_sampled": 5000.0, "episode_return_mean": 0.17999999999999997, "num_episodes_lifetime": 500.0, "num_module_steps_sampled_lifetime": {"default_policy": 10000.0}, "time_between_sampling": 0.0016975216083455352, "env_to_module_sum_episodes_length_in": 10.36823839457432, "rlmodule_inference_timer": 3.066969346899106e-05, "episode_duration_sec_mean": 0.0049629602315835655, "num_env_steps_sampled_lifetime": 10000.0, "episode_len_max": 20, "episode_len_mean": 20.0, "num_episodes": 250.0, "episode_return_max": 8.5, "num_agent_steps_sampled": {"default_agent": 5000.0}, "episode_len_min": 20, "episode_return_min": -11.5, "num_agent_steps_sampled_lifetime": {"default_agent": 10000.0}, "num_env_steps_sampled_lifetime_throughput": 3467.007492302983}, "learners": {"__all_modules__": {"num_env_steps_trained": 31500, "learner_connector": {"timers": {"connectors": {"add_one_ts_to_episodes_and_truncate": 0.007656008417252452, "add_columns_from_episodes_to_train_batch": 0.03416671422775835, "general_advantage_estimation": 0.006567274722037836, "add_states_from_episodes_to_batch": 3.7533103022724393e-06, "add_time_dim_to_batch_and_zero_pad": 1.2442984152585268e-05, "batch_individual_items": 0.03147734870319255, "numpy_to_tensor": 6.957402336411179e-05, "add_observations_from_episodes_to_batch": 0.000801335338037461}}, "connector_pipeline_timer": 0.08089226254844106}, "num_module_steps_trained_lifetime": 12000, "learner_connector_sum_episodes_length_in": 5000.0, "num_module_steps_trained": 6000, "learner_connector_sum_episodes_length_out": 5250.0, "num_env_steps_trained_lifetime": 63000, "num_non_trainable_parameters": 0, "num_trainable_parameters": 6003, "num_env_steps_trained_lifetime_throughput": 2314621.9317571195, "num_module_steps_trained_throughput": 443551.41930743406, "num_module_steps_trained_lifetime_throughput": 442570.2135691412}, "default_policy": {"mean_kl_loss": 5.7608696806710213e-05, "curr_kl_coeff": 0.18662407994270325, "module_train_batch_size_mean": 1000.0, "weights_seq_no": 2.0, "default_optimizer_learning_rate": 0.0002847858517, "num_trainable_parameters": 6003, "num_module_steps_trained_lifetime": 12000, "entropy": 0.6900495290756226, "curr_entropy_coeff": 0.0090570820258, "num_module_steps_trained": 6000, "policy_loss": 0.1580778807401657, "vf_loss": 0.10278083384037018, "total_loss": 0.22059014439582825, "diff_num_grad_updates_vs_sampler_policy": 1.0, "vf_loss_unclipped": 28.989748001098633, "vf_explained_var": 0.0014600753784179688, "gradients_default_optimizer_global_norm": 0.12324754893779755, "num_module_steps_trained_lifetime_throughput": 444927.66368425}}, "num_training_step_calls_per_iteration": 1, "evaluation": {"env_runners": {"module_to_env_connector": {"timers": {"connectors": {"un_batch_to_individual_items": 5.3682774903385805e-06, "get_actions": 3.5789772678775156e-05, "tensor_to_numpy": 1.2901492885339905e-05, "listify_data_for_vector_env": 1.0745205349574215e-05, "normalize_and_clip_actions": 9.373117297346423e-06, "remove_single_ts_time_rank_from_batch": 5.623424730262648e-07}}, "connector_pipeline_timer": 9.971348202367084e-05}, "env_step_timer": 1.368460338615914e-05, "env_to_module_connector": {"timers": {"connectors": {"add_observations_from_episodes_to_batch": 2.7856130365291406e-06, "add_time_dim_to_batch_and_zero_pad": 2.3087470677373136e-06, "batch_individual_items": 6.091881614096091e-06, "add_states_from_episodes_to_batch": 1.5972301636634538e-06, "numpy_to_tensor": 8.26327133754041e-06}}, "connector_pipeline_timer": 4.225430790303701e-05}, "episode_duration_sec_mean": 0.004852604211191647, "num_episodes": 20, "episode_return_min": -14.5, "agent_episode_returns_mean": {"default_agent": -1.75}, "sample": 0.11390051121474243, "num_agent_steps_sampled_lifetime": {"default_agent": 800}, "env_to_module_sum_episodes_length_out": 10.366003441359926, "num_env_steps_sampled": 400, "module_episode_returns_mean": {"default_policy": -1.75}, "rlmodule_inference_timer": 2.7088392345075047e-05, "episode_return_max": 12.5, "env_reset_timer": 0.0010648162267170847, "num_agent_steps_sampled": {"default_agent": 400}, "episode_return_mean": -1.75, "num_episodes_lifetime": 40, "weights_seq_no": 2.0, "env_to_module_sum_episodes_length_in": 10.366003441359926, "num_env_steps_sampled_lifetime": 10400, "num_module_steps_sampled": {"default_policy": 400}, "episode_len_max": 20, "episode_len_mean": 20.0, "episode_len_min": 20, "num_module_steps_sampled_lifetime": {"default_policy": 800}, "time_between_sampling": 1.7712302079889923}, "num_healthy_workers": 1, "actor_manager_num_outstanding_async_reqs": 0, "num_remote_worker_restarts": 0}, "num_env_steps_sampled_lifetime": 10000.0, "fault_tolerance": {"num_healthy_workers": 0, "num_remote_worker_restarts": 0}, "env_runner_group": {"actor_manager_num_outstanding_async_reqs": 0}, "done": false, "training_iteration": 2, "trial_id": "4d657_00000", "date": "2025-08-11_19-20-55", "timestamp": 1754932855, "time_this_iter_s": 1.8333837985992432, "time_total_s": 4.30246376991272, "pid": 14261, "hostname": "Mac", "node_ip": "127.0.0.1", "config": {"exploration_config": {}, "extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "placement_strategy": "PACK", "num_gpus": 0, "_fake_gpus": false, "num_cpus_for_main_process": 2, "eager_tracing": true, "eager_max_retraces": 20, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "torch_compile_learner": false, "torch_compile_learner_what_to_compile": "forward_train", "torch_compile_learner_dynamo_backend": "aot_eager", "torch_compile_learner_dynamo_mode": null, "torch_compile_worker": false, "torch_compile_worker_dynamo_backend": "aot_eager", "torch_compile_worker_dynamo_mode": null, "torch_ddp_kwargs": {}, "torch_skip_nan_gradients": false, "env": "Umbrella", "env_config": {}, "observation_space": null, "action_space": null, "clip_rewards": null, "normalize_actions": true, "clip_actions": false, "_is_atari": null, "disable_env_checking": false, "render_env": false, "action_mask_key": "action_mask", "env_runner_cls": null, "num_env_runners": 0, "create_local_env_runner": true, "num_envs_per_env_runner": 1, "gym_env_vectorize_mode": "SYNC", "num_cpus_per_env_runner": 1, "num_gpus_per_env_runner": 0, "custom_resources_per_env_runner": {}, "validate_env_runners_after_construction": true, "episodes_to_numpy": true, "max_requests_in_flight_per_env_runner": 1, "sample_timeout_s": 60.0, "_env_to_module_connector": null, "add_default_connectors_to_env_to_module_pipeline": true, "_module_to_env_connector": null, "add_default_connectors_to_module_to_env_pipeline": true, "merge_env_runner_states": "training_only", "broadcast_env_runner_states": true, "episode_lookback_horizon": 1, "rollout_fragment_length": "auto", "batch_mode": "complete_episodes", "compress_observations": false, "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "enable_tf1_exec_eagerly": false, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "preprocessor_pref": "deepmind", "observation_filter": "NoFilter", "update_worker_filter_stats": true, "use_worker_filter_stats": true, "sampler_perf_stats_ema_coef": null, "_is_online": true, "num_learners": 0, "num_gpus_per_learner": 0, "num_cpus_per_learner": "auto", "num_aggregator_actors_per_learner": 0, "max_requests_in_flight_per_aggregator_actor": 3, "local_gpu_idx": 0, "max_requests_in_flight_per_learner": 3, "gamma": 1, "lr": 0.0002847858517, "grad_clip": 0.5, "grad_clip_by": "global_norm", "_train_batch_size_per_learner": 5000, "train_batch_size": 4000, "num_epochs": 1, "minibatch_size": 1000, "shuffle_batch_per_epoch": true, "model": {"fcnet_hiddens": [256, 256], "fcnet_activation": "tanh", "fcnet_weights_initializer": null, "fcnet_weights_initializer_config": null, "fcnet_bias_initializer": null, "fcnet_bias_initializer_config": null, "conv_filters": null, "conv_activation": "relu", "conv_kernel_initializer": null, "conv_kernel_initializer_config": null, "conv_bias_initializer": null, "conv_bias_initializer_config": null, "conv_transpose_kernel_initializer": null, "conv_transpose_kernel_initializer_config": null, "conv_transpose_bias_initializer": null, "conv_transpose_bias_initializer_config": null, "post_fcnet_hiddens": [], "post_fcnet_activation": "relu", "post_fcnet_weights_initializer": null, "post_fcnet_weights_initializer_config": null, "post_fcnet_bias_initializer": null, "post_fcnet_bias_initializer_config": null, "free_log_std": false, "log_std_clip_param": 20.0, "no_final_linear": false, "vf_share_layers": false, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "lstm_weights_initializer": null, "lstm_weights_initializer_config": null, "lstm_bias_initializer": null, "lstm_bias_initializer_config": null, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "attention_use_n_prev_actions": 0, "attention_use_n_prev_rewards": 0, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": null, "custom_model_config": {}, "custom_action_dist": null, "custom_preprocessor": null, "encoder_latent_dim": null, "always_check_shapes": false, "lstm_use_prev_action_reward": -1, "_use_default_native_models": -1, "_disable_preprocessor_api": false, "_disable_action_flattening": false}, "_learner_connector": null, "add_default_connectors_to_learner_pipeline": true, "learner_config_dict": {}, "optimizer": {}, "_learner_class": null, "callbacks_on_algorithm_init": null, "callbacks_on_env_runners_recreated": null, "callbacks_on_offline_eval_runners_recreated": null, "callbacks_on_checkpoint_loaded": null, "callbacks_on_environment_created": null, "callbacks_on_episode_created": null, "callbacks_on_episode_start": null, "callbacks_on_episode_step": null, "callbacks_on_episode_end": null, "callbacks_on_evaluate_start": null, "callbacks_on_evaluate_end": null, "callbacks_on_evaluate_offline_start": null, "callbacks_on_evaluate_offline_end": null, "callbacks_on_sample_end": null, "callbacks_on_train_result": null, "explore": true, "enable_rl_module_and_learner": true, "enable_env_runner_and_connector_v2": true, "_prior_exploration_config": {"type": "StochasticSampling"}, "count_steps_by": "env_steps", "policy_map_capacity": 100, "policy_mapping_fn": "<function AlgorithmConfig.DEFAULT_POLICY_MAPPING_FN at 0x1680e9b20>", "policies_to_train": null, "policy_states_are_swappable": false, "observation_fn": null, "offline_data_class": null, "input_read_method": "read_parquet", "input_read_method_kwargs": {}, "input_read_schema": {}, "input_read_episodes": false, "input_read_sample_batches": false, "input_read_batch_size": null, "input_filesystem": null, "input_filesystem_kwargs": {}, "input_compress_columns": ["obs", "new_obs"], "input_spaces_jsonable": true, "materialize_data": false, "materialize_mapped_data": true, "map_batches_kwargs": {}, "iter_batches_kwargs": {}, "ignore_final_observation": false, "prelearner_class": null, "prelearner_buffer_class": null, "prelearner_buffer_kwargs": {}, "prelearner_module_synch_period": 10, "dataset_num_iters_per_learner": null, "input_config": {}, "actions_in_input_normalized": false, "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_config": {}, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "output_max_rows_per_file": null, "output_write_remaining_data": false, "output_write_method": "write_parquet", "output_write_method_kwargs": {}, "output_filesystem": null, "output_filesystem_kwargs": {}, "output_write_episodes": true, "offline_sampling": false, "evaluation_interval": 1, "evaluation_duration": 20, "evaluation_duration_unit": "episodes", "evaluation_sample_timeout_s": 120.0, "evaluation_auto_duration_min_env_steps_per_sample": 100, "evaluation_auto_duration_max_env_steps_per_sample": 2000, "evaluation_parallel_to_training": false, "evaluation_force_reset_envs_before_iteration": true, "evaluation_config": null, "off_policy_estimation_methods": {}, "ope_split_batch_by_episode": true, "evaluation_num_env_runners": 1, "in_evaluation": false, "sync_filters_on_rollout_workers_timeout_s": 10.0, "offline_evaluation_interval": null, "num_offline_eval_runners": 0, "offline_loss_for_module_fn": null, "offline_evaluation_duration": 1, "offline_evaluation_parallel_to_training": false, "offline_evaluation_timeout_s": 120.0, "num_cpus_per_offline_eval_runner": 1, "num_gpus_per_offline_eval_runner": 0, "custom_resources_per_offline_eval_runner": {}, "restart_failed_offline_eval_runners": true, "ignore_offline_eval_runner_failures": false, "max_num_offline_eval_runner_restarts": 1000, "offline_eval_runner_restore_timeout_s": 1800.0, "max_requests_in_flight_per_offline_eval_runner": 1, "validate_offline_eval_runners_after_construction": true, "offline_eval_runner_health_probe_timeout_s": 30.0, "offline_eval_rl_module_inference_only": false, "broadcast_offline_eval_runner_states": false, "offline_eval_batch_size_per_runner": 256, "dataset_num_iters_per_eval_runner": 1, "keep_per_episode_custom_metrics": false, "metrics_episode_collection_timeout_s": 60.0, "metrics_num_episodes_for_smoothing": 100, "min_time_s_per_iteration": null, "min_train_timesteps_per_iteration": 0, "min_sample_timesteps_per_iteration": 0, "log_gradients": true, "export_native_model_files": false, "checkpoint_trainable_policies_only": false, "logger_creator": null, "logger_config": null, "log_level": "WARN", "log_sys_usage": true, "fake_sampler": false, "seed": 8, "restart_failed_env_runners": true, "ignore_env_runner_failures": false, "max_num_env_runner_restarts": 1000, "delay_between_env_runner_restarts_s": 60.0, "restart_failed_sub_environments": false, "num_consecutive_env_runner_failures_tolerance": 100, "env_runner_health_probe_timeout_s": 30.0, "env_runner_restore_timeout_s": 1800.0, "_model_config": {}, "_rl_module_spec": "RLModuleSpec(module_class=None, observation_space=None, action_space=None, inference_only=False, learner_only=False, model_config=DefaultModelConfig(fcnet_hiddens=[60, 90], fcnet_activation='tanh', fcnet_kernel_initializer=None, fcnet_kernel_initializer_kwargs=None, fcnet_bias_initializer=None, fcnet_bias_initializer_kwargs=None, conv_filters=None, conv_activation='relu', conv_kernel_initializer=None, conv_kernel_initializer_kwargs=None, conv_bias_initializer=None, conv_bias_initializer_kwargs=None, head_fcnet_hiddens=[], head_fcnet_activation='relu', head_fcnet_kernel_initializer=None, head_fcnet_kernel_initializer_kwargs=None, head_fcnet_bias_initializer=None, head_fcnet_bias_initializer_kwargs=None, free_log_std=False, log_std_clip_param=20.0, vf_share_layers=True, use_lstm=False, max_seq_len=20, lstm_cell_size=256, lstm_use_prev_action=False, lstm_use_prev_reward=False, lstm_kernel_initializer=None, lstm_kernel_initializer_kwargs=None, lstm_bias_initializer=None, lstm_bias_initializer_kwargs=None), catalog_class=None, load_state_path=None, model_config_dict=None)", "algorithm_config_overrides_per_module": {}, "_per_module_overrides": {}, "_validate_config": true, "_use_msgpack_checkpoints": false, "_torch_grad_scaler_class": null, "_torch_lr_scheduler_classes": null, "_tf_policy_handles_more_than_one_loss": false, "_disable_preprocessor_api": false, "_disable_action_flattening": false, "_disable_initialize_loss_from_dummy_batch": false, "_dont_auto_sync_env_runner_states": false, "env_task_fn": -1, "enable_connectors": -1, "simple_optimizer": false, "policy_map_cache": -1, "worker_cls": -1, "synchronize_filters": -1, "enable_async_evaluation": -1, "custom_async_evaluation_function": -1, "_enable_rl_module_api": -1, "auto_wrap_old_gym_envs": -1, "always_attach_evaluation_results": -1, "replay_sequence_length": null, "_disable_execution_plan_api": -1, "use_critic": true, "use_gae": true, "use_kl_loss": true, "kl_coeff": 0.7464963036515, "kl_target": 0.0270990929592, "vf_loss_coeff": 0.6688075857018, "entropy_coeff": 0.0090570820258, "clip_param": 0.1221781641624, "vf_clip_param": 0.1027808522125, "entropy_coeff_schedule": null, "lr_schedule": null, "sgd_minibatch_size": -1, "vf_share_layers": -1, "__stdout_file__": null, "__stderr_file__": null, "lambda": 0.9099046732075, "input": "sampler", "policies": {"default_policy": [null, null, null, null]}, "callbacks": "<class 'ray.rllib.callbacks.callbacks.RLlibCallback'>", "create_env_on_driver": false, "custom_eval_function": null, "framework": "torch"}, "time_since_restore": 4.30246376991272, "iterations_since_restore": 2, "perf": {"cpu_util_percent": 50.333333333333336, "ram_util_percent": 81.93333333333332}}
{"timers": {"training_iteration": 2.324641202050005, "restore_env_runners": 1.4973548403941094e-05, "training_step": 2.3244911481370334, "env_runner_sampling_timer": 2.2135034053021228, "learner_update_timer": 0.10761873379731551, "synch_weights": 0.0007351367977214976, "restore_eval_env_runners": 1.1720745824277401e-05, "evaluation_iteration": 0.1290074934263248, "synch_eval_env_connectors": 0.00013394959270954132, "synch_env_connectors": 4.788045771420002e-06}, "env_runners": {"sample": 0.005414120008838532, "module_episode_returns_mean": {"default_policy": 0.3400000000000001}, "env_to_module_connector": {"timers": {"connectors": {"add_states_from_episodes_to_batch": 1.8071549286411826e-06, "numpy_to_tensor": 9.367660246007762e-06, "add_observations_from_episodes_to_batch": 3.147731000379484e-06, "add_time_dim_to_batch_and_zero_pad": 2.512603593837118e-06, "batch_individual_items": 6.894322361056219e-06}}, "connector_pipeline_timer": 4.648435416671121e-05}, "env_reset_timer": 4.729295234658927e-05, "module_to_env_connector": {"timers": {"connectors": {"tensor_to_numpy": 1.4118219259756943e-05, "normalize_and_clip_actions": 1.0115107672013638e-05, "listify_data_for_vector_env": 1.1902553501017822e-05, "remove_single_ts_time_rank_from_batch": 6.090758654981818e-07, "un_batch_to_individual_items": 5.927634757119238e-06, "get_actions": 4.189794336332143e-05}}, "connector_pipeline_timer": 0.00011148329743260595}, "num_module_steps_sampled": {"default_policy": 5000.0}, "weights_seq_no": 2.0, "agent_episode_returns_mean": {"default_agent": 0.3400000000000001}, "env_to_module_sum_episodes_length_out": 10.36823839457432, "env_step_timer": 1.5073394836585218e-05, "num_env_steps_sampled": 5000.0, "episode_return_mean": 0.3400000000000001, "num_episodes_lifetime": -30375.0, "num_module_steps_sampled_lifetime": {"default_policy": -607500.0}, "time_between_sampling": 0.0019900052129371063, "env_to_module_sum_episodes_length_in": 10.36823839457432, "rlmodule_inference_timer": 2.972346034151201e-05, "episode_duration_sec_mean": 0.004865713459439577, "num_env_steps_sampled_lifetime": -607500.0, "episode_len_max": 20, "episode_len_mean": 20.0, "num_episodes": 250.0, "episode_return_max": 8.5, "num_agent_steps_sampled": {"default_agent": 5000.0}, "episode_len_min": 20, "episode_return_min": -11.5, "num_agent_steps_sampled_lifetime": {"default_agent": -607500.0}, "num_env_steps_sampled_lifetime_throughput": 3472.075399686888}, "learners": {"__all_modules__": {"num_env_steps_trained": 31500, "learner_connector": {"timers": {"connectors": {"add_one_ts_to_episodes_and_truncate": 0.007656842083041557, "add_columns_from_episodes_to_train_batch": 0.03417308708485216, "general_advantage_estimation": 0.0065718053149641485, "add_states_from_episodes_to_batch": 3.7516075070016085e-06, "add_time_dim_to_batch_and_zero_pad": 1.2591474899090825e-05, "batch_individual_items": 0.03148310104560806, "numpy_to_tensor": 6.999995290534571e-05, "add_observations_from_episodes_to_batch": 0.0008017732341075315}}, "connector_pipeline_timer": 0.08091102492263307}, "num_module_steps_trained_lifetime": 18000, "learner_connector_sum_episodes_length_in": 5000.0, "num_module_steps_trained": 6000, "learner_connector_sum_episodes_length_out": 5250.0, "num_env_steps_trained_lifetime": 94500, "num_non_trainable_parameters": 0, "num_trainable_parameters": 6003, "num_env_steps_trained_lifetime_throughput": 2303218.8051803224, "num_module_steps_trained_throughput": 441320.84663908626, "num_module_steps_trained_lifetime_throughput": 440360.3935776736}, "default_policy": {"mean_kl_loss": 7.996203930815682e-05, "curr_kl_coeff": 0.09331203997135162, "module_train_batch_size_mean": 1000.0, "weights_seq_no": 3.0, "default_optimizer_learning_rate": 0.0002847858517, "num_trainable_parameters": 6003, "num_module_steps_trained_lifetime": 18000, "entropy": 0.6902889013290405, "curr_entropy_coeff": 0.0090570820258, "num_module_steps_trained": 6000, "policy_loss": 0.0031105533707886934, "vf_loss": 0.10278083384037018, "total_loss": 0.06561407446861267, "diff_num_grad_updates_vs_sampler_policy": 1.0, "vf_loss_unclipped": 28.398405075073242, "vf_explained_var": 0.001783132553100586, "gradients_default_optimizer_global_norm": 0.11024872958660126, "num_module_steps_trained_lifetime_throughput": 442658.20613443636}}, "num_training_step_calls_per_iteration": 1, "evaluation": {"env_runners": {"module_to_env_connector": {"timers": {"connectors": {"un_batch_to_individual_items": 5.457940017468703e-06, "get_actions": 3.6981034459743324e-05, "tensor_to_numpy": 1.3522196957551687e-05, "listify_data_for_vector_env": 1.1176295528946554e-05, "normalize_and_clip_actions": 9.547922888190308e-06, "remove_single_ts_time_rank_from_batch": 5.74948841425811e-07}}, "connector_pipeline_timer": 0.0001026432555182591}, "env_step_timer": 1.4262867201328573e-05, "env_to_module_connector": {"timers": {"connectors": {"add_observations_from_episodes_to_batch": 2.827200990774114e-06, "add_time_dim_to_batch_and_zero_pad": 2.3538706936446204e-06, "batch_individual_items": 6.232068734906076e-06, "add_states_from_episodes_to_batch": 1.6245366062942903e-06, "numpy_to_tensor": 8.561927679029946e-06}}, "connector_pipeline_timer": 4.2908056116760845e-05}, "episode_duration_sec_mean": 0.004843023638629044, "num_episodes": 20, "episode_return_min": -14.5, "agent_episode_returns_mean": {"default_agent": -1.25}, "sample": 0.11381659360331249, "num_agent_steps_sampled_lifetime": {"default_agent": 1200}, "env_to_module_sum_episodes_length_out": 10.368205581254823, "num_env_steps_sampled": 400, "module_episode_returns_mean": {"default_policy": -1.25}, "rlmodule_inference_timer": 2.8269439622141845e-05, "episode_return_max": 14.5, "env_reset_timer": 0.0010550493144663052, "num_agent_steps_sampled": {"default_agent": 400}, "episode_return_mean": -1.25, "num_episodes_lifetime": 60, "weights_seq_no": 3.0, "env_to_module_sum_episodes_length_in": 10.368205581254823, "num_env_steps_sampled_lifetime": 15400, "num_module_steps_sampled": {"default_policy": 400}, "episode_len_max": 20, "episode_len_mean": 20.0, "episode_len_min": 20, "num_module_steps_sampled_lifetime": {"default_policy": 1200}, "time_between_sampling": 1.769630059658084}, "num_healthy_workers": 1, "actor_manager_num_outstanding_async_reqs": 0, "num_remote_worker_restarts": 0}, "num_env_steps_sampled_lifetime": -607500.0, "fault_tolerance": {"num_healthy_workers": 0, "num_remote_worker_restarts": 0}, "env_runner_group": {"actor_manager_num_outstanding_async_reqs": 0}, "done": false, "training_iteration": 3, "trial_id": "4d657_00000", "date": "2025-08-11_19-20-57", "timestamp": 1754932857, "time_this_iter_s": 1.7068309783935547, "time_total_s": 6.009294748306274, "pid": 14261, "hostname": "Mac", "node_ip": "127.0.0.1", "config": {"exploration_config": {}, "extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "placement_strategy": "PACK", "num_gpus": 0, "_fake_gpus": false, "num_cpus_for_main_process": 2, "eager_tracing": true, "eager_max_retraces": 20, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "torch_compile_learner": false, "torch_compile_learner_what_to_compile": "forward_train", "torch_compile_learner_dynamo_backend": "aot_eager", "torch_compile_learner_dynamo_mode": null, "torch_compile_worker": false, "torch_compile_worker_dynamo_backend": "aot_eager", "torch_compile_worker_dynamo_mode": null, "torch_ddp_kwargs": {}, "torch_skip_nan_gradients": false, "env": "Umbrella", "env_config": {}, "observation_space": null, "action_space": null, "clip_rewards": null, "normalize_actions": true, "clip_actions": false, "_is_atari": null, "disable_env_checking": false, "render_env": false, "action_mask_key": "action_mask", "env_runner_cls": null, "num_env_runners": 0, "create_local_env_runner": true, "num_envs_per_env_runner": 1, "gym_env_vectorize_mode": "SYNC", "num_cpus_per_env_runner": 1, "num_gpus_per_env_runner": 0, "custom_resources_per_env_runner": {}, "validate_env_runners_after_construction": true, "episodes_to_numpy": true, "max_requests_in_flight_per_env_runner": 1, "sample_timeout_s": 60.0, "_env_to_module_connector": null, "add_default_connectors_to_env_to_module_pipeline": true, "_module_to_env_connector": null, "add_default_connectors_to_module_to_env_pipeline": true, "merge_env_runner_states": "training_only", "broadcast_env_runner_states": true, "episode_lookback_horizon": 1, "rollout_fragment_length": "auto", "batch_mode": "complete_episodes", "compress_observations": false, "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "enable_tf1_exec_eagerly": false, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "preprocessor_pref": "deepmind", "observation_filter": "NoFilter", "update_worker_filter_stats": true, "use_worker_filter_stats": true, "sampler_perf_stats_ema_coef": null, "_is_online": true, "num_learners": 0, "num_gpus_per_learner": 0, "num_cpus_per_learner": "auto", "num_aggregator_actors_per_learner": 0, "max_requests_in_flight_per_aggregator_actor": 3, "local_gpu_idx": 0, "max_requests_in_flight_per_learner": 3, "gamma": 1, "lr": 0.0002847858517, "grad_clip": 0.5, "grad_clip_by": "global_norm", "_train_batch_size_per_learner": 5000, "train_batch_size": 4000, "num_epochs": 1, "minibatch_size": 1000, "shuffle_batch_per_epoch": true, "model": {"fcnet_hiddens": [256, 256], "fcnet_activation": "tanh", "fcnet_weights_initializer": null, "fcnet_weights_initializer_config": null, "fcnet_bias_initializer": null, "fcnet_bias_initializer_config": null, "conv_filters": null, "conv_activation": "relu", "conv_kernel_initializer": null, "conv_kernel_initializer_config": null, "conv_bias_initializer": null, "conv_bias_initializer_config": null, "conv_transpose_kernel_initializer": null, "conv_transpose_kernel_initializer_config": null, "conv_transpose_bias_initializer": null, "conv_transpose_bias_initializer_config": null, "post_fcnet_hiddens": [], "post_fcnet_activation": "relu", "post_fcnet_weights_initializer": null, "post_fcnet_weights_initializer_config": null, "post_fcnet_bias_initializer": null, "post_fcnet_bias_initializer_config": null, "free_log_std": false, "log_std_clip_param": 20.0, "no_final_linear": false, "vf_share_layers": false, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "lstm_weights_initializer": null, "lstm_weights_initializer_config": null, "lstm_bias_initializer": null, "lstm_bias_initializer_config": null, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "attention_use_n_prev_actions": 0, "attention_use_n_prev_rewards": 0, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": null, "custom_model_config": {}, "custom_action_dist": null, "custom_preprocessor": null, "encoder_latent_dim": null, "always_check_shapes": false, "lstm_use_prev_action_reward": -1, "_use_default_native_models": -1, "_disable_preprocessor_api": false, "_disable_action_flattening": false}, "_learner_connector": null, "add_default_connectors_to_learner_pipeline": true, "learner_config_dict": {}, "optimizer": {}, "_learner_class": null, "callbacks_on_algorithm_init": null, "callbacks_on_env_runners_recreated": null, "callbacks_on_offline_eval_runners_recreated": null, "callbacks_on_checkpoint_loaded": null, "callbacks_on_environment_created": null, "callbacks_on_episode_created": null, "callbacks_on_episode_start": null, "callbacks_on_episode_step": null, "callbacks_on_episode_end": null, "callbacks_on_evaluate_start": null, "callbacks_on_evaluate_end": null, "callbacks_on_evaluate_offline_start": null, "callbacks_on_evaluate_offline_end": null, "callbacks_on_sample_end": null, "callbacks_on_train_result": null, "explore": true, "enable_rl_module_and_learner": true, "enable_env_runner_and_connector_v2": true, "_prior_exploration_config": {"type": "StochasticSampling"}, "count_steps_by": "env_steps", "policy_map_capacity": 100, "policy_mapping_fn": "<function AlgorithmConfig.DEFAULT_POLICY_MAPPING_FN at 0x1680e9b20>", "policies_to_train": null, "policy_states_are_swappable": false, "observation_fn": null, "offline_data_class": null, "input_read_method": "read_parquet", "input_read_method_kwargs": {}, "input_read_schema": {}, "input_read_episodes": false, "input_read_sample_batches": false, "input_read_batch_size": null, "input_filesystem": null, "input_filesystem_kwargs": {}, "input_compress_columns": ["obs", "new_obs"], "input_spaces_jsonable": true, "materialize_data": false, "materialize_mapped_data": true, "map_batches_kwargs": {}, "iter_batches_kwargs": {}, "ignore_final_observation": false, "prelearner_class": null, "prelearner_buffer_class": null, "prelearner_buffer_kwargs": {}, "prelearner_module_synch_period": 10, "dataset_num_iters_per_learner": null, "input_config": {}, "actions_in_input_normalized": false, "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_config": {}, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "output_max_rows_per_file": null, "output_write_remaining_data": false, "output_write_method": "write_parquet", "output_write_method_kwargs": {}, "output_filesystem": null, "output_filesystem_kwargs": {}, "output_write_episodes": true, "offline_sampling": false, "evaluation_interval": 1, "evaluation_duration": 20, "evaluation_duration_unit": "episodes", "evaluation_sample_timeout_s": 120.0, "evaluation_auto_duration_min_env_steps_per_sample": 100, "evaluation_auto_duration_max_env_steps_per_sample": 2000, "evaluation_parallel_to_training": false, "evaluation_force_reset_envs_before_iteration": true, "evaluation_config": null, "off_policy_estimation_methods": {}, "ope_split_batch_by_episode": true, "evaluation_num_env_runners": 1, "in_evaluation": false, "sync_filters_on_rollout_workers_timeout_s": 10.0, "offline_evaluation_interval": null, "num_offline_eval_runners": 0, "offline_loss_for_module_fn": null, "offline_evaluation_duration": 1, "offline_evaluation_parallel_to_training": false, "offline_evaluation_timeout_s": 120.0, "num_cpus_per_offline_eval_runner": 1, "num_gpus_per_offline_eval_runner": 0, "custom_resources_per_offline_eval_runner": {}, "restart_failed_offline_eval_runners": true, "ignore_offline_eval_runner_failures": false, "max_num_offline_eval_runner_restarts": 1000, "offline_eval_runner_restore_timeout_s": 1800.0, "max_requests_in_flight_per_offline_eval_runner": 1, "validate_offline_eval_runners_after_construction": true, "offline_eval_runner_health_probe_timeout_s": 30.0, "offline_eval_rl_module_inference_only": false, "broadcast_offline_eval_runner_states": false, "offline_eval_batch_size_per_runner": 256, "dataset_num_iters_per_eval_runner": 1, "keep_per_episode_custom_metrics": false, "metrics_episode_collection_timeout_s": 60.0, "metrics_num_episodes_for_smoothing": 100, "min_time_s_per_iteration": null, "min_train_timesteps_per_iteration": 0, "min_sample_timesteps_per_iteration": 0, "log_gradients": true, "export_native_model_files": false, "checkpoint_trainable_policies_only": false, "logger_creator": null, "logger_config": null, "log_level": "WARN", "log_sys_usage": true, "fake_sampler": false, "seed": 8, "restart_failed_env_runners": true, "ignore_env_runner_failures": false, "max_num_env_runner_restarts": 1000, "delay_between_env_runner_restarts_s": 60.0, "restart_failed_sub_environments": false, "num_consecutive_env_runner_failures_tolerance": 100, "env_runner_health_probe_timeout_s": 30.0, "env_runner_restore_timeout_s": 1800.0, "_model_config": {}, "_rl_module_spec": "RLModuleSpec(module_class=None, observation_space=None, action_space=None, inference_only=False, learner_only=False, model_config=DefaultModelConfig(fcnet_hiddens=[60, 90], fcnet_activation='tanh', fcnet_kernel_initializer=None, fcnet_kernel_initializer_kwargs=None, fcnet_bias_initializer=None, fcnet_bias_initializer_kwargs=None, conv_filters=None, conv_activation='relu', conv_kernel_initializer=None, conv_kernel_initializer_kwargs=None, conv_bias_initializer=None, conv_bias_initializer_kwargs=None, head_fcnet_hiddens=[], head_fcnet_activation='relu', head_fcnet_kernel_initializer=None, head_fcnet_kernel_initializer_kwargs=None, head_fcnet_bias_initializer=None, head_fcnet_bias_initializer_kwargs=None, free_log_std=False, log_std_clip_param=20.0, vf_share_layers=True, use_lstm=False, max_seq_len=20, lstm_cell_size=256, lstm_use_prev_action=False, lstm_use_prev_reward=False, lstm_kernel_initializer=None, lstm_kernel_initializer_kwargs=None, lstm_bias_initializer=None, lstm_bias_initializer_kwargs=None), catalog_class=None, load_state_path=None, model_config_dict=None)", "algorithm_config_overrides_per_module": {}, "_per_module_overrides": {}, "_validate_config": true, "_use_msgpack_checkpoints": false, "_torch_grad_scaler_class": null, "_torch_lr_scheduler_classes": null, "_tf_policy_handles_more_than_one_loss": false, "_disable_preprocessor_api": false, "_disable_action_flattening": false, "_disable_initialize_loss_from_dummy_batch": false, "_dont_auto_sync_env_runner_states": false, "env_task_fn": -1, "enable_connectors": -1, "simple_optimizer": false, "policy_map_cache": -1, "worker_cls": -1, "synchronize_filters": -1, "enable_async_evaluation": -1, "custom_async_evaluation_function": -1, "_enable_rl_module_api": -1, "auto_wrap_old_gym_envs": -1, "always_attach_evaluation_results": -1, "replay_sequence_length": null, "_disable_execution_plan_api": -1, "use_critic": true, "use_gae": true, "use_kl_loss": true, "kl_coeff": 0.7464963036515, "kl_target": 0.0270990929592, "vf_loss_coeff": 0.6688075857018, "entropy_coeff": 0.0090570820258, "clip_param": 0.1221781641624, "vf_clip_param": 0.1027808522125, "entropy_coeff_schedule": null, "lr_schedule": null, "sgd_minibatch_size": -1, "vf_share_layers": -1, "__stdout_file__": null, "__stderr_file__": null, "lambda": 0.9099046732075, "input": "sampler", "policies": {"default_policy": [null, null, null, null]}, "callbacks": "<class 'ray.rllib.callbacks.callbacks.RLlibCallback'>", "create_env_on_driver": false, "custom_eval_function": null, "framework": "torch"}, "time_since_restore": 6.009294748306274, "iterations_since_restore": 3, "perf": {"cpu_util_percent": 48.2, "ram_util_percent": 81.80000000000001}}
{"timers": {"training_iteration": 2.321400460029605, "restore_env_runners": 1.488506251317449e-05, "training_step": 2.321250149995123, "env_runner_sampling_timer": 2.2103841758295144, "learner_update_timer": 0.10749978811839503, "synch_weights": 0.0007333683395425323, "restore_eval_env_runners": 1.1808538762852549e-05, "evaluation_iteration": 0.12883240016129566, "synch_eval_env_connectors": 0.00013430759632028638, "synch_env_connectors": 4.786825738847255e-06}, "env_runners": {"sample": 0.006032188911117622, "module_episode_returns_mean": {"default_policy": -0.3}, "env_to_module_connector": {"timers": {"connectors": {"add_states_from_episodes_to_batch": 1.9610312737817074e-06, "numpy_to_tensor": 1.1317090849940864e-05, "add_observations_from_episodes_to_batch": 3.6626467754266203e-06, "add_time_dim_to_batch_and_zero_pad": 2.9054088565940688e-06, "batch_individual_items": 8.131318465944451e-06}}, "connector_pipeline_timer": 5.345528239757703e-05}, "env_reset_timer": 5.7887119349681224e-05, "module_to_env_connector": {"timers": {"connectors": {"tensor_to_numpy": 1.6627307376530694e-05, "normalize_and_clip_actions": 1.1557890668239426e-05, "listify_data_for_vector_env": 1.3755174967597696e-05, "remove_single_ts_time_rank_from_batch": 7.46211143178773e-07, "un_batch_to_individual_items": 6.594586541557045e-06, "get_actions": 5.067829101098864e-05}}, "connector_pipeline_timer": 0.00013077381322216953}, "num_module_steps_sampled": {"default_policy": 5000.0}, "weights_seq_no": 3.0, "agent_episode_returns_mean": {"default_agent": -0.3}, "env_to_module_sum_episodes_length_out": 10.36823839457432, "env_step_timer": 1.807610131986808e-05, "num_env_steps_sampled": 5000.0, "episode_return_mean": -0.3, "num_episodes_lifetime": -61250.0, "num_module_steps_sampled_lifetime": {"default_policy": -1225000.0}, "time_between_sampling": 0.0022381567880914765, "env_to_module_sum_episodes_length_in": 10.36823839457432, "rlmodule_inference_timer": 3.462767972749237e-05, "episode_duration_sec_mean": 0.005705800197087227, "num_env_steps_sampled_lifetime": -1225000.0, "episode_len_max": 20, "episode_len_mean": 20.0, "num_episodes": 250.0, "episode_return_max": 8.5, "num_agent_steps_sampled": {"default_agent": 5000.0}, "episode_len_min": 20, "episode_return_min": -11.5, "num_agent_steps_sampled_lifetime": {"default_agent": -1225000.0}, "num_env_steps_sampled_lifetime_throughput": 3072.713294793471}, "learners": {"__all_modules__": {"num_env_steps_trained": 31500, "learner_connector": {"timers": {"connectors": {"add_one_ts_to_episodes_and_truncate": 0.007657071161998204, "add_columns_from_episodes_to_train_batch": 0.03417327121330239, "general_advantage_estimation": 0.006562392262140173, "add_states_from_episodes_to_batch": 3.760761170298792e-06, "add_time_dim_to_batch_and_zero_pad": 1.2595150193898006e-05, "batch_individual_items": 0.031478989205526775, "numpy_to_tensor": 6.99532936246833e-05, "add_observations_from_episodes_to_batch": 0.0008021080019201617}}, "connector_pipeline_timer": 0.08089783842425431}, "num_module_steps_trained_lifetime": 24000, "learner_connector_sum_episodes_length_in": 5000.0, "num_module_steps_trained": 6000, "learner_connector_sum_episodes_length_out": 5250.0, "num_env_steps_trained_lifetime": 126000, "num_non_trainable_parameters": 0, "num_trainable_parameters": 6003, "num_env_steps_trained_lifetime_throughput": 2290653.102153792, "num_module_steps_trained_throughput": 438853.8570610662, "num_module_steps_trained_lifetime_throughput": 437918.724898153}, "default_policy": {"mean_kl_loss": 0.00018847151659429073, "curr_kl_coeff": 0.04665601998567581, "module_train_batch_size_mean": 1000.0, "weights_seq_no": 4.0, "default_optimizer_learning_rate": 0.0002847858517, "num_trainable_parameters": 6003, "num_module_steps_trained_lifetime": 24000, "entropy": 0.6886228322982788, "curr_entropy_coeff": 0.0090570820258, "num_module_steps_trained": 6000, "policy_loss": 0.004799160175025463, "vf_loss": 0.10278083384037018, "total_loss": 0.06732043623924255, "diff_num_grad_updates_vs_sampler_policy": 1.0, "vf_loss_unclipped": 28.49736213684082, "vf_explained_var": 0.002683281898498535, "gradients_default_optimizer_global_norm": 0.035478390753269196, "num_module_steps_trained_lifetime_throughput": 440133.50862463616}}, "num_training_step_calls_per_iteration": 1, "evaluation": {"env_runners": {"module_to_env_connector": {"timers": {"connectors": {"un_batch_to_individual_items": 5.856611383554686e-06, "get_actions": 4.286862445580004e-05, "tensor_to_numpy": 1.4299448586112885e-05, "listify_data_for_vector_env": 1.2234137128507007e-05, "normalize_and_clip_actions": 1.019008018819069e-05, "remove_single_ts_time_rank_from_batch": 6.106691175863137e-07}}, "connector_pipeline_timer": 0.00011247262427880323}, "env_step_timer": 1.55497817890443e-05, "env_to_module_connector": {"timers": {"connectors": {"add_observations_from_episodes_to_batch": 3.007871822858013e-06, "add_time_dim_to_batch_and_zero_pad": 2.441925336842882e-06, "batch_individual_items": 6.649371136607249e-06, "add_states_from_episodes_to_batch": 1.630857722247183e-06, "numpy_to_tensor": 9.228180076804358e-06}}, "connector_pipeline_timer": 4.4984847465137076e-05}, "episode_duration_sec_mean": 0.004829294804949313, "num_episodes": 20, "episode_return_min": -14.5, "agent_episode_returns_mean": {"default_agent": 0.25}, "sample": 0.11373528225828577, "num_agent_steps_sampled_lifetime": {"default_agent": 1600}, "env_to_module_sum_episodes_length_out": 10.368237912813044, "num_env_steps_sampled": 400, "module_episode_returns_mean": {"default_policy": 0.25}, "rlmodule_inference_timer": 3.1278610023534055e-05, "episode_return_max": 14.5, "env_reset_timer": 0.0010460271612477954, "num_agent_steps_sampled": {"default_agent": 400}, "episode_return_mean": 0.25, "num_episodes_lifetime": 80, "weights_seq_no": 4.0, "env_to_module_sum_episodes_length_in": 10.368237912813044, "num_env_steps_sampled_lifetime": 20400, "num_module_steps_sampled": {"default_policy": 400}, "episode_len_max": 20, "episode_len_mean": 20.0, "episode_len_min": 20, "num_module_steps_sampled_lifetime": {"default_policy": 1600}, "time_between_sampling": 1.7721166273922426}, "num_healthy_workers": 1, "actor_manager_num_outstanding_async_reqs": 0, "num_remote_worker_restarts": 0}, "num_env_steps_sampled_lifetime": -1225000.0, "fault_tolerance": {"num_healthy_workers": 0, "num_remote_worker_restarts": 0}, "env_runner_group": {"actor_manager_num_outstanding_async_reqs": 0}, "done": false, "training_iteration": 4, "trial_id": "4d657_00000", "date": "2025-08-11_19-20-59", "timestamp": 1754932859, "time_this_iter_s": 2.1158037185668945, "time_total_s": 8.125098466873169, "pid": 14261, "hostname": "Mac", "node_ip": "127.0.0.1", "config": {"exploration_config": {}, "extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "placement_strategy": "PACK", "num_gpus": 0, "_fake_gpus": false, "num_cpus_for_main_process": 2, "eager_tracing": true, "eager_max_retraces": 20, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "torch_compile_learner": false, "torch_compile_learner_what_to_compile": "forward_train", "torch_compile_learner_dynamo_backend": "aot_eager", "torch_compile_learner_dynamo_mode": null, "torch_compile_worker": false, "torch_compile_worker_dynamo_backend": "aot_eager", "torch_compile_worker_dynamo_mode": null, "torch_ddp_kwargs": {}, "torch_skip_nan_gradients": false, "env": "Umbrella", "env_config": {}, "observation_space": null, "action_space": null, "clip_rewards": null, "normalize_actions": true, "clip_actions": false, "_is_atari": null, "disable_env_checking": false, "render_env": false, "action_mask_key": "action_mask", "env_runner_cls": null, "num_env_runners": 0, "create_local_env_runner": true, "num_envs_per_env_runner": 1, "gym_env_vectorize_mode": "SYNC", "num_cpus_per_env_runner": 1, "num_gpus_per_env_runner": 0, "custom_resources_per_env_runner": {}, "validate_env_runners_after_construction": true, "episodes_to_numpy": true, "max_requests_in_flight_per_env_runner": 1, "sample_timeout_s": 60.0, "_env_to_module_connector": null, "add_default_connectors_to_env_to_module_pipeline": true, "_module_to_env_connector": null, "add_default_connectors_to_module_to_env_pipeline": true, "merge_env_runner_states": "training_only", "broadcast_env_runner_states": true, "episode_lookback_horizon": 1, "rollout_fragment_length": "auto", "batch_mode": "complete_episodes", "compress_observations": false, "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "enable_tf1_exec_eagerly": false, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "preprocessor_pref": "deepmind", "observation_filter": "NoFilter", "update_worker_filter_stats": true, "use_worker_filter_stats": true, "sampler_perf_stats_ema_coef": null, "_is_online": true, "num_learners": 0, "num_gpus_per_learner": 0, "num_cpus_per_learner": "auto", "num_aggregator_actors_per_learner": 0, "max_requests_in_flight_per_aggregator_actor": 3, "local_gpu_idx": 0, "max_requests_in_flight_per_learner": 3, "gamma": 1, "lr": 0.0002847858517, "grad_clip": 0.5, "grad_clip_by": "global_norm", "_train_batch_size_per_learner": 5000, "train_batch_size": 4000, "num_epochs": 1, "minibatch_size": 1000, "shuffle_batch_per_epoch": true, "model": {"fcnet_hiddens": [256, 256], "fcnet_activation": "tanh", "fcnet_weights_initializer": null, "fcnet_weights_initializer_config": null, "fcnet_bias_initializer": null, "fcnet_bias_initializer_config": null, "conv_filters": null, "conv_activation": "relu", "conv_kernel_initializer": null, "conv_kernel_initializer_config": null, "conv_bias_initializer": null, "conv_bias_initializer_config": null, "conv_transpose_kernel_initializer": null, "conv_transpose_kernel_initializer_config": null, "conv_transpose_bias_initializer": null, "conv_transpose_bias_initializer_config": null, "post_fcnet_hiddens": [], "post_fcnet_activation": "relu", "post_fcnet_weights_initializer": null, "post_fcnet_weights_initializer_config": null, "post_fcnet_bias_initializer": null, "post_fcnet_bias_initializer_config": null, "free_log_std": false, "log_std_clip_param": 20.0, "no_final_linear": false, "vf_share_layers": false, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "lstm_weights_initializer": null, "lstm_weights_initializer_config": null, "lstm_bias_initializer": null, "lstm_bias_initializer_config": null, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "attention_use_n_prev_actions": 0, "attention_use_n_prev_rewards": 0, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": null, "custom_model_config": {}, "custom_action_dist": null, "custom_preprocessor": null, "encoder_latent_dim": null, "always_check_shapes": false, "lstm_use_prev_action_reward": -1, "_use_default_native_models": -1, "_disable_preprocessor_api": false, "_disable_action_flattening": false}, "_learner_connector": null, "add_default_connectors_to_learner_pipeline": true, "learner_config_dict": {}, "optimizer": {}, "_learner_class": null, "callbacks_on_algorithm_init": null, "callbacks_on_env_runners_recreated": null, "callbacks_on_offline_eval_runners_recreated": null, "callbacks_on_checkpoint_loaded": null, "callbacks_on_environment_created": null, "callbacks_on_episode_created": null, "callbacks_on_episode_start": null, "callbacks_on_episode_step": null, "callbacks_on_episode_end": null, "callbacks_on_evaluate_start": null, "callbacks_on_evaluate_end": null, "callbacks_on_evaluate_offline_start": null, "callbacks_on_evaluate_offline_end": null, "callbacks_on_sample_end": null, "callbacks_on_train_result": null, "explore": true, "enable_rl_module_and_learner": true, "enable_env_runner_and_connector_v2": true, "_prior_exploration_config": {"type": "StochasticSampling"}, "count_steps_by": "env_steps", "policy_map_capacity": 100, "policy_mapping_fn": "<function AlgorithmConfig.DEFAULT_POLICY_MAPPING_FN at 0x1680e9b20>", "policies_to_train": null, "policy_states_are_swappable": false, "observation_fn": null, "offline_data_class": null, "input_read_method": "read_parquet", "input_read_method_kwargs": {}, "input_read_schema": {}, "input_read_episodes": false, "input_read_sample_batches": false, "input_read_batch_size": null, "input_filesystem": null, "input_filesystem_kwargs": {}, "input_compress_columns": ["obs", "new_obs"], "input_spaces_jsonable": true, "materialize_data": false, "materialize_mapped_data": true, "map_batches_kwargs": {}, "iter_batches_kwargs": {}, "ignore_final_observation": false, "prelearner_class": null, "prelearner_buffer_class": null, "prelearner_buffer_kwargs": {}, "prelearner_module_synch_period": 10, "dataset_num_iters_per_learner": null, "input_config": {}, "actions_in_input_normalized": false, "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_config": {}, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "output_max_rows_per_file": null, "output_write_remaining_data": false, "output_write_method": "write_parquet", "output_write_method_kwargs": {}, "output_filesystem": null, "output_filesystem_kwargs": {}, "output_write_episodes": true, "offline_sampling": false, "evaluation_interval": 1, "evaluation_duration": 20, "evaluation_duration_unit": "episodes", "evaluation_sample_timeout_s": 120.0, "evaluation_auto_duration_min_env_steps_per_sample": 100, "evaluation_auto_duration_max_env_steps_per_sample": 2000, "evaluation_parallel_to_training": false, "evaluation_force_reset_envs_before_iteration": true, "evaluation_config": null, "off_policy_estimation_methods": {}, "ope_split_batch_by_episode": true, "evaluation_num_env_runners": 1, "in_evaluation": false, "sync_filters_on_rollout_workers_timeout_s": 10.0, "offline_evaluation_interval": null, "num_offline_eval_runners": 0, "offline_loss_for_module_fn": null, "offline_evaluation_duration": 1, "offline_evaluation_parallel_to_training": false, "offline_evaluation_timeout_s": 120.0, "num_cpus_per_offline_eval_runner": 1, "num_gpus_per_offline_eval_runner": 0, "custom_resources_per_offline_eval_runner": {}, "restart_failed_offline_eval_runners": true, "ignore_offline_eval_runner_failures": false, "max_num_offline_eval_runner_restarts": 1000, "offline_eval_runner_restore_timeout_s": 1800.0, "max_requests_in_flight_per_offline_eval_runner": 1, "validate_offline_eval_runners_after_construction": true, "offline_eval_runner_health_probe_timeout_s": 30.0, "offline_eval_rl_module_inference_only": false, "broadcast_offline_eval_runner_states": false, "offline_eval_batch_size_per_runner": 256, "dataset_num_iters_per_eval_runner": 1, "keep_per_episode_custom_metrics": false, "metrics_episode_collection_timeout_s": 60.0, "metrics_num_episodes_for_smoothing": 100, "min_time_s_per_iteration": null, "min_train_timesteps_per_iteration": 0, "min_sample_timesteps_per_iteration": 0, "log_gradients": true, "export_native_model_files": false, "checkpoint_trainable_policies_only": false, "logger_creator": null, "logger_config": null, "log_level": "WARN", "log_sys_usage": true, "fake_sampler": false, "seed": 8, "restart_failed_env_runners": true, "ignore_env_runner_failures": false, "max_num_env_runner_restarts": 1000, "delay_between_env_runner_restarts_s": 60.0, "restart_failed_sub_environments": false, "num_consecutive_env_runner_failures_tolerance": 100, "env_runner_health_probe_timeout_s": 30.0, "env_runner_restore_timeout_s": 1800.0, "_model_config": {}, "_rl_module_spec": "RLModuleSpec(module_class=None, observation_space=None, action_space=None, inference_only=False, learner_only=False, model_config=DefaultModelConfig(fcnet_hiddens=[60, 90], fcnet_activation='tanh', fcnet_kernel_initializer=None, fcnet_kernel_initializer_kwargs=None, fcnet_bias_initializer=None, fcnet_bias_initializer_kwargs=None, conv_filters=None, conv_activation='relu', conv_kernel_initializer=None, conv_kernel_initializer_kwargs=None, conv_bias_initializer=None, conv_bias_initializer_kwargs=None, head_fcnet_hiddens=[], head_fcnet_activation='relu', head_fcnet_kernel_initializer=None, head_fcnet_kernel_initializer_kwargs=None, head_fcnet_bias_initializer=None, head_fcnet_bias_initializer_kwargs=None, free_log_std=False, log_std_clip_param=20.0, vf_share_layers=True, use_lstm=False, max_seq_len=20, lstm_cell_size=256, lstm_use_prev_action=False, lstm_use_prev_reward=False, lstm_kernel_initializer=None, lstm_kernel_initializer_kwargs=None, lstm_bias_initializer=None, lstm_bias_initializer_kwargs=None), catalog_class=None, load_state_path=None, model_config_dict=None)", "algorithm_config_overrides_per_module": {}, "_per_module_overrides": {}, "_validate_config": true, "_use_msgpack_checkpoints": false, "_torch_grad_scaler_class": null, "_torch_lr_scheduler_classes": null, "_tf_policy_handles_more_than_one_loss": false, "_disable_preprocessor_api": false, "_disable_action_flattening": false, "_disable_initialize_loss_from_dummy_batch": false, "_dont_auto_sync_env_runner_states": false, "env_task_fn": -1, "enable_connectors": -1, "simple_optimizer": false, "policy_map_cache": -1, "worker_cls": -1, "synchronize_filters": -1, "enable_async_evaluation": -1, "custom_async_evaluation_function": -1, "_enable_rl_module_api": -1, "auto_wrap_old_gym_envs": -1, "always_attach_evaluation_results": -1, "replay_sequence_length": null, "_disable_execution_plan_api": -1, "use_critic": true, "use_gae": true, "use_kl_loss": true, "kl_coeff": 0.7464963036515, "kl_target": 0.0270990929592, "vf_loss_coeff": 0.6688075857018, "entropy_coeff": 0.0090570820258, "clip_param": 0.1221781641624, "vf_clip_param": 0.1027808522125, "entropy_coeff_schedule": null, "lr_schedule": null, "sgd_minibatch_size": -1, "vf_share_layers": -1, "__stdout_file__": null, "__stderr_file__": null, "lambda": 0.9099046732075, "input": "sampler", "policies": {"default_policy": [null, null, null, null]}, "callbacks": "<class 'ray.rllib.callbacks.callbacks.RLlibCallback'>", "create_env_on_driver": false, "custom_eval_function": null, "framework": "torch"}, "time_since_restore": 8.125098466873169, "iterations_since_restore": 4, "perf": {"cpu_util_percent": 56.46666666666667, "ram_util_percent": 82.50000000000001}}
{"timers": {"training_iteration": 2.316040261678641, "restore_env_runners": 1.4803302038011608e-05, "training_step": 2.3158891818354617, "env_runner_sampling_timer": 2.2050299990714626, "learner_update_timer": 0.10749021107737945, "synch_weights": 0.0007319096566444333, "restore_eval_env_runners": 1.1802533390466123e-05, "evaluation_iteration": 0.12867521657943037, "synch_eval_env_connectors": 0.0001339361901539378, "synch_env_connectors": 4.8081174958497284e-06}, "env_runners": {"sample": 0.005540086316149703, "module_episode_returns_mean": {"default_policy": -0.14000000000000007}, "env_to_module_connector": {"timers": {"connectors": {"add_states_from_episodes_to_batch": 1.8479617351761525e-06, "numpy_to_tensor": 9.831483699438899e-06, "add_observations_from_episodes_to_batch": 3.2072858895084164e-06, "add_time_dim_to_batch_and_zero_pad": 2.6194639552572938e-06, "batch_individual_items": 7.212115645754353e-06}}, "connector_pipeline_timer": 4.8071962463158015e-05}, "env_reset_timer": 4.909650593140531e-05, "module_to_env_connector": {"timers": {"connectors": {"tensor_to_numpy": 1.4843565881540404e-05, "normalize_and_clip_actions": 1.0513340077172256e-05, "listify_data_for_vector_env": 1.246019557639906e-05, "remove_single_ts_time_rank_from_batch": 6.44976529300383e-07, "un_batch_to_individual_items": 6.0563956210298844e-06, "get_actions": 4.537105800810228e-05}}, "connector_pipeline_timer": 0.00011788324879302136}, "num_module_steps_sampled": {"default_policy": 5000.0}, "weights_seq_no": 4.0, "agent_episode_returns_mean": {"default_agent": -0.14000000000000007}, "env_to_module_sum_episodes_length_out": 10.36823839457432, "env_step_timer": 1.5708103842885374e-05, "num_env_steps_sampled": 5000.0, "episode_return_mean": -0.14000000000000007, "num_episodes_lifetime": -92125.0, "num_module_steps_sampled_lifetime": {"default_policy": -1842500.0}, "time_between_sampling": 0.0018193475736541342, "env_to_module_sum_episodes_length_in": 10.36823839457432, "rlmodule_inference_timer": 5.303027588964436e-05, "episode_duration_sec_mean": 0.00555614354321733, "num_env_steps_sampled_lifetime": -1842500.0, "episode_len_max": 20, "episode_len_mean": 20.0, "num_episodes": 250.0, "episode_return_max": 8.5, "num_agent_steps_sampled": {"default_agent": 5000.0}, "episode_len_min": 20, "episode_return_min": -11.5, "num_agent_steps_sampled_lifetime": {"default_agent": -1842500.0}, "num_env_steps_sampled_lifetime_throughput": 3347.207244473654}, "learners": {"__all_modules__": {"num_env_steps_trained": 31500, "learner_connector": {"timers": {"connectors": {"add_one_ts_to_episodes_and_truncate": 0.007655617531083462, "add_columns_from_episodes_to_train_batch": 0.03424285808133131, "general_advantage_estimation": 0.0065576958383716044, "add_states_from_episodes_to_batch": 3.754824346898822e-06, "add_time_dim_to_batch_and_zero_pad": 1.2576278669128659e-05, "batch_individual_items": 0.031504485143205564, "numpy_to_tensor": 6.990001124372823e-05, "add_observations_from_episodes_to_batch": 0.0008020460814577363}}, "connector_pipeline_timer": 0.08098630461976207}, "num_module_steps_trained_lifetime": 30000, "learner_connector_sum_episodes_length_in": 5000.0, "num_module_steps_trained": 6000, "learner_connector_sum_episodes_length_out": 5250.0, "num_env_steps_trained_lifetime": 157500, "num_non_trainable_parameters": 0, "num_trainable_parameters": 6003, "num_env_steps_trained_lifetime_throughput": 2276477.433809212, "num_module_steps_trained_throughput": 436075.2846572855, "num_module_steps_trained_lifetime_throughput": 435166.89312612364}, "default_policy": {"mean_kl_loss": 0.0005214021657593548, "curr_kl_coeff": 0.023328009992837906, "module_train_batch_size_mean": 1000.0, "weights_seq_no": 5.0, "default_optimizer_learning_rate": 0.0002847858517, "num_trainable_parameters": 6003, "num_module_steps_trained_lifetime": 30000, "entropy": 0.6842040419578552, "curr_entropy_coeff": 0.0090570820258, "num_module_steps_trained": 6000, "policy_loss": 0.03844098374247551, "vf_loss": 0.10278083384037018, "total_loss": 0.10100902616977692, "diff_num_grad_updates_vs_sampler_policy": 1.0, "vf_loss_unclipped": 28.689939498901367, "vf_explained_var": 0.003237903118133545, "gradients_default_optimizer_global_norm": 0.09610242396593094, "num_module_steps_trained_lifetime_throughput": 437288.7453001931}}, "num_training_step_calls_per_iteration": 1, "evaluation": {"env_runners": {"module_to_env_connector": {"timers": {"connectors": {"un_batch_to_individual_items": 5.536348435616625e-06, "get_actions": 3.959310994733321e-05, "tensor_to_numpy": 1.3871182300005164e-05, "listify_data_for_vector_env": 1.1318271194806577e-05, "normalize_and_clip_actions": 9.777070111454838e-06, "remove_single_ts_time_rank_from_batch": 5.938145664915477e-07}}, "connector_pipeline_timer": 0.00010666428555726228}, "env_step_timer": 1.5102006421267611e-05, "env_to_module_connector": {"timers": {"connectors": {"add_observations_from_episodes_to_batch": 2.898357853199493e-06, "add_time_dim_to_batch_and_zero_pad": 2.3724982906722656e-06, "batch_individual_items": 6.5365050803569175e-06, "add_states_from_episodes_to_batch": 1.6482406515369195e-06, "numpy_to_tensor": 8.892068009416211e-06}}, "connector_pipeline_timer": 4.456733698400739e-05}, "episode_duration_sec_mean": 0.004855767107801512, "num_episodes": 20, "episode_return_min": -14.5, "agent_episode_returns_mean": {"default_agent": 0.95}, "sample": 0.11369258443560912, "num_agent_steps_sampled_lifetime": {"default_agent": 2000}, "env_to_module_sum_episodes_length_out": 10.368238387501162, "num_env_steps_sampled": 400, "module_episode_returns_mean": {"default_policy": 0.95}, "rlmodule_inference_timer": 2.9189122361572725e-05, "episode_return_max": 14.5, "env_reset_timer": 0.0010388164696758914, "num_agent_steps_sampled": {"default_agent": 400}, "episode_return_mean": 0.95, "num_episodes_lifetime": 100, "weights_seq_no": 5.0, "env_to_module_sum_episodes_length_in": 10.368238387501162, "num_env_steps_sampled_lifetime": 25400, "num_module_steps_sampled": {"default_policy": 400}, "episode_len_max": 20, "episode_len_mean": 20.0, "episode_len_min": 20, "num_module_steps_sampled_lifetime": {"default_policy": 2000}, "time_between_sampling": 1.7725534086183237}, "num_healthy_workers": 1, "actor_manager_num_outstanding_async_reqs": 0, "num_remote_worker_restarts": 0}, "num_env_steps_sampled_lifetime": -1842500.0, "fault_tolerance": {"num_healthy_workers": 0, "num_remote_worker_restarts": 0}, "env_runner_group": {"actor_manager_num_outstanding_async_reqs": 0}, "done": false, "training_iteration": 5, "trial_id": "4d657_00000", "date": "2025-08-11_19-21-01", "timestamp": 1754932861, "time_this_iter_s": 1.90559720993042, "time_total_s": 10.030695676803589, "pid": 14261, "hostname": "Mac", "node_ip": "127.0.0.1", "config": {"exploration_config": {}, "extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "placement_strategy": "PACK", "num_gpus": 0, "_fake_gpus": false, "num_cpus_for_main_process": 2, "eager_tracing": true, "eager_max_retraces": 20, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "torch_compile_learner": false, "torch_compile_learner_what_to_compile": "forward_train", "torch_compile_learner_dynamo_backend": "aot_eager", "torch_compile_learner_dynamo_mode": null, "torch_compile_worker": false, "torch_compile_worker_dynamo_backend": "aot_eager", "torch_compile_worker_dynamo_mode": null, "torch_ddp_kwargs": {}, "torch_skip_nan_gradients": false, "env": "Umbrella", "env_config": {}, "observation_space": null, "action_space": null, "clip_rewards": null, "normalize_actions": true, "clip_actions": false, "_is_atari": null, "disable_env_checking": false, "render_env": false, "action_mask_key": "action_mask", "env_runner_cls": null, "num_env_runners": 0, "create_local_env_runner": true, "num_envs_per_env_runner": 1, "gym_env_vectorize_mode": "SYNC", "num_cpus_per_env_runner": 1, "num_gpus_per_env_runner": 0, "custom_resources_per_env_runner": {}, "validate_env_runners_after_construction": true, "episodes_to_numpy": true, "max_requests_in_flight_per_env_runner": 1, "sample_timeout_s": 60.0, "_env_to_module_connector": null, "add_default_connectors_to_env_to_module_pipeline": true, "_module_to_env_connector": null, "add_default_connectors_to_module_to_env_pipeline": true, "merge_env_runner_states": "training_only", "broadcast_env_runner_states": true, "episode_lookback_horizon": 1, "rollout_fragment_length": "auto", "batch_mode": "complete_episodes", "compress_observations": false, "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "enable_tf1_exec_eagerly": false, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "preprocessor_pref": "deepmind", "observation_filter": "NoFilter", "update_worker_filter_stats": true, "use_worker_filter_stats": true, "sampler_perf_stats_ema_coef": null, "_is_online": true, "num_learners": 0, "num_gpus_per_learner": 0, "num_cpus_per_learner": "auto", "num_aggregator_actors_per_learner": 0, "max_requests_in_flight_per_aggregator_actor": 3, "local_gpu_idx": 0, "max_requests_in_flight_per_learner": 3, "gamma": 1, "lr": 0.0002847858517, "grad_clip": 0.5, "grad_clip_by": "global_norm", "_train_batch_size_per_learner": 5000, "train_batch_size": 4000, "num_epochs": 1, "minibatch_size": 1000, "shuffle_batch_per_epoch": true, "model": {"fcnet_hiddens": [256, 256], "fcnet_activation": "tanh", "fcnet_weights_initializer": null, "fcnet_weights_initializer_config": null, "fcnet_bias_initializer": null, "fcnet_bias_initializer_config": null, "conv_filters": null, "conv_activation": "relu", "conv_kernel_initializer": null, "conv_kernel_initializer_config": null, "conv_bias_initializer": null, "conv_bias_initializer_config": null, "conv_transpose_kernel_initializer": null, "conv_transpose_kernel_initializer_config": null, "conv_transpose_bias_initializer": null, "conv_transpose_bias_initializer_config": null, "post_fcnet_hiddens": [], "post_fcnet_activation": "relu", "post_fcnet_weights_initializer": null, "post_fcnet_weights_initializer_config": null, "post_fcnet_bias_initializer": null, "post_fcnet_bias_initializer_config": null, "free_log_std": false, "log_std_clip_param": 20.0, "no_final_linear": false, "vf_share_layers": false, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "lstm_weights_initializer": null, "lstm_weights_initializer_config": null, "lstm_bias_initializer": null, "lstm_bias_initializer_config": null, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "attention_use_n_prev_actions": 0, "attention_use_n_prev_rewards": 0, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": null, "custom_model_config": {}, "custom_action_dist": null, "custom_preprocessor": null, "encoder_latent_dim": null, "always_check_shapes": false, "lstm_use_prev_action_reward": -1, "_use_default_native_models": -1, "_disable_preprocessor_api": false, "_disable_action_flattening": false}, "_learner_connector": null, "add_default_connectors_to_learner_pipeline": true, "learner_config_dict": {}, "optimizer": {}, "_learner_class": null, "callbacks_on_algorithm_init": null, "callbacks_on_env_runners_recreated": null, "callbacks_on_offline_eval_runners_recreated": null, "callbacks_on_checkpoint_loaded": null, "callbacks_on_environment_created": null, "callbacks_on_episode_created": null, "callbacks_on_episode_start": null, "callbacks_on_episode_step": null, "callbacks_on_episode_end": null, "callbacks_on_evaluate_start": null, "callbacks_on_evaluate_end": null, "callbacks_on_evaluate_offline_start": null, "callbacks_on_evaluate_offline_end": null, "callbacks_on_sample_end": null, "callbacks_on_train_result": null, "explore": true, "enable_rl_module_and_learner": true, "enable_env_runner_and_connector_v2": true, "_prior_exploration_config": {"type": "StochasticSampling"}, "count_steps_by": "env_steps", "policy_map_capacity": 100, "policy_mapping_fn": "<function AlgorithmConfig.DEFAULT_POLICY_MAPPING_FN at 0x1680e9b20>", "policies_to_train": null, "policy_states_are_swappable": false, "observation_fn": null, "offline_data_class": null, "input_read_method": "read_parquet", "input_read_method_kwargs": {}, "input_read_schema": {}, "input_read_episodes": false, "input_read_sample_batches": false, "input_read_batch_size": null, "input_filesystem": null, "input_filesystem_kwargs": {}, "input_compress_columns": ["obs", "new_obs"], "input_spaces_jsonable": true, "materialize_data": false, "materialize_mapped_data": true, "map_batches_kwargs": {}, "iter_batches_kwargs": {}, "ignore_final_observation": false, "prelearner_class": null, "prelearner_buffer_class": null, "prelearner_buffer_kwargs": {}, "prelearner_module_synch_period": 10, "dataset_num_iters_per_learner": null, "input_config": {}, "actions_in_input_normalized": false, "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_config": {}, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "output_max_rows_per_file": null, "output_write_remaining_data": false, "output_write_method": "write_parquet", "output_write_method_kwargs": {}, "output_filesystem": null, "output_filesystem_kwargs": {}, "output_write_episodes": true, "offline_sampling": false, "evaluation_interval": 1, "evaluation_duration": 20, "evaluation_duration_unit": "episodes", "evaluation_sample_timeout_s": 120.0, "evaluation_auto_duration_min_env_steps_per_sample": 100, "evaluation_auto_duration_max_env_steps_per_sample": 2000, "evaluation_parallel_to_training": false, "evaluation_force_reset_envs_before_iteration": true, "evaluation_config": null, "off_policy_estimation_methods": {}, "ope_split_batch_by_episode": true, "evaluation_num_env_runners": 1, "in_evaluation": false, "sync_filters_on_rollout_workers_timeout_s": 10.0, "offline_evaluation_interval": null, "num_offline_eval_runners": 0, "offline_loss_for_module_fn": null, "offline_evaluation_duration": 1, "offline_evaluation_parallel_to_training": false, "offline_evaluation_timeout_s": 120.0, "num_cpus_per_offline_eval_runner": 1, "num_gpus_per_offline_eval_runner": 0, "custom_resources_per_offline_eval_runner": {}, "restart_failed_offline_eval_runners": true, "ignore_offline_eval_runner_failures": false, "max_num_offline_eval_runner_restarts": 1000, "offline_eval_runner_restore_timeout_s": 1800.0, "max_requests_in_flight_per_offline_eval_runner": 1, "validate_offline_eval_runners_after_construction": true, "offline_eval_runner_health_probe_timeout_s": 30.0, "offline_eval_rl_module_inference_only": false, "broadcast_offline_eval_runner_states": false, "offline_eval_batch_size_per_runner": 256, "dataset_num_iters_per_eval_runner": 1, "keep_per_episode_custom_metrics": false, "metrics_episode_collection_timeout_s": 60.0, "metrics_num_episodes_for_smoothing": 100, "min_time_s_per_iteration": null, "min_train_timesteps_per_iteration": 0, "min_sample_timesteps_per_iteration": 0, "log_gradients": true, "export_native_model_files": false, "checkpoint_trainable_policies_only": false, "logger_creator": null, "logger_config": null, "log_level": "WARN", "log_sys_usage": true, "fake_sampler": false, "seed": 8, "restart_failed_env_runners": true, "ignore_env_runner_failures": false, "max_num_env_runner_restarts": 1000, "delay_between_env_runner_restarts_s": 60.0, "restart_failed_sub_environments": false, "num_consecutive_env_runner_failures_tolerance": 100, "env_runner_health_probe_timeout_s": 30.0, "env_runner_restore_timeout_s": 1800.0, "_model_config": {}, "_rl_module_spec": "RLModuleSpec(module_class=None, observation_space=None, action_space=None, inference_only=False, learner_only=False, model_config=DefaultModelConfig(fcnet_hiddens=[60, 90], fcnet_activation='tanh', fcnet_kernel_initializer=None, fcnet_kernel_initializer_kwargs=None, fcnet_bias_initializer=None, fcnet_bias_initializer_kwargs=None, conv_filters=None, conv_activation='relu', conv_kernel_initializer=None, conv_kernel_initializer_kwargs=None, conv_bias_initializer=None, conv_bias_initializer_kwargs=None, head_fcnet_hiddens=[], head_fcnet_activation='relu', head_fcnet_kernel_initializer=None, head_fcnet_kernel_initializer_kwargs=None, head_fcnet_bias_initializer=None, head_fcnet_bias_initializer_kwargs=None, free_log_std=False, log_std_clip_param=20.0, vf_share_layers=True, use_lstm=False, max_seq_len=20, lstm_cell_size=256, lstm_use_prev_action=False, lstm_use_prev_reward=False, lstm_kernel_initializer=None, lstm_kernel_initializer_kwargs=None, lstm_bias_initializer=None, lstm_bias_initializer_kwargs=None), catalog_class=None, load_state_path=None, model_config_dict=None)", "algorithm_config_overrides_per_module": {}, "_per_module_overrides": {}, "_validate_config": true, "_use_msgpack_checkpoints": false, "_torch_grad_scaler_class": null, "_torch_lr_scheduler_classes": null, "_tf_policy_handles_more_than_one_loss": false, "_disable_preprocessor_api": false, "_disable_action_flattening": false, "_disable_initialize_loss_from_dummy_batch": false, "_dont_auto_sync_env_runner_states": false, "env_task_fn": -1, "enable_connectors": -1, "simple_optimizer": false, "policy_map_cache": -1, "worker_cls": -1, "synchronize_filters": -1, "enable_async_evaluation": -1, "custom_async_evaluation_function": -1, "_enable_rl_module_api": -1, "auto_wrap_old_gym_envs": -1, "always_attach_evaluation_results": -1, "replay_sequence_length": null, "_disable_execution_plan_api": -1, "use_critic": true, "use_gae": true, "use_kl_loss": true, "kl_coeff": 0.7464963036515, "kl_target": 0.0270990929592, "vf_loss_coeff": 0.6688075857018, "entropy_coeff": 0.0090570820258, "clip_param": 0.1221781641624, "vf_clip_param": 0.1027808522125, "entropy_coeff_schedule": null, "lr_schedule": null, "sgd_minibatch_size": -1, "vf_share_layers": -1, "__stdout_file__": null, "__stderr_file__": null, "lambda": 0.9099046732075, "input": "sampler", "policies": {"default_policy": [null, null, null, null]}, "callbacks": "<class 'ray.rllib.callbacks.callbacks.RLlibCallback'>", "create_env_on_driver": false, "custom_eval_function": null, "framework": "torch"}, "time_since_restore": 10.030695676803589, "iterations_since_restore": 5, "perf": {"cpu_util_percent": 44.93333333333334, "ram_util_percent": 83.16666666666667}}
{"timers": {"training_iteration": 2.3110709686420754, "restore_env_runners": 1.4720689771885358e-05, "training_step": 2.3109195291872764, "env_runner_sampling_timer": 2.199138823670506, "learner_update_timer": 0.10841273479636453, "synch_weights": 0.0007316118102812407, "restore_eval_env_runners": 1.1773258441309444e-05, "evaluation_iteration": 0.12856664982373517, "synch_eval_env_connectors": 0.00013745140887270216, "synch_env_connectors": 4.808786401059478e-06}, "env_runners": {"sample": 0.005967536842937079, "module_episode_returns_mean": {"default_policy": 0.58}, "env_to_module_connector": {"timers": {"connectors": {"add_states_from_episodes_to_batch": 1.9038674315464741e-06, "numpy_to_tensor": 1.0248054158536826e-05, "add_observations_from_episodes_to_batch": 3.3518551750159464e-06, "add_time_dim_to_batch_and_zero_pad": 2.733720036789426e-06, "batch_individual_items": 7.560292554146362e-06}}, "connector_pipeline_timer": 5.0049907422834235e-05}, "env_reset_timer": 5.114902380628621e-05, "module_to_env_connector": {"timers": {"connectors": {"tensor_to_numpy": 1.5266462953147005e-05, "normalize_and_clip_actions": 1.1118746196553546e-05, "listify_data_for_vector_env": 1.304729798325657e-05, "remove_single_ts_time_rank_from_batch": 6.667344991001901e-07, "un_batch_to_individual_items": 6.139202204077283e-06, "get_actions": 4.685432214233641e-05}}, "connector_pipeline_timer": 0.00012204400159348657}, "num_module_steps_sampled": {"default_policy": 5000.0}, "weights_seq_no": 5.0, "agent_episode_returns_mean": {"default_agent": 0.58}, "env_to_module_sum_episodes_length_out": 10.36823839457432, "env_step_timer": 1.6496353288732175e-05, "num_env_steps_sampled": 5000.0, "episode_return_mean": 0.58, "num_episodes_lifetime": -123000.0, "num_module_steps_sampled_lifetime": {"default_policy": -2460000.0}, "time_between_sampling": 0.0017411948598447943, "env_to_module_sum_episodes_length_in": 10.36823839457432, "rlmodule_inference_timer": 3.246638444987616e-05, "episode_duration_sec_mean": 0.0053030673325993125, "num_env_steps_sampled_lifetime": -2460000.0, "episode_len_max": 20, "episode_len_mean": 20.0, "num_episodes": 250.0, "episode_return_max": 8.5, "num_agent_steps_sampled": {"default_agent": 5000.0}, "episode_len_min": 20, "episode_return_min": -11.5, "num_agent_steps_sampled_lifetime": {"default_agent": -2460000.0}, "num_env_steps_sampled_lifetime_throughput": 3291.1126327951943}, "learners": {"__all_modules__": {"num_env_steps_trained": 31500, "learner_connector": {"timers": {"connectors": {"add_one_ts_to_episodes_and_truncate": 0.007677459274982301, "add_columns_from_episodes_to_train_batch": 0.03424641325140335, "general_advantage_estimation": 0.006557535960174195, "add_states_from_episodes_to_batch": 3.7481156863350067e-06, "add_time_dim_to_batch_and_zero_pad": 1.2580095448856497e-05, "batch_individual_items": 0.032498168621378, "numpy_to_tensor": 7.006142047676877e-05, "add_observations_from_episodes_to_batch": 0.0008027189510987304}}, "connector_pipeline_timer": 0.0820058557328568}, "num_module_steps_trained_lifetime": 36000, "learner_connector_sum_episodes_length_in": 5000.0, "num_module_steps_trained": 6000, "learner_connector_sum_episodes_length_out": 5250.0, "num_env_steps_trained_lifetime": 189000, "num_non_trainable_parameters": 0, "num_trainable_parameters": 6003, "num_env_steps_trained_lifetime_throughput": 2261777.042951002, "num_module_steps_trained_throughput": 433189.1616013216, "num_module_steps_trained_lifetime_throughput": 432310.27880149824}, "default_policy": {"mean_kl_loss": 0.001113722799345851, "curr_kl_coeff": 0.011664004996418953, "module_train_batch_size_mean": 1000.0, "weights_seq_no": 6.0, "default_optimizer_learning_rate": 0.0002847858517, "num_trainable_parameters": 6003, "num_module_steps_trained_lifetime": 36000, "entropy": 0.676906406879425, "curr_entropy_coeff": 0.0090570820258, "num_module_steps_trained": 6000, "policy_loss": -0.08983005583286285, "vf_loss": 0.10278083384037018, "total_loss": -0.02719425968825817, "diff_num_grad_updates_vs_sampler_policy": 1.0, "vf_loss_unclipped": 27.926227569580078, "vf_explained_var": 0.003413856029510498, "gradients_default_optimizer_global_norm": 0.08454997837543488, "num_module_steps_trained_lifetime_throughput": 434332.27937316045}}, "num_training_step_calls_per_iteration": 1, "evaluation": {"env_runners": {"module_to_env_connector": {"timers": {"connectors": {"un_batch_to_individual_items": 6.276366376045341e-06, "get_actions": 4.1773977734564e-05, "tensor_to_numpy": 1.4877654142364814e-05, "listify_data_for_vector_env": 1.2101320974907697e-05, "normalize_and_clip_actions": 1.0573890613030763e-05, "remove_single_ts_time_rank_from_batch": 8.751670661735122e-07}}, "connector_pipeline_timer": 0.00011474346455374844}, "env_step_timer": 1.5693396650784748e-05, "env_to_module_connector": {"timers": {"connectors": {"add_observations_from_episodes_to_batch": 3.0510628506498225e-06, "add_time_dim_to_batch_and_zero_pad": 2.5822090230841653e-06, "batch_individual_items": 6.412141158563853e-06, "add_states_from_episodes_to_batch": 1.6351045340803118e-06, "numpy_to_tensor": 8.77238456596188e-06}}, "connector_pipeline_timer": 4.433236121140813e-05}, "episode_duration_sec_mean": 0.00478337625740096, "num_episodes": 20, "episode_return_min": -14.5, "agent_episode_returns_mean": {"default_agent": 1.55}, "sample": 0.11360628859120728, "num_agent_steps_sampled_lifetime": {"default_agent": 2400}, "env_to_module_sum_episodes_length_out": 10.368238394470474, "num_env_steps_sampled": 400, "module_episode_returns_mean": {"default_policy": 1.55}, "rlmodule_inference_timer": 2.9870772287329946e-05, "episode_return_max": 14.5, "env_reset_timer": 0.0010298324751588722, "num_agent_steps_sampled": {"default_agent": 400}, "episode_return_mean": 1.55, "num_episodes_lifetime": 120, "weights_seq_no": 6.0, "env_to_module_sum_episodes_length_in": 10.368238394470474, "num_env_steps_sampled_lifetime": 30400, "num_module_steps_sampled": {"default_policy": 400}, "episode_len_max": 20, "episode_len_mean": 20.0, "episode_len_min": 20, "num_module_steps_sampled_lifetime": {"default_policy": 2400}, "time_between_sampling": 1.7732364720326694}, "num_healthy_workers": 1, "actor_manager_num_outstanding_async_reqs": 0, "num_remote_worker_restarts": 0}, "num_env_steps_sampled_lifetime": -2460000.0, "fault_tolerance": {"num_healthy_workers": 0, "num_remote_worker_restarts": 0}, "env_runner_group": {"actor_manager_num_outstanding_async_reqs": 0}, "done": false, "training_iteration": 6, "trial_id": "4d657_00000", "date": "2025-08-11_19-21-03", "timestamp": 1754932863, "time_this_iter_s": 1.9366071224212646, "time_total_s": 11.967302799224854, "pid": 14261, "hostname": "Mac", "node_ip": "127.0.0.1", "config": {"exploration_config": {}, "extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "placement_strategy": "PACK", "num_gpus": 0, "_fake_gpus": false, "num_cpus_for_main_process": 2, "eager_tracing": true, "eager_max_retraces": 20, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "torch_compile_learner": false, "torch_compile_learner_what_to_compile": "forward_train", "torch_compile_learner_dynamo_backend": "aot_eager", "torch_compile_learner_dynamo_mode": null, "torch_compile_worker": false, "torch_compile_worker_dynamo_backend": "aot_eager", "torch_compile_worker_dynamo_mode": null, "torch_ddp_kwargs": {}, "torch_skip_nan_gradients": false, "env": "Umbrella", "env_config": {}, "observation_space": null, "action_space": null, "clip_rewards": null, "normalize_actions": true, "clip_actions": false, "_is_atari": null, "disable_env_checking": false, "render_env": false, "action_mask_key": "action_mask", "env_runner_cls": null, "num_env_runners": 0, "create_local_env_runner": true, "num_envs_per_env_runner": 1, "gym_env_vectorize_mode": "SYNC", "num_cpus_per_env_runner": 1, "num_gpus_per_env_runner": 0, "custom_resources_per_env_runner": {}, "validate_env_runners_after_construction": true, "episodes_to_numpy": true, "max_requests_in_flight_per_env_runner": 1, "sample_timeout_s": 60.0, "_env_to_module_connector": null, "add_default_connectors_to_env_to_module_pipeline": true, "_module_to_env_connector": null, "add_default_connectors_to_module_to_env_pipeline": true, "merge_env_runner_states": "training_only", "broadcast_env_runner_states": true, "episode_lookback_horizon": 1, "rollout_fragment_length": "auto", "batch_mode": "complete_episodes", "compress_observations": false, "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "enable_tf1_exec_eagerly": false, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "preprocessor_pref": "deepmind", "observation_filter": "NoFilter", "update_worker_filter_stats": true, "use_worker_filter_stats": true, "sampler_perf_stats_ema_coef": null, "_is_online": true, "num_learners": 0, "num_gpus_per_learner": 0, "num_cpus_per_learner": "auto", "num_aggregator_actors_per_learner": 0, "max_requests_in_flight_per_aggregator_actor": 3, "local_gpu_idx": 0, "max_requests_in_flight_per_learner": 3, "gamma": 1, "lr": 0.0002847858517, "grad_clip": 0.5, "grad_clip_by": "global_norm", "_train_batch_size_per_learner": 5000, "train_batch_size": 4000, "num_epochs": 1, "minibatch_size": 1000, "shuffle_batch_per_epoch": true, "model": {"fcnet_hiddens": [256, 256], "fcnet_activation": "tanh", "fcnet_weights_initializer": null, "fcnet_weights_initializer_config": null, "fcnet_bias_initializer": null, "fcnet_bias_initializer_config": null, "conv_filters": null, "conv_activation": "relu", "conv_kernel_initializer": null, "conv_kernel_initializer_config": null, "conv_bias_initializer": null, "conv_bias_initializer_config": null, "conv_transpose_kernel_initializer": null, "conv_transpose_kernel_initializer_config": null, "conv_transpose_bias_initializer": null, "conv_transpose_bias_initializer_config": null, "post_fcnet_hiddens": [], "post_fcnet_activation": "relu", "post_fcnet_weights_initializer": null, "post_fcnet_weights_initializer_config": null, "post_fcnet_bias_initializer": null, "post_fcnet_bias_initializer_config": null, "free_log_std": false, "log_std_clip_param": 20.0, "no_final_linear": false, "vf_share_layers": false, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "lstm_weights_initializer": null, "lstm_weights_initializer_config": null, "lstm_bias_initializer": null, "lstm_bias_initializer_config": null, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "attention_use_n_prev_actions": 0, "attention_use_n_prev_rewards": 0, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": null, "custom_model_config": {}, "custom_action_dist": null, "custom_preprocessor": null, "encoder_latent_dim": null, "always_check_shapes": false, "lstm_use_prev_action_reward": -1, "_use_default_native_models": -1, "_disable_preprocessor_api": false, "_disable_action_flattening": false}, "_learner_connector": null, "add_default_connectors_to_learner_pipeline": true, "learner_config_dict": {}, "optimizer": {}, "_learner_class": null, "callbacks_on_algorithm_init": null, "callbacks_on_env_runners_recreated": null, "callbacks_on_offline_eval_runners_recreated": null, "callbacks_on_checkpoint_loaded": null, "callbacks_on_environment_created": null, "callbacks_on_episode_created": null, "callbacks_on_episode_start": null, "callbacks_on_episode_step": null, "callbacks_on_episode_end": null, "callbacks_on_evaluate_start": null, "callbacks_on_evaluate_end": null, "callbacks_on_evaluate_offline_start": null, "callbacks_on_evaluate_offline_end": null, "callbacks_on_sample_end": null, "callbacks_on_train_result": null, "explore": true, "enable_rl_module_and_learner": true, "enable_env_runner_and_connector_v2": true, "_prior_exploration_config": {"type": "StochasticSampling"}, "count_steps_by": "env_steps", "policy_map_capacity": 100, "policy_mapping_fn": "<function AlgorithmConfig.DEFAULT_POLICY_MAPPING_FN at 0x1680e9b20>", "policies_to_train": null, "policy_states_are_swappable": false, "observation_fn": null, "offline_data_class": null, "input_read_method": "read_parquet", "input_read_method_kwargs": {}, "input_read_schema": {}, "input_read_episodes": false, "input_read_sample_batches": false, "input_read_batch_size": null, "input_filesystem": null, "input_filesystem_kwargs": {}, "input_compress_columns": ["obs", "new_obs"], "input_spaces_jsonable": true, "materialize_data": false, "materialize_mapped_data": true, "map_batches_kwargs": {}, "iter_batches_kwargs": {}, "ignore_final_observation": false, "prelearner_class": null, "prelearner_buffer_class": null, "prelearner_buffer_kwargs": {}, "prelearner_module_synch_period": 10, "dataset_num_iters_per_learner": null, "input_config": {}, "actions_in_input_normalized": false, "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_config": {}, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "output_max_rows_per_file": null, "output_write_remaining_data": false, "output_write_method": "write_parquet", "output_write_method_kwargs": {}, "output_filesystem": null, "output_filesystem_kwargs": {}, "output_write_episodes": true, "offline_sampling": false, "evaluation_interval": 1, "evaluation_duration": 20, "evaluation_duration_unit": "episodes", "evaluation_sample_timeout_s": 120.0, "evaluation_auto_duration_min_env_steps_per_sample": 100, "evaluation_auto_duration_max_env_steps_per_sample": 2000, "evaluation_parallel_to_training": false, "evaluation_force_reset_envs_before_iteration": true, "evaluation_config": null, "off_policy_estimation_methods": {}, "ope_split_batch_by_episode": true, "evaluation_num_env_runners": 1, "in_evaluation": false, "sync_filters_on_rollout_workers_timeout_s": 10.0, "offline_evaluation_interval": null, "num_offline_eval_runners": 0, "offline_loss_for_module_fn": null, "offline_evaluation_duration": 1, "offline_evaluation_parallel_to_training": false, "offline_evaluation_timeout_s": 120.0, "num_cpus_per_offline_eval_runner": 1, "num_gpus_per_offline_eval_runner": 0, "custom_resources_per_offline_eval_runner": {}, "restart_failed_offline_eval_runners": true, "ignore_offline_eval_runner_failures": false, "max_num_offline_eval_runner_restarts": 1000, "offline_eval_runner_restore_timeout_s": 1800.0, "max_requests_in_flight_per_offline_eval_runner": 1, "validate_offline_eval_runners_after_construction": true, "offline_eval_runner_health_probe_timeout_s": 30.0, "offline_eval_rl_module_inference_only": false, "broadcast_offline_eval_runner_states": false, "offline_eval_batch_size_per_runner": 256, "dataset_num_iters_per_eval_runner": 1, "keep_per_episode_custom_metrics": false, "metrics_episode_collection_timeout_s": 60.0, "metrics_num_episodes_for_smoothing": 100, "min_time_s_per_iteration": null, "min_train_timesteps_per_iteration": 0, "min_sample_timesteps_per_iteration": 0, "log_gradients": true, "export_native_model_files": false, "checkpoint_trainable_policies_only": false, "logger_creator": null, "logger_config": null, "log_level": "WARN", "log_sys_usage": true, "fake_sampler": false, "seed": 8, "restart_failed_env_runners": true, "ignore_env_runner_failures": false, "max_num_env_runner_restarts": 1000, "delay_between_env_runner_restarts_s": 60.0, "restart_failed_sub_environments": false, "num_consecutive_env_runner_failures_tolerance": 100, "env_runner_health_probe_timeout_s": 30.0, "env_runner_restore_timeout_s": 1800.0, "_model_config": {}, "_rl_module_spec": "RLModuleSpec(module_class=None, observation_space=None, action_space=None, inference_only=False, learner_only=False, model_config=DefaultModelConfig(fcnet_hiddens=[60, 90], fcnet_activation='tanh', fcnet_kernel_initializer=None, fcnet_kernel_initializer_kwargs=None, fcnet_bias_initializer=None, fcnet_bias_initializer_kwargs=None, conv_filters=None, conv_activation='relu', conv_kernel_initializer=None, conv_kernel_initializer_kwargs=None, conv_bias_initializer=None, conv_bias_initializer_kwargs=None, head_fcnet_hiddens=[], head_fcnet_activation='relu', head_fcnet_kernel_initializer=None, head_fcnet_kernel_initializer_kwargs=None, head_fcnet_bias_initializer=None, head_fcnet_bias_initializer_kwargs=None, free_log_std=False, log_std_clip_param=20.0, vf_share_layers=True, use_lstm=False, max_seq_len=20, lstm_cell_size=256, lstm_use_prev_action=False, lstm_use_prev_reward=False, lstm_kernel_initializer=None, lstm_kernel_initializer_kwargs=None, lstm_bias_initializer=None, lstm_bias_initializer_kwargs=None), catalog_class=None, load_state_path=None, model_config_dict=None)", "algorithm_config_overrides_per_module": {}, "_per_module_overrides": {}, "_validate_config": true, "_use_msgpack_checkpoints": false, "_torch_grad_scaler_class": null, "_torch_lr_scheduler_classes": null, "_tf_policy_handles_more_than_one_loss": false, "_disable_preprocessor_api": false, "_disable_action_flattening": false, "_disable_initialize_loss_from_dummy_batch": false, "_dont_auto_sync_env_runner_states": false, "env_task_fn": -1, "enable_connectors": -1, "simple_optimizer": false, "policy_map_cache": -1, "worker_cls": -1, "synchronize_filters": -1, "enable_async_evaluation": -1, "custom_async_evaluation_function": -1, "_enable_rl_module_api": -1, "auto_wrap_old_gym_envs": -1, "always_attach_evaluation_results": -1, "replay_sequence_length": null, "_disable_execution_plan_api": -1, "use_critic": true, "use_gae": true, "use_kl_loss": true, "kl_coeff": 0.7464963036515, "kl_target": 0.0270990929592, "vf_loss_coeff": 0.6688075857018, "entropy_coeff": 0.0090570820258, "clip_param": 0.1221781641624, "vf_clip_param": 0.1027808522125, "entropy_coeff_schedule": null, "lr_schedule": null, "sgd_minibatch_size": -1, "vf_share_layers": -1, "__stdout_file__": null, "__stderr_file__": null, "lambda": 0.9099046732075, "input": "sampler", "policies": {"default_policy": [null, null, null, null]}, "callbacks": "<class 'ray.rllib.callbacks.callbacks.RLlibCallback'>", "create_env_on_driver": false, "custom_eval_function": null, "framework": "torch"}, "time_since_restore": 11.967302799224854, "iterations_since_restore": 6, "perf": {"cpu_util_percent": 50.3, "ram_util_percent": 83.45}}
{"timers": {"training_iteration": 2.3038622347852744, "restore_env_runners": 1.4653893265258804e-05, "training_step": 2.303709995565377, "env_runner_sampling_timer": 2.1919535208536423, "learner_update_timer": 0.1083566924478169, "synch_weights": 0.0007618990320572706, "restore_eval_env_runners": 1.1734696424811194e-05, "evaluation_iteration": 0.12843391332559623, "synch_eval_env_connectors": 0.00013706980455629672, "synch_env_connectors": 4.8027791834296655e-06}, "env_runners": {"sample": 0.005396358214495397, "module_episode_returns_mean": {"default_policy": 2.259999999999999}, "env_to_module_connector": {"timers": {"connectors": {"add_states_from_episodes_to_batch": 1.7962387446177047e-06, "numpy_to_tensor": 9.354581615256874e-06, "add_observations_from_episodes_to_batch": 3.1213895513759723e-06, "add_time_dim_to_batch_and_zero_pad": 2.5148647415798196e-06, "batch_individual_items": 6.83354941552818e-06}}, "connector_pipeline_timer": 4.60964518619163e-05}, "env_reset_timer": 4.686287001252391e-05, "module_to_env_connector": {"timers": {"connectors": {"tensor_to_numpy": 1.4031411681237286e-05, "normalize_and_clip_actions": 9.950407896966906e-06, "listify_data_for_vector_env": 1.185847582630185e-05, "remove_single_ts_time_rank_from_batch": 6.119031127555408e-07, "un_batch_to_individual_items": 5.704631282329545e-06, "get_actions": 4.1709641716379935e-05}}, "connector_pipeline_timer": 0.00011064137352134255}, "num_module_steps_sampled": {"default_policy": 5000.0}, "weights_seq_no": 6.0, "agent_episode_returns_mean": {"default_agent": 2.259999999999999}, "env_to_module_sum_episodes_length_out": 10.36823839457432, "env_step_timer": 1.5017801650582281e-05, "num_env_steps_sampled": 5000.0, "episode_return_mean": 2.259999999999999, "num_episodes_lifetime": -153875.0, "num_module_steps_sampled_lifetime": {"default_policy": -3077500.0}, "time_between_sampling": 0.002072121451096823, "env_to_module_sum_episodes_length_in": 10.36823839457432, "rlmodule_inference_timer": 2.9147473504597406e-05, "episode_duration_sec_mean": 0.004840586348902436, "num_env_steps_sampled_lifetime": -3077500.0, "episode_len_max": 20, "episode_len_mean": 20.0, "num_episodes": 250.0, "episode_return_max": 8.5, "num_agent_steps_sampled": {"default_agent": 5000.0}, "episode_len_min": 20, "episode_return_min": -11.5, "num_agent_steps_sampled_lifetime": {"default_agent": -3077500.0}, "num_env_steps_sampled_lifetime_throughput": 3470.5641169835953}, "learners": {"__all_modules__": {"num_env_steps_trained": 31500, "learner_connector": {"timers": {"connectors": {"add_one_ts_to_episodes_and_truncate": 0.007680110511695185, "add_columns_from_episodes_to_train_batch": 0.034253959538386586, "general_advantage_estimation": 0.006551291019744055, "add_states_from_episodes_to_batch": 3.7452145366671294e-06, "add_time_dim_to_batch_and_zero_pad": 1.2738874076880312e-05, "batch_individual_items": 0.032497996934602216, "numpy_to_tensor": 7.002746559736234e-05, "add_observations_from_episodes_to_batch": 0.0008031930114189129}}, "connector_pipeline_timer": 0.08201000217548174}, "num_module_steps_trained_lifetime": 42000, "learner_connector_sum_episodes_length_in": 5000.0, "num_module_steps_trained": 6000, "learner_connector_sum_episodes_length_out": 5250.0, "num_env_steps_trained_lifetime": 220500, "num_non_trainable_parameters": 0, "num_trainable_parameters": 6003, "num_env_steps_trained_lifetime_throughput": 2243836.854121107, "num_module_steps_trained_throughput": 429682.78523980774, "num_module_steps_trained_lifetime_throughput": 428834.59191111795}, "default_policy": {"mean_kl_loss": 0.0023606023751199245, "curr_kl_coeff": 0.0058320024982094765, "module_train_batch_size_mean": 1000.0, "weights_seq_no": 7.0, "default_optimizer_learning_rate": 0.0002847858517, "num_trainable_parameters": 6003, "num_module_steps_trained_lifetime": 42000, "entropy": 0.66071617603302, "curr_entropy_coeff": 0.0090570820258, "num_module_steps_trained": 6000, "policy_loss": 0.03569741174578667, "vf_loss": 0.10278083384037018, "total_loss": 0.09848138689994812, "diff_num_grad_updates_vs_sampler_policy": 1.0, "vf_loss_unclipped": 27.751880645751953, "vf_explained_var": 0.003434121608734131, "gradients_default_optimizer_global_norm": 0.049868904054164886, "num_module_steps_trained_lifetime_throughput": 430755.57208984584}}, "num_training_step_calls_per_iteration": 1, "evaluation": {"env_runners": {"module_to_env_connector": {"timers": {"connectors": {"un_batch_to_individual_items": 5.596115652362289e-06, "get_actions": 3.965081389140226e-05, "tensor_to_numpy": 1.4216947162485786e-05, "listify_data_for_vector_env": 1.1664813149376984e-05, "normalize_and_clip_actions": 9.734027454439327e-06, "remove_single_ts_time_rank_from_batch": 6.104049568833138e-07}}, "connector_pipeline_timer": 0.00010782970581975239}, "env_step_timer": 1.5026949027354838e-05, "env_to_module_connector": {"timers": {"connectors": {"add_observations_from_episodes_to_batch": 2.958153957847913e-06, "add_time_dim_to_batch_and_zero_pad": 2.454743709930416e-06, "batch_individual_items": 6.4594823053522906e-06, "add_states_from_episodes_to_batch": 1.6183721272579178e-06, "numpy_to_tensor": 8.787533700674325e-06}}, "connector_pipeline_timer": 4.426145616178036e-05}, "episode_duration_sec_mean": 0.004854668758343905, "num_episodes": 20, "episode_return_min": -14.5, "agent_episode_returns_mean": {"default_agent": 1.75}, "sample": 0.11355252987541757, "num_agent_steps_sampled_lifetime": {"default_agent": 2800}, "env_to_module_sum_episodes_length_out": 10.368238394572801, "num_env_steps_sampled": 400, "module_episode_returns_mean": {"default_policy": 1.75}, "rlmodule_inference_timer": 2.8768009615535588e-05, "episode_return_max": 14.5, "env_reset_timer": 0.0010221374798925658, "num_agent_steps_sampled": {"default_agent": 400}, "episode_return_mean": 1.75, "num_episodes_lifetime": 140, "weights_seq_no": 7.0, "env_to_module_sum_episodes_length_in": 10.368238394572801, "num_env_steps_sampled_lifetime": 35400, "num_module_steps_sampled": {"default_policy": 400}, "episode_len_max": 20, "episode_len_mean": 20.0, "episode_len_min": 20, "num_module_steps_sampled_lifetime": {"default_policy": 2800}, "time_between_sampling": 1.7717494948115635}, "num_healthy_workers": 1, "actor_manager_num_outstanding_async_reqs": 0, "num_remote_worker_restarts": 0}, "num_env_steps_sampled_lifetime": -3077500.0, "fault_tolerance": {"num_healthy_workers": 0, "num_remote_worker_restarts": 0}, "env_runner_group": {"actor_manager_num_outstanding_async_reqs": 0}, "done": false, "training_iteration": 7, "trial_id": "4d657_00000", "date": "2025-08-11_19-21-05", "timestamp": 1754932865, "time_this_iter_s": 1.7084898948669434, "time_total_s": 13.675792694091797, "pid": 14261, "hostname": "Mac", "node_ip": "127.0.0.1", "config": {"exploration_config": {}, "extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "placement_strategy": "PACK", "num_gpus": 0, "_fake_gpus": false, "num_cpus_for_main_process": 2, "eager_tracing": true, "eager_max_retraces": 20, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "torch_compile_learner": false, "torch_compile_learner_what_to_compile": "forward_train", "torch_compile_learner_dynamo_backend": "aot_eager", "torch_compile_learner_dynamo_mode": null, "torch_compile_worker": false, "torch_compile_worker_dynamo_backend": "aot_eager", "torch_compile_worker_dynamo_mode": null, "torch_ddp_kwargs": {}, "torch_skip_nan_gradients": false, "env": "Umbrella", "env_config": {}, "observation_space": null, "action_space": null, "clip_rewards": null, "normalize_actions": true, "clip_actions": false, "_is_atari": null, "disable_env_checking": false, "render_env": false, "action_mask_key": "action_mask", "env_runner_cls": null, "num_env_runners": 0, "create_local_env_runner": true, "num_envs_per_env_runner": 1, "gym_env_vectorize_mode": "SYNC", "num_cpus_per_env_runner": 1, "num_gpus_per_env_runner": 0, "custom_resources_per_env_runner": {}, "validate_env_runners_after_construction": true, "episodes_to_numpy": true, "max_requests_in_flight_per_env_runner": 1, "sample_timeout_s": 60.0, "_env_to_module_connector": null, "add_default_connectors_to_env_to_module_pipeline": true, "_module_to_env_connector": null, "add_default_connectors_to_module_to_env_pipeline": true, "merge_env_runner_states": "training_only", "broadcast_env_runner_states": true, "episode_lookback_horizon": 1, "rollout_fragment_length": "auto", "batch_mode": "complete_episodes", "compress_observations": false, "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "enable_tf1_exec_eagerly": false, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "preprocessor_pref": "deepmind", "observation_filter": "NoFilter", "update_worker_filter_stats": true, "use_worker_filter_stats": true, "sampler_perf_stats_ema_coef": null, "_is_online": true, "num_learners": 0, "num_gpus_per_learner": 0, "num_cpus_per_learner": "auto", "num_aggregator_actors_per_learner": 0, "max_requests_in_flight_per_aggregator_actor": 3, "local_gpu_idx": 0, "max_requests_in_flight_per_learner": 3, "gamma": 1, "lr": 0.0002847858517, "grad_clip": 0.5, "grad_clip_by": "global_norm", "_train_batch_size_per_learner": 5000, "train_batch_size": 4000, "num_epochs": 1, "minibatch_size": 1000, "shuffle_batch_per_epoch": true, "model": {"fcnet_hiddens": [256, 256], "fcnet_activation": "tanh", "fcnet_weights_initializer": null, "fcnet_weights_initializer_config": null, "fcnet_bias_initializer": null, "fcnet_bias_initializer_config": null, "conv_filters": null, "conv_activation": "relu", "conv_kernel_initializer": null, "conv_kernel_initializer_config": null, "conv_bias_initializer": null, "conv_bias_initializer_config": null, "conv_transpose_kernel_initializer": null, "conv_transpose_kernel_initializer_config": null, "conv_transpose_bias_initializer": null, "conv_transpose_bias_initializer_config": null, "post_fcnet_hiddens": [], "post_fcnet_activation": "relu", "post_fcnet_weights_initializer": null, "post_fcnet_weights_initializer_config": null, "post_fcnet_bias_initializer": null, "post_fcnet_bias_initializer_config": null, "free_log_std": false, "log_std_clip_param": 20.0, "no_final_linear": false, "vf_share_layers": false, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "lstm_weights_initializer": null, "lstm_weights_initializer_config": null, "lstm_bias_initializer": null, "lstm_bias_initializer_config": null, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "attention_use_n_prev_actions": 0, "attention_use_n_prev_rewards": 0, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": null, "custom_model_config": {}, "custom_action_dist": null, "custom_preprocessor": null, "encoder_latent_dim": null, "always_check_shapes": false, "lstm_use_prev_action_reward": -1, "_use_default_native_models": -1, "_disable_preprocessor_api": false, "_disable_action_flattening": false}, "_learner_connector": null, "add_default_connectors_to_learner_pipeline": true, "learner_config_dict": {}, "optimizer": {}, "_learner_class": null, "callbacks_on_algorithm_init": null, "callbacks_on_env_runners_recreated": null, "callbacks_on_offline_eval_runners_recreated": null, "callbacks_on_checkpoint_loaded": null, "callbacks_on_environment_created": null, "callbacks_on_episode_created": null, "callbacks_on_episode_start": null, "callbacks_on_episode_step": null, "callbacks_on_episode_end": null, "callbacks_on_evaluate_start": null, "callbacks_on_evaluate_end": null, "callbacks_on_evaluate_offline_start": null, "callbacks_on_evaluate_offline_end": null, "callbacks_on_sample_end": null, "callbacks_on_train_result": null, "explore": true, "enable_rl_module_and_learner": true, "enable_env_runner_and_connector_v2": true, "_prior_exploration_config": {"type": "StochasticSampling"}, "count_steps_by": "env_steps", "policy_map_capacity": 100, "policy_mapping_fn": "<function AlgorithmConfig.DEFAULT_POLICY_MAPPING_FN at 0x1680e9b20>", "policies_to_train": null, "policy_states_are_swappable": false, "observation_fn": null, "offline_data_class": null, "input_read_method": "read_parquet", "input_read_method_kwargs": {}, "input_read_schema": {}, "input_read_episodes": false, "input_read_sample_batches": false, "input_read_batch_size": null, "input_filesystem": null, "input_filesystem_kwargs": {}, "input_compress_columns": ["obs", "new_obs"], "input_spaces_jsonable": true, "materialize_data": false, "materialize_mapped_data": true, "map_batches_kwargs": {}, "iter_batches_kwargs": {}, "ignore_final_observation": false, "prelearner_class": null, "prelearner_buffer_class": null, "prelearner_buffer_kwargs": {}, "prelearner_module_synch_period": 10, "dataset_num_iters_per_learner": null, "input_config": {}, "actions_in_input_normalized": false, "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_config": {}, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "output_max_rows_per_file": null, "output_write_remaining_data": false, "output_write_method": "write_parquet", "output_write_method_kwargs": {}, "output_filesystem": null, "output_filesystem_kwargs": {}, "output_write_episodes": true, "offline_sampling": false, "evaluation_interval": 1, "evaluation_duration": 20, "evaluation_duration_unit": "episodes", "evaluation_sample_timeout_s": 120.0, "evaluation_auto_duration_min_env_steps_per_sample": 100, "evaluation_auto_duration_max_env_steps_per_sample": 2000, "evaluation_parallel_to_training": false, "evaluation_force_reset_envs_before_iteration": true, "evaluation_config": null, "off_policy_estimation_methods": {}, "ope_split_batch_by_episode": true, "evaluation_num_env_runners": 1, "in_evaluation": false, "sync_filters_on_rollout_workers_timeout_s": 10.0, "offline_evaluation_interval": null, "num_offline_eval_runners": 0, "offline_loss_for_module_fn": null, "offline_evaluation_duration": 1, "offline_evaluation_parallel_to_training": false, "offline_evaluation_timeout_s": 120.0, "num_cpus_per_offline_eval_runner": 1, "num_gpus_per_offline_eval_runner": 0, "custom_resources_per_offline_eval_runner": {}, "restart_failed_offline_eval_runners": true, "ignore_offline_eval_runner_failures": false, "max_num_offline_eval_runner_restarts": 1000, "offline_eval_runner_restore_timeout_s": 1800.0, "max_requests_in_flight_per_offline_eval_runner": 1, "validate_offline_eval_runners_after_construction": true, "offline_eval_runner_health_probe_timeout_s": 30.0, "offline_eval_rl_module_inference_only": false, "broadcast_offline_eval_runner_states": false, "offline_eval_batch_size_per_runner": 256, "dataset_num_iters_per_eval_runner": 1, "keep_per_episode_custom_metrics": false, "metrics_episode_collection_timeout_s": 60.0, "metrics_num_episodes_for_smoothing": 100, "min_time_s_per_iteration": null, "min_train_timesteps_per_iteration": 0, "min_sample_timesteps_per_iteration": 0, "log_gradients": true, "export_native_model_files": false, "checkpoint_trainable_policies_only": false, "logger_creator": null, "logger_config": null, "log_level": "WARN", "log_sys_usage": true, "fake_sampler": false, "seed": 8, "restart_failed_env_runners": true, "ignore_env_runner_failures": false, "max_num_env_runner_restarts": 1000, "delay_between_env_runner_restarts_s": 60.0, "restart_failed_sub_environments": false, "num_consecutive_env_runner_failures_tolerance": 100, "env_runner_health_probe_timeout_s": 30.0, "env_runner_restore_timeout_s": 1800.0, "_model_config": {}, "_rl_module_spec": "RLModuleSpec(module_class=None, observation_space=None, action_space=None, inference_only=False, learner_only=False, model_config=DefaultModelConfig(fcnet_hiddens=[60, 90], fcnet_activation='tanh', fcnet_kernel_initializer=None, fcnet_kernel_initializer_kwargs=None, fcnet_bias_initializer=None, fcnet_bias_initializer_kwargs=None, conv_filters=None, conv_activation='relu', conv_kernel_initializer=None, conv_kernel_initializer_kwargs=None, conv_bias_initializer=None, conv_bias_initializer_kwargs=None, head_fcnet_hiddens=[], head_fcnet_activation='relu', head_fcnet_kernel_initializer=None, head_fcnet_kernel_initializer_kwargs=None, head_fcnet_bias_initializer=None, head_fcnet_bias_initializer_kwargs=None, free_log_std=False, log_std_clip_param=20.0, vf_share_layers=True, use_lstm=False, max_seq_len=20, lstm_cell_size=256, lstm_use_prev_action=False, lstm_use_prev_reward=False, lstm_kernel_initializer=None, lstm_kernel_initializer_kwargs=None, lstm_bias_initializer=None, lstm_bias_initializer_kwargs=None), catalog_class=None, load_state_path=None, model_config_dict=None)", "algorithm_config_overrides_per_module": {}, "_per_module_overrides": {}, "_validate_config": true, "_use_msgpack_checkpoints": false, "_torch_grad_scaler_class": null, "_torch_lr_scheduler_classes": null, "_tf_policy_handles_more_than_one_loss": false, "_disable_preprocessor_api": false, "_disable_action_flattening": false, "_disable_initialize_loss_from_dummy_batch": false, "_dont_auto_sync_env_runner_states": false, "env_task_fn": -1, "enable_connectors": -1, "simple_optimizer": false, "policy_map_cache": -1, "worker_cls": -1, "synchronize_filters": -1, "enable_async_evaluation": -1, "custom_async_evaluation_function": -1, "_enable_rl_module_api": -1, "auto_wrap_old_gym_envs": -1, "always_attach_evaluation_results": -1, "replay_sequence_length": null, "_disable_execution_plan_api": -1, "use_critic": true, "use_gae": true, "use_kl_loss": true, "kl_coeff": 0.7464963036515, "kl_target": 0.0270990929592, "vf_loss_coeff": 0.6688075857018, "entropy_coeff": 0.0090570820258, "clip_param": 0.1221781641624, "vf_clip_param": 0.1027808522125, "entropy_coeff_schedule": null, "lr_schedule": null, "sgd_minibatch_size": -1, "vf_share_layers": -1, "__stdout_file__": null, "__stderr_file__": null, "lambda": 0.9099046732075, "input": "sampler", "policies": {"default_policy": [null, null, null, null]}, "callbacks": "<class 'ray.rllib.callbacks.callbacks.RLlibCallback'>", "create_env_on_driver": false, "custom_eval_function": null, "framework": "torch"}, "time_since_restore": 13.675792694091797, "iterations_since_restore": 7, "perf": {"cpu_util_percent": 51.300000000000004, "ram_util_percent": 83.73333333333333}}
{"timers": {"training_iteration": 2.2985709603476114, "restore_env_runners": 1.4606514575431963e-05, "training_step": 2.298418306439971, "env_runner_sampling_timer": 2.1864783860648194, "learner_update_timer": 0.10854158677334029, "synch_weights": 0.00076113671094287, "restore_eval_env_runners": 1.1999019421479126e-05, "evaluation_iteration": 0.1283093175318621, "synch_eval_env_connectors": 0.00013700118627399722, "synch_env_connectors": 4.796000832578307e-06}, "env_runners": {"sample": 0.005822990711055692, "module_episode_returns_mean": {"default_policy": 1.8600000000000003}, "env_to_module_connector": {"timers": {"connectors": {"add_states_from_episodes_to_batch": 1.7895320435576232e-06, "numpy_to_tensor": 9.238100636972011e-06, "add_observations_from_episodes_to_batch": 3.2317931411852615e-06, "add_time_dim_to_batch_and_zero_pad": 2.5394019617939003e-06, "batch_individual_items": 6.787090584556012e-06}}, "connector_pipeline_timer": 4.633493869494837e-05}, "env_reset_timer": 4.653829906453855e-05, "module_to_env_connector": {"timers": {"connectors": {"tensor_to_numpy": 1.4007178386645651e-05, "normalize_and_clip_actions": 1.006843097638932e-05, "listify_data_for_vector_env": 1.1824818929718667e-05, "remove_single_ts_time_rank_from_batch": 6.015468754114975e-07, "un_batch_to_individual_items": 5.792333464261476e-06, "get_actions": 4.119707395108807e-05}}, "connector_pipeline_timer": 0.00011038371265084059}, "num_module_steps_sampled": {"default_policy": 5000.0}, "weights_seq_no": 7.0, "agent_episode_returns_mean": {"default_agent": 1.8600000000000003}, "env_to_module_sum_episodes_length_out": 10.36823839457432, "env_step_timer": 1.5263444596294617e-05, "num_env_steps_sampled": 5000.0, "episode_return_mean": 1.8600000000000003, "num_episodes_lifetime": -184750.0, "num_module_steps_sampled_lifetime": {"default_policy": -3695000.0}, "time_between_sampling": 0.0017094036376470684, "env_to_module_sum_episodes_length_in": 10.36823839457432, "rlmodule_inference_timer": 5.951894791302642e-05, "episode_duration_sec_mean": 0.005506533805280923, "num_env_steps_sampled_lifetime": -3695000.0, "episode_len_max": 20, "episode_len_mean": 20.0, "num_episodes": 250.0, "episode_return_max": 8.5, "num_agent_steps_sampled": {"default_agent": 5000.0}, "episode_len_min": 20, "episode_return_min": -11.5, "num_agent_steps_sampled_lifetime": {"default_agent": -3695000.0}, "num_env_steps_sampled_lifetime_throughput": 3509.7950787663767}, "learners": {"__all_modules__": {"num_env_steps_trained": 31500, "learner_connector": {"timers": {"connectors": {"add_one_ts_to_episodes_and_truncate": 0.007701549406075542, "add_columns_from_episodes_to_train_batch": 0.034465694532524536, "general_advantage_estimation": 0.006544412280110506, "add_states_from_episodes_to_batch": 3.7456823540791456e-06, "add_time_dim_to_batch_and_zero_pad": 1.2810235394300543e-05, "batch_individual_items": 0.032553119874659114, "numpy_to_tensor": 7.0131770990978e-05, "add_observations_from_episodes_to_batch": 0.0008081119121647872}}, "connector_pipeline_timer": 0.08229648006281282}, "num_module_steps_trained_lifetime": 48000, "learner_connector_sum_episodes_length_in": 5000.0, "num_module_steps_trained": 6000, "learner_connector_sum_episodes_length_out": 5250.0, "num_env_steps_trained_lifetime": 252000, "num_non_trainable_parameters": 0, "num_trainable_parameters": 6003, "num_env_steps_trained_lifetime_throughput": 2227773.2599646156, "num_module_steps_trained_throughput": 426531.4402932546, "num_module_steps_trained_lifetime_throughput": 425714.05731287115}, "default_policy": {"mean_kl_loss": 0.002607794012874365, "curr_kl_coeff": 0.0029160012491047382, "module_train_batch_size_mean": 1000.0, "weights_seq_no": 8.0, "default_optimizer_learning_rate": 0.0002847858517, "num_trainable_parameters": 6003, "num_module_steps_trained_lifetime": 48000, "entropy": 0.6383119821548462, "curr_entropy_coeff": 0.0090570820258, "num_module_steps_trained": 6000, "policy_loss": -0.15572355687618256, "vf_loss": 0.10278083384037018, "total_loss": -0.0927489772439003, "diff_num_grad_updates_vs_sampler_policy": 1.0, "vf_loss_unclipped": 27.20172691345215, "vf_explained_var": 0.002962470054626465, "gradients_default_optimizer_global_norm": 0.022608157247304916, "num_module_steps_trained_lifetime_throughput": 427530.52309967263}}, "num_training_step_calls_per_iteration": 1, "evaluation": {"env_runners": {"module_to_env_connector": {"timers": {"connectors": {"un_batch_to_individual_items": 5.701504148615273e-06, "get_actions": 3.881208542712805e-05, "tensor_to_numpy": 1.4158244553346472e-05, "listify_data_for_vector_env": 1.1271375462025524e-05, "normalize_and_clip_actions": 9.712505493876147e-06, "remove_single_ts_time_rank_from_batch": 5.945747236516895e-07}}, "connector_pipeline_timer": 0.0001064515641542162}, "env_step_timer": 1.4860937872107604e-05, "env_to_module_connector": {"timers": {"connectors": {"add_observations_from_episodes_to_batch": 2.876496651953145e-06, "add_time_dim_to_batch_and_zero_pad": 2.3499127625000176e-06, "batch_individual_items": 6.602024464366356e-06, "add_states_from_episodes_to_batch": 1.6583316740022506e-06, "numpy_to_tensor": 8.627870672857844e-06}}, "connector_pipeline_timer": 4.3744178815272675e-05}, "episode_duration_sec_mean": 0.004803349586436525, "num_episodes": 20, "episode_return_min": -14.5, "agent_episode_returns_mean": {"default_agent": 2.15}, "sample": 0.11341382541601816, "num_agent_steps_sampled_lifetime": {"default_agent": 3200}, "env_to_module_sum_episodes_length_out": 10.3682383945743, "num_env_steps_sampled": 400, "module_episode_returns_mean": {"default_policy": 2.15}, "rlmodule_inference_timer": 2.9528394607981856e-05, "episode_return_max": 14.5, "env_reset_timer": 0.001013232775189188, "num_agent_steps_sampled": {"default_agent": 400}, "episode_return_mean": 2.15, "num_episodes_lifetime": 160, "weights_seq_no": 8.0, "env_to_module_sum_episodes_length_in": 10.3682383945743, "num_env_steps_sampled_lifetime": 40400, "num_module_steps_sampled": {"default_policy": 400}, "episode_len_max": 20, "episode_len_mean": 20.0, "episode_len_min": 20, "num_module_steps_sampled_lifetime": {"default_policy": 3200}, "time_between_sampling": 1.771991767783413}, "num_healthy_workers": 1, "actor_manager_num_outstanding_async_reqs": 0, "num_remote_worker_restarts": 0}, "num_env_steps_sampled_lifetime": -3695000.0, "fault_tolerance": {"num_healthy_workers": 0, "num_remote_worker_restarts": 0}, "env_runner_group": {"actor_manager_num_outstanding_async_reqs": 0}, "done": false, "training_iteration": 8, "trial_id": "4d657_00000", "date": "2025-08-11_19-21-07", "timestamp": 1754932867, "time_this_iter_s": 1.8834240436553955, "time_total_s": 15.559216737747192, "pid": 14261, "hostname": "Mac", "node_ip": "127.0.0.1", "config": {"exploration_config": {}, "extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "placement_strategy": "PACK", "num_gpus": 0, "_fake_gpus": false, "num_cpus_for_main_process": 2, "eager_tracing": true, "eager_max_retraces": 20, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "torch_compile_learner": false, "torch_compile_learner_what_to_compile": "forward_train", "torch_compile_learner_dynamo_backend": "aot_eager", "torch_compile_learner_dynamo_mode": null, "torch_compile_worker": false, "torch_compile_worker_dynamo_backend": "aot_eager", "torch_compile_worker_dynamo_mode": null, "torch_ddp_kwargs": {}, "torch_skip_nan_gradients": false, "env": "Umbrella", "env_config": {}, "observation_space": null, "action_space": null, "clip_rewards": null, "normalize_actions": true, "clip_actions": false, "_is_atari": null, "disable_env_checking": false, "render_env": false, "action_mask_key": "action_mask", "env_runner_cls": null, "num_env_runners": 0, "create_local_env_runner": true, "num_envs_per_env_runner": 1, "gym_env_vectorize_mode": "SYNC", "num_cpus_per_env_runner": 1, "num_gpus_per_env_runner": 0, "custom_resources_per_env_runner": {}, "validate_env_runners_after_construction": true, "episodes_to_numpy": true, "max_requests_in_flight_per_env_runner": 1, "sample_timeout_s": 60.0, "_env_to_module_connector": null, "add_default_connectors_to_env_to_module_pipeline": true, "_module_to_env_connector": null, "add_default_connectors_to_module_to_env_pipeline": true, "merge_env_runner_states": "training_only", "broadcast_env_runner_states": true, "episode_lookback_horizon": 1, "rollout_fragment_length": "auto", "batch_mode": "complete_episodes", "compress_observations": false, "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "enable_tf1_exec_eagerly": false, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "preprocessor_pref": "deepmind", "observation_filter": "NoFilter", "update_worker_filter_stats": true, "use_worker_filter_stats": true, "sampler_perf_stats_ema_coef": null, "_is_online": true, "num_learners": 0, "num_gpus_per_learner": 0, "num_cpus_per_learner": "auto", "num_aggregator_actors_per_learner": 0, "max_requests_in_flight_per_aggregator_actor": 3, "local_gpu_idx": 0, "max_requests_in_flight_per_learner": 3, "gamma": 1, "lr": 0.0002847858517, "grad_clip": 0.5, "grad_clip_by": "global_norm", "_train_batch_size_per_learner": 5000, "train_batch_size": 4000, "num_epochs": 1, "minibatch_size": 1000, "shuffle_batch_per_epoch": true, "model": {"fcnet_hiddens": [256, 256], "fcnet_activation": "tanh", "fcnet_weights_initializer": null, "fcnet_weights_initializer_config": null, "fcnet_bias_initializer": null, "fcnet_bias_initializer_config": null, "conv_filters": null, "conv_activation": "relu", "conv_kernel_initializer": null, "conv_kernel_initializer_config": null, "conv_bias_initializer": null, "conv_bias_initializer_config": null, "conv_transpose_kernel_initializer": null, "conv_transpose_kernel_initializer_config": null, "conv_transpose_bias_initializer": null, "conv_transpose_bias_initializer_config": null, "post_fcnet_hiddens": [], "post_fcnet_activation": "relu", "post_fcnet_weights_initializer": null, "post_fcnet_weights_initializer_config": null, "post_fcnet_bias_initializer": null, "post_fcnet_bias_initializer_config": null, "free_log_std": false, "log_std_clip_param": 20.0, "no_final_linear": false, "vf_share_layers": false, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "lstm_weights_initializer": null, "lstm_weights_initializer_config": null, "lstm_bias_initializer": null, "lstm_bias_initializer_config": null, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "attention_use_n_prev_actions": 0, "attention_use_n_prev_rewards": 0, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": null, "custom_model_config": {}, "custom_action_dist": null, "custom_preprocessor": null, "encoder_latent_dim": null, "always_check_shapes": false, "lstm_use_prev_action_reward": -1, "_use_default_native_models": -1, "_disable_preprocessor_api": false, "_disable_action_flattening": false}, "_learner_connector": null, "add_default_connectors_to_learner_pipeline": true, "learner_config_dict": {}, "optimizer": {}, "_learner_class": null, "callbacks_on_algorithm_init": null, "callbacks_on_env_runners_recreated": null, "callbacks_on_offline_eval_runners_recreated": null, "callbacks_on_checkpoint_loaded": null, "callbacks_on_environment_created": null, "callbacks_on_episode_created": null, "callbacks_on_episode_start": null, "callbacks_on_episode_step": null, "callbacks_on_episode_end": null, "callbacks_on_evaluate_start": null, "callbacks_on_evaluate_end": null, "callbacks_on_evaluate_offline_start": null, "callbacks_on_evaluate_offline_end": null, "callbacks_on_sample_end": null, "callbacks_on_train_result": null, "explore": true, "enable_rl_module_and_learner": true, "enable_env_runner_and_connector_v2": true, "_prior_exploration_config": {"type": "StochasticSampling"}, "count_steps_by": "env_steps", "policy_map_capacity": 100, "policy_mapping_fn": "<function AlgorithmConfig.DEFAULT_POLICY_MAPPING_FN at 0x1680e9b20>", "policies_to_train": null, "policy_states_are_swappable": false, "observation_fn": null, "offline_data_class": null, "input_read_method": "read_parquet", "input_read_method_kwargs": {}, "input_read_schema": {}, "input_read_episodes": false, "input_read_sample_batches": false, "input_read_batch_size": null, "input_filesystem": null, "input_filesystem_kwargs": {}, "input_compress_columns": ["obs", "new_obs"], "input_spaces_jsonable": true, "materialize_data": false, "materialize_mapped_data": true, "map_batches_kwargs": {}, "iter_batches_kwargs": {}, "ignore_final_observation": false, "prelearner_class": null, "prelearner_buffer_class": null, "prelearner_buffer_kwargs": {}, "prelearner_module_synch_period": 10, "dataset_num_iters_per_learner": null, "input_config": {}, "actions_in_input_normalized": false, "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_config": {}, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "output_max_rows_per_file": null, "output_write_remaining_data": false, "output_write_method": "write_parquet", "output_write_method_kwargs": {}, "output_filesystem": null, "output_filesystem_kwargs": {}, "output_write_episodes": true, "offline_sampling": false, "evaluation_interval": 1, "evaluation_duration": 20, "evaluation_duration_unit": "episodes", "evaluation_sample_timeout_s": 120.0, "evaluation_auto_duration_min_env_steps_per_sample": 100, "evaluation_auto_duration_max_env_steps_per_sample": 2000, "evaluation_parallel_to_training": false, "evaluation_force_reset_envs_before_iteration": true, "evaluation_config": null, "off_policy_estimation_methods": {}, "ope_split_batch_by_episode": true, "evaluation_num_env_runners": 1, "in_evaluation": false, "sync_filters_on_rollout_workers_timeout_s": 10.0, "offline_evaluation_interval": null, "num_offline_eval_runners": 0, "offline_loss_for_module_fn": null, "offline_evaluation_duration": 1, "offline_evaluation_parallel_to_training": false, "offline_evaluation_timeout_s": 120.0, "num_cpus_per_offline_eval_runner": 1, "num_gpus_per_offline_eval_runner": 0, "custom_resources_per_offline_eval_runner": {}, "restart_failed_offline_eval_runners": true, "ignore_offline_eval_runner_failures": false, "max_num_offline_eval_runner_restarts": 1000, "offline_eval_runner_restore_timeout_s": 1800.0, "max_requests_in_flight_per_offline_eval_runner": 1, "validate_offline_eval_runners_after_construction": true, "offline_eval_runner_health_probe_timeout_s": 30.0, "offline_eval_rl_module_inference_only": false, "broadcast_offline_eval_runner_states": false, "offline_eval_batch_size_per_runner": 256, "dataset_num_iters_per_eval_runner": 1, "keep_per_episode_custom_metrics": false, "metrics_episode_collection_timeout_s": 60.0, "metrics_num_episodes_for_smoothing": 100, "min_time_s_per_iteration": null, "min_train_timesteps_per_iteration": 0, "min_sample_timesteps_per_iteration": 0, "log_gradients": true, "export_native_model_files": false, "checkpoint_trainable_policies_only": false, "logger_creator": null, "logger_config": null, "log_level": "WARN", "log_sys_usage": true, "fake_sampler": false, "seed": 8, "restart_failed_env_runners": true, "ignore_env_runner_failures": false, "max_num_env_runner_restarts": 1000, "delay_between_env_runner_restarts_s": 60.0, "restart_failed_sub_environments": false, "num_consecutive_env_runner_failures_tolerance": 100, "env_runner_health_probe_timeout_s": 30.0, "env_runner_restore_timeout_s": 1800.0, "_model_config": {}, "_rl_module_spec": "RLModuleSpec(module_class=None, observation_space=None, action_space=None, inference_only=False, learner_only=False, model_config=DefaultModelConfig(fcnet_hiddens=[60, 90], fcnet_activation='tanh', fcnet_kernel_initializer=None, fcnet_kernel_initializer_kwargs=None, fcnet_bias_initializer=None, fcnet_bias_initializer_kwargs=None, conv_filters=None, conv_activation='relu', conv_kernel_initializer=None, conv_kernel_initializer_kwargs=None, conv_bias_initializer=None, conv_bias_initializer_kwargs=None, head_fcnet_hiddens=[], head_fcnet_activation='relu', head_fcnet_kernel_initializer=None, head_fcnet_kernel_initializer_kwargs=None, head_fcnet_bias_initializer=None, head_fcnet_bias_initializer_kwargs=None, free_log_std=False, log_std_clip_param=20.0, vf_share_layers=True, use_lstm=False, max_seq_len=20, lstm_cell_size=256, lstm_use_prev_action=False, lstm_use_prev_reward=False, lstm_kernel_initializer=None, lstm_kernel_initializer_kwargs=None, lstm_bias_initializer=None, lstm_bias_initializer_kwargs=None), catalog_class=None, load_state_path=None, model_config_dict=None)", "algorithm_config_overrides_per_module": {}, "_per_module_overrides": {}, "_validate_config": true, "_use_msgpack_checkpoints": false, "_torch_grad_scaler_class": null, "_torch_lr_scheduler_classes": null, "_tf_policy_handles_more_than_one_loss": false, "_disable_preprocessor_api": false, "_disable_action_flattening": false, "_disable_initialize_loss_from_dummy_batch": false, "_dont_auto_sync_env_runner_states": false, "env_task_fn": -1, "enable_connectors": -1, "simple_optimizer": false, "policy_map_cache": -1, "worker_cls": -1, "synchronize_filters": -1, "enable_async_evaluation": -1, "custom_async_evaluation_function": -1, "_enable_rl_module_api": -1, "auto_wrap_old_gym_envs": -1, "always_attach_evaluation_results": -1, "replay_sequence_length": null, "_disable_execution_plan_api": -1, "use_critic": true, "use_gae": true, "use_kl_loss": true, "kl_coeff": 0.7464963036515, "kl_target": 0.0270990929592, "vf_loss_coeff": 0.6688075857018, "entropy_coeff": 0.0090570820258, "clip_param": 0.1221781641624, "vf_clip_param": 0.1027808522125, "entropy_coeff_schedule": null, "lr_schedule": null, "sgd_minibatch_size": -1, "vf_share_layers": -1, "__stdout_file__": null, "__stderr_file__": null, "lambda": 0.9099046732075, "input": "sampler", "policies": {"default_policy": [null, null, null, null]}, "callbacks": "<class 'ray.rllib.callbacks.callbacks.RLlibCallback'>", "create_env_on_driver": false, "custom_eval_function": null, "framework": "torch"}, "time_since_restore": 15.559216737747192, "iterations_since_restore": 8, "perf": {"cpu_util_percent": 50.36666666666667, "ram_util_percent": 83.53333333333335}}
{"timers": {"training_iteration": 2.2919497403248728, "restore_env_runners": 1.453878995634786e-05, "training_step": 2.2917966675456865, "env_runner_sampling_timer": 2.178884509703766, "learner_update_timer": 0.1095106950653643, "synch_weights": 0.0007605603438503542, "restore_eval_env_runners": 1.1964028710343052e-05, "evaluation_iteration": 0.128090856016081, "synch_eval_env_connectors": 0.0001368524235241166, "synch_env_connectors": 4.79971060069219e-06}, "env_runners": {"sample": 0.005169464763367321, "module_episode_returns_mean": {"default_policy": 3.4599999999999995}, "env_to_module_connector": {"timers": {"connectors": {"add_states_from_episodes_to_batch": 1.7477019097569341e-06, "numpy_to_tensor": 8.826650075077117e-06, "add_observations_from_episodes_to_batch": 3.0310631432668695e-06, "add_time_dim_to_batch_and_zero_pad": 2.4283877842093633e-06, "batch_individual_items": 6.536716373821798e-06}}, "connector_pipeline_timer": 4.457103302566108e-05}, "env_reset_timer": 3.9382100465420823e-05, "module_to_env_connector": {"timers": {"connectors": {"tensor_to_numpy": 1.3417274022377602e-05, "normalize_and_clip_actions": 9.737157681020798e-06, "listify_data_for_vector_env": 1.1527812392437626e-05, "remove_single_ts_time_rank_from_batch": 5.891293563480636e-07, "un_batch_to_individual_items": 5.58285134241728e-06, "get_actions": 4.002065637139307e-05}}, "connector_pipeline_timer": 0.00010714529923203908}, "num_module_steps_sampled": {"default_policy": 5000.0}, "weights_seq_no": 8.0, "agent_episode_returns_mean": {"default_agent": 3.4599999999999995}, "env_to_module_sum_episodes_length_out": 10.36823839457432, "env_step_timer": 1.444219277645392e-05, "num_env_steps_sampled": 5000.0, "episode_return_mean": 3.4599999999999995, "num_episodes_lifetime": -215625.0, "num_module_steps_sampled_lifetime": {"default_policy": -4312500.0}, "time_between_sampling": 0.0017284199510456384, "env_to_module_sum_episodes_length_in": 10.36823839457432, "rlmodule_inference_timer": 2.8402877433768207e-05, "episode_duration_sec_mean": 0.004684280489105732, "num_env_steps_sampled_lifetime": -4312500.0, "episode_len_max": 20, "episode_len_mean": 20.0, "num_episodes": 250.0, "episode_return_max": 8.5, "num_agent_steps_sampled": {"default_agent": 5000.0}, "episode_len_min": 20, "episode_return_min": -11.5, "num_agent_steps_sampled_lifetime": {"default_agent": -4312500.0}, "num_env_steps_sampled_lifetime_throughput": 3630.1182026867473}, "learners": {"__all_modules__": {"num_env_steps_trained": 31500, "learner_connector": {"timers": {"connectors": {"add_one_ts_to_episodes_and_truncate": 0.008722759751683672, "add_columns_from_episodes_to_train_batch": 0.03446032924638309, "general_advantage_estimation": 0.006546764817896593, "add_states_from_episodes_to_batch": 3.7373864045027833e-06, "add_time_dim_to_batch_and_zero_pad": 1.2768803083304473e-05, "batch_individual_items": 0.03254491825634246, "numpy_to_tensor": 7.00571227792287e-05, "add_observations_from_episodes_to_batch": 0.0008084787130153803}}, "connector_pipeline_timer": 0.08330636317288505}, "num_module_steps_trained_lifetime": 54000, "learner_connector_sum_episodes_length_in": 5000.0, "num_module_steps_trained": 6000, "learner_connector_sum_episodes_length_out": 5250.0, "num_env_steps_trained_lifetime": 283500, "num_non_trainable_parameters": 0, "num_trainable_parameters": 6003, "num_env_steps_trained_lifetime_throughput": 2206326.0780870323, "num_module_steps_trained_throughput": 422356.34792238416, "num_module_steps_trained_lifetime_throughput": 421568.5096060042}, "default_policy": {"mean_kl_loss": 0.002018766012042761, "curr_kl_coeff": 0.0014580006245523691, "module_train_batch_size_mean": 1000.0, "weights_seq_no": 9.0, "default_optimizer_learning_rate": 0.0002847858517, "num_trainable_parameters": 6003, "num_module_steps_trained_lifetime": 54000, "entropy": 0.6128119826316833, "curr_entropy_coeff": 0.0090570820258, "num_module_steps_trained": 6000, "policy_loss": -0.11399688571691513, "vf_loss": 0.10278083384037018, "total_loss": -0.050800688564777374, "diff_num_grad_updates_vs_sampler_policy": 1.0, "vf_loss_unclipped": 26.992969512939453, "vf_explained_var": 0.002911388874053955, "gradients_default_optimizer_global_norm": 0.027868833392858505, "num_module_steps_trained_lifetime_throughput": 423293.9940102869}}, "num_training_step_calls_per_iteration": 1, "evaluation": {"env_runners": {"module_to_env_connector": {"timers": {"connectors": {"un_batch_to_individual_items": 5.290720542066715e-06, "get_actions": 3.6451730018682014e-05, "tensor_to_numpy": 1.3021589279791627e-05, "listify_data_for_vector_env": 1.0817118966237853e-05, "normalize_and_clip_actions": 9.3152529614694e-06, "remove_single_ts_time_rank_from_batch": 5.695233381125206e-07}}, "connector_pipeline_timer": 0.00010064695521687744}, "env_step_timer": 1.37508587805193e-05, "env_to_module_connector": {"timers": {"connectors": {"add_observations_from_episodes_to_batch": 2.7943157338518702e-06, "add_time_dim_to_batch_and_zero_pad": 2.315752447782774e-06, "batch_individual_items": 6.1089817487047405e-06, "add_states_from_episodes_to_batch": 1.612832929612816e-06, "numpy_to_tensor": 8.25248699701774e-06}}, "connector_pipeline_timer": 4.219042364670102e-05}, "episode_duration_sec_mean": 0.004765587478177622, "num_episodes": 20, "episode_return_min": -14.5, "agent_episode_returns_mean": {"default_agent": 1.15}, "sample": 0.1132938892418265, "num_agent_steps_sampled_lifetime": {"default_agent": 3600}, "env_to_module_sum_episodes_length_out": 10.368238394574323, "num_env_steps_sampled": 400, "module_episode_returns_mean": {"default_policy": 1.15}, "rlmodule_inference_timer": 2.7216539377018677e-05, "episode_return_max": 14.5, "env_reset_timer": 0.001005850447422395, "num_agent_steps_sampled": {"default_agent": 400}, "episode_return_mean": 1.15, "num_episodes_lifetime": 180, "weights_seq_no": 9.0, "env_to_module_sum_episodes_length_in": 10.368238394574323, "num_env_steps_sampled_lifetime": 45400, "num_module_steps_sampled": {"default_policy": 400}, "episode_len_max": 20, "episode_len_mean": 20.0, "episode_len_min": 20, "num_module_steps_sampled_lifetime": {"default_policy": 3600}, "time_between_sampling": 1.7709682121865626}, "num_healthy_workers": 1, "actor_manager_num_outstanding_async_reqs": 0, "num_remote_worker_restarts": 0}, "num_env_steps_sampled_lifetime": -4312500.0, "fault_tolerance": {"num_healthy_workers": 0, "num_remote_worker_restarts": 0}, "env_runner_group": {"actor_manager_num_outstanding_async_reqs": 0}, "done": false, "training_iteration": 9, "trial_id": "4d657_00000", "date": "2025-08-11_19-21-08", "timestamp": 1754932868, "time_this_iter_s": 1.749176025390625, "time_total_s": 17.308392763137817, "pid": 14261, "hostname": "Mac", "node_ip": "127.0.0.1", "config": {"exploration_config": {}, "extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "placement_strategy": "PACK", "num_gpus": 0, "_fake_gpus": false, "num_cpus_for_main_process": 2, "eager_tracing": true, "eager_max_retraces": 20, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "torch_compile_learner": false, "torch_compile_learner_what_to_compile": "forward_train", "torch_compile_learner_dynamo_backend": "aot_eager", "torch_compile_learner_dynamo_mode": null, "torch_compile_worker": false, "torch_compile_worker_dynamo_backend": "aot_eager", "torch_compile_worker_dynamo_mode": null, "torch_ddp_kwargs": {}, "torch_skip_nan_gradients": false, "env": "Umbrella", "env_config": {}, "observation_space": null, "action_space": null, "clip_rewards": null, "normalize_actions": true, "clip_actions": false, "_is_atari": null, "disable_env_checking": false, "render_env": false, "action_mask_key": "action_mask", "env_runner_cls": null, "num_env_runners": 0, "create_local_env_runner": true, "num_envs_per_env_runner": 1, "gym_env_vectorize_mode": "SYNC", "num_cpus_per_env_runner": 1, "num_gpus_per_env_runner": 0, "custom_resources_per_env_runner": {}, "validate_env_runners_after_construction": true, "episodes_to_numpy": true, "max_requests_in_flight_per_env_runner": 1, "sample_timeout_s": 60.0, "_env_to_module_connector": null, "add_default_connectors_to_env_to_module_pipeline": true, "_module_to_env_connector": null, "add_default_connectors_to_module_to_env_pipeline": true, "merge_env_runner_states": "training_only", "broadcast_env_runner_states": true, "episode_lookback_horizon": 1, "rollout_fragment_length": "auto", "batch_mode": "complete_episodes", "compress_observations": false, "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "enable_tf1_exec_eagerly": false, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "preprocessor_pref": "deepmind", "observation_filter": "NoFilter", "update_worker_filter_stats": true, "use_worker_filter_stats": true, "sampler_perf_stats_ema_coef": null, "_is_online": true, "num_learners": 0, "num_gpus_per_learner": 0, "num_cpus_per_learner": "auto", "num_aggregator_actors_per_learner": 0, "max_requests_in_flight_per_aggregator_actor": 3, "local_gpu_idx": 0, "max_requests_in_flight_per_learner": 3, "gamma": 1, "lr": 0.0002847858517, "grad_clip": 0.5, "grad_clip_by": "global_norm", "_train_batch_size_per_learner": 5000, "train_batch_size": 4000, "num_epochs": 1, "minibatch_size": 1000, "shuffle_batch_per_epoch": true, "model": {"fcnet_hiddens": [256, 256], "fcnet_activation": "tanh", "fcnet_weights_initializer": null, "fcnet_weights_initializer_config": null, "fcnet_bias_initializer": null, "fcnet_bias_initializer_config": null, "conv_filters": null, "conv_activation": "relu", "conv_kernel_initializer": null, "conv_kernel_initializer_config": null, "conv_bias_initializer": null, "conv_bias_initializer_config": null, "conv_transpose_kernel_initializer": null, "conv_transpose_kernel_initializer_config": null, "conv_transpose_bias_initializer": null, "conv_transpose_bias_initializer_config": null, "post_fcnet_hiddens": [], "post_fcnet_activation": "relu", "post_fcnet_weights_initializer": null, "post_fcnet_weights_initializer_config": null, "post_fcnet_bias_initializer": null, "post_fcnet_bias_initializer_config": null, "free_log_std": false, "log_std_clip_param": 20.0, "no_final_linear": false, "vf_share_layers": false, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "lstm_weights_initializer": null, "lstm_weights_initializer_config": null, "lstm_bias_initializer": null, "lstm_bias_initializer_config": null, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "attention_use_n_prev_actions": 0, "attention_use_n_prev_rewards": 0, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": null, "custom_model_config": {}, "custom_action_dist": null, "custom_preprocessor": null, "encoder_latent_dim": null, "always_check_shapes": false, "lstm_use_prev_action_reward": -1, "_use_default_native_models": -1, "_disable_preprocessor_api": false, "_disable_action_flattening": false}, "_learner_connector": null, "add_default_connectors_to_learner_pipeline": true, "learner_config_dict": {}, "optimizer": {}, "_learner_class": null, "callbacks_on_algorithm_init": null, "callbacks_on_env_runners_recreated": null, "callbacks_on_offline_eval_runners_recreated": null, "callbacks_on_checkpoint_loaded": null, "callbacks_on_environment_created": null, "callbacks_on_episode_created": null, "callbacks_on_episode_start": null, "callbacks_on_episode_step": null, "callbacks_on_episode_end": null, "callbacks_on_evaluate_start": null, "callbacks_on_evaluate_end": null, "callbacks_on_evaluate_offline_start": null, "callbacks_on_evaluate_offline_end": null, "callbacks_on_sample_end": null, "callbacks_on_train_result": null, "explore": true, "enable_rl_module_and_learner": true, "enable_env_runner_and_connector_v2": true, "_prior_exploration_config": {"type": "StochasticSampling"}, "count_steps_by": "env_steps", "policy_map_capacity": 100, "policy_mapping_fn": "<function AlgorithmConfig.DEFAULT_POLICY_MAPPING_FN at 0x1680e9b20>", "policies_to_train": null, "policy_states_are_swappable": false, "observation_fn": null, "offline_data_class": null, "input_read_method": "read_parquet", "input_read_method_kwargs": {}, "input_read_schema": {}, "input_read_episodes": false, "input_read_sample_batches": false, "input_read_batch_size": null, "input_filesystem": null, "input_filesystem_kwargs": {}, "input_compress_columns": ["obs", "new_obs"], "input_spaces_jsonable": true, "materialize_data": false, "materialize_mapped_data": true, "map_batches_kwargs": {}, "iter_batches_kwargs": {}, "ignore_final_observation": false, "prelearner_class": null, "prelearner_buffer_class": null, "prelearner_buffer_kwargs": {}, "prelearner_module_synch_period": 10, "dataset_num_iters_per_learner": null, "input_config": {}, "actions_in_input_normalized": false, "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_config": {}, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "output_max_rows_per_file": null, "output_write_remaining_data": false, "output_write_method": "write_parquet", "output_write_method_kwargs": {}, "output_filesystem": null, "output_filesystem_kwargs": {}, "output_write_episodes": true, "offline_sampling": false, "evaluation_interval": 1, "evaluation_duration": 20, "evaluation_duration_unit": "episodes", "evaluation_sample_timeout_s": 120.0, "evaluation_auto_duration_min_env_steps_per_sample": 100, "evaluation_auto_duration_max_env_steps_per_sample": 2000, "evaluation_parallel_to_training": false, "evaluation_force_reset_envs_before_iteration": true, "evaluation_config": null, "off_policy_estimation_methods": {}, "ope_split_batch_by_episode": true, "evaluation_num_env_runners": 1, "in_evaluation": false, "sync_filters_on_rollout_workers_timeout_s": 10.0, "offline_evaluation_interval": null, "num_offline_eval_runners": 0, "offline_loss_for_module_fn": null, "offline_evaluation_duration": 1, "offline_evaluation_parallel_to_training": false, "offline_evaluation_timeout_s": 120.0, "num_cpus_per_offline_eval_runner": 1, "num_gpus_per_offline_eval_runner": 0, "custom_resources_per_offline_eval_runner": {}, "restart_failed_offline_eval_runners": true, "ignore_offline_eval_runner_failures": false, "max_num_offline_eval_runner_restarts": 1000, "offline_eval_runner_restore_timeout_s": 1800.0, "max_requests_in_flight_per_offline_eval_runner": 1, "validate_offline_eval_runners_after_construction": true, "offline_eval_runner_health_probe_timeout_s": 30.0, "offline_eval_rl_module_inference_only": false, "broadcast_offline_eval_runner_states": false, "offline_eval_batch_size_per_runner": 256, "dataset_num_iters_per_eval_runner": 1, "keep_per_episode_custom_metrics": false, "metrics_episode_collection_timeout_s": 60.0, "metrics_num_episodes_for_smoothing": 100, "min_time_s_per_iteration": null, "min_train_timesteps_per_iteration": 0, "min_sample_timesteps_per_iteration": 0, "log_gradients": true, "export_native_model_files": false, "checkpoint_trainable_policies_only": false, "logger_creator": null, "logger_config": null, "log_level": "WARN", "log_sys_usage": true, "fake_sampler": false, "seed": 8, "restart_failed_env_runners": true, "ignore_env_runner_failures": false, "max_num_env_runner_restarts": 1000, "delay_between_env_runner_restarts_s": 60.0, "restart_failed_sub_environments": false, "num_consecutive_env_runner_failures_tolerance": 100, "env_runner_health_probe_timeout_s": 30.0, "env_runner_restore_timeout_s": 1800.0, "_model_config": {}, "_rl_module_spec": "RLModuleSpec(module_class=None, observation_space=None, action_space=None, inference_only=False, learner_only=False, model_config=DefaultModelConfig(fcnet_hiddens=[60, 90], fcnet_activation='tanh', fcnet_kernel_initializer=None, fcnet_kernel_initializer_kwargs=None, fcnet_bias_initializer=None, fcnet_bias_initializer_kwargs=None, conv_filters=None, conv_activation='relu', conv_kernel_initializer=None, conv_kernel_initializer_kwargs=None, conv_bias_initializer=None, conv_bias_initializer_kwargs=None, head_fcnet_hiddens=[], head_fcnet_activation='relu', head_fcnet_kernel_initializer=None, head_fcnet_kernel_initializer_kwargs=None, head_fcnet_bias_initializer=None, head_fcnet_bias_initializer_kwargs=None, free_log_std=False, log_std_clip_param=20.0, vf_share_layers=True, use_lstm=False, max_seq_len=20, lstm_cell_size=256, lstm_use_prev_action=False, lstm_use_prev_reward=False, lstm_kernel_initializer=None, lstm_kernel_initializer_kwargs=None, lstm_bias_initializer=None, lstm_bias_initializer_kwargs=None), catalog_class=None, load_state_path=None, model_config_dict=None)", "algorithm_config_overrides_per_module": {}, "_per_module_overrides": {}, "_validate_config": true, "_use_msgpack_checkpoints": false, "_torch_grad_scaler_class": null, "_torch_lr_scheduler_classes": null, "_tf_policy_handles_more_than_one_loss": false, "_disable_preprocessor_api": false, "_disable_action_flattening": false, "_disable_initialize_loss_from_dummy_batch": false, "_dont_auto_sync_env_runner_states": false, "env_task_fn": -1, "enable_connectors": -1, "simple_optimizer": false, "policy_map_cache": -1, "worker_cls": -1, "synchronize_filters": -1, "enable_async_evaluation": -1, "custom_async_evaluation_function": -1, "_enable_rl_module_api": -1, "auto_wrap_old_gym_envs": -1, "always_attach_evaluation_results": -1, "replay_sequence_length": null, "_disable_execution_plan_api": -1, "use_critic": true, "use_gae": true, "use_kl_loss": true, "kl_coeff": 0.7464963036515, "kl_target": 0.0270990929592, "vf_loss_coeff": 0.6688075857018, "entropy_coeff": 0.0090570820258, "clip_param": 0.1221781641624, "vf_clip_param": 0.1027808522125, "entropy_coeff_schedule": null, "lr_schedule": null, "sgd_minibatch_size": -1, "vf_share_layers": -1, "__stdout_file__": null, "__stderr_file__": null, "lambda": 0.9099046732075, "input": "sampler", "policies": {"default_policy": [null, null, null, null]}, "callbacks": "<class 'ray.rllib.callbacks.callbacks.RLlibCallback'>", "create_env_on_driver": false, "custom_eval_function": null, "framework": "torch"}, "time_since_restore": 17.308392763137817, "iterations_since_restore": 9, "perf": {"cpu_util_percent": 47.7, "ram_util_percent": 83.8}}
{"timers": {"training_iteration": 2.2856007316716274, "restore_env_runners": 1.4451322171852936e-05, "training_step": 2.2854474308699375, "env_runner_sampling_timer": 2.1716832700160524, "learner_update_timer": 0.11036677228503129, "synch_weights": 0.0007583580795761822, "restore_eval_env_runners": 1.1919808089485201e-05, "evaluation_iteration": 0.1279092703656423, "synch_eval_env_connectors": 0.0001366455693683302, "synch_env_connectors": 4.7958837960928435e-06}, "env_runners": {"sample": 0.005126214737085185, "module_episode_returns_mean": {"default_policy": 3.4599999999999995}, "env_to_module_connector": {"timers": {"connectors": {"add_states_from_episodes_to_batch": 1.7765043553466585e-06, "numpy_to_tensor": 1.0271548021985053e-05, "add_observations_from_episodes_to_batch": 3.4338458694735455e-06, "add_time_dim_to_batch_and_zero_pad": 2.5061165617761865e-06, "batch_individual_items": 6.753850180742703e-06}}, "connector_pipeline_timer": 4.712243992159902e-05}, "env_reset_timer": 3.703973731949684e-05, "module_to_env_connector": {"timers": {"connectors": {"tensor_to_numpy": 1.3626467160322483e-05, "normalize_and_clip_actions": 9.881487529338225e-06, "listify_data_for_vector_env": 1.1769956603440367e-05, "remove_single_ts_time_rank_from_batch": 5.983229251371686e-07, "un_batch_to_individual_items": 5.964661980338738e-06, "get_actions": 4.054021597142739e-05}}, "connector_pipeline_timer": 0.00010923174018720188}, "num_module_steps_sampled": {"default_policy": 5000.0}, "weights_seq_no": 9.0, "agent_episode_returns_mean": {"default_agent": 3.4599999999999995}, "env_to_module_sum_episodes_length_out": 10.36823839457432, "env_step_timer": 1.462560654528043e-05, "num_env_steps_sampled": 5000.0, "episode_return_mean": 3.4599999999999995, "num_episodes_lifetime": -246500.0, "num_module_steps_sampled_lifetime": {"default_policy": -4930000.0}, "time_between_sampling": 0.0019793164083301037, "env_to_module_sum_episodes_length_in": 10.36823839457432, "rlmodule_inference_timer": 2.9458665174271087e-05, "episode_duration_sec_mean": 0.004843479623086748, "num_env_steps_sampled_lifetime": -4930000.0, "episode_len_max": 20, "episode_len_mean": 20.0, "num_episodes": 250.0, "episode_return_max": 8.5, "num_agent_steps_sampled": {"default_agent": 5000.0}, "episode_len_min": 20, "episode_return_min": -11.5, "num_agent_steps_sampled_lifetime": {"default_agent": -4930000.0}, "num_env_steps_sampled_lifetime_throughput": 3679.2046239559586}, "learners": {"__all_modules__": {"num_env_steps_trained": 31500, "learner_connector": {"timers": {"connectors": {"add_one_ts_to_episodes_and_truncate": 0.008717928823480147, "add_columns_from_episodes_to_train_batch": 0.034460620544008363, "general_advantage_estimation": 0.006539387999706569, "add_states_from_episodes_to_batch": 3.7391828037928645e-06, "add_time_dim_to_batch_and_zero_pad": 1.2747774770329264e-05, "batch_individual_items": 0.033523354493399236, "numpy_to_tensor": 6.999488120823108e-05, "add_observations_from_episodes_to_batch": 0.0008093268460580371}}, "connector_pipeline_timer": 0.08427339454122765}, "num_module_steps_trained_lifetime": 60000, "learner_connector_sum_episodes_length_in": 5000.0, "num_module_steps_trained": 6000, "learner_connector_sum_episodes_length_out": 5250.0, "num_env_steps_trained_lifetime": 315000, "num_non_trainable_parameters": 0, "num_trainable_parameters": 6003, "num_env_steps_trained_lifetime_throughput": 2189124.521164312, "num_module_steps_trained_throughput": 418991.2178794752, "num_module_steps_trained_lifetime_throughput": 418232.5888064651}, "default_policy": {"mean_kl_loss": 0.0023036045022308826, "curr_kl_coeff": 0.0007290003122761846, "module_train_batch_size_mean": 1000.0, "weights_seq_no": 10.0, "default_optimizer_learning_rate": 0.0002847858517, "num_trainable_parameters": 6003, "num_module_steps_trained_lifetime": 60000, "entropy": 0.581646203994751, "curr_entropy_coeff": 0.0090570820258, "num_module_steps_trained": 6000, "policy_loss": -0.2596895098686218, "vf_loss": 0.10278083384037018, "total_loss": -0.19621355831623077, "diff_num_grad_updates_vs_sampler_policy": 1.0, "vf_loss_unclipped": 26.41408920288086, "vf_explained_var": 0.002871870994567871, "gradients_default_optimizer_global_norm": 0.09449653327465057, "num_module_steps_trained_lifetime_throughput": 419866.5296759214}}, "num_training_step_calls_per_iteration": 1, "evaluation": {"env_runners": {"module_to_env_connector": {"timers": {"connectors": {"un_batch_to_individual_items": 5.298908676987209e-06, "get_actions": 3.540006993075218e-05, "tensor_to_numpy": 1.285163158636273e-05, "listify_data_for_vector_env": 1.0798844083398813e-05, "normalize_and_clip_actions": 9.232453293989008e-06, "remove_single_ts_time_rank_from_batch": 5.733342577375786e-07}}, "connector_pipeline_timer": 9.908982362921489e-05}, "env_step_timer": 1.3638218351559605e-05, "env_to_module_connector": {"timers": {"connectors": {"add_observations_from_episodes_to_batch": 2.7365990567376875e-06, "add_time_dim_to_batch_and_zero_pad": 2.237710363599493e-06, "batch_individual_items": 6.058837195434857e-06, "add_states_from_episodes_to_batch": 1.5974038481060252e-06, "numpy_to_tensor": 8.226465266474579e-06}}, "connector_pipeline_timer": 4.181006763969395e-05}, "episode_duration_sec_mean": 0.004653167056385427, "num_episodes": 20, "episode_return_min": -14.5, "agent_episode_returns_mean": {"default_agent": 0.95}, "sample": 0.1131196620196542, "num_agent_steps_sampled_lifetime": {"default_agent": 4000}, "env_to_module_sum_episodes_length_out": 10.368238394574323, "num_env_steps_sampled": 400, "module_episode_returns_mean": {"default_policy": 0.95}, "rlmodule_inference_timer": 2.6587080032224444e-05, "episode_return_max": 14.5, "env_reset_timer": 0.0009966411135584796, "num_agent_steps_sampled": {"default_agent": 400}, "episode_return_mean": 0.95, "num_episodes_lifetime": 200, "weights_seq_no": 10.0, "env_to_module_sum_episodes_length_in": 10.368238394574323, "num_env_steps_sampled_lifetime": 50400, "num_module_steps_sampled": {"default_policy": 400}, "episode_len_max": 20, "episode_len_mean": 20.0, "episode_len_min": 20, "num_module_steps_sampled_lifetime": {"default_policy": 4000}, "time_between_sampling": 1.7700318217349487}, "num_healthy_workers": 1, "actor_manager_num_outstanding_async_reqs": 0, "num_remote_worker_restarts": 0}, "num_env_steps_sampled_lifetime": -4930000.0, "fault_tolerance": {"num_healthy_workers": 0, "num_remote_worker_restarts": 0}, "env_runner_group": {"actor_manager_num_outstanding_async_reqs": 0}, "done": false, "training_iteration": 10, "trial_id": "4d657_00000", "date": "2025-08-11_19-21-10", "timestamp": 1754932870, "time_this_iter_s": 1.7621409893035889, "time_total_s": 19.070533752441406, "pid": 14261, "hostname": "Mac", "node_ip": "127.0.0.1", "config": {"exploration_config": {}, "extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "placement_strategy": "PACK", "num_gpus": 0, "_fake_gpus": false, "num_cpus_for_main_process": 2, "eager_tracing": true, "eager_max_retraces": 20, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "torch_compile_learner": false, "torch_compile_learner_what_to_compile": "forward_train", "torch_compile_learner_dynamo_backend": "aot_eager", "torch_compile_learner_dynamo_mode": null, "torch_compile_worker": false, "torch_compile_worker_dynamo_backend": "aot_eager", "torch_compile_worker_dynamo_mode": null, "torch_ddp_kwargs": {}, "torch_skip_nan_gradients": false, "env": "Umbrella", "env_config": {}, "observation_space": null, "action_space": null, "clip_rewards": null, "normalize_actions": true, "clip_actions": false, "_is_atari": null, "disable_env_checking": false, "render_env": false, "action_mask_key": "action_mask", "env_runner_cls": null, "num_env_runners": 0, "create_local_env_runner": true, "num_envs_per_env_runner": 1, "gym_env_vectorize_mode": "SYNC", "num_cpus_per_env_runner": 1, "num_gpus_per_env_runner": 0, "custom_resources_per_env_runner": {}, "validate_env_runners_after_construction": true, "episodes_to_numpy": true, "max_requests_in_flight_per_env_runner": 1, "sample_timeout_s": 60.0, "_env_to_module_connector": null, "add_default_connectors_to_env_to_module_pipeline": true, "_module_to_env_connector": null, "add_default_connectors_to_module_to_env_pipeline": true, "merge_env_runner_states": "training_only", "broadcast_env_runner_states": true, "episode_lookback_horizon": 1, "rollout_fragment_length": "auto", "batch_mode": "complete_episodes", "compress_observations": false, "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "enable_tf1_exec_eagerly": false, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "preprocessor_pref": "deepmind", "observation_filter": "NoFilter", "update_worker_filter_stats": true, "use_worker_filter_stats": true, "sampler_perf_stats_ema_coef": null, "_is_online": true, "num_learners": 0, "num_gpus_per_learner": 0, "num_cpus_per_learner": "auto", "num_aggregator_actors_per_learner": 0, "max_requests_in_flight_per_aggregator_actor": 3, "local_gpu_idx": 0, "max_requests_in_flight_per_learner": 3, "gamma": 1, "lr": 0.0002847858517, "grad_clip": 0.5, "grad_clip_by": "global_norm", "_train_batch_size_per_learner": 5000, "train_batch_size": 4000, "num_epochs": 1, "minibatch_size": 1000, "shuffle_batch_per_epoch": true, "model": {"fcnet_hiddens": [256, 256], "fcnet_activation": "tanh", "fcnet_weights_initializer": null, "fcnet_weights_initializer_config": null, "fcnet_bias_initializer": null, "fcnet_bias_initializer_config": null, "conv_filters": null, "conv_activation": "relu", "conv_kernel_initializer": null, "conv_kernel_initializer_config": null, "conv_bias_initializer": null, "conv_bias_initializer_config": null, "conv_transpose_kernel_initializer": null, "conv_transpose_kernel_initializer_config": null, "conv_transpose_bias_initializer": null, "conv_transpose_bias_initializer_config": null, "post_fcnet_hiddens": [], "post_fcnet_activation": "relu", "post_fcnet_weights_initializer": null, "post_fcnet_weights_initializer_config": null, "post_fcnet_bias_initializer": null, "post_fcnet_bias_initializer_config": null, "free_log_std": false, "log_std_clip_param": 20.0, "no_final_linear": false, "vf_share_layers": false, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "lstm_weights_initializer": null, "lstm_weights_initializer_config": null, "lstm_bias_initializer": null, "lstm_bias_initializer_config": null, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "attention_use_n_prev_actions": 0, "attention_use_n_prev_rewards": 0, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": null, "custom_model_config": {}, "custom_action_dist": null, "custom_preprocessor": null, "encoder_latent_dim": null, "always_check_shapes": false, "lstm_use_prev_action_reward": -1, "_use_default_native_models": -1, "_disable_preprocessor_api": false, "_disable_action_flattening": false}, "_learner_connector": null, "add_default_connectors_to_learner_pipeline": true, "learner_config_dict": {}, "optimizer": {}, "_learner_class": null, "callbacks_on_algorithm_init": null, "callbacks_on_env_runners_recreated": null, "callbacks_on_offline_eval_runners_recreated": null, "callbacks_on_checkpoint_loaded": null, "callbacks_on_environment_created": null, "callbacks_on_episode_created": null, "callbacks_on_episode_start": null, "callbacks_on_episode_step": null, "callbacks_on_episode_end": null, "callbacks_on_evaluate_start": null, "callbacks_on_evaluate_end": null, "callbacks_on_evaluate_offline_start": null, "callbacks_on_evaluate_offline_end": null, "callbacks_on_sample_end": null, "callbacks_on_train_result": null, "explore": true, "enable_rl_module_and_learner": true, "enable_env_runner_and_connector_v2": true, "_prior_exploration_config": {"type": "StochasticSampling"}, "count_steps_by": "env_steps", "policy_map_capacity": 100, "policy_mapping_fn": "<function AlgorithmConfig.DEFAULT_POLICY_MAPPING_FN at 0x1680e9b20>", "policies_to_train": null, "policy_states_are_swappable": false, "observation_fn": null, "offline_data_class": null, "input_read_method": "read_parquet", "input_read_method_kwargs": {}, "input_read_schema": {}, "input_read_episodes": false, "input_read_sample_batches": false, "input_read_batch_size": null, "input_filesystem": null, "input_filesystem_kwargs": {}, "input_compress_columns": ["obs", "new_obs"], "input_spaces_jsonable": true, "materialize_data": false, "materialize_mapped_data": true, "map_batches_kwargs": {}, "iter_batches_kwargs": {}, "ignore_final_observation": false, "prelearner_class": null, "prelearner_buffer_class": null, "prelearner_buffer_kwargs": {}, "prelearner_module_synch_period": 10, "dataset_num_iters_per_learner": null, "input_config": {}, "actions_in_input_normalized": false, "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_config": {}, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "output_max_rows_per_file": null, "output_write_remaining_data": false, "output_write_method": "write_parquet", "output_write_method_kwargs": {}, "output_filesystem": null, "output_filesystem_kwargs": {}, "output_write_episodes": true, "offline_sampling": false, "evaluation_interval": 1, "evaluation_duration": 20, "evaluation_duration_unit": "episodes", "evaluation_sample_timeout_s": 120.0, "evaluation_auto_duration_min_env_steps_per_sample": 100, "evaluation_auto_duration_max_env_steps_per_sample": 2000, "evaluation_parallel_to_training": false, "evaluation_force_reset_envs_before_iteration": true, "evaluation_config": null, "off_policy_estimation_methods": {}, "ope_split_batch_by_episode": true, "evaluation_num_env_runners": 1, "in_evaluation": false, "sync_filters_on_rollout_workers_timeout_s": 10.0, "offline_evaluation_interval": null, "num_offline_eval_runners": 0, "offline_loss_for_module_fn": null, "offline_evaluation_duration": 1, "offline_evaluation_parallel_to_training": false, "offline_evaluation_timeout_s": 120.0, "num_cpus_per_offline_eval_runner": 1, "num_gpus_per_offline_eval_runner": 0, "custom_resources_per_offline_eval_runner": {}, "restart_failed_offline_eval_runners": true, "ignore_offline_eval_runner_failures": false, "max_num_offline_eval_runner_restarts": 1000, "offline_eval_runner_restore_timeout_s": 1800.0, "max_requests_in_flight_per_offline_eval_runner": 1, "validate_offline_eval_runners_after_construction": true, "offline_eval_runner_health_probe_timeout_s": 30.0, "offline_eval_rl_module_inference_only": false, "broadcast_offline_eval_runner_states": false, "offline_eval_batch_size_per_runner": 256, "dataset_num_iters_per_eval_runner": 1, "keep_per_episode_custom_metrics": false, "metrics_episode_collection_timeout_s": 60.0, "metrics_num_episodes_for_smoothing": 100, "min_time_s_per_iteration": null, "min_train_timesteps_per_iteration": 0, "min_sample_timesteps_per_iteration": 0, "log_gradients": true, "export_native_model_files": false, "checkpoint_trainable_policies_only": false, "logger_creator": null, "logger_config": null, "log_level": "WARN", "log_sys_usage": true, "fake_sampler": false, "seed": 8, "restart_failed_env_runners": true, "ignore_env_runner_failures": false, "max_num_env_runner_restarts": 1000, "delay_between_env_runner_restarts_s": 60.0, "restart_failed_sub_environments": false, "num_consecutive_env_runner_failures_tolerance": 100, "env_runner_health_probe_timeout_s": 30.0, "env_runner_restore_timeout_s": 1800.0, "_model_config": {}, "_rl_module_spec": "RLModuleSpec(module_class=None, observation_space=None, action_space=None, inference_only=False, learner_only=False, model_config=DefaultModelConfig(fcnet_hiddens=[60, 90], fcnet_activation='tanh', fcnet_kernel_initializer=None, fcnet_kernel_initializer_kwargs=None, fcnet_bias_initializer=None, fcnet_bias_initializer_kwargs=None, conv_filters=None, conv_activation='relu', conv_kernel_initializer=None, conv_kernel_initializer_kwargs=None, conv_bias_initializer=None, conv_bias_initializer_kwargs=None, head_fcnet_hiddens=[], head_fcnet_activation='relu', head_fcnet_kernel_initializer=None, head_fcnet_kernel_initializer_kwargs=None, head_fcnet_bias_initializer=None, head_fcnet_bias_initializer_kwargs=None, free_log_std=False, log_std_clip_param=20.0, vf_share_layers=True, use_lstm=False, max_seq_len=20, lstm_cell_size=256, lstm_use_prev_action=False, lstm_use_prev_reward=False, lstm_kernel_initializer=None, lstm_kernel_initializer_kwargs=None, lstm_bias_initializer=None, lstm_bias_initializer_kwargs=None), catalog_class=None, load_state_path=None, model_config_dict=None)", "algorithm_config_overrides_per_module": {}, "_per_module_overrides": {}, "_validate_config": true, "_use_msgpack_checkpoints": false, "_torch_grad_scaler_class": null, "_torch_lr_scheduler_classes": null, "_tf_policy_handles_more_than_one_loss": false, "_disable_preprocessor_api": false, "_disable_action_flattening": false, "_disable_initialize_loss_from_dummy_batch": false, "_dont_auto_sync_env_runner_states": false, "env_task_fn": -1, "enable_connectors": -1, "simple_optimizer": false, "policy_map_cache": -1, "worker_cls": -1, "synchronize_filters": -1, "enable_async_evaluation": -1, "custom_async_evaluation_function": -1, "_enable_rl_module_api": -1, "auto_wrap_old_gym_envs": -1, "always_attach_evaluation_results": -1, "replay_sequence_length": null, "_disable_execution_plan_api": -1, "use_critic": true, "use_gae": true, "use_kl_loss": true, "kl_coeff": 0.7464963036515, "kl_target": 0.0270990929592, "vf_loss_coeff": 0.6688075857018, "entropy_coeff": 0.0090570820258, "clip_param": 0.1221781641624, "vf_clip_param": 0.1027808522125, "entropy_coeff_schedule": null, "lr_schedule": null, "sgd_minibatch_size": -1, "vf_share_layers": -1, "__stdout_file__": null, "__stderr_file__": null, "lambda": 0.9099046732075, "input": "sampler", "policies": {"default_policy": [null, null, null, null]}, "callbacks": "<class 'ray.rllib.callbacks.callbacks.RLlibCallback'>", "create_env_on_driver": false, "custom_eval_function": null, "framework": "torch"}, "time_since_restore": 19.070533752441406, "iterations_since_restore": 10, "perf": {"cpu_util_percent": 30.96666666666667, "ram_util_percent": 83.60000000000001}}
{"timers": {"training_iteration": 2.277308261445928, "restore_env_runners": 1.4370559144520054e-05, "training_step": 2.277154676561585, "env_runner_sampling_timer": 2.163549316485736, "learner_update_timer": 0.11021064622187887, "synch_weights": 0.0007568674194469809, "restore_eval_env_runners": 1.1864769984908829e-05, "evaluation_iteration": 0.12765802933250067, "synch_eval_env_connectors": 0.00013680452459130315, "synch_env_connectors": 4.787924098558431e-06}, "env_runners": {"sample": 0.004913604048003295, "module_episode_returns_mean": {"default_policy": 4.82}, "env_to_module_connector": {"timers": {"connectors": {"add_states_from_episodes_to_batch": 1.7070408317210458e-06, "numpy_to_tensor": 8.381534193148744e-06, "add_observations_from_episodes_to_batch": 2.9411276053860194e-06, "add_time_dim_to_batch_and_zero_pad": 2.3291858950285177e-06, "batch_individual_items": 6.2756766134268865e-06}}, "connector_pipeline_timer": 4.3256720466198454e-05}, "env_reset_timer": 3.424850195754415e-05, "module_to_env_connector": {"timers": {"connectors": {"tensor_to_numpy": 1.285611461877875e-05, "normalize_and_clip_actions": 9.280194629032252e-06, "listify_data_for_vector_env": 1.0968371058769937e-05, "remove_single_ts_time_rank_from_batch": 5.73099996896329e-07, "un_batch_to_individual_items": 5.3961684689791985e-06, "get_actions": 3.7254006528239964e-05}}, "connector_pipeline_timer": 0.00010183146882938785}, "num_module_steps_sampled": {"default_policy": 5000.0}, "weights_seq_no": 10.0, "agent_episode_returns_mean": {"default_agent": 4.82}, "env_to_module_sum_episodes_length_out": 10.36823839457432, "env_step_timer": 1.3672744196204626e-05, "num_env_steps_sampled": 5000.0, "episode_return_mean": 4.82, "num_episodes_lifetime": -277375.0, "num_module_steps_sampled_lifetime": {"default_policy": -5547500.0}, "time_between_sampling": 0.001921564987194219, "env_to_module_sum_episodes_length_in": 10.36823839457432, "rlmodule_inference_timer": 2.7205659341578e-05, "episode_duration_sec_mean": 0.004483635335694999, "num_env_steps_sampled_lifetime": -5547500.0, "episode_len_max": 20, "episode_len_mean": 20.0, "num_episodes": 250.0, "episode_return_max": 8.5, "num_agent_steps_sampled": {"default_agent": 5000.0}, "episode_len_min": 20, "episode_return_min": -11.5, "num_agent_steps_sampled_lifetime": {"default_agent": -5547500.0}, "num_env_steps_sampled_lifetime_throughput": 3783.800376508584}, "learners": {"__all_modules__": {"num_env_steps_trained": 31500, "learner_connector": {"timers": {"connectors": {"add_one_ts_to_episodes_and_truncate": 0.00870679911431995, "add_columns_from_episodes_to_train_batch": 0.03445728474855838, "general_advantage_estimation": 0.006531823289964493, "add_states_from_episodes_to_batch": 3.7288808211440636e-06, "add_time_dim_to_batch_and_zero_pad": 1.269820681260543e-05, "batch_individual_items": 0.033493706778239166, "numpy_to_tensor": 6.982326237950237e-05, "add_observations_from_episodes_to_batch": 0.0008091456576339329}}, "connector_pipeline_timer": 0.0842208072561079}, "num_module_steps_trained_lifetime": 66000, "learner_connector_sum_episodes_length_in": 5000.0, "num_module_steps_trained": 6000, "learner_connector_sum_episodes_length_out": 5250.0, "num_env_steps_trained_lifetime": 346500, "num_non_trainable_parameters": 0, "num_trainable_parameters": 6003, "num_env_steps_trained_lifetime_throughput": 2173092.646640624, "num_module_steps_trained_throughput": 415851.6600925038, "num_module_steps_trained_lifetime_throughput": 415121.5996928387}, "default_policy": {"mean_kl_loss": 0.001672356273047626, "curr_kl_coeff": 0.0003645001561380923, "module_train_batch_size_mean": 1000.0, "weights_seq_no": 11.0, "default_optimizer_learning_rate": 0.0002847858517, "num_trainable_parameters": 6003, "num_module_steps_trained_lifetime": 66000, "entropy": 0.5473174452781677, "curr_entropy_coeff": 0.0090570820258, "num_module_steps_trained": 6000, "policy_loss": -0.054561760276556015, "vf_loss": 0.10278083384037018, "total_loss": 0.00922297965735197, "diff_num_grad_updates_vs_sampler_policy": 1.0, "vf_loss_unclipped": 26.720659255981445, "vf_explained_var": 0.0033788084983825684, "gradients_default_optimizer_global_norm": 0.13445432484149933, "num_module_steps_trained_lifetime_throughput": 416667.06510059495}}, "num_training_step_calls_per_iteration": 1, "evaluation": {"env_runners": {"module_to_env_connector": {"timers": {"connectors": {"un_batch_to_individual_items": 5.424497085958481e-06, "get_actions": 3.709541659955333e-05, "tensor_to_numpy": 1.319060426755073e-05, "listify_data_for_vector_env": 1.0907728415313871e-05, "normalize_and_clip_actions": 9.407117429869053e-06, "remove_single_ts_time_rank_from_batch": 5.570401551595567e-07}}, "connector_pipeline_timer": 0.00010185790555767804}, "env_step_timer": 1.3960253640997215e-05, "env_to_module_connector": {"timers": {"connectors": {"add_observations_from_episodes_to_batch": 2.794044228071178e-06, "add_time_dim_to_batch_and_zero_pad": 2.2644431771733407e-06, "batch_individual_items": 6.2513108768884095e-06, "add_states_from_episodes_to_batch": 1.5934526297698563e-06, "numpy_to_tensor": 8.329446565324032e-06}}, "connector_pipeline_timer": 4.2283124109248535e-05}, "episode_duration_sec_mean": 0.004596805014880374, "num_episodes": 20, "episode_return_min": -14.5, "agent_episode_returns_mean": {"default_agent": 1.35}, "sample": 0.11296827080890029, "num_agent_steps_sampled_lifetime": {"default_agent": 4400}, "env_to_module_sum_episodes_length_out": 10.368238394574323, "num_env_steps_sampled": 400, "module_episode_returns_mean": {"default_policy": 1.35}, "rlmodule_inference_timer": 2.723679541685536e-05, "episode_return_max": 14.5, "env_reset_timer": 0.0009879030435571599, "num_agent_steps_sampled": {"default_agent": 400}, "episode_return_mean": 1.35, "num_episodes_lifetime": 220, "weights_seq_no": 11.0, "env_to_module_sum_episodes_length_in": 10.368238394574323, "num_env_steps_sampled_lifetime": 55400, "num_module_steps_sampled": {"default_policy": 400}, "episode_len_max": 20, "episode_len_mean": 20.0, "episode_len_min": 20, "num_module_steps_sampled_lifetime": {"default_policy": 4400}, "time_between_sampling": 1.7671387710186182}, "num_healthy_workers": 1, "actor_manager_num_outstanding_async_reqs": 0, "num_remote_worker_restarts": 0}, "num_env_steps_sampled_lifetime": -5547500.0, "fault_tolerance": {"num_healthy_workers": 0, "num_remote_worker_restarts": 0}, "env_runner_group": {"actor_manager_num_outstanding_async_reqs": 0}, "done": false, "training_iteration": 11, "trial_id": "4d657_00000", "date": "2025-08-11_19-21-12", "timestamp": 1754932872, "time_this_iter_s": 1.5615057945251465, "time_total_s": 20.632039546966553, "pid": 14261, "hostname": "Mac", "node_ip": "127.0.0.1", "config": {"exploration_config": {}, "extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "placement_strategy": "PACK", "num_gpus": 0, "_fake_gpus": false, "num_cpus_for_main_process": 2, "eager_tracing": true, "eager_max_retraces": 20, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "torch_compile_learner": false, "torch_compile_learner_what_to_compile": "forward_train", "torch_compile_learner_dynamo_backend": "aot_eager", "torch_compile_learner_dynamo_mode": null, "torch_compile_worker": false, "torch_compile_worker_dynamo_backend": "aot_eager", "torch_compile_worker_dynamo_mode": null, "torch_ddp_kwargs": {}, "torch_skip_nan_gradients": false, "env": "Umbrella", "env_config": {}, "observation_space": null, "action_space": null, "clip_rewards": null, "normalize_actions": true, "clip_actions": false, "_is_atari": null, "disable_env_checking": false, "render_env": false, "action_mask_key": "action_mask", "env_runner_cls": null, "num_env_runners": 0, "create_local_env_runner": true, "num_envs_per_env_runner": 1, "gym_env_vectorize_mode": "SYNC", "num_cpus_per_env_runner": 1, "num_gpus_per_env_runner": 0, "custom_resources_per_env_runner": {}, "validate_env_runners_after_construction": true, "episodes_to_numpy": true, "max_requests_in_flight_per_env_runner": 1, "sample_timeout_s": 60.0, "_env_to_module_connector": null, "add_default_connectors_to_env_to_module_pipeline": true, "_module_to_env_connector": null, "add_default_connectors_to_module_to_env_pipeline": true, "merge_env_runner_states": "training_only", "broadcast_env_runner_states": true, "episode_lookback_horizon": 1, "rollout_fragment_length": "auto", "batch_mode": "complete_episodes", "compress_observations": false, "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "enable_tf1_exec_eagerly": false, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "preprocessor_pref": "deepmind", "observation_filter": "NoFilter", "update_worker_filter_stats": true, "use_worker_filter_stats": true, "sampler_perf_stats_ema_coef": null, "_is_online": true, "num_learners": 0, "num_gpus_per_learner": 0, "num_cpus_per_learner": "auto", "num_aggregator_actors_per_learner": 0, "max_requests_in_flight_per_aggregator_actor": 3, "local_gpu_idx": 0, "max_requests_in_flight_per_learner": 3, "gamma": 1, "lr": 0.0002847858517, "grad_clip": 0.5, "grad_clip_by": "global_norm", "_train_batch_size_per_learner": 5000, "train_batch_size": 4000, "num_epochs": 1, "minibatch_size": 1000, "shuffle_batch_per_epoch": true, "model": {"fcnet_hiddens": [256, 256], "fcnet_activation": "tanh", "fcnet_weights_initializer": null, "fcnet_weights_initializer_config": null, "fcnet_bias_initializer": null, "fcnet_bias_initializer_config": null, "conv_filters": null, "conv_activation": "relu", "conv_kernel_initializer": null, "conv_kernel_initializer_config": null, "conv_bias_initializer": null, "conv_bias_initializer_config": null, "conv_transpose_kernel_initializer": null, "conv_transpose_kernel_initializer_config": null, "conv_transpose_bias_initializer": null, "conv_transpose_bias_initializer_config": null, "post_fcnet_hiddens": [], "post_fcnet_activation": "relu", "post_fcnet_weights_initializer": null, "post_fcnet_weights_initializer_config": null, "post_fcnet_bias_initializer": null, "post_fcnet_bias_initializer_config": null, "free_log_std": false, "log_std_clip_param": 20.0, "no_final_linear": false, "vf_share_layers": false, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "lstm_weights_initializer": null, "lstm_weights_initializer_config": null, "lstm_bias_initializer": null, "lstm_bias_initializer_config": null, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "attention_use_n_prev_actions": 0, "attention_use_n_prev_rewards": 0, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": null, "custom_model_config": {}, "custom_action_dist": null, "custom_preprocessor": null, "encoder_latent_dim": null, "always_check_shapes": false, "lstm_use_prev_action_reward": -1, "_use_default_native_models": -1, "_disable_preprocessor_api": false, "_disable_action_flattening": false}, "_learner_connector": null, "add_default_connectors_to_learner_pipeline": true, "learner_config_dict": {}, "optimizer": {}, "_learner_class": null, "callbacks_on_algorithm_init": null, "callbacks_on_env_runners_recreated": null, "callbacks_on_offline_eval_runners_recreated": null, "callbacks_on_checkpoint_loaded": null, "callbacks_on_environment_created": null, "callbacks_on_episode_created": null, "callbacks_on_episode_start": null, "callbacks_on_episode_step": null, "callbacks_on_episode_end": null, "callbacks_on_evaluate_start": null, "callbacks_on_evaluate_end": null, "callbacks_on_evaluate_offline_start": null, "callbacks_on_evaluate_offline_end": null, "callbacks_on_sample_end": null, "callbacks_on_train_result": null, "explore": true, "enable_rl_module_and_learner": true, "enable_env_runner_and_connector_v2": true, "_prior_exploration_config": {"type": "StochasticSampling"}, "count_steps_by": "env_steps", "policy_map_capacity": 100, "policy_mapping_fn": "<function AlgorithmConfig.DEFAULT_POLICY_MAPPING_FN at 0x1680e9b20>", "policies_to_train": null, "policy_states_are_swappable": false, "observation_fn": null, "offline_data_class": null, "input_read_method": "read_parquet", "input_read_method_kwargs": {}, "input_read_schema": {}, "input_read_episodes": false, "input_read_sample_batches": false, "input_read_batch_size": null, "input_filesystem": null, "input_filesystem_kwargs": {}, "input_compress_columns": ["obs", "new_obs"], "input_spaces_jsonable": true, "materialize_data": false, "materialize_mapped_data": true, "map_batches_kwargs": {}, "iter_batches_kwargs": {}, "ignore_final_observation": false, "prelearner_class": null, "prelearner_buffer_class": null, "prelearner_buffer_kwargs": {}, "prelearner_module_synch_period": 10, "dataset_num_iters_per_learner": null, "input_config": {}, "actions_in_input_normalized": false, "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_config": {}, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "output_max_rows_per_file": null, "output_write_remaining_data": false, "output_write_method": "write_parquet", "output_write_method_kwargs": {}, "output_filesystem": null, "output_filesystem_kwargs": {}, "output_write_episodes": true, "offline_sampling": false, "evaluation_interval": 1, "evaluation_duration": 20, "evaluation_duration_unit": "episodes", "evaluation_sample_timeout_s": 120.0, "evaluation_auto_duration_min_env_steps_per_sample": 100, "evaluation_auto_duration_max_env_steps_per_sample": 2000, "evaluation_parallel_to_training": false, "evaluation_force_reset_envs_before_iteration": true, "evaluation_config": null, "off_policy_estimation_methods": {}, "ope_split_batch_by_episode": true, "evaluation_num_env_runners": 1, "in_evaluation": false, "sync_filters_on_rollout_workers_timeout_s": 10.0, "offline_evaluation_interval": null, "num_offline_eval_runners": 0, "offline_loss_for_module_fn": null, "offline_evaluation_duration": 1, "offline_evaluation_parallel_to_training": false, "offline_evaluation_timeout_s": 120.0, "num_cpus_per_offline_eval_runner": 1, "num_gpus_per_offline_eval_runner": 0, "custom_resources_per_offline_eval_runner": {}, "restart_failed_offline_eval_runners": true, "ignore_offline_eval_runner_failures": false, "max_num_offline_eval_runner_restarts": 1000, "offline_eval_runner_restore_timeout_s": 1800.0, "max_requests_in_flight_per_offline_eval_runner": 1, "validate_offline_eval_runners_after_construction": true, "offline_eval_runner_health_probe_timeout_s": 30.0, "offline_eval_rl_module_inference_only": false, "broadcast_offline_eval_runner_states": false, "offline_eval_batch_size_per_runner": 256, "dataset_num_iters_per_eval_runner": 1, "keep_per_episode_custom_metrics": false, "metrics_episode_collection_timeout_s": 60.0, "metrics_num_episodes_for_smoothing": 100, "min_time_s_per_iteration": null, "min_train_timesteps_per_iteration": 0, "min_sample_timesteps_per_iteration": 0, "log_gradients": true, "export_native_model_files": false, "checkpoint_trainable_policies_only": false, "logger_creator": null, "logger_config": null, "log_level": "WARN", "log_sys_usage": true, "fake_sampler": false, "seed": 8, "restart_failed_env_runners": true, "ignore_env_runner_failures": false, "max_num_env_runner_restarts": 1000, "delay_between_env_runner_restarts_s": 60.0, "restart_failed_sub_environments": false, "num_consecutive_env_runner_failures_tolerance": 100, "env_runner_health_probe_timeout_s": 30.0, "env_runner_restore_timeout_s": 1800.0, "_model_config": {}, "_rl_module_spec": "RLModuleSpec(module_class=None, observation_space=None, action_space=None, inference_only=False, learner_only=False, model_config=DefaultModelConfig(fcnet_hiddens=[60, 90], fcnet_activation='tanh', fcnet_kernel_initializer=None, fcnet_kernel_initializer_kwargs=None, fcnet_bias_initializer=None, fcnet_bias_initializer_kwargs=None, conv_filters=None, conv_activation='relu', conv_kernel_initializer=None, conv_kernel_initializer_kwargs=None, conv_bias_initializer=None, conv_bias_initializer_kwargs=None, head_fcnet_hiddens=[], head_fcnet_activation='relu', head_fcnet_kernel_initializer=None, head_fcnet_kernel_initializer_kwargs=None, head_fcnet_bias_initializer=None, head_fcnet_bias_initializer_kwargs=None, free_log_std=False, log_std_clip_param=20.0, vf_share_layers=True, use_lstm=False, max_seq_len=20, lstm_cell_size=256, lstm_use_prev_action=False, lstm_use_prev_reward=False, lstm_kernel_initializer=None, lstm_kernel_initializer_kwargs=None, lstm_bias_initializer=None, lstm_bias_initializer_kwargs=None), catalog_class=None, load_state_path=None, model_config_dict=None)", "algorithm_config_overrides_per_module": {}, "_per_module_overrides": {}, "_validate_config": true, "_use_msgpack_checkpoints": false, "_torch_grad_scaler_class": null, "_torch_lr_scheduler_classes": null, "_tf_policy_handles_more_than_one_loss": false, "_disable_preprocessor_api": false, "_disable_action_flattening": false, "_disable_initialize_loss_from_dummy_batch": false, "_dont_auto_sync_env_runner_states": false, "env_task_fn": -1, "enable_connectors": -1, "simple_optimizer": false, "policy_map_cache": -1, "worker_cls": -1, "synchronize_filters": -1, "enable_async_evaluation": -1, "custom_async_evaluation_function": -1, "_enable_rl_module_api": -1, "auto_wrap_old_gym_envs": -1, "always_attach_evaluation_results": -1, "replay_sequence_length": null, "_disable_execution_plan_api": -1, "use_critic": true, "use_gae": true, "use_kl_loss": true, "kl_coeff": 0.7464963036515, "kl_target": 0.0270990929592, "vf_loss_coeff": 0.6688075857018, "entropy_coeff": 0.0090570820258, "clip_param": 0.1221781641624, "vf_clip_param": 0.1027808522125, "entropy_coeff_schedule": null, "lr_schedule": null, "sgd_minibatch_size": -1, "vf_share_layers": -1, "__stdout_file__": null, "__stderr_file__": null, "lambda": 0.9099046732075, "input": "sampler", "policies": {"default_policy": [null, null, null, null]}, "callbacks": "<class 'ray.rllib.callbacks.callbacks.RLlibCallback'>", "create_env_on_driver": false, "custom_eval_function": null, "framework": "torch"}, "time_since_restore": 20.632039546966553, "iterations_since_restore": 11, "perf": {"cpu_util_percent": 40.150000000000006, "ram_util_percent": 83.5}}
{"timers": {"training_iteration": 2.269866010501904, "restore_env_runners": 1.4285603709388034e-05, "training_step": 2.269712118135721, "env_runner_sampling_timer": 2.156264545820536, "learner_update_timer": 0.11005032892968872, "synch_weights": 0.0007578970749847056, "restore_eval_env_runners": 1.1833622369251301e-05, "evaluation_iteration": 0.12740981403839544, "synch_eval_env_connectors": 0.00013643022963633528, "synch_env_connectors": 4.779204643528991e-06}, "env_runners": {"sample": 0.004795133416856688, "module_episode_returns_mean": {"default_policy": 5.299999999999998}, "env_to_module_connector": {"timers": {"connectors": {"add_states_from_episodes_to_batch": 1.7174863581436383e-06, "numpy_to_tensor": 8.384293332510398e-06, "add_observations_from_episodes_to_batch": 2.9863743252632386e-06, "add_time_dim_to_batch_and_zero_pad": 2.327618113288742e-06, "batch_individual_items": 6.317466736728428e-06}}, "connector_pipeline_timer": 4.3277095725773004e-05}, "env_reset_timer": 3.268015242011979e-05, "module_to_env_connector": {"timers": {"connectors": {"tensor_to_numpy": 1.2848392440342133e-05, "normalize_and_clip_actions": 9.332566284338179e-06, "listify_data_for_vector_env": 1.0969208723391521e-05, "remove_single_ts_time_rank_from_batch": 5.785887702645964e-07, "un_batch_to_individual_items": 5.411663793051386e-06, "get_actions": 3.722370183594563e-05}}, "connector_pipeline_timer": 0.00010172394962596943}, "num_module_steps_sampled": {"default_policy": 5000.0}, "weights_seq_no": 11.0, "agent_episode_returns_mean": {"default_agent": 5.299999999999998}, "env_to_module_sum_episodes_length_out": 10.36823839457432, "env_step_timer": 1.3646409115281079e-05, "num_env_steps_sampled": 5000.0, "episode_return_mean": 5.299999999999998, "num_episodes_lifetime": -308250.0, "num_module_steps_sampled_lifetime": {"default_policy": -6165000.0}, "time_between_sampling": 0.0018093064725660545, "env_to_module_sum_episodes_length_in": 10.36823839457432, "rlmodule_inference_timer": 2.6632549867510227e-05, "episode_duration_sec_mean": 0.004465000327676535, "num_env_steps_sampled_lifetime": -6165000.0, "episode_len_max": 20, "episode_len_mean": 20.0, "num_episodes": 250.0, "episode_return_max": 8.5, "num_agent_steps_sampled": {"default_agent": 5000.0}, "episode_len_min": 20, "episode_return_min": -11.5, "num_agent_steps_sampled_lifetime": {"default_agent": -6165000.0}, "num_env_steps_sampled_lifetime_throughput": 3778.7391351641463}, "learners": {"__all_modules__": {"num_env_steps_trained": 31500, "learner_connector": {"timers": {"connectors": {"add_one_ts_to_episodes_and_truncate": 0.00869542196261638, "add_columns_from_episodes_to_train_batch": 0.03444964190083036, "general_advantage_estimation": 0.006523790886744889, "add_states_from_episodes_to_batch": 3.7190916402545815e-06, "add_time_dim_to_batch_and_zero_pad": 1.2655383708934502e-05, "batch_individual_items": 0.033463690960082976, "numpy_to_tensor": 6.973795060436007e-05, "add_observations_from_episodes_to_batch": 0.0008092521214545176}}, "connector_pipeline_timer": 0.0841633637737543}, "num_module_steps_trained_lifetime": 72000, "learner_connector_sum_episodes_length_in": 5000.0, "num_module_steps_trained": 6000, "learner_connector_sum_episodes_length_out": 5250.0, "num_env_steps_trained_lifetime": 378000, "num_non_trainable_parameters": 0, "num_trainable_parameters": 6003, "num_env_steps_trained_lifetime_throughput": 2159547.0025809836, "num_module_steps_trained_throughput": 413187.78866215696, "num_module_steps_trained_lifetime_throughput": 412485.850704983}, "default_policy": {"mean_kl_loss": 0.00010483573714736849, "curr_kl_coeff": 0.00018225007806904614, "module_train_batch_size_mean": 1000.0, "weights_seq_no": 12.0, "default_optimizer_learning_rate": 0.0002847858517, "num_trainable_parameters": 6003, "num_module_steps_trained_lifetime": 72000, "entropy": 0.5396393537521362, "curr_entropy_coeff": 0.0090570820258, "num_module_steps_trained": 6000, "policy_loss": -0.14379438757896423, "vf_loss": 0.10278083384037018, "total_loss": -0.0799412950873375, "diff_num_grad_updates_vs_sampler_policy": 1.0, "vf_loss_unclipped": 26.306880950927734, "vf_explained_var": 0.0036283135414123535, "gradients_default_optimizer_global_norm": 0.016193924471735954, "num_module_steps_trained_lifetime_throughput": 413941.4437260833}}, "num_training_step_calls_per_iteration": 1, "evaluation": {"env_runners": {"module_to_env_connector": {"timers": {"connectors": {"un_batch_to_individual_items": 5.3530233435559305e-06, "get_actions": 3.641731737895916e-05, "tensor_to_numpy": 1.3005926387318366e-05, "listify_data_for_vector_env": 1.0886469732805782e-05, "normalize_and_clip_actions": 9.263562688665274e-06, "remove_single_ts_time_rank_from_batch": 5.676029826583348e-07}}, "connector_pipeline_timer": 0.00010048222266089724}, "env_step_timer": 1.3751812493668009e-05, "env_to_module_connector": {"timers": {"connectors": {"add_observations_from_episodes_to_batch": 2.8131243917544275e-06, "add_time_dim_to_batch_and_zero_pad": 2.31834196780706e-06, "batch_individual_items": 6.185357554296925e-06, "add_states_from_episodes_to_batch": 1.625533574946463e-06, "numpy_to_tensor": 8.365582249255576e-06}}, "connector_pipeline_timer": 4.253076050321926e-05}, "episode_duration_sec_mean": 0.0044996208243537695, "num_episodes": 20, "episode_return_min": -14.5, "agent_episode_returns_mean": {"default_agent": 1.35}, "sample": 0.1128053714308886, "num_agent_steps_sampled_lifetime": {"default_agent": 4800}, "env_to_module_sum_episodes_length_out": 10.368238394574323, "num_env_steps_sampled": 400, "module_episode_returns_mean": {"default_policy": 1.35}, "rlmodule_inference_timer": 2.705843410502637e-05, "episode_return_max": 14.5, "env_reset_timer": 0.0009787594226794076, "num_agent_steps_sampled": {"default_agent": 400}, "episode_return_mean": 1.35, "num_episodes_lifetime": 240, "weights_seq_no": 12.0, "env_to_module_sum_episodes_length_in": 10.368238394574323, "num_env_steps_sampled_lifetime": 60400, "num_module_steps_sampled": {"default_policy": 400}, "episode_len_max": 20, "episode_len_mean": 20.0, "episode_len_min": 20, "num_module_steps_sampled_lifetime": {"default_policy": 4800}, "time_between_sampling": 1.7649877099793898}, "num_healthy_workers": 1, "actor_manager_num_outstanding_async_reqs": 0, "num_remote_worker_restarts": 0}, "num_env_steps_sampled_lifetime": -6165000.0, "fault_tolerance": {"num_healthy_workers": 0, "num_remote_worker_restarts": 0}, "env_runner_group": {"actor_manager_num_outstanding_async_reqs": 0}, "done": false, "training_iteration": 12, "trial_id": "4d657_00000", "date": "2025-08-11_19-21-13", "timestamp": 1754932873, "time_this_iter_s": 1.637139081954956, "time_total_s": 22.26917862892151, "pid": 14261, "hostname": "Mac", "node_ip": "127.0.0.1", "config": {"exploration_config": {}, "extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "placement_strategy": "PACK", "num_gpus": 0, "_fake_gpus": false, "num_cpus_for_main_process": 2, "eager_tracing": true, "eager_max_retraces": 20, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "torch_compile_learner": false, "torch_compile_learner_what_to_compile": "forward_train", "torch_compile_learner_dynamo_backend": "aot_eager", "torch_compile_learner_dynamo_mode": null, "torch_compile_worker": false, "torch_compile_worker_dynamo_backend": "aot_eager", "torch_compile_worker_dynamo_mode": null, "torch_ddp_kwargs": {}, "torch_skip_nan_gradients": false, "env": "Umbrella", "env_config": {}, "observation_space": null, "action_space": null, "clip_rewards": null, "normalize_actions": true, "clip_actions": false, "_is_atari": null, "disable_env_checking": false, "render_env": false, "action_mask_key": "action_mask", "env_runner_cls": null, "num_env_runners": 0, "create_local_env_runner": true, "num_envs_per_env_runner": 1, "gym_env_vectorize_mode": "SYNC", "num_cpus_per_env_runner": 1, "num_gpus_per_env_runner": 0, "custom_resources_per_env_runner": {}, "validate_env_runners_after_construction": true, "episodes_to_numpy": true, "max_requests_in_flight_per_env_runner": 1, "sample_timeout_s": 60.0, "_env_to_module_connector": null, "add_default_connectors_to_env_to_module_pipeline": true, "_module_to_env_connector": null, "add_default_connectors_to_module_to_env_pipeline": true, "merge_env_runner_states": "training_only", "broadcast_env_runner_states": true, "episode_lookback_horizon": 1, "rollout_fragment_length": "auto", "batch_mode": "complete_episodes", "compress_observations": false, "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "enable_tf1_exec_eagerly": false, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "preprocessor_pref": "deepmind", "observation_filter": "NoFilter", "update_worker_filter_stats": true, "use_worker_filter_stats": true, "sampler_perf_stats_ema_coef": null, "_is_online": true, "num_learners": 0, "num_gpus_per_learner": 0, "num_cpus_per_learner": "auto", "num_aggregator_actors_per_learner": 0, "max_requests_in_flight_per_aggregator_actor": 3, "local_gpu_idx": 0, "max_requests_in_flight_per_learner": 3, "gamma": 1, "lr": 0.0002847858517, "grad_clip": 0.5, "grad_clip_by": "global_norm", "_train_batch_size_per_learner": 5000, "train_batch_size": 4000, "num_epochs": 1, "minibatch_size": 1000, "shuffle_batch_per_epoch": true, "model": {"fcnet_hiddens": [256, 256], "fcnet_activation": "tanh", "fcnet_weights_initializer": null, "fcnet_weights_initializer_config": null, "fcnet_bias_initializer": null, "fcnet_bias_initializer_config": null, "conv_filters": null, "conv_activation": "relu", "conv_kernel_initializer": null, "conv_kernel_initializer_config": null, "conv_bias_initializer": null, "conv_bias_initializer_config": null, "conv_transpose_kernel_initializer": null, "conv_transpose_kernel_initializer_config": null, "conv_transpose_bias_initializer": null, "conv_transpose_bias_initializer_config": null, "post_fcnet_hiddens": [], "post_fcnet_activation": "relu", "post_fcnet_weights_initializer": null, "post_fcnet_weights_initializer_config": null, "post_fcnet_bias_initializer": null, "post_fcnet_bias_initializer_config": null, "free_log_std": false, "log_std_clip_param": 20.0, "no_final_linear": false, "vf_share_layers": false, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "lstm_weights_initializer": null, "lstm_weights_initializer_config": null, "lstm_bias_initializer": null, "lstm_bias_initializer_config": null, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "attention_use_n_prev_actions": 0, "attention_use_n_prev_rewards": 0, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": null, "custom_model_config": {}, "custom_action_dist": null, "custom_preprocessor": null, "encoder_latent_dim": null, "always_check_shapes": false, "lstm_use_prev_action_reward": -1, "_use_default_native_models": -1, "_disable_preprocessor_api": false, "_disable_action_flattening": false}, "_learner_connector": null, "add_default_connectors_to_learner_pipeline": true, "learner_config_dict": {}, "optimizer": {}, "_learner_class": null, "callbacks_on_algorithm_init": null, "callbacks_on_env_runners_recreated": null, "callbacks_on_offline_eval_runners_recreated": null, "callbacks_on_checkpoint_loaded": null, "callbacks_on_environment_created": null, "callbacks_on_episode_created": null, "callbacks_on_episode_start": null, "callbacks_on_episode_step": null, "callbacks_on_episode_end": null, "callbacks_on_evaluate_start": null, "callbacks_on_evaluate_end": null, "callbacks_on_evaluate_offline_start": null, "callbacks_on_evaluate_offline_end": null, "callbacks_on_sample_end": null, "callbacks_on_train_result": null, "explore": true, "enable_rl_module_and_learner": true, "enable_env_runner_and_connector_v2": true, "_prior_exploration_config": {"type": "StochasticSampling"}, "count_steps_by": "env_steps", "policy_map_capacity": 100, "policy_mapping_fn": "<function AlgorithmConfig.DEFAULT_POLICY_MAPPING_FN at 0x1680e9b20>", "policies_to_train": null, "policy_states_are_swappable": false, "observation_fn": null, "offline_data_class": null, "input_read_method": "read_parquet", "input_read_method_kwargs": {}, "input_read_schema": {}, "input_read_episodes": false, "input_read_sample_batches": false, "input_read_batch_size": null, "input_filesystem": null, "input_filesystem_kwargs": {}, "input_compress_columns": ["obs", "new_obs"], "input_spaces_jsonable": true, "materialize_data": false, "materialize_mapped_data": true, "map_batches_kwargs": {}, "iter_batches_kwargs": {}, "ignore_final_observation": false, "prelearner_class": null, "prelearner_buffer_class": null, "prelearner_buffer_kwargs": {}, "prelearner_module_synch_period": 10, "dataset_num_iters_per_learner": null, "input_config": {}, "actions_in_input_normalized": false, "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_config": {}, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "output_max_rows_per_file": null, "output_write_remaining_data": false, "output_write_method": "write_parquet", "output_write_method_kwargs": {}, "output_filesystem": null, "output_filesystem_kwargs": {}, "output_write_episodes": true, "offline_sampling": false, "evaluation_interval": 1, "evaluation_duration": 20, "evaluation_duration_unit": "episodes", "evaluation_sample_timeout_s": 120.0, "evaluation_auto_duration_min_env_steps_per_sample": 100, "evaluation_auto_duration_max_env_steps_per_sample": 2000, "evaluation_parallel_to_training": false, "evaluation_force_reset_envs_before_iteration": true, "evaluation_config": null, "off_policy_estimation_methods": {}, "ope_split_batch_by_episode": true, "evaluation_num_env_runners": 1, "in_evaluation": false, "sync_filters_on_rollout_workers_timeout_s": 10.0, "offline_evaluation_interval": null, "num_offline_eval_runners": 0, "offline_loss_for_module_fn": null, "offline_evaluation_duration": 1, "offline_evaluation_parallel_to_training": false, "offline_evaluation_timeout_s": 120.0, "num_cpus_per_offline_eval_runner": 1, "num_gpus_per_offline_eval_runner": 0, "custom_resources_per_offline_eval_runner": {}, "restart_failed_offline_eval_runners": true, "ignore_offline_eval_runner_failures": false, "max_num_offline_eval_runner_restarts": 1000, "offline_eval_runner_restore_timeout_s": 1800.0, "max_requests_in_flight_per_offline_eval_runner": 1, "validate_offline_eval_runners_after_construction": true, "offline_eval_runner_health_probe_timeout_s": 30.0, "offline_eval_rl_module_inference_only": false, "broadcast_offline_eval_runner_states": false, "offline_eval_batch_size_per_runner": 256, "dataset_num_iters_per_eval_runner": 1, "keep_per_episode_custom_metrics": false, "metrics_episode_collection_timeout_s": 60.0, "metrics_num_episodes_for_smoothing": 100, "min_time_s_per_iteration": null, "min_train_timesteps_per_iteration": 0, "min_sample_timesteps_per_iteration": 0, "log_gradients": true, "export_native_model_files": false, "checkpoint_trainable_policies_only": false, "logger_creator": null, "logger_config": null, "log_level": "WARN", "log_sys_usage": true, "fake_sampler": false, "seed": 8, "restart_failed_env_runners": true, "ignore_env_runner_failures": false, "max_num_env_runner_restarts": 1000, "delay_between_env_runner_restarts_s": 60.0, "restart_failed_sub_environments": false, "num_consecutive_env_runner_failures_tolerance": 100, "env_runner_health_probe_timeout_s": 30.0, "env_runner_restore_timeout_s": 1800.0, "_model_config": {}, "_rl_module_spec": "RLModuleSpec(module_class=None, observation_space=None, action_space=None, inference_only=False, learner_only=False, model_config=DefaultModelConfig(fcnet_hiddens=[60, 90], fcnet_activation='tanh', fcnet_kernel_initializer=None, fcnet_kernel_initializer_kwargs=None, fcnet_bias_initializer=None, fcnet_bias_initializer_kwargs=None, conv_filters=None, conv_activation='relu', conv_kernel_initializer=None, conv_kernel_initializer_kwargs=None, conv_bias_initializer=None, conv_bias_initializer_kwargs=None, head_fcnet_hiddens=[], head_fcnet_activation='relu', head_fcnet_kernel_initializer=None, head_fcnet_kernel_initializer_kwargs=None, head_fcnet_bias_initializer=None, head_fcnet_bias_initializer_kwargs=None, free_log_std=False, log_std_clip_param=20.0, vf_share_layers=True, use_lstm=False, max_seq_len=20, lstm_cell_size=256, lstm_use_prev_action=False, lstm_use_prev_reward=False, lstm_kernel_initializer=None, lstm_kernel_initializer_kwargs=None, lstm_bias_initializer=None, lstm_bias_initializer_kwargs=None), catalog_class=None, load_state_path=None, model_config_dict=None)", "algorithm_config_overrides_per_module": {}, "_per_module_overrides": {}, "_validate_config": true, "_use_msgpack_checkpoints": false, "_torch_grad_scaler_class": null, "_torch_lr_scheduler_classes": null, "_tf_policy_handles_more_than_one_loss": false, "_disable_preprocessor_api": false, "_disable_action_flattening": false, "_disable_initialize_loss_from_dummy_batch": false, "_dont_auto_sync_env_runner_states": false, "env_task_fn": -1, "enable_connectors": -1, "simple_optimizer": false, "policy_map_cache": -1, "worker_cls": -1, "synchronize_filters": -1, "enable_async_evaluation": -1, "custom_async_evaluation_function": -1, "_enable_rl_module_api": -1, "auto_wrap_old_gym_envs": -1, "always_attach_evaluation_results": -1, "replay_sequence_length": null, "_disable_execution_plan_api": -1, "use_critic": true, "use_gae": true, "use_kl_loss": true, "kl_coeff": 0.7464963036515, "kl_target": 0.0270990929592, "vf_loss_coeff": 0.6688075857018, "entropy_coeff": 0.0090570820258, "clip_param": 0.1221781641624, "vf_clip_param": 0.1027808522125, "entropy_coeff_schedule": null, "lr_schedule": null, "sgd_minibatch_size": -1, "vf_share_layers": -1, "__stdout_file__": null, "__stderr_file__": null, "lambda": 0.9099046732075, "input": "sampler", "policies": {"default_policy": [null, null, null, null]}, "callbacks": "<class 'ray.rllib.callbacks.callbacks.RLlibCallback'>", "create_env_on_driver": false, "custom_eval_function": null, "framework": "torch"}, "time_since_restore": 22.26917862892151, "iterations_since_restore": 12, "perf": {"cpu_util_percent": 40.3, "ram_util_percent": 82.6}}
{"timers": {"training_iteration": 2.26284918664689, "restore_env_runners": 1.4198997227494492e-05, "training_step": 2.262695225704352, "env_runner_sampling_timer": 2.149418465772239, "learner_update_timer": 0.10988269355971951, "synch_weights": 0.0007560806044576309, "restore_eval_env_runners": 1.1793205248763993e-05, "evaluation_iteration": 0.1271529629778831, "synch_eval_env_connectors": 0.0001362030081751504, "synch_env_connectors": 4.772253420297026e-06}, "env_runners": {"sample": 0.0048093217870089225, "module_episode_returns_mean": {"default_policy": 5.700000000000004}, "env_to_module_connector": {"timers": {"connectors": {"add_states_from_episodes_to_batch": 1.709073264221058e-06, "numpy_to_tensor": 8.514305956135168e-06, "add_observations_from_episodes_to_batch": 2.942248923143375e-06, "add_time_dim_to_batch_and_zero_pad": 2.3440218825230495e-06, "batch_individual_items": 6.357199919515647e-06}}, "connector_pipeline_timer": 4.343287139988021e-05}, "env_reset_timer": 3.353729164840052e-05, "module_to_env_connector": {"timers": {"connectors": {"tensor_to_numpy": 1.3046794223836802e-05, "normalize_and_clip_actions": 9.41912242226176e-06, "listify_data_for_vector_env": 1.1126155110921963e-05, "remove_single_ts_time_rank_from_batch": 5.81519765594227e-07, "un_batch_to_individual_items": 5.493564875654036e-06, "get_actions": 3.799616038282422e-05}}, "connector_pipeline_timer": 0.00010333723249347787}, "num_module_steps_sampled": {"default_policy": 5000.0}, "weights_seq_no": 12.0, "agent_episode_returns_mean": {"default_agent": 5.700000000000004}, "env_to_module_sum_episodes_length_out": 10.36823839457432, "env_step_timer": 1.3958167534296429e-05, "num_env_steps_sampled": 5000.0, "episode_return_mean": 5.700000000000004, "num_episodes_lifetime": -339125.0, "num_module_steps_sampled_lifetime": {"default_policy": -6782500.0}, "time_between_sampling": 0.0017014901531572058, "env_to_module_sum_episodes_length_in": 10.36823839457432, "rlmodule_inference_timer": 2.673270325604062e-05, "episode_duration_sec_mean": 0.004520128857344388, "num_env_steps_sampled_lifetime": -6782500.0, "episode_len_max": 20, "episode_len_mean": 20.0, "num_episodes": 250.0, "episode_return_max": 8.5, "num_agent_steps_sampled": {"default_agent": 5000.0}, "episode_len_min": 20, "episode_return_min": -11.5, "num_agent_steps_sampled_lifetime": {"default_agent": -6782500.0}, "num_env_steps_sampled_lifetime_throughput": 3732.7376833313983}, "learners": {"__all_modules__": {"num_env_steps_trained": 31500, "learner_connector": {"timers": {"connectors": {"add_one_ts_to_episodes_and_truncate": 0.00868395774271663, "add_columns_from_episodes_to_train_batch": 0.0344391371413944, "general_advantage_estimation": 0.006511605068684327, "add_states_from_episodes_to_batch": 3.707730955458996e-06, "add_time_dim_to_batch_and_zero_pad": 1.2604669797402532e-05, "batch_individual_items": 0.03344304738082857, "numpy_to_tensor": 6.957766133463755e-05, "add_observations_from_episodes_to_batch": 0.0008092329294670176}}, "connector_pipeline_timer": 0.08410780138576628}, "num_module_steps_trained_lifetime": 78000, "learner_connector_sum_episodes_length_in": 5000.0, "num_module_steps_trained": 6000, "learner_connector_sum_episodes_length_out": 5250.0, "num_env_steps_trained_lifetime": 409500, "num_non_trainable_parameters": 0, "num_trainable_parameters": 6003, "num_env_steps_trained_lifetime_throughput": 2149441.7987006675, "num_module_steps_trained_throughput": 411183.98451687995, "num_module_steps_trained_lifetime_throughput": 410508.031233473}, "default_policy": {"mean_kl_loss": 4.6311222831718624e-05, "curr_kl_coeff": 9.112503903452307e-05, "module_train_batch_size_mean": 1000.0, "weights_seq_no": 13.0, "default_optimizer_learning_rate": 0.0002847858517, "num_trainable_parameters": 6003, "num_module_steps_trained_lifetime": 78000, "entropy": 0.5378057956695557, "curr_entropy_coeff": 0.0090570820258, "num_module_steps_trained": 6000, "policy_loss": -0.10556618124246597, "vf_loss": 0.10278083384037018, "total_loss": -0.04169650375843048, "diff_num_grad_updates_vs_sampler_policy": 1.0, "vf_loss_unclipped": 26.30040740966797, "vf_explained_var": 0.004175662994384766, "gradients_default_optimizer_global_norm": 0.05791241675615311, "num_module_steps_trained_lifetime_throughput": 411874.60204733384}}, "num_training_step_calls_per_iteration": 1, "evaluation": {"env_runners": {"module_to_env_connector": {"timers": {"connectors": {"un_batch_to_individual_items": 5.3187369209108405e-06, "get_actions": 3.6740158572837794e-05, "tensor_to_numpy": 1.3086617275453833e-05, "listify_data_for_vector_env": 1.0834939301122434e-05, "normalize_and_clip_actions": 9.257130785609405e-06, "remove_single_ts_time_rank_from_batch": 5.709822569756749e-07}}, "connector_pipeline_timer": 0.00010086202553425254}, "env_step_timer": 1.3746435462898618e-05, "env_to_module_connector": {"timers": {"connectors": {"add_observations_from_episodes_to_batch": 2.793058696262588e-06, "add_time_dim_to_batch_and_zero_pad": 2.2742909349308413e-06, "batch_individual_items": 6.107249652677297e-06, "add_states_from_episodes_to_batch": 1.5797313256812312e-06, "numpy_to_tensor": 8.236893820606766e-06}}, "connector_pipeline_timer": 4.218557315362992e-05}, "episode_duration_sec_mean": 0.004475624148035422, "num_episodes": 20, "episode_return_min": -14.5, "agent_episode_returns_mean": {"default_agent": 0.95}, "sample": 0.11264933355681395, "num_agent_steps_sampled_lifetime": {"default_agent": 5200}, "env_to_module_sum_episodes_length_out": 10.368238394574323, "num_env_steps_sampled": 400, "module_episode_returns_mean": {"default_policy": 0.95}, "rlmodule_inference_timer": 2.6957755836005898e-05, "episode_return_max": 14.5, "env_reset_timer": 0.0009700764084582443, "num_agent_steps_sampled": {"default_agent": 400}, "episode_return_mean": 0.95, "num_episodes_lifetime": 260, "weights_seq_no": 13.0, "env_to_module_sum_episodes_length_in": 10.368238394574323, "num_env_steps_sampled_lifetime": 65400, "num_module_steps_sampled": {"default_policy": 400}, "episode_len_max": 20, "episode_len_mean": 20.0, "episode_len_min": 20, "num_module_steps_sampled_lifetime": {"default_policy": 5200}, "time_between_sampling": 1.763190423719673}, "num_healthy_workers": 1, "actor_manager_num_outstanding_async_reqs": 0, "num_remote_worker_restarts": 0}, "num_env_steps_sampled_lifetime": -6782500.0, "fault_tolerance": {"num_healthy_workers": 0, "num_remote_worker_restarts": 0}, "env_runner_group": {"actor_manager_num_outstanding_async_reqs": 0}, "done": false, "training_iteration": 13, "trial_id": "4d657_00000", "date": "2025-08-11_19-21-15", "timestamp": 1754932875, "time_this_iter_s": 1.6731791496276855, "time_total_s": 23.942357778549194, "pid": 14261, "hostname": "Mac", "node_ip": "127.0.0.1", "config": {"exploration_config": {}, "extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "placement_strategy": "PACK", "num_gpus": 0, "_fake_gpus": false, "num_cpus_for_main_process": 2, "eager_tracing": true, "eager_max_retraces": 20, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "torch_compile_learner": false, "torch_compile_learner_what_to_compile": "forward_train", "torch_compile_learner_dynamo_backend": "aot_eager", "torch_compile_learner_dynamo_mode": null, "torch_compile_worker": false, "torch_compile_worker_dynamo_backend": "aot_eager", "torch_compile_worker_dynamo_mode": null, "torch_ddp_kwargs": {}, "torch_skip_nan_gradients": false, "env": "Umbrella", "env_config": {}, "observation_space": null, "action_space": null, "clip_rewards": null, "normalize_actions": true, "clip_actions": false, "_is_atari": null, "disable_env_checking": false, "render_env": false, "action_mask_key": "action_mask", "env_runner_cls": null, "num_env_runners": 0, "create_local_env_runner": true, "num_envs_per_env_runner": 1, "gym_env_vectorize_mode": "SYNC", "num_cpus_per_env_runner": 1, "num_gpus_per_env_runner": 0, "custom_resources_per_env_runner": {}, "validate_env_runners_after_construction": true, "episodes_to_numpy": true, "max_requests_in_flight_per_env_runner": 1, "sample_timeout_s": 60.0, "_env_to_module_connector": null, "add_default_connectors_to_env_to_module_pipeline": true, "_module_to_env_connector": null, "add_default_connectors_to_module_to_env_pipeline": true, "merge_env_runner_states": "training_only", "broadcast_env_runner_states": true, "episode_lookback_horizon": 1, "rollout_fragment_length": "auto", "batch_mode": "complete_episodes", "compress_observations": false, "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "enable_tf1_exec_eagerly": false, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "preprocessor_pref": "deepmind", "observation_filter": "NoFilter", "update_worker_filter_stats": true, "use_worker_filter_stats": true, "sampler_perf_stats_ema_coef": null, "_is_online": true, "num_learners": 0, "num_gpus_per_learner": 0, "num_cpus_per_learner": "auto", "num_aggregator_actors_per_learner": 0, "max_requests_in_flight_per_aggregator_actor": 3, "local_gpu_idx": 0, "max_requests_in_flight_per_learner": 3, "gamma": 1, "lr": 0.0002847858517, "grad_clip": 0.5, "grad_clip_by": "global_norm", "_train_batch_size_per_learner": 5000, "train_batch_size": 4000, "num_epochs": 1, "minibatch_size": 1000, "shuffle_batch_per_epoch": true, "model": {"fcnet_hiddens": [256, 256], "fcnet_activation": "tanh", "fcnet_weights_initializer": null, "fcnet_weights_initializer_config": null, "fcnet_bias_initializer": null, "fcnet_bias_initializer_config": null, "conv_filters": null, "conv_activation": "relu", "conv_kernel_initializer": null, "conv_kernel_initializer_config": null, "conv_bias_initializer": null, "conv_bias_initializer_config": null, "conv_transpose_kernel_initializer": null, "conv_transpose_kernel_initializer_config": null, "conv_transpose_bias_initializer": null, "conv_transpose_bias_initializer_config": null, "post_fcnet_hiddens": [], "post_fcnet_activation": "relu", "post_fcnet_weights_initializer": null, "post_fcnet_weights_initializer_config": null, "post_fcnet_bias_initializer": null, "post_fcnet_bias_initializer_config": null, "free_log_std": false, "log_std_clip_param": 20.0, "no_final_linear": false, "vf_share_layers": false, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "lstm_weights_initializer": null, "lstm_weights_initializer_config": null, "lstm_bias_initializer": null, "lstm_bias_initializer_config": null, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "attention_use_n_prev_actions": 0, "attention_use_n_prev_rewards": 0, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": null, "custom_model_config": {}, "custom_action_dist": null, "custom_preprocessor": null, "encoder_latent_dim": null, "always_check_shapes": false, "lstm_use_prev_action_reward": -1, "_use_default_native_models": -1, "_disable_preprocessor_api": false, "_disable_action_flattening": false}, "_learner_connector": null, "add_default_connectors_to_learner_pipeline": true, "learner_config_dict": {}, "optimizer": {}, "_learner_class": null, "callbacks_on_algorithm_init": null, "callbacks_on_env_runners_recreated": null, "callbacks_on_offline_eval_runners_recreated": null, "callbacks_on_checkpoint_loaded": null, "callbacks_on_environment_created": null, "callbacks_on_episode_created": null, "callbacks_on_episode_start": null, "callbacks_on_episode_step": null, "callbacks_on_episode_end": null, "callbacks_on_evaluate_start": null, "callbacks_on_evaluate_end": null, "callbacks_on_evaluate_offline_start": null, "callbacks_on_evaluate_offline_end": null, "callbacks_on_sample_end": null, "callbacks_on_train_result": null, "explore": true, "enable_rl_module_and_learner": true, "enable_env_runner_and_connector_v2": true, "_prior_exploration_config": {"type": "StochasticSampling"}, "count_steps_by": "env_steps", "policy_map_capacity": 100, "policy_mapping_fn": "<function AlgorithmConfig.DEFAULT_POLICY_MAPPING_FN at 0x1680e9b20>", "policies_to_train": null, "policy_states_are_swappable": false, "observation_fn": null, "offline_data_class": null, "input_read_method": "read_parquet", "input_read_method_kwargs": {}, "input_read_schema": {}, "input_read_episodes": false, "input_read_sample_batches": false, "input_read_batch_size": null, "input_filesystem": null, "input_filesystem_kwargs": {}, "input_compress_columns": ["obs", "new_obs"], "input_spaces_jsonable": true, "materialize_data": false, "materialize_mapped_data": true, "map_batches_kwargs": {}, "iter_batches_kwargs": {}, "ignore_final_observation": false, "prelearner_class": null, "prelearner_buffer_class": null, "prelearner_buffer_kwargs": {}, "prelearner_module_synch_period": 10, "dataset_num_iters_per_learner": null, "input_config": {}, "actions_in_input_normalized": false, "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_config": {}, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "output_max_rows_per_file": null, "output_write_remaining_data": false, "output_write_method": "write_parquet", "output_write_method_kwargs": {}, "output_filesystem": null, "output_filesystem_kwargs": {}, "output_write_episodes": true, "offline_sampling": false, "evaluation_interval": 1, "evaluation_duration": 20, "evaluation_duration_unit": "episodes", "evaluation_sample_timeout_s": 120.0, "evaluation_auto_duration_min_env_steps_per_sample": 100, "evaluation_auto_duration_max_env_steps_per_sample": 2000, "evaluation_parallel_to_training": false, "evaluation_force_reset_envs_before_iteration": true, "evaluation_config": null, "off_policy_estimation_methods": {}, "ope_split_batch_by_episode": true, "evaluation_num_env_runners": 1, "in_evaluation": false, "sync_filters_on_rollout_workers_timeout_s": 10.0, "offline_evaluation_interval": null, "num_offline_eval_runners": 0, "offline_loss_for_module_fn": null, "offline_evaluation_duration": 1, "offline_evaluation_parallel_to_training": false, "offline_evaluation_timeout_s": 120.0, "num_cpus_per_offline_eval_runner": 1, "num_gpus_per_offline_eval_runner": 0, "custom_resources_per_offline_eval_runner": {}, "restart_failed_offline_eval_runners": true, "ignore_offline_eval_runner_failures": false, "max_num_offline_eval_runner_restarts": 1000, "offline_eval_runner_restore_timeout_s": 1800.0, "max_requests_in_flight_per_offline_eval_runner": 1, "validate_offline_eval_runners_after_construction": true, "offline_eval_runner_health_probe_timeout_s": 30.0, "offline_eval_rl_module_inference_only": false, "broadcast_offline_eval_runner_states": false, "offline_eval_batch_size_per_runner": 256, "dataset_num_iters_per_eval_runner": 1, "keep_per_episode_custom_metrics": false, "metrics_episode_collection_timeout_s": 60.0, "metrics_num_episodes_for_smoothing": 100, "min_time_s_per_iteration": null, "min_train_timesteps_per_iteration": 0, "min_sample_timesteps_per_iteration": 0, "log_gradients": true, "export_native_model_files": false, "checkpoint_trainable_policies_only": false, "logger_creator": null, "logger_config": null, "log_level": "WARN", "log_sys_usage": true, "fake_sampler": false, "seed": 8, "restart_failed_env_runners": true, "ignore_env_runner_failures": false, "max_num_env_runner_restarts": 1000, "delay_between_env_runner_restarts_s": 60.0, "restart_failed_sub_environments": false, "num_consecutive_env_runner_failures_tolerance": 100, "env_runner_health_probe_timeout_s": 30.0, "env_runner_restore_timeout_s": 1800.0, "_model_config": {}, "_rl_module_spec": "RLModuleSpec(module_class=None, observation_space=None, action_space=None, inference_only=False, learner_only=False, model_config=DefaultModelConfig(fcnet_hiddens=[60, 90], fcnet_activation='tanh', fcnet_kernel_initializer=None, fcnet_kernel_initializer_kwargs=None, fcnet_bias_initializer=None, fcnet_bias_initializer_kwargs=None, conv_filters=None, conv_activation='relu', conv_kernel_initializer=None, conv_kernel_initializer_kwargs=None, conv_bias_initializer=None, conv_bias_initializer_kwargs=None, head_fcnet_hiddens=[], head_fcnet_activation='relu', head_fcnet_kernel_initializer=None, head_fcnet_kernel_initializer_kwargs=None, head_fcnet_bias_initializer=None, head_fcnet_bias_initializer_kwargs=None, free_log_std=False, log_std_clip_param=20.0, vf_share_layers=True, use_lstm=False, max_seq_len=20, lstm_cell_size=256, lstm_use_prev_action=False, lstm_use_prev_reward=False, lstm_kernel_initializer=None, lstm_kernel_initializer_kwargs=None, lstm_bias_initializer=None, lstm_bias_initializer_kwargs=None), catalog_class=None, load_state_path=None, model_config_dict=None)", "algorithm_config_overrides_per_module": {}, "_per_module_overrides": {}, "_validate_config": true, "_use_msgpack_checkpoints": false, "_torch_grad_scaler_class": null, "_torch_lr_scheduler_classes": null, "_tf_policy_handles_more_than_one_loss": false, "_disable_preprocessor_api": false, "_disable_action_flattening": false, "_disable_initialize_loss_from_dummy_batch": false, "_dont_auto_sync_env_runner_states": false, "env_task_fn": -1, "enable_connectors": -1, "simple_optimizer": false, "policy_map_cache": -1, "worker_cls": -1, "synchronize_filters": -1, "enable_async_evaluation": -1, "custom_async_evaluation_function": -1, "_enable_rl_module_api": -1, "auto_wrap_old_gym_envs": -1, "always_attach_evaluation_results": -1, "replay_sequence_length": null, "_disable_execution_plan_api": -1, "use_critic": true, "use_gae": true, "use_kl_loss": true, "kl_coeff": 0.7464963036515, "kl_target": 0.0270990929592, "vf_loss_coeff": 0.6688075857018, "entropy_coeff": 0.0090570820258, "clip_param": 0.1221781641624, "vf_clip_param": 0.1027808522125, "entropy_coeff_schedule": null, "lr_schedule": null, "sgd_minibatch_size": -1, "vf_share_layers": -1, "__stdout_file__": null, "__stderr_file__": null, "lambda": 0.9099046732075, "input": "sampler", "policies": {"default_policy": [null, null, null, null]}, "callbacks": "<class 'ray.rllib.callbacks.callbacks.RLlibCallback'>", "create_env_on_driver": false, "custom_eval_function": null, "framework": "torch"}, "time_since_restore": 23.942357778549194, "iterations_since_restore": 13, "perf": {"cpu_util_percent": 42.800000000000004, "ram_util_percent": 82.76666666666667}}
{"timers": {"training_iteration": 2.25584671561008, "restore_env_runners": 1.4116176506691304e-05, "training_step": 2.2556926259476167, "env_runner_sampling_timer": 2.141718718204917, "learner_update_timer": 0.11058195329341834, "synch_weights": 0.0007554289581236854, "restore_eval_env_runners": 1.1741932609554456e-05, "evaluation_iteration": 0.1269082341875675, "synch_eval_env_connectors": 0.0001358138981908096, "synch_env_connectors": 4.7653612319184165e-06}, "env_runners": {"sample": 0.004852688431360518, "module_episode_returns_mean": {"default_policy": 5.380000000000001}, "env_to_module_connector": {"timers": {"connectors": {"add_states_from_episodes_to_batch": 1.724399235460413e-06, "numpy_to_tensor": 8.596397887657243e-06, "add_observations_from_episodes_to_batch": 2.9532782827963367e-06, "add_time_dim_to_batch_and_zero_pad": 2.3622482411150635e-06, "batch_individual_items": 6.423990378126796e-06}}, "connector_pipeline_timer": 4.3731080832952614e-05}, "env_reset_timer": 3.578990688767602e-05, "module_to_env_connector": {"timers": {"connectors": {"tensor_to_numpy": 1.3105151297731661e-05, "normalize_and_clip_actions": 9.44207734542537e-06, "listify_data_for_vector_env": 1.1179357929866502e-05, "remove_single_ts_time_rank_from_batch": 5.807013123731625e-07, "un_batch_to_individual_items": 5.447186170915483e-06, "get_actions": 3.808574359353431e-05}}, "connector_pipeline_timer": 0.00010349034084971248}, "num_module_steps_sampled": {"default_policy": 5000.0}, "weights_seq_no": 13.0, "agent_episode_returns_mean": {"default_agent": 5.380000000000001}, "env_to_module_sum_episodes_length_out": 10.36823839457432, "env_step_timer": 1.3945170658380447e-05, "num_env_steps_sampled": 5000.0, "episode_return_mean": 5.380000000000001, "num_episodes_lifetime": -370000.0, "num_module_steps_sampled_lifetime": {"default_policy": -7400000.0}, "time_between_sampling": 0.0017110237422401017, "env_to_module_sum_episodes_length_in": 10.36823839457432, "rlmodule_inference_timer": 2.7485618581402388e-05, "episode_duration_sec_mean": 0.004547138668596746, "num_env_steps_sampled_lifetime": -7400000.0, "episode_len_max": 20, "episode_len_mean": 20.0, "num_episodes": 250.0, "episode_return_max": 8.5, "num_agent_steps_sampled": {"default_agent": 5000.0}, "episode_len_min": 20, "episode_return_min": -11.5, "num_agent_steps_sampled_lifetime": {"default_agent": -7400000.0}, "num_env_steps_sampled_lifetime_throughput": 3727.022429501778}, "learners": {"__all_modules__": {"num_env_steps_trained": 31500, "learner_connector": {"timers": {"connectors": {"add_one_ts_to_episodes_and_truncate": 0.008672692745403799, "add_columns_from_episodes_to_train_batch": 0.03443683410005187, "general_advantage_estimation": 0.006502180267433251, "add_states_from_episodes_to_batch": 3.698984478624209e-06, "add_time_dim_to_batch_and_zero_pad": 1.2561121981394384e-05, "batch_individual_items": 0.03428360648719705, "numpy_to_tensor": 6.943146399333786e-05, "add_observations_from_episodes_to_batch": 0.000809295599404267}}, "connector_pipeline_timer": 0.08492473171149063}, "num_module_steps_trained_lifetime": 84000, "learner_connector_sum_episodes_length_in": 5000.0, "num_module_steps_trained": 6000, "learner_connector_sum_episodes_length_out": 5250.0, "num_env_steps_trained_lifetime": 441000, "num_non_trainable_parameters": 0, "num_trainable_parameters": 6003, "num_env_steps_trained_lifetime_throughput": 2144346.7210552203, "num_module_steps_trained_throughput": 410140.85264923767, "num_module_steps_trained_lifetime_throughput": 409488.103425522}, "default_policy": {"mean_kl_loss": 0.00028114247834309936, "curr_kl_coeff": 4.5562519517261535e-05, "module_train_batch_size_mean": 1000.0, "weights_seq_no": 14.0, "default_optimizer_learning_rate": 0.0002847858517, "num_trainable_parameters": 6003, "num_module_steps_trained_lifetime": 84000, "entropy": 0.5194522738456726, "curr_entropy_coeff": 0.0090570820258, "num_module_steps_trained": 6000, "policy_loss": 0.07163506746292114, "vf_loss": 0.10278083384037018, "total_loss": 0.1356709897518158, "diff_num_grad_updates_vs_sampler_policy": 1.0, "vf_loss_unclipped": 27.039745330810547, "vf_explained_var": 0.005130410194396973, "gradients_default_optimizer_global_norm": 0.035145506262779236, "num_module_steps_trained_lifetime_throughput": 410773.13019104296}}, "num_training_step_calls_per_iteration": 1, "evaluation": {"env_runners": {"module_to_env_connector": {"timers": {"connectors": {"un_batch_to_individual_items": 5.27594948811521e-06, "get_actions": 3.655223834139751e-05, "tensor_to_numpy": 1.3039589956408046e-05, "listify_data_for_vector_env": 1.0831096304209905e-05, "normalize_and_clip_actions": 9.26749488259374e-06, "remove_single_ts_time_rank_from_batch": 5.62526971440768e-07}}, "connector_pipeline_timer": 0.00010087422913426927}, "env_step_timer": 1.390528134356486e-05, "env_to_module_connector": {"timers": {"connectors": {"add_observations_from_episodes_to_batch": 2.78724064677731e-06, "add_time_dim_to_batch_and_zero_pad": 2.282115420223998e-06, "batch_individual_items": 6.148509473059572e-06, "add_states_from_episodes_to_batch": 1.6041894377763569e-06, "numpy_to_tensor": 8.290146055820208e-06}}, "connector_pipeline_timer": 4.2212828085900356e-05}, "episode_duration_sec_mean": 0.004450009575812146, "num_episodes": 20, "episode_return_min": -14.5, "agent_episode_returns_mean": {"default_agent": 1.75}, "sample": 0.11249928980071194, "num_agent_steps_sampled_lifetime": {"default_agent": 5600}, "env_to_module_sum_episodes_length_out": 10.368238394574323, "num_env_steps_sampled": 400, "module_episode_returns_mean": {"default_policy": 1.75}, "rlmodule_inference_timer": 2.6944915293733402e-05, "episode_return_max": 14.5, "env_reset_timer": 0.0009610498043382084, "num_agent_steps_sampled": {"default_agent": 400}, "episode_return_mean": 1.75, "num_episodes_lifetime": 280, "weights_seq_no": 14.0, "env_to_module_sum_episodes_length_in": 10.368238394574323, "num_env_steps_sampled_lifetime": 70400, "num_module_steps_sampled": {"default_policy": 400}, "episode_len_max": 20, "episode_len_mean": 20.0, "episode_len_min": 20, "num_module_steps_sampled_lifetime": {"default_policy": 5600}, "time_between_sampling": 1.7613627532325717}, "num_healthy_workers": 1, "actor_manager_num_outstanding_async_reqs": 0, "num_remote_worker_restarts": 0}, "num_env_steps_sampled_lifetime": -7400000.0, "fault_tolerance": {"num_healthy_workers": 0, "num_remote_worker_restarts": 0}, "env_runner_group": {"actor_manager_num_outstanding_async_reqs": 0}, "done": false, "training_iteration": 14, "trial_id": "4d657_00000", "date": "2025-08-11_19-21-17", "timestamp": 1754932877, "time_this_iter_s": 1.6682929992675781, "time_total_s": 25.610650777816772, "pid": 14261, "hostname": "Mac", "node_ip": "127.0.0.1", "config": {"exploration_config": {}, "extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "placement_strategy": "PACK", "num_gpus": 0, "_fake_gpus": false, "num_cpus_for_main_process": 2, "eager_tracing": true, "eager_max_retraces": 20, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "torch_compile_learner": false, "torch_compile_learner_what_to_compile": "forward_train", "torch_compile_learner_dynamo_backend": "aot_eager", "torch_compile_learner_dynamo_mode": null, "torch_compile_worker": false, "torch_compile_worker_dynamo_backend": "aot_eager", "torch_compile_worker_dynamo_mode": null, "torch_ddp_kwargs": {}, "torch_skip_nan_gradients": false, "env": "Umbrella", "env_config": {}, "observation_space": null, "action_space": null, "clip_rewards": null, "normalize_actions": true, "clip_actions": false, "_is_atari": null, "disable_env_checking": false, "render_env": false, "action_mask_key": "action_mask", "env_runner_cls": null, "num_env_runners": 0, "create_local_env_runner": true, "num_envs_per_env_runner": 1, "gym_env_vectorize_mode": "SYNC", "num_cpus_per_env_runner": 1, "num_gpus_per_env_runner": 0, "custom_resources_per_env_runner": {}, "validate_env_runners_after_construction": true, "episodes_to_numpy": true, "max_requests_in_flight_per_env_runner": 1, "sample_timeout_s": 60.0, "_env_to_module_connector": null, "add_default_connectors_to_env_to_module_pipeline": true, "_module_to_env_connector": null, "add_default_connectors_to_module_to_env_pipeline": true, "merge_env_runner_states": "training_only", "broadcast_env_runner_states": true, "episode_lookback_horizon": 1, "rollout_fragment_length": "auto", "batch_mode": "complete_episodes", "compress_observations": false, "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "enable_tf1_exec_eagerly": false, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "preprocessor_pref": "deepmind", "observation_filter": "NoFilter", "update_worker_filter_stats": true, "use_worker_filter_stats": true, "sampler_perf_stats_ema_coef": null, "_is_online": true, "num_learners": 0, "num_gpus_per_learner": 0, "num_cpus_per_learner": "auto", "num_aggregator_actors_per_learner": 0, "max_requests_in_flight_per_aggregator_actor": 3, "local_gpu_idx": 0, "max_requests_in_flight_per_learner": 3, "gamma": 1, "lr": 0.0002847858517, "grad_clip": 0.5, "grad_clip_by": "global_norm", "_train_batch_size_per_learner": 5000, "train_batch_size": 4000, "num_epochs": 1, "minibatch_size": 1000, "shuffle_batch_per_epoch": true, "model": {"fcnet_hiddens": [256, 256], "fcnet_activation": "tanh", "fcnet_weights_initializer": null, "fcnet_weights_initializer_config": null, "fcnet_bias_initializer": null, "fcnet_bias_initializer_config": null, "conv_filters": null, "conv_activation": "relu", "conv_kernel_initializer": null, "conv_kernel_initializer_config": null, "conv_bias_initializer": null, "conv_bias_initializer_config": null, "conv_transpose_kernel_initializer": null, "conv_transpose_kernel_initializer_config": null, "conv_transpose_bias_initializer": null, "conv_transpose_bias_initializer_config": null, "post_fcnet_hiddens": [], "post_fcnet_activation": "relu", "post_fcnet_weights_initializer": null, "post_fcnet_weights_initializer_config": null, "post_fcnet_bias_initializer": null, "post_fcnet_bias_initializer_config": null, "free_log_std": false, "log_std_clip_param": 20.0, "no_final_linear": false, "vf_share_layers": false, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "lstm_weights_initializer": null, "lstm_weights_initializer_config": null, "lstm_bias_initializer": null, "lstm_bias_initializer_config": null, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "attention_use_n_prev_actions": 0, "attention_use_n_prev_rewards": 0, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": null, "custom_model_config": {}, "custom_action_dist": null, "custom_preprocessor": null, "encoder_latent_dim": null, "always_check_shapes": false, "lstm_use_prev_action_reward": -1, "_use_default_native_models": -1, "_disable_preprocessor_api": false, "_disable_action_flattening": false}, "_learner_connector": null, "add_default_connectors_to_learner_pipeline": true, "learner_config_dict": {}, "optimizer": {}, "_learner_class": null, "callbacks_on_algorithm_init": null, "callbacks_on_env_runners_recreated": null, "callbacks_on_offline_eval_runners_recreated": null, "callbacks_on_checkpoint_loaded": null, "callbacks_on_environment_created": null, "callbacks_on_episode_created": null, "callbacks_on_episode_start": null, "callbacks_on_episode_step": null, "callbacks_on_episode_end": null, "callbacks_on_evaluate_start": null, "callbacks_on_evaluate_end": null, "callbacks_on_evaluate_offline_start": null, "callbacks_on_evaluate_offline_end": null, "callbacks_on_sample_end": null, "callbacks_on_train_result": null, "explore": true, "enable_rl_module_and_learner": true, "enable_env_runner_and_connector_v2": true, "_prior_exploration_config": {"type": "StochasticSampling"}, "count_steps_by": "env_steps", "policy_map_capacity": 100, "policy_mapping_fn": "<function AlgorithmConfig.DEFAULT_POLICY_MAPPING_FN at 0x1680e9b20>", "policies_to_train": null, "policy_states_are_swappable": false, "observation_fn": null, "offline_data_class": null, "input_read_method": "read_parquet", "input_read_method_kwargs": {}, "input_read_schema": {}, "input_read_episodes": false, "input_read_sample_batches": false, "input_read_batch_size": null, "input_filesystem": null, "input_filesystem_kwargs": {}, "input_compress_columns": ["obs", "new_obs"], "input_spaces_jsonable": true, "materialize_data": false, "materialize_mapped_data": true, "map_batches_kwargs": {}, "iter_batches_kwargs": {}, "ignore_final_observation": false, "prelearner_class": null, "prelearner_buffer_class": null, "prelearner_buffer_kwargs": {}, "prelearner_module_synch_period": 10, "dataset_num_iters_per_learner": null, "input_config": {}, "actions_in_input_normalized": false, "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_config": {}, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "output_max_rows_per_file": null, "output_write_remaining_data": false, "output_write_method": "write_parquet", "output_write_method_kwargs": {}, "output_filesystem": null, "output_filesystem_kwargs": {}, "output_write_episodes": true, "offline_sampling": false, "evaluation_interval": 1, "evaluation_duration": 20, "evaluation_duration_unit": "episodes", "evaluation_sample_timeout_s": 120.0, "evaluation_auto_duration_min_env_steps_per_sample": 100, "evaluation_auto_duration_max_env_steps_per_sample": 2000, "evaluation_parallel_to_training": false, "evaluation_force_reset_envs_before_iteration": true, "evaluation_config": null, "off_policy_estimation_methods": {}, "ope_split_batch_by_episode": true, "evaluation_num_env_runners": 1, "in_evaluation": false, "sync_filters_on_rollout_workers_timeout_s": 10.0, "offline_evaluation_interval": null, "num_offline_eval_runners": 0, "offline_loss_for_module_fn": null, "offline_evaluation_duration": 1, "offline_evaluation_parallel_to_training": false, "offline_evaluation_timeout_s": 120.0, "num_cpus_per_offline_eval_runner": 1, "num_gpus_per_offline_eval_runner": 0, "custom_resources_per_offline_eval_runner": {}, "restart_failed_offline_eval_runners": true, "ignore_offline_eval_runner_failures": false, "max_num_offline_eval_runner_restarts": 1000, "offline_eval_runner_restore_timeout_s": 1800.0, "max_requests_in_flight_per_offline_eval_runner": 1, "validate_offline_eval_runners_after_construction": true, "offline_eval_runner_health_probe_timeout_s": 30.0, "offline_eval_rl_module_inference_only": false, "broadcast_offline_eval_runner_states": false, "offline_eval_batch_size_per_runner": 256, "dataset_num_iters_per_eval_runner": 1, "keep_per_episode_custom_metrics": false, "metrics_episode_collection_timeout_s": 60.0, "metrics_num_episodes_for_smoothing": 100, "min_time_s_per_iteration": null, "min_train_timesteps_per_iteration": 0, "min_sample_timesteps_per_iteration": 0, "log_gradients": true, "export_native_model_files": false, "checkpoint_trainable_policies_only": false, "logger_creator": null, "logger_config": null, "log_level": "WARN", "log_sys_usage": true, "fake_sampler": false, "seed": 8, "restart_failed_env_runners": true, "ignore_env_runner_failures": false, "max_num_env_runner_restarts": 1000, "delay_between_env_runner_restarts_s": 60.0, "restart_failed_sub_environments": false, "num_consecutive_env_runner_failures_tolerance": 100, "env_runner_health_probe_timeout_s": 30.0, "env_runner_restore_timeout_s": 1800.0, "_model_config": {}, "_rl_module_spec": "RLModuleSpec(module_class=None, observation_space=None, action_space=None, inference_only=False, learner_only=False, model_config=DefaultModelConfig(fcnet_hiddens=[60, 90], fcnet_activation='tanh', fcnet_kernel_initializer=None, fcnet_kernel_initializer_kwargs=None, fcnet_bias_initializer=None, fcnet_bias_initializer_kwargs=None, conv_filters=None, conv_activation='relu', conv_kernel_initializer=None, conv_kernel_initializer_kwargs=None, conv_bias_initializer=None, conv_bias_initializer_kwargs=None, head_fcnet_hiddens=[], head_fcnet_activation='relu', head_fcnet_kernel_initializer=None, head_fcnet_kernel_initializer_kwargs=None, head_fcnet_bias_initializer=None, head_fcnet_bias_initializer_kwargs=None, free_log_std=False, log_std_clip_param=20.0, vf_share_layers=True, use_lstm=False, max_seq_len=20, lstm_cell_size=256, lstm_use_prev_action=False, lstm_use_prev_reward=False, lstm_kernel_initializer=None, lstm_kernel_initializer_kwargs=None, lstm_bias_initializer=None, lstm_bias_initializer_kwargs=None), catalog_class=None, load_state_path=None, model_config_dict=None)", "algorithm_config_overrides_per_module": {}, "_per_module_overrides": {}, "_validate_config": true, "_use_msgpack_checkpoints": false, "_torch_grad_scaler_class": null, "_torch_lr_scheduler_classes": null, "_tf_policy_handles_more_than_one_loss": false, "_disable_preprocessor_api": false, "_disable_action_flattening": false, "_disable_initialize_loss_from_dummy_batch": false, "_dont_auto_sync_env_runner_states": false, "env_task_fn": -1, "enable_connectors": -1, "simple_optimizer": false, "policy_map_cache": -1, "worker_cls": -1, "synchronize_filters": -1, "enable_async_evaluation": -1, "custom_async_evaluation_function": -1, "_enable_rl_module_api": -1, "auto_wrap_old_gym_envs": -1, "always_attach_evaluation_results": -1, "replay_sequence_length": null, "_disable_execution_plan_api": -1, "use_critic": true, "use_gae": true, "use_kl_loss": true, "kl_coeff": 0.7464963036515, "kl_target": 0.0270990929592, "vf_loss_coeff": 0.6688075857018, "entropy_coeff": 0.0090570820258, "clip_param": 0.1221781641624, "vf_clip_param": 0.1027808522125, "entropy_coeff_schedule": null, "lr_schedule": null, "sgd_minibatch_size": -1, "vf_share_layers": -1, "__stdout_file__": null, "__stderr_file__": null, "lambda": 0.9099046732075, "input": "sampler", "policies": {"default_policy": [null, null, null, null]}, "callbacks": "<class 'ray.rllib.callbacks.callbacks.RLlibCallback'>", "create_env_on_driver": false, "custom_eval_function": null, "framework": "torch"}, "time_since_restore": 25.610650777816772, "iterations_since_restore": 14, "perf": {"cpu_util_percent": 43.55, "ram_util_percent": 82.85}}
{"timers": {"training_iteration": 2.249004350124384, "restore_env_runners": 1.4042924455458914e-05, "training_step": 2.2488499555284256, "env_runner_sampling_timer": 2.134115293933299, "learner_update_timer": 0.11134488751036137, "synch_weights": 0.0007545296679941603, "restore_eval_env_runners": 1.1691183174115978e-05, "evaluation_iteration": 0.12667283101576018, "synch_eval_env_connectors": 0.00013543033938880146, "synch_env_connectors": 4.758536801270375e-06}, "env_runners": {"sample": 0.004872812778327629, "module_episode_returns_mean": {"default_policy": 5.460000000000001}, "env_to_module_connector": {"timers": {"connectors": {"add_states_from_episodes_to_batch": 1.753448814177547e-06, "numpy_to_tensor": 8.562281855150254e-06, "add_observations_from_episodes_to_batch": 3.0350024273445897e-06, "add_time_dim_to_batch_and_zero_pad": 2.3893685799216023e-06, "batch_individual_items": 6.402342222349266e-06}}, "connector_pipeline_timer": 4.38421901640963e-05}, "env_reset_timer": 3.642913613395557e-05, "module_to_env_connector": {"timers": {"connectors": {"tensor_to_numpy": 1.3172106710865242e-05, "normalize_and_clip_actions": 9.429441604746901e-06, "listify_data_for_vector_env": 1.1172321217156243e-05, "remove_single_ts_time_rank_from_batch": 6.009393432705736e-07, "un_batch_to_individual_items": 5.49705354580581e-06, "get_actions": 3.802431652564262e-05}}, "connector_pipeline_timer": 0.0001035106590245533}, "num_module_steps_sampled": {"default_policy": 5000.0}, "weights_seq_no": 14.0, "agent_episode_returns_mean": {"default_agent": 5.460000000000001}, "env_to_module_sum_episodes_length_out": 10.36823839457432, "env_step_timer": 1.39239248248178e-05, "num_env_steps_sampled": 5000.0, "episode_return_mean": 5.460000000000001, "num_episodes_lifetime": -400875.0, "num_module_steps_sampled_lifetime": {"default_policy": -8017500.0}, "time_between_sampling": 0.0018399362311093046, "env_to_module_sum_episodes_length_in": 10.36823839457432, "rlmodule_inference_timer": 2.7050203808666656e-05, "episode_duration_sec_mean": 0.004541494662873446, "num_env_steps_sampled_lifetime": -8017500.0, "episode_len_max": 20, "episode_len_mean": 20.0, "num_episodes": 250.0, "episode_return_max": 8.5, "num_agent_steps_sampled": {"default_agent": 5000.0}, "episode_len_min": 20, "episode_return_min": -11.5, "num_agent_steps_sampled_lifetime": {"default_agent": -8017500.0}, "num_env_steps_sampled_lifetime_throughput": 3723.8013520116}, "learners": {"__all_modules__": {"num_env_steps_trained": 31500, "learner_connector": {"timers": {"connectors": {"add_one_ts_to_episodes_and_truncate": 0.00866184165763392, "add_columns_from_episodes_to_train_batch": 0.03443179367927959, "general_advantage_estimation": 0.006497523874349222, "add_states_from_episodes_to_batch": 3.6890740018481303e-06, "add_time_dim_to_batch_and_zero_pad": 1.2529670966333719e-05, "batch_individual_items": 0.03518918500280248, "numpy_to_tensor": 6.933756952479942e-05, "add_observations_from_episodes_to_batch": 0.0008093913937722481}}, "connector_pipeline_timer": 0.08580926523408902}, "num_module_steps_trained_lifetime": 90000, "learner_connector_sum_episodes_length_in": 5000.0, "num_module_steps_trained": 6000, "learner_connector_sum_episodes_length_out": 5250.0, "num_env_steps_trained_lifetime": 472500, "num_non_trainable_parameters": 0, "num_trainable_parameters": 6003, "num_env_steps_trained_lifetime_throughput": 2142842.202641872, "num_module_steps_trained_throughput": 409784.26777352055, "num_module_steps_trained_lifetime_throughput": 409153.6487320429}, "default_policy": {"mean_kl_loss": 0.0002160034200642258, "curr_kl_coeff": 2.2781259758630767e-05, "module_train_batch_size_mean": 1000.0, "weights_seq_no": 15.0, "default_optimizer_learning_rate": 0.0002847858517, "num_trainable_parameters": 6003, "num_module_steps_trained_lifetime": 90000, "entropy": 0.512681782245636, "curr_entropy_coeff": 0.0090570820258, "num_module_steps_trained": 6000, "policy_loss": -0.10267102718353271, "vf_loss": 0.10278083384037018, "total_loss": -0.03857382386922836, "diff_num_grad_updates_vs_sampler_policy": 1.0, "vf_loss_unclipped": 26.506343841552734, "vf_explained_var": 0.005217373371124268, "gradients_default_optimizer_global_norm": 0.0580829381942749, "num_module_steps_trained_lifetime_throughput": 410356.9169941314}}, "num_training_step_calls_per_iteration": 1, "evaluation": {"env_runners": {"module_to_env_connector": {"timers": {"connectors": {"un_batch_to_individual_items": 5.23657998578645e-06, "get_actions": 3.578166948421197e-05, "tensor_to_numpy": 1.2913133763219154e-05, "listify_data_for_vector_env": 1.0720992257482493e-05, "normalize_and_clip_actions": 9.163818048975051e-06, "remove_single_ts_time_rank_from_batch": 5.739442895729825e-07}}, "connector_pipeline_timer": 9.925950627582212e-05}, "env_step_timer": 1.3520565650693132e-05, "env_to_module_connector": {"timers": {"connectors": {"add_observations_from_episodes_to_batch": 2.7488685342332983e-06, "add_time_dim_to_batch_and_zero_pad": 2.253462237920774e-06, "batch_individual_items": 6.0535666318420114e-06, "add_states_from_episodes_to_batch": 1.5873685684772719e-06, "numpy_to_tensor": 8.158909253409329e-06}}, "connector_pipeline_timer": 4.172923136720735e-05}, "episode_duration_sec_mean": 0.004455251633189618, "num_episodes": 20, "episode_return_min": -13.5, "agent_episode_returns_mean": {"default_agent": 1.95}, "sample": 0.11233731357313491, "num_agent_steps_sampled_lifetime": {"default_agent": 6000}, "env_to_module_sum_episodes_length_out": 10.368238394574323, "num_env_steps_sampled": 400, "module_episode_returns_mean": {"default_policy": 1.95}, "rlmodule_inference_timer": 2.694429590951815e-05, "episode_return_max": 14.5, "env_reset_timer": 0.0009523626357934451, "num_agent_steps_sampled": {"default_agent": 400}, "episode_return_mean": 1.95, "num_episodes_lifetime": 300, "weights_seq_no": 15.0, "env_to_module_sum_episodes_length_in": 10.368238394574323, "num_env_steps_sampled_lifetime": 75400, "num_module_steps_sampled": {"default_policy": 400}, "episode_len_max": 20, "episode_len_mean": 20.0, "episode_len_min": 20, "num_module_steps_sampled_lifetime": {"default_policy": 6000}, "time_between_sampling": 1.7596548119504354}, "num_healthy_workers": 1, "actor_manager_num_outstanding_async_reqs": 0, "num_remote_worker_restarts": 0}, "num_env_steps_sampled_lifetime": -8017500.0, "fault_tolerance": {"num_healthy_workers": 0, "num_remote_worker_restarts": 0}, "env_runner_group": {"actor_manager_num_outstanding_async_reqs": 0}, "done": false, "training_iteration": 15, "trial_id": "4d657_00000", "date": "2025-08-11_19-21-19", "timestamp": 1754932879, "time_this_iter_s": 1.6765592098236084, "time_total_s": 27.28720998764038, "pid": 14261, "hostname": "Mac", "node_ip": "127.0.0.1", "config": {"exploration_config": {}, "extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "placement_strategy": "PACK", "num_gpus": 0, "_fake_gpus": false, "num_cpus_for_main_process": 2, "eager_tracing": true, "eager_max_retraces": 20, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "torch_compile_learner": false, "torch_compile_learner_what_to_compile": "forward_train", "torch_compile_learner_dynamo_backend": "aot_eager", "torch_compile_learner_dynamo_mode": null, "torch_compile_worker": false, "torch_compile_worker_dynamo_backend": "aot_eager", "torch_compile_worker_dynamo_mode": null, "torch_ddp_kwargs": {}, "torch_skip_nan_gradients": false, "env": "Umbrella", "env_config": {}, "observation_space": null, "action_space": null, "clip_rewards": null, "normalize_actions": true, "clip_actions": false, "_is_atari": null, "disable_env_checking": false, "render_env": false, "action_mask_key": "action_mask", "env_runner_cls": null, "num_env_runners": 0, "create_local_env_runner": true, "num_envs_per_env_runner": 1, "gym_env_vectorize_mode": "SYNC", "num_cpus_per_env_runner": 1, "num_gpus_per_env_runner": 0, "custom_resources_per_env_runner": {}, "validate_env_runners_after_construction": true, "episodes_to_numpy": true, "max_requests_in_flight_per_env_runner": 1, "sample_timeout_s": 60.0, "_env_to_module_connector": null, "add_default_connectors_to_env_to_module_pipeline": true, "_module_to_env_connector": null, "add_default_connectors_to_module_to_env_pipeline": true, "merge_env_runner_states": "training_only", "broadcast_env_runner_states": true, "episode_lookback_horizon": 1, "rollout_fragment_length": "auto", "batch_mode": "complete_episodes", "compress_observations": false, "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "enable_tf1_exec_eagerly": false, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "preprocessor_pref": "deepmind", "observation_filter": "NoFilter", "update_worker_filter_stats": true, "use_worker_filter_stats": true, "sampler_perf_stats_ema_coef": null, "_is_online": true, "num_learners": 0, "num_gpus_per_learner": 0, "num_cpus_per_learner": "auto", "num_aggregator_actors_per_learner": 0, "max_requests_in_flight_per_aggregator_actor": 3, "local_gpu_idx": 0, "max_requests_in_flight_per_learner": 3, "gamma": 1, "lr": 0.0002847858517, "grad_clip": 0.5, "grad_clip_by": "global_norm", "_train_batch_size_per_learner": 5000, "train_batch_size": 4000, "num_epochs": 1, "minibatch_size": 1000, "shuffle_batch_per_epoch": true, "model": {"fcnet_hiddens": [256, 256], "fcnet_activation": "tanh", "fcnet_weights_initializer": null, "fcnet_weights_initializer_config": null, "fcnet_bias_initializer": null, "fcnet_bias_initializer_config": null, "conv_filters": null, "conv_activation": "relu", "conv_kernel_initializer": null, "conv_kernel_initializer_config": null, "conv_bias_initializer": null, "conv_bias_initializer_config": null, "conv_transpose_kernel_initializer": null, "conv_transpose_kernel_initializer_config": null, "conv_transpose_bias_initializer": null, "conv_transpose_bias_initializer_config": null, "post_fcnet_hiddens": [], "post_fcnet_activation": "relu", "post_fcnet_weights_initializer": null, "post_fcnet_weights_initializer_config": null, "post_fcnet_bias_initializer": null, "post_fcnet_bias_initializer_config": null, "free_log_std": false, "log_std_clip_param": 20.0, "no_final_linear": false, "vf_share_layers": false, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "lstm_weights_initializer": null, "lstm_weights_initializer_config": null, "lstm_bias_initializer": null, "lstm_bias_initializer_config": null, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "attention_use_n_prev_actions": 0, "attention_use_n_prev_rewards": 0, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": null, "custom_model_config": {}, "custom_action_dist": null, "custom_preprocessor": null, "encoder_latent_dim": null, "always_check_shapes": false, "lstm_use_prev_action_reward": -1, "_use_default_native_models": -1, "_disable_preprocessor_api": false, "_disable_action_flattening": false}, "_learner_connector": null, "add_default_connectors_to_learner_pipeline": true, "learner_config_dict": {}, "optimizer": {}, "_learner_class": null, "callbacks_on_algorithm_init": null, "callbacks_on_env_runners_recreated": null, "callbacks_on_offline_eval_runners_recreated": null, "callbacks_on_checkpoint_loaded": null, "callbacks_on_environment_created": null, "callbacks_on_episode_created": null, "callbacks_on_episode_start": null, "callbacks_on_episode_step": null, "callbacks_on_episode_end": null, "callbacks_on_evaluate_start": null, "callbacks_on_evaluate_end": null, "callbacks_on_evaluate_offline_start": null, "callbacks_on_evaluate_offline_end": null, "callbacks_on_sample_end": null, "callbacks_on_train_result": null, "explore": true, "enable_rl_module_and_learner": true, "enable_env_runner_and_connector_v2": true, "_prior_exploration_config": {"type": "StochasticSampling"}, "count_steps_by": "env_steps", "policy_map_capacity": 100, "policy_mapping_fn": "<function AlgorithmConfig.DEFAULT_POLICY_MAPPING_FN at 0x1680e9b20>", "policies_to_train": null, "policy_states_are_swappable": false, "observation_fn": null, "offline_data_class": null, "input_read_method": "read_parquet", "input_read_method_kwargs": {}, "input_read_schema": {}, "input_read_episodes": false, "input_read_sample_batches": false, "input_read_batch_size": null, "input_filesystem": null, "input_filesystem_kwargs": {}, "input_compress_columns": ["obs", "new_obs"], "input_spaces_jsonable": true, "materialize_data": false, "materialize_mapped_data": true, "map_batches_kwargs": {}, "iter_batches_kwargs": {}, "ignore_final_observation": false, "prelearner_class": null, "prelearner_buffer_class": null, "prelearner_buffer_kwargs": {}, "prelearner_module_synch_period": 10, "dataset_num_iters_per_learner": null, "input_config": {}, "actions_in_input_normalized": false, "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_config": {}, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "output_max_rows_per_file": null, "output_write_remaining_data": false, "output_write_method": "write_parquet", "output_write_method_kwargs": {}, "output_filesystem": null, "output_filesystem_kwargs": {}, "output_write_episodes": true, "offline_sampling": false, "evaluation_interval": 1, "evaluation_duration": 20, "evaluation_duration_unit": "episodes", "evaluation_sample_timeout_s": 120.0, "evaluation_auto_duration_min_env_steps_per_sample": 100, "evaluation_auto_duration_max_env_steps_per_sample": 2000, "evaluation_parallel_to_training": false, "evaluation_force_reset_envs_before_iteration": true, "evaluation_config": null, "off_policy_estimation_methods": {}, "ope_split_batch_by_episode": true, "evaluation_num_env_runners": 1, "in_evaluation": false, "sync_filters_on_rollout_workers_timeout_s": 10.0, "offline_evaluation_interval": null, "num_offline_eval_runners": 0, "offline_loss_for_module_fn": null, "offline_evaluation_duration": 1, "offline_evaluation_parallel_to_training": false, "offline_evaluation_timeout_s": 120.0, "num_cpus_per_offline_eval_runner": 1, "num_gpus_per_offline_eval_runner": 0, "custom_resources_per_offline_eval_runner": {}, "restart_failed_offline_eval_runners": true, "ignore_offline_eval_runner_failures": false, "max_num_offline_eval_runner_restarts": 1000, "offline_eval_runner_restore_timeout_s": 1800.0, "max_requests_in_flight_per_offline_eval_runner": 1, "validate_offline_eval_runners_after_construction": true, "offline_eval_runner_health_probe_timeout_s": 30.0, "offline_eval_rl_module_inference_only": false, "broadcast_offline_eval_runner_states": false, "offline_eval_batch_size_per_runner": 256, "dataset_num_iters_per_eval_runner": 1, "keep_per_episode_custom_metrics": false, "metrics_episode_collection_timeout_s": 60.0, "metrics_num_episodes_for_smoothing": 100, "min_time_s_per_iteration": null, "min_train_timesteps_per_iteration": 0, "min_sample_timesteps_per_iteration": 0, "log_gradients": true, "export_native_model_files": false, "checkpoint_trainable_policies_only": false, "logger_creator": null, "logger_config": null, "log_level": "WARN", "log_sys_usage": true, "fake_sampler": false, "seed": 8, "restart_failed_env_runners": true, "ignore_env_runner_failures": false, "max_num_env_runner_restarts": 1000, "delay_between_env_runner_restarts_s": 60.0, "restart_failed_sub_environments": false, "num_consecutive_env_runner_failures_tolerance": 100, "env_runner_health_probe_timeout_s": 30.0, "env_runner_restore_timeout_s": 1800.0, "_model_config": {}, "_rl_module_spec": "RLModuleSpec(module_class=None, observation_space=None, action_space=None, inference_only=False, learner_only=False, model_config=DefaultModelConfig(fcnet_hiddens=[60, 90], fcnet_activation='tanh', fcnet_kernel_initializer=None, fcnet_kernel_initializer_kwargs=None, fcnet_bias_initializer=None, fcnet_bias_initializer_kwargs=None, conv_filters=None, conv_activation='relu', conv_kernel_initializer=None, conv_kernel_initializer_kwargs=None, conv_bias_initializer=None, conv_bias_initializer_kwargs=None, head_fcnet_hiddens=[], head_fcnet_activation='relu', head_fcnet_kernel_initializer=None, head_fcnet_kernel_initializer_kwargs=None, head_fcnet_bias_initializer=None, head_fcnet_bias_initializer_kwargs=None, free_log_std=False, log_std_clip_param=20.0, vf_share_layers=True, use_lstm=False, max_seq_len=20, lstm_cell_size=256, lstm_use_prev_action=False, lstm_use_prev_reward=False, lstm_kernel_initializer=None, lstm_kernel_initializer_kwargs=None, lstm_bias_initializer=None, lstm_bias_initializer_kwargs=None), catalog_class=None, load_state_path=None, model_config_dict=None)", "algorithm_config_overrides_per_module": {}, "_per_module_overrides": {}, "_validate_config": true, "_use_msgpack_checkpoints": false, "_torch_grad_scaler_class": null, "_torch_lr_scheduler_classes": null, "_tf_policy_handles_more_than_one_loss": false, "_disable_preprocessor_api": false, "_disable_action_flattening": false, "_disable_initialize_loss_from_dummy_batch": false, "_dont_auto_sync_env_runner_states": false, "env_task_fn": -1, "enable_connectors": -1, "simple_optimizer": false, "policy_map_cache": -1, "worker_cls": -1, "synchronize_filters": -1, "enable_async_evaluation": -1, "custom_async_evaluation_function": -1, "_enable_rl_module_api": -1, "auto_wrap_old_gym_envs": -1, "always_attach_evaluation_results": -1, "replay_sequence_length": null, "_disable_execution_plan_api": -1, "use_critic": true, "use_gae": true, "use_kl_loss": true, "kl_coeff": 0.7464963036515, "kl_target": 0.0270990929592, "vf_loss_coeff": 0.6688075857018, "entropy_coeff": 0.0090570820258, "clip_param": 0.1221781641624, "vf_clip_param": 0.1027808522125, "entropy_coeff_schedule": null, "lr_schedule": null, "sgd_minibatch_size": -1, "vf_share_layers": -1, "__stdout_file__": null, "__stderr_file__": null, "lambda": 0.9099046732075, "input": "sampler", "policies": {"default_policy": [null, null, null, null]}, "callbacks": "<class 'ray.rllib.callbacks.callbacks.RLlibCallback'>", "create_env_on_driver": false, "custom_eval_function": null, "framework": "torch"}, "time_since_restore": 27.28720998764038, "iterations_since_restore": 15, "perf": {"cpu_util_percent": 43.400000000000006, "ram_util_percent": 83.9}}
{"timers": {"training_iteration": 2.2411214570439193, "restore_env_runners": 1.3959584120575036e-05, "training_step": 2.240966815972837, "env_runner_sampling_timer": 2.126415925994184, "learner_update_timer": 0.11116352280472938, "synch_weights": 0.0007535106212407559, "restore_eval_env_runners": 1.164052097372009e-05, "evaluation_iteration": 0.1264319156248542, "synch_eval_env_connectors": 0.00013501853676873074, "synch_env_connectors": 4.755540829823824e-06}, "env_runners": {"sample": 0.004791385310577507, "module_episode_returns_mean": {"default_policy": 5.619999999999999}, "env_to_module_connector": {"timers": {"connectors": {"add_states_from_episodes_to_batch": 1.7340273183640304e-06, "numpy_to_tensor": 8.427663710425218e-06, "add_observations_from_episodes_to_batch": 2.950135499756897e-06, "add_time_dim_to_batch_and_zero_pad": 2.353223181295984e-06, "batch_individual_items": 6.320907717376524e-06}}, "connector_pipeline_timer": 4.356142365084441e-05}, "env_reset_timer": 3.331457736517926e-05, "module_to_env_connector": {"timers": {"connectors": {"tensor_to_numpy": 1.2918224658405562e-05, "normalize_and_clip_actions": 9.394372531900773e-06, "listify_data_for_vector_env": 1.0999760867734398e-05, "remove_single_ts_time_rank_from_batch": 5.77909212238576e-07, "un_batch_to_individual_items": 5.44302524713658e-06, "get_actions": 3.748380772355857e-05}}, "connector_pipeline_timer": 0.00010224508854501589}, "num_module_steps_sampled": {"default_policy": 5000.0}, "weights_seq_no": 15.0, "agent_episode_returns_mean": {"default_agent": 5.619999999999999}, "env_to_module_sum_episodes_length_out": 10.36823839457432, "env_step_timer": 1.3845949969348301e-05, "num_env_steps_sampled": 5000.0, "episode_return_mean": 5.619999999999999, "num_episodes_lifetime": -431750.0, "num_module_steps_sampled_lifetime": {"default_policy": -8635000.0}, "time_between_sampling": 0.0018644537755784516, "env_to_module_sum_episodes_length_in": 10.36823839457432, "rlmodule_inference_timer": 2.6881572340543068e-05, "episode_duration_sec_mean": 0.0044963355031795785, "num_env_steps_sampled_lifetime": -8635000.0, "episode_len_max": 20, "episode_len_mean": 20.0, "num_episodes": 250.0, "episode_return_max": 8.5, "num_agent_steps_sampled": {"default_agent": 5000.0}, "episode_len_min": 20, "episode_return_min": -11.5, "num_agent_steps_sampled_lifetime": {"default_agent": -8635000.0}, "num_env_steps_sampled_lifetime_throughput": 3774.9855729166156}, "learners": {"__all_modules__": {"num_env_steps_trained": 31500, "learner_connector": {"timers": {"connectors": {"add_one_ts_to_episodes_and_truncate": 0.008654174071560015, "add_columns_from_episodes_to_train_batch": 0.03442705699176857, "general_advantage_estimation": 0.006487363636227332, "add_states_from_episodes_to_batch": 3.6805129303962334e-06, "add_time_dim_to_batch_and_zero_pad": 1.2494374941974786e-05, "batch_individual_items": 0.03514824440291407, "numpy_to_tensor": 6.91704446352572e-05, "add_observations_from_episodes_to_batch": 0.000809321228940158}}, "connector_pipeline_timer": 0.08574498258076145}, "num_module_steps_trained_lifetime": 96000, "learner_connector_sum_episodes_length_in": 5000.0, "num_module_steps_trained": 6000, "learner_connector_sum_episodes_length_out": 5250.0, "num_env_steps_trained_lifetime": 504000, "num_non_trainable_parameters": 0, "num_trainable_parameters": 6003, "num_env_steps_trained_lifetime_throughput": 2143101.649953896, "num_module_steps_trained_throughput": 409765.5342344337, "num_module_steps_trained_lifetime_throughput": 409156.5550040504}, "default_policy": {"mean_kl_loss": 0.00046676889178343117, "curr_kl_coeff": 1.1390629879315384e-05, "module_train_batch_size_mean": 1000.0, "weights_seq_no": 16.0, "default_optimizer_learning_rate": 0.0002847858517, "num_trainable_parameters": 6003, "num_module_steps_trained_lifetime": 96000, "entropy": 0.49951738119125366, "curr_entropy_coeff": 0.0090570820258, "num_module_steps_trained": 6000, "policy_loss": -0.2068527191877365, "vf_loss": 0.10278083384037018, "total_loss": -0.1426362693309784, "diff_num_grad_updates_vs_sampler_policy": 1.0, "vf_loss_unclipped": 26.065872192382812, "vf_explained_var": 0.004887521266937256, "gradients_default_optimizer_global_norm": 0.03795118257403374, "num_module_steps_trained_lifetime_throughput": 410282.0102787544}}, "num_training_step_calls_per_iteration": 1, "evaluation": {"env_runners": {"module_to_env_connector": {"timers": {"connectors": {"un_batch_to_individual_items": 5.2595554782476175e-06, "get_actions": 3.546237701073514e-05, "tensor_to_numpy": 1.2918497472482078e-05, "listify_data_for_vector_env": 1.0716324923773175e-05, "normalize_and_clip_actions": 9.184832356785673e-06, "remove_single_ts_time_rank_from_batch": 5.629512193496268e-07}}, "connector_pipeline_timer": 9.912960919381107e-05}, "env_step_timer": 1.3427718168996266e-05, "env_to_module_connector": {"timers": {"connectors": {"add_observations_from_episodes_to_batch": 2.7402786362274333e-06, "add_time_dim_to_batch_and_zero_pad": 2.2170622138831313e-06, "batch_individual_items": 5.998716926865059e-06, "add_states_from_episodes_to_batch": 1.5534251822033528e-06, "numpy_to_tensor": 8.25107966340519e-06}}, "connector_pipeline_timer": 4.178596691964509e-05}, "episode_duration_sec_mean": 0.004438855767948553, "num_episodes": 20, "episode_return_min": -13.5, "agent_episode_returns_mean": {"default_agent": 1.75}, "sample": 0.11217333585790829, "num_agent_steps_sampled_lifetime": {"default_agent": 6400}, "env_to_module_sum_episodes_length_out": 10.368238394574323, "num_env_steps_sampled": 400, "module_episode_returns_mean": {"default_policy": 1.75}, "rlmodule_inference_timer": 2.6439814905806495e-05, "episode_return_max": 14.5, "env_reset_timer": 0.0009435106792763233, "num_agent_steps_sampled": {"default_agent": 400}, "episode_return_mean": 1.75, "num_episodes_lifetime": 320, "weights_seq_no": 16.0, "env_to_module_sum_episodes_length_in": 10.368238394574323, "num_env_steps_sampled_lifetime": 80400, "num_module_steps_sampled": {"default_policy": 400}, "episode_len_max": 20, "episode_len_mean": 20.0, "episode_len_min": 20, "num_module_steps_sampled_lifetime": {"default_policy": 6400}, "time_between_sampling": 1.756862912580927}, "num_healthy_workers": 1, "actor_manager_num_outstanding_async_reqs": 0, "num_remote_worker_restarts": 0}, "num_env_steps_sampled_lifetime": -8635000.0, "fault_tolerance": {"num_healthy_workers": 0, "num_remote_worker_restarts": 0}, "env_runner_group": {"actor_manager_num_outstanding_async_reqs": 0}, "done": false, "training_iteration": 16, "trial_id": "4d657_00000", "date": "2025-08-11_19-21-20", "timestamp": 1754932880, "time_this_iter_s": 1.5650041103363037, "time_total_s": 28.852214097976685, "pid": 14261, "hostname": "Mac", "node_ip": "127.0.0.1", "config": {"exploration_config": {}, "extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "placement_strategy": "PACK", "num_gpus": 0, "_fake_gpus": false, "num_cpus_for_main_process": 2, "eager_tracing": true, "eager_max_retraces": 20, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "torch_compile_learner": false, "torch_compile_learner_what_to_compile": "forward_train", "torch_compile_learner_dynamo_backend": "aot_eager", "torch_compile_learner_dynamo_mode": null, "torch_compile_worker": false, "torch_compile_worker_dynamo_backend": "aot_eager", "torch_compile_worker_dynamo_mode": null, "torch_ddp_kwargs": {}, "torch_skip_nan_gradients": false, "env": "Umbrella", "env_config": {}, "observation_space": null, "action_space": null, "clip_rewards": null, "normalize_actions": true, "clip_actions": false, "_is_atari": null, "disable_env_checking": false, "render_env": false, "action_mask_key": "action_mask", "env_runner_cls": null, "num_env_runners": 0, "create_local_env_runner": true, "num_envs_per_env_runner": 1, "gym_env_vectorize_mode": "SYNC", "num_cpus_per_env_runner": 1, "num_gpus_per_env_runner": 0, "custom_resources_per_env_runner": {}, "validate_env_runners_after_construction": true, "episodes_to_numpy": true, "max_requests_in_flight_per_env_runner": 1, "sample_timeout_s": 60.0, "_env_to_module_connector": null, "add_default_connectors_to_env_to_module_pipeline": true, "_module_to_env_connector": null, "add_default_connectors_to_module_to_env_pipeline": true, "merge_env_runner_states": "training_only", "broadcast_env_runner_states": true, "episode_lookback_horizon": 1, "rollout_fragment_length": "auto", "batch_mode": "complete_episodes", "compress_observations": false, "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "enable_tf1_exec_eagerly": false, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "preprocessor_pref": "deepmind", "observation_filter": "NoFilter", "update_worker_filter_stats": true, "use_worker_filter_stats": true, "sampler_perf_stats_ema_coef": null, "_is_online": true, "num_learners": 0, "num_gpus_per_learner": 0, "num_cpus_per_learner": "auto", "num_aggregator_actors_per_learner": 0, "max_requests_in_flight_per_aggregator_actor": 3, "local_gpu_idx": 0, "max_requests_in_flight_per_learner": 3, "gamma": 1, "lr": 0.0002847858517, "grad_clip": 0.5, "grad_clip_by": "global_norm", "_train_batch_size_per_learner": 5000, "train_batch_size": 4000, "num_epochs": 1, "minibatch_size": 1000, "shuffle_batch_per_epoch": true, "model": {"fcnet_hiddens": [256, 256], "fcnet_activation": "tanh", "fcnet_weights_initializer": null, "fcnet_weights_initializer_config": null, "fcnet_bias_initializer": null, "fcnet_bias_initializer_config": null, "conv_filters": null, "conv_activation": "relu", "conv_kernel_initializer": null, "conv_kernel_initializer_config": null, "conv_bias_initializer": null, "conv_bias_initializer_config": null, "conv_transpose_kernel_initializer": null, "conv_transpose_kernel_initializer_config": null, "conv_transpose_bias_initializer": null, "conv_transpose_bias_initializer_config": null, "post_fcnet_hiddens": [], "post_fcnet_activation": "relu", "post_fcnet_weights_initializer": null, "post_fcnet_weights_initializer_config": null, "post_fcnet_bias_initializer": null, "post_fcnet_bias_initializer_config": null, "free_log_std": false, "log_std_clip_param": 20.0, "no_final_linear": false, "vf_share_layers": false, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "lstm_weights_initializer": null, "lstm_weights_initializer_config": null, "lstm_bias_initializer": null, "lstm_bias_initializer_config": null, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "attention_use_n_prev_actions": 0, "attention_use_n_prev_rewards": 0, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": null, "custom_model_config": {}, "custom_action_dist": null, "custom_preprocessor": null, "encoder_latent_dim": null, "always_check_shapes": false, "lstm_use_prev_action_reward": -1, "_use_default_native_models": -1, "_disable_preprocessor_api": false, "_disable_action_flattening": false}, "_learner_connector": null, "add_default_connectors_to_learner_pipeline": true, "learner_config_dict": {}, "optimizer": {}, "_learner_class": null, "callbacks_on_algorithm_init": null, "callbacks_on_env_runners_recreated": null, "callbacks_on_offline_eval_runners_recreated": null, "callbacks_on_checkpoint_loaded": null, "callbacks_on_environment_created": null, "callbacks_on_episode_created": null, "callbacks_on_episode_start": null, "callbacks_on_episode_step": null, "callbacks_on_episode_end": null, "callbacks_on_evaluate_start": null, "callbacks_on_evaluate_end": null, "callbacks_on_evaluate_offline_start": null, "callbacks_on_evaluate_offline_end": null, "callbacks_on_sample_end": null, "callbacks_on_train_result": null, "explore": true, "enable_rl_module_and_learner": true, "enable_env_runner_and_connector_v2": true, "_prior_exploration_config": {"type": "StochasticSampling"}, "count_steps_by": "env_steps", "policy_map_capacity": 100, "policy_mapping_fn": "<function AlgorithmConfig.DEFAULT_POLICY_MAPPING_FN at 0x1680e9b20>", "policies_to_train": null, "policy_states_are_swappable": false, "observation_fn": null, "offline_data_class": null, "input_read_method": "read_parquet", "input_read_method_kwargs": {}, "input_read_schema": {}, "input_read_episodes": false, "input_read_sample_batches": false, "input_read_batch_size": null, "input_filesystem": null, "input_filesystem_kwargs": {}, "input_compress_columns": ["obs", "new_obs"], "input_spaces_jsonable": true, "materialize_data": false, "materialize_mapped_data": true, "map_batches_kwargs": {}, "iter_batches_kwargs": {}, "ignore_final_observation": false, "prelearner_class": null, "prelearner_buffer_class": null, "prelearner_buffer_kwargs": {}, "prelearner_module_synch_period": 10, "dataset_num_iters_per_learner": null, "input_config": {}, "actions_in_input_normalized": false, "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_config": {}, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "output_max_rows_per_file": null, "output_write_remaining_data": false, "output_write_method": "write_parquet", "output_write_method_kwargs": {}, "output_filesystem": null, "output_filesystem_kwargs": {}, "output_write_episodes": true, "offline_sampling": false, "evaluation_interval": 1, "evaluation_duration": 20, "evaluation_duration_unit": "episodes", "evaluation_sample_timeout_s": 120.0, "evaluation_auto_duration_min_env_steps_per_sample": 100, "evaluation_auto_duration_max_env_steps_per_sample": 2000, "evaluation_parallel_to_training": false, "evaluation_force_reset_envs_before_iteration": true, "evaluation_config": null, "off_policy_estimation_methods": {}, "ope_split_batch_by_episode": true, "evaluation_num_env_runners": 1, "in_evaluation": false, "sync_filters_on_rollout_workers_timeout_s": 10.0, "offline_evaluation_interval": null, "num_offline_eval_runners": 0, "offline_loss_for_module_fn": null, "offline_evaluation_duration": 1, "offline_evaluation_parallel_to_training": false, "offline_evaluation_timeout_s": 120.0, "num_cpus_per_offline_eval_runner": 1, "num_gpus_per_offline_eval_runner": 0, "custom_resources_per_offline_eval_runner": {}, "restart_failed_offline_eval_runners": true, "ignore_offline_eval_runner_failures": false, "max_num_offline_eval_runner_restarts": 1000, "offline_eval_runner_restore_timeout_s": 1800.0, "max_requests_in_flight_per_offline_eval_runner": 1, "validate_offline_eval_runners_after_construction": true, "offline_eval_runner_health_probe_timeout_s": 30.0, "offline_eval_rl_module_inference_only": false, "broadcast_offline_eval_runner_states": false, "offline_eval_batch_size_per_runner": 256, "dataset_num_iters_per_eval_runner": 1, "keep_per_episode_custom_metrics": false, "metrics_episode_collection_timeout_s": 60.0, "metrics_num_episodes_for_smoothing": 100, "min_time_s_per_iteration": null, "min_train_timesteps_per_iteration": 0, "min_sample_timesteps_per_iteration": 0, "log_gradients": true, "export_native_model_files": false, "checkpoint_trainable_policies_only": false, "logger_creator": null, "logger_config": null, "log_level": "WARN", "log_sys_usage": true, "fake_sampler": false, "seed": 8, "restart_failed_env_runners": true, "ignore_env_runner_failures": false, "max_num_env_runner_restarts": 1000, "delay_between_env_runner_restarts_s": 60.0, "restart_failed_sub_environments": false, "num_consecutive_env_runner_failures_tolerance": 100, "env_runner_health_probe_timeout_s": 30.0, "env_runner_restore_timeout_s": 1800.0, "_model_config": {}, "_rl_module_spec": "RLModuleSpec(module_class=None, observation_space=None, action_space=None, inference_only=False, learner_only=False, model_config=DefaultModelConfig(fcnet_hiddens=[60, 90], fcnet_activation='tanh', fcnet_kernel_initializer=None, fcnet_kernel_initializer_kwargs=None, fcnet_bias_initializer=None, fcnet_bias_initializer_kwargs=None, conv_filters=None, conv_activation='relu', conv_kernel_initializer=None, conv_kernel_initializer_kwargs=None, conv_bias_initializer=None, conv_bias_initializer_kwargs=None, head_fcnet_hiddens=[], head_fcnet_activation='relu', head_fcnet_kernel_initializer=None, head_fcnet_kernel_initializer_kwargs=None, head_fcnet_bias_initializer=None, head_fcnet_bias_initializer_kwargs=None, free_log_std=False, log_std_clip_param=20.0, vf_share_layers=True, use_lstm=False, max_seq_len=20, lstm_cell_size=256, lstm_use_prev_action=False, lstm_use_prev_reward=False, lstm_kernel_initializer=None, lstm_kernel_initializer_kwargs=None, lstm_bias_initializer=None, lstm_bias_initializer_kwargs=None), catalog_class=None, load_state_path=None, model_config_dict=None)", "algorithm_config_overrides_per_module": {}, "_per_module_overrides": {}, "_validate_config": true, "_use_msgpack_checkpoints": false, "_torch_grad_scaler_class": null, "_torch_lr_scheduler_classes": null, "_tf_policy_handles_more_than_one_loss": false, "_disable_preprocessor_api": false, "_disable_action_flattening": false, "_disable_initialize_loss_from_dummy_batch": false, "_dont_auto_sync_env_runner_states": false, "env_task_fn": -1, "enable_connectors": -1, "simple_optimizer": false, "policy_map_cache": -1, "worker_cls": -1, "synchronize_filters": -1, "enable_async_evaluation": -1, "custom_async_evaluation_function": -1, "_enable_rl_module_api": -1, "auto_wrap_old_gym_envs": -1, "always_attach_evaluation_results": -1, "replay_sequence_length": null, "_disable_execution_plan_api": -1, "use_critic": true, "use_gae": true, "use_kl_loss": true, "kl_coeff": 0.7464963036515, "kl_target": 0.0270990929592, "vf_loss_coeff": 0.6688075857018, "entropy_coeff": 0.0090570820258, "clip_param": 0.1221781641624, "vf_clip_param": 0.1027808522125, "entropy_coeff_schedule": null, "lr_schedule": null, "sgd_minibatch_size": -1, "vf_share_layers": -1, "__stdout_file__": null, "__stderr_file__": null, "lambda": 0.9099046732075, "input": "sampler", "policies": {"default_policy": [null, null, null, null]}, "callbacks": "<class 'ray.rllib.callbacks.callbacks.RLlibCallback'>", "create_env_on_driver": false, "custom_eval_function": null, "framework": "torch"}, "time_since_restore": 28.852214097976685, "iterations_since_restore": 16, "perf": {"cpu_util_percent": 40.96666666666666, "ram_util_percent": 82.76666666666667}}
{"timers": {"training_iteration": 2.23479180747383, "restore_env_runners": 1.388123787264209e-05, "training_step": 2.234635602392801, "env_runner_sampling_timer": 2.11955568006383, "learner_update_timer": 0.11159872341666331, "synch_weights": 0.0008247334360292908, "restore_eval_env_runners": 1.1587456176435706e-05, "evaluation_iteration": 0.1261862760494897, "synch_eval_env_connectors": 0.00013466460112894824, "synch_env_connectors": 4.7704853153548125e-06}, "env_runners": {"sample": 0.00503047297214003, "module_episode_returns_mean": {"default_policy": 7.139999999999999}, "env_to_module_connector": {"timers": {"connectors": {"add_states_from_episodes_to_batch": 1.7282211172873905e-06, "numpy_to_tensor": 8.425146643720873e-06, "add_observations_from_episodes_to_batch": 2.995177670236256e-06, "add_time_dim_to_batch_and_zero_pad": 2.3369259925831647e-06, "batch_individual_items": 6.321548703064072e-06}}, "connector_pipeline_timer": 4.337788842905002e-05}, "env_reset_timer": 3.3047067749722245e-05, "module_to_env_connector": {"timers": {"connectors": {"tensor_to_numpy": 1.2891210503013936e-05, "normalize_and_clip_actions": 9.296958318465927e-06, "listify_data_for_vector_env": 1.0990788661195081e-05, "remove_single_ts_time_rank_from_batch": 5.77799203919764e-07, "un_batch_to_individual_items": 5.400690593889179e-06, "get_actions": 3.718198401377419e-05}}, "connector_pipeline_timer": 0.00010171626658568697}, "num_module_steps_sampled": {"default_policy": 5000.0}, "weights_seq_no": 16.0, "agent_episode_returns_mean": {"default_agent": 7.139999999999999}, "env_to_module_sum_episodes_length_out": 10.36823839457432, "env_step_timer": 1.3867313659623398e-05, "num_env_steps_sampled": 5000.0, "episode_return_mean": 7.139999999999999, "num_episodes_lifetime": -462625.0, "num_module_steps_sampled_lifetime": {"default_policy": -9252500.0}, "time_between_sampling": 0.0015138415348369373, "env_to_module_sum_episodes_length_in": 10.36823839457432, "rlmodule_inference_timer": 4.203106678567698e-05, "episode_duration_sec_mean": 0.004814556664321573, "num_env_steps_sampled_lifetime": -9252500.0, "episode_len_max": 20, "episode_len_mean": 20.0, "num_episodes": 250.0, "episode_return_max": 8.5, "num_agent_steps_sampled": {"default_agent": 5000.0}, "episode_len_min": 20, "episode_return_min": -11.5, "num_agent_steps_sampled_lifetime": {"default_agent": -9252500.0}, "num_env_steps_sampled_lifetime_throughput": 3765.1919509667337}, "learners": {"__all_modules__": {"num_env_steps_trained": 31500, "learner_connector": {"timers": {"connectors": {"add_one_ts_to_episodes_and_truncate": 0.008643984420953554, "add_columns_from_episodes_to_train_batch": 0.034420390171791056, "general_advantage_estimation": 0.006495062920336489, "add_states_from_episodes_to_batch": 3.6707871691024342e-06, "add_time_dim_to_batch_and_zero_pad": 1.245068093811771e-05, "batch_individual_items": 0.03511716404932264, "numpy_to_tensor": 6.903956983765268e-05, "add_observations_from_episodes_to_batch": 0.0008116851067528925}}, "connector_pipeline_timer": 0.08570652525421593}, "num_module_steps_trained_lifetime": 102000, "learner_connector_sum_episodes_length_in": 5000.0, "num_module_steps_trained": 6000, "learner_connector_sum_episodes_length_out": 5250.0, "num_env_steps_trained_lifetime": 535500, "num_non_trainable_parameters": 0, "num_trainable_parameters": 6003, "num_env_steps_trained_lifetime_throughput": 2124126.9111776794, "num_module_steps_trained_throughput": 406088.9659584819, "num_module_steps_trained_lifetime_throughput": 405501.7242020238}, "default_policy": {"mean_kl_loss": 0.0006145501974970102, "curr_kl_coeff": 5.695314939657692e-06, "module_train_batch_size_mean": 1000.0, "weights_seq_no": 17.0, "default_optimizer_learning_rate": 0.0002847858517, "num_trainable_parameters": 6003, "num_module_steps_trained_lifetime": 102000, "entropy": 0.4784937798976898, "curr_entropy_coeff": 0.0090570820258, "num_module_steps_trained": 6000, "policy_loss": -0.1093665286898613, "vf_loss": 0.10278083384037018, "total_loss": -0.044959671795368195, "diff_num_grad_updates_vs_sampler_policy": 1.0, "vf_loss_unclipped": 25.952669143676758, "vf_explained_var": 0.004864335060119629, "gradients_default_optimizer_global_norm": 0.10882989317178726, "num_module_steps_trained_lifetime_throughput": 406553.3356129556}}, "num_training_step_calls_per_iteration": 1, "evaluation": {"env_runners": {"module_to_env_connector": {"timers": {"connectors": {"un_batch_to_individual_items": 5.431634874458975e-06, "get_actions": 3.6821102242970294e-05, "tensor_to_numpy": 1.324425534156903e-05, "listify_data_for_vector_env": 1.0936704633729815e-05, "normalize_and_clip_actions": 9.398733707107818e-06, "remove_single_ts_time_rank_from_batch": 5.801047228361134e-07}}, "connector_pipeline_timer": 0.00010165755371187372}, "env_step_timer": 1.3961524378148317e-05, "env_to_module_connector": {"timers": {"connectors": {"add_observations_from_episodes_to_batch": 2.828475234763695e-06, "add_time_dim_to_batch_and_zero_pad": 2.2992276300127034e-06, "batch_individual_items": 6.247269186990982e-06, "add_states_from_episodes_to_batch": 1.6159417292345573e-06, "numpy_to_tensor": 8.342956589053103e-06}}, "connector_pipeline_timer": 4.282167393066028e-05}, "episode_duration_sec_mean": 0.004558363254182041, "num_episodes": 20, "episode_return_min": -14.5, "agent_episode_returns_mean": {"default_agent": 1.75}, "sample": 0.11215502832969902, "num_agent_steps_sampled_lifetime": {"default_agent": 6800}, "env_to_module_sum_episodes_length_out": 10.368238394574323, "num_env_steps_sampled": 400, "module_episode_returns_mean": {"default_policy": 1.75}, "rlmodule_inference_timer": 2.7209491020132868e-05, "episode_return_max": 14.5, "env_reset_timer": 0.0009361768224764074, "num_agent_steps_sampled": {"default_agent": 400}, "episode_return_mean": 1.75, "num_episodes_lifetime": 340, "weights_seq_no": 17.0, "env_to_module_sum_episodes_length_in": 10.368238394574323, "num_env_steps_sampled_lifetime": 85400, "num_module_steps_sampled": {"default_policy": 400}, "episode_len_max": 20, "episode_len_mean": 20.0, "episode_len_min": 20, "num_module_steps_sampled_lifetime": {"default_policy": 6800}, "time_between_sampling": 1.7556311817850183}, "num_healthy_workers": 1, "actor_manager_num_outstanding_async_reqs": 0, "num_remote_worker_restarts": 0}, "num_env_steps_sampled_lifetime": -9252500.0, "fault_tolerance": {"num_healthy_workers": 0, "num_remote_worker_restarts": 0}, "env_runner_group": {"actor_manager_num_outstanding_async_reqs": 0}, "done": false, "training_iteration": 17, "trial_id": "4d657_00000", "date": "2025-08-11_19-21-22", "timestamp": 1754932882, "time_this_iter_s": 1.7341229915618896, "time_total_s": 30.586337089538574, "pid": 14261, "hostname": "Mac", "node_ip": "127.0.0.1", "config": {"exploration_config": {}, "extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "placement_strategy": "PACK", "num_gpus": 0, "_fake_gpus": false, "num_cpus_for_main_process": 2, "eager_tracing": true, "eager_max_retraces": 20, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "torch_compile_learner": false, "torch_compile_learner_what_to_compile": "forward_train", "torch_compile_learner_dynamo_backend": "aot_eager", "torch_compile_learner_dynamo_mode": null, "torch_compile_worker": false, "torch_compile_worker_dynamo_backend": "aot_eager", "torch_compile_worker_dynamo_mode": null, "torch_ddp_kwargs": {}, "torch_skip_nan_gradients": false, "env": "Umbrella", "env_config": {}, "observation_space": null, "action_space": null, "clip_rewards": null, "normalize_actions": true, "clip_actions": false, "_is_atari": null, "disable_env_checking": false, "render_env": false, "action_mask_key": "action_mask", "env_runner_cls": null, "num_env_runners": 0, "create_local_env_runner": true, "num_envs_per_env_runner": 1, "gym_env_vectorize_mode": "SYNC", "num_cpus_per_env_runner": 1, "num_gpus_per_env_runner": 0, "custom_resources_per_env_runner": {}, "validate_env_runners_after_construction": true, "episodes_to_numpy": true, "max_requests_in_flight_per_env_runner": 1, "sample_timeout_s": 60.0, "_env_to_module_connector": null, "add_default_connectors_to_env_to_module_pipeline": true, "_module_to_env_connector": null, "add_default_connectors_to_module_to_env_pipeline": true, "merge_env_runner_states": "training_only", "broadcast_env_runner_states": true, "episode_lookback_horizon": 1, "rollout_fragment_length": "auto", "batch_mode": "complete_episodes", "compress_observations": false, "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "enable_tf1_exec_eagerly": false, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "preprocessor_pref": "deepmind", "observation_filter": "NoFilter", "update_worker_filter_stats": true, "use_worker_filter_stats": true, "sampler_perf_stats_ema_coef": null, "_is_online": true, "num_learners": 0, "num_gpus_per_learner": 0, "num_cpus_per_learner": "auto", "num_aggregator_actors_per_learner": 0, "max_requests_in_flight_per_aggregator_actor": 3, "local_gpu_idx": 0, "max_requests_in_flight_per_learner": 3, "gamma": 1, "lr": 0.0002847858517, "grad_clip": 0.5, "grad_clip_by": "global_norm", "_train_batch_size_per_learner": 5000, "train_batch_size": 4000, "num_epochs": 1, "minibatch_size": 1000, "shuffle_batch_per_epoch": true, "model": {"fcnet_hiddens": [256, 256], "fcnet_activation": "tanh", "fcnet_weights_initializer": null, "fcnet_weights_initializer_config": null, "fcnet_bias_initializer": null, "fcnet_bias_initializer_config": null, "conv_filters": null, "conv_activation": "relu", "conv_kernel_initializer": null, "conv_kernel_initializer_config": null, "conv_bias_initializer": null, "conv_bias_initializer_config": null, "conv_transpose_kernel_initializer": null, "conv_transpose_kernel_initializer_config": null, "conv_transpose_bias_initializer": null, "conv_transpose_bias_initializer_config": null, "post_fcnet_hiddens": [], "post_fcnet_activation": "relu", "post_fcnet_weights_initializer": null, "post_fcnet_weights_initializer_config": null, "post_fcnet_bias_initializer": null, "post_fcnet_bias_initializer_config": null, "free_log_std": false, "log_std_clip_param": 20.0, "no_final_linear": false, "vf_share_layers": false, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "lstm_weights_initializer": null, "lstm_weights_initializer_config": null, "lstm_bias_initializer": null, "lstm_bias_initializer_config": null, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "attention_use_n_prev_actions": 0, "attention_use_n_prev_rewards": 0, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": null, "custom_model_config": {}, "custom_action_dist": null, "custom_preprocessor": null, "encoder_latent_dim": null, "always_check_shapes": false, "lstm_use_prev_action_reward": -1, "_use_default_native_models": -1, "_disable_preprocessor_api": false, "_disable_action_flattening": false}, "_learner_connector": null, "add_default_connectors_to_learner_pipeline": true, "learner_config_dict": {}, "optimizer": {}, "_learner_class": null, "callbacks_on_algorithm_init": null, "callbacks_on_env_runners_recreated": null, "callbacks_on_offline_eval_runners_recreated": null, "callbacks_on_checkpoint_loaded": null, "callbacks_on_environment_created": null, "callbacks_on_episode_created": null, "callbacks_on_episode_start": null, "callbacks_on_episode_step": null, "callbacks_on_episode_end": null, "callbacks_on_evaluate_start": null, "callbacks_on_evaluate_end": null, "callbacks_on_evaluate_offline_start": null, "callbacks_on_evaluate_offline_end": null, "callbacks_on_sample_end": null, "callbacks_on_train_result": null, "explore": true, "enable_rl_module_and_learner": true, "enable_env_runner_and_connector_v2": true, "_prior_exploration_config": {"type": "StochasticSampling"}, "count_steps_by": "env_steps", "policy_map_capacity": 100, "policy_mapping_fn": "<function AlgorithmConfig.DEFAULT_POLICY_MAPPING_FN at 0x1680e9b20>", "policies_to_train": null, "policy_states_are_swappable": false, "observation_fn": null, "offline_data_class": null, "input_read_method": "read_parquet", "input_read_method_kwargs": {}, "input_read_schema": {}, "input_read_episodes": false, "input_read_sample_batches": false, "input_read_batch_size": null, "input_filesystem": null, "input_filesystem_kwargs": {}, "input_compress_columns": ["obs", "new_obs"], "input_spaces_jsonable": true, "materialize_data": false, "materialize_mapped_data": true, "map_batches_kwargs": {}, "iter_batches_kwargs": {}, "ignore_final_observation": false, "prelearner_class": null, "prelearner_buffer_class": null, "prelearner_buffer_kwargs": {}, "prelearner_module_synch_period": 10, "dataset_num_iters_per_learner": null, "input_config": {}, "actions_in_input_normalized": false, "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_config": {}, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "output_max_rows_per_file": null, "output_write_remaining_data": false, "output_write_method": "write_parquet", "output_write_method_kwargs": {}, "output_filesystem": null, "output_filesystem_kwargs": {}, "output_write_episodes": true, "offline_sampling": false, "evaluation_interval": 1, "evaluation_duration": 20, "evaluation_duration_unit": "episodes", "evaluation_sample_timeout_s": 120.0, "evaluation_auto_duration_min_env_steps_per_sample": 100, "evaluation_auto_duration_max_env_steps_per_sample": 2000, "evaluation_parallel_to_training": false, "evaluation_force_reset_envs_before_iteration": true, "evaluation_config": null, "off_policy_estimation_methods": {}, "ope_split_batch_by_episode": true, "evaluation_num_env_runners": 1, "in_evaluation": false, "sync_filters_on_rollout_workers_timeout_s": 10.0, "offline_evaluation_interval": null, "num_offline_eval_runners": 0, "offline_loss_for_module_fn": null, "offline_evaluation_duration": 1, "offline_evaluation_parallel_to_training": false, "offline_evaluation_timeout_s": 120.0, "num_cpus_per_offline_eval_runner": 1, "num_gpus_per_offline_eval_runner": 0, "custom_resources_per_offline_eval_runner": {}, "restart_failed_offline_eval_runners": true, "ignore_offline_eval_runner_failures": false, "max_num_offline_eval_runner_restarts": 1000, "offline_eval_runner_restore_timeout_s": 1800.0, "max_requests_in_flight_per_offline_eval_runner": 1, "validate_offline_eval_runners_after_construction": true, "offline_eval_runner_health_probe_timeout_s": 30.0, "offline_eval_rl_module_inference_only": false, "broadcast_offline_eval_runner_states": false, "offline_eval_batch_size_per_runner": 256, "dataset_num_iters_per_eval_runner": 1, "keep_per_episode_custom_metrics": false, "metrics_episode_collection_timeout_s": 60.0, "metrics_num_episodes_for_smoothing": 100, "min_time_s_per_iteration": null, "min_train_timesteps_per_iteration": 0, "min_sample_timesteps_per_iteration": 0, "log_gradients": true, "export_native_model_files": false, "checkpoint_trainable_policies_only": false, "logger_creator": null, "logger_config": null, "log_level": "WARN", "log_sys_usage": true, "fake_sampler": false, "seed": 8, "restart_failed_env_runners": true, "ignore_env_runner_failures": false, "max_num_env_runner_restarts": 1000, "delay_between_env_runner_restarts_s": 60.0, "restart_failed_sub_environments": false, "num_consecutive_env_runner_failures_tolerance": 100, "env_runner_health_probe_timeout_s": 30.0, "env_runner_restore_timeout_s": 1800.0, "_model_config": {}, "_rl_module_spec": "RLModuleSpec(module_class=None, observation_space=None, action_space=None, inference_only=False, learner_only=False, model_config=DefaultModelConfig(fcnet_hiddens=[60, 90], fcnet_activation='tanh', fcnet_kernel_initializer=None, fcnet_kernel_initializer_kwargs=None, fcnet_bias_initializer=None, fcnet_bias_initializer_kwargs=None, conv_filters=None, conv_activation='relu', conv_kernel_initializer=None, conv_kernel_initializer_kwargs=None, conv_bias_initializer=None, conv_bias_initializer_kwargs=None, head_fcnet_hiddens=[], head_fcnet_activation='relu', head_fcnet_kernel_initializer=None, head_fcnet_kernel_initializer_kwargs=None, head_fcnet_bias_initializer=None, head_fcnet_bias_initializer_kwargs=None, free_log_std=False, log_std_clip_param=20.0, vf_share_layers=True, use_lstm=False, max_seq_len=20, lstm_cell_size=256, lstm_use_prev_action=False, lstm_use_prev_reward=False, lstm_kernel_initializer=None, lstm_kernel_initializer_kwargs=None, lstm_bias_initializer=None, lstm_bias_initializer_kwargs=None), catalog_class=None, load_state_path=None, model_config_dict=None)", "algorithm_config_overrides_per_module": {}, "_per_module_overrides": {}, "_validate_config": true, "_use_msgpack_checkpoints": false, "_torch_grad_scaler_class": null, "_torch_lr_scheduler_classes": null, "_tf_policy_handles_more_than_one_loss": false, "_disable_preprocessor_api": false, "_disable_action_flattening": false, "_disable_initialize_loss_from_dummy_batch": false, "_dont_auto_sync_env_runner_states": false, "env_task_fn": -1, "enable_connectors": -1, "simple_optimizer": false, "policy_map_cache": -1, "worker_cls": -1, "synchronize_filters": -1, "enable_async_evaluation": -1, "custom_async_evaluation_function": -1, "_enable_rl_module_api": -1, "auto_wrap_old_gym_envs": -1, "always_attach_evaluation_results": -1, "replay_sequence_length": null, "_disable_execution_plan_api": -1, "use_critic": true, "use_gae": true, "use_kl_loss": true, "kl_coeff": 0.7464963036515, "kl_target": 0.0270990929592, "vf_loss_coeff": 0.6688075857018, "entropy_coeff": 0.0090570820258, "clip_param": 0.1221781641624, "vf_clip_param": 0.1027808522125, "entropy_coeff_schedule": null, "lr_schedule": null, "sgd_minibatch_size": -1, "vf_share_layers": -1, "__stdout_file__": null, "__stderr_file__": null, "lambda": 0.9099046732075, "input": "sampler", "policies": {"default_policy": [null, null, null, null]}, "callbacks": "<class 'ray.rllib.callbacks.callbacks.RLlibCallback'>", "create_env_on_driver": false, "custom_eval_function": null, "framework": "torch"}, "time_since_restore": 30.586337089538574, "iterations_since_restore": 17, "perf": {"cpu_util_percent": 45.349999999999994, "ram_util_percent": 83.19999999999999}}
{"timers": {"training_iteration": 2.2293360956500146, "restore_env_runners": 1.3795345570911758e-05, "training_step": 2.229179542619222, "env_runner_sampling_timer": 2.1128593690928397, "learner_update_timer": 0.11284222576218171, "synch_weights": 0.0008228127714961015, "restore_eval_env_runners": 1.1624081029651761e-05, "evaluation_iteration": 0.12611688369843654, "synch_eval_env_connectors": 0.0001371937855612347, "synch_env_connectors": 4.767360545541671e-06}, "env_runners": {"sample": 0.005143170705048981, "module_episode_returns_mean": {"default_policy": 7.2200000000000015}, "env_to_module_connector": {"timers": {"connectors": {"add_states_from_episodes_to_batch": 1.7872122443392036e-06, "numpy_to_tensor": 9.060761644534571e-06, "add_observations_from_episodes_to_batch": 3.089368216276792e-06, "add_time_dim_to_batch_and_zero_pad": 2.5031848541300538e-06, "batch_individual_items": 6.798779197182766e-06}}, "connector_pipeline_timer": 4.56868996917933e-05}, "env_reset_timer": 3.8475670072761715e-05, "module_to_env_connector": {"timers": {"connectors": {"tensor_to_numpy": 1.3755459056430199e-05, "normalize_and_clip_actions": 9.825265021962058e-06, "listify_data_for_vector_env": 1.1661200056669655e-05, "remove_single_ts_time_rank_from_batch": 5.982560693709095e-07, "un_batch_to_individual_items": 5.680814011666222e-06, "get_actions": 4.079251232778838e-05}}, "connector_pipeline_timer": 0.00010886663436878568}, "num_module_steps_sampled": {"default_policy": 5000.0}, "weights_seq_no": 17.0, "agent_episode_returns_mean": {"default_agent": 7.2200000000000015}, "env_to_module_sum_episodes_length_out": 10.36823839457432, "env_step_timer": 1.4801257926364517e-05, "num_env_steps_sampled": 5000.0, "episode_return_mean": 7.2200000000000015, "num_episodes_lifetime": -493500.0, "num_module_steps_sampled_lifetime": {"default_policy": -9870000.0}, "time_between_sampling": 0.0018507200973411995, "env_to_module_sum_episodes_length_in": 10.36823839457432, "rlmodule_inference_timer": 2.9082901344040387e-05, "episode_duration_sec_mean": 0.004782477003056556, "num_env_steps_sampled_lifetime": -9870000.0, "episode_len_max": 20, "episode_len_mean": 20.0, "num_episodes": 250.0, "episode_return_max": 8.5, "num_agent_steps_sampled": {"default_agent": 5000.0}, "episode_len_min": 20, "episode_return_min": -11.5, "num_agent_steps_sampled_lifetime": {"default_agent": -9870000.0}, "num_env_steps_sampled_lifetime_throughput": 3598.48379360225}, "learners": {"__all_modules__": {"num_env_steps_trained": 31500, "learner_connector": {"timers": {"connectors": {"add_one_ts_to_episodes_and_truncate": 0.008633603327017677, "add_columns_from_episodes_to_train_batch": 0.03442137377042519, "general_advantage_estimation": 0.006487709381623286, "add_states_from_episodes_to_batch": 3.664489307779042e-06, "add_time_dim_to_batch_and_zero_pad": 1.2412844171683468e-05, "batch_individual_items": 0.036487847828284514, "numpy_to_tensor": 6.901834454312921e-05, "add_observations_from_episodes_to_batch": 0.0008121774260123266}}, "connector_pipeline_timer": 0.0870607125015112}, "num_module_steps_trained_lifetime": 108000, "learner_connector_sum_episodes_length_in": 5000.0, "num_module_steps_trained": 6000, "learner_connector_sum_episodes_length_out": 5250.0, "num_env_steps_trained_lifetime": 567000, "num_non_trainable_parameters": 0, "num_trainable_parameters": 6003, "num_env_steps_trained_lifetime_throughput": 2109566.6661676443, "num_module_steps_trained_throughput": 403256.34386730153, "num_module_steps_trained_lifetime_throughput": 402689.29842068977}, "default_policy": {"mean_kl_loss": 3.0231125492719002e-05, "curr_kl_coeff": 2.847657469828846e-06, "module_train_batch_size_mean": 1000.0, "weights_seq_no": 18.0, "default_optimizer_learning_rate": 0.0002847858517, "num_trainable_parameters": 6003, "num_module_steps_trained_lifetime": 108000, "entropy": 0.46768543124198914, "curr_entropy_coeff": 0.0090570820258, "num_module_steps_trained": 6000, "policy_loss": -0.044139228761196136, "vf_loss": 0.10278083384037018, "total_loss": 0.0203655194491148, "diff_num_grad_updates_vs_sampler_policy": 1.0, "vf_loss_unclipped": 26.084064483642578, "vf_explained_var": 0.005313515663146973, "gradients_default_optimizer_global_norm": 0.0484977550804615, "num_module_steps_trained_lifetime_throughput": 403668.9322927331}}, "num_training_step_calls_per_iteration": 1, "evaluation": {"env_runners": {"module_to_env_connector": {"timers": {"connectors": {"un_batch_to_individual_items": 7.296039063125668e-06, "get_actions": 5.603917964846428e-05, "tensor_to_numpy": 1.8170687073900148e-05, "listify_data_for_vector_env": 1.517989377973392e-05, "normalize_and_clip_actions": 1.2205698317287497e-05, "remove_single_ts_time_rank_from_batch": 6.497148040296886e-07}}, "connector_pipeline_timer": 0.00014282492333861328}, "env_step_timer": 2.207925780803441e-05, "env_to_module_connector": {"timers": {"connectors": {"add_observations_from_episodes_to_batch": 3.5690418037081773e-06, "add_time_dim_to_batch_and_zero_pad": 3.0046896548042973e-06, "batch_individual_items": 8.383746171784458e-06, "add_states_from_episodes_to_batch": 1.8421327753034206e-06, "numpy_to_tensor": 1.183301108870794e-05}}, "connector_pipeline_timer": 5.551674530205872e-05}, "episode_duration_sec_mean": 0.0048012945265509185, "num_episodes": 20, "episode_return_min": -14.5, "agent_episode_returns_mean": {"default_agent": 1.95}, "sample": 0.11227047388684719, "num_agent_steps_sampled_lifetime": {"default_agent": 7200}, "env_to_module_sum_episodes_length_out": 10.368238394574323, "num_env_steps_sampled": 400, "module_episode_returns_mean": {"default_policy": 1.95}, "rlmodule_inference_timer": 3.735343280605635e-05, "episode_return_max": 14.5, "env_reset_timer": 0.0009275388048149817, "num_agent_steps_sampled": {"default_agent": 400}, "episode_return_mean": 1.95, "num_episodes_lifetime": 360, "weights_seq_no": 18.0, "env_to_module_sum_episodes_length_in": 10.368238394574323, "num_env_steps_sampled_lifetime": 90400, "num_module_steps_sampled": {"default_policy": 400}, "episode_len_max": 20, "episode_len_mean": 20.0, "episode_len_min": 20, "num_module_steps_sampled_lifetime": {"default_policy": 7200}, "time_between_sampling": 1.7551566337173432}, "num_healthy_workers": 1, "actor_manager_num_outstanding_async_reqs": 0, "num_remote_worker_restarts": 0}, "num_env_steps_sampled_lifetime": -9870000.0, "fault_tolerance": {"num_healthy_workers": 0, "num_remote_worker_restarts": 0}, "env_runner_group": {"actor_manager_num_outstanding_async_reqs": 0}, "done": false, "training_iteration": 18, "trial_id": "4d657_00000", "date": "2025-08-11_19-21-24", "timestamp": 1754932884, "time_this_iter_s": 1.8232126235961914, "time_total_s": 32.409549713134766, "pid": 14261, "hostname": "Mac", "node_ip": "127.0.0.1", "config": {"exploration_config": {}, "extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "placement_strategy": "PACK", "num_gpus": 0, "_fake_gpus": false, "num_cpus_for_main_process": 2, "eager_tracing": true, "eager_max_retraces": 20, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "torch_compile_learner": false, "torch_compile_learner_what_to_compile": "forward_train", "torch_compile_learner_dynamo_backend": "aot_eager", "torch_compile_learner_dynamo_mode": null, "torch_compile_worker": false, "torch_compile_worker_dynamo_backend": "aot_eager", "torch_compile_worker_dynamo_mode": null, "torch_ddp_kwargs": {}, "torch_skip_nan_gradients": false, "env": "Umbrella", "env_config": {}, "observation_space": null, "action_space": null, "clip_rewards": null, "normalize_actions": true, "clip_actions": false, "_is_atari": null, "disable_env_checking": false, "render_env": false, "action_mask_key": "action_mask", "env_runner_cls": null, "num_env_runners": 0, "create_local_env_runner": true, "num_envs_per_env_runner": 1, "gym_env_vectorize_mode": "SYNC", "num_cpus_per_env_runner": 1, "num_gpus_per_env_runner": 0, "custom_resources_per_env_runner": {}, "validate_env_runners_after_construction": true, "episodes_to_numpy": true, "max_requests_in_flight_per_env_runner": 1, "sample_timeout_s": 60.0, "_env_to_module_connector": null, "add_default_connectors_to_env_to_module_pipeline": true, "_module_to_env_connector": null, "add_default_connectors_to_module_to_env_pipeline": true, "merge_env_runner_states": "training_only", "broadcast_env_runner_states": true, "episode_lookback_horizon": 1, "rollout_fragment_length": "auto", "batch_mode": "complete_episodes", "compress_observations": false, "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "enable_tf1_exec_eagerly": false, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "preprocessor_pref": "deepmind", "observation_filter": "NoFilter", "update_worker_filter_stats": true, "use_worker_filter_stats": true, "sampler_perf_stats_ema_coef": null, "_is_online": true, "num_learners": 0, "num_gpus_per_learner": 0, "num_cpus_per_learner": "auto", "num_aggregator_actors_per_learner": 0, "max_requests_in_flight_per_aggregator_actor": 3, "local_gpu_idx": 0, "max_requests_in_flight_per_learner": 3, "gamma": 1, "lr": 0.0002847858517, "grad_clip": 0.5, "grad_clip_by": "global_norm", "_train_batch_size_per_learner": 5000, "train_batch_size": 4000, "num_epochs": 1, "minibatch_size": 1000, "shuffle_batch_per_epoch": true, "model": {"fcnet_hiddens": [256, 256], "fcnet_activation": "tanh", "fcnet_weights_initializer": null, "fcnet_weights_initializer_config": null, "fcnet_bias_initializer": null, "fcnet_bias_initializer_config": null, "conv_filters": null, "conv_activation": "relu", "conv_kernel_initializer": null, "conv_kernel_initializer_config": null, "conv_bias_initializer": null, "conv_bias_initializer_config": null, "conv_transpose_kernel_initializer": null, "conv_transpose_kernel_initializer_config": null, "conv_transpose_bias_initializer": null, "conv_transpose_bias_initializer_config": null, "post_fcnet_hiddens": [], "post_fcnet_activation": "relu", "post_fcnet_weights_initializer": null, "post_fcnet_weights_initializer_config": null, "post_fcnet_bias_initializer": null, "post_fcnet_bias_initializer_config": null, "free_log_std": false, "log_std_clip_param": 20.0, "no_final_linear": false, "vf_share_layers": false, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "lstm_weights_initializer": null, "lstm_weights_initializer_config": null, "lstm_bias_initializer": null, "lstm_bias_initializer_config": null, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "attention_use_n_prev_actions": 0, "attention_use_n_prev_rewards": 0, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": null, "custom_model_config": {}, "custom_action_dist": null, "custom_preprocessor": null, "encoder_latent_dim": null, "always_check_shapes": false, "lstm_use_prev_action_reward": -1, "_use_default_native_models": -1, "_disable_preprocessor_api": false, "_disable_action_flattening": false}, "_learner_connector": null, "add_default_connectors_to_learner_pipeline": true, "learner_config_dict": {}, "optimizer": {}, "_learner_class": null, "callbacks_on_algorithm_init": null, "callbacks_on_env_runners_recreated": null, "callbacks_on_offline_eval_runners_recreated": null, "callbacks_on_checkpoint_loaded": null, "callbacks_on_environment_created": null, "callbacks_on_episode_created": null, "callbacks_on_episode_start": null, "callbacks_on_episode_step": null, "callbacks_on_episode_end": null, "callbacks_on_evaluate_start": null, "callbacks_on_evaluate_end": null, "callbacks_on_evaluate_offline_start": null, "callbacks_on_evaluate_offline_end": null, "callbacks_on_sample_end": null, "callbacks_on_train_result": null, "explore": true, "enable_rl_module_and_learner": true, "enable_env_runner_and_connector_v2": true, "_prior_exploration_config": {"type": "StochasticSampling"}, "count_steps_by": "env_steps", "policy_map_capacity": 100, "policy_mapping_fn": "<function AlgorithmConfig.DEFAULT_POLICY_MAPPING_FN at 0x1680e9b20>", "policies_to_train": null, "policy_states_are_swappable": false, "observation_fn": null, "offline_data_class": null, "input_read_method": "read_parquet", "input_read_method_kwargs": {}, "input_read_schema": {}, "input_read_episodes": false, "input_read_sample_batches": false, "input_read_batch_size": null, "input_filesystem": null, "input_filesystem_kwargs": {}, "input_compress_columns": ["obs", "new_obs"], "input_spaces_jsonable": true, "materialize_data": false, "materialize_mapped_data": true, "map_batches_kwargs": {}, "iter_batches_kwargs": {}, "ignore_final_observation": false, "prelearner_class": null, "prelearner_buffer_class": null, "prelearner_buffer_kwargs": {}, "prelearner_module_synch_period": 10, "dataset_num_iters_per_learner": null, "input_config": {}, "actions_in_input_normalized": false, "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_config": {}, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "output_max_rows_per_file": null, "output_write_remaining_data": false, "output_write_method": "write_parquet", "output_write_method_kwargs": {}, "output_filesystem": null, "output_filesystem_kwargs": {}, "output_write_episodes": true, "offline_sampling": false, "evaluation_interval": 1, "evaluation_duration": 20, "evaluation_duration_unit": "episodes", "evaluation_sample_timeout_s": 120.0, "evaluation_auto_duration_min_env_steps_per_sample": 100, "evaluation_auto_duration_max_env_steps_per_sample": 2000, "evaluation_parallel_to_training": false, "evaluation_force_reset_envs_before_iteration": true, "evaluation_config": null, "off_policy_estimation_methods": {}, "ope_split_batch_by_episode": true, "evaluation_num_env_runners": 1, "in_evaluation": false, "sync_filters_on_rollout_workers_timeout_s": 10.0, "offline_evaluation_interval": null, "num_offline_eval_runners": 0, "offline_loss_for_module_fn": null, "offline_evaluation_duration": 1, "offline_evaluation_parallel_to_training": false, "offline_evaluation_timeout_s": 120.0, "num_cpus_per_offline_eval_runner": 1, "num_gpus_per_offline_eval_runner": 0, "custom_resources_per_offline_eval_runner": {}, "restart_failed_offline_eval_runners": true, "ignore_offline_eval_runner_failures": false, "max_num_offline_eval_runner_restarts": 1000, "offline_eval_runner_restore_timeout_s": 1800.0, "max_requests_in_flight_per_offline_eval_runner": 1, "validate_offline_eval_runners_after_construction": true, "offline_eval_runner_health_probe_timeout_s": 30.0, "offline_eval_rl_module_inference_only": false, "broadcast_offline_eval_runner_states": false, "offline_eval_batch_size_per_runner": 256, "dataset_num_iters_per_eval_runner": 1, "keep_per_episode_custom_metrics": false, "metrics_episode_collection_timeout_s": 60.0, "metrics_num_episodes_for_smoothing": 100, "min_time_s_per_iteration": null, "min_train_timesteps_per_iteration": 0, "min_sample_timesteps_per_iteration": 0, "log_gradients": true, "export_native_model_files": false, "checkpoint_trainable_policies_only": false, "logger_creator": null, "logger_config": null, "log_level": "WARN", "log_sys_usage": true, "fake_sampler": false, "seed": 8, "restart_failed_env_runners": true, "ignore_env_runner_failures": false, "max_num_env_runner_restarts": 1000, "delay_between_env_runner_restarts_s": 60.0, "restart_failed_sub_environments": false, "num_consecutive_env_runner_failures_tolerance": 100, "env_runner_health_probe_timeout_s": 30.0, "env_runner_restore_timeout_s": 1800.0, "_model_config": {}, "_rl_module_spec": "RLModuleSpec(module_class=None, observation_space=None, action_space=None, inference_only=False, learner_only=False, model_config=DefaultModelConfig(fcnet_hiddens=[60, 90], fcnet_activation='tanh', fcnet_kernel_initializer=None, fcnet_kernel_initializer_kwargs=None, fcnet_bias_initializer=None, fcnet_bias_initializer_kwargs=None, conv_filters=None, conv_activation='relu', conv_kernel_initializer=None, conv_kernel_initializer_kwargs=None, conv_bias_initializer=None, conv_bias_initializer_kwargs=None, head_fcnet_hiddens=[], head_fcnet_activation='relu', head_fcnet_kernel_initializer=None, head_fcnet_kernel_initializer_kwargs=None, head_fcnet_bias_initializer=None, head_fcnet_bias_initializer_kwargs=None, free_log_std=False, log_std_clip_param=20.0, vf_share_layers=True, use_lstm=False, max_seq_len=20, lstm_cell_size=256, lstm_use_prev_action=False, lstm_use_prev_reward=False, lstm_kernel_initializer=None, lstm_kernel_initializer_kwargs=None, lstm_bias_initializer=None, lstm_bias_initializer_kwargs=None), catalog_class=None, load_state_path=None, model_config_dict=None)", "algorithm_config_overrides_per_module": {}, "_per_module_overrides": {}, "_validate_config": true, "_use_msgpack_checkpoints": false, "_torch_grad_scaler_class": null, "_torch_lr_scheduler_classes": null, "_tf_policy_handles_more_than_one_loss": false, "_disable_preprocessor_api": false, "_disable_action_flattening": false, "_disable_initialize_loss_from_dummy_batch": false, "_dont_auto_sync_env_runner_states": false, "env_task_fn": -1, "enable_connectors": -1, "simple_optimizer": false, "policy_map_cache": -1, "worker_cls": -1, "synchronize_filters": -1, "enable_async_evaluation": -1, "custom_async_evaluation_function": -1, "_enable_rl_module_api": -1, "auto_wrap_old_gym_envs": -1, "always_attach_evaluation_results": -1, "replay_sequence_length": null, "_disable_execution_plan_api": -1, "use_critic": true, "use_gae": true, "use_kl_loss": true, "kl_coeff": 0.7464963036515, "kl_target": 0.0270990929592, "vf_loss_coeff": 0.6688075857018, "entropy_coeff": 0.0090570820258, "clip_param": 0.1221781641624, "vf_clip_param": 0.1027808522125, "entropy_coeff_schedule": null, "lr_schedule": null, "sgd_minibatch_size": -1, "vf_share_layers": -1, "__stdout_file__": null, "__stderr_file__": null, "lambda": 0.9099046732075, "input": "sampler", "policies": {"default_policy": [null, null, null, null]}, "callbacks": "<class 'ray.rllib.callbacks.callbacks.RLlibCallback'>", "create_env_on_driver": false, "custom_eval_function": null, "framework": "torch"}, "time_since_restore": 32.409549713134766, "iterations_since_restore": 18, "perf": {"cpu_util_percent": 49.96666666666666, "ram_util_percent": 83.23333333333333}}
{"timers": {"training_iteration": 2.227120476773253, "restore_env_runners": 1.3735722164493895e-05, "training_step": 2.2269629763630636, "env_runner_sampling_timer": 2.109732832061809, "learner_update_timer": 0.11375270475490366, "synch_weights": 0.0008231750642563702, "restore_eval_env_runners": 1.1572840714297312e-05, "evaluation_iteration": 0.12616868444221055, "synch_eval_env_connectors": 0.00013685517687768225, "synch_env_connectors": 4.786777090055117e-06}, "env_runners": {"sample": 0.0059465506107204535, "module_episode_returns_mean": {"default_policy": 7.2200000000000015}, "env_to_module_connector": {"timers": {"connectors": {"add_states_from_episodes_to_batch": 1.939677693168937e-06, "numpy_to_tensor": 1.1609250890529304e-05, "add_observations_from_episodes_to_batch": 3.658581241843978e-06, "add_time_dim_to_batch_and_zero_pad": 2.8932045851980982e-06, "batch_individual_items": 8.298393859770287e-06}}, "connector_pipeline_timer": 5.407848471613074e-05}, "env_reset_timer": 4.779034365278456e-05, "module_to_env_connector": {"timers": {"connectors": {"tensor_to_numpy": 1.6316158640022892e-05, "normalize_and_clip_actions": 1.1165017050037484e-05, "listify_data_for_vector_env": 1.4528482843640457e-05, "remove_single_ts_time_rank_from_batch": 6.694163574214556e-07, "un_batch_to_individual_items": 6.4211472589613565e-06, "get_actions": 5.215234540287908e-05}}, "connector_pipeline_timer": 0.00013231117445052293}, "num_module_steps_sampled": {"default_policy": 5000.0}, "weights_seq_no": 18.0, "agent_episode_returns_mean": {"default_agent": 7.2200000000000015}, "env_to_module_sum_episodes_length_out": 10.36823839457432, "env_step_timer": 2.198765334748753e-05, "num_env_steps_sampled": 5000.0, "episode_return_mean": 7.2200000000000015, "num_episodes_lifetime": -524375.0, "num_module_steps_sampled_lifetime": {"default_policy": -10487500.0}, "time_between_sampling": 0.0022490334112377007, "env_to_module_sum_episodes_length_in": 10.36823839457432, "rlmodule_inference_timer": 4.36093523250466e-05, "episode_duration_sec_mean": 0.006012907499913125, "num_env_steps_sampled_lifetime": -10487500.0, "episode_len_max": 20, "episode_len_mean": 20.0, "num_episodes": 250.0, "episode_return_max": 8.5, "num_agent_steps_sampled": {"default_agent": 5000.0}, "episode_len_min": 20, "episode_return_min": -11.5, "num_agent_steps_sampled_lifetime": {"default_agent": -10487500.0}, "num_env_steps_sampled_lifetime_throughput": 3310.83685081917}, "learners": {"__all_modules__": {"num_env_steps_trained": 31500, "learner_connector": {"timers": {"connectors": {"add_one_ts_to_episodes_and_truncate": 0.008631220213560373, "add_columns_from_episodes_to_train_batch": 0.03445649336234077, "general_advantage_estimation": 0.006482643948128483, "add_states_from_episodes_to_batch": 3.660764339407472e-06, "add_time_dim_to_batch_and_zero_pad": 1.2461216461390131e-05, "batch_individual_items": 0.03744944100912371, "numpy_to_tensor": 6.902483112887293e-05, "add_observations_from_episodes_to_batch": 0.0008129323212056603}}, "connector_pipeline_timer": 0.08805061954675346}, "num_module_steps_trained_lifetime": 114000, "learner_connector_sum_episodes_length_in": 5000.0, "num_module_steps_trained": 6000, "learner_connector_sum_episodes_length_out": 5250.0, "num_env_steps_trained_lifetime": 598500, "num_non_trainable_parameters": 0, "num_trainable_parameters": 6003, "num_env_steps_trained_lifetime_throughput": 2095900.6459159853, "num_module_steps_trained_throughput": 400596.6555768764, "num_module_steps_trained_lifetime_throughput": 400048.19109798083}, "default_policy": {"mean_kl_loss": 0.00025957918842323124, "curr_kl_coeff": 1.423828734914423e-06, "module_train_batch_size_mean": 1000.0, "weights_seq_no": 19.0, "default_optimizer_learning_rate": 0.0002847858517, "num_trainable_parameters": 6003, "num_module_steps_trained_lifetime": 114000, "entropy": 0.4804908037185669, "curr_entropy_coeff": 0.0090570820258, "num_module_steps_trained": 6000, "policy_loss": -0.044341981410980225, "vf_loss": 0.10278083384037018, "total_loss": 0.02004677802324295, "diff_num_grad_updates_vs_sampler_policy": 1.0, "vf_loss_unclipped": 26.0632381439209, "vf_explained_var": 0.005652189254760742, "gradients_default_optimizer_global_norm": 0.03202617168426514, "num_module_steps_trained_lifetime_throughput": 400960.72753280384}}, "num_training_step_calls_per_iteration": 1, "evaluation": {"env_runners": {"module_to_env_connector": {"timers": {"connectors": {"un_batch_to_individual_items": 5.285351058424088e-06, "get_actions": 3.5837585008041415e-05, "tensor_to_numpy": 1.2946677565657325e-05, "listify_data_for_vector_env": 1.0747335407240399e-05, "normalize_and_clip_actions": 9.24589306521516e-06, "remove_single_ts_time_rank_from_batch": 5.652726405476984e-07}}, "connector_pipeline_timer": 9.953316389235247e-05}, "env_step_timer": 1.365108668406586e-05, "env_to_module_connector": {"timers": {"connectors": {"add_observations_from_episodes_to_batch": 2.7693828860581764e-06, "add_time_dim_to_batch_and_zero_pad": 2.2724412113038063e-06, "batch_individual_items": 6.043114233023137e-06, "add_states_from_episodes_to_batch": 1.6084028687770582e-06, "numpy_to_tensor": 8.077116227255577e-06}}, "connector_pipeline_timer": 4.16885923733264e-05}, "episode_duration_sec_mean": 0.004789908279199153, "num_episodes": 20, "episode_return_min": -14.5, "agent_episode_returns_mean": {"default_agent": 1.55}, "sample": 0.11211216414787956, "num_agent_steps_sampled_lifetime": {"default_agent": 7600}, "env_to_module_sum_episodes_length_out": 10.368238394574323, "num_env_steps_sampled": 400, "module_episode_returns_mean": {"default_policy": 1.55}, "rlmodule_inference_timer": 2.687792998934895e-05, "episode_return_max": 14.5, "env_reset_timer": 0.0009199788361151612, "num_agent_steps_sampled": {"default_agent": 400}, "episode_return_mean": 1.55, "num_episodes_lifetime": 380, "weights_seq_no": 19.0, "env_to_module_sum_episodes_length_in": 10.368238394574323, "num_env_steps_sampled_lifetime": 95400, "num_module_steps_sampled": {"default_policy": 400}, "episode_len_max": 20, "episode_len_mean": 20.0, "episode_len_min": 20, "num_module_steps_sampled_lifetime": {"default_policy": 7600}, "time_between_sampling": 1.757952716970282}, "num_healthy_workers": 1, "actor_manager_num_outstanding_async_reqs": 0, "num_remote_worker_restarts": 0}, "num_env_steps_sampled_lifetime": -10487500.0, "fault_tolerance": {"num_healthy_workers": 0, "num_remote_worker_restarts": 0}, "env_runner_group": {"actor_manager_num_outstanding_async_reqs": 0}, "done": false, "training_iteration": 19, "trial_id": "4d657_00000", "date": "2025-08-11_19-21-26", "timestamp": 1754932886, "time_this_iter_s": 2.114190101623535, "time_total_s": 34.5237398147583, "pid": 14261, "hostname": "Mac", "node_ip": "127.0.0.1", "config": {"exploration_config": {}, "extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "placement_strategy": "PACK", "num_gpus": 0, "_fake_gpus": false, "num_cpus_for_main_process": 2, "eager_tracing": true, "eager_max_retraces": 20, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "torch_compile_learner": false, "torch_compile_learner_what_to_compile": "forward_train", "torch_compile_learner_dynamo_backend": "aot_eager", "torch_compile_learner_dynamo_mode": null, "torch_compile_worker": false, "torch_compile_worker_dynamo_backend": "aot_eager", "torch_compile_worker_dynamo_mode": null, "torch_ddp_kwargs": {}, "torch_skip_nan_gradients": false, "env": "Umbrella", "env_config": {}, "observation_space": null, "action_space": null, "clip_rewards": null, "normalize_actions": true, "clip_actions": false, "_is_atari": null, "disable_env_checking": false, "render_env": false, "action_mask_key": "action_mask", "env_runner_cls": null, "num_env_runners": 0, "create_local_env_runner": true, "num_envs_per_env_runner": 1, "gym_env_vectorize_mode": "SYNC", "num_cpus_per_env_runner": 1, "num_gpus_per_env_runner": 0, "custom_resources_per_env_runner": {}, "validate_env_runners_after_construction": true, "episodes_to_numpy": true, "max_requests_in_flight_per_env_runner": 1, "sample_timeout_s": 60.0, "_env_to_module_connector": null, "add_default_connectors_to_env_to_module_pipeline": true, "_module_to_env_connector": null, "add_default_connectors_to_module_to_env_pipeline": true, "merge_env_runner_states": "training_only", "broadcast_env_runner_states": true, "episode_lookback_horizon": 1, "rollout_fragment_length": "auto", "batch_mode": "complete_episodes", "compress_observations": false, "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "enable_tf1_exec_eagerly": false, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "preprocessor_pref": "deepmind", "observation_filter": "NoFilter", "update_worker_filter_stats": true, "use_worker_filter_stats": true, "sampler_perf_stats_ema_coef": null, "_is_online": true, "num_learners": 0, "num_gpus_per_learner": 0, "num_cpus_per_learner": "auto", "num_aggregator_actors_per_learner": 0, "max_requests_in_flight_per_aggregator_actor": 3, "local_gpu_idx": 0, "max_requests_in_flight_per_learner": 3, "gamma": 1, "lr": 0.0002847858517, "grad_clip": 0.5, "grad_clip_by": "global_norm", "_train_batch_size_per_learner": 5000, "train_batch_size": 4000, "num_epochs": 1, "minibatch_size": 1000, "shuffle_batch_per_epoch": true, "model": {"fcnet_hiddens": [256, 256], "fcnet_activation": "tanh", "fcnet_weights_initializer": null, "fcnet_weights_initializer_config": null, "fcnet_bias_initializer": null, "fcnet_bias_initializer_config": null, "conv_filters": null, "conv_activation": "relu", "conv_kernel_initializer": null, "conv_kernel_initializer_config": null, "conv_bias_initializer": null, "conv_bias_initializer_config": null, "conv_transpose_kernel_initializer": null, "conv_transpose_kernel_initializer_config": null, "conv_transpose_bias_initializer": null, "conv_transpose_bias_initializer_config": null, "post_fcnet_hiddens": [], "post_fcnet_activation": "relu", "post_fcnet_weights_initializer": null, "post_fcnet_weights_initializer_config": null, "post_fcnet_bias_initializer": null, "post_fcnet_bias_initializer_config": null, "free_log_std": false, "log_std_clip_param": 20.0, "no_final_linear": false, "vf_share_layers": false, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "lstm_weights_initializer": null, "lstm_weights_initializer_config": null, "lstm_bias_initializer": null, "lstm_bias_initializer_config": null, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "attention_use_n_prev_actions": 0, "attention_use_n_prev_rewards": 0, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": null, "custom_model_config": {}, "custom_action_dist": null, "custom_preprocessor": null, "encoder_latent_dim": null, "always_check_shapes": false, "lstm_use_prev_action_reward": -1, "_use_default_native_models": -1, "_disable_preprocessor_api": false, "_disable_action_flattening": false}, "_learner_connector": null, "add_default_connectors_to_learner_pipeline": true, "learner_config_dict": {}, "optimizer": {}, "_learner_class": null, "callbacks_on_algorithm_init": null, "callbacks_on_env_runners_recreated": null, "callbacks_on_offline_eval_runners_recreated": null, "callbacks_on_checkpoint_loaded": null, "callbacks_on_environment_created": null, "callbacks_on_episode_created": null, "callbacks_on_episode_start": null, "callbacks_on_episode_step": null, "callbacks_on_episode_end": null, "callbacks_on_evaluate_start": null, "callbacks_on_evaluate_end": null, "callbacks_on_evaluate_offline_start": null, "callbacks_on_evaluate_offline_end": null, "callbacks_on_sample_end": null, "callbacks_on_train_result": null, "explore": true, "enable_rl_module_and_learner": true, "enable_env_runner_and_connector_v2": true, "_prior_exploration_config": {"type": "StochasticSampling"}, "count_steps_by": "env_steps", "policy_map_capacity": 100, "policy_mapping_fn": "<function AlgorithmConfig.DEFAULT_POLICY_MAPPING_FN at 0x1680e9b20>", "policies_to_train": null, "policy_states_are_swappable": false, "observation_fn": null, "offline_data_class": null, "input_read_method": "read_parquet", "input_read_method_kwargs": {}, "input_read_schema": {}, "input_read_episodes": false, "input_read_sample_batches": false, "input_read_batch_size": null, "input_filesystem": null, "input_filesystem_kwargs": {}, "input_compress_columns": ["obs", "new_obs"], "input_spaces_jsonable": true, "materialize_data": false, "materialize_mapped_data": true, "map_batches_kwargs": {}, "iter_batches_kwargs": {}, "ignore_final_observation": false, "prelearner_class": null, "prelearner_buffer_class": null, "prelearner_buffer_kwargs": {}, "prelearner_module_synch_period": 10, "dataset_num_iters_per_learner": null, "input_config": {}, "actions_in_input_normalized": false, "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_config": {}, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "output_max_rows_per_file": null, "output_write_remaining_data": false, "output_write_method": "write_parquet", "output_write_method_kwargs": {}, "output_filesystem": null, "output_filesystem_kwargs": {}, "output_write_episodes": true, "offline_sampling": false, "evaluation_interval": 1, "evaluation_duration": 20, "evaluation_duration_unit": "episodes", "evaluation_sample_timeout_s": 120.0, "evaluation_auto_duration_min_env_steps_per_sample": 100, "evaluation_auto_duration_max_env_steps_per_sample": 2000, "evaluation_parallel_to_training": false, "evaluation_force_reset_envs_before_iteration": true, "evaluation_config": null, "off_policy_estimation_methods": {}, "ope_split_batch_by_episode": true, "evaluation_num_env_runners": 1, "in_evaluation": false, "sync_filters_on_rollout_workers_timeout_s": 10.0, "offline_evaluation_interval": null, "num_offline_eval_runners": 0, "offline_loss_for_module_fn": null, "offline_evaluation_duration": 1, "offline_evaluation_parallel_to_training": false, "offline_evaluation_timeout_s": 120.0, "num_cpus_per_offline_eval_runner": 1, "num_gpus_per_offline_eval_runner": 0, "custom_resources_per_offline_eval_runner": {}, "restart_failed_offline_eval_runners": true, "ignore_offline_eval_runner_failures": false, "max_num_offline_eval_runner_restarts": 1000, "offline_eval_runner_restore_timeout_s": 1800.0, "max_requests_in_flight_per_offline_eval_runner": 1, "validate_offline_eval_runners_after_construction": true, "offline_eval_runner_health_probe_timeout_s": 30.0, "offline_eval_rl_module_inference_only": false, "broadcast_offline_eval_runner_states": false, "offline_eval_batch_size_per_runner": 256, "dataset_num_iters_per_eval_runner": 1, "keep_per_episode_custom_metrics": false, "metrics_episode_collection_timeout_s": 60.0, "metrics_num_episodes_for_smoothing": 100, "min_time_s_per_iteration": null, "min_train_timesteps_per_iteration": 0, "min_sample_timesteps_per_iteration": 0, "log_gradients": true, "export_native_model_files": false, "checkpoint_trainable_policies_only": false, "logger_creator": null, "logger_config": null, "log_level": "WARN", "log_sys_usage": true, "fake_sampler": false, "seed": 8, "restart_failed_env_runners": true, "ignore_env_runner_failures": false, "max_num_env_runner_restarts": 1000, "delay_between_env_runner_restarts_s": 60.0, "restart_failed_sub_environments": false, "num_consecutive_env_runner_failures_tolerance": 100, "env_runner_health_probe_timeout_s": 30.0, "env_runner_restore_timeout_s": 1800.0, "_model_config": {}, "_rl_module_spec": "RLModuleSpec(module_class=None, observation_space=None, action_space=None, inference_only=False, learner_only=False, model_config=DefaultModelConfig(fcnet_hiddens=[60, 90], fcnet_activation='tanh', fcnet_kernel_initializer=None, fcnet_kernel_initializer_kwargs=None, fcnet_bias_initializer=None, fcnet_bias_initializer_kwargs=None, conv_filters=None, conv_activation='relu', conv_kernel_initializer=None, conv_kernel_initializer_kwargs=None, conv_bias_initializer=None, conv_bias_initializer_kwargs=None, head_fcnet_hiddens=[], head_fcnet_activation='relu', head_fcnet_kernel_initializer=None, head_fcnet_kernel_initializer_kwargs=None, head_fcnet_bias_initializer=None, head_fcnet_bias_initializer_kwargs=None, free_log_std=False, log_std_clip_param=20.0, vf_share_layers=True, use_lstm=False, max_seq_len=20, lstm_cell_size=256, lstm_use_prev_action=False, lstm_use_prev_reward=False, lstm_kernel_initializer=None, lstm_kernel_initializer_kwargs=None, lstm_bias_initializer=None, lstm_bias_initializer_kwargs=None), catalog_class=None, load_state_path=None, model_config_dict=None)", "algorithm_config_overrides_per_module": {}, "_per_module_overrides": {}, "_validate_config": true, "_use_msgpack_checkpoints": false, "_torch_grad_scaler_class": null, "_torch_lr_scheduler_classes": null, "_tf_policy_handles_more_than_one_loss": false, "_disable_preprocessor_api": false, "_disable_action_flattening": false, "_disable_initialize_loss_from_dummy_batch": false, "_dont_auto_sync_env_runner_states": false, "env_task_fn": -1, "enable_connectors": -1, "simple_optimizer": false, "policy_map_cache": -1, "worker_cls": -1, "synchronize_filters": -1, "enable_async_evaluation": -1, "custom_async_evaluation_function": -1, "_enable_rl_module_api": -1, "auto_wrap_old_gym_envs": -1, "always_attach_evaluation_results": -1, "replay_sequence_length": null, "_disable_execution_plan_api": -1, "use_critic": true, "use_gae": true, "use_kl_loss": true, "kl_coeff": 0.7464963036515, "kl_target": 0.0270990929592, "vf_loss_coeff": 0.6688075857018, "entropy_coeff": 0.0090570820258, "clip_param": 0.1221781641624, "vf_clip_param": 0.1027808522125, "entropy_coeff_schedule": null, "lr_schedule": null, "sgd_minibatch_size": -1, "vf_share_layers": -1, "__stdout_file__": null, "__stderr_file__": null, "lambda": 0.9099046732075, "input": "sampler", "policies": {"default_policy": [null, null, null, null]}, "callbacks": "<class 'ray.rllib.callbacks.callbacks.RLlibCallback'>", "create_env_on_driver": false, "custom_eval_function": null, "framework": "torch"}, "time_since_restore": 34.5237398147583, "iterations_since_restore": 19, "perf": {"cpu_util_percent": 57.93333333333334, "ram_util_percent": 84.43333333333334}}
{"timers": {"training_iteration": 2.2202238040855433, "restore_env_runners": 1.3654614498049293e-05, "training_step": 2.2200659161895415, "env_runner_sampling_timer": 2.1030421674910236, "learner_update_timer": 0.11354898437771863, "synch_weights": 0.0008203116443625583, "restore_eval_env_runners": 1.1522112802096408e-05, "evaluation_iteration": 0.1259464509282382, "synch_eval_env_connectors": 0.000136484964491837, "synch_env_connectors": 4.780569706223553e-06}, "env_runners": {"sample": 0.005547788559039271, "module_episode_returns_mean": {"default_policy": 6.580000000000001}, "env_to_module_connector": {"timers": {"connectors": {"add_states_from_episodes_to_batch": 1.7594510369791094e-06, "numpy_to_tensor": 8.873886473369584e-06, "add_observations_from_episodes_to_batch": 3.08177828060206e-06, "add_time_dim_to_batch_and_zero_pad": 2.449715529026333e-06, "batch_individual_items": 6.64705491191298e-06}}, "connector_pipeline_timer": 4.491947849829247e-05}, "env_reset_timer": 4.6207304107959247e-05, "module_to_env_connector": {"timers": {"connectors": {"tensor_to_numpy": 1.3598821422398488e-05, "normalize_and_clip_actions": 9.764726083975315e-06, "listify_data_for_vector_env": 1.1508467492110863e-05, "remove_single_ts_time_rank_from_batch": 5.983274284308768e-07, "un_batch_to_individual_items": 5.6234102959754e-06, "get_actions": 3.99942640459257e-05}}, "connector_pipeline_timer": 0.00010728101277080525}, "num_module_steps_sampled": {"default_policy": 5000.0}, "weights_seq_no": 19.0, "agent_episode_returns_mean": {"default_agent": 6.580000000000001}, "env_to_module_sum_episodes_length_out": 10.36823839457432, "env_step_timer": 1.4558719277793492e-05, "num_env_steps_sampled": 5000.0, "episode_return_mean": 6.580000000000001, "num_episodes_lifetime": -555250.0, "num_module_steps_sampled_lifetime": {"default_policy": -11105000.0}, "time_between_sampling": 0.002041739599600117, "env_to_module_sum_episodes_length_in": 10.36823839457432, "rlmodule_inference_timer": 2.8446240853033185e-05, "episode_duration_sec_mean": 0.004706462500616909, "num_env_steps_sampled_lifetime": -11105000.0, "episode_len_max": 20, "episode_len_mean": 20.0, "num_episodes": 250.0, "episode_return_max": 8.5, "num_agent_steps_sampled": {"default_agent": 5000.0}, "episode_len_min": 20, "episode_return_min": -11.5, "num_agent_steps_sampled_lifetime": {"default_agent": -11105000.0}, "num_env_steps_sampled_lifetime_throughput": 3591.5947891534875}, "learners": {"__all_modules__": {"num_env_steps_trained": 31500, "learner_connector": {"timers": {"connectors": {"add_one_ts_to_episodes_and_truncate": 0.008623261761711394, "add_columns_from_episodes_to_train_batch": 0.03445376092913415, "general_advantage_estimation": 0.006473313758926445, "add_states_from_episodes_to_batch": 3.656237266249246e-06, "add_time_dim_to_batch_and_zero_pad": 1.244576461574691e-05, "batch_individual_items": 0.03738515909849454, "numpy_to_tensor": 6.8955003141269e-05, "add_observations_from_episodes_to_batch": 0.0008133304983156923}}, "connector_pipeline_timer": 0.08796634419178265}, "num_module_steps_trained_lifetime": 120000, "learner_connector_sum_episodes_length_in": 5000.0, "num_module_steps_trained": 6000, "learner_connector_sum_episodes_length_out": 5250.0, "num_env_steps_trained_lifetime": 630000, "num_non_trainable_parameters": 0, "num_trainable_parameters": 6003, "num_env_steps_trained_lifetime_throughput": 2088136.6301638552, "num_module_steps_trained_throughput": 399062.34472004266, "num_module_steps_trained_lifetime_throughput": 398531.76584500214}, "default_policy": {"mean_kl_loss": 0.0006841972935944796, "curr_kl_coeff": 7.119143674572115e-07, "module_train_batch_size_mean": 1000.0, "weights_seq_no": 20.0, "default_optimizer_learning_rate": 0.0002847858517, "num_trainable_parameters": 6003, "num_module_steps_trained_lifetime": 120000, "entropy": 0.4970702528953552, "curr_entropy_coeff": 0.0090570820258, "num_module_steps_trained": 6000, "policy_loss": -0.013586264103651047, "vf_loss": 0.10278083384037018, "total_loss": 0.050652336329221725, "diff_num_grad_updates_vs_sampler_policy": 1.0, "vf_loss_unclipped": 26.30100440979004, "vf_explained_var": 0.006448864936828613, "gradients_default_optimizer_global_norm": 0.044757142663002014, "num_module_steps_trained_lifetime_throughput": 399375.78657531657}}, "num_training_step_calls_per_iteration": 1, "evaluation": {"env_runners": {"module_to_env_connector": {"timers": {"connectors": {"un_batch_to_individual_items": 5.295977060278803e-06, "get_actions": 3.575515840092649e-05, "tensor_to_numpy": 1.2918309346847016e-05, "listify_data_for_vector_env": 1.0716290397787611e-05, "normalize_and_clip_actions": 9.159215134217395e-06, "remove_single_ts_time_rank_from_batch": 5.708466521546575e-07}}, "connector_pipeline_timer": 9.941921072828121e-05}, "env_step_timer": 1.3652078251950327e-05, "env_to_module_connector": {"timers": {"connectors": {"add_observations_from_episodes_to_batch": 2.782262096179678e-06, "add_time_dim_to_batch_and_zero_pad": 2.25317593340121e-06, "batch_individual_items": 6.04565079782366e-06, "add_states_from_episodes_to_batch": 1.599058991646204e-06, "numpy_to_tensor": 8.207446060721594e-06}}, "connector_pipeline_timer": 4.1853811061320604e-05}, "episode_duration_sec_mean": 0.004790854570455849, "num_episodes": 20, "episode_return_min": -14.5, "agent_episode_returns_mean": {"default_agent": 1.55}, "sample": 0.11195758417573225, "num_agent_steps_sampled_lifetime": {"default_agent": 8000}, "env_to_module_sum_episodes_length_out": 10.368238394574323, "num_env_steps_sampled": 400, "module_episode_returns_mean": {"default_policy": 1.55}, "rlmodule_inference_timer": 2.697992744444067e-05, "episode_return_max": 14.5, "env_reset_timer": 0.0009114477978985507, "num_agent_steps_sampled": {"default_agent": 400}, "episode_return_mean": 1.55, "num_episodes_lifetime": 400, "weights_seq_no": 20.0, "env_to_module_sum_episodes_length_in": 10.368238394574323, "num_env_steps_sampled_lifetime": 100400, "num_module_steps_sampled": {"default_policy": 400}, "episode_len_max": 20, "episode_len_mean": 20.0, "episode_len_min": 20, "num_module_steps_sampled_lifetime": {"default_policy": 8000}, "time_between_sampling": 1.7559570893805214}, "num_healthy_workers": 1, "actor_manager_num_outstanding_async_reqs": 0, "num_remote_worker_restarts": 0}, "num_env_steps_sampled_lifetime": -11105000.0, "fault_tolerance": {"num_healthy_workers": 0, "num_remote_worker_restarts": 0}, "env_runner_group": {"actor_manager_num_outstanding_async_reqs": 0}, "done": true, "training_iteration": 20, "trial_id": "4d657_00000", "date": "2025-08-11_19-21-27", "timestamp": 1754932887, "time_this_iter_s": 1.6419038772583008, "time_total_s": 36.1656436920166, "pid": 14261, "hostname": "Mac", "node_ip": "127.0.0.1", "config": {"exploration_config": {}, "extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "placement_strategy": "PACK", "num_gpus": 0, "_fake_gpus": false, "num_cpus_for_main_process": 2, "eager_tracing": true, "eager_max_retraces": 20, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "torch_compile_learner": false, "torch_compile_learner_what_to_compile": "forward_train", "torch_compile_learner_dynamo_backend": "aot_eager", "torch_compile_learner_dynamo_mode": null, "torch_compile_worker": false, "torch_compile_worker_dynamo_backend": "aot_eager", "torch_compile_worker_dynamo_mode": null, "torch_ddp_kwargs": {}, "torch_skip_nan_gradients": false, "env": "Umbrella", "env_config": {}, "observation_space": null, "action_space": null, "clip_rewards": null, "normalize_actions": true, "clip_actions": false, "_is_atari": null, "disable_env_checking": false, "render_env": false, "action_mask_key": "action_mask", "env_runner_cls": null, "num_env_runners": 0, "create_local_env_runner": true, "num_envs_per_env_runner": 1, "gym_env_vectorize_mode": "SYNC", "num_cpus_per_env_runner": 1, "num_gpus_per_env_runner": 0, "custom_resources_per_env_runner": {}, "validate_env_runners_after_construction": true, "episodes_to_numpy": true, "max_requests_in_flight_per_env_runner": 1, "sample_timeout_s": 60.0, "_env_to_module_connector": null, "add_default_connectors_to_env_to_module_pipeline": true, "_module_to_env_connector": null, "add_default_connectors_to_module_to_env_pipeline": true, "merge_env_runner_states": "training_only", "broadcast_env_runner_states": true, "episode_lookback_horizon": 1, "rollout_fragment_length": "auto", "batch_mode": "complete_episodes", "compress_observations": false, "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "enable_tf1_exec_eagerly": false, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "preprocessor_pref": "deepmind", "observation_filter": "NoFilter", "update_worker_filter_stats": true, "use_worker_filter_stats": true, "sampler_perf_stats_ema_coef": null, "_is_online": true, "num_learners": 0, "num_gpus_per_learner": 0, "num_cpus_per_learner": "auto", "num_aggregator_actors_per_learner": 0, "max_requests_in_flight_per_aggregator_actor": 3, "local_gpu_idx": 0, "max_requests_in_flight_per_learner": 3, "gamma": 1, "lr": 0.0002847858517, "grad_clip": 0.5, "grad_clip_by": "global_norm", "_train_batch_size_per_learner": 5000, "train_batch_size": 4000, "num_epochs": 1, "minibatch_size": 1000, "shuffle_batch_per_epoch": true, "model": {"fcnet_hiddens": [256, 256], "fcnet_activation": "tanh", "fcnet_weights_initializer": null, "fcnet_weights_initializer_config": null, "fcnet_bias_initializer": null, "fcnet_bias_initializer_config": null, "conv_filters": null, "conv_activation": "relu", "conv_kernel_initializer": null, "conv_kernel_initializer_config": null, "conv_bias_initializer": null, "conv_bias_initializer_config": null, "conv_transpose_kernel_initializer": null, "conv_transpose_kernel_initializer_config": null, "conv_transpose_bias_initializer": null, "conv_transpose_bias_initializer_config": null, "post_fcnet_hiddens": [], "post_fcnet_activation": "relu", "post_fcnet_weights_initializer": null, "post_fcnet_weights_initializer_config": null, "post_fcnet_bias_initializer": null, "post_fcnet_bias_initializer_config": null, "free_log_std": false, "log_std_clip_param": 20.0, "no_final_linear": false, "vf_share_layers": false, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "lstm_weights_initializer": null, "lstm_weights_initializer_config": null, "lstm_bias_initializer": null, "lstm_bias_initializer_config": null, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "attention_use_n_prev_actions": 0, "attention_use_n_prev_rewards": 0, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": null, "custom_model_config": {}, "custom_action_dist": null, "custom_preprocessor": null, "encoder_latent_dim": null, "always_check_shapes": false, "lstm_use_prev_action_reward": -1, "_use_default_native_models": -1, "_disable_preprocessor_api": false, "_disable_action_flattening": false}, "_learner_connector": null, "add_default_connectors_to_learner_pipeline": true, "learner_config_dict": {}, "optimizer": {}, "_learner_class": null, "callbacks_on_algorithm_init": null, "callbacks_on_env_runners_recreated": null, "callbacks_on_offline_eval_runners_recreated": null, "callbacks_on_checkpoint_loaded": null, "callbacks_on_environment_created": null, "callbacks_on_episode_created": null, "callbacks_on_episode_start": null, "callbacks_on_episode_step": null, "callbacks_on_episode_end": null, "callbacks_on_evaluate_start": null, "callbacks_on_evaluate_end": null, "callbacks_on_evaluate_offline_start": null, "callbacks_on_evaluate_offline_end": null, "callbacks_on_sample_end": null, "callbacks_on_train_result": null, "explore": true, "enable_rl_module_and_learner": true, "enable_env_runner_and_connector_v2": true, "_prior_exploration_config": {"type": "StochasticSampling"}, "count_steps_by": "env_steps", "policy_map_capacity": 100, "policy_mapping_fn": "<function AlgorithmConfig.DEFAULT_POLICY_MAPPING_FN at 0x1680e9b20>", "policies_to_train": null, "policy_states_are_swappable": false, "observation_fn": null, "offline_data_class": null, "input_read_method": "read_parquet", "input_read_method_kwargs": {}, "input_read_schema": {}, "input_read_episodes": false, "input_read_sample_batches": false, "input_read_batch_size": null, "input_filesystem": null, "input_filesystem_kwargs": {}, "input_compress_columns": ["obs", "new_obs"], "input_spaces_jsonable": true, "materialize_data": false, "materialize_mapped_data": true, "map_batches_kwargs": {}, "iter_batches_kwargs": {}, "ignore_final_observation": false, "prelearner_class": null, "prelearner_buffer_class": null, "prelearner_buffer_kwargs": {}, "prelearner_module_synch_period": 10, "dataset_num_iters_per_learner": null, "input_config": {}, "actions_in_input_normalized": false, "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_config": {}, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "output_max_rows_per_file": null, "output_write_remaining_data": false, "output_write_method": "write_parquet", "output_write_method_kwargs": {}, "output_filesystem": null, "output_filesystem_kwargs": {}, "output_write_episodes": true, "offline_sampling": false, "evaluation_interval": 1, "evaluation_duration": 20, "evaluation_duration_unit": "episodes", "evaluation_sample_timeout_s": 120.0, "evaluation_auto_duration_min_env_steps_per_sample": 100, "evaluation_auto_duration_max_env_steps_per_sample": 2000, "evaluation_parallel_to_training": false, "evaluation_force_reset_envs_before_iteration": true, "evaluation_config": null, "off_policy_estimation_methods": {}, "ope_split_batch_by_episode": true, "evaluation_num_env_runners": 1, "in_evaluation": false, "sync_filters_on_rollout_workers_timeout_s": 10.0, "offline_evaluation_interval": null, "num_offline_eval_runners": 0, "offline_loss_for_module_fn": null, "offline_evaluation_duration": 1, "offline_evaluation_parallel_to_training": false, "offline_evaluation_timeout_s": 120.0, "num_cpus_per_offline_eval_runner": 1, "num_gpus_per_offline_eval_runner": 0, "custom_resources_per_offline_eval_runner": {}, "restart_failed_offline_eval_runners": true, "ignore_offline_eval_runner_failures": false, "max_num_offline_eval_runner_restarts": 1000, "offline_eval_runner_restore_timeout_s": 1800.0, "max_requests_in_flight_per_offline_eval_runner": 1, "validate_offline_eval_runners_after_construction": true, "offline_eval_runner_health_probe_timeout_s": 30.0, "offline_eval_rl_module_inference_only": false, "broadcast_offline_eval_runner_states": false, "offline_eval_batch_size_per_runner": 256, "dataset_num_iters_per_eval_runner": 1, "keep_per_episode_custom_metrics": false, "metrics_episode_collection_timeout_s": 60.0, "metrics_num_episodes_for_smoothing": 100, "min_time_s_per_iteration": null, "min_train_timesteps_per_iteration": 0, "min_sample_timesteps_per_iteration": 0, "log_gradients": true, "export_native_model_files": false, "checkpoint_trainable_policies_only": false, "logger_creator": null, "logger_config": null, "log_level": "WARN", "log_sys_usage": true, "fake_sampler": false, "seed": 8, "restart_failed_env_runners": true, "ignore_env_runner_failures": false, "max_num_env_runner_restarts": 1000, "delay_between_env_runner_restarts_s": 60.0, "restart_failed_sub_environments": false, "num_consecutive_env_runner_failures_tolerance": 100, "env_runner_health_probe_timeout_s": 30.0, "env_runner_restore_timeout_s": 1800.0, "_model_config": {}, "_rl_module_spec": "RLModuleSpec(module_class=None, observation_space=None, action_space=None, inference_only=False, learner_only=False, model_config=DefaultModelConfig(fcnet_hiddens=[60, 90], fcnet_activation='tanh', fcnet_kernel_initializer=None, fcnet_kernel_initializer_kwargs=None, fcnet_bias_initializer=None, fcnet_bias_initializer_kwargs=None, conv_filters=None, conv_activation='relu', conv_kernel_initializer=None, conv_kernel_initializer_kwargs=None, conv_bias_initializer=None, conv_bias_initializer_kwargs=None, head_fcnet_hiddens=[], head_fcnet_activation='relu', head_fcnet_kernel_initializer=None, head_fcnet_kernel_initializer_kwargs=None, head_fcnet_bias_initializer=None, head_fcnet_bias_initializer_kwargs=None, free_log_std=False, log_std_clip_param=20.0, vf_share_layers=True, use_lstm=False, max_seq_len=20, lstm_cell_size=256, lstm_use_prev_action=False, lstm_use_prev_reward=False, lstm_kernel_initializer=None, lstm_kernel_initializer_kwargs=None, lstm_bias_initializer=None, lstm_bias_initializer_kwargs=None), catalog_class=None, load_state_path=None, model_config_dict=None)", "algorithm_config_overrides_per_module": {}, "_per_module_overrides": {}, "_validate_config": true, "_use_msgpack_checkpoints": false, "_torch_grad_scaler_class": null, "_torch_lr_scheduler_classes": null, "_tf_policy_handles_more_than_one_loss": false, "_disable_preprocessor_api": false, "_disable_action_flattening": false, "_disable_initialize_loss_from_dummy_batch": false, "_dont_auto_sync_env_runner_states": false, "env_task_fn": -1, "enable_connectors": -1, "simple_optimizer": false, "policy_map_cache": -1, "worker_cls": -1, "synchronize_filters": -1, "enable_async_evaluation": -1, "custom_async_evaluation_function": -1, "_enable_rl_module_api": -1, "auto_wrap_old_gym_envs": -1, "always_attach_evaluation_results": -1, "replay_sequence_length": null, "_disable_execution_plan_api": -1, "use_critic": true, "use_gae": true, "use_kl_loss": true, "kl_coeff": 0.7464963036515, "kl_target": 0.0270990929592, "vf_loss_coeff": 0.6688075857018, "entropy_coeff": 0.0090570820258, "clip_param": 0.1221781641624, "vf_clip_param": 0.1027808522125, "entropy_coeff_schedule": null, "lr_schedule": null, "sgd_minibatch_size": -1, "vf_share_layers": -1, "__stdout_file__": null, "__stderr_file__": null, "lambda": 0.9099046732075, "input": "sampler", "policies": {"default_policy": [null, null, null, null]}, "callbacks": "<class 'ray.rllib.callbacks.callbacks.RLlibCallback'>", "create_env_on_driver": false, "custom_eval_function": null, "framework": "torch"}, "time_since_restore": 36.1656436920166, "iterations_since_restore": 20, "perf": {"cpu_util_percent": 46.099999999999994, "ram_util_percent": 80.35}}
