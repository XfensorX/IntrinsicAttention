{"timers": {"training_iteration": 2.1589323329972103, "restore_env_runners": 1.054094173014164e-05, "training_step": 2.1585211670026183, "env_runner_sampling_timer": 1.9199676669668406, "learner_update_timer": 0.22652929101604968, "synch_weights": 0.006621166015975177}, "env_runners": {"num_agent_steps_sampled_lifetime": {"default_agent": 627500.0}, "env_to_module_connector": {"timers": {"connectors": {"numpy_to_tensor": 1.0937345187645947e-05, "batch_individual_items": 7.573545199893441e-06, "add_observations_from_episodes_to_batch": 3.613883346780404e-06, "add_time_dim_to_batch_and_zero_pad": 2.932995276668817e-06, "add_states_from_episodes_to_batch": 1.9488317797720075e-06}}, "connector_pipeline_timer": 5.283236695437622e-05}, "module_to_env_connector": {"timers": {"connectors": {"get_actions": 5.432879041779081e-05, "normalize_and_clip_actions": 1.603332003360174e-05, "listify_data_for_vector_env": 1.3242217148112911e-05, "remove_single_ts_time_rank_from_batch": 6.45006810557828e-07, "tensor_to_numpy": 1.594988946160904e-05, "un_batch_to_individual_items": 6.3138128393570795e-06}}, "connector_pipeline_timer": 0.0001390866689554109}, "time_between_sampling": 0.0006270109067764095, "agent_episode_returns_mean": {"default_agent": 0.17999999999999997}, "sample": 0.006875845388371892, "env_to_module_sum_episodes_length_out": 10.191744832559449, "num_env_steps_sampled": 5000.0, "num_agent_steps_sampled": {"default_agent": 5000.0}, "module_episode_returns_mean": {"default_policy": 0.17999999999999997}, "env_reset_timer": 9.103101472065935e-05, "episode_return_max": 10.5, "episode_len_min": 20, "episode_return_mean": 0.17999999999999997, "num_episodes_lifetime": 31375.0, "env_to_module_sum_episodes_length_in": 10.191744832559449, "num_episodes": 250.0, "num_module_steps_sampled_lifetime": {"default_policy": 627500.0}, "episode_return_min": -9.5, "episode_len_mean": 20.0, "episode_duration_sec_mean": 0.00638531453022733, "weights_seq_no": 0.0, "episode_len_max": 20, "num_env_steps_sampled_lifetime": 627500.0, "env_step_timer": 1.727128600321054e-05, "rlmodule_inference_timer": 5.995480859100548e-05, "num_module_steps_sampled": {"default_policy": 5000.0}, "num_env_steps_sampled_lifetime_throughput": 3136.914026312917}, "learners": {"default_policy": {"diff_num_grad_updates_vs_sampler_policy": 1.0, "curr_entropy_coeff": 0.0090570820258, "policy_loss": 0.06217312067747116, "default_optimizer_learning_rate": 0.0002847858517, "num_trainable_parameters": 6003, "num_module_steps_trained_lifetime": 6000, "weights_seq_no": 1.0, "vf_loss_unclipped": 28.942136764526367, "num_module_steps_trained": 6000, "mean_kl_loss": 0.001026108511723578, "curr_kl_coeff": 0.3732481598854065, "entropy": 0.6878411173820496, "module_train_batch_size_mean": 1000.0, "gradients_default_optimizer_global_norm": 0.12170831859111786, "vf_loss": 0.10278083384037018, "vf_explained_var": -0.010670661926269531, "total_loss": 0.12544988095760345, "num_module_steps_trained_lifetime_throughput": 144772.03408065898}, "__all_modules__": {"num_trainable_parameters": 6003, "learner_connector_sum_episodes_length_in": 5000, "learner_connector": {"timers": {"connectors": {"batch_individual_items": 0.06408241600729525, "add_columns_from_episodes_to_train_batch": 0.047497000079602, "add_one_ts_to_episodes_and_truncate": 0.014952959027141333, "add_observations_from_episodes_to_batch": 0.000874832971021533, "add_states_from_episodes_to_batch": 8.750008419156075e-06, "general_advantage_estimation": 0.014739250065758824, "add_time_dim_to_batch_and_zero_pad": 6.141699850559235e-05, "numpy_to_tensor": 0.0001558329677209258}}, "connector_pipeline_timer": 0.14277450006920844}, "num_env_steps_trained_lifetime": 31500, "num_env_steps_trained": 31500, "num_non_trainable_parameters": 0, "num_module_steps_trained_lifetime": 6000, "num_module_steps_trained": 6000, "learner_connector_sum_episodes_length_out": 5250, "num_env_steps_trained_lifetime_throughput": 757901.5289982806, "num_module_steps_trained_throughput": 144634.80048829035, "num_module_steps_trained_lifetime_throughput": 144552.19549613827}}, "num_training_step_calls_per_iteration": 1, "num_env_steps_sampled_lifetime": 627500.0, "evaluation": {"env_runners": {"episode_len_mean": 20.0, "module_to_env_connector": {"connector_pipeline_timer": 0.00024010792304028026, "timers": {"connectors": {"remove_single_ts_time_rank_from_batch": 7.239590197163625e-07, "tensor_to_numpy": 4.8519106335821984e-05, "normalize_and_clip_actions": 1.47355793983693e-05, "listify_data_for_vector_env": 1.3196431161389139e-05, "un_batch_to_individual_items": 6.1753678174467496e-06, "get_actions": 0.00012662736105745472}}}, "num_env_steps_sampled_lifetime": 5400, "rlmodule_inference_timer": 7.145112722179014e-05, "env_to_module_connector": {"timers": {"connectors": {"add_time_dim_to_batch_and_zero_pad": 4.277400638210184e-06, "numpy_to_tensor": 9.84751516664439e-06, "batch_individual_items": 7.400384229610766e-06, "add_states_from_episodes_to_batch": 1.8449018733551976e-06, "add_observations_from_episodes_to_batch": 4.3990997801785795e-06}}, "connector_pipeline_timer": 5.905385071265781e-05}, "num_episodes_lifetime": 20, "weights_seq_no": 1.0, "episode_len_max": 20, "sample": 0.14839470898732543, "episode_return_max": 12.5, "env_reset_timer": 0.0007095839828252792, "agent_episode_returns_mean": {"default_agent": 4.05}, "module_episode_returns_mean": {"default_policy": 4.05}, "num_episodes": 20, "episode_return_min": -12.5, "episode_duration_sec_mean": 0.006611299887299538, "num_module_steps_sampled": {"default_policy": 400}, "num_env_steps_sampled": 400, "num_agent_steps_sampled_lifetime": {"default_agent": 400}, "env_to_module_sum_episodes_length_in": 10.216013141322508, "num_agent_steps_sampled": {"default_agent": 400}, "env_step_timer": 1.8683969596881713e-05, "num_module_steps_sampled_lifetime": {"default_policy": 400}, "env_to_module_sum_episodes_length_out": 10.216013141322508, "episode_len_min": 20, "episode_return_mean": 4.05}, "num_healthy_workers": 1, "actor_manager_num_outstanding_async_reqs": 0, "num_remote_worker_restarts": 0}, "fault_tolerance": {"num_healthy_workers": 0, "num_remote_worker_restarts": 0}, "env_runner_group": {"actor_manager_num_outstanding_async_reqs": 0}, "done": false, "training_iteration": 1, "trial_id": "4da12_00000", "date": "2025-08-11_19-21-35", "timestamp": 1754932895, "time_this_iter_s": 2.341324806213379, "time_total_s": 2.341324806213379, "pid": 14324, "hostname": "Mac", "node_ip": "127.0.0.1", "config": {"exploration_config": {}, "extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "placement_strategy": "PACK", "num_gpus": 0, "_fake_gpus": false, "num_cpus_for_main_process": 2, "eager_tracing": true, "eager_max_retraces": 20, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "torch_compile_learner": false, "torch_compile_learner_what_to_compile": "forward_train", "torch_compile_learner_dynamo_backend": "aot_eager", "torch_compile_learner_dynamo_mode": null, "torch_compile_worker": false, "torch_compile_worker_dynamo_backend": "aot_eager", "torch_compile_worker_dynamo_mode": null, "torch_ddp_kwargs": {}, "torch_skip_nan_gradients": false, "env": "Umbrella", "env_config": {}, "observation_space": null, "action_space": null, "clip_rewards": null, "normalize_actions": true, "clip_actions": false, "_is_atari": null, "disable_env_checking": false, "render_env": false, "action_mask_key": "action_mask", "env_runner_cls": null, "num_env_runners": 0, "create_local_env_runner": true, "num_envs_per_env_runner": 1, "gym_env_vectorize_mode": "SYNC", "num_cpus_per_env_runner": 1, "num_gpus_per_env_runner": 0, "custom_resources_per_env_runner": {}, "validate_env_runners_after_construction": true, "episodes_to_numpy": true, "max_requests_in_flight_per_env_runner": 1, "sample_timeout_s": 60.0, "_env_to_module_connector": null, "add_default_connectors_to_env_to_module_pipeline": true, "_module_to_env_connector": null, "add_default_connectors_to_module_to_env_pipeline": true, "merge_env_runner_states": "training_only", "broadcast_env_runner_states": true, "episode_lookback_horizon": 1, "rollout_fragment_length": "auto", "batch_mode": "complete_episodes", "compress_observations": false, "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "enable_tf1_exec_eagerly": false, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "preprocessor_pref": "deepmind", "observation_filter": "NoFilter", "update_worker_filter_stats": true, "use_worker_filter_stats": true, "sampler_perf_stats_ema_coef": null, "_is_online": true, "num_learners": 0, "num_gpus_per_learner": 0, "num_cpus_per_learner": "auto", "num_aggregator_actors_per_learner": 0, "max_requests_in_flight_per_aggregator_actor": 3, "local_gpu_idx": 0, "max_requests_in_flight_per_learner": 3, "gamma": 1, "lr": 0.0002847858517, "grad_clip": 0.5, "grad_clip_by": "global_norm", "_train_batch_size_per_learner": 5000, "train_batch_size": 4000, "num_epochs": 1, "minibatch_size": 1000, "shuffle_batch_per_epoch": true, "model": {"fcnet_hiddens": [256, 256], "fcnet_activation": "tanh", "fcnet_weights_initializer": null, "fcnet_weights_initializer_config": null, "fcnet_bias_initializer": null, "fcnet_bias_initializer_config": null, "conv_filters": null, "conv_activation": "relu", "conv_kernel_initializer": null, "conv_kernel_initializer_config": null, "conv_bias_initializer": null, "conv_bias_initializer_config": null, "conv_transpose_kernel_initializer": null, "conv_transpose_kernel_initializer_config": null, "conv_transpose_bias_initializer": null, "conv_transpose_bias_initializer_config": null, "post_fcnet_hiddens": [], "post_fcnet_activation": "relu", "post_fcnet_weights_initializer": null, "post_fcnet_weights_initializer_config": null, "post_fcnet_bias_initializer": null, "post_fcnet_bias_initializer_config": null, "free_log_std": false, "log_std_clip_param": 20.0, "no_final_linear": false, "vf_share_layers": false, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "lstm_weights_initializer": null, "lstm_weights_initializer_config": null, "lstm_bias_initializer": null, "lstm_bias_initializer_config": null, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "attention_use_n_prev_actions": 0, "attention_use_n_prev_rewards": 0, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": null, "custom_model_config": {}, "custom_action_dist": null, "custom_preprocessor": null, "encoder_latent_dim": null, "always_check_shapes": false, "lstm_use_prev_action_reward": -1, "_use_default_native_models": -1, "_disable_preprocessor_api": false, "_disable_action_flattening": false}, "_learner_connector": null, "add_default_connectors_to_learner_pipeline": true, "learner_config_dict": {}, "optimizer": {}, "_learner_class": null, "callbacks_on_algorithm_init": null, "callbacks_on_env_runners_recreated": null, "callbacks_on_offline_eval_runners_recreated": null, "callbacks_on_checkpoint_loaded": null, "callbacks_on_environment_created": null, "callbacks_on_episode_created": null, "callbacks_on_episode_start": null, "callbacks_on_episode_step": null, "callbacks_on_episode_end": null, "callbacks_on_evaluate_start": null, "callbacks_on_evaluate_end": null, "callbacks_on_evaluate_offline_start": null, "callbacks_on_evaluate_offline_end": null, "callbacks_on_sample_end": null, "callbacks_on_train_result": null, "explore": true, "enable_rl_module_and_learner": true, "enable_env_runner_and_connector_v2": true, "_prior_exploration_config": {"type": "StochasticSampling"}, "count_steps_by": "env_steps", "policy_map_capacity": 100, "policy_mapping_fn": "<function AlgorithmConfig.DEFAULT_POLICY_MAPPING_FN at 0x385eedb20>", "policies_to_train": null, "policy_states_are_swappable": false, "observation_fn": null, "offline_data_class": null, "input_read_method": "read_parquet", "input_read_method_kwargs": {}, "input_read_schema": {}, "input_read_episodes": false, "input_read_sample_batches": false, "input_read_batch_size": null, "input_filesystem": null, "input_filesystem_kwargs": {}, "input_compress_columns": ["obs", "new_obs"], "input_spaces_jsonable": true, "materialize_data": false, "materialize_mapped_data": true, "map_batches_kwargs": {}, "iter_batches_kwargs": {}, "ignore_final_observation": false, "prelearner_class": null, "prelearner_buffer_class": null, "prelearner_buffer_kwargs": {}, "prelearner_module_synch_period": 10, "dataset_num_iters_per_learner": null, "input_config": {}, "actions_in_input_normalized": false, "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_config": {}, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "output_max_rows_per_file": null, "output_write_remaining_data": false, "output_write_method": "write_parquet", "output_write_method_kwargs": {}, "output_filesystem": null, "output_filesystem_kwargs": {}, "output_write_episodes": true, "offline_sampling": false, "evaluation_interval": 1, "evaluation_duration": 20, "evaluation_duration_unit": "episodes", "evaluation_sample_timeout_s": 120.0, "evaluation_auto_duration_min_env_steps_per_sample": 100, "evaluation_auto_duration_max_env_steps_per_sample": 2000, "evaluation_parallel_to_training": false, "evaluation_force_reset_envs_before_iteration": true, "evaluation_config": null, "off_policy_estimation_methods": {}, "ope_split_batch_by_episode": true, "evaluation_num_env_runners": 1, "in_evaluation": false, "sync_filters_on_rollout_workers_timeout_s": 10.0, "offline_evaluation_interval": null, "num_offline_eval_runners": 0, "offline_loss_for_module_fn": null, "offline_evaluation_duration": 1, "offline_evaluation_parallel_to_training": false, "offline_evaluation_timeout_s": 120.0, "num_cpus_per_offline_eval_runner": 1, "num_gpus_per_offline_eval_runner": 0, "custom_resources_per_offline_eval_runner": {}, "restart_failed_offline_eval_runners": true, "ignore_offline_eval_runner_failures": false, "max_num_offline_eval_runner_restarts": 1000, "offline_eval_runner_restore_timeout_s": 1800.0, "max_requests_in_flight_per_offline_eval_runner": 1, "validate_offline_eval_runners_after_construction": true, "offline_eval_runner_health_probe_timeout_s": 30.0, "offline_eval_rl_module_inference_only": false, "broadcast_offline_eval_runner_states": false, "offline_eval_batch_size_per_runner": 256, "dataset_num_iters_per_eval_runner": 1, "keep_per_episode_custom_metrics": false, "metrics_episode_collection_timeout_s": 60.0, "metrics_num_episodes_for_smoothing": 100, "min_time_s_per_iteration": null, "min_train_timesteps_per_iteration": 0, "min_sample_timesteps_per_iteration": 0, "log_gradients": true, "export_native_model_files": false, "checkpoint_trainable_policies_only": false, "logger_creator": null, "logger_config": null, "log_level": "WARN", "log_sys_usage": true, "fake_sampler": false, "seed": 7, "restart_failed_env_runners": true, "ignore_env_runner_failures": false, "max_num_env_runner_restarts": 1000, "delay_between_env_runner_restarts_s": 60.0, "restart_failed_sub_environments": false, "num_consecutive_env_runner_failures_tolerance": 100, "env_runner_health_probe_timeout_s": 30.0, "env_runner_restore_timeout_s": 1800.0, "_model_config": {}, "_rl_module_spec": "RLModuleSpec(module_class=None, observation_space=None, action_space=None, inference_only=False, learner_only=False, model_config=DefaultModelConfig(fcnet_hiddens=[60, 90], fcnet_activation='tanh', fcnet_kernel_initializer=None, fcnet_kernel_initializer_kwargs=None, fcnet_bias_initializer=None, fcnet_bias_initializer_kwargs=None, conv_filters=None, conv_activation='relu', conv_kernel_initializer=None, conv_kernel_initializer_kwargs=None, conv_bias_initializer=None, conv_bias_initializer_kwargs=None, head_fcnet_hiddens=[], head_fcnet_activation='relu', head_fcnet_kernel_initializer=None, head_fcnet_kernel_initializer_kwargs=None, head_fcnet_bias_initializer=None, head_fcnet_bias_initializer_kwargs=None, free_log_std=False, log_std_clip_param=20.0, vf_share_layers=True, use_lstm=False, max_seq_len=20, lstm_cell_size=256, lstm_use_prev_action=False, lstm_use_prev_reward=False, lstm_kernel_initializer=None, lstm_kernel_initializer_kwargs=None, lstm_bias_initializer=None, lstm_bias_initializer_kwargs=None), catalog_class=None, load_state_path=None, model_config_dict=None)", "algorithm_config_overrides_per_module": {}, "_per_module_overrides": {}, "_validate_config": true, "_use_msgpack_checkpoints": false, "_torch_grad_scaler_class": null, "_torch_lr_scheduler_classes": null, "_tf_policy_handles_more_than_one_loss": false, "_disable_preprocessor_api": false, "_disable_action_flattening": false, "_disable_initialize_loss_from_dummy_batch": false, "_dont_auto_sync_env_runner_states": false, "env_task_fn": -1, "enable_connectors": -1, "simple_optimizer": false, "policy_map_cache": -1, "worker_cls": -1, "synchronize_filters": -1, "enable_async_evaluation": -1, "custom_async_evaluation_function": -1, "_enable_rl_module_api": -1, "auto_wrap_old_gym_envs": -1, "always_attach_evaluation_results": -1, "replay_sequence_length": null, "_disable_execution_plan_api": -1, "use_critic": true, "use_gae": true, "use_kl_loss": true, "kl_coeff": 0.7464963036515, "kl_target": 0.0270990929592, "vf_loss_coeff": 0.6688075857018, "entropy_coeff": 0.0090570820258, "clip_param": 0.1221781641624, "vf_clip_param": 0.1027808522125, "entropy_coeff_schedule": null, "lr_schedule": null, "sgd_minibatch_size": -1, "vf_share_layers": -1, "__stdout_file__": null, "__stderr_file__": null, "lambda": 0.9099046732075, "input": "sampler", "policies": {"default_policy": [null, null, null, null]}, "callbacks": "<class 'ray.rllib.callbacks.callbacks.RLlibCallback'>", "create_env_on_driver": false, "custom_eval_function": null, "framework": "torch"}, "time_since_restore": 2.341324806213379, "iterations_since_restore": 1, "perf": {"cpu_util_percent": 43.05, "ram_util_percent": 81.45}}
{"timers": {"training_iteration": 2.155958971757209, "restore_env_runners": 1.054595224559307e-05, "training_step": 2.1555493461736477, "env_runner_sampling_timer": 1.916767982377205, "learner_update_timer": 0.2268410685251001, "synch_weights": 0.006565057275583968, "restore_eval_env_runners": 0.00010175001807510853, "evaluation_iteration": 0.17695899994578212, "synch_eval_env_connectors": 0.00033900002017617226, "synch_env_connectors": 6.624963134527206e-06}, "env_runners": {"num_agent_steps_sampled_lifetime": {"default_agent": 10000.0}, "env_to_module_connector": {"timers": {"connectors": {"numpy_to_tensor": 1.1327200427927801e-05, "batch_individual_items": 7.43669209688027e-06, "add_observations_from_episodes_to_batch": 3.387630975779323e-06, "add_time_dim_to_batch_and_zero_pad": 2.828437431672534e-06, "add_states_from_episodes_to_batch": 1.9282877905612574e-06}}, "connector_pipeline_timer": 5.0945427441424704e-05}, "module_to_env_connector": {"timers": {"connectors": {"get_actions": 4.918109947387973e-05, "normalize_and_clip_actions": 1.1722148835730328e-05, "listify_data_for_vector_env": 1.2967619337012395e-05, "remove_single_ts_time_rank_from_batch": 6.510062903214895e-07, "tensor_to_numpy": 1.6647447761193308e-05, "un_batch_to_individual_items": 6.220821842044229e-06}}, "connector_pipeline_timer": 0.000135743409251812}, "time_between_sampling": 0.002556530406852211, "agent_episode_returns_mean": {"default_agent": 0.3400000000000001}, "sample": 0.007014586488391617, "env_to_module_sum_episodes_length_out": 10.36823839457432, "num_env_steps_sampled": 5000.0, "num_agent_steps_sampled": {"default_agent": 5000.0}, "module_episode_returns_mean": {"default_policy": 0.3400000000000001}, "env_reset_timer": 6.0569902044246395e-05, "episode_return_max": 10.5, "episode_len_min": 20, "episode_return_mean": 0.3400000000000001, "num_episodes_lifetime": 500.0, "env_to_module_sum_episodes_length_in": 10.36823839457432, "num_episodes": 250.0, "num_module_steps_sampled_lifetime": {"default_policy": 10000.0}, "episode_return_min": -9.5, "episode_len_mean": 20.0, "episode_duration_sec_mean": 0.005256012503057719, "weights_seq_no": 1.0, "episode_len_max": 20, "num_env_steps_sampled_lifetime": 10000.0, "env_step_timer": 1.6821497921788782e-05, "rlmodule_inference_timer": 3.553929899803845e-05, "num_module_steps_sampled": {"default_policy": 5000.0}, "num_env_steps_sampled_lifetime_throughput": 3197.2785679823464}, "learners": {"default_policy": {"diff_num_grad_updates_vs_sampler_policy": 1.0, "curr_entropy_coeff": 0.0090570820258, "policy_loss": -0.0023740576580166817, "default_optimizer_learning_rate": 0.0002847858517, "num_trainable_parameters": 6003, "num_module_steps_trained_lifetime": 12000, "weights_seq_no": 2.0, "vf_loss_unclipped": 28.860502243041992, "num_module_steps_trained": 6000, "mean_kl_loss": 4.524777614278719e-05, "curr_kl_coeff": 0.18662407994270325, "entropy": 0.6892082095146179, "module_train_batch_size_mean": 1000.0, "gradients_default_optimizer_global_norm": 0.019594253972172737, "vf_loss": 0.10278083384037018, "vf_explained_var": -0.010760307312011719, "total_loss": 0.060141224414110184, "num_module_steps_trained_lifetime_throughput": 146415.97822707493}, "__all_modules__": {"num_trainable_parameters": 6003, "learner_connector_sum_episodes_length_in": 5000.0, "learner_connector": {"timers": {"connectors": {"batch_individual_items": 0.06531108643626794, "add_columns_from_episodes_to_train_batch": 0.047373749657999724, "add_one_ts_to_episodes_and_truncate": 0.014879102356499061, "add_observations_from_episodes_to_batch": 0.0008742696419358254, "add_states_from_episodes_to_batch": 8.709168760105968e-06, "general_advantage_estimation": 0.014660262145334856, "add_time_dim_to_batch_and_zero_pad": 6.09344884287566e-05, "numpy_to_tensor": 0.00015512880752794445}}, "connector_pipeline_timer": 0.143722639658954}, "num_env_steps_trained_lifetime": 63000, "num_env_steps_trained": 31500, "num_non_trainable_parameters": 0, "num_module_steps_trained_lifetime": 12000, "num_module_steps_trained": 6000, "learner_connector_sum_episodes_length_out": 5250.0, "num_env_steps_trained_lifetime_throughput": 766583.8972161125, "num_module_steps_trained_throughput": 146285.70748598102, "num_module_steps_trained_lifetime_throughput": 146203.52207929635}}, "num_training_step_calls_per_iteration": 1, "evaluation": {"env_runners": {"episode_len_mean": 20.0, "module_to_env_connector": {"connector_pipeline_timer": 0.00010748385852257953, "timers": {"connectors": {"remove_single_ts_time_rank_from_batch": 8.791097580043443e-07, "tensor_to_numpy": 1.3890186464674568e-05, "normalize_and_clip_actions": 9.791700845226205e-06, "listify_data_for_vector_env": 1.1459606061826698e-05, "un_batch_to_individual_items": 5.840861750900325e-06, "get_actions": 3.977940282685887e-05}}}, "num_env_steps_sampled_lifetime": 10400, "rlmodule_inference_timer": 2.8776421100470896e-05, "env_to_module_connector": {"timers": {"connectors": {"add_time_dim_to_batch_and_zero_pad": 2.3381399154045812e-06, "numpy_to_tensor": 8.637511340968302e-06, "batch_individual_items": 6.331514881605118e-06, "add_states_from_episodes_to_batch": 1.6288721009769303e-06, "add_observations_from_episodes_to_batch": 2.9302740831106422e-06}}, "connector_pipeline_timer": 4.353473938953522e-05}, "num_episodes_lifetime": 40, "weights_seq_no": 2.0, "episode_len_max": 20, "sample": 0.14795360147836617, "episode_return_max": 12.5, "env_reset_timer": 0.0007033093925565482, "agent_episode_returns_mean": {"default_agent": 2.55}, "module_episode_returns_mean": {"default_policy": 2.55}, "num_episodes": 20, "episode_return_min": -12.5, "episode_duration_sec_mean": 0.00568872909352649, "num_module_steps_sampled": {"default_policy": 400}, "num_env_steps_sampled": 400, "num_agent_steps_sampled_lifetime": {"default_agent": 800}, "env_to_module_sum_episodes_length_in": 10.366003441359926, "num_agent_steps_sampled": {"default_agent": 400}, "env_step_timer": 1.5130500244669502e-05, "num_module_steps_sampled_lifetime": {"default_policy": 800}, "env_to_module_sum_episodes_length_out": 10.366003441359926, "episode_len_min": 20, "episode_return_mean": 2.55, "time_between_sampling": 1.9143705000169575}, "num_healthy_workers": 1, "actor_manager_num_outstanding_async_reqs": 0, "num_remote_worker_restarts": 0}, "num_env_steps_sampled_lifetime": 10000.0, "fault_tolerance": {"num_healthy_workers": 0, "num_remote_worker_restarts": 0}, "env_runner_group": {"actor_manager_num_outstanding_async_reqs": 0}, "done": false, "training_iteration": 2, "trial_id": "4da12_00000", "date": "2025-08-11_19-21-37", "timestamp": 1754932897, "time_this_iter_s": 1.973973035812378, "time_total_s": 4.315297842025757, "pid": 14324, "hostname": "Mac", "node_ip": "127.0.0.1", "config": {"exploration_config": {}, "extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "placement_strategy": "PACK", "num_gpus": 0, "_fake_gpus": false, "num_cpus_for_main_process": 2, "eager_tracing": true, "eager_max_retraces": 20, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "torch_compile_learner": false, "torch_compile_learner_what_to_compile": "forward_train", "torch_compile_learner_dynamo_backend": "aot_eager", "torch_compile_learner_dynamo_mode": null, "torch_compile_worker": false, "torch_compile_worker_dynamo_backend": "aot_eager", "torch_compile_worker_dynamo_mode": null, "torch_ddp_kwargs": {}, "torch_skip_nan_gradients": false, "env": "Umbrella", "env_config": {}, "observation_space": null, "action_space": null, "clip_rewards": null, "normalize_actions": true, "clip_actions": false, "_is_atari": null, "disable_env_checking": false, "render_env": false, "action_mask_key": "action_mask", "env_runner_cls": null, "num_env_runners": 0, "create_local_env_runner": true, "num_envs_per_env_runner": 1, "gym_env_vectorize_mode": "SYNC", "num_cpus_per_env_runner": 1, "num_gpus_per_env_runner": 0, "custom_resources_per_env_runner": {}, "validate_env_runners_after_construction": true, "episodes_to_numpy": true, "max_requests_in_flight_per_env_runner": 1, "sample_timeout_s": 60.0, "_env_to_module_connector": null, "add_default_connectors_to_env_to_module_pipeline": true, "_module_to_env_connector": null, "add_default_connectors_to_module_to_env_pipeline": true, "merge_env_runner_states": "training_only", "broadcast_env_runner_states": true, "episode_lookback_horizon": 1, "rollout_fragment_length": "auto", "batch_mode": "complete_episodes", "compress_observations": false, "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "enable_tf1_exec_eagerly": false, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "preprocessor_pref": "deepmind", "observation_filter": "NoFilter", "update_worker_filter_stats": true, "use_worker_filter_stats": true, "sampler_perf_stats_ema_coef": null, "_is_online": true, "num_learners": 0, "num_gpus_per_learner": 0, "num_cpus_per_learner": "auto", "num_aggregator_actors_per_learner": 0, "max_requests_in_flight_per_aggregator_actor": 3, "local_gpu_idx": 0, "max_requests_in_flight_per_learner": 3, "gamma": 1, "lr": 0.0002847858517, "grad_clip": 0.5, "grad_clip_by": "global_norm", "_train_batch_size_per_learner": 5000, "train_batch_size": 4000, "num_epochs": 1, "minibatch_size": 1000, "shuffle_batch_per_epoch": true, "model": {"fcnet_hiddens": [256, 256], "fcnet_activation": "tanh", "fcnet_weights_initializer": null, "fcnet_weights_initializer_config": null, "fcnet_bias_initializer": null, "fcnet_bias_initializer_config": null, "conv_filters": null, "conv_activation": "relu", "conv_kernel_initializer": null, "conv_kernel_initializer_config": null, "conv_bias_initializer": null, "conv_bias_initializer_config": null, "conv_transpose_kernel_initializer": null, "conv_transpose_kernel_initializer_config": null, "conv_transpose_bias_initializer": null, "conv_transpose_bias_initializer_config": null, "post_fcnet_hiddens": [], "post_fcnet_activation": "relu", "post_fcnet_weights_initializer": null, "post_fcnet_weights_initializer_config": null, "post_fcnet_bias_initializer": null, "post_fcnet_bias_initializer_config": null, "free_log_std": false, "log_std_clip_param": 20.0, "no_final_linear": false, "vf_share_layers": false, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "lstm_weights_initializer": null, "lstm_weights_initializer_config": null, "lstm_bias_initializer": null, "lstm_bias_initializer_config": null, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "attention_use_n_prev_actions": 0, "attention_use_n_prev_rewards": 0, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": null, "custom_model_config": {}, "custom_action_dist": null, "custom_preprocessor": null, "encoder_latent_dim": null, "always_check_shapes": false, "lstm_use_prev_action_reward": -1, "_use_default_native_models": -1, "_disable_preprocessor_api": false, "_disable_action_flattening": false}, "_learner_connector": null, "add_default_connectors_to_learner_pipeline": true, "learner_config_dict": {}, "optimizer": {}, "_learner_class": null, "callbacks_on_algorithm_init": null, "callbacks_on_env_runners_recreated": null, "callbacks_on_offline_eval_runners_recreated": null, "callbacks_on_checkpoint_loaded": null, "callbacks_on_environment_created": null, "callbacks_on_episode_created": null, "callbacks_on_episode_start": null, "callbacks_on_episode_step": null, "callbacks_on_episode_end": null, "callbacks_on_evaluate_start": null, "callbacks_on_evaluate_end": null, "callbacks_on_evaluate_offline_start": null, "callbacks_on_evaluate_offline_end": null, "callbacks_on_sample_end": null, "callbacks_on_train_result": null, "explore": true, "enable_rl_module_and_learner": true, "enable_env_runner_and_connector_v2": true, "_prior_exploration_config": {"type": "StochasticSampling"}, "count_steps_by": "env_steps", "policy_map_capacity": 100, "policy_mapping_fn": "<function AlgorithmConfig.DEFAULT_POLICY_MAPPING_FN at 0x385eedb20>", "policies_to_train": null, "policy_states_are_swappable": false, "observation_fn": null, "offline_data_class": null, "input_read_method": "read_parquet", "input_read_method_kwargs": {}, "input_read_schema": {}, "input_read_episodes": false, "input_read_sample_batches": false, "input_read_batch_size": null, "input_filesystem": null, "input_filesystem_kwargs": {}, "input_compress_columns": ["obs", "new_obs"], "input_spaces_jsonable": true, "materialize_data": false, "materialize_mapped_data": true, "map_batches_kwargs": {}, "iter_batches_kwargs": {}, "ignore_final_observation": false, "prelearner_class": null, "prelearner_buffer_class": null, "prelearner_buffer_kwargs": {}, "prelearner_module_synch_period": 10, "dataset_num_iters_per_learner": null, "input_config": {}, "actions_in_input_normalized": false, "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_config": {}, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "output_max_rows_per_file": null, "output_write_remaining_data": false, "output_write_method": "write_parquet", "output_write_method_kwargs": {}, "output_filesystem": null, "output_filesystem_kwargs": {}, "output_write_episodes": true, "offline_sampling": false, "evaluation_interval": 1, "evaluation_duration": 20, "evaluation_duration_unit": "episodes", "evaluation_sample_timeout_s": 120.0, "evaluation_auto_duration_min_env_steps_per_sample": 100, "evaluation_auto_duration_max_env_steps_per_sample": 2000, "evaluation_parallel_to_training": false, "evaluation_force_reset_envs_before_iteration": true, "evaluation_config": null, "off_policy_estimation_methods": {}, "ope_split_batch_by_episode": true, "evaluation_num_env_runners": 1, "in_evaluation": false, "sync_filters_on_rollout_workers_timeout_s": 10.0, "offline_evaluation_interval": null, "num_offline_eval_runners": 0, "offline_loss_for_module_fn": null, "offline_evaluation_duration": 1, "offline_evaluation_parallel_to_training": false, "offline_evaluation_timeout_s": 120.0, "num_cpus_per_offline_eval_runner": 1, "num_gpus_per_offline_eval_runner": 0, "custom_resources_per_offline_eval_runner": {}, "restart_failed_offline_eval_runners": true, "ignore_offline_eval_runner_failures": false, "max_num_offline_eval_runner_restarts": 1000, "offline_eval_runner_restore_timeout_s": 1800.0, "max_requests_in_flight_per_offline_eval_runner": 1, "validate_offline_eval_runners_after_construction": true, "offline_eval_runner_health_probe_timeout_s": 30.0, "offline_eval_rl_module_inference_only": false, "broadcast_offline_eval_runner_states": false, "offline_eval_batch_size_per_runner": 256, "dataset_num_iters_per_eval_runner": 1, "keep_per_episode_custom_metrics": false, "metrics_episode_collection_timeout_s": 60.0, "metrics_num_episodes_for_smoothing": 100, "min_time_s_per_iteration": null, "min_train_timesteps_per_iteration": 0, "min_sample_timesteps_per_iteration": 0, "log_gradients": true, "export_native_model_files": false, "checkpoint_trainable_policies_only": false, "logger_creator": null, "logger_config": null, "log_level": "WARN", "log_sys_usage": true, "fake_sampler": false, "seed": 7, "restart_failed_env_runners": true, "ignore_env_runner_failures": false, "max_num_env_runner_restarts": 1000, "delay_between_env_runner_restarts_s": 60.0, "restart_failed_sub_environments": false, "num_consecutive_env_runner_failures_tolerance": 100, "env_runner_health_probe_timeout_s": 30.0, "env_runner_restore_timeout_s": 1800.0, "_model_config": {}, "_rl_module_spec": "RLModuleSpec(module_class=None, observation_space=None, action_space=None, inference_only=False, learner_only=False, model_config=DefaultModelConfig(fcnet_hiddens=[60, 90], fcnet_activation='tanh', fcnet_kernel_initializer=None, fcnet_kernel_initializer_kwargs=None, fcnet_bias_initializer=None, fcnet_bias_initializer_kwargs=None, conv_filters=None, conv_activation='relu', conv_kernel_initializer=None, conv_kernel_initializer_kwargs=None, conv_bias_initializer=None, conv_bias_initializer_kwargs=None, head_fcnet_hiddens=[], head_fcnet_activation='relu', head_fcnet_kernel_initializer=None, head_fcnet_kernel_initializer_kwargs=None, head_fcnet_bias_initializer=None, head_fcnet_bias_initializer_kwargs=None, free_log_std=False, log_std_clip_param=20.0, vf_share_layers=True, use_lstm=False, max_seq_len=20, lstm_cell_size=256, lstm_use_prev_action=False, lstm_use_prev_reward=False, lstm_kernel_initializer=None, lstm_kernel_initializer_kwargs=None, lstm_bias_initializer=None, lstm_bias_initializer_kwargs=None), catalog_class=None, load_state_path=None, model_config_dict=None)", "algorithm_config_overrides_per_module": {}, "_per_module_overrides": {}, "_validate_config": true, "_use_msgpack_checkpoints": false, "_torch_grad_scaler_class": null, "_torch_lr_scheduler_classes": null, "_tf_policy_handles_more_than_one_loss": false, "_disable_preprocessor_api": false, "_disable_action_flattening": false, "_disable_initialize_loss_from_dummy_batch": false, "_dont_auto_sync_env_runner_states": false, "env_task_fn": -1, "enable_connectors": -1, "simple_optimizer": false, "policy_map_cache": -1, "worker_cls": -1, "synchronize_filters": -1, "enable_async_evaluation": -1, "custom_async_evaluation_function": -1, "_enable_rl_module_api": -1, "auto_wrap_old_gym_envs": -1, "always_attach_evaluation_results": -1, "replay_sequence_length": null, "_disable_execution_plan_api": -1, "use_critic": true, "use_gae": true, "use_kl_loss": true, "kl_coeff": 0.7464963036515, "kl_target": 0.0270990929592, "vf_loss_coeff": 0.6688075857018, "entropy_coeff": 0.0090570820258, "clip_param": 0.1221781641624, "vf_clip_param": 0.1027808522125, "entropy_coeff_schedule": null, "lr_schedule": null, "sgd_minibatch_size": -1, "vf_share_layers": -1, "__stdout_file__": null, "__stderr_file__": null, "lambda": 0.9099046732075, "input": "sampler", "policies": {"default_policy": [null, null, null, null]}, "callbacks": "<class 'ray.rllib.callbacks.callbacks.RLlibCallback'>", "create_env_on_driver": false, "custom_eval_function": null, "framework": "torch"}, "time_since_restore": 4.315297842025757, "iterations_since_restore": 2, "perf": {"cpu_util_percent": 59.43333333333333, "ram_util_percent": 82.46666666666667}}
{"timers": {"training_iteration": 2.15063672163008, "restore_env_runners": 1.0507572395727038e-05, "training_step": 2.150229261881369, "env_runner_sampling_timer": 1.9127950608839048, "learner_update_timer": 0.22558071908958954, "synch_weights": 0.006505462122627068, "restore_eval_env_runners": 0.00010081501794047654, "evaluation_iteration": 0.1762900874472689, "synch_eval_env_connectors": 0.0003373746096622199, "synch_env_connectors": 6.607043324038386e-06}, "env_runners": {"num_agent_steps_sampled_lifetime": {"default_agent": -607500.0}, "env_to_module_connector": {"timers": {"connectors": {"numpy_to_tensor": 1.0074110666152593e-05, "batch_individual_items": 7.0382128972496014e-06, "add_observations_from_episodes_to_batch": 3.3506497807454575e-06, "add_time_dim_to_batch_and_zero_pad": 2.655001172366192e-06, "add_states_from_episodes_to_batch": 1.884290468850385e-06}}, "connector_pipeline_timer": 4.8343231339813945e-05}, "module_to_env_connector": {"timers": {"connectors": {"get_actions": 4.457404038046956e-05, "normalize_and_clip_actions": 1.0221109272372183e-05, "listify_data_for_vector_env": 1.1833317848060245e-05, "remove_single_ts_time_rank_from_batch": 6.208107578666733e-07, "tensor_to_numpy": 1.4487578713285388e-05, "un_batch_to_individual_items": 5.731926903914872e-06}}, "connector_pipeline_timer": 0.00011584769951597193}, "time_between_sampling": 0.0022490253902927772, "agent_episode_returns_mean": {"default_agent": 1.3000000000000003}, "sample": 0.005438106389055641, "env_to_module_sum_episodes_length_out": 10.36823839457432, "num_env_steps_sampled": 5000.0, "num_agent_steps_sampled": {"default_agent": 5000.0}, "module_episode_returns_mean": {"default_policy": 1.3000000000000003}, "env_reset_timer": 4.1999985420987196e-05, "episode_return_max": 10.5, "episode_len_min": 20, "episode_return_mean": 1.3000000000000003, "num_episodes_lifetime": -30375.0, "env_to_module_sum_episodes_length_in": 10.36823839457432, "num_episodes": 250.0, "num_module_steps_sampled_lifetime": {"default_policy": -607500.0}, "episode_return_min": -9.5, "episode_len_mean": 20.0, "episode_duration_sec_mean": 0.005018034337088466, "weights_seq_no": 2.0, "episode_len_max": 20, "num_env_steps_sampled_lifetime": -607500.0, "env_step_timer": 1.5430919269734014e-05, "rlmodule_inference_timer": 3.0115243718533933e-05, "num_module_steps_sampled": {"default_policy": 5000.0}, "num_env_steps_sampled_lifetime_throughput": 3542.042092016934}, "learners": {"default_policy": {"diff_num_grad_updates_vs_sampler_policy": 1.0, "curr_entropy_coeff": 0.0090570820258, "policy_loss": 0.29057320952415466, "default_optimizer_learning_rate": 0.0002847858517, "num_trainable_parameters": 6003, "num_module_steps_trained_lifetime": 18000, "weights_seq_no": 3.0, "vf_loss_unclipped": 29.159080505371094, "num_module_steps_trained": 6000, "mean_kl_loss": 0.0007080155191943049, "curr_kl_coeff": 0.09331203997135162, "entropy": 0.684884786605835, "module_train_batch_size_mean": 1000.0, "gradients_default_optimizer_global_norm": 0.044358815997838974, "vf_loss": 0.10278083384037018, "vf_explained_var": -0.010493040084838867, "total_loss": 0.3532428741455078, "num_module_steps_trained_lifetime_throughput": 150735.7388500169}, "__all_modules__": {"num_trainable_parameters": 6003, "learner_connector_sum_episodes_length_in": 5000.0, "learner_connector": {"timers": {"connectors": {"batch_individual_items": 0.06499686890093144, "add_columns_from_episodes_to_train_batch": 0.047265225910884334, "add_one_ts_to_episodes_and_truncate": 0.014811336753156502, "add_observations_from_episodes_to_batch": 0.0008749281963799149, "add_states_from_episodes_to_batch": 8.66123802261427e-06, "general_advantage_estimation": 0.014574746614170728, "add_time_dim_to_batch_and_zero_pad": 6.0499313671607525e-05, "numpy_to_tensor": 0.00015429668907308952}}, "connector_pipeline_timer": 0.14314328035216312}, "num_env_steps_trained_lifetime": 94500, "num_env_steps_trained": 31500, "num_non_trainable_parameters": 0, "num_module_steps_trained_lifetime": 18000, "num_module_steps_trained": 6000, "learner_connector_sum_episodes_length_out": 5250.0, "num_env_steps_trained_lifetime_throughput": 789349.6730071147, "num_module_steps_trained_throughput": 150619.23746382908, "num_module_steps_trained_lifetime_throughput": 150536.7617897064}}, "num_training_step_calls_per_iteration": 1, "evaluation": {"env_runners": {"episode_len_mean": 20.0, "module_to_env_connector": {"connector_pipeline_timer": 9.844546807659757e-05, "timers": {"connectors": {"remove_single_ts_time_rank_from_batch": 5.784738258536374e-07, "tensor_to_numpy": 1.2726040656415224e-05, "normalize_and_clip_actions": 9.232035828307517e-06, "listify_data_for_vector_env": 1.099161701948668e-05, "un_batch_to_individual_items": 5.3716019780712504e-06, "get_actions": 3.450091392169775e-05}}}, "num_env_steps_sampled_lifetime": 15400, "rlmodule_inference_timer": 2.6601285373940473e-05, "env_to_module_connector": {"timers": {"connectors": {"add_time_dim_to_batch_and_zero_pad": 2.2578206736043645e-06, "numpy_to_tensor": 8.108278673211969e-06, "batch_individual_items": 6.161624326679298e-06, "add_states_from_episodes_to_batch": 1.6384926484873752e-06, "add_observations_from_episodes_to_batch": 2.8364693281517053e-06}}, "connector_pipeline_timer": 4.227488810425402e-05}, "num_episodes_lifetime": 60, "weights_seq_no": 3.0, "episode_len_max": 20, "sample": 0.14744514588458696, "episode_return_max": 14.5, "env_reset_timer": 0.0006970367083791644, "agent_episode_returns_mean": {"default_agent": 1.3833333333333333}, "module_episode_returns_mean": {"default_policy": 1.3833333333333333}, "num_episodes": 20, "episode_return_min": -12.5, "episode_duration_sec_mean": 0.005275133991381154, "num_module_steps_sampled": {"default_policy": 400}, "num_env_steps_sampled": 400, "num_agent_steps_sampled_lifetime": {"default_agent": 1200}, "env_to_module_sum_episodes_length_in": 10.368205581254823, "num_agent_steps_sampled": {"default_agent": 400}, "env_step_timer": 1.3910744549717274e-05, "num_module_steps_sampled_lifetime": {"default_policy": 1200}, "env_to_module_sum_episodes_length_out": 10.368205581254823, "episode_len_min": 20, "episode_return_mean": 1.3833333333333333, "time_between_sampling": 1.9116457304370125}, "num_healthy_workers": 1, "actor_manager_num_outstanding_async_reqs": 0, "num_remote_worker_restarts": 0}, "num_env_steps_sampled_lifetime": -607500.0, "fault_tolerance": {"num_healthy_workers": 0, "num_remote_worker_restarts": 0}, "env_runner_group": {"actor_manager_num_outstanding_async_reqs": 0}, "done": false, "training_iteration": 3, "trial_id": "4da12_00000", "date": "2025-08-11_19-21-39", "timestamp": 1754932899, "time_this_iter_s": 1.7286961078643799, "time_total_s": 6.043993949890137, "pid": 14324, "hostname": "Mac", "node_ip": "127.0.0.1", "config": {"exploration_config": {}, "extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "placement_strategy": "PACK", "num_gpus": 0, "_fake_gpus": false, "num_cpus_for_main_process": 2, "eager_tracing": true, "eager_max_retraces": 20, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "torch_compile_learner": false, "torch_compile_learner_what_to_compile": "forward_train", "torch_compile_learner_dynamo_backend": "aot_eager", "torch_compile_learner_dynamo_mode": null, "torch_compile_worker": false, "torch_compile_worker_dynamo_backend": "aot_eager", "torch_compile_worker_dynamo_mode": null, "torch_ddp_kwargs": {}, "torch_skip_nan_gradients": false, "env": "Umbrella", "env_config": {}, "observation_space": null, "action_space": null, "clip_rewards": null, "normalize_actions": true, "clip_actions": false, "_is_atari": null, "disable_env_checking": false, "render_env": false, "action_mask_key": "action_mask", "env_runner_cls": null, "num_env_runners": 0, "create_local_env_runner": true, "num_envs_per_env_runner": 1, "gym_env_vectorize_mode": "SYNC", "num_cpus_per_env_runner": 1, "num_gpus_per_env_runner": 0, "custom_resources_per_env_runner": {}, "validate_env_runners_after_construction": true, "episodes_to_numpy": true, "max_requests_in_flight_per_env_runner": 1, "sample_timeout_s": 60.0, "_env_to_module_connector": null, "add_default_connectors_to_env_to_module_pipeline": true, "_module_to_env_connector": null, "add_default_connectors_to_module_to_env_pipeline": true, "merge_env_runner_states": "training_only", "broadcast_env_runner_states": true, "episode_lookback_horizon": 1, "rollout_fragment_length": "auto", "batch_mode": "complete_episodes", "compress_observations": false, "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "enable_tf1_exec_eagerly": false, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "preprocessor_pref": "deepmind", "observation_filter": "NoFilter", "update_worker_filter_stats": true, "use_worker_filter_stats": true, "sampler_perf_stats_ema_coef": null, "_is_online": true, "num_learners": 0, "num_gpus_per_learner": 0, "num_cpus_per_learner": "auto", "num_aggregator_actors_per_learner": 0, "max_requests_in_flight_per_aggregator_actor": 3, "local_gpu_idx": 0, "max_requests_in_flight_per_learner": 3, "gamma": 1, "lr": 0.0002847858517, "grad_clip": 0.5, "grad_clip_by": "global_norm", "_train_batch_size_per_learner": 5000, "train_batch_size": 4000, "num_epochs": 1, "minibatch_size": 1000, "shuffle_batch_per_epoch": true, "model": {"fcnet_hiddens": [256, 256], "fcnet_activation": "tanh", "fcnet_weights_initializer": null, "fcnet_weights_initializer_config": null, "fcnet_bias_initializer": null, "fcnet_bias_initializer_config": null, "conv_filters": null, "conv_activation": "relu", "conv_kernel_initializer": null, "conv_kernel_initializer_config": null, "conv_bias_initializer": null, "conv_bias_initializer_config": null, "conv_transpose_kernel_initializer": null, "conv_transpose_kernel_initializer_config": null, "conv_transpose_bias_initializer": null, "conv_transpose_bias_initializer_config": null, "post_fcnet_hiddens": [], "post_fcnet_activation": "relu", "post_fcnet_weights_initializer": null, "post_fcnet_weights_initializer_config": null, "post_fcnet_bias_initializer": null, "post_fcnet_bias_initializer_config": null, "free_log_std": false, "log_std_clip_param": 20.0, "no_final_linear": false, "vf_share_layers": false, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "lstm_weights_initializer": null, "lstm_weights_initializer_config": null, "lstm_bias_initializer": null, "lstm_bias_initializer_config": null, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "attention_use_n_prev_actions": 0, "attention_use_n_prev_rewards": 0, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": null, "custom_model_config": {}, "custom_action_dist": null, "custom_preprocessor": null, "encoder_latent_dim": null, "always_check_shapes": false, "lstm_use_prev_action_reward": -1, "_use_default_native_models": -1, "_disable_preprocessor_api": false, "_disable_action_flattening": false}, "_learner_connector": null, "add_default_connectors_to_learner_pipeline": true, "learner_config_dict": {}, "optimizer": {}, "_learner_class": null, "callbacks_on_algorithm_init": null, "callbacks_on_env_runners_recreated": null, "callbacks_on_offline_eval_runners_recreated": null, "callbacks_on_checkpoint_loaded": null, "callbacks_on_environment_created": null, "callbacks_on_episode_created": null, "callbacks_on_episode_start": null, "callbacks_on_episode_step": null, "callbacks_on_episode_end": null, "callbacks_on_evaluate_start": null, "callbacks_on_evaluate_end": null, "callbacks_on_evaluate_offline_start": null, "callbacks_on_evaluate_offline_end": null, "callbacks_on_sample_end": null, "callbacks_on_train_result": null, "explore": true, "enable_rl_module_and_learner": true, "enable_env_runner_and_connector_v2": true, "_prior_exploration_config": {"type": "StochasticSampling"}, "count_steps_by": "env_steps", "policy_map_capacity": 100, "policy_mapping_fn": "<function AlgorithmConfig.DEFAULT_POLICY_MAPPING_FN at 0x385eedb20>", "policies_to_train": null, "policy_states_are_swappable": false, "observation_fn": null, "offline_data_class": null, "input_read_method": "read_parquet", "input_read_method_kwargs": {}, "input_read_schema": {}, "input_read_episodes": false, "input_read_sample_batches": false, "input_read_batch_size": null, "input_filesystem": null, "input_filesystem_kwargs": {}, "input_compress_columns": ["obs", "new_obs"], "input_spaces_jsonable": true, "materialize_data": false, "materialize_mapped_data": true, "map_batches_kwargs": {}, "iter_batches_kwargs": {}, "ignore_final_observation": false, "prelearner_class": null, "prelearner_buffer_class": null, "prelearner_buffer_kwargs": {}, "prelearner_module_synch_period": 10, "dataset_num_iters_per_learner": null, "input_config": {}, "actions_in_input_normalized": false, "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_config": {}, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "output_max_rows_per_file": null, "output_write_remaining_data": false, "output_write_method": "write_parquet", "output_write_method_kwargs": {}, "output_filesystem": null, "output_filesystem_kwargs": {}, "output_write_episodes": true, "offline_sampling": false, "evaluation_interval": 1, "evaluation_duration": 20, "evaluation_duration_unit": "episodes", "evaluation_sample_timeout_s": 120.0, "evaluation_auto_duration_min_env_steps_per_sample": 100, "evaluation_auto_duration_max_env_steps_per_sample": 2000, "evaluation_parallel_to_training": false, "evaluation_force_reset_envs_before_iteration": true, "evaluation_config": null, "off_policy_estimation_methods": {}, "ope_split_batch_by_episode": true, "evaluation_num_env_runners": 1, "in_evaluation": false, "sync_filters_on_rollout_workers_timeout_s": 10.0, "offline_evaluation_interval": null, "num_offline_eval_runners": 0, "offline_loss_for_module_fn": null, "offline_evaluation_duration": 1, "offline_evaluation_parallel_to_training": false, "offline_evaluation_timeout_s": 120.0, "num_cpus_per_offline_eval_runner": 1, "num_gpus_per_offline_eval_runner": 0, "custom_resources_per_offline_eval_runner": {}, "restart_failed_offline_eval_runners": true, "ignore_offline_eval_runner_failures": false, "max_num_offline_eval_runner_restarts": 1000, "offline_eval_runner_restore_timeout_s": 1800.0, "max_requests_in_flight_per_offline_eval_runner": 1, "validate_offline_eval_runners_after_construction": true, "offline_eval_runner_health_probe_timeout_s": 30.0, "offline_eval_rl_module_inference_only": false, "broadcast_offline_eval_runner_states": false, "offline_eval_batch_size_per_runner": 256, "dataset_num_iters_per_eval_runner": 1, "keep_per_episode_custom_metrics": false, "metrics_episode_collection_timeout_s": 60.0, "metrics_num_episodes_for_smoothing": 100, "min_time_s_per_iteration": null, "min_train_timesteps_per_iteration": 0, "min_sample_timesteps_per_iteration": 0, "log_gradients": true, "export_native_model_files": false, "checkpoint_trainable_policies_only": false, "logger_creator": null, "logger_config": null, "log_level": "WARN", "log_sys_usage": true, "fake_sampler": false, "seed": 7, "restart_failed_env_runners": true, "ignore_env_runner_failures": false, "max_num_env_runner_restarts": 1000, "delay_between_env_runner_restarts_s": 60.0, "restart_failed_sub_environments": false, "num_consecutive_env_runner_failures_tolerance": 100, "env_runner_health_probe_timeout_s": 30.0, "env_runner_restore_timeout_s": 1800.0, "_model_config": {}, "_rl_module_spec": "RLModuleSpec(module_class=None, observation_space=None, action_space=None, inference_only=False, learner_only=False, model_config=DefaultModelConfig(fcnet_hiddens=[60, 90], fcnet_activation='tanh', fcnet_kernel_initializer=None, fcnet_kernel_initializer_kwargs=None, fcnet_bias_initializer=None, fcnet_bias_initializer_kwargs=None, conv_filters=None, conv_activation='relu', conv_kernel_initializer=None, conv_kernel_initializer_kwargs=None, conv_bias_initializer=None, conv_bias_initializer_kwargs=None, head_fcnet_hiddens=[], head_fcnet_activation='relu', head_fcnet_kernel_initializer=None, head_fcnet_kernel_initializer_kwargs=None, head_fcnet_bias_initializer=None, head_fcnet_bias_initializer_kwargs=None, free_log_std=False, log_std_clip_param=20.0, vf_share_layers=True, use_lstm=False, max_seq_len=20, lstm_cell_size=256, lstm_use_prev_action=False, lstm_use_prev_reward=False, lstm_kernel_initializer=None, lstm_kernel_initializer_kwargs=None, lstm_bias_initializer=None, lstm_bias_initializer_kwargs=None), catalog_class=None, load_state_path=None, model_config_dict=None)", "algorithm_config_overrides_per_module": {}, "_per_module_overrides": {}, "_validate_config": true, "_use_msgpack_checkpoints": false, "_torch_grad_scaler_class": null, "_torch_lr_scheduler_classes": null, "_tf_policy_handles_more_than_one_loss": false, "_disable_preprocessor_api": false, "_disable_action_flattening": false, "_disable_initialize_loss_from_dummy_batch": false, "_dont_auto_sync_env_runner_states": false, "env_task_fn": -1, "enable_connectors": -1, "simple_optimizer": false, "policy_map_cache": -1, "worker_cls": -1, "synchronize_filters": -1, "enable_async_evaluation": -1, "custom_async_evaluation_function": -1, "_enable_rl_module_api": -1, "auto_wrap_old_gym_envs": -1, "always_attach_evaluation_results": -1, "replay_sequence_length": null, "_disable_execution_plan_api": -1, "use_critic": true, "use_gae": true, "use_kl_loss": true, "kl_coeff": 0.7464963036515, "kl_target": 0.0270990929592, "vf_loss_coeff": 0.6688075857018, "entropy_coeff": 0.0090570820258, "clip_param": 0.1221781641624, "vf_clip_param": 0.1027808522125, "entropy_coeff_schedule": null, "lr_schedule": null, "sgd_minibatch_size": -1, "vf_share_layers": -1, "__stdout_file__": null, "__stderr_file__": null, "lambda": 0.9099046732075, "input": "sampler", "policies": {"default_policy": [null, null, null, null]}, "callbacks": "<class 'ray.rllib.callbacks.callbacks.RLlibCallback'>", "create_env_on_driver": false, "custom_eval_function": null, "framework": "torch"}, "time_since_restore": 6.043993949890137, "iterations_since_restore": 3, "perf": {"cpu_util_percent": 47.5, "ram_util_percent": 80.95}}
{"timers": {"training_iteration": 2.144641087753249, "restore_env_runners": 1.0473327246028928e-05, "training_step": 2.144235919262486, "env_runner_sampling_timer": 1.9081957056960632, "learner_update_timer": 0.22427430064812545, "synch_weights": 0.006445751251054345, "restore_eval_env_runners": 9.988811867078766e-05, "evaluation_iteration": 0.17555671116175364, "synch_eval_env_connectors": 0.00033510461352998395, "synch_env_connectors": 6.585563451517373e-06}, "env_runners": {"num_agent_steps_sampled_lifetime": {"default_agent": -1225000.0}, "env_to_module_connector": {"timers": {"connectors": {"numpy_to_tensor": 8.484918781685855e-06, "batch_individual_items": 6.250946857358492e-06, "add_observations_from_episodes_to_batch": 3.060914543111571e-06, "add_time_dim_to_batch_and_zero_pad": 2.4412318710674494e-06, "add_states_from_episodes_to_batch": 1.7505607892771326e-06}}, "connector_pipeline_timer": 4.3805746776646534e-05}, "module_to_env_connector": {"timers": {"connectors": {"get_actions": 3.871168527019969e-05, "normalize_and_clip_actions": 9.455076281279152e-06, "listify_data_for_vector_env": 1.0899780175104731e-05, "remove_single_ts_time_rank_from_batch": 5.788974211636789e-07, "tensor_to_numpy": 1.313483837857787e-05, "un_batch_to_individual_items": 5.362680004296104e-06}}, "connector_pipeline_timer": 0.0001038037634279561}, "time_between_sampling": 0.001850112931989469, "agent_episode_returns_mean": {"default_agent": 2.259999999999999}, "sample": 0.005024468055023445, "env_to_module_sum_episodes_length_out": 10.36823839457432, "num_env_steps_sampled": 5000.0, "num_agent_steps_sampled": {"default_agent": 5000.0}, "module_episode_returns_mean": {"default_policy": 2.259999999999999}, "env_reset_timer": 3.6038865919800005e-05, "episode_return_max": 10.5, "episode_len_min": 20, "episode_return_mean": 2.259999999999999, "num_episodes_lifetime": -61250.0, "env_to_module_sum_episodes_length_in": 10.36823839457432, "num_episodes": 250.0, "num_module_steps_sampled_lifetime": {"default_policy": -1225000.0}, "episode_return_min": -9.5, "episode_len_mean": 20.0, "episode_duration_sec_mean": 0.004532291975338012, "weights_seq_no": 3.0, "episode_len_max": 20, "num_env_steps_sampled_lifetime": -1225000.0, "env_step_timer": 1.3643685661764348e-05, "rlmodule_inference_timer": 2.7246990753327872e-05, "num_module_steps_sampled": {"default_policy": 5000.0}, "num_env_steps_sampled_lifetime_throughput": 3726.7003482650034}, "learners": {"default_policy": {"diff_num_grad_updates_vs_sampler_policy": 1.0, "curr_entropy_coeff": 0.0090570820258, "policy_loss": 0.0890611782670021, "default_optimizer_learning_rate": 0.0002847858517, "num_trainable_parameters": 6003, "num_module_steps_trained_lifetime": 24000, "weights_seq_no": 4.0, "vf_loss_unclipped": 28.754053115844727, "num_module_steps_trained": 6000, "mean_kl_loss": 0.0009349097963422537, "curr_kl_coeff": 0.04665601998567581, "entropy": 0.6782488226890564, "module_train_batch_size_mean": 1000.0, "gradients_default_optimizer_global_norm": 0.05304211378097534, "vf_loss": 0.10278083384037018, "vf_explained_var": -0.010841846466064453, "total_loss": 0.15174606442451477, "num_module_steps_trained_lifetime_throughput": 157157.78045724818}, "__all_modules__": {"num_trainable_parameters": 6003, "learner_connector_sum_episodes_length_in": 5000.0, "learner_connector": {"timers": {"connectors": {"batch_individual_items": 0.06466657812222397, "add_columns_from_episodes_to_train_batch": 0.04713554782095529, "add_one_ts_to_episodes_and_truncate": 0.014740362556232489, "add_observations_from_episodes_to_batch": 0.0008745164144556038, "add_states_from_episodes_to_batch": 8.61296586447861e-06, "general_advantage_estimation": 0.014485187898342616, "add_time_dim_to_batch_and_zero_pad": 6.0012241106829605e-05, "numpy_to_tensor": 0.00015335622269555462}}, "connector_pipeline_timer": 0.1425178792088183}, "num_env_steps_trained_lifetime": 126000, "num_env_steps_trained": 31500, "num_non_trainable_parameters": 0, "num_module_steps_trained_lifetime": 24000, "num_module_steps_trained": 6000, "learner_connector_sum_episodes_length_out": 5250.0, "num_env_steps_trained_lifetime_throughput": 823180.9539588579, "num_module_steps_trained_throughput": 157059.97885599727, "num_module_steps_trained_lifetime_throughput": 156976.31563843592}}, "num_training_step_calls_per_iteration": 1, "evaluation": {"env_runners": {"episode_len_mean": 20.0, "module_to_env_connector": {"connector_pipeline_timer": 0.00010096733628738098, "timers": {"connectors": {"remove_single_ts_time_rank_from_batch": 5.74183736456037e-07, "tensor_to_numpy": 1.290610200002407e-05, "normalize_and_clip_actions": 9.416161356989694e-06, "listify_data_for_vector_env": 1.1126103939962556e-05, "un_batch_to_individual_items": 5.43724564410128e-06, "get_actions": 3.641292100697173e-05}}}, "num_env_steps_sampled_lifetime": 20400, "rlmodule_inference_timer": 2.754066892937303e-05, "env_to_module_connector": {"timers": {"connectors": {"add_time_dim_to_batch_and_zero_pad": 2.1886149060119954e-06, "numpy_to_tensor": 8.30381886606792e-06, "batch_individual_items": 6.148697892641507e-06, "add_states_from_episodes_to_batch": 1.5704494546159379e-06, "add_observations_from_episodes_to_batch": 2.8291011839991295e-06}}, "connector_pipeline_timer": 4.20277347508544e-05}, "num_episodes_lifetime": 80, "weights_seq_no": 4.0, "episode_len_max": 20, "sample": 0.14694271942553286, "episode_return_max": 14.5, "env_reset_timer": 0.0006909313420611434, "agent_episode_returns_mean": {"default_agent": 1.05}, "module_episode_returns_mean": {"default_policy": 1.05}, "num_episodes": 20, "episode_return_min": -12.5, "episode_duration_sec_mean": 0.005071589541330468, "num_module_steps_sampled": {"default_policy": 400}, "num_env_steps_sampled": 400, "num_agent_steps_sampled_lifetime": {"default_agent": 1600}, "env_to_module_sum_episodes_length_in": 10.368237912813044, "num_agent_steps_sampled": {"default_agent": 400}, "env_step_timer": 1.4201561922954434e-05, "num_module_steps_sampled_lifetime": {"default_policy": 1600}, "env_to_module_sum_episodes_length_out": 10.368237912813044, "episode_len_min": 20, "episode_return_mean": 1.05, "time_between_sampling": 1.9082148002128467}, "num_healthy_workers": 1, "actor_manager_num_outstanding_async_reqs": 0, "num_remote_worker_restarts": 0}, "num_env_steps_sampled_lifetime": -1225000.0, "fault_tolerance": {"num_healthy_workers": 0, "num_remote_worker_restarts": 0}, "env_runner_group": {"actor_manager_num_outstanding_async_reqs": 0}, "done": false, "training_iteration": 4, "trial_id": "4da12_00000", "date": "2025-08-11_19-21-40", "timestamp": 1754932900, "time_this_iter_s": 1.655738115310669, "time_total_s": 7.699732065200806, "pid": 14324, "hostname": "Mac", "node_ip": "127.0.0.1", "config": {"exploration_config": {}, "extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "placement_strategy": "PACK", "num_gpus": 0, "_fake_gpus": false, "num_cpus_for_main_process": 2, "eager_tracing": true, "eager_max_retraces": 20, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "torch_compile_learner": false, "torch_compile_learner_what_to_compile": "forward_train", "torch_compile_learner_dynamo_backend": "aot_eager", "torch_compile_learner_dynamo_mode": null, "torch_compile_worker": false, "torch_compile_worker_dynamo_backend": "aot_eager", "torch_compile_worker_dynamo_mode": null, "torch_ddp_kwargs": {}, "torch_skip_nan_gradients": false, "env": "Umbrella", "env_config": {}, "observation_space": null, "action_space": null, "clip_rewards": null, "normalize_actions": true, "clip_actions": false, "_is_atari": null, "disable_env_checking": false, "render_env": false, "action_mask_key": "action_mask", "env_runner_cls": null, "num_env_runners": 0, "create_local_env_runner": true, "num_envs_per_env_runner": 1, "gym_env_vectorize_mode": "SYNC", "num_cpus_per_env_runner": 1, "num_gpus_per_env_runner": 0, "custom_resources_per_env_runner": {}, "validate_env_runners_after_construction": true, "episodes_to_numpy": true, "max_requests_in_flight_per_env_runner": 1, "sample_timeout_s": 60.0, "_env_to_module_connector": null, "add_default_connectors_to_env_to_module_pipeline": true, "_module_to_env_connector": null, "add_default_connectors_to_module_to_env_pipeline": true, "merge_env_runner_states": "training_only", "broadcast_env_runner_states": true, "episode_lookback_horizon": 1, "rollout_fragment_length": "auto", "batch_mode": "complete_episodes", "compress_observations": false, "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "enable_tf1_exec_eagerly": false, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "preprocessor_pref": "deepmind", "observation_filter": "NoFilter", "update_worker_filter_stats": true, "use_worker_filter_stats": true, "sampler_perf_stats_ema_coef": null, "_is_online": true, "num_learners": 0, "num_gpus_per_learner": 0, "num_cpus_per_learner": "auto", "num_aggregator_actors_per_learner": 0, "max_requests_in_flight_per_aggregator_actor": 3, "local_gpu_idx": 0, "max_requests_in_flight_per_learner": 3, "gamma": 1, "lr": 0.0002847858517, "grad_clip": 0.5, "grad_clip_by": "global_norm", "_train_batch_size_per_learner": 5000, "train_batch_size": 4000, "num_epochs": 1, "minibatch_size": 1000, "shuffle_batch_per_epoch": true, "model": {"fcnet_hiddens": [256, 256], "fcnet_activation": "tanh", "fcnet_weights_initializer": null, "fcnet_weights_initializer_config": null, "fcnet_bias_initializer": null, "fcnet_bias_initializer_config": null, "conv_filters": null, "conv_activation": "relu", "conv_kernel_initializer": null, "conv_kernel_initializer_config": null, "conv_bias_initializer": null, "conv_bias_initializer_config": null, "conv_transpose_kernel_initializer": null, "conv_transpose_kernel_initializer_config": null, "conv_transpose_bias_initializer": null, "conv_transpose_bias_initializer_config": null, "post_fcnet_hiddens": [], "post_fcnet_activation": "relu", "post_fcnet_weights_initializer": null, "post_fcnet_weights_initializer_config": null, "post_fcnet_bias_initializer": null, "post_fcnet_bias_initializer_config": null, "free_log_std": false, "log_std_clip_param": 20.0, "no_final_linear": false, "vf_share_layers": false, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "lstm_weights_initializer": null, "lstm_weights_initializer_config": null, "lstm_bias_initializer": null, "lstm_bias_initializer_config": null, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "attention_use_n_prev_actions": 0, "attention_use_n_prev_rewards": 0, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": null, "custom_model_config": {}, "custom_action_dist": null, "custom_preprocessor": null, "encoder_latent_dim": null, "always_check_shapes": false, "lstm_use_prev_action_reward": -1, "_use_default_native_models": -1, "_disable_preprocessor_api": false, "_disable_action_flattening": false}, "_learner_connector": null, "add_default_connectors_to_learner_pipeline": true, "learner_config_dict": {}, "optimizer": {}, "_learner_class": null, "callbacks_on_algorithm_init": null, "callbacks_on_env_runners_recreated": null, "callbacks_on_offline_eval_runners_recreated": null, "callbacks_on_checkpoint_loaded": null, "callbacks_on_environment_created": null, "callbacks_on_episode_created": null, "callbacks_on_episode_start": null, "callbacks_on_episode_step": null, "callbacks_on_episode_end": null, "callbacks_on_evaluate_start": null, "callbacks_on_evaluate_end": null, "callbacks_on_evaluate_offline_start": null, "callbacks_on_evaluate_offline_end": null, "callbacks_on_sample_end": null, "callbacks_on_train_result": null, "explore": true, "enable_rl_module_and_learner": true, "enable_env_runner_and_connector_v2": true, "_prior_exploration_config": {"type": "StochasticSampling"}, "count_steps_by": "env_steps", "policy_map_capacity": 100, "policy_mapping_fn": "<function AlgorithmConfig.DEFAULT_POLICY_MAPPING_FN at 0x385eedb20>", "policies_to_train": null, "policy_states_are_swappable": false, "observation_fn": null, "offline_data_class": null, "input_read_method": "read_parquet", "input_read_method_kwargs": {}, "input_read_schema": {}, "input_read_episodes": false, "input_read_sample_batches": false, "input_read_batch_size": null, "input_filesystem": null, "input_filesystem_kwargs": {}, "input_compress_columns": ["obs", "new_obs"], "input_spaces_jsonable": true, "materialize_data": false, "materialize_mapped_data": true, "map_batches_kwargs": {}, "iter_batches_kwargs": {}, "ignore_final_observation": false, "prelearner_class": null, "prelearner_buffer_class": null, "prelearner_buffer_kwargs": {}, "prelearner_module_synch_period": 10, "dataset_num_iters_per_learner": null, "input_config": {}, "actions_in_input_normalized": false, "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_config": {}, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "output_max_rows_per_file": null, "output_write_remaining_data": false, "output_write_method": "write_parquet", "output_write_method_kwargs": {}, "output_filesystem": null, "output_filesystem_kwargs": {}, "output_write_episodes": true, "offline_sampling": false, "evaluation_interval": 1, "evaluation_duration": 20, "evaluation_duration_unit": "episodes", "evaluation_sample_timeout_s": 120.0, "evaluation_auto_duration_min_env_steps_per_sample": 100, "evaluation_auto_duration_max_env_steps_per_sample": 2000, "evaluation_parallel_to_training": false, "evaluation_force_reset_envs_before_iteration": true, "evaluation_config": null, "off_policy_estimation_methods": {}, "ope_split_batch_by_episode": true, "evaluation_num_env_runners": 1, "in_evaluation": false, "sync_filters_on_rollout_workers_timeout_s": 10.0, "offline_evaluation_interval": null, "num_offline_eval_runners": 0, "offline_loss_for_module_fn": null, "offline_evaluation_duration": 1, "offline_evaluation_parallel_to_training": false, "offline_evaluation_timeout_s": 120.0, "num_cpus_per_offline_eval_runner": 1, "num_gpus_per_offline_eval_runner": 0, "custom_resources_per_offline_eval_runner": {}, "restart_failed_offline_eval_runners": true, "ignore_offline_eval_runner_failures": false, "max_num_offline_eval_runner_restarts": 1000, "offline_eval_runner_restore_timeout_s": 1800.0, "max_requests_in_flight_per_offline_eval_runner": 1, "validate_offline_eval_runners_after_construction": true, "offline_eval_runner_health_probe_timeout_s": 30.0, "offline_eval_rl_module_inference_only": false, "broadcast_offline_eval_runner_states": false, "offline_eval_batch_size_per_runner": 256, "dataset_num_iters_per_eval_runner": 1, "keep_per_episode_custom_metrics": false, "metrics_episode_collection_timeout_s": 60.0, "metrics_num_episodes_for_smoothing": 100, "min_time_s_per_iteration": null, "min_train_timesteps_per_iteration": 0, "min_sample_timesteps_per_iteration": 0, "log_gradients": true, "export_native_model_files": false, "checkpoint_trainable_policies_only": false, "logger_creator": null, "logger_config": null, "log_level": "WARN", "log_sys_usage": true, "fake_sampler": false, "seed": 7, "restart_failed_env_runners": true, "ignore_env_runner_failures": false, "max_num_env_runner_restarts": 1000, "delay_between_env_runner_restarts_s": 60.0, "restart_failed_sub_environments": false, "num_consecutive_env_runner_failures_tolerance": 100, "env_runner_health_probe_timeout_s": 30.0, "env_runner_restore_timeout_s": 1800.0, "_model_config": {}, "_rl_module_spec": "RLModuleSpec(module_class=None, observation_space=None, action_space=None, inference_only=False, learner_only=False, model_config=DefaultModelConfig(fcnet_hiddens=[60, 90], fcnet_activation='tanh', fcnet_kernel_initializer=None, fcnet_kernel_initializer_kwargs=None, fcnet_bias_initializer=None, fcnet_bias_initializer_kwargs=None, conv_filters=None, conv_activation='relu', conv_kernel_initializer=None, conv_kernel_initializer_kwargs=None, conv_bias_initializer=None, conv_bias_initializer_kwargs=None, head_fcnet_hiddens=[], head_fcnet_activation='relu', head_fcnet_kernel_initializer=None, head_fcnet_kernel_initializer_kwargs=None, head_fcnet_bias_initializer=None, head_fcnet_bias_initializer_kwargs=None, free_log_std=False, log_std_clip_param=20.0, vf_share_layers=True, use_lstm=False, max_seq_len=20, lstm_cell_size=256, lstm_use_prev_action=False, lstm_use_prev_reward=False, lstm_kernel_initializer=None, lstm_kernel_initializer_kwargs=None, lstm_bias_initializer=None, lstm_bias_initializer_kwargs=None), catalog_class=None, load_state_path=None, model_config_dict=None)", "algorithm_config_overrides_per_module": {}, "_per_module_overrides": {}, "_validate_config": true, "_use_msgpack_checkpoints": false, "_torch_grad_scaler_class": null, "_torch_lr_scheduler_classes": null, "_tf_policy_handles_more_than_one_loss": false, "_disable_preprocessor_api": false, "_disable_action_flattening": false, "_disable_initialize_loss_from_dummy_batch": false, "_dont_auto_sync_env_runner_states": false, "env_task_fn": -1, "enable_connectors": -1, "simple_optimizer": false, "policy_map_cache": -1, "worker_cls": -1, "synchronize_filters": -1, "enable_async_evaluation": -1, "custom_async_evaluation_function": -1, "_enable_rl_module_api": -1, "auto_wrap_old_gym_envs": -1, "always_attach_evaluation_results": -1, "replay_sequence_length": null, "_disable_execution_plan_api": -1, "use_critic": true, "use_gae": true, "use_kl_loss": true, "kl_coeff": 0.7464963036515, "kl_target": 0.0270990929592, "vf_loss_coeff": 0.6688075857018, "entropy_coeff": 0.0090570820258, "clip_param": 0.1221781641624, "vf_clip_param": 0.1027808522125, "entropy_coeff_schedule": null, "lr_schedule": null, "sgd_minibatch_size": -1, "vf_share_layers": -1, "__stdout_file__": null, "__stderr_file__": null, "lambda": 0.9099046732075, "input": "sampler", "policies": {"default_policy": [null, null, null, null]}, "callbacks": "<class 'ray.rllib.callbacks.callbacks.RLlibCallback'>", "create_env_on_driver": false, "custom_eval_function": null, "framework": "torch"}, "time_since_restore": 7.699732065200806, "iterations_since_restore": 4, "perf": {"cpu_util_percent": 41.06666666666667, "ram_util_percent": 80.10000000000001}}
{"timers": {"training_iteration": 2.138811070216468, "restore_env_runners": 1.0422344091809353e-05, "training_step": 2.138408255070556, "env_runner_sampling_timer": 1.9037524669789498, "learner_update_timer": 0.22297176472162844, "synch_weights": 0.006391253737550044, "restore_eval_env_runners": 9.899007759999949e-05, "evaluation_iteration": 0.17482732613052232, "synch_eval_env_connectors": 0.00033287773777067195, "synch_env_connectors": 6.562207558541558e-06}, "env_runners": {"num_agent_steps_sampled_lifetime": {"default_agent": -1842500.0}, "env_to_module_connector": {"timers": {"connectors": {"numpy_to_tensor": 8.464127987278784e-06, "batch_individual_items": 6.260655850851044e-06, "add_observations_from_episodes_to_batch": 2.9917645599130593e-06, "add_time_dim_to_batch_and_zero_pad": 2.4427052219146682e-06, "add_states_from_episodes_to_batch": 1.7408137260078492e-06}}, "connector_pipeline_timer": 4.375302140405078e-05}, "module_to_env_connector": {"timers": {"connectors": {"get_actions": 3.868556014679249e-05, "normalize_and_clip_actions": 9.422154712102396e-06, "listify_data_for_vector_env": 1.0871777886823962e-05, "remove_single_ts_time_rank_from_batch": 5.77764463877964e-07, "tensor_to_numpy": 1.3108605649846637e-05, "un_batch_to_individual_items": 5.344196449128621e-06}}, "connector_pipeline_timer": 0.00010374136955775188}, "time_between_sampling": 0.0015911776572071642, "agent_episode_returns_mean": {"default_agent": 1.1400000000000001}, "sample": 0.004909189045316855, "env_to_module_sum_episodes_length_out": 10.36823839457432, "num_env_steps_sampled": 5000.0, "num_agent_steps_sampled": {"default_agent": 5000.0}, "module_episode_returns_mean": {"default_policy": 1.1400000000000001}, "env_reset_timer": 3.337216846803263e-05, "episode_return_max": 10.5, "episode_len_min": 20, "episode_return_mean": 1.1400000000000001, "num_episodes_lifetime": -92125.0, "env_to_module_sum_episodes_length_in": 10.36823839457432, "num_episodes": 250.0, "num_module_steps_sampled_lifetime": {"default_policy": -1842500.0}, "episode_return_min": -9.5, "episode_len_mean": 20.0, "episode_duration_sec_mean": 0.004883386320434509, "weights_seq_no": 4.0, "episode_len_max": 20, "num_env_steps_sampled_lifetime": -1842500.0, "env_step_timer": 1.3654822745021434e-05, "rlmodule_inference_timer": 4.5042302226620697e-05, "num_module_steps_sampled": {"default_policy": 5000.0}, "num_env_steps_sampled_lifetime_throughput": 3725.050918288298}, "learners": {"default_policy": {"diff_num_grad_updates_vs_sampler_policy": 1.0, "curr_entropy_coeff": 0.0090570820258, "policy_loss": 0.20041051506996155, "default_optimizer_learning_rate": 0.0002847858517, "num_trainable_parameters": 6003, "num_module_steps_trained_lifetime": 30000, "weights_seq_no": 5.0, "vf_loss_unclipped": 29.06502914428711, "num_module_steps_trained": 6000, "mean_kl_loss": 0.0014776266179978848, "curr_kl_coeff": 0.023328009992837906, "entropy": 0.6661638617515564, "module_train_batch_size_mean": 1000.0, "gradients_default_optimizer_global_norm": 0.051883306354284286, "vf_loss": 0.10278083384037018, "vf_explained_var": -0.010644197463989258, "total_loss": 0.2631865441799164, "num_module_steps_trained_lifetime_throughput": 164679.1597604197}, "__all_modules__": {"num_trainable_parameters": 6003, "learner_connector_sum_episodes_length_in": 5000.0, "learner_connector": {"timers": {"connectors": {"batch_individual_items": 0.06432218109196731, "add_columns_from_episodes_to_train_batch": 0.04701002359305195, "add_one_ts_to_episodes_and_truncate": 0.014669159351405567, "add_observations_from_episodes_to_batch": 0.0008735520906986157, "add_states_from_episodes_to_batch": 8.56058617178467e-06, "general_advantage_estimation": 0.01439679434914108, "add_time_dim_to_batch_and_zero_pad": 5.9526288366030204e-05, "numpy_to_tensor": 0.00015252766118020402}}, "connector_pipeline_timer": 0.1418830320865804}, "num_env_steps_trained_lifetime": 157500, "num_env_steps_trained": 31500, "num_non_trainable_parameters": 0, "num_module_steps_trained_lifetime": 30000, "num_module_steps_trained": 6000, "learner_connector_sum_episodes_length_out": 5250.0, "num_env_steps_trained_lifetime_throughput": 862799.6195983614, "num_module_steps_trained_throughput": 164602.8024084904, "num_module_steps_trained_lifetime_throughput": 164517.06720635743}}, "num_training_step_calls_per_iteration": 1, "evaluation": {"env_runners": {"episode_len_mean": 20.0, "module_to_env_connector": {"connector_pipeline_timer": 0.00010053372614540204, "timers": {"connectors": {"remove_single_ts_time_rank_from_batch": 5.631014968030785e-07, "tensor_to_numpy": 1.285071884411402e-05, "normalize_and_clip_actions": 9.323979069553277e-06, "listify_data_for_vector_env": 1.1005075705754085e-05, "un_batch_to_individual_items": 5.382423942871059e-06, "get_actions": 3.61825387883097e-05}}}, "num_env_steps_sampled_lifetime": 25400, "rlmodule_inference_timer": 2.724803332994163e-05, "env_to_module_connector": {"timers": {"connectors": {"add_time_dim_to_batch_and_zero_pad": 2.2052259363309656e-06, "numpy_to_tensor": 8.182801578816803e-06, "batch_individual_items": 6.1644505379745864e-06, "add_states_from_episodes_to_batch": 1.6381014906032867e-06, "add_observations_from_episodes_to_batch": 2.8214441234833173e-06}}, "connector_pipeline_timer": 4.2218850619352056e-05}, "num_episodes_lifetime": 100, "weights_seq_no": 5.0, "episode_len_max": 20, "sample": 0.14645051681198828, "episode_return_max": 14.5, "env_reset_timer": 0.0006848091091389442, "agent_episode_returns_mean": {"default_agent": 0.85}, "module_episode_returns_mean": {"default_policy": 0.85}, "num_episodes": 20, "episode_return_min": -12.5, "episode_duration_sec_mean": 0.004954526219516992, "num_module_steps_sampled": {"default_policy": 400}, "num_env_steps_sampled": 400, "num_agent_steps_sampled_lifetime": {"default_agent": 2000}, "env_to_module_sum_episodes_length_in": 10.368238387501162, "num_agent_steps_sampled": {"default_agent": 400}, "env_step_timer": 1.3977688278529497e-05, "num_module_steps_sampled_lifetime": {"default_policy": 2000}, "env_to_module_sum_episodes_length_out": 10.368238387501162, "episode_len_min": 20, "episode_return_mean": 0.85, "time_between_sampling": 1.904930967630534}, "num_healthy_workers": 1, "actor_manager_num_outstanding_async_reqs": 0, "num_remote_worker_restarts": 0}, "num_env_steps_sampled_lifetime": -1842500.0, "fault_tolerance": {"num_healthy_workers": 0, "num_remote_worker_restarts": 0}, "env_runner_group": {"actor_manager_num_outstanding_async_reqs": 0}, "done": false, "training_iteration": 5, "trial_id": "4da12_00000", "date": "2025-08-11_19-21-42", "timestamp": 1754932902, "time_this_iter_s": 1.6670918464660645, "time_total_s": 9.36682391166687, "pid": 14324, "hostname": "Mac", "node_ip": "127.0.0.1", "config": {"exploration_config": {}, "extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "placement_strategy": "PACK", "num_gpus": 0, "_fake_gpus": false, "num_cpus_for_main_process": 2, "eager_tracing": true, "eager_max_retraces": 20, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "torch_compile_learner": false, "torch_compile_learner_what_to_compile": "forward_train", "torch_compile_learner_dynamo_backend": "aot_eager", "torch_compile_learner_dynamo_mode": null, "torch_compile_worker": false, "torch_compile_worker_dynamo_backend": "aot_eager", "torch_compile_worker_dynamo_mode": null, "torch_ddp_kwargs": {}, "torch_skip_nan_gradients": false, "env": "Umbrella", "env_config": {}, "observation_space": null, "action_space": null, "clip_rewards": null, "normalize_actions": true, "clip_actions": false, "_is_atari": null, "disable_env_checking": false, "render_env": false, "action_mask_key": "action_mask", "env_runner_cls": null, "num_env_runners": 0, "create_local_env_runner": true, "num_envs_per_env_runner": 1, "gym_env_vectorize_mode": "SYNC", "num_cpus_per_env_runner": 1, "num_gpus_per_env_runner": 0, "custom_resources_per_env_runner": {}, "validate_env_runners_after_construction": true, "episodes_to_numpy": true, "max_requests_in_flight_per_env_runner": 1, "sample_timeout_s": 60.0, "_env_to_module_connector": null, "add_default_connectors_to_env_to_module_pipeline": true, "_module_to_env_connector": null, "add_default_connectors_to_module_to_env_pipeline": true, "merge_env_runner_states": "training_only", "broadcast_env_runner_states": true, "episode_lookback_horizon": 1, "rollout_fragment_length": "auto", "batch_mode": "complete_episodes", "compress_observations": false, "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "enable_tf1_exec_eagerly": false, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "preprocessor_pref": "deepmind", "observation_filter": "NoFilter", "update_worker_filter_stats": true, "use_worker_filter_stats": true, "sampler_perf_stats_ema_coef": null, "_is_online": true, "num_learners": 0, "num_gpus_per_learner": 0, "num_cpus_per_learner": "auto", "num_aggregator_actors_per_learner": 0, "max_requests_in_flight_per_aggregator_actor": 3, "local_gpu_idx": 0, "max_requests_in_flight_per_learner": 3, "gamma": 1, "lr": 0.0002847858517, "grad_clip": 0.5, "grad_clip_by": "global_norm", "_train_batch_size_per_learner": 5000, "train_batch_size": 4000, "num_epochs": 1, "minibatch_size": 1000, "shuffle_batch_per_epoch": true, "model": {"fcnet_hiddens": [256, 256], "fcnet_activation": "tanh", "fcnet_weights_initializer": null, "fcnet_weights_initializer_config": null, "fcnet_bias_initializer": null, "fcnet_bias_initializer_config": null, "conv_filters": null, "conv_activation": "relu", "conv_kernel_initializer": null, "conv_kernel_initializer_config": null, "conv_bias_initializer": null, "conv_bias_initializer_config": null, "conv_transpose_kernel_initializer": null, "conv_transpose_kernel_initializer_config": null, "conv_transpose_bias_initializer": null, "conv_transpose_bias_initializer_config": null, "post_fcnet_hiddens": [], "post_fcnet_activation": "relu", "post_fcnet_weights_initializer": null, "post_fcnet_weights_initializer_config": null, "post_fcnet_bias_initializer": null, "post_fcnet_bias_initializer_config": null, "free_log_std": false, "log_std_clip_param": 20.0, "no_final_linear": false, "vf_share_layers": false, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "lstm_weights_initializer": null, "lstm_weights_initializer_config": null, "lstm_bias_initializer": null, "lstm_bias_initializer_config": null, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "attention_use_n_prev_actions": 0, "attention_use_n_prev_rewards": 0, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": null, "custom_model_config": {}, "custom_action_dist": null, "custom_preprocessor": null, "encoder_latent_dim": null, "always_check_shapes": false, "lstm_use_prev_action_reward": -1, "_use_default_native_models": -1, "_disable_preprocessor_api": false, "_disable_action_flattening": false}, "_learner_connector": null, "add_default_connectors_to_learner_pipeline": true, "learner_config_dict": {}, "optimizer": {}, "_learner_class": null, "callbacks_on_algorithm_init": null, "callbacks_on_env_runners_recreated": null, "callbacks_on_offline_eval_runners_recreated": null, "callbacks_on_checkpoint_loaded": null, "callbacks_on_environment_created": null, "callbacks_on_episode_created": null, "callbacks_on_episode_start": null, "callbacks_on_episode_step": null, "callbacks_on_episode_end": null, "callbacks_on_evaluate_start": null, "callbacks_on_evaluate_end": null, "callbacks_on_evaluate_offline_start": null, "callbacks_on_evaluate_offline_end": null, "callbacks_on_sample_end": null, "callbacks_on_train_result": null, "explore": true, "enable_rl_module_and_learner": true, "enable_env_runner_and_connector_v2": true, "_prior_exploration_config": {"type": "StochasticSampling"}, "count_steps_by": "env_steps", "policy_map_capacity": 100, "policy_mapping_fn": "<function AlgorithmConfig.DEFAULT_POLICY_MAPPING_FN at 0x385eedb20>", "policies_to_train": null, "policy_states_are_swappable": false, "observation_fn": null, "offline_data_class": null, "input_read_method": "read_parquet", "input_read_method_kwargs": {}, "input_read_schema": {}, "input_read_episodes": false, "input_read_sample_batches": false, "input_read_batch_size": null, "input_filesystem": null, "input_filesystem_kwargs": {}, "input_compress_columns": ["obs", "new_obs"], "input_spaces_jsonable": true, "materialize_data": false, "materialize_mapped_data": true, "map_batches_kwargs": {}, "iter_batches_kwargs": {}, "ignore_final_observation": false, "prelearner_class": null, "prelearner_buffer_class": null, "prelearner_buffer_kwargs": {}, "prelearner_module_synch_period": 10, "dataset_num_iters_per_learner": null, "input_config": {}, "actions_in_input_normalized": false, "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_config": {}, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "output_max_rows_per_file": null, "output_write_remaining_data": false, "output_write_method": "write_parquet", "output_write_method_kwargs": {}, "output_filesystem": null, "output_filesystem_kwargs": {}, "output_write_episodes": true, "offline_sampling": false, "evaluation_interval": 1, "evaluation_duration": 20, "evaluation_duration_unit": "episodes", "evaluation_sample_timeout_s": 120.0, "evaluation_auto_duration_min_env_steps_per_sample": 100, "evaluation_auto_duration_max_env_steps_per_sample": 2000, "evaluation_parallel_to_training": false, "evaluation_force_reset_envs_before_iteration": true, "evaluation_config": null, "off_policy_estimation_methods": {}, "ope_split_batch_by_episode": true, "evaluation_num_env_runners": 1, "in_evaluation": false, "sync_filters_on_rollout_workers_timeout_s": 10.0, "offline_evaluation_interval": null, "num_offline_eval_runners": 0, "offline_loss_for_module_fn": null, "offline_evaluation_duration": 1, "offline_evaluation_parallel_to_training": false, "offline_evaluation_timeout_s": 120.0, "num_cpus_per_offline_eval_runner": 1, "num_gpus_per_offline_eval_runner": 0, "custom_resources_per_offline_eval_runner": {}, "restart_failed_offline_eval_runners": true, "ignore_offline_eval_runner_failures": false, "max_num_offline_eval_runner_restarts": 1000, "offline_eval_runner_restore_timeout_s": 1800.0, "max_requests_in_flight_per_offline_eval_runner": 1, "validate_offline_eval_runners_after_construction": true, "offline_eval_runner_health_probe_timeout_s": 30.0, "offline_eval_rl_module_inference_only": false, "broadcast_offline_eval_runner_states": false, "offline_eval_batch_size_per_runner": 256, "dataset_num_iters_per_eval_runner": 1, "keep_per_episode_custom_metrics": false, "metrics_episode_collection_timeout_s": 60.0, "metrics_num_episodes_for_smoothing": 100, "min_time_s_per_iteration": null, "min_train_timesteps_per_iteration": 0, "min_sample_timesteps_per_iteration": 0, "log_gradients": true, "export_native_model_files": false, "checkpoint_trainable_policies_only": false, "logger_creator": null, "logger_config": null, "log_level": "WARN", "log_sys_usage": true, "fake_sampler": false, "seed": 7, "restart_failed_env_runners": true, "ignore_env_runner_failures": false, "max_num_env_runner_restarts": 1000, "delay_between_env_runner_restarts_s": 60.0, "restart_failed_sub_environments": false, "num_consecutive_env_runner_failures_tolerance": 100, "env_runner_health_probe_timeout_s": 30.0, "env_runner_restore_timeout_s": 1800.0, "_model_config": {}, "_rl_module_spec": "RLModuleSpec(module_class=None, observation_space=None, action_space=None, inference_only=False, learner_only=False, model_config=DefaultModelConfig(fcnet_hiddens=[60, 90], fcnet_activation='tanh', fcnet_kernel_initializer=None, fcnet_kernel_initializer_kwargs=None, fcnet_bias_initializer=None, fcnet_bias_initializer_kwargs=None, conv_filters=None, conv_activation='relu', conv_kernel_initializer=None, conv_kernel_initializer_kwargs=None, conv_bias_initializer=None, conv_bias_initializer_kwargs=None, head_fcnet_hiddens=[], head_fcnet_activation='relu', head_fcnet_kernel_initializer=None, head_fcnet_kernel_initializer_kwargs=None, head_fcnet_bias_initializer=None, head_fcnet_bias_initializer_kwargs=None, free_log_std=False, log_std_clip_param=20.0, vf_share_layers=True, use_lstm=False, max_seq_len=20, lstm_cell_size=256, lstm_use_prev_action=False, lstm_use_prev_reward=False, lstm_kernel_initializer=None, lstm_kernel_initializer_kwargs=None, lstm_bias_initializer=None, lstm_bias_initializer_kwargs=None), catalog_class=None, load_state_path=None, model_config_dict=None)", "algorithm_config_overrides_per_module": {}, "_per_module_overrides": {}, "_validate_config": true, "_use_msgpack_checkpoints": false, "_torch_grad_scaler_class": null, "_torch_lr_scheduler_classes": null, "_tf_policy_handles_more_than_one_loss": false, "_disable_preprocessor_api": false, "_disable_action_flattening": false, "_disable_initialize_loss_from_dummy_batch": false, "_dont_auto_sync_env_runner_states": false, "env_task_fn": -1, "enable_connectors": -1, "simple_optimizer": false, "policy_map_cache": -1, "worker_cls": -1, "synchronize_filters": -1, "enable_async_evaluation": -1, "custom_async_evaluation_function": -1, "_enable_rl_module_api": -1, "auto_wrap_old_gym_envs": -1, "always_attach_evaluation_results": -1, "replay_sequence_length": null, "_disable_execution_plan_api": -1, "use_critic": true, "use_gae": true, "use_kl_loss": true, "kl_coeff": 0.7464963036515, "kl_target": 0.0270990929592, "vf_loss_coeff": 0.6688075857018, "entropy_coeff": 0.0090570820258, "clip_param": 0.1221781641624, "vf_clip_param": 0.1027808522125, "entropy_coeff_schedule": null, "lr_schedule": null, "sgd_minibatch_size": -1, "vf_share_layers": -1, "__stdout_file__": null, "__stderr_file__": null, "lambda": 0.9099046732075, "input": "sampler", "policies": {"default_policy": [null, null, null, null]}, "callbacks": "<class 'ray.rllib.callbacks.callbacks.RLlibCallback'>", "create_env_on_driver": false, "custom_eval_function": null, "framework": "torch"}, "time_since_restore": 9.36682391166687, "iterations_since_restore": 5, "perf": {"cpu_util_percent": 38.7, "ram_util_percent": 79.75}}
{"timers": {"training_iteration": 2.1395751290951077, "restore_env_runners": 1.0375620506648018e-05, "training_step": 2.1391736108598343, "env_runner_sampling_timer": 1.9041789048084454, "learner_update_timer": 0.22337780249460898, "synch_weights": 0.006340070780223015, "restore_eval_env_runners": 9.806225645851692e-05, "evaluation_iteration": 0.1741122878694307, "synch_eval_env_connectors": 0.00033081855096821325, "synch_env_connectors": 6.5365857875358775e-06}, "env_runners": {"num_agent_steps_sampled_lifetime": {"default_agent": -2460000.0}, "env_to_module_connector": {"timers": {"connectors": {"numpy_to_tensor": 1.12365330141845e-05, "batch_individual_items": 8.023045290911921e-06, "add_observations_from_episodes_to_batch": 3.6025244030747243e-06, "add_time_dim_to_batch_and_zero_pad": 3.0672394104920525e-06, "add_states_from_episodes_to_batch": 2.007379875839644e-06}}, "connector_pipeline_timer": 5.351622003383319e-05}, "module_to_env_connector": {"timers": {"connectors": {"get_actions": 5.1917165554348826e-05, "normalize_and_clip_actions": 1.1475332821803899e-05, "listify_data_for_vector_env": 1.344639493880554e-05, "remove_single_ts_time_rank_from_batch": 7.115778857999667e-07, "tensor_to_numpy": 1.649059143973802e-05, "un_batch_to_individual_items": 6.428587558412633e-06}}, "connector_pipeline_timer": 0.00013127862152881949}, "time_between_sampling": 0.001767293960756857, "agent_episode_returns_mean": {"default_agent": 2.58}, "sample": 0.00583204105406182, "env_to_module_sum_episodes_length_out": 10.36823839457432, "num_env_steps_sampled": 5000.0, "num_agent_steps_sampled": {"default_agent": 5000.0}, "module_episode_returns_mean": {"default_policy": 2.58}, "env_reset_timer": 4.8966570104889666e-05, "episode_return_max": 10.5, "episode_len_min": 20, "episode_return_mean": 2.58, "num_episodes_lifetime": -123000.0, "env_to_module_sum_episodes_length_in": 10.36823839457432, "num_episodes": 250.0, "num_module_steps_sampled_lifetime": {"default_policy": -2460000.0}, "episode_return_min": -9.5, "episode_len_mean": 20.0, "episode_duration_sec_mean": 0.005923513145186008, "weights_seq_no": 5.0, "episode_len_max": 20, "num_env_steps_sampled_lifetime": -2460000.0, "env_step_timer": 1.8450627445166056e-05, "rlmodule_inference_timer": 4.417899503319766e-05, "num_module_steps_sampled": {"default_policy": 5000.0}, "num_env_steps_sampled_lifetime_throughput": 3143.03241892022}, "learners": {"default_policy": {"diff_num_grad_updates_vs_sampler_policy": 1.0, "curr_entropy_coeff": 0.0090570820258, "policy_loss": -0.03891005367040634, "default_optimizer_learning_rate": 0.0002847858517, "num_trainable_parameters": 6003, "num_module_steps_trained_lifetime": 36000, "weights_seq_no": 6.0, "vf_loss_unclipped": 28.573688507080078, "num_module_steps_trained": 6000, "mean_kl_loss": 0.0018115785205736756, "curr_kl_coeff": 0.011664004996418953, "entropy": 0.6465494632720947, "module_train_batch_size_mean": 1000.0, "gradients_default_optimizer_global_norm": 0.05181848257780075, "vf_loss": 0.10278083384037018, "vf_explained_var": -0.010707616806030273, "total_loss": 0.0240169670432806, "num_module_steps_trained_lifetime_throughput": 171725.3243919356}, "__all_modules__": {"num_trainable_parameters": 6003, "learner_connector_sum_episodes_length_in": 5000.0, "learner_connector": {"timers": {"connectors": {"batch_individual_items": 0.06555311803133583, "add_columns_from_episodes_to_train_batch": 0.04689960335781404, "add_one_ts_to_episodes_and_truncate": 0.014605515677798187, "add_observations_from_episodes_to_batch": 0.000873566979843646, "add_states_from_episodes_to_batch": 8.54789937519956e-06, "general_advantage_estimation": 0.014334329325433484, "add_time_dim_to_batch_and_zero_pad": 5.9283106160937186e-05, "numpy_to_tensor": 0.00015172238539422434}}, "connector_pipeline_timer": 0.1428740734356664}, "num_env_steps_trained_lifetime": 189000, "num_env_steps_trained": 31500, "num_non_trainable_parameters": 0, "num_module_steps_trained_lifetime": 36000, "num_module_steps_trained": 6000, "learner_connector_sum_episodes_length_out": 5250.0, "num_env_steps_trained_lifetime_throughput": 899706.8224964109, "num_module_steps_trained_throughput": 171662.56985459907, "num_module_steps_trained_lifetime_throughput": 171563.52774681515}}, "num_training_step_calls_per_iteration": 1, "evaluation": {"env_runners": {"episode_len_mean": 20.0, "module_to_env_connector": {"connector_pipeline_timer": 0.00010010303898481117, "timers": {"connectors": {"remove_single_ts_time_rank_from_batch": 5.690477555957018e-07, "tensor_to_numpy": 1.28243109961281e-05, "normalize_and_clip_actions": 9.424585423546122e-06, "listify_data_for_vector_env": 1.1207982793887392e-05, "un_batch_to_individual_items": 5.4268267558647165e-06, "get_actions": 3.527366184409405e-05}}}, "num_env_steps_sampled_lifetime": 30400, "rlmodule_inference_timer": 2.6587660966704158e-05, "env_to_module_connector": {"timers": {"connectors": {"add_time_dim_to_batch_and_zero_pad": 2.206736459051104e-06, "numpy_to_tensor": 8.243624905269734e-06, "batch_individual_items": 6.205457665764873e-06, "add_states_from_episodes_to_batch": 1.580801371761723e-06, "add_observations_from_episodes_to_batch": 2.855571848094747e-06}}, "connector_pipeline_timer": 4.228665511140673e-05}, "num_episodes_lifetime": 120, "weights_seq_no": 6.0, "episode_len_max": 20, "sample": 0.14600074330295668, "episode_return_max": 14.5, "env_reset_timer": 0.0006817514380619659, "agent_episode_returns_mean": {"default_agent": -0.15}, "module_episode_returns_mean": {"default_policy": -0.15}, "num_episodes": 20, "episode_return_min": -12.5, "episode_duration_sec_mean": 0.004550659571541473, "num_module_steps_sampled": {"default_policy": 400}, "num_env_steps_sampled": 400, "num_agent_steps_sampled_lifetime": {"default_agent": 2400}, "env_to_module_sum_episodes_length_in": 10.368238394470474, "num_agent_steps_sampled": {"default_agent": 400}, "env_step_timer": 1.4023550397872852e-05, "num_module_steps_sampled_lifetime": {"default_policy": 2400}, "env_to_module_sum_episodes_length_out": 10.368238394470474, "episode_len_min": 20, "episode_return_mean": -0.15, "time_between_sampling": 1.9082587375444524}, "num_healthy_workers": 1, "actor_manager_num_outstanding_async_reqs": 0, "num_remote_worker_restarts": 0}, "num_env_steps_sampled_lifetime": -2460000.0, "fault_tolerance": {"num_healthy_workers": 0, "num_remote_worker_restarts": 0}, "env_runner_group": {"actor_manager_num_outstanding_async_reqs": 0}, "done": false, "training_iteration": 6, "trial_id": "4da12_00000", "date": "2025-08-11_19-21-45", "timestamp": 1754932905, "time_this_iter_s": 2.331345319747925, "time_total_s": 11.698169231414795, "pid": 14324, "hostname": "Mac", "node_ip": "127.0.0.1", "config": {"exploration_config": {}, "extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "placement_strategy": "PACK", "num_gpus": 0, "_fake_gpus": false, "num_cpus_for_main_process": 2, "eager_tracing": true, "eager_max_retraces": 20, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "torch_compile_learner": false, "torch_compile_learner_what_to_compile": "forward_train", "torch_compile_learner_dynamo_backend": "aot_eager", "torch_compile_learner_dynamo_mode": null, "torch_compile_worker": false, "torch_compile_worker_dynamo_backend": "aot_eager", "torch_compile_worker_dynamo_mode": null, "torch_ddp_kwargs": {}, "torch_skip_nan_gradients": false, "env": "Umbrella", "env_config": {}, "observation_space": null, "action_space": null, "clip_rewards": null, "normalize_actions": true, "clip_actions": false, "_is_atari": null, "disable_env_checking": false, "render_env": false, "action_mask_key": "action_mask", "env_runner_cls": null, "num_env_runners": 0, "create_local_env_runner": true, "num_envs_per_env_runner": 1, "gym_env_vectorize_mode": "SYNC", "num_cpus_per_env_runner": 1, "num_gpus_per_env_runner": 0, "custom_resources_per_env_runner": {}, "validate_env_runners_after_construction": true, "episodes_to_numpy": true, "max_requests_in_flight_per_env_runner": 1, "sample_timeout_s": 60.0, "_env_to_module_connector": null, "add_default_connectors_to_env_to_module_pipeline": true, "_module_to_env_connector": null, "add_default_connectors_to_module_to_env_pipeline": true, "merge_env_runner_states": "training_only", "broadcast_env_runner_states": true, "episode_lookback_horizon": 1, "rollout_fragment_length": "auto", "batch_mode": "complete_episodes", "compress_observations": false, "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "enable_tf1_exec_eagerly": false, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "preprocessor_pref": "deepmind", "observation_filter": "NoFilter", "update_worker_filter_stats": true, "use_worker_filter_stats": true, "sampler_perf_stats_ema_coef": null, "_is_online": true, "num_learners": 0, "num_gpus_per_learner": 0, "num_cpus_per_learner": "auto", "num_aggregator_actors_per_learner": 0, "max_requests_in_flight_per_aggregator_actor": 3, "local_gpu_idx": 0, "max_requests_in_flight_per_learner": 3, "gamma": 1, "lr": 0.0002847858517, "grad_clip": 0.5, "grad_clip_by": "global_norm", "_train_batch_size_per_learner": 5000, "train_batch_size": 4000, "num_epochs": 1, "minibatch_size": 1000, "shuffle_batch_per_epoch": true, "model": {"fcnet_hiddens": [256, 256], "fcnet_activation": "tanh", "fcnet_weights_initializer": null, "fcnet_weights_initializer_config": null, "fcnet_bias_initializer": null, "fcnet_bias_initializer_config": null, "conv_filters": null, "conv_activation": "relu", "conv_kernel_initializer": null, "conv_kernel_initializer_config": null, "conv_bias_initializer": null, "conv_bias_initializer_config": null, "conv_transpose_kernel_initializer": null, "conv_transpose_kernel_initializer_config": null, "conv_transpose_bias_initializer": null, "conv_transpose_bias_initializer_config": null, "post_fcnet_hiddens": [], "post_fcnet_activation": "relu", "post_fcnet_weights_initializer": null, "post_fcnet_weights_initializer_config": null, "post_fcnet_bias_initializer": null, "post_fcnet_bias_initializer_config": null, "free_log_std": false, "log_std_clip_param": 20.0, "no_final_linear": false, "vf_share_layers": false, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "lstm_weights_initializer": null, "lstm_weights_initializer_config": null, "lstm_bias_initializer": null, "lstm_bias_initializer_config": null, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "attention_use_n_prev_actions": 0, "attention_use_n_prev_rewards": 0, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": null, "custom_model_config": {}, "custom_action_dist": null, "custom_preprocessor": null, "encoder_latent_dim": null, "always_check_shapes": false, "lstm_use_prev_action_reward": -1, "_use_default_native_models": -1, "_disable_preprocessor_api": false, "_disable_action_flattening": false}, "_learner_connector": null, "add_default_connectors_to_learner_pipeline": true, "learner_config_dict": {}, "optimizer": {}, "_learner_class": null, "callbacks_on_algorithm_init": null, "callbacks_on_env_runners_recreated": null, "callbacks_on_offline_eval_runners_recreated": null, "callbacks_on_checkpoint_loaded": null, "callbacks_on_environment_created": null, "callbacks_on_episode_created": null, "callbacks_on_episode_start": null, "callbacks_on_episode_step": null, "callbacks_on_episode_end": null, "callbacks_on_evaluate_start": null, "callbacks_on_evaluate_end": null, "callbacks_on_evaluate_offline_start": null, "callbacks_on_evaluate_offline_end": null, "callbacks_on_sample_end": null, "callbacks_on_train_result": null, "explore": true, "enable_rl_module_and_learner": true, "enable_env_runner_and_connector_v2": true, "_prior_exploration_config": {"type": "StochasticSampling"}, "count_steps_by": "env_steps", "policy_map_capacity": 100, "policy_mapping_fn": "<function AlgorithmConfig.DEFAULT_POLICY_MAPPING_FN at 0x385eedb20>", "policies_to_train": null, "policy_states_are_swappable": false, "observation_fn": null, "offline_data_class": null, "input_read_method": "read_parquet", "input_read_method_kwargs": {}, "input_read_schema": {}, "input_read_episodes": false, "input_read_sample_batches": false, "input_read_batch_size": null, "input_filesystem": null, "input_filesystem_kwargs": {}, "input_compress_columns": ["obs", "new_obs"], "input_spaces_jsonable": true, "materialize_data": false, "materialize_mapped_data": true, "map_batches_kwargs": {}, "iter_batches_kwargs": {}, "ignore_final_observation": false, "prelearner_class": null, "prelearner_buffer_class": null, "prelearner_buffer_kwargs": {}, "prelearner_module_synch_period": 10, "dataset_num_iters_per_learner": null, "input_config": {}, "actions_in_input_normalized": false, "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_config": {}, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "output_max_rows_per_file": null, "output_write_remaining_data": false, "output_write_method": "write_parquet", "output_write_method_kwargs": {}, "output_filesystem": null, "output_filesystem_kwargs": {}, "output_write_episodes": true, "offline_sampling": false, "evaluation_interval": 1, "evaluation_duration": 20, "evaluation_duration_unit": "episodes", "evaluation_sample_timeout_s": 120.0, "evaluation_auto_duration_min_env_steps_per_sample": 100, "evaluation_auto_duration_max_env_steps_per_sample": 2000, "evaluation_parallel_to_training": false, "evaluation_force_reset_envs_before_iteration": true, "evaluation_config": null, "off_policy_estimation_methods": {}, "ope_split_batch_by_episode": true, "evaluation_num_env_runners": 1, "in_evaluation": false, "sync_filters_on_rollout_workers_timeout_s": 10.0, "offline_evaluation_interval": null, "num_offline_eval_runners": 0, "offline_loss_for_module_fn": null, "offline_evaluation_duration": 1, "offline_evaluation_parallel_to_training": false, "offline_evaluation_timeout_s": 120.0, "num_cpus_per_offline_eval_runner": 1, "num_gpus_per_offline_eval_runner": 0, "custom_resources_per_offline_eval_runner": {}, "restart_failed_offline_eval_runners": true, "ignore_offline_eval_runner_failures": false, "max_num_offline_eval_runner_restarts": 1000, "offline_eval_runner_restore_timeout_s": 1800.0, "max_requests_in_flight_per_offline_eval_runner": 1, "validate_offline_eval_runners_after_construction": true, "offline_eval_runner_health_probe_timeout_s": 30.0, "offline_eval_rl_module_inference_only": false, "broadcast_offline_eval_runner_states": false, "offline_eval_batch_size_per_runner": 256, "dataset_num_iters_per_eval_runner": 1, "keep_per_episode_custom_metrics": false, "metrics_episode_collection_timeout_s": 60.0, "metrics_num_episodes_for_smoothing": 100, "min_time_s_per_iteration": null, "min_train_timesteps_per_iteration": 0, "min_sample_timesteps_per_iteration": 0, "log_gradients": true, "export_native_model_files": false, "checkpoint_trainable_policies_only": false, "logger_creator": null, "logger_config": null, "log_level": "WARN", "log_sys_usage": true, "fake_sampler": false, "seed": 7, "restart_failed_env_runners": true, "ignore_env_runner_failures": false, "max_num_env_runner_restarts": 1000, "delay_between_env_runner_restarts_s": 60.0, "restart_failed_sub_environments": false, "num_consecutive_env_runner_failures_tolerance": 100, "env_runner_health_probe_timeout_s": 30.0, "env_runner_restore_timeout_s": 1800.0, "_model_config": {}, "_rl_module_spec": "RLModuleSpec(module_class=None, observation_space=None, action_space=None, inference_only=False, learner_only=False, model_config=DefaultModelConfig(fcnet_hiddens=[60, 90], fcnet_activation='tanh', fcnet_kernel_initializer=None, fcnet_kernel_initializer_kwargs=None, fcnet_bias_initializer=None, fcnet_bias_initializer_kwargs=None, conv_filters=None, conv_activation='relu', conv_kernel_initializer=None, conv_kernel_initializer_kwargs=None, conv_bias_initializer=None, conv_bias_initializer_kwargs=None, head_fcnet_hiddens=[], head_fcnet_activation='relu', head_fcnet_kernel_initializer=None, head_fcnet_kernel_initializer_kwargs=None, head_fcnet_bias_initializer=None, head_fcnet_bias_initializer_kwargs=None, free_log_std=False, log_std_clip_param=20.0, vf_share_layers=True, use_lstm=False, max_seq_len=20, lstm_cell_size=256, lstm_use_prev_action=False, lstm_use_prev_reward=False, lstm_kernel_initializer=None, lstm_kernel_initializer_kwargs=None, lstm_bias_initializer=None, lstm_bias_initializer_kwargs=None), catalog_class=None, load_state_path=None, model_config_dict=None)", "algorithm_config_overrides_per_module": {}, "_per_module_overrides": {}, "_validate_config": true, "_use_msgpack_checkpoints": false, "_torch_grad_scaler_class": null, "_torch_lr_scheduler_classes": null, "_tf_policy_handles_more_than_one_loss": false, "_disable_preprocessor_api": false, "_disable_action_flattening": false, "_disable_initialize_loss_from_dummy_batch": false, "_dont_auto_sync_env_runner_states": false, "env_task_fn": -1, "enable_connectors": -1, "simple_optimizer": false, "policy_map_cache": -1, "worker_cls": -1, "synchronize_filters": -1, "enable_async_evaluation": -1, "custom_async_evaluation_function": -1, "_enable_rl_module_api": -1, "auto_wrap_old_gym_envs": -1, "always_attach_evaluation_results": -1, "replay_sequence_length": null, "_disable_execution_plan_api": -1, "use_critic": true, "use_gae": true, "use_kl_loss": true, "kl_coeff": 0.7464963036515, "kl_target": 0.0270990929592, "vf_loss_coeff": 0.6688075857018, "entropy_coeff": 0.0090570820258, "clip_param": 0.1221781641624, "vf_clip_param": 0.1027808522125, "entropy_coeff_schedule": null, "lr_schedule": null, "sgd_minibatch_size": -1, "vf_share_layers": -1, "__stdout_file__": null, "__stderr_file__": null, "lambda": 0.9099046732075, "input": "sampler", "policies": {"default_policy": [null, null, null, null]}, "callbacks": "<class 'ray.rllib.callbacks.callbacks.RLlibCallback'>", "create_env_on_driver": false, "custom_eval_function": null, "framework": "torch"}, "time_since_restore": 11.698169231414795, "iterations_since_restore": 6, "perf": {"cpu_util_percent": 52.4, "ram_util_percent": 80.96666666666667}}
{"timers": {"training_iteration": 2.133304564474495, "restore_env_runners": 1.0343944012243903e-05, "training_step": 2.1329050197517794, "env_runner_sampling_timer": 1.8992528111805478, "learner_update_timer": 0.22211934904987593, "synch_weights": 0.006282508412569115, "restore_eval_env_runners": 9.71828837917843e-05, "evaluation_iteration": 0.17350639249049896, "synch_eval_env_connectors": 0.00032903078565034064, "synch_env_connectors": 6.519970009828766e-06}, "env_runners": {"num_agent_steps_sampled_lifetime": {"default_agent": -3077500.0}, "env_to_module_connector": {"timers": {"connectors": {"numpy_to_tensor": 8.764069031363905e-06, "batch_individual_items": 6.542978494267094e-06, "add_observations_from_episodes_to_batch": 3.0399491138706517e-06, "add_time_dim_to_batch_and_zero_pad": 2.488709157293169e-06, "add_states_from_episodes_to_batch": 1.7767197342637852e-06}}, "connector_pipeline_timer": 4.472734596932172e-05}, "module_to_env_connector": {"timers": {"connectors": {"get_actions": 3.978572837290355e-05, "normalize_and_clip_actions": 9.567348113634103e-06, "listify_data_for_vector_env": 1.1063430827902996e-05, "remove_single_ts_time_rank_from_batch": 5.846652836769226e-07, "tensor_to_numpy": 1.3427845472932212e-05, "un_batch_to_individual_items": 5.441772240690608e-06}}, "connector_pipeline_timer": 0.00010582144483775003}, "time_between_sampling": 0.0026731211412844625, "agent_episode_returns_mean": {"default_agent": 3.7}, "sample": 0.00568568374622158, "env_to_module_sum_episodes_length_out": 10.36823839457432, "num_env_steps_sampled": 5000.0, "num_agent_steps_sampled": {"default_agent": 5000.0}, "module_episode_returns_mean": {"default_policy": 3.7}, "env_reset_timer": 5.249790522930761e-05, "episode_return_max": 10.5, "episode_len_min": 20, "episode_return_mean": 3.7, "num_episodes_lifetime": -153875.0, "env_to_module_sum_episodes_length_in": 10.36823839457432, "num_episodes": 250.0, "num_module_steps_sampled_lifetime": {"default_policy": -3077500.0}, "episode_return_min": -9.5, "episode_len_mean": 20.0, "episode_duration_sec_mean": 0.004633997513446958, "weights_seq_no": 6.0, "episode_len_max": 20, "num_env_steps_sampled_lifetime": -3077500.0, "env_step_timer": 1.4033652977209327e-05, "rlmodule_inference_timer": 2.8134238703038494e-05, "num_module_steps_sampled": {"default_policy": 5000.0}, "num_env_steps_sampled_lifetime_throughput": 3604.8458370467733}, "learners": {"default_policy": {"diff_num_grad_updates_vs_sampler_policy": 1.0, "curr_entropy_coeff": 0.0090570820258, "policy_loss": 0.17865099012851715, "default_optimizer_learning_rate": 0.0002847858517, "num_trainable_parameters": 6003, "num_module_steps_trained_lifetime": 42000, "weights_seq_no": 7.0, "vf_loss_unclipped": 28.70351791381836, "num_module_steps_trained": 6000, "mean_kl_loss": 0.00035054117324762046, "curr_kl_coeff": 0.0058320024982094765, "entropy": 0.6365110874176025, "module_train_batch_size_mean": 1000.0, "gradients_default_optimizer_global_norm": 0.12011439353227615, "vf_loss": 0.10278083384037018, "vf_explained_var": -0.010732293128967285, "total_loss": 0.24163073301315308, "num_module_steps_trained_lifetime_throughput": 179168.93267817574}, "__all_modules__": {"num_trainable_parameters": 6003, "learner_connector_sum_episodes_length_in": 5000.0, "learner_connector": {"timers": {"connectors": {"batch_individual_items": 0.06520727976096355, "add_columns_from_episodes_to_train_batch": 0.04678347023460345, "add_one_ts_to_episodes_and_truncate": 0.014540958430288568, "add_observations_from_episodes_to_batch": 0.000873750480404359, "add_states_from_episodes_to_batch": 8.490340268081318e-06, "general_advantage_estimation": 0.014247354362439887, "add_time_dim_to_batch_and_zero_pad": 5.878735616450573e-05, "numpy_to_tensor": 0.00015079724171802134}}, "connector_pipeline_timer": 0.14225637979199288}, "num_env_steps_trained_lifetime": 220500, "num_env_steps_trained": 31500, "num_non_trainable_parameters": 0, "num_module_steps_trained_lifetime": 42000, "num_module_steps_trained": 6000, "learner_connector_sum_episodes_length_out": 5250.0, "num_env_steps_trained_lifetime_throughput": 938775.1577231127, "num_module_steps_trained_throughput": 179122.08429484224, "num_module_steps_trained_lifetime_throughput": 179014.01251239845}}, "num_training_step_calls_per_iteration": 1, "evaluation": {"env_runners": {"episode_len_mean": 20.0, "module_to_env_connector": {"connector_pipeline_timer": 9.870893079386034e-05, "timers": {"connectors": {"remove_single_ts_time_rank_from_batch": 6.109643516396973e-07, "tensor_to_numpy": 1.2620477040207617e-05, "normalize_and_clip_actions": 9.190971697839647e-06, "listify_data_for_vector_env": 1.0957116267614262e-05, "un_batch_to_individual_items": 5.274826510769591e-06, "get_actions": 3.4621875680422494e-05}}}, "num_env_steps_sampled_lifetime": 35400, "rlmodule_inference_timer": 2.6236934787499368e-05, "env_to_module_connector": {"timers": {"connectors": {"add_time_dim_to_batch_and_zero_pad": 2.1639683626567548e-06, "numpy_to_tensor": 8.080237138897646e-06, "batch_individual_items": 5.994393561046172e-06, "add_states_from_episodes_to_batch": 1.564908546211613e-06, "add_observations_from_episodes_to_batch": 2.798806927217408e-06}}, "connector_pipeline_timer": 4.191720300581219e-05}, "num_episodes_lifetime": 140, "weights_seq_no": 7.0, "episode_len_max": 20, "sample": 0.14550454627981202, "episode_return_max": 14.5, "env_reset_timer": 0.0006756001743889278, "agent_episode_returns_mean": {"default_agent": 0.05}, "module_episode_returns_mean": {"default_policy": 0.05}, "num_episodes": 20, "episode_return_min": -12.5, "episode_duration_sec_mean": 0.004481363290688023, "num_module_steps_sampled": {"default_policy": 400}, "num_env_steps_sampled": 400, "num_agent_steps_sampled_lifetime": {"default_agent": 2800}, "env_to_module_sum_episodes_length_in": 10.368238394572801, "num_agent_steps_sampled": {"default_agent": 400}, "env_step_timer": 1.3714019549243347e-05, "num_module_steps_sampled_lifetime": {"default_policy": 2800}, "env_to_module_sum_episodes_length_out": 10.368238394572801, "episode_len_min": 20, "episode_return_mean": 0.05, "time_between_sampling": 1.904592451839492}, "num_healthy_workers": 1, "actor_manager_num_outstanding_async_reqs": 0, "num_remote_worker_restarts": 0}, "num_env_steps_sampled_lifetime": -3077500.0, "fault_tolerance": {"num_healthy_workers": 0, "num_remote_worker_restarts": 0}, "env_runner_group": {"actor_manager_num_outstanding_async_reqs": 0}, "done": false, "training_iteration": 7, "trial_id": "4da12_00000", "date": "2025-08-11_19-21-46", "timestamp": 1754932906, "time_this_iter_s": 1.6168830394744873, "time_total_s": 13.315052270889282, "pid": 14324, "hostname": "Mac", "node_ip": "127.0.0.1", "config": {"exploration_config": {}, "extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "placement_strategy": "PACK", "num_gpus": 0, "_fake_gpus": false, "num_cpus_for_main_process": 2, "eager_tracing": true, "eager_max_retraces": 20, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "torch_compile_learner": false, "torch_compile_learner_what_to_compile": "forward_train", "torch_compile_learner_dynamo_backend": "aot_eager", "torch_compile_learner_dynamo_mode": null, "torch_compile_worker": false, "torch_compile_worker_dynamo_backend": "aot_eager", "torch_compile_worker_dynamo_mode": null, "torch_ddp_kwargs": {}, "torch_skip_nan_gradients": false, "env": "Umbrella", "env_config": {}, "observation_space": null, "action_space": null, "clip_rewards": null, "normalize_actions": true, "clip_actions": false, "_is_atari": null, "disable_env_checking": false, "render_env": false, "action_mask_key": "action_mask", "env_runner_cls": null, "num_env_runners": 0, "create_local_env_runner": true, "num_envs_per_env_runner": 1, "gym_env_vectorize_mode": "SYNC", "num_cpus_per_env_runner": 1, "num_gpus_per_env_runner": 0, "custom_resources_per_env_runner": {}, "validate_env_runners_after_construction": true, "episodes_to_numpy": true, "max_requests_in_flight_per_env_runner": 1, "sample_timeout_s": 60.0, "_env_to_module_connector": null, "add_default_connectors_to_env_to_module_pipeline": true, "_module_to_env_connector": null, "add_default_connectors_to_module_to_env_pipeline": true, "merge_env_runner_states": "training_only", "broadcast_env_runner_states": true, "episode_lookback_horizon": 1, "rollout_fragment_length": "auto", "batch_mode": "complete_episodes", "compress_observations": false, "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "enable_tf1_exec_eagerly": false, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "preprocessor_pref": "deepmind", "observation_filter": "NoFilter", "update_worker_filter_stats": true, "use_worker_filter_stats": true, "sampler_perf_stats_ema_coef": null, "_is_online": true, "num_learners": 0, "num_gpus_per_learner": 0, "num_cpus_per_learner": "auto", "num_aggregator_actors_per_learner": 0, "max_requests_in_flight_per_aggregator_actor": 3, "local_gpu_idx": 0, "max_requests_in_flight_per_learner": 3, "gamma": 1, "lr": 0.0002847858517, "grad_clip": 0.5, "grad_clip_by": "global_norm", "_train_batch_size_per_learner": 5000, "train_batch_size": 4000, "num_epochs": 1, "minibatch_size": 1000, "shuffle_batch_per_epoch": true, "model": {"fcnet_hiddens": [256, 256], "fcnet_activation": "tanh", "fcnet_weights_initializer": null, "fcnet_weights_initializer_config": null, "fcnet_bias_initializer": null, "fcnet_bias_initializer_config": null, "conv_filters": null, "conv_activation": "relu", "conv_kernel_initializer": null, "conv_kernel_initializer_config": null, "conv_bias_initializer": null, "conv_bias_initializer_config": null, "conv_transpose_kernel_initializer": null, "conv_transpose_kernel_initializer_config": null, "conv_transpose_bias_initializer": null, "conv_transpose_bias_initializer_config": null, "post_fcnet_hiddens": [], "post_fcnet_activation": "relu", "post_fcnet_weights_initializer": null, "post_fcnet_weights_initializer_config": null, "post_fcnet_bias_initializer": null, "post_fcnet_bias_initializer_config": null, "free_log_std": false, "log_std_clip_param": 20.0, "no_final_linear": false, "vf_share_layers": false, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "lstm_weights_initializer": null, "lstm_weights_initializer_config": null, "lstm_bias_initializer": null, "lstm_bias_initializer_config": null, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "attention_use_n_prev_actions": 0, "attention_use_n_prev_rewards": 0, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": null, "custom_model_config": {}, "custom_action_dist": null, "custom_preprocessor": null, "encoder_latent_dim": null, "always_check_shapes": false, "lstm_use_prev_action_reward": -1, "_use_default_native_models": -1, "_disable_preprocessor_api": false, "_disable_action_flattening": false}, "_learner_connector": null, "add_default_connectors_to_learner_pipeline": true, "learner_config_dict": {}, "optimizer": {}, "_learner_class": null, "callbacks_on_algorithm_init": null, "callbacks_on_env_runners_recreated": null, "callbacks_on_offline_eval_runners_recreated": null, "callbacks_on_checkpoint_loaded": null, "callbacks_on_environment_created": null, "callbacks_on_episode_created": null, "callbacks_on_episode_start": null, "callbacks_on_episode_step": null, "callbacks_on_episode_end": null, "callbacks_on_evaluate_start": null, "callbacks_on_evaluate_end": null, "callbacks_on_evaluate_offline_start": null, "callbacks_on_evaluate_offline_end": null, "callbacks_on_sample_end": null, "callbacks_on_train_result": null, "explore": true, "enable_rl_module_and_learner": true, "enable_env_runner_and_connector_v2": true, "_prior_exploration_config": {"type": "StochasticSampling"}, "count_steps_by": "env_steps", "policy_map_capacity": 100, "policy_mapping_fn": "<function AlgorithmConfig.DEFAULT_POLICY_MAPPING_FN at 0x385eedb20>", "policies_to_train": null, "policy_states_are_swappable": false, "observation_fn": null, "offline_data_class": null, "input_read_method": "read_parquet", "input_read_method_kwargs": {}, "input_read_schema": {}, "input_read_episodes": false, "input_read_sample_batches": false, "input_read_batch_size": null, "input_filesystem": null, "input_filesystem_kwargs": {}, "input_compress_columns": ["obs", "new_obs"], "input_spaces_jsonable": true, "materialize_data": false, "materialize_mapped_data": true, "map_batches_kwargs": {}, "iter_batches_kwargs": {}, "ignore_final_observation": false, "prelearner_class": null, "prelearner_buffer_class": null, "prelearner_buffer_kwargs": {}, "prelearner_module_synch_period": 10, "dataset_num_iters_per_learner": null, "input_config": {}, "actions_in_input_normalized": false, "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_config": {}, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "output_max_rows_per_file": null, "output_write_remaining_data": false, "output_write_method": "write_parquet", "output_write_method_kwargs": {}, "output_filesystem": null, "output_filesystem_kwargs": {}, "output_write_episodes": true, "offline_sampling": false, "evaluation_interval": 1, "evaluation_duration": 20, "evaluation_duration_unit": "episodes", "evaluation_sample_timeout_s": 120.0, "evaluation_auto_duration_min_env_steps_per_sample": 100, "evaluation_auto_duration_max_env_steps_per_sample": 2000, "evaluation_parallel_to_training": false, "evaluation_force_reset_envs_before_iteration": true, "evaluation_config": null, "off_policy_estimation_methods": {}, "ope_split_batch_by_episode": true, "evaluation_num_env_runners": 1, "in_evaluation": false, "sync_filters_on_rollout_workers_timeout_s": 10.0, "offline_evaluation_interval": null, "num_offline_eval_runners": 0, "offline_loss_for_module_fn": null, "offline_evaluation_duration": 1, "offline_evaluation_parallel_to_training": false, "offline_evaluation_timeout_s": 120.0, "num_cpus_per_offline_eval_runner": 1, "num_gpus_per_offline_eval_runner": 0, "custom_resources_per_offline_eval_runner": {}, "restart_failed_offline_eval_runners": true, "ignore_offline_eval_runner_failures": false, "max_num_offline_eval_runner_restarts": 1000, "offline_eval_runner_restore_timeout_s": 1800.0, "max_requests_in_flight_per_offline_eval_runner": 1, "validate_offline_eval_runners_after_construction": true, "offline_eval_runner_health_probe_timeout_s": 30.0, "offline_eval_rl_module_inference_only": false, "broadcast_offline_eval_runner_states": false, "offline_eval_batch_size_per_runner": 256, "dataset_num_iters_per_eval_runner": 1, "keep_per_episode_custom_metrics": false, "metrics_episode_collection_timeout_s": 60.0, "metrics_num_episodes_for_smoothing": 100, "min_time_s_per_iteration": null, "min_train_timesteps_per_iteration": 0, "min_sample_timesteps_per_iteration": 0, "log_gradients": true, "export_native_model_files": false, "checkpoint_trainable_policies_only": false, "logger_creator": null, "logger_config": null, "log_level": "WARN", "log_sys_usage": true, "fake_sampler": false, "seed": 7, "restart_failed_env_runners": true, "ignore_env_runner_failures": false, "max_num_env_runner_restarts": 1000, "delay_between_env_runner_restarts_s": 60.0, "restart_failed_sub_environments": false, "num_consecutive_env_runner_failures_tolerance": 100, "env_runner_health_probe_timeout_s": 30.0, "env_runner_restore_timeout_s": 1800.0, "_model_config": {}, "_rl_module_spec": "RLModuleSpec(module_class=None, observation_space=None, action_space=None, inference_only=False, learner_only=False, model_config=DefaultModelConfig(fcnet_hiddens=[60, 90], fcnet_activation='tanh', fcnet_kernel_initializer=None, fcnet_kernel_initializer_kwargs=None, fcnet_bias_initializer=None, fcnet_bias_initializer_kwargs=None, conv_filters=None, conv_activation='relu', conv_kernel_initializer=None, conv_kernel_initializer_kwargs=None, conv_bias_initializer=None, conv_bias_initializer_kwargs=None, head_fcnet_hiddens=[], head_fcnet_activation='relu', head_fcnet_kernel_initializer=None, head_fcnet_kernel_initializer_kwargs=None, head_fcnet_bias_initializer=None, head_fcnet_bias_initializer_kwargs=None, free_log_std=False, log_std_clip_param=20.0, vf_share_layers=True, use_lstm=False, max_seq_len=20, lstm_cell_size=256, lstm_use_prev_action=False, lstm_use_prev_reward=False, lstm_kernel_initializer=None, lstm_kernel_initializer_kwargs=None, lstm_bias_initializer=None, lstm_bias_initializer_kwargs=None), catalog_class=None, load_state_path=None, model_config_dict=None)", "algorithm_config_overrides_per_module": {}, "_per_module_overrides": {}, "_validate_config": true, "_use_msgpack_checkpoints": false, "_torch_grad_scaler_class": null, "_torch_lr_scheduler_classes": null, "_tf_policy_handles_more_than_one_loss": false, "_disable_preprocessor_api": false, "_disable_action_flattening": false, "_disable_initialize_loss_from_dummy_batch": false, "_dont_auto_sync_env_runner_states": false, "env_task_fn": -1, "enable_connectors": -1, "simple_optimizer": false, "policy_map_cache": -1, "worker_cls": -1, "synchronize_filters": -1, "enable_async_evaluation": -1, "custom_async_evaluation_function": -1, "_enable_rl_module_api": -1, "auto_wrap_old_gym_envs": -1, "always_attach_evaluation_results": -1, "replay_sequence_length": null, "_disable_execution_plan_api": -1, "use_critic": true, "use_gae": true, "use_kl_loss": true, "kl_coeff": 0.7464963036515, "kl_target": 0.0270990929592, "vf_loss_coeff": 0.6688075857018, "entropy_coeff": 0.0090570820258, "clip_param": 0.1221781641624, "vf_clip_param": 0.1027808522125, "entropy_coeff_schedule": null, "lr_schedule": null, "sgd_minibatch_size": -1, "vf_share_layers": -1, "__stdout_file__": null, "__stderr_file__": null, "lambda": 0.9099046732075, "input": "sampler", "policies": {"default_policy": [null, null, null, null]}, "callbacks": "<class 'ray.rllib.callbacks.callbacks.RLlibCallback'>", "create_env_on_driver": false, "custom_eval_function": null, "framework": "torch"}, "time_since_restore": 13.315052270889282, "iterations_since_restore": 7, "perf": {"cpu_util_percent": 52.43333333333334, "ram_util_percent": 80.36666666666666}}
{"timers": {"training_iteration": 2.128334970078949, "restore_env_runners": 1.0301755329547488e-05, "training_step": 2.1279374733043475, "env_runner_sampling_timer": 1.8956341543183546, "learner_update_timer": 0.2208537947289286, "synch_weights": 0.00622525207864608, "restore_eval_env_runners": 9.627855488576814e-05, "evaluation_iteration": 0.1727932698150856, "synch_eval_env_connectors": 0.0003267304783472664, "synch_env_connectors": 6.49685095611126e-06}, "env_runners": {"num_agent_steps_sampled_lifetime": {"default_agent": -3695000.0}, "env_to_module_connector": {"timers": {"connectors": {"numpy_to_tensor": 8.996719299792333e-06, "batch_individual_items": 6.569890155526826e-06, "add_observations_from_episodes_to_batch": 3.204763270307836e-06, "add_time_dim_to_batch_and_zero_pad": 2.5310657603921548e-06, "add_states_from_episodes_to_batch": 1.7860885946393666e-06}}, "connector_pipeline_timer": 4.533434546994167e-05}, "module_to_env_connector": {"timers": {"connectors": {"get_actions": 4.0873811916470674e-05, "normalize_and_clip_actions": 9.803726050350927e-06, "listify_data_for_vector_env": 1.134065324864587e-05, "remove_single_ts_time_rank_from_batch": 5.921152412735722e-07, "tensor_to_numpy": 1.3793821081900086e-05, "un_batch_to_individual_items": 5.5367360239350394e-06}}, "connector_pipeline_timer": 0.00010839350911979038}, "time_between_sampling": 0.0016380704638832508, "agent_episode_returns_mean": {"default_agent": 5.14}, "sample": 0.005334525349672724, "env_to_module_sum_episodes_length_out": 10.36823839457432, "num_env_steps_sampled": 5000.0, "num_agent_steps_sampled": {"default_agent": 5000.0}, "module_episode_returns_mean": {"default_policy": 5.14}, "env_reset_timer": 3.927321071070003e-05, "episode_return_max": 10.5, "episode_len_min": 20, "episode_return_mean": 5.14, "num_episodes_lifetime": -184750.0, "env_to_module_sum_episodes_length_in": 10.36823839457432, "num_episodes": 250.0, "num_module_steps_sampled_lifetime": {"default_policy": -3695000.0}, "episode_return_min": -9.5, "episode_len_mean": 20.0, "episode_duration_sec_mean": 0.005105040980037301, "weights_seq_no": 7.0, "episode_len_max": 20, "num_env_steps_sampled_lifetime": -3695000.0, "env_step_timer": 1.4427655810513036e-05, "rlmodule_inference_timer": 4.5020270086626484e-05, "num_module_steps_sampled": {"default_policy": 5000.0}, "num_env_steps_sampled_lifetime_throughput": 3582.288561901002}, "learners": {"default_policy": {"diff_num_grad_updates_vs_sampler_policy": 1.0, "curr_entropy_coeff": 0.0090570820258, "policy_loss": -0.22797994315624237, "default_optimizer_learning_rate": 0.0002847858517, "num_trainable_parameters": 6003, "num_module_steps_trained_lifetime": 48000, "weights_seq_no": 8.0, "vf_loss_unclipped": 28.108274459838867, "num_module_steps_trained": 6000, "mean_kl_loss": 0.0007228472968563437, "curr_kl_coeff": 0.0029160012491047382, "entropy": 0.6174891591072083, "module_train_batch_size_mean": 1000.0, "gradients_default_optimizer_global_norm": 0.016537001356482506, "vf_loss": 0.10278083384037018, "vf_explained_var": -0.009645938873291016, "total_loss": -0.16482774913311005, "num_module_steps_trained_lifetime_throughput": 186955.92242002048}, "__all_modules__": {"num_trainable_parameters": 6003, "learner_connector_sum_episodes_length_in": 5000.0, "learner_connector": {"timers": {"connectors": {"batch_individual_items": 0.06486555237302476, "add_columns_from_episodes_to_train_batch": 0.04665447053138659, "add_one_ts_to_episodes_and_truncate": 0.014475220095244944, "add_observations_from_episodes_to_batch": 0.0008766633960928304, "add_states_from_episodes_to_batch": 8.434186793278886e-06, "general_advantage_estimation": 0.014161324148483161, "add_time_dim_to_batch_and_zero_pad": 5.831031231754635e-05, "numpy_to_tensor": 0.00014992467926136437}}, "connector_pipeline_timer": 0.14163256182461628}, "num_env_steps_trained_lifetime": 252000, "num_env_steps_trained": 31500, "num_non_trainable_parameters": 0, "num_module_steps_trained_lifetime": 48000, "num_module_steps_trained": 6000, "learner_connector_sum_episodes_length_out": 5250.0, "num_env_steps_trained_lifetime_throughput": 979709.502670891, "num_module_steps_trained_throughput": 186928.91428034529, "num_module_steps_trained_lifetime_throughput": 186814.68417087215}}, "num_training_step_calls_per_iteration": 1, "evaluation": {"env_runners": {"episode_len_mean": 20.0, "module_to_env_connector": {"connector_pipeline_timer": 0.00010303144698796674, "timers": {"connectors": {"remove_single_ts_time_rank_from_batch": 5.733298216751422e-07, "tensor_to_numpy": 1.3151021788007096e-05, "normalize_and_clip_actions": 9.626493201821172e-06, "listify_data_for_vector_env": 1.124125763968527e-05, "un_batch_to_individual_items": 5.5156493364888045e-06, "get_actions": 3.743476803150296e-05}}}, "num_env_steps_sampled_lifetime": 40400, "rlmodule_inference_timer": 2.781132144614897e-05, "env_to_module_connector": {"timers": {"connectors": {"add_time_dim_to_batch_and_zero_pad": 2.2433438881001537e-06, "numpy_to_tensor": 8.461289638191844e-06, "batch_individual_items": 6.244312225695742e-06, "add_states_from_episodes_to_batch": 1.6007229706764552e-06, "add_observations_from_episodes_to_batch": 2.858896288837391e-06}}, "connector_pipeline_timer": 4.285358797993153e-05}, "num_episodes_lifetime": 160, "weights_seq_no": 8.0, "episode_len_max": 20, "sample": 0.14504869165695272, "episode_return_max": 14.5, "env_reset_timer": 0.0006696104217857631, "agent_episode_returns_mean": {"default_agent": 0.85}, "module_episode_returns_mean": {"default_policy": 0.85}, "num_episodes": 20, "episode_return_min": -12.5, "episode_duration_sec_mean": 0.004505964111303911, "num_module_steps_sampled": {"default_policy": 400}, "num_env_steps_sampled": 400, "num_agent_steps_sampled_lifetime": {"default_agent": 3200}, "env_to_module_sum_episodes_length_in": 10.3682383945743, "num_agent_steps_sampled": {"default_agent": 400}, "env_step_timer": 1.4394514896613925e-05, "num_module_steps_sampled_lifetime": {"default_policy": 3200}, "env_to_module_sum_episodes_length_out": 10.3682383945743, "episode_len_min": 20, "episode_return_mean": 0.85, "time_between_sampling": 1.90210909273021}, "num_healthy_workers": 1, "actor_manager_num_outstanding_async_reqs": 0, "num_remote_worker_restarts": 0}, "num_env_steps_sampled_lifetime": -3695000.0, "fault_tolerance": {"num_healthy_workers": 0, "num_remote_worker_restarts": 0}, "env_runner_group": {"actor_manager_num_outstanding_async_reqs": 0}, "done": false, "training_iteration": 8, "trial_id": "4da12_00000", "date": "2025-08-11_19-21-48", "timestamp": 1754932908, "time_this_iter_s": 1.7446839809417725, "time_total_s": 15.059736251831055, "pid": 14324, "hostname": "Mac", "node_ip": "127.0.0.1", "config": {"exploration_config": {}, "extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "placement_strategy": "PACK", "num_gpus": 0, "_fake_gpus": false, "num_cpus_for_main_process": 2, "eager_tracing": true, "eager_max_retraces": 20, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "torch_compile_learner": false, "torch_compile_learner_what_to_compile": "forward_train", "torch_compile_learner_dynamo_backend": "aot_eager", "torch_compile_learner_dynamo_mode": null, "torch_compile_worker": false, "torch_compile_worker_dynamo_backend": "aot_eager", "torch_compile_worker_dynamo_mode": null, "torch_ddp_kwargs": {}, "torch_skip_nan_gradients": false, "env": "Umbrella", "env_config": {}, "observation_space": null, "action_space": null, "clip_rewards": null, "normalize_actions": true, "clip_actions": false, "_is_atari": null, "disable_env_checking": false, "render_env": false, "action_mask_key": "action_mask", "env_runner_cls": null, "num_env_runners": 0, "create_local_env_runner": true, "num_envs_per_env_runner": 1, "gym_env_vectorize_mode": "SYNC", "num_cpus_per_env_runner": 1, "num_gpus_per_env_runner": 0, "custom_resources_per_env_runner": {}, "validate_env_runners_after_construction": true, "episodes_to_numpy": true, "max_requests_in_flight_per_env_runner": 1, "sample_timeout_s": 60.0, "_env_to_module_connector": null, "add_default_connectors_to_env_to_module_pipeline": true, "_module_to_env_connector": null, "add_default_connectors_to_module_to_env_pipeline": true, "merge_env_runner_states": "training_only", "broadcast_env_runner_states": true, "episode_lookback_horizon": 1, "rollout_fragment_length": "auto", "batch_mode": "complete_episodes", "compress_observations": false, "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "enable_tf1_exec_eagerly": false, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "preprocessor_pref": "deepmind", "observation_filter": "NoFilter", "update_worker_filter_stats": true, "use_worker_filter_stats": true, "sampler_perf_stats_ema_coef": null, "_is_online": true, "num_learners": 0, "num_gpus_per_learner": 0, "num_cpus_per_learner": "auto", "num_aggregator_actors_per_learner": 0, "max_requests_in_flight_per_aggregator_actor": 3, "local_gpu_idx": 0, "max_requests_in_flight_per_learner": 3, "gamma": 1, "lr": 0.0002847858517, "grad_clip": 0.5, "grad_clip_by": "global_norm", "_train_batch_size_per_learner": 5000, "train_batch_size": 4000, "num_epochs": 1, "minibatch_size": 1000, "shuffle_batch_per_epoch": true, "model": {"fcnet_hiddens": [256, 256], "fcnet_activation": "tanh", "fcnet_weights_initializer": null, "fcnet_weights_initializer_config": null, "fcnet_bias_initializer": null, "fcnet_bias_initializer_config": null, "conv_filters": null, "conv_activation": "relu", "conv_kernel_initializer": null, "conv_kernel_initializer_config": null, "conv_bias_initializer": null, "conv_bias_initializer_config": null, "conv_transpose_kernel_initializer": null, "conv_transpose_kernel_initializer_config": null, "conv_transpose_bias_initializer": null, "conv_transpose_bias_initializer_config": null, "post_fcnet_hiddens": [], "post_fcnet_activation": "relu", "post_fcnet_weights_initializer": null, "post_fcnet_weights_initializer_config": null, "post_fcnet_bias_initializer": null, "post_fcnet_bias_initializer_config": null, "free_log_std": false, "log_std_clip_param": 20.0, "no_final_linear": false, "vf_share_layers": false, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "lstm_weights_initializer": null, "lstm_weights_initializer_config": null, "lstm_bias_initializer": null, "lstm_bias_initializer_config": null, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "attention_use_n_prev_actions": 0, "attention_use_n_prev_rewards": 0, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": null, "custom_model_config": {}, "custom_action_dist": null, "custom_preprocessor": null, "encoder_latent_dim": null, "always_check_shapes": false, "lstm_use_prev_action_reward": -1, "_use_default_native_models": -1, "_disable_preprocessor_api": false, "_disable_action_flattening": false}, "_learner_connector": null, "add_default_connectors_to_learner_pipeline": true, "learner_config_dict": {}, "optimizer": {}, "_learner_class": null, "callbacks_on_algorithm_init": null, "callbacks_on_env_runners_recreated": null, "callbacks_on_offline_eval_runners_recreated": null, "callbacks_on_checkpoint_loaded": null, "callbacks_on_environment_created": null, "callbacks_on_episode_created": null, "callbacks_on_episode_start": null, "callbacks_on_episode_step": null, "callbacks_on_episode_end": null, "callbacks_on_evaluate_start": null, "callbacks_on_evaluate_end": null, "callbacks_on_evaluate_offline_start": null, "callbacks_on_evaluate_offline_end": null, "callbacks_on_sample_end": null, "callbacks_on_train_result": null, "explore": true, "enable_rl_module_and_learner": true, "enable_env_runner_and_connector_v2": true, "_prior_exploration_config": {"type": "StochasticSampling"}, "count_steps_by": "env_steps", "policy_map_capacity": 100, "policy_mapping_fn": "<function AlgorithmConfig.DEFAULT_POLICY_MAPPING_FN at 0x385eedb20>", "policies_to_train": null, "policy_states_are_swappable": false, "observation_fn": null, "offline_data_class": null, "input_read_method": "read_parquet", "input_read_method_kwargs": {}, "input_read_schema": {}, "input_read_episodes": false, "input_read_sample_batches": false, "input_read_batch_size": null, "input_filesystem": null, "input_filesystem_kwargs": {}, "input_compress_columns": ["obs", "new_obs"], "input_spaces_jsonable": true, "materialize_data": false, "materialize_mapped_data": true, "map_batches_kwargs": {}, "iter_batches_kwargs": {}, "ignore_final_observation": false, "prelearner_class": null, "prelearner_buffer_class": null, "prelearner_buffer_kwargs": {}, "prelearner_module_synch_period": 10, "dataset_num_iters_per_learner": null, "input_config": {}, "actions_in_input_normalized": false, "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_config": {}, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "output_max_rows_per_file": null, "output_write_remaining_data": false, "output_write_method": "write_parquet", "output_write_method_kwargs": {}, "output_filesystem": null, "output_filesystem_kwargs": {}, "output_write_episodes": true, "offline_sampling": false, "evaluation_interval": 1, "evaluation_duration": 20, "evaluation_duration_unit": "episodes", "evaluation_sample_timeout_s": 120.0, "evaluation_auto_duration_min_env_steps_per_sample": 100, "evaluation_auto_duration_max_env_steps_per_sample": 2000, "evaluation_parallel_to_training": false, "evaluation_force_reset_envs_before_iteration": true, "evaluation_config": null, "off_policy_estimation_methods": {}, "ope_split_batch_by_episode": true, "evaluation_num_env_runners": 1, "in_evaluation": false, "sync_filters_on_rollout_workers_timeout_s": 10.0, "offline_evaluation_interval": null, "num_offline_eval_runners": 0, "offline_loss_for_module_fn": null, "offline_evaluation_duration": 1, "offline_evaluation_parallel_to_training": false, "offline_evaluation_timeout_s": 120.0, "num_cpus_per_offline_eval_runner": 1, "num_gpus_per_offline_eval_runner": 0, "custom_resources_per_offline_eval_runner": {}, "restart_failed_offline_eval_runners": true, "ignore_offline_eval_runner_failures": false, "max_num_offline_eval_runner_restarts": 1000, "offline_eval_runner_restore_timeout_s": 1800.0, "max_requests_in_flight_per_offline_eval_runner": 1, "validate_offline_eval_runners_after_construction": true, "offline_eval_runner_health_probe_timeout_s": 30.0, "offline_eval_rl_module_inference_only": false, "broadcast_offline_eval_runner_states": false, "offline_eval_batch_size_per_runner": 256, "dataset_num_iters_per_eval_runner": 1, "keep_per_episode_custom_metrics": false, "metrics_episode_collection_timeout_s": 60.0, "metrics_num_episodes_for_smoothing": 100, "min_time_s_per_iteration": null, "min_train_timesteps_per_iteration": 0, "min_sample_timesteps_per_iteration": 0, "log_gradients": true, "export_native_model_files": false, "checkpoint_trainable_policies_only": false, "logger_creator": null, "logger_config": null, "log_level": "WARN", "log_sys_usage": true, "fake_sampler": false, "seed": 7, "restart_failed_env_runners": true, "ignore_env_runner_failures": false, "max_num_env_runner_restarts": 1000, "delay_between_env_runner_restarts_s": 60.0, "restart_failed_sub_environments": false, "num_consecutive_env_runner_failures_tolerance": 100, "env_runner_health_probe_timeout_s": 30.0, "env_runner_restore_timeout_s": 1800.0, "_model_config": {}, "_rl_module_spec": "RLModuleSpec(module_class=None, observation_space=None, action_space=None, inference_only=False, learner_only=False, model_config=DefaultModelConfig(fcnet_hiddens=[60, 90], fcnet_activation='tanh', fcnet_kernel_initializer=None, fcnet_kernel_initializer_kwargs=None, fcnet_bias_initializer=None, fcnet_bias_initializer_kwargs=None, conv_filters=None, conv_activation='relu', conv_kernel_initializer=None, conv_kernel_initializer_kwargs=None, conv_bias_initializer=None, conv_bias_initializer_kwargs=None, head_fcnet_hiddens=[], head_fcnet_activation='relu', head_fcnet_kernel_initializer=None, head_fcnet_kernel_initializer_kwargs=None, head_fcnet_bias_initializer=None, head_fcnet_bias_initializer_kwargs=None, free_log_std=False, log_std_clip_param=20.0, vf_share_layers=True, use_lstm=False, max_seq_len=20, lstm_cell_size=256, lstm_use_prev_action=False, lstm_use_prev_reward=False, lstm_kernel_initializer=None, lstm_kernel_initializer_kwargs=None, lstm_bias_initializer=None, lstm_bias_initializer_kwargs=None), catalog_class=None, load_state_path=None, model_config_dict=None)", "algorithm_config_overrides_per_module": {}, "_per_module_overrides": {}, "_validate_config": true, "_use_msgpack_checkpoints": false, "_torch_grad_scaler_class": null, "_torch_lr_scheduler_classes": null, "_tf_policy_handles_more_than_one_loss": false, "_disable_preprocessor_api": false, "_disable_action_flattening": false, "_disable_initialize_loss_from_dummy_batch": false, "_dont_auto_sync_env_runner_states": false, "env_task_fn": -1, "enable_connectors": -1, "simple_optimizer": false, "policy_map_cache": -1, "worker_cls": -1, "synchronize_filters": -1, "enable_async_evaluation": -1, "custom_async_evaluation_function": -1, "_enable_rl_module_api": -1, "auto_wrap_old_gym_envs": -1, "always_attach_evaluation_results": -1, "replay_sequence_length": null, "_disable_execution_plan_api": -1, "use_critic": true, "use_gae": true, "use_kl_loss": true, "kl_coeff": 0.7464963036515, "kl_target": 0.0270990929592, "vf_loss_coeff": 0.6688075857018, "entropy_coeff": 0.0090570820258, "clip_param": 0.1221781641624, "vf_clip_param": 0.1027808522125, "entropy_coeff_schedule": null, "lr_schedule": null, "sgd_minibatch_size": -1, "vf_share_layers": -1, "__stdout_file__": null, "__stderr_file__": null, "lambda": 0.9099046732075, "input": "sampler", "policies": {"default_policy": [null, null, null, null]}, "callbacks": "<class 'ray.rllib.callbacks.callbacks.RLlibCallback'>", "create_env_on_driver": false, "custom_eval_function": null, "framework": "torch"}, "time_since_restore": 15.059736251831055, "iterations_since_restore": 8, "perf": {"cpu_util_percent": 22.85, "ram_util_percent": 79.5}}
{"timers": {"training_iteration": 2.123363430788275, "restore_env_runners": 1.0257897714498023e-05, "training_step": 2.1229680844005885, "env_runner_sampling_timer": 1.89105286610503, "learner_update_timer": 0.22054888095186628, "synch_weights": 0.006168742478189414, "restore_eval_env_runners": 9.538951960744104e-05, "evaluation_iteration": 0.1721269687862251, "synch_eval_env_connectors": 0.000324644004441068, "synch_env_connectors": 6.473541669465916e-06}, "env_runners": {"num_agent_steps_sampled_lifetime": {"default_agent": -4312500.0}, "env_to_module_connector": {"timers": {"connectors": {"numpy_to_tensor": 8.867053815023098e-06, "batch_individual_items": 6.5090586760523124e-06, "add_observations_from_episodes_to_batch": 3.1159620332753125e-06, "add_time_dim_to_batch_and_zero_pad": 2.5185722459086346e-06, "add_states_from_episodes_to_batch": 1.7728017406929288e-06}}, "connector_pipeline_timer": 4.516254885934634e-05}, "module_to_env_connector": {"timers": {"connectors": {"get_actions": 4.0706809827980675e-05, "normalize_and_clip_actions": 9.753758014697184e-06, "listify_data_for_vector_env": 1.1271942273414125e-05, "remove_single_ts_time_rank_from_batch": 5.919728622114252e-07, "tensor_to_numpy": 1.3636325486529547e-05, "un_batch_to_individual_items": 5.514964767117718e-06}}, "connector_pipeline_timer": 0.00010783553803671986}, "time_between_sampling": 0.00157493647934789, "agent_episode_returns_mean": {"default_agent": 5.460000000000001}, "sample": 0.005174043347322056, "env_to_module_sum_episodes_length_out": 10.36823839457432, "num_env_steps_sampled": 5000.0, "num_agent_steps_sampled": {"default_agent": 5000.0}, "module_episode_returns_mean": {"default_policy": 5.460000000000001}, "env_reset_timer": 4.173054985773835e-05, "episode_return_max": 10.5, "episode_len_min": 20, "episode_return_mean": 5.460000000000001, "num_episodes_lifetime": -215625.0, "env_to_module_sum_episodes_length_in": 10.36823839457432, "num_episodes": 250.0, "num_module_steps_sampled_lifetime": {"default_policy": -4312500.0}, "episode_return_min": -9.5, "episode_len_mean": 20.0, "episode_duration_sec_mean": 0.004731680687051266, "weights_seq_no": 8.0, "episode_len_max": 20, "num_env_steps_sampled_lifetime": -4312500.0, "env_step_timer": 1.4249082604484717e-05, "rlmodule_inference_timer": 2.8981580756794224e-05, "num_module_steps_sampled": {"default_policy": 5000.0}, "num_env_steps_sampled_lifetime_throughput": 3590.6498684005883}, "learners": {"default_policy": {"diff_num_grad_updates_vs_sampler_policy": 1.0, "curr_entropy_coeff": 0.0090570820258, "policy_loss": -0.18210962414741516, "default_optimizer_learning_rate": 0.0002847858517, "num_trainable_parameters": 6003, "num_module_steps_trained_lifetime": 54000, "weights_seq_no": 9.0, "vf_loss_unclipped": 28.079132080078125, "num_module_steps_trained": 6000, "mean_kl_loss": 0.00022714240185450763, "curr_kl_coeff": 0.0014580006245523691, "entropy": 0.6061604619026184, "module_train_batch_size_mean": 1000.0, "gradients_default_optimizer_global_norm": 0.059866879135370255, "vf_loss": 0.10278083384037018, "vf_explained_var": -0.009606122970581055, "total_loss": -0.11885840445756912, "num_module_steps_trained_lifetime_throughput": 194291.33353361057}, "__all_modules__": {"num_trainable_parameters": 6003, "learner_connector_sum_episodes_length_in": 5000.0, "learner_connector": {"timers": {"connectors": {"batch_individual_items": 0.0645482001798985, "add_columns_from_episodes_to_train_batch": 0.046528469576280596, "add_one_ts_to_episodes_and_truncate": 0.015325446223692096, "add_observations_from_episodes_to_batch": 0.0008772159320443892, "add_states_from_episodes_to_batch": 8.384015150608739e-06, "general_advantage_estimation": 0.014074210496603587, "add_time_dim_to_batch_and_zero_pad": 5.784179912395158e-05, "numpy_to_tensor": 0.00014907626163864995}}, "connector_pipeline_timer": 0.14194886287664313}, "num_env_steps_trained_lifetime": 283500, "num_env_steps_trained": 31500, "num_non_trainable_parameters": 0, "num_module_steps_trained_lifetime": 54000, "num_module_steps_trained": 6000, "learner_connector_sum_episodes_length_out": 5250.0, "num_env_steps_trained_lifetime_throughput": 1018301.9874398785, "num_module_steps_trained_throughput": 194285.79703995265, "num_module_steps_trained_lifetime_throughput": 194166.55002956756}}, "num_training_step_calls_per_iteration": 1, "evaluation": {"env_runners": {"episode_len_mean": 20.0, "module_to_env_connector": {"connector_pipeline_timer": 0.00010503928373590702, "timers": {"connectors": {"remove_single_ts_time_rank_from_batch": 5.737044300402985e-07, "tensor_to_numpy": 1.3504266935853297e-05, "normalize_and_clip_actions": 9.78764685020618e-06, "listify_data_for_vector_env": 1.1374201952930092e-05, "un_batch_to_individual_items": 5.553678780178936e-06, "get_actions": 3.844182955868647e-05}}}, "num_env_steps_sampled_lifetime": 45400, "rlmodule_inference_timer": 2.8687497950140717e-05, "env_to_module_connector": {"timers": {"connectors": {"add_time_dim_to_batch_and_zero_pad": 2.283487868018109e-06, "numpy_to_tensor": 8.645202895935936e-06, "batch_individual_items": 6.292807053743848e-06, "add_states_from_episodes_to_batch": 1.612150175574837e-06, "add_observations_from_episodes_to_batch": 2.9002228973822572e-06}}, "connector_pipeline_timer": 4.3255809457519884e-05}, "num_episodes_lifetime": 180, "weights_seq_no": 9.0, "episode_len_max": 20, "sample": 0.1446092364004017, "episode_return_max": 14.5, "env_reset_timer": 0.0006637397278110292, "agent_episode_returns_mean": {"default_agent": 0.65}, "module_episode_returns_mean": {"default_policy": 0.65}, "num_episodes": 20, "episode_return_min": -12.5, "episode_duration_sec_mean": 0.004537553292466328, "num_module_steps_sampled": {"default_policy": 400}, "num_env_steps_sampled": 400, "num_agent_steps_sampled_lifetime": {"default_agent": 3600}, "env_to_module_sum_episodes_length_in": 10.368238394574323, "num_agent_steps_sampled": {"default_agent": 400}, "env_step_timer": 1.4697676670911408e-05, "num_module_steps_sampled_lifetime": {"default_policy": 3600}, "env_to_module_sum_episodes_length_out": 10.368238394574323, "episode_len_min": 20, "episode_return_mean": 0.65, "time_between_sampling": 1.8995797234723528}, "num_healthy_workers": 1, "actor_manager_num_outstanding_async_reqs": 0, "num_remote_worker_restarts": 0}, "num_env_steps_sampled_lifetime": -4312500.0, "fault_tolerance": {"num_healthy_workers": 0, "num_remote_worker_restarts": 0}, "env_runner_group": {"actor_manager_num_outstanding_async_reqs": 0}, "done": false, "training_iteration": 9, "trial_id": "4da12_00000", "date": "2025-08-11_19-21-50", "timestamp": 1754932910, "time_this_iter_s": 1.7403581142425537, "time_total_s": 16.80009436607361, "pid": 14324, "hostname": "Mac", "node_ip": "127.0.0.1", "config": {"exploration_config": {}, "extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "placement_strategy": "PACK", "num_gpus": 0, "_fake_gpus": false, "num_cpus_for_main_process": 2, "eager_tracing": true, "eager_max_retraces": 20, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "torch_compile_learner": false, "torch_compile_learner_what_to_compile": "forward_train", "torch_compile_learner_dynamo_backend": "aot_eager", "torch_compile_learner_dynamo_mode": null, "torch_compile_worker": false, "torch_compile_worker_dynamo_backend": "aot_eager", "torch_compile_worker_dynamo_mode": null, "torch_ddp_kwargs": {}, "torch_skip_nan_gradients": false, "env": "Umbrella", "env_config": {}, "observation_space": null, "action_space": null, "clip_rewards": null, "normalize_actions": true, "clip_actions": false, "_is_atari": null, "disable_env_checking": false, "render_env": false, "action_mask_key": "action_mask", "env_runner_cls": null, "num_env_runners": 0, "create_local_env_runner": true, "num_envs_per_env_runner": 1, "gym_env_vectorize_mode": "SYNC", "num_cpus_per_env_runner": 1, "num_gpus_per_env_runner": 0, "custom_resources_per_env_runner": {}, "validate_env_runners_after_construction": true, "episodes_to_numpy": true, "max_requests_in_flight_per_env_runner": 1, "sample_timeout_s": 60.0, "_env_to_module_connector": null, "add_default_connectors_to_env_to_module_pipeline": true, "_module_to_env_connector": null, "add_default_connectors_to_module_to_env_pipeline": true, "merge_env_runner_states": "training_only", "broadcast_env_runner_states": true, "episode_lookback_horizon": 1, "rollout_fragment_length": "auto", "batch_mode": "complete_episodes", "compress_observations": false, "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "enable_tf1_exec_eagerly": false, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "preprocessor_pref": "deepmind", "observation_filter": "NoFilter", "update_worker_filter_stats": true, "use_worker_filter_stats": true, "sampler_perf_stats_ema_coef": null, "_is_online": true, "num_learners": 0, "num_gpus_per_learner": 0, "num_cpus_per_learner": "auto", "num_aggregator_actors_per_learner": 0, "max_requests_in_flight_per_aggregator_actor": 3, "local_gpu_idx": 0, "max_requests_in_flight_per_learner": 3, "gamma": 1, "lr": 0.0002847858517, "grad_clip": 0.5, "grad_clip_by": "global_norm", "_train_batch_size_per_learner": 5000, "train_batch_size": 4000, "num_epochs": 1, "minibatch_size": 1000, "shuffle_batch_per_epoch": true, "model": {"fcnet_hiddens": [256, 256], "fcnet_activation": "tanh", "fcnet_weights_initializer": null, "fcnet_weights_initializer_config": null, "fcnet_bias_initializer": null, "fcnet_bias_initializer_config": null, "conv_filters": null, "conv_activation": "relu", "conv_kernel_initializer": null, "conv_kernel_initializer_config": null, "conv_bias_initializer": null, "conv_bias_initializer_config": null, "conv_transpose_kernel_initializer": null, "conv_transpose_kernel_initializer_config": null, "conv_transpose_bias_initializer": null, "conv_transpose_bias_initializer_config": null, "post_fcnet_hiddens": [], "post_fcnet_activation": "relu", "post_fcnet_weights_initializer": null, "post_fcnet_weights_initializer_config": null, "post_fcnet_bias_initializer": null, "post_fcnet_bias_initializer_config": null, "free_log_std": false, "log_std_clip_param": 20.0, "no_final_linear": false, "vf_share_layers": false, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "lstm_weights_initializer": null, "lstm_weights_initializer_config": null, "lstm_bias_initializer": null, "lstm_bias_initializer_config": null, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "attention_use_n_prev_actions": 0, "attention_use_n_prev_rewards": 0, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": null, "custom_model_config": {}, "custom_action_dist": null, "custom_preprocessor": null, "encoder_latent_dim": null, "always_check_shapes": false, "lstm_use_prev_action_reward": -1, "_use_default_native_models": -1, "_disable_preprocessor_api": false, "_disable_action_flattening": false}, "_learner_connector": null, "add_default_connectors_to_learner_pipeline": true, "learner_config_dict": {}, "optimizer": {}, "_learner_class": null, "callbacks_on_algorithm_init": null, "callbacks_on_env_runners_recreated": null, "callbacks_on_offline_eval_runners_recreated": null, "callbacks_on_checkpoint_loaded": null, "callbacks_on_environment_created": null, "callbacks_on_episode_created": null, "callbacks_on_episode_start": null, "callbacks_on_episode_step": null, "callbacks_on_episode_end": null, "callbacks_on_evaluate_start": null, "callbacks_on_evaluate_end": null, "callbacks_on_evaluate_offline_start": null, "callbacks_on_evaluate_offline_end": null, "callbacks_on_sample_end": null, "callbacks_on_train_result": null, "explore": true, "enable_rl_module_and_learner": true, "enable_env_runner_and_connector_v2": true, "_prior_exploration_config": {"type": "StochasticSampling"}, "count_steps_by": "env_steps", "policy_map_capacity": 100, "policy_mapping_fn": "<function AlgorithmConfig.DEFAULT_POLICY_MAPPING_FN at 0x385eedb20>", "policies_to_train": null, "policy_states_are_swappable": false, "observation_fn": null, "offline_data_class": null, "input_read_method": "read_parquet", "input_read_method_kwargs": {}, "input_read_schema": {}, "input_read_episodes": false, "input_read_sample_batches": false, "input_read_batch_size": null, "input_filesystem": null, "input_filesystem_kwargs": {}, "input_compress_columns": ["obs", "new_obs"], "input_spaces_jsonable": true, "materialize_data": false, "materialize_mapped_data": true, "map_batches_kwargs": {}, "iter_batches_kwargs": {}, "ignore_final_observation": false, "prelearner_class": null, "prelearner_buffer_class": null, "prelearner_buffer_kwargs": {}, "prelearner_module_synch_period": 10, "dataset_num_iters_per_learner": null, "input_config": {}, "actions_in_input_normalized": false, "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_config": {}, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "output_max_rows_per_file": null, "output_write_remaining_data": false, "output_write_method": "write_parquet", "output_write_method_kwargs": {}, "output_filesystem": null, "output_filesystem_kwargs": {}, "output_write_episodes": true, "offline_sampling": false, "evaluation_interval": 1, "evaluation_duration": 20, "evaluation_duration_unit": "episodes", "evaluation_sample_timeout_s": 120.0, "evaluation_auto_duration_min_env_steps_per_sample": 100, "evaluation_auto_duration_max_env_steps_per_sample": 2000, "evaluation_parallel_to_training": false, "evaluation_force_reset_envs_before_iteration": true, "evaluation_config": null, "off_policy_estimation_methods": {}, "ope_split_batch_by_episode": true, "evaluation_num_env_runners": 1, "in_evaluation": false, "sync_filters_on_rollout_workers_timeout_s": 10.0, "offline_evaluation_interval": null, "num_offline_eval_runners": 0, "offline_loss_for_module_fn": null, "offline_evaluation_duration": 1, "offline_evaluation_parallel_to_training": false, "offline_evaluation_timeout_s": 120.0, "num_cpus_per_offline_eval_runner": 1, "num_gpus_per_offline_eval_runner": 0, "custom_resources_per_offline_eval_runner": {}, "restart_failed_offline_eval_runners": true, "ignore_offline_eval_runner_failures": false, "max_num_offline_eval_runner_restarts": 1000, "offline_eval_runner_restore_timeout_s": 1800.0, "max_requests_in_flight_per_offline_eval_runner": 1, "validate_offline_eval_runners_after_construction": true, "offline_eval_runner_health_probe_timeout_s": 30.0, "offline_eval_rl_module_inference_only": false, "broadcast_offline_eval_runner_states": false, "offline_eval_batch_size_per_runner": 256, "dataset_num_iters_per_eval_runner": 1, "keep_per_episode_custom_metrics": false, "metrics_episode_collection_timeout_s": 60.0, "metrics_num_episodes_for_smoothing": 100, "min_time_s_per_iteration": null, "min_train_timesteps_per_iteration": 0, "min_sample_timesteps_per_iteration": 0, "log_gradients": true, "export_native_model_files": false, "checkpoint_trainable_policies_only": false, "logger_creator": null, "logger_config": null, "log_level": "WARN", "log_sys_usage": true, "fake_sampler": false, "seed": 7, "restart_failed_env_runners": true, "ignore_env_runner_failures": false, "max_num_env_runner_restarts": 1000, "delay_between_env_runner_restarts_s": 60.0, "restart_failed_sub_environments": false, "num_consecutive_env_runner_failures_tolerance": 100, "env_runner_health_probe_timeout_s": 30.0, "env_runner_restore_timeout_s": 1800.0, "_model_config": {}, "_rl_module_spec": "RLModuleSpec(module_class=None, observation_space=None, action_space=None, inference_only=False, learner_only=False, model_config=DefaultModelConfig(fcnet_hiddens=[60, 90], fcnet_activation='tanh', fcnet_kernel_initializer=None, fcnet_kernel_initializer_kwargs=None, fcnet_bias_initializer=None, fcnet_bias_initializer_kwargs=None, conv_filters=None, conv_activation='relu', conv_kernel_initializer=None, conv_kernel_initializer_kwargs=None, conv_bias_initializer=None, conv_bias_initializer_kwargs=None, head_fcnet_hiddens=[], head_fcnet_activation='relu', head_fcnet_kernel_initializer=None, head_fcnet_kernel_initializer_kwargs=None, head_fcnet_bias_initializer=None, head_fcnet_bias_initializer_kwargs=None, free_log_std=False, log_std_clip_param=20.0, vf_share_layers=True, use_lstm=False, max_seq_len=20, lstm_cell_size=256, lstm_use_prev_action=False, lstm_use_prev_reward=False, lstm_kernel_initializer=None, lstm_kernel_initializer_kwargs=None, lstm_bias_initializer=None, lstm_bias_initializer_kwargs=None), catalog_class=None, load_state_path=None, model_config_dict=None)", "algorithm_config_overrides_per_module": {}, "_per_module_overrides": {}, "_validate_config": true, "_use_msgpack_checkpoints": false, "_torch_grad_scaler_class": null, "_torch_lr_scheduler_classes": null, "_tf_policy_handles_more_than_one_loss": false, "_disable_preprocessor_api": false, "_disable_action_flattening": false, "_disable_initialize_loss_from_dummy_batch": false, "_dont_auto_sync_env_runner_states": false, "env_task_fn": -1, "enable_connectors": -1, "simple_optimizer": false, "policy_map_cache": -1, "worker_cls": -1, "synchronize_filters": -1, "enable_async_evaluation": -1, "custom_async_evaluation_function": -1, "_enable_rl_module_api": -1, "auto_wrap_old_gym_envs": -1, "always_attach_evaluation_results": -1, "replay_sequence_length": null, "_disable_execution_plan_api": -1, "use_critic": true, "use_gae": true, "use_kl_loss": true, "kl_coeff": 0.7464963036515, "kl_target": 0.0270990929592, "vf_loss_coeff": 0.6688075857018, "entropy_coeff": 0.0090570820258, "clip_param": 0.1221781641624, "vf_clip_param": 0.1027808522125, "entropy_coeff_schedule": null, "lr_schedule": null, "sgd_minibatch_size": -1, "vf_share_layers": -1, "__stdout_file__": null, "__stderr_file__": null, "lambda": 0.9099046732075, "input": "sampler", "policies": {"default_policy": [null, null, null, null]}, "callbacks": "<class 'ray.rllib.callbacks.callbacks.RLlibCallback'>", "create_env_on_driver": false, "custom_eval_function": null, "framework": "torch"}, "time_since_restore": 16.80009436607361, "iterations_since_restore": 9, "perf": {"cpu_util_percent": 49.63333333333333, "ram_util_percent": 79.2}}
{"timers": {"training_iteration": 2.1182171614806684, "restore_env_runners": 1.02115694567066e-05, "training_step": 2.117823830226616, "env_runner_sampling_timer": 1.8862339795343321, "learner_update_timer": 0.22030497673295588, "synch_weights": 0.006112884222356796, "restore_eval_env_runners": 9.450187404271189e-05, "evaluation_iteration": 0.1714755224377115, "synch_eval_env_connectors": 0.000322370474016689, "synch_env_connectors": 6.451715776243446e-06}, "env_runners": {"num_agent_steps_sampled_lifetime": {"default_agent": -4930000.0}, "env_to_module_connector": {"timers": {"connectors": {"numpy_to_tensor": 8.722508879441256e-06, "batch_individual_items": 6.386664758398232e-06, "add_observations_from_episodes_to_batch": 3.0900789492475874e-06, "add_time_dim_to_batch_and_zero_pad": 2.484477113397241e-06, "add_states_from_episodes_to_batch": 1.7722131846999261e-06}}, "connector_pipeline_timer": 4.446971492016439e-05}, "module_to_env_connector": {"timers": {"connectors": {"get_actions": 3.945574136568821e-05, "normalize_and_clip_actions": 9.562993076186216e-06, "listify_data_for_vector_env": 1.1059335856921122e-05, "remove_single_ts_time_rank_from_batch": 5.869669243880643e-07, "tensor_to_numpy": 1.3390886922662025e-05, "un_batch_to_individual_items": 5.423910007964303e-06}}, "connector_pipeline_timer": 0.00010546375596128721}, "time_between_sampling": 0.0018814618563925988, "agent_episode_returns_mean": {"default_agent": 6.179999999999998}, "sample": 0.004960783495223602, "env_to_module_sum_episodes_length_out": 10.36823839457432, "num_env_steps_sampled": 5000.0, "num_agent_steps_sampled": {"default_agent": 5000.0}, "module_episode_returns_mean": {"default_policy": 6.179999999999998}, "env_reset_timer": 3.5829348335751925e-05, "episode_return_max": 10.5, "episode_len_min": 20, "episode_return_mean": 6.179999999999998, "num_episodes_lifetime": -246500.0, "env_to_module_sum_episodes_length_in": 10.36823839457432, "num_episodes": 250.0, "num_module_steps_sampled_lifetime": {"default_policy": -4930000.0}, "episode_return_min": -9.5, "episode_len_mean": 20.0, "episode_duration_sec_mean": 0.004625611325260251, "weights_seq_no": 9.0, "episode_len_max": 20, "num_env_steps_sampled_lifetime": -4930000.0, "env_step_timer": 1.3926717848523944e-05, "rlmodule_inference_timer": 2.7932893073519684e-05, "num_module_steps_sampled": {"default_policy": 5000.0}, "num_env_steps_sampled_lifetime_throughput": 3688.354340291812}, "learners": {"default_policy": {"diff_num_grad_updates_vs_sampler_policy": 1.0, "curr_entropy_coeff": 0.0090570820258, "policy_loss": -0.20406639575958252, "default_optimizer_learning_rate": 0.0002847858517, "num_trainable_parameters": 6003, "num_module_steps_trained_lifetime": 60000, "weights_seq_no": 10.0, "vf_loss_unclipped": 27.982223510742188, "num_module_steps_trained": 6000, "mean_kl_loss": 0.00011014497431460768, "curr_kl_coeff": 0.0007290003122761846, "entropy": 0.5978839993476868, "module_train_batch_size_mean": 1000.0, "gradients_default_optimizer_global_norm": 0.0812729150056839, "vf_loss": 0.10278083384037018, "vf_explained_var": -0.009058833122253418, "total_loss": -0.14074070751667023, "num_module_steps_trained_lifetime_throughput": 202123.97095533536}, "__all_modules__": {"num_trainable_parameters": 6003, "learner_connector_sum_episodes_length_in": 5000.0, "learner_connector": {"timers": {"connectors": {"batch_individual_items": 0.06517866442805206, "add_columns_from_episodes_to_train_batch": 0.046435444461280846, "add_one_ts_to_episodes_and_truncate": 0.015262357181424883, "add_observations_from_episodes_to_batch": 0.0008769329433013224, "add_states_from_episodes_to_batch": 8.338094961881337e-06, "general_advantage_estimation": 0.013996708391218677, "add_time_dim_to_batch_and_zero_pad": 5.7390880357330144e-05, "numpy_to_tensor": 0.0001482979992089005}}, "connector_pipeline_timer": 0.14234157507703057}, "num_env_steps_trained_lifetime": 315000, "num_env_steps_trained": 31500, "num_non_trainable_parameters": 0, "num_module_steps_trained_lifetime": 60000, "num_module_steps_trained": 6000, "learner_connector_sum_episodes_length_out": 5250.0, "num_env_steps_trained_lifetime_throughput": 1059532.0094618874, "num_module_steps_trained_throughput": 202142.29555251467, "num_module_steps_trained_lifetime_throughput": 202018.99010350992}}, "num_training_step_calls_per_iteration": 1, "evaluation": {"env_runners": {"episode_len_mean": 20.0, "module_to_env_connector": {"connector_pipeline_timer": 0.00010084783613676297, "timers": {"connectors": {"remove_single_ts_time_rank_from_batch": 5.763055737779354e-07, "tensor_to_numpy": 1.2802941500381184e-05, "normalize_and_clip_actions": 9.575065994199755e-06, "listify_data_for_vector_env": 1.1074936111952924e-05, "un_batch_to_individual_items": 5.454765721983875e-06, "get_actions": 3.56568406892367e-05}}}, "num_env_steps_sampled_lifetime": 50400, "rlmodule_inference_timer": 2.6813450790363065e-05, "env_to_module_connector": {"timers": {"connectors": {"add_time_dim_to_batch_and_zero_pad": 2.2094669336678948e-06, "numpy_to_tensor": 8.406917672595535e-06, "batch_individual_items": 6.188432288585835e-06, "add_states_from_episodes_to_batch": 1.5873723058520553e-06, "add_observations_from_episodes_to_batch": 2.8525787175220846e-06}}, "connector_pipeline_timer": 4.290427825196262e-05}, "num_episodes_lifetime": 200, "weights_seq_no": 10.0, "episode_len_max": 20, "sample": 0.14414783778573978, "episode_return_max": 14.5, "env_reset_timer": 0.000657808580380927, "agent_episode_returns_mean": {"default_agent": -0.35}, "module_episode_returns_mean": {"default_policy": -0.35}, "num_episodes": 20, "episode_return_min": -12.5, "episode_duration_sec_mean": 0.004544175824848935, "num_module_steps_sampled": {"default_policy": 400}, "num_env_steps_sampled": 400, "num_agent_steps_sampled_lifetime": {"default_agent": 4000}, "env_to_module_sum_episodes_length_in": 10.368238394574323, "num_agent_steps_sampled": {"default_agent": 400}, "env_step_timer": 1.4039400925807208e-05, "num_module_steps_sampled_lifetime": {"default_policy": 4000}, "env_to_module_sum_episodes_length_out": 10.368238394574323, "episode_len_min": 20, "episode_return_mean": -0.35, "time_between_sampling": 1.8968653991571383}, "num_healthy_workers": 1, "actor_manager_num_outstanding_async_reqs": 0, "num_remote_worker_restarts": 0}, "num_env_steps_sampled_lifetime": -4930000.0, "fault_tolerance": {"num_healthy_workers": 0, "num_remote_worker_restarts": 0}, "env_runner_group": {"actor_manager_num_outstanding_async_reqs": 0}, "done": false, "training_iteration": 10, "trial_id": "4da12_00000", "date": "2025-08-11_19-21-51", "timestamp": 1754932911, "time_this_iter_s": 1.7151899337768555, "time_total_s": 18.515284299850464, "pid": 14324, "hostname": "Mac", "node_ip": "127.0.0.1", "config": {"exploration_config": {}, "extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "placement_strategy": "PACK", "num_gpus": 0, "_fake_gpus": false, "num_cpus_for_main_process": 2, "eager_tracing": true, "eager_max_retraces": 20, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "torch_compile_learner": false, "torch_compile_learner_what_to_compile": "forward_train", "torch_compile_learner_dynamo_backend": "aot_eager", "torch_compile_learner_dynamo_mode": null, "torch_compile_worker": false, "torch_compile_worker_dynamo_backend": "aot_eager", "torch_compile_worker_dynamo_mode": null, "torch_ddp_kwargs": {}, "torch_skip_nan_gradients": false, "env": "Umbrella", "env_config": {}, "observation_space": null, "action_space": null, "clip_rewards": null, "normalize_actions": true, "clip_actions": false, "_is_atari": null, "disable_env_checking": false, "render_env": false, "action_mask_key": "action_mask", "env_runner_cls": null, "num_env_runners": 0, "create_local_env_runner": true, "num_envs_per_env_runner": 1, "gym_env_vectorize_mode": "SYNC", "num_cpus_per_env_runner": 1, "num_gpus_per_env_runner": 0, "custom_resources_per_env_runner": {}, "validate_env_runners_after_construction": true, "episodes_to_numpy": true, "max_requests_in_flight_per_env_runner": 1, "sample_timeout_s": 60.0, "_env_to_module_connector": null, "add_default_connectors_to_env_to_module_pipeline": true, "_module_to_env_connector": null, "add_default_connectors_to_module_to_env_pipeline": true, "merge_env_runner_states": "training_only", "broadcast_env_runner_states": true, "episode_lookback_horizon": 1, "rollout_fragment_length": "auto", "batch_mode": "complete_episodes", "compress_observations": false, "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "enable_tf1_exec_eagerly": false, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "preprocessor_pref": "deepmind", "observation_filter": "NoFilter", "update_worker_filter_stats": true, "use_worker_filter_stats": true, "sampler_perf_stats_ema_coef": null, "_is_online": true, "num_learners": 0, "num_gpus_per_learner": 0, "num_cpus_per_learner": "auto", "num_aggregator_actors_per_learner": 0, "max_requests_in_flight_per_aggregator_actor": 3, "local_gpu_idx": 0, "max_requests_in_flight_per_learner": 3, "gamma": 1, "lr": 0.0002847858517, "grad_clip": 0.5, "grad_clip_by": "global_norm", "_train_batch_size_per_learner": 5000, "train_batch_size": 4000, "num_epochs": 1, "minibatch_size": 1000, "shuffle_batch_per_epoch": true, "model": {"fcnet_hiddens": [256, 256], "fcnet_activation": "tanh", "fcnet_weights_initializer": null, "fcnet_weights_initializer_config": null, "fcnet_bias_initializer": null, "fcnet_bias_initializer_config": null, "conv_filters": null, "conv_activation": "relu", "conv_kernel_initializer": null, "conv_kernel_initializer_config": null, "conv_bias_initializer": null, "conv_bias_initializer_config": null, "conv_transpose_kernel_initializer": null, "conv_transpose_kernel_initializer_config": null, "conv_transpose_bias_initializer": null, "conv_transpose_bias_initializer_config": null, "post_fcnet_hiddens": [], "post_fcnet_activation": "relu", "post_fcnet_weights_initializer": null, "post_fcnet_weights_initializer_config": null, "post_fcnet_bias_initializer": null, "post_fcnet_bias_initializer_config": null, "free_log_std": false, "log_std_clip_param": 20.0, "no_final_linear": false, "vf_share_layers": false, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "lstm_weights_initializer": null, "lstm_weights_initializer_config": null, "lstm_bias_initializer": null, "lstm_bias_initializer_config": null, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "attention_use_n_prev_actions": 0, "attention_use_n_prev_rewards": 0, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": null, "custom_model_config": {}, "custom_action_dist": null, "custom_preprocessor": null, "encoder_latent_dim": null, "always_check_shapes": false, "lstm_use_prev_action_reward": -1, "_use_default_native_models": -1, "_disable_preprocessor_api": false, "_disable_action_flattening": false}, "_learner_connector": null, "add_default_connectors_to_learner_pipeline": true, "learner_config_dict": {}, "optimizer": {}, "_learner_class": null, "callbacks_on_algorithm_init": null, "callbacks_on_env_runners_recreated": null, "callbacks_on_offline_eval_runners_recreated": null, "callbacks_on_checkpoint_loaded": null, "callbacks_on_environment_created": null, "callbacks_on_episode_created": null, "callbacks_on_episode_start": null, "callbacks_on_episode_step": null, "callbacks_on_episode_end": null, "callbacks_on_evaluate_start": null, "callbacks_on_evaluate_end": null, "callbacks_on_evaluate_offline_start": null, "callbacks_on_evaluate_offline_end": null, "callbacks_on_sample_end": null, "callbacks_on_train_result": null, "explore": true, "enable_rl_module_and_learner": true, "enable_env_runner_and_connector_v2": true, "_prior_exploration_config": {"type": "StochasticSampling"}, "count_steps_by": "env_steps", "policy_map_capacity": 100, "policy_mapping_fn": "<function AlgorithmConfig.DEFAULT_POLICY_MAPPING_FN at 0x385eedb20>", "policies_to_train": null, "policy_states_are_swappable": false, "observation_fn": null, "offline_data_class": null, "input_read_method": "read_parquet", "input_read_method_kwargs": {}, "input_read_schema": {}, "input_read_episodes": false, "input_read_sample_batches": false, "input_read_batch_size": null, "input_filesystem": null, "input_filesystem_kwargs": {}, "input_compress_columns": ["obs", "new_obs"], "input_spaces_jsonable": true, "materialize_data": false, "materialize_mapped_data": true, "map_batches_kwargs": {}, "iter_batches_kwargs": {}, "ignore_final_observation": false, "prelearner_class": null, "prelearner_buffer_class": null, "prelearner_buffer_kwargs": {}, "prelearner_module_synch_period": 10, "dataset_num_iters_per_learner": null, "input_config": {}, "actions_in_input_normalized": false, "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_config": {}, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "output_max_rows_per_file": null, "output_write_remaining_data": false, "output_write_method": "write_parquet", "output_write_method_kwargs": {}, "output_filesystem": null, "output_filesystem_kwargs": {}, "output_write_episodes": true, "offline_sampling": false, "evaluation_interval": 1, "evaluation_duration": 20, "evaluation_duration_unit": "episodes", "evaluation_sample_timeout_s": 120.0, "evaluation_auto_duration_min_env_steps_per_sample": 100, "evaluation_auto_duration_max_env_steps_per_sample": 2000, "evaluation_parallel_to_training": false, "evaluation_force_reset_envs_before_iteration": true, "evaluation_config": null, "off_policy_estimation_methods": {}, "ope_split_batch_by_episode": true, "evaluation_num_env_runners": 1, "in_evaluation": false, "sync_filters_on_rollout_workers_timeout_s": 10.0, "offline_evaluation_interval": null, "num_offline_eval_runners": 0, "offline_loss_for_module_fn": null, "offline_evaluation_duration": 1, "offline_evaluation_parallel_to_training": false, "offline_evaluation_timeout_s": 120.0, "num_cpus_per_offline_eval_runner": 1, "num_gpus_per_offline_eval_runner": 0, "custom_resources_per_offline_eval_runner": {}, "restart_failed_offline_eval_runners": true, "ignore_offline_eval_runner_failures": false, "max_num_offline_eval_runner_restarts": 1000, "offline_eval_runner_restore_timeout_s": 1800.0, "max_requests_in_flight_per_offline_eval_runner": 1, "validate_offline_eval_runners_after_construction": true, "offline_eval_runner_health_probe_timeout_s": 30.0, "offline_eval_rl_module_inference_only": false, "broadcast_offline_eval_runner_states": false, "offline_eval_batch_size_per_runner": 256, "dataset_num_iters_per_eval_runner": 1, "keep_per_episode_custom_metrics": false, "metrics_episode_collection_timeout_s": 60.0, "metrics_num_episodes_for_smoothing": 100, "min_time_s_per_iteration": null, "min_train_timesteps_per_iteration": 0, "min_sample_timesteps_per_iteration": 0, "log_gradients": true, "export_native_model_files": false, "checkpoint_trainable_policies_only": false, "logger_creator": null, "logger_config": null, "log_level": "WARN", "log_sys_usage": true, "fake_sampler": false, "seed": 7, "restart_failed_env_runners": true, "ignore_env_runner_failures": false, "max_num_env_runner_restarts": 1000, "delay_between_env_runner_restarts_s": 60.0, "restart_failed_sub_environments": false, "num_consecutive_env_runner_failures_tolerance": 100, "env_runner_health_probe_timeout_s": 30.0, "env_runner_restore_timeout_s": 1800.0, "_model_config": {}, "_rl_module_spec": "RLModuleSpec(module_class=None, observation_space=None, action_space=None, inference_only=False, learner_only=False, model_config=DefaultModelConfig(fcnet_hiddens=[60, 90], fcnet_activation='tanh', fcnet_kernel_initializer=None, fcnet_kernel_initializer_kwargs=None, fcnet_bias_initializer=None, fcnet_bias_initializer_kwargs=None, conv_filters=None, conv_activation='relu', conv_kernel_initializer=None, conv_kernel_initializer_kwargs=None, conv_bias_initializer=None, conv_bias_initializer_kwargs=None, head_fcnet_hiddens=[], head_fcnet_activation='relu', head_fcnet_kernel_initializer=None, head_fcnet_kernel_initializer_kwargs=None, head_fcnet_bias_initializer=None, head_fcnet_bias_initializer_kwargs=None, free_log_std=False, log_std_clip_param=20.0, vf_share_layers=True, use_lstm=False, max_seq_len=20, lstm_cell_size=256, lstm_use_prev_action=False, lstm_use_prev_reward=False, lstm_kernel_initializer=None, lstm_kernel_initializer_kwargs=None, lstm_bias_initializer=None, lstm_bias_initializer_kwargs=None), catalog_class=None, load_state_path=None, model_config_dict=None)", "algorithm_config_overrides_per_module": {}, "_per_module_overrides": {}, "_validate_config": true, "_use_msgpack_checkpoints": false, "_torch_grad_scaler_class": null, "_torch_lr_scheduler_classes": null, "_tf_policy_handles_more_than_one_loss": false, "_disable_preprocessor_api": false, "_disable_action_flattening": false, "_disable_initialize_loss_from_dummy_batch": false, "_dont_auto_sync_env_runner_states": false, "env_task_fn": -1, "enable_connectors": -1, "simple_optimizer": false, "policy_map_cache": -1, "worker_cls": -1, "synchronize_filters": -1, "enable_async_evaluation": -1, "custom_async_evaluation_function": -1, "_enable_rl_module_api": -1, "auto_wrap_old_gym_envs": -1, "always_attach_evaluation_results": -1, "replay_sequence_length": null, "_disable_execution_plan_api": -1, "use_critic": true, "use_gae": true, "use_kl_loss": true, "kl_coeff": 0.7464963036515, "kl_target": 0.0270990929592, "vf_loss_coeff": 0.6688075857018, "entropy_coeff": 0.0090570820258, "clip_param": 0.1221781641624, "vf_clip_param": 0.1027808522125, "entropy_coeff_schedule": null, "lr_schedule": null, "sgd_minibatch_size": -1, "vf_share_layers": -1, "__stdout_file__": null, "__stderr_file__": null, "lambda": 0.9099046732075, "input": "sampler", "policies": {"default_policy": [null, null, null, null]}, "callbacks": "<class 'ray.rllib.callbacks.callbacks.RLlibCallback'>", "create_env_on_driver": false, "custom_eval_function": null, "framework": "torch"}, "time_since_restore": 18.515284299850464, "iterations_since_restore": 10, "perf": {"cpu_util_percent": 46.0, "ram_util_percent": 79.4}}
{"timers": {"training_iteration": 2.11183314361646, "restore_env_runners": 1.0167794136519884e-05, "training_step": 2.1114421260945133, "env_runner_sampling_timer": 1.8811625489096275, "learner_update_timer": 0.21907780488649045, "synch_weights": 0.0060569687097017325, "restore_eval_env_runners": 9.362893501294713e-05, "evaluation_iteration": 0.17080265096392022, "synch_eval_env_connectors": 0.00032074884899582713, "synch_env_connectors": 6.427197758907528e-06}, "env_runners": {"num_agent_steps_sampled_lifetime": {"default_agent": -5547500.0}, "env_to_module_connector": {"timers": {"connectors": {"numpy_to_tensor": 8.491966212422849e-06, "batch_individual_items": 6.310891749957854e-06, "add_observations_from_episodes_to_batch": 3.0028546400352076e-06, "add_time_dim_to_batch_and_zero_pad": 2.442486860139904e-06, "add_states_from_episodes_to_batch": 1.7714753815537635e-06}}, "connector_pipeline_timer": 4.3914834652177905e-05}, "module_to_env_connector": {"timers": {"connectors": {"get_actions": 3.862644853021065e-05, "normalize_and_clip_actions": 9.441431233603303e-06, "listify_data_for_vector_env": 1.0894254376280703e-05, "remove_single_ts_time_rank_from_batch": 5.796017056659005e-07, "tensor_to_numpy": 1.3170005007086558e-05, "un_batch_to_individual_items": 5.394613283085305e-06}}, "connector_pipeline_timer": 0.0001038858333865324}, "time_between_sampling": 0.001926003516411779, "agent_episode_returns_mean": {"default_agent": 4.740000000000002}, "sample": 0.004944351300898771, "env_to_module_sum_episodes_length_out": 10.36823839457432, "num_env_steps_sampled": 5000.0, "num_agent_steps_sampled": {"default_agent": 5000.0}, "module_episode_returns_mean": {"default_policy": 4.740000000000002}, "env_reset_timer": 3.540959261700726e-05, "episode_return_max": 10.5, "episode_len_min": 20, "episode_return_mean": 4.740000000000002, "num_episodes_lifetime": -277375.0, "env_to_module_sum_episodes_length_in": 10.36823839457432, "num_episodes": 250.0, "num_module_steps_sampled_lifetime": {"default_policy": -5547500.0}, "episode_return_min": -9.5, "episode_len_mean": 20.0, "episode_duration_sec_mean": 0.004555548824369907, "weights_seq_no": 10.0, "episode_len_max": 20, "num_env_steps_sampled_lifetime": -5547500.0, "env_step_timer": 1.3671978680725127e-05, "rlmodule_inference_timer": 2.8122057233722366e-05, "num_module_steps_sampled": {"default_policy": 5000.0}, "num_env_steps_sampled_lifetime_throughput": 3711.2756923544466}, "learners": {"default_policy": {"diff_num_grad_updates_vs_sampler_policy": 1.0, "curr_entropy_coeff": 0.0090570820258, "policy_loss": -0.08203604817390442, "default_optimizer_learning_rate": 0.0002847858517, "num_trainable_parameters": 6003, "num_module_steps_trained_lifetime": 66000, "weights_seq_no": 11.0, "vf_loss_unclipped": 28.26639175415039, "num_module_steps_trained": 6000, "mean_kl_loss": 0.0002990176435559988, "curr_kl_coeff": 0.0003645001561380923, "entropy": 0.5904799699783325, "module_train_batch_size_mean": 1000.0, "gradients_default_optimizer_global_norm": 0.032687243074178696, "vf_loss": 0.10278083384037018, "vf_explained_var": -0.010197997093200684, "total_loss": -0.018643252551555634, "num_module_steps_trained_lifetime_throughput": 210127.7456906275}, "__all_modules__": {"num_trainable_parameters": 6003, "learner_connector_sum_episodes_length_in": 5000.0, "learner_connector": {"timers": {"connectors": {"batch_individual_items": 0.06484760278353648, "add_columns_from_episodes_to_train_batch": 0.04632800793579344, "add_one_ts_to_episodes_and_truncate": 0.015187537360365898, "add_observations_from_episodes_to_batch": 0.0008767890241326671, "add_states_from_episodes_to_batch": 8.282213639584482e-06, "general_advantage_estimation": 0.013913173387761614, "add_time_dim_to_batch_and_zero_pad": 5.6903221337391985e-05, "numpy_to_tensor": 0.00014747792880465672}}, "connector_pipeline_timer": 0.14174044473534572}, "num_env_steps_trained_lifetime": 346500, "num_env_steps_trained": 31500, "num_non_trainable_parameters": 0, "num_module_steps_trained_lifetime": 66000, "num_module_steps_trained": 6000, "learner_connector_sum_episodes_length_out": 5250.0, "num_env_steps_trained_lifetime_throughput": 1101695.356734763, "num_module_steps_trained_throughput": 210173.86865519334, "num_module_steps_trained_lifetime_throughput": 210047.1737546476}}, "num_training_step_calls_per_iteration": 1, "evaluation": {"env_runners": {"episode_len_mean": 20.0, "module_to_env_connector": {"connector_pipeline_timer": 9.922786263146817e-05, "timers": {"connectors": {"remove_single_ts_time_rank_from_batch": 5.849094968892992e-07, "tensor_to_numpy": 1.275540927239368e-05, "normalize_and_clip_actions": 9.34242111854563e-06, "listify_data_for_vector_env": 1.103653927800522e-05, "un_batch_to_individual_items": 5.343088649441849e-06, "get_actions": 3.487211630533631e-05}}}, "num_env_steps_sampled_lifetime": 55400, "rlmodule_inference_timer": 2.6295256468917394e-05, "env_to_module_connector": {"timers": {"connectors": {"add_time_dim_to_batch_and_zero_pad": 2.19754534356514e-06, "numpy_to_tensor": 8.183586629454602e-06, "batch_individual_items": 6.076642958533242e-06, "add_states_from_episodes_to_batch": 1.5969170825063176e-06, "add_observations_from_episodes_to_batch": 2.8337401676445736e-06}}, "connector_pipeline_timer": 4.207564734738581e-05}, "num_episodes_lifetime": 220, "weights_seq_no": 11.0, "episode_len_max": 20, "sample": 0.14367073190819396, "episode_return_max": 14.5, "env_reset_timer": 0.0006520025749613126, "agent_episode_returns_mean": {"default_agent": -0.15}, "module_episode_returns_mean": {"default_policy": -0.15}, "num_episodes": 20, "episode_return_min": -12.5, "episode_duration_sec_mean": 0.004511056210612878, "num_module_steps_sampled": {"default_policy": 400}, "num_env_steps_sampled": 400, "num_agent_steps_sampled_lifetime": {"default_agent": 4400}, "env_to_module_sum_episodes_length_in": 10.368238394574323, "num_agent_steps_sampled": {"default_agent": 400}, "env_step_timer": 1.3968170647105285e-05, "num_module_steps_sampled_lifetime": {"default_policy": 4400}, "env_to_module_sum_episodes_length_out": 10.368238394574323, "episode_len_min": 20, "episode_return_mean": -0.15, "time_between_sampling": 1.8928717114161597}, "num_healthy_workers": 1, "actor_manager_num_outstanding_async_reqs": 0, "num_remote_worker_restarts": 0}, "num_env_steps_sampled_lifetime": -5547500.0, "fault_tolerance": {"num_healthy_workers": 0, "num_remote_worker_restarts": 0}, "env_runner_group": {"actor_manager_num_outstanding_async_reqs": 0}, "done": false, "training_iteration": 11, "trial_id": "4da12_00000", "date": "2025-08-11_19-21-53", "timestamp": 1754932913, "time_this_iter_s": 1.5840187072753906, "time_total_s": 20.099303007125854, "pid": 14324, "hostname": "Mac", "node_ip": "127.0.0.1", "config": {"exploration_config": {}, "extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "placement_strategy": "PACK", "num_gpus": 0, "_fake_gpus": false, "num_cpus_for_main_process": 2, "eager_tracing": true, "eager_max_retraces": 20, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "torch_compile_learner": false, "torch_compile_learner_what_to_compile": "forward_train", "torch_compile_learner_dynamo_backend": "aot_eager", "torch_compile_learner_dynamo_mode": null, "torch_compile_worker": false, "torch_compile_worker_dynamo_backend": "aot_eager", "torch_compile_worker_dynamo_mode": null, "torch_ddp_kwargs": {}, "torch_skip_nan_gradients": false, "env": "Umbrella", "env_config": {}, "observation_space": null, "action_space": null, "clip_rewards": null, "normalize_actions": true, "clip_actions": false, "_is_atari": null, "disable_env_checking": false, "render_env": false, "action_mask_key": "action_mask", "env_runner_cls": null, "num_env_runners": 0, "create_local_env_runner": true, "num_envs_per_env_runner": 1, "gym_env_vectorize_mode": "SYNC", "num_cpus_per_env_runner": 1, "num_gpus_per_env_runner": 0, "custom_resources_per_env_runner": {}, "validate_env_runners_after_construction": true, "episodes_to_numpy": true, "max_requests_in_flight_per_env_runner": 1, "sample_timeout_s": 60.0, "_env_to_module_connector": null, "add_default_connectors_to_env_to_module_pipeline": true, "_module_to_env_connector": null, "add_default_connectors_to_module_to_env_pipeline": true, "merge_env_runner_states": "training_only", "broadcast_env_runner_states": true, "episode_lookback_horizon": 1, "rollout_fragment_length": "auto", "batch_mode": "complete_episodes", "compress_observations": false, "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "enable_tf1_exec_eagerly": false, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "preprocessor_pref": "deepmind", "observation_filter": "NoFilter", "update_worker_filter_stats": true, "use_worker_filter_stats": true, "sampler_perf_stats_ema_coef": null, "_is_online": true, "num_learners": 0, "num_gpus_per_learner": 0, "num_cpus_per_learner": "auto", "num_aggregator_actors_per_learner": 0, "max_requests_in_flight_per_aggregator_actor": 3, "local_gpu_idx": 0, "max_requests_in_flight_per_learner": 3, "gamma": 1, "lr": 0.0002847858517, "grad_clip": 0.5, "grad_clip_by": "global_norm", "_train_batch_size_per_learner": 5000, "train_batch_size": 4000, "num_epochs": 1, "minibatch_size": 1000, "shuffle_batch_per_epoch": true, "model": {"fcnet_hiddens": [256, 256], "fcnet_activation": "tanh", "fcnet_weights_initializer": null, "fcnet_weights_initializer_config": null, "fcnet_bias_initializer": null, "fcnet_bias_initializer_config": null, "conv_filters": null, "conv_activation": "relu", "conv_kernel_initializer": null, "conv_kernel_initializer_config": null, "conv_bias_initializer": null, "conv_bias_initializer_config": null, "conv_transpose_kernel_initializer": null, "conv_transpose_kernel_initializer_config": null, "conv_transpose_bias_initializer": null, "conv_transpose_bias_initializer_config": null, "post_fcnet_hiddens": [], "post_fcnet_activation": "relu", "post_fcnet_weights_initializer": null, "post_fcnet_weights_initializer_config": null, "post_fcnet_bias_initializer": null, "post_fcnet_bias_initializer_config": null, "free_log_std": false, "log_std_clip_param": 20.0, "no_final_linear": false, "vf_share_layers": false, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "lstm_weights_initializer": null, "lstm_weights_initializer_config": null, "lstm_bias_initializer": null, "lstm_bias_initializer_config": null, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "attention_use_n_prev_actions": 0, "attention_use_n_prev_rewards": 0, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": null, "custom_model_config": {}, "custom_action_dist": null, "custom_preprocessor": null, "encoder_latent_dim": null, "always_check_shapes": false, "lstm_use_prev_action_reward": -1, "_use_default_native_models": -1, "_disable_preprocessor_api": false, "_disable_action_flattening": false}, "_learner_connector": null, "add_default_connectors_to_learner_pipeline": true, "learner_config_dict": {}, "optimizer": {}, "_learner_class": null, "callbacks_on_algorithm_init": null, "callbacks_on_env_runners_recreated": null, "callbacks_on_offline_eval_runners_recreated": null, "callbacks_on_checkpoint_loaded": null, "callbacks_on_environment_created": null, "callbacks_on_episode_created": null, "callbacks_on_episode_start": null, "callbacks_on_episode_step": null, "callbacks_on_episode_end": null, "callbacks_on_evaluate_start": null, "callbacks_on_evaluate_end": null, "callbacks_on_evaluate_offline_start": null, "callbacks_on_evaluate_offline_end": null, "callbacks_on_sample_end": null, "callbacks_on_train_result": null, "explore": true, "enable_rl_module_and_learner": true, "enable_env_runner_and_connector_v2": true, "_prior_exploration_config": {"type": "StochasticSampling"}, "count_steps_by": "env_steps", "policy_map_capacity": 100, "policy_mapping_fn": "<function AlgorithmConfig.DEFAULT_POLICY_MAPPING_FN at 0x385eedb20>", "policies_to_train": null, "policy_states_are_swappable": false, "observation_fn": null, "offline_data_class": null, "input_read_method": "read_parquet", "input_read_method_kwargs": {}, "input_read_schema": {}, "input_read_episodes": false, "input_read_sample_batches": false, "input_read_batch_size": null, "input_filesystem": null, "input_filesystem_kwargs": {}, "input_compress_columns": ["obs", "new_obs"], "input_spaces_jsonable": true, "materialize_data": false, "materialize_mapped_data": true, "map_batches_kwargs": {}, "iter_batches_kwargs": {}, "ignore_final_observation": false, "prelearner_class": null, "prelearner_buffer_class": null, "prelearner_buffer_kwargs": {}, "prelearner_module_synch_period": 10, "dataset_num_iters_per_learner": null, "input_config": {}, "actions_in_input_normalized": false, "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_config": {}, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "output_max_rows_per_file": null, "output_write_remaining_data": false, "output_write_method": "write_parquet", "output_write_method_kwargs": {}, "output_filesystem": null, "output_filesystem_kwargs": {}, "output_write_episodes": true, "offline_sampling": false, "evaluation_interval": 1, "evaluation_duration": 20, "evaluation_duration_unit": "episodes", "evaluation_sample_timeout_s": 120.0, "evaluation_auto_duration_min_env_steps_per_sample": 100, "evaluation_auto_duration_max_env_steps_per_sample": 2000, "evaluation_parallel_to_training": false, "evaluation_force_reset_envs_before_iteration": true, "evaluation_config": null, "off_policy_estimation_methods": {}, "ope_split_batch_by_episode": true, "evaluation_num_env_runners": 1, "in_evaluation": false, "sync_filters_on_rollout_workers_timeout_s": 10.0, "offline_evaluation_interval": null, "num_offline_eval_runners": 0, "offline_loss_for_module_fn": null, "offline_evaluation_duration": 1, "offline_evaluation_parallel_to_training": false, "offline_evaluation_timeout_s": 120.0, "num_cpus_per_offline_eval_runner": 1, "num_gpus_per_offline_eval_runner": 0, "custom_resources_per_offline_eval_runner": {}, "restart_failed_offline_eval_runners": true, "ignore_offline_eval_runner_failures": false, "max_num_offline_eval_runner_restarts": 1000, "offline_eval_runner_restore_timeout_s": 1800.0, "max_requests_in_flight_per_offline_eval_runner": 1, "validate_offline_eval_runners_after_construction": true, "offline_eval_runner_health_probe_timeout_s": 30.0, "offline_eval_rl_module_inference_only": false, "broadcast_offline_eval_runner_states": false, "offline_eval_batch_size_per_runner": 256, "dataset_num_iters_per_eval_runner": 1, "keep_per_episode_custom_metrics": false, "metrics_episode_collection_timeout_s": 60.0, "metrics_num_episodes_for_smoothing": 100, "min_time_s_per_iteration": null, "min_train_timesteps_per_iteration": 0, "min_sample_timesteps_per_iteration": 0, "log_gradients": true, "export_native_model_files": false, "checkpoint_trainable_policies_only": false, "logger_creator": null, "logger_config": null, "log_level": "WARN", "log_sys_usage": true, "fake_sampler": false, "seed": 7, "restart_failed_env_runners": true, "ignore_env_runner_failures": false, "max_num_env_runner_restarts": 1000, "delay_between_env_runner_restarts_s": 60.0, "restart_failed_sub_environments": false, "num_consecutive_env_runner_failures_tolerance": 100, "env_runner_health_probe_timeout_s": 30.0, "env_runner_restore_timeout_s": 1800.0, "_model_config": {}, "_rl_module_spec": "RLModuleSpec(module_class=None, observation_space=None, action_space=None, inference_only=False, learner_only=False, model_config=DefaultModelConfig(fcnet_hiddens=[60, 90], fcnet_activation='tanh', fcnet_kernel_initializer=None, fcnet_kernel_initializer_kwargs=None, fcnet_bias_initializer=None, fcnet_bias_initializer_kwargs=None, conv_filters=None, conv_activation='relu', conv_kernel_initializer=None, conv_kernel_initializer_kwargs=None, conv_bias_initializer=None, conv_bias_initializer_kwargs=None, head_fcnet_hiddens=[], head_fcnet_activation='relu', head_fcnet_kernel_initializer=None, head_fcnet_kernel_initializer_kwargs=None, head_fcnet_bias_initializer=None, head_fcnet_bias_initializer_kwargs=None, free_log_std=False, log_std_clip_param=20.0, vf_share_layers=True, use_lstm=False, max_seq_len=20, lstm_cell_size=256, lstm_use_prev_action=False, lstm_use_prev_reward=False, lstm_kernel_initializer=None, lstm_kernel_initializer_kwargs=None, lstm_bias_initializer=None, lstm_bias_initializer_kwargs=None), catalog_class=None, load_state_path=None, model_config_dict=None)", "algorithm_config_overrides_per_module": {}, "_per_module_overrides": {}, "_validate_config": true, "_use_msgpack_checkpoints": false, "_torch_grad_scaler_class": null, "_torch_lr_scheduler_classes": null, "_tf_policy_handles_more_than_one_loss": false, "_disable_preprocessor_api": false, "_disable_action_flattening": false, "_disable_initialize_loss_from_dummy_batch": false, "_dont_auto_sync_env_runner_states": false, "env_task_fn": -1, "enable_connectors": -1, "simple_optimizer": false, "policy_map_cache": -1, "worker_cls": -1, "synchronize_filters": -1, "enable_async_evaluation": -1, "custom_async_evaluation_function": -1, "_enable_rl_module_api": -1, "auto_wrap_old_gym_envs": -1, "always_attach_evaluation_results": -1, "replay_sequence_length": null, "_disable_execution_plan_api": -1, "use_critic": true, "use_gae": true, "use_kl_loss": true, "kl_coeff": 0.7464963036515, "kl_target": 0.0270990929592, "vf_loss_coeff": 0.6688075857018, "entropy_coeff": 0.0090570820258, "clip_param": 0.1221781641624, "vf_clip_param": 0.1027808522125, "entropy_coeff_schedule": null, "lr_schedule": null, "sgd_minibatch_size": -1, "vf_share_layers": -1, "__stdout_file__": null, "__stderr_file__": null, "lambda": 0.9099046732075, "input": "sampler", "policies": {"default_policy": [null, null, null, null]}, "callbacks": "<class 'ray.rllib.callbacks.callbacks.RLlibCallback'>", "create_env_on_driver": false, "custom_eval_function": null, "framework": "torch"}, "time_since_restore": 20.099303007125854, "iterations_since_restore": 11, "perf": {"cpu_util_percent": 42.95, "ram_util_percent": 79.7}}
{"timers": {"training_iteration": 2.1064317855208996, "restore_env_runners": 1.0136956082639593e-05, "training_step": 2.106042819832898, "env_runner_sampling_timer": 1.8770862700898625, "learner_update_timer": 0.21783532850776705, "synch_weights": 0.006002015272586983, "restore_eval_env_runners": 9.276055537665218e-05, "evaluation_iteration": 0.17011476861441946, "synch_eval_env_connectors": 0.0003184951104922343, "synch_env_connectors": 6.401266003408934e-06}, "env_runners": {"num_agent_steps_sampled_lifetime": {"default_agent": -6165000.0}, "env_to_module_connector": {"timers": {"connectors": {"numpy_to_tensor": 8.613916335283423e-06, "batch_individual_items": 6.40893454770332e-06, "add_observations_from_episodes_to_batch": 3.111798655934962e-06, "add_time_dim_to_batch_and_zero_pad": 2.4625380218910536e-06, "add_states_from_episodes_to_batch": 1.7677145316921794e-06}}, "connector_pipeline_timer": 4.4350856597144176e-05}, "module_to_env_connector": {"timers": {"connectors": {"get_actions": 3.8988104099526633e-05, "normalize_and_clip_actions": 9.5894227693641e-06, "listify_data_for_vector_env": 1.1006023027150139e-05, "remove_single_ts_time_rank_from_batch": 5.860863630095309e-07, "tensor_to_numpy": 1.3230635161640065e-05, "un_batch_to_individual_items": 5.4229866978019716e-06}}, "connector_pipeline_timer": 0.00010482920112988332}, "time_between_sampling": 0.0018287282449121625, "agent_episode_returns_mean": {"default_agent": 5.619999999999999}, "sample": 0.0048726012782315045, "env_to_module_sum_episodes_length_out": 10.36823839457432, "num_env_steps_sampled": 5000.0, "num_agent_steps_sampled": {"default_agent": 5000.0}, "module_episode_returns_mean": {"default_policy": 5.619999999999999}, "env_reset_timer": 3.277756076137474e-05, "episode_return_max": 10.5, "episode_len_min": 20, "episode_return_mean": 5.619999999999999, "num_episodes_lifetime": -308250.0, "env_to_module_sum_episodes_length_in": 10.36823839457432, "num_episodes": 250.0, "num_module_steps_sampled_lifetime": {"default_policy": -6165000.0}, "episode_return_min": -9.5, "episode_len_mean": 20.0, "episode_duration_sec_mean": 0.004597209447529166, "weights_seq_no": 11.0, "episode_len_max": 20, "num_env_steps_sampled_lifetime": -6165000.0, "env_step_timer": 1.3801366664039634e-05, "rlmodule_inference_timer": 2.774556328885428e-05, "num_module_steps_sampled": {"default_policy": 5000.0}, "num_env_steps_sampled_lifetime_throughput": 3694.288544599296}, "learners": {"default_policy": {"diff_num_grad_updates_vs_sampler_policy": 1.0, "curr_entropy_coeff": 0.0090570820258, "policy_loss": -0.04213358461856842, "default_optimizer_learning_rate": 0.0002847858517, "num_trainable_parameters": 6003, "num_module_steps_trained_lifetime": 72000, "weights_seq_no": 12.0, "vf_loss_unclipped": 28.210323333740234, "num_module_steps_trained": 6000, "mean_kl_loss": 0.0009873730596154928, "curr_kl_coeff": 0.00018225007806904614, "entropy": 0.5664700865745544, "module_train_batch_size_mean": 1000.0, "gradients_default_optimizer_global_norm": 0.07592751830816269, "vf_loss": 0.10278083384037018, "vf_explained_var": -0.009987235069274902, "total_loss": 0.02147681638598442, "num_module_steps_trained_lifetime_throughput": 218138.76866096666}, "__all_modules__": {"num_trainable_parameters": 6003, "learner_connector_sum_episodes_length_in": 5000.0, "learner_connector": {"timers": {"connectors": {"batch_individual_items": 0.06451279467611919, "add_columns_from_episodes_to_train_batch": 0.046208936196828886, "add_one_ts_to_episodes_and_truncate": 0.015111827817013068, "add_observations_from_episodes_to_batch": 0.0008759407238802278, "add_states_from_episodes_to_batch": 8.236472111496953e-06, "general_advantage_estimation": 0.013832158734363859, "add_time_dim_to_batch_and_zero_pad": 5.645335883235942e-05, "numpy_to_tensor": 0.00014663522883477594}}, "connector_pipeline_timer": 0.1411248598788439}, "num_env_steps_trained_lifetime": 378000, "num_env_steps_trained": 31500, "num_non_trainable_parameters": 0, "num_module_steps_trained_lifetime": 72000, "num_module_steps_trained": 6000, "learner_connector_sum_episodes_length_out": 5250.0, "num_env_steps_trained_lifetime_throughput": 1143889.7892435242, "num_module_steps_trained_throughput": 218209.37364216842, "num_module_steps_trained_lifetime_throughput": 218080.23558002056}}, "num_training_step_calls_per_iteration": 1, "evaluation": {"env_runners": {"episode_len_mean": 20.0, "module_to_env_connector": {"connector_pipeline_timer": 9.874981060904481e-05, "timers": {"connectors": {"remove_single_ts_time_rank_from_batch": 5.640941322128688e-07, "tensor_to_numpy": 1.2640644422035509e-05, "normalize_and_clip_actions": 9.286285931096051e-06, "listify_data_for_vector_env": 1.0938271679364287e-05, "un_batch_to_individual_items": 5.3537165778985135e-06, "get_actions": 3.4892374327503785e-05}}}, "num_env_steps_sampled_lifetime": 60400, "rlmodule_inference_timer": 2.6587310340847785e-05, "env_to_module_connector": {"timers": {"connectors": {"add_time_dim_to_batch_and_zero_pad": 2.200974212272186e-06, "numpy_to_tensor": 8.179838833678041e-06, "batch_individual_items": 6.101760406548864e-06, "add_states_from_episodes_to_batch": 1.5827020659364892e-06, "add_observations_from_episodes_to_batch": 2.8148167705276204e-06}}, "connector_pipeline_timer": 4.1980617276089145e-05}, "num_episodes_lifetime": 240, "weights_seq_no": 12.0, "episode_len_max": 20, "sample": 0.14319917416984587, "episode_return_max": 14.5, "env_reset_timer": 0.000646130878944639, "agent_episode_returns_mean": {"default_agent": -0.55}, "module_episode_returns_mean": {"default_policy": -0.55}, "num_episodes": 20, "episode_return_min": -12.5, "episode_duration_sec_mean": 0.00451392415096052, "num_module_steps_sampled": {"default_policy": 400}, "num_env_steps_sampled": 400, "num_agent_steps_sampled_lifetime": {"default_agent": 4800}, "env_to_module_sum_episodes_length_in": 10.368238394574323, "num_agent_steps_sampled": {"default_agent": 400}, "env_step_timer": 1.4034973176144004e-05, "num_module_steps_sampled_lifetime": {"default_policy": 4800}, "env_to_module_sum_episodes_length_out": 10.368238394574323, "episode_len_min": 20, "episode_return_mean": -0.55, "time_between_sampling": 1.8898515413818873}, "num_healthy_workers": 1, "actor_manager_num_outstanding_async_reqs": 0, "num_remote_worker_restarts": 0}, "num_env_steps_sampled_lifetime": -6165000.0, "fault_tolerance": {"num_healthy_workers": 0, "num_remote_worker_restarts": 0}, "env_runner_group": {"actor_manager_num_outstanding_async_reqs": 0}, "done": false, "training_iteration": 12, "trial_id": "4da12_00000", "date": "2025-08-11_19-21-55", "timestamp": 1754932915, "time_this_iter_s": 1.6758017539978027, "time_total_s": 21.775104761123657, "pid": 14324, "hostname": "Mac", "node_ip": "127.0.0.1", "config": {"exploration_config": {}, "extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "placement_strategy": "PACK", "num_gpus": 0, "_fake_gpus": false, "num_cpus_for_main_process": 2, "eager_tracing": true, "eager_max_retraces": 20, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "torch_compile_learner": false, "torch_compile_learner_what_to_compile": "forward_train", "torch_compile_learner_dynamo_backend": "aot_eager", "torch_compile_learner_dynamo_mode": null, "torch_compile_worker": false, "torch_compile_worker_dynamo_backend": "aot_eager", "torch_compile_worker_dynamo_mode": null, "torch_ddp_kwargs": {}, "torch_skip_nan_gradients": false, "env": "Umbrella", "env_config": {}, "observation_space": null, "action_space": null, "clip_rewards": null, "normalize_actions": true, "clip_actions": false, "_is_atari": null, "disable_env_checking": false, "render_env": false, "action_mask_key": "action_mask", "env_runner_cls": null, "num_env_runners": 0, "create_local_env_runner": true, "num_envs_per_env_runner": 1, "gym_env_vectorize_mode": "SYNC", "num_cpus_per_env_runner": 1, "num_gpus_per_env_runner": 0, "custom_resources_per_env_runner": {}, "validate_env_runners_after_construction": true, "episodes_to_numpy": true, "max_requests_in_flight_per_env_runner": 1, "sample_timeout_s": 60.0, "_env_to_module_connector": null, "add_default_connectors_to_env_to_module_pipeline": true, "_module_to_env_connector": null, "add_default_connectors_to_module_to_env_pipeline": true, "merge_env_runner_states": "training_only", "broadcast_env_runner_states": true, "episode_lookback_horizon": 1, "rollout_fragment_length": "auto", "batch_mode": "complete_episodes", "compress_observations": false, "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "enable_tf1_exec_eagerly": false, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "preprocessor_pref": "deepmind", "observation_filter": "NoFilter", "update_worker_filter_stats": true, "use_worker_filter_stats": true, "sampler_perf_stats_ema_coef": null, "_is_online": true, "num_learners": 0, "num_gpus_per_learner": 0, "num_cpus_per_learner": "auto", "num_aggregator_actors_per_learner": 0, "max_requests_in_flight_per_aggregator_actor": 3, "local_gpu_idx": 0, "max_requests_in_flight_per_learner": 3, "gamma": 1, "lr": 0.0002847858517, "grad_clip": 0.5, "grad_clip_by": "global_norm", "_train_batch_size_per_learner": 5000, "train_batch_size": 4000, "num_epochs": 1, "minibatch_size": 1000, "shuffle_batch_per_epoch": true, "model": {"fcnet_hiddens": [256, 256], "fcnet_activation": "tanh", "fcnet_weights_initializer": null, "fcnet_weights_initializer_config": null, "fcnet_bias_initializer": null, "fcnet_bias_initializer_config": null, "conv_filters": null, "conv_activation": "relu", "conv_kernel_initializer": null, "conv_kernel_initializer_config": null, "conv_bias_initializer": null, "conv_bias_initializer_config": null, "conv_transpose_kernel_initializer": null, "conv_transpose_kernel_initializer_config": null, "conv_transpose_bias_initializer": null, "conv_transpose_bias_initializer_config": null, "post_fcnet_hiddens": [], "post_fcnet_activation": "relu", "post_fcnet_weights_initializer": null, "post_fcnet_weights_initializer_config": null, "post_fcnet_bias_initializer": null, "post_fcnet_bias_initializer_config": null, "free_log_std": false, "log_std_clip_param": 20.0, "no_final_linear": false, "vf_share_layers": false, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "lstm_weights_initializer": null, "lstm_weights_initializer_config": null, "lstm_bias_initializer": null, "lstm_bias_initializer_config": null, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "attention_use_n_prev_actions": 0, "attention_use_n_prev_rewards": 0, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": null, "custom_model_config": {}, "custom_action_dist": null, "custom_preprocessor": null, "encoder_latent_dim": null, "always_check_shapes": false, "lstm_use_prev_action_reward": -1, "_use_default_native_models": -1, "_disable_preprocessor_api": false, "_disable_action_flattening": false}, "_learner_connector": null, "add_default_connectors_to_learner_pipeline": true, "learner_config_dict": {}, "optimizer": {}, "_learner_class": null, "callbacks_on_algorithm_init": null, "callbacks_on_env_runners_recreated": null, "callbacks_on_offline_eval_runners_recreated": null, "callbacks_on_checkpoint_loaded": null, "callbacks_on_environment_created": null, "callbacks_on_episode_created": null, "callbacks_on_episode_start": null, "callbacks_on_episode_step": null, "callbacks_on_episode_end": null, "callbacks_on_evaluate_start": null, "callbacks_on_evaluate_end": null, "callbacks_on_evaluate_offline_start": null, "callbacks_on_evaluate_offline_end": null, "callbacks_on_sample_end": null, "callbacks_on_train_result": null, "explore": true, "enable_rl_module_and_learner": true, "enable_env_runner_and_connector_v2": true, "_prior_exploration_config": {"type": "StochasticSampling"}, "count_steps_by": "env_steps", "policy_map_capacity": 100, "policy_mapping_fn": "<function AlgorithmConfig.DEFAULT_POLICY_MAPPING_FN at 0x385eedb20>", "policies_to_train": null, "policy_states_are_swappable": false, "observation_fn": null, "offline_data_class": null, "input_read_method": "read_parquet", "input_read_method_kwargs": {}, "input_read_schema": {}, "input_read_episodes": false, "input_read_sample_batches": false, "input_read_batch_size": null, "input_filesystem": null, "input_filesystem_kwargs": {}, "input_compress_columns": ["obs", "new_obs"], "input_spaces_jsonable": true, "materialize_data": false, "materialize_mapped_data": true, "map_batches_kwargs": {}, "iter_batches_kwargs": {}, "ignore_final_observation": false, "prelearner_class": null, "prelearner_buffer_class": null, "prelearner_buffer_kwargs": {}, "prelearner_module_synch_period": 10, "dataset_num_iters_per_learner": null, "input_config": {}, "actions_in_input_normalized": false, "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_config": {}, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "output_max_rows_per_file": null, "output_write_remaining_data": false, "output_write_method": "write_parquet", "output_write_method_kwargs": {}, "output_filesystem": null, "output_filesystem_kwargs": {}, "output_write_episodes": true, "offline_sampling": false, "evaluation_interval": 1, "evaluation_duration": 20, "evaluation_duration_unit": "episodes", "evaluation_sample_timeout_s": 120.0, "evaluation_auto_duration_min_env_steps_per_sample": 100, "evaluation_auto_duration_max_env_steps_per_sample": 2000, "evaluation_parallel_to_training": false, "evaluation_force_reset_envs_before_iteration": true, "evaluation_config": null, "off_policy_estimation_methods": {}, "ope_split_batch_by_episode": true, "evaluation_num_env_runners": 1, "in_evaluation": false, "sync_filters_on_rollout_workers_timeout_s": 10.0, "offline_evaluation_interval": null, "num_offline_eval_runners": 0, "offline_loss_for_module_fn": null, "offline_evaluation_duration": 1, "offline_evaluation_parallel_to_training": false, "offline_evaluation_timeout_s": 120.0, "num_cpus_per_offline_eval_runner": 1, "num_gpus_per_offline_eval_runner": 0, "custom_resources_per_offline_eval_runner": {}, "restart_failed_offline_eval_runners": true, "ignore_offline_eval_runner_failures": false, "max_num_offline_eval_runner_restarts": 1000, "offline_eval_runner_restore_timeout_s": 1800.0, "max_requests_in_flight_per_offline_eval_runner": 1, "validate_offline_eval_runners_after_construction": true, "offline_eval_runner_health_probe_timeout_s": 30.0, "offline_eval_rl_module_inference_only": false, "broadcast_offline_eval_runner_states": false, "offline_eval_batch_size_per_runner": 256, "dataset_num_iters_per_eval_runner": 1, "keep_per_episode_custom_metrics": false, "metrics_episode_collection_timeout_s": 60.0, "metrics_num_episodes_for_smoothing": 100, "min_time_s_per_iteration": null, "min_train_timesteps_per_iteration": 0, "min_sample_timesteps_per_iteration": 0, "log_gradients": true, "export_native_model_files": false, "checkpoint_trainable_policies_only": false, "logger_creator": null, "logger_config": null, "log_level": "WARN", "log_sys_usage": true, "fake_sampler": false, "seed": 7, "restart_failed_env_runners": true, "ignore_env_runner_failures": false, "max_num_env_runner_restarts": 1000, "delay_between_env_runner_restarts_s": 60.0, "restart_failed_sub_environments": false, "num_consecutive_env_runner_failures_tolerance": 100, "env_runner_health_probe_timeout_s": 30.0, "env_runner_restore_timeout_s": 1800.0, "_model_config": {}, "_rl_module_spec": "RLModuleSpec(module_class=None, observation_space=None, action_space=None, inference_only=False, learner_only=False, model_config=DefaultModelConfig(fcnet_hiddens=[60, 90], fcnet_activation='tanh', fcnet_kernel_initializer=None, fcnet_kernel_initializer_kwargs=None, fcnet_bias_initializer=None, fcnet_bias_initializer_kwargs=None, conv_filters=None, conv_activation='relu', conv_kernel_initializer=None, conv_kernel_initializer_kwargs=None, conv_bias_initializer=None, conv_bias_initializer_kwargs=None, head_fcnet_hiddens=[], head_fcnet_activation='relu', head_fcnet_kernel_initializer=None, head_fcnet_kernel_initializer_kwargs=None, head_fcnet_bias_initializer=None, head_fcnet_bias_initializer_kwargs=None, free_log_std=False, log_std_clip_param=20.0, vf_share_layers=True, use_lstm=False, max_seq_len=20, lstm_cell_size=256, lstm_use_prev_action=False, lstm_use_prev_reward=False, lstm_kernel_initializer=None, lstm_kernel_initializer_kwargs=None, lstm_bias_initializer=None, lstm_bias_initializer_kwargs=None), catalog_class=None, load_state_path=None, model_config_dict=None)", "algorithm_config_overrides_per_module": {}, "_per_module_overrides": {}, "_validate_config": true, "_use_msgpack_checkpoints": false, "_torch_grad_scaler_class": null, "_torch_lr_scheduler_classes": null, "_tf_policy_handles_more_than_one_loss": false, "_disable_preprocessor_api": false, "_disable_action_flattening": false, "_disable_initialize_loss_from_dummy_batch": false, "_dont_auto_sync_env_runner_states": false, "env_task_fn": -1, "enable_connectors": -1, "simple_optimizer": false, "policy_map_cache": -1, "worker_cls": -1, "synchronize_filters": -1, "enable_async_evaluation": -1, "custom_async_evaluation_function": -1, "_enable_rl_module_api": -1, "auto_wrap_old_gym_envs": -1, "always_attach_evaluation_results": -1, "replay_sequence_length": null, "_disable_execution_plan_api": -1, "use_critic": true, "use_gae": true, "use_kl_loss": true, "kl_coeff": 0.7464963036515, "kl_target": 0.0270990929592, "vf_loss_coeff": 0.6688075857018, "entropy_coeff": 0.0090570820258, "clip_param": 0.1221781641624, "vf_clip_param": 0.1027808522125, "entropy_coeff_schedule": null, "lr_schedule": null, "sgd_minibatch_size": -1, "vf_share_layers": -1, "__stdout_file__": null, "__stderr_file__": null, "lambda": 0.9099046732075, "input": "sampler", "policies": {"default_policy": [null, null, null, null]}, "callbacks": "<class 'ray.rllib.callbacks.callbacks.RLlibCallback'>", "create_env_on_driver": false, "custom_eval_function": null, "framework": "torch"}, "time_since_restore": 21.775104761123657, "iterations_since_restore": 12, "perf": {"cpu_util_percent": 40.53333333333333, "ram_util_percent": 78.5}}
{"timers": {"training_iteration": 2.1043523822448864, "restore_env_runners": 1.0092245858946365e-05, "training_step": 2.103965060384091, "env_runner_sampling_timer": 1.875947853228663, "learner_update_timer": 0.21696041689271414, "synch_weights": 0.005956790529376613, "restore_eval_env_runners": 9.190169889119055e-05, "evaluation_iteration": 0.1694321863383249, "synch_eval_env_connectors": 0.00031644307953888835, "synch_env_connectors": 6.382672781185624e-06}, "env_runners": {"num_agent_steps_sampled_lifetime": {"default_agent": -6782500.0}, "env_to_module_connector": {"timers": {"connectors": {"numpy_to_tensor": 9.820556191584882e-06, "batch_individual_items": 8.018907572431643e-06, "add_observations_from_episodes_to_batch": 3.3566479157064268e-06, "add_time_dim_to_batch_and_zero_pad": 2.7508731250856613e-06, "add_states_from_episodes_to_batch": 1.940996904163001e-06}}, "connector_pipeline_timer": 5.005502068762228e-05}, "module_to_env_connector": {"timers": {"connectors": {"get_actions": 4.447485982767203e-05, "normalize_and_clip_actions": 1.0828191469551745e-05, "listify_data_for_vector_env": 1.2179479980333658e-05, "remove_single_ts_time_rank_from_batch": 6.652383744258949e-07, "tensor_to_numpy": 1.4762911489201298e-05, "un_batch_to_individual_items": 6.328972219675433e-06}}, "connector_pipeline_timer": 0.0001179562674304461}, "time_between_sampling": 0.0018406916610140965, "agent_episode_returns_mean": {"default_agent": 6.419999999999999}, "sample": 0.005151191798992337, "env_to_module_sum_episodes_length_out": 10.36823839457432, "num_env_steps_sampled": 5000.0, "num_agent_steps_sampled": {"default_agent": 5000.0}, "module_episode_returns_mean": {"default_policy": 6.419999999999999}, "env_reset_timer": 3.675905589038432e-05, "episode_return_max": 10.5, "episode_len_min": 20, "episode_return_mean": 6.419999999999999, "num_episodes_lifetime": -339125.0, "env_to_module_sum_episodes_length_in": 10.36823839457432, "num_episodes": 250.0, "num_module_steps_sampled_lifetime": {"default_policy": -6782500.0}, "episode_return_min": -9.5, "episode_len_mean": 20.0, "episode_duration_sec_mean": 0.005274253206793219, "weights_seq_no": 12.0, "episode_len_max": 20, "num_env_steps_sampled_lifetime": -6782500.0, "env_step_timer": 1.6049432937121694e-05, "rlmodule_inference_timer": 3.323975646160873e-05, "num_module_steps_sampled": {"default_policy": 5000.0}, "num_env_steps_sampled_lifetime_throughput": 3466.8492919588443}, "learners": {"default_policy": {"diff_num_grad_updates_vs_sampler_policy": 1.0, "curr_entropy_coeff": 0.0090570820258, "policy_loss": 0.012701627798378468, "default_optimizer_learning_rate": 0.0002847858517, "num_trainable_parameters": 6003, "num_module_steps_trained_lifetime": 78000, "weights_seq_no": 13.0, "vf_loss_unclipped": 28.251325607299805, "num_module_steps_trained": 6000, "mean_kl_loss": 0.00015232563600875437, "curr_kl_coeff": 9.112503903452307e-05, "entropy": 0.5557562112808228, "module_train_batch_size_mean": 1000.0, "gradients_default_optimizer_global_norm": 0.03824322298169136, "vf_loss": 0.10278083384037018, "vf_explained_var": -0.010016202926635742, "total_loss": 0.0764087438583374, "num_module_steps_trained_lifetime_throughput": 225279.91396369055}, "__all_modules__": {"num_trainable_parameters": 6003, "learner_connector_sum_episodes_length_in": 5000.0, "learner_connector": {"timers": {"connectors": {"batch_individual_items": 0.06419876213870473, "add_columns_from_episodes_to_train_batch": 0.046090565175015336, "add_one_ts_to_episodes_and_truncate": 0.015038842449264055, "add_observations_from_episodes_to_batch": 0.0008754054875292683, "add_states_from_episodes_to_batch": 8.23160739842861e-06, "general_advantage_estimation": 0.013780010477221055, "add_time_dim_to_batch_and_zero_pad": 5.626257547060798e-05, "numpy_to_tensor": 0.00014598178611229418}}, "connector_pipeline_timer": 0.14056342835978022}, "num_env_steps_trained_lifetime": 409500, "num_env_steps_trained": 31500, "num_non_trainable_parameters": 0, "num_module_steps_trained_lifetime": 78000, "num_module_steps_trained": 6000, "learner_connector_sum_episodes_length_out": 5250.0, "num_env_steps_trained_lifetime_throughput": 1181528.0170866984, "num_module_steps_trained_throughput": 225374.89881369323, "num_module_steps_trained_lifetime_throughput": 225244.26878947415}}, "num_training_step_calls_per_iteration": 1, "evaluation": {"env_runners": {"episode_len_mean": 20.0, "module_to_env_connector": {"connector_pipeline_timer": 0.00011361410366219728, "timers": {"connectors": {"remove_single_ts_time_rank_from_batch": 6.001998081806716e-07, "tensor_to_numpy": 1.4402027902053032e-05, "normalize_and_clip_actions": 1.0693608364519816e-05, "listify_data_for_vector_env": 1.2546563085863437e-05, "un_batch_to_individual_items": 5.831351407326711e-06, "get_actions": 4.234318059647159e-05}}}, "num_env_steps_sampled_lifetime": 65400, "rlmodule_inference_timer": 3.0392821988803043e-05, "env_to_module_connector": {"timers": {"connectors": {"add_time_dim_to_batch_and_zero_pad": 2.999075339297854e-06, "numpy_to_tensor": 9.336804491368123e-06, "batch_individual_items": 6.813089798399932e-06, "add_states_from_episodes_to_batch": 1.663281008489419e-06, "add_observations_from_episodes_to_batch": 3.105801872180021e-06}}, "connector_pipeline_timer": 4.678269313191569e-05}, "num_episodes_lifetime": 260, "weights_seq_no": 13.0, "episode_len_max": 20, "sample": 0.14294172826920615, "episode_return_max": 14.5, "env_reset_timer": 0.0006438154108037544, "agent_episode_returns_mean": {"default_agent": -1.15}, "module_episode_returns_mean": {"default_policy": -1.15}, "num_episodes": 20, "episode_return_min": -12.5, "episode_duration_sec_mean": 0.004656692481366917, "num_module_steps_sampled": {"default_policy": 400}, "num_env_steps_sampled": 400, "num_agent_steps_sampled_lifetime": {"default_agent": 5200}, "env_to_module_sum_episodes_length_in": 10.368238394574323, "num_agent_steps_sampled": {"default_agent": 400}, "env_step_timer": 1.6819455552228437e-05, "num_module_steps_sampled_lifetime": {"default_policy": 5200}, "env_to_module_sum_episodes_length_out": 10.368238394574323, "episode_len_min": 20, "episode_return_mean": -1.15, "time_between_sampling": 1.8901846543071077}, "num_healthy_workers": 1, "actor_manager_num_outstanding_async_reqs": 0, "num_remote_worker_restarts": 0}, "num_env_steps_sampled_lifetime": -6782500.0, "fault_tolerance": {"num_healthy_workers": 0, "num_remote_worker_restarts": 0}, "env_runner_group": {"actor_manager_num_outstanding_async_reqs": 0}, "done": false, "training_iteration": 13, "trial_id": "4da12_00000", "date": "2025-08-11_19-21-57", "timestamp": 1754932917, "time_this_iter_s": 2.0311360359191895, "time_total_s": 23.806240797042847, "pid": 14324, "hostname": "Mac", "node_ip": "127.0.0.1", "config": {"exploration_config": {}, "extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "placement_strategy": "PACK", "num_gpus": 0, "_fake_gpus": false, "num_cpus_for_main_process": 2, "eager_tracing": true, "eager_max_retraces": 20, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "torch_compile_learner": false, "torch_compile_learner_what_to_compile": "forward_train", "torch_compile_learner_dynamo_backend": "aot_eager", "torch_compile_learner_dynamo_mode": null, "torch_compile_worker": false, "torch_compile_worker_dynamo_backend": "aot_eager", "torch_compile_worker_dynamo_mode": null, "torch_ddp_kwargs": {}, "torch_skip_nan_gradients": false, "env": "Umbrella", "env_config": {}, "observation_space": null, "action_space": null, "clip_rewards": null, "normalize_actions": true, "clip_actions": false, "_is_atari": null, "disable_env_checking": false, "render_env": false, "action_mask_key": "action_mask", "env_runner_cls": null, "num_env_runners": 0, "create_local_env_runner": true, "num_envs_per_env_runner": 1, "gym_env_vectorize_mode": "SYNC", "num_cpus_per_env_runner": 1, "num_gpus_per_env_runner": 0, "custom_resources_per_env_runner": {}, "validate_env_runners_after_construction": true, "episodes_to_numpy": true, "max_requests_in_flight_per_env_runner": 1, "sample_timeout_s": 60.0, "_env_to_module_connector": null, "add_default_connectors_to_env_to_module_pipeline": true, "_module_to_env_connector": null, "add_default_connectors_to_module_to_env_pipeline": true, "merge_env_runner_states": "training_only", "broadcast_env_runner_states": true, "episode_lookback_horizon": 1, "rollout_fragment_length": "auto", "batch_mode": "complete_episodes", "compress_observations": false, "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "enable_tf1_exec_eagerly": false, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "preprocessor_pref": "deepmind", "observation_filter": "NoFilter", "update_worker_filter_stats": true, "use_worker_filter_stats": true, "sampler_perf_stats_ema_coef": null, "_is_online": true, "num_learners": 0, "num_gpus_per_learner": 0, "num_cpus_per_learner": "auto", "num_aggregator_actors_per_learner": 0, "max_requests_in_flight_per_aggregator_actor": 3, "local_gpu_idx": 0, "max_requests_in_flight_per_learner": 3, "gamma": 1, "lr": 0.0002847858517, "grad_clip": 0.5, "grad_clip_by": "global_norm", "_train_batch_size_per_learner": 5000, "train_batch_size": 4000, "num_epochs": 1, "minibatch_size": 1000, "shuffle_batch_per_epoch": true, "model": {"fcnet_hiddens": [256, 256], "fcnet_activation": "tanh", "fcnet_weights_initializer": null, "fcnet_weights_initializer_config": null, "fcnet_bias_initializer": null, "fcnet_bias_initializer_config": null, "conv_filters": null, "conv_activation": "relu", "conv_kernel_initializer": null, "conv_kernel_initializer_config": null, "conv_bias_initializer": null, "conv_bias_initializer_config": null, "conv_transpose_kernel_initializer": null, "conv_transpose_kernel_initializer_config": null, "conv_transpose_bias_initializer": null, "conv_transpose_bias_initializer_config": null, "post_fcnet_hiddens": [], "post_fcnet_activation": "relu", "post_fcnet_weights_initializer": null, "post_fcnet_weights_initializer_config": null, "post_fcnet_bias_initializer": null, "post_fcnet_bias_initializer_config": null, "free_log_std": false, "log_std_clip_param": 20.0, "no_final_linear": false, "vf_share_layers": false, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "lstm_weights_initializer": null, "lstm_weights_initializer_config": null, "lstm_bias_initializer": null, "lstm_bias_initializer_config": null, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "attention_use_n_prev_actions": 0, "attention_use_n_prev_rewards": 0, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": null, "custom_model_config": {}, "custom_action_dist": null, "custom_preprocessor": null, "encoder_latent_dim": null, "always_check_shapes": false, "lstm_use_prev_action_reward": -1, "_use_default_native_models": -1, "_disable_preprocessor_api": false, "_disable_action_flattening": false}, "_learner_connector": null, "add_default_connectors_to_learner_pipeline": true, "learner_config_dict": {}, "optimizer": {}, "_learner_class": null, "callbacks_on_algorithm_init": null, "callbacks_on_env_runners_recreated": null, "callbacks_on_offline_eval_runners_recreated": null, "callbacks_on_checkpoint_loaded": null, "callbacks_on_environment_created": null, "callbacks_on_episode_created": null, "callbacks_on_episode_start": null, "callbacks_on_episode_step": null, "callbacks_on_episode_end": null, "callbacks_on_evaluate_start": null, "callbacks_on_evaluate_end": null, "callbacks_on_evaluate_offline_start": null, "callbacks_on_evaluate_offline_end": null, "callbacks_on_sample_end": null, "callbacks_on_train_result": null, "explore": true, "enable_rl_module_and_learner": true, "enable_env_runner_and_connector_v2": true, "_prior_exploration_config": {"type": "StochasticSampling"}, "count_steps_by": "env_steps", "policy_map_capacity": 100, "policy_mapping_fn": "<function AlgorithmConfig.DEFAULT_POLICY_MAPPING_FN at 0x385eedb20>", "policies_to_train": null, "policy_states_are_swappable": false, "observation_fn": null, "offline_data_class": null, "input_read_method": "read_parquet", "input_read_method_kwargs": {}, "input_read_schema": {}, "input_read_episodes": false, "input_read_sample_batches": false, "input_read_batch_size": null, "input_filesystem": null, "input_filesystem_kwargs": {}, "input_compress_columns": ["obs", "new_obs"], "input_spaces_jsonable": true, "materialize_data": false, "materialize_mapped_data": true, "map_batches_kwargs": {}, "iter_batches_kwargs": {}, "ignore_final_observation": false, "prelearner_class": null, "prelearner_buffer_class": null, "prelearner_buffer_kwargs": {}, "prelearner_module_synch_period": 10, "dataset_num_iters_per_learner": null, "input_config": {}, "actions_in_input_normalized": false, "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_config": {}, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "output_max_rows_per_file": null, "output_write_remaining_data": false, "output_write_method": "write_parquet", "output_write_method_kwargs": {}, "output_filesystem": null, "output_filesystem_kwargs": {}, "output_write_episodes": true, "offline_sampling": false, "evaluation_interval": 1, "evaluation_duration": 20, "evaluation_duration_unit": "episodes", "evaluation_sample_timeout_s": 120.0, "evaluation_auto_duration_min_env_steps_per_sample": 100, "evaluation_auto_duration_max_env_steps_per_sample": 2000, "evaluation_parallel_to_training": false, "evaluation_force_reset_envs_before_iteration": true, "evaluation_config": null, "off_policy_estimation_methods": {}, "ope_split_batch_by_episode": true, "evaluation_num_env_runners": 1, "in_evaluation": false, "sync_filters_on_rollout_workers_timeout_s": 10.0, "offline_evaluation_interval": null, "num_offline_eval_runners": 0, "offline_loss_for_module_fn": null, "offline_evaluation_duration": 1, "offline_evaluation_parallel_to_training": false, "offline_evaluation_timeout_s": 120.0, "num_cpus_per_offline_eval_runner": 1, "num_gpus_per_offline_eval_runner": 0, "custom_resources_per_offline_eval_runner": {}, "restart_failed_offline_eval_runners": true, "ignore_offline_eval_runner_failures": false, "max_num_offline_eval_runner_restarts": 1000, "offline_eval_runner_restore_timeout_s": 1800.0, "max_requests_in_flight_per_offline_eval_runner": 1, "validate_offline_eval_runners_after_construction": true, "offline_eval_runner_health_probe_timeout_s": 30.0, "offline_eval_rl_module_inference_only": false, "broadcast_offline_eval_runner_states": false, "offline_eval_batch_size_per_runner": 256, "dataset_num_iters_per_eval_runner": 1, "keep_per_episode_custom_metrics": false, "metrics_episode_collection_timeout_s": 60.0, "metrics_num_episodes_for_smoothing": 100, "min_time_s_per_iteration": null, "min_train_timesteps_per_iteration": 0, "min_sample_timesteps_per_iteration": 0, "log_gradients": true, "export_native_model_files": false, "checkpoint_trainable_policies_only": false, "logger_creator": null, "logger_config": null, "log_level": "WARN", "log_sys_usage": true, "fake_sampler": false, "seed": 7, "restart_failed_env_runners": true, "ignore_env_runner_failures": false, "max_num_env_runner_restarts": 1000, "delay_between_env_runner_restarts_s": 60.0, "restart_failed_sub_environments": false, "num_consecutive_env_runner_failures_tolerance": 100, "env_runner_health_probe_timeout_s": 30.0, "env_runner_restore_timeout_s": 1800.0, "_model_config": {}, "_rl_module_spec": "RLModuleSpec(module_class=None, observation_space=None, action_space=None, inference_only=False, learner_only=False, model_config=DefaultModelConfig(fcnet_hiddens=[60, 90], fcnet_activation='tanh', fcnet_kernel_initializer=None, fcnet_kernel_initializer_kwargs=None, fcnet_bias_initializer=None, fcnet_bias_initializer_kwargs=None, conv_filters=None, conv_activation='relu', conv_kernel_initializer=None, conv_kernel_initializer_kwargs=None, conv_bias_initializer=None, conv_bias_initializer_kwargs=None, head_fcnet_hiddens=[], head_fcnet_activation='relu', head_fcnet_kernel_initializer=None, head_fcnet_kernel_initializer_kwargs=None, head_fcnet_bias_initializer=None, head_fcnet_bias_initializer_kwargs=None, free_log_std=False, log_std_clip_param=20.0, vf_share_layers=True, use_lstm=False, max_seq_len=20, lstm_cell_size=256, lstm_use_prev_action=False, lstm_use_prev_reward=False, lstm_kernel_initializer=None, lstm_kernel_initializer_kwargs=None, lstm_bias_initializer=None, lstm_bias_initializer_kwargs=None), catalog_class=None, load_state_path=None, model_config_dict=None)", "algorithm_config_overrides_per_module": {}, "_per_module_overrides": {}, "_validate_config": true, "_use_msgpack_checkpoints": false, "_torch_grad_scaler_class": null, "_torch_lr_scheduler_classes": null, "_tf_policy_handles_more_than_one_loss": false, "_disable_preprocessor_api": false, "_disable_action_flattening": false, "_disable_initialize_loss_from_dummy_batch": false, "_dont_auto_sync_env_runner_states": false, "env_task_fn": -1, "enable_connectors": -1, "simple_optimizer": false, "policy_map_cache": -1, "worker_cls": -1, "synchronize_filters": -1, "enable_async_evaluation": -1, "custom_async_evaluation_function": -1, "_enable_rl_module_api": -1, "auto_wrap_old_gym_envs": -1, "always_attach_evaluation_results": -1, "replay_sequence_length": null, "_disable_execution_plan_api": -1, "use_critic": true, "use_gae": true, "use_kl_loss": true, "kl_coeff": 0.7464963036515, "kl_target": 0.0270990929592, "vf_loss_coeff": 0.6688075857018, "entropy_coeff": 0.0090570820258, "clip_param": 0.1221781641624, "vf_clip_param": 0.1027808522125, "entropy_coeff_schedule": null, "lr_schedule": null, "sgd_minibatch_size": -1, "vf_share_layers": -1, "__stdout_file__": null, "__stderr_file__": null, "lambda": 0.9099046732075, "input": "sampler", "policies": {"default_policy": [null, null, null, null]}, "callbacks": "<class 'ray.rllib.callbacks.callbacks.RLlibCallback'>", "create_env_on_driver": false, "custom_eval_function": null, "framework": "torch"}, "time_since_restore": 23.806240797042847, "iterations_since_restore": 13, "perf": {"cpu_util_percent": 52.23333333333333, "ram_util_percent": 81.56666666666668}}
{"timers": {"training_iteration": 2.1006375450923724, "restore_env_runners": 1.0052572993629708e-05, "training_step": 2.1002522381205515, "env_runner_sampling_timer": 1.8724007176066122, "learner_update_timer": 0.21687473231459173, "synch_weights": 0.0059028909547876405, "restore_eval_env_runners": 9.148393135346888e-05, "evaluation_iteration": 0.16903879530512603, "synch_eval_env_connectors": 0.0003144190590568822, "synch_env_connectors": 6.400096963089659e-06}, "env_runners": {"num_agent_steps_sampled_lifetime": {"default_agent": -7400000.0}, "env_to_module_connector": {"timers": {"connectors": {"numpy_to_tensor": 9.345106901867256e-06, "batch_individual_items": 6.670424789092092e-06, "add_observations_from_episodes_to_batch": 3.167707623071952e-06, "add_time_dim_to_batch_and_zero_pad": 2.594222902800805e-06, "add_states_from_episodes_to_batch": 1.8135340803030324e-06}}, "connector_pipeline_timer": 4.647831443701503e-05}, "module_to_env_connector": {"timers": {"connectors": {"get_actions": 4.284499967750192e-05, "normalize_and_clip_actions": 1.1524676616627647e-05, "listify_data_for_vector_env": 1.1665512056267934e-05, "remove_single_ts_time_rank_from_batch": 6.062978613426223e-07, "tensor_to_numpy": 1.4429056996870192e-05, "un_batch_to_individual_items": 5.660690649679178e-06}}, "connector_pipeline_timer": 0.00011402893156251315}, "time_between_sampling": 0.002219970234585694, "agent_episode_returns_mean": {"default_agent": 6.74}, "sample": 0.005518497273008986, "env_to_module_sum_episodes_length_out": 10.36823839457432, "num_env_steps_sampled": 5000.0, "num_agent_steps_sampled": {"default_agent": 5000.0}, "module_episode_returns_mean": {"default_policy": 6.74}, "env_reset_timer": 4.167353178090606e-05, "episode_return_max": 10.5, "episode_len_min": 20, "episode_return_mean": 6.74, "num_episodes_lifetime": -370000.0, "env_to_module_sum_episodes_length_in": 10.36823839457432, "num_episodes": 250.0, "num_module_steps_sampled_lifetime": {"default_policy": -7400000.0}, "episode_return_min": -9.5, "episode_len_mean": 20.0, "episode_duration_sec_mean": 0.004988136011641472, "weights_seq_no": 13.0, "episode_len_max": 20, "num_env_steps_sampled_lifetime": -7400000.0, "env_step_timer": 1.4752379396608077e-05, "rlmodule_inference_timer": 3.212602206891034e-05, "num_module_steps_sampled": {"default_policy": 5000.0}, "num_env_steps_sampled_lifetime_throughput": 3526.3837559485346}, "learners": {"default_policy": {"diff_num_grad_updates_vs_sampler_policy": 1.0, "curr_entropy_coeff": 0.0090570820258, "policy_loss": -0.1991647630929947, "default_optimizer_learning_rate": 0.0002847858517, "num_trainable_parameters": 6003, "num_module_steps_trained_lifetime": 84000, "weights_seq_no": 14.0, "vf_loss_unclipped": 27.92440414428711, "num_module_steps_trained": 6000, "mean_kl_loss": 5.350949504645541e-05, "curr_kl_coeff": 4.5562519517261535e-05, "entropy": 0.5543418526649475, "module_train_batch_size_mean": 1000.0, "gradients_default_optimizer_global_norm": 0.028520269319415092, "vf_loss": 0.10278083384037018, "vf_explained_var": -0.008661389350891113, "total_loss": -0.13544487953186035, "num_module_steps_trained_lifetime_throughput": 232189.55335282866}, "__all_modules__": {"num_trainable_parameters": 6003, "learner_connector_sum_episodes_length_in": 5000.0, "learner_connector": {"timers": {"connectors": {"batch_individual_items": 0.06493485201642049, "add_columns_from_episodes_to_train_batch": 0.046023867023186504, "add_one_ts_to_episodes_and_truncate": 0.01497795235467907, "add_observations_from_episodes_to_batch": 0.0008772043523565799, "add_states_from_episodes_to_batch": 8.182211249150545e-06, "general_advantage_estimation": 0.013696672872132568, "add_time_dim_to_batch_and_zero_pad": 5.5848699393366265e-05, "numpy_to_tensor": 0.00014514071801498783}}, "connector_pipeline_timer": 0.14108681157597017}, "num_env_steps_trained_lifetime": 441000, "num_env_steps_trained": 31500, "num_non_trainable_parameters": 0, "num_module_steps_trained_lifetime": 84000, "num_module_steps_trained": 6000, "learner_connector_sum_episodes_length_out": 5250.0, "num_env_steps_trained_lifetime_throughput": 1217949.5408334015, "num_module_steps_trained_throughput": 232308.52162521458, "num_module_steps_trained_lifetime_throughput": 232176.19079694123}}, "num_training_step_calls_per_iteration": 1, "evaluation": {"env_runners": {"episode_len_mean": 20.0, "module_to_env_connector": {"connector_pipeline_timer": 0.00010087878310730866, "timers": {"connectors": {"remove_single_ts_time_rank_from_batch": 5.678119742389495e-07, "tensor_to_numpy": 1.295447414806921e-05, "normalize_and_clip_actions": 9.438185951815058e-06, "listify_data_for_vector_env": 1.121984371386919e-05, "un_batch_to_individual_items": 5.4584964352612675e-06, "get_actions": 3.5745760134800763e-05}}}, "num_env_steps_sampled_lifetime": 70400, "rlmodule_inference_timer": 2.696334639639804e-05, "env_to_module_connector": {"timers": {"connectors": {"add_time_dim_to_batch_and_zero_pad": 2.283911443801697e-06, "numpy_to_tensor": 8.37682343958919e-06, "batch_individual_items": 6.232528475627195e-06, "add_states_from_episodes_to_batch": 1.6321296834039303e-06, "add_observations_from_episodes_to_batch": 2.88509484142838e-06}}, "connector_pipeline_timer": 4.316665893857202e-05}, "num_episodes_lifetime": 280, "weights_seq_no": 14.0, "episode_len_max": 20, "sample": 0.14251830181653136, "episode_return_max": 14.5, "env_reset_timer": 0.000638053926574602, "agent_episode_returns_mean": {"default_agent": -1.15}, "module_episode_returns_mean": {"default_policy": -1.15}, "num_episodes": 20, "episode_return_min": -12.5, "episode_duration_sec_mean": 0.004654328732285649, "num_module_steps_sampled": {"default_policy": 400}, "num_env_steps_sampled": 400, "num_agent_steps_sampled_lifetime": {"default_agent": 5600}, "env_to_module_sum_episodes_length_in": 10.368238394574323, "num_agent_steps_sampled": {"default_agent": 400}, "env_step_timer": 1.4133968966214386e-05, "num_module_steps_sampled_lifetime": {"default_policy": 5600}, "env_to_module_sum_episodes_length_out": 10.368238394574323, "episode_len_min": 20, "episode_return_mean": -1.15, "time_between_sampling": 1.888870413184304}, "num_healthy_workers": 1, "actor_manager_num_outstanding_async_reqs": 0, "num_remote_worker_restarts": 0}, "num_env_steps_sampled_lifetime": -7400000.0, "fault_tolerance": {"num_healthy_workers": 0, "num_remote_worker_restarts": 0}, "env_runner_group": {"actor_manager_num_outstanding_async_reqs": 0}, "done": false, "training_iteration": 14, "trial_id": "4da12_00000", "date": "2025-08-11_19-21-59", "timestamp": 1754932919, "time_this_iter_s": 1.8419609069824219, "time_total_s": 25.64820170402527, "pid": 14324, "hostname": "Mac", "node_ip": "127.0.0.1", "config": {"exploration_config": {}, "extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "placement_strategy": "PACK", "num_gpus": 0, "_fake_gpus": false, "num_cpus_for_main_process": 2, "eager_tracing": true, "eager_max_retraces": 20, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "torch_compile_learner": false, "torch_compile_learner_what_to_compile": "forward_train", "torch_compile_learner_dynamo_backend": "aot_eager", "torch_compile_learner_dynamo_mode": null, "torch_compile_worker": false, "torch_compile_worker_dynamo_backend": "aot_eager", "torch_compile_worker_dynamo_mode": null, "torch_ddp_kwargs": {}, "torch_skip_nan_gradients": false, "env": "Umbrella", "env_config": {}, "observation_space": null, "action_space": null, "clip_rewards": null, "normalize_actions": true, "clip_actions": false, "_is_atari": null, "disable_env_checking": false, "render_env": false, "action_mask_key": "action_mask", "env_runner_cls": null, "num_env_runners": 0, "create_local_env_runner": true, "num_envs_per_env_runner": 1, "gym_env_vectorize_mode": "SYNC", "num_cpus_per_env_runner": 1, "num_gpus_per_env_runner": 0, "custom_resources_per_env_runner": {}, "validate_env_runners_after_construction": true, "episodes_to_numpy": true, "max_requests_in_flight_per_env_runner": 1, "sample_timeout_s": 60.0, "_env_to_module_connector": null, "add_default_connectors_to_env_to_module_pipeline": true, "_module_to_env_connector": null, "add_default_connectors_to_module_to_env_pipeline": true, "merge_env_runner_states": "training_only", "broadcast_env_runner_states": true, "episode_lookback_horizon": 1, "rollout_fragment_length": "auto", "batch_mode": "complete_episodes", "compress_observations": false, "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "enable_tf1_exec_eagerly": false, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "preprocessor_pref": "deepmind", "observation_filter": "NoFilter", "update_worker_filter_stats": true, "use_worker_filter_stats": true, "sampler_perf_stats_ema_coef": null, "_is_online": true, "num_learners": 0, "num_gpus_per_learner": 0, "num_cpus_per_learner": "auto", "num_aggregator_actors_per_learner": 0, "max_requests_in_flight_per_aggregator_actor": 3, "local_gpu_idx": 0, "max_requests_in_flight_per_learner": 3, "gamma": 1, "lr": 0.0002847858517, "grad_clip": 0.5, "grad_clip_by": "global_norm", "_train_batch_size_per_learner": 5000, "train_batch_size": 4000, "num_epochs": 1, "minibatch_size": 1000, "shuffle_batch_per_epoch": true, "model": {"fcnet_hiddens": [256, 256], "fcnet_activation": "tanh", "fcnet_weights_initializer": null, "fcnet_weights_initializer_config": null, "fcnet_bias_initializer": null, "fcnet_bias_initializer_config": null, "conv_filters": null, "conv_activation": "relu", "conv_kernel_initializer": null, "conv_kernel_initializer_config": null, "conv_bias_initializer": null, "conv_bias_initializer_config": null, "conv_transpose_kernel_initializer": null, "conv_transpose_kernel_initializer_config": null, "conv_transpose_bias_initializer": null, "conv_transpose_bias_initializer_config": null, "post_fcnet_hiddens": [], "post_fcnet_activation": "relu", "post_fcnet_weights_initializer": null, "post_fcnet_weights_initializer_config": null, "post_fcnet_bias_initializer": null, "post_fcnet_bias_initializer_config": null, "free_log_std": false, "log_std_clip_param": 20.0, "no_final_linear": false, "vf_share_layers": false, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "lstm_weights_initializer": null, "lstm_weights_initializer_config": null, "lstm_bias_initializer": null, "lstm_bias_initializer_config": null, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "attention_use_n_prev_actions": 0, "attention_use_n_prev_rewards": 0, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": null, "custom_model_config": {}, "custom_action_dist": null, "custom_preprocessor": null, "encoder_latent_dim": null, "always_check_shapes": false, "lstm_use_prev_action_reward": -1, "_use_default_native_models": -1, "_disable_preprocessor_api": false, "_disable_action_flattening": false}, "_learner_connector": null, "add_default_connectors_to_learner_pipeline": true, "learner_config_dict": {}, "optimizer": {}, "_learner_class": null, "callbacks_on_algorithm_init": null, "callbacks_on_env_runners_recreated": null, "callbacks_on_offline_eval_runners_recreated": null, "callbacks_on_checkpoint_loaded": null, "callbacks_on_environment_created": null, "callbacks_on_episode_created": null, "callbacks_on_episode_start": null, "callbacks_on_episode_step": null, "callbacks_on_episode_end": null, "callbacks_on_evaluate_start": null, "callbacks_on_evaluate_end": null, "callbacks_on_evaluate_offline_start": null, "callbacks_on_evaluate_offline_end": null, "callbacks_on_sample_end": null, "callbacks_on_train_result": null, "explore": true, "enable_rl_module_and_learner": true, "enable_env_runner_and_connector_v2": true, "_prior_exploration_config": {"type": "StochasticSampling"}, "count_steps_by": "env_steps", "policy_map_capacity": 100, "policy_mapping_fn": "<function AlgorithmConfig.DEFAULT_POLICY_MAPPING_FN at 0x385eedb20>", "policies_to_train": null, "policy_states_are_swappable": false, "observation_fn": null, "offline_data_class": null, "input_read_method": "read_parquet", "input_read_method_kwargs": {}, "input_read_schema": {}, "input_read_episodes": false, "input_read_sample_batches": false, "input_read_batch_size": null, "input_filesystem": null, "input_filesystem_kwargs": {}, "input_compress_columns": ["obs", "new_obs"], "input_spaces_jsonable": true, "materialize_data": false, "materialize_mapped_data": true, "map_batches_kwargs": {}, "iter_batches_kwargs": {}, "ignore_final_observation": false, "prelearner_class": null, "prelearner_buffer_class": null, "prelearner_buffer_kwargs": {}, "prelearner_module_synch_period": 10, "dataset_num_iters_per_learner": null, "input_config": {}, "actions_in_input_normalized": false, "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_config": {}, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "output_max_rows_per_file": null, "output_write_remaining_data": false, "output_write_method": "write_parquet", "output_write_method_kwargs": {}, "output_filesystem": null, "output_filesystem_kwargs": {}, "output_write_episodes": true, "offline_sampling": false, "evaluation_interval": 1, "evaluation_duration": 20, "evaluation_duration_unit": "episodes", "evaluation_sample_timeout_s": 120.0, "evaluation_auto_duration_min_env_steps_per_sample": 100, "evaluation_auto_duration_max_env_steps_per_sample": 2000, "evaluation_parallel_to_training": false, "evaluation_force_reset_envs_before_iteration": true, "evaluation_config": null, "off_policy_estimation_methods": {}, "ope_split_batch_by_episode": true, "evaluation_num_env_runners": 1, "in_evaluation": false, "sync_filters_on_rollout_workers_timeout_s": 10.0, "offline_evaluation_interval": null, "num_offline_eval_runners": 0, "offline_loss_for_module_fn": null, "offline_evaluation_duration": 1, "offline_evaluation_parallel_to_training": false, "offline_evaluation_timeout_s": 120.0, "num_cpus_per_offline_eval_runner": 1, "num_gpus_per_offline_eval_runner": 0, "custom_resources_per_offline_eval_runner": {}, "restart_failed_offline_eval_runners": true, "ignore_offline_eval_runner_failures": false, "max_num_offline_eval_runner_restarts": 1000, "offline_eval_runner_restore_timeout_s": 1800.0, "max_requests_in_flight_per_offline_eval_runner": 1, "validate_offline_eval_runners_after_construction": true, "offline_eval_runner_health_probe_timeout_s": 30.0, "offline_eval_rl_module_inference_only": false, "broadcast_offline_eval_runner_states": false, "offline_eval_batch_size_per_runner": 256, "dataset_num_iters_per_eval_runner": 1, "keep_per_episode_custom_metrics": false, "metrics_episode_collection_timeout_s": 60.0, "metrics_num_episodes_for_smoothing": 100, "min_time_s_per_iteration": null, "min_train_timesteps_per_iteration": 0, "min_sample_timesteps_per_iteration": 0, "log_gradients": true, "export_native_model_files": false, "checkpoint_trainable_policies_only": false, "logger_creator": null, "logger_config": null, "log_level": "WARN", "log_sys_usage": true, "fake_sampler": false, "seed": 7, "restart_failed_env_runners": true, "ignore_env_runner_failures": false, "max_num_env_runner_restarts": 1000, "delay_between_env_runner_restarts_s": 60.0, "restart_failed_sub_environments": false, "num_consecutive_env_runner_failures_tolerance": 100, "env_runner_health_probe_timeout_s": 30.0, "env_runner_restore_timeout_s": 1800.0, "_model_config": {}, "_rl_module_spec": "RLModuleSpec(module_class=None, observation_space=None, action_space=None, inference_only=False, learner_only=False, model_config=DefaultModelConfig(fcnet_hiddens=[60, 90], fcnet_activation='tanh', fcnet_kernel_initializer=None, fcnet_kernel_initializer_kwargs=None, fcnet_bias_initializer=None, fcnet_bias_initializer_kwargs=None, conv_filters=None, conv_activation='relu', conv_kernel_initializer=None, conv_kernel_initializer_kwargs=None, conv_bias_initializer=None, conv_bias_initializer_kwargs=None, head_fcnet_hiddens=[], head_fcnet_activation='relu', head_fcnet_kernel_initializer=None, head_fcnet_kernel_initializer_kwargs=None, head_fcnet_bias_initializer=None, head_fcnet_bias_initializer_kwargs=None, free_log_std=False, log_std_clip_param=20.0, vf_share_layers=True, use_lstm=False, max_seq_len=20, lstm_cell_size=256, lstm_use_prev_action=False, lstm_use_prev_reward=False, lstm_kernel_initializer=None, lstm_kernel_initializer_kwargs=None, lstm_bias_initializer=None, lstm_bias_initializer_kwargs=None), catalog_class=None, load_state_path=None, model_config_dict=None)", "algorithm_config_overrides_per_module": {}, "_per_module_overrides": {}, "_validate_config": true, "_use_msgpack_checkpoints": false, "_torch_grad_scaler_class": null, "_torch_lr_scheduler_classes": null, "_tf_policy_handles_more_than_one_loss": false, "_disable_preprocessor_api": false, "_disable_action_flattening": false, "_disable_initialize_loss_from_dummy_batch": false, "_dont_auto_sync_env_runner_states": false, "env_task_fn": -1, "enable_connectors": -1, "simple_optimizer": false, "policy_map_cache": -1, "worker_cls": -1, "synchronize_filters": -1, "enable_async_evaluation": -1, "custom_async_evaluation_function": -1, "_enable_rl_module_api": -1, "auto_wrap_old_gym_envs": -1, "always_attach_evaluation_results": -1, "replay_sequence_length": null, "_disable_execution_plan_api": -1, "use_critic": true, "use_gae": true, "use_kl_loss": true, "kl_coeff": 0.7464963036515, "kl_target": 0.0270990929592, "vf_loss_coeff": 0.6688075857018, "entropy_coeff": 0.0090570820258, "clip_param": 0.1221781641624, "vf_clip_param": 0.1027808522125, "entropy_coeff_schedule": null, "lr_schedule": null, "sgd_minibatch_size": -1, "vf_share_layers": -1, "__stdout_file__": null, "__stderr_file__": null, "lambda": 0.9099046732075, "input": "sampler", "policies": {"default_policy": [null, null, null, null]}, "callbacks": "<class 'ray.rllib.callbacks.callbacks.RLlibCallback'>", "create_env_on_driver": false, "custom_eval_function": null, "framework": "torch"}, "time_since_restore": 25.64820170402527, "iterations_since_restore": 14, "perf": {"cpu_util_percent": 48.099999999999994, "ram_util_percent": 82.9}}
{"timers": {"training_iteration": 2.0957796279718752, "restore_env_runners": 1.0007876559581955e-05, "training_step": 2.095396392410106, "env_runner_sampling_timer": 1.8679169004296552, "learner_update_timer": 0.21657498832180316, "synch_weights": 0.005853779134722533, "restore_eval_env_runners": 9.063575261736551e-05, "evaluation_iteration": 0.16841594651221461, "synch_eval_env_connectors": 0.00031296902804857065, "synch_env_connectors": 6.376926339283124e-06}, "env_runners": {"num_agent_steps_sampled_lifetime": {"default_agent": -8017500.0}, "env_to_module_connector": {"timers": {"connectors": {"numpy_to_tensor": 8.802598457662012e-06, "batch_individual_items": 6.468998954376005e-06, "add_observations_from_episodes_to_batch": 3.160851776303332e-06, "add_time_dim_to_batch_and_zero_pad": 2.5393433464243507e-06, "add_states_from_episodes_to_batch": 1.7899746005165806e-06}}, "connector_pipeline_timer": 4.498041330164725e-05}, "module_to_env_connector": {"timers": {"connectors": {"get_actions": 4.037637614057718e-05, "normalize_and_clip_actions": 9.732682895365243e-06, "listify_data_for_vector_env": 1.1304412164848989e-05, "remove_single_ts_time_rank_from_batch": 5.902261343679147e-07, "tensor_to_numpy": 1.3555034406968126e-05, "un_batch_to_individual_items": 5.523882498398958e-06}}, "connector_pipeline_timer": 0.00010737186445038994}, "time_between_sampling": 0.002055126181505965, "agent_episode_returns_mean": {"default_agent": 5.299999999999998}, "sample": 0.0053168264482902645, "env_to_module_sum_episodes_length_out": 10.36823839457432, "num_env_steps_sampled": 5000.0, "num_agent_steps_sampled": {"default_agent": 5000.0}, "module_episode_returns_mean": {"default_policy": 5.299999999999998}, "env_reset_timer": 4.082547475058071e-05, "episode_return_max": 10.5, "episode_len_min": 20, "episode_return_mean": 5.299999999999998, "num_episodes_lifetime": -400875.0, "env_to_module_sum_episodes_length_in": 10.36823839457432, "num_episodes": 250.0, "num_module_steps_sampled_lifetime": {"default_policy": -8017500.0}, "episode_return_min": -9.5, "episode_len_mean": 20.0, "episode_duration_sec_mean": 0.004691791336983443, "weights_seq_no": 14.0, "episode_len_max": 20, "num_env_steps_sampled_lifetime": -8017500.0, "env_step_timer": 1.4192566167167692e-05, "rlmodule_inference_timer": 2.842595195593639e-05, "num_module_steps_sampled": {"default_policy": 5000.0}, "num_env_steps_sampled_lifetime_throughput": 3598.5140701255814}, "learners": {"default_policy": {"diff_num_grad_updates_vs_sampler_policy": 1.0, "curr_entropy_coeff": 0.0090570820258, "policy_loss": 0.049212247133255005, "default_optimizer_learning_rate": 0.0002847858517, "num_trainable_parameters": 6003, "num_module_steps_trained_lifetime": 90000, "weights_seq_no": 15.0, "vf_loss_unclipped": 28.36760139465332, "num_module_steps_trained": 6000, "mean_kl_loss": 8.566788892494515e-05, "curr_kl_coeff": 2.2781259758630767e-05, "entropy": 0.5600871443748474, "module_train_batch_size_mean": 1000.0, "gradients_default_optimizer_global_norm": 0.03713970631361008, "vf_loss": 0.10278083384037018, "vf_explained_var": -0.010147690773010254, "total_loss": 0.11288011074066162, "num_module_steps_trained_lifetime_throughput": 238558.27018096254}, "__all_modules__": {"num_trainable_parameters": 6003, "learner_connector_sum_episodes_length_in": 5000.0, "learner_connector": {"timers": {"connectors": {"batch_individual_items": 0.06549645849580746, "add_columns_from_episodes_to_train_batch": 0.04591675252258743, "add_one_ts_to_episodes_and_truncate": 0.014905254501884076, "add_observations_from_episodes_to_batch": 0.0008770477283344528, "add_states_from_episodes_to_batch": 8.132049447583094e-06, "general_advantage_estimation": 0.013615981143508472, "add_time_dim_to_batch_and_zero_pad": 5.54027126739865e-05, "numpy_to_tensor": 0.00014451223095422784}}, "connector_pipeline_timer": 0.14138424511988393}, "num_env_steps_trained_lifetime": 472500, "num_env_steps_trained": 31500, "num_non_trainable_parameters": 0, "num_module_steps_trained_lifetime": 90000, "num_module_steps_trained": 6000, "learner_connector_sum_episodes_length_out": 5250.0, "num_env_steps_trained_lifetime_throughput": 1251523.1761788672, "num_module_steps_trained_throughput": 238698.94720880585, "num_module_steps_trained_lifetime_throughput": 238565.62219626672}}, "num_training_step_calls_per_iteration": 1, "evaluation": {"env_runners": {"episode_len_mean": 20.0, "module_to_env_connector": {"connector_pipeline_timer": 9.80722535099047e-05, "timers": {"connectors": {"remove_single_ts_time_rank_from_batch": 5.565845174542977e-07, "tensor_to_numpy": 1.2650893856514728e-05, "normalize_and_clip_actions": 9.164878014097519e-06, "listify_data_for_vector_env": 1.086932060467702e-05, "un_batch_to_individual_items": 5.2352940700462204e-06, "get_actions": 3.445052891770887e-05}}}, "num_env_steps_sampled_lifetime": 75400, "rlmodule_inference_timer": 2.617588917194865e-05, "env_to_module_connector": {"timers": {"connectors": {"add_time_dim_to_batch_and_zero_pad": 2.17477132459565e-06, "numpy_to_tensor": 8.091711595928798e-06, "batch_individual_items": 6.038595830743131e-06, "add_states_from_episodes_to_batch": 1.5744671381042837e-06, "add_observations_from_episodes_to_batch": 2.772249514039645e-06}}, "connector_pipeline_timer": 4.198292854094269e-05}, "num_episodes_lifetime": 300, "weights_seq_no": 15.0, "episode_len_max": 20, "sample": 0.1420488837989105, "episode_return_max": 14.5, "env_reset_timer": 0.0006323792273749312, "agent_episode_returns_mean": {"default_agent": -0.95}, "module_episode_returns_mean": {"default_policy": -0.95}, "num_episodes": 20, "episode_return_min": -12.5, "episode_duration_sec_mean": 0.0046292728546541186, "num_module_steps_sampled": {"default_policy": 400}, "num_env_steps_sampled": 400, "num_agent_steps_sampled_lifetime": {"default_agent": 6000}, "env_to_module_sum_episodes_length_in": 10.368238394574323, "num_agent_steps_sampled": {"default_agent": 400}, "env_step_timer": 1.3800480379643987e-05, "num_module_steps_sampled_lifetime": {"default_policy": 6000}, "env_to_module_sum_episodes_length_out": 10.368238394574323, "episode_len_min": 20, "episode_return_mean": -0.95, "time_between_sampling": 1.886304131552695}, "num_healthy_workers": 1, "actor_manager_num_outstanding_async_reqs": 0, "num_remote_worker_restarts": 0}, "num_env_steps_sampled_lifetime": -8017500.0, "fault_tolerance": {"num_healthy_workers": 0, "num_remote_worker_restarts": 0}, "env_runner_group": {"actor_manager_num_outstanding_async_reqs": 0}, "done": false, "training_iteration": 15, "trial_id": "4da12_00000", "date": "2025-08-11_19-22-00", "timestamp": 1754932920, "time_this_iter_s": 1.7180769443511963, "time_total_s": 27.366278648376465, "pid": 14324, "hostname": "Mac", "node_ip": "127.0.0.1", "config": {"exploration_config": {}, "extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "placement_strategy": "PACK", "num_gpus": 0, "_fake_gpus": false, "num_cpus_for_main_process": 2, "eager_tracing": true, "eager_max_retraces": 20, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "torch_compile_learner": false, "torch_compile_learner_what_to_compile": "forward_train", "torch_compile_learner_dynamo_backend": "aot_eager", "torch_compile_learner_dynamo_mode": null, "torch_compile_worker": false, "torch_compile_worker_dynamo_backend": "aot_eager", "torch_compile_worker_dynamo_mode": null, "torch_ddp_kwargs": {}, "torch_skip_nan_gradients": false, "env": "Umbrella", "env_config": {}, "observation_space": null, "action_space": null, "clip_rewards": null, "normalize_actions": true, "clip_actions": false, "_is_atari": null, "disable_env_checking": false, "render_env": false, "action_mask_key": "action_mask", "env_runner_cls": null, "num_env_runners": 0, "create_local_env_runner": true, "num_envs_per_env_runner": 1, "gym_env_vectorize_mode": "SYNC", "num_cpus_per_env_runner": 1, "num_gpus_per_env_runner": 0, "custom_resources_per_env_runner": {}, "validate_env_runners_after_construction": true, "episodes_to_numpy": true, "max_requests_in_flight_per_env_runner": 1, "sample_timeout_s": 60.0, "_env_to_module_connector": null, "add_default_connectors_to_env_to_module_pipeline": true, "_module_to_env_connector": null, "add_default_connectors_to_module_to_env_pipeline": true, "merge_env_runner_states": "training_only", "broadcast_env_runner_states": true, "episode_lookback_horizon": 1, "rollout_fragment_length": "auto", "batch_mode": "complete_episodes", "compress_observations": false, "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "enable_tf1_exec_eagerly": false, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "preprocessor_pref": "deepmind", "observation_filter": "NoFilter", "update_worker_filter_stats": true, "use_worker_filter_stats": true, "sampler_perf_stats_ema_coef": null, "_is_online": true, "num_learners": 0, "num_gpus_per_learner": 0, "num_cpus_per_learner": "auto", "num_aggregator_actors_per_learner": 0, "max_requests_in_flight_per_aggregator_actor": 3, "local_gpu_idx": 0, "max_requests_in_flight_per_learner": 3, "gamma": 1, "lr": 0.0002847858517, "grad_clip": 0.5, "grad_clip_by": "global_norm", "_train_batch_size_per_learner": 5000, "train_batch_size": 4000, "num_epochs": 1, "minibatch_size": 1000, "shuffle_batch_per_epoch": true, "model": {"fcnet_hiddens": [256, 256], "fcnet_activation": "tanh", "fcnet_weights_initializer": null, "fcnet_weights_initializer_config": null, "fcnet_bias_initializer": null, "fcnet_bias_initializer_config": null, "conv_filters": null, "conv_activation": "relu", "conv_kernel_initializer": null, "conv_kernel_initializer_config": null, "conv_bias_initializer": null, "conv_bias_initializer_config": null, "conv_transpose_kernel_initializer": null, "conv_transpose_kernel_initializer_config": null, "conv_transpose_bias_initializer": null, "conv_transpose_bias_initializer_config": null, "post_fcnet_hiddens": [], "post_fcnet_activation": "relu", "post_fcnet_weights_initializer": null, "post_fcnet_weights_initializer_config": null, "post_fcnet_bias_initializer": null, "post_fcnet_bias_initializer_config": null, "free_log_std": false, "log_std_clip_param": 20.0, "no_final_linear": false, "vf_share_layers": false, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "lstm_weights_initializer": null, "lstm_weights_initializer_config": null, "lstm_bias_initializer": null, "lstm_bias_initializer_config": null, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "attention_use_n_prev_actions": 0, "attention_use_n_prev_rewards": 0, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": null, "custom_model_config": {}, "custom_action_dist": null, "custom_preprocessor": null, "encoder_latent_dim": null, "always_check_shapes": false, "lstm_use_prev_action_reward": -1, "_use_default_native_models": -1, "_disable_preprocessor_api": false, "_disable_action_flattening": false}, "_learner_connector": null, "add_default_connectors_to_learner_pipeline": true, "learner_config_dict": {}, "optimizer": {}, "_learner_class": null, "callbacks_on_algorithm_init": null, "callbacks_on_env_runners_recreated": null, "callbacks_on_offline_eval_runners_recreated": null, "callbacks_on_checkpoint_loaded": null, "callbacks_on_environment_created": null, "callbacks_on_episode_created": null, "callbacks_on_episode_start": null, "callbacks_on_episode_step": null, "callbacks_on_episode_end": null, "callbacks_on_evaluate_start": null, "callbacks_on_evaluate_end": null, "callbacks_on_evaluate_offline_start": null, "callbacks_on_evaluate_offline_end": null, "callbacks_on_sample_end": null, "callbacks_on_train_result": null, "explore": true, "enable_rl_module_and_learner": true, "enable_env_runner_and_connector_v2": true, "_prior_exploration_config": {"type": "StochasticSampling"}, "count_steps_by": "env_steps", "policy_map_capacity": 100, "policy_mapping_fn": "<function AlgorithmConfig.DEFAULT_POLICY_MAPPING_FN at 0x385eedb20>", "policies_to_train": null, "policy_states_are_swappable": false, "observation_fn": null, "offline_data_class": null, "input_read_method": "read_parquet", "input_read_method_kwargs": {}, "input_read_schema": {}, "input_read_episodes": false, "input_read_sample_batches": false, "input_read_batch_size": null, "input_filesystem": null, "input_filesystem_kwargs": {}, "input_compress_columns": ["obs", "new_obs"], "input_spaces_jsonable": true, "materialize_data": false, "materialize_mapped_data": true, "map_batches_kwargs": {}, "iter_batches_kwargs": {}, "ignore_final_observation": false, "prelearner_class": null, "prelearner_buffer_class": null, "prelearner_buffer_kwargs": {}, "prelearner_module_synch_period": 10, "dataset_num_iters_per_learner": null, "input_config": {}, "actions_in_input_normalized": false, "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_config": {}, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "output_max_rows_per_file": null, "output_write_remaining_data": false, "output_write_method": "write_parquet", "output_write_method_kwargs": {}, "output_filesystem": null, "output_filesystem_kwargs": {}, "output_write_episodes": true, "offline_sampling": false, "evaluation_interval": 1, "evaluation_duration": 20, "evaluation_duration_unit": "episodes", "evaluation_sample_timeout_s": 120.0, "evaluation_auto_duration_min_env_steps_per_sample": 100, "evaluation_auto_duration_max_env_steps_per_sample": 2000, "evaluation_parallel_to_training": false, "evaluation_force_reset_envs_before_iteration": true, "evaluation_config": null, "off_policy_estimation_methods": {}, "ope_split_batch_by_episode": true, "evaluation_num_env_runners": 1, "in_evaluation": false, "sync_filters_on_rollout_workers_timeout_s": 10.0, "offline_evaluation_interval": null, "num_offline_eval_runners": 0, "offline_loss_for_module_fn": null, "offline_evaluation_duration": 1, "offline_evaluation_parallel_to_training": false, "offline_evaluation_timeout_s": 120.0, "num_cpus_per_offline_eval_runner": 1, "num_gpus_per_offline_eval_runner": 0, "custom_resources_per_offline_eval_runner": {}, "restart_failed_offline_eval_runners": true, "ignore_offline_eval_runner_failures": false, "max_num_offline_eval_runner_restarts": 1000, "offline_eval_runner_restore_timeout_s": 1800.0, "max_requests_in_flight_per_offline_eval_runner": 1, "validate_offline_eval_runners_after_construction": true, "offline_eval_runner_health_probe_timeout_s": 30.0, "offline_eval_rl_module_inference_only": false, "broadcast_offline_eval_runner_states": false, "offline_eval_batch_size_per_runner": 256, "dataset_num_iters_per_eval_runner": 1, "keep_per_episode_custom_metrics": false, "metrics_episode_collection_timeout_s": 60.0, "metrics_num_episodes_for_smoothing": 100, "min_time_s_per_iteration": null, "min_train_timesteps_per_iteration": 0, "min_sample_timesteps_per_iteration": 0, "log_gradients": true, "export_native_model_files": false, "checkpoint_trainable_policies_only": false, "logger_creator": null, "logger_config": null, "log_level": "WARN", "log_sys_usage": true, "fake_sampler": false, "seed": 7, "restart_failed_env_runners": true, "ignore_env_runner_failures": false, "max_num_env_runner_restarts": 1000, "delay_between_env_runner_restarts_s": 60.0, "restart_failed_sub_environments": false, "num_consecutive_env_runner_failures_tolerance": 100, "env_runner_health_probe_timeout_s": 30.0, "env_runner_restore_timeout_s": 1800.0, "_model_config": {}, "_rl_module_spec": "RLModuleSpec(module_class=None, observation_space=None, action_space=None, inference_only=False, learner_only=False, model_config=DefaultModelConfig(fcnet_hiddens=[60, 90], fcnet_activation='tanh', fcnet_kernel_initializer=None, fcnet_kernel_initializer_kwargs=None, fcnet_bias_initializer=None, fcnet_bias_initializer_kwargs=None, conv_filters=None, conv_activation='relu', conv_kernel_initializer=None, conv_kernel_initializer_kwargs=None, conv_bias_initializer=None, conv_bias_initializer_kwargs=None, head_fcnet_hiddens=[], head_fcnet_activation='relu', head_fcnet_kernel_initializer=None, head_fcnet_kernel_initializer_kwargs=None, head_fcnet_bias_initializer=None, head_fcnet_bias_initializer_kwargs=None, free_log_std=False, log_std_clip_param=20.0, vf_share_layers=True, use_lstm=False, max_seq_len=20, lstm_cell_size=256, lstm_use_prev_action=False, lstm_use_prev_reward=False, lstm_kernel_initializer=None, lstm_kernel_initializer_kwargs=None, lstm_bias_initializer=None, lstm_bias_initializer_kwargs=None), catalog_class=None, load_state_path=None, model_config_dict=None)", "algorithm_config_overrides_per_module": {}, "_per_module_overrides": {}, "_validate_config": true, "_use_msgpack_checkpoints": false, "_torch_grad_scaler_class": null, "_torch_lr_scheduler_classes": null, "_tf_policy_handles_more_than_one_loss": false, "_disable_preprocessor_api": false, "_disable_action_flattening": false, "_disable_initialize_loss_from_dummy_batch": false, "_dont_auto_sync_env_runner_states": false, "env_task_fn": -1, "enable_connectors": -1, "simple_optimizer": false, "policy_map_cache": -1, "worker_cls": -1, "synchronize_filters": -1, "enable_async_evaluation": -1, "custom_async_evaluation_function": -1, "_enable_rl_module_api": -1, "auto_wrap_old_gym_envs": -1, "always_attach_evaluation_results": -1, "replay_sequence_length": null, "_disable_execution_plan_api": -1, "use_critic": true, "use_gae": true, "use_kl_loss": true, "kl_coeff": 0.7464963036515, "kl_target": 0.0270990929592, "vf_loss_coeff": 0.6688075857018, "entropy_coeff": 0.0090570820258, "clip_param": 0.1221781641624, "vf_clip_param": 0.1027808522125, "entropy_coeff_schedule": null, "lr_schedule": null, "sgd_minibatch_size": -1, "vf_share_layers": -1, "__stdout_file__": null, "__stderr_file__": null, "lambda": 0.9099046732075, "input": "sampler", "policies": {"default_policy": [null, null, null, null]}, "callbacks": "<class 'ray.rllib.callbacks.callbacks.RLlibCallback'>", "create_env_on_driver": false, "custom_eval_function": null, "framework": "torch"}, "time_since_restore": 27.366278648376465, "iterations_since_restore": 15, "perf": {"cpu_util_percent": 44.800000000000004, "ram_util_percent": 80.83333333333333}}
{"timers": {"training_iteration": 2.0894424700212264, "restore_env_runners": 9.9648773904311e-06, "training_step": 2.0890612755651143, "env_runner_sampling_timer": 1.8628550330959601, "learner_update_timer": 0.2153781663577513, "synch_weights": 0.0058010113442372654, "restore_eval_env_runners": 8.981022457744272e-05, "evaluation_iteration": 0.16774034746710642, "synch_eval_env_connectors": 0.0003107635077853274, "synch_env_connectors": 6.348987383642187e-06}, "env_runners": {"num_agent_steps_sampled_lifetime": {"default_agent": -8635000.0}, "env_to_module_connector": {"timers": {"connectors": {"numpy_to_tensor": 8.394967463470442e-06, "batch_individual_items": 6.191868261084767e-06, "add_observations_from_episodes_to_batch": 2.986975448537133e-06, "add_time_dim_to_batch_and_zero_pad": 2.425399730536907e-06, "add_states_from_episodes_to_batch": 1.7391838993122076e-06}}, "connector_pipeline_timer": 4.346077618690718e-05}, "module_to_env_connector": {"timers": {"connectors": {"get_actions": 3.815476850700617e-05, "normalize_and_clip_actions": 9.348214652225017e-06, "listify_data_for_vector_env": 1.0773852645535648e-05, "remove_single_ts_time_rank_from_batch": 5.738713195549971e-07, "tensor_to_numpy": 1.2955779520511163e-05, "un_batch_to_individual_items": 5.3000604667768205e-06}}, "connector_pipeline_timer": 0.00010264833838209322}, "time_between_sampling": 0.001878847533794771, "agent_episode_returns_mean": {"default_agent": 7.2200000000000015}, "sample": 0.00486887200156904, "env_to_module_sum_episodes_length_out": 10.36823839457432, "num_env_steps_sampled": 5000.0, "num_agent_steps_sampled": {"default_agent": 5000.0}, "module_episode_returns_mean": {"default_policy": 7.2200000000000015}, "env_reset_timer": 3.333582311075638e-05, "episode_return_max": 10.5, "episode_len_min": 20, "episode_return_mean": 7.2200000000000015, "num_episodes_lifetime": -431750.0, "env_to_module_sum_episodes_length_in": 10.36823839457432, "num_episodes": 250.0, "num_module_steps_sampled_lifetime": {"default_policy": -8635000.0}, "episode_return_min": -9.5, "episode_len_mean": 20.0, "episode_duration_sec_mean": 0.0044921063398942335, "weights_seq_no": 15.0, "episode_len_max": 20, "num_env_steps_sampled_lifetime": -8635000.0, "env_step_timer": 1.3480881311266844e-05, "rlmodule_inference_timer": 2.6979249740374533e-05, "num_module_steps_sampled": {"default_policy": 5000.0}, "num_env_steps_sampled_lifetime_throughput": 3776.4457636451543}, "learners": {"default_policy": {"diff_num_grad_updates_vs_sampler_policy": 1.0, "curr_entropy_coeff": 0.0090570820258, "policy_loss": 0.05219123512506485, "default_optimizer_learning_rate": 0.0002847858517, "num_trainable_parameters": 6003, "num_module_steps_trained_lifetime": 96000, "weights_seq_no": 16.0, "vf_loss_unclipped": 28.182588577270508, "num_module_steps_trained": 6000, "mean_kl_loss": 0.0002683716011233628, "curr_kl_coeff": 1.1390629879315384e-05, "entropy": 0.5402327179908752, "module_train_batch_size_mean": 1000.0, "gradients_default_optimizer_global_norm": 0.02891549840569496, "vf_loss": 0.10278083384037018, "vf_explained_var": -0.009708046913146973, "total_loss": 0.11603890359401703, "num_module_steps_trained_lifetime_throughput": 244792.32025479578}, "__all_modules__": {"num_trainable_parameters": 6003, "learner_connector_sum_episodes_length_in": 5000.0, "learner_connector": {"timers": {"connectors": {"batch_individual_items": 0.06516081933185487, "add_columns_from_episodes_to_train_batch": 0.04580703416695076, "add_one_ts_to_episodes_and_truncate": 0.014835732787127463, "add_observations_from_episodes_to_batch": 0.0008764960016415668, "add_states_from_episodes_to_batch": 8.082818836568857e-06, "general_advantage_estimation": 0.013537405081367668, "add_time_dim_to_batch_and_zero_pad": 5.498493454745322e-05, "numpy_to_tensor": 0.00014372085867500942}}, "connector_pipeline_timer": 0.14078633641939461}, "num_env_steps_trained_lifetime": 504000, "num_env_steps_trained": 31500, "num_non_trainable_parameters": 0, "num_module_steps_trained_lifetime": 96000, "num_module_steps_trained": 6000, "learner_connector_sum_episodes_length_out": 5250.0, "num_env_steps_trained_lifetime_throughput": 1284391.0557317815, "num_module_steps_trained_throughput": 244955.188810976, "num_module_steps_trained_lifetime_throughput": 244820.69003058888}}, "num_training_step_calls_per_iteration": 1, "evaluation": {"env_runners": {"episode_len_mean": 20.0, "module_to_env_connector": {"connector_pipeline_timer": 9.821510764347078e-05, "timers": {"connectors": {"remove_single_ts_time_rank_from_batch": 5.623356579969006e-07, "tensor_to_numpy": 1.2514458413218605e-05, "normalize_and_clip_actions": 9.27039223351457e-06, "listify_data_for_vector_env": 1.0997120410111415e-05, "un_batch_to_individual_items": 5.383034199024438e-06, "get_actions": 3.415657357323504e-05}}}, "num_env_steps_sampled_lifetime": 80400, "rlmodule_inference_timer": 2.6282167594648558e-05, "env_to_module_connector": {"timers": {"connectors": {"add_time_dim_to_batch_and_zero_pad": 2.210526022667956e-06, "numpy_to_tensor": 8.103111526343404e-06, "batch_individual_items": 6.168137687057143e-06, "add_states_from_episodes_to_batch": 1.5911946581979705e-06, "add_observations_from_episodes_to_batch": 2.8173413390320253e-06}}, "connector_pipeline_timer": 4.2101254234637895e-05}, "num_episodes_lifetime": 320, "weights_seq_no": 16.0, "episode_len_max": 20, "sample": 0.1415904158007187, "episode_return_max": 14.5, "env_reset_timer": 0.0006267629352497465, "agent_episode_returns_mean": {"default_agent": -0.95}, "module_episode_returns_mean": {"default_policy": -0.95}, "num_episodes": 20, "episode_return_min": -12.5, "episode_duration_sec_mean": 0.00462748788180761, "num_module_steps_sampled": {"default_policy": 400}, "num_env_steps_sampled": 400, "num_agent_steps_sampled_lifetime": {"default_agent": 6400}, "env_to_module_sum_episodes_length_in": 10.368238394574323, "num_agent_steps_sampled": {"default_agent": 400}, "env_step_timer": 1.392661619374817e-05, "num_module_steps_sampled_lifetime": {"default_policy": 6400}, "env_to_module_sum_episodes_length_out": 10.368238394574323, "episode_len_min": 20, "episode_return_mean": -0.95, "time_between_sampling": 1.882242135237954}, "num_healthy_workers": 1, "actor_manager_num_outstanding_async_reqs": 0, "num_remote_worker_restarts": 0}, "num_env_steps_sampled_lifetime": -8635000.0, "fault_tolerance": {"num_healthy_workers": 0, "num_remote_worker_restarts": 0}, "env_runner_group": {"actor_manager_num_outstanding_async_reqs": 0}, "done": false, "training_iteration": 16, "trial_id": "4da12_00000", "date": "2025-08-11_19-22-02", "timestamp": 1754932922, "time_this_iter_s": 1.566622018814087, "time_total_s": 28.93290066719055, "pid": 14324, "hostname": "Mac", "node_ip": "127.0.0.1", "config": {"exploration_config": {}, "extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "placement_strategy": "PACK", "num_gpus": 0, "_fake_gpus": false, "num_cpus_for_main_process": 2, "eager_tracing": true, "eager_max_retraces": 20, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "torch_compile_learner": false, "torch_compile_learner_what_to_compile": "forward_train", "torch_compile_learner_dynamo_backend": "aot_eager", "torch_compile_learner_dynamo_mode": null, "torch_compile_worker": false, "torch_compile_worker_dynamo_backend": "aot_eager", "torch_compile_worker_dynamo_mode": null, "torch_ddp_kwargs": {}, "torch_skip_nan_gradients": false, "env": "Umbrella", "env_config": {}, "observation_space": null, "action_space": null, "clip_rewards": null, "normalize_actions": true, "clip_actions": false, "_is_atari": null, "disable_env_checking": false, "render_env": false, "action_mask_key": "action_mask", "env_runner_cls": null, "num_env_runners": 0, "create_local_env_runner": true, "num_envs_per_env_runner": 1, "gym_env_vectorize_mode": "SYNC", "num_cpus_per_env_runner": 1, "num_gpus_per_env_runner": 0, "custom_resources_per_env_runner": {}, "validate_env_runners_after_construction": true, "episodes_to_numpy": true, "max_requests_in_flight_per_env_runner": 1, "sample_timeout_s": 60.0, "_env_to_module_connector": null, "add_default_connectors_to_env_to_module_pipeline": true, "_module_to_env_connector": null, "add_default_connectors_to_module_to_env_pipeline": true, "merge_env_runner_states": "training_only", "broadcast_env_runner_states": true, "episode_lookback_horizon": 1, "rollout_fragment_length": "auto", "batch_mode": "complete_episodes", "compress_observations": false, "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "enable_tf1_exec_eagerly": false, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "preprocessor_pref": "deepmind", "observation_filter": "NoFilter", "update_worker_filter_stats": true, "use_worker_filter_stats": true, "sampler_perf_stats_ema_coef": null, "_is_online": true, "num_learners": 0, "num_gpus_per_learner": 0, "num_cpus_per_learner": "auto", "num_aggregator_actors_per_learner": 0, "max_requests_in_flight_per_aggregator_actor": 3, "local_gpu_idx": 0, "max_requests_in_flight_per_learner": 3, "gamma": 1, "lr": 0.0002847858517, "grad_clip": 0.5, "grad_clip_by": "global_norm", "_train_batch_size_per_learner": 5000, "train_batch_size": 4000, "num_epochs": 1, "minibatch_size": 1000, "shuffle_batch_per_epoch": true, "model": {"fcnet_hiddens": [256, 256], "fcnet_activation": "tanh", "fcnet_weights_initializer": null, "fcnet_weights_initializer_config": null, "fcnet_bias_initializer": null, "fcnet_bias_initializer_config": null, "conv_filters": null, "conv_activation": "relu", "conv_kernel_initializer": null, "conv_kernel_initializer_config": null, "conv_bias_initializer": null, "conv_bias_initializer_config": null, "conv_transpose_kernel_initializer": null, "conv_transpose_kernel_initializer_config": null, "conv_transpose_bias_initializer": null, "conv_transpose_bias_initializer_config": null, "post_fcnet_hiddens": [], "post_fcnet_activation": "relu", "post_fcnet_weights_initializer": null, "post_fcnet_weights_initializer_config": null, "post_fcnet_bias_initializer": null, "post_fcnet_bias_initializer_config": null, "free_log_std": false, "log_std_clip_param": 20.0, "no_final_linear": false, "vf_share_layers": false, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "lstm_weights_initializer": null, "lstm_weights_initializer_config": null, "lstm_bias_initializer": null, "lstm_bias_initializer_config": null, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "attention_use_n_prev_actions": 0, "attention_use_n_prev_rewards": 0, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": null, "custom_model_config": {}, "custom_action_dist": null, "custom_preprocessor": null, "encoder_latent_dim": null, "always_check_shapes": false, "lstm_use_prev_action_reward": -1, "_use_default_native_models": -1, "_disable_preprocessor_api": false, "_disable_action_flattening": false}, "_learner_connector": null, "add_default_connectors_to_learner_pipeline": true, "learner_config_dict": {}, "optimizer": {}, "_learner_class": null, "callbacks_on_algorithm_init": null, "callbacks_on_env_runners_recreated": null, "callbacks_on_offline_eval_runners_recreated": null, "callbacks_on_checkpoint_loaded": null, "callbacks_on_environment_created": null, "callbacks_on_episode_created": null, "callbacks_on_episode_start": null, "callbacks_on_episode_step": null, "callbacks_on_episode_end": null, "callbacks_on_evaluate_start": null, "callbacks_on_evaluate_end": null, "callbacks_on_evaluate_offline_start": null, "callbacks_on_evaluate_offline_end": null, "callbacks_on_sample_end": null, "callbacks_on_train_result": null, "explore": true, "enable_rl_module_and_learner": true, "enable_env_runner_and_connector_v2": true, "_prior_exploration_config": {"type": "StochasticSampling"}, "count_steps_by": "env_steps", "policy_map_capacity": 100, "policy_mapping_fn": "<function AlgorithmConfig.DEFAULT_POLICY_MAPPING_FN at 0x385eedb20>", "policies_to_train": null, "policy_states_are_swappable": false, "observation_fn": null, "offline_data_class": null, "input_read_method": "read_parquet", "input_read_method_kwargs": {}, "input_read_schema": {}, "input_read_episodes": false, "input_read_sample_batches": false, "input_read_batch_size": null, "input_filesystem": null, "input_filesystem_kwargs": {}, "input_compress_columns": ["obs", "new_obs"], "input_spaces_jsonable": true, "materialize_data": false, "materialize_mapped_data": true, "map_batches_kwargs": {}, "iter_batches_kwargs": {}, "ignore_final_observation": false, "prelearner_class": null, "prelearner_buffer_class": null, "prelearner_buffer_kwargs": {}, "prelearner_module_synch_period": 10, "dataset_num_iters_per_learner": null, "input_config": {}, "actions_in_input_normalized": false, "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_config": {}, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "output_max_rows_per_file": null, "output_write_remaining_data": false, "output_write_method": "write_parquet", "output_write_method_kwargs": {}, "output_filesystem": null, "output_filesystem_kwargs": {}, "output_write_episodes": true, "offline_sampling": false, "evaluation_interval": 1, "evaluation_duration": 20, "evaluation_duration_unit": "episodes", "evaluation_sample_timeout_s": 120.0, "evaluation_auto_duration_min_env_steps_per_sample": 100, "evaluation_auto_duration_max_env_steps_per_sample": 2000, "evaluation_parallel_to_training": false, "evaluation_force_reset_envs_before_iteration": true, "evaluation_config": null, "off_policy_estimation_methods": {}, "ope_split_batch_by_episode": true, "evaluation_num_env_runners": 1, "in_evaluation": false, "sync_filters_on_rollout_workers_timeout_s": 10.0, "offline_evaluation_interval": null, "num_offline_eval_runners": 0, "offline_loss_for_module_fn": null, "offline_evaluation_duration": 1, "offline_evaluation_parallel_to_training": false, "offline_evaluation_timeout_s": 120.0, "num_cpus_per_offline_eval_runner": 1, "num_gpus_per_offline_eval_runner": 0, "custom_resources_per_offline_eval_runner": {}, "restart_failed_offline_eval_runners": true, "ignore_offline_eval_runner_failures": false, "max_num_offline_eval_runner_restarts": 1000, "offline_eval_runner_restore_timeout_s": 1800.0, "max_requests_in_flight_per_offline_eval_runner": 1, "validate_offline_eval_runners_after_construction": true, "offline_eval_runner_health_probe_timeout_s": 30.0, "offline_eval_rl_module_inference_only": false, "broadcast_offline_eval_runner_states": false, "offline_eval_batch_size_per_runner": 256, "dataset_num_iters_per_eval_runner": 1, "keep_per_episode_custom_metrics": false, "metrics_episode_collection_timeout_s": 60.0, "metrics_num_episodes_for_smoothing": 100, "min_time_s_per_iteration": null, "min_train_timesteps_per_iteration": 0, "min_sample_timesteps_per_iteration": 0, "log_gradients": true, "export_native_model_files": false, "checkpoint_trainable_policies_only": false, "logger_creator": null, "logger_config": null, "log_level": "WARN", "log_sys_usage": true, "fake_sampler": false, "seed": 7, "restart_failed_env_runners": true, "ignore_env_runner_failures": false, "max_num_env_runner_restarts": 1000, "delay_between_env_runner_restarts_s": 60.0, "restart_failed_sub_environments": false, "num_consecutive_env_runner_failures_tolerance": 100, "env_runner_health_probe_timeout_s": 30.0, "env_runner_restore_timeout_s": 1800.0, "_model_config": {}, "_rl_module_spec": "RLModuleSpec(module_class=None, observation_space=None, action_space=None, inference_only=False, learner_only=False, model_config=DefaultModelConfig(fcnet_hiddens=[60, 90], fcnet_activation='tanh', fcnet_kernel_initializer=None, fcnet_kernel_initializer_kwargs=None, fcnet_bias_initializer=None, fcnet_bias_initializer_kwargs=None, conv_filters=None, conv_activation='relu', conv_kernel_initializer=None, conv_kernel_initializer_kwargs=None, conv_bias_initializer=None, conv_bias_initializer_kwargs=None, head_fcnet_hiddens=[], head_fcnet_activation='relu', head_fcnet_kernel_initializer=None, head_fcnet_kernel_initializer_kwargs=None, head_fcnet_bias_initializer=None, head_fcnet_bias_initializer_kwargs=None, free_log_std=False, log_std_clip_param=20.0, vf_share_layers=True, use_lstm=False, max_seq_len=20, lstm_cell_size=256, lstm_use_prev_action=False, lstm_use_prev_reward=False, lstm_kernel_initializer=None, lstm_kernel_initializer_kwargs=None, lstm_bias_initializer=None, lstm_bias_initializer_kwargs=None), catalog_class=None, load_state_path=None, model_config_dict=None)", "algorithm_config_overrides_per_module": {}, "_per_module_overrides": {}, "_validate_config": true, "_use_msgpack_checkpoints": false, "_torch_grad_scaler_class": null, "_torch_lr_scheduler_classes": null, "_tf_policy_handles_more_than_one_loss": false, "_disable_preprocessor_api": false, "_disable_action_flattening": false, "_disable_initialize_loss_from_dummy_batch": false, "_dont_auto_sync_env_runner_states": false, "env_task_fn": -1, "enable_connectors": -1, "simple_optimizer": false, "policy_map_cache": -1, "worker_cls": -1, "synchronize_filters": -1, "enable_async_evaluation": -1, "custom_async_evaluation_function": -1, "_enable_rl_module_api": -1, "auto_wrap_old_gym_envs": -1, "always_attach_evaluation_results": -1, "replay_sequence_length": null, "_disable_execution_plan_api": -1, "use_critic": true, "use_gae": true, "use_kl_loss": true, "kl_coeff": 0.7464963036515, "kl_target": 0.0270990929592, "vf_loss_coeff": 0.6688075857018, "entropy_coeff": 0.0090570820258, "clip_param": 0.1221781641624, "vf_clip_param": 0.1027808522125, "entropy_coeff_schedule": null, "lr_schedule": null, "sgd_minibatch_size": -1, "vf_share_layers": -1, "__stdout_file__": null, "__stderr_file__": null, "lambda": 0.9099046732075, "input": "sampler", "policies": {"default_policy": [null, null, null, null]}, "callbacks": "<class 'ray.rllib.callbacks.callbacks.RLlibCallback'>", "create_env_on_driver": false, "custom_eval_function": null, "framework": "torch"}, "time_since_restore": 28.93290066719055, "iterations_since_restore": 16, "perf": {"cpu_util_percent": 38.15, "ram_util_percent": 79.4}}
{"timers": {"training_iteration": 2.0844996994800127, "restore_env_runners": 9.928978810912436e-06, "training_step": 2.0841203594797495, "env_runner_sampling_timer": 1.8590268998459878, "learner_update_timer": 0.21434066761429407, "synch_weights": 0.00574857080987464, "restore_eval_env_runners": 8.897962226356998e-05, "evaluation_iteration": 0.16708449982222856, "synch_eval_env_connectors": 0.0003086887932617544, "synch_env_connectors": 6.326327855630126e-06}, "env_runners": {"num_agent_steps_sampled_lifetime": {"default_agent": -9252500.0}, "env_to_module_connector": {"timers": {"connectors": {"numpy_to_tensor": 8.584323834088339e-06, "batch_individual_items": 6.330507636489293e-06, "add_observations_from_episodes_to_batch": 3.0963307749740785e-06, "add_time_dim_to_batch_and_zero_pad": 2.490885093693401e-06, "add_states_from_episodes_to_batch": 1.7774690914393248e-06}}, "connector_pipeline_timer": 4.4271368765613745e-05}, "module_to_env_connector": {"timers": {"connectors": {"get_actions": 3.8859339614098035e-05, "normalize_and_clip_actions": 9.483677817616866e-06, "listify_data_for_vector_env": 1.0988165293748832e-05, "remove_single_ts_time_rank_from_batch": 5.873903664689702e-07, "tensor_to_numpy": 1.326616263297823e-05, "un_batch_to_individual_items": 5.422494102000158e-06}}, "connector_pipeline_timer": 0.00010441849124960914}, "time_between_sampling": 0.0015485292070447016, "agent_episode_returns_mean": {"default_agent": 7.299999999999996}, "sample": 0.005061318068843781, "env_to_module_sum_episodes_length_out": 10.36823839457432, "num_env_steps_sampled": 5000.0, "num_agent_steps_sampled": {"default_agent": 5000.0}, "module_episode_returns_mean": {"default_policy": 7.299999999999996}, "env_reset_timer": 3.185345099413071e-05, "episode_return_max": 10.5, "episode_len_min": 20, "episode_return_mean": 7.299999999999996, "num_episodes_lifetime": -462625.0, "env_to_module_sum_episodes_length_in": 10.36823839457432, "num_episodes": 250.0, "num_module_steps_sampled_lifetime": {"default_policy": -9252500.0}, "episode_return_min": -9.5, "episode_len_mean": 20.0, "episode_duration_sec_mean": 0.004929310639854521, "weights_seq_no": 16.0, "episode_len_max": 20, "num_env_steps_sampled_lifetime": -9252500.0, "env_step_timer": 1.3730014276529776e-05, "rlmodule_inference_timer": 4.302605791167707e-05, "num_module_steps_sampled": {"default_policy": 5000.0}, "num_env_steps_sampled_lifetime_throughput": 3713.5401370291384}, "learners": {"default_policy": {"diff_num_grad_updates_vs_sampler_policy": 1.0, "curr_entropy_coeff": 0.0090570820258, "policy_loss": -0.057946957647800446, "default_optimizer_learning_rate": 0.0002847858517, "num_trainable_parameters": 6003, "num_module_steps_trained_lifetime": 102000, "weights_seq_no": 17.0, "vf_loss_unclipped": 28.024700164794922, "num_module_steps_trained": 6000, "mean_kl_loss": 1.595735375303775e-05, "curr_kl_coeff": 5.695314939657692e-06, "entropy": 0.5353696346282959, "module_train_batch_size_mean": 1000.0, "gradients_default_optimizer_global_norm": 0.05952993407845497, "vf_loss": 0.10278083384037018, "vf_explained_var": -0.00909113883972168, "total_loss": 0.005944760516285896, "num_module_steps_trained_lifetime_throughput": 250123.12423038727}, "__all_modules__": {"num_trainable_parameters": 6003, "learner_connector_sum_episodes_length_in": 5000.0, "learner_connector": {"timers": {"connectors": {"batch_individual_items": 0.06487897821836462, "add_columns_from_episodes_to_train_batch": 0.045744246745498394, "add_one_ts_to_episodes_and_truncate": 0.014776079209190399, "add_observations_from_episodes_to_batch": 0.0008825377119947315, "add_states_from_episodes_to_batch": 8.035740614154016e-06, "general_advantage_estimation": 0.013464478530503476, "add_time_dim_to_batch_and_zero_pad": 5.454842483100296e-05, "numpy_to_tensor": 0.00014299198959129427}}, "connector_pipeline_timer": 0.14031166096532346}, "num_env_steps_trained_lifetime": 535500, "num_env_steps_trained": 31500, "num_non_trainable_parameters": 0, "num_module_steps_trained_lifetime": 102000, "num_module_steps_trained": 6000, "learner_connector_sum_episodes_length_out": 5250.0, "num_env_steps_trained_lifetime_throughput": 1312504.290306868, "num_module_steps_trained_throughput": 250305.49020652185, "num_module_steps_trained_lifetime_throughput": 250170.1323635169}}, "num_training_step_calls_per_iteration": 1, "evaluation": {"env_runners": {"episode_len_mean": 20.0, "module_to_env_connector": {"connector_pipeline_timer": 0.00011866834844153222, "timers": {"connectors": {"remove_single_ts_time_rank_from_batch": 6.029557376611302e-07, "tensor_to_numpy": 1.5165934027537974e-05, "normalize_and_clip_actions": 1.070144879415003e-05, "listify_data_for_vector_env": 1.2669245326420669e-05, "un_batch_to_individual_items": 6.597842254522636e-06, "get_actions": 4.417985946536426e-05}}}, "num_env_steps_sampled_lifetime": 85400, "rlmodule_inference_timer": 3.161077151744412e-05, "env_to_module_connector": {"timers": {"connectors": {"add_time_dim_to_batch_and_zero_pad": 2.580630128894469e-06, "numpy_to_tensor": 1.0501283257689719e-05, "batch_individual_items": 7.107480422637975e-06, "add_states_from_episodes_to_batch": 1.719632634331406e-06, "add_observations_from_episodes_to_batch": 3.1791964990117743e-06}}, "connector_pipeline_timer": 4.9226798586609295e-05}, "num_episodes_lifetime": 340, "weights_seq_no": 17.0, "episode_len_max": 20, "sample": 0.14135093081235356, "episode_return_max": 14.5, "env_reset_timer": 0.0006212636353797747, "agent_episode_returns_mean": {"default_agent": -1.15}, "module_episode_returns_mean": {"default_policy": -1.15}, "num_episodes": 20, "episode_return_min": -12.5, "episode_duration_sec_mean": 0.004816282893298194, "num_module_steps_sampled": {"default_policy": 400}, "num_env_steps_sampled": 400, "num_agent_steps_sampled_lifetime": {"default_agent": 6800}, "env_to_module_sum_episodes_length_in": 10.368238394574323, "num_agent_steps_sampled": {"default_agent": 400}, "env_step_timer": 1.6585724190033795e-05, "num_module_steps_sampled_lifetime": {"default_policy": 6800}, "env_to_module_sum_episodes_length_out": 10.368238394574323, "episode_len_min": 20, "episode_return_mean": -1.15, "time_between_sampling": 1.879587663465696}, "num_healthy_workers": 1, "actor_manager_num_outstanding_async_reqs": 0, "num_remote_worker_restarts": 0}, "num_env_steps_sampled_lifetime": -9252500.0, "fault_tolerance": {"num_healthy_workers": 0, "num_remote_worker_restarts": 0}, "env_runner_group": {"actor_manager_num_outstanding_async_reqs": 0}, "done": false, "training_iteration": 17, "trial_id": "4da12_00000", "date": "2025-08-11_19-22-04", "timestamp": 1754932924, "time_this_iter_s": 1.7214200496673584, "time_total_s": 30.65432071685791, "pid": 14324, "hostname": "Mac", "node_ip": "127.0.0.1", "config": {"exploration_config": {}, "extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "placement_strategy": "PACK", "num_gpus": 0, "_fake_gpus": false, "num_cpus_for_main_process": 2, "eager_tracing": true, "eager_max_retraces": 20, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "torch_compile_learner": false, "torch_compile_learner_what_to_compile": "forward_train", "torch_compile_learner_dynamo_backend": "aot_eager", "torch_compile_learner_dynamo_mode": null, "torch_compile_worker": false, "torch_compile_worker_dynamo_backend": "aot_eager", "torch_compile_worker_dynamo_mode": null, "torch_ddp_kwargs": {}, "torch_skip_nan_gradients": false, "env": "Umbrella", "env_config": {}, "observation_space": null, "action_space": null, "clip_rewards": null, "normalize_actions": true, "clip_actions": false, "_is_atari": null, "disable_env_checking": false, "render_env": false, "action_mask_key": "action_mask", "env_runner_cls": null, "num_env_runners": 0, "create_local_env_runner": true, "num_envs_per_env_runner": 1, "gym_env_vectorize_mode": "SYNC", "num_cpus_per_env_runner": 1, "num_gpus_per_env_runner": 0, "custom_resources_per_env_runner": {}, "validate_env_runners_after_construction": true, "episodes_to_numpy": true, "max_requests_in_flight_per_env_runner": 1, "sample_timeout_s": 60.0, "_env_to_module_connector": null, "add_default_connectors_to_env_to_module_pipeline": true, "_module_to_env_connector": null, "add_default_connectors_to_module_to_env_pipeline": true, "merge_env_runner_states": "training_only", "broadcast_env_runner_states": true, "episode_lookback_horizon": 1, "rollout_fragment_length": "auto", "batch_mode": "complete_episodes", "compress_observations": false, "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "enable_tf1_exec_eagerly": false, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "preprocessor_pref": "deepmind", "observation_filter": "NoFilter", "update_worker_filter_stats": true, "use_worker_filter_stats": true, "sampler_perf_stats_ema_coef": null, "_is_online": true, "num_learners": 0, "num_gpus_per_learner": 0, "num_cpus_per_learner": "auto", "num_aggregator_actors_per_learner": 0, "max_requests_in_flight_per_aggregator_actor": 3, "local_gpu_idx": 0, "max_requests_in_flight_per_learner": 3, "gamma": 1, "lr": 0.0002847858517, "grad_clip": 0.5, "grad_clip_by": "global_norm", "_train_batch_size_per_learner": 5000, "train_batch_size": 4000, "num_epochs": 1, "minibatch_size": 1000, "shuffle_batch_per_epoch": true, "model": {"fcnet_hiddens": [256, 256], "fcnet_activation": "tanh", "fcnet_weights_initializer": null, "fcnet_weights_initializer_config": null, "fcnet_bias_initializer": null, "fcnet_bias_initializer_config": null, "conv_filters": null, "conv_activation": "relu", "conv_kernel_initializer": null, "conv_kernel_initializer_config": null, "conv_bias_initializer": null, "conv_bias_initializer_config": null, "conv_transpose_kernel_initializer": null, "conv_transpose_kernel_initializer_config": null, "conv_transpose_bias_initializer": null, "conv_transpose_bias_initializer_config": null, "post_fcnet_hiddens": [], "post_fcnet_activation": "relu", "post_fcnet_weights_initializer": null, "post_fcnet_weights_initializer_config": null, "post_fcnet_bias_initializer": null, "post_fcnet_bias_initializer_config": null, "free_log_std": false, "log_std_clip_param": 20.0, "no_final_linear": false, "vf_share_layers": false, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "lstm_weights_initializer": null, "lstm_weights_initializer_config": null, "lstm_bias_initializer": null, "lstm_bias_initializer_config": null, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "attention_use_n_prev_actions": 0, "attention_use_n_prev_rewards": 0, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": null, "custom_model_config": {}, "custom_action_dist": null, "custom_preprocessor": null, "encoder_latent_dim": null, "always_check_shapes": false, "lstm_use_prev_action_reward": -1, "_use_default_native_models": -1, "_disable_preprocessor_api": false, "_disable_action_flattening": false}, "_learner_connector": null, "add_default_connectors_to_learner_pipeline": true, "learner_config_dict": {}, "optimizer": {}, "_learner_class": null, "callbacks_on_algorithm_init": null, "callbacks_on_env_runners_recreated": null, "callbacks_on_offline_eval_runners_recreated": null, "callbacks_on_checkpoint_loaded": null, "callbacks_on_environment_created": null, "callbacks_on_episode_created": null, "callbacks_on_episode_start": null, "callbacks_on_episode_step": null, "callbacks_on_episode_end": null, "callbacks_on_evaluate_start": null, "callbacks_on_evaluate_end": null, "callbacks_on_evaluate_offline_start": null, "callbacks_on_evaluate_offline_end": null, "callbacks_on_sample_end": null, "callbacks_on_train_result": null, "explore": true, "enable_rl_module_and_learner": true, "enable_env_runner_and_connector_v2": true, "_prior_exploration_config": {"type": "StochasticSampling"}, "count_steps_by": "env_steps", "policy_map_capacity": 100, "policy_mapping_fn": "<function AlgorithmConfig.DEFAULT_POLICY_MAPPING_FN at 0x385eedb20>", "policies_to_train": null, "policy_states_are_swappable": false, "observation_fn": null, "offline_data_class": null, "input_read_method": "read_parquet", "input_read_method_kwargs": {}, "input_read_schema": {}, "input_read_episodes": false, "input_read_sample_batches": false, "input_read_batch_size": null, "input_filesystem": null, "input_filesystem_kwargs": {}, "input_compress_columns": ["obs", "new_obs"], "input_spaces_jsonable": true, "materialize_data": false, "materialize_mapped_data": true, "map_batches_kwargs": {}, "iter_batches_kwargs": {}, "ignore_final_observation": false, "prelearner_class": null, "prelearner_buffer_class": null, "prelearner_buffer_kwargs": {}, "prelearner_module_synch_period": 10, "dataset_num_iters_per_learner": null, "input_config": {}, "actions_in_input_normalized": false, "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_config": {}, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "output_max_rows_per_file": null, "output_write_remaining_data": false, "output_write_method": "write_parquet", "output_write_method_kwargs": {}, "output_filesystem": null, "output_filesystem_kwargs": {}, "output_write_episodes": true, "offline_sampling": false, "evaluation_interval": 1, "evaluation_duration": 20, "evaluation_duration_unit": "episodes", "evaluation_sample_timeout_s": 120.0, "evaluation_auto_duration_min_env_steps_per_sample": 100, "evaluation_auto_duration_max_env_steps_per_sample": 2000, "evaluation_parallel_to_training": false, "evaluation_force_reset_envs_before_iteration": true, "evaluation_config": null, "off_policy_estimation_methods": {}, "ope_split_batch_by_episode": true, "evaluation_num_env_runners": 1, "in_evaluation": false, "sync_filters_on_rollout_workers_timeout_s": 10.0, "offline_evaluation_interval": null, "num_offline_eval_runners": 0, "offline_loss_for_module_fn": null, "offline_evaluation_duration": 1, "offline_evaluation_parallel_to_training": false, "offline_evaluation_timeout_s": 120.0, "num_cpus_per_offline_eval_runner": 1, "num_gpus_per_offline_eval_runner": 0, "custom_resources_per_offline_eval_runner": {}, "restart_failed_offline_eval_runners": true, "ignore_offline_eval_runner_failures": false, "max_num_offline_eval_runner_restarts": 1000, "offline_eval_runner_restore_timeout_s": 1800.0, "max_requests_in_flight_per_offline_eval_runner": 1, "validate_offline_eval_runners_after_construction": true, "offline_eval_runner_health_probe_timeout_s": 30.0, "offline_eval_rl_module_inference_only": false, "broadcast_offline_eval_runner_states": false, "offline_eval_batch_size_per_runner": 256, "dataset_num_iters_per_eval_runner": 1, "keep_per_episode_custom_metrics": false, "metrics_episode_collection_timeout_s": 60.0, "metrics_num_episodes_for_smoothing": 100, "min_time_s_per_iteration": null, "min_train_timesteps_per_iteration": 0, "min_sample_timesteps_per_iteration": 0, "log_gradients": true, "export_native_model_files": false, "checkpoint_trainable_policies_only": false, "logger_creator": null, "logger_config": null, "log_level": "WARN", "log_sys_usage": true, "fake_sampler": false, "seed": 7, "restart_failed_env_runners": true, "ignore_env_runner_failures": false, "max_num_env_runner_restarts": 1000, "delay_between_env_runner_restarts_s": 60.0, "restart_failed_sub_environments": false, "num_consecutive_env_runner_failures_tolerance": 100, "env_runner_health_probe_timeout_s": 30.0, "env_runner_restore_timeout_s": 1800.0, "_model_config": {}, "_rl_module_spec": "RLModuleSpec(module_class=None, observation_space=None, action_space=None, inference_only=False, learner_only=False, model_config=DefaultModelConfig(fcnet_hiddens=[60, 90], fcnet_activation='tanh', fcnet_kernel_initializer=None, fcnet_kernel_initializer_kwargs=None, fcnet_bias_initializer=None, fcnet_bias_initializer_kwargs=None, conv_filters=None, conv_activation='relu', conv_kernel_initializer=None, conv_kernel_initializer_kwargs=None, conv_bias_initializer=None, conv_bias_initializer_kwargs=None, head_fcnet_hiddens=[], head_fcnet_activation='relu', head_fcnet_kernel_initializer=None, head_fcnet_kernel_initializer_kwargs=None, head_fcnet_bias_initializer=None, head_fcnet_bias_initializer_kwargs=None, free_log_std=False, log_std_clip_param=20.0, vf_share_layers=True, use_lstm=False, max_seq_len=20, lstm_cell_size=256, lstm_use_prev_action=False, lstm_use_prev_reward=False, lstm_kernel_initializer=None, lstm_kernel_initializer_kwargs=None, lstm_bias_initializer=None, lstm_bias_initializer_kwargs=None), catalog_class=None, load_state_path=None, model_config_dict=None)", "algorithm_config_overrides_per_module": {}, "_per_module_overrides": {}, "_validate_config": true, "_use_msgpack_checkpoints": false, "_torch_grad_scaler_class": null, "_torch_lr_scheduler_classes": null, "_tf_policy_handles_more_than_one_loss": false, "_disable_preprocessor_api": false, "_disable_action_flattening": false, "_disable_initialize_loss_from_dummy_batch": false, "_dont_auto_sync_env_runner_states": false, "env_task_fn": -1, "enable_connectors": -1, "simple_optimizer": false, "policy_map_cache": -1, "worker_cls": -1, "synchronize_filters": -1, "enable_async_evaluation": -1, "custom_async_evaluation_function": -1, "_enable_rl_module_api": -1, "auto_wrap_old_gym_envs": -1, "always_attach_evaluation_results": -1, "replay_sequence_length": null, "_disable_execution_plan_api": -1, "use_critic": true, "use_gae": true, "use_kl_loss": true, "kl_coeff": 0.7464963036515, "kl_target": 0.0270990929592, "vf_loss_coeff": 0.6688075857018, "entropy_coeff": 0.0090570820258, "clip_param": 0.1221781641624, "vf_clip_param": 0.1027808522125, "entropy_coeff_schedule": null, "lr_schedule": null, "sgd_minibatch_size": -1, "vf_share_layers": -1, "__stdout_file__": null, "__stderr_file__": null, "lambda": 0.9099046732075, "input": "sampler", "policies": {"default_policy": [null, null, null, null]}, "callbacks": "<class 'ray.rllib.callbacks.callbacks.RLlibCallback'>", "create_env_on_driver": false, "custom_eval_function": null, "framework": "torch"}, "time_since_restore": 30.65432071685791, "iterations_since_restore": 17, "perf": {"cpu_util_percent": 39.35, "ram_util_percent": 79.1}}
{"timers": {"training_iteration": 2.0805781408249393, "restore_env_runners": 9.88677909662724e-06, "training_step": 2.080200765884797, "env_runner_sampling_timer": 1.8554763204372855, "learner_update_timer": 0.21404484635804255, "synch_weights": 0.005699065522262895, "restore_eval_env_runners": 8.816524687133308e-05, "evaluation_iteration": 0.1666498452438832, "synch_eval_env_connectors": 0.0003076639955360282, "synch_env_connectors": 6.305564318613184e-06}, "env_runners": {"num_agent_steps_sampled_lifetime": {"default_agent": -9870000.0}, "env_to_module_connector": {"timers": {"connectors": {"numpy_to_tensor": 9.55155689577163e-06, "batch_individual_items": 6.9509208682566625e-06, "add_observations_from_episodes_to_batch": 3.277214242896065e-06, "add_time_dim_to_batch_and_zero_pad": 2.6358241288592714e-06, "add_states_from_episodes_to_batch": 1.8160770673687156e-06}}, "connector_pipeline_timer": 4.746643685268782e-05}, "module_to_env_connector": {"timers": {"connectors": {"get_actions": 4.333501596397738e-05, "normalize_and_clip_actions": 1.022105799329363e-05, "listify_data_for_vector_env": 1.1855160112157811e-05, "remove_single_ts_time_rank_from_batch": 6.468438523527106e-07, "tensor_to_numpy": 1.4318146348018145e-05, "un_batch_to_individual_items": 5.770839201403001e-06}}, "connector_pipeline_timer": 0.00011347793764726045}, "time_between_sampling": 0.0017255013714038768, "agent_episode_returns_mean": {"default_agent": 6.980000000000003}, "sample": 0.005386831469412448, "env_to_module_sum_episodes_length_out": 10.36823839457432, "num_env_steps_sampled": 5000.0, "num_agent_steps_sampled": {"default_agent": 5000.0}, "module_episode_returns_mean": {"default_policy": 6.980000000000003}, "env_reset_timer": 4.322557467516281e-05, "episode_return_max": 10.5, "episode_len_min": 20, "episode_return_mean": 6.980000000000003, "num_episodes_lifetime": -493500.0, "env_to_module_sum_episodes_length_in": 10.36823839457432, "num_episodes": 250.0, "num_module_steps_sampled_lifetime": {"default_policy": -9870000.0}, "episode_return_min": -9.5, "episode_len_mean": 20.0, "episode_duration_sec_mean": 0.0049510118402540685, "weights_seq_no": 17.0, "episode_len_max": 20, "num_env_steps_sampled_lifetime": -9870000.0, "env_step_timer": 1.5093333620453105e-05, "rlmodule_inference_timer": 3.0399664300778036e-05, "num_module_steps_sampled": {"default_policy": 5000.0}, "num_env_steps_sampled_lifetime_throughput": 3421.0209138276205}, "learners": {"default_policy": {"diff_num_grad_updates_vs_sampler_policy": 1.0, "curr_entropy_coeff": 0.0090570820258, "policy_loss": 0.00222662091255188, "default_optimizer_learning_rate": 0.0002847858517, "num_trainable_parameters": 6003, "num_module_steps_trained_lifetime": 108000, "weights_seq_no": 18.0, "vf_loss_unclipped": 28.1092586517334, "num_module_steps_trained": 6000, "mean_kl_loss": 2.4402635972364806e-05, "curr_kl_coeff": 2.847657469828846e-06, "entropy": 0.5365307331085205, "module_train_batch_size_mean": 1000.0, "gradients_default_optimizer_global_norm": 0.08836914598941803, "vf_loss": 0.10278083384037018, "vf_explained_var": -0.009521961212158203, "total_loss": 0.06610782444477081, "num_module_steps_trained_lifetime_throughput": 255902.8817584028}, "__all_modules__": {"num_trainable_parameters": 6003, "learner_connector_sum_episodes_length_in": 5000.0, "learner_connector": {"timers": {"connectors": {"batch_individual_items": 0.06543492968527476, "add_columns_from_episodes_to_train_batch": 0.04563773052756426, "add_one_ts_to_episodes_and_truncate": 0.014708628836533176, "add_observations_from_episodes_to_batch": 0.0008824481650718949, "add_states_from_episodes_to_batch": 7.99121351576437e-06, "general_advantage_estimation": 0.013386766245063512, "add_time_dim_to_batch_and_zero_pad": 5.41441907851252e-05, "numpy_to_tensor": 0.00014226456980587343}}, "connector_pipeline_timer": 0.1406125235156084}, "num_env_steps_trained_lifetime": 567000, "num_env_steps_trained": 31500, "num_non_trainable_parameters": 0, "num_module_steps_trained_lifetime": 108000, "num_module_steps_trained": 6000, "learner_connector_sum_episodes_length_out": 5250.0, "num_env_steps_trained_lifetime_throughput": 1342962.8171020239, "num_module_steps_trained_throughput": 256103.2738034564, "num_module_steps_trained_lifetime_throughput": 255966.78900858745}}, "num_training_step_calls_per_iteration": 1, "evaluation": {"env_runners": {"episode_len_mean": 20.0, "module_to_env_connector": {"connector_pipeline_timer": 9.860367739433959e-05, "timers": {"connectors": {"remove_single_ts_time_rank_from_batch": 5.63931351338335e-07, "tensor_to_numpy": 1.2598881959489097e-05, "normalize_and_clip_actions": 9.199159520153044e-06, "listify_data_for_vector_env": 1.0910567963854091e-05, "un_batch_to_individual_items": 5.313171244992376e-06, "get_actions": 3.46401245698716e-05}}}, "num_env_steps_sampled_lifetime": 90400, "rlmodule_inference_timer": 2.636032887060788e-05, "env_to_module_connector": {"timers": {"connectors": {"add_time_dim_to_batch_and_zero_pad": 2.1876911615834145e-06, "numpy_to_tensor": 8.114120751882454e-06, "batch_individual_items": 6.104971617883048e-06, "add_states_from_episodes_to_batch": 1.5956290428368638e-06, "add_observations_from_episodes_to_batch": 2.794439226014044e-06}}, "connector_pipeline_timer": 4.224646469787412e-05}, "num_episodes_lifetime": 360, "weights_seq_no": 18.0, "episode_len_max": 20, "sample": 0.14089712358481135, "episode_return_max": 14.5, "env_reset_timer": 0.000615769329291931, "agent_episode_returns_mean": {"default_agent": -1.35}, "module_episode_returns_mean": {"default_policy": -1.35}, "num_episodes": 20, "episode_return_min": -12.5, "episode_duration_sec_mean": 0.004641673685982823, "num_module_steps_sampled": {"default_policy": 400}, "num_env_steps_sampled": 400, "num_agent_steps_sampled_lifetime": {"default_agent": 7200}, "env_to_module_sum_episodes_length_in": 10.368238394574323, "num_agent_steps_sampled": {"default_agent": 400}, "env_step_timer": 1.3940008046170133e-05, "num_module_steps_sampled_lifetime": {"default_policy": 7200}, "env_to_module_sum_episodes_length_out": 10.368238394574323, "episode_len_min": 20, "episode_return_mean": -1.35, "time_between_sampling": 1.877917454750211}, "num_healthy_workers": 1, "actor_manager_num_outstanding_async_reqs": 0, "num_remote_worker_restarts": 0}, "num_env_steps_sampled_lifetime": -9870000.0, "fault_tolerance": {"num_healthy_workers": 0, "num_remote_worker_restarts": 0}, "env_runner_group": {"actor_manager_num_outstanding_async_reqs": 0}, "done": false, "training_iteration": 18, "trial_id": "4da12_00000", "date": "2025-08-11_19-22-05", "timestamp": 1754932925, "time_this_iter_s": 1.7965009212493896, "time_total_s": 32.4508216381073, "pid": 14324, "hostname": "Mac", "node_ip": "127.0.0.1", "config": {"exploration_config": {}, "extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "placement_strategy": "PACK", "num_gpus": 0, "_fake_gpus": false, "num_cpus_for_main_process": 2, "eager_tracing": true, "eager_max_retraces": 20, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "torch_compile_learner": false, "torch_compile_learner_what_to_compile": "forward_train", "torch_compile_learner_dynamo_backend": "aot_eager", "torch_compile_learner_dynamo_mode": null, "torch_compile_worker": false, "torch_compile_worker_dynamo_backend": "aot_eager", "torch_compile_worker_dynamo_mode": null, "torch_ddp_kwargs": {}, "torch_skip_nan_gradients": false, "env": "Umbrella", "env_config": {}, "observation_space": null, "action_space": null, "clip_rewards": null, "normalize_actions": true, "clip_actions": false, "_is_atari": null, "disable_env_checking": false, "render_env": false, "action_mask_key": "action_mask", "env_runner_cls": null, "num_env_runners": 0, "create_local_env_runner": true, "num_envs_per_env_runner": 1, "gym_env_vectorize_mode": "SYNC", "num_cpus_per_env_runner": 1, "num_gpus_per_env_runner": 0, "custom_resources_per_env_runner": {}, "validate_env_runners_after_construction": true, "episodes_to_numpy": true, "max_requests_in_flight_per_env_runner": 1, "sample_timeout_s": 60.0, "_env_to_module_connector": null, "add_default_connectors_to_env_to_module_pipeline": true, "_module_to_env_connector": null, "add_default_connectors_to_module_to_env_pipeline": true, "merge_env_runner_states": "training_only", "broadcast_env_runner_states": true, "episode_lookback_horizon": 1, "rollout_fragment_length": "auto", "batch_mode": "complete_episodes", "compress_observations": false, "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "enable_tf1_exec_eagerly": false, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "preprocessor_pref": "deepmind", "observation_filter": "NoFilter", "update_worker_filter_stats": true, "use_worker_filter_stats": true, "sampler_perf_stats_ema_coef": null, "_is_online": true, "num_learners": 0, "num_gpus_per_learner": 0, "num_cpus_per_learner": "auto", "num_aggregator_actors_per_learner": 0, "max_requests_in_flight_per_aggregator_actor": 3, "local_gpu_idx": 0, "max_requests_in_flight_per_learner": 3, "gamma": 1, "lr": 0.0002847858517, "grad_clip": 0.5, "grad_clip_by": "global_norm", "_train_batch_size_per_learner": 5000, "train_batch_size": 4000, "num_epochs": 1, "minibatch_size": 1000, "shuffle_batch_per_epoch": true, "model": {"fcnet_hiddens": [256, 256], "fcnet_activation": "tanh", "fcnet_weights_initializer": null, "fcnet_weights_initializer_config": null, "fcnet_bias_initializer": null, "fcnet_bias_initializer_config": null, "conv_filters": null, "conv_activation": "relu", "conv_kernel_initializer": null, "conv_kernel_initializer_config": null, "conv_bias_initializer": null, "conv_bias_initializer_config": null, "conv_transpose_kernel_initializer": null, "conv_transpose_kernel_initializer_config": null, "conv_transpose_bias_initializer": null, "conv_transpose_bias_initializer_config": null, "post_fcnet_hiddens": [], "post_fcnet_activation": "relu", "post_fcnet_weights_initializer": null, "post_fcnet_weights_initializer_config": null, "post_fcnet_bias_initializer": null, "post_fcnet_bias_initializer_config": null, "free_log_std": false, "log_std_clip_param": 20.0, "no_final_linear": false, "vf_share_layers": false, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "lstm_weights_initializer": null, "lstm_weights_initializer_config": null, "lstm_bias_initializer": null, "lstm_bias_initializer_config": null, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "attention_use_n_prev_actions": 0, "attention_use_n_prev_rewards": 0, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": null, "custom_model_config": {}, "custom_action_dist": null, "custom_preprocessor": null, "encoder_latent_dim": null, "always_check_shapes": false, "lstm_use_prev_action_reward": -1, "_use_default_native_models": -1, "_disable_preprocessor_api": false, "_disable_action_flattening": false}, "_learner_connector": null, "add_default_connectors_to_learner_pipeline": true, "learner_config_dict": {}, "optimizer": {}, "_learner_class": null, "callbacks_on_algorithm_init": null, "callbacks_on_env_runners_recreated": null, "callbacks_on_offline_eval_runners_recreated": null, "callbacks_on_checkpoint_loaded": null, "callbacks_on_environment_created": null, "callbacks_on_episode_created": null, "callbacks_on_episode_start": null, "callbacks_on_episode_step": null, "callbacks_on_episode_end": null, "callbacks_on_evaluate_start": null, "callbacks_on_evaluate_end": null, "callbacks_on_evaluate_offline_start": null, "callbacks_on_evaluate_offline_end": null, "callbacks_on_sample_end": null, "callbacks_on_train_result": null, "explore": true, "enable_rl_module_and_learner": true, "enable_env_runner_and_connector_v2": true, "_prior_exploration_config": {"type": "StochasticSampling"}, "count_steps_by": "env_steps", "policy_map_capacity": 100, "policy_mapping_fn": "<function AlgorithmConfig.DEFAULT_POLICY_MAPPING_FN at 0x385eedb20>", "policies_to_train": null, "policy_states_are_swappable": false, "observation_fn": null, "offline_data_class": null, "input_read_method": "read_parquet", "input_read_method_kwargs": {}, "input_read_schema": {}, "input_read_episodes": false, "input_read_sample_batches": false, "input_read_batch_size": null, "input_filesystem": null, "input_filesystem_kwargs": {}, "input_compress_columns": ["obs", "new_obs"], "input_spaces_jsonable": true, "materialize_data": false, "materialize_mapped_data": true, "map_batches_kwargs": {}, "iter_batches_kwargs": {}, "ignore_final_observation": false, "prelearner_class": null, "prelearner_buffer_class": null, "prelearner_buffer_kwargs": {}, "prelearner_module_synch_period": 10, "dataset_num_iters_per_learner": null, "input_config": {}, "actions_in_input_normalized": false, "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_config": {}, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "output_max_rows_per_file": null, "output_write_remaining_data": false, "output_write_method": "write_parquet", "output_write_method_kwargs": {}, "output_filesystem": null, "output_filesystem_kwargs": {}, "output_write_episodes": true, "offline_sampling": false, "evaluation_interval": 1, "evaluation_duration": 20, "evaluation_duration_unit": "episodes", "evaluation_sample_timeout_s": 120.0, "evaluation_auto_duration_min_env_steps_per_sample": 100, "evaluation_auto_duration_max_env_steps_per_sample": 2000, "evaluation_parallel_to_training": false, "evaluation_force_reset_envs_before_iteration": true, "evaluation_config": null, "off_policy_estimation_methods": {}, "ope_split_batch_by_episode": true, "evaluation_num_env_runners": 1, "in_evaluation": false, "sync_filters_on_rollout_workers_timeout_s": 10.0, "offline_evaluation_interval": null, "num_offline_eval_runners": 0, "offline_loss_for_module_fn": null, "offline_evaluation_duration": 1, "offline_evaluation_parallel_to_training": false, "offline_evaluation_timeout_s": 120.0, "num_cpus_per_offline_eval_runner": 1, "num_gpus_per_offline_eval_runner": 0, "custom_resources_per_offline_eval_runner": {}, "restart_failed_offline_eval_runners": true, "ignore_offline_eval_runner_failures": false, "max_num_offline_eval_runner_restarts": 1000, "offline_eval_runner_restore_timeout_s": 1800.0, "max_requests_in_flight_per_offline_eval_runner": 1, "validate_offline_eval_runners_after_construction": true, "offline_eval_runner_health_probe_timeout_s": 30.0, "offline_eval_rl_module_inference_only": false, "broadcast_offline_eval_runner_states": false, "offline_eval_batch_size_per_runner": 256, "dataset_num_iters_per_eval_runner": 1, "keep_per_episode_custom_metrics": false, "metrics_episode_collection_timeout_s": 60.0, "metrics_num_episodes_for_smoothing": 100, "min_time_s_per_iteration": null, "min_train_timesteps_per_iteration": 0, "min_sample_timesteps_per_iteration": 0, "log_gradients": true, "export_native_model_files": false, "checkpoint_trainable_policies_only": false, "logger_creator": null, "logger_config": null, "log_level": "WARN", "log_sys_usage": true, "fake_sampler": false, "seed": 7, "restart_failed_env_runners": true, "ignore_env_runner_failures": false, "max_num_env_runner_restarts": 1000, "delay_between_env_runner_restarts_s": 60.0, "restart_failed_sub_environments": false, "num_consecutive_env_runner_failures_tolerance": 100, "env_runner_health_probe_timeout_s": 30.0, "env_runner_restore_timeout_s": 1800.0, "_model_config": {}, "_rl_module_spec": "RLModuleSpec(module_class=None, observation_space=None, action_space=None, inference_only=False, learner_only=False, model_config=DefaultModelConfig(fcnet_hiddens=[60, 90], fcnet_activation='tanh', fcnet_kernel_initializer=None, fcnet_kernel_initializer_kwargs=None, fcnet_bias_initializer=None, fcnet_bias_initializer_kwargs=None, conv_filters=None, conv_activation='relu', conv_kernel_initializer=None, conv_kernel_initializer_kwargs=None, conv_bias_initializer=None, conv_bias_initializer_kwargs=None, head_fcnet_hiddens=[], head_fcnet_activation='relu', head_fcnet_kernel_initializer=None, head_fcnet_kernel_initializer_kwargs=None, head_fcnet_bias_initializer=None, head_fcnet_bias_initializer_kwargs=None, free_log_std=False, log_std_clip_param=20.0, vf_share_layers=True, use_lstm=False, max_seq_len=20, lstm_cell_size=256, lstm_use_prev_action=False, lstm_use_prev_reward=False, lstm_kernel_initializer=None, lstm_kernel_initializer_kwargs=None, lstm_bias_initializer=None, lstm_bias_initializer_kwargs=None), catalog_class=None, load_state_path=None, model_config_dict=None)", "algorithm_config_overrides_per_module": {}, "_per_module_overrides": {}, "_validate_config": true, "_use_msgpack_checkpoints": false, "_torch_grad_scaler_class": null, "_torch_lr_scheduler_classes": null, "_tf_policy_handles_more_than_one_loss": false, "_disable_preprocessor_api": false, "_disable_action_flattening": false, "_disable_initialize_loss_from_dummy_batch": false, "_dont_auto_sync_env_runner_states": false, "env_task_fn": -1, "enable_connectors": -1, "simple_optimizer": false, "policy_map_cache": -1, "worker_cls": -1, "synchronize_filters": -1, "enable_async_evaluation": -1, "custom_async_evaluation_function": -1, "_enable_rl_module_api": -1, "auto_wrap_old_gym_envs": -1, "always_attach_evaluation_results": -1, "replay_sequence_length": null, "_disable_execution_plan_api": -1, "use_critic": true, "use_gae": true, "use_kl_loss": true, "kl_coeff": 0.7464963036515, "kl_target": 0.0270990929592, "vf_loss_coeff": 0.6688075857018, "entropy_coeff": 0.0090570820258, "clip_param": 0.1221781641624, "vf_clip_param": 0.1027808522125, "entropy_coeff_schedule": null, "lr_schedule": null, "sgd_minibatch_size": -1, "vf_share_layers": -1, "__stdout_file__": null, "__stderr_file__": null, "lambda": 0.9099046732075, "input": "sampler", "policies": {"default_policy": [null, null, null, null]}, "callbacks": "<class 'ray.rllib.callbacks.callbacks.RLlibCallback'>", "create_env_on_driver": false, "custom_eval_function": null, "framework": "torch"}, "time_since_restore": 32.4508216381073, "iterations_since_restore": 18, "perf": {"cpu_util_percent": 49.166666666666664, "ram_util_percent": 80.36666666666666}}
{"timers": {"training_iteration": 2.076356531496728, "restore_env_runners": 9.8483215444634e-06, "training_step": 2.0759811928049805, "env_runner_sampling_timer": 1.8516469026537967, "learner_update_timer": 0.2137311128946687, "synch_weights": 0.005647431537630384, "restore_eval_env_runners": 8.73565146319057e-05, "evaluation_iteration": 0.1660009688718431, "synch_eval_env_connectors": 0.0003055777659160299, "synch_env_connectors": 6.2745892456629006e-06}, "env_runners": {"num_agent_steps_sampled_lifetime": {"default_agent": -10487500.0}, "env_to_module_connector": {"timers": {"connectors": {"numpy_to_tensor": 9.160704895018524e-06, "batch_individual_items": 6.7234999332525096e-06, "add_observations_from_episodes_to_batch": 3.1705036043463017e-06, "add_time_dim_to_batch_and_zero_pad": 2.557080278328757e-06, "add_states_from_episodes_to_batch": 1.79793642282296e-06}}, "connector_pipeline_timer": 4.60553101914453e-05}, "module_to_env_connector": {"timers": {"connectors": {"get_actions": 4.1990442470974685e-05, "normalize_and_clip_actions": 1.0077872249622023e-05, "listify_data_for_vector_env": 1.1674591128268251e-05, "remove_single_ts_time_rank_from_batch": 6.002765107062512e-07, "tensor_to_numpy": 1.4045467165805694e-05, "un_batch_to_individual_items": 5.6672354066822e-06}}, "connector_pipeline_timer": 0.00011082187316945016}, "time_between_sampling": 0.0018803292676000487, "agent_episode_returns_mean": {"default_agent": 7.2200000000000015}, "sample": 0.005170478230626187, "env_to_module_sum_episodes_length_out": 10.36823839457432, "num_env_steps_sampled": 5000.0, "num_agent_steps_sampled": {"default_agent": 5000.0}, "module_episode_returns_mean": {"default_policy": 7.2200000000000015}, "env_reset_timer": 4.116112876452686e-05, "episode_return_max": 10.5, "episode_len_min": 20, "episode_return_mean": 7.2200000000000015, "num_episodes_lifetime": -524375.0, "env_to_module_sum_episodes_length_in": 10.36823839457432, "num_episodes": 250.0, "num_module_steps_sampled_lifetime": {"default_policy": -10487500.0}, "episode_return_min": -9.5, "episode_len_mean": 20.0, "episode_duration_sec_mean": 0.0048494708552025275, "weights_seq_no": 18.0, "episode_len_max": 20, "num_env_steps_sampled_lifetime": -10487500.0, "env_step_timer": 1.5064044774456546e-05, "rlmodule_inference_timer": 2.9745487725491322e-05, "num_module_steps_sampled": {"default_policy": 5000.0}, "num_env_steps_sampled_lifetime_throughput": 3508.659633081241}, "learners": {"default_policy": {"diff_num_grad_updates_vs_sampler_policy": 1.0, "curr_entropy_coeff": 0.0090570820258, "policy_loss": -0.1101461872458458, "default_optimizer_learning_rate": 0.0002847858517, "num_trainable_parameters": 6003, "num_module_steps_trained_lifetime": 114000, "weights_seq_no": 19.0, "vf_loss_unclipped": 27.963809967041016, "num_module_steps_trained": 6000, "mean_kl_loss": 2.036566183960531e-05, "curr_kl_coeff": 1.423828734914423e-06, "entropy": 0.5288645625114441, "module_train_batch_size_mean": 1000.0, "gradients_default_optimizer_global_norm": 0.020102325826883316, "vf_loss": 0.10278083384037018, "vf_explained_var": -0.008934259414672852, "total_loss": -0.04619554802775383, "num_module_steps_trained_lifetime_throughput": 261475.80151440436}, "__all_modules__": {"num_trainable_parameters": 6003, "learner_connector_sum_episodes_length_in": 5000.0, "learner_connector": {"timers": {"connectors": {"batch_individual_items": 0.06596376371899887, "add_columns_from_episodes_to_train_batch": 0.04552930572157581, "add_one_ts_to_episodes_and_truncate": 0.014640717548013988, "add_observations_from_episodes_to_batch": 0.0008823070242779815, "add_states_from_episodes_to_batch": 7.942130486132935e-06, "general_advantage_estimation": 0.013307629411464338, "add_time_dim_to_batch_and_zero_pad": 5.369983809152439e-05, "numpy_to_tensor": 0.00014139234389848497}}, "connector_pipeline_timer": 0.14088176285929357}, "num_env_steps_trained_lifetime": 598500, "num_env_steps_trained": 31500, "num_non_trainable_parameters": 0, "num_module_steps_trained_lifetime": 114000, "num_module_steps_trained": 6000, "learner_connector_sum_episodes_length_out": 5250.0, "num_env_steps_trained_lifetime_throughput": 1372339.1426872383, "num_module_steps_trained_throughput": 261694.3397847968, "num_module_steps_trained_lifetime_throughput": 261556.9183382732}}, "num_training_step_calls_per_iteration": 1, "evaluation": {"env_runners": {"episode_len_mean": 20.0, "module_to_env_connector": {"connector_pipeline_timer": 9.71463726370896e-05, "timers": {"connectors": {"remove_single_ts_time_rank_from_batch": 5.597542031679805e-07, "tensor_to_numpy": 1.2436578371594544e-05, "normalize_and_clip_actions": 9.21494774659663e-06, "listify_data_for_vector_env": 1.0755814471661072e-05, "un_batch_to_individual_items": 5.31934161812447e-06, "get_actions": 3.4062132929321454e-05}}}, "num_env_steps_sampled_lifetime": 95400, "rlmodule_inference_timer": 2.5970377856727783e-05, "env_to_module_connector": {"timers": {"connectors": {"add_time_dim_to_batch_and_zero_pad": 2.176796159001446e-06, "numpy_to_tensor": 8.011528928932649e-06, "batch_individual_items": 6.02525299798611e-06, "add_states_from_episodes_to_batch": 1.568129510764338e-06, "add_observations_from_episodes_to_batch": 2.8149229573888996e-06}}, "connector_pipeline_timer": 4.151741974016669e-05}, "num_episodes_lifetime": 380, "weights_seq_no": 19.0, "episode_len_max": 20, "sample": 0.14043858442997156, "episode_return_max": 14.5, "env_reset_timer": 0.0006103791354402926, "agent_episode_returns_mean": {"default_agent": -1.55}, "module_episode_returns_mean": {"default_policy": -1.55}, "num_episodes": 20, "episode_return_min": -12.5, "episode_duration_sec_mean": 0.004593687043525279, "num_module_steps_sampled": {"default_policy": 400}, "num_env_steps_sampled": 400, "num_agent_steps_sampled_lifetime": {"default_agent": 7600}, "env_to_module_sum_episodes_length_in": 10.368238394574323, "num_agent_steps_sampled": {"default_agent": 400}, "env_step_timer": 1.377291476973936e-05, "num_module_steps_sampled_lifetime": {"default_policy": 7600}, "env_to_module_sum_episodes_length_out": 10.368238394574323, "episode_len_min": 20, "episode_return_mean": -1.55, "time_between_sampling": 1.875924736871924}, "num_healthy_workers": 1, "actor_manager_num_outstanding_async_reqs": 0, "num_remote_worker_restarts": 0}, "num_env_steps_sampled_lifetime": -10487500.0, "fault_tolerance": {"num_healthy_workers": 0, "num_remote_worker_restarts": 0}, "env_runner_group": {"actor_manager_num_outstanding_async_reqs": 0}, "done": false, "training_iteration": 19, "trial_id": "4da12_00000", "date": "2025-08-11_19-22-07", "timestamp": 1754932927, "time_this_iter_s": 1.7622427940368652, "time_total_s": 34.213064432144165, "pid": 14324, "hostname": "Mac", "node_ip": "127.0.0.1", "config": {"exploration_config": {}, "extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "placement_strategy": "PACK", "num_gpus": 0, "_fake_gpus": false, "num_cpus_for_main_process": 2, "eager_tracing": true, "eager_max_retraces": 20, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "torch_compile_learner": false, "torch_compile_learner_what_to_compile": "forward_train", "torch_compile_learner_dynamo_backend": "aot_eager", "torch_compile_learner_dynamo_mode": null, "torch_compile_worker": false, "torch_compile_worker_dynamo_backend": "aot_eager", "torch_compile_worker_dynamo_mode": null, "torch_ddp_kwargs": {}, "torch_skip_nan_gradients": false, "env": "Umbrella", "env_config": {}, "observation_space": null, "action_space": null, "clip_rewards": null, "normalize_actions": true, "clip_actions": false, "_is_atari": null, "disable_env_checking": false, "render_env": false, "action_mask_key": "action_mask", "env_runner_cls": null, "num_env_runners": 0, "create_local_env_runner": true, "num_envs_per_env_runner": 1, "gym_env_vectorize_mode": "SYNC", "num_cpus_per_env_runner": 1, "num_gpus_per_env_runner": 0, "custom_resources_per_env_runner": {}, "validate_env_runners_after_construction": true, "episodes_to_numpy": true, "max_requests_in_flight_per_env_runner": 1, "sample_timeout_s": 60.0, "_env_to_module_connector": null, "add_default_connectors_to_env_to_module_pipeline": true, "_module_to_env_connector": null, "add_default_connectors_to_module_to_env_pipeline": true, "merge_env_runner_states": "training_only", "broadcast_env_runner_states": true, "episode_lookback_horizon": 1, "rollout_fragment_length": "auto", "batch_mode": "complete_episodes", "compress_observations": false, "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "enable_tf1_exec_eagerly": false, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "preprocessor_pref": "deepmind", "observation_filter": "NoFilter", "update_worker_filter_stats": true, "use_worker_filter_stats": true, "sampler_perf_stats_ema_coef": null, "_is_online": true, "num_learners": 0, "num_gpus_per_learner": 0, "num_cpus_per_learner": "auto", "num_aggregator_actors_per_learner": 0, "max_requests_in_flight_per_aggregator_actor": 3, "local_gpu_idx": 0, "max_requests_in_flight_per_learner": 3, "gamma": 1, "lr": 0.0002847858517, "grad_clip": 0.5, "grad_clip_by": "global_norm", "_train_batch_size_per_learner": 5000, "train_batch_size": 4000, "num_epochs": 1, "minibatch_size": 1000, "shuffle_batch_per_epoch": true, "model": {"fcnet_hiddens": [256, 256], "fcnet_activation": "tanh", "fcnet_weights_initializer": null, "fcnet_weights_initializer_config": null, "fcnet_bias_initializer": null, "fcnet_bias_initializer_config": null, "conv_filters": null, "conv_activation": "relu", "conv_kernel_initializer": null, "conv_kernel_initializer_config": null, "conv_bias_initializer": null, "conv_bias_initializer_config": null, "conv_transpose_kernel_initializer": null, "conv_transpose_kernel_initializer_config": null, "conv_transpose_bias_initializer": null, "conv_transpose_bias_initializer_config": null, "post_fcnet_hiddens": [], "post_fcnet_activation": "relu", "post_fcnet_weights_initializer": null, "post_fcnet_weights_initializer_config": null, "post_fcnet_bias_initializer": null, "post_fcnet_bias_initializer_config": null, "free_log_std": false, "log_std_clip_param": 20.0, "no_final_linear": false, "vf_share_layers": false, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "lstm_weights_initializer": null, "lstm_weights_initializer_config": null, "lstm_bias_initializer": null, "lstm_bias_initializer_config": null, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "attention_use_n_prev_actions": 0, "attention_use_n_prev_rewards": 0, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": null, "custom_model_config": {}, "custom_action_dist": null, "custom_preprocessor": null, "encoder_latent_dim": null, "always_check_shapes": false, "lstm_use_prev_action_reward": -1, "_use_default_native_models": -1, "_disable_preprocessor_api": false, "_disable_action_flattening": false}, "_learner_connector": null, "add_default_connectors_to_learner_pipeline": true, "learner_config_dict": {}, "optimizer": {}, "_learner_class": null, "callbacks_on_algorithm_init": null, "callbacks_on_env_runners_recreated": null, "callbacks_on_offline_eval_runners_recreated": null, "callbacks_on_checkpoint_loaded": null, "callbacks_on_environment_created": null, "callbacks_on_episode_created": null, "callbacks_on_episode_start": null, "callbacks_on_episode_step": null, "callbacks_on_episode_end": null, "callbacks_on_evaluate_start": null, "callbacks_on_evaluate_end": null, "callbacks_on_evaluate_offline_start": null, "callbacks_on_evaluate_offline_end": null, "callbacks_on_sample_end": null, "callbacks_on_train_result": null, "explore": true, "enable_rl_module_and_learner": true, "enable_env_runner_and_connector_v2": true, "_prior_exploration_config": {"type": "StochasticSampling"}, "count_steps_by": "env_steps", "policy_map_capacity": 100, "policy_mapping_fn": "<function AlgorithmConfig.DEFAULT_POLICY_MAPPING_FN at 0x385eedb20>", "policies_to_train": null, "policy_states_are_swappable": false, "observation_fn": null, "offline_data_class": null, "input_read_method": "read_parquet", "input_read_method_kwargs": {}, "input_read_schema": {}, "input_read_episodes": false, "input_read_sample_batches": false, "input_read_batch_size": null, "input_filesystem": null, "input_filesystem_kwargs": {}, "input_compress_columns": ["obs", "new_obs"], "input_spaces_jsonable": true, "materialize_data": false, "materialize_mapped_data": true, "map_batches_kwargs": {}, "iter_batches_kwargs": {}, "ignore_final_observation": false, "prelearner_class": null, "prelearner_buffer_class": null, "prelearner_buffer_kwargs": {}, "prelearner_module_synch_period": 10, "dataset_num_iters_per_learner": null, "input_config": {}, "actions_in_input_normalized": false, "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_config": {}, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "output_max_rows_per_file": null, "output_write_remaining_data": false, "output_write_method": "write_parquet", "output_write_method_kwargs": {}, "output_filesystem": null, "output_filesystem_kwargs": {}, "output_write_episodes": true, "offline_sampling": false, "evaluation_interval": 1, "evaluation_duration": 20, "evaluation_duration_unit": "episodes", "evaluation_sample_timeout_s": 120.0, "evaluation_auto_duration_min_env_steps_per_sample": 100, "evaluation_auto_duration_max_env_steps_per_sample": 2000, "evaluation_parallel_to_training": false, "evaluation_force_reset_envs_before_iteration": true, "evaluation_config": null, "off_policy_estimation_methods": {}, "ope_split_batch_by_episode": true, "evaluation_num_env_runners": 1, "in_evaluation": false, "sync_filters_on_rollout_workers_timeout_s": 10.0, "offline_evaluation_interval": null, "num_offline_eval_runners": 0, "offline_loss_for_module_fn": null, "offline_evaluation_duration": 1, "offline_evaluation_parallel_to_training": false, "offline_evaluation_timeout_s": 120.0, "num_cpus_per_offline_eval_runner": 1, "num_gpus_per_offline_eval_runner": 0, "custom_resources_per_offline_eval_runner": {}, "restart_failed_offline_eval_runners": true, "ignore_offline_eval_runner_failures": false, "max_num_offline_eval_runner_restarts": 1000, "offline_eval_runner_restore_timeout_s": 1800.0, "max_requests_in_flight_per_offline_eval_runner": 1, "validate_offline_eval_runners_after_construction": true, "offline_eval_runner_health_probe_timeout_s": 30.0, "offline_eval_rl_module_inference_only": false, "broadcast_offline_eval_runner_states": false, "offline_eval_batch_size_per_runner": 256, "dataset_num_iters_per_eval_runner": 1, "keep_per_episode_custom_metrics": false, "metrics_episode_collection_timeout_s": 60.0, "metrics_num_episodes_for_smoothing": 100, "min_time_s_per_iteration": null, "min_train_timesteps_per_iteration": 0, "min_sample_timesteps_per_iteration": 0, "log_gradients": true, "export_native_model_files": false, "checkpoint_trainable_policies_only": false, "logger_creator": null, "logger_config": null, "log_level": "WARN", "log_sys_usage": true, "fake_sampler": false, "seed": 7, "restart_failed_env_runners": true, "ignore_env_runner_failures": false, "max_num_env_runner_restarts": 1000, "delay_between_env_runner_restarts_s": 60.0, "restart_failed_sub_environments": false, "num_consecutive_env_runner_failures_tolerance": 100, "env_runner_health_probe_timeout_s": 30.0, "env_runner_restore_timeout_s": 1800.0, "_model_config": {}, "_rl_module_spec": "RLModuleSpec(module_class=None, observation_space=None, action_space=None, inference_only=False, learner_only=False, model_config=DefaultModelConfig(fcnet_hiddens=[60, 90], fcnet_activation='tanh', fcnet_kernel_initializer=None, fcnet_kernel_initializer_kwargs=None, fcnet_bias_initializer=None, fcnet_bias_initializer_kwargs=None, conv_filters=None, conv_activation='relu', conv_kernel_initializer=None, conv_kernel_initializer_kwargs=None, conv_bias_initializer=None, conv_bias_initializer_kwargs=None, head_fcnet_hiddens=[], head_fcnet_activation='relu', head_fcnet_kernel_initializer=None, head_fcnet_kernel_initializer_kwargs=None, head_fcnet_bias_initializer=None, head_fcnet_bias_initializer_kwargs=None, free_log_std=False, log_std_clip_param=20.0, vf_share_layers=True, use_lstm=False, max_seq_len=20, lstm_cell_size=256, lstm_use_prev_action=False, lstm_use_prev_reward=False, lstm_kernel_initializer=None, lstm_kernel_initializer_kwargs=None, lstm_bias_initializer=None, lstm_bias_initializer_kwargs=None), catalog_class=None, load_state_path=None, model_config_dict=None)", "algorithm_config_overrides_per_module": {}, "_per_module_overrides": {}, "_validate_config": true, "_use_msgpack_checkpoints": false, "_torch_grad_scaler_class": null, "_torch_lr_scheduler_classes": null, "_tf_policy_handles_more_than_one_loss": false, "_disable_preprocessor_api": false, "_disable_action_flattening": false, "_disable_initialize_loss_from_dummy_batch": false, "_dont_auto_sync_env_runner_states": false, "env_task_fn": -1, "enable_connectors": -1, "simple_optimizer": false, "policy_map_cache": -1, "worker_cls": -1, "synchronize_filters": -1, "enable_async_evaluation": -1, "custom_async_evaluation_function": -1, "_enable_rl_module_api": -1, "auto_wrap_old_gym_envs": -1, "always_attach_evaluation_results": -1, "replay_sequence_length": null, "_disable_execution_plan_api": -1, "use_critic": true, "use_gae": true, "use_kl_loss": true, "kl_coeff": 0.7464963036515, "kl_target": 0.0270990929592, "vf_loss_coeff": 0.6688075857018, "entropy_coeff": 0.0090570820258, "clip_param": 0.1221781641624, "vf_clip_param": 0.1027808522125, "entropy_coeff_schedule": null, "lr_schedule": null, "sgd_minibatch_size": -1, "vf_share_layers": -1, "__stdout_file__": null, "__stderr_file__": null, "lambda": 0.9099046732075, "input": "sampler", "policies": {"default_policy": [null, null, null, null]}, "callbacks": "<class 'ray.rllib.callbacks.callbacks.RLlibCallback'>", "create_env_on_driver": false, "custom_eval_function": null, "framework": "torch"}, "time_since_restore": 34.213064432144165, "iterations_since_restore": 19, "perf": {"cpu_util_percent": 45.75, "ram_util_percent": 80.4}}
{"timers": {"training_iteration": 2.0717778436823973, "restore_env_runners": 9.801917887391263e-06, "training_step": 2.071404550046748, "env_runner_sampling_timer": 1.8482287573771026, "learner_update_timer": 0.21264589509579426, "synch_weights": 0.005598471392392245, "restore_eval_env_runners": 8.65462794206605e-05, "evaluation_iteration": 0.16535436501372403, "synch_eval_env_connectors": 0.000303773238762317, "synch_env_connectors": 6.251423398474211e-06}, "env_runners": {"num_agent_steps_sampled_lifetime": {"default_agent": -11105000.0}, "env_to_module_connector": {"timers": {"connectors": {"numpy_to_tensor": 9.27006439331031e-06, "batch_individual_items": 6.777596634004983e-06, "add_observations_from_episodes_to_batch": 3.1948452657437577e-06, "add_time_dim_to_batch_and_zero_pad": 2.602778704453575e-06, "add_states_from_episodes_to_batch": 1.8205494240094094e-06}}, "connector_pipeline_timer": 4.683747842837167e-05}, "module_to_env_connector": {"timers": {"connectors": {"get_actions": 4.235407501827162e-05, "normalize_and_clip_actions": 1.0069234661367318e-05, "listify_data_for_vector_env": 1.1659789768834731e-05, "remove_single_ts_time_rank_from_batch": 6.064799826108573e-07, "tensor_to_numpy": 1.423297241440527e-05, "un_batch_to_individual_items": 5.717283476813223e-06}}, "connector_pipeline_timer": 0.00011191444872026776}, "time_between_sampling": 0.001881532645838737, "agent_episode_returns_mean": {"default_agent": 6.980000000000003}, "sample": 0.005215289916420231, "env_to_module_sum_episodes_length_out": 10.36823839457432, "num_env_steps_sampled": 5000.0, "num_agent_steps_sampled": {"default_agent": 5000.0}, "module_episode_returns_mean": {"default_policy": 6.980000000000003}, "env_reset_timer": 3.9026896974530955e-05, "episode_return_max": 10.5, "episode_len_min": 20, "episode_return_mean": 6.980000000000003, "num_episodes_lifetime": -555250.0, "env_to_module_sum_episodes_length_in": 10.36823839457432, "num_episodes": 250.0, "num_module_steps_sampled_lifetime": {"default_policy": -11105000.0}, "episode_return_min": -9.5, "episode_len_mean": 20.0, "episode_duration_sec_mean": 0.004946765820030124, "weights_seq_no": 19.0, "episode_len_max": 20, "num_env_steps_sampled_lifetime": -11105000.0, "env_step_timer": 1.4866115015772363e-05, "rlmodule_inference_timer": 2.9907333688052972e-05, "num_module_steps_sampled": {"default_policy": 5000.0}, "num_env_steps_sampled_lifetime_throughput": 3558.41694644561}, "learners": {"default_policy": {"diff_num_grad_updates_vs_sampler_policy": 1.0, "curr_entropy_coeff": 0.0090570820258, "policy_loss": 0.0007925351383164525, "default_optimizer_learning_rate": 0.0002847858517, "num_trainable_parameters": 6003, "num_module_steps_trained_lifetime": 120000, "weights_seq_no": 20.0, "vf_loss_unclipped": 28.101835250854492, "num_module_steps_trained": 6000, "mean_kl_loss": 0.0004883734509348869, "curr_kl_coeff": 7.119143674572115e-07, "entropy": 0.5163688063621521, "module_train_batch_size_mean": 1000.0, "gradients_default_optimizer_global_norm": 0.08865606784820557, "vf_loss": 0.10278083384037018, "vf_explained_var": -0.009521126747131348, "total_loss": 0.06485634297132492, "num_module_steps_trained_lifetime_throughput": 267112.39481870004}, "__all_modules__": {"num_trainable_parameters": 6003, "learner_connector_sum_episodes_length_in": 5000.0, "learner_connector": {"timers": {"connectors": {"batch_individual_items": 0.06565418692078204, "add_columns_from_episodes_to_train_batch": 0.04546743641442532, "add_one_ts_to_episodes_and_truncate": 0.014588452452585672, "add_observations_from_episodes_to_batch": 0.0008833197937724083, "add_states_from_episodes_to_batch": 7.903958622254544e-06, "general_advantage_estimation": 0.013229511037569443, "add_time_dim_to_batch_and_zero_pad": 5.3311589388073515e-05, "numpy_to_tensor": 0.00014064675965795532}}, "connector_pipeline_timer": 0.14037793148021643}, "num_env_steps_trained_lifetime": 630000, "num_env_steps_trained": 31500, "num_non_trainable_parameters": 0, "num_module_steps_trained_lifetime": 120000, "num_module_steps_trained": 6000, "learner_connector_sum_episodes_length_out": 5250.0, "num_env_steps_trained_lifetime_throughput": 1402061.8061464387, "num_module_steps_trained_throughput": 267350.8580562634, "num_module_steps_trained_lifetime_throughput": 267212.8922765278}}, "num_training_step_calls_per_iteration": 1, "evaluation": {"env_runners": {"episode_len_mean": 20.0, "module_to_env_connector": {"connector_pipeline_timer": 0.00010160307127594302, "timers": {"connectors": {"remove_single_ts_time_rank_from_batch": 5.697264407649369e-07, "tensor_to_numpy": 1.2942110581899407e-05, "normalize_and_clip_actions": 9.520770624773516e-06, "listify_data_for_vector_env": 1.1129318337953377e-05, "un_batch_to_individual_items": 5.470837117825819e-06, "get_actions": 3.659874708683797e-05}}}, "num_env_steps_sampled_lifetime": 100400, "rlmodule_inference_timer": 2.7210033168584082e-05, "env_to_module_connector": {"timers": {"connectors": {"add_time_dim_to_batch_and_zero_pad": 2.2618688629218884e-06, "numpy_to_tensor": 8.352324654407821e-06, "batch_individual_items": 6.172543587952917e-06, "add_states_from_episodes_to_batch": 1.6088025755367056e-06, "add_observations_from_episodes_to_batch": 2.8681960069888403e-06}}, "connector_pipeline_timer": 4.262180360833936e-05}, "num_episodes_lifetime": 400, "weights_seq_no": 20.0, "episode_len_max": 20, "sample": 0.14006306858640863, "episode_return_max": 14.5, "env_reset_timer": 0.0006050570147642967, "agent_episode_returns_mean": {"default_agent": -1.15}, "module_episode_returns_mean": {"default_policy": -1.15}, "num_episodes": 20, "episode_return_min": -12.5, "episode_duration_sec_mean": 0.0046595212246757, "num_module_steps_sampled": {"default_policy": 400}, "num_env_steps_sampled": 400, "num_agent_steps_sampled_lifetime": {"default_agent": 8000}, "env_to_module_sum_episodes_length_in": 10.368238394574323, "num_agent_steps_sampled": {"default_agent": 400}, "env_step_timer": 1.4053193349354013e-05, "num_module_steps_sampled_lifetime": {"default_policy": 8000}, "env_to_module_sum_episodes_length_out": 10.368238394574323, "episode_len_min": 20, "episode_return_mean": -1.15, "time_between_sampling": 1.8735255957525447}, "num_healthy_workers": 1, "actor_manager_num_outstanding_async_reqs": 0, "num_remote_worker_restarts": 0}, "num_env_steps_sampled_lifetime": -11105000.0, "fault_tolerance": {"num_healthy_workers": 0, "num_remote_worker_restarts": 0}, "env_runner_group": {"actor_manager_num_outstanding_async_reqs": 0}, "done": true, "training_iteration": 20, "trial_id": "4da12_00000", "date": "2025-08-11_19-22-09", "timestamp": 1754932929, "time_this_iter_s": 1.7292590141296387, "time_total_s": 35.942323446273804, "pid": 14324, "hostname": "Mac", "node_ip": "127.0.0.1", "config": {"exploration_config": {}, "extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "placement_strategy": "PACK", "num_gpus": 0, "_fake_gpus": false, "num_cpus_for_main_process": 2, "eager_tracing": true, "eager_max_retraces": 20, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "torch_compile_learner": false, "torch_compile_learner_what_to_compile": "forward_train", "torch_compile_learner_dynamo_backend": "aot_eager", "torch_compile_learner_dynamo_mode": null, "torch_compile_worker": false, "torch_compile_worker_dynamo_backend": "aot_eager", "torch_compile_worker_dynamo_mode": null, "torch_ddp_kwargs": {}, "torch_skip_nan_gradients": false, "env": "Umbrella", "env_config": {}, "observation_space": null, "action_space": null, "clip_rewards": null, "normalize_actions": true, "clip_actions": false, "_is_atari": null, "disable_env_checking": false, "render_env": false, "action_mask_key": "action_mask", "env_runner_cls": null, "num_env_runners": 0, "create_local_env_runner": true, "num_envs_per_env_runner": 1, "gym_env_vectorize_mode": "SYNC", "num_cpus_per_env_runner": 1, "num_gpus_per_env_runner": 0, "custom_resources_per_env_runner": {}, "validate_env_runners_after_construction": true, "episodes_to_numpy": true, "max_requests_in_flight_per_env_runner": 1, "sample_timeout_s": 60.0, "_env_to_module_connector": null, "add_default_connectors_to_env_to_module_pipeline": true, "_module_to_env_connector": null, "add_default_connectors_to_module_to_env_pipeline": true, "merge_env_runner_states": "training_only", "broadcast_env_runner_states": true, "episode_lookback_horizon": 1, "rollout_fragment_length": "auto", "batch_mode": "complete_episodes", "compress_observations": false, "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "enable_tf1_exec_eagerly": false, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "preprocessor_pref": "deepmind", "observation_filter": "NoFilter", "update_worker_filter_stats": true, "use_worker_filter_stats": true, "sampler_perf_stats_ema_coef": null, "_is_online": true, "num_learners": 0, "num_gpus_per_learner": 0, "num_cpus_per_learner": "auto", "num_aggregator_actors_per_learner": 0, "max_requests_in_flight_per_aggregator_actor": 3, "local_gpu_idx": 0, "max_requests_in_flight_per_learner": 3, "gamma": 1, "lr": 0.0002847858517, "grad_clip": 0.5, "grad_clip_by": "global_norm", "_train_batch_size_per_learner": 5000, "train_batch_size": 4000, "num_epochs": 1, "minibatch_size": 1000, "shuffle_batch_per_epoch": true, "model": {"fcnet_hiddens": [256, 256], "fcnet_activation": "tanh", "fcnet_weights_initializer": null, "fcnet_weights_initializer_config": null, "fcnet_bias_initializer": null, "fcnet_bias_initializer_config": null, "conv_filters": null, "conv_activation": "relu", "conv_kernel_initializer": null, "conv_kernel_initializer_config": null, "conv_bias_initializer": null, "conv_bias_initializer_config": null, "conv_transpose_kernel_initializer": null, "conv_transpose_kernel_initializer_config": null, "conv_transpose_bias_initializer": null, "conv_transpose_bias_initializer_config": null, "post_fcnet_hiddens": [], "post_fcnet_activation": "relu", "post_fcnet_weights_initializer": null, "post_fcnet_weights_initializer_config": null, "post_fcnet_bias_initializer": null, "post_fcnet_bias_initializer_config": null, "free_log_std": false, "log_std_clip_param": 20.0, "no_final_linear": false, "vf_share_layers": false, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "lstm_weights_initializer": null, "lstm_weights_initializer_config": null, "lstm_bias_initializer": null, "lstm_bias_initializer_config": null, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "attention_use_n_prev_actions": 0, "attention_use_n_prev_rewards": 0, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": null, "custom_model_config": {}, "custom_action_dist": null, "custom_preprocessor": null, "encoder_latent_dim": null, "always_check_shapes": false, "lstm_use_prev_action_reward": -1, "_use_default_native_models": -1, "_disable_preprocessor_api": false, "_disable_action_flattening": false}, "_learner_connector": null, "add_default_connectors_to_learner_pipeline": true, "learner_config_dict": {}, "optimizer": {}, "_learner_class": null, "callbacks_on_algorithm_init": null, "callbacks_on_env_runners_recreated": null, "callbacks_on_offline_eval_runners_recreated": null, "callbacks_on_checkpoint_loaded": null, "callbacks_on_environment_created": null, "callbacks_on_episode_created": null, "callbacks_on_episode_start": null, "callbacks_on_episode_step": null, "callbacks_on_episode_end": null, "callbacks_on_evaluate_start": null, "callbacks_on_evaluate_end": null, "callbacks_on_evaluate_offline_start": null, "callbacks_on_evaluate_offline_end": null, "callbacks_on_sample_end": null, "callbacks_on_train_result": null, "explore": true, "enable_rl_module_and_learner": true, "enable_env_runner_and_connector_v2": true, "_prior_exploration_config": {"type": "StochasticSampling"}, "count_steps_by": "env_steps", "policy_map_capacity": 100, "policy_mapping_fn": "<function AlgorithmConfig.DEFAULT_POLICY_MAPPING_FN at 0x385eedb20>", "policies_to_train": null, "policy_states_are_swappable": false, "observation_fn": null, "offline_data_class": null, "input_read_method": "read_parquet", "input_read_method_kwargs": {}, "input_read_schema": {}, "input_read_episodes": false, "input_read_sample_batches": false, "input_read_batch_size": null, "input_filesystem": null, "input_filesystem_kwargs": {}, "input_compress_columns": ["obs", "new_obs"], "input_spaces_jsonable": true, "materialize_data": false, "materialize_mapped_data": true, "map_batches_kwargs": {}, "iter_batches_kwargs": {}, "ignore_final_observation": false, "prelearner_class": null, "prelearner_buffer_class": null, "prelearner_buffer_kwargs": {}, "prelearner_module_synch_period": 10, "dataset_num_iters_per_learner": null, "input_config": {}, "actions_in_input_normalized": false, "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_config": {}, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "output_max_rows_per_file": null, "output_write_remaining_data": false, "output_write_method": "write_parquet", "output_write_method_kwargs": {}, "output_filesystem": null, "output_filesystem_kwargs": {}, "output_write_episodes": true, "offline_sampling": false, "evaluation_interval": 1, "evaluation_duration": 20, "evaluation_duration_unit": "episodes", "evaluation_sample_timeout_s": 120.0, "evaluation_auto_duration_min_env_steps_per_sample": 100, "evaluation_auto_duration_max_env_steps_per_sample": 2000, "evaluation_parallel_to_training": false, "evaluation_force_reset_envs_before_iteration": true, "evaluation_config": null, "off_policy_estimation_methods": {}, "ope_split_batch_by_episode": true, "evaluation_num_env_runners": 1, "in_evaluation": false, "sync_filters_on_rollout_workers_timeout_s": 10.0, "offline_evaluation_interval": null, "num_offline_eval_runners": 0, "offline_loss_for_module_fn": null, "offline_evaluation_duration": 1, "offline_evaluation_parallel_to_training": false, "offline_evaluation_timeout_s": 120.0, "num_cpus_per_offline_eval_runner": 1, "num_gpus_per_offline_eval_runner": 0, "custom_resources_per_offline_eval_runner": {}, "restart_failed_offline_eval_runners": true, "ignore_offline_eval_runner_failures": false, "max_num_offline_eval_runner_restarts": 1000, "offline_eval_runner_restore_timeout_s": 1800.0, "max_requests_in_flight_per_offline_eval_runner": 1, "validate_offline_eval_runners_after_construction": true, "offline_eval_runner_health_probe_timeout_s": 30.0, "offline_eval_rl_module_inference_only": false, "broadcast_offline_eval_runner_states": false, "offline_eval_batch_size_per_runner": 256, "dataset_num_iters_per_eval_runner": 1, "keep_per_episode_custom_metrics": false, "metrics_episode_collection_timeout_s": 60.0, "metrics_num_episodes_for_smoothing": 100, "min_time_s_per_iteration": null, "min_train_timesteps_per_iteration": 0, "min_sample_timesteps_per_iteration": 0, "log_gradients": true, "export_native_model_files": false, "checkpoint_trainable_policies_only": false, "logger_creator": null, "logger_config": null, "log_level": "WARN", "log_sys_usage": true, "fake_sampler": false, "seed": 7, "restart_failed_env_runners": true, "ignore_env_runner_failures": false, "max_num_env_runner_restarts": 1000, "delay_between_env_runner_restarts_s": 60.0, "restart_failed_sub_environments": false, "num_consecutive_env_runner_failures_tolerance": 100, "env_runner_health_probe_timeout_s": 30.0, "env_runner_restore_timeout_s": 1800.0, "_model_config": {}, "_rl_module_spec": "RLModuleSpec(module_class=None, observation_space=None, action_space=None, inference_only=False, learner_only=False, model_config=DefaultModelConfig(fcnet_hiddens=[60, 90], fcnet_activation='tanh', fcnet_kernel_initializer=None, fcnet_kernel_initializer_kwargs=None, fcnet_bias_initializer=None, fcnet_bias_initializer_kwargs=None, conv_filters=None, conv_activation='relu', conv_kernel_initializer=None, conv_kernel_initializer_kwargs=None, conv_bias_initializer=None, conv_bias_initializer_kwargs=None, head_fcnet_hiddens=[], head_fcnet_activation='relu', head_fcnet_kernel_initializer=None, head_fcnet_kernel_initializer_kwargs=None, head_fcnet_bias_initializer=None, head_fcnet_bias_initializer_kwargs=None, free_log_std=False, log_std_clip_param=20.0, vf_share_layers=True, use_lstm=False, max_seq_len=20, lstm_cell_size=256, lstm_use_prev_action=False, lstm_use_prev_reward=False, lstm_kernel_initializer=None, lstm_kernel_initializer_kwargs=None, lstm_bias_initializer=None, lstm_bias_initializer_kwargs=None), catalog_class=None, load_state_path=None, model_config_dict=None)", "algorithm_config_overrides_per_module": {}, "_per_module_overrides": {}, "_validate_config": true, "_use_msgpack_checkpoints": false, "_torch_grad_scaler_class": null, "_torch_lr_scheduler_classes": null, "_tf_policy_handles_more_than_one_loss": false, "_disable_preprocessor_api": false, "_disable_action_flattening": false, "_disable_initialize_loss_from_dummy_batch": false, "_dont_auto_sync_env_runner_states": false, "env_task_fn": -1, "enable_connectors": -1, "simple_optimizer": false, "policy_map_cache": -1, "worker_cls": -1, "synchronize_filters": -1, "enable_async_evaluation": -1, "custom_async_evaluation_function": -1, "_enable_rl_module_api": -1, "auto_wrap_old_gym_envs": -1, "always_attach_evaluation_results": -1, "replay_sequence_length": null, "_disable_execution_plan_api": -1, "use_critic": true, "use_gae": true, "use_kl_loss": true, "kl_coeff": 0.7464963036515, "kl_target": 0.0270990929592, "vf_loss_coeff": 0.6688075857018, "entropy_coeff": 0.0090570820258, "clip_param": 0.1221781641624, "vf_clip_param": 0.1027808522125, "entropy_coeff_schedule": null, "lr_schedule": null, "sgd_minibatch_size": -1, "vf_share_layers": -1, "__stdout_file__": null, "__stderr_file__": null, "lambda": 0.9099046732075, "input": "sampler", "policies": {"default_policy": [null, null, null, null]}, "callbacks": "<class 'ray.rllib.callbacks.callbacks.RLlibCallback'>", "create_env_on_driver": false, "custom_eval_function": null, "framework": "torch"}, "time_since_restore": 35.942323446273804, "iterations_since_restore": 20, "perf": {"cpu_util_percent": 43.43333333333334, "ram_util_percent": 79.60000000000001}}
