{"timers": {"training_iteration": 1.9220640830462798, "restore_env_runners": 9.66701190918684e-06, "training_step": 1.9219069998944178, "env_runner_sampling_timer": 1.7986985829193145, "learner_update_timer": 0.11924150004051626, "synch_weights": 0.0010600839741528034}, "env_runners": {"env_reset_timer": 0.00012356062913035555, "num_env_steps_sampled": 5000.0, "num_agent_steps_sampled_lifetime": {"default_agent": 627500.0}, "episode_duration_sec_mean": 0.006000224999617787, "time_between_sampling": 0.0006434414613592127, "module_to_env_connector": {"timers": {"connectors": {"tensor_to_numpy": 1.66541855100219e-05, "normalize_and_clip_actions": 1.4931847457683696e-05, "listify_data_for_vector_env": 1.3629144670752977e-05, "un_batch_to_individual_items": 6.5154619122485995e-06, "get_actions": 5.6634658163372584e-05, "remove_single_ts_time_rank_from_batch": 7.004728315293222e-07}}, "connector_pipeline_timer": 0.00013988855948137777}, "sample": 0.0080365270949551, "episode_return_max": 12.5, "num_env_steps_sampled_lifetime": 627500.0, "agent_episode_returns_mean": {"default_agent": 2.899999999999998}, "env_to_module_connector": {"timers": {"connectors": {"add_states_from_episodes_to_batch": 1.9567864477017563e-06, "add_observations_from_episodes_to_batch": 3.7360818790004177e-06, "numpy_to_tensor": 1.1386065034123092e-05, "batch_individual_items": 7.947056471632216e-06, "add_time_dim_to_batch_and_zero_pad": 2.8685407655960995e-06}}, "connector_pipeline_timer": 5.4603003567936154e-05}, "episode_len_max": 20, "episode_return_mean": 2.899999999999998, "weights_seq_no": 0.0, "rlmodule_inference_timer": 6.159075433675011e-05, "env_to_module_sum_episodes_length_in": 10.191744832559449, "env_step_timer": 1.812316692658006e-05, "num_module_steps_sampled": {"default_policy": 5000.0}, "episode_len_min": 20, "episode_len_mean": 20.0, "num_episodes": 250.0, "episode_return_min": -7.5, "num_module_steps_sampled_lifetime": {"default_policy": 627500.0}, "module_episode_returns_mean": {"default_policy": 2.899999999999998}, "num_agent_steps_sampled": {"default_agent": 5000.0}, "num_episodes_lifetime": 31375.0, "env_to_module_sum_episodes_length_out": 10.191744832559449, "num_env_steps_sampled_lifetime_throughput": 2896.3998638378616}, "learners": {"default_policy": {"num_module_steps_trained": 6000, "gradients_default_optimizer_global_norm": 0.10145387798547745, "vf_explained_var": 0.012743055820465088, "num_module_steps_trained_lifetime": 6000, "policy_loss": -0.07757909595966339, "num_trainable_parameters": 6003, "entropy": 0.6919029951095581, "weights_seq_no": 1.0, "curr_entropy_coeff": 0.0090570820258, "module_train_batch_size_mean": 1000.0, "total_loss": -0.016456305980682373, "default_optimizer_learning_rate": 0.0002847858517, "vf_loss": 0.10070119053125381, "curr_kl_coeff": 0.3732481598854065, "mean_kl_loss": 5.3182855481281877e-05, "vf_loss_unclipped": 28.695228576660156, "diff_num_grad_updates_vs_sampler_policy": 1.0, "num_module_steps_trained_lifetime_throughput": 323454.3645300112}, "__all_modules__": {"num_env_steps_trained_lifetime": 31500, "learner_connector_sum_episodes_length_in": 5000, "learner_connector_sum_episodes_length_out": 5250, "num_module_steps_trained": 6000, "num_env_steps_trained": 31500, "learner_connector": {"timers": {"connectors": {"add_states_from_episodes_to_batch": 4.166970029473305e-06, "general_advantage_estimation": 0.008482791017740965, "add_observations_from_episodes_to_batch": 0.0008961670100688934, "add_time_dim_to_batch_and_zero_pad": 1.3375072740018368e-05, "add_one_ts_to_episodes_and_truncate": 0.008678999962285161, "numpy_to_tensor": 7.575005292892456e-05, "batch_individual_items": 0.03295166708994657, "add_columns_from_episodes_to_train_batch": 0.0382051250198856}}, "connector_pipeline_timer": 0.08947737503331155}, "num_module_steps_trained_lifetime": 6000, "num_trainable_parameters": 6003, "num_non_trainable_parameters": 0, "num_env_steps_trained_lifetime_throughput": 1643591.1588189548, "num_module_steps_trained_throughput": 315464.81712889124, "num_module_steps_trained_lifetime_throughput": 314110.8662217206}}, "num_training_step_calls_per_iteration": 1, "num_env_steps_sampled_lifetime": 627500.0, "evaluation": {"env_runners": {"agent_episode_returns_mean": {"default_agent": 1.15}, "env_to_module_connector": {"timers": {"connectors": {"numpy_to_tensor": 1.0182381431313202e-05, "batch_individual_items": 8.893675682411878e-06, "add_observations_from_episodes_to_batch": 3.4987424446899993e-06, "add_time_dim_to_batch_and_zero_pad": 2.9329193779056783e-06, "add_states_from_episodes_to_batch": 1.6779306359155606e-06}}, "connector_pipeline_timer": 5.3201272862284025e-05}, "module_to_env_connector": {"timers": {"connectors": {"get_actions": 5.518157549673077e-05, "tensor_to_numpy": 2.89525566541715e-05, "normalize_and_clip_actions": 1.3341159864579302e-05, "remove_single_ts_time_rank_from_batch": 8.06056036269334e-07, "un_batch_to_individual_items": 6.6065831420249684e-06, "listify_data_for_vector_env": 1.2745341279889642e-05}}, "connector_pipeline_timer": 0.00014801728295573644}, "episode_len_max": 20, "env_step_timer": 1.8034681288279417e-05, "episode_len_min": 20, "episode_return_min": -12.5, "num_episodes_lifetime": 20, "num_module_steps_sampled_lifetime": {"default_policy": 400}, "sample": 0.11675258295144886, "rlmodule_inference_timer": 3.513656078015165e-05, "env_to_module_sum_episodes_length_in": 10.216013141322508, "module_episode_returns_mean": {"default_policy": 1.15}, "env_reset_timer": 0.0002732090651988983, "num_agent_steps_sampled_lifetime": {"default_agent": 400}, "weights_seq_no": 1.0, "num_module_steps_sampled": {"default_policy": 400}, "episode_len_mean": 20.0, "num_env_steps_sampled": 400, "episode_duration_sec_mean": 0.005314518610248342, "episode_return_max": 12.5, "episode_return_mean": 1.15, "env_to_module_sum_episodes_length_out": 10.216013141322508, "num_episodes": 20, "num_agent_steps_sampled": {"default_agent": 400}, "num_env_steps_sampled_lifetime": 5400}, "num_healthy_workers": 1, "actor_manager_num_outstanding_async_reqs": 0, "num_remote_worker_restarts": 0}, "fault_tolerance": {"num_healthy_workers": 0, "num_remote_worker_restarts": 0}, "env_runner_group": {"actor_manager_num_outstanding_async_reqs": 0}, "done": false, "training_iteration": 1, "trial_id": "4dd64_00000", "date": "2025-08-11_19-22-18", "timestamp": 1754932938, "time_this_iter_s": 2.0491831302642822, "time_total_s": 2.0491831302642822, "pid": 14353, "hostname": "Mac", "node_ip": "127.0.0.1", "config": {"exploration_config": {}, "extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "placement_strategy": "PACK", "num_gpus": 0, "_fake_gpus": false, "num_cpus_for_main_process": 2, "eager_tracing": true, "eager_max_retraces": 20, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "torch_compile_learner": false, "torch_compile_learner_what_to_compile": "forward_train", "torch_compile_learner_dynamo_backend": "aot_eager", "torch_compile_learner_dynamo_mode": null, "torch_compile_worker": false, "torch_compile_worker_dynamo_backend": "aot_eager", "torch_compile_worker_dynamo_mode": null, "torch_ddp_kwargs": {}, "torch_skip_nan_gradients": false, "env": "Umbrella", "env_config": {}, "observation_space": null, "action_space": null, "clip_rewards": null, "normalize_actions": true, "clip_actions": false, "_is_atari": null, "disable_env_checking": false, "render_env": false, "action_mask_key": "action_mask", "env_runner_cls": null, "num_env_runners": 0, "create_local_env_runner": true, "num_envs_per_env_runner": 1, "gym_env_vectorize_mode": "SYNC", "num_cpus_per_env_runner": 1, "num_gpus_per_env_runner": 0, "custom_resources_per_env_runner": {}, "validate_env_runners_after_construction": true, "episodes_to_numpy": true, "max_requests_in_flight_per_env_runner": 1, "sample_timeout_s": 60.0, "_env_to_module_connector": null, "add_default_connectors_to_env_to_module_pipeline": true, "_module_to_env_connector": null, "add_default_connectors_to_module_to_env_pipeline": true, "merge_env_runner_states": "training_only", "broadcast_env_runner_states": true, "episode_lookback_horizon": 1, "rollout_fragment_length": "auto", "batch_mode": "complete_episodes", "compress_observations": false, "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "enable_tf1_exec_eagerly": false, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "preprocessor_pref": "deepmind", "observation_filter": "NoFilter", "update_worker_filter_stats": true, "use_worker_filter_stats": true, "sampler_perf_stats_ema_coef": null, "_is_online": true, "num_learners": 0, "num_gpus_per_learner": 0, "num_cpus_per_learner": "auto", "num_aggregator_actors_per_learner": 0, "max_requests_in_flight_per_aggregator_actor": 3, "local_gpu_idx": 0, "max_requests_in_flight_per_learner": 3, "gamma": 1, "lr": 0.0002847858517, "grad_clip": 0.5, "grad_clip_by": "global_norm", "_train_batch_size_per_learner": 5000, "train_batch_size": 4000, "num_epochs": 1, "minibatch_size": 1000, "shuffle_batch_per_epoch": true, "model": {"fcnet_hiddens": [256, 256], "fcnet_activation": "tanh", "fcnet_weights_initializer": null, "fcnet_weights_initializer_config": null, "fcnet_bias_initializer": null, "fcnet_bias_initializer_config": null, "conv_filters": null, "conv_activation": "relu", "conv_kernel_initializer": null, "conv_kernel_initializer_config": null, "conv_bias_initializer": null, "conv_bias_initializer_config": null, "conv_transpose_kernel_initializer": null, "conv_transpose_kernel_initializer_config": null, "conv_transpose_bias_initializer": null, "conv_transpose_bias_initializer_config": null, "post_fcnet_hiddens": [], "post_fcnet_activation": "relu", "post_fcnet_weights_initializer": null, "post_fcnet_weights_initializer_config": null, "post_fcnet_bias_initializer": null, "post_fcnet_bias_initializer_config": null, "free_log_std": false, "log_std_clip_param": 20.0, "no_final_linear": false, "vf_share_layers": false, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "lstm_weights_initializer": null, "lstm_weights_initializer_config": null, "lstm_bias_initializer": null, "lstm_bias_initializer_config": null, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "attention_use_n_prev_actions": 0, "attention_use_n_prev_rewards": 0, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": null, "custom_model_config": {}, "custom_action_dist": null, "custom_preprocessor": null, "encoder_latent_dim": null, "always_check_shapes": false, "lstm_use_prev_action_reward": -1, "_use_default_native_models": -1, "_disable_preprocessor_api": false, "_disable_action_flattening": false}, "_learner_connector": null, "add_default_connectors_to_learner_pipeline": true, "learner_config_dict": {}, "optimizer": {}, "_learner_class": null, "callbacks_on_algorithm_init": null, "callbacks_on_env_runners_recreated": null, "callbacks_on_offline_eval_runners_recreated": null, "callbacks_on_checkpoint_loaded": null, "callbacks_on_environment_created": null, "callbacks_on_episode_created": null, "callbacks_on_episode_start": null, "callbacks_on_episode_step": null, "callbacks_on_episode_end": null, "callbacks_on_evaluate_start": null, "callbacks_on_evaluate_end": null, "callbacks_on_evaluate_offline_start": null, "callbacks_on_evaluate_offline_end": null, "callbacks_on_sample_end": null, "callbacks_on_train_result": null, "explore": true, "enable_rl_module_and_learner": true, "enable_env_runner_and_connector_v2": true, "_prior_exploration_config": {"type": "StochasticSampling"}, "count_steps_by": "env_steps", "policy_map_capacity": 100, "policy_mapping_fn": "<function AlgorithmConfig.DEFAULT_POLICY_MAPPING_FN at 0x3834118a0>", "policies_to_train": null, "policy_states_are_swappable": false, "observation_fn": null, "offline_data_class": null, "input_read_method": "read_parquet", "input_read_method_kwargs": {}, "input_read_schema": {}, "input_read_episodes": false, "input_read_sample_batches": false, "input_read_batch_size": null, "input_filesystem": null, "input_filesystem_kwargs": {}, "input_compress_columns": ["obs", "new_obs"], "input_spaces_jsonable": true, "materialize_data": false, "materialize_mapped_data": true, "map_batches_kwargs": {}, "iter_batches_kwargs": {}, "ignore_final_observation": false, "prelearner_class": null, "prelearner_buffer_class": null, "prelearner_buffer_kwargs": {}, "prelearner_module_synch_period": 10, "dataset_num_iters_per_learner": null, "input_config": {}, "actions_in_input_normalized": false, "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_config": {}, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "output_max_rows_per_file": null, "output_write_remaining_data": false, "output_write_method": "write_parquet", "output_write_method_kwargs": {}, "output_filesystem": null, "output_filesystem_kwargs": {}, "output_write_episodes": true, "offline_sampling": false, "evaluation_interval": 1, "evaluation_duration": 20, "evaluation_duration_unit": "episodes", "evaluation_sample_timeout_s": 120.0, "evaluation_auto_duration_min_env_steps_per_sample": 100, "evaluation_auto_duration_max_env_steps_per_sample": 2000, "evaluation_parallel_to_training": false, "evaluation_force_reset_envs_before_iteration": true, "evaluation_config": null, "off_policy_estimation_methods": {}, "ope_split_batch_by_episode": true, "evaluation_num_env_runners": 1, "in_evaluation": false, "sync_filters_on_rollout_workers_timeout_s": 10.0, "offline_evaluation_interval": null, "num_offline_eval_runners": 0, "offline_loss_for_module_fn": null, "offline_evaluation_duration": 1, "offline_evaluation_parallel_to_training": false, "offline_evaluation_timeout_s": 120.0, "num_cpus_per_offline_eval_runner": 1, "num_gpus_per_offline_eval_runner": 0, "custom_resources_per_offline_eval_runner": {}, "restart_failed_offline_eval_runners": true, "ignore_offline_eval_runner_failures": false, "max_num_offline_eval_runner_restarts": 1000, "offline_eval_runner_restore_timeout_s": 1800.0, "max_requests_in_flight_per_offline_eval_runner": 1, "validate_offline_eval_runners_after_construction": true, "offline_eval_runner_health_probe_timeout_s": 30.0, "offline_eval_rl_module_inference_only": false, "broadcast_offline_eval_runner_states": false, "offline_eval_batch_size_per_runner": 256, "dataset_num_iters_per_eval_runner": 1, "keep_per_episode_custom_metrics": false, "metrics_episode_collection_timeout_s": 60.0, "metrics_num_episodes_for_smoothing": 100, "min_time_s_per_iteration": null, "min_train_timesteps_per_iteration": 0, "min_sample_timesteps_per_iteration": 0, "log_gradients": true, "export_native_model_files": false, "checkpoint_trainable_policies_only": false, "logger_creator": null, "logger_config": null, "log_level": "WARN", "log_sys_usage": true, "fake_sampler": false, "seed": 4, "restart_failed_env_runners": true, "ignore_env_runner_failures": false, "max_num_env_runner_restarts": 1000, "delay_between_env_runner_restarts_s": 60.0, "restart_failed_sub_environments": false, "num_consecutive_env_runner_failures_tolerance": 100, "env_runner_health_probe_timeout_s": 30.0, "env_runner_restore_timeout_s": 1800.0, "_model_config": {}, "_rl_module_spec": "RLModuleSpec(module_class=None, observation_space=None, action_space=None, inference_only=False, learner_only=False, model_config=DefaultModelConfig(fcnet_hiddens=[60, 90], fcnet_activation='tanh', fcnet_kernel_initializer=None, fcnet_kernel_initializer_kwargs=None, fcnet_bias_initializer=None, fcnet_bias_initializer_kwargs=None, conv_filters=None, conv_activation='relu', conv_kernel_initializer=None, conv_kernel_initializer_kwargs=None, conv_bias_initializer=None, conv_bias_initializer_kwargs=None, head_fcnet_hiddens=[], head_fcnet_activation='relu', head_fcnet_kernel_initializer=None, head_fcnet_kernel_initializer_kwargs=None, head_fcnet_bias_initializer=None, head_fcnet_bias_initializer_kwargs=None, free_log_std=False, log_std_clip_param=20.0, vf_share_layers=True, use_lstm=False, max_seq_len=20, lstm_cell_size=256, lstm_use_prev_action=False, lstm_use_prev_reward=False, lstm_kernel_initializer=None, lstm_kernel_initializer_kwargs=None, lstm_bias_initializer=None, lstm_bias_initializer_kwargs=None), catalog_class=None, load_state_path=None, model_config_dict=None)", "algorithm_config_overrides_per_module": {}, "_per_module_overrides": {}, "_validate_config": true, "_use_msgpack_checkpoints": false, "_torch_grad_scaler_class": null, "_torch_lr_scheduler_classes": null, "_tf_policy_handles_more_than_one_loss": false, "_disable_preprocessor_api": false, "_disable_action_flattening": false, "_disable_initialize_loss_from_dummy_batch": false, "_dont_auto_sync_env_runner_states": false, "env_task_fn": -1, "enable_connectors": -1, "simple_optimizer": false, "policy_map_cache": -1, "worker_cls": -1, "synchronize_filters": -1, "enable_async_evaluation": -1, "custom_async_evaluation_function": -1, "_enable_rl_module_api": -1, "auto_wrap_old_gym_envs": -1, "always_attach_evaluation_results": -1, "replay_sequence_length": null, "_disable_execution_plan_api": -1, "use_critic": true, "use_gae": true, "use_kl_loss": true, "kl_coeff": 0.7464963036515, "kl_target": 0.0270990929592, "vf_loss_coeff": 0.6688075857018, "entropy_coeff": 0.0090570820258, "clip_param": 0.1221781641624, "vf_clip_param": 0.1027808522125, "entropy_coeff_schedule": null, "lr_schedule": null, "sgd_minibatch_size": -1, "vf_share_layers": -1, "__stdout_file__": null, "__stderr_file__": null, "lambda": 0.9099046732075, "input": "sampler", "policies": {"default_policy": [null, null, null, null]}, "callbacks": "<class 'ray.rllib.callbacks.callbacks.RLlibCallback'>", "create_env_on_driver": false, "custom_eval_function": null, "framework": "torch"}, "time_since_restore": 2.0491831302642822, "iterations_since_restore": 1, "perf": {"cpu_util_percent": 37.13333333333333, "ram_util_percent": 77.73333333333333}}
{"timers": {"training_iteration": 1.9209785063762683, "restore_env_runners": 9.636591421440244e-06, "training_step": 1.9208210023946592, "env_runner_sampling_timer": 1.7969600904197431, "learner_update_timer": 0.11989994087954983, "synch_weights": 0.0010561427241191268, "restore_eval_env_runners": 9.040930308401585e-06, "evaluation_iteration": 0.12529695802368224, "synch_eval_env_connectors": 0.0001278329873457551, "synch_env_connectors": 4.292000085115433e-06}, "env_runners": {"env_reset_timer": 6.0327479579655895e-05, "num_env_steps_sampled": 5000.0, "num_agent_steps_sampled_lifetime": {"default_agent": 10000.0}, "episode_duration_sec_mean": 0.005343260027002544, "time_between_sampling": 0.001734396965563923, "module_to_env_connector": {"timers": {"connectors": {"tensor_to_numpy": 1.5786734099688557e-05, "normalize_and_clip_actions": 1.1045929193288576e-05, "listify_data_for_vector_env": 1.2895964272009528e-05, "un_batch_to_individual_items": 6.173864026927747e-06, "get_actions": 4.869736057209606e-05, "remove_single_ts_time_rank_from_batch": 6.49161781672363e-07}}, "connector_pipeline_timer": 0.00012409596788725554}, "sample": 0.0063741699196766055, "episode_return_max": 12.5, "num_env_steps_sampled_lifetime": 10000.0, "agent_episode_returns_mean": {"default_agent": 3.1399999999999992}, "env_to_module_connector": {"timers": {"connectors": {"add_states_from_episodes_to_batch": 1.890766293871866e-06, "add_observations_from_episodes_to_batch": 3.3408244595723496e-06, "numpy_to_tensor": 1.0556845262270677e-05, "batch_individual_items": 7.537589103097767e-06, "add_time_dim_to_batch_and_zero_pad": 2.752612532615985e-06}}, "connector_pipeline_timer": 4.997535203922163e-05}, "episode_len_max": 20, "episode_return_mean": 3.1399999999999992, "weights_seq_no": 1.0, "rlmodule_inference_timer": 3.337321020521996e-05, "env_to_module_sum_episodes_length_in": 10.36823839457432, "env_step_timer": 1.6450010919774467e-05, "num_module_steps_sampled": {"default_policy": 5000.0}, "episode_len_min": 20, "episode_len_mean": 20.0, "num_episodes": 250.0, "episode_return_min": -7.5, "num_module_steps_sampled_lifetime": {"default_policy": 10000.0}, "module_episode_returns_mean": {"default_policy": 3.1399999999999992}, "num_agent_steps_sampled": {"default_agent": 5000.0}, "num_episodes_lifetime": 500.0, "env_to_module_sum_episodes_length_out": 10.36823839457432, "num_env_steps_sampled_lifetime_throughput": 3147.530531140839}, "learners": {"default_policy": {"num_module_steps_trained": 6000, "gradients_default_optimizer_global_norm": 0.09580280631780624, "vf_explained_var": 0.01552802324295044, "num_module_steps_trained_lifetime": 12000, "policy_loss": 0.15436917543411255, "num_trainable_parameters": 6003, "entropy": 0.6910908818244934, "weights_seq_no": 2.0, "curr_entropy_coeff": 0.0090570820258, "module_train_batch_size_mean": 1000.0, "total_loss": 0.21512305736541748, "default_optimizer_learning_rate": 0.0002847858517, "vf_loss": 0.10001108795404434, "curr_kl_coeff": 0.18662407994270325, "mean_kl_loss": 0.00033477909164503217, "vf_loss_unclipped": 28.312942504882812, "diff_num_grad_updates_vs_sampler_policy": 1.0, "num_module_steps_trained_lifetime_throughput": 324041.860412169}, "__all_modules__": {"num_env_steps_trained_lifetime": 63000, "learner_connector_sum_episodes_length_in": 5000.0, "learner_connector_sum_episodes_length_out": 5250.0, "num_module_steps_trained": 6000, "num_env_steps_trained": 31500, "learner_connector": {"timers": {"connectors": {"add_states_from_episodes_to_batch": 4.16071037761867e-06, "general_advantage_estimation": 0.008457142697880045, "add_observations_from_episodes_to_batch": 0.0008955978404264897, "add_time_dim_to_batch_and_zero_pad": 1.3467151438817382e-05, "add_one_ts_to_episodes_and_truncate": 0.008667792462510988, "numpy_to_tensor": 7.581505225971341e-05, "batch_individual_items": 0.033818957088515164, "add_columns_from_episodes_to_train_batch": 0.0381640604394488}}, "connector_pipeline_timer": 0.09026569586247206}, "num_module_steps_trained_lifetime": 12000, "num_trainable_parameters": 6003, "num_non_trainable_parameters": 0, "num_env_steps_trained_lifetime_throughput": 1647431.5014573033, "num_module_steps_trained_throughput": 316166.5713351426, "num_module_steps_trained_lifetime_throughput": 314830.1797194768}}, "num_training_step_calls_per_iteration": 1, "evaluation": {"env_runners": {"agent_episode_returns_mean": {"default_agent": 0.15}, "env_to_module_connector": {"timers": {"connectors": {"numpy_to_tensor": 8.55260806614131e-06, "batch_individual_items": 6.538267424603803e-06, "add_observations_from_episodes_to_batch": 2.8558730466897253e-06, "add_time_dim_to_batch_and_zero_pad": 2.293543044373247e-06, "add_states_from_episodes_to_batch": 1.5844035598169708e-06}}, "connector_pipeline_timer": 4.368065436776972e-05}, "module_to_env_connector": {"timers": {"connectors": {"get_actions": 3.725588309555009e-05, "tensor_to_numpy": 1.3321461296938665e-05, "normalize_and_clip_actions": 9.539967475350084e-06, "remove_single_ts_time_rank_from_batch": 6.370583957126373e-07, "un_batch_to_individual_items": 5.713740200225242e-06, "listify_data_for_vector_env": 1.1096333813843846e-05}}, "connector_pipeline_timer": 0.00010351175178199434}, "episode_len_max": 20, "env_step_timer": 1.4327502203983811e-05, "episode_len_min": 20, "episode_return_min": -13.5, "num_episodes_lifetime": 40, "num_module_steps_sampled_lifetime": {"default_policy": 800}, "sample": 0.1166176667122636, "rlmodule_inference_timer": 2.8362368606616266e-05, "env_to_module_sum_episodes_length_in": 10.366003441359926, "module_episode_returns_mean": {"default_policy": 0.15}, "env_reset_timer": 0.0002712132246233523, "num_agent_steps_sampled_lifetime": {"default_agent": 800}, "weights_seq_no": 2.0, "num_module_steps_sampled": {"default_policy": 400}, "episode_len_mean": 20.0, "num_env_steps_sampled": 400, "episode_duration_sec_mean": 0.005016711301868782, "episode_return_max": 12.5, "episode_return_mean": 0.15, "env_to_module_sum_episodes_length_out": 10.366003441359926, "num_episodes": 20, "num_agent_steps_sampled": {"default_agent": 400}, "num_env_steps_sampled_lifetime": 10400, "time_between_sampling": 1.8409266660455614}, "num_healthy_workers": 1, "actor_manager_num_outstanding_async_reqs": 0, "num_remote_worker_restarts": 0}, "num_env_steps_sampled_lifetime": 10000.0, "fault_tolerance": {"num_healthy_workers": 0, "num_remote_worker_restarts": 0}, "env_runner_group": {"actor_manager_num_outstanding_async_reqs": 0}, "done": false, "training_iteration": 2, "trial_id": "4dd64_00000", "date": "2025-08-11_19-22-20", "timestamp": 1754932940, "time_this_iter_s": 1.9242098331451416, "time_total_s": 3.973392963409424, "pid": 14353, "hostname": "Mac", "node_ip": "127.0.0.1", "config": {"exploration_config": {}, "extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "placement_strategy": "PACK", "num_gpus": 0, "_fake_gpus": false, "num_cpus_for_main_process": 2, "eager_tracing": true, "eager_max_retraces": 20, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "torch_compile_learner": false, "torch_compile_learner_what_to_compile": "forward_train", "torch_compile_learner_dynamo_backend": "aot_eager", "torch_compile_learner_dynamo_mode": null, "torch_compile_worker": false, "torch_compile_worker_dynamo_backend": "aot_eager", "torch_compile_worker_dynamo_mode": null, "torch_ddp_kwargs": {}, "torch_skip_nan_gradients": false, "env": "Umbrella", "env_config": {}, "observation_space": null, "action_space": null, "clip_rewards": null, "normalize_actions": true, "clip_actions": false, "_is_atari": null, "disable_env_checking": false, "render_env": false, "action_mask_key": "action_mask", "env_runner_cls": null, "num_env_runners": 0, "create_local_env_runner": true, "num_envs_per_env_runner": 1, "gym_env_vectorize_mode": "SYNC", "num_cpus_per_env_runner": 1, "num_gpus_per_env_runner": 0, "custom_resources_per_env_runner": {}, "validate_env_runners_after_construction": true, "episodes_to_numpy": true, "max_requests_in_flight_per_env_runner": 1, "sample_timeout_s": 60.0, "_env_to_module_connector": null, "add_default_connectors_to_env_to_module_pipeline": true, "_module_to_env_connector": null, "add_default_connectors_to_module_to_env_pipeline": true, "merge_env_runner_states": "training_only", "broadcast_env_runner_states": true, "episode_lookback_horizon": 1, "rollout_fragment_length": "auto", "batch_mode": "complete_episodes", "compress_observations": false, "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "enable_tf1_exec_eagerly": false, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "preprocessor_pref": "deepmind", "observation_filter": "NoFilter", "update_worker_filter_stats": true, "use_worker_filter_stats": true, "sampler_perf_stats_ema_coef": null, "_is_online": true, "num_learners": 0, "num_gpus_per_learner": 0, "num_cpus_per_learner": "auto", "num_aggregator_actors_per_learner": 0, "max_requests_in_flight_per_aggregator_actor": 3, "local_gpu_idx": 0, "max_requests_in_flight_per_learner": 3, "gamma": 1, "lr": 0.0002847858517, "grad_clip": 0.5, "grad_clip_by": "global_norm", "_train_batch_size_per_learner": 5000, "train_batch_size": 4000, "num_epochs": 1, "minibatch_size": 1000, "shuffle_batch_per_epoch": true, "model": {"fcnet_hiddens": [256, 256], "fcnet_activation": "tanh", "fcnet_weights_initializer": null, "fcnet_weights_initializer_config": null, "fcnet_bias_initializer": null, "fcnet_bias_initializer_config": null, "conv_filters": null, "conv_activation": "relu", "conv_kernel_initializer": null, "conv_kernel_initializer_config": null, "conv_bias_initializer": null, "conv_bias_initializer_config": null, "conv_transpose_kernel_initializer": null, "conv_transpose_kernel_initializer_config": null, "conv_transpose_bias_initializer": null, "conv_transpose_bias_initializer_config": null, "post_fcnet_hiddens": [], "post_fcnet_activation": "relu", "post_fcnet_weights_initializer": null, "post_fcnet_weights_initializer_config": null, "post_fcnet_bias_initializer": null, "post_fcnet_bias_initializer_config": null, "free_log_std": false, "log_std_clip_param": 20.0, "no_final_linear": false, "vf_share_layers": false, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "lstm_weights_initializer": null, "lstm_weights_initializer_config": null, "lstm_bias_initializer": null, "lstm_bias_initializer_config": null, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "attention_use_n_prev_actions": 0, "attention_use_n_prev_rewards": 0, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": null, "custom_model_config": {}, "custom_action_dist": null, "custom_preprocessor": null, "encoder_latent_dim": null, "always_check_shapes": false, "lstm_use_prev_action_reward": -1, "_use_default_native_models": -1, "_disable_preprocessor_api": false, "_disable_action_flattening": false}, "_learner_connector": null, "add_default_connectors_to_learner_pipeline": true, "learner_config_dict": {}, "optimizer": {}, "_learner_class": null, "callbacks_on_algorithm_init": null, "callbacks_on_env_runners_recreated": null, "callbacks_on_offline_eval_runners_recreated": null, "callbacks_on_checkpoint_loaded": null, "callbacks_on_environment_created": null, "callbacks_on_episode_created": null, "callbacks_on_episode_start": null, "callbacks_on_episode_step": null, "callbacks_on_episode_end": null, "callbacks_on_evaluate_start": null, "callbacks_on_evaluate_end": null, "callbacks_on_evaluate_offline_start": null, "callbacks_on_evaluate_offline_end": null, "callbacks_on_sample_end": null, "callbacks_on_train_result": null, "explore": true, "enable_rl_module_and_learner": true, "enable_env_runner_and_connector_v2": true, "_prior_exploration_config": {"type": "StochasticSampling"}, "count_steps_by": "env_steps", "policy_map_capacity": 100, "policy_mapping_fn": "<function AlgorithmConfig.DEFAULT_POLICY_MAPPING_FN at 0x3834118a0>", "policies_to_train": null, "policy_states_are_swappable": false, "observation_fn": null, "offline_data_class": null, "input_read_method": "read_parquet", "input_read_method_kwargs": {}, "input_read_schema": {}, "input_read_episodes": false, "input_read_sample_batches": false, "input_read_batch_size": null, "input_filesystem": null, "input_filesystem_kwargs": {}, "input_compress_columns": ["obs", "new_obs"], "input_spaces_jsonable": true, "materialize_data": false, "materialize_mapped_data": true, "map_batches_kwargs": {}, "iter_batches_kwargs": {}, "ignore_final_observation": false, "prelearner_class": null, "prelearner_buffer_class": null, "prelearner_buffer_kwargs": {}, "prelearner_module_synch_period": 10, "dataset_num_iters_per_learner": null, "input_config": {}, "actions_in_input_normalized": false, "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_config": {}, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "output_max_rows_per_file": null, "output_write_remaining_data": false, "output_write_method": "write_parquet", "output_write_method_kwargs": {}, "output_filesystem": null, "output_filesystem_kwargs": {}, "output_write_episodes": true, "offline_sampling": false, "evaluation_interval": 1, "evaluation_duration": 20, "evaluation_duration_unit": "episodes", "evaluation_sample_timeout_s": 120.0, "evaluation_auto_duration_min_env_steps_per_sample": 100, "evaluation_auto_duration_max_env_steps_per_sample": 2000, "evaluation_parallel_to_training": false, "evaluation_force_reset_envs_before_iteration": true, "evaluation_config": null, "off_policy_estimation_methods": {}, "ope_split_batch_by_episode": true, "evaluation_num_env_runners": 1, "in_evaluation": false, "sync_filters_on_rollout_workers_timeout_s": 10.0, "offline_evaluation_interval": null, "num_offline_eval_runners": 0, "offline_loss_for_module_fn": null, "offline_evaluation_duration": 1, "offline_evaluation_parallel_to_training": false, "offline_evaluation_timeout_s": 120.0, "num_cpus_per_offline_eval_runner": 1, "num_gpus_per_offline_eval_runner": 0, "custom_resources_per_offline_eval_runner": {}, "restart_failed_offline_eval_runners": true, "ignore_offline_eval_runner_failures": false, "max_num_offline_eval_runner_restarts": 1000, "offline_eval_runner_restore_timeout_s": 1800.0, "max_requests_in_flight_per_offline_eval_runner": 1, "validate_offline_eval_runners_after_construction": true, "offline_eval_runner_health_probe_timeout_s": 30.0, "offline_eval_rl_module_inference_only": false, "broadcast_offline_eval_runner_states": false, "offline_eval_batch_size_per_runner": 256, "dataset_num_iters_per_eval_runner": 1, "keep_per_episode_custom_metrics": false, "metrics_episode_collection_timeout_s": 60.0, "metrics_num_episodes_for_smoothing": 100, "min_time_s_per_iteration": null, "min_train_timesteps_per_iteration": 0, "min_sample_timesteps_per_iteration": 0, "log_gradients": true, "export_native_model_files": false, "checkpoint_trainable_policies_only": false, "logger_creator": null, "logger_config": null, "log_level": "WARN", "log_sys_usage": true, "fake_sampler": false, "seed": 4, "restart_failed_env_runners": true, "ignore_env_runner_failures": false, "max_num_env_runner_restarts": 1000, "delay_between_env_runner_restarts_s": 60.0, "restart_failed_sub_environments": false, "num_consecutive_env_runner_failures_tolerance": 100, "env_runner_health_probe_timeout_s": 30.0, "env_runner_restore_timeout_s": 1800.0, "_model_config": {}, "_rl_module_spec": "RLModuleSpec(module_class=None, observation_space=None, action_space=None, inference_only=False, learner_only=False, model_config=DefaultModelConfig(fcnet_hiddens=[60, 90], fcnet_activation='tanh', fcnet_kernel_initializer=None, fcnet_kernel_initializer_kwargs=None, fcnet_bias_initializer=None, fcnet_bias_initializer_kwargs=None, conv_filters=None, conv_activation='relu', conv_kernel_initializer=None, conv_kernel_initializer_kwargs=None, conv_bias_initializer=None, conv_bias_initializer_kwargs=None, head_fcnet_hiddens=[], head_fcnet_activation='relu', head_fcnet_kernel_initializer=None, head_fcnet_kernel_initializer_kwargs=None, head_fcnet_bias_initializer=None, head_fcnet_bias_initializer_kwargs=None, free_log_std=False, log_std_clip_param=20.0, vf_share_layers=True, use_lstm=False, max_seq_len=20, lstm_cell_size=256, lstm_use_prev_action=False, lstm_use_prev_reward=False, lstm_kernel_initializer=None, lstm_kernel_initializer_kwargs=None, lstm_bias_initializer=None, lstm_bias_initializer_kwargs=None), catalog_class=None, load_state_path=None, model_config_dict=None)", "algorithm_config_overrides_per_module": {}, "_per_module_overrides": {}, "_validate_config": true, "_use_msgpack_checkpoints": false, "_torch_grad_scaler_class": null, "_torch_lr_scheduler_classes": null, "_tf_policy_handles_more_than_one_loss": false, "_disable_preprocessor_api": false, "_disable_action_flattening": false, "_disable_initialize_loss_from_dummy_batch": false, "_dont_auto_sync_env_runner_states": false, "env_task_fn": -1, "enable_connectors": -1, "simple_optimizer": false, "policy_map_cache": -1, "worker_cls": -1, "synchronize_filters": -1, "enable_async_evaluation": -1, "custom_async_evaluation_function": -1, "_enable_rl_module_api": -1, "auto_wrap_old_gym_envs": -1, "always_attach_evaluation_results": -1, "replay_sequence_length": null, "_disable_execution_plan_api": -1, "use_critic": true, "use_gae": true, "use_kl_loss": true, "kl_coeff": 0.7464963036515, "kl_target": 0.0270990929592, "vf_loss_coeff": 0.6688075857018, "entropy_coeff": 0.0090570820258, "clip_param": 0.1221781641624, "vf_clip_param": 0.1027808522125, "entropy_coeff_schedule": null, "lr_schedule": null, "sgd_minibatch_size": -1, "vf_share_layers": -1, "__stdout_file__": null, "__stderr_file__": null, "lambda": 0.9099046732075, "input": "sampler", "policies": {"default_policy": [null, null, null, null]}, "callbacks": "<class 'ray.rllib.callbacks.callbacks.RLlibCallback'>", "create_env_on_driver": false, "custom_eval_function": null, "framework": "torch"}, "time_since_restore": 3.973392963409424, "iterations_since_restore": 2, "perf": {"cpu_util_percent": 49.5, "ram_util_percent": 78.99999999999999}}
{"timers": {"training_iteration": 1.917217157972732, "restore_env_runners": 9.610646299552173e-06, "training_step": 1.917059416539839, "env_runner_sampling_timer": 1.7935032995148328, "learner_update_timer": 0.11960330689123366, "synch_weights": 0.0010514771275687963, "restore_eval_env_runners": 9.035940747708082e-06, "evaluation_iteration": 0.12512967969407326, "synch_eval_env_connectors": 0.00012785590719431637, "synch_env_connectors": 4.29408042691648e-06}, "env_runners": {"env_reset_timer": 4.39220919546048e-05, "num_env_steps_sampled": 5000.0, "num_agent_steps_sampled_lifetime": {"default_agent": -607500.0}, "episode_duration_sec_mean": 0.0047705883393064155, "time_between_sampling": 0.0019183580232492406, "module_to_env_connector": {"timers": {"connectors": {"tensor_to_numpy": 1.3933418725102457e-05, "normalize_and_clip_actions": 9.805483780921814e-06, "listify_data_for_vector_env": 1.1585747874965722e-05, "un_batch_to_individual_items": 5.699323324162467e-06, "get_actions": 4.136878564371049e-05, "remove_single_ts_time_rank_from_batch": 6.06353659754675e-07}}, "connector_pipeline_timer": 0.00010937080828888941}, "sample": 0.005299612909162679, "episode_return_max": 12.5, "num_env_steps_sampled_lifetime": -607500.0, "agent_episode_returns_mean": {"default_agent": 3.06}, "env_to_module_connector": {"timers": {"connectors": {"add_states_from_episodes_to_batch": 1.7580507755274601e-06, "add_observations_from_episodes_to_batch": 3.0521561750823245e-06, "numpy_to_tensor": 9.096942775960072e-06, "batch_individual_items": 6.528176099798843e-06, "add_time_dim_to_batch_and_zero_pad": 2.3776182428193314e-06}}, "connector_pipeline_timer": 4.5001971280739375e-05}, "episode_len_max": 20, "episode_return_mean": 3.06, "weights_seq_no": 2.0, "rlmodule_inference_timer": 2.903051091284241e-05, "env_to_module_sum_episodes_length_in": 10.36823839457432, "env_step_timer": 1.4536858039512067e-05, "num_module_steps_sampled": {"default_policy": 5000.0}, "episode_len_min": 20, "episode_len_mean": 20.0, "num_episodes": 250.0, "episode_return_min": -7.5, "num_module_steps_sampled_lifetime": {"default_policy": -607500.0}, "module_episode_returns_mean": {"default_policy": 3.06}, "num_agent_steps_sampled": {"default_agent": 5000.0}, "num_episodes_lifetime": -30375.0, "env_to_module_sum_episodes_length_out": 10.36823839457432, "num_env_steps_sampled_lifetime_throughput": 3546.665257023348}, "learners": {"default_policy": {"num_module_steps_trained": 6000, "gradients_default_optimizer_global_norm": 0.10330437868833542, "vf_explained_var": 0.01814943552017212, "num_module_steps_trained_lifetime": 18000, "policy_loss": 0.07159475237131119, "num_trainable_parameters": 6003, "entropy": 0.6889595985412598, "weights_seq_no": 3.0, "curr_entropy_coeff": 0.0090570820258, "module_train_batch_size_mean": 1000.0, "total_loss": 0.13235385715961456, "default_optimizer_learning_rate": 0.0002847858517, "vf_loss": 0.1000901460647583, "curr_kl_coeff": 0.09331203997135162, "mean_kl_loss": 0.0003109359822701663, "vf_loss_unclipped": 28.33220672607422, "diff_num_grad_updates_vs_sampler_policy": 1.0, "num_module_steps_trained_lifetime_throughput": 326240.48371708376}, "__all_modules__": {"num_env_steps_trained_lifetime": 94500, "learner_connector_sum_episodes_length_in": 5000.0, "learner_connector_sum_episodes_length_out": 5250.0, "num_module_steps_trained": 6000, "num_env_steps_trained": 31500, "learner_connector": {"timers": {"connectors": {"add_states_from_episodes_to_batch": 4.148273461032658e-06, "general_advantage_estimation": 0.008424577111599501, "add_observations_from_episodes_to_batch": 0.0008948285320424475, "add_time_dim_to_batch_and_zero_pad": 1.3437890505883843e-05, "add_one_ts_to_episodes_and_truncate": 0.008657162037782837, "numpy_to_tensor": 7.565940225031226e-05, "batch_individual_items": 0.03377672251737676, "add_columns_from_episodes_to_train_batch": 0.038123673165752554}}, "connector_pipeline_timer": 0.09013815140309743}, "num_module_steps_trained_lifetime": 18000, "num_trainable_parameters": 6003, "num_non_trainable_parameters": 0, "num_env_steps_trained_lifetime_throughput": 1660255.212734359, "num_module_steps_trained_throughput": 318559.49891731906, "num_module_steps_trained_lifetime_throughput": 317250.80795669404}}, "num_training_step_calls_per_iteration": 1, "evaluation": {"env_runners": {"agent_episode_returns_mean": {"default_agent": -0.18333333333333332}, "env_to_module_connector": {"timers": {"connectors": {"numpy_to_tensor": 1.0667210896472601e-05, "batch_individual_items": 7.669455149581035e-06, "add_observations_from_episodes_to_batch": 3.554666685001427e-06, "add_time_dim_to_batch_and_zero_pad": 2.7231405651532726e-06, "add_states_from_episodes_to_batch": 1.7873405147025717e-06}}, "connector_pipeline_timer": 5.1806879870432764e-05}, "module_to_env_connector": {"timers": {"connectors": {"get_actions": 4.938845999855706e-05, "tensor_to_numpy": 1.7513862999901213e-05, "normalize_and_clip_actions": 1.1832683380002087e-05, "remove_single_ts_time_rank_from_batch": 8.483075877474826e-07, "un_batch_to_individual_items": 6.811028012449338e-06, "listify_data_for_vector_env": 1.428413461369388e-05}}, "connector_pipeline_timer": 0.00013301854367446194}, "episode_len_max": 20, "env_step_timer": 1.9489122587480185e-05, "episode_len_min": 20, "episode_return_min": -16.5, "num_episodes_lifetime": 60, "num_module_steps_sampled_lifetime": {"default_policy": 1200}, "sample": 0.11657038212599, "rlmodule_inference_timer": 3.4473899751798274e-05, "env_to_module_sum_episodes_length_in": 10.368205581254823, "module_episode_returns_mean": {"default_policy": -0.18333333333333332}, "env_reset_timer": 0.00026931109155993904, "num_agent_steps_sampled_lifetime": {"default_agent": 1200}, "weights_seq_no": 3.0, "num_module_steps_sampled": {"default_policy": 400}, "episode_len_mean": 20.0, "num_env_steps_sampled": 400, "episode_duration_sec_mean": 0.005047747834275166, "episode_return_max": 12.5, "episode_return_mean": -0.18333333333333332, "env_to_module_sum_episodes_length_out": 10.368205581254823, "num_episodes": 20, "num_agent_steps_sampled": {"default_agent": 400}, "num_env_steps_sampled_lifetime": 15400, "time_between_sampling": 1.8381493222957943}, "num_healthy_workers": 1, "actor_manager_num_outstanding_async_reqs": 0, "num_remote_worker_restarts": 0}, "num_env_steps_sampled_lifetime": -607500.0, "fault_tolerance": {"num_healthy_workers": 0, "num_remote_worker_restarts": 0}, "env_runner_group": {"actor_manager_num_outstanding_async_reqs": 0}, "done": false, "training_iteration": 3, "trial_id": "4dd64_00000", "date": "2025-08-11_19-22-22", "timestamp": 1754932942, "time_this_iter_s": 1.6642811298370361, "time_total_s": 5.63767409324646, "pid": 14353, "hostname": "Mac", "node_ip": "127.0.0.1", "config": {"exploration_config": {}, "extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "placement_strategy": "PACK", "num_gpus": 0, "_fake_gpus": false, "num_cpus_for_main_process": 2, "eager_tracing": true, "eager_max_retraces": 20, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "torch_compile_learner": false, "torch_compile_learner_what_to_compile": "forward_train", "torch_compile_learner_dynamo_backend": "aot_eager", "torch_compile_learner_dynamo_mode": null, "torch_compile_worker": false, "torch_compile_worker_dynamo_backend": "aot_eager", "torch_compile_worker_dynamo_mode": null, "torch_ddp_kwargs": {}, "torch_skip_nan_gradients": false, "env": "Umbrella", "env_config": {}, "observation_space": null, "action_space": null, "clip_rewards": null, "normalize_actions": true, "clip_actions": false, "_is_atari": null, "disable_env_checking": false, "render_env": false, "action_mask_key": "action_mask", "env_runner_cls": null, "num_env_runners": 0, "create_local_env_runner": true, "num_envs_per_env_runner": 1, "gym_env_vectorize_mode": "SYNC", "num_cpus_per_env_runner": 1, "num_gpus_per_env_runner": 0, "custom_resources_per_env_runner": {}, "validate_env_runners_after_construction": true, "episodes_to_numpy": true, "max_requests_in_flight_per_env_runner": 1, "sample_timeout_s": 60.0, "_env_to_module_connector": null, "add_default_connectors_to_env_to_module_pipeline": true, "_module_to_env_connector": null, "add_default_connectors_to_module_to_env_pipeline": true, "merge_env_runner_states": "training_only", "broadcast_env_runner_states": true, "episode_lookback_horizon": 1, "rollout_fragment_length": "auto", "batch_mode": "complete_episodes", "compress_observations": false, "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "enable_tf1_exec_eagerly": false, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "preprocessor_pref": "deepmind", "observation_filter": "NoFilter", "update_worker_filter_stats": true, "use_worker_filter_stats": true, "sampler_perf_stats_ema_coef": null, "_is_online": true, "num_learners": 0, "num_gpus_per_learner": 0, "num_cpus_per_learner": "auto", "num_aggregator_actors_per_learner": 0, "max_requests_in_flight_per_aggregator_actor": 3, "local_gpu_idx": 0, "max_requests_in_flight_per_learner": 3, "gamma": 1, "lr": 0.0002847858517, "grad_clip": 0.5, "grad_clip_by": "global_norm", "_train_batch_size_per_learner": 5000, "train_batch_size": 4000, "num_epochs": 1, "minibatch_size": 1000, "shuffle_batch_per_epoch": true, "model": {"fcnet_hiddens": [256, 256], "fcnet_activation": "tanh", "fcnet_weights_initializer": null, "fcnet_weights_initializer_config": null, "fcnet_bias_initializer": null, "fcnet_bias_initializer_config": null, "conv_filters": null, "conv_activation": "relu", "conv_kernel_initializer": null, "conv_kernel_initializer_config": null, "conv_bias_initializer": null, "conv_bias_initializer_config": null, "conv_transpose_kernel_initializer": null, "conv_transpose_kernel_initializer_config": null, "conv_transpose_bias_initializer": null, "conv_transpose_bias_initializer_config": null, "post_fcnet_hiddens": [], "post_fcnet_activation": "relu", "post_fcnet_weights_initializer": null, "post_fcnet_weights_initializer_config": null, "post_fcnet_bias_initializer": null, "post_fcnet_bias_initializer_config": null, "free_log_std": false, "log_std_clip_param": 20.0, "no_final_linear": false, "vf_share_layers": false, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "lstm_weights_initializer": null, "lstm_weights_initializer_config": null, "lstm_bias_initializer": null, "lstm_bias_initializer_config": null, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "attention_use_n_prev_actions": 0, "attention_use_n_prev_rewards": 0, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": null, "custom_model_config": {}, "custom_action_dist": null, "custom_preprocessor": null, "encoder_latent_dim": null, "always_check_shapes": false, "lstm_use_prev_action_reward": -1, "_use_default_native_models": -1, "_disable_preprocessor_api": false, "_disable_action_flattening": false}, "_learner_connector": null, "add_default_connectors_to_learner_pipeline": true, "learner_config_dict": {}, "optimizer": {}, "_learner_class": null, "callbacks_on_algorithm_init": null, "callbacks_on_env_runners_recreated": null, "callbacks_on_offline_eval_runners_recreated": null, "callbacks_on_checkpoint_loaded": null, "callbacks_on_environment_created": null, "callbacks_on_episode_created": null, "callbacks_on_episode_start": null, "callbacks_on_episode_step": null, "callbacks_on_episode_end": null, "callbacks_on_evaluate_start": null, "callbacks_on_evaluate_end": null, "callbacks_on_evaluate_offline_start": null, "callbacks_on_evaluate_offline_end": null, "callbacks_on_sample_end": null, "callbacks_on_train_result": null, "explore": true, "enable_rl_module_and_learner": true, "enable_env_runner_and_connector_v2": true, "_prior_exploration_config": {"type": "StochasticSampling"}, "count_steps_by": "env_steps", "policy_map_capacity": 100, "policy_mapping_fn": "<function AlgorithmConfig.DEFAULT_POLICY_MAPPING_FN at 0x3834118a0>", "policies_to_train": null, "policy_states_are_swappable": false, "observation_fn": null, "offline_data_class": null, "input_read_method": "read_parquet", "input_read_method_kwargs": {}, "input_read_schema": {}, "input_read_episodes": false, "input_read_sample_batches": false, "input_read_batch_size": null, "input_filesystem": null, "input_filesystem_kwargs": {}, "input_compress_columns": ["obs", "new_obs"], "input_spaces_jsonable": true, "materialize_data": false, "materialize_mapped_data": true, "map_batches_kwargs": {}, "iter_batches_kwargs": {}, "ignore_final_observation": false, "prelearner_class": null, "prelearner_buffer_class": null, "prelearner_buffer_kwargs": {}, "prelearner_module_synch_period": 10, "dataset_num_iters_per_learner": null, "input_config": {}, "actions_in_input_normalized": false, "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_config": {}, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "output_max_rows_per_file": null, "output_write_remaining_data": false, "output_write_method": "write_parquet", "output_write_method_kwargs": {}, "output_filesystem": null, "output_filesystem_kwargs": {}, "output_write_episodes": true, "offline_sampling": false, "evaluation_interval": 1, "evaluation_duration": 20, "evaluation_duration_unit": "episodes", "evaluation_sample_timeout_s": 120.0, "evaluation_auto_duration_min_env_steps_per_sample": 100, "evaluation_auto_duration_max_env_steps_per_sample": 2000, "evaluation_parallel_to_training": false, "evaluation_force_reset_envs_before_iteration": true, "evaluation_config": null, "off_policy_estimation_methods": {}, "ope_split_batch_by_episode": true, "evaluation_num_env_runners": 1, "in_evaluation": false, "sync_filters_on_rollout_workers_timeout_s": 10.0, "offline_evaluation_interval": null, "num_offline_eval_runners": 0, "offline_loss_for_module_fn": null, "offline_evaluation_duration": 1, "offline_evaluation_parallel_to_training": false, "offline_evaluation_timeout_s": 120.0, "num_cpus_per_offline_eval_runner": 1, "num_gpus_per_offline_eval_runner": 0, "custom_resources_per_offline_eval_runner": {}, "restart_failed_offline_eval_runners": true, "ignore_offline_eval_runner_failures": false, "max_num_offline_eval_runner_restarts": 1000, "offline_eval_runner_restore_timeout_s": 1800.0, "max_requests_in_flight_per_offline_eval_runner": 1, "validate_offline_eval_runners_after_construction": true, "offline_eval_runner_health_probe_timeout_s": 30.0, "offline_eval_rl_module_inference_only": false, "broadcast_offline_eval_runner_states": false, "offline_eval_batch_size_per_runner": 256, "dataset_num_iters_per_eval_runner": 1, "keep_per_episode_custom_metrics": false, "metrics_episode_collection_timeout_s": 60.0, "metrics_num_episodes_for_smoothing": 100, "min_time_s_per_iteration": null, "min_train_timesteps_per_iteration": 0, "min_sample_timesteps_per_iteration": 0, "log_gradients": true, "export_native_model_files": false, "checkpoint_trainable_policies_only": false, "logger_creator": null, "logger_config": null, "log_level": "WARN", "log_sys_usage": true, "fake_sampler": false, "seed": 4, "restart_failed_env_runners": true, "ignore_env_runner_failures": false, "max_num_env_runner_restarts": 1000, "delay_between_env_runner_restarts_s": 60.0, "restart_failed_sub_environments": false, "num_consecutive_env_runner_failures_tolerance": 100, "env_runner_health_probe_timeout_s": 30.0, "env_runner_restore_timeout_s": 1800.0, "_model_config": {}, "_rl_module_spec": "RLModuleSpec(module_class=None, observation_space=None, action_space=None, inference_only=False, learner_only=False, model_config=DefaultModelConfig(fcnet_hiddens=[60, 90], fcnet_activation='tanh', fcnet_kernel_initializer=None, fcnet_kernel_initializer_kwargs=None, fcnet_bias_initializer=None, fcnet_bias_initializer_kwargs=None, conv_filters=None, conv_activation='relu', conv_kernel_initializer=None, conv_kernel_initializer_kwargs=None, conv_bias_initializer=None, conv_bias_initializer_kwargs=None, head_fcnet_hiddens=[], head_fcnet_activation='relu', head_fcnet_kernel_initializer=None, head_fcnet_kernel_initializer_kwargs=None, head_fcnet_bias_initializer=None, head_fcnet_bias_initializer_kwargs=None, free_log_std=False, log_std_clip_param=20.0, vf_share_layers=True, use_lstm=False, max_seq_len=20, lstm_cell_size=256, lstm_use_prev_action=False, lstm_use_prev_reward=False, lstm_kernel_initializer=None, lstm_kernel_initializer_kwargs=None, lstm_bias_initializer=None, lstm_bias_initializer_kwargs=None), catalog_class=None, load_state_path=None, model_config_dict=None)", "algorithm_config_overrides_per_module": {}, "_per_module_overrides": {}, "_validate_config": true, "_use_msgpack_checkpoints": false, "_torch_grad_scaler_class": null, "_torch_lr_scheduler_classes": null, "_tf_policy_handles_more_than_one_loss": false, "_disable_preprocessor_api": false, "_disable_action_flattening": false, "_disable_initialize_loss_from_dummy_batch": false, "_dont_auto_sync_env_runner_states": false, "env_task_fn": -1, "enable_connectors": -1, "simple_optimizer": false, "policy_map_cache": -1, "worker_cls": -1, "synchronize_filters": -1, "enable_async_evaluation": -1, "custom_async_evaluation_function": -1, "_enable_rl_module_api": -1, "auto_wrap_old_gym_envs": -1, "always_attach_evaluation_results": -1, "replay_sequence_length": null, "_disable_execution_plan_api": -1, "use_critic": true, "use_gae": true, "use_kl_loss": true, "kl_coeff": 0.7464963036515, "kl_target": 0.0270990929592, "vf_loss_coeff": 0.6688075857018, "entropy_coeff": 0.0090570820258, "clip_param": 0.1221781641624, "vf_clip_param": 0.1027808522125, "entropy_coeff_schedule": null, "lr_schedule": null, "sgd_minibatch_size": -1, "vf_share_layers": -1, "__stdout_file__": null, "__stderr_file__": null, "lambda": 0.9099046732075, "input": "sampler", "policies": {"default_policy": [null, null, null, null]}, "callbacks": "<class 'ray.rllib.callbacks.callbacks.RLlibCallback'>", "create_env_on_driver": false, "custom_eval_function": null, "framework": "torch"}, "time_since_restore": 5.63767409324646, "iterations_since_restore": 3, "perf": {"cpu_util_percent": 44.73333333333333, "ram_util_percent": 78.93333333333334}}
{"timers": {"training_iteration": 1.914862849313002, "restore_env_runners": 9.584540369571187e-06, "training_step": 1.9147048423747008, "env_runner_sampling_timer": 1.7914418790192475, "learner_update_timer": 0.11931756674321066, "synch_weights": 0.0010465586061230861, "restore_eval_env_runners": 9.028911427594721e-06, "evaluation_iteration": 0.1250518595577567, "synch_eval_env_connectors": 0.00012761109755374492, "synch_env_connectors": 4.351139219943434e-06}, "env_runners": {"env_reset_timer": 4.5637118288932154e-05, "num_env_steps_sampled": 5000.0, "num_agent_steps_sampled_lifetime": {"default_agent": -1225000.0}, "episode_duration_sec_mean": 0.00493916816310957, "time_between_sampling": 0.0018988671769922412, "module_to_env_connector": {"timers": {"connectors": {"tensor_to_numpy": 1.450499013427997e-05, "normalize_and_clip_actions": 1.0191610088905068e-05, "listify_data_for_vector_env": 1.2049212875410419e-05, "un_batch_to_individual_items": 5.820091966842061e-06, "get_actions": 4.336275977594741e-05, "remove_single_ts_time_rank_from_batch": 6.147748038245355e-07}}, "connector_pipeline_timer": 0.00011368020021202317}, "sample": 0.005330077263325799, "episode_return_max": 12.5, "num_env_steps_sampled_lifetime": -1225000.0, "agent_episode_returns_mean": {"default_agent": 3.7799999999999994}, "env_to_module_connector": {"timers": {"connectors": {"add_states_from_episodes_to_batch": 1.7818701635283926e-06, "add_observations_from_episodes_to_batch": 3.2110331001897723e-06, "numpy_to_tensor": 9.481421389609038e-06, "batch_individual_items": 6.831808877543373e-06, "add_time_dim_to_batch_and_zero_pad": 2.473589876247499e-06}}, "connector_pipeline_timer": 4.638731498973193e-05}, "episode_len_max": 20, "episode_return_mean": 3.7799999999999994, "weights_seq_no": 3.0, "rlmodule_inference_timer": 3.0149863175492134e-05, "env_to_module_sum_episodes_length_in": 10.36823839457432, "env_step_timer": 1.5149247552314185e-05, "num_module_steps_sampled": {"default_policy": 5000.0}, "episode_len_min": 20, "episode_len_mean": 20.0, "num_episodes": 250.0, "episode_return_min": -7.5, "num_module_steps_sampled_lifetime": {"default_policy": -1225000.0}, "module_episode_returns_mean": {"default_policy": 3.7799999999999994}, "num_agent_steps_sampled": {"default_agent": 5000.0}, "num_episodes_lifetime": -61250.0, "env_to_module_sum_episodes_length_out": 10.36823839457432, "num_env_steps_sampled_lifetime_throughput": 3434.52164701749}, "learners": {"default_policy": {"num_module_steps_trained": 6000, "gradients_default_optimizer_global_norm": 0.026392024010419846, "vf_explained_var": 0.01967012882232666, "num_module_steps_trained_lifetime": 24000, "policy_loss": 0.1708587259054184, "num_trainable_parameters": 6003, "entropy": 0.6815755367279053, "weights_seq_no": 4.0, "curr_entropy_coeff": 0.0090570820258, "module_train_batch_size_mean": 1000.0, "total_loss": 0.23179858922958374, "default_optimizer_learning_rate": 0.0002847858517, "vf_loss": 0.10008808225393295, "curr_kl_coeff": 0.04665601998567581, "mean_kl_loss": 0.0018568553496152163, "vf_loss_unclipped": 28.318328857421875, "diff_num_grad_updates_vs_sampler_policy": 1.0, "num_module_steps_trained_lifetime_throughput": 329564.928485754}, "__all_modules__": {"num_env_steps_trained_lifetime": 126000, "learner_connector_sum_episodes_length_in": 5000.0, "learner_connector_sum_episodes_length_out": 5250.0, "num_module_steps_trained": 6000, "num_env_steps_trained": 31500, "learner_connector": {"timers": {"connectors": {"add_states_from_episodes_to_batch": 4.141381210996768e-06, "general_advantage_estimation": 0.008393067170442197, "add_observations_from_episodes_to_batch": 0.0008939702466231539, "add_time_dim_to_batch_and_zero_pad": 1.339184172626119e-05, "add_one_ts_to_episodes_and_truncate": 0.008646930836878135, "numpy_to_tensor": 7.541155831818468e-05, "batch_individual_items": 0.03374104154236102, "add_columns_from_episodes_to_train_batch": 0.03808570185345528}}, "connector_pipeline_timer": 0.09002076071901666}, "num_module_steps_trained_lifetime": 24000, "num_trainable_parameters": 6003, "num_non_trainable_parameters": 0, "num_env_steps_trained_lifetime_throughput": 1679319.7786891337, "num_module_steps_trained_throughput": 322129.99269195, "num_module_steps_trained_lifetime_throughput": 320854.9127400698}}, "num_training_step_calls_per_iteration": 1, "evaluation": {"env_runners": {"agent_episode_returns_mean": {"default_agent": 0.15}, "env_to_module_connector": {"timers": {"connectors": {"numpy_to_tensor": 9.447307096654761e-06, "batch_individual_items": 7.027748137259776e-06, "add_observations_from_episodes_to_batch": 3.6480268838226162e-06, "add_time_dim_to_batch_and_zero_pad": 2.8147798025748477e-06, "add_states_from_episodes_to_batch": 1.6248477648716502e-06}}, "connector_pipeline_timer": 4.7362527619586474e-05}, "module_to_env_connector": {"timers": {"connectors": {"get_actions": 4.023914445109494e-05, "tensor_to_numpy": 1.4541771324427603e-05, "normalize_and_clip_actions": 1.0094309244335096e-05, "remove_single_ts_time_rank_from_batch": 6.682771388202776e-07, "un_batch_to_individual_items": 6.131470600792117e-06, "listify_data_for_vector_env": 1.1925128940937746e-05}}, "connector_pipeline_timer": 0.00011162599232437073}, "episode_len_max": 20, "env_step_timer": 1.6672297842013015e-05, "episode_len_min": 20, "episode_return_min": -16.5, "num_episodes_lifetime": 80, "num_module_steps_sampled_lifetime": {"default_policy": 1600}, "sample": 0.11701832872447941, "rlmodule_inference_timer": 3.23655014083439e-05, "env_to_module_sum_episodes_length_in": 10.368237912813044, "module_episode_returns_mean": {"default_policy": 0.15}, "env_reset_timer": 0.00026734506068588226, "num_agent_steps_sampled_lifetime": {"default_agent": 1600}, "weights_seq_no": 4.0, "num_module_steps_sampled": {"default_policy": 400}, "episode_len_mean": 20.0, "num_env_steps_sampled": 400, "episode_duration_sec_mean": 0.005639089514443185, "episode_return_max": 12.5, "episode_return_mean": 0.15, "env_to_module_sum_episodes_length_out": 10.368237912813044, "num_episodes": 20, "num_agent_steps_sampled": {"default_agent": 400}, "num_env_steps_sampled_lifetime": 20400, "time_between_sampling": 1.836785508243076}, "num_healthy_workers": 1, "actor_manager_num_outstanding_async_reqs": 0, "num_remote_worker_restarts": 0}, "num_env_steps_sampled_lifetime": -1225000.0, "fault_tolerance": {"num_healthy_workers": 0, "num_remote_worker_restarts": 0}, "env_runner_group": {"actor_manager_num_outstanding_async_reqs": 0}, "done": false, "training_iteration": 4, "trial_id": "4dd64_00000", "date": "2025-08-11_19-22-23", "timestamp": 1754932943, "time_this_iter_s": 1.8499701023101807, "time_total_s": 7.487644195556641, "pid": 14353, "hostname": "Mac", "node_ip": "127.0.0.1", "config": {"exploration_config": {}, "extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "placement_strategy": "PACK", "num_gpus": 0, "_fake_gpus": false, "num_cpus_for_main_process": 2, "eager_tracing": true, "eager_max_retraces": 20, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "torch_compile_learner": false, "torch_compile_learner_what_to_compile": "forward_train", "torch_compile_learner_dynamo_backend": "aot_eager", "torch_compile_learner_dynamo_mode": null, "torch_compile_worker": false, "torch_compile_worker_dynamo_backend": "aot_eager", "torch_compile_worker_dynamo_mode": null, "torch_ddp_kwargs": {}, "torch_skip_nan_gradients": false, "env": "Umbrella", "env_config": {}, "observation_space": null, "action_space": null, "clip_rewards": null, "normalize_actions": true, "clip_actions": false, "_is_atari": null, "disable_env_checking": false, "render_env": false, "action_mask_key": "action_mask", "env_runner_cls": null, "num_env_runners": 0, "create_local_env_runner": true, "num_envs_per_env_runner": 1, "gym_env_vectorize_mode": "SYNC", "num_cpus_per_env_runner": 1, "num_gpus_per_env_runner": 0, "custom_resources_per_env_runner": {}, "validate_env_runners_after_construction": true, "episodes_to_numpy": true, "max_requests_in_flight_per_env_runner": 1, "sample_timeout_s": 60.0, "_env_to_module_connector": null, "add_default_connectors_to_env_to_module_pipeline": true, "_module_to_env_connector": null, "add_default_connectors_to_module_to_env_pipeline": true, "merge_env_runner_states": "training_only", "broadcast_env_runner_states": true, "episode_lookback_horizon": 1, "rollout_fragment_length": "auto", "batch_mode": "complete_episodes", "compress_observations": false, "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "enable_tf1_exec_eagerly": false, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "preprocessor_pref": "deepmind", "observation_filter": "NoFilter", "update_worker_filter_stats": true, "use_worker_filter_stats": true, "sampler_perf_stats_ema_coef": null, "_is_online": true, "num_learners": 0, "num_gpus_per_learner": 0, "num_cpus_per_learner": "auto", "num_aggregator_actors_per_learner": 0, "max_requests_in_flight_per_aggregator_actor": 3, "local_gpu_idx": 0, "max_requests_in_flight_per_learner": 3, "gamma": 1, "lr": 0.0002847858517, "grad_clip": 0.5, "grad_clip_by": "global_norm", "_train_batch_size_per_learner": 5000, "train_batch_size": 4000, "num_epochs": 1, "minibatch_size": 1000, "shuffle_batch_per_epoch": true, "model": {"fcnet_hiddens": [256, 256], "fcnet_activation": "tanh", "fcnet_weights_initializer": null, "fcnet_weights_initializer_config": null, "fcnet_bias_initializer": null, "fcnet_bias_initializer_config": null, "conv_filters": null, "conv_activation": "relu", "conv_kernel_initializer": null, "conv_kernel_initializer_config": null, "conv_bias_initializer": null, "conv_bias_initializer_config": null, "conv_transpose_kernel_initializer": null, "conv_transpose_kernel_initializer_config": null, "conv_transpose_bias_initializer": null, "conv_transpose_bias_initializer_config": null, "post_fcnet_hiddens": [], "post_fcnet_activation": "relu", "post_fcnet_weights_initializer": null, "post_fcnet_weights_initializer_config": null, "post_fcnet_bias_initializer": null, "post_fcnet_bias_initializer_config": null, "free_log_std": false, "log_std_clip_param": 20.0, "no_final_linear": false, "vf_share_layers": false, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "lstm_weights_initializer": null, "lstm_weights_initializer_config": null, "lstm_bias_initializer": null, "lstm_bias_initializer_config": null, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "attention_use_n_prev_actions": 0, "attention_use_n_prev_rewards": 0, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": null, "custom_model_config": {}, "custom_action_dist": null, "custom_preprocessor": null, "encoder_latent_dim": null, "always_check_shapes": false, "lstm_use_prev_action_reward": -1, "_use_default_native_models": -1, "_disable_preprocessor_api": false, "_disable_action_flattening": false}, "_learner_connector": null, "add_default_connectors_to_learner_pipeline": true, "learner_config_dict": {}, "optimizer": {}, "_learner_class": null, "callbacks_on_algorithm_init": null, "callbacks_on_env_runners_recreated": null, "callbacks_on_offline_eval_runners_recreated": null, "callbacks_on_checkpoint_loaded": null, "callbacks_on_environment_created": null, "callbacks_on_episode_created": null, "callbacks_on_episode_start": null, "callbacks_on_episode_step": null, "callbacks_on_episode_end": null, "callbacks_on_evaluate_start": null, "callbacks_on_evaluate_end": null, "callbacks_on_evaluate_offline_start": null, "callbacks_on_evaluate_offline_end": null, "callbacks_on_sample_end": null, "callbacks_on_train_result": null, "explore": true, "enable_rl_module_and_learner": true, "enable_env_runner_and_connector_v2": true, "_prior_exploration_config": {"type": "StochasticSampling"}, "count_steps_by": "env_steps", "policy_map_capacity": 100, "policy_mapping_fn": "<function AlgorithmConfig.DEFAULT_POLICY_MAPPING_FN at 0x3834118a0>", "policies_to_train": null, "policy_states_are_swappable": false, "observation_fn": null, "offline_data_class": null, "input_read_method": "read_parquet", "input_read_method_kwargs": {}, "input_read_schema": {}, "input_read_episodes": false, "input_read_sample_batches": false, "input_read_batch_size": null, "input_filesystem": null, "input_filesystem_kwargs": {}, "input_compress_columns": ["obs", "new_obs"], "input_spaces_jsonable": true, "materialize_data": false, "materialize_mapped_data": true, "map_batches_kwargs": {}, "iter_batches_kwargs": {}, "ignore_final_observation": false, "prelearner_class": null, "prelearner_buffer_class": null, "prelearner_buffer_kwargs": {}, "prelearner_module_synch_period": 10, "dataset_num_iters_per_learner": null, "input_config": {}, "actions_in_input_normalized": false, "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_config": {}, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "output_max_rows_per_file": null, "output_write_remaining_data": false, "output_write_method": "write_parquet", "output_write_method_kwargs": {}, "output_filesystem": null, "output_filesystem_kwargs": {}, "output_write_episodes": true, "offline_sampling": false, "evaluation_interval": 1, "evaluation_duration": 20, "evaluation_duration_unit": "episodes", "evaluation_sample_timeout_s": 120.0, "evaluation_auto_duration_min_env_steps_per_sample": 100, "evaluation_auto_duration_max_env_steps_per_sample": 2000, "evaluation_parallel_to_training": false, "evaluation_force_reset_envs_before_iteration": true, "evaluation_config": null, "off_policy_estimation_methods": {}, "ope_split_batch_by_episode": true, "evaluation_num_env_runners": 1, "in_evaluation": false, "sync_filters_on_rollout_workers_timeout_s": 10.0, "offline_evaluation_interval": null, "num_offline_eval_runners": 0, "offline_loss_for_module_fn": null, "offline_evaluation_duration": 1, "offline_evaluation_parallel_to_training": false, "offline_evaluation_timeout_s": 120.0, "num_cpus_per_offline_eval_runner": 1, "num_gpus_per_offline_eval_runner": 0, "custom_resources_per_offline_eval_runner": {}, "restart_failed_offline_eval_runners": true, "ignore_offline_eval_runner_failures": false, "max_num_offline_eval_runner_restarts": 1000, "offline_eval_runner_restore_timeout_s": 1800.0, "max_requests_in_flight_per_offline_eval_runner": 1, "validate_offline_eval_runners_after_construction": true, "offline_eval_runner_health_probe_timeout_s": 30.0, "offline_eval_rl_module_inference_only": false, "broadcast_offline_eval_runner_states": false, "offline_eval_batch_size_per_runner": 256, "dataset_num_iters_per_eval_runner": 1, "keep_per_episode_custom_metrics": false, "metrics_episode_collection_timeout_s": 60.0, "metrics_num_episodes_for_smoothing": 100, "min_time_s_per_iteration": null, "min_train_timesteps_per_iteration": 0, "min_sample_timesteps_per_iteration": 0, "log_gradients": true, "export_native_model_files": false, "checkpoint_trainable_policies_only": false, "logger_creator": null, "logger_config": null, "log_level": "WARN", "log_sys_usage": true, "fake_sampler": false, "seed": 4, "restart_failed_env_runners": true, "ignore_env_runner_failures": false, "max_num_env_runner_restarts": 1000, "delay_between_env_runner_restarts_s": 60.0, "restart_failed_sub_environments": false, "num_consecutive_env_runner_failures_tolerance": 100, "env_runner_health_probe_timeout_s": 30.0, "env_runner_restore_timeout_s": 1800.0, "_model_config": {}, "_rl_module_spec": "RLModuleSpec(module_class=None, observation_space=None, action_space=None, inference_only=False, learner_only=False, model_config=DefaultModelConfig(fcnet_hiddens=[60, 90], fcnet_activation='tanh', fcnet_kernel_initializer=None, fcnet_kernel_initializer_kwargs=None, fcnet_bias_initializer=None, fcnet_bias_initializer_kwargs=None, conv_filters=None, conv_activation='relu', conv_kernel_initializer=None, conv_kernel_initializer_kwargs=None, conv_bias_initializer=None, conv_bias_initializer_kwargs=None, head_fcnet_hiddens=[], head_fcnet_activation='relu', head_fcnet_kernel_initializer=None, head_fcnet_kernel_initializer_kwargs=None, head_fcnet_bias_initializer=None, head_fcnet_bias_initializer_kwargs=None, free_log_std=False, log_std_clip_param=20.0, vf_share_layers=True, use_lstm=False, max_seq_len=20, lstm_cell_size=256, lstm_use_prev_action=False, lstm_use_prev_reward=False, lstm_kernel_initializer=None, lstm_kernel_initializer_kwargs=None, lstm_bias_initializer=None, lstm_bias_initializer_kwargs=None), catalog_class=None, load_state_path=None, model_config_dict=None)", "algorithm_config_overrides_per_module": {}, "_per_module_overrides": {}, "_validate_config": true, "_use_msgpack_checkpoints": false, "_torch_grad_scaler_class": null, "_torch_lr_scheduler_classes": null, "_tf_policy_handles_more_than_one_loss": false, "_disable_preprocessor_api": false, "_disable_action_flattening": false, "_disable_initialize_loss_from_dummy_batch": false, "_dont_auto_sync_env_runner_states": false, "env_task_fn": -1, "enable_connectors": -1, "simple_optimizer": false, "policy_map_cache": -1, "worker_cls": -1, "synchronize_filters": -1, "enable_async_evaluation": -1, "custom_async_evaluation_function": -1, "_enable_rl_module_api": -1, "auto_wrap_old_gym_envs": -1, "always_attach_evaluation_results": -1, "replay_sequence_length": null, "_disable_execution_plan_api": -1, "use_critic": true, "use_gae": true, "use_kl_loss": true, "kl_coeff": 0.7464963036515, "kl_target": 0.0270990929592, "vf_loss_coeff": 0.6688075857018, "entropy_coeff": 0.0090570820258, "clip_param": 0.1221781641624, "vf_clip_param": 0.1027808522125, "entropy_coeff_schedule": null, "lr_schedule": null, "sgd_minibatch_size": -1, "vf_share_layers": -1, "__stdout_file__": null, "__stderr_file__": null, "lambda": 0.9099046732075, "input": "sampler", "policies": {"default_policy": [null, null, null, null]}, "callbacks": "<class 'ray.rllib.callbacks.callbacks.RLlibCallback'>", "create_env_on_driver": false, "custom_eval_function": null, "framework": "torch"}, "time_since_restore": 7.487644195556641, "iterations_since_restore": 4, "perf": {"cpu_util_percent": 46.45, "ram_util_percent": 78.85}}
{"timers": {"training_iteration": 1.9114563070699742, "restore_env_runners": 9.543275125360814e-06, "training_step": 1.9112979631212663, "env_runner_sampling_timer": 1.7882475464795091, "learner_update_timer": 0.11910817607664109, "synch_weights": 0.0010426055201747315, "restore_eval_env_runners": 9.033621872542425e-06, "evaluation_iteration": 0.12546212429145923, "synch_eval_env_connectors": 0.00012750498617393897, "synch_env_connectors": 4.348047227482312e-06}, "env_runners": {"env_reset_timer": 3.5318384739717586e-05, "num_env_steps_sampled": 5000.0, "num_agent_steps_sampled_lifetime": {"default_agent": -1842500.0}, "episode_duration_sec_mean": 0.004900051491800694, "time_between_sampling": 0.0018234466658651085, "module_to_env_connector": {"timers": {"connectors": {"tensor_to_numpy": 1.3195924625542743e-05, "normalize_and_clip_actions": 9.34180501042025e-06, "listify_data_for_vector_env": 1.1018154821185848e-05, "un_batch_to_individual_items": 5.421676624433512e-06, "get_actions": 3.874521170018674e-05, "remove_single_ts_time_rank_from_batch": 5.874319825569427e-07}}, "connector_pipeline_timer": 0.00010403125891712744}, "sample": 0.004983629114091728, "episode_return_max": 12.5, "num_env_steps_sampled_lifetime": -1842500.0, "agent_episode_returns_mean": {"default_agent": 4.5}, "env_to_module_connector": {"timers": {"connectors": {"add_states_from_episodes_to_batch": 1.717512416828535e-06, "add_observations_from_episodes_to_batch": 2.8985167206831604e-06, "numpy_to_tensor": 8.565458745325376e-06, "batch_individual_items": 6.2337604755324706e-06, "add_time_dim_to_batch_and_zero_pad": 2.2990925044574787e-06}}, "connector_pipeline_timer": 4.342688441993329e-05}, "episode_len_max": 20, "episode_return_mean": 4.5, "weights_seq_no": 4.0, "rlmodule_inference_timer": 4.583984579084159e-05, "env_to_module_sum_episodes_length_in": 10.36823839457432, "env_step_timer": 1.3700671166773657e-05, "num_module_steps_sampled": {"default_policy": 5000.0}, "episode_len_min": 20, "episode_len_mean": 20.0, "num_episodes": 250.0, "episode_return_min": -7.5, "num_module_steps_sampled_lifetime": {"default_policy": -1842500.0}, "module_episode_returns_mean": {"default_policy": 4.5}, "num_agent_steps_sampled": {"default_agent": 5000.0}, "num_episodes_lifetime": -92125.0, "env_to_module_sum_episodes_length_out": 10.36823839457432, "num_env_steps_sampled_lifetime_throughput": 3719.4151315414674}, "learners": {"default_policy": {"num_module_steps_trained": 6000, "gradients_default_optimizer_global_norm": 0.055656589567661285, "vf_explained_var": 0.02140355110168457, "num_module_steps_trained_lifetime": 30000, "policy_loss": 0.09948650747537613, "num_trainable_parameters": 6003, "entropy": 0.6678587794303894, "weights_seq_no": 5.0, "curr_entropy_coeff": 0.0090570820258, "module_train_batch_size_mean": 1000.0, "total_loss": 0.16066518425941467, "default_optimizer_learning_rate": 0.0002847858517, "vf_loss": 0.1004083901643753, "curr_kl_coeff": 0.023328009992837906, "mean_kl_loss": 0.001579137286171317, "vf_loss_unclipped": 28.426040649414062, "diff_num_grad_updates_vs_sampler_policy": 1.0, "num_module_steps_trained_lifetime_throughput": 332478.5013730363}, "__all_modules__": {"num_env_steps_trained_lifetime": 157500, "learner_connector_sum_episodes_length_in": 5000.0, "learner_connector_sum_episodes_length_out": 5250.0, "num_module_steps_trained": 6000, "num_env_steps_trained": 31500, "learner_connector": {"timers": {"connectors": {"add_states_from_episodes_to_batch": 4.1295485321630245e-06, "general_advantage_estimation": 0.008370318998368152, "add_observations_from_episodes_to_batch": 0.0008933684644557222, "add_time_dim_to_batch_and_zero_pad": 1.3365843804791801e-05, "add_one_ts_to_episodes_and_truncate": 0.008643027369075885, "numpy_to_tensor": 7.545994360694429e-05, "batch_individual_items": 0.033718476127331094, "add_columns_from_episodes_to_train_batch": 0.0380672102553628}}, "connector_pipeline_timer": 0.08995208103249916}, "num_module_steps_trained_lifetime": 30000, "num_trainable_parameters": 6003, "num_non_trainable_parameters": 0, "num_env_steps_trained_lifetime_throughput": 1696430.9055739841, "num_module_steps_trained_throughput": 325322.4202759869, "num_module_steps_trained_lifetime_throughput": 324084.0404990007}}, "num_training_step_calls_per_iteration": 1, "evaluation": {"env_runners": {"agent_episode_returns_mean": {"default_agent": 0.35}, "env_to_module_connector": {"timers": {"connectors": {"numpy_to_tensor": 9.075520537900964e-06, "batch_individual_items": 6.5548739597136776e-06, "add_observations_from_episodes_to_batch": 3.5554632640232598e-06, "add_time_dim_to_batch_and_zero_pad": 2.417171355878127e-06, "add_states_from_episodes_to_batch": 1.608947665074859e-06}}, "connector_pipeline_timer": 4.600784879843881e-05}, "module_to_env_connector": {"timers": {"connectors": {"get_actions": 4.049233589226919e-05, "tensor_to_numpy": 1.4941625782134226e-05, "normalize_and_clip_actions": 1.0948121414926059e-05, "remove_single_ts_time_rank_from_batch": 7.156456866236703e-07, "un_batch_to_individual_items": 6.365806963821184e-06, "listify_data_for_vector_env": 1.162614359617663e-05}}, "connector_pipeline_timer": 0.00011216105893927867}, "episode_len_max": 20, "env_step_timer": 1.554555335570677e-05, "episode_len_min": 20, "episode_return_min": -16.5, "num_episodes_lifetime": 100, "num_module_steps_sampled_lifetime": {"default_policy": 2000}, "sample": 0.11692692918707019, "rlmodule_inference_timer": 3.165233968162459e-05, "env_to_module_sum_episodes_length_in": 10.368238387501162, "module_episode_returns_mean": {"default_policy": 0.35}, "env_reset_timer": 0.00026554077967746873, "num_agent_steps_sampled_lifetime": {"default_agent": 2000}, "weights_seq_no": 5.0, "num_module_steps_sampled": {"default_policy": 400}, "episode_len_mean": 20.0, "num_env_steps_sampled": 400, "episode_duration_sec_mean": 0.005495622031157836, "episode_return_max": 12.5, "episode_return_mean": 0.35, "env_to_module_sum_episodes_length_out": 10.368238387501162, "num_episodes": 20, "num_agent_steps_sampled": {"default_agent": 400}, "num_env_steps_sampled_lifetime": 25400, "time_between_sampling": 1.8343267252410393}, "num_healthy_workers": 1, "actor_manager_num_outstanding_async_reqs": 0, "num_remote_worker_restarts": 0}, "num_env_steps_sampled_lifetime": -1842500.0, "fault_tolerance": {"num_healthy_workers": 0, "num_remote_worker_restarts": 0}, "env_runner_group": {"actor_manager_num_outstanding_async_reqs": 0}, "done": false, "training_iteration": 5, "trial_id": "4dd64_00000", "date": "2025-08-11_19-22-25", "timestamp": 1754932945, "time_this_iter_s": 1.6893439292907715, "time_total_s": 9.176988124847412, "pid": 14353, "hostname": "Mac", "node_ip": "127.0.0.1", "config": {"exploration_config": {}, "extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "placement_strategy": "PACK", "num_gpus": 0, "_fake_gpus": false, "num_cpus_for_main_process": 2, "eager_tracing": true, "eager_max_retraces": 20, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "torch_compile_learner": false, "torch_compile_learner_what_to_compile": "forward_train", "torch_compile_learner_dynamo_backend": "aot_eager", "torch_compile_learner_dynamo_mode": null, "torch_compile_worker": false, "torch_compile_worker_dynamo_backend": "aot_eager", "torch_compile_worker_dynamo_mode": null, "torch_ddp_kwargs": {}, "torch_skip_nan_gradients": false, "env": "Umbrella", "env_config": {}, "observation_space": null, "action_space": null, "clip_rewards": null, "normalize_actions": true, "clip_actions": false, "_is_atari": null, "disable_env_checking": false, "render_env": false, "action_mask_key": "action_mask", "env_runner_cls": null, "num_env_runners": 0, "create_local_env_runner": true, "num_envs_per_env_runner": 1, "gym_env_vectorize_mode": "SYNC", "num_cpus_per_env_runner": 1, "num_gpus_per_env_runner": 0, "custom_resources_per_env_runner": {}, "validate_env_runners_after_construction": true, "episodes_to_numpy": true, "max_requests_in_flight_per_env_runner": 1, "sample_timeout_s": 60.0, "_env_to_module_connector": null, "add_default_connectors_to_env_to_module_pipeline": true, "_module_to_env_connector": null, "add_default_connectors_to_module_to_env_pipeline": true, "merge_env_runner_states": "training_only", "broadcast_env_runner_states": true, "episode_lookback_horizon": 1, "rollout_fragment_length": "auto", "batch_mode": "complete_episodes", "compress_observations": false, "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "enable_tf1_exec_eagerly": false, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "preprocessor_pref": "deepmind", "observation_filter": "NoFilter", "update_worker_filter_stats": true, "use_worker_filter_stats": true, "sampler_perf_stats_ema_coef": null, "_is_online": true, "num_learners": 0, "num_gpus_per_learner": 0, "num_cpus_per_learner": "auto", "num_aggregator_actors_per_learner": 0, "max_requests_in_flight_per_aggregator_actor": 3, "local_gpu_idx": 0, "max_requests_in_flight_per_learner": 3, "gamma": 1, "lr": 0.0002847858517, "grad_clip": 0.5, "grad_clip_by": "global_norm", "_train_batch_size_per_learner": 5000, "train_batch_size": 4000, "num_epochs": 1, "minibatch_size": 1000, "shuffle_batch_per_epoch": true, "model": {"fcnet_hiddens": [256, 256], "fcnet_activation": "tanh", "fcnet_weights_initializer": null, "fcnet_weights_initializer_config": null, "fcnet_bias_initializer": null, "fcnet_bias_initializer_config": null, "conv_filters": null, "conv_activation": "relu", "conv_kernel_initializer": null, "conv_kernel_initializer_config": null, "conv_bias_initializer": null, "conv_bias_initializer_config": null, "conv_transpose_kernel_initializer": null, "conv_transpose_kernel_initializer_config": null, "conv_transpose_bias_initializer": null, "conv_transpose_bias_initializer_config": null, "post_fcnet_hiddens": [], "post_fcnet_activation": "relu", "post_fcnet_weights_initializer": null, "post_fcnet_weights_initializer_config": null, "post_fcnet_bias_initializer": null, "post_fcnet_bias_initializer_config": null, "free_log_std": false, "log_std_clip_param": 20.0, "no_final_linear": false, "vf_share_layers": false, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "lstm_weights_initializer": null, "lstm_weights_initializer_config": null, "lstm_bias_initializer": null, "lstm_bias_initializer_config": null, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "attention_use_n_prev_actions": 0, "attention_use_n_prev_rewards": 0, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": null, "custom_model_config": {}, "custom_action_dist": null, "custom_preprocessor": null, "encoder_latent_dim": null, "always_check_shapes": false, "lstm_use_prev_action_reward": -1, "_use_default_native_models": -1, "_disable_preprocessor_api": false, "_disable_action_flattening": false}, "_learner_connector": null, "add_default_connectors_to_learner_pipeline": true, "learner_config_dict": {}, "optimizer": {}, "_learner_class": null, "callbacks_on_algorithm_init": null, "callbacks_on_env_runners_recreated": null, "callbacks_on_offline_eval_runners_recreated": null, "callbacks_on_checkpoint_loaded": null, "callbacks_on_environment_created": null, "callbacks_on_episode_created": null, "callbacks_on_episode_start": null, "callbacks_on_episode_step": null, "callbacks_on_episode_end": null, "callbacks_on_evaluate_start": null, "callbacks_on_evaluate_end": null, "callbacks_on_evaluate_offline_start": null, "callbacks_on_evaluate_offline_end": null, "callbacks_on_sample_end": null, "callbacks_on_train_result": null, "explore": true, "enable_rl_module_and_learner": true, "enable_env_runner_and_connector_v2": true, "_prior_exploration_config": {"type": "StochasticSampling"}, "count_steps_by": "env_steps", "policy_map_capacity": 100, "policy_mapping_fn": "<function AlgorithmConfig.DEFAULT_POLICY_MAPPING_FN at 0x3834118a0>", "policies_to_train": null, "policy_states_are_swappable": false, "observation_fn": null, "offline_data_class": null, "input_read_method": "read_parquet", "input_read_method_kwargs": {}, "input_read_schema": {}, "input_read_episodes": false, "input_read_sample_batches": false, "input_read_batch_size": null, "input_filesystem": null, "input_filesystem_kwargs": {}, "input_compress_columns": ["obs", "new_obs"], "input_spaces_jsonable": true, "materialize_data": false, "materialize_mapped_data": true, "map_batches_kwargs": {}, "iter_batches_kwargs": {}, "ignore_final_observation": false, "prelearner_class": null, "prelearner_buffer_class": null, "prelearner_buffer_kwargs": {}, "prelearner_module_synch_period": 10, "dataset_num_iters_per_learner": null, "input_config": {}, "actions_in_input_normalized": false, "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_config": {}, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "output_max_rows_per_file": null, "output_write_remaining_data": false, "output_write_method": "write_parquet", "output_write_method_kwargs": {}, "output_filesystem": null, "output_filesystem_kwargs": {}, "output_write_episodes": true, "offline_sampling": false, "evaluation_interval": 1, "evaluation_duration": 20, "evaluation_duration_unit": "episodes", "evaluation_sample_timeout_s": 120.0, "evaluation_auto_duration_min_env_steps_per_sample": 100, "evaluation_auto_duration_max_env_steps_per_sample": 2000, "evaluation_parallel_to_training": false, "evaluation_force_reset_envs_before_iteration": true, "evaluation_config": null, "off_policy_estimation_methods": {}, "ope_split_batch_by_episode": true, "evaluation_num_env_runners": 1, "in_evaluation": false, "sync_filters_on_rollout_workers_timeout_s": 10.0, "offline_evaluation_interval": null, "num_offline_eval_runners": 0, "offline_loss_for_module_fn": null, "offline_evaluation_duration": 1, "offline_evaluation_parallel_to_training": false, "offline_evaluation_timeout_s": 120.0, "num_cpus_per_offline_eval_runner": 1, "num_gpus_per_offline_eval_runner": 0, "custom_resources_per_offline_eval_runner": {}, "restart_failed_offline_eval_runners": true, "ignore_offline_eval_runner_failures": false, "max_num_offline_eval_runner_restarts": 1000, "offline_eval_runner_restore_timeout_s": 1800.0, "max_requests_in_flight_per_offline_eval_runner": 1, "validate_offline_eval_runners_after_construction": true, "offline_eval_runner_health_probe_timeout_s": 30.0, "offline_eval_rl_module_inference_only": false, "broadcast_offline_eval_runner_states": false, "offline_eval_batch_size_per_runner": 256, "dataset_num_iters_per_eval_runner": 1, "keep_per_episode_custom_metrics": false, "metrics_episode_collection_timeout_s": 60.0, "metrics_num_episodes_for_smoothing": 100, "min_time_s_per_iteration": null, "min_train_timesteps_per_iteration": 0, "min_sample_timesteps_per_iteration": 0, "log_gradients": true, "export_native_model_files": false, "checkpoint_trainable_policies_only": false, "logger_creator": null, "logger_config": null, "log_level": "WARN", "log_sys_usage": true, "fake_sampler": false, "seed": 4, "restart_failed_env_runners": true, "ignore_env_runner_failures": false, "max_num_env_runner_restarts": 1000, "delay_between_env_runner_restarts_s": 60.0, "restart_failed_sub_environments": false, "num_consecutive_env_runner_failures_tolerance": 100, "env_runner_health_probe_timeout_s": 30.0, "env_runner_restore_timeout_s": 1800.0, "_model_config": {}, "_rl_module_spec": "RLModuleSpec(module_class=None, observation_space=None, action_space=None, inference_only=False, learner_only=False, model_config=DefaultModelConfig(fcnet_hiddens=[60, 90], fcnet_activation='tanh', fcnet_kernel_initializer=None, fcnet_kernel_initializer_kwargs=None, fcnet_bias_initializer=None, fcnet_bias_initializer_kwargs=None, conv_filters=None, conv_activation='relu', conv_kernel_initializer=None, conv_kernel_initializer_kwargs=None, conv_bias_initializer=None, conv_bias_initializer_kwargs=None, head_fcnet_hiddens=[], head_fcnet_activation='relu', head_fcnet_kernel_initializer=None, head_fcnet_kernel_initializer_kwargs=None, head_fcnet_bias_initializer=None, head_fcnet_bias_initializer_kwargs=None, free_log_std=False, log_std_clip_param=20.0, vf_share_layers=True, use_lstm=False, max_seq_len=20, lstm_cell_size=256, lstm_use_prev_action=False, lstm_use_prev_reward=False, lstm_kernel_initializer=None, lstm_kernel_initializer_kwargs=None, lstm_bias_initializer=None, lstm_bias_initializer_kwargs=None), catalog_class=None, load_state_path=None, model_config_dict=None)", "algorithm_config_overrides_per_module": {}, "_per_module_overrides": {}, "_validate_config": true, "_use_msgpack_checkpoints": false, "_torch_grad_scaler_class": null, "_torch_lr_scheduler_classes": null, "_tf_policy_handles_more_than_one_loss": false, "_disable_preprocessor_api": false, "_disable_action_flattening": false, "_disable_initialize_loss_from_dummy_batch": false, "_dont_auto_sync_env_runner_states": false, "env_task_fn": -1, "enable_connectors": -1, "simple_optimizer": false, "policy_map_cache": -1, "worker_cls": -1, "synchronize_filters": -1, "enable_async_evaluation": -1, "custom_async_evaluation_function": -1, "_enable_rl_module_api": -1, "auto_wrap_old_gym_envs": -1, "always_attach_evaluation_results": -1, "replay_sequence_length": null, "_disable_execution_plan_api": -1, "use_critic": true, "use_gae": true, "use_kl_loss": true, "kl_coeff": 0.7464963036515, "kl_target": 0.0270990929592, "vf_loss_coeff": 0.6688075857018, "entropy_coeff": 0.0090570820258, "clip_param": 0.1221781641624, "vf_clip_param": 0.1027808522125, "entropy_coeff_schedule": null, "lr_schedule": null, "sgd_minibatch_size": -1, "vf_share_layers": -1, "__stdout_file__": null, "__stderr_file__": null, "lambda": 0.9099046732075, "input": "sampler", "policies": {"default_policy": [null, null, null, null]}, "callbacks": "<class 'ray.rllib.callbacks.callbacks.RLlibCallback'>", "create_env_on_driver": false, "custom_eval_function": null, "framework": "torch"}, "time_since_restore": 9.176988124847412, "iterations_since_restore": 5, "perf": {"cpu_util_percent": 45.93333333333334, "ram_util_percent": 78.26666666666667}}
{"timers": {"training_iteration": 1.9093504856683985, "restore_env_runners": 9.507421407511795e-06, "training_step": 1.9091915318200088, "env_runner_sampling_timer": 1.7854258426753604, "learner_update_timer": 0.1198312172354267, "synch_weights": 0.0010379411246771329, "restore_eval_env_runners": 9.00912666738266e-06, "evaluation_iteration": 0.12533743596899313, "synch_eval_env_connectors": 0.00012793535558438393, "synch_env_connectors": 4.345816196190426e-06}, "env_runners": {"env_reset_timer": 4.111384243461652e-05, "num_env_steps_sampled": 5000.0, "num_agent_steps_sampled_lifetime": {"default_agent": -2460000.0}, "episode_duration_sec_mean": 0.00492788056563586, "time_between_sampling": 0.001631419452979479, "module_to_env_connector": {"timers": {"connectors": {"tensor_to_numpy": 1.4385418191586144e-05, "normalize_and_clip_actions": 1.0059792681599308e-05, "listify_data_for_vector_env": 1.1936787874946925e-05, "un_batch_to_individual_items": 5.7498787053636845e-06, "get_actions": 4.3224289850946506e-05, "remove_single_ts_time_rank_from_batch": 6.09121997267518e-07}}, "connector_pipeline_timer": 0.0001128647963973303}, "sample": 0.00541363099927881, "episode_return_max": 12.5, "num_env_steps_sampled_lifetime": -2460000.0, "agent_episode_returns_mean": {"default_agent": 6.3400000000000025}, "env_to_module_connector": {"timers": {"connectors": {"add_states_from_episodes_to_batch": 1.7840869497145966e-06, "add_observations_from_episodes_to_batch": 3.0941341147196142e-06, "numpy_to_tensor": 9.366144429277713e-06, "batch_individual_items": 6.6870379645168415e-06, "add_time_dim_to_batch_and_zero_pad": 2.4403028259017357e-06}}, "connector_pipeline_timer": 4.5944860889774316e-05}, "episode_len_max": 20, "episode_return_mean": 6.3400000000000025, "weights_seq_no": 5.0, "rlmodule_inference_timer": 3.0484931007391143e-05, "env_to_module_sum_episodes_length_in": 10.36823839457432, "env_step_timer": 1.5121063747013944e-05, "num_module_steps_sampled": {"default_policy": 5000.0}, "episode_len_min": 20, "episode_len_mean": 20.0, "num_episodes": 250.0, "episode_return_min": -7.5, "num_module_steps_sampled_lifetime": {"default_policy": -2460000.0}, "module_episode_returns_mean": {"default_policy": 6.3400000000000025}, "num_agent_steps_sampled": {"default_agent": 5000.0}, "num_episodes_lifetime": -123000.0, "env_to_module_sum_episodes_length_out": 10.36823839457432, "num_env_steps_sampled_lifetime_throughput": 3451.134136352133}, "learners": {"default_policy": {"num_module_steps_trained": 6000, "gradients_default_optimizer_global_norm": 0.029508594423532486, "vf_explained_var": 0.02075040340423584, "num_module_steps_trained_lifetime": 36000, "policy_loss": -0.2132357954978943, "num_trainable_parameters": 6003, "entropy": 0.6470538377761841, "weights_seq_no": 6.0, "curr_entropy_coeff": 0.0090570820258, "module_train_batch_size_mean": 1000.0, "total_loss": -0.15098221600055695, "default_optimizer_learning_rate": 0.0002847858517, "vf_loss": 0.10181018710136414, "curr_kl_coeff": 0.011664004996418953, "mean_kl_loss": 0.0009678311762399971, "vf_loss_unclipped": 28.623245239257812, "diff_num_grad_updates_vs_sampler_policy": 1.0, "num_module_steps_trained_lifetime_throughput": 335799.15876161715}, "__all_modules__": {"num_env_steps_trained_lifetime": 189000, "learner_connector_sum_episodes_length_in": 5000.0, "learner_connector_sum_episodes_length_out": 5250.0, "num_module_steps_trained": 6000, "num_env_steps_trained": 31500, "learner_connector": {"timers": {"connectors": {"add_states_from_episodes_to_batch": 4.1295036519775495e-06, "general_advantage_estimation": 0.008343633308896772, "add_observations_from_episodes_to_batch": 0.0008929268596074345, "add_time_dim_to_batch_and_zero_pad": 1.3355514594534119e-05, "add_one_ts_to_episodes_and_truncate": 0.00863757834530615, "numpy_to_tensor": 7.53815937904482e-05, "batch_individual_items": 0.034663653036222174, "add_columns_from_episodes_to_train_batch": 0.03803442315332862}}, "connector_pipeline_timer": 0.09083126438183443}, "num_module_steps_trained_lifetime": 36000, "num_trainable_parameters": 6003, "num_non_trainable_parameters": 0, "num_env_steps_trained_lifetime_throughput": 1715813.3975687574, "num_module_steps_trained_throughput": 328941.7994308874, "num_module_steps_trained_lifetime_throughput": 327743.16851870285}}, "num_training_step_calls_per_iteration": 1, "evaluation": {"env_runners": {"agent_episode_returns_mean": {"default_agent": 0.35}, "env_to_module_connector": {"timers": {"connectors": {"numpy_to_tensor": 8.503819143607748e-06, "batch_individual_items": 6.222449045093806e-06, "add_observations_from_episodes_to_batch": 2.8126226638636095e-06, "add_time_dim_to_batch_and_zero_pad": 2.2489117141559393e-06, "add_states_from_episodes_to_batch": 1.6182595774604647e-06}}, "connector_pipeline_timer": 4.296034573221273e-05}, "module_to_env_connector": {"timers": {"connectors": {"get_actions": 3.6596328799841087e-05, "tensor_to_numpy": 1.3146205042766455e-05, "normalize_and_clip_actions": 1.0015111155411301e-05, "remove_single_ts_time_rank_from_batch": 6.304223008625665e-07, "un_batch_to_individual_items": 5.62583978707716e-06, "listify_data_for_vector_env": 1.1362919013496e-05}}, "connector_pipeline_timer": 0.00010291358251815511}, "episode_len_max": 20, "env_step_timer": 1.4174587927164349e-05, "episode_len_min": 20, "episode_return_min": -16.5, "num_episodes_lifetime": 120, "num_module_steps_sampled_lifetime": {"default_policy": 2400}, "sample": 0.11675538406506474, "rlmodule_inference_timer": 2.7540674737333023e-05, "env_to_module_sum_episodes_length_in": 10.368238394470474, "module_episode_returns_mean": {"default_policy": 0.35}, "env_reset_timer": 0.00026370329196201143, "num_agent_steps_sampled_lifetime": {"default_agent": 2400}, "weights_seq_no": 6.0, "num_module_steps_sampled": {"default_policy": 400}, "episode_len_mean": 20.0, "num_env_steps_sampled": 400, "episode_duration_sec_mean": 0.005345402488019318, "episode_return_max": 12.5, "episode_return_mean": 0.35, "env_to_module_sum_episodes_length_out": 10.368238394470474, "num_episodes": 20, "num_agent_steps_sampled": {"default_agent": 400}, "num_env_steps_sampled_lifetime": 30400, "time_between_sampling": 1.8331696013182288}, "num_healthy_workers": 1, "actor_manager_num_outstanding_async_reqs": 0, "num_remote_worker_restarts": 0}, "num_env_steps_sampled_lifetime": -2460000.0, "fault_tolerance": {"num_healthy_workers": 0, "num_remote_worker_restarts": 0}, "env_runner_group": {"actor_manager_num_outstanding_async_reqs": 0}, "done": false, "training_iteration": 6, "trial_id": "4dd64_00000", "date": "2025-08-11_19-22-27", "timestamp": 1754932947, "time_this_iter_s": 1.8085072040557861, "time_total_s": 10.985495328903198, "pid": 14353, "hostname": "Mac", "node_ip": "127.0.0.1", "config": {"exploration_config": {}, "extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "placement_strategy": "PACK", "num_gpus": 0, "_fake_gpus": false, "num_cpus_for_main_process": 2, "eager_tracing": true, "eager_max_retraces": 20, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "torch_compile_learner": false, "torch_compile_learner_what_to_compile": "forward_train", "torch_compile_learner_dynamo_backend": "aot_eager", "torch_compile_learner_dynamo_mode": null, "torch_compile_worker": false, "torch_compile_worker_dynamo_backend": "aot_eager", "torch_compile_worker_dynamo_mode": null, "torch_ddp_kwargs": {}, "torch_skip_nan_gradients": false, "env": "Umbrella", "env_config": {}, "observation_space": null, "action_space": null, "clip_rewards": null, "normalize_actions": true, "clip_actions": false, "_is_atari": null, "disable_env_checking": false, "render_env": false, "action_mask_key": "action_mask", "env_runner_cls": null, "num_env_runners": 0, "create_local_env_runner": true, "num_envs_per_env_runner": 1, "gym_env_vectorize_mode": "SYNC", "num_cpus_per_env_runner": 1, "num_gpus_per_env_runner": 0, "custom_resources_per_env_runner": {}, "validate_env_runners_after_construction": true, "episodes_to_numpy": true, "max_requests_in_flight_per_env_runner": 1, "sample_timeout_s": 60.0, "_env_to_module_connector": null, "add_default_connectors_to_env_to_module_pipeline": true, "_module_to_env_connector": null, "add_default_connectors_to_module_to_env_pipeline": true, "merge_env_runner_states": "training_only", "broadcast_env_runner_states": true, "episode_lookback_horizon": 1, "rollout_fragment_length": "auto", "batch_mode": "complete_episodes", "compress_observations": false, "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "enable_tf1_exec_eagerly": false, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "preprocessor_pref": "deepmind", "observation_filter": "NoFilter", "update_worker_filter_stats": true, "use_worker_filter_stats": true, "sampler_perf_stats_ema_coef": null, "_is_online": true, "num_learners": 0, "num_gpus_per_learner": 0, "num_cpus_per_learner": "auto", "num_aggregator_actors_per_learner": 0, "max_requests_in_flight_per_aggregator_actor": 3, "local_gpu_idx": 0, "max_requests_in_flight_per_learner": 3, "gamma": 1, "lr": 0.0002847858517, "grad_clip": 0.5, "grad_clip_by": "global_norm", "_train_batch_size_per_learner": 5000, "train_batch_size": 4000, "num_epochs": 1, "minibatch_size": 1000, "shuffle_batch_per_epoch": true, "model": {"fcnet_hiddens": [256, 256], "fcnet_activation": "tanh", "fcnet_weights_initializer": null, "fcnet_weights_initializer_config": null, "fcnet_bias_initializer": null, "fcnet_bias_initializer_config": null, "conv_filters": null, "conv_activation": "relu", "conv_kernel_initializer": null, "conv_kernel_initializer_config": null, "conv_bias_initializer": null, "conv_bias_initializer_config": null, "conv_transpose_kernel_initializer": null, "conv_transpose_kernel_initializer_config": null, "conv_transpose_bias_initializer": null, "conv_transpose_bias_initializer_config": null, "post_fcnet_hiddens": [], "post_fcnet_activation": "relu", "post_fcnet_weights_initializer": null, "post_fcnet_weights_initializer_config": null, "post_fcnet_bias_initializer": null, "post_fcnet_bias_initializer_config": null, "free_log_std": false, "log_std_clip_param": 20.0, "no_final_linear": false, "vf_share_layers": false, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "lstm_weights_initializer": null, "lstm_weights_initializer_config": null, "lstm_bias_initializer": null, "lstm_bias_initializer_config": null, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "attention_use_n_prev_actions": 0, "attention_use_n_prev_rewards": 0, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": null, "custom_model_config": {}, "custom_action_dist": null, "custom_preprocessor": null, "encoder_latent_dim": null, "always_check_shapes": false, "lstm_use_prev_action_reward": -1, "_use_default_native_models": -1, "_disable_preprocessor_api": false, "_disable_action_flattening": false}, "_learner_connector": null, "add_default_connectors_to_learner_pipeline": true, "learner_config_dict": {}, "optimizer": {}, "_learner_class": null, "callbacks_on_algorithm_init": null, "callbacks_on_env_runners_recreated": null, "callbacks_on_offline_eval_runners_recreated": null, "callbacks_on_checkpoint_loaded": null, "callbacks_on_environment_created": null, "callbacks_on_episode_created": null, "callbacks_on_episode_start": null, "callbacks_on_episode_step": null, "callbacks_on_episode_end": null, "callbacks_on_evaluate_start": null, "callbacks_on_evaluate_end": null, "callbacks_on_evaluate_offline_start": null, "callbacks_on_evaluate_offline_end": null, "callbacks_on_sample_end": null, "callbacks_on_train_result": null, "explore": true, "enable_rl_module_and_learner": true, "enable_env_runner_and_connector_v2": true, "_prior_exploration_config": {"type": "StochasticSampling"}, "count_steps_by": "env_steps", "policy_map_capacity": 100, "policy_mapping_fn": "<function AlgorithmConfig.DEFAULT_POLICY_MAPPING_FN at 0x3834118a0>", "policies_to_train": null, "policy_states_are_swappable": false, "observation_fn": null, "offline_data_class": null, "input_read_method": "read_parquet", "input_read_method_kwargs": {}, "input_read_schema": {}, "input_read_episodes": false, "input_read_sample_batches": false, "input_read_batch_size": null, "input_filesystem": null, "input_filesystem_kwargs": {}, "input_compress_columns": ["obs", "new_obs"], "input_spaces_jsonable": true, "materialize_data": false, "materialize_mapped_data": true, "map_batches_kwargs": {}, "iter_batches_kwargs": {}, "ignore_final_observation": false, "prelearner_class": null, "prelearner_buffer_class": null, "prelearner_buffer_kwargs": {}, "prelearner_module_synch_period": 10, "dataset_num_iters_per_learner": null, "input_config": {}, "actions_in_input_normalized": false, "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_config": {}, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "output_max_rows_per_file": null, "output_write_remaining_data": false, "output_write_method": "write_parquet", "output_write_method_kwargs": {}, "output_filesystem": null, "output_filesystem_kwargs": {}, "output_write_episodes": true, "offline_sampling": false, "evaluation_interval": 1, "evaluation_duration": 20, "evaluation_duration_unit": "episodes", "evaluation_sample_timeout_s": 120.0, "evaluation_auto_duration_min_env_steps_per_sample": 100, "evaluation_auto_duration_max_env_steps_per_sample": 2000, "evaluation_parallel_to_training": false, "evaluation_force_reset_envs_before_iteration": true, "evaluation_config": null, "off_policy_estimation_methods": {}, "ope_split_batch_by_episode": true, "evaluation_num_env_runners": 1, "in_evaluation": false, "sync_filters_on_rollout_workers_timeout_s": 10.0, "offline_evaluation_interval": null, "num_offline_eval_runners": 0, "offline_loss_for_module_fn": null, "offline_evaluation_duration": 1, "offline_evaluation_parallel_to_training": false, "offline_evaluation_timeout_s": 120.0, "num_cpus_per_offline_eval_runner": 1, "num_gpus_per_offline_eval_runner": 0, "custom_resources_per_offline_eval_runner": {}, "restart_failed_offline_eval_runners": true, "ignore_offline_eval_runner_failures": false, "max_num_offline_eval_runner_restarts": 1000, "offline_eval_runner_restore_timeout_s": 1800.0, "max_requests_in_flight_per_offline_eval_runner": 1, "validate_offline_eval_runners_after_construction": true, "offline_eval_runner_health_probe_timeout_s": 30.0, "offline_eval_rl_module_inference_only": false, "broadcast_offline_eval_runner_states": false, "offline_eval_batch_size_per_runner": 256, "dataset_num_iters_per_eval_runner": 1, "keep_per_episode_custom_metrics": false, "metrics_episode_collection_timeout_s": 60.0, "metrics_num_episodes_for_smoothing": 100, "min_time_s_per_iteration": null, "min_train_timesteps_per_iteration": 0, "min_sample_timesteps_per_iteration": 0, "log_gradients": true, "export_native_model_files": false, "checkpoint_trainable_policies_only": false, "logger_creator": null, "logger_config": null, "log_level": "WARN", "log_sys_usage": true, "fake_sampler": false, "seed": 4, "restart_failed_env_runners": true, "ignore_env_runner_failures": false, "max_num_env_runner_restarts": 1000, "delay_between_env_runner_restarts_s": 60.0, "restart_failed_sub_environments": false, "num_consecutive_env_runner_failures_tolerance": 100, "env_runner_health_probe_timeout_s": 30.0, "env_runner_restore_timeout_s": 1800.0, "_model_config": {}, "_rl_module_spec": "RLModuleSpec(module_class=None, observation_space=None, action_space=None, inference_only=False, learner_only=False, model_config=DefaultModelConfig(fcnet_hiddens=[60, 90], fcnet_activation='tanh', fcnet_kernel_initializer=None, fcnet_kernel_initializer_kwargs=None, fcnet_bias_initializer=None, fcnet_bias_initializer_kwargs=None, conv_filters=None, conv_activation='relu', conv_kernel_initializer=None, conv_kernel_initializer_kwargs=None, conv_bias_initializer=None, conv_bias_initializer_kwargs=None, head_fcnet_hiddens=[], head_fcnet_activation='relu', head_fcnet_kernel_initializer=None, head_fcnet_kernel_initializer_kwargs=None, head_fcnet_bias_initializer=None, head_fcnet_bias_initializer_kwargs=None, free_log_std=False, log_std_clip_param=20.0, vf_share_layers=True, use_lstm=False, max_seq_len=20, lstm_cell_size=256, lstm_use_prev_action=False, lstm_use_prev_reward=False, lstm_kernel_initializer=None, lstm_kernel_initializer_kwargs=None, lstm_bias_initializer=None, lstm_bias_initializer_kwargs=None), catalog_class=None, load_state_path=None, model_config_dict=None)", "algorithm_config_overrides_per_module": {}, "_per_module_overrides": {}, "_validate_config": true, "_use_msgpack_checkpoints": false, "_torch_grad_scaler_class": null, "_torch_lr_scheduler_classes": null, "_tf_policy_handles_more_than_one_loss": false, "_disable_preprocessor_api": false, "_disable_action_flattening": false, "_disable_initialize_loss_from_dummy_batch": false, "_dont_auto_sync_env_runner_states": false, "env_task_fn": -1, "enable_connectors": -1, "simple_optimizer": false, "policy_map_cache": -1, "worker_cls": -1, "synchronize_filters": -1, "enable_async_evaluation": -1, "custom_async_evaluation_function": -1, "_enable_rl_module_api": -1, "auto_wrap_old_gym_envs": -1, "always_attach_evaluation_results": -1, "replay_sequence_length": null, "_disable_execution_plan_api": -1, "use_critic": true, "use_gae": true, "use_kl_loss": true, "kl_coeff": 0.7464963036515, "kl_target": 0.0270990929592, "vf_loss_coeff": 0.6688075857018, "entropy_coeff": 0.0090570820258, "clip_param": 0.1221781641624, "vf_clip_param": 0.1027808522125, "entropy_coeff_schedule": null, "lr_schedule": null, "sgd_minibatch_size": -1, "vf_share_layers": -1, "__stdout_file__": null, "__stderr_file__": null, "lambda": 0.9099046732075, "input": "sampler", "policies": {"default_policy": [null, null, null, null]}, "callbacks": "<class 'ray.rllib.callbacks.callbacks.RLlibCallback'>", "create_env_on_driver": false, "custom_eval_function": null, "framework": "torch"}, "time_since_restore": 10.985495328903198, "iterations_since_restore": 6, "perf": {"cpu_util_percent": 45.5, "ram_util_percent": 79.30000000000001}}
{"timers": {"training_iteration": 1.9063563728919284, "restore_env_runners": 9.468596748637014e-06, "training_step": 1.9061970902519325, "env_runner_sampling_timer": 1.7825100929992448, "learner_update_timer": 0.11974545423299282, "synch_weights": 0.0010358725531969982, "restore_eval_env_runners": 8.986945114543358e-06, "evaluation_iteration": 0.1251361103592921, "synch_eval_env_connectors": 0.00012768308202612433, "synch_env_connectors": 4.342768120741088e-06}, "env_runners": {"env_reset_timer": 4.305253830257134e-05, "num_env_steps_sampled": 5000.0, "num_agent_steps_sampled_lifetime": {"default_agent": -3077500.0}, "episode_duration_sec_mean": 0.0048879533447325225, "time_between_sampling": 0.0019287479477046335, "module_to_env_connector": {"timers": {"connectors": {"tensor_to_numpy": 1.4288104296094423e-05, "normalize_and_clip_actions": 1.0000746850426381e-05, "listify_data_for_vector_env": 1.1935055056441526e-05, "un_batch_to_individual_items": 5.7165313941867475e-06, "get_actions": 4.259147302232549e-05, "remove_single_ts_time_rank_from_batch": 6.155933960888468e-07}}, "connector_pipeline_timer": 0.00011212831423774494}, "sample": 0.005216044461616712, "episode_return_max": 12.5, "num_env_steps_sampled_lifetime": -3077500.0, "agent_episode_returns_mean": {"default_agent": 6.820000000000002}, "env_to_module_connector": {"timers": {"connectors": {"add_states_from_episodes_to_batch": 1.756982968236265e-06, "add_observations_from_episodes_to_batch": 3.114667636212292e-06, "numpy_to_tensor": 9.337922185740074e-06, "batch_individual_items": 6.763721241469232e-06, "add_time_dim_to_batch_and_zero_pad": 2.445188880242454e-06}}, "connector_pipeline_timer": 4.593367420860813e-05}, "episode_len_max": 20, "episode_return_mean": 6.820000000000002, "weights_seq_no": 6.0, "rlmodule_inference_timer": 2.9968553995069344e-05, "env_to_module_sum_episodes_length_in": 10.36823839457432, "env_step_timer": 1.4984039969418047e-05, "num_module_steps_sampled": {"default_policy": 5000.0}, "episode_len_min": 20, "episode_len_mean": 20.0, "num_episodes": 250.0, "episode_return_min": -7.5, "num_module_steps_sampled_lifetime": {"default_policy": -3077500.0}, "module_episode_returns_mean": {"default_policy": 6.820000000000002}, "num_agent_steps_sampled": {"default_agent": 5000.0}, "num_episodes_lifetime": -153875.0, "env_to_module_sum_episodes_length_out": 10.36823839457432, "num_env_steps_sampled_lifetime_throughput": 3476.779116995429}, "learners": {"default_policy": {"num_module_steps_trained": 6000, "gradients_default_optimizer_global_norm": 0.06353103369474411, "vf_explained_var": 0.021754086017608643, "num_module_steps_trained_lifetime": 42000, "policy_loss": -0.04889311641454697, "num_trainable_parameters": 6003, "entropy": 0.6315293908119202, "weights_seq_no": 7.0, "curr_entropy_coeff": 0.0090570820258, "module_train_batch_size_mean": 1000.0, "total_loss": 0.01327641773968935, "default_optimizer_learning_rate": 0.0002847858517, "vf_loss": 0.10148672014474869, "curr_kl_coeff": 0.0058320024982094765, "mean_kl_loss": 0.0012224273523315787, "vf_loss_unclipped": 28.57539176940918, "diff_num_grad_updates_vs_sampler_policy": 1.0, "num_module_steps_trained_lifetime_throughput": 337487.23963596585}, "__all_modules__": {"num_env_steps_trained_lifetime": 220500, "learner_connector_sum_episodes_length_in": 5000.0, "learner_connector_sum_episodes_length_out": 5250.0, "num_module_steps_trained": 6000, "num_env_steps_trained": 31500, "learner_connector": {"timers": {"connectors": {"add_states_from_episodes_to_batch": 4.127788660725714e-06, "general_advantage_estimation": 0.008328394476466957, "add_observations_from_episodes_to_batch": 0.0008933988407106547, "add_time_dim_to_batch_and_zero_pad": 1.3608209188265493e-05, "add_one_ts_to_episodes_and_truncate": 0.00863820048156903, "numpy_to_tensor": 7.542444748101485e-05, "batch_individual_items": 0.03468142692557552, "add_columns_from_episodes_to_train_batch": 0.038037276011918184}}, "connector_pipeline_timer": 0.09083770132729911}, "num_module_steps_trained_lifetime": 42000, "num_trainable_parameters": 6003, "num_non_trainable_parameters": 0, "num_env_steps_trained_lifetime_throughput": 1726690.5139345303, "num_module_steps_trained_throughput": 330936.476561565, "num_module_steps_trained_lifetime_throughput": 329780.2167300317}}, "num_training_step_calls_per_iteration": 1, "evaluation": {"env_runners": {"agent_episode_returns_mean": {"default_agent": -0.05}, "env_to_module_connector": {"timers": {"connectors": {"numpy_to_tensor": 1.1716595556411844e-05, "batch_individual_items": 8.200726470209394e-06, "add_observations_from_episodes_to_batch": 3.244213404323647e-06, "add_time_dim_to_batch_and_zero_pad": 2.793870947555677e-06, "add_states_from_episodes_to_batch": 2.1425909848097478e-06}}, "connector_pipeline_timer": 5.399970538345975e-05}, "module_to_env_connector": {"timers": {"connectors": {"get_actions": 5.277259824281071e-05, "tensor_to_numpy": 1.6865106523722486e-05, "normalize_and_clip_actions": 1.2060072109858572e-05, "remove_single_ts_time_rank_from_batch": 8.443918942108452e-07, "un_batch_to_individual_items": 6.879320189582904e-06, "listify_data_for_vector_env": 1.551663921356766e-05}}, "connector_pipeline_timer": 0.00013744962245942885}, "episode_len_max": 20, "env_step_timer": 2.0662013498501927e-05, "episode_len_min": 20, "episode_return_min": -16.5, "num_episodes_lifetime": 140, "num_module_steps_sampled_lifetime": {"default_policy": 2800}, "sample": 0.1169901148042313, "rlmodule_inference_timer": 3.914700157976445e-05, "env_to_module_sum_episodes_length_in": 10.368238394572801, "module_episode_returns_mean": {"default_policy": -0.05}, "env_reset_timer": 0.0002629875099929364, "num_agent_steps_sampled_lifetime": {"default_agent": 2800}, "weights_seq_no": 7.0, "num_module_steps_sampled": {"default_policy": 400}, "episode_len_mean": 20.0, "num_env_steps_sampled": 400, "episode_duration_sec_mean": 0.005669834167929366, "episode_return_max": 12.5, "episode_return_mean": -0.05, "env_to_module_sum_episodes_length_out": 10.368238394572801, "num_episodes": 20, "num_agent_steps_sampled": {"default_agent": 400}, "num_env_steps_sampled_lifetime": 35400, "time_between_sampling": 1.8311319773949961}, "num_healthy_workers": 1, "actor_manager_num_outstanding_async_reqs": 0, "num_remote_worker_restarts": 0}, "num_env_steps_sampled_lifetime": -3077500.0, "fault_tolerance": {"num_healthy_workers": 0, "num_remote_worker_restarts": 0}, "env_runner_group": {"actor_manager_num_outstanding_async_reqs": 0}, "done": false, "training_iteration": 7, "trial_id": "4dd64_00000", "date": "2025-08-11_19-22-29", "timestamp": 1754932949, "time_this_iter_s": 1.761775016784668, "time_total_s": 12.747270345687866, "pid": 14353, "hostname": "Mac", "node_ip": "127.0.0.1", "config": {"exploration_config": {}, "extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "placement_strategy": "PACK", "num_gpus": 0, "_fake_gpus": false, "num_cpus_for_main_process": 2, "eager_tracing": true, "eager_max_retraces": 20, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "torch_compile_learner": false, "torch_compile_learner_what_to_compile": "forward_train", "torch_compile_learner_dynamo_backend": "aot_eager", "torch_compile_learner_dynamo_mode": null, "torch_compile_worker": false, "torch_compile_worker_dynamo_backend": "aot_eager", "torch_compile_worker_dynamo_mode": null, "torch_ddp_kwargs": {}, "torch_skip_nan_gradients": false, "env": "Umbrella", "env_config": {}, "observation_space": null, "action_space": null, "clip_rewards": null, "normalize_actions": true, "clip_actions": false, "_is_atari": null, "disable_env_checking": false, "render_env": false, "action_mask_key": "action_mask", "env_runner_cls": null, "num_env_runners": 0, "create_local_env_runner": true, "num_envs_per_env_runner": 1, "gym_env_vectorize_mode": "SYNC", "num_cpus_per_env_runner": 1, "num_gpus_per_env_runner": 0, "custom_resources_per_env_runner": {}, "validate_env_runners_after_construction": true, "episodes_to_numpy": true, "max_requests_in_flight_per_env_runner": 1, "sample_timeout_s": 60.0, "_env_to_module_connector": null, "add_default_connectors_to_env_to_module_pipeline": true, "_module_to_env_connector": null, "add_default_connectors_to_module_to_env_pipeline": true, "merge_env_runner_states": "training_only", "broadcast_env_runner_states": true, "episode_lookback_horizon": 1, "rollout_fragment_length": "auto", "batch_mode": "complete_episodes", "compress_observations": false, "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "enable_tf1_exec_eagerly": false, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "preprocessor_pref": "deepmind", "observation_filter": "NoFilter", "update_worker_filter_stats": true, "use_worker_filter_stats": true, "sampler_perf_stats_ema_coef": null, "_is_online": true, "num_learners": 0, "num_gpus_per_learner": 0, "num_cpus_per_learner": "auto", "num_aggregator_actors_per_learner": 0, "max_requests_in_flight_per_aggregator_actor": 3, "local_gpu_idx": 0, "max_requests_in_flight_per_learner": 3, "gamma": 1, "lr": 0.0002847858517, "grad_clip": 0.5, "grad_clip_by": "global_norm", "_train_batch_size_per_learner": 5000, "train_batch_size": 4000, "num_epochs": 1, "minibatch_size": 1000, "shuffle_batch_per_epoch": true, "model": {"fcnet_hiddens": [256, 256], "fcnet_activation": "tanh", "fcnet_weights_initializer": null, "fcnet_weights_initializer_config": null, "fcnet_bias_initializer": null, "fcnet_bias_initializer_config": null, "conv_filters": null, "conv_activation": "relu", "conv_kernel_initializer": null, "conv_kernel_initializer_config": null, "conv_bias_initializer": null, "conv_bias_initializer_config": null, "conv_transpose_kernel_initializer": null, "conv_transpose_kernel_initializer_config": null, "conv_transpose_bias_initializer": null, "conv_transpose_bias_initializer_config": null, "post_fcnet_hiddens": [], "post_fcnet_activation": "relu", "post_fcnet_weights_initializer": null, "post_fcnet_weights_initializer_config": null, "post_fcnet_bias_initializer": null, "post_fcnet_bias_initializer_config": null, "free_log_std": false, "log_std_clip_param": 20.0, "no_final_linear": false, "vf_share_layers": false, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "lstm_weights_initializer": null, "lstm_weights_initializer_config": null, "lstm_bias_initializer": null, "lstm_bias_initializer_config": null, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "attention_use_n_prev_actions": 0, "attention_use_n_prev_rewards": 0, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": null, "custom_model_config": {}, "custom_action_dist": null, "custom_preprocessor": null, "encoder_latent_dim": null, "always_check_shapes": false, "lstm_use_prev_action_reward": -1, "_use_default_native_models": -1, "_disable_preprocessor_api": false, "_disable_action_flattening": false}, "_learner_connector": null, "add_default_connectors_to_learner_pipeline": true, "learner_config_dict": {}, "optimizer": {}, "_learner_class": null, "callbacks_on_algorithm_init": null, "callbacks_on_env_runners_recreated": null, "callbacks_on_offline_eval_runners_recreated": null, "callbacks_on_checkpoint_loaded": null, "callbacks_on_environment_created": null, "callbacks_on_episode_created": null, "callbacks_on_episode_start": null, "callbacks_on_episode_step": null, "callbacks_on_episode_end": null, "callbacks_on_evaluate_start": null, "callbacks_on_evaluate_end": null, "callbacks_on_evaluate_offline_start": null, "callbacks_on_evaluate_offline_end": null, "callbacks_on_sample_end": null, "callbacks_on_train_result": null, "explore": true, "enable_rl_module_and_learner": true, "enable_env_runner_and_connector_v2": true, "_prior_exploration_config": {"type": "StochasticSampling"}, "count_steps_by": "env_steps", "policy_map_capacity": 100, "policy_mapping_fn": "<function AlgorithmConfig.DEFAULT_POLICY_MAPPING_FN at 0x3834118a0>", "policies_to_train": null, "policy_states_are_swappable": false, "observation_fn": null, "offline_data_class": null, "input_read_method": "read_parquet", "input_read_method_kwargs": {}, "input_read_schema": {}, "input_read_episodes": false, "input_read_sample_batches": false, "input_read_batch_size": null, "input_filesystem": null, "input_filesystem_kwargs": {}, "input_compress_columns": ["obs", "new_obs"], "input_spaces_jsonable": true, "materialize_data": false, "materialize_mapped_data": true, "map_batches_kwargs": {}, "iter_batches_kwargs": {}, "ignore_final_observation": false, "prelearner_class": null, "prelearner_buffer_class": null, "prelearner_buffer_kwargs": {}, "prelearner_module_synch_period": 10, "dataset_num_iters_per_learner": null, "input_config": {}, "actions_in_input_normalized": false, "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_config": {}, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "output_max_rows_per_file": null, "output_write_remaining_data": false, "output_write_method": "write_parquet", "output_write_method_kwargs": {}, "output_filesystem": null, "output_filesystem_kwargs": {}, "output_write_episodes": true, "offline_sampling": false, "evaluation_interval": 1, "evaluation_duration": 20, "evaluation_duration_unit": "episodes", "evaluation_sample_timeout_s": 120.0, "evaluation_auto_duration_min_env_steps_per_sample": 100, "evaluation_auto_duration_max_env_steps_per_sample": 2000, "evaluation_parallel_to_training": false, "evaluation_force_reset_envs_before_iteration": true, "evaluation_config": null, "off_policy_estimation_methods": {}, "ope_split_batch_by_episode": true, "evaluation_num_env_runners": 1, "in_evaluation": false, "sync_filters_on_rollout_workers_timeout_s": 10.0, "offline_evaluation_interval": null, "num_offline_eval_runners": 0, "offline_loss_for_module_fn": null, "offline_evaluation_duration": 1, "offline_evaluation_parallel_to_training": false, "offline_evaluation_timeout_s": 120.0, "num_cpus_per_offline_eval_runner": 1, "num_gpus_per_offline_eval_runner": 0, "custom_resources_per_offline_eval_runner": {}, "restart_failed_offline_eval_runners": true, "ignore_offline_eval_runner_failures": false, "max_num_offline_eval_runner_restarts": 1000, "offline_eval_runner_restore_timeout_s": 1800.0, "max_requests_in_flight_per_offline_eval_runner": 1, "validate_offline_eval_runners_after_construction": true, "offline_eval_runner_health_probe_timeout_s": 30.0, "offline_eval_rl_module_inference_only": false, "broadcast_offline_eval_runner_states": false, "offline_eval_batch_size_per_runner": 256, "dataset_num_iters_per_eval_runner": 1, "keep_per_episode_custom_metrics": false, "metrics_episode_collection_timeout_s": 60.0, "metrics_num_episodes_for_smoothing": 100, "min_time_s_per_iteration": null, "min_train_timesteps_per_iteration": 0, "min_sample_timesteps_per_iteration": 0, "log_gradients": true, "export_native_model_files": false, "checkpoint_trainable_policies_only": false, "logger_creator": null, "logger_config": null, "log_level": "WARN", "log_sys_usage": true, "fake_sampler": false, "seed": 4, "restart_failed_env_runners": true, "ignore_env_runner_failures": false, "max_num_env_runner_restarts": 1000, "delay_between_env_runner_restarts_s": 60.0, "restart_failed_sub_environments": false, "num_consecutive_env_runner_failures_tolerance": 100, "env_runner_health_probe_timeout_s": 30.0, "env_runner_restore_timeout_s": 1800.0, "_model_config": {}, "_rl_module_spec": "RLModuleSpec(module_class=None, observation_space=None, action_space=None, inference_only=False, learner_only=False, model_config=DefaultModelConfig(fcnet_hiddens=[60, 90], fcnet_activation='tanh', fcnet_kernel_initializer=None, fcnet_kernel_initializer_kwargs=None, fcnet_bias_initializer=None, fcnet_bias_initializer_kwargs=None, conv_filters=None, conv_activation='relu', conv_kernel_initializer=None, conv_kernel_initializer_kwargs=None, conv_bias_initializer=None, conv_bias_initializer_kwargs=None, head_fcnet_hiddens=[], head_fcnet_activation='relu', head_fcnet_kernel_initializer=None, head_fcnet_kernel_initializer_kwargs=None, head_fcnet_bias_initializer=None, head_fcnet_bias_initializer_kwargs=None, free_log_std=False, log_std_clip_param=20.0, vf_share_layers=True, use_lstm=False, max_seq_len=20, lstm_cell_size=256, lstm_use_prev_action=False, lstm_use_prev_reward=False, lstm_kernel_initializer=None, lstm_kernel_initializer_kwargs=None, lstm_bias_initializer=None, lstm_bias_initializer_kwargs=None), catalog_class=None, load_state_path=None, model_config_dict=None)", "algorithm_config_overrides_per_module": {}, "_per_module_overrides": {}, "_validate_config": true, "_use_msgpack_checkpoints": false, "_torch_grad_scaler_class": null, "_torch_lr_scheduler_classes": null, "_tf_policy_handles_more_than_one_loss": false, "_disable_preprocessor_api": false, "_disable_action_flattening": false, "_disable_initialize_loss_from_dummy_batch": false, "_dont_auto_sync_env_runner_states": false, "env_task_fn": -1, "enable_connectors": -1, "simple_optimizer": false, "policy_map_cache": -1, "worker_cls": -1, "synchronize_filters": -1, "enable_async_evaluation": -1, "custom_async_evaluation_function": -1, "_enable_rl_module_api": -1, "auto_wrap_old_gym_envs": -1, "always_attach_evaluation_results": -1, "replay_sequence_length": null, "_disable_execution_plan_api": -1, "use_critic": true, "use_gae": true, "use_kl_loss": true, "kl_coeff": 0.7464963036515, "kl_target": 0.0270990929592, "vf_loss_coeff": 0.6688075857018, "entropy_coeff": 0.0090570820258, "clip_param": 0.1221781641624, "vf_clip_param": 0.1027808522125, "entropy_coeff_schedule": null, "lr_schedule": null, "sgd_minibatch_size": -1, "vf_share_layers": -1, "__stdout_file__": null, "__stderr_file__": null, "lambda": 0.9099046732075, "input": "sampler", "policies": {"default_policy": [null, null, null, null]}, "callbacks": "<class 'ray.rllib.callbacks.callbacks.RLlibCallback'>", "create_env_on_driver": false, "custom_eval_function": null, "framework": "torch"}, "time_since_restore": 12.747270345687866, "iterations_since_restore": 7, "perf": {"cpu_util_percent": 47.93333333333334, "ram_util_percent": 79.36666666666666}}
{"timers": {"training_iteration": 1.9054227558328054, "restore_env_runners": 9.457240868514364e-06, "training_step": 1.9052623010202745, "env_runner_sampling_timer": 1.7818313820693776, "learner_update_timer": 0.11949011553139781, "synch_weights": 0.0010349496573715182, "restore_eval_env_runners": 8.992075222621575e-06, "evaluation_iteration": 0.1253608834153014, "synch_eval_env_connectors": 0.00012940042185111494, "synch_env_connectors": 4.3459997005219135e-06}, "env_runners": {"env_reset_timer": 5.1373040075458486e-05, "num_env_steps_sampled": 5000.0, "num_agent_steps_sampled_lifetime": {"default_agent": -3695000.0}, "episode_duration_sec_mean": 0.005701602990273383, "time_between_sampling": 0.0019154612056548998, "module_to_env_connector": {"timers": {"connectors": {"tensor_to_numpy": 1.557287382111882e-05, "normalize_and_clip_actions": 1.071913173768119e-05, "listify_data_for_vector_env": 1.268034117419168e-05, "un_batch_to_individual_items": 6.135962944456922e-06, "get_actions": 4.7643258107670536e-05, "remove_single_ts_time_rank_from_batch": 6.508018091524481e-07}}, "connector_pipeline_timer": 0.00012191792826372057}, "sample": 0.005905193514958218, "episode_return_max": 12.5, "num_env_steps_sampled_lifetime": -3695000.0, "agent_episode_returns_mean": {"default_agent": 7.46}, "env_to_module_connector": {"timers": {"connectors": {"add_states_from_episodes_to_batch": 1.8594294656030163e-06, "add_observations_from_episodes_to_batch": 3.418492171937626e-06, "numpy_to_tensor": 1.0276770015704285e-05, "batch_individual_items": 7.293724311494465e-06, "add_time_dim_to_batch_and_zero_pad": 2.6312169452520324e-06}}, "connector_pipeline_timer": 4.937477925545176e-05}, "episode_len_max": 20, "episode_return_mean": 7.46, "weights_seq_no": 7.0, "rlmodule_inference_timer": 5.039374785692105e-05, "env_to_module_sum_episodes_length_in": 10.36823839457432, "env_step_timer": 1.649527031597521e-05, "num_module_steps_sampled": {"default_policy": 5000.0}, "episode_len_min": 20, "episode_len_mean": 20.0, "num_episodes": 250.0, "episode_return_min": -7.5, "num_module_steps_sampled_lifetime": {"default_policy": -3695000.0}, "module_episode_returns_mean": {"default_policy": 7.46}, "num_agent_steps_sampled": {"default_agent": 5000.0}, "num_episodes_lifetime": -184750.0, "env_to_module_sum_episodes_length_out": 10.36823839457432, "num_env_steps_sampled_lifetime_throughput": 3226.0854642303393}, "learners": {"default_policy": {"num_module_steps_trained": 6000, "gradients_default_optimizer_global_norm": 0.14886373281478882, "vf_explained_var": 0.020945727825164795, "num_module_steps_trained_lifetime": 48000, "policy_loss": -0.1171649619936943, "num_trainable_parameters": 6003, "entropy": 0.6054023504257202, "weights_seq_no": 8.0, "curr_entropy_coeff": 0.0090570820258, "module_train_batch_size_mean": 1000.0, "total_loss": -0.05461999401450157, "default_optimizer_learning_rate": 0.0002847858517, "vf_loss": 0.10170264542102814, "curr_kl_coeff": 0.0029160012491047382, "mean_kl_loss": 0.0014844421530142426, "vf_loss_unclipped": 28.60869026184082, "diff_num_grad_updates_vs_sampler_policy": 1.0, "num_module_steps_trained_lifetime_throughput": 339544.88853938814}, "__all_modules__": {"num_env_steps_trained_lifetime": 252000, "learner_connector_sum_episodes_length_in": 5000.0, "learner_connector_sum_episodes_length_out": 5250.0, "num_module_steps_trained": 6000, "num_env_steps_trained": 31500, "learner_connector": {"timers": {"connectors": {"add_states_from_episodes_to_batch": 4.118590180201087e-06, "general_advantage_estimation": 0.00830002428162063, "add_observations_from_episodes_to_batch": 0.0008953027625347511, "add_time_dim_to_batch_and_zero_pad": 1.3629627713588934e-05, "add_one_ts_to_episodes_and_truncate": 0.008629909726787389, "numpy_to_tensor": 7.532936285653387e-05, "batch_individual_items": 0.03463826223735723, "add_columns_from_episodes_to_train_batch": 0.038007261171031925}}, "connector_pipeline_timer": 0.09072908472388978}, "num_module_steps_trained_lifetime": 48000, "num_trainable_parameters": 6003, "num_non_trainable_parameters": 0, "num_env_steps_trained_lifetime_throughput": 1739528.9640120512, "num_module_steps_trained_throughput": 333306.1858418215, "num_module_steps_trained_lifetime_throughput": 332191.5998509618}}, "num_training_step_calls_per_iteration": 1, "evaluation": {"env_runners": {"agent_episode_returns_mean": {"default_agent": 0.35}, "env_to_module_connector": {"timers": {"connectors": {"numpy_to_tensor": 8.63586231976823e-06, "batch_individual_items": 6.3473077451812174e-06, "add_observations_from_episodes_to_batch": 2.862034039399504e-06, "add_time_dim_to_batch_and_zero_pad": 2.2619322326309798e-06, "add_states_from_episodes_to_batch": 1.5762060770803554e-06}}, "connector_pipeline_timer": 4.3644637569144206e-05}, "module_to_env_connector": {"timers": {"connectors": {"get_actions": 3.7289335726904666e-05, "tensor_to_numpy": 1.3052152486814345e-05, "normalize_and_clip_actions": 9.612571401578934e-06, "remove_single_ts_time_rank_from_batch": 6.37518246058425e-07, "un_batch_to_individual_items": 5.593602231387857e-06, "listify_data_for_vector_env": 1.1184032215447483e-05}}, "connector_pipeline_timer": 0.00010340228055965275}, "episode_len_max": 20, "env_step_timer": 1.4880736840656957e-05, "episode_len_min": 20, "episode_return_min": -16.5, "num_episodes_lifetime": 160, "num_module_steps_sampled_lifetime": {"default_policy": 3200}, "sample": 0.11685716532614647, "rlmodule_inference_timer": 2.8634258314500087e-05, "env_to_module_sum_episodes_length_in": 10.3682383945743, "module_episode_returns_mean": {"default_policy": 0.35}, "env_reset_timer": 0.0002615759654737482, "num_agent_steps_sampled_lifetime": {"default_agent": 3200}, "weights_seq_no": 8.0, "num_module_steps_sampled": {"default_policy": 400}, "episode_len_mean": 20.0, "num_env_steps_sampled": 400, "episode_duration_sec_mean": 0.005593794989399612, "episode_return_max": 12.5, "episode_return_mean": 0.35, "env_to_module_sum_episodes_length_out": 10.3682383945743, "num_episodes": 20, "num_agent_steps_sampled": {"default_agent": 400}, "num_env_steps_sampled_lifetime": 40400, "time_between_sampling": 1.8312267709606342}, "num_healthy_workers": 1, "actor_manager_num_outstanding_async_reqs": 0, "num_remote_worker_restarts": 0}, "num_env_steps_sampled_lifetime": -3695000.0, "fault_tolerance": {"num_healthy_workers": 0, "num_remote_worker_restarts": 0}, "env_runner_group": {"actor_manager_num_outstanding_async_reqs": 0}, "done": false, "training_iteration": 8, "trial_id": "4dd64_00000", "date": "2025-08-11_19-22-31", "timestamp": 1754932951, "time_this_iter_s": 1.9242448806762695, "time_total_s": 14.671515226364136, "pid": 14353, "hostname": "Mac", "node_ip": "127.0.0.1", "config": {"exploration_config": {}, "extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "placement_strategy": "PACK", "num_gpus": 0, "_fake_gpus": false, "num_cpus_for_main_process": 2, "eager_tracing": true, "eager_max_retraces": 20, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "torch_compile_learner": false, "torch_compile_learner_what_to_compile": "forward_train", "torch_compile_learner_dynamo_backend": "aot_eager", "torch_compile_learner_dynamo_mode": null, "torch_compile_worker": false, "torch_compile_worker_dynamo_backend": "aot_eager", "torch_compile_worker_dynamo_mode": null, "torch_ddp_kwargs": {}, "torch_skip_nan_gradients": false, "env": "Umbrella", "env_config": {}, "observation_space": null, "action_space": null, "clip_rewards": null, "normalize_actions": true, "clip_actions": false, "_is_atari": null, "disable_env_checking": false, "render_env": false, "action_mask_key": "action_mask", "env_runner_cls": null, "num_env_runners": 0, "create_local_env_runner": true, "num_envs_per_env_runner": 1, "gym_env_vectorize_mode": "SYNC", "num_cpus_per_env_runner": 1, "num_gpus_per_env_runner": 0, "custom_resources_per_env_runner": {}, "validate_env_runners_after_construction": true, "episodes_to_numpy": true, "max_requests_in_flight_per_env_runner": 1, "sample_timeout_s": 60.0, "_env_to_module_connector": null, "add_default_connectors_to_env_to_module_pipeline": true, "_module_to_env_connector": null, "add_default_connectors_to_module_to_env_pipeline": true, "merge_env_runner_states": "training_only", "broadcast_env_runner_states": true, "episode_lookback_horizon": 1, "rollout_fragment_length": "auto", "batch_mode": "complete_episodes", "compress_observations": false, "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "enable_tf1_exec_eagerly": false, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "preprocessor_pref": "deepmind", "observation_filter": "NoFilter", "update_worker_filter_stats": true, "use_worker_filter_stats": true, "sampler_perf_stats_ema_coef": null, "_is_online": true, "num_learners": 0, "num_gpus_per_learner": 0, "num_cpus_per_learner": "auto", "num_aggregator_actors_per_learner": 0, "max_requests_in_flight_per_aggregator_actor": 3, "local_gpu_idx": 0, "max_requests_in_flight_per_learner": 3, "gamma": 1, "lr": 0.0002847858517, "grad_clip": 0.5, "grad_clip_by": "global_norm", "_train_batch_size_per_learner": 5000, "train_batch_size": 4000, "num_epochs": 1, "minibatch_size": 1000, "shuffle_batch_per_epoch": true, "model": {"fcnet_hiddens": [256, 256], "fcnet_activation": "tanh", "fcnet_weights_initializer": null, "fcnet_weights_initializer_config": null, "fcnet_bias_initializer": null, "fcnet_bias_initializer_config": null, "conv_filters": null, "conv_activation": "relu", "conv_kernel_initializer": null, "conv_kernel_initializer_config": null, "conv_bias_initializer": null, "conv_bias_initializer_config": null, "conv_transpose_kernel_initializer": null, "conv_transpose_kernel_initializer_config": null, "conv_transpose_bias_initializer": null, "conv_transpose_bias_initializer_config": null, "post_fcnet_hiddens": [], "post_fcnet_activation": "relu", "post_fcnet_weights_initializer": null, "post_fcnet_weights_initializer_config": null, "post_fcnet_bias_initializer": null, "post_fcnet_bias_initializer_config": null, "free_log_std": false, "log_std_clip_param": 20.0, "no_final_linear": false, "vf_share_layers": false, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "lstm_weights_initializer": null, "lstm_weights_initializer_config": null, "lstm_bias_initializer": null, "lstm_bias_initializer_config": null, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "attention_use_n_prev_actions": 0, "attention_use_n_prev_rewards": 0, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": null, "custom_model_config": {}, "custom_action_dist": null, "custom_preprocessor": null, "encoder_latent_dim": null, "always_check_shapes": false, "lstm_use_prev_action_reward": -1, "_use_default_native_models": -1, "_disable_preprocessor_api": false, "_disable_action_flattening": false}, "_learner_connector": null, "add_default_connectors_to_learner_pipeline": true, "learner_config_dict": {}, "optimizer": {}, "_learner_class": null, "callbacks_on_algorithm_init": null, "callbacks_on_env_runners_recreated": null, "callbacks_on_offline_eval_runners_recreated": null, "callbacks_on_checkpoint_loaded": null, "callbacks_on_environment_created": null, "callbacks_on_episode_created": null, "callbacks_on_episode_start": null, "callbacks_on_episode_step": null, "callbacks_on_episode_end": null, "callbacks_on_evaluate_start": null, "callbacks_on_evaluate_end": null, "callbacks_on_evaluate_offline_start": null, "callbacks_on_evaluate_offline_end": null, "callbacks_on_sample_end": null, "callbacks_on_train_result": null, "explore": true, "enable_rl_module_and_learner": true, "enable_env_runner_and_connector_v2": true, "_prior_exploration_config": {"type": "StochasticSampling"}, "count_steps_by": "env_steps", "policy_map_capacity": 100, "policy_mapping_fn": "<function AlgorithmConfig.DEFAULT_POLICY_MAPPING_FN at 0x3834118a0>", "policies_to_train": null, "policy_states_are_swappable": false, "observation_fn": null, "offline_data_class": null, "input_read_method": "read_parquet", "input_read_method_kwargs": {}, "input_read_schema": {}, "input_read_episodes": false, "input_read_sample_batches": false, "input_read_batch_size": null, "input_filesystem": null, "input_filesystem_kwargs": {}, "input_compress_columns": ["obs", "new_obs"], "input_spaces_jsonable": true, "materialize_data": false, "materialize_mapped_data": true, "map_batches_kwargs": {}, "iter_batches_kwargs": {}, "ignore_final_observation": false, "prelearner_class": null, "prelearner_buffer_class": null, "prelearner_buffer_kwargs": {}, "prelearner_module_synch_period": 10, "dataset_num_iters_per_learner": null, "input_config": {}, "actions_in_input_normalized": false, "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_config": {}, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "output_max_rows_per_file": null, "output_write_remaining_data": false, "output_write_method": "write_parquet", "output_write_method_kwargs": {}, "output_filesystem": null, "output_filesystem_kwargs": {}, "output_write_episodes": true, "offline_sampling": false, "evaluation_interval": 1, "evaluation_duration": 20, "evaluation_duration_unit": "episodes", "evaluation_sample_timeout_s": 120.0, "evaluation_auto_duration_min_env_steps_per_sample": 100, "evaluation_auto_duration_max_env_steps_per_sample": 2000, "evaluation_parallel_to_training": false, "evaluation_force_reset_envs_before_iteration": true, "evaluation_config": null, "off_policy_estimation_methods": {}, "ope_split_batch_by_episode": true, "evaluation_num_env_runners": 1, "in_evaluation": false, "sync_filters_on_rollout_workers_timeout_s": 10.0, "offline_evaluation_interval": null, "num_offline_eval_runners": 0, "offline_loss_for_module_fn": null, "offline_evaluation_duration": 1, "offline_evaluation_parallel_to_training": false, "offline_evaluation_timeout_s": 120.0, "num_cpus_per_offline_eval_runner": 1, "num_gpus_per_offline_eval_runner": 0, "custom_resources_per_offline_eval_runner": {}, "restart_failed_offline_eval_runners": true, "ignore_offline_eval_runner_failures": false, "max_num_offline_eval_runner_restarts": 1000, "offline_eval_runner_restore_timeout_s": 1800.0, "max_requests_in_flight_per_offline_eval_runner": 1, "validate_offline_eval_runners_after_construction": true, "offline_eval_runner_health_probe_timeout_s": 30.0, "offline_eval_rl_module_inference_only": false, "broadcast_offline_eval_runner_states": false, "offline_eval_batch_size_per_runner": 256, "dataset_num_iters_per_eval_runner": 1, "keep_per_episode_custom_metrics": false, "metrics_episode_collection_timeout_s": 60.0, "metrics_num_episodes_for_smoothing": 100, "min_time_s_per_iteration": null, "min_train_timesteps_per_iteration": 0, "min_sample_timesteps_per_iteration": 0, "log_gradients": true, "export_native_model_files": false, "checkpoint_trainable_policies_only": false, "logger_creator": null, "logger_config": null, "log_level": "WARN", "log_sys_usage": true, "fake_sampler": false, "seed": 4, "restart_failed_env_runners": true, "ignore_env_runner_failures": false, "max_num_env_runner_restarts": 1000, "delay_between_env_runner_restarts_s": 60.0, "restart_failed_sub_environments": false, "num_consecutive_env_runner_failures_tolerance": 100, "env_runner_health_probe_timeout_s": 30.0, "env_runner_restore_timeout_s": 1800.0, "_model_config": {}, "_rl_module_spec": "RLModuleSpec(module_class=None, observation_space=None, action_space=None, inference_only=False, learner_only=False, model_config=DefaultModelConfig(fcnet_hiddens=[60, 90], fcnet_activation='tanh', fcnet_kernel_initializer=None, fcnet_kernel_initializer_kwargs=None, fcnet_bias_initializer=None, fcnet_bias_initializer_kwargs=None, conv_filters=None, conv_activation='relu', conv_kernel_initializer=None, conv_kernel_initializer_kwargs=None, conv_bias_initializer=None, conv_bias_initializer_kwargs=None, head_fcnet_hiddens=[], head_fcnet_activation='relu', head_fcnet_kernel_initializer=None, head_fcnet_kernel_initializer_kwargs=None, head_fcnet_bias_initializer=None, head_fcnet_bias_initializer_kwargs=None, free_log_std=False, log_std_clip_param=20.0, vf_share_layers=True, use_lstm=False, max_seq_len=20, lstm_cell_size=256, lstm_use_prev_action=False, lstm_use_prev_reward=False, lstm_kernel_initializer=None, lstm_kernel_initializer_kwargs=None, lstm_bias_initializer=None, lstm_bias_initializer_kwargs=None), catalog_class=None, load_state_path=None, model_config_dict=None)", "algorithm_config_overrides_per_module": {}, "_per_module_overrides": {}, "_validate_config": true, "_use_msgpack_checkpoints": false, "_torch_grad_scaler_class": null, "_torch_lr_scheduler_classes": null, "_tf_policy_handles_more_than_one_loss": false, "_disable_preprocessor_api": false, "_disable_action_flattening": false, "_disable_initialize_loss_from_dummy_batch": false, "_dont_auto_sync_env_runner_states": false, "env_task_fn": -1, "enable_connectors": -1, "simple_optimizer": false, "policy_map_cache": -1, "worker_cls": -1, "synchronize_filters": -1, "enable_async_evaluation": -1, "custom_async_evaluation_function": -1, "_enable_rl_module_api": -1, "auto_wrap_old_gym_envs": -1, "always_attach_evaluation_results": -1, "replay_sequence_length": null, "_disable_execution_plan_api": -1, "use_critic": true, "use_gae": true, "use_kl_loss": true, "kl_coeff": 0.7464963036515, "kl_target": 0.0270990929592, "vf_loss_coeff": 0.6688075857018, "entropy_coeff": 0.0090570820258, "clip_param": 0.1221781641624, "vf_clip_param": 0.1027808522125, "entropy_coeff_schedule": null, "lr_schedule": null, "sgd_minibatch_size": -1, "vf_share_layers": -1, "__stdout_file__": null, "__stderr_file__": null, "lambda": 0.9099046732075, "input": "sampler", "policies": {"default_policy": [null, null, null, null]}, "callbacks": "<class 'ray.rllib.callbacks.callbacks.RLlibCallback'>", "create_env_on_driver": false, "custom_eval_function": null, "framework": "torch"}, "time_since_restore": 14.671515226364136, "iterations_since_restore": 8, "perf": {"cpu_util_percent": 53.75, "ram_util_percent": 79.25}}
{"timers": {"training_iteration": 1.90770525285451, "restore_env_runners": 9.42766779061807e-06, "training_step": 1.9075443230108238, "env_runner_sampling_timer": 1.782916621589035, "learner_update_timer": 0.12068891146653078, "synch_weights": 0.0010317772410583926, "restore_eval_env_runners": 8.984234257202658e-06, "evaluation_iteration": 0.12519688583135707, "synch_eval_env_connectors": 0.00012909349732560829, "synch_env_connectors": 4.3400394069835865e-06}, "env_runners": {"env_reset_timer": 4.43962664836362e-05, "num_env_steps_sampled": 5000.0, "num_agent_steps_sampled_lifetime": {"default_agent": -4312500.0}, "episode_duration_sec_mean": 0.006378918041475119, "time_between_sampling": 0.0016409837742990304, "module_to_env_connector": {"timers": {"connectors": {"tensor_to_numpy": 1.9536197986598508e-05, "normalize_and_clip_actions": 1.1886631659224046e-05, "listify_data_for_vector_env": 1.4619828231519453e-05, "un_batch_to_individual_items": 6.1388074423501635e-06, "get_actions": 5.134567781773915e-05, "remove_single_ts_time_rank_from_batch": 1.3165411522406876e-06}}, "connector_pipeline_timer": 0.00013541883554431174}, "sample": 0.005881469471613178, "episode_return_max": 12.5, "num_env_steps_sampled_lifetime": -4312500.0, "agent_episode_returns_mean": {"default_agent": 8.980000000000004}, "env_to_module_connector": {"timers": {"connectors": {"add_states_from_episodes_to_batch": 1.9632026903383807e-06, "add_observations_from_episodes_to_batch": 3.4159300306273152e-06, "numpy_to_tensor": 1.1339472458029753e-05, "batch_individual_items": 7.861903252242913e-06, "add_time_dim_to_batch_and_zero_pad": 3.136678346944672e-06}}, "connector_pipeline_timer": 5.745659267830982e-05}, "episode_len_max": 20, "episode_return_mean": 8.980000000000004, "weights_seq_no": 8.0, "rlmodule_inference_timer": 4.7071217269372324e-05, "env_to_module_sum_episodes_length_in": 10.36823839457432, "env_step_timer": 2.6765959435625445e-05, "num_module_steps_sampled": {"default_policy": 5000.0}, "episode_len_min": 20, "episode_len_mean": 20.0, "num_episodes": 250.0, "episode_return_min": -7.5, "num_module_steps_sampled_lifetime": {"default_policy": -4312500.0}, "module_episode_returns_mean": {"default_policy": 8.980000000000004}, "num_agent_steps_sampled": {"default_agent": 5000.0}, "num_episodes_lifetime": -215625.0, "env_to_module_sum_episodes_length_out": 10.36823839457432, "num_env_steps_sampled_lifetime_throughput": 3391.609372553487}, "learners": {"default_policy": {"num_module_steps_trained": 6000, "gradients_default_optimizer_global_norm": 0.023104187101125717, "vf_explained_var": 0.019284963607788086, "num_module_steps_trained_lifetime": 54000, "policy_loss": -0.10377395898103714, "num_trainable_parameters": 6003, "entropy": 0.5701533555984497, "weights_seq_no": 9.0, "curr_entropy_coeff": 0.0090570820258, "module_train_batch_size_mean": 1000.0, "total_loss": -0.04069652780890465, "default_optimizer_learning_rate": 0.0002847858517, "vf_loss": 0.10202646255493164, "curr_kl_coeff": 0.0014580006245523691, "mean_kl_loss": 0.0018121906323358417, "vf_loss_unclipped": 28.674518585205078, "diff_num_grad_updates_vs_sampler_policy": 1.0, "num_module_steps_trained_lifetime_throughput": 340963.21825454145}, "__all_modules__": {"num_env_steps_trained_lifetime": 283500, "learner_connector_sum_episodes_length_in": 5000.0, "learner_connector_sum_episodes_length_out": 5250.0, "num_module_steps_trained": 6000, "num_env_steps_trained": 31500, "learner_connector": {"timers": {"connectors": {"add_states_from_episodes_to_batch": 4.111984285594549e-06, "general_advantage_estimation": 0.00827773903894956, "add_observations_from_episodes_to_batch": 0.0008949584849770548, "add_time_dim_to_batch_and_zero_pad": 1.3615422005219041e-05, "add_one_ts_to_episodes_and_truncate": 0.009997375209011205, "numpy_to_tensor": 7.530231922826655e-05, "batch_individual_items": 0.03461859461495743, "add_columns_from_episodes_to_train_batch": 0.03799550438828572}}, "connector_pipeline_timer": 0.09204212262604121}, "num_module_steps_trained_lifetime": 54000, "num_trainable_parameters": 6003, "num_non_trainable_parameters": 0, "num_env_steps_trained_lifetime_throughput": 1748982.619959088, "num_module_steps_trained_throughput": 335031.6490471398, "num_module_steps_trained_lifetime_throughput": 333958.85371246096}}, "num_training_step_calls_per_iteration": 1, "evaluation": {"env_runners": {"agent_episode_returns_mean": {"default_agent": 0.35}, "env_to_module_connector": {"timers": {"connectors": {"numpy_to_tensor": 8.66336628527641e-06, "batch_individual_items": 6.42648183065155e-06, "add_observations_from_episodes_to_batch": 2.876239532047643e-06, "add_time_dim_to_batch_and_zero_pad": 2.538822457776408e-06, "add_states_from_episodes_to_batch": 1.6344730794865049e-06}}, "connector_pipeline_timer": 4.470685733096721e-05}, "module_to_env_connector": {"timers": {"connectors": {"get_actions": 3.7646943991323686e-05, "tensor_to_numpy": 1.3339683645104633e-05, "normalize_and_clip_actions": 9.661034443682404e-06, "remove_single_ts_time_rank_from_batch": 6.555607711324811e-07, "un_batch_to_individual_items": 5.525786777246384e-06, "listify_data_for_vector_env": 1.126085633731243e-05}}, "connector_pipeline_timer": 0.00010429821145884433}, "episode_len_max": 20, "env_step_timer": 1.4647693057400444e-05, "episode_len_min": 20, "episode_return_min": -16.5, "num_episodes_lifetime": 180, "num_module_steps_sampled_lifetime": {"default_policy": 3600}, "sample": 0.11672800825333074, "rlmodule_inference_timer": 2.8185854949055655e-05, "env_to_module_sum_episodes_length_in": 10.368238394574323, "module_episode_returns_mean": {"default_policy": 0.35}, "env_reset_timer": 0.000259853546730727, "num_agent_steps_sampled_lifetime": {"default_agent": 3600}, "weights_seq_no": 9.0, "num_module_steps_sampled": {"default_policy": 400}, "episode_len_mean": 20.0, "num_env_steps_sampled": 400, "episode_duration_sec_mean": 0.005061730387387798, "episode_return_max": 12.5, "episode_return_mean": 0.35, "env_to_module_sum_episodes_length_out": 10.368238394574323, "num_episodes": 20, "num_agent_steps_sampled": {"default_agent": 400}, "num_env_steps_sampled_lifetime": 45400, "time_between_sampling": 1.8344493640906294}, "num_healthy_workers": 1, "actor_manager_num_outstanding_async_reqs": 0, "num_remote_worker_restarts": 0}, "num_env_steps_sampled_lifetime": -4312500.0, "fault_tolerance": {"num_healthy_workers": 0, "num_remote_worker_restarts": 0}, "env_runner_group": {"actor_manager_num_outstanding_async_reqs": 0}, "done": false, "training_iteration": 9, "trial_id": "4dd64_00000", "date": "2025-08-11_19-22-33", "timestamp": 1754932953, "time_this_iter_s": 2.247403860092163, "time_total_s": 16.9189190864563, "pid": 14353, "hostname": "Mac", "node_ip": "127.0.0.1", "config": {"exploration_config": {}, "extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "placement_strategy": "PACK", "num_gpus": 0, "_fake_gpus": false, "num_cpus_for_main_process": 2, "eager_tracing": true, "eager_max_retraces": 20, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "torch_compile_learner": false, "torch_compile_learner_what_to_compile": "forward_train", "torch_compile_learner_dynamo_backend": "aot_eager", "torch_compile_learner_dynamo_mode": null, "torch_compile_worker": false, "torch_compile_worker_dynamo_backend": "aot_eager", "torch_compile_worker_dynamo_mode": null, "torch_ddp_kwargs": {}, "torch_skip_nan_gradients": false, "env": "Umbrella", "env_config": {}, "observation_space": null, "action_space": null, "clip_rewards": null, "normalize_actions": true, "clip_actions": false, "_is_atari": null, "disable_env_checking": false, "render_env": false, "action_mask_key": "action_mask", "env_runner_cls": null, "num_env_runners": 0, "create_local_env_runner": true, "num_envs_per_env_runner": 1, "gym_env_vectorize_mode": "SYNC", "num_cpus_per_env_runner": 1, "num_gpus_per_env_runner": 0, "custom_resources_per_env_runner": {}, "validate_env_runners_after_construction": true, "episodes_to_numpy": true, "max_requests_in_flight_per_env_runner": 1, "sample_timeout_s": 60.0, "_env_to_module_connector": null, "add_default_connectors_to_env_to_module_pipeline": true, "_module_to_env_connector": null, "add_default_connectors_to_module_to_env_pipeline": true, "merge_env_runner_states": "training_only", "broadcast_env_runner_states": true, "episode_lookback_horizon": 1, "rollout_fragment_length": "auto", "batch_mode": "complete_episodes", "compress_observations": false, "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "enable_tf1_exec_eagerly": false, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "preprocessor_pref": "deepmind", "observation_filter": "NoFilter", "update_worker_filter_stats": true, "use_worker_filter_stats": true, "sampler_perf_stats_ema_coef": null, "_is_online": true, "num_learners": 0, "num_gpus_per_learner": 0, "num_cpus_per_learner": "auto", "num_aggregator_actors_per_learner": 0, "max_requests_in_flight_per_aggregator_actor": 3, "local_gpu_idx": 0, "max_requests_in_flight_per_learner": 3, "gamma": 1, "lr": 0.0002847858517, "grad_clip": 0.5, "grad_clip_by": "global_norm", "_train_batch_size_per_learner": 5000, "train_batch_size": 4000, "num_epochs": 1, "minibatch_size": 1000, "shuffle_batch_per_epoch": true, "model": {"fcnet_hiddens": [256, 256], "fcnet_activation": "tanh", "fcnet_weights_initializer": null, "fcnet_weights_initializer_config": null, "fcnet_bias_initializer": null, "fcnet_bias_initializer_config": null, "conv_filters": null, "conv_activation": "relu", "conv_kernel_initializer": null, "conv_kernel_initializer_config": null, "conv_bias_initializer": null, "conv_bias_initializer_config": null, "conv_transpose_kernel_initializer": null, "conv_transpose_kernel_initializer_config": null, "conv_transpose_bias_initializer": null, "conv_transpose_bias_initializer_config": null, "post_fcnet_hiddens": [], "post_fcnet_activation": "relu", "post_fcnet_weights_initializer": null, "post_fcnet_weights_initializer_config": null, "post_fcnet_bias_initializer": null, "post_fcnet_bias_initializer_config": null, "free_log_std": false, "log_std_clip_param": 20.0, "no_final_linear": false, "vf_share_layers": false, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "lstm_weights_initializer": null, "lstm_weights_initializer_config": null, "lstm_bias_initializer": null, "lstm_bias_initializer_config": null, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "attention_use_n_prev_actions": 0, "attention_use_n_prev_rewards": 0, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": null, "custom_model_config": {}, "custom_action_dist": null, "custom_preprocessor": null, "encoder_latent_dim": null, "always_check_shapes": false, "lstm_use_prev_action_reward": -1, "_use_default_native_models": -1, "_disable_preprocessor_api": false, "_disable_action_flattening": false}, "_learner_connector": null, "add_default_connectors_to_learner_pipeline": true, "learner_config_dict": {}, "optimizer": {}, "_learner_class": null, "callbacks_on_algorithm_init": null, "callbacks_on_env_runners_recreated": null, "callbacks_on_offline_eval_runners_recreated": null, "callbacks_on_checkpoint_loaded": null, "callbacks_on_environment_created": null, "callbacks_on_episode_created": null, "callbacks_on_episode_start": null, "callbacks_on_episode_step": null, "callbacks_on_episode_end": null, "callbacks_on_evaluate_start": null, "callbacks_on_evaluate_end": null, "callbacks_on_evaluate_offline_start": null, "callbacks_on_evaluate_offline_end": null, "callbacks_on_sample_end": null, "callbacks_on_train_result": null, "explore": true, "enable_rl_module_and_learner": true, "enable_env_runner_and_connector_v2": true, "_prior_exploration_config": {"type": "StochasticSampling"}, "count_steps_by": "env_steps", "policy_map_capacity": 100, "policy_mapping_fn": "<function AlgorithmConfig.DEFAULT_POLICY_MAPPING_FN at 0x3834118a0>", "policies_to_train": null, "policy_states_are_swappable": false, "observation_fn": null, "offline_data_class": null, "input_read_method": "read_parquet", "input_read_method_kwargs": {}, "input_read_schema": {}, "input_read_episodes": false, "input_read_sample_batches": false, "input_read_batch_size": null, "input_filesystem": null, "input_filesystem_kwargs": {}, "input_compress_columns": ["obs", "new_obs"], "input_spaces_jsonable": true, "materialize_data": false, "materialize_mapped_data": true, "map_batches_kwargs": {}, "iter_batches_kwargs": {}, "ignore_final_observation": false, "prelearner_class": null, "prelearner_buffer_class": null, "prelearner_buffer_kwargs": {}, "prelearner_module_synch_period": 10, "dataset_num_iters_per_learner": null, "input_config": {}, "actions_in_input_normalized": false, "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_config": {}, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "output_max_rows_per_file": null, "output_write_remaining_data": false, "output_write_method": "write_parquet", "output_write_method_kwargs": {}, "output_filesystem": null, "output_filesystem_kwargs": {}, "output_write_episodes": true, "offline_sampling": false, "evaluation_interval": 1, "evaluation_duration": 20, "evaluation_duration_unit": "episodes", "evaluation_sample_timeout_s": 120.0, "evaluation_auto_duration_min_env_steps_per_sample": 100, "evaluation_auto_duration_max_env_steps_per_sample": 2000, "evaluation_parallel_to_training": false, "evaluation_force_reset_envs_before_iteration": true, "evaluation_config": null, "off_policy_estimation_methods": {}, "ope_split_batch_by_episode": true, "evaluation_num_env_runners": 1, "in_evaluation": false, "sync_filters_on_rollout_workers_timeout_s": 10.0, "offline_evaluation_interval": null, "num_offline_eval_runners": 0, "offline_loss_for_module_fn": null, "offline_evaluation_duration": 1, "offline_evaluation_parallel_to_training": false, "offline_evaluation_timeout_s": 120.0, "num_cpus_per_offline_eval_runner": 1, "num_gpus_per_offline_eval_runner": 0, "custom_resources_per_offline_eval_runner": {}, "restart_failed_offline_eval_runners": true, "ignore_offline_eval_runner_failures": false, "max_num_offline_eval_runner_restarts": 1000, "offline_eval_runner_restore_timeout_s": 1800.0, "max_requests_in_flight_per_offline_eval_runner": 1, "validate_offline_eval_runners_after_construction": true, "offline_eval_runner_health_probe_timeout_s": 30.0, "offline_eval_rl_module_inference_only": false, "broadcast_offline_eval_runner_states": false, "offline_eval_batch_size_per_runner": 256, "dataset_num_iters_per_eval_runner": 1, "keep_per_episode_custom_metrics": false, "metrics_episode_collection_timeout_s": 60.0, "metrics_num_episodes_for_smoothing": 100, "min_time_s_per_iteration": null, "min_train_timesteps_per_iteration": 0, "min_sample_timesteps_per_iteration": 0, "log_gradients": true, "export_native_model_files": false, "checkpoint_trainable_policies_only": false, "logger_creator": null, "logger_config": null, "log_level": "WARN", "log_sys_usage": true, "fake_sampler": false, "seed": 4, "restart_failed_env_runners": true, "ignore_env_runner_failures": false, "max_num_env_runner_restarts": 1000, "delay_between_env_runner_restarts_s": 60.0, "restart_failed_sub_environments": false, "num_consecutive_env_runner_failures_tolerance": 100, "env_runner_health_probe_timeout_s": 30.0, "env_runner_restore_timeout_s": 1800.0, "_model_config": {}, "_rl_module_spec": "RLModuleSpec(module_class=None, observation_space=None, action_space=None, inference_only=False, learner_only=False, model_config=DefaultModelConfig(fcnet_hiddens=[60, 90], fcnet_activation='tanh', fcnet_kernel_initializer=None, fcnet_kernel_initializer_kwargs=None, fcnet_bias_initializer=None, fcnet_bias_initializer_kwargs=None, conv_filters=None, conv_activation='relu', conv_kernel_initializer=None, conv_kernel_initializer_kwargs=None, conv_bias_initializer=None, conv_bias_initializer_kwargs=None, head_fcnet_hiddens=[], head_fcnet_activation='relu', head_fcnet_kernel_initializer=None, head_fcnet_kernel_initializer_kwargs=None, head_fcnet_bias_initializer=None, head_fcnet_bias_initializer_kwargs=None, free_log_std=False, log_std_clip_param=20.0, vf_share_layers=True, use_lstm=False, max_seq_len=20, lstm_cell_size=256, lstm_use_prev_action=False, lstm_use_prev_reward=False, lstm_kernel_initializer=None, lstm_kernel_initializer_kwargs=None, lstm_bias_initializer=None, lstm_bias_initializer_kwargs=None), catalog_class=None, load_state_path=None, model_config_dict=None)", "algorithm_config_overrides_per_module": {}, "_per_module_overrides": {}, "_validate_config": true, "_use_msgpack_checkpoints": false, "_torch_grad_scaler_class": null, "_torch_lr_scheduler_classes": null, "_tf_policy_handles_more_than_one_loss": false, "_disable_preprocessor_api": false, "_disable_action_flattening": false, "_disable_initialize_loss_from_dummy_batch": false, "_dont_auto_sync_env_runner_states": false, "env_task_fn": -1, "enable_connectors": -1, "simple_optimizer": false, "policy_map_cache": -1, "worker_cls": -1, "synchronize_filters": -1, "enable_async_evaluation": -1, "custom_async_evaluation_function": -1, "_enable_rl_module_api": -1, "auto_wrap_old_gym_envs": -1, "always_attach_evaluation_results": -1, "replay_sequence_length": null, "_disable_execution_plan_api": -1, "use_critic": true, "use_gae": true, "use_kl_loss": true, "kl_coeff": 0.7464963036515, "kl_target": 0.0270990929592, "vf_loss_coeff": 0.6688075857018, "entropy_coeff": 0.0090570820258, "clip_param": 0.1221781641624, "vf_clip_param": 0.1027808522125, "entropy_coeff_schedule": null, "lr_schedule": null, "sgd_minibatch_size": -1, "vf_share_layers": -1, "__stdout_file__": null, "__stderr_file__": null, "lambda": 0.9099046732075, "input": "sampler", "policies": {"default_policy": [null, null, null, null]}, "callbacks": "<class 'ray.rllib.callbacks.callbacks.RLlibCallback'>", "create_env_on_driver": false, "custom_eval_function": null, "framework": "torch"}, "time_since_restore": 16.9189190864563, "iterations_since_restore": 9, "perf": {"cpu_util_percent": 51.425000000000004, "ram_util_percent": 80.925}}
{"timers": {"training_iteration": 1.9043004161662784, "restore_env_runners": 9.396301952627164e-06, "training_step": 1.9041389993605968, "env_runner_sampling_timer": 1.7788917695434103, "learner_update_timer": 0.12131482568131835, "synch_weights": 0.001027694468393893, "restore_eval_env_runners": 9.003561546827057e-06, "evaluation_iteration": 0.12505905572317008, "synch_eval_env_connectors": 0.0001290388127435822, "synch_env_connectors": 4.337478671963857e-06}, "env_runners": {"env_reset_timer": 4.1126509761553036e-05, "num_env_steps_sampled": 5000.0, "num_agent_steps_sampled_lifetime": {"default_agent": -4930000.0}, "episode_duration_sec_mean": 0.004551643676590174, "time_between_sampling": 0.0021666977465883905, "module_to_env_connector": {"timers": {"connectors": {"tensor_to_numpy": 1.3222093960101526e-05, "normalize_and_clip_actions": 9.438013583640186e-06, "listify_data_for_vector_env": 1.1109361945191976e-05, "un_batch_to_individual_items": 5.408212643658485e-06, "get_actions": 3.934222956213859e-05, "remove_single_ts_time_rank_from_batch": 5.797846245154783e-07}}, "connector_pipeline_timer": 0.0001047609906388606}, "sample": 0.006032553265779401, "episode_return_max": 12.5, "num_env_steps_sampled_lifetime": -4930000.0, "agent_episode_returns_mean": {"default_agent": 8.260000000000002}, "env_to_module_connector": {"timers": {"connectors": {"add_states_from_episodes_to_batch": 1.7343178013202667e-06, "add_observations_from_episodes_to_batch": 3.000746471522162e-06, "numpy_to_tensor": 8.656778624669317e-06, "batch_individual_items": 6.247973946428801e-06, "add_time_dim_to_batch_and_zero_pad": 2.3342384613034717e-06}}, "connector_pipeline_timer": 4.3550543510387285e-05}, "episode_len_max": 20, "episode_return_mean": 8.260000000000002, "weights_seq_no": 9.0, "rlmodule_inference_timer": 2.780393175363629e-05, "env_to_module_sum_episodes_length_in": 10.36823839457432, "env_step_timer": 1.3836045044978768e-05, "num_module_steps_sampled": {"default_policy": 5000.0}, "episode_len_min": 20, "episode_len_mean": 20.0, "num_episodes": 250.0, "episode_return_min": -7.5, "num_module_steps_sampled_lifetime": {"default_policy": -4930000.0}, "module_episode_returns_mean": {"default_policy": 8.260000000000002}, "num_agent_steps_sampled": {"default_agent": 5000.0}, "num_episodes_lifetime": -246500.0, "env_to_module_sum_episodes_length_out": 10.36823839457432, "num_env_steps_sampled_lifetime_throughput": 3656.4858631566767}, "learners": {"default_policy": {"num_module_steps_trained": 6000, "gradients_default_optimizer_global_norm": 0.07620148360729218, "vf_explained_var": 0.019550085067749023, "num_module_steps_trained_lifetime": 60000, "policy_loss": -0.12937036156654358, "num_trainable_parameters": 6003, "entropy": 0.5392490029335022, "weights_seq_no": 10.0, "curr_entropy_coeff": 0.0090570820258, "module_train_batch_size_mean": 1000.0, "total_loss": -0.06608772277832031, "default_optimizer_learning_rate": 0.0002847858517, "vf_loss": 0.10191888362169266, "curr_kl_coeff": 0.0007290003122761846, "mean_kl_loss": 0.0017268538940697908, "vf_loss_unclipped": 28.66448402404785, "diff_num_grad_updates_vs_sampler_policy": 1.0, "num_module_steps_trained_lifetime_throughput": 342616.02097995137}, "__all_modules__": {"num_env_steps_trained_lifetime": 315000, "learner_connector_sum_episodes_length_in": 5000.0, "learner_connector_sum_episodes_length_out": 5250.0, "num_module_steps_trained": 6000, "num_env_steps_trained": 31500, "learner_connector": {"timers": {"connectors": {"add_states_from_episodes_to_batch": 4.096283728259514e-06, "general_advantage_estimation": 0.008251089988634856, "add_observations_from_episodes_to_batch": 0.0008942634903387203, "add_time_dim_to_batch_and_zero_pad": 1.355509839749848e-05, "add_one_ts_to_episodes_and_truncate": 0.009974703127019771, "numpy_to_tensor": 7.519345693624887e-05, "batch_individual_items": 0.035463807418168666, "add_columns_from_episodes_to_train_batch": 0.03796098684433022}}, "connector_pipeline_timer": 0.09280183472971802}, "num_module_steps_trained_lifetime": 60000, "num_trainable_parameters": 6003, "num_non_trainable_parameters": 0, "num_env_steps_trained_lifetime_throughput": 1759637.1054483764, "num_module_steps_trained_throughput": 336984.43066264736, "num_module_steps_trained_lifetime_throughput": 335953.91247621126}}, "num_training_step_calls_per_iteration": 1, "evaluation": {"env_runners": {"agent_episode_returns_mean": {"default_agent": 0.35}, "env_to_module_connector": {"timers": {"connectors": {"numpy_to_tensor": 8.336893549439287e-06, "batch_individual_items": 6.151443496257663e-06, "add_observations_from_episodes_to_batch": 2.7893211488938135e-06, "add_time_dim_to_batch_and_zero_pad": 2.2335695521193226e-06, "add_states_from_episodes_to_batch": 1.5581434097642257e-06}}, "connector_pipeline_timer": 4.269980300571988e-05}, "module_to_env_connector": {"timers": {"connectors": {"get_actions": 3.5522014476486514e-05, "tensor_to_numpy": 1.2762468942879005e-05, "normalize_and_clip_actions": 9.358156899496429e-06, "remove_single_ts_time_rank_from_batch": 6.239797215084522e-07, "un_batch_to_individual_items": 5.426694353817055e-06, "listify_data_for_vector_env": 1.0785511700152424e-05}}, "connector_pipeline_timer": 0.00010002026061183281}, "episode_len_max": 20, "env_step_timer": 1.3852119373858353e-05, "episode_len_min": 20, "episode_return_min": -16.5, "num_episodes_lifetime": 200, "num_module_steps_sampled_lifetime": {"default_policy": 4000}, "sample": 0.11656934609066716, "rlmodule_inference_timer": 2.713104331305076e-05, "env_to_module_sum_episodes_length_in": 10.368238394574323, "module_episode_returns_mean": {"default_policy": 0.35}, "env_reset_timer": 0.0002579846012193009, "num_agent_steps_sampled_lifetime": {"default_agent": 4000}, "weights_seq_no": 10.0, "num_module_steps_sampled": {"default_policy": 400}, "episode_len_mean": 20.0, "num_env_steps_sampled": 400, "episode_duration_sec_mean": 0.004999734949087724, "episode_return_max": 12.5, "episode_return_mean": 0.35, "env_to_module_sum_episodes_length_out": 10.368238394574323, "num_episodes": 20, "num_agent_steps_sampled": {"default_agent": 400}, "num_env_steps_sampled_lifetime": 50400, "time_between_sampling": 1.8319738641993324}, "num_healthy_workers": 1, "actor_manager_num_outstanding_async_reqs": 0, "num_remote_worker_restarts": 0}, "num_env_steps_sampled_lifetime": -4930000.0, "fault_tolerance": {"num_healthy_workers": 0, "num_remote_worker_restarts": 0}, "env_runner_group": {"actor_manager_num_outstanding_async_reqs": 0}, "done": false, "training_iteration": 10, "trial_id": "4dd64_00000", "date": "2025-08-11_19-22-35", "timestamp": 1754932955, "time_this_iter_s": 1.6755108833312988, "time_total_s": 18.594429969787598, "pid": 14353, "hostname": "Mac", "node_ip": "127.0.0.1", "config": {"exploration_config": {}, "extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "placement_strategy": "PACK", "num_gpus": 0, "_fake_gpus": false, "num_cpus_for_main_process": 2, "eager_tracing": true, "eager_max_retraces": 20, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "torch_compile_learner": false, "torch_compile_learner_what_to_compile": "forward_train", "torch_compile_learner_dynamo_backend": "aot_eager", "torch_compile_learner_dynamo_mode": null, "torch_compile_worker": false, "torch_compile_worker_dynamo_backend": "aot_eager", "torch_compile_worker_dynamo_mode": null, "torch_ddp_kwargs": {}, "torch_skip_nan_gradients": false, "env": "Umbrella", "env_config": {}, "observation_space": null, "action_space": null, "clip_rewards": null, "normalize_actions": true, "clip_actions": false, "_is_atari": null, "disable_env_checking": false, "render_env": false, "action_mask_key": "action_mask", "env_runner_cls": null, "num_env_runners": 0, "create_local_env_runner": true, "num_envs_per_env_runner": 1, "gym_env_vectorize_mode": "SYNC", "num_cpus_per_env_runner": 1, "num_gpus_per_env_runner": 0, "custom_resources_per_env_runner": {}, "validate_env_runners_after_construction": true, "episodes_to_numpy": true, "max_requests_in_flight_per_env_runner": 1, "sample_timeout_s": 60.0, "_env_to_module_connector": null, "add_default_connectors_to_env_to_module_pipeline": true, "_module_to_env_connector": null, "add_default_connectors_to_module_to_env_pipeline": true, "merge_env_runner_states": "training_only", "broadcast_env_runner_states": true, "episode_lookback_horizon": 1, "rollout_fragment_length": "auto", "batch_mode": "complete_episodes", "compress_observations": false, "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "enable_tf1_exec_eagerly": false, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "preprocessor_pref": "deepmind", "observation_filter": "NoFilter", "update_worker_filter_stats": true, "use_worker_filter_stats": true, "sampler_perf_stats_ema_coef": null, "_is_online": true, "num_learners": 0, "num_gpus_per_learner": 0, "num_cpus_per_learner": "auto", "num_aggregator_actors_per_learner": 0, "max_requests_in_flight_per_aggregator_actor": 3, "local_gpu_idx": 0, "max_requests_in_flight_per_learner": 3, "gamma": 1, "lr": 0.0002847858517, "grad_clip": 0.5, "grad_clip_by": "global_norm", "_train_batch_size_per_learner": 5000, "train_batch_size": 4000, "num_epochs": 1, "minibatch_size": 1000, "shuffle_batch_per_epoch": true, "model": {"fcnet_hiddens": [256, 256], "fcnet_activation": "tanh", "fcnet_weights_initializer": null, "fcnet_weights_initializer_config": null, "fcnet_bias_initializer": null, "fcnet_bias_initializer_config": null, "conv_filters": null, "conv_activation": "relu", "conv_kernel_initializer": null, "conv_kernel_initializer_config": null, "conv_bias_initializer": null, "conv_bias_initializer_config": null, "conv_transpose_kernel_initializer": null, "conv_transpose_kernel_initializer_config": null, "conv_transpose_bias_initializer": null, "conv_transpose_bias_initializer_config": null, "post_fcnet_hiddens": [], "post_fcnet_activation": "relu", "post_fcnet_weights_initializer": null, "post_fcnet_weights_initializer_config": null, "post_fcnet_bias_initializer": null, "post_fcnet_bias_initializer_config": null, "free_log_std": false, "log_std_clip_param": 20.0, "no_final_linear": false, "vf_share_layers": false, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "lstm_weights_initializer": null, "lstm_weights_initializer_config": null, "lstm_bias_initializer": null, "lstm_bias_initializer_config": null, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "attention_use_n_prev_actions": 0, "attention_use_n_prev_rewards": 0, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": null, "custom_model_config": {}, "custom_action_dist": null, "custom_preprocessor": null, "encoder_latent_dim": null, "always_check_shapes": false, "lstm_use_prev_action_reward": -1, "_use_default_native_models": -1, "_disable_preprocessor_api": false, "_disable_action_flattening": false}, "_learner_connector": null, "add_default_connectors_to_learner_pipeline": true, "learner_config_dict": {}, "optimizer": {}, "_learner_class": null, "callbacks_on_algorithm_init": null, "callbacks_on_env_runners_recreated": null, "callbacks_on_offline_eval_runners_recreated": null, "callbacks_on_checkpoint_loaded": null, "callbacks_on_environment_created": null, "callbacks_on_episode_created": null, "callbacks_on_episode_start": null, "callbacks_on_episode_step": null, "callbacks_on_episode_end": null, "callbacks_on_evaluate_start": null, "callbacks_on_evaluate_end": null, "callbacks_on_evaluate_offline_start": null, "callbacks_on_evaluate_offline_end": null, "callbacks_on_sample_end": null, "callbacks_on_train_result": null, "explore": true, "enable_rl_module_and_learner": true, "enable_env_runner_and_connector_v2": true, "_prior_exploration_config": {"type": "StochasticSampling"}, "count_steps_by": "env_steps", "policy_map_capacity": 100, "policy_mapping_fn": "<function AlgorithmConfig.DEFAULT_POLICY_MAPPING_FN at 0x3834118a0>", "policies_to_train": null, "policy_states_are_swappable": false, "observation_fn": null, "offline_data_class": null, "input_read_method": "read_parquet", "input_read_method_kwargs": {}, "input_read_schema": {}, "input_read_episodes": false, "input_read_sample_batches": false, "input_read_batch_size": null, "input_filesystem": null, "input_filesystem_kwargs": {}, "input_compress_columns": ["obs", "new_obs"], "input_spaces_jsonable": true, "materialize_data": false, "materialize_mapped_data": true, "map_batches_kwargs": {}, "iter_batches_kwargs": {}, "ignore_final_observation": false, "prelearner_class": null, "prelearner_buffer_class": null, "prelearner_buffer_kwargs": {}, "prelearner_module_synch_period": 10, "dataset_num_iters_per_learner": null, "input_config": {}, "actions_in_input_normalized": false, "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_config": {}, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "output_max_rows_per_file": null, "output_write_remaining_data": false, "output_write_method": "write_parquet", "output_write_method_kwargs": {}, "output_filesystem": null, "output_filesystem_kwargs": {}, "output_write_episodes": true, "offline_sampling": false, "evaluation_interval": 1, "evaluation_duration": 20, "evaluation_duration_unit": "episodes", "evaluation_sample_timeout_s": 120.0, "evaluation_auto_duration_min_env_steps_per_sample": 100, "evaluation_auto_duration_max_env_steps_per_sample": 2000, "evaluation_parallel_to_training": false, "evaluation_force_reset_envs_before_iteration": true, "evaluation_config": null, "off_policy_estimation_methods": {}, "ope_split_batch_by_episode": true, "evaluation_num_env_runners": 1, "in_evaluation": false, "sync_filters_on_rollout_workers_timeout_s": 10.0, "offline_evaluation_interval": null, "num_offline_eval_runners": 0, "offline_loss_for_module_fn": null, "offline_evaluation_duration": 1, "offline_evaluation_parallel_to_training": false, "offline_evaluation_timeout_s": 120.0, "num_cpus_per_offline_eval_runner": 1, "num_gpus_per_offline_eval_runner": 0, "custom_resources_per_offline_eval_runner": {}, "restart_failed_offline_eval_runners": true, "ignore_offline_eval_runner_failures": false, "max_num_offline_eval_runner_restarts": 1000, "offline_eval_runner_restore_timeout_s": 1800.0, "max_requests_in_flight_per_offline_eval_runner": 1, "validate_offline_eval_runners_after_construction": true, "offline_eval_runner_health_probe_timeout_s": 30.0, "offline_eval_rl_module_inference_only": false, "broadcast_offline_eval_runner_states": false, "offline_eval_batch_size_per_runner": 256, "dataset_num_iters_per_eval_runner": 1, "keep_per_episode_custom_metrics": false, "metrics_episode_collection_timeout_s": 60.0, "metrics_num_episodes_for_smoothing": 100, "min_time_s_per_iteration": null, "min_train_timesteps_per_iteration": 0, "min_sample_timesteps_per_iteration": 0, "log_gradients": true, "export_native_model_files": false, "checkpoint_trainable_policies_only": false, "logger_creator": null, "logger_config": null, "log_level": "WARN", "log_sys_usage": true, "fake_sampler": false, "seed": 4, "restart_failed_env_runners": true, "ignore_env_runner_failures": false, "max_num_env_runner_restarts": 1000, "delay_between_env_runner_restarts_s": 60.0, "restart_failed_sub_environments": false, "num_consecutive_env_runner_failures_tolerance": 100, "env_runner_health_probe_timeout_s": 30.0, "env_runner_restore_timeout_s": 1800.0, "_model_config": {}, "_rl_module_spec": "RLModuleSpec(module_class=None, observation_space=None, action_space=None, inference_only=False, learner_only=False, model_config=DefaultModelConfig(fcnet_hiddens=[60, 90], fcnet_activation='tanh', fcnet_kernel_initializer=None, fcnet_kernel_initializer_kwargs=None, fcnet_bias_initializer=None, fcnet_bias_initializer_kwargs=None, conv_filters=None, conv_activation='relu', conv_kernel_initializer=None, conv_kernel_initializer_kwargs=None, conv_bias_initializer=None, conv_bias_initializer_kwargs=None, head_fcnet_hiddens=[], head_fcnet_activation='relu', head_fcnet_kernel_initializer=None, head_fcnet_kernel_initializer_kwargs=None, head_fcnet_bias_initializer=None, head_fcnet_bias_initializer_kwargs=None, free_log_std=False, log_std_clip_param=20.0, vf_share_layers=True, use_lstm=False, max_seq_len=20, lstm_cell_size=256, lstm_use_prev_action=False, lstm_use_prev_reward=False, lstm_kernel_initializer=None, lstm_kernel_initializer_kwargs=None, lstm_bias_initializer=None, lstm_bias_initializer_kwargs=None), catalog_class=None, load_state_path=None, model_config_dict=None)", "algorithm_config_overrides_per_module": {}, "_per_module_overrides": {}, "_validate_config": true, "_use_msgpack_checkpoints": false, "_torch_grad_scaler_class": null, "_torch_lr_scheduler_classes": null, "_tf_policy_handles_more_than_one_loss": false, "_disable_preprocessor_api": false, "_disable_action_flattening": false, "_disable_initialize_loss_from_dummy_batch": false, "_dont_auto_sync_env_runner_states": false, "env_task_fn": -1, "enable_connectors": -1, "simple_optimizer": false, "policy_map_cache": -1, "worker_cls": -1, "synchronize_filters": -1, "enable_async_evaluation": -1, "custom_async_evaluation_function": -1, "_enable_rl_module_api": -1, "auto_wrap_old_gym_envs": -1, "always_attach_evaluation_results": -1, "replay_sequence_length": null, "_disable_execution_plan_api": -1, "use_critic": true, "use_gae": true, "use_kl_loss": true, "kl_coeff": 0.7464963036515, "kl_target": 0.0270990929592, "vf_loss_coeff": 0.6688075857018, "entropy_coeff": 0.0090570820258, "clip_param": 0.1221781641624, "vf_clip_param": 0.1027808522125, "entropy_coeff_schedule": null, "lr_schedule": null, "sgd_minibatch_size": -1, "vf_share_layers": -1, "__stdout_file__": null, "__stderr_file__": null, "lambda": 0.9099046732075, "input": "sampler", "policies": {"default_policy": [null, null, null, null]}, "callbacks": "<class 'ray.rllib.callbacks.callbacks.RLlibCallback'>", "create_env_on_driver": false, "custom_eval_function": null, "framework": "torch"}, "time_since_restore": 18.594429969787598, "iterations_since_restore": 10, "perf": {"cpu_util_percent": 43.05, "ram_util_percent": 80.15}}
{"timers": {"training_iteration": 1.9009325415842286, "restore_env_runners": 9.36442904499729e-06, "training_step": 1.900770697287286, "env_runner_sampling_timer": 1.7756782568477538, "learner_update_timer": 0.12116116325440612, "synch_weights": 0.001024003353834049, "restore_eval_env_runners": 8.982685945749731e-06, "evaluation_iteration": 0.12486766683651614, "synch_eval_env_connectors": 0.00012876092359467178, "synch_env_connectors": 4.333274148579328e-06}, "env_runners": {"env_reset_timer": 3.662530525227543e-05, "num_env_steps_sampled": 5000.0, "num_agent_steps_sampled_lifetime": {"default_agent": -5547500.0}, "episode_duration_sec_mean": 0.004785516031552105, "time_between_sampling": 0.0018973084705373486, "module_to_env_connector": {"timers": {"connectors": {"tensor_to_numpy": 1.382972079585853e-05, "normalize_and_clip_actions": 9.72248825648837e-06, "listify_data_for_vector_env": 1.1444974807272062e-05, "un_batch_to_individual_items": 5.604200871845082e-06, "get_actions": 4.1555846768880184e-05, "remove_single_ts_time_rank_from_batch": 6.046008241979536e-07}}, "connector_pipeline_timer": 0.00010914882001202453}, "sample": 0.005035491284683123, "episode_return_max": 12.5, "num_env_steps_sampled_lifetime": -5547500.0, "agent_episode_returns_mean": {"default_agent": 8.980000000000004}, "env_to_module_connector": {"timers": {"connectors": {"add_states_from_episodes_to_batch": 1.7702334813992477e-06, "add_observations_from_episodes_to_batch": 3.024342004412868e-06, "numpy_to_tensor": 9.088793912567383e-06, "batch_individual_items": 6.517173355666338e-06, "add_time_dim_to_batch_and_zero_pad": 2.384835153846612e-06}}, "connector_pipeline_timer": 4.49260153573718e-05}, "episode_len_max": 20, "episode_return_mean": 8.980000000000004, "weights_seq_no": 10.0, "rlmodule_inference_timer": 2.9540549369098212e-05, "env_to_module_sum_episodes_length_in": 10.36823839457432, "env_step_timer": 1.4440475963323014e-05, "num_module_steps_sampled": {"default_policy": 5000.0}, "episode_len_min": 20, "episode_len_mean": 20.0, "num_episodes": 250.0, "episode_return_min": -7.5, "num_module_steps_sampled_lifetime": {"default_policy": -5547500.0}, "module_episode_returns_mean": {"default_policy": 8.980000000000004}, "num_agent_steps_sampled": {"default_agent": 5000.0}, "num_episodes_lifetime": -277375.0, "env_to_module_sum_episodes_length_out": 10.36823839457432, "num_env_steps_sampled_lifetime_throughput": 3616.6555905463015}, "learners": {"default_policy": {"num_module_steps_trained": 6000, "gradients_default_optimizer_global_norm": 0.041982702910900116, "vf_explained_var": 0.019914567470550537, "num_module_steps_trained_lifetime": 66000, "policy_loss": -0.011589430272579193, "num_trainable_parameters": 6003, "entropy": 0.5055301785469055, "weights_seq_no": 11.0, "curr_entropy_coeff": 0.0090570820258, "module_train_batch_size_mean": 1000.0, "total_loss": 0.05192509666085243, "default_optimizer_learning_rate": 0.0002847858517, "vf_loss": 0.10181104391813278, "curr_kl_coeff": 0.0003645001561380923, "mean_kl_loss": 0.0015682962257415056, "vf_loss_unclipped": 28.64272689819336, "diff_num_grad_updates_vs_sampler_policy": 1.0, "num_module_steps_trained_lifetime_throughput": 343756.2082647486}, "__all_modules__": {"num_env_steps_trained_lifetime": 346500, "learner_connector_sum_episodes_length_in": 5000.0, "learner_connector_sum_episodes_length_out": 5250.0, "num_module_steps_trained": 6000, "num_env_steps_trained": 31500, "learner_connector": {"timers": {"connectors": {"add_states_from_episodes_to_batch": 4.088650597615971e-06, "general_advantage_estimation": 0.00823346991812911, "add_observations_from_episodes_to_batch": 0.0008961066954213892, "add_time_dim_to_batch_and_zero_pad": 1.3542457546155154e-05, "add_one_ts_to_episodes_and_truncate": 0.009964647765895413, "numpy_to_tensor": 7.515069191116596e-05, "batch_individual_items": 0.03544390184505607, "add_columns_from_episodes_to_train_batch": 0.03797078572564798}}, "connector_pipeline_timer": 0.09276542597245577}, "num_module_steps_trained_lifetime": 66000, "num_trainable_parameters": 6003, "num_non_trainable_parameters": 0, "num_env_steps_trained_lifetime_throughput": 1767545.7657550361, "num_module_steps_trained_throughput": 338415.56965872704, "num_module_steps_trained_lifetime_throughput": 337426.72584685055}}, "num_training_step_calls_per_iteration": 1, "evaluation": {"env_runners": {"agent_episode_returns_mean": {"default_agent": 0.35}, "env_to_module_connector": {"timers": {"connectors": {"numpy_to_tensor": 8.844834859202791e-06, "batch_individual_items": 6.481650916565189e-06, "add_observations_from_episodes_to_batch": 2.945527445766035e-06, "add_time_dim_to_batch_and_zero_pad": 2.379684314226345e-06, "add_states_from_episodes_to_batch": 1.5970985467551304e-06}}, "connector_pipeline_timer": 4.469897716241481e-05}, "module_to_env_connector": {"timers": {"connectors": {"get_actions": 3.9628900301146914e-05, "tensor_to_numpy": 1.4048192508096005e-05, "normalize_and_clip_actions": 1.0560123983552145e-05, "remove_single_ts_time_rank_from_batch": 6.521685630650073e-07, "un_batch_to_individual_items": 5.694195923287154e-06, "listify_data_for_vector_env": 1.1774731082441582e-05}}, "connector_pipeline_timer": 0.00010962399874210709}, "episode_len_max": 20, "env_step_timer": 1.5101225834518117e-05, "episode_len_min": 20, "episode_return_min": -16.5, "num_episodes_lifetime": 220, "num_module_steps_sampled_lifetime": {"default_policy": 4400}, "sample": 0.11654621263005903, "rlmodule_inference_timer": 2.9471764720441206e-05, "env_to_module_sum_episodes_length_in": 10.368238394574323, "module_episode_returns_mean": {"default_policy": 0.35}, "env_reset_timer": 0.0002562751751061096, "num_agent_steps_sampled_lifetime": {"default_agent": 4400}, "weights_seq_no": 11.0, "num_module_steps_sampled": {"default_policy": 400}, "episode_len_mean": 20.0, "num_env_steps_sampled": 400, "episode_duration_sec_mean": 0.00512879281071946, "episode_return_max": 12.5, "episode_return_mean": 0.35, "env_to_module_sum_episodes_length_out": 10.368238394574323, "num_episodes": 20, "num_agent_steps_sampled": {"default_agent": 400}, "num_env_steps_sampled_lifetime": 55400, "time_between_sampling": 1.8295206797272547}, "num_healthy_workers": 1, "actor_manager_num_outstanding_async_reqs": 0, "num_remote_worker_restarts": 0}, "num_env_steps_sampled_lifetime": -5547500.0, "fault_tolerance": {"num_healthy_workers": 0, "num_remote_worker_restarts": 0}, "env_runner_group": {"actor_manager_num_outstanding_async_reqs": 0}, "done": false, "training_iteration": 11, "trial_id": "4dd64_00000", "date": "2025-08-11_19-22-36", "timestamp": 1754932956, "time_this_iter_s": 1.6902101039886475, "time_total_s": 20.284640073776245, "pid": 14353, "hostname": "Mac", "node_ip": "127.0.0.1", "config": {"exploration_config": {}, "extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "placement_strategy": "PACK", "num_gpus": 0, "_fake_gpus": false, "num_cpus_for_main_process": 2, "eager_tracing": true, "eager_max_retraces": 20, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "torch_compile_learner": false, "torch_compile_learner_what_to_compile": "forward_train", "torch_compile_learner_dynamo_backend": "aot_eager", "torch_compile_learner_dynamo_mode": null, "torch_compile_worker": false, "torch_compile_worker_dynamo_backend": "aot_eager", "torch_compile_worker_dynamo_mode": null, "torch_ddp_kwargs": {}, "torch_skip_nan_gradients": false, "env": "Umbrella", "env_config": {}, "observation_space": null, "action_space": null, "clip_rewards": null, "normalize_actions": true, "clip_actions": false, "_is_atari": null, "disable_env_checking": false, "render_env": false, "action_mask_key": "action_mask", "env_runner_cls": null, "num_env_runners": 0, "create_local_env_runner": true, "num_envs_per_env_runner": 1, "gym_env_vectorize_mode": "SYNC", "num_cpus_per_env_runner": 1, "num_gpus_per_env_runner": 0, "custom_resources_per_env_runner": {}, "validate_env_runners_after_construction": true, "episodes_to_numpy": true, "max_requests_in_flight_per_env_runner": 1, "sample_timeout_s": 60.0, "_env_to_module_connector": null, "add_default_connectors_to_env_to_module_pipeline": true, "_module_to_env_connector": null, "add_default_connectors_to_module_to_env_pipeline": true, "merge_env_runner_states": "training_only", "broadcast_env_runner_states": true, "episode_lookback_horizon": 1, "rollout_fragment_length": "auto", "batch_mode": "complete_episodes", "compress_observations": false, "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "enable_tf1_exec_eagerly": false, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "preprocessor_pref": "deepmind", "observation_filter": "NoFilter", "update_worker_filter_stats": true, "use_worker_filter_stats": true, "sampler_perf_stats_ema_coef": null, "_is_online": true, "num_learners": 0, "num_gpus_per_learner": 0, "num_cpus_per_learner": "auto", "num_aggregator_actors_per_learner": 0, "max_requests_in_flight_per_aggregator_actor": 3, "local_gpu_idx": 0, "max_requests_in_flight_per_learner": 3, "gamma": 1, "lr": 0.0002847858517, "grad_clip": 0.5, "grad_clip_by": "global_norm", "_train_batch_size_per_learner": 5000, "train_batch_size": 4000, "num_epochs": 1, "minibatch_size": 1000, "shuffle_batch_per_epoch": true, "model": {"fcnet_hiddens": [256, 256], "fcnet_activation": "tanh", "fcnet_weights_initializer": null, "fcnet_weights_initializer_config": null, "fcnet_bias_initializer": null, "fcnet_bias_initializer_config": null, "conv_filters": null, "conv_activation": "relu", "conv_kernel_initializer": null, "conv_kernel_initializer_config": null, "conv_bias_initializer": null, "conv_bias_initializer_config": null, "conv_transpose_kernel_initializer": null, "conv_transpose_kernel_initializer_config": null, "conv_transpose_bias_initializer": null, "conv_transpose_bias_initializer_config": null, "post_fcnet_hiddens": [], "post_fcnet_activation": "relu", "post_fcnet_weights_initializer": null, "post_fcnet_weights_initializer_config": null, "post_fcnet_bias_initializer": null, "post_fcnet_bias_initializer_config": null, "free_log_std": false, "log_std_clip_param": 20.0, "no_final_linear": false, "vf_share_layers": false, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "lstm_weights_initializer": null, "lstm_weights_initializer_config": null, "lstm_bias_initializer": null, "lstm_bias_initializer_config": null, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "attention_use_n_prev_actions": 0, "attention_use_n_prev_rewards": 0, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": null, "custom_model_config": {}, "custom_action_dist": null, "custom_preprocessor": null, "encoder_latent_dim": null, "always_check_shapes": false, "lstm_use_prev_action_reward": -1, "_use_default_native_models": -1, "_disable_preprocessor_api": false, "_disable_action_flattening": false}, "_learner_connector": null, "add_default_connectors_to_learner_pipeline": true, "learner_config_dict": {}, "optimizer": {}, "_learner_class": null, "callbacks_on_algorithm_init": null, "callbacks_on_env_runners_recreated": null, "callbacks_on_offline_eval_runners_recreated": null, "callbacks_on_checkpoint_loaded": null, "callbacks_on_environment_created": null, "callbacks_on_episode_created": null, "callbacks_on_episode_start": null, "callbacks_on_episode_step": null, "callbacks_on_episode_end": null, "callbacks_on_evaluate_start": null, "callbacks_on_evaluate_end": null, "callbacks_on_evaluate_offline_start": null, "callbacks_on_evaluate_offline_end": null, "callbacks_on_sample_end": null, "callbacks_on_train_result": null, "explore": true, "enable_rl_module_and_learner": true, "enable_env_runner_and_connector_v2": true, "_prior_exploration_config": {"type": "StochasticSampling"}, "count_steps_by": "env_steps", "policy_map_capacity": 100, "policy_mapping_fn": "<function AlgorithmConfig.DEFAULT_POLICY_MAPPING_FN at 0x3834118a0>", "policies_to_train": null, "policy_states_are_swappable": false, "observation_fn": null, "offline_data_class": null, "input_read_method": "read_parquet", "input_read_method_kwargs": {}, "input_read_schema": {}, "input_read_episodes": false, "input_read_sample_batches": false, "input_read_batch_size": null, "input_filesystem": null, "input_filesystem_kwargs": {}, "input_compress_columns": ["obs", "new_obs"], "input_spaces_jsonable": true, "materialize_data": false, "materialize_mapped_data": true, "map_batches_kwargs": {}, "iter_batches_kwargs": {}, "ignore_final_observation": false, "prelearner_class": null, "prelearner_buffer_class": null, "prelearner_buffer_kwargs": {}, "prelearner_module_synch_period": 10, "dataset_num_iters_per_learner": null, "input_config": {}, "actions_in_input_normalized": false, "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_config": {}, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "output_max_rows_per_file": null, "output_write_remaining_data": false, "output_write_method": "write_parquet", "output_write_method_kwargs": {}, "output_filesystem": null, "output_filesystem_kwargs": {}, "output_write_episodes": true, "offline_sampling": false, "evaluation_interval": 1, "evaluation_duration": 20, "evaluation_duration_unit": "episodes", "evaluation_sample_timeout_s": 120.0, "evaluation_auto_duration_min_env_steps_per_sample": 100, "evaluation_auto_duration_max_env_steps_per_sample": 2000, "evaluation_parallel_to_training": false, "evaluation_force_reset_envs_before_iteration": true, "evaluation_config": null, "off_policy_estimation_methods": {}, "ope_split_batch_by_episode": true, "evaluation_num_env_runners": 1, "in_evaluation": false, "sync_filters_on_rollout_workers_timeout_s": 10.0, "offline_evaluation_interval": null, "num_offline_eval_runners": 0, "offline_loss_for_module_fn": null, "offline_evaluation_duration": 1, "offline_evaluation_parallel_to_training": false, "offline_evaluation_timeout_s": 120.0, "num_cpus_per_offline_eval_runner": 1, "num_gpus_per_offline_eval_runner": 0, "custom_resources_per_offline_eval_runner": {}, "restart_failed_offline_eval_runners": true, "ignore_offline_eval_runner_failures": false, "max_num_offline_eval_runner_restarts": 1000, "offline_eval_runner_restore_timeout_s": 1800.0, "max_requests_in_flight_per_offline_eval_runner": 1, "validate_offline_eval_runners_after_construction": true, "offline_eval_runner_health_probe_timeout_s": 30.0, "offline_eval_rl_module_inference_only": false, "broadcast_offline_eval_runner_states": false, "offline_eval_batch_size_per_runner": 256, "dataset_num_iters_per_eval_runner": 1, "keep_per_episode_custom_metrics": false, "metrics_episode_collection_timeout_s": 60.0, "metrics_num_episodes_for_smoothing": 100, "min_time_s_per_iteration": null, "min_train_timesteps_per_iteration": 0, "min_sample_timesteps_per_iteration": 0, "log_gradients": true, "export_native_model_files": false, "checkpoint_trainable_policies_only": false, "logger_creator": null, "logger_config": null, "log_level": "WARN", "log_sys_usage": true, "fake_sampler": false, "seed": 4, "restart_failed_env_runners": true, "ignore_env_runner_failures": false, "max_num_env_runner_restarts": 1000, "delay_between_env_runner_restarts_s": 60.0, "restart_failed_sub_environments": false, "num_consecutive_env_runner_failures_tolerance": 100, "env_runner_health_probe_timeout_s": 30.0, "env_runner_restore_timeout_s": 1800.0, "_model_config": {}, "_rl_module_spec": "RLModuleSpec(module_class=None, observation_space=None, action_space=None, inference_only=False, learner_only=False, model_config=DefaultModelConfig(fcnet_hiddens=[60, 90], fcnet_activation='tanh', fcnet_kernel_initializer=None, fcnet_kernel_initializer_kwargs=None, fcnet_bias_initializer=None, fcnet_bias_initializer_kwargs=None, conv_filters=None, conv_activation='relu', conv_kernel_initializer=None, conv_kernel_initializer_kwargs=None, conv_bias_initializer=None, conv_bias_initializer_kwargs=None, head_fcnet_hiddens=[], head_fcnet_activation='relu', head_fcnet_kernel_initializer=None, head_fcnet_kernel_initializer_kwargs=None, head_fcnet_bias_initializer=None, head_fcnet_bias_initializer_kwargs=None, free_log_std=False, log_std_clip_param=20.0, vf_share_layers=True, use_lstm=False, max_seq_len=20, lstm_cell_size=256, lstm_use_prev_action=False, lstm_use_prev_reward=False, lstm_kernel_initializer=None, lstm_kernel_initializer_kwargs=None, lstm_bias_initializer=None, lstm_bias_initializer_kwargs=None), catalog_class=None, load_state_path=None, model_config_dict=None)", "algorithm_config_overrides_per_module": {}, "_per_module_overrides": {}, "_validate_config": true, "_use_msgpack_checkpoints": false, "_torch_grad_scaler_class": null, "_torch_lr_scheduler_classes": null, "_tf_policy_handles_more_than_one_loss": false, "_disable_preprocessor_api": false, "_disable_action_flattening": false, "_disable_initialize_loss_from_dummy_batch": false, "_dont_auto_sync_env_runner_states": false, "env_task_fn": -1, "enable_connectors": -1, "simple_optimizer": false, "policy_map_cache": -1, "worker_cls": -1, "synchronize_filters": -1, "enable_async_evaluation": -1, "custom_async_evaluation_function": -1, "_enable_rl_module_api": -1, "auto_wrap_old_gym_envs": -1, "always_attach_evaluation_results": -1, "replay_sequence_length": null, "_disable_execution_plan_api": -1, "use_critic": true, "use_gae": true, "use_kl_loss": true, "kl_coeff": 0.7464963036515, "kl_target": 0.0270990929592, "vf_loss_coeff": 0.6688075857018, "entropy_coeff": 0.0090570820258, "clip_param": 0.1221781641624, "vf_clip_param": 0.1027808522125, "entropy_coeff_schedule": null, "lr_schedule": null, "sgd_minibatch_size": -1, "vf_share_layers": -1, "__stdout_file__": null, "__stderr_file__": null, "lambda": 0.9099046732075, "input": "sampler", "policies": {"default_policy": [null, null, null, null]}, "callbacks": "<class 'ray.rllib.callbacks.callbacks.RLlibCallback'>", "create_env_on_driver": false, "custom_eval_function": null, "framework": "torch"}, "time_since_restore": 20.284640073776245, "iterations_since_restore": 11, "perf": {"cpu_util_percent": 46.5, "ram_util_percent": 79.43333333333332}}
{"timers": {"training_iteration": 1.8986999774191895, "restore_env_runners": 9.329955170172293e-06, "training_step": 1.8985380736444073, "env_runner_sampling_timer": 1.7737531034498468, "learner_update_timer": 0.12086251412186802, "synch_weights": 0.0010190595701696447, "restore_eval_env_runners": 8.967439398067441e-06, "evaluation_iteration": 0.12481708725838782, "synch_eval_env_connectors": 0.00012865956436923037, "synch_env_connectors": 4.332020889321098e-06}, "env_runners": {"env_reset_timer": 4.536320173427082e-05, "num_env_steps_sampled": 5000.0, "num_agent_steps_sampled_lifetime": {"default_agent": -6165000.0}, "episode_duration_sec_mean": 0.00492804732080549, "time_between_sampling": 0.002034030170534675, "module_to_env_connector": {"timers": {"connectors": {"tensor_to_numpy": 1.4348801994749552e-05, "normalize_and_clip_actions": 1.006789215524603e-05, "listify_data_for_vector_env": 1.1981685042674675e-05, "un_batch_to_individual_items": 5.827695236682595e-06, "get_actions": 4.359157722442202e-05, "remove_single_ts_time_rank_from_batch": 6.208181545478999e-07}}, "connector_pipeline_timer": 0.00011355127648186061}, "sample": 0.005367716162984009, "episode_return_max": 12.5, "num_env_steps_sampled_lifetime": -6165000.0, "agent_episode_returns_mean": {"default_agent": 9.700000000000003}, "env_to_module_connector": {"timers": {"connectors": {"add_states_from_episodes_to_batch": 1.7970356133824958e-06, "add_observations_from_episodes_to_batch": 3.1912821893636388e-06, "numpy_to_tensor": 9.404784020683452e-06, "batch_individual_items": 6.788616146630121e-06, "add_time_dim_to_batch_and_zero_pad": 2.468024124144218e-06}}, "connector_pipeline_timer": 4.6240081812013135e-05}, "episode_len_max": 20, "episode_return_mean": 9.700000000000003, "weights_seq_no": 11.0, "rlmodule_inference_timer": 3.0376591566282622e-05, "env_to_module_sum_episodes_length_in": 10.36823839457432, "env_step_timer": 1.5067626186831249e-05, "num_module_steps_sampled": {"default_policy": 5000.0}, "episode_len_min": 20, "episode_len_mean": 20.0, "num_episodes": 250.0, "episode_return_min": -7.5, "num_module_steps_sampled_lifetime": {"default_policy": -6165000.0}, "module_episode_returns_mean": {"default_policy": 9.700000000000003}, "num_agent_steps_sampled": {"default_agent": 5000.0}, "num_episodes_lifetime": -308250.0, "env_to_module_sum_episodes_length_out": 10.36823839457432, "num_env_steps_sampled_lifetime_throughput": 3420.2517937908538}, "learners": {"default_policy": {"num_module_steps_trained": 6000, "gradients_default_optimizer_global_norm": 0.05857674777507782, "vf_explained_var": 0.01924508810043335, "num_module_steps_trained_lifetime": 72000, "policy_loss": -0.02900618687272072, "num_trainable_parameters": 6003, "entropy": 0.4821460247039795, "weights_seq_no": 12.0, "curr_entropy_coeff": 0.0090570820258, "module_train_batch_size_mean": 1000.0, "total_loss": 0.03486289083957672, "default_optimizer_learning_rate": 0.0002847858517, "vf_loss": 0.1020260602235794, "curr_kl_coeff": 0.00018225007806904614, "mean_kl_loss": 0.00028911055414937437, "vf_loss_unclipped": 28.63893699645996, "diff_num_grad_updates_vs_sampler_policy": 1.0, "num_module_steps_trained_lifetime_throughput": 346074.56842823356}, "__all_modules__": {"num_env_steps_trained_lifetime": 378000, "learner_connector_sum_episodes_length_in": 5000.0, "learner_connector_sum_episodes_length_out": 5250.0, "num_module_steps_trained": 6000, "num_env_steps_trained": 31500, "learner_connector": {"timers": {"connectors": {"add_states_from_episodes_to_batch": 4.0744232003381785e-06, "general_advantage_estimation": 0.008202978138731486, "add_observations_from_episodes_to_batch": 0.0008953572882003814, "add_time_dim_to_batch_and_zero_pad": 1.3488692498189106e-05, "add_one_ts_to_episodes_and_truncate": 0.009941252538229679, "numpy_to_tensor": 7.491085477870126e-05, "batch_individual_items": 0.035390055747581264, "add_columns_from_episodes_to_train_batch": 0.03793604244853623}}, "connector_pipeline_timer": 0.09262104505293407}, "num_module_steps_trained_lifetime": 72000, "num_trainable_parameters": 6003, "num_non_trainable_parameters": 0, "num_env_steps_trained_lifetime_throughput": 1781599.3785367997, "num_module_steps_trained_throughput": 341020.08328976185, "num_module_steps_trained_lifetime_throughput": 340070.7147957601}}, "num_training_step_calls_per_iteration": 1, "evaluation": {"env_runners": {"agent_episode_returns_mean": {"default_agent": 1.75}, "env_to_module_connector": {"timers": {"connectors": {"numpy_to_tensor": 8.35139847218366e-06, "batch_individual_items": 6.154239223403388e-06, "add_observations_from_episodes_to_batch": 2.7844684079279196e-06, "add_time_dim_to_batch_and_zero_pad": 2.2722539378196555e-06, "add_states_from_episodes_to_batch": 1.5625786935640517e-06}}, "connector_pipeline_timer": 4.2550725826347373e-05}, "module_to_env_connector": {"timers": {"connectors": {"get_actions": 3.594132137850624e-05, "tensor_to_numpy": 1.283758335629133e-05, "normalize_and_clip_actions": 9.41799431706291e-06, "remove_single_ts_time_rank_from_batch": 6.373543921007573e-07, "un_batch_to_individual_items": 5.3697235019297915e-06, "listify_data_for_vector_env": 1.075977816981282e-05}}, "connector_pipeline_timer": 0.00010059548848078378}, "episode_len_max": 20, "env_step_timer": 1.3927527516332815e-05, "episode_len_min": 20, "episode_return_min": -16.5, "num_episodes_lifetime": 240, "num_module_steps_sampled_lifetime": {"default_policy": 4800}, "sample": 0.11635606842385093, "rlmodule_inference_timer": 2.7539856688473367e-05, "env_to_module_sum_episodes_length_in": 10.368238394574323, "module_episode_returns_mean": {"default_policy": 1.75}, "env_reset_timer": 0.0002544257535829302, "num_agent_steps_sampled_lifetime": {"default_agent": 4800}, "weights_seq_no": 12.0, "num_module_steps_sampled": {"default_policy": 400}, "episode_len_mean": 20.0, "num_env_steps_sampled": 400, "episode_duration_sec_mean": 0.0047538986592553555, "episode_return_max": 12.5, "episode_return_mean": 1.75, "env_to_module_sum_episodes_length_out": 10.368238394574323, "num_episodes": 20, "num_agent_steps_sampled": {"default_agent": 400}, "num_env_steps_sampled_lifetime": 60400, "time_between_sampling": 1.8281951258497793}, "num_healthy_workers": 1, "actor_manager_num_outstanding_async_reqs": 0, "num_remote_worker_restarts": 0}, "num_env_steps_sampled_lifetime": -6165000.0, "fault_tolerance": {"num_healthy_workers": 0, "num_remote_worker_restarts": 0}, "env_runner_group": {"actor_manager_num_outstanding_async_reqs": 0}, "done": false, "training_iteration": 12, "trial_id": "4dd64_00000", "date": "2025-08-11_19-22-38", "timestamp": 1754932958, "time_this_iter_s": 1.7827200889587402, "time_total_s": 22.067360162734985, "pid": 14353, "hostname": "Mac", "node_ip": "127.0.0.1", "config": {"exploration_config": {}, "extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "placement_strategy": "PACK", "num_gpus": 0, "_fake_gpus": false, "num_cpus_for_main_process": 2, "eager_tracing": true, "eager_max_retraces": 20, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "torch_compile_learner": false, "torch_compile_learner_what_to_compile": "forward_train", "torch_compile_learner_dynamo_backend": "aot_eager", "torch_compile_learner_dynamo_mode": null, "torch_compile_worker": false, "torch_compile_worker_dynamo_backend": "aot_eager", "torch_compile_worker_dynamo_mode": null, "torch_ddp_kwargs": {}, "torch_skip_nan_gradients": false, "env": "Umbrella", "env_config": {}, "observation_space": null, "action_space": null, "clip_rewards": null, "normalize_actions": true, "clip_actions": false, "_is_atari": null, "disable_env_checking": false, "render_env": false, "action_mask_key": "action_mask", "env_runner_cls": null, "num_env_runners": 0, "create_local_env_runner": true, "num_envs_per_env_runner": 1, "gym_env_vectorize_mode": "SYNC", "num_cpus_per_env_runner": 1, "num_gpus_per_env_runner": 0, "custom_resources_per_env_runner": {}, "validate_env_runners_after_construction": true, "episodes_to_numpy": true, "max_requests_in_flight_per_env_runner": 1, "sample_timeout_s": 60.0, "_env_to_module_connector": null, "add_default_connectors_to_env_to_module_pipeline": true, "_module_to_env_connector": null, "add_default_connectors_to_module_to_env_pipeline": true, "merge_env_runner_states": "training_only", "broadcast_env_runner_states": true, "episode_lookback_horizon": 1, "rollout_fragment_length": "auto", "batch_mode": "complete_episodes", "compress_observations": false, "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "enable_tf1_exec_eagerly": false, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "preprocessor_pref": "deepmind", "observation_filter": "NoFilter", "update_worker_filter_stats": true, "use_worker_filter_stats": true, "sampler_perf_stats_ema_coef": null, "_is_online": true, "num_learners": 0, "num_gpus_per_learner": 0, "num_cpus_per_learner": "auto", "num_aggregator_actors_per_learner": 0, "max_requests_in_flight_per_aggregator_actor": 3, "local_gpu_idx": 0, "max_requests_in_flight_per_learner": 3, "gamma": 1, "lr": 0.0002847858517, "grad_clip": 0.5, "grad_clip_by": "global_norm", "_train_batch_size_per_learner": 5000, "train_batch_size": 4000, "num_epochs": 1, "minibatch_size": 1000, "shuffle_batch_per_epoch": true, "model": {"fcnet_hiddens": [256, 256], "fcnet_activation": "tanh", "fcnet_weights_initializer": null, "fcnet_weights_initializer_config": null, "fcnet_bias_initializer": null, "fcnet_bias_initializer_config": null, "conv_filters": null, "conv_activation": "relu", "conv_kernel_initializer": null, "conv_kernel_initializer_config": null, "conv_bias_initializer": null, "conv_bias_initializer_config": null, "conv_transpose_kernel_initializer": null, "conv_transpose_kernel_initializer_config": null, "conv_transpose_bias_initializer": null, "conv_transpose_bias_initializer_config": null, "post_fcnet_hiddens": [], "post_fcnet_activation": "relu", "post_fcnet_weights_initializer": null, "post_fcnet_weights_initializer_config": null, "post_fcnet_bias_initializer": null, "post_fcnet_bias_initializer_config": null, "free_log_std": false, "log_std_clip_param": 20.0, "no_final_linear": false, "vf_share_layers": false, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "lstm_weights_initializer": null, "lstm_weights_initializer_config": null, "lstm_bias_initializer": null, "lstm_bias_initializer_config": null, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "attention_use_n_prev_actions": 0, "attention_use_n_prev_rewards": 0, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": null, "custom_model_config": {}, "custom_action_dist": null, "custom_preprocessor": null, "encoder_latent_dim": null, "always_check_shapes": false, "lstm_use_prev_action_reward": -1, "_use_default_native_models": -1, "_disable_preprocessor_api": false, "_disable_action_flattening": false}, "_learner_connector": null, "add_default_connectors_to_learner_pipeline": true, "learner_config_dict": {}, "optimizer": {}, "_learner_class": null, "callbacks_on_algorithm_init": null, "callbacks_on_env_runners_recreated": null, "callbacks_on_offline_eval_runners_recreated": null, "callbacks_on_checkpoint_loaded": null, "callbacks_on_environment_created": null, "callbacks_on_episode_created": null, "callbacks_on_episode_start": null, "callbacks_on_episode_step": null, "callbacks_on_episode_end": null, "callbacks_on_evaluate_start": null, "callbacks_on_evaluate_end": null, "callbacks_on_evaluate_offline_start": null, "callbacks_on_evaluate_offline_end": null, "callbacks_on_sample_end": null, "callbacks_on_train_result": null, "explore": true, "enable_rl_module_and_learner": true, "enable_env_runner_and_connector_v2": true, "_prior_exploration_config": {"type": "StochasticSampling"}, "count_steps_by": "env_steps", "policy_map_capacity": 100, "policy_mapping_fn": "<function AlgorithmConfig.DEFAULT_POLICY_MAPPING_FN at 0x3834118a0>", "policies_to_train": null, "policy_states_are_swappable": false, "observation_fn": null, "offline_data_class": null, "input_read_method": "read_parquet", "input_read_method_kwargs": {}, "input_read_schema": {}, "input_read_episodes": false, "input_read_sample_batches": false, "input_read_batch_size": null, "input_filesystem": null, "input_filesystem_kwargs": {}, "input_compress_columns": ["obs", "new_obs"], "input_spaces_jsonable": true, "materialize_data": false, "materialize_mapped_data": true, "map_batches_kwargs": {}, "iter_batches_kwargs": {}, "ignore_final_observation": false, "prelearner_class": null, "prelearner_buffer_class": null, "prelearner_buffer_kwargs": {}, "prelearner_module_synch_period": 10, "dataset_num_iters_per_learner": null, "input_config": {}, "actions_in_input_normalized": false, "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_config": {}, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "output_max_rows_per_file": null, "output_write_remaining_data": false, "output_write_method": "write_parquet", "output_write_method_kwargs": {}, "output_filesystem": null, "output_filesystem_kwargs": {}, "output_write_episodes": true, "offline_sampling": false, "evaluation_interval": 1, "evaluation_duration": 20, "evaluation_duration_unit": "episodes", "evaluation_sample_timeout_s": 120.0, "evaluation_auto_duration_min_env_steps_per_sample": 100, "evaluation_auto_duration_max_env_steps_per_sample": 2000, "evaluation_parallel_to_training": false, "evaluation_force_reset_envs_before_iteration": true, "evaluation_config": null, "off_policy_estimation_methods": {}, "ope_split_batch_by_episode": true, "evaluation_num_env_runners": 1, "in_evaluation": false, "sync_filters_on_rollout_workers_timeout_s": 10.0, "offline_evaluation_interval": null, "num_offline_eval_runners": 0, "offline_loss_for_module_fn": null, "offline_evaluation_duration": 1, "offline_evaluation_parallel_to_training": false, "offline_evaluation_timeout_s": 120.0, "num_cpus_per_offline_eval_runner": 1, "num_gpus_per_offline_eval_runner": 0, "custom_resources_per_offline_eval_runner": {}, "restart_failed_offline_eval_runners": true, "ignore_offline_eval_runner_failures": false, "max_num_offline_eval_runner_restarts": 1000, "offline_eval_runner_restore_timeout_s": 1800.0, "max_requests_in_flight_per_offline_eval_runner": 1, "validate_offline_eval_runners_after_construction": true, "offline_eval_runner_health_probe_timeout_s": 30.0, "offline_eval_rl_module_inference_only": false, "broadcast_offline_eval_runner_states": false, "offline_eval_batch_size_per_runner": 256, "dataset_num_iters_per_eval_runner": 1, "keep_per_episode_custom_metrics": false, "metrics_episode_collection_timeout_s": 60.0, "metrics_num_episodes_for_smoothing": 100, "min_time_s_per_iteration": null, "min_train_timesteps_per_iteration": 0, "min_sample_timesteps_per_iteration": 0, "log_gradients": true, "export_native_model_files": false, "checkpoint_trainable_policies_only": false, "logger_creator": null, "logger_config": null, "log_level": "WARN", "log_sys_usage": true, "fake_sampler": false, "seed": 4, "restart_failed_env_runners": true, "ignore_env_runner_failures": false, "max_num_env_runner_restarts": 1000, "delay_between_env_runner_restarts_s": 60.0, "restart_failed_sub_environments": false, "num_consecutive_env_runner_failures_tolerance": 100, "env_runner_health_probe_timeout_s": 30.0, "env_runner_restore_timeout_s": 1800.0, "_model_config": {}, "_rl_module_spec": "RLModuleSpec(module_class=None, observation_space=None, action_space=None, inference_only=False, learner_only=False, model_config=DefaultModelConfig(fcnet_hiddens=[60, 90], fcnet_activation='tanh', fcnet_kernel_initializer=None, fcnet_kernel_initializer_kwargs=None, fcnet_bias_initializer=None, fcnet_bias_initializer_kwargs=None, conv_filters=None, conv_activation='relu', conv_kernel_initializer=None, conv_kernel_initializer_kwargs=None, conv_bias_initializer=None, conv_bias_initializer_kwargs=None, head_fcnet_hiddens=[], head_fcnet_activation='relu', head_fcnet_kernel_initializer=None, head_fcnet_kernel_initializer_kwargs=None, head_fcnet_bias_initializer=None, head_fcnet_bias_initializer_kwargs=None, free_log_std=False, log_std_clip_param=20.0, vf_share_layers=True, use_lstm=False, max_seq_len=20, lstm_cell_size=256, lstm_use_prev_action=False, lstm_use_prev_reward=False, lstm_kernel_initializer=None, lstm_kernel_initializer_kwargs=None, lstm_bias_initializer=None, lstm_bias_initializer_kwargs=None), catalog_class=None, load_state_path=None, model_config_dict=None)", "algorithm_config_overrides_per_module": {}, "_per_module_overrides": {}, "_validate_config": true, "_use_msgpack_checkpoints": false, "_torch_grad_scaler_class": null, "_torch_lr_scheduler_classes": null, "_tf_policy_handles_more_than_one_loss": false, "_disable_preprocessor_api": false, "_disable_action_flattening": false, "_disable_initialize_loss_from_dummy_batch": false, "_dont_auto_sync_env_runner_states": false, "env_task_fn": -1, "enable_connectors": -1, "simple_optimizer": false, "policy_map_cache": -1, "worker_cls": -1, "synchronize_filters": -1, "enable_async_evaluation": -1, "custom_async_evaluation_function": -1, "_enable_rl_module_api": -1, "auto_wrap_old_gym_envs": -1, "always_attach_evaluation_results": -1, "replay_sequence_length": null, "_disable_execution_plan_api": -1, "use_critic": true, "use_gae": true, "use_kl_loss": true, "kl_coeff": 0.7464963036515, "kl_target": 0.0270990929592, "vf_loss_coeff": 0.6688075857018, "entropy_coeff": 0.0090570820258, "clip_param": 0.1221781641624, "vf_clip_param": 0.1027808522125, "entropy_coeff_schedule": null, "lr_schedule": null, "sgd_minibatch_size": -1, "vf_share_layers": -1, "__stdout_file__": null, "__stderr_file__": null, "lambda": 0.9099046732075, "input": "sampler", "policies": {"default_policy": [null, null, null, null]}, "callbacks": "<class 'ray.rllib.callbacks.callbacks.RLlibCallback'>", "create_env_on_driver": false, "custom_eval_function": null, "framework": "torch"}, "time_since_restore": 22.067360162734985, "iterations_since_restore": 12, "perf": {"cpu_util_percent": 47.849999999999994, "ram_util_percent": 80.75}}
{"timers": {"training_iteration": 1.8952685847242932, "restore_env_runners": 9.304155550372263e-06, "training_step": 1.895106339158591, "env_runner_sampling_timer": 1.770620946585117, "learner_update_timer": 0.12057012440080375, "synch_weights": 0.0010141514745282234, "restore_eval_env_runners": 8.939845802757417e-06, "evaluation_iteration": 0.1245972272262877, "synch_eval_env_connectors": 0.00012837921852958782, "synch_env_connectors": 4.3316206812790416e-06}, "env_runners": {"env_reset_timer": 3.541717092196253e-05, "num_env_steps_sampled": 5000.0, "num_agent_steps_sampled_lifetime": {"default_agent": -6782500.0}, "episode_duration_sec_mean": 0.004521732992026955, "time_between_sampling": 0.0017071970025701458, "module_to_env_connector": {"timers": {"connectors": {"tensor_to_numpy": 1.3128111397620063e-05, "normalize_and_clip_actions": 9.380010023443484e-06, "listify_data_for_vector_env": 1.1015885704839254e-05, "un_batch_to_individual_items": 5.3877679480499755e-06, "get_actions": 3.844261592006779e-05, "remove_single_ts_time_rank_from_batch": 5.841781329288529e-07}}, "connector_pipeline_timer": 0.0001033750010969202}, "sample": 0.004923711094820568, "episode_return_max": 12.5, "num_env_steps_sampled_lifetime": -6782500.0, "agent_episode_returns_mean": {"default_agent": 9.700000000000003}, "env_to_module_connector": {"timers": {"connectors": {"add_states_from_episodes_to_batch": 1.7185001131942954e-06, "add_observations_from_episodes_to_batch": 2.9121025265335754e-06, "numpy_to_tensor": 8.557700270540846e-06, "batch_individual_items": 6.213098636288702e-06, "add_time_dim_to_batch_and_zero_pad": 2.31832271917743e-06}}, "connector_pipeline_timer": 4.3220315357871445e-05}, "episode_len_max": 20, "episode_return_mean": 9.700000000000003, "weights_seq_no": 12.0, "rlmodule_inference_timer": 2.7319396762462447e-05, "env_to_module_sum_episodes_length_in": 10.36823839457432, "env_step_timer": 1.3623904306532958e-05, "num_module_steps_sampled": {"default_policy": 5000.0}, "episode_len_min": 20, "episode_len_mean": 20.0, "num_episodes": 250.0, "episode_return_min": -7.5, "num_module_steps_sampled_lifetime": {"default_policy": -6782500.0}, "module_episode_returns_mean": {"default_policy": 9.700000000000003}, "num_agent_steps_sampled": {"default_agent": 5000.0}, "num_episodes_lifetime": -339125.0, "env_to_module_sum_episodes_length_out": 10.36823839457432, "num_env_steps_sampled_lifetime_throughput": 3733.6284126695823}, "learners": {"default_policy": {"num_module_steps_trained": 6000, "gradients_default_optimizer_global_norm": 0.049361228942871094, "vf_explained_var": 0.019546985626220703, "num_module_steps_trained_lifetime": 78000, "policy_loss": -0.030638419091701508, "num_trainable_parameters": 6003, "entropy": 0.45641592144966125, "weights_seq_no": 13.0, "curr_entropy_coeff": 0.0090570820258, "module_train_batch_size_mean": 1000.0, "total_loss": 0.03346370533108711, "default_optimizer_learning_rate": 0.0002847858517, "vf_loss": 0.10202598571777344, "curr_kl_coeff": 9.112503903452307e-05, "mean_kl_loss": 0.0008334144367836416, "vf_loss_unclipped": 28.627490997314453, "diff_num_grad_updates_vs_sampler_policy": 1.0, "num_module_steps_trained_lifetime_throughput": 349045.04831110075}, "__all_modules__": {"num_env_steps_trained_lifetime": 409500, "learner_connector_sum_episodes_length_in": 5000.0, "learner_connector_sum_episodes_length_out": 5250.0, "num_module_steps_trained": 6000, "num_env_steps_trained": 31500, "learner_connector": {"timers": {"connectors": {"add_states_from_episodes_to_batch": 4.0582693767643e-06, "general_advantage_estimation": 0.008174602527240789, "add_observations_from_episodes_to_batch": 0.0008946616361721712, "add_time_dim_to_batch_and_zero_pad": 1.3439225315597729e-05, "add_one_ts_to_episodes_and_truncate": 0.00991786043337633, "numpy_to_tensor": 7.463466601353789e-05, "batch_individual_items": 0.03533696352017195, "add_columns_from_episodes_to_train_batch": 0.037900999523599065}}, "connector_pipeline_timer": 0.09247929835213754}, "num_module_steps_trained_lifetime": 78000, "num_trainable_parameters": 6003, "num_non_trainable_parameters": 0, "num_env_steps_trained_lifetime_throughput": 1799018.6424665593, "num_module_steps_trained_throughput": 344268.4902761838, "num_module_steps_trained_lifetime_throughput": 343356.733315306}}, "num_training_step_calls_per_iteration": 1, "evaluation": {"env_runners": {"agent_episode_returns_mean": {"default_agent": 1.75}, "env_to_module_connector": {"timers": {"connectors": {"numpy_to_tensor": 8.008919784153728e-06, "batch_individual_items": 6.027019111946937e-06, "add_observations_from_episodes_to_batch": 2.7485530814548056e-06, "add_time_dim_to_batch_and_zero_pad": 2.1742597710620333e-06, "add_states_from_episodes_to_batch": 1.534683120270899e-06}}, "connector_pipeline_timer": 4.169878305513733e-05}, "module_to_env_connector": {"timers": {"connectors": {"get_actions": 3.392900374579769e-05, "tensor_to_numpy": 1.231142998934027e-05, "normalize_and_clip_actions": 9.147762993265901e-06, "remove_single_ts_time_rank_from_batch": 6.113811948461673e-07, "un_batch_to_individual_items": 5.24155830797061e-06, "listify_data_for_vector_env": 1.0482489280094168e-05}}, "connector_pipeline_timer": 9.671016438874157e-05}, "episode_len_max": 20, "env_step_timer": 1.3309802667047009e-05, "episode_len_min": 20, "episode_return_min": -16.5, "num_episodes_lifetime": 260, "num_module_steps_sampled_lifetime": {"default_policy": 5200}, "sample": 0.11613798606928025, "rlmodule_inference_timer": 2.6138836083957753e-05, "env_to_module_sum_episodes_length_in": 10.368238394574323, "module_episode_returns_mean": {"default_policy": 1.75}, "env_reset_timer": 0.0002526227461616163, "num_agent_steps_sampled_lifetime": {"default_agent": 5200}, "weights_seq_no": 13.0, "num_module_steps_sampled": {"default_policy": 400}, "episode_len_mean": 20.0, "num_env_steps_sampled": 400, "episode_duration_sec_mean": 0.004676953264279291, "episode_return_max": 12.5, "episode_return_mean": 1.75, "env_to_module_sum_episodes_length_out": 10.368238394574323, "num_episodes": 20, "num_agent_steps_sampled": {"default_agent": 400}, "num_env_steps_sampled_lifetime": 65400, "time_between_sampling": 1.825648569591365}, "num_healthy_workers": 1, "actor_manager_num_outstanding_async_reqs": 0, "num_remote_worker_restarts": 0}, "num_env_steps_sampled_lifetime": -6782500.0, "fault_tolerance": {"num_healthy_workers": 0, "num_remote_worker_restarts": 0}, "env_runner_group": {"actor_manager_num_outstanding_async_reqs": 0}, "done": false, "training_iteration": 13, "trial_id": "4dd64_00000", "date": "2025-08-11_19-22-40", "timestamp": 1754932960, "time_this_iter_s": 1.657275915145874, "time_total_s": 23.72463607788086, "pid": 14353, "hostname": "Mac", "node_ip": "127.0.0.1", "config": {"exploration_config": {}, "extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "placement_strategy": "PACK", "num_gpus": 0, "_fake_gpus": false, "num_cpus_for_main_process": 2, "eager_tracing": true, "eager_max_retraces": 20, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "torch_compile_learner": false, "torch_compile_learner_what_to_compile": "forward_train", "torch_compile_learner_dynamo_backend": "aot_eager", "torch_compile_learner_dynamo_mode": null, "torch_compile_worker": false, "torch_compile_worker_dynamo_backend": "aot_eager", "torch_compile_worker_dynamo_mode": null, "torch_ddp_kwargs": {}, "torch_skip_nan_gradients": false, "env": "Umbrella", "env_config": {}, "observation_space": null, "action_space": null, "clip_rewards": null, "normalize_actions": true, "clip_actions": false, "_is_atari": null, "disable_env_checking": false, "render_env": false, "action_mask_key": "action_mask", "env_runner_cls": null, "num_env_runners": 0, "create_local_env_runner": true, "num_envs_per_env_runner": 1, "gym_env_vectorize_mode": "SYNC", "num_cpus_per_env_runner": 1, "num_gpus_per_env_runner": 0, "custom_resources_per_env_runner": {}, "validate_env_runners_after_construction": true, "episodes_to_numpy": true, "max_requests_in_flight_per_env_runner": 1, "sample_timeout_s": 60.0, "_env_to_module_connector": null, "add_default_connectors_to_env_to_module_pipeline": true, "_module_to_env_connector": null, "add_default_connectors_to_module_to_env_pipeline": true, "merge_env_runner_states": "training_only", "broadcast_env_runner_states": true, "episode_lookback_horizon": 1, "rollout_fragment_length": "auto", "batch_mode": "complete_episodes", "compress_observations": false, "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "enable_tf1_exec_eagerly": false, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "preprocessor_pref": "deepmind", "observation_filter": "NoFilter", "update_worker_filter_stats": true, "use_worker_filter_stats": true, "sampler_perf_stats_ema_coef": null, "_is_online": true, "num_learners": 0, "num_gpus_per_learner": 0, "num_cpus_per_learner": "auto", "num_aggregator_actors_per_learner": 0, "max_requests_in_flight_per_aggregator_actor": 3, "local_gpu_idx": 0, "max_requests_in_flight_per_learner": 3, "gamma": 1, "lr": 0.0002847858517, "grad_clip": 0.5, "grad_clip_by": "global_norm", "_train_batch_size_per_learner": 5000, "train_batch_size": 4000, "num_epochs": 1, "minibatch_size": 1000, "shuffle_batch_per_epoch": true, "model": {"fcnet_hiddens": [256, 256], "fcnet_activation": "tanh", "fcnet_weights_initializer": null, "fcnet_weights_initializer_config": null, "fcnet_bias_initializer": null, "fcnet_bias_initializer_config": null, "conv_filters": null, "conv_activation": "relu", "conv_kernel_initializer": null, "conv_kernel_initializer_config": null, "conv_bias_initializer": null, "conv_bias_initializer_config": null, "conv_transpose_kernel_initializer": null, "conv_transpose_kernel_initializer_config": null, "conv_transpose_bias_initializer": null, "conv_transpose_bias_initializer_config": null, "post_fcnet_hiddens": [], "post_fcnet_activation": "relu", "post_fcnet_weights_initializer": null, "post_fcnet_weights_initializer_config": null, "post_fcnet_bias_initializer": null, "post_fcnet_bias_initializer_config": null, "free_log_std": false, "log_std_clip_param": 20.0, "no_final_linear": false, "vf_share_layers": false, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "lstm_weights_initializer": null, "lstm_weights_initializer_config": null, "lstm_bias_initializer": null, "lstm_bias_initializer_config": null, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "attention_use_n_prev_actions": 0, "attention_use_n_prev_rewards": 0, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": null, "custom_model_config": {}, "custom_action_dist": null, "custom_preprocessor": null, "encoder_latent_dim": null, "always_check_shapes": false, "lstm_use_prev_action_reward": -1, "_use_default_native_models": -1, "_disable_preprocessor_api": false, "_disable_action_flattening": false}, "_learner_connector": null, "add_default_connectors_to_learner_pipeline": true, "learner_config_dict": {}, "optimizer": {}, "_learner_class": null, "callbacks_on_algorithm_init": null, "callbacks_on_env_runners_recreated": null, "callbacks_on_offline_eval_runners_recreated": null, "callbacks_on_checkpoint_loaded": null, "callbacks_on_environment_created": null, "callbacks_on_episode_created": null, "callbacks_on_episode_start": null, "callbacks_on_episode_step": null, "callbacks_on_episode_end": null, "callbacks_on_evaluate_start": null, "callbacks_on_evaluate_end": null, "callbacks_on_evaluate_offline_start": null, "callbacks_on_evaluate_offline_end": null, "callbacks_on_sample_end": null, "callbacks_on_train_result": null, "explore": true, "enable_rl_module_and_learner": true, "enable_env_runner_and_connector_v2": true, "_prior_exploration_config": {"type": "StochasticSampling"}, "count_steps_by": "env_steps", "policy_map_capacity": 100, "policy_mapping_fn": "<function AlgorithmConfig.DEFAULT_POLICY_MAPPING_FN at 0x3834118a0>", "policies_to_train": null, "policy_states_are_swappable": false, "observation_fn": null, "offline_data_class": null, "input_read_method": "read_parquet", "input_read_method_kwargs": {}, "input_read_schema": {}, "input_read_episodes": false, "input_read_sample_batches": false, "input_read_batch_size": null, "input_filesystem": null, "input_filesystem_kwargs": {}, "input_compress_columns": ["obs", "new_obs"], "input_spaces_jsonable": true, "materialize_data": false, "materialize_mapped_data": true, "map_batches_kwargs": {}, "iter_batches_kwargs": {}, "ignore_final_observation": false, "prelearner_class": null, "prelearner_buffer_class": null, "prelearner_buffer_kwargs": {}, "prelearner_module_synch_period": 10, "dataset_num_iters_per_learner": null, "input_config": {}, "actions_in_input_normalized": false, "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_config": {}, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "output_max_rows_per_file": null, "output_write_remaining_data": false, "output_write_method": "write_parquet", "output_write_method_kwargs": {}, "output_filesystem": null, "output_filesystem_kwargs": {}, "output_write_episodes": true, "offline_sampling": false, "evaluation_interval": 1, "evaluation_duration": 20, "evaluation_duration_unit": "episodes", "evaluation_sample_timeout_s": 120.0, "evaluation_auto_duration_min_env_steps_per_sample": 100, "evaluation_auto_duration_max_env_steps_per_sample": 2000, "evaluation_parallel_to_training": false, "evaluation_force_reset_envs_before_iteration": true, "evaluation_config": null, "off_policy_estimation_methods": {}, "ope_split_batch_by_episode": true, "evaluation_num_env_runners": 1, "in_evaluation": false, "sync_filters_on_rollout_workers_timeout_s": 10.0, "offline_evaluation_interval": null, "num_offline_eval_runners": 0, "offline_loss_for_module_fn": null, "offline_evaluation_duration": 1, "offline_evaluation_parallel_to_training": false, "offline_evaluation_timeout_s": 120.0, "num_cpus_per_offline_eval_runner": 1, "num_gpus_per_offline_eval_runner": 0, "custom_resources_per_offline_eval_runner": {}, "restart_failed_offline_eval_runners": true, "ignore_offline_eval_runner_failures": false, "max_num_offline_eval_runner_restarts": 1000, "offline_eval_runner_restore_timeout_s": 1800.0, "max_requests_in_flight_per_offline_eval_runner": 1, "validate_offline_eval_runners_after_construction": true, "offline_eval_runner_health_probe_timeout_s": 30.0, "offline_eval_rl_module_inference_only": false, "broadcast_offline_eval_runner_states": false, "offline_eval_batch_size_per_runner": 256, "dataset_num_iters_per_eval_runner": 1, "keep_per_episode_custom_metrics": false, "metrics_episode_collection_timeout_s": 60.0, "metrics_num_episodes_for_smoothing": 100, "min_time_s_per_iteration": null, "min_train_timesteps_per_iteration": 0, "min_sample_timesteps_per_iteration": 0, "log_gradients": true, "export_native_model_files": false, "checkpoint_trainable_policies_only": false, "logger_creator": null, "logger_config": null, "log_level": "WARN", "log_sys_usage": true, "fake_sampler": false, "seed": 4, "restart_failed_env_runners": true, "ignore_env_runner_failures": false, "max_num_env_runner_restarts": 1000, "delay_between_env_runner_restarts_s": 60.0, "restart_failed_sub_environments": false, "num_consecutive_env_runner_failures_tolerance": 100, "env_runner_health_probe_timeout_s": 30.0, "env_runner_restore_timeout_s": 1800.0, "_model_config": {}, "_rl_module_spec": "RLModuleSpec(module_class=None, observation_space=None, action_space=None, inference_only=False, learner_only=False, model_config=DefaultModelConfig(fcnet_hiddens=[60, 90], fcnet_activation='tanh', fcnet_kernel_initializer=None, fcnet_kernel_initializer_kwargs=None, fcnet_bias_initializer=None, fcnet_bias_initializer_kwargs=None, conv_filters=None, conv_activation='relu', conv_kernel_initializer=None, conv_kernel_initializer_kwargs=None, conv_bias_initializer=None, conv_bias_initializer_kwargs=None, head_fcnet_hiddens=[], head_fcnet_activation='relu', head_fcnet_kernel_initializer=None, head_fcnet_kernel_initializer_kwargs=None, head_fcnet_bias_initializer=None, head_fcnet_bias_initializer_kwargs=None, free_log_std=False, log_std_clip_param=20.0, vf_share_layers=True, use_lstm=False, max_seq_len=20, lstm_cell_size=256, lstm_use_prev_action=False, lstm_use_prev_reward=False, lstm_kernel_initializer=None, lstm_kernel_initializer_kwargs=None, lstm_bias_initializer=None, lstm_bias_initializer_kwargs=None), catalog_class=None, load_state_path=None, model_config_dict=None)", "algorithm_config_overrides_per_module": {}, "_per_module_overrides": {}, "_validate_config": true, "_use_msgpack_checkpoints": false, "_torch_grad_scaler_class": null, "_torch_lr_scheduler_classes": null, "_tf_policy_handles_more_than_one_loss": false, "_disable_preprocessor_api": false, "_disable_action_flattening": false, "_disable_initialize_loss_from_dummy_batch": false, "_dont_auto_sync_env_runner_states": false, "env_task_fn": -1, "enable_connectors": -1, "simple_optimizer": false, "policy_map_cache": -1, "worker_cls": -1, "synchronize_filters": -1, "enable_async_evaluation": -1, "custom_async_evaluation_function": -1, "_enable_rl_module_api": -1, "auto_wrap_old_gym_envs": -1, "always_attach_evaluation_results": -1, "replay_sequence_length": null, "_disable_execution_plan_api": -1, "use_critic": true, "use_gae": true, "use_kl_loss": true, "kl_coeff": 0.7464963036515, "kl_target": 0.0270990929592, "vf_loss_coeff": 0.6688075857018, "entropy_coeff": 0.0090570820258, "clip_param": 0.1221781641624, "vf_clip_param": 0.1027808522125, "entropy_coeff_schedule": null, "lr_schedule": null, "sgd_minibatch_size": -1, "vf_share_layers": -1, "__stdout_file__": null, "__stderr_file__": null, "lambda": 0.9099046732075, "input": "sampler", "policies": {"default_policy": [null, null, null, null]}, "callbacks": "<class 'ray.rllib.callbacks.callbacks.RLlibCallback'>", "create_env_on_driver": false, "custom_eval_function": null, "framework": "torch"}, "time_since_restore": 23.72463607788086, "iterations_since_restore": 13, "perf": {"cpu_util_percent": 39.25, "ram_util_percent": 79.3}}
{"timers": {"training_iteration": 1.891828796796448, "restore_env_runners": 9.2686138506253e-06, "training_step": 1.8916665841073608, "env_runner_sampling_timer": 1.7666139929482445, "learner_update_timer": 0.12114513648658587, "synch_weights": 0.001009386210266037, "restore_eval_env_runners": 8.9096165962016e-06, "evaluation_iteration": 0.12434488370388155, "synch_eval_env_connectors": 0.00012808709629343604, "synch_env_connectors": 4.3258041779331435e-06}, "env_runners": {"env_reset_timer": 3.307308097787798e-05, "num_env_steps_sampled": 5000.0, "num_agent_steps_sampled_lifetime": {"default_agent": -7400000.0}, "episode_duration_sec_mean": 0.004524282125756144, "time_between_sampling": 0.0016683327652079738, "module_to_env_connector": {"timers": {"connectors": {"tensor_to_numpy": 1.3179109002374256e-05, "normalize_and_clip_actions": 9.321462102755949e-06, "listify_data_for_vector_env": 1.1008331484810675e-05, "un_batch_to_individual_items": 5.357053527999134e-06, "get_actions": 3.85031901249357e-05, "remove_single_ts_time_rank_from_batch": 5.786819149331101e-07}}, "connector_pipeline_timer": 0.0001033055397813129}, "sample": 0.0048356755137606445, "episode_return_max": 12.5, "num_env_steps_sampled_lifetime": -7400000.0, "agent_episode_returns_mean": {"default_agent": 10.42}, "env_to_module_connector": {"timers": {"connectors": {"add_states_from_episodes_to_batch": 1.7103030934956744e-06, "add_observations_from_episodes_to_batch": 2.8938011763689868e-06, "numpy_to_tensor": 8.559285265134265e-06, "batch_individual_items": 6.199893289166534e-06, "add_time_dim_to_batch_and_zero_pad": 2.3048329708131604e-06}}, "connector_pipeline_timer": 4.3081332383828966e-05}, "episode_len_max": 20, "episode_return_mean": 10.42, "weights_seq_no": 13.0, "rlmodule_inference_timer": 2.7833075672841954e-05, "env_to_module_sum_episodes_length_in": 10.36823839457432, "env_step_timer": 1.3577562417147277e-05, "num_module_steps_sampled": {"default_policy": 5000.0}, "episode_len_min": 20, "episode_len_mean": 20.0, "num_episodes": 250.0, "episode_return_min": -7.5, "num_module_steps_sampled_lifetime": {"default_policy": -7400000.0}, "module_episode_returns_mean": {"default_policy": 10.42}, "num_agent_steps_sampled": {"default_agent": 5000.0}, "num_episodes_lifetime": -370000.0, "env_to_module_sum_episodes_length_out": 10.36823839457432, "num_env_steps_sampled_lifetime_throughput": 3751.6905145503115}, "learners": {"default_policy": {"num_module_steps_trained": 6000, "gradients_default_optimizer_global_norm": 0.06715603172779083, "vf_explained_var": 0.01694488525390625, "num_module_steps_trained_lifetime": 84000, "policy_loss": -0.10505218803882599, "num_trainable_parameters": 6003, "entropy": 0.42842739820480347, "weights_seq_no": 14.0, "curr_entropy_coeff": 0.0090570820258, "module_train_batch_size_mean": 1000.0, "total_loss": -0.04048038646578789, "default_optimizer_learning_rate": 0.0002847858517, "vf_loss": 0.10234943777322769, "curr_kl_coeff": 4.5562519517261535e-05, "mean_kl_loss": 0.0003316231013741344, "vf_loss_unclipped": 28.65528678894043, "diff_num_grad_updates_vs_sampler_policy": 1.0, "num_module_steps_trained_lifetime_throughput": 352694.936375636}, "__all_modules__": {"num_env_steps_trained_lifetime": 441000, "learner_connector_sum_episodes_length_in": 5000.0, "learner_connector_sum_episodes_length_out": 5250.0, "num_module_steps_trained": 6000, "num_env_steps_trained": 31500, "learner_connector": {"timers": {"connectors": {"add_states_from_episodes_to_batch": 4.041016313490775e-06, "general_advantage_estimation": 0.008145505252102192, "add_observations_from_episodes_to_batch": 0.0008941354401553684, "add_time_dim_to_batch_and_zero_pad": 1.3389413450361892e-05, "add_one_ts_to_episodes_and_truncate": 0.009893938488226218, "numpy_to_tensor": 7.441957019718077e-05, "batch_individual_items": 0.03616057972481771, "add_columns_from_episodes_to_train_batch": 0.03786230411850239}}, "connector_pipeline_timer": 0.09320964119854915}, "num_module_steps_trained_lifetime": 84000, "num_trainable_parameters": 6003, "num_non_trainable_parameters": 0, "num_env_steps_trained_lifetime_throughput": 1819960.343993865, "num_module_steps_trained_throughput": 348189.028913368, "num_module_steps_trained_lifetime_throughput": 347313.1097172258}}, "num_training_step_calls_per_iteration": 1, "evaluation": {"env_runners": {"agent_episode_returns_mean": {"default_agent": 2.15}, "env_to_module_connector": {"timers": {"connectors": {"numpy_to_tensor": 8.101981391117514e-06, "batch_individual_items": 6.031613496451526e-06, "add_observations_from_episodes_to_batch": 2.7457890358646734e-06, "add_time_dim_to_batch_and_zero_pad": 2.1683770953644045e-06, "add_states_from_episodes_to_batch": 1.554181077963933e-06}}, "connector_pipeline_timer": 4.179087235292687e-05}, "module_to_env_connector": {"timers": {"connectors": {"get_actions": 3.4233316370779376e-05, "tensor_to_numpy": 1.241388404900841e-05, "normalize_and_clip_actions": 9.069000188268013e-06, "remove_single_ts_time_rank_from_batch": 6.228910826989056e-07, "un_batch_to_individual_items": 5.270433392328742e-06, "listify_data_for_vector_env": 1.0554177488468695e-05}}, "connector_pipeline_timer": 9.715772727891441e-05}, "episode_len_max": 20, "env_step_timer": 1.3425409879828226e-05, "episode_len_min": 20, "episode_return_min": -16.5, "num_episodes_lifetime": 280, "num_module_steps_sampled_lifetime": {"default_policy": 5600}, "sample": 0.11592561537887754, "rlmodule_inference_timer": 2.6236693171544158e-05, "env_to_module_sum_episodes_length_in": 10.368238394574323, "module_episode_returns_mean": {"default_policy": 2.15}, "env_reset_timer": 0.00025079693846869123, "num_agent_steps_sampled_lifetime": {"default_agent": 5600}, "weights_seq_no": 14.0, "num_module_steps_sampled": {"default_policy": 400}, "episode_len_mean": 20.0, "num_env_steps_sampled": 400, "episode_duration_sec_mean": 0.004598842463456094, "episode_return_max": 12.5, "episode_return_mean": 2.15, "env_to_module_sum_episodes_length_out": 10.368238394574323, "num_episodes": 20, "num_agent_steps_sampled": {"default_agent": 400}, "num_env_steps_sampled_lifetime": 70400, "time_between_sampling": 1.8230716126459303}, "num_healthy_workers": 1, "actor_manager_num_outstanding_async_reqs": 0, "num_remote_worker_restarts": 0}, "num_env_steps_sampled_lifetime": -7400000.0, "fault_tolerance": {"num_healthy_workers": 0, "num_remote_worker_restarts": 0}, "env_runner_group": {"actor_manager_num_outstanding_async_reqs": 0}, "done": false, "training_iteration": 14, "trial_id": "4dd64_00000", "date": "2025-08-11_19-22-41", "timestamp": 1754932961, "time_this_iter_s": 1.6534929275512695, "time_total_s": 25.37812900543213, "pid": 14353, "hostname": "Mac", "node_ip": "127.0.0.1", "config": {"exploration_config": {}, "extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "placement_strategy": "PACK", "num_gpus": 0, "_fake_gpus": false, "num_cpus_for_main_process": 2, "eager_tracing": true, "eager_max_retraces": 20, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "torch_compile_learner": false, "torch_compile_learner_what_to_compile": "forward_train", "torch_compile_learner_dynamo_backend": "aot_eager", "torch_compile_learner_dynamo_mode": null, "torch_compile_worker": false, "torch_compile_worker_dynamo_backend": "aot_eager", "torch_compile_worker_dynamo_mode": null, "torch_ddp_kwargs": {}, "torch_skip_nan_gradients": false, "env": "Umbrella", "env_config": {}, "observation_space": null, "action_space": null, "clip_rewards": null, "normalize_actions": true, "clip_actions": false, "_is_atari": null, "disable_env_checking": false, "render_env": false, "action_mask_key": "action_mask", "env_runner_cls": null, "num_env_runners": 0, "create_local_env_runner": true, "num_envs_per_env_runner": 1, "gym_env_vectorize_mode": "SYNC", "num_cpus_per_env_runner": 1, "num_gpus_per_env_runner": 0, "custom_resources_per_env_runner": {}, "validate_env_runners_after_construction": true, "episodes_to_numpy": true, "max_requests_in_flight_per_env_runner": 1, "sample_timeout_s": 60.0, "_env_to_module_connector": null, "add_default_connectors_to_env_to_module_pipeline": true, "_module_to_env_connector": null, "add_default_connectors_to_module_to_env_pipeline": true, "merge_env_runner_states": "training_only", "broadcast_env_runner_states": true, "episode_lookback_horizon": 1, "rollout_fragment_length": "auto", "batch_mode": "complete_episodes", "compress_observations": false, "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "enable_tf1_exec_eagerly": false, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "preprocessor_pref": "deepmind", "observation_filter": "NoFilter", "update_worker_filter_stats": true, "use_worker_filter_stats": true, "sampler_perf_stats_ema_coef": null, "_is_online": true, "num_learners": 0, "num_gpus_per_learner": 0, "num_cpus_per_learner": "auto", "num_aggregator_actors_per_learner": 0, "max_requests_in_flight_per_aggregator_actor": 3, "local_gpu_idx": 0, "max_requests_in_flight_per_learner": 3, "gamma": 1, "lr": 0.0002847858517, "grad_clip": 0.5, "grad_clip_by": "global_norm", "_train_batch_size_per_learner": 5000, "train_batch_size": 4000, "num_epochs": 1, "minibatch_size": 1000, "shuffle_batch_per_epoch": true, "model": {"fcnet_hiddens": [256, 256], "fcnet_activation": "tanh", "fcnet_weights_initializer": null, "fcnet_weights_initializer_config": null, "fcnet_bias_initializer": null, "fcnet_bias_initializer_config": null, "conv_filters": null, "conv_activation": "relu", "conv_kernel_initializer": null, "conv_kernel_initializer_config": null, "conv_bias_initializer": null, "conv_bias_initializer_config": null, "conv_transpose_kernel_initializer": null, "conv_transpose_kernel_initializer_config": null, "conv_transpose_bias_initializer": null, "conv_transpose_bias_initializer_config": null, "post_fcnet_hiddens": [], "post_fcnet_activation": "relu", "post_fcnet_weights_initializer": null, "post_fcnet_weights_initializer_config": null, "post_fcnet_bias_initializer": null, "post_fcnet_bias_initializer_config": null, "free_log_std": false, "log_std_clip_param": 20.0, "no_final_linear": false, "vf_share_layers": false, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "lstm_weights_initializer": null, "lstm_weights_initializer_config": null, "lstm_bias_initializer": null, "lstm_bias_initializer_config": null, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "attention_use_n_prev_actions": 0, "attention_use_n_prev_rewards": 0, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": null, "custom_model_config": {}, "custom_action_dist": null, "custom_preprocessor": null, "encoder_latent_dim": null, "always_check_shapes": false, "lstm_use_prev_action_reward": -1, "_use_default_native_models": -1, "_disable_preprocessor_api": false, "_disable_action_flattening": false}, "_learner_connector": null, "add_default_connectors_to_learner_pipeline": true, "learner_config_dict": {}, "optimizer": {}, "_learner_class": null, "callbacks_on_algorithm_init": null, "callbacks_on_env_runners_recreated": null, "callbacks_on_offline_eval_runners_recreated": null, "callbacks_on_checkpoint_loaded": null, "callbacks_on_environment_created": null, "callbacks_on_episode_created": null, "callbacks_on_episode_start": null, "callbacks_on_episode_step": null, "callbacks_on_episode_end": null, "callbacks_on_evaluate_start": null, "callbacks_on_evaluate_end": null, "callbacks_on_evaluate_offline_start": null, "callbacks_on_evaluate_offline_end": null, "callbacks_on_sample_end": null, "callbacks_on_train_result": null, "explore": true, "enable_rl_module_and_learner": true, "enable_env_runner_and_connector_v2": true, "_prior_exploration_config": {"type": "StochasticSampling"}, "count_steps_by": "env_steps", "policy_map_capacity": 100, "policy_mapping_fn": "<function AlgorithmConfig.DEFAULT_POLICY_MAPPING_FN at 0x3834118a0>", "policies_to_train": null, "policy_states_are_swappable": false, "observation_fn": null, "offline_data_class": null, "input_read_method": "read_parquet", "input_read_method_kwargs": {}, "input_read_schema": {}, "input_read_episodes": false, "input_read_sample_batches": false, "input_read_batch_size": null, "input_filesystem": null, "input_filesystem_kwargs": {}, "input_compress_columns": ["obs", "new_obs"], "input_spaces_jsonable": true, "materialize_data": false, "materialize_mapped_data": true, "map_batches_kwargs": {}, "iter_batches_kwargs": {}, "ignore_final_observation": false, "prelearner_class": null, "prelearner_buffer_class": null, "prelearner_buffer_kwargs": {}, "prelearner_module_synch_period": 10, "dataset_num_iters_per_learner": null, "input_config": {}, "actions_in_input_normalized": false, "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_config": {}, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "output_max_rows_per_file": null, "output_write_remaining_data": false, "output_write_method": "write_parquet", "output_write_method_kwargs": {}, "output_filesystem": null, "output_filesystem_kwargs": {}, "output_write_episodes": true, "offline_sampling": false, "evaluation_interval": 1, "evaluation_duration": 20, "evaluation_duration_unit": "episodes", "evaluation_sample_timeout_s": 120.0, "evaluation_auto_duration_min_env_steps_per_sample": 100, "evaluation_auto_duration_max_env_steps_per_sample": 2000, "evaluation_parallel_to_training": false, "evaluation_force_reset_envs_before_iteration": true, "evaluation_config": null, "off_policy_estimation_methods": {}, "ope_split_batch_by_episode": true, "evaluation_num_env_runners": 1, "in_evaluation": false, "sync_filters_on_rollout_workers_timeout_s": 10.0, "offline_evaluation_interval": null, "num_offline_eval_runners": 0, "offline_loss_for_module_fn": null, "offline_evaluation_duration": 1, "offline_evaluation_parallel_to_training": false, "offline_evaluation_timeout_s": 120.0, "num_cpus_per_offline_eval_runner": 1, "num_gpus_per_offline_eval_runner": 0, "custom_resources_per_offline_eval_runner": {}, "restart_failed_offline_eval_runners": true, "ignore_offline_eval_runner_failures": false, "max_num_offline_eval_runner_restarts": 1000, "offline_eval_runner_restore_timeout_s": 1800.0, "max_requests_in_flight_per_offline_eval_runner": 1, "validate_offline_eval_runners_after_construction": true, "offline_eval_runner_health_probe_timeout_s": 30.0, "offline_eval_rl_module_inference_only": false, "broadcast_offline_eval_runner_states": false, "offline_eval_batch_size_per_runner": 256, "dataset_num_iters_per_eval_runner": 1, "keep_per_episode_custom_metrics": false, "metrics_episode_collection_timeout_s": 60.0, "metrics_num_episodes_for_smoothing": 100, "min_time_s_per_iteration": null, "min_train_timesteps_per_iteration": 0, "min_sample_timesteps_per_iteration": 0, "log_gradients": true, "export_native_model_files": false, "checkpoint_trainable_policies_only": false, "logger_creator": null, "logger_config": null, "log_level": "WARN", "log_sys_usage": true, "fake_sampler": false, "seed": 4, "restart_failed_env_runners": true, "ignore_env_runner_failures": false, "max_num_env_runner_restarts": 1000, "delay_between_env_runner_restarts_s": 60.0, "restart_failed_sub_environments": false, "num_consecutive_env_runner_failures_tolerance": 100, "env_runner_health_probe_timeout_s": 30.0, "env_runner_restore_timeout_s": 1800.0, "_model_config": {}, "_rl_module_spec": "RLModuleSpec(module_class=None, observation_space=None, action_space=None, inference_only=False, learner_only=False, model_config=DefaultModelConfig(fcnet_hiddens=[60, 90], fcnet_activation='tanh', fcnet_kernel_initializer=None, fcnet_kernel_initializer_kwargs=None, fcnet_bias_initializer=None, fcnet_bias_initializer_kwargs=None, conv_filters=None, conv_activation='relu', conv_kernel_initializer=None, conv_kernel_initializer_kwargs=None, conv_bias_initializer=None, conv_bias_initializer_kwargs=None, head_fcnet_hiddens=[], head_fcnet_activation='relu', head_fcnet_kernel_initializer=None, head_fcnet_kernel_initializer_kwargs=None, head_fcnet_bias_initializer=None, head_fcnet_bias_initializer_kwargs=None, free_log_std=False, log_std_clip_param=20.0, vf_share_layers=True, use_lstm=False, max_seq_len=20, lstm_cell_size=256, lstm_use_prev_action=False, lstm_use_prev_reward=False, lstm_kernel_initializer=None, lstm_kernel_initializer_kwargs=None, lstm_bias_initializer=None, lstm_bias_initializer_kwargs=None), catalog_class=None, load_state_path=None, model_config_dict=None)", "algorithm_config_overrides_per_module": {}, "_per_module_overrides": {}, "_validate_config": true, "_use_msgpack_checkpoints": false, "_torch_grad_scaler_class": null, "_torch_lr_scheduler_classes": null, "_tf_policy_handles_more_than_one_loss": false, "_disable_preprocessor_api": false, "_disable_action_flattening": false, "_disable_initialize_loss_from_dummy_batch": false, "_dont_auto_sync_env_runner_states": false, "env_task_fn": -1, "enable_connectors": -1, "simple_optimizer": false, "policy_map_cache": -1, "worker_cls": -1, "synchronize_filters": -1, "enable_async_evaluation": -1, "custom_async_evaluation_function": -1, "_enable_rl_module_api": -1, "auto_wrap_old_gym_envs": -1, "always_attach_evaluation_results": -1, "replay_sequence_length": null, "_disable_execution_plan_api": -1, "use_critic": true, "use_gae": true, "use_kl_loss": true, "kl_coeff": 0.7464963036515, "kl_target": 0.0270990929592, "vf_loss_coeff": 0.6688075857018, "entropy_coeff": 0.0090570820258, "clip_param": 0.1221781641624, "vf_clip_param": 0.1027808522125, "entropy_coeff_schedule": null, "lr_schedule": null, "sgd_minibatch_size": -1, "vf_share_layers": -1, "__stdout_file__": null, "__stderr_file__": null, "lambda": 0.9099046732075, "input": "sampler", "policies": {"default_policy": [null, null, null, null]}, "callbacks": "<class 'ray.rllib.callbacks.callbacks.RLlibCallback'>", "create_env_on_driver": false, "custom_eval_function": null, "framework": "torch"}, "time_since_restore": 25.37812900543213, "iterations_since_restore": 14, "perf": {"cpu_util_percent": 39.46666666666667, "ram_util_percent": 78.8}}
{"timers": {"training_iteration": 1.8886379950791727, "restore_env_runners": 9.229257571047967e-06, "training_step": 1.8884756336862634, "env_runner_sampling_timer": 1.7626615484384816, "learner_update_timer": 0.12191500012216838, "synch_weights": 0.0010050990186875565, "restore_eval_env_runners": 8.888439457299854e-06, "evaluation_iteration": 0.12410043819662268, "synch_eval_env_connectors": 0.00012777497543108452, "synch_env_connectors": 4.326716437561388e-06}, "env_runners": {"env_reset_timer": 3.288621079454437e-05, "num_env_steps_sampled": 5000.0, "num_agent_steps_sampled_lifetime": {"default_agent": -8017500.0}, "episode_duration_sec_mean": 0.004520028514321893, "time_between_sampling": 0.0018045781195522, "module_to_env_connector": {"timers": {"connectors": {"tensor_to_numpy": 1.3116988880457588e-05, "normalize_and_clip_actions": 9.323596900516707e-06, "listify_data_for_vector_env": 1.100627061081443e-05, "un_batch_to_individual_items": 5.427117414293087e-06, "get_actions": 3.825915794156517e-05, "remove_single_ts_time_rank_from_batch": 5.748871568511938e-07}}, "connector_pipeline_timer": 0.00010318648585942814}, "sample": 0.004832328771245541, "episode_return_max": 12.5, "num_env_steps_sampled_lifetime": -8017500.0, "agent_episode_returns_mean": {"default_agent": 10.18}, "env_to_module_connector": {"timers": {"connectors": {"add_states_from_episodes_to_batch": 1.718355678861914e-06, "add_observations_from_episodes_to_batch": 2.9935322495791103e-06, "numpy_to_tensor": 8.524350664630385e-06, "batch_individual_items": 6.239756648289402e-06, "add_time_dim_to_batch_and_zero_pad": 2.3041431381553506e-06}}, "connector_pipeline_timer": 4.333076131323965e-05}, "episode_len_max": 20, "episode_return_mean": 10.18, "weights_seq_no": 14.0, "rlmodule_inference_timer": 2.7373015098839703e-05, "env_to_module_sum_episodes_length_in": 10.36823839457432, "env_step_timer": 1.3594064856917279e-05, "num_module_steps_sampled": {"default_policy": 5000.0}, "episode_len_min": 20, "episode_len_mean": 20.0, "num_episodes": 250.0, "episode_return_min": -7.5, "num_module_steps_sampled_lifetime": {"default_policy": -8017500.0}, "module_episode_returns_mean": {"default_policy": 10.18}, "num_agent_steps_sampled": {"default_agent": 5000.0}, "num_episodes_lifetime": -400875.0, "env_to_module_sum_episodes_length_out": 10.36823839457432, "num_env_steps_sampled_lifetime_throughput": 3745.976447768164}, "learners": {"default_policy": {"num_module_steps_trained": 6000, "gradients_default_optimizer_global_norm": 0.008220300078392029, "vf_explained_var": 0.019069373607635498, "num_module_steps_trained_lifetime": 90000, "policy_loss": -0.02631792053580284, "num_trainable_parameters": 6003, "entropy": 0.4188220798969269, "weights_seq_no": 15.0, "curr_entropy_coeff": 0.0090570820258, "module_train_batch_size_mean": 1000.0, "total_loss": 0.0381966270506382, "default_optimizer_learning_rate": 0.0002847858517, "vf_loss": 0.10213375091552734, "curr_kl_coeff": 2.2781259758630767e-05, "mean_kl_loss": 0.00024917605333030224, "vf_loss_unclipped": 28.625947952270508, "diff_num_grad_updates_vs_sampler_policy": 1.0, "num_module_steps_trained_lifetime_throughput": 356387.7332474534}, "__all_modules__": {"num_env_steps_trained_lifetime": 472500, "learner_connector_sum_episodes_length_in": 5000.0, "learner_connector_sum_episodes_length_out": 5250.0, "num_module_steps_trained": 6000, "num_env_steps_trained": 31500, "learner_connector": {"timers": {"connectors": {"add_states_from_episodes_to_batch": 4.029356078234247e-06, "general_advantage_estimation": 0.008115923949634517, "add_observations_from_episodes_to_batch": 0.0008933690851380242, "add_time_dim_to_batch_and_zero_pad": 1.3339689921845584e-05, "add_one_ts_to_episodes_and_truncate": 0.009870004102869801, "numpy_to_tensor": 7.432912452553283e-05, "batch_individual_items": 0.03716721517715319, "add_columns_from_episodes_to_train_batch": 0.03782783190737761}}, "connector_pipeline_timer": 0.09412667103658108}, "num_module_steps_trained_lifetime": 90000, "num_trainable_parameters": 6003, "num_non_trainable_parameters": 0, "num_env_steps_trained_lifetime_throughput": 1841033.2649205623, "num_module_steps_trained_throughput": 352138.04441644764, "num_module_steps_trained_lifetime_throughput": 351296.72327218286}}, "num_training_step_calls_per_iteration": 1, "evaluation": {"env_runners": {"agent_episode_returns_mean": {"default_agent": 1.95}, "env_to_module_connector": {"timers": {"connectors": {"numpy_to_tensor": 8.02327945103312e-06, "batch_individual_items": 5.991454188666895e-06, "add_observations_from_episodes_to_batch": 2.732940372064423e-06, "add_time_dim_to_batch_and_zero_pad": 2.1956291401857713e-06, "add_states_from_episodes_to_batch": 1.6121328236863071e-06}}, "connector_pipeline_timer": 4.1686119083286655e-05}, "module_to_env_connector": {"timers": {"connectors": {"get_actions": 3.390216109468659e-05, "tensor_to_numpy": 1.2437909040717383e-05, "normalize_and_clip_actions": 9.179598668299162e-06, "remove_single_ts_time_rank_from_batch": 6.164283464357415e-07, "un_batch_to_individual_items": 5.2433861419200405e-06, "listify_data_for_vector_env": 1.0585968375628611e-05}}, "connector_pipeline_timer": 9.708227389038992e-05}, "episode_len_max": 20, "env_step_timer": 1.3609274553944664e-05, "episode_len_min": 20, "episode_return_min": -16.5, "num_episodes_lifetime": 300, "num_module_steps_sampled_lifetime": {"default_policy": 6000}, "sample": 0.11571935964579325, "rlmodule_inference_timer": 2.6311553284003715e-05, "env_to_module_sum_episodes_length_in": 10.368238394574323, "module_episode_returns_mean": {"default_policy": 1.95}, "env_reset_timer": 0.00024907606005979555, "num_agent_steps_sampled_lifetime": {"default_agent": 6000}, "weights_seq_no": 15.0, "num_module_steps_sampled": {"default_policy": 400}, "episode_len_mean": 20.0, "num_env_steps_sampled": 400, "episode_duration_sec_mean": 0.004551036660559476, "episode_return_max": 12.5, "episode_return_mean": 1.95, "env_to_module_sum_episodes_length_out": 10.368238394574323, "num_episodes": 20, "num_agent_steps_sampled": {"default_agent": 400}, "num_env_steps_sampled_lifetime": 75400, "time_between_sampling": 1.8207398490199}, "num_healthy_workers": 1, "actor_manager_num_outstanding_async_reqs": 0, "num_remote_worker_restarts": 0}, "num_env_steps_sampled_lifetime": -8017500.0, "fault_tolerance": {"num_healthy_workers": 0, "num_remote_worker_restarts": 0}, "env_runner_group": {"actor_manager_num_outstanding_async_reqs": 0}, "done": false, "training_iteration": 15, "trial_id": "4dd64_00000", "date": "2025-08-11_19-22-43", "timestamp": 1754932963, "time_this_iter_s": 1.675506830215454, "time_total_s": 27.053635835647583, "pid": 14353, "hostname": "Mac", "node_ip": "127.0.0.1", "config": {"exploration_config": {}, "extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "placement_strategy": "PACK", "num_gpus": 0, "_fake_gpus": false, "num_cpus_for_main_process": 2, "eager_tracing": true, "eager_max_retraces": 20, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "torch_compile_learner": false, "torch_compile_learner_what_to_compile": "forward_train", "torch_compile_learner_dynamo_backend": "aot_eager", "torch_compile_learner_dynamo_mode": null, "torch_compile_worker": false, "torch_compile_worker_dynamo_backend": "aot_eager", "torch_compile_worker_dynamo_mode": null, "torch_ddp_kwargs": {}, "torch_skip_nan_gradients": false, "env": "Umbrella", "env_config": {}, "observation_space": null, "action_space": null, "clip_rewards": null, "normalize_actions": true, "clip_actions": false, "_is_atari": null, "disable_env_checking": false, "render_env": false, "action_mask_key": "action_mask", "env_runner_cls": null, "num_env_runners": 0, "create_local_env_runner": true, "num_envs_per_env_runner": 1, "gym_env_vectorize_mode": "SYNC", "num_cpus_per_env_runner": 1, "num_gpus_per_env_runner": 0, "custom_resources_per_env_runner": {}, "validate_env_runners_after_construction": true, "episodes_to_numpy": true, "max_requests_in_flight_per_env_runner": 1, "sample_timeout_s": 60.0, "_env_to_module_connector": null, "add_default_connectors_to_env_to_module_pipeline": true, "_module_to_env_connector": null, "add_default_connectors_to_module_to_env_pipeline": true, "merge_env_runner_states": "training_only", "broadcast_env_runner_states": true, "episode_lookback_horizon": 1, "rollout_fragment_length": "auto", "batch_mode": "complete_episodes", "compress_observations": false, "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "enable_tf1_exec_eagerly": false, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "preprocessor_pref": "deepmind", "observation_filter": "NoFilter", "update_worker_filter_stats": true, "use_worker_filter_stats": true, "sampler_perf_stats_ema_coef": null, "_is_online": true, "num_learners": 0, "num_gpus_per_learner": 0, "num_cpus_per_learner": "auto", "num_aggregator_actors_per_learner": 0, "max_requests_in_flight_per_aggregator_actor": 3, "local_gpu_idx": 0, "max_requests_in_flight_per_learner": 3, "gamma": 1, "lr": 0.0002847858517, "grad_clip": 0.5, "grad_clip_by": "global_norm", "_train_batch_size_per_learner": 5000, "train_batch_size": 4000, "num_epochs": 1, "minibatch_size": 1000, "shuffle_batch_per_epoch": true, "model": {"fcnet_hiddens": [256, 256], "fcnet_activation": "tanh", "fcnet_weights_initializer": null, "fcnet_weights_initializer_config": null, "fcnet_bias_initializer": null, "fcnet_bias_initializer_config": null, "conv_filters": null, "conv_activation": "relu", "conv_kernel_initializer": null, "conv_kernel_initializer_config": null, "conv_bias_initializer": null, "conv_bias_initializer_config": null, "conv_transpose_kernel_initializer": null, "conv_transpose_kernel_initializer_config": null, "conv_transpose_bias_initializer": null, "conv_transpose_bias_initializer_config": null, "post_fcnet_hiddens": [], "post_fcnet_activation": "relu", "post_fcnet_weights_initializer": null, "post_fcnet_weights_initializer_config": null, "post_fcnet_bias_initializer": null, "post_fcnet_bias_initializer_config": null, "free_log_std": false, "log_std_clip_param": 20.0, "no_final_linear": false, "vf_share_layers": false, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "lstm_weights_initializer": null, "lstm_weights_initializer_config": null, "lstm_bias_initializer": null, "lstm_bias_initializer_config": null, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "attention_use_n_prev_actions": 0, "attention_use_n_prev_rewards": 0, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": null, "custom_model_config": {}, "custom_action_dist": null, "custom_preprocessor": null, "encoder_latent_dim": null, "always_check_shapes": false, "lstm_use_prev_action_reward": -1, "_use_default_native_models": -1, "_disable_preprocessor_api": false, "_disable_action_flattening": false}, "_learner_connector": null, "add_default_connectors_to_learner_pipeline": true, "learner_config_dict": {}, "optimizer": {}, "_learner_class": null, "callbacks_on_algorithm_init": null, "callbacks_on_env_runners_recreated": null, "callbacks_on_offline_eval_runners_recreated": null, "callbacks_on_checkpoint_loaded": null, "callbacks_on_environment_created": null, "callbacks_on_episode_created": null, "callbacks_on_episode_start": null, "callbacks_on_episode_step": null, "callbacks_on_episode_end": null, "callbacks_on_evaluate_start": null, "callbacks_on_evaluate_end": null, "callbacks_on_evaluate_offline_start": null, "callbacks_on_evaluate_offline_end": null, "callbacks_on_sample_end": null, "callbacks_on_train_result": null, "explore": true, "enable_rl_module_and_learner": true, "enable_env_runner_and_connector_v2": true, "_prior_exploration_config": {"type": "StochasticSampling"}, "count_steps_by": "env_steps", "policy_map_capacity": 100, "policy_mapping_fn": "<function AlgorithmConfig.DEFAULT_POLICY_MAPPING_FN at 0x3834118a0>", "policies_to_train": null, "policy_states_are_swappable": false, "observation_fn": null, "offline_data_class": null, "input_read_method": "read_parquet", "input_read_method_kwargs": {}, "input_read_schema": {}, "input_read_episodes": false, "input_read_sample_batches": false, "input_read_batch_size": null, "input_filesystem": null, "input_filesystem_kwargs": {}, "input_compress_columns": ["obs", "new_obs"], "input_spaces_jsonable": true, "materialize_data": false, "materialize_mapped_data": true, "map_batches_kwargs": {}, "iter_batches_kwargs": {}, "ignore_final_observation": false, "prelearner_class": null, "prelearner_buffer_class": null, "prelearner_buffer_kwargs": {}, "prelearner_module_synch_period": 10, "dataset_num_iters_per_learner": null, "input_config": {}, "actions_in_input_normalized": false, "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_config": {}, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "output_max_rows_per_file": null, "output_write_remaining_data": false, "output_write_method": "write_parquet", "output_write_method_kwargs": {}, "output_filesystem": null, "output_filesystem_kwargs": {}, "output_write_episodes": true, "offline_sampling": false, "evaluation_interval": 1, "evaluation_duration": 20, "evaluation_duration_unit": "episodes", "evaluation_sample_timeout_s": 120.0, "evaluation_auto_duration_min_env_steps_per_sample": 100, "evaluation_auto_duration_max_env_steps_per_sample": 2000, "evaluation_parallel_to_training": false, "evaluation_force_reset_envs_before_iteration": true, "evaluation_config": null, "off_policy_estimation_methods": {}, "ope_split_batch_by_episode": true, "evaluation_num_env_runners": 1, "in_evaluation": false, "sync_filters_on_rollout_workers_timeout_s": 10.0, "offline_evaluation_interval": null, "num_offline_eval_runners": 0, "offline_loss_for_module_fn": null, "offline_evaluation_duration": 1, "offline_evaluation_parallel_to_training": false, "offline_evaluation_timeout_s": 120.0, "num_cpus_per_offline_eval_runner": 1, "num_gpus_per_offline_eval_runner": 0, "custom_resources_per_offline_eval_runner": {}, "restart_failed_offline_eval_runners": true, "ignore_offline_eval_runner_failures": false, "max_num_offline_eval_runner_restarts": 1000, "offline_eval_runner_restore_timeout_s": 1800.0, "max_requests_in_flight_per_offline_eval_runner": 1, "validate_offline_eval_runners_after_construction": true, "offline_eval_runner_health_probe_timeout_s": 30.0, "offline_eval_rl_module_inference_only": false, "broadcast_offline_eval_runner_states": false, "offline_eval_batch_size_per_runner": 256, "dataset_num_iters_per_eval_runner": 1, "keep_per_episode_custom_metrics": false, "metrics_episode_collection_timeout_s": 60.0, "metrics_num_episodes_for_smoothing": 100, "min_time_s_per_iteration": null, "min_train_timesteps_per_iteration": 0, "min_sample_timesteps_per_iteration": 0, "log_gradients": true, "export_native_model_files": false, "checkpoint_trainable_policies_only": false, "logger_creator": null, "logger_config": null, "log_level": "WARN", "log_sys_usage": true, "fake_sampler": false, "seed": 4, "restart_failed_env_runners": true, "ignore_env_runner_failures": false, "max_num_env_runner_restarts": 1000, "delay_between_env_runner_restarts_s": 60.0, "restart_failed_sub_environments": false, "num_consecutive_env_runner_failures_tolerance": 100, "env_runner_health_probe_timeout_s": 30.0, "env_runner_restore_timeout_s": 1800.0, "_model_config": {}, "_rl_module_spec": "RLModuleSpec(module_class=None, observation_space=None, action_space=None, inference_only=False, learner_only=False, model_config=DefaultModelConfig(fcnet_hiddens=[60, 90], fcnet_activation='tanh', fcnet_kernel_initializer=None, fcnet_kernel_initializer_kwargs=None, fcnet_bias_initializer=None, fcnet_bias_initializer_kwargs=None, conv_filters=None, conv_activation='relu', conv_kernel_initializer=None, conv_kernel_initializer_kwargs=None, conv_bias_initializer=None, conv_bias_initializer_kwargs=None, head_fcnet_hiddens=[], head_fcnet_activation='relu', head_fcnet_kernel_initializer=None, head_fcnet_kernel_initializer_kwargs=None, head_fcnet_bias_initializer=None, head_fcnet_bias_initializer_kwargs=None, free_log_std=False, log_std_clip_param=20.0, vf_share_layers=True, use_lstm=False, max_seq_len=20, lstm_cell_size=256, lstm_use_prev_action=False, lstm_use_prev_reward=False, lstm_kernel_initializer=None, lstm_kernel_initializer_kwargs=None, lstm_bias_initializer=None, lstm_bias_initializer_kwargs=None), catalog_class=None, load_state_path=None, model_config_dict=None)", "algorithm_config_overrides_per_module": {}, "_per_module_overrides": {}, "_validate_config": true, "_use_msgpack_checkpoints": false, "_torch_grad_scaler_class": null, "_torch_lr_scheduler_classes": null, "_tf_policy_handles_more_than_one_loss": false, "_disable_preprocessor_api": false, "_disable_action_flattening": false, "_disable_initialize_loss_from_dummy_batch": false, "_dont_auto_sync_env_runner_states": false, "env_task_fn": -1, "enable_connectors": -1, "simple_optimizer": false, "policy_map_cache": -1, "worker_cls": -1, "synchronize_filters": -1, "enable_async_evaluation": -1, "custom_async_evaluation_function": -1, "_enable_rl_module_api": -1, "auto_wrap_old_gym_envs": -1, "always_attach_evaluation_results": -1, "replay_sequence_length": null, "_disable_execution_plan_api": -1, "use_critic": true, "use_gae": true, "use_kl_loss": true, "kl_coeff": 0.7464963036515, "kl_target": 0.0270990929592, "vf_loss_coeff": 0.6688075857018, "entropy_coeff": 0.0090570820258, "clip_param": 0.1221781641624, "vf_clip_param": 0.1027808522125, "entropy_coeff_schedule": null, "lr_schedule": null, "sgd_minibatch_size": -1, "vf_share_layers": -1, "__stdout_file__": null, "__stderr_file__": null, "lambda": 0.9099046732075, "input": "sampler", "policies": {"default_policy": [null, null, null, null]}, "callbacks": "<class 'ray.rllib.callbacks.callbacks.RLlibCallback'>", "create_env_on_driver": false, "custom_eval_function": null, "framework": "torch"}, "time_since_restore": 27.053635835647583, "iterations_since_restore": 15, "perf": {"cpu_util_percent": 38.05, "ram_util_percent": 79.05}}
{"timers": {"training_iteration": 1.8857469742988644, "restore_env_runners": 9.196134246809244e-06, "training_step": 1.8855844640092978, "env_runner_sampling_timer": 1.7600574854541098, "learner_update_timer": 0.12163476720042146, "synch_weights": 0.0010011696886177408, "restore_eval_env_runners": 8.867885035873174e-06, "evaluation_iteration": 0.12386340672476823, "synch_eval_env_connectors": 0.00012745306648231914, "synch_env_connectors": 4.322199277209087e-06}, "env_runners": {"env_reset_timer": 3.896452962414322e-05, "num_env_steps_sampled": 5000.0, "num_agent_steps_sampled_lifetime": {"default_agent": -8635000.0}, "episode_duration_sec_mean": 0.004935474201571197, "time_between_sampling": 0.0019272966937389148, "module_to_env_connector": {"timers": {"connectors": {"tensor_to_numpy": 1.4411183488175888e-05, "normalize_and_clip_actions": 1.0010514087642941e-05, "listify_data_for_vector_env": 1.2018313122296669e-05, "un_batch_to_individual_items": 5.76881210552189e-06, "get_actions": 4.333623943758048e-05, "remove_single_ts_time_rank_from_batch": 6.30944422595197e-07}}, "connector_pipeline_timer": 0.0001133802033669018}, "sample": 0.0050885047090248395, "episode_return_max": 12.5, "num_env_steps_sampled_lifetime": -8635000.0, "agent_episode_returns_mean": {"default_agent": 11.059999999999997}, "env_to_module_connector": {"timers": {"connectors": {"add_states_from_episodes_to_batch": 1.7852203665328767e-06, "add_observations_from_episodes_to_batch": 3.122647129123811e-06, "numpy_to_tensor": 9.382095240729863e-06, "batch_individual_items": 6.985320612564047e-06, "add_time_dim_to_batch_and_zero_pad": 2.4646260742786573e-06}}, "connector_pipeline_timer": 4.621437001228387e-05}, "episode_len_max": 20, "episode_return_mean": 11.059999999999997, "weights_seq_no": 15.0, "rlmodule_inference_timer": 3.0140000675359704e-05, "env_to_module_sum_episodes_length_in": 10.36823839457432, "env_step_timer": 1.508475244434292e-05, "num_module_steps_sampled": {"default_policy": 5000.0}, "episode_len_min": 20, "episode_len_mean": 20.0, "num_episodes": 250.0, "episode_return_min": -7.5, "num_module_steps_sampled_lifetime": {"default_policy": -8635000.0}, "module_episode_returns_mean": {"default_policy": 11.059999999999997}, "num_agent_steps_sampled": {"default_agent": 5000.0}, "num_episodes_lifetime": -431750.0, "env_to_module_sum_episodes_length_out": 10.36823839457432, "num_env_steps_sampled_lifetime_throughput": 3492.611273290804}, "learners": {"default_policy": {"num_module_steps_trained": 6000, "gradients_default_optimizer_global_norm": 0.06402754038572311, "vf_explained_var": 0.015397906303405762, "num_module_steps_trained_lifetime": 96000, "policy_loss": -0.08910641074180603, "num_trainable_parameters": 6003, "entropy": 0.4002242386341095, "weights_seq_no": 16.0, "curr_entropy_coeff": 0.0090570820258, "module_train_batch_size_mean": 1000.0, "total_loss": -0.02420705370604992, "default_optimizer_learning_rate": 0.0002847858517, "vf_loss": 0.10245729237794876, "curr_kl_coeff": 1.1390629879315384e-05, "mean_kl_loss": 6.365888111758977e-05, "vf_loss_unclipped": 28.66145133972168, "diff_num_grad_updates_vs_sampler_policy": 1.0, "num_module_steps_trained_lifetime_throughput": 359602.35676199105}, "__all_modules__": {"num_env_steps_trained_lifetime": 504000, "learner_connector_sum_episodes_length_in": 5000.0, "learner_connector_sum_episodes_length_out": 5250.0, "num_module_steps_trained": 6000, "num_env_steps_trained": 31500, "learner_connector": {"timers": {"connectors": {"add_states_from_episodes_to_batch": 4.015721626150273e-06, "general_advantage_estimation": 0.008094330961140424, "add_observations_from_episodes_to_batch": 0.0008927178950714881, "add_time_dim_to_batch_and_zero_pad": 1.328838328681339e-05, "add_one_ts_to_episodes_and_truncate": 0.009849389891577768, "numpy_to_tensor": 7.417416372050071e-05, "batch_individual_items": 0.0370946242759412, "add_columns_from_episodes_to_train_batch": 0.03779125483859433}}, "connector_pipeline_timer": 0.09397367765676032}, "num_module_steps_trained_lifetime": 96000, "num_trainable_parameters": 6003, "num_non_trainable_parameters": 0, "num_env_steps_trained_lifetime_throughput": 1859524.7044487805, "num_module_steps_trained_throughput": 355598.06608858064, "num_module_steps_trained_lifetime_throughput": 354790.1225425445}}, "num_training_step_calls_per_iteration": 1, "evaluation": {"env_runners": {"agent_episode_returns_mean": {"default_agent": 1.95}, "env_to_module_connector": {"timers": {"connectors": {"numpy_to_tensor": 1.4434242240559108e-05, "batch_individual_items": 1.0455385376707035e-05, "add_observations_from_episodes_to_batch": 3.4836078028688213e-06, "add_time_dim_to_batch_and_zero_pad": 4.649240875873212e-06, "add_states_from_episodes_to_batch": 2.803209338141528e-06}}, "connector_pipeline_timer": 6.684054154845905e-05}, "module_to_env_connector": {"timers": {"connectors": {"get_actions": 7.067745924254334e-05, "tensor_to_numpy": 1.9741459343336655e-05, "normalize_and_clip_actions": 1.434437099963328e-05, "remove_single_ts_time_rank_from_batch": 4.875498837520453e-06, "un_batch_to_individual_items": 8.255407767977712e-06, "listify_data_for_vector_env": 2.0210897587771068e-05}}, "connector_pipeline_timer": 0.00017522640708634579}, "episode_len_max": 20, "env_step_timer": 2.3908712021030022e-05, "episode_len_min": 20, "episode_return_min": -16.5, "num_episodes_lifetime": 320, "num_module_steps_sampled_lifetime": {"default_policy": 6400}, "sample": 0.11586286437949554, "rlmodule_inference_timer": 4.622236851273842e-05, "env_to_module_sum_episodes_length_in": 10.368238394574323, "module_episode_returns_mean": {"default_policy": 1.95}, "env_reset_timer": 0.0002494652992700273, "num_agent_steps_sampled_lifetime": {"default_agent": 6400}, "weights_seq_no": 16.0, "num_module_steps_sampled": {"default_policy": 400}, "episode_len_mean": 20.0, "num_env_steps_sampled": 400, "episode_duration_sec_mean": 0.0047074675175827, "episode_return_max": 12.5, "episode_return_mean": 1.95, "env_to_module_sum_episodes_length_out": 10.368238394574323, "num_episodes": 20, "num_agent_steps_sampled": {"default_agent": 400}, "num_env_steps_sampled_lifetime": 80400, "time_between_sampling": 1.818702760529426}, "num_healthy_workers": 1, "actor_manager_num_outstanding_async_reqs": 0, "num_remote_worker_restarts": 0}, "num_env_steps_sampled_lifetime": -8635000.0, "fault_tolerance": {"num_healthy_workers": 0, "num_remote_worker_restarts": 0}, "env_runner_group": {"actor_manager_num_outstanding_async_reqs": 0}, "done": false, "training_iteration": 16, "trial_id": "4dd64_00000", "date": "2025-08-11_19-22-45", "timestamp": 1754932965, "time_this_iter_s": 1.7413179874420166, "time_total_s": 28.7949538230896, "pid": 14353, "hostname": "Mac", "node_ip": "127.0.0.1", "config": {"exploration_config": {}, "extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "placement_strategy": "PACK", "num_gpus": 0, "_fake_gpus": false, "num_cpus_for_main_process": 2, "eager_tracing": true, "eager_max_retraces": 20, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "torch_compile_learner": false, "torch_compile_learner_what_to_compile": "forward_train", "torch_compile_learner_dynamo_backend": "aot_eager", "torch_compile_learner_dynamo_mode": null, "torch_compile_worker": false, "torch_compile_worker_dynamo_backend": "aot_eager", "torch_compile_worker_dynamo_mode": null, "torch_ddp_kwargs": {}, "torch_skip_nan_gradients": false, "env": "Umbrella", "env_config": {}, "observation_space": null, "action_space": null, "clip_rewards": null, "normalize_actions": true, "clip_actions": false, "_is_atari": null, "disable_env_checking": false, "render_env": false, "action_mask_key": "action_mask", "env_runner_cls": null, "num_env_runners": 0, "create_local_env_runner": true, "num_envs_per_env_runner": 1, "gym_env_vectorize_mode": "SYNC", "num_cpus_per_env_runner": 1, "num_gpus_per_env_runner": 0, "custom_resources_per_env_runner": {}, "validate_env_runners_after_construction": true, "episodes_to_numpy": true, "max_requests_in_flight_per_env_runner": 1, "sample_timeout_s": 60.0, "_env_to_module_connector": null, "add_default_connectors_to_env_to_module_pipeline": true, "_module_to_env_connector": null, "add_default_connectors_to_module_to_env_pipeline": true, "merge_env_runner_states": "training_only", "broadcast_env_runner_states": true, "episode_lookback_horizon": 1, "rollout_fragment_length": "auto", "batch_mode": "complete_episodes", "compress_observations": false, "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "enable_tf1_exec_eagerly": false, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "preprocessor_pref": "deepmind", "observation_filter": "NoFilter", "update_worker_filter_stats": true, "use_worker_filter_stats": true, "sampler_perf_stats_ema_coef": null, "_is_online": true, "num_learners": 0, "num_gpus_per_learner": 0, "num_cpus_per_learner": "auto", "num_aggregator_actors_per_learner": 0, "max_requests_in_flight_per_aggregator_actor": 3, "local_gpu_idx": 0, "max_requests_in_flight_per_learner": 3, "gamma": 1, "lr": 0.0002847858517, "grad_clip": 0.5, "grad_clip_by": "global_norm", "_train_batch_size_per_learner": 5000, "train_batch_size": 4000, "num_epochs": 1, "minibatch_size": 1000, "shuffle_batch_per_epoch": true, "model": {"fcnet_hiddens": [256, 256], "fcnet_activation": "tanh", "fcnet_weights_initializer": null, "fcnet_weights_initializer_config": null, "fcnet_bias_initializer": null, "fcnet_bias_initializer_config": null, "conv_filters": null, "conv_activation": "relu", "conv_kernel_initializer": null, "conv_kernel_initializer_config": null, "conv_bias_initializer": null, "conv_bias_initializer_config": null, "conv_transpose_kernel_initializer": null, "conv_transpose_kernel_initializer_config": null, "conv_transpose_bias_initializer": null, "conv_transpose_bias_initializer_config": null, "post_fcnet_hiddens": [], "post_fcnet_activation": "relu", "post_fcnet_weights_initializer": null, "post_fcnet_weights_initializer_config": null, "post_fcnet_bias_initializer": null, "post_fcnet_bias_initializer_config": null, "free_log_std": false, "log_std_clip_param": 20.0, "no_final_linear": false, "vf_share_layers": false, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "lstm_weights_initializer": null, "lstm_weights_initializer_config": null, "lstm_bias_initializer": null, "lstm_bias_initializer_config": null, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "attention_use_n_prev_actions": 0, "attention_use_n_prev_rewards": 0, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": null, "custom_model_config": {}, "custom_action_dist": null, "custom_preprocessor": null, "encoder_latent_dim": null, "always_check_shapes": false, "lstm_use_prev_action_reward": -1, "_use_default_native_models": -1, "_disable_preprocessor_api": false, "_disable_action_flattening": false}, "_learner_connector": null, "add_default_connectors_to_learner_pipeline": true, "learner_config_dict": {}, "optimizer": {}, "_learner_class": null, "callbacks_on_algorithm_init": null, "callbacks_on_env_runners_recreated": null, "callbacks_on_offline_eval_runners_recreated": null, "callbacks_on_checkpoint_loaded": null, "callbacks_on_environment_created": null, "callbacks_on_episode_created": null, "callbacks_on_episode_start": null, "callbacks_on_episode_step": null, "callbacks_on_episode_end": null, "callbacks_on_evaluate_start": null, "callbacks_on_evaluate_end": null, "callbacks_on_evaluate_offline_start": null, "callbacks_on_evaluate_offline_end": null, "callbacks_on_sample_end": null, "callbacks_on_train_result": null, "explore": true, "enable_rl_module_and_learner": true, "enable_env_runner_and_connector_v2": true, "_prior_exploration_config": {"type": "StochasticSampling"}, "count_steps_by": "env_steps", "policy_map_capacity": 100, "policy_mapping_fn": "<function AlgorithmConfig.DEFAULT_POLICY_MAPPING_FN at 0x3834118a0>", "policies_to_train": null, "policy_states_are_swappable": false, "observation_fn": null, "offline_data_class": null, "input_read_method": "read_parquet", "input_read_method_kwargs": {}, "input_read_schema": {}, "input_read_episodes": false, "input_read_sample_batches": false, "input_read_batch_size": null, "input_filesystem": null, "input_filesystem_kwargs": {}, "input_compress_columns": ["obs", "new_obs"], "input_spaces_jsonable": true, "materialize_data": false, "materialize_mapped_data": true, "map_batches_kwargs": {}, "iter_batches_kwargs": {}, "ignore_final_observation": false, "prelearner_class": null, "prelearner_buffer_class": null, "prelearner_buffer_kwargs": {}, "prelearner_module_synch_period": 10, "dataset_num_iters_per_learner": null, "input_config": {}, "actions_in_input_normalized": false, "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_config": {}, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "output_max_rows_per_file": null, "output_write_remaining_data": false, "output_write_method": "write_parquet", "output_write_method_kwargs": {}, "output_filesystem": null, "output_filesystem_kwargs": {}, "output_write_episodes": true, "offline_sampling": false, "evaluation_interval": 1, "evaluation_duration": 20, "evaluation_duration_unit": "episodes", "evaluation_sample_timeout_s": 120.0, "evaluation_auto_duration_min_env_steps_per_sample": 100, "evaluation_auto_duration_max_env_steps_per_sample": 2000, "evaluation_parallel_to_training": false, "evaluation_force_reset_envs_before_iteration": true, "evaluation_config": null, "off_policy_estimation_methods": {}, "ope_split_batch_by_episode": true, "evaluation_num_env_runners": 1, "in_evaluation": false, "sync_filters_on_rollout_workers_timeout_s": 10.0, "offline_evaluation_interval": null, "num_offline_eval_runners": 0, "offline_loss_for_module_fn": null, "offline_evaluation_duration": 1, "offline_evaluation_parallel_to_training": false, "offline_evaluation_timeout_s": 120.0, "num_cpus_per_offline_eval_runner": 1, "num_gpus_per_offline_eval_runner": 0, "custom_resources_per_offline_eval_runner": {}, "restart_failed_offline_eval_runners": true, "ignore_offline_eval_runner_failures": false, "max_num_offline_eval_runner_restarts": 1000, "offline_eval_runner_restore_timeout_s": 1800.0, "max_requests_in_flight_per_offline_eval_runner": 1, "validate_offline_eval_runners_after_construction": true, "offline_eval_runner_health_probe_timeout_s": 30.0, "offline_eval_rl_module_inference_only": false, "broadcast_offline_eval_runner_states": false, "offline_eval_batch_size_per_runner": 256, "dataset_num_iters_per_eval_runner": 1, "keep_per_episode_custom_metrics": false, "metrics_episode_collection_timeout_s": 60.0, "metrics_num_episodes_for_smoothing": 100, "min_time_s_per_iteration": null, "min_train_timesteps_per_iteration": 0, "min_sample_timesteps_per_iteration": 0, "log_gradients": true, "export_native_model_files": false, "checkpoint_trainable_policies_only": false, "logger_creator": null, "logger_config": null, "log_level": "WARN", "log_sys_usage": true, "fake_sampler": false, "seed": 4, "restart_failed_env_runners": true, "ignore_env_runner_failures": false, "max_num_env_runner_restarts": 1000, "delay_between_env_runner_restarts_s": 60.0, "restart_failed_sub_environments": false, "num_consecutive_env_runner_failures_tolerance": 100, "env_runner_health_probe_timeout_s": 30.0, "env_runner_restore_timeout_s": 1800.0, "_model_config": {}, "_rl_module_spec": "RLModuleSpec(module_class=None, observation_space=None, action_space=None, inference_only=False, learner_only=False, model_config=DefaultModelConfig(fcnet_hiddens=[60, 90], fcnet_activation='tanh', fcnet_kernel_initializer=None, fcnet_kernel_initializer_kwargs=None, fcnet_bias_initializer=None, fcnet_bias_initializer_kwargs=None, conv_filters=None, conv_activation='relu', conv_kernel_initializer=None, conv_kernel_initializer_kwargs=None, conv_bias_initializer=None, conv_bias_initializer_kwargs=None, head_fcnet_hiddens=[], head_fcnet_activation='relu', head_fcnet_kernel_initializer=None, head_fcnet_kernel_initializer_kwargs=None, head_fcnet_bias_initializer=None, head_fcnet_bias_initializer_kwargs=None, free_log_std=False, log_std_clip_param=20.0, vf_share_layers=True, use_lstm=False, max_seq_len=20, lstm_cell_size=256, lstm_use_prev_action=False, lstm_use_prev_reward=False, lstm_kernel_initializer=None, lstm_kernel_initializer_kwargs=None, lstm_bias_initializer=None, lstm_bias_initializer_kwargs=None), catalog_class=None, load_state_path=None, model_config_dict=None)", "algorithm_config_overrides_per_module": {}, "_per_module_overrides": {}, "_validate_config": true, "_use_msgpack_checkpoints": false, "_torch_grad_scaler_class": null, "_torch_lr_scheduler_classes": null, "_tf_policy_handles_more_than_one_loss": false, "_disable_preprocessor_api": false, "_disable_action_flattening": false, "_disable_initialize_loss_from_dummy_batch": false, "_dont_auto_sync_env_runner_states": false, "env_task_fn": -1, "enable_connectors": -1, "simple_optimizer": false, "policy_map_cache": -1, "worker_cls": -1, "synchronize_filters": -1, "enable_async_evaluation": -1, "custom_async_evaluation_function": -1, "_enable_rl_module_api": -1, "auto_wrap_old_gym_envs": -1, "always_attach_evaluation_results": -1, "replay_sequence_length": null, "_disable_execution_plan_api": -1, "use_critic": true, "use_gae": true, "use_kl_loss": true, "kl_coeff": 0.7464963036515, "kl_target": 0.0270990929592, "vf_loss_coeff": 0.6688075857018, "entropy_coeff": 0.0090570820258, "clip_param": 0.1221781641624, "vf_clip_param": 0.1027808522125, "entropy_coeff_schedule": null, "lr_schedule": null, "sgd_minibatch_size": -1, "vf_share_layers": -1, "__stdout_file__": null, "__stderr_file__": null, "lambda": 0.9099046732075, "input": "sampler", "policies": {"default_policy": [null, null, null, null]}, "callbacks": "<class 'ray.rllib.callbacks.callbacks.RLlibCallback'>", "create_env_on_driver": false, "custom_eval_function": null, "framework": "torch"}, "time_since_restore": 28.7949538230896, "iterations_since_restore": 16, "perf": {"cpu_util_percent": 45.699999999999996, "ram_util_percent": 79.46666666666667}}
{"timers": {"training_iteration": 1.8836650749757256, "restore_env_runners": 9.398342781065633e-06, "training_step": 1.8834832256189469, "env_runner_sampling_timer": 1.758118877679655, "learner_update_timer": 0.1214764578676689, "synch_weights": 0.0009979234122801813, "restore_eval_env_runners": 8.843376639211886e-06, "evaluation_iteration": 0.12401766848831572, "synch_eval_env_connectors": 0.0001271060353129426, "synch_env_connectors": 5.2543968188073e-06}, "env_runners": {"env_reset_timer": 4.319557717358936e-05, "num_env_steps_sampled": 5000.0, "num_agent_steps_sampled_lifetime": {"default_agent": -9252500.0}, "episode_duration_sec_mean": 0.0052252309862524235, "time_between_sampling": 0.0018421263191335058, "module_to_env_connector": {"timers": {"connectors": {"tensor_to_numpy": 1.39380055659137e-05, "normalize_and_clip_actions": 9.864647209408866e-06, "listify_data_for_vector_env": 1.1590281865020948e-05, "un_batch_to_individual_items": 5.63992140272002e-06, "get_actions": 4.128812698481646e-05, "remove_single_ts_time_rank_from_batch": 5.997357294540845e-07}}, "connector_pipeline_timer": 0.00010938484810400357}, "sample": 0.005493217226564977, "episode_return_max": 12.5, "num_env_steps_sampled_lifetime": -9252500.0, "agent_episode_returns_mean": {"default_agent": 10.5}, "env_to_module_connector": {"timers": {"connectors": {"add_states_from_episodes_to_batch": 1.777588742476908e-06, "add_observations_from_episodes_to_batch": 3.1312374681672743e-06, "numpy_to_tensor": 9.1639122846758e-06, "batch_individual_items": 6.621516565826437e-06, "add_time_dim_to_batch_and_zero_pad": 2.402447424573358e-06}}, "connector_pipeline_timer": 4.532307993519746e-05}, "episode_len_max": 20, "episode_return_mean": 10.5, "weights_seq_no": 16.0, "rlmodule_inference_timer": 4.856837096137864e-05, "env_to_module_sum_episodes_length_in": 10.36823839457432, "env_step_timer": 1.461417053193655e-05, "num_module_steps_sampled": {"default_policy": 5000.0}, "episode_len_min": 20, "episode_len_mean": 20.0, "num_episodes": 250.0, "episode_return_min": -7.5, "num_module_steps_sampled_lifetime": {"default_policy": -9252500.0}, "module_episode_returns_mean": {"default_policy": 10.5}, "num_agent_steps_sampled": {"default_agent": 5000.0}, "num_episodes_lifetime": -462625.0, "env_to_module_sum_episodes_length_out": 10.36823839457432, "num_env_steps_sampled_lifetime_throughput": 3585.825480075874}, "learners": {"default_policy": {"num_module_steps_trained": 6000, "gradients_default_optimizer_global_norm": 0.12811815738677979, "vf_explained_var": 0.01704394817352295, "num_module_steps_trained_lifetime": 102000, "policy_loss": -0.09787576645612717, "num_trainable_parameters": 6003, "entropy": 0.3960508704185486, "weights_seq_no": 17.0, "curr_entropy_coeff": 0.0090570820258, "module_train_batch_size_mean": 1000.0, "total_loss": -0.03301073610782623, "default_optimizer_learning_rate": 0.0002847858517, "vf_loss": 0.10234946012496948, "curr_kl_coeff": 5.695314939657692e-06, "mean_kl_loss": 0.00011660082236630842, "vf_loss_unclipped": 28.645084381103516, "diff_num_grad_updates_vs_sampler_policy": 1.0, "num_module_steps_trained_lifetime_throughput": 361657.24404348014}, "__all_modules__": {"num_env_steps_trained_lifetime": 535500, "learner_connector_sum_episodes_length_in": 5000.0, "learner_connector_sum_episodes_length_out": 5250.0, "num_module_steps_trained": 6000, "num_env_steps_trained": 31500, "learner_connector": {"timers": {"connectors": {"add_states_from_episodes_to_batch": 4.008484334594991e-06, "general_advantage_estimation": 0.008074858480479426, "add_observations_from_episodes_to_batch": 0.0008956111355794456, "add_time_dim_to_batch_and_zero_pad": 1.3269659810988404e-05, "add_one_ts_to_episodes_and_truncate": 0.009841232652585186, "numpy_to_tensor": 7.41711727608515e-05, "batch_individual_items": 0.037065413032274085, "add_columns_from_episodes_to_train_batch": 0.03779773270955746}}, "connector_pipeline_timer": 0.09392578296093856}, "num_module_steps_trained_lifetime": 102000, "num_trainable_parameters": 6003, "num_non_trainable_parameters": 0, "num_env_steps_trained_lifetime_throughput": 1871830.3668181105, "num_module_steps_trained_throughput": 357883.3887796033, "num_module_steps_trained_lifetime_throughput": 357107.35650492914}}, "num_training_step_calls_per_iteration": 1, "evaluation": {"env_runners": {"agent_episode_returns_mean": {"default_agent": 1.55}, "env_to_module_connector": {"timers": {"connectors": {"numpy_to_tensor": 8.290267622951152e-06, "batch_individual_items": 6.149503238201603e-06, "add_observations_from_episodes_to_batch": 2.762022526062395e-06, "add_time_dim_to_batch_and_zero_pad": 2.2655291180589473e-06, "add_states_from_episodes_to_batch": 1.5715317756619498e-06}}, "connector_pipeline_timer": 4.2559323243240446e-05}, "module_to_env_connector": {"timers": {"connectors": {"get_actions": 3.502408810960507e-05, "tensor_to_numpy": 1.2629492021163872e-05, "normalize_and_clip_actions": 9.317859483248267e-06, "remove_single_ts_time_rank_from_batch": 6.857237802437527e-07, "un_batch_to_individual_items": 5.3552950207674884e-06, "listify_data_for_vector_env": 1.074288761109345e-05}}, "connector_pipeline_timer": 9.92709577275332e-05}, "episode_len_max": 20, "env_step_timer": 1.3657348048603372e-05, "episode_len_min": 20, "episode_return_min": -16.5, "num_episodes_lifetime": 340, "num_module_steps_sampled_lifetime": {"default_policy": 6800}, "sample": 0.11570203115523525, "rlmodule_inference_timer": 2.662674502826611e-05, "env_to_module_sum_episodes_length_in": 10.368238394574323, "module_episode_returns_mean": {"default_policy": 1.55}, "env_reset_timer": 0.0002478127260303832, "num_agent_steps_sampled_lifetime": {"default_agent": 6800}, "weights_seq_no": 17.0, "num_module_steps_sampled": {"default_policy": 400}, "episode_len_mean": 20.0, "num_env_steps_sampled": 400, "episode_duration_sec_mean": 0.004728059624321759, "episode_return_max": 12.5, "episode_return_mean": 1.55, "env_to_module_sum_episodes_length_out": 10.368238394574323, "num_episodes": 20, "num_agent_steps_sampled": {"default_agent": 400}, "num_env_steps_sampled_lifetime": 85400, "time_between_sampling": 1.8178604604240078}, "num_healthy_workers": 1, "actor_manager_num_outstanding_async_reqs": 0, "num_remote_worker_restarts": 0}, "num_env_steps_sampled_lifetime": -9252500.0, "fault_tolerance": {"num_healthy_workers": 0, "num_remote_worker_restarts": 0}, "env_runner_group": {"actor_manager_num_outstanding_async_reqs": 0}, "done": false, "training_iteration": 17, "trial_id": "4dd64_00000", "date": "2025-08-11_19-22-47", "timestamp": 1754932967, "time_this_iter_s": 1.785902976989746, "time_total_s": 30.580856800079346, "pid": 14353, "hostname": "Mac", "node_ip": "127.0.0.1", "config": {"exploration_config": {}, "extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "placement_strategy": "PACK", "num_gpus": 0, "_fake_gpus": false, "num_cpus_for_main_process": 2, "eager_tracing": true, "eager_max_retraces": 20, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "torch_compile_learner": false, "torch_compile_learner_what_to_compile": "forward_train", "torch_compile_learner_dynamo_backend": "aot_eager", "torch_compile_learner_dynamo_mode": null, "torch_compile_worker": false, "torch_compile_worker_dynamo_backend": "aot_eager", "torch_compile_worker_dynamo_mode": null, "torch_ddp_kwargs": {}, "torch_skip_nan_gradients": false, "env": "Umbrella", "env_config": {}, "observation_space": null, "action_space": null, "clip_rewards": null, "normalize_actions": true, "clip_actions": false, "_is_atari": null, "disable_env_checking": false, "render_env": false, "action_mask_key": "action_mask", "env_runner_cls": null, "num_env_runners": 0, "create_local_env_runner": true, "num_envs_per_env_runner": 1, "gym_env_vectorize_mode": "SYNC", "num_cpus_per_env_runner": 1, "num_gpus_per_env_runner": 0, "custom_resources_per_env_runner": {}, "validate_env_runners_after_construction": true, "episodes_to_numpy": true, "max_requests_in_flight_per_env_runner": 1, "sample_timeout_s": 60.0, "_env_to_module_connector": null, "add_default_connectors_to_env_to_module_pipeline": true, "_module_to_env_connector": null, "add_default_connectors_to_module_to_env_pipeline": true, "merge_env_runner_states": "training_only", "broadcast_env_runner_states": true, "episode_lookback_horizon": 1, "rollout_fragment_length": "auto", "batch_mode": "complete_episodes", "compress_observations": false, "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "enable_tf1_exec_eagerly": false, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "preprocessor_pref": "deepmind", "observation_filter": "NoFilter", "update_worker_filter_stats": true, "use_worker_filter_stats": true, "sampler_perf_stats_ema_coef": null, "_is_online": true, "num_learners": 0, "num_gpus_per_learner": 0, "num_cpus_per_learner": "auto", "num_aggregator_actors_per_learner": 0, "max_requests_in_flight_per_aggregator_actor": 3, "local_gpu_idx": 0, "max_requests_in_flight_per_learner": 3, "gamma": 1, "lr": 0.0002847858517, "grad_clip": 0.5, "grad_clip_by": "global_norm", "_train_batch_size_per_learner": 5000, "train_batch_size": 4000, "num_epochs": 1, "minibatch_size": 1000, "shuffle_batch_per_epoch": true, "model": {"fcnet_hiddens": [256, 256], "fcnet_activation": "tanh", "fcnet_weights_initializer": null, "fcnet_weights_initializer_config": null, "fcnet_bias_initializer": null, "fcnet_bias_initializer_config": null, "conv_filters": null, "conv_activation": "relu", "conv_kernel_initializer": null, "conv_kernel_initializer_config": null, "conv_bias_initializer": null, "conv_bias_initializer_config": null, "conv_transpose_kernel_initializer": null, "conv_transpose_kernel_initializer_config": null, "conv_transpose_bias_initializer": null, "conv_transpose_bias_initializer_config": null, "post_fcnet_hiddens": [], "post_fcnet_activation": "relu", "post_fcnet_weights_initializer": null, "post_fcnet_weights_initializer_config": null, "post_fcnet_bias_initializer": null, "post_fcnet_bias_initializer_config": null, "free_log_std": false, "log_std_clip_param": 20.0, "no_final_linear": false, "vf_share_layers": false, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "lstm_weights_initializer": null, "lstm_weights_initializer_config": null, "lstm_bias_initializer": null, "lstm_bias_initializer_config": null, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "attention_use_n_prev_actions": 0, "attention_use_n_prev_rewards": 0, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": null, "custom_model_config": {}, "custom_action_dist": null, "custom_preprocessor": null, "encoder_latent_dim": null, "always_check_shapes": false, "lstm_use_prev_action_reward": -1, "_use_default_native_models": -1, "_disable_preprocessor_api": false, "_disable_action_flattening": false}, "_learner_connector": null, "add_default_connectors_to_learner_pipeline": true, "learner_config_dict": {}, "optimizer": {}, "_learner_class": null, "callbacks_on_algorithm_init": null, "callbacks_on_env_runners_recreated": null, "callbacks_on_offline_eval_runners_recreated": null, "callbacks_on_checkpoint_loaded": null, "callbacks_on_environment_created": null, "callbacks_on_episode_created": null, "callbacks_on_episode_start": null, "callbacks_on_episode_step": null, "callbacks_on_episode_end": null, "callbacks_on_evaluate_start": null, "callbacks_on_evaluate_end": null, "callbacks_on_evaluate_offline_start": null, "callbacks_on_evaluate_offline_end": null, "callbacks_on_sample_end": null, "callbacks_on_train_result": null, "explore": true, "enable_rl_module_and_learner": true, "enable_env_runner_and_connector_v2": true, "_prior_exploration_config": {"type": "StochasticSampling"}, "count_steps_by": "env_steps", "policy_map_capacity": 100, "policy_mapping_fn": "<function AlgorithmConfig.DEFAULT_POLICY_MAPPING_FN at 0x3834118a0>", "policies_to_train": null, "policy_states_are_swappable": false, "observation_fn": null, "offline_data_class": null, "input_read_method": "read_parquet", "input_read_method_kwargs": {}, "input_read_schema": {}, "input_read_episodes": false, "input_read_sample_batches": false, "input_read_batch_size": null, "input_filesystem": null, "input_filesystem_kwargs": {}, "input_compress_columns": ["obs", "new_obs"], "input_spaces_jsonable": true, "materialize_data": false, "materialize_mapped_data": true, "map_batches_kwargs": {}, "iter_batches_kwargs": {}, "ignore_final_observation": false, "prelearner_class": null, "prelearner_buffer_class": null, "prelearner_buffer_kwargs": {}, "prelearner_module_synch_period": 10, "dataset_num_iters_per_learner": null, "input_config": {}, "actions_in_input_normalized": false, "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_config": {}, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "output_max_rows_per_file": null, "output_write_remaining_data": false, "output_write_method": "write_parquet", "output_write_method_kwargs": {}, "output_filesystem": null, "output_filesystem_kwargs": {}, "output_write_episodes": true, "offline_sampling": false, "evaluation_interval": 1, "evaluation_duration": 20, "evaluation_duration_unit": "episodes", "evaluation_sample_timeout_s": 120.0, "evaluation_auto_duration_min_env_steps_per_sample": 100, "evaluation_auto_duration_max_env_steps_per_sample": 2000, "evaluation_parallel_to_training": false, "evaluation_force_reset_envs_before_iteration": true, "evaluation_config": null, "off_policy_estimation_methods": {}, "ope_split_batch_by_episode": true, "evaluation_num_env_runners": 1, "in_evaluation": false, "sync_filters_on_rollout_workers_timeout_s": 10.0, "offline_evaluation_interval": null, "num_offline_eval_runners": 0, "offline_loss_for_module_fn": null, "offline_evaluation_duration": 1, "offline_evaluation_parallel_to_training": false, "offline_evaluation_timeout_s": 120.0, "num_cpus_per_offline_eval_runner": 1, "num_gpus_per_offline_eval_runner": 0, "custom_resources_per_offline_eval_runner": {}, "restart_failed_offline_eval_runners": true, "ignore_offline_eval_runner_failures": false, "max_num_offline_eval_runner_restarts": 1000, "offline_eval_runner_restore_timeout_s": 1800.0, "max_requests_in_flight_per_offline_eval_runner": 1, "validate_offline_eval_runners_after_construction": true, "offline_eval_runner_health_probe_timeout_s": 30.0, "offline_eval_rl_module_inference_only": false, "broadcast_offline_eval_runner_states": false, "offline_eval_batch_size_per_runner": 256, "dataset_num_iters_per_eval_runner": 1, "keep_per_episode_custom_metrics": false, "metrics_episode_collection_timeout_s": 60.0, "metrics_num_episodes_for_smoothing": 100, "min_time_s_per_iteration": null, "min_train_timesteps_per_iteration": 0, "min_sample_timesteps_per_iteration": 0, "log_gradients": true, "export_native_model_files": false, "checkpoint_trainable_policies_only": false, "logger_creator": null, "logger_config": null, "log_level": "WARN", "log_sys_usage": true, "fake_sampler": false, "seed": 4, "restart_failed_env_runners": true, "ignore_env_runner_failures": false, "max_num_env_runner_restarts": 1000, "delay_between_env_runner_restarts_s": 60.0, "restart_failed_sub_environments": false, "num_consecutive_env_runner_failures_tolerance": 100, "env_runner_health_probe_timeout_s": 30.0, "env_runner_restore_timeout_s": 1800.0, "_model_config": {}, "_rl_module_spec": "RLModuleSpec(module_class=None, observation_space=None, action_space=None, inference_only=False, learner_only=False, model_config=DefaultModelConfig(fcnet_hiddens=[60, 90], fcnet_activation='tanh', fcnet_kernel_initializer=None, fcnet_kernel_initializer_kwargs=None, fcnet_bias_initializer=None, fcnet_bias_initializer_kwargs=None, conv_filters=None, conv_activation='relu', conv_kernel_initializer=None, conv_kernel_initializer_kwargs=None, conv_bias_initializer=None, conv_bias_initializer_kwargs=None, head_fcnet_hiddens=[], head_fcnet_activation='relu', head_fcnet_kernel_initializer=None, head_fcnet_kernel_initializer_kwargs=None, head_fcnet_bias_initializer=None, head_fcnet_bias_initializer_kwargs=None, free_log_std=False, log_std_clip_param=20.0, vf_share_layers=True, use_lstm=False, max_seq_len=20, lstm_cell_size=256, lstm_use_prev_action=False, lstm_use_prev_reward=False, lstm_kernel_initializer=None, lstm_kernel_initializer_kwargs=None, lstm_bias_initializer=None, lstm_bias_initializer_kwargs=None), catalog_class=None, load_state_path=None, model_config_dict=None)", "algorithm_config_overrides_per_module": {}, "_per_module_overrides": {}, "_validate_config": true, "_use_msgpack_checkpoints": false, "_torch_grad_scaler_class": null, "_torch_lr_scheduler_classes": null, "_tf_policy_handles_more_than_one_loss": false, "_disable_preprocessor_api": false, "_disable_action_flattening": false, "_disable_initialize_loss_from_dummy_batch": false, "_dont_auto_sync_env_runner_states": false, "env_task_fn": -1, "enable_connectors": -1, "simple_optimizer": false, "policy_map_cache": -1, "worker_cls": -1, "synchronize_filters": -1, "enable_async_evaluation": -1, "custom_async_evaluation_function": -1, "_enable_rl_module_api": -1, "auto_wrap_old_gym_envs": -1, "always_attach_evaluation_results": -1, "replay_sequence_length": null, "_disable_execution_plan_api": -1, "use_critic": true, "use_gae": true, "use_kl_loss": true, "kl_coeff": 0.7464963036515, "kl_target": 0.0270990929592, "vf_loss_coeff": 0.6688075857018, "entropy_coeff": 0.0090570820258, "clip_param": 0.1221781641624, "vf_clip_param": 0.1027808522125, "entropy_coeff_schedule": null, "lr_schedule": null, "sgd_minibatch_size": -1, "vf_share_layers": -1, "__stdout_file__": null, "__stderr_file__": null, "lambda": 0.9099046732075, "input": "sampler", "policies": {"default_policy": [null, null, null, null]}, "callbacks": "<class 'ray.rllib.callbacks.callbacks.RLlibCallback'>", "create_env_on_driver": false, "custom_eval_function": null, "framework": "torch"}, "time_since_restore": 30.580856800079346, "iterations_since_restore": 17, "perf": {"cpu_util_percent": 48.15, "ram_util_percent": 80.55}}
{"timers": {"training_iteration": 1.8817427154750908, "restore_env_runners": 9.357689212183896e-06, "training_step": 1.8815608271134519, "env_runner_sampling_timer": 1.7556241030730773, "learner_update_timer": 0.12205604203925566, "synch_weights": 0.0009936791787528297, "restore_eval_env_runners": 8.823693105277882e-06, "evaluation_iteration": 0.12383468471366235, "synch_eval_env_connectors": 0.00012693830582904083, "synch_env_connectors": 5.236853117126495e-06}, "env_runners": {"env_reset_timer": 4.1336707034573736e-05, "num_env_steps_sampled": 5000.0, "num_agent_steps_sampled_lifetime": {"default_agent": -9870000.0}, "episode_duration_sec_mean": 0.004975981992669403, "time_between_sampling": 0.0016370594360854511, "module_to_env_connector": {"timers": {"connectors": {"tensor_to_numpy": 1.4519093932956434e-05, "normalize_and_clip_actions": 1.008330305658938e-05, "listify_data_for_vector_env": 1.1904956268520273e-05, "un_batch_to_individual_items": 5.785751934392623e-06, "get_actions": 4.442118718516129e-05, "remove_single_ts_time_rank_from_batch": 6.241097388840653e-07}}, "connector_pipeline_timer": 0.00011443815640174865}, "sample": 0.0053519408453031195, "episode_return_max": 12.5, "num_env_steps_sampled_lifetime": -9870000.0, "agent_episode_returns_mean": {"default_agent": 10.980000000000002}, "env_to_module_connector": {"timers": {"connectors": {"add_states_from_episodes_to_batch": 1.9107617014775143e-06, "add_observations_from_episodes_to_batch": 3.1305417902481126e-06, "numpy_to_tensor": 9.593416011018578e-06, "batch_individual_items": 6.736662414903247e-06, "add_time_dim_to_batch_and_zero_pad": 2.745882649306652e-06}}, "connector_pipeline_timer": 4.6866992792391186e-05}, "episode_len_max": 20, "episode_return_mean": 10.980000000000002, "weights_seq_no": 17.0, "rlmodule_inference_timer": 3.0955947502605866e-05, "env_to_module_sum_episodes_length_in": 10.36823839457432, "env_step_timer": 1.5075400800827091e-05, "num_module_steps_sampled": {"default_policy": 5000.0}, "episode_len_min": 20, "episode_len_mean": 20.0, "num_episodes": 250.0, "episode_return_min": -7.5, "num_module_steps_sampled_lifetime": {"default_policy": -9870000.0}, "module_episode_returns_mean": {"default_policy": 10.980000000000002}, "num_agent_steps_sampled": {"default_agent": 5000.0}, "num_episodes_lifetime": -493500.0, "env_to_module_sum_episodes_length_out": 10.36823839457432, "num_env_steps_sampled_lifetime_throughput": 3467.2357577308494}, "learners": {"default_policy": {"num_module_steps_trained": 6000, "gradients_default_optimizer_global_norm": 0.10874442011117935, "vf_explained_var": 0.015502631664276123, "num_module_steps_trained_lifetime": 108000, "policy_loss": -0.10068020969629288, "num_trainable_parameters": 6003, "entropy": 0.36843931674957275, "weights_seq_no": 18.0, "curr_entropy_coeff": 0.0090570820258, "module_train_batch_size_mean": 1000.0, "total_loss": -0.03549296036362648, "default_optimizer_learning_rate": 0.0002847858517, "vf_loss": 0.10245733708143234, "curr_kl_coeff": 2.847657469828846e-06, "mean_kl_loss": 0.0005068923346698284, "vf_loss_unclipped": 28.66659927368164, "diff_num_grad_updates_vs_sampler_policy": 1.0, "num_module_steps_trained_lifetime_throughput": 364283.8525748491}, "__all_modules__": {"num_env_steps_trained_lifetime": 567000, "learner_connector_sum_episodes_length_in": 5000.0, "learner_connector_sum_episodes_length_out": 5250.0, "num_module_steps_trained": 6000, "num_env_steps_trained": 31500, "learner_connector": {"timers": {"connectors": {"add_states_from_episodes_to_batch": 3.99714941912742e-06, "general_advantage_estimation": 0.008048941975588099, "add_observations_from_episodes_to_batch": 0.0008949029438371466, "add_time_dim_to_batch_and_zero_pad": 1.3239043151975686e-05, "add_one_ts_to_episodes_and_truncate": 0.00982086407631377, "numpy_to_tensor": 7.412488076386158e-05, "batch_individual_items": 0.03787554348201628, "add_columns_from_episodes_to_train_batch": 0.03776128205284331}}, "connector_pipeline_timer": 0.09465179221186343}, "num_module_steps_trained_lifetime": 108000, "num_trainable_parameters": 6003, "num_non_trainable_parameters": 0, "num_env_steps_trained_lifetime_throughput": 1887103.545362177, "num_module_steps_trained_throughput": 360732.72995792225, "num_module_steps_trained_lifetime_throughput": 359986.7566561211}}, "num_training_step_calls_per_iteration": 1, "evaluation": {"env_runners": {"agent_episode_returns_mean": {"default_agent": 2.15}, "env_to_module_connector": {"timers": {"connectors": {"numpy_to_tensor": 9.106358276991607e-06, "batch_individual_items": 6.57573899510058e-06, "add_observations_from_episodes_to_batch": 2.915990597086068e-06, "add_time_dim_to_batch_and_zero_pad": 2.387856555230241e-06, "add_states_from_episodes_to_batch": 1.6278462390683499e-06}}, "connector_pipeline_timer": 4.488276853225398e-05}, "module_to_env_connector": {"timers": {"connectors": {"get_actions": 4.169976095143654e-05, "tensor_to_numpy": 1.3941151781810976e-05, "normalize_and_clip_actions": 1.0232919526939837e-05, "remove_single_ts_time_rank_from_batch": 6.620203713861682e-07, "un_batch_to_individual_items": 5.69277559029726e-06, "listify_data_for_vector_env": 1.1578437881674132e-05}}, "connector_pipeline_timer": 0.00011066881996946889}, "episode_len_max": 20, "env_step_timer": 1.528615941359786e-05, "episode_len_min": 20, "episode_return_min": -16.5, "num_episodes_lifetime": 360, "num_module_steps_sampled_lifetime": {"default_policy": 7200}, "sample": 0.11557616792353416, "rlmodule_inference_timer": 3.027033739470347e-05, "env_to_module_sum_episodes_length_in": 10.368238394574323, "module_episode_returns_mean": {"default_policy": 2.15}, "env_reset_timer": 0.0002460758488845948, "num_agent_steps_sampled_lifetime": {"default_agent": 7200}, "weights_seq_no": 18.0, "num_module_steps_sampled": {"default_policy": 400}, "episode_len_mean": 20.0, "num_env_steps_sampled": 400, "episode_duration_sec_mean": 0.0048038658208679405, "episode_return_max": 12.5, "episode_return_mean": 2.15, "env_to_module_sum_episodes_length_out": 10.368238394574323, "num_episodes": 20, "num_agent_steps_sampled": {"default_agent": 400}, "num_env_steps_sampled_lifetime": 90400, "time_between_sampling": 1.8167856870697554}, "num_healthy_workers": 1, "actor_manager_num_outstanding_async_reqs": 0, "num_remote_worker_restarts": 0}, "num_env_steps_sampled_lifetime": -9870000.0, "fault_tolerance": {"num_healthy_workers": 0, "num_remote_worker_restarts": 0}, "env_runner_group": {"actor_manager_num_outstanding_async_reqs": 0}, "done": false, "training_iteration": 18, "trial_id": "4dd64_00000", "date": "2025-08-11_19-22-48", "timestamp": 1754932968, "time_this_iter_s": 1.8019556999206543, "time_total_s": 32.3828125, "pid": 14353, "hostname": "Mac", "node_ip": "127.0.0.1", "config": {"exploration_config": {}, "extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "placement_strategy": "PACK", "num_gpus": 0, "_fake_gpus": false, "num_cpus_for_main_process": 2, "eager_tracing": true, "eager_max_retraces": 20, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "torch_compile_learner": false, "torch_compile_learner_what_to_compile": "forward_train", "torch_compile_learner_dynamo_backend": "aot_eager", "torch_compile_learner_dynamo_mode": null, "torch_compile_worker": false, "torch_compile_worker_dynamo_backend": "aot_eager", "torch_compile_worker_dynamo_mode": null, "torch_ddp_kwargs": {}, "torch_skip_nan_gradients": false, "env": "Umbrella", "env_config": {}, "observation_space": null, "action_space": null, "clip_rewards": null, "normalize_actions": true, "clip_actions": false, "_is_atari": null, "disable_env_checking": false, "render_env": false, "action_mask_key": "action_mask", "env_runner_cls": null, "num_env_runners": 0, "create_local_env_runner": true, "num_envs_per_env_runner": 1, "gym_env_vectorize_mode": "SYNC", "num_cpus_per_env_runner": 1, "num_gpus_per_env_runner": 0, "custom_resources_per_env_runner": {}, "validate_env_runners_after_construction": true, "episodes_to_numpy": true, "max_requests_in_flight_per_env_runner": 1, "sample_timeout_s": 60.0, "_env_to_module_connector": null, "add_default_connectors_to_env_to_module_pipeline": true, "_module_to_env_connector": null, "add_default_connectors_to_module_to_env_pipeline": true, "merge_env_runner_states": "training_only", "broadcast_env_runner_states": true, "episode_lookback_horizon": 1, "rollout_fragment_length": "auto", "batch_mode": "complete_episodes", "compress_observations": false, "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "enable_tf1_exec_eagerly": false, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "preprocessor_pref": "deepmind", "observation_filter": "NoFilter", "update_worker_filter_stats": true, "use_worker_filter_stats": true, "sampler_perf_stats_ema_coef": null, "_is_online": true, "num_learners": 0, "num_gpus_per_learner": 0, "num_cpus_per_learner": "auto", "num_aggregator_actors_per_learner": 0, "max_requests_in_flight_per_aggregator_actor": 3, "local_gpu_idx": 0, "max_requests_in_flight_per_learner": 3, "gamma": 1, "lr": 0.0002847858517, "grad_clip": 0.5, "grad_clip_by": "global_norm", "_train_batch_size_per_learner": 5000, "train_batch_size": 4000, "num_epochs": 1, "minibatch_size": 1000, "shuffle_batch_per_epoch": true, "model": {"fcnet_hiddens": [256, 256], "fcnet_activation": "tanh", "fcnet_weights_initializer": null, "fcnet_weights_initializer_config": null, "fcnet_bias_initializer": null, "fcnet_bias_initializer_config": null, "conv_filters": null, "conv_activation": "relu", "conv_kernel_initializer": null, "conv_kernel_initializer_config": null, "conv_bias_initializer": null, "conv_bias_initializer_config": null, "conv_transpose_kernel_initializer": null, "conv_transpose_kernel_initializer_config": null, "conv_transpose_bias_initializer": null, "conv_transpose_bias_initializer_config": null, "post_fcnet_hiddens": [], "post_fcnet_activation": "relu", "post_fcnet_weights_initializer": null, "post_fcnet_weights_initializer_config": null, "post_fcnet_bias_initializer": null, "post_fcnet_bias_initializer_config": null, "free_log_std": false, "log_std_clip_param": 20.0, "no_final_linear": false, "vf_share_layers": false, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "lstm_weights_initializer": null, "lstm_weights_initializer_config": null, "lstm_bias_initializer": null, "lstm_bias_initializer_config": null, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "attention_use_n_prev_actions": 0, "attention_use_n_prev_rewards": 0, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": null, "custom_model_config": {}, "custom_action_dist": null, "custom_preprocessor": null, "encoder_latent_dim": null, "always_check_shapes": false, "lstm_use_prev_action_reward": -1, "_use_default_native_models": -1, "_disable_preprocessor_api": false, "_disable_action_flattening": false}, "_learner_connector": null, "add_default_connectors_to_learner_pipeline": true, "learner_config_dict": {}, "optimizer": {}, "_learner_class": null, "callbacks_on_algorithm_init": null, "callbacks_on_env_runners_recreated": null, "callbacks_on_offline_eval_runners_recreated": null, "callbacks_on_checkpoint_loaded": null, "callbacks_on_environment_created": null, "callbacks_on_episode_created": null, "callbacks_on_episode_start": null, "callbacks_on_episode_step": null, "callbacks_on_episode_end": null, "callbacks_on_evaluate_start": null, "callbacks_on_evaluate_end": null, "callbacks_on_evaluate_offline_start": null, "callbacks_on_evaluate_offline_end": null, "callbacks_on_sample_end": null, "callbacks_on_train_result": null, "explore": true, "enable_rl_module_and_learner": true, "enable_env_runner_and_connector_v2": true, "_prior_exploration_config": {"type": "StochasticSampling"}, "count_steps_by": "env_steps", "policy_map_capacity": 100, "policy_mapping_fn": "<function AlgorithmConfig.DEFAULT_POLICY_MAPPING_FN at 0x3834118a0>", "policies_to_train": null, "policy_states_are_swappable": false, "observation_fn": null, "offline_data_class": null, "input_read_method": "read_parquet", "input_read_method_kwargs": {}, "input_read_schema": {}, "input_read_episodes": false, "input_read_sample_batches": false, "input_read_batch_size": null, "input_filesystem": null, "input_filesystem_kwargs": {}, "input_compress_columns": ["obs", "new_obs"], "input_spaces_jsonable": true, "materialize_data": false, "materialize_mapped_data": true, "map_batches_kwargs": {}, "iter_batches_kwargs": {}, "ignore_final_observation": false, "prelearner_class": null, "prelearner_buffer_class": null, "prelearner_buffer_kwargs": {}, "prelearner_module_synch_period": 10, "dataset_num_iters_per_learner": null, "input_config": {}, "actions_in_input_normalized": false, "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_config": {}, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "output_max_rows_per_file": null, "output_write_remaining_data": false, "output_write_method": "write_parquet", "output_write_method_kwargs": {}, "output_filesystem": null, "output_filesystem_kwargs": {}, "output_write_episodes": true, "offline_sampling": false, "evaluation_interval": 1, "evaluation_duration": 20, "evaluation_duration_unit": "episodes", "evaluation_sample_timeout_s": 120.0, "evaluation_auto_duration_min_env_steps_per_sample": 100, "evaluation_auto_duration_max_env_steps_per_sample": 2000, "evaluation_parallel_to_training": false, "evaluation_force_reset_envs_before_iteration": true, "evaluation_config": null, "off_policy_estimation_methods": {}, "ope_split_batch_by_episode": true, "evaluation_num_env_runners": 1, "in_evaluation": false, "sync_filters_on_rollout_workers_timeout_s": 10.0, "offline_evaluation_interval": null, "num_offline_eval_runners": 0, "offline_loss_for_module_fn": null, "offline_evaluation_duration": 1, "offline_evaluation_parallel_to_training": false, "offline_evaluation_timeout_s": 120.0, "num_cpus_per_offline_eval_runner": 1, "num_gpus_per_offline_eval_runner": 0, "custom_resources_per_offline_eval_runner": {}, "restart_failed_offline_eval_runners": true, "ignore_offline_eval_runner_failures": false, "max_num_offline_eval_runner_restarts": 1000, "offline_eval_runner_restore_timeout_s": 1800.0, "max_requests_in_flight_per_offline_eval_runner": 1, "validate_offline_eval_runners_after_construction": true, "offline_eval_runner_health_probe_timeout_s": 30.0, "offline_eval_rl_module_inference_only": false, "broadcast_offline_eval_runner_states": false, "offline_eval_batch_size_per_runner": 256, "dataset_num_iters_per_eval_runner": 1, "keep_per_episode_custom_metrics": false, "metrics_episode_collection_timeout_s": 60.0, "metrics_num_episodes_for_smoothing": 100, "min_time_s_per_iteration": null, "min_train_timesteps_per_iteration": 0, "min_sample_timesteps_per_iteration": 0, "log_gradients": true, "export_native_model_files": false, "checkpoint_trainable_policies_only": false, "logger_creator": null, "logger_config": null, "log_level": "WARN", "log_sys_usage": true, "fake_sampler": false, "seed": 4, "restart_failed_env_runners": true, "ignore_env_runner_failures": false, "max_num_env_runner_restarts": 1000, "delay_between_env_runner_restarts_s": 60.0, "restart_failed_sub_environments": false, "num_consecutive_env_runner_failures_tolerance": 100, "env_runner_health_probe_timeout_s": 30.0, "env_runner_restore_timeout_s": 1800.0, "_model_config": {}, "_rl_module_spec": "RLModuleSpec(module_class=None, observation_space=None, action_space=None, inference_only=False, learner_only=False, model_config=DefaultModelConfig(fcnet_hiddens=[60, 90], fcnet_activation='tanh', fcnet_kernel_initializer=None, fcnet_kernel_initializer_kwargs=None, fcnet_bias_initializer=None, fcnet_bias_initializer_kwargs=None, conv_filters=None, conv_activation='relu', conv_kernel_initializer=None, conv_kernel_initializer_kwargs=None, conv_bias_initializer=None, conv_bias_initializer_kwargs=None, head_fcnet_hiddens=[], head_fcnet_activation='relu', head_fcnet_kernel_initializer=None, head_fcnet_kernel_initializer_kwargs=None, head_fcnet_bias_initializer=None, head_fcnet_bias_initializer_kwargs=None, free_log_std=False, log_std_clip_param=20.0, vf_share_layers=True, use_lstm=False, max_seq_len=20, lstm_cell_size=256, lstm_use_prev_action=False, lstm_use_prev_reward=False, lstm_kernel_initializer=None, lstm_kernel_initializer_kwargs=None, lstm_bias_initializer=None, lstm_bias_initializer_kwargs=None), catalog_class=None, load_state_path=None, model_config_dict=None)", "algorithm_config_overrides_per_module": {}, "_per_module_overrides": {}, "_validate_config": true, "_use_msgpack_checkpoints": false, "_torch_grad_scaler_class": null, "_torch_lr_scheduler_classes": null, "_tf_policy_handles_more_than_one_loss": false, "_disable_preprocessor_api": false, "_disable_action_flattening": false, "_disable_initialize_loss_from_dummy_batch": false, "_dont_auto_sync_env_runner_states": false, "env_task_fn": -1, "enable_connectors": -1, "simple_optimizer": false, "policy_map_cache": -1, "worker_cls": -1, "synchronize_filters": -1, "enable_async_evaluation": -1, "custom_async_evaluation_function": -1, "_enable_rl_module_api": -1, "auto_wrap_old_gym_envs": -1, "always_attach_evaluation_results": -1, "replay_sequence_length": null, "_disable_execution_plan_api": -1, "use_critic": true, "use_gae": true, "use_kl_loss": true, "kl_coeff": 0.7464963036515, "kl_target": 0.0270990929592, "vf_loss_coeff": 0.6688075857018, "entropy_coeff": 0.0090570820258, "clip_param": 0.1221781641624, "vf_clip_param": 0.1027808522125, "entropy_coeff_schedule": null, "lr_schedule": null, "sgd_minibatch_size": -1, "vf_share_layers": -1, "__stdout_file__": null, "__stderr_file__": null, "lambda": 0.9099046732075, "input": "sampler", "policies": {"default_policy": [null, null, null, null]}, "callbacks": "<class 'ray.rllib.callbacks.callbacks.RLlibCallback'>", "create_env_on_driver": false, "custom_eval_function": null, "framework": "torch"}, "time_since_restore": 32.3828125, "iterations_since_restore": 18, "perf": {"cpu_util_percent": 45.56666666666666, "ram_util_percent": 80.23333333333333}}
{"timers": {"training_iteration": 1.8786428841604454, "restore_env_runners": 9.323692517619864e-06, "training_step": 1.878460919252391, "env_runner_sampling_timer": 1.7519455216220854, "learner_update_timer": 0.12264009328894926, "synch_weights": 0.0009909865562117068, "restore_eval_env_runners": 8.791285470113647e-06, "evaluation_iteration": 0.12367744995655827, "synch_eval_env_connectors": 0.00012664850298872281, "synch_env_connectors": 5.225324245005337e-06}, "env_runners": {"env_reset_timer": 3.849737775716057e-05, "num_env_steps_sampled": 5000.0, "num_agent_steps_sampled_lifetime": {"default_agent": -10487500.0}, "episode_duration_sec_mean": 0.004586110515054315, "time_between_sampling": 0.001861716499002708, "module_to_env_connector": {"timers": {"connectors": {"tensor_to_numpy": 1.3296597385516979e-05, "normalize_and_clip_actions": 9.449992669980545e-06, "listify_data_for_vector_env": 1.1198703102137032e-05, "un_batch_to_individual_items": 5.473422484143905e-06, "get_actions": 3.9031759222111476e-05, "remove_single_ts_time_rank_from_batch": 5.848453489710667e-07}}, "connector_pipeline_timer": 0.00010479288112246391}, "sample": 0.005123196837162018, "episode_return_max": 12.5, "num_env_steps_sampled_lifetime": -10487500.0, "agent_episode_returns_mean": {"default_agent": 10.66}, "env_to_module_connector": {"timers": {"connectors": {"add_states_from_episodes_to_batch": 1.7366042063206632e-06, "add_observations_from_episodes_to_batch": 2.9836056444951795e-06, "numpy_to_tensor": 8.645906469908722e-06, "batch_individual_items": 6.2959447697777976e-06, "add_time_dim_to_batch_and_zero_pad": 2.342476497610231e-06}}, "connector_pipeline_timer": 4.3728701676462565e-05}, "episode_len_max": 20, "episode_return_mean": 10.66, "weights_seq_no": 18.0, "rlmodule_inference_timer": 2.837961185861818e-05, "env_to_module_sum_episodes_length_in": 10.36823839457432, "env_step_timer": 1.3785442549031625e-05, "num_module_steps_sampled": {"default_policy": 5000.0}, "episode_len_min": 20, "episode_len_mean": 20.0, "num_episodes": 250.0, "episode_return_min": -7.5, "num_module_steps_sampled_lifetime": {"default_policy": -10487500.0}, "module_episode_returns_mean": {"default_policy": 10.66}, "num_agent_steps_sampled": {"default_agent": 5000.0}, "num_episodes_lifetime": -524375.0, "env_to_module_sum_episodes_length_out": 10.36823839457432, "num_env_steps_sampled_lifetime_throughput": 3679.5213570387527}, "learners": {"default_policy": {"num_module_steps_trained": 6000, "gradients_default_optimizer_global_norm": 0.07589247077703476, "vf_explained_var": 0.018101215362548828, "num_module_steps_trained_lifetime": 114000, "policy_loss": -0.04904314875602722, "num_trainable_parameters": 6003, "entropy": 0.352801650762558, "weights_seq_no": 19.0, "curr_entropy_coeff": 0.0090570820258, "module_train_batch_size_mean": 1000.0, "total_loss": 0.01614151895046234, "default_optimizer_learning_rate": 0.0002847858517, "vf_loss": 0.10224167257547379, "curr_kl_coeff": 1.423828734914423e-06, "mean_kl_loss": 0.0003655123873613775, "vf_loss_unclipped": 28.553913116455078, "diff_num_grad_updates_vs_sampler_policy": 1.0, "num_module_steps_trained_lifetime_throughput": 366882.36033817317}, "__all_modules__": {"num_env_steps_trained_lifetime": 598500, "learner_connector_sum_episodes_length_in": 5000.0, "learner_connector_sum_episodes_length_out": 5250.0, "num_module_steps_trained": 6000, "num_env_steps_trained": 31500, "learner_connector": {"timers": {"connectors": {"add_states_from_episodes_to_batch": 3.9859278528145256e-06, "general_advantage_estimation": 0.00802046422544564, "add_observations_from_episodes_to_batch": 0.0008945555840865529, "add_time_dim_to_batch_and_zero_pad": 1.3207902618308468e-05, "add_one_ts_to_episodes_and_truncate": 0.009799624595550494, "numpy_to_tensor": 7.406197239497633e-05, "batch_individual_items": 0.03867994554754138, "add_columns_from_episodes_to_train_batch": 0.03772874382261043}}, "connector_pipeline_timer": 0.09537288553946732}, "num_module_steps_trained_lifetime": 114000, "num_trainable_parameters": 6003, "num_non_trainable_parameters": 0, "num_env_steps_trained_lifetime_throughput": 1902133.471933883, "num_module_steps_trained_throughput": 363542.2356491506, "num_module_steps_trained_lifetime_throughput": 362823.7059003843}}, "num_training_step_calls_per_iteration": 1, "evaluation": {"env_runners": {"agent_episode_returns_mean": {"default_agent": 2.75}, "env_to_module_connector": {"timers": {"connectors": {"numpy_to_tensor": 8.055905331869905e-06, "batch_individual_items": 5.987131798847401e-06, "add_observations_from_episodes_to_batch": 2.7513511017009037e-06, "add_time_dim_to_batch_and_zero_pad": 2.203258180697955e-06, "add_states_from_episodes_to_batch": 1.561279815905717e-06}}, "connector_pipeline_timer": 4.171564729434909e-05}, "module_to_env_connector": {"timers": {"connectors": {"get_actions": 3.3870689658222714e-05, "tensor_to_numpy": 1.2498097911430895e-05, "normalize_and_clip_actions": 9.21310310206376e-06, "remove_single_ts_time_rank_from_batch": 6.225791896703098e-07, "un_batch_to_individual_items": 5.305906023338437e-06, "listify_data_for_vector_env": 1.0559226950211789e-05}}, "connector_pipeline_timer": 9.722949118884508e-05}, "episode_len_max": 20, "env_step_timer": 1.3259689242287313e-05, "episode_len_min": 20, "episode_return_min": -16.5, "num_episodes_lifetime": 380, "num_module_steps_sampled_lifetime": {"default_policy": 7600}, "sample": 0.11536772582430803, "rlmodule_inference_timer": 2.6167750069464515e-05, "env_to_module_sum_episodes_length_in": 10.368238394574323, "module_episode_returns_mean": {"default_policy": 2.75}, "env_reset_timer": 0.0002444159300210478, "num_agent_steps_sampled_lifetime": {"default_agent": 7600}, "weights_seq_no": 19.0, "num_module_steps_sampled": {"default_policy": 400}, "episode_len_mean": 20.0, "num_env_steps_sampled": 400, "episode_duration_sec_mean": 0.00480222123907879, "episode_return_max": 12.5, "episode_return_mean": 2.75, "env_to_module_sum_episodes_length_out": 10.368238394574323, "num_episodes": 20, "num_agent_steps_sampled": {"default_agent": 400}, "num_env_steps_sampled_lifetime": 95400, "time_between_sampling": 1.8145155710290266}, "num_healthy_workers": 1, "actor_manager_num_outstanding_async_reqs": 0, "num_remote_worker_restarts": 0}, "num_env_steps_sampled_lifetime": -10487500.0, "fault_tolerance": {"num_healthy_workers": 0, "num_remote_worker_restarts": 0}, "env_runner_group": {"actor_manager_num_outstanding_async_reqs": 0}, "done": false, "training_iteration": 19, "trial_id": "4dd64_00000", "date": "2025-08-11_19-22-50", "timestamp": 1754932970, "time_this_iter_s": 1.6739280223846436, "time_total_s": 34.056740522384644, "pid": 14353, "hostname": "Mac", "node_ip": "127.0.0.1", "config": {"exploration_config": {}, "extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "placement_strategy": "PACK", "num_gpus": 0, "_fake_gpus": false, "num_cpus_for_main_process": 2, "eager_tracing": true, "eager_max_retraces": 20, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "torch_compile_learner": false, "torch_compile_learner_what_to_compile": "forward_train", "torch_compile_learner_dynamo_backend": "aot_eager", "torch_compile_learner_dynamo_mode": null, "torch_compile_worker": false, "torch_compile_worker_dynamo_backend": "aot_eager", "torch_compile_worker_dynamo_mode": null, "torch_ddp_kwargs": {}, "torch_skip_nan_gradients": false, "env": "Umbrella", "env_config": {}, "observation_space": null, "action_space": null, "clip_rewards": null, "normalize_actions": true, "clip_actions": false, "_is_atari": null, "disable_env_checking": false, "render_env": false, "action_mask_key": "action_mask", "env_runner_cls": null, "num_env_runners": 0, "create_local_env_runner": true, "num_envs_per_env_runner": 1, "gym_env_vectorize_mode": "SYNC", "num_cpus_per_env_runner": 1, "num_gpus_per_env_runner": 0, "custom_resources_per_env_runner": {}, "validate_env_runners_after_construction": true, "episodes_to_numpy": true, "max_requests_in_flight_per_env_runner": 1, "sample_timeout_s": 60.0, "_env_to_module_connector": null, "add_default_connectors_to_env_to_module_pipeline": true, "_module_to_env_connector": null, "add_default_connectors_to_module_to_env_pipeline": true, "merge_env_runner_states": "training_only", "broadcast_env_runner_states": true, "episode_lookback_horizon": 1, "rollout_fragment_length": "auto", "batch_mode": "complete_episodes", "compress_observations": false, "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "enable_tf1_exec_eagerly": false, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "preprocessor_pref": "deepmind", "observation_filter": "NoFilter", "update_worker_filter_stats": true, "use_worker_filter_stats": true, "sampler_perf_stats_ema_coef": null, "_is_online": true, "num_learners": 0, "num_gpus_per_learner": 0, "num_cpus_per_learner": "auto", "num_aggregator_actors_per_learner": 0, "max_requests_in_flight_per_aggregator_actor": 3, "local_gpu_idx": 0, "max_requests_in_flight_per_learner": 3, "gamma": 1, "lr": 0.0002847858517, "grad_clip": 0.5, "grad_clip_by": "global_norm", "_train_batch_size_per_learner": 5000, "train_batch_size": 4000, "num_epochs": 1, "minibatch_size": 1000, "shuffle_batch_per_epoch": true, "model": {"fcnet_hiddens": [256, 256], "fcnet_activation": "tanh", "fcnet_weights_initializer": null, "fcnet_weights_initializer_config": null, "fcnet_bias_initializer": null, "fcnet_bias_initializer_config": null, "conv_filters": null, "conv_activation": "relu", "conv_kernel_initializer": null, "conv_kernel_initializer_config": null, "conv_bias_initializer": null, "conv_bias_initializer_config": null, "conv_transpose_kernel_initializer": null, "conv_transpose_kernel_initializer_config": null, "conv_transpose_bias_initializer": null, "conv_transpose_bias_initializer_config": null, "post_fcnet_hiddens": [], "post_fcnet_activation": "relu", "post_fcnet_weights_initializer": null, "post_fcnet_weights_initializer_config": null, "post_fcnet_bias_initializer": null, "post_fcnet_bias_initializer_config": null, "free_log_std": false, "log_std_clip_param": 20.0, "no_final_linear": false, "vf_share_layers": false, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "lstm_weights_initializer": null, "lstm_weights_initializer_config": null, "lstm_bias_initializer": null, "lstm_bias_initializer_config": null, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "attention_use_n_prev_actions": 0, "attention_use_n_prev_rewards": 0, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": null, "custom_model_config": {}, "custom_action_dist": null, "custom_preprocessor": null, "encoder_latent_dim": null, "always_check_shapes": false, "lstm_use_prev_action_reward": -1, "_use_default_native_models": -1, "_disable_preprocessor_api": false, "_disable_action_flattening": false}, "_learner_connector": null, "add_default_connectors_to_learner_pipeline": true, "learner_config_dict": {}, "optimizer": {}, "_learner_class": null, "callbacks_on_algorithm_init": null, "callbacks_on_env_runners_recreated": null, "callbacks_on_offline_eval_runners_recreated": null, "callbacks_on_checkpoint_loaded": null, "callbacks_on_environment_created": null, "callbacks_on_episode_created": null, "callbacks_on_episode_start": null, "callbacks_on_episode_step": null, "callbacks_on_episode_end": null, "callbacks_on_evaluate_start": null, "callbacks_on_evaluate_end": null, "callbacks_on_evaluate_offline_start": null, "callbacks_on_evaluate_offline_end": null, "callbacks_on_sample_end": null, "callbacks_on_train_result": null, "explore": true, "enable_rl_module_and_learner": true, "enable_env_runner_and_connector_v2": true, "_prior_exploration_config": {"type": "StochasticSampling"}, "count_steps_by": "env_steps", "policy_map_capacity": 100, "policy_mapping_fn": "<function AlgorithmConfig.DEFAULT_POLICY_MAPPING_FN at 0x3834118a0>", "policies_to_train": null, "policy_states_are_swappable": false, "observation_fn": null, "offline_data_class": null, "input_read_method": "read_parquet", "input_read_method_kwargs": {}, "input_read_schema": {}, "input_read_episodes": false, "input_read_sample_batches": false, "input_read_batch_size": null, "input_filesystem": null, "input_filesystem_kwargs": {}, "input_compress_columns": ["obs", "new_obs"], "input_spaces_jsonable": true, "materialize_data": false, "materialize_mapped_data": true, "map_batches_kwargs": {}, "iter_batches_kwargs": {}, "ignore_final_observation": false, "prelearner_class": null, "prelearner_buffer_class": null, "prelearner_buffer_kwargs": {}, "prelearner_module_synch_period": 10, "dataset_num_iters_per_learner": null, "input_config": {}, "actions_in_input_normalized": false, "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_config": {}, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "output_max_rows_per_file": null, "output_write_remaining_data": false, "output_write_method": "write_parquet", "output_write_method_kwargs": {}, "output_filesystem": null, "output_filesystem_kwargs": {}, "output_write_episodes": true, "offline_sampling": false, "evaluation_interval": 1, "evaluation_duration": 20, "evaluation_duration_unit": "episodes", "evaluation_sample_timeout_s": 120.0, "evaluation_auto_duration_min_env_steps_per_sample": 100, "evaluation_auto_duration_max_env_steps_per_sample": 2000, "evaluation_parallel_to_training": false, "evaluation_force_reset_envs_before_iteration": true, "evaluation_config": null, "off_policy_estimation_methods": {}, "ope_split_batch_by_episode": true, "evaluation_num_env_runners": 1, "in_evaluation": false, "sync_filters_on_rollout_workers_timeout_s": 10.0, "offline_evaluation_interval": null, "num_offline_eval_runners": 0, "offline_loss_for_module_fn": null, "offline_evaluation_duration": 1, "offline_evaluation_parallel_to_training": false, "offline_evaluation_timeout_s": 120.0, "num_cpus_per_offline_eval_runner": 1, "num_gpus_per_offline_eval_runner": 0, "custom_resources_per_offline_eval_runner": {}, "restart_failed_offline_eval_runners": true, "ignore_offline_eval_runner_failures": false, "max_num_offline_eval_runner_restarts": 1000, "offline_eval_runner_restore_timeout_s": 1800.0, "max_requests_in_flight_per_offline_eval_runner": 1, "validate_offline_eval_runners_after_construction": true, "offline_eval_runner_health_probe_timeout_s": 30.0, "offline_eval_rl_module_inference_only": false, "broadcast_offline_eval_runner_states": false, "offline_eval_batch_size_per_runner": 256, "dataset_num_iters_per_eval_runner": 1, "keep_per_episode_custom_metrics": false, "metrics_episode_collection_timeout_s": 60.0, "metrics_num_episodes_for_smoothing": 100, "min_time_s_per_iteration": null, "min_train_timesteps_per_iteration": 0, "min_sample_timesteps_per_iteration": 0, "log_gradients": true, "export_native_model_files": false, "checkpoint_trainable_policies_only": false, "logger_creator": null, "logger_config": null, "log_level": "WARN", "log_sys_usage": true, "fake_sampler": false, "seed": 4, "restart_failed_env_runners": true, "ignore_env_runner_failures": false, "max_num_env_runner_restarts": 1000, "delay_between_env_runner_restarts_s": 60.0, "restart_failed_sub_environments": false, "num_consecutive_env_runner_failures_tolerance": 100, "env_runner_health_probe_timeout_s": 30.0, "env_runner_restore_timeout_s": 1800.0, "_model_config": {}, "_rl_module_spec": "RLModuleSpec(module_class=None, observation_space=None, action_space=None, inference_only=False, learner_only=False, model_config=DefaultModelConfig(fcnet_hiddens=[60, 90], fcnet_activation='tanh', fcnet_kernel_initializer=None, fcnet_kernel_initializer_kwargs=None, fcnet_bias_initializer=None, fcnet_bias_initializer_kwargs=None, conv_filters=None, conv_activation='relu', conv_kernel_initializer=None, conv_kernel_initializer_kwargs=None, conv_bias_initializer=None, conv_bias_initializer_kwargs=None, head_fcnet_hiddens=[], head_fcnet_activation='relu', head_fcnet_kernel_initializer=None, head_fcnet_kernel_initializer_kwargs=None, head_fcnet_bias_initializer=None, head_fcnet_bias_initializer_kwargs=None, free_log_std=False, log_std_clip_param=20.0, vf_share_layers=True, use_lstm=False, max_seq_len=20, lstm_cell_size=256, lstm_use_prev_action=False, lstm_use_prev_reward=False, lstm_kernel_initializer=None, lstm_kernel_initializer_kwargs=None, lstm_bias_initializer=None, lstm_bias_initializer_kwargs=None), catalog_class=None, load_state_path=None, model_config_dict=None)", "algorithm_config_overrides_per_module": {}, "_per_module_overrides": {}, "_validate_config": true, "_use_msgpack_checkpoints": false, "_torch_grad_scaler_class": null, "_torch_lr_scheduler_classes": null, "_tf_policy_handles_more_than_one_loss": false, "_disable_preprocessor_api": false, "_disable_action_flattening": false, "_disable_initialize_loss_from_dummy_batch": false, "_dont_auto_sync_env_runner_states": false, "env_task_fn": -1, "enable_connectors": -1, "simple_optimizer": false, "policy_map_cache": -1, "worker_cls": -1, "synchronize_filters": -1, "enable_async_evaluation": -1, "custom_async_evaluation_function": -1, "_enable_rl_module_api": -1, "auto_wrap_old_gym_envs": -1, "always_attach_evaluation_results": -1, "replay_sequence_length": null, "_disable_execution_plan_api": -1, "use_critic": true, "use_gae": true, "use_kl_loss": true, "kl_coeff": 0.7464963036515, "kl_target": 0.0270990929592, "vf_loss_coeff": 0.6688075857018, "entropy_coeff": 0.0090570820258, "clip_param": 0.1221781641624, "vf_clip_param": 0.1027808522125, "entropy_coeff_schedule": null, "lr_schedule": null, "sgd_minibatch_size": -1, "vf_share_layers": -1, "__stdout_file__": null, "__stderr_file__": null, "lambda": 0.9099046732075, "input": "sampler", "policies": {"default_policy": [null, null, null, null]}, "callbacks": "<class 'ray.rllib.callbacks.callbacks.RLlibCallback'>", "create_env_on_driver": false, "custom_eval_function": null, "framework": "torch"}, "time_since_restore": 34.056740522384644, "iterations_since_restore": 19, "perf": {"cpu_util_percent": 42.75, "ram_util_percent": 80.45}}
{"timers": {"training_iteration": 1.8744086719779083, "restore_env_runners": 9.29045488516005e-06, "training_step": 1.8742269792298518, "env_runner_sampling_timer": 1.7480423830759508, "learner_update_timer": 0.12231837901540145, "synch_weights": 0.0009864325207210839, "restore_eval_env_runners": 8.770461601228153e-06, "evaluation_iteration": 0.12343638670699053, "synch_eval_env_connectors": 0.00012646535798899912, "synch_env_connectors": 5.2097406647775495e-06}, "env_runners": {"env_reset_timer": 3.301690055833913e-05, "num_env_steps_sampled": 5000.0, "num_agent_steps_sampled_lifetime": {"default_agent": -11105000.0}, "episode_duration_sec_mean": 0.0044869542941451054, "time_between_sampling": 0.0018262793042672202, "module_to_env_connector": {"timers": {"connectors": {"tensor_to_numpy": 1.2989814143763328e-05, "normalize_and_clip_actions": 9.273924266308677e-06, "listify_data_for_vector_env": 1.0907846897112528e-05, "un_batch_to_individual_items": 5.339846143782764e-06, "get_actions": 3.796522572196136e-05, "remove_single_ts_time_rank_from_batch": 5.783188697991526e-07}}, "connector_pipeline_timer": 0.00010249248733220784}, "sample": 0.004830596509238344, "episode_return_max": 12.5, "num_env_steps_sampled_lifetime": -11105000.0, "agent_episode_returns_mean": {"default_agent": 10.66}, "env_to_module_connector": {"timers": {"connectors": {"add_states_from_episodes_to_batch": 1.70832587828247e-06, "add_observations_from_episodes_to_batch": 2.9193561681478053e-06, "numpy_to_tensor": 8.427130251141216e-06, "batch_individual_items": 6.147256148514245e-06, "add_time_dim_to_batch_and_zero_pad": 2.2838940303873444e-06}}, "connector_pipeline_timer": 4.293168840602139e-05}, "episode_len_max": 20, "episode_return_mean": 10.66, "weights_seq_no": 19.0, "rlmodule_inference_timer": 2.7080466668287345e-05, "env_to_module_sum_episodes_length_in": 10.36823839457432, "env_step_timer": 1.3489021619419966e-05, "num_module_steps_sampled": {"default_policy": 5000.0}, "episode_len_min": 20, "episode_len_mean": 20.0, "num_episodes": 250.0, "episode_return_min": -7.5, "num_module_steps_sampled_lifetime": {"default_policy": -11105000.0}, "module_episode_returns_mean": {"default_policy": 10.66}, "num_agent_steps_sampled": {"default_agent": 5000.0}, "num_episodes_lifetime": -555250.0, "env_to_module_sum_episodes_length_out": 10.36823839457432, "num_env_steps_sampled_lifetime_throughput": 3776.543032828551}, "learners": {"default_policy": {"num_module_steps_trained": 6000, "gradients_default_optimizer_global_norm": 0.03212713077664375, "vf_explained_var": 0.018335282802581787, "num_module_steps_trained_lifetime": 120000, "policy_loss": -0.025547273457050323, "num_trainable_parameters": 6003, "entropy": 0.33666831254959106, "weights_seq_no": 20.0, "curr_entropy_coeff": 0.0090570820258, "module_train_batch_size_mean": 1000.0, "total_loss": 0.03985561802983284, "default_optimizer_learning_rate": 0.0002847858517, "vf_loss": 0.10234948992729187, "curr_kl_coeff": 7.119143674572115e-07, "mean_kl_loss": 0.00021589340758509934, "vf_loss_unclipped": 28.65300178527832, "diff_num_grad_updates_vs_sampler_policy": 1.0, "num_module_steps_trained_lifetime_throughput": 370100.6897775287}, "__all_modules__": {"num_env_steps_trained_lifetime": 630000, "learner_connector_sum_episodes_length_in": 5000.0, "learner_connector_sum_episodes_length_out": 5250.0, "num_module_steps_trained": 6000, "num_env_steps_trained": 31500, "learner_connector": {"timers": {"connectors": {"add_states_from_episodes_to_batch": 3.972738160363712e-06, "general_advantage_estimation": 0.007991160832242277, "add_observations_from_episodes_to_batch": 0.0008939533676777183, "add_time_dim_to_batch_and_zero_pad": 1.3152484245701637e-05, "add_one_ts_to_episodes_and_truncate": 0.009776669599687898, "numpy_to_tensor": 7.383344271698531e-05, "batch_individual_items": 0.03859584693246836, "add_columns_from_episodes_to_train_batch": 0.03769132346354916}}, "connector_pipeline_timer": 0.0951974354344401}, "num_module_steps_trained_lifetime": 120000, "num_trainable_parameters": 6003, "num_non_trainable_parameters": 0, "num_env_steps_trained_lifetime_throughput": 1920345.6995580888, "num_module_steps_trained_throughput": 366962.30165914143, "num_module_steps_trained_lifetime_throughput": 366269.58734705724}}, "num_training_step_calls_per_iteration": 1, "evaluation": {"env_runners": {"agent_episode_returns_mean": {"default_agent": 2.75}, "env_to_module_connector": {"timers": {"connectors": {"numpy_to_tensor": 8.140498373639729e-06, "batch_individual_items": 5.963680177096153e-06, "add_observations_from_episodes_to_batch": 2.720450346552677e-06, "add_time_dim_to_batch_and_zero_pad": 2.172218634310552e-06, "add_states_from_episodes_to_batch": 1.533717316365015e-06}}, "connector_pipeline_timer": 4.177014827377139e-05}, "module_to_env_connector": {"timers": {"connectors": {"get_actions": 3.40234498013638e-05, "tensor_to_numpy": 1.2516945443749057e-05, "normalize_and_clip_actions": 9.188085990784008e-06, "remove_single_ts_time_rank_from_batch": 6.203060009658292e-07, "un_batch_to_individual_items": 5.2755252028116315e-06, "listify_data_for_vector_env": 1.0585637634563335e-05}}, "connector_pipeline_timer": 9.746073622658618e-05}, "episode_len_max": 20, "env_step_timer": 1.3455956812968756e-05, "episode_len_min": 20, "episode_return_min": -16.5, "num_episodes_lifetime": 400, "num_module_steps_sampled_lifetime": {"default_policy": 8000}, "sample": 0.11516900689574067, "rlmodule_inference_timer": 2.6409547641593444e-05, "env_to_module_sum_episodes_length_in": 10.368238394574323, "module_episode_returns_mean": {"default_policy": 2.75}, "env_reset_timer": 0.0002427238509527423, "num_agent_steps_sampled_lifetime": {"default_agent": 8000}, "weights_seq_no": 20.0, "num_module_steps_sampled": {"default_policy": 400}, "episode_len_mean": 20.0, "num_env_steps_sampled": 400, "episode_duration_sec_mean": 0.004804896229179576, "episode_return_max": 12.5, "episode_return_mean": 2.75, "env_to_module_sum_episodes_length_out": 10.368238394574323, "num_episodes": 20, "num_agent_steps_sampled": {"default_agent": 400}, "num_env_steps_sampled_lifetime": 100400, "time_between_sampling": 1.8110967873981945}, "num_healthy_workers": 1, "actor_manager_num_outstanding_async_reqs": 0, "num_remote_worker_restarts": 0}, "num_env_steps_sampled_lifetime": -11105000.0, "fault_tolerance": {"num_healthy_workers": 0, "num_remote_worker_restarts": 0}, "env_runner_group": {"actor_manager_num_outstanding_async_reqs": 0}, "done": true, "training_iteration": 20, "trial_id": "4dd64_00000", "date": "2025-08-11_19-22-52", "timestamp": 1754932972, "time_this_iter_s": 1.5579710006713867, "time_total_s": 35.61471152305603, "pid": 14353, "hostname": "Mac", "node_ip": "127.0.0.1", "config": {"exploration_config": {}, "extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "placement_strategy": "PACK", "num_gpus": 0, "_fake_gpus": false, "num_cpus_for_main_process": 2, "eager_tracing": true, "eager_max_retraces": 20, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "torch_compile_learner": false, "torch_compile_learner_what_to_compile": "forward_train", "torch_compile_learner_dynamo_backend": "aot_eager", "torch_compile_learner_dynamo_mode": null, "torch_compile_worker": false, "torch_compile_worker_dynamo_backend": "aot_eager", "torch_compile_worker_dynamo_mode": null, "torch_ddp_kwargs": {}, "torch_skip_nan_gradients": false, "env": "Umbrella", "env_config": {}, "observation_space": null, "action_space": null, "clip_rewards": null, "normalize_actions": true, "clip_actions": false, "_is_atari": null, "disable_env_checking": false, "render_env": false, "action_mask_key": "action_mask", "env_runner_cls": null, "num_env_runners": 0, "create_local_env_runner": true, "num_envs_per_env_runner": 1, "gym_env_vectorize_mode": "SYNC", "num_cpus_per_env_runner": 1, "num_gpus_per_env_runner": 0, "custom_resources_per_env_runner": {}, "validate_env_runners_after_construction": true, "episodes_to_numpy": true, "max_requests_in_flight_per_env_runner": 1, "sample_timeout_s": 60.0, "_env_to_module_connector": null, "add_default_connectors_to_env_to_module_pipeline": true, "_module_to_env_connector": null, "add_default_connectors_to_module_to_env_pipeline": true, "merge_env_runner_states": "training_only", "broadcast_env_runner_states": true, "episode_lookback_horizon": 1, "rollout_fragment_length": "auto", "batch_mode": "complete_episodes", "compress_observations": false, "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "enable_tf1_exec_eagerly": false, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "preprocessor_pref": "deepmind", "observation_filter": "NoFilter", "update_worker_filter_stats": true, "use_worker_filter_stats": true, "sampler_perf_stats_ema_coef": null, "_is_online": true, "num_learners": 0, "num_gpus_per_learner": 0, "num_cpus_per_learner": "auto", "num_aggregator_actors_per_learner": 0, "max_requests_in_flight_per_aggregator_actor": 3, "local_gpu_idx": 0, "max_requests_in_flight_per_learner": 3, "gamma": 1, "lr": 0.0002847858517, "grad_clip": 0.5, "grad_clip_by": "global_norm", "_train_batch_size_per_learner": 5000, "train_batch_size": 4000, "num_epochs": 1, "minibatch_size": 1000, "shuffle_batch_per_epoch": true, "model": {"fcnet_hiddens": [256, 256], "fcnet_activation": "tanh", "fcnet_weights_initializer": null, "fcnet_weights_initializer_config": null, "fcnet_bias_initializer": null, "fcnet_bias_initializer_config": null, "conv_filters": null, "conv_activation": "relu", "conv_kernel_initializer": null, "conv_kernel_initializer_config": null, "conv_bias_initializer": null, "conv_bias_initializer_config": null, "conv_transpose_kernel_initializer": null, "conv_transpose_kernel_initializer_config": null, "conv_transpose_bias_initializer": null, "conv_transpose_bias_initializer_config": null, "post_fcnet_hiddens": [], "post_fcnet_activation": "relu", "post_fcnet_weights_initializer": null, "post_fcnet_weights_initializer_config": null, "post_fcnet_bias_initializer": null, "post_fcnet_bias_initializer_config": null, "free_log_std": false, "log_std_clip_param": 20.0, "no_final_linear": false, "vf_share_layers": false, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "lstm_weights_initializer": null, "lstm_weights_initializer_config": null, "lstm_bias_initializer": null, "lstm_bias_initializer_config": null, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "attention_use_n_prev_actions": 0, "attention_use_n_prev_rewards": 0, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": null, "custom_model_config": {}, "custom_action_dist": null, "custom_preprocessor": null, "encoder_latent_dim": null, "always_check_shapes": false, "lstm_use_prev_action_reward": -1, "_use_default_native_models": -1, "_disable_preprocessor_api": false, "_disable_action_flattening": false}, "_learner_connector": null, "add_default_connectors_to_learner_pipeline": true, "learner_config_dict": {}, "optimizer": {}, "_learner_class": null, "callbacks_on_algorithm_init": null, "callbacks_on_env_runners_recreated": null, "callbacks_on_offline_eval_runners_recreated": null, "callbacks_on_checkpoint_loaded": null, "callbacks_on_environment_created": null, "callbacks_on_episode_created": null, "callbacks_on_episode_start": null, "callbacks_on_episode_step": null, "callbacks_on_episode_end": null, "callbacks_on_evaluate_start": null, "callbacks_on_evaluate_end": null, "callbacks_on_evaluate_offline_start": null, "callbacks_on_evaluate_offline_end": null, "callbacks_on_sample_end": null, "callbacks_on_train_result": null, "explore": true, "enable_rl_module_and_learner": true, "enable_env_runner_and_connector_v2": true, "_prior_exploration_config": {"type": "StochasticSampling"}, "count_steps_by": "env_steps", "policy_map_capacity": 100, "policy_mapping_fn": "<function AlgorithmConfig.DEFAULT_POLICY_MAPPING_FN at 0x3834118a0>", "policies_to_train": null, "policy_states_are_swappable": false, "observation_fn": null, "offline_data_class": null, "input_read_method": "read_parquet", "input_read_method_kwargs": {}, "input_read_schema": {}, "input_read_episodes": false, "input_read_sample_batches": false, "input_read_batch_size": null, "input_filesystem": null, "input_filesystem_kwargs": {}, "input_compress_columns": ["obs", "new_obs"], "input_spaces_jsonable": true, "materialize_data": false, "materialize_mapped_data": true, "map_batches_kwargs": {}, "iter_batches_kwargs": {}, "ignore_final_observation": false, "prelearner_class": null, "prelearner_buffer_class": null, "prelearner_buffer_kwargs": {}, "prelearner_module_synch_period": 10, "dataset_num_iters_per_learner": null, "input_config": {}, "actions_in_input_normalized": false, "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_config": {}, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "output_max_rows_per_file": null, "output_write_remaining_data": false, "output_write_method": "write_parquet", "output_write_method_kwargs": {}, "output_filesystem": null, "output_filesystem_kwargs": {}, "output_write_episodes": true, "offline_sampling": false, "evaluation_interval": 1, "evaluation_duration": 20, "evaluation_duration_unit": "episodes", "evaluation_sample_timeout_s": 120.0, "evaluation_auto_duration_min_env_steps_per_sample": 100, "evaluation_auto_duration_max_env_steps_per_sample": 2000, "evaluation_parallel_to_training": false, "evaluation_force_reset_envs_before_iteration": true, "evaluation_config": null, "off_policy_estimation_methods": {}, "ope_split_batch_by_episode": true, "evaluation_num_env_runners": 1, "in_evaluation": false, "sync_filters_on_rollout_workers_timeout_s": 10.0, "offline_evaluation_interval": null, "num_offline_eval_runners": 0, "offline_loss_for_module_fn": null, "offline_evaluation_duration": 1, "offline_evaluation_parallel_to_training": false, "offline_evaluation_timeout_s": 120.0, "num_cpus_per_offline_eval_runner": 1, "num_gpus_per_offline_eval_runner": 0, "custom_resources_per_offline_eval_runner": {}, "restart_failed_offline_eval_runners": true, "ignore_offline_eval_runner_failures": false, "max_num_offline_eval_runner_restarts": 1000, "offline_eval_runner_restore_timeout_s": 1800.0, "max_requests_in_flight_per_offline_eval_runner": 1, "validate_offline_eval_runners_after_construction": true, "offline_eval_runner_health_probe_timeout_s": 30.0, "offline_eval_rl_module_inference_only": false, "broadcast_offline_eval_runner_states": false, "offline_eval_batch_size_per_runner": 256, "dataset_num_iters_per_eval_runner": 1, "keep_per_episode_custom_metrics": false, "metrics_episode_collection_timeout_s": 60.0, "metrics_num_episodes_for_smoothing": 100, "min_time_s_per_iteration": null, "min_train_timesteps_per_iteration": 0, "min_sample_timesteps_per_iteration": 0, "log_gradients": true, "export_native_model_files": false, "checkpoint_trainable_policies_only": false, "logger_creator": null, "logger_config": null, "log_level": "WARN", "log_sys_usage": true, "fake_sampler": false, "seed": 4, "restart_failed_env_runners": true, "ignore_env_runner_failures": false, "max_num_env_runner_restarts": 1000, "delay_between_env_runner_restarts_s": 60.0, "restart_failed_sub_environments": false, "num_consecutive_env_runner_failures_tolerance": 100, "env_runner_health_probe_timeout_s": 30.0, "env_runner_restore_timeout_s": 1800.0, "_model_config": {}, "_rl_module_spec": "RLModuleSpec(module_class=None, observation_space=None, action_space=None, inference_only=False, learner_only=False, model_config=DefaultModelConfig(fcnet_hiddens=[60, 90], fcnet_activation='tanh', fcnet_kernel_initializer=None, fcnet_kernel_initializer_kwargs=None, fcnet_bias_initializer=None, fcnet_bias_initializer_kwargs=None, conv_filters=None, conv_activation='relu', conv_kernel_initializer=None, conv_kernel_initializer_kwargs=None, conv_bias_initializer=None, conv_bias_initializer_kwargs=None, head_fcnet_hiddens=[], head_fcnet_activation='relu', head_fcnet_kernel_initializer=None, head_fcnet_kernel_initializer_kwargs=None, head_fcnet_bias_initializer=None, head_fcnet_bias_initializer_kwargs=None, free_log_std=False, log_std_clip_param=20.0, vf_share_layers=True, use_lstm=False, max_seq_len=20, lstm_cell_size=256, lstm_use_prev_action=False, lstm_use_prev_reward=False, lstm_kernel_initializer=None, lstm_kernel_initializer_kwargs=None, lstm_bias_initializer=None, lstm_bias_initializer_kwargs=None), catalog_class=None, load_state_path=None, model_config_dict=None)", "algorithm_config_overrides_per_module": {}, "_per_module_overrides": {}, "_validate_config": true, "_use_msgpack_checkpoints": false, "_torch_grad_scaler_class": null, "_torch_lr_scheduler_classes": null, "_tf_policy_handles_more_than_one_loss": false, "_disable_preprocessor_api": false, "_disable_action_flattening": false, "_disable_initialize_loss_from_dummy_batch": false, "_dont_auto_sync_env_runner_states": false, "env_task_fn": -1, "enable_connectors": -1, "simple_optimizer": false, "policy_map_cache": -1, "worker_cls": -1, "synchronize_filters": -1, "enable_async_evaluation": -1, "custom_async_evaluation_function": -1, "_enable_rl_module_api": -1, "auto_wrap_old_gym_envs": -1, "always_attach_evaluation_results": -1, "replay_sequence_length": null, "_disable_execution_plan_api": -1, "use_critic": true, "use_gae": true, "use_kl_loss": true, "kl_coeff": 0.7464963036515, "kl_target": 0.0270990929592, "vf_loss_coeff": 0.6688075857018, "entropy_coeff": 0.0090570820258, "clip_param": 0.1221781641624, "vf_clip_param": 0.1027808522125, "entropy_coeff_schedule": null, "lr_schedule": null, "sgd_minibatch_size": -1, "vf_share_layers": -1, "__stdout_file__": null, "__stderr_file__": null, "lambda": 0.9099046732075, "input": "sampler", "policies": {"default_policy": [null, null, null, null]}, "callbacks": "<class 'ray.rllib.callbacks.callbacks.RLlibCallback'>", "create_env_on_driver": false, "custom_eval_function": null, "framework": "torch"}, "time_since_restore": 35.61471152305603, "iterations_since_restore": 20, "perf": {"cpu_util_percent": 43.05, "ram_util_percent": 79.75}}
