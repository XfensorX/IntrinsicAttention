{"timers": {"training_iteration": 1.609744041110389, "restore_env_runners": 1.300009898841381e-05, "training_step": 1.609611542080529, "env_runner_sampling_timer": 1.4994910419918597, "learner_update_timer": 0.10704520798753947, "synch_weights": 0.000589667004533112}, "env_runners": {"env_step_timer": 1.4909210046272314e-05, "num_agent_steps_sampled_lifetime": {"default_agent": 627500.0}, "episode_duration_sec_mean": 0.005021535323932767, "env_to_module_connector": {"timers": {"connectors": {"add_time_dim_to_batch_and_zero_pad": 2.518102799194885e-06, "add_observations_from_episodes_to_batch": 3.2788904192197747e-06, "batch_individual_items": 6.7102319361445855e-06, "add_states_from_episodes_to_batch": 1.7909297686820683e-06, "numpy_to_tensor": 9.398597307655523e-06}}, "connector_pipeline_timer": 4.7364607203492255e-05}, "num_env_steps_sampled_lifetime": 627500.0, "episode_return_mean": 0.8199999999999998, "module_to_env_connector": {"timers": {"connectors": {"tensor_to_numpy": 1.3649271337894786e-05, "normalize_and_clip_actions": 1.361122044229587e-05, "listify_data_for_vector_env": 1.143112184656831e-05, "remove_single_ts_time_rank_from_batch": 6.165007193593729e-07, "get_actions": 4.453750432022385e-05, "un_batch_to_individual_items": 5.6903659292629065e-06}}, "connector_pipeline_timer": 0.00011607387462086573}, "weights_seq_no": 0.0, "env_to_module_sum_episodes_length_out": 10.191744832559449, "episode_len_min": 20, "num_agent_steps_sampled": {"default_agent": 5000.0}, "env_reset_timer": 7.75566344912291e-05, "rlmodule_inference_timer": 5.051143263101923e-05, "num_env_steps_sampled": 5000.0, "env_to_module_sum_episodes_length_in": 10.191744832559449, "num_module_steps_sampled": {"default_policy": 5000.0}, "episode_len_mean": 20.0, "episode_len_max": 20, "num_episodes": 250.0, "num_episodes_lifetime": 31375.0, "time_between_sampling": 0.000510601077756116, "episode_return_min": -11.5, "agent_episode_returns_mean": {"default_agent": 0.8199999999999998}, "episode_return_max": 8.5, "num_module_steps_sampled_lifetime": {"default_policy": 627500.0}, "module_episode_returns_mean": {"default_policy": 0.8199999999999998}, "sample": 0.005623619559458746, "num_env_steps_sampled_lifetime_throughput": 3444.2793759152564}, "learners": {"__all_modules__": {"learner_connector": {"timers": {"connectors": {"add_states_from_episodes_to_batch": 3.6249402910470963e-06, "numpy_to_tensor": 8.06670868769288e-05, "batch_individual_items": 0.03125733300112188, "add_columns_from_episodes_to_train_batch": 0.03449524997267872, "add_time_dim_to_batch_and_zero_pad": 1.237494871020317e-05, "add_observations_from_episodes_to_batch": 0.000851667020469904, "add_one_ts_to_episodes_and_truncate": 0.00758837501052767, "general_advantage_estimation": 0.006808459060266614}}, "connector_pipeline_timer": 0.08124929200857878}, "num_env_steps_trained": 31500, "learner_connector_sum_episodes_length_out": 5250, "num_non_trainable_parameters": 0, "num_module_steps_trained_lifetime": 6000, "learner_connector_sum_episodes_length_in": 5000, "num_env_steps_trained_lifetime": 31500, "num_module_steps_trained": 6000, "num_trainable_parameters": 6003, "num_env_steps_trained_lifetime_throughput": 2193121.5184521563, "num_module_steps_trained_throughput": 420002.3468240868, "num_module_steps_trained_lifetime_throughput": 419159.17519362434}, "default_policy": {"num_module_steps_trained_lifetime": 6000, "gradients_default_optimizer_global_norm": 0.07857398688793182, "total_loss": -0.2051759511232376, "weights_seq_no": 1.0, "diff_num_grad_updates_vs_sampler_policy": 1.0, "num_module_steps_trained": 6000, "vf_loss": 0.10278083384037018, "entropy": 0.6600642800331116, "vf_explained_var": -0.009175658226013184, "curr_kl_coeff": 0.3732481598854065, "default_optimizer_learning_rate": 0.0002847858517, "num_trainable_parameters": 6003, "module_train_batch_size_mean": 1000.0, "vf_loss_unclipped": 28.039243698120117, "policy_loss": -0.2681262493133545, "mean_kl_loss": 0.00025177394854836166, "curr_entropy_coeff": 0.0090570820258, "num_module_steps_trained_lifetime_throughput": 420950.3255864011}}, "num_training_step_calls_per_iteration": 1, "num_env_steps_sampled_lifetime": 627500.0, "evaluation": {"env_runners": {"num_episodes": 20, "env_to_module_connector": {"timers": {"connectors": {"add_states_from_episodes_to_batch": 1.6418412237087383e-06, "numpy_to_tensor": 8.897130505900293e-06, "batch_individual_items": 6.488766925297242e-06, "add_time_dim_to_batch_and_zero_pad": 2.4843049183577316e-06, "add_observations_from_episodes_to_batch": 2.975818843317239e-06}}, "connector_pipeline_timer": 4.583947611892464e-05}, "sample": 0.10711954196449369, "module_to_env_connector": {"timers": {"connectors": {"get_actions": 4.320067934155693e-05, "remove_single_ts_time_rank_from_batch": 5.931577100008474e-07, "normalize_and_clip_actions": 1.0706818772742647e-05, "un_batch_to_individual_items": 5.547529442173217e-06, "tensor_to_numpy": 1.505847881979559e-05, "listify_data_for_vector_env": 1.1392153550431903e-05}}, "connector_pipeline_timer": 0.00011273759042121531}, "episode_duration_sec_mean": 0.0049034626863431185, "module_episode_returns_mean": {"default_policy": -0.2}, "num_env_steps_sampled_lifetime": 5400, "episode_len_min": 20, "num_agent_steps_sampled_lifetime": {"default_agent": 400}, "episode_len_max": 20, "num_episodes_lifetime": 20, "episode_return_min": -12.5, "env_step_timer": 1.5056116186750938e-05, "env_to_module_sum_episodes_length_out": 10.216013141322508, "num_agent_steps_sampled": {"default_agent": 400}, "env_to_module_sum_episodes_length_in": 10.216013141322508, "episode_return_max": 12.5, "agent_episode_returns_mean": {"default_agent": -0.2}, "num_module_steps_sampled_lifetime": {"default_policy": 400}, "weights_seq_no": 1.0, "env_reset_timer": 0.00023504195269197226, "episode_len_mean": 20.0, "num_module_steps_sampled": {"default_policy": 400}, "episode_return_mean": -0.2, "rlmodule_inference_timer": 3.1090584525955954e-05, "num_env_steps_sampled": 400}, "num_healthy_workers": 1, "actor_manager_num_outstanding_async_reqs": 0, "num_remote_worker_restarts": 0}, "fault_tolerance": {"num_healthy_workers": 0, "num_remote_worker_restarts": 0}, "env_runner_group": {"actor_manager_num_outstanding_async_reqs": 0}, "done": false, "training_iteration": 1, "trial_id": "43bd0_00000", "date": "2025-08-11_19-24-20", "timestamp": 1754933060, "time_this_iter_s": 1.725539207458496, "time_total_s": 1.725539207458496, "pid": 14505, "hostname": "Mac", "node_ip": "127.0.0.1", "config": {"exploration_config": {}, "extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "placement_strategy": "PACK", "num_gpus": 0, "_fake_gpus": false, "num_cpus_for_main_process": 2, "eager_tracing": true, "eager_max_retraces": 20, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "torch_compile_learner": false, "torch_compile_learner_what_to_compile": "forward_train", "torch_compile_learner_dynamo_backend": "aot_eager", "torch_compile_learner_dynamo_mode": null, "torch_compile_worker": false, "torch_compile_worker_dynamo_backend": "aot_eager", "torch_compile_worker_dynamo_mode": null, "torch_ddp_kwargs": {}, "torch_skip_nan_gradients": false, "env": "Umbrella", "env_config": {}, "observation_space": null, "action_space": null, "clip_rewards": null, "normalize_actions": true, "clip_actions": false, "_is_atari": null, "disable_env_checking": false, "render_env": false, "action_mask_key": "action_mask", "env_runner_cls": null, "num_env_runners": 0, "create_local_env_runner": true, "num_envs_per_env_runner": 1, "gym_env_vectorize_mode": "SYNC", "num_cpus_per_env_runner": 1, "num_gpus_per_env_runner": 0, "custom_resources_per_env_runner": {}, "validate_env_runners_after_construction": true, "episodes_to_numpy": true, "max_requests_in_flight_per_env_runner": 1, "sample_timeout_s": 60.0, "_env_to_module_connector": null, "add_default_connectors_to_env_to_module_pipeline": true, "_module_to_env_connector": null, "add_default_connectors_to_module_to_env_pipeline": true, "merge_env_runner_states": "training_only", "broadcast_env_runner_states": true, "episode_lookback_horizon": 1, "rollout_fragment_length": "auto", "batch_mode": "complete_episodes", "compress_observations": false, "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "enable_tf1_exec_eagerly": false, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "preprocessor_pref": "deepmind", "observation_filter": "NoFilter", "update_worker_filter_stats": true, "use_worker_filter_stats": true, "sampler_perf_stats_ema_coef": null, "_is_online": true, "num_learners": 0, "num_gpus_per_learner": 0, "num_cpus_per_learner": "auto", "num_aggregator_actors_per_learner": 0, "max_requests_in_flight_per_aggregator_actor": 3, "local_gpu_idx": 0, "max_requests_in_flight_per_learner": 3, "gamma": 1, "lr": 0.0002847858517, "grad_clip": 0.5, "grad_clip_by": "global_norm", "_train_batch_size_per_learner": 5000, "train_batch_size": 4000, "num_epochs": 1, "minibatch_size": 1000, "shuffle_batch_per_epoch": true, "model": {"fcnet_hiddens": [256, 256], "fcnet_activation": "tanh", "fcnet_weights_initializer": null, "fcnet_weights_initializer_config": null, "fcnet_bias_initializer": null, "fcnet_bias_initializer_config": null, "conv_filters": null, "conv_activation": "relu", "conv_kernel_initializer": null, "conv_kernel_initializer_config": null, "conv_bias_initializer": null, "conv_bias_initializer_config": null, "conv_transpose_kernel_initializer": null, "conv_transpose_kernel_initializer_config": null, "conv_transpose_bias_initializer": null, "conv_transpose_bias_initializer_config": null, "post_fcnet_hiddens": [], "post_fcnet_activation": "relu", "post_fcnet_weights_initializer": null, "post_fcnet_weights_initializer_config": null, "post_fcnet_bias_initializer": null, "post_fcnet_bias_initializer_config": null, "free_log_std": false, "log_std_clip_param": 20.0, "no_final_linear": false, "vf_share_layers": false, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "lstm_weights_initializer": null, "lstm_weights_initializer_config": null, "lstm_bias_initializer": null, "lstm_bias_initializer_config": null, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "attention_use_n_prev_actions": 0, "attention_use_n_prev_rewards": 0, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": null, "custom_model_config": {}, "custom_action_dist": null, "custom_preprocessor": null, "encoder_latent_dim": null, "always_check_shapes": false, "lstm_use_prev_action_reward": -1, "_use_default_native_models": -1, "_disable_preprocessor_api": false, "_disable_action_flattening": false}, "_learner_connector": null, "add_default_connectors_to_learner_pipeline": true, "learner_config_dict": {}, "optimizer": {}, "_learner_class": null, "callbacks_on_algorithm_init": null, "callbacks_on_env_runners_recreated": null, "callbacks_on_offline_eval_runners_recreated": null, "callbacks_on_checkpoint_loaded": null, "callbacks_on_environment_created": null, "callbacks_on_episode_created": null, "callbacks_on_episode_start": null, "callbacks_on_episode_step": null, "callbacks_on_episode_end": null, "callbacks_on_evaluate_start": null, "callbacks_on_evaluate_end": null, "callbacks_on_evaluate_offline_start": null, "callbacks_on_evaluate_offline_end": null, "callbacks_on_sample_end": null, "callbacks_on_train_result": null, "explore": true, "enable_rl_module_and_learner": true, "enable_env_runner_and_connector_v2": true, "_prior_exploration_config": {"type": "StochasticSampling"}, "count_steps_by": "env_steps", "policy_map_capacity": 100, "policy_mapping_fn": "<function AlgorithmConfig.DEFAULT_POLICY_MAPPING_FN at 0x3855e5b20>", "policies_to_train": null, "policy_states_are_swappable": false, "observation_fn": null, "offline_data_class": null, "input_read_method": "read_parquet", "input_read_method_kwargs": {}, "input_read_schema": {}, "input_read_episodes": false, "input_read_sample_batches": false, "input_read_batch_size": null, "input_filesystem": null, "input_filesystem_kwargs": {}, "input_compress_columns": ["obs", "new_obs"], "input_spaces_jsonable": true, "materialize_data": false, "materialize_mapped_data": true, "map_batches_kwargs": {}, "iter_batches_kwargs": {}, "ignore_final_observation": false, "prelearner_class": null, "prelearner_buffer_class": null, "prelearner_buffer_kwargs": {}, "prelearner_module_synch_period": 10, "dataset_num_iters_per_learner": null, "input_config": {}, "actions_in_input_normalized": false, "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_config": {}, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "output_max_rows_per_file": null, "output_write_remaining_data": false, "output_write_method": "write_parquet", "output_write_method_kwargs": {}, "output_filesystem": null, "output_filesystem_kwargs": {}, "output_write_episodes": true, "offline_sampling": false, "evaluation_interval": 1, "evaluation_duration": 20, "evaluation_duration_unit": "episodes", "evaluation_sample_timeout_s": 120.0, "evaluation_auto_duration_min_env_steps_per_sample": 100, "evaluation_auto_duration_max_env_steps_per_sample": 2000, "evaluation_parallel_to_training": false, "evaluation_force_reset_envs_before_iteration": true, "evaluation_config": null, "off_policy_estimation_methods": {}, "ope_split_batch_by_episode": true, "evaluation_num_env_runners": 1, "in_evaluation": false, "sync_filters_on_rollout_workers_timeout_s": 10.0, "offline_evaluation_interval": null, "num_offline_eval_runners": 0, "offline_loss_for_module_fn": null, "offline_evaluation_duration": 1, "offline_evaluation_parallel_to_training": false, "offline_evaluation_timeout_s": 120.0, "num_cpus_per_offline_eval_runner": 1, "num_gpus_per_offline_eval_runner": 0, "custom_resources_per_offline_eval_runner": {}, "restart_failed_offline_eval_runners": true, "ignore_offline_eval_runner_failures": false, "max_num_offline_eval_runner_restarts": 1000, "offline_eval_runner_restore_timeout_s": 1800.0, "max_requests_in_flight_per_offline_eval_runner": 1, "validate_offline_eval_runners_after_construction": true, "offline_eval_runner_health_probe_timeout_s": 30.0, "offline_eval_rl_module_inference_only": false, "broadcast_offline_eval_runner_states": false, "offline_eval_batch_size_per_runner": 256, "dataset_num_iters_per_eval_runner": 1, "keep_per_episode_custom_metrics": false, "metrics_episode_collection_timeout_s": 60.0, "metrics_num_episodes_for_smoothing": 100, "min_time_s_per_iteration": null, "min_train_timesteps_per_iteration": 0, "min_sample_timesteps_per_iteration": 0, "log_gradients": true, "export_native_model_files": false, "checkpoint_trainable_policies_only": false, "logger_creator": null, "logger_config": null, "log_level": "WARN", "log_sys_usage": true, "fake_sampler": false, "seed": 2, "restart_failed_env_runners": true, "ignore_env_runner_failures": false, "max_num_env_runner_restarts": 1000, "delay_between_env_runner_restarts_s": 60.0, "restart_failed_sub_environments": false, "num_consecutive_env_runner_failures_tolerance": 100, "env_runner_health_probe_timeout_s": 30.0, "env_runner_restore_timeout_s": 1800.0, "_model_config": {}, "_rl_module_spec": "RLModuleSpec(module_class=None, observation_space=None, action_space=None, inference_only=False, learner_only=False, model_config=DefaultModelConfig(fcnet_hiddens=[60, 90], fcnet_activation='tanh', fcnet_kernel_initializer=None, fcnet_kernel_initializer_kwargs=None, fcnet_bias_initializer=None, fcnet_bias_initializer_kwargs=None, conv_filters=None, conv_activation='relu', conv_kernel_initializer=None, conv_kernel_initializer_kwargs=None, conv_bias_initializer=None, conv_bias_initializer_kwargs=None, head_fcnet_hiddens=[], head_fcnet_activation='relu', head_fcnet_kernel_initializer=None, head_fcnet_kernel_initializer_kwargs=None, head_fcnet_bias_initializer=None, head_fcnet_bias_initializer_kwargs=None, free_log_std=False, log_std_clip_param=20.0, vf_share_layers=True, use_lstm=False, max_seq_len=20, lstm_cell_size=256, lstm_use_prev_action=False, lstm_use_prev_reward=False, lstm_kernel_initializer=None, lstm_kernel_initializer_kwargs=None, lstm_bias_initializer=None, lstm_bias_initializer_kwargs=None), catalog_class=None, load_state_path=None, model_config_dict=None)", "algorithm_config_overrides_per_module": {}, "_per_module_overrides": {}, "_validate_config": true, "_use_msgpack_checkpoints": false, "_torch_grad_scaler_class": null, "_torch_lr_scheduler_classes": null, "_tf_policy_handles_more_than_one_loss": false, "_disable_preprocessor_api": false, "_disable_action_flattening": false, "_disable_initialize_loss_from_dummy_batch": false, "_dont_auto_sync_env_runner_states": false, "env_task_fn": -1, "enable_connectors": -1, "simple_optimizer": false, "policy_map_cache": -1, "worker_cls": -1, "synchronize_filters": -1, "enable_async_evaluation": -1, "custom_async_evaluation_function": -1, "_enable_rl_module_api": -1, "auto_wrap_old_gym_envs": -1, "always_attach_evaluation_results": -1, "replay_sequence_length": null, "_disable_execution_plan_api": -1, "use_critic": true, "use_gae": true, "use_kl_loss": true, "kl_coeff": 0.7464963036515, "kl_target": 0.0270990929592, "vf_loss_coeff": 0.6688075857018, "entropy_coeff": 0.0090570820258, "clip_param": 0.1221781641624, "vf_clip_param": 0.1027808522125, "entropy_coeff_schedule": null, "lr_schedule": null, "sgd_minibatch_size": -1, "vf_share_layers": -1, "__stdout_file__": null, "__stderr_file__": null, "lambda": 0.9099046732075, "input": "sampler", "policies": {"default_policy": [null, null, null, null]}, "callbacks": "<class 'ray.rllib.callbacks.callbacks.RLlibCallback'>", "create_env_on_driver": false, "custom_eval_function": null, "framework": "torch"}, "time_since_restore": 1.725539207458496, "iterations_since_restore": 1, "perf": {"cpu_util_percent": 14.066666666666668, "ram_util_percent": 77.7}}
{"timers": {"training_iteration": 1.6094186352787074, "restore_env_runners": 1.2936758575960994e-05, "training_step": 1.6092855249997229, "env_runner_sampling_timer": 1.498397836572258, "learner_update_timer": 0.10781171340844593, "synch_weights": 0.0005897570040542632, "restore_eval_env_runners": 9.66701190918684e-06, "evaluation_iteration": 0.11411612492520362, "synch_eval_env_connectors": 0.0001396250445395708, "synch_env_connectors": 4.415982402861118e-06}, "env_runners": {"env_step_timer": 1.3896730066250181e-05, "num_agent_steps_sampled_lifetime": {"default_agent": 10000.0}, "episode_duration_sec_mean": 0.00455945833818987, "env_to_module_connector": {"timers": {"connectors": {"add_time_dim_to_batch_and_zero_pad": 2.358145318442061e-06, "add_observations_from_episodes_to_batch": 2.9774952473163656e-06, "batch_individual_items": 6.414878581466763e-06, "add_states_from_episodes_to_batch": 1.7436682004624738e-06, "numpy_to_tensor": 8.748036316971152e-06}}, "connector_pipeline_timer": 4.4058555621100904e-05}, "num_env_steps_sampled_lifetime": 10000.0, "episode_return_mean": 1.2200000000000002, "module_to_env_connector": {"timers": {"connectors": {"tensor_to_numpy": 1.3163536871626404e-05, "normalize_and_clip_actions": 9.506929811889098e-06, "listify_data_for_vector_env": 1.11634547859254e-05, "remove_single_ts_time_rank_from_batch": 5.986127328383463e-07, "get_actions": 3.848480915275767e-05, "un_batch_to_individual_items": 5.409239894512273e-06}}, "connector_pipeline_timer": 0.0001041032727691391}, "weights_seq_no": 1.0, "env_to_module_sum_episodes_length_out": 10.36823839457432, "episode_len_min": 20, "num_agent_steps_sampled": {"default_agent": 5000.0}, "env_reset_timer": 4.244374669891987e-05, "rlmodule_inference_timer": 2.8103406098263526e-05, "num_env_steps_sampled": 5000.0, "env_to_module_sum_episodes_length_in": 10.36823839457432, "num_module_steps_sampled": {"default_policy": 5000.0}, "episode_len_mean": 20.0, "episode_len_max": 20, "num_episodes": 250.0, "num_episodes_lifetime": 500.0, "time_between_sampling": 0.0015574442091647201, "episode_return_min": -11.5, "agent_episode_returns_mean": {"default_agent": 1.2200000000000002}, "episode_return_max": 8.5, "num_module_steps_sampled_lifetime": {"default_policy": 10000.0}, "module_episode_returns_mean": {"default_policy": 1.2200000000000002}, "sample": 0.005292409030402254, "num_env_steps_sampled_lifetime_throughput": 3671.9316124733286}, "learners": {"__all_modules__": {"learner_connector": {"timers": {"connectors": {"add_states_from_episodes_to_batch": 3.6211905535310504e-06, "numpy_to_tensor": 8.054916514083744e-05, "batch_individual_items": 0.03216770258150063, "add_columns_from_episodes_to_train_batch": 0.03448574372334406, "add_time_dim_to_batch_and_zero_pad": 1.236452953889966e-05, "add_observations_from_episodes_to_batch": 0.0008510574302636087, "add_one_ts_to_episodes_and_truncate": 0.007586337929824367, "general_advantage_estimation": 0.006796133219031617}}, "connector_pipeline_timer": 0.08213446075911635}, "num_env_steps_trained": 31500, "learner_connector_sum_episodes_length_out": 5250.0, "num_non_trainable_parameters": 0, "num_module_steps_trained_lifetime": 12000, "learner_connector_sum_episodes_length_in": 5000.0, "num_env_steps_trained_lifetime": 63000, "num_module_steps_trained": 6000, "num_trainable_parameters": 6003, "num_env_steps_trained_lifetime_throughput": 2195010.1915559755, "num_module_steps_trained_throughput": 420335.801107416, "num_module_steps_trained_lifetime_throughput": 419500.57068368274}, "default_policy": {"num_module_steps_trained_lifetime": 12000, "gradients_default_optimizer_global_norm": 0.04126502946019173, "total_loss": 0.05995207279920578, "weights_seq_no": 2.0, "diff_num_grad_updates_vs_sampler_policy": 1.0, "num_module_steps_trained": 6000, "vf_loss": 0.10278083384037018, "entropy": 0.6536862254142761, "vf_explained_var": -0.012158751487731934, "curr_kl_coeff": 0.18662407994270325, "default_optimizer_learning_rate": 0.0002847858517, "num_trainable_parameters": 6003, "module_train_batch_size_mean": 1000.0, "vf_loss_unclipped": 28.439332962036133, "policy_loss": -0.003029095707461238, "mean_kl_loss": 0.0004314855032134801, "curr_entropy_coeff": 0.0090570820258, "num_module_steps_trained_lifetime_throughput": 421257.6671636185}}, "num_training_step_calls_per_iteration": 1, "evaluation": {"env_runners": {"num_episodes": 20, "env_to_module_connector": {"timers": {"connectors": {"add_states_from_episodes_to_batch": 1.6042798529488897e-06, "numpy_to_tensor": 8.55510199246973e-06, "batch_individual_items": 6.130209699089679e-06, "add_time_dim_to_batch_and_zero_pad": 2.25204874812935e-06, "add_observations_from_episodes_to_batch": 2.8506349444415193e-06}}, "connector_pipeline_timer": 4.295237700198862e-05}, "sample": 0.1070476365450304, "module_to_env_connector": {"timers": {"connectors": {"get_actions": 3.8720907521594943e-05, "remove_single_ts_time_rank_from_batch": 5.868639239232319e-07, "normalize_and_clip_actions": 9.626665245435447e-06, "un_batch_to_individual_items": 5.566973737637406e-06, "tensor_to_numpy": 1.3361540637805015e-05, "listify_data_for_vector_env": 1.1153200627163837e-05}}, "connector_pipeline_timer": 0.00010482950192320583}, "episode_duration_sec_mean": 0.004727044893661514, "module_episode_returns_mean": {"default_policy": 1.8}, "num_env_steps_sampled_lifetime": 10400, "episode_len_min": 20, "num_agent_steps_sampled_lifetime": {"default_agent": 800}, "episode_len_max": 20, "num_episodes_lifetime": 40, "episode_return_min": -14.5, "env_step_timer": 1.4502367648694758e-05, "env_to_module_sum_episodes_length_out": 10.366003441359926, "num_agent_steps_sampled": {"default_agent": 400}, "env_to_module_sum_episodes_length_in": 10.366003441359926, "episode_return_max": 14.5, "agent_episode_returns_mean": {"default_agent": 1.8}, "num_module_steps_sampled_lifetime": {"default_policy": 800}, "weights_seq_no": 2.0, "env_reset_timer": 0.00023378195357508957, "episode_len_mean": 20.0, "num_module_steps_sampled": {"default_policy": 400}, "episode_return_mean": 1.8, "rlmodule_inference_timer": 2.839521354074313e-05, "num_env_steps_sampled": 400, "time_between_sampling": 1.6109205830143765}, "num_healthy_workers": 1, "actor_manager_num_outstanding_async_reqs": 0, "num_remote_worker_restarts": 0}, "num_env_steps_sampled_lifetime": 10000.0, "fault_tolerance": {"num_healthy_workers": 0, "num_remote_worker_restarts": 0}, "env_runner_group": {"actor_manager_num_outstanding_async_reqs": 0}, "done": false, "training_iteration": 2, "trial_id": "43bd0_00000", "date": "2025-08-11_19-24-22", "timestamp": 1754933062, "time_this_iter_s": 1.684424877166748, "time_total_s": 3.409964084625244, "pid": 14505, "hostname": "Mac", "node_ip": "127.0.0.1", "config": {"exploration_config": {}, "extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "placement_strategy": "PACK", "num_gpus": 0, "_fake_gpus": false, "num_cpus_for_main_process": 2, "eager_tracing": true, "eager_max_retraces": 20, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "torch_compile_learner": false, "torch_compile_learner_what_to_compile": "forward_train", "torch_compile_learner_dynamo_backend": "aot_eager", "torch_compile_learner_dynamo_mode": null, "torch_compile_worker": false, "torch_compile_worker_dynamo_backend": "aot_eager", "torch_compile_worker_dynamo_mode": null, "torch_ddp_kwargs": {}, "torch_skip_nan_gradients": false, "env": "Umbrella", "env_config": {}, "observation_space": null, "action_space": null, "clip_rewards": null, "normalize_actions": true, "clip_actions": false, "_is_atari": null, "disable_env_checking": false, "render_env": false, "action_mask_key": "action_mask", "env_runner_cls": null, "num_env_runners": 0, "create_local_env_runner": true, "num_envs_per_env_runner": 1, "gym_env_vectorize_mode": "SYNC", "num_cpus_per_env_runner": 1, "num_gpus_per_env_runner": 0, "custom_resources_per_env_runner": {}, "validate_env_runners_after_construction": true, "episodes_to_numpy": true, "max_requests_in_flight_per_env_runner": 1, "sample_timeout_s": 60.0, "_env_to_module_connector": null, "add_default_connectors_to_env_to_module_pipeline": true, "_module_to_env_connector": null, "add_default_connectors_to_module_to_env_pipeline": true, "merge_env_runner_states": "training_only", "broadcast_env_runner_states": true, "episode_lookback_horizon": 1, "rollout_fragment_length": "auto", "batch_mode": "complete_episodes", "compress_observations": false, "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "enable_tf1_exec_eagerly": false, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "preprocessor_pref": "deepmind", "observation_filter": "NoFilter", "update_worker_filter_stats": true, "use_worker_filter_stats": true, "sampler_perf_stats_ema_coef": null, "_is_online": true, "num_learners": 0, "num_gpus_per_learner": 0, "num_cpus_per_learner": "auto", "num_aggregator_actors_per_learner": 0, "max_requests_in_flight_per_aggregator_actor": 3, "local_gpu_idx": 0, "max_requests_in_flight_per_learner": 3, "gamma": 1, "lr": 0.0002847858517, "grad_clip": 0.5, "grad_clip_by": "global_norm", "_train_batch_size_per_learner": 5000, "train_batch_size": 4000, "num_epochs": 1, "minibatch_size": 1000, "shuffle_batch_per_epoch": true, "model": {"fcnet_hiddens": [256, 256], "fcnet_activation": "tanh", "fcnet_weights_initializer": null, "fcnet_weights_initializer_config": null, "fcnet_bias_initializer": null, "fcnet_bias_initializer_config": null, "conv_filters": null, "conv_activation": "relu", "conv_kernel_initializer": null, "conv_kernel_initializer_config": null, "conv_bias_initializer": null, "conv_bias_initializer_config": null, "conv_transpose_kernel_initializer": null, "conv_transpose_kernel_initializer_config": null, "conv_transpose_bias_initializer": null, "conv_transpose_bias_initializer_config": null, "post_fcnet_hiddens": [], "post_fcnet_activation": "relu", "post_fcnet_weights_initializer": null, "post_fcnet_weights_initializer_config": null, "post_fcnet_bias_initializer": null, "post_fcnet_bias_initializer_config": null, "free_log_std": false, "log_std_clip_param": 20.0, "no_final_linear": false, "vf_share_layers": false, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "lstm_weights_initializer": null, "lstm_weights_initializer_config": null, "lstm_bias_initializer": null, "lstm_bias_initializer_config": null, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "attention_use_n_prev_actions": 0, "attention_use_n_prev_rewards": 0, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": null, "custom_model_config": {}, "custom_action_dist": null, "custom_preprocessor": null, "encoder_latent_dim": null, "always_check_shapes": false, "lstm_use_prev_action_reward": -1, "_use_default_native_models": -1, "_disable_preprocessor_api": false, "_disable_action_flattening": false}, "_learner_connector": null, "add_default_connectors_to_learner_pipeline": true, "learner_config_dict": {}, "optimizer": {}, "_learner_class": null, "callbacks_on_algorithm_init": null, "callbacks_on_env_runners_recreated": null, "callbacks_on_offline_eval_runners_recreated": null, "callbacks_on_checkpoint_loaded": null, "callbacks_on_environment_created": null, "callbacks_on_episode_created": null, "callbacks_on_episode_start": null, "callbacks_on_episode_step": null, "callbacks_on_episode_end": null, "callbacks_on_evaluate_start": null, "callbacks_on_evaluate_end": null, "callbacks_on_evaluate_offline_start": null, "callbacks_on_evaluate_offline_end": null, "callbacks_on_sample_end": null, "callbacks_on_train_result": null, "explore": true, "enable_rl_module_and_learner": true, "enable_env_runner_and_connector_v2": true, "_prior_exploration_config": {"type": "StochasticSampling"}, "count_steps_by": "env_steps", "policy_map_capacity": 100, "policy_mapping_fn": "<function AlgorithmConfig.DEFAULT_POLICY_MAPPING_FN at 0x3855e5b20>", "policies_to_train": null, "policy_states_are_swappable": false, "observation_fn": null, "offline_data_class": null, "input_read_method": "read_parquet", "input_read_method_kwargs": {}, "input_read_schema": {}, "input_read_episodes": false, "input_read_sample_batches": false, "input_read_batch_size": null, "input_filesystem": null, "input_filesystem_kwargs": {}, "input_compress_columns": ["obs", "new_obs"], "input_spaces_jsonable": true, "materialize_data": false, "materialize_mapped_data": true, "map_batches_kwargs": {}, "iter_batches_kwargs": {}, "ignore_final_observation": false, "prelearner_class": null, "prelearner_buffer_class": null, "prelearner_buffer_kwargs": {}, "prelearner_module_synch_period": 10, "dataset_num_iters_per_learner": null, "input_config": {}, "actions_in_input_normalized": false, "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_config": {}, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "output_max_rows_per_file": null, "output_write_remaining_data": false, "output_write_method": "write_parquet", "output_write_method_kwargs": {}, "output_filesystem": null, "output_filesystem_kwargs": {}, "output_write_episodes": true, "offline_sampling": false, "evaluation_interval": 1, "evaluation_duration": 20, "evaluation_duration_unit": "episodes", "evaluation_sample_timeout_s": 120.0, "evaluation_auto_duration_min_env_steps_per_sample": 100, "evaluation_auto_duration_max_env_steps_per_sample": 2000, "evaluation_parallel_to_training": false, "evaluation_force_reset_envs_before_iteration": true, "evaluation_config": null, "off_policy_estimation_methods": {}, "ope_split_batch_by_episode": true, "evaluation_num_env_runners": 1, "in_evaluation": false, "sync_filters_on_rollout_workers_timeout_s": 10.0, "offline_evaluation_interval": null, "num_offline_eval_runners": 0, "offline_loss_for_module_fn": null, "offline_evaluation_duration": 1, "offline_evaluation_parallel_to_training": false, "offline_evaluation_timeout_s": 120.0, "num_cpus_per_offline_eval_runner": 1, "num_gpus_per_offline_eval_runner": 0, "custom_resources_per_offline_eval_runner": {}, "restart_failed_offline_eval_runners": true, "ignore_offline_eval_runner_failures": false, "max_num_offline_eval_runner_restarts": 1000, "offline_eval_runner_restore_timeout_s": 1800.0, "max_requests_in_flight_per_offline_eval_runner": 1, "validate_offline_eval_runners_after_construction": true, "offline_eval_runner_health_probe_timeout_s": 30.0, "offline_eval_rl_module_inference_only": false, "broadcast_offline_eval_runner_states": false, "offline_eval_batch_size_per_runner": 256, "dataset_num_iters_per_eval_runner": 1, "keep_per_episode_custom_metrics": false, "metrics_episode_collection_timeout_s": 60.0, "metrics_num_episodes_for_smoothing": 100, "min_time_s_per_iteration": null, "min_train_timesteps_per_iteration": 0, "min_sample_timesteps_per_iteration": 0, "log_gradients": true, "export_native_model_files": false, "checkpoint_trainable_policies_only": false, "logger_creator": null, "logger_config": null, "log_level": "WARN", "log_sys_usage": true, "fake_sampler": false, "seed": 2, "restart_failed_env_runners": true, "ignore_env_runner_failures": false, "max_num_env_runner_restarts": 1000, "delay_between_env_runner_restarts_s": 60.0, "restart_failed_sub_environments": false, "num_consecutive_env_runner_failures_tolerance": 100, "env_runner_health_probe_timeout_s": 30.0, "env_runner_restore_timeout_s": 1800.0, "_model_config": {}, "_rl_module_spec": "RLModuleSpec(module_class=None, observation_space=None, action_space=None, inference_only=False, learner_only=False, model_config=DefaultModelConfig(fcnet_hiddens=[60, 90], fcnet_activation='tanh', fcnet_kernel_initializer=None, fcnet_kernel_initializer_kwargs=None, fcnet_bias_initializer=None, fcnet_bias_initializer_kwargs=None, conv_filters=None, conv_activation='relu', conv_kernel_initializer=None, conv_kernel_initializer_kwargs=None, conv_bias_initializer=None, conv_bias_initializer_kwargs=None, head_fcnet_hiddens=[], head_fcnet_activation='relu', head_fcnet_kernel_initializer=None, head_fcnet_kernel_initializer_kwargs=None, head_fcnet_bias_initializer=None, head_fcnet_bias_initializer_kwargs=None, free_log_std=False, log_std_clip_param=20.0, vf_share_layers=True, use_lstm=False, max_seq_len=20, lstm_cell_size=256, lstm_use_prev_action=False, lstm_use_prev_reward=False, lstm_kernel_initializer=None, lstm_kernel_initializer_kwargs=None, lstm_bias_initializer=None, lstm_bias_initializer_kwargs=None), catalog_class=None, load_state_path=None, model_config_dict=None)", "algorithm_config_overrides_per_module": {}, "_per_module_overrides": {}, "_validate_config": true, "_use_msgpack_checkpoints": false, "_torch_grad_scaler_class": null, "_torch_lr_scheduler_classes": null, "_tf_policy_handles_more_than_one_loss": false, "_disable_preprocessor_api": false, "_disable_action_flattening": false, "_disable_initialize_loss_from_dummy_batch": false, "_dont_auto_sync_env_runner_states": false, "env_task_fn": -1, "enable_connectors": -1, "simple_optimizer": false, "policy_map_cache": -1, "worker_cls": -1, "synchronize_filters": -1, "enable_async_evaluation": -1, "custom_async_evaluation_function": -1, "_enable_rl_module_api": -1, "auto_wrap_old_gym_envs": -1, "always_attach_evaluation_results": -1, "replay_sequence_length": null, "_disable_execution_plan_api": -1, "use_critic": true, "use_gae": true, "use_kl_loss": true, "kl_coeff": 0.7464963036515, "kl_target": 0.0270990929592, "vf_loss_coeff": 0.6688075857018, "entropy_coeff": 0.0090570820258, "clip_param": 0.1221781641624, "vf_clip_param": 0.1027808522125, "entropy_coeff_schedule": null, "lr_schedule": null, "sgd_minibatch_size": -1, "vf_share_layers": -1, "__stdout_file__": null, "__stderr_file__": null, "lambda": 0.9099046732075, "input": "sampler", "policies": {"default_policy": [null, null, null, null]}, "callbacks": "<class 'ray.rllib.callbacks.callbacks.RLlibCallback'>", "create_env_on_driver": false, "custom_eval_function": null, "framework": "torch"}, "time_since_restore": 3.409964084625244, "iterations_since_restore": 2, "perf": {"cpu_util_percent": 47.05, "ram_util_percent": 78.0}}
{"timers": {"training_iteration": 1.6088739405966015, "restore_env_runners": 1.2874471826944501e-05, "training_step": 1.6087403709993233, "env_runner_sampling_timer": 1.4979612369568205, "learner_update_timer": 0.10770156002436997, "synch_weights": 0.0005898102639592253, "restore_eval_env_runners": 9.64950188063085e-06, "evaluation_iteration": 0.11402677576639689, "synch_eval_env_connectors": 0.0001392904540989548, "synch_env_connectors": 4.4118228834122416e-06}, "env_runners": {"env_step_timer": 1.4498206154173274e-05, "num_agent_steps_sampled_lifetime": {"default_agent": -607500.0}, "episode_duration_sec_mean": 0.004745562992058695, "env_to_module_connector": {"timers": {"connectors": {"add_time_dim_to_batch_and_zero_pad": 2.4517986593424413e-06, "add_observations_from_episodes_to_batch": 3.121525873880535e-06, "batch_individual_items": 6.632138565664441e-06, "add_states_from_episodes_to_batch": 1.7673722539137978e-06, "numpy_to_tensor": 9.069440000405062e-06}}, "connector_pipeline_timer": 4.521404389199779e-05}, "num_env_steps_sampled_lifetime": -607500.0, "episode_return_mean": 1.0600000000000005, "module_to_env_connector": {"timers": {"connectors": {"tensor_to_numpy": 1.3506113564331786e-05, "normalize_and_clip_actions": 9.827590113848809e-06, "listify_data_for_vector_env": 1.1649620556373011e-05, "remove_single_ts_time_rank_from_batch": 6.158974354157703e-07, "get_actions": 4.039520281421864e-05, "un_batch_to_individual_items": 5.596418643992799e-06}}, "connector_pipeline_timer": 0.00010791901617948507}, "weights_seq_no": 2.0, "env_to_module_sum_episodes_length_out": 10.36823839457432, "episode_len_min": 20, "num_agent_steps_sampled": {"default_agent": 5000.0}, "env_reset_timer": 4.360243880976986e-05, "rlmodule_inference_timer": 2.9133531339289712e-05, "num_env_steps_sampled": 5000.0, "env_to_module_sum_episodes_length_in": 10.36823839457432, "num_module_steps_sampled": {"default_policy": 5000.0}, "episode_len_mean": 20.0, "episode_len_max": 20, "num_episodes": 250.0, "num_episodes_lifetime": -30375.0, "time_between_sampling": 0.001876128735226621, "episode_return_min": -11.5, "agent_episode_returns_mean": {"default_agent": 1.0600000000000005}, "episode_return_max": 8.5, "num_module_steps_sampled_lifetime": {"default_policy": -607500.0}, "module_episode_returns_mean": {"default_policy": 1.0600000000000005}, "sample": 0.005077318055155727, "num_env_steps_sampled_lifetime_throughput": 3549.1046189338613}, "learners": {"__all_modules__": {"learner_connector": {"timers": {"connectors": {"add_states_from_episodes_to_batch": 3.616638958919793e-06, "numpy_to_tensor": 8.069492287468166e-05, "batch_individual_items": 0.03216189972573192, "add_columns_from_episodes_to_train_batch": 0.03449406420586165, "add_time_dim_to_batch_and_zero_pad": 1.2370464974083006e-05, "add_observations_from_episodes_to_batch": 0.00085097602608148, "add_one_ts_to_episodes_and_truncate": 0.007590802880458068, "general_advantage_estimation": 0.006782989805995021}}, "connector_pipeline_timer": 0.0821283574010362}, "num_env_steps_trained": 31500, "learner_connector_sum_episodes_length_out": 5250.0, "num_non_trainable_parameters": 0, "num_module_steps_trained_lifetime": 18000, "learner_connector_sum_episodes_length_in": 5000.0, "num_env_steps_trained_lifetime": 94500, "num_module_steps_trained": 6000, "num_trainable_parameters": 6003, "num_env_steps_trained_lifetime_throughput": 2193062.946761185, "num_module_steps_trained_throughput": 419920.5638062557, "num_module_steps_trained_lifetime_throughput": 419099.4765844528}, "default_policy": {"num_module_steps_trained_lifetime": 18000, "gradients_default_optimizer_global_norm": 0.039692364633083344, "total_loss": 0.10348828136920929, "weights_seq_no": 3.0, "diff_num_grad_updates_vs_sampler_policy": 1.0, "num_module_steps_trained": 6000, "vf_loss": 0.10278083384037018, "entropy": 0.6424447298049927, "vf_explained_var": -0.012941598892211914, "curr_kl_coeff": 0.09331203997135162, "default_optimizer_learning_rate": 0.0002847858517, "num_trainable_parameters": 6003, "module_train_batch_size_mean": 1000.0, "vf_loss_unclipped": 28.58755874633789, "policy_loss": 0.04044210910797119, "mean_kl_loss": 0.0006657454650849104, "curr_entropy_coeff": 0.0090570820258, "num_module_steps_trained_lifetime_throughput": 420803.22048385575}}, "num_training_step_calls_per_iteration": 1, "evaluation": {"env_runners": {"num_episodes": 20, "env_to_module_connector": {"timers": {"connectors": {"add_states_from_episodes_to_batch": 1.7659140377374374e-06, "numpy_to_tensor": 1.0145409853493726e-05, "batch_individual_items": 7.239984846723166e-06, "add_time_dim_to_batch_and_zero_pad": 2.740909611536436e-06, "add_observations_from_episodes_to_batch": 3.2993257633958993e-06}}, "connector_pipeline_timer": 4.90873069977498e-05}, "sample": 0.10711911058967234, "module_to_env_connector": {"timers": {"connectors": {"get_actions": 4.7850740282085636e-05, "remove_single_ts_time_rank_from_batch": 6.436056222551871e-07, "normalize_and_clip_actions": 1.1415841027197041e-05, "un_batch_to_individual_items": 6.0231687868684886e-06, "tensor_to_numpy": 1.5132840606433607e-05, "listify_data_for_vector_env": 1.3046886621547344e-05}}, "connector_pipeline_timer": 0.0001228743055273679}, "episode_duration_sec_mean": 0.004904215994368618, "module_episode_returns_mean": {"default_policy": 2.1333333333333333}, "num_env_steps_sampled_lifetime": 15400, "episode_len_min": 20, "num_agent_steps_sampled_lifetime": {"default_agent": 1200}, "episode_len_max": 20, "num_episodes_lifetime": 60, "episode_return_min": -14.5, "env_step_timer": 1.6632762966348536e-05, "env_to_module_sum_episodes_length_out": 10.368205581254823, "num_agent_steps_sampled": {"default_agent": 400}, "env_to_module_sum_episodes_length_in": 10.368205581254823, "episode_return_max": 14.5, "agent_episode_returns_mean": {"default_agent": 2.1333333333333333}, "num_module_steps_sampled_lifetime": {"default_policy": 1200}, "weights_seq_no": 3.0, "env_reset_timer": 0.00023223580362973732, "episode_len_mean": 20.0, "num_module_steps_sampled": {"default_policy": 400}, "episode_return_mean": 2.1333333333333333, "rlmodule_inference_timer": 3.512811602335374e-05, "num_env_steps_sampled": 400, "time_between_sampling": 1.6105441492644605}, "num_healthy_workers": 1, "actor_manager_num_outstanding_async_reqs": 0, "num_remote_worker_restarts": 0}, "num_env_steps_sampled_lifetime": -607500.0, "fault_tolerance": {"num_healthy_workers": 0, "num_remote_worker_restarts": 0}, "env_runner_group": {"actor_manager_num_outstanding_async_reqs": 0}, "done": false, "training_iteration": 3, "trial_id": "43bd0_00000", "date": "2025-08-11_19-24-24", "timestamp": 1754933064, "time_this_iter_s": 1.6763651371002197, "time_total_s": 5.086329221725464, "pid": 14505, "hostname": "Mac", "node_ip": "127.0.0.1", "config": {"exploration_config": {}, "extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "placement_strategy": "PACK", "num_gpus": 0, "_fake_gpus": false, "num_cpus_for_main_process": 2, "eager_tracing": true, "eager_max_retraces": 20, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "torch_compile_learner": false, "torch_compile_learner_what_to_compile": "forward_train", "torch_compile_learner_dynamo_backend": "aot_eager", "torch_compile_learner_dynamo_mode": null, "torch_compile_worker": false, "torch_compile_worker_dynamo_backend": "aot_eager", "torch_compile_worker_dynamo_mode": null, "torch_ddp_kwargs": {}, "torch_skip_nan_gradients": false, "env": "Umbrella", "env_config": {}, "observation_space": null, "action_space": null, "clip_rewards": null, "normalize_actions": true, "clip_actions": false, "_is_atari": null, "disable_env_checking": false, "render_env": false, "action_mask_key": "action_mask", "env_runner_cls": null, "num_env_runners": 0, "create_local_env_runner": true, "num_envs_per_env_runner": 1, "gym_env_vectorize_mode": "SYNC", "num_cpus_per_env_runner": 1, "num_gpus_per_env_runner": 0, "custom_resources_per_env_runner": {}, "validate_env_runners_after_construction": true, "episodes_to_numpy": true, "max_requests_in_flight_per_env_runner": 1, "sample_timeout_s": 60.0, "_env_to_module_connector": null, "add_default_connectors_to_env_to_module_pipeline": true, "_module_to_env_connector": null, "add_default_connectors_to_module_to_env_pipeline": true, "merge_env_runner_states": "training_only", "broadcast_env_runner_states": true, "episode_lookback_horizon": 1, "rollout_fragment_length": "auto", "batch_mode": "complete_episodes", "compress_observations": false, "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "enable_tf1_exec_eagerly": false, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "preprocessor_pref": "deepmind", "observation_filter": "NoFilter", "update_worker_filter_stats": true, "use_worker_filter_stats": true, "sampler_perf_stats_ema_coef": null, "_is_online": true, "num_learners": 0, "num_gpus_per_learner": 0, "num_cpus_per_learner": "auto", "num_aggregator_actors_per_learner": 0, "max_requests_in_flight_per_aggregator_actor": 3, "local_gpu_idx": 0, "max_requests_in_flight_per_learner": 3, "gamma": 1, "lr": 0.0002847858517, "grad_clip": 0.5, "grad_clip_by": "global_norm", "_train_batch_size_per_learner": 5000, "train_batch_size": 4000, "num_epochs": 1, "minibatch_size": 1000, "shuffle_batch_per_epoch": true, "model": {"fcnet_hiddens": [256, 256], "fcnet_activation": "tanh", "fcnet_weights_initializer": null, "fcnet_weights_initializer_config": null, "fcnet_bias_initializer": null, "fcnet_bias_initializer_config": null, "conv_filters": null, "conv_activation": "relu", "conv_kernel_initializer": null, "conv_kernel_initializer_config": null, "conv_bias_initializer": null, "conv_bias_initializer_config": null, "conv_transpose_kernel_initializer": null, "conv_transpose_kernel_initializer_config": null, "conv_transpose_bias_initializer": null, "conv_transpose_bias_initializer_config": null, "post_fcnet_hiddens": [], "post_fcnet_activation": "relu", "post_fcnet_weights_initializer": null, "post_fcnet_weights_initializer_config": null, "post_fcnet_bias_initializer": null, "post_fcnet_bias_initializer_config": null, "free_log_std": false, "log_std_clip_param": 20.0, "no_final_linear": false, "vf_share_layers": false, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "lstm_weights_initializer": null, "lstm_weights_initializer_config": null, "lstm_bias_initializer": null, "lstm_bias_initializer_config": null, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "attention_use_n_prev_actions": 0, "attention_use_n_prev_rewards": 0, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": null, "custom_model_config": {}, "custom_action_dist": null, "custom_preprocessor": null, "encoder_latent_dim": null, "always_check_shapes": false, "lstm_use_prev_action_reward": -1, "_use_default_native_models": -1, "_disable_preprocessor_api": false, "_disable_action_flattening": false}, "_learner_connector": null, "add_default_connectors_to_learner_pipeline": true, "learner_config_dict": {}, "optimizer": {}, "_learner_class": null, "callbacks_on_algorithm_init": null, "callbacks_on_env_runners_recreated": null, "callbacks_on_offline_eval_runners_recreated": null, "callbacks_on_checkpoint_loaded": null, "callbacks_on_environment_created": null, "callbacks_on_episode_created": null, "callbacks_on_episode_start": null, "callbacks_on_episode_step": null, "callbacks_on_episode_end": null, "callbacks_on_evaluate_start": null, "callbacks_on_evaluate_end": null, "callbacks_on_evaluate_offline_start": null, "callbacks_on_evaluate_offline_end": null, "callbacks_on_sample_end": null, "callbacks_on_train_result": null, "explore": true, "enable_rl_module_and_learner": true, "enable_env_runner_and_connector_v2": true, "_prior_exploration_config": {"type": "StochasticSampling"}, "count_steps_by": "env_steps", "policy_map_capacity": 100, "policy_mapping_fn": "<function AlgorithmConfig.DEFAULT_POLICY_MAPPING_FN at 0x3855e5b20>", "policies_to_train": null, "policy_states_are_swappable": false, "observation_fn": null, "offline_data_class": null, "input_read_method": "read_parquet", "input_read_method_kwargs": {}, "input_read_schema": {}, "input_read_episodes": false, "input_read_sample_batches": false, "input_read_batch_size": null, "input_filesystem": null, "input_filesystem_kwargs": {}, "input_compress_columns": ["obs", "new_obs"], "input_spaces_jsonable": true, "materialize_data": false, "materialize_mapped_data": true, "map_batches_kwargs": {}, "iter_batches_kwargs": {}, "ignore_final_observation": false, "prelearner_class": null, "prelearner_buffer_class": null, "prelearner_buffer_kwargs": {}, "prelearner_module_synch_period": 10, "dataset_num_iters_per_learner": null, "input_config": {}, "actions_in_input_normalized": false, "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_config": {}, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "output_max_rows_per_file": null, "output_write_remaining_data": false, "output_write_method": "write_parquet", "output_write_method_kwargs": {}, "output_filesystem": null, "output_filesystem_kwargs": {}, "output_write_episodes": true, "offline_sampling": false, "evaluation_interval": 1, "evaluation_duration": 20, "evaluation_duration_unit": "episodes", "evaluation_sample_timeout_s": 120.0, "evaluation_auto_duration_min_env_steps_per_sample": 100, "evaluation_auto_duration_max_env_steps_per_sample": 2000, "evaluation_parallel_to_training": false, "evaluation_force_reset_envs_before_iteration": true, "evaluation_config": null, "off_policy_estimation_methods": {}, "ope_split_batch_by_episode": true, "evaluation_num_env_runners": 1, "in_evaluation": false, "sync_filters_on_rollout_workers_timeout_s": 10.0, "offline_evaluation_interval": null, "num_offline_eval_runners": 0, "offline_loss_for_module_fn": null, "offline_evaluation_duration": 1, "offline_evaluation_parallel_to_training": false, "offline_evaluation_timeout_s": 120.0, "num_cpus_per_offline_eval_runner": 1, "num_gpus_per_offline_eval_runner": 0, "custom_resources_per_offline_eval_runner": {}, "restart_failed_offline_eval_runners": true, "ignore_offline_eval_runner_failures": false, "max_num_offline_eval_runner_restarts": 1000, "offline_eval_runner_restore_timeout_s": 1800.0, "max_requests_in_flight_per_offline_eval_runner": 1, "validate_offline_eval_runners_after_construction": true, "offline_eval_runner_health_probe_timeout_s": 30.0, "offline_eval_rl_module_inference_only": false, "broadcast_offline_eval_runner_states": false, "offline_eval_batch_size_per_runner": 256, "dataset_num_iters_per_eval_runner": 1, "keep_per_episode_custom_metrics": false, "metrics_episode_collection_timeout_s": 60.0, "metrics_num_episodes_for_smoothing": 100, "min_time_s_per_iteration": null, "min_train_timesteps_per_iteration": 0, "min_sample_timesteps_per_iteration": 0, "log_gradients": true, "export_native_model_files": false, "checkpoint_trainable_policies_only": false, "logger_creator": null, "logger_config": null, "log_level": "WARN", "log_sys_usage": true, "fake_sampler": false, "seed": 2, "restart_failed_env_runners": true, "ignore_env_runner_failures": false, "max_num_env_runner_restarts": 1000, "delay_between_env_runner_restarts_s": 60.0, "restart_failed_sub_environments": false, "num_consecutive_env_runner_failures_tolerance": 100, "env_runner_health_probe_timeout_s": 30.0, "env_runner_restore_timeout_s": 1800.0, "_model_config": {}, "_rl_module_spec": "RLModuleSpec(module_class=None, observation_space=None, action_space=None, inference_only=False, learner_only=False, model_config=DefaultModelConfig(fcnet_hiddens=[60, 90], fcnet_activation='tanh', fcnet_kernel_initializer=None, fcnet_kernel_initializer_kwargs=None, fcnet_bias_initializer=None, fcnet_bias_initializer_kwargs=None, conv_filters=None, conv_activation='relu', conv_kernel_initializer=None, conv_kernel_initializer_kwargs=None, conv_bias_initializer=None, conv_bias_initializer_kwargs=None, head_fcnet_hiddens=[], head_fcnet_activation='relu', head_fcnet_kernel_initializer=None, head_fcnet_kernel_initializer_kwargs=None, head_fcnet_bias_initializer=None, head_fcnet_bias_initializer_kwargs=None, free_log_std=False, log_std_clip_param=20.0, vf_share_layers=True, use_lstm=False, max_seq_len=20, lstm_cell_size=256, lstm_use_prev_action=False, lstm_use_prev_reward=False, lstm_kernel_initializer=None, lstm_kernel_initializer_kwargs=None, lstm_bias_initializer=None, lstm_bias_initializer_kwargs=None), catalog_class=None, load_state_path=None, model_config_dict=None)", "algorithm_config_overrides_per_module": {}, "_per_module_overrides": {}, "_validate_config": true, "_use_msgpack_checkpoints": false, "_torch_grad_scaler_class": null, "_torch_lr_scheduler_classes": null, "_tf_policy_handles_more_than_one_loss": false, "_disable_preprocessor_api": false, "_disable_action_flattening": false, "_disable_initialize_loss_from_dummy_batch": false, "_dont_auto_sync_env_runner_states": false, "env_task_fn": -1, "enable_connectors": -1, "simple_optimizer": false, "policy_map_cache": -1, "worker_cls": -1, "synchronize_filters": -1, "enable_async_evaluation": -1, "custom_async_evaluation_function": -1, "_enable_rl_module_api": -1, "auto_wrap_old_gym_envs": -1, "always_attach_evaluation_results": -1, "replay_sequence_length": null, "_disable_execution_plan_api": -1, "use_critic": true, "use_gae": true, "use_kl_loss": true, "kl_coeff": 0.7464963036515, "kl_target": 0.0270990929592, "vf_loss_coeff": 0.6688075857018, "entropy_coeff": 0.0090570820258, "clip_param": 0.1221781641624, "vf_clip_param": 0.1027808522125, "entropy_coeff_schedule": null, "lr_schedule": null, "sgd_minibatch_size": -1, "vf_share_layers": -1, "__stdout_file__": null, "__stderr_file__": null, "lambda": 0.9099046732075, "input": "sampler", "policies": {"default_policy": [null, null, null, null]}, "callbacks": "<class 'ray.rllib.callbacks.callbacks.RLlibCallback'>", "create_env_on_driver": false, "custom_eval_function": null, "framework": "torch"}, "time_since_restore": 5.086329221725464, "iterations_since_restore": 3, "perf": {"cpu_util_percent": 47.76666666666667, "ram_util_percent": 77.83333333333334}}
{"timers": {"training_iteration": 1.6086713366109318, "restore_env_runners": 1.2810307344305331e-05, "training_step": 1.6085372381203413, "env_runner_sampling_timer": 1.4978805029278617, "learner_update_timer": 0.10757366234378923, "synch_weights": 0.0005905875823470996, "restore_eval_env_runners": 9.639675740618259e-06, "evaluation_iteration": 0.11407877425946061, "synch_eval_env_connectors": 0.00013913629938615488, "synch_env_connectors": 4.416864516679197e-06}, "env_runners": {"env_step_timer": 1.3963202993438548e-05, "num_agent_steps_sampled_lifetime": {"default_agent": -1225000.0}, "episode_duration_sec_mean": 0.004581959643866867, "env_to_module_connector": {"timers": {"connectors": {"add_time_dim_to_batch_and_zero_pad": 2.365164801505055e-06, "add_observations_from_episodes_to_batch": 3.070713273023125e-06, "batch_individual_items": 6.372294043422515e-06, "add_states_from_episodes_to_batch": 1.7483817580003214e-06, "numpy_to_tensor": 8.719268067402884e-06}}, "connector_pipeline_timer": 4.403275706582152e-05}, "num_env_steps_sampled_lifetime": -1225000.0, "episode_return_mean": 0.7399999999999999, "module_to_env_connector": {"timers": {"connectors": {"tensor_to_numpy": 1.3093980968501975e-05, "normalize_and_clip_actions": 9.538759354440068e-06, "listify_data_for_vector_env": 1.115427879080306e-05, "remove_single_ts_time_rank_from_batch": 6.023608966107621e-07, "get_actions": 3.8648354375301686e-05, "un_batch_to_individual_items": 5.446316543312185e-06}}, "connector_pipeline_timer": 0.00010426045832255903}, "weights_seq_no": 3.0, "env_to_module_sum_episodes_length_out": 10.36823839457432, "episode_len_min": 20, "num_agent_steps_sampled": {"default_agent": 5000.0}, "env_reset_timer": 4.045276484590983e-05, "rlmodule_inference_timer": 2.7806810147266002e-05, "num_env_steps_sampled": 5000.0, "env_to_module_sum_episodes_length_in": 10.36823839457432, "num_module_steps_sampled": {"default_policy": 5000.0}, "episode_len_mean": 20.0, "episode_len_max": 20, "num_episodes": 250.0, "num_episodes_lifetime": -61250.0, "time_between_sampling": 0.001916692657913713, "episode_return_min": -11.5, "agent_episode_returns_mean": {"default_agent": 0.7399999999999999}, "episode_return_max": 8.5, "num_module_steps_sampled_lifetime": {"default_policy": -1225000.0}, "module_episode_returns_mean": {"default_policy": 0.7399999999999999}, "sample": 0.004957787132452977, "num_env_steps_sampled_lifetime_throughput": 3665.194884948365}, "learners": {"__all_modules__": {"learner_connector": {"timers": {"connectors": {"add_states_from_episodes_to_batch": 3.6188023140421133e-06, "numpy_to_tensor": 8.055339431227187e-05, "batch_individual_items": 0.03214909489947777, "add_columns_from_episodes_to_train_batch": 0.034488824403052454, "add_time_dim_to_batch_and_zero_pad": 1.2357180257095024e-05, "add_observations_from_episodes_to_batch": 0.0008507133460796903, "add_one_ts_to_episodes_and_truncate": 0.007592138182541937, "general_advantage_estimation": 0.006770666987167555}}, "connector_pipeline_timer": 0.08209841007728445}, "num_env_steps_trained": 31500, "learner_connector_sum_episodes_length_out": 5250.0, "num_non_trainable_parameters": 0, "num_module_steps_trained_lifetime": 24000, "learner_connector_sum_episodes_length_in": 5000.0, "num_env_steps_trained_lifetime": 126000, "num_module_steps_trained": 6000, "num_trainable_parameters": 6003, "num_env_steps_trained_lifetime_throughput": 2187591.710993989, "num_module_steps_trained_throughput": 418823.4886805364, "num_module_steps_trained_lifetime_throughput": 418019.9976821611}, "default_policy": {"num_module_steps_trained_lifetime": 24000, "gradients_default_optimizer_global_norm": 0.0398266464471817, "total_loss": 0.13474135100841522, "weights_seq_no": 4.0, "diff_num_grad_updates_vs_sampler_policy": 1.0, "num_module_steps_trained": 6000, "vf_loss": 0.10278083384037018, "entropy": 0.6283105611801147, "vf_explained_var": -0.013248324394226074, "curr_kl_coeff": 0.04665601998567581, "default_optimizer_learning_rate": 0.0002847858517, "num_trainable_parameters": 6003, "module_train_batch_size_mean": 1000.0, "vf_loss_unclipped": 28.65396499633789, "policy_loss": 0.07163538783788681, "mean_kl_loss": 0.0006002793088555336, "curr_entropy_coeff": 0.0090570820258, "num_module_steps_trained_lifetime_throughput": 419659.31515162427}}, "num_training_step_calls_per_iteration": 1, "evaluation": {"env_runners": {"num_episodes": 20, "env_to_module_connector": {"timers": {"connectors": {"add_states_from_episodes_to_batch": 1.6167055940000505e-06, "numpy_to_tensor": 8.371274701170732e-06, "batch_individual_items": 6.099621449184325e-06, "add_time_dim_to_batch_and_zero_pad": 2.311760571077145e-06, "add_observations_from_episodes_to_batch": 2.829023916774464e-06}}, "connector_pipeline_timer": 4.2732575912128984e-05}, "sample": 0.10703771906361391, "module_to_env_connector": {"timers": {"connectors": {"get_actions": 3.692636070475263e-05, "remove_single_ts_time_rank_from_batch": 5.690329866573205e-07, "normalize_and_clip_actions": 9.566043826941025e-06, "un_batch_to_individual_items": 5.344493730530175e-06, "tensor_to_numpy": 1.313573222373915e-05, "listify_data_for_vector_env": 1.0967207617794654e-05}}, "connector_pipeline_timer": 0.00010197097452854987}, "episode_duration_sec_mean": 0.0048083583707921205, "module_episode_returns_mean": {"default_policy": 1.05}, "num_env_steps_sampled_lifetime": 20400, "episode_len_min": 20, "num_agent_steps_sampled_lifetime": {"default_agent": 1600}, "episode_len_max": 20, "num_episodes_lifetime": 80, "episode_return_min": -14.5, "env_step_timer": 1.4055346781244679e-05, "env_to_module_sum_episodes_length_out": 10.368237912813044, "num_agent_steps_sampled": {"default_agent": 400}, "env_to_module_sum_episodes_length_in": 10.368237912813044, "episode_return_max": 14.5, "agent_episode_returns_mean": {"default_agent": 1.05}, "num_module_steps_sampled_lifetime": {"default_policy": 1600}, "weights_seq_no": 4.0, "env_reset_timer": 0.00023078719613479911, "episode_len_mean": 20.0, "num_module_steps_sampled": {"default_policy": 400}, "episode_return_mean": 1.05, "rlmodule_inference_timer": 2.7832766522982227e-05, "num_env_steps_sampled": 400, "time_between_sampling": 1.6105011286019464}, "num_healthy_workers": 1, "actor_manager_num_outstanding_async_reqs": 0, "num_remote_worker_restarts": 0}, "num_env_steps_sampled_lifetime": -1225000.0, "fault_tolerance": {"num_healthy_workers": 0, "num_remote_worker_restarts": 0}, "env_runner_group": {"actor_manager_num_outstanding_async_reqs": 0}, "done": false, "training_iteration": 4, "trial_id": "43bd0_00000", "date": "2025-08-11_19-24-26", "timestamp": 1754933066, "time_this_iter_s": 1.6946818828582764, "time_total_s": 6.78101110458374, "pid": 14505, "hostname": "Mac", "node_ip": "127.0.0.1", "config": {"exploration_config": {}, "extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "placement_strategy": "PACK", "num_gpus": 0, "_fake_gpus": false, "num_cpus_for_main_process": 2, "eager_tracing": true, "eager_max_retraces": 20, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "torch_compile_learner": false, "torch_compile_learner_what_to_compile": "forward_train", "torch_compile_learner_dynamo_backend": "aot_eager", "torch_compile_learner_dynamo_mode": null, "torch_compile_worker": false, "torch_compile_worker_dynamo_backend": "aot_eager", "torch_compile_worker_dynamo_mode": null, "torch_ddp_kwargs": {}, "torch_skip_nan_gradients": false, "env": "Umbrella", "env_config": {}, "observation_space": null, "action_space": null, "clip_rewards": null, "normalize_actions": true, "clip_actions": false, "_is_atari": null, "disable_env_checking": false, "render_env": false, "action_mask_key": "action_mask", "env_runner_cls": null, "num_env_runners": 0, "create_local_env_runner": true, "num_envs_per_env_runner": 1, "gym_env_vectorize_mode": "SYNC", "num_cpus_per_env_runner": 1, "num_gpus_per_env_runner": 0, "custom_resources_per_env_runner": {}, "validate_env_runners_after_construction": true, "episodes_to_numpy": true, "max_requests_in_flight_per_env_runner": 1, "sample_timeout_s": 60.0, "_env_to_module_connector": null, "add_default_connectors_to_env_to_module_pipeline": true, "_module_to_env_connector": null, "add_default_connectors_to_module_to_env_pipeline": true, "merge_env_runner_states": "training_only", "broadcast_env_runner_states": true, "episode_lookback_horizon": 1, "rollout_fragment_length": "auto", "batch_mode": "complete_episodes", "compress_observations": false, "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "enable_tf1_exec_eagerly": false, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "preprocessor_pref": "deepmind", "observation_filter": "NoFilter", "update_worker_filter_stats": true, "use_worker_filter_stats": true, "sampler_perf_stats_ema_coef": null, "_is_online": true, "num_learners": 0, "num_gpus_per_learner": 0, "num_cpus_per_learner": "auto", "num_aggregator_actors_per_learner": 0, "max_requests_in_flight_per_aggregator_actor": 3, "local_gpu_idx": 0, "max_requests_in_flight_per_learner": 3, "gamma": 1, "lr": 0.0002847858517, "grad_clip": 0.5, "grad_clip_by": "global_norm", "_train_batch_size_per_learner": 5000, "train_batch_size": 4000, "num_epochs": 1, "minibatch_size": 1000, "shuffle_batch_per_epoch": true, "model": {"fcnet_hiddens": [256, 256], "fcnet_activation": "tanh", "fcnet_weights_initializer": null, "fcnet_weights_initializer_config": null, "fcnet_bias_initializer": null, "fcnet_bias_initializer_config": null, "conv_filters": null, "conv_activation": "relu", "conv_kernel_initializer": null, "conv_kernel_initializer_config": null, "conv_bias_initializer": null, "conv_bias_initializer_config": null, "conv_transpose_kernel_initializer": null, "conv_transpose_kernel_initializer_config": null, "conv_transpose_bias_initializer": null, "conv_transpose_bias_initializer_config": null, "post_fcnet_hiddens": [], "post_fcnet_activation": "relu", "post_fcnet_weights_initializer": null, "post_fcnet_weights_initializer_config": null, "post_fcnet_bias_initializer": null, "post_fcnet_bias_initializer_config": null, "free_log_std": false, "log_std_clip_param": 20.0, "no_final_linear": false, "vf_share_layers": false, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "lstm_weights_initializer": null, "lstm_weights_initializer_config": null, "lstm_bias_initializer": null, "lstm_bias_initializer_config": null, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "attention_use_n_prev_actions": 0, "attention_use_n_prev_rewards": 0, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": null, "custom_model_config": {}, "custom_action_dist": null, "custom_preprocessor": null, "encoder_latent_dim": null, "always_check_shapes": false, "lstm_use_prev_action_reward": -1, "_use_default_native_models": -1, "_disable_preprocessor_api": false, "_disable_action_flattening": false}, "_learner_connector": null, "add_default_connectors_to_learner_pipeline": true, "learner_config_dict": {}, "optimizer": {}, "_learner_class": null, "callbacks_on_algorithm_init": null, "callbacks_on_env_runners_recreated": null, "callbacks_on_offline_eval_runners_recreated": null, "callbacks_on_checkpoint_loaded": null, "callbacks_on_environment_created": null, "callbacks_on_episode_created": null, "callbacks_on_episode_start": null, "callbacks_on_episode_step": null, "callbacks_on_episode_end": null, "callbacks_on_evaluate_start": null, "callbacks_on_evaluate_end": null, "callbacks_on_evaluate_offline_start": null, "callbacks_on_evaluate_offline_end": null, "callbacks_on_sample_end": null, "callbacks_on_train_result": null, "explore": true, "enable_rl_module_and_learner": true, "enable_env_runner_and_connector_v2": true, "_prior_exploration_config": {"type": "StochasticSampling"}, "count_steps_by": "env_steps", "policy_map_capacity": 100, "policy_mapping_fn": "<function AlgorithmConfig.DEFAULT_POLICY_MAPPING_FN at 0x3855e5b20>", "policies_to_train": null, "policy_states_are_swappable": false, "observation_fn": null, "offline_data_class": null, "input_read_method": "read_parquet", "input_read_method_kwargs": {}, "input_read_schema": {}, "input_read_episodes": false, "input_read_sample_batches": false, "input_read_batch_size": null, "input_filesystem": null, "input_filesystem_kwargs": {}, "input_compress_columns": ["obs", "new_obs"], "input_spaces_jsonable": true, "materialize_data": false, "materialize_mapped_data": true, "map_batches_kwargs": {}, "iter_batches_kwargs": {}, "ignore_final_observation": false, "prelearner_class": null, "prelearner_buffer_class": null, "prelearner_buffer_kwargs": {}, "prelearner_module_synch_period": 10, "dataset_num_iters_per_learner": null, "input_config": {}, "actions_in_input_normalized": false, "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_config": {}, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "output_max_rows_per_file": null, "output_write_remaining_data": false, "output_write_method": "write_parquet", "output_write_method_kwargs": {}, "output_filesystem": null, "output_filesystem_kwargs": {}, "output_write_episodes": true, "offline_sampling": false, "evaluation_interval": 1, "evaluation_duration": 20, "evaluation_duration_unit": "episodes", "evaluation_sample_timeout_s": 120.0, "evaluation_auto_duration_min_env_steps_per_sample": 100, "evaluation_auto_duration_max_env_steps_per_sample": 2000, "evaluation_parallel_to_training": false, "evaluation_force_reset_envs_before_iteration": true, "evaluation_config": null, "off_policy_estimation_methods": {}, "ope_split_batch_by_episode": true, "evaluation_num_env_runners": 1, "in_evaluation": false, "sync_filters_on_rollout_workers_timeout_s": 10.0, "offline_evaluation_interval": null, "num_offline_eval_runners": 0, "offline_loss_for_module_fn": null, "offline_evaluation_duration": 1, "offline_evaluation_parallel_to_training": false, "offline_evaluation_timeout_s": 120.0, "num_cpus_per_offline_eval_runner": 1, "num_gpus_per_offline_eval_runner": 0, "custom_resources_per_offline_eval_runner": {}, "restart_failed_offline_eval_runners": true, "ignore_offline_eval_runner_failures": false, "max_num_offline_eval_runner_restarts": 1000, "offline_eval_runner_restore_timeout_s": 1800.0, "max_requests_in_flight_per_offline_eval_runner": 1, "validate_offline_eval_runners_after_construction": true, "offline_eval_runner_health_probe_timeout_s": 30.0, "offline_eval_rl_module_inference_only": false, "broadcast_offline_eval_runner_states": false, "offline_eval_batch_size_per_runner": 256, "dataset_num_iters_per_eval_runner": 1, "keep_per_episode_custom_metrics": false, "metrics_episode_collection_timeout_s": 60.0, "metrics_num_episodes_for_smoothing": 100, "min_time_s_per_iteration": null, "min_train_timesteps_per_iteration": 0, "min_sample_timesteps_per_iteration": 0, "log_gradients": true, "export_native_model_files": false, "checkpoint_trainable_policies_only": false, "logger_creator": null, "logger_config": null, "log_level": "WARN", "log_sys_usage": true, "fake_sampler": false, "seed": 2, "restart_failed_env_runners": true, "ignore_env_runner_failures": false, "max_num_env_runner_restarts": 1000, "delay_between_env_runner_restarts_s": 60.0, "restart_failed_sub_environments": false, "num_consecutive_env_runner_failures_tolerance": 100, "env_runner_health_probe_timeout_s": 30.0, "env_runner_restore_timeout_s": 1800.0, "_model_config": {}, "_rl_module_spec": "RLModuleSpec(module_class=None, observation_space=None, action_space=None, inference_only=False, learner_only=False, model_config=DefaultModelConfig(fcnet_hiddens=[60, 90], fcnet_activation='tanh', fcnet_kernel_initializer=None, fcnet_kernel_initializer_kwargs=None, fcnet_bias_initializer=None, fcnet_bias_initializer_kwargs=None, conv_filters=None, conv_activation='relu', conv_kernel_initializer=None, conv_kernel_initializer_kwargs=None, conv_bias_initializer=None, conv_bias_initializer_kwargs=None, head_fcnet_hiddens=[], head_fcnet_activation='relu', head_fcnet_kernel_initializer=None, head_fcnet_kernel_initializer_kwargs=None, head_fcnet_bias_initializer=None, head_fcnet_bias_initializer_kwargs=None, free_log_std=False, log_std_clip_param=20.0, vf_share_layers=True, use_lstm=False, max_seq_len=20, lstm_cell_size=256, lstm_use_prev_action=False, lstm_use_prev_reward=False, lstm_kernel_initializer=None, lstm_kernel_initializer_kwargs=None, lstm_bias_initializer=None, lstm_bias_initializer_kwargs=None), catalog_class=None, load_state_path=None, model_config_dict=None)", "algorithm_config_overrides_per_module": {}, "_per_module_overrides": {}, "_validate_config": true, "_use_msgpack_checkpoints": false, "_torch_grad_scaler_class": null, "_torch_lr_scheduler_classes": null, "_tf_policy_handles_more_than_one_loss": false, "_disable_preprocessor_api": false, "_disable_action_flattening": false, "_disable_initialize_loss_from_dummy_batch": false, "_dont_auto_sync_env_runner_states": false, "env_task_fn": -1, "enable_connectors": -1, "simple_optimizer": false, "policy_map_cache": -1, "worker_cls": -1, "synchronize_filters": -1, "enable_async_evaluation": -1, "custom_async_evaluation_function": -1, "_enable_rl_module_api": -1, "auto_wrap_old_gym_envs": -1, "always_attach_evaluation_results": -1, "replay_sequence_length": null, "_disable_execution_plan_api": -1, "use_critic": true, "use_gae": true, "use_kl_loss": true, "kl_coeff": 0.7464963036515, "kl_target": 0.0270990929592, "vf_loss_coeff": 0.6688075857018, "entropy_coeff": 0.0090570820258, "clip_param": 0.1221781641624, "vf_clip_param": 0.1027808522125, "entropy_coeff_schedule": null, "lr_schedule": null, "sgd_minibatch_size": -1, "vf_share_layers": -1, "__stdout_file__": null, "__stderr_file__": null, "lambda": 0.9099046732075, "input": "sampler", "policies": {"default_policy": [null, null, null, null]}, "callbacks": "<class 'ray.rllib.callbacks.callbacks.RLlibCallback'>", "create_env_on_driver": false, "custom_eval_function": null, "framework": "torch"}, "time_since_restore": 6.78101110458374, "iterations_since_restore": 4, "perf": {"cpu_util_percent": 22.5, "ram_util_percent": 77.35}}
{"timers": {"training_iteration": 1.608379076575859, "restore_env_runners": 1.2746784506492552e-05, "training_step": 1.6082440878191917, "env_runner_sampling_timer": 1.497751852068418, "learner_update_timer": 0.10740864238020643, "synch_weights": 0.0005903037865852133, "restore_eval_env_runners": 9.650369437760673e-06, "evaluation_iteration": 0.11397734735767089, "synch_eval_env_connectors": 0.00013894659629894887, "synch_env_connectors": 4.41269617609214e-06}, "env_runners": {"env_step_timer": 1.3839934276867583e-05, "num_agent_steps_sampled_lifetime": {"default_agent": -1842500.0}, "episode_duration_sec_mean": 0.00492961817421019, "env_to_module_connector": {"timers": {"connectors": {"add_time_dim_to_batch_and_zero_pad": 2.3650061724509847e-06, "add_observations_from_episodes_to_batch": 2.976112614655617e-06, "batch_individual_items": 6.335379863428779e-06, "add_states_from_episodes_to_batch": 1.7496544485637405e-06, "numpy_to_tensor": 8.700022294510876e-06}}, "connector_pipeline_timer": 4.4020053465642336e-05}, "num_env_steps_sampled_lifetime": -1842500.0, "episode_return_mean": 2.8199999999999994, "module_to_env_connector": {"timers": {"connectors": {"tensor_to_numpy": 1.3037150300098922e-05, "normalize_and_clip_actions": 9.523764616279597e-06, "listify_data_for_vector_env": 1.1105238197447506e-05, "remove_single_ts_time_rank_from_batch": 5.983133571016481e-07, "get_actions": 3.8418242884685634e-05, "un_batch_to_individual_items": 5.426622149143507e-06}}, "connector_pipeline_timer": 0.00010392415606602801}, "weights_seq_no": 4.0, "env_to_module_sum_episodes_length_out": 10.36823839457432, "episode_len_min": 20, "num_agent_steps_sampled": {"default_agent": 5000.0}, "env_reset_timer": 3.891701038085367e-05, "rlmodule_inference_timer": 4.627833103713985e-05, "num_env_steps_sampled": 5000.0, "env_to_module_sum_episodes_length_in": 10.36823839457432, "num_module_steps_sampled": {"default_policy": 5000.0}, "episode_len_mean": 20.0, "episode_len_max": 20, "num_episodes": 250.0, "num_episodes_lifetime": -92125.0, "time_between_sampling": 0.0016351402259278097, "episode_return_min": -11.5, "agent_episode_returns_mean": {"default_agent": 2.8199999999999994}, "episode_return_max": 8.5, "num_module_steps_sampled_lifetime": {"default_policy": -1842500.0}, "module_episode_returns_mean": {"default_policy": 2.8199999999999994}, "sample": 0.004967274273581998, "num_env_steps_sampled_lifetime_throughput": 3678.511467681547}, "learners": {"__all_modules__": {"learner_connector": {"timers": {"connectors": {"add_states_from_episodes_to_batch": 3.6142746018257453e-06, "numpy_to_tensor": 8.033702085061698e-05, "batch_individual_items": 0.03213239895118514, "add_columns_from_episodes_to_train_batch": 0.03448004532947928, "add_time_dim_to_batch_and_zero_pad": 1.2336948007403407e-05, "add_observations_from_episodes_to_batch": 0.0008500499626822233, "add_one_ts_to_episodes_and_truncate": 0.007591491390188036, "general_advantage_estimation": 0.006754293237852768}}, "connector_pipeline_timer": 0.08205447347652592}, "num_env_steps_trained": 31500, "learner_connector_sum_episodes_length_out": 5250.0, "num_non_trainable_parameters": 0, "num_module_steps_trained_lifetime": 30000, "learner_connector_sum_episodes_length_in": 5000.0, "num_env_steps_trained_lifetime": 157500, "num_module_steps_trained": 6000, "num_trainable_parameters": 6003, "num_env_steps_trained_lifetime_throughput": 2185393.184014953, "num_module_steps_trained_throughput": 418342.4969809535, "num_module_steps_trained_lifetime_throughput": 417558.7117453425}, "default_policy": {"num_module_steps_trained_lifetime": 30000, "gradients_default_optimizer_global_norm": 0.029085060581564903, "total_loss": 0.10586991161108017, "weights_seq_no": 5.0, "diff_num_grad_updates_vs_sampler_policy": 1.0, "num_module_steps_trained": 6000, "vf_loss": 0.10278083384037018, "entropy": 0.6176988482475281, "vf_explained_var": -0.010551810264587402, "curr_kl_coeff": 0.023328009992837906, "default_optimizer_learning_rate": 0.0002847858517, "num_trainable_parameters": 6003, "module_train_batch_size_mean": 1000.0, "vf_loss_unclipped": 28.329936981201172, "policy_loss": 0.042711563408374786, "mean_kl_loss": 0.0002633107651490718, "curr_entropy_coeff": 0.0090570820258, "num_module_steps_trained_lifetime_throughput": 419123.921075786}}, "num_training_step_calls_per_iteration": 1, "evaluation": {"env_runners": {"num_episodes": 20, "env_to_module_connector": {"timers": {"connectors": {"add_states_from_episodes_to_batch": 1.60274370403067e-06, "numpy_to_tensor": 8.446967525232364e-06, "batch_individual_items": 6.120354014993817e-06, "add_time_dim_to_batch_and_zero_pad": 2.2506660663218236e-06, "add_observations_from_episodes_to_batch": 2.8542958142948185e-06}}, "connector_pipeline_timer": 4.287807575705672e-05}, "sample": 0.10697192770277404, "module_to_env_connector": {"timers": {"connectors": {"get_actions": 3.817735546686084e-05, "remove_single_ts_time_rank_from_batch": 5.732311081595227e-07, "normalize_and_clip_actions": 9.61368249059257e-06, "un_batch_to_individual_items": 5.3601437892701155e-06, "tensor_to_numpy": 1.3311991897611623e-05, "listify_data_for_vector_env": 1.1041457822666335e-05}}, "connector_pipeline_timer": 0.000104124673322701}, "episode_duration_sec_mean": 0.0047680833737831566, "module_episode_returns_mean": {"default_policy": 0.6}, "num_env_steps_sampled_lifetime": 25400, "episode_len_min": 20, "num_agent_steps_sampled_lifetime": {"default_agent": 2000}, "episode_len_max": 20, "num_episodes_lifetime": 100, "episode_return_min": -14.5, "env_step_timer": 1.4319057463229336e-05, "env_to_module_sum_episodes_length_out": 10.368238387501162, "num_agent_steps_sampled": {"default_agent": 400}, "env_to_module_sum_episodes_length_in": 10.368238387501162, "episode_return_max": 14.5, "agent_episode_returns_mean": {"default_agent": 0.6}, "num_module_steps_sampled_lifetime": {"default_policy": 2000}, "weights_seq_no": 5.0, "env_reset_timer": 0.0002292947436536557, "episode_len_mean": 20.0, "num_module_steps_sampled": {"default_policy": 400}, "episode_return_mean": 0.6, "rlmodule_inference_timer": 2.827530066605608e-05, "num_env_steps_sampled": 400, "time_between_sampling": 1.610370271065339}, "num_healthy_workers": 1, "actor_manager_num_outstanding_async_reqs": 0, "num_remote_worker_restarts": 0}, "num_env_steps_sampled_lifetime": -1842500.0, "fault_tolerance": {"num_healthy_workers": 0, "num_remote_worker_restarts": 0}, "env_runner_group": {"actor_manager_num_outstanding_async_reqs": 0}, "done": false, "training_iteration": 5, "trial_id": "43bd0_00000", "date": "2025-08-11_19-24-27", "timestamp": 1754933067, "time_this_iter_s": 1.6867129802703857, "time_total_s": 8.467724084854126, "pid": 14505, "hostname": "Mac", "node_ip": "127.0.0.1", "config": {"exploration_config": {}, "extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "placement_strategy": "PACK", "num_gpus": 0, "_fake_gpus": false, "num_cpus_for_main_process": 2, "eager_tracing": true, "eager_max_retraces": 20, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "torch_compile_learner": false, "torch_compile_learner_what_to_compile": "forward_train", "torch_compile_learner_dynamo_backend": "aot_eager", "torch_compile_learner_dynamo_mode": null, "torch_compile_worker": false, "torch_compile_worker_dynamo_backend": "aot_eager", "torch_compile_worker_dynamo_mode": null, "torch_ddp_kwargs": {}, "torch_skip_nan_gradients": false, "env": "Umbrella", "env_config": {}, "observation_space": null, "action_space": null, "clip_rewards": null, "normalize_actions": true, "clip_actions": false, "_is_atari": null, "disable_env_checking": false, "render_env": false, "action_mask_key": "action_mask", "env_runner_cls": null, "num_env_runners": 0, "create_local_env_runner": true, "num_envs_per_env_runner": 1, "gym_env_vectorize_mode": "SYNC", "num_cpus_per_env_runner": 1, "num_gpus_per_env_runner": 0, "custom_resources_per_env_runner": {}, "validate_env_runners_after_construction": true, "episodes_to_numpy": true, "max_requests_in_flight_per_env_runner": 1, "sample_timeout_s": 60.0, "_env_to_module_connector": null, "add_default_connectors_to_env_to_module_pipeline": true, "_module_to_env_connector": null, "add_default_connectors_to_module_to_env_pipeline": true, "merge_env_runner_states": "training_only", "broadcast_env_runner_states": true, "episode_lookback_horizon": 1, "rollout_fragment_length": "auto", "batch_mode": "complete_episodes", "compress_observations": false, "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "enable_tf1_exec_eagerly": false, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "preprocessor_pref": "deepmind", "observation_filter": "NoFilter", "update_worker_filter_stats": true, "use_worker_filter_stats": true, "sampler_perf_stats_ema_coef": null, "_is_online": true, "num_learners": 0, "num_gpus_per_learner": 0, "num_cpus_per_learner": "auto", "num_aggregator_actors_per_learner": 0, "max_requests_in_flight_per_aggregator_actor": 3, "local_gpu_idx": 0, "max_requests_in_flight_per_learner": 3, "gamma": 1, "lr": 0.0002847858517, "grad_clip": 0.5, "grad_clip_by": "global_norm", "_train_batch_size_per_learner": 5000, "train_batch_size": 4000, "num_epochs": 1, "minibatch_size": 1000, "shuffle_batch_per_epoch": true, "model": {"fcnet_hiddens": [256, 256], "fcnet_activation": "tanh", "fcnet_weights_initializer": null, "fcnet_weights_initializer_config": null, "fcnet_bias_initializer": null, "fcnet_bias_initializer_config": null, "conv_filters": null, "conv_activation": "relu", "conv_kernel_initializer": null, "conv_kernel_initializer_config": null, "conv_bias_initializer": null, "conv_bias_initializer_config": null, "conv_transpose_kernel_initializer": null, "conv_transpose_kernel_initializer_config": null, "conv_transpose_bias_initializer": null, "conv_transpose_bias_initializer_config": null, "post_fcnet_hiddens": [], "post_fcnet_activation": "relu", "post_fcnet_weights_initializer": null, "post_fcnet_weights_initializer_config": null, "post_fcnet_bias_initializer": null, "post_fcnet_bias_initializer_config": null, "free_log_std": false, "log_std_clip_param": 20.0, "no_final_linear": false, "vf_share_layers": false, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "lstm_weights_initializer": null, "lstm_weights_initializer_config": null, "lstm_bias_initializer": null, "lstm_bias_initializer_config": null, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "attention_use_n_prev_actions": 0, "attention_use_n_prev_rewards": 0, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": null, "custom_model_config": {}, "custom_action_dist": null, "custom_preprocessor": null, "encoder_latent_dim": null, "always_check_shapes": false, "lstm_use_prev_action_reward": -1, "_use_default_native_models": -1, "_disable_preprocessor_api": false, "_disable_action_flattening": false}, "_learner_connector": null, "add_default_connectors_to_learner_pipeline": true, "learner_config_dict": {}, "optimizer": {}, "_learner_class": null, "callbacks_on_algorithm_init": null, "callbacks_on_env_runners_recreated": null, "callbacks_on_offline_eval_runners_recreated": null, "callbacks_on_checkpoint_loaded": null, "callbacks_on_environment_created": null, "callbacks_on_episode_created": null, "callbacks_on_episode_start": null, "callbacks_on_episode_step": null, "callbacks_on_episode_end": null, "callbacks_on_evaluate_start": null, "callbacks_on_evaluate_end": null, "callbacks_on_evaluate_offline_start": null, "callbacks_on_evaluate_offline_end": null, "callbacks_on_sample_end": null, "callbacks_on_train_result": null, "explore": true, "enable_rl_module_and_learner": true, "enable_env_runner_and_connector_v2": true, "_prior_exploration_config": {"type": "StochasticSampling"}, "count_steps_by": "env_steps", "policy_map_capacity": 100, "policy_mapping_fn": "<function AlgorithmConfig.DEFAULT_POLICY_MAPPING_FN at 0x3855e5b20>", "policies_to_train": null, "policy_states_are_swappable": false, "observation_fn": null, "offline_data_class": null, "input_read_method": "read_parquet", "input_read_method_kwargs": {}, "input_read_schema": {}, "input_read_episodes": false, "input_read_sample_batches": false, "input_read_batch_size": null, "input_filesystem": null, "input_filesystem_kwargs": {}, "input_compress_columns": ["obs", "new_obs"], "input_spaces_jsonable": true, "materialize_data": false, "materialize_mapped_data": true, "map_batches_kwargs": {}, "iter_batches_kwargs": {}, "ignore_final_observation": false, "prelearner_class": null, "prelearner_buffer_class": null, "prelearner_buffer_kwargs": {}, "prelearner_module_synch_period": 10, "dataset_num_iters_per_learner": null, "input_config": {}, "actions_in_input_normalized": false, "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_config": {}, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "output_max_rows_per_file": null, "output_write_remaining_data": false, "output_write_method": "write_parquet", "output_write_method_kwargs": {}, "output_filesystem": null, "output_filesystem_kwargs": {}, "output_write_episodes": true, "offline_sampling": false, "evaluation_interval": 1, "evaluation_duration": 20, "evaluation_duration_unit": "episodes", "evaluation_sample_timeout_s": 120.0, "evaluation_auto_duration_min_env_steps_per_sample": 100, "evaluation_auto_duration_max_env_steps_per_sample": 2000, "evaluation_parallel_to_training": false, "evaluation_force_reset_envs_before_iteration": true, "evaluation_config": null, "off_policy_estimation_methods": {}, "ope_split_batch_by_episode": true, "evaluation_num_env_runners": 1, "in_evaluation": false, "sync_filters_on_rollout_workers_timeout_s": 10.0, "offline_evaluation_interval": null, "num_offline_eval_runners": 0, "offline_loss_for_module_fn": null, "offline_evaluation_duration": 1, "offline_evaluation_parallel_to_training": false, "offline_evaluation_timeout_s": 120.0, "num_cpus_per_offline_eval_runner": 1, "num_gpus_per_offline_eval_runner": 0, "custom_resources_per_offline_eval_runner": {}, "restart_failed_offline_eval_runners": true, "ignore_offline_eval_runner_failures": false, "max_num_offline_eval_runner_restarts": 1000, "offline_eval_runner_restore_timeout_s": 1800.0, "max_requests_in_flight_per_offline_eval_runner": 1, "validate_offline_eval_runners_after_construction": true, "offline_eval_runner_health_probe_timeout_s": 30.0, "offline_eval_rl_module_inference_only": false, "broadcast_offline_eval_runner_states": false, "offline_eval_batch_size_per_runner": 256, "dataset_num_iters_per_eval_runner": 1, "keep_per_episode_custom_metrics": false, "metrics_episode_collection_timeout_s": 60.0, "metrics_num_episodes_for_smoothing": 100, "min_time_s_per_iteration": null, "min_train_timesteps_per_iteration": 0, "min_sample_timesteps_per_iteration": 0, "log_gradients": true, "export_native_model_files": false, "checkpoint_trainable_policies_only": false, "logger_creator": null, "logger_config": null, "log_level": "WARN", "log_sys_usage": true, "fake_sampler": false, "seed": 2, "restart_failed_env_runners": true, "ignore_env_runner_failures": false, "max_num_env_runner_restarts": 1000, "delay_between_env_runner_restarts_s": 60.0, "restart_failed_sub_environments": false, "num_consecutive_env_runner_failures_tolerance": 100, "env_runner_health_probe_timeout_s": 30.0, "env_runner_restore_timeout_s": 1800.0, "_model_config": {}, "_rl_module_spec": "RLModuleSpec(module_class=None, observation_space=None, action_space=None, inference_only=False, learner_only=False, model_config=DefaultModelConfig(fcnet_hiddens=[60, 90], fcnet_activation='tanh', fcnet_kernel_initializer=None, fcnet_kernel_initializer_kwargs=None, fcnet_bias_initializer=None, fcnet_bias_initializer_kwargs=None, conv_filters=None, conv_activation='relu', conv_kernel_initializer=None, conv_kernel_initializer_kwargs=None, conv_bias_initializer=None, conv_bias_initializer_kwargs=None, head_fcnet_hiddens=[], head_fcnet_activation='relu', head_fcnet_kernel_initializer=None, head_fcnet_kernel_initializer_kwargs=None, head_fcnet_bias_initializer=None, head_fcnet_bias_initializer_kwargs=None, free_log_std=False, log_std_clip_param=20.0, vf_share_layers=True, use_lstm=False, max_seq_len=20, lstm_cell_size=256, lstm_use_prev_action=False, lstm_use_prev_reward=False, lstm_kernel_initializer=None, lstm_kernel_initializer_kwargs=None, lstm_bias_initializer=None, lstm_bias_initializer_kwargs=None), catalog_class=None, load_state_path=None, model_config_dict=None)", "algorithm_config_overrides_per_module": {}, "_per_module_overrides": {}, "_validate_config": true, "_use_msgpack_checkpoints": false, "_torch_grad_scaler_class": null, "_torch_lr_scheduler_classes": null, "_tf_policy_handles_more_than_one_loss": false, "_disable_preprocessor_api": false, "_disable_action_flattening": false, "_disable_initialize_loss_from_dummy_batch": false, "_dont_auto_sync_env_runner_states": false, "env_task_fn": -1, "enable_connectors": -1, "simple_optimizer": false, "policy_map_cache": -1, "worker_cls": -1, "synchronize_filters": -1, "enable_async_evaluation": -1, "custom_async_evaluation_function": -1, "_enable_rl_module_api": -1, "auto_wrap_old_gym_envs": -1, "always_attach_evaluation_results": -1, "replay_sequence_length": null, "_disable_execution_plan_api": -1, "use_critic": true, "use_gae": true, "use_kl_loss": true, "kl_coeff": 0.7464963036515, "kl_target": 0.0270990929592, "vf_loss_coeff": 0.6688075857018, "entropy_coeff": 0.0090570820258, "clip_param": 0.1221781641624, "vf_clip_param": 0.1027808522125, "entropy_coeff_schedule": null, "lr_schedule": null, "sgd_minibatch_size": -1, "vf_share_layers": -1, "__stdout_file__": null, "__stderr_file__": null, "lambda": 0.9099046732075, "input": "sampler", "policies": {"default_policy": [null, null, null, null]}, "callbacks": "<class 'ray.rllib.callbacks.callbacks.RLlibCallback'>", "create_env_on_driver": false, "custom_eval_function": null, "framework": "torch"}, "time_since_restore": 8.467724084854126, "iterations_since_restore": 5, "perf": {"cpu_util_percent": 41.266666666666666, "ram_util_percent": 77.56666666666666}}
{"timers": {"training_iteration": 1.6079892237296687, "restore_env_runners": 1.2677226299117218e-05, "training_step": 1.6078536556910474, "env_runner_sampling_timer": 1.4965487847979444, "learner_update_timer": 0.1082209163665396, "synch_weights": 0.0005905107486777869, "restore_eval_env_runners": 9.619705592795507e-06, "evaluation_iteration": 0.11388821971420389, "synch_eval_env_connectors": 0.00013861713025824983, "synch_env_connectors": 4.406489177109907e-06}, "env_runners": {"env_step_timer": 1.3697537664303778e-05, "num_agent_steps_sampled_lifetime": {"default_agent": -2460000.0}, "episode_duration_sec_mean": 0.004516013176646083, "env_to_module_connector": {"timers": {"connectors": {"add_time_dim_to_batch_and_zero_pad": 2.349812035981577e-06, "add_observations_from_episodes_to_batch": 2.942724385653386e-06, "batch_individual_items": 6.266266591214859e-06, "add_states_from_episodes_to_batch": 1.7502075505486945e-06, "numpy_to_tensor": 8.567646080078176e-06}}, "connector_pipeline_timer": 4.352917095330641e-05}, "num_env_steps_sampled_lifetime": -2460000.0, "episode_return_mean": 2.34, "module_to_env_connector": {"timers": {"connectors": {"tensor_to_numpy": 1.293674951977822e-05, "normalize_and_clip_actions": 9.379495572444107e-06, "listify_data_for_vector_env": 1.1029087361898601e-05, "remove_single_ts_time_rank_from_batch": 5.911306243849772e-07, "get_actions": 3.788340775427081e-05, "un_batch_to_individual_items": 5.383376773198738e-06}}, "connector_pipeline_timer": 0.00010287244386137075}, "weights_seq_no": 5.0, "env_to_module_sum_episodes_length_out": 10.36823839457432, "episode_len_min": 20, "num_agent_steps_sampled": {"default_agent": 5000.0}, "env_reset_timer": 3.733104488919165e-05, "rlmodule_inference_timer": 2.7792304058958215e-05, "num_env_steps_sampled": 5000.0, "env_to_module_sum_episodes_length_in": 10.36823839457432, "num_module_steps_sampled": {"default_policy": 5000.0}, "episode_len_mean": 20.0, "episode_len_max": 20, "num_episodes": 250.0, "num_episodes_lifetime": -123000.0, "time_between_sampling": 0.0015225606064991452, "episode_return_min": -11.5, "agent_episode_returns_mean": {"default_agent": 2.34}, "episode_return_max": 8.5, "num_module_steps_sampled_lifetime": {"default_policy": -2460000.0}, "module_episode_returns_mean": {"default_policy": 2.34}, "sample": 0.005138949187330494, "num_env_steps_sampled_lifetime_throughput": 3721.8143697176874}, "learners": {"__all_modules__": {"learner_connector": {"timers": {"connectors": {"add_states_from_episodes_to_batch": 3.6089609613336965e-06, "numpy_to_tensor": 8.022322981603334e-05, "batch_individual_items": 0.03309295079111848, "add_columns_from_episodes_to_train_batch": 0.03447672570570464, "add_time_dim_to_batch_and_zero_pad": 1.230899834586482e-05, "add_observations_from_episodes_to_batch": 0.0008498119625238021, "add_one_ts_to_episodes_and_truncate": 0.007591836476054964, "general_advantage_estimation": 0.006738532395923946}}, "connector_pipeline_timer": 0.0829953620714267}, "num_env_steps_trained": 31500, "learner_connector_sum_episodes_length_out": 5250.0, "num_non_trainable_parameters": 0, "num_module_steps_trained_lifetime": 36000, "learner_connector_sum_episodes_length_in": 5000.0, "num_env_steps_trained_lifetime": 189000, "num_module_steps_trained": 6000, "num_trainable_parameters": 6003, "num_env_steps_trained_lifetime_throughput": 2187716.726107474, "num_module_steps_trained_throughput": 418718.85339452204, "num_module_steps_trained_lifetime_throughput": 417956.18049814535}, "default_policy": {"num_module_steps_trained_lifetime": 36000, "gradients_default_optimizer_global_norm": 0.044034115970134735, "total_loss": -0.1386224329471588, "weights_seq_no": 6.0, "diff_num_grad_updates_vs_sampler_policy": 1.0, "num_module_steps_trained": 6000, "vf_loss": 0.10278083384037018, "entropy": 0.6058812141418457, "vf_explained_var": -0.0063784122467041016, "curr_kl_coeff": 0.011664004996418953, "default_optimizer_learning_rate": 0.0002847858517, "num_trainable_parameters": 6003, "module_train_batch_size_mean": 1000.0, "vf_loss_unclipped": 28.01873207092285, "policy_loss": -0.2018829733133316, "mean_kl_loss": 0.0003197113692294806, "curr_entropy_coeff": 0.0090570820258, "num_module_steps_trained_lifetime_throughput": 419441.3510096912}}, "num_training_step_calls_per_iteration": 1, "evaluation": {"env_runners": {"num_episodes": 20, "env_to_module_connector": {"timers": {"connectors": {"add_states_from_episodes_to_batch": 1.6309490043203557e-06, "numpy_to_tensor": 8.574951797319224e-06, "batch_individual_items": 6.341612146947387e-06, "add_time_dim_to_batch_and_zero_pad": 2.2675767473539663e-06, "add_observations_from_episodes_to_batch": 2.921835319460636e-06}}, "connector_pipeline_timer": 4.371759632974434e-05}, "sample": 0.106884453836306, "module_to_env_connector": {"timers": {"connectors": {"get_actions": 3.7573680389435616e-05, "remove_single_ts_time_rank_from_batch": 5.727338864076213e-07, "normalize_and_clip_actions": 9.514490041110362e-06, "un_batch_to_individual_items": 5.395477577439424e-06, "tensor_to_numpy": 1.331128569058771e-05, "listify_data_for_vector_env": 1.1171345096575548e-05}}, "connector_pipeline_timer": 0.00010328490477448768}, "episode_duration_sec_mean": 0.004688865836942569, "module_episode_returns_mean": {"default_policy": 1.2}, "num_env_steps_sampled_lifetime": 30400, "episode_len_min": 20, "num_agent_steps_sampled_lifetime": {"default_agent": 2400}, "episode_len_max": 20, "num_episodes_lifetime": 120, "episode_return_min": -14.5, "env_step_timer": 1.4594070579318141e-05, "env_to_module_sum_episodes_length_out": 10.368238394470474, "num_agent_steps_sampled": {"default_agent": 400}, "env_to_module_sum_episodes_length_in": 10.368238394470474, "episode_return_max": 14.5, "agent_episode_returns_mean": {"default_agent": 1.2}, "num_module_steps_sampled_lifetime": {"default_policy": 2400}, "weights_seq_no": 6.0, "env_reset_timer": 0.0002277392965941185, "episode_len_mean": 20.0, "num_module_steps_sampled": {"default_policy": 400}, "episode_return_mean": 1.2, "rlmodule_inference_timer": 2.788200196119052e-05, "num_env_steps_sampled": 400, "time_between_sampling": 1.6101311129446894}, "num_healthy_workers": 1, "actor_manager_num_outstanding_async_reqs": 0, "num_remote_worker_restarts": 0}, "num_env_steps_sampled_lifetime": -2460000.0, "fault_tolerance": {"num_healthy_workers": 0, "num_remote_worker_restarts": 0}, "env_runner_group": {"actor_manager_num_outstanding_async_reqs": 0}, "done": false, "training_iteration": 6, "trial_id": "43bd0_00000", "date": "2025-08-11_19-24-29", "timestamp": 1754933069, "time_this_iter_s": 1.6746172904968262, "time_total_s": 10.142341375350952, "pid": 14505, "hostname": "Mac", "node_ip": "127.0.0.1", "config": {"exploration_config": {}, "extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "placement_strategy": "PACK", "num_gpus": 0, "_fake_gpus": false, "num_cpus_for_main_process": 2, "eager_tracing": true, "eager_max_retraces": 20, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "torch_compile_learner": false, "torch_compile_learner_what_to_compile": "forward_train", "torch_compile_learner_dynamo_backend": "aot_eager", "torch_compile_learner_dynamo_mode": null, "torch_compile_worker": false, "torch_compile_worker_dynamo_backend": "aot_eager", "torch_compile_worker_dynamo_mode": null, "torch_ddp_kwargs": {}, "torch_skip_nan_gradients": false, "env": "Umbrella", "env_config": {}, "observation_space": null, "action_space": null, "clip_rewards": null, "normalize_actions": true, "clip_actions": false, "_is_atari": null, "disable_env_checking": false, "render_env": false, "action_mask_key": "action_mask", "env_runner_cls": null, "num_env_runners": 0, "create_local_env_runner": true, "num_envs_per_env_runner": 1, "gym_env_vectorize_mode": "SYNC", "num_cpus_per_env_runner": 1, "num_gpus_per_env_runner": 0, "custom_resources_per_env_runner": {}, "validate_env_runners_after_construction": true, "episodes_to_numpy": true, "max_requests_in_flight_per_env_runner": 1, "sample_timeout_s": 60.0, "_env_to_module_connector": null, "add_default_connectors_to_env_to_module_pipeline": true, "_module_to_env_connector": null, "add_default_connectors_to_module_to_env_pipeline": true, "merge_env_runner_states": "training_only", "broadcast_env_runner_states": true, "episode_lookback_horizon": 1, "rollout_fragment_length": "auto", "batch_mode": "complete_episodes", "compress_observations": false, "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "enable_tf1_exec_eagerly": false, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "preprocessor_pref": "deepmind", "observation_filter": "NoFilter", "update_worker_filter_stats": true, "use_worker_filter_stats": true, "sampler_perf_stats_ema_coef": null, "_is_online": true, "num_learners": 0, "num_gpus_per_learner": 0, "num_cpus_per_learner": "auto", "num_aggregator_actors_per_learner": 0, "max_requests_in_flight_per_aggregator_actor": 3, "local_gpu_idx": 0, "max_requests_in_flight_per_learner": 3, "gamma": 1, "lr": 0.0002847858517, "grad_clip": 0.5, "grad_clip_by": "global_norm", "_train_batch_size_per_learner": 5000, "train_batch_size": 4000, "num_epochs": 1, "minibatch_size": 1000, "shuffle_batch_per_epoch": true, "model": {"fcnet_hiddens": [256, 256], "fcnet_activation": "tanh", "fcnet_weights_initializer": null, "fcnet_weights_initializer_config": null, "fcnet_bias_initializer": null, "fcnet_bias_initializer_config": null, "conv_filters": null, "conv_activation": "relu", "conv_kernel_initializer": null, "conv_kernel_initializer_config": null, "conv_bias_initializer": null, "conv_bias_initializer_config": null, "conv_transpose_kernel_initializer": null, "conv_transpose_kernel_initializer_config": null, "conv_transpose_bias_initializer": null, "conv_transpose_bias_initializer_config": null, "post_fcnet_hiddens": [], "post_fcnet_activation": "relu", "post_fcnet_weights_initializer": null, "post_fcnet_weights_initializer_config": null, "post_fcnet_bias_initializer": null, "post_fcnet_bias_initializer_config": null, "free_log_std": false, "log_std_clip_param": 20.0, "no_final_linear": false, "vf_share_layers": false, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "lstm_weights_initializer": null, "lstm_weights_initializer_config": null, "lstm_bias_initializer": null, "lstm_bias_initializer_config": null, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "attention_use_n_prev_actions": 0, "attention_use_n_prev_rewards": 0, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": null, "custom_model_config": {}, "custom_action_dist": null, "custom_preprocessor": null, "encoder_latent_dim": null, "always_check_shapes": false, "lstm_use_prev_action_reward": -1, "_use_default_native_models": -1, "_disable_preprocessor_api": false, "_disable_action_flattening": false}, "_learner_connector": null, "add_default_connectors_to_learner_pipeline": true, "learner_config_dict": {}, "optimizer": {}, "_learner_class": null, "callbacks_on_algorithm_init": null, "callbacks_on_env_runners_recreated": null, "callbacks_on_offline_eval_runners_recreated": null, "callbacks_on_checkpoint_loaded": null, "callbacks_on_environment_created": null, "callbacks_on_episode_created": null, "callbacks_on_episode_start": null, "callbacks_on_episode_step": null, "callbacks_on_episode_end": null, "callbacks_on_evaluate_start": null, "callbacks_on_evaluate_end": null, "callbacks_on_evaluate_offline_start": null, "callbacks_on_evaluate_offline_end": null, "callbacks_on_sample_end": null, "callbacks_on_train_result": null, "explore": true, "enable_rl_module_and_learner": true, "enable_env_runner_and_connector_v2": true, "_prior_exploration_config": {"type": "StochasticSampling"}, "count_steps_by": "env_steps", "policy_map_capacity": 100, "policy_mapping_fn": "<function AlgorithmConfig.DEFAULT_POLICY_MAPPING_FN at 0x3855e5b20>", "policies_to_train": null, "policy_states_are_swappable": false, "observation_fn": null, "offline_data_class": null, "input_read_method": "read_parquet", "input_read_method_kwargs": {}, "input_read_schema": {}, "input_read_episodes": false, "input_read_sample_batches": false, "input_read_batch_size": null, "input_filesystem": null, "input_filesystem_kwargs": {}, "input_compress_columns": ["obs", "new_obs"], "input_spaces_jsonable": true, "materialize_data": false, "materialize_mapped_data": true, "map_batches_kwargs": {}, "iter_batches_kwargs": {}, "ignore_final_observation": false, "prelearner_class": null, "prelearner_buffer_class": null, "prelearner_buffer_kwargs": {}, "prelearner_module_synch_period": 10, "dataset_num_iters_per_learner": null, "input_config": {}, "actions_in_input_normalized": false, "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_config": {}, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "output_max_rows_per_file": null, "output_write_remaining_data": false, "output_write_method": "write_parquet", "output_write_method_kwargs": {}, "output_filesystem": null, "output_filesystem_kwargs": {}, "output_write_episodes": true, "offline_sampling": false, "evaluation_interval": 1, "evaluation_duration": 20, "evaluation_duration_unit": "episodes", "evaluation_sample_timeout_s": 120.0, "evaluation_auto_duration_min_env_steps_per_sample": 100, "evaluation_auto_duration_max_env_steps_per_sample": 2000, "evaluation_parallel_to_training": false, "evaluation_force_reset_envs_before_iteration": true, "evaluation_config": null, "off_policy_estimation_methods": {}, "ope_split_batch_by_episode": true, "evaluation_num_env_runners": 1, "in_evaluation": false, "sync_filters_on_rollout_workers_timeout_s": 10.0, "offline_evaluation_interval": null, "num_offline_eval_runners": 0, "offline_loss_for_module_fn": null, "offline_evaluation_duration": 1, "offline_evaluation_parallel_to_training": false, "offline_evaluation_timeout_s": 120.0, "num_cpus_per_offline_eval_runner": 1, "num_gpus_per_offline_eval_runner": 0, "custom_resources_per_offline_eval_runner": {}, "restart_failed_offline_eval_runners": true, "ignore_offline_eval_runner_failures": false, "max_num_offline_eval_runner_restarts": 1000, "offline_eval_runner_restore_timeout_s": 1800.0, "max_requests_in_flight_per_offline_eval_runner": 1, "validate_offline_eval_runners_after_construction": true, "offline_eval_runner_health_probe_timeout_s": 30.0, "offline_eval_rl_module_inference_only": false, "broadcast_offline_eval_runner_states": false, "offline_eval_batch_size_per_runner": 256, "dataset_num_iters_per_eval_runner": 1, "keep_per_episode_custom_metrics": false, "metrics_episode_collection_timeout_s": 60.0, "metrics_num_episodes_for_smoothing": 100, "min_time_s_per_iteration": null, "min_train_timesteps_per_iteration": 0, "min_sample_timesteps_per_iteration": 0, "log_gradients": true, "export_native_model_files": false, "checkpoint_trainable_policies_only": false, "logger_creator": null, "logger_config": null, "log_level": "WARN", "log_sys_usage": true, "fake_sampler": false, "seed": 2, "restart_failed_env_runners": true, "ignore_env_runner_failures": false, "max_num_env_runner_restarts": 1000, "delay_between_env_runner_restarts_s": 60.0, "restart_failed_sub_environments": false, "num_consecutive_env_runner_failures_tolerance": 100, "env_runner_health_probe_timeout_s": 30.0, "env_runner_restore_timeout_s": 1800.0, "_model_config": {}, "_rl_module_spec": "RLModuleSpec(module_class=None, observation_space=None, action_space=None, inference_only=False, learner_only=False, model_config=DefaultModelConfig(fcnet_hiddens=[60, 90], fcnet_activation='tanh', fcnet_kernel_initializer=None, fcnet_kernel_initializer_kwargs=None, fcnet_bias_initializer=None, fcnet_bias_initializer_kwargs=None, conv_filters=None, conv_activation='relu', conv_kernel_initializer=None, conv_kernel_initializer_kwargs=None, conv_bias_initializer=None, conv_bias_initializer_kwargs=None, head_fcnet_hiddens=[], head_fcnet_activation='relu', head_fcnet_kernel_initializer=None, head_fcnet_kernel_initializer_kwargs=None, head_fcnet_bias_initializer=None, head_fcnet_bias_initializer_kwargs=None, free_log_std=False, log_std_clip_param=20.0, vf_share_layers=True, use_lstm=False, max_seq_len=20, lstm_cell_size=256, lstm_use_prev_action=False, lstm_use_prev_reward=False, lstm_kernel_initializer=None, lstm_kernel_initializer_kwargs=None, lstm_bias_initializer=None, lstm_bias_initializer_kwargs=None), catalog_class=None, load_state_path=None, model_config_dict=None)", "algorithm_config_overrides_per_module": {}, "_per_module_overrides": {}, "_validate_config": true, "_use_msgpack_checkpoints": false, "_torch_grad_scaler_class": null, "_torch_lr_scheduler_classes": null, "_tf_policy_handles_more_than_one_loss": false, "_disable_preprocessor_api": false, "_disable_action_flattening": false, "_disable_initialize_loss_from_dummy_batch": false, "_dont_auto_sync_env_runner_states": false, "env_task_fn": -1, "enable_connectors": -1, "simple_optimizer": false, "policy_map_cache": -1, "worker_cls": -1, "synchronize_filters": -1, "enable_async_evaluation": -1, "custom_async_evaluation_function": -1, "_enable_rl_module_api": -1, "auto_wrap_old_gym_envs": -1, "always_attach_evaluation_results": -1, "replay_sequence_length": null, "_disable_execution_plan_api": -1, "use_critic": true, "use_gae": true, "use_kl_loss": true, "kl_coeff": 0.7464963036515, "kl_target": 0.0270990929592, "vf_loss_coeff": 0.6688075857018, "entropy_coeff": 0.0090570820258, "clip_param": 0.1221781641624, "vf_clip_param": 0.1027808522125, "entropy_coeff_schedule": null, "lr_schedule": null, "sgd_minibatch_size": -1, "vf_share_layers": -1, "__stdout_file__": null, "__stderr_file__": null, "lambda": 0.9099046732075, "input": "sampler", "policies": {"default_policy": [null, null, null, null]}, "callbacks": "<class 'ray.rllib.callbacks.callbacks.RLlibCallback'>", "create_env_on_driver": false, "custom_eval_function": null, "framework": "torch"}, "time_since_restore": 10.142341375350952, "iterations_since_restore": 6, "perf": {"cpu_util_percent": 20.85, "ram_util_percent": 77.6}}
{"timers": {"training_iteration": 1.6071059448323122, "restore_env_runners": 1.2610034233683852e-05, "training_step": 1.6069699808041615, "env_runner_sampling_timer": 1.4957820598606384, "learner_update_timer": 0.10810156595359192, "synch_weights": 0.0005917885608441415, "restore_eval_env_runners": 9.589759332366042e-06, "evaluation_iteration": 0.11378002793678232, "synch_eval_env_connectors": 0.00013823095842108816, "synch_env_connectors": 4.403253467009951e-06}, "env_runners": {"env_step_timer": 1.4142931415528026e-05, "num_agent_steps_sampled_lifetime": {"default_agent": -3077500.0}, "episode_duration_sec_mean": 0.004657315659336746, "env_to_module_connector": {"timers": {"connectors": {"add_time_dim_to_batch_and_zero_pad": 2.407101318637655e-06, "add_observations_from_episodes_to_batch": 3.0400378076387528e-06, "batch_individual_items": 6.54703100793441e-06, "add_states_from_episodes_to_batch": 1.7599624985201432e-06, "numpy_to_tensor": 8.896703482298984e-06}}, "connector_pipeline_timer": 4.462363234586643e-05}, "num_env_steps_sampled_lifetime": -3077500.0, "episode_return_mean": 2.259999999999999, "module_to_env_connector": {"timers": {"connectors": {"tensor_to_numpy": 1.336031538867087e-05, "normalize_and_clip_actions": 9.656848544118729e-06, "listify_data_for_vector_env": 1.1386994321707496e-05, "remove_single_ts_time_rank_from_batch": 6.00445963855395e-07, "get_actions": 3.941037378759397e-05, "un_batch_to_individual_items": 5.559660334484398e-06}}, "connector_pipeline_timer": 0.00010602578258196256}, "weights_seq_no": 6.0, "env_to_module_sum_episodes_length_out": 10.36823839457432, "episode_len_min": 20, "num_agent_steps_sampled": {"default_agent": 5000.0}, "env_reset_timer": 3.946195632848009e-05, "rlmodule_inference_timer": 2.8399967457710976e-05, "num_env_steps_sampled": 5000.0, "env_to_module_sum_episodes_length_in": 10.36823839457432, "num_module_steps_sampled": {"default_policy": 5000.0}, "episode_len_mean": 20.0, "episode_len_max": 20, "num_episodes": 250.0, "num_episodes_lifetime": -153875.0, "time_between_sampling": 0.0018760377289116423, "episode_return_min": -11.5, "agent_episode_returns_mean": {"default_agent": 2.259999999999999}, "episode_return_max": 8.5, "num_module_steps_sampled_lifetime": {"default_policy": -3077500.0}, "module_episode_returns_mean": {"default_policy": 2.259999999999999}, "sample": 0.004959602587350112, "num_env_steps_sampled_lifetime_throughput": 3630.5397966653613}, "learners": {"__all_modules__": {"learner_connector": {"timers": {"connectors": {"add_states_from_episodes_to_batch": 3.6141219568565158e-06, "numpy_to_tensor": 8.014224748009857e-05, "batch_individual_items": 0.03307219253322838, "add_columns_from_episodes_to_train_batch": 0.034483333448966105, "add_time_dim_to_batch_and_zero_pad": 1.2310909314217843e-05, "add_observations_from_episodes_to_batch": 0.00084942925277199, "add_one_ts_to_episodes_and_truncate": 0.007593678942048829, "general_advantage_estimation": 0.006726037071993242}}, "connector_pipeline_timer": 0.08296970637009757}, "num_env_steps_trained": 31500, "learner_connector_sum_episodes_length_out": 5250.0, "num_non_trainable_parameters": 0, "num_module_steps_trained_lifetime": 42000, "learner_connector_sum_episodes_length_in": 5000.0, "num_env_steps_trained_lifetime": 220500, "num_module_steps_trained": 6000, "num_trainable_parameters": 6003, "num_env_steps_trained_lifetime_throughput": 2185743.339395359, "num_module_steps_trained_throughput": 418275.8945021864, "num_module_steps_trained_lifetime_throughput": 417535.0489171153}, "default_policy": {"num_module_steps_trained_lifetime": 42000, "gradients_default_optimizer_global_norm": 0.013988404534757137, "total_loss": 0.03697100281715393, "weights_seq_no": 7.0, "diff_num_grad_updates_vs_sampler_policy": 1.0, "num_module_steps_trained": 6000, "vf_loss": 0.10278083384037018, "entropy": 0.5972712635993958, "vf_explained_var": -0.008970975875854492, "curr_kl_coeff": 0.0058320024982094765, "default_optimizer_learning_rate": 0.0002847858517, "num_trainable_parameters": 6003, "module_train_batch_size_mean": 1000.0, "vf_loss_unclipped": 28.27447509765625, "policy_loss": -0.02636248804628849, "mean_kl_loss": 0.00020801420032512397, "curr_entropy_coeff": 0.0090570820258, "num_module_steps_trained_lifetime_throughput": 418936.26946701005}}, "num_training_step_calls_per_iteration": 1, "evaluation": {"env_runners": {"num_episodes": 20, "env_to_module_connector": {"timers": {"connectors": {"add_states_from_episodes_to_batch": 1.734978792039612e-06, "numpy_to_tensor": 9.252193343958652e-06, "batch_individual_items": 6.617981370413001e-06, "add_time_dim_to_batch_and_zero_pad": 2.377171772025141e-06, "add_observations_from_episodes_to_batch": 3.1404844942561916e-06}}, "connector_pipeline_timer": 4.556977086690024e-05}, "sample": 0.10694007304752674, "module_to_env_connector": {"timers": {"connectors": {"get_actions": 4.195039554093421e-05, "remove_single_ts_time_rank_from_batch": 6.22371480472657e-07, "normalize_and_clip_actions": 1.017066053450369e-05, "un_batch_to_individual_items": 6.227848370598024e-06, "tensor_to_numpy": 1.4216974776206331e-05, "listify_data_for_vector_env": 1.1865712993564287e-05}}, "connector_pipeline_timer": 0.00011212276562563331}, "episode_duration_sec_mean": 0.004806197482394054, "module_episode_returns_mean": {"default_policy": -0.2}, "num_env_steps_sampled_lifetime": 35400, "episode_len_min": 20, "num_agent_steps_sampled_lifetime": {"default_agent": 2800}, "episode_len_max": 20, "num_episodes_lifetime": 140, "episode_return_min": -14.5, "env_step_timer": 1.5328228939088837e-05, "env_to_module_sum_episodes_length_out": 10.368238394572801, "num_agent_steps_sampled": {"default_agent": 400}, "env_to_module_sum_episodes_length_in": 10.368238394572801, "episode_return_max": 14.5, "agent_episode_returns_mean": {"default_agent": -0.2}, "num_module_steps_sampled_lifetime": {"default_policy": 2800}, "weights_seq_no": 7.0, "env_reset_timer": 0.0002262439840885171, "episode_len_mean": 20.0, "num_module_steps_sampled": {"default_policy": 400}, "episode_return_mean": -0.2, "rlmodule_inference_timer": 3.0856842627818585e-05, "num_env_steps_sampled": 400, "time_between_sampling": 1.6094051155659435}, "num_healthy_workers": 1, "actor_manager_num_outstanding_async_reqs": 0, "num_remote_worker_restarts": 0}, "num_env_steps_sampled_lifetime": -3077500.0, "fault_tolerance": {"num_healthy_workers": 0, "num_remote_worker_restarts": 0}, "env_runner_group": {"actor_manager_num_outstanding_async_reqs": 0}, "done": false, "training_iteration": 7, "trial_id": "43bd0_00000", "date": "2025-08-11_19-24-31", "timestamp": 1754933071, "time_this_iter_s": 1.6393640041351318, "time_total_s": 11.781705379486084, "pid": 14505, "hostname": "Mac", "node_ip": "127.0.0.1", "config": {"exploration_config": {}, "extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "placement_strategy": "PACK", "num_gpus": 0, "_fake_gpus": false, "num_cpus_for_main_process": 2, "eager_tracing": true, "eager_max_retraces": 20, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "torch_compile_learner": false, "torch_compile_learner_what_to_compile": "forward_train", "torch_compile_learner_dynamo_backend": "aot_eager", "torch_compile_learner_dynamo_mode": null, "torch_compile_worker": false, "torch_compile_worker_dynamo_backend": "aot_eager", "torch_compile_worker_dynamo_mode": null, "torch_ddp_kwargs": {}, "torch_skip_nan_gradients": false, "env": "Umbrella", "env_config": {}, "observation_space": null, "action_space": null, "clip_rewards": null, "normalize_actions": true, "clip_actions": false, "_is_atari": null, "disable_env_checking": false, "render_env": false, "action_mask_key": "action_mask", "env_runner_cls": null, "num_env_runners": 0, "create_local_env_runner": true, "num_envs_per_env_runner": 1, "gym_env_vectorize_mode": "SYNC", "num_cpus_per_env_runner": 1, "num_gpus_per_env_runner": 0, "custom_resources_per_env_runner": {}, "validate_env_runners_after_construction": true, "episodes_to_numpy": true, "max_requests_in_flight_per_env_runner": 1, "sample_timeout_s": 60.0, "_env_to_module_connector": null, "add_default_connectors_to_env_to_module_pipeline": true, "_module_to_env_connector": null, "add_default_connectors_to_module_to_env_pipeline": true, "merge_env_runner_states": "training_only", "broadcast_env_runner_states": true, "episode_lookback_horizon": 1, "rollout_fragment_length": "auto", "batch_mode": "complete_episodes", "compress_observations": false, "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "enable_tf1_exec_eagerly": false, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "preprocessor_pref": "deepmind", "observation_filter": "NoFilter", "update_worker_filter_stats": true, "use_worker_filter_stats": true, "sampler_perf_stats_ema_coef": null, "_is_online": true, "num_learners": 0, "num_gpus_per_learner": 0, "num_cpus_per_learner": "auto", "num_aggregator_actors_per_learner": 0, "max_requests_in_flight_per_aggregator_actor": 3, "local_gpu_idx": 0, "max_requests_in_flight_per_learner": 3, "gamma": 1, "lr": 0.0002847858517, "grad_clip": 0.5, "grad_clip_by": "global_norm", "_train_batch_size_per_learner": 5000, "train_batch_size": 4000, "num_epochs": 1, "minibatch_size": 1000, "shuffle_batch_per_epoch": true, "model": {"fcnet_hiddens": [256, 256], "fcnet_activation": "tanh", "fcnet_weights_initializer": null, "fcnet_weights_initializer_config": null, "fcnet_bias_initializer": null, "fcnet_bias_initializer_config": null, "conv_filters": null, "conv_activation": "relu", "conv_kernel_initializer": null, "conv_kernel_initializer_config": null, "conv_bias_initializer": null, "conv_bias_initializer_config": null, "conv_transpose_kernel_initializer": null, "conv_transpose_kernel_initializer_config": null, "conv_transpose_bias_initializer": null, "conv_transpose_bias_initializer_config": null, "post_fcnet_hiddens": [], "post_fcnet_activation": "relu", "post_fcnet_weights_initializer": null, "post_fcnet_weights_initializer_config": null, "post_fcnet_bias_initializer": null, "post_fcnet_bias_initializer_config": null, "free_log_std": false, "log_std_clip_param": 20.0, "no_final_linear": false, "vf_share_layers": false, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "lstm_weights_initializer": null, "lstm_weights_initializer_config": null, "lstm_bias_initializer": null, "lstm_bias_initializer_config": null, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "attention_use_n_prev_actions": 0, "attention_use_n_prev_rewards": 0, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": null, "custom_model_config": {}, "custom_action_dist": null, "custom_preprocessor": null, "encoder_latent_dim": null, "always_check_shapes": false, "lstm_use_prev_action_reward": -1, "_use_default_native_models": -1, "_disable_preprocessor_api": false, "_disable_action_flattening": false}, "_learner_connector": null, "add_default_connectors_to_learner_pipeline": true, "learner_config_dict": {}, "optimizer": {}, "_learner_class": null, "callbacks_on_algorithm_init": null, "callbacks_on_env_runners_recreated": null, "callbacks_on_offline_eval_runners_recreated": null, "callbacks_on_checkpoint_loaded": null, "callbacks_on_environment_created": null, "callbacks_on_episode_created": null, "callbacks_on_episode_start": null, "callbacks_on_episode_step": null, "callbacks_on_episode_end": null, "callbacks_on_evaluate_start": null, "callbacks_on_evaluate_end": null, "callbacks_on_evaluate_offline_start": null, "callbacks_on_evaluate_offline_end": null, "callbacks_on_sample_end": null, "callbacks_on_train_result": null, "explore": true, "enable_rl_module_and_learner": true, "enable_env_runner_and_connector_v2": true, "_prior_exploration_config": {"type": "StochasticSampling"}, "count_steps_by": "env_steps", "policy_map_capacity": 100, "policy_mapping_fn": "<function AlgorithmConfig.DEFAULT_POLICY_MAPPING_FN at 0x3855e5b20>", "policies_to_train": null, "policy_states_are_swappable": false, "observation_fn": null, "offline_data_class": null, "input_read_method": "read_parquet", "input_read_method_kwargs": {}, "input_read_schema": {}, "input_read_episodes": false, "input_read_sample_batches": false, "input_read_batch_size": null, "input_filesystem": null, "input_filesystem_kwargs": {}, "input_compress_columns": ["obs", "new_obs"], "input_spaces_jsonable": true, "materialize_data": false, "materialize_mapped_data": true, "map_batches_kwargs": {}, "iter_batches_kwargs": {}, "ignore_final_observation": false, "prelearner_class": null, "prelearner_buffer_class": null, "prelearner_buffer_kwargs": {}, "prelearner_module_synch_period": 10, "dataset_num_iters_per_learner": null, "input_config": {}, "actions_in_input_normalized": false, "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_config": {}, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "output_max_rows_per_file": null, "output_write_remaining_data": false, "output_write_method": "write_parquet", "output_write_method_kwargs": {}, "output_filesystem": null, "output_filesystem_kwargs": {}, "output_write_episodes": true, "offline_sampling": false, "evaluation_interval": 1, "evaluation_duration": 20, "evaluation_duration_unit": "episodes", "evaluation_sample_timeout_s": 120.0, "evaluation_auto_duration_min_env_steps_per_sample": 100, "evaluation_auto_duration_max_env_steps_per_sample": 2000, "evaluation_parallel_to_training": false, "evaluation_force_reset_envs_before_iteration": true, "evaluation_config": null, "off_policy_estimation_methods": {}, "ope_split_batch_by_episode": true, "evaluation_num_env_runners": 1, "in_evaluation": false, "sync_filters_on_rollout_workers_timeout_s": 10.0, "offline_evaluation_interval": null, "num_offline_eval_runners": 0, "offline_loss_for_module_fn": null, "offline_evaluation_duration": 1, "offline_evaluation_parallel_to_training": false, "offline_evaluation_timeout_s": 120.0, "num_cpus_per_offline_eval_runner": 1, "num_gpus_per_offline_eval_runner": 0, "custom_resources_per_offline_eval_runner": {}, "restart_failed_offline_eval_runners": true, "ignore_offline_eval_runner_failures": false, "max_num_offline_eval_runner_restarts": 1000, "offline_eval_runner_restore_timeout_s": 1800.0, "max_requests_in_flight_per_offline_eval_runner": 1, "validate_offline_eval_runners_after_construction": true, "offline_eval_runner_health_probe_timeout_s": 30.0, "offline_eval_rl_module_inference_only": false, "broadcast_offline_eval_runner_states": false, "offline_eval_batch_size_per_runner": 256, "dataset_num_iters_per_eval_runner": 1, "keep_per_episode_custom_metrics": false, "metrics_episode_collection_timeout_s": 60.0, "metrics_num_episodes_for_smoothing": 100, "min_time_s_per_iteration": null, "min_train_timesteps_per_iteration": 0, "min_sample_timesteps_per_iteration": 0, "log_gradients": true, "export_native_model_files": false, "checkpoint_trainable_policies_only": false, "logger_creator": null, "logger_config": null, "log_level": "WARN", "log_sys_usage": true, "fake_sampler": false, "seed": 2, "restart_failed_env_runners": true, "ignore_env_runner_failures": false, "max_num_env_runner_restarts": 1000, "delay_between_env_runner_restarts_s": 60.0, "restart_failed_sub_environments": false, "num_consecutive_env_runner_failures_tolerance": 100, "env_runner_health_probe_timeout_s": 30.0, "env_runner_restore_timeout_s": 1800.0, "_model_config": {}, "_rl_module_spec": "RLModuleSpec(module_class=None, observation_space=None, action_space=None, inference_only=False, learner_only=False, model_config=DefaultModelConfig(fcnet_hiddens=[60, 90], fcnet_activation='tanh', fcnet_kernel_initializer=None, fcnet_kernel_initializer_kwargs=None, fcnet_bias_initializer=None, fcnet_bias_initializer_kwargs=None, conv_filters=None, conv_activation='relu', conv_kernel_initializer=None, conv_kernel_initializer_kwargs=None, conv_bias_initializer=None, conv_bias_initializer_kwargs=None, head_fcnet_hiddens=[], head_fcnet_activation='relu', head_fcnet_kernel_initializer=None, head_fcnet_kernel_initializer_kwargs=None, head_fcnet_bias_initializer=None, head_fcnet_bias_initializer_kwargs=None, free_log_std=False, log_std_clip_param=20.0, vf_share_layers=True, use_lstm=False, max_seq_len=20, lstm_cell_size=256, lstm_use_prev_action=False, lstm_use_prev_reward=False, lstm_kernel_initializer=None, lstm_kernel_initializer_kwargs=None, lstm_bias_initializer=None, lstm_bias_initializer_kwargs=None), catalog_class=None, load_state_path=None, model_config_dict=None)", "algorithm_config_overrides_per_module": {}, "_per_module_overrides": {}, "_validate_config": true, "_use_msgpack_checkpoints": false, "_torch_grad_scaler_class": null, "_torch_lr_scheduler_classes": null, "_tf_policy_handles_more_than_one_loss": false, "_disable_preprocessor_api": false, "_disable_action_flattening": false, "_disable_initialize_loss_from_dummy_batch": false, "_dont_auto_sync_env_runner_states": false, "env_task_fn": -1, "enable_connectors": -1, "simple_optimizer": false, "policy_map_cache": -1, "worker_cls": -1, "synchronize_filters": -1, "enable_async_evaluation": -1, "custom_async_evaluation_function": -1, "_enable_rl_module_api": -1, "auto_wrap_old_gym_envs": -1, "always_attach_evaluation_results": -1, "replay_sequence_length": null, "_disable_execution_plan_api": -1, "use_critic": true, "use_gae": true, "use_kl_loss": true, "kl_coeff": 0.7464963036515, "kl_target": 0.0270990929592, "vf_loss_coeff": 0.6688075857018, "entropy_coeff": 0.0090570820258, "clip_param": 0.1221781641624, "vf_clip_param": 0.1027808522125, "entropy_coeff_schedule": null, "lr_schedule": null, "sgd_minibatch_size": -1, "vf_share_layers": -1, "__stdout_file__": null, "__stderr_file__": null, "lambda": 0.9099046732075, "input": "sampler", "policies": {"default_policy": [null, null, null, null]}, "callbacks": "<class 'ray.rllib.callbacks.callbacks.RLlibCallback'>", "create_env_on_driver": false, "custom_eval_function": null, "framework": "torch"}, "time_since_restore": 11.781705379486084, "iterations_since_restore": 7, "perf": {"cpu_util_percent": 45.25, "ram_util_percent": 77.95}}
{"timers": {"training_iteration": 1.6071496174739073, "restore_env_runners": 1.2540604870012366e-05, "training_step": 1.6070130814159163, "env_runner_sampling_timer": 1.4959431788510427, "learner_update_timer": 0.10798322112366877, "synch_weights": 0.0005919694248174245, "restore_eval_env_runners": 9.556361632871607e-06, "evaluation_iteration": 0.11381770098749128, "synch_eval_env_connectors": 0.00013788739947047466, "synch_env_connectors": 4.4029709744356316e-06}, "env_runners": {"env_step_timer": 1.412592589911458e-05, "num_agent_steps_sampled_lifetime": {"default_agent": -3695000.0}, "episode_duration_sec_mean": 0.0050278894496150325, "env_to_module_connector": {"timers": {"connectors": {"add_time_dim_to_batch_and_zero_pad": 2.3955165712633987e-06, "add_observations_from_episodes_to_batch": 3.119117054574964e-06, "batch_individual_items": 6.440097801858773e-06, "add_states_from_episodes_to_batch": 1.749420066214788e-06, "numpy_to_tensor": 8.827843235728283e-06}}, "connector_pipeline_timer": 4.4493910476806425e-05}, "num_env_steps_sampled_lifetime": -3695000.0, "episode_return_mean": 2.899999999999998, "module_to_env_connector": {"timers": {"connectors": {"tensor_to_numpy": 1.3334673004794053e-05, "normalize_and_clip_actions": 9.651772100299688e-06, "listify_data_for_vector_env": 1.1287328303857858e-05, "remove_single_ts_time_rank_from_batch": 6.067945008646204e-07, "get_actions": 3.917401598746006e-05, "un_batch_to_individual_items": 5.502681077965669e-06}}, "connector_pipeline_timer": 0.00010560599475130546}, "weights_seq_no": 7.0, "env_to_module_sum_episodes_length_out": 10.36823839457432, "episode_len_min": 20, "num_agent_steps_sampled": {"default_agent": 5000.0}, "env_reset_timer": 4.112391118410186e-05, "rlmodule_inference_timer": 4.591272877596179e-05, "num_env_steps_sampled": 5000.0, "env_to_module_sum_episodes_length_in": 10.36823839457432, "num_module_steps_sampled": {"default_policy": 5000.0}, "episode_len_mean": 20.0, "episode_len_max": 20, "num_episodes": 250.0, "num_episodes_lifetime": -184750.0, "time_between_sampling": 0.0016155554825398454, "episode_return_min": -11.5, "agent_episode_returns_mean": {"default_agent": 2.899999999999998}, "episode_return_max": 8.5, "num_module_steps_sampled_lifetime": {"default_policy": -3695000.0}, "module_episode_returns_mean": {"default_policy": 2.899999999999998}, "sample": 0.005290394016649789, "num_env_steps_sampled_lifetime_throughput": 3617.893226479508}, "learners": {"__all_modules__": {"learner_connector": {"timers": {"connectors": {"add_states_from_episodes_to_batch": 3.610060143370581e-06, "numpy_to_tensor": 7.99999953330057e-05, "batch_individual_items": 0.03304859226775798, "add_columns_from_episodes_to_train_batch": 0.03447928344508833, "add_time_dim_to_batch_and_zero_pad": 1.229446110308672e-05, "add_observations_from_episodes_to_batch": 0.0008513974601664116, "add_one_ts_to_episodes_and_truncate": 0.007596235901652687, "general_advantage_estimation": 0.006713821291536005}}, "connector_pipeline_timer": 0.08293379055664618}, "num_env_steps_trained": 31500, "learner_connector_sum_episodes_length_out": 5250.0, "num_non_trainable_parameters": 0, "num_module_steps_trained_lifetime": 48000, "learner_connector_sum_episodes_length_in": 5000.0, "num_env_steps_trained_lifetime": 252000, "num_module_steps_trained": 6000, "num_trainable_parameters": 6003, "num_env_steps_trained_lifetime_throughput": 2178661.0811572634, "num_module_steps_trained_throughput": 416857.7240865744, "num_module_steps_trained_lifetime_throughput": 416139.5966012472}, "default_policy": {"num_module_steps_trained_lifetime": 48000, "gradients_default_optimizer_global_norm": 0.025655152276158333, "total_loss": -0.009110665880143642, "weights_seq_no": 8.0, "diff_num_grad_updates_vs_sampler_policy": 1.0, "num_module_steps_trained": 6000, "vf_loss": 0.10278083384037018, "entropy": 0.5958549976348877, "vf_explained_var": -0.0067958831787109375, "curr_kl_coeff": 0.0029160012491047382, "default_optimizer_learning_rate": 0.0002847858517, "num_trainable_parameters": 6003, "module_train_batch_size_mean": 1000.0, "vf_loss_unclipped": 28.120574951171875, "policy_loss": -0.07245510071516037, "mean_kl_loss": 9.257249621441588e-05, "curr_entropy_coeff": 0.0090570820258, "num_module_steps_trained_lifetime_throughput": 417460.3229727359}}, "num_training_step_calls_per_iteration": 1, "evaluation": {"env_runners": {"num_episodes": 20, "env_to_module_connector": {"timers": {"connectors": {"add_states_from_episodes_to_batch": 1.6744437920221442e-06, "numpy_to_tensor": 8.632495260493418e-06, "batch_individual_items": 6.271454028227826e-06, "add_time_dim_to_batch_and_zero_pad": 2.2795935295902146e-06, "add_observations_from_episodes_to_batch": 2.894935705157724e-06}}, "connector_pipeline_timer": 4.372168413763903e-05}, "sample": 0.10687415231654156, "module_to_env_connector": {"timers": {"connectors": {"get_actions": 3.7985118752788544e-05, "remove_single_ts_time_rank_from_batch": 5.864304713963315e-07, "normalize_and_clip_actions": 9.759036460174387e-06, "un_batch_to_individual_items": 5.54841402393237e-06, "tensor_to_numpy": 1.3563887228338936e-05, "listify_data_for_vector_env": 1.133347311546439e-05}}, "connector_pipeline_timer": 0.00010489141174391131}, "episode_duration_sec_mean": 0.004671110034687445, "module_episode_returns_mean": {"default_policy": -0.8}, "num_env_steps_sampled_lifetime": 40400, "episode_len_min": 20, "num_agent_steps_sampled_lifetime": {"default_agent": 3200}, "episode_len_max": 20, "num_episodes_lifetime": 160, "episode_return_min": -14.5, "env_step_timer": 1.4527691700583836e-05, "env_to_module_sum_episodes_length_out": 10.3682383945743, "num_agent_steps_sampled": {"default_agent": 400}, "env_to_module_sum_episodes_length_in": 10.3682383945743, "episode_return_max": 14.5, "agent_episode_returns_mean": {"default_agent": -0.8}, "num_module_steps_sampled_lifetime": {"default_policy": 3200}, "weights_seq_no": 8.0, "env_reset_timer": 0.0002247123845040696, "episode_len_mean": 20.0, "num_module_steps_sampled": {"default_policy": 400}, "episode_return_mean": -0.8, "rlmodule_inference_timer": 2.8192375698030975e-05, "num_env_steps_sampled": 400, "time_between_sampling": 1.6095940164900662}, "num_healthy_workers": 1, "actor_manager_num_outstanding_async_reqs": 0, "num_remote_worker_restarts": 0}, "num_env_steps_sampled_lifetime": -3695000.0, "fault_tolerance": {"num_healthy_workers": 0, "num_remote_worker_restarts": 0}, "env_runner_group": {"actor_manager_num_outstanding_async_reqs": 0}, "done": false, "training_iteration": 8, "trial_id": "43bd0_00000", "date": "2025-08-11_19-24-32", "timestamp": 1754933072, "time_this_iter_s": 1.7190220355987549, "time_total_s": 13.500727415084839, "pid": 14505, "hostname": "Mac", "node_ip": "127.0.0.1", "config": {"exploration_config": {}, "extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "placement_strategy": "PACK", "num_gpus": 0, "_fake_gpus": false, "num_cpus_for_main_process": 2, "eager_tracing": true, "eager_max_retraces": 20, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "torch_compile_learner": false, "torch_compile_learner_what_to_compile": "forward_train", "torch_compile_learner_dynamo_backend": "aot_eager", "torch_compile_learner_dynamo_mode": null, "torch_compile_worker": false, "torch_compile_worker_dynamo_backend": "aot_eager", "torch_compile_worker_dynamo_mode": null, "torch_ddp_kwargs": {}, "torch_skip_nan_gradients": false, "env": "Umbrella", "env_config": {}, "observation_space": null, "action_space": null, "clip_rewards": null, "normalize_actions": true, "clip_actions": false, "_is_atari": null, "disable_env_checking": false, "render_env": false, "action_mask_key": "action_mask", "env_runner_cls": null, "num_env_runners": 0, "create_local_env_runner": true, "num_envs_per_env_runner": 1, "gym_env_vectorize_mode": "SYNC", "num_cpus_per_env_runner": 1, "num_gpus_per_env_runner": 0, "custom_resources_per_env_runner": {}, "validate_env_runners_after_construction": true, "episodes_to_numpy": true, "max_requests_in_flight_per_env_runner": 1, "sample_timeout_s": 60.0, "_env_to_module_connector": null, "add_default_connectors_to_env_to_module_pipeline": true, "_module_to_env_connector": null, "add_default_connectors_to_module_to_env_pipeline": true, "merge_env_runner_states": "training_only", "broadcast_env_runner_states": true, "episode_lookback_horizon": 1, "rollout_fragment_length": "auto", "batch_mode": "complete_episodes", "compress_observations": false, "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "enable_tf1_exec_eagerly": false, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "preprocessor_pref": "deepmind", "observation_filter": "NoFilter", "update_worker_filter_stats": true, "use_worker_filter_stats": true, "sampler_perf_stats_ema_coef": null, "_is_online": true, "num_learners": 0, "num_gpus_per_learner": 0, "num_cpus_per_learner": "auto", "num_aggregator_actors_per_learner": 0, "max_requests_in_flight_per_aggregator_actor": 3, "local_gpu_idx": 0, "max_requests_in_flight_per_learner": 3, "gamma": 1, "lr": 0.0002847858517, "grad_clip": 0.5, "grad_clip_by": "global_norm", "_train_batch_size_per_learner": 5000, "train_batch_size": 4000, "num_epochs": 1, "minibatch_size": 1000, "shuffle_batch_per_epoch": true, "model": {"fcnet_hiddens": [256, 256], "fcnet_activation": "tanh", "fcnet_weights_initializer": null, "fcnet_weights_initializer_config": null, "fcnet_bias_initializer": null, "fcnet_bias_initializer_config": null, "conv_filters": null, "conv_activation": "relu", "conv_kernel_initializer": null, "conv_kernel_initializer_config": null, "conv_bias_initializer": null, "conv_bias_initializer_config": null, "conv_transpose_kernel_initializer": null, "conv_transpose_kernel_initializer_config": null, "conv_transpose_bias_initializer": null, "conv_transpose_bias_initializer_config": null, "post_fcnet_hiddens": [], "post_fcnet_activation": "relu", "post_fcnet_weights_initializer": null, "post_fcnet_weights_initializer_config": null, "post_fcnet_bias_initializer": null, "post_fcnet_bias_initializer_config": null, "free_log_std": false, "log_std_clip_param": 20.0, "no_final_linear": false, "vf_share_layers": false, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "lstm_weights_initializer": null, "lstm_weights_initializer_config": null, "lstm_bias_initializer": null, "lstm_bias_initializer_config": null, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "attention_use_n_prev_actions": 0, "attention_use_n_prev_rewards": 0, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": null, "custom_model_config": {}, "custom_action_dist": null, "custom_preprocessor": null, "encoder_latent_dim": null, "always_check_shapes": false, "lstm_use_prev_action_reward": -1, "_use_default_native_models": -1, "_disable_preprocessor_api": false, "_disable_action_flattening": false}, "_learner_connector": null, "add_default_connectors_to_learner_pipeline": true, "learner_config_dict": {}, "optimizer": {}, "_learner_class": null, "callbacks_on_algorithm_init": null, "callbacks_on_env_runners_recreated": null, "callbacks_on_offline_eval_runners_recreated": null, "callbacks_on_checkpoint_loaded": null, "callbacks_on_environment_created": null, "callbacks_on_episode_created": null, "callbacks_on_episode_start": null, "callbacks_on_episode_step": null, "callbacks_on_episode_end": null, "callbacks_on_evaluate_start": null, "callbacks_on_evaluate_end": null, "callbacks_on_evaluate_offline_start": null, "callbacks_on_evaluate_offline_end": null, "callbacks_on_sample_end": null, "callbacks_on_train_result": null, "explore": true, "enable_rl_module_and_learner": true, "enable_env_runner_and_connector_v2": true, "_prior_exploration_config": {"type": "StochasticSampling"}, "count_steps_by": "env_steps", "policy_map_capacity": 100, "policy_mapping_fn": "<function AlgorithmConfig.DEFAULT_POLICY_MAPPING_FN at 0x3855e5b20>", "policies_to_train": null, "policy_states_are_swappable": false, "observation_fn": null, "offline_data_class": null, "input_read_method": "read_parquet", "input_read_method_kwargs": {}, "input_read_schema": {}, "input_read_episodes": false, "input_read_sample_batches": false, "input_read_batch_size": null, "input_filesystem": null, "input_filesystem_kwargs": {}, "input_compress_columns": ["obs", "new_obs"], "input_spaces_jsonable": true, "materialize_data": false, "materialize_mapped_data": true, "map_batches_kwargs": {}, "iter_batches_kwargs": {}, "ignore_final_observation": false, "prelearner_class": null, "prelearner_buffer_class": null, "prelearner_buffer_kwargs": {}, "prelearner_module_synch_period": 10, "dataset_num_iters_per_learner": null, "input_config": {}, "actions_in_input_normalized": false, "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_config": {}, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "output_max_rows_per_file": null, "output_write_remaining_data": false, "output_write_method": "write_parquet", "output_write_method_kwargs": {}, "output_filesystem": null, "output_filesystem_kwargs": {}, "output_write_episodes": true, "offline_sampling": false, "evaluation_interval": 1, "evaluation_duration": 20, "evaluation_duration_unit": "episodes", "evaluation_sample_timeout_s": 120.0, "evaluation_auto_duration_min_env_steps_per_sample": 100, "evaluation_auto_duration_max_env_steps_per_sample": 2000, "evaluation_parallel_to_training": false, "evaluation_force_reset_envs_before_iteration": true, "evaluation_config": null, "off_policy_estimation_methods": {}, "ope_split_batch_by_episode": true, "evaluation_num_env_runners": 1, "in_evaluation": false, "sync_filters_on_rollout_workers_timeout_s": 10.0, "offline_evaluation_interval": null, "num_offline_eval_runners": 0, "offline_loss_for_module_fn": null, "offline_evaluation_duration": 1, "offline_evaluation_parallel_to_training": false, "offline_evaluation_timeout_s": 120.0, "num_cpus_per_offline_eval_runner": 1, "num_gpus_per_offline_eval_runner": 0, "custom_resources_per_offline_eval_runner": {}, "restart_failed_offline_eval_runners": true, "ignore_offline_eval_runner_failures": false, "max_num_offline_eval_runner_restarts": 1000, "offline_eval_runner_restore_timeout_s": 1800.0, "max_requests_in_flight_per_offline_eval_runner": 1, "validate_offline_eval_runners_after_construction": true, "offline_eval_runner_health_probe_timeout_s": 30.0, "offline_eval_rl_module_inference_only": false, "broadcast_offline_eval_runner_states": false, "offline_eval_batch_size_per_runner": 256, "dataset_num_iters_per_eval_runner": 1, "keep_per_episode_custom_metrics": false, "metrics_episode_collection_timeout_s": 60.0, "metrics_num_episodes_for_smoothing": 100, "min_time_s_per_iteration": null, "min_train_timesteps_per_iteration": 0, "min_sample_timesteps_per_iteration": 0, "log_gradients": true, "export_native_model_files": false, "checkpoint_trainable_policies_only": false, "logger_creator": null, "logger_config": null, "log_level": "WARN", "log_sys_usage": true, "fake_sampler": false, "seed": 2, "restart_failed_env_runners": true, "ignore_env_runner_failures": false, "max_num_env_runner_restarts": 1000, "delay_between_env_runner_restarts_s": 60.0, "restart_failed_sub_environments": false, "num_consecutive_env_runner_failures_tolerance": 100, "env_runner_health_probe_timeout_s": 30.0, "env_runner_restore_timeout_s": 1800.0, "_model_config": {}, "_rl_module_spec": "RLModuleSpec(module_class=None, observation_space=None, action_space=None, inference_only=False, learner_only=False, model_config=DefaultModelConfig(fcnet_hiddens=[60, 90], fcnet_activation='tanh', fcnet_kernel_initializer=None, fcnet_kernel_initializer_kwargs=None, fcnet_bias_initializer=None, fcnet_bias_initializer_kwargs=None, conv_filters=None, conv_activation='relu', conv_kernel_initializer=None, conv_kernel_initializer_kwargs=None, conv_bias_initializer=None, conv_bias_initializer_kwargs=None, head_fcnet_hiddens=[], head_fcnet_activation='relu', head_fcnet_kernel_initializer=None, head_fcnet_kernel_initializer_kwargs=None, head_fcnet_bias_initializer=None, head_fcnet_bias_initializer_kwargs=None, free_log_std=False, log_std_clip_param=20.0, vf_share_layers=True, use_lstm=False, max_seq_len=20, lstm_cell_size=256, lstm_use_prev_action=False, lstm_use_prev_reward=False, lstm_kernel_initializer=None, lstm_kernel_initializer_kwargs=None, lstm_bias_initializer=None, lstm_bias_initializer_kwargs=None), catalog_class=None, load_state_path=None, model_config_dict=None)", "algorithm_config_overrides_per_module": {}, "_per_module_overrides": {}, "_validate_config": true, "_use_msgpack_checkpoints": false, "_torch_grad_scaler_class": null, "_torch_lr_scheduler_classes": null, "_tf_policy_handles_more_than_one_loss": false, "_disable_preprocessor_api": false, "_disable_action_flattening": false, "_disable_initialize_loss_from_dummy_batch": false, "_dont_auto_sync_env_runner_states": false, "env_task_fn": -1, "enable_connectors": -1, "simple_optimizer": false, "policy_map_cache": -1, "worker_cls": -1, "synchronize_filters": -1, "enable_async_evaluation": -1, "custom_async_evaluation_function": -1, "_enable_rl_module_api": -1, "auto_wrap_old_gym_envs": -1, "always_attach_evaluation_results": -1, "replay_sequence_length": null, "_disable_execution_plan_api": -1, "use_critic": true, "use_gae": true, "use_kl_loss": true, "kl_coeff": 0.7464963036515, "kl_target": 0.0270990929592, "vf_loss_coeff": 0.6688075857018, "entropy_coeff": 0.0090570820258, "clip_param": 0.1221781641624, "vf_clip_param": 0.1027808522125, "entropy_coeff_schedule": null, "lr_schedule": null, "sgd_minibatch_size": -1, "vf_share_layers": -1, "__stdout_file__": null, "__stderr_file__": null, "lambda": 0.9099046732075, "input": "sampler", "policies": {"default_policy": [null, null, null, null]}, "callbacks": "<class 'ray.rllib.callbacks.callbacks.RLlibCallback'>", "create_env_on_driver": false, "custom_eval_function": null, "framework": "torch"}, "time_since_restore": 13.500727415084839, "iterations_since_restore": 8, "perf": {"cpu_util_percent": 28.26666666666667, "ram_util_percent": 77.53333333333333}}
{"timers": {"training_iteration": 1.6074033050486, "restore_env_runners": 1.2476448414585048e-05, "training_step": 1.6072664056022863, "env_runner_sampling_timer": 1.495383992473621, "learner_update_timer": 0.10879483557317053, "synch_weights": 0.000591533900383986, "restore_eval_env_runners": 9.526217606643537e-06, "evaluation_iteration": 0.11373253647766778, "synch_eval_env_connectors": 0.00013753685577391056, "synch_env_connectors": 4.408111604171318e-06}, "env_runners": {"env_step_timer": 1.427508255903428e-05, "num_agent_steps_sampled_lifetime": {"default_agent": -4312500.0}, "episode_duration_sec_mean": 0.004726740660611539, "env_to_module_connector": {"timers": {"connectors": {"add_time_dim_to_batch_and_zero_pad": 2.4313443004934332e-06, "add_observations_from_episodes_to_batch": 3.0516947504827115e-06, "batch_individual_items": 6.534969392438349e-06, "add_states_from_episodes_to_batch": 1.7872937627904628e-06, "numpy_to_tensor": 8.9713390533928e-06}}, "connector_pipeline_timer": 4.500106406326881e-05}, "num_env_steps_sampled_lifetime": -4312500.0, "episode_return_mean": 4.740000000000002, "module_to_env_connector": {"timers": {"connectors": {"tensor_to_numpy": 1.335666367010962e-05, "normalize_and_clip_actions": 9.698403619563047e-06, "listify_data_for_vector_env": 1.1381083507034366e-05, "remove_single_ts_time_rank_from_batch": 6.050768496538048e-07, "get_actions": 4.024035966292523e-05, "un_batch_to_individual_items": 5.5297925427965644e-06}}, "connector_pipeline_timer": 0.00010699929682748459}, "weights_seq_no": 8.0, "env_to_module_sum_episodes_length_out": 10.36823839457432, "episode_len_min": 20, "num_agent_steps_sampled": {"default_agent": 5000.0}, "env_reset_timer": 4.160301625270737e-05, "rlmodule_inference_timer": 2.9252709571949572e-05, "num_env_steps_sampled": 5000.0, "env_to_module_sum_episodes_length_in": 10.36823839457432, "num_module_steps_sampled": {"default_policy": 5000.0}, "episode_len_mean": 20.0, "episode_len_max": 20, "num_episodes": 250.0, "num_episodes_lifetime": -215625.0, "time_between_sampling": 0.0015588611329516945, "episode_return_min": -11.5, "agent_episode_returns_mean": {"default_agent": 4.740000000000002}, "episode_return_max": 8.5, "num_module_steps_sampled_lifetime": {"default_policy": -4312500.0}, "module_episode_returns_mean": {"default_policy": 4.740000000000002}, "sample": 0.005102712190673285, "num_env_steps_sampled_lifetime_throughput": 3603.9529456837386}, "learners": {"__all_modules__": {"learner_connector": {"timers": {"connectors": {"add_states_from_episodes_to_batch": 3.603119251748086e-06, "numpy_to_tensor": 7.98579060936016e-05, "batch_individual_items": 0.03302735300482493, "add_columns_from_episodes_to_train_batch": 0.03447602519027583, "add_time_dim_to_batch_and_zero_pad": 1.2279436987849076e-05, "add_observations_from_episodes_to_batch": 0.0008509447355379999, "add_one_ts_to_episodes_and_truncate": 0.00855443063252521, "general_advantage_estimation": 0.006702226409584346}}, "connector_pipeline_timer": 0.08385488890050162}, "num_env_steps_trained": 31500, "learner_connector_sum_episodes_length_out": 5250.0, "num_non_trainable_parameters": 0, "num_module_steps_trained_lifetime": 54000, "learner_connector_sum_episodes_length_in": 5000.0, "num_env_steps_trained_lifetime": 283500, "num_module_steps_trained": 6000, "num_trainable_parameters": 6003, "num_env_steps_trained_lifetime_throughput": 2175204.6344349384, "num_module_steps_trained_throughput": 416129.3853626624, "num_module_steps_trained_lifetime_throughput": 415434.26394329243}, "default_policy": {"num_module_steps_trained_lifetime": 54000, "gradients_default_optimizer_global_norm": 0.05536004900932312, "total_loss": -0.09930161386728287, "weights_seq_no": 9.0, "diff_num_grad_updates_vs_sampler_policy": 1.0, "num_module_steps_trained": 6000, "vf_loss": 0.10278083384037018, "entropy": 0.5808447599411011, "vf_explained_var": 0.0010166168212890625, "curr_kl_coeff": 0.0014580006245523691, "default_optimizer_learning_rate": 0.0002847858517, "num_trainable_parameters": 6003, "module_train_batch_size_mean": 1000.0, "vf_loss_unclipped": 27.78199577331543, "policy_loss": -0.16278362274169922, "mean_kl_loss": 0.0007413393468596041, "curr_entropy_coeff": 0.0090570820258, "num_module_steps_trained_lifetime_throughput": 416674.0865827624}}, "num_training_step_calls_per_iteration": 1, "evaluation": {"env_runners": {"num_episodes": 20, "env_to_module_connector": {"timers": {"connectors": {"add_states_from_episodes_to_batch": 1.632086113132313e-06, "numpy_to_tensor": 8.44768851617096e-06, "batch_individual_items": 6.208354256782483e-06, "add_time_dim_to_batch_and_zero_pad": 2.2510820618075315e-06, "add_observations_from_episodes_to_batch": 2.8563703193895686e-06}}, "connector_pipeline_timer": 4.3157375763503314e-05}, "sample": 0.10680650329389516, "module_to_env_connector": {"timers": {"connectors": {"get_actions": 3.789526753943177e-05, "remove_single_ts_time_rank_from_batch": 5.841514816185948e-07, "normalize_and_clip_actions": 9.542399753302437e-06, "un_batch_to_individual_items": 5.437799932916794e-06, "tensor_to_numpy": 1.3355784177553386e-05, "listify_data_for_vector_env": 1.1064698004524534e-05}}, "connector_pipeline_timer": 0.00010391713369486724}, "episode_duration_sec_mean": 0.004686244202312082, "module_episode_returns_mean": {"default_policy": 0.0}, "num_env_steps_sampled_lifetime": 45400, "episode_len_min": 20, "num_agent_steps_sampled_lifetime": {"default_agent": 3600}, "episode_len_max": 20, "num_episodes_lifetime": 180, "episode_return_min": -14.5, "env_step_timer": 1.4121669166626657e-05, "env_to_module_sum_episodes_length_out": 10.368238394574323, "num_agent_steps_sampled": {"default_agent": 400}, "env_to_module_sum_episodes_length_in": 10.368238394574323, "episode_return_max": 14.5, "agent_episode_returns_mean": {"default_agent": 0.0}, "num_module_steps_sampled_lifetime": {"default_policy": 3600}, "weights_seq_no": 9.0, "env_reset_timer": 0.00022324776021452727, "episode_len_mean": 20.0, "num_module_steps_sampled": {"default_policy": 400}, "episode_return_mean": 0.0, "rlmodule_inference_timer": 2.8142196609536448e-05, "num_env_steps_sampled": 400, "time_between_sampling": 1.610012873825733}, "num_healthy_workers": 1, "actor_manager_num_outstanding_async_reqs": 0, "num_remote_worker_restarts": 0}, "num_env_steps_sampled_lifetime": -4312500.0, "fault_tolerance": {"num_healthy_workers": 0, "num_remote_worker_restarts": 0}, "env_runner_group": {"actor_manager_num_outstanding_async_reqs": 0}, "done": false, "training_iteration": 9, "trial_id": "43bd0_00000", "date": "2025-08-11_19-24-34", "timestamp": 1754933074, "time_this_iter_s": 1.739790916442871, "time_total_s": 15.24051833152771, "pid": 14505, "hostname": "Mac", "node_ip": "127.0.0.1", "config": {"exploration_config": {}, "extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "placement_strategy": "PACK", "num_gpus": 0, "_fake_gpus": false, "num_cpus_for_main_process": 2, "eager_tracing": true, "eager_max_retraces": 20, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "torch_compile_learner": false, "torch_compile_learner_what_to_compile": "forward_train", "torch_compile_learner_dynamo_backend": "aot_eager", "torch_compile_learner_dynamo_mode": null, "torch_compile_worker": false, "torch_compile_worker_dynamo_backend": "aot_eager", "torch_compile_worker_dynamo_mode": null, "torch_ddp_kwargs": {}, "torch_skip_nan_gradients": false, "env": "Umbrella", "env_config": {}, "observation_space": null, "action_space": null, "clip_rewards": null, "normalize_actions": true, "clip_actions": false, "_is_atari": null, "disable_env_checking": false, "render_env": false, "action_mask_key": "action_mask", "env_runner_cls": null, "num_env_runners": 0, "create_local_env_runner": true, "num_envs_per_env_runner": 1, "gym_env_vectorize_mode": "SYNC", "num_cpus_per_env_runner": 1, "num_gpus_per_env_runner": 0, "custom_resources_per_env_runner": {}, "validate_env_runners_after_construction": true, "episodes_to_numpy": true, "max_requests_in_flight_per_env_runner": 1, "sample_timeout_s": 60.0, "_env_to_module_connector": null, "add_default_connectors_to_env_to_module_pipeline": true, "_module_to_env_connector": null, "add_default_connectors_to_module_to_env_pipeline": true, "merge_env_runner_states": "training_only", "broadcast_env_runner_states": true, "episode_lookback_horizon": 1, "rollout_fragment_length": "auto", "batch_mode": "complete_episodes", "compress_observations": false, "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "enable_tf1_exec_eagerly": false, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "preprocessor_pref": "deepmind", "observation_filter": "NoFilter", "update_worker_filter_stats": true, "use_worker_filter_stats": true, "sampler_perf_stats_ema_coef": null, "_is_online": true, "num_learners": 0, "num_gpus_per_learner": 0, "num_cpus_per_learner": "auto", "num_aggregator_actors_per_learner": 0, "max_requests_in_flight_per_aggregator_actor": 3, "local_gpu_idx": 0, "max_requests_in_flight_per_learner": 3, "gamma": 1, "lr": 0.0002847858517, "grad_clip": 0.5, "grad_clip_by": "global_norm", "_train_batch_size_per_learner": 5000, "train_batch_size": 4000, "num_epochs": 1, "minibatch_size": 1000, "shuffle_batch_per_epoch": true, "model": {"fcnet_hiddens": [256, 256], "fcnet_activation": "tanh", "fcnet_weights_initializer": null, "fcnet_weights_initializer_config": null, "fcnet_bias_initializer": null, "fcnet_bias_initializer_config": null, "conv_filters": null, "conv_activation": "relu", "conv_kernel_initializer": null, "conv_kernel_initializer_config": null, "conv_bias_initializer": null, "conv_bias_initializer_config": null, "conv_transpose_kernel_initializer": null, "conv_transpose_kernel_initializer_config": null, "conv_transpose_bias_initializer": null, "conv_transpose_bias_initializer_config": null, "post_fcnet_hiddens": [], "post_fcnet_activation": "relu", "post_fcnet_weights_initializer": null, "post_fcnet_weights_initializer_config": null, "post_fcnet_bias_initializer": null, "post_fcnet_bias_initializer_config": null, "free_log_std": false, "log_std_clip_param": 20.0, "no_final_linear": false, "vf_share_layers": false, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "lstm_weights_initializer": null, "lstm_weights_initializer_config": null, "lstm_bias_initializer": null, "lstm_bias_initializer_config": null, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "attention_use_n_prev_actions": 0, "attention_use_n_prev_rewards": 0, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": null, "custom_model_config": {}, "custom_action_dist": null, "custom_preprocessor": null, "encoder_latent_dim": null, "always_check_shapes": false, "lstm_use_prev_action_reward": -1, "_use_default_native_models": -1, "_disable_preprocessor_api": false, "_disable_action_flattening": false}, "_learner_connector": null, "add_default_connectors_to_learner_pipeline": true, "learner_config_dict": {}, "optimizer": {}, "_learner_class": null, "callbacks_on_algorithm_init": null, "callbacks_on_env_runners_recreated": null, "callbacks_on_offline_eval_runners_recreated": null, "callbacks_on_checkpoint_loaded": null, "callbacks_on_environment_created": null, "callbacks_on_episode_created": null, "callbacks_on_episode_start": null, "callbacks_on_episode_step": null, "callbacks_on_episode_end": null, "callbacks_on_evaluate_start": null, "callbacks_on_evaluate_end": null, "callbacks_on_evaluate_offline_start": null, "callbacks_on_evaluate_offline_end": null, "callbacks_on_sample_end": null, "callbacks_on_train_result": null, "explore": true, "enable_rl_module_and_learner": true, "enable_env_runner_and_connector_v2": true, "_prior_exploration_config": {"type": "StochasticSampling"}, "count_steps_by": "env_steps", "policy_map_capacity": 100, "policy_mapping_fn": "<function AlgorithmConfig.DEFAULT_POLICY_MAPPING_FN at 0x3855e5b20>", "policies_to_train": null, "policy_states_are_swappable": false, "observation_fn": null, "offline_data_class": null, "input_read_method": "read_parquet", "input_read_method_kwargs": {}, "input_read_schema": {}, "input_read_episodes": false, "input_read_sample_batches": false, "input_read_batch_size": null, "input_filesystem": null, "input_filesystem_kwargs": {}, "input_compress_columns": ["obs", "new_obs"], "input_spaces_jsonable": true, "materialize_data": false, "materialize_mapped_data": true, "map_batches_kwargs": {}, "iter_batches_kwargs": {}, "ignore_final_observation": false, "prelearner_class": null, "prelearner_buffer_class": null, "prelearner_buffer_kwargs": {}, "prelearner_module_synch_period": 10, "dataset_num_iters_per_learner": null, "input_config": {}, "actions_in_input_normalized": false, "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_config": {}, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "output_max_rows_per_file": null, "output_write_remaining_data": false, "output_write_method": "write_parquet", "output_write_method_kwargs": {}, "output_filesystem": null, "output_filesystem_kwargs": {}, "output_write_episodes": true, "offline_sampling": false, "evaluation_interval": 1, "evaluation_duration": 20, "evaluation_duration_unit": "episodes", "evaluation_sample_timeout_s": 120.0, "evaluation_auto_duration_min_env_steps_per_sample": 100, "evaluation_auto_duration_max_env_steps_per_sample": 2000, "evaluation_parallel_to_training": false, "evaluation_force_reset_envs_before_iteration": true, "evaluation_config": null, "off_policy_estimation_methods": {}, "ope_split_batch_by_episode": true, "evaluation_num_env_runners": 1, "in_evaluation": false, "sync_filters_on_rollout_workers_timeout_s": 10.0, "offline_evaluation_interval": null, "num_offline_eval_runners": 0, "offline_loss_for_module_fn": null, "offline_evaluation_duration": 1, "offline_evaluation_parallel_to_training": false, "offline_evaluation_timeout_s": 120.0, "num_cpus_per_offline_eval_runner": 1, "num_gpus_per_offline_eval_runner": 0, "custom_resources_per_offline_eval_runner": {}, "restart_failed_offline_eval_runners": true, "ignore_offline_eval_runner_failures": false, "max_num_offline_eval_runner_restarts": 1000, "offline_eval_runner_restore_timeout_s": 1800.0, "max_requests_in_flight_per_offline_eval_runner": 1, "validate_offline_eval_runners_after_construction": true, "offline_eval_runner_health_probe_timeout_s": 30.0, "offline_eval_rl_module_inference_only": false, "broadcast_offline_eval_runner_states": false, "offline_eval_batch_size_per_runner": 256, "dataset_num_iters_per_eval_runner": 1, "keep_per_episode_custom_metrics": false, "metrics_episode_collection_timeout_s": 60.0, "metrics_num_episodes_for_smoothing": 100, "min_time_s_per_iteration": null, "min_train_timesteps_per_iteration": 0, "min_sample_timesteps_per_iteration": 0, "log_gradients": true, "export_native_model_files": false, "checkpoint_trainable_policies_only": false, "logger_creator": null, "logger_config": null, "log_level": "WARN", "log_sys_usage": true, "fake_sampler": false, "seed": 2, "restart_failed_env_runners": true, "ignore_env_runner_failures": false, "max_num_env_runner_restarts": 1000, "delay_between_env_runner_restarts_s": 60.0, "restart_failed_sub_environments": false, "num_consecutive_env_runner_failures_tolerance": 100, "env_runner_health_probe_timeout_s": 30.0, "env_runner_restore_timeout_s": 1800.0, "_model_config": {}, "_rl_module_spec": "RLModuleSpec(module_class=None, observation_space=None, action_space=None, inference_only=False, learner_only=False, model_config=DefaultModelConfig(fcnet_hiddens=[60, 90], fcnet_activation='tanh', fcnet_kernel_initializer=None, fcnet_kernel_initializer_kwargs=None, fcnet_bias_initializer=None, fcnet_bias_initializer_kwargs=None, conv_filters=None, conv_activation='relu', conv_kernel_initializer=None, conv_kernel_initializer_kwargs=None, conv_bias_initializer=None, conv_bias_initializer_kwargs=None, head_fcnet_hiddens=[], head_fcnet_activation='relu', head_fcnet_kernel_initializer=None, head_fcnet_kernel_initializer_kwargs=None, head_fcnet_bias_initializer=None, head_fcnet_bias_initializer_kwargs=None, free_log_std=False, log_std_clip_param=20.0, vf_share_layers=True, use_lstm=False, max_seq_len=20, lstm_cell_size=256, lstm_use_prev_action=False, lstm_use_prev_reward=False, lstm_kernel_initializer=None, lstm_kernel_initializer_kwargs=None, lstm_bias_initializer=None, lstm_bias_initializer_kwargs=None), catalog_class=None, load_state_path=None, model_config_dict=None)", "algorithm_config_overrides_per_module": {}, "_per_module_overrides": {}, "_validate_config": true, "_use_msgpack_checkpoints": false, "_torch_grad_scaler_class": null, "_torch_lr_scheduler_classes": null, "_tf_policy_handles_more_than_one_loss": false, "_disable_preprocessor_api": false, "_disable_action_flattening": false, "_disable_initialize_loss_from_dummy_batch": false, "_dont_auto_sync_env_runner_states": false, "env_task_fn": -1, "enable_connectors": -1, "simple_optimizer": false, "policy_map_cache": -1, "worker_cls": -1, "synchronize_filters": -1, "enable_async_evaluation": -1, "custom_async_evaluation_function": -1, "_enable_rl_module_api": -1, "auto_wrap_old_gym_envs": -1, "always_attach_evaluation_results": -1, "replay_sequence_length": null, "_disable_execution_plan_api": -1, "use_critic": true, "use_gae": true, "use_kl_loss": true, "kl_coeff": 0.7464963036515, "kl_target": 0.0270990929592, "vf_loss_coeff": 0.6688075857018, "entropy_coeff": 0.0090570820258, "clip_param": 0.1221781641624, "vf_clip_param": 0.1027808522125, "entropy_coeff_schedule": null, "lr_schedule": null, "sgd_minibatch_size": -1, "vf_share_layers": -1, "__stdout_file__": null, "__stderr_file__": null, "lambda": 0.9099046732075, "input": "sampler", "policies": {"default_policy": [null, null, null, null]}, "callbacks": "<class 'ray.rllib.callbacks.callbacks.RLlibCallback'>", "create_env_on_driver": false, "custom_eval_function": null, "framework": "torch"}, "time_since_restore": 15.24051833152771, "iterations_since_restore": 9, "perf": {"cpu_util_percent": 22.05, "ram_util_percent": 77.8}}
{"timers": {"training_iteration": 1.6071605578377817, "restore_env_runners": 1.2405013789368116e-05, "training_step": 1.6070232807067404, "env_runner_sampling_timer": 1.4943383687990137, "learner_update_timer": 0.10959762596708263, "synch_weights": 0.000591019390630139, "restore_eval_env_runners": 9.510956039736571e-06, "evaluation_iteration": 0.11364481528314832, "synch_eval_env_connectors": 0.00013747107693184597, "synch_env_connectors": 4.402780492152919e-06}, "env_runners": {"env_step_timer": 1.3886347477523763e-05, "num_agent_steps_sampled_lifetime": {"default_agent": -4930000.0}, "episode_duration_sec_mean": 0.004562351171858609, "env_to_module_connector": {"timers": {"connectors": {"add_time_dim_to_batch_and_zero_pad": 2.3728064127052912e-06, "add_observations_from_episodes_to_batch": 3.036739764683002e-06, "batch_individual_items": 6.3431465166285205e-06, "add_states_from_episodes_to_batch": 1.7578933594484371e-06, "numpy_to_tensor": 8.706556834467419e-06}}, "connector_pipeline_timer": 4.398946852283817e-05}, "num_env_steps_sampled_lifetime": -4930000.0, "episode_return_mean": 3.7, "module_to_env_connector": {"timers": {"connectors": {"tensor_to_numpy": 1.3026272877101901e-05, "normalize_and_clip_actions": 9.476449940138536e-06, "listify_data_for_vector_env": 1.1136381688621811e-05, "remove_single_ts_time_rank_from_batch": 5.938480127525197e-07, "get_actions": 3.851429727086235e-05, "un_batch_to_individual_items": 5.419445071975062e-06}}, "connector_pipeline_timer": 0.00010391487941780242}, "weights_seq_no": 9.0, "env_to_module_sum_episodes_length_out": 10.36823839457432, "episode_len_min": 20, "num_agent_steps_sampled": {"default_agent": 5000.0}, "env_reset_timer": 3.9583690196787984e-05, "rlmodule_inference_timer": 2.7600225449407068e-05, "num_env_steps_sampled": 5000.0, "env_to_module_sum_episodes_length_in": 10.36823839457432, "num_module_steps_sampled": {"default_policy": 5000.0}, "episode_len_mean": 20.0, "episode_len_max": 20, "num_episodes": 250.0, "num_episodes_lifetime": -246500.0, "time_between_sampling": 0.0018755153461445559, "episode_return_min": -11.5, "agent_episode_returns_mean": {"default_agent": 3.7}, "episode_return_max": 8.5, "num_module_steps_sampled_lifetime": {"default_policy": -4930000.0}, "module_episode_returns_mean": {"default_policy": 3.7}, "sample": 0.004959197164561182, "num_env_steps_sampled_lifetime_throughput": 3685.728649340322}, "learners": {"__all_modules__": {"learner_connector": {"timers": {"connectors": {"add_states_from_episodes_to_batch": 3.5966680283536107e-06, "numpy_to_tensor": 7.970765676560519e-05, "batch_individual_items": 0.03395984947538904, "add_columns_from_episodes_to_train_batch": 0.034476172018662044, "add_time_dim_to_batch_and_zero_pad": 1.2270392028927685e-05, "add_observations_from_episodes_to_batch": 0.0008507002882521338, "add_one_ts_to_episodes_and_truncate": 0.00854586007645596, "general_advantage_estimation": 0.006690720816179352}}, "connector_pipeline_timer": 0.0847665191716501}, "num_env_steps_trained": 31500, "learner_connector_sum_episodes_length_out": 5250.0, "num_non_trainable_parameters": 0, "num_module_steps_trained_lifetime": 60000, "learner_connector_sum_episodes_length_in": 5000.0, "num_env_steps_trained_lifetime": 315000, "num_module_steps_trained": 6000, "num_trainable_parameters": 6003, "num_env_steps_trained_lifetime_throughput": 2174349.072238997, "num_module_steps_trained_throughput": 415897.7415906832, "num_module_steps_trained_lifetime_throughput": 415224.75050152536}, "default_policy": {"num_module_steps_trained_lifetime": 60000, "gradients_default_optimizer_global_norm": 0.05242887884378433, "total_loss": 0.045452482998371124, "weights_seq_no": 10.0, "diff_num_grad_updates_vs_sampler_policy": 1.0, "num_module_steps_trained": 6000, "vf_loss": 0.10278083384037018, "entropy": 0.5488011240959167, "vf_explained_var": -0.005507946014404297, "curr_kl_coeff": 0.0007290003122761846, "default_optimizer_learning_rate": 0.0002847858517, "num_trainable_parameters": 6003, "module_train_batch_size_mean": 1000.0, "vf_loss_unclipped": 28.12540626525879, "policy_loss": -0.01831967383623123, "mean_kl_loss": 0.001431760611012578, "curr_entropy_coeff": 0.0090570820258, "num_module_steps_trained_lifetime_throughput": 416382.499352621}}, "num_training_step_calls_per_iteration": 1, "evaluation": {"env_runners": {"num_episodes": 20, "env_to_module_connector": {"timers": {"connectors": {"add_states_from_episodes_to_batch": 1.5978435995373497e-06, "numpy_to_tensor": 8.355453805326288e-06, "batch_individual_items": 6.088057354339569e-06, "add_time_dim_to_batch_and_zero_pad": 2.206951037866508e-06, "add_observations_from_episodes_to_batch": 2.80764199974784e-06}}, "connector_pipeline_timer": 4.264770682321376e-05}, "sample": 0.10673987493056851, "module_to_env_connector": {"timers": {"connectors": {"get_actions": 3.710383275262e-05, "remove_single_ts_time_rank_from_batch": 5.672859573952407e-07, "normalize_and_clip_actions": 9.374220391569773e-06, "un_batch_to_individual_items": 5.331286397585409e-06, "tensor_to_numpy": 1.3002665217207443e-05, "listify_data_for_vector_env": 1.0919321147956291e-05}}, "connector_pipeline_timer": 0.00010191802981741607}, "episode_duration_sec_mean": 0.004684182513738051, "module_episode_returns_mean": {"default_policy": 0.2}, "num_env_steps_sampled_lifetime": 50400, "episode_len_min": 20, "num_agent_steps_sampled_lifetime": {"default_agent": 4000}, "episode_len_max": 20, "num_episodes_lifetime": 200, "episode_return_min": -14.5, "env_step_timer": 1.3899458170145002e-05, "env_to_module_sum_episodes_length_out": 10.368238394574323, "num_agent_steps_sampled": {"default_agent": 400}, "env_to_module_sum_episodes_length_in": 10.368238394574323, "episode_return_max": 14.5, "agent_episode_returns_mean": {"default_agent": 0.2}, "num_module_steps_sampled_lifetime": {"default_policy": 4000}, "weights_seq_no": 10.0, "env_reset_timer": 0.00022179070178800686, "episode_len_mean": 20.0, "num_module_steps_sampled": {"default_policy": 400}, "episode_return_mean": 0.2, "rlmodule_inference_timer": 2.7527150690029596e-05, "num_env_steps_sampled": 400, "time_between_sampling": 1.6099116867578804}, "num_healthy_workers": 1, "actor_manager_num_outstanding_async_reqs": 0, "num_remote_worker_restarts": 0}, "num_env_steps_sampled_lifetime": -4930000.0, "fault_tolerance": {"num_healthy_workers": 0, "num_remote_worker_restarts": 0}, "env_runner_group": {"actor_manager_num_outstanding_async_reqs": 0}, "done": false, "training_iteration": 10, "trial_id": "43bd0_00000", "date": "2025-08-11_19-24-36", "timestamp": 1754933076, "time_this_iter_s": 1.6909968852996826, "time_total_s": 16.931515216827393, "pid": 14505, "hostname": "Mac", "node_ip": "127.0.0.1", "config": {"exploration_config": {}, "extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "placement_strategy": "PACK", "num_gpus": 0, "_fake_gpus": false, "num_cpus_for_main_process": 2, "eager_tracing": true, "eager_max_retraces": 20, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "torch_compile_learner": false, "torch_compile_learner_what_to_compile": "forward_train", "torch_compile_learner_dynamo_backend": "aot_eager", "torch_compile_learner_dynamo_mode": null, "torch_compile_worker": false, "torch_compile_worker_dynamo_backend": "aot_eager", "torch_compile_worker_dynamo_mode": null, "torch_ddp_kwargs": {}, "torch_skip_nan_gradients": false, "env": "Umbrella", "env_config": {}, "observation_space": null, "action_space": null, "clip_rewards": null, "normalize_actions": true, "clip_actions": false, "_is_atari": null, "disable_env_checking": false, "render_env": false, "action_mask_key": "action_mask", "env_runner_cls": null, "num_env_runners": 0, "create_local_env_runner": true, "num_envs_per_env_runner": 1, "gym_env_vectorize_mode": "SYNC", "num_cpus_per_env_runner": 1, "num_gpus_per_env_runner": 0, "custom_resources_per_env_runner": {}, "validate_env_runners_after_construction": true, "episodes_to_numpy": true, "max_requests_in_flight_per_env_runner": 1, "sample_timeout_s": 60.0, "_env_to_module_connector": null, "add_default_connectors_to_env_to_module_pipeline": true, "_module_to_env_connector": null, "add_default_connectors_to_module_to_env_pipeline": true, "merge_env_runner_states": "training_only", "broadcast_env_runner_states": true, "episode_lookback_horizon": 1, "rollout_fragment_length": "auto", "batch_mode": "complete_episodes", "compress_observations": false, "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "enable_tf1_exec_eagerly": false, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "preprocessor_pref": "deepmind", "observation_filter": "NoFilter", "update_worker_filter_stats": true, "use_worker_filter_stats": true, "sampler_perf_stats_ema_coef": null, "_is_online": true, "num_learners": 0, "num_gpus_per_learner": 0, "num_cpus_per_learner": "auto", "num_aggregator_actors_per_learner": 0, "max_requests_in_flight_per_aggregator_actor": 3, "local_gpu_idx": 0, "max_requests_in_flight_per_learner": 3, "gamma": 1, "lr": 0.0002847858517, "grad_clip": 0.5, "grad_clip_by": "global_norm", "_train_batch_size_per_learner": 5000, "train_batch_size": 4000, "num_epochs": 1, "minibatch_size": 1000, "shuffle_batch_per_epoch": true, "model": {"fcnet_hiddens": [256, 256], "fcnet_activation": "tanh", "fcnet_weights_initializer": null, "fcnet_weights_initializer_config": null, "fcnet_bias_initializer": null, "fcnet_bias_initializer_config": null, "conv_filters": null, "conv_activation": "relu", "conv_kernel_initializer": null, "conv_kernel_initializer_config": null, "conv_bias_initializer": null, "conv_bias_initializer_config": null, "conv_transpose_kernel_initializer": null, "conv_transpose_kernel_initializer_config": null, "conv_transpose_bias_initializer": null, "conv_transpose_bias_initializer_config": null, "post_fcnet_hiddens": [], "post_fcnet_activation": "relu", "post_fcnet_weights_initializer": null, "post_fcnet_weights_initializer_config": null, "post_fcnet_bias_initializer": null, "post_fcnet_bias_initializer_config": null, "free_log_std": false, "log_std_clip_param": 20.0, "no_final_linear": false, "vf_share_layers": false, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "lstm_weights_initializer": null, "lstm_weights_initializer_config": null, "lstm_bias_initializer": null, "lstm_bias_initializer_config": null, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "attention_use_n_prev_actions": 0, "attention_use_n_prev_rewards": 0, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": null, "custom_model_config": {}, "custom_action_dist": null, "custom_preprocessor": null, "encoder_latent_dim": null, "always_check_shapes": false, "lstm_use_prev_action_reward": -1, "_use_default_native_models": -1, "_disable_preprocessor_api": false, "_disable_action_flattening": false}, "_learner_connector": null, "add_default_connectors_to_learner_pipeline": true, "learner_config_dict": {}, "optimizer": {}, "_learner_class": null, "callbacks_on_algorithm_init": null, "callbacks_on_env_runners_recreated": null, "callbacks_on_offline_eval_runners_recreated": null, "callbacks_on_checkpoint_loaded": null, "callbacks_on_environment_created": null, "callbacks_on_episode_created": null, "callbacks_on_episode_start": null, "callbacks_on_episode_step": null, "callbacks_on_episode_end": null, "callbacks_on_evaluate_start": null, "callbacks_on_evaluate_end": null, "callbacks_on_evaluate_offline_start": null, "callbacks_on_evaluate_offline_end": null, "callbacks_on_sample_end": null, "callbacks_on_train_result": null, "explore": true, "enable_rl_module_and_learner": true, "enable_env_runner_and_connector_v2": true, "_prior_exploration_config": {"type": "StochasticSampling"}, "count_steps_by": "env_steps", "policy_map_capacity": 100, "policy_mapping_fn": "<function AlgorithmConfig.DEFAULT_POLICY_MAPPING_FN at 0x3855e5b20>", "policies_to_train": null, "policy_states_are_swappable": false, "observation_fn": null, "offline_data_class": null, "input_read_method": "read_parquet", "input_read_method_kwargs": {}, "input_read_schema": {}, "input_read_episodes": false, "input_read_sample_batches": false, "input_read_batch_size": null, "input_filesystem": null, "input_filesystem_kwargs": {}, "input_compress_columns": ["obs", "new_obs"], "input_spaces_jsonable": true, "materialize_data": false, "materialize_mapped_data": true, "map_batches_kwargs": {}, "iter_batches_kwargs": {}, "ignore_final_observation": false, "prelearner_class": null, "prelearner_buffer_class": null, "prelearner_buffer_kwargs": {}, "prelearner_module_synch_period": 10, "dataset_num_iters_per_learner": null, "input_config": {}, "actions_in_input_normalized": false, "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_config": {}, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "output_max_rows_per_file": null, "output_write_remaining_data": false, "output_write_method": "write_parquet", "output_write_method_kwargs": {}, "output_filesystem": null, "output_filesystem_kwargs": {}, "output_write_episodes": true, "offline_sampling": false, "evaluation_interval": 1, "evaluation_duration": 20, "evaluation_duration_unit": "episodes", "evaluation_sample_timeout_s": 120.0, "evaluation_auto_duration_min_env_steps_per_sample": 100, "evaluation_auto_duration_max_env_steps_per_sample": 2000, "evaluation_parallel_to_training": false, "evaluation_force_reset_envs_before_iteration": true, "evaluation_config": null, "off_policy_estimation_methods": {}, "ope_split_batch_by_episode": true, "evaluation_num_env_runners": 1, "in_evaluation": false, "sync_filters_on_rollout_workers_timeout_s": 10.0, "offline_evaluation_interval": null, "num_offline_eval_runners": 0, "offline_loss_for_module_fn": null, "offline_evaluation_duration": 1, "offline_evaluation_parallel_to_training": false, "offline_evaluation_timeout_s": 120.0, "num_cpus_per_offline_eval_runner": 1, "num_gpus_per_offline_eval_runner": 0, "custom_resources_per_offline_eval_runner": {}, "restart_failed_offline_eval_runners": true, "ignore_offline_eval_runner_failures": false, "max_num_offline_eval_runner_restarts": 1000, "offline_eval_runner_restore_timeout_s": 1800.0, "max_requests_in_flight_per_offline_eval_runner": 1, "validate_offline_eval_runners_after_construction": true, "offline_eval_runner_health_probe_timeout_s": 30.0, "offline_eval_rl_module_inference_only": false, "broadcast_offline_eval_runner_states": false, "offline_eval_batch_size_per_runner": 256, "dataset_num_iters_per_eval_runner": 1, "keep_per_episode_custom_metrics": false, "metrics_episode_collection_timeout_s": 60.0, "metrics_num_episodes_for_smoothing": 100, "min_time_s_per_iteration": null, "min_train_timesteps_per_iteration": 0, "min_sample_timesteps_per_iteration": 0, "log_gradients": true, "export_native_model_files": false, "checkpoint_trainable_policies_only": false, "logger_creator": null, "logger_config": null, "log_level": "WARN", "log_sys_usage": true, "fake_sampler": false, "seed": 2, "restart_failed_env_runners": true, "ignore_env_runner_failures": false, "max_num_env_runner_restarts": 1000, "delay_between_env_runner_restarts_s": 60.0, "restart_failed_sub_environments": false, "num_consecutive_env_runner_failures_tolerance": 100, "env_runner_health_probe_timeout_s": 30.0, "env_runner_restore_timeout_s": 1800.0, "_model_config": {}, "_rl_module_spec": "RLModuleSpec(module_class=None, observation_space=None, action_space=None, inference_only=False, learner_only=False, model_config=DefaultModelConfig(fcnet_hiddens=[60, 90], fcnet_activation='tanh', fcnet_kernel_initializer=None, fcnet_kernel_initializer_kwargs=None, fcnet_bias_initializer=None, fcnet_bias_initializer_kwargs=None, conv_filters=None, conv_activation='relu', conv_kernel_initializer=None, conv_kernel_initializer_kwargs=None, conv_bias_initializer=None, conv_bias_initializer_kwargs=None, head_fcnet_hiddens=[], head_fcnet_activation='relu', head_fcnet_kernel_initializer=None, head_fcnet_kernel_initializer_kwargs=None, head_fcnet_bias_initializer=None, head_fcnet_bias_initializer_kwargs=None, free_log_std=False, log_std_clip_param=20.0, vf_share_layers=True, use_lstm=False, max_seq_len=20, lstm_cell_size=256, lstm_use_prev_action=False, lstm_use_prev_reward=False, lstm_kernel_initializer=None, lstm_kernel_initializer_kwargs=None, lstm_bias_initializer=None, lstm_bias_initializer_kwargs=None), catalog_class=None, load_state_path=None, model_config_dict=None)", "algorithm_config_overrides_per_module": {}, "_per_module_overrides": {}, "_validate_config": true, "_use_msgpack_checkpoints": false, "_torch_grad_scaler_class": null, "_torch_lr_scheduler_classes": null, "_tf_policy_handles_more_than_one_loss": false, "_disable_preprocessor_api": false, "_disable_action_flattening": false, "_disable_initialize_loss_from_dummy_batch": false, "_dont_auto_sync_env_runner_states": false, "env_task_fn": -1, "enable_connectors": -1, "simple_optimizer": false, "policy_map_cache": -1, "worker_cls": -1, "synchronize_filters": -1, "enable_async_evaluation": -1, "custom_async_evaluation_function": -1, "_enable_rl_module_api": -1, "auto_wrap_old_gym_envs": -1, "always_attach_evaluation_results": -1, "replay_sequence_length": null, "_disable_execution_plan_api": -1, "use_critic": true, "use_gae": true, "use_kl_loss": true, "kl_coeff": 0.7464963036515, "kl_target": 0.0270990929592, "vf_loss_coeff": 0.6688075857018, "entropy_coeff": 0.0090570820258, "clip_param": 0.1221781641624, "vf_clip_param": 0.1027808522125, "entropy_coeff_schedule": null, "lr_schedule": null, "sgd_minibatch_size": -1, "vf_share_layers": -1, "__stdout_file__": null, "__stderr_file__": null, "lambda": 0.9099046732075, "input": "sampler", "policies": {"default_policy": [null, null, null, null]}, "callbacks": "<class 'ray.rllib.callbacks.callbacks.RLlibCallback'>", "create_env_on_driver": false, "custom_eval_function": null, "framework": "torch"}, "time_since_restore": 16.931515216827393, "iterations_since_restore": 10, "perf": {"cpu_util_percent": 42.73333333333333, "ram_util_percent": 77.36666666666667}}
{"timers": {"training_iteration": 1.6060259393395495, "restore_env_runners": 1.233471376971515e-05, "training_step": 1.6058882258100475, "env_runner_sampling_timer": 1.4933511613607995, "learner_update_timer": 0.10944846720792857, "synch_weights": 0.0005913829464739451, "restore_eval_env_runners": 9.49125683235904e-06, "evaluation_iteration": 0.11356391962991845, "synch_eval_env_connectors": 0.00013712678611569495, "synch_env_connectors": 4.398751827657906e-06}, "env_runners": {"env_step_timer": 1.3916014652181834e-05, "num_agent_steps_sampled_lifetime": {"default_agent": -5547500.0}, "episode_duration_sec_mean": 0.004592021794058382, "env_to_module_connector": {"timers": {"connectors": {"add_time_dim_to_batch_and_zero_pad": 2.3725080346217356e-06, "add_observations_from_episodes_to_batch": 3.009960508428487e-06, "batch_individual_items": 6.351009007911099e-06, "add_states_from_episodes_to_batch": 1.7580244579663236e-06, "numpy_to_tensor": 8.707172907806201e-06}}, "connector_pipeline_timer": 4.3967065045996036e-05}, "num_env_steps_sampled_lifetime": -5547500.0, "episode_return_mean": 5.14, "module_to_env_connector": {"timers": {"connectors": {"tensor_to_numpy": 1.3051618670942814e-05, "normalize_and_clip_actions": 9.506949447299247e-06, "listify_data_for_vector_env": 1.114438381225717e-05, "remove_single_ts_time_rank_from_batch": 6.02887039450155e-07, "get_actions": 3.841863042381457e-05, "un_batch_to_individual_items": 5.4323002664242385e-06}}, "connector_pipeline_timer": 0.0001039634599579055}, "weights_seq_no": 10.0, "env_to_module_sum_episodes_length_out": 10.36823839457432, "episode_len_min": 20, "num_agent_steps_sampled": {"default_agent": 5000.0}, "env_reset_timer": 3.818528139892889e-05, "rlmodule_inference_timer": 2.846299181688127e-05, "num_env_steps_sampled": 5000.0, "env_to_module_sum_episodes_length_in": 10.36823839457432, "num_module_steps_sampled": {"default_policy": 5000.0}, "episode_len_mean": 20.0, "episode_len_max": 20, "num_episodes": 250.0, "num_episodes_lifetime": -277375.0, "time_between_sampling": 0.0018938965898981264, "episode_return_min": -11.5, "agent_episode_returns_mean": {"default_agent": 5.14}, "episode_return_max": 8.5, "num_module_steps_sampled_lifetime": {"default_policy": -5547500.0}, "module_episode_returns_mean": {"default_policy": 5.14}, "sample": 0.004903807733901828, "num_env_steps_sampled_lifetime_throughput": 3692.9605889392246}, "learners": {"__all_modules__": {"learner_connector": {"timers": {"connectors": {"add_states_from_episodes_to_batch": 3.592372136373092e-06, "numpy_to_tensor": 7.955099019654484e-05, "batch_individual_items": 0.033927895980919685, "add_columns_from_episodes_to_train_batch": 0.03448306237773727, "add_time_dim_to_batch_and_zero_pad": 1.2259768123880506e-05, "add_observations_from_episodes_to_batch": 0.0008507578651358561, "add_one_ts_to_episodes_and_truncate": 0.008536529815551988, "general_advantage_estimation": 0.006678009027669946}}, "connector_pipeline_timer": 0.08471883605970401}, "num_env_steps_trained": 31500, "learner_connector_sum_episodes_length_out": 5250.0, "num_non_trainable_parameters": 0, "num_module_steps_trained_lifetime": 66000, "learner_connector_sum_episodes_length_in": 5000.0, "num_env_steps_trained_lifetime": 346500, "num_module_steps_trained": 6000, "num_trainable_parameters": 6003, "num_env_steps_trained_lifetime_throughput": 2172344.744861382, "num_module_steps_trained_throughput": 415449.95637180156, "num_module_steps_trained_lifetime_throughput": 414797.9188891052}, "default_policy": {"num_module_steps_trained_lifetime": 66000, "gradients_default_optimizer_global_norm": 0.034589968621730804, "total_loss": 0.02990320324897766, "weights_seq_no": 11.0, "diff_num_grad_updates_vs_sampler_policy": 1.0, "num_module_steps_trained": 6000, "vf_loss": 0.10278083384037018, "entropy": 0.5197477340698242, "vf_explained_var": -0.0021424293518066406, "curr_kl_coeff": 0.0003645001561380923, "default_optimizer_learning_rate": 0.0002847858517, "num_trainable_parameters": 6003, "module_train_batch_size_mean": 1000.0, "vf_loss_unclipped": 27.9683895111084, "policy_loss": -0.03413091599941254, "mean_kl_loss": 0.0012500360608100891, "curr_entropy_coeff": 0.0090570820258, "num_module_steps_trained_lifetime_throughput": 415876.7360201864}}, "num_training_step_calls_per_iteration": 1, "evaluation": {"env_runners": {"num_episodes": 20, "env_to_module_connector": {"timers": {"connectors": {"add_states_from_episodes_to_batch": 1.6353795550964939e-06, "numpy_to_tensor": 8.517834150459944e-06, "batch_individual_items": 6.136249394496469e-06, "add_time_dim_to_batch_and_zero_pad": 2.2665398635459975e-06, "add_observations_from_episodes_to_batch": 2.8748995487694166e-06}}, "connector_pipeline_timer": 4.314738683890915e-05}, "sample": 0.10667754577143648, "module_to_env_connector": {"timers": {"connectors": {"get_actions": 3.813890561879383e-05, "remove_single_ts_time_rank_from_batch": 5.727810229718402e-07, "normalize_and_clip_actions": 9.695837928404805e-06, "un_batch_to_individual_items": 5.337252666097315e-06, "tensor_to_numpy": 1.325160469574726e-05, "listify_data_for_vector_env": 1.1176994839209146e-05}}, "connector_pipeline_timer": 0.00010385382396262111}, "episode_duration_sec_mean": 0.00470410379464738, "module_episode_returns_mean": {"default_policy": -0.6}, "num_env_steps_sampled_lifetime": 55400, "episode_len_min": 20, "num_agent_steps_sampled_lifetime": {"default_agent": 4400}, "episode_len_max": 20, "num_episodes_lifetime": 220, "episode_return_min": -14.5, "env_step_timer": 1.420103099934379e-05, "env_to_module_sum_episodes_length_out": 10.368238394574323, "num_agent_steps_sampled": {"default_agent": 400}, "env_to_module_sum_episodes_length_in": 10.368238394574323, "episode_return_max": 14.5, "agent_episode_returns_mean": {"default_agent": -0.6}, "num_module_steps_sampled_lifetime": {"default_policy": 4400}, "weights_seq_no": 11.0, "env_reset_timer": 0.00022037071469915436, "episode_len_mean": 20.0, "num_module_steps_sampled": {"default_policy": 400}, "episode_return_mean": -0.6, "rlmodule_inference_timer": 2.7979537969407283e-05, "num_env_steps_sampled": 400, "time_between_sampling": 1.6089221578097344}, "num_healthy_workers": 1, "actor_manager_num_outstanding_async_reqs": 0, "num_remote_worker_restarts": 0}, "num_env_steps_sampled_lifetime": -5547500.0, "fault_tolerance": {"num_healthy_workers": 0, "num_remote_worker_restarts": 0}, "env_runner_group": {"actor_manager_num_outstanding_async_reqs": 0}, "done": false, "training_iteration": 11, "trial_id": "43bd0_00000", "date": "2025-08-11_19-24-37", "timestamp": 1754933077, "time_this_iter_s": 1.6012418270111084, "time_total_s": 18.5327570438385, "pid": 14505, "hostname": "Mac", "node_ip": "127.0.0.1", "config": {"exploration_config": {}, "extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "placement_strategy": "PACK", "num_gpus": 0, "_fake_gpus": false, "num_cpus_for_main_process": 2, "eager_tracing": true, "eager_max_retraces": 20, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "torch_compile_learner": false, "torch_compile_learner_what_to_compile": "forward_train", "torch_compile_learner_dynamo_backend": "aot_eager", "torch_compile_learner_dynamo_mode": null, "torch_compile_worker": false, "torch_compile_worker_dynamo_backend": "aot_eager", "torch_compile_worker_dynamo_mode": null, "torch_ddp_kwargs": {}, "torch_skip_nan_gradients": false, "env": "Umbrella", "env_config": {}, "observation_space": null, "action_space": null, "clip_rewards": null, "normalize_actions": true, "clip_actions": false, "_is_atari": null, "disable_env_checking": false, "render_env": false, "action_mask_key": "action_mask", "env_runner_cls": null, "num_env_runners": 0, "create_local_env_runner": true, "num_envs_per_env_runner": 1, "gym_env_vectorize_mode": "SYNC", "num_cpus_per_env_runner": 1, "num_gpus_per_env_runner": 0, "custom_resources_per_env_runner": {}, "validate_env_runners_after_construction": true, "episodes_to_numpy": true, "max_requests_in_flight_per_env_runner": 1, "sample_timeout_s": 60.0, "_env_to_module_connector": null, "add_default_connectors_to_env_to_module_pipeline": true, "_module_to_env_connector": null, "add_default_connectors_to_module_to_env_pipeline": true, "merge_env_runner_states": "training_only", "broadcast_env_runner_states": true, "episode_lookback_horizon": 1, "rollout_fragment_length": "auto", "batch_mode": "complete_episodes", "compress_observations": false, "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "enable_tf1_exec_eagerly": false, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "preprocessor_pref": "deepmind", "observation_filter": "NoFilter", "update_worker_filter_stats": true, "use_worker_filter_stats": true, "sampler_perf_stats_ema_coef": null, "_is_online": true, "num_learners": 0, "num_gpus_per_learner": 0, "num_cpus_per_learner": "auto", "num_aggregator_actors_per_learner": 0, "max_requests_in_flight_per_aggregator_actor": 3, "local_gpu_idx": 0, "max_requests_in_flight_per_learner": 3, "gamma": 1, "lr": 0.0002847858517, "grad_clip": 0.5, "grad_clip_by": "global_norm", "_train_batch_size_per_learner": 5000, "train_batch_size": 4000, "num_epochs": 1, "minibatch_size": 1000, "shuffle_batch_per_epoch": true, "model": {"fcnet_hiddens": [256, 256], "fcnet_activation": "tanh", "fcnet_weights_initializer": null, "fcnet_weights_initializer_config": null, "fcnet_bias_initializer": null, "fcnet_bias_initializer_config": null, "conv_filters": null, "conv_activation": "relu", "conv_kernel_initializer": null, "conv_kernel_initializer_config": null, "conv_bias_initializer": null, "conv_bias_initializer_config": null, "conv_transpose_kernel_initializer": null, "conv_transpose_kernel_initializer_config": null, "conv_transpose_bias_initializer": null, "conv_transpose_bias_initializer_config": null, "post_fcnet_hiddens": [], "post_fcnet_activation": "relu", "post_fcnet_weights_initializer": null, "post_fcnet_weights_initializer_config": null, "post_fcnet_bias_initializer": null, "post_fcnet_bias_initializer_config": null, "free_log_std": false, "log_std_clip_param": 20.0, "no_final_linear": false, "vf_share_layers": false, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "lstm_weights_initializer": null, "lstm_weights_initializer_config": null, "lstm_bias_initializer": null, "lstm_bias_initializer_config": null, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "attention_use_n_prev_actions": 0, "attention_use_n_prev_rewards": 0, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": null, "custom_model_config": {}, "custom_action_dist": null, "custom_preprocessor": null, "encoder_latent_dim": null, "always_check_shapes": false, "lstm_use_prev_action_reward": -1, "_use_default_native_models": -1, "_disable_preprocessor_api": false, "_disable_action_flattening": false}, "_learner_connector": null, "add_default_connectors_to_learner_pipeline": true, "learner_config_dict": {}, "optimizer": {}, "_learner_class": null, "callbacks_on_algorithm_init": null, "callbacks_on_env_runners_recreated": null, "callbacks_on_offline_eval_runners_recreated": null, "callbacks_on_checkpoint_loaded": null, "callbacks_on_environment_created": null, "callbacks_on_episode_created": null, "callbacks_on_episode_start": null, "callbacks_on_episode_step": null, "callbacks_on_episode_end": null, "callbacks_on_evaluate_start": null, "callbacks_on_evaluate_end": null, "callbacks_on_evaluate_offline_start": null, "callbacks_on_evaluate_offline_end": null, "callbacks_on_sample_end": null, "callbacks_on_train_result": null, "explore": true, "enable_rl_module_and_learner": true, "enable_env_runner_and_connector_v2": true, "_prior_exploration_config": {"type": "StochasticSampling"}, "count_steps_by": "env_steps", "policy_map_capacity": 100, "policy_mapping_fn": "<function AlgorithmConfig.DEFAULT_POLICY_MAPPING_FN at 0x3855e5b20>", "policies_to_train": null, "policy_states_are_swappable": false, "observation_fn": null, "offline_data_class": null, "input_read_method": "read_parquet", "input_read_method_kwargs": {}, "input_read_schema": {}, "input_read_episodes": false, "input_read_sample_batches": false, "input_read_batch_size": null, "input_filesystem": null, "input_filesystem_kwargs": {}, "input_compress_columns": ["obs", "new_obs"], "input_spaces_jsonable": true, "materialize_data": false, "materialize_mapped_data": true, "map_batches_kwargs": {}, "iter_batches_kwargs": {}, "ignore_final_observation": false, "prelearner_class": null, "prelearner_buffer_class": null, "prelearner_buffer_kwargs": {}, "prelearner_module_synch_period": 10, "dataset_num_iters_per_learner": null, "input_config": {}, "actions_in_input_normalized": false, "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_config": {}, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "output_max_rows_per_file": null, "output_write_remaining_data": false, "output_write_method": "write_parquet", "output_write_method_kwargs": {}, "output_filesystem": null, "output_filesystem_kwargs": {}, "output_write_episodes": true, "offline_sampling": false, "evaluation_interval": 1, "evaluation_duration": 20, "evaluation_duration_unit": "episodes", "evaluation_sample_timeout_s": 120.0, "evaluation_auto_duration_min_env_steps_per_sample": 100, "evaluation_auto_duration_max_env_steps_per_sample": 2000, "evaluation_parallel_to_training": false, "evaluation_force_reset_envs_before_iteration": true, "evaluation_config": null, "off_policy_estimation_methods": {}, "ope_split_batch_by_episode": true, "evaluation_num_env_runners": 1, "in_evaluation": false, "sync_filters_on_rollout_workers_timeout_s": 10.0, "offline_evaluation_interval": null, "num_offline_eval_runners": 0, "offline_loss_for_module_fn": null, "offline_evaluation_duration": 1, "offline_evaluation_parallel_to_training": false, "offline_evaluation_timeout_s": 120.0, "num_cpus_per_offline_eval_runner": 1, "num_gpus_per_offline_eval_runner": 0, "custom_resources_per_offline_eval_runner": {}, "restart_failed_offline_eval_runners": true, "ignore_offline_eval_runner_failures": false, "max_num_offline_eval_runner_restarts": 1000, "offline_eval_runner_restore_timeout_s": 1800.0, "max_requests_in_flight_per_offline_eval_runner": 1, "validate_offline_eval_runners_after_construction": true, "offline_eval_runner_health_probe_timeout_s": 30.0, "offline_eval_rl_module_inference_only": false, "broadcast_offline_eval_runner_states": false, "offline_eval_batch_size_per_runner": 256, "dataset_num_iters_per_eval_runner": 1, "keep_per_episode_custom_metrics": false, "metrics_episode_collection_timeout_s": 60.0, "metrics_num_episodes_for_smoothing": 100, "min_time_s_per_iteration": null, "min_train_timesteps_per_iteration": 0, "min_sample_timesteps_per_iteration": 0, "log_gradients": true, "export_native_model_files": false, "checkpoint_trainable_policies_only": false, "logger_creator": null, "logger_config": null, "log_level": "WARN", "log_sys_usage": true, "fake_sampler": false, "seed": 2, "restart_failed_env_runners": true, "ignore_env_runner_failures": false, "max_num_env_runner_restarts": 1000, "delay_between_env_runner_restarts_s": 60.0, "restart_failed_sub_environments": false, "num_consecutive_env_runner_failures_tolerance": 100, "env_runner_health_probe_timeout_s": 30.0, "env_runner_restore_timeout_s": 1800.0, "_model_config": {}, "_rl_module_spec": "RLModuleSpec(module_class=None, observation_space=None, action_space=None, inference_only=False, learner_only=False, model_config=DefaultModelConfig(fcnet_hiddens=[60, 90], fcnet_activation='tanh', fcnet_kernel_initializer=None, fcnet_kernel_initializer_kwargs=None, fcnet_bias_initializer=None, fcnet_bias_initializer_kwargs=None, conv_filters=None, conv_activation='relu', conv_kernel_initializer=None, conv_kernel_initializer_kwargs=None, conv_bias_initializer=None, conv_bias_initializer_kwargs=None, head_fcnet_hiddens=[], head_fcnet_activation='relu', head_fcnet_kernel_initializer=None, head_fcnet_kernel_initializer_kwargs=None, head_fcnet_bias_initializer=None, head_fcnet_bias_initializer_kwargs=None, free_log_std=False, log_std_clip_param=20.0, vf_share_layers=True, use_lstm=False, max_seq_len=20, lstm_cell_size=256, lstm_use_prev_action=False, lstm_use_prev_reward=False, lstm_kernel_initializer=None, lstm_kernel_initializer_kwargs=None, lstm_bias_initializer=None, lstm_bias_initializer_kwargs=None), catalog_class=None, load_state_path=None, model_config_dict=None)", "algorithm_config_overrides_per_module": {}, "_per_module_overrides": {}, "_validate_config": true, "_use_msgpack_checkpoints": false, "_torch_grad_scaler_class": null, "_torch_lr_scheduler_classes": null, "_tf_policy_handles_more_than_one_loss": false, "_disable_preprocessor_api": false, "_disable_action_flattening": false, "_disable_initialize_loss_from_dummy_batch": false, "_dont_auto_sync_env_runner_states": false, "env_task_fn": -1, "enable_connectors": -1, "simple_optimizer": false, "policy_map_cache": -1, "worker_cls": -1, "synchronize_filters": -1, "enable_async_evaluation": -1, "custom_async_evaluation_function": -1, "_enable_rl_module_api": -1, "auto_wrap_old_gym_envs": -1, "always_attach_evaluation_results": -1, "replay_sequence_length": null, "_disable_execution_plan_api": -1, "use_critic": true, "use_gae": true, "use_kl_loss": true, "kl_coeff": 0.7464963036515, "kl_target": 0.0270990929592, "vf_loss_coeff": 0.6688075857018, "entropy_coeff": 0.0090570820258, "clip_param": 0.1221781641624, "vf_clip_param": 0.1027808522125, "entropy_coeff_schedule": null, "lr_schedule": null, "sgd_minibatch_size": -1, "vf_share_layers": -1, "__stdout_file__": null, "__stderr_file__": null, "lambda": 0.9099046732075, "input": "sampler", "policies": {"default_policy": [null, null, null, null]}, "callbacks": "<class 'ray.rllib.callbacks.callbacks.RLlibCallback'>", "create_env_on_driver": false, "custom_eval_function": null, "framework": "torch"}, "time_since_restore": 18.5327570438385, "iterations_since_restore": 11, "perf": {"cpu_util_percent": 41.85, "ram_util_percent": 77.35}}
{"timers": {"training_iteration": 1.6059038411968234, "restore_env_runners": 1.226678614597371e-05, "training_step": 1.6057656506325027, "env_runner_sampling_timer": 1.4933862826666724, "learner_update_timer": 0.10929103420531093, "synch_weights": 0.0005905720266449581, "restore_eval_env_runners": 9.46884423400961e-06, "evaluation_iteration": 0.1134807187639902, "synch_eval_env_connectors": 0.00013684885719669323, "synch_env_connectors": 4.400183747192106e-06}, "env_runners": {"env_step_timer": 1.4052930934486972e-05, "num_agent_steps_sampled_lifetime": {"default_agent": -6165000.0}, "episode_duration_sec_mean": 0.004604037467855961, "env_to_module_connector": {"timers": {"connectors": {"add_time_dim_to_batch_and_zero_pad": 2.3827039834707286e-06, "add_observations_from_episodes_to_batch": 3.0986175739596692e-06, "batch_individual_items": 6.415374414961367e-06, "add_states_from_episodes_to_batch": 1.749468202236278e-06, "numpy_to_tensor": 8.802240553655384e-06}}, "connector_pipeline_timer": 4.431284071082797e-05}, "num_env_steps_sampled_lifetime": -6165000.0, "episode_return_mean": 4.980000000000002, "module_to_env_connector": {"timers": {"connectors": {"tensor_to_numpy": 1.3155632080734794e-05, "normalize_and_clip_actions": 9.578067949745682e-06, "listify_data_for_vector_env": 1.1200390620766864e-05, "remove_single_ts_time_rank_from_batch": 6.051111886335937e-07, "get_actions": 3.875988260832118e-05, "un_batch_to_individual_items": 5.466194503581542e-06}}, "connector_pipeline_timer": 0.00010466492326409982}, "weights_seq_no": 11.0, "env_to_module_sum_episodes_length_out": 10.36823839457432, "episode_len_min": 20, "num_agent_steps_sampled": {"default_agent": 5000.0}, "env_reset_timer": 3.866024214988317e-05, "rlmodule_inference_timer": 2.808217292018725e-05, "num_env_steps_sampled": 5000.0, "env_to_module_sum_episodes_length_in": 10.36823839457432, "num_module_steps_sampled": {"default_policy": 5000.0}, "episode_len_mean": 20.0, "episode_len_max": 20, "num_episodes": 250.0, "num_episodes_lifetime": -308250.0, "time_between_sampling": 0.001871341500148024, "episode_return_min": -11.5, "agent_episode_returns_mean": {"default_agent": 4.980000000000002}, "episode_return_max": 8.5, "num_module_steps_sampled_lifetime": {"default_policy": -6165000.0}, "module_episode_returns_mean": {"default_policy": 4.980000000000002}, "sample": 0.004928302405154902, "num_env_steps_sampled_lifetime_throughput": 3646.531130615437}, "learners": {"__all_modules__": {"learner_connector": {"timers": {"connectors": {"add_states_from_episodes_to_batch": 3.5872786846887883e-06, "numpy_to_tensor": 7.944506063265514e-05, "batch_individual_items": 0.03389514411067089, "add_columns_from_episodes_to_train_batch": 0.03448249384447151, "add_time_dim_to_batch_and_zero_pad": 1.2240919777453865e-05, "add_observations_from_episodes_to_batch": 0.0008506106970593212, "add_one_ts_to_episodes_and_truncate": 0.008527298687336374, "general_advantage_estimation": 0.006668384776560782}}, "connector_pipeline_timer": 0.08466598311888475}, "num_env_steps_trained": 31500, "learner_connector_sum_episodes_length_out": 5250.0, "num_non_trainable_parameters": 0, "num_module_steps_trained_lifetime": 72000, "learner_connector_sum_episodes_length_in": 5000.0, "num_env_steps_trained_lifetime": 378000, "num_module_steps_trained": 6000, "num_trainable_parameters": 6003, "num_env_steps_trained_lifetime_throughput": 2169972.4770635497, "num_module_steps_trained_throughput": 414934.37266687717, "num_module_steps_trained_lifetime_throughput": 414302.42999569856}, "default_policy": {"num_module_steps_trained_lifetime": 72000, "gradients_default_optimizer_global_norm": 0.06014768406748772, "total_loss": -0.030171997845172882, "weights_seq_no": 12.0, "diff_num_grad_updates_vs_sampler_policy": 1.0, "num_module_steps_trained": 6000, "vf_loss": 0.10278083384037018, "entropy": 0.4981132447719574, "vf_explained_var": -0.00040781497955322266, "curr_kl_coeff": 0.00018225007806904614, "default_optimizer_learning_rate": 0.0002847858517, "num_trainable_parameters": 6003, "module_train_batch_size_mean": 1000.0, "vf_loss_unclipped": 27.940900802612305, "policy_loss": -0.09440136700868607, "mean_kl_loss": 0.0005731904529966414, "curr_entropy_coeff": 0.0090570820258, "num_module_steps_trained_lifetime_throughput": 415303.9533306687}}, "num_training_step_calls_per_iteration": 1, "evaluation": {"env_runners": {"num_episodes": 20, "env_to_module_connector": {"timers": {"connectors": {"add_states_from_episodes_to_batch": 1.788940865091954e-06, "numpy_to_tensor": 9.630522148390722e-06, "batch_individual_items": 6.786763698924071e-06, "add_time_dim_to_batch_and_zero_pad": 2.472484540290393e-06, "add_observations_from_episodes_to_batch": 3.436305265479998e-06}}, "connector_pipeline_timer": 4.7335873095439886e-05}, "sample": 0.10668087947364062, "module_to_env_connector": {"timers": {"connectors": {"get_actions": 4.3998490852343385e-05, "remove_single_ts_time_rank_from_batch": 6.27875027940511e-07, "normalize_and_clip_actions": 1.148312787013485e-05, "un_batch_to_individual_items": 5.796180344929416e-06, "tensor_to_numpy": 1.4757849024224338e-05, "listify_data_for_vector_env": 1.246700332464019e-05}}, "connector_pipeline_timer": 0.00011772471889125496}, "episode_duration_sec_mean": 0.004654407162452117, "module_episode_returns_mean": {"default_policy": 0.0}, "num_env_steps_sampled_lifetime": 60400, "episode_len_min": 20, "num_agent_steps_sampled_lifetime": {"default_agent": 4800}, "episode_len_max": 20, "num_episodes_lifetime": 240, "episode_return_min": -14.5, "env_step_timer": 1.614111093731552e-05, "env_to_module_sum_episodes_length_out": 10.368238394574323, "num_agent_steps_sampled": {"default_agent": 400}, "env_to_module_sum_episodes_length_in": 10.368238394574323, "episode_return_max": 14.5, "agent_episode_returns_mean": {"default_agent": 0.0}, "num_module_steps_sampled_lifetime": {"default_policy": 4800}, "weights_seq_no": 12.0, "env_reset_timer": 0.00021920242754340272, "episode_len_mean": 20.0, "num_module_steps_sampled": {"default_policy": 400}, "episode_return_mean": 0.0, "rlmodule_inference_timer": 3.148221601284164e-05, "num_env_steps_sampled": 400, "time_between_sampling": 1.608939749141348}, "num_healthy_workers": 1, "actor_manager_num_outstanding_async_reqs": 0, "num_remote_worker_restarts": 0}, "num_env_steps_sampled_lifetime": -6165000.0, "fault_tolerance": {"num_healthy_workers": 0, "num_remote_worker_restarts": 0}, "env_runner_group": {"actor_manager_num_outstanding_async_reqs": 0}, "done": false, "training_iteration": 12, "trial_id": "43bd0_00000", "date": "2025-08-11_19-24-39", "timestamp": 1754933079, "time_this_iter_s": 1.708395004272461, "time_total_s": 20.241152048110962, "pid": 14505, "hostname": "Mac", "node_ip": "127.0.0.1", "config": {"exploration_config": {}, "extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "placement_strategy": "PACK", "num_gpus": 0, "_fake_gpus": false, "num_cpus_for_main_process": 2, "eager_tracing": true, "eager_max_retraces": 20, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "torch_compile_learner": false, "torch_compile_learner_what_to_compile": "forward_train", "torch_compile_learner_dynamo_backend": "aot_eager", "torch_compile_learner_dynamo_mode": null, "torch_compile_worker": false, "torch_compile_worker_dynamo_backend": "aot_eager", "torch_compile_worker_dynamo_mode": null, "torch_ddp_kwargs": {}, "torch_skip_nan_gradients": false, "env": "Umbrella", "env_config": {}, "observation_space": null, "action_space": null, "clip_rewards": null, "normalize_actions": true, "clip_actions": false, "_is_atari": null, "disable_env_checking": false, "render_env": false, "action_mask_key": "action_mask", "env_runner_cls": null, "num_env_runners": 0, "create_local_env_runner": true, "num_envs_per_env_runner": 1, "gym_env_vectorize_mode": "SYNC", "num_cpus_per_env_runner": 1, "num_gpus_per_env_runner": 0, "custom_resources_per_env_runner": {}, "validate_env_runners_after_construction": true, "episodes_to_numpy": true, "max_requests_in_flight_per_env_runner": 1, "sample_timeout_s": 60.0, "_env_to_module_connector": null, "add_default_connectors_to_env_to_module_pipeline": true, "_module_to_env_connector": null, "add_default_connectors_to_module_to_env_pipeline": true, "merge_env_runner_states": "training_only", "broadcast_env_runner_states": true, "episode_lookback_horizon": 1, "rollout_fragment_length": "auto", "batch_mode": "complete_episodes", "compress_observations": false, "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "enable_tf1_exec_eagerly": false, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "preprocessor_pref": "deepmind", "observation_filter": "NoFilter", "update_worker_filter_stats": true, "use_worker_filter_stats": true, "sampler_perf_stats_ema_coef": null, "_is_online": true, "num_learners": 0, "num_gpus_per_learner": 0, "num_cpus_per_learner": "auto", "num_aggregator_actors_per_learner": 0, "max_requests_in_flight_per_aggregator_actor": 3, "local_gpu_idx": 0, "max_requests_in_flight_per_learner": 3, "gamma": 1, "lr": 0.0002847858517, "grad_clip": 0.5, "grad_clip_by": "global_norm", "_train_batch_size_per_learner": 5000, "train_batch_size": 4000, "num_epochs": 1, "minibatch_size": 1000, "shuffle_batch_per_epoch": true, "model": {"fcnet_hiddens": [256, 256], "fcnet_activation": "tanh", "fcnet_weights_initializer": null, "fcnet_weights_initializer_config": null, "fcnet_bias_initializer": null, "fcnet_bias_initializer_config": null, "conv_filters": null, "conv_activation": "relu", "conv_kernel_initializer": null, "conv_kernel_initializer_config": null, "conv_bias_initializer": null, "conv_bias_initializer_config": null, "conv_transpose_kernel_initializer": null, "conv_transpose_kernel_initializer_config": null, "conv_transpose_bias_initializer": null, "conv_transpose_bias_initializer_config": null, "post_fcnet_hiddens": [], "post_fcnet_activation": "relu", "post_fcnet_weights_initializer": null, "post_fcnet_weights_initializer_config": null, "post_fcnet_bias_initializer": null, "post_fcnet_bias_initializer_config": null, "free_log_std": false, "log_std_clip_param": 20.0, "no_final_linear": false, "vf_share_layers": false, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "lstm_weights_initializer": null, "lstm_weights_initializer_config": null, "lstm_bias_initializer": null, "lstm_bias_initializer_config": null, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "attention_use_n_prev_actions": 0, "attention_use_n_prev_rewards": 0, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": null, "custom_model_config": {}, "custom_action_dist": null, "custom_preprocessor": null, "encoder_latent_dim": null, "always_check_shapes": false, "lstm_use_prev_action_reward": -1, "_use_default_native_models": -1, "_disable_preprocessor_api": false, "_disable_action_flattening": false}, "_learner_connector": null, "add_default_connectors_to_learner_pipeline": true, "learner_config_dict": {}, "optimizer": {}, "_learner_class": null, "callbacks_on_algorithm_init": null, "callbacks_on_env_runners_recreated": null, "callbacks_on_offline_eval_runners_recreated": null, "callbacks_on_checkpoint_loaded": null, "callbacks_on_environment_created": null, "callbacks_on_episode_created": null, "callbacks_on_episode_start": null, "callbacks_on_episode_step": null, "callbacks_on_episode_end": null, "callbacks_on_evaluate_start": null, "callbacks_on_evaluate_end": null, "callbacks_on_evaluate_offline_start": null, "callbacks_on_evaluate_offline_end": null, "callbacks_on_sample_end": null, "callbacks_on_train_result": null, "explore": true, "enable_rl_module_and_learner": true, "enable_env_runner_and_connector_v2": true, "_prior_exploration_config": {"type": "StochasticSampling"}, "count_steps_by": "env_steps", "policy_map_capacity": 100, "policy_mapping_fn": "<function AlgorithmConfig.DEFAULT_POLICY_MAPPING_FN at 0x3855e5b20>", "policies_to_train": null, "policy_states_are_swappable": false, "observation_fn": null, "offline_data_class": null, "input_read_method": "read_parquet", "input_read_method_kwargs": {}, "input_read_schema": {}, "input_read_episodes": false, "input_read_sample_batches": false, "input_read_batch_size": null, "input_filesystem": null, "input_filesystem_kwargs": {}, "input_compress_columns": ["obs", "new_obs"], "input_spaces_jsonable": true, "materialize_data": false, "materialize_mapped_data": true, "map_batches_kwargs": {}, "iter_batches_kwargs": {}, "ignore_final_observation": false, "prelearner_class": null, "prelearner_buffer_class": null, "prelearner_buffer_kwargs": {}, "prelearner_module_synch_period": 10, "dataset_num_iters_per_learner": null, "input_config": {}, "actions_in_input_normalized": false, "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_config": {}, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "output_max_rows_per_file": null, "output_write_remaining_data": false, "output_write_method": "write_parquet", "output_write_method_kwargs": {}, "output_filesystem": null, "output_filesystem_kwargs": {}, "output_write_episodes": true, "offline_sampling": false, "evaluation_interval": 1, "evaluation_duration": 20, "evaluation_duration_unit": "episodes", "evaluation_sample_timeout_s": 120.0, "evaluation_auto_duration_min_env_steps_per_sample": 100, "evaluation_auto_duration_max_env_steps_per_sample": 2000, "evaluation_parallel_to_training": false, "evaluation_force_reset_envs_before_iteration": true, "evaluation_config": null, "off_policy_estimation_methods": {}, "ope_split_batch_by_episode": true, "evaluation_num_env_runners": 1, "in_evaluation": false, "sync_filters_on_rollout_workers_timeout_s": 10.0, "offline_evaluation_interval": null, "num_offline_eval_runners": 0, "offline_loss_for_module_fn": null, "offline_evaluation_duration": 1, "offline_evaluation_parallel_to_training": false, "offline_evaluation_timeout_s": 120.0, "num_cpus_per_offline_eval_runner": 1, "num_gpus_per_offline_eval_runner": 0, "custom_resources_per_offline_eval_runner": {}, "restart_failed_offline_eval_runners": true, "ignore_offline_eval_runner_failures": false, "max_num_offline_eval_runner_restarts": 1000, "offline_eval_runner_restore_timeout_s": 1800.0, "max_requests_in_flight_per_offline_eval_runner": 1, "validate_offline_eval_runners_after_construction": true, "offline_eval_runner_health_probe_timeout_s": 30.0, "offline_eval_rl_module_inference_only": false, "broadcast_offline_eval_runner_states": false, "offline_eval_batch_size_per_runner": 256, "dataset_num_iters_per_eval_runner": 1, "keep_per_episode_custom_metrics": false, "metrics_episode_collection_timeout_s": 60.0, "metrics_num_episodes_for_smoothing": 100, "min_time_s_per_iteration": null, "min_train_timesteps_per_iteration": 0, "min_sample_timesteps_per_iteration": 0, "log_gradients": true, "export_native_model_files": false, "checkpoint_trainable_policies_only": false, "logger_creator": null, "logger_config": null, "log_level": "WARN", "log_sys_usage": true, "fake_sampler": false, "seed": 2, "restart_failed_env_runners": true, "ignore_env_runner_failures": false, "max_num_env_runner_restarts": 1000, "delay_between_env_runner_restarts_s": 60.0, "restart_failed_sub_environments": false, "num_consecutive_env_runner_failures_tolerance": 100, "env_runner_health_probe_timeout_s": 30.0, "env_runner_restore_timeout_s": 1800.0, "_model_config": {}, "_rl_module_spec": "RLModuleSpec(module_class=None, observation_space=None, action_space=None, inference_only=False, learner_only=False, model_config=DefaultModelConfig(fcnet_hiddens=[60, 90], fcnet_activation='tanh', fcnet_kernel_initializer=None, fcnet_kernel_initializer_kwargs=None, fcnet_bias_initializer=None, fcnet_bias_initializer_kwargs=None, conv_filters=None, conv_activation='relu', conv_kernel_initializer=None, conv_kernel_initializer_kwargs=None, conv_bias_initializer=None, conv_bias_initializer_kwargs=None, head_fcnet_hiddens=[], head_fcnet_activation='relu', head_fcnet_kernel_initializer=None, head_fcnet_kernel_initializer_kwargs=None, head_fcnet_bias_initializer=None, head_fcnet_bias_initializer_kwargs=None, free_log_std=False, log_std_clip_param=20.0, vf_share_layers=True, use_lstm=False, max_seq_len=20, lstm_cell_size=256, lstm_use_prev_action=False, lstm_use_prev_reward=False, lstm_kernel_initializer=None, lstm_kernel_initializer_kwargs=None, lstm_bias_initializer=None, lstm_bias_initializer_kwargs=None), catalog_class=None, load_state_path=None, model_config_dict=None)", "algorithm_config_overrides_per_module": {}, "_per_module_overrides": {}, "_validate_config": true, "_use_msgpack_checkpoints": false, "_torch_grad_scaler_class": null, "_torch_lr_scheduler_classes": null, "_tf_policy_handles_more_than_one_loss": false, "_disable_preprocessor_api": false, "_disable_action_flattening": false, "_disable_initialize_loss_from_dummy_batch": false, "_dont_auto_sync_env_runner_states": false, "env_task_fn": -1, "enable_connectors": -1, "simple_optimizer": false, "policy_map_cache": -1, "worker_cls": -1, "synchronize_filters": -1, "enable_async_evaluation": -1, "custom_async_evaluation_function": -1, "_enable_rl_module_api": -1, "auto_wrap_old_gym_envs": -1, "always_attach_evaluation_results": -1, "replay_sequence_length": null, "_disable_execution_plan_api": -1, "use_critic": true, "use_gae": true, "use_kl_loss": true, "kl_coeff": 0.7464963036515, "kl_target": 0.0270990929592, "vf_loss_coeff": 0.6688075857018, "entropy_coeff": 0.0090570820258, "clip_param": 0.1221781641624, "vf_clip_param": 0.1027808522125, "entropy_coeff_schedule": null, "lr_schedule": null, "sgd_minibatch_size": -1, "vf_share_layers": -1, "__stdout_file__": null, "__stderr_file__": null, "lambda": 0.9099046732075, "input": "sampler", "policies": {"default_policy": [null, null, null, null]}, "callbacks": "<class 'ray.rllib.callbacks.callbacks.RLlibCallback'>", "create_env_on_driver": false, "custom_eval_function": null, "framework": "torch"}, "time_since_restore": 20.241152048110962, "iterations_since_restore": 12, "perf": {"cpu_util_percent": 42.35, "ram_util_percent": 77.5}}
{"timers": {"training_iteration": 1.605848301945143, "restore_env_runners": 1.2197868402754688e-05, "training_step": 1.6057096232966737, "env_runner_sampling_timer": 1.493486411500463, "learner_update_timer": 0.10913403386395647, "synch_weights": 0.0005901521362757334, "restore_eval_env_runners": 9.447076020955469e-06, "evaluation_iteration": 0.11346744990668546, "synch_eval_env_connectors": 0.00013655370857874487, "synch_env_connectors": 4.392432476783874e-06}, "env_runners": {"env_step_timer": 1.406267723325524e-05, "num_agent_steps_sampled_lifetime": {"default_agent": -6782500.0}, "episode_duration_sec_mean": 0.004621310163289309, "env_to_module_connector": {"timers": {"connectors": {"add_time_dim_to_batch_and_zero_pad": 2.383621378269459e-06, "add_observations_from_episodes_to_batch": 3.0177946578613204e-06, "batch_individual_items": 6.468471346487037e-06, "add_states_from_episodes_to_batch": 1.7604017057717172e-06, "numpy_to_tensor": 8.794589220945068e-06}}, "connector_pipeline_timer": 4.4410647008835014e-05}, "num_env_steps_sampled_lifetime": -6782500.0, "episode_return_mean": 5.619999999999999, "module_to_env_connector": {"timers": {"connectors": {"tensor_to_numpy": 1.3217944467728822e-05, "normalize_and_clip_actions": 9.627451487285371e-06, "listify_data_for_vector_env": 1.1262699795673103e-05, "remove_single_ts_time_rank_from_batch": 6.020944257720961e-07, "get_actions": 3.9067183184391156e-05, "un_batch_to_individual_items": 5.516730368563054e-06}}, "connector_pipeline_timer": 0.00010529268514711834}, "weights_seq_no": 12.0, "env_to_module_sum_episodes_length_out": 10.36823839457432, "episode_len_min": 20, "num_agent_steps_sampled": {"default_agent": 5000.0}, "env_reset_timer": 4.0566037073348546e-05, "rlmodule_inference_timer": 2.7956587811869673e-05, "num_env_steps_sampled": 5000.0, "env_to_module_sum_episodes_length_in": 10.36823839457432, "num_module_steps_sampled": {"default_policy": 5000.0}, "episode_len_mean": 20.0, "episode_len_max": 20, "num_episodes": 250.0, "num_episodes_lifetime": -339125.0, "time_between_sampling": 0.0017764607462412035, "episode_return_min": -11.5, "agent_episode_returns_mean": {"default_agent": 5.619999999999999}, "episode_return_max": 8.5, "num_module_steps_sampled_lifetime": {"default_policy": -6782500.0}, "module_episode_returns_mean": {"default_policy": 5.619999999999999}, "sample": 0.004964836685045687, "num_env_steps_sampled_lifetime_throughput": 3627.0006128303994}, "learners": {"__all_modules__": {"learner_connector": {"timers": {"connectors": {"add_states_from_episodes_to_batch": 3.5814061262767016e-06, "numpy_to_tensor": 7.925894061884168e-05, "batch_individual_items": 0.03385980891973085, "add_columns_from_episodes_to_train_batch": 0.03447534598597818, "add_time_dim_to_batch_and_zero_pad": 1.2213930398214773e-05, "add_observations_from_episodes_to_batch": 0.0008501316698367177, "add_one_ts_to_episodes_and_truncate": 0.008519706529444112, "general_advantage_estimation": 0.006659326348953903}}, "connector_pipeline_timer": 0.08460567244875829}, "num_env_steps_trained": 31500, "learner_connector_sum_episodes_length_out": 5250.0, "num_non_trainable_parameters": 0, "num_module_steps_trained_lifetime": 78000, "learner_connector_sum_episodes_length_in": 5000.0, "num_env_steps_trained_lifetime": 409500, "num_module_steps_trained": 6000, "num_trainable_parameters": 6003, "num_env_steps_trained_lifetime_throughput": 2166585.2067928216, "num_module_steps_trained_throughput": 414228.04425180925, "num_module_steps_trained_lifetime_throughput": 413615.3467205241}, "default_policy": {"num_module_steps_trained_lifetime": 78000, "gradients_default_optimizer_global_norm": 0.030830301344394684, "total_loss": 0.13146176934242249, "weights_seq_no": 13.0, "diff_num_grad_updates_vs_sampler_policy": 1.0, "num_module_steps_trained": 6000, "vf_loss": 0.10278083384037018, "entropy": 0.47185197472572327, "vf_explained_var": -0.003191232681274414, "curr_kl_coeff": 9.112503903452307e-05, "default_optimizer_learning_rate": 0.0002847858517, "num_trainable_parameters": 6003, "module_train_batch_size_mean": 1000.0, "vf_loss_unclipped": 28.0755558013916, "policy_loss": 0.06699463725090027, "mean_kl_loss": 0.00074898696038872, "curr_entropy_coeff": 0.0090570820258, "num_module_steps_trained_lifetime_throughput": 414543.8203060665}}, "num_training_step_calls_per_iteration": 1, "evaluation": {"env_runners": {"num_episodes": 20, "env_to_module_connector": {"timers": {"connectors": {"add_states_from_episodes_to_batch": 1.6298988794005461e-06, "numpy_to_tensor": 8.650078514381876e-06, "batch_individual_items": 6.2100574122914184e-06, "add_time_dim_to_batch_and_zero_pad": 2.3029573663781913e-06, "add_observations_from_episodes_to_batch": 2.8824348045389783e-06}}, "connector_pipeline_timer": 4.353485176419957e-05}, "sample": 0.10663474984893717, "module_to_env_connector": {"timers": {"connectors": {"get_actions": 3.875173973958516e-05, "remove_single_ts_time_rank_from_batch": 5.775517933895575e-07, "normalize_and_clip_actions": 9.60656778754546e-06, "un_batch_to_individual_items": 5.446563442675938e-06, "tensor_to_numpy": 1.3530389428410098e-05, "listify_data_for_vector_env": 1.130807635760933e-05}}, "connector_pipeline_timer": 0.0001052237114037234}, "episode_duration_sec_mean": 0.004672208812553436, "module_episode_returns_mean": {"default_policy": 0.2}, "num_env_steps_sampled_lifetime": 65400, "episode_len_min": 20, "num_agent_steps_sampled_lifetime": {"default_agent": 5200}, "episode_len_max": 20, "num_episodes_lifetime": 260, "episode_return_min": -14.5, "env_step_timer": 1.471449488976269e-05, "env_to_module_sum_episodes_length_out": 10.368238394574323, "num_agent_steps_sampled": {"default_agent": 400}, "env_to_module_sum_episodes_length_in": 10.368238394574323, "episode_return_max": 14.5, "agent_episode_returns_mean": {"default_agent": 0.2}, "num_module_steps_sampled_lifetime": {"default_policy": 5200}, "weights_seq_no": 13.0, "env_reset_timer": 0.00021773957296453814, "episode_len_mean": 20.0, "num_module_steps_sampled": {"default_policy": 400}, "episode_return_mean": 0.2, "rlmodule_inference_timer": 2.9103959443446263e-05, "num_env_steps_sampled": 400, "time_between_sampling": 1.6090440870701725}, "num_healthy_workers": 1, "actor_manager_num_outstanding_async_reqs": 0, "num_remote_worker_restarts": 0}, "num_env_steps_sampled_lifetime": -6782500.0, "fault_tolerance": {"num_healthy_workers": 0, "num_remote_worker_restarts": 0}, "env_runner_group": {"actor_manager_num_outstanding_async_reqs": 0}, "done": false, "training_iteration": 13, "trial_id": "43bd0_00000", "date": "2025-08-11_19-24-41", "timestamp": 1754933081, "time_this_iter_s": 1.7096261978149414, "time_total_s": 21.950778245925903, "pid": 14505, "hostname": "Mac", "node_ip": "127.0.0.1", "config": {"exploration_config": {}, "extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "placement_strategy": "PACK", "num_gpus": 0, "_fake_gpus": false, "num_cpus_for_main_process": 2, "eager_tracing": true, "eager_max_retraces": 20, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "torch_compile_learner": false, "torch_compile_learner_what_to_compile": "forward_train", "torch_compile_learner_dynamo_backend": "aot_eager", "torch_compile_learner_dynamo_mode": null, "torch_compile_worker": false, "torch_compile_worker_dynamo_backend": "aot_eager", "torch_compile_worker_dynamo_mode": null, "torch_ddp_kwargs": {}, "torch_skip_nan_gradients": false, "env": "Umbrella", "env_config": {}, "observation_space": null, "action_space": null, "clip_rewards": null, "normalize_actions": true, "clip_actions": false, "_is_atari": null, "disable_env_checking": false, "render_env": false, "action_mask_key": "action_mask", "env_runner_cls": null, "num_env_runners": 0, "create_local_env_runner": true, "num_envs_per_env_runner": 1, "gym_env_vectorize_mode": "SYNC", "num_cpus_per_env_runner": 1, "num_gpus_per_env_runner": 0, "custom_resources_per_env_runner": {}, "validate_env_runners_after_construction": true, "episodes_to_numpy": true, "max_requests_in_flight_per_env_runner": 1, "sample_timeout_s": 60.0, "_env_to_module_connector": null, "add_default_connectors_to_env_to_module_pipeline": true, "_module_to_env_connector": null, "add_default_connectors_to_module_to_env_pipeline": true, "merge_env_runner_states": "training_only", "broadcast_env_runner_states": true, "episode_lookback_horizon": 1, "rollout_fragment_length": "auto", "batch_mode": "complete_episodes", "compress_observations": false, "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "enable_tf1_exec_eagerly": false, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "preprocessor_pref": "deepmind", "observation_filter": "NoFilter", "update_worker_filter_stats": true, "use_worker_filter_stats": true, "sampler_perf_stats_ema_coef": null, "_is_online": true, "num_learners": 0, "num_gpus_per_learner": 0, "num_cpus_per_learner": "auto", "num_aggregator_actors_per_learner": 0, "max_requests_in_flight_per_aggregator_actor": 3, "local_gpu_idx": 0, "max_requests_in_flight_per_learner": 3, "gamma": 1, "lr": 0.0002847858517, "grad_clip": 0.5, "grad_clip_by": "global_norm", "_train_batch_size_per_learner": 5000, "train_batch_size": 4000, "num_epochs": 1, "minibatch_size": 1000, "shuffle_batch_per_epoch": true, "model": {"fcnet_hiddens": [256, 256], "fcnet_activation": "tanh", "fcnet_weights_initializer": null, "fcnet_weights_initializer_config": null, "fcnet_bias_initializer": null, "fcnet_bias_initializer_config": null, "conv_filters": null, "conv_activation": "relu", "conv_kernel_initializer": null, "conv_kernel_initializer_config": null, "conv_bias_initializer": null, "conv_bias_initializer_config": null, "conv_transpose_kernel_initializer": null, "conv_transpose_kernel_initializer_config": null, "conv_transpose_bias_initializer": null, "conv_transpose_bias_initializer_config": null, "post_fcnet_hiddens": [], "post_fcnet_activation": "relu", "post_fcnet_weights_initializer": null, "post_fcnet_weights_initializer_config": null, "post_fcnet_bias_initializer": null, "post_fcnet_bias_initializer_config": null, "free_log_std": false, "log_std_clip_param": 20.0, "no_final_linear": false, "vf_share_layers": false, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "lstm_weights_initializer": null, "lstm_weights_initializer_config": null, "lstm_bias_initializer": null, "lstm_bias_initializer_config": null, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "attention_use_n_prev_actions": 0, "attention_use_n_prev_rewards": 0, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": null, "custom_model_config": {}, "custom_action_dist": null, "custom_preprocessor": null, "encoder_latent_dim": null, "always_check_shapes": false, "lstm_use_prev_action_reward": -1, "_use_default_native_models": -1, "_disable_preprocessor_api": false, "_disable_action_flattening": false}, "_learner_connector": null, "add_default_connectors_to_learner_pipeline": true, "learner_config_dict": {}, "optimizer": {}, "_learner_class": null, "callbacks_on_algorithm_init": null, "callbacks_on_env_runners_recreated": null, "callbacks_on_offline_eval_runners_recreated": null, "callbacks_on_checkpoint_loaded": null, "callbacks_on_environment_created": null, "callbacks_on_episode_created": null, "callbacks_on_episode_start": null, "callbacks_on_episode_step": null, "callbacks_on_episode_end": null, "callbacks_on_evaluate_start": null, "callbacks_on_evaluate_end": null, "callbacks_on_evaluate_offline_start": null, "callbacks_on_evaluate_offline_end": null, "callbacks_on_sample_end": null, "callbacks_on_train_result": null, "explore": true, "enable_rl_module_and_learner": true, "enable_env_runner_and_connector_v2": true, "_prior_exploration_config": {"type": "StochasticSampling"}, "count_steps_by": "env_steps", "policy_map_capacity": 100, "policy_mapping_fn": "<function AlgorithmConfig.DEFAULT_POLICY_MAPPING_FN at 0x3855e5b20>", "policies_to_train": null, "policy_states_are_swappable": false, "observation_fn": null, "offline_data_class": null, "input_read_method": "read_parquet", "input_read_method_kwargs": {}, "input_read_schema": {}, "input_read_episodes": false, "input_read_sample_batches": false, "input_read_batch_size": null, "input_filesystem": null, "input_filesystem_kwargs": {}, "input_compress_columns": ["obs", "new_obs"], "input_spaces_jsonable": true, "materialize_data": false, "materialize_mapped_data": true, "map_batches_kwargs": {}, "iter_batches_kwargs": {}, "ignore_final_observation": false, "prelearner_class": null, "prelearner_buffer_class": null, "prelearner_buffer_kwargs": {}, "prelearner_module_synch_period": 10, "dataset_num_iters_per_learner": null, "input_config": {}, "actions_in_input_normalized": false, "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_config": {}, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "output_max_rows_per_file": null, "output_write_remaining_data": false, "output_write_method": "write_parquet", "output_write_method_kwargs": {}, "output_filesystem": null, "output_filesystem_kwargs": {}, "output_write_episodes": true, "offline_sampling": false, "evaluation_interval": 1, "evaluation_duration": 20, "evaluation_duration_unit": "episodes", "evaluation_sample_timeout_s": 120.0, "evaluation_auto_duration_min_env_steps_per_sample": 100, "evaluation_auto_duration_max_env_steps_per_sample": 2000, "evaluation_parallel_to_training": false, "evaluation_force_reset_envs_before_iteration": true, "evaluation_config": null, "off_policy_estimation_methods": {}, "ope_split_batch_by_episode": true, "evaluation_num_env_runners": 1, "in_evaluation": false, "sync_filters_on_rollout_workers_timeout_s": 10.0, "offline_evaluation_interval": null, "num_offline_eval_runners": 0, "offline_loss_for_module_fn": null, "offline_evaluation_duration": 1, "offline_evaluation_parallel_to_training": false, "offline_evaluation_timeout_s": 120.0, "num_cpus_per_offline_eval_runner": 1, "num_gpus_per_offline_eval_runner": 0, "custom_resources_per_offline_eval_runner": {}, "restart_failed_offline_eval_runners": true, "ignore_offline_eval_runner_failures": false, "max_num_offline_eval_runner_restarts": 1000, "offline_eval_runner_restore_timeout_s": 1800.0, "max_requests_in_flight_per_offline_eval_runner": 1, "validate_offline_eval_runners_after_construction": true, "offline_eval_runner_health_probe_timeout_s": 30.0, "offline_eval_rl_module_inference_only": false, "broadcast_offline_eval_runner_states": false, "offline_eval_batch_size_per_runner": 256, "dataset_num_iters_per_eval_runner": 1, "keep_per_episode_custom_metrics": false, "metrics_episode_collection_timeout_s": 60.0, "metrics_num_episodes_for_smoothing": 100, "min_time_s_per_iteration": null, "min_train_timesteps_per_iteration": 0, "min_sample_timesteps_per_iteration": 0, "log_gradients": true, "export_native_model_files": false, "checkpoint_trainable_policies_only": false, "logger_creator": null, "logger_config": null, "log_level": "WARN", "log_sys_usage": true, "fake_sampler": false, "seed": 2, "restart_failed_env_runners": true, "ignore_env_runner_failures": false, "max_num_env_runner_restarts": 1000, "delay_between_env_runner_restarts_s": 60.0, "restart_failed_sub_environments": false, "num_consecutive_env_runner_failures_tolerance": 100, "env_runner_health_probe_timeout_s": 30.0, "env_runner_restore_timeout_s": 1800.0, "_model_config": {}, "_rl_module_spec": "RLModuleSpec(module_class=None, observation_space=None, action_space=None, inference_only=False, learner_only=False, model_config=DefaultModelConfig(fcnet_hiddens=[60, 90], fcnet_activation='tanh', fcnet_kernel_initializer=None, fcnet_kernel_initializer_kwargs=None, fcnet_bias_initializer=None, fcnet_bias_initializer_kwargs=None, conv_filters=None, conv_activation='relu', conv_kernel_initializer=None, conv_kernel_initializer_kwargs=None, conv_bias_initializer=None, conv_bias_initializer_kwargs=None, head_fcnet_hiddens=[], head_fcnet_activation='relu', head_fcnet_kernel_initializer=None, head_fcnet_kernel_initializer_kwargs=None, head_fcnet_bias_initializer=None, head_fcnet_bias_initializer_kwargs=None, free_log_std=False, log_std_clip_param=20.0, vf_share_layers=True, use_lstm=False, max_seq_len=20, lstm_cell_size=256, lstm_use_prev_action=False, lstm_use_prev_reward=False, lstm_kernel_initializer=None, lstm_kernel_initializer_kwargs=None, lstm_bias_initializer=None, lstm_bias_initializer_kwargs=None), catalog_class=None, load_state_path=None, model_config_dict=None)", "algorithm_config_overrides_per_module": {}, "_per_module_overrides": {}, "_validate_config": true, "_use_msgpack_checkpoints": false, "_torch_grad_scaler_class": null, "_torch_lr_scheduler_classes": null, "_tf_policy_handles_more_than_one_loss": false, "_disable_preprocessor_api": false, "_disable_action_flattening": false, "_disable_initialize_loss_from_dummy_batch": false, "_dont_auto_sync_env_runner_states": false, "env_task_fn": -1, "enable_connectors": -1, "simple_optimizer": false, "policy_map_cache": -1, "worker_cls": -1, "synchronize_filters": -1, "enable_async_evaluation": -1, "custom_async_evaluation_function": -1, "_enable_rl_module_api": -1, "auto_wrap_old_gym_envs": -1, "always_attach_evaluation_results": -1, "replay_sequence_length": null, "_disable_execution_plan_api": -1, "use_critic": true, "use_gae": true, "use_kl_loss": true, "kl_coeff": 0.7464963036515, "kl_target": 0.0270990929592, "vf_loss_coeff": 0.6688075857018, "entropy_coeff": 0.0090570820258, "clip_param": 0.1221781641624, "vf_clip_param": 0.1027808522125, "entropy_coeff_schedule": null, "lr_schedule": null, "sgd_minibatch_size": -1, "vf_share_layers": -1, "__stdout_file__": null, "__stderr_file__": null, "lambda": 0.9099046732075, "input": "sampler", "policies": {"default_policy": [null, null, null, null]}, "callbacks": "<class 'ray.rllib.callbacks.callbacks.RLlibCallback'>", "create_env_on_driver": false, "custom_eval_function": null, "framework": "torch"}, "time_since_restore": 21.950778245925903, "iterations_since_restore": 13, "perf": {"cpu_util_percent": 28.333333333333332, "ram_util_percent": 77.03333333333333}}
{"timers": {"training_iteration": 1.606179757675763, "restore_env_runners": 1.2132969315172106e-05, "training_step": 1.606040749983484, "env_runner_sampling_timer": 1.4929689048849366, "learner_update_timer": 0.1099816872756898, "synch_weights": 0.0005902889554200512, "restore_eval_env_runners": 9.421355493204029e-06, "evaluation_iteration": 0.11340207332853111, "synch_eval_env_connectors": 0.00013714358102723294, "synch_env_connectors": 4.393927589826814e-06}, "env_runners": {"env_step_timer": 1.456365468573421e-05, "num_agent_steps_sampled_lifetime": {"default_agent": -7400000.0}, "episode_duration_sec_mean": 0.004738185249269007, "env_to_module_connector": {"timers": {"connectors": {"add_time_dim_to_batch_and_zero_pad": 2.4206168890080154e-06, "add_observations_from_episodes_to_batch": 3.0750909914423117e-06, "batch_individual_items": 6.571743405547113e-06, "add_states_from_episodes_to_batch": 1.7614036811110692e-06, "numpy_to_tensor": 9.112583780225041e-06}}, "connector_pipeline_timer": 4.514730445569869e-05}, "num_env_steps_sampled_lifetime": -7400000.0, "episode_return_mean": 5.299999999999998, "module_to_env_connector": {"timers": {"connectors": {"tensor_to_numpy": 1.3615371849339481e-05, "normalize_and_clip_actions": 9.851609126851946e-06, "listify_data_for_vector_env": 1.1592382805061623e-05, "remove_single_ts_time_rank_from_batch": 6.088618665092856e-07, "get_actions": 4.018050794228803e-05, "un_batch_to_individual_items": 5.5874633927810995e-06}}, "connector_pipeline_timer": 0.00010773745840238693}, "weights_seq_no": 13.0, "env_to_module_sum_episodes_length_out": 10.36823839457432, "episode_len_min": 20, "num_agent_steps_sampled": {"default_agent": 5000.0}, "env_reset_timer": 4.297283046908714e-05, "rlmodule_inference_timer": 2.926397069628477e-05, "num_env_steps_sampled": 5000.0, "env_to_module_sum_episodes_length_in": 10.36823839457432, "num_module_steps_sampled": {"default_policy": 5000.0}, "episode_len_mean": 20.0, "episode_len_max": 20, "num_episodes": 250.0, "num_episodes_lifetime": -370000.0, "time_between_sampling": 0.0017572514768324768, "episode_return_min": -11.5, "agent_episode_returns_mean": {"default_agent": 5.299999999999998}, "episode_return_max": 8.5, "num_module_steps_sampled_lifetime": {"default_policy": -7400000.0}, "module_episode_returns_mean": {"default_policy": 5.299999999999998}, "sample": 0.005041965496764581, "num_env_steps_sampled_lifetime_throughput": 3571.439034462605}, "learners": {"__all_modules__": {"learner_connector": {"timers": {"connectors": {"add_states_from_episodes_to_batch": 3.5772512117847694e-06, "numpy_to_tensor": 7.912760188216243e-05, "batch_individual_items": 0.03482628541054729, "add_columns_from_episodes_to_train_batch": 0.03448093127524027, "add_time_dim_to_batch_and_zero_pad": 1.2208041106302567e-05, "add_observations_from_episodes_to_batch": 0.000849900353245937, "add_one_ts_to_episodes_and_truncate": 0.008510835713549825, "general_advantage_estimation": 0.006649253494880771}}, "connector_pipeline_timer": 0.08555801697454184}, "num_env_steps_trained": 31500, "learner_connector_sum_episodes_length_out": 5250.0, "num_non_trainable_parameters": 0, "num_module_steps_trained_lifetime": 84000, "learner_connector_sum_episodes_length_in": 5000.0, "num_env_steps_trained_lifetime": 441000, "num_module_steps_trained": 6000, "num_trainable_parameters": 6003, "num_env_steps_trained_lifetime_throughput": 2164235.514963796, "num_module_steps_trained_throughput": 413721.077332571, "num_module_steps_trained_lifetime_throughput": 413127.0564286321}, "default_policy": {"num_module_steps_trained_lifetime": 84000, "gradients_default_optimizer_global_norm": 0.011624989099800587, "total_loss": -0.043898805975914, "weights_seq_no": 14.0, "diff_num_grad_updates_vs_sampler_policy": 1.0, "num_module_steps_trained": 6000, "vf_loss": 0.10278083384037018, "entropy": 0.4444359540939331, "vf_explained_var": 0.001467287540435791, "curr_kl_coeff": 4.5562519517261535e-05, "default_optimizer_learning_rate": 0.0002847858517, "num_trainable_parameters": 6003, "module_train_batch_size_mean": 1000.0, "vf_loss_unclipped": 27.947935104370117, "policy_loss": -0.10861422121524811, "mean_kl_loss": 0.000890470459125936, "curr_entropy_coeff": 0.0090570820258, "num_module_steps_trained_lifetime_throughput": 413983.9457649918}}, "num_training_step_calls_per_iteration": 1, "evaluation": {"env_runners": {"num_episodes": 20, "env_to_module_connector": {"timers": {"connectors": {"add_states_from_episodes_to_batch": 1.6371031262881768e-06, "numpy_to_tensor": 8.976659583965726e-06, "batch_individual_items": 6.287249250979726e-06, "add_time_dim_to_batch_and_zero_pad": 2.289640308072568e-06, "add_observations_from_episodes_to_batch": 2.9104504952901986e-06}}, "connector_pipeline_timer": 4.435790065421389e-05}, "sample": 0.10656781235037903, "module_to_env_connector": {"timers": {"connectors": {"get_actions": 3.857985899452491e-05, "remove_single_ts_time_rank_from_batch": 5.873152192137742e-07, "normalize_and_clip_actions": 9.700560066499141e-06, "un_batch_to_individual_items": 5.577783964957221e-06, "tensor_to_numpy": 1.3507673314090709e-05, "listify_data_for_vector_env": 1.1603358721131811e-05}}, "connector_pipeline_timer": 0.00010588546137304129}, "episode_duration_sec_mean": 0.0046669738052878525, "module_episode_returns_mean": {"default_policy": -0.2}, "num_env_steps_sampled_lifetime": 70400, "episode_len_min": 20, "num_agent_steps_sampled_lifetime": {"default_agent": 5600}, "episode_len_max": 20, "num_episodes_lifetime": 280, "episode_return_min": -14.5, "env_step_timer": 1.4757086143990801e-05, "env_to_module_sum_episodes_length_out": 10.368238394574323, "num_agent_steps_sampled": {"default_agent": 400}, "env_to_module_sum_episodes_length_in": 10.368238394574323, "episode_return_max": 14.5, "agent_episode_returns_mean": {"default_agent": -0.2}, "num_module_steps_sampled_lifetime": {"default_policy": 5600}, "weights_seq_no": 14.0, "env_reset_timer": 0.00021628050750084688, "episode_len_mean": 20.0, "num_module_steps_sampled": {"default_policy": 400}, "episode_return_mean": -0.2, "rlmodule_inference_timer": 2.8253484077884892e-05, "num_env_steps_sampled": 400, "time_between_sampling": 1.609525941199549}, "num_healthy_workers": 1, "actor_manager_num_outstanding_async_reqs": 0, "num_remote_worker_restarts": 0}, "num_env_steps_sampled_lifetime": -7400000.0, "fault_tolerance": {"num_healthy_workers": 0, "num_remote_worker_restarts": 0}, "env_runner_group": {"actor_manager_num_outstanding_async_reqs": 0}, "done": false, "training_iteration": 14, "trial_id": "43bd0_00000", "date": "2025-08-11_19-24-43", "timestamp": 1754933083, "time_this_iter_s": 1.7459840774536133, "time_total_s": 23.696762323379517, "pid": 14505, "hostname": "Mac", "node_ip": "127.0.0.1", "config": {"exploration_config": {}, "extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "placement_strategy": "PACK", "num_gpus": 0, "_fake_gpus": false, "num_cpus_for_main_process": 2, "eager_tracing": true, "eager_max_retraces": 20, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "torch_compile_learner": false, "torch_compile_learner_what_to_compile": "forward_train", "torch_compile_learner_dynamo_backend": "aot_eager", "torch_compile_learner_dynamo_mode": null, "torch_compile_worker": false, "torch_compile_worker_dynamo_backend": "aot_eager", "torch_compile_worker_dynamo_mode": null, "torch_ddp_kwargs": {}, "torch_skip_nan_gradients": false, "env": "Umbrella", "env_config": {}, "observation_space": null, "action_space": null, "clip_rewards": null, "normalize_actions": true, "clip_actions": false, "_is_atari": null, "disable_env_checking": false, "render_env": false, "action_mask_key": "action_mask", "env_runner_cls": null, "num_env_runners": 0, "create_local_env_runner": true, "num_envs_per_env_runner": 1, "gym_env_vectorize_mode": "SYNC", "num_cpus_per_env_runner": 1, "num_gpus_per_env_runner": 0, "custom_resources_per_env_runner": {}, "validate_env_runners_after_construction": true, "episodes_to_numpy": true, "max_requests_in_flight_per_env_runner": 1, "sample_timeout_s": 60.0, "_env_to_module_connector": null, "add_default_connectors_to_env_to_module_pipeline": true, "_module_to_env_connector": null, "add_default_connectors_to_module_to_env_pipeline": true, "merge_env_runner_states": "training_only", "broadcast_env_runner_states": true, "episode_lookback_horizon": 1, "rollout_fragment_length": "auto", "batch_mode": "complete_episodes", "compress_observations": false, "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "enable_tf1_exec_eagerly": false, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "preprocessor_pref": "deepmind", "observation_filter": "NoFilter", "update_worker_filter_stats": true, "use_worker_filter_stats": true, "sampler_perf_stats_ema_coef": null, "_is_online": true, "num_learners": 0, "num_gpus_per_learner": 0, "num_cpus_per_learner": "auto", "num_aggregator_actors_per_learner": 0, "max_requests_in_flight_per_aggregator_actor": 3, "local_gpu_idx": 0, "max_requests_in_flight_per_learner": 3, "gamma": 1, "lr": 0.0002847858517, "grad_clip": 0.5, "grad_clip_by": "global_norm", "_train_batch_size_per_learner": 5000, "train_batch_size": 4000, "num_epochs": 1, "minibatch_size": 1000, "shuffle_batch_per_epoch": true, "model": {"fcnet_hiddens": [256, 256], "fcnet_activation": "tanh", "fcnet_weights_initializer": null, "fcnet_weights_initializer_config": null, "fcnet_bias_initializer": null, "fcnet_bias_initializer_config": null, "conv_filters": null, "conv_activation": "relu", "conv_kernel_initializer": null, "conv_kernel_initializer_config": null, "conv_bias_initializer": null, "conv_bias_initializer_config": null, "conv_transpose_kernel_initializer": null, "conv_transpose_kernel_initializer_config": null, "conv_transpose_bias_initializer": null, "conv_transpose_bias_initializer_config": null, "post_fcnet_hiddens": [], "post_fcnet_activation": "relu", "post_fcnet_weights_initializer": null, "post_fcnet_weights_initializer_config": null, "post_fcnet_bias_initializer": null, "post_fcnet_bias_initializer_config": null, "free_log_std": false, "log_std_clip_param": 20.0, "no_final_linear": false, "vf_share_layers": false, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "lstm_weights_initializer": null, "lstm_weights_initializer_config": null, "lstm_bias_initializer": null, "lstm_bias_initializer_config": null, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "attention_use_n_prev_actions": 0, "attention_use_n_prev_rewards": 0, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": null, "custom_model_config": {}, "custom_action_dist": null, "custom_preprocessor": null, "encoder_latent_dim": null, "always_check_shapes": false, "lstm_use_prev_action_reward": -1, "_use_default_native_models": -1, "_disable_preprocessor_api": false, "_disable_action_flattening": false}, "_learner_connector": null, "add_default_connectors_to_learner_pipeline": true, "learner_config_dict": {}, "optimizer": {}, "_learner_class": null, "callbacks_on_algorithm_init": null, "callbacks_on_env_runners_recreated": null, "callbacks_on_offline_eval_runners_recreated": null, "callbacks_on_checkpoint_loaded": null, "callbacks_on_environment_created": null, "callbacks_on_episode_created": null, "callbacks_on_episode_start": null, "callbacks_on_episode_step": null, "callbacks_on_episode_end": null, "callbacks_on_evaluate_start": null, "callbacks_on_evaluate_end": null, "callbacks_on_evaluate_offline_start": null, "callbacks_on_evaluate_offline_end": null, "callbacks_on_sample_end": null, "callbacks_on_train_result": null, "explore": true, "enable_rl_module_and_learner": true, "enable_env_runner_and_connector_v2": true, "_prior_exploration_config": {"type": "StochasticSampling"}, "count_steps_by": "env_steps", "policy_map_capacity": 100, "policy_mapping_fn": "<function AlgorithmConfig.DEFAULT_POLICY_MAPPING_FN at 0x3855e5b20>", "policies_to_train": null, "policy_states_are_swappable": false, "observation_fn": null, "offline_data_class": null, "input_read_method": "read_parquet", "input_read_method_kwargs": {}, "input_read_schema": {}, "input_read_episodes": false, "input_read_sample_batches": false, "input_read_batch_size": null, "input_filesystem": null, "input_filesystem_kwargs": {}, "input_compress_columns": ["obs", "new_obs"], "input_spaces_jsonable": true, "materialize_data": false, "materialize_mapped_data": true, "map_batches_kwargs": {}, "iter_batches_kwargs": {}, "ignore_final_observation": false, "prelearner_class": null, "prelearner_buffer_class": null, "prelearner_buffer_kwargs": {}, "prelearner_module_synch_period": 10, "dataset_num_iters_per_learner": null, "input_config": {}, "actions_in_input_normalized": false, "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_config": {}, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "output_max_rows_per_file": null, "output_write_remaining_data": false, "output_write_method": "write_parquet", "output_write_method_kwargs": {}, "output_filesystem": null, "output_filesystem_kwargs": {}, "output_write_episodes": true, "offline_sampling": false, "evaluation_interval": 1, "evaluation_duration": 20, "evaluation_duration_unit": "episodes", "evaluation_sample_timeout_s": 120.0, "evaluation_auto_duration_min_env_steps_per_sample": 100, "evaluation_auto_duration_max_env_steps_per_sample": 2000, "evaluation_parallel_to_training": false, "evaluation_force_reset_envs_before_iteration": true, "evaluation_config": null, "off_policy_estimation_methods": {}, "ope_split_batch_by_episode": true, "evaluation_num_env_runners": 1, "in_evaluation": false, "sync_filters_on_rollout_workers_timeout_s": 10.0, "offline_evaluation_interval": null, "num_offline_eval_runners": 0, "offline_loss_for_module_fn": null, "offline_evaluation_duration": 1, "offline_evaluation_parallel_to_training": false, "offline_evaluation_timeout_s": 120.0, "num_cpus_per_offline_eval_runner": 1, "num_gpus_per_offline_eval_runner": 0, "custom_resources_per_offline_eval_runner": {}, "restart_failed_offline_eval_runners": true, "ignore_offline_eval_runner_failures": false, "max_num_offline_eval_runner_restarts": 1000, "offline_eval_runner_restore_timeout_s": 1800.0, "max_requests_in_flight_per_offline_eval_runner": 1, "validate_offline_eval_runners_after_construction": true, "offline_eval_runner_health_probe_timeout_s": 30.0, "offline_eval_rl_module_inference_only": false, "broadcast_offline_eval_runner_states": false, "offline_eval_batch_size_per_runner": 256, "dataset_num_iters_per_eval_runner": 1, "keep_per_episode_custom_metrics": false, "metrics_episode_collection_timeout_s": 60.0, "metrics_num_episodes_for_smoothing": 100, "min_time_s_per_iteration": null, "min_train_timesteps_per_iteration": 0, "min_sample_timesteps_per_iteration": 0, "log_gradients": true, "export_native_model_files": false, "checkpoint_trainable_policies_only": false, "logger_creator": null, "logger_config": null, "log_level": "WARN", "log_sys_usage": true, "fake_sampler": false, "seed": 2, "restart_failed_env_runners": true, "ignore_env_runner_failures": false, "max_num_env_runner_restarts": 1000, "delay_between_env_runner_restarts_s": 60.0, "restart_failed_sub_environments": false, "num_consecutive_env_runner_failures_tolerance": 100, "env_runner_health_probe_timeout_s": 30.0, "env_runner_restore_timeout_s": 1800.0, "_model_config": {}, "_rl_module_spec": "RLModuleSpec(module_class=None, observation_space=None, action_space=None, inference_only=False, learner_only=False, model_config=DefaultModelConfig(fcnet_hiddens=[60, 90], fcnet_activation='tanh', fcnet_kernel_initializer=None, fcnet_kernel_initializer_kwargs=None, fcnet_bias_initializer=None, fcnet_bias_initializer_kwargs=None, conv_filters=None, conv_activation='relu', conv_kernel_initializer=None, conv_kernel_initializer_kwargs=None, conv_bias_initializer=None, conv_bias_initializer_kwargs=None, head_fcnet_hiddens=[], head_fcnet_activation='relu', head_fcnet_kernel_initializer=None, head_fcnet_kernel_initializer_kwargs=None, head_fcnet_bias_initializer=None, head_fcnet_bias_initializer_kwargs=None, free_log_std=False, log_std_clip_param=20.0, vf_share_layers=True, use_lstm=False, max_seq_len=20, lstm_cell_size=256, lstm_use_prev_action=False, lstm_use_prev_reward=False, lstm_kernel_initializer=None, lstm_kernel_initializer_kwargs=None, lstm_bias_initializer=None, lstm_bias_initializer_kwargs=None), catalog_class=None, load_state_path=None, model_config_dict=None)", "algorithm_config_overrides_per_module": {}, "_per_module_overrides": {}, "_validate_config": true, "_use_msgpack_checkpoints": false, "_torch_grad_scaler_class": null, "_torch_lr_scheduler_classes": null, "_tf_policy_handles_more_than_one_loss": false, "_disable_preprocessor_api": false, "_disable_action_flattening": false, "_disable_initialize_loss_from_dummy_batch": false, "_dont_auto_sync_env_runner_states": false, "env_task_fn": -1, "enable_connectors": -1, "simple_optimizer": false, "policy_map_cache": -1, "worker_cls": -1, "synchronize_filters": -1, "enable_async_evaluation": -1, "custom_async_evaluation_function": -1, "_enable_rl_module_api": -1, "auto_wrap_old_gym_envs": -1, "always_attach_evaluation_results": -1, "replay_sequence_length": null, "_disable_execution_plan_api": -1, "use_critic": true, "use_gae": true, "use_kl_loss": true, "kl_coeff": 0.7464963036515, "kl_target": 0.0270990929592, "vf_loss_coeff": 0.6688075857018, "entropy_coeff": 0.0090570820258, "clip_param": 0.1221781641624, "vf_clip_param": 0.1027808522125, "entropy_coeff_schedule": null, "lr_schedule": null, "sgd_minibatch_size": -1, "vf_share_layers": -1, "__stdout_file__": null, "__stderr_file__": null, "lambda": 0.9099046732075, "input": "sampler", "policies": {"default_policy": [null, null, null, null]}, "callbacks": "<class 'ray.rllib.callbacks.callbacks.RLlibCallback'>", "create_env_on_driver": false, "custom_eval_function": null, "framework": "torch"}, "time_since_restore": 23.696762323379517, "iterations_since_restore": 14, "perf": {"cpu_util_percent": 42.849999999999994, "ram_util_percent": 77.3}}
{"timers": {"training_iteration": 1.6075749425991581, "restore_env_runners": 1.207288921529319e-05, "training_step": 1.6074349524826164, "env_runner_sampling_timer": 1.4929256012457144, "learner_update_timer": 0.11140902290304823, "synch_weights": 0.00059120148563104, "restore_eval_env_runners": 9.392141269060839e-06, "evaluation_iteration": 0.11331495718615797, "synch_eval_env_connectors": 0.00013677881528032215, "synch_env_connectors": 4.388738317951859e-06}, "env_runners": {"env_step_timer": 1.4750060917989141e-05, "num_agent_steps_sampled_lifetime": {"default_agent": -8017500.0}, "episode_duration_sec_mean": 0.004826816171407698, "env_to_module_connector": {"timers": {"connectors": {"add_time_dim_to_batch_and_zero_pad": 2.4734374106939502e-06, "add_observations_from_episodes_to_batch": 3.1539781041881374e-06, "batch_individual_items": 6.681659585787845e-06, "add_states_from_episodes_to_batch": 1.7798630783976885e-06, "numpy_to_tensor": 9.272534801725654e-06}}, "connector_pipeline_timer": 4.584166988437857e-05}, "num_env_steps_sampled_lifetime": -8017500.0, "episode_return_mean": 6.74, "module_to_env_connector": {"timers": {"connectors": {"tensor_to_numpy": 1.3772993797653812e-05, "normalize_and_clip_actions": 1.0005263134650933e-05, "listify_data_for_vector_env": 1.1674999410751612e-05, "remove_single_ts_time_rank_from_batch": 6.296030743315949e-07, "get_actions": 4.1278721551145446e-05, "un_batch_to_individual_items": 5.704995416001071e-06}}, "connector_pipeline_timer": 0.00010982571877947783}, "weights_seq_no": 14.0, "env_to_module_sum_episodes_length_out": 10.36823839457432, "episode_len_min": 20, "num_agent_steps_sampled": {"default_agent": 5000.0}, "env_reset_timer": 4.269730567706152e-05, "rlmodule_inference_timer": 2.9421655816261176e-05, "num_env_steps_sampled": 5000.0, "env_to_module_sum_episodes_length_in": 10.36823839457432, "num_module_steps_sampled": {"default_policy": 5000.0}, "episode_len_mean": 20.0, "episode_len_max": 20, "num_episodes": 250.0, "num_episodes_lifetime": -400875.0, "time_between_sampling": 0.0019233671716561288, "episode_return_min": -11.5, "agent_episode_returns_mean": {"default_agent": 6.74}, "episode_return_max": 8.5, "num_module_steps_sampled_lifetime": {"default_policy": -8017500.0}, "module_episode_returns_mean": {"default_policy": 6.74}, "sample": 0.005058333674382181, "num_env_steps_sampled_lifetime_throughput": 3543.609705229371}, "learners": {"__all_modules__": {"learner_connector": {"timers": {"connectors": {"add_states_from_episodes_to_batch": 3.583978441206281e-06, "numpy_to_tensor": 7.94075761623326e-05, "batch_individual_items": 0.03609389005710089, "add_columns_from_episodes_to_train_batch": 0.03460126821327785, "add_time_dim_to_batch_and_zero_pad": 1.2478049827459094e-05, "add_observations_from_episodes_to_batch": 0.0008544784294976026, "add_one_ts_to_episodes_and_truncate": 0.008609917776382543, "general_advantage_estimation": 0.006648401790366821}}, "connector_pipeline_timer": 0.08705008389500607}, "num_env_steps_trained": 31500, "learner_connector_sum_episodes_length_out": 5250.0, "num_non_trainable_parameters": 0, "num_module_steps_trained_lifetime": 90000, "learner_connector_sum_episodes_length_in": 5000.0, "num_env_steps_trained_lifetime": 472500, "num_module_steps_trained": 6000, "num_trainable_parameters": 6003, "num_env_steps_trained_lifetime_throughput": 2156175.076829584, "num_module_steps_trained_throughput": 412126.1625050166, "num_module_steps_trained_lifetime_throughput": 411551.9222666161}, "default_policy": {"num_module_steps_trained_lifetime": 90000, "gradients_default_optimizer_global_norm": 0.04951922968029976, "total_loss": 0.06253442168235779, "weights_seq_no": 15.0, "diff_num_grad_updates_vs_sampler_policy": 1.0, "num_module_steps_trained": 6000, "vf_loss": 0.10278083384037018, "entropy": 0.4242554008960724, "vf_explained_var": 0.004027366638183594, "curr_kl_coeff": 2.2781259758630767e-05, "default_optimizer_learning_rate": 0.0002847858517, "num_trainable_parameters": 6003, "module_train_batch_size_mean": 1000.0, "vf_loss_unclipped": 27.907155990600586, "policy_loss": -0.0023636831901967525, "mean_kl_loss": 0.00040324131259694695, "curr_entropy_coeff": 0.0090570820258, "num_module_steps_trained_lifetime_throughput": 412340.44060678023}}, "num_training_step_calls_per_iteration": 1, "evaluation": {"env_runners": {"num_episodes": 20, "env_to_module_connector": {"timers": {"connectors": {"add_states_from_episodes_to_batch": 1.7647782826766925e-06, "numpy_to_tensor": 9.439936613864197e-06, "batch_individual_items": 7.385399582077664e-06, "add_time_dim_to_batch_and_zero_pad": 2.5986178502093706e-06, "add_observations_from_episodes_to_batch": 3.3670425760493083e-06}}, "connector_pipeline_timer": 4.881434607746879e-05}, "sample": 0.10664685630650059, "module_to_env_connector": {"timers": {"connectors": {"get_actions": 4.329108868926393e-05, "remove_single_ts_time_rank_from_batch": 6.232842792578926e-07, "normalize_and_clip_actions": 1.086034841912362e-05, "un_batch_to_individual_items": 6.137923196766535e-06, "tensor_to_numpy": 1.5346390430818323e-05, "listify_data_for_vector_env": 1.2378887193670963e-05}}, "connector_pipeline_timer": 0.00011699288637658092}, "episode_duration_sec_mean": 0.004795081313932315, "module_episode_returns_mean": {"default_policy": -0.6}, "num_env_steps_sampled_lifetime": 75400, "episode_len_min": 20, "num_agent_steps_sampled_lifetime": {"default_agent": 6000}, "episode_len_max": 20, "num_episodes_lifetime": 300, "episode_return_min": -14.5, "env_step_timer": 1.6175244575462466e-05, "env_to_module_sum_episodes_length_out": 10.368238394574323, "num_agent_steps_sampled": {"default_agent": 400}, "env_to_module_sum_episodes_length_in": 10.368238394574323, "episode_return_max": 12.5, "agent_episode_returns_mean": {"default_agent": -0.6}, "num_module_steps_sampled_lifetime": {"default_policy": 6000}, "weights_seq_no": 15.0, "env_reset_timer": 0.0002153314520636657, "episode_len_mean": 20.0, "num_module_steps_sampled": {"default_policy": 400}, "episode_return_mean": -0.6, "rlmodule_inference_timer": 3.1948108765088115e-05, "num_env_steps_sampled": 400, "time_between_sampling": 1.6110661267874589}, "num_healthy_workers": 1, "actor_manager_num_outstanding_async_reqs": 0, "num_remote_worker_restarts": 0}, "num_env_steps_sampled_lifetime": -8017500.0, "fault_tolerance": {"num_healthy_workers": 0, "num_remote_worker_restarts": 0}, "env_runner_group": {"actor_manager_num_outstanding_async_reqs": 0}, "done": false, "training_iteration": 15, "trial_id": "43bd0_00000", "date": "2025-08-11_19-24-44", "timestamp": 1754933084, "time_this_iter_s": 1.8692660331726074, "time_total_s": 25.566028356552124, "pid": 14505, "hostname": "Mac", "node_ip": "127.0.0.1", "config": {"exploration_config": {}, "extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "placement_strategy": "PACK", "num_gpus": 0, "_fake_gpus": false, "num_cpus_for_main_process": 2, "eager_tracing": true, "eager_max_retraces": 20, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "torch_compile_learner": false, "torch_compile_learner_what_to_compile": "forward_train", "torch_compile_learner_dynamo_backend": "aot_eager", "torch_compile_learner_dynamo_mode": null, "torch_compile_worker": false, "torch_compile_worker_dynamo_backend": "aot_eager", "torch_compile_worker_dynamo_mode": null, "torch_ddp_kwargs": {}, "torch_skip_nan_gradients": false, "env": "Umbrella", "env_config": {}, "observation_space": null, "action_space": null, "clip_rewards": null, "normalize_actions": true, "clip_actions": false, "_is_atari": null, "disable_env_checking": false, "render_env": false, "action_mask_key": "action_mask", "env_runner_cls": null, "num_env_runners": 0, "create_local_env_runner": true, "num_envs_per_env_runner": 1, "gym_env_vectorize_mode": "SYNC", "num_cpus_per_env_runner": 1, "num_gpus_per_env_runner": 0, "custom_resources_per_env_runner": {}, "validate_env_runners_after_construction": true, "episodes_to_numpy": true, "max_requests_in_flight_per_env_runner": 1, "sample_timeout_s": 60.0, "_env_to_module_connector": null, "add_default_connectors_to_env_to_module_pipeline": true, "_module_to_env_connector": null, "add_default_connectors_to_module_to_env_pipeline": true, "merge_env_runner_states": "training_only", "broadcast_env_runner_states": true, "episode_lookback_horizon": 1, "rollout_fragment_length": "auto", "batch_mode": "complete_episodes", "compress_observations": false, "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "enable_tf1_exec_eagerly": false, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "preprocessor_pref": "deepmind", "observation_filter": "NoFilter", "update_worker_filter_stats": true, "use_worker_filter_stats": true, "sampler_perf_stats_ema_coef": null, "_is_online": true, "num_learners": 0, "num_gpus_per_learner": 0, "num_cpus_per_learner": "auto", "num_aggregator_actors_per_learner": 0, "max_requests_in_flight_per_aggregator_actor": 3, "local_gpu_idx": 0, "max_requests_in_flight_per_learner": 3, "gamma": 1, "lr": 0.0002847858517, "grad_clip": 0.5, "grad_clip_by": "global_norm", "_train_batch_size_per_learner": 5000, "train_batch_size": 4000, "num_epochs": 1, "minibatch_size": 1000, "shuffle_batch_per_epoch": true, "model": {"fcnet_hiddens": [256, 256], "fcnet_activation": "tanh", "fcnet_weights_initializer": null, "fcnet_weights_initializer_config": null, "fcnet_bias_initializer": null, "fcnet_bias_initializer_config": null, "conv_filters": null, "conv_activation": "relu", "conv_kernel_initializer": null, "conv_kernel_initializer_config": null, "conv_bias_initializer": null, "conv_bias_initializer_config": null, "conv_transpose_kernel_initializer": null, "conv_transpose_kernel_initializer_config": null, "conv_transpose_bias_initializer": null, "conv_transpose_bias_initializer_config": null, "post_fcnet_hiddens": [], "post_fcnet_activation": "relu", "post_fcnet_weights_initializer": null, "post_fcnet_weights_initializer_config": null, "post_fcnet_bias_initializer": null, "post_fcnet_bias_initializer_config": null, "free_log_std": false, "log_std_clip_param": 20.0, "no_final_linear": false, "vf_share_layers": false, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "lstm_weights_initializer": null, "lstm_weights_initializer_config": null, "lstm_bias_initializer": null, "lstm_bias_initializer_config": null, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "attention_use_n_prev_actions": 0, "attention_use_n_prev_rewards": 0, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": null, "custom_model_config": {}, "custom_action_dist": null, "custom_preprocessor": null, "encoder_latent_dim": null, "always_check_shapes": false, "lstm_use_prev_action_reward": -1, "_use_default_native_models": -1, "_disable_preprocessor_api": false, "_disable_action_flattening": false}, "_learner_connector": null, "add_default_connectors_to_learner_pipeline": true, "learner_config_dict": {}, "optimizer": {}, "_learner_class": null, "callbacks_on_algorithm_init": null, "callbacks_on_env_runners_recreated": null, "callbacks_on_offline_eval_runners_recreated": null, "callbacks_on_checkpoint_loaded": null, "callbacks_on_environment_created": null, "callbacks_on_episode_created": null, "callbacks_on_episode_start": null, "callbacks_on_episode_step": null, "callbacks_on_episode_end": null, "callbacks_on_evaluate_start": null, "callbacks_on_evaluate_end": null, "callbacks_on_evaluate_offline_start": null, "callbacks_on_evaluate_offline_end": null, "callbacks_on_sample_end": null, "callbacks_on_train_result": null, "explore": true, "enable_rl_module_and_learner": true, "enable_env_runner_and_connector_v2": true, "_prior_exploration_config": {"type": "StochasticSampling"}, "count_steps_by": "env_steps", "policy_map_capacity": 100, "policy_mapping_fn": "<function AlgorithmConfig.DEFAULT_POLICY_MAPPING_FN at 0x3855e5b20>", "policies_to_train": null, "policy_states_are_swappable": false, "observation_fn": null, "offline_data_class": null, "input_read_method": "read_parquet", "input_read_method_kwargs": {}, "input_read_schema": {}, "input_read_episodes": false, "input_read_sample_batches": false, "input_read_batch_size": null, "input_filesystem": null, "input_filesystem_kwargs": {}, "input_compress_columns": ["obs", "new_obs"], "input_spaces_jsonable": true, "materialize_data": false, "materialize_mapped_data": true, "map_batches_kwargs": {}, "iter_batches_kwargs": {}, "ignore_final_observation": false, "prelearner_class": null, "prelearner_buffer_class": null, "prelearner_buffer_kwargs": {}, "prelearner_module_synch_period": 10, "dataset_num_iters_per_learner": null, "input_config": {}, "actions_in_input_normalized": false, "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_config": {}, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "output_max_rows_per_file": null, "output_write_remaining_data": false, "output_write_method": "write_parquet", "output_write_method_kwargs": {}, "output_filesystem": null, "output_filesystem_kwargs": {}, "output_write_episodes": true, "offline_sampling": false, "evaluation_interval": 1, "evaluation_duration": 20, "evaluation_duration_unit": "episodes", "evaluation_sample_timeout_s": 120.0, "evaluation_auto_duration_min_env_steps_per_sample": 100, "evaluation_auto_duration_max_env_steps_per_sample": 2000, "evaluation_parallel_to_training": false, "evaluation_force_reset_envs_before_iteration": true, "evaluation_config": null, "off_policy_estimation_methods": {}, "ope_split_batch_by_episode": true, "evaluation_num_env_runners": 1, "in_evaluation": false, "sync_filters_on_rollout_workers_timeout_s": 10.0, "offline_evaluation_interval": null, "num_offline_eval_runners": 0, "offline_loss_for_module_fn": null, "offline_evaluation_duration": 1, "offline_evaluation_parallel_to_training": false, "offline_evaluation_timeout_s": 120.0, "num_cpus_per_offline_eval_runner": 1, "num_gpus_per_offline_eval_runner": 0, "custom_resources_per_offline_eval_runner": {}, "restart_failed_offline_eval_runners": true, "ignore_offline_eval_runner_failures": false, "max_num_offline_eval_runner_restarts": 1000, "offline_eval_runner_restore_timeout_s": 1800.0, "max_requests_in_flight_per_offline_eval_runner": 1, "validate_offline_eval_runners_after_construction": true, "offline_eval_runner_health_probe_timeout_s": 30.0, "offline_eval_rl_module_inference_only": false, "broadcast_offline_eval_runner_states": false, "offline_eval_batch_size_per_runner": 256, "dataset_num_iters_per_eval_runner": 1, "keep_per_episode_custom_metrics": false, "metrics_episode_collection_timeout_s": 60.0, "metrics_num_episodes_for_smoothing": 100, "min_time_s_per_iteration": null, "min_train_timesteps_per_iteration": 0, "min_sample_timesteps_per_iteration": 0, "log_gradients": true, "export_native_model_files": false, "checkpoint_trainable_policies_only": false, "logger_creator": null, "logger_config": null, "log_level": "WARN", "log_sys_usage": true, "fake_sampler": false, "seed": 2, "restart_failed_env_runners": true, "ignore_env_runner_failures": false, "max_num_env_runner_restarts": 1000, "delay_between_env_runner_restarts_s": 60.0, "restart_failed_sub_environments": false, "num_consecutive_env_runner_failures_tolerance": 100, "env_runner_health_probe_timeout_s": 30.0, "env_runner_restore_timeout_s": 1800.0, "_model_config": {}, "_rl_module_spec": "RLModuleSpec(module_class=None, observation_space=None, action_space=None, inference_only=False, learner_only=False, model_config=DefaultModelConfig(fcnet_hiddens=[60, 90], fcnet_activation='tanh', fcnet_kernel_initializer=None, fcnet_kernel_initializer_kwargs=None, fcnet_bias_initializer=None, fcnet_bias_initializer_kwargs=None, conv_filters=None, conv_activation='relu', conv_kernel_initializer=None, conv_kernel_initializer_kwargs=None, conv_bias_initializer=None, conv_bias_initializer_kwargs=None, head_fcnet_hiddens=[], head_fcnet_activation='relu', head_fcnet_kernel_initializer=None, head_fcnet_kernel_initializer_kwargs=None, head_fcnet_bias_initializer=None, head_fcnet_bias_initializer_kwargs=None, free_log_std=False, log_std_clip_param=20.0, vf_share_layers=True, use_lstm=False, max_seq_len=20, lstm_cell_size=256, lstm_use_prev_action=False, lstm_use_prev_reward=False, lstm_kernel_initializer=None, lstm_kernel_initializer_kwargs=None, lstm_bias_initializer=None, lstm_bias_initializer_kwargs=None), catalog_class=None, load_state_path=None, model_config_dict=None)", "algorithm_config_overrides_per_module": {}, "_per_module_overrides": {}, "_validate_config": true, "_use_msgpack_checkpoints": false, "_torch_grad_scaler_class": null, "_torch_lr_scheduler_classes": null, "_tf_policy_handles_more_than_one_loss": false, "_disable_preprocessor_api": false, "_disable_action_flattening": false, "_disable_initialize_loss_from_dummy_batch": false, "_dont_auto_sync_env_runner_states": false, "env_task_fn": -1, "enable_connectors": -1, "simple_optimizer": false, "policy_map_cache": -1, "worker_cls": -1, "synchronize_filters": -1, "enable_async_evaluation": -1, "custom_async_evaluation_function": -1, "_enable_rl_module_api": -1, "auto_wrap_old_gym_envs": -1, "always_attach_evaluation_results": -1, "replay_sequence_length": null, "_disable_execution_plan_api": -1, "use_critic": true, "use_gae": true, "use_kl_loss": true, "kl_coeff": 0.7464963036515, "kl_target": 0.0270990929592, "vf_loss_coeff": 0.6688075857018, "entropy_coeff": 0.0090570820258, "clip_param": 0.1221781641624, "vf_clip_param": 0.1027808522125, "entropy_coeff_schedule": null, "lr_schedule": null, "sgd_minibatch_size": -1, "vf_share_layers": -1, "__stdout_file__": null, "__stderr_file__": null, "lambda": 0.9099046732075, "input": "sampler", "policies": {"default_policy": [null, null, null, null]}, "callbacks": "<class 'ray.rllib.callbacks.callbacks.RLlibCallback'>", "create_env_on_driver": false, "custom_eval_function": null, "framework": "torch"}, "time_since_restore": 25.566028356552124, "iterations_since_restore": 15, "perf": {"cpu_util_percent": 45.86666666666667, "ram_util_percent": 78.23333333333333}}
{"timers": {"training_iteration": 1.6111308373427338, "restore_env_runners": 1.2017160818082328e-05, "training_step": 1.6109900000380701, "env_runner_sampling_timer": 1.4965693769032054, "learner_update_timer": 0.11131198558477406, "synch_weights": 0.0005940253009718404, "restore_eval_env_runners": 9.371140085656187e-06, "evaluation_iteration": 0.11338843053429545, "synch_eval_env_connectors": 0.00013722977787965503, "synch_env_connectors": 4.386101539908496e-06}, "env_runners": {"env_step_timer": 1.9315255611905103e-05, "num_agent_steps_sampled_lifetime": {"default_agent": -8635000.0}, "episode_duration_sec_mean": 0.0061379422917962065, "env_to_module_connector": {"timers": {"connectors": {"add_time_dim_to_batch_and_zero_pad": 2.9379388489878447e-06, "add_observations_from_episodes_to_batch": 3.6255645314263937e-06, "batch_individual_items": 8.960736571428869e-06, "add_states_from_episodes_to_batch": 2.116646444625958e-06, "numpy_to_tensor": 1.1733377628229316e-05}}, "connector_pipeline_timer": 5.480621752330703e-05}, "num_env_steps_sampled_lifetime": -8635000.0, "episode_return_mean": 7.059999999999999, "module_to_env_connector": {"timers": {"connectors": {"tensor_to_numpy": 1.84091675756054e-05, "normalize_and_clip_actions": 1.3450491757833078e-05, "listify_data_for_vector_env": 1.4163301981486302e-05, "remove_single_ts_time_rank_from_batch": 7.134728717301199e-07, "get_actions": 5.378279857349514e-05, "un_batch_to_individual_items": 6.711053931325743e-06}}, "connector_pipeline_timer": 0.00014003551452153516}, "weights_seq_no": 15.0, "env_to_module_sum_episodes_length_out": 10.36823839457432, "episode_len_min": 20, "num_agent_steps_sampled": {"default_agent": 5000.0}, "env_reset_timer": 5.669840719925986e-05, "rlmodule_inference_timer": 4.109961747769558e-05, "num_env_steps_sampled": 5000.0, "env_to_module_sum_episodes_length_in": 10.36823839457432, "num_module_steps_sampled": {"default_policy": 5000.0}, "episode_len_mean": 20.0, "episode_len_max": 20, "num_episodes": 250.0, "num_episodes_lifetime": -431750.0, "time_between_sampling": 0.0024192396191488664, "episode_return_min": -11.5, "agent_episode_returns_mean": {"default_agent": 7.059999999999999}, "episode_return_max": 8.5, "num_module_steps_sampled_lifetime": {"default_policy": -8635000.0}, "module_episode_returns_mean": {"default_policy": 7.059999999999999}, "sample": 0.006298057697746673, "num_env_steps_sampled_lifetime_throughput": 3091.0548196127975}, "learners": {"__all_modules__": {"learner_connector": {"timers": {"connectors": {"add_states_from_episodes_to_batch": 3.578138885229019e-06, "numpy_to_tensor": 7.93772501044742e-05, "batch_individual_items": 0.03606082656580517, "add_columns_from_episodes_to_train_batch": 0.034617909280907175, "add_time_dim_to_batch_and_zero_pad": 1.2449519188964575e-05, "add_observations_from_episodes_to_batch": 0.0008554194741256881, "add_one_ts_to_episodes_and_truncate": 0.00860775109801999, "general_advantage_estimation": 0.006641637772016789}}, "connector_pipeline_timer": 0.08702571555592034}, "num_env_steps_trained": 31500, "learner_connector_sum_episodes_length_out": 5250.0, "num_non_trainable_parameters": 0, "num_module_steps_trained_lifetime": 96000, "learner_connector_sum_episodes_length_in": 5000.0, "num_env_steps_trained_lifetime": 504000, "num_module_steps_trained": 6000, "num_trainable_parameters": 6003, "num_env_steps_trained_lifetime_throughput": 2146053.0169312693, "num_module_steps_trained_throughput": 410132.1753222393, "num_module_steps_trained_lifetime_throughput": 409578.9485100582}, "default_policy": {"num_module_steps_trained_lifetime": 96000, "gradients_default_optimizer_global_norm": 0.09217683970928192, "total_loss": -0.009013228118419647, "weights_seq_no": 16.0, "diff_num_grad_updates_vs_sampler_policy": 1.0, "num_module_steps_trained": 6000, "vf_loss": 0.10278083384037018, "entropy": 0.4163439869880676, "vf_explained_var": 0.010698795318603516, "curr_kl_coeff": 1.1390629879315384e-05, "default_optimizer_learning_rate": 0.0002847858517, "num_trainable_parameters": 6003, "module_train_batch_size_mean": 1000.0, "vf_loss_unclipped": 27.8068904876709, "policy_loss": -0.07398297637701035, "mean_kl_loss": 6.271064921747893e-05, "curr_entropy_coeff": 0.0090570820258, "num_module_steps_trained_lifetime_throughput": 410302.4742784095}}, "num_training_step_calls_per_iteration": 1, "evaluation": {"env_runners": {"num_episodes": 20, "env_to_module_connector": {"timers": {"connectors": {"add_states_from_episodes_to_batch": 1.8715300536096264e-06, "numpy_to_tensor": 9.910132276342323e-06, "batch_individual_items": 7.649588459642066e-06, "add_time_dim_to_batch_and_zero_pad": 2.476967454336141e-06, "add_observations_from_episodes_to_batch": 3.1807859061823514e-06}}, "connector_pipeline_timer": 4.8499235243316395e-05}, "sample": 0.10675579066319742, "module_to_env_connector": {"timers": {"connectors": {"get_actions": 4.771468372750766e-05, "remove_single_ts_time_rank_from_batch": 6.333436609934191e-07, "normalize_and_clip_actions": 1.089137486680611e-05, "un_batch_to_individual_items": 6.058594262038939e-06, "tensor_to_numpy": 1.5825801571424736e-05, "listify_data_for_vector_env": 1.3642774555699248e-05}}, "connector_pipeline_timer": 0.00012401370269505004}, "episode_duration_sec_mean": 0.004945299188839272, "module_episode_returns_mean": {"default_policy": -0.4}, "num_env_steps_sampled_lifetime": 80400, "episode_len_min": 20, "num_agent_steps_sampled_lifetime": {"default_agent": 6400}, "episode_len_max": 20, "num_episodes_lifetime": 320, "episode_return_min": -14.5, "env_step_timer": 1.7438821954969035e-05, "env_to_module_sum_episodes_length_out": 10.368238394574323, "num_agent_steps_sampled": {"default_agent": 400}, "env_to_module_sum_episodes_length_in": 10.368238394574323, "episode_return_max": 12.5, "agent_episode_returns_mean": {"default_agent": -0.4}, "num_module_steps_sampled_lifetime": {"default_policy": 6400}, "weights_seq_no": 16.0, "env_reset_timer": 0.00021428980724175914, "episode_len_mean": 20.0, "num_module_steps_sampled": {"default_policy": 400}, "episode_return_mean": -0.4, "rlmodule_inference_timer": 3.3153090812230734e-05, "num_env_steps_sampled": 400, "time_between_sampling": 1.614800404270196}, "num_healthy_workers": 1, "actor_manager_num_outstanding_async_reqs": 0, "num_remote_worker_restarts": 0}, "num_env_steps_sampled_lifetime": -8635000.0, "fault_tolerance": {"num_healthy_workers": 0, "num_remote_worker_restarts": 0}, "env_runner_group": {"actor_manager_num_outstanding_async_reqs": 0}, "done": false, "training_iteration": 16, "trial_id": "43bd0_00000", "date": "2025-08-11_19-24-47", "timestamp": 1754933087, "time_this_iter_s": 2.089383840560913, "time_total_s": 27.655412197113037, "pid": 14505, "hostname": "Mac", "node_ip": "127.0.0.1", "config": {"exploration_config": {}, "extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "placement_strategy": "PACK", "num_gpus": 0, "_fake_gpus": false, "num_cpus_for_main_process": 2, "eager_tracing": true, "eager_max_retraces": 20, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "torch_compile_learner": false, "torch_compile_learner_what_to_compile": "forward_train", "torch_compile_learner_dynamo_backend": "aot_eager", "torch_compile_learner_dynamo_mode": null, "torch_compile_worker": false, "torch_compile_worker_dynamo_backend": "aot_eager", "torch_compile_worker_dynamo_mode": null, "torch_ddp_kwargs": {}, "torch_skip_nan_gradients": false, "env": "Umbrella", "env_config": {}, "observation_space": null, "action_space": null, "clip_rewards": null, "normalize_actions": true, "clip_actions": false, "_is_atari": null, "disable_env_checking": false, "render_env": false, "action_mask_key": "action_mask", "env_runner_cls": null, "num_env_runners": 0, "create_local_env_runner": true, "num_envs_per_env_runner": 1, "gym_env_vectorize_mode": "SYNC", "num_cpus_per_env_runner": 1, "num_gpus_per_env_runner": 0, "custom_resources_per_env_runner": {}, "validate_env_runners_after_construction": true, "episodes_to_numpy": true, "max_requests_in_flight_per_env_runner": 1, "sample_timeout_s": 60.0, "_env_to_module_connector": null, "add_default_connectors_to_env_to_module_pipeline": true, "_module_to_env_connector": null, "add_default_connectors_to_module_to_env_pipeline": true, "merge_env_runner_states": "training_only", "broadcast_env_runner_states": true, "episode_lookback_horizon": 1, "rollout_fragment_length": "auto", "batch_mode": "complete_episodes", "compress_observations": false, "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "enable_tf1_exec_eagerly": false, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "preprocessor_pref": "deepmind", "observation_filter": "NoFilter", "update_worker_filter_stats": true, "use_worker_filter_stats": true, "sampler_perf_stats_ema_coef": null, "_is_online": true, "num_learners": 0, "num_gpus_per_learner": 0, "num_cpus_per_learner": "auto", "num_aggregator_actors_per_learner": 0, "max_requests_in_flight_per_aggregator_actor": 3, "local_gpu_idx": 0, "max_requests_in_flight_per_learner": 3, "gamma": 1, "lr": 0.0002847858517, "grad_clip": 0.5, "grad_clip_by": "global_norm", "_train_batch_size_per_learner": 5000, "train_batch_size": 4000, "num_epochs": 1, "minibatch_size": 1000, "shuffle_batch_per_epoch": true, "model": {"fcnet_hiddens": [256, 256], "fcnet_activation": "tanh", "fcnet_weights_initializer": null, "fcnet_weights_initializer_config": null, "fcnet_bias_initializer": null, "fcnet_bias_initializer_config": null, "conv_filters": null, "conv_activation": "relu", "conv_kernel_initializer": null, "conv_kernel_initializer_config": null, "conv_bias_initializer": null, "conv_bias_initializer_config": null, "conv_transpose_kernel_initializer": null, "conv_transpose_kernel_initializer_config": null, "conv_transpose_bias_initializer": null, "conv_transpose_bias_initializer_config": null, "post_fcnet_hiddens": [], "post_fcnet_activation": "relu", "post_fcnet_weights_initializer": null, "post_fcnet_weights_initializer_config": null, "post_fcnet_bias_initializer": null, "post_fcnet_bias_initializer_config": null, "free_log_std": false, "log_std_clip_param": 20.0, "no_final_linear": false, "vf_share_layers": false, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "lstm_weights_initializer": null, "lstm_weights_initializer_config": null, "lstm_bias_initializer": null, "lstm_bias_initializer_config": null, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "attention_use_n_prev_actions": 0, "attention_use_n_prev_rewards": 0, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": null, "custom_model_config": {}, "custom_action_dist": null, "custom_preprocessor": null, "encoder_latent_dim": null, "always_check_shapes": false, "lstm_use_prev_action_reward": -1, "_use_default_native_models": -1, "_disable_preprocessor_api": false, "_disable_action_flattening": false}, "_learner_connector": null, "add_default_connectors_to_learner_pipeline": true, "learner_config_dict": {}, "optimizer": {}, "_learner_class": null, "callbacks_on_algorithm_init": null, "callbacks_on_env_runners_recreated": null, "callbacks_on_offline_eval_runners_recreated": null, "callbacks_on_checkpoint_loaded": null, "callbacks_on_environment_created": null, "callbacks_on_episode_created": null, "callbacks_on_episode_start": null, "callbacks_on_episode_step": null, "callbacks_on_episode_end": null, "callbacks_on_evaluate_start": null, "callbacks_on_evaluate_end": null, "callbacks_on_evaluate_offline_start": null, "callbacks_on_evaluate_offline_end": null, "callbacks_on_sample_end": null, "callbacks_on_train_result": null, "explore": true, "enable_rl_module_and_learner": true, "enable_env_runner_and_connector_v2": true, "_prior_exploration_config": {"type": "StochasticSampling"}, "count_steps_by": "env_steps", "policy_map_capacity": 100, "policy_mapping_fn": "<function AlgorithmConfig.DEFAULT_POLICY_MAPPING_FN at 0x3855e5b20>", "policies_to_train": null, "policy_states_are_swappable": false, "observation_fn": null, "offline_data_class": null, "input_read_method": "read_parquet", "input_read_method_kwargs": {}, "input_read_schema": {}, "input_read_episodes": false, "input_read_sample_batches": false, "input_read_batch_size": null, "input_filesystem": null, "input_filesystem_kwargs": {}, "input_compress_columns": ["obs", "new_obs"], "input_spaces_jsonable": true, "materialize_data": false, "materialize_mapped_data": true, "map_batches_kwargs": {}, "iter_batches_kwargs": {}, "ignore_final_observation": false, "prelearner_class": null, "prelearner_buffer_class": null, "prelearner_buffer_kwargs": {}, "prelearner_module_synch_period": 10, "dataset_num_iters_per_learner": null, "input_config": {}, "actions_in_input_normalized": false, "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_config": {}, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "output_max_rows_per_file": null, "output_write_remaining_data": false, "output_write_method": "write_parquet", "output_write_method_kwargs": {}, "output_filesystem": null, "output_filesystem_kwargs": {}, "output_write_episodes": true, "offline_sampling": false, "evaluation_interval": 1, "evaluation_duration": 20, "evaluation_duration_unit": "episodes", "evaluation_sample_timeout_s": 120.0, "evaluation_auto_duration_min_env_steps_per_sample": 100, "evaluation_auto_duration_max_env_steps_per_sample": 2000, "evaluation_parallel_to_training": false, "evaluation_force_reset_envs_before_iteration": true, "evaluation_config": null, "off_policy_estimation_methods": {}, "ope_split_batch_by_episode": true, "evaluation_num_env_runners": 1, "in_evaluation": false, "sync_filters_on_rollout_workers_timeout_s": 10.0, "offline_evaluation_interval": null, "num_offline_eval_runners": 0, "offline_loss_for_module_fn": null, "offline_evaluation_duration": 1, "offline_evaluation_parallel_to_training": false, "offline_evaluation_timeout_s": 120.0, "num_cpus_per_offline_eval_runner": 1, "num_gpus_per_offline_eval_runner": 0, "custom_resources_per_offline_eval_runner": {}, "restart_failed_offline_eval_runners": true, "ignore_offline_eval_runner_failures": false, "max_num_offline_eval_runner_restarts": 1000, "offline_eval_runner_restore_timeout_s": 1800.0, "max_requests_in_flight_per_offline_eval_runner": 1, "validate_offline_eval_runners_after_construction": true, "offline_eval_runner_health_probe_timeout_s": 30.0, "offline_eval_rl_module_inference_only": false, "broadcast_offline_eval_runner_states": false, "offline_eval_batch_size_per_runner": 256, "dataset_num_iters_per_eval_runner": 1, "keep_per_episode_custom_metrics": false, "metrics_episode_collection_timeout_s": 60.0, "metrics_num_episodes_for_smoothing": 100, "min_time_s_per_iteration": null, "min_train_timesteps_per_iteration": 0, "min_sample_timesteps_per_iteration": 0, "log_gradients": true, "export_native_model_files": false, "checkpoint_trainable_policies_only": false, "logger_creator": null, "logger_config": null, "log_level": "WARN", "log_sys_usage": true, "fake_sampler": false, "seed": 2, "restart_failed_env_runners": true, "ignore_env_runner_failures": false, "max_num_env_runner_restarts": 1000, "delay_between_env_runner_restarts_s": 60.0, "restart_failed_sub_environments": false, "num_consecutive_env_runner_failures_tolerance": 100, "env_runner_health_probe_timeout_s": 30.0, "env_runner_restore_timeout_s": 1800.0, "_model_config": {}, "_rl_module_spec": "RLModuleSpec(module_class=None, observation_space=None, action_space=None, inference_only=False, learner_only=False, model_config=DefaultModelConfig(fcnet_hiddens=[60, 90], fcnet_activation='tanh', fcnet_kernel_initializer=None, fcnet_kernel_initializer_kwargs=None, fcnet_bias_initializer=None, fcnet_bias_initializer_kwargs=None, conv_filters=None, conv_activation='relu', conv_kernel_initializer=None, conv_kernel_initializer_kwargs=None, conv_bias_initializer=None, conv_bias_initializer_kwargs=None, head_fcnet_hiddens=[], head_fcnet_activation='relu', head_fcnet_kernel_initializer=None, head_fcnet_kernel_initializer_kwargs=None, head_fcnet_bias_initializer=None, head_fcnet_bias_initializer_kwargs=None, free_log_std=False, log_std_clip_param=20.0, vf_share_layers=True, use_lstm=False, max_seq_len=20, lstm_cell_size=256, lstm_use_prev_action=False, lstm_use_prev_reward=False, lstm_kernel_initializer=None, lstm_kernel_initializer_kwargs=None, lstm_bias_initializer=None, lstm_bias_initializer_kwargs=None), catalog_class=None, load_state_path=None, model_config_dict=None)", "algorithm_config_overrides_per_module": {}, "_per_module_overrides": {}, "_validate_config": true, "_use_msgpack_checkpoints": false, "_torch_grad_scaler_class": null, "_torch_lr_scheduler_classes": null, "_tf_policy_handles_more_than_one_loss": false, "_disable_preprocessor_api": false, "_disable_action_flattening": false, "_disable_initialize_loss_from_dummy_batch": false, "_dont_auto_sync_env_runner_states": false, "env_task_fn": -1, "enable_connectors": -1, "simple_optimizer": false, "policy_map_cache": -1, "worker_cls": -1, "synchronize_filters": -1, "enable_async_evaluation": -1, "custom_async_evaluation_function": -1, "_enable_rl_module_api": -1, "auto_wrap_old_gym_envs": -1, "always_attach_evaluation_results": -1, "replay_sequence_length": null, "_disable_execution_plan_api": -1, "use_critic": true, "use_gae": true, "use_kl_loss": true, "kl_coeff": 0.7464963036515, "kl_target": 0.0270990929592, "vf_loss_coeff": 0.6688075857018, "entropy_coeff": 0.0090570820258, "clip_param": 0.1221781641624, "vf_clip_param": 0.1027808522125, "entropy_coeff_schedule": null, "lr_schedule": null, "sgd_minibatch_size": -1, "vf_share_layers": -1, "__stdout_file__": null, "__stderr_file__": null, "lambda": 0.9099046732075, "input": "sampler", "policies": {"default_policy": [null, null, null, null]}, "callbacks": "<class 'ray.rllib.callbacks.callbacks.RLlibCallback'>", "create_env_on_driver": false, "custom_eval_function": null, "framework": "torch"}, "time_since_restore": 27.655412197113037, "iterations_since_restore": 16, "perf": {"cpu_util_percent": 59.166666666666664, "ram_util_percent": 79.8}}
{"timers": {"training_iteration": 1.6155171281389182, "restore_env_runners": 1.195198962869864e-05, "training_step": 1.6153759296280528, "env_runner_sampling_timer": 1.5000994048045064, "learner_update_timer": 0.11216285114922415, "synch_weights": 0.0005941875472813625, "restore_eval_env_runners": 9.345338398634148e-06, "evaluation_iteration": 0.11349118914820046, "synch_eval_env_connectors": 0.00013689873017141548, "synch_env_connectors": 4.385151212134819e-06}, "env_runners": {"env_step_timer": 1.7767105278799785e-05, "num_agent_steps_sampled_lifetime": {"default_agent": -9252500.0}, "episode_duration_sec_mean": 0.006161684337537735, "env_to_module_connector": {"timers": {"connectors": {"add_time_dim_to_batch_and_zero_pad": 2.682418605352848e-06, "add_observations_from_episodes_to_batch": 3.4872328669860084e-06, "batch_individual_items": 7.388501873431246e-06, "add_states_from_episodes_to_batch": 1.9413254553882414e-06, "numpy_to_tensor": 1.4034370653478211e-05}}, "connector_pipeline_timer": 5.6789099107158814e-05}, "num_env_steps_sampled_lifetime": -9252500.0, "episode_return_mean": 6.9, "module_to_env_connector": {"timers": {"connectors": {"tensor_to_numpy": 1.6634537977465446e-05, "normalize_and_clip_actions": 1.0932362875786646e-05, "listify_data_for_vector_env": 1.4415637333372558e-05, "remove_single_ts_time_rank_from_batch": 6.731238498520677e-07, "get_actions": 5.2177082954514066e-05, "un_batch_to_individual_items": 6.1948928102967535e-06}}, "connector_pipeline_timer": 0.00013121837359105824}, "weights_seq_no": 16.0, "env_to_module_sum_episodes_length_out": 10.36823839457432, "episode_len_min": 20, "num_agent_steps_sampled": {"default_agent": 5000.0}, "env_reset_timer": 4.901929530754082e-05, "rlmodule_inference_timer": 5.08270364826528e-05, "num_env_steps_sampled": 5000.0, "env_to_module_sum_episodes_length_in": 10.36823839457432, "num_module_steps_sampled": {"default_policy": 5000.0}, "episode_len_mean": 20.0, "episode_len_max": 20, "num_episodes": 250.0, "num_episodes_lifetime": -462625.0, "time_between_sampling": 0.001829650003957434, "episode_return_min": -11.5, "agent_episode_returns_mean": {"default_agent": 6.9}, "episode_return_max": 8.5, "num_module_steps_sampled_lifetime": {"default_policy": -9252500.0}, "module_episode_returns_mean": {"default_policy": 6.9}, "sample": 0.00638269241650246, "num_env_steps_sampled_lifetime_throughput": 3361.617463109518}, "learners": {"__all_modules__": {"learner_connector": {"timers": {"connectors": {"add_states_from_episodes_to_batch": 3.6627775052745106e-06, "numpy_to_tensor": 7.932805719614913e-05, "batch_individual_items": 0.03614251913018352, "add_columns_from_episodes_to_train_batch": 0.03535284810820997, "add_time_dim_to_batch_and_zero_pad": 1.2669614513835874e-05, "add_observations_from_episodes_to_batch": 0.0008666502798614174, "add_one_ts_to_episodes_and_truncate": 0.00863920817699351, "general_advantage_estimation": 0.006657008064785857}}, "connector_pipeline_timer": 0.08790163256028657}, "num_env_steps_trained": 31500, "learner_connector_sum_episodes_length_out": 5250.0, "num_non_trainable_parameters": 0, "num_module_steps_trained_lifetime": 102000, "learner_connector_sum_episodes_length_in": 5000.0, "num_env_steps_trained_lifetime": 535500, "num_module_steps_trained": 6000, "num_trainable_parameters": 6003, "num_env_steps_trained_lifetime_throughput": 2132018.2473896323, "num_module_steps_trained_throughput": 407390.59200496844, "num_module_steps_trained_lifetime_throughput": 406859.63250679994}, "default_policy": {"num_module_steps_trained_lifetime": 102000, "gradients_default_optimizer_global_norm": 0.06734903156757355, "total_loss": -0.027786191552877426, "weights_seq_no": 17.0, "diff_num_grad_updates_vs_sampler_policy": 1.0, "num_module_steps_trained": 6000, "vf_loss": 0.10278083384037018, "entropy": 0.4231090247631073, "vf_explained_var": 0.011242687702178955, "curr_kl_coeff": 5.695314939657692e-06, "default_optimizer_learning_rate": 0.0002847858517, "num_trainable_parameters": 6003, "module_train_batch_size_mean": 1000.0, "vf_loss_unclipped": 27.776878356933594, "policy_loss": -0.09269465506076813, "mean_kl_loss": 8.43530724523589e-05, "curr_entropy_coeff": 0.0090570820258, "num_module_steps_trained_lifetime_throughput": 407517.2938078611}}, "num_training_step_calls_per_iteration": 1, "evaluation": {"env_runners": {"num_episodes": 20, "env_to_module_connector": {"timers": {"connectors": {"add_states_from_episodes_to_batch": 1.6957673308288524e-06, "numpy_to_tensor": 9.152677712532106e-06, "batch_individual_items": 6.639423912618116e-06, "add_time_dim_to_batch_and_zero_pad": 2.391952057948661e-06, "add_observations_from_episodes_to_batch": 3.1212697989315723e-06}}, "connector_pipeline_timer": 4.603187642721757e-05}, "sample": 0.106849480666333, "module_to_env_connector": {"timers": {"connectors": {"get_actions": 4.5399700032351195e-05, "remove_single_ts_time_rank_from_batch": 6.358938550884965e-07, "normalize_and_clip_actions": 1.0635267957256741e-05, "un_batch_to_individual_items": 5.940135363302364e-06, "tensor_to_numpy": 1.4598874014337934e-05, "listify_data_for_vector_env": 1.242332601020478e-05}}, "connector_pipeline_timer": 0.0001196864615203397}, "episode_duration_sec_mean": 0.005015021275030449, "module_episode_returns_mean": {"default_policy": -0.2}, "num_env_steps_sampled_lifetime": 85400, "episode_len_min": 20, "num_agent_steps_sampled_lifetime": {"default_agent": 6800}, "episode_len_max": 20, "num_episodes_lifetime": 340, "episode_return_min": -14.5, "env_step_timer": 1.5899177705273902e-05, "env_to_module_sum_episodes_length_out": 10.368238394574323, "num_agent_steps_sampled": {"default_agent": 400}, "env_to_module_sum_episodes_length_in": 10.368238394574323, "episode_return_max": 12.5, "agent_episode_returns_mean": {"default_agent": -0.2}, "num_module_steps_sampled_lifetime": {"default_policy": 6800}, "weights_seq_no": 17.0, "env_reset_timer": 0.00021289024893888375, "episode_len_mean": 20.0, "num_module_steps_sampled": {"default_policy": 400}, "episode_return_mean": -0.2, "rlmodule_inference_timer": 3.0307579623280734e-05, "num_env_steps_sampled": 400, "time_between_sampling": 1.6193521760576381}, "num_healthy_workers": 1, "actor_manager_num_outstanding_async_reqs": 0, "num_remote_worker_restarts": 0}, "num_env_steps_sampled_lifetime": -9252500.0, "fault_tolerance": {"num_healthy_workers": 0, "num_remote_worker_restarts": 0}, "env_runner_group": {"actor_manager_num_outstanding_async_reqs": 0}, "done": false, "training_iteration": 17, "trial_id": "43bd0_00000", "date": "2025-08-11_19-24-49", "timestamp": 1754933089, "time_this_iter_s": 2.174060821533203, "time_total_s": 29.82947301864624, "pid": 14505, "hostname": "Mac", "node_ip": "127.0.0.1", "config": {"exploration_config": {}, "extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "placement_strategy": "PACK", "num_gpus": 0, "_fake_gpus": false, "num_cpus_for_main_process": 2, "eager_tracing": true, "eager_max_retraces": 20, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "torch_compile_learner": false, "torch_compile_learner_what_to_compile": "forward_train", "torch_compile_learner_dynamo_backend": "aot_eager", "torch_compile_learner_dynamo_mode": null, "torch_compile_worker": false, "torch_compile_worker_dynamo_backend": "aot_eager", "torch_compile_worker_dynamo_mode": null, "torch_ddp_kwargs": {}, "torch_skip_nan_gradients": false, "env": "Umbrella", "env_config": {}, "observation_space": null, "action_space": null, "clip_rewards": null, "normalize_actions": true, "clip_actions": false, "_is_atari": null, "disable_env_checking": false, "render_env": false, "action_mask_key": "action_mask", "env_runner_cls": null, "num_env_runners": 0, "create_local_env_runner": true, "num_envs_per_env_runner": 1, "gym_env_vectorize_mode": "SYNC", "num_cpus_per_env_runner": 1, "num_gpus_per_env_runner": 0, "custom_resources_per_env_runner": {}, "validate_env_runners_after_construction": true, "episodes_to_numpy": true, "max_requests_in_flight_per_env_runner": 1, "sample_timeout_s": 60.0, "_env_to_module_connector": null, "add_default_connectors_to_env_to_module_pipeline": true, "_module_to_env_connector": null, "add_default_connectors_to_module_to_env_pipeline": true, "merge_env_runner_states": "training_only", "broadcast_env_runner_states": true, "episode_lookback_horizon": 1, "rollout_fragment_length": "auto", "batch_mode": "complete_episodes", "compress_observations": false, "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "enable_tf1_exec_eagerly": false, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "preprocessor_pref": "deepmind", "observation_filter": "NoFilter", "update_worker_filter_stats": true, "use_worker_filter_stats": true, "sampler_perf_stats_ema_coef": null, "_is_online": true, "num_learners": 0, "num_gpus_per_learner": 0, "num_cpus_per_learner": "auto", "num_aggregator_actors_per_learner": 0, "max_requests_in_flight_per_aggregator_actor": 3, "local_gpu_idx": 0, "max_requests_in_flight_per_learner": 3, "gamma": 1, "lr": 0.0002847858517, "grad_clip": 0.5, "grad_clip_by": "global_norm", "_train_batch_size_per_learner": 5000, "train_batch_size": 4000, "num_epochs": 1, "minibatch_size": 1000, "shuffle_batch_per_epoch": true, "model": {"fcnet_hiddens": [256, 256], "fcnet_activation": "tanh", "fcnet_weights_initializer": null, "fcnet_weights_initializer_config": null, "fcnet_bias_initializer": null, "fcnet_bias_initializer_config": null, "conv_filters": null, "conv_activation": "relu", "conv_kernel_initializer": null, "conv_kernel_initializer_config": null, "conv_bias_initializer": null, "conv_bias_initializer_config": null, "conv_transpose_kernel_initializer": null, "conv_transpose_kernel_initializer_config": null, "conv_transpose_bias_initializer": null, "conv_transpose_bias_initializer_config": null, "post_fcnet_hiddens": [], "post_fcnet_activation": "relu", "post_fcnet_weights_initializer": null, "post_fcnet_weights_initializer_config": null, "post_fcnet_bias_initializer": null, "post_fcnet_bias_initializer_config": null, "free_log_std": false, "log_std_clip_param": 20.0, "no_final_linear": false, "vf_share_layers": false, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "lstm_weights_initializer": null, "lstm_weights_initializer_config": null, "lstm_bias_initializer": null, "lstm_bias_initializer_config": null, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "attention_use_n_prev_actions": 0, "attention_use_n_prev_rewards": 0, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": null, "custom_model_config": {}, "custom_action_dist": null, "custom_preprocessor": null, "encoder_latent_dim": null, "always_check_shapes": false, "lstm_use_prev_action_reward": -1, "_use_default_native_models": -1, "_disable_preprocessor_api": false, "_disable_action_flattening": false}, "_learner_connector": null, "add_default_connectors_to_learner_pipeline": true, "learner_config_dict": {}, "optimizer": {}, "_learner_class": null, "callbacks_on_algorithm_init": null, "callbacks_on_env_runners_recreated": null, "callbacks_on_offline_eval_runners_recreated": null, "callbacks_on_checkpoint_loaded": null, "callbacks_on_environment_created": null, "callbacks_on_episode_created": null, "callbacks_on_episode_start": null, "callbacks_on_episode_step": null, "callbacks_on_episode_end": null, "callbacks_on_evaluate_start": null, "callbacks_on_evaluate_end": null, "callbacks_on_evaluate_offline_start": null, "callbacks_on_evaluate_offline_end": null, "callbacks_on_sample_end": null, "callbacks_on_train_result": null, "explore": true, "enable_rl_module_and_learner": true, "enable_env_runner_and_connector_v2": true, "_prior_exploration_config": {"type": "StochasticSampling"}, "count_steps_by": "env_steps", "policy_map_capacity": 100, "policy_mapping_fn": "<function AlgorithmConfig.DEFAULT_POLICY_MAPPING_FN at 0x3855e5b20>", "policies_to_train": null, "policy_states_are_swappable": false, "observation_fn": null, "offline_data_class": null, "input_read_method": "read_parquet", "input_read_method_kwargs": {}, "input_read_schema": {}, "input_read_episodes": false, "input_read_sample_batches": false, "input_read_batch_size": null, "input_filesystem": null, "input_filesystem_kwargs": {}, "input_compress_columns": ["obs", "new_obs"], "input_spaces_jsonable": true, "materialize_data": false, "materialize_mapped_data": true, "map_batches_kwargs": {}, "iter_batches_kwargs": {}, "ignore_final_observation": false, "prelearner_class": null, "prelearner_buffer_class": null, "prelearner_buffer_kwargs": {}, "prelearner_module_synch_period": 10, "dataset_num_iters_per_learner": null, "input_config": {}, "actions_in_input_normalized": false, "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_config": {}, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "output_max_rows_per_file": null, "output_write_remaining_data": false, "output_write_method": "write_parquet", "output_write_method_kwargs": {}, "output_filesystem": null, "output_filesystem_kwargs": {}, "output_write_episodes": true, "offline_sampling": false, "evaluation_interval": 1, "evaluation_duration": 20, "evaluation_duration_unit": "episodes", "evaluation_sample_timeout_s": 120.0, "evaluation_auto_duration_min_env_steps_per_sample": 100, "evaluation_auto_duration_max_env_steps_per_sample": 2000, "evaluation_parallel_to_training": false, "evaluation_force_reset_envs_before_iteration": true, "evaluation_config": null, "off_policy_estimation_methods": {}, "ope_split_batch_by_episode": true, "evaluation_num_env_runners": 1, "in_evaluation": false, "sync_filters_on_rollout_workers_timeout_s": 10.0, "offline_evaluation_interval": null, "num_offline_eval_runners": 0, "offline_loss_for_module_fn": null, "offline_evaluation_duration": 1, "offline_evaluation_parallel_to_training": false, "offline_evaluation_timeout_s": 120.0, "num_cpus_per_offline_eval_runner": 1, "num_gpus_per_offline_eval_runner": 0, "custom_resources_per_offline_eval_runner": {}, "restart_failed_offline_eval_runners": true, "ignore_offline_eval_runner_failures": false, "max_num_offline_eval_runner_restarts": 1000, "offline_eval_runner_restore_timeout_s": 1800.0, "max_requests_in_flight_per_offline_eval_runner": 1, "validate_offline_eval_runners_after_construction": true, "offline_eval_runner_health_probe_timeout_s": 30.0, "offline_eval_rl_module_inference_only": false, "broadcast_offline_eval_runner_states": false, "offline_eval_batch_size_per_runner": 256, "dataset_num_iters_per_eval_runner": 1, "keep_per_episode_custom_metrics": false, "metrics_episode_collection_timeout_s": 60.0, "metrics_num_episodes_for_smoothing": 100, "min_time_s_per_iteration": null, "min_train_timesteps_per_iteration": 0, "min_sample_timesteps_per_iteration": 0, "log_gradients": true, "export_native_model_files": false, "checkpoint_trainable_policies_only": false, "logger_creator": null, "logger_config": null, "log_level": "WARN", "log_sys_usage": true, "fake_sampler": false, "seed": 2, "restart_failed_env_runners": true, "ignore_env_runner_failures": false, "max_num_env_runner_restarts": 1000, "delay_between_env_runner_restarts_s": 60.0, "restart_failed_sub_environments": false, "num_consecutive_env_runner_failures_tolerance": 100, "env_runner_health_probe_timeout_s": 30.0, "env_runner_restore_timeout_s": 1800.0, "_model_config": {}, "_rl_module_spec": "RLModuleSpec(module_class=None, observation_space=None, action_space=None, inference_only=False, learner_only=False, model_config=DefaultModelConfig(fcnet_hiddens=[60, 90], fcnet_activation='tanh', fcnet_kernel_initializer=None, fcnet_kernel_initializer_kwargs=None, fcnet_bias_initializer=None, fcnet_bias_initializer_kwargs=None, conv_filters=None, conv_activation='relu', conv_kernel_initializer=None, conv_kernel_initializer_kwargs=None, conv_bias_initializer=None, conv_bias_initializer_kwargs=None, head_fcnet_hiddens=[], head_fcnet_activation='relu', head_fcnet_kernel_initializer=None, head_fcnet_kernel_initializer_kwargs=None, head_fcnet_bias_initializer=None, head_fcnet_bias_initializer_kwargs=None, free_log_std=False, log_std_clip_param=20.0, vf_share_layers=True, use_lstm=False, max_seq_len=20, lstm_cell_size=256, lstm_use_prev_action=False, lstm_use_prev_reward=False, lstm_kernel_initializer=None, lstm_kernel_initializer_kwargs=None, lstm_bias_initializer=None, lstm_bias_initializer_kwargs=None), catalog_class=None, load_state_path=None, model_config_dict=None)", "algorithm_config_overrides_per_module": {}, "_per_module_overrides": {}, "_validate_config": true, "_use_msgpack_checkpoints": false, "_torch_grad_scaler_class": null, "_torch_lr_scheduler_classes": null, "_tf_policy_handles_more_than_one_loss": false, "_disable_preprocessor_api": false, "_disable_action_flattening": false, "_disable_initialize_loss_from_dummy_batch": false, "_dont_auto_sync_env_runner_states": false, "env_task_fn": -1, "enable_connectors": -1, "simple_optimizer": false, "policy_map_cache": -1, "worker_cls": -1, "synchronize_filters": -1, "enable_async_evaluation": -1, "custom_async_evaluation_function": -1, "_enable_rl_module_api": -1, "auto_wrap_old_gym_envs": -1, "always_attach_evaluation_results": -1, "replay_sequence_length": null, "_disable_execution_plan_api": -1, "use_critic": true, "use_gae": true, "use_kl_loss": true, "kl_coeff": 0.7464963036515, "kl_target": 0.0270990929592, "vf_loss_coeff": 0.6688075857018, "entropy_coeff": 0.0090570820258, "clip_param": 0.1221781641624, "vf_clip_param": 0.1027808522125, "entropy_coeff_schedule": null, "lr_schedule": null, "sgd_minibatch_size": -1, "vf_share_layers": -1, "__stdout_file__": null, "__stderr_file__": null, "lambda": 0.9099046732075, "input": "sampler", "policies": {"default_policy": [null, null, null, null]}, "callbacks": "<class 'ray.rllib.callbacks.callbacks.RLlibCallback'>", "create_env_on_driver": false, "custom_eval_function": null, "framework": "torch"}, "time_since_restore": 29.82947301864624, "iterations_since_restore": 17, "perf": {"cpu_util_percent": 56.46666666666667, "ram_util_percent": 79.66666666666667}}
{"timers": {"training_iteration": 1.6159054647676299, "restore_env_runners": 1.1892470189281255e-05, "training_step": 1.615763557002205, "env_runner_sampling_timer": 1.4992246565969138, "learner_update_timer": 0.11342245513734255, "synch_weights": 0.0005942273320237331, "restore_eval_env_runners": 9.333555019522273e-06, "evaluation_iteration": 0.11357387017642948, "synch_eval_env_connectors": 0.00013660890242565805, "synch_env_connectors": 4.381719099751782e-06}, "env_runners": {"env_step_timer": 1.4276827681937651e-05, "num_agent_steps_sampled_lifetime": {"default_agent": -9870000.0}, "episode_duration_sec_mean": 0.004635735495015981, "env_to_module_connector": {"timers": {"connectors": {"add_time_dim_to_batch_and_zero_pad": 2.4271128283307473e-06, "add_observations_from_episodes_to_batch": 3.0577056072775283e-06, "batch_individual_items": 6.512141391604654e-06, "add_states_from_episodes_to_batch": 1.8088249972685705e-06, "numpy_to_tensor": 9.000295727161363e-06}}, "connector_pipeline_timer": 4.5080678928897763e-05}, "num_env_steps_sampled_lifetime": -9870000.0, "episode_return_mean": 7.059999999999999, "module_to_env_connector": {"timers": {"connectors": {"tensor_to_numpy": 1.3377231861919356e-05, "normalize_and_clip_actions": 9.706144053292652e-06, "listify_data_for_vector_env": 1.1527098597066677e-05, "remove_single_ts_time_rank_from_batch": 6.111716526581688e-07, "get_actions": 3.966008415811888e-05, "un_batch_to_individual_items": 5.550359437276623e-06}}, "connector_pipeline_timer": 0.00010689888505118347}, "weights_seq_no": 17.0, "env_to_module_sum_episodes_length_out": 10.36823839457432, "episode_len_min": 20, "num_agent_steps_sampled": {"default_agent": 5000.0}, "env_reset_timer": 4.552714366026232e-05, "rlmodule_inference_timer": 2.8734203475954998e-05, "num_env_steps_sampled": 5000.0, "env_to_module_sum_episodes_length_in": 10.36823839457432, "num_module_steps_sampled": {"default_policy": 5000.0}, "episode_len_mean": 20.0, "episode_len_max": 20, "num_episodes": 250.0, "num_episodes_lifetime": -493500.0, "time_between_sampling": 0.0020825996978738066, "episode_return_min": -11.5, "agent_episode_returns_mean": {"default_agent": 7.059999999999999}, "episode_return_max": 8.5, "num_module_steps_sampled_lifetime": {"default_policy": -9870000.0}, "module_episode_returns_mean": {"default_policy": 7.059999999999999}, "sample": 0.005545724338764798, "num_env_steps_sampled_lifetime_throughput": 3594.8204004464346}, "learners": {"__all_modules__": {"learner_connector": {"timers": {"connectors": {"add_states_from_episodes_to_batch": 3.677810193435686e-06, "numpy_to_tensor": 7.932018656273167e-05, "batch_individual_items": 0.03750976351848819, "add_columns_from_episodes_to_train_batch": 0.03535954837705128, "add_time_dim_to_batch_and_zero_pad": 1.2671667893872013e-05, "add_observations_from_episodes_to_batch": 0.0008678629465827939, "add_one_ts_to_episodes_and_truncate": 0.008632101095907315, "general_advantage_estimation": 0.006646904234818386}}, "connector_pipeline_timer": 0.08925938207430886}, "num_env_steps_trained": 31500, "learner_connector_sum_episodes_length_out": 5250.0, "num_non_trainable_parameters": 0, "num_module_steps_trained_lifetime": 108000, "learner_connector_sum_episodes_length_in": 5000.0, "num_env_steps_trained_lifetime": 567000, "num_module_steps_trained": 6000, "num_trainable_parameters": 6003, "num_env_steps_trained_lifetime_throughput": 2121690.8817563523, "num_module_steps_trained_throughput": 405361.6626059916, "num_module_steps_trained_lifetime_throughput": 404851.0541648348}, "default_policy": {"num_module_steps_trained_lifetime": 108000, "gradients_default_optimizer_global_norm": 0.08864210546016693, "total_loss": -0.06480350345373154, "weights_seq_no": 18.0, "diff_num_grad_updates_vs_sampler_policy": 1.0, "num_module_steps_trained": 6000, "vf_loss": 0.10278083384037018, "entropy": 0.43428218364715576, "vf_explained_var": 0.01639944314956665, "curr_kl_coeff": 2.847657469828846e-06, "default_optimizer_learning_rate": 0.0002847858517, "num_trainable_parameters": 6003, "module_train_batch_size_mean": 1000.0, "vf_loss_unclipped": 27.705440521240234, "policy_loss": -0.1296107918024063, "mean_kl_loss": 0.00011860190716106445, "curr_entropy_coeff": 0.0090570820258, "num_module_steps_trained_lifetime_throughput": 405445.7812604233}}, "num_training_step_calls_per_iteration": 1, "evaluation": {"env_runners": {"num_episodes": 20, "env_to_module_connector": {"timers": {"connectors": {"add_states_from_episodes_to_batch": 1.6729556856900652e-06, "numpy_to_tensor": 8.385755358584263e-06, "batch_individual_items": 6.202413615754247e-06, "add_time_dim_to_batch_and_zero_pad": 2.3246275626712274e-06, "add_observations_from_episodes_to_batch": 2.9259175445325905e-06}}, "connector_pipeline_timer": 4.35227770970828e-05}, "sample": 0.10678069251960136, "module_to_env_connector": {"timers": {"connectors": {"get_actions": 3.707224557729467e-05, "remove_single_ts_time_rank_from_batch": 5.918575258770674e-07, "normalize_and_clip_actions": 9.484869974883387e-06, "un_batch_to_individual_items": 5.389850582972555e-06, "tensor_to_numpy": 1.3130282134576813e-05, "listify_data_for_vector_env": 1.1167201026106165e-05}}, "connector_pipeline_timer": 0.00010274083640156615}, "episode_duration_sec_mean": 0.0049972804123535755, "module_episode_returns_mean": {"default_policy": -0.4}, "num_env_steps_sampled_lifetime": 90400, "episode_len_min": 20, "num_agent_steps_sampled_lifetime": {"default_agent": 7200}, "episode_len_max": 20, "num_episodes_lifetime": 360, "episode_return_min": -14.5, "env_step_timer": 1.4280839417928594e-05, "env_to_module_sum_episodes_length_out": 10.368238394574323, "num_agent_steps_sampled": {"default_agent": 400}, "env_to_module_sum_episodes_length_in": 10.368238394574323, "episode_return_max": 12.5, "agent_episode_returns_mean": {"default_agent": -0.4}, "num_module_steps_sampled_lifetime": {"default_policy": 7200}, "weights_seq_no": 18.0, "env_reset_timer": 0.00021189093712286708, "episode_len_mean": 20.0, "num_module_steps_sampled": {"default_policy": 400}, "episode_return_mean": -0.4, "rlmodule_inference_timer": 2.7913806968707827e-05, "num_env_steps_sampled": 400, "time_between_sampling": 1.6198975680466392}, "num_healthy_workers": 1, "actor_manager_num_outstanding_async_reqs": 0, "num_remote_worker_restarts": 0}, "num_env_steps_sampled_lifetime": -9870000.0, "fault_tolerance": {"num_healthy_workers": 0, "num_remote_worker_restarts": 0}, "env_runner_group": {"actor_manager_num_outstanding_async_reqs": 0}, "done": false, "training_iteration": 18, "trial_id": "43bd0_00000", "date": "2025-08-11_19-24-51", "timestamp": 1754933091, "time_this_iter_s": 1.7621448040008545, "time_total_s": 31.591617822647095, "pid": 14505, "hostname": "Mac", "node_ip": "127.0.0.1", "config": {"exploration_config": {}, "extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "placement_strategy": "PACK", "num_gpus": 0, "_fake_gpus": false, "num_cpus_for_main_process": 2, "eager_tracing": true, "eager_max_retraces": 20, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "torch_compile_learner": false, "torch_compile_learner_what_to_compile": "forward_train", "torch_compile_learner_dynamo_backend": "aot_eager", "torch_compile_learner_dynamo_mode": null, "torch_compile_worker": false, "torch_compile_worker_dynamo_backend": "aot_eager", "torch_compile_worker_dynamo_mode": null, "torch_ddp_kwargs": {}, "torch_skip_nan_gradients": false, "env": "Umbrella", "env_config": {}, "observation_space": null, "action_space": null, "clip_rewards": null, "normalize_actions": true, "clip_actions": false, "_is_atari": null, "disable_env_checking": false, "render_env": false, "action_mask_key": "action_mask", "env_runner_cls": null, "num_env_runners": 0, "create_local_env_runner": true, "num_envs_per_env_runner": 1, "gym_env_vectorize_mode": "SYNC", "num_cpus_per_env_runner": 1, "num_gpus_per_env_runner": 0, "custom_resources_per_env_runner": {}, "validate_env_runners_after_construction": true, "episodes_to_numpy": true, "max_requests_in_flight_per_env_runner": 1, "sample_timeout_s": 60.0, "_env_to_module_connector": null, "add_default_connectors_to_env_to_module_pipeline": true, "_module_to_env_connector": null, "add_default_connectors_to_module_to_env_pipeline": true, "merge_env_runner_states": "training_only", "broadcast_env_runner_states": true, "episode_lookback_horizon": 1, "rollout_fragment_length": "auto", "batch_mode": "complete_episodes", "compress_observations": false, "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "enable_tf1_exec_eagerly": false, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "preprocessor_pref": "deepmind", "observation_filter": "NoFilter", "update_worker_filter_stats": true, "use_worker_filter_stats": true, "sampler_perf_stats_ema_coef": null, "_is_online": true, "num_learners": 0, "num_gpus_per_learner": 0, "num_cpus_per_learner": "auto", "num_aggregator_actors_per_learner": 0, "max_requests_in_flight_per_aggregator_actor": 3, "local_gpu_idx": 0, "max_requests_in_flight_per_learner": 3, "gamma": 1, "lr": 0.0002847858517, "grad_clip": 0.5, "grad_clip_by": "global_norm", "_train_batch_size_per_learner": 5000, "train_batch_size": 4000, "num_epochs": 1, "minibatch_size": 1000, "shuffle_batch_per_epoch": true, "model": {"fcnet_hiddens": [256, 256], "fcnet_activation": "tanh", "fcnet_weights_initializer": null, "fcnet_weights_initializer_config": null, "fcnet_bias_initializer": null, "fcnet_bias_initializer_config": null, "conv_filters": null, "conv_activation": "relu", "conv_kernel_initializer": null, "conv_kernel_initializer_config": null, "conv_bias_initializer": null, "conv_bias_initializer_config": null, "conv_transpose_kernel_initializer": null, "conv_transpose_kernel_initializer_config": null, "conv_transpose_bias_initializer": null, "conv_transpose_bias_initializer_config": null, "post_fcnet_hiddens": [], "post_fcnet_activation": "relu", "post_fcnet_weights_initializer": null, "post_fcnet_weights_initializer_config": null, "post_fcnet_bias_initializer": null, "post_fcnet_bias_initializer_config": null, "free_log_std": false, "log_std_clip_param": 20.0, "no_final_linear": false, "vf_share_layers": false, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "lstm_weights_initializer": null, "lstm_weights_initializer_config": null, "lstm_bias_initializer": null, "lstm_bias_initializer_config": null, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "attention_use_n_prev_actions": 0, "attention_use_n_prev_rewards": 0, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": null, "custom_model_config": {}, "custom_action_dist": null, "custom_preprocessor": null, "encoder_latent_dim": null, "always_check_shapes": false, "lstm_use_prev_action_reward": -1, "_use_default_native_models": -1, "_disable_preprocessor_api": false, "_disable_action_flattening": false}, "_learner_connector": null, "add_default_connectors_to_learner_pipeline": true, "learner_config_dict": {}, "optimizer": {}, "_learner_class": null, "callbacks_on_algorithm_init": null, "callbacks_on_env_runners_recreated": null, "callbacks_on_offline_eval_runners_recreated": null, "callbacks_on_checkpoint_loaded": null, "callbacks_on_environment_created": null, "callbacks_on_episode_created": null, "callbacks_on_episode_start": null, "callbacks_on_episode_step": null, "callbacks_on_episode_end": null, "callbacks_on_evaluate_start": null, "callbacks_on_evaluate_end": null, "callbacks_on_evaluate_offline_start": null, "callbacks_on_evaluate_offline_end": null, "callbacks_on_sample_end": null, "callbacks_on_train_result": null, "explore": true, "enable_rl_module_and_learner": true, "enable_env_runner_and_connector_v2": true, "_prior_exploration_config": {"type": "StochasticSampling"}, "count_steps_by": "env_steps", "policy_map_capacity": 100, "policy_mapping_fn": "<function AlgorithmConfig.DEFAULT_POLICY_MAPPING_FN at 0x3855e5b20>", "policies_to_train": null, "policy_states_are_swappable": false, "observation_fn": null, "offline_data_class": null, "input_read_method": "read_parquet", "input_read_method_kwargs": {}, "input_read_schema": {}, "input_read_episodes": false, "input_read_sample_batches": false, "input_read_batch_size": null, "input_filesystem": null, "input_filesystem_kwargs": {}, "input_compress_columns": ["obs", "new_obs"], "input_spaces_jsonable": true, "materialize_data": false, "materialize_mapped_data": true, "map_batches_kwargs": {}, "iter_batches_kwargs": {}, "ignore_final_observation": false, "prelearner_class": null, "prelearner_buffer_class": null, "prelearner_buffer_kwargs": {}, "prelearner_module_synch_period": 10, "dataset_num_iters_per_learner": null, "input_config": {}, "actions_in_input_normalized": false, "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_config": {}, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "output_max_rows_per_file": null, "output_write_remaining_data": false, "output_write_method": "write_parquet", "output_write_method_kwargs": {}, "output_filesystem": null, "output_filesystem_kwargs": {}, "output_write_episodes": true, "offline_sampling": false, "evaluation_interval": 1, "evaluation_duration": 20, "evaluation_duration_unit": "episodes", "evaluation_sample_timeout_s": 120.0, "evaluation_auto_duration_min_env_steps_per_sample": 100, "evaluation_auto_duration_max_env_steps_per_sample": 2000, "evaluation_parallel_to_training": false, "evaluation_force_reset_envs_before_iteration": true, "evaluation_config": null, "off_policy_estimation_methods": {}, "ope_split_batch_by_episode": true, "evaluation_num_env_runners": 1, "in_evaluation": false, "sync_filters_on_rollout_workers_timeout_s": 10.0, "offline_evaluation_interval": null, "num_offline_eval_runners": 0, "offline_loss_for_module_fn": null, "offline_evaluation_duration": 1, "offline_evaluation_parallel_to_training": false, "offline_evaluation_timeout_s": 120.0, "num_cpus_per_offline_eval_runner": 1, "num_gpus_per_offline_eval_runner": 0, "custom_resources_per_offline_eval_runner": {}, "restart_failed_offline_eval_runners": true, "ignore_offline_eval_runner_failures": false, "max_num_offline_eval_runner_restarts": 1000, "offline_eval_runner_restore_timeout_s": 1800.0, "max_requests_in_flight_per_offline_eval_runner": 1, "validate_offline_eval_runners_after_construction": true, "offline_eval_runner_health_probe_timeout_s": 30.0, "offline_eval_rl_module_inference_only": false, "broadcast_offline_eval_runner_states": false, "offline_eval_batch_size_per_runner": 256, "dataset_num_iters_per_eval_runner": 1, "keep_per_episode_custom_metrics": false, "metrics_episode_collection_timeout_s": 60.0, "metrics_num_episodes_for_smoothing": 100, "min_time_s_per_iteration": null, "min_train_timesteps_per_iteration": 0, "min_sample_timesteps_per_iteration": 0, "log_gradients": true, "export_native_model_files": false, "checkpoint_trainable_policies_only": false, "logger_creator": null, "logger_config": null, "log_level": "WARN", "log_sys_usage": true, "fake_sampler": false, "seed": 2, "restart_failed_env_runners": true, "ignore_env_runner_failures": false, "max_num_env_runner_restarts": 1000, "delay_between_env_runner_restarts_s": 60.0, "restart_failed_sub_environments": false, "num_consecutive_env_runner_failures_tolerance": 100, "env_runner_health_probe_timeout_s": 30.0, "env_runner_restore_timeout_s": 1800.0, "_model_config": {}, "_rl_module_spec": "RLModuleSpec(module_class=None, observation_space=None, action_space=None, inference_only=False, learner_only=False, model_config=DefaultModelConfig(fcnet_hiddens=[60, 90], fcnet_activation='tanh', fcnet_kernel_initializer=None, fcnet_kernel_initializer_kwargs=None, fcnet_bias_initializer=None, fcnet_bias_initializer_kwargs=None, conv_filters=None, conv_activation='relu', conv_kernel_initializer=None, conv_kernel_initializer_kwargs=None, conv_bias_initializer=None, conv_bias_initializer_kwargs=None, head_fcnet_hiddens=[], head_fcnet_activation='relu', head_fcnet_kernel_initializer=None, head_fcnet_kernel_initializer_kwargs=None, head_fcnet_bias_initializer=None, head_fcnet_bias_initializer_kwargs=None, free_log_std=False, log_std_clip_param=20.0, vf_share_layers=True, use_lstm=False, max_seq_len=20, lstm_cell_size=256, lstm_use_prev_action=False, lstm_use_prev_reward=False, lstm_kernel_initializer=None, lstm_kernel_initializer_kwargs=None, lstm_bias_initializer=None, lstm_bias_initializer_kwargs=None), catalog_class=None, load_state_path=None, model_config_dict=None)", "algorithm_config_overrides_per_module": {}, "_per_module_overrides": {}, "_validate_config": true, "_use_msgpack_checkpoints": false, "_torch_grad_scaler_class": null, "_torch_lr_scheduler_classes": null, "_tf_policy_handles_more_than_one_loss": false, "_disable_preprocessor_api": false, "_disable_action_flattening": false, "_disable_initialize_loss_from_dummy_batch": false, "_dont_auto_sync_env_runner_states": false, "env_task_fn": -1, "enable_connectors": -1, "simple_optimizer": false, "policy_map_cache": -1, "worker_cls": -1, "synchronize_filters": -1, "enable_async_evaluation": -1, "custom_async_evaluation_function": -1, "_enable_rl_module_api": -1, "auto_wrap_old_gym_envs": -1, "always_attach_evaluation_results": -1, "replay_sequence_length": null, "_disable_execution_plan_api": -1, "use_critic": true, "use_gae": true, "use_kl_loss": true, "kl_coeff": 0.7464963036515, "kl_target": 0.0270990929592, "vf_loss_coeff": 0.6688075857018, "entropy_coeff": 0.0090570820258, "clip_param": 0.1221781641624, "vf_clip_param": 0.1027808522125, "entropy_coeff_schedule": null, "lr_schedule": null, "sgd_minibatch_size": -1, "vf_share_layers": -1, "__stdout_file__": null, "__stderr_file__": null, "lambda": 0.9099046732075, "input": "sampler", "policies": {"default_policy": [null, null, null, null]}, "callbacks": "<class 'ray.rllib.callbacks.callbacks.RLlibCallback'>", "create_env_on_driver": false, "custom_eval_function": null, "framework": "torch"}, "time_since_restore": 31.591617822647095, "iterations_since_restore": 18, "perf": {"cpu_util_percent": 58.75, "ram_util_percent": 80.75}}
{"timers": {"training_iteration": 1.6397994559499443, "restore_env_runners": 1.1832294479548405e-05, "training_step": 1.6396551226822593, "env_runner_sampling_timer": 1.5145219229408935, "learner_update_timer": 0.12198713683696563, "synch_weights": 0.0006039200590124713, "restore_eval_env_runners": 9.315640299725848e-06, "evaluation_iteration": 0.11349227689370402, "synch_eval_env_connectors": 0.00013631489257748467, "synch_env_connectors": 4.379151349737202e-06}, "env_runners": {"env_step_timer": 3.4284461008284416e-05, "num_agent_steps_sampled_lifetime": {"default_agent": -10487500.0}, "episode_duration_sec_mean": 0.010111081179231403, "env_to_module_connector": {"timers": {"connectors": {"add_time_dim_to_batch_and_zero_pad": 4.301214778325061e-06, "add_observations_from_episodes_to_batch": 5.381297964754748e-06, "batch_individual_items": 1.2374667791438348e-05, "add_states_from_episodes_to_batch": 2.7293445195161705e-06, "numpy_to_tensor": 1.9106320472038405e-05}}, "connector_pipeline_timer": 7.961452476915851e-05}, "num_env_steps_sampled_lifetime": -10487500.0, "episode_return_mean": 6.74, "module_to_env_connector": {"timers": {"connectors": {"tensor_to_numpy": 3.3840740320924465e-05, "normalize_and_clip_actions": 1.693166592541777e-05, "listify_data_for_vector_env": 2.1387774836287563e-05, "remove_single_ts_time_rank_from_batch": 1.056776842776994e-06, "get_actions": 9.833997345617341e-05, "un_batch_to_individual_items": 1.0581922397978958e-05}}, "connector_pipeline_timer": 0.00023037615266818015}, "weights_seq_no": 18.0, "env_to_module_sum_episodes_length_out": 10.36823839457432, "episode_len_min": 20, "num_agent_steps_sampled": {"default_agent": 5000.0}, "env_reset_timer": 6.597599012310898e-05, "rlmodule_inference_timer": 5.9660726488898175e-05, "num_env_steps_sampled": 5000.0, "env_to_module_sum_episodes_length_in": 10.36823839457432, "num_module_steps_sampled": {"default_policy": 5000.0}, "episode_len_mean": 20.0, "episode_len_max": 20, "num_episodes": 250.0, "num_episodes_lifetime": -524375.0, "time_between_sampling": 0.0023466356900928645, "episode_return_min": -11.5, "agent_episode_returns_mean": {"default_agent": 6.74}, "episode_return_max": 8.5, "num_module_steps_sampled_lifetime": {"default_policy": -10487500.0}, "module_episode_returns_mean": {"default_policy": 6.74}, "sample": 0.008121250547789257, "num_env_steps_sampled_lifetime_throughput": 2427.854140763662}, "learners": {"__all_modules__": {"learner_connector": {"timers": {"connectors": {"add_states_from_episodes_to_batch": 3.6793630003660655e-06, "numpy_to_tensor": 8.419198475954022e-05, "batch_individual_items": 0.04341743213396395, "add_columns_from_episodes_to_train_batch": 0.03628829622337535, "add_time_dim_to_batch_and_zero_pad": 1.2864531063952939e-05, "add_observations_from_episodes_to_batch": 0.000870350567450156, "add_one_ts_to_episodes_and_truncate": 0.008680069665112719, "general_advantage_estimation": 0.0068865922722283245}}, "connector_pipeline_timer": 0.09639235534277324}, "num_env_steps_trained": 31500, "learner_connector_sum_episodes_length_out": 5250.0, "num_non_trainable_parameters": 0, "num_module_steps_trained_lifetime": 114000, "learner_connector_sum_episodes_length_in": 5000.0, "num_env_steps_trained_lifetime": 598500, "num_module_steps_trained": 6000, "num_trainable_parameters": 6003, "num_env_steps_trained_lifetime_throughput": 2089789.0616226776, "num_module_steps_trained_throughput": 399225.6355683832, "num_module_steps_trained_lifetime_throughput": 398736.08433134825}, "default_policy": {"num_module_steps_trained_lifetime": 114000, "gradients_default_optimizer_global_norm": 0.13775816559791565, "total_loss": 0.005777741316705942, "weights_seq_no": 19.0, "diff_num_grad_updates_vs_sampler_policy": 1.0, "num_module_steps_trained": 6000, "vf_loss": 0.10278083384037018, "entropy": 0.41222673654556274, "vf_explained_var": 0.007687926292419434, "curr_kl_coeff": 1.423828734914423e-06, "default_optimizer_learning_rate": 0.0002847858517, "num_trainable_parameters": 6003, "module_train_batch_size_mean": 1000.0, "vf_loss_unclipped": 27.868133544921875, "policy_loss": -0.059229280799627304, "mean_kl_loss": 0.000583978951908648, "curr_entropy_coeff": 0.0090570820258, "num_module_steps_trained_lifetime_throughput": 399277.92696048965}}, "num_training_step_calls_per_iteration": 1, "evaluation": {"env_runners": {"num_episodes": 20, "env_to_module_connector": {"timers": {"connectors": {"add_states_from_episodes_to_batch": 6.830384570865204e-06, "numpy_to_tensor": 8.23810792441989e-05, "batch_individual_items": 3.212989398766653e-05, "add_time_dim_to_batch_and_zero_pad": 1.3218368145025235e-05, "add_observations_from_episodes_to_batch": 3.93260455633534e-05}}, "connector_pipeline_timer": 0.00029851872763937736}, "sample": 0.11308909559477132, "module_to_env_connector": {"timers": {"connectors": {"get_actions": 0.0005172142911294076, "remove_single_ts_time_rank_from_batch": 2.238500527486739e-06, "normalize_and_clip_actions": 4.298260637189826e-05, "un_batch_to_individual_items": 2.3510254572038824e-05, "tensor_to_numpy": 7.93626289850255e-05, "listify_data_for_vector_env": 5.6906272864113297e-05}}, "connector_pipeline_timer": 0.0008829914814050606}, "episode_duration_sec_mean": 0.011022698709275573, "module_episode_returns_mean": {"default_policy": -0.4}, "num_env_steps_sampled_lifetime": 95400, "episode_len_min": 20, "num_agent_steps_sampled_lifetime": {"default_agent": 7600}, "episode_len_max": 20, "num_episodes_lifetime": 380, "episode_return_min": -14.5, "env_step_timer": 0.00019806226703010112, "env_to_module_sum_episodes_length_out": 10.368238394574323, "num_agent_steps_sampled": {"default_agent": 400}, "env_to_module_sum_episodes_length_in": 10.368238394574323, "episode_return_max": 12.5, "agent_episode_returns_mean": {"default_agent": -0.4}, "num_module_steps_sampled_lifetime": {"default_policy": 7600}, "weights_seq_no": 19.0, "env_reset_timer": 0.0002127841182073791, "episode_len_mean": 20.0, "num_module_steps_sampled": {"default_policy": 400}, "episode_return_mean": -0.4, "rlmodule_inference_timer": 0.00030168674000850555, "num_env_steps_sampled": 400, "time_between_sampling": 1.6440424298667227}, "num_healthy_workers": 1, "actor_manager_num_outstanding_async_reqs": 0, "num_remote_worker_restarts": 0}, "num_env_steps_sampled_lifetime": -10487500.0, "fault_tolerance": {"num_healthy_workers": 0, "num_remote_worker_restarts": 0}, "env_runner_group": {"actor_manager_num_outstanding_async_reqs": 0}, "done": false, "training_iteration": 19, "trial_id": "43bd0_00000", "date": "2025-08-11_19-24-55", "timestamp": 1754933095, "time_this_iter_s": 4.7755796909332275, "time_total_s": 36.36719751358032, "pid": 14505, "hostname": "Mac", "node_ip": "127.0.0.1", "config": {"exploration_config": {}, "extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "placement_strategy": "PACK", "num_gpus": 0, "_fake_gpus": false, "num_cpus_for_main_process": 2, "eager_tracing": true, "eager_max_retraces": 20, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "torch_compile_learner": false, "torch_compile_learner_what_to_compile": "forward_train", "torch_compile_learner_dynamo_backend": "aot_eager", "torch_compile_learner_dynamo_mode": null, "torch_compile_worker": false, "torch_compile_worker_dynamo_backend": "aot_eager", "torch_compile_worker_dynamo_mode": null, "torch_ddp_kwargs": {}, "torch_skip_nan_gradients": false, "env": "Umbrella", "env_config": {}, "observation_space": null, "action_space": null, "clip_rewards": null, "normalize_actions": true, "clip_actions": false, "_is_atari": null, "disable_env_checking": false, "render_env": false, "action_mask_key": "action_mask", "env_runner_cls": null, "num_env_runners": 0, "create_local_env_runner": true, "num_envs_per_env_runner": 1, "gym_env_vectorize_mode": "SYNC", "num_cpus_per_env_runner": 1, "num_gpus_per_env_runner": 0, "custom_resources_per_env_runner": {}, "validate_env_runners_after_construction": true, "episodes_to_numpy": true, "max_requests_in_flight_per_env_runner": 1, "sample_timeout_s": 60.0, "_env_to_module_connector": null, "add_default_connectors_to_env_to_module_pipeline": true, "_module_to_env_connector": null, "add_default_connectors_to_module_to_env_pipeline": true, "merge_env_runner_states": "training_only", "broadcast_env_runner_states": true, "episode_lookback_horizon": 1, "rollout_fragment_length": "auto", "batch_mode": "complete_episodes", "compress_observations": false, "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "enable_tf1_exec_eagerly": false, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "preprocessor_pref": "deepmind", "observation_filter": "NoFilter", "update_worker_filter_stats": true, "use_worker_filter_stats": true, "sampler_perf_stats_ema_coef": null, "_is_online": true, "num_learners": 0, "num_gpus_per_learner": 0, "num_cpus_per_learner": "auto", "num_aggregator_actors_per_learner": 0, "max_requests_in_flight_per_aggregator_actor": 3, "local_gpu_idx": 0, "max_requests_in_flight_per_learner": 3, "gamma": 1, "lr": 0.0002847858517, "grad_clip": 0.5, "grad_clip_by": "global_norm", "_train_batch_size_per_learner": 5000, "train_batch_size": 4000, "num_epochs": 1, "minibatch_size": 1000, "shuffle_batch_per_epoch": true, "model": {"fcnet_hiddens": [256, 256], "fcnet_activation": "tanh", "fcnet_weights_initializer": null, "fcnet_weights_initializer_config": null, "fcnet_bias_initializer": null, "fcnet_bias_initializer_config": null, "conv_filters": null, "conv_activation": "relu", "conv_kernel_initializer": null, "conv_kernel_initializer_config": null, "conv_bias_initializer": null, "conv_bias_initializer_config": null, "conv_transpose_kernel_initializer": null, "conv_transpose_kernel_initializer_config": null, "conv_transpose_bias_initializer": null, "conv_transpose_bias_initializer_config": null, "post_fcnet_hiddens": [], "post_fcnet_activation": "relu", "post_fcnet_weights_initializer": null, "post_fcnet_weights_initializer_config": null, "post_fcnet_bias_initializer": null, "post_fcnet_bias_initializer_config": null, "free_log_std": false, "log_std_clip_param": 20.0, "no_final_linear": false, "vf_share_layers": false, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "lstm_weights_initializer": null, "lstm_weights_initializer_config": null, "lstm_bias_initializer": null, "lstm_bias_initializer_config": null, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "attention_use_n_prev_actions": 0, "attention_use_n_prev_rewards": 0, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": null, "custom_model_config": {}, "custom_action_dist": null, "custom_preprocessor": null, "encoder_latent_dim": null, "always_check_shapes": false, "lstm_use_prev_action_reward": -1, "_use_default_native_models": -1, "_disable_preprocessor_api": false, "_disable_action_flattening": false}, "_learner_connector": null, "add_default_connectors_to_learner_pipeline": true, "learner_config_dict": {}, "optimizer": {}, "_learner_class": null, "callbacks_on_algorithm_init": null, "callbacks_on_env_runners_recreated": null, "callbacks_on_offline_eval_runners_recreated": null, "callbacks_on_checkpoint_loaded": null, "callbacks_on_environment_created": null, "callbacks_on_episode_created": null, "callbacks_on_episode_start": null, "callbacks_on_episode_step": null, "callbacks_on_episode_end": null, "callbacks_on_evaluate_start": null, "callbacks_on_evaluate_end": null, "callbacks_on_evaluate_offline_start": null, "callbacks_on_evaluate_offline_end": null, "callbacks_on_sample_end": null, "callbacks_on_train_result": null, "explore": true, "enable_rl_module_and_learner": true, "enable_env_runner_and_connector_v2": true, "_prior_exploration_config": {"type": "StochasticSampling"}, "count_steps_by": "env_steps", "policy_map_capacity": 100, "policy_mapping_fn": "<function AlgorithmConfig.DEFAULT_POLICY_MAPPING_FN at 0x3855e5b20>", "policies_to_train": null, "policy_states_are_swappable": false, "observation_fn": null, "offline_data_class": null, "input_read_method": "read_parquet", "input_read_method_kwargs": {}, "input_read_schema": {}, "input_read_episodes": false, "input_read_sample_batches": false, "input_read_batch_size": null, "input_filesystem": null, "input_filesystem_kwargs": {}, "input_compress_columns": ["obs", "new_obs"], "input_spaces_jsonable": true, "materialize_data": false, "materialize_mapped_data": true, "map_batches_kwargs": {}, "iter_batches_kwargs": {}, "ignore_final_observation": false, "prelearner_class": null, "prelearner_buffer_class": null, "prelearner_buffer_kwargs": {}, "prelearner_module_synch_period": 10, "dataset_num_iters_per_learner": null, "input_config": {}, "actions_in_input_normalized": false, "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_config": {}, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "output_max_rows_per_file": null, "output_write_remaining_data": false, "output_write_method": "write_parquet", "output_write_method_kwargs": {}, "output_filesystem": null, "output_filesystem_kwargs": {}, "output_write_episodes": true, "offline_sampling": false, "evaluation_interval": 1, "evaluation_duration": 20, "evaluation_duration_unit": "episodes", "evaluation_sample_timeout_s": 120.0, "evaluation_auto_duration_min_env_steps_per_sample": 100, "evaluation_auto_duration_max_env_steps_per_sample": 2000, "evaluation_parallel_to_training": false, "evaluation_force_reset_envs_before_iteration": true, "evaluation_config": null, "off_policy_estimation_methods": {}, "ope_split_batch_by_episode": true, "evaluation_num_env_runners": 1, "in_evaluation": false, "sync_filters_on_rollout_workers_timeout_s": 10.0, "offline_evaluation_interval": null, "num_offline_eval_runners": 0, "offline_loss_for_module_fn": null, "offline_evaluation_duration": 1, "offline_evaluation_parallel_to_training": false, "offline_evaluation_timeout_s": 120.0, "num_cpus_per_offline_eval_runner": 1, "num_gpus_per_offline_eval_runner": 0, "custom_resources_per_offline_eval_runner": {}, "restart_failed_offline_eval_runners": true, "ignore_offline_eval_runner_failures": false, "max_num_offline_eval_runner_restarts": 1000, "offline_eval_runner_restore_timeout_s": 1800.0, "max_requests_in_flight_per_offline_eval_runner": 1, "validate_offline_eval_runners_after_construction": true, "offline_eval_runner_health_probe_timeout_s": 30.0, "offline_eval_rl_module_inference_only": false, "broadcast_offline_eval_runner_states": false, "offline_eval_batch_size_per_runner": 256, "dataset_num_iters_per_eval_runner": 1, "keep_per_episode_custom_metrics": false, "metrics_episode_collection_timeout_s": 60.0, "metrics_num_episodes_for_smoothing": 100, "min_time_s_per_iteration": null, "min_train_timesteps_per_iteration": 0, "min_sample_timesteps_per_iteration": 0, "log_gradients": true, "export_native_model_files": false, "checkpoint_trainable_policies_only": false, "logger_creator": null, "logger_config": null, "log_level": "WARN", "log_sys_usage": true, "fake_sampler": false, "seed": 2, "restart_failed_env_runners": true, "ignore_env_runner_failures": false, "max_num_env_runner_restarts": 1000, "delay_between_env_runner_restarts_s": 60.0, "restart_failed_sub_environments": false, "num_consecutive_env_runner_failures_tolerance": 100, "env_runner_health_probe_timeout_s": 30.0, "env_runner_restore_timeout_s": 1800.0, "_model_config": {}, "_rl_module_spec": "RLModuleSpec(module_class=None, observation_space=None, action_space=None, inference_only=False, learner_only=False, model_config=DefaultModelConfig(fcnet_hiddens=[60, 90], fcnet_activation='tanh', fcnet_kernel_initializer=None, fcnet_kernel_initializer_kwargs=None, fcnet_bias_initializer=None, fcnet_bias_initializer_kwargs=None, conv_filters=None, conv_activation='relu', conv_kernel_initializer=None, conv_kernel_initializer_kwargs=None, conv_bias_initializer=None, conv_bias_initializer_kwargs=None, head_fcnet_hiddens=[], head_fcnet_activation='relu', head_fcnet_kernel_initializer=None, head_fcnet_kernel_initializer_kwargs=None, head_fcnet_bias_initializer=None, head_fcnet_bias_initializer_kwargs=None, free_log_std=False, log_std_clip_param=20.0, vf_share_layers=True, use_lstm=False, max_seq_len=20, lstm_cell_size=256, lstm_use_prev_action=False, lstm_use_prev_reward=False, lstm_kernel_initializer=None, lstm_kernel_initializer_kwargs=None, lstm_bias_initializer=None, lstm_bias_initializer_kwargs=None), catalog_class=None, load_state_path=None, model_config_dict=None)", "algorithm_config_overrides_per_module": {}, "_per_module_overrides": {}, "_validate_config": true, "_use_msgpack_checkpoints": false, "_torch_grad_scaler_class": null, "_torch_lr_scheduler_classes": null, "_tf_policy_handles_more_than_one_loss": false, "_disable_preprocessor_api": false, "_disable_action_flattening": false, "_disable_initialize_loss_from_dummy_batch": false, "_dont_auto_sync_env_runner_states": false, "env_task_fn": -1, "enable_connectors": -1, "simple_optimizer": false, "policy_map_cache": -1, "worker_cls": -1, "synchronize_filters": -1, "enable_async_evaluation": -1, "custom_async_evaluation_function": -1, "_enable_rl_module_api": -1, "auto_wrap_old_gym_envs": -1, "always_attach_evaluation_results": -1, "replay_sequence_length": null, "_disable_execution_plan_api": -1, "use_critic": true, "use_gae": true, "use_kl_loss": true, "kl_coeff": 0.7464963036515, "kl_target": 0.0270990929592, "vf_loss_coeff": 0.6688075857018, "entropy_coeff": 0.0090570820258, "clip_param": 0.1221781641624, "vf_clip_param": 0.1027808522125, "entropy_coeff_schedule": null, "lr_schedule": null, "sgd_minibatch_size": -1, "vf_share_layers": -1, "__stdout_file__": null, "__stderr_file__": null, "lambda": 0.9099046732075, "input": "sampler", "policies": {"default_policy": [null, null, null, null]}, "callbacks": "<class 'ray.rllib.callbacks.callbacks.RLlibCallback'>", "create_env_on_driver": false, "custom_eval_function": null, "framework": "torch"}, "time_since_restore": 36.36719751358032, "iterations_since_restore": 19, "perf": {"cpu_util_percent": 76.37142857142858, "ram_util_percent": 82.58571428571429}}
{"timers": {"training_iteration": 1.676610079300722, "restore_env_runners": 1.1853551177316978e-05, "training_step": 1.6764572906256139, "env_runner_sampling_timer": 1.5489480591204734, "learner_update_timer": 0.12434138630865371, "synch_weights": 0.0006159316873709637, "restore_eval_env_runners": 9.758313355114296e-06, "evaluation_iteration": 0.11998566328453945, "synch_eval_env_connectors": 0.00013824382343382327, "synch_env_connectors": 4.424530480299608e-06}, "env_runners": {"env_step_timer": 4.861657698799386e-05, "num_agent_steps_sampled_lifetime": {"default_agent": -11105000.0}, "episode_duration_sec_mean": 0.016569701492320742, "env_to_module_connector": {"timers": {"connectors": {"add_time_dim_to_batch_and_zero_pad": 6.412752181649792e-06, "add_observations_from_episodes_to_batch": 9.00997335401091e-06, "batch_individual_items": 2.839170703684975e-05, "add_states_from_episodes_to_batch": 3.768157932205509e-06, "numpy_to_tensor": 3.170564269167381e-05}}, "connector_pipeline_timer": 0.00013229376961066953}, "num_env_steps_sampled_lifetime": -11105000.0, "episode_return_mean": 6.5, "module_to_env_connector": {"timers": {"connectors": {"tensor_to_numpy": 4.505896542677936e-05, "normalize_and_clip_actions": 2.6847549114520065e-05, "listify_data_for_vector_env": 3.374693236878737e-05, "remove_single_ts_time_rank_from_batch": 2.1597867474354655e-06, "get_actions": 0.0001664788252385715, "un_batch_to_individual_items": 1.5987748705109508e-05}}, "connector_pipeline_timer": 0.00035958514788079343}, "weights_seq_no": 19.0, "env_to_module_sum_episodes_length_out": 10.36823839457432, "episode_len_min": 20, "num_agent_steps_sampled": {"default_agent": 5000.0}, "env_reset_timer": 0.00012286865875635905, "rlmodule_inference_timer": 0.00011835797836714893, "num_env_steps_sampled": 5000.0, "env_to_module_sum_episodes_length_in": 10.36823839457432, "num_module_steps_sampled": {"default_policy": 5000.0}, "episode_len_mean": 20.0, "episode_len_max": 20, "num_episodes": 250.0, "num_episodes_lifetime": -555250.0, "time_between_sampling": 0.008277316705106215, "episode_return_min": -11.5, "agent_episode_returns_mean": {"default_agent": 6.5}, "episode_return_max": 8.5, "num_module_steps_sampled_lifetime": {"default_policy": -11105000.0}, "module_episode_returns_mean": {"default_policy": 6.5}, "sample": 0.01448018912565039, "num_env_steps_sampled_lifetime_throughput": 1784.5820287982515}, "learners": {"__all_modules__": {"learner_connector": {"timers": {"connectors": {"add_states_from_episodes_to_batch": 3.719239337164406e-06, "numpy_to_tensor": 8.545840459789152e-05, "batch_individual_items": 0.04361093156290192, "add_columns_from_episodes_to_train_batch": 0.03738527368099612, "add_time_dim_to_batch_and_zero_pad": 1.3216306175122368e-05, "add_observations_from_episodes_to_batch": 0.0008723874718465207, "add_one_ts_to_episodes_and_truncate": 0.008884593969041992, "general_advantage_estimation": 0.007426890928579008}}, "connector_pipeline_timer": 0.09843556845998525}, "num_env_steps_trained": 31500, "learner_connector_sum_episodes_length_out": 5250.0, "num_non_trainable_parameters": 0, "num_module_steps_trained_lifetime": 120000, "learner_connector_sum_episodes_length_in": 5000.0, "num_env_steps_trained_lifetime": 630000, "num_module_steps_trained": 6000, "num_trainable_parameters": 6003, "num_env_steps_trained_lifetime_throughput": 2046974.096419161, "num_module_steps_trained_throughput": 391016.3083973121, "num_module_steps_trained_lifetime_throughput": 390547.0354860443}, "default_policy": {"num_module_steps_trained_lifetime": 120000, "gradients_default_optimizer_global_norm": 0.04194527864456177, "total_loss": 0.03251373767852783, "weights_seq_no": 20.0, "diff_num_grad_updates_vs_sampler_policy": 1.0, "num_module_steps_trained": 6000, "vf_loss": 0.10278083384037018, "entropy": 0.37009090185165405, "vf_explained_var": 0.004387497901916504, "curr_kl_coeff": 7.119143674572115e-07, "default_optimizer_learning_rate": 0.0002847858517, "num_trainable_parameters": 6003, "module_train_batch_size_mean": 1000.0, "vf_loss_unclipped": 27.988771438598633, "policy_loss": -0.0328749418258667, "mean_kl_loss": 0.001483448431827128, "curr_entropy_coeff": 0.0090570820258, "num_module_steps_trained_lifetime_throughput": 391040.3702625979}}, "num_training_step_calls_per_iteration": 1, "evaluation": {"env_runners": {"num_episodes": 20, "env_to_module_connector": {"timers": {"connectors": {"add_states_from_episodes_to_batch": 3.0846132588323726e-06, "numpy_to_tensor": 3.216049146312464e-05, "batch_individual_items": 1.6019152376310544e-05, "add_time_dim_to_batch_and_zero_pad": 8.145172792145642e-06, "add_observations_from_episodes_to_batch": 9.74602244361774e-06}}, "connector_pipeline_timer": 0.00011409262237904941}, "sample": 0.11594360088874187, "module_to_env_connector": {"timers": {"connectors": {"get_actions": 0.00017608850248643912, "remove_single_ts_time_rank_from_batch": 1.1214738409504084e-06, "normalize_and_clip_actions": 2.9977168226418633e-05, "un_batch_to_individual_items": 1.6993544920749116e-05, "tensor_to_numpy": 5.4760146262563283e-05, "listify_data_for_vector_env": 3.0879541450252784e-05}}, "connector_pipeline_timer": 0.00038514282921912007}, "episode_duration_sec_mean": 0.01365452329395339, "module_episode_returns_mean": {"default_policy": 0.0}, "num_env_steps_sampled_lifetime": 100400, "episode_len_min": 20, "num_agent_steps_sampled_lifetime": {"default_agent": 8000}, "episode_len_max": 20, "num_episodes_lifetime": 400, "episode_return_min": -12.5, "env_step_timer": 5.285236101192659e-05, "env_to_module_sum_episodes_length_out": 10.368238394574323, "num_agent_steps_sampled": {"default_agent": 400}, "env_to_module_sum_episodes_length_in": 10.368238394574323, "episode_return_max": 12.5, "agent_episode_returns_mean": {"default_agent": 0.0}, "num_module_steps_sampled_lifetime": {"default_policy": 8000}, "weights_seq_no": 20.0, "env_reset_timer": 0.00021305544779654648, "episode_len_mean": 20.0, "num_module_steps_sampled": {"default_policy": 400}, "episode_return_mean": 0.0, "rlmodule_inference_timer": 0.00012006994454433782, "num_env_steps_sampled": 400, "time_between_sampling": 1.6824079439076147}, "num_healthy_workers": 1, "actor_manager_num_outstanding_async_reqs": 0, "num_remote_worker_restarts": 0}, "num_env_steps_sampled_lifetime": -11105000.0, "fault_tolerance": {"num_healthy_workers": 0, "num_remote_worker_restarts": 0}, "env_runner_group": {"actor_manager_num_outstanding_async_reqs": 0}, "done": true, "training_iteration": 20, "trial_id": "43bd0_00000", "date": "2025-08-11_19-25-01", "timestamp": 1754933101, "time_this_iter_s": 5.815950870513916, "time_total_s": 42.18314838409424, "pid": 14505, "hostname": "Mac", "node_ip": "127.0.0.1", "config": {"exploration_config": {}, "extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "placement_strategy": "PACK", "num_gpus": 0, "_fake_gpus": false, "num_cpus_for_main_process": 2, "eager_tracing": true, "eager_max_retraces": 20, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "torch_compile_learner": false, "torch_compile_learner_what_to_compile": "forward_train", "torch_compile_learner_dynamo_backend": "aot_eager", "torch_compile_learner_dynamo_mode": null, "torch_compile_worker": false, "torch_compile_worker_dynamo_backend": "aot_eager", "torch_compile_worker_dynamo_mode": null, "torch_ddp_kwargs": {}, "torch_skip_nan_gradients": false, "env": "Umbrella", "env_config": {}, "observation_space": null, "action_space": null, "clip_rewards": null, "normalize_actions": true, "clip_actions": false, "_is_atari": null, "disable_env_checking": false, "render_env": false, "action_mask_key": "action_mask", "env_runner_cls": null, "num_env_runners": 0, "create_local_env_runner": true, "num_envs_per_env_runner": 1, "gym_env_vectorize_mode": "SYNC", "num_cpus_per_env_runner": 1, "num_gpus_per_env_runner": 0, "custom_resources_per_env_runner": {}, "validate_env_runners_after_construction": true, "episodes_to_numpy": true, "max_requests_in_flight_per_env_runner": 1, "sample_timeout_s": 60.0, "_env_to_module_connector": null, "add_default_connectors_to_env_to_module_pipeline": true, "_module_to_env_connector": null, "add_default_connectors_to_module_to_env_pipeline": true, "merge_env_runner_states": "training_only", "broadcast_env_runner_states": true, "episode_lookback_horizon": 1, "rollout_fragment_length": "auto", "batch_mode": "complete_episodes", "compress_observations": false, "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "enable_tf1_exec_eagerly": false, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "preprocessor_pref": "deepmind", "observation_filter": "NoFilter", "update_worker_filter_stats": true, "use_worker_filter_stats": true, "sampler_perf_stats_ema_coef": null, "_is_online": true, "num_learners": 0, "num_gpus_per_learner": 0, "num_cpus_per_learner": "auto", "num_aggregator_actors_per_learner": 0, "max_requests_in_flight_per_aggregator_actor": 3, "local_gpu_idx": 0, "max_requests_in_flight_per_learner": 3, "gamma": 1, "lr": 0.0002847858517, "grad_clip": 0.5, "grad_clip_by": "global_norm", "_train_batch_size_per_learner": 5000, "train_batch_size": 4000, "num_epochs": 1, "minibatch_size": 1000, "shuffle_batch_per_epoch": true, "model": {"fcnet_hiddens": [256, 256], "fcnet_activation": "tanh", "fcnet_weights_initializer": null, "fcnet_weights_initializer_config": null, "fcnet_bias_initializer": null, "fcnet_bias_initializer_config": null, "conv_filters": null, "conv_activation": "relu", "conv_kernel_initializer": null, "conv_kernel_initializer_config": null, "conv_bias_initializer": null, "conv_bias_initializer_config": null, "conv_transpose_kernel_initializer": null, "conv_transpose_kernel_initializer_config": null, "conv_transpose_bias_initializer": null, "conv_transpose_bias_initializer_config": null, "post_fcnet_hiddens": [], "post_fcnet_activation": "relu", "post_fcnet_weights_initializer": null, "post_fcnet_weights_initializer_config": null, "post_fcnet_bias_initializer": null, "post_fcnet_bias_initializer_config": null, "free_log_std": false, "log_std_clip_param": 20.0, "no_final_linear": false, "vf_share_layers": false, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "lstm_weights_initializer": null, "lstm_weights_initializer_config": null, "lstm_bias_initializer": null, "lstm_bias_initializer_config": null, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "attention_use_n_prev_actions": 0, "attention_use_n_prev_rewards": 0, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": null, "custom_model_config": {}, "custom_action_dist": null, "custom_preprocessor": null, "encoder_latent_dim": null, "always_check_shapes": false, "lstm_use_prev_action_reward": -1, "_use_default_native_models": -1, "_disable_preprocessor_api": false, "_disable_action_flattening": false}, "_learner_connector": null, "add_default_connectors_to_learner_pipeline": true, "learner_config_dict": {}, "optimizer": {}, "_learner_class": null, "callbacks_on_algorithm_init": null, "callbacks_on_env_runners_recreated": null, "callbacks_on_offline_eval_runners_recreated": null, "callbacks_on_checkpoint_loaded": null, "callbacks_on_environment_created": null, "callbacks_on_episode_created": null, "callbacks_on_episode_start": null, "callbacks_on_episode_step": null, "callbacks_on_episode_end": null, "callbacks_on_evaluate_start": null, "callbacks_on_evaluate_end": null, "callbacks_on_evaluate_offline_start": null, "callbacks_on_evaluate_offline_end": null, "callbacks_on_sample_end": null, "callbacks_on_train_result": null, "explore": true, "enable_rl_module_and_learner": true, "enable_env_runner_and_connector_v2": true, "_prior_exploration_config": {"type": "StochasticSampling"}, "count_steps_by": "env_steps", "policy_map_capacity": 100, "policy_mapping_fn": "<function AlgorithmConfig.DEFAULT_POLICY_MAPPING_FN at 0x3855e5b20>", "policies_to_train": null, "policy_states_are_swappable": false, "observation_fn": null, "offline_data_class": null, "input_read_method": "read_parquet", "input_read_method_kwargs": {}, "input_read_schema": {}, "input_read_episodes": false, "input_read_sample_batches": false, "input_read_batch_size": null, "input_filesystem": null, "input_filesystem_kwargs": {}, "input_compress_columns": ["obs", "new_obs"], "input_spaces_jsonable": true, "materialize_data": false, "materialize_mapped_data": true, "map_batches_kwargs": {}, "iter_batches_kwargs": {}, "ignore_final_observation": false, "prelearner_class": null, "prelearner_buffer_class": null, "prelearner_buffer_kwargs": {}, "prelearner_module_synch_period": 10, "dataset_num_iters_per_learner": null, "input_config": {}, "actions_in_input_normalized": false, "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_config": {}, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "output_max_rows_per_file": null, "output_write_remaining_data": false, "output_write_method": "write_parquet", "output_write_method_kwargs": {}, "output_filesystem": null, "output_filesystem_kwargs": {}, "output_write_episodes": true, "offline_sampling": false, "evaluation_interval": 1, "evaluation_duration": 20, "evaluation_duration_unit": "episodes", "evaluation_sample_timeout_s": 120.0, "evaluation_auto_duration_min_env_steps_per_sample": 100, "evaluation_auto_duration_max_env_steps_per_sample": 2000, "evaluation_parallel_to_training": false, "evaluation_force_reset_envs_before_iteration": true, "evaluation_config": null, "off_policy_estimation_methods": {}, "ope_split_batch_by_episode": true, "evaluation_num_env_runners": 1, "in_evaluation": false, "sync_filters_on_rollout_workers_timeout_s": 10.0, "offline_evaluation_interval": null, "num_offline_eval_runners": 0, "offline_loss_for_module_fn": null, "offline_evaluation_duration": 1, "offline_evaluation_parallel_to_training": false, "offline_evaluation_timeout_s": 120.0, "num_cpus_per_offline_eval_runner": 1, "num_gpus_per_offline_eval_runner": 0, "custom_resources_per_offline_eval_runner": {}, "restart_failed_offline_eval_runners": true, "ignore_offline_eval_runner_failures": false, "max_num_offline_eval_runner_restarts": 1000, "offline_eval_runner_restore_timeout_s": 1800.0, "max_requests_in_flight_per_offline_eval_runner": 1, "validate_offline_eval_runners_after_construction": true, "offline_eval_runner_health_probe_timeout_s": 30.0, "offline_eval_rl_module_inference_only": false, "broadcast_offline_eval_runner_states": false, "offline_eval_batch_size_per_runner": 256, "dataset_num_iters_per_eval_runner": 1, "keep_per_episode_custom_metrics": false, "metrics_episode_collection_timeout_s": 60.0, "metrics_num_episodes_for_smoothing": 100, "min_time_s_per_iteration": null, "min_train_timesteps_per_iteration": 0, "min_sample_timesteps_per_iteration": 0, "log_gradients": true, "export_native_model_files": false, "checkpoint_trainable_policies_only": false, "logger_creator": null, "logger_config": null, "log_level": "WARN", "log_sys_usage": true, "fake_sampler": false, "seed": 2, "restart_failed_env_runners": true, "ignore_env_runner_failures": false, "max_num_env_runner_restarts": 1000, "delay_between_env_runner_restarts_s": 60.0, "restart_failed_sub_environments": false, "num_consecutive_env_runner_failures_tolerance": 100, "env_runner_health_probe_timeout_s": 30.0, "env_runner_restore_timeout_s": 1800.0, "_model_config": {}, "_rl_module_spec": "RLModuleSpec(module_class=None, observation_space=None, action_space=None, inference_only=False, learner_only=False, model_config=DefaultModelConfig(fcnet_hiddens=[60, 90], fcnet_activation='tanh', fcnet_kernel_initializer=None, fcnet_kernel_initializer_kwargs=None, fcnet_bias_initializer=None, fcnet_bias_initializer_kwargs=None, conv_filters=None, conv_activation='relu', conv_kernel_initializer=None, conv_kernel_initializer_kwargs=None, conv_bias_initializer=None, conv_bias_initializer_kwargs=None, head_fcnet_hiddens=[], head_fcnet_activation='relu', head_fcnet_kernel_initializer=None, head_fcnet_kernel_initializer_kwargs=None, head_fcnet_bias_initializer=None, head_fcnet_bias_initializer_kwargs=None, free_log_std=False, log_std_clip_param=20.0, vf_share_layers=True, use_lstm=False, max_seq_len=20, lstm_cell_size=256, lstm_use_prev_action=False, lstm_use_prev_reward=False, lstm_kernel_initializer=None, lstm_kernel_initializer_kwargs=None, lstm_bias_initializer=None, lstm_bias_initializer_kwargs=None), catalog_class=None, load_state_path=None, model_config_dict=None)", "algorithm_config_overrides_per_module": {}, "_per_module_overrides": {}, "_validate_config": true, "_use_msgpack_checkpoints": false, "_torch_grad_scaler_class": null, "_torch_lr_scheduler_classes": null, "_tf_policy_handles_more_than_one_loss": false, "_disable_preprocessor_api": false, "_disable_action_flattening": false, "_disable_initialize_loss_from_dummy_batch": false, "_dont_auto_sync_env_runner_states": false, "env_task_fn": -1, "enable_connectors": -1, "simple_optimizer": false, "policy_map_cache": -1, "worker_cls": -1, "synchronize_filters": -1, "enable_async_evaluation": -1, "custom_async_evaluation_function": -1, "_enable_rl_module_api": -1, "auto_wrap_old_gym_envs": -1, "always_attach_evaluation_results": -1, "replay_sequence_length": null, "_disable_execution_plan_api": -1, "use_critic": true, "use_gae": true, "use_kl_loss": true, "kl_coeff": 0.7464963036515, "kl_target": 0.0270990929592, "vf_loss_coeff": 0.6688075857018, "entropy_coeff": 0.0090570820258, "clip_param": 0.1221781641624, "vf_clip_param": 0.1027808522125, "entropy_coeff_schedule": null, "lr_schedule": null, "sgd_minibatch_size": -1, "vf_share_layers": -1, "__stdout_file__": null, "__stderr_file__": null, "lambda": 0.9099046732075, "input": "sampler", "policies": {"default_policy": [null, null, null, null]}, "callbacks": "<class 'ray.rllib.callbacks.callbacks.RLlibCallback'>", "create_env_on_driver": false, "custom_eval_function": null, "framework": "torch"}, "time_since_restore": 42.18314838409424, "iterations_since_restore": 20, "perf": {"cpu_util_percent": 91.39999999999999, "ram_util_percent": 81.7625}}
