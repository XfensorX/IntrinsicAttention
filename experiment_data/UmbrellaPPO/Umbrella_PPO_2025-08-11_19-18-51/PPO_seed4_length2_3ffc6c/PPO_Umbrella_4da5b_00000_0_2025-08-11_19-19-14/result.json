{"timers": {"training_iteration": 1.9042692079674453, "restore_env_runners": 8.091691415756941e-05, "training_step": 1.9039341249736026, "env_runner_sampling_timer": 1.7902349589858204, "learner_update_timer": 0.1102154590189457, "synch_weights": 0.0006070419913157821}, "env_runners": {"env_to_module_connector": {"connector_pipeline_timer": 5.839640893391595e-05, "timers": {"connectors": {"add_time_dim_to_batch_and_zero_pad": 3.2305570992344604e-06, "batch_individual_items": 1.0297848121977389e-05, "numpy_to_tensor": 1.1682747980440488e-05, "add_observations_from_episodes_to_batch": 3.775446381624343e-06, "add_states_from_episodes_to_batch": 2.0996419798210325e-06}}}, "env_step_timer": 2.0898218649996748e-05, "num_agent_steps_sampled_lifetime": {"default_agent": 627500.0}, "env_to_module_sum_episodes_length_out": 10.191744832559449, "module_to_env_connector": {"timers": {"connectors": {"normalize_and_clip_actions": 1.6087950595836774e-05, "tensor_to_numpy": 1.6974933501343947e-05, "remove_single_ts_time_rank_from_batch": 7.063096408527114e-07, "un_batch_to_individual_items": 6.641925195844225e-06, "get_actions": 6.395010747033117e-05, "listify_data_for_vector_env": 1.4370882469129861e-05}}, "connector_pipeline_timer": 0.00014964197046170825}, "num_agent_steps_sampled": {"default_agent": 5000.0}, "module_episode_returns_mean": {"default_policy": 2.899999999999998}, "env_reset_timer": 0.0005477669544339112, "episode_return_max": 12.5, "sample": 0.014921858561609921, "env_to_module_sum_episodes_length_in": 10.191744832559449, "num_module_steps_sampled_lifetime": {"default_policy": 627500.0}, "episode_return_mean": 2.899999999999998, "episode_duration_sec_mean": 0.006005428486038, "num_env_steps_sampled": 5000.0, "num_episodes": 250.0, "episode_len_mean": 20.0, "rlmodule_inference_timer": 6.371085776123578e-05, "episode_len_min": 20, "episode_len_max": 20, "agent_episode_returns_mean": {"default_agent": 2.899999999999998}, "num_module_steps_sampled": {"default_policy": 5000.0}, "num_episodes_lifetime": 31375.0, "num_env_steps_sampled_lifetime": 627500.0, "weights_seq_no": 0.0, "episode_return_min": -7.5, "time_between_sampling": 0.0007412656296459067, "num_env_steps_sampled_lifetime_throughput": 2919.442217568403}, "learners": {"default_policy": {"curr_kl_coeff": 0.3732481598854065, "gradients_default_optimizer_global_norm": 0.10145387798547745, "vf_loss": 0.10070119053125381, "total_loss": -0.016456305980682373, "num_module_steps_trained": 6000, "diff_num_grad_updates_vs_sampler_policy": 1.0, "module_train_batch_size_mean": 1000.0, "entropy": 0.6919029951095581, "num_module_steps_trained_lifetime": 6000, "curr_entropy_coeff": 0.0090570820258, "vf_loss_unclipped": 28.695228576660156, "weights_seq_no": 1.0, "default_optimizer_learning_rate": 0.0002847858517, "vf_explained_var": 0.012743055820465088, "mean_kl_loss": 5.3182855481281877e-05, "num_trainable_parameters": 6003, "policy_loss": -0.07757909595966339, "num_module_steps_trained_lifetime_throughput": 343357.14094240195}, "__all_modules__": {"learner_connector": {"timers": {"connectors": {"numpy_to_tensor": 6.13329466432333e-05, "batch_individual_items": 0.030602750019170344, "add_columns_from_episodes_to_train_batch": 0.03404612501617521, "add_time_dim_to_batch_and_zero_pad": 9.792041964828968e-06, "add_one_ts_to_episodes_and_truncate": 0.0075797089375555515, "add_observations_from_episodes_to_batch": 0.0008087089518085122, "general_advantage_estimation": 0.00685712497215718, "add_states_from_episodes_to_batch": 3.5830307751893997e-06}}, "connector_pipeline_timer": 0.08007704210467637}, "num_env_steps_trained": 31500, "num_env_steps_trained_lifetime": 31500, "learner_connector_sum_episodes_length_out": 5250, "learner_connector_sum_episodes_length_in": 5000, "num_module_steps_trained_lifetime": 6000, "num_non_trainable_parameters": 0, "num_module_steps_trained": 6000, "num_trainable_parameters": 6003, "num_env_steps_trained_lifetime_throughput": 1790188.83633881, "num_module_steps_trained_throughput": 342504.30303876015, "num_module_steps_trained_lifetime_throughput": 342023.6204067568}}, "num_training_step_calls_per_iteration": 1, "num_env_steps_sampled_lifetime": 627500.0, "evaluation": {"env_runners": {"sample": 0.10698050004430115, "env_to_module_sum_episodes_length_in": 10.216013141322508, "num_module_steps_sampled": {"default_policy": 400}, "module_to_env_connector": {"timers": {"connectors": {"tensor_to_numpy": 1.653001107659897e-05, "remove_single_ts_time_rank_from_batch": 6.725583937648538e-07, "listify_data_for_vector_env": 1.1251801564007156e-05, "normalize_and_clip_actions": 1.1700834481433239e-05, "get_actions": 4.74747112582984e-05, "un_batch_to_individual_items": 5.555217250419938e-06}}, "connector_pipeline_timer": 0.00011981383595337132}, "rlmodule_inference_timer": 3.5121273893071415e-05, "env_to_module_connector": {"timers": {"connectors": {"add_time_dim_to_batch_and_zero_pad": 2.5940841520256558e-06, "numpy_to_tensor": 8.922582842788642e-06, "add_states_from_episodes_to_batch": 1.6994514919071518e-06, "batch_individual_items": 6.7301460808411635e-06, "add_observations_from_episodes_to_batch": 3.5399110249140353e-06}}, "connector_pipeline_timer": 4.841575525004981e-05}, "episode_len_max": 20, "num_agent_steps_sampled_lifetime": {"default_agent": 400}, "num_episodes_lifetime": 20, "episode_return_min": -16.5, "env_step_timer": 1.5770594819368107e-05, "env_to_module_sum_episodes_length_out": 10.216013141322508, "num_env_steps_sampled": 400, "episode_len_mean": 20.0, "num_agent_steps_sampled": {"default_agent": 400}, "num_env_steps_sampled_lifetime": 5400, "weights_seq_no": 1.0, "module_episode_returns_mean": {"default_policy": 1.15}, "num_module_steps_sampled_lifetime": {"default_policy": 400}, "num_episodes": 20, "episode_len_min": 20, "env_reset_timer": 0.0005591249791905284, "episode_return_max": 12.5, "agent_episode_returns_mean": {"default_agent": 1.15}, "episode_return_mean": 1.15, "episode_duration_sec_mean": 0.0048258375143632294}, "num_healthy_workers": 1, "actor_manager_num_outstanding_async_reqs": 0, "num_remote_worker_restarts": 0}, "fault_tolerance": {"num_healthy_workers": 0, "num_remote_worker_restarts": 0}, "env_runner_group": {"actor_manager_num_outstanding_async_reqs": 0}, "done": false, "training_iteration": 1, "trial_id": "4da5b_00000", "date": "2025-08-11_19-21-37", "timestamp": 1754932897, "time_this_iter_s": 2.0250890254974365, "time_total_s": 2.0250890254974365, "pid": 14327, "hostname": "Mac", "node_ip": "127.0.0.1", "config": {"exploration_config": {}, "extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "placement_strategy": "PACK", "num_gpus": 0, "_fake_gpus": false, "num_cpus_for_main_process": 2, "eager_tracing": true, "eager_max_retraces": 20, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "torch_compile_learner": false, "torch_compile_learner_what_to_compile": "forward_train", "torch_compile_learner_dynamo_backend": "aot_eager", "torch_compile_learner_dynamo_mode": null, "torch_compile_worker": false, "torch_compile_worker_dynamo_backend": "aot_eager", "torch_compile_worker_dynamo_mode": null, "torch_ddp_kwargs": {}, "torch_skip_nan_gradients": false, "env": "Umbrella", "env_config": {}, "observation_space": null, "action_space": null, "clip_rewards": null, "normalize_actions": true, "clip_actions": false, "_is_atari": null, "disable_env_checking": false, "render_env": false, "action_mask_key": "action_mask", "env_runner_cls": null, "num_env_runners": 0, "create_local_env_runner": true, "num_envs_per_env_runner": 1, "gym_env_vectorize_mode": "SYNC", "num_cpus_per_env_runner": 1, "num_gpus_per_env_runner": 0, "custom_resources_per_env_runner": {}, "validate_env_runners_after_construction": true, "episodes_to_numpy": true, "max_requests_in_flight_per_env_runner": 1, "sample_timeout_s": 60.0, "_env_to_module_connector": null, "add_default_connectors_to_env_to_module_pipeline": true, "_module_to_env_connector": null, "add_default_connectors_to_module_to_env_pipeline": true, "merge_env_runner_states": "training_only", "broadcast_env_runner_states": true, "episode_lookback_horizon": 1, "rollout_fragment_length": "auto", "batch_mode": "complete_episodes", "compress_observations": false, "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "enable_tf1_exec_eagerly": false, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "preprocessor_pref": "deepmind", "observation_filter": "NoFilter", "update_worker_filter_stats": true, "use_worker_filter_stats": true, "sampler_perf_stats_ema_coef": null, "_is_online": true, "num_learners": 0, "num_gpus_per_learner": 0, "num_cpus_per_learner": "auto", "num_aggregator_actors_per_learner": 0, "max_requests_in_flight_per_aggregator_actor": 3, "local_gpu_idx": 0, "max_requests_in_flight_per_learner": 3, "gamma": 1, "lr": 0.0002847858517, "grad_clip": 0.5, "grad_clip_by": "global_norm", "_train_batch_size_per_learner": 5000, "train_batch_size": 4000, "num_epochs": 1, "minibatch_size": 1000, "shuffle_batch_per_epoch": true, "model": {"fcnet_hiddens": [256, 256], "fcnet_activation": "tanh", "fcnet_weights_initializer": null, "fcnet_weights_initializer_config": null, "fcnet_bias_initializer": null, "fcnet_bias_initializer_config": null, "conv_filters": null, "conv_activation": "relu", "conv_kernel_initializer": null, "conv_kernel_initializer_config": null, "conv_bias_initializer": null, "conv_bias_initializer_config": null, "conv_transpose_kernel_initializer": null, "conv_transpose_kernel_initializer_config": null, "conv_transpose_bias_initializer": null, "conv_transpose_bias_initializer_config": null, "post_fcnet_hiddens": [], "post_fcnet_activation": "relu", "post_fcnet_weights_initializer": null, "post_fcnet_weights_initializer_config": null, "post_fcnet_bias_initializer": null, "post_fcnet_bias_initializer_config": null, "free_log_std": false, "log_std_clip_param": 20.0, "no_final_linear": false, "vf_share_layers": false, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "lstm_weights_initializer": null, "lstm_weights_initializer_config": null, "lstm_bias_initializer": null, "lstm_bias_initializer_config": null, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "attention_use_n_prev_actions": 0, "attention_use_n_prev_rewards": 0, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": null, "custom_model_config": {}, "custom_action_dist": null, "custom_preprocessor": null, "encoder_latent_dim": null, "always_check_shapes": false, "lstm_use_prev_action_reward": -1, "_use_default_native_models": -1, "_disable_preprocessor_api": false, "_disable_action_flattening": false}, "_learner_connector": null, "add_default_connectors_to_learner_pipeline": true, "learner_config_dict": {}, "optimizer": {}, "_learner_class": null, "callbacks_on_algorithm_init": null, "callbacks_on_env_runners_recreated": null, "callbacks_on_offline_eval_runners_recreated": null, "callbacks_on_checkpoint_loaded": null, "callbacks_on_environment_created": null, "callbacks_on_episode_created": null, "callbacks_on_episode_start": null, "callbacks_on_episode_step": null, "callbacks_on_episode_end": null, "callbacks_on_evaluate_start": null, "callbacks_on_evaluate_end": null, "callbacks_on_evaluate_offline_start": null, "callbacks_on_evaluate_offline_end": null, "callbacks_on_sample_end": null, "callbacks_on_train_result": null, "explore": true, "enable_rl_module_and_learner": true, "enable_env_runner_and_connector_v2": true, "_prior_exploration_config": {"type": "StochasticSampling"}, "count_steps_by": "env_steps", "policy_map_capacity": 100, "policy_mapping_fn": "<function AlgorithmConfig.DEFAULT_POLICY_MAPPING_FN at 0x383de9b20>", "policies_to_train": null, "policy_states_are_swappable": false, "observation_fn": null, "offline_data_class": null, "input_read_method": "read_parquet", "input_read_method_kwargs": {}, "input_read_schema": {}, "input_read_episodes": false, "input_read_sample_batches": false, "input_read_batch_size": null, "input_filesystem": null, "input_filesystem_kwargs": {}, "input_compress_columns": ["obs", "new_obs"], "input_spaces_jsonable": true, "materialize_data": false, "materialize_mapped_data": true, "map_batches_kwargs": {}, "iter_batches_kwargs": {}, "ignore_final_observation": false, "prelearner_class": null, "prelearner_buffer_class": null, "prelearner_buffer_kwargs": {}, "prelearner_module_synch_period": 10, "dataset_num_iters_per_learner": null, "input_config": {}, "actions_in_input_normalized": false, "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_config": {}, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "output_max_rows_per_file": null, "output_write_remaining_data": false, "output_write_method": "write_parquet", "output_write_method_kwargs": {}, "output_filesystem": null, "output_filesystem_kwargs": {}, "output_write_episodes": true, "offline_sampling": false, "evaluation_interval": 1, "evaluation_duration": 20, "evaluation_duration_unit": "episodes", "evaluation_sample_timeout_s": 120.0, "evaluation_auto_duration_min_env_steps_per_sample": 100, "evaluation_auto_duration_max_env_steps_per_sample": 2000, "evaluation_parallel_to_training": false, "evaluation_force_reset_envs_before_iteration": true, "evaluation_config": null, "off_policy_estimation_methods": {}, "ope_split_batch_by_episode": true, "evaluation_num_env_runners": 1, "in_evaluation": false, "sync_filters_on_rollout_workers_timeout_s": 10.0, "offline_evaluation_interval": null, "num_offline_eval_runners": 0, "offline_loss_for_module_fn": null, "offline_evaluation_duration": 1, "offline_evaluation_parallel_to_training": false, "offline_evaluation_timeout_s": 120.0, "num_cpus_per_offline_eval_runner": 1, "num_gpus_per_offline_eval_runner": 0, "custom_resources_per_offline_eval_runner": {}, "restart_failed_offline_eval_runners": true, "ignore_offline_eval_runner_failures": false, "max_num_offline_eval_runner_restarts": 1000, "offline_eval_runner_restore_timeout_s": 1800.0, "max_requests_in_flight_per_offline_eval_runner": 1, "validate_offline_eval_runners_after_construction": true, "offline_eval_runner_health_probe_timeout_s": 30.0, "offline_eval_rl_module_inference_only": false, "broadcast_offline_eval_runner_states": false, "offline_eval_batch_size_per_runner": 256, "dataset_num_iters_per_eval_runner": 1, "keep_per_episode_custom_metrics": false, "metrics_episode_collection_timeout_s": 60.0, "metrics_num_episodes_for_smoothing": 100, "min_time_s_per_iteration": null, "min_train_timesteps_per_iteration": 0, "min_sample_timesteps_per_iteration": 0, "log_gradients": true, "export_native_model_files": false, "checkpoint_trainable_policies_only": false, "logger_creator": null, "logger_config": null, "log_level": "WARN", "log_sys_usage": true, "fake_sampler": false, "seed": 4, "restart_failed_env_runners": true, "ignore_env_runner_failures": false, "max_num_env_runner_restarts": 1000, "delay_between_env_runner_restarts_s": 60.0, "restart_failed_sub_environments": false, "num_consecutive_env_runner_failures_tolerance": 100, "env_runner_health_probe_timeout_s": 30.0, "env_runner_restore_timeout_s": 1800.0, "_model_config": {}, "_rl_module_spec": "RLModuleSpec(module_class=None, observation_space=None, action_space=None, inference_only=False, learner_only=False, model_config=DefaultModelConfig(fcnet_hiddens=[60, 90], fcnet_activation='tanh', fcnet_kernel_initializer=None, fcnet_kernel_initializer_kwargs=None, fcnet_bias_initializer=None, fcnet_bias_initializer_kwargs=None, conv_filters=None, conv_activation='relu', conv_kernel_initializer=None, conv_kernel_initializer_kwargs=None, conv_bias_initializer=None, conv_bias_initializer_kwargs=None, head_fcnet_hiddens=[], head_fcnet_activation='relu', head_fcnet_kernel_initializer=None, head_fcnet_kernel_initializer_kwargs=None, head_fcnet_bias_initializer=None, head_fcnet_bias_initializer_kwargs=None, free_log_std=False, log_std_clip_param=20.0, vf_share_layers=True, use_lstm=False, max_seq_len=20, lstm_cell_size=256, lstm_use_prev_action=False, lstm_use_prev_reward=False, lstm_kernel_initializer=None, lstm_kernel_initializer_kwargs=None, lstm_bias_initializer=None, lstm_bias_initializer_kwargs=None), catalog_class=None, load_state_path=None, model_config_dict=None)", "algorithm_config_overrides_per_module": {}, "_per_module_overrides": {}, "_validate_config": true, "_use_msgpack_checkpoints": false, "_torch_grad_scaler_class": null, "_torch_lr_scheduler_classes": null, "_tf_policy_handles_more_than_one_loss": false, "_disable_preprocessor_api": false, "_disable_action_flattening": false, "_disable_initialize_loss_from_dummy_batch": false, "_dont_auto_sync_env_runner_states": false, "env_task_fn": -1, "enable_connectors": -1, "simple_optimizer": false, "policy_map_cache": -1, "worker_cls": -1, "synchronize_filters": -1, "enable_async_evaluation": -1, "custom_async_evaluation_function": -1, "_enable_rl_module_api": -1, "auto_wrap_old_gym_envs": -1, "always_attach_evaluation_results": -1, "replay_sequence_length": null, "_disable_execution_plan_api": -1, "use_critic": true, "use_gae": true, "use_kl_loss": true, "kl_coeff": 0.7464963036515, "kl_target": 0.0270990929592, "vf_loss_coeff": 0.6688075857018, "entropy_coeff": 0.0090570820258, "clip_param": 0.1221781641624, "vf_clip_param": 0.1027808522125, "entropy_coeff_schedule": null, "lr_schedule": null, "sgd_minibatch_size": -1, "vf_share_layers": -1, "__stdout_file__": null, "__stderr_file__": null, "lambda": 0.9099046732075, "input": "sampler", "policies": {"default_policy": [null, null, null, null]}, "callbacks": "<class 'ray.rllib.callbacks.callbacks.RLlibCallback'>", "create_env_on_driver": false, "custom_eval_function": null, "framework": "torch"}, "time_since_restore": 2.0250890254974365, "iterations_since_restore": 1, "perf": {"cpu_util_percent": 44.866666666666674, "ram_util_percent": 83.7}}
{"timers": {"training_iteration": 1.9023236546374391, "restore_env_runners": 8.017982472665609e-05, "training_step": 1.9019897174742073, "env_runner_sampling_timer": 1.7875223793962505, "learner_update_timer": 0.11098635192844085, "synch_weights": 0.0006068340712226928, "restore_eval_env_runners": 8.209026418626308e-06, "evaluation_iteration": 0.11913866701070219, "synch_eval_env_connectors": 0.0001300839940086007, "synch_env_connectors": 4.667090252041817e-06}, "env_runners": {"env_to_module_connector": {"connector_pipeline_timer": 4.758732854996016e-05, "timers": {"connectors": {"add_time_dim_to_batch_and_zero_pad": 2.6145691223603125e-06, "batch_individual_items": 6.809881871477812e-06, "numpy_to_tensor": 1.0410217237924569e-05, "add_observations_from_episodes_to_batch": 3.107562008141665e-06, "add_states_from_episodes_to_batch": 1.8086591116501977e-06}}}, "env_step_timer": 1.5197704381945995e-05, "num_agent_steps_sampled_lifetime": {"default_agent": 10000.0}, "env_to_module_sum_episodes_length_out": 10.36823839457432, "module_to_env_connector": {"timers": {"connectors": {"normalize_and_clip_actions": 1.0408009659405943e-05, "tensor_to_numpy": 1.4412081082750767e-05, "remove_single_ts_time_rank_from_batch": 6.324867220981441e-07, "un_batch_to_individual_items": 5.837997190001496e-06, "get_actions": 4.432028785242312e-05, "listify_data_for_vector_env": 1.2012469661795533e-05}}, "connector_pipeline_timer": 0.00011515438885908555}, "num_agent_steps_sampled": {"default_agent": 5000.0}, "module_episode_returns_mean": {"default_policy": 3.1399999999999992}, "env_reset_timer": 8.326963295898035e-05, "episode_return_max": 12.5, "sample": 0.006420697615205585, "env_to_module_sum_episodes_length_in": 10.36823839457432, "num_module_steps_sampled_lifetime": {"default_policy": 10000.0}, "episode_return_mean": 3.1399999999999992, "episode_duration_sec_mean": 0.005032042146194725, "num_env_steps_sampled": 5000.0, "num_episodes": 250.0, "episode_len_mean": 20.0, "rlmodule_inference_timer": 3.339495344888208e-05, "episode_len_min": 20, "episode_len_max": 20, "agent_episode_returns_mean": {"default_agent": 3.1399999999999992}, "num_module_steps_sampled": {"default_policy": 5000.0}, "num_episodes_lifetime": 500.0, "num_env_steps_sampled_lifetime": 10000.0, "weights_seq_no": 1.0, "episode_return_min": -7.5, "time_between_sampling": 0.0016441911818753999, "num_env_steps_sampled_lifetime_throughput": 3536.4440072539005}, "learners": {"default_policy": {"curr_kl_coeff": 0.18662407994270325, "gradients_default_optimizer_global_norm": 0.09580280631780624, "vf_loss": 0.10001108795404434, "total_loss": 0.21512305736541748, "num_module_steps_trained": 6000, "diff_num_grad_updates_vs_sampler_policy": 1.0, "module_train_batch_size_mean": 1000.0, "entropy": 0.6910908818244934, "num_module_steps_trained_lifetime": 12000, "curr_entropy_coeff": 0.0090570820258, "vf_loss_unclipped": 28.312942504882812, "weights_seq_no": 2.0, "default_optimizer_learning_rate": 0.0002847858517, "vf_explained_var": 0.01552802324295044, "mean_kl_loss": 0.00033477909164503217, "num_trainable_parameters": 6003, "policy_loss": 0.15436917543411255, "num_module_steps_trained_lifetime_throughput": 343559.1951050474}, "__all_modules__": {"learner_connector": {"timers": {"connectors": {"numpy_to_tensor": 6.15237874444574e-05, "batch_individual_items": 0.03151049793814309, "add_columns_from_episodes_to_train_batch": 0.03405714751570486, "add_time_dim_to_batch_and_zero_pad": 9.808291215449572e-06, "add_one_ts_to_episodes_and_truncate": 0.007580935598816722, "add_observations_from_episodes_to_batch": 0.0008088081132154912, "general_advantage_estimation": 0.00684382789186202, "add_states_from_episodes_to_batch": 3.5801203921437263e-06}}, "connector_pipeline_timer": 0.08098394751315936}, "num_env_steps_trained": 31500, "num_env_steps_trained_lifetime": 63000, "learner_connector_sum_episodes_length_out": 5250.0, "learner_connector_sum_episodes_length_in": 5000.0, "num_module_steps_trained_lifetime": 12000, "num_non_trainable_parameters": 0, "num_module_steps_trained": 6000, "num_trainable_parameters": 6003, "num_env_steps_trained_lifetime_throughput": 1791439.9931609437, "num_module_steps_trained_throughput": 342723.277988157, "num_module_steps_trained_lifetime_throughput": 342248.19659189414}}, "num_training_step_calls_per_iteration": 1, "evaluation": {"env_runners": {"sample": 0.10694817379466258, "env_to_module_sum_episodes_length_in": 10.366003441359926, "num_module_steps_sampled": {"default_policy": 400}, "module_to_env_connector": {"timers": {"connectors": {"tensor_to_numpy": 1.3044765911187096e-05, "remove_single_ts_time_rank_from_batch": 6.0378398769882e-07, "listify_data_for_vector_env": 1.1085082188236536e-05, "normalize_and_clip_actions": 9.427386040665268e-06, "get_actions": 3.635556095881155e-05, "un_batch_to_individual_items": 5.42296937425628e-06}}, "connector_pipeline_timer": 0.00010207877571462819}, "rlmodule_inference_timer": 2.8522816145087838e-05, "env_to_module_connector": {"timers": {"connectors": {"add_time_dim_to_batch_and_zero_pad": 2.5355668844727427e-06, "numpy_to_tensor": 8.426958521383295e-06, "add_states_from_episodes_to_batch": 1.6668747292004016e-06, "batch_individual_items": 6.34482572737542e-06, "add_observations_from_episodes_to_batch": 2.8721163422846935e-06}}, "connector_pipeline_timer": 4.379918474294358e-05}, "episode_len_max": 20, "num_agent_steps_sampled_lifetime": {"default_agent": 800}, "num_episodes_lifetime": 40, "episode_return_min": -16.5, "env_step_timer": 1.421333069827357e-05, "env_to_module_sum_episodes_length_out": 10.366003441359926, "num_env_steps_sampled": 400, "episode_len_mean": 20.0, "num_agent_steps_sampled": {"default_agent": 400}, "num_env_steps_sampled_lifetime": 10400, "weights_seq_no": 2.0, "module_episode_returns_mean": {"default_policy": -0.85}, "num_module_steps_sampled_lifetime": {"default_policy": 800}, "num_episodes": 20, "episode_len_min": 20, "env_reset_timer": 0.0005544003995601088, "episode_return_max": 12.5, "agent_episode_returns_mean": {"default_agent": -0.85}, "episode_return_mean": -0.85, "episode_duration_sec_mean": 0.0047747405536938455, "time_between_sampling": 1.7554335410241038}, "num_healthy_workers": 1, "actor_manager_num_outstanding_async_reqs": 0, "num_remote_worker_restarts": 0}, "num_env_steps_sampled_lifetime": 10000.0, "fault_tolerance": {"num_healthy_workers": 0, "num_remote_worker_restarts": 0}, "env_runner_group": {"actor_manager_num_outstanding_async_reqs": 0}, "done": false, "training_iteration": 2, "trial_id": "4da5b_00000", "date": "2025-08-11_19-21-39", "timestamp": 1754932899, "time_this_iter_s": 1.824164867401123, "time_total_s": 3.8492538928985596, "pid": 14327, "hostname": "Mac", "node_ip": "127.0.0.1", "config": {"exploration_config": {}, "extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "placement_strategy": "PACK", "num_gpus": 0, "_fake_gpus": false, "num_cpus_for_main_process": 2, "eager_tracing": true, "eager_max_retraces": 20, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "torch_compile_learner": false, "torch_compile_learner_what_to_compile": "forward_train", "torch_compile_learner_dynamo_backend": "aot_eager", "torch_compile_learner_dynamo_mode": null, "torch_compile_worker": false, "torch_compile_worker_dynamo_backend": "aot_eager", "torch_compile_worker_dynamo_mode": null, "torch_ddp_kwargs": {}, "torch_skip_nan_gradients": false, "env": "Umbrella", "env_config": {}, "observation_space": null, "action_space": null, "clip_rewards": null, "normalize_actions": true, "clip_actions": false, "_is_atari": null, "disable_env_checking": false, "render_env": false, "action_mask_key": "action_mask", "env_runner_cls": null, "num_env_runners": 0, "create_local_env_runner": true, "num_envs_per_env_runner": 1, "gym_env_vectorize_mode": "SYNC", "num_cpus_per_env_runner": 1, "num_gpus_per_env_runner": 0, "custom_resources_per_env_runner": {}, "validate_env_runners_after_construction": true, "episodes_to_numpy": true, "max_requests_in_flight_per_env_runner": 1, "sample_timeout_s": 60.0, "_env_to_module_connector": null, "add_default_connectors_to_env_to_module_pipeline": true, "_module_to_env_connector": null, "add_default_connectors_to_module_to_env_pipeline": true, "merge_env_runner_states": "training_only", "broadcast_env_runner_states": true, "episode_lookback_horizon": 1, "rollout_fragment_length": "auto", "batch_mode": "complete_episodes", "compress_observations": false, "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "enable_tf1_exec_eagerly": false, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "preprocessor_pref": "deepmind", "observation_filter": "NoFilter", "update_worker_filter_stats": true, "use_worker_filter_stats": true, "sampler_perf_stats_ema_coef": null, "_is_online": true, "num_learners": 0, "num_gpus_per_learner": 0, "num_cpus_per_learner": "auto", "num_aggregator_actors_per_learner": 0, "max_requests_in_flight_per_aggregator_actor": 3, "local_gpu_idx": 0, "max_requests_in_flight_per_learner": 3, "gamma": 1, "lr": 0.0002847858517, "grad_clip": 0.5, "grad_clip_by": "global_norm", "_train_batch_size_per_learner": 5000, "train_batch_size": 4000, "num_epochs": 1, "minibatch_size": 1000, "shuffle_batch_per_epoch": true, "model": {"fcnet_hiddens": [256, 256], "fcnet_activation": "tanh", "fcnet_weights_initializer": null, "fcnet_weights_initializer_config": null, "fcnet_bias_initializer": null, "fcnet_bias_initializer_config": null, "conv_filters": null, "conv_activation": "relu", "conv_kernel_initializer": null, "conv_kernel_initializer_config": null, "conv_bias_initializer": null, "conv_bias_initializer_config": null, "conv_transpose_kernel_initializer": null, "conv_transpose_kernel_initializer_config": null, "conv_transpose_bias_initializer": null, "conv_transpose_bias_initializer_config": null, "post_fcnet_hiddens": [], "post_fcnet_activation": "relu", "post_fcnet_weights_initializer": null, "post_fcnet_weights_initializer_config": null, "post_fcnet_bias_initializer": null, "post_fcnet_bias_initializer_config": null, "free_log_std": false, "log_std_clip_param": 20.0, "no_final_linear": false, "vf_share_layers": false, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "lstm_weights_initializer": null, "lstm_weights_initializer_config": null, "lstm_bias_initializer": null, "lstm_bias_initializer_config": null, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "attention_use_n_prev_actions": 0, "attention_use_n_prev_rewards": 0, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": null, "custom_model_config": {}, "custom_action_dist": null, "custom_preprocessor": null, "encoder_latent_dim": null, "always_check_shapes": false, "lstm_use_prev_action_reward": -1, "_use_default_native_models": -1, "_disable_preprocessor_api": false, "_disable_action_flattening": false}, "_learner_connector": null, "add_default_connectors_to_learner_pipeline": true, "learner_config_dict": {}, "optimizer": {}, "_learner_class": null, "callbacks_on_algorithm_init": null, "callbacks_on_env_runners_recreated": null, "callbacks_on_offline_eval_runners_recreated": null, "callbacks_on_checkpoint_loaded": null, "callbacks_on_environment_created": null, "callbacks_on_episode_created": null, "callbacks_on_episode_start": null, "callbacks_on_episode_step": null, "callbacks_on_episode_end": null, "callbacks_on_evaluate_start": null, "callbacks_on_evaluate_end": null, "callbacks_on_evaluate_offline_start": null, "callbacks_on_evaluate_offline_end": null, "callbacks_on_sample_end": null, "callbacks_on_train_result": null, "explore": true, "enable_rl_module_and_learner": true, "enable_env_runner_and_connector_v2": true, "_prior_exploration_config": {"type": "StochasticSampling"}, "count_steps_by": "env_steps", "policy_map_capacity": 100, "policy_mapping_fn": "<function AlgorithmConfig.DEFAULT_POLICY_MAPPING_FN at 0x383de9b20>", "policies_to_train": null, "policy_states_are_swappable": false, "observation_fn": null, "offline_data_class": null, "input_read_method": "read_parquet", "input_read_method_kwargs": {}, "input_read_schema": {}, "input_read_episodes": false, "input_read_sample_batches": false, "input_read_batch_size": null, "input_filesystem": null, "input_filesystem_kwargs": {}, "input_compress_columns": ["obs", "new_obs"], "input_spaces_jsonable": true, "materialize_data": false, "materialize_mapped_data": true, "map_batches_kwargs": {}, "iter_batches_kwargs": {}, "ignore_final_observation": false, "prelearner_class": null, "prelearner_buffer_class": null, "prelearner_buffer_kwargs": {}, "prelearner_module_synch_period": 10, "dataset_num_iters_per_learner": null, "input_config": {}, "actions_in_input_normalized": false, "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_config": {}, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "output_max_rows_per_file": null, "output_write_remaining_data": false, "output_write_method": "write_parquet", "output_write_method_kwargs": {}, "output_filesystem": null, "output_filesystem_kwargs": {}, "output_write_episodes": true, "offline_sampling": false, "evaluation_interval": 1, "evaluation_duration": 20, "evaluation_duration_unit": "episodes", "evaluation_sample_timeout_s": 120.0, "evaluation_auto_duration_min_env_steps_per_sample": 100, "evaluation_auto_duration_max_env_steps_per_sample": 2000, "evaluation_parallel_to_training": false, "evaluation_force_reset_envs_before_iteration": true, "evaluation_config": null, "off_policy_estimation_methods": {}, "ope_split_batch_by_episode": true, "evaluation_num_env_runners": 1, "in_evaluation": false, "sync_filters_on_rollout_workers_timeout_s": 10.0, "offline_evaluation_interval": null, "num_offline_eval_runners": 0, "offline_loss_for_module_fn": null, "offline_evaluation_duration": 1, "offline_evaluation_parallel_to_training": false, "offline_evaluation_timeout_s": 120.0, "num_cpus_per_offline_eval_runner": 1, "num_gpus_per_offline_eval_runner": 0, "custom_resources_per_offline_eval_runner": {}, "restart_failed_offline_eval_runners": true, "ignore_offline_eval_runner_failures": false, "max_num_offline_eval_runner_restarts": 1000, "offline_eval_runner_restore_timeout_s": 1800.0, "max_requests_in_flight_per_offline_eval_runner": 1, "validate_offline_eval_runners_after_construction": true, "offline_eval_runner_health_probe_timeout_s": 30.0, "offline_eval_rl_module_inference_only": false, "broadcast_offline_eval_runner_states": false, "offline_eval_batch_size_per_runner": 256, "dataset_num_iters_per_eval_runner": 1, "keep_per_episode_custom_metrics": false, "metrics_episode_collection_timeout_s": 60.0, "metrics_num_episodes_for_smoothing": 100, "min_time_s_per_iteration": null, "min_train_timesteps_per_iteration": 0, "min_sample_timesteps_per_iteration": 0, "log_gradients": true, "export_native_model_files": false, "checkpoint_trainable_policies_only": false, "logger_creator": null, "logger_config": null, "log_level": "WARN", "log_sys_usage": true, "fake_sampler": false, "seed": 4, "restart_failed_env_runners": true, "ignore_env_runner_failures": false, "max_num_env_runner_restarts": 1000, "delay_between_env_runner_restarts_s": 60.0, "restart_failed_sub_environments": false, "num_consecutive_env_runner_failures_tolerance": 100, "env_runner_health_probe_timeout_s": 30.0, "env_runner_restore_timeout_s": 1800.0, "_model_config": {}, "_rl_module_spec": "RLModuleSpec(module_class=None, observation_space=None, action_space=None, inference_only=False, learner_only=False, model_config=DefaultModelConfig(fcnet_hiddens=[60, 90], fcnet_activation='tanh', fcnet_kernel_initializer=None, fcnet_kernel_initializer_kwargs=None, fcnet_bias_initializer=None, fcnet_bias_initializer_kwargs=None, conv_filters=None, conv_activation='relu', conv_kernel_initializer=None, conv_kernel_initializer_kwargs=None, conv_bias_initializer=None, conv_bias_initializer_kwargs=None, head_fcnet_hiddens=[], head_fcnet_activation='relu', head_fcnet_kernel_initializer=None, head_fcnet_kernel_initializer_kwargs=None, head_fcnet_bias_initializer=None, head_fcnet_bias_initializer_kwargs=None, free_log_std=False, log_std_clip_param=20.0, vf_share_layers=True, use_lstm=False, max_seq_len=20, lstm_cell_size=256, lstm_use_prev_action=False, lstm_use_prev_reward=False, lstm_kernel_initializer=None, lstm_kernel_initializer_kwargs=None, lstm_bias_initializer=None, lstm_bias_initializer_kwargs=None), catalog_class=None, load_state_path=None, model_config_dict=None)", "algorithm_config_overrides_per_module": {}, "_per_module_overrides": {}, "_validate_config": true, "_use_msgpack_checkpoints": false, "_torch_grad_scaler_class": null, "_torch_lr_scheduler_classes": null, "_tf_policy_handles_more_than_one_loss": false, "_disable_preprocessor_api": false, "_disable_action_flattening": false, "_disable_initialize_loss_from_dummy_batch": false, "_dont_auto_sync_env_runner_states": false, "env_task_fn": -1, "enable_connectors": -1, "simple_optimizer": false, "policy_map_cache": -1, "worker_cls": -1, "synchronize_filters": -1, "enable_async_evaluation": -1, "custom_async_evaluation_function": -1, "_enable_rl_module_api": -1, "auto_wrap_old_gym_envs": -1, "always_attach_evaluation_results": -1, "replay_sequence_length": null, "_disable_execution_plan_api": -1, "use_critic": true, "use_gae": true, "use_kl_loss": true, "kl_coeff": 0.7464963036515, "kl_target": 0.0270990929592, "vf_loss_coeff": 0.6688075857018, "entropy_coeff": 0.0090570820258, "clip_param": 0.1221781641624, "vf_clip_param": 0.1027808522125, "entropy_coeff_schedule": null, "lr_schedule": null, "sgd_minibatch_size": -1, "vf_share_layers": -1, "__stdout_file__": null, "__stderr_file__": null, "lambda": 0.9099046732075, "input": "sampler", "policies": {"default_policy": [null, null, null, null]}, "callbacks": "<class 'ray.rllib.callbacks.callbacks.RLlibCallback'>", "create_env_on_driver": false, "custom_eval_function": null, "framework": "torch"}, "time_since_restore": 3.8492538928985596, "iterations_since_restore": 2, "perf": {"cpu_util_percent": 46.26666666666667, "ram_util_percent": 81.26666666666667}}
{"timers": {"training_iteration": 1.8980487589303519, "restore_env_runners": 7.945386640494689e-05, "training_step": 1.8977164961295667, "env_runner_sampling_timer": 1.7834127472623367, "learner_update_timer": 0.11082538381955818, "synch_weights": 0.0006080157298361883, "restore_eval_env_runners": 8.214846020564438e-06, "evaluation_iteration": 0.11905810493044555, "synch_eval_env_connectors": 0.00013015315402299164, "synch_env_connectors": 4.666668828576803e-06}, "env_runners": {"env_to_module_connector": {"connector_pipeline_timer": 4.352021359991695e-05, "timers": {"connectors": {"add_time_dim_to_batch_and_zero_pad": 2.4265486322916425e-06, "batch_individual_items": 6.280115198617241e-06, "numpy_to_tensor": 8.510605038673114e-06, "add_observations_from_episodes_to_batch": 2.9442012554545845e-06, "add_states_from_episodes_to_batch": 1.7494729610644933e-06}}}, "env_step_timer": 1.3685308959790516e-05, "num_agent_steps_sampled_lifetime": {"default_agent": -607500.0}, "env_to_module_sum_episodes_length_out": 10.36823839457432, "module_to_env_connector": {"timers": {"connectors": {"normalize_and_clip_actions": 9.457098389736946e-06, "tensor_to_numpy": 1.3157243136490412e-05, "remove_single_ts_time_rank_from_batch": 5.810763128106299e-07, "un_batch_to_individual_items": 5.411035671814133e-06, "get_actions": 3.890391942607061e-05, "listify_data_for_vector_env": 1.1000922114285573e-05}}, "connector_pipeline_timer": 0.00010406469905706676}, "num_agent_steps_sampled": {"default_agent": 5000.0}, "module_episode_returns_mean": {"default_policy": 3.06}, "env_reset_timer": 4.014073881098582e-05, "episode_return_max": 12.5, "sample": 0.005161980391712107, "env_to_module_sum_episodes_length_in": 10.36823839457432, "num_module_steps_sampled_lifetime": {"default_policy": -607500.0}, "episode_return_mean": 3.06, "episode_duration_sec_mean": 0.004545775841921568, "num_env_steps_sampled": 5000.0, "num_episodes": 250.0, "episode_len_mean": 20.0, "rlmodule_inference_timer": 2.7968478770003075e-05, "episode_len_min": 20, "episode_len_max": 20, "agent_episode_returns_mean": {"default_agent": 3.06}, "num_module_steps_sampled": {"default_policy": 5000.0}, "num_episodes_lifetime": -30375.0, "num_env_steps_sampled_lifetime": -607500.0, "weights_seq_no": 2.0, "episode_return_min": -7.5, "time_between_sampling": 0.0018930348432676387, "num_env_steps_sampled_lifetime_throughput": 3721.54900546035}, "learners": {"default_policy": {"curr_kl_coeff": 0.09331203997135162, "gradients_default_optimizer_global_norm": 0.10330437868833542, "vf_loss": 0.1000901460647583, "total_loss": 0.13235385715961456, "num_module_steps_trained": 6000, "diff_num_grad_updates_vs_sampler_policy": 1.0, "module_train_batch_size_mean": 1000.0, "entropy": 0.6889595985412598, "num_module_steps_trained_lifetime": 18000, "curr_entropy_coeff": 0.0090570820258, "vf_loss_unclipped": 28.33220672607422, "weights_seq_no": 3.0, "default_optimizer_learning_rate": 0.0002847858517, "vf_explained_var": 0.01814943552017212, "mean_kl_loss": 0.0003109359822701663, "num_trainable_parameters": 6003, "policy_loss": 0.07159475237131119, "num_module_steps_trained_lifetime_throughput": 344765.7471477766}, "__all_modules__": {"learner_connector": {"timers": {"connectors": {"numpy_to_tensor": 6.140897014411166e-05, "batch_individual_items": 0.03150944003922632, "add_columns_from_episodes_to_train_batch": 0.0340632439503097, "add_time_dim_to_batch_and_zero_pad": 9.81853858102113e-06, "add_one_ts_to_episodes_and_truncate": 0.007582477493048645, "add_observations_from_episodes_to_batch": 0.0008091133625828662, "general_advantage_estimation": 0.006834027112985495, "add_states_from_episodes_to_batch": 3.572229761630297e-06}}, "connector_pipeline_timer": 0.08098066344840918}, "num_env_steps_trained": 31500, "num_env_steps_trained_lifetime": 94500, "learner_connector_sum_episodes_length_out": 5250.0, "learner_connector_sum_episodes_length_in": 5000.0, "num_module_steps_trained_lifetime": 18000, "num_non_trainable_parameters": 0, "num_module_steps_trained": 6000, "num_trainable_parameters": 6003, "num_env_steps_trained_lifetime_throughput": 1798121.3498146753, "num_module_steps_trained_throughput": 343966.5068732191, "num_module_steps_trained_lifetime_throughput": 343498.6718167068}}, "num_training_step_calls_per_iteration": 1, "evaluation": {"env_runners": {"sample": 0.10687578038704813, "env_to_module_sum_episodes_length_in": 10.368205581254823, "num_module_steps_sampled": {"default_policy": 400}, "module_to_env_connector": {"timers": {"connectors": {"tensor_to_numpy": 1.335601469599511e-05, "remove_single_ts_time_rank_from_batch": 5.942933735975245e-07, "listify_data_for_vector_env": 1.117496711688824e-05, "normalize_and_clip_actions": 9.500817420929988e-06, "get_actions": 3.845268318913071e-05, "un_batch_to_individual_items": 5.529487720457334e-06}}, "connector_pipeline_timer": 0.00010466050510566414}, "rlmodule_inference_timer": 2.874287397139394e-05, "env_to_module_connector": {"timers": {"connectors": {"add_time_dim_to_batch_and_zero_pad": 2.419168617665528e-06, "numpy_to_tensor": 8.474314309753477e-06, "add_states_from_episodes_to_batch": 1.6719250641839771e-06, "batch_individual_items": 6.404753968708155e-06, "add_observations_from_episodes_to_batch": 2.8917188111092765e-06}}, "connector_pipeline_timer": 4.39242461228303e-05}, "episode_len_max": 20, "num_agent_steps_sampled_lifetime": {"default_agent": 1200}, "num_episodes_lifetime": 60, "episode_return_min": -16.5, "env_step_timer": 1.4413589093582035e-05, "env_to_module_sum_episodes_length_out": 10.368205581254823, "num_env_steps_sampled": 400, "episode_len_mean": 20.0, "num_agent_steps_sampled": {"default_agent": 400}, "num_env_steps_sampled_lifetime": 15400, "weights_seq_no": 3.0, "module_episode_returns_mean": {"default_policy": -0.18333333333333332}, "num_module_steps_sampled_lifetime": {"default_policy": 1200}, "num_episodes": 20, "episode_len_min": 20, "env_reset_timer": 0.0005495755651849322, "episode_return_max": 12.5, "agent_episode_returns_mean": {"default_agent": -0.18333333333333332}, "episode_return_mean": -0.18333333333333332, "episode_duration_sec_mean": 0.004704276371436815, "time_between_sampling": 1.752806958113797}, "num_healthy_workers": 1, "actor_manager_num_outstanding_async_reqs": 0, "num_remote_worker_restarts": 0}, "num_env_steps_sampled_lifetime": -607500.0, "fault_tolerance": {"num_healthy_workers": 0, "num_remote_worker_restarts": 0}, "env_runner_group": {"actor_manager_num_outstanding_async_reqs": 0}, "done": false, "training_iteration": 3, "trial_id": "4da5b_00000", "date": "2025-08-11_19-21-40", "timestamp": 1754932900, "time_this_iter_s": 1.5816848278045654, "time_total_s": 5.430938720703125, "pid": 14327, "hostname": "Mac", "node_ip": "127.0.0.1", "config": {"exploration_config": {}, "extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "placement_strategy": "PACK", "num_gpus": 0, "_fake_gpus": false, "num_cpus_for_main_process": 2, "eager_tracing": true, "eager_max_retraces": 20, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "torch_compile_learner": false, "torch_compile_learner_what_to_compile": "forward_train", "torch_compile_learner_dynamo_backend": "aot_eager", "torch_compile_learner_dynamo_mode": null, "torch_compile_worker": false, "torch_compile_worker_dynamo_backend": "aot_eager", "torch_compile_worker_dynamo_mode": null, "torch_ddp_kwargs": {}, "torch_skip_nan_gradients": false, "env": "Umbrella", "env_config": {}, "observation_space": null, "action_space": null, "clip_rewards": null, "normalize_actions": true, "clip_actions": false, "_is_atari": null, "disable_env_checking": false, "render_env": false, "action_mask_key": "action_mask", "env_runner_cls": null, "num_env_runners": 0, "create_local_env_runner": true, "num_envs_per_env_runner": 1, "gym_env_vectorize_mode": "SYNC", "num_cpus_per_env_runner": 1, "num_gpus_per_env_runner": 0, "custom_resources_per_env_runner": {}, "validate_env_runners_after_construction": true, "episodes_to_numpy": true, "max_requests_in_flight_per_env_runner": 1, "sample_timeout_s": 60.0, "_env_to_module_connector": null, "add_default_connectors_to_env_to_module_pipeline": true, "_module_to_env_connector": null, "add_default_connectors_to_module_to_env_pipeline": true, "merge_env_runner_states": "training_only", "broadcast_env_runner_states": true, "episode_lookback_horizon": 1, "rollout_fragment_length": "auto", "batch_mode": "complete_episodes", "compress_observations": false, "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "enable_tf1_exec_eagerly": false, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "preprocessor_pref": "deepmind", "observation_filter": "NoFilter", "update_worker_filter_stats": true, "use_worker_filter_stats": true, "sampler_perf_stats_ema_coef": null, "_is_online": true, "num_learners": 0, "num_gpus_per_learner": 0, "num_cpus_per_learner": "auto", "num_aggregator_actors_per_learner": 0, "max_requests_in_flight_per_aggregator_actor": 3, "local_gpu_idx": 0, "max_requests_in_flight_per_learner": 3, "gamma": 1, "lr": 0.0002847858517, "grad_clip": 0.5, "grad_clip_by": "global_norm", "_train_batch_size_per_learner": 5000, "train_batch_size": 4000, "num_epochs": 1, "minibatch_size": 1000, "shuffle_batch_per_epoch": true, "model": {"fcnet_hiddens": [256, 256], "fcnet_activation": "tanh", "fcnet_weights_initializer": null, "fcnet_weights_initializer_config": null, "fcnet_bias_initializer": null, "fcnet_bias_initializer_config": null, "conv_filters": null, "conv_activation": "relu", "conv_kernel_initializer": null, "conv_kernel_initializer_config": null, "conv_bias_initializer": null, "conv_bias_initializer_config": null, "conv_transpose_kernel_initializer": null, "conv_transpose_kernel_initializer_config": null, "conv_transpose_bias_initializer": null, "conv_transpose_bias_initializer_config": null, "post_fcnet_hiddens": [], "post_fcnet_activation": "relu", "post_fcnet_weights_initializer": null, "post_fcnet_weights_initializer_config": null, "post_fcnet_bias_initializer": null, "post_fcnet_bias_initializer_config": null, "free_log_std": false, "log_std_clip_param": 20.0, "no_final_linear": false, "vf_share_layers": false, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "lstm_weights_initializer": null, "lstm_weights_initializer_config": null, "lstm_bias_initializer": null, "lstm_bias_initializer_config": null, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "attention_use_n_prev_actions": 0, "attention_use_n_prev_rewards": 0, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": null, "custom_model_config": {}, "custom_action_dist": null, "custom_preprocessor": null, "encoder_latent_dim": null, "always_check_shapes": false, "lstm_use_prev_action_reward": -1, "_use_default_native_models": -1, "_disable_preprocessor_api": false, "_disable_action_flattening": false}, "_learner_connector": null, "add_default_connectors_to_learner_pipeline": true, "learner_config_dict": {}, "optimizer": {}, "_learner_class": null, "callbacks_on_algorithm_init": null, "callbacks_on_env_runners_recreated": null, "callbacks_on_offline_eval_runners_recreated": null, "callbacks_on_checkpoint_loaded": null, "callbacks_on_environment_created": null, "callbacks_on_episode_created": null, "callbacks_on_episode_start": null, "callbacks_on_episode_step": null, "callbacks_on_episode_end": null, "callbacks_on_evaluate_start": null, "callbacks_on_evaluate_end": null, "callbacks_on_evaluate_offline_start": null, "callbacks_on_evaluate_offline_end": null, "callbacks_on_sample_end": null, "callbacks_on_train_result": null, "explore": true, "enable_rl_module_and_learner": true, "enable_env_runner_and_connector_v2": true, "_prior_exploration_config": {"type": "StochasticSampling"}, "count_steps_by": "env_steps", "policy_map_capacity": 100, "policy_mapping_fn": "<function AlgorithmConfig.DEFAULT_POLICY_MAPPING_FN at 0x383de9b20>", "policies_to_train": null, "policy_states_are_swappable": false, "observation_fn": null, "offline_data_class": null, "input_read_method": "read_parquet", "input_read_method_kwargs": {}, "input_read_schema": {}, "input_read_episodes": false, "input_read_sample_batches": false, "input_read_batch_size": null, "input_filesystem": null, "input_filesystem_kwargs": {}, "input_compress_columns": ["obs", "new_obs"], "input_spaces_jsonable": true, "materialize_data": false, "materialize_mapped_data": true, "map_batches_kwargs": {}, "iter_batches_kwargs": {}, "ignore_final_observation": false, "prelearner_class": null, "prelearner_buffer_class": null, "prelearner_buffer_kwargs": {}, "prelearner_module_synch_period": 10, "dataset_num_iters_per_learner": null, "input_config": {}, "actions_in_input_normalized": false, "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_config": {}, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "output_max_rows_per_file": null, "output_write_remaining_data": false, "output_write_method": "write_parquet", "output_write_method_kwargs": {}, "output_filesystem": null, "output_filesystem_kwargs": {}, "output_write_episodes": true, "offline_sampling": false, "evaluation_interval": 1, "evaluation_duration": 20, "evaluation_duration_unit": "episodes", "evaluation_sample_timeout_s": 120.0, "evaluation_auto_duration_min_env_steps_per_sample": 100, "evaluation_auto_duration_max_env_steps_per_sample": 2000, "evaluation_parallel_to_training": false, "evaluation_force_reset_envs_before_iteration": true, "evaluation_config": null, "off_policy_estimation_methods": {}, "ope_split_batch_by_episode": true, "evaluation_num_env_runners": 1, "in_evaluation": false, "sync_filters_on_rollout_workers_timeout_s": 10.0, "offline_evaluation_interval": null, "num_offline_eval_runners": 0, "offline_loss_for_module_fn": null, "offline_evaluation_duration": 1, "offline_evaluation_parallel_to_training": false, "offline_evaluation_timeout_s": 120.0, "num_cpus_per_offline_eval_runner": 1, "num_gpus_per_offline_eval_runner": 0, "custom_resources_per_offline_eval_runner": {}, "restart_failed_offline_eval_runners": true, "ignore_offline_eval_runner_failures": false, "max_num_offline_eval_runner_restarts": 1000, "offline_eval_runner_restore_timeout_s": 1800.0, "max_requests_in_flight_per_offline_eval_runner": 1, "validate_offline_eval_runners_after_construction": true, "offline_eval_runner_health_probe_timeout_s": 30.0, "offline_eval_rl_module_inference_only": false, "broadcast_offline_eval_runner_states": false, "offline_eval_batch_size_per_runner": 256, "dataset_num_iters_per_eval_runner": 1, "keep_per_episode_custom_metrics": false, "metrics_episode_collection_timeout_s": 60.0, "metrics_num_episodes_for_smoothing": 100, "min_time_s_per_iteration": null, "min_train_timesteps_per_iteration": 0, "min_sample_timesteps_per_iteration": 0, "log_gradients": true, "export_native_model_files": false, "checkpoint_trainable_policies_only": false, "logger_creator": null, "logger_config": null, "log_level": "WARN", "log_sys_usage": true, "fake_sampler": false, "seed": 4, "restart_failed_env_runners": true, "ignore_env_runner_failures": false, "max_num_env_runner_restarts": 1000, "delay_between_env_runner_restarts_s": 60.0, "restart_failed_sub_environments": false, "num_consecutive_env_runner_failures_tolerance": 100, "env_runner_health_probe_timeout_s": 30.0, "env_runner_restore_timeout_s": 1800.0, "_model_config": {}, "_rl_module_spec": "RLModuleSpec(module_class=None, observation_space=None, action_space=None, inference_only=False, learner_only=False, model_config=DefaultModelConfig(fcnet_hiddens=[60, 90], fcnet_activation='tanh', fcnet_kernel_initializer=None, fcnet_kernel_initializer_kwargs=None, fcnet_bias_initializer=None, fcnet_bias_initializer_kwargs=None, conv_filters=None, conv_activation='relu', conv_kernel_initializer=None, conv_kernel_initializer_kwargs=None, conv_bias_initializer=None, conv_bias_initializer_kwargs=None, head_fcnet_hiddens=[], head_fcnet_activation='relu', head_fcnet_kernel_initializer=None, head_fcnet_kernel_initializer_kwargs=None, head_fcnet_bias_initializer=None, head_fcnet_bias_initializer_kwargs=None, free_log_std=False, log_std_clip_param=20.0, vf_share_layers=True, use_lstm=False, max_seq_len=20, lstm_cell_size=256, lstm_use_prev_action=False, lstm_use_prev_reward=False, lstm_kernel_initializer=None, lstm_kernel_initializer_kwargs=None, lstm_bias_initializer=None, lstm_bias_initializer_kwargs=None), catalog_class=None, load_state_path=None, model_config_dict=None)", "algorithm_config_overrides_per_module": {}, "_per_module_overrides": {}, "_validate_config": true, "_use_msgpack_checkpoints": false, "_torch_grad_scaler_class": null, "_torch_lr_scheduler_classes": null, "_tf_policy_handles_more_than_one_loss": false, "_disable_preprocessor_api": false, "_disable_action_flattening": false, "_disable_initialize_loss_from_dummy_batch": false, "_dont_auto_sync_env_runner_states": false, "env_task_fn": -1, "enable_connectors": -1, "simple_optimizer": false, "policy_map_cache": -1, "worker_cls": -1, "synchronize_filters": -1, "enable_async_evaluation": -1, "custom_async_evaluation_function": -1, "_enable_rl_module_api": -1, "auto_wrap_old_gym_envs": -1, "always_attach_evaluation_results": -1, "replay_sequence_length": null, "_disable_execution_plan_api": -1, "use_critic": true, "use_gae": true, "use_kl_loss": true, "kl_coeff": 0.7464963036515, "kl_target": 0.0270990929592, "vf_loss_coeff": 0.6688075857018, "entropy_coeff": 0.0090570820258, "clip_param": 0.1221781641624, "vf_clip_param": 0.1027808522125, "entropy_coeff_schedule": null, "lr_schedule": null, "sgd_minibatch_size": -1, "vf_share_layers": -1, "__stdout_file__": null, "__stderr_file__": null, "lambda": 0.9099046732075, "input": "sampler", "policies": {"default_policy": [null, null, null, null]}, "callbacks": "<class 'ray.rllib.callbacks.callbacks.RLlibCallback'>", "create_env_on_driver": false, "custom_eval_function": null, "framework": "torch"}, "time_since_restore": 5.430938720703125, "iterations_since_restore": 3, "perf": {"cpu_util_percent": 42.05, "ram_util_percent": 80.4}}
{"timers": {"training_iteration": 1.8946702684208416, "restore_env_runners": 7.873098719224799e-05, "training_step": 1.8943395599179522, "env_runner_sampling_timer": 1.7802123077094174, "learner_update_timer": 0.11065342498150035, "synch_weights": 0.0006069843222734052, "restore_eval_env_runners": 8.218118466902524e-06, "evaluation_iteration": 0.11891497179167344, "synch_eval_env_connectors": 0.00013002995275892315, "synch_env_connectors": 4.675001394934952e-06}, "env_runners": {"env_to_module_connector": {"connector_pipeline_timer": 4.3572512508421616e-05, "timers": {"connectors": {"add_time_dim_to_batch_and_zero_pad": 2.4200072872238073e-06, "batch_individual_items": 6.291787246050703e-06, "numpy_to_tensor": 8.529007150102314e-06, "add_observations_from_episodes_to_batch": 3.0051083973566696e-06, "add_states_from_episodes_to_batch": 1.7409406298531545e-06}}}, "env_step_timer": 1.3758234055090746e-05, "num_agent_steps_sampled_lifetime": {"default_agent": -1225000.0}, "env_to_module_sum_episodes_length_out": 10.36823839457432, "module_to_env_connector": {"timers": {"connectors": {"normalize_and_clip_actions": 9.478512706159978e-06, "tensor_to_numpy": 1.3221436059522002e-05, "remove_single_ts_time_rank_from_batch": 5.827573591645923e-07, "un_batch_to_individual_items": 5.420407992249165e-06, "get_actions": 3.900637772611679e-05, "listify_data_for_vector_env": 1.096057859478132e-05}}, "connector_pipeline_timer": 0.00010422184782729851}, "num_agent_steps_sampled": {"default_agent": 5000.0}, "module_episode_returns_mean": {"default_policy": 3.7799999999999994}, "env_reset_timer": 3.398773862374335e-05, "episode_return_max": 12.5, "sample": 0.004876577069775621, "env_to_module_sum_episodes_length_in": 10.36823839457432, "num_module_steps_sampled_lifetime": {"default_policy": -1225000.0}, "episode_return_mean": 3.7799999999999994, "episode_duration_sec_mean": 0.004548643327318131, "num_env_steps_sampled": 5000.0, "num_episodes": 250.0, "episode_len_mean": 20.0, "rlmodule_inference_timer": 2.7855567452789432e-05, "episode_len_min": 20, "episode_len_max": 20, "agent_episode_returns_mean": {"default_agent": 3.7799999999999994}, "num_module_steps_sampled": {"default_policy": 5000.0}, "num_episodes_lifetime": -61250.0, "num_env_steps_sampled_lifetime": -1225000.0, "weights_seq_no": 3.0, "episode_return_min": -7.5, "time_between_sampling": 0.0017891055157169286, "num_env_steps_sampled_lifetime_throughput": 3716.5743437490482}, "learners": {"default_policy": {"curr_kl_coeff": 0.04665601998567581, "gradients_default_optimizer_global_norm": 0.026392024010419846, "vf_loss": 0.10008808225393295, "total_loss": 0.23179858922958374, "num_module_steps_trained": 6000, "diff_num_grad_updates_vs_sampler_policy": 1.0, "module_train_batch_size_mean": 1000.0, "entropy": 0.6815755367279053, "num_module_steps_trained_lifetime": 24000, "curr_entropy_coeff": 0.0090570820258, "vf_loss_unclipped": 28.318328857421875, "weights_seq_no": 4.0, "default_optimizer_learning_rate": 0.0002847858517, "vf_explained_var": 0.01967012882232666, "mean_kl_loss": 0.0018568553496152163, "num_trainable_parameters": 6003, "policy_loss": 0.1708587259054184, "num_module_steps_trained_lifetime_throughput": 346314.14354664215}, "__all_modules__": {"learner_connector": {"timers": {"connectors": {"numpy_to_tensor": 6.142905058001633e-05, "batch_individual_items": 0.03150201688844537, "add_columns_from_episodes_to_train_batch": 0.03406247443045199, "add_time_dim_to_batch_and_zero_pad": 9.81494297250174e-06, "add_one_ts_to_episodes_and_truncate": 0.0075841464676770845, "add_observations_from_episodes_to_batch": 0.0008093501480155392, "general_advantage_estimation": 0.006822554342389922, "add_states_from_episodes_to_batch": 3.573597385548055e-06}}, "connector_pipeline_timer": 0.08096278181371909}, "num_env_steps_trained": 31500, "num_env_steps_trained_lifetime": 126000, "learner_connector_sum_episodes_length_out": 5250.0, "learner_connector_sum_episodes_length_in": 5000.0, "num_module_steps_trained_lifetime": 24000, "num_non_trainable_parameters": 0, "num_module_steps_trained": 6000, "num_trainable_parameters": 6003, "num_env_steps_trained_lifetime_throughput": 1806672.7671170095, "num_module_steps_trained_throughput": 345559.9031062798, "num_module_steps_trained_lifetime_throughput": 345100.36018778756}}, "num_training_step_calls_per_iteration": 1, "evaluation": {"env_runners": {"sample": 0.10679301091397214, "env_to_module_sum_episodes_length_in": 10.368237912813044, "num_module_steps_sampled": {"default_policy": 400}, "module_to_env_connector": {"timers": {"connectors": {"tensor_to_numpy": 1.2924705376437707e-05, "remove_single_ts_time_rank_from_batch": 5.878184412051085e-07, "listify_data_for_vector_env": 1.1021886175036576e-05, "normalize_and_clip_actions": 9.645373654648423e-06, "get_actions": 3.57440844631256e-05, "un_batch_to_individual_items": 5.352600317973241e-06}}, "connector_pipeline_timer": 0.00010128294739193088}, "rlmodule_inference_timer": 2.790381076158312e-05, "env_to_module_connector": {"timers": {"connectors": {"add_time_dim_to_batch_and_zero_pad": 2.234641097282101e-06, "numpy_to_tensor": 8.38091301872876e-06, "add_states_from_episodes_to_batch": 1.6281427409739076e-06, "batch_individual_items": 6.366000146121059e-06, "add_observations_from_episodes_to_batch": 2.9164448291215814e-06}}, "connector_pipeline_timer": 4.3327109225897004e-05}, "episode_len_max": 20, "num_agent_steps_sampled_lifetime": {"default_agent": 1600}, "num_episodes_lifetime": 80, "episode_return_min": -16.5, "env_step_timer": 1.410573856688615e-05, "env_to_module_sum_episodes_length_out": 10.368237912813044, "num_env_steps_sampled": 400, "episode_len_mean": 20.0, "num_agent_steps_sampled": {"default_agent": 400}, "num_env_steps_sampled_lifetime": 20400, "weights_seq_no": 4.0, "module_episode_returns_mean": {"default_policy": 0.4}, "num_module_steps_sampled_lifetime": {"default_policy": 1600}, "num_episodes": 20, "episode_len_min": 20, "env_reset_timer": 0.0005448252191670471, "episode_return_max": 12.5, "agent_episode_returns_mean": {"default_agent": 0.4}, "episode_return_mean": 0.4, "episode_duration_sec_mean": 0.004657784404116683, "time_between_sampling": 1.7510579477022403}, "num_healthy_workers": 1, "actor_manager_num_outstanding_async_reqs": 0, "num_remote_worker_restarts": 0}, "num_env_steps_sampled_lifetime": -1225000.0, "fault_tolerance": {"num_healthy_workers": 0, "num_remote_worker_restarts": 0}, "env_runner_group": {"actor_manager_num_outstanding_async_reqs": 0}, "done": false, "training_iteration": 4, "trial_id": "4da5b_00000", "date": "2025-08-11_19-21-42", "timestamp": 1754932902, "time_this_iter_s": 1.66603422164917, "time_total_s": 7.096972942352295, "pid": 14327, "hostname": "Mac", "node_ip": "127.0.0.1", "config": {"exploration_config": {}, "extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "placement_strategy": "PACK", "num_gpus": 0, "_fake_gpus": false, "num_cpus_for_main_process": 2, "eager_tracing": true, "eager_max_retraces": 20, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "torch_compile_learner": false, "torch_compile_learner_what_to_compile": "forward_train", "torch_compile_learner_dynamo_backend": "aot_eager", "torch_compile_learner_dynamo_mode": null, "torch_compile_worker": false, "torch_compile_worker_dynamo_backend": "aot_eager", "torch_compile_worker_dynamo_mode": null, "torch_ddp_kwargs": {}, "torch_skip_nan_gradients": false, "env": "Umbrella", "env_config": {}, "observation_space": null, "action_space": null, "clip_rewards": null, "normalize_actions": true, "clip_actions": false, "_is_atari": null, "disable_env_checking": false, "render_env": false, "action_mask_key": "action_mask", "env_runner_cls": null, "num_env_runners": 0, "create_local_env_runner": true, "num_envs_per_env_runner": 1, "gym_env_vectorize_mode": "SYNC", "num_cpus_per_env_runner": 1, "num_gpus_per_env_runner": 0, "custom_resources_per_env_runner": {}, "validate_env_runners_after_construction": true, "episodes_to_numpy": true, "max_requests_in_flight_per_env_runner": 1, "sample_timeout_s": 60.0, "_env_to_module_connector": null, "add_default_connectors_to_env_to_module_pipeline": true, "_module_to_env_connector": null, "add_default_connectors_to_module_to_env_pipeline": true, "merge_env_runner_states": "training_only", "broadcast_env_runner_states": true, "episode_lookback_horizon": 1, "rollout_fragment_length": "auto", "batch_mode": "complete_episodes", "compress_observations": false, "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "enable_tf1_exec_eagerly": false, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "preprocessor_pref": "deepmind", "observation_filter": "NoFilter", "update_worker_filter_stats": true, "use_worker_filter_stats": true, "sampler_perf_stats_ema_coef": null, "_is_online": true, "num_learners": 0, "num_gpus_per_learner": 0, "num_cpus_per_learner": "auto", "num_aggregator_actors_per_learner": 0, "max_requests_in_flight_per_aggregator_actor": 3, "local_gpu_idx": 0, "max_requests_in_flight_per_learner": 3, "gamma": 1, "lr": 0.0002847858517, "grad_clip": 0.5, "grad_clip_by": "global_norm", "_train_batch_size_per_learner": 5000, "train_batch_size": 4000, "num_epochs": 1, "minibatch_size": 1000, "shuffle_batch_per_epoch": true, "model": {"fcnet_hiddens": [256, 256], "fcnet_activation": "tanh", "fcnet_weights_initializer": null, "fcnet_weights_initializer_config": null, "fcnet_bias_initializer": null, "fcnet_bias_initializer_config": null, "conv_filters": null, "conv_activation": "relu", "conv_kernel_initializer": null, "conv_kernel_initializer_config": null, "conv_bias_initializer": null, "conv_bias_initializer_config": null, "conv_transpose_kernel_initializer": null, "conv_transpose_kernel_initializer_config": null, "conv_transpose_bias_initializer": null, "conv_transpose_bias_initializer_config": null, "post_fcnet_hiddens": [], "post_fcnet_activation": "relu", "post_fcnet_weights_initializer": null, "post_fcnet_weights_initializer_config": null, "post_fcnet_bias_initializer": null, "post_fcnet_bias_initializer_config": null, "free_log_std": false, "log_std_clip_param": 20.0, "no_final_linear": false, "vf_share_layers": false, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "lstm_weights_initializer": null, "lstm_weights_initializer_config": null, "lstm_bias_initializer": null, "lstm_bias_initializer_config": null, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "attention_use_n_prev_actions": 0, "attention_use_n_prev_rewards": 0, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": null, "custom_model_config": {}, "custom_action_dist": null, "custom_preprocessor": null, "encoder_latent_dim": null, "always_check_shapes": false, "lstm_use_prev_action_reward": -1, "_use_default_native_models": -1, "_disable_preprocessor_api": false, "_disable_action_flattening": false}, "_learner_connector": null, "add_default_connectors_to_learner_pipeline": true, "learner_config_dict": {}, "optimizer": {}, "_learner_class": null, "callbacks_on_algorithm_init": null, "callbacks_on_env_runners_recreated": null, "callbacks_on_offline_eval_runners_recreated": null, "callbacks_on_checkpoint_loaded": null, "callbacks_on_environment_created": null, "callbacks_on_episode_created": null, "callbacks_on_episode_start": null, "callbacks_on_episode_step": null, "callbacks_on_episode_end": null, "callbacks_on_evaluate_start": null, "callbacks_on_evaluate_end": null, "callbacks_on_evaluate_offline_start": null, "callbacks_on_evaluate_offline_end": null, "callbacks_on_sample_end": null, "callbacks_on_train_result": null, "explore": true, "enable_rl_module_and_learner": true, "enable_env_runner_and_connector_v2": true, "_prior_exploration_config": {"type": "StochasticSampling"}, "count_steps_by": "env_steps", "policy_map_capacity": 100, "policy_mapping_fn": "<function AlgorithmConfig.DEFAULT_POLICY_MAPPING_FN at 0x383de9b20>", "policies_to_train": null, "policy_states_are_swappable": false, "observation_fn": null, "offline_data_class": null, "input_read_method": "read_parquet", "input_read_method_kwargs": {}, "input_read_schema": {}, "input_read_episodes": false, "input_read_sample_batches": false, "input_read_batch_size": null, "input_filesystem": null, "input_filesystem_kwargs": {}, "input_compress_columns": ["obs", "new_obs"], "input_spaces_jsonable": true, "materialize_data": false, "materialize_mapped_data": true, "map_batches_kwargs": {}, "iter_batches_kwargs": {}, "ignore_final_observation": false, "prelearner_class": null, "prelearner_buffer_class": null, "prelearner_buffer_kwargs": {}, "prelearner_module_synch_period": 10, "dataset_num_iters_per_learner": null, "input_config": {}, "actions_in_input_normalized": false, "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_config": {}, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "output_max_rows_per_file": null, "output_write_remaining_data": false, "output_write_method": "write_parquet", "output_write_method_kwargs": {}, "output_filesystem": null, "output_filesystem_kwargs": {}, "output_write_episodes": true, "offline_sampling": false, "evaluation_interval": 1, "evaluation_duration": 20, "evaluation_duration_unit": "episodes", "evaluation_sample_timeout_s": 120.0, "evaluation_auto_duration_min_env_steps_per_sample": 100, "evaluation_auto_duration_max_env_steps_per_sample": 2000, "evaluation_parallel_to_training": false, "evaluation_force_reset_envs_before_iteration": true, "evaluation_config": null, "off_policy_estimation_methods": {}, "ope_split_batch_by_episode": true, "evaluation_num_env_runners": 1, "in_evaluation": false, "sync_filters_on_rollout_workers_timeout_s": 10.0, "offline_evaluation_interval": null, "num_offline_eval_runners": 0, "offline_loss_for_module_fn": null, "offline_evaluation_duration": 1, "offline_evaluation_parallel_to_training": false, "offline_evaluation_timeout_s": 120.0, "num_cpus_per_offline_eval_runner": 1, "num_gpus_per_offline_eval_runner": 0, "custom_resources_per_offline_eval_runner": {}, "restart_failed_offline_eval_runners": true, "ignore_offline_eval_runner_failures": false, "max_num_offline_eval_runner_restarts": 1000, "offline_eval_runner_restore_timeout_s": 1800.0, "max_requests_in_flight_per_offline_eval_runner": 1, "validate_offline_eval_runners_after_construction": true, "offline_eval_runner_health_probe_timeout_s": 30.0, "offline_eval_rl_module_inference_only": false, "broadcast_offline_eval_runner_states": false, "offline_eval_batch_size_per_runner": 256, "dataset_num_iters_per_eval_runner": 1, "keep_per_episode_custom_metrics": false, "metrics_episode_collection_timeout_s": 60.0, "metrics_num_episodes_for_smoothing": 100, "min_time_s_per_iteration": null, "min_train_timesteps_per_iteration": 0, "min_sample_timesteps_per_iteration": 0, "log_gradients": true, "export_native_model_files": false, "checkpoint_trainable_policies_only": false, "logger_creator": null, "logger_config": null, "log_level": "WARN", "log_sys_usage": true, "fake_sampler": false, "seed": 4, "restart_failed_env_runners": true, "ignore_env_runner_failures": false, "max_num_env_runner_restarts": 1000, "delay_between_env_runner_restarts_s": 60.0, "restart_failed_sub_environments": false, "num_consecutive_env_runner_failures_tolerance": 100, "env_runner_health_probe_timeout_s": 30.0, "env_runner_restore_timeout_s": 1800.0, "_model_config": {}, "_rl_module_spec": "RLModuleSpec(module_class=None, observation_space=None, action_space=None, inference_only=False, learner_only=False, model_config=DefaultModelConfig(fcnet_hiddens=[60, 90], fcnet_activation='tanh', fcnet_kernel_initializer=None, fcnet_kernel_initializer_kwargs=None, fcnet_bias_initializer=None, fcnet_bias_initializer_kwargs=None, conv_filters=None, conv_activation='relu', conv_kernel_initializer=None, conv_kernel_initializer_kwargs=None, conv_bias_initializer=None, conv_bias_initializer_kwargs=None, head_fcnet_hiddens=[], head_fcnet_activation='relu', head_fcnet_kernel_initializer=None, head_fcnet_kernel_initializer_kwargs=None, head_fcnet_bias_initializer=None, head_fcnet_bias_initializer_kwargs=None, free_log_std=False, log_std_clip_param=20.0, vf_share_layers=True, use_lstm=False, max_seq_len=20, lstm_cell_size=256, lstm_use_prev_action=False, lstm_use_prev_reward=False, lstm_kernel_initializer=None, lstm_kernel_initializer_kwargs=None, lstm_bias_initializer=None, lstm_bias_initializer_kwargs=None), catalog_class=None, load_state_path=None, model_config_dict=None)", "algorithm_config_overrides_per_module": {}, "_per_module_overrides": {}, "_validate_config": true, "_use_msgpack_checkpoints": false, "_torch_grad_scaler_class": null, "_torch_lr_scheduler_classes": null, "_tf_policy_handles_more_than_one_loss": false, "_disable_preprocessor_api": false, "_disable_action_flattening": false, "_disable_initialize_loss_from_dummy_batch": false, "_dont_auto_sync_env_runner_states": false, "env_task_fn": -1, "enable_connectors": -1, "simple_optimizer": false, "policy_map_cache": -1, "worker_cls": -1, "synchronize_filters": -1, "enable_async_evaluation": -1, "custom_async_evaluation_function": -1, "_enable_rl_module_api": -1, "auto_wrap_old_gym_envs": -1, "always_attach_evaluation_results": -1, "replay_sequence_length": null, "_disable_execution_plan_api": -1, "use_critic": true, "use_gae": true, "use_kl_loss": true, "kl_coeff": 0.7464963036515, "kl_target": 0.0270990929592, "vf_loss_coeff": 0.6688075857018, "entropy_coeff": 0.0090570820258, "clip_param": 0.1221781641624, "vf_clip_param": 0.1027808522125, "entropy_coeff_schedule": null, "lr_schedule": null, "sgd_minibatch_size": -1, "vf_share_layers": -1, "__stdout_file__": null, "__stderr_file__": null, "lambda": 0.9099046732075, "input": "sampler", "policies": {"default_policy": [null, null, null, null]}, "callbacks": "<class 'ray.rllib.callbacks.callbacks.RLlibCallback'>", "create_env_on_driver": false, "custom_eval_function": null, "framework": "torch"}, "time_since_restore": 7.096972942352295, "iterations_since_restore": 4, "perf": {"cpu_util_percent": 38.86666666666667, "ram_util_percent": 79.66666666666667}}
{"timers": {"training_iteration": 1.8973371190764814, "restore_env_runners": 7.799784653372481e-05, "training_step": 1.897007713488529, "env_runner_sampling_timer": 1.782882852132467, "learner_update_timer": 0.11063265489090096, "synch_weights": 0.0006214240589680871, "restore_eval_env_runners": 8.229686540900729e-06, "evaluation_iteration": 0.11876321624417323, "synch_eval_env_connectors": 0.00013030048358580096, "synch_env_connectors": 4.670332027366385e-06}, "env_runners": {"env_to_module_connector": {"connector_pipeline_timer": 4.988501597377215e-05, "timers": {"connectors": {"add_time_dim_to_batch_and_zero_pad": 2.742949491012788e-06, "batch_individual_items": 7.478697358069958e-06, "numpy_to_tensor": 1.038840170855548e-05, "add_observations_from_episodes_to_batch": 3.4018490569438093e-06, "add_states_from_episodes_to_batch": 1.8901770035914802e-06}}}, "env_step_timer": 1.6429098197986687e-05, "num_agent_steps_sampled_lifetime": {"default_agent": -1842500.0}, "env_to_module_sum_episodes_length_out": 10.36823839457432, "module_to_env_connector": {"timers": {"connectors": {"normalize_and_clip_actions": 1.0835393353642399e-05, "tensor_to_numpy": 1.560659541158987e-05, "remove_single_ts_time_rank_from_batch": 6.655518146371508e-07, "un_batch_to_individual_items": 6.345046448597013e-06, "get_actions": 4.767199246369991e-05, "listify_data_for_vector_env": 1.2780154575588516e-05}}, "connector_pipeline_timer": 0.00012288926211552066}, "num_agent_steps_sampled": {"default_agent": 5000.0}, "module_episode_returns_mean": {"default_policy": 4.5}, "env_reset_timer": 4.130320654393388e-05, "episode_return_max": 12.5, "sample": 0.005558456338918808, "env_to_module_sum_episodes_length_in": 10.36823839457432, "num_module_steps_sampled_lifetime": {"default_policy": -1842500.0}, "episode_return_mean": 4.5, "episode_duration_sec_mean": 0.007022054182831195, "num_env_steps_sampled": 5000.0, "num_episodes": 250.0, "episode_len_mean": 20.0, "rlmodule_inference_timer": 0.00011953547083871735, "episode_len_min": 20, "episode_len_max": 20, "agent_episode_returns_mean": {"default_agent": 4.5}, "num_module_steps_sampled": {"default_policy": 5000.0}, "num_episodes_lifetime": -92125.0, "num_env_steps_sampled_lifetime": -1842500.0, "weights_seq_no": 4.0, "episode_return_min": -7.5, "time_between_sampling": 0.0016366916816620185, "num_env_steps_sampled_lifetime_throughput": 3302.6576491797614}, "learners": {"default_policy": {"curr_kl_coeff": 0.023328009992837906, "gradients_default_optimizer_global_norm": 0.055656589567661285, "vf_loss": 0.1004083901643753, "total_loss": 0.16066518425941467, "num_module_steps_trained": 6000, "diff_num_grad_updates_vs_sampler_policy": 1.0, "module_train_batch_size_mean": 1000.0, "entropy": 0.6678587794303894, "num_module_steps_trained_lifetime": 30000, "curr_entropy_coeff": 0.0090570820258, "vf_loss_unclipped": 28.426040649414062, "weights_seq_no": 5.0, "default_optimizer_learning_rate": 0.0002847858517, "vf_explained_var": 0.02140355110168457, "mean_kl_loss": 0.001579137286171317, "num_trainable_parameters": 6003, "policy_loss": 0.09948650747537613, "num_module_steps_trained_lifetime_throughput": 346157.22121831536}, "__all_modules__": {"learner_connector": {"timers": {"connectors": {"numpy_to_tensor": 6.174933994953636e-05, "batch_individual_items": 0.03151104506011433, "add_columns_from_episodes_to_train_batch": 0.034066357185978266, "add_time_dim_to_batch_and_zero_pad": 9.86971321706893e-06, "add_one_ts_to_episodes_and_truncate": 0.0075866191732416694, "add_observations_from_episodes_to_batch": 0.0008093795675253741, "general_advantage_estimation": 0.0068305892096809165, "add_states_from_episodes_to_batch": 3.5691119406837965e-06}}, "connector_pipeline_timer": 0.0809866510756025}, "num_env_steps_trained": 31500, "num_env_steps_trained_lifetime": 157500, "learner_connector_sum_episodes_length_out": 5250.0, "learner_connector_sum_episodes_length_in": 5000.0, "num_module_steps_trained_lifetime": 30000, "num_non_trainable_parameters": 0, "num_module_steps_trained": 6000, "num_trainable_parameters": 6003, "num_env_steps_trained_lifetime_throughput": 1806311.3671098617, "num_module_steps_trained_throughput": 345448.7994856848, "num_module_steps_trained_lifetime_throughput": 345000.1111423153}}, "num_training_step_calls_per_iteration": 1, "evaluation": {"env_runners": {"sample": 0.10706884539423338, "env_to_module_sum_episodes_length_in": 10.368238387501162, "num_module_steps_sampled": {"default_policy": 400}, "module_to_env_connector": {"timers": {"connectors": {"tensor_to_numpy": 1.5964898426333368e-05, "remove_single_ts_time_rank_from_batch": 6.536087475473483e-07, "listify_data_for_vector_env": 1.2697731071603061e-05, "normalize_and_clip_actions": 1.1809366158914719e-05, "get_actions": 4.602378169993876e-05, "un_batch_to_individual_items": 6.249952141522162e-06}}, "connector_pipeline_timer": 0.00012363898267759134}, "rlmodule_inference_timer": 3.4469081802073705e-05, "env_to_module_connector": {"timers": {"connectors": {"add_time_dim_to_batch_and_zero_pad": 2.594001183626388e-06, "numpy_to_tensor": 1.013565277430114e-05, "add_states_from_episodes_to_batch": 1.896529616083881e-06, "batch_individual_items": 7.323399001306411e-06, "add_observations_from_episodes_to_batch": 3.327237507569956e-06}}, "connector_pipeline_timer": 4.9847859491243096e-05}, "episode_len_max": 20, "num_agent_steps_sampled_lifetime": {"default_agent": 2000}, "num_episodes_lifetime": 100, "episode_return_min": -16.5, "env_step_timer": 1.746080017095622e-05, "env_to_module_sum_episodes_length_out": 10.368238387501162, "num_env_steps_sampled": 400, "episode_len_mean": 20.0, "num_agent_steps_sampled": {"default_agent": 400}, "num_env_steps_sampled_lifetime": 25400, "weights_seq_no": 5.0, "module_episode_returns_mean": {"default_policy": 0.55}, "num_module_steps_sampled_lifetime": {"default_policy": 2000}, "num_episodes": 20, "episode_len_min": 20, "env_reset_timer": 0.000541419466811911, "episode_return_max": 12.5, "agent_episode_returns_mean": {"default_agent": 0.55}, "episode_return_mean": 0.55, "episode_duration_sec_mean": 0.004946760032325983, "time_between_sampling": 1.7553514903060115}, "num_healthy_workers": 1, "actor_manager_num_outstanding_async_reqs": 0, "num_remote_worker_restarts": 0}, "num_env_steps_sampled_lifetime": -1842500.0, "fault_tolerance": {"num_healthy_workers": 0, "num_remote_worker_restarts": 0}, "env_runner_group": {"actor_manager_num_outstanding_async_reqs": 0}, "done": false, "training_iteration": 5, "trial_id": "4da5b_00000", "date": "2025-08-11_19-21-44", "timestamp": 1754932904, "time_this_iter_s": 2.306610107421875, "time_total_s": 9.40358304977417, "pid": 14327, "hostname": "Mac", "node_ip": "127.0.0.1", "config": {"exploration_config": {}, "extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "placement_strategy": "PACK", "num_gpus": 0, "_fake_gpus": false, "num_cpus_for_main_process": 2, "eager_tracing": true, "eager_max_retraces": 20, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "torch_compile_learner": false, "torch_compile_learner_what_to_compile": "forward_train", "torch_compile_learner_dynamo_backend": "aot_eager", "torch_compile_learner_dynamo_mode": null, "torch_compile_worker": false, "torch_compile_worker_dynamo_backend": "aot_eager", "torch_compile_worker_dynamo_mode": null, "torch_ddp_kwargs": {}, "torch_skip_nan_gradients": false, "env": "Umbrella", "env_config": {}, "observation_space": null, "action_space": null, "clip_rewards": null, "normalize_actions": true, "clip_actions": false, "_is_atari": null, "disable_env_checking": false, "render_env": false, "action_mask_key": "action_mask", "env_runner_cls": null, "num_env_runners": 0, "create_local_env_runner": true, "num_envs_per_env_runner": 1, "gym_env_vectorize_mode": "SYNC", "num_cpus_per_env_runner": 1, "num_gpus_per_env_runner": 0, "custom_resources_per_env_runner": {}, "validate_env_runners_after_construction": true, "episodes_to_numpy": true, "max_requests_in_flight_per_env_runner": 1, "sample_timeout_s": 60.0, "_env_to_module_connector": null, "add_default_connectors_to_env_to_module_pipeline": true, "_module_to_env_connector": null, "add_default_connectors_to_module_to_env_pipeline": true, "merge_env_runner_states": "training_only", "broadcast_env_runner_states": true, "episode_lookback_horizon": 1, "rollout_fragment_length": "auto", "batch_mode": "complete_episodes", "compress_observations": false, "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "enable_tf1_exec_eagerly": false, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "preprocessor_pref": "deepmind", "observation_filter": "NoFilter", "update_worker_filter_stats": true, "use_worker_filter_stats": true, "sampler_perf_stats_ema_coef": null, "_is_online": true, "num_learners": 0, "num_gpus_per_learner": 0, "num_cpus_per_learner": "auto", "num_aggregator_actors_per_learner": 0, "max_requests_in_flight_per_aggregator_actor": 3, "local_gpu_idx": 0, "max_requests_in_flight_per_learner": 3, "gamma": 1, "lr": 0.0002847858517, "grad_clip": 0.5, "grad_clip_by": "global_norm", "_train_batch_size_per_learner": 5000, "train_batch_size": 4000, "num_epochs": 1, "minibatch_size": 1000, "shuffle_batch_per_epoch": true, "model": {"fcnet_hiddens": [256, 256], "fcnet_activation": "tanh", "fcnet_weights_initializer": null, "fcnet_weights_initializer_config": null, "fcnet_bias_initializer": null, "fcnet_bias_initializer_config": null, "conv_filters": null, "conv_activation": "relu", "conv_kernel_initializer": null, "conv_kernel_initializer_config": null, "conv_bias_initializer": null, "conv_bias_initializer_config": null, "conv_transpose_kernel_initializer": null, "conv_transpose_kernel_initializer_config": null, "conv_transpose_bias_initializer": null, "conv_transpose_bias_initializer_config": null, "post_fcnet_hiddens": [], "post_fcnet_activation": "relu", "post_fcnet_weights_initializer": null, "post_fcnet_weights_initializer_config": null, "post_fcnet_bias_initializer": null, "post_fcnet_bias_initializer_config": null, "free_log_std": false, "log_std_clip_param": 20.0, "no_final_linear": false, "vf_share_layers": false, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "lstm_weights_initializer": null, "lstm_weights_initializer_config": null, "lstm_bias_initializer": null, "lstm_bias_initializer_config": null, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "attention_use_n_prev_actions": 0, "attention_use_n_prev_rewards": 0, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": null, "custom_model_config": {}, "custom_action_dist": null, "custom_preprocessor": null, "encoder_latent_dim": null, "always_check_shapes": false, "lstm_use_prev_action_reward": -1, "_use_default_native_models": -1, "_disable_preprocessor_api": false, "_disable_action_flattening": false}, "_learner_connector": null, "add_default_connectors_to_learner_pipeline": true, "learner_config_dict": {}, "optimizer": {}, "_learner_class": null, "callbacks_on_algorithm_init": null, "callbacks_on_env_runners_recreated": null, "callbacks_on_offline_eval_runners_recreated": null, "callbacks_on_checkpoint_loaded": null, "callbacks_on_environment_created": null, "callbacks_on_episode_created": null, "callbacks_on_episode_start": null, "callbacks_on_episode_step": null, "callbacks_on_episode_end": null, "callbacks_on_evaluate_start": null, "callbacks_on_evaluate_end": null, "callbacks_on_evaluate_offline_start": null, "callbacks_on_evaluate_offline_end": null, "callbacks_on_sample_end": null, "callbacks_on_train_result": null, "explore": true, "enable_rl_module_and_learner": true, "enable_env_runner_and_connector_v2": true, "_prior_exploration_config": {"type": "StochasticSampling"}, "count_steps_by": "env_steps", "policy_map_capacity": 100, "policy_mapping_fn": "<function AlgorithmConfig.DEFAULT_POLICY_MAPPING_FN at 0x383de9b20>", "policies_to_train": null, "policy_states_are_swappable": false, "observation_fn": null, "offline_data_class": null, "input_read_method": "read_parquet", "input_read_method_kwargs": {}, "input_read_schema": {}, "input_read_episodes": false, "input_read_sample_batches": false, "input_read_batch_size": null, "input_filesystem": null, "input_filesystem_kwargs": {}, "input_compress_columns": ["obs", "new_obs"], "input_spaces_jsonable": true, "materialize_data": false, "materialize_mapped_data": true, "map_batches_kwargs": {}, "iter_batches_kwargs": {}, "ignore_final_observation": false, "prelearner_class": null, "prelearner_buffer_class": null, "prelearner_buffer_kwargs": {}, "prelearner_module_synch_period": 10, "dataset_num_iters_per_learner": null, "input_config": {}, "actions_in_input_normalized": false, "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_config": {}, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "output_max_rows_per_file": null, "output_write_remaining_data": false, "output_write_method": "write_parquet", "output_write_method_kwargs": {}, "output_filesystem": null, "output_filesystem_kwargs": {}, "output_write_episodes": true, "offline_sampling": false, "evaluation_interval": 1, "evaluation_duration": 20, "evaluation_duration_unit": "episodes", "evaluation_sample_timeout_s": 120.0, "evaluation_auto_duration_min_env_steps_per_sample": 100, "evaluation_auto_duration_max_env_steps_per_sample": 2000, "evaluation_parallel_to_training": false, "evaluation_force_reset_envs_before_iteration": true, "evaluation_config": null, "off_policy_estimation_methods": {}, "ope_split_batch_by_episode": true, "evaluation_num_env_runners": 1, "in_evaluation": false, "sync_filters_on_rollout_workers_timeout_s": 10.0, "offline_evaluation_interval": null, "num_offline_eval_runners": 0, "offline_loss_for_module_fn": null, "offline_evaluation_duration": 1, "offline_evaluation_parallel_to_training": false, "offline_evaluation_timeout_s": 120.0, "num_cpus_per_offline_eval_runner": 1, "num_gpus_per_offline_eval_runner": 0, "custom_resources_per_offline_eval_runner": {}, "restart_failed_offline_eval_runners": true, "ignore_offline_eval_runner_failures": false, "max_num_offline_eval_runner_restarts": 1000, "offline_eval_runner_restore_timeout_s": 1800.0, "max_requests_in_flight_per_offline_eval_runner": 1, "validate_offline_eval_runners_after_construction": true, "offline_eval_runner_health_probe_timeout_s": 30.0, "offline_eval_rl_module_inference_only": false, "broadcast_offline_eval_runner_states": false, "offline_eval_batch_size_per_runner": 256, "dataset_num_iters_per_eval_runner": 1, "keep_per_episode_custom_metrics": false, "metrics_episode_collection_timeout_s": 60.0, "metrics_num_episodes_for_smoothing": 100, "min_time_s_per_iteration": null, "min_train_timesteps_per_iteration": 0, "min_sample_timesteps_per_iteration": 0, "log_gradients": true, "export_native_model_files": false, "checkpoint_trainable_policies_only": false, "logger_creator": null, "logger_config": null, "log_level": "WARN", "log_sys_usage": true, "fake_sampler": false, "seed": 4, "restart_failed_env_runners": true, "ignore_env_runner_failures": false, "max_num_env_runner_restarts": 1000, "delay_between_env_runner_restarts_s": 60.0, "restart_failed_sub_environments": false, "num_consecutive_env_runner_failures_tolerance": 100, "env_runner_health_probe_timeout_s": 30.0, "env_runner_restore_timeout_s": 1800.0, "_model_config": {}, "_rl_module_spec": "RLModuleSpec(module_class=None, observation_space=None, action_space=None, inference_only=False, learner_only=False, model_config=DefaultModelConfig(fcnet_hiddens=[60, 90], fcnet_activation='tanh', fcnet_kernel_initializer=None, fcnet_kernel_initializer_kwargs=None, fcnet_bias_initializer=None, fcnet_bias_initializer_kwargs=None, conv_filters=None, conv_activation='relu', conv_kernel_initializer=None, conv_kernel_initializer_kwargs=None, conv_bias_initializer=None, conv_bias_initializer_kwargs=None, head_fcnet_hiddens=[], head_fcnet_activation='relu', head_fcnet_kernel_initializer=None, head_fcnet_kernel_initializer_kwargs=None, head_fcnet_bias_initializer=None, head_fcnet_bias_initializer_kwargs=None, free_log_std=False, log_std_clip_param=20.0, vf_share_layers=True, use_lstm=False, max_seq_len=20, lstm_cell_size=256, lstm_use_prev_action=False, lstm_use_prev_reward=False, lstm_kernel_initializer=None, lstm_kernel_initializer_kwargs=None, lstm_bias_initializer=None, lstm_bias_initializer_kwargs=None), catalog_class=None, load_state_path=None, model_config_dict=None)", "algorithm_config_overrides_per_module": {}, "_per_module_overrides": {}, "_validate_config": true, "_use_msgpack_checkpoints": false, "_torch_grad_scaler_class": null, "_torch_lr_scheduler_classes": null, "_tf_policy_handles_more_than_one_loss": false, "_disable_preprocessor_api": false, "_disable_action_flattening": false, "_disable_initialize_loss_from_dummy_batch": false, "_dont_auto_sync_env_runner_states": false, "env_task_fn": -1, "enable_connectors": -1, "simple_optimizer": false, "policy_map_cache": -1, "worker_cls": -1, "synchronize_filters": -1, "enable_async_evaluation": -1, "custom_async_evaluation_function": -1, "_enable_rl_module_api": -1, "auto_wrap_old_gym_envs": -1, "always_attach_evaluation_results": -1, "replay_sequence_length": null, "_disable_execution_plan_api": -1, "use_critic": true, "use_gae": true, "use_kl_loss": true, "kl_coeff": 0.7464963036515, "kl_target": 0.0270990929592, "vf_loss_coeff": 0.6688075857018, "entropy_coeff": 0.0090570820258, "clip_param": 0.1221781641624, "vf_clip_param": 0.1027808522125, "entropy_coeff_schedule": null, "lr_schedule": null, "sgd_minibatch_size": -1, "vf_share_layers": -1, "__stdout_file__": null, "__stderr_file__": null, "lambda": 0.9099046732075, "input": "sampler", "policies": {"default_policy": [null, null, null, null]}, "callbacks": "<class 'ray.rllib.callbacks.callbacks.RLlibCallback'>", "create_env_on_driver": false, "custom_eval_function": null, "framework": "torch"}, "time_since_restore": 9.40358304977417, "iterations_since_restore": 5, "perf": {"cpu_util_percent": 52.26666666666667, "ram_util_percent": 80.96666666666667}}
{"timers": {"training_iteration": 1.8945160958057132, "restore_env_runners": 7.729703747214919e-05, "training_step": 1.8941878146831972, "env_runner_sampling_timer": 1.7792168677710156, "learner_update_timer": 0.11148058793153924, "synch_weights": 0.0006211769080519104, "restore_eval_env_runners": 8.239059756511124e-06, "evaluation_iteration": 0.11900259617230272, "synch_eval_env_connectors": 0.0001305024785682233, "synch_env_connectors": 4.6648781480756595e-06}, "env_runners": {"env_to_module_connector": {"connector_pipeline_timer": 4.417731235649159e-05, "timers": {"connectors": {"add_time_dim_to_batch_and_zero_pad": 2.4593585595696786e-06, "batch_individual_items": 6.41946032148636e-06, "numpy_to_tensor": 8.802515246086516e-06, "add_observations_from_episodes_to_batch": 2.9574240980830065e-06, "add_states_from_episodes_to_batch": 1.7508230955378207e-06}}}, "env_step_timer": 1.4124635604321668e-05, "num_agent_steps_sampled_lifetime": {"default_agent": -2460000.0}, "env_to_module_sum_episodes_length_out": 10.36823839457432, "module_to_env_connector": {"timers": {"connectors": {"normalize_and_clip_actions": 9.692332632757807e-06, "tensor_to_numpy": 1.352653201079273e-05, "remove_single_ts_time_rank_from_batch": 5.911258285100975e-07, "un_batch_to_individual_items": 5.498942349785447e-06, "get_actions": 4.055076369348576e-05, "listify_data_for_vector_env": 1.11379152444034e-05}}, "connector_pipeline_timer": 0.0001070296927044663}, "num_agent_steps_sampled": {"default_agent": 5000.0}, "module_episode_returns_mean": {"default_policy": 6.3400000000000025}, "env_reset_timer": 4.7357438543109996e-05, "episode_return_max": 12.5, "sample": 0.006655215693531651, "env_to_module_sum_episodes_length_in": 10.36823839457432, "num_module_steps_sampled_lifetime": {"default_policy": -2460000.0}, "episode_return_mean": 6.3400000000000025, "episode_duration_sec_mean": 0.00464241451723501, "num_env_steps_sampled": 5000.0, "num_episodes": 250.0, "episode_len_mean": 20.0, "rlmodule_inference_timer": 3.0759588409725324e-05, "episode_len_min": 20, "episode_len_max": 20, "agent_episode_returns_mean": {"default_agent": 6.3400000000000025}, "num_module_steps_sampled": {"default_policy": 5000.0}, "num_episodes_lifetime": -123000.0, "num_env_steps_sampled_lifetime": -2460000.0, "weights_seq_no": 5.0, "episode_return_min": -7.5, "time_between_sampling": 0.001853923357515032, "num_env_steps_sampled_lifetime_throughput": 3580.864326093691}, "learners": {"default_policy": {"curr_kl_coeff": 0.011664004996418953, "gradients_default_optimizer_global_norm": 0.029508594423532486, "vf_loss": 0.10181018710136414, "total_loss": -0.15098221600055695, "num_module_steps_trained": 6000, "diff_num_grad_updates_vs_sampler_policy": 1.0, "module_train_batch_size_mean": 1000.0, "entropy": 0.6470538377761841, "num_module_steps_trained_lifetime": 36000, "curr_entropy_coeff": 0.0090570820258, "vf_loss_unclipped": 28.623245239257812, "weights_seq_no": 6.0, "default_optimizer_learning_rate": 0.0002847858517, "vf_explained_var": 0.02075040340423584, "mean_kl_loss": 0.0009678311762399971, "num_trainable_parameters": 6003, "policy_loss": -0.2132357954978943, "num_module_steps_trained_lifetime_throughput": 345935.924040729}, "__all_modules__": {"learner_connector": {"timers": {"connectors": {"numpy_to_tensor": 6.213684721768753e-05, "batch_individual_items": 0.032501665859253535, "add_columns_from_episodes_to_train_batch": 0.03406257569383712, "add_time_dim_to_batch_and_zero_pad": 9.866016808275112e-06, "add_one_ts_to_episodes_and_truncate": 0.007587532561485827, "add_observations_from_episodes_to_batch": 0.0008098845218416266, "general_advantage_estimation": 0.006819594567713822, "add_states_from_episodes_to_batch": 3.5630019545531825e-06}}, "connector_pipeline_timer": 0.08196429289515438}, "num_env_steps_trained": 31500, "num_env_steps_trained_lifetime": 189000, "learner_connector_sum_episodes_length_out": 5250.0, "learner_connector_sum_episodes_length_in": 5000.0, "num_module_steps_trained_lifetime": 36000, "num_non_trainable_parameters": 0, "num_module_steps_trained": 6000, "num_trainable_parameters": 6003, "num_env_steps_trained_lifetime_throughput": 1805666.1782442061, "num_module_steps_trained_throughput": 345278.71876346, "num_module_steps_trained_lifetime_throughput": 344842.6397316319}}, "num_training_step_calls_per_iteration": 1, "evaluation": {"env_runners": {"sample": 0.10698340277998371, "env_to_module_sum_episodes_length_in": 10.368238394470474, "num_module_steps_sampled": {"default_policy": 400}, "module_to_env_connector": {"timers": {"connectors": {"tensor_to_numpy": 1.26950642354643e-05, "remove_single_ts_time_rank_from_batch": 5.837510782964231e-07, "listify_data_for_vector_env": 1.076332117945474e-05, "normalize_and_clip_actions": 9.38895026209408e-06, "get_actions": 3.499387858628455e-05, "un_batch_to_individual_items": 5.343698314354946e-06}}, "connector_pipeline_timer": 9.963754611988249e-05}, "rlmodule_inference_timer": 2.7274821771789065e-05, "env_to_module_connector": {"timers": {"connectors": {"add_time_dim_to_batch_and_zero_pad": 2.2376207263095384e-06, "numpy_to_tensor": 8.240009403220253e-06, "add_states_from_episodes_to_batch": 1.6865056136628787e-06, "batch_individual_items": 6.219212463919247e-06, "add_observations_from_episodes_to_batch": 2.8245321102342783e-06}}, "connector_pipeline_timer": 4.2945576374955206e-05}, "episode_len_max": 20, "num_agent_steps_sampled_lifetime": {"default_agent": 2400}, "num_episodes_lifetime": 120, "episode_return_min": -16.5, "env_step_timer": 1.373502142344234e-05, "env_to_module_sum_episodes_length_out": 10.368238394470474, "num_env_steps_sampled": 400, "episode_len_mean": 20.0, "num_agent_steps_sampled": {"default_agent": 400}, "num_env_steps_sampled_lifetime": 30400, "weights_seq_no": 6.0, "module_episode_returns_mean": {"default_policy": 0.15}, "num_module_steps_sampled_lifetime": {"default_policy": 2400}, "num_episodes": 20, "episode_len_min": 20, "env_reset_timer": 0.0005368065227151769, "episode_return_max": 12.5, "agent_episode_returns_mean": {"default_agent": 0.15}, "episode_return_mean": 0.15, "episode_duration_sec_mean": 0.0048837016907054935, "time_between_sampling": 1.7542898083223701}, "num_healthy_workers": 1, "actor_manager_num_outstanding_async_reqs": 0, "num_remote_worker_restarts": 0}, "num_env_steps_sampled_lifetime": -2460000.0, "fault_tolerance": {"num_healthy_workers": 0, "num_remote_worker_restarts": 0}, "env_runner_group": {"actor_manager_num_outstanding_async_reqs": 0}, "done": false, "training_iteration": 6, "trial_id": "4da5b_00000", "date": "2025-08-11_19-21-46", "timestamp": 1754932906, "time_this_iter_s": 1.721601963043213, "time_total_s": 11.125185012817383, "pid": 14327, "hostname": "Mac", "node_ip": "127.0.0.1", "config": {"exploration_config": {}, "extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "placement_strategy": "PACK", "num_gpus": 0, "_fake_gpus": false, "num_cpus_for_main_process": 2, "eager_tracing": true, "eager_max_retraces": 20, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "torch_compile_learner": false, "torch_compile_learner_what_to_compile": "forward_train", "torch_compile_learner_dynamo_backend": "aot_eager", "torch_compile_learner_dynamo_mode": null, "torch_compile_worker": false, "torch_compile_worker_dynamo_backend": "aot_eager", "torch_compile_worker_dynamo_mode": null, "torch_ddp_kwargs": {}, "torch_skip_nan_gradients": false, "env": "Umbrella", "env_config": {}, "observation_space": null, "action_space": null, "clip_rewards": null, "normalize_actions": true, "clip_actions": false, "_is_atari": null, "disable_env_checking": false, "render_env": false, "action_mask_key": "action_mask", "env_runner_cls": null, "num_env_runners": 0, "create_local_env_runner": true, "num_envs_per_env_runner": 1, "gym_env_vectorize_mode": "SYNC", "num_cpus_per_env_runner": 1, "num_gpus_per_env_runner": 0, "custom_resources_per_env_runner": {}, "validate_env_runners_after_construction": true, "episodes_to_numpy": true, "max_requests_in_flight_per_env_runner": 1, "sample_timeout_s": 60.0, "_env_to_module_connector": null, "add_default_connectors_to_env_to_module_pipeline": true, "_module_to_env_connector": null, "add_default_connectors_to_module_to_env_pipeline": true, "merge_env_runner_states": "training_only", "broadcast_env_runner_states": true, "episode_lookback_horizon": 1, "rollout_fragment_length": "auto", "batch_mode": "complete_episodes", "compress_observations": false, "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "enable_tf1_exec_eagerly": false, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "preprocessor_pref": "deepmind", "observation_filter": "NoFilter", "update_worker_filter_stats": true, "use_worker_filter_stats": true, "sampler_perf_stats_ema_coef": null, "_is_online": true, "num_learners": 0, "num_gpus_per_learner": 0, "num_cpus_per_learner": "auto", "num_aggregator_actors_per_learner": 0, "max_requests_in_flight_per_aggregator_actor": 3, "local_gpu_idx": 0, "max_requests_in_flight_per_learner": 3, "gamma": 1, "lr": 0.0002847858517, "grad_clip": 0.5, "grad_clip_by": "global_norm", "_train_batch_size_per_learner": 5000, "train_batch_size": 4000, "num_epochs": 1, "minibatch_size": 1000, "shuffle_batch_per_epoch": true, "model": {"fcnet_hiddens": [256, 256], "fcnet_activation": "tanh", "fcnet_weights_initializer": null, "fcnet_weights_initializer_config": null, "fcnet_bias_initializer": null, "fcnet_bias_initializer_config": null, "conv_filters": null, "conv_activation": "relu", "conv_kernel_initializer": null, "conv_kernel_initializer_config": null, "conv_bias_initializer": null, "conv_bias_initializer_config": null, "conv_transpose_kernel_initializer": null, "conv_transpose_kernel_initializer_config": null, "conv_transpose_bias_initializer": null, "conv_transpose_bias_initializer_config": null, "post_fcnet_hiddens": [], "post_fcnet_activation": "relu", "post_fcnet_weights_initializer": null, "post_fcnet_weights_initializer_config": null, "post_fcnet_bias_initializer": null, "post_fcnet_bias_initializer_config": null, "free_log_std": false, "log_std_clip_param": 20.0, "no_final_linear": false, "vf_share_layers": false, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "lstm_weights_initializer": null, "lstm_weights_initializer_config": null, "lstm_bias_initializer": null, "lstm_bias_initializer_config": null, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "attention_use_n_prev_actions": 0, "attention_use_n_prev_rewards": 0, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": null, "custom_model_config": {}, "custom_action_dist": null, "custom_preprocessor": null, "encoder_latent_dim": null, "always_check_shapes": false, "lstm_use_prev_action_reward": -1, "_use_default_native_models": -1, "_disable_preprocessor_api": false, "_disable_action_flattening": false}, "_learner_connector": null, "add_default_connectors_to_learner_pipeline": true, "learner_config_dict": {}, "optimizer": {}, "_learner_class": null, "callbacks_on_algorithm_init": null, "callbacks_on_env_runners_recreated": null, "callbacks_on_offline_eval_runners_recreated": null, "callbacks_on_checkpoint_loaded": null, "callbacks_on_environment_created": null, "callbacks_on_episode_created": null, "callbacks_on_episode_start": null, "callbacks_on_episode_step": null, "callbacks_on_episode_end": null, "callbacks_on_evaluate_start": null, "callbacks_on_evaluate_end": null, "callbacks_on_evaluate_offline_start": null, "callbacks_on_evaluate_offline_end": null, "callbacks_on_sample_end": null, "callbacks_on_train_result": null, "explore": true, "enable_rl_module_and_learner": true, "enable_env_runner_and_connector_v2": true, "_prior_exploration_config": {"type": "StochasticSampling"}, "count_steps_by": "env_steps", "policy_map_capacity": 100, "policy_mapping_fn": "<function AlgorithmConfig.DEFAULT_POLICY_MAPPING_FN at 0x383de9b20>", "policies_to_train": null, "policy_states_are_swappable": false, "observation_fn": null, "offline_data_class": null, "input_read_method": "read_parquet", "input_read_method_kwargs": {}, "input_read_schema": {}, "input_read_episodes": false, "input_read_sample_batches": false, "input_read_batch_size": null, "input_filesystem": null, "input_filesystem_kwargs": {}, "input_compress_columns": ["obs", "new_obs"], "input_spaces_jsonable": true, "materialize_data": false, "materialize_mapped_data": true, "map_batches_kwargs": {}, "iter_batches_kwargs": {}, "ignore_final_observation": false, "prelearner_class": null, "prelearner_buffer_class": null, "prelearner_buffer_kwargs": {}, "prelearner_module_synch_period": 10, "dataset_num_iters_per_learner": null, "input_config": {}, "actions_in_input_normalized": false, "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_config": {}, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "output_max_rows_per_file": null, "output_write_remaining_data": false, "output_write_method": "write_parquet", "output_write_method_kwargs": {}, "output_filesystem": null, "output_filesystem_kwargs": {}, "output_write_episodes": true, "offline_sampling": false, "evaluation_interval": 1, "evaluation_duration": 20, "evaluation_duration_unit": "episodes", "evaluation_sample_timeout_s": 120.0, "evaluation_auto_duration_min_env_steps_per_sample": 100, "evaluation_auto_duration_max_env_steps_per_sample": 2000, "evaluation_parallel_to_training": false, "evaluation_force_reset_envs_before_iteration": true, "evaluation_config": null, "off_policy_estimation_methods": {}, "ope_split_batch_by_episode": true, "evaluation_num_env_runners": 1, "in_evaluation": false, "sync_filters_on_rollout_workers_timeout_s": 10.0, "offline_evaluation_interval": null, "num_offline_eval_runners": 0, "offline_loss_for_module_fn": null, "offline_evaluation_duration": 1, "offline_evaluation_parallel_to_training": false, "offline_evaluation_timeout_s": 120.0, "num_cpus_per_offline_eval_runner": 1, "num_gpus_per_offline_eval_runner": 0, "custom_resources_per_offline_eval_runner": {}, "restart_failed_offline_eval_runners": true, "ignore_offline_eval_runner_failures": false, "max_num_offline_eval_runner_restarts": 1000, "offline_eval_runner_restore_timeout_s": 1800.0, "max_requests_in_flight_per_offline_eval_runner": 1, "validate_offline_eval_runners_after_construction": true, "offline_eval_runner_health_probe_timeout_s": 30.0, "offline_eval_rl_module_inference_only": false, "broadcast_offline_eval_runner_states": false, "offline_eval_batch_size_per_runner": 256, "dataset_num_iters_per_eval_runner": 1, "keep_per_episode_custom_metrics": false, "metrics_episode_collection_timeout_s": 60.0, "metrics_num_episodes_for_smoothing": 100, "min_time_s_per_iteration": null, "min_train_timesteps_per_iteration": 0, "min_sample_timesteps_per_iteration": 0, "log_gradients": true, "export_native_model_files": false, "checkpoint_trainable_policies_only": false, "logger_creator": null, "logger_config": null, "log_level": "WARN", "log_sys_usage": true, "fake_sampler": false, "seed": 4, "restart_failed_env_runners": true, "ignore_env_runner_failures": false, "max_num_env_runner_restarts": 1000, "delay_between_env_runner_restarts_s": 60.0, "restart_failed_sub_environments": false, "num_consecutive_env_runner_failures_tolerance": 100, "env_runner_health_probe_timeout_s": 30.0, "env_runner_restore_timeout_s": 1800.0, "_model_config": {}, "_rl_module_spec": "RLModuleSpec(module_class=None, observation_space=None, action_space=None, inference_only=False, learner_only=False, model_config=DefaultModelConfig(fcnet_hiddens=[60, 90], fcnet_activation='tanh', fcnet_kernel_initializer=None, fcnet_kernel_initializer_kwargs=None, fcnet_bias_initializer=None, fcnet_bias_initializer_kwargs=None, conv_filters=None, conv_activation='relu', conv_kernel_initializer=None, conv_kernel_initializer_kwargs=None, conv_bias_initializer=None, conv_bias_initializer_kwargs=None, head_fcnet_hiddens=[], head_fcnet_activation='relu', head_fcnet_kernel_initializer=None, head_fcnet_kernel_initializer_kwargs=None, head_fcnet_bias_initializer=None, head_fcnet_bias_initializer_kwargs=None, free_log_std=False, log_std_clip_param=20.0, vf_share_layers=True, use_lstm=False, max_seq_len=20, lstm_cell_size=256, lstm_use_prev_action=False, lstm_use_prev_reward=False, lstm_kernel_initializer=None, lstm_kernel_initializer_kwargs=None, lstm_bias_initializer=None, lstm_bias_initializer_kwargs=None), catalog_class=None, load_state_path=None, model_config_dict=None)", "algorithm_config_overrides_per_module": {}, "_per_module_overrides": {}, "_validate_config": true, "_use_msgpack_checkpoints": false, "_torch_grad_scaler_class": null, "_torch_lr_scheduler_classes": null, "_tf_policy_handles_more_than_one_loss": false, "_disable_preprocessor_api": false, "_disable_action_flattening": false, "_disable_initialize_loss_from_dummy_batch": false, "_dont_auto_sync_env_runner_states": false, "env_task_fn": -1, "enable_connectors": -1, "simple_optimizer": false, "policy_map_cache": -1, "worker_cls": -1, "synchronize_filters": -1, "enable_async_evaluation": -1, "custom_async_evaluation_function": -1, "_enable_rl_module_api": -1, "auto_wrap_old_gym_envs": -1, "always_attach_evaluation_results": -1, "replay_sequence_length": null, "_disable_execution_plan_api": -1, "use_critic": true, "use_gae": true, "use_kl_loss": true, "kl_coeff": 0.7464963036515, "kl_target": 0.0270990929592, "vf_loss_coeff": 0.6688075857018, "entropy_coeff": 0.0090570820258, "clip_param": 0.1221781641624, "vf_clip_param": 0.1027808522125, "entropy_coeff_schedule": null, "lr_schedule": null, "sgd_minibatch_size": -1, "vf_share_layers": -1, "__stdout_file__": null, "__stderr_file__": null, "lambda": 0.9099046732075, "input": "sampler", "policies": {"default_policy": [null, null, null, null]}, "callbacks": "<class 'ray.rllib.callbacks.callbacks.RLlibCallback'>", "create_env_on_driver": false, "custom_eval_function": null, "framework": "torch"}, "time_since_restore": 11.125185012817383, "iterations_since_restore": 6, "perf": {"cpu_util_percent": 52.75, "ram_util_percent": 80.8}}
{"timers": {"training_iteration": 1.8910491985976299, "restore_env_runners": 7.658698725056872e-05, "training_step": 1.8907224448759994, "env_runner_sampling_timer": 1.7758225636736926, "learner_update_timer": 0.1114111383018934, "synch_weights": 0.0006214601383689374, "restore_eval_env_runners": 8.23083968878839e-06, "evaluation_iteration": 0.11885450438064141, "synch_eval_env_connectors": 0.00013032203394046179, "synch_env_connectors": 4.658639453107469e-06}, "env_runners": {"env_to_module_connector": {"connector_pipeline_timer": 4.4768495550267334e-05, "timers": {"connectors": {"add_time_dim_to_batch_and_zero_pad": 2.4939424059132654e-06, "batch_individual_items": 6.517371750977819e-06, "numpy_to_tensor": 8.989019775544708e-06, "add_observations_from_episodes_to_batch": 3.0530146429707406e-06, "add_states_from_episodes_to_batch": 1.7739871967199206e-06}}}, "env_step_timer": 1.4363915950321958e-05, "num_agent_steps_sampled_lifetime": {"default_agent": -3077500.0}, "env_to_module_sum_episodes_length_out": 10.36823839457432, "module_to_env_connector": {"timers": {"connectors": {"normalize_and_clip_actions": 9.800702738154146e-06, "tensor_to_numpy": 1.3675590821777816e-05, "remove_single_ts_time_rank_from_batch": 6.002995732757319e-07, "un_batch_to_individual_items": 5.620697838107098e-06, "get_actions": 4.105732539493208e-05, "listify_data_for_vector_env": 1.1401006067736658e-05}}, "connector_pipeline_timer": 0.00010822928846122895}, "num_agent_steps_sampled": {"default_agent": 5000.0}, "module_episode_returns_mean": {"default_policy": 6.820000000000002}, "env_reset_timer": 3.896800109398022e-05, "episode_return_max": 12.5, "sample": 0.005118592197383033, "env_to_module_sum_episodes_length_in": 10.36823839457432, "num_module_steps_sampled_lifetime": {"default_policy": -3077500.0}, "episode_return_mean": 6.820000000000002, "episode_duration_sec_mean": 0.004727909980341791, "num_env_steps_sampled": 5000.0, "num_episodes": 250.0, "episode_len_mean": 20.0, "rlmodule_inference_timer": 2.935771560743704e-05, "episode_len_min": 20, "episode_len_max": 20, "agent_episode_returns_mean": {"default_agent": 6.820000000000002}, "num_module_steps_sampled": {"default_policy": 5000.0}, "num_episodes_lifetime": -153875.0, "num_env_steps_sampled_lifetime": -3077500.0, "weights_seq_no": 6.0, "episode_return_min": -7.5, "time_between_sampling": 0.0019291416364211574, "num_env_steps_sampled_lifetime_throughput": 3604.8371064108114}, "learners": {"default_policy": {"curr_kl_coeff": 0.0058320024982094765, "gradients_default_optimizer_global_norm": 0.06353103369474411, "vf_loss": 0.10148672014474869, "total_loss": 0.01327641773968935, "num_module_steps_trained": 6000, "diff_num_grad_updates_vs_sampler_policy": 1.0, "module_train_batch_size_mean": 1000.0, "entropy": 0.6315293908119202, "num_module_steps_trained_lifetime": 42000, "curr_entropy_coeff": 0.0090570820258, "vf_loss_unclipped": 28.57539176940918, "weights_seq_no": 7.0, "default_optimizer_learning_rate": 0.0002847858517, "vf_explained_var": 0.021754086017608643, "mean_kl_loss": 0.0012224273523315787, "num_trainable_parameters": 6003, "policy_loss": -0.04889311641454697, "num_module_steps_trained_lifetime_throughput": 346140.65023853903}, "__all_modules__": {"learner_connector": {"timers": {"connectors": {"numpy_to_tensor": 6.213297820877083e-05, "batch_individual_items": 0.0324871400305311, "add_columns_from_episodes_to_train_batch": 0.034152618687676585, "add_time_dim_to_batch_and_zero_pad": 9.885686994063348e-06, "add_one_ts_to_episodes_and_truncate": 0.007593243906001459, "add_observations_from_episodes_to_batch": 0.0008109573366814107, "general_advantage_estimation": 0.00681022862179834, "add_states_from_episodes_to_batch": 3.556962381509621e-06}}, "connector_pipeline_timer": 0.08203723330637641}, "num_env_steps_trained": 31500, "num_env_steps_trained_lifetime": 220500, "learner_connector_sum_episodes_length_out": 5250.0, "learner_connector_sum_episodes_length_in": 5000.0, "num_module_steps_trained_lifetime": 42000, "num_non_trainable_parameters": 0, "num_module_steps_trained": 6000, "num_trainable_parameters": 6003, "num_env_steps_trained_lifetime_throughput": 1807280.3806250843, "num_module_steps_trained_throughput": 345536.31934560364, "num_module_steps_trained_lifetime_throughput": 345113.4297619866}}, "num_training_step_calls_per_iteration": 1, "evaluation": {"env_runners": {"sample": 0.10694430750172522, "env_to_module_sum_episodes_length_in": 10.368238394572801, "num_module_steps_sampled": {"default_policy": 400}, "module_to_env_connector": {"timers": {"connectors": {"tensor_to_numpy": 1.3058490857714498e-05, "remove_single_ts_time_rank_from_batch": 5.80275116121491e-07, "listify_data_for_vector_env": 1.1214332919299887e-05, "normalize_and_clip_actions": 9.395173324106146e-06, "get_actions": 3.6955689551755885e-05, "un_batch_to_individual_items": 5.3883622388711255e-06}}, "connector_pipeline_timer": 0.00010273291601735967}, "rlmodule_inference_timer": 2.8000980664895873e-05, "env_to_module_connector": {"timers": {"connectors": {"add_time_dim_to_batch_and_zero_pad": 2.2275491035206904e-06, "numpy_to_tensor": 8.453270865236458e-06, "add_states_from_episodes_to_batch": 1.652313668496105e-06, "batch_individual_items": 6.348212227778352e-06, "add_observations_from_episodes_to_batch": 2.829743582006966e-06}}, "connector_pipeline_timer": 4.356653724125311e-05}, "episode_len_max": 20, "num_agent_steps_sampled_lifetime": {"default_agent": 2800}, "num_episodes_lifetime": 140, "episode_return_min": -16.5, "env_step_timer": 1.4121580997257624e-05, "env_to_module_sum_episodes_length_out": 10.368238394572801, "num_env_steps_sampled": 400, "episode_len_mean": 20.0, "num_agent_steps_sampled": {"default_agent": 400}, "num_env_steps_sampled_lifetime": 35400, "weights_seq_no": 7.0, "module_episode_returns_mean": {"default_policy": 1.35}, "num_module_steps_sampled_lifetime": {"default_policy": 2800}, "num_episodes": 20, "episode_len_min": 20, "env_reset_timer": 0.000532120118091757, "episode_return_max": 12.5, "agent_episode_returns_mean": {"default_agent": 1.35}, "episode_return_mean": 1.35, "episode_duration_sec_mean": 0.004883604221977294, "time_between_sampling": 1.7523967639895113}, "num_healthy_workers": 1, "actor_manager_num_outstanding_async_reqs": 0, "num_remote_worker_restarts": 0}, "num_env_steps_sampled_lifetime": -3077500.0, "fault_tolerance": {"num_healthy_workers": 0, "num_remote_worker_restarts": 0}, "env_runner_group": {"actor_manager_num_outstanding_async_reqs": 0}, "done": false, "training_iteration": 7, "trial_id": "4da5b_00000", "date": "2025-08-11_19-21-48", "timestamp": 1754932908, "time_this_iter_s": 1.6587393283843994, "time_total_s": 12.783924341201782, "pid": 14327, "hostname": "Mac", "node_ip": "127.0.0.1", "config": {"exploration_config": {}, "extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "placement_strategy": "PACK", "num_gpus": 0, "_fake_gpus": false, "num_cpus_for_main_process": 2, "eager_tracing": true, "eager_max_retraces": 20, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "torch_compile_learner": false, "torch_compile_learner_what_to_compile": "forward_train", "torch_compile_learner_dynamo_backend": "aot_eager", "torch_compile_learner_dynamo_mode": null, "torch_compile_worker": false, "torch_compile_worker_dynamo_backend": "aot_eager", "torch_compile_worker_dynamo_mode": null, "torch_ddp_kwargs": {}, "torch_skip_nan_gradients": false, "env": "Umbrella", "env_config": {}, "observation_space": null, "action_space": null, "clip_rewards": null, "normalize_actions": true, "clip_actions": false, "_is_atari": null, "disable_env_checking": false, "render_env": false, "action_mask_key": "action_mask", "env_runner_cls": null, "num_env_runners": 0, "create_local_env_runner": true, "num_envs_per_env_runner": 1, "gym_env_vectorize_mode": "SYNC", "num_cpus_per_env_runner": 1, "num_gpus_per_env_runner": 0, "custom_resources_per_env_runner": {}, "validate_env_runners_after_construction": true, "episodes_to_numpy": true, "max_requests_in_flight_per_env_runner": 1, "sample_timeout_s": 60.0, "_env_to_module_connector": null, "add_default_connectors_to_env_to_module_pipeline": true, "_module_to_env_connector": null, "add_default_connectors_to_module_to_env_pipeline": true, "merge_env_runner_states": "training_only", "broadcast_env_runner_states": true, "episode_lookback_horizon": 1, "rollout_fragment_length": "auto", "batch_mode": "complete_episodes", "compress_observations": false, "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "enable_tf1_exec_eagerly": false, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "preprocessor_pref": "deepmind", "observation_filter": "NoFilter", "update_worker_filter_stats": true, "use_worker_filter_stats": true, "sampler_perf_stats_ema_coef": null, "_is_online": true, "num_learners": 0, "num_gpus_per_learner": 0, "num_cpus_per_learner": "auto", "num_aggregator_actors_per_learner": 0, "max_requests_in_flight_per_aggregator_actor": 3, "local_gpu_idx": 0, "max_requests_in_flight_per_learner": 3, "gamma": 1, "lr": 0.0002847858517, "grad_clip": 0.5, "grad_clip_by": "global_norm", "_train_batch_size_per_learner": 5000, "train_batch_size": 4000, "num_epochs": 1, "minibatch_size": 1000, "shuffle_batch_per_epoch": true, "model": {"fcnet_hiddens": [256, 256], "fcnet_activation": "tanh", "fcnet_weights_initializer": null, "fcnet_weights_initializer_config": null, "fcnet_bias_initializer": null, "fcnet_bias_initializer_config": null, "conv_filters": null, "conv_activation": "relu", "conv_kernel_initializer": null, "conv_kernel_initializer_config": null, "conv_bias_initializer": null, "conv_bias_initializer_config": null, "conv_transpose_kernel_initializer": null, "conv_transpose_kernel_initializer_config": null, "conv_transpose_bias_initializer": null, "conv_transpose_bias_initializer_config": null, "post_fcnet_hiddens": [], "post_fcnet_activation": "relu", "post_fcnet_weights_initializer": null, "post_fcnet_weights_initializer_config": null, "post_fcnet_bias_initializer": null, "post_fcnet_bias_initializer_config": null, "free_log_std": false, "log_std_clip_param": 20.0, "no_final_linear": false, "vf_share_layers": false, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "lstm_weights_initializer": null, "lstm_weights_initializer_config": null, "lstm_bias_initializer": null, "lstm_bias_initializer_config": null, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "attention_use_n_prev_actions": 0, "attention_use_n_prev_rewards": 0, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": null, "custom_model_config": {}, "custom_action_dist": null, "custom_preprocessor": null, "encoder_latent_dim": null, "always_check_shapes": false, "lstm_use_prev_action_reward": -1, "_use_default_native_models": -1, "_disable_preprocessor_api": false, "_disable_action_flattening": false}, "_learner_connector": null, "add_default_connectors_to_learner_pipeline": true, "learner_config_dict": {}, "optimizer": {}, "_learner_class": null, "callbacks_on_algorithm_init": null, "callbacks_on_env_runners_recreated": null, "callbacks_on_offline_eval_runners_recreated": null, "callbacks_on_checkpoint_loaded": null, "callbacks_on_environment_created": null, "callbacks_on_episode_created": null, "callbacks_on_episode_start": null, "callbacks_on_episode_step": null, "callbacks_on_episode_end": null, "callbacks_on_evaluate_start": null, "callbacks_on_evaluate_end": null, "callbacks_on_evaluate_offline_start": null, "callbacks_on_evaluate_offline_end": null, "callbacks_on_sample_end": null, "callbacks_on_train_result": null, "explore": true, "enable_rl_module_and_learner": true, "enable_env_runner_and_connector_v2": true, "_prior_exploration_config": {"type": "StochasticSampling"}, "count_steps_by": "env_steps", "policy_map_capacity": 100, "policy_mapping_fn": "<function AlgorithmConfig.DEFAULT_POLICY_MAPPING_FN at 0x383de9b20>", "policies_to_train": null, "policy_states_are_swappable": false, "observation_fn": null, "offline_data_class": null, "input_read_method": "read_parquet", "input_read_method_kwargs": {}, "input_read_schema": {}, "input_read_episodes": false, "input_read_sample_batches": false, "input_read_batch_size": null, "input_filesystem": null, "input_filesystem_kwargs": {}, "input_compress_columns": ["obs", "new_obs"], "input_spaces_jsonable": true, "materialize_data": false, "materialize_mapped_data": true, "map_batches_kwargs": {}, "iter_batches_kwargs": {}, "ignore_final_observation": false, "prelearner_class": null, "prelearner_buffer_class": null, "prelearner_buffer_kwargs": {}, "prelearner_module_synch_period": 10, "dataset_num_iters_per_learner": null, "input_config": {}, "actions_in_input_normalized": false, "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_config": {}, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "output_max_rows_per_file": null, "output_write_remaining_data": false, "output_write_method": "write_parquet", "output_write_method_kwargs": {}, "output_filesystem": null, "output_filesystem_kwargs": {}, "output_write_episodes": true, "offline_sampling": false, "evaluation_interval": 1, "evaluation_duration": 20, "evaluation_duration_unit": "episodes", "evaluation_sample_timeout_s": 120.0, "evaluation_auto_duration_min_env_steps_per_sample": 100, "evaluation_auto_duration_max_env_steps_per_sample": 2000, "evaluation_parallel_to_training": false, "evaluation_force_reset_envs_before_iteration": true, "evaluation_config": null, "off_policy_estimation_methods": {}, "ope_split_batch_by_episode": true, "evaluation_num_env_runners": 1, "in_evaluation": false, "sync_filters_on_rollout_workers_timeout_s": 10.0, "offline_evaluation_interval": null, "num_offline_eval_runners": 0, "offline_loss_for_module_fn": null, "offline_evaluation_duration": 1, "offline_evaluation_parallel_to_training": false, "offline_evaluation_timeout_s": 120.0, "num_cpus_per_offline_eval_runner": 1, "num_gpus_per_offline_eval_runner": 0, "custom_resources_per_offline_eval_runner": {}, "restart_failed_offline_eval_runners": true, "ignore_offline_eval_runner_failures": false, "max_num_offline_eval_runner_restarts": 1000, "offline_eval_runner_restore_timeout_s": 1800.0, "max_requests_in_flight_per_offline_eval_runner": 1, "validate_offline_eval_runners_after_construction": true, "offline_eval_runner_health_probe_timeout_s": 30.0, "offline_eval_rl_module_inference_only": false, "broadcast_offline_eval_runner_states": false, "offline_eval_batch_size_per_runner": 256, "dataset_num_iters_per_eval_runner": 1, "keep_per_episode_custom_metrics": false, "metrics_episode_collection_timeout_s": 60.0, "metrics_num_episodes_for_smoothing": 100, "min_time_s_per_iteration": null, "min_train_timesteps_per_iteration": 0, "min_sample_timesteps_per_iteration": 0, "log_gradients": true, "export_native_model_files": false, "checkpoint_trainable_policies_only": false, "logger_creator": null, "logger_config": null, "log_level": "WARN", "log_sys_usage": true, "fake_sampler": false, "seed": 4, "restart_failed_env_runners": true, "ignore_env_runner_failures": false, "max_num_env_runner_restarts": 1000, "delay_between_env_runner_restarts_s": 60.0, "restart_failed_sub_environments": false, "num_consecutive_env_runner_failures_tolerance": 100, "env_runner_health_probe_timeout_s": 30.0, "env_runner_restore_timeout_s": 1800.0, "_model_config": {}, "_rl_module_spec": "RLModuleSpec(module_class=None, observation_space=None, action_space=None, inference_only=False, learner_only=False, model_config=DefaultModelConfig(fcnet_hiddens=[60, 90], fcnet_activation='tanh', fcnet_kernel_initializer=None, fcnet_kernel_initializer_kwargs=None, fcnet_bias_initializer=None, fcnet_bias_initializer_kwargs=None, conv_filters=None, conv_activation='relu', conv_kernel_initializer=None, conv_kernel_initializer_kwargs=None, conv_bias_initializer=None, conv_bias_initializer_kwargs=None, head_fcnet_hiddens=[], head_fcnet_activation='relu', head_fcnet_kernel_initializer=None, head_fcnet_kernel_initializer_kwargs=None, head_fcnet_bias_initializer=None, head_fcnet_bias_initializer_kwargs=None, free_log_std=False, log_std_clip_param=20.0, vf_share_layers=True, use_lstm=False, max_seq_len=20, lstm_cell_size=256, lstm_use_prev_action=False, lstm_use_prev_reward=False, lstm_kernel_initializer=None, lstm_kernel_initializer_kwargs=None, lstm_bias_initializer=None, lstm_bias_initializer_kwargs=None), catalog_class=None, load_state_path=None, model_config_dict=None)", "algorithm_config_overrides_per_module": {}, "_per_module_overrides": {}, "_validate_config": true, "_use_msgpack_checkpoints": false, "_torch_grad_scaler_class": null, "_torch_lr_scheduler_classes": null, "_tf_policy_handles_more_than_one_loss": false, "_disable_preprocessor_api": false, "_disable_action_flattening": false, "_disable_initialize_loss_from_dummy_batch": false, "_dont_auto_sync_env_runner_states": false, "env_task_fn": -1, "enable_connectors": -1, "simple_optimizer": false, "policy_map_cache": -1, "worker_cls": -1, "synchronize_filters": -1, "enable_async_evaluation": -1, "custom_async_evaluation_function": -1, "_enable_rl_module_api": -1, "auto_wrap_old_gym_envs": -1, "always_attach_evaluation_results": -1, "replay_sequence_length": null, "_disable_execution_plan_api": -1, "use_critic": true, "use_gae": true, "use_kl_loss": true, "kl_coeff": 0.7464963036515, "kl_target": 0.0270990929592, "vf_loss_coeff": 0.6688075857018, "entropy_coeff": 0.0090570820258, "clip_param": 0.1221781641624, "vf_clip_param": 0.1027808522125, "entropy_coeff_schedule": null, "lr_schedule": null, "sgd_minibatch_size": -1, "vf_share_layers": -1, "__stdout_file__": null, "__stderr_file__": null, "lambda": 0.9099046732075, "input": "sampler", "policies": {"default_policy": [null, null, null, null]}, "callbacks": "<class 'ray.rllib.callbacks.callbacks.RLlibCallback'>", "create_env_on_driver": false, "custom_eval_function": null, "framework": "torch"}, "time_since_restore": 12.783924341201782, "iterations_since_restore": 7, "perf": {"cpu_util_percent": 32.5, "ram_util_percent": 79.5}}
{"timers": {"training_iteration": 1.8884538782825206, "restore_env_runners": 7.588903756927652e-05, "training_step": 1.8881282154272832, "env_runner_sampling_timer": 1.7733636176161498, "learner_update_timer": 0.111274756088992, "synch_weights": 0.0006219634461127219, "restore_eval_env_runners": 8.206861188901892e-06, "evaluation_iteration": 0.11875269392718843, "synch_eval_env_connectors": 0.0001299879839609518, "synch_env_connectors": 4.6487238849518786e-06}, "env_runners": {"env_to_module_connector": {"connector_pipeline_timer": 4.5023178536989255e-05, "timers": {"connectors": {"add_time_dim_to_batch_and_zero_pad": 2.504895416404355e-06, "batch_individual_items": 6.550753695836222e-06, "numpy_to_tensor": 8.93474926668121e-06, "add_observations_from_episodes_to_batch": 3.1145429406848993e-06, "add_states_from_episodes_to_batch": 1.7872231316253614e-06}}}, "env_step_timer": 1.4499894566676914e-05, "num_agent_steps_sampled_lifetime": {"default_agent": -3695000.0}, "env_to_module_sum_episodes_length_out": 10.36823839457432, "module_to_env_connector": {"timers": {"connectors": {"normalize_and_clip_actions": 9.846499574368644e-06, "tensor_to_numpy": 1.3775060881777695e-05, "remove_single_ts_time_rank_from_batch": 6.095384314209317e-07, "un_batch_to_individual_items": 5.584033203990526e-06, "get_actions": 4.1437108004417424e-05, "listify_data_for_vector_env": 1.1615413723808156e-05}}, "connector_pipeline_timer": 0.00010927911979686196}, "num_agent_steps_sampled": {"default_agent": 5000.0}, "module_episode_returns_mean": {"default_policy": 7.46}, "env_reset_timer": 4.068699344074866e-05, "episode_return_max": 12.5, "sample": 0.0053882699208989155, "env_to_module_sum_episodes_length_in": 10.36823839457432, "num_module_steps_sampled_lifetime": {"default_policy": -3695000.0}, "episode_return_mean": 7.46, "episode_duration_sec_mean": 0.005098445208277554, "num_env_steps_sampled": 5000.0, "num_episodes": 250.0, "episode_len_mean": 20.0, "rlmodule_inference_timer": 4.494789209921236e-05, "episode_len_min": 20, "episode_len_max": 20, "agent_episode_returns_mean": {"default_agent": 7.46}, "num_module_steps_sampled": {"default_policy": 5000.0}, "num_episodes_lifetime": -184750.0, "num_env_steps_sampled_lifetime": -3695000.0, "weights_seq_no": 7.0, "episode_return_min": -7.5, "time_between_sampling": 0.0016330398763712349, "num_env_steps_sampled_lifetime_throughput": 3554.778685850782}, "learners": {"default_policy": {"curr_kl_coeff": 0.0029160012491047382, "gradients_default_optimizer_global_norm": 0.14886373281478882, "vf_loss": 0.10170264542102814, "total_loss": -0.05461999401450157, "num_module_steps_trained": 6000, "diff_num_grad_updates_vs_sampler_policy": 1.0, "module_train_batch_size_mean": 1000.0, "entropy": 0.6054023504257202, "num_module_steps_trained_lifetime": 48000, "curr_entropy_coeff": 0.0090570820258, "vf_loss_unclipped": 28.60869026184082, "weights_seq_no": 8.0, "default_optimizer_learning_rate": 0.0002847858517, "vf_explained_var": 0.020945727825164795, "mean_kl_loss": 0.0014844421530142426, "num_trainable_parameters": 6003, "policy_loss": -0.1171649619936943, "num_module_steps_trained_lifetime_throughput": 346400.0504353314}, "__all_modules__": {"learner_connector": {"timers": {"connectors": {"numpy_to_tensor": 6.235623809407787e-05, "batch_individual_items": 0.03247386154066457, "add_columns_from_episodes_to_train_batch": 0.034160392501616406, "add_time_dim_to_batch_and_zero_pad": 9.890159199623084e-06, "add_one_ts_to_episodes_and_truncate": 0.007600465216524734, "add_observations_from_episodes_to_batch": 0.0008142290129565962, "general_advantage_estimation": 0.0067968800854445325, "add_states_from_episodes_to_batch": 3.5509727268175307e-06}}, "connector_pipeline_timer": 0.08202911806389608}, "num_env_steps_trained": 31500, "num_env_steps_trained_lifetime": 252000, "learner_connector_sum_episodes_length_out": 5250.0, "learner_connector_sum_episodes_length_in": 5000.0, "num_module_steps_trained_lifetime": 48000, "num_non_trainable_parameters": 0, "num_module_steps_trained": 6000, "num_trainable_parameters": 6003, "num_env_steps_trained_lifetime_throughput": 1809197.7237459647, "num_module_steps_trained_throughput": 345852.81924403214, "num_module_steps_trained_lifetime_throughput": 345442.5014310999}}, "num_training_step_calls_per_iteration": 1, "evaluation": {"env_runners": {"sample": 0.10686408692648273, "env_to_module_sum_episodes_length_in": 10.3682383945743, "num_module_steps_sampled": {"default_policy": 400}, "module_to_env_connector": {"timers": {"connectors": {"tensor_to_numpy": 1.2576295040397417e-05, "remove_single_ts_time_rank_from_batch": 5.808357722609109e-07, "listify_data_for_vector_env": 1.067651935467456e-05, "normalize_and_clip_actions": 9.196497903088862e-06, "get_actions": 3.435505657074294e-05, "un_batch_to_individual_items": 5.189756674445677e-06}}, "connector_pipeline_timer": 9.825977190256168e-05}, "rlmodule_inference_timer": 2.694782125740897e-05, "env_to_module_connector": {"timers": {"connectors": {"add_time_dim_to_batch_and_zero_pad": 2.205567679930235e-06, "numpy_to_tensor": 8.121997684892382e-06, "add_states_from_episodes_to_batch": 1.5873215853397878e-06, "batch_individual_items": 6.142546367117549e-06, "add_observations_from_episodes_to_batch": 2.768935859550991e-06}}, "connector_pipeline_timer": 4.254046726164801e-05}, "episode_len_max": 20, "num_agent_steps_sampled_lifetime": {"default_agent": 3200}, "num_episodes_lifetime": 160, "episode_return_min": -16.5, "env_step_timer": 1.3702275384408516e-05, "env_to_module_sum_episodes_length_out": 10.3682383945743, "num_env_steps_sampled": 400, "episode_len_mean": 20.0, "num_agent_steps_sampled": {"default_agent": 400}, "num_env_steps_sampled_lifetime": 40400, "weights_seq_no": 8.0, "module_episode_returns_mean": {"default_policy": 1.75}, "num_module_steps_sampled_lifetime": {"default_policy": 3200}, "num_episodes": 20, "episode_len_min": 20, "env_reset_timer": 0.0005276605870342527, "episode_return_max": 12.5, "agent_episode_returns_mean": {"default_agent": 1.75}, "episode_return_mean": 1.75, "episode_duration_sec_mean": 0.004874144217465073, "time_between_sampling": 1.7513628225987008}, "num_healthy_workers": 1, "actor_manager_num_outstanding_async_reqs": 0, "num_remote_worker_restarts": 0}, "num_env_steps_sampled_lifetime": -3695000.0, "fault_tolerance": {"num_healthy_workers": 0, "num_remote_worker_restarts": 0}, "env_runner_group": {"actor_manager_num_outstanding_async_reqs": 0}, "done": false, "training_iteration": 8, "trial_id": "4da5b_00000", "date": "2025-08-11_19-21-49", "timestamp": 1754932909, "time_this_iter_s": 1.7382020950317383, "time_total_s": 14.52212643623352, "pid": 14327, "hostname": "Mac", "node_ip": "127.0.0.1", "config": {"exploration_config": {}, "extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "placement_strategy": "PACK", "num_gpus": 0, "_fake_gpus": false, "num_cpus_for_main_process": 2, "eager_tracing": true, "eager_max_retraces": 20, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "torch_compile_learner": false, "torch_compile_learner_what_to_compile": "forward_train", "torch_compile_learner_dynamo_backend": "aot_eager", "torch_compile_learner_dynamo_mode": null, "torch_compile_worker": false, "torch_compile_worker_dynamo_backend": "aot_eager", "torch_compile_worker_dynamo_mode": null, "torch_ddp_kwargs": {}, "torch_skip_nan_gradients": false, "env": "Umbrella", "env_config": {}, "observation_space": null, "action_space": null, "clip_rewards": null, "normalize_actions": true, "clip_actions": false, "_is_atari": null, "disable_env_checking": false, "render_env": false, "action_mask_key": "action_mask", "env_runner_cls": null, "num_env_runners": 0, "create_local_env_runner": true, "num_envs_per_env_runner": 1, "gym_env_vectorize_mode": "SYNC", "num_cpus_per_env_runner": 1, "num_gpus_per_env_runner": 0, "custom_resources_per_env_runner": {}, "validate_env_runners_after_construction": true, "episodes_to_numpy": true, "max_requests_in_flight_per_env_runner": 1, "sample_timeout_s": 60.0, "_env_to_module_connector": null, "add_default_connectors_to_env_to_module_pipeline": true, "_module_to_env_connector": null, "add_default_connectors_to_module_to_env_pipeline": true, "merge_env_runner_states": "training_only", "broadcast_env_runner_states": true, "episode_lookback_horizon": 1, "rollout_fragment_length": "auto", "batch_mode": "complete_episodes", "compress_observations": false, "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "enable_tf1_exec_eagerly": false, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "preprocessor_pref": "deepmind", "observation_filter": "NoFilter", "update_worker_filter_stats": true, "use_worker_filter_stats": true, "sampler_perf_stats_ema_coef": null, "_is_online": true, "num_learners": 0, "num_gpus_per_learner": 0, "num_cpus_per_learner": "auto", "num_aggregator_actors_per_learner": 0, "max_requests_in_flight_per_aggregator_actor": 3, "local_gpu_idx": 0, "max_requests_in_flight_per_learner": 3, "gamma": 1, "lr": 0.0002847858517, "grad_clip": 0.5, "grad_clip_by": "global_norm", "_train_batch_size_per_learner": 5000, "train_batch_size": 4000, "num_epochs": 1, "minibatch_size": 1000, "shuffle_batch_per_epoch": true, "model": {"fcnet_hiddens": [256, 256], "fcnet_activation": "tanh", "fcnet_weights_initializer": null, "fcnet_weights_initializer_config": null, "fcnet_bias_initializer": null, "fcnet_bias_initializer_config": null, "conv_filters": null, "conv_activation": "relu", "conv_kernel_initializer": null, "conv_kernel_initializer_config": null, "conv_bias_initializer": null, "conv_bias_initializer_config": null, "conv_transpose_kernel_initializer": null, "conv_transpose_kernel_initializer_config": null, "conv_transpose_bias_initializer": null, "conv_transpose_bias_initializer_config": null, "post_fcnet_hiddens": [], "post_fcnet_activation": "relu", "post_fcnet_weights_initializer": null, "post_fcnet_weights_initializer_config": null, "post_fcnet_bias_initializer": null, "post_fcnet_bias_initializer_config": null, "free_log_std": false, "log_std_clip_param": 20.0, "no_final_linear": false, "vf_share_layers": false, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "lstm_weights_initializer": null, "lstm_weights_initializer_config": null, "lstm_bias_initializer": null, "lstm_bias_initializer_config": null, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "attention_use_n_prev_actions": 0, "attention_use_n_prev_rewards": 0, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": null, "custom_model_config": {}, "custom_action_dist": null, "custom_preprocessor": null, "encoder_latent_dim": null, "always_check_shapes": false, "lstm_use_prev_action_reward": -1, "_use_default_native_models": -1, "_disable_preprocessor_api": false, "_disable_action_flattening": false}, "_learner_connector": null, "add_default_connectors_to_learner_pipeline": true, "learner_config_dict": {}, "optimizer": {}, "_learner_class": null, "callbacks_on_algorithm_init": null, "callbacks_on_env_runners_recreated": null, "callbacks_on_offline_eval_runners_recreated": null, "callbacks_on_checkpoint_loaded": null, "callbacks_on_environment_created": null, "callbacks_on_episode_created": null, "callbacks_on_episode_start": null, "callbacks_on_episode_step": null, "callbacks_on_episode_end": null, "callbacks_on_evaluate_start": null, "callbacks_on_evaluate_end": null, "callbacks_on_evaluate_offline_start": null, "callbacks_on_evaluate_offline_end": null, "callbacks_on_sample_end": null, "callbacks_on_train_result": null, "explore": true, "enable_rl_module_and_learner": true, "enable_env_runner_and_connector_v2": true, "_prior_exploration_config": {"type": "StochasticSampling"}, "count_steps_by": "env_steps", "policy_map_capacity": 100, "policy_mapping_fn": "<function AlgorithmConfig.DEFAULT_POLICY_MAPPING_FN at 0x383de9b20>", "policies_to_train": null, "policy_states_are_swappable": false, "observation_fn": null, "offline_data_class": null, "input_read_method": "read_parquet", "input_read_method_kwargs": {}, "input_read_schema": {}, "input_read_episodes": false, "input_read_sample_batches": false, "input_read_batch_size": null, "input_filesystem": null, "input_filesystem_kwargs": {}, "input_compress_columns": ["obs", "new_obs"], "input_spaces_jsonable": true, "materialize_data": false, "materialize_mapped_data": true, "map_batches_kwargs": {}, "iter_batches_kwargs": {}, "ignore_final_observation": false, "prelearner_class": null, "prelearner_buffer_class": null, "prelearner_buffer_kwargs": {}, "prelearner_module_synch_period": 10, "dataset_num_iters_per_learner": null, "input_config": {}, "actions_in_input_normalized": false, "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_config": {}, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "output_max_rows_per_file": null, "output_write_remaining_data": false, "output_write_method": "write_parquet", "output_write_method_kwargs": {}, "output_filesystem": null, "output_filesystem_kwargs": {}, "output_write_episodes": true, "offline_sampling": false, "evaluation_interval": 1, "evaluation_duration": 20, "evaluation_duration_unit": "episodes", "evaluation_sample_timeout_s": 120.0, "evaluation_auto_duration_min_env_steps_per_sample": 100, "evaluation_auto_duration_max_env_steps_per_sample": 2000, "evaluation_parallel_to_training": false, "evaluation_force_reset_envs_before_iteration": true, "evaluation_config": null, "off_policy_estimation_methods": {}, "ope_split_batch_by_episode": true, "evaluation_num_env_runners": 1, "in_evaluation": false, "sync_filters_on_rollout_workers_timeout_s": 10.0, "offline_evaluation_interval": null, "num_offline_eval_runners": 0, "offline_loss_for_module_fn": null, "offline_evaluation_duration": 1, "offline_evaluation_parallel_to_training": false, "offline_evaluation_timeout_s": 120.0, "num_cpus_per_offline_eval_runner": 1, "num_gpus_per_offline_eval_runner": 0, "custom_resources_per_offline_eval_runner": {}, "restart_failed_offline_eval_runners": true, "ignore_offline_eval_runner_failures": false, "max_num_offline_eval_runner_restarts": 1000, "offline_eval_runner_restore_timeout_s": 1800.0, "max_requests_in_flight_per_offline_eval_runner": 1, "validate_offline_eval_runners_after_construction": true, "offline_eval_runner_health_probe_timeout_s": 30.0, "offline_eval_rl_module_inference_only": false, "broadcast_offline_eval_runner_states": false, "offline_eval_batch_size_per_runner": 256, "dataset_num_iters_per_eval_runner": 1, "keep_per_episode_custom_metrics": false, "metrics_episode_collection_timeout_s": 60.0, "metrics_num_episodes_for_smoothing": 100, "min_time_s_per_iteration": null, "min_train_timesteps_per_iteration": 0, "min_sample_timesteps_per_iteration": 0, "log_gradients": true, "export_native_model_files": false, "checkpoint_trainable_policies_only": false, "logger_creator": null, "logger_config": null, "log_level": "WARN", "log_sys_usage": true, "fake_sampler": false, "seed": 4, "restart_failed_env_runners": true, "ignore_env_runner_failures": false, "max_num_env_runner_restarts": 1000, "delay_between_env_runner_restarts_s": 60.0, "restart_failed_sub_environments": false, "num_consecutive_env_runner_failures_tolerance": 100, "env_runner_health_probe_timeout_s": 30.0, "env_runner_restore_timeout_s": 1800.0, "_model_config": {}, "_rl_module_spec": "RLModuleSpec(module_class=None, observation_space=None, action_space=None, inference_only=False, learner_only=False, model_config=DefaultModelConfig(fcnet_hiddens=[60, 90], fcnet_activation='tanh', fcnet_kernel_initializer=None, fcnet_kernel_initializer_kwargs=None, fcnet_bias_initializer=None, fcnet_bias_initializer_kwargs=None, conv_filters=None, conv_activation='relu', conv_kernel_initializer=None, conv_kernel_initializer_kwargs=None, conv_bias_initializer=None, conv_bias_initializer_kwargs=None, head_fcnet_hiddens=[], head_fcnet_activation='relu', head_fcnet_kernel_initializer=None, head_fcnet_kernel_initializer_kwargs=None, head_fcnet_bias_initializer=None, head_fcnet_bias_initializer_kwargs=None, free_log_std=False, log_std_clip_param=20.0, vf_share_layers=True, use_lstm=False, max_seq_len=20, lstm_cell_size=256, lstm_use_prev_action=False, lstm_use_prev_reward=False, lstm_kernel_initializer=None, lstm_kernel_initializer_kwargs=None, lstm_bias_initializer=None, lstm_bias_initializer_kwargs=None), catalog_class=None, load_state_path=None, model_config_dict=None)", "algorithm_config_overrides_per_module": {}, "_per_module_overrides": {}, "_validate_config": true, "_use_msgpack_checkpoints": false, "_torch_grad_scaler_class": null, "_torch_lr_scheduler_classes": null, "_tf_policy_handles_more_than_one_loss": false, "_disable_preprocessor_api": false, "_disable_action_flattening": false, "_disable_initialize_loss_from_dummy_batch": false, "_dont_auto_sync_env_runner_states": false, "env_task_fn": -1, "enable_connectors": -1, "simple_optimizer": false, "policy_map_cache": -1, "worker_cls": -1, "synchronize_filters": -1, "enable_async_evaluation": -1, "custom_async_evaluation_function": -1, "_enable_rl_module_api": -1, "auto_wrap_old_gym_envs": -1, "always_attach_evaluation_results": -1, "replay_sequence_length": null, "_disable_execution_plan_api": -1, "use_critic": true, "use_gae": true, "use_kl_loss": true, "kl_coeff": 0.7464963036515, "kl_target": 0.0270990929592, "vf_loss_coeff": 0.6688075857018, "entropy_coeff": 0.0090570820258, "clip_param": 0.1221781641624, "vf_clip_param": 0.1027808522125, "entropy_coeff_schedule": null, "lr_schedule": null, "sgd_minibatch_size": -1, "vf_share_layers": -1, "__stdout_file__": null, "__stderr_file__": null, "lambda": 0.9099046732075, "input": "sampler", "policies": {"default_policy": [null, null, null, null]}, "callbacks": "<class 'ray.rllib.callbacks.callbacks.RLlibCallback'>", "create_env_on_driver": false, "custom_eval_function": null, "framework": "torch"}, "time_since_restore": 14.52212643623352, "iterations_since_restore": 8, "perf": {"cpu_util_percent": 49.3, "ram_util_percent": 79.15}}
{"timers": {"training_iteration": 1.8856276665896907, "restore_env_runners": 7.519139678685656e-05, "training_step": 1.8853031016026796, "env_runner_sampling_timer": 1.769633142269877, "learner_update_timer": 0.1121781056082974, "synch_weights": 0.0006258700610506309, "restore_eval_env_runners": 8.226882993489003e-06, "evaluation_iteration": 0.11860957698707478, "synch_eval_env_connectors": 0.00012976393419909476, "synch_env_connectors": 4.640986650125673e-06}, "env_runners": {"env_to_module_connector": {"connector_pipeline_timer": 4.38465273924111e-05, "timers": {"connectors": {"add_time_dim_to_batch_and_zero_pad": 2.4460413125381093e-06, "batch_individual_items": 6.333229100186428e-06, "numpy_to_tensor": 8.657941520346965e-06, "add_observations_from_episodes_to_batch": 2.9294105874014e-06, "add_states_from_episodes_to_batch": 1.7540450600295105e-06}}}, "env_step_timer": 1.3978267540651255e-05, "num_agent_steps_sampled_lifetime": {"default_agent": -4312500.0}, "env_to_module_sum_episodes_length_out": 10.36823839457432, "module_to_env_connector": {"timers": {"connectors": {"normalize_and_clip_actions": 9.541800503382023e-06, "tensor_to_numpy": 1.3295037630228454e-05, "remove_single_ts_time_rank_from_batch": 5.8554392753977e-07, "un_batch_to_individual_items": 5.436726373447658e-06, "get_actions": 4.0016431233725355e-05, "listify_data_for_vector_env": 1.1162274180892636e-05}}, "connector_pipeline_timer": 0.00010584164607625596}, "num_agent_steps_sampled": {"default_agent": 5000.0}, "module_episode_returns_mean": {"default_policy": 8.980000000000004}, "env_reset_timer": 3.60002458826148e-05, "episode_return_max": 12.5, "sample": 0.005029829144854951, "env_to_module_sum_episodes_length_in": 10.36823839457432, "num_module_steps_sampled_lifetime": {"default_policy": -4312500.0}, "episode_return_mean": 8.980000000000004, "episode_duration_sec_mean": 0.00461767426971346, "num_env_steps_sampled": 5000.0, "num_episodes": 250.0, "episode_len_mean": 20.0, "rlmodule_inference_timer": 2.8583604415530826e-05, "episode_len_min": 20, "episode_len_max": 20, "agent_episode_returns_mean": {"default_agent": 8.980000000000004}, "num_module_steps_sampled": {"default_policy": 5000.0}, "num_episodes_lifetime": -215625.0, "num_env_steps_sampled_lifetime": -4312500.0, "weights_seq_no": 8.0, "episode_return_min": -7.5, "time_between_sampling": 0.0015403510672899103, "num_env_steps_sampled_lifetime_throughput": 3688.1746282495064}, "learners": {"default_policy": {"curr_kl_coeff": 0.0014580006245523691, "gradients_default_optimizer_global_norm": 0.023104187101125717, "vf_loss": 0.10202646255493164, "total_loss": -0.04069652780890465, "num_module_steps_trained": 6000, "diff_num_grad_updates_vs_sampler_policy": 1.0, "module_train_batch_size_mean": 1000.0, "entropy": 0.5701533555984497, "num_module_steps_trained_lifetime": 54000, "curr_entropy_coeff": 0.0090570820258, "vf_loss_unclipped": 28.674518585205078, "weights_seq_no": 9.0, "default_optimizer_learning_rate": 0.0002847858517, "vf_explained_var": 0.019284963607788086, "mean_kl_loss": 0.0018121906323358417, "num_trainable_parameters": 6003, "policy_loss": -0.10377395898103714, "num_module_steps_trained_lifetime_throughput": 346785.62562522455}, "__all_modules__": {"learner_connector": {"timers": {"connectors": {"numpy_to_tensor": 6.2541846018866e-05, "batch_individual_items": 0.03248966584426039, "add_columns_from_episodes_to_train_batch": 0.0341881531562741, "add_time_dim_to_batch_and_zero_pad": 9.90083702175611e-06, "add_one_ts_to_episodes_and_truncate": 0.008584809314684406, "add_observations_from_episodes_to_batch": 0.0008154163025975953, "general_advantage_estimation": 0.006795123365009151, "add_states_from_episodes_to_batch": 3.549212965500202e-06}}, "connector_pipeline_timer": 0.08305676563412764}, "num_env_steps_trained": 31500, "num_env_steps_trained_lifetime": 283500, "learner_connector_sum_episodes_length_out": 5250.0, "learner_connector_sum_episodes_length_in": 5000.0, "num_module_steps_trained_lifetime": 54000, "num_non_trainable_parameters": 0, "num_module_steps_trained": 6000, "num_trainable_parameters": 6003, "num_env_steps_trained_lifetime_throughput": 1811778.2020887113, "num_module_steps_trained_throughput": 346296.204389335, "num_module_steps_trained_lifetime_throughput": 345898.2697329072}}, "num_training_step_calls_per_iteration": 1, "evaluation": {"env_runners": {"sample": 0.10689966313808297, "env_to_module_sum_episodes_length_in": 10.368238394574323, "num_module_steps_sampled": {"default_policy": 400}, "module_to_env_connector": {"timers": {"connectors": {"tensor_to_numpy": 1.3556193586970495e-05, "remove_single_ts_time_rank_from_batch": 6.003106316686694e-07, "listify_data_for_vector_env": 1.1430383411721884e-05, "normalize_and_clip_actions": 9.708620896821487e-06, "get_actions": 3.873328760543453e-05, "un_batch_to_individual_items": 5.528588308419027e-06}}, "connector_pipeline_timer": 0.00010593911651993566}, "rlmodule_inference_timer": 2.924696982820112e-05, "env_to_module_connector": {"timers": {"connectors": {"add_time_dim_to_batch_and_zero_pad": 2.3250749239375174e-06, "numpy_to_tensor": 8.665132618738063e-06, "add_states_from_episodes_to_batch": 1.63070990317143e-06, "batch_individual_items": 6.481187322997993e-06, "add_observations_from_episodes_to_batch": 2.9449595469734143e-06}}, "connector_pipeline_timer": 4.425901438827407e-05}, "episode_len_max": 20, "num_agent_steps_sampled_lifetime": {"default_agent": 3600}, "num_episodes_lifetime": 180, "episode_return_min": -16.5, "env_step_timer": 1.481740833637133e-05, "env_to_module_sum_episodes_length_out": 10.368238394574323, "num_env_steps_sampled": 400, "episode_len_mean": 20.0, "num_agent_steps_sampled": {"default_agent": 400}, "num_env_steps_sampled_lifetime": 45400, "weights_seq_no": 9.0, "module_episode_returns_mean": {"default_policy": 0.75}, "num_module_steps_sampled_lifetime": {"default_policy": 3600}, "num_episodes": 20, "episode_len_min": 20, "env_reset_timer": 0.0005233868910123767, "episode_return_max": 12.5, "agent_episode_returns_mean": {"default_agent": 0.75}, "episode_return_mean": 0.75, "episode_duration_sec_mean": 0.004969174196012318, "time_between_sampling": 1.750095098952705}, "num_healthy_workers": 1, "actor_manager_num_outstanding_async_reqs": 0, "num_remote_worker_restarts": 0}, "num_env_steps_sampled_lifetime": -4312500.0, "fault_tolerance": {"num_healthy_workers": 0, "num_remote_worker_restarts": 0}, "env_runner_group": {"actor_manager_num_outstanding_async_reqs": 0}, "done": false, "training_iteration": 9, "trial_id": "4da5b_00000", "date": "2025-08-11_19-21-51", "timestamp": 1754932911, "time_this_iter_s": 1.724012851715088, "time_total_s": 16.24613928794861, "pid": 14327, "hostname": "Mac", "node_ip": "127.0.0.1", "config": {"exploration_config": {}, "extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "placement_strategy": "PACK", "num_gpus": 0, "_fake_gpus": false, "num_cpus_for_main_process": 2, "eager_tracing": true, "eager_max_retraces": 20, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "torch_compile_learner": false, "torch_compile_learner_what_to_compile": "forward_train", "torch_compile_learner_dynamo_backend": "aot_eager", "torch_compile_learner_dynamo_mode": null, "torch_compile_worker": false, "torch_compile_worker_dynamo_backend": "aot_eager", "torch_compile_worker_dynamo_mode": null, "torch_ddp_kwargs": {}, "torch_skip_nan_gradients": false, "env": "Umbrella", "env_config": {}, "observation_space": null, "action_space": null, "clip_rewards": null, "normalize_actions": true, "clip_actions": false, "_is_atari": null, "disable_env_checking": false, "render_env": false, "action_mask_key": "action_mask", "env_runner_cls": null, "num_env_runners": 0, "create_local_env_runner": true, "num_envs_per_env_runner": 1, "gym_env_vectorize_mode": "SYNC", "num_cpus_per_env_runner": 1, "num_gpus_per_env_runner": 0, "custom_resources_per_env_runner": {}, "validate_env_runners_after_construction": true, "episodes_to_numpy": true, "max_requests_in_flight_per_env_runner": 1, "sample_timeout_s": 60.0, "_env_to_module_connector": null, "add_default_connectors_to_env_to_module_pipeline": true, "_module_to_env_connector": null, "add_default_connectors_to_module_to_env_pipeline": true, "merge_env_runner_states": "training_only", "broadcast_env_runner_states": true, "episode_lookback_horizon": 1, "rollout_fragment_length": "auto", "batch_mode": "complete_episodes", "compress_observations": false, "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "enable_tf1_exec_eagerly": false, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "preprocessor_pref": "deepmind", "observation_filter": "NoFilter", "update_worker_filter_stats": true, "use_worker_filter_stats": true, "sampler_perf_stats_ema_coef": null, "_is_online": true, "num_learners": 0, "num_gpus_per_learner": 0, "num_cpus_per_learner": "auto", "num_aggregator_actors_per_learner": 0, "max_requests_in_flight_per_aggregator_actor": 3, "local_gpu_idx": 0, "max_requests_in_flight_per_learner": 3, "gamma": 1, "lr": 0.0002847858517, "grad_clip": 0.5, "grad_clip_by": "global_norm", "_train_batch_size_per_learner": 5000, "train_batch_size": 4000, "num_epochs": 1, "minibatch_size": 1000, "shuffle_batch_per_epoch": true, "model": {"fcnet_hiddens": [256, 256], "fcnet_activation": "tanh", "fcnet_weights_initializer": null, "fcnet_weights_initializer_config": null, "fcnet_bias_initializer": null, "fcnet_bias_initializer_config": null, "conv_filters": null, "conv_activation": "relu", "conv_kernel_initializer": null, "conv_kernel_initializer_config": null, "conv_bias_initializer": null, "conv_bias_initializer_config": null, "conv_transpose_kernel_initializer": null, "conv_transpose_kernel_initializer_config": null, "conv_transpose_bias_initializer": null, "conv_transpose_bias_initializer_config": null, "post_fcnet_hiddens": [], "post_fcnet_activation": "relu", "post_fcnet_weights_initializer": null, "post_fcnet_weights_initializer_config": null, "post_fcnet_bias_initializer": null, "post_fcnet_bias_initializer_config": null, "free_log_std": false, "log_std_clip_param": 20.0, "no_final_linear": false, "vf_share_layers": false, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "lstm_weights_initializer": null, "lstm_weights_initializer_config": null, "lstm_bias_initializer": null, "lstm_bias_initializer_config": null, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "attention_use_n_prev_actions": 0, "attention_use_n_prev_rewards": 0, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": null, "custom_model_config": {}, "custom_action_dist": null, "custom_preprocessor": null, "encoder_latent_dim": null, "always_check_shapes": false, "lstm_use_prev_action_reward": -1, "_use_default_native_models": -1, "_disable_preprocessor_api": false, "_disable_action_flattening": false}, "_learner_connector": null, "add_default_connectors_to_learner_pipeline": true, "learner_config_dict": {}, "optimizer": {}, "_learner_class": null, "callbacks_on_algorithm_init": null, "callbacks_on_env_runners_recreated": null, "callbacks_on_offline_eval_runners_recreated": null, "callbacks_on_checkpoint_loaded": null, "callbacks_on_environment_created": null, "callbacks_on_episode_created": null, "callbacks_on_episode_start": null, "callbacks_on_episode_step": null, "callbacks_on_episode_end": null, "callbacks_on_evaluate_start": null, "callbacks_on_evaluate_end": null, "callbacks_on_evaluate_offline_start": null, "callbacks_on_evaluate_offline_end": null, "callbacks_on_sample_end": null, "callbacks_on_train_result": null, "explore": true, "enable_rl_module_and_learner": true, "enable_env_runner_and_connector_v2": true, "_prior_exploration_config": {"type": "StochasticSampling"}, "count_steps_by": "env_steps", "policy_map_capacity": 100, "policy_mapping_fn": "<function AlgorithmConfig.DEFAULT_POLICY_MAPPING_FN at 0x383de9b20>", "policies_to_train": null, "policy_states_are_swappable": false, "observation_fn": null, "offline_data_class": null, "input_read_method": "read_parquet", "input_read_method_kwargs": {}, "input_read_schema": {}, "input_read_episodes": false, "input_read_sample_batches": false, "input_read_batch_size": null, "input_filesystem": null, "input_filesystem_kwargs": {}, "input_compress_columns": ["obs", "new_obs"], "input_spaces_jsonable": true, "materialize_data": false, "materialize_mapped_data": true, "map_batches_kwargs": {}, "iter_batches_kwargs": {}, "ignore_final_observation": false, "prelearner_class": null, "prelearner_buffer_class": null, "prelearner_buffer_kwargs": {}, "prelearner_module_synch_period": 10, "dataset_num_iters_per_learner": null, "input_config": {}, "actions_in_input_normalized": false, "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_config": {}, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "output_max_rows_per_file": null, "output_write_remaining_data": false, "output_write_method": "write_parquet", "output_write_method_kwargs": {}, "output_filesystem": null, "output_filesystem_kwargs": {}, "output_write_episodes": true, "offline_sampling": false, "evaluation_interval": 1, "evaluation_duration": 20, "evaluation_duration_unit": "episodes", "evaluation_sample_timeout_s": 120.0, "evaluation_auto_duration_min_env_steps_per_sample": 100, "evaluation_auto_duration_max_env_steps_per_sample": 2000, "evaluation_parallel_to_training": false, "evaluation_force_reset_envs_before_iteration": true, "evaluation_config": null, "off_policy_estimation_methods": {}, "ope_split_batch_by_episode": true, "evaluation_num_env_runners": 1, "in_evaluation": false, "sync_filters_on_rollout_workers_timeout_s": 10.0, "offline_evaluation_interval": null, "num_offline_eval_runners": 0, "offline_loss_for_module_fn": null, "offline_evaluation_duration": 1, "offline_evaluation_parallel_to_training": false, "offline_evaluation_timeout_s": 120.0, "num_cpus_per_offline_eval_runner": 1, "num_gpus_per_offline_eval_runner": 0, "custom_resources_per_offline_eval_runner": {}, "restart_failed_offline_eval_runners": true, "ignore_offline_eval_runner_failures": false, "max_num_offline_eval_runner_restarts": 1000, "offline_eval_runner_restore_timeout_s": 1800.0, "max_requests_in_flight_per_offline_eval_runner": 1, "validate_offline_eval_runners_after_construction": true, "offline_eval_runner_health_probe_timeout_s": 30.0, "offline_eval_rl_module_inference_only": false, "broadcast_offline_eval_runner_states": false, "offline_eval_batch_size_per_runner": 256, "dataset_num_iters_per_eval_runner": 1, "keep_per_episode_custom_metrics": false, "metrics_episode_collection_timeout_s": 60.0, "metrics_num_episodes_for_smoothing": 100, "min_time_s_per_iteration": null, "min_train_timesteps_per_iteration": 0, "min_sample_timesteps_per_iteration": 0, "log_gradients": true, "export_native_model_files": false, "checkpoint_trainable_policies_only": false, "logger_creator": null, "logger_config": null, "log_level": "WARN", "log_sys_usage": true, "fake_sampler": false, "seed": 4, "restart_failed_env_runners": true, "ignore_env_runner_failures": false, "max_num_env_runner_restarts": 1000, "delay_between_env_runner_restarts_s": 60.0, "restart_failed_sub_environments": false, "num_consecutive_env_runner_failures_tolerance": 100, "env_runner_health_probe_timeout_s": 30.0, "env_runner_restore_timeout_s": 1800.0, "_model_config": {}, "_rl_module_spec": "RLModuleSpec(module_class=None, observation_space=None, action_space=None, inference_only=False, learner_only=False, model_config=DefaultModelConfig(fcnet_hiddens=[60, 90], fcnet_activation='tanh', fcnet_kernel_initializer=None, fcnet_kernel_initializer_kwargs=None, fcnet_bias_initializer=None, fcnet_bias_initializer_kwargs=None, conv_filters=None, conv_activation='relu', conv_kernel_initializer=None, conv_kernel_initializer_kwargs=None, conv_bias_initializer=None, conv_bias_initializer_kwargs=None, head_fcnet_hiddens=[], head_fcnet_activation='relu', head_fcnet_kernel_initializer=None, head_fcnet_kernel_initializer_kwargs=None, head_fcnet_bias_initializer=None, head_fcnet_bias_initializer_kwargs=None, free_log_std=False, log_std_clip_param=20.0, vf_share_layers=True, use_lstm=False, max_seq_len=20, lstm_cell_size=256, lstm_use_prev_action=False, lstm_use_prev_reward=False, lstm_kernel_initializer=None, lstm_kernel_initializer_kwargs=None, lstm_bias_initializer=None, lstm_bias_initializer_kwargs=None), catalog_class=None, load_state_path=None, model_config_dict=None)", "algorithm_config_overrides_per_module": {}, "_per_module_overrides": {}, "_validate_config": true, "_use_msgpack_checkpoints": false, "_torch_grad_scaler_class": null, "_torch_lr_scheduler_classes": null, "_tf_policy_handles_more_than_one_loss": false, "_disable_preprocessor_api": false, "_disable_action_flattening": false, "_disable_initialize_loss_from_dummy_batch": false, "_dont_auto_sync_env_runner_states": false, "env_task_fn": -1, "enable_connectors": -1, "simple_optimizer": false, "policy_map_cache": -1, "worker_cls": -1, "synchronize_filters": -1, "enable_async_evaluation": -1, "custom_async_evaluation_function": -1, "_enable_rl_module_api": -1, "auto_wrap_old_gym_envs": -1, "always_attach_evaluation_results": -1, "replay_sequence_length": null, "_disable_execution_plan_api": -1, "use_critic": true, "use_gae": true, "use_kl_loss": true, "kl_coeff": 0.7464963036515, "kl_target": 0.0270990929592, "vf_loss_coeff": 0.6688075857018, "entropy_coeff": 0.0090570820258, "clip_param": 0.1221781641624, "vf_clip_param": 0.1027808522125, "entropy_coeff_schedule": null, "lr_schedule": null, "sgd_minibatch_size": -1, "vf_share_layers": -1, "__stdout_file__": null, "__stderr_file__": null, "lambda": 0.9099046732075, "input": "sampler", "policies": {"default_policy": [null, null, null, null]}, "callbacks": "<class 'ray.rllib.callbacks.callbacks.RLlibCallback'>", "create_env_on_driver": false, "custom_eval_function": null, "framework": "torch"}, "time_since_restore": 16.24613928794861, "iterations_since_restore": 9, "perf": {"cpu_util_percent": 47.833333333333336, "ram_util_percent": 79.4}}
{"timers": {"training_iteration": 1.8823677186728824, "restore_env_runners": 7.449823297530118e-05, "training_step": 1.8820446247459772, "env_runner_sampling_timer": 1.7656365133466125, "learner_update_timer": 0.11292098164225994, "synch_weights": 0.0006251367808599963, "restore_eval_env_runners": 8.211284054211181e-06, "evaluation_iteration": 0.11858261038674078, "synch_eval_env_connectors": 0.0001294629648443204, "synch_env_connectors": 4.62999730944348e-06}, "env_runners": {"env_to_module_connector": {"connector_pipeline_timer": 4.324514658422202e-05, "timers": {"connectors": {"add_time_dim_to_batch_and_zero_pad": 2.408447282200572e-06, "batch_individual_items": 6.215404492289164e-06, "numpy_to_tensor": 8.468391917022758e-06, "add_observations_from_episodes_to_batch": 2.965279446091598e-06, "add_states_from_episodes_to_batch": 1.7285884643863016e-06}}}, "env_step_timer": 1.369986250553407e-05, "num_agent_steps_sampled_lifetime": {"default_agent": -4930000.0}, "env_to_module_sum_episodes_length_out": 10.36823839457432, "module_to_env_connector": {"timers": {"connectors": {"normalize_and_clip_actions": 9.422995614719502e-06, "tensor_to_numpy": 1.3086608733631495e-05, "remove_single_ts_time_rank_from_batch": 5.790696867891024e-07, "un_batch_to_individual_items": 5.338660122530345e-06, "get_actions": 3.9096051441981574e-05, "listify_data_for_vector_env": 1.089713753912895e-05}}, "connector_pipeline_timer": 0.00010383008200089957}, "num_agent_steps_sampled": {"default_agent": 5000.0}, "module_episode_returns_mean": {"default_policy": 8.260000000000002}, "env_reset_timer": 3.504447312126084e-05, "episode_return_max": 12.5, "sample": 0.004921513258399983, "env_to_module_sum_episodes_length_in": 10.36823839457432, "num_module_steps_sampled_lifetime": {"default_policy": -4930000.0}, "episode_return_mean": 8.260000000000002, "episode_duration_sec_mean": 0.004523946973960846, "num_env_steps_sampled": 5000.0, "num_episodes": 250.0, "episode_len_mean": 20.0, "rlmodule_inference_timer": 2.7572401496270302e-05, "episode_len_min": 20, "episode_len_max": 20, "agent_episode_returns_mean": {"default_agent": 8.260000000000002}, "num_module_steps_sampled": {"default_policy": 5000.0}, "num_episodes_lifetime": -246500.0, "num_env_steps_sampled_lifetime": -4930000.0, "weights_seq_no": 9.0, "episode_return_min": -7.5, "time_between_sampling": 0.0019480951822176307, "num_env_steps_sampled_lifetime_throughput": 3731.62821686146}, "learners": {"default_policy": {"curr_kl_coeff": 0.0007290003122761846, "gradients_default_optimizer_global_norm": 0.07620148360729218, "vf_loss": 0.10191888362169266, "total_loss": -0.06608772277832031, "num_module_steps_trained": 6000, "diff_num_grad_updates_vs_sampler_policy": 1.0, "module_train_batch_size_mean": 1000.0, "entropy": 0.5392490029335022, "num_module_steps_trained_lifetime": 60000, "curr_entropy_coeff": 0.0090570820258, "vf_loss_unclipped": 28.66448402404785, "weights_seq_no": 10.0, "default_optimizer_learning_rate": 0.0002847858517, "vf_explained_var": 0.019550085067749023, "mean_kl_loss": 0.0017268538940697908, "num_trainable_parameters": 6003, "policy_loss": -0.12937036156654358, "num_module_steps_trained_lifetime_throughput": 348103.4061979209}, "__all_modules__": {"learner_connector": {"timers": {"connectors": {"numpy_to_tensor": 6.263475782463148e-05, "batch_individual_items": 0.033400265436264676, "add_columns_from_episodes_to_train_batch": 0.034188415785242815, "add_time_dim_to_batch_and_zero_pad": 9.883078397101221e-06, "add_one_ts_to_episodes_and_truncate": 0.008578692891513006, "add_observations_from_episodes_to_batch": 0.0008158800596741709, "general_advantage_estimation": 0.006782685460930172, "add_states_from_episodes_to_batch": 3.5424707637235795e-06}}, "connector_pipeline_timer": 0.08394941172772408}, "num_env_steps_trained": 31500, "num_env_steps_trained_lifetime": 315000, "learner_connector_sum_episodes_length_out": 5250.0, "learner_connector_sum_episodes_length_in": 5000.0, "num_module_steps_trained_lifetime": 60000, "num_non_trainable_parameters": 0, "num_module_steps_trained": 6000, "num_trainable_parameters": 6003, "num_env_steps_trained_lifetime_throughput": 1819248.7172899153, "num_module_steps_trained_throughput": 347670.14688177884, "num_module_steps_trained_lifetime_throughput": 347283.7606815609}}, "num_training_step_calls_per_iteration": 1, "evaluation": {"env_runners": {"sample": 0.1068284894165509, "env_to_module_sum_episodes_length_in": 10.368238394574323, "num_module_steps_sampled": {"default_policy": 400}, "module_to_env_connector": {"timers": {"connectors": {"tensor_to_numpy": 1.2738948255655473e-05, "remove_single_ts_time_rank_from_batch": 6.051269981590428e-07, "listify_data_for_vector_env": 1.0776899817743474e-05, "normalize_and_clip_actions": 9.252456851127526e-06, "get_actions": 3.520850422712798e-05, "un_batch_to_individual_items": 5.2778516106383566e-06}}, "connector_pipeline_timer": 9.958316291875291e-05}, "rlmodule_inference_timer": 2.7300442355586863e-05, "env_to_module_connector": {"timers": {"connectors": {"add_time_dim_to_batch_and_zero_pad": 2.183928929476875e-06, "numpy_to_tensor": 8.252585143487014e-06, "add_states_from_episodes_to_batch": 1.601473632020176e-06, "batch_individual_items": 6.237001678837249e-06, "add_observations_from_episodes_to_batch": 2.779628581254966e-06}}, "connector_pipeline_timer": 4.259971813628252e-05}, "episode_len_max": 20, "num_agent_steps_sampled_lifetime": {"default_agent": 4000}, "num_episodes_lifetime": 200, "episode_return_min": -16.5, "env_step_timer": 1.3800167132093557e-05, "env_to_module_sum_episodes_length_out": 10.368238394574323, "num_env_steps_sampled": 400, "episode_len_mean": 20.0, "num_agent_steps_sampled": {"default_agent": 400}, "num_env_steps_sampled_lifetime": 50400, "weights_seq_no": 10.0, "module_episode_returns_mean": {"default_policy": 0.35}, "num_module_steps_sampled_lifetime": {"default_policy": 4000}, "num_episodes": 20, "episode_len_min": 20, "env_reset_timer": 0.0005189180221065742, "episode_return_max": 12.5, "agent_episode_returns_mean": {"default_agent": 0.35}, "episode_return_mean": 0.35, "episode_duration_sec_mean": 0.0046627575135789814, "time_between_sampling": 1.7483661904634988}, "num_healthy_workers": 1, "actor_manager_num_outstanding_async_reqs": 0, "num_remote_worker_restarts": 0}, "num_env_steps_sampled_lifetime": -4930000.0, "fault_tolerance": {"num_healthy_workers": 0, "num_remote_worker_restarts": 0}, "env_runner_group": {"actor_manager_num_outstanding_async_reqs": 0}, "done": false, "training_iteration": 10, "trial_id": "4da5b_00000", "date": "2025-08-11_19-21-53", "timestamp": 1754932913, "time_this_iter_s": 1.6673178672790527, "time_total_s": 17.91345715522766, "pid": 14327, "hostname": "Mac", "node_ip": "127.0.0.1", "config": {"exploration_config": {}, "extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "placement_strategy": "PACK", "num_gpus": 0, "_fake_gpus": false, "num_cpus_for_main_process": 2, "eager_tracing": true, "eager_max_retraces": 20, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "torch_compile_learner": false, "torch_compile_learner_what_to_compile": "forward_train", "torch_compile_learner_dynamo_backend": "aot_eager", "torch_compile_learner_dynamo_mode": null, "torch_compile_worker": false, "torch_compile_worker_dynamo_backend": "aot_eager", "torch_compile_worker_dynamo_mode": null, "torch_ddp_kwargs": {}, "torch_skip_nan_gradients": false, "env": "Umbrella", "env_config": {}, "observation_space": null, "action_space": null, "clip_rewards": null, "normalize_actions": true, "clip_actions": false, "_is_atari": null, "disable_env_checking": false, "render_env": false, "action_mask_key": "action_mask", "env_runner_cls": null, "num_env_runners": 0, "create_local_env_runner": true, "num_envs_per_env_runner": 1, "gym_env_vectorize_mode": "SYNC", "num_cpus_per_env_runner": 1, "num_gpus_per_env_runner": 0, "custom_resources_per_env_runner": {}, "validate_env_runners_after_construction": true, "episodes_to_numpy": true, "max_requests_in_flight_per_env_runner": 1, "sample_timeout_s": 60.0, "_env_to_module_connector": null, "add_default_connectors_to_env_to_module_pipeline": true, "_module_to_env_connector": null, "add_default_connectors_to_module_to_env_pipeline": true, "merge_env_runner_states": "training_only", "broadcast_env_runner_states": true, "episode_lookback_horizon": 1, "rollout_fragment_length": "auto", "batch_mode": "complete_episodes", "compress_observations": false, "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "enable_tf1_exec_eagerly": false, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "preprocessor_pref": "deepmind", "observation_filter": "NoFilter", "update_worker_filter_stats": true, "use_worker_filter_stats": true, "sampler_perf_stats_ema_coef": null, "_is_online": true, "num_learners": 0, "num_gpus_per_learner": 0, "num_cpus_per_learner": "auto", "num_aggregator_actors_per_learner": 0, "max_requests_in_flight_per_aggregator_actor": 3, "local_gpu_idx": 0, "max_requests_in_flight_per_learner": 3, "gamma": 1, "lr": 0.0002847858517, "grad_clip": 0.5, "grad_clip_by": "global_norm", "_train_batch_size_per_learner": 5000, "train_batch_size": 4000, "num_epochs": 1, "minibatch_size": 1000, "shuffle_batch_per_epoch": true, "model": {"fcnet_hiddens": [256, 256], "fcnet_activation": "tanh", "fcnet_weights_initializer": null, "fcnet_weights_initializer_config": null, "fcnet_bias_initializer": null, "fcnet_bias_initializer_config": null, "conv_filters": null, "conv_activation": "relu", "conv_kernel_initializer": null, "conv_kernel_initializer_config": null, "conv_bias_initializer": null, "conv_bias_initializer_config": null, "conv_transpose_kernel_initializer": null, "conv_transpose_kernel_initializer_config": null, "conv_transpose_bias_initializer": null, "conv_transpose_bias_initializer_config": null, "post_fcnet_hiddens": [], "post_fcnet_activation": "relu", "post_fcnet_weights_initializer": null, "post_fcnet_weights_initializer_config": null, "post_fcnet_bias_initializer": null, "post_fcnet_bias_initializer_config": null, "free_log_std": false, "log_std_clip_param": 20.0, "no_final_linear": false, "vf_share_layers": false, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "lstm_weights_initializer": null, "lstm_weights_initializer_config": null, "lstm_bias_initializer": null, "lstm_bias_initializer_config": null, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "attention_use_n_prev_actions": 0, "attention_use_n_prev_rewards": 0, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": null, "custom_model_config": {}, "custom_action_dist": null, "custom_preprocessor": null, "encoder_latent_dim": null, "always_check_shapes": false, "lstm_use_prev_action_reward": -1, "_use_default_native_models": -1, "_disable_preprocessor_api": false, "_disable_action_flattening": false}, "_learner_connector": null, "add_default_connectors_to_learner_pipeline": true, "learner_config_dict": {}, "optimizer": {}, "_learner_class": null, "callbacks_on_algorithm_init": null, "callbacks_on_env_runners_recreated": null, "callbacks_on_offline_eval_runners_recreated": null, "callbacks_on_checkpoint_loaded": null, "callbacks_on_environment_created": null, "callbacks_on_episode_created": null, "callbacks_on_episode_start": null, "callbacks_on_episode_step": null, "callbacks_on_episode_end": null, "callbacks_on_evaluate_start": null, "callbacks_on_evaluate_end": null, "callbacks_on_evaluate_offline_start": null, "callbacks_on_evaluate_offline_end": null, "callbacks_on_sample_end": null, "callbacks_on_train_result": null, "explore": true, "enable_rl_module_and_learner": true, "enable_env_runner_and_connector_v2": true, "_prior_exploration_config": {"type": "StochasticSampling"}, "count_steps_by": "env_steps", "policy_map_capacity": 100, "policy_mapping_fn": "<function AlgorithmConfig.DEFAULT_POLICY_MAPPING_FN at 0x383de9b20>", "policies_to_train": null, "policy_states_are_swappable": false, "observation_fn": null, "offline_data_class": null, "input_read_method": "read_parquet", "input_read_method_kwargs": {}, "input_read_schema": {}, "input_read_episodes": false, "input_read_sample_batches": false, "input_read_batch_size": null, "input_filesystem": null, "input_filesystem_kwargs": {}, "input_compress_columns": ["obs", "new_obs"], "input_spaces_jsonable": true, "materialize_data": false, "materialize_mapped_data": true, "map_batches_kwargs": {}, "iter_batches_kwargs": {}, "ignore_final_observation": false, "prelearner_class": null, "prelearner_buffer_class": null, "prelearner_buffer_kwargs": {}, "prelearner_module_synch_period": 10, "dataset_num_iters_per_learner": null, "input_config": {}, "actions_in_input_normalized": false, "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_config": {}, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "output_max_rows_per_file": null, "output_write_remaining_data": false, "output_write_method": "write_parquet", "output_write_method_kwargs": {}, "output_filesystem": null, "output_filesystem_kwargs": {}, "output_write_episodes": true, "offline_sampling": false, "evaluation_interval": 1, "evaluation_duration": 20, "evaluation_duration_unit": "episodes", "evaluation_sample_timeout_s": 120.0, "evaluation_auto_duration_min_env_steps_per_sample": 100, "evaluation_auto_duration_max_env_steps_per_sample": 2000, "evaluation_parallel_to_training": false, "evaluation_force_reset_envs_before_iteration": true, "evaluation_config": null, "off_policy_estimation_methods": {}, "ope_split_batch_by_episode": true, "evaluation_num_env_runners": 1, "in_evaluation": false, "sync_filters_on_rollout_workers_timeout_s": 10.0, "offline_evaluation_interval": null, "num_offline_eval_runners": 0, "offline_loss_for_module_fn": null, "offline_evaluation_duration": 1, "offline_evaluation_parallel_to_training": false, "offline_evaluation_timeout_s": 120.0, "num_cpus_per_offline_eval_runner": 1, "num_gpus_per_offline_eval_runner": 0, "custom_resources_per_offline_eval_runner": {}, "restart_failed_offline_eval_runners": true, "ignore_offline_eval_runner_failures": false, "max_num_offline_eval_runner_restarts": 1000, "offline_eval_runner_restore_timeout_s": 1800.0, "max_requests_in_flight_per_offline_eval_runner": 1, "validate_offline_eval_runners_after_construction": true, "offline_eval_runner_health_probe_timeout_s": 30.0, "offline_eval_rl_module_inference_only": false, "broadcast_offline_eval_runner_states": false, "offline_eval_batch_size_per_runner": 256, "dataset_num_iters_per_eval_runner": 1, "keep_per_episode_custom_metrics": false, "metrics_episode_collection_timeout_s": 60.0, "metrics_num_episodes_for_smoothing": 100, "min_time_s_per_iteration": null, "min_train_timesteps_per_iteration": 0, "min_sample_timesteps_per_iteration": 0, "log_gradients": true, "export_native_model_files": false, "checkpoint_trainable_policies_only": false, "logger_creator": null, "logger_config": null, "log_level": "WARN", "log_sys_usage": true, "fake_sampler": false, "seed": 4, "restart_failed_env_runners": true, "ignore_env_runner_failures": false, "max_num_env_runner_restarts": 1000, "delay_between_env_runner_restarts_s": 60.0, "restart_failed_sub_environments": false, "num_consecutive_env_runner_failures_tolerance": 100, "env_runner_health_probe_timeout_s": 30.0, "env_runner_restore_timeout_s": 1800.0, "_model_config": {}, "_rl_module_spec": "RLModuleSpec(module_class=None, observation_space=None, action_space=None, inference_only=False, learner_only=False, model_config=DefaultModelConfig(fcnet_hiddens=[60, 90], fcnet_activation='tanh', fcnet_kernel_initializer=None, fcnet_kernel_initializer_kwargs=None, fcnet_bias_initializer=None, fcnet_bias_initializer_kwargs=None, conv_filters=None, conv_activation='relu', conv_kernel_initializer=None, conv_kernel_initializer_kwargs=None, conv_bias_initializer=None, conv_bias_initializer_kwargs=None, head_fcnet_hiddens=[], head_fcnet_activation='relu', head_fcnet_kernel_initializer=None, head_fcnet_kernel_initializer_kwargs=None, head_fcnet_bias_initializer=None, head_fcnet_bias_initializer_kwargs=None, free_log_std=False, log_std_clip_param=20.0, vf_share_layers=True, use_lstm=False, max_seq_len=20, lstm_cell_size=256, lstm_use_prev_action=False, lstm_use_prev_reward=False, lstm_kernel_initializer=None, lstm_kernel_initializer_kwargs=None, lstm_bias_initializer=None, lstm_bias_initializer_kwargs=None), catalog_class=None, load_state_path=None, model_config_dict=None)", "algorithm_config_overrides_per_module": {}, "_per_module_overrides": {}, "_validate_config": true, "_use_msgpack_checkpoints": false, "_torch_grad_scaler_class": null, "_torch_lr_scheduler_classes": null, "_tf_policy_handles_more_than_one_loss": false, "_disable_preprocessor_api": false, "_disable_action_flattening": false, "_disable_initialize_loss_from_dummy_batch": false, "_dont_auto_sync_env_runner_states": false, "env_task_fn": -1, "enable_connectors": -1, "simple_optimizer": false, "policy_map_cache": -1, "worker_cls": -1, "synchronize_filters": -1, "enable_async_evaluation": -1, "custom_async_evaluation_function": -1, "_enable_rl_module_api": -1, "auto_wrap_old_gym_envs": -1, "always_attach_evaluation_results": -1, "replay_sequence_length": null, "_disable_execution_plan_api": -1, "use_critic": true, "use_gae": true, "use_kl_loss": true, "kl_coeff": 0.7464963036515, "kl_target": 0.0270990929592, "vf_loss_coeff": 0.6688075857018, "entropy_coeff": 0.0090570820258, "clip_param": 0.1221781641624, "vf_clip_param": 0.1027808522125, "entropy_coeff_schedule": null, "lr_schedule": null, "sgd_minibatch_size": -1, "vf_share_layers": -1, "__stdout_file__": null, "__stderr_file__": null, "lambda": 0.9099046732075, "input": "sampler", "policies": {"default_policy": [null, null, null, null]}, "callbacks": "<class 'ray.rllib.callbacks.callbacks.RLlibCallback'>", "create_env_on_driver": false, "custom_eval_function": null, "framework": "torch"}, "time_since_restore": 17.91345715522766, "iterations_since_restore": 10, "perf": {"cpu_util_percent": 43.0, "ram_util_percent": 79.7}}
{"timers": {"training_iteration": 1.8783553023167645, "restore_env_runners": 7.381492049813276e-05, "training_step": 1.8780336680793202, "env_runner_sampling_timer": 1.7618129757134469, "learner_update_timer": 0.11273695307640955, "synch_weights": 0.0006243845725029704, "restore_eval_env_runners": 8.197091404882557e-06, "evaluation_iteration": 0.11845168345270397, "synch_eval_env_connectors": 0.00012901875494258905, "synch_env_connectors": 4.622027081060564e-06}, "env_runners": {"env_to_module_connector": {"connector_pipeline_timer": 4.34565859592668e-05, "timers": {"connectors": {"add_time_dim_to_batch_and_zero_pad": 2.411592079387072e-06, "batch_individual_items": 6.257284076934108e-06, "numpy_to_tensor": 8.579250786563481e-06, "add_observations_from_episodes_to_batch": 2.9436262345968103e-06, "add_states_from_episodes_to_batch": 1.7399930699547599e-06}}}, "env_step_timer": 1.3845761481098406e-05, "num_agent_steps_sampled_lifetime": {"default_agent": -5547500.0}, "env_to_module_sum_episodes_length_out": 10.36823839457432, "module_to_env_connector": {"timers": {"connectors": {"normalize_and_clip_actions": 9.601797634263243e-06, "tensor_to_numpy": 1.32153087102714e-05, "remove_single_ts_time_rank_from_batch": 5.798933048607299e-07, "un_batch_to_individual_items": 5.425238047413146e-06, "get_actions": 3.9277832574958815e-05, "listify_data_for_vector_env": 1.0979683057988686e-05}}, "connector_pipeline_timer": 0.00010449875741696065}, "num_agent_steps_sampled": {"default_agent": 5000.0}, "module_episode_returns_mean": {"default_policy": 8.980000000000004}, "env_reset_timer": 3.209022570096701e-05, "episode_return_max": 12.5, "sample": 0.004825678195165337, "env_to_module_sum_episodes_length_in": 10.36823839457432, "num_module_steps_sampled_lifetime": {"default_policy": -5547500.0}, "episode_return_mean": 8.980000000000004, "episode_duration_sec_mean": 0.00457714598905295, "num_env_steps_sampled": 5000.0, "num_episodes": 250.0, "episode_len_mean": 20.0, "rlmodule_inference_timer": 2.854910873031255e-05, "episode_len_min": 20, "episode_len_max": 20, "agent_episode_returns_mean": {"default_agent": 8.980000000000004}, "num_module_steps_sampled": {"default_policy": 5000.0}, "num_episodes_lifetime": -277375.0, "num_env_steps_sampled_lifetime": -5547500.0, "weights_seq_no": 10.0, "episode_return_min": -7.5, "time_between_sampling": 0.0018641590755015377, "num_env_steps_sampled_lifetime_throughput": 3743.2350750459045}, "learners": {"default_policy": {"curr_kl_coeff": 0.0003645001561380923, "gradients_default_optimizer_global_norm": 0.041982702910900116, "vf_loss": 0.10181104391813278, "total_loss": 0.05192509666085243, "num_module_steps_trained": 6000, "diff_num_grad_updates_vs_sampler_policy": 1.0, "module_train_batch_size_mean": 1000.0, "entropy": 0.5055301785469055, "num_module_steps_trained_lifetime": 66000, "curr_entropy_coeff": 0.0090570820258, "vf_loss_unclipped": 28.64272689819336, "weights_seq_no": 11.0, "default_optimizer_learning_rate": 0.0002847858517, "vf_explained_var": 0.019914567470550537, "mean_kl_loss": 0.0015682962257415056, "num_trainable_parameters": 6003, "policy_loss": -0.011589430272579193, "num_module_steps_trained_lifetime_throughput": 349967.69440718455}, "__all_modules__": {"learner_connector": {"timers": {"connectors": {"numpy_to_tensor": 6.26275697921346e-05, "batch_individual_items": 0.03338196194246672, "add_columns_from_episodes_to_train_batch": 0.034193094126570824, "add_time_dim_to_batch_and_zero_pad": 9.895497587127683e-06, "add_one_ts_to_episodes_and_truncate": 0.00856992429293722, "add_observations_from_episodes_to_batch": 0.000815891678682878, "general_advantage_estimation": 0.006771908186239254, "add_states_from_episodes_to_batch": 3.5362057658975544e-06}}, "connector_pipeline_timer": 0.08391613511022265}, "num_env_steps_trained": 31500, "num_env_steps_trained_lifetime": 346500, "learner_connector_sum_episodes_length_out": 5250.0, "learner_connector_sum_episodes_length_in": 5000.0, "num_module_steps_trained_lifetime": 66000, "num_non_trainable_parameters": 0, "num_module_steps_trained": 6000, "num_trainable_parameters": 6003, "num_env_steps_trained_lifetime_throughput": 1829565.4980000774, "num_module_steps_trained_throughput": 349588.5733146367, "num_module_steps_trained_lifetime_throughput": 349213.46207309765}}, "num_training_step_calls_per_iteration": 1, "evaluation": {"env_runners": {"sample": 0.10672563618210064, "env_to_module_sum_episodes_length_in": 10.368238394574323, "num_module_steps_sampled": {"default_policy": 400}, "module_to_env_connector": {"timers": {"connectors": {"tensor_to_numpy": 1.2396162920835248e-05, "remove_single_ts_time_rank_from_batch": 5.728797284490132e-07, "listify_data_for_vector_env": 1.0650934363827801e-05, "normalize_and_clip_actions": 9.121289619538565e-06, "get_actions": 3.417838004463019e-05, "un_batch_to_individual_items": 5.175394840525931e-06}}, "connector_pipeline_timer": 9.750531786646698e-05}, "rlmodule_inference_timer": 2.6956620512803257e-05, "env_to_module_connector": {"timers": {"connectors": {"add_time_dim_to_batch_and_zero_pad": 2.1832616841732282e-06, "numpy_to_tensor": 8.016375582554641e-06, "add_states_from_episodes_to_batch": 1.601515648147428e-06, "batch_individual_items": 6.109720772621173e-06, "add_observations_from_episodes_to_batch": 2.7680763950359293e-06}}, "connector_pipeline_timer": 4.216359919489541e-05}, "episode_len_max": 20, "num_agent_steps_sampled_lifetime": {"default_agent": 4400}, "num_episodes_lifetime": 220, "episode_return_min": -16.5, "env_step_timer": 1.3475931258575099e-05, "env_to_module_sum_episodes_length_out": 10.368238394574323, "num_env_steps_sampled": 400, "episode_len_mean": 20.0, "num_agent_steps_sampled": {"default_agent": 400}, "num_env_steps_sampled_lifetime": 55400, "weights_seq_no": 11.0, "module_episode_returns_mean": {"default_policy": 0.75}, "num_module_steps_sampled_lifetime": {"default_policy": 4400}, "num_episodes": 20, "episode_len_min": 20, "env_reset_timer": 0.000514436342034073, "episode_return_max": 12.5, "agent_episode_returns_mean": {"default_agent": 0.75}, "episode_return_mean": 0.75, "episode_duration_sec_mean": 0.004648257942171767, "time_between_sampling": 1.7458749585582656}, "num_healthy_workers": 1, "actor_manager_num_outstanding_async_reqs": 0, "num_remote_worker_restarts": 0}, "num_env_steps_sampled_lifetime": -5547500.0, "fault_tolerance": {"num_healthy_workers": 0, "num_remote_worker_restarts": 0}, "env_runner_group": {"actor_manager_num_outstanding_async_reqs": 0}, "done": false, "training_iteration": 11, "trial_id": "4da5b_00000", "date": "2025-08-11_19-21-55", "timestamp": 1754932915, "time_this_iter_s": 1.5851831436157227, "time_total_s": 19.498640298843384, "pid": 14327, "hostname": "Mac", "node_ip": "127.0.0.1", "config": {"exploration_config": {}, "extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "placement_strategy": "PACK", "num_gpus": 0, "_fake_gpus": false, "num_cpus_for_main_process": 2, "eager_tracing": true, "eager_max_retraces": 20, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "torch_compile_learner": false, "torch_compile_learner_what_to_compile": "forward_train", "torch_compile_learner_dynamo_backend": "aot_eager", "torch_compile_learner_dynamo_mode": null, "torch_compile_worker": false, "torch_compile_worker_dynamo_backend": "aot_eager", "torch_compile_worker_dynamo_mode": null, "torch_ddp_kwargs": {}, "torch_skip_nan_gradients": false, "env": "Umbrella", "env_config": {}, "observation_space": null, "action_space": null, "clip_rewards": null, "normalize_actions": true, "clip_actions": false, "_is_atari": null, "disable_env_checking": false, "render_env": false, "action_mask_key": "action_mask", "env_runner_cls": null, "num_env_runners": 0, "create_local_env_runner": true, "num_envs_per_env_runner": 1, "gym_env_vectorize_mode": "SYNC", "num_cpus_per_env_runner": 1, "num_gpus_per_env_runner": 0, "custom_resources_per_env_runner": {}, "validate_env_runners_after_construction": true, "episodes_to_numpy": true, "max_requests_in_flight_per_env_runner": 1, "sample_timeout_s": 60.0, "_env_to_module_connector": null, "add_default_connectors_to_env_to_module_pipeline": true, "_module_to_env_connector": null, "add_default_connectors_to_module_to_env_pipeline": true, "merge_env_runner_states": "training_only", "broadcast_env_runner_states": true, "episode_lookback_horizon": 1, "rollout_fragment_length": "auto", "batch_mode": "complete_episodes", "compress_observations": false, "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "enable_tf1_exec_eagerly": false, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "preprocessor_pref": "deepmind", "observation_filter": "NoFilter", "update_worker_filter_stats": true, "use_worker_filter_stats": true, "sampler_perf_stats_ema_coef": null, "_is_online": true, "num_learners": 0, "num_gpus_per_learner": 0, "num_cpus_per_learner": "auto", "num_aggregator_actors_per_learner": 0, "max_requests_in_flight_per_aggregator_actor": 3, "local_gpu_idx": 0, "max_requests_in_flight_per_learner": 3, "gamma": 1, "lr": 0.0002847858517, "grad_clip": 0.5, "grad_clip_by": "global_norm", "_train_batch_size_per_learner": 5000, "train_batch_size": 4000, "num_epochs": 1, "minibatch_size": 1000, "shuffle_batch_per_epoch": true, "model": {"fcnet_hiddens": [256, 256], "fcnet_activation": "tanh", "fcnet_weights_initializer": null, "fcnet_weights_initializer_config": null, "fcnet_bias_initializer": null, "fcnet_bias_initializer_config": null, "conv_filters": null, "conv_activation": "relu", "conv_kernel_initializer": null, "conv_kernel_initializer_config": null, "conv_bias_initializer": null, "conv_bias_initializer_config": null, "conv_transpose_kernel_initializer": null, "conv_transpose_kernel_initializer_config": null, "conv_transpose_bias_initializer": null, "conv_transpose_bias_initializer_config": null, "post_fcnet_hiddens": [], "post_fcnet_activation": "relu", "post_fcnet_weights_initializer": null, "post_fcnet_weights_initializer_config": null, "post_fcnet_bias_initializer": null, "post_fcnet_bias_initializer_config": null, "free_log_std": false, "log_std_clip_param": 20.0, "no_final_linear": false, "vf_share_layers": false, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "lstm_weights_initializer": null, "lstm_weights_initializer_config": null, "lstm_bias_initializer": null, "lstm_bias_initializer_config": null, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "attention_use_n_prev_actions": 0, "attention_use_n_prev_rewards": 0, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": null, "custom_model_config": {}, "custom_action_dist": null, "custom_preprocessor": null, "encoder_latent_dim": null, "always_check_shapes": false, "lstm_use_prev_action_reward": -1, "_use_default_native_models": -1, "_disable_preprocessor_api": false, "_disable_action_flattening": false}, "_learner_connector": null, "add_default_connectors_to_learner_pipeline": true, "learner_config_dict": {}, "optimizer": {}, "_learner_class": null, "callbacks_on_algorithm_init": null, "callbacks_on_env_runners_recreated": null, "callbacks_on_offline_eval_runners_recreated": null, "callbacks_on_checkpoint_loaded": null, "callbacks_on_environment_created": null, "callbacks_on_episode_created": null, "callbacks_on_episode_start": null, "callbacks_on_episode_step": null, "callbacks_on_episode_end": null, "callbacks_on_evaluate_start": null, "callbacks_on_evaluate_end": null, "callbacks_on_evaluate_offline_start": null, "callbacks_on_evaluate_offline_end": null, "callbacks_on_sample_end": null, "callbacks_on_train_result": null, "explore": true, "enable_rl_module_and_learner": true, "enable_env_runner_and_connector_v2": true, "_prior_exploration_config": {"type": "StochasticSampling"}, "count_steps_by": "env_steps", "policy_map_capacity": 100, "policy_mapping_fn": "<function AlgorithmConfig.DEFAULT_POLICY_MAPPING_FN at 0x383de9b20>", "policies_to_train": null, "policy_states_are_swappable": false, "observation_fn": null, "offline_data_class": null, "input_read_method": "read_parquet", "input_read_method_kwargs": {}, "input_read_schema": {}, "input_read_episodes": false, "input_read_sample_batches": false, "input_read_batch_size": null, "input_filesystem": null, "input_filesystem_kwargs": {}, "input_compress_columns": ["obs", "new_obs"], "input_spaces_jsonable": true, "materialize_data": false, "materialize_mapped_data": true, "map_batches_kwargs": {}, "iter_batches_kwargs": {}, "ignore_final_observation": false, "prelearner_class": null, "prelearner_buffer_class": null, "prelearner_buffer_kwargs": {}, "prelearner_module_synch_period": 10, "dataset_num_iters_per_learner": null, "input_config": {}, "actions_in_input_normalized": false, "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_config": {}, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "output_max_rows_per_file": null, "output_write_remaining_data": false, "output_write_method": "write_parquet", "output_write_method_kwargs": {}, "output_filesystem": null, "output_filesystem_kwargs": {}, "output_write_episodes": true, "offline_sampling": false, "evaluation_interval": 1, "evaluation_duration": 20, "evaluation_duration_unit": "episodes", "evaluation_sample_timeout_s": 120.0, "evaluation_auto_duration_min_env_steps_per_sample": 100, "evaluation_auto_duration_max_env_steps_per_sample": 2000, "evaluation_parallel_to_training": false, "evaluation_force_reset_envs_before_iteration": true, "evaluation_config": null, "off_policy_estimation_methods": {}, "ope_split_batch_by_episode": true, "evaluation_num_env_runners": 1, "in_evaluation": false, "sync_filters_on_rollout_workers_timeout_s": 10.0, "offline_evaluation_interval": null, "num_offline_eval_runners": 0, "offline_loss_for_module_fn": null, "offline_evaluation_duration": 1, "offline_evaluation_parallel_to_training": false, "offline_evaluation_timeout_s": 120.0, "num_cpus_per_offline_eval_runner": 1, "num_gpus_per_offline_eval_runner": 0, "custom_resources_per_offline_eval_runner": {}, "restart_failed_offline_eval_runners": true, "ignore_offline_eval_runner_failures": false, "max_num_offline_eval_runner_restarts": 1000, "offline_eval_runner_restore_timeout_s": 1800.0, "max_requests_in_flight_per_offline_eval_runner": 1, "validate_offline_eval_runners_after_construction": true, "offline_eval_runner_health_probe_timeout_s": 30.0, "offline_eval_rl_module_inference_only": false, "broadcast_offline_eval_runner_states": false, "offline_eval_batch_size_per_runner": 256, "dataset_num_iters_per_eval_runner": 1, "keep_per_episode_custom_metrics": false, "metrics_episode_collection_timeout_s": 60.0, "metrics_num_episodes_for_smoothing": 100, "min_time_s_per_iteration": null, "min_train_timesteps_per_iteration": 0, "min_sample_timesteps_per_iteration": 0, "log_gradients": true, "export_native_model_files": false, "checkpoint_trainable_policies_only": false, "logger_creator": null, "logger_config": null, "log_level": "WARN", "log_sys_usage": true, "fake_sampler": false, "seed": 4, "restart_failed_env_runners": true, "ignore_env_runner_failures": false, "max_num_env_runner_restarts": 1000, "delay_between_env_runner_restarts_s": 60.0, "restart_failed_sub_environments": false, "num_consecutive_env_runner_failures_tolerance": 100, "env_runner_health_probe_timeout_s": 30.0, "env_runner_restore_timeout_s": 1800.0, "_model_config": {}, "_rl_module_spec": "RLModuleSpec(module_class=None, observation_space=None, action_space=None, inference_only=False, learner_only=False, model_config=DefaultModelConfig(fcnet_hiddens=[60, 90], fcnet_activation='tanh', fcnet_kernel_initializer=None, fcnet_kernel_initializer_kwargs=None, fcnet_bias_initializer=None, fcnet_bias_initializer_kwargs=None, conv_filters=None, conv_activation='relu', conv_kernel_initializer=None, conv_kernel_initializer_kwargs=None, conv_bias_initializer=None, conv_bias_initializer_kwargs=None, head_fcnet_hiddens=[], head_fcnet_activation='relu', head_fcnet_kernel_initializer=None, head_fcnet_kernel_initializer_kwargs=None, head_fcnet_bias_initializer=None, head_fcnet_bias_initializer_kwargs=None, free_log_std=False, log_std_clip_param=20.0, vf_share_layers=True, use_lstm=False, max_seq_len=20, lstm_cell_size=256, lstm_use_prev_action=False, lstm_use_prev_reward=False, lstm_kernel_initializer=None, lstm_kernel_initializer_kwargs=None, lstm_bias_initializer=None, lstm_bias_initializer_kwargs=None), catalog_class=None, load_state_path=None, model_config_dict=None)", "algorithm_config_overrides_per_module": {}, "_per_module_overrides": {}, "_validate_config": true, "_use_msgpack_checkpoints": false, "_torch_grad_scaler_class": null, "_torch_lr_scheduler_classes": null, "_tf_policy_handles_more_than_one_loss": false, "_disable_preprocessor_api": false, "_disable_action_flattening": false, "_disable_initialize_loss_from_dummy_batch": false, "_dont_auto_sync_env_runner_states": false, "env_task_fn": -1, "enable_connectors": -1, "simple_optimizer": false, "policy_map_cache": -1, "worker_cls": -1, "synchronize_filters": -1, "enable_async_evaluation": -1, "custom_async_evaluation_function": -1, "_enable_rl_module_api": -1, "auto_wrap_old_gym_envs": -1, "always_attach_evaluation_results": -1, "replay_sequence_length": null, "_disable_execution_plan_api": -1, "use_critic": true, "use_gae": true, "use_kl_loss": true, "kl_coeff": 0.7464963036515, "kl_target": 0.0270990929592, "vf_loss_coeff": 0.6688075857018, "entropy_coeff": 0.0090570820258, "clip_param": 0.1221781641624, "vf_clip_param": 0.1027808522125, "entropy_coeff_schedule": null, "lr_schedule": null, "sgd_minibatch_size": -1, "vf_share_layers": -1, "__stdout_file__": null, "__stderr_file__": null, "lambda": 0.9099046732075, "input": "sampler", "policies": {"default_policy": [null, null, null, null]}, "callbacks": "<class 'ray.rllib.callbacks.callbacks.RLlibCallback'>", "create_env_on_driver": false, "custom_eval_function": null, "framework": "torch"}, "time_since_restore": 19.498640298843384, "iterations_since_restore": 11, "perf": {"cpu_util_percent": 38.7, "ram_util_percent": 78.6}}
{"timers": {"training_iteration": 1.8780093842934606, "restore_env_runners": 7.314010122822529e-05, "training_step": 1.877688539727992, "env_runner_sampling_timer": 1.7614829147057887, "learner_update_timer": 0.11271240479632441, "synch_weights": 0.0006301294769712088, "restore_eval_env_runners": 8.211370350613805e-06, "evaluation_iteration": 0.11828494702806995, "synch_eval_env_connectors": 0.0001286839879393968, "synch_env_connectors": 4.612476472472224e-06}, "env_runners": {"env_to_module_connector": {"connector_pipeline_timer": 4.781666532193811e-05, "timers": {"connectors": {"add_time_dim_to_batch_and_zero_pad": 2.5670234226287113e-06, "batch_individual_items": 7.1223618497830055e-06, "numpy_to_tensor": 1.0071649931439629e-05, "add_observations_from_episodes_to_batch": 3.4883902190945794e-06, "add_states_from_episodes_to_batch": 1.8074952752386422e-06}}}, "env_step_timer": 1.570071241612236e-05, "num_agent_steps_sampled_lifetime": {"default_agent": -6165000.0}, "env_to_module_sum_episodes_length_out": 10.36823839457432, "module_to_env_connector": {"timers": {"connectors": {"normalize_and_clip_actions": 1.0520383606025945e-05, "tensor_to_numpy": 1.4946261713425217e-05, "remove_single_ts_time_rank_from_batch": 6.163722202432109e-07, "un_batch_to_individual_items": 5.883854950605817e-06, "get_actions": 4.489921142422898e-05, "listify_data_for_vector_env": 1.184312645905129e-05}}, "connector_pipeline_timer": 0.00011703392677276281}, "num_agent_steps_sampled": {"default_agent": 5000.0}, "module_episode_returns_mean": {"default_policy": 9.700000000000003}, "env_reset_timer": 4.412152533014711e-05, "episode_return_max": 12.5, "sample": 0.00505877084430719, "env_to_module_sum_episodes_length_in": 10.36823839457432, "num_module_steps_sampled_lifetime": {"default_policy": -6165000.0}, "episode_return_mean": 9.700000000000003, "episode_duration_sec_mean": 0.005289124364964663, "num_env_steps_sampled": 5000.0, "num_episodes": 250.0, "episode_len_mean": 20.0, "rlmodule_inference_timer": 3.4643120041611146e-05, "episode_len_min": 20, "episode_len_max": 20, "agent_episode_returns_mean": {"default_agent": 9.700000000000003}, "num_module_steps_sampled": {"default_policy": 5000.0}, "num_episodes_lifetime": -308250.0, "num_env_steps_sampled_lifetime": -6165000.0, "weights_seq_no": 11.0, "episode_return_min": -7.5, "time_between_sampling": 0.0018364732148365447, "num_env_steps_sampled_lifetime_throughput": 3551.0575031304043}, "learners": {"default_policy": {"curr_kl_coeff": 0.00018225007806904614, "gradients_default_optimizer_global_norm": 0.05857674777507782, "vf_loss": 0.1020260602235794, "total_loss": 0.03486289083957672, "num_module_steps_trained": 6000, "diff_num_grad_updates_vs_sampler_policy": 1.0, "module_train_batch_size_mean": 1000.0, "entropy": 0.4821460247039795, "num_module_steps_trained_lifetime": 72000, "curr_entropy_coeff": 0.0090570820258, "vf_loss_unclipped": 28.63893699645996, "weights_seq_no": 12.0, "default_optimizer_learning_rate": 0.0002847858517, "vf_explained_var": 0.01924508810043335, "mean_kl_loss": 0.00028911055414937437, "num_trainable_parameters": 6003, "policy_loss": -0.02900618687272072, "num_module_steps_trained_lifetime_throughput": 350594.7294086991}, "__all_modules__": {"learner_connector": {"timers": {"connectors": {"numpy_to_tensor": 6.266462394137024e-05, "batch_individual_items": 0.03337309982302111, "add_columns_from_episodes_to_train_batch": 0.03423946610475999, "add_time_dim_to_batch_and_zero_pad": 1.0075292114451691e-05, "add_one_ts_to_episodes_and_truncate": 0.008603724630476829, "add_observations_from_episodes_to_batch": 0.0008175069213032923, "general_advantage_estimation": 0.006762233263463283, "add_states_from_episodes_to_batch": 3.535843974745847e-06}}, "connector_pipeline_timer": 0.08397971917900081}, "num_env_steps_trained": 31500, "num_env_steps_trained_lifetime": 378000, "learner_connector_sum_episodes_length_out": 5250.0, "learner_connector_sum_episodes_length_in": 5000.0, "num_module_steps_trained_lifetime": 72000, "num_non_trainable_parameters": 0, "num_module_steps_trained": 6000, "num_trainable_parameters": 6003, "num_env_steps_trained_lifetime_throughput": 1833355.7440773386, "num_module_steps_trained_throughput": 350267.7279063697, "num_module_steps_trained_lifetime_throughput": 349902.86748423055}}, "num_training_step_calls_per_iteration": 1, "evaluation": {"env_runners": {"sample": 0.106754691490542, "env_to_module_sum_episodes_length_in": 10.368238394574323, "num_module_steps_sampled": {"default_policy": 400}, "module_to_env_connector": {"timers": {"connectors": {"tensor_to_numpy": 1.322146803715535e-05, "remove_single_ts_time_rank_from_batch": 6.096925681155979e-07, "listify_data_for_vector_env": 1.1265321771056753e-05, "normalize_and_clip_actions": 9.768518388074198e-06, "get_actions": 3.768905859363803e-05, "un_batch_to_individual_items": 5.6126357526015505e-06}}, "connector_pipeline_timer": 0.00010477968866163256}, "rlmodule_inference_timer": 2.8946560675916234e-05, "env_to_module_connector": {"timers": {"connectors": {"add_time_dim_to_batch_and_zero_pad": 2.3118633513835793e-06, "numpy_to_tensor": 8.807505574111498e-06, "add_states_from_episodes_to_batch": 1.611173305181849e-06, "batch_individual_items": 6.537623484894727e-06, "add_observations_from_episodes_to_batch": 3.009569860090422e-06}}, "connector_pipeline_timer": 4.4614110581293203e-05}, "episode_len_max": 20, "num_agent_steps_sampled_lifetime": {"default_agent": 4800}, "num_episodes_lifetime": 240, "episode_return_min": -16.5, "env_step_timer": 1.4649933161506547e-05, "env_to_module_sum_episodes_length_out": 10.368238394574323, "num_env_steps_sampled": 400, "episode_len_mean": 20.0, "num_agent_steps_sampled": {"default_agent": 400}, "num_env_steps_sampled_lifetime": 60400, "weights_seq_no": 12.0, "module_episode_returns_mean": {"default_policy": -0.05}, "num_module_steps_sampled_lifetime": {"default_policy": 4800}, "num_episodes": 20, "episode_len_min": 20, "env_reset_timer": 0.0005144286486928146, "episode_return_max": 12.5, "agent_episode_returns_mean": {"default_agent": -0.05}, "episode_return_mean": -0.05, "episode_duration_sec_mean": 0.0046788416686467825, "time_between_sampling": 1.7471284564721805}, "num_healthy_workers": 1, "actor_manager_num_outstanding_async_reqs": 0, "num_remote_worker_restarts": 0}, "num_env_steps_sampled_lifetime": -6165000.0, "fault_tolerance": {"num_healthy_workers": 0, "num_remote_worker_restarts": 0}, "env_runner_group": {"actor_manager_num_outstanding_async_reqs": 0}, "done": false, "training_iteration": 12, "trial_id": "4da5b_00000", "date": "2025-08-11_19-21-56", "timestamp": 1754932916, "time_this_iter_s": 1.9725711345672607, "time_total_s": 21.471211433410645, "pid": 14327, "hostname": "Mac", "node_ip": "127.0.0.1", "config": {"exploration_config": {}, "extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "placement_strategy": "PACK", "num_gpus": 0, "_fake_gpus": false, "num_cpus_for_main_process": 2, "eager_tracing": true, "eager_max_retraces": 20, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "torch_compile_learner": false, "torch_compile_learner_what_to_compile": "forward_train", "torch_compile_learner_dynamo_backend": "aot_eager", "torch_compile_learner_dynamo_mode": null, "torch_compile_worker": false, "torch_compile_worker_dynamo_backend": "aot_eager", "torch_compile_worker_dynamo_mode": null, "torch_ddp_kwargs": {}, "torch_skip_nan_gradients": false, "env": "Umbrella", "env_config": {}, "observation_space": null, "action_space": null, "clip_rewards": null, "normalize_actions": true, "clip_actions": false, "_is_atari": null, "disable_env_checking": false, "render_env": false, "action_mask_key": "action_mask", "env_runner_cls": null, "num_env_runners": 0, "create_local_env_runner": true, "num_envs_per_env_runner": 1, "gym_env_vectorize_mode": "SYNC", "num_cpus_per_env_runner": 1, "num_gpus_per_env_runner": 0, "custom_resources_per_env_runner": {}, "validate_env_runners_after_construction": true, "episodes_to_numpy": true, "max_requests_in_flight_per_env_runner": 1, "sample_timeout_s": 60.0, "_env_to_module_connector": null, "add_default_connectors_to_env_to_module_pipeline": true, "_module_to_env_connector": null, "add_default_connectors_to_module_to_env_pipeline": true, "merge_env_runner_states": "training_only", "broadcast_env_runner_states": true, "episode_lookback_horizon": 1, "rollout_fragment_length": "auto", "batch_mode": "complete_episodes", "compress_observations": false, "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "enable_tf1_exec_eagerly": false, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "preprocessor_pref": "deepmind", "observation_filter": "NoFilter", "update_worker_filter_stats": true, "use_worker_filter_stats": true, "sampler_perf_stats_ema_coef": null, "_is_online": true, "num_learners": 0, "num_gpus_per_learner": 0, "num_cpus_per_learner": "auto", "num_aggregator_actors_per_learner": 0, "max_requests_in_flight_per_aggregator_actor": 3, "local_gpu_idx": 0, "max_requests_in_flight_per_learner": 3, "gamma": 1, "lr": 0.0002847858517, "grad_clip": 0.5, "grad_clip_by": "global_norm", "_train_batch_size_per_learner": 5000, "train_batch_size": 4000, "num_epochs": 1, "minibatch_size": 1000, "shuffle_batch_per_epoch": true, "model": {"fcnet_hiddens": [256, 256], "fcnet_activation": "tanh", "fcnet_weights_initializer": null, "fcnet_weights_initializer_config": null, "fcnet_bias_initializer": null, "fcnet_bias_initializer_config": null, "conv_filters": null, "conv_activation": "relu", "conv_kernel_initializer": null, "conv_kernel_initializer_config": null, "conv_bias_initializer": null, "conv_bias_initializer_config": null, "conv_transpose_kernel_initializer": null, "conv_transpose_kernel_initializer_config": null, "conv_transpose_bias_initializer": null, "conv_transpose_bias_initializer_config": null, "post_fcnet_hiddens": [], "post_fcnet_activation": "relu", "post_fcnet_weights_initializer": null, "post_fcnet_weights_initializer_config": null, "post_fcnet_bias_initializer": null, "post_fcnet_bias_initializer_config": null, "free_log_std": false, "log_std_clip_param": 20.0, "no_final_linear": false, "vf_share_layers": false, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "lstm_weights_initializer": null, "lstm_weights_initializer_config": null, "lstm_bias_initializer": null, "lstm_bias_initializer_config": null, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "attention_use_n_prev_actions": 0, "attention_use_n_prev_rewards": 0, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": null, "custom_model_config": {}, "custom_action_dist": null, "custom_preprocessor": null, "encoder_latent_dim": null, "always_check_shapes": false, "lstm_use_prev_action_reward": -1, "_use_default_native_models": -1, "_disable_preprocessor_api": false, "_disable_action_flattening": false}, "_learner_connector": null, "add_default_connectors_to_learner_pipeline": true, "learner_config_dict": {}, "optimizer": {}, "_learner_class": null, "callbacks_on_algorithm_init": null, "callbacks_on_env_runners_recreated": null, "callbacks_on_offline_eval_runners_recreated": null, "callbacks_on_checkpoint_loaded": null, "callbacks_on_environment_created": null, "callbacks_on_episode_created": null, "callbacks_on_episode_start": null, "callbacks_on_episode_step": null, "callbacks_on_episode_end": null, "callbacks_on_evaluate_start": null, "callbacks_on_evaluate_end": null, "callbacks_on_evaluate_offline_start": null, "callbacks_on_evaluate_offline_end": null, "callbacks_on_sample_end": null, "callbacks_on_train_result": null, "explore": true, "enable_rl_module_and_learner": true, "enable_env_runner_and_connector_v2": true, "_prior_exploration_config": {"type": "StochasticSampling"}, "count_steps_by": "env_steps", "policy_map_capacity": 100, "policy_mapping_fn": "<function AlgorithmConfig.DEFAULT_POLICY_MAPPING_FN at 0x383de9b20>", "policies_to_train": null, "policy_states_are_swappable": false, "observation_fn": null, "offline_data_class": null, "input_read_method": "read_parquet", "input_read_method_kwargs": {}, "input_read_schema": {}, "input_read_episodes": false, "input_read_sample_batches": false, "input_read_batch_size": null, "input_filesystem": null, "input_filesystem_kwargs": {}, "input_compress_columns": ["obs", "new_obs"], "input_spaces_jsonable": true, "materialize_data": false, "materialize_mapped_data": true, "map_batches_kwargs": {}, "iter_batches_kwargs": {}, "ignore_final_observation": false, "prelearner_class": null, "prelearner_buffer_class": null, "prelearner_buffer_kwargs": {}, "prelearner_module_synch_period": 10, "dataset_num_iters_per_learner": null, "input_config": {}, "actions_in_input_normalized": false, "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_config": {}, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "output_max_rows_per_file": null, "output_write_remaining_data": false, "output_write_method": "write_parquet", "output_write_method_kwargs": {}, "output_filesystem": null, "output_filesystem_kwargs": {}, "output_write_episodes": true, "offline_sampling": false, "evaluation_interval": 1, "evaluation_duration": 20, "evaluation_duration_unit": "episodes", "evaluation_sample_timeout_s": 120.0, "evaluation_auto_duration_min_env_steps_per_sample": 100, "evaluation_auto_duration_max_env_steps_per_sample": 2000, "evaluation_parallel_to_training": false, "evaluation_force_reset_envs_before_iteration": true, "evaluation_config": null, "off_policy_estimation_methods": {}, "ope_split_batch_by_episode": true, "evaluation_num_env_runners": 1, "in_evaluation": false, "sync_filters_on_rollout_workers_timeout_s": 10.0, "offline_evaluation_interval": null, "num_offline_eval_runners": 0, "offline_loss_for_module_fn": null, "offline_evaluation_duration": 1, "offline_evaluation_parallel_to_training": false, "offline_evaluation_timeout_s": 120.0, "num_cpus_per_offline_eval_runner": 1, "num_gpus_per_offline_eval_runner": 0, "custom_resources_per_offline_eval_runner": {}, "restart_failed_offline_eval_runners": true, "ignore_offline_eval_runner_failures": false, "max_num_offline_eval_runner_restarts": 1000, "offline_eval_runner_restore_timeout_s": 1800.0, "max_requests_in_flight_per_offline_eval_runner": 1, "validate_offline_eval_runners_after_construction": true, "offline_eval_runner_health_probe_timeout_s": 30.0, "offline_eval_rl_module_inference_only": false, "broadcast_offline_eval_runner_states": false, "offline_eval_batch_size_per_runner": 256, "dataset_num_iters_per_eval_runner": 1, "keep_per_episode_custom_metrics": false, "metrics_episode_collection_timeout_s": 60.0, "metrics_num_episodes_for_smoothing": 100, "min_time_s_per_iteration": null, "min_train_timesteps_per_iteration": 0, "min_sample_timesteps_per_iteration": 0, "log_gradients": true, "export_native_model_files": false, "checkpoint_trainable_policies_only": false, "logger_creator": null, "logger_config": null, "log_level": "WARN", "log_sys_usage": true, "fake_sampler": false, "seed": 4, "restart_failed_env_runners": true, "ignore_env_runner_failures": false, "max_num_env_runner_restarts": 1000, "delay_between_env_runner_restarts_s": 60.0, "restart_failed_sub_environments": false, "num_consecutive_env_runner_failures_tolerance": 100, "env_runner_health_probe_timeout_s": 30.0, "env_runner_restore_timeout_s": 1800.0, "_model_config": {}, "_rl_module_spec": "RLModuleSpec(module_class=None, observation_space=None, action_space=None, inference_only=False, learner_only=False, model_config=DefaultModelConfig(fcnet_hiddens=[60, 90], fcnet_activation='tanh', fcnet_kernel_initializer=None, fcnet_kernel_initializer_kwargs=None, fcnet_bias_initializer=None, fcnet_bias_initializer_kwargs=None, conv_filters=None, conv_activation='relu', conv_kernel_initializer=None, conv_kernel_initializer_kwargs=None, conv_bias_initializer=None, conv_bias_initializer_kwargs=None, head_fcnet_hiddens=[], head_fcnet_activation='relu', head_fcnet_kernel_initializer=None, head_fcnet_kernel_initializer_kwargs=None, head_fcnet_bias_initializer=None, head_fcnet_bias_initializer_kwargs=None, free_log_std=False, log_std_clip_param=20.0, vf_share_layers=True, use_lstm=False, max_seq_len=20, lstm_cell_size=256, lstm_use_prev_action=False, lstm_use_prev_reward=False, lstm_kernel_initializer=None, lstm_kernel_initializer_kwargs=None, lstm_bias_initializer=None, lstm_bias_initializer_kwargs=None), catalog_class=None, load_state_path=None, model_config_dict=None)", "algorithm_config_overrides_per_module": {}, "_per_module_overrides": {}, "_validate_config": true, "_use_msgpack_checkpoints": false, "_torch_grad_scaler_class": null, "_torch_lr_scheduler_classes": null, "_tf_policy_handles_more_than_one_loss": false, "_disable_preprocessor_api": false, "_disable_action_flattening": false, "_disable_initialize_loss_from_dummy_batch": false, "_dont_auto_sync_env_runner_states": false, "env_task_fn": -1, "enable_connectors": -1, "simple_optimizer": false, "policy_map_cache": -1, "worker_cls": -1, "synchronize_filters": -1, "enable_async_evaluation": -1, "custom_async_evaluation_function": -1, "_enable_rl_module_api": -1, "auto_wrap_old_gym_envs": -1, "always_attach_evaluation_results": -1, "replay_sequence_length": null, "_disable_execution_plan_api": -1, "use_critic": true, "use_gae": true, "use_kl_loss": true, "kl_coeff": 0.7464963036515, "kl_target": 0.0270990929592, "vf_loss_coeff": 0.6688075857018, "entropy_coeff": 0.0090570820258, "clip_param": 0.1221781641624, "vf_clip_param": 0.1027808522125, "entropy_coeff_schedule": null, "lr_schedule": null, "sgd_minibatch_size": -1, "vf_share_layers": -1, "__stdout_file__": null, "__stderr_file__": null, "lambda": 0.9099046732075, "input": "sampler", "policies": {"default_policy": [null, null, null, null]}, "callbacks": "<class 'ray.rllib.callbacks.callbacks.RLlibCallback'>", "create_env_on_driver": false, "custom_eval_function": null, "framework": "torch"}, "time_since_restore": 21.471211433410645, "iterations_since_restore": 12, "perf": {"cpu_util_percent": 47.73333333333333, "ram_util_percent": 79.86666666666666}}
{"timers": {"training_iteration": 1.8771117183706478, "restore_env_runners": 7.250911075932521e-05, "training_step": 1.8767919485011757, "env_runner_sampling_timer": 1.7605651605589963, "learner_update_timer": 0.11272926449756827, "synch_weights": 0.0006330640127133945, "restore_eval_env_runners": 8.692597374347514e-06, "evaluation_iteration": 0.11836145796782949, "synch_eval_env_connectors": 0.000129390488034436, "synch_env_connectors": 4.644271975105924e-06}, "env_runners": {"env_to_module_connector": {"connector_pipeline_timer": 4.868094369216576e-05, "timers": {"connectors": {"add_time_dim_to_batch_and_zero_pad": 2.585306253776381e-06, "batch_individual_items": 6.82449469975547e-06, "numpy_to_tensor": 9.838811290434717e-06, "add_observations_from_episodes_to_batch": 3.2127320497493847e-06, "add_states_from_episodes_to_batch": 2.3146635191784003e-06}}}, "env_step_timer": 1.5173410561757048e-05, "num_agent_steps_sampled_lifetime": {"default_agent": -6782500.0}, "env_to_module_sum_episodes_length_out": 10.36823839457432, "module_to_env_connector": {"timers": {"connectors": {"normalize_and_clip_actions": 1.0352742646490387e-05, "tensor_to_numpy": 1.466635797746688e-05, "remove_single_ts_time_rank_from_batch": 6.331303959610883e-07, "un_batch_to_individual_items": 5.809149509642501e-06, "get_actions": 4.810812203431725e-05, "listify_data_for_vector_env": 1.1822640614237653e-05}}, "connector_pipeline_timer": 0.00011974049784810626}, "num_agent_steps_sampled": {"default_agent": 5000.0}, "module_episode_returns_mean": {"default_policy": 9.700000000000003}, "env_reset_timer": 9.119587761385761e-05, "episode_return_max": 12.5, "sample": 0.005766164046123858, "env_to_module_sum_episodes_length_in": 10.36823839457432, "num_module_steps_sampled_lifetime": {"default_policy": -6782500.0}, "episode_return_mean": 9.700000000000003, "episode_duration_sec_mean": 0.005060067806392907, "num_env_steps_sampled": 5000.0, "num_episodes": 250.0, "episode_len_mean": 20.0, "rlmodule_inference_timer": 3.20455698500681e-05, "episode_len_min": 20, "episode_len_max": 20, "agent_episode_returns_mean": {"default_agent": 9.700000000000003}, "num_module_steps_sampled": {"default_policy": 5000.0}, "num_episodes_lifetime": -339125.0, "num_env_steps_sampled_lifetime": -6782500.0, "weights_seq_no": 12.0, "episode_return_min": -7.5, "time_between_sampling": 0.002068918562150939, "num_env_steps_sampled_lifetime_throughput": 3458.1696769480013}, "learners": {"default_policy": {"curr_kl_coeff": 9.112503903452307e-05, "gradients_default_optimizer_global_norm": 0.049361228942871094, "vf_loss": 0.10202598571777344, "total_loss": 0.03346370533108711, "num_module_steps_trained": 6000, "diff_num_grad_updates_vs_sampler_policy": 1.0, "module_train_batch_size_mean": 1000.0, "entropy": 0.45641592144966125, "num_module_steps_trained_lifetime": 78000, "curr_entropy_coeff": 0.0090570820258, "vf_loss_unclipped": 28.627490997314453, "weights_seq_no": 13.0, "default_optimizer_learning_rate": 0.0002847858517, "vf_explained_var": 0.019546985626220703, "mean_kl_loss": 0.0008334144367836416, "num_trainable_parameters": 6003, "policy_loss": -0.030638419091701508, "num_module_steps_trained_lifetime_throughput": 350083.08303889673}, "__all_modules__": {"learner_connector": {"timers": {"connectors": {"numpy_to_tensor": 6.28567278245186e-05, "batch_individual_items": 0.03340766215532992, "add_columns_from_episodes_to_train_batch": 0.03426992061452945, "add_time_dim_to_batch_and_zero_pad": 1.0113289958779826e-05, "add_one_ts_to_episodes_and_truncate": 0.008618271554021813, "add_observations_from_episodes_to_batch": 0.0008179393530215075, "general_advantage_estimation": 0.006755276760634307, "add_states_from_episodes_to_batch": 3.532986364546032e-06}}, "connector_pipeline_timer": 0.08405311990693717}, "num_env_steps_trained": 31500, "num_env_steps_trained_lifetime": 409500, "learner_connector_sum_episodes_length_out": 5250.0, "learner_connector_sum_episodes_length_in": 5000.0, "num_module_steps_trained_lifetime": 78000, "num_non_trainable_parameters": 0, "num_module_steps_trained": 6000, "num_trainable_parameters": 6003, "num_env_steps_trained_lifetime_throughput": 1831190.526118926, "num_module_steps_trained_throughput": 349808.23503933556, "num_module_steps_trained_lifetime_throughput": 349454.5776565458}}, "num_training_step_calls_per_iteration": 1, "evaluation": {"env_runners": {"sample": 0.10673389540519167, "env_to_module_sum_episodes_length_in": 10.368238394574323, "num_module_steps_sampled": {"default_policy": 400}, "module_to_env_connector": {"timers": {"connectors": {"tensor_to_numpy": 1.312264427685593e-05, "remove_single_ts_time_rank_from_batch": 5.886412654046949e-07, "listify_data_for_vector_env": 1.101213873871895e-05, "normalize_and_clip_actions": 9.834102191632878e-06, "get_actions": 3.705888815816976e-05, "un_batch_to_individual_items": 5.59657801193528e-06}}, "connector_pipeline_timer": 0.00010339742628874237}, "rlmodule_inference_timer": 2.8681932617331085e-05, "env_to_module_connector": {"timers": {"connectors": {"add_time_dim_to_batch_and_zero_pad": 2.2416750458945185e-06, "numpy_to_tensor": 8.479918290725867e-06, "add_states_from_episodes_to_batch": 1.6388488742073102e-06, "batch_individual_items": 6.500018061863376e-06, "add_observations_from_episodes_to_batch": 2.91575827809731e-06}}, "connector_pipeline_timer": 4.354496191988768e-05}, "episode_len_max": 20, "num_agent_steps_sampled_lifetime": {"default_agent": 5200}, "num_episodes_lifetime": 260, "episode_return_min": -16.5, "env_step_timer": 1.4768460647982744e-05, "env_to_module_sum_episodes_length_out": 10.368238394574323, "num_env_steps_sampled": 400, "episode_len_mean": 20.0, "num_agent_steps_sampled": {"default_agent": 400}, "num_env_steps_sampled_lifetime": 65400, "weights_seq_no": 13.0, "module_episode_returns_mean": {"default_policy": -0.25}, "num_module_steps_sampled_lifetime": {"default_policy": 5200}, "num_episodes": 20, "episode_len_min": 20, "env_reset_timer": 0.000510121862180182, "episode_return_max": 12.5, "agent_episode_returns_mean": {"default_agent": -0.25}, "episode_return_mean": -0.25, "episode_duration_sec_mean": 0.004734279591357336, "time_between_sampling": 1.7477863435771748}, "num_healthy_workers": 1, "actor_manager_num_outstanding_async_reqs": 0, "num_remote_worker_restarts": 0}, "num_env_steps_sampled_lifetime": -6782500.0, "fault_tolerance": {"num_healthy_workers": 0, "num_remote_worker_restarts": 0}, "env_runner_group": {"actor_manager_num_outstanding_async_reqs": 0}, "done": false, "training_iteration": 13, "trial_id": "4da5b_00000", "date": "2025-08-11_19-21-58", "timestamp": 1754932918, "time_this_iter_s": 1.901170015335083, "time_total_s": 23.372381448745728, "pid": 14327, "hostname": "Mac", "node_ip": "127.0.0.1", "config": {"exploration_config": {}, "extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "placement_strategy": "PACK", "num_gpus": 0, "_fake_gpus": false, "num_cpus_for_main_process": 2, "eager_tracing": true, "eager_max_retraces": 20, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "torch_compile_learner": false, "torch_compile_learner_what_to_compile": "forward_train", "torch_compile_learner_dynamo_backend": "aot_eager", "torch_compile_learner_dynamo_mode": null, "torch_compile_worker": false, "torch_compile_worker_dynamo_backend": "aot_eager", "torch_compile_worker_dynamo_mode": null, "torch_ddp_kwargs": {}, "torch_skip_nan_gradients": false, "env": "Umbrella", "env_config": {}, "observation_space": null, "action_space": null, "clip_rewards": null, "normalize_actions": true, "clip_actions": false, "_is_atari": null, "disable_env_checking": false, "render_env": false, "action_mask_key": "action_mask", "env_runner_cls": null, "num_env_runners": 0, "create_local_env_runner": true, "num_envs_per_env_runner": 1, "gym_env_vectorize_mode": "SYNC", "num_cpus_per_env_runner": 1, "num_gpus_per_env_runner": 0, "custom_resources_per_env_runner": {}, "validate_env_runners_after_construction": true, "episodes_to_numpy": true, "max_requests_in_flight_per_env_runner": 1, "sample_timeout_s": 60.0, "_env_to_module_connector": null, "add_default_connectors_to_env_to_module_pipeline": true, "_module_to_env_connector": null, "add_default_connectors_to_module_to_env_pipeline": true, "merge_env_runner_states": "training_only", "broadcast_env_runner_states": true, "episode_lookback_horizon": 1, "rollout_fragment_length": "auto", "batch_mode": "complete_episodes", "compress_observations": false, "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "enable_tf1_exec_eagerly": false, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "preprocessor_pref": "deepmind", "observation_filter": "NoFilter", "update_worker_filter_stats": true, "use_worker_filter_stats": true, "sampler_perf_stats_ema_coef": null, "_is_online": true, "num_learners": 0, "num_gpus_per_learner": 0, "num_cpus_per_learner": "auto", "num_aggregator_actors_per_learner": 0, "max_requests_in_flight_per_aggregator_actor": 3, "local_gpu_idx": 0, "max_requests_in_flight_per_learner": 3, "gamma": 1, "lr": 0.0002847858517, "grad_clip": 0.5, "grad_clip_by": "global_norm", "_train_batch_size_per_learner": 5000, "train_batch_size": 4000, "num_epochs": 1, "minibatch_size": 1000, "shuffle_batch_per_epoch": true, "model": {"fcnet_hiddens": [256, 256], "fcnet_activation": "tanh", "fcnet_weights_initializer": null, "fcnet_weights_initializer_config": null, "fcnet_bias_initializer": null, "fcnet_bias_initializer_config": null, "conv_filters": null, "conv_activation": "relu", "conv_kernel_initializer": null, "conv_kernel_initializer_config": null, "conv_bias_initializer": null, "conv_bias_initializer_config": null, "conv_transpose_kernel_initializer": null, "conv_transpose_kernel_initializer_config": null, "conv_transpose_bias_initializer": null, "conv_transpose_bias_initializer_config": null, "post_fcnet_hiddens": [], "post_fcnet_activation": "relu", "post_fcnet_weights_initializer": null, "post_fcnet_weights_initializer_config": null, "post_fcnet_bias_initializer": null, "post_fcnet_bias_initializer_config": null, "free_log_std": false, "log_std_clip_param": 20.0, "no_final_linear": false, "vf_share_layers": false, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "lstm_weights_initializer": null, "lstm_weights_initializer_config": null, "lstm_bias_initializer": null, "lstm_bias_initializer_config": null, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "attention_use_n_prev_actions": 0, "attention_use_n_prev_rewards": 0, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": null, "custom_model_config": {}, "custom_action_dist": null, "custom_preprocessor": null, "encoder_latent_dim": null, "always_check_shapes": false, "lstm_use_prev_action_reward": -1, "_use_default_native_models": -1, "_disable_preprocessor_api": false, "_disable_action_flattening": false}, "_learner_connector": null, "add_default_connectors_to_learner_pipeline": true, "learner_config_dict": {}, "optimizer": {}, "_learner_class": null, "callbacks_on_algorithm_init": null, "callbacks_on_env_runners_recreated": null, "callbacks_on_offline_eval_runners_recreated": null, "callbacks_on_checkpoint_loaded": null, "callbacks_on_environment_created": null, "callbacks_on_episode_created": null, "callbacks_on_episode_start": null, "callbacks_on_episode_step": null, "callbacks_on_episode_end": null, "callbacks_on_evaluate_start": null, "callbacks_on_evaluate_end": null, "callbacks_on_evaluate_offline_start": null, "callbacks_on_evaluate_offline_end": null, "callbacks_on_sample_end": null, "callbacks_on_train_result": null, "explore": true, "enable_rl_module_and_learner": true, "enable_env_runner_and_connector_v2": true, "_prior_exploration_config": {"type": "StochasticSampling"}, "count_steps_by": "env_steps", "policy_map_capacity": 100, "policy_mapping_fn": "<function AlgorithmConfig.DEFAULT_POLICY_MAPPING_FN at 0x383de9b20>", "policies_to_train": null, "policy_states_are_swappable": false, "observation_fn": null, "offline_data_class": null, "input_read_method": "read_parquet", "input_read_method_kwargs": {}, "input_read_schema": {}, "input_read_episodes": false, "input_read_sample_batches": false, "input_read_batch_size": null, "input_filesystem": null, "input_filesystem_kwargs": {}, "input_compress_columns": ["obs", "new_obs"], "input_spaces_jsonable": true, "materialize_data": false, "materialize_mapped_data": true, "map_batches_kwargs": {}, "iter_batches_kwargs": {}, "ignore_final_observation": false, "prelearner_class": null, "prelearner_buffer_class": null, "prelearner_buffer_kwargs": {}, "prelearner_module_synch_period": 10, "dataset_num_iters_per_learner": null, "input_config": {}, "actions_in_input_normalized": false, "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_config": {}, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "output_max_rows_per_file": null, "output_write_remaining_data": false, "output_write_method": "write_parquet", "output_write_method_kwargs": {}, "output_filesystem": null, "output_filesystem_kwargs": {}, "output_write_episodes": true, "offline_sampling": false, "evaluation_interval": 1, "evaluation_duration": 20, "evaluation_duration_unit": "episodes", "evaluation_sample_timeout_s": 120.0, "evaluation_auto_duration_min_env_steps_per_sample": 100, "evaluation_auto_duration_max_env_steps_per_sample": 2000, "evaluation_parallel_to_training": false, "evaluation_force_reset_envs_before_iteration": true, "evaluation_config": null, "off_policy_estimation_methods": {}, "ope_split_batch_by_episode": true, "evaluation_num_env_runners": 1, "in_evaluation": false, "sync_filters_on_rollout_workers_timeout_s": 10.0, "offline_evaluation_interval": null, "num_offline_eval_runners": 0, "offline_loss_for_module_fn": null, "offline_evaluation_duration": 1, "offline_evaluation_parallel_to_training": false, "offline_evaluation_timeout_s": 120.0, "num_cpus_per_offline_eval_runner": 1, "num_gpus_per_offline_eval_runner": 0, "custom_resources_per_offline_eval_runner": {}, "restart_failed_offline_eval_runners": true, "ignore_offline_eval_runner_failures": false, "max_num_offline_eval_runner_restarts": 1000, "offline_eval_runner_restore_timeout_s": 1800.0, "max_requests_in_flight_per_offline_eval_runner": 1, "validate_offline_eval_runners_after_construction": true, "offline_eval_runner_health_probe_timeout_s": 30.0, "offline_eval_rl_module_inference_only": false, "broadcast_offline_eval_runner_states": false, "offline_eval_batch_size_per_runner": 256, "dataset_num_iters_per_eval_runner": 1, "keep_per_episode_custom_metrics": false, "metrics_episode_collection_timeout_s": 60.0, "metrics_num_episodes_for_smoothing": 100, "min_time_s_per_iteration": null, "min_train_timesteps_per_iteration": 0, "min_sample_timesteps_per_iteration": 0, "log_gradients": true, "export_native_model_files": false, "checkpoint_trainable_policies_only": false, "logger_creator": null, "logger_config": null, "log_level": "WARN", "log_sys_usage": true, "fake_sampler": false, "seed": 4, "restart_failed_env_runners": true, "ignore_env_runner_failures": false, "max_num_env_runner_restarts": 1000, "delay_between_env_runner_restarts_s": 60.0, "restart_failed_sub_environments": false, "num_consecutive_env_runner_failures_tolerance": 100, "env_runner_health_probe_timeout_s": 30.0, "env_runner_restore_timeout_s": 1800.0, "_model_config": {}, "_rl_module_spec": "RLModuleSpec(module_class=None, observation_space=None, action_space=None, inference_only=False, learner_only=False, model_config=DefaultModelConfig(fcnet_hiddens=[60, 90], fcnet_activation='tanh', fcnet_kernel_initializer=None, fcnet_kernel_initializer_kwargs=None, fcnet_bias_initializer=None, fcnet_bias_initializer_kwargs=None, conv_filters=None, conv_activation='relu', conv_kernel_initializer=None, conv_kernel_initializer_kwargs=None, conv_bias_initializer=None, conv_bias_initializer_kwargs=None, head_fcnet_hiddens=[], head_fcnet_activation='relu', head_fcnet_kernel_initializer=None, head_fcnet_kernel_initializer_kwargs=None, head_fcnet_bias_initializer=None, head_fcnet_bias_initializer_kwargs=None, free_log_std=False, log_std_clip_param=20.0, vf_share_layers=True, use_lstm=False, max_seq_len=20, lstm_cell_size=256, lstm_use_prev_action=False, lstm_use_prev_reward=False, lstm_kernel_initializer=None, lstm_kernel_initializer_kwargs=None, lstm_bias_initializer=None, lstm_bias_initializer_kwargs=None), catalog_class=None, load_state_path=None, model_config_dict=None)", "algorithm_config_overrides_per_module": {}, "_per_module_overrides": {}, "_validate_config": true, "_use_msgpack_checkpoints": false, "_torch_grad_scaler_class": null, "_torch_lr_scheduler_classes": null, "_tf_policy_handles_more_than_one_loss": false, "_disable_preprocessor_api": false, "_disable_action_flattening": false, "_disable_initialize_loss_from_dummy_batch": false, "_dont_auto_sync_env_runner_states": false, "env_task_fn": -1, "enable_connectors": -1, "simple_optimizer": false, "policy_map_cache": -1, "worker_cls": -1, "synchronize_filters": -1, "enable_async_evaluation": -1, "custom_async_evaluation_function": -1, "_enable_rl_module_api": -1, "auto_wrap_old_gym_envs": -1, "always_attach_evaluation_results": -1, "replay_sequence_length": null, "_disable_execution_plan_api": -1, "use_critic": true, "use_gae": true, "use_kl_loss": true, "kl_coeff": 0.7464963036515, "kl_target": 0.0270990929592, "vf_loss_coeff": 0.6688075857018, "entropy_coeff": 0.0090570820258, "clip_param": 0.1221781641624, "vf_clip_param": 0.1027808522125, "entropy_coeff_schedule": null, "lr_schedule": null, "sgd_minibatch_size": -1, "vf_share_layers": -1, "__stdout_file__": null, "__stderr_file__": null, "lambda": 0.9099046732075, "input": "sampler", "policies": {"default_policy": [null, null, null, null]}, "callbacks": "<class 'ray.rllib.callbacks.callbacks.RLlibCallback'>", "create_env_on_driver": false, "custom_eval_function": null, "framework": "torch"}, "time_since_restore": 23.372381448745728, "iterations_since_restore": 13, "perf": {"cpu_util_percent": 51.53333333333333, "ram_util_percent": 83.43333333333334}}
{"timers": {"training_iteration": 1.874500467436596, "restore_env_runners": 7.18456790269376e-05, "training_step": 1.874181830686652, "env_runner_sampling_timer": 1.7571575268735409, "learner_update_timer": 0.11352699519274703, "synch_weights": 0.0006358025429234309, "restore_eval_env_runners": 8.677761588645369e-06, "evaluation_iteration": 0.11828299421885033, "synch_eval_env_connectors": 0.00013136325296390992, "synch_env_connectors": 4.6369995186899735e-06}, "env_runners": {"env_to_module_connector": {"connector_pipeline_timer": 4.457324851997943e-05, "timers": {"connectors": {"add_time_dim_to_batch_and_zero_pad": 2.4825087798265662e-06, "batch_individual_items": 6.47554635304629e-06, "numpy_to_tensor": 8.907529864847461e-06, "add_observations_from_episodes_to_batch": 2.968187855186488e-06, "add_states_from_episodes_to_batch": 1.7523097166045198e-06}}}, "env_step_timer": 1.421321359746053e-05, "num_agent_steps_sampled_lifetime": {"default_agent": -7400000.0}, "env_to_module_sum_episodes_length_out": 10.36823839457432, "module_to_env_connector": {"timers": {"connectors": {"normalize_and_clip_actions": 9.743628291302057e-06, "tensor_to_numpy": 1.3637100175318461e-05, "remove_single_ts_time_rank_from_batch": 6.030022575647455e-07, "un_batch_to_individual_items": 5.525084018395528e-06, "get_actions": 4.0934715675885706e-05, "listify_data_for_vector_env": 1.13515298652253e-05}}, "connector_pipeline_timer": 0.00010784368478913103}, "num_agent_steps_sampled": {"default_agent": 5000.0}, "module_episode_returns_mean": {"default_policy": 10.42}, "env_reset_timer": 4.345202998473166e-05, "episode_return_max": 12.5, "sample": 0.0053604048368337655, "env_to_module_sum_episodes_length_in": 10.36823839457432, "num_module_steps_sampled_lifetime": {"default_policy": -7400000.0}, "episode_return_mean": 10.42, "episode_duration_sec_mean": 0.004691371660213918, "num_env_steps_sampled": 5000.0, "num_episodes": 250.0, "episode_len_mean": 20.0, "rlmodule_inference_timer": 2.9244714871817287e-05, "episode_len_min": 20, "episode_len_max": 20, "agent_episode_returns_mean": {"default_agent": 10.42}, "num_module_steps_sampled": {"default_policy": 5000.0}, "num_episodes_lifetime": -370000.0, "num_env_steps_sampled_lifetime": -7400000.0, "weights_seq_no": 13.0, "episode_return_min": -7.5, "time_between_sampling": 0.0019893687174504693, "num_env_steps_sampled_lifetime_throughput": 3588.458258993332}, "learners": {"default_policy": {"curr_kl_coeff": 4.5562519517261535e-05, "gradients_default_optimizer_global_norm": 0.06715603172779083, "vf_loss": 0.10234943777322769, "total_loss": -0.04048038646578789, "num_module_steps_trained": 6000, "diff_num_grad_updates_vs_sampler_policy": 1.0, "module_train_batch_size_mean": 1000.0, "entropy": 0.42842739820480347, "num_module_steps_trained_lifetime": 84000, "curr_entropy_coeff": 0.0090570820258, "vf_loss_unclipped": 28.65528678894043, "weights_seq_no": 14.0, "default_optimizer_learning_rate": 0.0002847858517, "vf_explained_var": 0.01694488525390625, "mean_kl_loss": 0.0003316231013741344, "num_trainable_parameters": 6003, "policy_loss": -0.10505218803882599, "num_module_steps_trained_lifetime_throughput": 349925.38669074903}, "__all_modules__": {"learner_connector": {"timers": {"connectors": {"numpy_to_tensor": 6.304774071008009e-05, "batch_individual_items": 0.03434538845415909, "add_columns_from_episodes_to_train_batch": 0.034282229748359185, "add_time_dim_to_batch_and_zero_pad": 1.0118406995117033e-05, "add_one_ts_to_episodes_and_truncate": 0.008609644667675038, "add_observations_from_episodes_to_batch": 0.0008179912095948555, "general_advantage_estimation": 0.006743160663109653, "add_states_from_episodes_to_batch": 3.530565948227828e-06}}, "connector_pipeline_timer": 0.08498260953831278}, "num_env_steps_trained": 31500, "num_env_steps_trained_lifetime": 441000, "learner_connector_sum_episodes_length_out": 5250.0, "learner_connector_sum_episodes_length_in": 5000.0, "num_module_steps_trained_lifetime": 84000, "num_non_trainable_parameters": 0, "num_module_steps_trained": 6000, "num_trainable_parameters": 6003, "num_env_steps_trained_lifetime_throughput": 1830838.156932705, "num_module_steps_trained_throughput": 349698.47067272954, "num_module_steps_trained_lifetime_throughput": 349356.0584618008}}, "num_training_step_calls_per_iteration": 1, "evaluation": {"env_runners": {"sample": 0.10665246062064149, "env_to_module_sum_episodes_length_in": 10.368238394574323, "num_module_steps_sampled": {"default_policy": 400}, "module_to_env_connector": {"timers": {"connectors": {"tensor_to_numpy": 1.265019077366072e-05, "remove_single_ts_time_rank_from_batch": 5.949632830854511e-07, "listify_data_for_vector_env": 1.0836895064693774e-05, "normalize_and_clip_actions": 9.344299464746402e-06, "get_actions": 3.5314178732683657e-05, "un_batch_to_individual_items": 5.340495793283054e-06}}, "connector_pipeline_timer": 9.973636422881446e-05}, "rlmodule_inference_timer": 2.767269235027824e-05, "env_to_module_connector": {"timers": {"connectors": {"add_time_dim_to_batch_and_zero_pad": 2.217201327481175e-06, "numpy_to_tensor": 8.377356603334474e-06, "add_states_from_episodes_to_batch": 1.6144174318468256e-06, "batch_individual_items": 6.236103673083747e-06, "add_observations_from_episodes_to_batch": 2.787287177798077e-06}}, "connector_pipeline_timer": 4.2829812064688706e-05}, "episode_len_max": 20, "num_agent_steps_sampled_lifetime": {"default_agent": 5600}, "num_episodes_lifetime": 280, "episode_return_min": -16.5, "env_step_timer": 1.3953517920507278e-05, "env_to_module_sum_episodes_length_out": 10.368238394574323, "num_env_steps_sampled": 400, "episode_len_mean": 20.0, "num_agent_steps_sampled": {"default_agent": 400}, "num_env_steps_sampled_lifetime": 70400, "weights_seq_no": 14.0, "module_episode_returns_mean": {"default_policy": 1.55}, "num_module_steps_sampled_lifetime": {"default_policy": 5600}, "num_episodes": 20, "episode_len_min": 20, "env_reset_timer": 0.0005058152235318244, "episode_return_max": 12.5, "agent_episode_returns_mean": {"default_agent": 1.55}, "episode_return_mean": 1.55, "episode_duration_sec_mean": 0.004634641644079238, "time_between_sampling": 1.746654191810822}, "num_healthy_workers": 1, "actor_manager_num_outstanding_async_reqs": 0, "num_remote_worker_restarts": 0}, "num_env_steps_sampled_lifetime": -7400000.0, "fault_tolerance": {"num_healthy_workers": 0, "num_remote_worker_restarts": 0}, "env_runner_group": {"actor_manager_num_outstanding_async_reqs": 0}, "done": false, "training_iteration": 14, "trial_id": "4da5b_00000", "date": "2025-08-11_19-22-00", "timestamp": 1754932920, "time_this_iter_s": 1.722505807876587, "time_total_s": 25.094887256622314, "pid": 14327, "hostname": "Mac", "node_ip": "127.0.0.1", "config": {"exploration_config": {}, "extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "placement_strategy": "PACK", "num_gpus": 0, "_fake_gpus": false, "num_cpus_for_main_process": 2, "eager_tracing": true, "eager_max_retraces": 20, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "torch_compile_learner": false, "torch_compile_learner_what_to_compile": "forward_train", "torch_compile_learner_dynamo_backend": "aot_eager", "torch_compile_learner_dynamo_mode": null, "torch_compile_worker": false, "torch_compile_worker_dynamo_backend": "aot_eager", "torch_compile_worker_dynamo_mode": null, "torch_ddp_kwargs": {}, "torch_skip_nan_gradients": false, "env": "Umbrella", "env_config": {}, "observation_space": null, "action_space": null, "clip_rewards": null, "normalize_actions": true, "clip_actions": false, "_is_atari": null, "disable_env_checking": false, "render_env": false, "action_mask_key": "action_mask", "env_runner_cls": null, "num_env_runners": 0, "create_local_env_runner": true, "num_envs_per_env_runner": 1, "gym_env_vectorize_mode": "SYNC", "num_cpus_per_env_runner": 1, "num_gpus_per_env_runner": 0, "custom_resources_per_env_runner": {}, "validate_env_runners_after_construction": true, "episodes_to_numpy": true, "max_requests_in_flight_per_env_runner": 1, "sample_timeout_s": 60.0, "_env_to_module_connector": null, "add_default_connectors_to_env_to_module_pipeline": true, "_module_to_env_connector": null, "add_default_connectors_to_module_to_env_pipeline": true, "merge_env_runner_states": "training_only", "broadcast_env_runner_states": true, "episode_lookback_horizon": 1, "rollout_fragment_length": "auto", "batch_mode": "complete_episodes", "compress_observations": false, "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "enable_tf1_exec_eagerly": false, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "preprocessor_pref": "deepmind", "observation_filter": "NoFilter", "update_worker_filter_stats": true, "use_worker_filter_stats": true, "sampler_perf_stats_ema_coef": null, "_is_online": true, "num_learners": 0, "num_gpus_per_learner": 0, "num_cpus_per_learner": "auto", "num_aggregator_actors_per_learner": 0, "max_requests_in_flight_per_aggregator_actor": 3, "local_gpu_idx": 0, "max_requests_in_flight_per_learner": 3, "gamma": 1, "lr": 0.0002847858517, "grad_clip": 0.5, "grad_clip_by": "global_norm", "_train_batch_size_per_learner": 5000, "train_batch_size": 4000, "num_epochs": 1, "minibatch_size": 1000, "shuffle_batch_per_epoch": true, "model": {"fcnet_hiddens": [256, 256], "fcnet_activation": "tanh", "fcnet_weights_initializer": null, "fcnet_weights_initializer_config": null, "fcnet_bias_initializer": null, "fcnet_bias_initializer_config": null, "conv_filters": null, "conv_activation": "relu", "conv_kernel_initializer": null, "conv_kernel_initializer_config": null, "conv_bias_initializer": null, "conv_bias_initializer_config": null, "conv_transpose_kernel_initializer": null, "conv_transpose_kernel_initializer_config": null, "conv_transpose_bias_initializer": null, "conv_transpose_bias_initializer_config": null, "post_fcnet_hiddens": [], "post_fcnet_activation": "relu", "post_fcnet_weights_initializer": null, "post_fcnet_weights_initializer_config": null, "post_fcnet_bias_initializer": null, "post_fcnet_bias_initializer_config": null, "free_log_std": false, "log_std_clip_param": 20.0, "no_final_linear": false, "vf_share_layers": false, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "lstm_weights_initializer": null, "lstm_weights_initializer_config": null, "lstm_bias_initializer": null, "lstm_bias_initializer_config": null, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "attention_use_n_prev_actions": 0, "attention_use_n_prev_rewards": 0, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": null, "custom_model_config": {}, "custom_action_dist": null, "custom_preprocessor": null, "encoder_latent_dim": null, "always_check_shapes": false, "lstm_use_prev_action_reward": -1, "_use_default_native_models": -1, "_disable_preprocessor_api": false, "_disable_action_flattening": false}, "_learner_connector": null, "add_default_connectors_to_learner_pipeline": true, "learner_config_dict": {}, "optimizer": {}, "_learner_class": null, "callbacks_on_algorithm_init": null, "callbacks_on_env_runners_recreated": null, "callbacks_on_offline_eval_runners_recreated": null, "callbacks_on_checkpoint_loaded": null, "callbacks_on_environment_created": null, "callbacks_on_episode_created": null, "callbacks_on_episode_start": null, "callbacks_on_episode_step": null, "callbacks_on_episode_end": null, "callbacks_on_evaluate_start": null, "callbacks_on_evaluate_end": null, "callbacks_on_evaluate_offline_start": null, "callbacks_on_evaluate_offline_end": null, "callbacks_on_sample_end": null, "callbacks_on_train_result": null, "explore": true, "enable_rl_module_and_learner": true, "enable_env_runner_and_connector_v2": true, "_prior_exploration_config": {"type": "StochasticSampling"}, "count_steps_by": "env_steps", "policy_map_capacity": 100, "policy_mapping_fn": "<function AlgorithmConfig.DEFAULT_POLICY_MAPPING_FN at 0x383de9b20>", "policies_to_train": null, "policy_states_are_swappable": false, "observation_fn": null, "offline_data_class": null, "input_read_method": "read_parquet", "input_read_method_kwargs": {}, "input_read_schema": {}, "input_read_episodes": false, "input_read_sample_batches": false, "input_read_batch_size": null, "input_filesystem": null, "input_filesystem_kwargs": {}, "input_compress_columns": ["obs", "new_obs"], "input_spaces_jsonable": true, "materialize_data": false, "materialize_mapped_data": true, "map_batches_kwargs": {}, "iter_batches_kwargs": {}, "ignore_final_observation": false, "prelearner_class": null, "prelearner_buffer_class": null, "prelearner_buffer_kwargs": {}, "prelearner_module_synch_period": 10, "dataset_num_iters_per_learner": null, "input_config": {}, "actions_in_input_normalized": false, "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_config": {}, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "output_max_rows_per_file": null, "output_write_remaining_data": false, "output_write_method": "write_parquet", "output_write_method_kwargs": {}, "output_filesystem": null, "output_filesystem_kwargs": {}, "output_write_episodes": true, "offline_sampling": false, "evaluation_interval": 1, "evaluation_duration": 20, "evaluation_duration_unit": "episodes", "evaluation_sample_timeout_s": 120.0, "evaluation_auto_duration_min_env_steps_per_sample": 100, "evaluation_auto_duration_max_env_steps_per_sample": 2000, "evaluation_parallel_to_training": false, "evaluation_force_reset_envs_before_iteration": true, "evaluation_config": null, "off_policy_estimation_methods": {}, "ope_split_batch_by_episode": true, "evaluation_num_env_runners": 1, "in_evaluation": false, "sync_filters_on_rollout_workers_timeout_s": 10.0, "offline_evaluation_interval": null, "num_offline_eval_runners": 0, "offline_loss_for_module_fn": null, "offline_evaluation_duration": 1, "offline_evaluation_parallel_to_training": false, "offline_evaluation_timeout_s": 120.0, "num_cpus_per_offline_eval_runner": 1, "num_gpus_per_offline_eval_runner": 0, "custom_resources_per_offline_eval_runner": {}, "restart_failed_offline_eval_runners": true, "ignore_offline_eval_runner_failures": false, "max_num_offline_eval_runner_restarts": 1000, "offline_eval_runner_restore_timeout_s": 1800.0, "max_requests_in_flight_per_offline_eval_runner": 1, "validate_offline_eval_runners_after_construction": true, "offline_eval_runner_health_probe_timeout_s": 30.0, "offline_eval_rl_module_inference_only": false, "broadcast_offline_eval_runner_states": false, "offline_eval_batch_size_per_runner": 256, "dataset_num_iters_per_eval_runner": 1, "keep_per_episode_custom_metrics": false, "metrics_episode_collection_timeout_s": 60.0, "metrics_num_episodes_for_smoothing": 100, "min_time_s_per_iteration": null, "min_train_timesteps_per_iteration": 0, "min_sample_timesteps_per_iteration": 0, "log_gradients": true, "export_native_model_files": false, "checkpoint_trainable_policies_only": false, "logger_creator": null, "logger_config": null, "log_level": "WARN", "log_sys_usage": true, "fake_sampler": false, "seed": 4, "restart_failed_env_runners": true, "ignore_env_runner_failures": false, "max_num_env_runner_restarts": 1000, "delay_between_env_runner_restarts_s": 60.0, "restart_failed_sub_environments": false, "num_consecutive_env_runner_failures_tolerance": 100, "env_runner_health_probe_timeout_s": 30.0, "env_runner_restore_timeout_s": 1800.0, "_model_config": {}, "_rl_module_spec": "RLModuleSpec(module_class=None, observation_space=None, action_space=None, inference_only=False, learner_only=False, model_config=DefaultModelConfig(fcnet_hiddens=[60, 90], fcnet_activation='tanh', fcnet_kernel_initializer=None, fcnet_kernel_initializer_kwargs=None, fcnet_bias_initializer=None, fcnet_bias_initializer_kwargs=None, conv_filters=None, conv_activation='relu', conv_kernel_initializer=None, conv_kernel_initializer_kwargs=None, conv_bias_initializer=None, conv_bias_initializer_kwargs=None, head_fcnet_hiddens=[], head_fcnet_activation='relu', head_fcnet_kernel_initializer=None, head_fcnet_kernel_initializer_kwargs=None, head_fcnet_bias_initializer=None, head_fcnet_bias_initializer_kwargs=None, free_log_std=False, log_std_clip_param=20.0, vf_share_layers=True, use_lstm=False, max_seq_len=20, lstm_cell_size=256, lstm_use_prev_action=False, lstm_use_prev_reward=False, lstm_kernel_initializer=None, lstm_kernel_initializer_kwargs=None, lstm_bias_initializer=None, lstm_bias_initializer_kwargs=None), catalog_class=None, load_state_path=None, model_config_dict=None)", "algorithm_config_overrides_per_module": {}, "_per_module_overrides": {}, "_validate_config": true, "_use_msgpack_checkpoints": false, "_torch_grad_scaler_class": null, "_torch_lr_scheduler_classes": null, "_tf_policy_handles_more_than_one_loss": false, "_disable_preprocessor_api": false, "_disable_action_flattening": false, "_disable_initialize_loss_from_dummy_batch": false, "_dont_auto_sync_env_runner_states": false, "env_task_fn": -1, "enable_connectors": -1, "simple_optimizer": false, "policy_map_cache": -1, "worker_cls": -1, "synchronize_filters": -1, "enable_async_evaluation": -1, "custom_async_evaluation_function": -1, "_enable_rl_module_api": -1, "auto_wrap_old_gym_envs": -1, "always_attach_evaluation_results": -1, "replay_sequence_length": null, "_disable_execution_plan_api": -1, "use_critic": true, "use_gae": true, "use_kl_loss": true, "kl_coeff": 0.7464963036515, "kl_target": 0.0270990929592, "vf_loss_coeff": 0.6688075857018, "entropy_coeff": 0.0090570820258, "clip_param": 0.1221781641624, "vf_clip_param": 0.1027808522125, "entropy_coeff_schedule": null, "lr_schedule": null, "sgd_minibatch_size": -1, "vf_share_layers": -1, "__stdout_file__": null, "__stderr_file__": null, "lambda": 0.9099046732075, "input": "sampler", "policies": {"default_policy": [null, null, null, null]}, "callbacks": "<class 'ray.rllib.callbacks.callbacks.RLlibCallback'>", "create_env_on_driver": false, "custom_eval_function": null, "framework": "torch"}, "time_since_restore": 25.094887256622314, "iterations_since_restore": 14, "perf": {"cpu_util_percent": 46.55, "ram_util_percent": 81.0}}
{"timers": {"training_iteration": 1.8713488627625916, "restore_env_runners": 7.119972220664238e-05, "training_step": 1.8710313507101994, "env_runner_sampling_timer": 1.7532485611954887, "learner_update_timer": 0.11429118774140666, "synch_weights": 0.0006347749282801697, "restore_eval_env_runners": 8.650983265475299e-06, "evaluation_iteration": 0.11814220219605837, "synch_eval_env_connectors": 0.00013109379020109926, "synch_env_connectors": 4.636048961313852e-06}, "env_runners": {"env_to_module_connector": {"connector_pipeline_timer": 4.3341642723440446e-05, "timers": {"connectors": {"add_time_dim_to_batch_and_zero_pad": 2.380453639566397e-06, "batch_individual_items": 6.257740212660774e-06, "numpy_to_tensor": 8.452875577339373e-06, "add_observations_from_episodes_to_batch": 2.9754995831059782e-06, "add_states_from_episodes_to_batch": 1.728288573856991e-06}}}, "env_step_timer": 1.3679757233002573e-05, "num_agent_steps_sampled_lifetime": {"default_agent": -8017500.0}, "env_to_module_sum_episodes_length_out": 10.36823839457432, "module_to_env_connector": {"timers": {"connectors": {"normalize_and_clip_actions": 9.417309264184377e-06, "tensor_to_numpy": 1.3050044960152458e-05, "remove_single_ts_time_rank_from_batch": 5.749386796478723e-07, "un_batch_to_individual_items": 5.414017358996416e-06, "get_actions": 3.863195588622177e-05, "listify_data_for_vector_env": 1.0913458441280957e-05}}, "connector_pipeline_timer": 0.00010343694692891656}, "num_agent_steps_sampled": {"default_agent": 5000.0}, "module_episode_returns_mean": {"default_policy": 10.18}, "env_reset_timer": 3.3083453638164754e-05, "episode_return_max": 12.5, "sample": 0.004892867864858292, "env_to_module_sum_episodes_length_in": 10.36823839457432, "num_module_steps_sampled_lifetime": {"default_policy": -8017500.0}, "episode_return_mean": 10.18, "episode_duration_sec_mean": 0.00451786298956722, "num_env_steps_sampled": 5000.0, "num_episodes": 250.0, "episode_len_mean": 20.0, "rlmodule_inference_timer": 2.752501435479685e-05, "episode_len_min": 20, "episode_len_max": 20, "agent_episode_returns_mean": {"default_agent": 10.18}, "num_module_steps_sampled": {"default_policy": 5000.0}, "num_episodes_lifetime": -400875.0, "num_env_steps_sampled_lifetime": -8017500.0, "weights_seq_no": 14.0, "episode_return_min": -7.5, "time_between_sampling": 0.0019054140802002742, "num_env_steps_sampled_lifetime_throughput": 3759.814226961266}, "learners": {"default_policy": {"curr_kl_coeff": 2.2781259758630767e-05, "gradients_default_optimizer_global_norm": 0.008220300078392029, "vf_loss": 0.10213375091552734, "total_loss": 0.0381966270506382, "num_module_steps_trained": 6000, "diff_num_grad_updates_vs_sampler_policy": 1.0, "module_train_batch_size_mean": 1000.0, "entropy": 0.4188220798969269, "num_module_steps_trained_lifetime": 90000, "curr_entropy_coeff": 0.0090570820258, "vf_loss_unclipped": 28.625947952270508, "weights_seq_no": 15.0, "default_optimizer_learning_rate": 0.0002847858517, "vf_explained_var": 0.019069373607635498, "mean_kl_loss": 0.00024917605333030224, "num_trainable_parameters": 6003, "policy_loss": -0.02631792053580284, "num_module_steps_trained_lifetime_throughput": 350052.47578203847}, "__all_modules__": {"learner_connector": {"timers": {"connectors": {"numpy_to_tensor": 6.295643271694821e-05, "batch_individual_items": 0.035257502069519595, "add_columns_from_episodes_to_train_batch": 0.03428169787096078, "add_time_dim_to_batch_and_zero_pad": 1.0095552974457117e-05, "add_one_ts_to_episodes_and_truncate": 0.008600336140968516, "add_observations_from_episodes_to_batch": 0.0008178775475102318, "general_advantage_estimation": 0.006732961136040356, "add_states_from_episodes_to_batch": 3.520260479107884e-06}}, "connector_pipeline_timer": 0.08587420928264808}, "num_env_steps_trained": 31500, "num_env_steps_trained_lifetime": 472500, "learner_connector_sum_episodes_length_out": 5250.0, "learner_connector_sum_episodes_length_in": 5000.0, "num_module_steps_trained_lifetime": 90000, "num_non_trainable_parameters": 0, "num_module_steps_trained": 6000, "num_trainable_parameters": 6003, "num_env_steps_trained_lifetime_throughput": 1831955.558500803, "num_module_steps_trained_throughput": 349871.63282995817, "num_module_steps_trained_lifetime_throughput": 349539.5224647137}}, "num_training_step_calls_per_iteration": 1, "evaluation": {"env_runners": {"sample": 0.10656222392445132, "env_to_module_sum_episodes_length_in": 10.368238394574323, "num_module_steps_sampled": {"default_policy": 400}, "module_to_env_connector": {"timers": {"connectors": {"tensor_to_numpy": 1.2539491646101875e-05, "remove_single_ts_time_rank_from_batch": 5.762925042264394e-07, "listify_data_for_vector_env": 1.0690480362997324e-05, "normalize_and_clip_actions": 9.236144050231037e-06, "get_actions": 3.48907109865822e-05, "un_batch_to_individual_items": 5.245610734536881e-06}}, "connector_pipeline_timer": 9.867347492110274e-05}, "rlmodule_inference_timer": 2.7029054329511137e-05, "env_to_module_connector": {"timers": {"connectors": {"add_time_dim_to_batch_and_zero_pad": 2.173986439243349e-06, "numpy_to_tensor": 8.166150916633305e-06, "add_states_from_episodes_to_batch": 1.5934479637854141e-06, "batch_individual_items": 6.10399105066818e-06, "add_observations_from_episodes_to_batch": 2.7786742064831074e-06}}, "connector_pipeline_timer": 4.2395792184587605e-05}, "episode_len_max": 20, "num_agent_steps_sampled_lifetime": {"default_agent": 6000}, "num_episodes_lifetime": 300, "episode_return_min": -16.5, "env_step_timer": 1.3622868937055184e-05, "env_to_module_sum_episodes_length_out": 10.368238394574323, "num_env_steps_sampled": 400, "episode_len_mean": 20.0, "num_agent_steps_sampled": {"default_agent": 400}, "num_env_steps_sampled_lifetime": 75400, "weights_seq_no": 15.0, "module_episode_returns_mean": {"default_policy": 2.75}, "num_module_steps_sampled_lifetime": {"default_policy": 6000}, "num_episodes": 20, "episode_len_min": 20, "env_reset_timer": 0.0005014770709581753, "episode_return_max": 12.5, "agent_episode_returns_mean": {"default_agent": 2.75}, "episode_return_mean": 2.75, "episode_duration_sec_mean": 0.0046163033565972, "time_between_sampling": 1.7449797269728278}, "num_healthy_workers": 1, "actor_manager_num_outstanding_async_reqs": 0, "num_remote_worker_restarts": 0}, "num_env_steps_sampled_lifetime": -8017500.0, "fault_tolerance": {"num_healthy_workers": 0, "num_remote_worker_restarts": 0}, "env_runner_group": {"actor_manager_num_outstanding_async_reqs": 0}, "done": false, "training_iteration": 15, "trial_id": "4da5b_00000", "date": "2025-08-11_19-22-02", "timestamp": 1754932922, "time_this_iter_s": 1.6648800373077393, "time_total_s": 26.759767293930054, "pid": 14327, "hostname": "Mac", "node_ip": "127.0.0.1", "config": {"exploration_config": {}, "extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "placement_strategy": "PACK", "num_gpus": 0, "_fake_gpus": false, "num_cpus_for_main_process": 2, "eager_tracing": true, "eager_max_retraces": 20, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "torch_compile_learner": false, "torch_compile_learner_what_to_compile": "forward_train", "torch_compile_learner_dynamo_backend": "aot_eager", "torch_compile_learner_dynamo_mode": null, "torch_compile_worker": false, "torch_compile_worker_dynamo_backend": "aot_eager", "torch_compile_worker_dynamo_mode": null, "torch_ddp_kwargs": {}, "torch_skip_nan_gradients": false, "env": "Umbrella", "env_config": {}, "observation_space": null, "action_space": null, "clip_rewards": null, "normalize_actions": true, "clip_actions": false, "_is_atari": null, "disable_env_checking": false, "render_env": false, "action_mask_key": "action_mask", "env_runner_cls": null, "num_env_runners": 0, "create_local_env_runner": true, "num_envs_per_env_runner": 1, "gym_env_vectorize_mode": "SYNC", "num_cpus_per_env_runner": 1, "num_gpus_per_env_runner": 0, "custom_resources_per_env_runner": {}, "validate_env_runners_after_construction": true, "episodes_to_numpy": true, "max_requests_in_flight_per_env_runner": 1, "sample_timeout_s": 60.0, "_env_to_module_connector": null, "add_default_connectors_to_env_to_module_pipeline": true, "_module_to_env_connector": null, "add_default_connectors_to_module_to_env_pipeline": true, "merge_env_runner_states": "training_only", "broadcast_env_runner_states": true, "episode_lookback_horizon": 1, "rollout_fragment_length": "auto", "batch_mode": "complete_episodes", "compress_observations": false, "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "enable_tf1_exec_eagerly": false, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "preprocessor_pref": "deepmind", "observation_filter": "NoFilter", "update_worker_filter_stats": true, "use_worker_filter_stats": true, "sampler_perf_stats_ema_coef": null, "_is_online": true, "num_learners": 0, "num_gpus_per_learner": 0, "num_cpus_per_learner": "auto", "num_aggregator_actors_per_learner": 0, "max_requests_in_flight_per_aggregator_actor": 3, "local_gpu_idx": 0, "max_requests_in_flight_per_learner": 3, "gamma": 1, "lr": 0.0002847858517, "grad_clip": 0.5, "grad_clip_by": "global_norm", "_train_batch_size_per_learner": 5000, "train_batch_size": 4000, "num_epochs": 1, "minibatch_size": 1000, "shuffle_batch_per_epoch": true, "model": {"fcnet_hiddens": [256, 256], "fcnet_activation": "tanh", "fcnet_weights_initializer": null, "fcnet_weights_initializer_config": null, "fcnet_bias_initializer": null, "fcnet_bias_initializer_config": null, "conv_filters": null, "conv_activation": "relu", "conv_kernel_initializer": null, "conv_kernel_initializer_config": null, "conv_bias_initializer": null, "conv_bias_initializer_config": null, "conv_transpose_kernel_initializer": null, "conv_transpose_kernel_initializer_config": null, "conv_transpose_bias_initializer": null, "conv_transpose_bias_initializer_config": null, "post_fcnet_hiddens": [], "post_fcnet_activation": "relu", "post_fcnet_weights_initializer": null, "post_fcnet_weights_initializer_config": null, "post_fcnet_bias_initializer": null, "post_fcnet_bias_initializer_config": null, "free_log_std": false, "log_std_clip_param": 20.0, "no_final_linear": false, "vf_share_layers": false, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "lstm_weights_initializer": null, "lstm_weights_initializer_config": null, "lstm_bias_initializer": null, "lstm_bias_initializer_config": null, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "attention_use_n_prev_actions": 0, "attention_use_n_prev_rewards": 0, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": null, "custom_model_config": {}, "custom_action_dist": null, "custom_preprocessor": null, "encoder_latent_dim": null, "always_check_shapes": false, "lstm_use_prev_action_reward": -1, "_use_default_native_models": -1, "_disable_preprocessor_api": false, "_disable_action_flattening": false}, "_learner_connector": null, "add_default_connectors_to_learner_pipeline": true, "learner_config_dict": {}, "optimizer": {}, "_learner_class": null, "callbacks_on_algorithm_init": null, "callbacks_on_env_runners_recreated": null, "callbacks_on_offline_eval_runners_recreated": null, "callbacks_on_checkpoint_loaded": null, "callbacks_on_environment_created": null, "callbacks_on_episode_created": null, "callbacks_on_episode_start": null, "callbacks_on_episode_step": null, "callbacks_on_episode_end": null, "callbacks_on_evaluate_start": null, "callbacks_on_evaluate_end": null, "callbacks_on_evaluate_offline_start": null, "callbacks_on_evaluate_offline_end": null, "callbacks_on_sample_end": null, "callbacks_on_train_result": null, "explore": true, "enable_rl_module_and_learner": true, "enable_env_runner_and_connector_v2": true, "_prior_exploration_config": {"type": "StochasticSampling"}, "count_steps_by": "env_steps", "policy_map_capacity": 100, "policy_mapping_fn": "<function AlgorithmConfig.DEFAULT_POLICY_MAPPING_FN at 0x383de9b20>", "policies_to_train": null, "policy_states_are_swappable": false, "observation_fn": null, "offline_data_class": null, "input_read_method": "read_parquet", "input_read_method_kwargs": {}, "input_read_schema": {}, "input_read_episodes": false, "input_read_sample_batches": false, "input_read_batch_size": null, "input_filesystem": null, "input_filesystem_kwargs": {}, "input_compress_columns": ["obs", "new_obs"], "input_spaces_jsonable": true, "materialize_data": false, "materialize_mapped_data": true, "map_batches_kwargs": {}, "iter_batches_kwargs": {}, "ignore_final_observation": false, "prelearner_class": null, "prelearner_buffer_class": null, "prelearner_buffer_kwargs": {}, "prelearner_module_synch_period": 10, "dataset_num_iters_per_learner": null, "input_config": {}, "actions_in_input_normalized": false, "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_config": {}, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "output_max_rows_per_file": null, "output_write_remaining_data": false, "output_write_method": "write_parquet", "output_write_method_kwargs": {}, "output_filesystem": null, "output_filesystem_kwargs": {}, "output_write_episodes": true, "offline_sampling": false, "evaluation_interval": 1, "evaluation_duration": 20, "evaluation_duration_unit": "episodes", "evaluation_sample_timeout_s": 120.0, "evaluation_auto_duration_min_env_steps_per_sample": 100, "evaluation_auto_duration_max_env_steps_per_sample": 2000, "evaluation_parallel_to_training": false, "evaluation_force_reset_envs_before_iteration": true, "evaluation_config": null, "off_policy_estimation_methods": {}, "ope_split_batch_by_episode": true, "evaluation_num_env_runners": 1, "in_evaluation": false, "sync_filters_on_rollout_workers_timeout_s": 10.0, "offline_evaluation_interval": null, "num_offline_eval_runners": 0, "offline_loss_for_module_fn": null, "offline_evaluation_duration": 1, "offline_evaluation_parallel_to_training": false, "offline_evaluation_timeout_s": 120.0, "num_cpus_per_offline_eval_runner": 1, "num_gpus_per_offline_eval_runner": 0, "custom_resources_per_offline_eval_runner": {}, "restart_failed_offline_eval_runners": true, "ignore_offline_eval_runner_failures": false, "max_num_offline_eval_runner_restarts": 1000, "offline_eval_runner_restore_timeout_s": 1800.0, "max_requests_in_flight_per_offline_eval_runner": 1, "validate_offline_eval_runners_after_construction": true, "offline_eval_runner_health_probe_timeout_s": 30.0, "offline_eval_rl_module_inference_only": false, "broadcast_offline_eval_runner_states": false, "offline_eval_batch_size_per_runner": 256, "dataset_num_iters_per_eval_runner": 1, "keep_per_episode_custom_metrics": false, "metrics_episode_collection_timeout_s": 60.0, "metrics_num_episodes_for_smoothing": 100, "min_time_s_per_iteration": null, "min_train_timesteps_per_iteration": 0, "min_sample_timesteps_per_iteration": 0, "log_gradients": true, "export_native_model_files": false, "checkpoint_trainable_policies_only": false, "logger_creator": null, "logger_config": null, "log_level": "WARN", "log_sys_usage": true, "fake_sampler": false, "seed": 4, "restart_failed_env_runners": true, "ignore_env_runner_failures": false, "max_num_env_runner_restarts": 1000, "delay_between_env_runner_restarts_s": 60.0, "restart_failed_sub_environments": false, "num_consecutive_env_runner_failures_tolerance": 100, "env_runner_health_probe_timeout_s": 30.0, "env_runner_restore_timeout_s": 1800.0, "_model_config": {}, "_rl_module_spec": "RLModuleSpec(module_class=None, observation_space=None, action_space=None, inference_only=False, learner_only=False, model_config=DefaultModelConfig(fcnet_hiddens=[60, 90], fcnet_activation='tanh', fcnet_kernel_initializer=None, fcnet_kernel_initializer_kwargs=None, fcnet_bias_initializer=None, fcnet_bias_initializer_kwargs=None, conv_filters=None, conv_activation='relu', conv_kernel_initializer=None, conv_kernel_initializer_kwargs=None, conv_bias_initializer=None, conv_bias_initializer_kwargs=None, head_fcnet_hiddens=[], head_fcnet_activation='relu', head_fcnet_kernel_initializer=None, head_fcnet_kernel_initializer_kwargs=None, head_fcnet_bias_initializer=None, head_fcnet_bias_initializer_kwargs=None, free_log_std=False, log_std_clip_param=20.0, vf_share_layers=True, use_lstm=False, max_seq_len=20, lstm_cell_size=256, lstm_use_prev_action=False, lstm_use_prev_reward=False, lstm_kernel_initializer=None, lstm_kernel_initializer_kwargs=None, lstm_bias_initializer=None, lstm_bias_initializer_kwargs=None), catalog_class=None, load_state_path=None, model_config_dict=None)", "algorithm_config_overrides_per_module": {}, "_per_module_overrides": {}, "_validate_config": true, "_use_msgpack_checkpoints": false, "_torch_grad_scaler_class": null, "_torch_lr_scheduler_classes": null, "_tf_policy_handles_more_than_one_loss": false, "_disable_preprocessor_api": false, "_disable_action_flattening": false, "_disable_initialize_loss_from_dummy_batch": false, "_dont_auto_sync_env_runner_states": false, "env_task_fn": -1, "enable_connectors": -1, "simple_optimizer": false, "policy_map_cache": -1, "worker_cls": -1, "synchronize_filters": -1, "enable_async_evaluation": -1, "custom_async_evaluation_function": -1, "_enable_rl_module_api": -1, "auto_wrap_old_gym_envs": -1, "always_attach_evaluation_results": -1, "replay_sequence_length": null, "_disable_execution_plan_api": -1, "use_critic": true, "use_gae": true, "use_kl_loss": true, "kl_coeff": 0.7464963036515, "kl_target": 0.0270990929592, "vf_loss_coeff": 0.6688075857018, "entropy_coeff": 0.0090570820258, "clip_param": 0.1221781641624, "vf_clip_param": 0.1027808522125, "entropy_coeff_schedule": null, "lr_schedule": null, "sgd_minibatch_size": -1, "vf_share_layers": -1, "__stdout_file__": null, "__stderr_file__": null, "lambda": 0.9099046732075, "input": "sampler", "policies": {"default_policy": [null, null, null, null]}, "callbacks": "<class 'ray.rllib.callbacks.callbacks.RLlibCallback'>", "create_env_on_driver": false, "custom_eval_function": null, "framework": "torch"}, "time_since_restore": 26.759767293930054, "iterations_since_restore": 15, "perf": {"cpu_util_percent": 26.5, "ram_util_percent": 79.73333333333333}}
{"timers": {"training_iteration": 1.8674345695547299, "restore_env_runners": 7.054522484033272e-05, "training_step": 1.8671183376224019, "env_runner_sampling_timer": 1.7494699934934594, "learner_update_timer": 0.11415485170428509, "synch_weights": 0.0006376000893561248, "restore_eval_env_runners": 8.627803367894399e-06, "evaluation_iteration": 0.11799287434373869, "synch_eval_env_connectors": 0.00013160327244693938, "synch_env_connectors": 4.6288587350358225e-06}, "env_runners": {"env_to_module_connector": {"connector_pipeline_timer": 4.346526111745453e-05, "timers": {"connectors": {"add_time_dim_to_batch_and_zero_pad": 2.408732524874226e-06, "batch_individual_items": 6.237366299818198e-06, "numpy_to_tensor": 8.508517285203503e-06, "add_observations_from_episodes_to_batch": 2.9232451719866933e-06, "add_states_from_episodes_to_batch": 1.7515679985334563e-06}}}, "env_step_timer": 1.3769350456949954e-05, "num_agent_steps_sampled_lifetime": {"default_agent": -8635000.0}, "env_to_module_sum_episodes_length_out": 10.36823839457432, "module_to_env_connector": {"timers": {"connectors": {"normalize_and_clip_actions": 9.456410087431495e-06, "tensor_to_numpy": 1.3122717714789175e-05, "remove_single_ts_time_rank_from_batch": 5.823016151568316e-07, "un_batch_to_individual_items": 5.407758864340053e-06, "get_actions": 3.867373832545401e-05, "listify_data_for_vector_env": 1.0975055666206549e-05}}, "connector_pipeline_timer": 0.00010374669842806513}, "num_agent_steps_sampled": {"default_agent": 5000.0}, "module_episode_returns_mean": {"default_policy": 11.059999999999997}, "env_reset_timer": 3.173475052341025e-05, "episode_return_max": 12.5, "sample": 0.004824759543638581, "env_to_module_sum_episodes_length_in": 10.36823839457432, "num_module_steps_sampled_lifetime": {"default_policy": -8635000.0}, "episode_return_mean": 11.059999999999997, "episode_duration_sec_mean": 0.004544003194198011, "num_env_steps_sampled": 5000.0, "num_episodes": 250.0, "episode_len_mean": 20.0, "rlmodule_inference_timer": 2.7908556144614866e-05, "episode_len_min": 20, "episode_len_max": 20, "agent_episode_returns_mean": {"default_agent": 11.059999999999997}, "num_module_steps_sampled": {"default_policy": 5000.0}, "num_episodes_lifetime": -431750.0, "num_env_steps_sampled_lifetime": -8635000.0, "weights_seq_no": 15.0, "episode_return_min": -7.5, "time_between_sampling": 0.001872726441599273, "num_env_steps_sampled_lifetime_throughput": 3749.156918636275}, "learners": {"default_policy": {"curr_kl_coeff": 1.1390629879315384e-05, "gradients_default_optimizer_global_norm": 0.06402754038572311, "vf_loss": 0.10245729237794876, "total_loss": -0.02420705370604992, "num_module_steps_trained": 6000, "diff_num_grad_updates_vs_sampler_policy": 1.0, "module_train_batch_size_mean": 1000.0, "entropy": 0.4002242386341095, "num_module_steps_trained_lifetime": 96000, "curr_entropy_coeff": 0.0090570820258, "vf_loss_unclipped": 28.66145133972168, "weights_seq_no": 16.0, "default_optimizer_learning_rate": 0.0002847858517, "vf_explained_var": 0.015397906303405762, "mean_kl_loss": 6.365888111758977e-05, "num_trainable_parameters": 6003, "policy_loss": -0.08910641074180603, "num_module_steps_trained_lifetime_throughput": 349643.6887331981}, "__all_modules__": {"learner_connector": {"timers": {"connectors": {"numpy_to_tensor": 6.295894887209773e-05, "batch_individual_items": 0.035243479968972174, "add_columns_from_episodes_to_train_batch": 0.03427985089133915, "add_time_dim_to_batch_and_zero_pad": 1.0075428095116642e-05, "add_one_ts_to_episodes_and_truncate": 0.008593173619701052, "add_observations_from_episodes_to_batch": 0.000817722522304915, "general_advantage_estimation": 0.006728498605239906, "add_states_from_episodes_to_batch": 3.5125586657919817e-06}}, "connector_pipeline_timer": 0.08584635802066065}, "num_env_steps_trained": 31500, "num_env_steps_trained_lifetime": 504000, "learner_connector_sum_episodes_length_out": 5250.0, "learner_connector_sum_episodes_length_in": 5000.0, "num_module_steps_trained_lifetime": 96000, "num_non_trainable_parameters": 0, "num_module_steps_trained": 6000, "num_trainable_parameters": 6003, "num_env_steps_trained_lifetime_throughput": 1830230.7926409205, "num_module_steps_trained_throughput": 349504.8222886641, "num_module_steps_trained_lifetime_throughput": 349182.8338038641}}, "num_training_step_calls_per_iteration": 1, "evaluation": {"env_runners": {"sample": 0.10676673835541627, "env_to_module_sum_episodes_length_in": 10.368238394574323, "num_module_steps_sampled": {"default_policy": 400}, "module_to_env_connector": {"timers": {"connectors": {"tensor_to_numpy": 1.6662868039513835e-05, "remove_single_ts_time_rank_from_batch": 7.351823971280725e-07, "listify_data_for_vector_env": 1.3089053616893057e-05, "normalize_and_clip_actions": 1.1523223669102194e-05, "get_actions": 4.852828087269754e-05, "un_batch_to_individual_items": 6.767812418609858e-06}}, "connector_pipeline_timer": 0.000130601211304681}, "rlmodule_inference_timer": 3.4880604828624906e-05, "env_to_module_connector": {"timers": {"connectors": {"add_time_dim_to_batch_and_zero_pad": 2.67216311107947e-06, "numpy_to_tensor": 1.0593784172920163e-05, "add_states_from_episodes_to_batch": 2.246041296956013e-06, "batch_individual_items": 9.096362497455968e-06, "add_observations_from_episodes_to_batch": 3.4364085951630896e-06}}, "connector_pipeline_timer": 5.349320460229241e-05}, "episode_len_max": 20, "num_agent_steps_sampled_lifetime": {"default_agent": 6400}, "num_episodes_lifetime": 320, "episode_return_min": -16.5, "env_step_timer": 1.7643299030768006e-05, "env_to_module_sum_episodes_length_out": 10.368238394574323, "num_env_steps_sampled": 400, "episode_len_mean": 20.0, "num_agent_steps_sampled": {"default_agent": 400}, "num_env_steps_sampled_lifetime": 80400, "weights_seq_no": 16.0, "module_episode_returns_mean": {"default_policy": 2.95}, "num_module_steps_sampled_lifetime": {"default_policy": 6400}, "num_episodes": 20, "episode_len_min": 20, "env_reset_timer": 0.0004973160494735096, "episode_return_max": 12.5, "agent_episode_returns_mean": {"default_agent": 2.95}, "episode_return_mean": 2.95, "episode_duration_sec_mean": 0.00489075586432591, "time_between_sampling": 1.7425092734526824}, "num_healthy_workers": 1, "actor_manager_num_outstanding_async_reqs": 0, "num_remote_worker_restarts": 0}, "num_env_steps_sampled_lifetime": -8635000.0, "fault_tolerance": {"num_healthy_workers": 0, "num_remote_worker_restarts": 0}, "env_runner_group": {"actor_manager_num_outstanding_async_reqs": 0}, "done": false, "training_iteration": 16, "trial_id": "4da5b_00000", "date": "2025-08-11_19-22-03", "timestamp": 1754932923, "time_this_iter_s": 1.6160578727722168, "time_total_s": 28.37582516670227, "pid": 14327, "hostname": "Mac", "node_ip": "127.0.0.1", "config": {"exploration_config": {}, "extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "placement_strategy": "PACK", "num_gpus": 0, "_fake_gpus": false, "num_cpus_for_main_process": 2, "eager_tracing": true, "eager_max_retraces": 20, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "torch_compile_learner": false, "torch_compile_learner_what_to_compile": "forward_train", "torch_compile_learner_dynamo_backend": "aot_eager", "torch_compile_learner_dynamo_mode": null, "torch_compile_worker": false, "torch_compile_worker_dynamo_backend": "aot_eager", "torch_compile_worker_dynamo_mode": null, "torch_ddp_kwargs": {}, "torch_skip_nan_gradients": false, "env": "Umbrella", "env_config": {}, "observation_space": null, "action_space": null, "clip_rewards": null, "normalize_actions": true, "clip_actions": false, "_is_atari": null, "disable_env_checking": false, "render_env": false, "action_mask_key": "action_mask", "env_runner_cls": null, "num_env_runners": 0, "create_local_env_runner": true, "num_envs_per_env_runner": 1, "gym_env_vectorize_mode": "SYNC", "num_cpus_per_env_runner": 1, "num_gpus_per_env_runner": 0, "custom_resources_per_env_runner": {}, "validate_env_runners_after_construction": true, "episodes_to_numpy": true, "max_requests_in_flight_per_env_runner": 1, "sample_timeout_s": 60.0, "_env_to_module_connector": null, "add_default_connectors_to_env_to_module_pipeline": true, "_module_to_env_connector": null, "add_default_connectors_to_module_to_env_pipeline": true, "merge_env_runner_states": "training_only", "broadcast_env_runner_states": true, "episode_lookback_horizon": 1, "rollout_fragment_length": "auto", "batch_mode": "complete_episodes", "compress_observations": false, "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "enable_tf1_exec_eagerly": false, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "preprocessor_pref": "deepmind", "observation_filter": "NoFilter", "update_worker_filter_stats": true, "use_worker_filter_stats": true, "sampler_perf_stats_ema_coef": null, "_is_online": true, "num_learners": 0, "num_gpus_per_learner": 0, "num_cpus_per_learner": "auto", "num_aggregator_actors_per_learner": 0, "max_requests_in_flight_per_aggregator_actor": 3, "local_gpu_idx": 0, "max_requests_in_flight_per_learner": 3, "gamma": 1, "lr": 0.0002847858517, "grad_clip": 0.5, "grad_clip_by": "global_norm", "_train_batch_size_per_learner": 5000, "train_batch_size": 4000, "num_epochs": 1, "minibatch_size": 1000, "shuffle_batch_per_epoch": true, "model": {"fcnet_hiddens": [256, 256], "fcnet_activation": "tanh", "fcnet_weights_initializer": null, "fcnet_weights_initializer_config": null, "fcnet_bias_initializer": null, "fcnet_bias_initializer_config": null, "conv_filters": null, "conv_activation": "relu", "conv_kernel_initializer": null, "conv_kernel_initializer_config": null, "conv_bias_initializer": null, "conv_bias_initializer_config": null, "conv_transpose_kernel_initializer": null, "conv_transpose_kernel_initializer_config": null, "conv_transpose_bias_initializer": null, "conv_transpose_bias_initializer_config": null, "post_fcnet_hiddens": [], "post_fcnet_activation": "relu", "post_fcnet_weights_initializer": null, "post_fcnet_weights_initializer_config": null, "post_fcnet_bias_initializer": null, "post_fcnet_bias_initializer_config": null, "free_log_std": false, "log_std_clip_param": 20.0, "no_final_linear": false, "vf_share_layers": false, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "lstm_weights_initializer": null, "lstm_weights_initializer_config": null, "lstm_bias_initializer": null, "lstm_bias_initializer_config": null, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "attention_use_n_prev_actions": 0, "attention_use_n_prev_rewards": 0, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": null, "custom_model_config": {}, "custom_action_dist": null, "custom_preprocessor": null, "encoder_latent_dim": null, "always_check_shapes": false, "lstm_use_prev_action_reward": -1, "_use_default_native_models": -1, "_disable_preprocessor_api": false, "_disable_action_flattening": false}, "_learner_connector": null, "add_default_connectors_to_learner_pipeline": true, "learner_config_dict": {}, "optimizer": {}, "_learner_class": null, "callbacks_on_algorithm_init": null, "callbacks_on_env_runners_recreated": null, "callbacks_on_offline_eval_runners_recreated": null, "callbacks_on_checkpoint_loaded": null, "callbacks_on_environment_created": null, "callbacks_on_episode_created": null, "callbacks_on_episode_start": null, "callbacks_on_episode_step": null, "callbacks_on_episode_end": null, "callbacks_on_evaluate_start": null, "callbacks_on_evaluate_end": null, "callbacks_on_evaluate_offline_start": null, "callbacks_on_evaluate_offline_end": null, "callbacks_on_sample_end": null, "callbacks_on_train_result": null, "explore": true, "enable_rl_module_and_learner": true, "enable_env_runner_and_connector_v2": true, "_prior_exploration_config": {"type": "StochasticSampling"}, "count_steps_by": "env_steps", "policy_map_capacity": 100, "policy_mapping_fn": "<function AlgorithmConfig.DEFAULT_POLICY_MAPPING_FN at 0x383de9b20>", "policies_to_train": null, "policy_states_are_swappable": false, "observation_fn": null, "offline_data_class": null, "input_read_method": "read_parquet", "input_read_method_kwargs": {}, "input_read_schema": {}, "input_read_episodes": false, "input_read_sample_batches": false, "input_read_batch_size": null, "input_filesystem": null, "input_filesystem_kwargs": {}, "input_compress_columns": ["obs", "new_obs"], "input_spaces_jsonable": true, "materialize_data": false, "materialize_mapped_data": true, "map_batches_kwargs": {}, "iter_batches_kwargs": {}, "ignore_final_observation": false, "prelearner_class": null, "prelearner_buffer_class": null, "prelearner_buffer_kwargs": {}, "prelearner_module_synch_period": 10, "dataset_num_iters_per_learner": null, "input_config": {}, "actions_in_input_normalized": false, "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_config": {}, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "output_max_rows_per_file": null, "output_write_remaining_data": false, "output_write_method": "write_parquet", "output_write_method_kwargs": {}, "output_filesystem": null, "output_filesystem_kwargs": {}, "output_write_episodes": true, "offline_sampling": false, "evaluation_interval": 1, "evaluation_duration": 20, "evaluation_duration_unit": "episodes", "evaluation_sample_timeout_s": 120.0, "evaluation_auto_duration_min_env_steps_per_sample": 100, "evaluation_auto_duration_max_env_steps_per_sample": 2000, "evaluation_parallel_to_training": false, "evaluation_force_reset_envs_before_iteration": true, "evaluation_config": null, "off_policy_estimation_methods": {}, "ope_split_batch_by_episode": true, "evaluation_num_env_runners": 1, "in_evaluation": false, "sync_filters_on_rollout_workers_timeout_s": 10.0, "offline_evaluation_interval": null, "num_offline_eval_runners": 0, "offline_loss_for_module_fn": null, "offline_evaluation_duration": 1, "offline_evaluation_parallel_to_training": false, "offline_evaluation_timeout_s": 120.0, "num_cpus_per_offline_eval_runner": 1, "num_gpus_per_offline_eval_runner": 0, "custom_resources_per_offline_eval_runner": {}, "restart_failed_offline_eval_runners": true, "ignore_offline_eval_runner_failures": false, "max_num_offline_eval_runner_restarts": 1000, "offline_eval_runner_restore_timeout_s": 1800.0, "max_requests_in_flight_per_offline_eval_runner": 1, "validate_offline_eval_runners_after_construction": true, "offline_eval_runner_health_probe_timeout_s": 30.0, "offline_eval_rl_module_inference_only": false, "broadcast_offline_eval_runner_states": false, "offline_eval_batch_size_per_runner": 256, "dataset_num_iters_per_eval_runner": 1, "keep_per_episode_custom_metrics": false, "metrics_episode_collection_timeout_s": 60.0, "metrics_num_episodes_for_smoothing": 100, "min_time_s_per_iteration": null, "min_train_timesteps_per_iteration": 0, "min_sample_timesteps_per_iteration": 0, "log_gradients": true, "export_native_model_files": false, "checkpoint_trainable_policies_only": false, "logger_creator": null, "logger_config": null, "log_level": "WARN", "log_sys_usage": true, "fake_sampler": false, "seed": 4, "restart_failed_env_runners": true, "ignore_env_runner_failures": false, "max_num_env_runner_restarts": 1000, "delay_between_env_runner_restarts_s": 60.0, "restart_failed_sub_environments": false, "num_consecutive_env_runner_failures_tolerance": 100, "env_runner_health_probe_timeout_s": 30.0, "env_runner_restore_timeout_s": 1800.0, "_model_config": {}, "_rl_module_spec": "RLModuleSpec(module_class=None, observation_space=None, action_space=None, inference_only=False, learner_only=False, model_config=DefaultModelConfig(fcnet_hiddens=[60, 90], fcnet_activation='tanh', fcnet_kernel_initializer=None, fcnet_kernel_initializer_kwargs=None, fcnet_bias_initializer=None, fcnet_bias_initializer_kwargs=None, conv_filters=None, conv_activation='relu', conv_kernel_initializer=None, conv_kernel_initializer_kwargs=None, conv_bias_initializer=None, conv_bias_initializer_kwargs=None, head_fcnet_hiddens=[], head_fcnet_activation='relu', head_fcnet_kernel_initializer=None, head_fcnet_kernel_initializer_kwargs=None, head_fcnet_bias_initializer=None, head_fcnet_bias_initializer_kwargs=None, free_log_std=False, log_std_clip_param=20.0, vf_share_layers=True, use_lstm=False, max_seq_len=20, lstm_cell_size=256, lstm_use_prev_action=False, lstm_use_prev_reward=False, lstm_kernel_initializer=None, lstm_kernel_initializer_kwargs=None, lstm_bias_initializer=None, lstm_bias_initializer_kwargs=None), catalog_class=None, load_state_path=None, model_config_dict=None)", "algorithm_config_overrides_per_module": {}, "_per_module_overrides": {}, "_validate_config": true, "_use_msgpack_checkpoints": false, "_torch_grad_scaler_class": null, "_torch_lr_scheduler_classes": null, "_tf_policy_handles_more_than_one_loss": false, "_disable_preprocessor_api": false, "_disable_action_flattening": false, "_disable_initialize_loss_from_dummy_batch": false, "_dont_auto_sync_env_runner_states": false, "env_task_fn": -1, "enable_connectors": -1, "simple_optimizer": false, "policy_map_cache": -1, "worker_cls": -1, "synchronize_filters": -1, "enable_async_evaluation": -1, "custom_async_evaluation_function": -1, "_enable_rl_module_api": -1, "auto_wrap_old_gym_envs": -1, "always_attach_evaluation_results": -1, "replay_sequence_length": null, "_disable_execution_plan_api": -1, "use_critic": true, "use_gae": true, "use_kl_loss": true, "kl_coeff": 0.7464963036515, "kl_target": 0.0270990929592, "vf_loss_coeff": 0.6688075857018, "entropy_coeff": 0.0090570820258, "clip_param": 0.1221781641624, "vf_clip_param": 0.1027808522125, "entropy_coeff_schedule": null, "lr_schedule": null, "sgd_minibatch_size": -1, "vf_share_layers": -1, "__stdout_file__": null, "__stderr_file__": null, "lambda": 0.9099046732075, "input": "sampler", "policies": {"default_policy": [null, null, null, null]}, "callbacks": "<class 'ray.rllib.callbacks.callbacks.RLlibCallback'>", "create_env_on_driver": false, "custom_eval_function": null, "framework": "torch"}, "time_since_restore": 28.37582516670227, "iterations_since_restore": 16, "perf": {"cpu_util_percent": 40.15, "ram_util_percent": 79.05}}
{"timers": {"training_iteration": 1.8659028880300064, "restore_env_runners": 6.990518170465107e-05, "training_step": 1.8655877942455934, "env_runner_sampling_timer": 1.7481319710574728, "learner_update_timer": 0.11396524360686029, "synch_weights": 0.0006369140875512085, "restore_eval_env_runners": 8.61444556350141e-06, "evaluation_iteration": 0.11814743685017366, "synch_eval_env_connectors": 0.00013130223930210824, "synch_env_connectors": 4.6208998923969824e-06}, "env_runners": {"env_to_module_connector": {"connector_pipeline_timer": 4.6821346677400875e-05, "timers": {"connectors": {"add_time_dim_to_batch_and_zero_pad": 2.6457020861185885e-06, "batch_individual_items": 6.834404078292298e-06, "numpy_to_tensor": 9.528062179351382e-06, "add_observations_from_episodes_to_batch": 3.204967257036266e-06, "add_states_from_episodes_to_batch": 1.8159075281081174e-06}}}, "env_step_timer": 1.551614467735503e-05, "num_agent_steps_sampled_lifetime": {"default_agent": -9252500.0}, "env_to_module_sum_episodes_length_out": 10.36823839457432, "module_to_env_connector": {"timers": {"connectors": {"normalize_and_clip_actions": 1.0263859328061535e-05, "tensor_to_numpy": 1.4669967459021989e-05, "remove_single_ts_time_rank_from_batch": 6.469661121489926e-07, "un_batch_to_individual_items": 5.899833566239467e-06, "get_actions": 4.4287179755704616e-05, "listify_data_for_vector_env": 1.207797726547682e-05}}, "connector_pipeline_timer": 0.00011519400193474861}, "num_agent_steps_sampled": {"default_agent": 5000.0}, "module_episode_returns_mean": {"default_policy": 10.5}, "env_reset_timer": 4.3492017976677394e-05, "episode_return_max": 12.5, "sample": 0.005540109227973113, "env_to_module_sum_episodes_length_in": 10.36823839457432, "num_module_steps_sampled_lifetime": {"default_policy": -9252500.0}, "episode_return_mean": 10.5, "episode_duration_sec_mean": 0.005385910351760686, "num_env_steps_sampled": 5000.0, "num_episodes": 250.0, "episode_len_mean": 20.0, "rlmodule_inference_timer": 4.812014772233924e-05, "episode_len_min": 20, "episode_len_max": 20, "agent_episode_returns_mean": {"default_agent": 10.5}, "num_module_steps_sampled": {"default_policy": 5000.0}, "num_episodes_lifetime": -462625.0, "num_env_steps_sampled_lifetime": -9252500.0, "weights_seq_no": 16.0, "episode_return_min": -7.5, "time_between_sampling": 0.0017228847504066403, "num_env_steps_sampled_lifetime_throughput": 3367.9820046061604}, "learners": {"default_policy": {"curr_kl_coeff": 5.695314939657692e-06, "gradients_default_optimizer_global_norm": 0.12811815738677979, "vf_loss": 0.10234946012496948, "total_loss": -0.03301073610782623, "num_module_steps_trained": 6000, "diff_num_grad_updates_vs_sampler_policy": 1.0, "module_train_batch_size_mean": 1000.0, "entropy": 0.3960508704185486, "num_module_steps_trained_lifetime": 102000, "curr_entropy_coeff": 0.0090570820258, "vf_loss_unclipped": 28.645084381103516, "weights_seq_no": 17.0, "default_optimizer_learning_rate": 0.0002847858517, "vf_explained_var": 0.01704394817352295, "mean_kl_loss": 0.00011660082236630842, "num_trainable_parameters": 6003, "policy_loss": -0.09787576645612717, "num_module_steps_trained_lifetime_throughput": 350054.4269096599}, "__all_modules__": {"learner_connector": {"timers": {"connectors": {"numpy_to_tensor": 6.311518958123258e-05, "batch_individual_items": 0.035204675168573604, "add_columns_from_episodes_to_train_batch": 0.034280971542503105, "add_time_dim_to_batch_and_zero_pad": 1.0084674651759744e-05, "add_one_ts_to_episodes_and_truncate": 0.008585865633518272, "add_observations_from_episodes_to_batch": 0.0008201123868574431, "general_advantage_estimation": 0.006719321959205005, "add_states_from_episodes_to_batch": 3.5057732250796106e-06}}, "connector_pipeline_timer": 0.08579476277987713}, "num_env_steps_trained": 31500, "num_env_steps_trained_lifetime": 535500, "learner_connector_sum_episodes_length_out": 5250.0, "learner_connector_sum_episodes_length_in": 5000.0, "num_module_steps_trained_lifetime": 102000, "num_non_trainable_parameters": 0, "num_module_steps_trained": 6000, "num_trainable_parameters": 6003, "num_env_steps_trained_lifetime_throughput": 1832803.1460284316, "num_module_steps_trained_throughput": 349958.51489356795, "num_module_steps_trained_lifetime_throughput": 349645.64384415606}}, "num_training_step_calls_per_iteration": 1, "evaluation": {"env_runners": {"sample": 0.10668740556266407, "env_to_module_sum_episodes_length_in": 10.368238394574323, "num_module_steps_sampled": {"default_policy": 400}, "module_to_env_connector": {"timers": {"connectors": {"tensor_to_numpy": 1.2922056039632532e-05, "remove_single_ts_time_rank_from_batch": 5.8581468823831e-07, "listify_data_for_vector_env": 1.1149672728451136e-05, "normalize_and_clip_actions": 9.468177445755445e-06, "get_actions": 3.6290787289499245e-05, "un_batch_to_individual_items": 5.437572193666778e-06}}, "connector_pipeline_timer": 0.00010190835937026555}, "rlmodule_inference_timer": 2.7876967248526444e-05, "env_to_module_connector": {"timers": {"connectors": {"add_time_dim_to_batch_and_zero_pad": 2.2423643919928285e-06, "numpy_to_tensor": 8.411319626385947e-06, "add_states_from_episodes_to_batch": 1.6330666483550275e-06, "batch_individual_items": 6.347654464527602e-06, "add_observations_from_episodes_to_batch": 2.853964416549815e-06}}, "connector_pipeline_timer": 4.359079740824069e-05}, "episode_len_max": 20, "num_agent_steps_sampled_lifetime": {"default_agent": 6800}, "num_episodes_lifetime": 340, "episode_return_min": -16.5, "env_step_timer": 1.4329762403375252e-05, "env_to_module_sum_episodes_length_out": 10.368238394574323, "num_env_steps_sampled": 400, "episode_len_mean": 20.0, "num_agent_steps_sampled": {"default_agent": 400}, "num_env_steps_sampled_lifetime": 85400, "weights_seq_no": 17.0, "module_episode_returns_mean": {"default_policy": 3.55}, "num_module_steps_sampled_lifetime": {"default_policy": 6800}, "num_episodes": 20, "episode_len_min": 20, "env_reset_timer": 0.0004931245584930282, "episode_return_max": 12.5, "agent_episode_returns_mean": {"default_agent": 3.55}, "episode_return_mean": 3.55, "episode_duration_sec_mean": 0.004818307986715809, "time_between_sampling": 1.7424261286380776}, "num_healthy_workers": 1, "actor_manager_num_outstanding_async_reqs": 0, "num_remote_worker_restarts": 0}, "num_env_steps_sampled_lifetime": -9252500.0, "fault_tolerance": {"num_healthy_workers": 0, "num_remote_worker_restarts": 0}, "env_runner_group": {"actor_manager_num_outstanding_async_reqs": 0}, "done": false, "training_iteration": 17, "trial_id": "4da5b_00000", "date": "2025-08-11_19-22-05", "timestamp": 1754932925, "time_this_iter_s": 1.8208320140838623, "time_total_s": 30.196657180786133, "pid": 14327, "hostname": "Mac", "node_ip": "127.0.0.1", "config": {"exploration_config": {}, "extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "placement_strategy": "PACK", "num_gpus": 0, "_fake_gpus": false, "num_cpus_for_main_process": 2, "eager_tracing": true, "eager_max_retraces": 20, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "torch_compile_learner": false, "torch_compile_learner_what_to_compile": "forward_train", "torch_compile_learner_dynamo_backend": "aot_eager", "torch_compile_learner_dynamo_mode": null, "torch_compile_worker": false, "torch_compile_worker_dynamo_backend": "aot_eager", "torch_compile_worker_dynamo_mode": null, "torch_ddp_kwargs": {}, "torch_skip_nan_gradients": false, "env": "Umbrella", "env_config": {}, "observation_space": null, "action_space": null, "clip_rewards": null, "normalize_actions": true, "clip_actions": false, "_is_atari": null, "disable_env_checking": false, "render_env": false, "action_mask_key": "action_mask", "env_runner_cls": null, "num_env_runners": 0, "create_local_env_runner": true, "num_envs_per_env_runner": 1, "gym_env_vectorize_mode": "SYNC", "num_cpus_per_env_runner": 1, "num_gpus_per_env_runner": 0, "custom_resources_per_env_runner": {}, "validate_env_runners_after_construction": true, "episodes_to_numpy": true, "max_requests_in_flight_per_env_runner": 1, "sample_timeout_s": 60.0, "_env_to_module_connector": null, "add_default_connectors_to_env_to_module_pipeline": true, "_module_to_env_connector": null, "add_default_connectors_to_module_to_env_pipeline": true, "merge_env_runner_states": "training_only", "broadcast_env_runner_states": true, "episode_lookback_horizon": 1, "rollout_fragment_length": "auto", "batch_mode": "complete_episodes", "compress_observations": false, "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "enable_tf1_exec_eagerly": false, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "preprocessor_pref": "deepmind", "observation_filter": "NoFilter", "update_worker_filter_stats": true, "use_worker_filter_stats": true, "sampler_perf_stats_ema_coef": null, "_is_online": true, "num_learners": 0, "num_gpus_per_learner": 0, "num_cpus_per_learner": "auto", "num_aggregator_actors_per_learner": 0, "max_requests_in_flight_per_aggregator_actor": 3, "local_gpu_idx": 0, "max_requests_in_flight_per_learner": 3, "gamma": 1, "lr": 0.0002847858517, "grad_clip": 0.5, "grad_clip_by": "global_norm", "_train_batch_size_per_learner": 5000, "train_batch_size": 4000, "num_epochs": 1, "minibatch_size": 1000, "shuffle_batch_per_epoch": true, "model": {"fcnet_hiddens": [256, 256], "fcnet_activation": "tanh", "fcnet_weights_initializer": null, "fcnet_weights_initializer_config": null, "fcnet_bias_initializer": null, "fcnet_bias_initializer_config": null, "conv_filters": null, "conv_activation": "relu", "conv_kernel_initializer": null, "conv_kernel_initializer_config": null, "conv_bias_initializer": null, "conv_bias_initializer_config": null, "conv_transpose_kernel_initializer": null, "conv_transpose_kernel_initializer_config": null, "conv_transpose_bias_initializer": null, "conv_transpose_bias_initializer_config": null, "post_fcnet_hiddens": [], "post_fcnet_activation": "relu", "post_fcnet_weights_initializer": null, "post_fcnet_weights_initializer_config": null, "post_fcnet_bias_initializer": null, "post_fcnet_bias_initializer_config": null, "free_log_std": false, "log_std_clip_param": 20.0, "no_final_linear": false, "vf_share_layers": false, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "lstm_weights_initializer": null, "lstm_weights_initializer_config": null, "lstm_bias_initializer": null, "lstm_bias_initializer_config": null, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "attention_use_n_prev_actions": 0, "attention_use_n_prev_rewards": 0, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": null, "custom_model_config": {}, "custom_action_dist": null, "custom_preprocessor": null, "encoder_latent_dim": null, "always_check_shapes": false, "lstm_use_prev_action_reward": -1, "_use_default_native_models": -1, "_disable_preprocessor_api": false, "_disable_action_flattening": false}, "_learner_connector": null, "add_default_connectors_to_learner_pipeline": true, "learner_config_dict": {}, "optimizer": {}, "_learner_class": null, "callbacks_on_algorithm_init": null, "callbacks_on_env_runners_recreated": null, "callbacks_on_offline_eval_runners_recreated": null, "callbacks_on_checkpoint_loaded": null, "callbacks_on_environment_created": null, "callbacks_on_episode_created": null, "callbacks_on_episode_start": null, "callbacks_on_episode_step": null, "callbacks_on_episode_end": null, "callbacks_on_evaluate_start": null, "callbacks_on_evaluate_end": null, "callbacks_on_evaluate_offline_start": null, "callbacks_on_evaluate_offline_end": null, "callbacks_on_sample_end": null, "callbacks_on_train_result": null, "explore": true, "enable_rl_module_and_learner": true, "enable_env_runner_and_connector_v2": true, "_prior_exploration_config": {"type": "StochasticSampling"}, "count_steps_by": "env_steps", "policy_map_capacity": 100, "policy_mapping_fn": "<function AlgorithmConfig.DEFAULT_POLICY_MAPPING_FN at 0x383de9b20>", "policies_to_train": null, "policy_states_are_swappable": false, "observation_fn": null, "offline_data_class": null, "input_read_method": "read_parquet", "input_read_method_kwargs": {}, "input_read_schema": {}, "input_read_episodes": false, "input_read_sample_batches": false, "input_read_batch_size": null, "input_filesystem": null, "input_filesystem_kwargs": {}, "input_compress_columns": ["obs", "new_obs"], "input_spaces_jsonable": true, "materialize_data": false, "materialize_mapped_data": true, "map_batches_kwargs": {}, "iter_batches_kwargs": {}, "ignore_final_observation": false, "prelearner_class": null, "prelearner_buffer_class": null, "prelearner_buffer_kwargs": {}, "prelearner_module_synch_period": 10, "dataset_num_iters_per_learner": null, "input_config": {}, "actions_in_input_normalized": false, "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_config": {}, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "output_max_rows_per_file": null, "output_write_remaining_data": false, "output_write_method": "write_parquet", "output_write_method_kwargs": {}, "output_filesystem": null, "output_filesystem_kwargs": {}, "output_write_episodes": true, "offline_sampling": false, "evaluation_interval": 1, "evaluation_duration": 20, "evaluation_duration_unit": "episodes", "evaluation_sample_timeout_s": 120.0, "evaluation_auto_duration_min_env_steps_per_sample": 100, "evaluation_auto_duration_max_env_steps_per_sample": 2000, "evaluation_parallel_to_training": false, "evaluation_force_reset_envs_before_iteration": true, "evaluation_config": null, "off_policy_estimation_methods": {}, "ope_split_batch_by_episode": true, "evaluation_num_env_runners": 1, "in_evaluation": false, "sync_filters_on_rollout_workers_timeout_s": 10.0, "offline_evaluation_interval": null, "num_offline_eval_runners": 0, "offline_loss_for_module_fn": null, "offline_evaluation_duration": 1, "offline_evaluation_parallel_to_training": false, "offline_evaluation_timeout_s": 120.0, "num_cpus_per_offline_eval_runner": 1, "num_gpus_per_offline_eval_runner": 0, "custom_resources_per_offline_eval_runner": {}, "restart_failed_offline_eval_runners": true, "ignore_offline_eval_runner_failures": false, "max_num_offline_eval_runner_restarts": 1000, "offline_eval_runner_restore_timeout_s": 1800.0, "max_requests_in_flight_per_offline_eval_runner": 1, "validate_offline_eval_runners_after_construction": true, "offline_eval_runner_health_probe_timeout_s": 30.0, "offline_eval_rl_module_inference_only": false, "broadcast_offline_eval_runner_states": false, "offline_eval_batch_size_per_runner": 256, "dataset_num_iters_per_eval_runner": 1, "keep_per_episode_custom_metrics": false, "metrics_episode_collection_timeout_s": 60.0, "metrics_num_episodes_for_smoothing": 100, "min_time_s_per_iteration": null, "min_train_timesteps_per_iteration": 0, "min_sample_timesteps_per_iteration": 0, "log_gradients": true, "export_native_model_files": false, "checkpoint_trainable_policies_only": false, "logger_creator": null, "logger_config": null, "log_level": "WARN", "log_sys_usage": true, "fake_sampler": false, "seed": 4, "restart_failed_env_runners": true, "ignore_env_runner_failures": false, "max_num_env_runner_restarts": 1000, "delay_between_env_runner_restarts_s": 60.0, "restart_failed_sub_environments": false, "num_consecutive_env_runner_failures_tolerance": 100, "env_runner_health_probe_timeout_s": 30.0, "env_runner_restore_timeout_s": 1800.0, "_model_config": {}, "_rl_module_spec": "RLModuleSpec(module_class=None, observation_space=None, action_space=None, inference_only=False, learner_only=False, model_config=DefaultModelConfig(fcnet_hiddens=[60, 90], fcnet_activation='tanh', fcnet_kernel_initializer=None, fcnet_kernel_initializer_kwargs=None, fcnet_bias_initializer=None, fcnet_bias_initializer_kwargs=None, conv_filters=None, conv_activation='relu', conv_kernel_initializer=None, conv_kernel_initializer_kwargs=None, conv_bias_initializer=None, conv_bias_initializer_kwargs=None, head_fcnet_hiddens=[], head_fcnet_activation='relu', head_fcnet_kernel_initializer=None, head_fcnet_kernel_initializer_kwargs=None, head_fcnet_bias_initializer=None, head_fcnet_bias_initializer_kwargs=None, free_log_std=False, log_std_clip_param=20.0, vf_share_layers=True, use_lstm=False, max_seq_len=20, lstm_cell_size=256, lstm_use_prev_action=False, lstm_use_prev_reward=False, lstm_kernel_initializer=None, lstm_kernel_initializer_kwargs=None, lstm_bias_initializer=None, lstm_bias_initializer_kwargs=None), catalog_class=None, load_state_path=None, model_config_dict=None)", "algorithm_config_overrides_per_module": {}, "_per_module_overrides": {}, "_validate_config": true, "_use_msgpack_checkpoints": false, "_torch_grad_scaler_class": null, "_torch_lr_scheduler_classes": null, "_tf_policy_handles_more_than_one_loss": false, "_disable_preprocessor_api": false, "_disable_action_flattening": false, "_disable_initialize_loss_from_dummy_batch": false, "_dont_auto_sync_env_runner_states": false, "env_task_fn": -1, "enable_connectors": -1, "simple_optimizer": false, "policy_map_cache": -1, "worker_cls": -1, "synchronize_filters": -1, "enable_async_evaluation": -1, "custom_async_evaluation_function": -1, "_enable_rl_module_api": -1, "auto_wrap_old_gym_envs": -1, "always_attach_evaluation_results": -1, "replay_sequence_length": null, "_disable_execution_plan_api": -1, "use_critic": true, "use_gae": true, "use_kl_loss": true, "kl_coeff": 0.7464963036515, "kl_target": 0.0270990929592, "vf_loss_coeff": 0.6688075857018, "entropy_coeff": 0.0090570820258, "clip_param": 0.1221781641624, "vf_clip_param": 0.1027808522125, "entropy_coeff_schedule": null, "lr_schedule": null, "sgd_minibatch_size": -1, "vf_share_layers": -1, "__stdout_file__": null, "__stderr_file__": null, "lambda": 0.9099046732075, "input": "sampler", "policies": {"default_policy": [null, null, null, null]}, "callbacks": "<class 'ray.rllib.callbacks.callbacks.RLlibCallback'>", "create_env_on_driver": false, "custom_eval_function": null, "framework": "torch"}, "time_since_restore": 30.196657180786133, "iterations_since_restore": 17, "perf": {"cpu_util_percent": 49.03333333333333, "ram_util_percent": 80.36666666666666}}
{"timers": {"training_iteration": 1.8637758691492068, "restore_env_runners": 6.926488004391774e-05, "training_step": 1.8634621133831293, "env_runner_sampling_timer": 1.7452740009271133, "learner_update_timer": 0.11470186992092446, "synch_weights": 0.0006358903564117336, "restore_eval_env_runners": 8.624971226958265e-06, "evaluation_iteration": 0.11800782665120065, "synch_eval_env_connectors": 0.00013092713673999056, "synch_env_connectors": 4.615111457364542e-06}, "env_runners": {"env_to_module_connector": {"connector_pipeline_timer": 4.5259836425274286e-05, "timers": {"connectors": {"add_time_dim_to_batch_and_zero_pad": 2.530965498730709e-06, "batch_individual_items": 6.647617962557837e-06, "numpy_to_tensor": 9.164044658609515e-06, "add_observations_from_episodes_to_batch": 3.057901889929473e-06, "add_states_from_episodes_to_batch": 1.7754634163412338e-06}}}, "env_step_timer": 1.4655725733539075e-05, "num_agent_steps_sampled_lifetime": {"default_agent": -9870000.0}, "env_to_module_sum_episodes_length_out": 10.36823839457432, "module_to_env_connector": {"timers": {"connectors": {"normalize_and_clip_actions": 9.944270786502806e-06, "tensor_to_numpy": 1.3947608994544704e-05, "remove_single_ts_time_rank_from_batch": 6.036126222223221e-07, "un_batch_to_individual_items": 5.6572563629008855e-06, "get_actions": 4.213390359450451e-05, "listify_data_for_vector_env": 1.1513576377344777e-05}}, "connector_pipeline_timer": 0.00011033503922428309}, "num_agent_steps_sampled": {"default_agent": 5000.0}, "module_episode_returns_mean": {"default_policy": 10.980000000000002}, "env_reset_timer": 4.1409320326240504e-05, "episode_return_max": 12.5, "sample": 0.005236131740101008, "env_to_module_sum_episodes_length_in": 10.36823839457432, "num_module_steps_sampled_lifetime": {"default_policy": -9870000.0}, "episode_return_mean": 10.980000000000002, "episode_duration_sec_mean": 0.004806919506285339, "num_env_steps_sampled": 5000.0, "num_episodes": 250.0, "episode_len_mean": 20.0, "rlmodule_inference_timer": 2.9874825812120284e-05, "episode_len_min": 20, "episode_len_max": 20, "agent_episode_returns_mean": {"default_agent": 10.980000000000002}, "num_module_steps_sampled": {"default_policy": 5000.0}, "num_episodes_lifetime": -493500.0, "num_env_steps_sampled_lifetime": -9870000.0, "weights_seq_no": 17.0, "episode_return_min": -7.5, "time_between_sampling": 0.0015569141058078071, "num_env_steps_sampled_lifetime_throughput": 3535.468456468853}, "learners": {"default_policy": {"curr_kl_coeff": 2.847657469828846e-06, "gradients_default_optimizer_global_norm": 0.10874442011117935, "vf_loss": 0.10245733708143234, "total_loss": -0.03549296036362648, "num_module_steps_trained": 6000, "diff_num_grad_updates_vs_sampler_policy": 1.0, "module_train_batch_size_mean": 1000.0, "entropy": 0.36843931674957275, "num_module_steps_trained_lifetime": 108000, "curr_entropy_coeff": 0.0090570820258, "vf_loss_unclipped": 28.66659927368164, "weights_seq_no": 18.0, "default_optimizer_learning_rate": 0.0002847858517, "vf_explained_var": 0.015502631664276123, "mean_kl_loss": 0.0005068923346698284, "num_trainable_parameters": 6003, "policy_loss": -0.10068020969629288, "num_module_steps_trained_lifetime_throughput": 350938.65729571664}, "__all_modules__": {"learner_connector": {"timers": {"connectors": {"numpy_to_tensor": 6.309736715185259e-05, "batch_individual_items": 0.036102764246792915, "add_columns_from_episodes_to_train_batch": 0.03427541473732701, "add_time_dim_to_batch_and_zero_pad": 1.0083828666691484e-05, "add_one_ts_to_episodes_and_truncate": 0.008576462807313815, "add_observations_from_episodes_to_batch": 0.0008200545939130815, "general_advantage_estimation": 0.006709078740193355, "add_states_from_episodes_to_batch": 3.503216322376458e-06}}, "connector_pipeline_timer": 0.0866674239024459}, "num_env_steps_trained": 31500, "num_env_steps_trained_lifetime": 567000, "learner_connector_sum_episodes_length_out": 5250.0, "learner_connector_sum_episodes_length_in": 5000.0, "num_module_steps_trained_lifetime": 108000, "num_non_trainable_parameters": 0, "num_module_steps_trained": 6000, "num_trainable_parameters": 6003, "num_env_steps_trained_lifetime_throughput": 1837828.263273348, "num_module_steps_trained_throughput": 350882.8826853865, "num_module_steps_trained_lifetime_throughput": 350577.87811622914}}, "num_training_step_calls_per_iteration": 1, "evaluation": {"env_runners": {"sample": 0.10659460441648573, "env_to_module_sum_episodes_length_in": 10.368238394574323, "num_module_steps_sampled": {"default_policy": 400}, "module_to_env_connector": {"timers": {"connectors": {"tensor_to_numpy": 1.260068909042216e-05, "remove_single_ts_time_rank_from_batch": 5.978210831432441e-07, "listify_data_for_vector_env": 1.0782066512083922e-05, "normalize_and_clip_actions": 9.293656265599412e-06, "get_actions": 3.4520015047826546e-05, "un_batch_to_individual_items": 5.3331938701703595e-06}}, "connector_pipeline_timer": 9.89760119633614e-05}, "rlmodule_inference_timer": 2.7445231887150434e-05, "env_to_module_connector": {"timers": {"connectors": {"add_time_dim_to_batch_and_zero_pad": 2.2131870306285853e-06, "numpy_to_tensor": 8.294126491034575e-06, "add_states_from_episodes_to_batch": 1.6199501446367949e-06, "batch_individual_items": 6.394934676106835e-06, "add_observations_from_episodes_to_batch": 2.827243323454284e-06}}, "connector_pipeline_timer": 4.3174877720218816e-05}, "episode_len_max": 20, "num_agent_steps_sampled_lifetime": {"default_agent": 7200}, "num_episodes_lifetime": 360, "episode_return_min": -16.5, "env_step_timer": 1.3929741979080202e-05, "env_to_module_sum_episodes_length_out": 10.368238394574323, "num_env_steps_sampled": 400, "episode_len_mean": 20.0, "num_agent_steps_sampled": {"default_agent": 400}, "num_env_steps_sampled_lifetime": 90400, "weights_seq_no": 18.0, "module_episode_returns_mean": {"default_policy": 3.55}, "num_module_steps_sampled_lifetime": {"default_policy": 7200}, "num_episodes": 20, "episode_len_min": 20, "env_reset_timer": 0.0004889029027116893, "episode_return_max": 12.5, "agent_episode_returns_mean": {"default_agent": 3.55}, "episode_return_mean": 3.55, "episode_duration_sec_mean": 0.004751440057298169, "time_between_sampling": 1.741712972771951}, "num_healthy_workers": 1, "actor_manager_num_outstanding_async_reqs": 0, "num_remote_worker_restarts": 0}, "num_env_steps_sampled_lifetime": -9870000.0, "fault_tolerance": {"num_healthy_workers": 0, "num_remote_worker_restarts": 0}, "env_runner_group": {"actor_manager_num_outstanding_async_reqs": 0}, "done": false, "training_iteration": 18, "trial_id": "4da5b_00000", "date": "2025-08-11_19-22-07", "timestamp": 1754932927, "time_this_iter_s": 1.7585301399230957, "time_total_s": 31.95518732070923, "pid": 14327, "hostname": "Mac", "node_ip": "127.0.0.1", "config": {"exploration_config": {}, "extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "placement_strategy": "PACK", "num_gpus": 0, "_fake_gpus": false, "num_cpus_for_main_process": 2, "eager_tracing": true, "eager_max_retraces": 20, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "torch_compile_learner": false, "torch_compile_learner_what_to_compile": "forward_train", "torch_compile_learner_dynamo_backend": "aot_eager", "torch_compile_learner_dynamo_mode": null, "torch_compile_worker": false, "torch_compile_worker_dynamo_backend": "aot_eager", "torch_compile_worker_dynamo_mode": null, "torch_ddp_kwargs": {}, "torch_skip_nan_gradients": false, "env": "Umbrella", "env_config": {}, "observation_space": null, "action_space": null, "clip_rewards": null, "normalize_actions": true, "clip_actions": false, "_is_atari": null, "disable_env_checking": false, "render_env": false, "action_mask_key": "action_mask", "env_runner_cls": null, "num_env_runners": 0, "create_local_env_runner": true, "num_envs_per_env_runner": 1, "gym_env_vectorize_mode": "SYNC", "num_cpus_per_env_runner": 1, "num_gpus_per_env_runner": 0, "custom_resources_per_env_runner": {}, "validate_env_runners_after_construction": true, "episodes_to_numpy": true, "max_requests_in_flight_per_env_runner": 1, "sample_timeout_s": 60.0, "_env_to_module_connector": null, "add_default_connectors_to_env_to_module_pipeline": true, "_module_to_env_connector": null, "add_default_connectors_to_module_to_env_pipeline": true, "merge_env_runner_states": "training_only", "broadcast_env_runner_states": true, "episode_lookback_horizon": 1, "rollout_fragment_length": "auto", "batch_mode": "complete_episodes", "compress_observations": false, "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "enable_tf1_exec_eagerly": false, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "preprocessor_pref": "deepmind", "observation_filter": "NoFilter", "update_worker_filter_stats": true, "use_worker_filter_stats": true, "sampler_perf_stats_ema_coef": null, "_is_online": true, "num_learners": 0, "num_gpus_per_learner": 0, "num_cpus_per_learner": "auto", "num_aggregator_actors_per_learner": 0, "max_requests_in_flight_per_aggregator_actor": 3, "local_gpu_idx": 0, "max_requests_in_flight_per_learner": 3, "gamma": 1, "lr": 0.0002847858517, "grad_clip": 0.5, "grad_clip_by": "global_norm", "_train_batch_size_per_learner": 5000, "train_batch_size": 4000, "num_epochs": 1, "minibatch_size": 1000, "shuffle_batch_per_epoch": true, "model": {"fcnet_hiddens": [256, 256], "fcnet_activation": "tanh", "fcnet_weights_initializer": null, "fcnet_weights_initializer_config": null, "fcnet_bias_initializer": null, "fcnet_bias_initializer_config": null, "conv_filters": null, "conv_activation": "relu", "conv_kernel_initializer": null, "conv_kernel_initializer_config": null, "conv_bias_initializer": null, "conv_bias_initializer_config": null, "conv_transpose_kernel_initializer": null, "conv_transpose_kernel_initializer_config": null, "conv_transpose_bias_initializer": null, "conv_transpose_bias_initializer_config": null, "post_fcnet_hiddens": [], "post_fcnet_activation": "relu", "post_fcnet_weights_initializer": null, "post_fcnet_weights_initializer_config": null, "post_fcnet_bias_initializer": null, "post_fcnet_bias_initializer_config": null, "free_log_std": false, "log_std_clip_param": 20.0, "no_final_linear": false, "vf_share_layers": false, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "lstm_weights_initializer": null, "lstm_weights_initializer_config": null, "lstm_bias_initializer": null, "lstm_bias_initializer_config": null, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "attention_use_n_prev_actions": 0, "attention_use_n_prev_rewards": 0, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": null, "custom_model_config": {}, "custom_action_dist": null, "custom_preprocessor": null, "encoder_latent_dim": null, "always_check_shapes": false, "lstm_use_prev_action_reward": -1, "_use_default_native_models": -1, "_disable_preprocessor_api": false, "_disable_action_flattening": false}, "_learner_connector": null, "add_default_connectors_to_learner_pipeline": true, "learner_config_dict": {}, "optimizer": {}, "_learner_class": null, "callbacks_on_algorithm_init": null, "callbacks_on_env_runners_recreated": null, "callbacks_on_offline_eval_runners_recreated": null, "callbacks_on_checkpoint_loaded": null, "callbacks_on_environment_created": null, "callbacks_on_episode_created": null, "callbacks_on_episode_start": null, "callbacks_on_episode_step": null, "callbacks_on_episode_end": null, "callbacks_on_evaluate_start": null, "callbacks_on_evaluate_end": null, "callbacks_on_evaluate_offline_start": null, "callbacks_on_evaluate_offline_end": null, "callbacks_on_sample_end": null, "callbacks_on_train_result": null, "explore": true, "enable_rl_module_and_learner": true, "enable_env_runner_and_connector_v2": true, "_prior_exploration_config": {"type": "StochasticSampling"}, "count_steps_by": "env_steps", "policy_map_capacity": 100, "policy_mapping_fn": "<function AlgorithmConfig.DEFAULT_POLICY_MAPPING_FN at 0x383de9b20>", "policies_to_train": null, "policy_states_are_swappable": false, "observation_fn": null, "offline_data_class": null, "input_read_method": "read_parquet", "input_read_method_kwargs": {}, "input_read_schema": {}, "input_read_episodes": false, "input_read_sample_batches": false, "input_read_batch_size": null, "input_filesystem": null, "input_filesystem_kwargs": {}, "input_compress_columns": ["obs", "new_obs"], "input_spaces_jsonable": true, "materialize_data": false, "materialize_mapped_data": true, "map_batches_kwargs": {}, "iter_batches_kwargs": {}, "ignore_final_observation": false, "prelearner_class": null, "prelearner_buffer_class": null, "prelearner_buffer_kwargs": {}, "prelearner_module_synch_period": 10, "dataset_num_iters_per_learner": null, "input_config": {}, "actions_in_input_normalized": false, "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_config": {}, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "output_max_rows_per_file": null, "output_write_remaining_data": false, "output_write_method": "write_parquet", "output_write_method_kwargs": {}, "output_filesystem": null, "output_filesystem_kwargs": {}, "output_write_episodes": true, "offline_sampling": false, "evaluation_interval": 1, "evaluation_duration": 20, "evaluation_duration_unit": "episodes", "evaluation_sample_timeout_s": 120.0, "evaluation_auto_duration_min_env_steps_per_sample": 100, "evaluation_auto_duration_max_env_steps_per_sample": 2000, "evaluation_parallel_to_training": false, "evaluation_force_reset_envs_before_iteration": true, "evaluation_config": null, "off_policy_estimation_methods": {}, "ope_split_batch_by_episode": true, "evaluation_num_env_runners": 1, "in_evaluation": false, "sync_filters_on_rollout_workers_timeout_s": 10.0, "offline_evaluation_interval": null, "num_offline_eval_runners": 0, "offline_loss_for_module_fn": null, "offline_evaluation_duration": 1, "offline_evaluation_parallel_to_training": false, "offline_evaluation_timeout_s": 120.0, "num_cpus_per_offline_eval_runner": 1, "num_gpus_per_offline_eval_runner": 0, "custom_resources_per_offline_eval_runner": {}, "restart_failed_offline_eval_runners": true, "ignore_offline_eval_runner_failures": false, "max_num_offline_eval_runner_restarts": 1000, "offline_eval_runner_restore_timeout_s": 1800.0, "max_requests_in_flight_per_offline_eval_runner": 1, "validate_offline_eval_runners_after_construction": true, "offline_eval_runner_health_probe_timeout_s": 30.0, "offline_eval_rl_module_inference_only": false, "broadcast_offline_eval_runner_states": false, "offline_eval_batch_size_per_runner": 256, "dataset_num_iters_per_eval_runner": 1, "keep_per_episode_custom_metrics": false, "metrics_episode_collection_timeout_s": 60.0, "metrics_num_episodes_for_smoothing": 100, "min_time_s_per_iteration": null, "min_train_timesteps_per_iteration": 0, "min_sample_timesteps_per_iteration": 0, "log_gradients": true, "export_native_model_files": false, "checkpoint_trainable_policies_only": false, "logger_creator": null, "logger_config": null, "log_level": "WARN", "log_sys_usage": true, "fake_sampler": false, "seed": 4, "restart_failed_env_runners": true, "ignore_env_runner_failures": false, "max_num_env_runner_restarts": 1000, "delay_between_env_runner_restarts_s": 60.0, "restart_failed_sub_environments": false, "num_consecutive_env_runner_failures_tolerance": 100, "env_runner_health_probe_timeout_s": 30.0, "env_runner_restore_timeout_s": 1800.0, "_model_config": {}, "_rl_module_spec": "RLModuleSpec(module_class=None, observation_space=None, action_space=None, inference_only=False, learner_only=False, model_config=DefaultModelConfig(fcnet_hiddens=[60, 90], fcnet_activation='tanh', fcnet_kernel_initializer=None, fcnet_kernel_initializer_kwargs=None, fcnet_bias_initializer=None, fcnet_bias_initializer_kwargs=None, conv_filters=None, conv_activation='relu', conv_kernel_initializer=None, conv_kernel_initializer_kwargs=None, conv_bias_initializer=None, conv_bias_initializer_kwargs=None, head_fcnet_hiddens=[], head_fcnet_activation='relu', head_fcnet_kernel_initializer=None, head_fcnet_kernel_initializer_kwargs=None, head_fcnet_bias_initializer=None, head_fcnet_bias_initializer_kwargs=None, free_log_std=False, log_std_clip_param=20.0, vf_share_layers=True, use_lstm=False, max_seq_len=20, lstm_cell_size=256, lstm_use_prev_action=False, lstm_use_prev_reward=False, lstm_kernel_initializer=None, lstm_kernel_initializer_kwargs=None, lstm_bias_initializer=None, lstm_bias_initializer_kwargs=None), catalog_class=None, load_state_path=None, model_config_dict=None)", "algorithm_config_overrides_per_module": {}, "_per_module_overrides": {}, "_validate_config": true, "_use_msgpack_checkpoints": false, "_torch_grad_scaler_class": null, "_torch_lr_scheduler_classes": null, "_tf_policy_handles_more_than_one_loss": false, "_disable_preprocessor_api": false, "_disable_action_flattening": false, "_disable_initialize_loss_from_dummy_batch": false, "_dont_auto_sync_env_runner_states": false, "env_task_fn": -1, "enable_connectors": -1, "simple_optimizer": false, "policy_map_cache": -1, "worker_cls": -1, "synchronize_filters": -1, "enable_async_evaluation": -1, "custom_async_evaluation_function": -1, "_enable_rl_module_api": -1, "auto_wrap_old_gym_envs": -1, "always_attach_evaluation_results": -1, "replay_sequence_length": null, "_disable_execution_plan_api": -1, "use_critic": true, "use_gae": true, "use_kl_loss": true, "kl_coeff": 0.7464963036515, "kl_target": 0.0270990929592, "vf_loss_coeff": 0.6688075857018, "entropy_coeff": 0.0090570820258, "clip_param": 0.1221781641624, "vf_clip_param": 0.1027808522125, "entropy_coeff_schedule": null, "lr_schedule": null, "sgd_minibatch_size": -1, "vf_share_layers": -1, "__stdout_file__": null, "__stderr_file__": null, "lambda": 0.9099046732075, "input": "sampler", "policies": {"default_policy": [null, null, null, null]}, "callbacks": "<class 'ray.rllib.callbacks.callbacks.RLlibCallback'>", "create_env_on_driver": false, "custom_eval_function": null, "framework": "torch"}, "time_since_restore": 31.95518732070923, "iterations_since_restore": 18, "perf": {"cpu_util_percent": 45.35, "ram_util_percent": 80.35}}
{"timers": {"training_iteration": 1.862123998377733, "restore_env_runners": 6.863639121979703e-05, "training_step": 1.8618110009998614, "env_runner_sampling_timer": 1.7425798417477902, "learner_update_timer": 0.11573765122201585, "synch_weights": 0.000643321862859623, "restore_eval_env_runners": 8.595801111133646e-06, "evaluation_iteration": 0.11785714421480767, "synch_eval_env_connectors": 0.00013045952486633502, "synch_env_connectors": 4.608120128747041e-06}, "env_runners": {"env_to_module_connector": {"connector_pipeline_timer": 4.5899389250687335e-05, "timers": {"connectors": {"add_time_dim_to_batch_and_zero_pad": 2.545305736449563e-06, "batch_individual_items": 6.684316793915285e-06, "numpy_to_tensor": 9.14903285214596e-06, "add_observations_from_episodes_to_batch": 3.089646184861605e-06, "add_states_from_episodes_to_batch": 1.7970418093835495e-06}}}, "env_step_timer": 1.5055843399389121e-05, "num_agent_steps_sampled_lifetime": {"default_agent": -10487500.0}, "env_to_module_sum_episodes_length_out": 10.36823839457432, "module_to_env_connector": {"timers": {"connectors": {"normalize_and_clip_actions": 1.0026720487371568e-05, "tensor_to_numpy": 1.3957881848367424e-05, "remove_single_ts_time_rank_from_batch": 6.320292030082315e-07, "un_batch_to_individual_items": 5.719186585898168e-06, "get_actions": 4.1954348531685804e-05, "listify_data_for_vector_env": 1.172923372758089e-05}}, "connector_pipeline_timer": 0.00011091592862321488}, "num_agent_steps_sampled": {"default_agent": 5000.0}, "module_episode_returns_mean": {"default_policy": 10.66}, "env_reset_timer": 3.904236796741153e-05, "episode_return_max": 12.5, "sample": 0.005200991290425259, "env_to_module_sum_episodes_length_in": 10.36823839457432, "num_module_steps_sampled_lifetime": {"default_policy": -10487500.0}, "episode_return_mean": 10.66, "episode_duration_sec_mean": 0.004892314182594419, "num_env_steps_sampled": 5000.0, "num_episodes": 250.0, "episode_len_mean": 20.0, "rlmodule_inference_timer": 3.1779026449932036e-05, "episode_len_min": 20, "episode_len_max": 20, "agent_episode_returns_mean": {"default_agent": 10.66}, "num_module_steps_sampled": {"default_policy": 5000.0}, "num_episodes_lifetime": -524375.0, "num_env_steps_sampled_lifetime": -10487500.0, "weights_seq_no": 18.0, "episode_return_min": -7.5, "time_between_sampling": 0.0018699395013684875, "num_env_steps_sampled_lifetime_throughput": 3582.77749451539}, "learners": {"default_policy": {"curr_kl_coeff": 1.423828734914423e-06, "gradients_default_optimizer_global_norm": 0.07589247077703476, "vf_loss": 0.10224167257547379, "total_loss": 0.01614151895046234, "num_module_steps_trained": 6000, "diff_num_grad_updates_vs_sampler_policy": 1.0, "module_train_batch_size_mean": 1000.0, "entropy": 0.352801650762558, "num_module_steps_trained_lifetime": 114000, "curr_entropy_coeff": 0.0090570820258, "vf_loss_unclipped": 28.553913116455078, "weights_seq_no": 19.0, "default_optimizer_learning_rate": 0.0002847858517, "vf_explained_var": 0.018101215362548828, "mean_kl_loss": 0.0003655123873613775, "num_trainable_parameters": 6003, "policy_loss": -0.04904314875602722, "num_module_steps_trained_lifetime_throughput": 351093.84261761844}, "__all_modules__": {"learner_connector": {"timers": {"connectors": {"numpy_to_tensor": 6.33447226363007e-05, "batch_individual_items": 0.03721112910490993, "add_columns_from_episodes_to_train_batch": 0.0342976764194014, "add_time_dim_to_batch_and_zero_pad": 1.0107569908371228e-05, "add_one_ts_to_episodes_and_truncate": 0.00856836609892674, "add_observations_from_episodes_to_batch": 0.0008200990478911748, "general_advantage_estimation": 0.006717342952654033, "add_states_from_episodes_to_batch": 3.4998549474557112e-06}}, "connector_pipeline_timer": 0.08779866091364019}, "num_env_steps_trained": 31500, "num_env_steps_trained_lifetime": 598500, "learner_connector_sum_episodes_length_out": 5250.0, "learner_connector_sum_episodes_length_in": 5000.0, "num_module_steps_trained_lifetime": 114000, "num_non_trainable_parameters": 0, "num_module_steps_trained": 6000, "num_trainable_parameters": 6003, "num_env_steps_trained_lifetime_throughput": 1839032.236750224, "num_module_steps_trained_throughput": 351078.09492337145, "num_module_steps_trained_lifetime_throughput": 350782.41977162857}}, "num_training_step_calls_per_iteration": 1, "evaluation": {"env_runners": {"sample": 0.10659739962310408, "env_to_module_sum_episodes_length_in": 10.368238394574323, "num_module_steps_sampled": {"default_policy": 400}, "module_to_env_connector": {"timers": {"connectors": {"tensor_to_numpy": 1.4236098285987978e-05, "remove_single_ts_time_rank_from_batch": 6.220698214032777e-07, "listify_data_for_vector_env": 1.1650777325958259e-05, "normalize_and_clip_actions": 1.0004665413763484e-05, "get_actions": 4.153943532116845e-05, "un_batch_to_individual_items": 5.8216466811190764e-06}}, "connector_pipeline_timer": 0.00011231774539282807}, "rlmodule_inference_timer": 2.9890416560762647e-05, "env_to_module_connector": {"timers": {"connectors": {"add_time_dim_to_batch_and_zero_pad": 2.3702768550792027e-06, "numpy_to_tensor": 9.192657541015964e-06, "add_states_from_episodes_to_batch": 1.7019722520165196e-06, "batch_individual_items": 7.327668287399112e-06, "add_observations_from_episodes_to_batch": 3.0373320879660103e-06}}, "connector_pipeline_timer": 4.651897314358419e-05}, "episode_len_max": 20, "num_agent_steps_sampled_lifetime": {"default_agent": 7600}, "num_episodes_lifetime": 380, "episode_return_min": -16.5, "env_step_timer": 1.5301835921154702e-05, "env_to_module_sum_episodes_length_out": 10.368238394574323, "num_env_steps_sampled": 400, "episode_len_mean": 20.0, "num_agent_steps_sampled": {"default_agent": 400}, "num_env_steps_sampled_lifetime": 95400, "weights_seq_no": 19.0, "module_episode_returns_mean": {"default_policy": 2.35}, "num_module_steps_sampled_lifetime": {"default_policy": 7600}, "num_episodes": 20, "episode_len_min": 20, "env_reset_timer": 0.00048479929410049537, "episode_return_max": 12.5, "agent_episode_returns_mean": {"default_agent": 2.35}, "episode_return_mean": 2.35, "episode_duration_sec_mean": 0.004830957575468347, "time_between_sampling": 1.741474945543735}, "num_healthy_workers": 1, "actor_manager_num_outstanding_async_reqs": 0, "num_remote_worker_restarts": 0}, "num_env_steps_sampled_lifetime": -10487500.0, "fault_tolerance": {"num_healthy_workers": 0, "num_remote_worker_restarts": 0}, "env_runner_group": {"actor_manager_num_outstanding_async_reqs": 0}, "done": false, "training_iteration": 19, "trial_id": "4da5b_00000", "date": "2025-08-11_19-22-09", "timestamp": 1754932929, "time_this_iter_s": 1.814899206161499, "time_total_s": 33.77008652687073, "pid": 14327, "hostname": "Mac", "node_ip": "127.0.0.1", "config": {"exploration_config": {}, "extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "placement_strategy": "PACK", "num_gpus": 0, "_fake_gpus": false, "num_cpus_for_main_process": 2, "eager_tracing": true, "eager_max_retraces": 20, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "torch_compile_learner": false, "torch_compile_learner_what_to_compile": "forward_train", "torch_compile_learner_dynamo_backend": "aot_eager", "torch_compile_learner_dynamo_mode": null, "torch_compile_worker": false, "torch_compile_worker_dynamo_backend": "aot_eager", "torch_compile_worker_dynamo_mode": null, "torch_ddp_kwargs": {}, "torch_skip_nan_gradients": false, "env": "Umbrella", "env_config": {}, "observation_space": null, "action_space": null, "clip_rewards": null, "normalize_actions": true, "clip_actions": false, "_is_atari": null, "disable_env_checking": false, "render_env": false, "action_mask_key": "action_mask", "env_runner_cls": null, "num_env_runners": 0, "create_local_env_runner": true, "num_envs_per_env_runner": 1, "gym_env_vectorize_mode": "SYNC", "num_cpus_per_env_runner": 1, "num_gpus_per_env_runner": 0, "custom_resources_per_env_runner": {}, "validate_env_runners_after_construction": true, "episodes_to_numpy": true, "max_requests_in_flight_per_env_runner": 1, "sample_timeout_s": 60.0, "_env_to_module_connector": null, "add_default_connectors_to_env_to_module_pipeline": true, "_module_to_env_connector": null, "add_default_connectors_to_module_to_env_pipeline": true, "merge_env_runner_states": "training_only", "broadcast_env_runner_states": true, "episode_lookback_horizon": 1, "rollout_fragment_length": "auto", "batch_mode": "complete_episodes", "compress_observations": false, "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "enable_tf1_exec_eagerly": false, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "preprocessor_pref": "deepmind", "observation_filter": "NoFilter", "update_worker_filter_stats": true, "use_worker_filter_stats": true, "sampler_perf_stats_ema_coef": null, "_is_online": true, "num_learners": 0, "num_gpus_per_learner": 0, "num_cpus_per_learner": "auto", "num_aggregator_actors_per_learner": 0, "max_requests_in_flight_per_aggregator_actor": 3, "local_gpu_idx": 0, "max_requests_in_flight_per_learner": 3, "gamma": 1, "lr": 0.0002847858517, "grad_clip": 0.5, "grad_clip_by": "global_norm", "_train_batch_size_per_learner": 5000, "train_batch_size": 4000, "num_epochs": 1, "minibatch_size": 1000, "shuffle_batch_per_epoch": true, "model": {"fcnet_hiddens": [256, 256], "fcnet_activation": "tanh", "fcnet_weights_initializer": null, "fcnet_weights_initializer_config": null, "fcnet_bias_initializer": null, "fcnet_bias_initializer_config": null, "conv_filters": null, "conv_activation": "relu", "conv_kernel_initializer": null, "conv_kernel_initializer_config": null, "conv_bias_initializer": null, "conv_bias_initializer_config": null, "conv_transpose_kernel_initializer": null, "conv_transpose_kernel_initializer_config": null, "conv_transpose_bias_initializer": null, "conv_transpose_bias_initializer_config": null, "post_fcnet_hiddens": [], "post_fcnet_activation": "relu", "post_fcnet_weights_initializer": null, "post_fcnet_weights_initializer_config": null, "post_fcnet_bias_initializer": null, "post_fcnet_bias_initializer_config": null, "free_log_std": false, "log_std_clip_param": 20.0, "no_final_linear": false, "vf_share_layers": false, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "lstm_weights_initializer": null, "lstm_weights_initializer_config": null, "lstm_bias_initializer": null, "lstm_bias_initializer_config": null, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "attention_use_n_prev_actions": 0, "attention_use_n_prev_rewards": 0, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": null, "custom_model_config": {}, "custom_action_dist": null, "custom_preprocessor": null, "encoder_latent_dim": null, "always_check_shapes": false, "lstm_use_prev_action_reward": -1, "_use_default_native_models": -1, "_disable_preprocessor_api": false, "_disable_action_flattening": false}, "_learner_connector": null, "add_default_connectors_to_learner_pipeline": true, "learner_config_dict": {}, "optimizer": {}, "_learner_class": null, "callbacks_on_algorithm_init": null, "callbacks_on_env_runners_recreated": null, "callbacks_on_offline_eval_runners_recreated": null, "callbacks_on_checkpoint_loaded": null, "callbacks_on_environment_created": null, "callbacks_on_episode_created": null, "callbacks_on_episode_start": null, "callbacks_on_episode_step": null, "callbacks_on_episode_end": null, "callbacks_on_evaluate_start": null, "callbacks_on_evaluate_end": null, "callbacks_on_evaluate_offline_start": null, "callbacks_on_evaluate_offline_end": null, "callbacks_on_sample_end": null, "callbacks_on_train_result": null, "explore": true, "enable_rl_module_and_learner": true, "enable_env_runner_and_connector_v2": true, "_prior_exploration_config": {"type": "StochasticSampling"}, "count_steps_by": "env_steps", "policy_map_capacity": 100, "policy_mapping_fn": "<function AlgorithmConfig.DEFAULT_POLICY_MAPPING_FN at 0x383de9b20>", "policies_to_train": null, "policy_states_are_swappable": false, "observation_fn": null, "offline_data_class": null, "input_read_method": "read_parquet", "input_read_method_kwargs": {}, "input_read_schema": {}, "input_read_episodes": false, "input_read_sample_batches": false, "input_read_batch_size": null, "input_filesystem": null, "input_filesystem_kwargs": {}, "input_compress_columns": ["obs", "new_obs"], "input_spaces_jsonable": true, "materialize_data": false, "materialize_mapped_data": true, "map_batches_kwargs": {}, "iter_batches_kwargs": {}, "ignore_final_observation": false, "prelearner_class": null, "prelearner_buffer_class": null, "prelearner_buffer_kwargs": {}, "prelearner_module_synch_period": 10, "dataset_num_iters_per_learner": null, "input_config": {}, "actions_in_input_normalized": false, "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_config": {}, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "output_max_rows_per_file": null, "output_write_remaining_data": false, "output_write_method": "write_parquet", "output_write_method_kwargs": {}, "output_filesystem": null, "output_filesystem_kwargs": {}, "output_write_episodes": true, "offline_sampling": false, "evaluation_interval": 1, "evaluation_duration": 20, "evaluation_duration_unit": "episodes", "evaluation_sample_timeout_s": 120.0, "evaluation_auto_duration_min_env_steps_per_sample": 100, "evaluation_auto_duration_max_env_steps_per_sample": 2000, "evaluation_parallel_to_training": false, "evaluation_force_reset_envs_before_iteration": true, "evaluation_config": null, "off_policy_estimation_methods": {}, "ope_split_batch_by_episode": true, "evaluation_num_env_runners": 1, "in_evaluation": false, "sync_filters_on_rollout_workers_timeout_s": 10.0, "offline_evaluation_interval": null, "num_offline_eval_runners": 0, "offline_loss_for_module_fn": null, "offline_evaluation_duration": 1, "offline_evaluation_parallel_to_training": false, "offline_evaluation_timeout_s": 120.0, "num_cpus_per_offline_eval_runner": 1, "num_gpus_per_offline_eval_runner": 0, "custom_resources_per_offline_eval_runner": {}, "restart_failed_offline_eval_runners": true, "ignore_offline_eval_runner_failures": false, "max_num_offline_eval_runner_restarts": 1000, "offline_eval_runner_restore_timeout_s": 1800.0, "max_requests_in_flight_per_offline_eval_runner": 1, "validate_offline_eval_runners_after_construction": true, "offline_eval_runner_health_probe_timeout_s": 30.0, "offline_eval_rl_module_inference_only": false, "broadcast_offline_eval_runner_states": false, "offline_eval_batch_size_per_runner": 256, "dataset_num_iters_per_eval_runner": 1, "keep_per_episode_custom_metrics": false, "metrics_episode_collection_timeout_s": 60.0, "metrics_num_episodes_for_smoothing": 100, "min_time_s_per_iteration": null, "min_train_timesteps_per_iteration": 0, "min_sample_timesteps_per_iteration": 0, "log_gradients": true, "export_native_model_files": false, "checkpoint_trainable_policies_only": false, "logger_creator": null, "logger_config": null, "log_level": "WARN", "log_sys_usage": true, "fake_sampler": false, "seed": 4, "restart_failed_env_runners": true, "ignore_env_runner_failures": false, "max_num_env_runner_restarts": 1000, "delay_between_env_runner_restarts_s": 60.0, "restart_failed_sub_environments": false, "num_consecutive_env_runner_failures_tolerance": 100, "env_runner_health_probe_timeout_s": 30.0, "env_runner_restore_timeout_s": 1800.0, "_model_config": {}, "_rl_module_spec": "RLModuleSpec(module_class=None, observation_space=None, action_space=None, inference_only=False, learner_only=False, model_config=DefaultModelConfig(fcnet_hiddens=[60, 90], fcnet_activation='tanh', fcnet_kernel_initializer=None, fcnet_kernel_initializer_kwargs=None, fcnet_bias_initializer=None, fcnet_bias_initializer_kwargs=None, conv_filters=None, conv_activation='relu', conv_kernel_initializer=None, conv_kernel_initializer_kwargs=None, conv_bias_initializer=None, conv_bias_initializer_kwargs=None, head_fcnet_hiddens=[], head_fcnet_activation='relu', head_fcnet_kernel_initializer=None, head_fcnet_kernel_initializer_kwargs=None, head_fcnet_bias_initializer=None, head_fcnet_bias_initializer_kwargs=None, free_log_std=False, log_std_clip_param=20.0, vf_share_layers=True, use_lstm=False, max_seq_len=20, lstm_cell_size=256, lstm_use_prev_action=False, lstm_use_prev_reward=False, lstm_kernel_initializer=None, lstm_kernel_initializer_kwargs=None, lstm_bias_initializer=None, lstm_bias_initializer_kwargs=None), catalog_class=None, load_state_path=None, model_config_dict=None)", "algorithm_config_overrides_per_module": {}, "_per_module_overrides": {}, "_validate_config": true, "_use_msgpack_checkpoints": false, "_torch_grad_scaler_class": null, "_torch_lr_scheduler_classes": null, "_tf_policy_handles_more_than_one_loss": false, "_disable_preprocessor_api": false, "_disable_action_flattening": false, "_disable_initialize_loss_from_dummy_batch": false, "_dont_auto_sync_env_runner_states": false, "env_task_fn": -1, "enable_connectors": -1, "simple_optimizer": false, "policy_map_cache": -1, "worker_cls": -1, "synchronize_filters": -1, "enable_async_evaluation": -1, "custom_async_evaluation_function": -1, "_enable_rl_module_api": -1, "auto_wrap_old_gym_envs": -1, "always_attach_evaluation_results": -1, "replay_sequence_length": null, "_disable_execution_plan_api": -1, "use_critic": true, "use_gae": true, "use_kl_loss": true, "kl_coeff": 0.7464963036515, "kl_target": 0.0270990929592, "vf_loss_coeff": 0.6688075857018, "entropy_coeff": 0.0090570820258, "clip_param": 0.1221781641624, "vf_clip_param": 0.1027808522125, "entropy_coeff_schedule": null, "lr_schedule": null, "sgd_minibatch_size": -1, "vf_share_layers": -1, "__stdout_file__": null, "__stderr_file__": null, "lambda": 0.9099046732075, "input": "sampler", "policies": {"default_policy": [null, null, null, null]}, "callbacks": "<class 'ray.rllib.callbacks.callbacks.RLlibCallback'>", "create_env_on_driver": false, "custom_eval_function": null, "framework": "torch"}, "time_since_restore": 33.77008652687073, "iterations_since_restore": 19, "perf": {"cpu_util_percent": 44.03333333333333, "ram_util_percent": 79.60000000000001}}
{"timers": {"training_iteration": 1.8590912754747153, "restore_env_runners": 6.800793694528865e-05, "training_step": 1.8587794443199304, "env_runner_sampling_timer": 1.7397581229209569, "learner_update_timer": 0.11552920303895799, "synch_weights": 0.0006439657237301672, "restore_eval_env_runners": 8.579432686950797e-06, "evaluation_iteration": 0.11781392444216857, "synch_eval_env_connectors": 0.00013056909987355618, "synch_env_connectors": 4.599538630926463e-06}, "env_runners": {"env_to_module_connector": {"connector_pipeline_timer": 4.5369482537866366e-05, "timers": {"connectors": {"add_time_dim_to_batch_and_zero_pad": 2.5546448623150856e-06, "batch_individual_items": 6.584750090199534e-06, "numpy_to_tensor": 9.099735143333256e-06, "add_observations_from_episodes_to_batch": 3.033508655950851e-06, "add_states_from_episodes_to_batch": 1.786195550579277e-06}}}, "env_step_timer": 1.4592733298246562e-05, "num_agent_steps_sampled_lifetime": {"default_agent": -11105000.0}, "env_to_module_sum_episodes_length_out": 10.36823839457432, "module_to_env_connector": {"timers": {"connectors": {"normalize_and_clip_actions": 9.84369642099376e-06, "tensor_to_numpy": 1.3814469171391735e-05, "remove_single_ts_time_rank_from_batch": 5.960742849120284e-07, "un_batch_to_individual_items": 5.5867912469246375e-06, "get_actions": 4.2114279438833804e-05, "listify_data_for_vector_env": 1.1520071738064168e-05}}, "connector_pipeline_timer": 0.00010980396318163797}, "num_agent_steps_sampled": {"default_agent": 5000.0}, "module_episode_returns_mean": {"default_policy": 10.66}, "env_reset_timer": 4.24155021868898e-05, "episode_return_max": 12.5, "sample": 0.005205522218276609, "env_to_module_sum_episodes_length_in": 10.36823839457432, "num_module_steps_sampled_lifetime": {"default_policy": -11105000.0}, "episode_return_mean": 10.66, "episode_duration_sec_mean": 0.004795149313285946, "num_env_steps_sampled": 5000.0, "num_episodes": 250.0, "episode_len_mean": 20.0, "rlmodule_inference_timer": 2.9939018160118573e-05, "episode_len_min": 20, "episode_len_max": 20, "agent_episode_returns_mean": {"default_agent": 10.66}, "num_module_steps_sampled": {"default_policy": 5000.0}, "num_episodes_lifetime": -555250.0, "num_env_steps_sampled_lifetime": -11105000.0, "weights_seq_no": 19.0, "episode_return_min": -7.5, "time_between_sampling": 0.0020593969279709607, "num_env_steps_sampled_lifetime_throughput": 3510.663567013946}, "learners": {"default_policy": {"curr_kl_coeff": 7.119143674572115e-07, "gradients_default_optimizer_global_norm": 0.03212713077664375, "vf_loss": 0.10234948992729187, "total_loss": 0.03985561802983284, "num_module_steps_trained": 6000, "diff_num_grad_updates_vs_sampler_policy": 1.0, "module_train_batch_size_mean": 1000.0, "entropy": 0.33666831254959106, "num_module_steps_trained_lifetime": 120000, "curr_entropy_coeff": 0.0090570820258, "vf_loss_unclipped": 28.65300178527832, "weights_seq_no": 20.0, "default_optimizer_learning_rate": 0.0002847858517, "vf_explained_var": 0.018335282802581787, "mean_kl_loss": 0.00021589340758509934, "num_trainable_parameters": 6003, "policy_loss": -0.025547273457050323, "num_module_steps_trained_lifetime_throughput": 352307.9114486958}, "__all_modules__": {"learner_connector": {"timers": {"connectors": {"numpy_to_tensor": 6.356461601707419e-05, "batch_individual_items": 0.037161078643354974, "add_columns_from_episodes_to_train_batch": 0.03429655256555839, "add_time_dim_to_batch_and_zero_pad": 1.0159834142891516e-05, "add_one_ts_to_episodes_and_truncate": 0.008560207847807321, "add_observations_from_episodes_to_batch": 0.0008203159783202223, "general_advantage_estimation": 0.006706189933393266, "add_states_from_episodes_to_batch": 3.4965260221309535e-06}}, "connector_pipeline_timer": 0.08772863014347648}, "num_env_steps_trained": 31500, "num_env_steps_trained_lifetime": 630000, "learner_connector_sum_episodes_length_out": 5250.0, "learner_connector_sum_episodes_length_in": 5000.0, "num_module_steps_trained_lifetime": 120000, "num_non_trainable_parameters": 0, "num_module_steps_trained": 6000, "num_trainable_parameters": 6003, "num_env_steps_trained_lifetime_throughput": 1845778.8381079817, "num_module_steps_trained_throughput": 352332.4197689937, "num_module_steps_trained_lifetime_throughput": 352044.2171403098}}, "num_training_step_calls_per_iteration": 1, "evaluation": {"env_runners": {"sample": 0.10656944479622785, "env_to_module_sum_episodes_length_in": 10.368238394574323, "num_module_steps_sampled": {"default_policy": 400}, "module_to_env_connector": {"timers": {"connectors": {"tensor_to_numpy": 1.383015165153796e-05, "remove_single_ts_time_rank_from_batch": 6.235845784122408e-07, "listify_data_for_vector_env": 1.1815891886801527e-05, "normalize_and_clip_actions": 1.0088964893192385e-05, "get_actions": 4.058152801652233e-05, "un_batch_to_individual_items": 5.687972211813843e-06}}, "connector_pipeline_timer": 0.00011071160835028716}, "rlmodule_inference_timer": 3.16933077521635e-05, "env_to_module_connector": {"timers": {"connectors": {"add_time_dim_to_batch_and_zero_pad": 2.386149686567938e-06, "numpy_to_tensor": 1.0185762700623527e-05, "add_states_from_episodes_to_batch": 1.803304086093971e-06, "batch_individual_items": 6.859329670486159e-06, "add_observations_from_episodes_to_batch": 3.0276090867400037e-06}}, "connector_pipeline_timer": 4.7546599550051744e-05}, "episode_len_max": 20, "num_agent_steps_sampled_lifetime": {"default_agent": 8000}, "num_episodes_lifetime": 400, "episode_return_min": -16.5, "env_step_timer": 1.562644091671748e-05, "env_to_module_sum_episodes_length_out": 10.368238394574323, "num_env_steps_sampled": 400, "episode_len_mean": 20.0, "num_agent_steps_sampled": {"default_agent": 400}, "num_env_steps_sampled_lifetime": 100400, "weights_seq_no": 20.0, "module_episode_returns_mean": {"default_policy": 1.95}, "num_module_steps_sampled_lifetime": {"default_policy": 8000}, "num_episodes": 20, "episode_len_min": 20, "env_reset_timer": 0.0004807408810948623, "episode_return_max": 12.5, "agent_episode_returns_mean": {"default_agent": 1.95}, "episode_return_mean": 1.95, "episode_duration_sec_mean": 0.004887109199771657, "time_between_sampling": 1.7398242198383869}, "num_healthy_workers": 1, "actor_manager_num_outstanding_async_reqs": 0, "num_remote_worker_restarts": 0}, "num_env_steps_sampled_lifetime": -11105000.0, "fault_tolerance": {"num_healthy_workers": 0, "num_remote_worker_restarts": 0}, "env_runner_group": {"actor_manager_num_outstanding_async_reqs": 0}, "done": true, "training_iteration": 20, "trial_id": "4da5b_00000", "date": "2025-08-11_19-22-11", "timestamp": 1754932931, "time_this_iter_s": 1.6707041263580322, "time_total_s": 35.44079065322876, "pid": 14327, "hostname": "Mac", "node_ip": "127.0.0.1", "config": {"exploration_config": {}, "extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "placement_strategy": "PACK", "num_gpus": 0, "_fake_gpus": false, "num_cpus_for_main_process": 2, "eager_tracing": true, "eager_max_retraces": 20, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "torch_compile_learner": false, "torch_compile_learner_what_to_compile": "forward_train", "torch_compile_learner_dynamo_backend": "aot_eager", "torch_compile_learner_dynamo_mode": null, "torch_compile_worker": false, "torch_compile_worker_dynamo_backend": "aot_eager", "torch_compile_worker_dynamo_mode": null, "torch_ddp_kwargs": {}, "torch_skip_nan_gradients": false, "env": "Umbrella", "env_config": {}, "observation_space": null, "action_space": null, "clip_rewards": null, "normalize_actions": true, "clip_actions": false, "_is_atari": null, "disable_env_checking": false, "render_env": false, "action_mask_key": "action_mask", "env_runner_cls": null, "num_env_runners": 0, "create_local_env_runner": true, "num_envs_per_env_runner": 1, "gym_env_vectorize_mode": "SYNC", "num_cpus_per_env_runner": 1, "num_gpus_per_env_runner": 0, "custom_resources_per_env_runner": {}, "validate_env_runners_after_construction": true, "episodes_to_numpy": true, "max_requests_in_flight_per_env_runner": 1, "sample_timeout_s": 60.0, "_env_to_module_connector": null, "add_default_connectors_to_env_to_module_pipeline": true, "_module_to_env_connector": null, "add_default_connectors_to_module_to_env_pipeline": true, "merge_env_runner_states": "training_only", "broadcast_env_runner_states": true, "episode_lookback_horizon": 1, "rollout_fragment_length": "auto", "batch_mode": "complete_episodes", "compress_observations": false, "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "enable_tf1_exec_eagerly": false, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "preprocessor_pref": "deepmind", "observation_filter": "NoFilter", "update_worker_filter_stats": true, "use_worker_filter_stats": true, "sampler_perf_stats_ema_coef": null, "_is_online": true, "num_learners": 0, "num_gpus_per_learner": 0, "num_cpus_per_learner": "auto", "num_aggregator_actors_per_learner": 0, "max_requests_in_flight_per_aggregator_actor": 3, "local_gpu_idx": 0, "max_requests_in_flight_per_learner": 3, "gamma": 1, "lr": 0.0002847858517, "grad_clip": 0.5, "grad_clip_by": "global_norm", "_train_batch_size_per_learner": 5000, "train_batch_size": 4000, "num_epochs": 1, "minibatch_size": 1000, "shuffle_batch_per_epoch": true, "model": {"fcnet_hiddens": [256, 256], "fcnet_activation": "tanh", "fcnet_weights_initializer": null, "fcnet_weights_initializer_config": null, "fcnet_bias_initializer": null, "fcnet_bias_initializer_config": null, "conv_filters": null, "conv_activation": "relu", "conv_kernel_initializer": null, "conv_kernel_initializer_config": null, "conv_bias_initializer": null, "conv_bias_initializer_config": null, "conv_transpose_kernel_initializer": null, "conv_transpose_kernel_initializer_config": null, "conv_transpose_bias_initializer": null, "conv_transpose_bias_initializer_config": null, "post_fcnet_hiddens": [], "post_fcnet_activation": "relu", "post_fcnet_weights_initializer": null, "post_fcnet_weights_initializer_config": null, "post_fcnet_bias_initializer": null, "post_fcnet_bias_initializer_config": null, "free_log_std": false, "log_std_clip_param": 20.0, "no_final_linear": false, "vf_share_layers": false, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "lstm_weights_initializer": null, "lstm_weights_initializer_config": null, "lstm_bias_initializer": null, "lstm_bias_initializer_config": null, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "attention_use_n_prev_actions": 0, "attention_use_n_prev_rewards": 0, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": null, "custom_model_config": {}, "custom_action_dist": null, "custom_preprocessor": null, "encoder_latent_dim": null, "always_check_shapes": false, "lstm_use_prev_action_reward": -1, "_use_default_native_models": -1, "_disable_preprocessor_api": false, "_disable_action_flattening": false}, "_learner_connector": null, "add_default_connectors_to_learner_pipeline": true, "learner_config_dict": {}, "optimizer": {}, "_learner_class": null, "callbacks_on_algorithm_init": null, "callbacks_on_env_runners_recreated": null, "callbacks_on_offline_eval_runners_recreated": null, "callbacks_on_checkpoint_loaded": null, "callbacks_on_environment_created": null, "callbacks_on_episode_created": null, "callbacks_on_episode_start": null, "callbacks_on_episode_step": null, "callbacks_on_episode_end": null, "callbacks_on_evaluate_start": null, "callbacks_on_evaluate_end": null, "callbacks_on_evaluate_offline_start": null, "callbacks_on_evaluate_offline_end": null, "callbacks_on_sample_end": null, "callbacks_on_train_result": null, "explore": true, "enable_rl_module_and_learner": true, "enable_env_runner_and_connector_v2": true, "_prior_exploration_config": {"type": "StochasticSampling"}, "count_steps_by": "env_steps", "policy_map_capacity": 100, "policy_mapping_fn": "<function AlgorithmConfig.DEFAULT_POLICY_MAPPING_FN at 0x383de9b20>", "policies_to_train": null, "policy_states_are_swappable": false, "observation_fn": null, "offline_data_class": null, "input_read_method": "read_parquet", "input_read_method_kwargs": {}, "input_read_schema": {}, "input_read_episodes": false, "input_read_sample_batches": false, "input_read_batch_size": null, "input_filesystem": null, "input_filesystem_kwargs": {}, "input_compress_columns": ["obs", "new_obs"], "input_spaces_jsonable": true, "materialize_data": false, "materialize_mapped_data": true, "map_batches_kwargs": {}, "iter_batches_kwargs": {}, "ignore_final_observation": false, "prelearner_class": null, "prelearner_buffer_class": null, "prelearner_buffer_kwargs": {}, "prelearner_module_synch_period": 10, "dataset_num_iters_per_learner": null, "input_config": {}, "actions_in_input_normalized": false, "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_config": {}, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "output_max_rows_per_file": null, "output_write_remaining_data": false, "output_write_method": "write_parquet", "output_write_method_kwargs": {}, "output_filesystem": null, "output_filesystem_kwargs": {}, "output_write_episodes": true, "offline_sampling": false, "evaluation_interval": 1, "evaluation_duration": 20, "evaluation_duration_unit": "episodes", "evaluation_sample_timeout_s": 120.0, "evaluation_auto_duration_min_env_steps_per_sample": 100, "evaluation_auto_duration_max_env_steps_per_sample": 2000, "evaluation_parallel_to_training": false, "evaluation_force_reset_envs_before_iteration": true, "evaluation_config": null, "off_policy_estimation_methods": {}, "ope_split_batch_by_episode": true, "evaluation_num_env_runners": 1, "in_evaluation": false, "sync_filters_on_rollout_workers_timeout_s": 10.0, "offline_evaluation_interval": null, "num_offline_eval_runners": 0, "offline_loss_for_module_fn": null, "offline_evaluation_duration": 1, "offline_evaluation_parallel_to_training": false, "offline_evaluation_timeout_s": 120.0, "num_cpus_per_offline_eval_runner": 1, "num_gpus_per_offline_eval_runner": 0, "custom_resources_per_offline_eval_runner": {}, "restart_failed_offline_eval_runners": true, "ignore_offline_eval_runner_failures": false, "max_num_offline_eval_runner_restarts": 1000, "offline_eval_runner_restore_timeout_s": 1800.0, "max_requests_in_flight_per_offline_eval_runner": 1, "validate_offline_eval_runners_after_construction": true, "offline_eval_runner_health_probe_timeout_s": 30.0, "offline_eval_rl_module_inference_only": false, "broadcast_offline_eval_runner_states": false, "offline_eval_batch_size_per_runner": 256, "dataset_num_iters_per_eval_runner": 1, "keep_per_episode_custom_metrics": false, "metrics_episode_collection_timeout_s": 60.0, "metrics_num_episodes_for_smoothing": 100, "min_time_s_per_iteration": null, "min_train_timesteps_per_iteration": 0, "min_sample_timesteps_per_iteration": 0, "log_gradients": true, "export_native_model_files": false, "checkpoint_trainable_policies_only": false, "logger_creator": null, "logger_config": null, "log_level": "WARN", "log_sys_usage": true, "fake_sampler": false, "seed": 4, "restart_failed_env_runners": true, "ignore_env_runner_failures": false, "max_num_env_runner_restarts": 1000, "delay_between_env_runner_restarts_s": 60.0, "restart_failed_sub_environments": false, "num_consecutive_env_runner_failures_tolerance": 100, "env_runner_health_probe_timeout_s": 30.0, "env_runner_restore_timeout_s": 1800.0, "_model_config": {}, "_rl_module_spec": "RLModuleSpec(module_class=None, observation_space=None, action_space=None, inference_only=False, learner_only=False, model_config=DefaultModelConfig(fcnet_hiddens=[60, 90], fcnet_activation='tanh', fcnet_kernel_initializer=None, fcnet_kernel_initializer_kwargs=None, fcnet_bias_initializer=None, fcnet_bias_initializer_kwargs=None, conv_filters=None, conv_activation='relu', conv_kernel_initializer=None, conv_kernel_initializer_kwargs=None, conv_bias_initializer=None, conv_bias_initializer_kwargs=None, head_fcnet_hiddens=[], head_fcnet_activation='relu', head_fcnet_kernel_initializer=None, head_fcnet_kernel_initializer_kwargs=None, head_fcnet_bias_initializer=None, head_fcnet_bias_initializer_kwargs=None, free_log_std=False, log_std_clip_param=20.0, vf_share_layers=True, use_lstm=False, max_seq_len=20, lstm_cell_size=256, lstm_use_prev_action=False, lstm_use_prev_reward=False, lstm_kernel_initializer=None, lstm_kernel_initializer_kwargs=None, lstm_bias_initializer=None, lstm_bias_initializer_kwargs=None), catalog_class=None, load_state_path=None, model_config_dict=None)", "algorithm_config_overrides_per_module": {}, "_per_module_overrides": {}, "_validate_config": true, "_use_msgpack_checkpoints": false, "_torch_grad_scaler_class": null, "_torch_lr_scheduler_classes": null, "_tf_policy_handles_more_than_one_loss": false, "_disable_preprocessor_api": false, "_disable_action_flattening": false, "_disable_initialize_loss_from_dummy_batch": false, "_dont_auto_sync_env_runner_states": false, "env_task_fn": -1, "enable_connectors": -1, "simple_optimizer": false, "policy_map_cache": -1, "worker_cls": -1, "synchronize_filters": -1, "enable_async_evaluation": -1, "custom_async_evaluation_function": -1, "_enable_rl_module_api": -1, "auto_wrap_old_gym_envs": -1, "always_attach_evaluation_results": -1, "replay_sequence_length": null, "_disable_execution_plan_api": -1, "use_critic": true, "use_gae": true, "use_kl_loss": true, "kl_coeff": 0.7464963036515, "kl_target": 0.0270990929592, "vf_loss_coeff": 0.6688075857018, "entropy_coeff": 0.0090570820258, "clip_param": 0.1221781641624, "vf_clip_param": 0.1027808522125, "entropy_coeff_schedule": null, "lr_schedule": null, "sgd_minibatch_size": -1, "vf_share_layers": -1, "__stdout_file__": null, "__stderr_file__": null, "lambda": 0.9099046732075, "input": "sampler", "policies": {"default_policy": [null, null, null, null]}, "callbacks": "<class 'ray.rllib.callbacks.callbacks.RLlibCallback'>", "create_env_on_driver": false, "custom_eval_function": null, "framework": "torch"}, "time_since_restore": 35.44079065322876, "iterations_since_restore": 20, "perf": {"cpu_util_percent": 39.75, "ram_util_percent": 78.94999999999999}}
