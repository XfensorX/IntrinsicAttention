{"timers": {"training_iteration": 1.7338486249791458, "restore_env_runners": 1.8625054508447647e-05, "training_step": 1.7337061669677496, "env_runner_sampling_timer": 1.6074059170205146, "learner_update_timer": 0.12272520805709064, "synch_weights": 0.0008618750143796206}, "env_runners": {"num_episodes": 250.0, "num_agent_steps_sampled": {"default_agent": 5000.0}, "weights_seq_no": 0.0, "num_agent_steps_sampled_lifetime": {"default_agent": 627500.0}, "num_episodes_lifetime": 31375.0, "env_to_module_connector": {"timers": {"connectors": {"add_states_from_episodes_to_batch": 1.801703006606534e-06, "add_time_dim_to_batch_and_zero_pad": 2.62753479359532e-06, "numpy_to_tensor": 9.931903476770835e-06, "batch_individual_items": 6.988377957943194e-06, "add_observations_from_episodes_to_batch": 3.452789148116454e-06}}, "connector_pipeline_timer": 4.932365595959094e-05}, "sample": 0.006056508097359913, "num_module_steps_sampled": {"default_policy": 5000.0}, "rlmodule_inference_timer": 5.759945576541991e-05, "episode_return_max": 10.5, "agent_episode_returns_mean": {"default_agent": -0.14000000000000007}, "episode_len_mean": 20.0, "time_between_sampling": 0.000568066248267095, "env_step_timer": 1.5614072678569448e-05, "env_to_module_sum_episodes_length_out": 10.191744832559449, "env_reset_timer": 0.00010312598357110667, "module_to_env_connector": {"timers": {"connectors": {"listify_data_for_vector_env": 1.1845995818127248e-05, "normalize_and_clip_actions": 1.3491600694112377e-05, "get_actions": 5.000086171606127e-05, "un_batch_to_individual_items": 5.907604409881726e-06, "tensor_to_numpy": 1.4477854233071463e-05, "remove_single_ts_time_rank_from_batch": 6.218732352125131e-07}}, "connector_pipeline_timer": 0.00012359099664471869}, "episode_duration_sec_mean": 0.005371556149795651, "num_module_steps_sampled_lifetime": {"default_policy": 627500.0}, "episode_len_min": 20, "episode_return_mean": -0.14000000000000007, "episode_return_min": -9.5, "module_episode_returns_mean": {"default_policy": -0.14000000000000007}, "episode_len_max": 20, "num_env_steps_sampled": 5000.0, "env_to_module_sum_episodes_length_in": 10.191744832559449, "num_env_steps_sampled_lifetime": 627500.0, "num_env_steps_sampled_lifetime_throughput": 3262.444314912451}, "learners": {"__all_modules__": {"num_env_steps_trained_lifetime": 31500, "learner_connector": {"timers": {"connectors": {"add_observations_from_episodes_to_batch": 0.0008300829213112593, "add_time_dim_to_batch_and_zero_pad": 2.0832987502217293e-05, "add_columns_from_episodes_to_train_batch": 0.03775737504474819, "add_one_ts_to_episodes_and_truncate": 0.008054040954448283, "add_states_from_episodes_to_batch": 3.95788811147213e-06, "numpy_to_tensor": 0.0001027500256896019, "batch_individual_items": 0.03569058305583894, "general_advantage_estimation": 0.008448875043541193}}, "connector_pipeline_timer": 0.09109125006943941}, "learner_connector_sum_episodes_length_in": 5000, "num_env_steps_trained": 31500, "num_module_steps_trained": 6000, "num_non_trainable_parameters": 0, "num_module_steps_trained_lifetime": 6000, "num_trainable_parameters": 6003, "learner_connector_sum_episodes_length_out": 5250, "num_env_steps_trained_lifetime_throughput": 1874253.219402933, "num_module_steps_trained_throughput": 358599.16933004616, "num_module_steps_trained_lifetime_throughput": 358007.5471986694}, "default_policy": {"gradients_default_optimizer_global_norm": 0.025468185544013977, "weights_seq_no": 1.0, "num_module_steps_trained_lifetime": 6000, "num_trainable_parameters": 6003, "diff_num_grad_updates_vs_sampler_policy": 1.0, "policy_loss": 0.06390514224767685, "default_optimizer_learning_rate": 0.0002847858517, "vf_explained_var": -0.011374115943908691, "vf_loss": 0.10278083384037018, "vf_loss_unclipped": 28.37276268005371, "curr_entropy_coeff": 0.0090570820258, "module_train_batch_size_mean": 1000.0, "num_module_steps_trained": 6000, "total_loss": 0.12644556164741516, "mean_kl_loss": 0.00010375812416896224, "entropy": 0.6931197643280029, "curr_kl_coeff": 0.3732481598854065, "num_module_steps_trained_lifetime_throughput": 359416.6945081365}}, "num_training_step_calls_per_iteration": 1, "num_env_steps_sampled_lifetime": 627500.0, "evaluation": {"env_runners": {"env_to_module_connector": {"timers": {"connectors": {"add_observations_from_episodes_to_batch": 3.3229039486391824e-06, "add_time_dim_to_batch_and_zero_pad": 2.934319233451987e-06, "add_states_from_episodes_to_batch": 1.8483319570430152e-06, "numpy_to_tensor": 1.0506473400594486e-05, "batch_individual_items": 7.584020383887234e-06}}, "connector_pipeline_timer": 5.220246446414962e-05}, "episode_return_mean": 5.65, "num_module_steps_sampled": {"default_policy": 400}, "num_episodes_lifetime": 20, "module_to_env_connector": {"timers": {"connectors": {"un_batch_to_individual_items": 6.515320433758403e-06, "tensor_to_numpy": 1.7923868558272655e-05, "listify_data_for_vector_env": 1.2734819986669546e-05, "remove_single_ts_time_rank_from_batch": 6.805750811381886e-07, "get_actions": 5.4045047477383754e-05, "normalize_and_clip_actions": 1.2606674681128383e-05}}, "connector_pipeline_timer": 0.0001330644486833159}, "rlmodule_inference_timer": 3.660184856802694e-05, "module_episode_returns_mean": {"default_policy": 5.65}, "env_to_module_sum_episodes_length_out": 10.216013141322508, "num_episodes": 20, "episode_return_max": 13.5, "env_reset_timer": 0.00047445797827094793, "episode_len_min": 20, "episode_return_min": -13.5, "episode_len_max": 20, "env_to_module_sum_episodes_length_in": 10.216013141322508, "num_env_steps_sampled_lifetime": 5400, "agent_episode_returns_mean": {"default_agent": 5.65}, "num_module_steps_sampled_lifetime": {"default_policy": 400}, "sample": 0.11602666694670916, "episode_duration_sec_mean": 0.005242485459893942, "num_agent_steps_sampled": {"default_agent": 400}, "num_env_steps_sampled": 400, "weights_seq_no": 1.0, "episode_len_mean": 20.0, "env_step_timer": 1.787749847415915e-05, "num_agent_steps_sampled_lifetime": {"default_agent": 400}}, "num_healthy_workers": 1, "actor_manager_num_outstanding_async_reqs": 0, "num_remote_worker_restarts": 0}, "fault_tolerance": {"num_healthy_workers": 0, "num_remote_worker_restarts": 0}, "env_runner_group": {"actor_manager_num_outstanding_async_reqs": 0}, "done": false, "training_iteration": 1, "trial_id": "4dc31_00000", "date": "2025-08-11_19-19-24", "timestamp": 1754932764, "time_this_iter_s": 1.8679099082946777, "time_total_s": 1.8679099082946777, "pid": 14098, "hostname": "Mac", "node_ip": "127.0.0.1", "config": {"exploration_config": {}, "extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "placement_strategy": "PACK", "num_gpus": 0, "_fake_gpus": false, "num_cpus_for_main_process": 2, "eager_tracing": true, "eager_max_retraces": 20, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "torch_compile_learner": false, "torch_compile_learner_what_to_compile": "forward_train", "torch_compile_learner_dynamo_backend": "aot_eager", "torch_compile_learner_dynamo_mode": null, "torch_compile_worker": false, "torch_compile_worker_dynamo_backend": "aot_eager", "torch_compile_worker_dynamo_mode": null, "torch_ddp_kwargs": {}, "torch_skip_nan_gradients": false, "env": "Umbrella", "env_config": {}, "observation_space": null, "action_space": null, "clip_rewards": null, "normalize_actions": true, "clip_actions": false, "_is_atari": null, "disable_env_checking": false, "render_env": false, "action_mask_key": "action_mask", "env_runner_cls": null, "num_env_runners": 0, "create_local_env_runner": true, "num_envs_per_env_runner": 1, "gym_env_vectorize_mode": "SYNC", "num_cpus_per_env_runner": 1, "num_gpus_per_env_runner": 0, "custom_resources_per_env_runner": {}, "validate_env_runners_after_construction": true, "episodes_to_numpy": true, "max_requests_in_flight_per_env_runner": 1, "sample_timeout_s": 60.0, "_env_to_module_connector": null, "add_default_connectors_to_env_to_module_pipeline": true, "_module_to_env_connector": null, "add_default_connectors_to_module_to_env_pipeline": true, "merge_env_runner_states": "training_only", "broadcast_env_runner_states": true, "episode_lookback_horizon": 1, "rollout_fragment_length": "auto", "batch_mode": "complete_episodes", "compress_observations": false, "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "enable_tf1_exec_eagerly": false, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "preprocessor_pref": "deepmind", "observation_filter": "NoFilter", "update_worker_filter_stats": true, "use_worker_filter_stats": true, "sampler_perf_stats_ema_coef": null, "_is_online": true, "num_learners": 0, "num_gpus_per_learner": 0, "num_cpus_per_learner": "auto", "num_aggregator_actors_per_learner": 0, "max_requests_in_flight_per_aggregator_actor": 3, "local_gpu_idx": 0, "max_requests_in_flight_per_learner": 3, "gamma": 1, "lr": 0.0002847858517, "grad_clip": 0.5, "grad_clip_by": "global_norm", "_train_batch_size_per_learner": 5000, "train_batch_size": 4000, "num_epochs": 1, "minibatch_size": 1000, "shuffle_batch_per_epoch": true, "model": {"fcnet_hiddens": [256, 256], "fcnet_activation": "tanh", "fcnet_weights_initializer": null, "fcnet_weights_initializer_config": null, "fcnet_bias_initializer": null, "fcnet_bias_initializer_config": null, "conv_filters": null, "conv_activation": "relu", "conv_kernel_initializer": null, "conv_kernel_initializer_config": null, "conv_bias_initializer": null, "conv_bias_initializer_config": null, "conv_transpose_kernel_initializer": null, "conv_transpose_kernel_initializer_config": null, "conv_transpose_bias_initializer": null, "conv_transpose_bias_initializer_config": null, "post_fcnet_hiddens": [], "post_fcnet_activation": "relu", "post_fcnet_weights_initializer": null, "post_fcnet_weights_initializer_config": null, "post_fcnet_bias_initializer": null, "post_fcnet_bias_initializer_config": null, "free_log_std": false, "log_std_clip_param": 20.0, "no_final_linear": false, "vf_share_layers": false, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "lstm_weights_initializer": null, "lstm_weights_initializer_config": null, "lstm_bias_initializer": null, "lstm_bias_initializer_config": null, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "attention_use_n_prev_actions": 0, "attention_use_n_prev_rewards": 0, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": null, "custom_model_config": {}, "custom_action_dist": null, "custom_preprocessor": null, "encoder_latent_dim": null, "always_check_shapes": false, "lstm_use_prev_action_reward": -1, "_use_default_native_models": -1, "_disable_preprocessor_api": false, "_disable_action_flattening": false}, "_learner_connector": null, "add_default_connectors_to_learner_pipeline": true, "learner_config_dict": {}, "optimizer": {}, "_learner_class": null, "callbacks_on_algorithm_init": null, "callbacks_on_env_runners_recreated": null, "callbacks_on_offline_eval_runners_recreated": null, "callbacks_on_checkpoint_loaded": null, "callbacks_on_environment_created": null, "callbacks_on_episode_created": null, "callbacks_on_episode_start": null, "callbacks_on_episode_step": null, "callbacks_on_episode_end": null, "callbacks_on_evaluate_start": null, "callbacks_on_evaluate_end": null, "callbacks_on_evaluate_offline_start": null, "callbacks_on_evaluate_offline_end": null, "callbacks_on_sample_end": null, "callbacks_on_train_result": null, "explore": true, "enable_rl_module_and_learner": true, "enable_env_runner_and_connector_v2": true, "_prior_exploration_config": {"type": "StochasticSampling"}, "count_steps_by": "env_steps", "policy_map_capacity": 100, "policy_mapping_fn": "<function AlgorithmConfig.DEFAULT_POLICY_MAPPING_FN at 0x385441b20>", "policies_to_train": null, "policy_states_are_swappable": false, "observation_fn": null, "offline_data_class": null, "input_read_method": "read_parquet", "input_read_method_kwargs": {}, "input_read_schema": {}, "input_read_episodes": false, "input_read_sample_batches": false, "input_read_batch_size": null, "input_filesystem": null, "input_filesystem_kwargs": {}, "input_compress_columns": ["obs", "new_obs"], "input_spaces_jsonable": true, "materialize_data": false, "materialize_mapped_data": true, "map_batches_kwargs": {}, "iter_batches_kwargs": {}, "ignore_final_observation": false, "prelearner_class": null, "prelearner_buffer_class": null, "prelearner_buffer_kwargs": {}, "prelearner_module_synch_period": 10, "dataset_num_iters_per_learner": null, "input_config": {}, "actions_in_input_normalized": false, "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_config": {}, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "output_max_rows_per_file": null, "output_write_remaining_data": false, "output_write_method": "write_parquet", "output_write_method_kwargs": {}, "output_filesystem": null, "output_filesystem_kwargs": {}, "output_write_episodes": true, "offline_sampling": false, "evaluation_interval": 1, "evaluation_duration": 20, "evaluation_duration_unit": "episodes", "evaluation_sample_timeout_s": 120.0, "evaluation_auto_duration_min_env_steps_per_sample": 100, "evaluation_auto_duration_max_env_steps_per_sample": 2000, "evaluation_parallel_to_training": false, "evaluation_force_reset_envs_before_iteration": true, "evaluation_config": null, "off_policy_estimation_methods": {}, "ope_split_batch_by_episode": true, "evaluation_num_env_runners": 1, "in_evaluation": false, "sync_filters_on_rollout_workers_timeout_s": 10.0, "offline_evaluation_interval": null, "num_offline_eval_runners": 0, "offline_loss_for_module_fn": null, "offline_evaluation_duration": 1, "offline_evaluation_parallel_to_training": false, "offline_evaluation_timeout_s": 120.0, "num_cpus_per_offline_eval_runner": 1, "num_gpus_per_offline_eval_runner": 0, "custom_resources_per_offline_eval_runner": {}, "restart_failed_offline_eval_runners": true, "ignore_offline_eval_runner_failures": false, "max_num_offline_eval_runner_restarts": 1000, "offline_eval_runner_restore_timeout_s": 1800.0, "max_requests_in_flight_per_offline_eval_runner": 1, "validate_offline_eval_runners_after_construction": true, "offline_eval_runner_health_probe_timeout_s": 30.0, "offline_eval_rl_module_inference_only": false, "broadcast_offline_eval_runner_states": false, "offline_eval_batch_size_per_runner": 256, "dataset_num_iters_per_eval_runner": 1, "keep_per_episode_custom_metrics": false, "metrics_episode_collection_timeout_s": 60.0, "metrics_num_episodes_for_smoothing": 100, "min_time_s_per_iteration": null, "min_train_timesteps_per_iteration": 0, "min_sample_timesteps_per_iteration": 0, "log_gradients": true, "export_native_model_files": false, "checkpoint_trainable_policies_only": false, "logger_creator": null, "logger_config": null, "log_level": "WARN", "log_sys_usage": true, "fake_sampler": false, "seed": 6, "restart_failed_env_runners": true, "ignore_env_runner_failures": false, "max_num_env_runner_restarts": 1000, "delay_between_env_runner_restarts_s": 60.0, "restart_failed_sub_environments": false, "num_consecutive_env_runner_failures_tolerance": 100, "env_runner_health_probe_timeout_s": 30.0, "env_runner_restore_timeout_s": 1800.0, "_model_config": {}, "_rl_module_spec": "RLModuleSpec(module_class=None, observation_space=None, action_space=None, inference_only=False, learner_only=False, model_config=DefaultModelConfig(fcnet_hiddens=[60, 90], fcnet_activation='tanh', fcnet_kernel_initializer=None, fcnet_kernel_initializer_kwargs=None, fcnet_bias_initializer=None, fcnet_bias_initializer_kwargs=None, conv_filters=None, conv_activation='relu', conv_kernel_initializer=None, conv_kernel_initializer_kwargs=None, conv_bias_initializer=None, conv_bias_initializer_kwargs=None, head_fcnet_hiddens=[], head_fcnet_activation='relu', head_fcnet_kernel_initializer=None, head_fcnet_kernel_initializer_kwargs=None, head_fcnet_bias_initializer=None, head_fcnet_bias_initializer_kwargs=None, free_log_std=False, log_std_clip_param=20.0, vf_share_layers=True, use_lstm=False, max_seq_len=20, lstm_cell_size=256, lstm_use_prev_action=False, lstm_use_prev_reward=False, lstm_kernel_initializer=None, lstm_kernel_initializer_kwargs=None, lstm_bias_initializer=None, lstm_bias_initializer_kwargs=None), catalog_class=None, load_state_path=None, model_config_dict=None)", "algorithm_config_overrides_per_module": {}, "_per_module_overrides": {}, "_validate_config": true, "_use_msgpack_checkpoints": false, "_torch_grad_scaler_class": null, "_torch_lr_scheduler_classes": null, "_tf_policy_handles_more_than_one_loss": false, "_disable_preprocessor_api": false, "_disable_action_flattening": false, "_disable_initialize_loss_from_dummy_batch": false, "_dont_auto_sync_env_runner_states": false, "env_task_fn": -1, "enable_connectors": -1, "simple_optimizer": false, "policy_map_cache": -1, "worker_cls": -1, "synchronize_filters": -1, "enable_async_evaluation": -1, "custom_async_evaluation_function": -1, "_enable_rl_module_api": -1, "auto_wrap_old_gym_envs": -1, "always_attach_evaluation_results": -1, "replay_sequence_length": null, "_disable_execution_plan_api": -1, "use_critic": true, "use_gae": true, "use_kl_loss": true, "kl_coeff": 0.7464963036515, "kl_target": 0.0270990929592, "vf_loss_coeff": 0.6688075857018, "entropy_coeff": 0.0090570820258, "clip_param": 0.1221781641624, "vf_clip_param": 0.1027808522125, "entropy_coeff_schedule": null, "lr_schedule": null, "sgd_minibatch_size": -1, "vf_share_layers": -1, "__stdout_file__": null, "__stderr_file__": null, "lambda": 0.9099046732075, "input": "sampler", "policies": {"default_policy": [null, null, null, null]}, "callbacks": "<class 'ray.rllib.callbacks.callbacks.RLlibCallback'>", "create_env_on_driver": false, "custom_eval_function": null, "framework": "torch"}, "time_since_restore": 1.8679099082946777, "iterations_since_restore": 1, "perf": {"cpu_util_percent": 17.166666666666668, "ram_util_percent": 83.66666666666667}}
{"timers": {"training_iteration": 1.7327279399789404, "restore_env_runners": 1.8512133974581956e-05, "training_step": 1.7325849527982062, "env_runner_sampling_timer": 1.60543881702004, "learner_update_timer": 0.1235751226474531, "synch_weights": 0.000859508354915306, "restore_eval_env_runners": 8.791917935013771e-06, "evaluation_iteration": 0.1323905000463128, "synch_eval_env_connectors": 0.00014783302322030067, "synch_env_connectors": 5.125068128108978e-06}, "env_runners": {"num_episodes": 250.0, "num_agent_steps_sampled": {"default_agent": 5000.0}, "weights_seq_no": 1.0, "num_agent_steps_sampled_lifetime": {"default_agent": 10000.0}, "num_episodes_lifetime": 500.0, "env_to_module_connector": {"timers": {"connectors": {"add_states_from_episodes_to_batch": 1.7612701503308925e-06, "add_time_dim_to_batch_and_zero_pad": 2.363130650522384e-06, "numpy_to_tensor": 8.781239744055989e-06, "batch_individual_items": 6.292161907622104e-06, "add_observations_from_episodes_to_batch": 2.986283527669763e-06}}, "connector_pipeline_timer": 4.428110666346829e-05}, "sample": 0.00552427070589059, "num_module_steps_sampled": {"default_policy": 5000.0}, "rlmodule_inference_timer": 2.904666048320731e-05, "episode_return_max": 10.5, "agent_episode_returns_mean": {"default_agent": 1.6200000000000008}, "episode_len_mean": 20.0, "time_between_sampling": 0.0016631677359490475, "env_step_timer": 1.3940244026241292e-05, "env_to_module_sum_episodes_length_out": 10.36823839457432, "env_reset_timer": 4.629816024946582e-05, "module_to_env_connector": {"timers": {"connectors": {"listify_data_for_vector_env": 1.1156933126815928e-05, "normalize_and_clip_actions": 9.596809009713415e-06, "get_actions": 4.120836805992446e-05, "un_batch_to_individual_items": 5.465491032902729e-06, "tensor_to_numpy": 1.3527006101638801e-05, "remove_single_ts_time_rank_from_batch": 6.003689802799469e-07}}, "connector_pipeline_timer": 0.00010753444213544161}, "episode_duration_sec_mean": 0.00464029133366421, "num_module_steps_sampled_lifetime": {"default_policy": 10000.0}, "episode_len_min": 20, "episode_return_mean": 1.6200000000000008, "episode_return_min": -9.5, "module_episode_returns_mean": {"default_policy": 1.6200000000000008}, "episode_len_max": 20, "num_env_steps_sampled": 5000.0, "env_to_module_sum_episodes_length_in": 10.36823839457432, "num_env_steps_sampled_lifetime": 10000.0, "num_env_steps_sampled_lifetime_throughput": 3616.9459548358664}, "learners": {"__all_modules__": {"num_env_steps_trained_lifetime": 63000, "learner_connector": {"timers": {"connectors": {"add_observations_from_episodes_to_batch": 0.0008304533420596271, "add_time_dim_to_batch_and_zero_pad": 2.0776317687705158e-05, "add_columns_from_episodes_to_train_batch": 0.0377314021345228, "add_one_ts_to_episodes_and_truncate": 0.008052794294198976, "add_states_from_episodes_to_batch": 3.9566389750689264e-06, "numpy_to_tensor": 0.00010248585487715899, "batch_individual_items": 0.03677572930464521, "general_advantage_estimation": 0.008421507963212206}}, "connector_pipeline_timer": 0.09212112548877485}, "learner_connector_sum_episodes_length_in": 5000.0, "num_env_steps_trained": 31500, "num_module_steps_trained": 6000, "num_non_trainable_parameters": 0, "num_module_steps_trained_lifetime": 12000, "num_trainable_parameters": 6003, "learner_connector_sum_episodes_length_out": 5250.0, "num_env_steps_trained_lifetime_throughput": 1879897.771300407, "num_module_steps_trained_throughput": 359653.9306496957, "num_module_steps_trained_lifetime_throughput": 359068.6212065991}, "default_policy": {"gradients_default_optimizer_global_norm": 0.01637868583202362, "weights_seq_no": 2.0, "num_module_steps_trained_lifetime": 12000, "num_trainable_parameters": 6003, "diff_num_grad_updates_vs_sampler_policy": 1.0, "policy_loss": -0.027911582961678505, "default_optimizer_learning_rate": 0.0002847858517, "vf_explained_var": -0.0108109712600708, "vf_loss": 0.10278083384037018, "vf_loss_unclipped": 28.881858825683594, "curr_entropy_coeff": 0.0090570820258, "module_train_batch_size_mean": 1000.0, "num_module_steps_trained": 6000, "total_loss": 0.03462845832109451, "mean_kl_loss": 0.00020176632096990943, "entropy": 0.6929256319999695, "curr_kl_coeff": 0.18662407994270325, "num_module_steps_trained_lifetime_throughput": 360447.59292370145}}, "num_training_step_calls_per_iteration": 1, "evaluation": {"env_runners": {"env_to_module_connector": {"timers": {"connectors": {"add_observations_from_episodes_to_batch": 2.8536532372169094e-06, "add_time_dim_to_batch_and_zero_pad": 2.3280085884265952e-06, "add_states_from_episodes_to_batch": 1.609267600888623e-06, "numpy_to_tensor": 8.604169737761868e-06, "batch_individual_items": 6.359346285920979e-06}}, "connector_pipeline_timer": 4.3195435534761355e-05}, "episode_return_mean": 4.65, "num_module_steps_sampled": {"default_policy": 400}, "num_episodes_lifetime": 40, "module_to_env_connector": {"timers": {"connectors": {"un_batch_to_individual_items": 5.469468664115954e-06, "tensor_to_numpy": 1.354492347599351e-05, "listify_data_for_vector_env": 1.145648342527852e-05, "remove_single_ts_time_rank_from_batch": 5.703823198013816e-07, "get_actions": 3.701130220172846e-05, "normalize_and_clip_actions": 1.0520540428131178e-05}}, "connector_pipeline_timer": 0.00010399449550650908}, "rlmodule_inference_timer": 2.7977728051205064e-05, "module_episode_returns_mean": {"default_policy": 4.65}, "env_to_module_sum_episodes_length_out": 10.366003441359926, "num_episodes": 20, "episode_return_max": 14.5, "env_reset_timer": 0.000470460478682071, "episode_len_min": 20, "episode_return_min": -13.5, "episode_len_max": 20, "env_to_module_sum_episodes_length_in": 10.366003441359926, "num_env_steps_sampled_lifetime": 10400, "agent_episode_returns_mean": {"default_agent": 4.65}, "num_module_steps_sampled_lifetime": {"default_policy": 800}, "sample": 0.11584327694727109, "episode_duration_sec_mean": 0.004855744811356999, "num_agent_steps_sampled": {"default_agent": 400}, "num_env_steps_sampled": 400, "weights_seq_no": 2.0, "episode_len_mean": 20.0, "env_step_timer": 1.4523241136673158e-05, "num_agent_steps_sampled_lifetime": {"default_agent": 800}, "time_between_sampling": 1.6483203750103712}, "num_healthy_workers": 1, "actor_manager_num_outstanding_async_reqs": 0, "num_remote_worker_restarts": 0}, "num_env_steps_sampled_lifetime": 10000.0, "fault_tolerance": {"num_healthy_workers": 0, "num_remote_worker_restarts": 0}, "env_runner_group": {"actor_manager_num_outstanding_async_reqs": 0}, "done": false, "training_iteration": 2, "trial_id": "4dc31_00000", "date": "2025-08-11_19-19-25", "timestamp": 1754932765, "time_this_iter_s": 1.7264912128448486, "time_total_s": 3.5944011211395264, "pid": 14098, "hostname": "Mac", "node_ip": "127.0.0.1", "config": {"exploration_config": {}, "extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "placement_strategy": "PACK", "num_gpus": 0, "_fake_gpus": false, "num_cpus_for_main_process": 2, "eager_tracing": true, "eager_max_retraces": 20, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "torch_compile_learner": false, "torch_compile_learner_what_to_compile": "forward_train", "torch_compile_learner_dynamo_backend": "aot_eager", "torch_compile_learner_dynamo_mode": null, "torch_compile_worker": false, "torch_compile_worker_dynamo_backend": "aot_eager", "torch_compile_worker_dynamo_mode": null, "torch_ddp_kwargs": {}, "torch_skip_nan_gradients": false, "env": "Umbrella", "env_config": {}, "observation_space": null, "action_space": null, "clip_rewards": null, "normalize_actions": true, "clip_actions": false, "_is_atari": null, "disable_env_checking": false, "render_env": false, "action_mask_key": "action_mask", "env_runner_cls": null, "num_env_runners": 0, "create_local_env_runner": true, "num_envs_per_env_runner": 1, "gym_env_vectorize_mode": "SYNC", "num_cpus_per_env_runner": 1, "num_gpus_per_env_runner": 0, "custom_resources_per_env_runner": {}, "validate_env_runners_after_construction": true, "episodes_to_numpy": true, "max_requests_in_flight_per_env_runner": 1, "sample_timeout_s": 60.0, "_env_to_module_connector": null, "add_default_connectors_to_env_to_module_pipeline": true, "_module_to_env_connector": null, "add_default_connectors_to_module_to_env_pipeline": true, "merge_env_runner_states": "training_only", "broadcast_env_runner_states": true, "episode_lookback_horizon": 1, "rollout_fragment_length": "auto", "batch_mode": "complete_episodes", "compress_observations": false, "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "enable_tf1_exec_eagerly": false, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "preprocessor_pref": "deepmind", "observation_filter": "NoFilter", "update_worker_filter_stats": true, "use_worker_filter_stats": true, "sampler_perf_stats_ema_coef": null, "_is_online": true, "num_learners": 0, "num_gpus_per_learner": 0, "num_cpus_per_learner": "auto", "num_aggregator_actors_per_learner": 0, "max_requests_in_flight_per_aggregator_actor": 3, "local_gpu_idx": 0, "max_requests_in_flight_per_learner": 3, "gamma": 1, "lr": 0.0002847858517, "grad_clip": 0.5, "grad_clip_by": "global_norm", "_train_batch_size_per_learner": 5000, "train_batch_size": 4000, "num_epochs": 1, "minibatch_size": 1000, "shuffle_batch_per_epoch": true, "model": {"fcnet_hiddens": [256, 256], "fcnet_activation": "tanh", "fcnet_weights_initializer": null, "fcnet_weights_initializer_config": null, "fcnet_bias_initializer": null, "fcnet_bias_initializer_config": null, "conv_filters": null, "conv_activation": "relu", "conv_kernel_initializer": null, "conv_kernel_initializer_config": null, "conv_bias_initializer": null, "conv_bias_initializer_config": null, "conv_transpose_kernel_initializer": null, "conv_transpose_kernel_initializer_config": null, "conv_transpose_bias_initializer": null, "conv_transpose_bias_initializer_config": null, "post_fcnet_hiddens": [], "post_fcnet_activation": "relu", "post_fcnet_weights_initializer": null, "post_fcnet_weights_initializer_config": null, "post_fcnet_bias_initializer": null, "post_fcnet_bias_initializer_config": null, "free_log_std": false, "log_std_clip_param": 20.0, "no_final_linear": false, "vf_share_layers": false, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "lstm_weights_initializer": null, "lstm_weights_initializer_config": null, "lstm_bias_initializer": null, "lstm_bias_initializer_config": null, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "attention_use_n_prev_actions": 0, "attention_use_n_prev_rewards": 0, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": null, "custom_model_config": {}, "custom_action_dist": null, "custom_preprocessor": null, "encoder_latent_dim": null, "always_check_shapes": false, "lstm_use_prev_action_reward": -1, "_use_default_native_models": -1, "_disable_preprocessor_api": false, "_disable_action_flattening": false}, "_learner_connector": null, "add_default_connectors_to_learner_pipeline": true, "learner_config_dict": {}, "optimizer": {}, "_learner_class": null, "callbacks_on_algorithm_init": null, "callbacks_on_env_runners_recreated": null, "callbacks_on_offline_eval_runners_recreated": null, "callbacks_on_checkpoint_loaded": null, "callbacks_on_environment_created": null, "callbacks_on_episode_created": null, "callbacks_on_episode_start": null, "callbacks_on_episode_step": null, "callbacks_on_episode_end": null, "callbacks_on_evaluate_start": null, "callbacks_on_evaluate_end": null, "callbacks_on_evaluate_offline_start": null, "callbacks_on_evaluate_offline_end": null, "callbacks_on_sample_end": null, "callbacks_on_train_result": null, "explore": true, "enable_rl_module_and_learner": true, "enable_env_runner_and_connector_v2": true, "_prior_exploration_config": {"type": "StochasticSampling"}, "count_steps_by": "env_steps", "policy_map_capacity": 100, "policy_mapping_fn": "<function AlgorithmConfig.DEFAULT_POLICY_MAPPING_FN at 0x385441b20>", "policies_to_train": null, "policy_states_are_swappable": false, "observation_fn": null, "offline_data_class": null, "input_read_method": "read_parquet", "input_read_method_kwargs": {}, "input_read_schema": {}, "input_read_episodes": false, "input_read_sample_batches": false, "input_read_batch_size": null, "input_filesystem": null, "input_filesystem_kwargs": {}, "input_compress_columns": ["obs", "new_obs"], "input_spaces_jsonable": true, "materialize_data": false, "materialize_mapped_data": true, "map_batches_kwargs": {}, "iter_batches_kwargs": {}, "ignore_final_observation": false, "prelearner_class": null, "prelearner_buffer_class": null, "prelearner_buffer_kwargs": {}, "prelearner_module_synch_period": 10, "dataset_num_iters_per_learner": null, "input_config": {}, "actions_in_input_normalized": false, "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_config": {}, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "output_max_rows_per_file": null, "output_write_remaining_data": false, "output_write_method": "write_parquet", "output_write_method_kwargs": {}, "output_filesystem": null, "output_filesystem_kwargs": {}, "output_write_episodes": true, "offline_sampling": false, "evaluation_interval": 1, "evaluation_duration": 20, "evaluation_duration_unit": "episodes", "evaluation_sample_timeout_s": 120.0, "evaluation_auto_duration_min_env_steps_per_sample": 100, "evaluation_auto_duration_max_env_steps_per_sample": 2000, "evaluation_parallel_to_training": false, "evaluation_force_reset_envs_before_iteration": true, "evaluation_config": null, "off_policy_estimation_methods": {}, "ope_split_batch_by_episode": true, "evaluation_num_env_runners": 1, "in_evaluation": false, "sync_filters_on_rollout_workers_timeout_s": 10.0, "offline_evaluation_interval": null, "num_offline_eval_runners": 0, "offline_loss_for_module_fn": null, "offline_evaluation_duration": 1, "offline_evaluation_parallel_to_training": false, "offline_evaluation_timeout_s": 120.0, "num_cpus_per_offline_eval_runner": 1, "num_gpus_per_offline_eval_runner": 0, "custom_resources_per_offline_eval_runner": {}, "restart_failed_offline_eval_runners": true, "ignore_offline_eval_runner_failures": false, "max_num_offline_eval_runner_restarts": 1000, "offline_eval_runner_restore_timeout_s": 1800.0, "max_requests_in_flight_per_offline_eval_runner": 1, "validate_offline_eval_runners_after_construction": true, "offline_eval_runner_health_probe_timeout_s": 30.0, "offline_eval_rl_module_inference_only": false, "broadcast_offline_eval_runner_states": false, "offline_eval_batch_size_per_runner": 256, "dataset_num_iters_per_eval_runner": 1, "keep_per_episode_custom_metrics": false, "metrics_episode_collection_timeout_s": 60.0, "metrics_num_episodes_for_smoothing": 100, "min_time_s_per_iteration": null, "min_train_timesteps_per_iteration": 0, "min_sample_timesteps_per_iteration": 0, "log_gradients": true, "export_native_model_files": false, "checkpoint_trainable_policies_only": false, "logger_creator": null, "logger_config": null, "log_level": "WARN", "log_sys_usage": true, "fake_sampler": false, "seed": 6, "restart_failed_env_runners": true, "ignore_env_runner_failures": false, "max_num_env_runner_restarts": 1000, "delay_between_env_runner_restarts_s": 60.0, "restart_failed_sub_environments": false, "num_consecutive_env_runner_failures_tolerance": 100, "env_runner_health_probe_timeout_s": 30.0, "env_runner_restore_timeout_s": 1800.0, "_model_config": {}, "_rl_module_spec": "RLModuleSpec(module_class=None, observation_space=None, action_space=None, inference_only=False, learner_only=False, model_config=DefaultModelConfig(fcnet_hiddens=[60, 90], fcnet_activation='tanh', fcnet_kernel_initializer=None, fcnet_kernel_initializer_kwargs=None, fcnet_bias_initializer=None, fcnet_bias_initializer_kwargs=None, conv_filters=None, conv_activation='relu', conv_kernel_initializer=None, conv_kernel_initializer_kwargs=None, conv_bias_initializer=None, conv_bias_initializer_kwargs=None, head_fcnet_hiddens=[], head_fcnet_activation='relu', head_fcnet_kernel_initializer=None, head_fcnet_kernel_initializer_kwargs=None, head_fcnet_bias_initializer=None, head_fcnet_bias_initializer_kwargs=None, free_log_std=False, log_std_clip_param=20.0, vf_share_layers=True, use_lstm=False, max_seq_len=20, lstm_cell_size=256, lstm_use_prev_action=False, lstm_use_prev_reward=False, lstm_kernel_initializer=None, lstm_kernel_initializer_kwargs=None, lstm_bias_initializer=None, lstm_bias_initializer_kwargs=None), catalog_class=None, load_state_path=None, model_config_dict=None)", "algorithm_config_overrides_per_module": {}, "_per_module_overrides": {}, "_validate_config": true, "_use_msgpack_checkpoints": false, "_torch_grad_scaler_class": null, "_torch_lr_scheduler_classes": null, "_tf_policy_handles_more_than_one_loss": false, "_disable_preprocessor_api": false, "_disable_action_flattening": false, "_disable_initialize_loss_from_dummy_batch": false, "_dont_auto_sync_env_runner_states": false, "env_task_fn": -1, "enable_connectors": -1, "simple_optimizer": false, "policy_map_cache": -1, "worker_cls": -1, "synchronize_filters": -1, "enable_async_evaluation": -1, "custom_async_evaluation_function": -1, "_enable_rl_module_api": -1, "auto_wrap_old_gym_envs": -1, "always_attach_evaluation_results": -1, "replay_sequence_length": null, "_disable_execution_plan_api": -1, "use_critic": true, "use_gae": true, "use_kl_loss": true, "kl_coeff": 0.7464963036515, "kl_target": 0.0270990929592, "vf_loss_coeff": 0.6688075857018, "entropy_coeff": 0.0090570820258, "clip_param": 0.1221781641624, "vf_clip_param": 0.1027808522125, "entropy_coeff_schedule": null, "lr_schedule": null, "sgd_minibatch_size": -1, "vf_share_layers": -1, "__stdout_file__": null, "__stderr_file__": null, "lambda": 0.9099046732075, "input": "sampler", "policies": {"default_policy": [null, null, null, null]}, "callbacks": "<class 'ray.rllib.callbacks.callbacks.RLlibCallback'>", "create_env_on_driver": false, "custom_eval_function": null, "framework": "torch"}, "time_since_restore": 3.5944011211395264, "iterations_since_restore": 2, "perf": {"cpu_util_percent": 48.300000000000004, "ram_util_percent": 83.63333333333333}}
{"timers": {"training_iteration": 1.7309698372495477, "restore_env_runners": 1.8392421747557816e-05, "training_step": 1.7308264861912233, "env_runner_sampling_timer": 1.6039873613502598, "learner_update_timer": 0.12327041475132573, "synch_weights": 0.0008577516005025245, "restore_eval_env_runners": 8.78065824508667e-06, "evaluation_iteration": 0.13209356004605072, "synch_eval_env_connectors": 0.00014744719373993576, "synch_env_connectors": 5.118817789480091e-06}, "env_runners": {"num_episodes": 250.0, "num_agent_steps_sampled": {"default_agent": 5000.0}, "weights_seq_no": 2.0, "num_agent_steps_sampled_lifetime": {"default_agent": -607500.0}, "num_episodes_lifetime": -30375.0, "env_to_module_connector": {"timers": {"connectors": {"add_states_from_episodes_to_batch": 1.7730576812789306e-06, "add_time_dim_to_batch_and_zero_pad": 2.417443729547127e-06, "numpy_to_tensor": 9.13182418179681e-06, "batch_individual_items": 6.535662495445364e-06, "add_observations_from_episodes_to_batch": 3.110932905914546e-06}}, "connector_pipeline_timer": 4.5575334964380374e-05}, "sample": 0.005109393450392317, "num_module_steps_sampled": {"default_policy": 5000.0}, "rlmodule_inference_timer": 2.9516492469085368e-05, "episode_return_max": 10.5, "agent_episode_returns_mean": {"default_agent": 0.3400000000000001}, "episode_len_mean": 20.0, "time_between_sampling": 0.001953664494348489, "env_step_timer": 1.4401361545481263e-05, "env_to_module_sum_episodes_length_out": 10.36823839457432, "env_reset_timer": 3.852495611937741e-05, "module_to_env_connector": {"timers": {"connectors": {"listify_data_for_vector_env": 1.16380239028058e-05, "normalize_and_clip_actions": 9.842489382941147e-06, "get_actions": 4.237820793152755e-05, "un_batch_to_individual_items": 5.692482038319125e-06, "tensor_to_numpy": 1.3837848227472322e-05, "remove_single_ts_time_rank_from_batch": 5.98312174593359e-07}}, "connector_pipeline_timer": 0.00011049653180814054}, "episode_duration_sec_mean": 0.004805486872326583, "num_module_steps_sampled_lifetime": {"default_policy": -607500.0}, "episode_len_min": 20, "episode_return_mean": 0.3400000000000001, "episode_return_min": -9.5, "module_episode_returns_mean": {"default_policy": 0.3400000000000001}, "episode_len_max": 20, "num_env_steps_sampled": 5000.0, "env_to_module_sum_episodes_length_in": 10.36823839457432, "num_env_steps_sampled_lifetime": -607500.0, "num_env_steps_sampled_lifetime_throughput": 3550.407403068958}, "learners": {"__all_modules__": {"num_env_steps_trained_lifetime": 94500, "learner_connector": {"timers": {"connectors": {"add_observations_from_episodes_to_batch": 0.0008307883878122083, "add_time_dim_to_batch_and_zero_pad": 2.069647399475798e-05, "add_columns_from_episodes_to_train_batch": 0.03770015769358725, "add_one_ts_to_episodes_and_truncate": 0.008049828851048369, "add_states_from_episodes_to_batch": 3.947072813753038e-06, "numpy_to_tensor": 0.0001021864162874408, "batch_individual_items": 0.03670989117200952, "general_advantage_estimation": 0.00839190788384294}}, "connector_pipeline_timer": 0.09199056632410502}, "learner_connector_sum_episodes_length_in": 5000.0, "num_env_steps_trained": 31500, "num_module_steps_trained": 6000, "num_non_trainable_parameters": 0, "num_module_steps_trained_lifetime": 18000, "num_trainable_parameters": 6003, "learner_connector_sum_episodes_length_out": 5250.0, "num_env_steps_trained_lifetime_throughput": 1887998.5629556854, "num_module_steps_trained_throughput": 361166.1664218017, "num_module_steps_trained_lifetime_throughput": 360589.7497804074}, "default_policy": {"gradients_default_optimizer_global_norm": 0.05247271806001663, "weights_seq_no": 3.0, "num_module_steps_trained_lifetime": 18000, "num_trainable_parameters": 6003, "diff_num_grad_updates_vs_sampler_policy": 1.0, "policy_loss": -0.06263282895088196, "default_optimizer_learning_rate": 0.0002847858517, "vf_explained_var": -0.011661171913146973, "vf_loss": 0.10278083384037018, "vf_loss_unclipped": 28.72089958190918, "curr_entropy_coeff": 0.0090570820258, "module_train_batch_size_mean": 1000.0, "num_module_steps_trained": 6000, "total_loss": 6.134508294053376e-05, "mean_kl_loss": 0.0011100023984909058, "entropy": 0.6904634833335876, "curr_kl_coeff": 0.09331203997135162, "num_module_steps_trained_lifetime_throughput": 361923.000512684}}, "num_training_step_calls_per_iteration": 1, "evaluation": {"env_runners": {"env_to_module_connector": {"timers": {"connectors": {"add_observations_from_episodes_to_batch": 3.0318956906723137e-06, "add_time_dim_to_batch_and_zero_pad": 2.48152724698346e-06, "add_states_from_episodes_to_batch": 1.6650483599523385e-06, "numpy_to_tensor": 9.201857808252674e-06, "batch_individual_items": 6.715661774548444e-06}}, "connector_pipeline_timer": 4.5315014165499715e-05}, "episode_return_mean": 3.65, "num_module_steps_sampled": {"default_policy": 400}, "num_episodes_lifetime": 60, "module_to_env_connector": {"timers": {"connectors": {"un_batch_to_individual_items": 6.020494952136286e-06, "tensor_to_numpy": 1.4841978523119092e-05, "listify_data_for_vector_env": 1.1899578489724543e-05, "remove_single_ts_time_rank_from_batch": 6.452834767306356e-07, "get_actions": 4.09938331981987e-05, "normalize_and_clip_actions": 1.053714755887266e-05}}, "connector_pipeline_timer": 0.00011235948303913568}, "rlmodule_inference_timer": 3.102845406765763e-05, "module_episode_returns_mean": {"default_policy": 3.65}, "env_to_module_sum_episodes_length_out": 10.368205581254823, "num_episodes": 20, "episode_return_max": 14.5, "env_reset_timer": 0.00046653129423502833, "episode_len_min": 20, "episode_return_min": -13.5, "episode_len_max": 20, "env_to_module_sum_episodes_length_in": 10.368205581254823, "num_env_steps_sampled_lifetime": 15400, "agent_episode_returns_mean": {"default_agent": 3.65}, "num_module_steps_sampled_lifetime": {"default_policy": 1200}, "sample": 0.1159853029275546, "episode_duration_sec_mean": 0.005213447922142222, "num_agent_steps_sampled": {"default_agent": 400}, "num_env_steps_sampled": 400, "weights_seq_no": 3.0, "episode_len_mean": 20.0, "env_step_timer": 1.646742157859963e-05, "num_agent_steps_sampled_lifetime": {"default_agent": 1200}, "time_between_sampling": 1.6475793266796972}, "num_healthy_workers": 1, "actor_manager_num_outstanding_async_reqs": 0, "num_remote_worker_restarts": 0}, "num_env_steps_sampled_lifetime": -607500.0, "fault_tolerance": {"num_healthy_workers": 0, "num_remote_worker_restarts": 0}, "env_runner_group": {"actor_manager_num_outstanding_async_reqs": 0}, "done": false, "training_iteration": 3, "trial_id": "4dc31_00000", "date": "2025-08-11_19-19-27", "timestamp": 1754932767, "time_this_iter_s": 1.694455862045288, "time_total_s": 5.2888569831848145, "pid": 14098, "hostname": "Mac", "node_ip": "127.0.0.1", "config": {"exploration_config": {}, "extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "placement_strategy": "PACK", "num_gpus": 0, "_fake_gpus": false, "num_cpus_for_main_process": 2, "eager_tracing": true, "eager_max_retraces": 20, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "torch_compile_learner": false, "torch_compile_learner_what_to_compile": "forward_train", "torch_compile_learner_dynamo_backend": "aot_eager", "torch_compile_learner_dynamo_mode": null, "torch_compile_worker": false, "torch_compile_worker_dynamo_backend": "aot_eager", "torch_compile_worker_dynamo_mode": null, "torch_ddp_kwargs": {}, "torch_skip_nan_gradients": false, "env": "Umbrella", "env_config": {}, "observation_space": null, "action_space": null, "clip_rewards": null, "normalize_actions": true, "clip_actions": false, "_is_atari": null, "disable_env_checking": false, "render_env": false, "action_mask_key": "action_mask", "env_runner_cls": null, "num_env_runners": 0, "create_local_env_runner": true, "num_envs_per_env_runner": 1, "gym_env_vectorize_mode": "SYNC", "num_cpus_per_env_runner": 1, "num_gpus_per_env_runner": 0, "custom_resources_per_env_runner": {}, "validate_env_runners_after_construction": true, "episodes_to_numpy": true, "max_requests_in_flight_per_env_runner": 1, "sample_timeout_s": 60.0, "_env_to_module_connector": null, "add_default_connectors_to_env_to_module_pipeline": true, "_module_to_env_connector": null, "add_default_connectors_to_module_to_env_pipeline": true, "merge_env_runner_states": "training_only", "broadcast_env_runner_states": true, "episode_lookback_horizon": 1, "rollout_fragment_length": "auto", "batch_mode": "complete_episodes", "compress_observations": false, "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "enable_tf1_exec_eagerly": false, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "preprocessor_pref": "deepmind", "observation_filter": "NoFilter", "update_worker_filter_stats": true, "use_worker_filter_stats": true, "sampler_perf_stats_ema_coef": null, "_is_online": true, "num_learners": 0, "num_gpus_per_learner": 0, "num_cpus_per_learner": "auto", "num_aggregator_actors_per_learner": 0, "max_requests_in_flight_per_aggregator_actor": 3, "local_gpu_idx": 0, "max_requests_in_flight_per_learner": 3, "gamma": 1, "lr": 0.0002847858517, "grad_clip": 0.5, "grad_clip_by": "global_norm", "_train_batch_size_per_learner": 5000, "train_batch_size": 4000, "num_epochs": 1, "minibatch_size": 1000, "shuffle_batch_per_epoch": true, "model": {"fcnet_hiddens": [256, 256], "fcnet_activation": "tanh", "fcnet_weights_initializer": null, "fcnet_weights_initializer_config": null, "fcnet_bias_initializer": null, "fcnet_bias_initializer_config": null, "conv_filters": null, "conv_activation": "relu", "conv_kernel_initializer": null, "conv_kernel_initializer_config": null, "conv_bias_initializer": null, "conv_bias_initializer_config": null, "conv_transpose_kernel_initializer": null, "conv_transpose_kernel_initializer_config": null, "conv_transpose_bias_initializer": null, "conv_transpose_bias_initializer_config": null, "post_fcnet_hiddens": [], "post_fcnet_activation": "relu", "post_fcnet_weights_initializer": null, "post_fcnet_weights_initializer_config": null, "post_fcnet_bias_initializer": null, "post_fcnet_bias_initializer_config": null, "free_log_std": false, "log_std_clip_param": 20.0, "no_final_linear": false, "vf_share_layers": false, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "lstm_weights_initializer": null, "lstm_weights_initializer_config": null, "lstm_bias_initializer": null, "lstm_bias_initializer_config": null, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "attention_use_n_prev_actions": 0, "attention_use_n_prev_rewards": 0, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": null, "custom_model_config": {}, "custom_action_dist": null, "custom_preprocessor": null, "encoder_latent_dim": null, "always_check_shapes": false, "lstm_use_prev_action_reward": -1, "_use_default_native_models": -1, "_disable_preprocessor_api": false, "_disable_action_flattening": false}, "_learner_connector": null, "add_default_connectors_to_learner_pipeline": true, "learner_config_dict": {}, "optimizer": {}, "_learner_class": null, "callbacks_on_algorithm_init": null, "callbacks_on_env_runners_recreated": null, "callbacks_on_offline_eval_runners_recreated": null, "callbacks_on_checkpoint_loaded": null, "callbacks_on_environment_created": null, "callbacks_on_episode_created": null, "callbacks_on_episode_start": null, "callbacks_on_episode_step": null, "callbacks_on_episode_end": null, "callbacks_on_evaluate_start": null, "callbacks_on_evaluate_end": null, "callbacks_on_evaluate_offline_start": null, "callbacks_on_evaluate_offline_end": null, "callbacks_on_sample_end": null, "callbacks_on_train_result": null, "explore": true, "enable_rl_module_and_learner": true, "enable_env_runner_and_connector_v2": true, "_prior_exploration_config": {"type": "StochasticSampling"}, "count_steps_by": "env_steps", "policy_map_capacity": 100, "policy_mapping_fn": "<function AlgorithmConfig.DEFAULT_POLICY_MAPPING_FN at 0x385441b20>", "policies_to_train": null, "policy_states_are_swappable": false, "observation_fn": null, "offline_data_class": null, "input_read_method": "read_parquet", "input_read_method_kwargs": {}, "input_read_schema": {}, "input_read_episodes": false, "input_read_sample_batches": false, "input_read_batch_size": null, "input_filesystem": null, "input_filesystem_kwargs": {}, "input_compress_columns": ["obs", "new_obs"], "input_spaces_jsonable": true, "materialize_data": false, "materialize_mapped_data": true, "map_batches_kwargs": {}, "iter_batches_kwargs": {}, "ignore_final_observation": false, "prelearner_class": null, "prelearner_buffer_class": null, "prelearner_buffer_kwargs": {}, "prelearner_module_synch_period": 10, "dataset_num_iters_per_learner": null, "input_config": {}, "actions_in_input_normalized": false, "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_config": {}, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "output_max_rows_per_file": null, "output_write_remaining_data": false, "output_write_method": "write_parquet", "output_write_method_kwargs": {}, "output_filesystem": null, "output_filesystem_kwargs": {}, "output_write_episodes": true, "offline_sampling": false, "evaluation_interval": 1, "evaluation_duration": 20, "evaluation_duration_unit": "episodes", "evaluation_sample_timeout_s": 120.0, "evaluation_auto_duration_min_env_steps_per_sample": 100, "evaluation_auto_duration_max_env_steps_per_sample": 2000, "evaluation_parallel_to_training": false, "evaluation_force_reset_envs_before_iteration": true, "evaluation_config": null, "off_policy_estimation_methods": {}, "ope_split_batch_by_episode": true, "evaluation_num_env_runners": 1, "in_evaluation": false, "sync_filters_on_rollout_workers_timeout_s": 10.0, "offline_evaluation_interval": null, "num_offline_eval_runners": 0, "offline_loss_for_module_fn": null, "offline_evaluation_duration": 1, "offline_evaluation_parallel_to_training": false, "offline_evaluation_timeout_s": 120.0, "num_cpus_per_offline_eval_runner": 1, "num_gpus_per_offline_eval_runner": 0, "custom_resources_per_offline_eval_runner": {}, "restart_failed_offline_eval_runners": true, "ignore_offline_eval_runner_failures": false, "max_num_offline_eval_runner_restarts": 1000, "offline_eval_runner_restore_timeout_s": 1800.0, "max_requests_in_flight_per_offline_eval_runner": 1, "validate_offline_eval_runners_after_construction": true, "offline_eval_runner_health_probe_timeout_s": 30.0, "offline_eval_rl_module_inference_only": false, "broadcast_offline_eval_runner_states": false, "offline_eval_batch_size_per_runner": 256, "dataset_num_iters_per_eval_runner": 1, "keep_per_episode_custom_metrics": false, "metrics_episode_collection_timeout_s": 60.0, "metrics_num_episodes_for_smoothing": 100, "min_time_s_per_iteration": null, "min_train_timesteps_per_iteration": 0, "min_sample_timesteps_per_iteration": 0, "log_gradients": true, "export_native_model_files": false, "checkpoint_trainable_policies_only": false, "logger_creator": null, "logger_config": null, "log_level": "WARN", "log_sys_usage": true, "fake_sampler": false, "seed": 6, "restart_failed_env_runners": true, "ignore_env_runner_failures": false, "max_num_env_runner_restarts": 1000, "delay_between_env_runner_restarts_s": 60.0, "restart_failed_sub_environments": false, "num_consecutive_env_runner_failures_tolerance": 100, "env_runner_health_probe_timeout_s": 30.0, "env_runner_restore_timeout_s": 1800.0, "_model_config": {}, "_rl_module_spec": "RLModuleSpec(module_class=None, observation_space=None, action_space=None, inference_only=False, learner_only=False, model_config=DefaultModelConfig(fcnet_hiddens=[60, 90], fcnet_activation='tanh', fcnet_kernel_initializer=None, fcnet_kernel_initializer_kwargs=None, fcnet_bias_initializer=None, fcnet_bias_initializer_kwargs=None, conv_filters=None, conv_activation='relu', conv_kernel_initializer=None, conv_kernel_initializer_kwargs=None, conv_bias_initializer=None, conv_bias_initializer_kwargs=None, head_fcnet_hiddens=[], head_fcnet_activation='relu', head_fcnet_kernel_initializer=None, head_fcnet_kernel_initializer_kwargs=None, head_fcnet_bias_initializer=None, head_fcnet_bias_initializer_kwargs=None, free_log_std=False, log_std_clip_param=20.0, vf_share_layers=True, use_lstm=False, max_seq_len=20, lstm_cell_size=256, lstm_use_prev_action=False, lstm_use_prev_reward=False, lstm_kernel_initializer=None, lstm_kernel_initializer_kwargs=None, lstm_bias_initializer=None, lstm_bias_initializer_kwargs=None), catalog_class=None, load_state_path=None, model_config_dict=None)", "algorithm_config_overrides_per_module": {}, "_per_module_overrides": {}, "_validate_config": true, "_use_msgpack_checkpoints": false, "_torch_grad_scaler_class": null, "_torch_lr_scheduler_classes": null, "_tf_policy_handles_more_than_one_loss": false, "_disable_preprocessor_api": false, "_disable_action_flattening": false, "_disable_initialize_loss_from_dummy_batch": false, "_dont_auto_sync_env_runner_states": false, "env_task_fn": -1, "enable_connectors": -1, "simple_optimizer": false, "policy_map_cache": -1, "worker_cls": -1, "synchronize_filters": -1, "enable_async_evaluation": -1, "custom_async_evaluation_function": -1, "_enable_rl_module_api": -1, "auto_wrap_old_gym_envs": -1, "always_attach_evaluation_results": -1, "replay_sequence_length": null, "_disable_execution_plan_api": -1, "use_critic": true, "use_gae": true, "use_kl_loss": true, "kl_coeff": 0.7464963036515, "kl_target": 0.0270990929592, "vf_loss_coeff": 0.6688075857018, "entropy_coeff": 0.0090570820258, "clip_param": 0.1221781641624, "vf_clip_param": 0.1027808522125, "entropy_coeff_schedule": null, "lr_schedule": null, "sgd_minibatch_size": -1, "vf_share_layers": -1, "__stdout_file__": null, "__stderr_file__": null, "lambda": 0.9099046732075, "input": "sampler", "policies": {"default_policy": [null, null, null, null]}, "callbacks": "<class 'ray.rllib.callbacks.callbacks.RLlibCallback'>", "create_env_on_driver": false, "custom_eval_function": null, "framework": "torch"}, "time_since_restore": 5.2888569831848145, "iterations_since_restore": 3, "perf": {"cpu_util_percent": 50.05, "ram_util_percent": 83.5}}
{"timers": {"training_iteration": 1.7298901563768176, "restore_env_runners": 1.8285586592042815e-05, "training_step": 1.729746344659822, "env_runner_sampling_timer": 1.6032036498165068, "learner_update_timer": 0.12297689352349542, "synch_weights": 0.0008551520042883931, "restore_eval_env_runners": 8.805771032348275e-06, "evaluation_iteration": 0.13212734736523127, "synch_eval_env_connectors": 0.00014786189101869242, "synch_env_connectors": 5.121379729826004e-06}, "env_runners": {"num_episodes": 250.0, "num_agent_steps_sampled": {"default_agent": 5000.0}, "weights_seq_no": 3.0, "num_agent_steps_sampled_lifetime": {"default_agent": -1225000.0}, "num_episodes_lifetime": -61250.0, "env_to_module_connector": {"timers": {"connectors": {"add_states_from_episodes_to_batch": 1.7433663755431332e-06, "add_time_dim_to_batch_and_zero_pad": 2.3673670736556013e-06, "numpy_to_tensor": 8.794685311668271e-06, "batch_individual_items": 6.320280008142191e-06, "add_observations_from_episodes_to_batch": 3.087332980474538e-06}}, "connector_pipeline_timer": 4.4579812929743976e-05}, "sample": 0.00504855426615615, "num_module_steps_sampled": {"default_policy": 5000.0}, "rlmodule_inference_timer": 2.8388828249217034e-05, "episode_return_max": 10.5, "agent_episode_returns_mean": {"default_agent": 1.94}, "episode_len_mean": 20.0, "time_between_sampling": 0.001991709074736888, "env_step_timer": 1.4072732729053361e-05, "env_to_module_sum_episodes_length_out": 10.36823839457432, "env_reset_timer": 3.966643844926333e-05, "module_to_env_connector": {"timers": {"connectors": {"listify_data_for_vector_env": 1.1167819847161375e-05, "normalize_and_clip_actions": 9.558824017926154e-06, "get_actions": 4.0892225624429276e-05, "un_batch_to_individual_items": 5.499840736033851e-06, "tensor_to_numpy": 1.3482783514109867e-05, "remove_single_ts_time_rank_from_batch": 5.974128556173406e-07}}, "connector_pipeline_timer": 0.00010712863780193982}, "episode_duration_sec_mean": 0.004668200836051253, "num_module_steps_sampled_lifetime": {"default_policy": -1225000.0}, "episode_len_min": 20, "episode_return_mean": 1.94, "episode_return_min": -9.5, "module_episode_returns_mean": {"default_policy": 1.94}, "episode_len_max": 20, "num_env_steps_sampled": 5000.0, "env_to_module_sum_episodes_length_in": 10.36823839457432, "num_env_steps_sampled_lifetime": -1225000.0, "num_env_steps_sampled_lifetime_throughput": 3614.557772267292}, "learners": {"__all_modules__": {"num_env_steps_trained_lifetime": 126000, "learner_connector": {"timers": {"connectors": {"add_observations_from_episodes_to_batch": 0.0008312359140241751, "add_time_dim_to_batch_and_zero_pad": 2.0620340285939162e-05, "add_columns_from_episodes_to_train_batch": 0.037666236116671935, "add_one_ts_to_episodes_and_truncate": 0.00805121556206455, "add_states_from_episodes_to_batch": 3.953022687579505e-06, "numpy_to_tensor": 0.00010182914158550556, "batch_individual_items": 0.03664981767029152, "general_advantage_estimation": 0.008362868804956902}}, "connector_pipeline_timer": 0.09186818066018738}, "learner_connector_sum_episodes_length_in": 5000.0, "num_env_steps_trained": 31500, "num_module_steps_trained": 6000, "num_non_trainable_parameters": 0, "num_module_steps_trained_lifetime": 24000, "num_trainable_parameters": 6003, "learner_connector_sum_episodes_length_out": 5250.0, "num_env_steps_trained_lifetime_throughput": 1897811.610974615, "num_module_steps_trained_throughput": 362997.7549294987, "num_module_steps_trained_lifetime_throughput": 362433.02191169653}, "default_policy": {"gradients_default_optimizer_global_norm": 0.08418809622526169, "weights_seq_no": 4.0, "num_module_steps_trained_lifetime": 24000, "num_trainable_parameters": 6003, "diff_num_grad_updates_vs_sampler_policy": 1.0, "policy_loss": -0.004411409143358469, "default_optimizer_learning_rate": 0.0002847858517, "vf_explained_var": -0.011780023574829102, "vf_loss": 0.10278083384037018, "vf_loss_unclipped": 28.880634307861328, "curr_entropy_coeff": 0.0090570820258, "module_train_batch_size_mean": 1000.0, "num_module_steps_trained": 6000, "total_loss": 0.0583021305501461, "mean_kl_loss": 0.0017774610314518213, "entropy": 0.6837658882141113, "curr_kl_coeff": 0.04665601998567581, "num_module_steps_trained_lifetime_throughput": 363706.6585410699}}, "num_training_step_calls_per_iteration": 1, "evaluation": {"env_runners": {"env_to_module_connector": {"timers": {"connectors": {"add_observations_from_episodes_to_batch": 2.8782175850927336e-06, "add_time_dim_to_batch_and_zero_pad": 2.337977815261122e-06, "add_states_from_episodes_to_batch": 1.6401864396174595e-06, "numpy_to_tensor": 8.668966873653776e-06, "batch_individual_items": 6.357235356356804e-06}}, "connector_pipeline_timer": 4.35944998966469e-05}, "episode_return_mean": 2.4, "num_module_steps_sampled": {"default_policy": 400}, "num_episodes_lifetime": 80, "module_to_env_connector": {"timers": {"connectors": {"un_batch_to_individual_items": 5.5514242596079985e-06, "tensor_to_numpy": 1.3295971579623868e-05, "listify_data_for_vector_env": 1.1777975043417768e-05, "remove_single_ts_time_rank_from_batch": 5.844087415085795e-07, "get_actions": 3.716566538440903e-05, "normalize_and_clip_actions": 9.84331957411246e-06}}, "connector_pipeline_timer": 0.00010409418331937727}, "rlmodule_inference_timer": 2.8384507531356993e-05, "module_episode_returns_mean": {"default_policy": 2.4}, "env_to_module_sum_episodes_length_out": 10.368237912813044, "num_episodes": 20, "episode_return_max": 14.5, "env_reset_timer": 0.000463854322393192, "episode_len_min": 20, "episode_return_min": -13.5, "episode_len_max": 20, "env_to_module_sum_episodes_length_in": 10.368237912813044, "num_env_steps_sampled_lifetime": 20400, "agent_episode_returns_mean": {"default_agent": 2.4}, "num_module_steps_sampled_lifetime": {"default_policy": 1600}, "sample": 0.1158318419781502, "episode_duration_sec_mean": 0.005056892195716501, "num_agent_steps_sampled": {"default_agent": 400}, "num_env_steps_sampled": 400, "weights_seq_no": 4.0, "episode_len_mean": 20.0, "env_step_timer": 1.4577178235490843e-05, "num_agent_steps_sampled_lifetime": {"default_agent": 1600}, "time_between_sampling": 1.6475390925732092}, "num_healthy_workers": 1, "actor_manager_num_outstanding_async_reqs": 0, "num_remote_worker_restarts": 0}, "num_env_steps_sampled_lifetime": -1225000.0, "fault_tolerance": {"num_healthy_workers": 0, "num_remote_worker_restarts": 0}, "env_runner_group": {"actor_manager_num_outstanding_async_reqs": 0}, "done": false, "training_iteration": 4, "trial_id": "4dc31_00000", "date": "2025-08-11_19-19-29", "timestamp": 1754932769, "time_this_iter_s": 1.7332909107208252, "time_total_s": 7.02214789390564, "pid": 14098, "hostname": "Mac", "node_ip": "127.0.0.1", "config": {"exploration_config": {}, "extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "placement_strategy": "PACK", "num_gpus": 0, "_fake_gpus": false, "num_cpus_for_main_process": 2, "eager_tracing": true, "eager_max_retraces": 20, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "torch_compile_learner": false, "torch_compile_learner_what_to_compile": "forward_train", "torch_compile_learner_dynamo_backend": "aot_eager", "torch_compile_learner_dynamo_mode": null, "torch_compile_worker": false, "torch_compile_worker_dynamo_backend": "aot_eager", "torch_compile_worker_dynamo_mode": null, "torch_ddp_kwargs": {}, "torch_skip_nan_gradients": false, "env": "Umbrella", "env_config": {}, "observation_space": null, "action_space": null, "clip_rewards": null, "normalize_actions": true, "clip_actions": false, "_is_atari": null, "disable_env_checking": false, "render_env": false, "action_mask_key": "action_mask", "env_runner_cls": null, "num_env_runners": 0, "create_local_env_runner": true, "num_envs_per_env_runner": 1, "gym_env_vectorize_mode": "SYNC", "num_cpus_per_env_runner": 1, "num_gpus_per_env_runner": 0, "custom_resources_per_env_runner": {}, "validate_env_runners_after_construction": true, "episodes_to_numpy": true, "max_requests_in_flight_per_env_runner": 1, "sample_timeout_s": 60.0, "_env_to_module_connector": null, "add_default_connectors_to_env_to_module_pipeline": true, "_module_to_env_connector": null, "add_default_connectors_to_module_to_env_pipeline": true, "merge_env_runner_states": "training_only", "broadcast_env_runner_states": true, "episode_lookback_horizon": 1, "rollout_fragment_length": "auto", "batch_mode": "complete_episodes", "compress_observations": false, "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "enable_tf1_exec_eagerly": false, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "preprocessor_pref": "deepmind", "observation_filter": "NoFilter", "update_worker_filter_stats": true, "use_worker_filter_stats": true, "sampler_perf_stats_ema_coef": null, "_is_online": true, "num_learners": 0, "num_gpus_per_learner": 0, "num_cpus_per_learner": "auto", "num_aggregator_actors_per_learner": 0, "max_requests_in_flight_per_aggregator_actor": 3, "local_gpu_idx": 0, "max_requests_in_flight_per_learner": 3, "gamma": 1, "lr": 0.0002847858517, "grad_clip": 0.5, "grad_clip_by": "global_norm", "_train_batch_size_per_learner": 5000, "train_batch_size": 4000, "num_epochs": 1, "minibatch_size": 1000, "shuffle_batch_per_epoch": true, "model": {"fcnet_hiddens": [256, 256], "fcnet_activation": "tanh", "fcnet_weights_initializer": null, "fcnet_weights_initializer_config": null, "fcnet_bias_initializer": null, "fcnet_bias_initializer_config": null, "conv_filters": null, "conv_activation": "relu", "conv_kernel_initializer": null, "conv_kernel_initializer_config": null, "conv_bias_initializer": null, "conv_bias_initializer_config": null, "conv_transpose_kernel_initializer": null, "conv_transpose_kernel_initializer_config": null, "conv_transpose_bias_initializer": null, "conv_transpose_bias_initializer_config": null, "post_fcnet_hiddens": [], "post_fcnet_activation": "relu", "post_fcnet_weights_initializer": null, "post_fcnet_weights_initializer_config": null, "post_fcnet_bias_initializer": null, "post_fcnet_bias_initializer_config": null, "free_log_std": false, "log_std_clip_param": 20.0, "no_final_linear": false, "vf_share_layers": false, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "lstm_weights_initializer": null, "lstm_weights_initializer_config": null, "lstm_bias_initializer": null, "lstm_bias_initializer_config": null, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "attention_use_n_prev_actions": 0, "attention_use_n_prev_rewards": 0, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": null, "custom_model_config": {}, "custom_action_dist": null, "custom_preprocessor": null, "encoder_latent_dim": null, "always_check_shapes": false, "lstm_use_prev_action_reward": -1, "_use_default_native_models": -1, "_disable_preprocessor_api": false, "_disable_action_flattening": false}, "_learner_connector": null, "add_default_connectors_to_learner_pipeline": true, "learner_config_dict": {}, "optimizer": {}, "_learner_class": null, "callbacks_on_algorithm_init": null, "callbacks_on_env_runners_recreated": null, "callbacks_on_offline_eval_runners_recreated": null, "callbacks_on_checkpoint_loaded": null, "callbacks_on_environment_created": null, "callbacks_on_episode_created": null, "callbacks_on_episode_start": null, "callbacks_on_episode_step": null, "callbacks_on_episode_end": null, "callbacks_on_evaluate_start": null, "callbacks_on_evaluate_end": null, "callbacks_on_evaluate_offline_start": null, "callbacks_on_evaluate_offline_end": null, "callbacks_on_sample_end": null, "callbacks_on_train_result": null, "explore": true, "enable_rl_module_and_learner": true, "enable_env_runner_and_connector_v2": true, "_prior_exploration_config": {"type": "StochasticSampling"}, "count_steps_by": "env_steps", "policy_map_capacity": 100, "policy_mapping_fn": "<function AlgorithmConfig.DEFAULT_POLICY_MAPPING_FN at 0x385441b20>", "policies_to_train": null, "policy_states_are_swappable": false, "observation_fn": null, "offline_data_class": null, "input_read_method": "read_parquet", "input_read_method_kwargs": {}, "input_read_schema": {}, "input_read_episodes": false, "input_read_sample_batches": false, "input_read_batch_size": null, "input_filesystem": null, "input_filesystem_kwargs": {}, "input_compress_columns": ["obs", "new_obs"], "input_spaces_jsonable": true, "materialize_data": false, "materialize_mapped_data": true, "map_batches_kwargs": {}, "iter_batches_kwargs": {}, "ignore_final_observation": false, "prelearner_class": null, "prelearner_buffer_class": null, "prelearner_buffer_kwargs": {}, "prelearner_module_synch_period": 10, "dataset_num_iters_per_learner": null, "input_config": {}, "actions_in_input_normalized": false, "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_config": {}, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "output_max_rows_per_file": null, "output_write_remaining_data": false, "output_write_method": "write_parquet", "output_write_method_kwargs": {}, "output_filesystem": null, "output_filesystem_kwargs": {}, "output_write_episodes": true, "offline_sampling": false, "evaluation_interval": 1, "evaluation_duration": 20, "evaluation_duration_unit": "episodes", "evaluation_sample_timeout_s": 120.0, "evaluation_auto_duration_min_env_steps_per_sample": 100, "evaluation_auto_duration_max_env_steps_per_sample": 2000, "evaluation_parallel_to_training": false, "evaluation_force_reset_envs_before_iteration": true, "evaluation_config": null, "off_policy_estimation_methods": {}, "ope_split_batch_by_episode": true, "evaluation_num_env_runners": 1, "in_evaluation": false, "sync_filters_on_rollout_workers_timeout_s": 10.0, "offline_evaluation_interval": null, "num_offline_eval_runners": 0, "offline_loss_for_module_fn": null, "offline_evaluation_duration": 1, "offline_evaluation_parallel_to_training": false, "offline_evaluation_timeout_s": 120.0, "num_cpus_per_offline_eval_runner": 1, "num_gpus_per_offline_eval_runner": 0, "custom_resources_per_offline_eval_runner": {}, "restart_failed_offline_eval_runners": true, "ignore_offline_eval_runner_failures": false, "max_num_offline_eval_runner_restarts": 1000, "offline_eval_runner_restore_timeout_s": 1800.0, "max_requests_in_flight_per_offline_eval_runner": 1, "validate_offline_eval_runners_after_construction": true, "offline_eval_runner_health_probe_timeout_s": 30.0, "offline_eval_rl_module_inference_only": false, "broadcast_offline_eval_runner_states": false, "offline_eval_batch_size_per_runner": 256, "dataset_num_iters_per_eval_runner": 1, "keep_per_episode_custom_metrics": false, "metrics_episode_collection_timeout_s": 60.0, "metrics_num_episodes_for_smoothing": 100, "min_time_s_per_iteration": null, "min_train_timesteps_per_iteration": 0, "min_sample_timesteps_per_iteration": 0, "log_gradients": true, "export_native_model_files": false, "checkpoint_trainable_policies_only": false, "logger_creator": null, "logger_config": null, "log_level": "WARN", "log_sys_usage": true, "fake_sampler": false, "seed": 6, "restart_failed_env_runners": true, "ignore_env_runner_failures": false, "max_num_env_runner_restarts": 1000, "delay_between_env_runner_restarts_s": 60.0, "restart_failed_sub_environments": false, "num_consecutive_env_runner_failures_tolerance": 100, "env_runner_health_probe_timeout_s": 30.0, "env_runner_restore_timeout_s": 1800.0, "_model_config": {}, "_rl_module_spec": "RLModuleSpec(module_class=None, observation_space=None, action_space=None, inference_only=False, learner_only=False, model_config=DefaultModelConfig(fcnet_hiddens=[60, 90], fcnet_activation='tanh', fcnet_kernel_initializer=None, fcnet_kernel_initializer_kwargs=None, fcnet_bias_initializer=None, fcnet_bias_initializer_kwargs=None, conv_filters=None, conv_activation='relu', conv_kernel_initializer=None, conv_kernel_initializer_kwargs=None, conv_bias_initializer=None, conv_bias_initializer_kwargs=None, head_fcnet_hiddens=[], head_fcnet_activation='relu', head_fcnet_kernel_initializer=None, head_fcnet_kernel_initializer_kwargs=None, head_fcnet_bias_initializer=None, head_fcnet_bias_initializer_kwargs=None, free_log_std=False, log_std_clip_param=20.0, vf_share_layers=True, use_lstm=False, max_seq_len=20, lstm_cell_size=256, lstm_use_prev_action=False, lstm_use_prev_reward=False, lstm_kernel_initializer=None, lstm_kernel_initializer_kwargs=None, lstm_bias_initializer=None, lstm_bias_initializer_kwargs=None), catalog_class=None, load_state_path=None, model_config_dict=None)", "algorithm_config_overrides_per_module": {}, "_per_module_overrides": {}, "_validate_config": true, "_use_msgpack_checkpoints": false, "_torch_grad_scaler_class": null, "_torch_lr_scheduler_classes": null, "_tf_policy_handles_more_than_one_loss": false, "_disable_preprocessor_api": false, "_disable_action_flattening": false, "_disable_initialize_loss_from_dummy_batch": false, "_dont_auto_sync_env_runner_states": false, "env_task_fn": -1, "enable_connectors": -1, "simple_optimizer": false, "policy_map_cache": -1, "worker_cls": -1, "synchronize_filters": -1, "enable_async_evaluation": -1, "custom_async_evaluation_function": -1, "_enable_rl_module_api": -1, "auto_wrap_old_gym_envs": -1, "always_attach_evaluation_results": -1, "replay_sequence_length": null, "_disable_execution_plan_api": -1, "use_critic": true, "use_gae": true, "use_kl_loss": true, "kl_coeff": 0.7464963036515, "kl_target": 0.0270990929592, "vf_loss_coeff": 0.6688075857018, "entropy_coeff": 0.0090570820258, "clip_param": 0.1221781641624, "vf_clip_param": 0.1027808522125, "entropy_coeff_schedule": null, "lr_schedule": null, "sgd_minibatch_size": -1, "vf_share_layers": -1, "__stdout_file__": null, "__stderr_file__": null, "lambda": 0.9099046732075, "input": "sampler", "policies": {"default_policy": [null, null, null, null]}, "callbacks": "<class 'ray.rllib.callbacks.callbacks.RLlibCallback'>", "create_env_on_driver": false, "custom_eval_function": null, "framework": "torch"}, "time_since_restore": 7.02214789390564, "iterations_since_restore": 4, "perf": {"cpu_util_percent": 55.75, "ram_util_percent": 83.65}}
{"timers": {"training_iteration": 1.729685373972787, "restore_env_runners": 1.816190114174736e-05, "training_step": 1.7295410687133168, "env_runner_sampling_timer": 1.60322461331888, "learner_update_timer": 0.12275405792836476, "synch_weights": 0.0008528217341779323, "restore_eval_env_runners": 8.815633741673083e-06, "evaluation_iteration": 0.13188816847104837, "synch_eval_env_connectors": 0.0001474482720688684, "synch_env_connectors": 5.1155853703385225e-06}, "env_runners": {"num_episodes": 250.0, "num_agent_steps_sampled": {"default_agent": 5000.0}, "weights_seq_no": 4.0, "num_agent_steps_sampled_lifetime": {"default_agent": -1842500.0}, "num_episodes_lifetime": -92125.0, "env_to_module_connector": {"timers": {"connectors": {"add_states_from_episodes_to_batch": 1.7373905395641097e-06, "add_time_dim_to_batch_and_zero_pad": 2.3520123801492016e-06, "numpy_to_tensor": 8.790034741365121e-06, "batch_individual_items": 6.274936512864737e-06, "add_observations_from_episodes_to_batch": 3.0071187682747087e-06}}, "connector_pipeline_timer": 4.446189977247715e-05}, "sample": 0.005121008050703642, "num_module_steps_sampled": {"default_policy": 5000.0}, "rlmodule_inference_timer": 6.748727098136769e-05, "episode_return_max": 10.5, "agent_episode_returns_mean": {"default_agent": 3.7}, "episode_len_mean": 20.0, "time_between_sampling": 0.00169984757474233, "env_step_timer": 1.3968501070518044e-05, "env_to_module_sum_episodes_length_out": 10.36823839457432, "env_reset_timer": 3.81697744806841e-05, "module_to_env_connector": {"timers": {"connectors": {"listify_data_for_vector_env": 1.1054248285169876e-05, "normalize_and_clip_actions": 9.550667555976365e-06, "get_actions": 4.102153968834296e-05, "un_batch_to_individual_items": 5.461463656434212e-06, "tensor_to_numpy": 1.3415672807914743e-05, "remove_single_ts_time_rank_from_batch": 6.008148544871867e-07}}, "connector_pipeline_timer": 0.00010695978383860985}, "episode_duration_sec_mean": 0.005408481003250929, "num_module_steps_sampled_lifetime": {"default_policy": -1842500.0}, "episode_len_min": 20, "episode_return_mean": 3.7, "episode_return_min": -9.5, "module_episode_returns_mean": {"default_policy": 3.7}, "episode_len_max": 20, "num_env_steps_sampled": 5000.0, "env_to_module_sum_episodes_length_in": 10.36823839457432, "num_env_steps_sampled_lifetime": -1842500.0, "num_env_steps_sampled_lifetime_throughput": 3624.983443084872}, "learners": {"__all_modules__": {"num_env_steps_trained_lifetime": 157500, "learner_connector": {"timers": {"connectors": {"add_observations_from_episodes_to_batch": 0.0008317989752009871, "add_time_dim_to_batch_and_zero_pad": 2.0564136861100555e-05, "add_columns_from_episodes_to_train_batch": 0.037701786666101494, "add_one_ts_to_episodes_and_truncate": 0.008046858816359276, "add_states_from_episodes_to_batch": 3.947242426654557e-06, "numpy_to_tensor": 0.0001014150200785615, "batch_individual_items": 0.03659607157350572, "general_advantage_estimation": 0.008332044707575863}}, "connector_pipeline_timer": 0.09181426052440407}, "learner_connector_sum_episodes_length_in": 5000.0, "num_env_steps_trained": 31500, "num_module_steps_trained": 6000, "num_non_trainable_parameters": 0, "num_module_steps_trained_lifetime": 30000, "num_trainable_parameters": 6003, "learner_connector_sum_episodes_length_out": 5250.0, "num_env_steps_trained_lifetime_throughput": 1908221.6845331946, "num_module_steps_trained_throughput": 364937.41263777897, "num_module_steps_trained_lifetime_throughput": 364385.840145174}, "default_policy": {"gradients_default_optimizer_global_norm": 0.03668160364031792, "weights_seq_no": 5.0, "num_module_steps_trained_lifetime": 30000, "num_trainable_parameters": 6003, "diff_num_grad_updates_vs_sampler_policy": 1.0, "policy_loss": 0.17475159466266632, "default_optimizer_learning_rate": 0.0002847858517, "vf_explained_var": -0.012585759162902832, "vf_loss": 0.10278083384037018, "vf_loss_unclipped": 28.88611602783203, "curr_entropy_coeff": 0.0090570820258, "module_train_batch_size_mean": 1000.0, "num_module_steps_trained": 6000, "total_loss": 0.23743394017219543, "mean_kl_loss": 0.0009778609964996576, "entropy": 0.6739362478256226, "curr_kl_coeff": 0.023328009992837906, "num_module_steps_trained_lifetime_throughput": 365592.8150649937}}, "num_training_step_calls_per_iteration": 1, "evaluation": {"env_runners": {"env_to_module_connector": {"timers": {"connectors": {"add_observations_from_episodes_to_batch": 2.7118012473294543e-06, "add_time_dim_to_batch_and_zero_pad": 2.269878182403424e-06, "add_states_from_episodes_to_batch": 1.5699423357627025e-06, "numpy_to_tensor": 8.119726085002955e-06, "batch_individual_items": 6.087641799570612e-06}}, "connector_pipeline_timer": 4.1815990005576594e-05}, "episode_return_mean": 1.45, "num_module_steps_sampled": {"default_policy": 400}, "num_episodes_lifetime": 100, "module_to_env_connector": {"timers": {"connectors": {"un_batch_to_individual_items": 5.267507999236195e-06, "tensor_to_numpy": 1.2547592270692807e-05, "listify_data_for_vector_env": 1.0821451805613743e-05, "remove_single_ts_time_rank_from_batch": 5.667769279701688e-07, "get_actions": 3.388950130014806e-05, "normalize_and_clip_actions": 9.289862061528572e-06}}, "connector_pipeline_timer": 9.72443609695985e-05}, "rlmodule_inference_timer": 2.5841008852424814e-05, "module_episode_returns_mean": {"default_policy": 1.45}, "env_to_module_sum_episodes_length_out": 10.368238387501162, "num_episodes": 20, "episode_return_max": 14.5, "env_reset_timer": 0.00046005494853927056, "episode_len_min": 20, "episode_return_min": -13.5, "episode_len_max": 20, "env_to_module_sum_episodes_length_in": 10.368238387501162, "num_env_steps_sampled_lifetime": 25400, "agent_episode_returns_mean": {"default_agent": 1.45}, "num_module_steps_sampled_lifetime": {"default_policy": 2000}, "sample": 0.11562263855833539, "episode_duration_sec_mean": 0.0049155791872181, "num_agent_steps_sampled": {"default_agent": 400}, "num_env_steps_sampled": 400, "weights_seq_no": 5.0, "episode_len_mean": 20.0, "env_step_timer": 1.3701833595916345e-05, "num_agent_steps_sampled_lifetime": {"default_agent": 2000}, "time_between_sampling": 1.648431079977568}, "num_healthy_workers": 1, "actor_manager_num_outstanding_async_reqs": 0, "num_remote_worker_restarts": 0}, "num_env_steps_sampled_lifetime": -1842500.0, "fault_tolerance": {"num_healthy_workers": 0, "num_remote_worker_restarts": 0}, "env_runner_group": {"actor_manager_num_outstanding_async_reqs": 0}, "done": false, "training_iteration": 5, "trial_id": "4dc31_00000", "date": "2025-08-11_19-19-31", "timestamp": 1754932771, "time_this_iter_s": 1.8120901584625244, "time_total_s": 8.834238052368164, "pid": 14098, "hostname": "Mac", "node_ip": "127.0.0.1", "config": {"exploration_config": {}, "extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "placement_strategy": "PACK", "num_gpus": 0, "_fake_gpus": false, "num_cpus_for_main_process": 2, "eager_tracing": true, "eager_max_retraces": 20, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "torch_compile_learner": false, "torch_compile_learner_what_to_compile": "forward_train", "torch_compile_learner_dynamo_backend": "aot_eager", "torch_compile_learner_dynamo_mode": null, "torch_compile_worker": false, "torch_compile_worker_dynamo_backend": "aot_eager", "torch_compile_worker_dynamo_mode": null, "torch_ddp_kwargs": {}, "torch_skip_nan_gradients": false, "env": "Umbrella", "env_config": {}, "observation_space": null, "action_space": null, "clip_rewards": null, "normalize_actions": true, "clip_actions": false, "_is_atari": null, "disable_env_checking": false, "render_env": false, "action_mask_key": "action_mask", "env_runner_cls": null, "num_env_runners": 0, "create_local_env_runner": true, "num_envs_per_env_runner": 1, "gym_env_vectorize_mode": "SYNC", "num_cpus_per_env_runner": 1, "num_gpus_per_env_runner": 0, "custom_resources_per_env_runner": {}, "validate_env_runners_after_construction": true, "episodes_to_numpy": true, "max_requests_in_flight_per_env_runner": 1, "sample_timeout_s": 60.0, "_env_to_module_connector": null, "add_default_connectors_to_env_to_module_pipeline": true, "_module_to_env_connector": null, "add_default_connectors_to_module_to_env_pipeline": true, "merge_env_runner_states": "training_only", "broadcast_env_runner_states": true, "episode_lookback_horizon": 1, "rollout_fragment_length": "auto", "batch_mode": "complete_episodes", "compress_observations": false, "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "enable_tf1_exec_eagerly": false, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "preprocessor_pref": "deepmind", "observation_filter": "NoFilter", "update_worker_filter_stats": true, "use_worker_filter_stats": true, "sampler_perf_stats_ema_coef": null, "_is_online": true, "num_learners": 0, "num_gpus_per_learner": 0, "num_cpus_per_learner": "auto", "num_aggregator_actors_per_learner": 0, "max_requests_in_flight_per_aggregator_actor": 3, "local_gpu_idx": 0, "max_requests_in_flight_per_learner": 3, "gamma": 1, "lr": 0.0002847858517, "grad_clip": 0.5, "grad_clip_by": "global_norm", "_train_batch_size_per_learner": 5000, "train_batch_size": 4000, "num_epochs": 1, "minibatch_size": 1000, "shuffle_batch_per_epoch": true, "model": {"fcnet_hiddens": [256, 256], "fcnet_activation": "tanh", "fcnet_weights_initializer": null, "fcnet_weights_initializer_config": null, "fcnet_bias_initializer": null, "fcnet_bias_initializer_config": null, "conv_filters": null, "conv_activation": "relu", "conv_kernel_initializer": null, "conv_kernel_initializer_config": null, "conv_bias_initializer": null, "conv_bias_initializer_config": null, "conv_transpose_kernel_initializer": null, "conv_transpose_kernel_initializer_config": null, "conv_transpose_bias_initializer": null, "conv_transpose_bias_initializer_config": null, "post_fcnet_hiddens": [], "post_fcnet_activation": "relu", "post_fcnet_weights_initializer": null, "post_fcnet_weights_initializer_config": null, "post_fcnet_bias_initializer": null, "post_fcnet_bias_initializer_config": null, "free_log_std": false, "log_std_clip_param": 20.0, "no_final_linear": false, "vf_share_layers": false, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "lstm_weights_initializer": null, "lstm_weights_initializer_config": null, "lstm_bias_initializer": null, "lstm_bias_initializer_config": null, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "attention_use_n_prev_actions": 0, "attention_use_n_prev_rewards": 0, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": null, "custom_model_config": {}, "custom_action_dist": null, "custom_preprocessor": null, "encoder_latent_dim": null, "always_check_shapes": false, "lstm_use_prev_action_reward": -1, "_use_default_native_models": -1, "_disable_preprocessor_api": false, "_disable_action_flattening": false}, "_learner_connector": null, "add_default_connectors_to_learner_pipeline": true, "learner_config_dict": {}, "optimizer": {}, "_learner_class": null, "callbacks_on_algorithm_init": null, "callbacks_on_env_runners_recreated": null, "callbacks_on_offline_eval_runners_recreated": null, "callbacks_on_checkpoint_loaded": null, "callbacks_on_environment_created": null, "callbacks_on_episode_created": null, "callbacks_on_episode_start": null, "callbacks_on_episode_step": null, "callbacks_on_episode_end": null, "callbacks_on_evaluate_start": null, "callbacks_on_evaluate_end": null, "callbacks_on_evaluate_offline_start": null, "callbacks_on_evaluate_offline_end": null, "callbacks_on_sample_end": null, "callbacks_on_train_result": null, "explore": true, "enable_rl_module_and_learner": true, "enable_env_runner_and_connector_v2": true, "_prior_exploration_config": {"type": "StochasticSampling"}, "count_steps_by": "env_steps", "policy_map_capacity": 100, "policy_mapping_fn": "<function AlgorithmConfig.DEFAULT_POLICY_MAPPING_FN at 0x385441b20>", "policies_to_train": null, "policy_states_are_swappable": false, "observation_fn": null, "offline_data_class": null, "input_read_method": "read_parquet", "input_read_method_kwargs": {}, "input_read_schema": {}, "input_read_episodes": false, "input_read_sample_batches": false, "input_read_batch_size": null, "input_filesystem": null, "input_filesystem_kwargs": {}, "input_compress_columns": ["obs", "new_obs"], "input_spaces_jsonable": true, "materialize_data": false, "materialize_mapped_data": true, "map_batches_kwargs": {}, "iter_batches_kwargs": {}, "ignore_final_observation": false, "prelearner_class": null, "prelearner_buffer_class": null, "prelearner_buffer_kwargs": {}, "prelearner_module_synch_period": 10, "dataset_num_iters_per_learner": null, "input_config": {}, "actions_in_input_normalized": false, "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_config": {}, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "output_max_rows_per_file": null, "output_write_remaining_data": false, "output_write_method": "write_parquet", "output_write_method_kwargs": {}, "output_filesystem": null, "output_filesystem_kwargs": {}, "output_write_episodes": true, "offline_sampling": false, "evaluation_interval": 1, "evaluation_duration": 20, "evaluation_duration_unit": "episodes", "evaluation_sample_timeout_s": 120.0, "evaluation_auto_duration_min_env_steps_per_sample": 100, "evaluation_auto_duration_max_env_steps_per_sample": 2000, "evaluation_parallel_to_training": false, "evaluation_force_reset_envs_before_iteration": true, "evaluation_config": null, "off_policy_estimation_methods": {}, "ope_split_batch_by_episode": true, "evaluation_num_env_runners": 1, "in_evaluation": false, "sync_filters_on_rollout_workers_timeout_s": 10.0, "offline_evaluation_interval": null, "num_offline_eval_runners": 0, "offline_loss_for_module_fn": null, "offline_evaluation_duration": 1, "offline_evaluation_parallel_to_training": false, "offline_evaluation_timeout_s": 120.0, "num_cpus_per_offline_eval_runner": 1, "num_gpus_per_offline_eval_runner": 0, "custom_resources_per_offline_eval_runner": {}, "restart_failed_offline_eval_runners": true, "ignore_offline_eval_runner_failures": false, "max_num_offline_eval_runner_restarts": 1000, "offline_eval_runner_restore_timeout_s": 1800.0, "max_requests_in_flight_per_offline_eval_runner": 1, "validate_offline_eval_runners_after_construction": true, "offline_eval_runner_health_probe_timeout_s": 30.0, "offline_eval_rl_module_inference_only": false, "broadcast_offline_eval_runner_states": false, "offline_eval_batch_size_per_runner": 256, "dataset_num_iters_per_eval_runner": 1, "keep_per_episode_custom_metrics": false, "metrics_episode_collection_timeout_s": 60.0, "metrics_num_episodes_for_smoothing": 100, "min_time_s_per_iteration": null, "min_train_timesteps_per_iteration": 0, "min_sample_timesteps_per_iteration": 0, "log_gradients": true, "export_native_model_files": false, "checkpoint_trainable_policies_only": false, "logger_creator": null, "logger_config": null, "log_level": "WARN", "log_sys_usage": true, "fake_sampler": false, "seed": 6, "restart_failed_env_runners": true, "ignore_env_runner_failures": false, "max_num_env_runner_restarts": 1000, "delay_between_env_runner_restarts_s": 60.0, "restart_failed_sub_environments": false, "num_consecutive_env_runner_failures_tolerance": 100, "env_runner_health_probe_timeout_s": 30.0, "env_runner_restore_timeout_s": 1800.0, "_model_config": {}, "_rl_module_spec": "RLModuleSpec(module_class=None, observation_space=None, action_space=None, inference_only=False, learner_only=False, model_config=DefaultModelConfig(fcnet_hiddens=[60, 90], fcnet_activation='tanh', fcnet_kernel_initializer=None, fcnet_kernel_initializer_kwargs=None, fcnet_bias_initializer=None, fcnet_bias_initializer_kwargs=None, conv_filters=None, conv_activation='relu', conv_kernel_initializer=None, conv_kernel_initializer_kwargs=None, conv_bias_initializer=None, conv_bias_initializer_kwargs=None, head_fcnet_hiddens=[], head_fcnet_activation='relu', head_fcnet_kernel_initializer=None, head_fcnet_kernel_initializer_kwargs=None, head_fcnet_bias_initializer=None, head_fcnet_bias_initializer_kwargs=None, free_log_std=False, log_std_clip_param=20.0, vf_share_layers=True, use_lstm=False, max_seq_len=20, lstm_cell_size=256, lstm_use_prev_action=False, lstm_use_prev_reward=False, lstm_kernel_initializer=None, lstm_kernel_initializer_kwargs=None, lstm_bias_initializer=None, lstm_bias_initializer_kwargs=None), catalog_class=None, load_state_path=None, model_config_dict=None)", "algorithm_config_overrides_per_module": {}, "_per_module_overrides": {}, "_validate_config": true, "_use_msgpack_checkpoints": false, "_torch_grad_scaler_class": null, "_torch_lr_scheduler_classes": null, "_tf_policy_handles_more_than_one_loss": false, "_disable_preprocessor_api": false, "_disable_action_flattening": false, "_disable_initialize_loss_from_dummy_batch": false, "_dont_auto_sync_env_runner_states": false, "env_task_fn": -1, "enable_connectors": -1, "simple_optimizer": false, "policy_map_cache": -1, "worker_cls": -1, "synchronize_filters": -1, "enable_async_evaluation": -1, "custom_async_evaluation_function": -1, "_enable_rl_module_api": -1, "auto_wrap_old_gym_envs": -1, "always_attach_evaluation_results": -1, "replay_sequence_length": null, "_disable_execution_plan_api": -1, "use_critic": true, "use_gae": true, "use_kl_loss": true, "kl_coeff": 0.7464963036515, "kl_target": 0.0270990929592, "vf_loss_coeff": 0.6688075857018, "entropy_coeff": 0.0090570820258, "clip_param": 0.1221781641624, "vf_clip_param": 0.1027808522125, "entropy_coeff_schedule": null, "lr_schedule": null, "sgd_minibatch_size": -1, "vf_share_layers": -1, "__stdout_file__": null, "__stderr_file__": null, "lambda": 0.9099046732075, "input": "sampler", "policies": {"default_policy": [null, null, null, null]}, "callbacks": "<class 'ray.rllib.callbacks.callbacks.RLlibCallback'>", "create_env_on_driver": false, "custom_eval_function": null, "framework": "torch"}, "time_since_restore": 8.834238052368164, "iterations_since_restore": 5, "perf": {"cpu_util_percent": 51.63333333333333, "ram_util_percent": 83.56666666666666}}
{"timers": {"training_iteration": 1.7284272685721107, "restore_env_runners": 1.8031532811610977e-05, "training_step": 1.7282824371954095, "env_runner_sampling_timer": 1.6012441984350718, "learner_update_timer": 0.12347233025964349, "synch_weights": 0.0008518422669815138, "restore_eval_env_runners": 8.827478165705689e-06, "evaluation_iteration": 0.13157472845617826, "synch_eval_env_connectors": 0.00014724169888618056, "synch_env_connectors": 5.106930422327715e-06}, "env_runners": {"num_episodes": 250.0, "num_agent_steps_sampled": {"default_agent": 5000.0}, "weights_seq_no": 5.0, "num_agent_steps_sampled_lifetime": {"default_agent": -2460000.0}, "num_episodes_lifetime": -123000.0, "env_to_module_connector": {"timers": {"connectors": {"add_states_from_episodes_to_batch": 1.7409819633935402e-06, "add_time_dim_to_batch_and_zero_pad": 2.3341958045087424e-06, "numpy_to_tensor": 8.680826409924162e-06, "batch_individual_items": 6.209233759336169e-06, "add_observations_from_episodes_to_batch": 2.9602061800633238e-06}}, "connector_pipeline_timer": 4.408364774310681e-05}, "sample": 0.005522954318989335, "num_module_steps_sampled": {"default_policy": 5000.0}, "rlmodule_inference_timer": 2.886852878524186e-05, "episode_return_max": 10.5, "agent_episode_returns_mean": {"default_agent": 3.06}, "episode_len_mean": 20.0, "time_between_sampling": 0.00155308929988347, "env_step_timer": 1.3870445474003093e-05, "env_to_module_sum_episodes_length_out": 10.36823839457432, "env_reset_timer": 3.675557645529756e-05, "module_to_env_connector": {"timers": {"connectors": {"listify_data_for_vector_env": 1.1039058428354407e-05, "normalize_and_clip_actions": 9.47996593886366e-06, "get_actions": 4.057717941533434e-05, "un_batch_to_individual_items": 5.4140738445780745e-06, "tensor_to_numpy": 1.325890536054812e-05, "remove_single_ts_time_rank_from_batch": 5.963174778720448e-07}}, "connector_pipeline_timer": 0.00010612967482277611}, "episode_duration_sec_mean": 0.004615308981388807, "num_module_steps_sampled_lifetime": {"default_policy": -2460000.0}, "episode_len_min": 20, "episode_return_mean": 3.06, "episode_return_min": -9.5, "module_episode_returns_mean": {"default_policy": 3.06}, "episode_len_max": 20, "num_env_steps_sampled": 5000.0, "env_to_module_sum_episodes_length_in": 10.36823839457432, "num_env_steps_sampled_lifetime": -2460000.0, "num_env_steps_sampled_lifetime_throughput": 3650.2354551309113}, "learners": {"__all_modules__": {"num_env_steps_trained_lifetime": 189000, "learner_connector": {"timers": {"connectors": {"add_observations_from_episodes_to_batch": 0.0008318209849254249, "add_time_dim_to_batch_and_zero_pad": 2.047807498276374e-05, "add_columns_from_episodes_to_train_batch": 0.037662295469631915, "add_one_ts_to_episodes_and_truncate": 0.008043704807589399, "add_states_from_episodes_to_batch": 3.936100835107815e-06, "numpy_to_tensor": 0.00010156127917929527, "batch_individual_items": 0.037493075437280234, "general_advantage_estimation": 0.008309864260388941}}, "connector_pipeline_timer": 0.09264615958932598}, "learner_connector_sum_episodes_length_in": 5000.0, "num_env_steps_trained": 31500, "num_module_steps_trained": 6000, "num_non_trainable_parameters": 0, "num_module_steps_trained_lifetime": 36000, "num_trainable_parameters": 6003, "learner_connector_sum_episodes_length_out": 5250.0, "num_env_steps_trained_lifetime_throughput": 1912384.5802117581, "num_module_steps_trained_throughput": 365683.66376218013, "num_module_steps_trained_lifetime_throughput": 365144.13612449967}, "default_policy": {"gradients_default_optimizer_global_norm": 0.07187046110630035, "weights_seq_no": 6.0, "num_module_steps_trained_lifetime": 36000, "num_trainable_parameters": 6003, "diff_num_grad_updates_vs_sampler_policy": 1.0, "policy_loss": -0.1344889998435974, "default_optimizer_learning_rate": 0.0002847858517, "vf_explained_var": -0.011776924133300781, "vf_loss": 0.10278083384037018, "vf_loss_unclipped": 29.362754821777344, "curr_entropy_coeff": 0.0090570820258, "module_train_batch_size_mean": 1000.0, "num_module_steps_trained": 6000, "total_loss": -0.0718490481376648, "mean_kl_loss": 9.713070176076144e-05, "entropy": 0.6738317012786865, "curr_kl_coeff": 0.011664004996418953, "num_module_steps_trained_lifetime_throughput": 366299.54802181554}}, "num_training_step_calls_per_iteration": 1, "evaluation": {"env_runners": {"env_to_module_connector": {"timers": {"connectors": {"add_observations_from_episodes_to_batch": 2.717665140185876e-06, "add_time_dim_to_batch_and_zero_pad": 2.268410296429642e-06, "add_states_from_episodes_to_batch": 1.5855178014984175e-06, "numpy_to_tensor": 8.128879510461179e-06, "batch_individual_items": 6.075075732663541e-06}}, "connector_pipeline_timer": 4.151618440941807e-05}, "episode_return_mean": 0.85, "num_module_steps_sampled": {"default_policy": 400}, "num_episodes_lifetime": 120, "module_to_env_connector": {"timers": {"connectors": {"un_batch_to_individual_items": 5.2615581314415375e-06, "tensor_to_numpy": 1.2698406744782686e-05, "listify_data_for_vector_env": 1.0853328178505063e-05, "remove_single_ts_time_rank_from_batch": 5.656495440332758e-07, "get_actions": 3.432059068750508e-05, "normalize_and_clip_actions": 9.258848543292899e-06}}, "connector_pipeline_timer": 9.772389573936343e-05}, "rlmodule_inference_timer": 2.6197890300800358e-05, "module_episode_returns_mean": {"default_policy": 0.85}, "env_to_module_sum_episodes_length_out": 10.368238394470474, "num_episodes": 20, "episode_return_max": 14.5, "env_reset_timer": 0.00045624023972911266, "episode_len_min": 20, "episode_return_min": -13.5, "episode_len_max": 20, "env_to_module_sum_episodes_length_in": 10.368238394470474, "num_env_steps_sampled_lifetime": 30400, "agent_episode_returns_mean": {"default_agent": 0.85}, "num_module_steps_sampled_lifetime": {"default_policy": 2400}, "sample": 0.11543443009197393, "episode_duration_sec_mean": 0.0047540220874361695, "num_agent_steps_sampled": {"default_agent": 400}, "num_env_steps_sampled": 400, "weights_seq_no": 6.0, "episode_len_mean": 20.0, "env_step_timer": 1.3735422478035833e-05, "num_agent_steps_sampled_lifetime": {"default_agent": 2400}, "time_between_sampling": 1.6481825920977815}, "num_healthy_workers": 1, "actor_manager_num_outstanding_async_reqs": 0, "num_remote_worker_restarts": 0}, "num_env_steps_sampled_lifetime": -2460000.0, "fault_tolerance": {"num_healthy_workers": 0, "num_remote_worker_restarts": 0}, "env_runner_group": {"actor_manager_num_outstanding_async_reqs": 0}, "done": false, "training_iteration": 6, "trial_id": "4dc31_00000", "date": "2025-08-11_19-19-32", "timestamp": 1754932772, "time_this_iter_s": 1.709029197692871, "time_total_s": 10.543267250061035, "pid": 14098, "hostname": "Mac", "node_ip": "127.0.0.1", "config": {"exploration_config": {}, "extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "placement_strategy": "PACK", "num_gpus": 0, "_fake_gpus": false, "num_cpus_for_main_process": 2, "eager_tracing": true, "eager_max_retraces": 20, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "torch_compile_learner": false, "torch_compile_learner_what_to_compile": "forward_train", "torch_compile_learner_dynamo_backend": "aot_eager", "torch_compile_learner_dynamo_mode": null, "torch_compile_worker": false, "torch_compile_worker_dynamo_backend": "aot_eager", "torch_compile_worker_dynamo_mode": null, "torch_ddp_kwargs": {}, "torch_skip_nan_gradients": false, "env": "Umbrella", "env_config": {}, "observation_space": null, "action_space": null, "clip_rewards": null, "normalize_actions": true, "clip_actions": false, "_is_atari": null, "disable_env_checking": false, "render_env": false, "action_mask_key": "action_mask", "env_runner_cls": null, "num_env_runners": 0, "create_local_env_runner": true, "num_envs_per_env_runner": 1, "gym_env_vectorize_mode": "SYNC", "num_cpus_per_env_runner": 1, "num_gpus_per_env_runner": 0, "custom_resources_per_env_runner": {}, "validate_env_runners_after_construction": true, "episodes_to_numpy": true, "max_requests_in_flight_per_env_runner": 1, "sample_timeout_s": 60.0, "_env_to_module_connector": null, "add_default_connectors_to_env_to_module_pipeline": true, "_module_to_env_connector": null, "add_default_connectors_to_module_to_env_pipeline": true, "merge_env_runner_states": "training_only", "broadcast_env_runner_states": true, "episode_lookback_horizon": 1, "rollout_fragment_length": "auto", "batch_mode": "complete_episodes", "compress_observations": false, "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "enable_tf1_exec_eagerly": false, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "preprocessor_pref": "deepmind", "observation_filter": "NoFilter", "update_worker_filter_stats": true, "use_worker_filter_stats": true, "sampler_perf_stats_ema_coef": null, "_is_online": true, "num_learners": 0, "num_gpus_per_learner": 0, "num_cpus_per_learner": "auto", "num_aggregator_actors_per_learner": 0, "max_requests_in_flight_per_aggregator_actor": 3, "local_gpu_idx": 0, "max_requests_in_flight_per_learner": 3, "gamma": 1, "lr": 0.0002847858517, "grad_clip": 0.5, "grad_clip_by": "global_norm", "_train_batch_size_per_learner": 5000, "train_batch_size": 4000, "num_epochs": 1, "minibatch_size": 1000, "shuffle_batch_per_epoch": true, "model": {"fcnet_hiddens": [256, 256], "fcnet_activation": "tanh", "fcnet_weights_initializer": null, "fcnet_weights_initializer_config": null, "fcnet_bias_initializer": null, "fcnet_bias_initializer_config": null, "conv_filters": null, "conv_activation": "relu", "conv_kernel_initializer": null, "conv_kernel_initializer_config": null, "conv_bias_initializer": null, "conv_bias_initializer_config": null, "conv_transpose_kernel_initializer": null, "conv_transpose_kernel_initializer_config": null, "conv_transpose_bias_initializer": null, "conv_transpose_bias_initializer_config": null, "post_fcnet_hiddens": [], "post_fcnet_activation": "relu", "post_fcnet_weights_initializer": null, "post_fcnet_weights_initializer_config": null, "post_fcnet_bias_initializer": null, "post_fcnet_bias_initializer_config": null, "free_log_std": false, "log_std_clip_param": 20.0, "no_final_linear": false, "vf_share_layers": false, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "lstm_weights_initializer": null, "lstm_weights_initializer_config": null, "lstm_bias_initializer": null, "lstm_bias_initializer_config": null, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "attention_use_n_prev_actions": 0, "attention_use_n_prev_rewards": 0, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": null, "custom_model_config": {}, "custom_action_dist": null, "custom_preprocessor": null, "encoder_latent_dim": null, "always_check_shapes": false, "lstm_use_prev_action_reward": -1, "_use_default_native_models": -1, "_disable_preprocessor_api": false, "_disable_action_flattening": false}, "_learner_connector": null, "add_default_connectors_to_learner_pipeline": true, "learner_config_dict": {}, "optimizer": {}, "_learner_class": null, "callbacks_on_algorithm_init": null, "callbacks_on_env_runners_recreated": null, "callbacks_on_offline_eval_runners_recreated": null, "callbacks_on_checkpoint_loaded": null, "callbacks_on_environment_created": null, "callbacks_on_episode_created": null, "callbacks_on_episode_start": null, "callbacks_on_episode_step": null, "callbacks_on_episode_end": null, "callbacks_on_evaluate_start": null, "callbacks_on_evaluate_end": null, "callbacks_on_evaluate_offline_start": null, "callbacks_on_evaluate_offline_end": null, "callbacks_on_sample_end": null, "callbacks_on_train_result": null, "explore": true, "enable_rl_module_and_learner": true, "enable_env_runner_and_connector_v2": true, "_prior_exploration_config": {"type": "StochasticSampling"}, "count_steps_by": "env_steps", "policy_map_capacity": 100, "policy_mapping_fn": "<function AlgorithmConfig.DEFAULT_POLICY_MAPPING_FN at 0x385441b20>", "policies_to_train": null, "policy_states_are_swappable": false, "observation_fn": null, "offline_data_class": null, "input_read_method": "read_parquet", "input_read_method_kwargs": {}, "input_read_schema": {}, "input_read_episodes": false, "input_read_sample_batches": false, "input_read_batch_size": null, "input_filesystem": null, "input_filesystem_kwargs": {}, "input_compress_columns": ["obs", "new_obs"], "input_spaces_jsonable": true, "materialize_data": false, "materialize_mapped_data": true, "map_batches_kwargs": {}, "iter_batches_kwargs": {}, "ignore_final_observation": false, "prelearner_class": null, "prelearner_buffer_class": null, "prelearner_buffer_kwargs": {}, "prelearner_module_synch_period": 10, "dataset_num_iters_per_learner": null, "input_config": {}, "actions_in_input_normalized": false, "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_config": {}, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "output_max_rows_per_file": null, "output_write_remaining_data": false, "output_write_method": "write_parquet", "output_write_method_kwargs": {}, "output_filesystem": null, "output_filesystem_kwargs": {}, "output_write_episodes": true, "offline_sampling": false, "evaluation_interval": 1, "evaluation_duration": 20, "evaluation_duration_unit": "episodes", "evaluation_sample_timeout_s": 120.0, "evaluation_auto_duration_min_env_steps_per_sample": 100, "evaluation_auto_duration_max_env_steps_per_sample": 2000, "evaluation_parallel_to_training": false, "evaluation_force_reset_envs_before_iteration": true, "evaluation_config": null, "off_policy_estimation_methods": {}, "ope_split_batch_by_episode": true, "evaluation_num_env_runners": 1, "in_evaluation": false, "sync_filters_on_rollout_workers_timeout_s": 10.0, "offline_evaluation_interval": null, "num_offline_eval_runners": 0, "offline_loss_for_module_fn": null, "offline_evaluation_duration": 1, "offline_evaluation_parallel_to_training": false, "offline_evaluation_timeout_s": 120.0, "num_cpus_per_offline_eval_runner": 1, "num_gpus_per_offline_eval_runner": 0, "custom_resources_per_offline_eval_runner": {}, "restart_failed_offline_eval_runners": true, "ignore_offline_eval_runner_failures": false, "max_num_offline_eval_runner_restarts": 1000, "offline_eval_runner_restore_timeout_s": 1800.0, "max_requests_in_flight_per_offline_eval_runner": 1, "validate_offline_eval_runners_after_construction": true, "offline_eval_runner_health_probe_timeout_s": 30.0, "offline_eval_rl_module_inference_only": false, "broadcast_offline_eval_runner_states": false, "offline_eval_batch_size_per_runner": 256, "dataset_num_iters_per_eval_runner": 1, "keep_per_episode_custom_metrics": false, "metrics_episode_collection_timeout_s": 60.0, "metrics_num_episodes_for_smoothing": 100, "min_time_s_per_iteration": null, "min_train_timesteps_per_iteration": 0, "min_sample_timesteps_per_iteration": 0, "log_gradients": true, "export_native_model_files": false, "checkpoint_trainable_policies_only": false, "logger_creator": null, "logger_config": null, "log_level": "WARN", "log_sys_usage": true, "fake_sampler": false, "seed": 6, "restart_failed_env_runners": true, "ignore_env_runner_failures": false, "max_num_env_runner_restarts": 1000, "delay_between_env_runner_restarts_s": 60.0, "restart_failed_sub_environments": false, "num_consecutive_env_runner_failures_tolerance": 100, "env_runner_health_probe_timeout_s": 30.0, "env_runner_restore_timeout_s": 1800.0, "_model_config": {}, "_rl_module_spec": "RLModuleSpec(module_class=None, observation_space=None, action_space=None, inference_only=False, learner_only=False, model_config=DefaultModelConfig(fcnet_hiddens=[60, 90], fcnet_activation='tanh', fcnet_kernel_initializer=None, fcnet_kernel_initializer_kwargs=None, fcnet_bias_initializer=None, fcnet_bias_initializer_kwargs=None, conv_filters=None, conv_activation='relu', conv_kernel_initializer=None, conv_kernel_initializer_kwargs=None, conv_bias_initializer=None, conv_bias_initializer_kwargs=None, head_fcnet_hiddens=[], head_fcnet_activation='relu', head_fcnet_kernel_initializer=None, head_fcnet_kernel_initializer_kwargs=None, head_fcnet_bias_initializer=None, head_fcnet_bias_initializer_kwargs=None, free_log_std=False, log_std_clip_param=20.0, vf_share_layers=True, use_lstm=False, max_seq_len=20, lstm_cell_size=256, lstm_use_prev_action=False, lstm_use_prev_reward=False, lstm_kernel_initializer=None, lstm_kernel_initializer_kwargs=None, lstm_bias_initializer=None, lstm_bias_initializer_kwargs=None), catalog_class=None, load_state_path=None, model_config_dict=None)", "algorithm_config_overrides_per_module": {}, "_per_module_overrides": {}, "_validate_config": true, "_use_msgpack_checkpoints": false, "_torch_grad_scaler_class": null, "_torch_lr_scheduler_classes": null, "_tf_policy_handles_more_than_one_loss": false, "_disable_preprocessor_api": false, "_disable_action_flattening": false, "_disable_initialize_loss_from_dummy_batch": false, "_dont_auto_sync_env_runner_states": false, "env_task_fn": -1, "enable_connectors": -1, "simple_optimizer": false, "policy_map_cache": -1, "worker_cls": -1, "synchronize_filters": -1, "enable_async_evaluation": -1, "custom_async_evaluation_function": -1, "_enable_rl_module_api": -1, "auto_wrap_old_gym_envs": -1, "always_attach_evaluation_results": -1, "replay_sequence_length": null, "_disable_execution_plan_api": -1, "use_critic": true, "use_gae": true, "use_kl_loss": true, "kl_coeff": 0.7464963036515, "kl_target": 0.0270990929592, "vf_loss_coeff": 0.6688075857018, "entropy_coeff": 0.0090570820258, "clip_param": 0.1221781641624, "vf_clip_param": 0.1027808522125, "entropy_coeff_schedule": null, "lr_schedule": null, "sgd_minibatch_size": -1, "vf_share_layers": -1, "__stdout_file__": null, "__stderr_file__": null, "lambda": 0.9099046732075, "input": "sampler", "policies": {"default_policy": [null, null, null, null]}, "callbacks": "<class 'ray.rllib.callbacks.callbacks.RLlibCallback'>", "create_env_on_driver": false, "custom_eval_function": null, "framework": "torch"}, "time_since_restore": 10.543267250061035, "iterations_since_restore": 6, "perf": {"cpu_util_percent": 47.75, "ram_util_percent": 83.6}}
{"timers": {"training_iteration": 1.7262136796364806, "restore_env_runners": 1.7908717339251627e-05, "training_step": 1.7260685594927994, "env_runner_sampling_timer": 1.5993410377009967, "learner_update_timer": 0.12316635736772305, "synch_weights": 0.0008494584242011749, "restore_eval_env_runners": 8.837953844941547e-06, "evaluation_iteration": 0.1312878507509298, "synch_eval_env_connectors": 0.00014695095212906338, "synch_env_connectors": 5.096281681995968e-06}, "env_runners": {"num_episodes": 250.0, "num_agent_steps_sampled": {"default_agent": 5000.0}, "weights_seq_no": 6.0, "num_agent_steps_sampled_lifetime": {"default_agent": -3077500.0}, "num_episodes_lifetime": -153875.0, "env_to_module_connector": {"timers": {"connectors": {"add_states_from_episodes_to_batch": 1.7541509941438776e-06, "add_time_dim_to_batch_and_zero_pad": 2.354366668174798e-06, "numpy_to_tensor": 8.78235149193474e-06, "batch_individual_items": 6.351667441805176e-06, "add_observations_from_episodes_to_batch": 3.0279362827017223e-06}}, "connector_pipeline_timer": 4.4475924750770754e-05}, "sample": 0.0049925889635381625, "num_module_steps_sampled": {"default_policy": 5000.0}, "rlmodule_inference_timer": 2.835050085052799e-05, "episode_return_max": 10.5, "agent_episode_returns_mean": {"default_agent": 4.5}, "episode_len_mean": 20.0, "time_between_sampling": 0.0018926880340371494, "env_step_timer": 1.3975453250501546e-05, "env_to_module_sum_episodes_length_out": 10.36823839457432, "env_reset_timer": 3.7002959850587896e-05, "module_to_env_connector": {"timers": {"connectors": {"listify_data_for_vector_env": 1.1174952455257806e-05, "normalize_and_clip_actions": 9.562623085055539e-06, "get_actions": 4.027837539817463e-05, "un_batch_to_individual_items": 5.500931816856594e-06, "tensor_to_numpy": 1.3383410009681789e-05, "remove_single_ts_time_rank_from_batch": 5.959429058541236e-07}}, "connector_pipeline_timer": 0.0001063342193525778}, "episode_duration_sec_mean": 0.004646492670290172, "num_module_steps_sampled_lifetime": {"default_policy": -3077500.0}, "episode_len_min": 20, "episode_return_mean": 4.5, "episode_return_min": -9.5, "module_episode_returns_mean": {"default_policy": 4.5}, "episode_len_max": 20, "num_env_steps_sampled": 5000.0, "env_to_module_sum_episodes_length_in": 10.36823839457432, "num_env_steps_sampled_lifetime": -3077500.0, "num_env_steps_sampled_lifetime_throughput": 3649.4654931085392}, "learners": {"__all_modules__": {"num_env_steps_trained_lifetime": 220500, "learner_connector": {"timers": {"connectors": {"add_observations_from_episodes_to_batch": 0.0008319936057360369, "add_time_dim_to_batch_and_zero_pad": 2.038579334333678e-05, "add_columns_from_episodes_to_train_batch": 0.037631410435078304, "add_one_ts_to_episodes_and_truncate": 0.00804255484985227, "add_states_from_episodes_to_batch": 3.925069495323321e-06, "numpy_to_tensor": 0.00010121607661453283, "batch_individual_items": 0.03742080051365395, "general_advantage_estimation": 0.008279838957880632}}, "connector_pipeline_timer": 0.09251075132302716}, "learner_connector_sum_episodes_length_in": 5000.0, "num_env_steps_trained": 31500, "num_module_steps_trained": 6000, "num_non_trainable_parameters": 0, "num_module_steps_trained_lifetime": 42000, "num_trainable_parameters": 6003, "learner_connector_sum_episodes_length_out": 5250.0, "num_env_steps_trained_lifetime_throughput": 1920419.6824032562, "num_module_steps_trained_throughput": 367166.6341342408, "num_module_steps_trained_lifetime_throughput": 366639.72387692134}, "default_policy": {"gradients_default_optimizer_global_norm": 0.118752621114254, "weights_seq_no": 7.0, "num_module_steps_trained_lifetime": 42000, "num_trainable_parameters": 6003, "diff_num_grad_updates_vs_sampler_policy": 1.0, "policy_loss": -0.04945483058691025, "default_optimizer_learning_rate": 0.0002847858517, "vf_explained_var": -0.012065649032592773, "vf_loss": 0.10278083384037018, "vf_loss_unclipped": 29.43939208984375, "curr_entropy_coeff": 0.0090570820258, "module_train_batch_size_mean": 1000.0, "num_module_steps_trained": 6000, "total_loss": 0.013212400488555431, "mean_kl_loss": 0.0001997690269490704, "entropy": 0.6708225607872009, "curr_kl_coeff": 0.0058320024982094765, "num_module_steps_trained_lifetime_throughput": 367734.79432612634}}, "num_training_step_calls_per_iteration": 1, "evaluation": {"env_runners": {"env_to_module_connector": {"timers": {"connectors": {"add_observations_from_episodes_to_batch": 2.7913256976406493e-06, "add_time_dim_to_batch_and_zero_pad": 2.2979421836578666e-06, "add_states_from_episodes_to_batch": 1.607173641160649e-06, "numpy_to_tensor": 8.324268109232891e-06, "batch_individual_items": 6.297396436052805e-06}}, "connector_pipeline_timer": 4.251947464101711e-05}, "episode_return_mean": 0.85, "num_module_steps_sampled": {"default_policy": 400}, "num_episodes_lifetime": 140, "module_to_env_connector": {"timers": {"connectors": {"un_batch_to_individual_items": 5.417293043289487e-06, "tensor_to_numpy": 1.3263916138952327e-05, "listify_data_for_vector_env": 1.1556932085184796e-05, "remove_single_ts_time_rank_from_batch": 5.744199744888685e-07, "get_actions": 3.5672328669312185e-05, "normalize_and_clip_actions": 9.571173626316275e-06}}, "connector_pipeline_timer": 0.00010170305947321296}, "rlmodule_inference_timer": 2.7452220353896334e-05, "module_episode_returns_mean": {"default_policy": 0.85}, "env_to_module_sum_episodes_length_out": 10.368238394572801, "num_episodes": 20, "episode_return_max": 14.5, "env_reset_timer": 0.00045275658710584545, "episode_len_min": 20, "episode_return_min": -13.5, "episode_len_max": 20, "env_to_module_sum_episodes_length_in": 10.368238394572801, "num_env_steps_sampled_lifetime": 35400, "agent_episode_returns_mean": {"default_agent": 0.85}, "num_module_steps_sampled_lifetime": {"default_policy": 2800}, "sample": 0.11525189079149907, "episode_duration_sec_mean": 0.004746666675200686, "num_agent_steps_sampled": {"default_agent": 400}, "num_env_steps_sampled": 400, "weights_seq_no": 7.0, "episode_len_mean": 20.0, "env_step_timer": 1.4558805143388852e-05, "num_agent_steps_sampled_lifetime": {"default_agent": 2800}, "time_between_sampling": 1.6469539836765068}, "num_healthy_workers": 1, "actor_manager_num_outstanding_async_reqs": 0, "num_remote_worker_restarts": 0}, "num_env_steps_sampled_lifetime": -3077500.0, "fault_tolerance": {"num_healthy_workers": 0, "num_remote_worker_restarts": 0}, "env_runner_group": {"actor_manager_num_outstanding_async_reqs": 0}, "done": false, "training_iteration": 7, "trial_id": "4dc31_00000", "date": "2025-08-11_19-19-34", "timestamp": 1754932774, "time_this_iter_s": 1.6116929054260254, "time_total_s": 12.15496015548706, "pid": 14098, "hostname": "Mac", "node_ip": "127.0.0.1", "config": {"exploration_config": {}, "extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "placement_strategy": "PACK", "num_gpus": 0, "_fake_gpus": false, "num_cpus_for_main_process": 2, "eager_tracing": true, "eager_max_retraces": 20, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "torch_compile_learner": false, "torch_compile_learner_what_to_compile": "forward_train", "torch_compile_learner_dynamo_backend": "aot_eager", "torch_compile_learner_dynamo_mode": null, "torch_compile_worker": false, "torch_compile_worker_dynamo_backend": "aot_eager", "torch_compile_worker_dynamo_mode": null, "torch_ddp_kwargs": {}, "torch_skip_nan_gradients": false, "env": "Umbrella", "env_config": {}, "observation_space": null, "action_space": null, "clip_rewards": null, "normalize_actions": true, "clip_actions": false, "_is_atari": null, "disable_env_checking": false, "render_env": false, "action_mask_key": "action_mask", "env_runner_cls": null, "num_env_runners": 0, "create_local_env_runner": true, "num_envs_per_env_runner": 1, "gym_env_vectorize_mode": "SYNC", "num_cpus_per_env_runner": 1, "num_gpus_per_env_runner": 0, "custom_resources_per_env_runner": {}, "validate_env_runners_after_construction": true, "episodes_to_numpy": true, "max_requests_in_flight_per_env_runner": 1, "sample_timeout_s": 60.0, "_env_to_module_connector": null, "add_default_connectors_to_env_to_module_pipeline": true, "_module_to_env_connector": null, "add_default_connectors_to_module_to_env_pipeline": true, "merge_env_runner_states": "training_only", "broadcast_env_runner_states": true, "episode_lookback_horizon": 1, "rollout_fragment_length": "auto", "batch_mode": "complete_episodes", "compress_observations": false, "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "enable_tf1_exec_eagerly": false, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "preprocessor_pref": "deepmind", "observation_filter": "NoFilter", "update_worker_filter_stats": true, "use_worker_filter_stats": true, "sampler_perf_stats_ema_coef": null, "_is_online": true, "num_learners": 0, "num_gpus_per_learner": 0, "num_cpus_per_learner": "auto", "num_aggregator_actors_per_learner": 0, "max_requests_in_flight_per_aggregator_actor": 3, "local_gpu_idx": 0, "max_requests_in_flight_per_learner": 3, "gamma": 1, "lr": 0.0002847858517, "grad_clip": 0.5, "grad_clip_by": "global_norm", "_train_batch_size_per_learner": 5000, "train_batch_size": 4000, "num_epochs": 1, "minibatch_size": 1000, "shuffle_batch_per_epoch": true, "model": {"fcnet_hiddens": [256, 256], "fcnet_activation": "tanh", "fcnet_weights_initializer": null, "fcnet_weights_initializer_config": null, "fcnet_bias_initializer": null, "fcnet_bias_initializer_config": null, "conv_filters": null, "conv_activation": "relu", "conv_kernel_initializer": null, "conv_kernel_initializer_config": null, "conv_bias_initializer": null, "conv_bias_initializer_config": null, "conv_transpose_kernel_initializer": null, "conv_transpose_kernel_initializer_config": null, "conv_transpose_bias_initializer": null, "conv_transpose_bias_initializer_config": null, "post_fcnet_hiddens": [], "post_fcnet_activation": "relu", "post_fcnet_weights_initializer": null, "post_fcnet_weights_initializer_config": null, "post_fcnet_bias_initializer": null, "post_fcnet_bias_initializer_config": null, "free_log_std": false, "log_std_clip_param": 20.0, "no_final_linear": false, "vf_share_layers": false, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "lstm_weights_initializer": null, "lstm_weights_initializer_config": null, "lstm_bias_initializer": null, "lstm_bias_initializer_config": null, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "attention_use_n_prev_actions": 0, "attention_use_n_prev_rewards": 0, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": null, "custom_model_config": {}, "custom_action_dist": null, "custom_preprocessor": null, "encoder_latent_dim": null, "always_check_shapes": false, "lstm_use_prev_action_reward": -1, "_use_default_native_models": -1, "_disable_preprocessor_api": false, "_disable_action_flattening": false}, "_learner_connector": null, "add_default_connectors_to_learner_pipeline": true, "learner_config_dict": {}, "optimizer": {}, "_learner_class": null, "callbacks_on_algorithm_init": null, "callbacks_on_env_runners_recreated": null, "callbacks_on_offline_eval_runners_recreated": null, "callbacks_on_checkpoint_loaded": null, "callbacks_on_environment_created": null, "callbacks_on_episode_created": null, "callbacks_on_episode_start": null, "callbacks_on_episode_step": null, "callbacks_on_episode_end": null, "callbacks_on_evaluate_start": null, "callbacks_on_evaluate_end": null, "callbacks_on_evaluate_offline_start": null, "callbacks_on_evaluate_offline_end": null, "callbacks_on_sample_end": null, "callbacks_on_train_result": null, "explore": true, "enable_rl_module_and_learner": true, "enable_env_runner_and_connector_v2": true, "_prior_exploration_config": {"type": "StochasticSampling"}, "count_steps_by": "env_steps", "policy_map_capacity": 100, "policy_mapping_fn": "<function AlgorithmConfig.DEFAULT_POLICY_MAPPING_FN at 0x385441b20>", "policies_to_train": null, "policy_states_are_swappable": false, "observation_fn": null, "offline_data_class": null, "input_read_method": "read_parquet", "input_read_method_kwargs": {}, "input_read_schema": {}, "input_read_episodes": false, "input_read_sample_batches": false, "input_read_batch_size": null, "input_filesystem": null, "input_filesystem_kwargs": {}, "input_compress_columns": ["obs", "new_obs"], "input_spaces_jsonable": true, "materialize_data": false, "materialize_mapped_data": true, "map_batches_kwargs": {}, "iter_batches_kwargs": {}, "ignore_final_observation": false, "prelearner_class": null, "prelearner_buffer_class": null, "prelearner_buffer_kwargs": {}, "prelearner_module_synch_period": 10, "dataset_num_iters_per_learner": null, "input_config": {}, "actions_in_input_normalized": false, "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_config": {}, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "output_max_rows_per_file": null, "output_write_remaining_data": false, "output_write_method": "write_parquet", "output_write_method_kwargs": {}, "output_filesystem": null, "output_filesystem_kwargs": {}, "output_write_episodes": true, "offline_sampling": false, "evaluation_interval": 1, "evaluation_duration": 20, "evaluation_duration_unit": "episodes", "evaluation_sample_timeout_s": 120.0, "evaluation_auto_duration_min_env_steps_per_sample": 100, "evaluation_auto_duration_max_env_steps_per_sample": 2000, "evaluation_parallel_to_training": false, "evaluation_force_reset_envs_before_iteration": true, "evaluation_config": null, "off_policy_estimation_methods": {}, "ope_split_batch_by_episode": true, "evaluation_num_env_runners": 1, "in_evaluation": false, "sync_filters_on_rollout_workers_timeout_s": 10.0, "offline_evaluation_interval": null, "num_offline_eval_runners": 0, "offline_loss_for_module_fn": null, "offline_evaluation_duration": 1, "offline_evaluation_parallel_to_training": false, "offline_evaluation_timeout_s": 120.0, "num_cpus_per_offline_eval_runner": 1, "num_gpus_per_offline_eval_runner": 0, "custom_resources_per_offline_eval_runner": {}, "restart_failed_offline_eval_runners": true, "ignore_offline_eval_runner_failures": false, "max_num_offline_eval_runner_restarts": 1000, "offline_eval_runner_restore_timeout_s": 1800.0, "max_requests_in_flight_per_offline_eval_runner": 1, "validate_offline_eval_runners_after_construction": true, "offline_eval_runner_health_probe_timeout_s": 30.0, "offline_eval_rl_module_inference_only": false, "broadcast_offline_eval_runner_states": false, "offline_eval_batch_size_per_runner": 256, "dataset_num_iters_per_eval_runner": 1, "keep_per_episode_custom_metrics": false, "metrics_episode_collection_timeout_s": 60.0, "metrics_num_episodes_for_smoothing": 100, "min_time_s_per_iteration": null, "min_train_timesteps_per_iteration": 0, "min_sample_timesteps_per_iteration": 0, "log_gradients": true, "export_native_model_files": false, "checkpoint_trainable_policies_only": false, "logger_creator": null, "logger_config": null, "log_level": "WARN", "log_sys_usage": true, "fake_sampler": false, "seed": 6, "restart_failed_env_runners": true, "ignore_env_runner_failures": false, "max_num_env_runner_restarts": 1000, "delay_between_env_runner_restarts_s": 60.0, "restart_failed_sub_environments": false, "num_consecutive_env_runner_failures_tolerance": 100, "env_runner_health_probe_timeout_s": 30.0, "env_runner_restore_timeout_s": 1800.0, "_model_config": {}, "_rl_module_spec": "RLModuleSpec(module_class=None, observation_space=None, action_space=None, inference_only=False, learner_only=False, model_config=DefaultModelConfig(fcnet_hiddens=[60, 90], fcnet_activation='tanh', fcnet_kernel_initializer=None, fcnet_kernel_initializer_kwargs=None, fcnet_bias_initializer=None, fcnet_bias_initializer_kwargs=None, conv_filters=None, conv_activation='relu', conv_kernel_initializer=None, conv_kernel_initializer_kwargs=None, conv_bias_initializer=None, conv_bias_initializer_kwargs=None, head_fcnet_hiddens=[], head_fcnet_activation='relu', head_fcnet_kernel_initializer=None, head_fcnet_kernel_initializer_kwargs=None, head_fcnet_bias_initializer=None, head_fcnet_bias_initializer_kwargs=None, free_log_std=False, log_std_clip_param=20.0, vf_share_layers=True, use_lstm=False, max_seq_len=20, lstm_cell_size=256, lstm_use_prev_action=False, lstm_use_prev_reward=False, lstm_kernel_initializer=None, lstm_kernel_initializer_kwargs=None, lstm_bias_initializer=None, lstm_bias_initializer_kwargs=None), catalog_class=None, load_state_path=None, model_config_dict=None)", "algorithm_config_overrides_per_module": {}, "_per_module_overrides": {}, "_validate_config": true, "_use_msgpack_checkpoints": false, "_torch_grad_scaler_class": null, "_torch_lr_scheduler_classes": null, "_tf_policy_handles_more_than_one_loss": false, "_disable_preprocessor_api": false, "_disable_action_flattening": false, "_disable_initialize_loss_from_dummy_batch": false, "_dont_auto_sync_env_runner_states": false, "env_task_fn": -1, "enable_connectors": -1, "simple_optimizer": false, "policy_map_cache": -1, "worker_cls": -1, "synchronize_filters": -1, "enable_async_evaluation": -1, "custom_async_evaluation_function": -1, "_enable_rl_module_api": -1, "auto_wrap_old_gym_envs": -1, "always_attach_evaluation_results": -1, "replay_sequence_length": null, "_disable_execution_plan_api": -1, "use_critic": true, "use_gae": true, "use_kl_loss": true, "kl_coeff": 0.7464963036515, "kl_target": 0.0270990929592, "vf_loss_coeff": 0.6688075857018, "entropy_coeff": 0.0090570820258, "clip_param": 0.1221781641624, "vf_clip_param": 0.1027808522125, "entropy_coeff_schedule": null, "lr_schedule": null, "sgd_minibatch_size": -1, "vf_share_layers": -1, "__stdout_file__": null, "__stderr_file__": null, "lambda": 0.9099046732075, "input": "sampler", "policies": {"default_policy": [null, null, null, null]}, "callbacks": "<class 'ray.rllib.callbacks.callbacks.RLlibCallback'>", "create_env_on_driver": false, "custom_eval_function": null, "framework": "torch"}, "time_since_restore": 12.15496015548706, "iterations_since_restore": 7, "perf": {"cpu_util_percent": 48.9, "ram_util_percent": 83.13333333333333}}
{"timers": {"training_iteration": 1.725455332430322, "restore_env_runners": 1.7808380474462157e-05, "training_step": 1.7253096784880966, "env_runner_sampling_timer": 1.5988477889939021, "learner_update_timer": 0.12290176462456606, "synch_weights": 0.0008483292499424852, "restore_eval_env_runners": 8.815823937837404e-06, "evaluation_iteration": 0.13099917433317723, "synch_eval_env_connectors": 0.0001465493517870281, "synch_env_connectors": 5.088648647959993e-06}, "env_runners": {"num_episodes": 250.0, "num_agent_steps_sampled": {"default_agent": 5000.0}, "weights_seq_no": 7.0, "num_agent_steps_sampled_lifetime": {"default_agent": -3695000.0}, "num_episodes_lifetime": -184750.0, "env_to_module_connector": {"timers": {"connectors": {"add_states_from_episodes_to_batch": 1.7838895724320942e-06, "add_time_dim_to_batch_and_zero_pad": 2.4234578979019434e-06, "numpy_to_tensor": 9.060779763329696e-06, "batch_individual_items": 6.834702598823059e-06, "add_observations_from_episodes_to_batch": 3.220543841605043e-06}}, "connector_pipeline_timer": 4.610249022591732e-05}, "sample": 0.0053176278393853625, "num_module_steps_sampled": {"default_policy": 5000.0}, "rlmodule_inference_timer": 4.547459561524131e-05, "episode_return_max": 10.5, "agent_episode_returns_mean": {"default_agent": 3.4599999999999995}, "episode_len_mean": 20.0, "time_between_sampling": 0.0015501630254021767, "env_step_timer": 1.4581605315882264e-05, "env_to_module_sum_episodes_length_out": 10.36823839457432, "env_reset_timer": 3.770507537791969e-05, "module_to_env_connector": {"timers": {"connectors": {"listify_data_for_vector_env": 1.155787135005861e-05, "normalize_and_clip_actions": 9.827789139095286e-06, "get_actions": 4.250144307220485e-05, "un_batch_to_individual_items": 5.69119156613465e-06, "tensor_to_numpy": 1.39563021548559e-05, "remove_single_ts_time_rank_from_batch": 6.214144306848667e-07}}, "connector_pipeline_timer": 0.00011084705587625376}, "episode_duration_sec_mean": 0.005185768332332374, "num_module_steps_sampled_lifetime": {"default_policy": -3695000.0}, "episode_len_min": 20, "episode_return_mean": 3.4599999999999995, "episode_return_min": -9.5, "module_episode_returns_mean": {"default_policy": 3.4599999999999995}, "episode_len_max": 20, "num_env_steps_sampled": 5000.0, "env_to_module_sum_episodes_length_in": 10.36823839457432, "num_env_steps_sampled_lifetime": -3695000.0, "num_env_steps_sampled_lifetime_throughput": 3564.2003616483826}, "learners": {"__all_modules__": {"num_env_steps_trained_lifetime": 252000, "learner_connector": {"timers": {"connectors": {"add_observations_from_episodes_to_batch": 0.0008350407597250823, "add_time_dim_to_batch_and_zero_pad": 2.029401542514551e-05, "add_columns_from_episodes_to_train_batch": 0.03759630799056131, "add_one_ts_to_episodes_and_truncate": 0.00804060721207356, "add_states_from_episodes_to_batch": 3.921238162035933e-06, "numpy_to_tensor": 0.0001008826660690737, "batch_individual_items": 0.037359898338867555, "general_advantage_estimation": 0.008268028068086504}}, "connector_pipeline_timer": 0.09240302505930478}, "learner_connector_sum_episodes_length_in": 5000.0, "num_env_steps_trained": 31500, "num_module_steps_trained": 6000, "num_non_trainable_parameters": 0, "num_module_steps_trained_lifetime": 48000, "num_trainable_parameters": 6003, "learner_connector_sum_episodes_length_out": 5250.0, "num_env_steps_trained_lifetime_throughput": 1928460.3573509248, "num_module_steps_trained_throughput": 368650.8729957071, "num_module_steps_trained_lifetime_throughput": 368136.70452894556}, "default_policy": {"gradients_default_optimizer_global_norm": 0.023772811517119408, "weights_seq_no": 8.0, "num_module_steps_trained_lifetime": 48000, "num_trainable_parameters": 6003, "diff_num_grad_updates_vs_sampler_policy": 1.0, "policy_loss": -0.044244833290576935, "default_optimizer_learning_rate": 0.0002847858517, "vf_explained_var": -0.013218998908996582, "vf_loss": 0.10278083384037018, "vf_loss_unclipped": 29.270179748535156, "curr_entropy_coeff": 0.0090570820258, "module_train_batch_size_mean": 1000.0, "num_module_steps_trained": 6000, "total_loss": 0.018546825274825096, "mean_kl_loss": 0.0009722818504087627, "entropy": 0.6574549674987793, "curr_kl_coeff": 0.0029160012491047382, "num_module_steps_trained_lifetime_throughput": 369167.5635740709}}, "num_training_step_calls_per_iteration": 1, "evaluation": {"env_runners": {"env_to_module_connector": {"timers": {"connectors": {"add_observations_from_episodes_to_batch": 2.8936916818554445e-06, "add_time_dim_to_batch_and_zero_pad": 2.395538089535932e-06, "add_states_from_episodes_to_batch": 1.638680383261764e-06, "numpy_to_tensor": 8.736426263980767e-06, "batch_individual_items": 6.299229592281805e-06}}, "connector_pipeline_timer": 4.388367773453009e-05}, "episode_return_mean": 0.65, "num_module_steps_sampled": {"default_policy": 400}, "num_episodes_lifetime": 160, "module_to_env_connector": {"timers": {"connectors": {"un_batch_to_individual_items": 5.790976847586716e-06, "tensor_to_numpy": 1.3651958792316102e-05, "listify_data_for_vector_env": 1.1507863320615068e-05, "remove_single_ts_time_rank_from_batch": 6.112900152416105e-07, "get_actions": 3.725067988964122e-05, "normalize_and_clip_actions": 9.918173990007796e-06}}, "connector_pipeline_timer": 0.0001051597161670369}, "rlmodule_inference_timer": 3.076000313199017e-05, "module_episode_returns_mean": {"default_policy": 0.65}, "env_to_module_sum_episodes_length_out": 10.3682383945743, "num_episodes": 20, "episode_return_max": 14.5, "env_reset_timer": 0.00044898861141910306, "episode_len_min": 20, "episode_return_min": -13.5, "episode_len_max": 20, "env_to_module_sum_episodes_length_in": 10.3682383945743, "num_env_steps_sampled_lifetime": 40400, "agent_episode_returns_mean": {"default_agent": 0.65}, "num_module_steps_sampled_lifetime": {"default_policy": 3200}, "sample": 0.11512893896296982, "episode_duration_sec_mean": 0.004506243354408071, "num_agent_steps_sampled": {"default_agent": 400}, "num_env_steps_sampled": 400, "weights_seq_no": 8.0, "episode_len_mean": 20.0, "env_step_timer": 1.469489623355358e-05, "num_agent_steps_sampled_lifetime": {"default_agent": 3200}, "time_between_sampling": 1.6471849559197294}, "num_healthy_workers": 1, "actor_manager_num_outstanding_async_reqs": 0, "num_remote_worker_restarts": 0}, "num_env_steps_sampled_lifetime": -3695000.0, "fault_tolerance": {"num_healthy_workers": 0, "num_remote_worker_restarts": 0}, "env_runner_group": {"actor_manager_num_outstanding_async_reqs": 0}, "done": false, "training_iteration": 8, "trial_id": "4dc31_00000", "date": "2025-08-11_19-19-36", "timestamp": 1754932776, "time_this_iter_s": 1.7610859870910645, "time_total_s": 13.916046142578125, "pid": 14098, "hostname": "Mac", "node_ip": "127.0.0.1", "config": {"exploration_config": {}, "extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "placement_strategy": "PACK", "num_gpus": 0, "_fake_gpus": false, "num_cpus_for_main_process": 2, "eager_tracing": true, "eager_max_retraces": 20, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "torch_compile_learner": false, "torch_compile_learner_what_to_compile": "forward_train", "torch_compile_learner_dynamo_backend": "aot_eager", "torch_compile_learner_dynamo_mode": null, "torch_compile_worker": false, "torch_compile_worker_dynamo_backend": "aot_eager", "torch_compile_worker_dynamo_mode": null, "torch_ddp_kwargs": {}, "torch_skip_nan_gradients": false, "env": "Umbrella", "env_config": {}, "observation_space": null, "action_space": null, "clip_rewards": null, "normalize_actions": true, "clip_actions": false, "_is_atari": null, "disable_env_checking": false, "render_env": false, "action_mask_key": "action_mask", "env_runner_cls": null, "num_env_runners": 0, "create_local_env_runner": true, "num_envs_per_env_runner": 1, "gym_env_vectorize_mode": "SYNC", "num_cpus_per_env_runner": 1, "num_gpus_per_env_runner": 0, "custom_resources_per_env_runner": {}, "validate_env_runners_after_construction": true, "episodes_to_numpy": true, "max_requests_in_flight_per_env_runner": 1, "sample_timeout_s": 60.0, "_env_to_module_connector": null, "add_default_connectors_to_env_to_module_pipeline": true, "_module_to_env_connector": null, "add_default_connectors_to_module_to_env_pipeline": true, "merge_env_runner_states": "training_only", "broadcast_env_runner_states": true, "episode_lookback_horizon": 1, "rollout_fragment_length": "auto", "batch_mode": "complete_episodes", "compress_observations": false, "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "enable_tf1_exec_eagerly": false, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "preprocessor_pref": "deepmind", "observation_filter": "NoFilter", "update_worker_filter_stats": true, "use_worker_filter_stats": true, "sampler_perf_stats_ema_coef": null, "_is_online": true, "num_learners": 0, "num_gpus_per_learner": 0, "num_cpus_per_learner": "auto", "num_aggregator_actors_per_learner": 0, "max_requests_in_flight_per_aggregator_actor": 3, "local_gpu_idx": 0, "max_requests_in_flight_per_learner": 3, "gamma": 1, "lr": 0.0002847858517, "grad_clip": 0.5, "grad_clip_by": "global_norm", "_train_batch_size_per_learner": 5000, "train_batch_size": 4000, "num_epochs": 1, "minibatch_size": 1000, "shuffle_batch_per_epoch": true, "model": {"fcnet_hiddens": [256, 256], "fcnet_activation": "tanh", "fcnet_weights_initializer": null, "fcnet_weights_initializer_config": null, "fcnet_bias_initializer": null, "fcnet_bias_initializer_config": null, "conv_filters": null, "conv_activation": "relu", "conv_kernel_initializer": null, "conv_kernel_initializer_config": null, "conv_bias_initializer": null, "conv_bias_initializer_config": null, "conv_transpose_kernel_initializer": null, "conv_transpose_kernel_initializer_config": null, "conv_transpose_bias_initializer": null, "conv_transpose_bias_initializer_config": null, "post_fcnet_hiddens": [], "post_fcnet_activation": "relu", "post_fcnet_weights_initializer": null, "post_fcnet_weights_initializer_config": null, "post_fcnet_bias_initializer": null, "post_fcnet_bias_initializer_config": null, "free_log_std": false, "log_std_clip_param": 20.0, "no_final_linear": false, "vf_share_layers": false, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "lstm_weights_initializer": null, "lstm_weights_initializer_config": null, "lstm_bias_initializer": null, "lstm_bias_initializer_config": null, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "attention_use_n_prev_actions": 0, "attention_use_n_prev_rewards": 0, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": null, "custom_model_config": {}, "custom_action_dist": null, "custom_preprocessor": null, "encoder_latent_dim": null, "always_check_shapes": false, "lstm_use_prev_action_reward": -1, "_use_default_native_models": -1, "_disable_preprocessor_api": false, "_disable_action_flattening": false}, "_learner_connector": null, "add_default_connectors_to_learner_pipeline": true, "learner_config_dict": {}, "optimizer": {}, "_learner_class": null, "callbacks_on_algorithm_init": null, "callbacks_on_env_runners_recreated": null, "callbacks_on_offline_eval_runners_recreated": null, "callbacks_on_checkpoint_loaded": null, "callbacks_on_environment_created": null, "callbacks_on_episode_created": null, "callbacks_on_episode_start": null, "callbacks_on_episode_step": null, "callbacks_on_episode_end": null, "callbacks_on_evaluate_start": null, "callbacks_on_evaluate_end": null, "callbacks_on_evaluate_offline_start": null, "callbacks_on_evaluate_offline_end": null, "callbacks_on_sample_end": null, "callbacks_on_train_result": null, "explore": true, "enable_rl_module_and_learner": true, "enable_env_runner_and_connector_v2": true, "_prior_exploration_config": {"type": "StochasticSampling"}, "count_steps_by": "env_steps", "policy_map_capacity": 100, "policy_mapping_fn": "<function AlgorithmConfig.DEFAULT_POLICY_MAPPING_FN at 0x385441b20>", "policies_to_train": null, "policy_states_are_swappable": false, "observation_fn": null, "offline_data_class": null, "input_read_method": "read_parquet", "input_read_method_kwargs": {}, "input_read_schema": {}, "input_read_episodes": false, "input_read_sample_batches": false, "input_read_batch_size": null, "input_filesystem": null, "input_filesystem_kwargs": {}, "input_compress_columns": ["obs", "new_obs"], "input_spaces_jsonable": true, "materialize_data": false, "materialize_mapped_data": true, "map_batches_kwargs": {}, "iter_batches_kwargs": {}, "ignore_final_observation": false, "prelearner_class": null, "prelearner_buffer_class": null, "prelearner_buffer_kwargs": {}, "prelearner_module_synch_period": 10, "dataset_num_iters_per_learner": null, "input_config": {}, "actions_in_input_normalized": false, "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_config": {}, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "output_max_rows_per_file": null, "output_write_remaining_data": false, "output_write_method": "write_parquet", "output_write_method_kwargs": {}, "output_filesystem": null, "output_filesystem_kwargs": {}, "output_write_episodes": true, "offline_sampling": false, "evaluation_interval": 1, "evaluation_duration": 20, "evaluation_duration_unit": "episodes", "evaluation_sample_timeout_s": 120.0, "evaluation_auto_duration_min_env_steps_per_sample": 100, "evaluation_auto_duration_max_env_steps_per_sample": 2000, "evaluation_parallel_to_training": false, "evaluation_force_reset_envs_before_iteration": true, "evaluation_config": null, "off_policy_estimation_methods": {}, "ope_split_batch_by_episode": true, "evaluation_num_env_runners": 1, "in_evaluation": false, "sync_filters_on_rollout_workers_timeout_s": 10.0, "offline_evaluation_interval": null, "num_offline_eval_runners": 0, "offline_loss_for_module_fn": null, "offline_evaluation_duration": 1, "offline_evaluation_parallel_to_training": false, "offline_evaluation_timeout_s": 120.0, "num_cpus_per_offline_eval_runner": 1, "num_gpus_per_offline_eval_runner": 0, "custom_resources_per_offline_eval_runner": {}, "restart_failed_offline_eval_runners": true, "ignore_offline_eval_runner_failures": false, "max_num_offline_eval_runner_restarts": 1000, "offline_eval_runner_restore_timeout_s": 1800.0, "max_requests_in_flight_per_offline_eval_runner": 1, "validate_offline_eval_runners_after_construction": true, "offline_eval_runner_health_probe_timeout_s": 30.0, "offline_eval_rl_module_inference_only": false, "broadcast_offline_eval_runner_states": false, "offline_eval_batch_size_per_runner": 256, "dataset_num_iters_per_eval_runner": 1, "keep_per_episode_custom_metrics": false, "metrics_episode_collection_timeout_s": 60.0, "metrics_num_episodes_for_smoothing": 100, "min_time_s_per_iteration": null, "min_train_timesteps_per_iteration": 0, "min_sample_timesteps_per_iteration": 0, "log_gradients": true, "export_native_model_files": false, "checkpoint_trainable_policies_only": false, "logger_creator": null, "logger_config": null, "log_level": "WARN", "log_sys_usage": true, "fake_sampler": false, "seed": 6, "restart_failed_env_runners": true, "ignore_env_runner_failures": false, "max_num_env_runner_restarts": 1000, "delay_between_env_runner_restarts_s": 60.0, "restart_failed_sub_environments": false, "num_consecutive_env_runner_failures_tolerance": 100, "env_runner_health_probe_timeout_s": 30.0, "env_runner_restore_timeout_s": 1800.0, "_model_config": {}, "_rl_module_spec": "RLModuleSpec(module_class=None, observation_space=None, action_space=None, inference_only=False, learner_only=False, model_config=DefaultModelConfig(fcnet_hiddens=[60, 90], fcnet_activation='tanh', fcnet_kernel_initializer=None, fcnet_kernel_initializer_kwargs=None, fcnet_bias_initializer=None, fcnet_bias_initializer_kwargs=None, conv_filters=None, conv_activation='relu', conv_kernel_initializer=None, conv_kernel_initializer_kwargs=None, conv_bias_initializer=None, conv_bias_initializer_kwargs=None, head_fcnet_hiddens=[], head_fcnet_activation='relu', head_fcnet_kernel_initializer=None, head_fcnet_kernel_initializer_kwargs=None, head_fcnet_bias_initializer=None, head_fcnet_bias_initializer_kwargs=None, free_log_std=False, log_std_clip_param=20.0, vf_share_layers=True, use_lstm=False, max_seq_len=20, lstm_cell_size=256, lstm_use_prev_action=False, lstm_use_prev_reward=False, lstm_kernel_initializer=None, lstm_kernel_initializer_kwargs=None, lstm_bias_initializer=None, lstm_bias_initializer_kwargs=None), catalog_class=None, load_state_path=None, model_config_dict=None)", "algorithm_config_overrides_per_module": {}, "_per_module_overrides": {}, "_validate_config": true, "_use_msgpack_checkpoints": false, "_torch_grad_scaler_class": null, "_torch_lr_scheduler_classes": null, "_tf_policy_handles_more_than_one_loss": false, "_disable_preprocessor_api": false, "_disable_action_flattening": false, "_disable_initialize_loss_from_dummy_batch": false, "_dont_auto_sync_env_runner_states": false, "env_task_fn": -1, "enable_connectors": -1, "simple_optimizer": false, "policy_map_cache": -1, "worker_cls": -1, "synchronize_filters": -1, "enable_async_evaluation": -1, "custom_async_evaluation_function": -1, "_enable_rl_module_api": -1, "auto_wrap_old_gym_envs": -1, "always_attach_evaluation_results": -1, "replay_sequence_length": null, "_disable_execution_plan_api": -1, "use_critic": true, "use_gae": true, "use_kl_loss": true, "kl_coeff": 0.7464963036515, "kl_target": 0.0270990929592, "vf_loss_coeff": 0.6688075857018, "entropy_coeff": 0.0090570820258, "clip_param": 0.1221781641624, "vf_clip_param": 0.1027808522125, "entropy_coeff_schedule": null, "lr_schedule": null, "sgd_minibatch_size": -1, "vf_share_layers": -1, "__stdout_file__": null, "__stderr_file__": null, "lambda": 0.9099046732075, "input": "sampler", "policies": {"default_policy": [null, null, null, null]}, "callbacks": "<class 'ray.rllib.callbacks.callbacks.RLlibCallback'>", "create_env_on_driver": false, "custom_eval_function": null, "framework": "torch"}, "time_since_restore": 13.916046142578125, "iterations_since_restore": 8, "perf": {"cpu_util_percent": 47.4, "ram_util_percent": 83.1}}
{"timers": {"training_iteration": 1.7256692382663188, "restore_env_runners": 1.7711136633347377e-05, "training_step": 1.7255233133625851, "env_runner_sampling_timer": 1.5977026398539569, "learner_update_timer": 0.12426185280814975, "synch_weights": 0.0008460534575618226, "restore_eval_env_runners": 8.820586080034852e-06, "evaluation_iteration": 0.13077295299930472, "synch_eval_env_connectors": 0.00014643052859314066, "synch_env_connectors": 5.07484160563549e-06}, "env_runners": {"num_episodes": 250.0, "num_agent_steps_sampled": {"default_agent": 5000.0}, "weights_seq_no": 8.0, "num_agent_steps_sampled_lifetime": {"default_agent": -4312500.0}, "num_episodes_lifetime": -215625.0, "env_to_module_connector": {"timers": {"connectors": {"add_states_from_episodes_to_batch": 1.780926270135492e-06, "add_time_dim_to_batch_and_zero_pad": 2.4382535838359032e-06, "numpy_to_tensor": 9.196635205351081e-06, "batch_individual_items": 6.521174048811471e-06, "add_observations_from_episodes_to_batch": 3.1254025726427982e-06}}, "connector_pipeline_timer": 4.592375557581786e-05}, "sample": 0.005299119376315111, "num_module_steps_sampled": {"default_policy": 5000.0}, "rlmodule_inference_timer": 3.05627711621855e-05, "episode_return_max": 10.5, "agent_episode_returns_mean": {"default_agent": 5.460000000000001}, "episode_len_mean": 20.0, "time_between_sampling": 0.0015704330724783122, "env_step_timer": 1.4562551619661485e-05, "env_to_module_sum_episodes_length_out": 10.36823839457432, "env_reset_timer": 4.147729926095879e-05, "module_to_env_connector": {"timers": {"connectors": {"listify_data_for_vector_env": 1.1522628655181388e-05, "normalize_and_clip_actions": 9.840906498961338e-06, "get_actions": 4.3379711452505354e-05, "un_batch_to_individual_items": 5.624017779188969e-06, "tensor_to_numpy": 1.4040519623124656e-05, "remove_single_ts_time_rank_from_batch": 6.133628633786583e-07}}, "connector_pipeline_timer": 0.00011214415587234605}, "episode_duration_sec_mean": 0.004879610819276422, "num_module_steps_sampled_lifetime": {"default_policy": -4312500.0}, "episode_len_min": 20, "episode_return_mean": 5.460000000000001, "episode_return_min": -9.5, "module_episode_returns_mean": {"default_policy": 5.460000000000001}, "episode_len_max": 20, "num_env_steps_sampled": 5000.0, "env_to_module_sum_episodes_length_in": 10.36823839457432, "num_env_steps_sampled_lifetime": -4312500.0, "num_env_steps_sampled_lifetime_throughput": 3508.6590260039366}, "learners": {"__all_modules__": {"num_env_steps_trained_lifetime": 283500, "learner_connector": {"timers": {"connectors": {"add_observations_from_episodes_to_batch": 0.000835150771613177, "add_time_dim_to_batch_and_zero_pad": 2.0206076146560793e-05, "add_columns_from_episodes_to_train_batch": 0.03755794699120015, "add_one_ts_to_episodes_and_truncate": 0.009638179479092197, "add_states_from_episodes_to_batch": 3.912026008850374e-06, "numpy_to_tensor": 0.00010059341881074031, "batch_individual_items": 0.03731379310643478, "general_advantage_estimation": 0.008242605707676424}}, "connector_pipeline_timer": 0.09388972771805028}, "learner_connector_sum_episodes_length_in": 5000.0, "num_env_steps_trained": 31500, "num_module_steps_trained": 6000, "num_non_trainable_parameters": 0, "num_module_steps_trained_lifetime": 54000, "num_trainable_parameters": 6003, "learner_connector_sum_episodes_length_out": 5250.0, "num_env_steps_trained_lifetime_throughput": 1932398.596789091, "num_module_steps_trained_throughput": 369350.6063694663, "num_module_steps_trained_lifetime_throughput": 368851.64842239185}, "default_policy": {"gradients_default_optimizer_global_norm": 0.04388493672013283, "weights_seq_no": 9.0, "num_module_steps_trained_lifetime": 54000, "num_trainable_parameters": 6003, "diff_num_grad_updates_vs_sampler_policy": 1.0, "policy_loss": -0.10784247517585754, "default_optimizer_learning_rate": 0.0002847858517, "vf_explained_var": -0.012197732925415039, "vf_loss": 0.10278083384037018, "vf_loss_unclipped": 29.713878631591797, "curr_entropy_coeff": 0.0090570820258, "module_train_batch_size_mean": 1000.0, "num_module_steps_trained": 6000, "total_loss": -0.044999025762081146, "mean_kl_loss": 0.0005018218071199954, "entropy": 0.6512721180915833, "curr_kl_coeff": 0.0014580006245523691, "num_module_steps_trained_lifetime_throughput": 369819.78619828535}}, "num_training_step_calls_per_iteration": 1, "evaluation": {"env_runners": {"env_to_module_connector": {"timers": {"connectors": {"add_observations_from_episodes_to_batch": 2.967147306868943e-06, "add_time_dim_to_batch_and_zero_pad": 2.609517595635751e-06, "add_states_from_episodes_to_batch": 1.6135139549898991e-06, "numpy_to_tensor": 8.533804690929797e-06, "batch_individual_items": 6.3057285025475855e-06}}, "connector_pipeline_timer": 4.417435939026683e-05}, "episode_return_mean": 0.85, "num_module_steps_sampled": {"default_policy": 400}, "num_episodes_lifetime": 180, "module_to_env_connector": {"timers": {"connectors": {"un_batch_to_individual_items": 5.57207795383629e-06, "tensor_to_numpy": 1.3181084339398307e-05, "listify_data_for_vector_env": 1.1512802155639361e-05, "remove_single_ts_time_rank_from_batch": 5.888663033027704e-07, "get_actions": 3.674259277312371e-05, "normalize_and_clip_actions": 9.823609652225947e-06}}, "connector_pipeline_timer": 0.00010291323197446388}, "rlmodule_inference_timer": 2.7650212838668783e-05, "module_episode_returns_mean": {"default_policy": 0.85}, "env_to_module_sum_episodes_length_out": 10.368238394574323, "num_episodes": 20, "episode_return_max": 14.5, "env_reset_timer": 0.00044547580492177157, "episode_len_min": 20, "episode_return_min": -13.5, "episode_len_max": 20, "env_to_module_sum_episodes_length_in": 10.368238394574323, "num_env_steps_sampled_lifetime": 45400, "agent_episode_returns_mean": {"default_agent": 0.85}, "num_module_steps_sampled_lifetime": {"default_policy": 3600}, "sample": 0.1150021924933987, "episode_duration_sec_mean": 0.0045261104311794045, "num_agent_steps_sampled": {"default_agent": 400}, "num_env_steps_sampled": 400, "weights_seq_no": 9.0, "episode_len_mean": 20.0, "env_step_timer": 1.4929032927250933e-05, "num_agent_steps_sampled_lifetime": {"default_agent": 3600}, "time_between_sampling": 1.648354708020821}, "num_healthy_workers": 1, "actor_manager_num_outstanding_async_reqs": 0, "num_remote_worker_restarts": 0}, "num_env_steps_sampled_lifetime": -4312500.0, "fault_tolerance": {"num_healthy_workers": 0, "num_remote_worker_restarts": 0}, "env_runner_group": {"actor_manager_num_outstanding_async_reqs": 0}, "done": false, "training_iteration": 9, "trial_id": "4dc31_00000", "date": "2025-08-11_19-19-38", "timestamp": 1754932778, "time_this_iter_s": 1.8585398197174072, "time_total_s": 15.774585962295532, "pid": 14098, "hostname": "Mac", "node_ip": "127.0.0.1", "config": {"exploration_config": {}, "extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "placement_strategy": "PACK", "num_gpus": 0, "_fake_gpus": false, "num_cpus_for_main_process": 2, "eager_tracing": true, "eager_max_retraces": 20, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "torch_compile_learner": false, "torch_compile_learner_what_to_compile": "forward_train", "torch_compile_learner_dynamo_backend": "aot_eager", "torch_compile_learner_dynamo_mode": null, "torch_compile_worker": false, "torch_compile_worker_dynamo_backend": "aot_eager", "torch_compile_worker_dynamo_mode": null, "torch_ddp_kwargs": {}, "torch_skip_nan_gradients": false, "env": "Umbrella", "env_config": {}, "observation_space": null, "action_space": null, "clip_rewards": null, "normalize_actions": true, "clip_actions": false, "_is_atari": null, "disable_env_checking": false, "render_env": false, "action_mask_key": "action_mask", "env_runner_cls": null, "num_env_runners": 0, "create_local_env_runner": true, "num_envs_per_env_runner": 1, "gym_env_vectorize_mode": "SYNC", "num_cpus_per_env_runner": 1, "num_gpus_per_env_runner": 0, "custom_resources_per_env_runner": {}, "validate_env_runners_after_construction": true, "episodes_to_numpy": true, "max_requests_in_flight_per_env_runner": 1, "sample_timeout_s": 60.0, "_env_to_module_connector": null, "add_default_connectors_to_env_to_module_pipeline": true, "_module_to_env_connector": null, "add_default_connectors_to_module_to_env_pipeline": true, "merge_env_runner_states": "training_only", "broadcast_env_runner_states": true, "episode_lookback_horizon": 1, "rollout_fragment_length": "auto", "batch_mode": "complete_episodes", "compress_observations": false, "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "enable_tf1_exec_eagerly": false, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "preprocessor_pref": "deepmind", "observation_filter": "NoFilter", "update_worker_filter_stats": true, "use_worker_filter_stats": true, "sampler_perf_stats_ema_coef": null, "_is_online": true, "num_learners": 0, "num_gpus_per_learner": 0, "num_cpus_per_learner": "auto", "num_aggregator_actors_per_learner": 0, "max_requests_in_flight_per_aggregator_actor": 3, "local_gpu_idx": 0, "max_requests_in_flight_per_learner": 3, "gamma": 1, "lr": 0.0002847858517, "grad_clip": 0.5, "grad_clip_by": "global_norm", "_train_batch_size_per_learner": 5000, "train_batch_size": 4000, "num_epochs": 1, "minibatch_size": 1000, "shuffle_batch_per_epoch": true, "model": {"fcnet_hiddens": [256, 256], "fcnet_activation": "tanh", "fcnet_weights_initializer": null, "fcnet_weights_initializer_config": null, "fcnet_bias_initializer": null, "fcnet_bias_initializer_config": null, "conv_filters": null, "conv_activation": "relu", "conv_kernel_initializer": null, "conv_kernel_initializer_config": null, "conv_bias_initializer": null, "conv_bias_initializer_config": null, "conv_transpose_kernel_initializer": null, "conv_transpose_kernel_initializer_config": null, "conv_transpose_bias_initializer": null, "conv_transpose_bias_initializer_config": null, "post_fcnet_hiddens": [], "post_fcnet_activation": "relu", "post_fcnet_weights_initializer": null, "post_fcnet_weights_initializer_config": null, "post_fcnet_bias_initializer": null, "post_fcnet_bias_initializer_config": null, "free_log_std": false, "log_std_clip_param": 20.0, "no_final_linear": false, "vf_share_layers": false, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "lstm_weights_initializer": null, "lstm_weights_initializer_config": null, "lstm_bias_initializer": null, "lstm_bias_initializer_config": null, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "attention_use_n_prev_actions": 0, "attention_use_n_prev_rewards": 0, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": null, "custom_model_config": {}, "custom_action_dist": null, "custom_preprocessor": null, "encoder_latent_dim": null, "always_check_shapes": false, "lstm_use_prev_action_reward": -1, "_use_default_native_models": -1, "_disable_preprocessor_api": false, "_disable_action_flattening": false}, "_learner_connector": null, "add_default_connectors_to_learner_pipeline": true, "learner_config_dict": {}, "optimizer": {}, "_learner_class": null, "callbacks_on_algorithm_init": null, "callbacks_on_env_runners_recreated": null, "callbacks_on_offline_eval_runners_recreated": null, "callbacks_on_checkpoint_loaded": null, "callbacks_on_environment_created": null, "callbacks_on_episode_created": null, "callbacks_on_episode_start": null, "callbacks_on_episode_step": null, "callbacks_on_episode_end": null, "callbacks_on_evaluate_start": null, "callbacks_on_evaluate_end": null, "callbacks_on_evaluate_offline_start": null, "callbacks_on_evaluate_offline_end": null, "callbacks_on_sample_end": null, "callbacks_on_train_result": null, "explore": true, "enable_rl_module_and_learner": true, "enable_env_runner_and_connector_v2": true, "_prior_exploration_config": {"type": "StochasticSampling"}, "count_steps_by": "env_steps", "policy_map_capacity": 100, "policy_mapping_fn": "<function AlgorithmConfig.DEFAULT_POLICY_MAPPING_FN at 0x385441b20>", "policies_to_train": null, "policy_states_are_swappable": false, "observation_fn": null, "offline_data_class": null, "input_read_method": "read_parquet", "input_read_method_kwargs": {}, "input_read_schema": {}, "input_read_episodes": false, "input_read_sample_batches": false, "input_read_batch_size": null, "input_filesystem": null, "input_filesystem_kwargs": {}, "input_compress_columns": ["obs", "new_obs"], "input_spaces_jsonable": true, "materialize_data": false, "materialize_mapped_data": true, "map_batches_kwargs": {}, "iter_batches_kwargs": {}, "ignore_final_observation": false, "prelearner_class": null, "prelearner_buffer_class": null, "prelearner_buffer_kwargs": {}, "prelearner_module_synch_period": 10, "dataset_num_iters_per_learner": null, "input_config": {}, "actions_in_input_normalized": false, "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_config": {}, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "output_max_rows_per_file": null, "output_write_remaining_data": false, "output_write_method": "write_parquet", "output_write_method_kwargs": {}, "output_filesystem": null, "output_filesystem_kwargs": {}, "output_write_episodes": true, "offline_sampling": false, "evaluation_interval": 1, "evaluation_duration": 20, "evaluation_duration_unit": "episodes", "evaluation_sample_timeout_s": 120.0, "evaluation_auto_duration_min_env_steps_per_sample": 100, "evaluation_auto_duration_max_env_steps_per_sample": 2000, "evaluation_parallel_to_training": false, "evaluation_force_reset_envs_before_iteration": true, "evaluation_config": null, "off_policy_estimation_methods": {}, "ope_split_batch_by_episode": true, "evaluation_num_env_runners": 1, "in_evaluation": false, "sync_filters_on_rollout_workers_timeout_s": 10.0, "offline_evaluation_interval": null, "num_offline_eval_runners": 0, "offline_loss_for_module_fn": null, "offline_evaluation_duration": 1, "offline_evaluation_parallel_to_training": false, "offline_evaluation_timeout_s": 120.0, "num_cpus_per_offline_eval_runner": 1, "num_gpus_per_offline_eval_runner": 0, "custom_resources_per_offline_eval_runner": {}, "restart_failed_offline_eval_runners": true, "ignore_offline_eval_runner_failures": false, "max_num_offline_eval_runner_restarts": 1000, "offline_eval_runner_restore_timeout_s": 1800.0, "max_requests_in_flight_per_offline_eval_runner": 1, "validate_offline_eval_runners_after_construction": true, "offline_eval_runner_health_probe_timeout_s": 30.0, "offline_eval_rl_module_inference_only": false, "broadcast_offline_eval_runner_states": false, "offline_eval_batch_size_per_runner": 256, "dataset_num_iters_per_eval_runner": 1, "keep_per_episode_custom_metrics": false, "metrics_episode_collection_timeout_s": 60.0, "metrics_num_episodes_for_smoothing": 100, "min_time_s_per_iteration": null, "min_train_timesteps_per_iteration": 0, "min_sample_timesteps_per_iteration": 0, "log_gradients": true, "export_native_model_files": false, "checkpoint_trainable_policies_only": false, "logger_creator": null, "logger_config": null, "log_level": "WARN", "log_sys_usage": true, "fake_sampler": false, "seed": 6, "restart_failed_env_runners": true, "ignore_env_runner_failures": false, "max_num_env_runner_restarts": 1000, "delay_between_env_runner_restarts_s": 60.0, "restart_failed_sub_environments": false, "num_consecutive_env_runner_failures_tolerance": 100, "env_runner_health_probe_timeout_s": 30.0, "env_runner_restore_timeout_s": 1800.0, "_model_config": {}, "_rl_module_spec": "RLModuleSpec(module_class=None, observation_space=None, action_space=None, inference_only=False, learner_only=False, model_config=DefaultModelConfig(fcnet_hiddens=[60, 90], fcnet_activation='tanh', fcnet_kernel_initializer=None, fcnet_kernel_initializer_kwargs=None, fcnet_bias_initializer=None, fcnet_bias_initializer_kwargs=None, conv_filters=None, conv_activation='relu', conv_kernel_initializer=None, conv_kernel_initializer_kwargs=None, conv_bias_initializer=None, conv_bias_initializer_kwargs=None, head_fcnet_hiddens=[], head_fcnet_activation='relu', head_fcnet_kernel_initializer=None, head_fcnet_kernel_initializer_kwargs=None, head_fcnet_bias_initializer=None, head_fcnet_bias_initializer_kwargs=None, free_log_std=False, log_std_clip_param=20.0, vf_share_layers=True, use_lstm=False, max_seq_len=20, lstm_cell_size=256, lstm_use_prev_action=False, lstm_use_prev_reward=False, lstm_kernel_initializer=None, lstm_kernel_initializer_kwargs=None, lstm_bias_initializer=None, lstm_bias_initializer_kwargs=None), catalog_class=None, load_state_path=None, model_config_dict=None)", "algorithm_config_overrides_per_module": {}, "_per_module_overrides": {}, "_validate_config": true, "_use_msgpack_checkpoints": false, "_torch_grad_scaler_class": null, "_torch_lr_scheduler_classes": null, "_tf_policy_handles_more_than_one_loss": false, "_disable_preprocessor_api": false, "_disable_action_flattening": false, "_disable_initialize_loss_from_dummy_batch": false, "_dont_auto_sync_env_runner_states": false, "env_task_fn": -1, "enable_connectors": -1, "simple_optimizer": false, "policy_map_cache": -1, "worker_cls": -1, "synchronize_filters": -1, "enable_async_evaluation": -1, "custom_async_evaluation_function": -1, "_enable_rl_module_api": -1, "auto_wrap_old_gym_envs": -1, "always_attach_evaluation_results": -1, "replay_sequence_length": null, "_disable_execution_plan_api": -1, "use_critic": true, "use_gae": true, "use_kl_loss": true, "kl_coeff": 0.7464963036515, "kl_target": 0.0270990929592, "vf_loss_coeff": 0.6688075857018, "entropy_coeff": 0.0090570820258, "clip_param": 0.1221781641624, "vf_clip_param": 0.1027808522125, "entropy_coeff_schedule": null, "lr_schedule": null, "sgd_minibatch_size": -1, "vf_share_layers": -1, "__stdout_file__": null, "__stderr_file__": null, "lambda": 0.9099046732075, "input": "sampler", "policies": {"default_policy": [null, null, null, null]}, "callbacks": "<class 'ray.rllib.callbacks.callbacks.RLlibCallback'>", "create_env_on_driver": false, "custom_eval_function": null, "framework": "torch"}, "time_since_restore": 15.774585962295532, "iterations_since_restore": 9, "perf": {"cpu_util_percent": 55.26666666666667, "ram_util_percent": 83.36666666666667}}
{"timers": {"training_iteration": 1.724926530473493, "restore_env_runners": 1.7594444819042082e-05, "training_step": 1.7247801739778568, "env_runner_sampling_timer": 1.596167912205345, "learner_update_timer": 0.12505529469970036, "synch_weights": 0.0008439758330552826, "restore_eval_env_runners": 8.823209781630315e-06, "evaluation_iteration": 0.13055945263943292, "synch_eval_env_connectors": 0.00014593414336654746, "synch_env_connectors": 5.073673310992008e-06}, "env_runners": {"num_episodes": 250.0, "num_agent_steps_sampled": {"default_agent": 5000.0}, "weights_seq_no": 9.0, "num_agent_steps_sampled_lifetime": {"default_agent": -4930000.0}, "num_episodes_lifetime": -246500.0, "env_to_module_connector": {"timers": {"connectors": {"add_states_from_episodes_to_batch": 1.7614363002644167e-06, "add_time_dim_to_batch_and_zero_pad": 2.39578034973811e-06, "numpy_to_tensor": 9.019609695339111e-06, "batch_individual_items": 6.4608981518099685e-06, "add_observations_from_episodes_to_batch": 3.095462403660473e-06}}, "connector_pipeline_timer": 4.5278161005830056e-05}, "sample": 0.005194544705646108, "num_module_steps_sampled": {"default_policy": 5000.0}, "rlmodule_inference_timer": 2.895571684975725e-05, "episode_return_max": 10.5, "agent_episode_returns_mean": {"default_agent": 6.659999999999997}, "episode_len_mean": 20.0, "time_between_sampling": 0.002193189569104638, "env_step_timer": 1.4212281386248782e-05, "env_to_module_sum_episodes_length_out": 10.36823839457432, "env_reset_timer": 4.09521105728552e-05, "module_to_env_connector": {"timers": {"connectors": {"listify_data_for_vector_env": 1.1294629581922827e-05, "normalize_and_clip_actions": 9.684859118640289e-06, "get_actions": 4.219902715335165e-05, "un_batch_to_individual_items": 5.500301199642914e-06, "tensor_to_numpy": 1.3640834656049775e-05, "remove_single_ts_time_rank_from_batch": 6.045399466371009e-07}}, "connector_pipeline_timer": 0.00010906184321147676}, "episode_duration_sec_mean": 0.004750241356901824, "num_module_steps_sampled_lifetime": {"default_policy": -4930000.0}, "episode_len_min": 20, "episode_return_mean": 6.659999999999997, "episode_return_min": -9.5, "module_episode_returns_mean": {"default_policy": 6.659999999999997}, "episode_len_max": 20, "num_env_steps_sampled": 5000.0, "env_to_module_sum_episodes_length_in": 10.36823839457432, "num_env_steps_sampled_lifetime": -4930000.0, "num_env_steps_sampled_lifetime_throughput": 3576.3368012610995}, "learners": {"__all_modules__": {"num_env_steps_trained_lifetime": 315000, "learner_connector": {"timers": {"connectors": {"add_observations_from_episodes_to_batch": 0.0008360921844827669, "add_time_dim_to_batch_and_zero_pad": 2.0253184919167466e-05, "add_columns_from_episodes_to_train_batch": 0.037559320440465865, "add_one_ts_to_episodes_and_truncate": 0.009636399764363307, "add_states_from_episodes_to_batch": 3.914566135830857e-06, "numpy_to_tensor": 0.00010044206388879364, "batch_individual_items": 0.038287801005884345, "general_advantage_estimation": 0.008215770480178821}}, "connector_pipeline_timer": 0.0948368054406198}, "learner_connector_sum_episodes_length_in": 5000.0, "num_env_steps_trained": 31500, "num_module_steps_trained": 6000, "num_non_trainable_parameters": 0, "num_module_steps_trained_lifetime": 60000, "num_trainable_parameters": 6003, "learner_connector_sum_episodes_length_out": 5250.0, "num_env_steps_trained_lifetime_throughput": 1937546.6411080724, "num_module_steps_trained_throughput": 370283.00150359893, "num_module_steps_trained_lifetime_throughput": 369798.561172808}, "default_policy": {"gradients_default_optimizer_global_norm": 0.04102873429656029, "weights_seq_no": 10.0, "num_module_steps_trained_lifetime": 60000, "num_trainable_parameters": 6003, "diff_num_grad_updates_vs_sampler_policy": 1.0, "policy_loss": -0.08268185704946518, "default_optimizer_learning_rate": 0.0002847858517, "vf_explained_var": -0.01230764389038086, "vf_loss": 0.10278083384037018, "vf_loss_unclipped": 29.858129501342773, "curr_entropy_coeff": 0.0090570820258, "module_train_batch_size_mean": 1000.0, "num_module_steps_trained": 6000, "total_loss": -0.019771618768572807, "mean_kl_loss": 0.00037937649176456034, "entropy": 0.6437965035438538, "curr_kl_coeff": 0.0007290003122761846, "num_module_steps_trained_lifetime_throughput": 370704.7191838384}}, "num_training_step_calls_per_iteration": 1, "evaluation": {"env_runners": {"env_to_module_connector": {"timers": {"connectors": {"add_observations_from_episodes_to_batch": 2.7921100412066496e-06, "add_time_dim_to_batch_and_zero_pad": 2.3018510045131885e-06, "add_states_from_episodes_to_batch": 1.6161415693296993e-06, "numpy_to_tensor": 8.394988553983816e-06, "batch_individual_items": 6.165176213103778e-06}}, "connector_pipeline_timer": 4.258284138796093e-05}, "episode_return_mean": 1.65, "num_module_steps_sampled": {"default_policy": 400}, "num_episodes_lifetime": 200, "module_to_env_connector": {"timers": {"connectors": {"un_batch_to_individual_items": 5.471374297424235e-06, "tensor_to_numpy": 1.2896232728964006e-05, "listify_data_for_vector_env": 1.1052639468171429e-05, "remove_single_ts_time_rank_from_batch": 5.816734284221774e-07, "get_actions": 3.498425538379106e-05, "normalize_and_clip_actions": 9.529337728256133e-06}}, "connector_pipeline_timer": 0.00010000037594630004}, "rlmodule_inference_timer": 2.6494732829097038e-05, "module_episode_returns_mean": {"default_policy": 1.65}, "env_to_module_sum_episodes_length_out": 10.368238394574323, "num_episodes": 20, "episode_return_max": 14.5, "env_reset_timer": 0.0004429418868770129, "episode_len_min": 20, "episode_return_min": -13.5, "episode_len_max": 20, "env_to_module_sum_episodes_length_in": 10.368238394574323, "num_env_steps_sampled_lifetime": 50400, "agent_episode_returns_mean": {"default_agent": 1.65}, "num_module_steps_sampled_lifetime": {"default_policy": 4000}, "sample": 0.11486064306929933, "episode_duration_sec_mean": 0.004577380392001942, "num_agent_steps_sampled": {"default_agent": 400}, "num_env_steps_sampled": 400, "weights_seq_no": 10.0, "episode_len_mean": 20.0, "env_step_timer": 1.4043965767863306e-05, "num_agent_steps_sampled_lifetime": {"default_agent": 4000}, "time_between_sampling": 1.6486410671904412}, "num_healthy_workers": 1, "actor_manager_num_outstanding_async_reqs": 0, "num_remote_worker_restarts": 0}, "num_env_steps_sampled_lifetime": -4930000.0, "fault_tolerance": {"num_healthy_workers": 0, "num_remote_worker_restarts": 0}, "env_runner_group": {"actor_manager_num_outstanding_async_reqs": 0}, "done": false, "training_iteration": 10, "trial_id": "4dc31_00000", "date": "2025-08-11_19-19-39", "timestamp": 1754932779, "time_this_iter_s": 1.761244297027588, "time_total_s": 17.53583025932312, "pid": 14098, "hostname": "Mac", "node_ip": "127.0.0.1", "config": {"exploration_config": {}, "extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "placement_strategy": "PACK", "num_gpus": 0, "_fake_gpus": false, "num_cpus_for_main_process": 2, "eager_tracing": true, "eager_max_retraces": 20, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "torch_compile_learner": false, "torch_compile_learner_what_to_compile": "forward_train", "torch_compile_learner_dynamo_backend": "aot_eager", "torch_compile_learner_dynamo_mode": null, "torch_compile_worker": false, "torch_compile_worker_dynamo_backend": "aot_eager", "torch_compile_worker_dynamo_mode": null, "torch_ddp_kwargs": {}, "torch_skip_nan_gradients": false, "env": "Umbrella", "env_config": {}, "observation_space": null, "action_space": null, "clip_rewards": null, "normalize_actions": true, "clip_actions": false, "_is_atari": null, "disable_env_checking": false, "render_env": false, "action_mask_key": "action_mask", "env_runner_cls": null, "num_env_runners": 0, "create_local_env_runner": true, "num_envs_per_env_runner": 1, "gym_env_vectorize_mode": "SYNC", "num_cpus_per_env_runner": 1, "num_gpus_per_env_runner": 0, "custom_resources_per_env_runner": {}, "validate_env_runners_after_construction": true, "episodes_to_numpy": true, "max_requests_in_flight_per_env_runner": 1, "sample_timeout_s": 60.0, "_env_to_module_connector": null, "add_default_connectors_to_env_to_module_pipeline": true, "_module_to_env_connector": null, "add_default_connectors_to_module_to_env_pipeline": true, "merge_env_runner_states": "training_only", "broadcast_env_runner_states": true, "episode_lookback_horizon": 1, "rollout_fragment_length": "auto", "batch_mode": "complete_episodes", "compress_observations": false, "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "enable_tf1_exec_eagerly": false, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "preprocessor_pref": "deepmind", "observation_filter": "NoFilter", "update_worker_filter_stats": true, "use_worker_filter_stats": true, "sampler_perf_stats_ema_coef": null, "_is_online": true, "num_learners": 0, "num_gpus_per_learner": 0, "num_cpus_per_learner": "auto", "num_aggregator_actors_per_learner": 0, "max_requests_in_flight_per_aggregator_actor": 3, "local_gpu_idx": 0, "max_requests_in_flight_per_learner": 3, "gamma": 1, "lr": 0.0002847858517, "grad_clip": 0.5, "grad_clip_by": "global_norm", "_train_batch_size_per_learner": 5000, "train_batch_size": 4000, "num_epochs": 1, "minibatch_size": 1000, "shuffle_batch_per_epoch": true, "model": {"fcnet_hiddens": [256, 256], "fcnet_activation": "tanh", "fcnet_weights_initializer": null, "fcnet_weights_initializer_config": null, "fcnet_bias_initializer": null, "fcnet_bias_initializer_config": null, "conv_filters": null, "conv_activation": "relu", "conv_kernel_initializer": null, "conv_kernel_initializer_config": null, "conv_bias_initializer": null, "conv_bias_initializer_config": null, "conv_transpose_kernel_initializer": null, "conv_transpose_kernel_initializer_config": null, "conv_transpose_bias_initializer": null, "conv_transpose_bias_initializer_config": null, "post_fcnet_hiddens": [], "post_fcnet_activation": "relu", "post_fcnet_weights_initializer": null, "post_fcnet_weights_initializer_config": null, "post_fcnet_bias_initializer": null, "post_fcnet_bias_initializer_config": null, "free_log_std": false, "log_std_clip_param": 20.0, "no_final_linear": false, "vf_share_layers": false, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "lstm_weights_initializer": null, "lstm_weights_initializer_config": null, "lstm_bias_initializer": null, "lstm_bias_initializer_config": null, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "attention_use_n_prev_actions": 0, "attention_use_n_prev_rewards": 0, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": null, "custom_model_config": {}, "custom_action_dist": null, "custom_preprocessor": null, "encoder_latent_dim": null, "always_check_shapes": false, "lstm_use_prev_action_reward": -1, "_use_default_native_models": -1, "_disable_preprocessor_api": false, "_disable_action_flattening": false}, "_learner_connector": null, "add_default_connectors_to_learner_pipeline": true, "learner_config_dict": {}, "optimizer": {}, "_learner_class": null, "callbacks_on_algorithm_init": null, "callbacks_on_env_runners_recreated": null, "callbacks_on_offline_eval_runners_recreated": null, "callbacks_on_checkpoint_loaded": null, "callbacks_on_environment_created": null, "callbacks_on_episode_created": null, "callbacks_on_episode_start": null, "callbacks_on_episode_step": null, "callbacks_on_episode_end": null, "callbacks_on_evaluate_start": null, "callbacks_on_evaluate_end": null, "callbacks_on_evaluate_offline_start": null, "callbacks_on_evaluate_offline_end": null, "callbacks_on_sample_end": null, "callbacks_on_train_result": null, "explore": true, "enable_rl_module_and_learner": true, "enable_env_runner_and_connector_v2": true, "_prior_exploration_config": {"type": "StochasticSampling"}, "count_steps_by": "env_steps", "policy_map_capacity": 100, "policy_mapping_fn": "<function AlgorithmConfig.DEFAULT_POLICY_MAPPING_FN at 0x385441b20>", "policies_to_train": null, "policy_states_are_swappable": false, "observation_fn": null, "offline_data_class": null, "input_read_method": "read_parquet", "input_read_method_kwargs": {}, "input_read_schema": {}, "input_read_episodes": false, "input_read_sample_batches": false, "input_read_batch_size": null, "input_filesystem": null, "input_filesystem_kwargs": {}, "input_compress_columns": ["obs", "new_obs"], "input_spaces_jsonable": true, "materialize_data": false, "materialize_mapped_data": true, "map_batches_kwargs": {}, "iter_batches_kwargs": {}, "ignore_final_observation": false, "prelearner_class": null, "prelearner_buffer_class": null, "prelearner_buffer_kwargs": {}, "prelearner_module_synch_period": 10, "dataset_num_iters_per_learner": null, "input_config": {}, "actions_in_input_normalized": false, "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_config": {}, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "output_max_rows_per_file": null, "output_write_remaining_data": false, "output_write_method": "write_parquet", "output_write_method_kwargs": {}, "output_filesystem": null, "output_filesystem_kwargs": {}, "output_write_episodes": true, "offline_sampling": false, "evaluation_interval": 1, "evaluation_duration": 20, "evaluation_duration_unit": "episodes", "evaluation_sample_timeout_s": 120.0, "evaluation_auto_duration_min_env_steps_per_sample": 100, "evaluation_auto_duration_max_env_steps_per_sample": 2000, "evaluation_parallel_to_training": false, "evaluation_force_reset_envs_before_iteration": true, "evaluation_config": null, "off_policy_estimation_methods": {}, "ope_split_batch_by_episode": true, "evaluation_num_env_runners": 1, "in_evaluation": false, "sync_filters_on_rollout_workers_timeout_s": 10.0, "offline_evaluation_interval": null, "num_offline_eval_runners": 0, "offline_loss_for_module_fn": null, "offline_evaluation_duration": 1, "offline_evaluation_parallel_to_training": false, "offline_evaluation_timeout_s": 120.0, "num_cpus_per_offline_eval_runner": 1, "num_gpus_per_offline_eval_runner": 0, "custom_resources_per_offline_eval_runner": {}, "restart_failed_offline_eval_runners": true, "ignore_offline_eval_runner_failures": false, "max_num_offline_eval_runner_restarts": 1000, "offline_eval_runner_restore_timeout_s": 1800.0, "max_requests_in_flight_per_offline_eval_runner": 1, "validate_offline_eval_runners_after_construction": true, "offline_eval_runner_health_probe_timeout_s": 30.0, "offline_eval_rl_module_inference_only": false, "broadcast_offline_eval_runner_states": false, "offline_eval_batch_size_per_runner": 256, "dataset_num_iters_per_eval_runner": 1, "keep_per_episode_custom_metrics": false, "metrics_episode_collection_timeout_s": 60.0, "metrics_num_episodes_for_smoothing": 100, "min_time_s_per_iteration": null, "min_train_timesteps_per_iteration": 0, "min_sample_timesteps_per_iteration": 0, "log_gradients": true, "export_native_model_files": false, "checkpoint_trainable_policies_only": false, "logger_creator": null, "logger_config": null, "log_level": "WARN", "log_sys_usage": true, "fake_sampler": false, "seed": 6, "restart_failed_env_runners": true, "ignore_env_runner_failures": false, "max_num_env_runner_restarts": 1000, "delay_between_env_runner_restarts_s": 60.0, "restart_failed_sub_environments": false, "num_consecutive_env_runner_failures_tolerance": 100, "env_runner_health_probe_timeout_s": 30.0, "env_runner_restore_timeout_s": 1800.0, "_model_config": {}, "_rl_module_spec": "RLModuleSpec(module_class=None, observation_space=None, action_space=None, inference_only=False, learner_only=False, model_config=DefaultModelConfig(fcnet_hiddens=[60, 90], fcnet_activation='tanh', fcnet_kernel_initializer=None, fcnet_kernel_initializer_kwargs=None, fcnet_bias_initializer=None, fcnet_bias_initializer_kwargs=None, conv_filters=None, conv_activation='relu', conv_kernel_initializer=None, conv_kernel_initializer_kwargs=None, conv_bias_initializer=None, conv_bias_initializer_kwargs=None, head_fcnet_hiddens=[], head_fcnet_activation='relu', head_fcnet_kernel_initializer=None, head_fcnet_kernel_initializer_kwargs=None, head_fcnet_bias_initializer=None, head_fcnet_bias_initializer_kwargs=None, free_log_std=False, log_std_clip_param=20.0, vf_share_layers=True, use_lstm=False, max_seq_len=20, lstm_cell_size=256, lstm_use_prev_action=False, lstm_use_prev_reward=False, lstm_kernel_initializer=None, lstm_kernel_initializer_kwargs=None, lstm_bias_initializer=None, lstm_bias_initializer_kwargs=None), catalog_class=None, load_state_path=None, model_config_dict=None)", "algorithm_config_overrides_per_module": {}, "_per_module_overrides": {}, "_validate_config": true, "_use_msgpack_checkpoints": false, "_torch_grad_scaler_class": null, "_torch_lr_scheduler_classes": null, "_tf_policy_handles_more_than_one_loss": false, "_disable_preprocessor_api": false, "_disable_action_flattening": false, "_disable_initialize_loss_from_dummy_batch": false, "_dont_auto_sync_env_runner_states": false, "env_task_fn": -1, "enable_connectors": -1, "simple_optimizer": false, "policy_map_cache": -1, "worker_cls": -1, "synchronize_filters": -1, "enable_async_evaluation": -1, "custom_async_evaluation_function": -1, "_enable_rl_module_api": -1, "auto_wrap_old_gym_envs": -1, "always_attach_evaluation_results": -1, "replay_sequence_length": null, "_disable_execution_plan_api": -1, "use_critic": true, "use_gae": true, "use_kl_loss": true, "kl_coeff": 0.7464963036515, "kl_target": 0.0270990929592, "vf_loss_coeff": 0.6688075857018, "entropy_coeff": 0.0090570820258, "clip_param": 0.1221781641624, "vf_clip_param": 0.1027808522125, "entropy_coeff_schedule": null, "lr_schedule": null, "sgd_minibatch_size": -1, "vf_share_layers": -1, "__stdout_file__": null, "__stderr_file__": null, "lambda": 0.9099046732075, "input": "sampler", "policies": {"default_policy": [null, null, null, null]}, "callbacks": "<class 'ray.rllib.callbacks.callbacks.RLlibCallback'>", "create_env_on_driver": false, "custom_eval_function": null, "framework": "torch"}, "time_since_restore": 17.53583025932312, "iterations_since_restore": 10, "perf": {"cpu_util_percent": 52.3, "ram_util_percent": 83.55}}
{"timers": {"training_iteration": 1.7232362422492673, "restore_env_runners": 1.747267074840417e-05, "training_step": 1.723089655987882, "env_runner_sampling_timer": 1.5947922535026657, "learner_update_timer": 0.12474430258329647, "synch_weights": 0.0008412181552431841, "restore_eval_env_runners": 8.796647536398613e-06, "evaluation_iteration": 0.13032999853308427, "synch_eval_env_connectors": 0.0001457243923558401, "synch_env_connectors": 5.0562674486743575e-06}, "env_runners": {"num_episodes": 250.0, "num_agent_steps_sampled": {"default_agent": 5000.0}, "weights_seq_no": 10.0, "num_agent_steps_sampled_lifetime": {"default_agent": -5547500.0}, "num_episodes_lifetime": -277375.0, "env_to_module_connector": {"timers": {"connectors": {"add_states_from_episodes_to_batch": 1.7683953890229514e-06, "add_time_dim_to_batch_and_zero_pad": 2.4063982874143382e-06, "numpy_to_tensor": 9.077347585978371e-06, "batch_individual_items": 6.50347517747831e-06, "add_observations_from_episodes_to_batch": 3.112681057576369e-06}}, "connector_pipeline_timer": 4.553093494271898e-05}, "sample": 0.005142104274237688, "num_module_steps_sampled": {"default_policy": 5000.0}, "rlmodule_inference_timer": 2.9956461059341065e-05, "episode_return_max": 10.5, "agent_episode_returns_mean": {"default_agent": 5.940000000000001}, "episode_len_mean": 20.0, "time_between_sampling": 0.0020101447735266244, "env_step_timer": 1.4508464649282818e-05, "env_to_module_sum_episodes_length_out": 10.36823839457432, "env_reset_timer": 4.030129325710297e-05, "module_to_env_connector": {"timers": {"connectors": {"listify_data_for_vector_env": 1.1528871265173122e-05, "normalize_and_clip_actions": 9.823063390634927e-06, "get_actions": 4.287407251392003e-05, "un_batch_to_individual_items": 5.631965311786731e-06, "tensor_to_numpy": 1.3823000468114056e-05, "remove_single_ts_time_rank_from_batch": 6.146079331826707e-07}}, "connector_pipeline_timer": 0.0001106669870176187}, "episode_duration_sec_mean": 0.004816425817552953, "num_module_steps_sampled_lifetime": {"default_policy": -5547500.0}, "episode_len_min": 20, "episode_return_mean": 5.940000000000001, "episode_return_min": -9.5, "module_episode_returns_mean": {"default_policy": 5.940000000000001}, "episode_len_max": 20, "num_env_steps_sampled": 5000.0, "env_to_module_sum_episodes_length_in": 10.36823839457432, "num_env_steps_sampled_lifetime": -5547500.0, "num_env_steps_sampled_lifetime_throughput": 3527.5462601746767}, "learners": {"__all_modules__": {"num_env_steps_trained_lifetime": 346500, "learner_connector": {"timers": {"connectors": {"add_observations_from_episodes_to_batch": 0.0008360741829748115, "add_time_dim_to_batch_and_zero_pad": 2.0131902815538465e-05, "add_columns_from_episodes_to_train_batch": 0.03752901889552999, "add_one_ts_to_episodes_and_truncate": 0.009616956596898681, "add_states_from_episodes_to_batch": 3.902499842482712e-06, "numpy_to_tensor": 0.00010009806271401703, "batch_individual_items": 0.03821093632594423, "general_advantage_estimation": 0.008187554444552434}}, "connector_pipeline_timer": 0.09468064030546955}, "learner_connector_sum_episodes_length_in": 5000.0, "num_env_steps_trained": 31500, "num_module_steps_trained": 6000, "num_non_trainable_parameters": 0, "num_module_steps_trained_lifetime": 66000, "num_trainable_parameters": 6003, "learner_connector_sum_episodes_length_out": 5250.0, "num_env_steps_trained_lifetime_throughput": 1942554.2435289836, "num_module_steps_trained_throughput": 371191.6334065157, "num_module_steps_trained_lifetime_throughput": 370720.75521776674}, "default_policy": {"gradients_default_optimizer_global_norm": 0.044992342591285706, "weights_seq_no": 11.0, "num_module_steps_trained_lifetime": 66000, "num_trainable_parameters": 6003, "diff_num_grad_updates_vs_sampler_policy": 1.0, "policy_loss": -0.03828921541571617, "default_optimizer_learning_rate": 0.0002847858517, "vf_explained_var": -0.014516830444335938, "vf_loss": 0.10278083384037018, "vf_loss_unclipped": 29.646411895751953, "curr_entropy_coeff": 0.0090570820258, "module_train_batch_size_mean": 1000.0, "num_module_steps_trained": 6000, "total_loss": 0.024718768894672394, "mean_kl_loss": 0.00017876990023069084, "entropy": 0.6329572796821594, "curr_kl_coeff": 0.0003645001561380923, "num_module_steps_trained_lifetime_throughput": 371565.96005582}}, "num_training_step_calls_per_iteration": 1, "evaluation": {"env_runners": {"env_to_module_connector": {"timers": {"connectors": {"add_observations_from_episodes_to_batch": 2.714412504159411e-06, "add_time_dim_to_batch_and_zero_pad": 2.249938802905335e-06, "add_states_from_episodes_to_batch": 1.5788117418133718e-06, "numpy_to_tensor": 8.084061491304176e-06, "batch_individual_items": 6.082150617015678e-06}}, "connector_pipeline_timer": 4.1662450167972e-05}, "episode_return_mean": 2.45, "num_module_steps_sampled": {"default_policy": 400}, "num_episodes_lifetime": 220, "module_to_env_connector": {"timers": {"connectors": {"un_batch_to_individual_items": 5.279689966642198e-06, "tensor_to_numpy": 1.2632078500308966e-05, "listify_data_for_vector_env": 1.0845930052713887e-05, "remove_single_ts_time_rank_from_batch": 5.687698416822111e-07, "get_actions": 3.3940330995483914e-05, "normalize_and_clip_actions": 9.230487124350414e-06}}, "connector_pipeline_timer": 9.738033675367196e-05}, "rlmodule_inference_timer": 2.571940480904894e-05, "module_episode_returns_mean": {"default_policy": 2.45}, "env_to_module_sum_episodes_length_out": 10.368238394574323, "num_episodes": 20, "episode_return_max": 14.5, "env_reset_timer": 0.000439259547037922, "episode_len_min": 20, "episode_return_min": -13.5, "episode_len_max": 20, "env_to_module_sum_episodes_length_in": 10.368238394574323, "num_env_steps_sampled_lifetime": 55400, "agent_episode_returns_mean": {"default_agent": 2.45}, "num_module_steps_sampled_lifetime": {"default_policy": 4400}, "sample": 0.11466230663805455, "episode_duration_sec_mean": 0.004562215831829235, "num_agent_steps_sampled": {"default_agent": 400}, "num_env_steps_sampled": 400, "weights_seq_no": 11.0, "episode_len_mean": 20.0, "env_step_timer": 1.3636039380901892e-05, "num_agent_steps_sampled_lifetime": {"default_agent": 4400}, "time_between_sampling": 1.6479118690188574}, "num_healthy_workers": 1, "actor_manager_num_outstanding_async_reqs": 0, "num_remote_worker_restarts": 0}, "num_env_steps_sampled_lifetime": -5547500.0, "fault_tolerance": {"num_healthy_workers": 0, "num_remote_worker_restarts": 0}, "env_runner_group": {"actor_manager_num_outstanding_async_reqs": 0}, "done": false, "training_iteration": 11, "trial_id": "4dc31_00000", "date": "2025-08-11_19-19-41", "timestamp": 1754932781, "time_this_iter_s": 1.6583530902862549, "time_total_s": 19.194183349609375, "pid": 14098, "hostname": "Mac", "node_ip": "127.0.0.1", "config": {"exploration_config": {}, "extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "placement_strategy": "PACK", "num_gpus": 0, "_fake_gpus": false, "num_cpus_for_main_process": 2, "eager_tracing": true, "eager_max_retraces": 20, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "torch_compile_learner": false, "torch_compile_learner_what_to_compile": "forward_train", "torch_compile_learner_dynamo_backend": "aot_eager", "torch_compile_learner_dynamo_mode": null, "torch_compile_worker": false, "torch_compile_worker_dynamo_backend": "aot_eager", "torch_compile_worker_dynamo_mode": null, "torch_ddp_kwargs": {}, "torch_skip_nan_gradients": false, "env": "Umbrella", "env_config": {}, "observation_space": null, "action_space": null, "clip_rewards": null, "normalize_actions": true, "clip_actions": false, "_is_atari": null, "disable_env_checking": false, "render_env": false, "action_mask_key": "action_mask", "env_runner_cls": null, "num_env_runners": 0, "create_local_env_runner": true, "num_envs_per_env_runner": 1, "gym_env_vectorize_mode": "SYNC", "num_cpus_per_env_runner": 1, "num_gpus_per_env_runner": 0, "custom_resources_per_env_runner": {}, "validate_env_runners_after_construction": true, "episodes_to_numpy": true, "max_requests_in_flight_per_env_runner": 1, "sample_timeout_s": 60.0, "_env_to_module_connector": null, "add_default_connectors_to_env_to_module_pipeline": true, "_module_to_env_connector": null, "add_default_connectors_to_module_to_env_pipeline": true, "merge_env_runner_states": "training_only", "broadcast_env_runner_states": true, "episode_lookback_horizon": 1, "rollout_fragment_length": "auto", "batch_mode": "complete_episodes", "compress_observations": false, "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "enable_tf1_exec_eagerly": false, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "preprocessor_pref": "deepmind", "observation_filter": "NoFilter", "update_worker_filter_stats": true, "use_worker_filter_stats": true, "sampler_perf_stats_ema_coef": null, "_is_online": true, "num_learners": 0, "num_gpus_per_learner": 0, "num_cpus_per_learner": "auto", "num_aggregator_actors_per_learner": 0, "max_requests_in_flight_per_aggregator_actor": 3, "local_gpu_idx": 0, "max_requests_in_flight_per_learner": 3, "gamma": 1, "lr": 0.0002847858517, "grad_clip": 0.5, "grad_clip_by": "global_norm", "_train_batch_size_per_learner": 5000, "train_batch_size": 4000, "num_epochs": 1, "minibatch_size": 1000, "shuffle_batch_per_epoch": true, "model": {"fcnet_hiddens": [256, 256], "fcnet_activation": "tanh", "fcnet_weights_initializer": null, "fcnet_weights_initializer_config": null, "fcnet_bias_initializer": null, "fcnet_bias_initializer_config": null, "conv_filters": null, "conv_activation": "relu", "conv_kernel_initializer": null, "conv_kernel_initializer_config": null, "conv_bias_initializer": null, "conv_bias_initializer_config": null, "conv_transpose_kernel_initializer": null, "conv_transpose_kernel_initializer_config": null, "conv_transpose_bias_initializer": null, "conv_transpose_bias_initializer_config": null, "post_fcnet_hiddens": [], "post_fcnet_activation": "relu", "post_fcnet_weights_initializer": null, "post_fcnet_weights_initializer_config": null, "post_fcnet_bias_initializer": null, "post_fcnet_bias_initializer_config": null, "free_log_std": false, "log_std_clip_param": 20.0, "no_final_linear": false, "vf_share_layers": false, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "lstm_weights_initializer": null, "lstm_weights_initializer_config": null, "lstm_bias_initializer": null, "lstm_bias_initializer_config": null, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "attention_use_n_prev_actions": 0, "attention_use_n_prev_rewards": 0, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": null, "custom_model_config": {}, "custom_action_dist": null, "custom_preprocessor": null, "encoder_latent_dim": null, "always_check_shapes": false, "lstm_use_prev_action_reward": -1, "_use_default_native_models": -1, "_disable_preprocessor_api": false, "_disable_action_flattening": false}, "_learner_connector": null, "add_default_connectors_to_learner_pipeline": true, "learner_config_dict": {}, "optimizer": {}, "_learner_class": null, "callbacks_on_algorithm_init": null, "callbacks_on_env_runners_recreated": null, "callbacks_on_offline_eval_runners_recreated": null, "callbacks_on_checkpoint_loaded": null, "callbacks_on_environment_created": null, "callbacks_on_episode_created": null, "callbacks_on_episode_start": null, "callbacks_on_episode_step": null, "callbacks_on_episode_end": null, "callbacks_on_evaluate_start": null, "callbacks_on_evaluate_end": null, "callbacks_on_evaluate_offline_start": null, "callbacks_on_evaluate_offline_end": null, "callbacks_on_sample_end": null, "callbacks_on_train_result": null, "explore": true, "enable_rl_module_and_learner": true, "enable_env_runner_and_connector_v2": true, "_prior_exploration_config": {"type": "StochasticSampling"}, "count_steps_by": "env_steps", "policy_map_capacity": 100, "policy_mapping_fn": "<function AlgorithmConfig.DEFAULT_POLICY_MAPPING_FN at 0x385441b20>", "policies_to_train": null, "policy_states_are_swappable": false, "observation_fn": null, "offline_data_class": null, "input_read_method": "read_parquet", "input_read_method_kwargs": {}, "input_read_schema": {}, "input_read_episodes": false, "input_read_sample_batches": false, "input_read_batch_size": null, "input_filesystem": null, "input_filesystem_kwargs": {}, "input_compress_columns": ["obs", "new_obs"], "input_spaces_jsonable": true, "materialize_data": false, "materialize_mapped_data": true, "map_batches_kwargs": {}, "iter_batches_kwargs": {}, "ignore_final_observation": false, "prelearner_class": null, "prelearner_buffer_class": null, "prelearner_buffer_kwargs": {}, "prelearner_module_synch_period": 10, "dataset_num_iters_per_learner": null, "input_config": {}, "actions_in_input_normalized": false, "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_config": {}, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "output_max_rows_per_file": null, "output_write_remaining_data": false, "output_write_method": "write_parquet", "output_write_method_kwargs": {}, "output_filesystem": null, "output_filesystem_kwargs": {}, "output_write_episodes": true, "offline_sampling": false, "evaluation_interval": 1, "evaluation_duration": 20, "evaluation_duration_unit": "episodes", "evaluation_sample_timeout_s": 120.0, "evaluation_auto_duration_min_env_steps_per_sample": 100, "evaluation_auto_duration_max_env_steps_per_sample": 2000, "evaluation_parallel_to_training": false, "evaluation_force_reset_envs_before_iteration": true, "evaluation_config": null, "off_policy_estimation_methods": {}, "ope_split_batch_by_episode": true, "evaluation_num_env_runners": 1, "in_evaluation": false, "sync_filters_on_rollout_workers_timeout_s": 10.0, "offline_evaluation_interval": null, "num_offline_eval_runners": 0, "offline_loss_for_module_fn": null, "offline_evaluation_duration": 1, "offline_evaluation_parallel_to_training": false, "offline_evaluation_timeout_s": 120.0, "num_cpus_per_offline_eval_runner": 1, "num_gpus_per_offline_eval_runner": 0, "custom_resources_per_offline_eval_runner": {}, "restart_failed_offline_eval_runners": true, "ignore_offline_eval_runner_failures": false, "max_num_offline_eval_runner_restarts": 1000, "offline_eval_runner_restore_timeout_s": 1800.0, "max_requests_in_flight_per_offline_eval_runner": 1, "validate_offline_eval_runners_after_construction": true, "offline_eval_runner_health_probe_timeout_s": 30.0, "offline_eval_rl_module_inference_only": false, "broadcast_offline_eval_runner_states": false, "offline_eval_batch_size_per_runner": 256, "dataset_num_iters_per_eval_runner": 1, "keep_per_episode_custom_metrics": false, "metrics_episode_collection_timeout_s": 60.0, "metrics_num_episodes_for_smoothing": 100, "min_time_s_per_iteration": null, "min_train_timesteps_per_iteration": 0, "min_sample_timesteps_per_iteration": 0, "log_gradients": true, "export_native_model_files": false, "checkpoint_trainable_policies_only": false, "logger_creator": null, "logger_config": null, "log_level": "WARN", "log_sys_usage": true, "fake_sampler": false, "seed": 6, "restart_failed_env_runners": true, "ignore_env_runner_failures": false, "max_num_env_runner_restarts": 1000, "delay_between_env_runner_restarts_s": 60.0, "restart_failed_sub_environments": false, "num_consecutive_env_runner_failures_tolerance": 100, "env_runner_health_probe_timeout_s": 30.0, "env_runner_restore_timeout_s": 1800.0, "_model_config": {}, "_rl_module_spec": "RLModuleSpec(module_class=None, observation_space=None, action_space=None, inference_only=False, learner_only=False, model_config=DefaultModelConfig(fcnet_hiddens=[60, 90], fcnet_activation='tanh', fcnet_kernel_initializer=None, fcnet_kernel_initializer_kwargs=None, fcnet_bias_initializer=None, fcnet_bias_initializer_kwargs=None, conv_filters=None, conv_activation='relu', conv_kernel_initializer=None, conv_kernel_initializer_kwargs=None, conv_bias_initializer=None, conv_bias_initializer_kwargs=None, head_fcnet_hiddens=[], head_fcnet_activation='relu', head_fcnet_kernel_initializer=None, head_fcnet_kernel_initializer_kwargs=None, head_fcnet_bias_initializer=None, head_fcnet_bias_initializer_kwargs=None, free_log_std=False, log_std_clip_param=20.0, vf_share_layers=True, use_lstm=False, max_seq_len=20, lstm_cell_size=256, lstm_use_prev_action=False, lstm_use_prev_reward=False, lstm_kernel_initializer=None, lstm_kernel_initializer_kwargs=None, lstm_bias_initializer=None, lstm_bias_initializer_kwargs=None), catalog_class=None, load_state_path=None, model_config_dict=None)", "algorithm_config_overrides_per_module": {}, "_per_module_overrides": {}, "_validate_config": true, "_use_msgpack_checkpoints": false, "_torch_grad_scaler_class": null, "_torch_lr_scheduler_classes": null, "_tf_policy_handles_more_than_one_loss": false, "_disable_preprocessor_api": false, "_disable_action_flattening": false, "_disable_initialize_loss_from_dummy_batch": false, "_dont_auto_sync_env_runner_states": false, "env_task_fn": -1, "enable_connectors": -1, "simple_optimizer": false, "policy_map_cache": -1, "worker_cls": -1, "synchronize_filters": -1, "enable_async_evaluation": -1, "custom_async_evaluation_function": -1, "_enable_rl_module_api": -1, "auto_wrap_old_gym_envs": -1, "always_attach_evaluation_results": -1, "replay_sequence_length": null, "_disable_execution_plan_api": -1, "use_critic": true, "use_gae": true, "use_kl_loss": true, "kl_coeff": 0.7464963036515, "kl_target": 0.0270990929592, "vf_loss_coeff": 0.6688075857018, "entropy_coeff": 0.0090570820258, "clip_param": 0.1221781641624, "vf_clip_param": 0.1027808522125, "entropy_coeff_schedule": null, "lr_schedule": null, "sgd_minibatch_size": -1, "vf_share_layers": -1, "__stdout_file__": null, "__stderr_file__": null, "lambda": 0.9099046732075, "input": "sampler", "policies": {"default_policy": [null, null, null, null]}, "callbacks": "<class 'ray.rllib.callbacks.callbacks.RLlibCallback'>", "create_env_on_driver": false, "custom_eval_function": null, "framework": "torch"}, "time_since_restore": 19.194183349609375, "iterations_since_restore": 11, "perf": {"cpu_util_percent": 50.93333333333334, "ram_util_percent": 83.66666666666667}}
{"timers": {"training_iteration": 1.7216722131660467, "restore_env_runners": 1.7357524238477935e-05, "training_step": 1.7215252740083742, "env_runner_sampling_timer": 1.5935629342976048, "learner_update_timer": 0.12441339996713464, "synch_weights": 0.0008385976441007148, "restore_eval_env_runners": 8.774931856533117e-06, "evaluation_iteration": 0.13002833646802503, "synch_eval_env_connectors": 0.0001452463083909423, "synch_env_connectors": 5.047784256415177e-06}, "env_runners": {"num_episodes": 250.0, "num_agent_steps_sampled": {"default_agent": 5000.0}, "weights_seq_no": 11.0, "num_agent_steps_sampled_lifetime": {"default_agent": -6165000.0}, "num_episodes_lifetime": -308250.0, "env_to_module_connector": {"timers": {"connectors": {"add_states_from_episodes_to_batch": 1.7369582968536423e-06, "add_time_dim_to_batch_and_zero_pad": 2.314805557440146e-06, "numpy_to_tensor": 8.572613310286905e-06, "batch_individual_items": 6.199849621316595e-06, "add_observations_from_episodes_to_batch": 3.0277465988463618e-06}}, "connector_pipeline_timer": 4.3959176757003176e-05}, "sample": 0.004976746224062238, "num_module_steps_sampled": {"default_policy": 5000.0}, "rlmodule_inference_timer": 2.7848345630249188e-05, "episode_return_max": 10.5, "agent_episode_returns_mean": {"default_agent": 6.659999999999997}, "episode_len_mean": 20.0, "time_between_sampling": 0.0018410917215726866, "env_step_timer": 1.3662942428952461e-05, "env_to_module_sum_episodes_length_out": 10.36823839457432, "env_reset_timer": 3.5574443787892274e-05, "module_to_env_connector": {"timers": {"connectors": {"listify_data_for_vector_env": 1.0931139130284419e-05, "normalize_and_clip_actions": 9.396617016900275e-06, "get_actions": 3.9296562161858525e-05, "un_batch_to_individual_items": 5.422512709713596e-06, "tensor_to_numpy": 1.3131780724835386e-05, "remove_single_ts_time_rank_from_batch": 5.947084304735397e-07}}, "connector_pipeline_timer": 0.0001044400158195098}, "episode_duration_sec_mean": 0.004566984828561544, "num_module_steps_sampled_lifetime": {"default_policy": -6165000.0}, "episode_len_min": 20, "episode_return_mean": 6.659999999999997, "episode_return_min": -9.5, "module_episode_returns_mean": {"default_policy": 6.659999999999997}, "episode_len_max": 20, "num_env_steps_sampled": 5000.0, "env_to_module_sum_episodes_length_in": 10.36823839457432, "num_env_steps_sampled_lifetime": -6165000.0, "num_env_steps_sampled_lifetime_throughput": 3699.945386094441}, "learners": {"__all_modules__": {"num_env_steps_trained_lifetime": 378000, "learner_connector": {"timers": {"connectors": {"add_observations_from_episodes_to_batch": 0.0008359005314245979, "add_time_dim_to_batch_and_zero_pad": 2.0027243429095983e-05, "add_columns_from_episodes_to_train_batch": 0.03749601078666622, "add_one_ts_to_episodes_and_truncate": 0.009597710371023038, "add_states_from_episodes_to_batch": 3.890974471379843e-06, "numpy_to_tensor": 9.960375299960458e-05, "batch_individual_items": 0.03813151488331477, "general_advantage_estimation": 0.008159462649569947}}, "connector_pipeline_timer": 0.0945192530726939}, "learner_connector_sum_episodes_length_in": 5000.0, "num_env_steps_trained": 31500, "num_module_steps_trained": 6000, "num_non_trainable_parameters": 0, "num_module_steps_trained_lifetime": 72000, "num_trainable_parameters": 6003, "learner_connector_sum_episodes_length_out": 5250.0, "num_env_steps_trained_lifetime_throughput": 1951592.812063118, "num_module_steps_trained_throughput": 372869.84007239, "num_module_steps_trained_lifetime_throughput": 372411.809374286}, "default_policy": {"gradients_default_optimizer_global_norm": 0.04603158310055733, "weights_seq_no": 12.0, "num_module_steps_trained_lifetime": 72000, "num_trainable_parameters": 6003, "diff_num_grad_updates_vs_sampler_policy": 1.0, "policy_loss": 0.05211615562438965, "default_optimizer_learning_rate": 0.0002847858517, "vf_explained_var": -0.015211820602416992, "vf_loss": 0.10278083384037018, "vf_loss_unclipped": 29.652629852294922, "curr_entropy_coeff": 0.0090570820258, "module_train_batch_size_mean": 1000.0, "num_module_steps_trained": 6000, "total_loss": 0.11514448374509811, "mean_kl_loss": 3.76364951080177e-05, "entropy": 0.6306999921798706, "curr_kl_coeff": 0.00018225007806904614, "num_module_steps_trained_lifetime_throughput": 373196.2114226329}}, "num_training_step_calls_per_iteration": 1, "evaluation": {"env_runners": {"env_to_module_connector": {"timers": {"connectors": {"add_observations_from_episodes_to_batch": 2.7504441687926654e-06, "add_time_dim_to_batch_and_zero_pad": 2.2966818888908694e-06, "add_states_from_episodes_to_batch": 1.596944166867602e-06, "numpy_to_tensor": 8.239419095808779e-06, "batch_individual_items": 6.14628052825547e-06}}, "connector_pipeline_timer": 4.2031501480378285e-05}, "episode_return_mean": 2.25, "num_module_steps_sampled": {"default_policy": 400}, "num_episodes_lifetime": 240, "module_to_env_connector": {"timers": {"connectors": {"un_batch_to_individual_items": 5.257085855854176e-06, "tensor_to_numpy": 1.2826408218212765e-05, "listify_data_for_vector_env": 1.093703038383057e-05, "remove_single_ts_time_rank_from_batch": 5.678838476233292e-07, "get_actions": 3.4631627972068e-05, "normalize_and_clip_actions": 9.343688399290183e-06}}, "connector_pipeline_timer": 9.85974200180002e-05}, "rlmodule_inference_timer": 2.6463182856964424e-05, "module_episode_returns_mean": {"default_policy": 2.25}, "env_to_module_sum_episodes_length_out": 10.368238394574323, "num_episodes": 20, "episode_return_max": 14.5, "env_reset_timer": 0.0004355977813466015, "episode_len_min": 20, "episode_return_min": -13.5, "episode_len_max": 20, "env_to_module_sum_episodes_length_in": 10.368238394574323, "num_env_steps_sampled_lifetime": 60400, "agent_episode_returns_mean": {"default_agent": 2.25}, "num_module_steps_sampled_lifetime": {"default_policy": 4800}, "sample": 0.11447623024075856, "episode_duration_sec_mean": 0.004555167091311887, "num_agent_steps_sampled": {"default_agent": 400}, "num_env_steps_sampled": 400, "weights_seq_no": 12.0, "episode_len_mean": 20.0, "env_step_timer": 1.3847114684136609e-05, "num_agent_steps_sampled_lifetime": {"default_agent": 4800}, "time_between_sampling": 1.6472909978288146}, "num_healthy_workers": 1, "actor_manager_num_outstanding_async_reqs": 0, "num_remote_worker_restarts": 0}, "num_env_steps_sampled_lifetime": -6165000.0, "fault_tolerance": {"num_healthy_workers": 0, "num_remote_worker_restarts": 0}, "env_runner_group": {"actor_manager_num_outstanding_async_reqs": 0}, "done": false, "training_iteration": 12, "trial_id": "4dc31_00000", "date": "2025-08-11_19-19-43", "timestamp": 1754932783, "time_this_iter_s": 1.6701421737670898, "time_total_s": 20.864325523376465, "pid": 14098, "hostname": "Mac", "node_ip": "127.0.0.1", "config": {"exploration_config": {}, "extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "placement_strategy": "PACK", "num_gpus": 0, "_fake_gpus": false, "num_cpus_for_main_process": 2, "eager_tracing": true, "eager_max_retraces": 20, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "torch_compile_learner": false, "torch_compile_learner_what_to_compile": "forward_train", "torch_compile_learner_dynamo_backend": "aot_eager", "torch_compile_learner_dynamo_mode": null, "torch_compile_worker": false, "torch_compile_worker_dynamo_backend": "aot_eager", "torch_compile_worker_dynamo_mode": null, "torch_ddp_kwargs": {}, "torch_skip_nan_gradients": false, "env": "Umbrella", "env_config": {}, "observation_space": null, "action_space": null, "clip_rewards": null, "normalize_actions": true, "clip_actions": false, "_is_atari": null, "disable_env_checking": false, "render_env": false, "action_mask_key": "action_mask", "env_runner_cls": null, "num_env_runners": 0, "create_local_env_runner": true, "num_envs_per_env_runner": 1, "gym_env_vectorize_mode": "SYNC", "num_cpus_per_env_runner": 1, "num_gpus_per_env_runner": 0, "custom_resources_per_env_runner": {}, "validate_env_runners_after_construction": true, "episodes_to_numpy": true, "max_requests_in_flight_per_env_runner": 1, "sample_timeout_s": 60.0, "_env_to_module_connector": null, "add_default_connectors_to_env_to_module_pipeline": true, "_module_to_env_connector": null, "add_default_connectors_to_module_to_env_pipeline": true, "merge_env_runner_states": "training_only", "broadcast_env_runner_states": true, "episode_lookback_horizon": 1, "rollout_fragment_length": "auto", "batch_mode": "complete_episodes", "compress_observations": false, "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "enable_tf1_exec_eagerly": false, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "preprocessor_pref": "deepmind", "observation_filter": "NoFilter", "update_worker_filter_stats": true, "use_worker_filter_stats": true, "sampler_perf_stats_ema_coef": null, "_is_online": true, "num_learners": 0, "num_gpus_per_learner": 0, "num_cpus_per_learner": "auto", "num_aggregator_actors_per_learner": 0, "max_requests_in_flight_per_aggregator_actor": 3, "local_gpu_idx": 0, "max_requests_in_flight_per_learner": 3, "gamma": 1, "lr": 0.0002847858517, "grad_clip": 0.5, "grad_clip_by": "global_norm", "_train_batch_size_per_learner": 5000, "train_batch_size": 4000, "num_epochs": 1, "minibatch_size": 1000, "shuffle_batch_per_epoch": true, "model": {"fcnet_hiddens": [256, 256], "fcnet_activation": "tanh", "fcnet_weights_initializer": null, "fcnet_weights_initializer_config": null, "fcnet_bias_initializer": null, "fcnet_bias_initializer_config": null, "conv_filters": null, "conv_activation": "relu", "conv_kernel_initializer": null, "conv_kernel_initializer_config": null, "conv_bias_initializer": null, "conv_bias_initializer_config": null, "conv_transpose_kernel_initializer": null, "conv_transpose_kernel_initializer_config": null, "conv_transpose_bias_initializer": null, "conv_transpose_bias_initializer_config": null, "post_fcnet_hiddens": [], "post_fcnet_activation": "relu", "post_fcnet_weights_initializer": null, "post_fcnet_weights_initializer_config": null, "post_fcnet_bias_initializer": null, "post_fcnet_bias_initializer_config": null, "free_log_std": false, "log_std_clip_param": 20.0, "no_final_linear": false, "vf_share_layers": false, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "lstm_weights_initializer": null, "lstm_weights_initializer_config": null, "lstm_bias_initializer": null, "lstm_bias_initializer_config": null, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "attention_use_n_prev_actions": 0, "attention_use_n_prev_rewards": 0, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": null, "custom_model_config": {}, "custom_action_dist": null, "custom_preprocessor": null, "encoder_latent_dim": null, "always_check_shapes": false, "lstm_use_prev_action_reward": -1, "_use_default_native_models": -1, "_disable_preprocessor_api": false, "_disable_action_flattening": false}, "_learner_connector": null, "add_default_connectors_to_learner_pipeline": true, "learner_config_dict": {}, "optimizer": {}, "_learner_class": null, "callbacks_on_algorithm_init": null, "callbacks_on_env_runners_recreated": null, "callbacks_on_offline_eval_runners_recreated": null, "callbacks_on_checkpoint_loaded": null, "callbacks_on_environment_created": null, "callbacks_on_episode_created": null, "callbacks_on_episode_start": null, "callbacks_on_episode_step": null, "callbacks_on_episode_end": null, "callbacks_on_evaluate_start": null, "callbacks_on_evaluate_end": null, "callbacks_on_evaluate_offline_start": null, "callbacks_on_evaluate_offline_end": null, "callbacks_on_sample_end": null, "callbacks_on_train_result": null, "explore": true, "enable_rl_module_and_learner": true, "enable_env_runner_and_connector_v2": true, "_prior_exploration_config": {"type": "StochasticSampling"}, "count_steps_by": "env_steps", "policy_map_capacity": 100, "policy_mapping_fn": "<function AlgorithmConfig.DEFAULT_POLICY_MAPPING_FN at 0x385441b20>", "policies_to_train": null, "policy_states_are_swappable": false, "observation_fn": null, "offline_data_class": null, "input_read_method": "read_parquet", "input_read_method_kwargs": {}, "input_read_schema": {}, "input_read_episodes": false, "input_read_sample_batches": false, "input_read_batch_size": null, "input_filesystem": null, "input_filesystem_kwargs": {}, "input_compress_columns": ["obs", "new_obs"], "input_spaces_jsonable": true, "materialize_data": false, "materialize_mapped_data": true, "map_batches_kwargs": {}, "iter_batches_kwargs": {}, "ignore_final_observation": false, "prelearner_class": null, "prelearner_buffer_class": null, "prelearner_buffer_kwargs": {}, "prelearner_module_synch_period": 10, "dataset_num_iters_per_learner": null, "input_config": {}, "actions_in_input_normalized": false, "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_config": {}, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "output_max_rows_per_file": null, "output_write_remaining_data": false, "output_write_method": "write_parquet", "output_write_method_kwargs": {}, "output_filesystem": null, "output_filesystem_kwargs": {}, "output_write_episodes": true, "offline_sampling": false, "evaluation_interval": 1, "evaluation_duration": 20, "evaluation_duration_unit": "episodes", "evaluation_sample_timeout_s": 120.0, "evaluation_auto_duration_min_env_steps_per_sample": 100, "evaluation_auto_duration_max_env_steps_per_sample": 2000, "evaluation_parallel_to_training": false, "evaluation_force_reset_envs_before_iteration": true, "evaluation_config": null, "off_policy_estimation_methods": {}, "ope_split_batch_by_episode": true, "evaluation_num_env_runners": 1, "in_evaluation": false, "sync_filters_on_rollout_workers_timeout_s": 10.0, "offline_evaluation_interval": null, "num_offline_eval_runners": 0, "offline_loss_for_module_fn": null, "offline_evaluation_duration": 1, "offline_evaluation_parallel_to_training": false, "offline_evaluation_timeout_s": 120.0, "num_cpus_per_offline_eval_runner": 1, "num_gpus_per_offline_eval_runner": 0, "custom_resources_per_offline_eval_runner": {}, "restart_failed_offline_eval_runners": true, "ignore_offline_eval_runner_failures": false, "max_num_offline_eval_runner_restarts": 1000, "offline_eval_runner_restore_timeout_s": 1800.0, "max_requests_in_flight_per_offline_eval_runner": 1, "validate_offline_eval_runners_after_construction": true, "offline_eval_runner_health_probe_timeout_s": 30.0, "offline_eval_rl_module_inference_only": false, "broadcast_offline_eval_runner_states": false, "offline_eval_batch_size_per_runner": 256, "dataset_num_iters_per_eval_runner": 1, "keep_per_episode_custom_metrics": false, "metrics_episode_collection_timeout_s": 60.0, "metrics_num_episodes_for_smoothing": 100, "min_time_s_per_iteration": null, "min_train_timesteps_per_iteration": 0, "min_sample_timesteps_per_iteration": 0, "log_gradients": true, "export_native_model_files": false, "checkpoint_trainable_policies_only": false, "logger_creator": null, "logger_config": null, "log_level": "WARN", "log_sys_usage": true, "fake_sampler": false, "seed": 6, "restart_failed_env_runners": true, "ignore_env_runner_failures": false, "max_num_env_runner_restarts": 1000, "delay_between_env_runner_restarts_s": 60.0, "restart_failed_sub_environments": false, "num_consecutive_env_runner_failures_tolerance": 100, "env_runner_health_probe_timeout_s": 30.0, "env_runner_restore_timeout_s": 1800.0, "_model_config": {}, "_rl_module_spec": "RLModuleSpec(module_class=None, observation_space=None, action_space=None, inference_only=False, learner_only=False, model_config=DefaultModelConfig(fcnet_hiddens=[60, 90], fcnet_activation='tanh', fcnet_kernel_initializer=None, fcnet_kernel_initializer_kwargs=None, fcnet_bias_initializer=None, fcnet_bias_initializer_kwargs=None, conv_filters=None, conv_activation='relu', conv_kernel_initializer=None, conv_kernel_initializer_kwargs=None, conv_bias_initializer=None, conv_bias_initializer_kwargs=None, head_fcnet_hiddens=[], head_fcnet_activation='relu', head_fcnet_kernel_initializer=None, head_fcnet_kernel_initializer_kwargs=None, head_fcnet_bias_initializer=None, head_fcnet_bias_initializer_kwargs=None, free_log_std=False, log_std_clip_param=20.0, vf_share_layers=True, use_lstm=False, max_seq_len=20, lstm_cell_size=256, lstm_use_prev_action=False, lstm_use_prev_reward=False, lstm_kernel_initializer=None, lstm_kernel_initializer_kwargs=None, lstm_bias_initializer=None, lstm_bias_initializer_kwargs=None), catalog_class=None, load_state_path=None, model_config_dict=None)", "algorithm_config_overrides_per_module": {}, "_per_module_overrides": {}, "_validate_config": true, "_use_msgpack_checkpoints": false, "_torch_grad_scaler_class": null, "_torch_lr_scheduler_classes": null, "_tf_policy_handles_more_than_one_loss": false, "_disable_preprocessor_api": false, "_disable_action_flattening": false, "_disable_initialize_loss_from_dummy_batch": false, "_dont_auto_sync_env_runner_states": false, "env_task_fn": -1, "enable_connectors": -1, "simple_optimizer": false, "policy_map_cache": -1, "worker_cls": -1, "synchronize_filters": -1, "enable_async_evaluation": -1, "custom_async_evaluation_function": -1, "_enable_rl_module_api": -1, "auto_wrap_old_gym_envs": -1, "always_attach_evaluation_results": -1, "replay_sequence_length": null, "_disable_execution_plan_api": -1, "use_critic": true, "use_gae": true, "use_kl_loss": true, "kl_coeff": 0.7464963036515, "kl_target": 0.0270990929592, "vf_loss_coeff": 0.6688075857018, "entropy_coeff": 0.0090570820258, "clip_param": 0.1221781641624, "vf_clip_param": 0.1027808522125, "entropy_coeff_schedule": null, "lr_schedule": null, "sgd_minibatch_size": -1, "vf_share_layers": -1, "__stdout_file__": null, "__stderr_file__": null, "lambda": 0.9099046732075, "input": "sampler", "policies": {"default_policy": [null, null, null, null]}, "callbacks": "<class 'ray.rllib.callbacks.callbacks.RLlibCallback'>", "create_env_on_driver": false, "custom_eval_function": null, "framework": "torch"}, "time_since_restore": 20.864325523376465, "iterations_since_restore": 12, "perf": {"cpu_util_percent": 42.45, "ram_util_percent": 83.45}}
{"timers": {"training_iteration": 1.7204519022838933, "restore_env_runners": 1.725144892799485e-05, "training_step": 1.7203046225191494, "env_runner_sampling_timer": 1.5925040149553096, "learner_update_timer": 0.12425421971655, "synch_weights": 0.0008379174969988096, "restore_eval_env_runners": 8.765932846570836e-06, "evaluation_iteration": 0.1297388960238586, "synch_eval_env_connectors": 0.00014476551510388716, "synch_env_connectors": 5.03730671843076e-06}, "env_runners": {"num_episodes": 250.0, "num_agent_steps_sampled": {"default_agent": 5000.0}, "weights_seq_no": 12.0, "num_agent_steps_sampled_lifetime": {"default_agent": -6782500.0}, "num_episodes_lifetime": -339125.0, "env_to_module_connector": {"timers": {"connectors": {"add_states_from_episodes_to_batch": 1.7774693450249134e-06, "add_time_dim_to_batch_and_zero_pad": 2.3510180792298797e-06, "numpy_to_tensor": 8.652153914820147e-06, "batch_individual_items": 6.257709890605724e-06, "add_observations_from_episodes_to_batch": 2.99601595955595e-06}}, "connector_pipeline_timer": 4.4276431190023026e-05}, "sample": 0.004858507483816879, "num_module_steps_sampled": {"default_policy": 5000.0}, "rlmodule_inference_timer": 2.783364875995855e-05, "episode_return_max": 10.5, "agent_episode_returns_mean": {"default_agent": 7.46}, "episode_len_mean": 20.0, "time_between_sampling": 0.0016849730128589457, "env_step_timer": 1.3834802080216497e-05, "env_to_module_sum_episodes_length_out": 10.36823839457432, "env_reset_timer": 3.26699512918964e-05, "module_to_env_connector": {"timers": {"connectors": {"listify_data_for_vector_env": 1.1041038961740755e-05, "normalize_and_clip_actions": 9.51080381446552e-06, "get_actions": 3.969711128847782e-05, "un_batch_to_individual_items": 5.4267471857125695e-06, "tensor_to_numpy": 1.3247171778381601e-05, "remove_single_ts_time_rank_from_batch": 5.979147754172532e-07}}, "connector_pipeline_timer": 0.00010542683524677947}, "episode_duration_sec_mean": 0.004617918310686945, "num_module_steps_sampled_lifetime": {"default_policy": -6782500.0}, "episode_len_min": 20, "episode_return_mean": 7.46, "episode_return_min": -9.5, "module_episode_returns_mean": {"default_policy": 7.46}, "episode_len_max": 20, "num_env_steps_sampled": 5000.0, "env_to_module_sum_episodes_length_in": 10.36823839457432, "num_env_steps_sampled_lifetime": -6782500.0, "num_env_steps_sampled_lifetime_throughput": 3706.0623808515948}, "learners": {"__all_modules__": {"num_env_steps_trained_lifetime": 409500, "learner_connector": {"timers": {"connectors": {"add_observations_from_episodes_to_batch": 0.0008360652766949244, "add_time_dim_to_batch_and_zero_pad": 1.9981130492274688e-05, "add_columns_from_episodes_to_train_batch": 0.03752886775848519, "add_one_ts_to_episodes_and_truncate": 0.009580048266431255, "add_states_from_episodes_to_batch": 3.883725037590098e-06, "numpy_to_tensor": 9.932396539376163e-05, "batch_individual_items": 0.03815225765390006, "general_advantage_estimation": 0.008130554272911527}}, "connector_pipeline_timer": 0.09452555762177149}, "learner_connector_sum_episodes_length_in": 5000.0, "num_env_steps_trained": 31500, "num_module_steps_trained": 6000, "num_non_trainable_parameters": 0, "num_module_steps_trained_lifetime": 78000, "num_trainable_parameters": 6003, "learner_connector_sum_episodes_length_out": 5250.0, "num_env_steps_trained_lifetime_throughput": 1963101.1485943305, "num_module_steps_trained_throughput": 375019.3782660188, "num_module_steps_trained_lifetime_throughput": 374573.64165691484}, "default_policy": {"gradients_default_optimizer_global_norm": 0.12169253826141357, "weights_seq_no": 13.0, "num_module_steps_trained_lifetime": 78000, "num_trainable_parameters": 6003, "diff_num_grad_updates_vs_sampler_policy": 1.0, "policy_loss": -0.14317864179611206, "default_optimizer_learning_rate": 0.0002847858517, "vf_explained_var": -0.012235283851623535, "vf_loss": 0.10278083384037018, "vf_loss_unclipped": 30.071489334106445, "curr_entropy_coeff": 0.0090570820258, "module_train_batch_size_mean": 1000.0, "num_module_steps_trained": 6000, "total_loss": -0.08020195364952087, "mean_kl_loss": 0.0001085606127162464, "entropy": 0.6363987922668457, "curr_kl_coeff": 9.112503903452307e-05, "num_module_steps_trained_lifetime_throughput": 375292.1259374935}}, "num_training_step_calls_per_iteration": 1, "evaluation": {"env_runners": {"env_to_module_connector": {"timers": {"connectors": {"add_observations_from_episodes_to_batch": 2.9155059615218166e-06, "add_time_dim_to_batch_and_zero_pad": 2.361139815747844e-06, "add_states_from_episodes_to_batch": 1.7678125318036175e-06, "numpy_to_tensor": 8.782902304332212e-06, "batch_individual_items": 6.500505699525648e-06}}, "connector_pipeline_timer": 4.4457685508115406e-05}, "episode_return_mean": 1.05, "num_module_steps_sampled": {"default_policy": 400}, "num_episodes_lifetime": 260, "module_to_env_connector": {"timers": {"connectors": {"un_batch_to_individual_items": 6.012888743959738e-06, "tensor_to_numpy": 1.3792550187623216e-05, "listify_data_for_vector_env": 1.1966466264694025e-05, "remove_single_ts_time_rank_from_batch": 6.594132320752329e-07, "get_actions": 3.849114726101703e-05, "normalize_and_clip_actions": 1.0848667620836134e-05}}, "connector_pipeline_timer": 0.00010962204544729305}, "rlmodule_inference_timer": 2.8638473981435636e-05, "module_episode_returns_mean": {"default_policy": 1.05}, "env_to_module_sum_episodes_length_out": 10.368238394574323, "num_episodes": 20, "episode_return_max": 14.5, "env_reset_timer": 0.0004322551337170587, "episode_len_min": 20, "episode_return_min": -13.5, "episode_len_max": 20, "env_to_module_sum_episodes_length_in": 10.368238394574323, "num_env_steps_sampled_lifetime": 65400, "agent_episode_returns_mean": {"default_agent": 1.05}, "num_module_steps_sampled_lifetime": {"default_policy": 5200}, "sample": 0.11435517585787223, "episode_duration_sec_mean": 0.004545487484429032, "num_agent_steps_sampled": {"default_agent": 400}, "num_env_steps_sampled": 400, "weights_seq_no": 13.0, "episode_len_mean": 20.0, "env_step_timer": 1.5066734708026156e-05, "num_agent_steps_sampled_lifetime": {"default_agent": 5200}, "time_between_sampling": 1.647004672440995}, "num_healthy_workers": 1, "actor_manager_num_outstanding_async_reqs": 0, "num_remote_worker_restarts": 0}, "num_env_steps_sampled_lifetime": -6782500.0, "fault_tolerance": {"num_healthy_workers": 0, "num_remote_worker_restarts": 0}, "env_runner_group": {"actor_manager_num_outstanding_async_reqs": 0}, "done": false, "training_iteration": 13, "trial_id": "4dc31_00000", "date": "2025-08-11_19-19-44", "timestamp": 1754932784, "time_this_iter_s": 1.7095746994018555, "time_total_s": 22.57390022277832, "pid": 14098, "hostname": "Mac", "node_ip": "127.0.0.1", "config": {"exploration_config": {}, "extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "placement_strategy": "PACK", "num_gpus": 0, "_fake_gpus": false, "num_cpus_for_main_process": 2, "eager_tracing": true, "eager_max_retraces": 20, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "torch_compile_learner": false, "torch_compile_learner_what_to_compile": "forward_train", "torch_compile_learner_dynamo_backend": "aot_eager", "torch_compile_learner_dynamo_mode": null, "torch_compile_worker": false, "torch_compile_worker_dynamo_backend": "aot_eager", "torch_compile_worker_dynamo_mode": null, "torch_ddp_kwargs": {}, "torch_skip_nan_gradients": false, "env": "Umbrella", "env_config": {}, "observation_space": null, "action_space": null, "clip_rewards": null, "normalize_actions": true, "clip_actions": false, "_is_atari": null, "disable_env_checking": false, "render_env": false, "action_mask_key": "action_mask", "env_runner_cls": null, "num_env_runners": 0, "create_local_env_runner": true, "num_envs_per_env_runner": 1, "gym_env_vectorize_mode": "SYNC", "num_cpus_per_env_runner": 1, "num_gpus_per_env_runner": 0, "custom_resources_per_env_runner": {}, "validate_env_runners_after_construction": true, "episodes_to_numpy": true, "max_requests_in_flight_per_env_runner": 1, "sample_timeout_s": 60.0, "_env_to_module_connector": null, "add_default_connectors_to_env_to_module_pipeline": true, "_module_to_env_connector": null, "add_default_connectors_to_module_to_env_pipeline": true, "merge_env_runner_states": "training_only", "broadcast_env_runner_states": true, "episode_lookback_horizon": 1, "rollout_fragment_length": "auto", "batch_mode": "complete_episodes", "compress_observations": false, "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "enable_tf1_exec_eagerly": false, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "preprocessor_pref": "deepmind", "observation_filter": "NoFilter", "update_worker_filter_stats": true, "use_worker_filter_stats": true, "sampler_perf_stats_ema_coef": null, "_is_online": true, "num_learners": 0, "num_gpus_per_learner": 0, "num_cpus_per_learner": "auto", "num_aggregator_actors_per_learner": 0, "max_requests_in_flight_per_aggregator_actor": 3, "local_gpu_idx": 0, "max_requests_in_flight_per_learner": 3, "gamma": 1, "lr": 0.0002847858517, "grad_clip": 0.5, "grad_clip_by": "global_norm", "_train_batch_size_per_learner": 5000, "train_batch_size": 4000, "num_epochs": 1, "minibatch_size": 1000, "shuffle_batch_per_epoch": true, "model": {"fcnet_hiddens": [256, 256], "fcnet_activation": "tanh", "fcnet_weights_initializer": null, "fcnet_weights_initializer_config": null, "fcnet_bias_initializer": null, "fcnet_bias_initializer_config": null, "conv_filters": null, "conv_activation": "relu", "conv_kernel_initializer": null, "conv_kernel_initializer_config": null, "conv_bias_initializer": null, "conv_bias_initializer_config": null, "conv_transpose_kernel_initializer": null, "conv_transpose_kernel_initializer_config": null, "conv_transpose_bias_initializer": null, "conv_transpose_bias_initializer_config": null, "post_fcnet_hiddens": [], "post_fcnet_activation": "relu", "post_fcnet_weights_initializer": null, "post_fcnet_weights_initializer_config": null, "post_fcnet_bias_initializer": null, "post_fcnet_bias_initializer_config": null, "free_log_std": false, "log_std_clip_param": 20.0, "no_final_linear": false, "vf_share_layers": false, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "lstm_weights_initializer": null, "lstm_weights_initializer_config": null, "lstm_bias_initializer": null, "lstm_bias_initializer_config": null, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "attention_use_n_prev_actions": 0, "attention_use_n_prev_rewards": 0, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": null, "custom_model_config": {}, "custom_action_dist": null, "custom_preprocessor": null, "encoder_latent_dim": null, "always_check_shapes": false, "lstm_use_prev_action_reward": -1, "_use_default_native_models": -1, "_disable_preprocessor_api": false, "_disable_action_flattening": false}, "_learner_connector": null, "add_default_connectors_to_learner_pipeline": true, "learner_config_dict": {}, "optimizer": {}, "_learner_class": null, "callbacks_on_algorithm_init": null, "callbacks_on_env_runners_recreated": null, "callbacks_on_offline_eval_runners_recreated": null, "callbacks_on_checkpoint_loaded": null, "callbacks_on_environment_created": null, "callbacks_on_episode_created": null, "callbacks_on_episode_start": null, "callbacks_on_episode_step": null, "callbacks_on_episode_end": null, "callbacks_on_evaluate_start": null, "callbacks_on_evaluate_end": null, "callbacks_on_evaluate_offline_start": null, "callbacks_on_evaluate_offline_end": null, "callbacks_on_sample_end": null, "callbacks_on_train_result": null, "explore": true, "enable_rl_module_and_learner": true, "enable_env_runner_and_connector_v2": true, "_prior_exploration_config": {"type": "StochasticSampling"}, "count_steps_by": "env_steps", "policy_map_capacity": 100, "policy_mapping_fn": "<function AlgorithmConfig.DEFAULT_POLICY_MAPPING_FN at 0x385441b20>", "policies_to_train": null, "policy_states_are_swappable": false, "observation_fn": null, "offline_data_class": null, "input_read_method": "read_parquet", "input_read_method_kwargs": {}, "input_read_schema": {}, "input_read_episodes": false, "input_read_sample_batches": false, "input_read_batch_size": null, "input_filesystem": null, "input_filesystem_kwargs": {}, "input_compress_columns": ["obs", "new_obs"], "input_spaces_jsonable": true, "materialize_data": false, "materialize_mapped_data": true, "map_batches_kwargs": {}, "iter_batches_kwargs": {}, "ignore_final_observation": false, "prelearner_class": null, "prelearner_buffer_class": null, "prelearner_buffer_kwargs": {}, "prelearner_module_synch_period": 10, "dataset_num_iters_per_learner": null, "input_config": {}, "actions_in_input_normalized": false, "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_config": {}, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "output_max_rows_per_file": null, "output_write_remaining_data": false, "output_write_method": "write_parquet", "output_write_method_kwargs": {}, "output_filesystem": null, "output_filesystem_kwargs": {}, "output_write_episodes": true, "offline_sampling": false, "evaluation_interval": 1, "evaluation_duration": 20, "evaluation_duration_unit": "episodes", "evaluation_sample_timeout_s": 120.0, "evaluation_auto_duration_min_env_steps_per_sample": 100, "evaluation_auto_duration_max_env_steps_per_sample": 2000, "evaluation_parallel_to_training": false, "evaluation_force_reset_envs_before_iteration": true, "evaluation_config": null, "off_policy_estimation_methods": {}, "ope_split_batch_by_episode": true, "evaluation_num_env_runners": 1, "in_evaluation": false, "sync_filters_on_rollout_workers_timeout_s": 10.0, "offline_evaluation_interval": null, "num_offline_eval_runners": 0, "offline_loss_for_module_fn": null, "offline_evaluation_duration": 1, "offline_evaluation_parallel_to_training": false, "offline_evaluation_timeout_s": 120.0, "num_cpus_per_offline_eval_runner": 1, "num_gpus_per_offline_eval_runner": 0, "custom_resources_per_offline_eval_runner": {}, "restart_failed_offline_eval_runners": true, "ignore_offline_eval_runner_failures": false, "max_num_offline_eval_runner_restarts": 1000, "offline_eval_runner_restore_timeout_s": 1800.0, "max_requests_in_flight_per_offline_eval_runner": 1, "validate_offline_eval_runners_after_construction": true, "offline_eval_runner_health_probe_timeout_s": 30.0, "offline_eval_rl_module_inference_only": false, "broadcast_offline_eval_runner_states": false, "offline_eval_batch_size_per_runner": 256, "dataset_num_iters_per_eval_runner": 1, "keep_per_episode_custom_metrics": false, "metrics_episode_collection_timeout_s": 60.0, "metrics_num_episodes_for_smoothing": 100, "min_time_s_per_iteration": null, "min_train_timesteps_per_iteration": 0, "min_sample_timesteps_per_iteration": 0, "log_gradients": true, "export_native_model_files": false, "checkpoint_trainable_policies_only": false, "logger_creator": null, "logger_config": null, "log_level": "WARN", "log_sys_usage": true, "fake_sampler": false, "seed": 6, "restart_failed_env_runners": true, "ignore_env_runner_failures": false, "max_num_env_runner_restarts": 1000, "delay_between_env_runner_restarts_s": 60.0, "restart_failed_sub_environments": false, "num_consecutive_env_runner_failures_tolerance": 100, "env_runner_health_probe_timeout_s": 30.0, "env_runner_restore_timeout_s": 1800.0, "_model_config": {}, "_rl_module_spec": "RLModuleSpec(module_class=None, observation_space=None, action_space=None, inference_only=False, learner_only=False, model_config=DefaultModelConfig(fcnet_hiddens=[60, 90], fcnet_activation='tanh', fcnet_kernel_initializer=None, fcnet_kernel_initializer_kwargs=None, fcnet_bias_initializer=None, fcnet_bias_initializer_kwargs=None, conv_filters=None, conv_activation='relu', conv_kernel_initializer=None, conv_kernel_initializer_kwargs=None, conv_bias_initializer=None, conv_bias_initializer_kwargs=None, head_fcnet_hiddens=[], head_fcnet_activation='relu', head_fcnet_kernel_initializer=None, head_fcnet_kernel_initializer_kwargs=None, head_fcnet_bias_initializer=None, head_fcnet_bias_initializer_kwargs=None, free_log_std=False, log_std_clip_param=20.0, vf_share_layers=True, use_lstm=False, max_seq_len=20, lstm_cell_size=256, lstm_use_prev_action=False, lstm_use_prev_reward=False, lstm_kernel_initializer=None, lstm_kernel_initializer_kwargs=None, lstm_bias_initializer=None, lstm_bias_initializer_kwargs=None), catalog_class=None, load_state_path=None, model_config_dict=None)", "algorithm_config_overrides_per_module": {}, "_per_module_overrides": {}, "_validate_config": true, "_use_msgpack_checkpoints": false, "_torch_grad_scaler_class": null, "_torch_lr_scheduler_classes": null, "_tf_policy_handles_more_than_one_loss": false, "_disable_preprocessor_api": false, "_disable_action_flattening": false, "_disable_initialize_loss_from_dummy_batch": false, "_dont_auto_sync_env_runner_states": false, "env_task_fn": -1, "enable_connectors": -1, "simple_optimizer": false, "policy_map_cache": -1, "worker_cls": -1, "synchronize_filters": -1, "enable_async_evaluation": -1, "custom_async_evaluation_function": -1, "_enable_rl_module_api": -1, "auto_wrap_old_gym_envs": -1, "always_attach_evaluation_results": -1, "replay_sequence_length": null, "_disable_execution_plan_api": -1, "use_critic": true, "use_gae": true, "use_kl_loss": true, "kl_coeff": 0.7464963036515, "kl_target": 0.0270990929592, "vf_loss_coeff": 0.6688075857018, "entropy_coeff": 0.0090570820258, "clip_param": 0.1221781641624, "vf_clip_param": 0.1027808522125, "entropy_coeff_schedule": null, "lr_schedule": null, "sgd_minibatch_size": -1, "vf_share_layers": -1, "__stdout_file__": null, "__stderr_file__": null, "lambda": 0.9099046732075, "input": "sampler", "policies": {"default_policy": [null, null, null, null]}, "callbacks": "<class 'ray.rllib.callbacks.callbacks.RLlibCallback'>", "create_env_on_driver": false, "custom_eval_function": null, "framework": "torch"}, "time_since_restore": 22.57390022277832, "iterations_since_restore": 13, "perf": {"cpu_util_percent": 44.5, "ram_util_percent": 82.86666666666666}}
{"timers": {"training_iteration": 1.7202779761803817, "restore_env_runners": 1.7134353952670612e-05, "training_step": 1.7201303400445258, "env_runner_sampling_timer": 1.5916207389759207, "learner_update_timer": 0.12496699084920222, "synch_weights": 0.000835469572081348, "restore_eval_env_runners": 8.786194013898351e-06, "evaluation_iteration": 0.12951818039342783, "synch_eval_env_connectors": 0.00014419661053227992, "synch_env_connectors": 5.026102750428343e-06}, "env_runners": {"num_episodes": 250.0, "num_agent_steps_sampled": {"default_agent": 5000.0}, "weights_seq_no": 13.0, "num_agent_steps_sampled_lifetime": {"default_agent": -7400000.0}, "num_episodes_lifetime": -370000.0, "env_to_module_connector": {"timers": {"connectors": {"add_states_from_episodes_to_batch": 1.8014750595952504e-06, "add_time_dim_to_batch_and_zero_pad": 2.5341686228051443e-06, "numpy_to_tensor": 9.545491790822993e-06, "batch_individual_items": 6.635861108848885e-06, "add_observations_from_episodes_to_batch": 3.1423690033950245e-06}}, "connector_pipeline_timer": 4.675889149003426e-05}, "sample": 0.005243007377101573, "num_module_steps_sampled": {"default_policy": 5000.0}, "rlmodule_inference_timer": 3.138558299674732e-05, "episode_return_max": 10.5, "agent_episode_returns_mean": {"default_agent": 7.54}, "episode_len_mean": 20.0, "time_between_sampling": 0.0017979985705670514, "env_step_timer": 1.4911357368986251e-05, "env_to_module_sum_episodes_length_out": 10.36823839457432, "env_reset_timer": 4.033241552786693e-05, "module_to_env_connector": {"timers": {"connectors": {"listify_data_for_vector_env": 1.1889528582365822e-05, "normalize_and_clip_actions": 1.0054334110571304e-05, "get_actions": 4.494770076605023e-05, "un_batch_to_individual_items": 5.771999427542704e-06, "tensor_to_numpy": 1.4406044490146783e-05, "remove_single_ts_time_rank_from_batch": 6.384493689886296e-07}}, "connector_pipeline_timer": 0.00011470674107993588}, "episode_duration_sec_mean": 0.0049810798354446885, "num_module_steps_sampled_lifetime": {"default_policy": -7400000.0}, "episode_len_min": 20, "episode_return_mean": 7.54, "episode_return_min": -9.5, "module_episode_returns_mean": {"default_policy": 7.54}, "episode_len_max": 20, "num_env_steps_sampled": 5000.0, "env_to_module_sum_episodes_length_in": 10.36823839457432, "num_env_steps_sampled_lifetime": -7400000.0, "num_env_steps_sampled_lifetime_throughput": 3478.3134753434074}, "learners": {"__all_modules__": {"num_env_steps_trained_lifetime": 441000, "learner_connector": {"timers": {"connectors": {"add_observations_from_episodes_to_batch": 0.0008360746236328577, "add_time_dim_to_batch_and_zero_pad": 1.99342295484184e-05, "add_columns_from_episodes_to_train_batch": 0.03749771325192803, "add_one_ts_to_episodes_and_truncate": 0.00956219362407911, "add_states_from_episodes_to_batch": 3.879888053721465e-06, "numpy_to_tensor": 9.90036447170399e-05, "batch_individual_items": 0.03908685382761662, "general_advantage_estimation": 0.008103706650087373}}, "connector_pipeline_timer": 0.09538344287556953}, "learner_connector_sum_episodes_length_in": 5000.0, "num_env_steps_trained": 31500, "num_module_steps_trained": 6000, "num_non_trainable_parameters": 0, "num_module_steps_trained_lifetime": 84000, "num_trainable_parameters": 6003, "learner_connector_sum_episodes_length_out": 5250.0, "num_env_steps_trained_lifetime_throughput": 1974856.5103518255, "num_module_steps_trained_throughput": 377217.2889079498, "num_module_steps_trained_lifetime_throughput": 376783.96240992495}, "default_policy": {"gradients_default_optimizer_global_norm": 0.08184441179037094, "weights_seq_no": 14.0, "num_module_steps_trained_lifetime": 84000, "num_trainable_parameters": 6003, "diff_num_grad_updates_vs_sampler_policy": 1.0, "policy_loss": 0.05362187325954437, "default_optimizer_learning_rate": 0.0002847858517, "vf_explained_var": -0.015738248825073242, "vf_loss": 0.10278083384037018, "vf_loss_unclipped": 29.760150909423828, "curr_entropy_coeff": 0.0090570820258, "module_train_batch_size_mean": 1000.0, "num_module_steps_trained": 6000, "total_loss": 0.11680866777896881, "mean_kl_loss": 0.0007894618902355433, "entropy": 0.6132097840309143, "curr_kl_coeff": 4.5562519517261535e-05, "num_module_steps_trained_lifetime_throughput": 377439.97920957295}}, "num_training_step_calls_per_iteration": 1, "evaluation": {"env_runners": {"env_to_module_connector": {"timers": {"connectors": {"add_observations_from_episodes_to_batch": 2.753621776997328e-06, "add_time_dim_to_batch_and_zero_pad": 2.261362082932815e-06, "add_states_from_episodes_to_batch": 1.5962156994449396e-06, "numpy_to_tensor": 8.147514332393343e-06, "batch_individual_items": 6.112709659462113e-06}}, "connector_pipeline_timer": 4.207641287712089e-05}, "episode_return_mean": 1.25, "num_module_steps_sampled": {"default_policy": 400}, "num_episodes_lifetime": 280, "module_to_env_connector": {"timers": {"connectors": {"un_batch_to_individual_items": 5.304517164248677e-06, "tensor_to_numpy": 1.2627783631791121e-05, "listify_data_for_vector_env": 1.079793854714175e-05, "remove_single_ts_time_rank_from_batch": 5.684172618773471e-07, "get_actions": 3.416187422856069e-05, "normalize_and_clip_actions": 9.409599495807637e-06}}, "connector_pipeline_timer": 9.798429130072798e-05}, "rlmodule_inference_timer": 2.6194472197829015e-05, "module_episode_returns_mean": {"default_policy": 1.25}, "env_to_module_sum_episodes_length_out": 10.368238394574323, "num_episodes": 20, "episode_return_max": 14.5, "env_reset_timer": 0.00043132174206302623, "episode_len_min": 20, "episode_return_min": -13.5, "episode_len_max": 20, "env_to_module_sum_episodes_length_in": 10.368238394574323, "num_env_steps_sampled_lifetime": 70400, "agent_episode_returns_mean": {"default_agent": 1.25}, "num_module_steps_sampled_lifetime": {"default_policy": 5600}, "sample": 0.11419459992985034, "episode_duration_sec_mean": 0.004500704983947799, "num_agent_steps_sampled": {"default_agent": 400}, "num_env_steps_sampled": 400, "weights_seq_no": 14.0, "episode_len_mean": 20.0, "env_step_timer": 1.377425400132991e-05, "num_agent_steps_sampled_lifetime": {"default_agent": 5600}, "time_between_sampling": 1.6477806669656032}, "num_healthy_workers": 1, "actor_manager_num_outstanding_async_reqs": 0, "num_remote_worker_restarts": 0}, "num_env_steps_sampled_lifetime": -7400000.0, "fault_tolerance": {"num_healthy_workers": 0, "num_remote_worker_restarts": 0}, "env_runner_group": {"actor_manager_num_outstanding_async_reqs": 0}, "done": false, "training_iteration": 14, "trial_id": "4dc31_00000", "date": "2025-08-11_19-19-46", "timestamp": 1754932786, "time_this_iter_s": 1.8124001026153564, "time_total_s": 24.386300325393677, "pid": 14098, "hostname": "Mac", "node_ip": "127.0.0.1", "config": {"exploration_config": {}, "extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "placement_strategy": "PACK", "num_gpus": 0, "_fake_gpus": false, "num_cpus_for_main_process": 2, "eager_tracing": true, "eager_max_retraces": 20, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "torch_compile_learner": false, "torch_compile_learner_what_to_compile": "forward_train", "torch_compile_learner_dynamo_backend": "aot_eager", "torch_compile_learner_dynamo_mode": null, "torch_compile_worker": false, "torch_compile_worker_dynamo_backend": "aot_eager", "torch_compile_worker_dynamo_mode": null, "torch_ddp_kwargs": {}, "torch_skip_nan_gradients": false, "env": "Umbrella", "env_config": {}, "observation_space": null, "action_space": null, "clip_rewards": null, "normalize_actions": true, "clip_actions": false, "_is_atari": null, "disable_env_checking": false, "render_env": false, "action_mask_key": "action_mask", "env_runner_cls": null, "num_env_runners": 0, "create_local_env_runner": true, "num_envs_per_env_runner": 1, "gym_env_vectorize_mode": "SYNC", "num_cpus_per_env_runner": 1, "num_gpus_per_env_runner": 0, "custom_resources_per_env_runner": {}, "validate_env_runners_after_construction": true, "episodes_to_numpy": true, "max_requests_in_flight_per_env_runner": 1, "sample_timeout_s": 60.0, "_env_to_module_connector": null, "add_default_connectors_to_env_to_module_pipeline": true, "_module_to_env_connector": null, "add_default_connectors_to_module_to_env_pipeline": true, "merge_env_runner_states": "training_only", "broadcast_env_runner_states": true, "episode_lookback_horizon": 1, "rollout_fragment_length": "auto", "batch_mode": "complete_episodes", "compress_observations": false, "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "enable_tf1_exec_eagerly": false, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "preprocessor_pref": "deepmind", "observation_filter": "NoFilter", "update_worker_filter_stats": true, "use_worker_filter_stats": true, "sampler_perf_stats_ema_coef": null, "_is_online": true, "num_learners": 0, "num_gpus_per_learner": 0, "num_cpus_per_learner": "auto", "num_aggregator_actors_per_learner": 0, "max_requests_in_flight_per_aggregator_actor": 3, "local_gpu_idx": 0, "max_requests_in_flight_per_learner": 3, "gamma": 1, "lr": 0.0002847858517, "grad_clip": 0.5, "grad_clip_by": "global_norm", "_train_batch_size_per_learner": 5000, "train_batch_size": 4000, "num_epochs": 1, "minibatch_size": 1000, "shuffle_batch_per_epoch": true, "model": {"fcnet_hiddens": [256, 256], "fcnet_activation": "tanh", "fcnet_weights_initializer": null, "fcnet_weights_initializer_config": null, "fcnet_bias_initializer": null, "fcnet_bias_initializer_config": null, "conv_filters": null, "conv_activation": "relu", "conv_kernel_initializer": null, "conv_kernel_initializer_config": null, "conv_bias_initializer": null, "conv_bias_initializer_config": null, "conv_transpose_kernel_initializer": null, "conv_transpose_kernel_initializer_config": null, "conv_transpose_bias_initializer": null, "conv_transpose_bias_initializer_config": null, "post_fcnet_hiddens": [], "post_fcnet_activation": "relu", "post_fcnet_weights_initializer": null, "post_fcnet_weights_initializer_config": null, "post_fcnet_bias_initializer": null, "post_fcnet_bias_initializer_config": null, "free_log_std": false, "log_std_clip_param": 20.0, "no_final_linear": false, "vf_share_layers": false, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "lstm_weights_initializer": null, "lstm_weights_initializer_config": null, "lstm_bias_initializer": null, "lstm_bias_initializer_config": null, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "attention_use_n_prev_actions": 0, "attention_use_n_prev_rewards": 0, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": null, "custom_model_config": {}, "custom_action_dist": null, "custom_preprocessor": null, "encoder_latent_dim": null, "always_check_shapes": false, "lstm_use_prev_action_reward": -1, "_use_default_native_models": -1, "_disable_preprocessor_api": false, "_disable_action_flattening": false}, "_learner_connector": null, "add_default_connectors_to_learner_pipeline": true, "learner_config_dict": {}, "optimizer": {}, "_learner_class": null, "callbacks_on_algorithm_init": null, "callbacks_on_env_runners_recreated": null, "callbacks_on_offline_eval_runners_recreated": null, "callbacks_on_checkpoint_loaded": null, "callbacks_on_environment_created": null, "callbacks_on_episode_created": null, "callbacks_on_episode_start": null, "callbacks_on_episode_step": null, "callbacks_on_episode_end": null, "callbacks_on_evaluate_start": null, "callbacks_on_evaluate_end": null, "callbacks_on_evaluate_offline_start": null, "callbacks_on_evaluate_offline_end": null, "callbacks_on_sample_end": null, "callbacks_on_train_result": null, "explore": true, "enable_rl_module_and_learner": true, "enable_env_runner_and_connector_v2": true, "_prior_exploration_config": {"type": "StochasticSampling"}, "count_steps_by": "env_steps", "policy_map_capacity": 100, "policy_mapping_fn": "<function AlgorithmConfig.DEFAULT_POLICY_MAPPING_FN at 0x385441b20>", "policies_to_train": null, "policy_states_are_swappable": false, "observation_fn": null, "offline_data_class": null, "input_read_method": "read_parquet", "input_read_method_kwargs": {}, "input_read_schema": {}, "input_read_episodes": false, "input_read_sample_batches": false, "input_read_batch_size": null, "input_filesystem": null, "input_filesystem_kwargs": {}, "input_compress_columns": ["obs", "new_obs"], "input_spaces_jsonable": true, "materialize_data": false, "materialize_mapped_data": true, "map_batches_kwargs": {}, "iter_batches_kwargs": {}, "ignore_final_observation": false, "prelearner_class": null, "prelearner_buffer_class": null, "prelearner_buffer_kwargs": {}, "prelearner_module_synch_period": 10, "dataset_num_iters_per_learner": null, "input_config": {}, "actions_in_input_normalized": false, "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_config": {}, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "output_max_rows_per_file": null, "output_write_remaining_data": false, "output_write_method": "write_parquet", "output_write_method_kwargs": {}, "output_filesystem": null, "output_filesystem_kwargs": {}, "output_write_episodes": true, "offline_sampling": false, "evaluation_interval": 1, "evaluation_duration": 20, "evaluation_duration_unit": "episodes", "evaluation_sample_timeout_s": 120.0, "evaluation_auto_duration_min_env_steps_per_sample": 100, "evaluation_auto_duration_max_env_steps_per_sample": 2000, "evaluation_parallel_to_training": false, "evaluation_force_reset_envs_before_iteration": true, "evaluation_config": null, "off_policy_estimation_methods": {}, "ope_split_batch_by_episode": true, "evaluation_num_env_runners": 1, "in_evaluation": false, "sync_filters_on_rollout_workers_timeout_s": 10.0, "offline_evaluation_interval": null, "num_offline_eval_runners": 0, "offline_loss_for_module_fn": null, "offline_evaluation_duration": 1, "offline_evaluation_parallel_to_training": false, "offline_evaluation_timeout_s": 120.0, "num_cpus_per_offline_eval_runner": 1, "num_gpus_per_offline_eval_runner": 0, "custom_resources_per_offline_eval_runner": {}, "restart_failed_offline_eval_runners": true, "ignore_offline_eval_runner_failures": false, "max_num_offline_eval_runner_restarts": 1000, "offline_eval_runner_restore_timeout_s": 1800.0, "max_requests_in_flight_per_offline_eval_runner": 1, "validate_offline_eval_runners_after_construction": true, "offline_eval_runner_health_probe_timeout_s": 30.0, "offline_eval_rl_module_inference_only": false, "broadcast_offline_eval_runner_states": false, "offline_eval_batch_size_per_runner": 256, "dataset_num_iters_per_eval_runner": 1, "keep_per_episode_custom_metrics": false, "metrics_episode_collection_timeout_s": 60.0, "metrics_num_episodes_for_smoothing": 100, "min_time_s_per_iteration": null, "min_train_timesteps_per_iteration": 0, "min_sample_timesteps_per_iteration": 0, "log_gradients": true, "export_native_model_files": false, "checkpoint_trainable_policies_only": false, "logger_creator": null, "logger_config": null, "log_level": "WARN", "log_sys_usage": true, "fake_sampler": false, "seed": 6, "restart_failed_env_runners": true, "ignore_env_runner_failures": false, "max_num_env_runner_restarts": 1000, "delay_between_env_runner_restarts_s": 60.0, "restart_failed_sub_environments": false, "num_consecutive_env_runner_failures_tolerance": 100, "env_runner_health_probe_timeout_s": 30.0, "env_runner_restore_timeout_s": 1800.0, "_model_config": {}, "_rl_module_spec": "RLModuleSpec(module_class=None, observation_space=None, action_space=None, inference_only=False, learner_only=False, model_config=DefaultModelConfig(fcnet_hiddens=[60, 90], fcnet_activation='tanh', fcnet_kernel_initializer=None, fcnet_kernel_initializer_kwargs=None, fcnet_bias_initializer=None, fcnet_bias_initializer_kwargs=None, conv_filters=None, conv_activation='relu', conv_kernel_initializer=None, conv_kernel_initializer_kwargs=None, conv_bias_initializer=None, conv_bias_initializer_kwargs=None, head_fcnet_hiddens=[], head_fcnet_activation='relu', head_fcnet_kernel_initializer=None, head_fcnet_kernel_initializer_kwargs=None, head_fcnet_bias_initializer=None, head_fcnet_bias_initializer_kwargs=None, free_log_std=False, log_std_clip_param=20.0, vf_share_layers=True, use_lstm=False, max_seq_len=20, lstm_cell_size=256, lstm_use_prev_action=False, lstm_use_prev_reward=False, lstm_kernel_initializer=None, lstm_kernel_initializer_kwargs=None, lstm_bias_initializer=None, lstm_bias_initializer_kwargs=None), catalog_class=None, load_state_path=None, model_config_dict=None)", "algorithm_config_overrides_per_module": {}, "_per_module_overrides": {}, "_validate_config": true, "_use_msgpack_checkpoints": false, "_torch_grad_scaler_class": null, "_torch_lr_scheduler_classes": null, "_tf_policy_handles_more_than_one_loss": false, "_disable_preprocessor_api": false, "_disable_action_flattening": false, "_disable_initialize_loss_from_dummy_batch": false, "_dont_auto_sync_env_runner_states": false, "env_task_fn": -1, "enable_connectors": -1, "simple_optimizer": false, "policy_map_cache": -1, "worker_cls": -1, "synchronize_filters": -1, "enable_async_evaluation": -1, "custom_async_evaluation_function": -1, "_enable_rl_module_api": -1, "auto_wrap_old_gym_envs": -1, "always_attach_evaluation_results": -1, "replay_sequence_length": null, "_disable_execution_plan_api": -1, "use_critic": true, "use_gae": true, "use_kl_loss": true, "kl_coeff": 0.7464963036515, "kl_target": 0.0270990929592, "vf_loss_coeff": 0.6688075857018, "entropy_coeff": 0.0090570820258, "clip_param": 0.1221781641624, "vf_clip_param": 0.1027808522125, "entropy_coeff_schedule": null, "lr_schedule": null, "sgd_minibatch_size": -1, "vf_share_layers": -1, "__stdout_file__": null, "__stderr_file__": null, "lambda": 0.9099046732075, "input": "sampler", "policies": {"default_policy": [null, null, null, null]}, "callbacks": "<class 'ray.rllib.callbacks.callbacks.RLlibCallback'>", "create_env_on_driver": false, "custom_eval_function": null, "framework": "torch"}, "time_since_restore": 24.386300325393677, "iterations_since_restore": 14, "perf": {"cpu_util_percent": 53.05, "ram_util_percent": 83.35}}
{"timers": {"training_iteration": 1.719301278088607, "restore_env_runners": 1.702551030697313e-05, "training_step": 1.7191533224738929, "env_runner_sampling_timer": 1.5899545815858438, "learner_update_timer": 0.12566061344092858, "synch_weights": 0.0008324752862107893, "restore_eval_env_runners": 8.755831929516128e-06, "evaluation_iteration": 0.1292932185896041, "synch_eval_env_connectors": 0.00014384672375533018, "synch_env_connectors": 5.015002673033422e-06}, "env_runners": {"num_episodes": 250.0, "num_agent_steps_sampled": {"default_agent": 5000.0}, "weights_seq_no": 14.0, "num_agent_steps_sampled_lifetime": {"default_agent": -8017500.0}, "num_episodes_lifetime": -400875.0, "env_to_module_connector": {"timers": {"connectors": {"add_states_from_episodes_to_batch": 1.7585869758763423e-06, "add_time_dim_to_batch_and_zero_pad": 2.3688564541181e-06, "numpy_to_tensor": 8.829645956119712e-06, "batch_individual_items": 6.358118324598122e-06, "add_observations_from_episodes_to_batch": 3.113413006819674e-06}}, "connector_pipeline_timer": 4.472116446943176e-05}, "sample": 0.005112637440558458, "num_module_steps_sampled": {"default_policy": 5000.0}, "rlmodule_inference_timer": 2.8475825237551106e-05, "episode_return_max": 10.5, "agent_episode_returns_mean": {"default_agent": 7.46}, "episode_len_mean": 20.0, "time_between_sampling": 0.0019566283891765224, "env_step_timer": 1.4106040491894934e-05, "env_to_module_sum_episodes_length_out": 10.36823839457432, "env_reset_timer": 3.939603958729046e-05, "module_to_env_connector": {"timers": {"connectors": {"listify_data_for_vector_env": 1.1226802167741198e-05, "normalize_and_clip_actions": 9.594186390640386e-06, "get_actions": 4.1046961173545215e-05, "un_batch_to_individual_items": 5.511956928223116e-06, "tensor_to_numpy": 1.3538295146110254e-05, "remove_single_ts_time_rank_from_batch": 5.969074835951928e-07}}, "connector_pipeline_timer": 0.00010741617982095503}, "episode_duration_sec_mean": 0.004682400689460339, "num_module_steps_sampled_lifetime": {"default_policy": -8017500.0}, "episode_len_min": 20, "episode_return_mean": 7.46, "episode_return_min": -9.5, "module_episode_returns_mean": {"default_policy": 7.46}, "episode_len_max": 20, "num_env_steps_sampled": 5000.0, "env_to_module_sum_episodes_length_in": 10.36823839457432, "num_env_steps_sampled_lifetime": -8017500.0, "num_env_steps_sampled_lifetime_throughput": 3608.566191859745}, "learners": {"__all_modules__": {"num_env_steps_trained_lifetime": 472500, "learner_connector": {"timers": {"connectors": {"add_observations_from_episodes_to_batch": 0.0008364326271376215, "add_time_dim_to_batch_and_zero_pad": 1.9831546894647116e-05, "add_columns_from_episodes_to_train_batch": 0.037466985290147956, "add_one_ts_to_episodes_and_truncate": 0.009542953767698514, "add_states_from_episodes_to_batch": 3.866508458705161e-06, "numpy_to_tensor": 9.871860898147446e-05, "batch_individual_items": 0.040017037369360756, "general_advantage_estimation": 0.008076763753341034}}, "connector_pipeline_timer": 0.09623589469658927}, "learner_connector_sum_episodes_length_in": 5000.0, "num_env_steps_trained": 31500, "num_module_steps_trained": 6000, "num_non_trainable_parameters": 0, "num_module_steps_trained_lifetime": 90000, "num_trainable_parameters": 6003, "learner_connector_sum_episodes_length_out": 5250.0, "num_env_steps_trained_lifetime_throughput": 1986744.0047058589, "num_module_steps_trained_throughput": 379440.96686658054, "num_module_steps_trained_lifetime_throughput": 379019.85163677967}, "default_policy": {"gradients_default_optimizer_global_norm": 0.04784759134054184, "weights_seq_no": 15.0, "num_module_steps_trained_lifetime": 90000, "num_trainable_parameters": 6003, "diff_num_grad_updates_vs_sampler_policy": 1.0, "policy_loss": -0.051738157868385315, "default_optimizer_learning_rate": 0.0002847858517, "vf_explained_var": -0.01546335220336914, "vf_loss": 0.10278083384037018, "vf_loss_unclipped": 29.84295654296875, "curr_entropy_coeff": 0.0090570820258, "module_train_batch_size_mean": 1000.0, "num_module_steps_trained": 6000, "total_loss": 0.01164228841662407, "mean_kl_loss": 0.0018565247301012278, "entropy": 0.5918295383453369, "curr_kl_coeff": 2.2781259758630767e-05, "num_module_steps_trained_lifetime_throughput": 379614.25437706866}}, "num_training_step_calls_per_iteration": 1, "evaluation": {"env_runners": {"env_to_module_connector": {"timers": {"connectors": {"add_observations_from_episodes_to_batch": 2.777019174802664e-06, "add_time_dim_to_batch_and_zero_pad": 2.251521674987498e-06, "add_states_from_episodes_to_batch": 1.884790246771429e-06, "numpy_to_tensor": 8.299869121761832e-06, "batch_individual_items": 6.200017242464892e-06}}, "connector_pipeline_timer": 4.315519863357605e-05}, "episode_return_mean": 1.05, "num_module_steps_sampled": {"default_policy": 400}, "num_episodes_lifetime": 300, "module_to_env_connector": {"timers": {"connectors": {"un_batch_to_individual_items": 5.363996814169434e-06, "tensor_to_numpy": 1.2825531032530906e-05, "listify_data_for_vector_env": 1.0919576097869459e-05, "remove_single_ts_time_rank_from_batch": 5.738347357845086e-07, "get_actions": 3.5899672407702736e-05, "normalize_and_clip_actions": 9.416671027002666e-06}}, "connector_pipeline_timer": 0.00010021027584234383}, "rlmodule_inference_timer": 2.7076960620222646e-05, "module_episode_returns_mean": {"default_policy": 1.05}, "env_to_module_sum_episodes_length_out": 10.368238394574323, "num_episodes": 20, "episode_return_max": 14.5, "env_reset_timer": 0.0004279676937619925, "episode_len_min": 20, "episode_return_min": -13.5, "episode_len_max": 20, "env_to_module_sum_episodes_length_in": 10.368238394574323, "num_env_steps_sampled_lifetime": 75400, "agent_episode_returns_mean": {"default_agent": 1.05}, "num_module_steps_sampled_lifetime": {"default_policy": 6000}, "sample": 0.11401600851042336, "episode_duration_sec_mean": 0.004462140424875543, "num_agent_steps_sampled": {"default_agent": 400}, "num_env_steps_sampled": 400, "weights_seq_no": 15.0, "episode_len_mean": 20.0, "env_step_timer": 1.401636333522382e-05, "num_agent_steps_sampled_lifetime": {"default_agent": 6000}, "time_between_sampling": 1.6477639127958916}, "num_healthy_workers": 1, "actor_manager_num_outstanding_async_reqs": 0, "num_remote_worker_restarts": 0}, "num_env_steps_sampled_lifetime": -8017500.0, "fault_tolerance": {"num_healthy_workers": 0, "num_remote_worker_restarts": 0}, "env_runner_group": {"actor_manager_num_outstanding_async_reqs": 0}, "done": false, "training_iteration": 15, "trial_id": "4dc31_00000", "date": "2025-08-11_19-19-48", "timestamp": 1754932788, "time_this_iter_s": 1.7265911102294922, "time_total_s": 26.11289143562317, "pid": 14098, "hostname": "Mac", "node_ip": "127.0.0.1", "config": {"exploration_config": {}, "extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "placement_strategy": "PACK", "num_gpus": 0, "_fake_gpus": false, "num_cpus_for_main_process": 2, "eager_tracing": true, "eager_max_retraces": 20, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "torch_compile_learner": false, "torch_compile_learner_what_to_compile": "forward_train", "torch_compile_learner_dynamo_backend": "aot_eager", "torch_compile_learner_dynamo_mode": null, "torch_compile_worker": false, "torch_compile_worker_dynamo_backend": "aot_eager", "torch_compile_worker_dynamo_mode": null, "torch_ddp_kwargs": {}, "torch_skip_nan_gradients": false, "env": "Umbrella", "env_config": {}, "observation_space": null, "action_space": null, "clip_rewards": null, "normalize_actions": true, "clip_actions": false, "_is_atari": null, "disable_env_checking": false, "render_env": false, "action_mask_key": "action_mask", "env_runner_cls": null, "num_env_runners": 0, "create_local_env_runner": true, "num_envs_per_env_runner": 1, "gym_env_vectorize_mode": "SYNC", "num_cpus_per_env_runner": 1, "num_gpus_per_env_runner": 0, "custom_resources_per_env_runner": {}, "validate_env_runners_after_construction": true, "episodes_to_numpy": true, "max_requests_in_flight_per_env_runner": 1, "sample_timeout_s": 60.0, "_env_to_module_connector": null, "add_default_connectors_to_env_to_module_pipeline": true, "_module_to_env_connector": null, "add_default_connectors_to_module_to_env_pipeline": true, "merge_env_runner_states": "training_only", "broadcast_env_runner_states": true, "episode_lookback_horizon": 1, "rollout_fragment_length": "auto", "batch_mode": "complete_episodes", "compress_observations": false, "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "enable_tf1_exec_eagerly": false, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "preprocessor_pref": "deepmind", "observation_filter": "NoFilter", "update_worker_filter_stats": true, "use_worker_filter_stats": true, "sampler_perf_stats_ema_coef": null, "_is_online": true, "num_learners": 0, "num_gpus_per_learner": 0, "num_cpus_per_learner": "auto", "num_aggregator_actors_per_learner": 0, "max_requests_in_flight_per_aggregator_actor": 3, "local_gpu_idx": 0, "max_requests_in_flight_per_learner": 3, "gamma": 1, "lr": 0.0002847858517, "grad_clip": 0.5, "grad_clip_by": "global_norm", "_train_batch_size_per_learner": 5000, "train_batch_size": 4000, "num_epochs": 1, "minibatch_size": 1000, "shuffle_batch_per_epoch": true, "model": {"fcnet_hiddens": [256, 256], "fcnet_activation": "tanh", "fcnet_weights_initializer": null, "fcnet_weights_initializer_config": null, "fcnet_bias_initializer": null, "fcnet_bias_initializer_config": null, "conv_filters": null, "conv_activation": "relu", "conv_kernel_initializer": null, "conv_kernel_initializer_config": null, "conv_bias_initializer": null, "conv_bias_initializer_config": null, "conv_transpose_kernel_initializer": null, "conv_transpose_kernel_initializer_config": null, "conv_transpose_bias_initializer": null, "conv_transpose_bias_initializer_config": null, "post_fcnet_hiddens": [], "post_fcnet_activation": "relu", "post_fcnet_weights_initializer": null, "post_fcnet_weights_initializer_config": null, "post_fcnet_bias_initializer": null, "post_fcnet_bias_initializer_config": null, "free_log_std": false, "log_std_clip_param": 20.0, "no_final_linear": false, "vf_share_layers": false, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "lstm_weights_initializer": null, "lstm_weights_initializer_config": null, "lstm_bias_initializer": null, "lstm_bias_initializer_config": null, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "attention_use_n_prev_actions": 0, "attention_use_n_prev_rewards": 0, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": null, "custom_model_config": {}, "custom_action_dist": null, "custom_preprocessor": null, "encoder_latent_dim": null, "always_check_shapes": false, "lstm_use_prev_action_reward": -1, "_use_default_native_models": -1, "_disable_preprocessor_api": false, "_disable_action_flattening": false}, "_learner_connector": null, "add_default_connectors_to_learner_pipeline": true, "learner_config_dict": {}, "optimizer": {}, "_learner_class": null, "callbacks_on_algorithm_init": null, "callbacks_on_env_runners_recreated": null, "callbacks_on_offline_eval_runners_recreated": null, "callbacks_on_checkpoint_loaded": null, "callbacks_on_environment_created": null, "callbacks_on_episode_created": null, "callbacks_on_episode_start": null, "callbacks_on_episode_step": null, "callbacks_on_episode_end": null, "callbacks_on_evaluate_start": null, "callbacks_on_evaluate_end": null, "callbacks_on_evaluate_offline_start": null, "callbacks_on_evaluate_offline_end": null, "callbacks_on_sample_end": null, "callbacks_on_train_result": null, "explore": true, "enable_rl_module_and_learner": true, "enable_env_runner_and_connector_v2": true, "_prior_exploration_config": {"type": "StochasticSampling"}, "count_steps_by": "env_steps", "policy_map_capacity": 100, "policy_mapping_fn": "<function AlgorithmConfig.DEFAULT_POLICY_MAPPING_FN at 0x385441b20>", "policies_to_train": null, "policy_states_are_swappable": false, "observation_fn": null, "offline_data_class": null, "input_read_method": "read_parquet", "input_read_method_kwargs": {}, "input_read_schema": {}, "input_read_episodes": false, "input_read_sample_batches": false, "input_read_batch_size": null, "input_filesystem": null, "input_filesystem_kwargs": {}, "input_compress_columns": ["obs", "new_obs"], "input_spaces_jsonable": true, "materialize_data": false, "materialize_mapped_data": true, "map_batches_kwargs": {}, "iter_batches_kwargs": {}, "ignore_final_observation": false, "prelearner_class": null, "prelearner_buffer_class": null, "prelearner_buffer_kwargs": {}, "prelearner_module_synch_period": 10, "dataset_num_iters_per_learner": null, "input_config": {}, "actions_in_input_normalized": false, "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_config": {}, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "output_max_rows_per_file": null, "output_write_remaining_data": false, "output_write_method": "write_parquet", "output_write_method_kwargs": {}, "output_filesystem": null, "output_filesystem_kwargs": {}, "output_write_episodes": true, "offline_sampling": false, "evaluation_interval": 1, "evaluation_duration": 20, "evaluation_duration_unit": "episodes", "evaluation_sample_timeout_s": 120.0, "evaluation_auto_duration_min_env_steps_per_sample": 100, "evaluation_auto_duration_max_env_steps_per_sample": 2000, "evaluation_parallel_to_training": false, "evaluation_force_reset_envs_before_iteration": true, "evaluation_config": null, "off_policy_estimation_methods": {}, "ope_split_batch_by_episode": true, "evaluation_num_env_runners": 1, "in_evaluation": false, "sync_filters_on_rollout_workers_timeout_s": 10.0, "offline_evaluation_interval": null, "num_offline_eval_runners": 0, "offline_loss_for_module_fn": null, "offline_evaluation_duration": 1, "offline_evaluation_parallel_to_training": false, "offline_evaluation_timeout_s": 120.0, "num_cpus_per_offline_eval_runner": 1, "num_gpus_per_offline_eval_runner": 0, "custom_resources_per_offline_eval_runner": {}, "restart_failed_offline_eval_runners": true, "ignore_offline_eval_runner_failures": false, "max_num_offline_eval_runner_restarts": 1000, "offline_eval_runner_restore_timeout_s": 1800.0, "max_requests_in_flight_per_offline_eval_runner": 1, "validate_offline_eval_runners_after_construction": true, "offline_eval_runner_health_probe_timeout_s": 30.0, "offline_eval_rl_module_inference_only": false, "broadcast_offline_eval_runner_states": false, "offline_eval_batch_size_per_runner": 256, "dataset_num_iters_per_eval_runner": 1, "keep_per_episode_custom_metrics": false, "metrics_episode_collection_timeout_s": 60.0, "metrics_num_episodes_for_smoothing": 100, "min_time_s_per_iteration": null, "min_train_timesteps_per_iteration": 0, "min_sample_timesteps_per_iteration": 0, "log_gradients": true, "export_native_model_files": false, "checkpoint_trainable_policies_only": false, "logger_creator": null, "logger_config": null, "log_level": "WARN", "log_sys_usage": true, "fake_sampler": false, "seed": 6, "restart_failed_env_runners": true, "ignore_env_runner_failures": false, "max_num_env_runner_restarts": 1000, "delay_between_env_runner_restarts_s": 60.0, "restart_failed_sub_environments": false, "num_consecutive_env_runner_failures_tolerance": 100, "env_runner_health_probe_timeout_s": 30.0, "env_runner_restore_timeout_s": 1800.0, "_model_config": {}, "_rl_module_spec": "RLModuleSpec(module_class=None, observation_space=None, action_space=None, inference_only=False, learner_only=False, model_config=DefaultModelConfig(fcnet_hiddens=[60, 90], fcnet_activation='tanh', fcnet_kernel_initializer=None, fcnet_kernel_initializer_kwargs=None, fcnet_bias_initializer=None, fcnet_bias_initializer_kwargs=None, conv_filters=None, conv_activation='relu', conv_kernel_initializer=None, conv_kernel_initializer_kwargs=None, conv_bias_initializer=None, conv_bias_initializer_kwargs=None, head_fcnet_hiddens=[], head_fcnet_activation='relu', head_fcnet_kernel_initializer=None, head_fcnet_kernel_initializer_kwargs=None, head_fcnet_bias_initializer=None, head_fcnet_bias_initializer_kwargs=None, free_log_std=False, log_std_clip_param=20.0, vf_share_layers=True, use_lstm=False, max_seq_len=20, lstm_cell_size=256, lstm_use_prev_action=False, lstm_use_prev_reward=False, lstm_kernel_initializer=None, lstm_kernel_initializer_kwargs=None, lstm_bias_initializer=None, lstm_bias_initializer_kwargs=None), catalog_class=None, load_state_path=None, model_config_dict=None)", "algorithm_config_overrides_per_module": {}, "_per_module_overrides": {}, "_validate_config": true, "_use_msgpack_checkpoints": false, "_torch_grad_scaler_class": null, "_torch_lr_scheduler_classes": null, "_tf_policy_handles_more_than_one_loss": false, "_disable_preprocessor_api": false, "_disable_action_flattening": false, "_disable_initialize_loss_from_dummy_batch": false, "_dont_auto_sync_env_runner_states": false, "env_task_fn": -1, "enable_connectors": -1, "simple_optimizer": false, "policy_map_cache": -1, "worker_cls": -1, "synchronize_filters": -1, "enable_async_evaluation": -1, "custom_async_evaluation_function": -1, "_enable_rl_module_api": -1, "auto_wrap_old_gym_envs": -1, "always_attach_evaluation_results": -1, "replay_sequence_length": null, "_disable_execution_plan_api": -1, "use_critic": true, "use_gae": true, "use_kl_loss": true, "kl_coeff": 0.7464963036515, "kl_target": 0.0270990929592, "vf_loss_coeff": 0.6688075857018, "entropy_coeff": 0.0090570820258, "clip_param": 0.1221781641624, "vf_clip_param": 0.1027808522125, "entropy_coeff_schedule": null, "lr_schedule": null, "sgd_minibatch_size": -1, "vf_share_layers": -1, "__stdout_file__": null, "__stderr_file__": null, "lambda": 0.9099046732075, "input": "sampler", "policies": {"default_policy": [null, null, null, null]}, "callbacks": "<class 'ray.rllib.callbacks.callbacks.RLlibCallback'>", "create_env_on_driver": false, "custom_eval_function": null, "framework": "torch"}, "time_since_restore": 26.11289143562317, "iterations_since_restore": 15, "perf": {"cpu_util_percent": 48.56666666666666, "ram_util_percent": 83.46666666666667}}
{"timers": {"training_iteration": 1.7227359003068303, "restore_env_runners": 1.6911504759103738e-05, "training_step": 1.7225870046594087, "env_runner_sampling_timer": 1.5933883253499395, "learner_update_timer": 0.12562591730683237, "synch_weights": 0.0008488476236149537, "restore_eval_env_runners": 8.737853883923707e-06, "evaluation_iteration": 0.1290161143237631, "synch_eval_env_connectors": 0.00014357742607226377, "synch_env_connectors": 5.007352387842447e-06}, "env_runners": {"num_episodes": 250.0, "num_agent_steps_sampled": {"default_agent": 5000.0}, "weights_seq_no": 15.0, "num_agent_steps_sampled_lifetime": {"default_agent": -8635000.0}, "num_episodes_lifetime": -431750.0, "env_to_module_connector": {"timers": {"connectors": {"add_states_from_episodes_to_batch": 2.1632363532766845e-06, "add_time_dim_to_batch_and_zero_pad": 3.069095029669091e-06, "numpy_to_tensor": 1.2208703797180624e-05, "batch_individual_items": 8.435262457483995e-06, "add_observations_from_episodes_to_batch": 3.9379845533626584e-06}}, "connector_pipeline_timer": 5.7207723483660516e-05}, "sample": 0.005924853663603491, "num_module_steps_sampled": {"default_policy": 5000.0}, "rlmodule_inference_timer": 4.096574379140816e-05, "episode_return_max": 10.5, "agent_episode_returns_mean": {"default_agent": 8.1}, "episode_len_mean": 20.0, "time_between_sampling": 0.0020472804800116106, "env_step_timer": 1.9387458283746634e-05, "env_to_module_sum_episodes_length_out": 10.36823839457432, "env_reset_timer": 5.23259700407448e-05, "module_to_env_connector": {"timers": {"connectors": {"listify_data_for_vector_env": 1.5085735178823888e-05, "normalize_and_clip_actions": 1.2271402401925973e-05, "get_actions": 5.877662650304938e-05, "un_batch_to_individual_items": 6.833577611211111e-06, "tensor_to_numpy": 1.7448702433746748e-05, "remove_single_ts_time_rank_from_batch": 8.096110618516307e-07}}, "connector_pipeline_timer": 0.00014413335686074845}, "episode_duration_sec_mean": 0.006302342366427186, "num_module_steps_sampled_lifetime": {"default_policy": -8635000.0}, "episode_len_min": 20, "episode_return_mean": 8.1, "episode_return_min": -9.5, "module_episode_returns_mean": {"default_policy": 8.1}, "episode_len_max": 20, "num_env_steps_sampled": 5000.0, "env_to_module_sum_episodes_length_in": 10.36823839457432, "num_env_steps_sampled_lifetime": -8635000.0, "num_env_steps_sampled_lifetime_throughput": 2999.51383814973}, "learners": {"__all_modules__": {"num_env_steps_trained_lifetime": 504000, "learner_connector": {"timers": {"connectors": {"add_observations_from_episodes_to_batch": 0.0008372220504271826, "add_time_dim_to_batch_and_zero_pad": 1.9986571718050104e-05, "add_columns_from_episodes_to_train_batch": 0.03749066127717717, "add_one_ts_to_episodes_and_truncate": 0.009547450900103442, "add_states_from_episodes_to_batch": 3.863253422558208e-06, "numpy_to_tensor": 9.845350289512989e-05, "batch_individual_items": 0.040013563245621546, "general_advantage_estimation": 0.008059271945696504}}, "connector_pipeline_timer": 0.09624336032986625}, "learner_connector_sum_episodes_length_in": 5000.0, "num_env_steps_trained": 31500, "num_module_steps_trained": 6000, "num_non_trainable_parameters": 0, "num_module_steps_trained_lifetime": 96000, "num_trainable_parameters": 6003, "learner_connector_sum_episodes_length_out": 5250.0, "num_env_steps_trained_lifetime_throughput": 1988515.5228008693, "num_module_steps_trained_throughput": 379737.8414703656, "num_module_steps_trained_lifetime_throughput": 379330.0238833139}, "default_policy": {"gradients_default_optimizer_global_norm": 0.027136243879795074, "weights_seq_no": 16.0, "num_module_steps_trained_lifetime": 96000, "num_trainable_parameters": 6003, "diff_num_grad_updates_vs_sampler_policy": 1.0, "policy_loss": -0.028655797243118286, "default_optimizer_learning_rate": 0.0002847858517, "vf_explained_var": -0.015216827392578125, "vf_loss": 0.10278083384037018, "vf_loss_unclipped": 29.875362396240234, "curr_entropy_coeff": 0.0090570820258, "module_train_batch_size_mean": 1000.0, "num_module_steps_trained": 6000, "total_loss": 0.03488733619451523, "mean_kl_loss": 0.000879815430380404, "entropy": 0.5738593339920044, "curr_kl_coeff": 1.1390629879315384e-05, "num_module_steps_trained_lifetime_throughput": 379872.30408173107}}, "num_training_step_calls_per_iteration": 1, "evaluation": {"env_runners": {"env_to_module_connector": {"timers": {"connectors": {"add_observations_from_episodes_to_batch": 4.7913152389222535e-06, "add_time_dim_to_batch_and_zero_pad": 5.257478571975432e-06, "add_states_from_episodes_to_batch": 2.2153246454368082e-06, "numpy_to_tensor": 1.5010400088315229e-05, "batch_individual_items": 1.0987335635979465e-05}}, "connector_pipeline_timer": 6.87231776574198e-05}, "episode_return_mean": -0.75, "num_module_steps_sampled": {"default_policy": 400}, "num_episodes_lifetime": 320, "module_to_env_connector": {"timers": {"connectors": {"un_batch_to_individual_items": 7.5544939560394e-06, "tensor_to_numpy": 2.247331175229842e-05, "listify_data_for_vector_env": 1.7739703850256447e-05, "remove_single_ts_time_rank_from_batch": 7.854363012404167e-07, "get_actions": 6.791580912149005e-05, "normalize_and_clip_actions": 1.4143466663334733e-05}}, "connector_pipeline_timer": 0.00016614125491946606}, "rlmodule_inference_timer": 4.6710086050794276e-05, "module_episode_returns_mean": {"default_policy": -0.75}, "env_to_module_sum_episodes_length_out": 10.368238394574323, "num_episodes": 20, "episode_return_max": 14.5, "env_reset_timer": 0.00042769593674870624, "episode_len_min": 20, "episode_return_min": -13.5, "episode_len_max": 20, "env_to_module_sum_episodes_length_in": 10.368238394574323, "num_env_steps_sampled_lifetime": 80400, "agent_episode_returns_mean": {"default_agent": -0.75}, "num_module_steps_sampled_lifetime": {"default_policy": 6400}, "sample": 0.11519823967595556, "episode_duration_sec_mean": 0.005682602900778874, "num_agent_steps_sampled": {"default_agent": 400}, "num_env_steps_sampled": 400, "weights_seq_no": 16.0, "episode_len_mean": 20.0, "env_step_timer": 2.3993937405035314e-05, "num_agent_steps_sampled_lifetime": {"default_agent": 6400}, "time_between_sampling": 1.6523046899173588}, "num_healthy_workers": 1, "actor_manager_num_outstanding_async_reqs": 0, "num_remote_worker_restarts": 0}, "num_env_steps_sampled_lifetime": -8635000.0, "fault_tolerance": {"num_healthy_workers": 0, "num_remote_worker_restarts": 0}, "env_runner_group": {"actor_manager_num_outstanding_async_reqs": 0}, "done": false, "training_iteration": 16, "trial_id": "4dc31_00000", "date": "2025-08-11_19-19-50", "timestamp": 1754932790, "time_this_iter_s": 2.3247230052948, "time_total_s": 28.43761444091797, "pid": 14098, "hostname": "Mac", "node_ip": "127.0.0.1", "config": {"exploration_config": {}, "extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "placement_strategy": "PACK", "num_gpus": 0, "_fake_gpus": false, "num_cpus_for_main_process": 2, "eager_tracing": true, "eager_max_retraces": 20, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "torch_compile_learner": false, "torch_compile_learner_what_to_compile": "forward_train", "torch_compile_learner_dynamo_backend": "aot_eager", "torch_compile_learner_dynamo_mode": null, "torch_compile_worker": false, "torch_compile_worker_dynamo_backend": "aot_eager", "torch_compile_worker_dynamo_mode": null, "torch_ddp_kwargs": {}, "torch_skip_nan_gradients": false, "env": "Umbrella", "env_config": {}, "observation_space": null, "action_space": null, "clip_rewards": null, "normalize_actions": true, "clip_actions": false, "_is_atari": null, "disable_env_checking": false, "render_env": false, "action_mask_key": "action_mask", "env_runner_cls": null, "num_env_runners": 0, "create_local_env_runner": true, "num_envs_per_env_runner": 1, "gym_env_vectorize_mode": "SYNC", "num_cpus_per_env_runner": 1, "num_gpus_per_env_runner": 0, "custom_resources_per_env_runner": {}, "validate_env_runners_after_construction": true, "episodes_to_numpy": true, "max_requests_in_flight_per_env_runner": 1, "sample_timeout_s": 60.0, "_env_to_module_connector": null, "add_default_connectors_to_env_to_module_pipeline": true, "_module_to_env_connector": null, "add_default_connectors_to_module_to_env_pipeline": true, "merge_env_runner_states": "training_only", "broadcast_env_runner_states": true, "episode_lookback_horizon": 1, "rollout_fragment_length": "auto", "batch_mode": "complete_episodes", "compress_observations": false, "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "enable_tf1_exec_eagerly": false, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "preprocessor_pref": "deepmind", "observation_filter": "NoFilter", "update_worker_filter_stats": true, "use_worker_filter_stats": true, "sampler_perf_stats_ema_coef": null, "_is_online": true, "num_learners": 0, "num_gpus_per_learner": 0, "num_cpus_per_learner": "auto", "num_aggregator_actors_per_learner": 0, "max_requests_in_flight_per_aggregator_actor": 3, "local_gpu_idx": 0, "max_requests_in_flight_per_learner": 3, "gamma": 1, "lr": 0.0002847858517, "grad_clip": 0.5, "grad_clip_by": "global_norm", "_train_batch_size_per_learner": 5000, "train_batch_size": 4000, "num_epochs": 1, "minibatch_size": 1000, "shuffle_batch_per_epoch": true, "model": {"fcnet_hiddens": [256, 256], "fcnet_activation": "tanh", "fcnet_weights_initializer": null, "fcnet_weights_initializer_config": null, "fcnet_bias_initializer": null, "fcnet_bias_initializer_config": null, "conv_filters": null, "conv_activation": "relu", "conv_kernel_initializer": null, "conv_kernel_initializer_config": null, "conv_bias_initializer": null, "conv_bias_initializer_config": null, "conv_transpose_kernel_initializer": null, "conv_transpose_kernel_initializer_config": null, "conv_transpose_bias_initializer": null, "conv_transpose_bias_initializer_config": null, "post_fcnet_hiddens": [], "post_fcnet_activation": "relu", "post_fcnet_weights_initializer": null, "post_fcnet_weights_initializer_config": null, "post_fcnet_bias_initializer": null, "post_fcnet_bias_initializer_config": null, "free_log_std": false, "log_std_clip_param": 20.0, "no_final_linear": false, "vf_share_layers": false, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "lstm_weights_initializer": null, "lstm_weights_initializer_config": null, "lstm_bias_initializer": null, "lstm_bias_initializer_config": null, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "attention_use_n_prev_actions": 0, "attention_use_n_prev_rewards": 0, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": null, "custom_model_config": {}, "custom_action_dist": null, "custom_preprocessor": null, "encoder_latent_dim": null, "always_check_shapes": false, "lstm_use_prev_action_reward": -1, "_use_default_native_models": -1, "_disable_preprocessor_api": false, "_disable_action_flattening": false}, "_learner_connector": null, "add_default_connectors_to_learner_pipeline": true, "learner_config_dict": {}, "optimizer": {}, "_learner_class": null, "callbacks_on_algorithm_init": null, "callbacks_on_env_runners_recreated": null, "callbacks_on_offline_eval_runners_recreated": null, "callbacks_on_checkpoint_loaded": null, "callbacks_on_environment_created": null, "callbacks_on_episode_created": null, "callbacks_on_episode_start": null, "callbacks_on_episode_step": null, "callbacks_on_episode_end": null, "callbacks_on_evaluate_start": null, "callbacks_on_evaluate_end": null, "callbacks_on_evaluate_offline_start": null, "callbacks_on_evaluate_offline_end": null, "callbacks_on_sample_end": null, "callbacks_on_train_result": null, "explore": true, "enable_rl_module_and_learner": true, "enable_env_runner_and_connector_v2": true, "_prior_exploration_config": {"type": "StochasticSampling"}, "count_steps_by": "env_steps", "policy_map_capacity": 100, "policy_mapping_fn": "<function AlgorithmConfig.DEFAULT_POLICY_MAPPING_FN at 0x385441b20>", "policies_to_train": null, "policy_states_are_swappable": false, "observation_fn": null, "offline_data_class": null, "input_read_method": "read_parquet", "input_read_method_kwargs": {}, "input_read_schema": {}, "input_read_episodes": false, "input_read_sample_batches": false, "input_read_batch_size": null, "input_filesystem": null, "input_filesystem_kwargs": {}, "input_compress_columns": ["obs", "new_obs"], "input_spaces_jsonable": true, "materialize_data": false, "materialize_mapped_data": true, "map_batches_kwargs": {}, "iter_batches_kwargs": {}, "ignore_final_observation": false, "prelearner_class": null, "prelearner_buffer_class": null, "prelearner_buffer_kwargs": {}, "prelearner_module_synch_period": 10, "dataset_num_iters_per_learner": null, "input_config": {}, "actions_in_input_normalized": false, "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_config": {}, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "output_max_rows_per_file": null, "output_write_remaining_data": false, "output_write_method": "write_parquet", "output_write_method_kwargs": {}, "output_filesystem": null, "output_filesystem_kwargs": {}, "output_write_episodes": true, "offline_sampling": false, "evaluation_interval": 1, "evaluation_duration": 20, "evaluation_duration_unit": "episodes", "evaluation_sample_timeout_s": 120.0, "evaluation_auto_duration_min_env_steps_per_sample": 100, "evaluation_auto_duration_max_env_steps_per_sample": 2000, "evaluation_parallel_to_training": false, "evaluation_force_reset_envs_before_iteration": true, "evaluation_config": null, "off_policy_estimation_methods": {}, "ope_split_batch_by_episode": true, "evaluation_num_env_runners": 1, "in_evaluation": false, "sync_filters_on_rollout_workers_timeout_s": 10.0, "offline_evaluation_interval": null, "num_offline_eval_runners": 0, "offline_loss_for_module_fn": null, "offline_evaluation_duration": 1, "offline_evaluation_parallel_to_training": false, "offline_evaluation_timeout_s": 120.0, "num_cpus_per_offline_eval_runner": 1, "num_gpus_per_offline_eval_runner": 0, "custom_resources_per_offline_eval_runner": {}, "restart_failed_offline_eval_runners": true, "ignore_offline_eval_runner_failures": false, "max_num_offline_eval_runner_restarts": 1000, "offline_eval_runner_restore_timeout_s": 1800.0, "max_requests_in_flight_per_offline_eval_runner": 1, "validate_offline_eval_runners_after_construction": true, "offline_eval_runner_health_probe_timeout_s": 30.0, "offline_eval_rl_module_inference_only": false, "broadcast_offline_eval_runner_states": false, "offline_eval_batch_size_per_runner": 256, "dataset_num_iters_per_eval_runner": 1, "keep_per_episode_custom_metrics": false, "metrics_episode_collection_timeout_s": 60.0, "metrics_num_episodes_for_smoothing": 100, "min_time_s_per_iteration": null, "min_train_timesteps_per_iteration": 0, "min_sample_timesteps_per_iteration": 0, "log_gradients": true, "export_native_model_files": false, "checkpoint_trainable_policies_only": false, "logger_creator": null, "logger_config": null, "log_level": "WARN", "log_sys_usage": true, "fake_sampler": false, "seed": 6, "restart_failed_env_runners": true, "ignore_env_runner_failures": false, "max_num_env_runner_restarts": 1000, "delay_between_env_runner_restarts_s": 60.0, "restart_failed_sub_environments": false, "num_consecutive_env_runner_failures_tolerance": 100, "env_runner_health_probe_timeout_s": 30.0, "env_runner_restore_timeout_s": 1800.0, "_model_config": {}, "_rl_module_spec": "RLModuleSpec(module_class=None, observation_space=None, action_space=None, inference_only=False, learner_only=False, model_config=DefaultModelConfig(fcnet_hiddens=[60, 90], fcnet_activation='tanh', fcnet_kernel_initializer=None, fcnet_kernel_initializer_kwargs=None, fcnet_bias_initializer=None, fcnet_bias_initializer_kwargs=None, conv_filters=None, conv_activation='relu', conv_kernel_initializer=None, conv_kernel_initializer_kwargs=None, conv_bias_initializer=None, conv_bias_initializer_kwargs=None, head_fcnet_hiddens=[], head_fcnet_activation='relu', head_fcnet_kernel_initializer=None, head_fcnet_kernel_initializer_kwargs=None, head_fcnet_bias_initializer=None, head_fcnet_bias_initializer_kwargs=None, free_log_std=False, log_std_clip_param=20.0, vf_share_layers=True, use_lstm=False, max_seq_len=20, lstm_cell_size=256, lstm_use_prev_action=False, lstm_use_prev_reward=False, lstm_kernel_initializer=None, lstm_kernel_initializer_kwargs=None, lstm_bias_initializer=None, lstm_bias_initializer_kwargs=None), catalog_class=None, load_state_path=None, model_config_dict=None)", "algorithm_config_overrides_per_module": {}, "_per_module_overrides": {}, "_validate_config": true, "_use_msgpack_checkpoints": false, "_torch_grad_scaler_class": null, "_torch_lr_scheduler_classes": null, "_tf_policy_handles_more_than_one_loss": false, "_disable_preprocessor_api": false, "_disable_action_flattening": false, "_disable_initialize_loss_from_dummy_batch": false, "_dont_auto_sync_env_runner_states": false, "env_task_fn": -1, "enable_connectors": -1, "simple_optimizer": false, "policy_map_cache": -1, "worker_cls": -1, "synchronize_filters": -1, "enable_async_evaluation": -1, "custom_async_evaluation_function": -1, "_enable_rl_module_api": -1, "auto_wrap_old_gym_envs": -1, "always_attach_evaluation_results": -1, "replay_sequence_length": null, "_disable_execution_plan_api": -1, "use_critic": true, "use_gae": true, "use_kl_loss": true, "kl_coeff": 0.7464963036515, "kl_target": 0.0270990929592, "vf_loss_coeff": 0.6688075857018, "entropy_coeff": 0.0090570820258, "clip_param": 0.1221781641624, "vf_clip_param": 0.1027808522125, "entropy_coeff_schedule": null, "lr_schedule": null, "sgd_minibatch_size": -1, "vf_share_layers": -1, "__stdout_file__": null, "__stderr_file__": null, "lambda": 0.9099046732075, "input": "sampler", "policies": {"default_policy": [null, null, null, null]}, "callbacks": "<class 'ray.rllib.callbacks.callbacks.RLlibCallback'>", "create_env_on_driver": false, "custom_eval_function": null, "framework": "torch"}, "time_since_restore": 28.43761444091797, "iterations_since_restore": 16, "perf": {"cpu_util_percent": 60.199999999999996, "ram_util_percent": 84.26666666666667}}
{"timers": {"training_iteration": 1.7218863579731722, "restore_env_runners": 1.679696987099804e-05, "training_step": 1.7217369575324684, "env_runner_sampling_timer": 1.5928712566870116, "learner_update_timer": 0.12529329188382649, "synch_weights": 0.0008463045675043035, "restore_eval_env_runners": 1.0247134767005246e-05, "evaluation_iteration": 0.13029704818054663, "synch_eval_env_connectors": 0.0001455729014542858, "synch_env_connectors": 5.032279435051025e-06}, "env_runners": {"num_episodes": 250.0, "num_agent_steps_sampled": {"default_agent": 5000.0}, "weights_seq_no": 16.0, "num_agent_steps_sampled_lifetime": {"default_agent": -9252500.0}, "num_episodes_lifetime": -462625.0, "env_to_module_connector": {"timers": {"connectors": {"add_states_from_episodes_to_batch": 1.7379464856425972e-06, "add_time_dim_to_batch_and_zero_pad": 2.3487079611694977e-06, "numpy_to_tensor": 8.83294184835132e-06, "batch_individual_items": 6.301793260365271e-06, "add_observations_from_episodes_to_batch": 3.0813610730276827e-06}}, "connector_pipeline_timer": 4.4640474400405637e-05}, "sample": 0.006162881770189942, "num_module_steps_sampled": {"default_policy": 5000.0}, "rlmodule_inference_timer": 5.3061279802204666e-05, "episode_return_max": 10.5, "agent_episode_returns_mean": {"default_agent": 7.940000000000001}, "episode_len_mean": 20.0, "time_between_sampling": 0.002450051916779854, "env_step_timer": 1.397438138637427e-05, "env_to_module_sum_episodes_length_out": 10.36823839457432, "env_reset_timer": 4.7485849064330065e-05, "module_to_env_connector": {"timers": {"connectors": {"listify_data_for_vector_env": 1.1138519403118903e-05, "normalize_and_clip_actions": 9.553585899274638e-06, "get_actions": 4.0982079049940417e-05, "un_batch_to_individual_items": 5.478826454361326e-06, "tensor_to_numpy": 1.346074349848942e-05, "remove_single_ts_time_rank_from_batch": 5.966317727834248e-07}}, "connector_pipeline_timer": 0.00010731822576642321}, "episode_duration_sec_mean": 0.005194359031040223, "num_module_steps_sampled_lifetime": {"default_policy": -9252500.0}, "episode_len_min": 20, "episode_return_mean": 7.940000000000001, "episode_return_min": -9.5, "module_episode_returns_mean": {"default_policy": 7.940000000000001}, "episode_len_max": 20, "num_env_steps_sampled": 5000.0, "env_to_module_sum_episodes_length_in": 10.36823839457432, "num_env_steps_sampled_lifetime": -9252500.0, "num_env_steps_sampled_lifetime_throughput": 3563.8739841867477}, "learners": {"__all_modules__": {"num_env_steps_trained_lifetime": 535500, "learner_connector": {"timers": {"connectors": {"add_observations_from_episodes_to_batch": 0.0008396106604053788, "add_time_dim_to_batch_and_zero_pad": 1.9871285224636525e-05, "add_columns_from_episodes_to_train_batch": 0.03745318216387663, "add_one_ts_to_episodes_and_truncate": 0.009527914720203017, "add_states_from_episodes_to_batch": 3.85295055689921e-06, "numpy_to_tensor": 9.80352178123109e-05, "batch_individual_items": 0.03992075345269601, "general_advantage_estimation": 0.008033417566207565}}, "connector_pipeline_timer": 0.09606866547562651}, "learner_connector_sum_episodes_length_in": 5000.0, "num_env_steps_trained": 31500, "num_module_steps_trained": 6000, "num_non_trainable_parameters": 0, "num_module_steps_trained_lifetime": 102000, "num_trainable_parameters": 6003, "learner_connector_sum_episodes_length_out": 5250.0, "num_env_steps_trained_lifetime_throughput": 1993384.0678270843, "num_module_steps_trained_throughput": 380627.2025403912, "num_module_steps_trained_lifetime_throughput": 380231.5787714812}, "default_policy": {"gradients_default_optimizer_global_norm": 0.2044783979654312, "weights_seq_no": 17.0, "num_module_steps_trained_lifetime": 102000, "num_trainable_parameters": 6003, "diff_num_grad_updates_vs_sampler_policy": 1.0, "policy_loss": 0.0521533340215683, "default_optimizer_learning_rate": 0.0002847858517, "vf_explained_var": -0.017306208610534668, "vf_loss": 0.10278083384037018, "vf_loss_unclipped": 29.69392204284668, "curr_entropy_coeff": 0.0090570820258, "module_train_batch_size_mean": 1000.0, "num_module_steps_trained": 6000, "total_loss": 0.11605548858642578, "mean_kl_loss": 0.0022154797334223986, "entropy": 0.5342195630073547, "curr_kl_coeff": 5.695314939657692e-06, "num_module_steps_trained_lifetime_throughput": 380719.0234811191}}, "num_training_step_calls_per_iteration": 1, "evaluation": {"env_runners": {"env_to_module_connector": {"timers": {"connectors": {"add_observations_from_episodes_to_batch": 2.778227307570047e-06, "add_time_dim_to_batch_and_zero_pad": 2.3973998154507303e-06, "add_states_from_episodes_to_batch": 1.579278655494072e-06, "numpy_to_tensor": 8.195477194386118e-06, "batch_individual_items": 6.145025005177969e-06}}, "connector_pipeline_timer": 4.228745626890978e-05}, "episode_return_mean": -1.15, "num_module_steps_sampled": {"default_policy": 400}, "num_episodes_lifetime": 340, "module_to_env_connector": {"timers": {"connectors": {"un_batch_to_individual_items": 5.3217621150577e-06, "tensor_to_numpy": 1.2675009738470015e-05, "listify_data_for_vector_env": 1.0857430724102021e-05, "remove_single_ts_time_rank_from_batch": 5.651579919912515e-07, "get_actions": 3.443020364467284e-05, "normalize_and_clip_actions": 9.337597977432276e-06}}, "connector_pipeline_timer": 9.819251856084944e-05}, "rlmodule_inference_timer": 2.6237557459025013e-05, "module_episode_returns_mean": {"default_policy": -1.15}, "env_to_module_sum_episodes_length_out": 10.368238394574323, "num_episodes": 20, "episode_return_max": 14.5, "env_reset_timer": 0.00042412439718798265, "episode_len_min": 20, "episode_return_min": -13.5, "episode_len_max": 20, "env_to_module_sum_episodes_length_in": 10.368238394574323, "num_env_steps_sampled_lifetime": 85400, "agent_episode_returns_mean": {"default_agent": -1.15}, "num_module_steps_sampled_lifetime": {"default_policy": 6800}, "sample": 0.11499816144941113, "episode_duration_sec_mean": 0.005676684960490092, "num_agent_steps_sampled": {"default_agent": 400}, "num_env_steps_sampled": 400, "weights_seq_no": 17.0, "episode_len_mean": 20.0, "env_step_timer": 1.3938401473413693e-05, "num_agent_steps_sampled_lifetime": {"default_agent": 6800}, "time_between_sampling": 1.652529965097842}, "num_healthy_workers": 1, "actor_manager_num_outstanding_async_reqs": 0, "num_remote_worker_restarts": 0}, "num_env_steps_sampled_lifetime": -9252500.0, "fault_tolerance": {"num_healthy_workers": 0, "num_remote_worker_restarts": 0}, "env_runner_group": {"actor_manager_num_outstanding_async_reqs": 0}, "done": false, "training_iteration": 17, "trial_id": "4dc31_00000", "date": "2025-08-11_19-19-52", "timestamp": 1754932792, "time_this_iter_s": 1.7401580810546875, "time_total_s": 30.177772521972656, "pid": 14098, "hostname": "Mac", "node_ip": "127.0.0.1", "config": {"exploration_config": {}, "extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "placement_strategy": "PACK", "num_gpus": 0, "_fake_gpus": false, "num_cpus_for_main_process": 2, "eager_tracing": true, "eager_max_retraces": 20, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "torch_compile_learner": false, "torch_compile_learner_what_to_compile": "forward_train", "torch_compile_learner_dynamo_backend": "aot_eager", "torch_compile_learner_dynamo_mode": null, "torch_compile_worker": false, "torch_compile_worker_dynamo_backend": "aot_eager", "torch_compile_worker_dynamo_mode": null, "torch_ddp_kwargs": {}, "torch_skip_nan_gradients": false, "env": "Umbrella", "env_config": {}, "observation_space": null, "action_space": null, "clip_rewards": null, "normalize_actions": true, "clip_actions": false, "_is_atari": null, "disable_env_checking": false, "render_env": false, "action_mask_key": "action_mask", "env_runner_cls": null, "num_env_runners": 0, "create_local_env_runner": true, "num_envs_per_env_runner": 1, "gym_env_vectorize_mode": "SYNC", "num_cpus_per_env_runner": 1, "num_gpus_per_env_runner": 0, "custom_resources_per_env_runner": {}, "validate_env_runners_after_construction": true, "episodes_to_numpy": true, "max_requests_in_flight_per_env_runner": 1, "sample_timeout_s": 60.0, "_env_to_module_connector": null, "add_default_connectors_to_env_to_module_pipeline": true, "_module_to_env_connector": null, "add_default_connectors_to_module_to_env_pipeline": true, "merge_env_runner_states": "training_only", "broadcast_env_runner_states": true, "episode_lookback_horizon": 1, "rollout_fragment_length": "auto", "batch_mode": "complete_episodes", "compress_observations": false, "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "enable_tf1_exec_eagerly": false, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "preprocessor_pref": "deepmind", "observation_filter": "NoFilter", "update_worker_filter_stats": true, "use_worker_filter_stats": true, "sampler_perf_stats_ema_coef": null, "_is_online": true, "num_learners": 0, "num_gpus_per_learner": 0, "num_cpus_per_learner": "auto", "num_aggregator_actors_per_learner": 0, "max_requests_in_flight_per_aggregator_actor": 3, "local_gpu_idx": 0, "max_requests_in_flight_per_learner": 3, "gamma": 1, "lr": 0.0002847858517, "grad_clip": 0.5, "grad_clip_by": "global_norm", "_train_batch_size_per_learner": 5000, "train_batch_size": 4000, "num_epochs": 1, "minibatch_size": 1000, "shuffle_batch_per_epoch": true, "model": {"fcnet_hiddens": [256, 256], "fcnet_activation": "tanh", "fcnet_weights_initializer": null, "fcnet_weights_initializer_config": null, "fcnet_bias_initializer": null, "fcnet_bias_initializer_config": null, "conv_filters": null, "conv_activation": "relu", "conv_kernel_initializer": null, "conv_kernel_initializer_config": null, "conv_bias_initializer": null, "conv_bias_initializer_config": null, "conv_transpose_kernel_initializer": null, "conv_transpose_kernel_initializer_config": null, "conv_transpose_bias_initializer": null, "conv_transpose_bias_initializer_config": null, "post_fcnet_hiddens": [], "post_fcnet_activation": "relu", "post_fcnet_weights_initializer": null, "post_fcnet_weights_initializer_config": null, "post_fcnet_bias_initializer": null, "post_fcnet_bias_initializer_config": null, "free_log_std": false, "log_std_clip_param": 20.0, "no_final_linear": false, "vf_share_layers": false, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "lstm_weights_initializer": null, "lstm_weights_initializer_config": null, "lstm_bias_initializer": null, "lstm_bias_initializer_config": null, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "attention_use_n_prev_actions": 0, "attention_use_n_prev_rewards": 0, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": null, "custom_model_config": {}, "custom_action_dist": null, "custom_preprocessor": null, "encoder_latent_dim": null, "always_check_shapes": false, "lstm_use_prev_action_reward": -1, "_use_default_native_models": -1, "_disable_preprocessor_api": false, "_disable_action_flattening": false}, "_learner_connector": null, "add_default_connectors_to_learner_pipeline": true, "learner_config_dict": {}, "optimizer": {}, "_learner_class": null, "callbacks_on_algorithm_init": null, "callbacks_on_env_runners_recreated": null, "callbacks_on_offline_eval_runners_recreated": null, "callbacks_on_checkpoint_loaded": null, "callbacks_on_environment_created": null, "callbacks_on_episode_created": null, "callbacks_on_episode_start": null, "callbacks_on_episode_step": null, "callbacks_on_episode_end": null, "callbacks_on_evaluate_start": null, "callbacks_on_evaluate_end": null, "callbacks_on_evaluate_offline_start": null, "callbacks_on_evaluate_offline_end": null, "callbacks_on_sample_end": null, "callbacks_on_train_result": null, "explore": true, "enable_rl_module_and_learner": true, "enable_env_runner_and_connector_v2": true, "_prior_exploration_config": {"type": "StochasticSampling"}, "count_steps_by": "env_steps", "policy_map_capacity": 100, "policy_mapping_fn": "<function AlgorithmConfig.DEFAULT_POLICY_MAPPING_FN at 0x385441b20>", "policies_to_train": null, "policy_states_are_swappable": false, "observation_fn": null, "offline_data_class": null, "input_read_method": "read_parquet", "input_read_method_kwargs": {}, "input_read_schema": {}, "input_read_episodes": false, "input_read_sample_batches": false, "input_read_batch_size": null, "input_filesystem": null, "input_filesystem_kwargs": {}, "input_compress_columns": ["obs", "new_obs"], "input_spaces_jsonable": true, "materialize_data": false, "materialize_mapped_data": true, "map_batches_kwargs": {}, "iter_batches_kwargs": {}, "ignore_final_observation": false, "prelearner_class": null, "prelearner_buffer_class": null, "prelearner_buffer_kwargs": {}, "prelearner_module_synch_period": 10, "dataset_num_iters_per_learner": null, "input_config": {}, "actions_in_input_normalized": false, "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_config": {}, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "output_max_rows_per_file": null, "output_write_remaining_data": false, "output_write_method": "write_parquet", "output_write_method_kwargs": {}, "output_filesystem": null, "output_filesystem_kwargs": {}, "output_write_episodes": true, "offline_sampling": false, "evaluation_interval": 1, "evaluation_duration": 20, "evaluation_duration_unit": "episodes", "evaluation_sample_timeout_s": 120.0, "evaluation_auto_duration_min_env_steps_per_sample": 100, "evaluation_auto_duration_max_env_steps_per_sample": 2000, "evaluation_parallel_to_training": false, "evaluation_force_reset_envs_before_iteration": true, "evaluation_config": null, "off_policy_estimation_methods": {}, "ope_split_batch_by_episode": true, "evaluation_num_env_runners": 1, "in_evaluation": false, "sync_filters_on_rollout_workers_timeout_s": 10.0, "offline_evaluation_interval": null, "num_offline_eval_runners": 0, "offline_loss_for_module_fn": null, "offline_evaluation_duration": 1, "offline_evaluation_parallel_to_training": false, "offline_evaluation_timeout_s": 120.0, "num_cpus_per_offline_eval_runner": 1, "num_gpus_per_offline_eval_runner": 0, "custom_resources_per_offline_eval_runner": {}, "restart_failed_offline_eval_runners": true, "ignore_offline_eval_runner_failures": false, "max_num_offline_eval_runner_restarts": 1000, "offline_eval_runner_restore_timeout_s": 1800.0, "max_requests_in_flight_per_offline_eval_runner": 1, "validate_offline_eval_runners_after_construction": true, "offline_eval_runner_health_probe_timeout_s": 30.0, "offline_eval_rl_module_inference_only": false, "broadcast_offline_eval_runner_states": false, "offline_eval_batch_size_per_runner": 256, "dataset_num_iters_per_eval_runner": 1, "keep_per_episode_custom_metrics": false, "metrics_episode_collection_timeout_s": 60.0, "metrics_num_episodes_for_smoothing": 100, "min_time_s_per_iteration": null, "min_train_timesteps_per_iteration": 0, "min_sample_timesteps_per_iteration": 0, "log_gradients": true, "export_native_model_files": false, "checkpoint_trainable_policies_only": false, "logger_creator": null, "logger_config": null, "log_level": "WARN", "log_sys_usage": true, "fake_sampler": false, "seed": 6, "restart_failed_env_runners": true, "ignore_env_runner_failures": false, "max_num_env_runner_restarts": 1000, "delay_between_env_runner_restarts_s": 60.0, "restart_failed_sub_environments": false, "num_consecutive_env_runner_failures_tolerance": 100, "env_runner_health_probe_timeout_s": 30.0, "env_runner_restore_timeout_s": 1800.0, "_model_config": {}, "_rl_module_spec": "RLModuleSpec(module_class=None, observation_space=None, action_space=None, inference_only=False, learner_only=False, model_config=DefaultModelConfig(fcnet_hiddens=[60, 90], fcnet_activation='tanh', fcnet_kernel_initializer=None, fcnet_kernel_initializer_kwargs=None, fcnet_bias_initializer=None, fcnet_bias_initializer_kwargs=None, conv_filters=None, conv_activation='relu', conv_kernel_initializer=None, conv_kernel_initializer_kwargs=None, conv_bias_initializer=None, conv_bias_initializer_kwargs=None, head_fcnet_hiddens=[], head_fcnet_activation='relu', head_fcnet_kernel_initializer=None, head_fcnet_kernel_initializer_kwargs=None, head_fcnet_bias_initializer=None, head_fcnet_bias_initializer_kwargs=None, free_log_std=False, log_std_clip_param=20.0, vf_share_layers=True, use_lstm=False, max_seq_len=20, lstm_cell_size=256, lstm_use_prev_action=False, lstm_use_prev_reward=False, lstm_kernel_initializer=None, lstm_kernel_initializer_kwargs=None, lstm_bias_initializer=None, lstm_bias_initializer_kwargs=None), catalog_class=None, load_state_path=None, model_config_dict=None)", "algorithm_config_overrides_per_module": {}, "_per_module_overrides": {}, "_validate_config": true, "_use_msgpack_checkpoints": false, "_torch_grad_scaler_class": null, "_torch_lr_scheduler_classes": null, "_tf_policy_handles_more_than_one_loss": false, "_disable_preprocessor_api": false, "_disable_action_flattening": false, "_disable_initialize_loss_from_dummy_batch": false, "_dont_auto_sync_env_runner_states": false, "env_task_fn": -1, "enable_connectors": -1, "simple_optimizer": false, "policy_map_cache": -1, "worker_cls": -1, "synchronize_filters": -1, "enable_async_evaluation": -1, "custom_async_evaluation_function": -1, "_enable_rl_module_api": -1, "auto_wrap_old_gym_envs": -1, "always_attach_evaluation_results": -1, "replay_sequence_length": null, "_disable_execution_plan_api": -1, "use_critic": true, "use_gae": true, "use_kl_loss": true, "kl_coeff": 0.7464963036515, "kl_target": 0.0270990929592, "vf_loss_coeff": 0.6688075857018, "entropy_coeff": 0.0090570820258, "clip_param": 0.1221781641624, "vf_clip_param": 0.1027808522125, "entropy_coeff_schedule": null, "lr_schedule": null, "sgd_minibatch_size": -1, "vf_share_layers": -1, "__stdout_file__": null, "__stderr_file__": null, "lambda": 0.9099046732075, "input": "sampler", "policies": {"default_policy": [null, null, null, null]}, "callbacks": "<class 'ray.rllib.callbacks.callbacks.RLlibCallback'>", "create_env_on_driver": false, "custom_eval_function": null, "framework": "torch"}, "time_since_restore": 30.177772521972656, "iterations_since_restore": 17, "perf": {"cpu_util_percent": 52.349999999999994, "ram_util_percent": 83.30000000000001}}
{"timers": {"training_iteration": 1.7209594514731064, "restore_env_runners": 1.6683999426931977e-05, "training_step": 1.7208098787878006, "env_runner_sampling_timer": 1.591379652870131, "learner_update_timer": 0.1258627635458775, "synch_weights": 0.0008435786120797377, "restore_eval_env_runners": 1.0204663876204795e-05, "evaluation_iteration": 0.12999415602855763, "synch_eval_env_connectors": 0.00014509176309702182, "synch_env_connectors": 5.02195694528025e-06}, "env_runners": {"num_episodes": 250.0, "num_agent_steps_sampled": {"default_agent": 5000.0}, "weights_seq_no": 17.0, "num_agent_steps_sampled_lifetime": {"default_agent": -9870000.0}, "num_episodes_lifetime": -493500.0, "env_to_module_connector": {"timers": {"connectors": {"add_states_from_episodes_to_batch": 1.7699783297052725e-06, "add_time_dim_to_batch_and_zero_pad": 2.4314739318876155e-06, "numpy_to_tensor": 8.842819331535509e-06, "batch_individual_items": 6.384186197709026e-06, "add_observations_from_episodes_to_batch": 3.023197615840443e-06}}, "connector_pipeline_timer": 4.539841933397411e-05}, "sample": 0.005341715322885418, "num_module_steps_sampled": {"default_policy": 5000.0}, "rlmodule_inference_timer": 2.9191487225949726e-05, "episode_return_max": 10.5, "agent_episode_returns_mean": {"default_agent": 8.5}, "episode_len_mean": 20.0, "time_between_sampling": 0.0015604146395109977, "env_step_timer": 1.5500185327772935e-05, "env_to_module_sum_episodes_length_out": 10.36823839457432, "env_reset_timer": 3.6189415211006136e-05, "module_to_env_connector": {"timers": {"connectors": {"listify_data_for_vector_env": 1.1264664141487972e-05, "normalize_and_clip_actions": 9.797924992265781e-06, "get_actions": 4.215967702425552e-05, "un_batch_to_individual_items": 5.491623052405271e-06, "tensor_to_numpy": 1.3608128777858453e-05, "remove_single_ts_time_rank_from_batch": 6.146478219048388e-07}}, "connector_pipeline_timer": 0.00010925031399080747}, "episode_duration_sec_mean": 0.004793318961746992, "num_module_steps_sampled_lifetime": {"default_policy": -9870000.0}, "episode_len_min": 20, "episode_return_mean": 8.5, "episode_return_min": -9.5, "module_episode_returns_mean": {"default_policy": 8.5}, "episode_len_max": 20, "num_env_steps_sampled": 5000.0, "env_to_module_sum_episodes_length_in": 10.36823839457432, "num_env_steps_sampled_lifetime": -9870000.0, "num_env_steps_sampled_lifetime_throughput": 3678.244236179411}, "learners": {"__all_modules__": {"num_env_steps_trained_lifetime": 567000, "learner_connector": {"timers": {"connectors": {"add_observations_from_episodes_to_batch": 0.000839615383775887, "add_time_dim_to_batch_and_zero_pad": 1.978632178334726e-05, "add_columns_from_episodes_to_train_batch": 0.037419143262023766, "add_one_ts_to_episodes_and_truncate": 0.009509582662984137, "add_states_from_episodes_to_batch": 3.8460906754800174e-06, "numpy_to_tensor": 9.767945595470044e-05, "batch_individual_items": 0.040716904668579426, "general_advantage_estimation": 0.008027533800283836}}, "connector_pipeline_timer": 0.0968054154804671}, "learner_connector_sum_episodes_length_in": 5000.0, "num_env_steps_trained": 31500, "num_module_steps_trained": 6000, "num_non_trainable_parameters": 0, "num_module_steps_trained_lifetime": 108000, "num_trainable_parameters": 6003, "learner_connector_sum_episodes_length_out": 5250.0, "num_env_steps_trained_lifetime_throughput": 2002996.1790647528, "num_module_steps_trained_throughput": 382422.0845661017, "num_module_steps_trained_lifetime_throughput": 382037.9233881562}, "default_policy": {"gradients_default_optimizer_global_norm": 0.031843796372413635, "weights_seq_no": 18.0, "num_module_steps_trained_lifetime": 108000, "num_trainable_parameters": 6003, "diff_num_grad_updates_vs_sampler_policy": 1.0, "policy_loss": -0.13860587775707245, "default_optimizer_learning_rate": 0.0002847858517, "vf_explained_var": -0.013191699981689453, "vf_loss": 0.10278083384037018, "vf_loss_unclipped": 29.967670440673828, "curr_entropy_coeff": 0.0090570820258, "module_train_batch_size_mean": 1000.0, "num_module_steps_trained": 6000, "total_loss": -0.07469553500413895, "mean_kl_loss": 0.00045499237603507936, "entropy": 0.5333104133605957, "curr_kl_coeff": 2.847657469828846e-06, "num_module_steps_trained_lifetime_throughput": 382470.9282925691}}, "num_training_step_calls_per_iteration": 1, "evaluation": {"env_runners": {"env_to_module_connector": {"timers": {"connectors": {"add_observations_from_episodes_to_batch": 2.78557229305996e-06, "add_time_dim_to_batch_and_zero_pad": 2.249777273929201e-06, "add_states_from_episodes_to_batch": 1.5998053815308248e-06, "numpy_to_tensor": 8.196373895680604e-06, "batch_individual_items": 6.144750049887852e-06}}, "connector_pipeline_timer": 4.226049931850249e-05}, "episode_return_mean": 0.25, "num_module_steps_sampled": {"default_policy": 400}, "num_episodes_lifetime": 360, "module_to_env_connector": {"timers": {"connectors": {"un_batch_to_individual_items": 5.29897748368815e-06, "tensor_to_numpy": 1.2687508539255278e-05, "listify_data_for_vector_env": 1.0940511499723789e-05, "remove_single_ts_time_rank_from_batch": 5.649144851243047e-07, "get_actions": 3.413058855902833e-05, "normalize_and_clip_actions": 9.364571942815444e-06}}, "connector_pipeline_timer": 9.797668716258035e-05}, "rlmodule_inference_timer": 2.596888841500226e-05, "module_episode_returns_mean": {"default_policy": 0.25}, "env_to_module_sum_episodes_length_out": 10.368238394574323, "num_episodes": 20, "episode_return_max": 14.5, "env_reset_timer": 0.0004205998222354145, "episode_len_min": 20, "episode_return_min": -13.5, "episode_len_max": 20, "env_to_module_sum_episodes_length_in": 10.368238394574323, "num_env_steps_sampled_lifetime": 90400, "agent_episode_returns_mean": {"default_agent": 0.25}, "num_module_steps_sampled_lifetime": {"default_policy": 7200}, "sample": 0.11481154608542456, "episode_duration_sec_mean": 0.005623426211532206, "num_agent_steps_sampled": {"default_agent": 400}, "num_env_steps_sampled": 400, "weights_seq_no": 18.0, "episode_len_mean": 20.0, "env_step_timer": 1.3822730185971582e-05, "num_agent_steps_sampled_lifetime": {"default_agent": 7200}, "time_between_sampling": 1.6524698362773518}, "num_healthy_workers": 1, "actor_manager_num_outstanding_async_reqs": 0, "num_remote_worker_restarts": 0}, "num_env_steps_sampled_lifetime": -9870000.0, "fault_tolerance": {"num_healthy_workers": 0, "num_remote_worker_restarts": 0}, "env_runner_group": {"actor_manager_num_outstanding_async_reqs": 0}, "done": false, "training_iteration": 18, "trial_id": "4dc31_00000", "date": "2025-08-11_19-19-54", "timestamp": 1754932794, "time_this_iter_s": 1.7330520153045654, "time_total_s": 31.91082453727722, "pid": 14098, "hostname": "Mac", "node_ip": "127.0.0.1", "config": {"exploration_config": {}, "extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "placement_strategy": "PACK", "num_gpus": 0, "_fake_gpus": false, "num_cpus_for_main_process": 2, "eager_tracing": true, "eager_max_retraces": 20, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "torch_compile_learner": false, "torch_compile_learner_what_to_compile": "forward_train", "torch_compile_learner_dynamo_backend": "aot_eager", "torch_compile_learner_dynamo_mode": null, "torch_compile_worker": false, "torch_compile_worker_dynamo_backend": "aot_eager", "torch_compile_worker_dynamo_mode": null, "torch_ddp_kwargs": {}, "torch_skip_nan_gradients": false, "env": "Umbrella", "env_config": {}, "observation_space": null, "action_space": null, "clip_rewards": null, "normalize_actions": true, "clip_actions": false, "_is_atari": null, "disable_env_checking": false, "render_env": false, "action_mask_key": "action_mask", "env_runner_cls": null, "num_env_runners": 0, "create_local_env_runner": true, "num_envs_per_env_runner": 1, "gym_env_vectorize_mode": "SYNC", "num_cpus_per_env_runner": 1, "num_gpus_per_env_runner": 0, "custom_resources_per_env_runner": {}, "validate_env_runners_after_construction": true, "episodes_to_numpy": true, "max_requests_in_flight_per_env_runner": 1, "sample_timeout_s": 60.0, "_env_to_module_connector": null, "add_default_connectors_to_env_to_module_pipeline": true, "_module_to_env_connector": null, "add_default_connectors_to_module_to_env_pipeline": true, "merge_env_runner_states": "training_only", "broadcast_env_runner_states": true, "episode_lookback_horizon": 1, "rollout_fragment_length": "auto", "batch_mode": "complete_episodes", "compress_observations": false, "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "enable_tf1_exec_eagerly": false, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "preprocessor_pref": "deepmind", "observation_filter": "NoFilter", "update_worker_filter_stats": true, "use_worker_filter_stats": true, "sampler_perf_stats_ema_coef": null, "_is_online": true, "num_learners": 0, "num_gpus_per_learner": 0, "num_cpus_per_learner": "auto", "num_aggregator_actors_per_learner": 0, "max_requests_in_flight_per_aggregator_actor": 3, "local_gpu_idx": 0, "max_requests_in_flight_per_learner": 3, "gamma": 1, "lr": 0.0002847858517, "grad_clip": 0.5, "grad_clip_by": "global_norm", "_train_batch_size_per_learner": 5000, "train_batch_size": 4000, "num_epochs": 1, "minibatch_size": 1000, "shuffle_batch_per_epoch": true, "model": {"fcnet_hiddens": [256, 256], "fcnet_activation": "tanh", "fcnet_weights_initializer": null, "fcnet_weights_initializer_config": null, "fcnet_bias_initializer": null, "fcnet_bias_initializer_config": null, "conv_filters": null, "conv_activation": "relu", "conv_kernel_initializer": null, "conv_kernel_initializer_config": null, "conv_bias_initializer": null, "conv_bias_initializer_config": null, "conv_transpose_kernel_initializer": null, "conv_transpose_kernel_initializer_config": null, "conv_transpose_bias_initializer": null, "conv_transpose_bias_initializer_config": null, "post_fcnet_hiddens": [], "post_fcnet_activation": "relu", "post_fcnet_weights_initializer": null, "post_fcnet_weights_initializer_config": null, "post_fcnet_bias_initializer": null, "post_fcnet_bias_initializer_config": null, "free_log_std": false, "log_std_clip_param": 20.0, "no_final_linear": false, "vf_share_layers": false, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "lstm_weights_initializer": null, "lstm_weights_initializer_config": null, "lstm_bias_initializer": null, "lstm_bias_initializer_config": null, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "attention_use_n_prev_actions": 0, "attention_use_n_prev_rewards": 0, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": null, "custom_model_config": {}, "custom_action_dist": null, "custom_preprocessor": null, "encoder_latent_dim": null, "always_check_shapes": false, "lstm_use_prev_action_reward": -1, "_use_default_native_models": -1, "_disable_preprocessor_api": false, "_disable_action_flattening": false}, "_learner_connector": null, "add_default_connectors_to_learner_pipeline": true, "learner_config_dict": {}, "optimizer": {}, "_learner_class": null, "callbacks_on_algorithm_init": null, "callbacks_on_env_runners_recreated": null, "callbacks_on_offline_eval_runners_recreated": null, "callbacks_on_checkpoint_loaded": null, "callbacks_on_environment_created": null, "callbacks_on_episode_created": null, "callbacks_on_episode_start": null, "callbacks_on_episode_step": null, "callbacks_on_episode_end": null, "callbacks_on_evaluate_start": null, "callbacks_on_evaluate_end": null, "callbacks_on_evaluate_offline_start": null, "callbacks_on_evaluate_offline_end": null, "callbacks_on_sample_end": null, "callbacks_on_train_result": null, "explore": true, "enable_rl_module_and_learner": true, "enable_env_runner_and_connector_v2": true, "_prior_exploration_config": {"type": "StochasticSampling"}, "count_steps_by": "env_steps", "policy_map_capacity": 100, "policy_mapping_fn": "<function AlgorithmConfig.DEFAULT_POLICY_MAPPING_FN at 0x385441b20>", "policies_to_train": null, "policy_states_are_swappable": false, "observation_fn": null, "offline_data_class": null, "input_read_method": "read_parquet", "input_read_method_kwargs": {}, "input_read_schema": {}, "input_read_episodes": false, "input_read_sample_batches": false, "input_read_batch_size": null, "input_filesystem": null, "input_filesystem_kwargs": {}, "input_compress_columns": ["obs", "new_obs"], "input_spaces_jsonable": true, "materialize_data": false, "materialize_mapped_data": true, "map_batches_kwargs": {}, "iter_batches_kwargs": {}, "ignore_final_observation": false, "prelearner_class": null, "prelearner_buffer_class": null, "prelearner_buffer_kwargs": {}, "prelearner_module_synch_period": 10, "dataset_num_iters_per_learner": null, "input_config": {}, "actions_in_input_normalized": false, "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_config": {}, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "output_max_rows_per_file": null, "output_write_remaining_data": false, "output_write_method": "write_parquet", "output_write_method_kwargs": {}, "output_filesystem": null, "output_filesystem_kwargs": {}, "output_write_episodes": true, "offline_sampling": false, "evaluation_interval": 1, "evaluation_duration": 20, "evaluation_duration_unit": "episodes", "evaluation_sample_timeout_s": 120.0, "evaluation_auto_duration_min_env_steps_per_sample": 100, "evaluation_auto_duration_max_env_steps_per_sample": 2000, "evaluation_parallel_to_training": false, "evaluation_force_reset_envs_before_iteration": true, "evaluation_config": null, "off_policy_estimation_methods": {}, "ope_split_batch_by_episode": true, "evaluation_num_env_runners": 1, "in_evaluation": false, "sync_filters_on_rollout_workers_timeout_s": 10.0, "offline_evaluation_interval": null, "num_offline_eval_runners": 0, "offline_loss_for_module_fn": null, "offline_evaluation_duration": 1, "offline_evaluation_parallel_to_training": false, "offline_evaluation_timeout_s": 120.0, "num_cpus_per_offline_eval_runner": 1, "num_gpus_per_offline_eval_runner": 0, "custom_resources_per_offline_eval_runner": {}, "restart_failed_offline_eval_runners": true, "ignore_offline_eval_runner_failures": false, "max_num_offline_eval_runner_restarts": 1000, "offline_eval_runner_restore_timeout_s": 1800.0, "max_requests_in_flight_per_offline_eval_runner": 1, "validate_offline_eval_runners_after_construction": true, "offline_eval_runner_health_probe_timeout_s": 30.0, "offline_eval_rl_module_inference_only": false, "broadcast_offline_eval_runner_states": false, "offline_eval_batch_size_per_runner": 256, "dataset_num_iters_per_eval_runner": 1, "keep_per_episode_custom_metrics": false, "metrics_episode_collection_timeout_s": 60.0, "metrics_num_episodes_for_smoothing": 100, "min_time_s_per_iteration": null, "min_train_timesteps_per_iteration": 0, "min_sample_timesteps_per_iteration": 0, "log_gradients": true, "export_native_model_files": false, "checkpoint_trainable_policies_only": false, "logger_creator": null, "logger_config": null, "log_level": "WARN", "log_sys_usage": true, "fake_sampler": false, "seed": 6, "restart_failed_env_runners": true, "ignore_env_runner_failures": false, "max_num_env_runner_restarts": 1000, "delay_between_env_runner_restarts_s": 60.0, "restart_failed_sub_environments": false, "num_consecutive_env_runner_failures_tolerance": 100, "env_runner_health_probe_timeout_s": 30.0, "env_runner_restore_timeout_s": 1800.0, "_model_config": {}, "_rl_module_spec": "RLModuleSpec(module_class=None, observation_space=None, action_space=None, inference_only=False, learner_only=False, model_config=DefaultModelConfig(fcnet_hiddens=[60, 90], fcnet_activation='tanh', fcnet_kernel_initializer=None, fcnet_kernel_initializer_kwargs=None, fcnet_bias_initializer=None, fcnet_bias_initializer_kwargs=None, conv_filters=None, conv_activation='relu', conv_kernel_initializer=None, conv_kernel_initializer_kwargs=None, conv_bias_initializer=None, conv_bias_initializer_kwargs=None, head_fcnet_hiddens=[], head_fcnet_activation='relu', head_fcnet_kernel_initializer=None, head_fcnet_kernel_initializer_kwargs=None, head_fcnet_bias_initializer=None, head_fcnet_bias_initializer_kwargs=None, free_log_std=False, log_std_clip_param=20.0, vf_share_layers=True, use_lstm=False, max_seq_len=20, lstm_cell_size=256, lstm_use_prev_action=False, lstm_use_prev_reward=False, lstm_kernel_initializer=None, lstm_kernel_initializer_kwargs=None, lstm_bias_initializer=None, lstm_bias_initializer_kwargs=None), catalog_class=None, load_state_path=None, model_config_dict=None)", "algorithm_config_overrides_per_module": {}, "_per_module_overrides": {}, "_validate_config": true, "_use_msgpack_checkpoints": false, "_torch_grad_scaler_class": null, "_torch_lr_scheduler_classes": null, "_tf_policy_handles_more_than_one_loss": false, "_disable_preprocessor_api": false, "_disable_action_flattening": false, "_disable_initialize_loss_from_dummy_batch": false, "_dont_auto_sync_env_runner_states": false, "env_task_fn": -1, "enable_connectors": -1, "simple_optimizer": false, "policy_map_cache": -1, "worker_cls": -1, "synchronize_filters": -1, "enable_async_evaluation": -1, "custom_async_evaluation_function": -1, "_enable_rl_module_api": -1, "auto_wrap_old_gym_envs": -1, "always_attach_evaluation_results": -1, "replay_sequence_length": null, "_disable_execution_plan_api": -1, "use_critic": true, "use_gae": true, "use_kl_loss": true, "kl_coeff": 0.7464963036515, "kl_target": 0.0270990929592, "vf_loss_coeff": 0.6688075857018, "entropy_coeff": 0.0090570820258, "clip_param": 0.1221781641624, "vf_clip_param": 0.1027808522125, "entropy_coeff_schedule": null, "lr_schedule": null, "sgd_minibatch_size": -1, "vf_share_layers": -1, "__stdout_file__": null, "__stderr_file__": null, "lambda": 0.9099046732075, "input": "sampler", "policies": {"default_policy": [null, null, null, null]}, "callbacks": "<class 'ray.rllib.callbacks.callbacks.RLlibCallback'>", "create_env_on_driver": false, "custom_eval_function": null, "framework": "torch"}, "time_since_restore": 31.91082453727722, "iterations_since_restore": 18, "perf": {"cpu_util_percent": 30.066666666666666, "ram_util_percent": 80.06666666666666}}
{"timers": {"training_iteration": 1.723525726117869, "restore_env_runners": 1.6572158687306574e-05, "training_step": 1.7233761550001927, "env_runner_sampling_timer": 1.5933110771714882, "learner_update_timer": 0.1265014717405633, "synch_weights": 0.0008413428254385173, "restore_eval_env_runners": 1.016886686878802e-05, "evaluation_iteration": 0.12970919112806173, "synch_eval_env_connectors": 0.0001465491854228269, "synch_env_connectors": 5.010907639162556e-06}, "env_runners": {"num_episodes": 250.0, "num_agent_steps_sampled": {"default_agent": 5000.0}, "weights_seq_no": 18.0, "num_agent_steps_sampled_lifetime": {"default_agent": -10487500.0}, "num_episodes_lifetime": -524375.0, "env_to_module_connector": {"timers": {"connectors": {"add_states_from_episodes_to_batch": 2.0039306028270623e-06, "add_time_dim_to_batch_and_zero_pad": 2.9014589188082193e-06, "numpy_to_tensor": 1.16051216258282e-05, "batch_individual_items": 7.990344983554286e-06, "add_observations_from_episodes_to_batch": 3.681772283415473e-06}}, "connector_pipeline_timer": 5.389658991790677e-05}, "sample": 0.005868133242340489, "num_module_steps_sampled": {"default_policy": 5000.0}, "rlmodule_inference_timer": 3.7719828428378566e-05, "episode_return_max": 10.5, "agent_episode_returns_mean": {"default_agent": 8.980000000000004}, "episode_len_mean": 20.0, "time_between_sampling": 0.001904882020913549, "env_step_timer": 1.7770368330476245e-05, "env_to_module_sum_episodes_length_out": 10.36823839457432, "env_reset_timer": 4.9800267721729034e-05, "module_to_env_connector": {"timers": {"connectors": {"listify_data_for_vector_env": 1.3837319535413638e-05, "normalize_and_clip_actions": 1.1854365362817815e-05, "get_actions": 5.528663649575776e-05, "un_batch_to_individual_items": 6.6821916404941805e-06, "tensor_to_numpy": 1.7051687421520392e-05, "remove_single_ts_time_rank_from_batch": 6.936404846171198e-07}}, "connector_pipeline_timer": 0.00013652967399255757}, "episode_duration_sec_mean": 0.005901332336012276, "num_module_steps_sampled_lifetime": {"default_policy": -10487500.0}, "episode_len_min": 20, "episode_return_mean": 8.980000000000004, "episode_return_min": -9.5, "module_episode_returns_mean": {"default_policy": 8.980000000000004}, "episode_len_max": 20, "num_env_steps_sampled": 5000.0, "env_to_module_sum_episodes_length_in": 10.36823839457432, "num_env_steps_sampled_lifetime": -10487500.0, "num_env_steps_sampled_lifetime_throughput": 2951.324049558134}, "learners": {"__all_modules__": {"num_env_steps_trained_lifetime": 598500, "learner_connector": {"timers": {"connectors": {"add_observations_from_episodes_to_batch": 0.0008404983995460356, "add_time_dim_to_batch_and_zero_pad": 1.9700538580755888e-05, "add_columns_from_episodes_to_train_batch": 0.03741322640892666, "add_one_ts_to_episodes_and_truncate": 0.009492948507136714, "add_states_from_episodes_to_batch": 3.840129434119642e-06, "numpy_to_tensor": 9.736891210273508e-05, "batch_individual_items": 0.041548178122946845, "general_advantage_estimation": 0.00800199180221095}}, "connector_pipeline_timer": 0.09758854882527501}, "learner_connector_sum_episodes_length_in": 5000.0, "num_env_steps_trained": 31500, "num_module_steps_trained": 6000, "num_non_trainable_parameters": 0, "num_module_steps_trained_lifetime": 114000, "num_trainable_parameters": 6003, "learner_connector_sum_episodes_length_out": 5250.0, "num_env_steps_trained_lifetime_throughput": 2010385.7585604594, "num_module_steps_trained_throughput": 383797.35544021055, "num_module_steps_trained_lifetime_throughput": 383423.020892658}, "default_policy": {"gradients_default_optimizer_global_norm": 0.018438857048749924, "weights_seq_no": 19.0, "num_module_steps_trained_lifetime": 114000, "num_trainable_parameters": 6003, "diff_num_grad_updates_vs_sampler_policy": 1.0, "policy_loss": -0.08715296536684036, "default_optimizer_learning_rate": 0.0002847858517, "vf_explained_var": -0.013711333274841309, "vf_loss": 0.10278083384037018, "vf_loss_unclipped": 29.897029876708984, "curr_entropy_coeff": 0.0090570820258, "module_train_batch_size_mean": 1000.0, "num_module_steps_trained": 6000, "total_loss": -0.02297934889793396, "mean_kl_loss": 0.0012530607637017965, "entropy": 0.5042437314987183, "curr_kl_coeff": 1.423828734914423e-06, "num_module_steps_trained_lifetime_throughput": 383810.3456526174}}, "num_training_step_calls_per_iteration": 1, "evaluation": {"env_runners": {"env_to_module_connector": {"timers": {"connectors": {"add_observations_from_episodes_to_batch": 3.2162461034300563e-06, "add_time_dim_to_batch_and_zero_pad": 2.3439840433286117e-06, "add_states_from_episodes_to_batch": 1.6053010767005155e-06, "numpy_to_tensor": 8.702480800415492e-06, "batch_individual_items": 6.454637083908063e-06}}, "connector_pipeline_timer": 4.3830785473420524e-05}, "episode_return_mean": 0.25, "num_module_steps_sampled": {"default_policy": 400}, "num_episodes_lifetime": 380, "module_to_env_connector": {"timers": {"connectors": {"un_batch_to_individual_items": 5.641112988294445e-06, "tensor_to_numpy": 1.3633576586788971e-05, "listify_data_for_vector_env": 1.1587068197829309e-05, "remove_single_ts_time_rank_from_batch": 5.770125058514469e-07, "get_actions": 3.730929700396268e-05, "normalize_and_clip_actions": 9.87187846371091e-06}}, "connector_pipeline_timer": 0.00010451845308724836}, "rlmodule_inference_timer": 2.9119040129954454e-05, "module_episode_returns_mean": {"default_policy": 0.25}, "env_to_module_sum_episodes_length_out": 10.368238394574323, "num_episodes": 20, "episode_return_max": 13.5, "env_reset_timer": 0.00041711299363348487, "episode_len_min": 20, "episode_return_min": -13.5, "episode_len_max": 20, "env_to_module_sum_episodes_length_in": 10.368238394574323, "num_env_steps_sampled_lifetime": 95400, "agent_episode_returns_mean": {"default_agent": 0.25}, "num_module_steps_sampled_lifetime": {"default_policy": 7600}, "sample": 0.11468463396506717, "episode_duration_sec_mean": 0.005666304162004963, "num_agent_steps_sampled": {"default_agent": 400}, "num_env_steps_sampled": 400, "weights_seq_no": 19.0, "episode_len_mean": 20.0, "env_step_timer": 1.4751199633084266e-05, "num_agent_steps_sampled_lifetime": {"default_agent": 7600}, "time_between_sampling": 1.6558922395839641}, "num_healthy_workers": 1, "actor_manager_num_outstanding_async_reqs": 0, "num_remote_worker_restarts": 0}, "num_env_steps_sampled_lifetime": -10487500.0, "fault_tolerance": {"num_healthy_workers": 0, "num_remote_worker_restarts": 0}, "env_runner_group": {"actor_manager_num_outstanding_async_reqs": 0}, "done": false, "training_iteration": 19, "trial_id": "4dc31_00000", "date": "2025-08-11_19-19-56", "timestamp": 1754932796, "time_this_iter_s": 2.0872628688812256, "time_total_s": 33.99808740615845, "pid": 14098, "hostname": "Mac", "node_ip": "127.0.0.1", "config": {"exploration_config": {}, "extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "placement_strategy": "PACK", "num_gpus": 0, "_fake_gpus": false, "num_cpus_for_main_process": 2, "eager_tracing": true, "eager_max_retraces": 20, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "torch_compile_learner": false, "torch_compile_learner_what_to_compile": "forward_train", "torch_compile_learner_dynamo_backend": "aot_eager", "torch_compile_learner_dynamo_mode": null, "torch_compile_worker": false, "torch_compile_worker_dynamo_backend": "aot_eager", "torch_compile_worker_dynamo_mode": null, "torch_ddp_kwargs": {}, "torch_skip_nan_gradients": false, "env": "Umbrella", "env_config": {}, "observation_space": null, "action_space": null, "clip_rewards": null, "normalize_actions": true, "clip_actions": false, "_is_atari": null, "disable_env_checking": false, "render_env": false, "action_mask_key": "action_mask", "env_runner_cls": null, "num_env_runners": 0, "create_local_env_runner": true, "num_envs_per_env_runner": 1, "gym_env_vectorize_mode": "SYNC", "num_cpus_per_env_runner": 1, "num_gpus_per_env_runner": 0, "custom_resources_per_env_runner": {}, "validate_env_runners_after_construction": true, "episodes_to_numpy": true, "max_requests_in_flight_per_env_runner": 1, "sample_timeout_s": 60.0, "_env_to_module_connector": null, "add_default_connectors_to_env_to_module_pipeline": true, "_module_to_env_connector": null, "add_default_connectors_to_module_to_env_pipeline": true, "merge_env_runner_states": "training_only", "broadcast_env_runner_states": true, "episode_lookback_horizon": 1, "rollout_fragment_length": "auto", "batch_mode": "complete_episodes", "compress_observations": false, "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "enable_tf1_exec_eagerly": false, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "preprocessor_pref": "deepmind", "observation_filter": "NoFilter", "update_worker_filter_stats": true, "use_worker_filter_stats": true, "sampler_perf_stats_ema_coef": null, "_is_online": true, "num_learners": 0, "num_gpus_per_learner": 0, "num_cpus_per_learner": "auto", "num_aggregator_actors_per_learner": 0, "max_requests_in_flight_per_aggregator_actor": 3, "local_gpu_idx": 0, "max_requests_in_flight_per_learner": 3, "gamma": 1, "lr": 0.0002847858517, "grad_clip": 0.5, "grad_clip_by": "global_norm", "_train_batch_size_per_learner": 5000, "train_batch_size": 4000, "num_epochs": 1, "minibatch_size": 1000, "shuffle_batch_per_epoch": true, "model": {"fcnet_hiddens": [256, 256], "fcnet_activation": "tanh", "fcnet_weights_initializer": null, "fcnet_weights_initializer_config": null, "fcnet_bias_initializer": null, "fcnet_bias_initializer_config": null, "conv_filters": null, "conv_activation": "relu", "conv_kernel_initializer": null, "conv_kernel_initializer_config": null, "conv_bias_initializer": null, "conv_bias_initializer_config": null, "conv_transpose_kernel_initializer": null, "conv_transpose_kernel_initializer_config": null, "conv_transpose_bias_initializer": null, "conv_transpose_bias_initializer_config": null, "post_fcnet_hiddens": [], "post_fcnet_activation": "relu", "post_fcnet_weights_initializer": null, "post_fcnet_weights_initializer_config": null, "post_fcnet_bias_initializer": null, "post_fcnet_bias_initializer_config": null, "free_log_std": false, "log_std_clip_param": 20.0, "no_final_linear": false, "vf_share_layers": false, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "lstm_weights_initializer": null, "lstm_weights_initializer_config": null, "lstm_bias_initializer": null, "lstm_bias_initializer_config": null, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "attention_use_n_prev_actions": 0, "attention_use_n_prev_rewards": 0, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": null, "custom_model_config": {}, "custom_action_dist": null, "custom_preprocessor": null, "encoder_latent_dim": null, "always_check_shapes": false, "lstm_use_prev_action_reward": -1, "_use_default_native_models": -1, "_disable_preprocessor_api": false, "_disable_action_flattening": false}, "_learner_connector": null, "add_default_connectors_to_learner_pipeline": true, "learner_config_dict": {}, "optimizer": {}, "_learner_class": null, "callbacks_on_algorithm_init": null, "callbacks_on_env_runners_recreated": null, "callbacks_on_offline_eval_runners_recreated": null, "callbacks_on_checkpoint_loaded": null, "callbacks_on_environment_created": null, "callbacks_on_episode_created": null, "callbacks_on_episode_start": null, "callbacks_on_episode_step": null, "callbacks_on_episode_end": null, "callbacks_on_evaluate_start": null, "callbacks_on_evaluate_end": null, "callbacks_on_evaluate_offline_start": null, "callbacks_on_evaluate_offline_end": null, "callbacks_on_sample_end": null, "callbacks_on_train_result": null, "explore": true, "enable_rl_module_and_learner": true, "enable_env_runner_and_connector_v2": true, "_prior_exploration_config": {"type": "StochasticSampling"}, "count_steps_by": "env_steps", "policy_map_capacity": 100, "policy_mapping_fn": "<function AlgorithmConfig.DEFAULT_POLICY_MAPPING_FN at 0x385441b20>", "policies_to_train": null, "policy_states_are_swappable": false, "observation_fn": null, "offline_data_class": null, "input_read_method": "read_parquet", "input_read_method_kwargs": {}, "input_read_schema": {}, "input_read_episodes": false, "input_read_sample_batches": false, "input_read_batch_size": null, "input_filesystem": null, "input_filesystem_kwargs": {}, "input_compress_columns": ["obs", "new_obs"], "input_spaces_jsonable": true, "materialize_data": false, "materialize_mapped_data": true, "map_batches_kwargs": {}, "iter_batches_kwargs": {}, "ignore_final_observation": false, "prelearner_class": null, "prelearner_buffer_class": null, "prelearner_buffer_kwargs": {}, "prelearner_module_synch_period": 10, "dataset_num_iters_per_learner": null, "input_config": {}, "actions_in_input_normalized": false, "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_config": {}, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "output_max_rows_per_file": null, "output_write_remaining_data": false, "output_write_method": "write_parquet", "output_write_method_kwargs": {}, "output_filesystem": null, "output_filesystem_kwargs": {}, "output_write_episodes": true, "offline_sampling": false, "evaluation_interval": 1, "evaluation_duration": 20, "evaluation_duration_unit": "episodes", "evaluation_sample_timeout_s": 120.0, "evaluation_auto_duration_min_env_steps_per_sample": 100, "evaluation_auto_duration_max_env_steps_per_sample": 2000, "evaluation_parallel_to_training": false, "evaluation_force_reset_envs_before_iteration": true, "evaluation_config": null, "off_policy_estimation_methods": {}, "ope_split_batch_by_episode": true, "evaluation_num_env_runners": 1, "in_evaluation": false, "sync_filters_on_rollout_workers_timeout_s": 10.0, "offline_evaluation_interval": null, "num_offline_eval_runners": 0, "offline_loss_for_module_fn": null, "offline_evaluation_duration": 1, "offline_evaluation_parallel_to_training": false, "offline_evaluation_timeout_s": 120.0, "num_cpus_per_offline_eval_runner": 1, "num_gpus_per_offline_eval_runner": 0, "custom_resources_per_offline_eval_runner": {}, "restart_failed_offline_eval_runners": true, "ignore_offline_eval_runner_failures": false, "max_num_offline_eval_runner_restarts": 1000, "offline_eval_runner_restore_timeout_s": 1800.0, "max_requests_in_flight_per_offline_eval_runner": 1, "validate_offline_eval_runners_after_construction": true, "offline_eval_runner_health_probe_timeout_s": 30.0, "offline_eval_rl_module_inference_only": false, "broadcast_offline_eval_runner_states": false, "offline_eval_batch_size_per_runner": 256, "dataset_num_iters_per_eval_runner": 1, "keep_per_episode_custom_metrics": false, "metrics_episode_collection_timeout_s": 60.0, "metrics_num_episodes_for_smoothing": 100, "min_time_s_per_iteration": null, "min_train_timesteps_per_iteration": 0, "min_sample_timesteps_per_iteration": 0, "log_gradients": true, "export_native_model_files": false, "checkpoint_trainable_policies_only": false, "logger_creator": null, "logger_config": null, "log_level": "WARN", "log_sys_usage": true, "fake_sampler": false, "seed": 6, "restart_failed_env_runners": true, "ignore_env_runner_failures": false, "max_num_env_runner_restarts": 1000, "delay_between_env_runner_restarts_s": 60.0, "restart_failed_sub_environments": false, "num_consecutive_env_runner_failures_tolerance": 100, "env_runner_health_probe_timeout_s": 30.0, "env_runner_restore_timeout_s": 1800.0, "_model_config": {}, "_rl_module_spec": "RLModuleSpec(module_class=None, observation_space=None, action_space=None, inference_only=False, learner_only=False, model_config=DefaultModelConfig(fcnet_hiddens=[60, 90], fcnet_activation='tanh', fcnet_kernel_initializer=None, fcnet_kernel_initializer_kwargs=None, fcnet_bias_initializer=None, fcnet_bias_initializer_kwargs=None, conv_filters=None, conv_activation='relu', conv_kernel_initializer=None, conv_kernel_initializer_kwargs=None, conv_bias_initializer=None, conv_bias_initializer_kwargs=None, head_fcnet_hiddens=[], head_fcnet_activation='relu', head_fcnet_kernel_initializer=None, head_fcnet_kernel_initializer_kwargs=None, head_fcnet_bias_initializer=None, head_fcnet_bias_initializer_kwargs=None, free_log_std=False, log_std_clip_param=20.0, vf_share_layers=True, use_lstm=False, max_seq_len=20, lstm_cell_size=256, lstm_use_prev_action=False, lstm_use_prev_reward=False, lstm_kernel_initializer=None, lstm_kernel_initializer_kwargs=None, lstm_bias_initializer=None, lstm_bias_initializer_kwargs=None), catalog_class=None, load_state_path=None, model_config_dict=None)", "algorithm_config_overrides_per_module": {}, "_per_module_overrides": {}, "_validate_config": true, "_use_msgpack_checkpoints": false, "_torch_grad_scaler_class": null, "_torch_lr_scheduler_classes": null, "_tf_policy_handles_more_than_one_loss": false, "_disable_preprocessor_api": false, "_disable_action_flattening": false, "_disable_initialize_loss_from_dummy_batch": false, "_dont_auto_sync_env_runner_states": false, "env_task_fn": -1, "enable_connectors": -1, "simple_optimizer": false, "policy_map_cache": -1, "worker_cls": -1, "synchronize_filters": -1, "enable_async_evaluation": -1, "custom_async_evaluation_function": -1, "_enable_rl_module_api": -1, "auto_wrap_old_gym_envs": -1, "always_attach_evaluation_results": -1, "replay_sequence_length": null, "_disable_execution_plan_api": -1, "use_critic": true, "use_gae": true, "use_kl_loss": true, "kl_coeff": 0.7464963036515, "kl_target": 0.0270990929592, "vf_loss_coeff": 0.6688075857018, "entropy_coeff": 0.0090570820258, "clip_param": 0.1221781641624, "vf_clip_param": 0.1027808522125, "entropy_coeff_schedule": null, "lr_schedule": null, "sgd_minibatch_size": -1, "vf_share_layers": -1, "__stdout_file__": null, "__stderr_file__": null, "lambda": 0.9099046732075, "input": "sampler", "policies": {"default_policy": [null, null, null, null]}, "callbacks": "<class 'ray.rllib.callbacks.callbacks.RLlibCallback'>", "create_env_on_driver": false, "custom_eval_function": null, "framework": "torch"}, "time_since_restore": 33.99808740615845, "iterations_since_restore": 19, "perf": {"cpu_util_percent": 34.699999999999996, "ram_util_percent": 80.26666666666667}}
{"timers": {"training_iteration": 1.7211022576075026, "restore_env_runners": 1.6459766959362426e-05, "training_step": 1.7209524396999585, "env_runner_sampling_timer": 1.5912366951496837, "learner_update_timer": 0.12615592327350092, "synch_weights": 0.0008383443965070979, "restore_eval_env_runners": 1.0128848052684741e-05, "evaluation_iteration": 0.1294819638067349, "synch_eval_env_connectors": 0.00014619744244497658, "synch_env_connectors": 4.998298266237823e-06}, "env_runners": {"num_episodes": 250.0, "num_agent_steps_sampled": {"default_agent": 5000.0}, "weights_seq_no": 19.0, "num_agent_steps_sampled_lifetime": {"default_agent": -11105000.0}, "num_episodes_lifetime": -555250.0, "env_to_module_connector": {"timers": {"connectors": {"add_states_from_episodes_to_batch": 1.7376085656879942e-06, "add_time_dim_to_batch_and_zero_pad": 2.341897431604058e-06, "numpy_to_tensor": 8.640398668483814e-06, "batch_individual_items": 6.223059661856966e-06, "add_observations_from_episodes_to_batch": 2.9895303759687987e-06}}, "connector_pipeline_timer": 4.395215869976435e-05}, "sample": 0.005342131209108439, "num_module_steps_sampled": {"default_policy": 5000.0}, "rlmodule_inference_timer": 2.7861574174616774e-05, "episode_return_max": 10.5, "agent_episode_returns_mean": {"default_agent": 8.580000000000002}, "episode_len_mean": 20.0, "time_between_sampling": 0.0019457857841168348, "env_step_timer": 1.3752624412339647e-05, "env_to_module_sum_episodes_length_out": 10.36823839457432, "env_reset_timer": 4.2228762647342525e-05, "module_to_env_connector": {"timers": {"connectors": {"listify_data_for_vector_env": 1.1048928719965708e-05, "normalize_and_clip_actions": 9.480350178870587e-06, "get_actions": 3.958859511939053e-05, "un_batch_to_individual_items": 5.426113876950621e-06, "tensor_to_numpy": 1.3211989356160139e-05, "remove_single_ts_time_rank_from_batch": 5.993273794688553e-07}}, "connector_pipeline_timer": 0.00010506918605122593}, "episode_duration_sec_mean": 0.004573380226735027, "num_module_steps_sampled_lifetime": {"default_policy": -11105000.0}, "episode_len_min": 20, "episode_return_mean": 8.580000000000002, "episode_return_min": -9.5, "module_episode_returns_mean": {"default_policy": 8.580000000000002}, "episode_len_max": 20, "num_env_steps_sampled": 5000.0, "env_to_module_sum_episodes_length_in": 10.36823839457432, "num_env_steps_sampled_lifetime": -11105000.0, "num_env_steps_sampled_lifetime_throughput": 3663.5412989384677}, "learners": {"__all_modules__": {"num_env_steps_trained_lifetime": 630000, "learner_connector": {"timers": {"connectors": {"add_observations_from_episodes_to_batch": 0.000840285504704029, "add_time_dim_to_batch_and_zero_pad": 1.9603113697085873e-05, "add_columns_from_episodes_to_train_batch": 0.037383778725178375, "add_one_ts_to_episodes_and_truncate": 0.009474619852136022, "add_states_from_episodes_to_batch": 3.832568886836838e-06, "numpy_to_tensor": 9.69606428865954e-05, "batch_individual_items": 0.04143602134170359, "general_advantage_estimation": 0.007975864793970847}}, "connector_pipeline_timer": 0.09740094708790277}, "learner_connector_sum_episodes_length_in": 5000.0, "num_env_steps_trained": 31500, "num_module_steps_trained": 6000, "num_non_trainable_parameters": 0, "num_module_steps_trained_lifetime": 120000, "num_trainable_parameters": 6003, "learner_connector_sum_episodes_length_out": 5250.0, "num_env_steps_trained_lifetime_throughput": 2019887.4173436516, "num_module_steps_trained_throughput": 385576.9566809272, "num_module_steps_trained_lifetime_throughput": 385211.5024899307}, "default_policy": {"gradients_default_optimizer_global_norm": 0.11064177006483078, "weights_seq_no": 20.0, "num_module_steps_trained_lifetime": 120000, "num_trainable_parameters": 6003, "diff_num_grad_updates_vs_sampler_policy": 1.0, "policy_loss": -0.07692054659128189, "default_optimizer_learning_rate": 0.0002847858517, "vf_explained_var": -0.015539288520812988, "vf_loss": 0.10278083384037018, "vf_loss_unclipped": 29.854867935180664, "curr_entropy_coeff": 0.0090570820258, "module_train_batch_size_mean": 1000.0, "num_module_steps_trained": 6000, "total_loss": -0.012637391686439514, "mean_kl_loss": 4.868659016210586e-05, "entropy": 0.4921499788761139, "curr_kl_coeff": 7.119143674572115e-07, "num_module_steps_trained_lifetime_throughput": 385550.97471695364}}, "num_training_step_calls_per_iteration": 1, "evaluation": {"env_runners": {"env_to_module_connector": {"timers": {"connectors": {"add_observations_from_episodes_to_batch": 3.1435935365127765e-06, "add_time_dim_to_batch_and_zero_pad": 3.4657703544244962e-06, "add_states_from_episodes_to_batch": 2.167199100373018e-06, "numpy_to_tensor": 1.0581546078642182e-05, "batch_individual_items": 8.861606987974293e-06}}, "connector_pipeline_timer": 5.3601959417006504e-05}, "episode_return_mean": -0.15, "num_module_steps_sampled": {"default_policy": 400}, "num_episodes_lifetime": 400, "module_to_env_connector": {"timers": {"connectors": {"un_batch_to_individual_items": 7.204459181445339e-06, "tensor_to_numpy": 1.693004597371959e-05, "listify_data_for_vector_env": 1.3301523634130194e-05, "remove_single_ts_time_rank_from_batch": 6.441518033805354e-07, "get_actions": 4.876735483182924e-05, "normalize_and_clip_actions": 1.1335999607405004e-05}}, "connector_pipeline_timer": 0.0001294626616927131}, "rlmodule_inference_timer": 3.4006255147852085e-05, "module_episode_returns_mean": {"default_policy": -0.15}, "env_to_module_sum_episodes_length_out": 10.368238394574323, "num_episodes": 20, "episode_return_max": 13.5, "env_reset_timer": 0.000413646864408755, "episode_len_min": 20, "episode_return_min": -13.5, "episode_len_max": 20, "env_to_module_sum_episodes_length_in": 10.368238394574323, "num_env_steps_sampled_lifetime": 100400, "agent_episode_returns_mean": {"default_agent": -0.15}, "num_module_steps_sampled_lifetime": {"default_policy": 8000}, "sample": 0.11465981387448436, "episode_duration_sec_mean": 0.005812147910473868, "num_agent_steps_sampled": {"default_agent": 400}, "num_env_steps_sampled": 400, "weights_seq_no": 20.0, "episode_len_mean": 20.0, "env_step_timer": 1.869696129104335e-05, "num_agent_steps_sampled_lifetime": {"default_agent": 8000}, "time_between_sampling": 1.6543187109372088}, "num_healthy_workers": 1, "actor_manager_num_outstanding_async_reqs": 0, "num_remote_worker_restarts": 0}, "num_env_steps_sampled_lifetime": -11105000.0, "fault_tolerance": {"num_healthy_workers": 0, "num_remote_worker_restarts": 0}, "env_runner_group": {"actor_manager_num_outstanding_async_reqs": 0}, "done": true, "training_iteration": 20, "trial_id": "4dc31_00000", "date": "2025-08-11_19-19-58", "timestamp": 1754932798, "time_this_iter_s": 1.601755142211914, "time_total_s": 35.59984254837036, "pid": 14098, "hostname": "Mac", "node_ip": "127.0.0.1", "config": {"exploration_config": {}, "extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "placement_strategy": "PACK", "num_gpus": 0, "_fake_gpus": false, "num_cpus_for_main_process": 2, "eager_tracing": true, "eager_max_retraces": 20, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "torch_compile_learner": false, "torch_compile_learner_what_to_compile": "forward_train", "torch_compile_learner_dynamo_backend": "aot_eager", "torch_compile_learner_dynamo_mode": null, "torch_compile_worker": false, "torch_compile_worker_dynamo_backend": "aot_eager", "torch_compile_worker_dynamo_mode": null, "torch_ddp_kwargs": {}, "torch_skip_nan_gradients": false, "env": "Umbrella", "env_config": {}, "observation_space": null, "action_space": null, "clip_rewards": null, "normalize_actions": true, "clip_actions": false, "_is_atari": null, "disable_env_checking": false, "render_env": false, "action_mask_key": "action_mask", "env_runner_cls": null, "num_env_runners": 0, "create_local_env_runner": true, "num_envs_per_env_runner": 1, "gym_env_vectorize_mode": "SYNC", "num_cpus_per_env_runner": 1, "num_gpus_per_env_runner": 0, "custom_resources_per_env_runner": {}, "validate_env_runners_after_construction": true, "episodes_to_numpy": true, "max_requests_in_flight_per_env_runner": 1, "sample_timeout_s": 60.0, "_env_to_module_connector": null, "add_default_connectors_to_env_to_module_pipeline": true, "_module_to_env_connector": null, "add_default_connectors_to_module_to_env_pipeline": true, "merge_env_runner_states": "training_only", "broadcast_env_runner_states": true, "episode_lookback_horizon": 1, "rollout_fragment_length": "auto", "batch_mode": "complete_episodes", "compress_observations": false, "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "enable_tf1_exec_eagerly": false, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "preprocessor_pref": "deepmind", "observation_filter": "NoFilter", "update_worker_filter_stats": true, "use_worker_filter_stats": true, "sampler_perf_stats_ema_coef": null, "_is_online": true, "num_learners": 0, "num_gpus_per_learner": 0, "num_cpus_per_learner": "auto", "num_aggregator_actors_per_learner": 0, "max_requests_in_flight_per_aggregator_actor": 3, "local_gpu_idx": 0, "max_requests_in_flight_per_learner": 3, "gamma": 1, "lr": 0.0002847858517, "grad_clip": 0.5, "grad_clip_by": "global_norm", "_train_batch_size_per_learner": 5000, "train_batch_size": 4000, "num_epochs": 1, "minibatch_size": 1000, "shuffle_batch_per_epoch": true, "model": {"fcnet_hiddens": [256, 256], "fcnet_activation": "tanh", "fcnet_weights_initializer": null, "fcnet_weights_initializer_config": null, "fcnet_bias_initializer": null, "fcnet_bias_initializer_config": null, "conv_filters": null, "conv_activation": "relu", "conv_kernel_initializer": null, "conv_kernel_initializer_config": null, "conv_bias_initializer": null, "conv_bias_initializer_config": null, "conv_transpose_kernel_initializer": null, "conv_transpose_kernel_initializer_config": null, "conv_transpose_bias_initializer": null, "conv_transpose_bias_initializer_config": null, "post_fcnet_hiddens": [], "post_fcnet_activation": "relu", "post_fcnet_weights_initializer": null, "post_fcnet_weights_initializer_config": null, "post_fcnet_bias_initializer": null, "post_fcnet_bias_initializer_config": null, "free_log_std": false, "log_std_clip_param": 20.0, "no_final_linear": false, "vf_share_layers": false, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "lstm_weights_initializer": null, "lstm_weights_initializer_config": null, "lstm_bias_initializer": null, "lstm_bias_initializer_config": null, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "attention_use_n_prev_actions": 0, "attention_use_n_prev_rewards": 0, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": null, "custom_model_config": {}, "custom_action_dist": null, "custom_preprocessor": null, "encoder_latent_dim": null, "always_check_shapes": false, "lstm_use_prev_action_reward": -1, "_use_default_native_models": -1, "_disable_preprocessor_api": false, "_disable_action_flattening": false}, "_learner_connector": null, "add_default_connectors_to_learner_pipeline": true, "learner_config_dict": {}, "optimizer": {}, "_learner_class": null, "callbacks_on_algorithm_init": null, "callbacks_on_env_runners_recreated": null, "callbacks_on_offline_eval_runners_recreated": null, "callbacks_on_checkpoint_loaded": null, "callbacks_on_environment_created": null, "callbacks_on_episode_created": null, "callbacks_on_episode_start": null, "callbacks_on_episode_step": null, "callbacks_on_episode_end": null, "callbacks_on_evaluate_start": null, "callbacks_on_evaluate_end": null, "callbacks_on_evaluate_offline_start": null, "callbacks_on_evaluate_offline_end": null, "callbacks_on_sample_end": null, "callbacks_on_train_result": null, "explore": true, "enable_rl_module_and_learner": true, "enable_env_runner_and_connector_v2": true, "_prior_exploration_config": {"type": "StochasticSampling"}, "count_steps_by": "env_steps", "policy_map_capacity": 100, "policy_mapping_fn": "<function AlgorithmConfig.DEFAULT_POLICY_MAPPING_FN at 0x385441b20>", "policies_to_train": null, "policy_states_are_swappable": false, "observation_fn": null, "offline_data_class": null, "input_read_method": "read_parquet", "input_read_method_kwargs": {}, "input_read_schema": {}, "input_read_episodes": false, "input_read_sample_batches": false, "input_read_batch_size": null, "input_filesystem": null, "input_filesystem_kwargs": {}, "input_compress_columns": ["obs", "new_obs"], "input_spaces_jsonable": true, "materialize_data": false, "materialize_mapped_data": true, "map_batches_kwargs": {}, "iter_batches_kwargs": {}, "ignore_final_observation": false, "prelearner_class": null, "prelearner_buffer_class": null, "prelearner_buffer_kwargs": {}, "prelearner_module_synch_period": 10, "dataset_num_iters_per_learner": null, "input_config": {}, "actions_in_input_normalized": false, "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_config": {}, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "output_max_rows_per_file": null, "output_write_remaining_data": false, "output_write_method": "write_parquet", "output_write_method_kwargs": {}, "output_filesystem": null, "output_filesystem_kwargs": {}, "output_write_episodes": true, "offline_sampling": false, "evaluation_interval": 1, "evaluation_duration": 20, "evaluation_duration_unit": "episodes", "evaluation_sample_timeout_s": 120.0, "evaluation_auto_duration_min_env_steps_per_sample": 100, "evaluation_auto_duration_max_env_steps_per_sample": 2000, "evaluation_parallel_to_training": false, "evaluation_force_reset_envs_before_iteration": true, "evaluation_config": null, "off_policy_estimation_methods": {}, "ope_split_batch_by_episode": true, "evaluation_num_env_runners": 1, "in_evaluation": false, "sync_filters_on_rollout_workers_timeout_s": 10.0, "offline_evaluation_interval": null, "num_offline_eval_runners": 0, "offline_loss_for_module_fn": null, "offline_evaluation_duration": 1, "offline_evaluation_parallel_to_training": false, "offline_evaluation_timeout_s": 120.0, "num_cpus_per_offline_eval_runner": 1, "num_gpus_per_offline_eval_runner": 0, "custom_resources_per_offline_eval_runner": {}, "restart_failed_offline_eval_runners": true, "ignore_offline_eval_runner_failures": false, "max_num_offline_eval_runner_restarts": 1000, "offline_eval_runner_restore_timeout_s": 1800.0, "max_requests_in_flight_per_offline_eval_runner": 1, "validate_offline_eval_runners_after_construction": true, "offline_eval_runner_health_probe_timeout_s": 30.0, "offline_eval_rl_module_inference_only": false, "broadcast_offline_eval_runner_states": false, "offline_eval_batch_size_per_runner": 256, "dataset_num_iters_per_eval_runner": 1, "keep_per_episode_custom_metrics": false, "metrics_episode_collection_timeout_s": 60.0, "metrics_num_episodes_for_smoothing": 100, "min_time_s_per_iteration": null, "min_train_timesteps_per_iteration": 0, "min_sample_timesteps_per_iteration": 0, "log_gradients": true, "export_native_model_files": false, "checkpoint_trainable_policies_only": false, "logger_creator": null, "logger_config": null, "log_level": "WARN", "log_sys_usage": true, "fake_sampler": false, "seed": 6, "restart_failed_env_runners": true, "ignore_env_runner_failures": false, "max_num_env_runner_restarts": 1000, "delay_between_env_runner_restarts_s": 60.0, "restart_failed_sub_environments": false, "num_consecutive_env_runner_failures_tolerance": 100, "env_runner_health_probe_timeout_s": 30.0, "env_runner_restore_timeout_s": 1800.0, "_model_config": {}, "_rl_module_spec": "RLModuleSpec(module_class=None, observation_space=None, action_space=None, inference_only=False, learner_only=False, model_config=DefaultModelConfig(fcnet_hiddens=[60, 90], fcnet_activation='tanh', fcnet_kernel_initializer=None, fcnet_kernel_initializer_kwargs=None, fcnet_bias_initializer=None, fcnet_bias_initializer_kwargs=None, conv_filters=None, conv_activation='relu', conv_kernel_initializer=None, conv_kernel_initializer_kwargs=None, conv_bias_initializer=None, conv_bias_initializer_kwargs=None, head_fcnet_hiddens=[], head_fcnet_activation='relu', head_fcnet_kernel_initializer=None, head_fcnet_kernel_initializer_kwargs=None, head_fcnet_bias_initializer=None, head_fcnet_bias_initializer_kwargs=None, free_log_std=False, log_std_clip_param=20.0, vf_share_layers=True, use_lstm=False, max_seq_len=20, lstm_cell_size=256, lstm_use_prev_action=False, lstm_use_prev_reward=False, lstm_kernel_initializer=None, lstm_kernel_initializer_kwargs=None, lstm_bias_initializer=None, lstm_bias_initializer_kwargs=None), catalog_class=None, load_state_path=None, model_config_dict=None)", "algorithm_config_overrides_per_module": {}, "_per_module_overrides": {}, "_validate_config": true, "_use_msgpack_checkpoints": false, "_torch_grad_scaler_class": null, "_torch_lr_scheduler_classes": null, "_tf_policy_handles_more_than_one_loss": false, "_disable_preprocessor_api": false, "_disable_action_flattening": false, "_disable_initialize_loss_from_dummy_batch": false, "_dont_auto_sync_env_runner_states": false, "env_task_fn": -1, "enable_connectors": -1, "simple_optimizer": false, "policy_map_cache": -1, "worker_cls": -1, "synchronize_filters": -1, "enable_async_evaluation": -1, "custom_async_evaluation_function": -1, "_enable_rl_module_api": -1, "auto_wrap_old_gym_envs": -1, "always_attach_evaluation_results": -1, "replay_sequence_length": null, "_disable_execution_plan_api": -1, "use_critic": true, "use_gae": true, "use_kl_loss": true, "kl_coeff": 0.7464963036515, "kl_target": 0.0270990929592, "vf_loss_coeff": 0.6688075857018, "entropy_coeff": 0.0090570820258, "clip_param": 0.1221781641624, "vf_clip_param": 0.1027808522125, "entropy_coeff_schedule": null, "lr_schedule": null, "sgd_minibatch_size": -1, "vf_share_layers": -1, "__stdout_file__": null, "__stderr_file__": null, "lambda": 0.9099046732075, "input": "sampler", "policies": {"default_policy": [null, null, null, null]}, "callbacks": "<class 'ray.rllib.callbacks.callbacks.RLlibCallback'>", "create_env_on_driver": false, "custom_eval_function": null, "framework": "torch"}, "time_since_restore": 35.59984254837036, "iterations_since_restore": 20, "perf": {"cpu_util_percent": 44.05, "ram_util_percent": 80.15}}
