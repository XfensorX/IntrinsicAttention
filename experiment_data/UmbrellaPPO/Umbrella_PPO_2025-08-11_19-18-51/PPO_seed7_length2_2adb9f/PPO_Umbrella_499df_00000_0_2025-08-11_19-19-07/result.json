{"timers": {"training_iteration": 1.5409157919930294, "restore_env_runners": 1.1709053069353104e-05, "training_step": 1.5407282499363646, "env_runner_sampling_timer": 1.4349215420661494, "learner_update_timer": 0.10278704192023724, "synch_weights": 0.0004806669894605875}, "env_runners": {"weights_seq_no": 0.0, "module_to_env_connector": {"timers": {"connectors": {"tensor_to_numpy": 1.3521648967054811e-05, "listify_data_for_vector_env": 1.1179960584563272e-05, "remove_single_ts_time_rank_from_batch": 6.022363102256069e-07, "get_actions": 5.666866148325951e-05, "normalize_and_clip_actions": 1.2361585444098757e-05, "un_batch_to_individual_items": 5.530245339492968e-06}}, "connector_pipeline_timer": 0.00012571966570736043}, "episode_len_mean": 20.0, "num_agent_steps_sampled_lifetime": {"default_agent": 627500.0}, "num_agent_steps_sampled": {"default_agent": 5000.0}, "sample": 0.0061009353012011665, "env_to_module_connector": {"timers": {"connectors": {"batch_individual_items": 6.8486640293081676e-06, "add_observations_from_episodes_to_batch": 3.214944719463051e-06, "add_states_from_episodes_to_batch": 1.8072791770619668e-06, "add_time_dim_to_batch_and_zero_pad": 2.4362669263637434e-06, "numpy_to_tensor": 9.167324788583617e-06}}, "connector_pipeline_timer": 4.6967275356615547e-05}, "env_step_timer": 1.463941745903545e-05, "num_episodes": 250.0, "episode_len_min": 20, "num_module_steps_sampled_lifetime": {"default_policy": 627500.0}, "env_to_module_sum_episodes_length_in": 10.191744832559449, "agent_episode_returns_mean": {"default_agent": 0.17999999999999997}, "num_env_steps_sampled": 5000.0, "episode_return_mean": 0.17999999999999997, "num_module_steps_sampled": {"default_policy": 5000.0}, "episode_duration_sec_mean": 0.004832842126023023, "module_episode_returns_mean": {"default_policy": 0.17999999999999997}, "num_episodes_lifetime": 31375.0, "episode_return_max": 10.5, "episode_len_max": 20, "env_to_module_sum_episodes_length_out": 10.191744832559449, "episode_return_min": -9.5, "num_env_steps_sampled_lifetime": 627500.0, "env_reset_timer": 0.00010655697595352213, "time_between_sampling": 0.0005220867393332488, "rlmodule_inference_timer": 5.0116008644351605e-05, "num_env_steps_sampled_lifetime_throughput": 3552.3117335467773}, "learners": {"default_policy": {"diff_num_grad_updates_vs_sampler_policy": 1.0, "mean_kl_loss": 0.001026108511723578, "num_module_steps_trained": 6000, "vf_explained_var": -0.010670661926269531, "entropy": 0.6878411173820496, "curr_entropy_coeff": 0.0090570820258, "num_trainable_parameters": 6003, "vf_loss_unclipped": 28.942136764526367, "gradients_default_optimizer_global_norm": 0.12170831859111786, "default_optimizer_learning_rate": 0.0002847858517, "module_train_batch_size_mean": 1000.0, "num_module_steps_trained_lifetime": 6000, "total_loss": 0.12544988095760345, "curr_kl_coeff": 0.3732481598854065, "policy_loss": 0.06217312067747116, "vf_loss": 0.10278083384037018, "weights_seq_no": 1.0, "num_module_steps_trained_lifetime_throughput": 474058.68035056663}, "__all_modules__": {"learner_connector": {"connector_pipeline_timer": 0.07766291697043926, "timers": {"connectors": {"add_one_ts_to_episodes_and_truncate": 0.007335792062804103, "add_columns_from_episodes_to_train_batch": 0.032976459013298154, "general_advantage_estimation": 0.007044667028822005, "numpy_to_tensor": 6.89580338075757e-05, "batch_individual_items": 0.029303124989382923, "add_observations_from_episodes_to_batch": 0.0008062910055741668, "add_states_from_episodes_to_batch": 3.7499703466892242e-06, "add_time_dim_to_batch_and_zero_pad": 1.0207993909716606e-05}}}, "num_non_trainable_parameters": 0, "learner_connector_sum_episodes_length_in": 5000, "learner_connector_sum_episodes_length_out": 5250, "num_module_steps_trained": 6000, "num_trainable_parameters": 6003, "num_env_steps_trained_lifetime": 31500, "num_env_steps_trained": 31500, "num_module_steps_trained_lifetime": 6000, "num_env_steps_trained_lifetime_throughput": 2462810.351459831, "num_module_steps_trained_throughput": 471904.4876604026, "num_module_steps_trained_lifetime_throughput": 470898.8570993308}}, "num_training_step_calls_per_iteration": 1, "num_env_steps_sampled_lifetime": 627500.0, "evaluation": {"env_runners": {"module_to_env_connector": {"timers": {"connectors": {"un_batch_to_individual_items": 5.312350103583074e-06, "listify_data_for_vector_env": 1.0541064443160124e-05, "remove_single_ts_time_rank_from_batch": 5.750027802238674e-07, "normalize_and_clip_actions": 1.0703599318368466e-05, "tensor_to_numpy": 1.417166012580258e-05, "get_actions": 4.007914910911837e-05}}, "connector_pipeline_timer": 0.00010643031302396887}, "agent_episode_returns_mean": {"default_agent": 2.05}, "sample": 0.098069625091739, "env_step_timer": 2.1994232712960928e-05, "num_episodes": 20, "module_episode_returns_mean": {"default_policy": 2.05}, "episode_return_max": 12.5, "episode_return_min": -12.5, "rlmodule_inference_timer": 2.7819413186379214e-05, "env_to_module_connector": {"timers": {"connectors": {"numpy_to_tensor": 8.134755113998685e-06, "batch_individual_items": 6.015841707122389e-06, "add_observations_from_episodes_to_batch": 2.7996121236019786e-06, "add_states_from_episodes_to_batch": 1.5713694062908405e-06, "add_time_dim_to_batch_and_zero_pad": 2.275865316591276e-06}}, "connector_pipeline_timer": 4.286014593526634e-05}, "env_to_module_sum_episodes_length_in": 10.216013141322508, "episode_return_mean": 2.05, "episode_duration_sec_mean": 0.004479985393118113, "episode_len_max": 20, "env_to_module_sum_episodes_length_out": 10.216013141322508, "env_reset_timer": 0.0002686659572646022, "num_agent_steps_sampled_lifetime": {"default_agent": 400}, "episode_len_mean": 20.0, "num_module_steps_sampled_lifetime": {"default_policy": 400}, "episode_len_min": 20, "num_agent_steps_sampled": {"default_agent": 400}, "weights_seq_no": 1.0, "num_module_steps_sampled": {"default_policy": 400}, "num_env_steps_sampled": 400, "num_episodes_lifetime": 20, "num_env_steps_sampled_lifetime": 5400}, "num_healthy_workers": 1, "actor_manager_num_outstanding_async_reqs": 0, "num_remote_worker_restarts": 0}, "fault_tolerance": {"num_healthy_workers": 0, "num_remote_worker_restarts": 0}, "env_runner_group": {"actor_manager_num_outstanding_async_reqs": 0}, "done": false, "training_iteration": 1, "trial_id": "499df_00000", "date": "2025-08-11_19-36-59", "timestamp": 1754933819, "time_this_iter_s": 1.6483960151672363, "time_total_s": 1.6483960151672363, "pid": 28380, "hostname": "Mac", "node_ip": "127.0.0.1", "config": {"exploration_config": {}, "extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "placement_strategy": "PACK", "num_gpus": 0, "_fake_gpus": false, "num_cpus_for_main_process": 2, "eager_tracing": true, "eager_max_retraces": 20, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "torch_compile_learner": false, "torch_compile_learner_what_to_compile": "forward_train", "torch_compile_learner_dynamo_backend": "aot_eager", "torch_compile_learner_dynamo_mode": null, "torch_compile_worker": false, "torch_compile_worker_dynamo_backend": "aot_eager", "torch_compile_worker_dynamo_mode": null, "torch_ddp_kwargs": {}, "torch_skip_nan_gradients": false, "env": "Umbrella", "env_config": {}, "observation_space": null, "action_space": null, "clip_rewards": null, "normalize_actions": true, "clip_actions": false, "_is_atari": null, "disable_env_checking": false, "render_env": false, "action_mask_key": "action_mask", "env_runner_cls": null, "num_env_runners": 0, "create_local_env_runner": true, "num_envs_per_env_runner": 1, "gym_env_vectorize_mode": "SYNC", "num_cpus_per_env_runner": 1, "num_gpus_per_env_runner": 0, "custom_resources_per_env_runner": {}, "validate_env_runners_after_construction": true, "episodes_to_numpy": true, "max_requests_in_flight_per_env_runner": 1, "sample_timeout_s": 60.0, "_env_to_module_connector": null, "add_default_connectors_to_env_to_module_pipeline": true, "_module_to_env_connector": null, "add_default_connectors_to_module_to_env_pipeline": true, "merge_env_runner_states": "training_only", "broadcast_env_runner_states": true, "episode_lookback_horizon": 1, "rollout_fragment_length": "auto", "batch_mode": "complete_episodes", "compress_observations": false, "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "enable_tf1_exec_eagerly": false, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "preprocessor_pref": "deepmind", "observation_filter": "NoFilter", "update_worker_filter_stats": true, "use_worker_filter_stats": true, "sampler_perf_stats_ema_coef": null, "_is_online": true, "num_learners": 0, "num_gpus_per_learner": 0, "num_cpus_per_learner": "auto", "num_aggregator_actors_per_learner": 0, "max_requests_in_flight_per_aggregator_actor": 3, "local_gpu_idx": 0, "max_requests_in_flight_per_learner": 3, "gamma": 1, "lr": 0.0002847858517, "grad_clip": 0.5, "grad_clip_by": "global_norm", "_train_batch_size_per_learner": 5000, "train_batch_size": 4000, "num_epochs": 1, "minibatch_size": 1000, "shuffle_batch_per_epoch": true, "model": {"fcnet_hiddens": [256, 256], "fcnet_activation": "tanh", "fcnet_weights_initializer": null, "fcnet_weights_initializer_config": null, "fcnet_bias_initializer": null, "fcnet_bias_initializer_config": null, "conv_filters": null, "conv_activation": "relu", "conv_kernel_initializer": null, "conv_kernel_initializer_config": null, "conv_bias_initializer": null, "conv_bias_initializer_config": null, "conv_transpose_kernel_initializer": null, "conv_transpose_kernel_initializer_config": null, "conv_transpose_bias_initializer": null, "conv_transpose_bias_initializer_config": null, "post_fcnet_hiddens": [], "post_fcnet_activation": "relu", "post_fcnet_weights_initializer": null, "post_fcnet_weights_initializer_config": null, "post_fcnet_bias_initializer": null, "post_fcnet_bias_initializer_config": null, "free_log_std": false, "log_std_clip_param": 20.0, "no_final_linear": false, "vf_share_layers": false, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "lstm_weights_initializer": null, "lstm_weights_initializer_config": null, "lstm_bias_initializer": null, "lstm_bias_initializer_config": null, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "attention_use_n_prev_actions": 0, "attention_use_n_prev_rewards": 0, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": null, "custom_model_config": {}, "custom_action_dist": null, "custom_preprocessor": null, "encoder_latent_dim": null, "always_check_shapes": false, "lstm_use_prev_action_reward": -1, "_use_default_native_models": -1, "_disable_preprocessor_api": false, "_disable_action_flattening": false}, "_learner_connector": null, "add_default_connectors_to_learner_pipeline": true, "learner_config_dict": {}, "optimizer": {}, "_learner_class": null, "callbacks_on_algorithm_init": null, "callbacks_on_env_runners_recreated": null, "callbacks_on_offline_eval_runners_recreated": null, "callbacks_on_checkpoint_loaded": null, "callbacks_on_environment_created": null, "callbacks_on_episode_created": null, "callbacks_on_episode_start": null, "callbacks_on_episode_step": null, "callbacks_on_episode_end": null, "callbacks_on_evaluate_start": null, "callbacks_on_evaluate_end": null, "callbacks_on_evaluate_offline_start": null, "callbacks_on_evaluate_offline_end": null, "callbacks_on_sample_end": null, "callbacks_on_train_result": null, "explore": true, "enable_rl_module_and_learner": true, "enable_env_runner_and_connector_v2": true, "_prior_exploration_config": {"type": "StochasticSampling"}, "count_steps_by": "env_steps", "policy_map_capacity": 100, "policy_mapping_fn": "<function AlgorithmConfig.DEFAULT_POLICY_MAPPING_FN at 0x13ca69b20>", "policies_to_train": null, "policy_states_are_swappable": false, "observation_fn": null, "offline_data_class": null, "input_read_method": "read_parquet", "input_read_method_kwargs": {}, "input_read_schema": {}, "input_read_episodes": false, "input_read_sample_batches": false, "input_read_batch_size": null, "input_filesystem": null, "input_filesystem_kwargs": {}, "input_compress_columns": ["obs", "new_obs"], "input_spaces_jsonable": true, "materialize_data": false, "materialize_mapped_data": true, "map_batches_kwargs": {}, "iter_batches_kwargs": {}, "ignore_final_observation": false, "prelearner_class": null, "prelearner_buffer_class": null, "prelearner_buffer_kwargs": {}, "prelearner_module_synch_period": 10, "dataset_num_iters_per_learner": null, "input_config": {}, "actions_in_input_normalized": false, "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_config": {}, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "output_max_rows_per_file": null, "output_write_remaining_data": false, "output_write_method": "write_parquet", "output_write_method_kwargs": {}, "output_filesystem": null, "output_filesystem_kwargs": {}, "output_write_episodes": true, "offline_sampling": false, "evaluation_interval": 1, "evaluation_duration": 20, "evaluation_duration_unit": "episodes", "evaluation_sample_timeout_s": 120.0, "evaluation_auto_duration_min_env_steps_per_sample": 100, "evaluation_auto_duration_max_env_steps_per_sample": 2000, "evaluation_parallel_to_training": false, "evaluation_force_reset_envs_before_iteration": true, "evaluation_config": null, "off_policy_estimation_methods": {}, "ope_split_batch_by_episode": true, "evaluation_num_env_runners": 1, "in_evaluation": false, "sync_filters_on_rollout_workers_timeout_s": 10.0, "offline_evaluation_interval": null, "num_offline_eval_runners": 0, "offline_loss_for_module_fn": null, "offline_evaluation_duration": 1, "offline_evaluation_parallel_to_training": false, "offline_evaluation_timeout_s": 120.0, "num_cpus_per_offline_eval_runner": 1, "num_gpus_per_offline_eval_runner": 0, "custom_resources_per_offline_eval_runner": {}, "restart_failed_offline_eval_runners": true, "ignore_offline_eval_runner_failures": false, "max_num_offline_eval_runner_restarts": 1000, "offline_eval_runner_restore_timeout_s": 1800.0, "max_requests_in_flight_per_offline_eval_runner": 1, "validate_offline_eval_runners_after_construction": true, "offline_eval_runner_health_probe_timeout_s": 30.0, "offline_eval_rl_module_inference_only": false, "broadcast_offline_eval_runner_states": false, "offline_eval_batch_size_per_runner": 256, "dataset_num_iters_per_eval_runner": 1, "keep_per_episode_custom_metrics": false, "metrics_episode_collection_timeout_s": 60.0, "metrics_num_episodes_for_smoothing": 100, "min_time_s_per_iteration": null, "min_train_timesteps_per_iteration": 0, "min_sample_timesteps_per_iteration": 0, "log_gradients": true, "export_native_model_files": false, "checkpoint_trainable_policies_only": false, "logger_creator": null, "logger_config": null, "log_level": "WARN", "log_sys_usage": true, "fake_sampler": false, "seed": 7, "restart_failed_env_runners": true, "ignore_env_runner_failures": false, "max_num_env_runner_restarts": 1000, "delay_between_env_runner_restarts_s": 60.0, "restart_failed_sub_environments": false, "num_consecutive_env_runner_failures_tolerance": 100, "env_runner_health_probe_timeout_s": 30.0, "env_runner_restore_timeout_s": 1800.0, "_model_config": {}, "_rl_module_spec": "RLModuleSpec(module_class=None, observation_space=None, action_space=None, inference_only=False, learner_only=False, model_config=DefaultModelConfig(fcnet_hiddens=[60, 90], fcnet_activation='tanh', fcnet_kernel_initializer=None, fcnet_kernel_initializer_kwargs=None, fcnet_bias_initializer=None, fcnet_bias_initializer_kwargs=None, conv_filters=None, conv_activation='relu', conv_kernel_initializer=None, conv_kernel_initializer_kwargs=None, conv_bias_initializer=None, conv_bias_initializer_kwargs=None, head_fcnet_hiddens=[], head_fcnet_activation='relu', head_fcnet_kernel_initializer=None, head_fcnet_kernel_initializer_kwargs=None, head_fcnet_bias_initializer=None, head_fcnet_bias_initializer_kwargs=None, free_log_std=False, log_std_clip_param=20.0, vf_share_layers=True, use_lstm=False, max_seq_len=20, lstm_cell_size=256, lstm_use_prev_action=False, lstm_use_prev_reward=False, lstm_kernel_initializer=None, lstm_kernel_initializer_kwargs=None, lstm_bias_initializer=None, lstm_bias_initializer_kwargs=None), catalog_class=None, load_state_path=None, model_config_dict=None)", "algorithm_config_overrides_per_module": {}, "_per_module_overrides": {}, "_validate_config": true, "_use_msgpack_checkpoints": false, "_torch_grad_scaler_class": null, "_torch_lr_scheduler_classes": null, "_tf_policy_handles_more_than_one_loss": false, "_disable_preprocessor_api": false, "_disable_action_flattening": false, "_disable_initialize_loss_from_dummy_batch": false, "_dont_auto_sync_env_runner_states": false, "env_task_fn": -1, "enable_connectors": -1, "simple_optimizer": false, "policy_map_cache": -1, "worker_cls": -1, "synchronize_filters": -1, "enable_async_evaluation": -1, "custom_async_evaluation_function": -1, "_enable_rl_module_api": -1, "auto_wrap_old_gym_envs": -1, "always_attach_evaluation_results": -1, "replay_sequence_length": null, "_disable_execution_plan_api": -1, "use_critic": true, "use_gae": true, "use_kl_loss": true, "kl_coeff": 0.7464963036515, "kl_target": 0.0270990929592, "vf_loss_coeff": 0.6688075857018, "entropy_coeff": 0.0090570820258, "clip_param": 0.1221781641624, "vf_clip_param": 0.1027808522125, "entropy_coeff_schedule": null, "lr_schedule": null, "sgd_minibatch_size": -1, "vf_share_layers": -1, "__stdout_file__": null, "__stderr_file__": null, "lambda": 0.9099046732075, "input": "sampler", "policies": {"default_policy": [null, null, null, null]}, "callbacks": "<class 'ray.rllib.callbacks.callbacks.RLlibCallback'>", "create_env_on_driver": false, "custom_eval_function": null, "framework": "torch"}, "time_since_restore": 1.6483960151672363, "iterations_since_restore": 1, "perf": {"cpu_util_percent": 25.2, "ram_util_percent": 78.53333333333335}}
{"timers": {"training_iteration": 1.5415500036533922, "restore_env_runners": 1.166155212558806e-05, "training_step": 1.541362339516636, "env_runner_sampling_timer": 1.4345672633149662, "learner_update_timer": 0.10376738192047924, "synch_weights": 0.00048264823970384896, "restore_eval_env_runners": 1.0124989785254002e-05, "evaluation_iteration": 0.10580458398908377, "synch_eval_env_connectors": 0.0001217919634655118, "synch_env_connectors": 4.791887477040291e-06}, "env_runners": {"weights_seq_no": 1.0, "module_to_env_connector": {"timers": {"connectors": {"tensor_to_numpy": 1.3414701572857628e-05, "listify_data_for_vector_env": 1.1172660727280604e-05, "remove_single_ts_time_rank_from_batch": 5.900478610600279e-07, "get_actions": 3.835251738514063e-05, "normalize_and_clip_actions": 9.563685241940421e-06, "un_batch_to_individual_items": 5.437063367570533e-06}}, "connector_pipeline_timer": 0.0001041800793657498}, "episode_len_mean": 20.0, "num_agent_steps_sampled_lifetime": {"default_agent": 10000.0}, "num_agent_steps_sampled": {"default_agent": 5000.0}, "sample": 0.0051414935721394535, "env_to_module_connector": {"timers": {"connectors": {"batch_individual_items": 6.618845338874699e-06, "add_observations_from_episodes_to_batch": 3.018193661956151e-06, "add_states_from_episodes_to_batch": 1.7633784537740496e-06, "add_time_dim_to_batch_and_zero_pad": 2.361323365775718e-06, "numpy_to_tensor": 8.73174119483305e-06}}, "connector_pipeline_timer": 4.414542477051715e-05}, "env_step_timer": 1.4070685988842962e-05, "num_episodes": 250.0, "episode_len_min": 20, "num_module_steps_sampled_lifetime": {"default_policy": 10000.0}, "env_to_module_sum_episodes_length_in": 10.36823839457432, "agent_episode_returns_mean": {"default_agent": 0.3400000000000001}, "num_env_steps_sampled": 5000.0, "episode_return_mean": 0.3400000000000001, "num_module_steps_sampled": {"default_policy": 5000.0}, "episode_duration_sec_mean": 0.004594458495266735, "module_episode_returns_mean": {"default_policy": 0.3400000000000001}, "num_episodes_lifetime": 500.0, "episode_return_max": 10.5, "episode_len_max": 20, "env_to_module_sum_episodes_length_out": 10.36823839457432, "episode_return_min": -9.5, "num_env_steps_sampled_lifetime": 10000.0, "env_reset_timer": 3.750261429794565e-05, "time_between_sampling": 0.0014713072972031283, "rlmodule_inference_timer": 2.799842822915956e-05, "num_env_steps_sampled_lifetime_throughput": 3747.622321291929}, "learners": {"default_policy": {"diff_num_grad_updates_vs_sampler_policy": 1.0, "mean_kl_loss": 4.524777614278719e-05, "num_module_steps_trained": 6000, "vf_explained_var": -0.010760307312011719, "entropy": 0.6892082095146179, "curr_entropy_coeff": 0.0090570820258, "num_trainable_parameters": 6003, "vf_loss_unclipped": 28.860502243041992, "gradients_default_optimizer_global_norm": 0.019594253972172737, "default_optimizer_learning_rate": 0.0002847858517, "module_train_batch_size_mean": 1000.0, "num_module_steps_trained_lifetime": 12000, "total_loss": 0.060141224414110184, "curr_kl_coeff": 0.18662407994270325, "policy_loss": -0.0023740576580166817, "vf_loss": 0.10278083384037018, "weights_seq_no": 2.0, "num_module_steps_trained_lifetime_throughput": 473160.8348016647}, "__all_modules__": {"learner_connector": {"connector_pipeline_timer": 0.07875035113072955, "timers": {"connectors": {"add_one_ts_to_episodes_and_truncate": 0.007337592062540352, "add_columns_from_episodes_to_train_batch": 0.03303045900305733, "general_advantage_estimation": 0.007027716198936105, "numpy_to_tensor": 6.894053309224546e-05, "batch_individual_items": 0.030351654159603638, "add_observations_from_episodes_to_batch": 0.0008063443459104746, "add_states_from_episodes_to_batch": 3.752060001716018e-06, "add_time_dim_to_batch_and_zero_pad": 1.025050412863493e-05}}}, "num_non_trainable_parameters": 0, "learner_connector_sum_episodes_length_in": 5000.0, "learner_connector_sum_episodes_length_out": 5250.0, "num_module_steps_trained": 6000, "num_trainable_parameters": 6003, "num_env_steps_trained_lifetime": 63000, "num_env_steps_trained": 31500, "num_module_steps_trained_lifetime": 12000, "num_env_steps_trained_lifetime_throughput": 2458511.176844493, "num_module_steps_trained_throughput": 471049.85953532095, "num_module_steps_trained_lifetime_throughput": 470055.0784132783}}, "num_training_step_calls_per_iteration": 1, "evaluation": {"env_runners": {"module_to_env_connector": {"timers": {"connectors": {"un_batch_to_individual_items": 6.157786639389192e-06, "listify_data_for_vector_env": 1.246442295465785e-05, "remove_single_ts_time_rank_from_batch": 7.049092824042116e-07, "normalize_and_clip_actions": 1.1177486247232482e-05, "tensor_to_numpy": 1.6194635895767152e-05, "get_actions": 4.7184379686131176e-05}}, "connector_pipeline_timer": 0.00012357311528895636}, "agent_episode_returns_mean": {"default_agent": 0.55}, "sample": 0.09823914343025536, "env_step_timer": 1.7208287124414504e-05, "num_episodes": 20, "module_episode_returns_mean": {"default_policy": 0.55}, "episode_return_max": 12.5, "episode_return_min": -12.5, "rlmodule_inference_timer": 3.1410908421696006e-05, "env_to_module_connector": {"timers": {"connectors": {"numpy_to_tensor": 9.81581806536606e-06, "batch_individual_items": 7.211022775575843e-06, "add_observations_from_episodes_to_batch": 3.3734741567349483e-06, "add_states_from_episodes_to_batch": 1.7389497640160406e-06, "add_time_dim_to_batch_and_zero_pad": 2.556591715219006e-06}}, "connector_pipeline_timer": 4.921520805165284e-05}, "env_to_module_sum_episodes_length_in": 10.366003441359926, "episode_return_mean": 0.55, "episode_duration_sec_mean": 0.0048692000011214985, "episode_len_max": 20, "env_to_module_sum_episodes_length_out": 10.366003441359926, "env_reset_timer": 0.00026685804827138783, "num_agent_steps_sampled_lifetime": {"default_agent": 800}, "episode_len_mean": 20.0, "num_module_steps_sampled_lifetime": {"default_policy": 800}, "episode_len_min": 20, "num_agent_steps_sampled": {"default_agent": 400}, "weights_seq_no": 2.0, "num_module_steps_sampled": {"default_policy": 400}, "num_env_steps_sampled": 400, "num_episodes_lifetime": 40, "num_env_steps_sampled_lifetime": 10400, "time_between_sampling": 1.6400942500913516}, "num_healthy_workers": 1, "actor_manager_num_outstanding_async_reqs": 0, "num_remote_worker_restarts": 0}, "num_env_steps_sampled_lifetime": 10000.0, "fault_tolerance": {"num_healthy_workers": 0, "num_remote_worker_restarts": 0}, "env_runner_group": {"actor_manager_num_outstanding_async_reqs": 0}, "done": false, "training_iteration": 2, "trial_id": "499df_00000", "date": "2025-08-11_19-37-00", "timestamp": 1754933820, "time_this_iter_s": 1.7283179759979248, "time_total_s": 3.376713991165161, "pid": 28380, "hostname": "Mac", "node_ip": "127.0.0.1", "config": {"exploration_config": {}, "extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "placement_strategy": "PACK", "num_gpus": 0, "_fake_gpus": false, "num_cpus_for_main_process": 2, "eager_tracing": true, "eager_max_retraces": 20, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "torch_compile_learner": false, "torch_compile_learner_what_to_compile": "forward_train", "torch_compile_learner_dynamo_backend": "aot_eager", "torch_compile_learner_dynamo_mode": null, "torch_compile_worker": false, "torch_compile_worker_dynamo_backend": "aot_eager", "torch_compile_worker_dynamo_mode": null, "torch_ddp_kwargs": {}, "torch_skip_nan_gradients": false, "env": "Umbrella", "env_config": {}, "observation_space": null, "action_space": null, "clip_rewards": null, "normalize_actions": true, "clip_actions": false, "_is_atari": null, "disable_env_checking": false, "render_env": false, "action_mask_key": "action_mask", "env_runner_cls": null, "num_env_runners": 0, "create_local_env_runner": true, "num_envs_per_env_runner": 1, "gym_env_vectorize_mode": "SYNC", "num_cpus_per_env_runner": 1, "num_gpus_per_env_runner": 0, "custom_resources_per_env_runner": {}, "validate_env_runners_after_construction": true, "episodes_to_numpy": true, "max_requests_in_flight_per_env_runner": 1, "sample_timeout_s": 60.0, "_env_to_module_connector": null, "add_default_connectors_to_env_to_module_pipeline": true, "_module_to_env_connector": null, "add_default_connectors_to_module_to_env_pipeline": true, "merge_env_runner_states": "training_only", "broadcast_env_runner_states": true, "episode_lookback_horizon": 1, "rollout_fragment_length": "auto", "batch_mode": "complete_episodes", "compress_observations": false, "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "enable_tf1_exec_eagerly": false, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "preprocessor_pref": "deepmind", "observation_filter": "NoFilter", "update_worker_filter_stats": true, "use_worker_filter_stats": true, "sampler_perf_stats_ema_coef": null, "_is_online": true, "num_learners": 0, "num_gpus_per_learner": 0, "num_cpus_per_learner": "auto", "num_aggregator_actors_per_learner": 0, "max_requests_in_flight_per_aggregator_actor": 3, "local_gpu_idx": 0, "max_requests_in_flight_per_learner": 3, "gamma": 1, "lr": 0.0002847858517, "grad_clip": 0.5, "grad_clip_by": "global_norm", "_train_batch_size_per_learner": 5000, "train_batch_size": 4000, "num_epochs": 1, "minibatch_size": 1000, "shuffle_batch_per_epoch": true, "model": {"fcnet_hiddens": [256, 256], "fcnet_activation": "tanh", "fcnet_weights_initializer": null, "fcnet_weights_initializer_config": null, "fcnet_bias_initializer": null, "fcnet_bias_initializer_config": null, "conv_filters": null, "conv_activation": "relu", "conv_kernel_initializer": null, "conv_kernel_initializer_config": null, "conv_bias_initializer": null, "conv_bias_initializer_config": null, "conv_transpose_kernel_initializer": null, "conv_transpose_kernel_initializer_config": null, "conv_transpose_bias_initializer": null, "conv_transpose_bias_initializer_config": null, "post_fcnet_hiddens": [], "post_fcnet_activation": "relu", "post_fcnet_weights_initializer": null, "post_fcnet_weights_initializer_config": null, "post_fcnet_bias_initializer": null, "post_fcnet_bias_initializer_config": null, "free_log_std": false, "log_std_clip_param": 20.0, "no_final_linear": false, "vf_share_layers": false, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "lstm_weights_initializer": null, "lstm_weights_initializer_config": null, "lstm_bias_initializer": null, "lstm_bias_initializer_config": null, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "attention_use_n_prev_actions": 0, "attention_use_n_prev_rewards": 0, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": null, "custom_model_config": {}, "custom_action_dist": null, "custom_preprocessor": null, "encoder_latent_dim": null, "always_check_shapes": false, "lstm_use_prev_action_reward": -1, "_use_default_native_models": -1, "_disable_preprocessor_api": false, "_disable_action_flattening": false}, "_learner_connector": null, "add_default_connectors_to_learner_pipeline": true, "learner_config_dict": {}, "optimizer": {}, "_learner_class": null, "callbacks_on_algorithm_init": null, "callbacks_on_env_runners_recreated": null, "callbacks_on_offline_eval_runners_recreated": null, "callbacks_on_checkpoint_loaded": null, "callbacks_on_environment_created": null, "callbacks_on_episode_created": null, "callbacks_on_episode_start": null, "callbacks_on_episode_step": null, "callbacks_on_episode_end": null, "callbacks_on_evaluate_start": null, "callbacks_on_evaluate_end": null, "callbacks_on_evaluate_offline_start": null, "callbacks_on_evaluate_offline_end": null, "callbacks_on_sample_end": null, "callbacks_on_train_result": null, "explore": true, "enable_rl_module_and_learner": true, "enable_env_runner_and_connector_v2": true, "_prior_exploration_config": {"type": "StochasticSampling"}, "count_steps_by": "env_steps", "policy_map_capacity": 100, "policy_mapping_fn": "<function AlgorithmConfig.DEFAULT_POLICY_MAPPING_FN at 0x13ca69b20>", "policies_to_train": null, "policy_states_are_swappable": false, "observation_fn": null, "offline_data_class": null, "input_read_method": "read_parquet", "input_read_method_kwargs": {}, "input_read_schema": {}, "input_read_episodes": false, "input_read_sample_batches": false, "input_read_batch_size": null, "input_filesystem": null, "input_filesystem_kwargs": {}, "input_compress_columns": ["obs", "new_obs"], "input_spaces_jsonable": true, "materialize_data": false, "materialize_mapped_data": true, "map_batches_kwargs": {}, "iter_batches_kwargs": {}, "ignore_final_observation": false, "prelearner_class": null, "prelearner_buffer_class": null, "prelearner_buffer_kwargs": {}, "prelearner_module_synch_period": 10, "dataset_num_iters_per_learner": null, "input_config": {}, "actions_in_input_normalized": false, "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_config": {}, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "output_max_rows_per_file": null, "output_write_remaining_data": false, "output_write_method": "write_parquet", "output_write_method_kwargs": {}, "output_filesystem": null, "output_filesystem_kwargs": {}, "output_write_episodes": true, "offline_sampling": false, "evaluation_interval": 1, "evaluation_duration": 20, "evaluation_duration_unit": "episodes", "evaluation_sample_timeout_s": 120.0, "evaluation_auto_duration_min_env_steps_per_sample": 100, "evaluation_auto_duration_max_env_steps_per_sample": 2000, "evaluation_parallel_to_training": false, "evaluation_force_reset_envs_before_iteration": true, "evaluation_config": null, "off_policy_estimation_methods": {}, "ope_split_batch_by_episode": true, "evaluation_num_env_runners": 1, "in_evaluation": false, "sync_filters_on_rollout_workers_timeout_s": 10.0, "offline_evaluation_interval": null, "num_offline_eval_runners": 0, "offline_loss_for_module_fn": null, "offline_evaluation_duration": 1, "offline_evaluation_parallel_to_training": false, "offline_evaluation_timeout_s": 120.0, "num_cpus_per_offline_eval_runner": 1, "num_gpus_per_offline_eval_runner": 0, "custom_resources_per_offline_eval_runner": {}, "restart_failed_offline_eval_runners": true, "ignore_offline_eval_runner_failures": false, "max_num_offline_eval_runner_restarts": 1000, "offline_eval_runner_restore_timeout_s": 1800.0, "max_requests_in_flight_per_offline_eval_runner": 1, "validate_offline_eval_runners_after_construction": true, "offline_eval_runner_health_probe_timeout_s": 30.0, "offline_eval_rl_module_inference_only": false, "broadcast_offline_eval_runner_states": false, "offline_eval_batch_size_per_runner": 256, "dataset_num_iters_per_eval_runner": 1, "keep_per_episode_custom_metrics": false, "metrics_episode_collection_timeout_s": 60.0, "metrics_num_episodes_for_smoothing": 100, "min_time_s_per_iteration": null, "min_train_timesteps_per_iteration": 0, "min_sample_timesteps_per_iteration": 0, "log_gradients": true, "export_native_model_files": false, "checkpoint_trainable_policies_only": false, "logger_creator": null, "logger_config": null, "log_level": "WARN", "log_sys_usage": true, "fake_sampler": false, "seed": 7, "restart_failed_env_runners": true, "ignore_env_runner_failures": false, "max_num_env_runner_restarts": 1000, "delay_between_env_runner_restarts_s": 60.0, "restart_failed_sub_environments": false, "num_consecutive_env_runner_failures_tolerance": 100, "env_runner_health_probe_timeout_s": 30.0, "env_runner_restore_timeout_s": 1800.0, "_model_config": {}, "_rl_module_spec": "RLModuleSpec(module_class=None, observation_space=None, action_space=None, inference_only=False, learner_only=False, model_config=DefaultModelConfig(fcnet_hiddens=[60, 90], fcnet_activation='tanh', fcnet_kernel_initializer=None, fcnet_kernel_initializer_kwargs=None, fcnet_bias_initializer=None, fcnet_bias_initializer_kwargs=None, conv_filters=None, conv_activation='relu', conv_kernel_initializer=None, conv_kernel_initializer_kwargs=None, conv_bias_initializer=None, conv_bias_initializer_kwargs=None, head_fcnet_hiddens=[], head_fcnet_activation='relu', head_fcnet_kernel_initializer=None, head_fcnet_kernel_initializer_kwargs=None, head_fcnet_bias_initializer=None, head_fcnet_bias_initializer_kwargs=None, free_log_std=False, log_std_clip_param=20.0, vf_share_layers=True, use_lstm=False, max_seq_len=20, lstm_cell_size=256, lstm_use_prev_action=False, lstm_use_prev_reward=False, lstm_kernel_initializer=None, lstm_kernel_initializer_kwargs=None, lstm_bias_initializer=None, lstm_bias_initializer_kwargs=None), catalog_class=None, load_state_path=None, model_config_dict=None)", "algorithm_config_overrides_per_module": {}, "_per_module_overrides": {}, "_validate_config": true, "_use_msgpack_checkpoints": false, "_torch_grad_scaler_class": null, "_torch_lr_scheduler_classes": null, "_tf_policy_handles_more_than_one_loss": false, "_disable_preprocessor_api": false, "_disable_action_flattening": false, "_disable_initialize_loss_from_dummy_batch": false, "_dont_auto_sync_env_runner_states": false, "env_task_fn": -1, "enable_connectors": -1, "simple_optimizer": false, "policy_map_cache": -1, "worker_cls": -1, "synchronize_filters": -1, "enable_async_evaluation": -1, "custom_async_evaluation_function": -1, "_enable_rl_module_api": -1, "auto_wrap_old_gym_envs": -1, "always_attach_evaluation_results": -1, "replay_sequence_length": null, "_disable_execution_plan_api": -1, "use_critic": true, "use_gae": true, "use_kl_loss": true, "kl_coeff": 0.7464963036515, "kl_target": 0.0270990929592, "vf_loss_coeff": 0.6688075857018, "entropy_coeff": 0.0090570820258, "clip_param": 0.1221781641624, "vf_clip_param": 0.1027808522125, "entropy_coeff_schedule": null, "lr_schedule": null, "sgd_minibatch_size": -1, "vf_share_layers": -1, "__stdout_file__": null, "__stderr_file__": null, "lambda": 0.9099046732075, "input": "sampler", "policies": {"default_policy": [null, null, null, null]}, "callbacks": "<class 'ray.rllib.callbacks.callbacks.RLlibCallback'>", "create_env_on_driver": false, "custom_eval_function": null, "framework": "torch"}, "time_since_restore": 3.376713991165161, "iterations_since_restore": 2, "perf": {"cpu_util_percent": 36.2, "ram_util_percent": 78.25}}
{"timers": {"training_iteration": 1.541262502785912, "restore_env_runners": 1.1617016314994544e-05, "training_step": 1.5410747182112887, "env_runner_sampling_timer": 1.4344008161014645, "learner_update_timer": 0.10364522519232705, "synch_weights": 0.00048328258701367305, "restore_eval_env_runners": 1.0109989671036602e-05, "evaluation_iteration": 0.10595871606958097, "synch_eval_env_connectors": 0.00012189987348392606, "synch_env_connectors": 4.79229842312634e-06}, "env_runners": {"weights_seq_no": 2.0, "module_to_env_connector": {"timers": {"connectors": {"tensor_to_numpy": 1.361742871087202e-05, "listify_data_for_vector_env": 1.1582392835268574e-05, "remove_single_ts_time_rank_from_batch": 6.008603178303385e-07, "get_actions": 3.935871834614406e-05, "normalize_and_clip_actions": 9.835702929551499e-06, "un_batch_to_individual_items": 5.658924049417602e-06}}, "connector_pipeline_timer": 0.00010670942197719857}, "episode_len_mean": 20.0, "num_agent_steps_sampled_lifetime": {"default_agent": -607500.0}, "num_agent_steps_sampled": {"default_agent": 5000.0}, "sample": 0.005062625783514453, "env_to_module_connector": {"timers": {"connectors": {"batch_individual_items": 6.719133685207965e-06, "add_observations_from_episodes_to_batch": 3.1389237595253273e-06, "add_states_from_episodes_to_batch": 1.7819983443598346e-06, "add_time_dim_to_batch_and_zero_pad": 2.4033237835327743e-06, "numpy_to_tensor": 8.936662769543774e-06}}, "connector_pipeline_timer": 4.496062116978084e-05}, "env_step_timer": 1.4473909176834221e-05, "num_episodes": 250.0, "episode_len_min": 20, "num_module_steps_sampled_lifetime": {"default_policy": -607500.0}, "env_to_module_sum_episodes_length_in": 10.36823839457432, "agent_episode_returns_mean": {"default_agent": 1.3000000000000003}, "num_env_steps_sampled": 5000.0, "episode_return_mean": 1.3000000000000003, "num_module_steps_sampled": {"default_policy": 5000.0}, "episode_duration_sec_mean": 0.00466609901469201, "module_episode_returns_mean": {"default_policy": 1.3000000000000003}, "num_episodes_lifetime": -30375.0, "episode_return_max": 10.5, "episode_len_max": 20, "env_to_module_sum_episodes_length_out": 10.36823839457432, "episode_return_min": -9.5, "num_env_steps_sampled_lifetime": -607500.0, "env_reset_timer": 3.916166893184355e-05, "time_between_sampling": 0.0020088426172184775, "rlmodule_inference_timer": 2.846598338808051e-05, "num_env_steps_sampled_lifetime_throughput": 3611.1780339885095}, "learners": {"default_policy": {"diff_num_grad_updates_vs_sampler_policy": 1.0, "mean_kl_loss": 0.0007080155191943049, "num_module_steps_trained": 6000, "vf_explained_var": -0.010493040084838867, "entropy": 0.684884786605835, "curr_entropy_coeff": 0.0090570820258, "num_trainable_parameters": 6003, "vf_loss_unclipped": 29.159080505371094, "gradients_default_optimizer_global_norm": 0.044358815997838974, "default_optimizer_learning_rate": 0.0002847858517, "module_train_batch_size_mean": 1000.0, "num_module_steps_trained_lifetime": 18000, "total_loss": 0.3532428741455078, "curr_kl_coeff": 0.09331203997135162, "policy_loss": 0.29057320952415466, "vf_loss": 0.10278083384037018, "weights_seq_no": 3.0, "num_module_steps_trained_lifetime_throughput": 472395.5929890924}, "__all_modules__": {"learner_connector": {"connector_pipeline_timer": 0.07875182886921103, "timers": {"connectors": {"add_one_ts_to_episodes_and_truncate": 0.007340397811634466, "add_columns_from_episodes_to_train_batch": 0.03304212400296237, "general_advantage_estimation": 0.00701124737681821, "numpy_to_tensor": 6.97748774313368e-05, "batch_individual_items": 0.030354234277049544, "add_observations_from_episodes_to_batch": 0.0008066588125773705, "add_states_from_episodes_to_batch": 3.743699111510068e-06, "add_time_dim_to_batch_and_zero_pad": 1.0259249061346055e-05}}}, "num_non_trainable_parameters": 0, "learner_connector_sum_episodes_length_in": 5000.0, "learner_connector_sum_episodes_length_out": 5250.0, "num_module_steps_trained": 6000, "num_trainable_parameters": 6003, "num_env_steps_trained_lifetime": 94500, "num_env_steps_trained": 31500, "num_module_steps_trained_lifetime": 18000, "num_env_steps_trained_lifetime_throughput": 2455156.686627845, "num_module_steps_trained_throughput": 470354.0290867909, "num_module_steps_trained_lifetime_throughput": 469377.04715465027}}, "num_training_step_calls_per_iteration": 1, "evaluation": {"env_runners": {"module_to_env_connector": {"timers": {"connectors": {"un_batch_to_individual_items": 5.606370732564068e-06, "listify_data_for_vector_env": 1.1245051740579342e-05, "remove_single_ts_time_rank_from_batch": 5.904680545017889e-07, "normalize_and_clip_actions": 9.765975902804992e-06, "tensor_to_numpy": 1.3655696452321497e-05, "get_actions": 3.766872368663677e-05}}, "connector_pipeline_timer": 0.00010449013730352604}, "agent_episode_returns_mean": {"default_agent": 0.05}, "sample": 0.09824968532607892, "env_step_timer": 1.4841768248134014e-05, "num_episodes": 20, "module_episode_returns_mean": {"default_policy": 0.05}, "episode_return_max": 14.5, "episode_return_min": -12.5, "rlmodule_inference_timer": 2.8029373981230887e-05, "env_to_module_connector": {"timers": {"connectors": {"numpy_to_tensor": 8.91073476139151e-06, "batch_individual_items": 6.329815643449002e-06, "add_observations_from_episodes_to_batch": 2.926563773398709e-06, "add_states_from_episodes_to_batch": 1.6066796346117251e-06, "add_time_dim_to_batch_and_zero_pad": 2.3268409507192504e-06}}, "connector_pipeline_timer": 4.376016264298399e-05}, "env_to_module_sum_episodes_length_in": 10.368205581254823, "episode_return_mean": 0.05, "episode_duration_sec_mean": 0.004756334037908042, "episode_len_max": 20, "env_to_module_sum_episodes_length_out": 10.368205581254823, "env_reset_timer": 0.0002650536373490468, "num_agent_steps_sampled_lifetime": {"default_agent": 1200}, "episode_len_mean": 20.0, "num_module_steps_sampled_lifetime": {"default_policy": 1200}, "episode_len_min": 20, "num_agent_steps_sampled": {"default_agent": 400}, "weights_seq_no": 3.0, "num_module_steps_sampled": {"default_policy": 400}, "num_env_steps_sampled": 400, "num_episodes_lifetime": 60, "num_env_steps_sampled_lifetime": 15400, "time_between_sampling": 1.639017226760043}, "num_healthy_workers": 1, "actor_manager_num_outstanding_async_reqs": 0, "num_remote_worker_restarts": 0}, "num_env_steps_sampled_lifetime": -607500.0, "fault_tolerance": {"num_healthy_workers": 0, "num_remote_worker_restarts": 0}, "env_runner_group": {"actor_manager_num_outstanding_async_reqs": 0}, "done": false, "training_iteration": 3, "trial_id": "499df_00000", "date": "2025-08-11_19-37-02", "timestamp": 1754933822, "time_this_iter_s": 1.6188690662384033, "time_total_s": 4.9955830574035645, "pid": 28380, "hostname": "Mac", "node_ip": "127.0.0.1", "config": {"exploration_config": {}, "extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "placement_strategy": "PACK", "num_gpus": 0, "_fake_gpus": false, "num_cpus_for_main_process": 2, "eager_tracing": true, "eager_max_retraces": 20, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "torch_compile_learner": false, "torch_compile_learner_what_to_compile": "forward_train", "torch_compile_learner_dynamo_backend": "aot_eager", "torch_compile_learner_dynamo_mode": null, "torch_compile_worker": false, "torch_compile_worker_dynamo_backend": "aot_eager", "torch_compile_worker_dynamo_mode": null, "torch_ddp_kwargs": {}, "torch_skip_nan_gradients": false, "env": "Umbrella", "env_config": {}, "observation_space": null, "action_space": null, "clip_rewards": null, "normalize_actions": true, "clip_actions": false, "_is_atari": null, "disable_env_checking": false, "render_env": false, "action_mask_key": "action_mask", "env_runner_cls": null, "num_env_runners": 0, "create_local_env_runner": true, "num_envs_per_env_runner": 1, "gym_env_vectorize_mode": "SYNC", "num_cpus_per_env_runner": 1, "num_gpus_per_env_runner": 0, "custom_resources_per_env_runner": {}, "validate_env_runners_after_construction": true, "episodes_to_numpy": true, "max_requests_in_flight_per_env_runner": 1, "sample_timeout_s": 60.0, "_env_to_module_connector": null, "add_default_connectors_to_env_to_module_pipeline": true, "_module_to_env_connector": null, "add_default_connectors_to_module_to_env_pipeline": true, "merge_env_runner_states": "training_only", "broadcast_env_runner_states": true, "episode_lookback_horizon": 1, "rollout_fragment_length": "auto", "batch_mode": "complete_episodes", "compress_observations": false, "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "enable_tf1_exec_eagerly": false, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "preprocessor_pref": "deepmind", "observation_filter": "NoFilter", "update_worker_filter_stats": true, "use_worker_filter_stats": true, "sampler_perf_stats_ema_coef": null, "_is_online": true, "num_learners": 0, "num_gpus_per_learner": 0, "num_cpus_per_learner": "auto", "num_aggregator_actors_per_learner": 0, "max_requests_in_flight_per_aggregator_actor": 3, "local_gpu_idx": 0, "max_requests_in_flight_per_learner": 3, "gamma": 1, "lr": 0.0002847858517, "grad_clip": 0.5, "grad_clip_by": "global_norm", "_train_batch_size_per_learner": 5000, "train_batch_size": 4000, "num_epochs": 1, "minibatch_size": 1000, "shuffle_batch_per_epoch": true, "model": {"fcnet_hiddens": [256, 256], "fcnet_activation": "tanh", "fcnet_weights_initializer": null, "fcnet_weights_initializer_config": null, "fcnet_bias_initializer": null, "fcnet_bias_initializer_config": null, "conv_filters": null, "conv_activation": "relu", "conv_kernel_initializer": null, "conv_kernel_initializer_config": null, "conv_bias_initializer": null, "conv_bias_initializer_config": null, "conv_transpose_kernel_initializer": null, "conv_transpose_kernel_initializer_config": null, "conv_transpose_bias_initializer": null, "conv_transpose_bias_initializer_config": null, "post_fcnet_hiddens": [], "post_fcnet_activation": "relu", "post_fcnet_weights_initializer": null, "post_fcnet_weights_initializer_config": null, "post_fcnet_bias_initializer": null, "post_fcnet_bias_initializer_config": null, "free_log_std": false, "log_std_clip_param": 20.0, "no_final_linear": false, "vf_share_layers": false, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "lstm_weights_initializer": null, "lstm_weights_initializer_config": null, "lstm_bias_initializer": null, "lstm_bias_initializer_config": null, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "attention_use_n_prev_actions": 0, "attention_use_n_prev_rewards": 0, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": null, "custom_model_config": {}, "custom_action_dist": null, "custom_preprocessor": null, "encoder_latent_dim": null, "always_check_shapes": false, "lstm_use_prev_action_reward": -1, "_use_default_native_models": -1, "_disable_preprocessor_api": false, "_disable_action_flattening": false}, "_learner_connector": null, "add_default_connectors_to_learner_pipeline": true, "learner_config_dict": {}, "optimizer": {}, "_learner_class": null, "callbacks_on_algorithm_init": null, "callbacks_on_env_runners_recreated": null, "callbacks_on_offline_eval_runners_recreated": null, "callbacks_on_checkpoint_loaded": null, "callbacks_on_environment_created": null, "callbacks_on_episode_created": null, "callbacks_on_episode_start": null, "callbacks_on_episode_step": null, "callbacks_on_episode_end": null, "callbacks_on_evaluate_start": null, "callbacks_on_evaluate_end": null, "callbacks_on_evaluate_offline_start": null, "callbacks_on_evaluate_offline_end": null, "callbacks_on_sample_end": null, "callbacks_on_train_result": null, "explore": true, "enable_rl_module_and_learner": true, "enable_env_runner_and_connector_v2": true, "_prior_exploration_config": {"type": "StochasticSampling"}, "count_steps_by": "env_steps", "policy_map_capacity": 100, "policy_mapping_fn": "<function AlgorithmConfig.DEFAULT_POLICY_MAPPING_FN at 0x13ca69b20>", "policies_to_train": null, "policy_states_are_swappable": false, "observation_fn": null, "offline_data_class": null, "input_read_method": "read_parquet", "input_read_method_kwargs": {}, "input_read_schema": {}, "input_read_episodes": false, "input_read_sample_batches": false, "input_read_batch_size": null, "input_filesystem": null, "input_filesystem_kwargs": {}, "input_compress_columns": ["obs", "new_obs"], "input_spaces_jsonable": true, "materialize_data": false, "materialize_mapped_data": true, "map_batches_kwargs": {}, "iter_batches_kwargs": {}, "ignore_final_observation": false, "prelearner_class": null, "prelearner_buffer_class": null, "prelearner_buffer_kwargs": {}, "prelearner_module_synch_period": 10, "dataset_num_iters_per_learner": null, "input_config": {}, "actions_in_input_normalized": false, "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_config": {}, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "output_max_rows_per_file": null, "output_write_remaining_data": false, "output_write_method": "write_parquet", "output_write_method_kwargs": {}, "output_filesystem": null, "output_filesystem_kwargs": {}, "output_write_episodes": true, "offline_sampling": false, "evaluation_interval": 1, "evaluation_duration": 20, "evaluation_duration_unit": "episodes", "evaluation_sample_timeout_s": 120.0, "evaluation_auto_duration_min_env_steps_per_sample": 100, "evaluation_auto_duration_max_env_steps_per_sample": 2000, "evaluation_parallel_to_training": false, "evaluation_force_reset_envs_before_iteration": true, "evaluation_config": null, "off_policy_estimation_methods": {}, "ope_split_batch_by_episode": true, "evaluation_num_env_runners": 1, "in_evaluation": false, "sync_filters_on_rollout_workers_timeout_s": 10.0, "offline_evaluation_interval": null, "num_offline_eval_runners": 0, "offline_loss_for_module_fn": null, "offline_evaluation_duration": 1, "offline_evaluation_parallel_to_training": false, "offline_evaluation_timeout_s": 120.0, "num_cpus_per_offline_eval_runner": 1, "num_gpus_per_offline_eval_runner": 0, "custom_resources_per_offline_eval_runner": {}, "restart_failed_offline_eval_runners": true, "ignore_offline_eval_runner_failures": false, "max_num_offline_eval_runner_restarts": 1000, "offline_eval_runner_restore_timeout_s": 1800.0, "max_requests_in_flight_per_offline_eval_runner": 1, "validate_offline_eval_runners_after_construction": true, "offline_eval_runner_health_probe_timeout_s": 30.0, "offline_eval_rl_module_inference_only": false, "broadcast_offline_eval_runner_states": false, "offline_eval_batch_size_per_runner": 256, "dataset_num_iters_per_eval_runner": 1, "keep_per_episode_custom_metrics": false, "metrics_episode_collection_timeout_s": 60.0, "metrics_num_episodes_for_smoothing": 100, "min_time_s_per_iteration": null, "min_train_timesteps_per_iteration": 0, "min_sample_timesteps_per_iteration": 0, "log_gradients": true, "export_native_model_files": false, "checkpoint_trainable_policies_only": false, "logger_creator": null, "logger_config": null, "log_level": "WARN", "log_sys_usage": true, "fake_sampler": false, "seed": 7, "restart_failed_env_runners": true, "ignore_env_runner_failures": false, "max_num_env_runner_restarts": 1000, "delay_between_env_runner_restarts_s": 60.0, "restart_failed_sub_environments": false, "num_consecutive_env_runner_failures_tolerance": 100, "env_runner_health_probe_timeout_s": 30.0, "env_runner_restore_timeout_s": 1800.0, "_model_config": {}, "_rl_module_spec": "RLModuleSpec(module_class=None, observation_space=None, action_space=None, inference_only=False, learner_only=False, model_config=DefaultModelConfig(fcnet_hiddens=[60, 90], fcnet_activation='tanh', fcnet_kernel_initializer=None, fcnet_kernel_initializer_kwargs=None, fcnet_bias_initializer=None, fcnet_bias_initializer_kwargs=None, conv_filters=None, conv_activation='relu', conv_kernel_initializer=None, conv_kernel_initializer_kwargs=None, conv_bias_initializer=None, conv_bias_initializer_kwargs=None, head_fcnet_hiddens=[], head_fcnet_activation='relu', head_fcnet_kernel_initializer=None, head_fcnet_kernel_initializer_kwargs=None, head_fcnet_bias_initializer=None, head_fcnet_bias_initializer_kwargs=None, free_log_std=False, log_std_clip_param=20.0, vf_share_layers=True, use_lstm=False, max_seq_len=20, lstm_cell_size=256, lstm_use_prev_action=False, lstm_use_prev_reward=False, lstm_kernel_initializer=None, lstm_kernel_initializer_kwargs=None, lstm_bias_initializer=None, lstm_bias_initializer_kwargs=None), catalog_class=None, load_state_path=None, model_config_dict=None)", "algorithm_config_overrides_per_module": {}, "_per_module_overrides": {}, "_validate_config": true, "_use_msgpack_checkpoints": false, "_torch_grad_scaler_class": null, "_torch_lr_scheduler_classes": null, "_tf_policy_handles_more_than_one_loss": false, "_disable_preprocessor_api": false, "_disable_action_flattening": false, "_disable_initialize_loss_from_dummy_batch": false, "_dont_auto_sync_env_runner_states": false, "env_task_fn": -1, "enable_connectors": -1, "simple_optimizer": false, "policy_map_cache": -1, "worker_cls": -1, "synchronize_filters": -1, "enable_async_evaluation": -1, "custom_async_evaluation_function": -1, "_enable_rl_module_api": -1, "auto_wrap_old_gym_envs": -1, "always_attach_evaluation_results": -1, "replay_sequence_length": null, "_disable_execution_plan_api": -1, "use_critic": true, "use_gae": true, "use_kl_loss": true, "kl_coeff": 0.7464963036515, "kl_target": 0.0270990929592, "vf_loss_coeff": 0.6688075857018, "entropy_coeff": 0.0090570820258, "clip_param": 0.1221781641624, "vf_clip_param": 0.1027808522125, "entropy_coeff_schedule": null, "lr_schedule": null, "sgd_minibatch_size": -1, "vf_share_layers": -1, "__stdout_file__": null, "__stderr_file__": null, "lambda": 0.9099046732075, "input": "sampler", "policies": {"default_policy": [null, null, null, null]}, "callbacks": "<class 'ray.rllib.callbacks.callbacks.RLlibCallback'>", "create_env_on_driver": false, "custom_eval_function": null, "framework": "torch"}, "time_since_restore": 4.9955830574035645, "iterations_since_restore": 3, "perf": {"cpu_util_percent": 43.36666666666667, "ram_util_percent": 79.13333333333334}}
{"timers": {"training_iteration": 1.5429808060874777, "restore_env_runners": 1.1570846684859135e-05, "training_step": 1.5427931335290896, "env_runner_sampling_timer": 1.436260834600866, "learner_update_timer": 0.10350397418991755, "synch_weights": 0.00048396642131044064, "restore_eval_env_runners": 1.0086389782372863e-05, "evaluation_iteration": 0.10593921474938979, "synch_eval_env_connectors": 0.00012170296518597752, "synch_env_connectors": 4.7981255571357905e-06}, "env_runners": {"weights_seq_no": 3.0, "module_to_env_connector": {"timers": {"connectors": {"tensor_to_numpy": 1.4687922844911517e-05, "listify_data_for_vector_env": 1.2223379941635492e-05, "remove_single_ts_time_rank_from_batch": 6.476165258647739e-07, "get_actions": 4.290995890312671e-05, "normalize_and_clip_actions": 1.0269010379154983e-05, "un_batch_to_individual_items": 5.950963174891563e-06}}, "connector_pipeline_timer": 0.00011459081991279064}, "episode_len_mean": 20.0, "num_agent_steps_sampled_lifetime": {"default_agent": -1225000.0}, "num_agent_steps_sampled": {"default_agent": 5000.0}, "sample": 0.0053717875736726045, "env_to_module_connector": {"timers": {"connectors": {"batch_individual_items": 7.242713905652376e-06, "add_observations_from_episodes_to_batch": 3.370895072192271e-06, "add_states_from_episodes_to_batch": 1.9038505610283907e-06, "add_time_dim_to_batch_and_zero_pad": 2.5540406460740115e-06, "numpy_to_tensor": 9.79774073729218e-06}}, "connector_pipeline_timer": 4.8133413391156804e-05}, "env_step_timer": 1.556105359724748e-05, "num_episodes": 250.0, "episode_len_min": 20, "num_module_steps_sampled_lifetime": {"default_policy": -1225000.0}, "env_to_module_sum_episodes_length_in": 10.36823839457432, "agent_episode_returns_mean": {"default_agent": 2.259999999999999}, "num_env_steps_sampled": 5000.0, "episode_return_mean": 2.259999999999999, "num_module_steps_sampled": {"default_policy": 5000.0}, "episode_duration_sec_mean": 0.005040533510968088, "module_episode_returns_mean": {"default_policy": 2.259999999999999}, "num_episodes_lifetime": -61250.0, "episode_return_max": 10.5, "episode_len_max": 20, "env_to_module_sum_episodes_length_out": 10.36823839457432, "episode_return_min": -9.5, "num_env_steps_sampled_lifetime": -1225000.0, "env_reset_timer": 4.750582816692842e-05, "time_between_sampling": 0.0018548525869863477, "rlmodule_inference_timer": 3.0935013891816646e-05, "num_env_steps_sampled_lifetime_throughput": 3372.072690013869}, "learners": {"default_policy": {"diff_num_grad_updates_vs_sampler_policy": 1.0, "mean_kl_loss": 0.0009349097963422537, "num_module_steps_trained": 6000, "vf_explained_var": -0.010841846466064453, "entropy": 0.6782488226890564, "curr_entropy_coeff": 0.0090570820258, "num_trainable_parameters": 6003, "vf_loss_unclipped": 28.754053115844727, "gradients_default_optimizer_global_norm": 0.05304211378097534, "default_optimizer_learning_rate": 0.0002847858517, "module_train_batch_size_mean": 1000.0, "num_module_steps_trained_lifetime": 24000, "total_loss": 0.15174606442451477, "curr_kl_coeff": 0.04665601998567581, "policy_loss": 0.0890611782670021, "vf_loss": 0.10278083384037018, "weights_seq_no": 4.0, "num_module_steps_trained_lifetime_throughput": 471984.72825747303}, "__all_modules__": {"learner_connector": {"connector_pipeline_timer": 0.07873616683029466, "timers": {"connectors": {"add_one_ts_to_episodes_and_truncate": 0.007340162583904806, "add_columns_from_episodes_to_train_batch": 0.0330433736027379, "general_advantage_estimation": 0.006995256152172573, "numpy_to_tensor": 6.965295841998887e-05, "batch_individual_items": 0.030354182344139436, "add_observations_from_episodes_to_batch": 0.0008065201451209141, "add_states_from_episodes_to_batch": 3.7437618238618596e-06, "add_time_dim_to_batch_and_zero_pad": 1.025123703479767e-05}}}, "num_non_trainable_parameters": 0, "learner_connector_sum_episodes_length_in": 5000.0, "learner_connector_sum_episodes_length_out": 5250.0, "num_module_steps_trained": 6000, "num_trainable_parameters": 6003, "num_env_steps_trained_lifetime": 126000, "num_env_steps_trained": 31500, "num_module_steps_trained_lifetime": 24000, "num_env_steps_trained_lifetime_throughput": 2453833.6386182937, "num_module_steps_trained_throughput": 470030.1915475212, "num_module_steps_trained_lifetime_throughput": 469075.21962551965}}, "num_training_step_calls_per_iteration": 1, "evaluation": {"env_runners": {"module_to_env_connector": {"timers": {"connectors": {"un_batch_to_individual_items": 5.539666764413882e-06, "listify_data_for_vector_env": 1.0985967700088307e-05, "remove_single_ts_time_rank_from_batch": 5.687910047916054e-07, "normalize_and_clip_actions": 9.582933010614591e-06, "tensor_to_numpy": 1.2861380125857163e-05, "get_actions": 3.479757123107033e-05}}, "connector_pipeline_timer": 0.00010026160401561668}, "agent_episode_returns_mean": {"default_agent": -0.45}, "sample": 0.0982313138920865, "env_step_timer": 1.4119948682409124e-05, "num_episodes": 20, "module_episode_returns_mean": {"default_policy": -0.45}, "episode_return_max": 14.5, "episode_return_min": -12.5, "rlmodule_inference_timer": 2.660208340204724e-05, "env_to_module_connector": {"timers": {"connectors": {"numpy_to_tensor": 8.302310943151896e-06, "batch_individual_items": 6.2325609345738905e-06, "add_observations_from_episodes_to_batch": 2.904413932280303e-06, "add_states_from_episodes_to_batch": 1.5998659333193965e-06, "add_time_dim_to_batch_and_zero_pad": 2.244198901811392e-06}}, "connector_pipeline_timer": 4.294314312647322e-05}, "env_to_module_sum_episodes_length_in": 10.368237912813044, "episode_return_mean": -0.45, "episode_duration_sec_mean": 0.004675330730970017, "episode_len_max": 20, "env_to_module_sum_episodes_length_out": 10.368237912813044, "env_reset_timer": 0.0002631885109141004, "num_agent_steps_sampled_lifetime": {"default_agent": 1600}, "episode_len_mean": 20.0, "num_module_steps_sampled_lifetime": {"default_policy": 1600}, "episode_len_min": 20, "num_agent_steps_sampled": {"default_agent": 400}, "weights_seq_no": 4.0, "num_module_steps_sampled": {"default_policy": 400}, "num_env_steps_sampled": 400, "num_episodes_lifetime": 80, "num_env_steps_sampled_lifetime": 20400, "time_between_sampling": 1.6399156394926482}, "num_healthy_workers": 1, "actor_manager_num_outstanding_async_reqs": 0, "num_remote_worker_restarts": 0}, "num_env_steps_sampled_lifetime": -1225000.0, "fault_tolerance": {"num_healthy_workers": 0, "num_remote_worker_restarts": 0}, "env_runner_group": {"actor_manager_num_outstanding_async_reqs": 0}, "done": false, "training_iteration": 4, "trial_id": "499df_00000", "date": "2025-08-11_19-37-04", "timestamp": 1754933824, "time_this_iter_s": 1.8159780502319336, "time_total_s": 6.811561107635498, "pid": 28380, "hostname": "Mac", "node_ip": "127.0.0.1", "config": {"exploration_config": {}, "extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "placement_strategy": "PACK", "num_gpus": 0, "_fake_gpus": false, "num_cpus_for_main_process": 2, "eager_tracing": true, "eager_max_retraces": 20, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "torch_compile_learner": false, "torch_compile_learner_what_to_compile": "forward_train", "torch_compile_learner_dynamo_backend": "aot_eager", "torch_compile_learner_dynamo_mode": null, "torch_compile_worker": false, "torch_compile_worker_dynamo_backend": "aot_eager", "torch_compile_worker_dynamo_mode": null, "torch_ddp_kwargs": {}, "torch_skip_nan_gradients": false, "env": "Umbrella", "env_config": {}, "observation_space": null, "action_space": null, "clip_rewards": null, "normalize_actions": true, "clip_actions": false, "_is_atari": null, "disable_env_checking": false, "render_env": false, "action_mask_key": "action_mask", "env_runner_cls": null, "num_env_runners": 0, "create_local_env_runner": true, "num_envs_per_env_runner": 1, "gym_env_vectorize_mode": "SYNC", "num_cpus_per_env_runner": 1, "num_gpus_per_env_runner": 0, "custom_resources_per_env_runner": {}, "validate_env_runners_after_construction": true, "episodes_to_numpy": true, "max_requests_in_flight_per_env_runner": 1, "sample_timeout_s": 60.0, "_env_to_module_connector": null, "add_default_connectors_to_env_to_module_pipeline": true, "_module_to_env_connector": null, "add_default_connectors_to_module_to_env_pipeline": true, "merge_env_runner_states": "training_only", "broadcast_env_runner_states": true, "episode_lookback_horizon": 1, "rollout_fragment_length": "auto", "batch_mode": "complete_episodes", "compress_observations": false, "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "enable_tf1_exec_eagerly": false, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "preprocessor_pref": "deepmind", "observation_filter": "NoFilter", "update_worker_filter_stats": true, "use_worker_filter_stats": true, "sampler_perf_stats_ema_coef": null, "_is_online": true, "num_learners": 0, "num_gpus_per_learner": 0, "num_cpus_per_learner": "auto", "num_aggregator_actors_per_learner": 0, "max_requests_in_flight_per_aggregator_actor": 3, "local_gpu_idx": 0, "max_requests_in_flight_per_learner": 3, "gamma": 1, "lr": 0.0002847858517, "grad_clip": 0.5, "grad_clip_by": "global_norm", "_train_batch_size_per_learner": 5000, "train_batch_size": 4000, "num_epochs": 1, "minibatch_size": 1000, "shuffle_batch_per_epoch": true, "model": {"fcnet_hiddens": [256, 256], "fcnet_activation": "tanh", "fcnet_weights_initializer": null, "fcnet_weights_initializer_config": null, "fcnet_bias_initializer": null, "fcnet_bias_initializer_config": null, "conv_filters": null, "conv_activation": "relu", "conv_kernel_initializer": null, "conv_kernel_initializer_config": null, "conv_bias_initializer": null, "conv_bias_initializer_config": null, "conv_transpose_kernel_initializer": null, "conv_transpose_kernel_initializer_config": null, "conv_transpose_bias_initializer": null, "conv_transpose_bias_initializer_config": null, "post_fcnet_hiddens": [], "post_fcnet_activation": "relu", "post_fcnet_weights_initializer": null, "post_fcnet_weights_initializer_config": null, "post_fcnet_bias_initializer": null, "post_fcnet_bias_initializer_config": null, "free_log_std": false, "log_std_clip_param": 20.0, "no_final_linear": false, "vf_share_layers": false, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "lstm_weights_initializer": null, "lstm_weights_initializer_config": null, "lstm_bias_initializer": null, "lstm_bias_initializer_config": null, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "attention_use_n_prev_actions": 0, "attention_use_n_prev_rewards": 0, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": null, "custom_model_config": {}, "custom_action_dist": null, "custom_preprocessor": null, "encoder_latent_dim": null, "always_check_shapes": false, "lstm_use_prev_action_reward": -1, "_use_default_native_models": -1, "_disable_preprocessor_api": false, "_disable_action_flattening": false}, "_learner_connector": null, "add_default_connectors_to_learner_pipeline": true, "learner_config_dict": {}, "optimizer": {}, "_learner_class": null, "callbacks_on_algorithm_init": null, "callbacks_on_env_runners_recreated": null, "callbacks_on_offline_eval_runners_recreated": null, "callbacks_on_checkpoint_loaded": null, "callbacks_on_environment_created": null, "callbacks_on_episode_created": null, "callbacks_on_episode_start": null, "callbacks_on_episode_step": null, "callbacks_on_episode_end": null, "callbacks_on_evaluate_start": null, "callbacks_on_evaluate_end": null, "callbacks_on_evaluate_offline_start": null, "callbacks_on_evaluate_offline_end": null, "callbacks_on_sample_end": null, "callbacks_on_train_result": null, "explore": true, "enable_rl_module_and_learner": true, "enable_env_runner_and_connector_v2": true, "_prior_exploration_config": {"type": "StochasticSampling"}, "count_steps_by": "env_steps", "policy_map_capacity": 100, "policy_mapping_fn": "<function AlgorithmConfig.DEFAULT_POLICY_MAPPING_FN at 0x13ca69b20>", "policies_to_train": null, "policy_states_are_swappable": false, "observation_fn": null, "offline_data_class": null, "input_read_method": "read_parquet", "input_read_method_kwargs": {}, "input_read_schema": {}, "input_read_episodes": false, "input_read_sample_batches": false, "input_read_batch_size": null, "input_filesystem": null, "input_filesystem_kwargs": {}, "input_compress_columns": ["obs", "new_obs"], "input_spaces_jsonable": true, "materialize_data": false, "materialize_mapped_data": true, "map_batches_kwargs": {}, "iter_batches_kwargs": {}, "ignore_final_observation": false, "prelearner_class": null, "prelearner_buffer_class": null, "prelearner_buffer_kwargs": {}, "prelearner_module_synch_period": 10, "dataset_num_iters_per_learner": null, "input_config": {}, "actions_in_input_normalized": false, "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_config": {}, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "output_max_rows_per_file": null, "output_write_remaining_data": false, "output_write_method": "write_parquet", "output_write_method_kwargs": {}, "output_filesystem": null, "output_filesystem_kwargs": {}, "output_write_episodes": true, "offline_sampling": false, "evaluation_interval": 1, "evaluation_duration": 20, "evaluation_duration_unit": "episodes", "evaluation_sample_timeout_s": 120.0, "evaluation_auto_duration_min_env_steps_per_sample": 100, "evaluation_auto_duration_max_env_steps_per_sample": 2000, "evaluation_parallel_to_training": false, "evaluation_force_reset_envs_before_iteration": true, "evaluation_config": null, "off_policy_estimation_methods": {}, "ope_split_batch_by_episode": true, "evaluation_num_env_runners": 1, "in_evaluation": false, "sync_filters_on_rollout_workers_timeout_s": 10.0, "offline_evaluation_interval": null, "num_offline_eval_runners": 0, "offline_loss_for_module_fn": null, "offline_evaluation_duration": 1, "offline_evaluation_parallel_to_training": false, "offline_evaluation_timeout_s": 120.0, "num_cpus_per_offline_eval_runner": 1, "num_gpus_per_offline_eval_runner": 0, "custom_resources_per_offline_eval_runner": {}, "restart_failed_offline_eval_runners": true, "ignore_offline_eval_runner_failures": false, "max_num_offline_eval_runner_restarts": 1000, "offline_eval_runner_restore_timeout_s": 1800.0, "max_requests_in_flight_per_offline_eval_runner": 1, "validate_offline_eval_runners_after_construction": true, "offline_eval_runner_health_probe_timeout_s": 30.0, "offline_eval_rl_module_inference_only": false, "broadcast_offline_eval_runner_states": false, "offline_eval_batch_size_per_runner": 256, "dataset_num_iters_per_eval_runner": 1, "keep_per_episode_custom_metrics": false, "metrics_episode_collection_timeout_s": 60.0, "metrics_num_episodes_for_smoothing": 100, "min_time_s_per_iteration": null, "min_train_timesteps_per_iteration": 0, "min_sample_timesteps_per_iteration": 0, "log_gradients": true, "export_native_model_files": false, "checkpoint_trainable_policies_only": false, "logger_creator": null, "logger_config": null, "log_level": "WARN", "log_sys_usage": true, "fake_sampler": false, "seed": 7, "restart_failed_env_runners": true, "ignore_env_runner_failures": false, "max_num_env_runner_restarts": 1000, "delay_between_env_runner_restarts_s": 60.0, "restart_failed_sub_environments": false, "num_consecutive_env_runner_failures_tolerance": 100, "env_runner_health_probe_timeout_s": 30.0, "env_runner_restore_timeout_s": 1800.0, "_model_config": {}, "_rl_module_spec": "RLModuleSpec(module_class=None, observation_space=None, action_space=None, inference_only=False, learner_only=False, model_config=DefaultModelConfig(fcnet_hiddens=[60, 90], fcnet_activation='tanh', fcnet_kernel_initializer=None, fcnet_kernel_initializer_kwargs=None, fcnet_bias_initializer=None, fcnet_bias_initializer_kwargs=None, conv_filters=None, conv_activation='relu', conv_kernel_initializer=None, conv_kernel_initializer_kwargs=None, conv_bias_initializer=None, conv_bias_initializer_kwargs=None, head_fcnet_hiddens=[], head_fcnet_activation='relu', head_fcnet_kernel_initializer=None, head_fcnet_kernel_initializer_kwargs=None, head_fcnet_bias_initializer=None, head_fcnet_bias_initializer_kwargs=None, free_log_std=False, log_std_clip_param=20.0, vf_share_layers=True, use_lstm=False, max_seq_len=20, lstm_cell_size=256, lstm_use_prev_action=False, lstm_use_prev_reward=False, lstm_kernel_initializer=None, lstm_kernel_initializer_kwargs=None, lstm_bias_initializer=None, lstm_bias_initializer_kwargs=None), catalog_class=None, load_state_path=None, model_config_dict=None)", "algorithm_config_overrides_per_module": {}, "_per_module_overrides": {}, "_validate_config": true, "_use_msgpack_checkpoints": false, "_torch_grad_scaler_class": null, "_torch_lr_scheduler_classes": null, "_tf_policy_handles_more_than_one_loss": false, "_disable_preprocessor_api": false, "_disable_action_flattening": false, "_disable_initialize_loss_from_dummy_batch": false, "_dont_auto_sync_env_runner_states": false, "env_task_fn": -1, "enable_connectors": -1, "simple_optimizer": false, "policy_map_cache": -1, "worker_cls": -1, "synchronize_filters": -1, "enable_async_evaluation": -1, "custom_async_evaluation_function": -1, "_enable_rl_module_api": -1, "auto_wrap_old_gym_envs": -1, "always_attach_evaluation_results": -1, "replay_sequence_length": null, "_disable_execution_plan_api": -1, "use_critic": true, "use_gae": true, "use_kl_loss": true, "kl_coeff": 0.7464963036515, "kl_target": 0.0270990929592, "vf_loss_coeff": 0.6688075857018, "entropy_coeff": 0.0090570820258, "clip_param": 0.1221781641624, "vf_clip_param": 0.1027808522125, "entropy_coeff_schedule": null, "lr_schedule": null, "sgd_minibatch_size": -1, "vf_share_layers": -1, "__stdout_file__": null, "__stderr_file__": null, "lambda": 0.9099046732075, "input": "sampler", "policies": {"default_policy": [null, null, null, null]}, "callbacks": "<class 'ray.rllib.callbacks.callbacks.RLlibCallback'>", "create_env_on_driver": false, "custom_eval_function": null, "framework": "torch"}, "time_since_restore": 6.811561107635498, "iterations_since_restore": 4, "perf": {"cpu_util_percent": 46.75, "ram_util_percent": 78.7}}
{"timers": {"training_iteration": 1.5454401071966672, "restore_env_runners": 1.1503468038866994e-05, "training_step": 1.5452525505239127, "env_runner_sampling_timer": 1.438645328754797, "learner_update_timer": 0.10357298694788634, "synch_weights": 0.00048752050785617787, "restore_eval_env_runners": 1.0086356687243097e-05, "evaluation_iteration": 0.1058890009323192, "synch_eval_env_connectors": 0.00012157384602981619, "synch_env_connectors": 4.791814001859166e-06}, "env_runners": {"weights_seq_no": 4.0, "module_to_env_connector": {"timers": {"connectors": {"tensor_to_numpy": 1.4540286895511013e-05, "listify_data_for_vector_env": 1.2319439406433673e-05, "remove_single_ts_time_rank_from_batch": 7.586872311723588e-07, "get_actions": 4.284036901284842e-05, "normalize_and_clip_actions": 1.011517877536635e-05, "un_batch_to_individual_items": 6.034393241677103e-06}}, "connector_pipeline_timer": 0.0001144596954172645}, "episode_len_mean": 20.0, "num_agent_steps_sampled_lifetime": {"default_agent": -1842500.0}, "num_agent_steps_sampled": {"default_agent": 5000.0}, "sample": 0.005208722374032319, "env_to_module_connector": {"timers": {"connectors": {"batch_individual_items": 7.284641290792707e-06, "add_observations_from_episodes_to_batch": 3.4217525402920165e-06, "add_states_from_episodes_to_batch": 1.8998227848591058e-06, "add_time_dim_to_batch_and_zero_pad": 2.575792583588361e-06, "numpy_to_tensor": 9.755779845969086e-06}}, "connector_pipeline_timer": 4.828237593965292e-05}, "env_step_timer": 1.574575308419815e-05, "num_episodes": 250.0, "episode_len_min": 20, "num_module_steps_sampled_lifetime": {"default_policy": -1842500.0}, "env_to_module_sum_episodes_length_in": 10.36823839457432, "agent_episode_returns_mean": {"default_agent": 1.1400000000000001}, "num_env_steps_sampled": 5000.0, "episode_return_mean": 1.1400000000000001, "num_module_steps_sampled": {"default_policy": 5000.0}, "episode_duration_sec_mean": 0.00548561517521739, "module_episode_returns_mean": {"default_policy": 1.1400000000000001}, "num_episodes_lifetime": -92125.0, "episode_return_max": 10.5, "episode_len_max": 20, "env_to_module_sum_episodes_length_out": 10.36823839457432, "episode_return_min": -9.5, "num_env_steps_sampled_lifetime": -1842500.0, "env_reset_timer": 3.7686784123474326e-05, "time_between_sampling": 0.0016517565504712663, "rlmodule_inference_timer": 5.3697188428890395e-05, "num_env_steps_sampled_lifetime_throughput": 3676.508263073079}, "learners": {"default_policy": {"diff_num_grad_updates_vs_sampler_policy": 1.0, "mean_kl_loss": 0.0014776266179978848, "num_module_steps_trained": 6000, "vf_explained_var": -0.010644197463989258, "entropy": 0.6661638617515564, "curr_entropy_coeff": 0.0090570820258, "num_trainable_parameters": 6003, "vf_loss_unclipped": 29.06502914428711, "gradients_default_optimizer_global_norm": 0.051883306354284286, "default_optimizer_learning_rate": 0.0002847858517, "module_train_batch_size_mean": 1000.0, "num_module_steps_trained_lifetime": 30000, "total_loss": 0.2631865441799164, "curr_kl_coeff": 0.023328009992837906, "policy_loss": 0.20041051506996155, "vf_loss": 0.10278083384037018, "weights_seq_no": 5.0, "num_module_steps_trained_lifetime_throughput": 469628.3825571303}, "__all_modules__": {"learner_connector": {"connector_pipeline_timer": 0.0788671480824776, "timers": {"connectors": {"add_one_ts_to_episodes_and_truncate": 0.007353318868610556, "add_columns_from_episodes_to_train_batch": 0.03311149861745916, "general_advantage_estimation": 0.006996758170825607, "numpy_to_tensor": 6.970600846658111e-05, "batch_individual_items": 0.03039977509999892, "add_observations_from_episodes_to_batch": 0.0008088603639954014, "add_states_from_episodes_to_batch": 3.7379938297730404e-06, "add_time_dim_to_batch_and_zero_pad": 1.0277895613089205e-05}}}, "num_non_trainable_parameters": 0, "learner_connector_sum_episodes_length_in": 5000.0, "learner_connector_sum_episodes_length_out": 5250.0, "num_module_steps_trained": 6000, "num_trainable_parameters": 6003, "num_env_steps_trained_lifetime": 157500, "num_env_steps_trained": 31500, "num_module_steps_trained_lifetime": 30000, "num_env_steps_trained_lifetime_throughput": 2442383.5487239477, "num_module_steps_trained_throughput": 467763.98605660984, "num_module_steps_trained_lifetime_throughput": 466836.6236723236}}, "num_training_step_calls_per_iteration": 1, "evaluation": {"env_runners": {"module_to_env_connector": {"timers": {"connectors": {"un_batch_to_individual_items": 5.969799166530389e-06, "listify_data_for_vector_env": 1.1599940812115007e-05, "remove_single_ts_time_rank_from_batch": 5.981348500320195e-07, "normalize_and_clip_actions": 1.0925033453365193e-05, "tensor_to_numpy": 1.4210592222713741e-05, "get_actions": 4.102093012854308e-05}}, "connector_pipeline_timer": 0.00011186954667817186}, "agent_episode_returns_mean": {"default_agent": -0.95}, "sample": 0.0983767886631018, "env_step_timer": 1.5398854011051456e-05, "num_episodes": 20, "module_episode_returns_mean": {"default_policy": -0.95}, "episode_return_max": 14.5, "episode_return_min": -12.5, "rlmodule_inference_timer": 2.927639386874264e-05, "env_to_module_connector": {"timers": {"connectors": {"numpy_to_tensor": 9.045144005464245e-06, "batch_individual_items": 6.471402390831329e-06, "add_observations_from_episodes_to_batch": 3.145197461946708e-06, "add_states_from_episodes_to_batch": 1.6647150959963074e-06, "add_time_dim_to_batch_and_zero_pad": 2.4460517198526497e-06}}, "connector_pipeline_timer": 4.5186048148155504e-05}, "env_to_module_sum_episodes_length_in": 10.368238387501162, "episode_return_mean": -0.95, "episode_duration_sec_mean": 0.004769942522980273, "episode_len_max": 20, "env_to_module_sum_episodes_length_out": 10.368238387501162, "env_reset_timer": 0.0002613653758513765, "num_agent_steps_sampled_lifetime": {"default_agent": 2000}, "episode_len_mean": 20.0, "num_module_steps_sampled_lifetime": {"default_policy": 2000}, "episode_len_min": 20, "num_agent_steps_sampled": {"default_agent": 400}, "weights_seq_no": 5.0, "num_module_steps_sampled": {"default_policy": 400}, "num_env_steps_sampled": 400, "num_episodes_lifetime": 100, "num_env_steps_sampled_lifetime": 25400, "time_between_sampling": 1.6415944526872253}, "num_healthy_workers": 1, "actor_manager_num_outstanding_async_reqs": 0, "num_remote_worker_restarts": 0}, "num_env_steps_sampled_lifetime": -1842500.0, "fault_tolerance": {"num_healthy_workers": 0, "num_remote_worker_restarts": 0}, "env_runner_group": {"actor_manager_num_outstanding_async_reqs": 0}, "done": false, "training_iteration": 5, "trial_id": "499df_00000", "date": "2025-08-11_19-37-06", "timestamp": 1754933826, "time_this_iter_s": 1.911363124847412, "time_total_s": 8.72292423248291, "pid": 28380, "hostname": "Mac", "node_ip": "127.0.0.1", "config": {"exploration_config": {}, "extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "placement_strategy": "PACK", "num_gpus": 0, "_fake_gpus": false, "num_cpus_for_main_process": 2, "eager_tracing": true, "eager_max_retraces": 20, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "torch_compile_learner": false, "torch_compile_learner_what_to_compile": "forward_train", "torch_compile_learner_dynamo_backend": "aot_eager", "torch_compile_learner_dynamo_mode": null, "torch_compile_worker": false, "torch_compile_worker_dynamo_backend": "aot_eager", "torch_compile_worker_dynamo_mode": null, "torch_ddp_kwargs": {}, "torch_skip_nan_gradients": false, "env": "Umbrella", "env_config": {}, "observation_space": null, "action_space": null, "clip_rewards": null, "normalize_actions": true, "clip_actions": false, "_is_atari": null, "disable_env_checking": false, "render_env": false, "action_mask_key": "action_mask", "env_runner_cls": null, "num_env_runners": 0, "create_local_env_runner": true, "num_envs_per_env_runner": 1, "gym_env_vectorize_mode": "SYNC", "num_cpus_per_env_runner": 1, "num_gpus_per_env_runner": 0, "custom_resources_per_env_runner": {}, "validate_env_runners_after_construction": true, "episodes_to_numpy": true, "max_requests_in_flight_per_env_runner": 1, "sample_timeout_s": 60.0, "_env_to_module_connector": null, "add_default_connectors_to_env_to_module_pipeline": true, "_module_to_env_connector": null, "add_default_connectors_to_module_to_env_pipeline": true, "merge_env_runner_states": "training_only", "broadcast_env_runner_states": true, "episode_lookback_horizon": 1, "rollout_fragment_length": "auto", "batch_mode": "complete_episodes", "compress_observations": false, "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "enable_tf1_exec_eagerly": false, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "preprocessor_pref": "deepmind", "observation_filter": "NoFilter", "update_worker_filter_stats": true, "use_worker_filter_stats": true, "sampler_perf_stats_ema_coef": null, "_is_online": true, "num_learners": 0, "num_gpus_per_learner": 0, "num_cpus_per_learner": "auto", "num_aggregator_actors_per_learner": 0, "max_requests_in_flight_per_aggregator_actor": 3, "local_gpu_idx": 0, "max_requests_in_flight_per_learner": 3, "gamma": 1, "lr": 0.0002847858517, "grad_clip": 0.5, "grad_clip_by": "global_norm", "_train_batch_size_per_learner": 5000, "train_batch_size": 4000, "num_epochs": 1, "minibatch_size": 1000, "shuffle_batch_per_epoch": true, "model": {"fcnet_hiddens": [256, 256], "fcnet_activation": "tanh", "fcnet_weights_initializer": null, "fcnet_weights_initializer_config": null, "fcnet_bias_initializer": null, "fcnet_bias_initializer_config": null, "conv_filters": null, "conv_activation": "relu", "conv_kernel_initializer": null, "conv_kernel_initializer_config": null, "conv_bias_initializer": null, "conv_bias_initializer_config": null, "conv_transpose_kernel_initializer": null, "conv_transpose_kernel_initializer_config": null, "conv_transpose_bias_initializer": null, "conv_transpose_bias_initializer_config": null, "post_fcnet_hiddens": [], "post_fcnet_activation": "relu", "post_fcnet_weights_initializer": null, "post_fcnet_weights_initializer_config": null, "post_fcnet_bias_initializer": null, "post_fcnet_bias_initializer_config": null, "free_log_std": false, "log_std_clip_param": 20.0, "no_final_linear": false, "vf_share_layers": false, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "lstm_weights_initializer": null, "lstm_weights_initializer_config": null, "lstm_bias_initializer": null, "lstm_bias_initializer_config": null, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "attention_use_n_prev_actions": 0, "attention_use_n_prev_rewards": 0, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": null, "custom_model_config": {}, "custom_action_dist": null, "custom_preprocessor": null, "encoder_latent_dim": null, "always_check_shapes": false, "lstm_use_prev_action_reward": -1, "_use_default_native_models": -1, "_disable_preprocessor_api": false, "_disable_action_flattening": false}, "_learner_connector": null, "add_default_connectors_to_learner_pipeline": true, "learner_config_dict": {}, "optimizer": {}, "_learner_class": null, "callbacks_on_algorithm_init": null, "callbacks_on_env_runners_recreated": null, "callbacks_on_offline_eval_runners_recreated": null, "callbacks_on_checkpoint_loaded": null, "callbacks_on_environment_created": null, "callbacks_on_episode_created": null, "callbacks_on_episode_start": null, "callbacks_on_episode_step": null, "callbacks_on_episode_end": null, "callbacks_on_evaluate_start": null, "callbacks_on_evaluate_end": null, "callbacks_on_evaluate_offline_start": null, "callbacks_on_evaluate_offline_end": null, "callbacks_on_sample_end": null, "callbacks_on_train_result": null, "explore": true, "enable_rl_module_and_learner": true, "enable_env_runner_and_connector_v2": true, "_prior_exploration_config": {"type": "StochasticSampling"}, "count_steps_by": "env_steps", "policy_map_capacity": 100, "policy_mapping_fn": "<function AlgorithmConfig.DEFAULT_POLICY_MAPPING_FN at 0x13ca69b20>", "policies_to_train": null, "policy_states_are_swappable": false, "observation_fn": null, "offline_data_class": null, "input_read_method": "read_parquet", "input_read_method_kwargs": {}, "input_read_schema": {}, "input_read_episodes": false, "input_read_sample_batches": false, "input_read_batch_size": null, "input_filesystem": null, "input_filesystem_kwargs": {}, "input_compress_columns": ["obs", "new_obs"], "input_spaces_jsonable": true, "materialize_data": false, "materialize_mapped_data": true, "map_batches_kwargs": {}, "iter_batches_kwargs": {}, "ignore_final_observation": false, "prelearner_class": null, "prelearner_buffer_class": null, "prelearner_buffer_kwargs": {}, "prelearner_module_synch_period": 10, "dataset_num_iters_per_learner": null, "input_config": {}, "actions_in_input_normalized": false, "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_config": {}, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "output_max_rows_per_file": null, "output_write_remaining_data": false, "output_write_method": "write_parquet", "output_write_method_kwargs": {}, "output_filesystem": null, "output_filesystem_kwargs": {}, "output_write_episodes": true, "offline_sampling": false, "evaluation_interval": 1, "evaluation_duration": 20, "evaluation_duration_unit": "episodes", "evaluation_sample_timeout_s": 120.0, "evaluation_auto_duration_min_env_steps_per_sample": 100, "evaluation_auto_duration_max_env_steps_per_sample": 2000, "evaluation_parallel_to_training": false, "evaluation_force_reset_envs_before_iteration": true, "evaluation_config": null, "off_policy_estimation_methods": {}, "ope_split_batch_by_episode": true, "evaluation_num_env_runners": 1, "in_evaluation": false, "sync_filters_on_rollout_workers_timeout_s": 10.0, "offline_evaluation_interval": null, "num_offline_eval_runners": 0, "offline_loss_for_module_fn": null, "offline_evaluation_duration": 1, "offline_evaluation_parallel_to_training": false, "offline_evaluation_timeout_s": 120.0, "num_cpus_per_offline_eval_runner": 1, "num_gpus_per_offline_eval_runner": 0, "custom_resources_per_offline_eval_runner": {}, "restart_failed_offline_eval_runners": true, "ignore_offline_eval_runner_failures": false, "max_num_offline_eval_runner_restarts": 1000, "offline_eval_runner_restore_timeout_s": 1800.0, "max_requests_in_flight_per_offline_eval_runner": 1, "validate_offline_eval_runners_after_construction": true, "offline_eval_runner_health_probe_timeout_s": 30.0, "offline_eval_rl_module_inference_only": false, "broadcast_offline_eval_runner_states": false, "offline_eval_batch_size_per_runner": 256, "dataset_num_iters_per_eval_runner": 1, "keep_per_episode_custom_metrics": false, "metrics_episode_collection_timeout_s": 60.0, "metrics_num_episodes_for_smoothing": 100, "min_time_s_per_iteration": null, "min_train_timesteps_per_iteration": 0, "min_sample_timesteps_per_iteration": 0, "log_gradients": true, "export_native_model_files": false, "checkpoint_trainable_policies_only": false, "logger_creator": null, "logger_config": null, "log_level": "WARN", "log_sys_usage": true, "fake_sampler": false, "seed": 7, "restart_failed_env_runners": true, "ignore_env_runner_failures": false, "max_num_env_runner_restarts": 1000, "delay_between_env_runner_restarts_s": 60.0, "restart_failed_sub_environments": false, "num_consecutive_env_runner_failures_tolerance": 100, "env_runner_health_probe_timeout_s": 30.0, "env_runner_restore_timeout_s": 1800.0, "_model_config": {}, "_rl_module_spec": "RLModuleSpec(module_class=None, observation_space=None, action_space=None, inference_only=False, learner_only=False, model_config=DefaultModelConfig(fcnet_hiddens=[60, 90], fcnet_activation='tanh', fcnet_kernel_initializer=None, fcnet_kernel_initializer_kwargs=None, fcnet_bias_initializer=None, fcnet_bias_initializer_kwargs=None, conv_filters=None, conv_activation='relu', conv_kernel_initializer=None, conv_kernel_initializer_kwargs=None, conv_bias_initializer=None, conv_bias_initializer_kwargs=None, head_fcnet_hiddens=[], head_fcnet_activation='relu', head_fcnet_kernel_initializer=None, head_fcnet_kernel_initializer_kwargs=None, head_fcnet_bias_initializer=None, head_fcnet_bias_initializer_kwargs=None, free_log_std=False, log_std_clip_param=20.0, vf_share_layers=True, use_lstm=False, max_seq_len=20, lstm_cell_size=256, lstm_use_prev_action=False, lstm_use_prev_reward=False, lstm_kernel_initializer=None, lstm_kernel_initializer_kwargs=None, lstm_bias_initializer=None, lstm_bias_initializer_kwargs=None), catalog_class=None, load_state_path=None, model_config_dict=None)", "algorithm_config_overrides_per_module": {}, "_per_module_overrides": {}, "_validate_config": true, "_use_msgpack_checkpoints": false, "_torch_grad_scaler_class": null, "_torch_lr_scheduler_classes": null, "_tf_policy_handles_more_than_one_loss": false, "_disable_preprocessor_api": false, "_disable_action_flattening": false, "_disable_initialize_loss_from_dummy_batch": false, "_dont_auto_sync_env_runner_states": false, "env_task_fn": -1, "enable_connectors": -1, "simple_optimizer": false, "policy_map_cache": -1, "worker_cls": -1, "synchronize_filters": -1, "enable_async_evaluation": -1, "custom_async_evaluation_function": -1, "_enable_rl_module_api": -1, "auto_wrap_old_gym_envs": -1, "always_attach_evaluation_results": -1, "replay_sequence_length": null, "_disable_execution_plan_api": -1, "use_critic": true, "use_gae": true, "use_kl_loss": true, "kl_coeff": 0.7464963036515, "kl_target": 0.0270990929592, "vf_loss_coeff": 0.6688075857018, "entropy_coeff": 0.0090570820258, "clip_param": 0.1221781641624, "vf_clip_param": 0.1027808522125, "entropy_coeff_schedule": null, "lr_schedule": null, "sgd_minibatch_size": -1, "vf_share_layers": -1, "__stdout_file__": null, "__stderr_file__": null, "lambda": 0.9099046732075, "input": "sampler", "policies": {"default_policy": [null, null, null, null]}, "callbacks": "<class 'ray.rllib.callbacks.callbacks.RLlibCallback'>", "create_env_on_driver": false, "custom_eval_function": null, "framework": "torch"}, "time_since_restore": 8.72292423248291, "iterations_since_restore": 5, "perf": {"cpu_util_percent": 44.06666666666666, "ram_util_percent": 78.96666666666667}}
{"timers": {"training_iteration": 1.5484398569651079, "restore_env_runners": 1.1443013517963664e-05, "training_step": 1.548252310428113, "env_runner_sampling_timer": 1.4408264808763216, "learner_update_timer": 0.10438893166913293, "synch_weights": 0.0004883432122873792, "restore_eval_env_runners": 1.0080903625680368e-05, "evaluation_iteration": 0.10602018842364667, "synch_eval_env_connectors": 0.00012162768766738706, "synch_env_connectors": 4.7972361981484576e-06}, "env_runners": {"weights_seq_no": 5.0, "module_to_env_connector": {"timers": {"connectors": {"tensor_to_numpy": 1.588613645539204e-05, "listify_data_for_vector_env": 1.7551890687545686e-05, "remove_single_ts_time_rank_from_batch": 6.722955573549949e-07, "get_actions": 4.6422871366102405e-05, "normalize_and_clip_actions": 1.1176226455408673e-05, "un_batch_to_individual_items": 6.196651973935117e-06}}, "connector_pipeline_timer": 0.00012699350351941816}, "episode_len_mean": 20.0, "num_agent_steps_sampled_lifetime": {"default_agent": -2460000.0}, "num_agent_steps_sampled": {"default_agent": 5000.0}, "sample": 0.006253790409514784, "env_to_module_connector": {"timers": {"connectors": {"batch_individual_items": 7.621548111113949e-06, "add_observations_from_episodes_to_batch": 3.4241232336560574e-06, "add_states_from_episodes_to_batch": 1.947299405360499e-06, "add_time_dim_to_batch_and_zero_pad": 2.782617519768661e-06, "numpy_to_tensor": 1.0441495731414286e-05}}, "connector_pipeline_timer": 5.0315980472460236e-05}, "env_step_timer": 1.6891341676206352e-05, "num_episodes": 250.0, "episode_len_min": 20, "num_module_steps_sampled_lifetime": {"default_policy": -2460000.0}, "env_to_module_sum_episodes_length_in": 10.36823839457432, "agent_episode_returns_mean": {"default_agent": 2.58}, "num_env_steps_sampled": 5000.0, "episode_return_mean": 2.58, "num_module_steps_sampled": {"default_policy": 5000.0}, "episode_duration_sec_mean": 0.005456090667750685, "module_episode_returns_mean": {"default_policy": 2.58}, "num_episodes_lifetime": -123000.0, "episode_return_max": 10.5, "episode_len_max": 20, "env_to_module_sum_episodes_length_out": 10.36823839457432, "episode_return_min": -9.5, "num_env_steps_sampled_lifetime": -2460000.0, "env_reset_timer": 5.1755174546427796e-05, "time_between_sampling": 0.0018264755758404755, "rlmodule_inference_timer": 3.339196050265723e-05, "num_env_steps_sampled_lifetime_throughput": 3227.2588457911625}, "learners": {"default_policy": {"diff_num_grad_updates_vs_sampler_policy": 1.0, "mean_kl_loss": 0.0018115785205736756, "num_module_steps_trained": 6000, "vf_explained_var": -0.010707616806030273, "entropy": 0.6465494632720947, "curr_entropy_coeff": 0.0090570820258, "num_trainable_parameters": 6003, "vf_loss_unclipped": 28.573688507080078, "gradients_default_optimizer_global_norm": 0.05181848257780075, "default_optimizer_learning_rate": 0.0002847858517, "module_train_batch_size_mean": 1000.0, "num_module_steps_trained_lifetime": 36000, "total_loss": 0.0240169670432806, "curr_kl_coeff": 0.011664004996418953, "policy_loss": -0.03891005367040634, "vf_loss": 0.10278083384037018, "weights_seq_no": 6.0, "num_module_steps_trained_lifetime_throughput": 467467.14145534864}, "__all_modules__": {"learner_connector": {"connector_pipeline_timer": 0.07979398035225461, "timers": {"connectors": {"add_one_ts_to_episodes_and_truncate": 0.0073565535997423895, "add_columns_from_episodes_to_train_batch": 0.033112084881100096, "general_advantage_estimation": 0.006978900588932353, "numpy_to_tensor": 6.962644784517548e-05, "batch_individual_items": 0.031340732349000866, "add_observations_from_episodes_to_batch": 0.0008088330103286998, "add_states_from_episodes_to_batch": 3.7351938986707827e-06, "add_time_dim_to_batch_and_zero_pad": 1.0316776641323419e-05}}}, "num_non_trainable_parameters": 0, "learner_connector_sum_episodes_length_in": 5000.0, "learner_connector_sum_episodes_length_out": 5250.0, "num_module_steps_trained": 6000, "num_trainable_parameters": 6003, "num_env_steps_trained_lifetime": 189000, "num_env_steps_trained": 31500, "num_module_steps_trained_lifetime": 36000, "num_env_steps_trained_lifetime_throughput": 2432033.716768868, "num_module_steps_trained_throughput": 465702.9155963723, "num_module_steps_trained_lifetime_throughput": 464804.31932197395}}, "num_training_step_calls_per_iteration": 1, "evaluation": {"env_runners": {"module_to_env_connector": {"timers": {"connectors": {"un_batch_to_individual_items": 5.595978959261077e-06, "listify_data_for_vector_env": 1.1402311358628027e-05, "remove_single_ts_time_rank_from_batch": 5.937840965608084e-07, "normalize_and_clip_actions": 9.885649696715744e-06, "tensor_to_numpy": 1.3476649529453078e-05, "get_actions": 3.878971775468496e-05}}, "connector_pipeline_timer": 0.0001065267360760077}, "agent_episode_returns_mean": {"default_agent": -1.55}, "sample": 0.0984585028569192, "env_step_timer": 1.5015842040190439e-05, "num_episodes": 20, "module_episode_returns_mean": {"default_policy": -1.55}, "episode_return_max": 14.5, "episode_return_min": -12.5, "rlmodule_inference_timer": 2.8599223513469623e-05, "env_to_module_connector": {"timers": {"connectors": {"numpy_to_tensor": 8.92495292888305e-06, "batch_individual_items": 6.678571676637816e-06, "add_observations_from_episodes_to_batch": 2.954328664193968e-06, "add_states_from_episodes_to_batch": 1.6276594045729212e-06, "add_time_dim_to_batch_and_zero_pad": 2.6977520396510486e-06}}, "connector_pipeline_timer": 4.562133859036517e-05}, "env_to_module_sum_episodes_length_in": 10.368238394470474, "episode_return_mean": -1.55, "episode_duration_sec_mean": 0.0048383858322631566, "episode_len_max": 20, "env_to_module_sum_episodes_length_out": 10.368238394470474, "env_reset_timer": 0.00025960089153901814, "num_agent_steps_sampled_lifetime": {"default_agent": 2400}, "episode_len_mean": 20.0, "num_module_steps_sampled_lifetime": {"default_policy": 2400}, "episode_len_min": 20, "num_agent_steps_sampled": {"default_agent": 400}, "weights_seq_no": 6.0, "num_module_steps_sampled": {"default_policy": 400}, "num_env_steps_sampled": 400, "num_episodes_lifetime": 120, "num_env_steps_sampled_lifetime": 30400, "time_between_sampling": 1.6438171885804704}, "num_healthy_workers": 1, "actor_manager_num_outstanding_async_reqs": 0, "num_remote_worker_restarts": 0}, "num_env_steps_sampled_lifetime": -2460000.0, "fault_tolerance": {"num_healthy_workers": 0, "num_remote_worker_restarts": 0}, "env_runner_group": {"actor_manager_num_outstanding_async_reqs": 0}, "done": false, "training_iteration": 6, "trial_id": "499df_00000", "date": "2025-08-11_19-37-08", "timestamp": 1754933828, "time_this_iter_s": 1.9598281383514404, "time_total_s": 10.68275237083435, "pid": 28380, "hostname": "Mac", "node_ip": "127.0.0.1", "config": {"exploration_config": {}, "extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "placement_strategy": "PACK", "num_gpus": 0, "_fake_gpus": false, "num_cpus_for_main_process": 2, "eager_tracing": true, "eager_max_retraces": 20, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "torch_compile_learner": false, "torch_compile_learner_what_to_compile": "forward_train", "torch_compile_learner_dynamo_backend": "aot_eager", "torch_compile_learner_dynamo_mode": null, "torch_compile_worker": false, "torch_compile_worker_dynamo_backend": "aot_eager", "torch_compile_worker_dynamo_mode": null, "torch_ddp_kwargs": {}, "torch_skip_nan_gradients": false, "env": "Umbrella", "env_config": {}, "observation_space": null, "action_space": null, "clip_rewards": null, "normalize_actions": true, "clip_actions": false, "_is_atari": null, "disable_env_checking": false, "render_env": false, "action_mask_key": "action_mask", "env_runner_cls": null, "num_env_runners": 0, "create_local_env_runner": true, "num_envs_per_env_runner": 1, "gym_env_vectorize_mode": "SYNC", "num_cpus_per_env_runner": 1, "num_gpus_per_env_runner": 0, "custom_resources_per_env_runner": {}, "validate_env_runners_after_construction": true, "episodes_to_numpy": true, "max_requests_in_flight_per_env_runner": 1, "sample_timeout_s": 60.0, "_env_to_module_connector": null, "add_default_connectors_to_env_to_module_pipeline": true, "_module_to_env_connector": null, "add_default_connectors_to_module_to_env_pipeline": true, "merge_env_runner_states": "training_only", "broadcast_env_runner_states": true, "episode_lookback_horizon": 1, "rollout_fragment_length": "auto", "batch_mode": "complete_episodes", "compress_observations": false, "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "enable_tf1_exec_eagerly": false, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "preprocessor_pref": "deepmind", "observation_filter": "NoFilter", "update_worker_filter_stats": true, "use_worker_filter_stats": true, "sampler_perf_stats_ema_coef": null, "_is_online": true, "num_learners": 0, "num_gpus_per_learner": 0, "num_cpus_per_learner": "auto", "num_aggregator_actors_per_learner": 0, "max_requests_in_flight_per_aggregator_actor": 3, "local_gpu_idx": 0, "max_requests_in_flight_per_learner": 3, "gamma": 1, "lr": 0.0002847858517, "grad_clip": 0.5, "grad_clip_by": "global_norm", "_train_batch_size_per_learner": 5000, "train_batch_size": 4000, "num_epochs": 1, "minibatch_size": 1000, "shuffle_batch_per_epoch": true, "model": {"fcnet_hiddens": [256, 256], "fcnet_activation": "tanh", "fcnet_weights_initializer": null, "fcnet_weights_initializer_config": null, "fcnet_bias_initializer": null, "fcnet_bias_initializer_config": null, "conv_filters": null, "conv_activation": "relu", "conv_kernel_initializer": null, "conv_kernel_initializer_config": null, "conv_bias_initializer": null, "conv_bias_initializer_config": null, "conv_transpose_kernel_initializer": null, "conv_transpose_kernel_initializer_config": null, "conv_transpose_bias_initializer": null, "conv_transpose_bias_initializer_config": null, "post_fcnet_hiddens": [], "post_fcnet_activation": "relu", "post_fcnet_weights_initializer": null, "post_fcnet_weights_initializer_config": null, "post_fcnet_bias_initializer": null, "post_fcnet_bias_initializer_config": null, "free_log_std": false, "log_std_clip_param": 20.0, "no_final_linear": false, "vf_share_layers": false, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "lstm_weights_initializer": null, "lstm_weights_initializer_config": null, "lstm_bias_initializer": null, "lstm_bias_initializer_config": null, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "attention_use_n_prev_actions": 0, "attention_use_n_prev_rewards": 0, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": null, "custom_model_config": {}, "custom_action_dist": null, "custom_preprocessor": null, "encoder_latent_dim": null, "always_check_shapes": false, "lstm_use_prev_action_reward": -1, "_use_default_native_models": -1, "_disable_preprocessor_api": false, "_disable_action_flattening": false}, "_learner_connector": null, "add_default_connectors_to_learner_pipeline": true, "learner_config_dict": {}, "optimizer": {}, "_learner_class": null, "callbacks_on_algorithm_init": null, "callbacks_on_env_runners_recreated": null, "callbacks_on_offline_eval_runners_recreated": null, "callbacks_on_checkpoint_loaded": null, "callbacks_on_environment_created": null, "callbacks_on_episode_created": null, "callbacks_on_episode_start": null, "callbacks_on_episode_step": null, "callbacks_on_episode_end": null, "callbacks_on_evaluate_start": null, "callbacks_on_evaluate_end": null, "callbacks_on_evaluate_offline_start": null, "callbacks_on_evaluate_offline_end": null, "callbacks_on_sample_end": null, "callbacks_on_train_result": null, "explore": true, "enable_rl_module_and_learner": true, "enable_env_runner_and_connector_v2": true, "_prior_exploration_config": {"type": "StochasticSampling"}, "count_steps_by": "env_steps", "policy_map_capacity": 100, "policy_mapping_fn": "<function AlgorithmConfig.DEFAULT_POLICY_MAPPING_FN at 0x13ca69b20>", "policies_to_train": null, "policy_states_are_swappable": false, "observation_fn": null, "offline_data_class": null, "input_read_method": "read_parquet", "input_read_method_kwargs": {}, "input_read_schema": {}, "input_read_episodes": false, "input_read_sample_batches": false, "input_read_batch_size": null, "input_filesystem": null, "input_filesystem_kwargs": {}, "input_compress_columns": ["obs", "new_obs"], "input_spaces_jsonable": true, "materialize_data": false, "materialize_mapped_data": true, "map_batches_kwargs": {}, "iter_batches_kwargs": {}, "ignore_final_observation": false, "prelearner_class": null, "prelearner_buffer_class": null, "prelearner_buffer_kwargs": {}, "prelearner_module_synch_period": 10, "dataset_num_iters_per_learner": null, "input_config": {}, "actions_in_input_normalized": false, "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_config": {}, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "output_max_rows_per_file": null, "output_write_remaining_data": false, "output_write_method": "write_parquet", "output_write_method_kwargs": {}, "output_filesystem": null, "output_filesystem_kwargs": {}, "output_write_episodes": true, "offline_sampling": false, "evaluation_interval": 1, "evaluation_duration": 20, "evaluation_duration_unit": "episodes", "evaluation_sample_timeout_s": 120.0, "evaluation_auto_duration_min_env_steps_per_sample": 100, "evaluation_auto_duration_max_env_steps_per_sample": 2000, "evaluation_parallel_to_training": false, "evaluation_force_reset_envs_before_iteration": true, "evaluation_config": null, "off_policy_estimation_methods": {}, "ope_split_batch_by_episode": true, "evaluation_num_env_runners": 1, "in_evaluation": false, "sync_filters_on_rollout_workers_timeout_s": 10.0, "offline_evaluation_interval": null, "num_offline_eval_runners": 0, "offline_loss_for_module_fn": null, "offline_evaluation_duration": 1, "offline_evaluation_parallel_to_training": false, "offline_evaluation_timeout_s": 120.0, "num_cpus_per_offline_eval_runner": 1, "num_gpus_per_offline_eval_runner": 0, "custom_resources_per_offline_eval_runner": {}, "restart_failed_offline_eval_runners": true, "ignore_offline_eval_runner_failures": false, "max_num_offline_eval_runner_restarts": 1000, "offline_eval_runner_restore_timeout_s": 1800.0, "max_requests_in_flight_per_offline_eval_runner": 1, "validate_offline_eval_runners_after_construction": true, "offline_eval_runner_health_probe_timeout_s": 30.0, "offline_eval_rl_module_inference_only": false, "broadcast_offline_eval_runner_states": false, "offline_eval_batch_size_per_runner": 256, "dataset_num_iters_per_eval_runner": 1, "keep_per_episode_custom_metrics": false, "metrics_episode_collection_timeout_s": 60.0, "metrics_num_episodes_for_smoothing": 100, "min_time_s_per_iteration": null, "min_train_timesteps_per_iteration": 0, "min_sample_timesteps_per_iteration": 0, "log_gradients": true, "export_native_model_files": false, "checkpoint_trainable_policies_only": false, "logger_creator": null, "logger_config": null, "log_level": "WARN", "log_sys_usage": true, "fake_sampler": false, "seed": 7, "restart_failed_env_runners": true, "ignore_env_runner_failures": false, "max_num_env_runner_restarts": 1000, "delay_between_env_runner_restarts_s": 60.0, "restart_failed_sub_environments": false, "num_consecutive_env_runner_failures_tolerance": 100, "env_runner_health_probe_timeout_s": 30.0, "env_runner_restore_timeout_s": 1800.0, "_model_config": {}, "_rl_module_spec": "RLModuleSpec(module_class=None, observation_space=None, action_space=None, inference_only=False, learner_only=False, model_config=DefaultModelConfig(fcnet_hiddens=[60, 90], fcnet_activation='tanh', fcnet_kernel_initializer=None, fcnet_kernel_initializer_kwargs=None, fcnet_bias_initializer=None, fcnet_bias_initializer_kwargs=None, conv_filters=None, conv_activation='relu', conv_kernel_initializer=None, conv_kernel_initializer_kwargs=None, conv_bias_initializer=None, conv_bias_initializer_kwargs=None, head_fcnet_hiddens=[], head_fcnet_activation='relu', head_fcnet_kernel_initializer=None, head_fcnet_kernel_initializer_kwargs=None, head_fcnet_bias_initializer=None, head_fcnet_bias_initializer_kwargs=None, free_log_std=False, log_std_clip_param=20.0, vf_share_layers=True, use_lstm=False, max_seq_len=20, lstm_cell_size=256, lstm_use_prev_action=False, lstm_use_prev_reward=False, lstm_kernel_initializer=None, lstm_kernel_initializer_kwargs=None, lstm_bias_initializer=None, lstm_bias_initializer_kwargs=None), catalog_class=None, load_state_path=None, model_config_dict=None)", "algorithm_config_overrides_per_module": {}, "_per_module_overrides": {}, "_validate_config": true, "_use_msgpack_checkpoints": false, "_torch_grad_scaler_class": null, "_torch_lr_scheduler_classes": null, "_tf_policy_handles_more_than_one_loss": false, "_disable_preprocessor_api": false, "_disable_action_flattening": false, "_disable_initialize_loss_from_dummy_batch": false, "_dont_auto_sync_env_runner_states": false, "env_task_fn": -1, "enable_connectors": -1, "simple_optimizer": false, "policy_map_cache": -1, "worker_cls": -1, "synchronize_filters": -1, "enable_async_evaluation": -1, "custom_async_evaluation_function": -1, "_enable_rl_module_api": -1, "auto_wrap_old_gym_envs": -1, "always_attach_evaluation_results": -1, "replay_sequence_length": null, "_disable_execution_plan_api": -1, "use_critic": true, "use_gae": true, "use_kl_loss": true, "kl_coeff": 0.7464963036515, "kl_target": 0.0270990929592, "vf_loss_coeff": 0.6688075857018, "entropy_coeff": 0.0090570820258, "clip_param": 0.1221781641624, "vf_clip_param": 0.1027808522125, "entropy_coeff_schedule": null, "lr_schedule": null, "sgd_minibatch_size": -1, "vf_share_layers": -1, "__stdout_file__": null, "__stderr_file__": null, "lambda": 0.9099046732075, "input": "sampler", "policies": {"default_policy": [null, null, null, null]}, "callbacks": "<class 'ray.rllib.callbacks.callbacks.RLlibCallback'>", "create_env_on_driver": false, "custom_eval_function": null, "framework": "torch"}, "time_since_restore": 10.68275237083435, "iterations_since_restore": 6, "perf": {"cpu_util_percent": 47.666666666666664, "ram_util_percent": 80.06666666666666}}
{"timers": {"training_iteration": 1.5476177692257742, "restore_env_runners": 1.139524279606213e-05, "training_step": 1.5474301960733097, "env_runner_sampling_timer": 1.4401034427384902, "learner_update_timer": 0.10428997860347657, "synch_weights": 0.0004892251896061702, "restore_eval_env_runners": 1.0048424562569884e-05, "evaluation_iteration": 0.10608283737915732, "synch_eval_env_connectors": 0.00012439933056275702, "synch_env_connectors": 4.791763577706332e-06}, "env_runners": {"weights_seq_no": 6.0, "module_to_env_connector": {"timers": {"connectors": {"tensor_to_numpy": 1.3015571531883838e-05, "listify_data_for_vector_env": 1.1169797195748246e-05, "remove_single_ts_time_rank_from_batch": 5.91512382077893e-07, "get_actions": 3.77867041407362e-05, "normalize_and_clip_actions": 9.42344546728503e-06, "un_batch_to_individual_items": 5.4215607978282744e-06}}, "connector_pipeline_timer": 0.00010259284086521128}, "episode_len_mean": 20.0, "num_agent_steps_sampled_lifetime": {"default_agent": -3077500.0}, "num_agent_steps_sampled": {"default_agent": 5000.0}, "sample": 0.0051739657230980216, "env_to_module_connector": {"timers": {"connectors": {"batch_individual_items": 6.420809785771001e-06, "add_observations_from_episodes_to_batch": 2.983629230766672e-06, "add_states_from_episodes_to_batch": 1.7274839027445892e-06, "add_time_dim_to_batch_and_zero_pad": 2.3349667091929278e-06, "numpy_to_tensor": 8.664105682872535e-06}}, "connector_pipeline_timer": 4.3511537533517945e-05}, "env_step_timer": 1.378116930851969e-05, "num_episodes": 250.0, "episode_len_min": 20, "num_module_steps_sampled_lifetime": {"default_policy": -3077500.0}, "env_to_module_sum_episodes_length_in": 10.36823839457432, "agent_episode_returns_mean": {"default_agent": 3.7}, "num_env_steps_sampled": 5000.0, "episode_return_mean": 3.7, "num_module_steps_sampled": {"default_policy": 5000.0}, "episode_duration_sec_mean": 0.004519309323281049, "module_episode_returns_mean": {"default_policy": 3.7}, "num_episodes_lifetime": -153875.0, "episode_return_max": 10.5, "episode_len_max": 20, "env_to_module_sum_episodes_length_out": 10.36823839457432, "episode_return_min": -9.5, "num_env_steps_sampled_lifetime": -3077500.0, "env_reset_timer": 4.071402809791215e-05, "time_between_sampling": 0.0019187909450444547, "rlmodule_inference_timer": 2.7560402547181875e-05, "num_env_steps_sampled_lifetime_throughput": 3774.0831126975754}, "learners": {"default_policy": {"diff_num_grad_updates_vs_sampler_policy": 1.0, "mean_kl_loss": 0.00035054117324762046, "num_module_steps_trained": 6000, "vf_explained_var": -0.010732293128967285, "entropy": 0.6365110874176025, "curr_entropy_coeff": 0.0090570820258, "num_trainable_parameters": 6003, "vf_loss_unclipped": 28.70351791381836, "gradients_default_optimizer_global_norm": 0.12011439353227615, "default_optimizer_learning_rate": 0.0002847858517, "module_train_batch_size_mean": 1000.0, "num_module_steps_trained_lifetime": 42000, "total_loss": 0.24163073301315308, "curr_kl_coeff": 0.0058320024982094765, "policy_loss": 0.17865099012851715, "vf_loss": 0.10278083384037018, "weights_seq_no": 7.0, "num_module_steps_trained_lifetime_throughput": 465817.17353122967}, "__all_modules__": {"learner_connector": {"connector_pipeline_timer": 0.07981073179871172, "timers": {"connectors": {"add_one_ts_to_episodes_and_truncate": 0.0073611134840042775, "add_columns_from_episodes_to_train_batch": 0.033136172781240654, "general_advantage_estimation": 0.006965632422031975, "numpy_to_tensor": 6.957685301717407e-05, "batch_individual_items": 0.03134203252660379, "add_observations_from_episodes_to_batch": 0.0008089355202424634, "add_states_from_episodes_to_batch": 3.7320121849467166e-06, "add_time_dim_to_batch_and_zero_pad": 1.0335688966297218e-05}}}, "num_non_trainable_parameters": 0, "learner_connector_sum_episodes_length_in": 5000.0, "learner_connector_sum_episodes_length_out": 5250.0, "num_module_steps_trained": 6000, "num_trainable_parameters": 6003, "num_env_steps_trained_lifetime": 220500, "num_env_steps_trained": 31500, "num_module_steps_trained_lifetime": 42000, "num_env_steps_trained_lifetime_throughput": 2424394.5945516494, "num_module_steps_trained_throughput": 464157.5152132348, "num_module_steps_trained_lifetime_throughput": 463287.1216138154}}, "num_training_step_calls_per_iteration": 1, "evaluation": {"env_runners": {"module_to_env_connector": {"timers": {"connectors": {"un_batch_to_individual_items": 5.464476961168672e-06, "listify_data_for_vector_env": 1.122051424133114e-05, "remove_single_ts_time_rank_from_batch": 5.768916637748417e-07, "normalize_and_clip_actions": 9.58574658222567e-06, "tensor_to_numpy": 1.3025635019371762e-05, "get_actions": 3.6554947092685604e-05}}, "connector_pipeline_timer": 0.00010216476813163499}, "agent_episode_returns_mean": {"default_agent": -1.35}, "sample": 0.09846441407821947, "env_step_timer": 1.4236206168907144e-05, "num_episodes": 20, "module_episode_returns_mean": {"default_policy": -1.35}, "episode_return_max": 14.5, "episode_return_min": -12.5, "rlmodule_inference_timer": 2.7009943440180554e-05, "env_to_module_connector": {"timers": {"connectors": {"numpy_to_tensor": 8.508251519529524e-06, "batch_individual_items": 6.125645891982862e-06, "add_observations_from_episodes_to_batch": 2.825789684139988e-06, "add_states_from_episodes_to_batch": 1.5709561023493713e-06, "add_time_dim_to_batch_and_zero_pad": 2.250092059891462e-06}}, "connector_pipeline_timer": 4.266209732614024e-05}, "env_to_module_sum_episodes_length_in": 10.368238394572801, "episode_return_mean": -1.35, "episode_duration_sec_mean": 0.0046941408328711985, "episode_len_max": 20, "env_to_module_sum_episodes_length_out": 10.368238394572801, "env_reset_timer": 0.00025772113254778105, "num_agent_steps_sampled_lifetime": {"default_agent": 2800}, "episode_len_mean": 20.0, "num_module_steps_sampled_lifetime": {"default_policy": 2800}, "episode_len_min": 20, "num_agent_steps_sampled": {"default_agent": 400}, "weights_seq_no": 7.0, "num_module_steps_sampled": {"default_policy": 400}, "num_env_steps_sampled": 400, "num_episodes_lifetime": 140, "num_env_steps_sampled_lifetime": 35400, "time_between_sampling": 1.6422221191949742}, "num_healthy_workers": 1, "actor_manager_num_outstanding_async_reqs": 0, "num_remote_worker_restarts": 0}, "num_env_steps_sampled_lifetime": -3077500.0, "fault_tolerance": {"num_healthy_workers": 0, "num_remote_worker_restarts": 0}, "env_runner_group": {"actor_manager_num_outstanding_async_reqs": 0}, "done": false, "training_iteration": 7, "trial_id": "499df_00000", "date": "2025-08-11_19-37-09", "timestamp": 1754933829, "time_this_iter_s": 1.5723929405212402, "time_total_s": 12.25514531135559, "pid": 28380, "hostname": "Mac", "node_ip": "127.0.0.1", "config": {"exploration_config": {}, "extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "placement_strategy": "PACK", "num_gpus": 0, "_fake_gpus": false, "num_cpus_for_main_process": 2, "eager_tracing": true, "eager_max_retraces": 20, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "torch_compile_learner": false, "torch_compile_learner_what_to_compile": "forward_train", "torch_compile_learner_dynamo_backend": "aot_eager", "torch_compile_learner_dynamo_mode": null, "torch_compile_worker": false, "torch_compile_worker_dynamo_backend": "aot_eager", "torch_compile_worker_dynamo_mode": null, "torch_ddp_kwargs": {}, "torch_skip_nan_gradients": false, "env": "Umbrella", "env_config": {}, "observation_space": null, "action_space": null, "clip_rewards": null, "normalize_actions": true, "clip_actions": false, "_is_atari": null, "disable_env_checking": false, "render_env": false, "action_mask_key": "action_mask", "env_runner_cls": null, "num_env_runners": 0, "create_local_env_runner": true, "num_envs_per_env_runner": 1, "gym_env_vectorize_mode": "SYNC", "num_cpus_per_env_runner": 1, "num_gpus_per_env_runner": 0, "custom_resources_per_env_runner": {}, "validate_env_runners_after_construction": true, "episodes_to_numpy": true, "max_requests_in_flight_per_env_runner": 1, "sample_timeout_s": 60.0, "_env_to_module_connector": null, "add_default_connectors_to_env_to_module_pipeline": true, "_module_to_env_connector": null, "add_default_connectors_to_module_to_env_pipeline": true, "merge_env_runner_states": "training_only", "broadcast_env_runner_states": true, "episode_lookback_horizon": 1, "rollout_fragment_length": "auto", "batch_mode": "complete_episodes", "compress_observations": false, "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "enable_tf1_exec_eagerly": false, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "preprocessor_pref": "deepmind", "observation_filter": "NoFilter", "update_worker_filter_stats": true, "use_worker_filter_stats": true, "sampler_perf_stats_ema_coef": null, "_is_online": true, "num_learners": 0, "num_gpus_per_learner": 0, "num_cpus_per_learner": "auto", "num_aggregator_actors_per_learner": 0, "max_requests_in_flight_per_aggregator_actor": 3, "local_gpu_idx": 0, "max_requests_in_flight_per_learner": 3, "gamma": 1, "lr": 0.0002847858517, "grad_clip": 0.5, "grad_clip_by": "global_norm", "_train_batch_size_per_learner": 5000, "train_batch_size": 4000, "num_epochs": 1, "minibatch_size": 1000, "shuffle_batch_per_epoch": true, "model": {"fcnet_hiddens": [256, 256], "fcnet_activation": "tanh", "fcnet_weights_initializer": null, "fcnet_weights_initializer_config": null, "fcnet_bias_initializer": null, "fcnet_bias_initializer_config": null, "conv_filters": null, "conv_activation": "relu", "conv_kernel_initializer": null, "conv_kernel_initializer_config": null, "conv_bias_initializer": null, "conv_bias_initializer_config": null, "conv_transpose_kernel_initializer": null, "conv_transpose_kernel_initializer_config": null, "conv_transpose_bias_initializer": null, "conv_transpose_bias_initializer_config": null, "post_fcnet_hiddens": [], "post_fcnet_activation": "relu", "post_fcnet_weights_initializer": null, "post_fcnet_weights_initializer_config": null, "post_fcnet_bias_initializer": null, "post_fcnet_bias_initializer_config": null, "free_log_std": false, "log_std_clip_param": 20.0, "no_final_linear": false, "vf_share_layers": false, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "lstm_weights_initializer": null, "lstm_weights_initializer_config": null, "lstm_bias_initializer": null, "lstm_bias_initializer_config": null, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "attention_use_n_prev_actions": 0, "attention_use_n_prev_rewards": 0, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": null, "custom_model_config": {}, "custom_action_dist": null, "custom_preprocessor": null, "encoder_latent_dim": null, "always_check_shapes": false, "lstm_use_prev_action_reward": -1, "_use_default_native_models": -1, "_disable_preprocessor_api": false, "_disable_action_flattening": false}, "_learner_connector": null, "add_default_connectors_to_learner_pipeline": true, "learner_config_dict": {}, "optimizer": {}, "_learner_class": null, "callbacks_on_algorithm_init": null, "callbacks_on_env_runners_recreated": null, "callbacks_on_offline_eval_runners_recreated": null, "callbacks_on_checkpoint_loaded": null, "callbacks_on_environment_created": null, "callbacks_on_episode_created": null, "callbacks_on_episode_start": null, "callbacks_on_episode_step": null, "callbacks_on_episode_end": null, "callbacks_on_evaluate_start": null, "callbacks_on_evaluate_end": null, "callbacks_on_evaluate_offline_start": null, "callbacks_on_evaluate_offline_end": null, "callbacks_on_sample_end": null, "callbacks_on_train_result": null, "explore": true, "enable_rl_module_and_learner": true, "enable_env_runner_and_connector_v2": true, "_prior_exploration_config": {"type": "StochasticSampling"}, "count_steps_by": "env_steps", "policy_map_capacity": 100, "policy_mapping_fn": "<function AlgorithmConfig.DEFAULT_POLICY_MAPPING_FN at 0x13ca69b20>", "policies_to_train": null, "policy_states_are_swappable": false, "observation_fn": null, "offline_data_class": null, "input_read_method": "read_parquet", "input_read_method_kwargs": {}, "input_read_schema": {}, "input_read_episodes": false, "input_read_sample_batches": false, "input_read_batch_size": null, "input_filesystem": null, "input_filesystem_kwargs": {}, "input_compress_columns": ["obs", "new_obs"], "input_spaces_jsonable": true, "materialize_data": false, "materialize_mapped_data": true, "map_batches_kwargs": {}, "iter_batches_kwargs": {}, "ignore_final_observation": false, "prelearner_class": null, "prelearner_buffer_class": null, "prelearner_buffer_kwargs": {}, "prelearner_module_synch_period": 10, "dataset_num_iters_per_learner": null, "input_config": {}, "actions_in_input_normalized": false, "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_config": {}, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "output_max_rows_per_file": null, "output_write_remaining_data": false, "output_write_method": "write_parquet", "output_write_method_kwargs": {}, "output_filesystem": null, "output_filesystem_kwargs": {}, "output_write_episodes": true, "offline_sampling": false, "evaluation_interval": 1, "evaluation_duration": 20, "evaluation_duration_unit": "episodes", "evaluation_sample_timeout_s": 120.0, "evaluation_auto_duration_min_env_steps_per_sample": 100, "evaluation_auto_duration_max_env_steps_per_sample": 2000, "evaluation_parallel_to_training": false, "evaluation_force_reset_envs_before_iteration": true, "evaluation_config": null, "off_policy_estimation_methods": {}, "ope_split_batch_by_episode": true, "evaluation_num_env_runners": 1, "in_evaluation": false, "sync_filters_on_rollout_workers_timeout_s": 10.0, "offline_evaluation_interval": null, "num_offline_eval_runners": 0, "offline_loss_for_module_fn": null, "offline_evaluation_duration": 1, "offline_evaluation_parallel_to_training": false, "offline_evaluation_timeout_s": 120.0, "num_cpus_per_offline_eval_runner": 1, "num_gpus_per_offline_eval_runner": 0, "custom_resources_per_offline_eval_runner": {}, "restart_failed_offline_eval_runners": true, "ignore_offline_eval_runner_failures": false, "max_num_offline_eval_runner_restarts": 1000, "offline_eval_runner_restore_timeout_s": 1800.0, "max_requests_in_flight_per_offline_eval_runner": 1, "validate_offline_eval_runners_after_construction": true, "offline_eval_runner_health_probe_timeout_s": 30.0, "offline_eval_rl_module_inference_only": false, "broadcast_offline_eval_runner_states": false, "offline_eval_batch_size_per_runner": 256, "dataset_num_iters_per_eval_runner": 1, "keep_per_episode_custom_metrics": false, "metrics_episode_collection_timeout_s": 60.0, "metrics_num_episodes_for_smoothing": 100, "min_time_s_per_iteration": null, "min_train_timesteps_per_iteration": 0, "min_sample_timesteps_per_iteration": 0, "log_gradients": true, "export_native_model_files": false, "checkpoint_trainable_policies_only": false, "logger_creator": null, "logger_config": null, "log_level": "WARN", "log_sys_usage": true, "fake_sampler": false, "seed": 7, "restart_failed_env_runners": true, "ignore_env_runner_failures": false, "max_num_env_runner_restarts": 1000, "delay_between_env_runner_restarts_s": 60.0, "restart_failed_sub_environments": false, "num_consecutive_env_runner_failures_tolerance": 100, "env_runner_health_probe_timeout_s": 30.0, "env_runner_restore_timeout_s": 1800.0, "_model_config": {}, "_rl_module_spec": "RLModuleSpec(module_class=None, observation_space=None, action_space=None, inference_only=False, learner_only=False, model_config=DefaultModelConfig(fcnet_hiddens=[60, 90], fcnet_activation='tanh', fcnet_kernel_initializer=None, fcnet_kernel_initializer_kwargs=None, fcnet_bias_initializer=None, fcnet_bias_initializer_kwargs=None, conv_filters=None, conv_activation='relu', conv_kernel_initializer=None, conv_kernel_initializer_kwargs=None, conv_bias_initializer=None, conv_bias_initializer_kwargs=None, head_fcnet_hiddens=[], head_fcnet_activation='relu', head_fcnet_kernel_initializer=None, head_fcnet_kernel_initializer_kwargs=None, head_fcnet_bias_initializer=None, head_fcnet_bias_initializer_kwargs=None, free_log_std=False, log_std_clip_param=20.0, vf_share_layers=True, use_lstm=False, max_seq_len=20, lstm_cell_size=256, lstm_use_prev_action=False, lstm_use_prev_reward=False, lstm_kernel_initializer=None, lstm_kernel_initializer_kwargs=None, lstm_bias_initializer=None, lstm_bias_initializer_kwargs=None), catalog_class=None, load_state_path=None, model_config_dict=None)", "algorithm_config_overrides_per_module": {}, "_per_module_overrides": {}, "_validate_config": true, "_use_msgpack_checkpoints": false, "_torch_grad_scaler_class": null, "_torch_lr_scheduler_classes": null, "_tf_policy_handles_more_than_one_loss": false, "_disable_preprocessor_api": false, "_disable_action_flattening": false, "_disable_initialize_loss_from_dummy_batch": false, "_dont_auto_sync_env_runner_states": false, "env_task_fn": -1, "enable_connectors": -1, "simple_optimizer": false, "policy_map_cache": -1, "worker_cls": -1, "synchronize_filters": -1, "enable_async_evaluation": -1, "custom_async_evaluation_function": -1, "_enable_rl_module_api": -1, "auto_wrap_old_gym_envs": -1, "always_attach_evaluation_results": -1, "replay_sequence_length": null, "_disable_execution_plan_api": -1, "use_critic": true, "use_gae": true, "use_kl_loss": true, "kl_coeff": 0.7464963036515, "kl_target": 0.0270990929592, "vf_loss_coeff": 0.6688075857018, "entropy_coeff": 0.0090570820258, "clip_param": 0.1221781641624, "vf_clip_param": 0.1027808522125, "entropy_coeff_schedule": null, "lr_schedule": null, "sgd_minibatch_size": -1, "vf_share_layers": -1, "__stdout_file__": null, "__stderr_file__": null, "lambda": 0.9099046732075, "input": "sampler", "policies": {"default_policy": [null, null, null, null]}, "callbacks": "<class 'ray.rllib.callbacks.callbacks.RLlibCallback'>", "create_env_on_driver": false, "custom_eval_function": null, "framework": "torch"}, "time_since_restore": 12.25514531135559, "iterations_since_restore": 7, "perf": {"cpu_util_percent": 18.75, "ram_util_percent": 79.3}}
{"timers": {"training_iteration": 1.5474824819534188, "restore_env_runners": 1.1334630704409392e-05, "training_step": 1.5472939761932836, "env_runner_sampling_timer": 1.4399961674817923, "learner_update_timer": 0.10422203297807064, "synch_weights": 0.0004925033573155573, "restore_eval_env_runners": 1.0025860584302608e-05, "evaluation_iteration": 0.10606025317526965, "synch_eval_env_connectors": 0.00012424242818896223, "synch_env_connectors": 4.786765942780423e-06}, "env_runners": {"weights_seq_no": 7.0, "module_to_env_connector": {"timers": {"connectors": {"tensor_to_numpy": 1.2921349309536137e-05, "listify_data_for_vector_env": 1.0789898356155246e-05, "remove_single_ts_time_rank_from_batch": 5.795610899985984e-07, "get_actions": 3.690876836343272e-05, "normalize_and_clip_actions": 9.325668745907182e-06, "un_batch_to_individual_items": 5.348465376255959e-06}}, "connector_pipeline_timer": 0.0001008036802271535}, "episode_len_mean": 20.0, "num_agent_steps_sampled_lifetime": {"default_agent": -3695000.0}, "num_agent_steps_sampled": {"default_agent": 5000.0}, "sample": 0.005042543307709561, "env_to_module_connector": {"timers": {"connectors": {"batch_individual_items": 6.335015353590393e-06, "add_observations_from_episodes_to_batch": 3.0250907544603537e-06, "add_states_from_episodes_to_batch": 1.725404328228099e-06, "add_time_dim_to_batch_and_zero_pad": 2.2988962557977346e-06, "numpy_to_tensor": 8.396857614858463e-06}}, "connector_pipeline_timer": 4.2959202946927336e-05}, "env_step_timer": 1.3581551717383692e-05, "num_episodes": 250.0, "episode_len_min": 20, "num_module_steps_sampled_lifetime": {"default_policy": -3695000.0}, "env_to_module_sum_episodes_length_in": 10.36823839457432, "agent_episode_returns_mean": {"default_agent": 5.14}, "num_env_steps_sampled": 5000.0, "episode_return_mean": 5.14, "num_module_steps_sampled": {"default_policy": 5000.0}, "episode_duration_sec_mean": 0.004785855475347489, "module_episode_returns_mean": {"default_policy": 5.14}, "num_episodes_lifetime": -184750.0, "episode_return_max": 10.5, "episode_len_max": 20, "env_to_module_sum_episodes_length_out": 10.36823839457432, "episode_return_min": -9.5, "num_env_steps_sampled_lifetime": -3695000.0, "env_reset_timer": 3.282897580932319e-05, "time_between_sampling": 0.0015191496997151504, "rlmodule_inference_timer": 4.274894183877621e-05, "num_env_steps_sampled_lifetime_throughput": 3813.145387515432}, "learners": {"default_policy": {"diff_num_grad_updates_vs_sampler_policy": 1.0, "mean_kl_loss": 0.0007228472968563437, "num_module_steps_trained": 6000, "vf_explained_var": -0.009645938873291016, "entropy": 0.6174891591072083, "curr_entropy_coeff": 0.0090570820258, "num_trainable_parameters": 6003, "vf_loss_unclipped": 28.108274459838867, "gradients_default_optimizer_global_norm": 0.016537001356482506, "default_optimizer_learning_rate": 0.0002847858517, "module_train_batch_size_mean": 1000.0, "num_module_steps_trained_lifetime": 48000, "total_loss": -0.16482774913311005, "curr_kl_coeff": 0.0029160012491047382, "policy_loss": -0.22797994315624237, "vf_loss": 0.10278083384037018, "weights_seq_no": 8.0, "num_module_steps_trained_lifetime_throughput": 463856.3378285094}, "__all_modules__": {"learner_connector": {"connector_pipeline_timer": 0.0798355632312226, "timers": {"connectors": {"add_one_ts_to_episodes_and_truncate": 0.007366655269680442, "add_columns_from_episodes_to_train_batch": 0.03315390063355063, "general_advantage_estimation": 0.006950438187713445, "numpy_to_tensor": 6.983149451778454e-05, "batch_individual_items": 0.03135418637190298, "add_observations_from_episodes_to_batch": 0.0008130699158585595, "add_states_from_episodes_to_batch": 3.728442029048096e-06, "add_time_dim_to_batch_and_zero_pad": 1.0346912692989188e-05}}}, "num_non_trainable_parameters": 0, "learner_connector_sum_episodes_length_in": 5000.0, "learner_connector_sum_episodes_length_out": 5250.0, "num_module_steps_trained": 6000, "num_trainable_parameters": 6003, "num_env_steps_trained_lifetime": 252000, "num_env_steps_trained": 31500, "num_module_steps_trained_lifetime": 48000, "num_env_steps_trained_lifetime_throughput": 2415115.991327166, "num_module_steps_trained_throughput": 462300.3616718165, "num_module_steps_trained_lifetime_throughput": 461458.1527521028}}, "num_training_step_calls_per_iteration": 1, "evaluation": {"env_runners": {"module_to_env_connector": {"timers": {"connectors": {"un_batch_to_individual_items": 5.445503747289601e-06, "listify_data_for_vector_env": 1.1180311762027547e-05, "remove_single_ts_time_rank_from_batch": 5.755041547880124e-07, "normalize_and_clip_actions": 9.666879634941994e-06, "tensor_to_numpy": 1.3326087614105052e-05, "get_actions": 3.768660929406047e-05}}, "connector_pipeline_timer": 0.00010361675871526499}, "agent_episode_returns_mean": {"default_agent": -0.75}, "sample": 0.09850893368779147, "env_step_timer": 1.4386134399377006e-05, "num_episodes": 20, "module_episode_returns_mean": {"default_policy": -0.75}, "episode_return_max": 12.5, "episode_return_min": -12.5, "rlmodule_inference_timer": 2.7885886570699848e-05, "env_to_module_connector": {"timers": {"connectors": {"numpy_to_tensor": 8.695130222558926e-06, "batch_individual_items": 6.274746881448596e-06, "add_observations_from_episodes_to_batch": 2.8377496446454065e-06, "add_states_from_episodes_to_batch": 1.601986633318689e-06, "add_time_dim_to_batch_and_zero_pad": 2.296377874869636e-06}}, "connector_pipeline_timer": 4.330061857706225e-05}, "env_to_module_sum_episodes_length_in": 10.3682383945743, "episode_return_mean": -0.75, "episode_duration_sec_mean": 0.004727270838338881, "episode_len_max": 20, "env_to_module_sum_episodes_length_out": 10.3682383945743, "env_reset_timer": 0.0002562335011137167, "num_agent_steps_sampled_lifetime": {"default_agent": 3200}, "episode_len_mean": 20.0, "num_module_steps_sampled_lifetime": {"default_policy": 3200}, "episode_len_min": 20, "num_agent_steps_sampled": {"default_agent": 400}, "weights_seq_no": 8.0, "num_module_steps_sampled": {"default_policy": 400}, "num_env_steps_sampled": 400, "num_episodes_lifetime": 160, "num_env_steps_sampled_lifetime": 40400, "time_between_sampling": 1.6413784042531916}, "num_healthy_workers": 1, "actor_manager_num_outstanding_async_reqs": 0, "num_remote_worker_restarts": 0}, "num_env_steps_sampled_lifetime": -3695000.0, "fault_tolerance": {"num_healthy_workers": 0, "num_remote_worker_restarts": 0}, "env_runner_group": {"actor_manager_num_outstanding_async_reqs": 0}, "done": false, "training_iteration": 8, "trial_id": "499df_00000", "date": "2025-08-11_19-37-11", "timestamp": 1754933831, "time_this_iter_s": 1.6515967845916748, "time_total_s": 13.906742095947266, "pid": 28380, "hostname": "Mac", "node_ip": "127.0.0.1", "config": {"exploration_config": {}, "extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "placement_strategy": "PACK", "num_gpus": 0, "_fake_gpus": false, "num_cpus_for_main_process": 2, "eager_tracing": true, "eager_max_retraces": 20, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "torch_compile_learner": false, "torch_compile_learner_what_to_compile": "forward_train", "torch_compile_learner_dynamo_backend": "aot_eager", "torch_compile_learner_dynamo_mode": null, "torch_compile_worker": false, "torch_compile_worker_dynamo_backend": "aot_eager", "torch_compile_worker_dynamo_mode": null, "torch_ddp_kwargs": {}, "torch_skip_nan_gradients": false, "env": "Umbrella", "env_config": {}, "observation_space": null, "action_space": null, "clip_rewards": null, "normalize_actions": true, "clip_actions": false, "_is_atari": null, "disable_env_checking": false, "render_env": false, "action_mask_key": "action_mask", "env_runner_cls": null, "num_env_runners": 0, "create_local_env_runner": true, "num_envs_per_env_runner": 1, "gym_env_vectorize_mode": "SYNC", "num_cpus_per_env_runner": 1, "num_gpus_per_env_runner": 0, "custom_resources_per_env_runner": {}, "validate_env_runners_after_construction": true, "episodes_to_numpy": true, "max_requests_in_flight_per_env_runner": 1, "sample_timeout_s": 60.0, "_env_to_module_connector": null, "add_default_connectors_to_env_to_module_pipeline": true, "_module_to_env_connector": null, "add_default_connectors_to_module_to_env_pipeline": true, "merge_env_runner_states": "training_only", "broadcast_env_runner_states": true, "episode_lookback_horizon": 1, "rollout_fragment_length": "auto", "batch_mode": "complete_episodes", "compress_observations": false, "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "enable_tf1_exec_eagerly": false, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "preprocessor_pref": "deepmind", "observation_filter": "NoFilter", "update_worker_filter_stats": true, "use_worker_filter_stats": true, "sampler_perf_stats_ema_coef": null, "_is_online": true, "num_learners": 0, "num_gpus_per_learner": 0, "num_cpus_per_learner": "auto", "num_aggregator_actors_per_learner": 0, "max_requests_in_flight_per_aggregator_actor": 3, "local_gpu_idx": 0, "max_requests_in_flight_per_learner": 3, "gamma": 1, "lr": 0.0002847858517, "grad_clip": 0.5, "grad_clip_by": "global_norm", "_train_batch_size_per_learner": 5000, "train_batch_size": 4000, "num_epochs": 1, "minibatch_size": 1000, "shuffle_batch_per_epoch": true, "model": {"fcnet_hiddens": [256, 256], "fcnet_activation": "tanh", "fcnet_weights_initializer": null, "fcnet_weights_initializer_config": null, "fcnet_bias_initializer": null, "fcnet_bias_initializer_config": null, "conv_filters": null, "conv_activation": "relu", "conv_kernel_initializer": null, "conv_kernel_initializer_config": null, "conv_bias_initializer": null, "conv_bias_initializer_config": null, "conv_transpose_kernel_initializer": null, "conv_transpose_kernel_initializer_config": null, "conv_transpose_bias_initializer": null, "conv_transpose_bias_initializer_config": null, "post_fcnet_hiddens": [], "post_fcnet_activation": "relu", "post_fcnet_weights_initializer": null, "post_fcnet_weights_initializer_config": null, "post_fcnet_bias_initializer": null, "post_fcnet_bias_initializer_config": null, "free_log_std": false, "log_std_clip_param": 20.0, "no_final_linear": false, "vf_share_layers": false, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "lstm_weights_initializer": null, "lstm_weights_initializer_config": null, "lstm_bias_initializer": null, "lstm_bias_initializer_config": null, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "attention_use_n_prev_actions": 0, "attention_use_n_prev_rewards": 0, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": null, "custom_model_config": {}, "custom_action_dist": null, "custom_preprocessor": null, "encoder_latent_dim": null, "always_check_shapes": false, "lstm_use_prev_action_reward": -1, "_use_default_native_models": -1, "_disable_preprocessor_api": false, "_disable_action_flattening": false}, "_learner_connector": null, "add_default_connectors_to_learner_pipeline": true, "learner_config_dict": {}, "optimizer": {}, "_learner_class": null, "callbacks_on_algorithm_init": null, "callbacks_on_env_runners_recreated": null, "callbacks_on_offline_eval_runners_recreated": null, "callbacks_on_checkpoint_loaded": null, "callbacks_on_environment_created": null, "callbacks_on_episode_created": null, "callbacks_on_episode_start": null, "callbacks_on_episode_step": null, "callbacks_on_episode_end": null, "callbacks_on_evaluate_start": null, "callbacks_on_evaluate_end": null, "callbacks_on_evaluate_offline_start": null, "callbacks_on_evaluate_offline_end": null, "callbacks_on_sample_end": null, "callbacks_on_train_result": null, "explore": true, "enable_rl_module_and_learner": true, "enable_env_runner_and_connector_v2": true, "_prior_exploration_config": {"type": "StochasticSampling"}, "count_steps_by": "env_steps", "policy_map_capacity": 100, "policy_mapping_fn": "<function AlgorithmConfig.DEFAULT_POLICY_MAPPING_FN at 0x13ca69b20>", "policies_to_train": null, "policy_states_are_swappable": false, "observation_fn": null, "offline_data_class": null, "input_read_method": "read_parquet", "input_read_method_kwargs": {}, "input_read_schema": {}, "input_read_episodes": false, "input_read_sample_batches": false, "input_read_batch_size": null, "input_filesystem": null, "input_filesystem_kwargs": {}, "input_compress_columns": ["obs", "new_obs"], "input_spaces_jsonable": true, "materialize_data": false, "materialize_mapped_data": true, "map_batches_kwargs": {}, "iter_batches_kwargs": {}, "ignore_final_observation": false, "prelearner_class": null, "prelearner_buffer_class": null, "prelearner_buffer_kwargs": {}, "prelearner_module_synch_period": 10, "dataset_num_iters_per_learner": null, "input_config": {}, "actions_in_input_normalized": false, "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_config": {}, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "output_max_rows_per_file": null, "output_write_remaining_data": false, "output_write_method": "write_parquet", "output_write_method_kwargs": {}, "output_filesystem": null, "output_filesystem_kwargs": {}, "output_write_episodes": true, "offline_sampling": false, "evaluation_interval": 1, "evaluation_duration": 20, "evaluation_duration_unit": "episodes", "evaluation_sample_timeout_s": 120.0, "evaluation_auto_duration_min_env_steps_per_sample": 100, "evaluation_auto_duration_max_env_steps_per_sample": 2000, "evaluation_parallel_to_training": false, "evaluation_force_reset_envs_before_iteration": true, "evaluation_config": null, "off_policy_estimation_methods": {}, "ope_split_batch_by_episode": true, "evaluation_num_env_runners": 1, "in_evaluation": false, "sync_filters_on_rollout_workers_timeout_s": 10.0, "offline_evaluation_interval": null, "num_offline_eval_runners": 0, "offline_loss_for_module_fn": null, "offline_evaluation_duration": 1, "offline_evaluation_parallel_to_training": false, "offline_evaluation_timeout_s": 120.0, "num_cpus_per_offline_eval_runner": 1, "num_gpus_per_offline_eval_runner": 0, "custom_resources_per_offline_eval_runner": {}, "restart_failed_offline_eval_runners": true, "ignore_offline_eval_runner_failures": false, "max_num_offline_eval_runner_restarts": 1000, "offline_eval_runner_restore_timeout_s": 1800.0, "max_requests_in_flight_per_offline_eval_runner": 1, "validate_offline_eval_runners_after_construction": true, "offline_eval_runner_health_probe_timeout_s": 30.0, "offline_eval_rl_module_inference_only": false, "broadcast_offline_eval_runner_states": false, "offline_eval_batch_size_per_runner": 256, "dataset_num_iters_per_eval_runner": 1, "keep_per_episode_custom_metrics": false, "metrics_episode_collection_timeout_s": 60.0, "metrics_num_episodes_for_smoothing": 100, "min_time_s_per_iteration": null, "min_train_timesteps_per_iteration": 0, "min_sample_timesteps_per_iteration": 0, "log_gradients": true, "export_native_model_files": false, "checkpoint_trainable_policies_only": false, "logger_creator": null, "logger_config": null, "log_level": "WARN", "log_sys_usage": true, "fake_sampler": false, "seed": 7, "restart_failed_env_runners": true, "ignore_env_runner_failures": false, "max_num_env_runner_restarts": 1000, "delay_between_env_runner_restarts_s": 60.0, "restart_failed_sub_environments": false, "num_consecutive_env_runner_failures_tolerance": 100, "env_runner_health_probe_timeout_s": 30.0, "env_runner_restore_timeout_s": 1800.0, "_model_config": {}, "_rl_module_spec": "RLModuleSpec(module_class=None, observation_space=None, action_space=None, inference_only=False, learner_only=False, model_config=DefaultModelConfig(fcnet_hiddens=[60, 90], fcnet_activation='tanh', fcnet_kernel_initializer=None, fcnet_kernel_initializer_kwargs=None, fcnet_bias_initializer=None, fcnet_bias_initializer_kwargs=None, conv_filters=None, conv_activation='relu', conv_kernel_initializer=None, conv_kernel_initializer_kwargs=None, conv_bias_initializer=None, conv_bias_initializer_kwargs=None, head_fcnet_hiddens=[], head_fcnet_activation='relu', head_fcnet_kernel_initializer=None, head_fcnet_kernel_initializer_kwargs=None, head_fcnet_bias_initializer=None, head_fcnet_bias_initializer_kwargs=None, free_log_std=False, log_std_clip_param=20.0, vf_share_layers=True, use_lstm=False, max_seq_len=20, lstm_cell_size=256, lstm_use_prev_action=False, lstm_use_prev_reward=False, lstm_kernel_initializer=None, lstm_kernel_initializer_kwargs=None, lstm_bias_initializer=None, lstm_bias_initializer_kwargs=None), catalog_class=None, load_state_path=None, model_config_dict=None)", "algorithm_config_overrides_per_module": {}, "_per_module_overrides": {}, "_validate_config": true, "_use_msgpack_checkpoints": false, "_torch_grad_scaler_class": null, "_torch_lr_scheduler_classes": null, "_tf_policy_handles_more_than_one_loss": false, "_disable_preprocessor_api": false, "_disable_action_flattening": false, "_disable_initialize_loss_from_dummy_batch": false, "_dont_auto_sync_env_runner_states": false, "env_task_fn": -1, "enable_connectors": -1, "simple_optimizer": false, "policy_map_cache": -1, "worker_cls": -1, "synchronize_filters": -1, "enable_async_evaluation": -1, "custom_async_evaluation_function": -1, "_enable_rl_module_api": -1, "auto_wrap_old_gym_envs": -1, "always_attach_evaluation_results": -1, "replay_sequence_length": null, "_disable_execution_plan_api": -1, "use_critic": true, "use_gae": true, "use_kl_loss": true, "kl_coeff": 0.7464963036515, "kl_target": 0.0270990929592, "vf_loss_coeff": 0.6688075857018, "entropy_coeff": 0.0090570820258, "clip_param": 0.1221781641624, "vf_clip_param": 0.1027808522125, "entropy_coeff_schedule": null, "lr_schedule": null, "sgd_minibatch_size": -1, "vf_share_layers": -1, "__stdout_file__": null, "__stderr_file__": null, "lambda": 0.9099046732075, "input": "sampler", "policies": {"default_policy": [null, null, null, null]}, "callbacks": "<class 'ray.rllib.callbacks.callbacks.RLlibCallback'>", "create_env_on_driver": false, "custom_eval_function": null, "framework": "torch"}, "time_since_restore": 13.906742095947266, "iterations_since_restore": 8, "perf": {"cpu_util_percent": 32.25, "ram_util_percent": 79.3}}
{"timers": {"training_iteration": 1.5477519971333946, "restore_env_runners": 1.1281703949393478e-05, "training_step": 1.5475637589307678, "env_runner_sampling_timer": 1.439478952057576, "learner_update_timer": 0.1050099168174929, "synch_weights": 0.0004930854040924729, "restore_eval_env_runners": 1.0559351856493577e-05, "evaluation_iteration": 0.1060848139739434, "synch_eval_env_connectors": 0.00012415041429660026, "synch_env_connectors": 4.7813980248919775e-06}, "env_runners": {"weights_seq_no": 8.0, "module_to_env_connector": {"timers": {"connectors": {"tensor_to_numpy": 1.3328813370756329e-05, "listify_data_for_vector_env": 1.115619121740756e-05, "remove_single_ts_time_rank_from_batch": 5.855513301433254e-07, "get_actions": 3.8243198378803774e-05, "normalize_and_clip_actions": 9.443930322193793e-06, "un_batch_to_individual_items": 5.400121256241486e-06}}, "connector_pipeline_timer": 0.00010368555112223088}, "episode_len_mean": 20.0, "num_agent_steps_sampled_lifetime": {"default_agent": -4312500.0}, "num_agent_steps_sampled": {"default_agent": 5000.0}, "sample": 0.004869199019607257, "env_to_module_connector": {"timers": {"connectors": {"batch_individual_items": 6.503028705877531e-06, "add_observations_from_episodes_to_batch": 2.9918516056902838e-06, "add_states_from_episodes_to_batch": 1.766240005412558e-06, "add_time_dim_to_batch_and_zero_pad": 2.343387162804183e-06, "numpy_to_tensor": 8.654846867033567e-06}}, "connector_pipeline_timer": 4.3797034050502626e-05}, "env_step_timer": 1.396267209339956e-05, "num_episodes": 250.0, "episode_len_min": 20, "num_module_steps_sampled_lifetime": {"default_policy": -4312500.0}, "env_to_module_sum_episodes_length_in": 10.36823839457432, "agent_episode_returns_mean": {"default_agent": 5.460000000000001}, "num_env_steps_sampled": 5000.0, "episode_return_mean": 5.460000000000001, "num_module_steps_sampled": {"default_policy": 5000.0}, "episode_duration_sec_mean": 0.00457238283054903, "module_episode_returns_mean": {"default_policy": 5.460000000000001}, "num_episodes_lifetime": -215625.0, "episode_return_max": 10.5, "episode_len_max": 20, "env_to_module_sum_episodes_length_out": 10.36823839457432, "episode_return_min": -9.5, "num_env_steps_sampled_lifetime": -4312500.0, "env_reset_timer": 3.4288908979928295e-05, "time_between_sampling": 0.0015572915288219577, "rlmodule_inference_timer": 2.8014300461537113e-05, "num_env_steps_sampled_lifetime_throughput": 3741.8090414239573}, "learners": {"default_policy": {"diff_num_grad_updates_vs_sampler_policy": 1.0, "mean_kl_loss": 0.00022714240185450763, "num_module_steps_trained": 6000, "vf_explained_var": -0.009606122970581055, "entropy": 0.6061604619026184, "curr_entropy_coeff": 0.0090570820258, "num_trainable_parameters": 6003, "vf_loss_unclipped": 28.079132080078125, "gradients_default_optimizer_global_norm": 0.059866879135370255, "default_optimizer_learning_rate": 0.0002847858517, "module_train_batch_size_mean": 1000.0, "num_module_steps_trained_lifetime": 54000, "total_loss": -0.11885840445756912, "curr_kl_coeff": 0.0014580006245523691, "policy_loss": -0.18210962414741516, "vf_loss": 0.10278083384037018, "weights_seq_no": 9.0, "num_module_steps_trained_lifetime_throughput": 462627.90253284655}, "__all_modules__": {"learner_connector": {"connector_pipeline_timer": 0.08074364884860877, "timers": {"connectors": {"add_one_ts_to_episodes_and_truncate": 0.008291485797274328, "add_columns_from_episodes_to_train_batch": 0.03316383870699775, "general_advantage_estimation": 0.00693113588541927, "numpy_to_tensor": 6.973900956400694e-05, "batch_individual_items": 0.03134677700801102, "add_observations_from_episodes_to_batch": 0.0008132267163587373, "add_states_from_episodes_to_batch": 3.7236584383052586e-06, "add_time_dim_to_batch_and_zero_pad": 1.0348443201427882e-05}}}, "num_non_trainable_parameters": 0, "learner_connector_sum_episodes_length_in": 5000.0, "learner_connector_sum_episodes_length_out": 5250.0, "num_module_steps_trained": 6000, "num_trainable_parameters": 6003, "num_env_steps_trained_lifetime": 283500, "num_env_steps_trained": 31500, "num_module_steps_trained_lifetime": 54000, "num_env_steps_trained_lifetime_throughput": 2409671.7331204973, "num_module_steps_trained_throughput": 461174.76981990633, "num_module_steps_trained_lifetime_throughput": 460360.2904740535}}, "num_training_step_calls_per_iteration": 1, "evaluation": {"env_runners": {"module_to_env_connector": {"timers": {"connectors": {"un_batch_to_individual_items": 5.26802540559104e-06, "listify_data_for_vector_env": 1.0682196909327541e-05, "remove_single_ts_time_rank_from_batch": 5.677518407649113e-07, "normalize_and_clip_actions": 9.435467393209582e-06, "tensor_to_numpy": 1.262391197726189e-05, "get_actions": 3.4971601243613355e-05}}, "connector_pipeline_timer": 9.899713651125659e-05}, "agent_episode_returns_mean": {"default_agent": -0.35}, "sample": 0.09848083518034967, "env_step_timer": 1.3560746478510155e-05, "num_episodes": 20, "module_episode_returns_mean": {"default_policy": -0.35}, "episode_return_max": 12.5, "episode_return_min": -12.5, "rlmodule_inference_timer": 2.6067448342938255e-05, "env_to_module_connector": {"timers": {"connectors": {"numpy_to_tensor": 8.170810756078072e-06, "batch_individual_items": 6.058992393203467e-06, "add_observations_from_episodes_to_batch": 2.7735835175200797e-06, "add_states_from_episodes_to_batch": 1.5813447506996366e-06, "add_time_dim_to_batch_and_zero_pad": 2.199834987658603e-06}}, "connector_pipeline_timer": 4.220452678592805e-05}, "env_to_module_sum_episodes_length_in": 10.368238394574323, "episode_return_mean": -0.35, "episode_duration_sec_mean": 0.004720234604319557, "episode_len_max": 20, "env_to_module_sum_episodes_length_out": 10.368238394574323, "env_reset_timer": 0.0002544057467833075, "num_agent_steps_sampled_lifetime": {"default_agent": 3600}, "episode_len_mean": 20.0, "num_module_steps_sampled_lifetime": {"default_policy": 3600}, "episode_len_min": 20, "num_agent_steps_sampled": {"default_agent": 400}, "weights_seq_no": 9.0, "num_module_steps_sampled": {"default_policy": 400}, "num_env_steps_sampled": 400, "num_episodes_lifetime": 180, "num_env_steps_sampled_lifetime": 45400, "time_between_sampling": 1.6408764872902175}, "num_healthy_workers": 1, "actor_manager_num_outstanding_async_reqs": 0, "num_remote_worker_restarts": 0}, "num_env_steps_sampled_lifetime": -4312500.0, "fault_tolerance": {"num_healthy_workers": 0, "num_remote_worker_restarts": 0}, "env_runner_group": {"actor_manager_num_outstanding_async_reqs": 0}, "done": false, "training_iteration": 9, "trial_id": "499df_00000", "date": "2025-08-11_19-37-13", "timestamp": 1754933833, "time_this_iter_s": 1.6765761375427246, "time_total_s": 15.58331823348999, "pid": 28380, "hostname": "Mac", "node_ip": "127.0.0.1", "config": {"exploration_config": {}, "extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "placement_strategy": "PACK", "num_gpus": 0, "_fake_gpus": false, "num_cpus_for_main_process": 2, "eager_tracing": true, "eager_max_retraces": 20, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "torch_compile_learner": false, "torch_compile_learner_what_to_compile": "forward_train", "torch_compile_learner_dynamo_backend": "aot_eager", "torch_compile_learner_dynamo_mode": null, "torch_compile_worker": false, "torch_compile_worker_dynamo_backend": "aot_eager", "torch_compile_worker_dynamo_mode": null, "torch_ddp_kwargs": {}, "torch_skip_nan_gradients": false, "env": "Umbrella", "env_config": {}, "observation_space": null, "action_space": null, "clip_rewards": null, "normalize_actions": true, "clip_actions": false, "_is_atari": null, "disable_env_checking": false, "render_env": false, "action_mask_key": "action_mask", "env_runner_cls": null, "num_env_runners": 0, "create_local_env_runner": true, "num_envs_per_env_runner": 1, "gym_env_vectorize_mode": "SYNC", "num_cpus_per_env_runner": 1, "num_gpus_per_env_runner": 0, "custom_resources_per_env_runner": {}, "validate_env_runners_after_construction": true, "episodes_to_numpy": true, "max_requests_in_flight_per_env_runner": 1, "sample_timeout_s": 60.0, "_env_to_module_connector": null, "add_default_connectors_to_env_to_module_pipeline": true, "_module_to_env_connector": null, "add_default_connectors_to_module_to_env_pipeline": true, "merge_env_runner_states": "training_only", "broadcast_env_runner_states": true, "episode_lookback_horizon": 1, "rollout_fragment_length": "auto", "batch_mode": "complete_episodes", "compress_observations": false, "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "enable_tf1_exec_eagerly": false, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "preprocessor_pref": "deepmind", "observation_filter": "NoFilter", "update_worker_filter_stats": true, "use_worker_filter_stats": true, "sampler_perf_stats_ema_coef": null, "_is_online": true, "num_learners": 0, "num_gpus_per_learner": 0, "num_cpus_per_learner": "auto", "num_aggregator_actors_per_learner": 0, "max_requests_in_flight_per_aggregator_actor": 3, "local_gpu_idx": 0, "max_requests_in_flight_per_learner": 3, "gamma": 1, "lr": 0.0002847858517, "grad_clip": 0.5, "grad_clip_by": "global_norm", "_train_batch_size_per_learner": 5000, "train_batch_size": 4000, "num_epochs": 1, "minibatch_size": 1000, "shuffle_batch_per_epoch": true, "model": {"fcnet_hiddens": [256, 256], "fcnet_activation": "tanh", "fcnet_weights_initializer": null, "fcnet_weights_initializer_config": null, "fcnet_bias_initializer": null, "fcnet_bias_initializer_config": null, "conv_filters": null, "conv_activation": "relu", "conv_kernel_initializer": null, "conv_kernel_initializer_config": null, "conv_bias_initializer": null, "conv_bias_initializer_config": null, "conv_transpose_kernel_initializer": null, "conv_transpose_kernel_initializer_config": null, "conv_transpose_bias_initializer": null, "conv_transpose_bias_initializer_config": null, "post_fcnet_hiddens": [], "post_fcnet_activation": "relu", "post_fcnet_weights_initializer": null, "post_fcnet_weights_initializer_config": null, "post_fcnet_bias_initializer": null, "post_fcnet_bias_initializer_config": null, "free_log_std": false, "log_std_clip_param": 20.0, "no_final_linear": false, "vf_share_layers": false, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "lstm_weights_initializer": null, "lstm_weights_initializer_config": null, "lstm_bias_initializer": null, "lstm_bias_initializer_config": null, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "attention_use_n_prev_actions": 0, "attention_use_n_prev_rewards": 0, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": null, "custom_model_config": {}, "custom_action_dist": null, "custom_preprocessor": null, "encoder_latent_dim": null, "always_check_shapes": false, "lstm_use_prev_action_reward": -1, "_use_default_native_models": -1, "_disable_preprocessor_api": false, "_disable_action_flattening": false}, "_learner_connector": null, "add_default_connectors_to_learner_pipeline": true, "learner_config_dict": {}, "optimizer": {}, "_learner_class": null, "callbacks_on_algorithm_init": null, "callbacks_on_env_runners_recreated": null, "callbacks_on_offline_eval_runners_recreated": null, "callbacks_on_checkpoint_loaded": null, "callbacks_on_environment_created": null, "callbacks_on_episode_created": null, "callbacks_on_episode_start": null, "callbacks_on_episode_step": null, "callbacks_on_episode_end": null, "callbacks_on_evaluate_start": null, "callbacks_on_evaluate_end": null, "callbacks_on_evaluate_offline_start": null, "callbacks_on_evaluate_offline_end": null, "callbacks_on_sample_end": null, "callbacks_on_train_result": null, "explore": true, "enable_rl_module_and_learner": true, "enable_env_runner_and_connector_v2": true, "_prior_exploration_config": {"type": "StochasticSampling"}, "count_steps_by": "env_steps", "policy_map_capacity": 100, "policy_mapping_fn": "<function AlgorithmConfig.DEFAULT_POLICY_MAPPING_FN at 0x13ca69b20>", "policies_to_train": null, "policy_states_are_swappable": false, "observation_fn": null, "offline_data_class": null, "input_read_method": "read_parquet", "input_read_method_kwargs": {}, "input_read_schema": {}, "input_read_episodes": false, "input_read_sample_batches": false, "input_read_batch_size": null, "input_filesystem": null, "input_filesystem_kwargs": {}, "input_compress_columns": ["obs", "new_obs"], "input_spaces_jsonable": true, "materialize_data": false, "materialize_mapped_data": true, "map_batches_kwargs": {}, "iter_batches_kwargs": {}, "ignore_final_observation": false, "prelearner_class": null, "prelearner_buffer_class": null, "prelearner_buffer_kwargs": {}, "prelearner_module_synch_period": 10, "dataset_num_iters_per_learner": null, "input_config": {}, "actions_in_input_normalized": false, "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_config": {}, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "output_max_rows_per_file": null, "output_write_remaining_data": false, "output_write_method": "write_parquet", "output_write_method_kwargs": {}, "output_filesystem": null, "output_filesystem_kwargs": {}, "output_write_episodes": true, "offline_sampling": false, "evaluation_interval": 1, "evaluation_duration": 20, "evaluation_duration_unit": "episodes", "evaluation_sample_timeout_s": 120.0, "evaluation_auto_duration_min_env_steps_per_sample": 100, "evaluation_auto_duration_max_env_steps_per_sample": 2000, "evaluation_parallel_to_training": false, "evaluation_force_reset_envs_before_iteration": true, "evaluation_config": null, "off_policy_estimation_methods": {}, "ope_split_batch_by_episode": true, "evaluation_num_env_runners": 1, "in_evaluation": false, "sync_filters_on_rollout_workers_timeout_s": 10.0, "offline_evaluation_interval": null, "num_offline_eval_runners": 0, "offline_loss_for_module_fn": null, "offline_evaluation_duration": 1, "offline_evaluation_parallel_to_training": false, "offline_evaluation_timeout_s": 120.0, "num_cpus_per_offline_eval_runner": 1, "num_gpus_per_offline_eval_runner": 0, "custom_resources_per_offline_eval_runner": {}, "restart_failed_offline_eval_runners": true, "ignore_offline_eval_runner_failures": false, "max_num_offline_eval_runner_restarts": 1000, "offline_eval_runner_restore_timeout_s": 1800.0, "max_requests_in_flight_per_offline_eval_runner": 1, "validate_offline_eval_runners_after_construction": true, "offline_eval_runner_health_probe_timeout_s": 30.0, "offline_eval_rl_module_inference_only": false, "broadcast_offline_eval_runner_states": false, "offline_eval_batch_size_per_runner": 256, "dataset_num_iters_per_eval_runner": 1, "keep_per_episode_custom_metrics": false, "metrics_episode_collection_timeout_s": 60.0, "metrics_num_episodes_for_smoothing": 100, "min_time_s_per_iteration": null, "min_train_timesteps_per_iteration": 0, "min_sample_timesteps_per_iteration": 0, "log_gradients": true, "export_native_model_files": false, "checkpoint_trainable_policies_only": false, "logger_creator": null, "logger_config": null, "log_level": "WARN", "log_sys_usage": true, "fake_sampler": false, "seed": 7, "restart_failed_env_runners": true, "ignore_env_runner_failures": false, "max_num_env_runner_restarts": 1000, "delay_between_env_runner_restarts_s": 60.0, "restart_failed_sub_environments": false, "num_consecutive_env_runner_failures_tolerance": 100, "env_runner_health_probe_timeout_s": 30.0, "env_runner_restore_timeout_s": 1800.0, "_model_config": {}, "_rl_module_spec": "RLModuleSpec(module_class=None, observation_space=None, action_space=None, inference_only=False, learner_only=False, model_config=DefaultModelConfig(fcnet_hiddens=[60, 90], fcnet_activation='tanh', fcnet_kernel_initializer=None, fcnet_kernel_initializer_kwargs=None, fcnet_bias_initializer=None, fcnet_bias_initializer_kwargs=None, conv_filters=None, conv_activation='relu', conv_kernel_initializer=None, conv_kernel_initializer_kwargs=None, conv_bias_initializer=None, conv_bias_initializer_kwargs=None, head_fcnet_hiddens=[], head_fcnet_activation='relu', head_fcnet_kernel_initializer=None, head_fcnet_kernel_initializer_kwargs=None, head_fcnet_bias_initializer=None, head_fcnet_bias_initializer_kwargs=None, free_log_std=False, log_std_clip_param=20.0, vf_share_layers=True, use_lstm=False, max_seq_len=20, lstm_cell_size=256, lstm_use_prev_action=False, lstm_use_prev_reward=False, lstm_kernel_initializer=None, lstm_kernel_initializer_kwargs=None, lstm_bias_initializer=None, lstm_bias_initializer_kwargs=None), catalog_class=None, load_state_path=None, model_config_dict=None)", "algorithm_config_overrides_per_module": {}, "_per_module_overrides": {}, "_validate_config": true, "_use_msgpack_checkpoints": false, "_torch_grad_scaler_class": null, "_torch_lr_scheduler_classes": null, "_tf_policy_handles_more_than_one_loss": false, "_disable_preprocessor_api": false, "_disable_action_flattening": false, "_disable_initialize_loss_from_dummy_batch": false, "_dont_auto_sync_env_runner_states": false, "env_task_fn": -1, "enable_connectors": -1, "simple_optimizer": false, "policy_map_cache": -1, "worker_cls": -1, "synchronize_filters": -1, "enable_async_evaluation": -1, "custom_async_evaluation_function": -1, "_enable_rl_module_api": -1, "auto_wrap_old_gym_envs": -1, "always_attach_evaluation_results": -1, "replay_sequence_length": null, "_disable_execution_plan_api": -1, "use_critic": true, "use_gae": true, "use_kl_loss": true, "kl_coeff": 0.7464963036515, "kl_target": 0.0270990929592, "vf_loss_coeff": 0.6688075857018, "entropy_coeff": 0.0090570820258, "clip_param": 0.1221781641624, "vf_clip_param": 0.1027808522125, "entropy_coeff_schedule": null, "lr_schedule": null, "sgd_minibatch_size": -1, "vf_share_layers": -1, "__stdout_file__": null, "__stderr_file__": null, "lambda": 0.9099046732075, "input": "sampler", "policies": {"default_policy": [null, null, null, null]}, "callbacks": "<class 'ray.rllib.callbacks.callbacks.RLlibCallback'>", "create_env_on_driver": false, "custom_eval_function": null, "framework": "torch"}, "time_since_restore": 15.58331823348999, "iterations_since_restore": 9, "perf": {"cpu_util_percent": 35.13333333333333, "ram_util_percent": 79.16666666666667}}
{"timers": {"training_iteration": 1.5487141025721909, "restore_env_runners": 1.121763699006779e-05, "training_step": 1.5485261605113398, "env_runner_sampling_timer": 1.4396696637871125, "learner_update_timer": 0.10578148931892223, "synch_weights": 0.0004935207992943457, "restore_eval_env_runners": 1.0512508494241822e-05, "evaluation_iteration": 0.10602457666400061, "synch_eval_env_connectors": 0.0001240109907223055, "synch_env_connectors": 4.77983468785168e-06}, "env_runners": {"weights_seq_no": 9.0, "module_to_env_connector": {"timers": {"connectors": {"tensor_to_numpy": 1.370955690076462e-05, "listify_data_for_vector_env": 1.2082402382364618e-05, "remove_single_ts_time_rank_from_batch": 5.917288780056121e-07, "get_actions": 4.049308075338381e-05, "normalize_and_clip_actions": 9.678172974747643e-06, "un_batch_to_individual_items": 5.5616698756987375e-06}}, "connector_pipeline_timer": 0.00010996468475058899}, "episode_len_mean": 20.0, "num_agent_steps_sampled_lifetime": {"default_agent": -4930000.0}, "num_agent_steps_sampled": {"default_agent": 5000.0}, "sample": 0.005051151300768629, "env_to_module_connector": {"timers": {"connectors": {"batch_individual_items": 6.68712149616654e-06, "add_observations_from_episodes_to_batch": 3.144725295417554e-06, "add_states_from_episodes_to_batch": 1.8021536753422181e-06, "add_time_dim_to_batch_and_zero_pad": 2.4352810636829074e-06, "numpy_to_tensor": 1.0079398716433909e-05}}, "connector_pipeline_timer": 4.643855744786211e-05}, "env_step_timer": 1.4759967960795819e-05, "num_episodes": 250.0, "episode_len_min": 20, "num_module_steps_sampled_lifetime": {"default_policy": -4930000.0}, "env_to_module_sum_episodes_length_in": 10.36823839457432, "agent_episode_returns_mean": {"default_agent": 6.179999999999998}, "num_env_steps_sampled": 5000.0, "episode_return_mean": 6.179999999999998, "num_module_steps_sampled": {"default_policy": 5000.0}, "episode_duration_sec_mean": 0.004806117030791937, "module_episode_returns_mean": {"default_policy": 6.179999999999998}, "num_episodes_lifetime": -246500.0, "episode_return_max": 10.5, "episode_len_max": 20, "env_to_module_sum_episodes_length_out": 10.36823839457432, "episode_return_min": -9.5, "num_env_steps_sampled_lifetime": -4930000.0, "env_reset_timer": 4.0307831502163664e-05, "time_between_sampling": 0.0018329553282102316, "rlmodule_inference_timer": 2.8702412428029575e-05, "num_env_steps_sampled_lifetime_throughput": 3608.031550655785}, "learners": {"default_policy": {"diff_num_grad_updates_vs_sampler_policy": 1.0, "mean_kl_loss": 0.00011014497431460768, "num_module_steps_trained": 6000, "vf_explained_var": -0.009058833122253418, "entropy": 0.5978839993476868, "curr_entropy_coeff": 0.0090570820258, "num_trainable_parameters": 6003, "vf_loss_unclipped": 27.982223510742188, "gradients_default_optimizer_global_norm": 0.0812729150056839, "default_optimizer_learning_rate": 0.0002847858517, "module_train_batch_size_mean": 1000.0, "num_module_steps_trained_lifetime": 60000, "total_loss": -0.14074070751667023, "curr_kl_coeff": 0.0007290003122761846, "policy_loss": -0.20406639575958252, "vf_loss": 0.10278083384037018, "weights_seq_no": 10.0, "num_module_steps_trained_lifetime_throughput": 461660.7859969021}, "__all_modules__": {"learner_connector": {"connector_pipeline_timer": 0.08162846277999641, "timers": {"connectors": {"add_one_ts_to_episodes_and_truncate": 0.008285700519614924, "add_columns_from_episodes_to_train_batch": 0.03317875282019622, "general_advantage_estimation": 0.006913397437307911, "numpy_to_tensor": 6.973703919898546e-05, "batch_individual_items": 0.032240292987219976, "add_observations_from_episodes_to_batch": 0.0008132911192915176, "add_states_from_episodes_to_batch": 3.7176723829134284e-06, "add_time_dim_to_batch_and_zero_pad": 1.0369119202601684e-05}}}, "num_non_trainable_parameters": 0, "learner_connector_sum_episodes_length_in": 5000.0, "learner_connector_sum_episodes_length_out": 5250.0, "num_module_steps_trained": 6000, "num_trainable_parameters": 6003, "num_env_steps_trained_lifetime": 315000, "num_env_steps_trained": 31500, "num_module_steps_trained_lifetime": 60000, "num_env_steps_trained_lifetime_throughput": 2405593.932997849, "num_module_steps_trained_throughput": 460310.3048430272, "num_module_steps_trained_lifetime_throughput": 459523.5150690641}}, "num_training_step_calls_per_iteration": 1, "evaluation": {"env_runners": {"module_to_env_connector": {"timers": {"connectors": {"un_batch_to_individual_items": 5.2893221194543745e-06, "listify_data_for_vector_env": 1.069205922200048e-05, "remove_single_ts_time_rank_from_batch": 5.569638151962878e-07, "normalize_and_clip_actions": 9.237610462397883e-06, "tensor_to_numpy": 1.2583773264809656e-05, "get_actions": 3.38115107084809e-05}}, "connector_pipeline_timer": 9.737678430649929e-05}, "agent_episode_returns_mean": {"default_agent": 0.45}, "sample": 0.09844123849844197, "env_step_timer": 1.3934042218875134e-05, "num_episodes": 20, "module_episode_returns_mean": {"default_policy": 0.45}, "episode_return_max": 12.5, "episode_return_min": -12.5, "rlmodule_inference_timer": 2.5646769761904654e-05, "env_to_module_connector": {"timers": {"connectors": {"numpy_to_tensor": 8.110593752111798e-06, "batch_individual_items": 5.961592435414937e-06, "add_observations_from_episodes_to_batch": 2.78741922695991e-06, "add_states_from_episodes_to_batch": 1.5642749089976774e-06, "add_time_dim_to_batch_and_zero_pad": 2.2179433753350615e-06}}, "connector_pipeline_timer": 4.182441128971439e-05}, "env_to_module_sum_episodes_length_in": 10.368238394574323, "episode_return_mean": 0.45, "episode_duration_sec_mean": 0.004560175394872203, "episode_len_max": 20, "env_to_module_sum_episodes_length_out": 10.368238394574323, "env_reset_timer": 0.000252551689912862, "num_agent_steps_sampled_lifetime": {"default_agent": 4000}, "episode_len_mean": 20.0, "num_module_steps_sampled_lifetime": {"default_policy": 4000}, "episode_len_min": 20, "num_agent_steps_sampled": {"default_agent": 400}, "weights_seq_no": 10.0, "num_module_steps_sampled": {"default_policy": 400}, "num_env_steps_sampled": 400, "num_episodes_lifetime": 200, "num_env_steps_sampled_lifetime": 50400, "time_between_sampling": 1.6410650086670593}, "num_healthy_workers": 1, "actor_manager_num_outstanding_async_reqs": 0, "num_remote_worker_restarts": 0}, "num_env_steps_sampled_lifetime": -4930000.0, "fault_tolerance": {"num_healthy_workers": 0, "num_remote_worker_restarts": 0}, "env_runner_group": {"actor_manager_num_outstanding_async_reqs": 0}, "done": false, "training_iteration": 10, "trial_id": "499df_00000", "date": "2025-08-11_19-37-14", "timestamp": 1754933834, "time_this_iter_s": 1.7451720237731934, "time_total_s": 17.328490257263184, "pid": 28380, "hostname": "Mac", "node_ip": "127.0.0.1", "config": {"exploration_config": {}, "extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "placement_strategy": "PACK", "num_gpus": 0, "_fake_gpus": false, "num_cpus_for_main_process": 2, "eager_tracing": true, "eager_max_retraces": 20, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "torch_compile_learner": false, "torch_compile_learner_what_to_compile": "forward_train", "torch_compile_learner_dynamo_backend": "aot_eager", "torch_compile_learner_dynamo_mode": null, "torch_compile_worker": false, "torch_compile_worker_dynamo_backend": "aot_eager", "torch_compile_worker_dynamo_mode": null, "torch_ddp_kwargs": {}, "torch_skip_nan_gradients": false, "env": "Umbrella", "env_config": {}, "observation_space": null, "action_space": null, "clip_rewards": null, "normalize_actions": true, "clip_actions": false, "_is_atari": null, "disable_env_checking": false, "render_env": false, "action_mask_key": "action_mask", "env_runner_cls": null, "num_env_runners": 0, "create_local_env_runner": true, "num_envs_per_env_runner": 1, "gym_env_vectorize_mode": "SYNC", "num_cpus_per_env_runner": 1, "num_gpus_per_env_runner": 0, "custom_resources_per_env_runner": {}, "validate_env_runners_after_construction": true, "episodes_to_numpy": true, "max_requests_in_flight_per_env_runner": 1, "sample_timeout_s": 60.0, "_env_to_module_connector": null, "add_default_connectors_to_env_to_module_pipeline": true, "_module_to_env_connector": null, "add_default_connectors_to_module_to_env_pipeline": true, "merge_env_runner_states": "training_only", "broadcast_env_runner_states": true, "episode_lookback_horizon": 1, "rollout_fragment_length": "auto", "batch_mode": "complete_episodes", "compress_observations": false, "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "enable_tf1_exec_eagerly": false, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "preprocessor_pref": "deepmind", "observation_filter": "NoFilter", "update_worker_filter_stats": true, "use_worker_filter_stats": true, "sampler_perf_stats_ema_coef": null, "_is_online": true, "num_learners": 0, "num_gpus_per_learner": 0, "num_cpus_per_learner": "auto", "num_aggregator_actors_per_learner": 0, "max_requests_in_flight_per_aggregator_actor": 3, "local_gpu_idx": 0, "max_requests_in_flight_per_learner": 3, "gamma": 1, "lr": 0.0002847858517, "grad_clip": 0.5, "grad_clip_by": "global_norm", "_train_batch_size_per_learner": 5000, "train_batch_size": 4000, "num_epochs": 1, "minibatch_size": 1000, "shuffle_batch_per_epoch": true, "model": {"fcnet_hiddens": [256, 256], "fcnet_activation": "tanh", "fcnet_weights_initializer": null, "fcnet_weights_initializer_config": null, "fcnet_bias_initializer": null, "fcnet_bias_initializer_config": null, "conv_filters": null, "conv_activation": "relu", "conv_kernel_initializer": null, "conv_kernel_initializer_config": null, "conv_bias_initializer": null, "conv_bias_initializer_config": null, "conv_transpose_kernel_initializer": null, "conv_transpose_kernel_initializer_config": null, "conv_transpose_bias_initializer": null, "conv_transpose_bias_initializer_config": null, "post_fcnet_hiddens": [], "post_fcnet_activation": "relu", "post_fcnet_weights_initializer": null, "post_fcnet_weights_initializer_config": null, "post_fcnet_bias_initializer": null, "post_fcnet_bias_initializer_config": null, "free_log_std": false, "log_std_clip_param": 20.0, "no_final_linear": false, "vf_share_layers": false, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "lstm_weights_initializer": null, "lstm_weights_initializer_config": null, "lstm_bias_initializer": null, "lstm_bias_initializer_config": null, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "attention_use_n_prev_actions": 0, "attention_use_n_prev_rewards": 0, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": null, "custom_model_config": {}, "custom_action_dist": null, "custom_preprocessor": null, "encoder_latent_dim": null, "always_check_shapes": false, "lstm_use_prev_action_reward": -1, "_use_default_native_models": -1, "_disable_preprocessor_api": false, "_disable_action_flattening": false}, "_learner_connector": null, "add_default_connectors_to_learner_pipeline": true, "learner_config_dict": {}, "optimizer": {}, "_learner_class": null, "callbacks_on_algorithm_init": null, "callbacks_on_env_runners_recreated": null, "callbacks_on_offline_eval_runners_recreated": null, "callbacks_on_checkpoint_loaded": null, "callbacks_on_environment_created": null, "callbacks_on_episode_created": null, "callbacks_on_episode_start": null, "callbacks_on_episode_step": null, "callbacks_on_episode_end": null, "callbacks_on_evaluate_start": null, "callbacks_on_evaluate_end": null, "callbacks_on_evaluate_offline_start": null, "callbacks_on_evaluate_offline_end": null, "callbacks_on_sample_end": null, "callbacks_on_train_result": null, "explore": true, "enable_rl_module_and_learner": true, "enable_env_runner_and_connector_v2": true, "_prior_exploration_config": {"type": "StochasticSampling"}, "count_steps_by": "env_steps", "policy_map_capacity": 100, "policy_mapping_fn": "<function AlgorithmConfig.DEFAULT_POLICY_MAPPING_FN at 0x13ca69b20>", "policies_to_train": null, "policy_states_are_swappable": false, "observation_fn": null, "offline_data_class": null, "input_read_method": "read_parquet", "input_read_method_kwargs": {}, "input_read_schema": {}, "input_read_episodes": false, "input_read_sample_batches": false, "input_read_batch_size": null, "input_filesystem": null, "input_filesystem_kwargs": {}, "input_compress_columns": ["obs", "new_obs"], "input_spaces_jsonable": true, "materialize_data": false, "materialize_mapped_data": true, "map_batches_kwargs": {}, "iter_batches_kwargs": {}, "ignore_final_observation": false, "prelearner_class": null, "prelearner_buffer_class": null, "prelearner_buffer_kwargs": {}, "prelearner_module_synch_period": 10, "dataset_num_iters_per_learner": null, "input_config": {}, "actions_in_input_normalized": false, "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_config": {}, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "output_max_rows_per_file": null, "output_write_remaining_data": false, "output_write_method": "write_parquet", "output_write_method_kwargs": {}, "output_filesystem": null, "output_filesystem_kwargs": {}, "output_write_episodes": true, "offline_sampling": false, "evaluation_interval": 1, "evaluation_duration": 20, "evaluation_duration_unit": "episodes", "evaluation_sample_timeout_s": 120.0, "evaluation_auto_duration_min_env_steps_per_sample": 100, "evaluation_auto_duration_max_env_steps_per_sample": 2000, "evaluation_parallel_to_training": false, "evaluation_force_reset_envs_before_iteration": true, "evaluation_config": null, "off_policy_estimation_methods": {}, "ope_split_batch_by_episode": true, "evaluation_num_env_runners": 1, "in_evaluation": false, "sync_filters_on_rollout_workers_timeout_s": 10.0, "offline_evaluation_interval": null, "num_offline_eval_runners": 0, "offline_loss_for_module_fn": null, "offline_evaluation_duration": 1, "offline_evaluation_parallel_to_training": false, "offline_evaluation_timeout_s": 120.0, "num_cpus_per_offline_eval_runner": 1, "num_gpus_per_offline_eval_runner": 0, "custom_resources_per_offline_eval_runner": {}, "restart_failed_offline_eval_runners": true, "ignore_offline_eval_runner_failures": false, "max_num_offline_eval_runner_restarts": 1000, "offline_eval_runner_restore_timeout_s": 1800.0, "max_requests_in_flight_per_offline_eval_runner": 1, "validate_offline_eval_runners_after_construction": true, "offline_eval_runner_health_probe_timeout_s": 30.0, "offline_eval_rl_module_inference_only": false, "broadcast_offline_eval_runner_states": false, "offline_eval_batch_size_per_runner": 256, "dataset_num_iters_per_eval_runner": 1, "keep_per_episode_custom_metrics": false, "metrics_episode_collection_timeout_s": 60.0, "metrics_num_episodes_for_smoothing": 100, "min_time_s_per_iteration": null, "min_train_timesteps_per_iteration": 0, "min_sample_timesteps_per_iteration": 0, "log_gradients": true, "export_native_model_files": false, "checkpoint_trainable_policies_only": false, "logger_creator": null, "logger_config": null, "log_level": "WARN", "log_sys_usage": true, "fake_sampler": false, "seed": 7, "restart_failed_env_runners": true, "ignore_env_runner_failures": false, "max_num_env_runner_restarts": 1000, "delay_between_env_runner_restarts_s": 60.0, "restart_failed_sub_environments": false, "num_consecutive_env_runner_failures_tolerance": 100, "env_runner_health_probe_timeout_s": 30.0, "env_runner_restore_timeout_s": 1800.0, "_model_config": {}, "_rl_module_spec": "RLModuleSpec(module_class=None, observation_space=None, action_space=None, inference_only=False, learner_only=False, model_config=DefaultModelConfig(fcnet_hiddens=[60, 90], fcnet_activation='tanh', fcnet_kernel_initializer=None, fcnet_kernel_initializer_kwargs=None, fcnet_bias_initializer=None, fcnet_bias_initializer_kwargs=None, conv_filters=None, conv_activation='relu', conv_kernel_initializer=None, conv_kernel_initializer_kwargs=None, conv_bias_initializer=None, conv_bias_initializer_kwargs=None, head_fcnet_hiddens=[], head_fcnet_activation='relu', head_fcnet_kernel_initializer=None, head_fcnet_kernel_initializer_kwargs=None, head_fcnet_bias_initializer=None, head_fcnet_bias_initializer_kwargs=None, free_log_std=False, log_std_clip_param=20.0, vf_share_layers=True, use_lstm=False, max_seq_len=20, lstm_cell_size=256, lstm_use_prev_action=False, lstm_use_prev_reward=False, lstm_kernel_initializer=None, lstm_kernel_initializer_kwargs=None, lstm_bias_initializer=None, lstm_bias_initializer_kwargs=None), catalog_class=None, load_state_path=None, model_config_dict=None)", "algorithm_config_overrides_per_module": {}, "_per_module_overrides": {}, "_validate_config": true, "_use_msgpack_checkpoints": false, "_torch_grad_scaler_class": null, "_torch_lr_scheduler_classes": null, "_tf_policy_handles_more_than_one_loss": false, "_disable_preprocessor_api": false, "_disable_action_flattening": false, "_disable_initialize_loss_from_dummy_batch": false, "_dont_auto_sync_env_runner_states": false, "env_task_fn": -1, "enable_connectors": -1, "simple_optimizer": false, "policy_map_cache": -1, "worker_cls": -1, "synchronize_filters": -1, "enable_async_evaluation": -1, "custom_async_evaluation_function": -1, "_enable_rl_module_api": -1, "auto_wrap_old_gym_envs": -1, "always_attach_evaluation_results": -1, "replay_sequence_length": null, "_disable_execution_plan_api": -1, "use_critic": true, "use_gae": true, "use_kl_loss": true, "kl_coeff": 0.7464963036515, "kl_target": 0.0270990929592, "vf_loss_coeff": 0.6688075857018, "entropy_coeff": 0.0090570820258, "clip_param": 0.1221781641624, "vf_clip_param": 0.1027808522125, "entropy_coeff_schedule": null, "lr_schedule": null, "sgd_minibatch_size": -1, "vf_share_layers": -1, "__stdout_file__": null, "__stderr_file__": null, "lambda": 0.9099046732075, "input": "sampler", "policies": {"default_policy": [null, null, null, null]}, "callbacks": "<class 'ray.rllib.callbacks.callbacks.RLlibCallback'>", "create_env_on_driver": false, "custom_eval_function": null, "framework": "torch"}, "time_since_restore": 17.328490257263184, "iterations_since_restore": 10, "perf": {"cpu_util_percent": 41.0, "ram_util_percent": 77.65}}
{"timers": {"training_iteration": 1.547816089876586, "restore_env_runners": 1.1170881374420977e-05, "training_step": 1.5476275043265626, "env_runner_sampling_timer": 1.4388868804785595, "learner_update_timer": 0.10565573733543857, "synch_weights": 0.0004950347614792047, "restore_eval_env_runners": 1.046988330312863e-05, "evaluation_iteration": 0.10595509298627408, "synch_eval_env_connectors": 0.00012370046181648338, "synch_env_connectors": 4.768286908036853e-06}, "env_runners": {"weights_seq_no": 10.0, "module_to_env_connector": {"timers": {"connectors": {"tensor_to_numpy": 1.2978078829413663e-05, "listify_data_for_vector_env": 1.0951075533169767e-05, "remove_single_ts_time_rank_from_batch": 5.81874191731151e-07, "get_actions": 3.755569999676253e-05, "normalize_and_clip_actions": 9.35760126162727e-06, "un_batch_to_individual_items": 5.369019493959256e-06}}, "connector_pipeline_timer": 0.0001020932982883857}, "episode_len_mean": 20.0, "num_agent_steps_sampled_lifetime": {"default_agent": -5547500.0}, "num_agent_steps_sampled": {"default_agent": 5000.0}, "sample": 0.0049804615241330445, "env_to_module_connector": {"timers": {"connectors": {"batch_individual_items": 6.467809032485902e-06, "add_observations_from_episodes_to_batch": 2.9921521838924993e-06, "add_states_from_episodes_to_batch": 1.7433849650563574e-06, "add_time_dim_to_batch_and_zero_pad": 2.324582007288251e-06, "numpy_to_tensor": 8.54536528955832e-06}}, "connector_pipeline_timer": 4.354935776644638e-05}, "env_step_timer": 1.3865679976737628e-05, "num_episodes": 250.0, "episode_len_min": 20, "num_module_steps_sampled_lifetime": {"default_policy": -5547500.0}, "env_to_module_sum_episodes_length_in": 10.36823839457432, "agent_episode_returns_mean": {"default_agent": 4.740000000000002}, "num_env_steps_sampled": 5000.0, "episode_return_mean": 4.740000000000002, "num_module_steps_sampled": {"default_policy": 5000.0}, "episode_duration_sec_mean": 0.004505224664695562, "module_episode_returns_mean": {"default_policy": 4.740000000000002}, "num_episodes_lifetime": -277375.0, "episode_return_max": 10.5, "episode_len_max": 20, "env_to_module_sum_episodes_length_out": 10.36823839457432, "episode_return_min": -9.5, "num_env_steps_sampled_lifetime": -5547500.0, "env_reset_timer": 3.660610059562831e-05, "time_between_sampling": 0.0018420687758400564, "rlmodule_inference_timer": 2.7766850867900248e-05, "num_env_steps_sampled_lifetime_throughput": 3745.421068795177}, "learners": {"default_policy": {"diff_num_grad_updates_vs_sampler_policy": 1.0, "mean_kl_loss": 0.0002990176435559988, "num_module_steps_trained": 6000, "vf_explained_var": -0.010197997093200684, "entropy": 0.5904799699783325, "curr_entropy_coeff": 0.0090570820258, "num_trainable_parameters": 6003, "vf_loss_unclipped": 28.26639175415039, "gradients_default_optimizer_global_norm": 0.032687243074178696, "default_optimizer_learning_rate": 0.0002847858517, "module_train_batch_size_mean": 1000.0, "num_module_steps_trained_lifetime": 66000, "total_loss": -0.018643252551555634, "curr_kl_coeff": 0.0003645001561380923, "policy_loss": -0.08203604817390442, "vf_loss": 0.10278083384037018, "weights_seq_no": 11.0, "num_module_steps_trained_lifetime_throughput": 459876.06866428314}, "__all_modules__": {"learner_connector": {"connector_pipeline_timer": 0.08159618732221645, "timers": {"connectors": {"add_one_ts_to_episodes_and_truncate": 0.008276275174839967, "add_columns_from_episodes_to_train_batch": 0.033197421962852226, "general_advantage_estimation": 0.006895713052598948, "numpy_to_tensor": 6.966966894751357e-05, "batch_individual_items": 0.03221686588801263, "add_observations_from_episodes_to_batch": 0.0008130861182905407, "add_states_from_episodes_to_batch": 3.719665922419403e-06, "add_time_dim_to_batch_and_zero_pad": 1.0402928475491896e-05}}}, "num_non_trainable_parameters": 0, "learner_connector_sum_episodes_length_in": 5000.0, "learner_connector_sum_episodes_length_out": 5250.0, "num_module_steps_trained": 6000, "num_trainable_parameters": 6003, "num_env_steps_trained_lifetime": 346500, "num_env_steps_trained": 31500, "num_module_steps_trained_lifetime": 66000, "num_env_steps_trained_lifetime_throughput": 2397179.5739637553, "num_module_steps_trained_throughput": 458623.9246060044, "num_module_steps_trained_lifetime_throughput": 457863.2700025067}}, "num_training_step_calls_per_iteration": 1, "evaluation": {"env_runners": {"module_to_env_connector": {"timers": {"connectors": {"un_batch_to_individual_items": 5.370964668928983e-06, "listify_data_for_vector_env": 1.086704319514389e-05, "remove_single_ts_time_rank_from_batch": 5.591759694844497e-07, "normalize_and_clip_actions": 9.422004088182427e-06, "tensor_to_numpy": 1.2767603456129825e-05, "get_actions": 3.580698113389709e-05}}, "connector_pipeline_timer": 0.00010038357366047161}, "agent_episode_returns_mean": {"default_agent": -0.15}, "sample": 0.09843681070237861, "env_step_timer": 1.4085556761241451e-05, "num_episodes": 20, "module_episode_returns_mean": {"default_policy": -0.15}, "episode_return_max": 12.5, "episode_return_min": -12.5, "rlmodule_inference_timer": 2.6272540480953136e-05, "env_to_module_connector": {"timers": {"connectors": {"numpy_to_tensor": 8.41824253485908e-06, "batch_individual_items": 6.09219035056771e-06, "add_observations_from_episodes_to_batch": 2.761882550934185e-06, "add_states_from_episodes_to_batch": 1.590098512854865e-06, "add_time_dim_to_batch_and_zero_pad": 2.2260805837328137e-06}}, "connector_pipeline_timer": 4.245998652058743e-05}, "env_to_module_sum_episodes_length_in": 10.368238394574323, "episode_return_mean": -0.15, "episode_duration_sec_mean": 0.004496908325236291, "episode_len_max": 20, "env_to_module_sum_episodes_length_out": 10.368238394574323, "env_reset_timer": 0.0002508957640356437, "num_agent_steps_sampled_lifetime": {"default_agent": 4400}, "episode_len_mean": 20.0, "num_module_steps_sampled_lifetime": {"default_policy": 4400}, "episode_len_min": 20, "num_agent_steps_sampled": {"default_agent": 400}, "weights_seq_no": 11.0, "num_module_steps_sampled": {"default_policy": 400}, "num_env_steps_sampled": 400, "num_episodes_lifetime": 220, "num_env_steps_sampled_lifetime": 55400, "time_between_sampling": 1.639415375659388}, "num_healthy_workers": 1, "actor_manager_num_outstanding_async_reqs": 0, "num_remote_worker_restarts": 0}, "num_env_steps_sampled_lifetime": -5547500.0, "fault_tolerance": {"num_healthy_workers": 0, "num_remote_worker_restarts": 0}, "env_runner_group": {"actor_manager_num_outstanding_async_reqs": 0}, "done": false, "training_iteration": 11, "trial_id": "499df_00000", "date": "2025-08-11_19-37-16", "timestamp": 1754933836, "time_this_iter_s": 1.5640318393707275, "time_total_s": 18.89252209663391, "pid": 28380, "hostname": "Mac", "node_ip": "127.0.0.1", "config": {"exploration_config": {}, "extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "placement_strategy": "PACK", "num_gpus": 0, "_fake_gpus": false, "num_cpus_for_main_process": 2, "eager_tracing": true, "eager_max_retraces": 20, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "torch_compile_learner": false, "torch_compile_learner_what_to_compile": "forward_train", "torch_compile_learner_dynamo_backend": "aot_eager", "torch_compile_learner_dynamo_mode": null, "torch_compile_worker": false, "torch_compile_worker_dynamo_backend": "aot_eager", "torch_compile_worker_dynamo_mode": null, "torch_ddp_kwargs": {}, "torch_skip_nan_gradients": false, "env": "Umbrella", "env_config": {}, "observation_space": null, "action_space": null, "clip_rewards": null, "normalize_actions": true, "clip_actions": false, "_is_atari": null, "disable_env_checking": false, "render_env": false, "action_mask_key": "action_mask", "env_runner_cls": null, "num_env_runners": 0, "create_local_env_runner": true, "num_envs_per_env_runner": 1, "gym_env_vectorize_mode": "SYNC", "num_cpus_per_env_runner": 1, "num_gpus_per_env_runner": 0, "custom_resources_per_env_runner": {}, "validate_env_runners_after_construction": true, "episodes_to_numpy": true, "max_requests_in_flight_per_env_runner": 1, "sample_timeout_s": 60.0, "_env_to_module_connector": null, "add_default_connectors_to_env_to_module_pipeline": true, "_module_to_env_connector": null, "add_default_connectors_to_module_to_env_pipeline": true, "merge_env_runner_states": "training_only", "broadcast_env_runner_states": true, "episode_lookback_horizon": 1, "rollout_fragment_length": "auto", "batch_mode": "complete_episodes", "compress_observations": false, "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "enable_tf1_exec_eagerly": false, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "preprocessor_pref": "deepmind", "observation_filter": "NoFilter", "update_worker_filter_stats": true, "use_worker_filter_stats": true, "sampler_perf_stats_ema_coef": null, "_is_online": true, "num_learners": 0, "num_gpus_per_learner": 0, "num_cpus_per_learner": "auto", "num_aggregator_actors_per_learner": 0, "max_requests_in_flight_per_aggregator_actor": 3, "local_gpu_idx": 0, "max_requests_in_flight_per_learner": 3, "gamma": 1, "lr": 0.0002847858517, "grad_clip": 0.5, "grad_clip_by": "global_norm", "_train_batch_size_per_learner": 5000, "train_batch_size": 4000, "num_epochs": 1, "minibatch_size": 1000, "shuffle_batch_per_epoch": true, "model": {"fcnet_hiddens": [256, 256], "fcnet_activation": "tanh", "fcnet_weights_initializer": null, "fcnet_weights_initializer_config": null, "fcnet_bias_initializer": null, "fcnet_bias_initializer_config": null, "conv_filters": null, "conv_activation": "relu", "conv_kernel_initializer": null, "conv_kernel_initializer_config": null, "conv_bias_initializer": null, "conv_bias_initializer_config": null, "conv_transpose_kernel_initializer": null, "conv_transpose_kernel_initializer_config": null, "conv_transpose_bias_initializer": null, "conv_transpose_bias_initializer_config": null, "post_fcnet_hiddens": [], "post_fcnet_activation": "relu", "post_fcnet_weights_initializer": null, "post_fcnet_weights_initializer_config": null, "post_fcnet_bias_initializer": null, "post_fcnet_bias_initializer_config": null, "free_log_std": false, "log_std_clip_param": 20.0, "no_final_linear": false, "vf_share_layers": false, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "lstm_weights_initializer": null, "lstm_weights_initializer_config": null, "lstm_bias_initializer": null, "lstm_bias_initializer_config": null, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "attention_use_n_prev_actions": 0, "attention_use_n_prev_rewards": 0, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": null, "custom_model_config": {}, "custom_action_dist": null, "custom_preprocessor": null, "encoder_latent_dim": null, "always_check_shapes": false, "lstm_use_prev_action_reward": -1, "_use_default_native_models": -1, "_disable_preprocessor_api": false, "_disable_action_flattening": false}, "_learner_connector": null, "add_default_connectors_to_learner_pipeline": true, "learner_config_dict": {}, "optimizer": {}, "_learner_class": null, "callbacks_on_algorithm_init": null, "callbacks_on_env_runners_recreated": null, "callbacks_on_offline_eval_runners_recreated": null, "callbacks_on_checkpoint_loaded": null, "callbacks_on_environment_created": null, "callbacks_on_episode_created": null, "callbacks_on_episode_start": null, "callbacks_on_episode_step": null, "callbacks_on_episode_end": null, "callbacks_on_evaluate_start": null, "callbacks_on_evaluate_end": null, "callbacks_on_evaluate_offline_start": null, "callbacks_on_evaluate_offline_end": null, "callbacks_on_sample_end": null, "callbacks_on_train_result": null, "explore": true, "enable_rl_module_and_learner": true, "enable_env_runner_and_connector_v2": true, "_prior_exploration_config": {"type": "StochasticSampling"}, "count_steps_by": "env_steps", "policy_map_capacity": 100, "policy_mapping_fn": "<function AlgorithmConfig.DEFAULT_POLICY_MAPPING_FN at 0x13ca69b20>", "policies_to_train": null, "policy_states_are_swappable": false, "observation_fn": null, "offline_data_class": null, "input_read_method": "read_parquet", "input_read_method_kwargs": {}, "input_read_schema": {}, "input_read_episodes": false, "input_read_sample_batches": false, "input_read_batch_size": null, "input_filesystem": null, "input_filesystem_kwargs": {}, "input_compress_columns": ["obs", "new_obs"], "input_spaces_jsonable": true, "materialize_data": false, "materialize_mapped_data": true, "map_batches_kwargs": {}, "iter_batches_kwargs": {}, "ignore_final_observation": false, "prelearner_class": null, "prelearner_buffer_class": null, "prelearner_buffer_kwargs": {}, "prelearner_module_synch_period": 10, "dataset_num_iters_per_learner": null, "input_config": {}, "actions_in_input_normalized": false, "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_config": {}, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "output_max_rows_per_file": null, "output_write_remaining_data": false, "output_write_method": "write_parquet", "output_write_method_kwargs": {}, "output_filesystem": null, "output_filesystem_kwargs": {}, "output_write_episodes": true, "offline_sampling": false, "evaluation_interval": 1, "evaluation_duration": 20, "evaluation_duration_unit": "episodes", "evaluation_sample_timeout_s": 120.0, "evaluation_auto_duration_min_env_steps_per_sample": 100, "evaluation_auto_duration_max_env_steps_per_sample": 2000, "evaluation_parallel_to_training": false, "evaluation_force_reset_envs_before_iteration": true, "evaluation_config": null, "off_policy_estimation_methods": {}, "ope_split_batch_by_episode": true, "evaluation_num_env_runners": 1, "in_evaluation": false, "sync_filters_on_rollout_workers_timeout_s": 10.0, "offline_evaluation_interval": null, "num_offline_eval_runners": 0, "offline_loss_for_module_fn": null, "offline_evaluation_duration": 1, "offline_evaluation_parallel_to_training": false, "offline_evaluation_timeout_s": 120.0, "num_cpus_per_offline_eval_runner": 1, "num_gpus_per_offline_eval_runner": 0, "custom_resources_per_offline_eval_runner": {}, "restart_failed_offline_eval_runners": true, "ignore_offline_eval_runner_failures": false, "max_num_offline_eval_runner_restarts": 1000, "offline_eval_runner_restore_timeout_s": 1800.0, "max_requests_in_flight_per_offline_eval_runner": 1, "validate_offline_eval_runners_after_construction": true, "offline_eval_runner_health_probe_timeout_s": 30.0, "offline_eval_rl_module_inference_only": false, "broadcast_offline_eval_runner_states": false, "offline_eval_batch_size_per_runner": 256, "dataset_num_iters_per_eval_runner": 1, "keep_per_episode_custom_metrics": false, "metrics_episode_collection_timeout_s": 60.0, "metrics_num_episodes_for_smoothing": 100, "min_time_s_per_iteration": null, "min_train_timesteps_per_iteration": 0, "min_sample_timesteps_per_iteration": 0, "log_gradients": true, "export_native_model_files": false, "checkpoint_trainable_policies_only": false, "logger_creator": null, "logger_config": null, "log_level": "WARN", "log_sys_usage": true, "fake_sampler": false, "seed": 7, "restart_failed_env_runners": true, "ignore_env_runner_failures": false, "max_num_env_runner_restarts": 1000, "delay_between_env_runner_restarts_s": 60.0, "restart_failed_sub_environments": false, "num_consecutive_env_runner_failures_tolerance": 100, "env_runner_health_probe_timeout_s": 30.0, "env_runner_restore_timeout_s": 1800.0, "_model_config": {}, "_rl_module_spec": "RLModuleSpec(module_class=None, observation_space=None, action_space=None, inference_only=False, learner_only=False, model_config=DefaultModelConfig(fcnet_hiddens=[60, 90], fcnet_activation='tanh', fcnet_kernel_initializer=None, fcnet_kernel_initializer_kwargs=None, fcnet_bias_initializer=None, fcnet_bias_initializer_kwargs=None, conv_filters=None, conv_activation='relu', conv_kernel_initializer=None, conv_kernel_initializer_kwargs=None, conv_bias_initializer=None, conv_bias_initializer_kwargs=None, head_fcnet_hiddens=[], head_fcnet_activation='relu', head_fcnet_kernel_initializer=None, head_fcnet_kernel_initializer_kwargs=None, head_fcnet_bias_initializer=None, head_fcnet_bias_initializer_kwargs=None, free_log_std=False, log_std_clip_param=20.0, vf_share_layers=True, use_lstm=False, max_seq_len=20, lstm_cell_size=256, lstm_use_prev_action=False, lstm_use_prev_reward=False, lstm_kernel_initializer=None, lstm_kernel_initializer_kwargs=None, lstm_bias_initializer=None, lstm_bias_initializer_kwargs=None), catalog_class=None, load_state_path=None, model_config_dict=None)", "algorithm_config_overrides_per_module": {}, "_per_module_overrides": {}, "_validate_config": true, "_use_msgpack_checkpoints": false, "_torch_grad_scaler_class": null, "_torch_lr_scheduler_classes": null, "_tf_policy_handles_more_than_one_loss": false, "_disable_preprocessor_api": false, "_disable_action_flattening": false, "_disable_initialize_loss_from_dummy_batch": false, "_dont_auto_sync_env_runner_states": false, "env_task_fn": -1, "enable_connectors": -1, "simple_optimizer": false, "policy_map_cache": -1, "worker_cls": -1, "synchronize_filters": -1, "enable_async_evaluation": -1, "custom_async_evaluation_function": -1, "_enable_rl_module_api": -1, "auto_wrap_old_gym_envs": -1, "always_attach_evaluation_results": -1, "replay_sequence_length": null, "_disable_execution_plan_api": -1, "use_critic": true, "use_gae": true, "use_kl_loss": true, "kl_coeff": 0.7464963036515, "kl_target": 0.0270990929592, "vf_loss_coeff": 0.6688075857018, "entropy_coeff": 0.0090570820258, "clip_param": 0.1221781641624, "vf_clip_param": 0.1027808522125, "entropy_coeff_schedule": null, "lr_schedule": null, "sgd_minibatch_size": -1, "vf_share_layers": -1, "__stdout_file__": null, "__stderr_file__": null, "lambda": 0.9099046732075, "input": "sampler", "policies": {"default_policy": [null, null, null, null]}, "callbacks": "<class 'ray.rllib.callbacks.callbacks.RLlibCallback'>", "create_env_on_driver": false, "custom_eval_function": null, "framework": "torch"}, "time_since_restore": 18.89252209663391, "iterations_since_restore": 11, "perf": {"cpu_util_percent": 38.0, "ram_util_percent": 76.45}}
{"timers": {"training_iteration": 1.5473895881476598, "restore_env_runners": 1.1117502457678153e-05, "training_step": 1.5472010459524947, "env_runner_sampling_timer": 1.438612832093119, "learner_update_timer": 0.10550354121149752, "synch_weights": 0.000495445243973979, "restore_eval_env_runners": 1.0438104699383299e-05, "evaluation_iteration": 0.10592254288692012, "synch_eval_env_connectors": 0.00012344345767560273, "synch_env_connectors": 4.765603217455468e-06}, "env_runners": {"weights_seq_no": 11.0, "module_to_env_connector": {"timers": {"connectors": {"tensor_to_numpy": 1.2642065620337262e-05, "listify_data_for_vector_env": 1.0666354001981147e-05, "remove_single_ts_time_rank_from_batch": 5.673164419042404e-07, "get_actions": 3.60531063385647e-05, "normalize_and_clip_actions": 9.113493431399788e-06, "un_batch_to_individual_items": 5.2395874937692466e-06}}, "connector_pipeline_timer": 9.896185360432995e-05}, "episode_len_mean": 20.0, "num_agent_steps_sampled_lifetime": {"default_agent": -6165000.0}, "num_agent_steps_sampled": {"default_agent": 5000.0}, "sample": 0.0047036211508663505, "env_to_module_connector": {"timers": {"connectors": {"batch_individual_items": 6.277654948242585e-06, "add_observations_from_episodes_to_batch": 2.9715514104652297e-06, "add_states_from_episodes_to_batch": 1.7201045816860466e-06, "add_time_dim_to_batch_and_zero_pad": 2.270695365026999e-06, "numpy_to_tensor": 8.246050040528064e-06}}, "connector_pipeline_timer": 4.245047432406084e-05}, "env_step_timer": 1.3317151383403336e-05, "num_episodes": 250.0, "episode_len_min": 20, "num_module_steps_sampled_lifetime": {"default_policy": -6165000.0}, "env_to_module_sum_episodes_length_in": 10.36823839457432, "agent_episode_returns_mean": {"default_agent": 5.619999999999999}, "num_env_steps_sampled": 5000.0, "episode_return_mean": 5.619999999999999, "num_module_steps_sampled": {"default_policy": 5000.0}, "episode_duration_sec_mean": 0.00437581429630518, "module_episode_returns_mean": {"default_policy": 5.619999999999999}, "num_episodes_lifetime": -308250.0, "episode_return_max": 10.5, "episode_len_max": 20, "env_to_module_sum_episodes_length_out": 10.36823839457432, "episode_return_min": -9.5, "num_env_steps_sampled_lifetime": -6165000.0, "env_reset_timer": 3.110184926991686e-05, "time_between_sampling": 0.0017880799056952763, "rlmodule_inference_timer": 2.6403248376247003e-05, "num_env_steps_sampled_lifetime_throughput": 3885.4893257742333}, "learners": {"default_policy": {"diff_num_grad_updates_vs_sampler_policy": 1.0, "mean_kl_loss": 0.0009873730596154928, "num_module_steps_trained": 6000, "vf_explained_var": -0.009987235069274902, "entropy": 0.5664700865745544, "curr_entropy_coeff": 0.0090570820258, "num_trainable_parameters": 6003, "vf_loss_unclipped": 28.210323333740234, "gradients_default_optimizer_global_norm": 0.07592751830816269, "default_optimizer_learning_rate": 0.0002847858517, "module_train_batch_size_mean": 1000.0, "num_module_steps_trained_lifetime": 72000, "total_loss": 0.02147681638598442, "curr_kl_coeff": 0.00018225007806904614, "policy_loss": -0.04213358461856842, "vf_loss": 0.10278083384037018, "weights_seq_no": 12.0, "num_module_steps_trained_lifetime_throughput": 459104.96094483853}, "__all_modules__": {"learner_connector": {"connector_pipeline_timer": 0.08156552086978623, "timers": {"connectors": {"add_one_ts_to_episodes_and_truncate": 0.008267840342956594, "add_columns_from_episodes_to_train_batch": 0.0332171798230947, "general_advantage_estimation": 0.006878413832298871, "numpy_to_tensor": 6.963630210519543e-05, "batch_individual_items": 0.03219235930939809, "add_observations_from_episodes_to_batch": 0.0008130510975654622, "add_states_from_episodes_to_batch": 3.7212192672185224e-06, "add_time_dim_to_batch_and_zero_pad": 1.0423898978395431e-05}}}, "num_non_trainable_parameters": 0, "learner_connector_sum_episodes_length_in": 5000.0, "learner_connector_sum_episodes_length_out": 5250.0, "num_module_steps_trained": 6000, "num_trainable_parameters": 6003, "num_env_steps_trained_lifetime": 378000, "num_env_steps_trained": 31500, "num_module_steps_trained_lifetime": 72000, "num_env_steps_trained_lifetime_throughput": 2394065.4289072137, "num_module_steps_trained_throughput": 457949.3525301907, "num_module_steps_trained_lifetime_throughput": 457213.8739234028}}, "num_training_step_calls_per_iteration": 1, "evaluation": {"env_runners": {"module_to_env_connector": {"timers": {"connectors": {"un_batch_to_individual_items": 5.194469786082949e-06, "listify_data_for_vector_env": 1.05122093583768e-05, "remove_single_ts_time_rank_from_batch": 5.617595896610768e-07, "normalize_and_clip_actions": 9.091043686458563e-06, "tensor_to_numpy": 1.2349183694918534e-05, "get_actions": 3.349239750325059e-05}}, "connector_pipeline_timer": 9.60386350741707e-05}, "agent_episode_returns_mean": {"default_agent": -0.35}, "sample": 0.09838939467500112, "env_step_timer": 1.352793282238495e-05, "num_episodes": 20, "module_episode_returns_mean": {"default_policy": -0.35}, "episode_return_max": 12.5, "episode_return_min": -12.5, "rlmodule_inference_timer": 2.551280709238785e-05, "env_to_module_connector": {"timers": {"connectors": {"numpy_to_tensor": 8.018875608284011e-06, "batch_individual_items": 5.8577684566396615e-06, "add_observations_from_episodes_to_batch": 2.7281991619059214e-06, "add_states_from_episodes_to_batch": 1.5948370186349056e-06, "add_time_dim_to_batch_and_zero_pad": 2.2081916162841414e-06}}, "connector_pipeline_timer": 4.12736341136226e-05}, "env_to_module_sum_episodes_length_in": 10.368238394574323, "episode_return_mean": -0.35, "episode_duration_sec_mean": 0.004451637907186523, "episode_len_max": 20, "env_to_module_sum_episodes_length_out": 10.368238394574323, "env_reset_timer": 0.0002490826463852177, "num_agent_steps_sampled_lifetime": {"default_agent": 4800}, "episode_len_mean": 20.0, "num_module_steps_sampled_lifetime": {"default_policy": 4800}, "episode_len_min": 20, "num_agent_steps_sampled": {"default_agent": 400}, "weights_seq_no": 12.0, "num_module_steps_sampled": {"default_policy": 400}, "num_env_steps_sampled": 400, "num_episodes_lifetime": 240, "num_env_steps_sampled_lifetime": 60400, "time_between_sampling": 1.6382365744028846}, "num_healthy_workers": 1, "actor_manager_num_outstanding_async_reqs": 0, "num_remote_worker_restarts": 0}, "num_env_steps_sampled_lifetime": -6165000.0, "fault_tolerance": {"num_healthy_workers": 0, "num_remote_worker_restarts": 0}, "env_runner_group": {"actor_manager_num_outstanding_async_reqs": 0}, "done": false, "training_iteration": 12, "trial_id": "499df_00000", "date": "2025-08-11_19-37-18", "timestamp": 1754933838, "time_this_iter_s": 1.605405330657959, "time_total_s": 20.49792742729187, "pid": 28380, "hostname": "Mac", "node_ip": "127.0.0.1", "config": {"exploration_config": {}, "extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "placement_strategy": "PACK", "num_gpus": 0, "_fake_gpus": false, "num_cpus_for_main_process": 2, "eager_tracing": true, "eager_max_retraces": 20, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "torch_compile_learner": false, "torch_compile_learner_what_to_compile": "forward_train", "torch_compile_learner_dynamo_backend": "aot_eager", "torch_compile_learner_dynamo_mode": null, "torch_compile_worker": false, "torch_compile_worker_dynamo_backend": "aot_eager", "torch_compile_worker_dynamo_mode": null, "torch_ddp_kwargs": {}, "torch_skip_nan_gradients": false, "env": "Umbrella", "env_config": {}, "observation_space": null, "action_space": null, "clip_rewards": null, "normalize_actions": true, "clip_actions": false, "_is_atari": null, "disable_env_checking": false, "render_env": false, "action_mask_key": "action_mask", "env_runner_cls": null, "num_env_runners": 0, "create_local_env_runner": true, "num_envs_per_env_runner": 1, "gym_env_vectorize_mode": "SYNC", "num_cpus_per_env_runner": 1, "num_gpus_per_env_runner": 0, "custom_resources_per_env_runner": {}, "validate_env_runners_after_construction": true, "episodes_to_numpy": true, "max_requests_in_flight_per_env_runner": 1, "sample_timeout_s": 60.0, "_env_to_module_connector": null, "add_default_connectors_to_env_to_module_pipeline": true, "_module_to_env_connector": null, "add_default_connectors_to_module_to_env_pipeline": true, "merge_env_runner_states": "training_only", "broadcast_env_runner_states": true, "episode_lookback_horizon": 1, "rollout_fragment_length": "auto", "batch_mode": "complete_episodes", "compress_observations": false, "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "enable_tf1_exec_eagerly": false, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "preprocessor_pref": "deepmind", "observation_filter": "NoFilter", "update_worker_filter_stats": true, "use_worker_filter_stats": true, "sampler_perf_stats_ema_coef": null, "_is_online": true, "num_learners": 0, "num_gpus_per_learner": 0, "num_cpus_per_learner": "auto", "num_aggregator_actors_per_learner": 0, "max_requests_in_flight_per_aggregator_actor": 3, "local_gpu_idx": 0, "max_requests_in_flight_per_learner": 3, "gamma": 1, "lr": 0.0002847858517, "grad_clip": 0.5, "grad_clip_by": "global_norm", "_train_batch_size_per_learner": 5000, "train_batch_size": 4000, "num_epochs": 1, "minibatch_size": 1000, "shuffle_batch_per_epoch": true, "model": {"fcnet_hiddens": [256, 256], "fcnet_activation": "tanh", "fcnet_weights_initializer": null, "fcnet_weights_initializer_config": null, "fcnet_bias_initializer": null, "fcnet_bias_initializer_config": null, "conv_filters": null, "conv_activation": "relu", "conv_kernel_initializer": null, "conv_kernel_initializer_config": null, "conv_bias_initializer": null, "conv_bias_initializer_config": null, "conv_transpose_kernel_initializer": null, "conv_transpose_kernel_initializer_config": null, "conv_transpose_bias_initializer": null, "conv_transpose_bias_initializer_config": null, "post_fcnet_hiddens": [], "post_fcnet_activation": "relu", "post_fcnet_weights_initializer": null, "post_fcnet_weights_initializer_config": null, "post_fcnet_bias_initializer": null, "post_fcnet_bias_initializer_config": null, "free_log_std": false, "log_std_clip_param": 20.0, "no_final_linear": false, "vf_share_layers": false, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "lstm_weights_initializer": null, "lstm_weights_initializer_config": null, "lstm_bias_initializer": null, "lstm_bias_initializer_config": null, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "attention_use_n_prev_actions": 0, "attention_use_n_prev_rewards": 0, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": null, "custom_model_config": {}, "custom_action_dist": null, "custom_preprocessor": null, "encoder_latent_dim": null, "always_check_shapes": false, "lstm_use_prev_action_reward": -1, "_use_default_native_models": -1, "_disable_preprocessor_api": false, "_disable_action_flattening": false}, "_learner_connector": null, "add_default_connectors_to_learner_pipeline": true, "learner_config_dict": {}, "optimizer": {}, "_learner_class": null, "callbacks_on_algorithm_init": null, "callbacks_on_env_runners_recreated": null, "callbacks_on_offline_eval_runners_recreated": null, "callbacks_on_checkpoint_loaded": null, "callbacks_on_environment_created": null, "callbacks_on_episode_created": null, "callbacks_on_episode_start": null, "callbacks_on_episode_step": null, "callbacks_on_episode_end": null, "callbacks_on_evaluate_start": null, "callbacks_on_evaluate_end": null, "callbacks_on_evaluate_offline_start": null, "callbacks_on_evaluate_offline_end": null, "callbacks_on_sample_end": null, "callbacks_on_train_result": null, "explore": true, "enable_rl_module_and_learner": true, "enable_env_runner_and_connector_v2": true, "_prior_exploration_config": {"type": "StochasticSampling"}, "count_steps_by": "env_steps", "policy_map_capacity": 100, "policy_mapping_fn": "<function AlgorithmConfig.DEFAULT_POLICY_MAPPING_FN at 0x13ca69b20>", "policies_to_train": null, "policy_states_are_swappable": false, "observation_fn": null, "offline_data_class": null, "input_read_method": "read_parquet", "input_read_method_kwargs": {}, "input_read_schema": {}, "input_read_episodes": false, "input_read_sample_batches": false, "input_read_batch_size": null, "input_filesystem": null, "input_filesystem_kwargs": {}, "input_compress_columns": ["obs", "new_obs"], "input_spaces_jsonable": true, "materialize_data": false, "materialize_mapped_data": true, "map_batches_kwargs": {}, "iter_batches_kwargs": {}, "ignore_final_observation": false, "prelearner_class": null, "prelearner_buffer_class": null, "prelearner_buffer_kwargs": {}, "prelearner_module_synch_period": 10, "dataset_num_iters_per_learner": null, "input_config": {}, "actions_in_input_normalized": false, "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_config": {}, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "output_max_rows_per_file": null, "output_write_remaining_data": false, "output_write_method": "write_parquet", "output_write_method_kwargs": {}, "output_filesystem": null, "output_filesystem_kwargs": {}, "output_write_episodes": true, "offline_sampling": false, "evaluation_interval": 1, "evaluation_duration": 20, "evaluation_duration_unit": "episodes", "evaluation_sample_timeout_s": 120.0, "evaluation_auto_duration_min_env_steps_per_sample": 100, "evaluation_auto_duration_max_env_steps_per_sample": 2000, "evaluation_parallel_to_training": false, "evaluation_force_reset_envs_before_iteration": true, "evaluation_config": null, "off_policy_estimation_methods": {}, "ope_split_batch_by_episode": true, "evaluation_num_env_runners": 1, "in_evaluation": false, "sync_filters_on_rollout_workers_timeout_s": 10.0, "offline_evaluation_interval": null, "num_offline_eval_runners": 0, "offline_loss_for_module_fn": null, "offline_evaluation_duration": 1, "offline_evaluation_parallel_to_training": false, "offline_evaluation_timeout_s": 120.0, "num_cpus_per_offline_eval_runner": 1, "num_gpus_per_offline_eval_runner": 0, "custom_resources_per_offline_eval_runner": {}, "restart_failed_offline_eval_runners": true, "ignore_offline_eval_runner_failures": false, "max_num_offline_eval_runner_restarts": 1000, "offline_eval_runner_restore_timeout_s": 1800.0, "max_requests_in_flight_per_offline_eval_runner": 1, "validate_offline_eval_runners_after_construction": true, "offline_eval_runner_health_probe_timeout_s": 30.0, "offline_eval_rl_module_inference_only": false, "broadcast_offline_eval_runner_states": false, "offline_eval_batch_size_per_runner": 256, "dataset_num_iters_per_eval_runner": 1, "keep_per_episode_custom_metrics": false, "metrics_episode_collection_timeout_s": 60.0, "metrics_num_episodes_for_smoothing": 100, "min_time_s_per_iteration": null, "min_train_timesteps_per_iteration": 0, "min_sample_timesteps_per_iteration": 0, "log_gradients": true, "export_native_model_files": false, "checkpoint_trainable_policies_only": false, "logger_creator": null, "logger_config": null, "log_level": "WARN", "log_sys_usage": true, "fake_sampler": false, "seed": 7, "restart_failed_env_runners": true, "ignore_env_runner_failures": false, "max_num_env_runner_restarts": 1000, "delay_between_env_runner_restarts_s": 60.0, "restart_failed_sub_environments": false, "num_consecutive_env_runner_failures_tolerance": 100, "env_runner_health_probe_timeout_s": 30.0, "env_runner_restore_timeout_s": 1800.0, "_model_config": {}, "_rl_module_spec": "RLModuleSpec(module_class=None, observation_space=None, action_space=None, inference_only=False, learner_only=False, model_config=DefaultModelConfig(fcnet_hiddens=[60, 90], fcnet_activation='tanh', fcnet_kernel_initializer=None, fcnet_kernel_initializer_kwargs=None, fcnet_bias_initializer=None, fcnet_bias_initializer_kwargs=None, conv_filters=None, conv_activation='relu', conv_kernel_initializer=None, conv_kernel_initializer_kwargs=None, conv_bias_initializer=None, conv_bias_initializer_kwargs=None, head_fcnet_hiddens=[], head_fcnet_activation='relu', head_fcnet_kernel_initializer=None, head_fcnet_kernel_initializer_kwargs=None, head_fcnet_bias_initializer=None, head_fcnet_bias_initializer_kwargs=None, free_log_std=False, log_std_clip_param=20.0, vf_share_layers=True, use_lstm=False, max_seq_len=20, lstm_cell_size=256, lstm_use_prev_action=False, lstm_use_prev_reward=False, lstm_kernel_initializer=None, lstm_kernel_initializer_kwargs=None, lstm_bias_initializer=None, lstm_bias_initializer_kwargs=None), catalog_class=None, load_state_path=None, model_config_dict=None)", "algorithm_config_overrides_per_module": {}, "_per_module_overrides": {}, "_validate_config": true, "_use_msgpack_checkpoints": false, "_torch_grad_scaler_class": null, "_torch_lr_scheduler_classes": null, "_tf_policy_handles_more_than_one_loss": false, "_disable_preprocessor_api": false, "_disable_action_flattening": false, "_disable_initialize_loss_from_dummy_batch": false, "_dont_auto_sync_env_runner_states": false, "env_task_fn": -1, "enable_connectors": -1, "simple_optimizer": false, "policy_map_cache": -1, "worker_cls": -1, "synchronize_filters": -1, "enable_async_evaluation": -1, "custom_async_evaluation_function": -1, "_enable_rl_module_api": -1, "auto_wrap_old_gym_envs": -1, "always_attach_evaluation_results": -1, "replay_sequence_length": null, "_disable_execution_plan_api": -1, "use_critic": true, "use_gae": true, "use_kl_loss": true, "kl_coeff": 0.7464963036515, "kl_target": 0.0270990929592, "vf_loss_coeff": 0.6688075857018, "entropy_coeff": 0.0090570820258, "clip_param": 0.1221781641624, "vf_clip_param": 0.1027808522125, "entropy_coeff_schedule": null, "lr_schedule": null, "sgd_minibatch_size": -1, "vf_share_layers": -1, "__stdout_file__": null, "__stderr_file__": null, "lambda": 0.9099046732075, "input": "sampler", "policies": {"default_policy": [null, null, null, null]}, "callbacks": "<class 'ray.rllib.callbacks.callbacks.RLlibCallback'>", "create_env_on_driver": false, "custom_eval_function": null, "framework": "torch"}, "time_since_restore": 20.49792742729187, "iterations_since_restore": 12, "perf": {"cpu_util_percent": 34.3, "ram_util_percent": 76.86666666666666}}
{"timers": {"training_iteration": 1.5474272626865322, "restore_env_runners": 1.1053827212713198e-05, "training_step": 1.547238984242065, "env_runner_sampling_timer": 1.4387774866927476, "learner_update_timer": 0.1053704557997208, "synch_weights": 0.0004970953715100677, "restore_eval_env_runners": 1.040247388484758e-05, "evaluation_iteration": 0.10584385912804736, "synch_eval_env_connectors": 0.00012319277214949373, "synch_env_connectors": 4.7608671861320675e-06}, "env_runners": {"weights_seq_no": 12.0, "module_to_env_connector": {"timers": {"connectors": {"tensor_to_numpy": 1.2949198918105868e-05, "listify_data_for_vector_env": 1.0866083734113902e-05, "remove_single_ts_time_rank_from_batch": 5.70283753438776e-07, "get_actions": 3.7431265073036954e-05, "normalize_and_clip_actions": 9.294302082947452e-06, "un_batch_to_individual_items": 5.284032596885375e-06}}, "connector_pipeline_timer": 0.00010136609916747499}, "episode_len_mean": 20.0, "num_agent_steps_sampled_lifetime": {"default_agent": -6782500.0}, "num_agent_steps_sampled": {"default_agent": 5000.0}, "sample": 0.004662102968976217, "env_to_module_connector": {"timers": {"connectors": {"batch_individual_items": 6.449429466051243e-06, "add_observations_from_episodes_to_batch": 2.9417369634475515e-06, "add_states_from_episodes_to_batch": 1.7348532201777978e-06, "add_time_dim_to_batch_and_zero_pad": 2.320494651187137e-06, "numpy_to_tensor": 8.472824970909832e-06}}, "connector_pipeline_timer": 4.339569611684362e-05}, "env_step_timer": 1.3702057111578462e-05, "num_episodes": 250.0, "episode_len_min": 20, "num_module_steps_sampled_lifetime": {"default_policy": -6782500.0}, "env_to_module_sum_episodes_length_in": 10.36823839457432, "agent_episode_returns_mean": {"default_agent": 6.419999999999999}, "num_env_steps_sampled": 5000.0, "episode_return_mean": 6.419999999999999, "num_module_steps_sampled": {"default_policy": 5000.0}, "episode_duration_sec_mean": 0.004495133463758974, "module_episode_returns_mean": {"default_policy": 6.419999999999999}, "num_episodes_lifetime": -339125.0, "episode_return_max": 10.5, "episode_len_max": 20, "env_to_module_sum_episodes_length_out": 10.36823839457432, "episode_return_min": -9.5, "num_env_steps_sampled_lifetime": -6782500.0, "env_reset_timer": 2.9954071835578825e-05, "time_between_sampling": 0.0016396129171861301, "rlmodule_inference_timer": 2.6932166504281366e-05, "num_env_steps_sampled_lifetime_throughput": 3845.7204451371535}, "learners": {"default_policy": {"diff_num_grad_updates_vs_sampler_policy": 1.0, "mean_kl_loss": 0.00015232563600875437, "num_module_steps_trained": 6000, "vf_explained_var": -0.010016202926635742, "entropy": 0.5557562112808228, "curr_entropy_coeff": 0.0090570820258, "num_trainable_parameters": 6003, "vf_loss_unclipped": 28.251325607299805, "gradients_default_optimizer_global_norm": 0.03824322298169136, "default_optimizer_learning_rate": 0.0002847858517, "module_train_batch_size_mean": 1000.0, "num_module_steps_trained_lifetime": 78000, "total_loss": 0.0764087438583374, "curr_kl_coeff": 9.112503903452307e-05, "policy_loss": 0.012701627798378468, "vf_loss": 0.10278083384037018, "weights_seq_no": 13.0, "num_module_steps_trained_lifetime_throughput": 458318.4275859342}, "__all_modules__": {"learner_connector": {"connector_pipeline_timer": 0.08154042024066857, "timers": {"connectors": {"add_one_ts_to_episodes_and_truncate": 0.00825855443899811, "add_columns_from_episodes_to_train_batch": 0.03323452135442928, "general_advantage_estimation": 0.0068612438634729255, "numpy_to_tensor": 7.033118832731349e-05, "batch_individual_items": 0.03217547404598363, "add_observations_from_episodes_to_batch": 0.0008130347566400561, "add_states_from_episodes_to_batch": 3.714007302981138e-06, "add_time_dim_to_batch_and_zero_pad": 1.0431740003853576e-05}}}, "num_non_trainable_parameters": 0, "learner_connector_sum_episodes_length_in": 5000.0, "learner_connector_sum_episodes_length_out": 5250.0, "num_module_steps_trained": 6000, "num_trainable_parameters": 6003, "num_env_steps_trained_lifetime": 409500, "num_env_steps_trained": 31500, "num_module_steps_trained_lifetime": 78000, "num_env_steps_trained_lifetime_throughput": 2390828.0531678773, "num_module_steps_trained_throughput": 457252.8459594625, "num_module_steps_trained_lifetime_throughput": 456542.62839443056}}, "num_training_step_calls_per_iteration": 1, "evaluation": {"env_runners": {"module_to_env_connector": {"timers": {"connectors": {"un_batch_to_individual_items": 5.483393938742149e-06, "listify_data_for_vector_env": 1.1656961193848176e-05, "remove_single_ts_time_rank_from_batch": 5.691096166174463e-07, "normalize_and_clip_actions": 9.731111047782701e-06, "tensor_to_numpy": 1.3077403096115337e-05, "get_actions": 3.666104402705012e-05}}, "connector_pipeline_timer": 0.000102865043058573}, "agent_episode_returns_mean": {"default_agent": -0.35}, "sample": 0.09841362072814784, "env_step_timer": 1.4520940800183983e-05, "num_episodes": 20, "module_episode_returns_mean": {"default_policy": -0.35}, "episode_return_max": 12.5, "episode_return_min": -12.5, "rlmodule_inference_timer": 2.7392561146174894e-05, "env_to_module_connector": {"timers": {"connectors": {"numpy_to_tensor": 8.771826030671413e-06, "batch_individual_items": 6.33545503903862e-06, "add_observations_from_episodes_to_batch": 2.899957201267755e-06, "add_states_from_episodes_to_batch": 1.6166525506482048e-06, "add_time_dim_to_batch_and_zero_pad": 2.6730203268717027e-06}}, "connector_pipeline_timer": 4.401557195711134e-05}, "env_to_module_sum_episodes_length_in": 10.368238394574323, "episode_return_mean": -0.35, "episode_duration_sec_mean": 0.004438506636070087, "episode_len_max": 20, "env_to_module_sum_episodes_length_out": 10.368238394574323, "env_reset_timer": 0.000247320979140556, "num_agent_steps_sampled_lifetime": {"default_agent": 5200}, "episode_len_mean": 20.0, "num_module_steps_sampled_lifetime": {"default_policy": 5200}, "episode_len_min": 20, "num_agent_steps_sampled": {"default_agent": 400}, "weights_seq_no": 13.0, "num_module_steps_sampled": {"default_policy": 400}, "num_env_steps_sampled": 400, "num_episodes_lifetime": 260, "num_env_steps_sampled_lifetime": 65400, "time_between_sampling": 1.6375295119895006}, "num_healthy_workers": 1, "actor_manager_num_outstanding_async_reqs": 0, "num_remote_worker_restarts": 0}, "num_env_steps_sampled_lifetime": -6782500.0, "fault_tolerance": {"num_healthy_workers": 0, "num_remote_worker_restarts": 0}, "env_runner_group": {"actor_manager_num_outstanding_async_reqs": 0}, "done": false, "training_iteration": 13, "trial_id": "499df_00000", "date": "2025-08-11_19-37-19", "timestamp": 1754933839, "time_this_iter_s": 1.658926010131836, "time_total_s": 22.156853437423706, "pid": 28380, "hostname": "Mac", "node_ip": "127.0.0.1", "config": {"exploration_config": {}, "extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "placement_strategy": "PACK", "num_gpus": 0, "_fake_gpus": false, "num_cpus_for_main_process": 2, "eager_tracing": true, "eager_max_retraces": 20, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "torch_compile_learner": false, "torch_compile_learner_what_to_compile": "forward_train", "torch_compile_learner_dynamo_backend": "aot_eager", "torch_compile_learner_dynamo_mode": null, "torch_compile_worker": false, "torch_compile_worker_dynamo_backend": "aot_eager", "torch_compile_worker_dynamo_mode": null, "torch_ddp_kwargs": {}, "torch_skip_nan_gradients": false, "env": "Umbrella", "env_config": {}, "observation_space": null, "action_space": null, "clip_rewards": null, "normalize_actions": true, "clip_actions": false, "_is_atari": null, "disable_env_checking": false, "render_env": false, "action_mask_key": "action_mask", "env_runner_cls": null, "num_env_runners": 0, "create_local_env_runner": true, "num_envs_per_env_runner": 1, "gym_env_vectorize_mode": "SYNC", "num_cpus_per_env_runner": 1, "num_gpus_per_env_runner": 0, "custom_resources_per_env_runner": {}, "validate_env_runners_after_construction": true, "episodes_to_numpy": true, "max_requests_in_flight_per_env_runner": 1, "sample_timeout_s": 60.0, "_env_to_module_connector": null, "add_default_connectors_to_env_to_module_pipeline": true, "_module_to_env_connector": null, "add_default_connectors_to_module_to_env_pipeline": true, "merge_env_runner_states": "training_only", "broadcast_env_runner_states": true, "episode_lookback_horizon": 1, "rollout_fragment_length": "auto", "batch_mode": "complete_episodes", "compress_observations": false, "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "enable_tf1_exec_eagerly": false, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "preprocessor_pref": "deepmind", "observation_filter": "NoFilter", "update_worker_filter_stats": true, "use_worker_filter_stats": true, "sampler_perf_stats_ema_coef": null, "_is_online": true, "num_learners": 0, "num_gpus_per_learner": 0, "num_cpus_per_learner": "auto", "num_aggregator_actors_per_learner": 0, "max_requests_in_flight_per_aggregator_actor": 3, "local_gpu_idx": 0, "max_requests_in_flight_per_learner": 3, "gamma": 1, "lr": 0.0002847858517, "grad_clip": 0.5, "grad_clip_by": "global_norm", "_train_batch_size_per_learner": 5000, "train_batch_size": 4000, "num_epochs": 1, "minibatch_size": 1000, "shuffle_batch_per_epoch": true, "model": {"fcnet_hiddens": [256, 256], "fcnet_activation": "tanh", "fcnet_weights_initializer": null, "fcnet_weights_initializer_config": null, "fcnet_bias_initializer": null, "fcnet_bias_initializer_config": null, "conv_filters": null, "conv_activation": "relu", "conv_kernel_initializer": null, "conv_kernel_initializer_config": null, "conv_bias_initializer": null, "conv_bias_initializer_config": null, "conv_transpose_kernel_initializer": null, "conv_transpose_kernel_initializer_config": null, "conv_transpose_bias_initializer": null, "conv_transpose_bias_initializer_config": null, "post_fcnet_hiddens": [], "post_fcnet_activation": "relu", "post_fcnet_weights_initializer": null, "post_fcnet_weights_initializer_config": null, "post_fcnet_bias_initializer": null, "post_fcnet_bias_initializer_config": null, "free_log_std": false, "log_std_clip_param": 20.0, "no_final_linear": false, "vf_share_layers": false, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "lstm_weights_initializer": null, "lstm_weights_initializer_config": null, "lstm_bias_initializer": null, "lstm_bias_initializer_config": null, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "attention_use_n_prev_actions": 0, "attention_use_n_prev_rewards": 0, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": null, "custom_model_config": {}, "custom_action_dist": null, "custom_preprocessor": null, "encoder_latent_dim": null, "always_check_shapes": false, "lstm_use_prev_action_reward": -1, "_use_default_native_models": -1, "_disable_preprocessor_api": false, "_disable_action_flattening": false}, "_learner_connector": null, "add_default_connectors_to_learner_pipeline": true, "learner_config_dict": {}, "optimizer": {}, "_learner_class": null, "callbacks_on_algorithm_init": null, "callbacks_on_env_runners_recreated": null, "callbacks_on_offline_eval_runners_recreated": null, "callbacks_on_checkpoint_loaded": null, "callbacks_on_environment_created": null, "callbacks_on_episode_created": null, "callbacks_on_episode_start": null, "callbacks_on_episode_step": null, "callbacks_on_episode_end": null, "callbacks_on_evaluate_start": null, "callbacks_on_evaluate_end": null, "callbacks_on_evaluate_offline_start": null, "callbacks_on_evaluate_offline_end": null, "callbacks_on_sample_end": null, "callbacks_on_train_result": null, "explore": true, "enable_rl_module_and_learner": true, "enable_env_runner_and_connector_v2": true, "_prior_exploration_config": {"type": "StochasticSampling"}, "count_steps_by": "env_steps", "policy_map_capacity": 100, "policy_mapping_fn": "<function AlgorithmConfig.DEFAULT_POLICY_MAPPING_FN at 0x13ca69b20>", "policies_to_train": null, "policy_states_are_swappable": false, "observation_fn": null, "offline_data_class": null, "input_read_method": "read_parquet", "input_read_method_kwargs": {}, "input_read_schema": {}, "input_read_episodes": false, "input_read_sample_batches": false, "input_read_batch_size": null, "input_filesystem": null, "input_filesystem_kwargs": {}, "input_compress_columns": ["obs", "new_obs"], "input_spaces_jsonable": true, "materialize_data": false, "materialize_mapped_data": true, "map_batches_kwargs": {}, "iter_batches_kwargs": {}, "ignore_final_observation": false, "prelearner_class": null, "prelearner_buffer_class": null, "prelearner_buffer_kwargs": {}, "prelearner_module_synch_period": 10, "dataset_num_iters_per_learner": null, "input_config": {}, "actions_in_input_normalized": false, "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_config": {}, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "output_max_rows_per_file": null, "output_write_remaining_data": false, "output_write_method": "write_parquet", "output_write_method_kwargs": {}, "output_filesystem": null, "output_filesystem_kwargs": {}, "output_write_episodes": true, "offline_sampling": false, "evaluation_interval": 1, "evaluation_duration": 20, "evaluation_duration_unit": "episodes", "evaluation_sample_timeout_s": 120.0, "evaluation_auto_duration_min_env_steps_per_sample": 100, "evaluation_auto_duration_max_env_steps_per_sample": 2000, "evaluation_parallel_to_training": false, "evaluation_force_reset_envs_before_iteration": true, "evaluation_config": null, "off_policy_estimation_methods": {}, "ope_split_batch_by_episode": true, "evaluation_num_env_runners": 1, "in_evaluation": false, "sync_filters_on_rollout_workers_timeout_s": 10.0, "offline_evaluation_interval": null, "num_offline_eval_runners": 0, "offline_loss_for_module_fn": null, "offline_evaluation_duration": 1, "offline_evaluation_parallel_to_training": false, "offline_evaluation_timeout_s": 120.0, "num_cpus_per_offline_eval_runner": 1, "num_gpus_per_offline_eval_runner": 0, "custom_resources_per_offline_eval_runner": {}, "restart_failed_offline_eval_runners": true, "ignore_offline_eval_runner_failures": false, "max_num_offline_eval_runner_restarts": 1000, "offline_eval_runner_restore_timeout_s": 1800.0, "max_requests_in_flight_per_offline_eval_runner": 1, "validate_offline_eval_runners_after_construction": true, "offline_eval_runner_health_probe_timeout_s": 30.0, "offline_eval_rl_module_inference_only": false, "broadcast_offline_eval_runner_states": false, "offline_eval_batch_size_per_runner": 256, "dataset_num_iters_per_eval_runner": 1, "keep_per_episode_custom_metrics": false, "metrics_episode_collection_timeout_s": 60.0, "metrics_num_episodes_for_smoothing": 100, "min_time_s_per_iteration": null, "min_train_timesteps_per_iteration": 0, "min_sample_timesteps_per_iteration": 0, "log_gradients": true, "export_native_model_files": false, "checkpoint_trainable_policies_only": false, "logger_creator": null, "logger_config": null, "log_level": "WARN", "log_sys_usage": true, "fake_sampler": false, "seed": 7, "restart_failed_env_runners": true, "ignore_env_runner_failures": false, "max_num_env_runner_restarts": 1000, "delay_between_env_runner_restarts_s": 60.0, "restart_failed_sub_environments": false, "num_consecutive_env_runner_failures_tolerance": 100, "env_runner_health_probe_timeout_s": 30.0, "env_runner_restore_timeout_s": 1800.0, "_model_config": {}, "_rl_module_spec": "RLModuleSpec(module_class=None, observation_space=None, action_space=None, inference_only=False, learner_only=False, model_config=DefaultModelConfig(fcnet_hiddens=[60, 90], fcnet_activation='tanh', fcnet_kernel_initializer=None, fcnet_kernel_initializer_kwargs=None, fcnet_bias_initializer=None, fcnet_bias_initializer_kwargs=None, conv_filters=None, conv_activation='relu', conv_kernel_initializer=None, conv_kernel_initializer_kwargs=None, conv_bias_initializer=None, conv_bias_initializer_kwargs=None, head_fcnet_hiddens=[], head_fcnet_activation='relu', head_fcnet_kernel_initializer=None, head_fcnet_kernel_initializer_kwargs=None, head_fcnet_bias_initializer=None, head_fcnet_bias_initializer_kwargs=None, free_log_std=False, log_std_clip_param=20.0, vf_share_layers=True, use_lstm=False, max_seq_len=20, lstm_cell_size=256, lstm_use_prev_action=False, lstm_use_prev_reward=False, lstm_kernel_initializer=None, lstm_kernel_initializer_kwargs=None, lstm_bias_initializer=None, lstm_bias_initializer_kwargs=None), catalog_class=None, load_state_path=None, model_config_dict=None)", "algorithm_config_overrides_per_module": {}, "_per_module_overrides": {}, "_validate_config": true, "_use_msgpack_checkpoints": false, "_torch_grad_scaler_class": null, "_torch_lr_scheduler_classes": null, "_tf_policy_handles_more_than_one_loss": false, "_disable_preprocessor_api": false, "_disable_action_flattening": false, "_disable_initialize_loss_from_dummy_batch": false, "_dont_auto_sync_env_runner_states": false, "env_task_fn": -1, "enable_connectors": -1, "simple_optimizer": false, "policy_map_cache": -1, "worker_cls": -1, "synchronize_filters": -1, "enable_async_evaluation": -1, "custom_async_evaluation_function": -1, "_enable_rl_module_api": -1, "auto_wrap_old_gym_envs": -1, "always_attach_evaluation_results": -1, "replay_sequence_length": null, "_disable_execution_plan_api": -1, "use_critic": true, "use_gae": true, "use_kl_loss": true, "kl_coeff": 0.7464963036515, "kl_target": 0.0270990929592, "vf_loss_coeff": 0.6688075857018, "entropy_coeff": 0.0090570820258, "clip_param": 0.1221781641624, "vf_clip_param": 0.1027808522125, "entropy_coeff_schedule": null, "lr_schedule": null, "sgd_minibatch_size": -1, "vf_share_layers": -1, "__stdout_file__": null, "__stderr_file__": null, "lambda": 0.9099046732075, "input": "sampler", "policies": {"default_policy": [null, null, null, null]}, "callbacks": "<class 'ray.rllib.callbacks.callbacks.RLlibCallback'>", "create_env_on_driver": false, "custom_eval_function": null, "framework": "torch"}, "time_since_restore": 22.156853437423706, "iterations_since_restore": 13, "perf": {"cpu_util_percent": 34.150000000000006, "ram_util_percent": 77.25}}
{"timers": {"training_iteration": 1.5469285800600616, "restore_env_runners": 1.1011629391111349e-05, "training_step": 1.5467403448097803, "env_runner_sampling_timer": 1.437486515155938, "learner_update_timer": 0.10616400124229729, "synch_weights": 0.000497602327957848, "restore_eval_env_runners": 1.0362619599696547e-05, "evaluation_iteration": 0.10583913345658698, "synch_eval_env_connectors": 0.00012282834463072908, "synch_env_connectors": 4.753677914009058e-06}, "env_runners": {"weights_seq_no": 13.0, "module_to_env_connector": {"timers": {"connectors": {"tensor_to_numpy": 1.2651372721574107e-05, "listify_data_for_vector_env": 1.066566422485244e-05, "remove_single_ts_time_rank_from_batch": 5.665444902292128e-07, "get_actions": 3.633055543683014e-05, "normalize_and_clip_actions": 9.125644737286117e-06, "un_batch_to_individual_items": 5.179932834681473e-06}}, "connector_pipeline_timer": 9.909508342726194e-05}, "episode_len_mean": 20.0, "num_agent_steps_sampled_lifetime": {"default_agent": -7400000.0}, "num_agent_steps_sampled": {"default_agent": 5000.0}, "sample": 0.004756681050363774, "env_to_module_connector": {"timers": {"connectors": {"batch_individual_items": 6.243825299677742e-06, "add_observations_from_episodes_to_batch": 2.8897093739986316e-06, "add_states_from_episodes_to_batch": 1.7120524222669675e-06, "add_time_dim_to_batch_and_zero_pad": 2.276100430075127e-06, "numpy_to_tensor": 8.236789385849312e-06}}, "connector_pipeline_timer": 4.233165073488147e-05}, "env_step_timer": 1.332486394779487e-05, "num_episodes": 250.0, "episode_len_min": 20, "num_module_steps_sampled_lifetime": {"default_policy": -7400000.0}, "env_to_module_sum_episodes_length_in": 10.36823839457432, "agent_episode_returns_mean": {"default_agent": 6.74}, "num_env_steps_sampled": 5000.0, "episode_return_mean": 6.74, "num_module_steps_sampled": {"default_policy": 5000.0}, "episode_duration_sec_mean": 0.004330098234582692, "module_episode_returns_mean": {"default_policy": 6.74}, "num_episodes_lifetime": -370000.0, "episode_return_max": 10.5, "episode_len_max": 20, "env_to_module_sum_episodes_length_out": 10.36823839457432, "episode_return_min": -9.5, "num_env_steps_sampled_lifetime": -7400000.0, "env_reset_timer": 3.2290390752828536e-05, "time_between_sampling": 0.0016867362492846614, "rlmodule_inference_timer": 2.6673263659248683e-05, "num_env_steps_sampled_lifetime_throughput": 3890.892831516703}, "learners": {"default_policy": {"diff_num_grad_updates_vs_sampler_policy": 1.0, "mean_kl_loss": 5.350949504645541e-05, "num_module_steps_trained": 6000, "vf_explained_var": -0.008661389350891113, "entropy": 0.5543418526649475, "curr_entropy_coeff": 0.0090570820258, "num_trainable_parameters": 6003, "vf_loss_unclipped": 27.92440414428711, "gradients_default_optimizer_global_norm": 0.028520269319415092, "default_optimizer_learning_rate": 0.0002847858517, "module_train_batch_size_mean": 1000.0, "num_module_steps_trained_lifetime": 84000, "total_loss": -0.13544487953186035, "curr_kl_coeff": 4.5562519517261535e-05, "policy_loss": -0.1991647630929947, "vf_loss": 0.10278083384037018, "weights_seq_no": 14.0, "num_module_steps_trained_lifetime_throughput": 458169.88528439647}, "__all_modules__": {"learner_connector": {"connector_pipeline_timer": 0.08244875269788557, "timers": {"connectors": {"add_one_ts_to_episodes_and_truncate": 0.008249954314775576, "add_columns_from_episodes_to_train_batch": 0.03324577739050903, "general_advantage_estimation": 0.006844574755165245, "numpy_to_tensor": 7.024954706828158e-05, "batch_individual_items": 0.033097705975684455, "add_observations_from_episodes_to_batch": 0.0008130906588345664, "add_states_from_episodes_to_batch": 3.7106171959021734e-06, "add_time_dim_to_batch_and_zero_pad": 1.0509922247230253e-05}}}, "num_non_trainable_parameters": 0, "learner_connector_sum_episodes_length_in": 5000.0, "learner_connector_sum_episodes_length_out": 5250.0, "num_module_steps_trained": 6000, "num_trainable_parameters": 6003, "num_env_steps_trained_lifetime": 441000, "num_env_steps_trained": 31500, "num_module_steps_trained_lifetime": 84000, "num_env_steps_trained_lifetime_throughput": 2390919.230061204, "num_module_steps_trained_throughput": 457193.9709948017, "num_module_steps_trained_lifetime_throughput": 456507.59786582354}}, "num_training_step_calls_per_iteration": 1, "evaluation": {"env_runners": {"module_to_env_connector": {"timers": {"connectors": {"un_batch_to_individual_items": 5.258223777254668e-06, "listify_data_for_vector_env": 1.0727556575919646e-05, "remove_single_ts_time_rank_from_batch": 5.618419420962291e-07, "normalize_and_clip_actions": 9.301278295975248e-06, "tensor_to_numpy": 1.2518292085345908e-05, "get_actions": 3.400178340418699e-05}}, "connector_pipeline_timer": 9.754958531986607e-05}, "agent_episode_returns_mean": {"default_agent": -0.75}, "sample": 0.0983727991006475, "env_step_timer": 1.35963359545374e-05, "num_episodes": 20, "module_episode_returns_mean": {"default_policy": -0.75}, "episode_return_max": 12.5, "episode_return_min": -12.5, "rlmodule_inference_timer": 2.5568093119388258e-05, "env_to_module_connector": {"timers": {"connectors": {"numpy_to_tensor": 8.117151073589269e-06, "batch_individual_items": 6.004758894317769e-06, "add_observations_from_episodes_to_batch": 2.7697024132293957e-06, "add_states_from_episodes_to_batch": 1.5541747970984373e-06, "add_time_dim_to_batch_and_zero_pad": 2.1975837354877236e-06}}, "connector_pipeline_timer": 4.176791065895904e-05}, "env_to_module_sum_episodes_length_in": 10.368238394574323, "episode_return_mean": -0.75, "episode_duration_sec_mean": 0.0044266336935106666, "episode_len_max": 20, "env_to_module_sum_episodes_length_out": 10.368238394574323, "env_reset_timer": 0.0002455552683335618, "num_agent_steps_sampled_lifetime": {"default_agent": 5600}, "episode_len_mean": 20.0, "num_module_steps_sampled_lifetime": {"default_policy": 5600}, "episode_len_min": 20, "num_agent_steps_sampled": {"default_agent": 400}, "weights_seq_no": 14.0, "num_module_steps_sampled": {"default_policy": 400}, "num_env_steps_sampled": 400, "num_episodes_lifetime": 280, "num_env_steps_sampled_lifetime": 70400, "time_between_sampling": 1.6362924810388235}, "num_healthy_workers": 1, "actor_manager_num_outstanding_async_reqs": 0, "num_remote_worker_restarts": 0}, "num_env_steps_sampled_lifetime": -7400000.0, "fault_tolerance": {"num_healthy_workers": 0, "num_remote_worker_restarts": 0}, "env_runner_group": {"actor_manager_num_outstanding_async_reqs": 0}, "done": false, "training_iteration": 14, "trial_id": "499df_00000", "date": "2025-08-11_19-37-21", "timestamp": 1754933841, "time_this_iter_s": 1.598501205444336, "time_total_s": 23.755354642868042, "pid": 28380, "hostname": "Mac", "node_ip": "127.0.0.1", "config": {"exploration_config": {}, "extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "placement_strategy": "PACK", "num_gpus": 0, "_fake_gpus": false, "num_cpus_for_main_process": 2, "eager_tracing": true, "eager_max_retraces": 20, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "torch_compile_learner": false, "torch_compile_learner_what_to_compile": "forward_train", "torch_compile_learner_dynamo_backend": "aot_eager", "torch_compile_learner_dynamo_mode": null, "torch_compile_worker": false, "torch_compile_worker_dynamo_backend": "aot_eager", "torch_compile_worker_dynamo_mode": null, "torch_ddp_kwargs": {}, "torch_skip_nan_gradients": false, "env": "Umbrella", "env_config": {}, "observation_space": null, "action_space": null, "clip_rewards": null, "normalize_actions": true, "clip_actions": false, "_is_atari": null, "disable_env_checking": false, "render_env": false, "action_mask_key": "action_mask", "env_runner_cls": null, "num_env_runners": 0, "create_local_env_runner": true, "num_envs_per_env_runner": 1, "gym_env_vectorize_mode": "SYNC", "num_cpus_per_env_runner": 1, "num_gpus_per_env_runner": 0, "custom_resources_per_env_runner": {}, "validate_env_runners_after_construction": true, "episodes_to_numpy": true, "max_requests_in_flight_per_env_runner": 1, "sample_timeout_s": 60.0, "_env_to_module_connector": null, "add_default_connectors_to_env_to_module_pipeline": true, "_module_to_env_connector": null, "add_default_connectors_to_module_to_env_pipeline": true, "merge_env_runner_states": "training_only", "broadcast_env_runner_states": true, "episode_lookback_horizon": 1, "rollout_fragment_length": "auto", "batch_mode": "complete_episodes", "compress_observations": false, "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "enable_tf1_exec_eagerly": false, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "preprocessor_pref": "deepmind", "observation_filter": "NoFilter", "update_worker_filter_stats": true, "use_worker_filter_stats": true, "sampler_perf_stats_ema_coef": null, "_is_online": true, "num_learners": 0, "num_gpus_per_learner": 0, "num_cpus_per_learner": "auto", "num_aggregator_actors_per_learner": 0, "max_requests_in_flight_per_aggregator_actor": 3, "local_gpu_idx": 0, "max_requests_in_flight_per_learner": 3, "gamma": 1, "lr": 0.0002847858517, "grad_clip": 0.5, "grad_clip_by": "global_norm", "_train_batch_size_per_learner": 5000, "train_batch_size": 4000, "num_epochs": 1, "minibatch_size": 1000, "shuffle_batch_per_epoch": true, "model": {"fcnet_hiddens": [256, 256], "fcnet_activation": "tanh", "fcnet_weights_initializer": null, "fcnet_weights_initializer_config": null, "fcnet_bias_initializer": null, "fcnet_bias_initializer_config": null, "conv_filters": null, "conv_activation": "relu", "conv_kernel_initializer": null, "conv_kernel_initializer_config": null, "conv_bias_initializer": null, "conv_bias_initializer_config": null, "conv_transpose_kernel_initializer": null, "conv_transpose_kernel_initializer_config": null, "conv_transpose_bias_initializer": null, "conv_transpose_bias_initializer_config": null, "post_fcnet_hiddens": [], "post_fcnet_activation": "relu", "post_fcnet_weights_initializer": null, "post_fcnet_weights_initializer_config": null, "post_fcnet_bias_initializer": null, "post_fcnet_bias_initializer_config": null, "free_log_std": false, "log_std_clip_param": 20.0, "no_final_linear": false, "vf_share_layers": false, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "lstm_weights_initializer": null, "lstm_weights_initializer_config": null, "lstm_bias_initializer": null, "lstm_bias_initializer_config": null, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "attention_use_n_prev_actions": 0, "attention_use_n_prev_rewards": 0, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": null, "custom_model_config": {}, "custom_action_dist": null, "custom_preprocessor": null, "encoder_latent_dim": null, "always_check_shapes": false, "lstm_use_prev_action_reward": -1, "_use_default_native_models": -1, "_disable_preprocessor_api": false, "_disable_action_flattening": false}, "_learner_connector": null, "add_default_connectors_to_learner_pipeline": true, "learner_config_dict": {}, "optimizer": {}, "_learner_class": null, "callbacks_on_algorithm_init": null, "callbacks_on_env_runners_recreated": null, "callbacks_on_offline_eval_runners_recreated": null, "callbacks_on_checkpoint_loaded": null, "callbacks_on_environment_created": null, "callbacks_on_episode_created": null, "callbacks_on_episode_start": null, "callbacks_on_episode_step": null, "callbacks_on_episode_end": null, "callbacks_on_evaluate_start": null, "callbacks_on_evaluate_end": null, "callbacks_on_evaluate_offline_start": null, "callbacks_on_evaluate_offline_end": null, "callbacks_on_sample_end": null, "callbacks_on_train_result": null, "explore": true, "enable_rl_module_and_learner": true, "enable_env_runner_and_connector_v2": true, "_prior_exploration_config": {"type": "StochasticSampling"}, "count_steps_by": "env_steps", "policy_map_capacity": 100, "policy_mapping_fn": "<function AlgorithmConfig.DEFAULT_POLICY_MAPPING_FN at 0x13ca69b20>", "policies_to_train": null, "policy_states_are_swappable": false, "observation_fn": null, "offline_data_class": null, "input_read_method": "read_parquet", "input_read_method_kwargs": {}, "input_read_schema": {}, "input_read_episodes": false, "input_read_sample_batches": false, "input_read_batch_size": null, "input_filesystem": null, "input_filesystem_kwargs": {}, "input_compress_columns": ["obs", "new_obs"], "input_spaces_jsonable": true, "materialize_data": false, "materialize_mapped_data": true, "map_batches_kwargs": {}, "iter_batches_kwargs": {}, "ignore_final_observation": false, "prelearner_class": null, "prelearner_buffer_class": null, "prelearner_buffer_kwargs": {}, "prelearner_module_synch_period": 10, "dataset_num_iters_per_learner": null, "input_config": {}, "actions_in_input_normalized": false, "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_config": {}, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "output_max_rows_per_file": null, "output_write_remaining_data": false, "output_write_method": "write_parquet", "output_write_method_kwargs": {}, "output_filesystem": null, "output_filesystem_kwargs": {}, "output_write_episodes": true, "offline_sampling": false, "evaluation_interval": 1, "evaluation_duration": 20, "evaluation_duration_unit": "episodes", "evaluation_sample_timeout_s": 120.0, "evaluation_auto_duration_min_env_steps_per_sample": 100, "evaluation_auto_duration_max_env_steps_per_sample": 2000, "evaluation_parallel_to_training": false, "evaluation_force_reset_envs_before_iteration": true, "evaluation_config": null, "off_policy_estimation_methods": {}, "ope_split_batch_by_episode": true, "evaluation_num_env_runners": 1, "in_evaluation": false, "sync_filters_on_rollout_workers_timeout_s": 10.0, "offline_evaluation_interval": null, "num_offline_eval_runners": 0, "offline_loss_for_module_fn": null, "offline_evaluation_duration": 1, "offline_evaluation_parallel_to_training": false, "offline_evaluation_timeout_s": 120.0, "num_cpus_per_offline_eval_runner": 1, "num_gpus_per_offline_eval_runner": 0, "custom_resources_per_offline_eval_runner": {}, "restart_failed_offline_eval_runners": true, "ignore_offline_eval_runner_failures": false, "max_num_offline_eval_runner_restarts": 1000, "offline_eval_runner_restore_timeout_s": 1800.0, "max_requests_in_flight_per_offline_eval_runner": 1, "validate_offline_eval_runners_after_construction": true, "offline_eval_runner_health_probe_timeout_s": 30.0, "offline_eval_rl_module_inference_only": false, "broadcast_offline_eval_runner_states": false, "offline_eval_batch_size_per_runner": 256, "dataset_num_iters_per_eval_runner": 1, "keep_per_episode_custom_metrics": false, "metrics_episode_collection_timeout_s": 60.0, "metrics_num_episodes_for_smoothing": 100, "min_time_s_per_iteration": null, "min_train_timesteps_per_iteration": 0, "min_sample_timesteps_per_iteration": 0, "log_gradients": true, "export_native_model_files": false, "checkpoint_trainable_policies_only": false, "logger_creator": null, "logger_config": null, "log_level": "WARN", "log_sys_usage": true, "fake_sampler": false, "seed": 7, "restart_failed_env_runners": true, "ignore_env_runner_failures": false, "max_num_env_runner_restarts": 1000, "delay_between_env_runner_restarts_s": 60.0, "restart_failed_sub_environments": false, "num_consecutive_env_runner_failures_tolerance": 100, "env_runner_health_probe_timeout_s": 30.0, "env_runner_restore_timeout_s": 1800.0, "_model_config": {}, "_rl_module_spec": "RLModuleSpec(module_class=None, observation_space=None, action_space=None, inference_only=False, learner_only=False, model_config=DefaultModelConfig(fcnet_hiddens=[60, 90], fcnet_activation='tanh', fcnet_kernel_initializer=None, fcnet_kernel_initializer_kwargs=None, fcnet_bias_initializer=None, fcnet_bias_initializer_kwargs=None, conv_filters=None, conv_activation='relu', conv_kernel_initializer=None, conv_kernel_initializer_kwargs=None, conv_bias_initializer=None, conv_bias_initializer_kwargs=None, head_fcnet_hiddens=[], head_fcnet_activation='relu', head_fcnet_kernel_initializer=None, head_fcnet_kernel_initializer_kwargs=None, head_fcnet_bias_initializer=None, head_fcnet_bias_initializer_kwargs=None, free_log_std=False, log_std_clip_param=20.0, vf_share_layers=True, use_lstm=False, max_seq_len=20, lstm_cell_size=256, lstm_use_prev_action=False, lstm_use_prev_reward=False, lstm_kernel_initializer=None, lstm_kernel_initializer_kwargs=None, lstm_bias_initializer=None, lstm_bias_initializer_kwargs=None), catalog_class=None, load_state_path=None, model_config_dict=None)", "algorithm_config_overrides_per_module": {}, "_per_module_overrides": {}, "_validate_config": true, "_use_msgpack_checkpoints": false, "_torch_grad_scaler_class": null, "_torch_lr_scheduler_classes": null, "_tf_policy_handles_more_than_one_loss": false, "_disable_preprocessor_api": false, "_disable_action_flattening": false, "_disable_initialize_loss_from_dummy_batch": false, "_dont_auto_sync_env_runner_states": false, "env_task_fn": -1, "enable_connectors": -1, "simple_optimizer": false, "policy_map_cache": -1, "worker_cls": -1, "synchronize_filters": -1, "enable_async_evaluation": -1, "custom_async_evaluation_function": -1, "_enable_rl_module_api": -1, "auto_wrap_old_gym_envs": -1, "always_attach_evaluation_results": -1, "replay_sequence_length": null, "_disable_execution_plan_api": -1, "use_critic": true, "use_gae": true, "use_kl_loss": true, "kl_coeff": 0.7464963036515, "kl_target": 0.0270990929592, "vf_loss_coeff": 0.6688075857018, "entropy_coeff": 0.0090570820258, "clip_param": 0.1221781641624, "vf_clip_param": 0.1027808522125, "entropy_coeff_schedule": null, "lr_schedule": null, "sgd_minibatch_size": -1, "vf_share_layers": -1, "__stdout_file__": null, "__stderr_file__": null, "lambda": 0.9099046732075, "input": "sampler", "policies": {"default_policy": [null, null, null, null]}, "callbacks": "<class 'ray.rllib.callbacks.callbacks.RLlibCallback'>", "create_env_on_driver": false, "custom_eval_function": null, "framework": "torch"}, "time_since_restore": 23.755354642868042, "iterations_since_restore": 14, "perf": {"cpu_util_percent": 33.45, "ram_util_percent": 76.5}}
{"timers": {"training_iteration": 1.5467264713497426, "restore_env_runners": 1.0950672959301313e-05, "training_step": 1.5465386446910334, "env_runner_sampling_timer": 1.436531390004187, "learner_update_timer": 0.10691903580904205, "synch_weights": 0.0004982008849602424, "restore_eval_env_runners": 1.032315338001806e-05, "evaluation_iteration": 0.10576707170221264, "synch_eval_env_connectors": 0.00012269881111073554, "synch_env_connectors": 4.747810835163701e-06}, "env_runners": {"weights_seq_no": 14.0, "module_to_env_connector": {"timers": {"connectors": {"tensor_to_numpy": 1.2942326412777093e-05, "listify_data_for_vector_env": 1.0807943616055988e-05, "remove_single_ts_time_rank_from_batch": 5.699273582287008e-07, "get_actions": 3.6827613184024835e-05, "normalize_and_clip_actions": 9.255881835338853e-06, "un_batch_to_individual_items": 5.349165386174043e-06}}, "connector_pipeline_timer": 0.0001007115587971488}, "episode_len_mean": 20.0, "num_agent_steps_sampled_lifetime": {"default_agent": -8017500.0}, "num_agent_steps_sampled": {"default_agent": 5000.0}, "sample": 0.00467867877330713, "env_to_module_connector": {"timers": {"connectors": {"batch_individual_items": 6.374508160288578e-06, "add_observations_from_episodes_to_batch": 3.0016478180251906e-06, "add_states_from_episodes_to_batch": 1.7344217420290869e-06, "add_time_dim_to_batch_and_zero_pad": 2.306789615731996e-06, "numpy_to_tensor": 8.391937594471668e-06}}, "connector_pipeline_timer": 4.293158528933787e-05}, "env_step_timer": 1.3554910331005431e-05, "num_episodes": 250.0, "episode_len_min": 20, "num_module_steps_sampled_lifetime": {"default_policy": -8017500.0}, "env_to_module_sum_episodes_length_in": 10.36823839457432, "agent_episode_returns_mean": {"default_agent": 5.299999999999998}, "num_env_steps_sampled": 5000.0, "episode_return_mean": 5.299999999999998, "num_module_steps_sampled": {"default_policy": 5000.0}, "episode_duration_sec_mean": 0.004430432379711419, "module_episode_returns_mean": {"default_policy": 5.299999999999998}, "num_episodes_lifetime": -400875.0, "episode_return_max": 10.5, "episode_len_max": 20, "env_to_module_sum_episodes_length_out": 10.36823839457432, "episode_return_min": -9.5, "num_env_steps_sampled_lifetime": -8017500.0, "env_reset_timer": 3.071350131925841e-05, "time_between_sampling": 0.001814280225210993, "rlmodule_inference_timer": 2.6769690973120196e-05, "num_env_steps_sampled_lifetime_throughput": 3837.8299578587485}, "learners": {"default_policy": {"diff_num_grad_updates_vs_sampler_policy": 1.0, "mean_kl_loss": 8.566788892494515e-05, "num_module_steps_trained": 6000, "vf_explained_var": -0.010147690773010254, "entropy": 0.5600871443748474, "curr_entropy_coeff": 0.0090570820258, "num_trainable_parameters": 6003, "vf_loss_unclipped": 28.36760139465332, "gradients_default_optimizer_global_norm": 0.03713970631361008, "default_optimizer_learning_rate": 0.0002847858517, "module_train_batch_size_mean": 1000.0, "num_module_steps_trained_lifetime": 90000, "total_loss": 0.11288011074066162, "curr_kl_coeff": 2.2781259758630767e-05, "policy_loss": 0.049212247133255005, "vf_loss": 0.10278083384037018, "weights_seq_no": 15.0, "num_module_steps_trained_lifetime_throughput": 458228.82792633306}, "__all_modules__": {"learner_connector": {"connector_pipeline_timer": 0.08331597975084469, "timers": {"connectors": {"add_one_ts_to_episodes_and_truncate": 0.008241091862018369, "add_columns_from_episodes_to_train_batch": 0.03325961752704092, "general_advantage_estimation": 0.006828200677683883, "numpy_to_tensor": 7.013496177851019e-05, "batch_individual_items": 0.03397668725596895, "add_observations_from_episodes_to_batch": 0.0008129555919425982, "add_states_from_episodes_to_batch": 3.704341293622579e-06, "add_time_dim_to_batch_and_zero_pad": 1.0548153568991272e-05}}}, "num_non_trainable_parameters": 0, "learner_connector_sum_episodes_length_in": 5000.0, "learner_connector_sum_episodes_length_out": 5250.0, "num_module_steps_trained": 6000, "num_trainable_parameters": 6003, "num_env_steps_trained_lifetime": 472500, "num_env_steps_trained": 31500, "num_module_steps_trained_lifetime": 90000, "num_env_steps_trained_lifetime_throughput": 2392044.998811316, "num_module_steps_trained_throughput": 457338.5940065628, "num_module_steps_trained_lifetime_throughput": 456675.1153665058}}, "num_training_step_calls_per_iteration": 1, "evaluation": {"env_runners": {"module_to_env_connector": {"timers": {"connectors": {"un_batch_to_individual_items": 5.226288385064272e-06, "listify_data_for_vector_env": 1.0528574524820593e-05, "remove_single_ts_time_rank_from_batch": 5.426543274204848e-07, "normalize_and_clip_actions": 9.238390774174131e-06, "tensor_to_numpy": 1.2495209306386391e-05, "get_actions": 3.367151696113368e-05}}, "connector_pipeline_timer": 9.662261767746061e-05}, "agent_episode_returns_mean": {"default_agent": -1.35}, "sample": 0.09832516735972059, "env_step_timer": 1.3526401472937869e-05, "num_episodes": 20, "module_episode_returns_mean": {"default_policy": -1.35}, "episode_return_max": 12.5, "episode_return_min": -12.5, "rlmodule_inference_timer": 2.57257545905412e-05, "env_to_module_connector": {"timers": {"connectors": {"numpy_to_tensor": 8.090758642051042e-06, "batch_individual_items": 5.881721644062569e-06, "add_observations_from_episodes_to_batch": 2.805040275634406e-06, "add_states_from_episodes_to_batch": 1.5708296902159557e-06, "add_time_dim_to_batch_and_zero_pad": 2.18147770991984e-06}}, "connector_pipeline_timer": 4.148995329039219e-05}, "env_to_module_sum_episodes_length_in": 10.368238394574323, "episode_return_mean": -1.35, "episode_duration_sec_mean": 0.004418275386560708, "episode_len_max": 20, "env_to_module_sum_episodes_length_out": 10.368238394574323, "env_reset_timer": 0.00024379012602954658, "num_agent_steps_sampled_lifetime": {"default_agent": 6000}, "episode_len_mean": 20.0, "num_module_steps_sampled_lifetime": {"default_policy": 6000}, "episode_len_min": 20, "num_agent_steps_sampled": {"default_agent": 400}, "weights_seq_no": 15.0, "num_module_steps_sampled": {"default_policy": 400}, "num_env_steps_sampled": 400, "num_episodes_lifetime": 300, "num_env_steps_sampled_lifetime": 75400, "time_between_sampling": 1.6353609041485289}, "num_healthy_workers": 1, "actor_manager_num_outstanding_async_reqs": 0, "num_remote_worker_restarts": 0}, "num_env_steps_sampled_lifetime": -8017500.0, "fault_tolerance": {"num_healthy_workers": 0, "num_remote_worker_restarts": 0}, "env_runner_group": {"actor_manager_num_outstanding_async_reqs": 0}, "done": false, "training_iteration": 15, "trial_id": "499df_00000", "date": "2025-08-11_19-37-23", "timestamp": 1754933843, "time_this_iter_s": 1.6271131038665771, "time_total_s": 25.38246774673462, "pid": 28380, "hostname": "Mac", "node_ip": "127.0.0.1", "config": {"exploration_config": {}, "extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "placement_strategy": "PACK", "num_gpus": 0, "_fake_gpus": false, "num_cpus_for_main_process": 2, "eager_tracing": true, "eager_max_retraces": 20, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "torch_compile_learner": false, "torch_compile_learner_what_to_compile": "forward_train", "torch_compile_learner_dynamo_backend": "aot_eager", "torch_compile_learner_dynamo_mode": null, "torch_compile_worker": false, "torch_compile_worker_dynamo_backend": "aot_eager", "torch_compile_worker_dynamo_mode": null, "torch_ddp_kwargs": {}, "torch_skip_nan_gradients": false, "env": "Umbrella", "env_config": {}, "observation_space": null, "action_space": null, "clip_rewards": null, "normalize_actions": true, "clip_actions": false, "_is_atari": null, "disable_env_checking": false, "render_env": false, "action_mask_key": "action_mask", "env_runner_cls": null, "num_env_runners": 0, "create_local_env_runner": true, "num_envs_per_env_runner": 1, "gym_env_vectorize_mode": "SYNC", "num_cpus_per_env_runner": 1, "num_gpus_per_env_runner": 0, "custom_resources_per_env_runner": {}, "validate_env_runners_after_construction": true, "episodes_to_numpy": true, "max_requests_in_flight_per_env_runner": 1, "sample_timeout_s": 60.0, "_env_to_module_connector": null, "add_default_connectors_to_env_to_module_pipeline": true, "_module_to_env_connector": null, "add_default_connectors_to_module_to_env_pipeline": true, "merge_env_runner_states": "training_only", "broadcast_env_runner_states": true, "episode_lookback_horizon": 1, "rollout_fragment_length": "auto", "batch_mode": "complete_episodes", "compress_observations": false, "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "enable_tf1_exec_eagerly": false, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "preprocessor_pref": "deepmind", "observation_filter": "NoFilter", "update_worker_filter_stats": true, "use_worker_filter_stats": true, "sampler_perf_stats_ema_coef": null, "_is_online": true, "num_learners": 0, "num_gpus_per_learner": 0, "num_cpus_per_learner": "auto", "num_aggregator_actors_per_learner": 0, "max_requests_in_flight_per_aggregator_actor": 3, "local_gpu_idx": 0, "max_requests_in_flight_per_learner": 3, "gamma": 1, "lr": 0.0002847858517, "grad_clip": 0.5, "grad_clip_by": "global_norm", "_train_batch_size_per_learner": 5000, "train_batch_size": 4000, "num_epochs": 1, "minibatch_size": 1000, "shuffle_batch_per_epoch": true, "model": {"fcnet_hiddens": [256, 256], "fcnet_activation": "tanh", "fcnet_weights_initializer": null, "fcnet_weights_initializer_config": null, "fcnet_bias_initializer": null, "fcnet_bias_initializer_config": null, "conv_filters": null, "conv_activation": "relu", "conv_kernel_initializer": null, "conv_kernel_initializer_config": null, "conv_bias_initializer": null, "conv_bias_initializer_config": null, "conv_transpose_kernel_initializer": null, "conv_transpose_kernel_initializer_config": null, "conv_transpose_bias_initializer": null, "conv_transpose_bias_initializer_config": null, "post_fcnet_hiddens": [], "post_fcnet_activation": "relu", "post_fcnet_weights_initializer": null, "post_fcnet_weights_initializer_config": null, "post_fcnet_bias_initializer": null, "post_fcnet_bias_initializer_config": null, "free_log_std": false, "log_std_clip_param": 20.0, "no_final_linear": false, "vf_share_layers": false, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "lstm_weights_initializer": null, "lstm_weights_initializer_config": null, "lstm_bias_initializer": null, "lstm_bias_initializer_config": null, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "attention_use_n_prev_actions": 0, "attention_use_n_prev_rewards": 0, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": null, "custom_model_config": {}, "custom_action_dist": null, "custom_preprocessor": null, "encoder_latent_dim": null, "always_check_shapes": false, "lstm_use_prev_action_reward": -1, "_use_default_native_models": -1, "_disable_preprocessor_api": false, "_disable_action_flattening": false}, "_learner_connector": null, "add_default_connectors_to_learner_pipeline": true, "learner_config_dict": {}, "optimizer": {}, "_learner_class": null, "callbacks_on_algorithm_init": null, "callbacks_on_env_runners_recreated": null, "callbacks_on_offline_eval_runners_recreated": null, "callbacks_on_checkpoint_loaded": null, "callbacks_on_environment_created": null, "callbacks_on_episode_created": null, "callbacks_on_episode_start": null, "callbacks_on_episode_step": null, "callbacks_on_episode_end": null, "callbacks_on_evaluate_start": null, "callbacks_on_evaluate_end": null, "callbacks_on_evaluate_offline_start": null, "callbacks_on_evaluate_offline_end": null, "callbacks_on_sample_end": null, "callbacks_on_train_result": null, "explore": true, "enable_rl_module_and_learner": true, "enable_env_runner_and_connector_v2": true, "_prior_exploration_config": {"type": "StochasticSampling"}, "count_steps_by": "env_steps", "policy_map_capacity": 100, "policy_mapping_fn": "<function AlgorithmConfig.DEFAULT_POLICY_MAPPING_FN at 0x13ca69b20>", "policies_to_train": null, "policy_states_are_swappable": false, "observation_fn": null, "offline_data_class": null, "input_read_method": "read_parquet", "input_read_method_kwargs": {}, "input_read_schema": {}, "input_read_episodes": false, "input_read_sample_batches": false, "input_read_batch_size": null, "input_filesystem": null, "input_filesystem_kwargs": {}, "input_compress_columns": ["obs", "new_obs"], "input_spaces_jsonable": true, "materialize_data": false, "materialize_mapped_data": true, "map_batches_kwargs": {}, "iter_batches_kwargs": {}, "ignore_final_observation": false, "prelearner_class": null, "prelearner_buffer_class": null, "prelearner_buffer_kwargs": {}, "prelearner_module_synch_period": 10, "dataset_num_iters_per_learner": null, "input_config": {}, "actions_in_input_normalized": false, "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_config": {}, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "output_max_rows_per_file": null, "output_write_remaining_data": false, "output_write_method": "write_parquet", "output_write_method_kwargs": {}, "output_filesystem": null, "output_filesystem_kwargs": {}, "output_write_episodes": true, "offline_sampling": false, "evaluation_interval": 1, "evaluation_duration": 20, "evaluation_duration_unit": "episodes", "evaluation_sample_timeout_s": 120.0, "evaluation_auto_duration_min_env_steps_per_sample": 100, "evaluation_auto_duration_max_env_steps_per_sample": 2000, "evaluation_parallel_to_training": false, "evaluation_force_reset_envs_before_iteration": true, "evaluation_config": null, "off_policy_estimation_methods": {}, "ope_split_batch_by_episode": true, "evaluation_num_env_runners": 1, "in_evaluation": false, "sync_filters_on_rollout_workers_timeout_s": 10.0, "offline_evaluation_interval": null, "num_offline_eval_runners": 0, "offline_loss_for_module_fn": null, "offline_evaluation_duration": 1, "offline_evaluation_parallel_to_training": false, "offline_evaluation_timeout_s": 120.0, "num_cpus_per_offline_eval_runner": 1, "num_gpus_per_offline_eval_runner": 0, "custom_resources_per_offline_eval_runner": {}, "restart_failed_offline_eval_runners": true, "ignore_offline_eval_runner_failures": false, "max_num_offline_eval_runner_restarts": 1000, "offline_eval_runner_restore_timeout_s": 1800.0, "max_requests_in_flight_per_offline_eval_runner": 1, "validate_offline_eval_runners_after_construction": true, "offline_eval_runner_health_probe_timeout_s": 30.0, "offline_eval_rl_module_inference_only": false, "broadcast_offline_eval_runner_states": false, "offline_eval_batch_size_per_runner": 256, "dataset_num_iters_per_eval_runner": 1, "keep_per_episode_custom_metrics": false, "metrics_episode_collection_timeout_s": 60.0, "metrics_num_episodes_for_smoothing": 100, "min_time_s_per_iteration": null, "min_train_timesteps_per_iteration": 0, "min_sample_timesteps_per_iteration": 0, "log_gradients": true, "export_native_model_files": false, "checkpoint_trainable_policies_only": false, "logger_creator": null, "logger_config": null, "log_level": "WARN", "log_sys_usage": true, "fake_sampler": false, "seed": 7, "restart_failed_env_runners": true, "ignore_env_runner_failures": false, "max_num_env_runner_restarts": 1000, "delay_between_env_runner_restarts_s": 60.0, "restart_failed_sub_environments": false, "num_consecutive_env_runner_failures_tolerance": 100, "env_runner_health_probe_timeout_s": 30.0, "env_runner_restore_timeout_s": 1800.0, "_model_config": {}, "_rl_module_spec": "RLModuleSpec(module_class=None, observation_space=None, action_space=None, inference_only=False, learner_only=False, model_config=DefaultModelConfig(fcnet_hiddens=[60, 90], fcnet_activation='tanh', fcnet_kernel_initializer=None, fcnet_kernel_initializer_kwargs=None, fcnet_bias_initializer=None, fcnet_bias_initializer_kwargs=None, conv_filters=None, conv_activation='relu', conv_kernel_initializer=None, conv_kernel_initializer_kwargs=None, conv_bias_initializer=None, conv_bias_initializer_kwargs=None, head_fcnet_hiddens=[], head_fcnet_activation='relu', head_fcnet_kernel_initializer=None, head_fcnet_kernel_initializer_kwargs=None, head_fcnet_bias_initializer=None, head_fcnet_bias_initializer_kwargs=None, free_log_std=False, log_std_clip_param=20.0, vf_share_layers=True, use_lstm=False, max_seq_len=20, lstm_cell_size=256, lstm_use_prev_action=False, lstm_use_prev_reward=False, lstm_kernel_initializer=None, lstm_kernel_initializer_kwargs=None, lstm_bias_initializer=None, lstm_bias_initializer_kwargs=None), catalog_class=None, load_state_path=None, model_config_dict=None)", "algorithm_config_overrides_per_module": {}, "_per_module_overrides": {}, "_validate_config": true, "_use_msgpack_checkpoints": false, "_torch_grad_scaler_class": null, "_torch_lr_scheduler_classes": null, "_tf_policy_handles_more_than_one_loss": false, "_disable_preprocessor_api": false, "_disable_action_flattening": false, "_disable_initialize_loss_from_dummy_batch": false, "_dont_auto_sync_env_runner_states": false, "env_task_fn": -1, "enable_connectors": -1, "simple_optimizer": false, "policy_map_cache": -1, "worker_cls": -1, "synchronize_filters": -1, "enable_async_evaluation": -1, "custom_async_evaluation_function": -1, "_enable_rl_module_api": -1, "auto_wrap_old_gym_envs": -1, "always_attach_evaluation_results": -1, "replay_sequence_length": null, "_disable_execution_plan_api": -1, "use_critic": true, "use_gae": true, "use_kl_loss": true, "kl_coeff": 0.7464963036515, "kl_target": 0.0270990929592, "vf_loss_coeff": 0.6688075857018, "entropy_coeff": 0.0090570820258, "clip_param": 0.1221781641624, "vf_clip_param": 0.1027808522125, "entropy_coeff_schedule": null, "lr_schedule": null, "sgd_minibatch_size": -1, "vf_share_layers": -1, "__stdout_file__": null, "__stderr_file__": null, "lambda": 0.9099046732075, "input": "sampler", "policies": {"default_policy": [null, null, null, null]}, "callbacks": "<class 'ray.rllib.callbacks.callbacks.RLlibCallback'>", "create_env_on_driver": false, "custom_eval_function": null, "framework": "torch"}, "time_since_restore": 25.38246774673462, "iterations_since_restore": 15, "perf": {"cpu_util_percent": 32.9, "ram_util_percent": 76.66666666666667}}
{"timers": {"training_iteration": 1.5457210716364391, "restore_env_runners": 1.0895756866572604e-05, "training_step": 1.5455335986646057, "env_runner_sampling_timer": 1.435674363604735, "learner_update_timer": 0.10677143920061449, "synch_weights": 0.0004989001254236964, "restore_eval_env_runners": 1.0276591660730012e-05, "evaluation_iteration": 0.10569115806490728, "synch_eval_env_connectors": 0.0001224051537385452, "synch_env_connectors": 4.739082730835378e-06}, "env_runners": {"weights_seq_no": 15.0, "module_to_env_connector": {"timers": {"connectors": {"tensor_to_numpy": 1.2989625580125644e-05, "listify_data_for_vector_env": 1.0790785175044448e-05, "remove_single_ts_time_rank_from_batch": 5.741704052046933e-07, "get_actions": 3.670201265789903e-05, "normalize_and_clip_actions": 9.261874253598663e-06, "un_batch_to_individual_items": 5.3330890569980716e-06}}, "connector_pipeline_timer": 0.0001007241994696812}, "episode_len_mean": 20.0, "num_agent_steps_sampled_lifetime": {"default_agent": -8635000.0}, "num_agent_steps_sampled": {"default_agent": 5000.0}, "sample": 0.0047274805196331655, "env_to_module_connector": {"timers": {"connectors": {"batch_individual_items": 6.353464330983166e-06, "add_observations_from_episodes_to_batch": 2.952157711472535e-06, "add_states_from_episodes_to_batch": 1.7472324830830083e-06, "add_time_dim_to_batch_and_zero_pad": 2.3400373227979306e-06, "numpy_to_tensor": 8.377509773395484e-06}}, "connector_pipeline_timer": 4.29431080735199e-05}, "env_step_timer": 1.3615415220061634e-05, "num_episodes": 250.0, "episode_len_min": 20, "num_module_steps_sampled_lifetime": {"default_policy": -8635000.0}, "env_to_module_sum_episodes_length_in": 10.36823839457432, "agent_episode_returns_mean": {"default_agent": 7.2200000000000015}, "num_env_steps_sampled": 5000.0, "episode_return_mean": 7.2200000000000015, "num_module_steps_sampled": {"default_policy": 5000.0}, "episode_duration_sec_mean": 0.004458189652767033, "module_episode_returns_mean": {"default_policy": 7.2200000000000015}, "num_episodes_lifetime": -431750.0, "episode_return_max": 10.5, "episode_len_max": 20, "env_to_module_sum_episodes_length_out": 10.36823839457432, "episode_return_min": -9.5, "num_env_steps_sampled_lifetime": -8635000.0, "env_reset_timer": 3.209633814993828e-05, "time_between_sampling": 0.0018064214401904066, "rlmodule_inference_timer": 2.7199412277898386e-05, "num_env_steps_sampled_lifetime_throughput": 3858.1877256512016}, "learners": {"default_policy": {"diff_num_grad_updates_vs_sampler_policy": 1.0, "mean_kl_loss": 0.0002683716011233628, "num_module_steps_trained": 6000, "vf_explained_var": -0.009708046913146973, "entropy": 0.5402327179908752, "curr_entropy_coeff": 0.0090570820258, "num_trainable_parameters": 6003, "vf_loss_unclipped": 28.182588577270508, "gradients_default_optimizer_global_norm": 0.02891549840569496, "default_optimizer_learning_rate": 0.0002847858517, "module_train_batch_size_mean": 1000.0, "num_module_steps_trained_lifetime": 96000, "total_loss": 0.11603890359401703, "curr_kl_coeff": 1.1390629879315384e-05, "policy_loss": 0.05219123512506485, "vf_loss": 0.10278083384037018, "weights_seq_no": 16.0, "num_module_steps_trained_lifetime_throughput": 458072.9340715033}, "__all_modules__": {"learner_connector": {"connector_pipeline_timer": 0.08327308995333393, "timers": {"connectors": {"add_one_ts_to_episodes_and_truncate": 0.008240444283092774, "add_columns_from_episodes_to_train_batch": 0.03327444177133685, "general_advantage_estimation": 0.006811047421108359, "numpy_to_tensor": 7.003319181349644e-05, "batch_individual_items": 0.03393665288339801, "add_observations_from_episodes_to_batch": 0.0008133397865315998, "add_states_from_episodes_to_batch": 3.6943784128497348e-06, "add_time_dim_to_batch_and_zero_pad": 1.0527671516380077e-05}}}, "num_non_trainable_parameters": 0, "learner_connector_sum_episodes_length_in": 5000.0, "learner_connector_sum_episodes_length_out": 5250.0, "num_module_steps_trained": 6000, "num_trainable_parameters": 6003, "num_env_steps_trained_lifetime": 504000, "num_env_steps_trained": 31500, "num_module_steps_trained_lifetime": 96000, "num_env_steps_trained_lifetime_throughput": 2391977.335639024, "num_module_steps_trained_throughput": 457261.0216801135, "num_module_steps_trained_lifetime_throughput": 456618.09299826704}}, "num_training_step_calls_per_iteration": 1, "evaluation": {"env_runners": {"module_to_env_connector": {"timers": {"connectors": {"un_batch_to_individual_items": 5.364427236099537e-06, "listify_data_for_vector_env": 1.0957562770295045e-05, "remove_single_ts_time_rank_from_batch": 5.709207764348283e-07, "normalize_and_clip_actions": 9.475507203504751e-06, "tensor_to_numpy": 1.2750824166019737e-05, "get_actions": 3.498712289958876e-05}}, "connector_pipeline_timer": 9.960713817537363e-05}, "agent_episode_returns_mean": {"default_agent": -0.35}, "sample": 0.09832429526650564, "env_step_timer": 1.4030548130394358e-05, "num_episodes": 20, "module_episode_returns_mean": {"default_policy": -0.35}, "episode_return_max": 14.5, "episode_return_min": -12.5, "rlmodule_inference_timer": 2.694130544503892e-05, "env_to_module_connector": {"timers": {"connectors": {"numpy_to_tensor": 8.373424042205642e-06, "batch_individual_items": 6.0827970317424154e-06, "add_observations_from_episodes_to_batch": 2.8248677266431562e-06, "add_states_from_episodes_to_batch": 1.6291835043996876e-06, "add_time_dim_to_batch_and_zero_pad": 2.2684556585308976e-06}}, "connector_pipeline_timer": 4.263402626183391e-05}, "env_to_module_sum_episodes_length_in": 10.368238394574323, "episode_return_mean": -0.35, "episode_duration_sec_mean": 0.004418478726875037, "episode_len_max": 20, "env_to_module_sum_episodes_length_out": 10.368238394574323, "env_reset_timer": 0.00024205722548085605, "num_agent_steps_sampled_lifetime": {"default_agent": 6400}, "episode_len_mean": 20.0, "num_module_steps_sampled_lifetime": {"default_policy": 6400}, "episode_len_min": 20, "num_agent_steps_sampled": {"default_agent": 400}, "weights_seq_no": 16.0, "num_module_steps_sampled": {"default_policy": 400}, "num_env_steps_sampled": 400, "num_episodes_lifetime": 320, "num_env_steps_sampled_lifetime": 80400, "time_between_sampling": 1.633632840527029}, "num_healthy_workers": 1, "actor_manager_num_outstanding_async_reqs": 0, "num_remote_worker_restarts": 0}, "num_env_steps_sampled_lifetime": -8635000.0, "fault_tolerance": {"num_healthy_workers": 0, "num_remote_worker_restarts": 0}, "env_runner_group": {"actor_manager_num_outstanding_async_reqs": 0}, "done": false, "training_iteration": 16, "trial_id": "499df_00000", "date": "2025-08-11_19-37-24", "timestamp": 1754933844, "time_this_iter_s": 1.5513231754302979, "time_total_s": 26.933790922164917, "pid": 28380, "hostname": "Mac", "node_ip": "127.0.0.1", "config": {"exploration_config": {}, "extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "placement_strategy": "PACK", "num_gpus": 0, "_fake_gpus": false, "num_cpus_for_main_process": 2, "eager_tracing": true, "eager_max_retraces": 20, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "torch_compile_learner": false, "torch_compile_learner_what_to_compile": "forward_train", "torch_compile_learner_dynamo_backend": "aot_eager", "torch_compile_learner_dynamo_mode": null, "torch_compile_worker": false, "torch_compile_worker_dynamo_backend": "aot_eager", "torch_compile_worker_dynamo_mode": null, "torch_ddp_kwargs": {}, "torch_skip_nan_gradients": false, "env": "Umbrella", "env_config": {}, "observation_space": null, "action_space": null, "clip_rewards": null, "normalize_actions": true, "clip_actions": false, "_is_atari": null, "disable_env_checking": false, "render_env": false, "action_mask_key": "action_mask", "env_runner_cls": null, "num_env_runners": 0, "create_local_env_runner": true, "num_envs_per_env_runner": 1, "gym_env_vectorize_mode": "SYNC", "num_cpus_per_env_runner": 1, "num_gpus_per_env_runner": 0, "custom_resources_per_env_runner": {}, "validate_env_runners_after_construction": true, "episodes_to_numpy": true, "max_requests_in_flight_per_env_runner": 1, "sample_timeout_s": 60.0, "_env_to_module_connector": null, "add_default_connectors_to_env_to_module_pipeline": true, "_module_to_env_connector": null, "add_default_connectors_to_module_to_env_pipeline": true, "merge_env_runner_states": "training_only", "broadcast_env_runner_states": true, "episode_lookback_horizon": 1, "rollout_fragment_length": "auto", "batch_mode": "complete_episodes", "compress_observations": false, "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "enable_tf1_exec_eagerly": false, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "preprocessor_pref": "deepmind", "observation_filter": "NoFilter", "update_worker_filter_stats": true, "use_worker_filter_stats": true, "sampler_perf_stats_ema_coef": null, "_is_online": true, "num_learners": 0, "num_gpus_per_learner": 0, "num_cpus_per_learner": "auto", "num_aggregator_actors_per_learner": 0, "max_requests_in_flight_per_aggregator_actor": 3, "local_gpu_idx": 0, "max_requests_in_flight_per_learner": 3, "gamma": 1, "lr": 0.0002847858517, "grad_clip": 0.5, "grad_clip_by": "global_norm", "_train_batch_size_per_learner": 5000, "train_batch_size": 4000, "num_epochs": 1, "minibatch_size": 1000, "shuffle_batch_per_epoch": true, "model": {"fcnet_hiddens": [256, 256], "fcnet_activation": "tanh", "fcnet_weights_initializer": null, "fcnet_weights_initializer_config": null, "fcnet_bias_initializer": null, "fcnet_bias_initializer_config": null, "conv_filters": null, "conv_activation": "relu", "conv_kernel_initializer": null, "conv_kernel_initializer_config": null, "conv_bias_initializer": null, "conv_bias_initializer_config": null, "conv_transpose_kernel_initializer": null, "conv_transpose_kernel_initializer_config": null, "conv_transpose_bias_initializer": null, "conv_transpose_bias_initializer_config": null, "post_fcnet_hiddens": [], "post_fcnet_activation": "relu", "post_fcnet_weights_initializer": null, "post_fcnet_weights_initializer_config": null, "post_fcnet_bias_initializer": null, "post_fcnet_bias_initializer_config": null, "free_log_std": false, "log_std_clip_param": 20.0, "no_final_linear": false, "vf_share_layers": false, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "lstm_weights_initializer": null, "lstm_weights_initializer_config": null, "lstm_bias_initializer": null, "lstm_bias_initializer_config": null, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "attention_use_n_prev_actions": 0, "attention_use_n_prev_rewards": 0, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": null, "custom_model_config": {}, "custom_action_dist": null, "custom_preprocessor": null, "encoder_latent_dim": null, "always_check_shapes": false, "lstm_use_prev_action_reward": -1, "_use_default_native_models": -1, "_disable_preprocessor_api": false, "_disable_action_flattening": false}, "_learner_connector": null, "add_default_connectors_to_learner_pipeline": true, "learner_config_dict": {}, "optimizer": {}, "_learner_class": null, "callbacks_on_algorithm_init": null, "callbacks_on_env_runners_recreated": null, "callbacks_on_offline_eval_runners_recreated": null, "callbacks_on_checkpoint_loaded": null, "callbacks_on_environment_created": null, "callbacks_on_episode_created": null, "callbacks_on_episode_start": null, "callbacks_on_episode_step": null, "callbacks_on_episode_end": null, "callbacks_on_evaluate_start": null, "callbacks_on_evaluate_end": null, "callbacks_on_evaluate_offline_start": null, "callbacks_on_evaluate_offline_end": null, "callbacks_on_sample_end": null, "callbacks_on_train_result": null, "explore": true, "enable_rl_module_and_learner": true, "enable_env_runner_and_connector_v2": true, "_prior_exploration_config": {"type": "StochasticSampling"}, "count_steps_by": "env_steps", "policy_map_capacity": 100, "policy_mapping_fn": "<function AlgorithmConfig.DEFAULT_POLICY_MAPPING_FN at 0x13ca69b20>", "policies_to_train": null, "policy_states_are_swappable": false, "observation_fn": null, "offline_data_class": null, "input_read_method": "read_parquet", "input_read_method_kwargs": {}, "input_read_schema": {}, "input_read_episodes": false, "input_read_sample_batches": false, "input_read_batch_size": null, "input_filesystem": null, "input_filesystem_kwargs": {}, "input_compress_columns": ["obs", "new_obs"], "input_spaces_jsonable": true, "materialize_data": false, "materialize_mapped_data": true, "map_batches_kwargs": {}, "iter_batches_kwargs": {}, "ignore_final_observation": false, "prelearner_class": null, "prelearner_buffer_class": null, "prelearner_buffer_kwargs": {}, "prelearner_module_synch_period": 10, "dataset_num_iters_per_learner": null, "input_config": {}, "actions_in_input_normalized": false, "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_config": {}, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "output_max_rows_per_file": null, "output_write_remaining_data": false, "output_write_method": "write_parquet", "output_write_method_kwargs": {}, "output_filesystem": null, "output_filesystem_kwargs": {}, "output_write_episodes": true, "offline_sampling": false, "evaluation_interval": 1, "evaluation_duration": 20, "evaluation_duration_unit": "episodes", "evaluation_sample_timeout_s": 120.0, "evaluation_auto_duration_min_env_steps_per_sample": 100, "evaluation_auto_duration_max_env_steps_per_sample": 2000, "evaluation_parallel_to_training": false, "evaluation_force_reset_envs_before_iteration": true, "evaluation_config": null, "off_policy_estimation_methods": {}, "ope_split_batch_by_episode": true, "evaluation_num_env_runners": 1, "in_evaluation": false, "sync_filters_on_rollout_workers_timeout_s": 10.0, "offline_evaluation_interval": null, "num_offline_eval_runners": 0, "offline_loss_for_module_fn": null, "offline_evaluation_duration": 1, "offline_evaluation_parallel_to_training": false, "offline_evaluation_timeout_s": 120.0, "num_cpus_per_offline_eval_runner": 1, "num_gpus_per_offline_eval_runner": 0, "custom_resources_per_offline_eval_runner": {}, "restart_failed_offline_eval_runners": true, "ignore_offline_eval_runner_failures": false, "max_num_offline_eval_runner_restarts": 1000, "offline_eval_runner_restore_timeout_s": 1800.0, "max_requests_in_flight_per_offline_eval_runner": 1, "validate_offline_eval_runners_after_construction": true, "offline_eval_runner_health_probe_timeout_s": 30.0, "offline_eval_rl_module_inference_only": false, "broadcast_offline_eval_runner_states": false, "offline_eval_batch_size_per_runner": 256, "dataset_num_iters_per_eval_runner": 1, "keep_per_episode_custom_metrics": false, "metrics_episode_collection_timeout_s": 60.0, "metrics_num_episodes_for_smoothing": 100, "min_time_s_per_iteration": null, "min_train_timesteps_per_iteration": 0, "min_sample_timesteps_per_iteration": 0, "log_gradients": true, "export_native_model_files": false, "checkpoint_trainable_policies_only": false, "logger_creator": null, "logger_config": null, "log_level": "WARN", "log_sys_usage": true, "fake_sampler": false, "seed": 7, "restart_failed_env_runners": true, "ignore_env_runner_failures": false, "max_num_env_runner_restarts": 1000, "delay_between_env_runner_restarts_s": 60.0, "restart_failed_sub_environments": false, "num_consecutive_env_runner_failures_tolerance": 100, "env_runner_health_probe_timeout_s": 30.0, "env_runner_restore_timeout_s": 1800.0, "_model_config": {}, "_rl_module_spec": "RLModuleSpec(module_class=None, observation_space=None, action_space=None, inference_only=False, learner_only=False, model_config=DefaultModelConfig(fcnet_hiddens=[60, 90], fcnet_activation='tanh', fcnet_kernel_initializer=None, fcnet_kernel_initializer_kwargs=None, fcnet_bias_initializer=None, fcnet_bias_initializer_kwargs=None, conv_filters=None, conv_activation='relu', conv_kernel_initializer=None, conv_kernel_initializer_kwargs=None, conv_bias_initializer=None, conv_bias_initializer_kwargs=None, head_fcnet_hiddens=[], head_fcnet_activation='relu', head_fcnet_kernel_initializer=None, head_fcnet_kernel_initializer_kwargs=None, head_fcnet_bias_initializer=None, head_fcnet_bias_initializer_kwargs=None, free_log_std=False, log_std_clip_param=20.0, vf_share_layers=True, use_lstm=False, max_seq_len=20, lstm_cell_size=256, lstm_use_prev_action=False, lstm_use_prev_reward=False, lstm_kernel_initializer=None, lstm_kernel_initializer_kwargs=None, lstm_bias_initializer=None, lstm_bias_initializer_kwargs=None), catalog_class=None, load_state_path=None, model_config_dict=None)", "algorithm_config_overrides_per_module": {}, "_per_module_overrides": {}, "_validate_config": true, "_use_msgpack_checkpoints": false, "_torch_grad_scaler_class": null, "_torch_lr_scheduler_classes": null, "_tf_policy_handles_more_than_one_loss": false, "_disable_preprocessor_api": false, "_disable_action_flattening": false, "_disable_initialize_loss_from_dummy_batch": false, "_dont_auto_sync_env_runner_states": false, "env_task_fn": -1, "enable_connectors": -1, "simple_optimizer": false, "policy_map_cache": -1, "worker_cls": -1, "synchronize_filters": -1, "enable_async_evaluation": -1, "custom_async_evaluation_function": -1, "_enable_rl_module_api": -1, "auto_wrap_old_gym_envs": -1, "always_attach_evaluation_results": -1, "replay_sequence_length": null, "_disable_execution_plan_api": -1, "use_critic": true, "use_gae": true, "use_kl_loss": true, "kl_coeff": 0.7464963036515, "kl_target": 0.0270990929592, "vf_loss_coeff": 0.6688075857018, "entropy_coeff": 0.0090570820258, "clip_param": 0.1221781641624, "vf_clip_param": 0.1027808522125, "entropy_coeff_schedule": null, "lr_schedule": null, "sgd_minibatch_size": -1, "vf_share_layers": -1, "__stdout_file__": null, "__stderr_file__": null, "lambda": 0.9099046732075, "input": "sampler", "policies": {"default_policy": [null, null, null, null]}, "callbacks": "<class 'ray.rllib.callbacks.callbacks.RLlibCallback'>", "create_env_on_driver": false, "custom_eval_function": null, "framework": "torch"}, "time_since_restore": 26.933790922164917, "iterations_since_restore": 16, "perf": {"cpu_util_percent": 34.95, "ram_util_percent": 76.55}}
{"timers": {"training_iteration": 1.5506448625895226, "restore_env_runners": 1.0843048853107216e-05, "training_step": 1.5504567047574869, "env_runner_sampling_timer": 1.440679045808285, "learner_update_timer": 0.1066734910589542, "synch_weights": 0.0005091269641272778, "restore_eval_env_runners": 1.0242996235892622e-05, "evaluation_iteration": 0.10566265440347883, "synch_eval_env_connectors": 0.00012221069211308254, "synch_env_connectors": 4.734191645066383e-06}, "env_runners": {"weights_seq_no": 16.0, "module_to_env_connector": {"timers": {"connectors": {"tensor_to_numpy": 1.5797633297839278e-05, "listify_data_for_vector_env": 1.3666413468008964e-05, "remove_single_ts_time_rank_from_batch": 6.712865260961807e-07, "get_actions": 8.412744874607584e-05, "normalize_and_clip_actions": 1.121945456349866e-05, "un_batch_to_individual_items": 6.208886054769351e-06}}, "connector_pipeline_timer": 0.0001616219172850079}, "episode_len_mean": 20.0, "num_agent_steps_sampled_lifetime": {"default_agent": -9252500.0}, "num_agent_steps_sampled": {"default_agent": 5000.0}, "sample": 0.005993433266371113, "env_to_module_connector": {"timers": {"connectors": {"batch_individual_items": 7.898689757387747e-06, "add_observations_from_episodes_to_batch": 3.482130405201086e-06, "add_states_from_episodes_to_batch": 1.9946956237617723e-06, "add_time_dim_to_batch_and_zero_pad": 3.083988347039039e-06, "numpy_to_tensor": 1.0307904005113539e-05}}, "connector_pipeline_timer": 5.070121559443095e-05}, "env_step_timer": 1.770762279201382e-05, "num_episodes": 250.0, "episode_len_min": 20, "num_module_steps_sampled_lifetime": {"default_policy": -9252500.0}, "env_to_module_sum_episodes_length_in": 10.36823839457432, "agent_episode_returns_mean": {"default_agent": 7.299999999999996}, "num_env_steps_sampled": 5000.0, "episode_return_mean": 7.299999999999996, "num_module_steps_sampled": {"default_policy": 5000.0}, "episode_duration_sec_mean": 0.006575170793570578, "module_episode_returns_mean": {"default_policy": 7.299999999999996}, "num_episodes_lifetime": -462625.0, "episode_return_max": 10.5, "episode_len_max": 20, "env_to_module_sum_episodes_length_out": 10.36823839457432, "episode_return_min": -9.5, "num_env_steps_sampled_lifetime": -9252500.0, "env_reset_timer": 4.375757984901504e-05, "time_between_sampling": 0.001600485498708945, "rlmodule_inference_timer": 5.0380619787647585e-05, "num_env_steps_sampled_lifetime_throughput": 3363.5605171172456}, "learners": {"default_policy": {"diff_num_grad_updates_vs_sampler_policy": 1.0, "mean_kl_loss": 1.595735375303775e-05, "num_module_steps_trained": 6000, "vf_explained_var": -0.00909113883972168, "entropy": 0.5353696346282959, "curr_entropy_coeff": 0.0090570820258, "num_trainable_parameters": 6003, "vf_loss_unclipped": 28.024700164794922, "gradients_default_optimizer_global_norm": 0.05952993407845497, "default_optimizer_learning_rate": 0.0002847858517, "module_train_batch_size_mean": 1000.0, "num_module_steps_trained_lifetime": 102000, "total_loss": 0.005944760516285896, "curr_kl_coeff": 5.695314939657692e-06, "policy_loss": -0.057946957647800446, "vf_loss": 0.10278083384037018, "weights_seq_no": 17.0, "num_module_steps_trained_lifetime_throughput": 457578.8273902009}, "__all_modules__": {"learner_connector": {"connector_pipeline_timer": 0.08324342905347493, "timers": {"connectors": {"add_one_ts_to_episodes_and_truncate": 0.008238055260942713, "add_columns_from_episodes_to_train_batch": 0.033294971933016226, "general_advantage_estimation": 0.006802925697042115, "numpy_to_tensor": 6.999452966002922e-05, "batch_individual_items": 0.03389367302465243, "add_observations_from_episodes_to_batch": 0.0008164338885927466, "add_states_from_episodes_to_batch": 3.68952567633605e-06, "add_time_dim_to_batch_and_zero_pad": 1.0886144548939618e-05}}}, "num_non_trainable_parameters": 0, "learner_connector_sum_episodes_length_in": 5000.0, "learner_connector_sum_episodes_length_out": 5250.0, "num_module_steps_trained": 6000, "num_trainable_parameters": 6003, "num_env_steps_trained_lifetime": 535500, "num_env_steps_trained": 31500, "num_module_steps_trained_lifetime": 102000, "num_env_steps_trained_lifetime_throughput": 2390101.695105053, "num_module_steps_trained_throughput": 456840.85521679325, "num_module_steps_trained_lifetime_throughput": 456218.2668852206}}, "num_training_step_calls_per_iteration": 1, "evaluation": {"env_runners": {"module_to_env_connector": {"timers": {"connectors": {"un_batch_to_individual_items": 5.28381477047995e-06, "listify_data_for_vector_env": 1.083329118902691e-05, "remove_single_ts_time_rank_from_batch": 5.494711595842272e-07, "normalize_and_clip_actions": 9.241380689705052e-06, "tensor_to_numpy": 1.2646141254686642e-05, "get_actions": 3.493173366892163e-05}}, "connector_pipeline_timer": 9.851613365004278e-05}, "agent_episode_returns_mean": {"default_agent": 0.25}, "sample": 0.09838942440370341, "env_step_timer": 1.3876570345171288e-05, "num_episodes": 20, "module_episode_returns_mean": {"default_policy": 0.25}, "episode_return_max": 14.5, "episode_return_min": -12.5, "rlmodule_inference_timer": 2.691146355276318e-05, "env_to_module_connector": {"timers": {"connectors": {"numpy_to_tensor": 8.194035682524575e-06, "batch_individual_items": 5.997041661929588e-06, "add_observations_from_episodes_to_batch": 2.7584015110443496e-06, "add_states_from_episodes_to_batch": 1.5452933667265725e-06, "add_time_dim_to_batch_and_zero_pad": 2.220158781302691e-06}}, "connector_pipeline_timer": 4.1810696833249314e-05}, "env_to_module_sum_episodes_length_in": 10.368238394574323, "episode_return_mean": 0.25, "episode_duration_sec_mean": 0.004496290783863515, "episode_len_max": 20, "env_to_module_sum_episodes_length_out": 10.368238394574323, "env_reset_timer": 0.0002479745630474684, "num_agent_steps_sampled_lifetime": {"default_agent": 6800}, "episode_len_mean": 20.0, "num_module_steps_sampled_lifetime": {"default_policy": 6800}, "episode_len_min": 20, "num_agent_steps_sampled": {"default_agent": 400}, "weights_seq_no": 17.0, "num_module_steps_sampled": {"default_policy": 400}, "num_env_steps_sampled": 400, "num_episodes_lifetime": 340, "num_env_steps_sampled_lifetime": 85400, "time_between_sampling": 1.6379200442025488}, "num_healthy_workers": 1, "actor_manager_num_outstanding_async_reqs": 0, "num_remote_worker_restarts": 0}, "num_env_steps_sampled_lifetime": -9252500.0, "fault_tolerance": {"num_healthy_workers": 0, "num_remote_worker_restarts": 0}, "env_runner_group": {"actor_manager_num_outstanding_async_reqs": 0}, "done": false, "training_iteration": 17, "trial_id": "499df_00000", "date": "2025-08-11_19-37-26", "timestamp": 1754933846, "time_this_iter_s": 2.155817985534668, "time_total_s": 29.089608907699585, "pid": 28380, "hostname": "Mac", "node_ip": "127.0.0.1", "config": {"exploration_config": {}, "extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "placement_strategy": "PACK", "num_gpus": 0, "_fake_gpus": false, "num_cpus_for_main_process": 2, "eager_tracing": true, "eager_max_retraces": 20, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "torch_compile_learner": false, "torch_compile_learner_what_to_compile": "forward_train", "torch_compile_learner_dynamo_backend": "aot_eager", "torch_compile_learner_dynamo_mode": null, "torch_compile_worker": false, "torch_compile_worker_dynamo_backend": "aot_eager", "torch_compile_worker_dynamo_mode": null, "torch_ddp_kwargs": {}, "torch_skip_nan_gradients": false, "env": "Umbrella", "env_config": {}, "observation_space": null, "action_space": null, "clip_rewards": null, "normalize_actions": true, "clip_actions": false, "_is_atari": null, "disable_env_checking": false, "render_env": false, "action_mask_key": "action_mask", "env_runner_cls": null, "num_env_runners": 0, "create_local_env_runner": true, "num_envs_per_env_runner": 1, "gym_env_vectorize_mode": "SYNC", "num_cpus_per_env_runner": 1, "num_gpus_per_env_runner": 0, "custom_resources_per_env_runner": {}, "validate_env_runners_after_construction": true, "episodes_to_numpy": true, "max_requests_in_flight_per_env_runner": 1, "sample_timeout_s": 60.0, "_env_to_module_connector": null, "add_default_connectors_to_env_to_module_pipeline": true, "_module_to_env_connector": null, "add_default_connectors_to_module_to_env_pipeline": true, "merge_env_runner_states": "training_only", "broadcast_env_runner_states": true, "episode_lookback_horizon": 1, "rollout_fragment_length": "auto", "batch_mode": "complete_episodes", "compress_observations": false, "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "enable_tf1_exec_eagerly": false, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "preprocessor_pref": "deepmind", "observation_filter": "NoFilter", "update_worker_filter_stats": true, "use_worker_filter_stats": true, "sampler_perf_stats_ema_coef": null, "_is_online": true, "num_learners": 0, "num_gpus_per_learner": 0, "num_cpus_per_learner": "auto", "num_aggregator_actors_per_learner": 0, "max_requests_in_flight_per_aggregator_actor": 3, "local_gpu_idx": 0, "max_requests_in_flight_per_learner": 3, "gamma": 1, "lr": 0.0002847858517, "grad_clip": 0.5, "grad_clip_by": "global_norm", "_train_batch_size_per_learner": 5000, "train_batch_size": 4000, "num_epochs": 1, "minibatch_size": 1000, "shuffle_batch_per_epoch": true, "model": {"fcnet_hiddens": [256, 256], "fcnet_activation": "tanh", "fcnet_weights_initializer": null, "fcnet_weights_initializer_config": null, "fcnet_bias_initializer": null, "fcnet_bias_initializer_config": null, "conv_filters": null, "conv_activation": "relu", "conv_kernel_initializer": null, "conv_kernel_initializer_config": null, "conv_bias_initializer": null, "conv_bias_initializer_config": null, "conv_transpose_kernel_initializer": null, "conv_transpose_kernel_initializer_config": null, "conv_transpose_bias_initializer": null, "conv_transpose_bias_initializer_config": null, "post_fcnet_hiddens": [], "post_fcnet_activation": "relu", "post_fcnet_weights_initializer": null, "post_fcnet_weights_initializer_config": null, "post_fcnet_bias_initializer": null, "post_fcnet_bias_initializer_config": null, "free_log_std": false, "log_std_clip_param": 20.0, "no_final_linear": false, "vf_share_layers": false, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "lstm_weights_initializer": null, "lstm_weights_initializer_config": null, "lstm_bias_initializer": null, "lstm_bias_initializer_config": null, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "attention_use_n_prev_actions": 0, "attention_use_n_prev_rewards": 0, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": null, "custom_model_config": {}, "custom_action_dist": null, "custom_preprocessor": null, "encoder_latent_dim": null, "always_check_shapes": false, "lstm_use_prev_action_reward": -1, "_use_default_native_models": -1, "_disable_preprocessor_api": false, "_disable_action_flattening": false}, "_learner_connector": null, "add_default_connectors_to_learner_pipeline": true, "learner_config_dict": {}, "optimizer": {}, "_learner_class": null, "callbacks_on_algorithm_init": null, "callbacks_on_env_runners_recreated": null, "callbacks_on_offline_eval_runners_recreated": null, "callbacks_on_checkpoint_loaded": null, "callbacks_on_environment_created": null, "callbacks_on_episode_created": null, "callbacks_on_episode_start": null, "callbacks_on_episode_step": null, "callbacks_on_episode_end": null, "callbacks_on_evaluate_start": null, "callbacks_on_evaluate_end": null, "callbacks_on_evaluate_offline_start": null, "callbacks_on_evaluate_offline_end": null, "callbacks_on_sample_end": null, "callbacks_on_train_result": null, "explore": true, "enable_rl_module_and_learner": true, "enable_env_runner_and_connector_v2": true, "_prior_exploration_config": {"type": "StochasticSampling"}, "count_steps_by": "env_steps", "policy_map_capacity": 100, "policy_mapping_fn": "<function AlgorithmConfig.DEFAULT_POLICY_MAPPING_FN at 0x13ca69b20>", "policies_to_train": null, "policy_states_are_swappable": false, "observation_fn": null, "offline_data_class": null, "input_read_method": "read_parquet", "input_read_method_kwargs": {}, "input_read_schema": {}, "input_read_episodes": false, "input_read_sample_batches": false, "input_read_batch_size": null, "input_filesystem": null, "input_filesystem_kwargs": {}, "input_compress_columns": ["obs", "new_obs"], "input_spaces_jsonable": true, "materialize_data": false, "materialize_mapped_data": true, "map_batches_kwargs": {}, "iter_batches_kwargs": {}, "ignore_final_observation": false, "prelearner_class": null, "prelearner_buffer_class": null, "prelearner_buffer_kwargs": {}, "prelearner_module_synch_period": 10, "dataset_num_iters_per_learner": null, "input_config": {}, "actions_in_input_normalized": false, "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_config": {}, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "output_max_rows_per_file": null, "output_write_remaining_data": false, "output_write_method": "write_parquet", "output_write_method_kwargs": {}, "output_filesystem": null, "output_filesystem_kwargs": {}, "output_write_episodes": true, "offline_sampling": false, "evaluation_interval": 1, "evaluation_duration": 20, "evaluation_duration_unit": "episodes", "evaluation_sample_timeout_s": 120.0, "evaluation_auto_duration_min_env_steps_per_sample": 100, "evaluation_auto_duration_max_env_steps_per_sample": 2000, "evaluation_parallel_to_training": false, "evaluation_force_reset_envs_before_iteration": true, "evaluation_config": null, "off_policy_estimation_methods": {}, "ope_split_batch_by_episode": true, "evaluation_num_env_runners": 1, "in_evaluation": false, "sync_filters_on_rollout_workers_timeout_s": 10.0, "offline_evaluation_interval": null, "num_offline_eval_runners": 0, "offline_loss_for_module_fn": null, "offline_evaluation_duration": 1, "offline_evaluation_parallel_to_training": false, "offline_evaluation_timeout_s": 120.0, "num_cpus_per_offline_eval_runner": 1, "num_gpus_per_offline_eval_runner": 0, "custom_resources_per_offline_eval_runner": {}, "restart_failed_offline_eval_runners": true, "ignore_offline_eval_runner_failures": false, "max_num_offline_eval_runner_restarts": 1000, "offline_eval_runner_restore_timeout_s": 1800.0, "max_requests_in_flight_per_offline_eval_runner": 1, "validate_offline_eval_runners_after_construction": true, "offline_eval_runner_health_probe_timeout_s": 30.0, "offline_eval_rl_module_inference_only": false, "broadcast_offline_eval_runner_states": false, "offline_eval_batch_size_per_runner": 256, "dataset_num_iters_per_eval_runner": 1, "keep_per_episode_custom_metrics": false, "metrics_episode_collection_timeout_s": 60.0, "metrics_num_episodes_for_smoothing": 100, "min_time_s_per_iteration": null, "min_train_timesteps_per_iteration": 0, "min_sample_timesteps_per_iteration": 0, "log_gradients": true, "export_native_model_files": false, "checkpoint_trainable_policies_only": false, "logger_creator": null, "logger_config": null, "log_level": "WARN", "log_sys_usage": true, "fake_sampler": false, "seed": 7, "restart_failed_env_runners": true, "ignore_env_runner_failures": false, "max_num_env_runner_restarts": 1000, "delay_between_env_runner_restarts_s": 60.0, "restart_failed_sub_environments": false, "num_consecutive_env_runner_failures_tolerance": 100, "env_runner_health_probe_timeout_s": 30.0, "env_runner_restore_timeout_s": 1800.0, "_model_config": {}, "_rl_module_spec": "RLModuleSpec(module_class=None, observation_space=None, action_space=None, inference_only=False, learner_only=False, model_config=DefaultModelConfig(fcnet_hiddens=[60, 90], fcnet_activation='tanh', fcnet_kernel_initializer=None, fcnet_kernel_initializer_kwargs=None, fcnet_bias_initializer=None, fcnet_bias_initializer_kwargs=None, conv_filters=None, conv_activation='relu', conv_kernel_initializer=None, conv_kernel_initializer_kwargs=None, conv_bias_initializer=None, conv_bias_initializer_kwargs=None, head_fcnet_hiddens=[], head_fcnet_activation='relu', head_fcnet_kernel_initializer=None, head_fcnet_kernel_initializer_kwargs=None, head_fcnet_bias_initializer=None, head_fcnet_bias_initializer_kwargs=None, free_log_std=False, log_std_clip_param=20.0, vf_share_layers=True, use_lstm=False, max_seq_len=20, lstm_cell_size=256, lstm_use_prev_action=False, lstm_use_prev_reward=False, lstm_kernel_initializer=None, lstm_kernel_initializer_kwargs=None, lstm_bias_initializer=None, lstm_bias_initializer_kwargs=None), catalog_class=None, load_state_path=None, model_config_dict=None)", "algorithm_config_overrides_per_module": {}, "_per_module_overrides": {}, "_validate_config": true, "_use_msgpack_checkpoints": false, "_torch_grad_scaler_class": null, "_torch_lr_scheduler_classes": null, "_tf_policy_handles_more_than_one_loss": false, "_disable_preprocessor_api": false, "_disable_action_flattening": false, "_disable_initialize_loss_from_dummy_batch": false, "_dont_auto_sync_env_runner_states": false, "env_task_fn": -1, "enable_connectors": -1, "simple_optimizer": false, "policy_map_cache": -1, "worker_cls": -1, "synchronize_filters": -1, "enable_async_evaluation": -1, "custom_async_evaluation_function": -1, "_enable_rl_module_api": -1, "auto_wrap_old_gym_envs": -1, "always_attach_evaluation_results": -1, "replay_sequence_length": null, "_disable_execution_plan_api": -1, "use_critic": true, "use_gae": true, "use_kl_loss": true, "kl_coeff": 0.7464963036515, "kl_target": 0.0270990929592, "vf_loss_coeff": 0.6688075857018, "entropy_coeff": 0.0090570820258, "clip_param": 0.1221781641624, "vf_clip_param": 0.1027808522125, "entropy_coeff_schedule": null, "lr_schedule": null, "sgd_minibatch_size": -1, "vf_share_layers": -1, "__stdout_file__": null, "__stderr_file__": null, "lambda": 0.9099046732075, "input": "sampler", "policies": {"default_policy": [null, null, null, null]}, "callbacks": "<class 'ray.rllib.callbacks.callbacks.RLlibCallback'>", "create_env_on_driver": false, "custom_eval_function": null, "framework": "torch"}, "time_since_restore": 29.089608907699585, "iterations_since_restore": 17, "perf": {"cpu_util_percent": 56.53333333333333, "ram_util_percent": 79.13333333333334}}
{"timers": {"training_iteration": 1.5513269185442684, "restore_env_runners": 1.079795877702896e-05, "training_step": 1.5511387818805782, "env_runner_sampling_timer": 1.44010335243104, "learner_update_timer": 0.10793192739805046, "synch_weights": 0.0005096861146935353, "restore_eval_env_runners": 1.1482646341376895e-05, "evaluation_iteration": 0.10575395869924152, "synch_eval_env_connectors": 0.0001221440049327776, "synch_env_connectors": 4.732259853200751e-06}, "env_runners": {"weights_seq_no": 17.0, "module_to_env_connector": {"timers": {"connectors": {"tensor_to_numpy": 1.3442266845891022e-05, "listify_data_for_vector_env": 1.1032874249606489e-05, "remove_single_ts_time_rank_from_batch": 5.920021721796174e-07, "get_actions": 3.846789192197422e-05, "normalize_and_clip_actions": 9.537905113555301e-06, "un_batch_to_individual_items": 5.570674771451618e-06}}, "connector_pipeline_timer": 0.00010411760085958105}, "episode_len_mean": 20.0, "num_agent_steps_sampled_lifetime": {"default_agent": -9870000.0}, "num_agent_steps_sampled": {"default_agent": 5000.0}, "sample": 0.005799518799420687, "env_to_module_connector": {"timers": {"connectors": {"batch_individual_items": 6.477846807466317e-06, "add_observations_from_episodes_to_batch": 2.992436288704642e-06, "add_states_from_episodes_to_batch": 1.7373412471430906e-06, "add_time_dim_to_batch_and_zero_pad": 2.33475155440292e-06, "numpy_to_tensor": 8.650520464623583e-06}}, "connector_pipeline_timer": 4.36346051233722e-05}, "env_step_timer": 1.4004610694087198e-05, "num_episodes": 250.0, "episode_len_min": 20, "num_module_steps_sampled_lifetime": {"default_policy": -9870000.0}, "env_to_module_sum_episodes_length_in": 10.36823839457432, "agent_episode_returns_mean": {"default_agent": 6.980000000000003}, "num_env_steps_sampled": 5000.0, "episode_return_mean": 6.980000000000003, "num_module_steps_sampled": {"default_policy": 5000.0}, "episode_duration_sec_mean": 0.004570741439703853, "module_episode_returns_mean": {"default_policy": 6.980000000000003}, "num_episodes_lifetime": -493500.0, "episode_return_max": 10.5, "episode_len_max": 20, "env_to_module_sum_episodes_length_out": 10.36823839457432, "episode_return_min": -9.5, "num_env_steps_sampled_lifetime": -9870000.0, "env_reset_timer": 4.170991324202135e-05, "time_between_sampling": 0.0016409455282279726, "rlmodule_inference_timer": 2.8011214278144212e-05, "num_env_steps_sampled_lifetime_throughput": 3743.405737938746}, "learners": {"default_policy": {"diff_num_grad_updates_vs_sampler_policy": 1.0, "mean_kl_loss": 2.4402635972364806e-05, "num_module_steps_trained": 6000, "vf_explained_var": -0.009521961212158203, "entropy": 0.5365307331085205, "curr_entropy_coeff": 0.0090570820258, "num_trainable_parameters": 6003, "vf_loss_unclipped": 28.1092586517334, "gradients_default_optimizer_global_norm": 0.08836914598941803, "default_optimizer_learning_rate": 0.0002847858517, "module_train_batch_size_mean": 1000.0, "num_module_steps_trained_lifetime": 108000, "total_loss": 0.06610782444477081, "curr_kl_coeff": 2.847657469828846e-06, "policy_loss": 0.00222662091255188, "vf_loss": 0.10278083384037018, "weights_seq_no": 18.0, "num_module_steps_trained_lifetime_throughput": 457615.65388872987}, "__all_modules__": {"learner_connector": {"connector_pipeline_timer": 0.08461587642264909, "timers": {"connectors": {"add_one_ts_to_episodes_and_truncate": 0.008231797207637179, "add_columns_from_episodes_to_train_batch": 0.03329806721368971, "general_advantage_estimation": 0.006786102270021742, "numpy_to_tensor": 6.986208461011766e-05, "batch_individual_items": 0.03528589170434922, "add_observations_from_episodes_to_batch": 0.0008169507997444445, "add_states_from_episodes_to_batch": 3.6822103886956953e-06, "add_time_dim_to_batch_and_zero_pad": 1.0885202435090228e-05}}}, "num_non_trainable_parameters": 0, "learner_connector_sum_episodes_length_in": 5000.0, "learner_connector_sum_episodes_length_out": 5250.0, "num_module_steps_trained": 6000, "num_trainable_parameters": 6003, "num_env_steps_trained_lifetime": 567000, "num_env_steps_trained": 31500, "num_module_steps_trained_lifetime": 108000, "num_env_steps_trained_lifetime_throughput": 2390998.798977647, "num_module_steps_trained_throughput": 456951.6656183869, "num_module_steps_trained_lifetime_throughput": 456348.0751187067}}, "num_training_step_calls_per_iteration": 1, "evaluation": {"env_runners": {"module_to_env_connector": {"timers": {"connectors": {"un_batch_to_individual_items": 5.294161858729198e-06, "listify_data_for_vector_env": 1.0945348544955782e-05, "remove_single_ts_time_rank_from_batch": 5.803049913061682e-07, "normalize_and_clip_actions": 9.395947613154519e-06, "tensor_to_numpy": 1.2822713431388887e-05, "get_actions": 3.57672033004802e-05}}, "connector_pipeline_timer": 0.00010020717144297222}, "agent_episode_returns_mean": {"default_agent": -0.35}, "sample": 0.09836609766010863, "env_step_timer": 1.4058605369338042e-05, "num_episodes": 20, "module_episode_returns_mean": {"default_policy": -0.35}, "episode_return_max": 14.5, "episode_return_min": -12.5, "rlmodule_inference_timer": 2.668859179616514e-05, "env_to_module_connector": {"timers": {"connectors": {"numpy_to_tensor": 8.403459691429154e-06, "batch_individual_items": 6.022754121621385e-06, "add_observations_from_episodes_to_batch": 2.7937588568130115e-06, "add_states_from_episodes_to_batch": 1.5597431715759287e-06, "add_time_dim_to_batch_and_zero_pad": 2.2329505171590525e-06}}, "connector_pipeline_timer": 4.2046576991258846e-05}, "env_to_module_sum_episodes_length_in": 10.368238394574323, "episode_return_mean": -0.35, "episode_duration_sec_mean": 0.004453413729788735, "episode_len_max": 20, "env_to_module_sum_episodes_length_out": 10.368238394574323, "env_reset_timer": 0.00024620981704059035, "num_agent_steps_sampled_lifetime": {"default_agent": 7200}, "episode_len_mean": 20.0, "num_module_steps_sampled_lifetime": {"default_policy": 7200}, "episode_len_min": 20, "num_agent_steps_sampled": {"default_agent": 400}, "weights_seq_no": 18.0, "num_module_steps_sampled": {"default_policy": 400}, "num_env_steps_sampled": 400, "num_episodes_lifetime": 360, "num_env_steps_sampled_lifetime": 90400, "time_between_sampling": 1.6379645833500411}, "num_healthy_workers": 1, "actor_manager_num_outstanding_async_reqs": 0, "num_remote_worker_restarts": 0}, "num_env_steps_sampled_lifetime": -9870000.0, "fault_tolerance": {"num_healthy_workers": 0, "num_remote_worker_restarts": 0}, "env_runner_group": {"actor_manager_num_outstanding_async_reqs": 0}, "done": false, "training_iteration": 18, "trial_id": "499df_00000", "date": "2025-08-11_19-37-28", "timestamp": 1754933848, "time_this_iter_s": 1.722515344619751, "time_total_s": 30.812124252319336, "pid": 28380, "hostname": "Mac", "node_ip": "127.0.0.1", "config": {"exploration_config": {}, "extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "placement_strategy": "PACK", "num_gpus": 0, "_fake_gpus": false, "num_cpus_for_main_process": 2, "eager_tracing": true, "eager_max_retraces": 20, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "torch_compile_learner": false, "torch_compile_learner_what_to_compile": "forward_train", "torch_compile_learner_dynamo_backend": "aot_eager", "torch_compile_learner_dynamo_mode": null, "torch_compile_worker": false, "torch_compile_worker_dynamo_backend": "aot_eager", "torch_compile_worker_dynamo_mode": null, "torch_ddp_kwargs": {}, "torch_skip_nan_gradients": false, "env": "Umbrella", "env_config": {}, "observation_space": null, "action_space": null, "clip_rewards": null, "normalize_actions": true, "clip_actions": false, "_is_atari": null, "disable_env_checking": false, "render_env": false, "action_mask_key": "action_mask", "env_runner_cls": null, "num_env_runners": 0, "create_local_env_runner": true, "num_envs_per_env_runner": 1, "gym_env_vectorize_mode": "SYNC", "num_cpus_per_env_runner": 1, "num_gpus_per_env_runner": 0, "custom_resources_per_env_runner": {}, "validate_env_runners_after_construction": true, "episodes_to_numpy": true, "max_requests_in_flight_per_env_runner": 1, "sample_timeout_s": 60.0, "_env_to_module_connector": null, "add_default_connectors_to_env_to_module_pipeline": true, "_module_to_env_connector": null, "add_default_connectors_to_module_to_env_pipeline": true, "merge_env_runner_states": "training_only", "broadcast_env_runner_states": true, "episode_lookback_horizon": 1, "rollout_fragment_length": "auto", "batch_mode": "complete_episodes", "compress_observations": false, "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "enable_tf1_exec_eagerly": false, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "preprocessor_pref": "deepmind", "observation_filter": "NoFilter", "update_worker_filter_stats": true, "use_worker_filter_stats": true, "sampler_perf_stats_ema_coef": null, "_is_online": true, "num_learners": 0, "num_gpus_per_learner": 0, "num_cpus_per_learner": "auto", "num_aggregator_actors_per_learner": 0, "max_requests_in_flight_per_aggregator_actor": 3, "local_gpu_idx": 0, "max_requests_in_flight_per_learner": 3, "gamma": 1, "lr": 0.0002847858517, "grad_clip": 0.5, "grad_clip_by": "global_norm", "_train_batch_size_per_learner": 5000, "train_batch_size": 4000, "num_epochs": 1, "minibatch_size": 1000, "shuffle_batch_per_epoch": true, "model": {"fcnet_hiddens": [256, 256], "fcnet_activation": "tanh", "fcnet_weights_initializer": null, "fcnet_weights_initializer_config": null, "fcnet_bias_initializer": null, "fcnet_bias_initializer_config": null, "conv_filters": null, "conv_activation": "relu", "conv_kernel_initializer": null, "conv_kernel_initializer_config": null, "conv_bias_initializer": null, "conv_bias_initializer_config": null, "conv_transpose_kernel_initializer": null, "conv_transpose_kernel_initializer_config": null, "conv_transpose_bias_initializer": null, "conv_transpose_bias_initializer_config": null, "post_fcnet_hiddens": [], "post_fcnet_activation": "relu", "post_fcnet_weights_initializer": null, "post_fcnet_weights_initializer_config": null, "post_fcnet_bias_initializer": null, "post_fcnet_bias_initializer_config": null, "free_log_std": false, "log_std_clip_param": 20.0, "no_final_linear": false, "vf_share_layers": false, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "lstm_weights_initializer": null, "lstm_weights_initializer_config": null, "lstm_bias_initializer": null, "lstm_bias_initializer_config": null, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "attention_use_n_prev_actions": 0, "attention_use_n_prev_rewards": 0, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": null, "custom_model_config": {}, "custom_action_dist": null, "custom_preprocessor": null, "encoder_latent_dim": null, "always_check_shapes": false, "lstm_use_prev_action_reward": -1, "_use_default_native_models": -1, "_disable_preprocessor_api": false, "_disable_action_flattening": false}, "_learner_connector": null, "add_default_connectors_to_learner_pipeline": true, "learner_config_dict": {}, "optimizer": {}, "_learner_class": null, "callbacks_on_algorithm_init": null, "callbacks_on_env_runners_recreated": null, "callbacks_on_offline_eval_runners_recreated": null, "callbacks_on_checkpoint_loaded": null, "callbacks_on_environment_created": null, "callbacks_on_episode_created": null, "callbacks_on_episode_start": null, "callbacks_on_episode_step": null, "callbacks_on_episode_end": null, "callbacks_on_evaluate_start": null, "callbacks_on_evaluate_end": null, "callbacks_on_evaluate_offline_start": null, "callbacks_on_evaluate_offline_end": null, "callbacks_on_sample_end": null, "callbacks_on_train_result": null, "explore": true, "enable_rl_module_and_learner": true, "enable_env_runner_and_connector_v2": true, "_prior_exploration_config": {"type": "StochasticSampling"}, "count_steps_by": "env_steps", "policy_map_capacity": 100, "policy_mapping_fn": "<function AlgorithmConfig.DEFAULT_POLICY_MAPPING_FN at 0x13ca69b20>", "policies_to_train": null, "policy_states_are_swappable": false, "observation_fn": null, "offline_data_class": null, "input_read_method": "read_parquet", "input_read_method_kwargs": {}, "input_read_schema": {}, "input_read_episodes": false, "input_read_sample_batches": false, "input_read_batch_size": null, "input_filesystem": null, "input_filesystem_kwargs": {}, "input_compress_columns": ["obs", "new_obs"], "input_spaces_jsonable": true, "materialize_data": false, "materialize_mapped_data": true, "map_batches_kwargs": {}, "iter_batches_kwargs": {}, "ignore_final_observation": false, "prelearner_class": null, "prelearner_buffer_class": null, "prelearner_buffer_kwargs": {}, "prelearner_module_synch_period": 10, "dataset_num_iters_per_learner": null, "input_config": {}, "actions_in_input_normalized": false, "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_config": {}, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "output_max_rows_per_file": null, "output_write_remaining_data": false, "output_write_method": "write_parquet", "output_write_method_kwargs": {}, "output_filesystem": null, "output_filesystem_kwargs": {}, "output_write_episodes": true, "offline_sampling": false, "evaluation_interval": 1, "evaluation_duration": 20, "evaluation_duration_unit": "episodes", "evaluation_sample_timeout_s": 120.0, "evaluation_auto_duration_min_env_steps_per_sample": 100, "evaluation_auto_duration_max_env_steps_per_sample": 2000, "evaluation_parallel_to_training": false, "evaluation_force_reset_envs_before_iteration": true, "evaluation_config": null, "off_policy_estimation_methods": {}, "ope_split_batch_by_episode": true, "evaluation_num_env_runners": 1, "in_evaluation": false, "sync_filters_on_rollout_workers_timeout_s": 10.0, "offline_evaluation_interval": null, "num_offline_eval_runners": 0, "offline_loss_for_module_fn": null, "offline_evaluation_duration": 1, "offline_evaluation_parallel_to_training": false, "offline_evaluation_timeout_s": 120.0, "num_cpus_per_offline_eval_runner": 1, "num_gpus_per_offline_eval_runner": 0, "custom_resources_per_offline_eval_runner": {}, "restart_failed_offline_eval_runners": true, "ignore_offline_eval_runner_failures": false, "max_num_offline_eval_runner_restarts": 1000, "offline_eval_runner_restore_timeout_s": 1800.0, "max_requests_in_flight_per_offline_eval_runner": 1, "validate_offline_eval_runners_after_construction": true, "offline_eval_runner_health_probe_timeout_s": 30.0, "offline_eval_rl_module_inference_only": false, "broadcast_offline_eval_runner_states": false, "offline_eval_batch_size_per_runner": 256, "dataset_num_iters_per_eval_runner": 1, "keep_per_episode_custom_metrics": false, "metrics_episode_collection_timeout_s": 60.0, "metrics_num_episodes_for_smoothing": 100, "min_time_s_per_iteration": null, "min_train_timesteps_per_iteration": 0, "min_sample_timesteps_per_iteration": 0, "log_gradients": true, "export_native_model_files": false, "checkpoint_trainable_policies_only": false, "logger_creator": null, "logger_config": null, "log_level": "WARN", "log_sys_usage": true, "fake_sampler": false, "seed": 7, "restart_failed_env_runners": true, "ignore_env_runner_failures": false, "max_num_env_runner_restarts": 1000, "delay_between_env_runner_restarts_s": 60.0, "restart_failed_sub_environments": false, "num_consecutive_env_runner_failures_tolerance": 100, "env_runner_health_probe_timeout_s": 30.0, "env_runner_restore_timeout_s": 1800.0, "_model_config": {}, "_rl_module_spec": "RLModuleSpec(module_class=None, observation_space=None, action_space=None, inference_only=False, learner_only=False, model_config=DefaultModelConfig(fcnet_hiddens=[60, 90], fcnet_activation='tanh', fcnet_kernel_initializer=None, fcnet_kernel_initializer_kwargs=None, fcnet_bias_initializer=None, fcnet_bias_initializer_kwargs=None, conv_filters=None, conv_activation='relu', conv_kernel_initializer=None, conv_kernel_initializer_kwargs=None, conv_bias_initializer=None, conv_bias_initializer_kwargs=None, head_fcnet_hiddens=[], head_fcnet_activation='relu', head_fcnet_kernel_initializer=None, head_fcnet_kernel_initializer_kwargs=None, head_fcnet_bias_initializer=None, head_fcnet_bias_initializer_kwargs=None, free_log_std=False, log_std_clip_param=20.0, vf_share_layers=True, use_lstm=False, max_seq_len=20, lstm_cell_size=256, lstm_use_prev_action=False, lstm_use_prev_reward=False, lstm_kernel_initializer=None, lstm_kernel_initializer_kwargs=None, lstm_bias_initializer=None, lstm_bias_initializer_kwargs=None), catalog_class=None, load_state_path=None, model_config_dict=None)", "algorithm_config_overrides_per_module": {}, "_per_module_overrides": {}, "_validate_config": true, "_use_msgpack_checkpoints": false, "_torch_grad_scaler_class": null, "_torch_lr_scheduler_classes": null, "_tf_policy_handles_more_than_one_loss": false, "_disable_preprocessor_api": false, "_disable_action_flattening": false, "_disable_initialize_loss_from_dummy_batch": false, "_dont_auto_sync_env_runner_states": false, "env_task_fn": -1, "enable_connectors": -1, "simple_optimizer": false, "policy_map_cache": -1, "worker_cls": -1, "synchronize_filters": -1, "enable_async_evaluation": -1, "custom_async_evaluation_function": -1, "_enable_rl_module_api": -1, "auto_wrap_old_gym_envs": -1, "always_attach_evaluation_results": -1, "replay_sequence_length": null, "_disable_execution_plan_api": -1, "use_critic": true, "use_gae": true, "use_kl_loss": true, "kl_coeff": 0.7464963036515, "kl_target": 0.0270990929592, "vf_loss_coeff": 0.6688075857018, "entropy_coeff": 0.0090570820258, "clip_param": 0.1221781641624, "vf_clip_param": 0.1027808522125, "entropy_coeff_schedule": null, "lr_schedule": null, "sgd_minibatch_size": -1, "vf_share_layers": -1, "__stdout_file__": null, "__stderr_file__": null, "lambda": 0.9099046732075, "input": "sampler", "policies": {"default_policy": [null, null, null, null]}, "callbacks": "<class 'ray.rllib.callbacks.callbacks.RLlibCallback'>", "create_env_on_driver": false, "custom_eval_function": null, "framework": "torch"}, "time_since_restore": 30.812124252319336, "iterations_since_restore": 18, "perf": {"cpu_util_percent": 42.900000000000006, "ram_util_percent": 80.3}}
{"timers": {"training_iteration": 1.5530734093584044, "restore_env_runners": 1.0753729383644318e-05, "training_step": 1.5528853265619877, "env_runner_sampling_timer": 1.4410785939068922, "learner_update_timer": 0.108700906044148, "synch_weights": 0.0005108167538176522, "restore_eval_env_runners": 1.1427400075520932e-05, "evaluation_iteration": 0.10570983744236158, "synch_eval_env_connectors": 0.00012199798517926947, "synch_env_connectors": 4.723687258692058e-06}, "env_runners": {"weights_seq_no": 18.0, "module_to_env_connector": {"timers": {"connectors": {"tensor_to_numpy": 1.4595078019290115e-05, "listify_data_for_vector_env": 1.2736820876133485e-05, "remove_single_ts_time_rank_from_batch": 6.327242203452192e-07, "get_actions": 4.263332273621461e-05, "normalize_and_clip_actions": 1.0343449370184276e-05, "un_batch_to_individual_items": 6.031817771866836e-06}}, "connector_pipeline_timer": 0.00011438604451099088}, "episode_len_mean": 20.0, "num_agent_steps_sampled_lifetime": {"default_agent": -10487500.0}, "num_agent_steps_sampled": {"default_agent": 5000.0}, "sample": 0.005181424378735666, "env_to_module_connector": {"timers": {"connectors": {"batch_individual_items": 7.269174166126657e-06, "add_observations_from_episodes_to_batch": 3.2979561087881638e-06, "add_states_from_episodes_to_batch": 1.8948050579713086e-06, "add_time_dim_to_batch_and_zero_pad": 2.6084569233149758e-06, "numpy_to_tensor": 9.78176927516735e-06}}, "connector_pipeline_timer": 4.811994163658061e-05}, "env_step_timer": 1.555292218014402e-05, "num_episodes": 250.0, "episode_len_min": 20, "num_module_steps_sampled_lifetime": {"default_policy": -10487500.0}, "env_to_module_sum_episodes_length_in": 10.36823839457432, "agent_episode_returns_mean": {"default_agent": 7.2200000000000015}, "num_env_steps_sampled": 5000.0, "episode_return_mean": 7.2200000000000015, "num_module_steps_sampled": {"default_policy": 5000.0}, "episode_duration_sec_mean": 0.005049301663879304, "module_episode_returns_mean": {"default_policy": 7.2200000000000015}, "num_episodes_lifetime": -524375.0, "episode_return_max": 10.5, "episode_len_max": 20, "env_to_module_sum_episodes_length_out": 10.36823839457432, "episode_return_min": -9.5, "num_env_steps_sampled_lifetime": -10487500.0, "env_reset_timer": 4.127444420223196e-05, "time_between_sampling": 0.0020359189090630764, "rlmodule_inference_timer": 3.129274661030469e-05, "num_env_steps_sampled_lifetime_throughput": 3503.0023279907055}, "learners": {"default_policy": {"diff_num_grad_updates_vs_sampler_policy": 1.0, "mean_kl_loss": 2.036566183960531e-05, "num_module_steps_trained": 6000, "vf_explained_var": -0.008934259414672852, "entropy": 0.5288645625114441, "curr_entropy_coeff": 0.0090570820258, "num_trainable_parameters": 6003, "vf_loss_unclipped": 27.963809967041016, "gradients_default_optimizer_global_norm": 0.020102325826883316, "default_optimizer_learning_rate": 0.0002847858517, "module_train_batch_size_mean": 1000.0, "num_module_steps_trained_lifetime": 114000, "total_loss": -0.04619554802775383, "curr_kl_coeff": 1.423828734914423e-06, "policy_loss": -0.1101461872458458, "vf_loss": 0.10278083384037018, "weights_seq_no": 19.0, "num_module_steps_trained_lifetime_throughput": 456803.59131416236}, "__all_modules__": {"learner_connector": {"connector_pipeline_timer": 0.08547136181804323, "timers": {"connectors": {"add_one_ts_to_episodes_and_truncate": 0.008229371315372349, "add_columns_from_episodes_to_train_batch": 0.033317811541673514, "general_advantage_estimation": 0.0067701770874867674, "numpy_to_tensor": 6.98663841338204e-05, "batch_individual_items": 0.03613944028773666, "add_observations_from_episodes_to_batch": 0.0008174025413277558, "add_states_from_episodes_to_batch": 3.6766376496467424e-06, "add_time_dim_to_batch_and_zero_pad": 1.0923019746402645e-05}}}, "num_non_trainable_parameters": 0, "learner_connector_sum_episodes_length_in": 5000.0, "learner_connector_sum_episodes_length_out": 5250.0, "num_module_steps_trained": 6000, "num_trainable_parameters": 6003, "num_env_steps_trained_lifetime": 598500, "num_env_steps_trained": 31500, "num_module_steps_trained_lifetime": 114000, "num_env_steps_trained_lifetime_throughput": 2387403.515831978, "num_module_steps_trained_throughput": 456208.46151574136, "num_module_steps_trained_lifetime_throughput": 455623.57501482}}, "num_training_step_calls_per_iteration": 1, "evaluation": {"env_runners": {"module_to_env_connector": {"timers": {"connectors": {"un_batch_to_individual_items": 5.6848657029269775e-06, "listify_data_for_vector_env": 1.3512680607149165e-05, "remove_single_ts_time_rank_from_batch": 5.931253727921178e-07, "normalize_and_clip_actions": 1.1571412831845128e-05, "tensor_to_numpy": 1.3702450450579621e-05, "get_actions": 3.880501149501213e-05}}, "connector_pipeline_timer": 0.00011085303083411084}, "agent_episode_returns_mean": {"default_agent": -0.15}, "sample": 0.09843847043357222, "env_step_timer": 1.6026991935191987e-05, "num_episodes": 20, "module_episode_returns_mean": {"default_policy": -0.15}, "episode_return_max": 14.5, "episode_return_min": -12.5, "rlmodule_inference_timer": 2.828278830762665e-05, "env_to_module_connector": {"timers": {"connectors": {"numpy_to_tensor": 9.116092293675212e-06, "batch_individual_items": 6.453565198566433e-06, "add_observations_from_episodes_to_batch": 2.955327710006126e-06, "add_states_from_episodes_to_batch": 1.607478948131696e-06, "add_time_dim_to_batch_and_zero_pad": 2.3497995341820724e-06}}, "connector_pipeline_timer": 4.461602328648603e-05}, "env_to_module_sum_episodes_length_in": 10.368238394574323, "episode_return_mean": -0.15, "episode_duration_sec_mean": 0.004555232063867151, "episode_len_max": 20, "env_to_module_sum_episodes_length_out": 10.368238394574323, "env_reset_timer": 0.0002444927187222159, "num_agent_steps_sampled_lifetime": {"default_agent": 7600}, "episode_len_mean": 20.0, "num_module_steps_sampled_lifetime": {"default_policy": 7600}, "episode_len_min": 20, "num_agent_steps_sampled": {"default_agent": 400}, "weights_seq_no": 19.0, "num_module_steps_sampled": {"default_policy": 400}, "num_env_steps_sampled": 400, "num_episodes_lifetime": 380, "num_env_steps_sampled_lifetime": 95400, "time_between_sampling": 1.6390335037663453}, "num_healthy_workers": 1, "actor_manager_num_outstanding_async_reqs": 0, "num_remote_worker_restarts": 0}, "num_env_steps_sampled_lifetime": -10487500.0, "fault_tolerance": {"num_healthy_workers": 0, "num_remote_worker_restarts": 0}, "env_runner_group": {"actor_manager_num_outstanding_async_reqs": 0}, "done": false, "training_iteration": 19, "trial_id": "499df_00000", "date": "2025-08-11_19-37-30", "timestamp": 1754933850, "time_this_iter_s": 1.8391799926757812, "time_total_s": 32.65130424499512, "pid": 28380, "hostname": "Mac", "node_ip": "127.0.0.1", "config": {"exploration_config": {}, "extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "placement_strategy": "PACK", "num_gpus": 0, "_fake_gpus": false, "num_cpus_for_main_process": 2, "eager_tracing": true, "eager_max_retraces": 20, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "torch_compile_learner": false, "torch_compile_learner_what_to_compile": "forward_train", "torch_compile_learner_dynamo_backend": "aot_eager", "torch_compile_learner_dynamo_mode": null, "torch_compile_worker": false, "torch_compile_worker_dynamo_backend": "aot_eager", "torch_compile_worker_dynamo_mode": null, "torch_ddp_kwargs": {}, "torch_skip_nan_gradients": false, "env": "Umbrella", "env_config": {}, "observation_space": null, "action_space": null, "clip_rewards": null, "normalize_actions": true, "clip_actions": false, "_is_atari": null, "disable_env_checking": false, "render_env": false, "action_mask_key": "action_mask", "env_runner_cls": null, "num_env_runners": 0, "create_local_env_runner": true, "num_envs_per_env_runner": 1, "gym_env_vectorize_mode": "SYNC", "num_cpus_per_env_runner": 1, "num_gpus_per_env_runner": 0, "custom_resources_per_env_runner": {}, "validate_env_runners_after_construction": true, "episodes_to_numpy": true, "max_requests_in_flight_per_env_runner": 1, "sample_timeout_s": 60.0, "_env_to_module_connector": null, "add_default_connectors_to_env_to_module_pipeline": true, "_module_to_env_connector": null, "add_default_connectors_to_module_to_env_pipeline": true, "merge_env_runner_states": "training_only", "broadcast_env_runner_states": true, "episode_lookback_horizon": 1, "rollout_fragment_length": "auto", "batch_mode": "complete_episodes", "compress_observations": false, "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "enable_tf1_exec_eagerly": false, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "preprocessor_pref": "deepmind", "observation_filter": "NoFilter", "update_worker_filter_stats": true, "use_worker_filter_stats": true, "sampler_perf_stats_ema_coef": null, "_is_online": true, "num_learners": 0, "num_gpus_per_learner": 0, "num_cpus_per_learner": "auto", "num_aggregator_actors_per_learner": 0, "max_requests_in_flight_per_aggregator_actor": 3, "local_gpu_idx": 0, "max_requests_in_flight_per_learner": 3, "gamma": 1, "lr": 0.0002847858517, "grad_clip": 0.5, "grad_clip_by": "global_norm", "_train_batch_size_per_learner": 5000, "train_batch_size": 4000, "num_epochs": 1, "minibatch_size": 1000, "shuffle_batch_per_epoch": true, "model": {"fcnet_hiddens": [256, 256], "fcnet_activation": "tanh", "fcnet_weights_initializer": null, "fcnet_weights_initializer_config": null, "fcnet_bias_initializer": null, "fcnet_bias_initializer_config": null, "conv_filters": null, "conv_activation": "relu", "conv_kernel_initializer": null, "conv_kernel_initializer_config": null, "conv_bias_initializer": null, "conv_bias_initializer_config": null, "conv_transpose_kernel_initializer": null, "conv_transpose_kernel_initializer_config": null, "conv_transpose_bias_initializer": null, "conv_transpose_bias_initializer_config": null, "post_fcnet_hiddens": [], "post_fcnet_activation": "relu", "post_fcnet_weights_initializer": null, "post_fcnet_weights_initializer_config": null, "post_fcnet_bias_initializer": null, "post_fcnet_bias_initializer_config": null, "free_log_std": false, "log_std_clip_param": 20.0, "no_final_linear": false, "vf_share_layers": false, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "lstm_weights_initializer": null, "lstm_weights_initializer_config": null, "lstm_bias_initializer": null, "lstm_bias_initializer_config": null, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "attention_use_n_prev_actions": 0, "attention_use_n_prev_rewards": 0, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": null, "custom_model_config": {}, "custom_action_dist": null, "custom_preprocessor": null, "encoder_latent_dim": null, "always_check_shapes": false, "lstm_use_prev_action_reward": -1, "_use_default_native_models": -1, "_disable_preprocessor_api": false, "_disable_action_flattening": false}, "_learner_connector": null, "add_default_connectors_to_learner_pipeline": true, "learner_config_dict": {}, "optimizer": {}, "_learner_class": null, "callbacks_on_algorithm_init": null, "callbacks_on_env_runners_recreated": null, "callbacks_on_offline_eval_runners_recreated": null, "callbacks_on_checkpoint_loaded": null, "callbacks_on_environment_created": null, "callbacks_on_episode_created": null, "callbacks_on_episode_start": null, "callbacks_on_episode_step": null, "callbacks_on_episode_end": null, "callbacks_on_evaluate_start": null, "callbacks_on_evaluate_end": null, "callbacks_on_evaluate_offline_start": null, "callbacks_on_evaluate_offline_end": null, "callbacks_on_sample_end": null, "callbacks_on_train_result": null, "explore": true, "enable_rl_module_and_learner": true, "enable_env_runner_and_connector_v2": true, "_prior_exploration_config": {"type": "StochasticSampling"}, "count_steps_by": "env_steps", "policy_map_capacity": 100, "policy_mapping_fn": "<function AlgorithmConfig.DEFAULT_POLICY_MAPPING_FN at 0x13ca69b20>", "policies_to_train": null, "policy_states_are_swappable": false, "observation_fn": null, "offline_data_class": null, "input_read_method": "read_parquet", "input_read_method_kwargs": {}, "input_read_schema": {}, "input_read_episodes": false, "input_read_sample_batches": false, "input_read_batch_size": null, "input_filesystem": null, "input_filesystem_kwargs": {}, "input_compress_columns": ["obs", "new_obs"], "input_spaces_jsonable": true, "materialize_data": false, "materialize_mapped_data": true, "map_batches_kwargs": {}, "iter_batches_kwargs": {}, "ignore_final_observation": false, "prelearner_class": null, "prelearner_buffer_class": null, "prelearner_buffer_kwargs": {}, "prelearner_module_synch_period": 10, "dataset_num_iters_per_learner": null, "input_config": {}, "actions_in_input_normalized": false, "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_config": {}, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "output_max_rows_per_file": null, "output_write_remaining_data": false, "output_write_method": "write_parquet", "output_write_method_kwargs": {}, "output_filesystem": null, "output_filesystem_kwargs": {}, "output_write_episodes": true, "offline_sampling": false, "evaluation_interval": 1, "evaluation_duration": 20, "evaluation_duration_unit": "episodes", "evaluation_sample_timeout_s": 120.0, "evaluation_auto_duration_min_env_steps_per_sample": 100, "evaluation_auto_duration_max_env_steps_per_sample": 2000, "evaluation_parallel_to_training": false, "evaluation_force_reset_envs_before_iteration": true, "evaluation_config": null, "off_policy_estimation_methods": {}, "ope_split_batch_by_episode": true, "evaluation_num_env_runners": 1, "in_evaluation": false, "sync_filters_on_rollout_workers_timeout_s": 10.0, "offline_evaluation_interval": null, "num_offline_eval_runners": 0, "offline_loss_for_module_fn": null, "offline_evaluation_duration": 1, "offline_evaluation_parallel_to_training": false, "offline_evaluation_timeout_s": 120.0, "num_cpus_per_offline_eval_runner": 1, "num_gpus_per_offline_eval_runner": 0, "custom_resources_per_offline_eval_runner": {}, "restart_failed_offline_eval_runners": true, "ignore_offline_eval_runner_failures": false, "max_num_offline_eval_runner_restarts": 1000, "offline_eval_runner_restore_timeout_s": 1800.0, "max_requests_in_flight_per_offline_eval_runner": 1, "validate_offline_eval_runners_after_construction": true, "offline_eval_runner_health_probe_timeout_s": 30.0, "offline_eval_rl_module_inference_only": false, "broadcast_offline_eval_runner_states": false, "offline_eval_batch_size_per_runner": 256, "dataset_num_iters_per_eval_runner": 1, "keep_per_episode_custom_metrics": false, "metrics_episode_collection_timeout_s": 60.0, "metrics_num_episodes_for_smoothing": 100, "min_time_s_per_iteration": null, "min_train_timesteps_per_iteration": 0, "min_sample_timesteps_per_iteration": 0, "log_gradients": true, "export_native_model_files": false, "checkpoint_trainable_policies_only": false, "logger_creator": null, "logger_config": null, "log_level": "WARN", "log_sys_usage": true, "fake_sampler": false, "seed": 7, "restart_failed_env_runners": true, "ignore_env_runner_failures": false, "max_num_env_runner_restarts": 1000, "delay_between_env_runner_restarts_s": 60.0, "restart_failed_sub_environments": false, "num_consecutive_env_runner_failures_tolerance": 100, "env_runner_health_probe_timeout_s": 30.0, "env_runner_restore_timeout_s": 1800.0, "_model_config": {}, "_rl_module_spec": "RLModuleSpec(module_class=None, observation_space=None, action_space=None, inference_only=False, learner_only=False, model_config=DefaultModelConfig(fcnet_hiddens=[60, 90], fcnet_activation='tanh', fcnet_kernel_initializer=None, fcnet_kernel_initializer_kwargs=None, fcnet_bias_initializer=None, fcnet_bias_initializer_kwargs=None, conv_filters=None, conv_activation='relu', conv_kernel_initializer=None, conv_kernel_initializer_kwargs=None, conv_bias_initializer=None, conv_bias_initializer_kwargs=None, head_fcnet_hiddens=[], head_fcnet_activation='relu', head_fcnet_kernel_initializer=None, head_fcnet_kernel_initializer_kwargs=None, head_fcnet_bias_initializer=None, head_fcnet_bias_initializer_kwargs=None, free_log_std=False, log_std_clip_param=20.0, vf_share_layers=True, use_lstm=False, max_seq_len=20, lstm_cell_size=256, lstm_use_prev_action=False, lstm_use_prev_reward=False, lstm_kernel_initializer=None, lstm_kernel_initializer_kwargs=None, lstm_bias_initializer=None, lstm_bias_initializer_kwargs=None), catalog_class=None, load_state_path=None, model_config_dict=None)", "algorithm_config_overrides_per_module": {}, "_per_module_overrides": {}, "_validate_config": true, "_use_msgpack_checkpoints": false, "_torch_grad_scaler_class": null, "_torch_lr_scheduler_classes": null, "_tf_policy_handles_more_than_one_loss": false, "_disable_preprocessor_api": false, "_disable_action_flattening": false, "_disable_initialize_loss_from_dummy_batch": false, "_dont_auto_sync_env_runner_states": false, "env_task_fn": -1, "enable_connectors": -1, "simple_optimizer": false, "policy_map_cache": -1, "worker_cls": -1, "synchronize_filters": -1, "enable_async_evaluation": -1, "custom_async_evaluation_function": -1, "_enable_rl_module_api": -1, "auto_wrap_old_gym_envs": -1, "always_attach_evaluation_results": -1, "replay_sequence_length": null, "_disable_execution_plan_api": -1, "use_critic": true, "use_gae": true, "use_kl_loss": true, "kl_coeff": 0.7464963036515, "kl_target": 0.0270990929592, "vf_loss_coeff": 0.6688075857018, "entropy_coeff": 0.0090570820258, "clip_param": 0.1221781641624, "vf_clip_param": 0.1027808522125, "entropy_coeff_schedule": null, "lr_schedule": null, "sgd_minibatch_size": -1, "vf_share_layers": -1, "__stdout_file__": null, "__stderr_file__": null, "lambda": 0.9099046732075, "input": "sampler", "policies": {"default_policy": [null, null, null, null]}, "callbacks": "<class 'ray.rllib.callbacks.callbacks.RLlibCallback'>", "create_env_on_driver": false, "custom_eval_function": null, "framework": "torch"}, "time_since_restore": 32.65130424499512, "iterations_since_restore": 19, "perf": {"cpu_util_percent": 40.03333333333333, "ram_util_percent": 78.13333333333334}}
{"timers": {"training_iteration": 1.5522050806849153, "restore_env_runners": 1.070828220170427e-05, "training_step": 1.552016973717091, "env_runner_sampling_timer": 1.4404079867184183, "learner_update_timer": 0.10850368573333428, "synch_weights": 0.0005110785864239424, "restore_eval_env_runners": 1.1382705184315244e-05, "evaluation_iteration": 0.1057577690676821, "synch_eval_env_connectors": 0.00012183884576839081, "synch_env_connectors": 4.716859308464485e-06}, "env_runners": {"weights_seq_no": 19.0, "module_to_env_connector": {"timers": {"connectors": {"tensor_to_numpy": 1.3321268124563777e-05, "listify_data_for_vector_env": 1.113316551780622e-05, "remove_single_ts_time_rank_from_batch": 5.873809468137685e-07, "get_actions": 3.7859166015695235e-05, "normalize_and_clip_actions": 9.483568290106846e-06, "un_batch_to_individual_items": 5.413591177286039e-06}}, "connector_pipeline_timer": 0.00010323457185602276}, "episode_len_mean": 20.0, "num_agent_steps_sampled_lifetime": {"default_agent": -11105000.0}, "num_agent_steps_sampled": {"default_agent": 5000.0}, "sample": 0.005064950513931768, "env_to_module_connector": {"timers": {"connectors": {"batch_individual_items": 6.431235613701647e-06, "add_observations_from_episodes_to_batch": 3.0141357645142415e-06, "add_states_from_episodes_to_batch": 1.7562408327580597e-06, "add_time_dim_to_batch_and_zero_pad": 2.342648319311305e-06, "numpy_to_tensor": 8.568260598291217e-06}}, "connector_pipeline_timer": 4.373193551500661e-05}, "env_step_timer": 1.3974043187914093e-05, "num_episodes": 250.0, "episode_len_min": 20, "num_module_steps_sampled_lifetime": {"default_policy": -11105000.0}, "env_to_module_sum_episodes_length_in": 10.36823839457432, "agent_episode_returns_mean": {"default_agent": 6.980000000000003}, "num_env_steps_sampled": 5000.0, "episode_return_mean": 6.980000000000003, "num_module_steps_sampled": {"default_policy": 5000.0}, "episode_duration_sec_mean": 0.004536096519324927, "module_episode_returns_mean": {"default_policy": 6.980000000000003}, "num_episodes_lifetime": -555250.0, "episode_return_max": 10.5, "episode_len_max": 20, "env_to_module_sum_episodes_length_out": 10.36823839457432, "episode_return_min": -9.5, "num_env_steps_sampled_lifetime": -11105000.0, "env_reset_timer": 3.8740192010276085e-05, "time_between_sampling": 0.0019342203853109968, "rlmodule_inference_timer": 2.7508521210065035e-05, "num_env_steps_sampled_lifetime_throughput": 3783.5827065580447}, "learners": {"default_policy": {"diff_num_grad_updates_vs_sampler_policy": 1.0, "mean_kl_loss": 0.0004883734509348869, "num_module_steps_trained": 6000, "vf_explained_var": -0.009521126747131348, "entropy": 0.5163688063621521, "curr_entropy_coeff": 0.0090570820258, "num_trainable_parameters": 6003, "vf_loss_unclipped": 28.101835250854492, "gradients_default_optimizer_global_norm": 0.08865606784820557, "default_optimizer_learning_rate": 0.0002847858517, "module_train_batch_size_mean": 1000.0, "num_module_steps_trained_lifetime": 120000, "total_loss": 0.06485634297132492, "curr_kl_coeff": 7.119143674572115e-07, "policy_loss": 0.0007925351383164525, "vf_loss": 0.10278083384037018, "weights_seq_no": 20.0, "num_module_steps_trained_lifetime_throughput": 455994.74607052526}, "__all_modules__": {"learner_connector": {"connector_pipeline_timer": 0.08537472694892156, "timers": {"connectors": {"add_one_ts_to_episodes_and_truncate": 0.008222298011999366, "add_columns_from_episodes_to_train_batch": 0.033317480505518915, "general_advantage_estimation": 0.006753935316134094, "numpy_to_tensor": 6.975063974854689e-05, "batch_individual_items": 0.03606715088483367, "add_observations_from_episodes_to_batch": 0.000817178925695666, "add_states_from_episodes_to_batch": 3.6686212010286548e-06, "add_time_dim_to_batch_and_zero_pad": 1.0912540009831534e-05}}}, "num_non_trainable_parameters": 0, "learner_connector_sum_episodes_length_in": 5000.0, "learner_connector_sum_episodes_length_out": 5250.0, "num_module_steps_trained": 6000, "num_trainable_parameters": 6003, "num_env_steps_trained_lifetime": 630000, "num_env_steps_trained": 31500, "num_module_steps_trained_lifetime": 120000, "num_env_steps_trained_lifetime_throughput": 2383781.023643067, "num_module_steps_trained_throughput": 455463.687800762, "num_module_steps_trained_lifetime_throughput": 454896.83366399596}}, "num_training_step_calls_per_iteration": 1, "evaluation": {"env_runners": {"module_to_env_connector": {"timers": {"connectors": {"un_batch_to_individual_items": 5.229638908912961e-06, "listify_data_for_vector_env": 1.0735829821267658e-05, "remove_single_ts_time_rank_from_batch": 5.602396127709496e-07, "normalize_and_clip_actions": 9.18149108776664e-06, "tensor_to_numpy": 1.2539948988127465e-05, "get_actions": 3.482310793016588e-05}}, "connector_pipeline_timer": 9.80041178358393e-05}, "agent_episode_returns_mean": {"default_agent": 0.25}, "sample": 0.09839468114861545, "env_step_timer": 1.3707883539611512e-05, "num_episodes": 20, "module_episode_returns_mean": {"default_policy": 0.25}, "episode_return_max": 14.5, "episode_return_min": -12.5, "rlmodule_inference_timer": 2.588908419137163e-05, "env_to_module_connector": {"timers": {"connectors": {"numpy_to_tensor": 8.348943650821836e-06, "batch_individual_items": 6.0107965017803715e-06, "add_observations_from_episodes_to_batch": 2.741581546494633e-06, "add_states_from_episodes_to_batch": 1.632797983733536e-06, "add_time_dim_to_batch_and_zero_pad": 2.2043168920645825e-06}}, "connector_pipeline_timer": 4.1964822799531606e-05}, "env_to_module_sum_episodes_length_in": 10.368238394574323, "episode_return_mean": 0.25, "episode_duration_sec_mean": 0.004558094140375033, "episode_len_max": 20, "env_to_module_sum_episodes_length_out": 10.368238394574323, "env_reset_timer": 0.00024280654120068616, "num_agent_steps_sampled_lifetime": {"default_agent": 8000}, "episode_len_mean": 20.0, "num_module_steps_sampled_lifetime": {"default_policy": 8000}, "episode_len_min": 20, "num_agent_steps_sampled": {"default_agent": 400}, "weights_seq_no": 20.0, "num_module_steps_sampled": {"default_policy": 400}, "num_env_steps_sampled": 400, "num_episodes_lifetime": 400, "num_env_steps_sampled_lifetime": 100400, "time_between_sampling": 1.6374870491382894}, "num_healthy_workers": 1, "actor_manager_num_outstanding_async_reqs": 0, "num_remote_worker_restarts": 0}, "num_env_steps_sampled_lifetime": -11105000.0, "fault_tolerance": {"num_healthy_workers": 0, "num_remote_worker_restarts": 0}, "env_runner_group": {"actor_manager_num_outstanding_async_reqs": 0}, "done": true, "training_iteration": 20, "trial_id": "499df_00000", "date": "2025-08-11_19-37-31", "timestamp": 1754933851, "time_this_iter_s": 1.5669710636138916, "time_total_s": 34.21827530860901, "pid": 28380, "hostname": "Mac", "node_ip": "127.0.0.1", "config": {"exploration_config": {}, "extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "placement_strategy": "PACK", "num_gpus": 0, "_fake_gpus": false, "num_cpus_for_main_process": 2, "eager_tracing": true, "eager_max_retraces": 20, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "torch_compile_learner": false, "torch_compile_learner_what_to_compile": "forward_train", "torch_compile_learner_dynamo_backend": "aot_eager", "torch_compile_learner_dynamo_mode": null, "torch_compile_worker": false, "torch_compile_worker_dynamo_backend": "aot_eager", "torch_compile_worker_dynamo_mode": null, "torch_ddp_kwargs": {}, "torch_skip_nan_gradients": false, "env": "Umbrella", "env_config": {}, "observation_space": null, "action_space": null, "clip_rewards": null, "normalize_actions": true, "clip_actions": false, "_is_atari": null, "disable_env_checking": false, "render_env": false, "action_mask_key": "action_mask", "env_runner_cls": null, "num_env_runners": 0, "create_local_env_runner": true, "num_envs_per_env_runner": 1, "gym_env_vectorize_mode": "SYNC", "num_cpus_per_env_runner": 1, "num_gpus_per_env_runner": 0, "custom_resources_per_env_runner": {}, "validate_env_runners_after_construction": true, "episodes_to_numpy": true, "max_requests_in_flight_per_env_runner": 1, "sample_timeout_s": 60.0, "_env_to_module_connector": null, "add_default_connectors_to_env_to_module_pipeline": true, "_module_to_env_connector": null, "add_default_connectors_to_module_to_env_pipeline": true, "merge_env_runner_states": "training_only", "broadcast_env_runner_states": true, "episode_lookback_horizon": 1, "rollout_fragment_length": "auto", "batch_mode": "complete_episodes", "compress_observations": false, "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "enable_tf1_exec_eagerly": false, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "preprocessor_pref": "deepmind", "observation_filter": "NoFilter", "update_worker_filter_stats": true, "use_worker_filter_stats": true, "sampler_perf_stats_ema_coef": null, "_is_online": true, "num_learners": 0, "num_gpus_per_learner": 0, "num_cpus_per_learner": "auto", "num_aggregator_actors_per_learner": 0, "max_requests_in_flight_per_aggregator_actor": 3, "local_gpu_idx": 0, "max_requests_in_flight_per_learner": 3, "gamma": 1, "lr": 0.0002847858517, "grad_clip": 0.5, "grad_clip_by": "global_norm", "_train_batch_size_per_learner": 5000, "train_batch_size": 4000, "num_epochs": 1, "minibatch_size": 1000, "shuffle_batch_per_epoch": true, "model": {"fcnet_hiddens": [256, 256], "fcnet_activation": "tanh", "fcnet_weights_initializer": null, "fcnet_weights_initializer_config": null, "fcnet_bias_initializer": null, "fcnet_bias_initializer_config": null, "conv_filters": null, "conv_activation": "relu", "conv_kernel_initializer": null, "conv_kernel_initializer_config": null, "conv_bias_initializer": null, "conv_bias_initializer_config": null, "conv_transpose_kernel_initializer": null, "conv_transpose_kernel_initializer_config": null, "conv_transpose_bias_initializer": null, "conv_transpose_bias_initializer_config": null, "post_fcnet_hiddens": [], "post_fcnet_activation": "relu", "post_fcnet_weights_initializer": null, "post_fcnet_weights_initializer_config": null, "post_fcnet_bias_initializer": null, "post_fcnet_bias_initializer_config": null, "free_log_std": false, "log_std_clip_param": 20.0, "no_final_linear": false, "vf_share_layers": false, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "lstm_weights_initializer": null, "lstm_weights_initializer_config": null, "lstm_bias_initializer": null, "lstm_bias_initializer_config": null, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "attention_use_n_prev_actions": 0, "attention_use_n_prev_rewards": 0, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": null, "custom_model_config": {}, "custom_action_dist": null, "custom_preprocessor": null, "encoder_latent_dim": null, "always_check_shapes": false, "lstm_use_prev_action_reward": -1, "_use_default_native_models": -1, "_disable_preprocessor_api": false, "_disable_action_flattening": false}, "_learner_connector": null, "add_default_connectors_to_learner_pipeline": true, "learner_config_dict": {}, "optimizer": {}, "_learner_class": null, "callbacks_on_algorithm_init": null, "callbacks_on_env_runners_recreated": null, "callbacks_on_offline_eval_runners_recreated": null, "callbacks_on_checkpoint_loaded": null, "callbacks_on_environment_created": null, "callbacks_on_episode_created": null, "callbacks_on_episode_start": null, "callbacks_on_episode_step": null, "callbacks_on_episode_end": null, "callbacks_on_evaluate_start": null, "callbacks_on_evaluate_end": null, "callbacks_on_evaluate_offline_start": null, "callbacks_on_evaluate_offline_end": null, "callbacks_on_sample_end": null, "callbacks_on_train_result": null, "explore": true, "enable_rl_module_and_learner": true, "enable_env_runner_and_connector_v2": true, "_prior_exploration_config": {"type": "StochasticSampling"}, "count_steps_by": "env_steps", "policy_map_capacity": 100, "policy_mapping_fn": "<function AlgorithmConfig.DEFAULT_POLICY_MAPPING_FN at 0x13ca69b20>", "policies_to_train": null, "policy_states_are_swappable": false, "observation_fn": null, "offline_data_class": null, "input_read_method": "read_parquet", "input_read_method_kwargs": {}, "input_read_schema": {}, "input_read_episodes": false, "input_read_sample_batches": false, "input_read_batch_size": null, "input_filesystem": null, "input_filesystem_kwargs": {}, "input_compress_columns": ["obs", "new_obs"], "input_spaces_jsonable": true, "materialize_data": false, "materialize_mapped_data": true, "map_batches_kwargs": {}, "iter_batches_kwargs": {}, "ignore_final_observation": false, "prelearner_class": null, "prelearner_buffer_class": null, "prelearner_buffer_kwargs": {}, "prelearner_module_synch_period": 10, "dataset_num_iters_per_learner": null, "input_config": {}, "actions_in_input_normalized": false, "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_config": {}, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "output_max_rows_per_file": null, "output_write_remaining_data": false, "output_write_method": "write_parquet", "output_write_method_kwargs": {}, "output_filesystem": null, "output_filesystem_kwargs": {}, "output_write_episodes": true, "offline_sampling": false, "evaluation_interval": 1, "evaluation_duration": 20, "evaluation_duration_unit": "episodes", "evaluation_sample_timeout_s": 120.0, "evaluation_auto_duration_min_env_steps_per_sample": 100, "evaluation_auto_duration_max_env_steps_per_sample": 2000, "evaluation_parallel_to_training": false, "evaluation_force_reset_envs_before_iteration": true, "evaluation_config": null, "off_policy_estimation_methods": {}, "ope_split_batch_by_episode": true, "evaluation_num_env_runners": 1, "in_evaluation": false, "sync_filters_on_rollout_workers_timeout_s": 10.0, "offline_evaluation_interval": null, "num_offline_eval_runners": 0, "offline_loss_for_module_fn": null, "offline_evaluation_duration": 1, "offline_evaluation_parallel_to_training": false, "offline_evaluation_timeout_s": 120.0, "num_cpus_per_offline_eval_runner": 1, "num_gpus_per_offline_eval_runner": 0, "custom_resources_per_offline_eval_runner": {}, "restart_failed_offline_eval_runners": true, "ignore_offline_eval_runner_failures": false, "max_num_offline_eval_runner_restarts": 1000, "offline_eval_runner_restore_timeout_s": 1800.0, "max_requests_in_flight_per_offline_eval_runner": 1, "validate_offline_eval_runners_after_construction": true, "offline_eval_runner_health_probe_timeout_s": 30.0, "offline_eval_rl_module_inference_only": false, "broadcast_offline_eval_runner_states": false, "offline_eval_batch_size_per_runner": 256, "dataset_num_iters_per_eval_runner": 1, "keep_per_episode_custom_metrics": false, "metrics_episode_collection_timeout_s": 60.0, "metrics_num_episodes_for_smoothing": 100, "min_time_s_per_iteration": null, "min_train_timesteps_per_iteration": 0, "min_sample_timesteps_per_iteration": 0, "log_gradients": true, "export_native_model_files": false, "checkpoint_trainable_policies_only": false, "logger_creator": null, "logger_config": null, "log_level": "WARN", "log_sys_usage": true, "fake_sampler": false, "seed": 7, "restart_failed_env_runners": true, "ignore_env_runner_failures": false, "max_num_env_runner_restarts": 1000, "delay_between_env_runner_restarts_s": 60.0, "restart_failed_sub_environments": false, "num_consecutive_env_runner_failures_tolerance": 100, "env_runner_health_probe_timeout_s": 30.0, "env_runner_restore_timeout_s": 1800.0, "_model_config": {}, "_rl_module_spec": "RLModuleSpec(module_class=None, observation_space=None, action_space=None, inference_only=False, learner_only=False, model_config=DefaultModelConfig(fcnet_hiddens=[60, 90], fcnet_activation='tanh', fcnet_kernel_initializer=None, fcnet_kernel_initializer_kwargs=None, fcnet_bias_initializer=None, fcnet_bias_initializer_kwargs=None, conv_filters=None, conv_activation='relu', conv_kernel_initializer=None, conv_kernel_initializer_kwargs=None, conv_bias_initializer=None, conv_bias_initializer_kwargs=None, head_fcnet_hiddens=[], head_fcnet_activation='relu', head_fcnet_kernel_initializer=None, head_fcnet_kernel_initializer_kwargs=None, head_fcnet_bias_initializer=None, head_fcnet_bias_initializer_kwargs=None, free_log_std=False, log_std_clip_param=20.0, vf_share_layers=True, use_lstm=False, max_seq_len=20, lstm_cell_size=256, lstm_use_prev_action=False, lstm_use_prev_reward=False, lstm_kernel_initializer=None, lstm_kernel_initializer_kwargs=None, lstm_bias_initializer=None, lstm_bias_initializer_kwargs=None), catalog_class=None, load_state_path=None, model_config_dict=None)", "algorithm_config_overrides_per_module": {}, "_per_module_overrides": {}, "_validate_config": true, "_use_msgpack_checkpoints": false, "_torch_grad_scaler_class": null, "_torch_lr_scheduler_classes": null, "_tf_policy_handles_more_than_one_loss": false, "_disable_preprocessor_api": false, "_disable_action_flattening": false, "_disable_initialize_loss_from_dummy_batch": false, "_dont_auto_sync_env_runner_states": false, "env_task_fn": -1, "enable_connectors": -1, "simple_optimizer": false, "policy_map_cache": -1, "worker_cls": -1, "synchronize_filters": -1, "enable_async_evaluation": -1, "custom_async_evaluation_function": -1, "_enable_rl_module_api": -1, "auto_wrap_old_gym_envs": -1, "always_attach_evaluation_results": -1, "replay_sequence_length": null, "_disable_execution_plan_api": -1, "use_critic": true, "use_gae": true, "use_kl_loss": true, "kl_coeff": 0.7464963036515, "kl_target": 0.0270990929592, "vf_loss_coeff": 0.6688075857018, "entropy_coeff": 0.0090570820258, "clip_param": 0.1221781641624, "vf_clip_param": 0.1027808522125, "entropy_coeff_schedule": null, "lr_schedule": null, "sgd_minibatch_size": -1, "vf_share_layers": -1, "__stdout_file__": null, "__stderr_file__": null, "lambda": 0.9099046732075, "input": "sampler", "policies": {"default_policy": [null, null, null, null]}, "callbacks": "<class 'ray.rllib.callbacks.callbacks.RLlibCallback'>", "create_env_on_driver": false, "custom_eval_function": null, "framework": "torch"}, "time_since_restore": 34.21827530860901, "iterations_since_restore": 20, "perf": {"cpu_util_percent": 32.3, "ram_util_percent": 77.19999999999999}}
