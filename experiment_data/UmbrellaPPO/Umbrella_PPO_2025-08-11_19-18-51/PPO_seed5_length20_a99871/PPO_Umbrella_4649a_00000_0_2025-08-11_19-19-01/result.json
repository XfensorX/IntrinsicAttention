{"timers": {"training_iteration": 1.5318569169612601, "restore_env_runners": 7.999944500625134e-06, "training_step": 1.5317260840674862, "env_runner_sampling_timer": 1.4263538750819862, "learner_update_timer": 0.10228808294050395, "synch_weights": 0.0006171670975163579}, "env_runners": {"env_to_module_connector": {"timers": {"connectors": {"numpy_to_tensor": 8.771609545667756e-06, "add_states_from_episodes_to_batch": 1.736847947866881e-06, "batch_individual_items": 6.430570800006883e-06, "add_observations_from_episodes_to_batch": 3.1693635791909007e-06, "add_time_dim_to_batch_and_zero_pad": 2.3932334610258234e-06}}, "connector_pipeline_timer": 4.572209016685579e-05}, "num_agent_steps_sampled_lifetime": {"default_agent": 627500.0}, "env_to_module_sum_episodes_length_out": 10.191744832559449, "num_episodes": 250.0, "episode_len_max": 20, "num_module_steps_sampled": {"default_policy": 5000.0}, "module_to_env_connector": {"timers": {"connectors": {"un_batch_to_individual_items": 5.42360112411327e-06, "listify_data_for_vector_env": 1.0850680946752347e-05, "normalize_and_clip_actions": 1.2860426796095382e-05, "get_actions": 4.122952722250182e-05, "tensor_to_numpy": 1.3028000659670367e-05, "remove_single_ts_time_rank_from_batch": 5.860619276002973e-07}}, "connector_pipeline_timer": 0.00010959393857980052}, "num_module_steps_sampled_lifetime": {"default_policy": 627500.0}, "num_episodes_lifetime": 31375.0, "episode_len_min": 20, "episode_return_max": 6.5, "env_to_module_sum_episodes_length_in": 10.191744832559449, "env_step_timer": 1.439000871894128e-05, "sample": 0.0057610162267081955, "rlmodule_inference_timer": 4.910130009651867e-05, "episode_duration_sec_mean": 0.004819118323735894, "episode_return_mean": -3.7400000000000015, "module_episode_returns_mean": {"default_policy": -3.7400000000000015}, "env_reset_timer": 7.420162770148396e-05, "num_env_steps_sampled_lifetime": 627500.0, "num_env_steps_sampled": 5000.0, "episode_return_min": -13.5, "episode_len_mean": 20.0, "weights_seq_no": 0.0, "num_agent_steps_sampled": {"default_agent": 5000.0}, "time_between_sampling": 0.0005046255910475121, "agent_episode_returns_mean": {"default_agent": -3.7400000000000015}, "num_env_steps_sampled_lifetime_throughput": 3616.6659452659833}, "learners": {"default_policy": {"policy_loss": 0.061082545667886734, "vf_loss": 0.10278083384037018, "vf_loss_unclipped": 31.674436569213867, "num_module_steps_trained": 6000, "diff_num_grad_updates_vs_sampler_policy": 1.0, "default_optimizer_learning_rate": 0.0002847858517, "weights_seq_no": 1.0, "total_loss": 0.12488927692174911, "vf_explained_var": -0.009245157241821289, "module_train_batch_size_mean": 1000.0, "num_module_steps_trained_lifetime": 6000, "gradients_default_optimizer_global_norm": 0.11001160740852356, "entropy": 0.6923456788063049, "curr_entropy_coeff": 0.0090570820258, "num_trainable_parameters": 6003, "curr_kl_coeff": 0.3732481598854065, "mean_kl_loss": 0.0017906971042975783, "num_module_steps_trained_lifetime_throughput": 443617.5833798784}, "__all_modules__": {"learner_connector": {"timers": {"connectors": {"batch_individual_items": 0.029746457934379578, "add_observations_from_episodes_to_batch": 0.0007740409346297383, "add_columns_from_episodes_to_train_batch": 0.033545542042702436, "general_advantage_estimation": 0.0063165409956127405, "add_time_dim_to_batch_and_zero_pad": 8.834060281515121e-06, "numpy_to_tensor": 6.275007035583258e-05, "add_states_from_episodes_to_batch": 3.0410010367631912e-06, "add_one_ts_to_episodes_and_truncate": 0.007466166978701949}}, "connector_pipeline_timer": 0.07803133397828788}, "num_trainable_parameters": 6003, "num_env_steps_trained_lifetime": 31500, "num_module_steps_trained": 6000, "num_non_trainable_parameters": 0, "num_env_steps_trained": 31500, "num_module_steps_trained_lifetime": 6000, "learner_connector_sum_episodes_length_in": 5000, "learner_connector_sum_episodes_length_out": 5250, "num_env_steps_trained_lifetime_throughput": 2310490.8496805304, "num_module_steps_trained_throughput": 442350.92820118985, "num_module_steps_trained_lifetime_throughput": 441431.8979396106}}, "num_training_step_calls_per_iteration": 1, "num_env_steps_sampled_lifetime": 627500.0, "evaluation": {"env_runners": {"module_to_env_connector": {"connector_pipeline_timer": 0.00010703176983939648, "timers": {"connectors": {"listify_data_for_vector_env": 1.0857605124420586e-05, "get_actions": 3.959729153968671e-05, "remove_single_ts_time_rank_from_batch": 5.673481068345605e-07, "tensor_to_numpy": 1.4653095856490795e-05, "un_batch_to_individual_items": 5.380299401478936e-06, "normalize_and_clip_actions": 1.0635368422739045e-05}}}, "num_episodes_lifetime": 20, "num_module_steps_sampled": {"default_policy": 400}, "env_to_module_sum_episodes_length_in": 10.216013141322508, "env_to_module_connector": {"timers": {"connectors": {"numpy_to_tensor": 8.392009299944162e-06, "add_states_from_episodes_to_batch": 1.5726566319976194e-06, "add_time_dim_to_batch_and_zero_pad": 2.291408416476029e-06, "batch_individual_items": 6.231737694278636e-06, "add_observations_from_episodes_to_batch": 2.936644636380632e-06}}, "connector_pipeline_timer": 4.463031701623696e-05}, "module_episode_returns_mean": {"default_policy": -3.3}, "agent_episode_returns_mean": {"default_agent": -3.3}, "env_to_module_sum_episodes_length_out": 10.216013141322508, "episode_len_max": 20, "num_agent_steps_sampled": {"default_agent": 400}, "num_module_steps_sampled_lifetime": {"default_policy": 400}, "episode_return_max": 13.5, "sample": 0.09655612497590482, "rlmodule_inference_timer": 2.8901243425612868e-05, "env_reset_timer": 0.0002276250161230564, "episode_len_mean": 20.0, "weights_seq_no": 1.0, "episode_len_min": 20, "episode_duration_sec_mean": 0.004424154059961438, "episode_return_mean": -3.3, "num_env_steps_sampled": 400, "episode_return_min": -15.5, "num_agent_steps_sampled_lifetime": {"default_agent": 400}, "num_episodes": 20, "env_step_timer": 1.4308671407957611e-05, "num_env_steps_sampled_lifetime": 5400}, "num_healthy_workers": 1, "actor_manager_num_outstanding_async_reqs": 0, "num_remote_worker_restarts": 0}, "fault_tolerance": {"num_healthy_workers": 0, "num_remote_worker_restarts": 0}, "env_runner_group": {"actor_manager_num_outstanding_async_reqs": 0}, "done": false, "training_iteration": 1, "trial_id": "4649a_00000", "date": "2025-08-11_19-36-11", "timestamp": 1754933771, "time_this_iter_s": 1.6363461017608643, "time_total_s": 1.6363461017608643, "pid": 28167, "hostname": "Mac", "node_ip": "127.0.0.1", "config": {"exploration_config": {}, "extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "placement_strategy": "PACK", "num_gpus": 0, "_fake_gpus": false, "num_cpus_for_main_process": 2, "eager_tracing": true, "eager_max_retraces": 20, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "torch_compile_learner": false, "torch_compile_learner_what_to_compile": "forward_train", "torch_compile_learner_dynamo_backend": "aot_eager", "torch_compile_learner_dynamo_mode": null, "torch_compile_worker": false, "torch_compile_worker_dynamo_backend": "aot_eager", "torch_compile_worker_dynamo_mode": null, "torch_ddp_kwargs": {}, "torch_skip_nan_gradients": false, "env": "Umbrella", "env_config": {}, "observation_space": null, "action_space": null, "clip_rewards": null, "normalize_actions": true, "clip_actions": false, "_is_atari": null, "disable_env_checking": false, "render_env": false, "action_mask_key": "action_mask", "env_runner_cls": null, "num_env_runners": 0, "create_local_env_runner": true, "num_envs_per_env_runner": 1, "gym_env_vectorize_mode": "SYNC", "num_cpus_per_env_runner": 1, "num_gpus_per_env_runner": 0, "custom_resources_per_env_runner": {}, "validate_env_runners_after_construction": true, "episodes_to_numpy": true, "max_requests_in_flight_per_env_runner": 1, "sample_timeout_s": 60.0, "_env_to_module_connector": null, "add_default_connectors_to_env_to_module_pipeline": true, "_module_to_env_connector": null, "add_default_connectors_to_module_to_env_pipeline": true, "merge_env_runner_states": "training_only", "broadcast_env_runner_states": true, "episode_lookback_horizon": 1, "rollout_fragment_length": "auto", "batch_mode": "complete_episodes", "compress_observations": false, "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "enable_tf1_exec_eagerly": false, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "preprocessor_pref": "deepmind", "observation_filter": "NoFilter", "update_worker_filter_stats": true, "use_worker_filter_stats": true, "sampler_perf_stats_ema_coef": null, "_is_online": true, "num_learners": 0, "num_gpus_per_learner": 0, "num_cpus_per_learner": "auto", "num_aggregator_actors_per_learner": 0, "max_requests_in_flight_per_aggregator_actor": 3, "local_gpu_idx": 0, "max_requests_in_flight_per_learner": 3, "gamma": 1, "lr": 0.0002847858517, "grad_clip": 0.5, "grad_clip_by": "global_norm", "_train_batch_size_per_learner": 5000, "train_batch_size": 4000, "num_epochs": 1, "minibatch_size": 1000, "shuffle_batch_per_epoch": true, "model": {"fcnet_hiddens": [256, 256], "fcnet_activation": "tanh", "fcnet_weights_initializer": null, "fcnet_weights_initializer_config": null, "fcnet_bias_initializer": null, "fcnet_bias_initializer_config": null, "conv_filters": null, "conv_activation": "relu", "conv_kernel_initializer": null, "conv_kernel_initializer_config": null, "conv_bias_initializer": null, "conv_bias_initializer_config": null, "conv_transpose_kernel_initializer": null, "conv_transpose_kernel_initializer_config": null, "conv_transpose_bias_initializer": null, "conv_transpose_bias_initializer_config": null, "post_fcnet_hiddens": [], "post_fcnet_activation": "relu", "post_fcnet_weights_initializer": null, "post_fcnet_weights_initializer_config": null, "post_fcnet_bias_initializer": null, "post_fcnet_bias_initializer_config": null, "free_log_std": false, "log_std_clip_param": 20.0, "no_final_linear": false, "vf_share_layers": false, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "lstm_weights_initializer": null, "lstm_weights_initializer_config": null, "lstm_bias_initializer": null, "lstm_bias_initializer_config": null, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "attention_use_n_prev_actions": 0, "attention_use_n_prev_rewards": 0, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": null, "custom_model_config": {}, "custom_action_dist": null, "custom_preprocessor": null, "encoder_latent_dim": null, "always_check_shapes": false, "lstm_use_prev_action_reward": -1, "_use_default_native_models": -1, "_disable_preprocessor_api": false, "_disable_action_flattening": false}, "_learner_connector": null, "add_default_connectors_to_learner_pipeline": true, "learner_config_dict": {}, "optimizer": {}, "_learner_class": null, "callbacks_on_algorithm_init": null, "callbacks_on_env_runners_recreated": null, "callbacks_on_offline_eval_runners_recreated": null, "callbacks_on_checkpoint_loaded": null, "callbacks_on_environment_created": null, "callbacks_on_episode_created": null, "callbacks_on_episode_start": null, "callbacks_on_episode_step": null, "callbacks_on_episode_end": null, "callbacks_on_evaluate_start": null, "callbacks_on_evaluate_end": null, "callbacks_on_evaluate_offline_start": null, "callbacks_on_evaluate_offline_end": null, "callbacks_on_sample_end": null, "callbacks_on_train_result": null, "explore": true, "enable_rl_module_and_learner": true, "enable_env_runner_and_connector_v2": true, "_prior_exploration_config": {"type": "StochasticSampling"}, "count_steps_by": "env_steps", "policy_map_capacity": 100, "policy_mapping_fn": "<function AlgorithmConfig.DEFAULT_POLICY_MAPPING_FN at 0x17c065b20>", "policies_to_train": null, "policy_states_are_swappable": false, "observation_fn": null, "offline_data_class": null, "input_read_method": "read_parquet", "input_read_method_kwargs": {}, "input_read_schema": {}, "input_read_episodes": false, "input_read_sample_batches": false, "input_read_batch_size": null, "input_filesystem": null, "input_filesystem_kwargs": {}, "input_compress_columns": ["obs", "new_obs"], "input_spaces_jsonable": true, "materialize_data": false, "materialize_mapped_data": true, "map_batches_kwargs": {}, "iter_batches_kwargs": {}, "ignore_final_observation": false, "prelearner_class": null, "prelearner_buffer_class": null, "prelearner_buffer_kwargs": {}, "prelearner_module_synch_period": 10, "dataset_num_iters_per_learner": null, "input_config": {}, "actions_in_input_normalized": false, "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_config": {}, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "output_max_rows_per_file": null, "output_write_remaining_data": false, "output_write_method": "write_parquet", "output_write_method_kwargs": {}, "output_filesystem": null, "output_filesystem_kwargs": {}, "output_write_episodes": true, "offline_sampling": false, "evaluation_interval": 1, "evaluation_duration": 20, "evaluation_duration_unit": "episodes", "evaluation_sample_timeout_s": 120.0, "evaluation_auto_duration_min_env_steps_per_sample": 100, "evaluation_auto_duration_max_env_steps_per_sample": 2000, "evaluation_parallel_to_training": false, "evaluation_force_reset_envs_before_iteration": true, "evaluation_config": null, "off_policy_estimation_methods": {}, "ope_split_batch_by_episode": true, "evaluation_num_env_runners": 1, "in_evaluation": false, "sync_filters_on_rollout_workers_timeout_s": 10.0, "offline_evaluation_interval": null, "num_offline_eval_runners": 0, "offline_loss_for_module_fn": null, "offline_evaluation_duration": 1, "offline_evaluation_parallel_to_training": false, "offline_evaluation_timeout_s": 120.0, "num_cpus_per_offline_eval_runner": 1, "num_gpus_per_offline_eval_runner": 0, "custom_resources_per_offline_eval_runner": {}, "restart_failed_offline_eval_runners": true, "ignore_offline_eval_runner_failures": false, "max_num_offline_eval_runner_restarts": 1000, "offline_eval_runner_restore_timeout_s": 1800.0, "max_requests_in_flight_per_offline_eval_runner": 1, "validate_offline_eval_runners_after_construction": true, "offline_eval_runner_health_probe_timeout_s": 30.0, "offline_eval_rl_module_inference_only": false, "broadcast_offline_eval_runner_states": false, "offline_eval_batch_size_per_runner": 256, "dataset_num_iters_per_eval_runner": 1, "keep_per_episode_custom_metrics": false, "metrics_episode_collection_timeout_s": 60.0, "metrics_num_episodes_for_smoothing": 100, "min_time_s_per_iteration": null, "min_train_timesteps_per_iteration": 0, "min_sample_timesteps_per_iteration": 0, "log_gradients": true, "export_native_model_files": false, "checkpoint_trainable_policies_only": false, "logger_creator": null, "logger_config": null, "log_level": "WARN", "log_sys_usage": true, "fake_sampler": false, "seed": 5, "restart_failed_env_runners": true, "ignore_env_runner_failures": false, "max_num_env_runner_restarts": 1000, "delay_between_env_runner_restarts_s": 60.0, "restart_failed_sub_environments": false, "num_consecutive_env_runner_failures_tolerance": 100, "env_runner_health_probe_timeout_s": 30.0, "env_runner_restore_timeout_s": 1800.0, "_model_config": {}, "_rl_module_spec": "RLModuleSpec(module_class=None, observation_space=None, action_space=None, inference_only=False, learner_only=False, model_config=DefaultModelConfig(fcnet_hiddens=[60, 90], fcnet_activation='tanh', fcnet_kernel_initializer=None, fcnet_kernel_initializer_kwargs=None, fcnet_bias_initializer=None, fcnet_bias_initializer_kwargs=None, conv_filters=None, conv_activation='relu', conv_kernel_initializer=None, conv_kernel_initializer_kwargs=None, conv_bias_initializer=None, conv_bias_initializer_kwargs=None, head_fcnet_hiddens=[], head_fcnet_activation='relu', head_fcnet_kernel_initializer=None, head_fcnet_kernel_initializer_kwargs=None, head_fcnet_bias_initializer=None, head_fcnet_bias_initializer_kwargs=None, free_log_std=False, log_std_clip_param=20.0, vf_share_layers=True, use_lstm=False, max_seq_len=20, lstm_cell_size=256, lstm_use_prev_action=False, lstm_use_prev_reward=False, lstm_kernel_initializer=None, lstm_kernel_initializer_kwargs=None, lstm_bias_initializer=None, lstm_bias_initializer_kwargs=None), catalog_class=None, load_state_path=None, model_config_dict=None)", "algorithm_config_overrides_per_module": {}, "_per_module_overrides": {}, "_validate_config": true, "_use_msgpack_checkpoints": false, "_torch_grad_scaler_class": null, "_torch_lr_scheduler_classes": null, "_tf_policy_handles_more_than_one_loss": false, "_disable_preprocessor_api": false, "_disable_action_flattening": false, "_disable_initialize_loss_from_dummy_batch": false, "_dont_auto_sync_env_runner_states": false, "env_task_fn": -1, "enable_connectors": -1, "simple_optimizer": false, "policy_map_cache": -1, "worker_cls": -1, "synchronize_filters": -1, "enable_async_evaluation": -1, "custom_async_evaluation_function": -1, "_enable_rl_module_api": -1, "auto_wrap_old_gym_envs": -1, "always_attach_evaluation_results": -1, "replay_sequence_length": null, "_disable_execution_plan_api": -1, "use_critic": true, "use_gae": true, "use_kl_loss": true, "kl_coeff": 0.7464963036515, "kl_target": 0.0270990929592, "vf_loss_coeff": 0.6688075857018, "entropy_coeff": 0.0090570820258, "clip_param": 0.1221781641624, "vf_clip_param": 0.1027808522125, "entropy_coeff_schedule": null, "lr_schedule": null, "sgd_minibatch_size": -1, "vf_share_layers": -1, "__stdout_file__": null, "__stderr_file__": null, "lambda": 0.9099046732075, "input": "sampler", "policies": {"default_policy": [null, null, null, null]}, "callbacks": "<class 'ray.rllib.callbacks.callbacks.RLlibCallback'>", "create_env_on_driver": false, "custom_eval_function": null, "framework": "torch"}, "time_since_restore": 1.6363461017608643, "iterations_since_restore": 1, "perf": {"cpu_util_percent": 23.433333333333334, "ram_util_percent": 74.60000000000001}}
{"timers": {"training_iteration": 1.532273607791867, "restore_env_runners": 7.989115547388792e-06, "training_step": 1.5321420703059994, "env_runner_sampling_timer": 1.4259296767413616, "learner_update_timer": 0.10312738878070378, "synch_weights": 0.0006168570963200182, "restore_eval_env_runners": 8.95792618393898e-06, "evaluation_iteration": 0.10286654101219028, "synch_eval_env_connectors": 0.00012112502008676529, "synch_env_connectors": 4.582921974360943e-06}, "env_runners": {"env_to_module_connector": {"timers": {"connectors": {"numpy_to_tensor": 8.603894789090616e-06, "add_states_from_episodes_to_batch": 1.7356323145425175e-06, "batch_individual_items": 6.422320841159714e-06, "add_observations_from_episodes_to_batch": 2.9554005768088543e-06, "add_time_dim_to_batch_and_zero_pad": 2.338094809035779e-06}}, "connector_pipeline_timer": 4.4185659974195666e-05}, "num_agent_steps_sampled_lifetime": {"default_agent": 10000.0}, "env_to_module_sum_episodes_length_out": 10.36823839457432, "num_episodes": 250.0, "episode_len_max": 20, "num_module_steps_sampled": {"default_policy": 5000.0}, "module_to_env_connector": {"timers": {"connectors": {"un_batch_to_individual_items": 5.413140299918185e-06, "listify_data_for_vector_env": 1.0915863699602904e-05, "normalize_and_clip_actions": 9.443867959817633e-06, "get_actions": 3.819550062670449e-05, "tensor_to_numpy": 1.3181091755438725e-05, "remove_single_ts_time_rank_from_batch": 5.906535273665704e-07}}, "connector_pipeline_timer": 0.00010394850360403424}, "num_module_steps_sampled_lifetime": {"default_policy": 10000.0}, "num_episodes_lifetime": 500.0, "episode_len_min": 20, "episode_return_max": 6.5, "env_to_module_sum_episodes_length_in": 10.36823839457432, "env_step_timer": 1.4112966671849345e-05, "sample": 0.005115013465898416, "rlmodule_inference_timer": 2.7819377463327117e-05, "episode_duration_sec_mean": 0.004573027502279728, "episode_return_mean": -3.8199999999999994, "module_episode_returns_mean": {"default_policy": -3.8199999999999994}, "env_reset_timer": 3.3298028587639375e-05, "num_env_steps_sampled_lifetime": 10000.0, "num_env_steps_sampled": 5000.0, "episode_return_min": -13.5, "episode_len_mean": 20.0, "weights_seq_no": 1.0, "num_agent_steps_sampled": {"default_agent": 5000.0}, "time_between_sampling": 0.0014138237619044783, "agent_episode_returns_mean": {"default_agent": -3.8199999999999994}, "num_env_steps_sampled_lifetime_throughput": 3812.1487662931877}, "learners": {"default_policy": {"policy_loss": -0.13185341656208038, "vf_loss": 0.10278083384037018, "vf_loss_unclipped": 29.594585418701172, "num_module_steps_trained": 6000, "diff_num_grad_updates_vs_sampler_policy": 1.0, "default_optimizer_learning_rate": 0.0002847858517, "weights_seq_no": 2.0, "total_loss": -0.06935101747512817, "vf_explained_var": -0.011589646339416504, "module_train_batch_size_mean": 1000.0, "num_module_steps_trained_lifetime": 12000, "gradients_default_optimizer_global_norm": 0.14527708292007446, "entropy": 0.6920329928398132, "curr_entropy_coeff": 0.0090570820258, "num_trainable_parameters": 6003, "curr_kl_coeff": 0.18662407994270325, "mean_kl_loss": 7.931759319035336e-05, "num_module_steps_trained_lifetime_throughput": 443460.8311139553}, "__all_modules__": {"learner_connector": {"timers": {"connectors": {"batch_individual_items": 0.030687823354965074, "add_observations_from_episodes_to_batch": 0.0007744255242869257, "add_columns_from_episodes_to_train_batch": 0.03356110329274088, "general_advantage_estimation": 0.006306365175405517, "add_time_dim_to_batch_and_zero_pad": 8.869050070643425e-06, "numpy_to_tensor": 6.279089953750372e-05, "add_states_from_episodes_to_batch": 3.046421334147453e-06, "add_one_ts_to_episodes_and_truncate": 0.007466179898474366}}, "connector_pipeline_timer": 0.07897847313899548}, "num_trainable_parameters": 6003, "num_env_steps_trained_lifetime": 63000, "num_module_steps_trained": 6000, "num_non_trainable_parameters": 0, "num_env_steps_trained": 31500, "num_module_steps_trained_lifetime": 12000, "learner_connector_sum_episodes_length_in": 5000.0, "learner_connector_sum_episodes_length_out": 5250.0, "num_env_steps_trained_lifetime_throughput": 2309934.994382676, "num_module_steps_trained_throughput": 442218.878181376, "num_module_steps_trained_lifetime_throughput": 441309.234332145}}, "num_training_step_calls_per_iteration": 1, "evaluation": {"env_runners": {"module_to_env_connector": {"connector_pipeline_timer": 9.657925984862115e-05, "timers": {"connectors": {"listify_data_for_vector_env": 1.0653425826770305e-05, "get_actions": 3.381107388962861e-05, "remove_single_ts_time_rank_from_batch": 5.554437352379993e-07, "tensor_to_numpy": 1.2326239561091965e-05, "un_batch_to_individual_items": 5.250212816230183e-06, "normalize_and_clip_actions": 9.17323703746319e-06}}}, "num_episodes_lifetime": 40, "num_module_steps_sampled": {"default_policy": 400}, "env_to_module_sum_episodes_length_in": 10.366003441359926, "env_to_module_connector": {"timers": {"connectors": {"numpy_to_tensor": 8.053222330131023e-06, "add_states_from_episodes_to_batch": 1.510826765363337e-06, "add_time_dim_to_batch_and_zero_pad": 2.1193082047870006e-06, "batch_individual_items": 5.984973878601183e-06, "add_observations_from_episodes_to_batch": 2.747465788204373e-06}}, "connector_pipeline_timer": 4.134786012154525e-05}, "module_episode_returns_mean": {"default_policy": -1.8}, "agent_episode_returns_mean": {"default_agent": -1.8}, "env_to_module_sum_episodes_length_out": 10.366003441359926, "episode_len_max": 20, "num_agent_steps_sampled": {"default_agent": 400}, "num_module_steps_sampled_lifetime": {"default_policy": 800}, "episode_return_max": 13.5, "sample": 0.09653448997647501, "rlmodule_inference_timer": 2.5944784865987243e-05, "env_reset_timer": 0.00022615043562836945, "episode_len_mean": 20.0, "weights_seq_no": 2.0, "episode_len_min": 20, "episode_duration_sec_mean": 0.004379055160097778, "episode_return_mean": -1.8, "num_env_steps_sampled": 400, "episode_return_min": -15.5, "num_agent_steps_sampled_lifetime": {"default_agent": 800}, "num_episodes": 20, "env_step_timer": 1.35799362399589e-05, "num_env_steps_sampled_lifetime": 10400, "time_between_sampling": 1.5964790829457343}, "num_healthy_workers": 1, "actor_manager_num_outstanding_async_reqs": 0, "num_remote_worker_restarts": 0}, "num_env_steps_sampled_lifetime": 10000.0, "fault_tolerance": {"num_healthy_workers": 0, "num_remote_worker_restarts": 0}, "env_runner_group": {"actor_manager_num_outstanding_async_reqs": 0}, "done": false, "training_iteration": 2, "trial_id": "4649a_00000", "date": "2025-08-11_19-36-13", "timestamp": 1754933773, "time_this_iter_s": 1.6745591163635254, "time_total_s": 3.3109052181243896, "pid": 28167, "hostname": "Mac", "node_ip": "127.0.0.1", "config": {"exploration_config": {}, "extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "placement_strategy": "PACK", "num_gpus": 0, "_fake_gpus": false, "num_cpus_for_main_process": 2, "eager_tracing": true, "eager_max_retraces": 20, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "torch_compile_learner": false, "torch_compile_learner_what_to_compile": "forward_train", "torch_compile_learner_dynamo_backend": "aot_eager", "torch_compile_learner_dynamo_mode": null, "torch_compile_worker": false, "torch_compile_worker_dynamo_backend": "aot_eager", "torch_compile_worker_dynamo_mode": null, "torch_ddp_kwargs": {}, "torch_skip_nan_gradients": false, "env": "Umbrella", "env_config": {}, "observation_space": null, "action_space": null, "clip_rewards": null, "normalize_actions": true, "clip_actions": false, "_is_atari": null, "disable_env_checking": false, "render_env": false, "action_mask_key": "action_mask", "env_runner_cls": null, "num_env_runners": 0, "create_local_env_runner": true, "num_envs_per_env_runner": 1, "gym_env_vectorize_mode": "SYNC", "num_cpus_per_env_runner": 1, "num_gpus_per_env_runner": 0, "custom_resources_per_env_runner": {}, "validate_env_runners_after_construction": true, "episodes_to_numpy": true, "max_requests_in_flight_per_env_runner": 1, "sample_timeout_s": 60.0, "_env_to_module_connector": null, "add_default_connectors_to_env_to_module_pipeline": true, "_module_to_env_connector": null, "add_default_connectors_to_module_to_env_pipeline": true, "merge_env_runner_states": "training_only", "broadcast_env_runner_states": true, "episode_lookback_horizon": 1, "rollout_fragment_length": "auto", "batch_mode": "complete_episodes", "compress_observations": false, "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "enable_tf1_exec_eagerly": false, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "preprocessor_pref": "deepmind", "observation_filter": "NoFilter", "update_worker_filter_stats": true, "use_worker_filter_stats": true, "sampler_perf_stats_ema_coef": null, "_is_online": true, "num_learners": 0, "num_gpus_per_learner": 0, "num_cpus_per_learner": "auto", "num_aggregator_actors_per_learner": 0, "max_requests_in_flight_per_aggregator_actor": 3, "local_gpu_idx": 0, "max_requests_in_flight_per_learner": 3, "gamma": 1, "lr": 0.0002847858517, "grad_clip": 0.5, "grad_clip_by": "global_norm", "_train_batch_size_per_learner": 5000, "train_batch_size": 4000, "num_epochs": 1, "minibatch_size": 1000, "shuffle_batch_per_epoch": true, "model": {"fcnet_hiddens": [256, 256], "fcnet_activation": "tanh", "fcnet_weights_initializer": null, "fcnet_weights_initializer_config": null, "fcnet_bias_initializer": null, "fcnet_bias_initializer_config": null, "conv_filters": null, "conv_activation": "relu", "conv_kernel_initializer": null, "conv_kernel_initializer_config": null, "conv_bias_initializer": null, "conv_bias_initializer_config": null, "conv_transpose_kernel_initializer": null, "conv_transpose_kernel_initializer_config": null, "conv_transpose_bias_initializer": null, "conv_transpose_bias_initializer_config": null, "post_fcnet_hiddens": [], "post_fcnet_activation": "relu", "post_fcnet_weights_initializer": null, "post_fcnet_weights_initializer_config": null, "post_fcnet_bias_initializer": null, "post_fcnet_bias_initializer_config": null, "free_log_std": false, "log_std_clip_param": 20.0, "no_final_linear": false, "vf_share_layers": false, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "lstm_weights_initializer": null, "lstm_weights_initializer_config": null, "lstm_bias_initializer": null, "lstm_bias_initializer_config": null, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "attention_use_n_prev_actions": 0, "attention_use_n_prev_rewards": 0, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": null, "custom_model_config": {}, "custom_action_dist": null, "custom_preprocessor": null, "encoder_latent_dim": null, "always_check_shapes": false, "lstm_use_prev_action_reward": -1, "_use_default_native_models": -1, "_disable_preprocessor_api": false, "_disable_action_flattening": false}, "_learner_connector": null, "add_default_connectors_to_learner_pipeline": true, "learner_config_dict": {}, "optimizer": {}, "_learner_class": null, "callbacks_on_algorithm_init": null, "callbacks_on_env_runners_recreated": null, "callbacks_on_offline_eval_runners_recreated": null, "callbacks_on_checkpoint_loaded": null, "callbacks_on_environment_created": null, "callbacks_on_episode_created": null, "callbacks_on_episode_start": null, "callbacks_on_episode_step": null, "callbacks_on_episode_end": null, "callbacks_on_evaluate_start": null, "callbacks_on_evaluate_end": null, "callbacks_on_evaluate_offline_start": null, "callbacks_on_evaluate_offline_end": null, "callbacks_on_sample_end": null, "callbacks_on_train_result": null, "explore": true, "enable_rl_module_and_learner": true, "enable_env_runner_and_connector_v2": true, "_prior_exploration_config": {"type": "StochasticSampling"}, "count_steps_by": "env_steps", "policy_map_capacity": 100, "policy_mapping_fn": "<function AlgorithmConfig.DEFAULT_POLICY_MAPPING_FN at 0x17c065b20>", "policies_to_train": null, "policy_states_are_swappable": false, "observation_fn": null, "offline_data_class": null, "input_read_method": "read_parquet", "input_read_method_kwargs": {}, "input_read_schema": {}, "input_read_episodes": false, "input_read_sample_batches": false, "input_read_batch_size": null, "input_filesystem": null, "input_filesystem_kwargs": {}, "input_compress_columns": ["obs", "new_obs"], "input_spaces_jsonable": true, "materialize_data": false, "materialize_mapped_data": true, "map_batches_kwargs": {}, "iter_batches_kwargs": {}, "ignore_final_observation": false, "prelearner_class": null, "prelearner_buffer_class": null, "prelearner_buffer_kwargs": {}, "prelearner_module_synch_period": 10, "dataset_num_iters_per_learner": null, "input_config": {}, "actions_in_input_normalized": false, "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_config": {}, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "output_max_rows_per_file": null, "output_write_remaining_data": false, "output_write_method": "write_parquet", "output_write_method_kwargs": {}, "output_filesystem": null, "output_filesystem_kwargs": {}, "output_write_episodes": true, "offline_sampling": false, "evaluation_interval": 1, "evaluation_duration": 20, "evaluation_duration_unit": "episodes", "evaluation_sample_timeout_s": 120.0, "evaluation_auto_duration_min_env_steps_per_sample": 100, "evaluation_auto_duration_max_env_steps_per_sample": 2000, "evaluation_parallel_to_training": false, "evaluation_force_reset_envs_before_iteration": true, "evaluation_config": null, "off_policy_estimation_methods": {}, "ope_split_batch_by_episode": true, "evaluation_num_env_runners": 1, "in_evaluation": false, "sync_filters_on_rollout_workers_timeout_s": 10.0, "offline_evaluation_interval": null, "num_offline_eval_runners": 0, "offline_loss_for_module_fn": null, "offline_evaluation_duration": 1, "offline_evaluation_parallel_to_training": false, "offline_evaluation_timeout_s": 120.0, "num_cpus_per_offline_eval_runner": 1, "num_gpus_per_offline_eval_runner": 0, "custom_resources_per_offline_eval_runner": {}, "restart_failed_offline_eval_runners": true, "ignore_offline_eval_runner_failures": false, "max_num_offline_eval_runner_restarts": 1000, "offline_eval_runner_restore_timeout_s": 1800.0, "max_requests_in_flight_per_offline_eval_runner": 1, "validate_offline_eval_runners_after_construction": true, "offline_eval_runner_health_probe_timeout_s": 30.0, "offline_eval_rl_module_inference_only": false, "broadcast_offline_eval_runner_states": false, "offline_eval_batch_size_per_runner": 256, "dataset_num_iters_per_eval_runner": 1, "keep_per_episode_custom_metrics": false, "metrics_episode_collection_timeout_s": 60.0, "metrics_num_episodes_for_smoothing": 100, "min_time_s_per_iteration": null, "min_train_timesteps_per_iteration": 0, "min_sample_timesteps_per_iteration": 0, "log_gradients": true, "export_native_model_files": false, "checkpoint_trainable_policies_only": false, "logger_creator": null, "logger_config": null, "log_level": "WARN", "log_sys_usage": true, "fake_sampler": false, "seed": 5, "restart_failed_env_runners": true, "ignore_env_runner_failures": false, "max_num_env_runner_restarts": 1000, "delay_between_env_runner_restarts_s": 60.0, "restart_failed_sub_environments": false, "num_consecutive_env_runner_failures_tolerance": 100, "env_runner_health_probe_timeout_s": 30.0, "env_runner_restore_timeout_s": 1800.0, "_model_config": {}, "_rl_module_spec": "RLModuleSpec(module_class=None, observation_space=None, action_space=None, inference_only=False, learner_only=False, model_config=DefaultModelConfig(fcnet_hiddens=[60, 90], fcnet_activation='tanh', fcnet_kernel_initializer=None, fcnet_kernel_initializer_kwargs=None, fcnet_bias_initializer=None, fcnet_bias_initializer_kwargs=None, conv_filters=None, conv_activation='relu', conv_kernel_initializer=None, conv_kernel_initializer_kwargs=None, conv_bias_initializer=None, conv_bias_initializer_kwargs=None, head_fcnet_hiddens=[], head_fcnet_activation='relu', head_fcnet_kernel_initializer=None, head_fcnet_kernel_initializer_kwargs=None, head_fcnet_bias_initializer=None, head_fcnet_bias_initializer_kwargs=None, free_log_std=False, log_std_clip_param=20.0, vf_share_layers=True, use_lstm=False, max_seq_len=20, lstm_cell_size=256, lstm_use_prev_action=False, lstm_use_prev_reward=False, lstm_kernel_initializer=None, lstm_kernel_initializer_kwargs=None, lstm_bias_initializer=None, lstm_bias_initializer_kwargs=None), catalog_class=None, load_state_path=None, model_config_dict=None)", "algorithm_config_overrides_per_module": {}, "_per_module_overrides": {}, "_validate_config": true, "_use_msgpack_checkpoints": false, "_torch_grad_scaler_class": null, "_torch_lr_scheduler_classes": null, "_tf_policy_handles_more_than_one_loss": false, "_disable_preprocessor_api": false, "_disable_action_flattening": false, "_disable_initialize_loss_from_dummy_batch": false, "_dont_auto_sync_env_runner_states": false, "env_task_fn": -1, "enable_connectors": -1, "simple_optimizer": false, "policy_map_cache": -1, "worker_cls": -1, "synchronize_filters": -1, "enable_async_evaluation": -1, "custom_async_evaluation_function": -1, "_enable_rl_module_api": -1, "auto_wrap_old_gym_envs": -1, "always_attach_evaluation_results": -1, "replay_sequence_length": null, "_disable_execution_plan_api": -1, "use_critic": true, "use_gae": true, "use_kl_loss": true, "kl_coeff": 0.7464963036515, "kl_target": 0.0270990929592, "vf_loss_coeff": 0.6688075857018, "entropy_coeff": 0.0090570820258, "clip_param": 0.1221781641624, "vf_clip_param": 0.1027808522125, "entropy_coeff_schedule": null, "lr_schedule": null, "sgd_minibatch_size": -1, "vf_share_layers": -1, "__stdout_file__": null, "__stderr_file__": null, "lambda": 0.9099046732075, "input": "sampler", "policies": {"default_policy": [null, null, null, null]}, "callbacks": "<class 'ray.rllib.callbacks.callbacks.RLlibCallback'>", "create_env_on_driver": false, "custom_eval_function": null, "framework": "torch"}, "time_since_restore": 3.3109052181243896, "iterations_since_restore": 2, "perf": {"cpu_util_percent": 33.95, "ram_util_percent": 74.6}}
{"timers": {"training_iteration": 1.5342562879645498, "restore_env_runners": 7.973804627545178e-06, "training_step": 1.5341241187723584, "env_runner_sampling_timer": 1.4279734458040911, "learner_update_timer": 0.10305940697287444, "synch_weights": 0.0006203314451151528, "restore_eval_env_runners": 8.951687486842275e-06, "evaluation_iteration": 0.10282835935126058, "synch_eval_env_connectors": 0.000121028769062832, "synch_env_connectors": 4.582513356581331e-06}, "env_runners": {"env_to_module_connector": {"timers": {"connectors": {"numpy_to_tensor": 1.0972642418420924e-05, "add_states_from_episodes_to_batch": 1.8945872620320642e-06, "batch_individual_items": 7.099831342166895e-06, "add_observations_from_episodes_to_batch": 3.365668026818809e-06, "add_time_dim_to_batch_and_zero_pad": 2.591844022140288e-06}}, "connector_pipeline_timer": 4.986840323633267e-05}, "num_agent_steps_sampled_lifetime": {"default_agent": -607500.0}, "env_to_module_sum_episodes_length_out": 10.36823839457432, "num_episodes": 250.0, "episode_len_max": 20, "num_module_steps_sampled": {"default_policy": 5000.0}, "module_to_env_connector": {"timers": {"connectors": {"un_batch_to_individual_items": 6.183773040616189e-06, "listify_data_for_vector_env": 1.2171184098812283e-05, "normalize_and_clip_actions": 1.0417522017302948e-05, "get_actions": 4.530863976451915e-05, "tensor_to_numpy": 1.4970056566875942e-05, "remove_single_ts_time_rank_from_batch": 6.661038348705923e-07}}, "connector_pipeline_timer": 0.00011888353541830696}, "num_module_steps_sampled_lifetime": {"default_policy": -607500.0}, "num_episodes_lifetime": -30375.0, "episode_len_min": 20, "episode_return_max": 6.5, "env_to_module_sum_episodes_length_in": 10.36823839457432, "env_step_timer": 1.566596337719331e-05, "sample": 0.005434138050042915, "rlmodule_inference_timer": 3.749756285654117e-05, "episode_duration_sec_mean": 0.005361148708034305, "episode_return_mean": -2.0599999999999996, "module_episode_returns_mean": {"default_policy": -2.0599999999999996}, "env_reset_timer": 4.082921735916418e-05, "num_env_steps_sampled_lifetime": -607500.0, "num_env_steps_sampled": 5000.0, "episode_return_min": -13.5, "episode_len_mean": 20.0, "weights_seq_no": 2.0, "num_agent_steps_sampled": {"default_agent": 5000.0}, "time_between_sampling": 0.0018762860346310383, "agent_episode_returns_mean": {"default_agent": -2.0599999999999996}, "num_env_steps_sampled_lifetime_throughput": 3466.249380025856}, "learners": {"default_policy": {"policy_loss": 0.21789036691188812, "vf_loss": 0.10278083384037018, "vf_loss_unclipped": 31.712276458740234, "num_module_steps_trained": 6000, "diff_num_grad_updates_vs_sampler_policy": 1.0, "default_optimizer_learning_rate": 0.0002847858517, "weights_seq_no": 3.0, "total_loss": 0.2806500792503357, "vf_explained_var": -0.009776949882507324, "module_train_batch_size_mean": 1000.0, "num_module_steps_trained_lifetime": 18000, "gradients_default_optimizer_global_norm": 0.11601883918046951, "entropy": 0.6897167563438416, "curr_entropy_coeff": 0.0090570820258, "num_trainable_parameters": 6003, "curr_kl_coeff": 0.09331203997135162, "mean_kl_loss": 0.0014248319203034043, "num_module_steps_trained_lifetime_throughput": 443464.36872010084}, "__all_modules__": {"learner_connector": {"timers": {"connectors": {"batch_individual_items": 0.030693530961417123, "add_observations_from_episodes_to_batch": 0.0007748975190334022, "add_columns_from_episodes_to_train_batch": 0.03356769143007696, "general_advantage_estimation": 0.0062999644440482365, "add_time_dim_to_batch_and_zero_pad": 9.041190426796675e-06, "numpy_to_tensor": 6.27975704614073e-05, "add_states_from_episodes_to_batch": 3.0517874285578723e-06, "add_one_ts_to_episodes_and_truncate": 0.007469054759736173}}, "connector_pipeline_timer": 0.0789878413273953}, "num_trainable_parameters": 6003, "num_env_steps_trained_lifetime": 94500, "num_module_steps_trained": 6000, "num_non_trainable_parameters": 0, "num_env_steps_trained": 31500, "num_module_steps_trained_lifetime": 18000, "learner_connector_sum_episodes_length_in": 5000.0, "learner_connector_sum_episodes_length_out": 5250.0, "num_env_steps_trained_lifetime_throughput": 2310449.895509929, "num_module_steps_trained_throughput": 442269.43529270985, "num_module_steps_trained_lifetime_throughput": 441376.8424228227}}, "num_training_step_calls_per_iteration": 1, "evaluation": {"env_runners": {"module_to_env_connector": {"connector_pipeline_timer": 9.73829834993376e-05, "timers": {"connectors": {"listify_data_for_vector_env": 1.0735552041790965e-05, "get_actions": 3.438163488697536e-05, "remove_single_ts_time_rank_from_batch": 5.534735732357352e-07, "tensor_to_numpy": 1.236718130473742e-05, "un_batch_to_individual_items": 5.278662533587605e-06, "normalize_and_clip_actions": 9.229074166748283e-06}}}, "num_episodes_lifetime": 60, "num_module_steps_sampled": {"default_policy": 400}, "env_to_module_sum_episodes_length_in": 10.368205581254823, "env_to_module_connector": {"timers": {"connectors": {"numpy_to_tensor": 8.078284870516539e-06, "add_states_from_episodes_to_batch": 1.5296351809901358e-06, "add_time_dim_to_batch_and_zero_pad": 2.151320049963092e-06, "batch_individual_items": 6.081478813274562e-06, "add_observations_from_episodes_to_batch": 2.7854579688136906e-06}}, "connector_pipeline_timer": 4.177529275347219e-05}, "module_episode_returns_mean": {"default_policy": -0.9666666666666667}, "agent_episode_returns_mean": {"default_agent": -0.9666666666666667}, "env_to_module_sum_episodes_length_out": 10.368205581254823, "episode_len_max": 20, "num_agent_steps_sampled": {"default_agent": 400}, "num_module_steps_sampled_lifetime": {"default_policy": 1200}, "episode_return_max": 13.5, "sample": 0.09652983424746198, "rlmodule_inference_timer": 2.6284856319999465e-05, "env_reset_timer": 0.0002246160113136284, "episode_len_mean": 20.0, "weights_seq_no": 3.0, "episode_len_min": 20, "episode_duration_sec_mean": 0.004388534009922296, "episode_return_mean": -0.9666666666666667, "num_env_steps_sampled": 400, "episode_return_min": -15.5, "num_agent_steps_sampled_lifetime": {"default_agent": 1200}, "num_episodes": 20, "env_step_timer": 1.3772915939000394e-05, "num_env_steps_sampled_lifetime": 15400, "time_between_sampling": 1.5979944429453463}, "num_healthy_workers": 1, "actor_manager_num_outstanding_async_reqs": 0, "num_remote_worker_restarts": 0}, "num_env_steps_sampled_lifetime": -607500.0, "fault_tolerance": {"num_healthy_workers": 0, "num_remote_worker_restarts": 0}, "env_runner_group": {"actor_manager_num_outstanding_async_reqs": 0}, "done": false, "training_iteration": 3, "trial_id": "4649a_00000", "date": "2025-08-11_19-36-15", "timestamp": 1754933775, "time_this_iter_s": 1.8338041305541992, "time_total_s": 5.144709348678589, "pid": 28167, "hostname": "Mac", "node_ip": "127.0.0.1", "config": {"exploration_config": {}, "extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "placement_strategy": "PACK", "num_gpus": 0, "_fake_gpus": false, "num_cpus_for_main_process": 2, "eager_tracing": true, "eager_max_retraces": 20, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "torch_compile_learner": false, "torch_compile_learner_what_to_compile": "forward_train", "torch_compile_learner_dynamo_backend": "aot_eager", "torch_compile_learner_dynamo_mode": null, "torch_compile_worker": false, "torch_compile_worker_dynamo_backend": "aot_eager", "torch_compile_worker_dynamo_mode": null, "torch_ddp_kwargs": {}, "torch_skip_nan_gradients": false, "env": "Umbrella", "env_config": {}, "observation_space": null, "action_space": null, "clip_rewards": null, "normalize_actions": true, "clip_actions": false, "_is_atari": null, "disable_env_checking": false, "render_env": false, "action_mask_key": "action_mask", "env_runner_cls": null, "num_env_runners": 0, "create_local_env_runner": true, "num_envs_per_env_runner": 1, "gym_env_vectorize_mode": "SYNC", "num_cpus_per_env_runner": 1, "num_gpus_per_env_runner": 0, "custom_resources_per_env_runner": {}, "validate_env_runners_after_construction": true, "episodes_to_numpy": true, "max_requests_in_flight_per_env_runner": 1, "sample_timeout_s": 60.0, "_env_to_module_connector": null, "add_default_connectors_to_env_to_module_pipeline": true, "_module_to_env_connector": null, "add_default_connectors_to_module_to_env_pipeline": true, "merge_env_runner_states": "training_only", "broadcast_env_runner_states": true, "episode_lookback_horizon": 1, "rollout_fragment_length": "auto", "batch_mode": "complete_episodes", "compress_observations": false, "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "enable_tf1_exec_eagerly": false, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "preprocessor_pref": "deepmind", "observation_filter": "NoFilter", "update_worker_filter_stats": true, "use_worker_filter_stats": true, "sampler_perf_stats_ema_coef": null, "_is_online": true, "num_learners": 0, "num_gpus_per_learner": 0, "num_cpus_per_learner": "auto", "num_aggregator_actors_per_learner": 0, "max_requests_in_flight_per_aggregator_actor": 3, "local_gpu_idx": 0, "max_requests_in_flight_per_learner": 3, "gamma": 1, "lr": 0.0002847858517, "grad_clip": 0.5, "grad_clip_by": "global_norm", "_train_batch_size_per_learner": 5000, "train_batch_size": 4000, "num_epochs": 1, "minibatch_size": 1000, "shuffle_batch_per_epoch": true, "model": {"fcnet_hiddens": [256, 256], "fcnet_activation": "tanh", "fcnet_weights_initializer": null, "fcnet_weights_initializer_config": null, "fcnet_bias_initializer": null, "fcnet_bias_initializer_config": null, "conv_filters": null, "conv_activation": "relu", "conv_kernel_initializer": null, "conv_kernel_initializer_config": null, "conv_bias_initializer": null, "conv_bias_initializer_config": null, "conv_transpose_kernel_initializer": null, "conv_transpose_kernel_initializer_config": null, "conv_transpose_bias_initializer": null, "conv_transpose_bias_initializer_config": null, "post_fcnet_hiddens": [], "post_fcnet_activation": "relu", "post_fcnet_weights_initializer": null, "post_fcnet_weights_initializer_config": null, "post_fcnet_bias_initializer": null, "post_fcnet_bias_initializer_config": null, "free_log_std": false, "log_std_clip_param": 20.0, "no_final_linear": false, "vf_share_layers": false, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "lstm_weights_initializer": null, "lstm_weights_initializer_config": null, "lstm_bias_initializer": null, "lstm_bias_initializer_config": null, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "attention_use_n_prev_actions": 0, "attention_use_n_prev_rewards": 0, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": null, "custom_model_config": {}, "custom_action_dist": null, "custom_preprocessor": null, "encoder_latent_dim": null, "always_check_shapes": false, "lstm_use_prev_action_reward": -1, "_use_default_native_models": -1, "_disable_preprocessor_api": false, "_disable_action_flattening": false}, "_learner_connector": null, "add_default_connectors_to_learner_pipeline": true, "learner_config_dict": {}, "optimizer": {}, "_learner_class": null, "callbacks_on_algorithm_init": null, "callbacks_on_env_runners_recreated": null, "callbacks_on_offline_eval_runners_recreated": null, "callbacks_on_checkpoint_loaded": null, "callbacks_on_environment_created": null, "callbacks_on_episode_created": null, "callbacks_on_episode_start": null, "callbacks_on_episode_step": null, "callbacks_on_episode_end": null, "callbacks_on_evaluate_start": null, "callbacks_on_evaluate_end": null, "callbacks_on_evaluate_offline_start": null, "callbacks_on_evaluate_offline_end": null, "callbacks_on_sample_end": null, "callbacks_on_train_result": null, "explore": true, "enable_rl_module_and_learner": true, "enable_env_runner_and_connector_v2": true, "_prior_exploration_config": {"type": "StochasticSampling"}, "count_steps_by": "env_steps", "policy_map_capacity": 100, "policy_mapping_fn": "<function AlgorithmConfig.DEFAULT_POLICY_MAPPING_FN at 0x17c065b20>", "policies_to_train": null, "policy_states_are_swappable": false, "observation_fn": null, "offline_data_class": null, "input_read_method": "read_parquet", "input_read_method_kwargs": {}, "input_read_schema": {}, "input_read_episodes": false, "input_read_sample_batches": false, "input_read_batch_size": null, "input_filesystem": null, "input_filesystem_kwargs": {}, "input_compress_columns": ["obs", "new_obs"], "input_spaces_jsonable": true, "materialize_data": false, "materialize_mapped_data": true, "map_batches_kwargs": {}, "iter_batches_kwargs": {}, "ignore_final_observation": false, "prelearner_class": null, "prelearner_buffer_class": null, "prelearner_buffer_kwargs": {}, "prelearner_module_synch_period": 10, "dataset_num_iters_per_learner": null, "input_config": {}, "actions_in_input_normalized": false, "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_config": {}, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "output_max_rows_per_file": null, "output_write_remaining_data": false, "output_write_method": "write_parquet", "output_write_method_kwargs": {}, "output_filesystem": null, "output_filesystem_kwargs": {}, "output_write_episodes": true, "offline_sampling": false, "evaluation_interval": 1, "evaluation_duration": 20, "evaluation_duration_unit": "episodes", "evaluation_sample_timeout_s": 120.0, "evaluation_auto_duration_min_env_steps_per_sample": 100, "evaluation_auto_duration_max_env_steps_per_sample": 2000, "evaluation_parallel_to_training": false, "evaluation_force_reset_envs_before_iteration": true, "evaluation_config": null, "off_policy_estimation_methods": {}, "ope_split_batch_by_episode": true, "evaluation_num_env_runners": 1, "in_evaluation": false, "sync_filters_on_rollout_workers_timeout_s": 10.0, "offline_evaluation_interval": null, "num_offline_eval_runners": 0, "offline_loss_for_module_fn": null, "offline_evaluation_duration": 1, "offline_evaluation_parallel_to_training": false, "offline_evaluation_timeout_s": 120.0, "num_cpus_per_offline_eval_runner": 1, "num_gpus_per_offline_eval_runner": 0, "custom_resources_per_offline_eval_runner": {}, "restart_failed_offline_eval_runners": true, "ignore_offline_eval_runner_failures": false, "max_num_offline_eval_runner_restarts": 1000, "offline_eval_runner_restore_timeout_s": 1800.0, "max_requests_in_flight_per_offline_eval_runner": 1, "validate_offline_eval_runners_after_construction": true, "offline_eval_runner_health_probe_timeout_s": 30.0, "offline_eval_rl_module_inference_only": false, "broadcast_offline_eval_runner_states": false, "offline_eval_batch_size_per_runner": 256, "dataset_num_iters_per_eval_runner": 1, "keep_per_episode_custom_metrics": false, "metrics_episode_collection_timeout_s": 60.0, "metrics_num_episodes_for_smoothing": 100, "min_time_s_per_iteration": null, "min_train_timesteps_per_iteration": 0, "min_sample_timesteps_per_iteration": 0, "log_gradients": true, "export_native_model_files": false, "checkpoint_trainable_policies_only": false, "logger_creator": null, "logger_config": null, "log_level": "WARN", "log_sys_usage": true, "fake_sampler": false, "seed": 5, "restart_failed_env_runners": true, "ignore_env_runner_failures": false, "max_num_env_runner_restarts": 1000, "delay_between_env_runner_restarts_s": 60.0, "restart_failed_sub_environments": false, "num_consecutive_env_runner_failures_tolerance": 100, "env_runner_health_probe_timeout_s": 30.0, "env_runner_restore_timeout_s": 1800.0, "_model_config": {}, "_rl_module_spec": "RLModuleSpec(module_class=None, observation_space=None, action_space=None, inference_only=False, learner_only=False, model_config=DefaultModelConfig(fcnet_hiddens=[60, 90], fcnet_activation='tanh', fcnet_kernel_initializer=None, fcnet_kernel_initializer_kwargs=None, fcnet_bias_initializer=None, fcnet_bias_initializer_kwargs=None, conv_filters=None, conv_activation='relu', conv_kernel_initializer=None, conv_kernel_initializer_kwargs=None, conv_bias_initializer=None, conv_bias_initializer_kwargs=None, head_fcnet_hiddens=[], head_fcnet_activation='relu', head_fcnet_kernel_initializer=None, head_fcnet_kernel_initializer_kwargs=None, head_fcnet_bias_initializer=None, head_fcnet_bias_initializer_kwargs=None, free_log_std=False, log_std_clip_param=20.0, vf_share_layers=True, use_lstm=False, max_seq_len=20, lstm_cell_size=256, lstm_use_prev_action=False, lstm_use_prev_reward=False, lstm_kernel_initializer=None, lstm_kernel_initializer_kwargs=None, lstm_bias_initializer=None, lstm_bias_initializer_kwargs=None), catalog_class=None, load_state_path=None, model_config_dict=None)", "algorithm_config_overrides_per_module": {}, "_per_module_overrides": {}, "_validate_config": true, "_use_msgpack_checkpoints": false, "_torch_grad_scaler_class": null, "_torch_lr_scheduler_classes": null, "_tf_policy_handles_more_than_one_loss": false, "_disable_preprocessor_api": false, "_disable_action_flattening": false, "_disable_initialize_loss_from_dummy_batch": false, "_dont_auto_sync_env_runner_states": false, "env_task_fn": -1, "enable_connectors": -1, "simple_optimizer": false, "policy_map_cache": -1, "worker_cls": -1, "synchronize_filters": -1, "enable_async_evaluation": -1, "custom_async_evaluation_function": -1, "_enable_rl_module_api": -1, "auto_wrap_old_gym_envs": -1, "always_attach_evaluation_results": -1, "replay_sequence_length": null, "_disable_execution_plan_api": -1, "use_critic": true, "use_gae": true, "use_kl_loss": true, "kl_coeff": 0.7464963036515, "kl_target": 0.0270990929592, "vf_loss_coeff": 0.6688075857018, "entropy_coeff": 0.0090570820258, "clip_param": 0.1221781641624, "vf_clip_param": 0.1027808522125, "entropy_coeff_schedule": null, "lr_schedule": null, "sgd_minibatch_size": -1, "vf_share_layers": -1, "__stdout_file__": null, "__stderr_file__": null, "lambda": 0.9099046732075, "input": "sampler", "policies": {"default_policy": [null, null, null, null]}, "callbacks": "<class 'ray.rllib.callbacks.callbacks.RLlibCallback'>", "create_env_on_driver": false, "custom_eval_function": null, "framework": "torch"}, "time_since_restore": 5.144709348678589, "iterations_since_restore": 3, "perf": {"cpu_util_percent": 45.0, "ram_util_percent": 75.83333333333333}}
{"timers": {"training_iteration": 1.534377434254903, "restore_env_runners": 7.957816775655374e-06, "training_step": 1.534244864244428, "env_runner_sampling_timer": 1.42821624050549, "learner_update_timer": 0.10293797582357972, "synch_weights": 0.0006197493806843413, "restore_eval_env_runners": 9.230080281849951e-06, "evaluation_iteration": 0.10281191367768915, "synch_eval_env_connectors": 0.00012095848073950038, "synch_env_connectors": 4.586268344428391e-06}, "env_runners": {"env_to_module_connector": {"timers": {"connectors": {"numpy_to_tensor": 8.415346974248734e-06, "add_states_from_episodes_to_batch": 1.7124743841798462e-06, "batch_individual_items": 6.266122134132891e-06, "add_observations_from_episodes_to_batch": 2.984048752538308e-06, "add_time_dim_to_batch_and_zero_pad": 2.2862074944550626e-06}}, "connector_pipeline_timer": 4.35590927214367e-05}, "num_agent_steps_sampled_lifetime": {"default_agent": -1225000.0}, "env_to_module_sum_episodes_length_out": 10.36823839457432, "num_episodes": 250.0, "episode_len_max": 20, "num_module_steps_sampled": {"default_policy": 5000.0}, "module_to_env_connector": {"timers": {"connectors": {"un_batch_to_individual_items": 5.325658596320066e-06, "listify_data_for_vector_env": 1.0719733127009043e-05, "normalize_and_clip_actions": 9.237391928663997e-06, "get_actions": 3.723894889181563e-05, "tensor_to_numpy": 1.2808544349210457e-05, "remove_single_ts_time_rank_from_batch": 5.78397418440277e-07}}, "connector_pipeline_timer": 0.00010159925856896344}, "num_module_steps_sampled_lifetime": {"default_policy": -1225000.0}, "num_episodes_lifetime": -61250.0, "episode_len_min": 20, "episode_return_max": 6.5, "env_to_module_sum_episodes_length_in": 10.36823839457432, "env_step_timer": 1.373298425966219e-05, "sample": 0.005196649111421188, "rlmodule_inference_timer": 2.6767149498825987e-05, "episode_duration_sec_mean": 0.004475016658660025, "episode_return_mean": -3.0199999999999996, "module_episode_returns_mean": {"default_policy": -3.0199999999999996}, "env_reset_timer": 3.942130167525928e-05, "num_env_steps_sampled_lifetime": -1225000.0, "num_env_steps_sampled": 5000.0, "episode_return_min": -13.5, "episode_len_mean": 20.0, "weights_seq_no": 3.0, "num_agent_steps_sampled": {"default_agent": 5000.0}, "time_between_sampling": 0.0018847047928678645, "agent_episode_returns_mean": {"default_agent": -3.0199999999999996}, "num_env_steps_sampled_lifetime_throughput": 3741.59315830168}, "learners": {"default_policy": {"policy_loss": -0.29342687129974365, "vf_loss": 0.10278083384037018, "vf_loss_unclipped": 27.08785629272461, "num_module_steps_trained": 6000, "diff_num_grad_updates_vs_sampler_policy": 1.0, "default_optimizer_learning_rate": 0.0002847858517, "weights_seq_no": 4.0, "total_loss": -0.23051778972148895, "vf_explained_var": -0.01489114761352539, "module_train_batch_size_mean": 1000.0, "num_module_steps_trained_lifetime": 24000, "gradients_default_optimizer_global_norm": 0.11352477222681046, "entropy": 0.6764528751373291, "curr_entropy_coeff": 0.0090570820258, "num_trainable_parameters": 6003, "curr_kl_coeff": 0.04665601998567581, "mean_kl_loss": 0.003163272514939308, "num_module_steps_trained_lifetime_throughput": 443630.10584251425}, "__all_modules__": {"learner_connector": {"timers": {"connectors": {"batch_individual_items": 0.030693198151716374, "add_observations_from_episodes_to_batch": 0.0007750418728636577, "add_columns_from_episodes_to_train_batch": 0.033567042845640334, "general_advantage_estimation": 0.006289688969407813, "add_time_dim_to_batch_and_zero_pad": 9.052448679693043e-06, "numpy_to_tensor": 6.264959491929039e-05, "add_states_from_episodes_to_batch": 3.0608495995402334e-06, "add_one_ts_to_episodes_and_truncate": 0.0074701192127189136}}, "connector_pipeline_timer": 0.07897739666397031}, "num_trainable_parameters": 6003, "num_env_steps_trained_lifetime": 126000, "num_module_steps_trained": 6000, "num_non_trainable_parameters": 0, "num_env_steps_trained": 31500, "num_module_steps_trained_lifetime": 24000, "learner_connector_sum_episodes_length_in": 5000.0, "learner_connector_sum_episodes_length_out": 5250.0, "num_env_steps_trained_lifetime_throughput": 2311913.163263943, "num_module_steps_trained_throughput": 442493.9374226967, "num_module_steps_trained_lifetime_throughput": 441620.035102903}}, "num_training_step_calls_per_iteration": 1, "evaluation": {"env_runners": {"module_to_env_connector": {"connector_pipeline_timer": 9.679606452495305e-05, "timers": {"connectors": {"listify_data_for_vector_env": 1.0781536674952668e-05, "get_actions": 3.393428182369718e-05, "remove_single_ts_time_rank_from_batch": 5.548197258363501e-07, "tensor_to_numpy": 1.2263636699081684e-05, "un_batch_to_individual_items": 5.244097368814292e-06, "normalize_and_clip_actions": 9.142188723820476e-06}}}, "num_episodes_lifetime": 80, "num_module_steps_sampled": {"default_policy": 400}, "env_to_module_sum_episodes_length_in": 10.368237912813044, "env_to_module_connector": {"timers": {"connectors": {"numpy_to_tensor": 7.998074705277572e-06, "add_states_from_episodes_to_batch": 1.5169430336992676e-06, "add_time_dim_to_batch_and_zero_pad": 2.1169052462912974e-06, "batch_individual_items": 5.989405571527116e-06, "add_observations_from_episodes_to_batch": 2.7588268210258107e-06}}, "connector_pipeline_timer": 4.140908094372082e-05}, "module_episode_returns_mean": {"default_policy": -1.05}, "agent_episode_returns_mean": {"default_agent": -1.05}, "env_to_module_sum_episodes_length_out": 10.368237912813044, "episode_len_max": 20, "num_agent_steps_sampled": {"default_agent": 400}, "num_module_steps_sampled_lifetime": {"default_policy": 1600}, "episode_return_max": 13.5, "sample": 0.09651125882504007, "rlmodule_inference_timer": 2.6076611350158918e-05, "env_reset_timer": 0.0002232056806149194, "episode_len_mean": 20.0, "weights_seq_no": 4.0, "episode_len_min": 20, "episode_duration_sec_mean": 0.0043777901111752724, "episode_return_mean": -1.05, "num_env_steps_sampled": 400, "episode_return_min": -15.5, "num_agent_steps_sampled_lifetime": {"default_agent": 1600}, "num_episodes": 20, "env_step_timer": 1.3691089689841562e-05, "num_env_steps_sampled_lifetime": 20400, "time_between_sampling": 1.5976394297656604}, "num_healthy_workers": 1, "actor_manager_num_outstanding_async_reqs": 0, "num_remote_worker_restarts": 0}, "num_env_steps_sampled_lifetime": -1225000.0, "fault_tolerance": {"num_healthy_workers": 0, "num_remote_worker_restarts": 0}, "env_runner_group": {"actor_manager_num_outstanding_async_reqs": 0}, "done": false, "training_iteration": 4, "trial_id": "4649a_00000", "date": "2025-08-11_19-36-17", "timestamp": 1754933777, "time_this_iter_s": 1.6476709842681885, "time_total_s": 6.792380332946777, "pid": 28167, "hostname": "Mac", "node_ip": "127.0.0.1", "config": {"exploration_config": {}, "extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "placement_strategy": "PACK", "num_gpus": 0, "_fake_gpus": false, "num_cpus_for_main_process": 2, "eager_tracing": true, "eager_max_retraces": 20, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "torch_compile_learner": false, "torch_compile_learner_what_to_compile": "forward_train", "torch_compile_learner_dynamo_backend": "aot_eager", "torch_compile_learner_dynamo_mode": null, "torch_compile_worker": false, "torch_compile_worker_dynamo_backend": "aot_eager", "torch_compile_worker_dynamo_mode": null, "torch_ddp_kwargs": {}, "torch_skip_nan_gradients": false, "env": "Umbrella", "env_config": {}, "observation_space": null, "action_space": null, "clip_rewards": null, "normalize_actions": true, "clip_actions": false, "_is_atari": null, "disable_env_checking": false, "render_env": false, "action_mask_key": "action_mask", "env_runner_cls": null, "num_env_runners": 0, "create_local_env_runner": true, "num_envs_per_env_runner": 1, "gym_env_vectorize_mode": "SYNC", "num_cpus_per_env_runner": 1, "num_gpus_per_env_runner": 0, "custom_resources_per_env_runner": {}, "validate_env_runners_after_construction": true, "episodes_to_numpy": true, "max_requests_in_flight_per_env_runner": 1, "sample_timeout_s": 60.0, "_env_to_module_connector": null, "add_default_connectors_to_env_to_module_pipeline": true, "_module_to_env_connector": null, "add_default_connectors_to_module_to_env_pipeline": true, "merge_env_runner_states": "training_only", "broadcast_env_runner_states": true, "episode_lookback_horizon": 1, "rollout_fragment_length": "auto", "batch_mode": "complete_episodes", "compress_observations": false, "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "enable_tf1_exec_eagerly": false, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "preprocessor_pref": "deepmind", "observation_filter": "NoFilter", "update_worker_filter_stats": true, "use_worker_filter_stats": true, "sampler_perf_stats_ema_coef": null, "_is_online": true, "num_learners": 0, "num_gpus_per_learner": 0, "num_cpus_per_learner": "auto", "num_aggregator_actors_per_learner": 0, "max_requests_in_flight_per_aggregator_actor": 3, "local_gpu_idx": 0, "max_requests_in_flight_per_learner": 3, "gamma": 1, "lr": 0.0002847858517, "grad_clip": 0.5, "grad_clip_by": "global_norm", "_train_batch_size_per_learner": 5000, "train_batch_size": 4000, "num_epochs": 1, "minibatch_size": 1000, "shuffle_batch_per_epoch": true, "model": {"fcnet_hiddens": [256, 256], "fcnet_activation": "tanh", "fcnet_weights_initializer": null, "fcnet_weights_initializer_config": null, "fcnet_bias_initializer": null, "fcnet_bias_initializer_config": null, "conv_filters": null, "conv_activation": "relu", "conv_kernel_initializer": null, "conv_kernel_initializer_config": null, "conv_bias_initializer": null, "conv_bias_initializer_config": null, "conv_transpose_kernel_initializer": null, "conv_transpose_kernel_initializer_config": null, "conv_transpose_bias_initializer": null, "conv_transpose_bias_initializer_config": null, "post_fcnet_hiddens": [], "post_fcnet_activation": "relu", "post_fcnet_weights_initializer": null, "post_fcnet_weights_initializer_config": null, "post_fcnet_bias_initializer": null, "post_fcnet_bias_initializer_config": null, "free_log_std": false, "log_std_clip_param": 20.0, "no_final_linear": false, "vf_share_layers": false, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "lstm_weights_initializer": null, "lstm_weights_initializer_config": null, "lstm_bias_initializer": null, "lstm_bias_initializer_config": null, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "attention_use_n_prev_actions": 0, "attention_use_n_prev_rewards": 0, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": null, "custom_model_config": {}, "custom_action_dist": null, "custom_preprocessor": null, "encoder_latent_dim": null, "always_check_shapes": false, "lstm_use_prev_action_reward": -1, "_use_default_native_models": -1, "_disable_preprocessor_api": false, "_disable_action_flattening": false}, "_learner_connector": null, "add_default_connectors_to_learner_pipeline": true, "learner_config_dict": {}, "optimizer": {}, "_learner_class": null, "callbacks_on_algorithm_init": null, "callbacks_on_env_runners_recreated": null, "callbacks_on_offline_eval_runners_recreated": null, "callbacks_on_checkpoint_loaded": null, "callbacks_on_environment_created": null, "callbacks_on_episode_created": null, "callbacks_on_episode_start": null, "callbacks_on_episode_step": null, "callbacks_on_episode_end": null, "callbacks_on_evaluate_start": null, "callbacks_on_evaluate_end": null, "callbacks_on_evaluate_offline_start": null, "callbacks_on_evaluate_offline_end": null, "callbacks_on_sample_end": null, "callbacks_on_train_result": null, "explore": true, "enable_rl_module_and_learner": true, "enable_env_runner_and_connector_v2": true, "_prior_exploration_config": {"type": "StochasticSampling"}, "count_steps_by": "env_steps", "policy_map_capacity": 100, "policy_mapping_fn": "<function AlgorithmConfig.DEFAULT_POLICY_MAPPING_FN at 0x17c065b20>", "policies_to_train": null, "policy_states_are_swappable": false, "observation_fn": null, "offline_data_class": null, "input_read_method": "read_parquet", "input_read_method_kwargs": {}, "input_read_schema": {}, "input_read_episodes": false, "input_read_sample_batches": false, "input_read_batch_size": null, "input_filesystem": null, "input_filesystem_kwargs": {}, "input_compress_columns": ["obs", "new_obs"], "input_spaces_jsonable": true, "materialize_data": false, "materialize_mapped_data": true, "map_batches_kwargs": {}, "iter_batches_kwargs": {}, "ignore_final_observation": false, "prelearner_class": null, "prelearner_buffer_class": null, "prelearner_buffer_kwargs": {}, "prelearner_module_synch_period": 10, "dataset_num_iters_per_learner": null, "input_config": {}, "actions_in_input_normalized": false, "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_config": {}, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "output_max_rows_per_file": null, "output_write_remaining_data": false, "output_write_method": "write_parquet", "output_write_method_kwargs": {}, "output_filesystem": null, "output_filesystem_kwargs": {}, "output_write_episodes": true, "offline_sampling": false, "evaluation_interval": 1, "evaluation_duration": 20, "evaluation_duration_unit": "episodes", "evaluation_sample_timeout_s": 120.0, "evaluation_auto_duration_min_env_steps_per_sample": 100, "evaluation_auto_duration_max_env_steps_per_sample": 2000, "evaluation_parallel_to_training": false, "evaluation_force_reset_envs_before_iteration": true, "evaluation_config": null, "off_policy_estimation_methods": {}, "ope_split_batch_by_episode": true, "evaluation_num_env_runners": 1, "in_evaluation": false, "sync_filters_on_rollout_workers_timeout_s": 10.0, "offline_evaluation_interval": null, "num_offline_eval_runners": 0, "offline_loss_for_module_fn": null, "offline_evaluation_duration": 1, "offline_evaluation_parallel_to_training": false, "offline_evaluation_timeout_s": 120.0, "num_cpus_per_offline_eval_runner": 1, "num_gpus_per_offline_eval_runner": 0, "custom_resources_per_offline_eval_runner": {}, "restart_failed_offline_eval_runners": true, "ignore_offline_eval_runner_failures": false, "max_num_offline_eval_runner_restarts": 1000, "offline_eval_runner_restore_timeout_s": 1800.0, "max_requests_in_flight_per_offline_eval_runner": 1, "validate_offline_eval_runners_after_construction": true, "offline_eval_runner_health_probe_timeout_s": 30.0, "offline_eval_rl_module_inference_only": false, "broadcast_offline_eval_runner_states": false, "offline_eval_batch_size_per_runner": 256, "dataset_num_iters_per_eval_runner": 1, "keep_per_episode_custom_metrics": false, "metrics_episode_collection_timeout_s": 60.0, "metrics_num_episodes_for_smoothing": 100, "min_time_s_per_iteration": null, "min_train_timesteps_per_iteration": 0, "min_sample_timesteps_per_iteration": 0, "log_gradients": true, "export_native_model_files": false, "checkpoint_trainable_policies_only": false, "logger_creator": null, "logger_config": null, "log_level": "WARN", "log_sys_usage": true, "fake_sampler": false, "seed": 5, "restart_failed_env_runners": true, "ignore_env_runner_failures": false, "max_num_env_runner_restarts": 1000, "delay_between_env_runner_restarts_s": 60.0, "restart_failed_sub_environments": false, "num_consecutive_env_runner_failures_tolerance": 100, "env_runner_health_probe_timeout_s": 30.0, "env_runner_restore_timeout_s": 1800.0, "_model_config": {}, "_rl_module_spec": "RLModuleSpec(module_class=None, observation_space=None, action_space=None, inference_only=False, learner_only=False, model_config=DefaultModelConfig(fcnet_hiddens=[60, 90], fcnet_activation='tanh', fcnet_kernel_initializer=None, fcnet_kernel_initializer_kwargs=None, fcnet_bias_initializer=None, fcnet_bias_initializer_kwargs=None, conv_filters=None, conv_activation='relu', conv_kernel_initializer=None, conv_kernel_initializer_kwargs=None, conv_bias_initializer=None, conv_bias_initializer_kwargs=None, head_fcnet_hiddens=[], head_fcnet_activation='relu', head_fcnet_kernel_initializer=None, head_fcnet_kernel_initializer_kwargs=None, head_fcnet_bias_initializer=None, head_fcnet_bias_initializer_kwargs=None, free_log_std=False, log_std_clip_param=20.0, vf_share_layers=True, use_lstm=False, max_seq_len=20, lstm_cell_size=256, lstm_use_prev_action=False, lstm_use_prev_reward=False, lstm_kernel_initializer=None, lstm_kernel_initializer_kwargs=None, lstm_bias_initializer=None, lstm_bias_initializer_kwargs=None), catalog_class=None, load_state_path=None, model_config_dict=None)", "algorithm_config_overrides_per_module": {}, "_per_module_overrides": {}, "_validate_config": true, "_use_msgpack_checkpoints": false, "_torch_grad_scaler_class": null, "_torch_lr_scheduler_classes": null, "_tf_policy_handles_more_than_one_loss": false, "_disable_preprocessor_api": false, "_disable_action_flattening": false, "_disable_initialize_loss_from_dummy_batch": false, "_dont_auto_sync_env_runner_states": false, "env_task_fn": -1, "enable_connectors": -1, "simple_optimizer": false, "policy_map_cache": -1, "worker_cls": -1, "synchronize_filters": -1, "enable_async_evaluation": -1, "custom_async_evaluation_function": -1, "_enable_rl_module_api": -1, "auto_wrap_old_gym_envs": -1, "always_attach_evaluation_results": -1, "replay_sequence_length": null, "_disable_execution_plan_api": -1, "use_critic": true, "use_gae": true, "use_kl_loss": true, "kl_coeff": 0.7464963036515, "kl_target": 0.0270990929592, "vf_loss_coeff": 0.6688075857018, "entropy_coeff": 0.0090570820258, "clip_param": 0.1221781641624, "vf_clip_param": 0.1027808522125, "entropy_coeff_schedule": null, "lr_schedule": null, "sgd_minibatch_size": -1, "vf_share_layers": -1, "__stdout_file__": null, "__stderr_file__": null, "lambda": 0.9099046732075, "input": "sampler", "policies": {"default_policy": [null, null, null, null]}, "callbacks": "<class 'ray.rllib.callbacks.callbacks.RLlibCallback'>", "create_env_on_driver": false, "custom_eval_function": null, "framework": "torch"}, "time_since_restore": 6.792380332946777, "iterations_since_restore": 4, "perf": {"cpu_util_percent": 36.25, "ram_util_percent": 76.4}}
{"timers": {"training_iteration": 1.5342560936619403, "restore_env_runners": 7.934069067940581e-06, "training_step": 1.5341229506025371, "env_runner_sampling_timer": 1.4282297089303095, "learner_update_timer": 0.1028030060655266, "synch_weights": 0.000619159387084177, "restore_eval_env_runners": 9.235279639367947e-06, "evaluation_iteration": 0.10277617954090272, "synch_eval_env_connectors": 0.00012072056572895962, "synch_env_connectors": 4.581236006808468e-06}, "env_runners": {"env_to_module_connector": {"timers": {"connectors": {"numpy_to_tensor": 8.227001560975673e-06, "add_states_from_episodes_to_batch": 1.6963019790412364e-06, "batch_individual_items": 6.157969493865132e-06, "add_observations_from_episodes_to_batch": 2.8953342340804486e-06, "add_time_dim_to_batch_and_zero_pad": 2.2690904105810055e-06}}, "connector_pipeline_timer": 4.3040933504172015e-05}, "num_agent_steps_sampled_lifetime": {"default_agent": -1842500.0}, "env_to_module_sum_episodes_length_out": 10.36823839457432, "num_episodes": 250.0, "episode_len_max": 20, "num_module_steps_sampled": {"default_policy": 5000.0}, "module_to_env_connector": {"timers": {"connectors": {"un_batch_to_individual_items": 5.2713941289585515e-06, "listify_data_for_vector_env": 1.0566305922782786e-05, "normalize_and_clip_actions": 9.13579203724152e-06, "get_actions": 3.6344282646835756e-05, "tensor_to_numpy": 1.264504031897557e-05, "remove_single_ts_time_rank_from_batch": 5.674212689877368e-07}}, "connector_pipeline_timer": 0.00010012908296334919}, "num_module_steps_sampled_lifetime": {"default_policy": -1842500.0}, "num_episodes_lifetime": -92125.0, "episode_len_min": 20, "episode_return_max": 6.5, "env_to_module_sum_episodes_length_in": 10.36823839457432, "env_step_timer": 1.3477433614787544e-05, "sample": 0.004814978472241568, "rlmodule_inference_timer": 4.544334981299289e-05, "episode_duration_sec_mean": 0.004786279482766986, "episode_return_mean": -1.0199999999999996, "module_episode_returns_mean": {"default_policy": -1.0199999999999996}, "env_reset_timer": 3.062826153274693e-05, "num_env_steps_sampled_lifetime": -1842500.0, "num_env_steps_sampled": 5000.0, "episode_return_min": -13.5, "episode_len_mean": 20.0, "weights_seq_no": 4.0, "num_agent_steps_sampled": {"default_agent": 5000.0}, "time_between_sampling": 0.0015551604322151013, "agent_episode_returns_mean": {"default_agent": -1.0199999999999996}, "num_env_steps_sampled_lifetime_throughput": 3836.8650141801763}, "learners": {"default_policy": {"policy_loss": 0.11087483167648315, "vf_loss": 0.10278083384037018, "vf_loss_unclipped": 29.599639892578125, "num_module_steps_trained": 6000, "diff_num_grad_updates_vs_sampler_policy": 1.0, "default_optimizer_learning_rate": 0.0002847858517, "weights_seq_no": 5.0, "total_loss": 0.17368201911449432, "vf_explained_var": -0.012921690940856934, "module_train_batch_size_mean": 1000.0, "num_module_steps_trained_lifetime": 30000, "gradients_default_optimizer_global_norm": 0.16659164428710938, "entropy": 0.6639235019683838, "curr_entropy_coeff": 0.0090570820258, "num_trainable_parameters": 6003, "curr_kl_coeff": 0.023328009992837906, "mean_kl_loss": 0.0017101932317018509, "num_module_steps_trained_lifetime_throughput": 444375.0697729595}, "__all_modules__": {"learner_connector": {"timers": {"connectors": {"batch_individual_items": 0.030686107420724997, "add_observations_from_episodes_to_batch": 0.0007748714548093732, "add_columns_from_episodes_to_train_batch": 0.03356822866667095, "general_advantage_estimation": 0.006279964580052139, "add_time_dim_to_batch_and_zero_pad": 9.048594235843048e-06, "numpy_to_tensor": 6.267393861737568e-05, "add_states_from_episodes_to_batch": 3.0573216357082125e-06, "add_one_ts_to_episodes_and_truncate": 0.007469130929953072}}, "connector_pipeline_timer": 0.07896038436727186}, "num_trainable_parameters": 6003, "num_env_steps_trained_lifetime": 157500, "num_module_steps_trained": 6000, "num_non_trainable_parameters": 0, "num_env_steps_trained": 31500, "num_module_steps_trained_lifetime": 30000, "learner_connector_sum_episodes_length_in": 5000.0, "learner_connector_sum_episodes_length_out": 5250.0, "num_env_steps_trained_lifetime_throughput": 2316486.038737433, "num_module_steps_trained_throughput": 443303.9319380006, "num_module_steps_trained_lifetime_throughput": 442451.3857870248}}, "num_training_step_calls_per_iteration": 1, "evaluation": {"env_runners": {"module_to_env_connector": {"connector_pipeline_timer": 9.61503046387543e-05, "timers": {"connectors": {"listify_data_for_vector_env": 1.0662196215276168e-05, "get_actions": 3.366187520942074e-05, "remove_single_ts_time_rank_from_batch": 5.415505757136303e-07, "tensor_to_numpy": 1.2320878092189317e-05, "un_batch_to_individual_items": 5.197868606422042e-06, "normalize_and_clip_actions": 9.102307757065195e-06}}}, "num_episodes_lifetime": 100, "num_module_steps_sampled": {"default_policy": 400}, "env_to_module_sum_episodes_length_in": 10.368238387501162, "env_to_module_connector": {"timers": {"connectors": {"numpy_to_tensor": 7.992463513791874e-06, "add_states_from_episodes_to_batch": 1.5139832465939387e-06, "add_time_dim_to_batch_and_zero_pad": 2.1289806508265968e-06, "batch_individual_items": 5.978664996539406e-06, "add_observations_from_episodes_to_batch": 2.7725608488653973e-06}}, "connector_pipeline_timer": 4.124828599169347e-05}, "module_episode_returns_mean": {"default_policy": -0.7}, "agent_episode_returns_mean": {"default_agent": -0.7}, "env_to_module_sum_episodes_length_out": 10.368238387501162, "episode_len_max": 20, "num_agent_steps_sampled": {"default_agent": 400}, "num_module_steps_sampled_lifetime": {"default_policy": 2000}, "episode_return_max": 13.5, "sample": 0.09648487165706351, "rlmodule_inference_timer": 2.582402831190636e-05, "env_reset_timer": 0.0002217832132096577, "episode_len_mean": 20.0, "weights_seq_no": 5.0, "episode_len_min": 20, "episode_duration_sec_mean": 0.0043649374879896645, "episode_return_mean": -0.7, "num_env_steps_sampled": 400, "episode_return_min": -15.5, "num_agent_steps_sampled_lifetime": {"default_agent": 2000}, "num_episodes": 20, "env_step_timer": 1.3688665238155022e-05, "num_env_steps_sampled_lifetime": 25400, "time_between_sampling": 1.5970441212975803}, "num_healthy_workers": 1, "actor_manager_num_outstanding_async_reqs": 0, "num_remote_worker_restarts": 0}, "num_env_steps_sampled_lifetime": -1842500.0, "fault_tolerance": {"num_healthy_workers": 0, "num_remote_worker_restarts": 0}, "env_runner_group": {"actor_manager_num_outstanding_async_reqs": 0}, "done": false, "training_iteration": 5, "trial_id": "4649a_00000", "date": "2025-08-11_19-36-18", "timestamp": 1754933778, "time_this_iter_s": 1.622624158859253, "time_total_s": 8.41500449180603, "pid": 28167, "hostname": "Mac", "node_ip": "127.0.0.1", "config": {"exploration_config": {}, "extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "placement_strategy": "PACK", "num_gpus": 0, "_fake_gpus": false, "num_cpus_for_main_process": 2, "eager_tracing": true, "eager_max_retraces": 20, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "torch_compile_learner": false, "torch_compile_learner_what_to_compile": "forward_train", "torch_compile_learner_dynamo_backend": "aot_eager", "torch_compile_learner_dynamo_mode": null, "torch_compile_worker": false, "torch_compile_worker_dynamo_backend": "aot_eager", "torch_compile_worker_dynamo_mode": null, "torch_ddp_kwargs": {}, "torch_skip_nan_gradients": false, "env": "Umbrella", "env_config": {}, "observation_space": null, "action_space": null, "clip_rewards": null, "normalize_actions": true, "clip_actions": false, "_is_atari": null, "disable_env_checking": false, "render_env": false, "action_mask_key": "action_mask", "env_runner_cls": null, "num_env_runners": 0, "create_local_env_runner": true, "num_envs_per_env_runner": 1, "gym_env_vectorize_mode": "SYNC", "num_cpus_per_env_runner": 1, "num_gpus_per_env_runner": 0, "custom_resources_per_env_runner": {}, "validate_env_runners_after_construction": true, "episodes_to_numpy": true, "max_requests_in_flight_per_env_runner": 1, "sample_timeout_s": 60.0, "_env_to_module_connector": null, "add_default_connectors_to_env_to_module_pipeline": true, "_module_to_env_connector": null, "add_default_connectors_to_module_to_env_pipeline": true, "merge_env_runner_states": "training_only", "broadcast_env_runner_states": true, "episode_lookback_horizon": 1, "rollout_fragment_length": "auto", "batch_mode": "complete_episodes", "compress_observations": false, "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "enable_tf1_exec_eagerly": false, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "preprocessor_pref": "deepmind", "observation_filter": "NoFilter", "update_worker_filter_stats": true, "use_worker_filter_stats": true, "sampler_perf_stats_ema_coef": null, "_is_online": true, "num_learners": 0, "num_gpus_per_learner": 0, "num_cpus_per_learner": "auto", "num_aggregator_actors_per_learner": 0, "max_requests_in_flight_per_aggregator_actor": 3, "local_gpu_idx": 0, "max_requests_in_flight_per_learner": 3, "gamma": 1, "lr": 0.0002847858517, "grad_clip": 0.5, "grad_clip_by": "global_norm", "_train_batch_size_per_learner": 5000, "train_batch_size": 4000, "num_epochs": 1, "minibatch_size": 1000, "shuffle_batch_per_epoch": true, "model": {"fcnet_hiddens": [256, 256], "fcnet_activation": "tanh", "fcnet_weights_initializer": null, "fcnet_weights_initializer_config": null, "fcnet_bias_initializer": null, "fcnet_bias_initializer_config": null, "conv_filters": null, "conv_activation": "relu", "conv_kernel_initializer": null, "conv_kernel_initializer_config": null, "conv_bias_initializer": null, "conv_bias_initializer_config": null, "conv_transpose_kernel_initializer": null, "conv_transpose_kernel_initializer_config": null, "conv_transpose_bias_initializer": null, "conv_transpose_bias_initializer_config": null, "post_fcnet_hiddens": [], "post_fcnet_activation": "relu", "post_fcnet_weights_initializer": null, "post_fcnet_weights_initializer_config": null, "post_fcnet_bias_initializer": null, "post_fcnet_bias_initializer_config": null, "free_log_std": false, "log_std_clip_param": 20.0, "no_final_linear": false, "vf_share_layers": false, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "lstm_weights_initializer": null, "lstm_weights_initializer_config": null, "lstm_bias_initializer": null, "lstm_bias_initializer_config": null, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "attention_use_n_prev_actions": 0, "attention_use_n_prev_rewards": 0, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": null, "custom_model_config": {}, "custom_action_dist": null, "custom_preprocessor": null, "encoder_latent_dim": null, "always_check_shapes": false, "lstm_use_prev_action_reward": -1, "_use_default_native_models": -1, "_disable_preprocessor_api": false, "_disable_action_flattening": false}, "_learner_connector": null, "add_default_connectors_to_learner_pipeline": true, "learner_config_dict": {}, "optimizer": {}, "_learner_class": null, "callbacks_on_algorithm_init": null, "callbacks_on_env_runners_recreated": null, "callbacks_on_offline_eval_runners_recreated": null, "callbacks_on_checkpoint_loaded": null, "callbacks_on_environment_created": null, "callbacks_on_episode_created": null, "callbacks_on_episode_start": null, "callbacks_on_episode_step": null, "callbacks_on_episode_end": null, "callbacks_on_evaluate_start": null, "callbacks_on_evaluate_end": null, "callbacks_on_evaluate_offline_start": null, "callbacks_on_evaluate_offline_end": null, "callbacks_on_sample_end": null, "callbacks_on_train_result": null, "explore": true, "enable_rl_module_and_learner": true, "enable_env_runner_and_connector_v2": true, "_prior_exploration_config": {"type": "StochasticSampling"}, "count_steps_by": "env_steps", "policy_map_capacity": 100, "policy_mapping_fn": "<function AlgorithmConfig.DEFAULT_POLICY_MAPPING_FN at 0x17c065b20>", "policies_to_train": null, "policy_states_are_swappable": false, "observation_fn": null, "offline_data_class": null, "input_read_method": "read_parquet", "input_read_method_kwargs": {}, "input_read_schema": {}, "input_read_episodes": false, "input_read_sample_batches": false, "input_read_batch_size": null, "input_filesystem": null, "input_filesystem_kwargs": {}, "input_compress_columns": ["obs", "new_obs"], "input_spaces_jsonable": true, "materialize_data": false, "materialize_mapped_data": true, "map_batches_kwargs": {}, "iter_batches_kwargs": {}, "ignore_final_observation": false, "prelearner_class": null, "prelearner_buffer_class": null, "prelearner_buffer_kwargs": {}, "prelearner_module_synch_period": 10, "dataset_num_iters_per_learner": null, "input_config": {}, "actions_in_input_normalized": false, "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_config": {}, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "output_max_rows_per_file": null, "output_write_remaining_data": false, "output_write_method": "write_parquet", "output_write_method_kwargs": {}, "output_filesystem": null, "output_filesystem_kwargs": {}, "output_write_episodes": true, "offline_sampling": false, "evaluation_interval": 1, "evaluation_duration": 20, "evaluation_duration_unit": "episodes", "evaluation_sample_timeout_s": 120.0, "evaluation_auto_duration_min_env_steps_per_sample": 100, "evaluation_auto_duration_max_env_steps_per_sample": 2000, "evaluation_parallel_to_training": false, "evaluation_force_reset_envs_before_iteration": true, "evaluation_config": null, "off_policy_estimation_methods": {}, "ope_split_batch_by_episode": true, "evaluation_num_env_runners": 1, "in_evaluation": false, "sync_filters_on_rollout_workers_timeout_s": 10.0, "offline_evaluation_interval": null, "num_offline_eval_runners": 0, "offline_loss_for_module_fn": null, "offline_evaluation_duration": 1, "offline_evaluation_parallel_to_training": false, "offline_evaluation_timeout_s": 120.0, "num_cpus_per_offline_eval_runner": 1, "num_gpus_per_offline_eval_runner": 0, "custom_resources_per_offline_eval_runner": {}, "restart_failed_offline_eval_runners": true, "ignore_offline_eval_runner_failures": false, "max_num_offline_eval_runner_restarts": 1000, "offline_eval_runner_restore_timeout_s": 1800.0, "max_requests_in_flight_per_offline_eval_runner": 1, "validate_offline_eval_runners_after_construction": true, "offline_eval_runner_health_probe_timeout_s": 30.0, "offline_eval_rl_module_inference_only": false, "broadcast_offline_eval_runner_states": false, "offline_eval_batch_size_per_runner": 256, "dataset_num_iters_per_eval_runner": 1, "keep_per_episode_custom_metrics": false, "metrics_episode_collection_timeout_s": 60.0, "metrics_num_episodes_for_smoothing": 100, "min_time_s_per_iteration": null, "min_train_timesteps_per_iteration": 0, "min_sample_timesteps_per_iteration": 0, "log_gradients": true, "export_native_model_files": false, "checkpoint_trainable_policies_only": false, "logger_creator": null, "logger_config": null, "log_level": "WARN", "log_sys_usage": true, "fake_sampler": false, "seed": 5, "restart_failed_env_runners": true, "ignore_env_runner_failures": false, "max_num_env_runner_restarts": 1000, "delay_between_env_runner_restarts_s": 60.0, "restart_failed_sub_environments": false, "num_consecutive_env_runner_failures_tolerance": 100, "env_runner_health_probe_timeout_s": 30.0, "env_runner_restore_timeout_s": 1800.0, "_model_config": {}, "_rl_module_spec": "RLModuleSpec(module_class=None, observation_space=None, action_space=None, inference_only=False, learner_only=False, model_config=DefaultModelConfig(fcnet_hiddens=[60, 90], fcnet_activation='tanh', fcnet_kernel_initializer=None, fcnet_kernel_initializer_kwargs=None, fcnet_bias_initializer=None, fcnet_bias_initializer_kwargs=None, conv_filters=None, conv_activation='relu', conv_kernel_initializer=None, conv_kernel_initializer_kwargs=None, conv_bias_initializer=None, conv_bias_initializer_kwargs=None, head_fcnet_hiddens=[], head_fcnet_activation='relu', head_fcnet_kernel_initializer=None, head_fcnet_kernel_initializer_kwargs=None, head_fcnet_bias_initializer=None, head_fcnet_bias_initializer_kwargs=None, free_log_std=False, log_std_clip_param=20.0, vf_share_layers=True, use_lstm=False, max_seq_len=20, lstm_cell_size=256, lstm_use_prev_action=False, lstm_use_prev_reward=False, lstm_kernel_initializer=None, lstm_kernel_initializer_kwargs=None, lstm_bias_initializer=None, lstm_bias_initializer_kwargs=None), catalog_class=None, load_state_path=None, model_config_dict=None)", "algorithm_config_overrides_per_module": {}, "_per_module_overrides": {}, "_validate_config": true, "_use_msgpack_checkpoints": false, "_torch_grad_scaler_class": null, "_torch_lr_scheduler_classes": null, "_tf_policy_handles_more_than_one_loss": false, "_disable_preprocessor_api": false, "_disable_action_flattening": false, "_disable_initialize_loss_from_dummy_batch": false, "_dont_auto_sync_env_runner_states": false, "env_task_fn": -1, "enable_connectors": -1, "simple_optimizer": false, "policy_map_cache": -1, "worker_cls": -1, "synchronize_filters": -1, "enable_async_evaluation": -1, "custom_async_evaluation_function": -1, "_enable_rl_module_api": -1, "auto_wrap_old_gym_envs": -1, "always_attach_evaluation_results": -1, "replay_sequence_length": null, "_disable_execution_plan_api": -1, "use_critic": true, "use_gae": true, "use_kl_loss": true, "kl_coeff": 0.7464963036515, "kl_target": 0.0270990929592, "vf_loss_coeff": 0.6688075857018, "entropy_coeff": 0.0090570820258, "clip_param": 0.1221781641624, "vf_clip_param": 0.1027808522125, "entropy_coeff_schedule": null, "lr_schedule": null, "sgd_minibatch_size": -1, "vf_share_layers": -1, "__stdout_file__": null, "__stderr_file__": null, "lambda": 0.9099046732075, "input": "sampler", "policies": {"default_policy": [null, null, null, null]}, "callbacks": "<class 'ray.rllib.callbacks.callbacks.RLlibCallback'>", "create_env_on_driver": false, "custom_eval_function": null, "framework": "torch"}, "time_since_restore": 8.41500449180603, "iterations_since_restore": 5, "perf": {"cpu_util_percent": 33.300000000000004, "ram_util_percent": 75.49999999999999}}
{"timers": {"training_iteration": 1.5340908760558998, "restore_env_runners": 7.905557635077252e-06, "training_step": 1.5339574969366918, "env_runner_sampling_timer": 1.4272975614215169, "learner_update_timer": 0.1035705347550351, "synch_weights": 0.0006185627927427565, "restore_eval_env_runners": 9.203346395002446e-06, "evaluation_iteration": 0.10273159774524193, "synch_eval_env_connectors": 0.00012044293990891776, "synch_env_connectors": 4.578753429524368e-06}, "env_runners": {"env_to_module_connector": {"timers": {"connectors": {"numpy_to_tensor": 8.263830635573412e-06, "add_states_from_episodes_to_batch": 1.6963617733016385e-06, "batch_individual_items": 6.1485893934165164e-06, "add_observations_from_episodes_to_batch": 2.885203411624372e-06, "add_time_dim_to_batch_and_zero_pad": 2.26289193168784e-06}}, "connector_pipeline_timer": 4.284745787092975e-05}, "num_agent_steps_sampled_lifetime": {"default_agent": -2460000.0}, "env_to_module_sum_episodes_length_out": 10.36823839457432, "num_episodes": 250.0, "episode_len_max": 20, "num_module_steps_sampled": {"default_policy": 5000.0}, "module_to_env_connector": {"timers": {"connectors": {"un_batch_to_individual_items": 5.277220823790591e-06, "listify_data_for_vector_env": 1.0584232972321826e-05, "normalize_and_clip_actions": 9.132161415433435e-06, "get_actions": 3.6431954084675316e-05, "tensor_to_numpy": 1.2636438867604698e-05, "remove_single_ts_time_rank_from_batch": 5.663730163246287e-07}}, "connector_pipeline_timer": 0.00010009255614491172}, "num_module_steps_sampled_lifetime": {"default_policy": -2460000.0}, "num_episodes_lifetime": -123000.0, "episode_len_min": 20, "episode_return_max": 6.5, "env_to_module_sum_episodes_length_in": 10.36823839457432, "env_step_timer": 1.3492258111607515e-05, "sample": 0.004994464965261996, "rlmodule_inference_timer": 2.6680221524579105e-05, "episode_duration_sec_mean": 0.004408133143093437, "episode_return_mean": 0.5, "module_episode_returns_mean": {"default_policy": 0.5}, "env_reset_timer": 2.9468364282580842e-05, "num_env_steps_sampled_lifetime": -2460000.0, "num_env_steps_sampled": 5000.0, "episode_return_min": -13.5, "episode_len_mean": 20.0, "weights_seq_no": 5.0, "num_agent_steps_sampled": {"default_agent": 5000.0}, "time_between_sampling": 0.0014482162144557054, "agent_episode_returns_mean": {"default_agent": 0.5}, "num_env_steps_sampled_lifetime_throughput": 3840.993162954753}, "learners": {"default_policy": {"policy_loss": 0.14476658403873444, "vf_loss": 0.10278083384037018, "vf_loss_unclipped": 28.372112274169922, "num_module_steps_trained": 6000, "diff_num_grad_updates_vs_sampler_policy": 1.0, "default_optimizer_learning_rate": 0.0002847858517, "weights_seq_no": 6.0, "total_loss": 0.20755812525749207, "vf_explained_var": -0.013740062713623047, "module_train_batch_size_mean": 1000.0, "num_module_steps_trained_lifetime": 36000, "gradients_default_optimizer_global_norm": 0.017227962613105774, "entropy": 0.6570912599563599, "curr_entropy_coeff": 0.0090570820258, "num_trainable_parameters": 6003, "curr_kl_coeff": 0.011664004996418953, "mean_kl_loss": 9.704682452138513e-05, "num_module_steps_trained_lifetime_throughput": 445524.0761380343}, "__all_modules__": {"learner_connector": {"timers": {"connectors": {"batch_individual_items": 0.03158107967591407, "add_observations_from_episodes_to_batch": 0.000775244820732646, "add_columns_from_episodes_to_train_batch": 0.033571057629287575, "general_advantage_estimation": 0.006267971183743488, "add_time_dim_to_batch_and_zero_pad": 9.058948409404327e-06, "numpy_to_tensor": 6.269427982773833e-05, "add_states_from_episodes_to_batch": 3.0559186065413055e-06, "add_one_ts_to_episodes_and_truncate": 0.00746900296023898}}, "connector_pipeline_timer": 0.07984634552305846}, "num_trainable_parameters": 6003, "num_env_steps_trained_lifetime": 189000, "num_module_steps_trained": 6000, "num_non_trainable_parameters": 0, "num_env_steps_trained": 31500, "num_module_steps_trained_lifetime": 36000, "learner_connector_sum_episodes_length_in": 5000.0, "learner_connector_sum_episodes_length_out": 5250.0, "num_env_steps_trained_lifetime_throughput": 2323231.470420733, "num_module_steps_trained_throughput": 444522.36729984276, "num_module_steps_trained_lifetime_throughput": 443692.9713147575}}, "num_training_step_calls_per_iteration": 1, "evaluation": {"env_runners": {"module_to_env_connector": {"connector_pipeline_timer": 9.65215251550296e-05, "timers": {"connectors": {"listify_data_for_vector_env": 1.069818971425197e-05, "get_actions": 3.3839861272800406e-05, "remove_single_ts_time_rank_from_batch": 5.496889107597246e-07, "tensor_to_numpy": 1.2274937722186289e-05, "un_batch_to_individual_items": 5.211594649798284e-06, "normalize_and_clip_actions": 9.111505073796603e-06}}}, "num_episodes_lifetime": 120, "num_module_steps_sampled": {"default_policy": 400}, "env_to_module_sum_episodes_length_in": 10.368238394470474, "env_to_module_connector": {"timers": {"connectors": {"numpy_to_tensor": 8.091982817594252e-06, "add_states_from_episodes_to_batch": 1.5303788445124171e-06, "add_time_dim_to_batch_and_zero_pad": 2.128706476809246e-06, "batch_individual_items": 5.990247103230227e-06, "add_observations_from_episodes_to_batch": 2.7273258264142144e-06}}, "connector_pipeline_timer": 4.155138168405911e-05}, "module_episode_returns_mean": {"default_policy": 0.1}, "agent_episode_returns_mean": {"default_agent": 0.1}, "env_to_module_sum_episodes_length_out": 10.368238394470474, "episode_len_max": 20, "num_agent_steps_sampled": {"default_agent": 400}, "num_module_steps_sampled_lifetime": {"default_policy": 2400}, "episode_return_max": 13.5, "sample": 0.09646355919018076, "rlmodule_inference_timer": 2.565828280015975e-05, "env_reset_timer": 0.00022025871115315292, "episode_len_mean": 20.0, "weights_seq_no": 6.0, "episode_len_min": 20, "episode_duration_sec_mean": 0.00434662917163223, "episode_return_mean": 0.1, "num_env_steps_sampled": 400, "episode_return_min": -15.5, "num_agent_steps_sampled_lifetime": {"default_agent": 2400}, "num_episodes": 20, "env_step_timer": 1.361247950318494e-05, "num_env_steps_sampled_lifetime": 30400, "time_between_sampling": 1.5964086055044884}, "num_healthy_workers": 1, "actor_manager_num_outstanding_async_reqs": 0, "num_remote_worker_restarts": 0}, "num_env_steps_sampled_lifetime": -2460000.0, "fault_tolerance": {"num_healthy_workers": 0, "num_remote_worker_restarts": 0}, "env_runner_group": {"actor_manager_num_outstanding_async_reqs": 0}, "done": false, "training_iteration": 6, "trial_id": "4649a_00000", "date": "2025-08-11_19-36-20", "timestamp": 1754933780, "time_this_iter_s": 1.6187138557434082, "time_total_s": 10.033718347549438, "pid": 28167, "hostname": "Mac", "node_ip": "127.0.0.1", "config": {"exploration_config": {}, "extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "placement_strategy": "PACK", "num_gpus": 0, "_fake_gpus": false, "num_cpus_for_main_process": 2, "eager_tracing": true, "eager_max_retraces": 20, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "torch_compile_learner": false, "torch_compile_learner_what_to_compile": "forward_train", "torch_compile_learner_dynamo_backend": "aot_eager", "torch_compile_learner_dynamo_mode": null, "torch_compile_worker": false, "torch_compile_worker_dynamo_backend": "aot_eager", "torch_compile_worker_dynamo_mode": null, "torch_ddp_kwargs": {}, "torch_skip_nan_gradients": false, "env": "Umbrella", "env_config": {}, "observation_space": null, "action_space": null, "clip_rewards": null, "normalize_actions": true, "clip_actions": false, "_is_atari": null, "disable_env_checking": false, "render_env": false, "action_mask_key": "action_mask", "env_runner_cls": null, "num_env_runners": 0, "create_local_env_runner": true, "num_envs_per_env_runner": 1, "gym_env_vectorize_mode": "SYNC", "num_cpus_per_env_runner": 1, "num_gpus_per_env_runner": 0, "custom_resources_per_env_runner": {}, "validate_env_runners_after_construction": true, "episodes_to_numpy": true, "max_requests_in_flight_per_env_runner": 1, "sample_timeout_s": 60.0, "_env_to_module_connector": null, "add_default_connectors_to_env_to_module_pipeline": true, "_module_to_env_connector": null, "add_default_connectors_to_module_to_env_pipeline": true, "merge_env_runner_states": "training_only", "broadcast_env_runner_states": true, "episode_lookback_horizon": 1, "rollout_fragment_length": "auto", "batch_mode": "complete_episodes", "compress_observations": false, "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "enable_tf1_exec_eagerly": false, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "preprocessor_pref": "deepmind", "observation_filter": "NoFilter", "update_worker_filter_stats": true, "use_worker_filter_stats": true, "sampler_perf_stats_ema_coef": null, "_is_online": true, "num_learners": 0, "num_gpus_per_learner": 0, "num_cpus_per_learner": "auto", "num_aggregator_actors_per_learner": 0, "max_requests_in_flight_per_aggregator_actor": 3, "local_gpu_idx": 0, "max_requests_in_flight_per_learner": 3, "gamma": 1, "lr": 0.0002847858517, "grad_clip": 0.5, "grad_clip_by": "global_norm", "_train_batch_size_per_learner": 5000, "train_batch_size": 4000, "num_epochs": 1, "minibatch_size": 1000, "shuffle_batch_per_epoch": true, "model": {"fcnet_hiddens": [256, 256], "fcnet_activation": "tanh", "fcnet_weights_initializer": null, "fcnet_weights_initializer_config": null, "fcnet_bias_initializer": null, "fcnet_bias_initializer_config": null, "conv_filters": null, "conv_activation": "relu", "conv_kernel_initializer": null, "conv_kernel_initializer_config": null, "conv_bias_initializer": null, "conv_bias_initializer_config": null, "conv_transpose_kernel_initializer": null, "conv_transpose_kernel_initializer_config": null, "conv_transpose_bias_initializer": null, "conv_transpose_bias_initializer_config": null, "post_fcnet_hiddens": [], "post_fcnet_activation": "relu", "post_fcnet_weights_initializer": null, "post_fcnet_weights_initializer_config": null, "post_fcnet_bias_initializer": null, "post_fcnet_bias_initializer_config": null, "free_log_std": false, "log_std_clip_param": 20.0, "no_final_linear": false, "vf_share_layers": false, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "lstm_weights_initializer": null, "lstm_weights_initializer_config": null, "lstm_bias_initializer": null, "lstm_bias_initializer_config": null, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "attention_use_n_prev_actions": 0, "attention_use_n_prev_rewards": 0, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": null, "custom_model_config": {}, "custom_action_dist": null, "custom_preprocessor": null, "encoder_latent_dim": null, "always_check_shapes": false, "lstm_use_prev_action_reward": -1, "_use_default_native_models": -1, "_disable_preprocessor_api": false, "_disable_action_flattening": false}, "_learner_connector": null, "add_default_connectors_to_learner_pipeline": true, "learner_config_dict": {}, "optimizer": {}, "_learner_class": null, "callbacks_on_algorithm_init": null, "callbacks_on_env_runners_recreated": null, "callbacks_on_offline_eval_runners_recreated": null, "callbacks_on_checkpoint_loaded": null, "callbacks_on_environment_created": null, "callbacks_on_episode_created": null, "callbacks_on_episode_start": null, "callbacks_on_episode_step": null, "callbacks_on_episode_end": null, "callbacks_on_evaluate_start": null, "callbacks_on_evaluate_end": null, "callbacks_on_evaluate_offline_start": null, "callbacks_on_evaluate_offline_end": null, "callbacks_on_sample_end": null, "callbacks_on_train_result": null, "explore": true, "enable_rl_module_and_learner": true, "enable_env_runner_and_connector_v2": true, "_prior_exploration_config": {"type": "StochasticSampling"}, "count_steps_by": "env_steps", "policy_map_capacity": 100, "policy_mapping_fn": "<function AlgorithmConfig.DEFAULT_POLICY_MAPPING_FN at 0x17c065b20>", "policies_to_train": null, "policy_states_are_swappable": false, "observation_fn": null, "offline_data_class": null, "input_read_method": "read_parquet", "input_read_method_kwargs": {}, "input_read_schema": {}, "input_read_episodes": false, "input_read_sample_batches": false, "input_read_batch_size": null, "input_filesystem": null, "input_filesystem_kwargs": {}, "input_compress_columns": ["obs", "new_obs"], "input_spaces_jsonable": true, "materialize_data": false, "materialize_mapped_data": true, "map_batches_kwargs": {}, "iter_batches_kwargs": {}, "ignore_final_observation": false, "prelearner_class": null, "prelearner_buffer_class": null, "prelearner_buffer_kwargs": {}, "prelearner_module_synch_period": 10, "dataset_num_iters_per_learner": null, "input_config": {}, "actions_in_input_normalized": false, "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_config": {}, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "output_max_rows_per_file": null, "output_write_remaining_data": false, "output_write_method": "write_parquet", "output_write_method_kwargs": {}, "output_filesystem": null, "output_filesystem_kwargs": {}, "output_write_episodes": true, "offline_sampling": false, "evaluation_interval": 1, "evaluation_duration": 20, "evaluation_duration_unit": "episodes", "evaluation_sample_timeout_s": 120.0, "evaluation_auto_duration_min_env_steps_per_sample": 100, "evaluation_auto_duration_max_env_steps_per_sample": 2000, "evaluation_parallel_to_training": false, "evaluation_force_reset_envs_before_iteration": true, "evaluation_config": null, "off_policy_estimation_methods": {}, "ope_split_batch_by_episode": true, "evaluation_num_env_runners": 1, "in_evaluation": false, "sync_filters_on_rollout_workers_timeout_s": 10.0, "offline_evaluation_interval": null, "num_offline_eval_runners": 0, "offline_loss_for_module_fn": null, "offline_evaluation_duration": 1, "offline_evaluation_parallel_to_training": false, "offline_evaluation_timeout_s": 120.0, "num_cpus_per_offline_eval_runner": 1, "num_gpus_per_offline_eval_runner": 0, "custom_resources_per_offline_eval_runner": {}, "restart_failed_offline_eval_runners": true, "ignore_offline_eval_runner_failures": false, "max_num_offline_eval_runner_restarts": 1000, "offline_eval_runner_restore_timeout_s": 1800.0, "max_requests_in_flight_per_offline_eval_runner": 1, "validate_offline_eval_runners_after_construction": true, "offline_eval_runner_health_probe_timeout_s": 30.0, "offline_eval_rl_module_inference_only": false, "broadcast_offline_eval_runner_states": false, "offline_eval_batch_size_per_runner": 256, "dataset_num_iters_per_eval_runner": 1, "keep_per_episode_custom_metrics": false, "metrics_episode_collection_timeout_s": 60.0, "metrics_num_episodes_for_smoothing": 100, "min_time_s_per_iteration": null, "min_train_timesteps_per_iteration": 0, "min_sample_timesteps_per_iteration": 0, "log_gradients": true, "export_native_model_files": false, "checkpoint_trainable_policies_only": false, "logger_creator": null, "logger_config": null, "log_level": "WARN", "log_sys_usage": true, "fake_sampler": false, "seed": 5, "restart_failed_env_runners": true, "ignore_env_runner_failures": false, "max_num_env_runner_restarts": 1000, "delay_between_env_runner_restarts_s": 60.0, "restart_failed_sub_environments": false, "num_consecutive_env_runner_failures_tolerance": 100, "env_runner_health_probe_timeout_s": 30.0, "env_runner_restore_timeout_s": 1800.0, "_model_config": {}, "_rl_module_spec": "RLModuleSpec(module_class=None, observation_space=None, action_space=None, inference_only=False, learner_only=False, model_config=DefaultModelConfig(fcnet_hiddens=[60, 90], fcnet_activation='tanh', fcnet_kernel_initializer=None, fcnet_kernel_initializer_kwargs=None, fcnet_bias_initializer=None, fcnet_bias_initializer_kwargs=None, conv_filters=None, conv_activation='relu', conv_kernel_initializer=None, conv_kernel_initializer_kwargs=None, conv_bias_initializer=None, conv_bias_initializer_kwargs=None, head_fcnet_hiddens=[], head_fcnet_activation='relu', head_fcnet_kernel_initializer=None, head_fcnet_kernel_initializer_kwargs=None, head_fcnet_bias_initializer=None, head_fcnet_bias_initializer_kwargs=None, free_log_std=False, log_std_clip_param=20.0, vf_share_layers=True, use_lstm=False, max_seq_len=20, lstm_cell_size=256, lstm_use_prev_action=False, lstm_use_prev_reward=False, lstm_kernel_initializer=None, lstm_kernel_initializer_kwargs=None, lstm_bias_initializer=None, lstm_bias_initializer_kwargs=None), catalog_class=None, load_state_path=None, model_config_dict=None)", "algorithm_config_overrides_per_module": {}, "_per_module_overrides": {}, "_validate_config": true, "_use_msgpack_checkpoints": false, "_torch_grad_scaler_class": null, "_torch_lr_scheduler_classes": null, "_tf_policy_handles_more_than_one_loss": false, "_disable_preprocessor_api": false, "_disable_action_flattening": false, "_disable_initialize_loss_from_dummy_batch": false, "_dont_auto_sync_env_runner_states": false, "env_task_fn": -1, "enable_connectors": -1, "simple_optimizer": false, "policy_map_cache": -1, "worker_cls": -1, "synchronize_filters": -1, "enable_async_evaluation": -1, "custom_async_evaluation_function": -1, "_enable_rl_module_api": -1, "auto_wrap_old_gym_envs": -1, "always_attach_evaluation_results": -1, "replay_sequence_length": null, "_disable_execution_plan_api": -1, "use_critic": true, "use_gae": true, "use_kl_loss": true, "kl_coeff": 0.7464963036515, "kl_target": 0.0270990929592, "vf_loss_coeff": 0.6688075857018, "entropy_coeff": 0.0090570820258, "clip_param": 0.1221781641624, "vf_clip_param": 0.1027808522125, "entropy_coeff_schedule": null, "lr_schedule": null, "sgd_minibatch_size": -1, "vf_share_layers": -1, "__stdout_file__": null, "__stderr_file__": null, "lambda": 0.9099046732075, "input": "sampler", "policies": {"default_policy": [null, null, null, null]}, "callbacks": "<class 'ray.rllib.callbacks.callbacks.RLlibCallback'>", "create_env_on_driver": false, "custom_eval_function": null, "framework": "torch"}, "time_since_restore": 10.033718347549438, "iterations_since_restore": 6, "perf": {"cpu_util_percent": 32.75, "ram_util_percent": 75.0}}
{"timers": {"training_iteration": 1.5330987868759685, "restore_env_runners": 7.883582819324662e-06, "training_step": 1.5329652319671911, "env_runner_sampling_timer": 1.4264425037175663, "learner_update_timer": 0.10343551940775618, "synch_weights": 0.0006175188337683305, "restore_eval_env_runners": 9.173392565569853e-06, "evaluation_iteration": 0.10269380967850447, "synch_eval_env_connectors": 0.00012030892960342253, "synch_env_connectors": 4.580046579682373e-06}, "env_runners": {"env_to_module_connector": {"timers": {"connectors": {"numpy_to_tensor": 8.341238053963442e-06, "add_states_from_episodes_to_batch": 1.7091713937477952e-06, "batch_individual_items": 6.26312316738549e-06, "add_observations_from_episodes_to_batch": 2.9257961289317574e-06, "add_time_dim_to_batch_and_zero_pad": 2.2825145748900596e-06}}, "connector_pipeline_timer": 4.333968608405644e-05}, "num_agent_steps_sampled_lifetime": {"default_agent": -3077500.0}, "env_to_module_sum_episodes_length_out": 10.36823839457432, "num_episodes": 250.0, "episode_len_max": 20, "num_module_steps_sampled": {"default_policy": 5000.0}, "module_to_env_connector": {"timers": {"connectors": {"un_batch_to_individual_items": 5.336196165733451e-06, "listify_data_for_vector_env": 1.0685959390071925e-05, "normalize_and_clip_actions": 9.2016292080822e-06, "get_actions": 3.63161569229386e-05, "tensor_to_numpy": 1.2715434310677738e-05, "remove_single_ts_time_rank_from_batch": 5.710823915563608e-07}}, "connector_pipeline_timer": 0.00010049303493773774}, "num_module_steps_sampled_lifetime": {"default_policy": -3077500.0}, "num_episodes_lifetime": -153875.0, "episode_len_min": 20, "episode_return_max": 6.5, "env_to_module_sum_episodes_length_in": 10.36823839457432, "env_step_timer": 1.3596857296593864e-05, "sample": 0.004746105398577926, "rlmodule_inference_timer": 2.6532850873797225e-05, "episode_duration_sec_mean": 0.004442270668223501, "episode_return_mean": 0.58, "module_episode_returns_mean": {"default_policy": 0.58}, "env_reset_timer": 2.930786702456588e-05, "num_env_steps_sampled_lifetime": -3077500.0, "num_env_steps_sampled": 5000.0, "episode_return_min": -13.5, "episode_len_mean": 20.0, "weights_seq_no": 6.0, "num_agent_steps_sampled": {"default_agent": 5000.0}, "time_between_sampling": 0.0017692904376621565, "agent_episode_returns_mean": {"default_agent": 0.58}, "num_env_steps_sampled_lifetime_throughput": 3832.646981492523}, "learners": {"default_policy": {"policy_loss": -0.022446408867836, "vf_loss": 0.10278083384037018, "vf_loss_unclipped": 26.70923614501953, "num_module_steps_trained": 6000, "diff_num_grad_updates_vs_sampler_policy": 1.0, "default_optimizer_learning_rate": 0.0002847858517, "weights_seq_no": 7.0, "total_loss": 0.040499333292245865, "vf_explained_var": -0.016066908836364746, "module_train_batch_size_mean": 1000.0, "num_module_steps_trained_lifetime": 42000, "gradients_default_optimizer_global_norm": 0.058299656957387924, "entropy": 0.640975832939148, "curr_entropy_coeff": 0.0090570820258, "num_trainable_parameters": 6003, "curr_kl_coeff": 0.0058320024982094765, "mean_kl_loss": 0.0009009736822918057, "num_module_steps_trained_lifetime_throughput": 447008.9392742802}, "__all_modules__": {"learner_connector": {"timers": {"connectors": {"batch_individual_items": 0.031560309299178656, "add_observations_from_episodes_to_batch": 0.0007755319529505671, "add_columns_from_episodes_to_train_batch": 0.033584650383289484, "general_advantage_estimation": 0.006256173971105414, "add_time_dim_to_batch_and_zero_pad": 9.044188373488695e-06, "numpy_to_tensor": 6.25323370777407e-05, "add_states_from_episodes_to_batch": 3.052859047797851e-06, "add_one_ts_to_episodes_and_truncate": 0.0074722400106196464}}, "connector_pipeline_timer": 0.07983043623841031}, "num_trainable_parameters": 6003, "num_env_steps_trained_lifetime": 220500, "num_module_steps_trained": 6000, "num_non_trainable_parameters": 0, "num_env_steps_trained": 31500, "num_module_steps_trained_lifetime": 42000, "learner_connector_sum_episodes_length_in": 5000.0, "learner_connector_sum_episodes_length_out": 5250.0, "num_env_steps_trained_lifetime_throughput": 2331749.1344265146, "num_module_steps_trained_throughput": 446076.92402006785, "num_module_steps_trained_lifetime_throughput": 445271.2950041301}}, "num_training_step_calls_per_iteration": 1, "evaluation": {"env_runners": {"module_to_env_connector": {"connector_pipeline_timer": 9.709202242044042e-05, "timers": {"connectors": {"listify_data_for_vector_env": 1.0784571516488444e-05, "get_actions": 3.422398339354757e-05, "remove_single_ts_time_rank_from_batch": 5.532996665307515e-07, "tensor_to_numpy": 1.2381059219814157e-05, "un_batch_to_individual_items": 5.250085154198338e-06, "normalize_and_clip_actions": 9.19672051874914e-06}}}, "num_episodes_lifetime": 140, "num_module_steps_sampled": {"default_policy": 400}, "env_to_module_sum_episodes_length_in": 10.368238394572801, "env_to_module_connector": {"timers": {"connectors": {"numpy_to_tensor": 8.115484066641329e-06, "add_states_from_episodes_to_batch": 1.5196263478935226e-06, "add_time_dim_to_batch_and_zero_pad": 2.1203339521948114e-06, "batch_individual_items": 6.003958572370706e-06, "add_observations_from_episodes_to_batch": 2.7598757227589935e-06}}, "connector_pipeline_timer": 4.1403825029978387e-05}, "module_episode_returns_mean": {"default_policy": 1.3}, "agent_episode_returns_mean": {"default_agent": 1.3}, "env_to_module_sum_episodes_length_out": 10.368238394572801, "episode_len_max": 20, "num_agent_steps_sampled": {"default_agent": 400}, "num_module_steps_sampled_lifetime": {"default_policy": 2800}, "episode_return_max": 13.5, "sample": 0.09645301692835305, "rlmodule_inference_timer": 2.5982571579415088e-05, "env_reset_timer": 0.00021878904347570686, "episode_len_mean": 20.0, "weights_seq_no": 7.0, "episode_len_min": 20, "episode_duration_sec_mean": 0.004354913790011778, "episode_return_mean": 1.3, "num_env_steps_sampled": 400, "episode_return_min": -15.5, "num_agent_steps_sampled_lifetime": {"default_agent": 2800}, "num_episodes": 20, "env_step_timer": 1.3669116391308432e-05, "num_env_steps_sampled_lifetime": 35400, "time_between_sampling": 1.5949492748693552}, "num_healthy_workers": 1, "actor_manager_num_outstanding_async_reqs": 0, "num_remote_worker_restarts": 0}, "num_env_steps_sampled_lifetime": -3077500.0, "fault_tolerance": {"num_healthy_workers": 0, "num_remote_worker_restarts": 0}, "env_runner_group": {"actor_manager_num_outstanding_async_reqs": 0}, "done": false, "training_iteration": 7, "trial_id": "4649a_00000", "date": "2025-08-11_19-36-21", "timestamp": 1754933781, "time_this_iter_s": 1.5368242263793945, "time_total_s": 11.570542573928833, "pid": 28167, "hostname": "Mac", "node_ip": "127.0.0.1", "config": {"exploration_config": {}, "extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "placement_strategy": "PACK", "num_gpus": 0, "_fake_gpus": false, "num_cpus_for_main_process": 2, "eager_tracing": true, "eager_max_retraces": 20, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "torch_compile_learner": false, "torch_compile_learner_what_to_compile": "forward_train", "torch_compile_learner_dynamo_backend": "aot_eager", "torch_compile_learner_dynamo_mode": null, "torch_compile_worker": false, "torch_compile_worker_dynamo_backend": "aot_eager", "torch_compile_worker_dynamo_mode": null, "torch_ddp_kwargs": {}, "torch_skip_nan_gradients": false, "env": "Umbrella", "env_config": {}, "observation_space": null, "action_space": null, "clip_rewards": null, "normalize_actions": true, "clip_actions": false, "_is_atari": null, "disable_env_checking": false, "render_env": false, "action_mask_key": "action_mask", "env_runner_cls": null, "num_env_runners": 0, "create_local_env_runner": true, "num_envs_per_env_runner": 1, "gym_env_vectorize_mode": "SYNC", "num_cpus_per_env_runner": 1, "num_gpus_per_env_runner": 0, "custom_resources_per_env_runner": {}, "validate_env_runners_after_construction": true, "episodes_to_numpy": true, "max_requests_in_flight_per_env_runner": 1, "sample_timeout_s": 60.0, "_env_to_module_connector": null, "add_default_connectors_to_env_to_module_pipeline": true, "_module_to_env_connector": null, "add_default_connectors_to_module_to_env_pipeline": true, "merge_env_runner_states": "training_only", "broadcast_env_runner_states": true, "episode_lookback_horizon": 1, "rollout_fragment_length": "auto", "batch_mode": "complete_episodes", "compress_observations": false, "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "enable_tf1_exec_eagerly": false, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "preprocessor_pref": "deepmind", "observation_filter": "NoFilter", "update_worker_filter_stats": true, "use_worker_filter_stats": true, "sampler_perf_stats_ema_coef": null, "_is_online": true, "num_learners": 0, "num_gpus_per_learner": 0, "num_cpus_per_learner": "auto", "num_aggregator_actors_per_learner": 0, "max_requests_in_flight_per_aggregator_actor": 3, "local_gpu_idx": 0, "max_requests_in_flight_per_learner": 3, "gamma": 1, "lr": 0.0002847858517, "grad_clip": 0.5, "grad_clip_by": "global_norm", "_train_batch_size_per_learner": 5000, "train_batch_size": 4000, "num_epochs": 1, "minibatch_size": 1000, "shuffle_batch_per_epoch": true, "model": {"fcnet_hiddens": [256, 256], "fcnet_activation": "tanh", "fcnet_weights_initializer": null, "fcnet_weights_initializer_config": null, "fcnet_bias_initializer": null, "fcnet_bias_initializer_config": null, "conv_filters": null, "conv_activation": "relu", "conv_kernel_initializer": null, "conv_kernel_initializer_config": null, "conv_bias_initializer": null, "conv_bias_initializer_config": null, "conv_transpose_kernel_initializer": null, "conv_transpose_kernel_initializer_config": null, "conv_transpose_bias_initializer": null, "conv_transpose_bias_initializer_config": null, "post_fcnet_hiddens": [], "post_fcnet_activation": "relu", "post_fcnet_weights_initializer": null, "post_fcnet_weights_initializer_config": null, "post_fcnet_bias_initializer": null, "post_fcnet_bias_initializer_config": null, "free_log_std": false, "log_std_clip_param": 20.0, "no_final_linear": false, "vf_share_layers": false, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "lstm_weights_initializer": null, "lstm_weights_initializer_config": null, "lstm_bias_initializer": null, "lstm_bias_initializer_config": null, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "attention_use_n_prev_actions": 0, "attention_use_n_prev_rewards": 0, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": null, "custom_model_config": {}, "custom_action_dist": null, "custom_preprocessor": null, "encoder_latent_dim": null, "always_check_shapes": false, "lstm_use_prev_action_reward": -1, "_use_default_native_models": -1, "_disable_preprocessor_api": false, "_disable_action_flattening": false}, "_learner_connector": null, "add_default_connectors_to_learner_pipeline": true, "learner_config_dict": {}, "optimizer": {}, "_learner_class": null, "callbacks_on_algorithm_init": null, "callbacks_on_env_runners_recreated": null, "callbacks_on_offline_eval_runners_recreated": null, "callbacks_on_checkpoint_loaded": null, "callbacks_on_environment_created": null, "callbacks_on_episode_created": null, "callbacks_on_episode_start": null, "callbacks_on_episode_step": null, "callbacks_on_episode_end": null, "callbacks_on_evaluate_start": null, "callbacks_on_evaluate_end": null, "callbacks_on_evaluate_offline_start": null, "callbacks_on_evaluate_offline_end": null, "callbacks_on_sample_end": null, "callbacks_on_train_result": null, "explore": true, "enable_rl_module_and_learner": true, "enable_env_runner_and_connector_v2": true, "_prior_exploration_config": {"type": "StochasticSampling"}, "count_steps_by": "env_steps", "policy_map_capacity": 100, "policy_mapping_fn": "<function AlgorithmConfig.DEFAULT_POLICY_MAPPING_FN at 0x17c065b20>", "policies_to_train": null, "policy_states_are_swappable": false, "observation_fn": null, "offline_data_class": null, "input_read_method": "read_parquet", "input_read_method_kwargs": {}, "input_read_schema": {}, "input_read_episodes": false, "input_read_sample_batches": false, "input_read_batch_size": null, "input_filesystem": null, "input_filesystem_kwargs": {}, "input_compress_columns": ["obs", "new_obs"], "input_spaces_jsonable": true, "materialize_data": false, "materialize_mapped_data": true, "map_batches_kwargs": {}, "iter_batches_kwargs": {}, "ignore_final_observation": false, "prelearner_class": null, "prelearner_buffer_class": null, "prelearner_buffer_kwargs": {}, "prelearner_module_synch_period": 10, "dataset_num_iters_per_learner": null, "input_config": {}, "actions_in_input_normalized": false, "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_config": {}, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "output_max_rows_per_file": null, "output_write_remaining_data": false, "output_write_method": "write_parquet", "output_write_method_kwargs": {}, "output_filesystem": null, "output_filesystem_kwargs": {}, "output_write_episodes": true, "offline_sampling": false, "evaluation_interval": 1, "evaluation_duration": 20, "evaluation_duration_unit": "episodes", "evaluation_sample_timeout_s": 120.0, "evaluation_auto_duration_min_env_steps_per_sample": 100, "evaluation_auto_duration_max_env_steps_per_sample": 2000, "evaluation_parallel_to_training": false, "evaluation_force_reset_envs_before_iteration": true, "evaluation_config": null, "off_policy_estimation_methods": {}, "ope_split_batch_by_episode": true, "evaluation_num_env_runners": 1, "in_evaluation": false, "sync_filters_on_rollout_workers_timeout_s": 10.0, "offline_evaluation_interval": null, "num_offline_eval_runners": 0, "offline_loss_for_module_fn": null, "offline_evaluation_duration": 1, "offline_evaluation_parallel_to_training": false, "offline_evaluation_timeout_s": 120.0, "num_cpus_per_offline_eval_runner": 1, "num_gpus_per_offline_eval_runner": 0, "custom_resources_per_offline_eval_runner": {}, "restart_failed_offline_eval_runners": true, "ignore_offline_eval_runner_failures": false, "max_num_offline_eval_runner_restarts": 1000, "offline_eval_runner_restore_timeout_s": 1800.0, "max_requests_in_flight_per_offline_eval_runner": 1, "validate_offline_eval_runners_after_construction": true, "offline_eval_runner_health_probe_timeout_s": 30.0, "offline_eval_rl_module_inference_only": false, "broadcast_offline_eval_runner_states": false, "offline_eval_batch_size_per_runner": 256, "dataset_num_iters_per_eval_runner": 1, "keep_per_episode_custom_metrics": false, "metrics_episode_collection_timeout_s": 60.0, "metrics_num_episodes_for_smoothing": 100, "min_time_s_per_iteration": null, "min_train_timesteps_per_iteration": 0, "min_sample_timesteps_per_iteration": 0, "log_gradients": true, "export_native_model_files": false, "checkpoint_trainable_policies_only": false, "logger_creator": null, "logger_config": null, "log_level": "WARN", "log_sys_usage": true, "fake_sampler": false, "seed": 5, "restart_failed_env_runners": true, "ignore_env_runner_failures": false, "max_num_env_runner_restarts": 1000, "delay_between_env_runner_restarts_s": 60.0, "restart_failed_sub_environments": false, "num_consecutive_env_runner_failures_tolerance": 100, "env_runner_health_probe_timeout_s": 30.0, "env_runner_restore_timeout_s": 1800.0, "_model_config": {}, "_rl_module_spec": "RLModuleSpec(module_class=None, observation_space=None, action_space=None, inference_only=False, learner_only=False, model_config=DefaultModelConfig(fcnet_hiddens=[60, 90], fcnet_activation='tanh', fcnet_kernel_initializer=None, fcnet_kernel_initializer_kwargs=None, fcnet_bias_initializer=None, fcnet_bias_initializer_kwargs=None, conv_filters=None, conv_activation='relu', conv_kernel_initializer=None, conv_kernel_initializer_kwargs=None, conv_bias_initializer=None, conv_bias_initializer_kwargs=None, head_fcnet_hiddens=[], head_fcnet_activation='relu', head_fcnet_kernel_initializer=None, head_fcnet_kernel_initializer_kwargs=None, head_fcnet_bias_initializer=None, head_fcnet_bias_initializer_kwargs=None, free_log_std=False, log_std_clip_param=20.0, vf_share_layers=True, use_lstm=False, max_seq_len=20, lstm_cell_size=256, lstm_use_prev_action=False, lstm_use_prev_reward=False, lstm_kernel_initializer=None, lstm_kernel_initializer_kwargs=None, lstm_bias_initializer=None, lstm_bias_initializer_kwargs=None), catalog_class=None, load_state_path=None, model_config_dict=None)", "algorithm_config_overrides_per_module": {}, "_per_module_overrides": {}, "_validate_config": true, "_use_msgpack_checkpoints": false, "_torch_grad_scaler_class": null, "_torch_lr_scheduler_classes": null, "_tf_policy_handles_more_than_one_loss": false, "_disable_preprocessor_api": false, "_disable_action_flattening": false, "_disable_initialize_loss_from_dummy_batch": false, "_dont_auto_sync_env_runner_states": false, "env_task_fn": -1, "enable_connectors": -1, "simple_optimizer": false, "policy_map_cache": -1, "worker_cls": -1, "synchronize_filters": -1, "enable_async_evaluation": -1, "custom_async_evaluation_function": -1, "_enable_rl_module_api": -1, "auto_wrap_old_gym_envs": -1, "always_attach_evaluation_results": -1, "replay_sequence_length": null, "_disable_execution_plan_api": -1, "use_critic": true, "use_gae": true, "use_kl_loss": true, "kl_coeff": 0.7464963036515, "kl_target": 0.0270990929592, "vf_loss_coeff": 0.6688075857018, "entropy_coeff": 0.0090570820258, "clip_param": 0.1221781641624, "vf_clip_param": 0.1027808522125, "entropy_coeff_schedule": null, "lr_schedule": null, "sgd_minibatch_size": -1, "vf_share_layers": -1, "__stdout_file__": null, "__stderr_file__": null, "lambda": 0.9099046732075, "input": "sampler", "policies": {"default_policy": [null, null, null, null]}, "callbacks": "<class 'ray.rllib.callbacks.callbacks.RLlibCallback'>", "create_env_on_driver": false, "custom_eval_function": null, "framework": "torch"}, "time_since_restore": 11.570542573928833, "iterations_since_restore": 7, "perf": {"cpu_util_percent": 32.25, "ram_util_percent": 74.95}}
{"timers": {"training_iteration": 1.5329294802569464, "restore_env_runners": 7.861407492417804e-06, "training_step": 1.5327955975679444, "env_runner_sampling_timer": 1.4264054053405748, "learner_update_timer": 0.10330266088365465, "synch_weights": 0.0006166315553109276, "restore_eval_env_runners": 9.174568544111012e-06, "evaluation_iteration": 0.10266543408160021, "synch_eval_env_connectors": 0.00012009208995914816, "synch_env_connectors": 4.57507645970991e-06}, "env_runners": {"env_to_module_connector": {"timers": {"connectors": {"numpy_to_tensor": 8.290924057906809e-06, "add_states_from_episodes_to_batch": 1.7030130911154868e-06, "batch_individual_items": 6.21686546266748e-06, "add_observations_from_episodes_to_batch": 2.9995626362660772e-06, "add_time_dim_to_batch_and_zero_pad": 2.2775842460368254e-06}}, "connector_pipeline_timer": 4.3277758750272273e-05}, "num_agent_steps_sampled_lifetime": {"default_agent": -3695000.0}, "env_to_module_sum_episodes_length_out": 10.36823839457432, "num_episodes": 250.0, "episode_len_max": 20, "num_module_steps_sampled": {"default_policy": 5000.0}, "module_to_env_connector": {"timers": {"connectors": {"un_batch_to_individual_items": 5.297895000051888e-06, "listify_data_for_vector_env": 1.0630235817864554e-05, "normalize_and_clip_actions": 9.138097647078978e-06, "get_actions": 3.665559785160366e-05, "tensor_to_numpy": 1.2671715913563679e-05, "remove_single_ts_time_rank_from_batch": 5.706580799485444e-07}}, "connector_pipeline_timer": 0.00010062779435323573}, "num_module_steps_sampled_lifetime": {"default_policy": -3695000.0}, "num_episodes_lifetime": -184750.0, "episode_len_min": 20, "episode_return_max": 6.5, "env_to_module_sum_episodes_length_in": 10.36823839457432, "env_step_timer": 1.3544562508241615e-05, "sample": 0.004988388330973068, "rlmodule_inference_timer": 4.162748385418343e-05, "episode_duration_sec_mean": 0.004769764956086873, "episode_return_mean": 0.26, "module_episode_returns_mean": {"default_policy": 0.26}, "env_reset_timer": 2.946988221138233e-05, "num_env_steps_sampled_lifetime": -3695000.0, "num_env_steps_sampled": 5000.0, "episode_return_min": -13.5, "episode_len_mean": 20.0, "weights_seq_no": 7.0, "num_agent_steps_sampled": {"default_agent": 5000.0}, "time_between_sampling": 0.001464660226221601, "agent_episode_returns_mean": {"default_agent": 0.26}, "num_env_steps_sampled_lifetime_throughput": 3823.564344311343}, "learners": {"default_policy": {"policy_loss": -0.0741666927933693, "vf_loss": 0.10278083384037018, "vf_loss_unclipped": 26.320615768432617, "num_module_steps_trained": 6000, "diff_num_grad_updates_vs_sampler_policy": 1.0, "default_optimizer_learning_rate": 0.0002847858517, "weights_seq_no": 8.0, "total_loss": -0.010954849421977997, "vf_explained_var": -0.016090035438537598, "module_train_batch_size_mean": 1000.0, "num_module_steps_trained_lifetime": 48000, "gradients_default_optimizer_global_norm": 0.0506206676363945, "entropy": 0.6119840741157532, "curr_entropy_coeff": 0.0090570820258, "num_trainable_parameters": 6003, "curr_kl_coeff": 0.0029160012491047382, "mean_kl_loss": 0.002404420170933008, "num_module_steps_trained_lifetime_throughput": 448555.8458381775}, "__all_modules__": {"learner_connector": {"timers": {"connectors": {"batch_individual_items": 0.031538144956273224, "add_observations_from_episodes_to_batch": 0.000778632883722065, "add_columns_from_episodes_to_train_batch": 0.03359261970929429, "general_advantage_estimation": 0.00624489390243412, "add_time_dim_to_batch_and_zero_pad": 9.058747289275611e-06, "numpy_to_tensor": 6.248868286247157e-05, "add_states_from_episodes_to_batch": 3.0515006445100474e-06, "add_one_ts_to_episodes_and_truncate": 0.007475337190260024}}, "connector_pipeline_timer": 0.07981102895589817}, "num_trainable_parameters": 6003, "num_env_steps_trained_lifetime": 252000, "num_module_steps_trained": 6000, "num_non_trainable_parameters": 0, "num_env_steps_trained": 31500, "num_module_steps_trained_lifetime": 48000, "learner_connector_sum_episodes_length_in": 5000.0, "learner_connector_sum_episodes_length_out": 5250.0, "num_env_steps_trained_lifetime_throughput": 2340619.3241714467, "num_module_steps_trained_throughput": 447697.1674892377, "num_module_steps_trained_lifetime_throughput": 446915.5223317247}}, "num_training_step_calls_per_iteration": 1, "evaluation": {"env_runners": {"module_to_env_connector": {"connector_pipeline_timer": 9.625076192262136e-05, "timers": {"connectors": {"listify_data_for_vector_env": 1.057381391299867e-05, "get_actions": 3.366460558208303e-05, "remove_single_ts_time_rank_from_batch": 5.586466961395127e-07, "tensor_to_numpy": 1.2250889220306286e-05, "un_batch_to_individual_items": 5.224158852077794e-06, "normalize_and_clip_actions": 9.137229388366387e-06}}}, "num_episodes_lifetime": 160, "num_module_steps_sampled": {"default_policy": 400}, "env_to_module_sum_episodes_length_in": 10.3682383945743, "env_to_module_connector": {"timers": {"connectors": {"numpy_to_tensor": 8.066955066922214e-06, "add_states_from_episodes_to_batch": 1.5414023419810296e-06, "add_time_dim_to_batch_and_zero_pad": 2.1412848172278837e-06, "batch_individual_items": 5.953457646180401e-06, "add_observations_from_episodes_to_batch": 2.7698754076879557e-06}}, "connector_pipeline_timer": 4.167212866076719e-05}, "module_episode_returns_mean": {"default_policy": 1.9}, "agent_episode_returns_mean": {"default_agent": 1.9}, "env_to_module_sum_episodes_length_out": 10.3682383945743, "episode_len_max": 20, "num_agent_steps_sampled": {"default_agent": 400}, "num_module_steps_sampled_lifetime": {"default_policy": 3200}, "episode_return_max": 13.5, "sample": 0.09643166092916684, "rlmodule_inference_timer": 2.596310085684263e-05, "env_reset_timer": 0.00021733448342112132, "episode_len_mean": 20.0, "weights_seq_no": 8.0, "episode_len_min": 20, "episode_duration_sec_mean": 0.004340531260240823, "episode_return_mean": 1.9, "num_env_steps_sampled": 400, "episode_return_min": -15.5, "num_agent_steps_sampled_lifetime": {"default_agent": 3200}, "num_episodes": 20, "env_step_timer": 1.3501905736342147e-05, "num_env_steps_sampled_lifetime": 40400, "time_between_sampling": 1.594321540040981}, "num_healthy_workers": 1, "actor_manager_num_outstanding_async_reqs": 0, "num_remote_worker_restarts": 0}, "num_env_steps_sampled_lifetime": -3695000.0, "fault_tolerance": {"num_healthy_workers": 0, "num_remote_worker_restarts": 0}, "env_runner_group": {"actor_manager_num_outstanding_async_reqs": 0}, "done": false, "training_iteration": 8, "trial_id": "4649a_00000", "date": "2025-08-11_19-36-23", "timestamp": 1754933783, "time_this_iter_s": 1.6173131465911865, "time_total_s": 13.18785572052002, "pid": 28167, "hostname": "Mac", "node_ip": "127.0.0.1", "config": {"exploration_config": {}, "extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "placement_strategy": "PACK", "num_gpus": 0, "_fake_gpus": false, "num_cpus_for_main_process": 2, "eager_tracing": true, "eager_max_retraces": 20, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "torch_compile_learner": false, "torch_compile_learner_what_to_compile": "forward_train", "torch_compile_learner_dynamo_backend": "aot_eager", "torch_compile_learner_dynamo_mode": null, "torch_compile_worker": false, "torch_compile_worker_dynamo_backend": "aot_eager", "torch_compile_worker_dynamo_mode": null, "torch_ddp_kwargs": {}, "torch_skip_nan_gradients": false, "env": "Umbrella", "env_config": {}, "observation_space": null, "action_space": null, "clip_rewards": null, "normalize_actions": true, "clip_actions": false, "_is_atari": null, "disable_env_checking": false, "render_env": false, "action_mask_key": "action_mask", "env_runner_cls": null, "num_env_runners": 0, "create_local_env_runner": true, "num_envs_per_env_runner": 1, "gym_env_vectorize_mode": "SYNC", "num_cpus_per_env_runner": 1, "num_gpus_per_env_runner": 0, "custom_resources_per_env_runner": {}, "validate_env_runners_after_construction": true, "episodes_to_numpy": true, "max_requests_in_flight_per_env_runner": 1, "sample_timeout_s": 60.0, "_env_to_module_connector": null, "add_default_connectors_to_env_to_module_pipeline": true, "_module_to_env_connector": null, "add_default_connectors_to_module_to_env_pipeline": true, "merge_env_runner_states": "training_only", "broadcast_env_runner_states": true, "episode_lookback_horizon": 1, "rollout_fragment_length": "auto", "batch_mode": "complete_episodes", "compress_observations": false, "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "enable_tf1_exec_eagerly": false, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "preprocessor_pref": "deepmind", "observation_filter": "NoFilter", "update_worker_filter_stats": true, "use_worker_filter_stats": true, "sampler_perf_stats_ema_coef": null, "_is_online": true, "num_learners": 0, "num_gpus_per_learner": 0, "num_cpus_per_learner": "auto", "num_aggregator_actors_per_learner": 0, "max_requests_in_flight_per_aggregator_actor": 3, "local_gpu_idx": 0, "max_requests_in_flight_per_learner": 3, "gamma": 1, "lr": 0.0002847858517, "grad_clip": 0.5, "grad_clip_by": "global_norm", "_train_batch_size_per_learner": 5000, "train_batch_size": 4000, "num_epochs": 1, "minibatch_size": 1000, "shuffle_batch_per_epoch": true, "model": {"fcnet_hiddens": [256, 256], "fcnet_activation": "tanh", "fcnet_weights_initializer": null, "fcnet_weights_initializer_config": null, "fcnet_bias_initializer": null, "fcnet_bias_initializer_config": null, "conv_filters": null, "conv_activation": "relu", "conv_kernel_initializer": null, "conv_kernel_initializer_config": null, "conv_bias_initializer": null, "conv_bias_initializer_config": null, "conv_transpose_kernel_initializer": null, "conv_transpose_kernel_initializer_config": null, "conv_transpose_bias_initializer": null, "conv_transpose_bias_initializer_config": null, "post_fcnet_hiddens": [], "post_fcnet_activation": "relu", "post_fcnet_weights_initializer": null, "post_fcnet_weights_initializer_config": null, "post_fcnet_bias_initializer": null, "post_fcnet_bias_initializer_config": null, "free_log_std": false, "log_std_clip_param": 20.0, "no_final_linear": false, "vf_share_layers": false, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "lstm_weights_initializer": null, "lstm_weights_initializer_config": null, "lstm_bias_initializer": null, "lstm_bias_initializer_config": null, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "attention_use_n_prev_actions": 0, "attention_use_n_prev_rewards": 0, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": null, "custom_model_config": {}, "custom_action_dist": null, "custom_preprocessor": null, "encoder_latent_dim": null, "always_check_shapes": false, "lstm_use_prev_action_reward": -1, "_use_default_native_models": -1, "_disable_preprocessor_api": false, "_disable_action_flattening": false}, "_learner_connector": null, "add_default_connectors_to_learner_pipeline": true, "learner_config_dict": {}, "optimizer": {}, "_learner_class": null, "callbacks_on_algorithm_init": null, "callbacks_on_env_runners_recreated": null, "callbacks_on_offline_eval_runners_recreated": null, "callbacks_on_checkpoint_loaded": null, "callbacks_on_environment_created": null, "callbacks_on_episode_created": null, "callbacks_on_episode_start": null, "callbacks_on_episode_step": null, "callbacks_on_episode_end": null, "callbacks_on_evaluate_start": null, "callbacks_on_evaluate_end": null, "callbacks_on_evaluate_offline_start": null, "callbacks_on_evaluate_offline_end": null, "callbacks_on_sample_end": null, "callbacks_on_train_result": null, "explore": true, "enable_rl_module_and_learner": true, "enable_env_runner_and_connector_v2": true, "_prior_exploration_config": {"type": "StochasticSampling"}, "count_steps_by": "env_steps", "policy_map_capacity": 100, "policy_mapping_fn": "<function AlgorithmConfig.DEFAULT_POLICY_MAPPING_FN at 0x17c065b20>", "policies_to_train": null, "policy_states_are_swappable": false, "observation_fn": null, "offline_data_class": null, "input_read_method": "read_parquet", "input_read_method_kwargs": {}, "input_read_schema": {}, "input_read_episodes": false, "input_read_sample_batches": false, "input_read_batch_size": null, "input_filesystem": null, "input_filesystem_kwargs": {}, "input_compress_columns": ["obs", "new_obs"], "input_spaces_jsonable": true, "materialize_data": false, "materialize_mapped_data": true, "map_batches_kwargs": {}, "iter_batches_kwargs": {}, "ignore_final_observation": false, "prelearner_class": null, "prelearner_buffer_class": null, "prelearner_buffer_kwargs": {}, "prelearner_module_synch_period": 10, "dataset_num_iters_per_learner": null, "input_config": {}, "actions_in_input_normalized": false, "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_config": {}, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "output_max_rows_per_file": null, "output_write_remaining_data": false, "output_write_method": "write_parquet", "output_write_method_kwargs": {}, "output_filesystem": null, "output_filesystem_kwargs": {}, "output_write_episodes": true, "offline_sampling": false, "evaluation_interval": 1, "evaluation_duration": 20, "evaluation_duration_unit": "episodes", "evaluation_sample_timeout_s": 120.0, "evaluation_auto_duration_min_env_steps_per_sample": 100, "evaluation_auto_duration_max_env_steps_per_sample": 2000, "evaluation_parallel_to_training": false, "evaluation_force_reset_envs_before_iteration": true, "evaluation_config": null, "off_policy_estimation_methods": {}, "ope_split_batch_by_episode": true, "evaluation_num_env_runners": 1, "in_evaluation": false, "sync_filters_on_rollout_workers_timeout_s": 10.0, "offline_evaluation_interval": null, "num_offline_eval_runners": 0, "offline_loss_for_module_fn": null, "offline_evaluation_duration": 1, "offline_evaluation_parallel_to_training": false, "offline_evaluation_timeout_s": 120.0, "num_cpus_per_offline_eval_runner": 1, "num_gpus_per_offline_eval_runner": 0, "custom_resources_per_offline_eval_runner": {}, "restart_failed_offline_eval_runners": true, "ignore_offline_eval_runner_failures": false, "max_num_offline_eval_runner_restarts": 1000, "offline_eval_runner_restore_timeout_s": 1800.0, "max_requests_in_flight_per_offline_eval_runner": 1, "validate_offline_eval_runners_after_construction": true, "offline_eval_runner_health_probe_timeout_s": 30.0, "offline_eval_rl_module_inference_only": false, "broadcast_offline_eval_runner_states": false, "offline_eval_batch_size_per_runner": 256, "dataset_num_iters_per_eval_runner": 1, "keep_per_episode_custom_metrics": false, "metrics_episode_collection_timeout_s": 60.0, "metrics_num_episodes_for_smoothing": 100, "min_time_s_per_iteration": null, "min_train_timesteps_per_iteration": 0, "min_sample_timesteps_per_iteration": 0, "log_gradients": true, "export_native_model_files": false, "checkpoint_trainable_policies_only": false, "logger_creator": null, "logger_config": null, "log_level": "WARN", "log_sys_usage": true, "fake_sampler": false, "seed": 5, "restart_failed_env_runners": true, "ignore_env_runner_failures": false, "max_num_env_runner_restarts": 1000, "delay_between_env_runner_restarts_s": 60.0, "restart_failed_sub_environments": false, "num_consecutive_env_runner_failures_tolerance": 100, "env_runner_health_probe_timeout_s": 30.0, "env_runner_restore_timeout_s": 1800.0, "_model_config": {}, "_rl_module_spec": "RLModuleSpec(module_class=None, observation_space=None, action_space=None, inference_only=False, learner_only=False, model_config=DefaultModelConfig(fcnet_hiddens=[60, 90], fcnet_activation='tanh', fcnet_kernel_initializer=None, fcnet_kernel_initializer_kwargs=None, fcnet_bias_initializer=None, fcnet_bias_initializer_kwargs=None, conv_filters=None, conv_activation='relu', conv_kernel_initializer=None, conv_kernel_initializer_kwargs=None, conv_bias_initializer=None, conv_bias_initializer_kwargs=None, head_fcnet_hiddens=[], head_fcnet_activation='relu', head_fcnet_kernel_initializer=None, head_fcnet_kernel_initializer_kwargs=None, head_fcnet_bias_initializer=None, head_fcnet_bias_initializer_kwargs=None, free_log_std=False, log_std_clip_param=20.0, vf_share_layers=True, use_lstm=False, max_seq_len=20, lstm_cell_size=256, lstm_use_prev_action=False, lstm_use_prev_reward=False, lstm_kernel_initializer=None, lstm_kernel_initializer_kwargs=None, lstm_bias_initializer=None, lstm_bias_initializer_kwargs=None), catalog_class=None, load_state_path=None, model_config_dict=None)", "algorithm_config_overrides_per_module": {}, "_per_module_overrides": {}, "_validate_config": true, "_use_msgpack_checkpoints": false, "_torch_grad_scaler_class": null, "_torch_lr_scheduler_classes": null, "_tf_policy_handles_more_than_one_loss": false, "_disable_preprocessor_api": false, "_disable_action_flattening": false, "_disable_initialize_loss_from_dummy_batch": false, "_dont_auto_sync_env_runner_states": false, "env_task_fn": -1, "enable_connectors": -1, "simple_optimizer": false, "policy_map_cache": -1, "worker_cls": -1, "synchronize_filters": -1, "enable_async_evaluation": -1, "custom_async_evaluation_function": -1, "_enable_rl_module_api": -1, "auto_wrap_old_gym_envs": -1, "always_attach_evaluation_results": -1, "replay_sequence_length": null, "_disable_execution_plan_api": -1, "use_critic": true, "use_gae": true, "use_kl_loss": true, "kl_coeff": 0.7464963036515, "kl_target": 0.0270990929592, "vf_loss_coeff": 0.6688075857018, "entropy_coeff": 0.0090570820258, "clip_param": 0.1221781641624, "vf_clip_param": 0.1027808522125, "entropy_coeff_schedule": null, "lr_schedule": null, "sgd_minibatch_size": -1, "vf_share_layers": -1, "__stdout_file__": null, "__stderr_file__": null, "lambda": 0.9099046732075, "input": "sampler", "policies": {"default_policy": [null, null, null, null]}, "callbacks": "<class 'ray.rllib.callbacks.callbacks.RLlibCallback'>", "create_env_on_driver": false, "custom_eval_function": null, "framework": "torch"}, "time_since_restore": 13.18785572052002, "iterations_since_restore": 8, "perf": {"cpu_util_percent": 35.099999999999994, "ram_util_percent": 75.0}}
{"timers": {"training_iteration": 1.532787031284553, "restore_env_runners": 7.831543497661872e-06, "training_step": 1.5326530090922088, "env_runner_sampling_timer": 1.425550575036937, "learner_update_timer": 0.10401644718465965, "synch_weights": 0.0006159914890547816, "restore_eval_env_runners": 9.145322752499128e-06, "evaluation_iteration": 0.10262878183089559, "synch_eval_env_connectors": 0.0001199028286836117, "synch_env_connectors": 4.572665955275761e-06}, "env_runners": {"env_to_module_connector": {"timers": {"connectors": {"numpy_to_tensor": 8.283328520873882e-06, "add_states_from_episodes_to_batch": 1.7179318551511333e-06, "batch_individual_items": 6.191937901867492e-06, "add_observations_from_episodes_to_batch": 2.8929141481922404e-06, "add_time_dim_to_batch_and_zero_pad": 2.2806193638976536e-06}}, "connector_pipeline_timer": 4.312134741552088e-05}, "num_agent_steps_sampled_lifetime": {"default_agent": -4312500.0}, "env_to_module_sum_episodes_length_out": 10.36823839457432, "num_episodes": 250.0, "episode_len_max": 20, "num_module_steps_sampled": {"default_policy": 5000.0}, "module_to_env_connector": {"timers": {"connectors": {"un_batch_to_individual_items": 5.290480699586321e-06, "listify_data_for_vector_env": 1.0625512208078649e-05, "normalize_and_clip_actions": 9.184283035903143e-06, "get_actions": 3.636541701030013e-05, "tensor_to_numpy": 1.2673304643094006e-05, "remove_single_ts_time_rank_from_batch": 5.701275702011161e-07}}, "connector_pipeline_timer": 0.00010031130578114644}, "num_module_steps_sampled_lifetime": {"default_policy": -4312500.0}, "num_episodes_lifetime": -215625.0, "episode_len_min": 20, "episode_return_max": 6.5, "env_to_module_sum_episodes_length_in": 10.36823839457432, "env_step_timer": 1.3558080309301242e-05, "sample": 0.004798111765801889, "rlmodule_inference_timer": 2.663156763399454e-05, "episode_duration_sec_mean": 0.004433208471629768, "episode_return_mean": 1.8600000000000003, "module_episode_returns_mean": {"default_policy": 1.8600000000000003}, "env_reset_timer": 2.9606046657670106e-05, "num_env_steps_sampled_lifetime": -4312500.0, "num_env_steps_sampled": 5000.0, "episode_return_min": -13.5, "episode_len_mean": 20.0, "weights_seq_no": 8.0, "num_agent_steps_sampled": {"default_agent": 5000.0}, "time_between_sampling": 0.0014398706652297047, "agent_episode_returns_mean": {"default_agent": 1.8600000000000003}, "num_env_steps_sampled_lifetime_throughput": 3836.75975403404}, "learners": {"default_policy": {"policy_loss": 0.07479322701692581, "vf_loss": 0.10278083384037018, "vf_loss_unclipped": 26.345033645629883, "num_module_steps_trained": 6000, "diff_num_grad_updates_vs_sampler_policy": 1.0, "default_optimizer_learning_rate": 0.0002847858517, "weights_seq_no": 9.0, "total_loss": 0.13819031417369843, "vf_explained_var": -0.01631009578704834, "module_train_batch_size_mean": 1000.0, "num_module_steps_trained_lifetime": 54000, "gradients_default_optimizer_global_norm": 0.02396991103887558, "entropy": 0.5902684926986694, "curr_entropy_coeff": 0.0090570820258, "num_trainable_parameters": 6003, "curr_kl_coeff": 0.0014580006245523691, "mean_kl_loss": 0.0008853764156810939, "num_module_steps_trained_lifetime_throughput": 450295.7875031981}, "__all_modules__": {"learner_connector": {"timers": {"connectors": {"batch_individual_items": 0.03152394058696549, "add_observations_from_episodes_to_batch": 0.0007788744751514576, "add_columns_from_episodes_to_train_batch": 0.033594733922043846, "general_advantage_estimation": 0.0062323170428082615, "add_time_dim_to_batch_and_zero_pad": 9.048159261389106e-06, "numpy_to_tensor": 6.244129519252729e-05, "add_states_from_episodes_to_batch": 3.0472361289837026e-06, "add_one_ts_to_episodes_and_truncate": 0.008330241318594651}}, "connector_pipeline_timer": 0.08064125699653168}, "num_trainable_parameters": 6003, "num_env_steps_trained_lifetime": 283500, "num_module_steps_trained": 6000, "num_non_trainable_parameters": 0, "num_env_steps_trained": 31500, "num_module_steps_trained_lifetime": 54000, "learner_connector_sum_episodes_length_in": 5000.0, "learner_connector_sum_episodes_length_out": 5250.0, "num_env_steps_trained_lifetime_throughput": 2350518.168491803, "num_module_steps_trained_throughput": 449513.31803093565, "num_module_steps_trained_lifetime_throughput": 448755.6981412367}}, "num_training_step_calls_per_iteration": 1, "evaluation": {"env_runners": {"module_to_env_connector": {"connector_pipeline_timer": 9.646690315183607e-05, "timers": {"connectors": {"listify_data_for_vector_env": 1.0709165707564971e-05, "get_actions": 3.371448695896529e-05, "remove_single_ts_time_rank_from_batch": 5.536973665502679e-07, "tensor_to_numpy": 1.2343752380578641e-05, "un_batch_to_individual_items": 5.269930021322228e-06, "normalize_and_clip_actions": 9.114226234695075e-06}}}, "num_episodes_lifetime": 180, "num_module_steps_sampled": {"default_policy": 400}, "env_to_module_sum_episodes_length_in": 10.368238394574323, "env_to_module_connector": {"timers": {"connectors": {"numpy_to_tensor": 7.922381902558642e-06, "add_states_from_episodes_to_batch": 1.5190943175444232e-06, "add_time_dim_to_batch_and_zero_pad": 2.1531822731763844e-06, "batch_individual_items": 5.955569928118885e-06, "add_observations_from_episodes_to_batch": 2.7525356463628874e-06}}, "connector_pipeline_timer": 4.124363637725475e-05}, "module_episode_returns_mean": {"default_policy": 2.7}, "agent_episode_returns_mean": {"default_agent": 2.7}, "env_to_module_sum_episodes_length_out": 10.368238394574323, "episode_len_max": 20, "num_agent_steps_sampled": {"default_agent": 400}, "num_module_steps_sampled_lifetime": {"default_policy": 3600}, "episode_return_max": 13.5, "sample": 0.09640939847911598, "rlmodule_inference_timer": 2.5712313951488258e-05, "env_reset_timer": 0.00021587071907727573, "episode_len_mean": 20.0, "weights_seq_no": 9.0, "episode_len_min": 20, "episode_duration_sec_mean": 0.0043376337736845015, "episode_return_mean": 2.7, "num_env_steps_sampled": 400, "episode_return_min": -15.5, "num_agent_steps_sampled_lifetime": {"default_agent": 3600}, "num_episodes": 20, "env_step_timer": 1.3606186741004782e-05, "num_env_steps_sampled_lifetime": 45400, "time_between_sampling": 1.5937232442308507}, "num_healthy_workers": 1, "actor_manager_num_outstanding_async_reqs": 0, "num_remote_worker_restarts": 0}, "num_env_steps_sampled_lifetime": -4312500.0, "fault_tolerance": {"num_healthy_workers": 0, "num_remote_worker_restarts": 0}, "env_runner_group": {"actor_manager_num_outstanding_async_reqs": 0}, "done": false, "training_iteration": 9, "trial_id": "4649a_00000", "date": "2025-08-11_19-36-25", "timestamp": 1754933785, "time_this_iter_s": 1.6195459365844727, "time_total_s": 14.807401657104492, "pid": 28167, "hostname": "Mac", "node_ip": "127.0.0.1", "config": {"exploration_config": {}, "extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "placement_strategy": "PACK", "num_gpus": 0, "_fake_gpus": false, "num_cpus_for_main_process": 2, "eager_tracing": true, "eager_max_retraces": 20, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "torch_compile_learner": false, "torch_compile_learner_what_to_compile": "forward_train", "torch_compile_learner_dynamo_backend": "aot_eager", "torch_compile_learner_dynamo_mode": null, "torch_compile_worker": false, "torch_compile_worker_dynamo_backend": "aot_eager", "torch_compile_worker_dynamo_mode": null, "torch_ddp_kwargs": {}, "torch_skip_nan_gradients": false, "env": "Umbrella", "env_config": {}, "observation_space": null, "action_space": null, "clip_rewards": null, "normalize_actions": true, "clip_actions": false, "_is_atari": null, "disable_env_checking": false, "render_env": false, "action_mask_key": "action_mask", "env_runner_cls": null, "num_env_runners": 0, "create_local_env_runner": true, "num_envs_per_env_runner": 1, "gym_env_vectorize_mode": "SYNC", "num_cpus_per_env_runner": 1, "num_gpus_per_env_runner": 0, "custom_resources_per_env_runner": {}, "validate_env_runners_after_construction": true, "episodes_to_numpy": true, "max_requests_in_flight_per_env_runner": 1, "sample_timeout_s": 60.0, "_env_to_module_connector": null, "add_default_connectors_to_env_to_module_pipeline": true, "_module_to_env_connector": null, "add_default_connectors_to_module_to_env_pipeline": true, "merge_env_runner_states": "training_only", "broadcast_env_runner_states": true, "episode_lookback_horizon": 1, "rollout_fragment_length": "auto", "batch_mode": "complete_episodes", "compress_observations": false, "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "enable_tf1_exec_eagerly": false, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "preprocessor_pref": "deepmind", "observation_filter": "NoFilter", "update_worker_filter_stats": true, "use_worker_filter_stats": true, "sampler_perf_stats_ema_coef": null, "_is_online": true, "num_learners": 0, "num_gpus_per_learner": 0, "num_cpus_per_learner": "auto", "num_aggregator_actors_per_learner": 0, "max_requests_in_flight_per_aggregator_actor": 3, "local_gpu_idx": 0, "max_requests_in_flight_per_learner": 3, "gamma": 1, "lr": 0.0002847858517, "grad_clip": 0.5, "grad_clip_by": "global_norm", "_train_batch_size_per_learner": 5000, "train_batch_size": 4000, "num_epochs": 1, "minibatch_size": 1000, "shuffle_batch_per_epoch": true, "model": {"fcnet_hiddens": [256, 256], "fcnet_activation": "tanh", "fcnet_weights_initializer": null, "fcnet_weights_initializer_config": null, "fcnet_bias_initializer": null, "fcnet_bias_initializer_config": null, "conv_filters": null, "conv_activation": "relu", "conv_kernel_initializer": null, "conv_kernel_initializer_config": null, "conv_bias_initializer": null, "conv_bias_initializer_config": null, "conv_transpose_kernel_initializer": null, "conv_transpose_kernel_initializer_config": null, "conv_transpose_bias_initializer": null, "conv_transpose_bias_initializer_config": null, "post_fcnet_hiddens": [], "post_fcnet_activation": "relu", "post_fcnet_weights_initializer": null, "post_fcnet_weights_initializer_config": null, "post_fcnet_bias_initializer": null, "post_fcnet_bias_initializer_config": null, "free_log_std": false, "log_std_clip_param": 20.0, "no_final_linear": false, "vf_share_layers": false, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "lstm_weights_initializer": null, "lstm_weights_initializer_config": null, "lstm_bias_initializer": null, "lstm_bias_initializer_config": null, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "attention_use_n_prev_actions": 0, "attention_use_n_prev_rewards": 0, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": null, "custom_model_config": {}, "custom_action_dist": null, "custom_preprocessor": null, "encoder_latent_dim": null, "always_check_shapes": false, "lstm_use_prev_action_reward": -1, "_use_default_native_models": -1, "_disable_preprocessor_api": false, "_disable_action_flattening": false}, "_learner_connector": null, "add_default_connectors_to_learner_pipeline": true, "learner_config_dict": {}, "optimizer": {}, "_learner_class": null, "callbacks_on_algorithm_init": null, "callbacks_on_env_runners_recreated": null, "callbacks_on_offline_eval_runners_recreated": null, "callbacks_on_checkpoint_loaded": null, "callbacks_on_environment_created": null, "callbacks_on_episode_created": null, "callbacks_on_episode_start": null, "callbacks_on_episode_step": null, "callbacks_on_episode_end": null, "callbacks_on_evaluate_start": null, "callbacks_on_evaluate_end": null, "callbacks_on_evaluate_offline_start": null, "callbacks_on_evaluate_offline_end": null, "callbacks_on_sample_end": null, "callbacks_on_train_result": null, "explore": true, "enable_rl_module_and_learner": true, "enable_env_runner_and_connector_v2": true, "_prior_exploration_config": {"type": "StochasticSampling"}, "count_steps_by": "env_steps", "policy_map_capacity": 100, "policy_mapping_fn": "<function AlgorithmConfig.DEFAULT_POLICY_MAPPING_FN at 0x17c065b20>", "policies_to_train": null, "policy_states_are_swappable": false, "observation_fn": null, "offline_data_class": null, "input_read_method": "read_parquet", "input_read_method_kwargs": {}, "input_read_schema": {}, "input_read_episodes": false, "input_read_sample_batches": false, "input_read_batch_size": null, "input_filesystem": null, "input_filesystem_kwargs": {}, "input_compress_columns": ["obs", "new_obs"], "input_spaces_jsonable": true, "materialize_data": false, "materialize_mapped_data": true, "map_batches_kwargs": {}, "iter_batches_kwargs": {}, "ignore_final_observation": false, "prelearner_class": null, "prelearner_buffer_class": null, "prelearner_buffer_kwargs": {}, "prelearner_module_synch_period": 10, "dataset_num_iters_per_learner": null, "input_config": {}, "actions_in_input_normalized": false, "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_config": {}, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "output_max_rows_per_file": null, "output_write_remaining_data": false, "output_write_method": "write_parquet", "output_write_method_kwargs": {}, "output_filesystem": null, "output_filesystem_kwargs": {}, "output_write_episodes": true, "offline_sampling": false, "evaluation_interval": 1, "evaluation_duration": 20, "evaluation_duration_unit": "episodes", "evaluation_sample_timeout_s": 120.0, "evaluation_auto_duration_min_env_steps_per_sample": 100, "evaluation_auto_duration_max_env_steps_per_sample": 2000, "evaluation_parallel_to_training": false, "evaluation_force_reset_envs_before_iteration": true, "evaluation_config": null, "off_policy_estimation_methods": {}, "ope_split_batch_by_episode": true, "evaluation_num_env_runners": 1, "in_evaluation": false, "sync_filters_on_rollout_workers_timeout_s": 10.0, "offline_evaluation_interval": null, "num_offline_eval_runners": 0, "offline_loss_for_module_fn": null, "offline_evaluation_duration": 1, "offline_evaluation_parallel_to_training": false, "offline_evaluation_timeout_s": 120.0, "num_cpus_per_offline_eval_runner": 1, "num_gpus_per_offline_eval_runner": 0, "custom_resources_per_offline_eval_runner": {}, "restart_failed_offline_eval_runners": true, "ignore_offline_eval_runner_failures": false, "max_num_offline_eval_runner_restarts": 1000, "offline_eval_runner_restore_timeout_s": 1800.0, "max_requests_in_flight_per_offline_eval_runner": 1, "validate_offline_eval_runners_after_construction": true, "offline_eval_runner_health_probe_timeout_s": 30.0, "offline_eval_rl_module_inference_only": false, "broadcast_offline_eval_runner_states": false, "offline_eval_batch_size_per_runner": 256, "dataset_num_iters_per_eval_runner": 1, "keep_per_episode_custom_metrics": false, "metrics_episode_collection_timeout_s": 60.0, "metrics_num_episodes_for_smoothing": 100, "min_time_s_per_iteration": null, "min_train_timesteps_per_iteration": 0, "min_sample_timesteps_per_iteration": 0, "log_gradients": true, "export_native_model_files": false, "checkpoint_trainable_policies_only": false, "logger_creator": null, "logger_config": null, "log_level": "WARN", "log_sys_usage": true, "fake_sampler": false, "seed": 5, "restart_failed_env_runners": true, "ignore_env_runner_failures": false, "max_num_env_runner_restarts": 1000, "delay_between_env_runner_restarts_s": 60.0, "restart_failed_sub_environments": false, "num_consecutive_env_runner_failures_tolerance": 100, "env_runner_health_probe_timeout_s": 30.0, "env_runner_restore_timeout_s": 1800.0, "_model_config": {}, "_rl_module_spec": "RLModuleSpec(module_class=None, observation_space=None, action_space=None, inference_only=False, learner_only=False, model_config=DefaultModelConfig(fcnet_hiddens=[60, 90], fcnet_activation='tanh', fcnet_kernel_initializer=None, fcnet_kernel_initializer_kwargs=None, fcnet_bias_initializer=None, fcnet_bias_initializer_kwargs=None, conv_filters=None, conv_activation='relu', conv_kernel_initializer=None, conv_kernel_initializer_kwargs=None, conv_bias_initializer=None, conv_bias_initializer_kwargs=None, head_fcnet_hiddens=[], head_fcnet_activation='relu', head_fcnet_kernel_initializer=None, head_fcnet_kernel_initializer_kwargs=None, head_fcnet_bias_initializer=None, head_fcnet_bias_initializer_kwargs=None, free_log_std=False, log_std_clip_param=20.0, vf_share_layers=True, use_lstm=False, max_seq_len=20, lstm_cell_size=256, lstm_use_prev_action=False, lstm_use_prev_reward=False, lstm_kernel_initializer=None, lstm_kernel_initializer_kwargs=None, lstm_bias_initializer=None, lstm_bias_initializer_kwargs=None), catalog_class=None, load_state_path=None, model_config_dict=None)", "algorithm_config_overrides_per_module": {}, "_per_module_overrides": {}, "_validate_config": true, "_use_msgpack_checkpoints": false, "_torch_grad_scaler_class": null, "_torch_lr_scheduler_classes": null, "_tf_policy_handles_more_than_one_loss": false, "_disable_preprocessor_api": false, "_disable_action_flattening": false, "_disable_initialize_loss_from_dummy_batch": false, "_dont_auto_sync_env_runner_states": false, "env_task_fn": -1, "enable_connectors": -1, "simple_optimizer": false, "policy_map_cache": -1, "worker_cls": -1, "synchronize_filters": -1, "enable_async_evaluation": -1, "custom_async_evaluation_function": -1, "_enable_rl_module_api": -1, "auto_wrap_old_gym_envs": -1, "always_attach_evaluation_results": -1, "replay_sequence_length": null, "_disable_execution_plan_api": -1, "use_critic": true, "use_gae": true, "use_kl_loss": true, "kl_coeff": 0.7464963036515, "kl_target": 0.0270990929592, "vf_loss_coeff": 0.6688075857018, "entropy_coeff": 0.0090570820258, "clip_param": 0.1221781641624, "vf_clip_param": 0.1027808522125, "entropy_coeff_schedule": null, "lr_schedule": null, "sgd_minibatch_size": -1, "vf_share_layers": -1, "__stdout_file__": null, "__stderr_file__": null, "lambda": 0.9099046732075, "input": "sampler", "policies": {"default_policy": [null, null, null, null]}, "callbacks": "<class 'ray.rllib.callbacks.callbacks.RLlibCallback'>", "create_env_on_driver": false, "custom_eval_function": null, "framework": "torch"}, "time_since_restore": 14.807401657104492, "iterations_since_restore": 9, "perf": {"cpu_util_percent": 33.6, "ram_util_percent": 74.96666666666667}}
{"timers": {"training_iteration": 1.5896581947219288, "restore_env_runners": 7.807397276084544e-06, "training_step": 1.5895238194208028, "env_runner_sampling_timer": 1.480619921787144, "learner_update_timer": 0.10581473355302172, "synch_weights": 0.000616869904823504, "restore_eval_env_runners": 9.114279763776569e-06, "evaluation_iteration": 0.10258989984195106, "synch_eval_env_connectors": 0.00011971964049503742, "synch_env_connectors": 4.564438999189896e-06}, "env_runners": {"env_to_module_connector": {"timers": {"connectors": {"numpy_to_tensor": 5.9751602343803956e-05, "add_states_from_episodes_to_batch": 2.803276225281021e-06, "batch_individual_items": 2.0963247524927925e-05, "add_observations_from_episodes_to_batch": 4.2793327823715854e-05, "add_time_dim_to_batch_and_zero_pad": 4.4470167729468696e-06}}, "connector_pipeline_timer": 0.00020223736609907306}, "num_agent_steps_sampled_lifetime": {"default_agent": -4930000.0}, "env_to_module_sum_episodes_length_out": 10.36823839457432, "num_episodes": 250.0, "episode_len_max": 20, "num_module_steps_sampled": {"default_policy": 5000.0}, "module_to_env_connector": {"timers": {"connectors": {"un_batch_to_individual_items": 1.1274176089459287e-05, "listify_data_for_vector_env": 2.2080265342862295e-05, "normalize_and_clip_actions": 3.515124179496864e-05, "get_actions": 0.00018289313014185953, "tensor_to_numpy": 3.262113800052566e-05, "remove_single_ts_time_rank_from_batch": 1.5394312144492885e-06}}, "connector_pipeline_timer": 0.00034633446873610246}, "num_module_steps_sampled_lifetime": {"default_policy": -4930000.0}, "num_episodes_lifetime": -246500.0, "episode_len_min": 20, "episode_return_max": 6.5, "env_to_module_sum_episodes_length_in": 10.36823839457432, "env_step_timer": 3.659148059823867e-05, "sample": 0.017633346791565273, "rlmodule_inference_timer": 0.00010871705527175985, "episode_duration_sec_mean": 0.0185781162106432, "episode_return_mean": 2.1, "module_episode_returns_mean": {"default_policy": 2.1}, "env_reset_timer": 0.00031350177607851015, "num_env_steps_sampled_lifetime": -4930000.0, "num_env_steps_sampled": 5000.0, "episode_return_min": -13.5, "episode_len_mean": 20.0, "weights_seq_no": 9.0, "num_agent_steps_sampled": {"default_agent": 5000.0}, "time_between_sampling": 0.0036695804523850005, "agent_episode_returns_mean": {"default_agent": 2.1}, "num_env_steps_sampled_lifetime_throughput": 2776.664025249194}, "learners": {"default_policy": {"policy_loss": 0.07686588913202286, "vf_loss": 0.10278083384037018, "vf_loss_unclipped": 26.331432342529297, "num_module_steps_trained": 6000, "diff_num_grad_updates_vs_sampler_policy": 1.0, "default_optimizer_learning_rate": 0.0002847858517, "weights_seq_no": 10.0, "total_loss": 0.14046528935432434, "vf_explained_var": -0.016974687576293945, "module_train_batch_size_mean": 1000.0, "num_module_steps_trained_lifetime": 60000, "gradients_default_optimizer_global_norm": 0.14334608614444733, "entropy": 0.5677953362464905, "curr_entropy_coeff": 0.0090570820258, "num_trainable_parameters": 6003, "curr_kl_coeff": 0.0007290003122761846, "mean_kl_loss": 0.0009531740797683597, "num_module_steps_trained_lifetime_throughput": 451143.6683037197}, "__all_modules__": {"learner_connector": {"timers": {"connectors": {"batch_individual_items": 0.033369933680734404, "add_observations_from_episodes_to_batch": 0.0007828244798537409, "add_columns_from_episodes_to_train_batch": 0.033623589912399214, "general_advantage_estimation": 0.00622496762275539, "add_time_dim_to_batch_and_zero_pad": 9.27600721723844e-06, "numpy_to_tensor": 6.258896262479687e-05, "add_states_from_episodes_to_batch": 3.101763250772584e-06, "add_one_ts_to_episodes_and_truncate": 0.008333346815975482}}, "connector_pipeline_timer": 0.0825165806765087}, "num_trainable_parameters": 6003, "num_env_steps_trained_lifetime": 315000, "num_module_steps_trained": 6000, "num_non_trainable_parameters": 0, "num_env_steps_trained": 31500, "num_module_steps_trained_lifetime": 60000, "learner_connector_sum_episodes_length_in": 5000.0, "learner_connector_sum_episodes_length_out": 5250.0, "num_env_steps_trained_lifetime_throughput": 2355723.7099834518, "num_module_steps_trained_throughput": 450435.0817342224, "num_module_steps_trained_lifetime_throughput": 449702.3510255194}}, "num_training_step_calls_per_iteration": 1, "evaluation": {"env_runners": {"module_to_env_connector": {"connector_pipeline_timer": 0.00010568641851044614, "timers": {"connectors": {"listify_data_for_vector_env": 1.1066082733968016e-05, "get_actions": 3.8193598732085786e-05, "remove_single_ts_time_rank_from_batch": 6.479338369653828e-07, "tensor_to_numpy": 1.3731772038519521e-05, "un_batch_to_individual_items": 6.2720287281559755e-06, "normalize_and_clip_actions": 9.736684803064344e-06}}}, "num_episodes_lifetime": 200, "num_module_steps_sampled": {"default_policy": 400}, "env_to_module_sum_episodes_length_in": 10.368238394574323, "env_to_module_connector": {"timers": {"connectors": {"numpy_to_tensor": 8.483498261611807e-06, "add_states_from_episodes_to_batch": 1.5663485820972512e-06, "add_time_dim_to_batch_and_zero_pad": 2.229530374660034e-06, "batch_individual_items": 6.273963888100707e-06, "add_observations_from_episodes_to_batch": 2.8419962295649767e-06}}, "connector_pipeline_timer": 4.354452764367517e-05}, "module_episode_returns_mean": {"default_policy": 2.7}, "agent_episode_returns_mean": {"default_agent": 2.7}, "env_to_module_sum_episodes_length_out": 10.368238394574323, "episode_len_max": 20, "num_agent_steps_sampled": {"default_agent": 400}, "num_module_steps_sampled_lifetime": {"default_policy": 4000}, "episode_return_max": 13.5, "sample": 0.096432651163751, "rlmodule_inference_timer": 2.9549808526119883e-05, "env_reset_timer": 0.00021730784252632724, "episode_len_mean": 20.0, "weights_seq_no": 10.0, "episode_len_min": 20, "episode_duration_sec_mean": 0.00437143046525307, "episode_return_mean": 2.7, "num_env_steps_sampled": 400, "episode_return_min": -15.5, "num_agent_steps_sampled_lifetime": {"default_agent": 4000}, "num_episodes": 20, "env_step_timer": 1.4453521732791844e-05, "num_env_steps_sampled_lifetime": 50400, "time_between_sampling": 1.6501848934481522}, "num_healthy_workers": 1, "actor_manager_num_outstanding_async_reqs": 0, "num_remote_worker_restarts": 0}, "num_env_steps_sampled_lifetime": -4930000.0, "fault_tolerance": {"num_healthy_workers": 0, "num_remote_worker_restarts": 0}, "env_runner_group": {"actor_manager_num_outstanding_async_reqs": 0}, "done": false, "training_iteration": 10, "trial_id": "4649a_00000", "date": "2025-08-11_19-36-32", "timestamp": 1754933792, "time_this_iter_s": 7.330193042755127, "time_total_s": 22.13759469985962, "pid": 28167, "hostname": "Mac", "node_ip": "127.0.0.1", "config": {"exploration_config": {}, "extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "placement_strategy": "PACK", "num_gpus": 0, "_fake_gpus": false, "num_cpus_for_main_process": 2, "eager_tracing": true, "eager_max_retraces": 20, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "torch_compile_learner": false, "torch_compile_learner_what_to_compile": "forward_train", "torch_compile_learner_dynamo_backend": "aot_eager", "torch_compile_learner_dynamo_mode": null, "torch_compile_worker": false, "torch_compile_worker_dynamo_backend": "aot_eager", "torch_compile_worker_dynamo_mode": null, "torch_ddp_kwargs": {}, "torch_skip_nan_gradients": false, "env": "Umbrella", "env_config": {}, "observation_space": null, "action_space": null, "clip_rewards": null, "normalize_actions": true, "clip_actions": false, "_is_atari": null, "disable_env_checking": false, "render_env": false, "action_mask_key": "action_mask", "env_runner_cls": null, "num_env_runners": 0, "create_local_env_runner": true, "num_envs_per_env_runner": 1, "gym_env_vectorize_mode": "SYNC", "num_cpus_per_env_runner": 1, "num_gpus_per_env_runner": 0, "custom_resources_per_env_runner": {}, "validate_env_runners_after_construction": true, "episodes_to_numpy": true, "max_requests_in_flight_per_env_runner": 1, "sample_timeout_s": 60.0, "_env_to_module_connector": null, "add_default_connectors_to_env_to_module_pipeline": true, "_module_to_env_connector": null, "add_default_connectors_to_module_to_env_pipeline": true, "merge_env_runner_states": "training_only", "broadcast_env_runner_states": true, "episode_lookback_horizon": 1, "rollout_fragment_length": "auto", "batch_mode": "complete_episodes", "compress_observations": false, "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "enable_tf1_exec_eagerly": false, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "preprocessor_pref": "deepmind", "observation_filter": "NoFilter", "update_worker_filter_stats": true, "use_worker_filter_stats": true, "sampler_perf_stats_ema_coef": null, "_is_online": true, "num_learners": 0, "num_gpus_per_learner": 0, "num_cpus_per_learner": "auto", "num_aggregator_actors_per_learner": 0, "max_requests_in_flight_per_aggregator_actor": 3, "local_gpu_idx": 0, "max_requests_in_flight_per_learner": 3, "gamma": 1, "lr": 0.0002847858517, "grad_clip": 0.5, "grad_clip_by": "global_norm", "_train_batch_size_per_learner": 5000, "train_batch_size": 4000, "num_epochs": 1, "minibatch_size": 1000, "shuffle_batch_per_epoch": true, "model": {"fcnet_hiddens": [256, 256], "fcnet_activation": "tanh", "fcnet_weights_initializer": null, "fcnet_weights_initializer_config": null, "fcnet_bias_initializer": null, "fcnet_bias_initializer_config": null, "conv_filters": null, "conv_activation": "relu", "conv_kernel_initializer": null, "conv_kernel_initializer_config": null, "conv_bias_initializer": null, "conv_bias_initializer_config": null, "conv_transpose_kernel_initializer": null, "conv_transpose_kernel_initializer_config": null, "conv_transpose_bias_initializer": null, "conv_transpose_bias_initializer_config": null, "post_fcnet_hiddens": [], "post_fcnet_activation": "relu", "post_fcnet_weights_initializer": null, "post_fcnet_weights_initializer_config": null, "post_fcnet_bias_initializer": null, "post_fcnet_bias_initializer_config": null, "free_log_std": false, "log_std_clip_param": 20.0, "no_final_linear": false, "vf_share_layers": false, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "lstm_weights_initializer": null, "lstm_weights_initializer_config": null, "lstm_bias_initializer": null, "lstm_bias_initializer_config": null, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "attention_use_n_prev_actions": 0, "attention_use_n_prev_rewards": 0, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": null, "custom_model_config": {}, "custom_action_dist": null, "custom_preprocessor": null, "encoder_latent_dim": null, "always_check_shapes": false, "lstm_use_prev_action_reward": -1, "_use_default_native_models": -1, "_disable_preprocessor_api": false, "_disable_action_flattening": false}, "_learner_connector": null, "add_default_connectors_to_learner_pipeline": true, "learner_config_dict": {}, "optimizer": {}, "_learner_class": null, "callbacks_on_algorithm_init": null, "callbacks_on_env_runners_recreated": null, "callbacks_on_offline_eval_runners_recreated": null, "callbacks_on_checkpoint_loaded": null, "callbacks_on_environment_created": null, "callbacks_on_episode_created": null, "callbacks_on_episode_start": null, "callbacks_on_episode_step": null, "callbacks_on_episode_end": null, "callbacks_on_evaluate_start": null, "callbacks_on_evaluate_end": null, "callbacks_on_evaluate_offline_start": null, "callbacks_on_evaluate_offline_end": null, "callbacks_on_sample_end": null, "callbacks_on_train_result": null, "explore": true, "enable_rl_module_and_learner": true, "enable_env_runner_and_connector_v2": true, "_prior_exploration_config": {"type": "StochasticSampling"}, "count_steps_by": "env_steps", "policy_map_capacity": 100, "policy_mapping_fn": "<function AlgorithmConfig.DEFAULT_POLICY_MAPPING_FN at 0x17c065b20>", "policies_to_train": null, "policy_states_are_swappable": false, "observation_fn": null, "offline_data_class": null, "input_read_method": "read_parquet", "input_read_method_kwargs": {}, "input_read_schema": {}, "input_read_episodes": false, "input_read_sample_batches": false, "input_read_batch_size": null, "input_filesystem": null, "input_filesystem_kwargs": {}, "input_compress_columns": ["obs", "new_obs"], "input_spaces_jsonable": true, "materialize_data": false, "materialize_mapped_data": true, "map_batches_kwargs": {}, "iter_batches_kwargs": {}, "ignore_final_observation": false, "prelearner_class": null, "prelearner_buffer_class": null, "prelearner_buffer_kwargs": {}, "prelearner_module_synch_period": 10, "dataset_num_iters_per_learner": null, "input_config": {}, "actions_in_input_normalized": false, "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_config": {}, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "output_max_rows_per_file": null, "output_write_remaining_data": false, "output_write_method": "write_parquet", "output_write_method_kwargs": {}, "output_filesystem": null, "output_filesystem_kwargs": {}, "output_write_episodes": true, "offline_sampling": false, "evaluation_interval": 1, "evaluation_duration": 20, "evaluation_duration_unit": "episodes", "evaluation_sample_timeout_s": 120.0, "evaluation_auto_duration_min_env_steps_per_sample": 100, "evaluation_auto_duration_max_env_steps_per_sample": 2000, "evaluation_parallel_to_training": false, "evaluation_force_reset_envs_before_iteration": true, "evaluation_config": null, "off_policy_estimation_methods": {}, "ope_split_batch_by_episode": true, "evaluation_num_env_runners": 1, "in_evaluation": false, "sync_filters_on_rollout_workers_timeout_s": 10.0, "offline_evaluation_interval": null, "num_offline_eval_runners": 0, "offline_loss_for_module_fn": null, "offline_evaluation_duration": 1, "offline_evaluation_parallel_to_training": false, "offline_evaluation_timeout_s": 120.0, "num_cpus_per_offline_eval_runner": 1, "num_gpus_per_offline_eval_runner": 0, "custom_resources_per_offline_eval_runner": {}, "restart_failed_offline_eval_runners": true, "ignore_offline_eval_runner_failures": false, "max_num_offline_eval_runner_restarts": 1000, "offline_eval_runner_restore_timeout_s": 1800.0, "max_requests_in_flight_per_offline_eval_runner": 1, "validate_offline_eval_runners_after_construction": true, "offline_eval_runner_health_probe_timeout_s": 30.0, "offline_eval_rl_module_inference_only": false, "broadcast_offline_eval_runner_states": false, "offline_eval_batch_size_per_runner": 256, "dataset_num_iters_per_eval_runner": 1, "keep_per_episode_custom_metrics": false, "metrics_episode_collection_timeout_s": 60.0, "metrics_num_episodes_for_smoothing": 100, "min_time_s_per_iteration": null, "min_train_timesteps_per_iteration": 0, "min_sample_timesteps_per_iteration": 0, "log_gradients": true, "export_native_model_files": false, "checkpoint_trainable_policies_only": false, "logger_creator": null, "logger_config": null, "log_level": "WARN", "log_sys_usage": true, "fake_sampler": false, "seed": 5, "restart_failed_env_runners": true, "ignore_env_runner_failures": false, "max_num_env_runner_restarts": 1000, "delay_between_env_runner_restarts_s": 60.0, "restart_failed_sub_environments": false, "num_consecutive_env_runner_failures_tolerance": 100, "env_runner_health_probe_timeout_s": 30.0, "env_runner_restore_timeout_s": 1800.0, "_model_config": {}, "_rl_module_spec": "RLModuleSpec(module_class=None, observation_space=None, action_space=None, inference_only=False, learner_only=False, model_config=DefaultModelConfig(fcnet_hiddens=[60, 90], fcnet_activation='tanh', fcnet_kernel_initializer=None, fcnet_kernel_initializer_kwargs=None, fcnet_bias_initializer=None, fcnet_bias_initializer_kwargs=None, conv_filters=None, conv_activation='relu', conv_kernel_initializer=None, conv_kernel_initializer_kwargs=None, conv_bias_initializer=None, conv_bias_initializer_kwargs=None, head_fcnet_hiddens=[], head_fcnet_activation='relu', head_fcnet_kernel_initializer=None, head_fcnet_kernel_initializer_kwargs=None, head_fcnet_bias_initializer=None, head_fcnet_bias_initializer_kwargs=None, free_log_std=False, log_std_clip_param=20.0, vf_share_layers=True, use_lstm=False, max_seq_len=20, lstm_cell_size=256, lstm_use_prev_action=False, lstm_use_prev_reward=False, lstm_kernel_initializer=None, lstm_kernel_initializer_kwargs=None, lstm_bias_initializer=None, lstm_bias_initializer_kwargs=None), catalog_class=None, load_state_path=None, model_config_dict=None)", "algorithm_config_overrides_per_module": {}, "_per_module_overrides": {}, "_validate_config": true, "_use_msgpack_checkpoints": false, "_torch_grad_scaler_class": null, "_torch_lr_scheduler_classes": null, "_tf_policy_handles_more_than_one_loss": false, "_disable_preprocessor_api": false, "_disable_action_flattening": false, "_disable_initialize_loss_from_dummy_batch": false, "_dont_auto_sync_env_runner_states": false, "env_task_fn": -1, "enable_connectors": -1, "simple_optimizer": false, "policy_map_cache": -1, "worker_cls": -1, "synchronize_filters": -1, "enable_async_evaluation": -1, "custom_async_evaluation_function": -1, "_enable_rl_module_api": -1, "auto_wrap_old_gym_envs": -1, "always_attach_evaluation_results": -1, "replay_sequence_length": null, "_disable_execution_plan_api": -1, "use_critic": true, "use_gae": true, "use_kl_loss": true, "kl_coeff": 0.7464963036515, "kl_target": 0.0270990929592, "vf_loss_coeff": 0.6688075857018, "entropy_coeff": 0.0090570820258, "clip_param": 0.1221781641624, "vf_clip_param": 0.1027808522125, "entropy_coeff_schedule": null, "lr_schedule": null, "sgd_minibatch_size": -1, "vf_share_layers": -1, "__stdout_file__": null, "__stderr_file__": null, "lambda": 0.9099046732075, "input": "sampler", "policies": {"default_policy": [null, null, null, null]}, "callbacks": "<class 'ray.rllib.callbacks.callbacks.RLlibCallback'>", "create_env_on_driver": false, "custom_eval_function": null, "framework": "torch"}, "time_since_restore": 22.13759469985962, "iterations_since_restore": 10, "perf": {"cpu_util_percent": 77.475, "ram_util_percent": 82.9875}}
{"timers": {"training_iteration": 1.5897078406840082, "restore_env_runners": 7.790574060749721e-06, "training_step": 1.5895728770571536, "env_runner_sampling_timer": 1.4800985163201212, "learner_update_timer": 0.10637784913758057, "synch_weights": 0.0006189537063316784, "restore_eval_env_runners": 9.115216829091037e-06, "evaluation_iteration": 0.10264481709429166, "synch_eval_env_connectors": 0.00011940578492565832, "synch_env_connectors": 4.558794913777731e-06}, "env_runners": {"env_to_module_connector": {"timers": {"connectors": {"numpy_to_tensor": 8.955615089245448e-06, "add_states_from_episodes_to_batch": 1.7502908374815282e-06, "batch_individual_items": 6.557064140398362e-06, "add_observations_from_episodes_to_batch": 3.0624532263068744e-06, "add_time_dim_to_batch_and_zero_pad": 2.3940837035422124e-06}}, "connector_pipeline_timer": 4.533721094214653e-05}, "num_agent_steps_sampled_lifetime": {"default_agent": -5547500.0}, "env_to_module_sum_episodes_length_out": 10.36823839457432, "num_episodes": 250.0, "episode_len_max": 20, "num_module_steps_sampled": {"default_policy": 5000.0}, "module_to_env_connector": {"timers": {"connectors": {"un_batch_to_individual_items": 5.542980202059435e-06, "listify_data_for_vector_env": 1.1155004310893203e-05, "normalize_and_clip_actions": 9.699345059892052e-06, "get_actions": 3.975355319250202e-05, "tensor_to_numpy": 1.3405168421693422e-05, "remove_single_ts_time_rank_from_batch": 5.912315922210977e-07}}, "connector_pipeline_timer": 0.00010670752284832452}, "num_module_steps_sampled_lifetime": {"default_policy": -5547500.0}, "num_episodes_lifetime": -277375.0, "episode_len_min": 20, "episode_return_max": 6.5, "env_to_module_sum_episodes_length_in": 10.36823839457432, "env_step_timer": 1.4369146611781371e-05, "sample": 0.01126091644043307, "rlmodule_inference_timer": 2.8907210131930183e-05, "episode_duration_sec_mean": 0.004713854666799307, "episode_return_mean": 2.899999999999998, "module_episode_returns_mean": {"default_policy": 2.899999999999998}, "env_reset_timer": 0.00010589018093145385, "num_env_steps_sampled_lifetime": -5547500.0, "num_env_steps_sampled": 5000.0, "episode_return_min": -13.5, "episode_len_mean": 20.0, "weights_seq_no": 10.0, "num_agent_steps_sampled": {"default_agent": 5000.0}, "time_between_sampling": 0.0028020195133396414, "agent_episode_returns_mean": {"default_agent": 2.899999999999998}, "num_env_steps_sampled_lifetime_throughput": 3627.6292738968486}, "learners": {"default_policy": {"policy_loss": -0.03556709364056587, "vf_loss": 0.10278083384037018, "vf_loss_unclipped": 24.314098358154297, "num_module_steps_trained": 6000, "diff_num_grad_updates_vs_sampler_policy": 1.0, "default_optimizer_learning_rate": 0.0002847858517, "weights_seq_no": 11.0, "total_loss": 0.02838999032974243, "vf_explained_var": -0.0189741849899292, "module_train_batch_size_mean": 1000.0, "num_module_steps_trained_lifetime": 66000, "gradients_default_optimizer_global_norm": 0.028718072921037674, "entropy": 0.5282582640647888, "curr_entropy_coeff": 0.0090570820258, "num_trainable_parameters": 6003, "curr_kl_coeff": 0.0003645001561380923, "mean_kl_loss": 0.001295494264923036, "num_module_steps_trained_lifetime_throughput": 450053.41282856645}, "__all_modules__": {"learner_connector": {"timers": {"connectors": {"batch_individual_items": 0.033765212264880246, "add_observations_from_episodes_to_batch": 0.0007839524860226614, "add_columns_from_episodes_to_train_batch": 0.03385826818351434, "general_advantage_estimation": 0.0062232166970636075, "add_time_dim_to_batch_and_zero_pad": 9.321586964452656e-06, "numpy_to_tensor": 6.277391269999282e-05, "add_states_from_episodes_to_batch": 3.1044955842157047e-06, "add_one_ts_to_episodes_and_truncate": 0.00833044667738304}}, "connector_pipeline_timer": 0.08314353320037875}, "num_trainable_parameters": 6003, "num_env_steps_trained_lifetime": 346500, "num_module_steps_trained": 6000, "num_non_trainable_parameters": 0, "num_env_steps_trained": 31500, "num_module_steps_trained_lifetime": 66000, "learner_connector_sum_episodes_length_in": 5000.0, "learner_connector_sum_episodes_length_out": 5250.0, "num_env_steps_trained_lifetime_throughput": 2350721.498076232, "num_module_steps_trained_throughput": 449413.8559407829, "num_module_steps_trained_lifetime_throughput": 448705.5445529516}}, "num_training_step_calls_per_iteration": 1, "evaluation": {"env_runners": {"module_to_env_connector": {"connector_pipeline_timer": 0.00010050804269712361, "timers": {"connectors": {"listify_data_for_vector_env": 1.0881990098537727e-05, "get_actions": 3.6023555925111925e-05, "remove_single_ts_time_rank_from_batch": 5.640597653814477e-07, "tensor_to_numpy": 1.2922470601338415e-05, "un_batch_to_individual_items": 5.405300061490944e-06, "normalize_and_clip_actions": 9.406060397312874e-06}}}, "num_episodes_lifetime": 220, "num_module_steps_sampled": {"default_policy": 400}, "env_to_module_sum_episodes_length_in": 10.368238394574323, "env_to_module_connector": {"timers": {"connectors": {"numpy_to_tensor": 8.269780891388495e-06, "add_states_from_episodes_to_batch": 1.5478396701615397e-06, "add_time_dim_to_batch_and_zero_pad": 2.1685820596433255e-06, "batch_individual_items": 6.106094193733969e-06, "add_observations_from_episodes_to_batch": 2.8095822492495376e-06}}, "connector_pipeline_timer": 4.2239670547548314e-05}, "module_episode_returns_mean": {"default_policy": 2.5}, "agent_episode_returns_mean": {"default_agent": 2.5}, "env_to_module_sum_episodes_length_out": 10.368238394574323, "episode_len_max": 20, "num_agent_steps_sampled": {"default_agent": 400}, "num_module_steps_sampled_lifetime": {"default_policy": 4400}, "episode_return_max": 13.5, "sample": 0.09650653048295946, "rlmodule_inference_timer": 2.7214527306051644e-05, "env_reset_timer": 0.00021618351364665304, "episode_len_mean": 20.0, "weights_seq_no": 11.0, "episode_len_min": 20, "episode_duration_sec_mean": 0.00445565048023127, "episode_return_mean": 2.5, "num_env_steps_sampled": 400, "episode_return_min": -15.5, "num_agent_steps_sampled_lifetime": {"default_agent": 4400}, "num_episodes": 20, "env_step_timer": 1.4164191896695554e-05, "num_env_steps_sampled_lifetime": 55400, "time_between_sampling": 1.6498895016035364}, "num_healthy_workers": 1, "actor_manager_num_outstanding_async_reqs": 0, "num_remote_worker_restarts": 0}, "num_env_steps_sampled_lifetime": -5547500.0, "fault_tolerance": {"num_healthy_workers": 0, "num_remote_worker_restarts": 0}, "env_runner_group": {"actor_manager_num_outstanding_async_reqs": 0}, "done": false, "training_iteration": 11, "trial_id": "4649a_00000", "date": "2025-08-11_19-36-34", "timestamp": 1754933794, "time_this_iter_s": 1.7068989276885986, "time_total_s": 23.844493627548218, "pid": 28167, "hostname": "Mac", "node_ip": "127.0.0.1", "config": {"exploration_config": {}, "extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "placement_strategy": "PACK", "num_gpus": 0, "_fake_gpus": false, "num_cpus_for_main_process": 2, "eager_tracing": true, "eager_max_retraces": 20, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "torch_compile_learner": false, "torch_compile_learner_what_to_compile": "forward_train", "torch_compile_learner_dynamo_backend": "aot_eager", "torch_compile_learner_dynamo_mode": null, "torch_compile_worker": false, "torch_compile_worker_dynamo_backend": "aot_eager", "torch_compile_worker_dynamo_mode": null, "torch_ddp_kwargs": {}, "torch_skip_nan_gradients": false, "env": "Umbrella", "env_config": {}, "observation_space": null, "action_space": null, "clip_rewards": null, "normalize_actions": true, "clip_actions": false, "_is_atari": null, "disable_env_checking": false, "render_env": false, "action_mask_key": "action_mask", "env_runner_cls": null, "num_env_runners": 0, "create_local_env_runner": true, "num_envs_per_env_runner": 1, "gym_env_vectorize_mode": "SYNC", "num_cpus_per_env_runner": 1, "num_gpus_per_env_runner": 0, "custom_resources_per_env_runner": {}, "validate_env_runners_after_construction": true, "episodes_to_numpy": true, "max_requests_in_flight_per_env_runner": 1, "sample_timeout_s": 60.0, "_env_to_module_connector": null, "add_default_connectors_to_env_to_module_pipeline": true, "_module_to_env_connector": null, "add_default_connectors_to_module_to_env_pipeline": true, "merge_env_runner_states": "training_only", "broadcast_env_runner_states": true, "episode_lookback_horizon": 1, "rollout_fragment_length": "auto", "batch_mode": "complete_episodes", "compress_observations": false, "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "enable_tf1_exec_eagerly": false, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "preprocessor_pref": "deepmind", "observation_filter": "NoFilter", "update_worker_filter_stats": true, "use_worker_filter_stats": true, "sampler_perf_stats_ema_coef": null, "_is_online": true, "num_learners": 0, "num_gpus_per_learner": 0, "num_cpus_per_learner": "auto", "num_aggregator_actors_per_learner": 0, "max_requests_in_flight_per_aggregator_actor": 3, "local_gpu_idx": 0, "max_requests_in_flight_per_learner": 3, "gamma": 1, "lr": 0.0002847858517, "grad_clip": 0.5, "grad_clip_by": "global_norm", "_train_batch_size_per_learner": 5000, "train_batch_size": 4000, "num_epochs": 1, "minibatch_size": 1000, "shuffle_batch_per_epoch": true, "model": {"fcnet_hiddens": [256, 256], "fcnet_activation": "tanh", "fcnet_weights_initializer": null, "fcnet_weights_initializer_config": null, "fcnet_bias_initializer": null, "fcnet_bias_initializer_config": null, "conv_filters": null, "conv_activation": "relu", "conv_kernel_initializer": null, "conv_kernel_initializer_config": null, "conv_bias_initializer": null, "conv_bias_initializer_config": null, "conv_transpose_kernel_initializer": null, "conv_transpose_kernel_initializer_config": null, "conv_transpose_bias_initializer": null, "conv_transpose_bias_initializer_config": null, "post_fcnet_hiddens": [], "post_fcnet_activation": "relu", "post_fcnet_weights_initializer": null, "post_fcnet_weights_initializer_config": null, "post_fcnet_bias_initializer": null, "post_fcnet_bias_initializer_config": null, "free_log_std": false, "log_std_clip_param": 20.0, "no_final_linear": false, "vf_share_layers": false, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "lstm_weights_initializer": null, "lstm_weights_initializer_config": null, "lstm_bias_initializer": null, "lstm_bias_initializer_config": null, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "attention_use_n_prev_actions": 0, "attention_use_n_prev_rewards": 0, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": null, "custom_model_config": {}, "custom_action_dist": null, "custom_preprocessor": null, "encoder_latent_dim": null, "always_check_shapes": false, "lstm_use_prev_action_reward": -1, "_use_default_native_models": -1, "_disable_preprocessor_api": false, "_disable_action_flattening": false}, "_learner_connector": null, "add_default_connectors_to_learner_pipeline": true, "learner_config_dict": {}, "optimizer": {}, "_learner_class": null, "callbacks_on_algorithm_init": null, "callbacks_on_env_runners_recreated": null, "callbacks_on_offline_eval_runners_recreated": null, "callbacks_on_checkpoint_loaded": null, "callbacks_on_environment_created": null, "callbacks_on_episode_created": null, "callbacks_on_episode_start": null, "callbacks_on_episode_step": null, "callbacks_on_episode_end": null, "callbacks_on_evaluate_start": null, "callbacks_on_evaluate_end": null, "callbacks_on_evaluate_offline_start": null, "callbacks_on_evaluate_offline_end": null, "callbacks_on_sample_end": null, "callbacks_on_train_result": null, "explore": true, "enable_rl_module_and_learner": true, "enable_env_runner_and_connector_v2": true, "_prior_exploration_config": {"type": "StochasticSampling"}, "count_steps_by": "env_steps", "policy_map_capacity": 100, "policy_mapping_fn": "<function AlgorithmConfig.DEFAULT_POLICY_MAPPING_FN at 0x17c065b20>", "policies_to_train": null, "policy_states_are_swappable": false, "observation_fn": null, "offline_data_class": null, "input_read_method": "read_parquet", "input_read_method_kwargs": {}, "input_read_schema": {}, "input_read_episodes": false, "input_read_sample_batches": false, "input_read_batch_size": null, "input_filesystem": null, "input_filesystem_kwargs": {}, "input_compress_columns": ["obs", "new_obs"], "input_spaces_jsonable": true, "materialize_data": false, "materialize_mapped_data": true, "map_batches_kwargs": {}, "iter_batches_kwargs": {}, "ignore_final_observation": false, "prelearner_class": null, "prelearner_buffer_class": null, "prelearner_buffer_kwargs": {}, "prelearner_module_synch_period": 10, "dataset_num_iters_per_learner": null, "input_config": {}, "actions_in_input_normalized": false, "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_config": {}, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "output_max_rows_per_file": null, "output_write_remaining_data": false, "output_write_method": "write_parquet", "output_write_method_kwargs": {}, "output_filesystem": null, "output_filesystem_kwargs": {}, "output_write_episodes": true, "offline_sampling": false, "evaluation_interval": 1, "evaluation_duration": 20, "evaluation_duration_unit": "episodes", "evaluation_sample_timeout_s": 120.0, "evaluation_auto_duration_min_env_steps_per_sample": 100, "evaluation_auto_duration_max_env_steps_per_sample": 2000, "evaluation_parallel_to_training": false, "evaluation_force_reset_envs_before_iteration": true, "evaluation_config": null, "off_policy_estimation_methods": {}, "ope_split_batch_by_episode": true, "evaluation_num_env_runners": 1, "in_evaluation": false, "sync_filters_on_rollout_workers_timeout_s": 10.0, "offline_evaluation_interval": null, "num_offline_eval_runners": 0, "offline_loss_for_module_fn": null, "offline_evaluation_duration": 1, "offline_evaluation_parallel_to_training": false, "offline_evaluation_timeout_s": 120.0, "num_cpus_per_offline_eval_runner": 1, "num_gpus_per_offline_eval_runner": 0, "custom_resources_per_offline_eval_runner": {}, "restart_failed_offline_eval_runners": true, "ignore_offline_eval_runner_failures": false, "max_num_offline_eval_runner_restarts": 1000, "offline_eval_runner_restore_timeout_s": 1800.0, "max_requests_in_flight_per_offline_eval_runner": 1, "validate_offline_eval_runners_after_construction": true, "offline_eval_runner_health_probe_timeout_s": 30.0, "offline_eval_rl_module_inference_only": false, "broadcast_offline_eval_runner_states": false, "offline_eval_batch_size_per_runner": 256, "dataset_num_iters_per_eval_runner": 1, "keep_per_episode_custom_metrics": false, "metrics_episode_collection_timeout_s": 60.0, "metrics_num_episodes_for_smoothing": 100, "min_time_s_per_iteration": null, "min_train_timesteps_per_iteration": 0, "min_sample_timesteps_per_iteration": 0, "log_gradients": true, "export_native_model_files": false, "checkpoint_trainable_policies_only": false, "logger_creator": null, "logger_config": null, "log_level": "WARN", "log_sys_usage": true, "fake_sampler": false, "seed": 5, "restart_failed_env_runners": true, "ignore_env_runner_failures": false, "max_num_env_runner_restarts": 1000, "delay_between_env_runner_restarts_s": 60.0, "restart_failed_sub_environments": false, "num_consecutive_env_runner_failures_tolerance": 100, "env_runner_health_probe_timeout_s": 30.0, "env_runner_restore_timeout_s": 1800.0, "_model_config": {}, "_rl_module_spec": "RLModuleSpec(module_class=None, observation_space=None, action_space=None, inference_only=False, learner_only=False, model_config=DefaultModelConfig(fcnet_hiddens=[60, 90], fcnet_activation='tanh', fcnet_kernel_initializer=None, fcnet_kernel_initializer_kwargs=None, fcnet_bias_initializer=None, fcnet_bias_initializer_kwargs=None, conv_filters=None, conv_activation='relu', conv_kernel_initializer=None, conv_kernel_initializer_kwargs=None, conv_bias_initializer=None, conv_bias_initializer_kwargs=None, head_fcnet_hiddens=[], head_fcnet_activation='relu', head_fcnet_kernel_initializer=None, head_fcnet_kernel_initializer_kwargs=None, head_fcnet_bias_initializer=None, head_fcnet_bias_initializer_kwargs=None, free_log_std=False, log_std_clip_param=20.0, vf_share_layers=True, use_lstm=False, max_seq_len=20, lstm_cell_size=256, lstm_use_prev_action=False, lstm_use_prev_reward=False, lstm_kernel_initializer=None, lstm_kernel_initializer_kwargs=None, lstm_bias_initializer=None, lstm_bias_initializer_kwargs=None), catalog_class=None, load_state_path=None, model_config_dict=None)", "algorithm_config_overrides_per_module": {}, "_per_module_overrides": {}, "_validate_config": true, "_use_msgpack_checkpoints": false, "_torch_grad_scaler_class": null, "_torch_lr_scheduler_classes": null, "_tf_policy_handles_more_than_one_loss": false, "_disable_preprocessor_api": false, "_disable_action_flattening": false, "_disable_initialize_loss_from_dummy_batch": false, "_dont_auto_sync_env_runner_states": false, "env_task_fn": -1, "enable_connectors": -1, "simple_optimizer": false, "policy_map_cache": -1, "worker_cls": -1, "synchronize_filters": -1, "enable_async_evaluation": -1, "custom_async_evaluation_function": -1, "_enable_rl_module_api": -1, "auto_wrap_old_gym_envs": -1, "always_attach_evaluation_results": -1, "replay_sequence_length": null, "_disable_execution_plan_api": -1, "use_critic": true, "use_gae": true, "use_kl_loss": true, "kl_coeff": 0.7464963036515, "kl_target": 0.0270990929592, "vf_loss_coeff": 0.6688075857018, "entropy_coeff": 0.0090570820258, "clip_param": 0.1221781641624, "vf_clip_param": 0.1027808522125, "entropy_coeff_schedule": null, "lr_schedule": null, "sgd_minibatch_size": -1, "vf_share_layers": -1, "__stdout_file__": null, "__stderr_file__": null, "lambda": 0.9099046732075, "input": "sampler", "policies": {"default_policy": [null, null, null, null]}, "callbacks": "<class 'ray.rllib.callbacks.callbacks.RLlibCallback'>", "create_env_on_driver": false, "custom_eval_function": null, "framework": "torch"}, "time_since_restore": 23.844493627548218, "iterations_since_restore": 11, "perf": {"cpu_util_percent": 45.26666666666667, "ram_util_percent": 76.53333333333332}}
{"timers": {"training_iteration": 1.6043011781173449, "restore_env_runners": 7.77516821397145e-06, "training_step": 1.6041654816266175, "env_runner_sampling_timer": 1.4945520690766891, "learner_update_timer": 0.10651206522576583, "synch_weights": 0.0006206729186624804, "restore_eval_env_runners": 9.098234026489285e-06, "evaluation_iteration": 0.10271789434334394, "synch_eval_env_connectors": 0.00011996089639068189, "synch_env_connectors": 4.556126965491109e-06}, "env_runners": {"env_to_module_connector": {"timers": {"connectors": {"numpy_to_tensor": 1.4433844460853048e-05, "add_states_from_episodes_to_batch": 2.202731021523718e-06, "batch_individual_items": 9.843002817400959e-06, "add_observations_from_episodes_to_batch": 4.410086664782497e-06, "add_time_dim_to_batch_and_zero_pad": 3.6941553488335816e-06}}, "connector_pipeline_timer": 6.5341948579863e-05}, "num_agent_steps_sampled_lifetime": {"default_agent": -6165000.0}, "env_to_module_sum_episodes_length_out": 10.36823839457432, "num_episodes": 250.0, "episode_len_max": 20, "num_module_steps_sampled": {"default_policy": 5000.0}, "module_to_env_connector": {"timers": {"connectors": {"un_batch_to_individual_items": 7.782718227293978e-06, "listify_data_for_vector_env": 1.7648680967339938e-05, "normalize_and_clip_actions": 1.342777134702627e-05, "get_actions": 7.268589761250945e-05, "tensor_to_numpy": 7.410997652137733e-05, "remove_single_ts_time_rank_from_batch": 7.866806634464248e-07}}, "connector_pipeline_timer": 0.00022396065539071397}, "num_module_steps_sampled_lifetime": {"default_policy": -6165000.0}, "num_episodes_lifetime": -308250.0, "episode_len_min": 20, "episode_return_max": 6.5, "env_to_module_sum_episodes_length_in": 10.36823839457432, "env_step_timer": 2.9072759073405906e-05, "sample": 0.008585962218996936, "rlmodule_inference_timer": 4.396655812867776e-05, "episode_duration_sec_mean": 0.008428578317165373, "episode_return_mean": 3.38, "module_episode_returns_mean": {"default_policy": 3.38}, "env_reset_timer": 6.181180381770948e-05, "num_env_steps_sampled_lifetime": -6165000.0, "num_env_steps_sampled": 5000.0, "episode_return_min": -13.5, "episode_len_mean": 20.0, "weights_seq_no": 11.0, "num_agent_steps_sampled": {"default_agent": 5000.0}, "time_between_sampling": 0.003603243683562826, "agent_episode_returns_mean": {"default_agent": 3.38}, "num_env_steps_sampled_lifetime_throughput": 2795.110024876755}, "learners": {"default_policy": {"policy_loss": -0.0541551373898983, "vf_loss": 0.10278083384037018, "vf_loss_unclipped": 23.894079208374023, "num_module_steps_trained": 6000, "diff_num_grad_updates_vs_sampler_policy": 1.0, "default_optimizer_learning_rate": 0.0002847858517, "weights_seq_no": 12.0, "total_loss": 0.010113202035427094, "vf_explained_var": -0.02031266689300537, "module_train_batch_size_mean": 1000.0, "num_module_steps_trained_lifetime": 72000, "gradients_default_optimizer_global_norm": 0.04764096066355705, "entropy": 0.493836909532547, "curr_entropy_coeff": 0.0090570820258, "num_trainable_parameters": 6003, "curr_kl_coeff": 0.00018225007806904614, "mean_kl_loss": 0.0012555166613310575, "num_module_steps_trained_lifetime_throughput": 448470.38793645526}, "__all_modules__": {"learner_connector": {"timers": {"connectors": {"batch_individual_items": 0.03387705722263948, "add_observations_from_episodes_to_batch": 0.00078532629092093, "add_columns_from_episodes_to_train_batch": 0.033926294671119545, "general_advantage_estimation": 0.006237744950435879, "add_time_dim_to_batch_and_zero_pad": 9.342951711163073e-06, "numpy_to_tensor": 6.288326300390622e-05, "add_states_from_episodes_to_batch": 3.108041112947985e-06, "add_one_ts_to_episodes_and_truncate": 0.008329940129776415}}, "connector_pipeline_timer": 0.08333918452840805}, "num_trainable_parameters": 6003, "num_env_steps_trained_lifetime": 378000, "num_module_steps_trained": 6000, "num_non_trainable_parameters": 0, "num_env_steps_trained": 31500, "num_module_steps_trained_lifetime": 72000, "learner_connector_sum_episodes_length_in": 5000.0, "learner_connector_sum_episodes_length_out": 5250.0, "num_env_steps_trained_lifetime_throughput": 2343118.167295443, "num_module_steps_trained_throughput": 447898.7629805642, "num_module_steps_trained_lifetime_throughput": 447214.6085443995}}, "num_training_step_calls_per_iteration": 1, "evaluation": {"env_runners": {"module_to_env_connector": {"connector_pipeline_timer": 0.00011967694571585468, "timers": {"connectors": {"listify_data_for_vector_env": 1.2847847060622691e-05, "get_actions": 4.3603564299841625e-05, "remove_single_ts_time_rank_from_batch": 6.137461305258656e-07, "tensor_to_numpy": 1.5640249089825232e-05, "un_batch_to_individual_items": 6.096274773599833e-06, "normalize_and_clip_actions": 1.1274223018931634e-05}}}, "num_episodes_lifetime": 240, "num_module_steps_sampled": {"default_policy": 400}, "env_to_module_sum_episodes_length_in": 10.368238394574323, "env_to_module_connector": {"timers": {"connectors": {"numpy_to_tensor": 9.618154668549595e-06, "add_states_from_episodes_to_batch": 1.7120859128707147e-06, "add_time_dim_to_batch_and_zero_pad": 2.8577396247445745e-06, "batch_individual_items": 7.5439887866643905e-06, "add_observations_from_episodes_to_batch": 3.7489377209764603e-06}}, "connector_pipeline_timer": 4.986540092013553e-05}, "module_episode_returns_mean": {"default_policy": 1.5}, "agent_episode_returns_mean": {"default_agent": 1.5}, "env_to_module_sum_episodes_length_out": 10.368238394574323, "episode_len_max": 20, "num_agent_steps_sampled": {"default_agent": 400}, "num_module_steps_sampled_lifetime": {"default_policy": 4800}, "episode_return_max": 13.5, "sample": 0.09669004309735973, "rlmodule_inference_timer": 3.250408820756954e-05, "env_reset_timer": 0.0002207470987542246, "episode_len_mean": 20.0, "weights_seq_no": 12.0, "episode_len_min": 20, "episode_duration_sec_mean": 0.00461059833294712, "episode_return_mean": 1.5, "num_env_steps_sampled": 400, "episode_return_min": -15.5, "num_agent_steps_sampled_lifetime": {"default_agent": 4800}, "num_episodes": 20, "env_step_timer": 1.670378432675916e-05, "num_env_steps_sampled_lifetime": 60400, "time_between_sampling": 1.6641281274279858}, "num_healthy_workers": 1, "actor_manager_num_outstanding_async_reqs": 0, "num_remote_worker_restarts": 0}, "num_env_steps_sampled_lifetime": -6165000.0, "fault_tolerance": {"num_healthy_workers": 0, "num_remote_worker_restarts": 0}, "env_runner_group": {"actor_manager_num_outstanding_async_reqs": 0}, "done": false, "training_iteration": 12, "trial_id": "4649a_00000", "date": "2025-08-11_19-36-37", "timestamp": 1754933797, "time_this_iter_s": 3.1786859035491943, "time_total_s": 27.023179531097412, "pid": 28167, "hostname": "Mac", "node_ip": "127.0.0.1", "config": {"exploration_config": {}, "extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "placement_strategy": "PACK", "num_gpus": 0, "_fake_gpus": false, "num_cpus_for_main_process": 2, "eager_tracing": true, "eager_max_retraces": 20, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "torch_compile_learner": false, "torch_compile_learner_what_to_compile": "forward_train", "torch_compile_learner_dynamo_backend": "aot_eager", "torch_compile_learner_dynamo_mode": null, "torch_compile_worker": false, "torch_compile_worker_dynamo_backend": "aot_eager", "torch_compile_worker_dynamo_mode": null, "torch_ddp_kwargs": {}, "torch_skip_nan_gradients": false, "env": "Umbrella", "env_config": {}, "observation_space": null, "action_space": null, "clip_rewards": null, "normalize_actions": true, "clip_actions": false, "_is_atari": null, "disable_env_checking": false, "render_env": false, "action_mask_key": "action_mask", "env_runner_cls": null, "num_env_runners": 0, "create_local_env_runner": true, "num_envs_per_env_runner": 1, "gym_env_vectorize_mode": "SYNC", "num_cpus_per_env_runner": 1, "num_gpus_per_env_runner": 0, "custom_resources_per_env_runner": {}, "validate_env_runners_after_construction": true, "episodes_to_numpy": true, "max_requests_in_flight_per_env_runner": 1, "sample_timeout_s": 60.0, "_env_to_module_connector": null, "add_default_connectors_to_env_to_module_pipeline": true, "_module_to_env_connector": null, "add_default_connectors_to_module_to_env_pipeline": true, "merge_env_runner_states": "training_only", "broadcast_env_runner_states": true, "episode_lookback_horizon": 1, "rollout_fragment_length": "auto", "batch_mode": "complete_episodes", "compress_observations": false, "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "enable_tf1_exec_eagerly": false, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "preprocessor_pref": "deepmind", "observation_filter": "NoFilter", "update_worker_filter_stats": true, "use_worker_filter_stats": true, "sampler_perf_stats_ema_coef": null, "_is_online": true, "num_learners": 0, "num_gpus_per_learner": 0, "num_cpus_per_learner": "auto", "num_aggregator_actors_per_learner": 0, "max_requests_in_flight_per_aggregator_actor": 3, "local_gpu_idx": 0, "max_requests_in_flight_per_learner": 3, "gamma": 1, "lr": 0.0002847858517, "grad_clip": 0.5, "grad_clip_by": "global_norm", "_train_batch_size_per_learner": 5000, "train_batch_size": 4000, "num_epochs": 1, "minibatch_size": 1000, "shuffle_batch_per_epoch": true, "model": {"fcnet_hiddens": [256, 256], "fcnet_activation": "tanh", "fcnet_weights_initializer": null, "fcnet_weights_initializer_config": null, "fcnet_bias_initializer": null, "fcnet_bias_initializer_config": null, "conv_filters": null, "conv_activation": "relu", "conv_kernel_initializer": null, "conv_kernel_initializer_config": null, "conv_bias_initializer": null, "conv_bias_initializer_config": null, "conv_transpose_kernel_initializer": null, "conv_transpose_kernel_initializer_config": null, "conv_transpose_bias_initializer": null, "conv_transpose_bias_initializer_config": null, "post_fcnet_hiddens": [], "post_fcnet_activation": "relu", "post_fcnet_weights_initializer": null, "post_fcnet_weights_initializer_config": null, "post_fcnet_bias_initializer": null, "post_fcnet_bias_initializer_config": null, "free_log_std": false, "log_std_clip_param": 20.0, "no_final_linear": false, "vf_share_layers": false, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "lstm_weights_initializer": null, "lstm_weights_initializer_config": null, "lstm_bias_initializer": null, "lstm_bias_initializer_config": null, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "attention_use_n_prev_actions": 0, "attention_use_n_prev_rewards": 0, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": null, "custom_model_config": {}, "custom_action_dist": null, "custom_preprocessor": null, "encoder_latent_dim": null, "always_check_shapes": false, "lstm_use_prev_action_reward": -1, "_use_default_native_models": -1, "_disable_preprocessor_api": false, "_disable_action_flattening": false}, "_learner_connector": null, "add_default_connectors_to_learner_pipeline": true, "learner_config_dict": {}, "optimizer": {}, "_learner_class": null, "callbacks_on_algorithm_init": null, "callbacks_on_env_runners_recreated": null, "callbacks_on_offline_eval_runners_recreated": null, "callbacks_on_checkpoint_loaded": null, "callbacks_on_environment_created": null, "callbacks_on_episode_created": null, "callbacks_on_episode_start": null, "callbacks_on_episode_step": null, "callbacks_on_episode_end": null, "callbacks_on_evaluate_start": null, "callbacks_on_evaluate_end": null, "callbacks_on_evaluate_offline_start": null, "callbacks_on_evaluate_offline_end": null, "callbacks_on_sample_end": null, "callbacks_on_train_result": null, "explore": true, "enable_rl_module_and_learner": true, "enable_env_runner_and_connector_v2": true, "_prior_exploration_config": {"type": "StochasticSampling"}, "count_steps_by": "env_steps", "policy_map_capacity": 100, "policy_mapping_fn": "<function AlgorithmConfig.DEFAULT_POLICY_MAPPING_FN at 0x17c065b20>", "policies_to_train": null, "policy_states_are_swappable": false, "observation_fn": null, "offline_data_class": null, "input_read_method": "read_parquet", "input_read_method_kwargs": {}, "input_read_schema": {}, "input_read_episodes": false, "input_read_sample_batches": false, "input_read_batch_size": null, "input_filesystem": null, "input_filesystem_kwargs": {}, "input_compress_columns": ["obs", "new_obs"], "input_spaces_jsonable": true, "materialize_data": false, "materialize_mapped_data": true, "map_batches_kwargs": {}, "iter_batches_kwargs": {}, "ignore_final_observation": false, "prelearner_class": null, "prelearner_buffer_class": null, "prelearner_buffer_kwargs": {}, "prelearner_module_synch_period": 10, "dataset_num_iters_per_learner": null, "input_config": {}, "actions_in_input_normalized": false, "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_config": {}, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "output_max_rows_per_file": null, "output_write_remaining_data": false, "output_write_method": "write_parquet", "output_write_method_kwargs": {}, "output_filesystem": null, "output_filesystem_kwargs": {}, "output_write_episodes": true, "offline_sampling": false, "evaluation_interval": 1, "evaluation_duration": 20, "evaluation_duration_unit": "episodes", "evaluation_sample_timeout_s": 120.0, "evaluation_auto_duration_min_env_steps_per_sample": 100, "evaluation_auto_duration_max_env_steps_per_sample": 2000, "evaluation_parallel_to_training": false, "evaluation_force_reset_envs_before_iteration": true, "evaluation_config": null, "off_policy_estimation_methods": {}, "ope_split_batch_by_episode": true, "evaluation_num_env_runners": 1, "in_evaluation": false, "sync_filters_on_rollout_workers_timeout_s": 10.0, "offline_evaluation_interval": null, "num_offline_eval_runners": 0, "offline_loss_for_module_fn": null, "offline_evaluation_duration": 1, "offline_evaluation_parallel_to_training": false, "offline_evaluation_timeout_s": 120.0, "num_cpus_per_offline_eval_runner": 1, "num_gpus_per_offline_eval_runner": 0, "custom_resources_per_offline_eval_runner": {}, "restart_failed_offline_eval_runners": true, "ignore_offline_eval_runner_failures": false, "max_num_offline_eval_runner_restarts": 1000, "offline_eval_runner_restore_timeout_s": 1800.0, "max_requests_in_flight_per_offline_eval_runner": 1, "validate_offline_eval_runners_after_construction": true, "offline_eval_runner_health_probe_timeout_s": 30.0, "offline_eval_rl_module_inference_only": false, "broadcast_offline_eval_runner_states": false, "offline_eval_batch_size_per_runner": 256, "dataset_num_iters_per_eval_runner": 1, "keep_per_episode_custom_metrics": false, "metrics_episode_collection_timeout_s": 60.0, "metrics_num_episodes_for_smoothing": 100, "min_time_s_per_iteration": null, "min_train_timesteps_per_iteration": 0, "min_sample_timesteps_per_iteration": 0, "log_gradients": true, "export_native_model_files": false, "checkpoint_trainable_policies_only": false, "logger_creator": null, "logger_config": null, "log_level": "WARN", "log_sys_usage": true, "fake_sampler": false, "seed": 5, "restart_failed_env_runners": true, "ignore_env_runner_failures": false, "max_num_env_runner_restarts": 1000, "delay_between_env_runner_restarts_s": 60.0, "restart_failed_sub_environments": false, "num_consecutive_env_runner_failures_tolerance": 100, "env_runner_health_probe_timeout_s": 30.0, "env_runner_restore_timeout_s": 1800.0, "_model_config": {}, "_rl_module_spec": "RLModuleSpec(module_class=None, observation_space=None, action_space=None, inference_only=False, learner_only=False, model_config=DefaultModelConfig(fcnet_hiddens=[60, 90], fcnet_activation='tanh', fcnet_kernel_initializer=None, fcnet_kernel_initializer_kwargs=None, fcnet_bias_initializer=None, fcnet_bias_initializer_kwargs=None, conv_filters=None, conv_activation='relu', conv_kernel_initializer=None, conv_kernel_initializer_kwargs=None, conv_bias_initializer=None, conv_bias_initializer_kwargs=None, head_fcnet_hiddens=[], head_fcnet_activation='relu', head_fcnet_kernel_initializer=None, head_fcnet_kernel_initializer_kwargs=None, head_fcnet_bias_initializer=None, head_fcnet_bias_initializer_kwargs=None, free_log_std=False, log_std_clip_param=20.0, vf_share_layers=True, use_lstm=False, max_seq_len=20, lstm_cell_size=256, lstm_use_prev_action=False, lstm_use_prev_reward=False, lstm_kernel_initializer=None, lstm_kernel_initializer_kwargs=None, lstm_bias_initializer=None, lstm_bias_initializer_kwargs=None), catalog_class=None, load_state_path=None, model_config_dict=None)", "algorithm_config_overrides_per_module": {}, "_per_module_overrides": {}, "_validate_config": true, "_use_msgpack_checkpoints": false, "_torch_grad_scaler_class": null, "_torch_lr_scheduler_classes": null, "_tf_policy_handles_more_than_one_loss": false, "_disable_preprocessor_api": false, "_disable_action_flattening": false, "_disable_initialize_loss_from_dummy_batch": false, "_dont_auto_sync_env_runner_states": false, "env_task_fn": -1, "enable_connectors": -1, "simple_optimizer": false, "policy_map_cache": -1, "worker_cls": -1, "synchronize_filters": -1, "enable_async_evaluation": -1, "custom_async_evaluation_function": -1, "_enable_rl_module_api": -1, "auto_wrap_old_gym_envs": -1, "always_attach_evaluation_results": -1, "replay_sequence_length": null, "_disable_execution_plan_api": -1, "use_critic": true, "use_gae": true, "use_kl_loss": true, "kl_coeff": 0.7464963036515, "kl_target": 0.0270990929592, "vf_loss_coeff": 0.6688075857018, "entropy_coeff": 0.0090570820258, "clip_param": 0.1221781641624, "vf_clip_param": 0.1027808522125, "entropy_coeff_schedule": null, "lr_schedule": null, "sgd_minibatch_size": -1, "vf_share_layers": -1, "__stdout_file__": null, "__stderr_file__": null, "lambda": 0.9099046732075, "input": "sampler", "policies": {"default_policy": [null, null, null, null]}, "callbacks": "<class 'ray.rllib.callbacks.callbacks.RLlibCallback'>", "create_env_on_driver": false, "custom_eval_function": null, "framework": "torch"}, "time_since_restore": 27.023179531097412, "iterations_since_restore": 12, "perf": {"cpu_util_percent": 85.60000000000001, "ram_util_percent": 79.875}}
{"timers": {"training_iteration": 1.6076554721660876, "restore_env_runners": 7.770326283738726e-06, "training_step": 1.6075184847202213, "env_runner_sampling_timer": 1.497802507135779, "learner_update_timer": 0.10660378290371557, "synch_weights": 0.0006212749398072573, "restore_eval_env_runners": 9.099751808488421e-06, "evaluation_iteration": 0.10296389290002621, "synch_eval_env_connectors": 0.00012097878743169246, "synch_env_connectors": 4.556394915579806e-06}, "env_runners": {"env_to_module_connector": {"timers": {"connectors": {"numpy_to_tensor": 1.1159607248207894e-05, "add_states_from_episodes_to_batch": 1.9563560840084025e-06, "batch_individual_items": 7.696772681364623e-06, "add_observations_from_episodes_to_batch": 3.5023282606647857e-06, "add_time_dim_to_batch_and_zero_pad": 2.7503427072293085e-06}}, "connector_pipeline_timer": 5.294889100198721e-05}, "num_agent_steps_sampled_lifetime": {"default_agent": -6782500.0}, "env_to_module_sum_episodes_length_out": 10.36823839457432, "num_episodes": 250.0, "episode_len_max": 20, "num_module_steps_sampled": {"default_policy": 5000.0}, "module_to_env_connector": {"timers": {"connectors": {"un_batch_to_individual_items": 6.3092647861871645e-06, "listify_data_for_vector_env": 1.3138696189978888e-05, "normalize_and_clip_actions": 1.1377600260587788e-05, "get_actions": 4.934564359928899e-05, "tensor_to_numpy": 1.6013488915597292e-05, "remove_single_ts_time_rank_from_batch": 6.714685069786654e-07}}, "connector_pipeline_timer": 0.00012700447146453785}, "num_module_steps_sampled_lifetime": {"default_policy": -6782500.0}, "num_episodes_lifetime": -339125.0, "episode_len_min": 20, "episode_return_max": 6.5, "env_to_module_sum_episodes_length_in": 10.36823839457432, "env_step_timer": 1.7002079125853714e-05, "sample": 0.006406704208178361, "rlmodule_inference_timer": 3.4699486833399976e-05, "episode_duration_sec_mean": 0.005596026806160806, "episode_return_mean": 3.7799999999999994, "module_episode_returns_mean": {"default_policy": 3.7799999999999994}, "env_reset_timer": 5.2554888658410746e-05, "num_env_steps_sampled_lifetime": -6782500.0, "num_env_steps_sampled": 5000.0, "episode_return_min": -13.5, "episode_len_mean": 20.0, "weights_seq_no": 12.0, "num_agent_steps_sampled": {"default_agent": 5000.0}, "time_between_sampling": 0.0023361415666322727, "agent_episode_returns_mean": {"default_agent": 3.7799999999999994}, "num_env_steps_sampled_lifetime_throughput": 3225.97581562892}, "learners": {"default_policy": {"policy_loss": -0.0575651116669178, "vf_loss": 0.10278083384037018, "vf_loss_unclipped": 23.493480682373047, "num_module_steps_trained": 6000, "diff_num_grad_updates_vs_sampler_policy": 1.0, "default_optimizer_learning_rate": 0.0002847858517, "weights_seq_no": 13.0, "total_loss": 0.006881259847432375, "vf_explained_var": -0.021043896675109863, "module_train_batch_size_mean": 1000.0, "num_module_steps_trained_lifetime": 78000, "gradients_default_optimizer_global_norm": 0.11829666048288345, "entropy": 0.47413647174835205, "curr_entropy_coeff": 0.0090570820258, "num_trainable_parameters": 6003, "curr_kl_coeff": 9.112503903452307e-05, "mean_kl_loss": 0.00026610048371367157, "num_module_steps_trained_lifetime_throughput": 444479.149404197}, "__all_modules__": {"learner_connector": {"timers": {"connectors": {"batch_individual_items": 0.03387809247998465, "add_observations_from_episodes_to_batch": 0.000786498868566107, "add_columns_from_episodes_to_train_batch": 0.03397595047509492, "general_advantage_estimation": 0.00623824542092209, "add_time_dim_to_batch_and_zero_pad": 9.378681501158771e-06, "numpy_to_tensor": 6.293859041455866e-05, "add_states_from_episodes_to_batch": 3.114461569438616e-06, "add_one_ts_to_episodes_and_truncate": 0.008352662398404771}}, "connector_pipeline_timer": 0.083414961013378}, "num_trainable_parameters": 6003, "num_env_steps_trained_lifetime": 409500, "num_module_steps_trained": 6000, "num_non_trainable_parameters": 0, "num_env_steps_trained": 31500, "num_module_steps_trained_lifetime": 78000, "learner_connector_sum_episodes_length_in": 5000.0, "learner_connector_sum_episodes_length_out": 5250.0, "num_env_steps_trained_lifetime_throughput": 2322842.6964582205, "num_module_steps_trained_throughput": 443964.93460386584, "num_module_steps_trained_lifetime_throughput": 443308.9216767108}}, "num_training_step_calls_per_iteration": 1, "evaluation": {"env_runners": {"module_to_env_connector": {"connector_pipeline_timer": 0.00011538850436254182, "timers": {"connectors": {"listify_data_for_vector_env": 1.2819771578880935e-05, "get_actions": 4.303303575775608e-05, "remove_single_ts_time_rank_from_batch": 6.253145749072709e-07, "tensor_to_numpy": 1.4218967961732183e-05, "un_batch_to_individual_items": 5.791268841263442e-06, "normalize_and_clip_actions": 1.082112984125029e-05}}}, "num_episodes_lifetime": 260, "num_module_steps_sampled": {"default_policy": 400}, "env_to_module_sum_episodes_length_in": 10.368238394574323, "env_to_module_connector": {"timers": {"connectors": {"numpy_to_tensor": 9.946304730361004e-06, "add_states_from_episodes_to_batch": 1.7400197399687361e-06, "add_time_dim_to_batch_and_zero_pad": 2.3388102050575796e-06, "batch_individual_items": 6.691230173765431e-06, "add_observations_from_episodes_to_batch": 3.09297912427527e-06}}, "connector_pipeline_timer": 4.8368647250427003e-05}, "module_episode_returns_mean": {"default_policy": 1.1}, "agent_episode_returns_mean": {"default_agent": 1.1}, "env_to_module_sum_episodes_length_out": 10.368238394574323, "episode_len_max": 20, "num_agent_steps_sampled": {"default_agent": 400}, "num_module_steps_sampled_lifetime": {"default_policy": 5200}, "episode_return_max": 13.5, "sample": 0.0968944509961807, "rlmodule_inference_timer": 3.0901084006164886e-05, "env_reset_timer": 0.0002192521267891662, "episode_len_mean": 20.0, "weights_seq_no": 13.0, "episode_len_min": 20, "episode_duration_sec_mean": 0.004818672928959131, "episode_return_mean": 1.1, "num_env_steps_sampled": 400, "episode_return_min": -15.5, "num_agent_steps_sampled_lifetime": {"default_agent": 5200}, "num_episodes": 20, "env_step_timer": 1.695223924706306e-05, "num_env_steps_sampled_lifetime": 65400, "time_between_sampling": 1.6673078524031095}, "num_healthy_workers": 1, "actor_manager_num_outstanding_async_reqs": 0, "num_remote_worker_restarts": 0}, "num_env_steps_sampled_lifetime": -6782500.0, "fault_tolerance": {"num_healthy_workers": 0, "num_remote_worker_restarts": 0}, "env_runner_group": {"actor_manager_num_outstanding_async_reqs": 0}, "done": false, "training_iteration": 13, "trial_id": "4649a_00000", "date": "2025-08-11_19-36-39", "timestamp": 1754933799, "time_this_iter_s": 2.0666658878326416, "time_total_s": 29.089845418930054, "pid": 28167, "hostname": "Mac", "node_ip": "127.0.0.1", "config": {"exploration_config": {}, "extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "placement_strategy": "PACK", "num_gpus": 0, "_fake_gpus": false, "num_cpus_for_main_process": 2, "eager_tracing": true, "eager_max_retraces": 20, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "torch_compile_learner": false, "torch_compile_learner_what_to_compile": "forward_train", "torch_compile_learner_dynamo_backend": "aot_eager", "torch_compile_learner_dynamo_mode": null, "torch_compile_worker": false, "torch_compile_worker_dynamo_backend": "aot_eager", "torch_compile_worker_dynamo_mode": null, "torch_ddp_kwargs": {}, "torch_skip_nan_gradients": false, "env": "Umbrella", "env_config": {}, "observation_space": null, "action_space": null, "clip_rewards": null, "normalize_actions": true, "clip_actions": false, "_is_atari": null, "disable_env_checking": false, "render_env": false, "action_mask_key": "action_mask", "env_runner_cls": null, "num_env_runners": 0, "create_local_env_runner": true, "num_envs_per_env_runner": 1, "gym_env_vectorize_mode": "SYNC", "num_cpus_per_env_runner": 1, "num_gpus_per_env_runner": 0, "custom_resources_per_env_runner": {}, "validate_env_runners_after_construction": true, "episodes_to_numpy": true, "max_requests_in_flight_per_env_runner": 1, "sample_timeout_s": 60.0, "_env_to_module_connector": null, "add_default_connectors_to_env_to_module_pipeline": true, "_module_to_env_connector": null, "add_default_connectors_to_module_to_env_pipeline": true, "merge_env_runner_states": "training_only", "broadcast_env_runner_states": true, "episode_lookback_horizon": 1, "rollout_fragment_length": "auto", "batch_mode": "complete_episodes", "compress_observations": false, "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "enable_tf1_exec_eagerly": false, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "preprocessor_pref": "deepmind", "observation_filter": "NoFilter", "update_worker_filter_stats": true, "use_worker_filter_stats": true, "sampler_perf_stats_ema_coef": null, "_is_online": true, "num_learners": 0, "num_gpus_per_learner": 0, "num_cpus_per_learner": "auto", "num_aggregator_actors_per_learner": 0, "max_requests_in_flight_per_aggregator_actor": 3, "local_gpu_idx": 0, "max_requests_in_flight_per_learner": 3, "gamma": 1, "lr": 0.0002847858517, "grad_clip": 0.5, "grad_clip_by": "global_norm", "_train_batch_size_per_learner": 5000, "train_batch_size": 4000, "num_epochs": 1, "minibatch_size": 1000, "shuffle_batch_per_epoch": true, "model": {"fcnet_hiddens": [256, 256], "fcnet_activation": "tanh", "fcnet_weights_initializer": null, "fcnet_weights_initializer_config": null, "fcnet_bias_initializer": null, "fcnet_bias_initializer_config": null, "conv_filters": null, "conv_activation": "relu", "conv_kernel_initializer": null, "conv_kernel_initializer_config": null, "conv_bias_initializer": null, "conv_bias_initializer_config": null, "conv_transpose_kernel_initializer": null, "conv_transpose_kernel_initializer_config": null, "conv_transpose_bias_initializer": null, "conv_transpose_bias_initializer_config": null, "post_fcnet_hiddens": [], "post_fcnet_activation": "relu", "post_fcnet_weights_initializer": null, "post_fcnet_weights_initializer_config": null, "post_fcnet_bias_initializer": null, "post_fcnet_bias_initializer_config": null, "free_log_std": false, "log_std_clip_param": 20.0, "no_final_linear": false, "vf_share_layers": false, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "lstm_weights_initializer": null, "lstm_weights_initializer_config": null, "lstm_bias_initializer": null, "lstm_bias_initializer_config": null, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "attention_use_n_prev_actions": 0, "attention_use_n_prev_rewards": 0, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": null, "custom_model_config": {}, "custom_action_dist": null, "custom_preprocessor": null, "encoder_latent_dim": null, "always_check_shapes": false, "lstm_use_prev_action_reward": -1, "_use_default_native_models": -1, "_disable_preprocessor_api": false, "_disable_action_flattening": false}, "_learner_connector": null, "add_default_connectors_to_learner_pipeline": true, "learner_config_dict": {}, "optimizer": {}, "_learner_class": null, "callbacks_on_algorithm_init": null, "callbacks_on_env_runners_recreated": null, "callbacks_on_offline_eval_runners_recreated": null, "callbacks_on_checkpoint_loaded": null, "callbacks_on_environment_created": null, "callbacks_on_episode_created": null, "callbacks_on_episode_start": null, "callbacks_on_episode_step": null, "callbacks_on_episode_end": null, "callbacks_on_evaluate_start": null, "callbacks_on_evaluate_end": null, "callbacks_on_evaluate_offline_start": null, "callbacks_on_evaluate_offline_end": null, "callbacks_on_sample_end": null, "callbacks_on_train_result": null, "explore": true, "enable_rl_module_and_learner": true, "enable_env_runner_and_connector_v2": true, "_prior_exploration_config": {"type": "StochasticSampling"}, "count_steps_by": "env_steps", "policy_map_capacity": 100, "policy_mapping_fn": "<function AlgorithmConfig.DEFAULT_POLICY_MAPPING_FN at 0x17c065b20>", "policies_to_train": null, "policy_states_are_swappable": false, "observation_fn": null, "offline_data_class": null, "input_read_method": "read_parquet", "input_read_method_kwargs": {}, "input_read_schema": {}, "input_read_episodes": false, "input_read_sample_batches": false, "input_read_batch_size": null, "input_filesystem": null, "input_filesystem_kwargs": {}, "input_compress_columns": ["obs", "new_obs"], "input_spaces_jsonable": true, "materialize_data": false, "materialize_mapped_data": true, "map_batches_kwargs": {}, "iter_batches_kwargs": {}, "ignore_final_observation": false, "prelearner_class": null, "prelearner_buffer_class": null, "prelearner_buffer_kwargs": {}, "prelearner_module_synch_period": 10, "dataset_num_iters_per_learner": null, "input_config": {}, "actions_in_input_normalized": false, "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_config": {}, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "output_max_rows_per_file": null, "output_write_remaining_data": false, "output_write_method": "write_parquet", "output_write_method_kwargs": {}, "output_filesystem": null, "output_filesystem_kwargs": {}, "output_write_episodes": true, "offline_sampling": false, "evaluation_interval": 1, "evaluation_duration": 20, "evaluation_duration_unit": "episodes", "evaluation_sample_timeout_s": 120.0, "evaluation_auto_duration_min_env_steps_per_sample": 100, "evaluation_auto_duration_max_env_steps_per_sample": 2000, "evaluation_parallel_to_training": false, "evaluation_force_reset_envs_before_iteration": true, "evaluation_config": null, "off_policy_estimation_methods": {}, "ope_split_batch_by_episode": true, "evaluation_num_env_runners": 1, "in_evaluation": false, "sync_filters_on_rollout_workers_timeout_s": 10.0, "offline_evaluation_interval": null, "num_offline_eval_runners": 0, "offline_loss_for_module_fn": null, "offline_evaluation_duration": 1, "offline_evaluation_parallel_to_training": false, "offline_evaluation_timeout_s": 120.0, "num_cpus_per_offline_eval_runner": 1, "num_gpus_per_offline_eval_runner": 0, "custom_resources_per_offline_eval_runner": {}, "restart_failed_offline_eval_runners": true, "ignore_offline_eval_runner_failures": false, "max_num_offline_eval_runner_restarts": 1000, "offline_eval_runner_restore_timeout_s": 1800.0, "max_requests_in_flight_per_offline_eval_runner": 1, "validate_offline_eval_runners_after_construction": true, "offline_eval_runner_health_probe_timeout_s": 30.0, "offline_eval_rl_module_inference_only": false, "broadcast_offline_eval_runner_states": false, "offline_eval_batch_size_per_runner": 256, "dataset_num_iters_per_eval_runner": 1, "keep_per_episode_custom_metrics": false, "metrics_episode_collection_timeout_s": 60.0, "metrics_num_episodes_for_smoothing": 100, "min_time_s_per_iteration": null, "min_train_timesteps_per_iteration": 0, "min_sample_timesteps_per_iteration": 0, "log_gradients": true, "export_native_model_files": false, "checkpoint_trainable_policies_only": false, "logger_creator": null, "logger_config": null, "log_level": "WARN", "log_sys_usage": true, "fake_sampler": false, "seed": 5, "restart_failed_env_runners": true, "ignore_env_runner_failures": false, "max_num_env_runner_restarts": 1000, "delay_between_env_runner_restarts_s": 60.0, "restart_failed_sub_environments": false, "num_consecutive_env_runner_failures_tolerance": 100, "env_runner_health_probe_timeout_s": 30.0, "env_runner_restore_timeout_s": 1800.0, "_model_config": {}, "_rl_module_spec": "RLModuleSpec(module_class=None, observation_space=None, action_space=None, inference_only=False, learner_only=False, model_config=DefaultModelConfig(fcnet_hiddens=[60, 90], fcnet_activation='tanh', fcnet_kernel_initializer=None, fcnet_kernel_initializer_kwargs=None, fcnet_bias_initializer=None, fcnet_bias_initializer_kwargs=None, conv_filters=None, conv_activation='relu', conv_kernel_initializer=None, conv_kernel_initializer_kwargs=None, conv_bias_initializer=None, conv_bias_initializer_kwargs=None, head_fcnet_hiddens=[], head_fcnet_activation='relu', head_fcnet_kernel_initializer=None, head_fcnet_kernel_initializer_kwargs=None, head_fcnet_bias_initializer=None, head_fcnet_bias_initializer_kwargs=None, free_log_std=False, log_std_clip_param=20.0, vf_share_layers=True, use_lstm=False, max_seq_len=20, lstm_cell_size=256, lstm_use_prev_action=False, lstm_use_prev_reward=False, lstm_kernel_initializer=None, lstm_kernel_initializer_kwargs=None, lstm_bias_initializer=None, lstm_bias_initializer_kwargs=None), catalog_class=None, load_state_path=None, model_config_dict=None)", "algorithm_config_overrides_per_module": {}, "_per_module_overrides": {}, "_validate_config": true, "_use_msgpack_checkpoints": false, "_torch_grad_scaler_class": null, "_torch_lr_scheduler_classes": null, "_tf_policy_handles_more_than_one_loss": false, "_disable_preprocessor_api": false, "_disable_action_flattening": false, "_disable_initialize_loss_from_dummy_batch": false, "_dont_auto_sync_env_runner_states": false, "env_task_fn": -1, "enable_connectors": -1, "simple_optimizer": false, "policy_map_cache": -1, "worker_cls": -1, "synchronize_filters": -1, "enable_async_evaluation": -1, "custom_async_evaluation_function": -1, "_enable_rl_module_api": -1, "auto_wrap_old_gym_envs": -1, "always_attach_evaluation_results": -1, "replay_sequence_length": null, "_disable_execution_plan_api": -1, "use_critic": true, "use_gae": true, "use_kl_loss": true, "kl_coeff": 0.7464963036515, "kl_target": 0.0270990929592, "vf_loss_coeff": 0.6688075857018, "entropy_coeff": 0.0090570820258, "clip_param": 0.1221781641624, "vf_clip_param": 0.1027808522125, "entropy_coeff_schedule": null, "lr_schedule": null, "sgd_minibatch_size": -1, "vf_share_layers": -1, "__stdout_file__": null, "__stderr_file__": null, "lambda": 0.9099046732075, "input": "sampler", "policies": {"default_policy": [null, null, null, null]}, "callbacks": "<class 'ray.rllib.callbacks.callbacks.RLlibCallback'>", "create_env_on_driver": false, "custom_eval_function": null, "framework": "torch"}, "time_since_restore": 29.089845418930054, "iterations_since_restore": 13, "perf": {"cpu_util_percent": 79.96666666666667, "ram_util_percent": 78.66666666666666}}
{"timers": {"training_iteration": 1.6089931220251361, "restore_env_runners": 7.75721256975736e-06, "training_step": 1.6088556357037596, "env_runner_sampling_timer": 1.4984202949737262, "learner_update_timer": 0.10732331257530695, "synch_weights": 0.0006205688598131698, "restore_eval_env_runners": 9.081254260377697e-06, "evaluation_iteration": 0.10317490605118558, "synch_eval_env_connectors": 0.00012246483032907508, "synch_env_connectors": 4.565001343976518e-06}, "env_runners": {"env_to_module_connector": {"timers": {"connectors": {"numpy_to_tensor": 9.900582833511862e-06, "add_states_from_episodes_to_batch": 1.895654191945681e-06, "batch_individual_items": 7.169591543553049e-06, "add_observations_from_episodes_to_batch": 3.2244315011230534e-06, "add_time_dim_to_batch_and_zero_pad": 2.6183679599907504e-06}}, "connector_pipeline_timer": 4.895600978728093e-05}, "num_agent_steps_sampled_lifetime": {"default_agent": -7400000.0}, "env_to_module_sum_episodes_length_out": 10.36823839457432, "num_episodes": 250.0, "episode_len_max": 20, "num_module_steps_sampled": {"default_policy": 5000.0}, "module_to_env_connector": {"timers": {"connectors": {"un_batch_to_individual_items": 5.888299194419301e-06, "listify_data_for_vector_env": 1.220458822812913e-05, "normalize_and_clip_actions": 1.0609823511727145e-05, "get_actions": 4.393087096380656e-05, "tensor_to_numpy": 1.4603282295489922e-05, "remove_single_ts_time_rank_from_batch": 6.66043409720317e-07}}, "connector_pipeline_timer": 0.00011655408729022545}, "num_module_steps_sampled_lifetime": {"default_policy": -7400000.0}, "num_episodes_lifetime": -370000.0, "episode_len_min": 20, "episode_return_max": 6.5, "env_to_module_sum_episodes_length_in": 10.36823839457432, "env_step_timer": 1.6108083774709564e-05, "sample": 0.006063071319146844, "rlmodule_inference_timer": 3.309136298894434e-05, "episode_duration_sec_mean": 0.005144829163793474, "episode_return_mean": 4.18, "module_episode_returns_mean": {"default_policy": 4.18}, "env_reset_timer": 5.39314028859943e-05, "num_env_steps_sampled_lifetime": -7400000.0, "num_env_steps_sampled": 5000.0, "episode_return_min": -13.5, "episode_len_mean": 20.0, "weights_seq_no": 13.0, "num_agent_steps_sampled": {"default_agent": 5000.0}, "time_between_sampling": 0.0021521117948358885, "agent_episode_returns_mean": {"default_agent": 4.18}, "num_env_steps_sampled_lifetime_throughput": 3384.3843037832994}, "learners": {"default_policy": {"policy_loss": 0.04959893226623535, "vf_loss": 0.10278083384037018, "vf_loss_unclipped": 23.913816452026367, "num_module_steps_trained": 6000, "diff_num_grad_updates_vs_sampler_policy": 1.0, "default_optimizer_learning_rate": 0.0002847858517, "weights_seq_no": 14.0, "total_loss": 0.11405530571937561, "vf_explained_var": -0.019382357597351074, "module_train_batch_size_mean": 1000.0, "num_module_steps_trained_lifetime": 84000, "gradients_default_optimizer_global_norm": 0.035817701369524, "entropy": 0.47302621603012085, "curr_entropy_coeff": 0.0090570820258, "num_trainable_parameters": 6003, "curr_kl_coeff": 4.5562519517261535e-05, "mean_kl_loss": 4.542641545413062e-05, "num_module_steps_trained_lifetime_throughput": 442038.1419478193}, "__all_modules__": {"learner_connector": {"timers": {"connectors": {"batch_individual_items": 0.03472100863579512, "add_observations_from_episodes_to_batch": 0.0007864955497542647, "add_columns_from_episodes_to_train_batch": 0.03397536805007557, "general_advantage_estimation": 0.006227617966153032, "add_time_dim_to_batch_and_zero_pad": 9.363224735438438e-06, "numpy_to_tensor": 6.28312841551378e-05, "add_states_from_episodes_to_batch": 3.109156498576936e-06, "add_one_ts_to_episodes_and_truncate": 0.008343941604793221}}, "connector_pipeline_timer": 0.08423754932337389}, "num_trainable_parameters": 6003, "num_env_steps_trained_lifetime": 441000, "num_module_steps_trained": 6000, "num_non_trainable_parameters": 0, "num_env_steps_trained": 31500, "num_module_steps_trained_lifetime": 84000, "learner_connector_sum_episodes_length_in": 5000.0, "learner_connector_sum_episodes_length_out": 5250.0, "num_env_steps_trained_lifetime_throughput": 2310668.6947880657, "num_module_steps_trained_throughput": 441580.1611262174, "num_module_steps_trained_lifetime_throughput": 440949.69535568455}}, "num_training_step_calls_per_iteration": 1, "evaluation": {"env_runners": {"module_to_env_connector": {"connector_pipeline_timer": 9.696335525522423e-05, "timers": {"connectors": {"listify_data_for_vector_env": 1.0683096022968927e-05, "get_actions": 3.3950828257264645e-05, "remove_single_ts_time_rank_from_batch": 5.555527274683109e-07, "tensor_to_numpy": 1.2403005321583387e-05, "un_batch_to_individual_items": 5.243340959682323e-06, "normalize_and_clip_actions": 9.112259312282366e-06}}}, "num_episodes_lifetime": 280, "num_module_steps_sampled": {"default_policy": 400}, "env_to_module_sum_episodes_length_in": 10.368238394574323, "env_to_module_connector": {"timers": {"connectors": {"numpy_to_tensor": 8.060425182042757e-06, "add_states_from_episodes_to_batch": 1.5293724878665968e-06, "add_time_dim_to_batch_and_zero_pad": 2.127471545109911e-06, "batch_individual_items": 5.97865464757006e-06, "add_observations_from_episodes_to_batch": 2.7408397545127625e-06}}, "connector_pipeline_timer": 4.16220053555762e-05}, "module_episode_returns_mean": {"default_policy": 0.9}, "agent_episode_returns_mean": {"default_agent": 0.9}, "env_to_module_sum_episodes_length_out": 10.368238394574323, "episode_len_max": 20, "num_agent_steps_sampled": {"default_agent": 400}, "num_module_steps_sampled_lifetime": {"default_policy": 5600}, "episode_return_max": 12.5, "sample": 0.09686934898620146, "rlmodule_inference_timer": 2.5852789736015694e-05, "env_reset_timer": 0.0002177808554835001, "episode_len_mean": 20.0, "weights_seq_no": 14.0, "episode_len_min": 20, "episode_duration_sec_mean": 0.0048199974605813625, "episode_return_mean": 0.9, "num_env_steps_sampled": 400, "episode_return_min": -15.5, "num_agent_steps_sampled_lifetime": {"default_agent": 5600}, "num_episodes": 20, "env_step_timer": 1.3628858798168924e-05, "num_env_steps_sampled_lifetime": 70400, "time_between_sampling": 1.6682606555488884}, "num_healthy_workers": 1, "actor_manager_num_outstanding_async_reqs": 0, "num_remote_worker_restarts": 0}, "num_env_steps_sampled_lifetime": -7400000.0, "fault_tolerance": {"num_healthy_workers": 0, "num_remote_worker_restarts": 0}, "env_runner_group": {"actor_manager_num_outstanding_async_reqs": 0}, "done": false, "training_iteration": 14, "trial_id": "4649a_00000", "date": "2025-08-11_19-36-41", "timestamp": 1754933801, "time_this_iter_s": 1.842803955078125, "time_total_s": 30.93264937400818, "pid": 28167, "hostname": "Mac", "node_ip": "127.0.0.1", "config": {"exploration_config": {}, "extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "placement_strategy": "PACK", "num_gpus": 0, "_fake_gpus": false, "num_cpus_for_main_process": 2, "eager_tracing": true, "eager_max_retraces": 20, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "torch_compile_learner": false, "torch_compile_learner_what_to_compile": "forward_train", "torch_compile_learner_dynamo_backend": "aot_eager", "torch_compile_learner_dynamo_mode": null, "torch_compile_worker": false, "torch_compile_worker_dynamo_backend": "aot_eager", "torch_compile_worker_dynamo_mode": null, "torch_ddp_kwargs": {}, "torch_skip_nan_gradients": false, "env": "Umbrella", "env_config": {}, "observation_space": null, "action_space": null, "clip_rewards": null, "normalize_actions": true, "clip_actions": false, "_is_atari": null, "disable_env_checking": false, "render_env": false, "action_mask_key": "action_mask", "env_runner_cls": null, "num_env_runners": 0, "create_local_env_runner": true, "num_envs_per_env_runner": 1, "gym_env_vectorize_mode": "SYNC", "num_cpus_per_env_runner": 1, "num_gpus_per_env_runner": 0, "custom_resources_per_env_runner": {}, "validate_env_runners_after_construction": true, "episodes_to_numpy": true, "max_requests_in_flight_per_env_runner": 1, "sample_timeout_s": 60.0, "_env_to_module_connector": null, "add_default_connectors_to_env_to_module_pipeline": true, "_module_to_env_connector": null, "add_default_connectors_to_module_to_env_pipeline": true, "merge_env_runner_states": "training_only", "broadcast_env_runner_states": true, "episode_lookback_horizon": 1, "rollout_fragment_length": "auto", "batch_mode": "complete_episodes", "compress_observations": false, "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "enable_tf1_exec_eagerly": false, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "preprocessor_pref": "deepmind", "observation_filter": "NoFilter", "update_worker_filter_stats": true, "use_worker_filter_stats": true, "sampler_perf_stats_ema_coef": null, "_is_online": true, "num_learners": 0, "num_gpus_per_learner": 0, "num_cpus_per_learner": "auto", "num_aggregator_actors_per_learner": 0, "max_requests_in_flight_per_aggregator_actor": 3, "local_gpu_idx": 0, "max_requests_in_flight_per_learner": 3, "gamma": 1, "lr": 0.0002847858517, "grad_clip": 0.5, "grad_clip_by": "global_norm", "_train_batch_size_per_learner": 5000, "train_batch_size": 4000, "num_epochs": 1, "minibatch_size": 1000, "shuffle_batch_per_epoch": true, "model": {"fcnet_hiddens": [256, 256], "fcnet_activation": "tanh", "fcnet_weights_initializer": null, "fcnet_weights_initializer_config": null, "fcnet_bias_initializer": null, "fcnet_bias_initializer_config": null, "conv_filters": null, "conv_activation": "relu", "conv_kernel_initializer": null, "conv_kernel_initializer_config": null, "conv_bias_initializer": null, "conv_bias_initializer_config": null, "conv_transpose_kernel_initializer": null, "conv_transpose_kernel_initializer_config": null, "conv_transpose_bias_initializer": null, "conv_transpose_bias_initializer_config": null, "post_fcnet_hiddens": [], "post_fcnet_activation": "relu", "post_fcnet_weights_initializer": null, "post_fcnet_weights_initializer_config": null, "post_fcnet_bias_initializer": null, "post_fcnet_bias_initializer_config": null, "free_log_std": false, "log_std_clip_param": 20.0, "no_final_linear": false, "vf_share_layers": false, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "lstm_weights_initializer": null, "lstm_weights_initializer_config": null, "lstm_bias_initializer": null, "lstm_bias_initializer_config": null, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "attention_use_n_prev_actions": 0, "attention_use_n_prev_rewards": 0, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": null, "custom_model_config": {}, "custom_action_dist": null, "custom_preprocessor": null, "encoder_latent_dim": null, "always_check_shapes": false, "lstm_use_prev_action_reward": -1, "_use_default_native_models": -1, "_disable_preprocessor_api": false, "_disable_action_flattening": false}, "_learner_connector": null, "add_default_connectors_to_learner_pipeline": true, "learner_config_dict": {}, "optimizer": {}, "_learner_class": null, "callbacks_on_algorithm_init": null, "callbacks_on_env_runners_recreated": null, "callbacks_on_offline_eval_runners_recreated": null, "callbacks_on_checkpoint_loaded": null, "callbacks_on_environment_created": null, "callbacks_on_episode_created": null, "callbacks_on_episode_start": null, "callbacks_on_episode_step": null, "callbacks_on_episode_end": null, "callbacks_on_evaluate_start": null, "callbacks_on_evaluate_end": null, "callbacks_on_evaluate_offline_start": null, "callbacks_on_evaluate_offline_end": null, "callbacks_on_sample_end": null, "callbacks_on_train_result": null, "explore": true, "enable_rl_module_and_learner": true, "enable_env_runner_and_connector_v2": true, "_prior_exploration_config": {"type": "StochasticSampling"}, "count_steps_by": "env_steps", "policy_map_capacity": 100, "policy_mapping_fn": "<function AlgorithmConfig.DEFAULT_POLICY_MAPPING_FN at 0x17c065b20>", "policies_to_train": null, "policy_states_are_swappable": false, "observation_fn": null, "offline_data_class": null, "input_read_method": "read_parquet", "input_read_method_kwargs": {}, "input_read_schema": {}, "input_read_episodes": false, "input_read_sample_batches": false, "input_read_batch_size": null, "input_filesystem": null, "input_filesystem_kwargs": {}, "input_compress_columns": ["obs", "new_obs"], "input_spaces_jsonable": true, "materialize_data": false, "materialize_mapped_data": true, "map_batches_kwargs": {}, "iter_batches_kwargs": {}, "ignore_final_observation": false, "prelearner_class": null, "prelearner_buffer_class": null, "prelearner_buffer_kwargs": {}, "prelearner_module_synch_period": 10, "dataset_num_iters_per_learner": null, "input_config": {}, "actions_in_input_normalized": false, "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_config": {}, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "output_max_rows_per_file": null, "output_write_remaining_data": false, "output_write_method": "write_parquet", "output_write_method_kwargs": {}, "output_filesystem": null, "output_filesystem_kwargs": {}, "output_write_episodes": true, "offline_sampling": false, "evaluation_interval": 1, "evaluation_duration": 20, "evaluation_duration_unit": "episodes", "evaluation_sample_timeout_s": 120.0, "evaluation_auto_duration_min_env_steps_per_sample": 100, "evaluation_auto_duration_max_env_steps_per_sample": 2000, "evaluation_parallel_to_training": false, "evaluation_force_reset_envs_before_iteration": true, "evaluation_config": null, "off_policy_estimation_methods": {}, "ope_split_batch_by_episode": true, "evaluation_num_env_runners": 1, "in_evaluation": false, "sync_filters_on_rollout_workers_timeout_s": 10.0, "offline_evaluation_interval": null, "num_offline_eval_runners": 0, "offline_loss_for_module_fn": null, "offline_evaluation_duration": 1, "offline_evaluation_parallel_to_training": false, "offline_evaluation_timeout_s": 120.0, "num_cpus_per_offline_eval_runner": 1, "num_gpus_per_offline_eval_runner": 0, "custom_resources_per_offline_eval_runner": {}, "restart_failed_offline_eval_runners": true, "ignore_offline_eval_runner_failures": false, "max_num_offline_eval_runner_restarts": 1000, "offline_eval_runner_restore_timeout_s": 1800.0, "max_requests_in_flight_per_offline_eval_runner": 1, "validate_offline_eval_runners_after_construction": true, "offline_eval_runner_health_probe_timeout_s": 30.0, "offline_eval_rl_module_inference_only": false, "broadcast_offline_eval_runner_states": false, "offline_eval_batch_size_per_runner": 256, "dataset_num_iters_per_eval_runner": 1, "keep_per_episode_custom_metrics": false, "metrics_episode_collection_timeout_s": 60.0, "metrics_num_episodes_for_smoothing": 100, "min_time_s_per_iteration": null, "min_train_timesteps_per_iteration": 0, "min_sample_timesteps_per_iteration": 0, "log_gradients": true, "export_native_model_files": false, "checkpoint_trainable_policies_only": false, "logger_creator": null, "logger_config": null, "log_level": "WARN", "log_sys_usage": true, "fake_sampler": false, "seed": 5, "restart_failed_env_runners": true, "ignore_env_runner_failures": false, "max_num_env_runner_restarts": 1000, "delay_between_env_runner_restarts_s": 60.0, "restart_failed_sub_environments": false, "num_consecutive_env_runner_failures_tolerance": 100, "env_runner_health_probe_timeout_s": 30.0, "env_runner_restore_timeout_s": 1800.0, "_model_config": {}, "_rl_module_spec": "RLModuleSpec(module_class=None, observation_space=None, action_space=None, inference_only=False, learner_only=False, model_config=DefaultModelConfig(fcnet_hiddens=[60, 90], fcnet_activation='tanh', fcnet_kernel_initializer=None, fcnet_kernel_initializer_kwargs=None, fcnet_bias_initializer=None, fcnet_bias_initializer_kwargs=None, conv_filters=None, conv_activation='relu', conv_kernel_initializer=None, conv_kernel_initializer_kwargs=None, conv_bias_initializer=None, conv_bias_initializer_kwargs=None, head_fcnet_hiddens=[], head_fcnet_activation='relu', head_fcnet_kernel_initializer=None, head_fcnet_kernel_initializer_kwargs=None, head_fcnet_bias_initializer=None, head_fcnet_bias_initializer_kwargs=None, free_log_std=False, log_std_clip_param=20.0, vf_share_layers=True, use_lstm=False, max_seq_len=20, lstm_cell_size=256, lstm_use_prev_action=False, lstm_use_prev_reward=False, lstm_kernel_initializer=None, lstm_kernel_initializer_kwargs=None, lstm_bias_initializer=None, lstm_bias_initializer_kwargs=None), catalog_class=None, load_state_path=None, model_config_dict=None)", "algorithm_config_overrides_per_module": {}, "_per_module_overrides": {}, "_validate_config": true, "_use_msgpack_checkpoints": false, "_torch_grad_scaler_class": null, "_torch_lr_scheduler_classes": null, "_tf_policy_handles_more_than_one_loss": false, "_disable_preprocessor_api": false, "_disable_action_flattening": false, "_disable_initialize_loss_from_dummy_batch": false, "_dont_auto_sync_env_runner_states": false, "env_task_fn": -1, "enable_connectors": -1, "simple_optimizer": false, "policy_map_cache": -1, "worker_cls": -1, "synchronize_filters": -1, "enable_async_evaluation": -1, "custom_async_evaluation_function": -1, "_enable_rl_module_api": -1, "auto_wrap_old_gym_envs": -1, "always_attach_evaluation_results": -1, "replay_sequence_length": null, "_disable_execution_plan_api": -1, "use_critic": true, "use_gae": true, "use_kl_loss": true, "kl_coeff": 0.7464963036515, "kl_target": 0.0270990929592, "vf_loss_coeff": 0.6688075857018, "entropy_coeff": 0.0090570820258, "clip_param": 0.1221781641624, "vf_clip_param": 0.1027808522125, "entropy_coeff_schedule": null, "lr_schedule": null, "sgd_minibatch_size": -1, "vf_share_layers": -1, "__stdout_file__": null, "__stderr_file__": null, "lambda": 0.9099046732075, "input": "sampler", "policies": {"default_policy": [null, null, null, null]}, "callbacks": "<class 'ray.rllib.callbacks.callbacks.RLlibCallback'>", "create_env_on_driver": false, "custom_eval_function": null, "framework": "torch"}, "time_since_restore": 30.93264937400818, "iterations_since_restore": 14, "perf": {"cpu_util_percent": 71.0, "ram_util_percent": 79.3}}
{"timers": {"training_iteration": 1.6081747962245783, "restore_env_runners": 7.737550081749376e-06, "training_step": 1.6080370751767437, "env_runner_sampling_timer": 1.4968995403542833, "learner_update_timer": 0.10802671362022767, "synch_weights": 0.0006199902617920743, "restore_eval_env_runners": 9.052102257132775e-06, "evaluation_iteration": 0.10313429657023805, "synch_eval_env_connectors": 0.00012222101254431313, "synch_env_connectors": 4.563931413877159e-06}, "env_runners": {"env_to_module_connector": {"timers": {"connectors": {"numpy_to_tensor": 8.364464448498923e-06, "add_states_from_episodes_to_batch": 1.7078032723034112e-06, "batch_individual_items": 6.249373161771342e-06, "add_observations_from_episodes_to_batch": 2.998884050821235e-06, "add_time_dim_to_batch_and_zero_pad": 2.2799634965614498e-06}}, "connector_pipeline_timer": 4.3423236388128494e-05}, "num_agent_steps_sampled_lifetime": {"default_agent": -8017500.0}, "env_to_module_sum_episodes_length_out": 10.36823839457432, "num_episodes": 250.0, "episode_len_max": 20, "num_module_steps_sampled": {"default_policy": 5000.0}, "module_to_env_connector": {"timers": {"connectors": {"un_batch_to_individual_items": 5.320702878418864e-06, "listify_data_for_vector_env": 1.0670328822119933e-05, "normalize_and_clip_actions": 9.190350365121801e-06, "get_actions": 3.674502484550741e-05, "tensor_to_numpy": 1.2766977572657471e-05, "remove_single_ts_time_rank_from_batch": 5.793560553921442e-07}}, "connector_pipeline_timer": 0.0001009464218195558}, "num_module_steps_sampled_lifetime": {"default_policy": -8017500.0}, "num_episodes_lifetime": -400875.0, "episode_len_min": 20, "episode_return_max": 6.5, "env_to_module_sum_episodes_length_in": 10.36823839457432, "env_step_timer": 1.3556979065587433e-05, "sample": 0.004905024974855268, "rlmodule_inference_timer": 2.652245296327185e-05, "episode_duration_sec_mean": 0.004449084640014916, "episode_return_mean": 4.019999999999998, "module_episode_returns_mean": {"default_policy": 4.019999999999998}, "env_reset_timer": 3.389989416848604e-05, "num_env_steps_sampled_lifetime": -8017500.0, "num_env_steps_sampled": 5000.0, "episode_return_min": -13.5, "episode_len_mean": 20.0, "weights_seq_no": 14.0, "num_agent_steps_sampled": {"default_agent": 5000.0}, "time_between_sampling": 0.0018325865511904563, "agent_episode_returns_mean": {"default_agent": 4.019999999999998}, "num_env_steps_sampled_lifetime_throughput": 3813.9192634087644}, "learners": {"default_policy": {"policy_loss": -0.06058907508850098, "vf_loss": 0.10278083384037018, "vf_loss_unclipped": 23.113862991333008, "num_module_steps_trained": 6000, "diff_num_grad_updates_vs_sampler_policy": 1.0, "default_optimizer_learning_rate": 0.0002847858517, "weights_seq_no": 15.0, "total_loss": 0.004048810340464115, "vf_explained_var": -0.02093040943145752, "module_train_batch_size_mean": 1000.0, "num_module_steps_trained_lifetime": 90000, "gradients_default_optimizer_global_norm": 0.042700961232185364, "entropy": 0.452986478805542, "curr_entropy_coeff": 0.0090570820258, "num_trainable_parameters": 6003, "curr_kl_coeff": 2.2781259758630767e-05, "mean_kl_loss": 0.00023884468828327954, "num_module_steps_trained_lifetime_throughput": 440746.89972625487}, "__all_modules__": {"learner_connector": {"timers": {"connectors": {"batch_individual_items": 0.03554682979921924, "add_observations_from_episodes_to_batch": 0.000786789344390311, "add_columns_from_episodes_to_train_batch": 0.03397510686963598, "general_advantage_estimation": 0.006218229285823929, "add_time_dim_to_batch_and_zero_pad": 9.367922689665173e-06, "numpy_to_tensor": 6.282214133671481e-05, "add_states_from_episodes_to_batch": 3.1051547789802945e-06, "add_one_ts_to_episodes_and_truncate": 0.008336872188187539}}, "connector_pipeline_timer": 0.08504676508011459}, "num_trainable_parameters": 6003, "num_env_steps_trained_lifetime": 472500, "num_module_steps_trained": 6000, "num_non_trainable_parameters": 0, "num_env_steps_trained": 31500, "num_module_steps_trained_lifetime": 90000, "learner_connector_sum_episodes_length_in": 5000.0, "learner_connector_sum_episodes_length_out": 5250.0, "num_env_steps_trained_lifetime_throughput": 2304521.927988302, "num_module_steps_trained_throughput": 440346.7723162623, "num_module_steps_trained_lifetime_throughput": 439740.17522537394}}, "num_training_step_calls_per_iteration": 1, "evaluation": {"env_runners": {"module_to_env_connector": {"connector_pipeline_timer": 9.723439809117367e-05, "timers": {"connectors": {"listify_data_for_vector_env": 1.0753869641472378e-05, "get_actions": 3.402012870056944e-05, "remove_single_ts_time_rank_from_batch": 5.612539465094838e-07, "tensor_to_numpy": 1.2290782529837313e-05, "un_batch_to_individual_items": 5.51577932156575e-06, "normalize_and_clip_actions": 9.30371488883507e-06}}}, "num_episodes_lifetime": 300, "num_module_steps_sampled": {"default_policy": 400}, "env_to_module_sum_episodes_length_in": 10.368238394574323, "env_to_module_connector": {"timers": {"connectors": {"numpy_to_tensor": 7.964660096638549e-06, "add_states_from_episodes_to_batch": 1.510611282973358e-06, "add_time_dim_to_batch_and_zero_pad": 2.124063447694481e-06, "batch_individual_items": 6.060118684642065e-06, "add_observations_from_episodes_to_batch": 2.730745487583497e-06}}, "connector_pipeline_timer": 4.127094248648097e-05}, "module_episode_returns_mean": {"default_policy": 1.3}, "agent_episode_returns_mean": {"default_agent": 1.3}, "env_to_module_sum_episodes_length_out": 10.368238394574323, "episode_len_max": 20, "num_agent_steps_sampled": {"default_agent": 400}, "num_module_steps_sampled_lifetime": {"default_policy": 6000}, "episode_return_max": 12.5, "sample": 0.09684989049721988, "rlmodule_inference_timer": 2.619425473092714e-05, "env_reset_timer": 0.0002163717966705025, "episode_len_mean": 20.0, "weights_seq_no": 15.0, "episode_len_min": 20, "episode_duration_sec_mean": 0.0047970537201035765, "episode_return_mean": 1.3, "num_env_steps_sampled": 400, "episode_return_min": -15.5, "num_agent_steps_sampled_lifetime": {"default_agent": 6000}, "num_episodes": 20, "env_step_timer": 1.3652340157678565e-05, "num_env_steps_sampled_lifetime": 75400, "time_between_sampling": 1.6670167810838057}, "num_healthy_workers": 1, "actor_manager_num_outstanding_async_reqs": 0, "num_remote_worker_restarts": 0}, "num_env_steps_sampled_lifetime": -8017500.0, "fault_tolerance": {"num_healthy_workers": 0, "num_remote_worker_restarts": 0}, "env_runner_group": {"actor_manager_num_outstanding_async_reqs": 0}, "done": false, "training_iteration": 15, "trial_id": "4649a_00000", "date": "2025-08-11_19-36-43", "timestamp": 1754933803, "time_this_iter_s": 1.629464864730835, "time_total_s": 32.562114238739014, "pid": 28167, "hostname": "Mac", "node_ip": "127.0.0.1", "config": {"exploration_config": {}, "extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "placement_strategy": "PACK", "num_gpus": 0, "_fake_gpus": false, "num_cpus_for_main_process": 2, "eager_tracing": true, "eager_max_retraces": 20, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "torch_compile_learner": false, "torch_compile_learner_what_to_compile": "forward_train", "torch_compile_learner_dynamo_backend": "aot_eager", "torch_compile_learner_dynamo_mode": null, "torch_compile_worker": false, "torch_compile_worker_dynamo_backend": "aot_eager", "torch_compile_worker_dynamo_mode": null, "torch_ddp_kwargs": {}, "torch_skip_nan_gradients": false, "env": "Umbrella", "env_config": {}, "observation_space": null, "action_space": null, "clip_rewards": null, "normalize_actions": true, "clip_actions": false, "_is_atari": null, "disable_env_checking": false, "render_env": false, "action_mask_key": "action_mask", "env_runner_cls": null, "num_env_runners": 0, "create_local_env_runner": true, "num_envs_per_env_runner": 1, "gym_env_vectorize_mode": "SYNC", "num_cpus_per_env_runner": 1, "num_gpus_per_env_runner": 0, "custom_resources_per_env_runner": {}, "validate_env_runners_after_construction": true, "episodes_to_numpy": true, "max_requests_in_flight_per_env_runner": 1, "sample_timeout_s": 60.0, "_env_to_module_connector": null, "add_default_connectors_to_env_to_module_pipeline": true, "_module_to_env_connector": null, "add_default_connectors_to_module_to_env_pipeline": true, "merge_env_runner_states": "training_only", "broadcast_env_runner_states": true, "episode_lookback_horizon": 1, "rollout_fragment_length": "auto", "batch_mode": "complete_episodes", "compress_observations": false, "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "enable_tf1_exec_eagerly": false, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "preprocessor_pref": "deepmind", "observation_filter": "NoFilter", "update_worker_filter_stats": true, "use_worker_filter_stats": true, "sampler_perf_stats_ema_coef": null, "_is_online": true, "num_learners": 0, "num_gpus_per_learner": 0, "num_cpus_per_learner": "auto", "num_aggregator_actors_per_learner": 0, "max_requests_in_flight_per_aggregator_actor": 3, "local_gpu_idx": 0, "max_requests_in_flight_per_learner": 3, "gamma": 1, "lr": 0.0002847858517, "grad_clip": 0.5, "grad_clip_by": "global_norm", "_train_batch_size_per_learner": 5000, "train_batch_size": 4000, "num_epochs": 1, "minibatch_size": 1000, "shuffle_batch_per_epoch": true, "model": {"fcnet_hiddens": [256, 256], "fcnet_activation": "tanh", "fcnet_weights_initializer": null, "fcnet_weights_initializer_config": null, "fcnet_bias_initializer": null, "fcnet_bias_initializer_config": null, "conv_filters": null, "conv_activation": "relu", "conv_kernel_initializer": null, "conv_kernel_initializer_config": null, "conv_bias_initializer": null, "conv_bias_initializer_config": null, "conv_transpose_kernel_initializer": null, "conv_transpose_kernel_initializer_config": null, "conv_transpose_bias_initializer": null, "conv_transpose_bias_initializer_config": null, "post_fcnet_hiddens": [], "post_fcnet_activation": "relu", "post_fcnet_weights_initializer": null, "post_fcnet_weights_initializer_config": null, "post_fcnet_bias_initializer": null, "post_fcnet_bias_initializer_config": null, "free_log_std": false, "log_std_clip_param": 20.0, "no_final_linear": false, "vf_share_layers": false, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "lstm_weights_initializer": null, "lstm_weights_initializer_config": null, "lstm_bias_initializer": null, "lstm_bias_initializer_config": null, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "attention_use_n_prev_actions": 0, "attention_use_n_prev_rewards": 0, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": null, "custom_model_config": {}, "custom_action_dist": null, "custom_preprocessor": null, "encoder_latent_dim": null, "always_check_shapes": false, "lstm_use_prev_action_reward": -1, "_use_default_native_models": -1, "_disable_preprocessor_api": false, "_disable_action_flattening": false}, "_learner_connector": null, "add_default_connectors_to_learner_pipeline": true, "learner_config_dict": {}, "optimizer": {}, "_learner_class": null, "callbacks_on_algorithm_init": null, "callbacks_on_env_runners_recreated": null, "callbacks_on_offline_eval_runners_recreated": null, "callbacks_on_checkpoint_loaded": null, "callbacks_on_environment_created": null, "callbacks_on_episode_created": null, "callbacks_on_episode_start": null, "callbacks_on_episode_step": null, "callbacks_on_episode_end": null, "callbacks_on_evaluate_start": null, "callbacks_on_evaluate_end": null, "callbacks_on_evaluate_offline_start": null, "callbacks_on_evaluate_offline_end": null, "callbacks_on_sample_end": null, "callbacks_on_train_result": null, "explore": true, "enable_rl_module_and_learner": true, "enable_env_runner_and_connector_v2": true, "_prior_exploration_config": {"type": "StochasticSampling"}, "count_steps_by": "env_steps", "policy_map_capacity": 100, "policy_mapping_fn": "<function AlgorithmConfig.DEFAULT_POLICY_MAPPING_FN at 0x17c065b20>", "policies_to_train": null, "policy_states_are_swappable": false, "observation_fn": null, "offline_data_class": null, "input_read_method": "read_parquet", "input_read_method_kwargs": {}, "input_read_schema": {}, "input_read_episodes": false, "input_read_sample_batches": false, "input_read_batch_size": null, "input_filesystem": null, "input_filesystem_kwargs": {}, "input_compress_columns": ["obs", "new_obs"], "input_spaces_jsonable": true, "materialize_data": false, "materialize_mapped_data": true, "map_batches_kwargs": {}, "iter_batches_kwargs": {}, "ignore_final_observation": false, "prelearner_class": null, "prelearner_buffer_class": null, "prelearner_buffer_kwargs": {}, "prelearner_module_synch_period": 10, "dataset_num_iters_per_learner": null, "input_config": {}, "actions_in_input_normalized": false, "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_config": {}, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "output_max_rows_per_file": null, "output_write_remaining_data": false, "output_write_method": "write_parquet", "output_write_method_kwargs": {}, "output_filesystem": null, "output_filesystem_kwargs": {}, "output_write_episodes": true, "offline_sampling": false, "evaluation_interval": 1, "evaluation_duration": 20, "evaluation_duration_unit": "episodes", "evaluation_sample_timeout_s": 120.0, "evaluation_auto_duration_min_env_steps_per_sample": 100, "evaluation_auto_duration_max_env_steps_per_sample": 2000, "evaluation_parallel_to_training": false, "evaluation_force_reset_envs_before_iteration": true, "evaluation_config": null, "off_policy_estimation_methods": {}, "ope_split_batch_by_episode": true, "evaluation_num_env_runners": 1, "in_evaluation": false, "sync_filters_on_rollout_workers_timeout_s": 10.0, "offline_evaluation_interval": null, "num_offline_eval_runners": 0, "offline_loss_for_module_fn": null, "offline_evaluation_duration": 1, "offline_evaluation_parallel_to_training": false, "offline_evaluation_timeout_s": 120.0, "num_cpus_per_offline_eval_runner": 1, "num_gpus_per_offline_eval_runner": 0, "custom_resources_per_offline_eval_runner": {}, "restart_failed_offline_eval_runners": true, "ignore_offline_eval_runner_failures": false, "max_num_offline_eval_runner_restarts": 1000, "offline_eval_runner_restore_timeout_s": 1800.0, "max_requests_in_flight_per_offline_eval_runner": 1, "validate_offline_eval_runners_after_construction": true, "offline_eval_runner_health_probe_timeout_s": 30.0, "offline_eval_rl_module_inference_only": false, "broadcast_offline_eval_runner_states": false, "offline_eval_batch_size_per_runner": 256, "dataset_num_iters_per_eval_runner": 1, "keep_per_episode_custom_metrics": false, "metrics_episode_collection_timeout_s": 60.0, "metrics_num_episodes_for_smoothing": 100, "min_time_s_per_iteration": null, "min_train_timesteps_per_iteration": 0, "min_sample_timesteps_per_iteration": 0, "log_gradients": true, "export_native_model_files": false, "checkpoint_trainable_policies_only": false, "logger_creator": null, "logger_config": null, "log_level": "WARN", "log_sys_usage": true, "fake_sampler": false, "seed": 5, "restart_failed_env_runners": true, "ignore_env_runner_failures": false, "max_num_env_runner_restarts": 1000, "delay_between_env_runner_restarts_s": 60.0, "restart_failed_sub_environments": false, "num_consecutive_env_runner_failures_tolerance": 100, "env_runner_health_probe_timeout_s": 30.0, "env_runner_restore_timeout_s": 1800.0, "_model_config": {}, "_rl_module_spec": "RLModuleSpec(module_class=None, observation_space=None, action_space=None, inference_only=False, learner_only=False, model_config=DefaultModelConfig(fcnet_hiddens=[60, 90], fcnet_activation='tanh', fcnet_kernel_initializer=None, fcnet_kernel_initializer_kwargs=None, fcnet_bias_initializer=None, fcnet_bias_initializer_kwargs=None, conv_filters=None, conv_activation='relu', conv_kernel_initializer=None, conv_kernel_initializer_kwargs=None, conv_bias_initializer=None, conv_bias_initializer_kwargs=None, head_fcnet_hiddens=[], head_fcnet_activation='relu', head_fcnet_kernel_initializer=None, head_fcnet_kernel_initializer_kwargs=None, head_fcnet_bias_initializer=None, head_fcnet_bias_initializer_kwargs=None, free_log_std=False, log_std_clip_param=20.0, vf_share_layers=True, use_lstm=False, max_seq_len=20, lstm_cell_size=256, lstm_use_prev_action=False, lstm_use_prev_reward=False, lstm_kernel_initializer=None, lstm_kernel_initializer_kwargs=None, lstm_bias_initializer=None, lstm_bias_initializer_kwargs=None), catalog_class=None, load_state_path=None, model_config_dict=None)", "algorithm_config_overrides_per_module": {}, "_per_module_overrides": {}, "_validate_config": true, "_use_msgpack_checkpoints": false, "_torch_grad_scaler_class": null, "_torch_lr_scheduler_classes": null, "_tf_policy_handles_more_than_one_loss": false, "_disable_preprocessor_api": false, "_disable_action_flattening": false, "_disable_initialize_loss_from_dummy_batch": false, "_dont_auto_sync_env_runner_states": false, "env_task_fn": -1, "enable_connectors": -1, "simple_optimizer": false, "policy_map_cache": -1, "worker_cls": -1, "synchronize_filters": -1, "enable_async_evaluation": -1, "custom_async_evaluation_function": -1, "_enable_rl_module_api": -1, "auto_wrap_old_gym_envs": -1, "always_attach_evaluation_results": -1, "replay_sequence_length": null, "_disable_execution_plan_api": -1, "use_critic": true, "use_gae": true, "use_kl_loss": true, "kl_coeff": 0.7464963036515, "kl_target": 0.0270990929592, "vf_loss_coeff": 0.6688075857018, "entropy_coeff": 0.0090570820258, "clip_param": 0.1221781641624, "vf_clip_param": 0.1027808522125, "entropy_coeff_schedule": null, "lr_schedule": null, "sgd_minibatch_size": -1, "vf_share_layers": -1, "__stdout_file__": null, "__stderr_file__": null, "lambda": 0.9099046732075, "input": "sampler", "policies": {"default_policy": [null, null, null, null]}, "callbacks": "<class 'ray.rllib.callbacks.callbacks.RLlibCallback'>", "create_env_on_driver": false, "custom_eval_function": null, "framework": "torch"}, "time_since_restore": 32.562114238739014, "iterations_since_restore": 15, "perf": {"cpu_util_percent": 32.5, "ram_util_percent": 79.05}}
{"timers": {"training_iteration": 1.6065216878418969, "restore_env_runners": 7.712675562769393e-06, "training_step": 1.6063838610956938, "env_runner_sampling_timer": 1.4954121403703207, "learner_update_timer": 0.10786049356388469, "synch_weights": 0.0006195149394341472, "restore_eval_env_runners": 9.031580603422764e-06, "evaluation_iteration": 0.10310328319354123, "synch_eval_env_connectors": 0.0001219050526256236, "synch_env_connectors": 4.556623008603125e-06}, "env_runners": {"env_to_module_connector": {"timers": {"connectors": {"numpy_to_tensor": 8.335775500045591e-06, "add_states_from_episodes_to_batch": 1.7142754884605168e-06, "batch_individual_items": 6.201467278014993e-06, "add_observations_from_episodes_to_batch": 2.937339310929664e-06, "add_time_dim_to_batch_and_zero_pad": 2.2864063881762385e-06}}, "connector_pipeline_timer": 4.333842210255239e-05}, "num_agent_steps_sampled_lifetime": {"default_agent": -8635000.0}, "env_to_module_sum_episodes_length_out": 10.36823839457432, "num_episodes": 250.0, "episode_len_max": 20, "num_module_steps_sampled": {"default_policy": 5000.0}, "module_to_env_connector": {"timers": {"connectors": {"un_batch_to_individual_items": 5.2915808030783965e-06, "listify_data_for_vector_env": 1.0681256729582065e-05, "normalize_and_clip_actions": 9.213952562472007e-06, "get_actions": 3.6889173763269194e-05, "tensor_to_numpy": 1.278539572677951e-05, "remove_single_ts_time_rank_from_batch": 5.699923175704545e-07}}, "connector_pipeline_timer": 0.00010119146707320965}, "num_module_steps_sampled_lifetime": {"default_policy": -8635000.0}, "num_episodes_lifetime": -431750.0, "episode_len_min": 20, "episode_return_max": 6.5, "env_to_module_sum_episodes_length_in": 10.36823839457432, "env_step_timer": 1.3569856839604433e-05, "sample": 0.004744295589429354, "rlmodule_inference_timer": 2.656215150439284e-05, "episode_duration_sec_mean": 0.004456917461007835, "episode_return_mean": 4.66, "module_episode_returns_mean": {"default_policy": 4.66}, "env_reset_timer": 3.0048612752044e-05, "num_env_steps_sampled_lifetime": -8635000.0, "num_env_steps_sampled": 5000.0, "episode_return_min": -13.5, "episode_len_mean": 20.0, "weights_seq_no": 15.0, "num_agent_steps_sampled": {"default_agent": 5000.0}, "time_between_sampling": 0.0018014696680178446, "agent_episode_returns_mean": {"default_agent": 4.66}, "num_env_steps_sampled_lifetime_throughput": 3819.694644164594}, "learners": {"default_policy": {"policy_loss": 0.1539374142885208, "vf_loss": 0.10278083384037018, "vf_loss_unclipped": 24.324419021606445, "num_module_steps_trained": 6000, "diff_num_grad_updates_vs_sampler_policy": 1.0, "default_optimizer_learning_rate": 0.0002847858517, "weights_seq_no": 16.0, "total_loss": 0.21866542100906372, "vf_explained_var": -0.018616795539855957, "module_train_batch_size_mean": 1000.0, "num_module_steps_trained_lifetime": 96000, "gradients_default_optimizer_global_norm": 0.11287917196750641, "entropy": 0.4430331587791443, "curr_entropy_coeff": 0.0090570820258, "num_trainable_parameters": 6003, "curr_kl_coeff": 1.1390629879315384e-05, "mean_kl_loss": 0.0002914517535828054, "num_module_steps_trained_lifetime_throughput": 439982.8226552564}, "__all_modules__": {"learner_connector": {"timers": {"connectors": {"batch_individual_items": 0.035489984840267254, "add_observations_from_episodes_to_batch": 0.000786937700577008, "add_columns_from_episodes_to_train_batch": 0.03398131914072659, "general_advantage_estimation": 0.006208616152272276, "add_time_dim_to_batch_and_zero_pad": 9.351333688882318e-06, "numpy_to_tensor": 6.267058944348735e-05, "add_states_from_episodes_to_batch": 3.100763504042078e-06, "add_one_ts_to_episodes_and_truncate": 0.008331032216131096}}, "connector_pipeline_timer": 0.08498037451021144}, "num_trainable_parameters": 6003, "num_env_steps_trained_lifetime": 504000, "num_module_steps_trained": 6000, "num_non_trainable_parameters": 0, "num_env_steps_trained": 31500, "num_module_steps_trained_lifetime": 96000, "learner_connector_sum_episodes_length_in": 5000.0, "learner_connector_sum_episodes_length_out": 5250.0, "num_env_steps_trained_lifetime_throughput": 2301128.293336887, "num_module_steps_trained_throughput": 439640.8766502151, "num_module_steps_trained_lifetime_throughput": 439056.7900933618}}, "num_training_step_calls_per_iteration": 1, "evaluation": {"env_runners": {"module_to_env_connector": {"connector_pipeline_timer": 9.615929616339741e-05, "timers": {"connectors": {"listify_data_for_vector_env": 1.061088487687041e-05, "get_actions": 3.3824386555413696e-05, "remove_single_ts_time_rank_from_batch": 5.473784021089813e-07, "tensor_to_numpy": 1.2216260533399177e-05, "un_batch_to_individual_items": 5.220091121369323e-06, "normalize_and_clip_actions": 9.057692925237493e-06}}}, "num_episodes_lifetime": 320, "num_module_steps_sampled": {"default_policy": 400}, "env_to_module_sum_episodes_length_in": 10.368238394574323, "env_to_module_connector": {"timers": {"connectors": {"numpy_to_tensor": 8.077349472308467e-06, "add_states_from_episodes_to_batch": 1.5173517282893194e-06, "add_time_dim_to_batch_and_zero_pad": 2.116982775968507e-06, "batch_individual_items": 5.960800060294905e-06, "add_observations_from_episodes_to_batch": 2.7429662281538078e-06}}, "connector_pipeline_timer": 4.139931171602413e-05}, "module_episode_returns_mean": {"default_policy": 2.3}, "agent_episode_returns_mean": {"default_agent": 2.3}, "env_to_module_sum_episodes_length_out": 10.368238394574323, "episode_len_max": 20, "num_agent_steps_sampled": {"default_agent": 400}, "num_module_steps_sampled_lifetime": {"default_policy": 6400}, "episode_return_max": 12.5, "sample": 0.09682145534168769, "rlmodule_inference_timer": 2.5705136270584605e-05, "env_reset_timer": 0.0002149647387144631, "episode_len_mean": 20.0, "weights_seq_no": 16.0, "episode_len_min": 20, "episode_duration_sec_mean": 0.0047109261865261945, "episode_return_mean": 2.3, "num_env_steps_sampled": 400, "episode_return_min": -15.5, "num_agent_steps_sampled_lifetime": {"default_agent": 6400}, "num_episodes": 20, "env_step_timer": 1.3533974881992032e-05, "num_env_steps_sampled_lifetime": 80400, "time_between_sampling": 1.6649381036932476}, "num_healthy_workers": 1, "actor_manager_num_outstanding_async_reqs": 0, "num_remote_worker_restarts": 0}, "num_env_steps_sampled_lifetime": -8635000.0, "fault_tolerance": {"num_healthy_workers": 0, "num_remote_worker_restarts": 0}, "env_runner_group": {"actor_manager_num_outstanding_async_reqs": 0}, "done": false, "training_iteration": 16, "trial_id": "4649a_00000", "date": "2025-08-11_19-36-44", "timestamp": 1754933804, "time_this_iter_s": 1.5438416004180908, "time_total_s": 34.105955839157104, "pid": 28167, "hostname": "Mac", "node_ip": "127.0.0.1", "config": {"exploration_config": {}, "extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "placement_strategy": "PACK", "num_gpus": 0, "_fake_gpus": false, "num_cpus_for_main_process": 2, "eager_tracing": true, "eager_max_retraces": 20, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "torch_compile_learner": false, "torch_compile_learner_what_to_compile": "forward_train", "torch_compile_learner_dynamo_backend": "aot_eager", "torch_compile_learner_dynamo_mode": null, "torch_compile_worker": false, "torch_compile_worker_dynamo_backend": "aot_eager", "torch_compile_worker_dynamo_mode": null, "torch_ddp_kwargs": {}, "torch_skip_nan_gradients": false, "env": "Umbrella", "env_config": {}, "observation_space": null, "action_space": null, "clip_rewards": null, "normalize_actions": true, "clip_actions": false, "_is_atari": null, "disable_env_checking": false, "render_env": false, "action_mask_key": "action_mask", "env_runner_cls": null, "num_env_runners": 0, "create_local_env_runner": true, "num_envs_per_env_runner": 1, "gym_env_vectorize_mode": "SYNC", "num_cpus_per_env_runner": 1, "num_gpus_per_env_runner": 0, "custom_resources_per_env_runner": {}, "validate_env_runners_after_construction": true, "episodes_to_numpy": true, "max_requests_in_flight_per_env_runner": 1, "sample_timeout_s": 60.0, "_env_to_module_connector": null, "add_default_connectors_to_env_to_module_pipeline": true, "_module_to_env_connector": null, "add_default_connectors_to_module_to_env_pipeline": true, "merge_env_runner_states": "training_only", "broadcast_env_runner_states": true, "episode_lookback_horizon": 1, "rollout_fragment_length": "auto", "batch_mode": "complete_episodes", "compress_observations": false, "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "enable_tf1_exec_eagerly": false, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "preprocessor_pref": "deepmind", "observation_filter": "NoFilter", "update_worker_filter_stats": true, "use_worker_filter_stats": true, "sampler_perf_stats_ema_coef": null, "_is_online": true, "num_learners": 0, "num_gpus_per_learner": 0, "num_cpus_per_learner": "auto", "num_aggregator_actors_per_learner": 0, "max_requests_in_flight_per_aggregator_actor": 3, "local_gpu_idx": 0, "max_requests_in_flight_per_learner": 3, "gamma": 1, "lr": 0.0002847858517, "grad_clip": 0.5, "grad_clip_by": "global_norm", "_train_batch_size_per_learner": 5000, "train_batch_size": 4000, "num_epochs": 1, "minibatch_size": 1000, "shuffle_batch_per_epoch": true, "model": {"fcnet_hiddens": [256, 256], "fcnet_activation": "tanh", "fcnet_weights_initializer": null, "fcnet_weights_initializer_config": null, "fcnet_bias_initializer": null, "fcnet_bias_initializer_config": null, "conv_filters": null, "conv_activation": "relu", "conv_kernel_initializer": null, "conv_kernel_initializer_config": null, "conv_bias_initializer": null, "conv_bias_initializer_config": null, "conv_transpose_kernel_initializer": null, "conv_transpose_kernel_initializer_config": null, "conv_transpose_bias_initializer": null, "conv_transpose_bias_initializer_config": null, "post_fcnet_hiddens": [], "post_fcnet_activation": "relu", "post_fcnet_weights_initializer": null, "post_fcnet_weights_initializer_config": null, "post_fcnet_bias_initializer": null, "post_fcnet_bias_initializer_config": null, "free_log_std": false, "log_std_clip_param": 20.0, "no_final_linear": false, "vf_share_layers": false, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "lstm_weights_initializer": null, "lstm_weights_initializer_config": null, "lstm_bias_initializer": null, "lstm_bias_initializer_config": null, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "attention_use_n_prev_actions": 0, "attention_use_n_prev_rewards": 0, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": null, "custom_model_config": {}, "custom_action_dist": null, "custom_preprocessor": null, "encoder_latent_dim": null, "always_check_shapes": false, "lstm_use_prev_action_reward": -1, "_use_default_native_models": -1, "_disable_preprocessor_api": false, "_disable_action_flattening": false}, "_learner_connector": null, "add_default_connectors_to_learner_pipeline": true, "learner_config_dict": {}, "optimizer": {}, "_learner_class": null, "callbacks_on_algorithm_init": null, "callbacks_on_env_runners_recreated": null, "callbacks_on_offline_eval_runners_recreated": null, "callbacks_on_checkpoint_loaded": null, "callbacks_on_environment_created": null, "callbacks_on_episode_created": null, "callbacks_on_episode_start": null, "callbacks_on_episode_step": null, "callbacks_on_episode_end": null, "callbacks_on_evaluate_start": null, "callbacks_on_evaluate_end": null, "callbacks_on_evaluate_offline_start": null, "callbacks_on_evaluate_offline_end": null, "callbacks_on_sample_end": null, "callbacks_on_train_result": null, "explore": true, "enable_rl_module_and_learner": true, "enable_env_runner_and_connector_v2": true, "_prior_exploration_config": {"type": "StochasticSampling"}, "count_steps_by": "env_steps", "policy_map_capacity": 100, "policy_mapping_fn": "<function AlgorithmConfig.DEFAULT_POLICY_MAPPING_FN at 0x17c065b20>", "policies_to_train": null, "policy_states_are_swappable": false, "observation_fn": null, "offline_data_class": null, "input_read_method": "read_parquet", "input_read_method_kwargs": {}, "input_read_schema": {}, "input_read_episodes": false, "input_read_sample_batches": false, "input_read_batch_size": null, "input_filesystem": null, "input_filesystem_kwargs": {}, "input_compress_columns": ["obs", "new_obs"], "input_spaces_jsonable": true, "materialize_data": false, "materialize_mapped_data": true, "map_batches_kwargs": {}, "iter_batches_kwargs": {}, "ignore_final_observation": false, "prelearner_class": null, "prelearner_buffer_class": null, "prelearner_buffer_kwargs": {}, "prelearner_module_synch_period": 10, "dataset_num_iters_per_learner": null, "input_config": {}, "actions_in_input_normalized": false, "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_config": {}, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "output_max_rows_per_file": null, "output_write_remaining_data": false, "output_write_method": "write_parquet", "output_write_method_kwargs": {}, "output_filesystem": null, "output_filesystem_kwargs": {}, "output_write_episodes": true, "offline_sampling": false, "evaluation_interval": 1, "evaluation_duration": 20, "evaluation_duration_unit": "episodes", "evaluation_sample_timeout_s": 120.0, "evaluation_auto_duration_min_env_steps_per_sample": 100, "evaluation_auto_duration_max_env_steps_per_sample": 2000, "evaluation_parallel_to_training": false, "evaluation_force_reset_envs_before_iteration": true, "evaluation_config": null, "off_policy_estimation_methods": {}, "ope_split_batch_by_episode": true, "evaluation_num_env_runners": 1, "in_evaluation": false, "sync_filters_on_rollout_workers_timeout_s": 10.0, "offline_evaluation_interval": null, "num_offline_eval_runners": 0, "offline_loss_for_module_fn": null, "offline_evaluation_duration": 1, "offline_evaluation_parallel_to_training": false, "offline_evaluation_timeout_s": 120.0, "num_cpus_per_offline_eval_runner": 1, "num_gpus_per_offline_eval_runner": 0, "custom_resources_per_offline_eval_runner": {}, "restart_failed_offline_eval_runners": true, "ignore_offline_eval_runner_failures": false, "max_num_offline_eval_runner_restarts": 1000, "offline_eval_runner_restore_timeout_s": 1800.0, "max_requests_in_flight_per_offline_eval_runner": 1, "validate_offline_eval_runners_after_construction": true, "offline_eval_runner_health_probe_timeout_s": 30.0, "offline_eval_rl_module_inference_only": false, "broadcast_offline_eval_runner_states": false, "offline_eval_batch_size_per_runner": 256, "dataset_num_iters_per_eval_runner": 1, "keep_per_episode_custom_metrics": false, "metrics_episode_collection_timeout_s": 60.0, "metrics_num_episodes_for_smoothing": 100, "min_time_s_per_iteration": null, "min_train_timesteps_per_iteration": 0, "min_sample_timesteps_per_iteration": 0, "log_gradients": true, "export_native_model_files": false, "checkpoint_trainable_policies_only": false, "logger_creator": null, "logger_config": null, "log_level": "WARN", "log_sys_usage": true, "fake_sampler": false, "seed": 5, "restart_failed_env_runners": true, "ignore_env_runner_failures": false, "max_num_env_runner_restarts": 1000, "delay_between_env_runner_restarts_s": 60.0, "restart_failed_sub_environments": false, "num_consecutive_env_runner_failures_tolerance": 100, "env_runner_health_probe_timeout_s": 30.0, "env_runner_restore_timeout_s": 1800.0, "_model_config": {}, "_rl_module_spec": "RLModuleSpec(module_class=None, observation_space=None, action_space=None, inference_only=False, learner_only=False, model_config=DefaultModelConfig(fcnet_hiddens=[60, 90], fcnet_activation='tanh', fcnet_kernel_initializer=None, fcnet_kernel_initializer_kwargs=None, fcnet_bias_initializer=None, fcnet_bias_initializer_kwargs=None, conv_filters=None, conv_activation='relu', conv_kernel_initializer=None, conv_kernel_initializer_kwargs=None, conv_bias_initializer=None, conv_bias_initializer_kwargs=None, head_fcnet_hiddens=[], head_fcnet_activation='relu', head_fcnet_kernel_initializer=None, head_fcnet_kernel_initializer_kwargs=None, head_fcnet_bias_initializer=None, head_fcnet_bias_initializer_kwargs=None, free_log_std=False, log_std_clip_param=20.0, vf_share_layers=True, use_lstm=False, max_seq_len=20, lstm_cell_size=256, lstm_use_prev_action=False, lstm_use_prev_reward=False, lstm_kernel_initializer=None, lstm_kernel_initializer_kwargs=None, lstm_bias_initializer=None, lstm_bias_initializer_kwargs=None), catalog_class=None, load_state_path=None, model_config_dict=None)", "algorithm_config_overrides_per_module": {}, "_per_module_overrides": {}, "_validate_config": true, "_use_msgpack_checkpoints": false, "_torch_grad_scaler_class": null, "_torch_lr_scheduler_classes": null, "_tf_policy_handles_more_than_one_loss": false, "_disable_preprocessor_api": false, "_disable_action_flattening": false, "_disable_initialize_loss_from_dummy_batch": false, "_dont_auto_sync_env_runner_states": false, "env_task_fn": -1, "enable_connectors": -1, "simple_optimizer": false, "policy_map_cache": -1, "worker_cls": -1, "synchronize_filters": -1, "enable_async_evaluation": -1, "custom_async_evaluation_function": -1, "_enable_rl_module_api": -1, "auto_wrap_old_gym_envs": -1, "always_attach_evaluation_results": -1, "replay_sequence_length": null, "_disable_execution_plan_api": -1, "use_critic": true, "use_gae": true, "use_kl_loss": true, "kl_coeff": 0.7464963036515, "kl_target": 0.0270990929592, "vf_loss_coeff": 0.6688075857018, "entropy_coeff": 0.0090570820258, "clip_param": 0.1221781641624, "vf_clip_param": 0.1027808522125, "entropy_coeff_schedule": null, "lr_schedule": null, "sgd_minibatch_size": -1, "vf_share_layers": -1, "__stdout_file__": null, "__stderr_file__": null, "lambda": 0.9099046732075, "input": "sampler", "policies": {"default_policy": [null, null, null, null]}, "callbacks": "<class 'ray.rllib.callbacks.callbacks.RLlibCallback'>", "create_env_on_driver": false, "custom_eval_function": null, "framework": "torch"}, "time_since_restore": 34.105955839157104, "iterations_since_restore": 16, "perf": {"cpu_util_percent": 47.75, "ram_util_percent": 78.85}}
{"timers": {"training_iteration": 1.6062190047126987, "restore_env_runners": 7.692638880965628e-06, "training_step": 1.606080919985177, "env_runner_sampling_timer": 1.495288294386717, "learner_update_timer": 0.10768053612751659, "synch_weights": 0.0006194010400703531, "restore_eval_env_runners": 9.000014953701717e-06, "evaluation_iteration": 0.10305865786090054, "synch_eval_env_connectors": 0.00012164850186132132, "synch_env_connectors": 4.550636823785033e-06}, "env_runners": {"env_to_module_connector": {"timers": {"connectors": {"numpy_to_tensor": 8.705765679585492e-06, "add_states_from_episodes_to_batch": 1.767202074458895e-06, "batch_individual_items": 6.509626263107357e-06, "add_observations_from_episodes_to_batch": 3.08196527167065e-06, "add_time_dim_to_batch_and_zero_pad": 2.3798046072512375e-06}}, "connector_pipeline_timer": 4.485664624553903e-05}, "num_agent_steps_sampled_lifetime": {"default_agent": -9252500.0}, "env_to_module_sum_episodes_length_out": 10.36823839457432, "num_episodes": 250.0, "episode_len_max": 20, "num_module_steps_sampled": {"default_policy": 5000.0}, "module_to_env_connector": {"timers": {"connectors": {"un_batch_to_individual_items": 5.456239728001637e-06, "listify_data_for_vector_env": 1.1040873396842894e-05, "normalize_and_clip_actions": 9.514952974765346e-06, "get_actions": 3.878019856993159e-05, "tensor_to_numpy": 1.3215660646796696e-05, "remove_single_ts_time_rank_from_batch": 5.898705322127469e-07}}, "connector_pipeline_timer": 0.00010500364650959321}, "num_module_steps_sampled_lifetime": {"default_policy": -9252500.0}, "num_episodes_lifetime": -462625.0, "episode_len_min": 20, "episode_return_max": 6.5, "env_to_module_sum_episodes_length_in": 10.36823839457432, "env_step_timer": 1.420826265798061e-05, "sample": 0.00504822446675295, "rlmodule_inference_timer": 4.3180916353419824e-05, "episode_duration_sec_mean": 0.004969868530053645, "episode_return_mean": 4.18, "module_episode_returns_mean": {"default_policy": 4.18}, "env_reset_timer": 3.1674342270476666e-05, "num_env_steps_sampled_lifetime": -9252500.0, "num_env_steps_sampled": 5000.0, "episode_return_min": -13.5, "episode_len_mean": 20.0, "weights_seq_no": 16.0, "num_agent_steps_sampled": {"default_agent": 5000.0}, "time_between_sampling": 0.0014862201856220498, "agent_episode_returns_mean": {"default_agent": 4.18}, "num_env_steps_sampled_lifetime_throughput": 3719.521401671228}, "learners": {"default_policy": {"policy_loss": 0.05162852257490158, "vf_loss": 0.10278083384037018, "vf_loss_unclipped": 23.931560516357422, "num_module_steps_trained": 6000, "diff_num_grad_updates_vs_sampler_policy": 1.0, "default_optimizer_learning_rate": 0.0002847858517, "weights_seq_no": 17.0, "total_loss": 0.11662331223487854, "vf_explained_var": -0.019191503524780273, "module_train_batch_size_mean": 1000.0, "num_module_steps_trained_lifetime": 102000, "gradients_default_optimizer_global_norm": 0.03710363060235977, "entropy": 0.4135804772377014, "curr_entropy_coeff": 0.0090570820258, "num_trainable_parameters": 6003, "curr_kl_coeff": 5.695314939657692e-06, "mean_kl_loss": 0.0007178370142355561, "num_module_steps_trained_lifetime_throughput": 440009.59006646625}, "__all_modules__": {"learner_connector": {"timers": {"connectors": {"batch_individual_items": 0.035431314991377014, "add_observations_from_episodes_to_batch": 0.0007897616645991831, "add_columns_from_episodes_to_train_batch": 0.03398123219970519, "general_advantage_estimation": 0.006197417489986986, "add_time_dim_to_batch_and_zero_pad": 9.366570889031344e-06, "numpy_to_tensor": 6.256763375364543e-05, "add_states_from_episodes_to_batch": 3.097675755635411e-06, "add_one_ts_to_episodes_and_truncate": 0.008323980644602191}}, "connector_pipeline_timer": 0.08490590701460797}, "num_trainable_parameters": 6003, "num_env_steps_trained_lifetime": 535500, "num_module_steps_trained": 6000, "num_non_trainable_parameters": 0, "num_env_steps_trained": 31500, "num_module_steps_trained_lifetime": 102000, "learner_connector_sum_episodes_length_in": 5000.0, "learner_connector_sum_episodes_length_out": 5250.0, "num_env_steps_trained_lifetime_throughput": 2301848.973226579, "num_module_steps_trained_throughput": 439723.2103331628, "num_module_steps_trained_lifetime_throughput": 439159.32153952826}}, "num_training_step_calls_per_iteration": 1, "evaluation": {"env_runners": {"module_to_env_connector": {"connector_pipeline_timer": 9.75168458940348e-05, "timers": {"connectors": {"listify_data_for_vector_env": 1.1002643867904803e-05, "get_actions": 3.4248462234477306e-05, "remove_single_ts_time_rank_from_batch": 6.013851020381613e-07, "tensor_to_numpy": 1.2371960282022322e-05, "un_batch_to_individual_items": 5.244759775932195e-06, "normalize_and_clip_actions": 9.158182775279874e-06}}}, "num_episodes_lifetime": 340, "num_module_steps_sampled": {"default_policy": 400}, "env_to_module_sum_episodes_length_in": 10.368238394574323, "env_to_module_connector": {"timers": {"connectors": {"numpy_to_tensor": 8.211724169251888e-06, "add_states_from_episodes_to_batch": 1.5264654894971526e-06, "add_time_dim_to_batch_and_zero_pad": 2.1265097882195304e-06, "batch_individual_items": 5.9804358153407024e-06, "add_observations_from_episodes_to_batch": 2.793629476678032e-06}}, "connector_pipeline_timer": 4.1590491895454687e-05}, "module_episode_returns_mean": {"default_policy": 2.5}, "agent_episode_returns_mean": {"default_agent": 2.5}, "env_to_module_sum_episodes_length_out": 10.368238394574323, "episode_len_max": 20, "num_agent_steps_sampled": {"default_agent": 400}, "num_module_steps_sampled_lifetime": {"default_policy": 6800}, "episode_return_max": 12.5, "sample": 0.0968009378682441, "rlmodule_inference_timer": 2.6069247204561533e-05, "env_reset_timer": 0.00021353843094457081, "episode_len_mean": 20.0, "weights_seq_no": 17.0, "episode_len_min": 20, "episode_duration_sec_mean": 0.004552935390966013, "episode_return_mean": 2.5, "num_env_steps_sampled": 400, "episode_return_min": -15.5, "num_agent_steps_sampled_lifetime": {"default_agent": 6800}, "num_episodes": 20, "env_step_timer": 1.3719717955167896e-05, "num_env_steps_sampled_lifetime": 85400, "time_between_sampling": 1.664219366406204}, "num_healthy_workers": 1, "actor_manager_num_outstanding_async_reqs": 0, "num_remote_worker_restarts": 0}, "num_env_steps_sampled_lifetime": -9252500.0, "fault_tolerance": {"num_healthy_workers": 0, "num_remote_worker_restarts": 0}, "env_runner_group": {"actor_manager_num_outstanding_async_reqs": 0}, "done": false, "training_iteration": 17, "trial_id": "4649a_00000", "date": "2025-08-11_19-36-46", "timestamp": 1754933806, "time_this_iter_s": 1.6780359745025635, "time_total_s": 35.78399181365967, "pid": 28167, "hostname": "Mac", "node_ip": "127.0.0.1", "config": {"exploration_config": {}, "extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "placement_strategy": "PACK", "num_gpus": 0, "_fake_gpus": false, "num_cpus_for_main_process": 2, "eager_tracing": true, "eager_max_retraces": 20, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "torch_compile_learner": false, "torch_compile_learner_what_to_compile": "forward_train", "torch_compile_learner_dynamo_backend": "aot_eager", "torch_compile_learner_dynamo_mode": null, "torch_compile_worker": false, "torch_compile_worker_dynamo_backend": "aot_eager", "torch_compile_worker_dynamo_mode": null, "torch_ddp_kwargs": {}, "torch_skip_nan_gradients": false, "env": "Umbrella", "env_config": {}, "observation_space": null, "action_space": null, "clip_rewards": null, "normalize_actions": true, "clip_actions": false, "_is_atari": null, "disable_env_checking": false, "render_env": false, "action_mask_key": "action_mask", "env_runner_cls": null, "num_env_runners": 0, "create_local_env_runner": true, "num_envs_per_env_runner": 1, "gym_env_vectorize_mode": "SYNC", "num_cpus_per_env_runner": 1, "num_gpus_per_env_runner": 0, "custom_resources_per_env_runner": {}, "validate_env_runners_after_construction": true, "episodes_to_numpy": true, "max_requests_in_flight_per_env_runner": 1, "sample_timeout_s": 60.0, "_env_to_module_connector": null, "add_default_connectors_to_env_to_module_pipeline": true, "_module_to_env_connector": null, "add_default_connectors_to_module_to_env_pipeline": true, "merge_env_runner_states": "training_only", "broadcast_env_runner_states": true, "episode_lookback_horizon": 1, "rollout_fragment_length": "auto", "batch_mode": "complete_episodes", "compress_observations": false, "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "enable_tf1_exec_eagerly": false, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "preprocessor_pref": "deepmind", "observation_filter": "NoFilter", "update_worker_filter_stats": true, "use_worker_filter_stats": true, "sampler_perf_stats_ema_coef": null, "_is_online": true, "num_learners": 0, "num_gpus_per_learner": 0, "num_cpus_per_learner": "auto", "num_aggregator_actors_per_learner": 0, "max_requests_in_flight_per_aggregator_actor": 3, "local_gpu_idx": 0, "max_requests_in_flight_per_learner": 3, "gamma": 1, "lr": 0.0002847858517, "grad_clip": 0.5, "grad_clip_by": "global_norm", "_train_batch_size_per_learner": 5000, "train_batch_size": 4000, "num_epochs": 1, "minibatch_size": 1000, "shuffle_batch_per_epoch": true, "model": {"fcnet_hiddens": [256, 256], "fcnet_activation": "tanh", "fcnet_weights_initializer": null, "fcnet_weights_initializer_config": null, "fcnet_bias_initializer": null, "fcnet_bias_initializer_config": null, "conv_filters": null, "conv_activation": "relu", "conv_kernel_initializer": null, "conv_kernel_initializer_config": null, "conv_bias_initializer": null, "conv_bias_initializer_config": null, "conv_transpose_kernel_initializer": null, "conv_transpose_kernel_initializer_config": null, "conv_transpose_bias_initializer": null, "conv_transpose_bias_initializer_config": null, "post_fcnet_hiddens": [], "post_fcnet_activation": "relu", "post_fcnet_weights_initializer": null, "post_fcnet_weights_initializer_config": null, "post_fcnet_bias_initializer": null, "post_fcnet_bias_initializer_config": null, "free_log_std": false, "log_std_clip_param": 20.0, "no_final_linear": false, "vf_share_layers": false, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "lstm_weights_initializer": null, "lstm_weights_initializer_config": null, "lstm_bias_initializer": null, "lstm_bias_initializer_config": null, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "attention_use_n_prev_actions": 0, "attention_use_n_prev_rewards": 0, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": null, "custom_model_config": {}, "custom_action_dist": null, "custom_preprocessor": null, "encoder_latent_dim": null, "always_check_shapes": false, "lstm_use_prev_action_reward": -1, "_use_default_native_models": -1, "_disable_preprocessor_api": false, "_disable_action_flattening": false}, "_learner_connector": null, "add_default_connectors_to_learner_pipeline": true, "learner_config_dict": {}, "optimizer": {}, "_learner_class": null, "callbacks_on_algorithm_init": null, "callbacks_on_env_runners_recreated": null, "callbacks_on_offline_eval_runners_recreated": null, "callbacks_on_checkpoint_loaded": null, "callbacks_on_environment_created": null, "callbacks_on_episode_created": null, "callbacks_on_episode_start": null, "callbacks_on_episode_step": null, "callbacks_on_episode_end": null, "callbacks_on_evaluate_start": null, "callbacks_on_evaluate_end": null, "callbacks_on_evaluate_offline_start": null, "callbacks_on_evaluate_offline_end": null, "callbacks_on_sample_end": null, "callbacks_on_train_result": null, "explore": true, "enable_rl_module_and_learner": true, "enable_env_runner_and_connector_v2": true, "_prior_exploration_config": {"type": "StochasticSampling"}, "count_steps_by": "env_steps", "policy_map_capacity": 100, "policy_mapping_fn": "<function AlgorithmConfig.DEFAULT_POLICY_MAPPING_FN at 0x17c065b20>", "policies_to_train": null, "policy_states_are_swappable": false, "observation_fn": null, "offline_data_class": null, "input_read_method": "read_parquet", "input_read_method_kwargs": {}, "input_read_schema": {}, "input_read_episodes": false, "input_read_sample_batches": false, "input_read_batch_size": null, "input_filesystem": null, "input_filesystem_kwargs": {}, "input_compress_columns": ["obs", "new_obs"], "input_spaces_jsonable": true, "materialize_data": false, "materialize_mapped_data": true, "map_batches_kwargs": {}, "iter_batches_kwargs": {}, "ignore_final_observation": false, "prelearner_class": null, "prelearner_buffer_class": null, "prelearner_buffer_kwargs": {}, "prelearner_module_synch_period": 10, "dataset_num_iters_per_learner": null, "input_config": {}, "actions_in_input_normalized": false, "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_config": {}, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "output_max_rows_per_file": null, "output_write_remaining_data": false, "output_write_method": "write_parquet", "output_write_method_kwargs": {}, "output_filesystem": null, "output_filesystem_kwargs": {}, "output_write_episodes": true, "offline_sampling": false, "evaluation_interval": 1, "evaluation_duration": 20, "evaluation_duration_unit": "episodes", "evaluation_sample_timeout_s": 120.0, "evaluation_auto_duration_min_env_steps_per_sample": 100, "evaluation_auto_duration_max_env_steps_per_sample": 2000, "evaluation_parallel_to_training": false, "evaluation_force_reset_envs_before_iteration": true, "evaluation_config": null, "off_policy_estimation_methods": {}, "ope_split_batch_by_episode": true, "evaluation_num_env_runners": 1, "in_evaluation": false, "sync_filters_on_rollout_workers_timeout_s": 10.0, "offline_evaluation_interval": null, "num_offline_eval_runners": 0, "offline_loss_for_module_fn": null, "offline_evaluation_duration": 1, "offline_evaluation_parallel_to_training": false, "offline_evaluation_timeout_s": 120.0, "num_cpus_per_offline_eval_runner": 1, "num_gpus_per_offline_eval_runner": 0, "custom_resources_per_offline_eval_runner": {}, "restart_failed_offline_eval_runners": true, "ignore_offline_eval_runner_failures": false, "max_num_offline_eval_runner_restarts": 1000, "offline_eval_runner_restore_timeout_s": 1800.0, "max_requests_in_flight_per_offline_eval_runner": 1, "validate_offline_eval_runners_after_construction": true, "offline_eval_runner_health_probe_timeout_s": 30.0, "offline_eval_rl_module_inference_only": false, "broadcast_offline_eval_runner_states": false, "offline_eval_batch_size_per_runner": 256, "dataset_num_iters_per_eval_runner": 1, "keep_per_episode_custom_metrics": false, "metrics_episode_collection_timeout_s": 60.0, "metrics_num_episodes_for_smoothing": 100, "min_time_s_per_iteration": null, "min_train_timesteps_per_iteration": 0, "min_sample_timesteps_per_iteration": 0, "log_gradients": true, "export_native_model_files": false, "checkpoint_trainable_policies_only": false, "logger_creator": null, "logger_config": null, "log_level": "WARN", "log_sys_usage": true, "fake_sampler": false, "seed": 5, "restart_failed_env_runners": true, "ignore_env_runner_failures": false, "max_num_env_runner_restarts": 1000, "delay_between_env_runner_restarts_s": 60.0, "restart_failed_sub_environments": false, "num_consecutive_env_runner_failures_tolerance": 100, "env_runner_health_probe_timeout_s": 30.0, "env_runner_restore_timeout_s": 1800.0, "_model_config": {}, "_rl_module_spec": "RLModuleSpec(module_class=None, observation_space=None, action_space=None, inference_only=False, learner_only=False, model_config=DefaultModelConfig(fcnet_hiddens=[60, 90], fcnet_activation='tanh', fcnet_kernel_initializer=None, fcnet_kernel_initializer_kwargs=None, fcnet_bias_initializer=None, fcnet_bias_initializer_kwargs=None, conv_filters=None, conv_activation='relu', conv_kernel_initializer=None, conv_kernel_initializer_kwargs=None, conv_bias_initializer=None, conv_bias_initializer_kwargs=None, head_fcnet_hiddens=[], head_fcnet_activation='relu', head_fcnet_kernel_initializer=None, head_fcnet_kernel_initializer_kwargs=None, head_fcnet_bias_initializer=None, head_fcnet_bias_initializer_kwargs=None, free_log_std=False, log_std_clip_param=20.0, vf_share_layers=True, use_lstm=False, max_seq_len=20, lstm_cell_size=256, lstm_use_prev_action=False, lstm_use_prev_reward=False, lstm_kernel_initializer=None, lstm_kernel_initializer_kwargs=None, lstm_bias_initializer=None, lstm_bias_initializer_kwargs=None), catalog_class=None, load_state_path=None, model_config_dict=None)", "algorithm_config_overrides_per_module": {}, "_per_module_overrides": {}, "_validate_config": true, "_use_msgpack_checkpoints": false, "_torch_grad_scaler_class": null, "_torch_lr_scheduler_classes": null, "_tf_policy_handles_more_than_one_loss": false, "_disable_preprocessor_api": false, "_disable_action_flattening": false, "_disable_initialize_loss_from_dummy_batch": false, "_dont_auto_sync_env_runner_states": false, "env_task_fn": -1, "enable_connectors": -1, "simple_optimizer": false, "policy_map_cache": -1, "worker_cls": -1, "synchronize_filters": -1, "enable_async_evaluation": -1, "custom_async_evaluation_function": -1, "_enable_rl_module_api": -1, "auto_wrap_old_gym_envs": -1, "always_attach_evaluation_results": -1, "replay_sequence_length": null, "_disable_execution_plan_api": -1, "use_critic": true, "use_gae": true, "use_kl_loss": true, "kl_coeff": 0.7464963036515, "kl_target": 0.0270990929592, "vf_loss_coeff": 0.6688075857018, "entropy_coeff": 0.0090570820258, "clip_param": 0.1221781641624, "vf_clip_param": 0.1027808522125, "entropy_coeff_schedule": null, "lr_schedule": null, "sgd_minibatch_size": -1, "vf_share_layers": -1, "__stdout_file__": null, "__stderr_file__": null, "lambda": 0.9099046732075, "input": "sampler", "policies": {"default_policy": [null, null, null, null]}, "callbacks": "<class 'ray.rllib.callbacks.callbacks.RLlibCallback'>", "create_env_on_driver": false, "custom_eval_function": null, "framework": "torch"}, "time_since_restore": 35.78399181365967, "iterations_since_restore": 17, "perf": {"cpu_util_percent": 48.166666666666664, "ram_util_percent": 78.46666666666665}}
{"timers": {"training_iteration": 1.6061614104954443, "restore_env_runners": 7.666962009283843e-06, "training_step": 1.606022955785801, "env_runner_sampling_timer": 1.4944483643520492, "learner_update_timer": 0.10846183284595515, "synch_weights": 0.0006192107796921503, "restore_eval_env_runners": 8.98126447358244e-06, "evaluation_iteration": 0.1030228254528248, "synch_eval_env_connectors": 0.0001213445173880906, "synch_env_connectors": 4.54679084261617e-06}, "env_runners": {"env_to_module_connector": {"timers": {"connectors": {"numpy_to_tensor": 8.732311546302965e-06, "add_states_from_episodes_to_batch": 1.7364872812411788e-06, "batch_individual_items": 6.408186327268813e-06, "add_observations_from_episodes_to_batch": 2.99522878194672e-06, "add_time_dim_to_batch_and_zero_pad": 2.3531716168839824e-06}}, "connector_pipeline_timer": 4.4530008681631344e-05}, "num_agent_steps_sampled_lifetime": {"default_agent": -9870000.0}, "env_to_module_sum_episodes_length_out": 10.36823839457432, "num_episodes": 250.0, "episode_len_max": 20, "num_module_steps_sampled": {"default_policy": 5000.0}, "module_to_env_connector": {"timers": {"connectors": {"un_batch_to_individual_items": 5.454151199421999e-06, "listify_data_for_vector_env": 1.1043897975714257e-05, "normalize_and_clip_actions": 9.621086744169839e-06, "get_actions": 3.962821579806643e-05, "tensor_to_numpy": 1.4128597443514302e-05, "remove_single_ts_time_rank_from_batch": 5.867619016796062e-07}}, "connector_pipeline_timer": 0.00010687011576086316}, "num_module_steps_sampled_lifetime": {"default_policy": -9870000.0}, "num_episodes_lifetime": -493500.0, "episode_len_min": 20, "episode_return_max": 6.5, "env_to_module_sum_episodes_length_in": 10.36823839457432, "env_step_timer": 1.4409693658934632e-05, "sample": 0.005185596747572215, "rlmodule_inference_timer": 2.8137238921504595e-05, "episode_duration_sec_mean": 0.004664682001341134, "episode_return_mean": 3.5400000000000005, "module_episode_returns_mean": {"default_policy": 3.5400000000000005}, "env_reset_timer": 3.7034419593363884e-05, "num_env_steps_sampled_lifetime": -9870000.0, "num_env_steps_sampled": 5000.0, "episode_return_min": -13.5, "episode_len_mean": 20.0, "weights_seq_no": 17.0, "num_agent_steps_sampled": {"default_agent": 5000.0}, "time_between_sampling": 0.0014758042308555999, "agent_episode_returns_mean": {"default_agent": 3.5400000000000005}, "num_env_steps_sampled_lifetime_throughput": 3674.8863000760853}, "learners": {"default_policy": {"policy_loss": 0.20676639676094055, "vf_loss": 0.10278083384037018, "vf_loss_unclipped": 25.955707550048828, "num_module_steps_trained": 6000, "diff_num_grad_updates_vs_sampler_policy": 1.0, "default_optimizer_learning_rate": 0.0002847858517, "weights_seq_no": 18.0, "total_loss": 0.271775484085083, "vf_explained_var": -0.01664602756500244, "module_train_batch_size_mean": 1000.0, "num_module_steps_trained_lifetime": 108000, "gradients_default_optimizer_global_norm": 0.08192838728427887, "entropy": 0.41199925541877747, "curr_entropy_coeff": 0.0090570820258, "num_trainable_parameters": 6003, "curr_kl_coeff": 2.847657469828846e-06, "mean_kl_loss": 0.000187661949894391, "num_module_steps_trained_lifetime_throughput": 440611.134474683}, "__all_modules__": {"learner_connector": {"timers": {"connectors": {"batch_individual_items": 0.03634548434191765, "add_observations_from_episodes_to_batch": 0.0007897386375994264, "add_columns_from_episodes_to_train_batch": 0.03397440070769768, "general_advantage_estimation": 0.006185915395561835, "add_time_dim_to_batch_and_zero_pad": 9.402074964627324e-06, "numpy_to_tensor": 6.247403713697863e-05, "add_states_from_episodes_to_batch": 3.1071183978173686e-06, "add_one_ts_to_episodes_and_truncate": 0.008315702509063383}}, "connector_pipeline_timer": 0.08579316086515519}, "num_trainable_parameters": 6003, "num_env_steps_trained_lifetime": 567000, "num_module_steps_trained": 6000, "num_non_trainable_parameters": 0, "num_env_steps_trained": 31500, "num_module_steps_trained_lifetime": 108000, "learner_connector_sum_episodes_length_in": 5000.0, "learner_connector_sum_episodes_length_out": 5250.0, "num_env_steps_trained_lifetime_throughput": 2305539.7606529365, "num_module_steps_trained_throughput": 440376.1592224841, "num_module_steps_trained_lifetime_throughput": 439830.60824224877}}, "num_training_step_calls_per_iteration": 1, "evaluation": {"env_runners": {"module_to_env_connector": {"connector_pipeline_timer": 9.599122276191454e-05, "timers": {"connectors": {"listify_data_for_vector_env": 1.0563280535841074e-05, "get_actions": 3.361032546382891e-05, "remove_single_ts_time_rank_from_batch": 5.43573253060348e-07, "tensor_to_numpy": 1.2219403357667836e-05, "un_batch_to_individual_items": 5.224016011383546e-06, "normalize_and_clip_actions": 9.09082740541226e-06}}}, "num_episodes_lifetime": 360, "num_module_steps_sampled": {"default_policy": 400}, "env_to_module_sum_episodes_length_in": 10.368238394574323, "env_to_module_connector": {"timers": {"connectors": {"numpy_to_tensor": 7.965631915185637e-06, "add_states_from_episodes_to_batch": 1.5010391799876805e-06, "add_time_dim_to_batch_and_zero_pad": 2.1070399116442413e-06, "batch_individual_items": 5.925697599607774e-06, "add_observations_from_episodes_to_batch": 2.7582342283020314e-06}}, "connector_pipeline_timer": 4.119904973662364e-05}, "module_episode_returns_mean": {"default_policy": 2.7}, "agent_episode_returns_mean": {"default_agent": 2.7}, "env_to_module_sum_episodes_length_out": 10.368238394574323, "episode_len_max": 20, "num_agent_steps_sampled": {"default_agent": 400}, "num_module_steps_sampled_lifetime": {"default_policy": 7200}, "episode_return_max": 12.5, "sample": 0.09676817223955272, "rlmodule_inference_timer": 2.552340960221659e-05, "env_reset_timer": 0.0002121026270493458, "episode_len_mean": 20.0, "weights_seq_no": 18.0, "episode_len_min": 20, "episode_duration_sec_mean": 0.004338064981857315, "episode_return_mean": 2.7, "num_env_steps_sampled": 400, "episode_return_min": -15.5, "num_agent_steps_sampled_lifetime": {"default_agent": 7200}, "num_episodes": 20, "env_step_timer": 1.3429135585695547e-05, "num_env_steps_sampled_lifetime": 90400, "time_between_sampling": 1.6637496319118985}, "num_healthy_workers": 1, "actor_manager_num_outstanding_async_reqs": 0, "num_remote_worker_restarts": 0}, "num_env_steps_sampled_lifetime": -9870000.0, "fault_tolerance": {"num_healthy_workers": 0, "num_remote_worker_restarts": 0}, "env_runner_group": {"actor_manager_num_outstanding_async_reqs": 0}, "done": false, "training_iteration": 18, "trial_id": "4649a_00000", "date": "2025-08-11_19-36-47", "timestamp": 1754933807, "time_this_iter_s": 1.701035976409912, "time_total_s": 37.48502779006958, "pid": 28167, "hostname": "Mac", "node_ip": "127.0.0.1", "config": {"exploration_config": {}, "extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "placement_strategy": "PACK", "num_gpus": 0, "_fake_gpus": false, "num_cpus_for_main_process": 2, "eager_tracing": true, "eager_max_retraces": 20, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "torch_compile_learner": false, "torch_compile_learner_what_to_compile": "forward_train", "torch_compile_learner_dynamo_backend": "aot_eager", "torch_compile_learner_dynamo_mode": null, "torch_compile_worker": false, "torch_compile_worker_dynamo_backend": "aot_eager", "torch_compile_worker_dynamo_mode": null, "torch_ddp_kwargs": {}, "torch_skip_nan_gradients": false, "env": "Umbrella", "env_config": {}, "observation_space": null, "action_space": null, "clip_rewards": null, "normalize_actions": true, "clip_actions": false, "_is_atari": null, "disable_env_checking": false, "render_env": false, "action_mask_key": "action_mask", "env_runner_cls": null, "num_env_runners": 0, "create_local_env_runner": true, "num_envs_per_env_runner": 1, "gym_env_vectorize_mode": "SYNC", "num_cpus_per_env_runner": 1, "num_gpus_per_env_runner": 0, "custom_resources_per_env_runner": {}, "validate_env_runners_after_construction": true, "episodes_to_numpy": true, "max_requests_in_flight_per_env_runner": 1, "sample_timeout_s": 60.0, "_env_to_module_connector": null, "add_default_connectors_to_env_to_module_pipeline": true, "_module_to_env_connector": null, "add_default_connectors_to_module_to_env_pipeline": true, "merge_env_runner_states": "training_only", "broadcast_env_runner_states": true, "episode_lookback_horizon": 1, "rollout_fragment_length": "auto", "batch_mode": "complete_episodes", "compress_observations": false, "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "enable_tf1_exec_eagerly": false, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "preprocessor_pref": "deepmind", "observation_filter": "NoFilter", "update_worker_filter_stats": true, "use_worker_filter_stats": true, "sampler_perf_stats_ema_coef": null, "_is_online": true, "num_learners": 0, "num_gpus_per_learner": 0, "num_cpus_per_learner": "auto", "num_aggregator_actors_per_learner": 0, "max_requests_in_flight_per_aggregator_actor": 3, "local_gpu_idx": 0, "max_requests_in_flight_per_learner": 3, "gamma": 1, "lr": 0.0002847858517, "grad_clip": 0.5, "grad_clip_by": "global_norm", "_train_batch_size_per_learner": 5000, "train_batch_size": 4000, "num_epochs": 1, "minibatch_size": 1000, "shuffle_batch_per_epoch": true, "model": {"fcnet_hiddens": [256, 256], "fcnet_activation": "tanh", "fcnet_weights_initializer": null, "fcnet_weights_initializer_config": null, "fcnet_bias_initializer": null, "fcnet_bias_initializer_config": null, "conv_filters": null, "conv_activation": "relu", "conv_kernel_initializer": null, "conv_kernel_initializer_config": null, "conv_bias_initializer": null, "conv_bias_initializer_config": null, "conv_transpose_kernel_initializer": null, "conv_transpose_kernel_initializer_config": null, "conv_transpose_bias_initializer": null, "conv_transpose_bias_initializer_config": null, "post_fcnet_hiddens": [], "post_fcnet_activation": "relu", "post_fcnet_weights_initializer": null, "post_fcnet_weights_initializer_config": null, "post_fcnet_bias_initializer": null, "post_fcnet_bias_initializer_config": null, "free_log_std": false, "log_std_clip_param": 20.0, "no_final_linear": false, "vf_share_layers": false, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "lstm_weights_initializer": null, "lstm_weights_initializer_config": null, "lstm_bias_initializer": null, "lstm_bias_initializer_config": null, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "attention_use_n_prev_actions": 0, "attention_use_n_prev_rewards": 0, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": null, "custom_model_config": {}, "custom_action_dist": null, "custom_preprocessor": null, "encoder_latent_dim": null, "always_check_shapes": false, "lstm_use_prev_action_reward": -1, "_use_default_native_models": -1, "_disable_preprocessor_api": false, "_disable_action_flattening": false}, "_learner_connector": null, "add_default_connectors_to_learner_pipeline": true, "learner_config_dict": {}, "optimizer": {}, "_learner_class": null, "callbacks_on_algorithm_init": null, "callbacks_on_env_runners_recreated": null, "callbacks_on_offline_eval_runners_recreated": null, "callbacks_on_checkpoint_loaded": null, "callbacks_on_environment_created": null, "callbacks_on_episode_created": null, "callbacks_on_episode_start": null, "callbacks_on_episode_step": null, "callbacks_on_episode_end": null, "callbacks_on_evaluate_start": null, "callbacks_on_evaluate_end": null, "callbacks_on_evaluate_offline_start": null, "callbacks_on_evaluate_offline_end": null, "callbacks_on_sample_end": null, "callbacks_on_train_result": null, "explore": true, "enable_rl_module_and_learner": true, "enable_env_runner_and_connector_v2": true, "_prior_exploration_config": {"type": "StochasticSampling"}, "count_steps_by": "env_steps", "policy_map_capacity": 100, "policy_mapping_fn": "<function AlgorithmConfig.DEFAULT_POLICY_MAPPING_FN at 0x17c065b20>", "policies_to_train": null, "policy_states_are_swappable": false, "observation_fn": null, "offline_data_class": null, "input_read_method": "read_parquet", "input_read_method_kwargs": {}, "input_read_schema": {}, "input_read_episodes": false, "input_read_sample_batches": false, "input_read_batch_size": null, "input_filesystem": null, "input_filesystem_kwargs": {}, "input_compress_columns": ["obs", "new_obs"], "input_spaces_jsonable": true, "materialize_data": false, "materialize_mapped_data": true, "map_batches_kwargs": {}, "iter_batches_kwargs": {}, "ignore_final_observation": false, "prelearner_class": null, "prelearner_buffer_class": null, "prelearner_buffer_kwargs": {}, "prelearner_module_synch_period": 10, "dataset_num_iters_per_learner": null, "input_config": {}, "actions_in_input_normalized": false, "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_config": {}, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "output_max_rows_per_file": null, "output_write_remaining_data": false, "output_write_method": "write_parquet", "output_write_method_kwargs": {}, "output_filesystem": null, "output_filesystem_kwargs": {}, "output_write_episodes": true, "offline_sampling": false, "evaluation_interval": 1, "evaluation_duration": 20, "evaluation_duration_unit": "episodes", "evaluation_sample_timeout_s": 120.0, "evaluation_auto_duration_min_env_steps_per_sample": 100, "evaluation_auto_duration_max_env_steps_per_sample": 2000, "evaluation_parallel_to_training": false, "evaluation_force_reset_envs_before_iteration": true, "evaluation_config": null, "off_policy_estimation_methods": {}, "ope_split_batch_by_episode": true, "evaluation_num_env_runners": 1, "in_evaluation": false, "sync_filters_on_rollout_workers_timeout_s": 10.0, "offline_evaluation_interval": null, "num_offline_eval_runners": 0, "offline_loss_for_module_fn": null, "offline_evaluation_duration": 1, "offline_evaluation_parallel_to_training": false, "offline_evaluation_timeout_s": 120.0, "num_cpus_per_offline_eval_runner": 1, "num_gpus_per_offline_eval_runner": 0, "custom_resources_per_offline_eval_runner": {}, "restart_failed_offline_eval_runners": true, "ignore_offline_eval_runner_failures": false, "max_num_offline_eval_runner_restarts": 1000, "offline_eval_runner_restore_timeout_s": 1800.0, "max_requests_in_flight_per_offline_eval_runner": 1, "validate_offline_eval_runners_after_construction": true, "offline_eval_runner_health_probe_timeout_s": 30.0, "offline_eval_rl_module_inference_only": false, "broadcast_offline_eval_runner_states": false, "offline_eval_batch_size_per_runner": 256, "dataset_num_iters_per_eval_runner": 1, "keep_per_episode_custom_metrics": false, "metrics_episode_collection_timeout_s": 60.0, "metrics_num_episodes_for_smoothing": 100, "min_time_s_per_iteration": null, "min_train_timesteps_per_iteration": 0, "min_sample_timesteps_per_iteration": 0, "log_gradients": true, "export_native_model_files": false, "checkpoint_trainable_policies_only": false, "logger_creator": null, "logger_config": null, "log_level": "WARN", "log_sys_usage": true, "fake_sampler": false, "seed": 5, "restart_failed_env_runners": true, "ignore_env_runner_failures": false, "max_num_env_runner_restarts": 1000, "delay_between_env_runner_restarts_s": 60.0, "restart_failed_sub_environments": false, "num_consecutive_env_runner_failures_tolerance": 100, "env_runner_health_probe_timeout_s": 30.0, "env_runner_restore_timeout_s": 1800.0, "_model_config": {}, "_rl_module_spec": "RLModuleSpec(module_class=None, observation_space=None, action_space=None, inference_only=False, learner_only=False, model_config=DefaultModelConfig(fcnet_hiddens=[60, 90], fcnet_activation='tanh', fcnet_kernel_initializer=None, fcnet_kernel_initializer_kwargs=None, fcnet_bias_initializer=None, fcnet_bias_initializer_kwargs=None, conv_filters=None, conv_activation='relu', conv_kernel_initializer=None, conv_kernel_initializer_kwargs=None, conv_bias_initializer=None, conv_bias_initializer_kwargs=None, head_fcnet_hiddens=[], head_fcnet_activation='relu', head_fcnet_kernel_initializer=None, head_fcnet_kernel_initializer_kwargs=None, head_fcnet_bias_initializer=None, head_fcnet_bias_initializer_kwargs=None, free_log_std=False, log_std_clip_param=20.0, vf_share_layers=True, use_lstm=False, max_seq_len=20, lstm_cell_size=256, lstm_use_prev_action=False, lstm_use_prev_reward=False, lstm_kernel_initializer=None, lstm_kernel_initializer_kwargs=None, lstm_bias_initializer=None, lstm_bias_initializer_kwargs=None), catalog_class=None, load_state_path=None, model_config_dict=None)", "algorithm_config_overrides_per_module": {}, "_per_module_overrides": {}, "_validate_config": true, "_use_msgpack_checkpoints": false, "_torch_grad_scaler_class": null, "_torch_lr_scheduler_classes": null, "_tf_policy_handles_more_than_one_loss": false, "_disable_preprocessor_api": false, "_disable_action_flattening": false, "_disable_initialize_loss_from_dummy_batch": false, "_dont_auto_sync_env_runner_states": false, "env_task_fn": -1, "enable_connectors": -1, "simple_optimizer": false, "policy_map_cache": -1, "worker_cls": -1, "synchronize_filters": -1, "enable_async_evaluation": -1, "custom_async_evaluation_function": -1, "_enable_rl_module_api": -1, "auto_wrap_old_gym_envs": -1, "always_attach_evaluation_results": -1, "replay_sequence_length": null, "_disable_execution_plan_api": -1, "use_critic": true, "use_gae": true, "use_kl_loss": true, "kl_coeff": 0.7464963036515, "kl_target": 0.0270990929592, "vf_loss_coeff": 0.6688075857018, "entropy_coeff": 0.0090570820258, "clip_param": 0.1221781641624, "vf_clip_param": 0.1027808522125, "entropy_coeff_schedule": null, "lr_schedule": null, "sgd_minibatch_size": -1, "vf_share_layers": -1, "__stdout_file__": null, "__stderr_file__": null, "lambda": 0.9099046732075, "input": "sampler", "policies": {"default_policy": [null, null, null, null]}, "callbacks": "<class 'ray.rllib.callbacks.callbacks.RLlibCallback'>", "create_env_on_driver": false, "custom_eval_function": null, "framework": "torch"}, "time_since_restore": 37.48502779006958, "iterations_since_restore": 18, "perf": {"cpu_util_percent": 47.8, "ram_util_percent": 78.0}}
{"timers": {"training_iteration": 1.6053763822311098, "restore_env_runners": 7.639042469359251e-06, "training_step": 1.6052378262272142, "env_runner_sampling_timer": 1.4929922215485052, "learner_update_timer": 0.1091340599274775, "synch_weights": 0.0006184770021651318, "restore_eval_env_runners": 8.96020206130473e-06, "evaluation_iteration": 0.10297376636783241, "synch_eval_env_connectors": 0.00012101982170563308, "synch_env_connectors": 4.541323238769743e-06}, "env_runners": {"env_to_module_connector": {"timers": {"connectors": {"numpy_to_tensor": 8.336824498285776e-06, "add_states_from_episodes_to_batch": 1.7272244645147165e-06, "batch_individual_items": 6.2551951528370465e-06, "add_observations_from_episodes_to_batch": 2.946789320146827e-06, "add_time_dim_to_batch_and_zero_pad": 2.278612800190006e-06}}, "connector_pipeline_timer": 4.3372828565528875e-05}, "num_agent_steps_sampled_lifetime": {"default_agent": -10487500.0}, "env_to_module_sum_episodes_length_out": 10.36823839457432, "num_episodes": 250.0, "episode_len_max": 20, "num_module_steps_sampled": {"default_policy": 5000.0}, "module_to_env_connector": {"timers": {"connectors": {"un_batch_to_individual_items": 5.3332666555564575e-06, "listify_data_for_vector_env": 1.0708054197855512e-05, "normalize_and_clip_actions": 9.201955297282467e-06, "get_actions": 3.6899106003582255e-05, "tensor_to_numpy": 1.2820242460127699e-05, "remove_single_ts_time_rank_from_batch": 5.747859305942932e-07}}, "connector_pipeline_timer": 0.00010125024398569571}, "num_module_steps_sampled_lifetime": {"default_policy": -10487500.0}, "num_episodes_lifetime": -524375.0, "episode_len_min": 20, "episode_return_max": 6.5, "env_to_module_sum_episodes_length_in": 10.36823839457432, "env_step_timer": 1.3651309369008039e-05, "sample": 0.0048077310426375966, "rlmodule_inference_timer": 2.7137055061791204e-05, "episode_duration_sec_mean": 0.004472684998996556, "episode_return_mean": 4.259999999999998, "module_episode_returns_mean": {"default_policy": 4.259999999999998}, "env_reset_timer": 3.101576591955371e-05, "num_env_steps_sampled_lifetime": -10487500.0, "num_env_steps_sampled": 5000.0, "episode_return_min": -13.5, "episode_len_mean": 20.0, "weights_seq_no": 18.0, "num_agent_steps_sampled": {"default_agent": 5000.0}, "time_between_sampling": 0.001798378144006978, "agent_episode_returns_mean": {"default_agent": 4.259999999999998}, "num_env_steps_sampled_lifetime_throughput": 3812.115669171888}, "learners": {"default_policy": {"policy_loss": 0.06076934561133385, "vf_loss": 0.10278083384037018, "vf_loss_unclipped": 23.938852310180664, "num_module_steps_trained": 6000, "diff_num_grad_updates_vs_sampler_policy": 1.0, "default_optimizer_learning_rate": 0.0002847858517, "weights_seq_no": 19.0, "total_loss": 0.12606894969940186, "vf_explained_var": -0.019092679023742676, "module_train_batch_size_mean": 1000.0, "num_module_steps_trained_lifetime": 114000, "gradients_default_optimizer_global_norm": 0.08828224986791611, "entropy": 0.37992289662361145, "curr_entropy_coeff": 0.0090570820258, "num_trainable_parameters": 6003, "curr_kl_coeff": 1.423828734914423e-06, "mean_kl_loss": 0.00026499663363210857, "num_module_steps_trained_lifetime_throughput": 441367.30805783416}, "__all_modules__": {"learner_connector": {"timers": {"connectors": {"batch_individual_items": 0.03714232449763413, "add_observations_from_episodes_to_batch": 0.0007901566614556036, "add_columns_from_episodes_to_train_batch": 0.033968875860179125, "general_advantage_estimation": 0.006175224162070867, "add_time_dim_to_batch_and_zero_pad": 9.385133963715882e-06, "numpy_to_tensor": 6.239720664194053e-05, "add_states_from_episodes_to_batch": 3.1014676635133244e-06, "add_one_ts_to_episodes_and_truncate": 0.008308276313239582}}, "connector_pipeline_timer": 0.0865664309274744}, "num_trainable_parameters": 6003, "num_env_steps_trained_lifetime": 598500, "num_module_steps_trained": 6000, "num_non_trainable_parameters": 0, "num_env_steps_trained": 31500, "num_module_steps_trained_lifetime": 114000, "learner_connector_sum_episodes_length_in": 5000.0, "learner_connector_sum_episodes_length_out": 5250.0, "num_env_steps_trained_lifetime_throughput": 2310004.753103828, "num_module_steps_trained_throughput": 441181.1535259344, "num_module_steps_trained_lifetime_throughput": 440651.97301379195}}, "num_training_step_calls_per_iteration": 1, "evaluation": {"env_runners": {"module_to_env_connector": {"connector_pipeline_timer": 9.588395215058105e-05, "timers": {"connectors": {"listify_data_for_vector_env": 1.0672772192918309e-05, "get_actions": 3.369908856206393e-05, "remove_single_ts_time_rank_from_batch": 5.510082781421401e-07, "tensor_to_numpy": 1.2256179634934432e-05, "un_batch_to_individual_items": 5.176898558634104e-06, "normalize_and_clip_actions": 9.043864371948467e-06}}}, "num_episodes_lifetime": 380, "num_module_steps_sampled": {"default_policy": 400}, "env_to_module_sum_episodes_length_in": 10.368238394574323, "env_to_module_connector": {"timers": {"connectors": {"numpy_to_tensor": 8.00058642826091e-06, "add_states_from_episodes_to_batch": 1.5213210773864576e-06, "add_time_dim_to_batch_and_zero_pad": 2.1305581801451568e-06, "batch_individual_items": 5.923603764996022e-06, "add_observations_from_episodes_to_batch": 2.7552331007597315e-06}}, "connector_pipeline_timer": 4.126212350157601e-05}, "module_episode_returns_mean": {"default_policy": 2.7}, "agent_episode_returns_mean": {"default_agent": 2.7}, "env_to_module_sum_episodes_length_out": 10.368238394574323, "episode_len_max": 20, "num_agent_steps_sampled": {"default_agent": 400}, "num_module_steps_sampled_lifetime": {"default_policy": 7600}, "episode_return_max": 12.5, "sample": 0.09673660593734781, "rlmodule_inference_timer": 2.5644818417891743e-05, "env_reset_timer": 0.00021077826109409774, "episode_len_mean": 20.0, "weights_seq_no": 19.0, "episode_len_min": 20, "episode_duration_sec_mean": 0.004331403735559434, "episode_return_mean": 2.7, "num_env_steps_sampled": 400, "episode_return_min": -15.5, "num_agent_steps_sampled_lifetime": {"default_agent": 7600}, "num_episodes": 20, "env_step_timer": 1.3398411321694628e-05, "num_env_steps_sampled_lifetime": 95400, "time_between_sampling": 1.6625664785028682}, "num_healthy_workers": 1, "actor_manager_num_outstanding_async_reqs": 0, "num_remote_worker_restarts": 0}, "num_env_steps_sampled_lifetime": -10487500.0, "fault_tolerance": {"num_healthy_workers": 0, "num_remote_worker_restarts": 0}, "env_runner_group": {"actor_manager_num_outstanding_async_reqs": 0}, "done": false, "training_iteration": 19, "trial_id": "4649a_00000", "date": "2025-08-11_19-36-49", "timestamp": 1754933809, "time_this_iter_s": 1.6284830570220947, "time_total_s": 39.113510847091675, "pid": 28167, "hostname": "Mac", "node_ip": "127.0.0.1", "config": {"exploration_config": {}, "extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "placement_strategy": "PACK", "num_gpus": 0, "_fake_gpus": false, "num_cpus_for_main_process": 2, "eager_tracing": true, "eager_max_retraces": 20, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "torch_compile_learner": false, "torch_compile_learner_what_to_compile": "forward_train", "torch_compile_learner_dynamo_backend": "aot_eager", "torch_compile_learner_dynamo_mode": null, "torch_compile_worker": false, "torch_compile_worker_dynamo_backend": "aot_eager", "torch_compile_worker_dynamo_mode": null, "torch_ddp_kwargs": {}, "torch_skip_nan_gradients": false, "env": "Umbrella", "env_config": {}, "observation_space": null, "action_space": null, "clip_rewards": null, "normalize_actions": true, "clip_actions": false, "_is_atari": null, "disable_env_checking": false, "render_env": false, "action_mask_key": "action_mask", "env_runner_cls": null, "num_env_runners": 0, "create_local_env_runner": true, "num_envs_per_env_runner": 1, "gym_env_vectorize_mode": "SYNC", "num_cpus_per_env_runner": 1, "num_gpus_per_env_runner": 0, "custom_resources_per_env_runner": {}, "validate_env_runners_after_construction": true, "episodes_to_numpy": true, "max_requests_in_flight_per_env_runner": 1, "sample_timeout_s": 60.0, "_env_to_module_connector": null, "add_default_connectors_to_env_to_module_pipeline": true, "_module_to_env_connector": null, "add_default_connectors_to_module_to_env_pipeline": true, "merge_env_runner_states": "training_only", "broadcast_env_runner_states": true, "episode_lookback_horizon": 1, "rollout_fragment_length": "auto", "batch_mode": "complete_episodes", "compress_observations": false, "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "enable_tf1_exec_eagerly": false, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "preprocessor_pref": "deepmind", "observation_filter": "NoFilter", "update_worker_filter_stats": true, "use_worker_filter_stats": true, "sampler_perf_stats_ema_coef": null, "_is_online": true, "num_learners": 0, "num_gpus_per_learner": 0, "num_cpus_per_learner": "auto", "num_aggregator_actors_per_learner": 0, "max_requests_in_flight_per_aggregator_actor": 3, "local_gpu_idx": 0, "max_requests_in_flight_per_learner": 3, "gamma": 1, "lr": 0.0002847858517, "grad_clip": 0.5, "grad_clip_by": "global_norm", "_train_batch_size_per_learner": 5000, "train_batch_size": 4000, "num_epochs": 1, "minibatch_size": 1000, "shuffle_batch_per_epoch": true, "model": {"fcnet_hiddens": [256, 256], "fcnet_activation": "tanh", "fcnet_weights_initializer": null, "fcnet_weights_initializer_config": null, "fcnet_bias_initializer": null, "fcnet_bias_initializer_config": null, "conv_filters": null, "conv_activation": "relu", "conv_kernel_initializer": null, "conv_kernel_initializer_config": null, "conv_bias_initializer": null, "conv_bias_initializer_config": null, "conv_transpose_kernel_initializer": null, "conv_transpose_kernel_initializer_config": null, "conv_transpose_bias_initializer": null, "conv_transpose_bias_initializer_config": null, "post_fcnet_hiddens": [], "post_fcnet_activation": "relu", "post_fcnet_weights_initializer": null, "post_fcnet_weights_initializer_config": null, "post_fcnet_bias_initializer": null, "post_fcnet_bias_initializer_config": null, "free_log_std": false, "log_std_clip_param": 20.0, "no_final_linear": false, "vf_share_layers": false, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "lstm_weights_initializer": null, "lstm_weights_initializer_config": null, "lstm_bias_initializer": null, "lstm_bias_initializer_config": null, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "attention_use_n_prev_actions": 0, "attention_use_n_prev_rewards": 0, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": null, "custom_model_config": {}, "custom_action_dist": null, "custom_preprocessor": null, "encoder_latent_dim": null, "always_check_shapes": false, "lstm_use_prev_action_reward": -1, "_use_default_native_models": -1, "_disable_preprocessor_api": false, "_disable_action_flattening": false}, "_learner_connector": null, "add_default_connectors_to_learner_pipeline": true, "learner_config_dict": {}, "optimizer": {}, "_learner_class": null, "callbacks_on_algorithm_init": null, "callbacks_on_env_runners_recreated": null, "callbacks_on_offline_eval_runners_recreated": null, "callbacks_on_checkpoint_loaded": null, "callbacks_on_environment_created": null, "callbacks_on_episode_created": null, "callbacks_on_episode_start": null, "callbacks_on_episode_step": null, "callbacks_on_episode_end": null, "callbacks_on_evaluate_start": null, "callbacks_on_evaluate_end": null, "callbacks_on_evaluate_offline_start": null, "callbacks_on_evaluate_offline_end": null, "callbacks_on_sample_end": null, "callbacks_on_train_result": null, "explore": true, "enable_rl_module_and_learner": true, "enable_env_runner_and_connector_v2": true, "_prior_exploration_config": {"type": "StochasticSampling"}, "count_steps_by": "env_steps", "policy_map_capacity": 100, "policy_mapping_fn": "<function AlgorithmConfig.DEFAULT_POLICY_MAPPING_FN at 0x17c065b20>", "policies_to_train": null, "policy_states_are_swappable": false, "observation_fn": null, "offline_data_class": null, "input_read_method": "read_parquet", "input_read_method_kwargs": {}, "input_read_schema": {}, "input_read_episodes": false, "input_read_sample_batches": false, "input_read_batch_size": null, "input_filesystem": null, "input_filesystem_kwargs": {}, "input_compress_columns": ["obs", "new_obs"], "input_spaces_jsonable": true, "materialize_data": false, "materialize_mapped_data": true, "map_batches_kwargs": {}, "iter_batches_kwargs": {}, "ignore_final_observation": false, "prelearner_class": null, "prelearner_buffer_class": null, "prelearner_buffer_kwargs": {}, "prelearner_module_synch_period": 10, "dataset_num_iters_per_learner": null, "input_config": {}, "actions_in_input_normalized": false, "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_config": {}, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "output_max_rows_per_file": null, "output_write_remaining_data": false, "output_write_method": "write_parquet", "output_write_method_kwargs": {}, "output_filesystem": null, "output_filesystem_kwargs": {}, "output_write_episodes": true, "offline_sampling": false, "evaluation_interval": 1, "evaluation_duration": 20, "evaluation_duration_unit": "episodes", "evaluation_sample_timeout_s": 120.0, "evaluation_auto_duration_min_env_steps_per_sample": 100, "evaluation_auto_duration_max_env_steps_per_sample": 2000, "evaluation_parallel_to_training": false, "evaluation_force_reset_envs_before_iteration": true, "evaluation_config": null, "off_policy_estimation_methods": {}, "ope_split_batch_by_episode": true, "evaluation_num_env_runners": 1, "in_evaluation": false, "sync_filters_on_rollout_workers_timeout_s": 10.0, "offline_evaluation_interval": null, "num_offline_eval_runners": 0, "offline_loss_for_module_fn": null, "offline_evaluation_duration": 1, "offline_evaluation_parallel_to_training": false, "offline_evaluation_timeout_s": 120.0, "num_cpus_per_offline_eval_runner": 1, "num_gpus_per_offline_eval_runner": 0, "custom_resources_per_offline_eval_runner": {}, "restart_failed_offline_eval_runners": true, "ignore_offline_eval_runner_failures": false, "max_num_offline_eval_runner_restarts": 1000, "offline_eval_runner_restore_timeout_s": 1800.0, "max_requests_in_flight_per_offline_eval_runner": 1, "validate_offline_eval_runners_after_construction": true, "offline_eval_runner_health_probe_timeout_s": 30.0, "offline_eval_rl_module_inference_only": false, "broadcast_offline_eval_runner_states": false, "offline_eval_batch_size_per_runner": 256, "dataset_num_iters_per_eval_runner": 1, "keep_per_episode_custom_metrics": false, "metrics_episode_collection_timeout_s": 60.0, "metrics_num_episodes_for_smoothing": 100, "min_time_s_per_iteration": null, "min_train_timesteps_per_iteration": 0, "min_sample_timesteps_per_iteration": 0, "log_gradients": true, "export_native_model_files": false, "checkpoint_trainable_policies_only": false, "logger_creator": null, "logger_config": null, "log_level": "WARN", "log_sys_usage": true, "fake_sampler": false, "seed": 5, "restart_failed_env_runners": true, "ignore_env_runner_failures": false, "max_num_env_runner_restarts": 1000, "delay_between_env_runner_restarts_s": 60.0, "restart_failed_sub_environments": false, "num_consecutive_env_runner_failures_tolerance": 100, "env_runner_health_probe_timeout_s": 30.0, "env_runner_restore_timeout_s": 1800.0, "_model_config": {}, "_rl_module_spec": "RLModuleSpec(module_class=None, observation_space=None, action_space=None, inference_only=False, learner_only=False, model_config=DefaultModelConfig(fcnet_hiddens=[60, 90], fcnet_activation='tanh', fcnet_kernel_initializer=None, fcnet_kernel_initializer_kwargs=None, fcnet_bias_initializer=None, fcnet_bias_initializer_kwargs=None, conv_filters=None, conv_activation='relu', conv_kernel_initializer=None, conv_kernel_initializer_kwargs=None, conv_bias_initializer=None, conv_bias_initializer_kwargs=None, head_fcnet_hiddens=[], head_fcnet_activation='relu', head_fcnet_kernel_initializer=None, head_fcnet_kernel_initializer_kwargs=None, head_fcnet_bias_initializer=None, head_fcnet_bias_initializer_kwargs=None, free_log_std=False, log_std_clip_param=20.0, vf_share_layers=True, use_lstm=False, max_seq_len=20, lstm_cell_size=256, lstm_use_prev_action=False, lstm_use_prev_reward=False, lstm_kernel_initializer=None, lstm_kernel_initializer_kwargs=None, lstm_bias_initializer=None, lstm_bias_initializer_kwargs=None), catalog_class=None, load_state_path=None, model_config_dict=None)", "algorithm_config_overrides_per_module": {}, "_per_module_overrides": {}, "_validate_config": true, "_use_msgpack_checkpoints": false, "_torch_grad_scaler_class": null, "_torch_lr_scheduler_classes": null, "_tf_policy_handles_more_than_one_loss": false, "_disable_preprocessor_api": false, "_disable_action_flattening": false, "_disable_initialize_loss_from_dummy_batch": false, "_dont_auto_sync_env_runner_states": false, "env_task_fn": -1, "enable_connectors": -1, "simple_optimizer": false, "policy_map_cache": -1, "worker_cls": -1, "synchronize_filters": -1, "enable_async_evaluation": -1, "custom_async_evaluation_function": -1, "_enable_rl_module_api": -1, "auto_wrap_old_gym_envs": -1, "always_attach_evaluation_results": -1, "replay_sequence_length": null, "_disable_execution_plan_api": -1, "use_critic": true, "use_gae": true, "use_kl_loss": true, "kl_coeff": 0.7464963036515, "kl_target": 0.0270990929592, "vf_loss_coeff": 0.6688075857018, "entropy_coeff": 0.0090570820258, "clip_param": 0.1221781641624, "vf_clip_param": 0.1027808522125, "entropy_coeff_schedule": null, "lr_schedule": null, "sgd_minibatch_size": -1, "vf_share_layers": -1, "__stdout_file__": null, "__stderr_file__": null, "lambda": 0.9099046732075, "input": "sampler", "policies": {"default_policy": [null, null, null, null]}, "callbacks": "<class 'ray.rllib.callbacks.callbacks.RLlibCallback'>", "create_env_on_driver": false, "custom_eval_function": null, "framework": "torch"}, "time_since_restore": 39.113510847091675, "iterations_since_restore": 19, "perf": {"cpu_util_percent": 36.8, "ram_util_percent": 78.05000000000001}}
{"timers": {"training_iteration": 1.6037373263281487, "restore_env_runners": 7.619311381798827e-06, "training_step": 1.6035982054643183, "env_runner_sampling_timer": 1.4915455726629319, "learner_update_timer": 0.10894267974783149, "synch_weights": 0.0006181614013973364, "restore_eval_env_runners": 8.942259492042252e-06, "evaluation_iteration": 0.10292809245335569, "synch_eval_env_connectors": 0.00012079462283978018, "synch_env_connectors": 4.540910349034247e-06}, "env_runners": {"env_to_module_connector": {"timers": {"connectors": {"numpy_to_tensor": 8.340354606151808e-06, "add_states_from_episodes_to_batch": 1.6900147795207064e-06, "batch_individual_items": 6.190647881073689e-06, "add_observations_from_episodes_to_batch": 2.9188670744000366e-06, "add_time_dim_to_batch_and_zero_pad": 2.259701213228977e-06}}, "connector_pipeline_timer": 4.3137827710242465e-05}, "num_agent_steps_sampled_lifetime": {"default_agent": -11105000.0}, "env_to_module_sum_episodes_length_out": 10.36823839457432, "num_episodes": 250.0, "episode_len_max": 20, "num_module_steps_sampled": {"default_policy": 5000.0}, "module_to_env_connector": {"timers": {"connectors": {"un_batch_to_individual_items": 5.286244296521062e-06, "listify_data_for_vector_env": 1.0618301422902348e-05, "normalize_and_clip_actions": 9.16474206489664e-06, "get_actions": 3.6856427972007694e-05, "tensor_to_numpy": 1.2750730082285829e-05, "remove_single_ts_time_rank_from_batch": 5.687374832546935e-07}}, "connector_pipeline_timer": 0.00010083548338356028}, "num_module_steps_sampled_lifetime": {"default_policy": -11105000.0}, "num_episodes_lifetime": -555250.0, "episode_len_min": 20, "episode_return_max": 6.5, "env_to_module_sum_episodes_length_in": 10.36823839457432, "env_step_timer": 1.3620444298774704e-05, "sample": 0.0047418215329616655, "rlmodule_inference_timer": 2.6520925369106398e-05, "episode_duration_sec_mean": 0.004447727499529719, "episode_return_mean": 5.380000000000001, "module_episode_returns_mean": {"default_policy": 5.380000000000001}, "env_reset_timer": 3.0316493782525487e-05, "num_env_steps_sampled_lifetime": -11105000.0, "num_env_steps_sampled": 5000.0, "episode_return_min": -13.5, "episode_len_mean": 20.0, "weights_seq_no": 19.0, "num_agent_steps_sampled": {"default_agent": 5000.0}, "time_between_sampling": 0.0017854972341869477, "agent_episode_returns_mean": {"default_agent": 5.380000000000001}, "num_env_steps_sampled_lifetime_throughput": 3832.0329234364335}, "learners": {"default_policy": {"policy_loss": -0.010907428339123726, "vf_loss": 0.10278083384037018, "vf_loss_unclipped": 22.31365966796875, "num_module_steps_trained": 6000, "diff_num_grad_updates_vs_sampler_policy": 1.0, "default_optimizer_learning_rate": 0.0002847858517, "weights_seq_no": 20.0, "total_loss": 0.05449638143181801, "vf_explained_var": -0.02270638942718506, "module_train_batch_size_mean": 1000.0, "num_module_steps_trained_lifetime": 120000, "gradients_default_optimizer_global_norm": 0.03705389052629471, "entropy": 0.36841875314712524, "curr_entropy_coeff": 0.0090570820258, "num_trainable_parameters": 6003, "curr_kl_coeff": 7.119143674572115e-07, "mean_kl_loss": 1.596551010152325e-05, "num_module_steps_trained_lifetime_throughput": 442197.64909356844}, "__all_modules__": {"learner_connector": {"timers": {"connectors": {"batch_individual_items": 0.03707288500261741, "add_observations_from_episodes_to_batch": 0.000790139265468269, "add_columns_from_episodes_to_train_batch": 0.03396394085193511, "general_advantage_estimation": 0.006163708170258381, "add_time_dim_to_batch_and_zero_pad": 9.39044286690447e-06, "numpy_to_tensor": 6.253406458301462e-05, "add_states_from_episodes_to_batch": 3.0962925317108974e-06, "add_one_ts_to_episodes_and_truncate": 0.008299851890416002}}, "connector_pipeline_timer": 0.08647210161837192}, "num_trainable_parameters": 6003, "num_env_steps_trained_lifetime": 630000, "num_module_steps_trained": 6000, "num_non_trainable_parameters": 0, "num_env_steps_trained": 31500, "num_module_steps_trained_lifetime": 120000, "learner_connector_sum_episodes_length_in": 5000.0, "learner_connector_sum_episodes_length_out": 5250.0, "num_env_steps_trained_lifetime_throughput": 2314801.349609817, "num_module_steps_trained_throughput": 442053.93961417495, "num_module_steps_trained_lifetime_throughput": 441539.59322348284}}, "num_training_step_calls_per_iteration": 1, "evaluation": {"env_runners": {"module_to_env_connector": {"connector_pipeline_timer": 9.621610595176451e-05, "timers": {"connectors": {"listify_data_for_vector_env": 1.0498074384485915e-05, "get_actions": 3.4013273756236404e-05, "remove_single_ts_time_rank_from_batch": 5.387381012436867e-07, "tensor_to_numpy": 1.2359171798520307e-05, "un_batch_to_individual_items": 5.198852214811342e-06, "normalize_and_clip_actions": 9.077708770542655e-06}}}, "num_episodes_lifetime": 400, "num_module_steps_sampled": {"default_policy": 400}, "env_to_module_sum_episodes_length_in": 10.368238394574323, "env_to_module_connector": {"timers": {"connectors": {"numpy_to_tensor": 7.931207227561131e-06, "add_states_from_episodes_to_batch": 1.4871723258509776e-06, "add_time_dim_to_batch_and_zero_pad": 2.102925729534221e-06, "batch_individual_items": 5.875038814400913e-06, "add_observations_from_episodes_to_batch": 2.6818605174260367e-06}}, "connector_pipeline_timer": 4.051916096454892e-05}, "module_episode_returns_mean": {"default_policy": 3.3}, "agent_episode_returns_mean": {"default_agent": 3.3}, "env_to_module_sum_episodes_length_out": 10.368238394574323, "episode_len_max": 20, "num_agent_steps_sampled": {"default_agent": 400}, "num_module_steps_sampled_lifetime": {"default_policy": 8000}, "episode_return_max": 12.5, "sample": 0.0966923682074246, "rlmodule_inference_timer": 2.5645660759444046e-05, "env_reset_timer": 0.00020940922916071257, "episode_len_mean": 20.0, "weights_seq_no": 20.0, "episode_len_min": 20, "episode_duration_sec_mean": 0.004307525396579876, "episode_return_mean": 3.3, "num_env_steps_sampled": 400, "episode_return_min": -15.5, "num_agent_steps_sampled_lifetime": {"default_agent": 8000}, "num_episodes": 20, "env_step_timer": 1.351278471619392e-05, "num_env_steps_sampled_lifetime": 100400, "time_between_sampling": 1.6605275932978254}, "num_healthy_workers": 1, "actor_manager_num_outstanding_async_reqs": 0, "num_remote_worker_restarts": 0}, "num_env_steps_sampled_lifetime": -11105000.0, "fault_tolerance": {"num_healthy_workers": 0, "num_remote_worker_restarts": 0}, "env_runner_group": {"actor_manager_num_outstanding_async_reqs": 0}, "done": true, "training_iteration": 20, "trial_id": "4649a_00000", "date": "2025-08-11_19-36-51", "timestamp": 1754933811, "time_this_iter_s": 1.5406410694122314, "time_total_s": 40.654151916503906, "pid": 28167, "hostname": "Mac", "node_ip": "127.0.0.1", "config": {"exploration_config": {}, "extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "placement_strategy": "PACK", "num_gpus": 0, "_fake_gpus": false, "num_cpus_for_main_process": 2, "eager_tracing": true, "eager_max_retraces": 20, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "torch_compile_learner": false, "torch_compile_learner_what_to_compile": "forward_train", "torch_compile_learner_dynamo_backend": "aot_eager", "torch_compile_learner_dynamo_mode": null, "torch_compile_worker": false, "torch_compile_worker_dynamo_backend": "aot_eager", "torch_compile_worker_dynamo_mode": null, "torch_ddp_kwargs": {}, "torch_skip_nan_gradients": false, "env": "Umbrella", "env_config": {}, "observation_space": null, "action_space": null, "clip_rewards": null, "normalize_actions": true, "clip_actions": false, "_is_atari": null, "disable_env_checking": false, "render_env": false, "action_mask_key": "action_mask", "env_runner_cls": null, "num_env_runners": 0, "create_local_env_runner": true, "num_envs_per_env_runner": 1, "gym_env_vectorize_mode": "SYNC", "num_cpus_per_env_runner": 1, "num_gpus_per_env_runner": 0, "custom_resources_per_env_runner": {}, "validate_env_runners_after_construction": true, "episodes_to_numpy": true, "max_requests_in_flight_per_env_runner": 1, "sample_timeout_s": 60.0, "_env_to_module_connector": null, "add_default_connectors_to_env_to_module_pipeline": true, "_module_to_env_connector": null, "add_default_connectors_to_module_to_env_pipeline": true, "merge_env_runner_states": "training_only", "broadcast_env_runner_states": true, "episode_lookback_horizon": 1, "rollout_fragment_length": "auto", "batch_mode": "complete_episodes", "compress_observations": false, "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "enable_tf1_exec_eagerly": false, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "preprocessor_pref": "deepmind", "observation_filter": "NoFilter", "update_worker_filter_stats": true, "use_worker_filter_stats": true, "sampler_perf_stats_ema_coef": null, "_is_online": true, "num_learners": 0, "num_gpus_per_learner": 0, "num_cpus_per_learner": "auto", "num_aggregator_actors_per_learner": 0, "max_requests_in_flight_per_aggregator_actor": 3, "local_gpu_idx": 0, "max_requests_in_flight_per_learner": 3, "gamma": 1, "lr": 0.0002847858517, "grad_clip": 0.5, "grad_clip_by": "global_norm", "_train_batch_size_per_learner": 5000, "train_batch_size": 4000, "num_epochs": 1, "minibatch_size": 1000, "shuffle_batch_per_epoch": true, "model": {"fcnet_hiddens": [256, 256], "fcnet_activation": "tanh", "fcnet_weights_initializer": null, "fcnet_weights_initializer_config": null, "fcnet_bias_initializer": null, "fcnet_bias_initializer_config": null, "conv_filters": null, "conv_activation": "relu", "conv_kernel_initializer": null, "conv_kernel_initializer_config": null, "conv_bias_initializer": null, "conv_bias_initializer_config": null, "conv_transpose_kernel_initializer": null, "conv_transpose_kernel_initializer_config": null, "conv_transpose_bias_initializer": null, "conv_transpose_bias_initializer_config": null, "post_fcnet_hiddens": [], "post_fcnet_activation": "relu", "post_fcnet_weights_initializer": null, "post_fcnet_weights_initializer_config": null, "post_fcnet_bias_initializer": null, "post_fcnet_bias_initializer_config": null, "free_log_std": false, "log_std_clip_param": 20.0, "no_final_linear": false, "vf_share_layers": false, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "lstm_weights_initializer": null, "lstm_weights_initializer_config": null, "lstm_bias_initializer": null, "lstm_bias_initializer_config": null, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "attention_use_n_prev_actions": 0, "attention_use_n_prev_rewards": 0, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": null, "custom_model_config": {}, "custom_action_dist": null, "custom_preprocessor": null, "encoder_latent_dim": null, "always_check_shapes": false, "lstm_use_prev_action_reward": -1, "_use_default_native_models": -1, "_disable_preprocessor_api": false, "_disable_action_flattening": false}, "_learner_connector": null, "add_default_connectors_to_learner_pipeline": true, "learner_config_dict": {}, "optimizer": {}, "_learner_class": null, "callbacks_on_algorithm_init": null, "callbacks_on_env_runners_recreated": null, "callbacks_on_offline_eval_runners_recreated": null, "callbacks_on_checkpoint_loaded": null, "callbacks_on_environment_created": null, "callbacks_on_episode_created": null, "callbacks_on_episode_start": null, "callbacks_on_episode_step": null, "callbacks_on_episode_end": null, "callbacks_on_evaluate_start": null, "callbacks_on_evaluate_end": null, "callbacks_on_evaluate_offline_start": null, "callbacks_on_evaluate_offline_end": null, "callbacks_on_sample_end": null, "callbacks_on_train_result": null, "explore": true, "enable_rl_module_and_learner": true, "enable_env_runner_and_connector_v2": true, "_prior_exploration_config": {"type": "StochasticSampling"}, "count_steps_by": "env_steps", "policy_map_capacity": 100, "policy_mapping_fn": "<function AlgorithmConfig.DEFAULT_POLICY_MAPPING_FN at 0x17c065b20>", "policies_to_train": null, "policy_states_are_swappable": false, "observation_fn": null, "offline_data_class": null, "input_read_method": "read_parquet", "input_read_method_kwargs": {}, "input_read_schema": {}, "input_read_episodes": false, "input_read_sample_batches": false, "input_read_batch_size": null, "input_filesystem": null, "input_filesystem_kwargs": {}, "input_compress_columns": ["obs", "new_obs"], "input_spaces_jsonable": true, "materialize_data": false, "materialize_mapped_data": true, "map_batches_kwargs": {}, "iter_batches_kwargs": {}, "ignore_final_observation": false, "prelearner_class": null, "prelearner_buffer_class": null, "prelearner_buffer_kwargs": {}, "prelearner_module_synch_period": 10, "dataset_num_iters_per_learner": null, "input_config": {}, "actions_in_input_normalized": false, "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_config": {}, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "output_max_rows_per_file": null, "output_write_remaining_data": false, "output_write_method": "write_parquet", "output_write_method_kwargs": {}, "output_filesystem": null, "output_filesystem_kwargs": {}, "output_write_episodes": true, "offline_sampling": false, "evaluation_interval": 1, "evaluation_duration": 20, "evaluation_duration_unit": "episodes", "evaluation_sample_timeout_s": 120.0, "evaluation_auto_duration_min_env_steps_per_sample": 100, "evaluation_auto_duration_max_env_steps_per_sample": 2000, "evaluation_parallel_to_training": false, "evaluation_force_reset_envs_before_iteration": true, "evaluation_config": null, "off_policy_estimation_methods": {}, "ope_split_batch_by_episode": true, "evaluation_num_env_runners": 1, "in_evaluation": false, "sync_filters_on_rollout_workers_timeout_s": 10.0, "offline_evaluation_interval": null, "num_offline_eval_runners": 0, "offline_loss_for_module_fn": null, "offline_evaluation_duration": 1, "offline_evaluation_parallel_to_training": false, "offline_evaluation_timeout_s": 120.0, "num_cpus_per_offline_eval_runner": 1, "num_gpus_per_offline_eval_runner": 0, "custom_resources_per_offline_eval_runner": {}, "restart_failed_offline_eval_runners": true, "ignore_offline_eval_runner_failures": false, "max_num_offline_eval_runner_restarts": 1000, "offline_eval_runner_restore_timeout_s": 1800.0, "max_requests_in_flight_per_offline_eval_runner": 1, "validate_offline_eval_runners_after_construction": true, "offline_eval_runner_health_probe_timeout_s": 30.0, "offline_eval_rl_module_inference_only": false, "broadcast_offline_eval_runner_states": false, "offline_eval_batch_size_per_runner": 256, "dataset_num_iters_per_eval_runner": 1, "keep_per_episode_custom_metrics": false, "metrics_episode_collection_timeout_s": 60.0, "metrics_num_episodes_for_smoothing": 100, "min_time_s_per_iteration": null, "min_train_timesteps_per_iteration": 0, "min_sample_timesteps_per_iteration": 0, "log_gradients": true, "export_native_model_files": false, "checkpoint_trainable_policies_only": false, "logger_creator": null, "logger_config": null, "log_level": "WARN", "log_sys_usage": true, "fake_sampler": false, "seed": 5, "restart_failed_env_runners": true, "ignore_env_runner_failures": false, "max_num_env_runner_restarts": 1000, "delay_between_env_runner_restarts_s": 60.0, "restart_failed_sub_environments": false, "num_consecutive_env_runner_failures_tolerance": 100, "env_runner_health_probe_timeout_s": 30.0, "env_runner_restore_timeout_s": 1800.0, "_model_config": {}, "_rl_module_spec": "RLModuleSpec(module_class=None, observation_space=None, action_space=None, inference_only=False, learner_only=False, model_config=DefaultModelConfig(fcnet_hiddens=[60, 90], fcnet_activation='tanh', fcnet_kernel_initializer=None, fcnet_kernel_initializer_kwargs=None, fcnet_bias_initializer=None, fcnet_bias_initializer_kwargs=None, conv_filters=None, conv_activation='relu', conv_kernel_initializer=None, conv_kernel_initializer_kwargs=None, conv_bias_initializer=None, conv_bias_initializer_kwargs=None, head_fcnet_hiddens=[], head_fcnet_activation='relu', head_fcnet_kernel_initializer=None, head_fcnet_kernel_initializer_kwargs=None, head_fcnet_bias_initializer=None, head_fcnet_bias_initializer_kwargs=None, free_log_std=False, log_std_clip_param=20.0, vf_share_layers=True, use_lstm=False, max_seq_len=20, lstm_cell_size=256, lstm_use_prev_action=False, lstm_use_prev_reward=False, lstm_kernel_initializer=None, lstm_kernel_initializer_kwargs=None, lstm_bias_initializer=None, lstm_bias_initializer_kwargs=None), catalog_class=None, load_state_path=None, model_config_dict=None)", "algorithm_config_overrides_per_module": {}, "_per_module_overrides": {}, "_validate_config": true, "_use_msgpack_checkpoints": false, "_torch_grad_scaler_class": null, "_torch_lr_scheduler_classes": null, "_tf_policy_handles_more_than_one_loss": false, "_disable_preprocessor_api": false, "_disable_action_flattening": false, "_disable_initialize_loss_from_dummy_batch": false, "_dont_auto_sync_env_runner_states": false, "env_task_fn": -1, "enable_connectors": -1, "simple_optimizer": false, "policy_map_cache": -1, "worker_cls": -1, "synchronize_filters": -1, "enable_async_evaluation": -1, "custom_async_evaluation_function": -1, "_enable_rl_module_api": -1, "auto_wrap_old_gym_envs": -1, "always_attach_evaluation_results": -1, "replay_sequence_length": null, "_disable_execution_plan_api": -1, "use_critic": true, "use_gae": true, "use_kl_loss": true, "kl_coeff": 0.7464963036515, "kl_target": 0.0270990929592, "vf_loss_coeff": 0.6688075857018, "entropy_coeff": 0.0090570820258, "clip_param": 0.1221781641624, "vf_clip_param": 0.1027808522125, "entropy_coeff_schedule": null, "lr_schedule": null, "sgd_minibatch_size": -1, "vf_share_layers": -1, "__stdout_file__": null, "__stderr_file__": null, "lambda": 0.9099046732075, "input": "sampler", "policies": {"default_policy": [null, null, null, null]}, "callbacks": "<class 'ray.rllib.callbacks.callbacks.RLlibCallback'>", "create_env_on_driver": false, "custom_eval_function": null, "framework": "torch"}, "time_since_restore": 40.654151916503906, "iterations_since_restore": 20, "perf": {"cpu_util_percent": 17.6, "ram_util_percent": 76.75}}
