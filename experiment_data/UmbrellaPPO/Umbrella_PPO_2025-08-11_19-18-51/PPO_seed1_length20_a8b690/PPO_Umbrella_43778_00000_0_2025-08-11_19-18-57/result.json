{"timers": {"training_iteration": 1.922970375046134, "restore_env_runners": 1.237494871020317e-05, "training_step": 1.922820582985878, "env_runner_sampling_timer": 1.8050614580279216, "learner_update_timer": 0.1144181250128895, "synch_weights": 0.0007372079417109489}, "env_runners": {"env_to_module_connector": {"timers": {"connectors": {"add_observations_from_episodes_to_batch": 3.8077155869764604e-06, "batch_individual_items": 8.126913298472607e-06, "numpy_to_tensor": 1.2105424987880559e-05, "add_states_from_episodes_to_batch": 2.0010776503182475e-06, "add_time_dim_to_batch_and_zero_pad": 2.96170131532279e-06}}, "connector_pipeline_timer": 5.555191202163341e-05}, "episode_len_mean": 20.0, "sample": 0.007891099966331215, "module_to_env_connector": {"timers": {"connectors": {"get_actions": 5.746261837592272e-05, "un_batch_to_individual_items": 6.6921337648966885e-06, "normalize_and_clip_actions": 1.552204448283511e-05, "listify_data_for_vector_env": 1.3964374037733082e-05, "remove_single_ts_time_rank_from_batch": 7.124200844024939e-07, "tensor_to_numpy": 1.6884254763349942e-05}}, "connector_pipeline_timer": 0.00014239214194474163}, "num_module_steps_sampled": {"default_policy": 5000.0}, "num_agent_steps_sampled_lifetime": {"default_agent": 627500.0}, "num_env_steps_sampled": 5000.0, "episode_duration_sec_mean": 0.006042942699044942, "num_agent_steps_sampled": {"default_agent": 5000.0}, "env_to_module_sum_episodes_length_out": 10.191744832559449, "num_episodes": 250.0, "time_between_sampling": 0.0007138284733186717, "env_step_timer": 1.8982937984971008e-05, "agent_episode_returns_mean": {"default_agent": -0.09999999999999998}, "episode_return_mean": -0.09999999999999998, "num_module_steps_sampled_lifetime": {"default_policy": 627500.0}, "env_to_module_sum_episodes_length_in": 10.191744832559449, "episode_return_max": 9.5, "num_episodes_lifetime": 31375.0, "weights_seq_no": 0.0, "module_episode_returns_mean": {"default_policy": -0.09999999999999998}, "episode_return_min": -10.5, "episode_len_min": 20, "episode_len_max": 20, "env_reset_timer": 0.00011058681572128039, "num_env_steps_sampled_lifetime": 627500.0, "rlmodule_inference_timer": 6.0447169656625045e-05, "num_env_steps_sampled_lifetime_throughput": 2874.5049404893057}, "learners": {"__all_modules__": {"num_module_steps_trained_lifetime": 6000, "learner_connector_sum_episodes_length_in": 5000, "learner_connector": {"timers": {"connectors": {"add_observations_from_episodes_to_batch": 0.0008192090317606926, "batch_individual_items": 0.030750875012017787, "general_advantage_estimation": 0.008145083906129003, "add_one_ts_to_episodes_and_truncate": 0.0076514590764418244, "add_time_dim_to_batch_and_zero_pad": 1.2082979083061218e-05, "add_states_from_episodes_to_batch": 3.7919962778687477e-06, "add_columns_from_episodes_to_train_batch": 0.03426341596059501, "numpy_to_tensor": 7.216702215373516e-05}}, "connector_pipeline_timer": 0.08186529099475592}, "num_env_steps_trained": 31500, "num_env_steps_trained_lifetime": 31500, "num_non_trainable_parameters": 0, "learner_connector_sum_episodes_length_out": 5250, "num_module_steps_trained": 6000, "num_trainable_parameters": 6003, "num_env_steps_trained_lifetime_throughput": 1638669.3735277147, "num_module_steps_trained_throughput": 313465.0477349226, "num_module_steps_trained_lifetime_throughput": 312953.4771014813}, "default_policy": {"vf_loss": 0.10278083384037018, "curr_entropy_coeff": 0.0090570820258, "mean_kl_loss": 6.952471449039876e-05, "weights_seq_no": 1.0, "module_train_batch_size_mean": 1000.0, "vf_explained_var": -0.011646151542663574, "gradients_default_optimizer_global_norm": 0.026657981798052788, "diff_num_grad_updates_vs_sampler_policy": 1.0, "default_optimizer_learning_rate": 0.0002847858517, "curr_kl_coeff": 0.3732481598854065, "num_module_steps_trained": 6000, "num_trainable_parameters": 6003, "total_loss": 0.015051513910293579, "num_module_steps_trained_lifetime": 6000, "vf_loss_unclipped": 28.586095809936523, "policy_loss": -0.0474664680659771, "entropy": 0.6927757263183594, "num_module_steps_trained_lifetime_throughput": 314140.98106221575}}, "num_training_step_calls_per_iteration": 1, "num_env_steps_sampled_lifetime": 627500.0, "evaluation": {"env_runners": {"sample": 0.12186204094905406, "num_module_steps_sampled": {"default_policy": 400}, "env_to_module_connector": {"timers": {"connectors": {"add_observations_from_episodes_to_batch": 3.4409090600529597e-06, "numpy_to_tensor": 1.0958634266153598e-05, "batch_individual_items": 7.545289486816368e-06, "add_time_dim_to_batch_and_zero_pad": 2.877284654962968e-06, "add_states_from_episodes_to_batch": 1.9808689727094787e-06}}, "connector_pipeline_timer": 5.280558074674961e-05}, "num_agent_steps_sampled_lifetime": {"default_agent": 400}, "module_to_env_connector": {"timers": {"connectors": {"tensor_to_numpy": 2.143090976201689e-05, "get_actions": 5.562189592526291e-05, "listify_data_for_vector_env": 1.407842100369658e-05, "normalize_and_clip_actions": 1.4612069842513732e-05, "remove_single_ts_time_rank_from_batch": 7.92142037468462e-07, "un_batch_to_individual_items": 6.720969189119248e-06}}, "connector_pipeline_timer": 0.00014490382486071458}, "agent_episode_returns_mean": {"default_agent": 3.2}, "num_env_steps_sampled": 400, "env_to_module_sum_episodes_length_out": 10.216013141322508, "num_episodes": 20, "num_agent_steps_sampled": {"default_agent": 400}, "num_episodes_lifetime": 20, "weights_seq_no": 1.0, "env_reset_timer": 0.0001604169374331832, "module_episode_returns_mean": {"default_policy": 3.2}, "rlmodule_inference_timer": 3.882882742636194e-05, "env_to_module_sum_episodes_length_in": 10.216013141322508, "episode_return_max": 11.5, "episode_len_min": 20, "episode_len_mean": 20.0, "episode_duration_sec_mean": 0.0055713352980092164, "env_step_timer": 1.9232129881742383e-05, "episode_return_mean": 3.2, "num_module_steps_sampled_lifetime": {"default_policy": 400}, "episode_return_min": -12.5, "episode_len_max": 20, "num_env_steps_sampled_lifetime": 5400}, "num_healthy_workers": 1, "actor_manager_num_outstanding_async_reqs": 0, "num_remote_worker_restarts": 0}, "fault_tolerance": {"num_healthy_workers": 0, "num_remote_worker_restarts": 0}, "env_runner_group": {"actor_manager_num_outstanding_async_reqs": 0}, "done": false, "training_iteration": 1, "trial_id": "43778_00000", "date": "2025-08-11_19-20-07", "timestamp": 1754932807, "time_this_iter_s": 2.054654121398926, "time_total_s": 2.054654121398926, "pid": 14172, "hostname": "Mac", "node_ip": "127.0.0.1", "config": {"exploration_config": {}, "extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "placement_strategy": "PACK", "num_gpus": 0, "_fake_gpus": false, "num_cpus_for_main_process": 2, "eager_tracing": true, "eager_max_retraces": 20, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "torch_compile_learner": false, "torch_compile_learner_what_to_compile": "forward_train", "torch_compile_learner_dynamo_backend": "aot_eager", "torch_compile_learner_dynamo_mode": null, "torch_compile_worker": false, "torch_compile_worker_dynamo_backend": "aot_eager", "torch_compile_worker_dynamo_mode": null, "torch_ddp_kwargs": {}, "torch_skip_nan_gradients": false, "env": "Umbrella", "env_config": {}, "observation_space": null, "action_space": null, "clip_rewards": null, "normalize_actions": true, "clip_actions": false, "_is_atari": null, "disable_env_checking": false, "render_env": false, "action_mask_key": "action_mask", "env_runner_cls": null, "num_env_runners": 0, "create_local_env_runner": true, "num_envs_per_env_runner": 1, "gym_env_vectorize_mode": "SYNC", "num_cpus_per_env_runner": 1, "num_gpus_per_env_runner": 0, "custom_resources_per_env_runner": {}, "validate_env_runners_after_construction": true, "episodes_to_numpy": true, "max_requests_in_flight_per_env_runner": 1, "sample_timeout_s": 60.0, "_env_to_module_connector": null, "add_default_connectors_to_env_to_module_pipeline": true, "_module_to_env_connector": null, "add_default_connectors_to_module_to_env_pipeline": true, "merge_env_runner_states": "training_only", "broadcast_env_runner_states": true, "episode_lookback_horizon": 1, "rollout_fragment_length": "auto", "batch_mode": "complete_episodes", "compress_observations": false, "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "enable_tf1_exec_eagerly": false, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "preprocessor_pref": "deepmind", "observation_filter": "NoFilter", "update_worker_filter_stats": true, "use_worker_filter_stats": true, "sampler_perf_stats_ema_coef": null, "_is_online": true, "num_learners": 0, "num_gpus_per_learner": 0, "num_cpus_per_learner": "auto", "num_aggregator_actors_per_learner": 0, "max_requests_in_flight_per_aggregator_actor": 3, "local_gpu_idx": 0, "max_requests_in_flight_per_learner": 3, "gamma": 1, "lr": 0.0002847858517, "grad_clip": 0.5, "grad_clip_by": "global_norm", "_train_batch_size_per_learner": 5000, "train_batch_size": 4000, "num_epochs": 1, "minibatch_size": 1000, "shuffle_batch_per_epoch": true, "model": {"fcnet_hiddens": [256, 256], "fcnet_activation": "tanh", "fcnet_weights_initializer": null, "fcnet_weights_initializer_config": null, "fcnet_bias_initializer": null, "fcnet_bias_initializer_config": null, "conv_filters": null, "conv_activation": "relu", "conv_kernel_initializer": null, "conv_kernel_initializer_config": null, "conv_bias_initializer": null, "conv_bias_initializer_config": null, "conv_transpose_kernel_initializer": null, "conv_transpose_kernel_initializer_config": null, "conv_transpose_bias_initializer": null, "conv_transpose_bias_initializer_config": null, "post_fcnet_hiddens": [], "post_fcnet_activation": "relu", "post_fcnet_weights_initializer": null, "post_fcnet_weights_initializer_config": null, "post_fcnet_bias_initializer": null, "post_fcnet_bias_initializer_config": null, "free_log_std": false, "log_std_clip_param": 20.0, "no_final_linear": false, "vf_share_layers": false, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "lstm_weights_initializer": null, "lstm_weights_initializer_config": null, "lstm_bias_initializer": null, "lstm_bias_initializer_config": null, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "attention_use_n_prev_actions": 0, "attention_use_n_prev_rewards": 0, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": null, "custom_model_config": {}, "custom_action_dist": null, "custom_preprocessor": null, "encoder_latent_dim": null, "always_check_shapes": false, "lstm_use_prev_action_reward": -1, "_use_default_native_models": -1, "_disable_preprocessor_api": false, "_disable_action_flattening": false}, "_learner_connector": null, "add_default_connectors_to_learner_pipeline": true, "learner_config_dict": {}, "optimizer": {}, "_learner_class": null, "callbacks_on_algorithm_init": null, "callbacks_on_env_runners_recreated": null, "callbacks_on_offline_eval_runners_recreated": null, "callbacks_on_checkpoint_loaded": null, "callbacks_on_environment_created": null, "callbacks_on_episode_created": null, "callbacks_on_episode_start": null, "callbacks_on_episode_step": null, "callbacks_on_episode_end": null, "callbacks_on_evaluate_start": null, "callbacks_on_evaluate_end": null, "callbacks_on_evaluate_offline_start": null, "callbacks_on_evaluate_offline_end": null, "callbacks_on_sample_end": null, "callbacks_on_train_result": null, "explore": true, "enable_rl_module_and_learner": true, "enable_env_runner_and_connector_v2": true, "_prior_exploration_config": {"type": "StochasticSampling"}, "count_steps_by": "env_steps", "policy_map_capacity": 100, "policy_mapping_fn": "<function AlgorithmConfig.DEFAULT_POLICY_MAPPING_FN at 0x3888f18a0>", "policies_to_train": null, "policy_states_are_swappable": false, "observation_fn": null, "offline_data_class": null, "input_read_method": "read_parquet", "input_read_method_kwargs": {}, "input_read_schema": {}, "input_read_episodes": false, "input_read_sample_batches": false, "input_read_batch_size": null, "input_filesystem": null, "input_filesystem_kwargs": {}, "input_compress_columns": ["obs", "new_obs"], "input_spaces_jsonable": true, "materialize_data": false, "materialize_mapped_data": true, "map_batches_kwargs": {}, "iter_batches_kwargs": {}, "ignore_final_observation": false, "prelearner_class": null, "prelearner_buffer_class": null, "prelearner_buffer_kwargs": {}, "prelearner_module_synch_period": 10, "dataset_num_iters_per_learner": null, "input_config": {}, "actions_in_input_normalized": false, "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_config": {}, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "output_max_rows_per_file": null, "output_write_remaining_data": false, "output_write_method": "write_parquet", "output_write_method_kwargs": {}, "output_filesystem": null, "output_filesystem_kwargs": {}, "output_write_episodes": true, "offline_sampling": false, "evaluation_interval": 1, "evaluation_duration": 20, "evaluation_duration_unit": "episodes", "evaluation_sample_timeout_s": 120.0, "evaluation_auto_duration_min_env_steps_per_sample": 100, "evaluation_auto_duration_max_env_steps_per_sample": 2000, "evaluation_parallel_to_training": false, "evaluation_force_reset_envs_before_iteration": true, "evaluation_config": null, "off_policy_estimation_methods": {}, "ope_split_batch_by_episode": true, "evaluation_num_env_runners": 1, "in_evaluation": false, "sync_filters_on_rollout_workers_timeout_s": 10.0, "offline_evaluation_interval": null, "num_offline_eval_runners": 0, "offline_loss_for_module_fn": null, "offline_evaluation_duration": 1, "offline_evaluation_parallel_to_training": false, "offline_evaluation_timeout_s": 120.0, "num_cpus_per_offline_eval_runner": 1, "num_gpus_per_offline_eval_runner": 0, "custom_resources_per_offline_eval_runner": {}, "restart_failed_offline_eval_runners": true, "ignore_offline_eval_runner_failures": false, "max_num_offline_eval_runner_restarts": 1000, "offline_eval_runner_restore_timeout_s": 1800.0, "max_requests_in_flight_per_offline_eval_runner": 1, "validate_offline_eval_runners_after_construction": true, "offline_eval_runner_health_probe_timeout_s": 30.0, "offline_eval_rl_module_inference_only": false, "broadcast_offline_eval_runner_states": false, "offline_eval_batch_size_per_runner": 256, "dataset_num_iters_per_eval_runner": 1, "keep_per_episode_custom_metrics": false, "metrics_episode_collection_timeout_s": 60.0, "metrics_num_episodes_for_smoothing": 100, "min_time_s_per_iteration": null, "min_train_timesteps_per_iteration": 0, "min_sample_timesteps_per_iteration": 0, "log_gradients": true, "export_native_model_files": false, "checkpoint_trainable_policies_only": false, "logger_creator": null, "logger_config": null, "log_level": "WARN", "log_sys_usage": true, "fake_sampler": false, "seed": 1, "restart_failed_env_runners": true, "ignore_env_runner_failures": false, "max_num_env_runner_restarts": 1000, "delay_between_env_runner_restarts_s": 60.0, "restart_failed_sub_environments": false, "num_consecutive_env_runner_failures_tolerance": 100, "env_runner_health_probe_timeout_s": 30.0, "env_runner_restore_timeout_s": 1800.0, "_model_config": {}, "_rl_module_spec": "RLModuleSpec(module_class=None, observation_space=None, action_space=None, inference_only=False, learner_only=False, model_config=DefaultModelConfig(fcnet_hiddens=[60, 90], fcnet_activation='tanh', fcnet_kernel_initializer=None, fcnet_kernel_initializer_kwargs=None, fcnet_bias_initializer=None, fcnet_bias_initializer_kwargs=None, conv_filters=None, conv_activation='relu', conv_kernel_initializer=None, conv_kernel_initializer_kwargs=None, conv_bias_initializer=None, conv_bias_initializer_kwargs=None, head_fcnet_hiddens=[], head_fcnet_activation='relu', head_fcnet_kernel_initializer=None, head_fcnet_kernel_initializer_kwargs=None, head_fcnet_bias_initializer=None, head_fcnet_bias_initializer_kwargs=None, free_log_std=False, log_std_clip_param=20.0, vf_share_layers=True, use_lstm=False, max_seq_len=20, lstm_cell_size=256, lstm_use_prev_action=False, lstm_use_prev_reward=False, lstm_kernel_initializer=None, lstm_kernel_initializer_kwargs=None, lstm_bias_initializer=None, lstm_bias_initializer_kwargs=None), catalog_class=None, load_state_path=None, model_config_dict=None)", "algorithm_config_overrides_per_module": {}, "_per_module_overrides": {}, "_validate_config": true, "_use_msgpack_checkpoints": false, "_torch_grad_scaler_class": null, "_torch_lr_scheduler_classes": null, "_tf_policy_handles_more_than_one_loss": false, "_disable_preprocessor_api": false, "_disable_action_flattening": false, "_disable_initialize_loss_from_dummy_batch": false, "_dont_auto_sync_env_runner_states": false, "env_task_fn": -1, "enable_connectors": -1, "simple_optimizer": false, "policy_map_cache": -1, "worker_cls": -1, "synchronize_filters": -1, "enable_async_evaluation": -1, "custom_async_evaluation_function": -1, "_enable_rl_module_api": -1, "auto_wrap_old_gym_envs": -1, "always_attach_evaluation_results": -1, "replay_sequence_length": null, "_disable_execution_plan_api": -1, "use_critic": true, "use_gae": true, "use_kl_loss": true, "kl_coeff": 0.7464963036515, "kl_target": 0.0270990929592, "vf_loss_coeff": 0.6688075857018, "entropy_coeff": 0.0090570820258, "clip_param": 0.1221781641624, "vf_clip_param": 0.1027808522125, "entropy_coeff_schedule": null, "lr_schedule": null, "sgd_minibatch_size": -1, "vf_share_layers": -1, "__stdout_file__": null, "__stderr_file__": null, "lambda": 0.9099046732075, "input": "sampler", "policies": {"default_policy": [null, null, null, null]}, "callbacks": "<class 'ray.rllib.callbacks.callbacks.RLlibCallback'>", "create_env_on_driver": false, "custom_eval_function": null, "framework": "torch"}, "time_since_restore": 2.054654121398926, "iterations_since_restore": 1, "perf": {"cpu_util_percent": 41.666666666666664, "ram_util_percent": 80.8}}
{"timers": {"training_iteration": 1.9218132775451522, "restore_env_runners": 1.2334949569776655e-05, "training_step": 1.921660470905481, "env_runner_sampling_timer": 1.8029556655371561, "learner_update_timer": 0.11536653584335, "synch_weights": 0.000735214191954583, "restore_eval_env_runners": 8.958042599260807e-06, "evaluation_iteration": 0.12992137507535517, "synch_eval_env_connectors": 0.00011825002729892731, "synch_env_connectors": 5.624955520033836e-06}, "env_runners": {"env_to_module_connector": {"timers": {"connectors": {"add_observations_from_episodes_to_batch": 3.3438367875893496e-06, "batch_individual_items": 7.364705081421241e-06, "numpy_to_tensor": 1.0084630228299039e-05, "add_states_from_episodes_to_batch": 1.8993439630993886e-06, "add_time_dim_to_batch_and_zero_pad": 2.685273516274721e-06}}, "connector_pipeline_timer": 4.880377021367767e-05}, "episode_len_mean": 20.0, "sample": 0.006036907458397104, "module_to_env_connector": {"timers": {"connectors": {"get_actions": 4.705747209732618e-05, "un_batch_to_individual_items": 6.129027859508395e-06, "normalize_and_clip_actions": 1.0645955045796442e-05, "listify_data_for_vector_env": 1.2536984057353184e-05, "remove_single_ts_time_rank_from_batch": 6.468671108338429e-07, "tensor_to_numpy": 1.5301550918139045e-05}}, "connector_pipeline_timer": 0.00012022446796725264}, "num_module_steps_sampled": {"default_policy": 5000.0}, "num_agent_steps_sampled_lifetime": {"default_agent": 10000.0}, "num_env_steps_sampled": 5000.0, "episode_duration_sec_mean": 0.00521711572166532, "num_agent_steps_sampled": {"default_agent": 5000.0}, "env_to_module_sum_episodes_length_out": 10.36823839457432, "num_episodes": 250.0, "time_between_sampling": 0.001868043547141658, "env_step_timer": 1.616230824588852e-05, "agent_episode_returns_mean": {"default_agent": -0.8199999999999998}, "episode_return_mean": -0.8199999999999998, "num_module_steps_sampled_lifetime": {"default_policy": 10000.0}, "env_to_module_sum_episodes_length_in": 10.36823839457432, "episode_return_max": 9.5, "num_episodes_lifetime": 500.0, "weights_seq_no": 1.0, "module_episode_returns_mean": {"default_policy": -0.8199999999999998}, "episode_return_min": -10.5, "episode_len_min": 20, "episode_len_max": 20, "env_reset_timer": 5.7259091103836425e-05, "num_env_steps_sampled_lifetime": 10000.0, "rlmodule_inference_timer": 3.3231650098631185e-05, "num_env_steps_sampled_lifetime_throughput": 3263.1354312783715}, "learners": {"__all_modules__": {"num_module_steps_trained_lifetime": 12000, "learner_connector_sum_episodes_length_in": 5000.0, "learner_connector": {"timers": {"connectors": {"add_observations_from_episodes_to_batch": 0.0008197577821556478, "batch_individual_items": 0.03190133876283653, "general_advantage_estimation": 0.008118613486876711, "add_one_ts_to_episodes_and_truncate": 0.007655525315785781, "add_time_dim_to_batch_and_zero_pad": 1.2255068868398667e-05, "add_states_from_episodes_to_batch": 3.794495714828372e-06, "add_columns_from_episodes_to_train_batch": 0.03426799180102535, "numpy_to_tensor": 7.211202173493803e-05}}, "connector_pipeline_timer": 0.08299811100470833}, "num_env_steps_trained": 31500, "num_env_steps_trained_lifetime": 63000, "num_non_trainable_parameters": 0, "learner_connector_sum_episodes_length_out": 5250.0, "num_module_steps_trained": 6000, "num_trainable_parameters": 6003, "num_env_steps_trained_lifetime_throughput": 1646048.280670009, "num_module_steps_trained_throughput": 314856.75798256265, "num_module_steps_trained_lifetime_throughput": 314348.7664993223}, "default_policy": {"vf_loss": 0.10278083384037018, "curr_entropy_coeff": 0.0090570820258, "mean_kl_loss": 0.0015428205952048302, "weights_seq_no": 2.0, "module_train_batch_size_mean": 1000.0, "vf_explained_var": -0.012287616729736328, "gradients_default_optimizer_global_norm": 0.09095917642116547, "diff_num_grad_updates_vs_sampler_policy": 1.0, "default_optimizer_learning_rate": 0.0002847858517, "curr_kl_coeff": 0.18662407994270325, "num_module_steps_trained": 6000, "num_trainable_parameters": 6003, "total_loss": 0.08293826133012772, "num_module_steps_trained_lifetime": 12000, "vf_loss_unclipped": 28.918132781982422, "policy_loss": 0.01986965350806713, "entropy": 0.6898306608200073, "num_module_steps_trained_lifetime_throughput": 315512.7273933255}}, "num_training_step_calls_per_iteration": 1, "evaluation": {"env_runners": {"sample": 0.12168852594913915, "num_module_steps_sampled": {"default_policy": 400}, "env_to_module_connector": {"timers": {"connectors": {"add_observations_from_episodes_to_batch": 2.9847486093043034e-06, "numpy_to_tensor": 8.860623142412367e-06, "batch_individual_items": 7.140718925875512e-06, "add_time_dim_to_batch_and_zero_pad": 2.276490744033796e-06, "add_states_from_episodes_to_batch": 1.6453207136775307e-06}}, "connector_pipeline_timer": 4.504450805403101e-05}, "num_agent_steps_sampled_lifetime": {"default_agent": 800}, "module_to_env_connector": {"timers": {"connectors": {"tensor_to_numpy": 1.3964372909841018e-05, "get_actions": 4.084700348712553e-05, "listify_data_for_vector_env": 1.1456994032328809e-05, "normalize_and_clip_actions": 9.745030797455141e-06, "remove_single_ts_time_rank_from_batch": 5.761024335314179e-07, "un_batch_to_individual_items": 5.55268419875361e-06}}, "connector_pipeline_timer": 0.00010898446278382625}, "agent_episode_returns_mean": {"default_agent": 2.2}, "num_env_steps_sampled": 400, "env_to_module_sum_episodes_length_out": 10.366003441359926, "num_episodes": 20, "num_agent_steps_sampled": {"default_agent": 400}, "num_episodes_lifetime": 40, "weights_seq_no": 2.0, "env_reset_timer": 0.000160008188104257, "module_episode_returns_mean": {"default_policy": 2.2}, "rlmodule_inference_timer": 3.0187714899556187e-05, "env_to_module_sum_episodes_length_in": 10.366003441359926, "episode_return_max": 11.5, "episode_len_min": 20, "episode_len_mean": 20.0, "episode_duration_sec_mean": 0.0051674114161869514, "env_step_timer": 1.479572431638517e-05, "episode_return_mean": 2.2, "num_module_steps_sampled_lifetime": {"default_policy": 800}, "episode_return_min": -12.5, "episode_len_max": 20, "num_env_steps_sampled_lifetime": 10400, "time_between_sampling": 1.8813598329434171}, "num_healthy_workers": 1, "actor_manager_num_outstanding_async_reqs": 0, "num_remote_worker_restarts": 0}, "num_env_steps_sampled_lifetime": 10000.0, "fault_tolerance": {"num_healthy_workers": 0, "num_remote_worker_restarts": 0}, "env_runner_group": {"actor_manager_num_outstanding_async_reqs": 0}, "done": false, "training_iteration": 2, "trial_id": "43778_00000", "date": "2025-08-11_19-20-09", "timestamp": 1754932809, "time_this_iter_s": 1.9194447994232178, "time_total_s": 3.9740989208221436, "pid": 14172, "hostname": "Mac", "node_ip": "127.0.0.1", "config": {"exploration_config": {}, "extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "placement_strategy": "PACK", "num_gpus": 0, "_fake_gpus": false, "num_cpus_for_main_process": 2, "eager_tracing": true, "eager_max_retraces": 20, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "torch_compile_learner": false, "torch_compile_learner_what_to_compile": "forward_train", "torch_compile_learner_dynamo_backend": "aot_eager", "torch_compile_learner_dynamo_mode": null, "torch_compile_worker": false, "torch_compile_worker_dynamo_backend": "aot_eager", "torch_compile_worker_dynamo_mode": null, "torch_ddp_kwargs": {}, "torch_skip_nan_gradients": false, "env": "Umbrella", "env_config": {}, "observation_space": null, "action_space": null, "clip_rewards": null, "normalize_actions": true, "clip_actions": false, "_is_atari": null, "disable_env_checking": false, "render_env": false, "action_mask_key": "action_mask", "env_runner_cls": null, "num_env_runners": 0, "create_local_env_runner": true, "num_envs_per_env_runner": 1, "gym_env_vectorize_mode": "SYNC", "num_cpus_per_env_runner": 1, "num_gpus_per_env_runner": 0, "custom_resources_per_env_runner": {}, "validate_env_runners_after_construction": true, "episodes_to_numpy": true, "max_requests_in_flight_per_env_runner": 1, "sample_timeout_s": 60.0, "_env_to_module_connector": null, "add_default_connectors_to_env_to_module_pipeline": true, "_module_to_env_connector": null, "add_default_connectors_to_module_to_env_pipeline": true, "merge_env_runner_states": "training_only", "broadcast_env_runner_states": true, "episode_lookback_horizon": 1, "rollout_fragment_length": "auto", "batch_mode": "complete_episodes", "compress_observations": false, "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "enable_tf1_exec_eagerly": false, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "preprocessor_pref": "deepmind", "observation_filter": "NoFilter", "update_worker_filter_stats": true, "use_worker_filter_stats": true, "sampler_perf_stats_ema_coef": null, "_is_online": true, "num_learners": 0, "num_gpus_per_learner": 0, "num_cpus_per_learner": "auto", "num_aggregator_actors_per_learner": 0, "max_requests_in_flight_per_aggregator_actor": 3, "local_gpu_idx": 0, "max_requests_in_flight_per_learner": 3, "gamma": 1, "lr": 0.0002847858517, "grad_clip": 0.5, "grad_clip_by": "global_norm", "_train_batch_size_per_learner": 5000, "train_batch_size": 4000, "num_epochs": 1, "minibatch_size": 1000, "shuffle_batch_per_epoch": true, "model": {"fcnet_hiddens": [256, 256], "fcnet_activation": "tanh", "fcnet_weights_initializer": null, "fcnet_weights_initializer_config": null, "fcnet_bias_initializer": null, "fcnet_bias_initializer_config": null, "conv_filters": null, "conv_activation": "relu", "conv_kernel_initializer": null, "conv_kernel_initializer_config": null, "conv_bias_initializer": null, "conv_bias_initializer_config": null, "conv_transpose_kernel_initializer": null, "conv_transpose_kernel_initializer_config": null, "conv_transpose_bias_initializer": null, "conv_transpose_bias_initializer_config": null, "post_fcnet_hiddens": [], "post_fcnet_activation": "relu", "post_fcnet_weights_initializer": null, "post_fcnet_weights_initializer_config": null, "post_fcnet_bias_initializer": null, "post_fcnet_bias_initializer_config": null, "free_log_std": false, "log_std_clip_param": 20.0, "no_final_linear": false, "vf_share_layers": false, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "lstm_weights_initializer": null, "lstm_weights_initializer_config": null, "lstm_bias_initializer": null, "lstm_bias_initializer_config": null, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "attention_use_n_prev_actions": 0, "attention_use_n_prev_rewards": 0, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": null, "custom_model_config": {}, "custom_action_dist": null, "custom_preprocessor": null, "encoder_latent_dim": null, "always_check_shapes": false, "lstm_use_prev_action_reward": -1, "_use_default_native_models": -1, "_disable_preprocessor_api": false, "_disable_action_flattening": false}, "_learner_connector": null, "add_default_connectors_to_learner_pipeline": true, "learner_config_dict": {}, "optimizer": {}, "_learner_class": null, "callbacks_on_algorithm_init": null, "callbacks_on_env_runners_recreated": null, "callbacks_on_offline_eval_runners_recreated": null, "callbacks_on_checkpoint_loaded": null, "callbacks_on_environment_created": null, "callbacks_on_episode_created": null, "callbacks_on_episode_start": null, "callbacks_on_episode_step": null, "callbacks_on_episode_end": null, "callbacks_on_evaluate_start": null, "callbacks_on_evaluate_end": null, "callbacks_on_evaluate_offline_start": null, "callbacks_on_evaluate_offline_end": null, "callbacks_on_sample_end": null, "callbacks_on_train_result": null, "explore": true, "enable_rl_module_and_learner": true, "enable_env_runner_and_connector_v2": true, "_prior_exploration_config": {"type": "StochasticSampling"}, "count_steps_by": "env_steps", "policy_map_capacity": 100, "policy_mapping_fn": "<function AlgorithmConfig.DEFAULT_POLICY_MAPPING_FN at 0x3888f18a0>", "policies_to_train": null, "policy_states_are_swappable": false, "observation_fn": null, "offline_data_class": null, "input_read_method": "read_parquet", "input_read_method_kwargs": {}, "input_read_schema": {}, "input_read_episodes": false, "input_read_sample_batches": false, "input_read_batch_size": null, "input_filesystem": null, "input_filesystem_kwargs": {}, "input_compress_columns": ["obs", "new_obs"], "input_spaces_jsonable": true, "materialize_data": false, "materialize_mapped_data": true, "map_batches_kwargs": {}, "iter_batches_kwargs": {}, "ignore_final_observation": false, "prelearner_class": null, "prelearner_buffer_class": null, "prelearner_buffer_kwargs": {}, "prelearner_module_synch_period": 10, "dataset_num_iters_per_learner": null, "input_config": {}, "actions_in_input_normalized": false, "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_config": {}, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "output_max_rows_per_file": null, "output_write_remaining_data": false, "output_write_method": "write_parquet", "output_write_method_kwargs": {}, "output_filesystem": null, "output_filesystem_kwargs": {}, "output_write_episodes": true, "offline_sampling": false, "evaluation_interval": 1, "evaluation_duration": 20, "evaluation_duration_unit": "episodes", "evaluation_sample_timeout_s": 120.0, "evaluation_auto_duration_min_env_steps_per_sample": 100, "evaluation_auto_duration_max_env_steps_per_sample": 2000, "evaluation_parallel_to_training": false, "evaluation_force_reset_envs_before_iteration": true, "evaluation_config": null, "off_policy_estimation_methods": {}, "ope_split_batch_by_episode": true, "evaluation_num_env_runners": 1, "in_evaluation": false, "sync_filters_on_rollout_workers_timeout_s": 10.0, "offline_evaluation_interval": null, "num_offline_eval_runners": 0, "offline_loss_for_module_fn": null, "offline_evaluation_duration": 1, "offline_evaluation_parallel_to_training": false, "offline_evaluation_timeout_s": 120.0, "num_cpus_per_offline_eval_runner": 1, "num_gpus_per_offline_eval_runner": 0, "custom_resources_per_offline_eval_runner": {}, "restart_failed_offline_eval_runners": true, "ignore_offline_eval_runner_failures": false, "max_num_offline_eval_runner_restarts": 1000, "offline_eval_runner_restore_timeout_s": 1800.0, "max_requests_in_flight_per_offline_eval_runner": 1, "validate_offline_eval_runners_after_construction": true, "offline_eval_runner_health_probe_timeout_s": 30.0, "offline_eval_rl_module_inference_only": false, "broadcast_offline_eval_runner_states": false, "offline_eval_batch_size_per_runner": 256, "dataset_num_iters_per_eval_runner": 1, "keep_per_episode_custom_metrics": false, "metrics_episode_collection_timeout_s": 60.0, "metrics_num_episodes_for_smoothing": 100, "min_time_s_per_iteration": null, "min_train_timesteps_per_iteration": 0, "min_sample_timesteps_per_iteration": 0, "log_gradients": true, "export_native_model_files": false, "checkpoint_trainable_policies_only": false, "logger_creator": null, "logger_config": null, "log_level": "WARN", "log_sys_usage": true, "fake_sampler": false, "seed": 1, "restart_failed_env_runners": true, "ignore_env_runner_failures": false, "max_num_env_runner_restarts": 1000, "delay_between_env_runner_restarts_s": 60.0, "restart_failed_sub_environments": false, "num_consecutive_env_runner_failures_tolerance": 100, "env_runner_health_probe_timeout_s": 30.0, "env_runner_restore_timeout_s": 1800.0, "_model_config": {}, "_rl_module_spec": "RLModuleSpec(module_class=None, observation_space=None, action_space=None, inference_only=False, learner_only=False, model_config=DefaultModelConfig(fcnet_hiddens=[60, 90], fcnet_activation='tanh', fcnet_kernel_initializer=None, fcnet_kernel_initializer_kwargs=None, fcnet_bias_initializer=None, fcnet_bias_initializer_kwargs=None, conv_filters=None, conv_activation='relu', conv_kernel_initializer=None, conv_kernel_initializer_kwargs=None, conv_bias_initializer=None, conv_bias_initializer_kwargs=None, head_fcnet_hiddens=[], head_fcnet_activation='relu', head_fcnet_kernel_initializer=None, head_fcnet_kernel_initializer_kwargs=None, head_fcnet_bias_initializer=None, head_fcnet_bias_initializer_kwargs=None, free_log_std=False, log_std_clip_param=20.0, vf_share_layers=True, use_lstm=False, max_seq_len=20, lstm_cell_size=256, lstm_use_prev_action=False, lstm_use_prev_reward=False, lstm_kernel_initializer=None, lstm_kernel_initializer_kwargs=None, lstm_bias_initializer=None, lstm_bias_initializer_kwargs=None), catalog_class=None, load_state_path=None, model_config_dict=None)", "algorithm_config_overrides_per_module": {}, "_per_module_overrides": {}, "_validate_config": true, "_use_msgpack_checkpoints": false, "_torch_grad_scaler_class": null, "_torch_lr_scheduler_classes": null, "_tf_policy_handles_more_than_one_loss": false, "_disable_preprocessor_api": false, "_disable_action_flattening": false, "_disable_initialize_loss_from_dummy_batch": false, "_dont_auto_sync_env_runner_states": false, "env_task_fn": -1, "enable_connectors": -1, "simple_optimizer": false, "policy_map_cache": -1, "worker_cls": -1, "synchronize_filters": -1, "enable_async_evaluation": -1, "custom_async_evaluation_function": -1, "_enable_rl_module_api": -1, "auto_wrap_old_gym_envs": -1, "always_attach_evaluation_results": -1, "replay_sequence_length": null, "_disable_execution_plan_api": -1, "use_critic": true, "use_gae": true, "use_kl_loss": true, "kl_coeff": 0.7464963036515, "kl_target": 0.0270990929592, "vf_loss_coeff": 0.6688075857018, "entropy_coeff": 0.0090570820258, "clip_param": 0.1221781641624, "vf_clip_param": 0.1027808522125, "entropy_coeff_schedule": null, "lr_schedule": null, "sgd_minibatch_size": -1, "vf_share_layers": -1, "__stdout_file__": null, "__stderr_file__": null, "lambda": 0.9099046732075, "input": "sampler", "policies": {"default_policy": [null, null, null, null]}, "callbacks": "<class 'ray.rllib.callbacks.callbacks.RLlibCallback'>", "create_env_on_driver": false, "custom_eval_function": null, "framework": "torch"}, "time_since_restore": 3.9740989208221436, "iterations_since_restore": 2, "perf": {"cpu_util_percent": 53.300000000000004, "ram_util_percent": 81.36666666666666}}
{"timers": {"training_iteration": 1.9184465664402233, "restore_env_runners": 1.2287850945722312e-05, "training_step": 1.9182930095364457, "env_runner_sampling_timer": 1.7997396497122942, "learner_update_timer": 0.11521542965434492, "synch_weights": 0.0007335974708897993, "restore_eval_env_runners": 8.941381238400935e-06, "evaluation_iteration": 0.12972375966375693, "synch_eval_env_connectors": 0.00011811669799499215, "synch_env_connectors": 5.6137063074857e-06}, "env_runners": {"env_to_module_connector": {"timers": {"connectors": {"add_observations_from_episodes_to_batch": 3.0708002905491504e-06, "batch_individual_items": 6.705174426403947e-06, "numpy_to_tensor": 9.015137224703478e-06, "add_states_from_episodes_to_batch": 1.8249498929982017e-06, "add_time_dim_to_batch_and_zero_pad": 2.480552251224481e-06}}, "connector_pipeline_timer": 4.5553041276323474e-05}, "episode_len_mean": 20.0, "sample": 0.005433356268942145, "module_to_env_connector": {"timers": {"connectors": {"get_actions": 4.221760239674673e-05, "un_batch_to_individual_items": 5.681644823539708e-06, "normalize_and_clip_actions": 9.798974797105474e-06, "listify_data_for_vector_env": 1.168981764783273e-05, "remove_single_ts_time_rank_from_batch": 6.208414346326152e-07, "tensor_to_numpy": 1.4007673729582369e-05}}, "connector_pipeline_timer": 0.0001100784275996059}, "num_module_steps_sampled": {"default_policy": 5000.0}, "num_agent_steps_sampled_lifetime": {"default_agent": -607500.0}, "num_env_steps_sampled": 5000.0, "episode_duration_sec_mean": 0.004842359812464565, "num_agent_steps_sampled": {"default_agent": 5000.0}, "env_to_module_sum_episodes_length_out": 10.36823839457432, "num_episodes": 250.0, "time_between_sampling": 0.0020353447522819795, "env_step_timer": 1.463783864476205e-05, "agent_episode_returns_mean": {"default_agent": 0.22}, "episode_return_mean": 0.22, "num_module_steps_sampled_lifetime": {"default_policy": -607500.0}, "env_to_module_sum_episodes_length_in": 10.36823839457432, "episode_return_max": 9.5, "num_episodes_lifetime": -30375.0, "weights_seq_no": 2.0, "module_episode_returns_mean": {"default_policy": 0.22}, "episode_return_min": -10.5, "episode_len_min": 20, "episode_len_max": 20, "env_reset_timer": 4.301507856350543e-05, "num_env_steps_sampled_lifetime": -607500.0, "rlmodule_inference_timer": 3.0941995045634424e-05, "num_env_steps_sampled_lifetime_throughput": 3610.353289068168}, "learners": {"__all_modules__": {"num_module_steps_trained_lifetime": 18000, "learner_connector_sum_episodes_length_in": 5000.0, "learner_connector": {"timers": {"connectors": {"add_observations_from_episodes_to_batch": 0.0008214647838263772, "batch_individual_items": 0.031902537454885894, "general_advantage_estimation": 0.008091491941793356, "add_one_ts_to_episodes_and_truncate": 0.00766371048319852, "add_time_dim_to_batch_and_zero_pad": 1.227293834090233e-05, "add_states_from_episodes_to_batch": 3.7894602050073445e-06, "add_columns_from_episodes_to_train_batch": 0.03428526647252729, "numpy_to_tensor": 7.208673103014008e-05}}, "connector_pipeline_timer": 0.08299910739437909}, "num_env_steps_trained": 31500, "num_env_steps_trained_lifetime": 94500, "num_non_trainable_parameters": 0, "learner_connector_sum_episodes_length_out": 5250.0, "num_module_steps_trained": 6000, "num_trainable_parameters": 6003, "num_env_steps_trained_lifetime_throughput": 1655078.1910228503, "num_module_steps_trained_throughput": 316549.26875912206, "num_module_steps_trained_lifetime_throughput": 316049.78677676927}, "default_policy": {"vf_loss": 0.10278083384037018, "curr_entropy_coeff": 0.0090570820258, "mean_kl_loss": 0.0014687618240714073, "weights_seq_no": 3.0, "module_train_batch_size_mean": 1000.0, "vf_explained_var": -0.014024496078491211, "gradients_default_optimizer_global_norm": 0.04352671653032303, "diff_num_grad_updates_vs_sampler_policy": 1.0, "default_optimizer_learning_rate": 0.0002847858517, "curr_kl_coeff": 0.09331203997135162, "num_module_steps_trained": 6000, "num_trainable_parameters": 6003, "total_loss": 0.11864931136369705, "num_module_steps_trained_lifetime": 18000, "vf_loss_unclipped": 28.84691619873047, "policy_loss": 0.05581562593579292, "entropy": 0.6824526190757751, "num_module_steps_trained_lifetime_throughput": 317175.95203011646}}, "num_training_step_calls_per_iteration": 1, "evaluation": {"env_runners": {"sample": 0.12155935110931751, "num_module_steps_sampled": {"default_policy": 400}, "env_to_module_connector": {"timers": {"connectors": {"add_observations_from_episodes_to_batch": 3.0105253867052076e-06, "numpy_to_tensor": 9.201906293198558e-06, "batch_individual_items": 6.542747750047272e-06, "add_time_dim_to_batch_and_zero_pad": 2.360114687443893e-06, "add_states_from_episodes_to_batch": 1.805481358815581e-06}}, "connector_pipeline_timer": 4.574787850262228e-05}, "num_agent_steps_sampled_lifetime": {"default_agent": 1200}, "module_to_env_connector": {"timers": {"connectors": {"tensor_to_numpy": 1.498303997315448e-05, "get_actions": 4.0554873463566265e-05, "listify_data_for_vector_env": 1.163209331050955e-05, "normalize_and_clip_actions": 1.0182533830388004e-05, "remove_single_ts_time_rank_from_batch": 6.016993876530059e-07, "un_batch_to_individual_items": 6.2035869817083934e-06}}, "connector_pipeline_timer": 0.00011185416474393429}, "agent_episode_returns_mean": {"default_agent": 1.8666666666666667}, "num_env_steps_sampled": 400, "env_to_module_sum_episodes_length_out": 10.368205581254823, "num_episodes": 20, "num_agent_steps_sampled": {"default_agent": 400}, "num_episodes_lifetime": 60, "weights_seq_no": 3.0, "env_reset_timer": 0.0001592101868358441, "module_episode_returns_mean": {"default_policy": 1.8666666666666667}, "rlmodule_inference_timer": 3.039566336694884e-05, "env_to_module_sum_episodes_length_in": 10.368205581254823, "episode_return_max": 11.5, "episode_len_min": 20, "episode_len_mean": 20.0, "episode_duration_sec_mean": 0.005100929137552157, "env_step_timer": 1.533159415673513e-05, "episode_return_mean": 1.8666666666666667, "num_module_steps_sampled_lifetime": {"default_policy": 1200}, "episode_return_min": -12.5, "episode_len_max": 20, "num_env_steps_sampled_lifetime": 15400, "time_between_sampling": 1.8786142433644273}, "num_healthy_workers": 1, "actor_manager_num_outstanding_async_reqs": 0, "num_remote_worker_restarts": 0}, "num_env_steps_sampled_lifetime": -607500.0, "fault_tolerance": {"num_healthy_workers": 0, "num_remote_worker_restarts": 0}, "env_runner_group": {"actor_manager_num_outstanding_async_reqs": 0}, "done": false, "training_iteration": 3, "trial_id": "43778_00000", "date": "2025-08-11_19-20-11", "timestamp": 1754932811, "time_this_iter_s": 1.7017910480499268, "time_total_s": 5.67588996887207, "pid": 14172, "hostname": "Mac", "node_ip": "127.0.0.1", "config": {"exploration_config": {}, "extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "placement_strategy": "PACK", "num_gpus": 0, "_fake_gpus": false, "num_cpus_for_main_process": 2, "eager_tracing": true, "eager_max_retraces": 20, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "torch_compile_learner": false, "torch_compile_learner_what_to_compile": "forward_train", "torch_compile_learner_dynamo_backend": "aot_eager", "torch_compile_learner_dynamo_mode": null, "torch_compile_worker": false, "torch_compile_worker_dynamo_backend": "aot_eager", "torch_compile_worker_dynamo_mode": null, "torch_ddp_kwargs": {}, "torch_skip_nan_gradients": false, "env": "Umbrella", "env_config": {}, "observation_space": null, "action_space": null, "clip_rewards": null, "normalize_actions": true, "clip_actions": false, "_is_atari": null, "disable_env_checking": false, "render_env": false, "action_mask_key": "action_mask", "env_runner_cls": null, "num_env_runners": 0, "create_local_env_runner": true, "num_envs_per_env_runner": 1, "gym_env_vectorize_mode": "SYNC", "num_cpus_per_env_runner": 1, "num_gpus_per_env_runner": 0, "custom_resources_per_env_runner": {}, "validate_env_runners_after_construction": true, "episodes_to_numpy": true, "max_requests_in_flight_per_env_runner": 1, "sample_timeout_s": 60.0, "_env_to_module_connector": null, "add_default_connectors_to_env_to_module_pipeline": true, "_module_to_env_connector": null, "add_default_connectors_to_module_to_env_pipeline": true, "merge_env_runner_states": "training_only", "broadcast_env_runner_states": true, "episode_lookback_horizon": 1, "rollout_fragment_length": "auto", "batch_mode": "complete_episodes", "compress_observations": false, "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "enable_tf1_exec_eagerly": false, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "preprocessor_pref": "deepmind", "observation_filter": "NoFilter", "update_worker_filter_stats": true, "use_worker_filter_stats": true, "sampler_perf_stats_ema_coef": null, "_is_online": true, "num_learners": 0, "num_gpus_per_learner": 0, "num_cpus_per_learner": "auto", "num_aggregator_actors_per_learner": 0, "max_requests_in_flight_per_aggregator_actor": 3, "local_gpu_idx": 0, "max_requests_in_flight_per_learner": 3, "gamma": 1, "lr": 0.0002847858517, "grad_clip": 0.5, "grad_clip_by": "global_norm", "_train_batch_size_per_learner": 5000, "train_batch_size": 4000, "num_epochs": 1, "minibatch_size": 1000, "shuffle_batch_per_epoch": true, "model": {"fcnet_hiddens": [256, 256], "fcnet_activation": "tanh", "fcnet_weights_initializer": null, "fcnet_weights_initializer_config": null, "fcnet_bias_initializer": null, "fcnet_bias_initializer_config": null, "conv_filters": null, "conv_activation": "relu", "conv_kernel_initializer": null, "conv_kernel_initializer_config": null, "conv_bias_initializer": null, "conv_bias_initializer_config": null, "conv_transpose_kernel_initializer": null, "conv_transpose_kernel_initializer_config": null, "conv_transpose_bias_initializer": null, "conv_transpose_bias_initializer_config": null, "post_fcnet_hiddens": [], "post_fcnet_activation": "relu", "post_fcnet_weights_initializer": null, "post_fcnet_weights_initializer_config": null, "post_fcnet_bias_initializer": null, "post_fcnet_bias_initializer_config": null, "free_log_std": false, "log_std_clip_param": 20.0, "no_final_linear": false, "vf_share_layers": false, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "lstm_weights_initializer": null, "lstm_weights_initializer_config": null, "lstm_bias_initializer": null, "lstm_bias_initializer_config": null, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "attention_use_n_prev_actions": 0, "attention_use_n_prev_rewards": 0, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": null, "custom_model_config": {}, "custom_action_dist": null, "custom_preprocessor": null, "encoder_latent_dim": null, "always_check_shapes": false, "lstm_use_prev_action_reward": -1, "_use_default_native_models": -1, "_disable_preprocessor_api": false, "_disable_action_flattening": false}, "_learner_connector": null, "add_default_connectors_to_learner_pipeline": true, "learner_config_dict": {}, "optimizer": {}, "_learner_class": null, "callbacks_on_algorithm_init": null, "callbacks_on_env_runners_recreated": null, "callbacks_on_offline_eval_runners_recreated": null, "callbacks_on_checkpoint_loaded": null, "callbacks_on_environment_created": null, "callbacks_on_episode_created": null, "callbacks_on_episode_start": null, "callbacks_on_episode_step": null, "callbacks_on_episode_end": null, "callbacks_on_evaluate_start": null, "callbacks_on_evaluate_end": null, "callbacks_on_evaluate_offline_start": null, "callbacks_on_evaluate_offline_end": null, "callbacks_on_sample_end": null, "callbacks_on_train_result": null, "explore": true, "enable_rl_module_and_learner": true, "enable_env_runner_and_connector_v2": true, "_prior_exploration_config": {"type": "StochasticSampling"}, "count_steps_by": "env_steps", "policy_map_capacity": 100, "policy_mapping_fn": "<function AlgorithmConfig.DEFAULT_POLICY_MAPPING_FN at 0x3888f18a0>", "policies_to_train": null, "policy_states_are_swappable": false, "observation_fn": null, "offline_data_class": null, "input_read_method": "read_parquet", "input_read_method_kwargs": {}, "input_read_schema": {}, "input_read_episodes": false, "input_read_sample_batches": false, "input_read_batch_size": null, "input_filesystem": null, "input_filesystem_kwargs": {}, "input_compress_columns": ["obs", "new_obs"], "input_spaces_jsonable": true, "materialize_data": false, "materialize_mapped_data": true, "map_batches_kwargs": {}, "iter_batches_kwargs": {}, "ignore_final_observation": false, "prelearner_class": null, "prelearner_buffer_class": null, "prelearner_buffer_kwargs": {}, "prelearner_module_synch_period": 10, "dataset_num_iters_per_learner": null, "input_config": {}, "actions_in_input_normalized": false, "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_config": {}, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "output_max_rows_per_file": null, "output_write_remaining_data": false, "output_write_method": "write_parquet", "output_write_method_kwargs": {}, "output_filesystem": null, "output_filesystem_kwargs": {}, "output_write_episodes": true, "offline_sampling": false, "evaluation_interval": 1, "evaluation_duration": 20, "evaluation_duration_unit": "episodes", "evaluation_sample_timeout_s": 120.0, "evaluation_auto_duration_min_env_steps_per_sample": 100, "evaluation_auto_duration_max_env_steps_per_sample": 2000, "evaluation_parallel_to_training": false, "evaluation_force_reset_envs_before_iteration": true, "evaluation_config": null, "off_policy_estimation_methods": {}, "ope_split_batch_by_episode": true, "evaluation_num_env_runners": 1, "in_evaluation": false, "sync_filters_on_rollout_workers_timeout_s": 10.0, "offline_evaluation_interval": null, "num_offline_eval_runners": 0, "offline_loss_for_module_fn": null, "offline_evaluation_duration": 1, "offline_evaluation_parallel_to_training": false, "offline_evaluation_timeout_s": 120.0, "num_cpus_per_offline_eval_runner": 1, "num_gpus_per_offline_eval_runner": 0, "custom_resources_per_offline_eval_runner": {}, "restart_failed_offline_eval_runners": true, "ignore_offline_eval_runner_failures": false, "max_num_offline_eval_runner_restarts": 1000, "offline_eval_runner_restore_timeout_s": 1800.0, "max_requests_in_flight_per_offline_eval_runner": 1, "validate_offline_eval_runners_after_construction": true, "offline_eval_runner_health_probe_timeout_s": 30.0, "offline_eval_rl_module_inference_only": false, "broadcast_offline_eval_runner_states": false, "offline_eval_batch_size_per_runner": 256, "dataset_num_iters_per_eval_runner": 1, "keep_per_episode_custom_metrics": false, "metrics_episode_collection_timeout_s": 60.0, "metrics_num_episodes_for_smoothing": 100, "min_time_s_per_iteration": null, "min_train_timesteps_per_iteration": 0, "min_sample_timesteps_per_iteration": 0, "log_gradients": true, "export_native_model_files": false, "checkpoint_trainable_policies_only": false, "logger_creator": null, "logger_config": null, "log_level": "WARN", "log_sys_usage": true, "fake_sampler": false, "seed": 1, "restart_failed_env_runners": true, "ignore_env_runner_failures": false, "max_num_env_runner_restarts": 1000, "delay_between_env_runner_restarts_s": 60.0, "restart_failed_sub_environments": false, "num_consecutive_env_runner_failures_tolerance": 100, "env_runner_health_probe_timeout_s": 30.0, "env_runner_restore_timeout_s": 1800.0, "_model_config": {}, "_rl_module_spec": "RLModuleSpec(module_class=None, observation_space=None, action_space=None, inference_only=False, learner_only=False, model_config=DefaultModelConfig(fcnet_hiddens=[60, 90], fcnet_activation='tanh', fcnet_kernel_initializer=None, fcnet_kernel_initializer_kwargs=None, fcnet_bias_initializer=None, fcnet_bias_initializer_kwargs=None, conv_filters=None, conv_activation='relu', conv_kernel_initializer=None, conv_kernel_initializer_kwargs=None, conv_bias_initializer=None, conv_bias_initializer_kwargs=None, head_fcnet_hiddens=[], head_fcnet_activation='relu', head_fcnet_kernel_initializer=None, head_fcnet_kernel_initializer_kwargs=None, head_fcnet_bias_initializer=None, head_fcnet_bias_initializer_kwargs=None, free_log_std=False, log_std_clip_param=20.0, vf_share_layers=True, use_lstm=False, max_seq_len=20, lstm_cell_size=256, lstm_use_prev_action=False, lstm_use_prev_reward=False, lstm_kernel_initializer=None, lstm_kernel_initializer_kwargs=None, lstm_bias_initializer=None, lstm_bias_initializer_kwargs=None), catalog_class=None, load_state_path=None, model_config_dict=None)", "algorithm_config_overrides_per_module": {}, "_per_module_overrides": {}, "_validate_config": true, "_use_msgpack_checkpoints": false, "_torch_grad_scaler_class": null, "_torch_lr_scheduler_classes": null, "_tf_policy_handles_more_than_one_loss": false, "_disable_preprocessor_api": false, "_disable_action_flattening": false, "_disable_initialize_loss_from_dummy_batch": false, "_dont_auto_sync_env_runner_states": false, "env_task_fn": -1, "enable_connectors": -1, "simple_optimizer": false, "policy_map_cache": -1, "worker_cls": -1, "synchronize_filters": -1, "enable_async_evaluation": -1, "custom_async_evaluation_function": -1, "_enable_rl_module_api": -1, "auto_wrap_old_gym_envs": -1, "always_attach_evaluation_results": -1, "replay_sequence_length": null, "_disable_execution_plan_api": -1, "use_critic": true, "use_gae": true, "use_kl_loss": true, "kl_coeff": 0.7464963036515, "kl_target": 0.0270990929592, "vf_loss_coeff": 0.6688075857018, "entropy_coeff": 0.0090570820258, "clip_param": 0.1221781641624, "vf_clip_param": 0.1027808522125, "entropy_coeff_schedule": null, "lr_schedule": null, "sgd_minibatch_size": -1, "vf_share_layers": -1, "__stdout_file__": null, "__stderr_file__": null, "lambda": 0.9099046732075, "input": "sampler", "policies": {"default_policy": [null, null, null, null]}, "callbacks": "<class 'ray.rllib.callbacks.callbacks.RLlibCallback'>", "create_env_on_driver": false, "custom_eval_function": null, "framework": "torch"}, "time_since_restore": 5.67588996887207, "iterations_since_restore": 3, "perf": {"cpu_util_percent": 45.76666666666667, "ram_util_percent": 80.96666666666665}}
{"timers": {"training_iteration": 1.9183210286857577, "restore_env_runners": 1.22408018844435e-05, "training_step": 1.9181665127709056, "env_runner_sampling_timer": 1.7996580482159068, "learner_update_timer": 0.11515715451827274, "synch_weights": 0.0007332323257441166, "restore_eval_env_runners": 8.948637545108794e-06, "evaluation_iteration": 0.12956993081660473, "synch_eval_env_connectors": 0.00011798177995951846, "synch_env_connectors": 5.608399666380137e-06}, "env_runners": {"env_to_module_connector": {"timers": {"connectors": {"add_observations_from_episodes_to_batch": 3.638753762881722e-06, "batch_individual_items": 7.535408920566655e-06, "numpy_to_tensor": 1.0762100366347174e-05, "add_states_from_episodes_to_batch": 2.003888166616299e-06, "add_time_dim_to_batch_and_zero_pad": 2.731565816601081e-06}}, "connector_pipeline_timer": 5.086768274325087e-05}, "episode_len_mean": 20.0, "sample": 0.005540331201906508, "module_to_env_connector": {"timers": {"connectors": {"get_actions": 5.023965766538568e-05, "un_batch_to_individual_items": 6.26051914931691e-06, "normalize_and_clip_actions": 1.1384830781424078e-05, "listify_data_for_vector_env": 1.3246213059240977e-05, "remove_single_ts_time_rank_from_batch": 6.726443330028916e-07, "tensor_to_numpy": 1.604110275690103e-05}}, "connector_pipeline_timer": 0.00012719103472264592}, "num_module_steps_sampled": {"default_policy": 5000.0}, "num_agent_steps_sampled_lifetime": {"default_agent": -1225000.0}, "num_env_steps_sampled": 5000.0, "episode_duration_sec_mean": 0.005531095494516195, "num_agent_steps_sampled": {"default_agent": 5000.0}, "env_to_module_sum_episodes_length_out": 10.36823839457432, "num_episodes": 250.0, "time_between_sampling": 0.002009043540812897, "env_step_timer": 1.7058577373399137e-05, "agent_episode_returns_mean": {"default_agent": 1.8199999999999996}, "episode_return_mean": 1.8199999999999996, "num_module_steps_sampled_lifetime": {"default_policy": -1225000.0}, "env_to_module_sum_episodes_length_in": 10.36823839457432, "episode_return_max": 9.5, "num_episodes_lifetime": -61250.0, "weights_seq_no": 3.0, "module_episode_returns_mean": {"default_policy": 1.8199999999999996}, "episode_return_min": -10.5, "episode_len_min": 20, "episode_len_max": 20, "env_reset_timer": 5.2264722522459864e-05, "num_env_steps_sampled_lifetime": -1225000.0, "rlmodule_inference_timer": 3.414050510087619e-05, "num_env_steps_sampled_lifetime_throughput": 3140.13327691407}, "learners": {"__all_modules__": {"num_module_steps_trained_lifetime": 24000, "learner_connector_sum_episodes_length_in": 5000.0, "learner_connector": {"timers": {"connectors": {"add_observations_from_episodes_to_batch": 0.0008227851364148082, "batch_individual_items": 0.03193168041013845, "general_advantage_estimation": 0.008080351182304206, "add_one_ts_to_episodes_and_truncate": 0.007674696707966854, "add_time_dim_to_batch_and_zero_pad": 1.227645904570818e-05, "add_states_from_episodes_to_batch": 3.7974064642330632e-06, "add_columns_from_episodes_to_train_batch": 0.034313500057162834, "numpy_to_tensor": 7.246253330435139e-05}}, "connector_pipeline_timer": 0.08305802297952804}, "num_env_steps_trained": 31500, "num_env_steps_trained_lifetime": 126000, "num_non_trainable_parameters": 0, "learner_connector_sum_episodes_length_out": 5250.0, "num_module_steps_trained": 6000, "num_trainable_parameters": 6003, "num_env_steps_trained_lifetime_throughput": 1658985.2952763722, "num_module_steps_trained_throughput": 317258.83754262305, "num_module_steps_trained_lifetime_throughput": 316770.66377775813}, "default_policy": {"vf_loss": 0.10278083384037018, "curr_entropy_coeff": 0.0090570820258, "mean_kl_loss": 0.0022027352824807167, "weights_seq_no": 4.0, "module_train_batch_size_mean": 1000.0, "vf_explained_var": -0.01594841480255127, "gradients_default_optimizer_global_norm": 0.13250532746315002, "diff_num_grad_updates_vs_sampler_policy": 1.0, "default_optimizer_learning_rate": 0.0002847858517, "curr_kl_coeff": 0.04665601998567581, "num_module_steps_trained": 6000, "num_trainable_parameters": 6003, "total_loss": 0.10210534930229187, "num_module_steps_trained_lifetime": 24000, "vf_loss_unclipped": 28.459375381469727, "policy_loss": 0.03923654928803444, "entropy": 0.6710050106048584, "num_module_steps_trained_lifetime_throughput": 317851.26457431965}}, "num_training_step_calls_per_iteration": 1, "evaluation": {"env_runners": {"sample": 0.12176125842778128, "num_module_steps_sampled": {"default_policy": 400}, "env_to_module_connector": {"timers": {"connectors": {"add_observations_from_episodes_to_batch": 3.901850505096258e-06, "numpy_to_tensor": 1.198020092490906e-05, "batch_individual_items": 8.860809486869266e-06, "add_time_dim_to_batch_and_zero_pad": 3.0942269680648878e-06, "add_states_from_episodes_to_batch": 2.0105849179705156e-06}}, "connector_pipeline_timer": 5.826559677245225e-05}, "num_agent_steps_sampled_lifetime": {"default_agent": 1600}, "module_to_env_connector": {"timers": {"connectors": {"tensor_to_numpy": 1.814336826649079e-05, "get_actions": 5.8768040501036434e-05, "listify_data_for_vector_env": 1.5767155739464717e-05, "normalize_and_clip_actions": 1.3544467380251137e-05, "remove_single_ts_time_rank_from_batch": 7.917825788899234e-07, "un_batch_to_individual_items": 7.477022565297518e-06}}, "connector_pipeline_timer": 0.00014856168930836043}, "agent_episode_returns_mean": {"default_agent": 1.95}, "num_env_steps_sampled": 400, "env_to_module_sum_episodes_length_out": 10.368237912813044, "num_episodes": 20, "num_agent_steps_sampled": {"default_agent": 400}, "num_episodes_lifetime": 80, "weights_seq_no": 4.0, "env_reset_timer": 0.00015901099545729815, "module_episode_returns_mean": {"default_policy": 1.95}, "rlmodule_inference_timer": 3.852491804046739e-05, "env_to_module_sum_episodes_length_in": 10.368237912813044, "episode_return_max": 12.5, "episode_len_min": 20, "episode_len_mean": 20.0, "episode_duration_sec_mean": 0.0054454442884889435, "env_step_timer": 2.0034951265378255e-05, "episode_return_mean": 1.95, "num_module_steps_sampled_lifetime": {"default_policy": 1600}, "episode_return_min": -12.5, "episode_len_max": 20, "num_env_steps_sampled_lifetime": 20400, "time_between_sampling": 1.879113283010549}, "num_healthy_workers": 1, "actor_manager_num_outstanding_async_reqs": 0, "num_remote_worker_restarts": 0}, "num_env_steps_sampled_lifetime": -1225000.0, "fault_tolerance": {"num_healthy_workers": 0, "num_remote_worker_restarts": 0}, "env_runner_group": {"actor_manager_num_outstanding_async_reqs": 0}, "done": false, "training_iteration": 4, "trial_id": "43778_00000", "date": "2025-08-11_19-20-13", "timestamp": 1754932813, "time_this_iter_s": 2.0577657222747803, "time_total_s": 7.733655691146851, "pid": 14172, "hostname": "Mac", "node_ip": "127.0.0.1", "config": {"exploration_config": {}, "extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "placement_strategy": "PACK", "num_gpus": 0, "_fake_gpus": false, "num_cpus_for_main_process": 2, "eager_tracing": true, "eager_max_retraces": 20, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "torch_compile_learner": false, "torch_compile_learner_what_to_compile": "forward_train", "torch_compile_learner_dynamo_backend": "aot_eager", "torch_compile_learner_dynamo_mode": null, "torch_compile_worker": false, "torch_compile_worker_dynamo_backend": "aot_eager", "torch_compile_worker_dynamo_mode": null, "torch_ddp_kwargs": {}, "torch_skip_nan_gradients": false, "env": "Umbrella", "env_config": {}, "observation_space": null, "action_space": null, "clip_rewards": null, "normalize_actions": true, "clip_actions": false, "_is_atari": null, "disable_env_checking": false, "render_env": false, "action_mask_key": "action_mask", "env_runner_cls": null, "num_env_runners": 0, "create_local_env_runner": true, "num_envs_per_env_runner": 1, "gym_env_vectorize_mode": "SYNC", "num_cpus_per_env_runner": 1, "num_gpus_per_env_runner": 0, "custom_resources_per_env_runner": {}, "validate_env_runners_after_construction": true, "episodes_to_numpy": true, "max_requests_in_flight_per_env_runner": 1, "sample_timeout_s": 60.0, "_env_to_module_connector": null, "add_default_connectors_to_env_to_module_pipeline": true, "_module_to_env_connector": null, "add_default_connectors_to_module_to_env_pipeline": true, "merge_env_runner_states": "training_only", "broadcast_env_runner_states": true, "episode_lookback_horizon": 1, "rollout_fragment_length": "auto", "batch_mode": "complete_episodes", "compress_observations": false, "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "enable_tf1_exec_eagerly": false, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "preprocessor_pref": "deepmind", "observation_filter": "NoFilter", "update_worker_filter_stats": true, "use_worker_filter_stats": true, "sampler_perf_stats_ema_coef": null, "_is_online": true, "num_learners": 0, "num_gpus_per_learner": 0, "num_cpus_per_learner": "auto", "num_aggregator_actors_per_learner": 0, "max_requests_in_flight_per_aggregator_actor": 3, "local_gpu_idx": 0, "max_requests_in_flight_per_learner": 3, "gamma": 1, "lr": 0.0002847858517, "grad_clip": 0.5, "grad_clip_by": "global_norm", "_train_batch_size_per_learner": 5000, "train_batch_size": 4000, "num_epochs": 1, "minibatch_size": 1000, "shuffle_batch_per_epoch": true, "model": {"fcnet_hiddens": [256, 256], "fcnet_activation": "tanh", "fcnet_weights_initializer": null, "fcnet_weights_initializer_config": null, "fcnet_bias_initializer": null, "fcnet_bias_initializer_config": null, "conv_filters": null, "conv_activation": "relu", "conv_kernel_initializer": null, "conv_kernel_initializer_config": null, "conv_bias_initializer": null, "conv_bias_initializer_config": null, "conv_transpose_kernel_initializer": null, "conv_transpose_kernel_initializer_config": null, "conv_transpose_bias_initializer": null, "conv_transpose_bias_initializer_config": null, "post_fcnet_hiddens": [], "post_fcnet_activation": "relu", "post_fcnet_weights_initializer": null, "post_fcnet_weights_initializer_config": null, "post_fcnet_bias_initializer": null, "post_fcnet_bias_initializer_config": null, "free_log_std": false, "log_std_clip_param": 20.0, "no_final_linear": false, "vf_share_layers": false, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "lstm_weights_initializer": null, "lstm_weights_initializer_config": null, "lstm_bias_initializer": null, "lstm_bias_initializer_config": null, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "attention_use_n_prev_actions": 0, "attention_use_n_prev_rewards": 0, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": null, "custom_model_config": {}, "custom_action_dist": null, "custom_preprocessor": null, "encoder_latent_dim": null, "always_check_shapes": false, "lstm_use_prev_action_reward": -1, "_use_default_native_models": -1, "_disable_preprocessor_api": false, "_disable_action_flattening": false}, "_learner_connector": null, "add_default_connectors_to_learner_pipeline": true, "learner_config_dict": {}, "optimizer": {}, "_learner_class": null, "callbacks_on_algorithm_init": null, "callbacks_on_env_runners_recreated": null, "callbacks_on_offline_eval_runners_recreated": null, "callbacks_on_checkpoint_loaded": null, "callbacks_on_environment_created": null, "callbacks_on_episode_created": null, "callbacks_on_episode_start": null, "callbacks_on_episode_step": null, "callbacks_on_episode_end": null, "callbacks_on_evaluate_start": null, "callbacks_on_evaluate_end": null, "callbacks_on_evaluate_offline_start": null, "callbacks_on_evaluate_offline_end": null, "callbacks_on_sample_end": null, "callbacks_on_train_result": null, "explore": true, "enable_rl_module_and_learner": true, "enable_env_runner_and_connector_v2": true, "_prior_exploration_config": {"type": "StochasticSampling"}, "count_steps_by": "env_steps", "policy_map_capacity": 100, "policy_mapping_fn": "<function AlgorithmConfig.DEFAULT_POLICY_MAPPING_FN at 0x3888f18a0>", "policies_to_train": null, "policy_states_are_swappable": false, "observation_fn": null, "offline_data_class": null, "input_read_method": "read_parquet", "input_read_method_kwargs": {}, "input_read_schema": {}, "input_read_episodes": false, "input_read_sample_batches": false, "input_read_batch_size": null, "input_filesystem": null, "input_filesystem_kwargs": {}, "input_compress_columns": ["obs", "new_obs"], "input_spaces_jsonable": true, "materialize_data": false, "materialize_mapped_data": true, "map_batches_kwargs": {}, "iter_batches_kwargs": {}, "ignore_final_observation": false, "prelearner_class": null, "prelearner_buffer_class": null, "prelearner_buffer_kwargs": {}, "prelearner_module_synch_period": 10, "dataset_num_iters_per_learner": null, "input_config": {}, "actions_in_input_normalized": false, "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_config": {}, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "output_max_rows_per_file": null, "output_write_remaining_data": false, "output_write_method": "write_parquet", "output_write_method_kwargs": {}, "output_filesystem": null, "output_filesystem_kwargs": {}, "output_write_episodes": true, "offline_sampling": false, "evaluation_interval": 1, "evaluation_duration": 20, "evaluation_duration_unit": "episodes", "evaluation_sample_timeout_s": 120.0, "evaluation_auto_duration_min_env_steps_per_sample": 100, "evaluation_auto_duration_max_env_steps_per_sample": 2000, "evaluation_parallel_to_training": false, "evaluation_force_reset_envs_before_iteration": true, "evaluation_config": null, "off_policy_estimation_methods": {}, "ope_split_batch_by_episode": true, "evaluation_num_env_runners": 1, "in_evaluation": false, "sync_filters_on_rollout_workers_timeout_s": 10.0, "offline_evaluation_interval": null, "num_offline_eval_runners": 0, "offline_loss_for_module_fn": null, "offline_evaluation_duration": 1, "offline_evaluation_parallel_to_training": false, "offline_evaluation_timeout_s": 120.0, "num_cpus_per_offline_eval_runner": 1, "num_gpus_per_offline_eval_runner": 0, "custom_resources_per_offline_eval_runner": {}, "restart_failed_offline_eval_runners": true, "ignore_offline_eval_runner_failures": false, "max_num_offline_eval_runner_restarts": 1000, "offline_eval_runner_restore_timeout_s": 1800.0, "max_requests_in_flight_per_offline_eval_runner": 1, "validate_offline_eval_runners_after_construction": true, "offline_eval_runner_health_probe_timeout_s": 30.0, "offline_eval_rl_module_inference_only": false, "broadcast_offline_eval_runner_states": false, "offline_eval_batch_size_per_runner": 256, "dataset_num_iters_per_eval_runner": 1, "keep_per_episode_custom_metrics": false, "metrics_episode_collection_timeout_s": 60.0, "metrics_num_episodes_for_smoothing": 100, "min_time_s_per_iteration": null, "min_train_timesteps_per_iteration": 0, "min_sample_timesteps_per_iteration": 0, "log_gradients": true, "export_native_model_files": false, "checkpoint_trainable_policies_only": false, "logger_creator": null, "logger_config": null, "log_level": "WARN", "log_sys_usage": true, "fake_sampler": false, "seed": 1, "restart_failed_env_runners": true, "ignore_env_runner_failures": false, "max_num_env_runner_restarts": 1000, "delay_between_env_runner_restarts_s": 60.0, "restart_failed_sub_environments": false, "num_consecutive_env_runner_failures_tolerance": 100, "env_runner_health_probe_timeout_s": 30.0, "env_runner_restore_timeout_s": 1800.0, "_model_config": {}, "_rl_module_spec": "RLModuleSpec(module_class=None, observation_space=None, action_space=None, inference_only=False, learner_only=False, model_config=DefaultModelConfig(fcnet_hiddens=[60, 90], fcnet_activation='tanh', fcnet_kernel_initializer=None, fcnet_kernel_initializer_kwargs=None, fcnet_bias_initializer=None, fcnet_bias_initializer_kwargs=None, conv_filters=None, conv_activation='relu', conv_kernel_initializer=None, conv_kernel_initializer_kwargs=None, conv_bias_initializer=None, conv_bias_initializer_kwargs=None, head_fcnet_hiddens=[], head_fcnet_activation='relu', head_fcnet_kernel_initializer=None, head_fcnet_kernel_initializer_kwargs=None, head_fcnet_bias_initializer=None, head_fcnet_bias_initializer_kwargs=None, free_log_std=False, log_std_clip_param=20.0, vf_share_layers=True, use_lstm=False, max_seq_len=20, lstm_cell_size=256, lstm_use_prev_action=False, lstm_use_prev_reward=False, lstm_kernel_initializer=None, lstm_kernel_initializer_kwargs=None, lstm_bias_initializer=None, lstm_bias_initializer_kwargs=None), catalog_class=None, load_state_path=None, model_config_dict=None)", "algorithm_config_overrides_per_module": {}, "_per_module_overrides": {}, "_validate_config": true, "_use_msgpack_checkpoints": false, "_torch_grad_scaler_class": null, "_torch_lr_scheduler_classes": null, "_tf_policy_handles_more_than_one_loss": false, "_disable_preprocessor_api": false, "_disable_action_flattening": false, "_disable_initialize_loss_from_dummy_batch": false, "_dont_auto_sync_env_runner_states": false, "env_task_fn": -1, "enable_connectors": -1, "simple_optimizer": false, "policy_map_cache": -1, "worker_cls": -1, "synchronize_filters": -1, "enable_async_evaluation": -1, "custom_async_evaluation_function": -1, "_enable_rl_module_api": -1, "auto_wrap_old_gym_envs": -1, "always_attach_evaluation_results": -1, "replay_sequence_length": null, "_disable_execution_plan_api": -1, "use_critic": true, "use_gae": true, "use_kl_loss": true, "kl_coeff": 0.7464963036515, "kl_target": 0.0270990929592, "vf_loss_coeff": 0.6688075857018, "entropy_coeff": 0.0090570820258, "clip_param": 0.1221781641624, "vf_clip_param": 0.1027808522125, "entropy_coeff_schedule": null, "lr_schedule": null, "sgd_minibatch_size": -1, "vf_share_layers": -1, "__stdout_file__": null, "__stderr_file__": null, "lambda": 0.9099046732075, "input": "sampler", "policies": {"default_policy": [null, null, null, null]}, "callbacks": "<class 'ray.rllib.callbacks.callbacks.RLlibCallback'>", "create_env_on_driver": false, "custom_eval_function": null, "framework": "torch"}, "time_since_restore": 7.733655691146851, "iterations_since_restore": 4, "perf": {"cpu_util_percent": 48.76666666666667, "ram_util_percent": 82.36666666666666}}
{"timers": {"training_iteration": 1.917044576728964, "restore_env_runners": 1.2190053316949634e-05, "training_step": 1.9168890463926531, "env_runner_sampling_timer": 1.7984118964836946, "learner_update_timer": 0.11510781755341126, "synch_weights": 0.0007445750026606465, "restore_eval_env_runners": 8.974571140483021e-06, "evaluation_iteration": 0.1297595573375646, "synch_eval_env_connectors": 0.00011892780256120022, "synch_env_connectors": 5.601065749884583e-06}, "env_runners": {"env_to_module_connector": {"timers": {"connectors": {"add_observations_from_episodes_to_batch": 3.4030356740106615e-06, "batch_individual_items": 7.176737308250392e-06, "numpy_to_tensor": 1.0130051124386828e-05, "add_states_from_episodes_to_batch": 1.92999097441212e-06, "add_time_dim_to_batch_and_zero_pad": 2.644659232378918e-06}}, "connector_pipeline_timer": 4.870538387829178e-05}, "episode_len_mean": 20.0, "sample": 0.005963546009560405, "module_to_env_connector": {"timers": {"connectors": {"get_actions": 4.746794223319856e-05, "un_batch_to_individual_items": 6.060040003309085e-06, "normalize_and_clip_actions": 1.0749038235938524e-05, "listify_data_for_vector_env": 1.2669528757757245e-05, "remove_single_ts_time_rank_from_batch": 6.703529473041223e-07, "tensor_to_numpy": 1.5171313092046134e-05}}, "connector_pipeline_timer": 0.0001208478626143909}, "num_module_steps_sampled": {"default_policy": 5000.0}, "num_agent_steps_sampled_lifetime": {"default_agent": -1842500.0}, "num_env_steps_sampled": 5000.0, "episode_duration_sec_mean": 0.005575756983365864, "num_agent_steps_sampled": {"default_agent": 5000.0}, "env_to_module_sum_episodes_length_out": 10.36823839457432, "num_episodes": 250.0, "time_between_sampling": 0.0020183769561815702, "env_step_timer": 1.624728504054962e-05, "agent_episode_returns_mean": {"default_agent": 3.66}, "episode_return_mean": 3.66, "num_module_steps_sampled_lifetime": {"default_policy": -1842500.0}, "env_to_module_sum_episodes_length_in": 10.36823839457432, "episode_return_max": 9.5, "num_episodes_lifetime": -92125.0, "weights_seq_no": 4.0, "module_episode_returns_mean": {"default_policy": 3.66}, "episode_return_min": -10.5, "episode_len_min": 20, "episode_len_max": 20, "env_reset_timer": 5.623876900305312e-05, "num_env_steps_sampled_lifetime": -1842500.0, "rlmodule_inference_timer": 5.1879138404693253e-05, "num_env_steps_sampled_lifetime_throughput": 3219.672036778519}, "learners": {"__all_modules__": {"num_module_steps_trained_lifetime": 30000, "learner_connector_sum_episodes_length_in": 5000.0, "learner_connector": {"timers": {"connectors": {"add_observations_from_episodes_to_batch": 0.0008233572857014683, "batch_individual_items": 0.03191021193568358, "general_advantage_estimation": 0.008056099339739789, "add_one_ts_to_episodes_and_truncate": 0.0076773114115377275, "add_time_dim_to_batch_and_zero_pad": 1.224577431820333e-05, "add_states_from_episodes_to_batch": 3.786511767600896e-06, "add_columns_from_episodes_to_train_batch": 0.0343196717163642, "numpy_to_tensor": 7.233832814270281e-05}}, "connector_pipeline_timer": 0.08302101024980994}, "num_env_steps_trained": 31500, "num_env_steps_trained_lifetime": 157500, "num_non_trainable_parameters": 0, "learner_connector_sum_episodes_length_out": 5250.0, "num_module_steps_trained": 6000, "num_trainable_parameters": 6003, "num_env_steps_trained_lifetime_throughput": 1652616.5766636776, "num_module_steps_trained_throughput": 316007.09375171567, "num_module_steps_trained_lifetime_throughput": 315529.71362268063}, "default_policy": {"vf_loss": 0.10278083384037018, "curr_entropy_coeff": 0.0090570820258, "mean_kl_loss": 0.003353710984811187, "weights_seq_no": 5.0, "module_train_batch_size_mean": 1000.0, "vf_explained_var": -0.01769888401031494, "gradients_default_optimizer_global_norm": 0.3231657147407532, "diff_num_grad_updates_vs_sampler_policy": 1.0, "default_optimizer_learning_rate": 0.0002847858517, "curr_kl_coeff": 0.023328009992837906, "num_module_steps_trained": 6000, "num_trainable_parameters": 6003, "total_loss": -0.026010937988758087, "num_module_steps_trained_lifetime": 30000, "vf_loss_unclipped": 27.58094024658203, "policy_loss": -0.08898680657148361, "entropy": 0.6537670493125916, "num_module_steps_trained_lifetime_throughput": 316564.1014828607}}, "num_training_step_calls_per_iteration": 1, "evaluation": {"env_runners": {"sample": 0.12163137417367048, "num_module_steps_sampled": {"default_policy": 400}, "env_to_module_connector": {"timers": {"connectors": {"add_observations_from_episodes_to_batch": 2.9663721546939102e-06, "numpy_to_tensor": 8.852894508575514e-06, "batch_individual_items": 6.414705061659676e-06, "add_time_dim_to_batch_and_zero_pad": 2.2780074370684507e-06, "add_states_from_episodes_to_batch": 1.6214704487688654e-06}}, "connector_pipeline_timer": 4.4703628022155705e-05}, "num_agent_steps_sampled_lifetime": {"default_agent": 2000}, "module_to_env_connector": {"timers": {"connectors": {"tensor_to_numpy": 1.3961217617083385e-05, "get_actions": 4.0296816493998946e-05, "listify_data_for_vector_env": 1.1183102574500183e-05, "normalize_and_clip_actions": 9.962124263805516e-06, "remove_single_ts_time_rank_from_batch": 5.818917759404259e-07, "un_batch_to_individual_items": 5.568578796843658e-06}}, "connector_pipeline_timer": 0.00010854313291403298}, "agent_episode_returns_mean": {"default_agent": 1.0}, "num_env_steps_sampled": 400, "env_to_module_sum_episodes_length_out": 10.368238387501162, "num_episodes": 20, "num_agent_steps_sampled": {"default_agent": 400}, "num_episodes_lifetime": 100, "weights_seq_no": 5.0, "env_reset_timer": 0.00015833963522258335, "module_episode_returns_mean": {"default_policy": 1.0}, "rlmodule_inference_timer": 2.9507991096213945e-05, "env_to_module_sum_episodes_length_in": 10.368238387501162, "episode_return_max": 12.5, "episode_len_min": 20, "episode_len_mean": 20.0, "episode_duration_sec_mean": 0.005352449159836396, "env_step_timer": 1.5172886444987783e-05, "episode_return_mean": 1.0, "num_module_steps_sampled_lifetime": {"default_policy": 2000}, "episode_return_min": -12.5, "episode_len_max": 20, "num_env_steps_sampled_lifetime": 25400, "time_between_sampling": 1.878485827260745}, "num_healthy_workers": 1, "actor_manager_num_outstanding_async_reqs": 0, "num_remote_worker_restarts": 0}, "num_env_steps_sampled_lifetime": -1842500.0, "fault_tolerance": {"num_healthy_workers": 0, "num_remote_worker_restarts": 0}, "env_runner_group": {"actor_manager_num_outstanding_async_reqs": 0}, "done": false, "training_iteration": 5, "trial_id": "43778_00000", "date": "2025-08-11_19-20-15", "timestamp": 1754932815, "time_this_iter_s": 1.906872034072876, "time_total_s": 9.640527725219727, "pid": 14172, "hostname": "Mac", "node_ip": "127.0.0.1", "config": {"exploration_config": {}, "extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "placement_strategy": "PACK", "num_gpus": 0, "_fake_gpus": false, "num_cpus_for_main_process": 2, "eager_tracing": true, "eager_max_retraces": 20, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "torch_compile_learner": false, "torch_compile_learner_what_to_compile": "forward_train", "torch_compile_learner_dynamo_backend": "aot_eager", "torch_compile_learner_dynamo_mode": null, "torch_compile_worker": false, "torch_compile_worker_dynamo_backend": "aot_eager", "torch_compile_worker_dynamo_mode": null, "torch_ddp_kwargs": {}, "torch_skip_nan_gradients": false, "env": "Umbrella", "env_config": {}, "observation_space": null, "action_space": null, "clip_rewards": null, "normalize_actions": true, "clip_actions": false, "_is_atari": null, "disable_env_checking": false, "render_env": false, "action_mask_key": "action_mask", "env_runner_cls": null, "num_env_runners": 0, "create_local_env_runner": true, "num_envs_per_env_runner": 1, "gym_env_vectorize_mode": "SYNC", "num_cpus_per_env_runner": 1, "num_gpus_per_env_runner": 0, "custom_resources_per_env_runner": {}, "validate_env_runners_after_construction": true, "episodes_to_numpy": true, "max_requests_in_flight_per_env_runner": 1, "sample_timeout_s": 60.0, "_env_to_module_connector": null, "add_default_connectors_to_env_to_module_pipeline": true, "_module_to_env_connector": null, "add_default_connectors_to_module_to_env_pipeline": true, "merge_env_runner_states": "training_only", "broadcast_env_runner_states": true, "episode_lookback_horizon": 1, "rollout_fragment_length": "auto", "batch_mode": "complete_episodes", "compress_observations": false, "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "enable_tf1_exec_eagerly": false, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "preprocessor_pref": "deepmind", "observation_filter": "NoFilter", "update_worker_filter_stats": true, "use_worker_filter_stats": true, "sampler_perf_stats_ema_coef": null, "_is_online": true, "num_learners": 0, "num_gpus_per_learner": 0, "num_cpus_per_learner": "auto", "num_aggregator_actors_per_learner": 0, "max_requests_in_flight_per_aggregator_actor": 3, "local_gpu_idx": 0, "max_requests_in_flight_per_learner": 3, "gamma": 1, "lr": 0.0002847858517, "grad_clip": 0.5, "grad_clip_by": "global_norm", "_train_batch_size_per_learner": 5000, "train_batch_size": 4000, "num_epochs": 1, "minibatch_size": 1000, "shuffle_batch_per_epoch": true, "model": {"fcnet_hiddens": [256, 256], "fcnet_activation": "tanh", "fcnet_weights_initializer": null, "fcnet_weights_initializer_config": null, "fcnet_bias_initializer": null, "fcnet_bias_initializer_config": null, "conv_filters": null, "conv_activation": "relu", "conv_kernel_initializer": null, "conv_kernel_initializer_config": null, "conv_bias_initializer": null, "conv_bias_initializer_config": null, "conv_transpose_kernel_initializer": null, "conv_transpose_kernel_initializer_config": null, "conv_transpose_bias_initializer": null, "conv_transpose_bias_initializer_config": null, "post_fcnet_hiddens": [], "post_fcnet_activation": "relu", "post_fcnet_weights_initializer": null, "post_fcnet_weights_initializer_config": null, "post_fcnet_bias_initializer": null, "post_fcnet_bias_initializer_config": null, "free_log_std": false, "log_std_clip_param": 20.0, "no_final_linear": false, "vf_share_layers": false, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "lstm_weights_initializer": null, "lstm_weights_initializer_config": null, "lstm_bias_initializer": null, "lstm_bias_initializer_config": null, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "attention_use_n_prev_actions": 0, "attention_use_n_prev_rewards": 0, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": null, "custom_model_config": {}, "custom_action_dist": null, "custom_preprocessor": null, "encoder_latent_dim": null, "always_check_shapes": false, "lstm_use_prev_action_reward": -1, "_use_default_native_models": -1, "_disable_preprocessor_api": false, "_disable_action_flattening": false}, "_learner_connector": null, "add_default_connectors_to_learner_pipeline": true, "learner_config_dict": {}, "optimizer": {}, "_learner_class": null, "callbacks_on_algorithm_init": null, "callbacks_on_env_runners_recreated": null, "callbacks_on_offline_eval_runners_recreated": null, "callbacks_on_checkpoint_loaded": null, "callbacks_on_environment_created": null, "callbacks_on_episode_created": null, "callbacks_on_episode_start": null, "callbacks_on_episode_step": null, "callbacks_on_episode_end": null, "callbacks_on_evaluate_start": null, "callbacks_on_evaluate_end": null, "callbacks_on_evaluate_offline_start": null, "callbacks_on_evaluate_offline_end": null, "callbacks_on_sample_end": null, "callbacks_on_train_result": null, "explore": true, "enable_rl_module_and_learner": true, "enable_env_runner_and_connector_v2": true, "_prior_exploration_config": {"type": "StochasticSampling"}, "count_steps_by": "env_steps", "policy_map_capacity": 100, "policy_mapping_fn": "<function AlgorithmConfig.DEFAULT_POLICY_MAPPING_FN at 0x3888f18a0>", "policies_to_train": null, "policy_states_are_swappable": false, "observation_fn": null, "offline_data_class": null, "input_read_method": "read_parquet", "input_read_method_kwargs": {}, "input_read_schema": {}, "input_read_episodes": false, "input_read_sample_batches": false, "input_read_batch_size": null, "input_filesystem": null, "input_filesystem_kwargs": {}, "input_compress_columns": ["obs", "new_obs"], "input_spaces_jsonable": true, "materialize_data": false, "materialize_mapped_data": true, "map_batches_kwargs": {}, "iter_batches_kwargs": {}, "ignore_final_observation": false, "prelearner_class": null, "prelearner_buffer_class": null, "prelearner_buffer_kwargs": {}, "prelearner_module_synch_period": 10, "dataset_num_iters_per_learner": null, "input_config": {}, "actions_in_input_normalized": false, "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_config": {}, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "output_max_rows_per_file": null, "output_write_remaining_data": false, "output_write_method": "write_parquet", "output_write_method_kwargs": {}, "output_filesystem": null, "output_filesystem_kwargs": {}, "output_write_episodes": true, "offline_sampling": false, "evaluation_interval": 1, "evaluation_duration": 20, "evaluation_duration_unit": "episodes", "evaluation_sample_timeout_s": 120.0, "evaluation_auto_duration_min_env_steps_per_sample": 100, "evaluation_auto_duration_max_env_steps_per_sample": 2000, "evaluation_parallel_to_training": false, "evaluation_force_reset_envs_before_iteration": true, "evaluation_config": null, "off_policy_estimation_methods": {}, "ope_split_batch_by_episode": true, "evaluation_num_env_runners": 1, "in_evaluation": false, "sync_filters_on_rollout_workers_timeout_s": 10.0, "offline_evaluation_interval": null, "num_offline_eval_runners": 0, "offline_loss_for_module_fn": null, "offline_evaluation_duration": 1, "offline_evaluation_parallel_to_training": false, "offline_evaluation_timeout_s": 120.0, "num_cpus_per_offline_eval_runner": 1, "num_gpus_per_offline_eval_runner": 0, "custom_resources_per_offline_eval_runner": {}, "restart_failed_offline_eval_runners": true, "ignore_offline_eval_runner_failures": false, "max_num_offline_eval_runner_restarts": 1000, "offline_eval_runner_restore_timeout_s": 1800.0, "max_requests_in_flight_per_offline_eval_runner": 1, "validate_offline_eval_runners_after_construction": true, "offline_eval_runner_health_probe_timeout_s": 30.0, "offline_eval_rl_module_inference_only": false, "broadcast_offline_eval_runner_states": false, "offline_eval_batch_size_per_runner": 256, "dataset_num_iters_per_eval_runner": 1, "keep_per_episode_custom_metrics": false, "metrics_episode_collection_timeout_s": 60.0, "metrics_num_episodes_for_smoothing": 100, "min_time_s_per_iteration": null, "min_train_timesteps_per_iteration": 0, "min_sample_timesteps_per_iteration": 0, "log_gradients": true, "export_native_model_files": false, "checkpoint_trainable_policies_only": false, "logger_creator": null, "logger_config": null, "log_level": "WARN", "log_sys_usage": true, "fake_sampler": false, "seed": 1, "restart_failed_env_runners": true, "ignore_env_runner_failures": false, "max_num_env_runner_restarts": 1000, "delay_between_env_runner_restarts_s": 60.0, "restart_failed_sub_environments": false, "num_consecutive_env_runner_failures_tolerance": 100, "env_runner_health_probe_timeout_s": 30.0, "env_runner_restore_timeout_s": 1800.0, "_model_config": {}, "_rl_module_spec": "RLModuleSpec(module_class=None, observation_space=None, action_space=None, inference_only=False, learner_only=False, model_config=DefaultModelConfig(fcnet_hiddens=[60, 90], fcnet_activation='tanh', fcnet_kernel_initializer=None, fcnet_kernel_initializer_kwargs=None, fcnet_bias_initializer=None, fcnet_bias_initializer_kwargs=None, conv_filters=None, conv_activation='relu', conv_kernel_initializer=None, conv_kernel_initializer_kwargs=None, conv_bias_initializer=None, conv_bias_initializer_kwargs=None, head_fcnet_hiddens=[], head_fcnet_activation='relu', head_fcnet_kernel_initializer=None, head_fcnet_kernel_initializer_kwargs=None, head_fcnet_bias_initializer=None, head_fcnet_bias_initializer_kwargs=None, free_log_std=False, log_std_clip_param=20.0, vf_share_layers=True, use_lstm=False, max_seq_len=20, lstm_cell_size=256, lstm_use_prev_action=False, lstm_use_prev_reward=False, lstm_kernel_initializer=None, lstm_kernel_initializer_kwargs=None, lstm_bias_initializer=None, lstm_bias_initializer_kwargs=None), catalog_class=None, load_state_path=None, model_config_dict=None)", "algorithm_config_overrides_per_module": {}, "_per_module_overrides": {}, "_validate_config": true, "_use_msgpack_checkpoints": false, "_torch_grad_scaler_class": null, "_torch_lr_scheduler_classes": null, "_tf_policy_handles_more_than_one_loss": false, "_disable_preprocessor_api": false, "_disable_action_flattening": false, "_disable_initialize_loss_from_dummy_batch": false, "_dont_auto_sync_env_runner_states": false, "env_task_fn": -1, "enable_connectors": -1, "simple_optimizer": false, "policy_map_cache": -1, "worker_cls": -1, "synchronize_filters": -1, "enable_async_evaluation": -1, "custom_async_evaluation_function": -1, "_enable_rl_module_api": -1, "auto_wrap_old_gym_envs": -1, "always_attach_evaluation_results": -1, "replay_sequence_length": null, "_disable_execution_plan_api": -1, "use_critic": true, "use_gae": true, "use_kl_loss": true, "kl_coeff": 0.7464963036515, "kl_target": 0.0270990929592, "vf_loss_coeff": 0.6688075857018, "entropy_coeff": 0.0090570820258, "clip_param": 0.1221781641624, "vf_clip_param": 0.1027808522125, "entropy_coeff_schedule": null, "lr_schedule": null, "sgd_minibatch_size": -1, "vf_share_layers": -1, "__stdout_file__": null, "__stderr_file__": null, "lambda": 0.9099046732075, "input": "sampler", "policies": {"default_policy": [null, null, null, null]}, "callbacks": "<class 'ray.rllib.callbacks.callbacks.RLlibCallback'>", "create_env_on_driver": false, "custom_eval_function": null, "framework": "torch"}, "time_since_restore": 9.640527725219727, "iterations_since_restore": 5, "perf": {"cpu_util_percent": 51.45, "ram_util_percent": 81.85}}
{"timers": {"training_iteration": 1.9138637434620904, "restore_env_runners": 1.2123982079668682e-05, "training_step": 1.9137079913492552, "env_runner_sampling_timer": 1.7945148521087733, "learner_update_timer": 0.11582590228802937, "synch_weights": 0.0007425284124883179, "restore_eval_env_runners": 8.948575623463838e-06, "evaluation_iteration": 0.1296020788436742, "synch_eval_env_connectors": 0.00011889477431765873, "synch_env_connectors": 5.590054270884721e-06}, "env_runners": {"env_to_module_connector": {"timers": {"connectors": {"add_observations_from_episodes_to_batch": 3.0045719380477706e-06, "batch_individual_items": 6.447688841482659e-06, "numpy_to_tensor": 8.877202418073778e-06, "add_states_from_episodes_to_batch": 1.7385663222122677e-06, "add_time_dim_to_batch_and_zero_pad": 2.409680055574558e-06}}, "connector_pipeline_timer": 4.410594158562835e-05}, "episode_len_mean": 20.0, "sample": 0.005418547463855895, "module_to_env_connector": {"timers": {"connectors": {"get_actions": 4.0685614518731455e-05, "un_batch_to_individual_items": 5.444202424924625e-06, "normalize_and_clip_actions": 9.564360111442588e-06, "listify_data_for_vector_env": 1.1178307852405572e-05, "remove_single_ts_time_rank_from_batch": 5.890708380306834e-07, "tensor_to_numpy": 1.3545202950348127e-05}}, "connector_pipeline_timer": 0.00010649145244819655}, "num_module_steps_sampled": {"default_policy": 5000.0}, "num_agent_steps_sampled_lifetime": {"default_agent": -2460000.0}, "num_env_steps_sampled": 5000.0, "episode_duration_sec_mean": 0.004633611991535872, "num_agent_steps_sampled": {"default_agent": 5000.0}, "env_to_module_sum_episodes_length_out": 10.36823839457432, "num_episodes": 250.0, "time_between_sampling": 0.0016856280624930927, "env_step_timer": 1.4079487901959382e-05, "agent_episode_returns_mean": {"default_agent": 3.98}, "episode_return_mean": 3.98, "num_module_steps_sampled_lifetime": {"default_policy": -2460000.0}, "env_to_module_sum_episodes_length_in": 10.36823839457432, "episode_return_max": 9.5, "num_episodes_lifetime": -123000.0, "weights_seq_no": 5.0, "module_episode_returns_mean": {"default_policy": 3.98}, "episode_return_min": -10.5, "episode_len_min": 20, "episode_len_max": 20, "env_reset_timer": 4.192125966992609e-05, "num_env_steps_sampled_lifetime": -2460000.0, "rlmodule_inference_timer": 2.892127991744814e-05, "num_env_steps_sampled_lifetime_throughput": 3641.31292651727}, "learners": {"__all_modules__": {"num_module_steps_trained_lifetime": 36000, "learner_connector_sum_episodes_length_in": 5000.0, "learner_connector": {"timers": {"connectors": {"add_observations_from_episodes_to_batch": 0.0008233358033143504, "batch_individual_items": 0.03284667606592828, "general_advantage_estimation": 0.008028003756314165, "add_one_ts_to_episodes_and_truncate": 0.007677671627473206, "add_time_dim_to_batch_and_zero_pad": 1.2229986770258098e-05, "add_states_from_episodes_to_batch": 3.7761462772468455e-06, "add_columns_from_episodes_to_train_batch": 0.03432119749950432, "numpy_to_tensor": 7.224369470123732e-05}}, "connector_pipeline_timer": 0.08393054222799286}, "num_env_steps_trained": 31500, "num_env_steps_trained_lifetime": 189000, "num_non_trainable_parameters": 0, "learner_connector_sum_episodes_length_out": 5250.0, "num_module_steps_trained": 6000, "num_trainable_parameters": 6003, "num_env_steps_trained_lifetime_throughput": 1657832.2057763548, "num_module_steps_trained_throughput": 316959.20134571695, "num_module_steps_trained_lifetime_throughput": 316493.12299438246}, "default_policy": {"vf_loss": 0.10278083384037018, "curr_entropy_coeff": 0.0090570820258, "mean_kl_loss": 0.00046910226228646934, "weights_seq_no": 6.0, "module_train_batch_size_mean": 1000.0, "vf_explained_var": -0.018162131309509277, "gradients_default_optimizer_global_norm": 0.053384359925985336, "diff_num_grad_updates_vs_sampler_policy": 1.0, "default_optimizer_learning_rate": 0.0002847858517, "curr_kl_coeff": 0.011664004996418953, "num_module_steps_trained": 6000, "num_trainable_parameters": 6003, "total_loss": -0.015575570054352283, "num_module_steps_trained_lifetime": 36000, "vf_loss_unclipped": 27.55246925354004, "policy_loss": -0.07849463820457458, "entropy": 0.6439688205718994, "num_module_steps_trained_lifetime_throughput": 317473.9195058805}}, "num_training_step_calls_per_iteration": 1, "evaluation": {"env_runners": {"sample": 0.12139526668261252, "num_module_steps_sampled": {"default_policy": 400}, "env_to_module_connector": {"timers": {"connectors": {"add_observations_from_episodes_to_batch": 2.787557869873402e-06, "numpy_to_tensor": 8.261557078029524e-06, "batch_individual_items": 6.0292836194731916e-06, "add_time_dim_to_batch_and_zero_pad": 2.182738686151342e-06, "add_states_from_episodes_to_batch": 1.5643331336818518e-06}}, "connector_pipeline_timer": 4.243257567604486e-05}, "num_agent_steps_sampled_lifetime": {"default_agent": 2400}, "module_to_env_connector": {"timers": {"connectors": {"tensor_to_numpy": 1.3094008926781821e-05, "get_actions": 3.6470295167203174e-05, "listify_data_for_vector_env": 1.0911183590191888e-05, "normalize_and_clip_actions": 9.338979898002697e-06, "remove_single_ts_time_rank_from_batch": 5.66710675819754e-07, "un_batch_to_individual_items": 5.324997200452561e-06}}, "connector_pipeline_timer": 0.00010175794128751211}, "agent_episode_returns_mean": {"default_agent": 0.4}, "num_env_steps_sampled": 400, "env_to_module_sum_episodes_length_out": 10.368238394470474, "num_episodes": 20, "num_agent_steps_sampled": {"default_agent": 400}, "num_episodes_lifetime": 120, "weights_seq_no": 6.0, "env_reset_timer": 0.0001574941595066687, "module_episode_returns_mean": {"default_policy": 0.4}, "rlmodule_inference_timer": 2.7105619035055406e-05, "env_to_module_sum_episodes_length_in": 10.368238394470474, "episode_return_max": 12.5, "episode_len_min": 20, "episode_len_mean": 20.0, "episode_duration_sec_mean": 0.005140062515856698, "env_step_timer": 1.3763171964549907e-05, "episode_return_mean": 0.4, "num_module_steps_sampled_lifetime": {"default_policy": 2400}, "episode_return_min": -12.5, "episode_len_max": 20, "num_env_steps_sampled_lifetime": 30400, "time_between_sampling": 1.8758767598188855}, "num_healthy_workers": 1, "actor_manager_num_outstanding_async_reqs": 0, "num_remote_worker_restarts": 0}, "num_env_steps_sampled_lifetime": -2460000.0, "fault_tolerance": {"num_healthy_workers": 0, "num_remote_worker_restarts": 0}, "env_runner_group": {"actor_manager_num_outstanding_async_reqs": 0}, "done": false, "training_iteration": 6, "trial_id": "43778_00000", "date": "2025-08-11_19-20-16", "timestamp": 1754932816, "time_this_iter_s": 1.7037990093231201, "time_total_s": 11.344326734542847, "pid": 14172, "hostname": "Mac", "node_ip": "127.0.0.1", "config": {"exploration_config": {}, "extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "placement_strategy": "PACK", "num_gpus": 0, "_fake_gpus": false, "num_cpus_for_main_process": 2, "eager_tracing": true, "eager_max_retraces": 20, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "torch_compile_learner": false, "torch_compile_learner_what_to_compile": "forward_train", "torch_compile_learner_dynamo_backend": "aot_eager", "torch_compile_learner_dynamo_mode": null, "torch_compile_worker": false, "torch_compile_worker_dynamo_backend": "aot_eager", "torch_compile_worker_dynamo_mode": null, "torch_ddp_kwargs": {}, "torch_skip_nan_gradients": false, "env": "Umbrella", "env_config": {}, "observation_space": null, "action_space": null, "clip_rewards": null, "normalize_actions": true, "clip_actions": false, "_is_atari": null, "disable_env_checking": false, "render_env": false, "action_mask_key": "action_mask", "env_runner_cls": null, "num_env_runners": 0, "create_local_env_runner": true, "num_envs_per_env_runner": 1, "gym_env_vectorize_mode": "SYNC", "num_cpus_per_env_runner": 1, "num_gpus_per_env_runner": 0, "custom_resources_per_env_runner": {}, "validate_env_runners_after_construction": true, "episodes_to_numpy": true, "max_requests_in_flight_per_env_runner": 1, "sample_timeout_s": 60.0, "_env_to_module_connector": null, "add_default_connectors_to_env_to_module_pipeline": true, "_module_to_env_connector": null, "add_default_connectors_to_module_to_env_pipeline": true, "merge_env_runner_states": "training_only", "broadcast_env_runner_states": true, "episode_lookback_horizon": 1, "rollout_fragment_length": "auto", "batch_mode": "complete_episodes", "compress_observations": false, "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "enable_tf1_exec_eagerly": false, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "preprocessor_pref": "deepmind", "observation_filter": "NoFilter", "update_worker_filter_stats": true, "use_worker_filter_stats": true, "sampler_perf_stats_ema_coef": null, "_is_online": true, "num_learners": 0, "num_gpus_per_learner": 0, "num_cpus_per_learner": "auto", "num_aggregator_actors_per_learner": 0, "max_requests_in_flight_per_aggregator_actor": 3, "local_gpu_idx": 0, "max_requests_in_flight_per_learner": 3, "gamma": 1, "lr": 0.0002847858517, "grad_clip": 0.5, "grad_clip_by": "global_norm", "_train_batch_size_per_learner": 5000, "train_batch_size": 4000, "num_epochs": 1, "minibatch_size": 1000, "shuffle_batch_per_epoch": true, "model": {"fcnet_hiddens": [256, 256], "fcnet_activation": "tanh", "fcnet_weights_initializer": null, "fcnet_weights_initializer_config": null, "fcnet_bias_initializer": null, "fcnet_bias_initializer_config": null, "conv_filters": null, "conv_activation": "relu", "conv_kernel_initializer": null, "conv_kernel_initializer_config": null, "conv_bias_initializer": null, "conv_bias_initializer_config": null, "conv_transpose_kernel_initializer": null, "conv_transpose_kernel_initializer_config": null, "conv_transpose_bias_initializer": null, "conv_transpose_bias_initializer_config": null, "post_fcnet_hiddens": [], "post_fcnet_activation": "relu", "post_fcnet_weights_initializer": null, "post_fcnet_weights_initializer_config": null, "post_fcnet_bias_initializer": null, "post_fcnet_bias_initializer_config": null, "free_log_std": false, "log_std_clip_param": 20.0, "no_final_linear": false, "vf_share_layers": false, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "lstm_weights_initializer": null, "lstm_weights_initializer_config": null, "lstm_bias_initializer": null, "lstm_bias_initializer_config": null, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "attention_use_n_prev_actions": 0, "attention_use_n_prev_rewards": 0, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": null, "custom_model_config": {}, "custom_action_dist": null, "custom_preprocessor": null, "encoder_latent_dim": null, "always_check_shapes": false, "lstm_use_prev_action_reward": -1, "_use_default_native_models": -1, "_disable_preprocessor_api": false, "_disable_action_flattening": false}, "_learner_connector": null, "add_default_connectors_to_learner_pipeline": true, "learner_config_dict": {}, "optimizer": {}, "_learner_class": null, "callbacks_on_algorithm_init": null, "callbacks_on_env_runners_recreated": null, "callbacks_on_offline_eval_runners_recreated": null, "callbacks_on_checkpoint_loaded": null, "callbacks_on_environment_created": null, "callbacks_on_episode_created": null, "callbacks_on_episode_start": null, "callbacks_on_episode_step": null, "callbacks_on_episode_end": null, "callbacks_on_evaluate_start": null, "callbacks_on_evaluate_end": null, "callbacks_on_evaluate_offline_start": null, "callbacks_on_evaluate_offline_end": null, "callbacks_on_sample_end": null, "callbacks_on_train_result": null, "explore": true, "enable_rl_module_and_learner": true, "enable_env_runner_and_connector_v2": true, "_prior_exploration_config": {"type": "StochasticSampling"}, "count_steps_by": "env_steps", "policy_map_capacity": 100, "policy_mapping_fn": "<function AlgorithmConfig.DEFAULT_POLICY_MAPPING_FN at 0x3888f18a0>", "policies_to_train": null, "policy_states_are_swappable": false, "observation_fn": null, "offline_data_class": null, "input_read_method": "read_parquet", "input_read_method_kwargs": {}, "input_read_schema": {}, "input_read_episodes": false, "input_read_sample_batches": false, "input_read_batch_size": null, "input_filesystem": null, "input_filesystem_kwargs": {}, "input_compress_columns": ["obs", "new_obs"], "input_spaces_jsonable": true, "materialize_data": false, "materialize_mapped_data": true, "map_batches_kwargs": {}, "iter_batches_kwargs": {}, "ignore_final_observation": false, "prelearner_class": null, "prelearner_buffer_class": null, "prelearner_buffer_kwargs": {}, "prelearner_module_synch_period": 10, "dataset_num_iters_per_learner": null, "input_config": {}, "actions_in_input_normalized": false, "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_config": {}, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "output_max_rows_per_file": null, "output_write_remaining_data": false, "output_write_method": "write_parquet", "output_write_method_kwargs": {}, "output_filesystem": null, "output_filesystem_kwargs": {}, "output_write_episodes": true, "offline_sampling": false, "evaluation_interval": 1, "evaluation_duration": 20, "evaluation_duration_unit": "episodes", "evaluation_sample_timeout_s": 120.0, "evaluation_auto_duration_min_env_steps_per_sample": 100, "evaluation_auto_duration_max_env_steps_per_sample": 2000, "evaluation_parallel_to_training": false, "evaluation_force_reset_envs_before_iteration": true, "evaluation_config": null, "off_policy_estimation_methods": {}, "ope_split_batch_by_episode": true, "evaluation_num_env_runners": 1, "in_evaluation": false, "sync_filters_on_rollout_workers_timeout_s": 10.0, "offline_evaluation_interval": null, "num_offline_eval_runners": 0, "offline_loss_for_module_fn": null, "offline_evaluation_duration": 1, "offline_evaluation_parallel_to_training": false, "offline_evaluation_timeout_s": 120.0, "num_cpus_per_offline_eval_runner": 1, "num_gpus_per_offline_eval_runner": 0, "custom_resources_per_offline_eval_runner": {}, "restart_failed_offline_eval_runners": true, "ignore_offline_eval_runner_failures": false, "max_num_offline_eval_runner_restarts": 1000, "offline_eval_runner_restore_timeout_s": 1800.0, "max_requests_in_flight_per_offline_eval_runner": 1, "validate_offline_eval_runners_after_construction": true, "offline_eval_runner_health_probe_timeout_s": 30.0, "offline_eval_rl_module_inference_only": false, "broadcast_offline_eval_runner_states": false, "offline_eval_batch_size_per_runner": 256, "dataset_num_iters_per_eval_runner": 1, "keep_per_episode_custom_metrics": false, "metrics_episode_collection_timeout_s": 60.0, "metrics_num_episodes_for_smoothing": 100, "min_time_s_per_iteration": null, "min_train_timesteps_per_iteration": 0, "min_sample_timesteps_per_iteration": 0, "log_gradients": true, "export_native_model_files": false, "checkpoint_trainable_policies_only": false, "logger_creator": null, "logger_config": null, "log_level": "WARN", "log_sys_usage": true, "fake_sampler": false, "seed": 1, "restart_failed_env_runners": true, "ignore_env_runner_failures": false, "max_num_env_runner_restarts": 1000, "delay_between_env_runner_restarts_s": 60.0, "restart_failed_sub_environments": false, "num_consecutive_env_runner_failures_tolerance": 100, "env_runner_health_probe_timeout_s": 30.0, "env_runner_restore_timeout_s": 1800.0, "_model_config": {}, "_rl_module_spec": "RLModuleSpec(module_class=None, observation_space=None, action_space=None, inference_only=False, learner_only=False, model_config=DefaultModelConfig(fcnet_hiddens=[60, 90], fcnet_activation='tanh', fcnet_kernel_initializer=None, fcnet_kernel_initializer_kwargs=None, fcnet_bias_initializer=None, fcnet_bias_initializer_kwargs=None, conv_filters=None, conv_activation='relu', conv_kernel_initializer=None, conv_kernel_initializer_kwargs=None, conv_bias_initializer=None, conv_bias_initializer_kwargs=None, head_fcnet_hiddens=[], head_fcnet_activation='relu', head_fcnet_kernel_initializer=None, head_fcnet_kernel_initializer_kwargs=None, head_fcnet_bias_initializer=None, head_fcnet_bias_initializer_kwargs=None, free_log_std=False, log_std_clip_param=20.0, vf_share_layers=True, use_lstm=False, max_seq_len=20, lstm_cell_size=256, lstm_use_prev_action=False, lstm_use_prev_reward=False, lstm_kernel_initializer=None, lstm_kernel_initializer_kwargs=None, lstm_bias_initializer=None, lstm_bias_initializer_kwargs=None), catalog_class=None, load_state_path=None, model_config_dict=None)", "algorithm_config_overrides_per_module": {}, "_per_module_overrides": {}, "_validate_config": true, "_use_msgpack_checkpoints": false, "_torch_grad_scaler_class": null, "_torch_lr_scheduler_classes": null, "_tf_policy_handles_more_than_one_loss": false, "_disable_preprocessor_api": false, "_disable_action_flattening": false, "_disable_initialize_loss_from_dummy_batch": false, "_dont_auto_sync_env_runner_states": false, "env_task_fn": -1, "enable_connectors": -1, "simple_optimizer": false, "policy_map_cache": -1, "worker_cls": -1, "synchronize_filters": -1, "enable_async_evaluation": -1, "custom_async_evaluation_function": -1, "_enable_rl_module_api": -1, "auto_wrap_old_gym_envs": -1, "always_attach_evaluation_results": -1, "replay_sequence_length": null, "_disable_execution_plan_api": -1, "use_critic": true, "use_gae": true, "use_kl_loss": true, "kl_coeff": 0.7464963036515, "kl_target": 0.0270990929592, "vf_loss_coeff": 0.6688075857018, "entropy_coeff": 0.0090570820258, "clip_param": 0.1221781641624, "vf_clip_param": 0.1027808522125, "entropy_coeff_schedule": null, "lr_schedule": null, "sgd_minibatch_size": -1, "vf_share_layers": -1, "__stdout_file__": null, "__stderr_file__": null, "lambda": 0.9099046732075, "input": "sampler", "policies": {"default_policy": [null, null, null, null]}, "callbacks": "<class 'ray.rllib.callbacks.callbacks.RLlibCallback'>", "create_env_on_driver": false, "custom_eval_function": null, "framework": "torch"}, "time_since_restore": 11.344326734542847, "iterations_since_restore": 6, "perf": {"cpu_util_percent": 57.23333333333334, "ram_util_percent": 81.56666666666666}}
{"timers": {"training_iteration": 1.909913908947053, "restore_env_runners": 1.2059412073384127e-05, "training_step": 1.9097579143451322, "env_runner_sampling_timer": 1.7907969702578903, "learner_update_timer": 0.11559517076430142, "synch_weights": 0.0007417931280816538, "restore_eval_env_runners": 8.925749280507302e-06, "evaluation_iteration": 0.1293333301450876, "synch_eval_env_connectors": 0.00011865416674084229, "synch_env_connectors": 5.572483472887392e-06}, "env_runners": {"env_to_module_connector": {"timers": {"connectors": {"add_observations_from_episodes_to_batch": 3.037159019377784e-06, "batch_individual_items": 6.504878596353687e-06, "numpy_to_tensor": 8.939683981941306e-06, "add_states_from_episodes_to_batch": 1.7646300442834134e-06, "add_time_dim_to_batch_and_zero_pad": 2.4129333331644213e-06}}, "connector_pipeline_timer": 4.4432835545757e-05}, "episode_len_mean": 20.0, "sample": 0.0050265139782697645, "module_to_env_connector": {"timers": {"connectors": {"get_actions": 4.0527788595048136e-05, "un_batch_to_individual_items": 5.563300804453874e-06, "normalize_and_clip_actions": 9.716118238054882e-06, "listify_data_for_vector_env": 1.1469547463272427e-05, "remove_single_ts_time_rank_from_batch": 5.984555788675908e-07, "tensor_to_numpy": 1.3660515584662778e-05}}, "connector_pipeline_timer": 0.00010736407792336328}, "num_module_steps_sampled": {"default_policy": 5000.0}, "num_agent_steps_sampled_lifetime": {"default_agent": -3077500.0}, "num_env_steps_sampled": 5000.0, "episode_duration_sec_mean": 0.004685741024091841, "num_agent_steps_sampled": {"default_agent": 5000.0}, "env_to_module_sum_episodes_length_out": 10.36823839457432, "num_episodes": 250.0, "time_between_sampling": 0.001871331918011622, "env_step_timer": 1.4351797151540165e-05, "agent_episode_returns_mean": {"default_agent": 3.98}, "episode_return_mean": 3.98, "num_module_steps_sampled_lifetime": {"default_policy": -3077500.0}, "env_to_module_sum_episodes_length_in": 10.36823839457432, "episode_return_max": 9.5, "num_episodes_lifetime": -153875.0, "weights_seq_no": 6.0, "module_episode_returns_mean": {"default_policy": 3.98}, "episode_return_min": -10.5, "episode_len_min": 20, "episode_len_max": 20, "env_reset_timer": 3.833469081117339e-05, "num_env_steps_sampled_lifetime": -3077500.0, "rlmodule_inference_timer": 2.8869940426030788e-05, "num_env_steps_sampled_lifetime_throughput": 3616.0571228797016}, "learners": {"__all_modules__": {"num_module_steps_trained_lifetime": 42000, "learner_connector_sum_episodes_length_in": 5000.0, "learner_connector": {"timers": {"connectors": {"add_observations_from_episodes_to_batch": 0.000823375355771839, "batch_individual_items": 0.03281999055543291, "general_advantage_estimation": 0.008006858718506793, "add_one_ts_to_episodes_and_truncate": 0.007681535331981785, "add_time_dim_to_batch_and_zero_pad": 1.2228517857539345e-05, "add_states_from_episodes_to_batch": 3.7654653466377583e-06, "add_columns_from_episodes_to_train_batch": 0.034322387604445385, "numpy_to_tensor": 7.21929182818119e-05}}, "connector_pipeline_timer": 0.08388723639648606}, "num_env_steps_trained": 31500, "num_env_steps_trained_lifetime": 220500, "num_non_trainable_parameters": 0, "learner_connector_sum_episodes_length_out": 5250.0, "num_module_steps_trained": 6000, "num_trainable_parameters": 6003, "num_env_steps_trained_lifetime_throughput": 1671689.2184507404, "num_module_steps_trained_throughput": 319556.8613773252, "num_module_steps_trained_lifetime_throughput": 319102.4970969539}, "default_policy": {"vf_loss": 0.10278083384037018, "curr_entropy_coeff": 0.0090570820258, "mean_kl_loss": 0.0006850841455161572, "weights_seq_no": 7.0, "module_train_batch_size_mean": 1000.0, "vf_explained_var": -0.018402576446533203, "gradients_default_optimizer_global_norm": 0.07997886091470718, "diff_num_grad_updates_vs_sampler_policy": 1.0, "default_optimizer_learning_rate": 0.0002847858517, "curr_kl_coeff": 0.0058320024982094765, "num_module_steps_trained": 6000, "num_trainable_parameters": 6003, "total_loss": 0.04111754521727562, "num_module_steps_trained_lifetime": 42000, "vf_loss_unclipped": 27.66732406616211, "policy_loss": -0.02193720079958439, "entropy": 0.6286616325378418, "num_module_steps_trained_lifetime_throughput": 320019.79237150896}}, "num_training_step_calls_per_iteration": 1, "evaluation": {"env_runners": {"sample": 0.12117010443660174, "num_module_steps_sampled": {"default_policy": 400}, "env_to_module_connector": {"timers": {"connectors": {"add_observations_from_episodes_to_batch": 2.8736723631251935e-06, "numpy_to_tensor": 8.315200057227477e-06, "batch_individual_items": 6.091602486285984e-06, "add_time_dim_to_batch_and_zero_pad": 2.2126646349918945e-06, "add_states_from_episodes_to_batch": 1.586135816360396e-06}}, "connector_pipeline_timer": 4.296288607082658e-05}, "num_agent_steps_sampled_lifetime": {"default_agent": 2800}, "module_to_env_connector": {"timers": {"connectors": {"tensor_to_numpy": 1.319797196756091e-05, "get_actions": 3.6875739607889813e-05, "listify_data_for_vector_env": 1.0963829134653772e-05, "normalize_and_clip_actions": 9.382593711388352e-06, "remove_single_ts_time_rank_from_batch": 5.817259257021274e-07, "un_batch_to_individual_items": 5.366847425811855e-06}}, "connector_pipeline_timer": 0.00010271334415303326}, "agent_episode_returns_mean": {"default_agent": 0.4}, "num_env_steps_sampled": 400, "env_to_module_sum_episodes_length_out": 10.368238394572801, "num_episodes": 20, "num_agent_steps_sampled": {"default_agent": 400}, "num_episodes_lifetime": 140, "weights_seq_no": 7.0, "env_reset_timer": 0.0001571946385661671, "module_episode_returns_mean": {"default_policy": 0.4}, "rlmodule_inference_timer": 2.7581108816972823e-05, "env_to_module_sum_episodes_length_in": 10.368238394572801, "episode_return_max": 12.5, "episode_len_min": 20, "episode_len_mean": 20.0, "episode_duration_sec_mean": 0.005091783355455845, "env_step_timer": 1.4002630433127344e-05, "episode_return_mean": 0.4, "num_module_steps_sampled_lifetime": {"default_policy": 2800}, "episode_return_min": -12.5, "episode_len_max": 20, "num_env_steps_sampled_lifetime": 35400, "time_between_sampling": 1.8724867201401094}, "num_healthy_workers": 1, "actor_manager_num_outstanding_async_reqs": 0, "num_remote_worker_restarts": 0}, "num_env_steps_sampled_lifetime": -3077500.0, "fault_tolerance": {"num_healthy_workers": 0, "num_remote_worker_restarts": 0}, "env_runner_group": {"actor_manager_num_outstanding_async_reqs": 0}, "done": false, "training_iteration": 7, "trial_id": "43778_00000", "date": "2025-08-11_19-20-18", "timestamp": 1754932818, "time_this_iter_s": 1.6252830028533936, "time_total_s": 12.96960973739624, "pid": 14172, "hostname": "Mac", "node_ip": "127.0.0.1", "config": {"exploration_config": {}, "extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "placement_strategy": "PACK", "num_gpus": 0, "_fake_gpus": false, "num_cpus_for_main_process": 2, "eager_tracing": true, "eager_max_retraces": 20, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "torch_compile_learner": false, "torch_compile_learner_what_to_compile": "forward_train", "torch_compile_learner_dynamo_backend": "aot_eager", "torch_compile_learner_dynamo_mode": null, "torch_compile_worker": false, "torch_compile_worker_dynamo_backend": "aot_eager", "torch_compile_worker_dynamo_mode": null, "torch_ddp_kwargs": {}, "torch_skip_nan_gradients": false, "env": "Umbrella", "env_config": {}, "observation_space": null, "action_space": null, "clip_rewards": null, "normalize_actions": true, "clip_actions": false, "_is_atari": null, "disable_env_checking": false, "render_env": false, "action_mask_key": "action_mask", "env_runner_cls": null, "num_env_runners": 0, "create_local_env_runner": true, "num_envs_per_env_runner": 1, "gym_env_vectorize_mode": "SYNC", "num_cpus_per_env_runner": 1, "num_gpus_per_env_runner": 0, "custom_resources_per_env_runner": {}, "validate_env_runners_after_construction": true, "episodes_to_numpy": true, "max_requests_in_flight_per_env_runner": 1, "sample_timeout_s": 60.0, "_env_to_module_connector": null, "add_default_connectors_to_env_to_module_pipeline": true, "_module_to_env_connector": null, "add_default_connectors_to_module_to_env_pipeline": true, "merge_env_runner_states": "training_only", "broadcast_env_runner_states": true, "episode_lookback_horizon": 1, "rollout_fragment_length": "auto", "batch_mode": "complete_episodes", "compress_observations": false, "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "enable_tf1_exec_eagerly": false, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "preprocessor_pref": "deepmind", "observation_filter": "NoFilter", "update_worker_filter_stats": true, "use_worker_filter_stats": true, "sampler_perf_stats_ema_coef": null, "_is_online": true, "num_learners": 0, "num_gpus_per_learner": 0, "num_cpus_per_learner": "auto", "num_aggregator_actors_per_learner": 0, "max_requests_in_flight_per_aggregator_actor": 3, "local_gpu_idx": 0, "max_requests_in_flight_per_learner": 3, "gamma": 1, "lr": 0.0002847858517, "grad_clip": 0.5, "grad_clip_by": "global_norm", "_train_batch_size_per_learner": 5000, "train_batch_size": 4000, "num_epochs": 1, "minibatch_size": 1000, "shuffle_batch_per_epoch": true, "model": {"fcnet_hiddens": [256, 256], "fcnet_activation": "tanh", "fcnet_weights_initializer": null, "fcnet_weights_initializer_config": null, "fcnet_bias_initializer": null, "fcnet_bias_initializer_config": null, "conv_filters": null, "conv_activation": "relu", "conv_kernel_initializer": null, "conv_kernel_initializer_config": null, "conv_bias_initializer": null, "conv_bias_initializer_config": null, "conv_transpose_kernel_initializer": null, "conv_transpose_kernel_initializer_config": null, "conv_transpose_bias_initializer": null, "conv_transpose_bias_initializer_config": null, "post_fcnet_hiddens": [], "post_fcnet_activation": "relu", "post_fcnet_weights_initializer": null, "post_fcnet_weights_initializer_config": null, "post_fcnet_bias_initializer": null, "post_fcnet_bias_initializer_config": null, "free_log_std": false, "log_std_clip_param": 20.0, "no_final_linear": false, "vf_share_layers": false, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "lstm_weights_initializer": null, "lstm_weights_initializer_config": null, "lstm_bias_initializer": null, "lstm_bias_initializer_config": null, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "attention_use_n_prev_actions": 0, "attention_use_n_prev_rewards": 0, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": null, "custom_model_config": {}, "custom_action_dist": null, "custom_preprocessor": null, "encoder_latent_dim": null, "always_check_shapes": false, "lstm_use_prev_action_reward": -1, "_use_default_native_models": -1, "_disable_preprocessor_api": false, "_disable_action_flattening": false}, "_learner_connector": null, "add_default_connectors_to_learner_pipeline": true, "learner_config_dict": {}, "optimizer": {}, "_learner_class": null, "callbacks_on_algorithm_init": null, "callbacks_on_env_runners_recreated": null, "callbacks_on_offline_eval_runners_recreated": null, "callbacks_on_checkpoint_loaded": null, "callbacks_on_environment_created": null, "callbacks_on_episode_created": null, "callbacks_on_episode_start": null, "callbacks_on_episode_step": null, "callbacks_on_episode_end": null, "callbacks_on_evaluate_start": null, "callbacks_on_evaluate_end": null, "callbacks_on_evaluate_offline_start": null, "callbacks_on_evaluate_offline_end": null, "callbacks_on_sample_end": null, "callbacks_on_train_result": null, "explore": true, "enable_rl_module_and_learner": true, "enable_env_runner_and_connector_v2": true, "_prior_exploration_config": {"type": "StochasticSampling"}, "count_steps_by": "env_steps", "policy_map_capacity": 100, "policy_mapping_fn": "<function AlgorithmConfig.DEFAULT_POLICY_MAPPING_FN at 0x3888f18a0>", "policies_to_train": null, "policy_states_are_swappable": false, "observation_fn": null, "offline_data_class": null, "input_read_method": "read_parquet", "input_read_method_kwargs": {}, "input_read_schema": {}, "input_read_episodes": false, "input_read_sample_batches": false, "input_read_batch_size": null, "input_filesystem": null, "input_filesystem_kwargs": {}, "input_compress_columns": ["obs", "new_obs"], "input_spaces_jsonable": true, "materialize_data": false, "materialize_mapped_data": true, "map_batches_kwargs": {}, "iter_batches_kwargs": {}, "ignore_final_observation": false, "prelearner_class": null, "prelearner_buffer_class": null, "prelearner_buffer_kwargs": {}, "prelearner_module_synch_period": 10, "dataset_num_iters_per_learner": null, "input_config": {}, "actions_in_input_normalized": false, "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_config": {}, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "output_max_rows_per_file": null, "output_write_remaining_data": false, "output_write_method": "write_parquet", "output_write_method_kwargs": {}, "output_filesystem": null, "output_filesystem_kwargs": {}, "output_write_episodes": true, "offline_sampling": false, "evaluation_interval": 1, "evaluation_duration": 20, "evaluation_duration_unit": "episodes", "evaluation_sample_timeout_s": 120.0, "evaluation_auto_duration_min_env_steps_per_sample": 100, "evaluation_auto_duration_max_env_steps_per_sample": 2000, "evaluation_parallel_to_training": false, "evaluation_force_reset_envs_before_iteration": true, "evaluation_config": null, "off_policy_estimation_methods": {}, "ope_split_batch_by_episode": true, "evaluation_num_env_runners": 1, "in_evaluation": false, "sync_filters_on_rollout_workers_timeout_s": 10.0, "offline_evaluation_interval": null, "num_offline_eval_runners": 0, "offline_loss_for_module_fn": null, "offline_evaluation_duration": 1, "offline_evaluation_parallel_to_training": false, "offline_evaluation_timeout_s": 120.0, "num_cpus_per_offline_eval_runner": 1, "num_gpus_per_offline_eval_runner": 0, "custom_resources_per_offline_eval_runner": {}, "restart_failed_offline_eval_runners": true, "ignore_offline_eval_runner_failures": false, "max_num_offline_eval_runner_restarts": 1000, "offline_eval_runner_restore_timeout_s": 1800.0, "max_requests_in_flight_per_offline_eval_runner": 1, "validate_offline_eval_runners_after_construction": true, "offline_eval_runner_health_probe_timeout_s": 30.0, "offline_eval_rl_module_inference_only": false, "broadcast_offline_eval_runner_states": false, "offline_eval_batch_size_per_runner": 256, "dataset_num_iters_per_eval_runner": 1, "keep_per_episode_custom_metrics": false, "metrics_episode_collection_timeout_s": 60.0, "metrics_num_episodes_for_smoothing": 100, "min_time_s_per_iteration": null, "min_train_timesteps_per_iteration": 0, "min_sample_timesteps_per_iteration": 0, "log_gradients": true, "export_native_model_files": false, "checkpoint_trainable_policies_only": false, "logger_creator": null, "logger_config": null, "log_level": "WARN", "log_sys_usage": true, "fake_sampler": false, "seed": 1, "restart_failed_env_runners": true, "ignore_env_runner_failures": false, "max_num_env_runner_restarts": 1000, "delay_between_env_runner_restarts_s": 60.0, "restart_failed_sub_environments": false, "num_consecutive_env_runner_failures_tolerance": 100, "env_runner_health_probe_timeout_s": 30.0, "env_runner_restore_timeout_s": 1800.0, "_model_config": {}, "_rl_module_spec": "RLModuleSpec(module_class=None, observation_space=None, action_space=None, inference_only=False, learner_only=False, model_config=DefaultModelConfig(fcnet_hiddens=[60, 90], fcnet_activation='tanh', fcnet_kernel_initializer=None, fcnet_kernel_initializer_kwargs=None, fcnet_bias_initializer=None, fcnet_bias_initializer_kwargs=None, conv_filters=None, conv_activation='relu', conv_kernel_initializer=None, conv_kernel_initializer_kwargs=None, conv_bias_initializer=None, conv_bias_initializer_kwargs=None, head_fcnet_hiddens=[], head_fcnet_activation='relu', head_fcnet_kernel_initializer=None, head_fcnet_kernel_initializer_kwargs=None, head_fcnet_bias_initializer=None, head_fcnet_bias_initializer_kwargs=None, free_log_std=False, log_std_clip_param=20.0, vf_share_layers=True, use_lstm=False, max_seq_len=20, lstm_cell_size=256, lstm_use_prev_action=False, lstm_use_prev_reward=False, lstm_kernel_initializer=None, lstm_kernel_initializer_kwargs=None, lstm_bias_initializer=None, lstm_bias_initializer_kwargs=None), catalog_class=None, load_state_path=None, model_config_dict=None)", "algorithm_config_overrides_per_module": {}, "_per_module_overrides": {}, "_validate_config": true, "_use_msgpack_checkpoints": false, "_torch_grad_scaler_class": null, "_torch_lr_scheduler_classes": null, "_tf_policy_handles_more_than_one_loss": false, "_disable_preprocessor_api": false, "_disable_action_flattening": false, "_disable_initialize_loss_from_dummy_batch": false, "_dont_auto_sync_env_runner_states": false, "env_task_fn": -1, "enable_connectors": -1, "simple_optimizer": false, "policy_map_cache": -1, "worker_cls": -1, "synchronize_filters": -1, "enable_async_evaluation": -1, "custom_async_evaluation_function": -1, "_enable_rl_module_api": -1, "auto_wrap_old_gym_envs": -1, "always_attach_evaluation_results": -1, "replay_sequence_length": null, "_disable_execution_plan_api": -1, "use_critic": true, "use_gae": true, "use_kl_loss": true, "kl_coeff": 0.7464963036515, "kl_target": 0.0270990929592, "vf_loss_coeff": 0.6688075857018, "entropy_coeff": 0.0090570820258, "clip_param": 0.1221781641624, "vf_clip_param": 0.1027808522125, "entropy_coeff_schedule": null, "lr_schedule": null, "sgd_minibatch_size": -1, "vf_share_layers": -1, "__stdout_file__": null, "__stderr_file__": null, "lambda": 0.9099046732075, "input": "sampler", "policies": {"default_policy": [null, null, null, null]}, "callbacks": "<class 'ray.rllib.callbacks.callbacks.RLlibCallback'>", "create_env_on_driver": false, "custom_eval_function": null, "framework": "torch"}, "time_since_restore": 12.96960973739624, "iterations_since_restore": 7, "perf": {"cpu_util_percent": 50.849999999999994, "ram_util_percent": 82.05}}
{"timers": {"training_iteration": 1.9090015615271596, "restore_env_runners": 1.2003818447592356e-05, "training_step": 1.9088451981219967, "env_runner_sampling_timer": 1.790129490965788, "learner_update_timer": 0.11535108613738042, "synch_weights": 0.0007400135261130425, "restore_eval_env_runners": 8.936911644310144e-06, "evaluation_iteration": 0.12908169101419928, "synch_eval_env_connectors": 0.00011872137501584088, "synch_env_connectors": 5.556338683426458e-06}, "env_runners": {"env_to_module_connector": {"timers": {"connectors": {"add_observations_from_episodes_to_batch": 3.482187994704995e-06, "batch_individual_items": 7.159138878239525e-06, "numpy_to_tensor": 1.0050577025594871e-05, "add_states_from_episodes_to_batch": 1.8765563950709802e-06, "add_time_dim_to_batch_and_zero_pad": 2.6208994975542394e-06}}, "connector_pipeline_timer": 4.852943485589876e-05}, "episode_len_mean": 20.0, "sample": 0.005923098880526646, "module_to_env_connector": {"timers": {"connectors": {"get_actions": 4.651861825045171e-05, "un_batch_to_individual_items": 6.106899379523798e-06, "normalize_and_clip_actions": 1.0846509745571917e-05, "listify_data_for_vector_env": 1.267185687969376e-05, "remove_single_ts_time_rank_from_batch": 6.526417887011413e-07, "tensor_to_numpy": 1.5122173960862078e-05}}, "connector_pipeline_timer": 0.00012025123188485554}, "num_module_steps_sampled": {"default_policy": 5000.0}, "num_agent_steps_sampled_lifetime": {"default_agent": -3695000.0}, "num_env_steps_sampled": 5000.0, "episode_duration_sec_mean": 0.005801345038227737, "num_agent_steps_sampled": {"default_agent": 5000.0}, "env_to_module_sum_episodes_length_out": 10.36823839457432, "num_episodes": 250.0, "time_between_sampling": 0.0015889556604604964, "env_step_timer": 1.6190424196150647e-05, "agent_episode_returns_mean": {"default_agent": 3.339999999999999}, "episode_return_mean": 3.339999999999999, "num_module_steps_sampled_lifetime": {"default_policy": -3695000.0}, "env_to_module_sum_episodes_length_in": 10.36823839457432, "episode_return_max": 9.5, "num_episodes_lifetime": -184750.0, "weights_seq_no": 7.0, "module_episode_returns_mean": {"default_policy": 3.339999999999999}, "episode_return_min": -10.5, "episode_len_min": 20, "episode_len_max": 20, "env_reset_timer": 4.497329445517852e-05, "num_env_steps_sampled_lifetime": -3695000.0, "rlmodule_inference_timer": 5.86997293964398e-05, "num_env_steps_sampled_lifetime_throughput": 3301.5615245227623}, "learners": {"__all_modules__": {"num_module_steps_trained_lifetime": 48000, "learner_connector_sum_episodes_length_in": 5000.0, "learner_connector": {"timers": {"connectors": {"add_observations_from_episodes_to_batch": 0.0008258261818249452, "batch_individual_items": 0.0327924444001883, "general_advantage_estimation": 0.007978556381138589, "add_one_ts_to_episodes_and_truncate": 0.00768317372971004, "add_time_dim_to_batch_and_zero_pad": 1.2190402120798043e-05, "add_states_from_episodes_to_batch": 3.759890099254011e-06, "add_columns_from_episodes_to_train_batch": 0.03431848455777192, "numpy_to_tensor": 7.201806893408083e-05}}, "connector_pipeline_timer": 0.08383080695312964}, "num_env_steps_trained": 31500, "num_env_steps_trained_lifetime": 252000, "num_non_trainable_parameters": 0, "learner_connector_sum_episodes_length_out": 5250.0, "num_module_steps_trained": 6000, "num_trainable_parameters": 6003, "num_env_steps_trained_lifetime_throughput": 1690876.6647671803, "num_module_steps_trained_throughput": 323175.98076382466, "num_module_steps_trained_lifetime_throughput": 322732.87891515275}, "default_policy": {"vf_loss": 0.10278083384037018, "curr_entropy_coeff": 0.0090570820258, "mean_kl_loss": 0.0005429149605333805, "weights_seq_no": 8.0, "module_train_batch_size_mean": 1000.0, "vf_explained_var": -0.018987655639648438, "gradients_default_optimizer_global_norm": 0.016191862523555756, "diff_num_grad_updates_vs_sampler_policy": 1.0, "default_optimizer_learning_rate": 0.0002847858517, "curr_kl_coeff": 0.0029160012491047382, "num_module_steps_trained": 6000, "num_trainable_parameters": 6003, "total_loss": -0.014293914660811424, "num_module_steps_trained_lifetime": 48000, "vf_loss_unclipped": 27.65814781188965, "policy_loss": -0.07748422771692276, "entropy": 0.6131623983383179, "num_module_steps_trained_lifetime_throughput": 323585.52235583076}}, "num_training_step_calls_per_iteration": 1, "evaluation": {"env_runners": {"sample": 0.12094780381187514, "num_module_steps_sampled": {"default_policy": 400}, "env_to_module_connector": {"timers": {"connectors": {"add_observations_from_episodes_to_batch": 2.837552420121489e-06, "numpy_to_tensor": 8.335313522833968e-06, "batch_individual_items": 6.0576811216184425e-06, "add_time_dim_to_batch_and_zero_pad": 2.18897407100707e-06, "add_states_from_episodes_to_batch": 1.5769923484526911e-06}}, "connector_pipeline_timer": 4.246375256891338e-05}, "num_agent_steps_sampled_lifetime": {"default_agent": 3200}, "module_to_env_connector": {"timers": {"connectors": {"tensor_to_numpy": 1.3121439144145066e-05, "get_actions": 3.725701745580497e-05, "listify_data_for_vector_env": 1.0788041345407892e-05, "normalize_and_clip_actions": 9.333227304382256e-06, "remove_single_ts_time_rank_from_batch": 5.795141334722463e-07, "un_batch_to_individual_items": 5.376852518559198e-06}}, "connector_pipeline_timer": 0.00010216803279024703}, "agent_episode_returns_mean": {"default_agent": -0.6}, "num_env_steps_sampled": 400, "env_to_module_sum_episodes_length_out": 10.3682383945743, "num_episodes": 20, "num_agent_steps_sampled": {"default_agent": 400}, "num_episodes_lifetime": 160, "weights_seq_no": 8.0, "env_reset_timer": 0.00015638644188427036, "module_episode_returns_mean": {"default_policy": -0.6}, "rlmodule_inference_timer": 2.772148933953664e-05, "env_to_module_sum_episodes_length_in": 10.3682383945743, "episode_return_max": 12.5, "episode_len_min": 20, "episode_len_mean": 20.0, "episode_duration_sec_mean": 0.005003938769223168, "env_step_timer": 1.4033446069374576e-05, "episode_return_mean": -0.6, "num_module_steps_sampled_lifetime": {"default_policy": 3200}, "episode_return_min": -12.5, "episode_len_max": 20, "num_env_steps_sampled_lifetime": 40400, "time_between_sampling": 1.8721253879389526}, "num_healthy_workers": 1, "actor_manager_num_outstanding_async_reqs": 0, "num_remote_worker_restarts": 0}, "num_env_steps_sampled_lifetime": -3695000.0, "fault_tolerance": {"num_healthy_workers": 0, "num_remote_worker_restarts": 0}, "env_runner_group": {"actor_manager_num_outstanding_async_reqs": 0}, "done": false, "training_iteration": 8, "trial_id": "43778_00000", "date": "2025-08-11_19-20-20", "timestamp": 1754932820, "time_this_iter_s": 1.9245502948760986, "time_total_s": 14.894160032272339, "pid": 14172, "hostname": "Mac", "node_ip": "127.0.0.1", "config": {"exploration_config": {}, "extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "placement_strategy": "PACK", "num_gpus": 0, "_fake_gpus": false, "num_cpus_for_main_process": 2, "eager_tracing": true, "eager_max_retraces": 20, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "torch_compile_learner": false, "torch_compile_learner_what_to_compile": "forward_train", "torch_compile_learner_dynamo_backend": "aot_eager", "torch_compile_learner_dynamo_mode": null, "torch_compile_worker": false, "torch_compile_worker_dynamo_backend": "aot_eager", "torch_compile_worker_dynamo_mode": null, "torch_ddp_kwargs": {}, "torch_skip_nan_gradients": false, "env": "Umbrella", "env_config": {}, "observation_space": null, "action_space": null, "clip_rewards": null, "normalize_actions": true, "clip_actions": false, "_is_atari": null, "disable_env_checking": false, "render_env": false, "action_mask_key": "action_mask", "env_runner_cls": null, "num_env_runners": 0, "create_local_env_runner": true, "num_envs_per_env_runner": 1, "gym_env_vectorize_mode": "SYNC", "num_cpus_per_env_runner": 1, "num_gpus_per_env_runner": 0, "custom_resources_per_env_runner": {}, "validate_env_runners_after_construction": true, "episodes_to_numpy": true, "max_requests_in_flight_per_env_runner": 1, "sample_timeout_s": 60.0, "_env_to_module_connector": null, "add_default_connectors_to_env_to_module_pipeline": true, "_module_to_env_connector": null, "add_default_connectors_to_module_to_env_pipeline": true, "merge_env_runner_states": "training_only", "broadcast_env_runner_states": true, "episode_lookback_horizon": 1, "rollout_fragment_length": "auto", "batch_mode": "complete_episodes", "compress_observations": false, "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "enable_tf1_exec_eagerly": false, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "preprocessor_pref": "deepmind", "observation_filter": "NoFilter", "update_worker_filter_stats": true, "use_worker_filter_stats": true, "sampler_perf_stats_ema_coef": null, "_is_online": true, "num_learners": 0, "num_gpus_per_learner": 0, "num_cpus_per_learner": "auto", "num_aggregator_actors_per_learner": 0, "max_requests_in_flight_per_aggregator_actor": 3, "local_gpu_idx": 0, "max_requests_in_flight_per_learner": 3, "gamma": 1, "lr": 0.0002847858517, "grad_clip": 0.5, "grad_clip_by": "global_norm", "_train_batch_size_per_learner": 5000, "train_batch_size": 4000, "num_epochs": 1, "minibatch_size": 1000, "shuffle_batch_per_epoch": true, "model": {"fcnet_hiddens": [256, 256], "fcnet_activation": "tanh", "fcnet_weights_initializer": null, "fcnet_weights_initializer_config": null, "fcnet_bias_initializer": null, "fcnet_bias_initializer_config": null, "conv_filters": null, "conv_activation": "relu", "conv_kernel_initializer": null, "conv_kernel_initializer_config": null, "conv_bias_initializer": null, "conv_bias_initializer_config": null, "conv_transpose_kernel_initializer": null, "conv_transpose_kernel_initializer_config": null, "conv_transpose_bias_initializer": null, "conv_transpose_bias_initializer_config": null, "post_fcnet_hiddens": [], "post_fcnet_activation": "relu", "post_fcnet_weights_initializer": null, "post_fcnet_weights_initializer_config": null, "post_fcnet_bias_initializer": null, "post_fcnet_bias_initializer_config": null, "free_log_std": false, "log_std_clip_param": 20.0, "no_final_linear": false, "vf_share_layers": false, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "lstm_weights_initializer": null, "lstm_weights_initializer_config": null, "lstm_bias_initializer": null, "lstm_bias_initializer_config": null, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "attention_use_n_prev_actions": 0, "attention_use_n_prev_rewards": 0, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": null, "custom_model_config": {}, "custom_action_dist": null, "custom_preprocessor": null, "encoder_latent_dim": null, "always_check_shapes": false, "lstm_use_prev_action_reward": -1, "_use_default_native_models": -1, "_disable_preprocessor_api": false, "_disable_action_flattening": false}, "_learner_connector": null, "add_default_connectors_to_learner_pipeline": true, "learner_config_dict": {}, "optimizer": {}, "_learner_class": null, "callbacks_on_algorithm_init": null, "callbacks_on_env_runners_recreated": null, "callbacks_on_offline_eval_runners_recreated": null, "callbacks_on_checkpoint_loaded": null, "callbacks_on_environment_created": null, "callbacks_on_episode_created": null, "callbacks_on_episode_start": null, "callbacks_on_episode_step": null, "callbacks_on_episode_end": null, "callbacks_on_evaluate_start": null, "callbacks_on_evaluate_end": null, "callbacks_on_evaluate_offline_start": null, "callbacks_on_evaluate_offline_end": null, "callbacks_on_sample_end": null, "callbacks_on_train_result": null, "explore": true, "enable_rl_module_and_learner": true, "enable_env_runner_and_connector_v2": true, "_prior_exploration_config": {"type": "StochasticSampling"}, "count_steps_by": "env_steps", "policy_map_capacity": 100, "policy_mapping_fn": "<function AlgorithmConfig.DEFAULT_POLICY_MAPPING_FN at 0x3888f18a0>", "policies_to_train": null, "policy_states_are_swappable": false, "observation_fn": null, "offline_data_class": null, "input_read_method": "read_parquet", "input_read_method_kwargs": {}, "input_read_schema": {}, "input_read_episodes": false, "input_read_sample_batches": false, "input_read_batch_size": null, "input_filesystem": null, "input_filesystem_kwargs": {}, "input_compress_columns": ["obs", "new_obs"], "input_spaces_jsonable": true, "materialize_data": false, "materialize_mapped_data": true, "map_batches_kwargs": {}, "iter_batches_kwargs": {}, "ignore_final_observation": false, "prelearner_class": null, "prelearner_buffer_class": null, "prelearner_buffer_kwargs": {}, "prelearner_module_synch_period": 10, "dataset_num_iters_per_learner": null, "input_config": {}, "actions_in_input_normalized": false, "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_config": {}, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "output_max_rows_per_file": null, "output_write_remaining_data": false, "output_write_method": "write_parquet", "output_write_method_kwargs": {}, "output_filesystem": null, "output_filesystem_kwargs": {}, "output_write_episodes": true, "offline_sampling": false, "evaluation_interval": 1, "evaluation_duration": 20, "evaluation_duration_unit": "episodes", "evaluation_sample_timeout_s": 120.0, "evaluation_auto_duration_min_env_steps_per_sample": 100, "evaluation_auto_duration_max_env_steps_per_sample": 2000, "evaluation_parallel_to_training": false, "evaluation_force_reset_envs_before_iteration": true, "evaluation_config": null, "off_policy_estimation_methods": {}, "ope_split_batch_by_episode": true, "evaluation_num_env_runners": 1, "in_evaluation": false, "sync_filters_on_rollout_workers_timeout_s": 10.0, "offline_evaluation_interval": null, "num_offline_eval_runners": 0, "offline_loss_for_module_fn": null, "offline_evaluation_duration": 1, "offline_evaluation_parallel_to_training": false, "offline_evaluation_timeout_s": 120.0, "num_cpus_per_offline_eval_runner": 1, "num_gpus_per_offline_eval_runner": 0, "custom_resources_per_offline_eval_runner": {}, "restart_failed_offline_eval_runners": true, "ignore_offline_eval_runner_failures": false, "max_num_offline_eval_runner_restarts": 1000, "offline_eval_runner_restore_timeout_s": 1800.0, "max_requests_in_flight_per_offline_eval_runner": 1, "validate_offline_eval_runners_after_construction": true, "offline_eval_runner_health_probe_timeout_s": 30.0, "offline_eval_rl_module_inference_only": false, "broadcast_offline_eval_runner_states": false, "offline_eval_batch_size_per_runner": 256, "dataset_num_iters_per_eval_runner": 1, "keep_per_episode_custom_metrics": false, "metrics_episode_collection_timeout_s": 60.0, "metrics_num_episodes_for_smoothing": 100, "min_time_s_per_iteration": null, "min_train_timesteps_per_iteration": 0, "min_sample_timesteps_per_iteration": 0, "log_gradients": true, "export_native_model_files": false, "checkpoint_trainable_policies_only": false, "logger_creator": null, "logger_config": null, "log_level": "WARN", "log_sys_usage": true, "fake_sampler": false, "seed": 1, "restart_failed_env_runners": true, "ignore_env_runner_failures": false, "max_num_env_runner_restarts": 1000, "delay_between_env_runner_restarts_s": 60.0, "restart_failed_sub_environments": false, "num_consecutive_env_runner_failures_tolerance": 100, "env_runner_health_probe_timeout_s": 30.0, "env_runner_restore_timeout_s": 1800.0, "_model_config": {}, "_rl_module_spec": "RLModuleSpec(module_class=None, observation_space=None, action_space=None, inference_only=False, learner_only=False, model_config=DefaultModelConfig(fcnet_hiddens=[60, 90], fcnet_activation='tanh', fcnet_kernel_initializer=None, fcnet_kernel_initializer_kwargs=None, fcnet_bias_initializer=None, fcnet_bias_initializer_kwargs=None, conv_filters=None, conv_activation='relu', conv_kernel_initializer=None, conv_kernel_initializer_kwargs=None, conv_bias_initializer=None, conv_bias_initializer_kwargs=None, head_fcnet_hiddens=[], head_fcnet_activation='relu', head_fcnet_kernel_initializer=None, head_fcnet_kernel_initializer_kwargs=None, head_fcnet_bias_initializer=None, head_fcnet_bias_initializer_kwargs=None, free_log_std=False, log_std_clip_param=20.0, vf_share_layers=True, use_lstm=False, max_seq_len=20, lstm_cell_size=256, lstm_use_prev_action=False, lstm_use_prev_reward=False, lstm_kernel_initializer=None, lstm_kernel_initializer_kwargs=None, lstm_bias_initializer=None, lstm_bias_initializer_kwargs=None), catalog_class=None, load_state_path=None, model_config_dict=None)", "algorithm_config_overrides_per_module": {}, "_per_module_overrides": {}, "_validate_config": true, "_use_msgpack_checkpoints": false, "_torch_grad_scaler_class": null, "_torch_lr_scheduler_classes": null, "_tf_policy_handles_more_than_one_loss": false, "_disable_preprocessor_api": false, "_disable_action_flattening": false, "_disable_initialize_loss_from_dummy_batch": false, "_dont_auto_sync_env_runner_states": false, "env_task_fn": -1, "enable_connectors": -1, "simple_optimizer": false, "policy_map_cache": -1, "worker_cls": -1, "synchronize_filters": -1, "enable_async_evaluation": -1, "custom_async_evaluation_function": -1, "_enable_rl_module_api": -1, "auto_wrap_old_gym_envs": -1, "always_attach_evaluation_results": -1, "replay_sequence_length": null, "_disable_execution_plan_api": -1, "use_critic": true, "use_gae": true, "use_kl_loss": true, "kl_coeff": 0.7464963036515, "kl_target": 0.0270990929592, "vf_loss_coeff": 0.6688075857018, "entropy_coeff": 0.0090570820258, "clip_param": 0.1221781641624, "vf_clip_param": 0.1027808522125, "entropy_coeff_schedule": null, "lr_schedule": null, "sgd_minibatch_size": -1, "vf_share_layers": -1, "__stdout_file__": null, "__stderr_file__": null, "lambda": 0.9099046732075, "input": "sampler", "policies": {"default_policy": [null, null, null, null]}, "callbacks": "<class 'ray.rllib.callbacks.callbacks.RLlibCallback'>", "create_env_on_driver": false, "custom_eval_function": null, "framework": "torch"}, "time_since_restore": 14.894160032272339, "iterations_since_restore": 8, "perf": {"cpu_util_percent": 48.56666666666666, "ram_util_percent": 81.63333333333334}}
{"timers": {"training_iteration": 1.9063021000717677, "restore_env_runners": 1.1936280080800726e-05, "training_step": 1.9061457640514732, "env_runner_sampling_timer": 1.7867881852260685, "learner_update_timer": 0.11599441860638246, "synch_weights": 0.0007390796403215798, "restore_eval_env_runners": 8.907132038650595e-06, "evaluation_iteration": 0.1288275157739826, "synch_eval_env_connectors": 0.00011909666210387279, "synch_env_connectors": 5.539945559927302e-06}, "env_runners": {"env_to_module_connector": {"timers": {"connectors": {"add_observations_from_episodes_to_batch": 3.1422439378673137e-06, "batch_individual_items": 6.710598627177475e-06, "numpy_to_tensor": 9.229170197419796e-06, "add_states_from_episodes_to_batch": 1.7946801607380755e-06, "add_time_dim_to_batch_and_zero_pad": 2.4377696405149636e-06}}, "connector_pipeline_timer": 4.552725403096716e-05}, "episode_len_mean": 20.0, "sample": 0.005301436756365874, "module_to_env_connector": {"timers": {"connectors": {"get_actions": 4.1813003832405416e-05, "un_batch_to_individual_items": 5.650247321022829e-06, "normalize_and_clip_actions": 9.852683598356966e-06, "listify_data_for_vector_env": 1.1563846821369235e-05, "remove_single_ts_time_rank_from_batch": 6.176735911962935e-07, "tensor_to_numpy": 1.3972343584861625e-05}}, "connector_pipeline_timer": 0.00010980052500701792}, "num_module_steps_sampled": {"default_policy": 5000.0}, "num_agent_steps_sampled_lifetime": {"default_agent": -4312500.0}, "num_env_steps_sampled": 5000.0, "episode_duration_sec_mean": 0.004800902314484119, "num_agent_steps_sampled": {"default_agent": 5000.0}, "env_to_module_sum_episodes_length_out": 10.36823839457432, "num_episodes": 250.0, "time_between_sampling": 0.0015265822356056121, "env_step_timer": 1.4585591685536763e-05, "agent_episode_returns_mean": {"default_agent": 5.259999999999999}, "episode_return_mean": 5.259999999999999, "num_module_steps_sampled_lifetime": {"default_policy": -4312500.0}, "env_to_module_sum_episodes_length_in": 10.36823839457432, "episode_return_max": 9.5, "num_episodes_lifetime": -215625.0, "weights_seq_no": 8.0, "module_episode_returns_mean": {"default_policy": 5.259999999999999}, "episode_return_min": -10.5, "episode_len_min": 20, "episode_len_max": 20, "env_reset_timer": 4.059798540793713e-05, "num_env_steps_sampled_lifetime": -4312500.0, "rlmodule_inference_timer": 2.967508303939045e-05, "num_env_steps_sampled_lifetime_throughput": 3572.6160936562364}, "learners": {"__all_modules__": {"num_module_steps_trained_lifetime": 54000, "learner_connector_sum_episodes_length_in": 5000.0, "learner_connector": {"timers": {"connectors": {"add_observations_from_episodes_to_batch": 0.00082582208995882, "batch_individual_items": 0.032769114956529816, "general_advantage_estimation": 0.007951730816629607, "add_one_ts_to_episodes_and_truncate": 0.008563644492441104, "add_time_dim_to_batch_and_zero_pad": 1.2176828377316117e-05, "add_states_from_episodes_to_batch": 3.7531307811666443e-06, "add_columns_from_episodes_to_train_batch": 0.03431717554239377, "numpy_to_tensor": 7.190663793241167e-05}}, "connector_pipeline_timer": 0.08465920263397773}, "num_env_steps_trained": 31500, "num_env_steps_trained_lifetime": 283500, "num_non_trainable_parameters": 0, "learner_connector_sum_episodes_length_out": 5250.0, "num_module_steps_trained": 6000, "num_trainable_parameters": 6003, "num_env_steps_trained_lifetime_throughput": 1713402.6637295973, "num_module_steps_trained_throughput": 327430.3413803294, "num_module_steps_trained_lifetime_throughput": 326998.3677327366}, "default_policy": {"vf_loss": 0.10278083384037018, "curr_entropy_coeff": 0.0090570820258, "mean_kl_loss": 0.0004298215499147773, "weights_seq_no": 9.0, "module_train_batch_size_mean": 1000.0, "vf_explained_var": -0.019598960876464844, "gradients_default_optimizer_global_norm": 0.05883348360657692, "diff_num_grad_updates_vs_sampler_policy": 1.0, "default_optimizer_learning_rate": 0.0002847858517, "curr_kl_coeff": 0.0014580006245523691, "num_module_steps_trained": 6000, "num_trainable_parameters": 6003, "total_loss": 0.12476349622011185, "num_module_steps_trained_lifetime": 54000, "vf_loss_unclipped": 27.53458595275879, "policy_loss": 0.06147141009569168, "entropy": 0.6017114520072937, "num_module_steps_trained_lifetime_throughput": 327786.72680534644}}, "num_training_step_calls_per_iteration": 1, "evaluation": {"env_runners": {"sample": 0.1207093020228384, "num_module_steps_sampled": {"default_policy": 400}, "env_to_module_connector": {"timers": {"connectors": {"add_observations_from_episodes_to_batch": 2.7897741340799336e-06, "numpy_to_tensor": 8.069998867475164e-06, "batch_individual_items": 5.941659663734894e-06, "add_time_dim_to_batch_and_zero_pad": 2.1774643415252392e-06, "add_states_from_episodes_to_batch": 1.5825729342698575e-06}}, "connector_pipeline_timer": 4.2057943088192996e-05}, "num_agent_steps_sampled_lifetime": {"default_agent": 3600}, "module_to_env_connector": {"timers": {"connectors": {"tensor_to_numpy": 1.2843593114254137e-05, "get_actions": 3.610415401220569e-05, "listify_data_for_vector_env": 1.0640382414487222e-05, "normalize_and_clip_actions": 9.25395517268009e-06, "remove_single_ts_time_rank_from_batch": 5.64652033335488e-07, "un_batch_to_individual_items": 5.313605467740463e-06}}, "connector_pipeline_timer": 0.00010062897472691783}, "agent_episode_returns_mean": {"default_agent": -1.2}, "num_env_steps_sampled": 400, "env_to_module_sum_episodes_length_out": 10.368238394574323, "num_episodes": 20, "num_agent_steps_sampled": {"default_agent": 400}, "num_episodes_lifetime": 180, "weights_seq_no": 9.0, "env_reset_timer": 0.0001557300779727377, "module_episode_returns_mean": {"default_policy": -1.2}, "rlmodule_inference_timer": 2.6920874588496893e-05, "env_to_module_sum_episodes_length_in": 10.368238394574323, "episode_return_max": 12.5, "episode_len_min": 20, "episode_len_mean": 20.0, "episode_duration_sec_mean": 0.00460100916097872, "env_step_timer": 1.3688245879530759e-05, "episode_return_mean": -1.2, "num_module_steps_sampled_lifetime": {"default_policy": 3600}, "episode_return_min": -12.5, "episode_len_max": 20, "num_env_steps_sampled_lifetime": 45400, "time_between_sampling": 1.8699751803097369}, "num_healthy_workers": 1, "actor_manager_num_outstanding_async_reqs": 0, "num_remote_worker_restarts": 0}, "num_env_steps_sampled_lifetime": -4312500.0, "fault_tolerance": {"num_healthy_workers": 0, "num_remote_worker_restarts": 0}, "env_runner_group": {"actor_manager_num_outstanding_async_reqs": 0}, "done": false, "training_iteration": 9, "trial_id": "43778_00000", "date": "2025-08-11_19-20-22", "timestamp": 1754932822, "time_this_iter_s": 1.7433772087097168, "time_total_s": 16.637537240982056, "pid": 14172, "hostname": "Mac", "node_ip": "127.0.0.1", "config": {"exploration_config": {}, "extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "placement_strategy": "PACK", "num_gpus": 0, "_fake_gpus": false, "num_cpus_for_main_process": 2, "eager_tracing": true, "eager_max_retraces": 20, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "torch_compile_learner": false, "torch_compile_learner_what_to_compile": "forward_train", "torch_compile_learner_dynamo_backend": "aot_eager", "torch_compile_learner_dynamo_mode": null, "torch_compile_worker": false, "torch_compile_worker_dynamo_backend": "aot_eager", "torch_compile_worker_dynamo_mode": null, "torch_ddp_kwargs": {}, "torch_skip_nan_gradients": false, "env": "Umbrella", "env_config": {}, "observation_space": null, "action_space": null, "clip_rewards": null, "normalize_actions": true, "clip_actions": false, "_is_atari": null, "disable_env_checking": false, "render_env": false, "action_mask_key": "action_mask", "env_runner_cls": null, "num_env_runners": 0, "create_local_env_runner": true, "num_envs_per_env_runner": 1, "gym_env_vectorize_mode": "SYNC", "num_cpus_per_env_runner": 1, "num_gpus_per_env_runner": 0, "custom_resources_per_env_runner": {}, "validate_env_runners_after_construction": true, "episodes_to_numpy": true, "max_requests_in_flight_per_env_runner": 1, "sample_timeout_s": 60.0, "_env_to_module_connector": null, "add_default_connectors_to_env_to_module_pipeline": true, "_module_to_env_connector": null, "add_default_connectors_to_module_to_env_pipeline": true, "merge_env_runner_states": "training_only", "broadcast_env_runner_states": true, "episode_lookback_horizon": 1, "rollout_fragment_length": "auto", "batch_mode": "complete_episodes", "compress_observations": false, "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "enable_tf1_exec_eagerly": false, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "preprocessor_pref": "deepmind", "observation_filter": "NoFilter", "update_worker_filter_stats": true, "use_worker_filter_stats": true, "sampler_perf_stats_ema_coef": null, "_is_online": true, "num_learners": 0, "num_gpus_per_learner": 0, "num_cpus_per_learner": "auto", "num_aggregator_actors_per_learner": 0, "max_requests_in_flight_per_aggregator_actor": 3, "local_gpu_idx": 0, "max_requests_in_flight_per_learner": 3, "gamma": 1, "lr": 0.0002847858517, "grad_clip": 0.5, "grad_clip_by": "global_norm", "_train_batch_size_per_learner": 5000, "train_batch_size": 4000, "num_epochs": 1, "minibatch_size": 1000, "shuffle_batch_per_epoch": true, "model": {"fcnet_hiddens": [256, 256], "fcnet_activation": "tanh", "fcnet_weights_initializer": null, "fcnet_weights_initializer_config": null, "fcnet_bias_initializer": null, "fcnet_bias_initializer_config": null, "conv_filters": null, "conv_activation": "relu", "conv_kernel_initializer": null, "conv_kernel_initializer_config": null, "conv_bias_initializer": null, "conv_bias_initializer_config": null, "conv_transpose_kernel_initializer": null, "conv_transpose_kernel_initializer_config": null, "conv_transpose_bias_initializer": null, "conv_transpose_bias_initializer_config": null, "post_fcnet_hiddens": [], "post_fcnet_activation": "relu", "post_fcnet_weights_initializer": null, "post_fcnet_weights_initializer_config": null, "post_fcnet_bias_initializer": null, "post_fcnet_bias_initializer_config": null, "free_log_std": false, "log_std_clip_param": 20.0, "no_final_linear": false, "vf_share_layers": false, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "lstm_weights_initializer": null, "lstm_weights_initializer_config": null, "lstm_bias_initializer": null, "lstm_bias_initializer_config": null, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "attention_use_n_prev_actions": 0, "attention_use_n_prev_rewards": 0, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": null, "custom_model_config": {}, "custom_action_dist": null, "custom_preprocessor": null, "encoder_latent_dim": null, "always_check_shapes": false, "lstm_use_prev_action_reward": -1, "_use_default_native_models": -1, "_disable_preprocessor_api": false, "_disable_action_flattening": false}, "_learner_connector": null, "add_default_connectors_to_learner_pipeline": true, "learner_config_dict": {}, "optimizer": {}, "_learner_class": null, "callbacks_on_algorithm_init": null, "callbacks_on_env_runners_recreated": null, "callbacks_on_offline_eval_runners_recreated": null, "callbacks_on_checkpoint_loaded": null, "callbacks_on_environment_created": null, "callbacks_on_episode_created": null, "callbacks_on_episode_start": null, "callbacks_on_episode_step": null, "callbacks_on_episode_end": null, "callbacks_on_evaluate_start": null, "callbacks_on_evaluate_end": null, "callbacks_on_evaluate_offline_start": null, "callbacks_on_evaluate_offline_end": null, "callbacks_on_sample_end": null, "callbacks_on_train_result": null, "explore": true, "enable_rl_module_and_learner": true, "enable_env_runner_and_connector_v2": true, "_prior_exploration_config": {"type": "StochasticSampling"}, "count_steps_by": "env_steps", "policy_map_capacity": 100, "policy_mapping_fn": "<function AlgorithmConfig.DEFAULT_POLICY_MAPPING_FN at 0x3888f18a0>", "policies_to_train": null, "policy_states_are_swappable": false, "observation_fn": null, "offline_data_class": null, "input_read_method": "read_parquet", "input_read_method_kwargs": {}, "input_read_schema": {}, "input_read_episodes": false, "input_read_sample_batches": false, "input_read_batch_size": null, "input_filesystem": null, "input_filesystem_kwargs": {}, "input_compress_columns": ["obs", "new_obs"], "input_spaces_jsonable": true, "materialize_data": false, "materialize_mapped_data": true, "map_batches_kwargs": {}, "iter_batches_kwargs": {}, "ignore_final_observation": false, "prelearner_class": null, "prelearner_buffer_class": null, "prelearner_buffer_kwargs": {}, "prelearner_module_synch_period": 10, "dataset_num_iters_per_learner": null, "input_config": {}, "actions_in_input_normalized": false, "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_config": {}, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "output_max_rows_per_file": null, "output_write_remaining_data": false, "output_write_method": "write_parquet", "output_write_method_kwargs": {}, "output_filesystem": null, "output_filesystem_kwargs": {}, "output_write_episodes": true, "offline_sampling": false, "evaluation_interval": 1, "evaluation_duration": 20, "evaluation_duration_unit": "episodes", "evaluation_sample_timeout_s": 120.0, "evaluation_auto_duration_min_env_steps_per_sample": 100, "evaluation_auto_duration_max_env_steps_per_sample": 2000, "evaluation_parallel_to_training": false, "evaluation_force_reset_envs_before_iteration": true, "evaluation_config": null, "off_policy_estimation_methods": {}, "ope_split_batch_by_episode": true, "evaluation_num_env_runners": 1, "in_evaluation": false, "sync_filters_on_rollout_workers_timeout_s": 10.0, "offline_evaluation_interval": null, "num_offline_eval_runners": 0, "offline_loss_for_module_fn": null, "offline_evaluation_duration": 1, "offline_evaluation_parallel_to_training": false, "offline_evaluation_timeout_s": 120.0, "num_cpus_per_offline_eval_runner": 1, "num_gpus_per_offline_eval_runner": 0, "custom_resources_per_offline_eval_runner": {}, "restart_failed_offline_eval_runners": true, "ignore_offline_eval_runner_failures": false, "max_num_offline_eval_runner_restarts": 1000, "offline_eval_runner_restore_timeout_s": 1800.0, "max_requests_in_flight_per_offline_eval_runner": 1, "validate_offline_eval_runners_after_construction": true, "offline_eval_runner_health_probe_timeout_s": 30.0, "offline_eval_rl_module_inference_only": false, "broadcast_offline_eval_runner_states": false, "offline_eval_batch_size_per_runner": 256, "dataset_num_iters_per_eval_runner": 1, "keep_per_episode_custom_metrics": false, "metrics_episode_collection_timeout_s": 60.0, "metrics_num_episodes_for_smoothing": 100, "min_time_s_per_iteration": null, "min_train_timesteps_per_iteration": 0, "min_sample_timesteps_per_iteration": 0, "log_gradients": true, "export_native_model_files": false, "checkpoint_trainable_policies_only": false, "logger_creator": null, "logger_config": null, "log_level": "WARN", "log_sys_usage": true, "fake_sampler": false, "seed": 1, "restart_failed_env_runners": true, "ignore_env_runner_failures": false, "max_num_env_runner_restarts": 1000, "delay_between_env_runner_restarts_s": 60.0, "restart_failed_sub_environments": false, "num_consecutive_env_runner_failures_tolerance": 100, "env_runner_health_probe_timeout_s": 30.0, "env_runner_restore_timeout_s": 1800.0, "_model_config": {}, "_rl_module_spec": "RLModuleSpec(module_class=None, observation_space=None, action_space=None, inference_only=False, learner_only=False, model_config=DefaultModelConfig(fcnet_hiddens=[60, 90], fcnet_activation='tanh', fcnet_kernel_initializer=None, fcnet_kernel_initializer_kwargs=None, fcnet_bias_initializer=None, fcnet_bias_initializer_kwargs=None, conv_filters=None, conv_activation='relu', conv_kernel_initializer=None, conv_kernel_initializer_kwargs=None, conv_bias_initializer=None, conv_bias_initializer_kwargs=None, head_fcnet_hiddens=[], head_fcnet_activation='relu', head_fcnet_kernel_initializer=None, head_fcnet_kernel_initializer_kwargs=None, head_fcnet_bias_initializer=None, head_fcnet_bias_initializer_kwargs=None, free_log_std=False, log_std_clip_param=20.0, vf_share_layers=True, use_lstm=False, max_seq_len=20, lstm_cell_size=256, lstm_use_prev_action=False, lstm_use_prev_reward=False, lstm_kernel_initializer=None, lstm_kernel_initializer_kwargs=None, lstm_bias_initializer=None, lstm_bias_initializer_kwargs=None), catalog_class=None, load_state_path=None, model_config_dict=None)", "algorithm_config_overrides_per_module": {}, "_per_module_overrides": {}, "_validate_config": true, "_use_msgpack_checkpoints": false, "_torch_grad_scaler_class": null, "_torch_lr_scheduler_classes": null, "_tf_policy_handles_more_than_one_loss": false, "_disable_preprocessor_api": false, "_disable_action_flattening": false, "_disable_initialize_loss_from_dummy_batch": false, "_dont_auto_sync_env_runner_states": false, "env_task_fn": -1, "enable_connectors": -1, "simple_optimizer": false, "policy_map_cache": -1, "worker_cls": -1, "synchronize_filters": -1, "enable_async_evaluation": -1, "custom_async_evaluation_function": -1, "_enable_rl_module_api": -1, "auto_wrap_old_gym_envs": -1, "always_attach_evaluation_results": -1, "replay_sequence_length": null, "_disable_execution_plan_api": -1, "use_critic": true, "use_gae": true, "use_kl_loss": true, "kl_coeff": 0.7464963036515, "kl_target": 0.0270990929592, "vf_loss_coeff": 0.6688075857018, "entropy_coeff": 0.0090570820258, "clip_param": 0.1221781641624, "vf_clip_param": 0.1027808522125, "entropy_coeff_schedule": null, "lr_schedule": null, "sgd_minibatch_size": -1, "vf_share_layers": -1, "__stdout_file__": null, "__stderr_file__": null, "lambda": 0.9099046732075, "input": "sampler", "policies": {"default_policy": [null, null, null, null]}, "callbacks": "<class 'ray.rllib.callbacks.callbacks.RLlibCallback'>", "create_env_on_driver": false, "custom_eval_function": null, "framework": "torch"}, "time_since_restore": 16.637537240982056, "iterations_since_restore": 9, "perf": {"cpu_util_percent": 43.15, "ram_util_percent": 81.5}}
{"timers": {"training_iteration": 1.903803989491034, "restore_env_runners": 1.1882746652026196e-05, "training_step": 1.90364724516168, "env_runner_sampling_timer": 1.7835421146244983, "learner_update_timer": 0.11674255609130885, "synch_weights": 0.0007382730139599698, "restore_eval_env_runners": 8.88265026712011e-06, "evaluation_iteration": 0.12856072186688838, "synch_eval_env_connectors": 0.00011887278550092765, "synch_env_connectors": 5.524126149595968e-06}, "env_runners": {"env_to_module_connector": {"timers": {"connectors": {"add_observations_from_episodes_to_batch": 3.3265818032465724e-06, "batch_individual_items": 6.502282359680161e-06, "numpy_to_tensor": 1.0036194856107024e-05, "add_states_from_episodes_to_batch": 1.7729849880395554e-06, "add_time_dim_to_batch_and_zero_pad": 2.4437527540235244e-06}}, "connector_pipeline_timer": 4.5992828458371786e-05}, "episode_len_mean": 20.0, "sample": 0.005239713405056975, "module_to_env_connector": {"timers": {"connectors": {"get_actions": 4.210463966348097e-05, "un_batch_to_individual_items": 5.539754578356182e-06, "normalize_and_clip_actions": 9.739512004075047e-06, "listify_data_for_vector_env": 1.1581904823927143e-05, "remove_single_ts_time_rank_from_batch": 5.979661802600226e-07, "tensor_to_numpy": 1.4210606593392416e-05}}, "connector_pipeline_timer": 0.00010964739153061127}, "num_module_steps_sampled": {"default_policy": 5000.0}, "num_agent_steps_sampled_lifetime": {"default_agent": -4930000.0}, "num_env_steps_sampled": 5000.0, "episode_duration_sec_mean": 0.004814366021659225, "num_agent_steps_sampled": {"default_agent": 5000.0}, "env_to_module_sum_episodes_length_out": 10.36823839457432, "num_episodes": 250.0, "time_between_sampling": 0.0018587551284937266, "env_step_timer": 1.4842980750554258e-05, "agent_episode_returns_mean": {"default_agent": 5.100000000000001}, "episode_return_mean": 5.100000000000001, "num_module_steps_sampled_lifetime": {"default_policy": -4930000.0}, "env_to_module_sum_episodes_length_in": 10.36823839457432, "episode_return_max": 9.5, "num_episodes_lifetime": -246500.0, "weights_seq_no": 9.0, "module_episode_returns_mean": {"default_policy": 5.100000000000001}, "episode_return_min": -10.5, "episode_len_min": 20, "episode_len_max": 20, "env_reset_timer": 4.0384275595062916e-05, "num_env_steps_sampled_lifetime": -4930000.0, "rlmodule_inference_timer": 2.9948092504417858e-05, "num_env_steps_sampled_lifetime_throughput": 3611.322166057924}, "learners": {"__all_modules__": {"num_module_steps_trained_lifetime": 60000, "learner_connector_sum_episodes_length_in": 5000.0, "learner_connector": {"timers": {"connectors": {"add_observations_from_episodes_to_batch": 0.0008258876181209057, "batch_individual_items": 0.03367954255700773, "general_advantage_estimation": 0.007926821428346293, "add_one_ts_to_episodes_and_truncate": 0.008568223467867125, "add_time_dim_to_batch_and_zero_pad": 1.2172979501327894e-05, "add_states_from_episodes_to_batch": 3.7489396573729935e-06, "add_columns_from_episodes_to_train_batch": 0.03432361669703749, "numpy_to_tensor": 7.193299166443082e-05}}, "connector_pipeline_timer": 0.08555547935822692}, "num_env_steps_trained": 31500, "num_env_steps_trained_lifetime": 315000, "num_non_trainable_parameters": 0, "learner_connector_sum_episodes_length_out": 5250.0, "num_module_steps_trained": 6000, "num_trainable_parameters": 6003, "num_env_steps_trained_lifetime_throughput": 1730493.662631377, "num_module_steps_trained_throughput": 330650.690540218, "num_module_steps_trained_lifetime_throughput": 330229.53111098945}, "default_policy": {"vf_loss": 0.10278083384037018, "curr_entropy_coeff": 0.0090570820258, "mean_kl_loss": 5.7940360420616344e-05, "weights_seq_no": 10.0, "module_train_batch_size_mean": 1000.0, "vf_explained_var": -0.02006387710571289, "gradients_default_optimizer_global_norm": 0.018817108124494553, "diff_num_grad_updates_vs_sampler_policy": 1.0, "default_optimizer_learning_rate": 0.0002847858517, "curr_kl_coeff": 0.0007290003122761846, "num_module_steps_trained": 6000, "num_trainable_parameters": 6003, "total_loss": 0.10759363323450089, "num_module_steps_trained_lifetime": 60000, "vf_loss_unclipped": 27.54096031188965, "policy_loss": 0.044248078018426895, "entropy": 0.5956794023513794, "num_module_steps_trained_lifetime_throughput": 330956.7730085481}}, "num_training_step_calls_per_iteration": 1, "evaluation": {"env_runners": {"sample": 0.12054112358274097, "num_module_steps_sampled": {"default_policy": 400}, "env_to_module_connector": {"timers": {"connectors": {"add_observations_from_episodes_to_batch": 2.9181828151403147e-06, "numpy_to_tensor": 8.770157296181733e-06, "batch_individual_items": 6.287311277958431e-06, "add_time_dim_to_batch_and_zero_pad": 2.2585516380395975e-06, "add_states_from_episodes_to_batch": 1.5932184837297077e-06}}, "connector_pipeline_timer": 4.3834903870748966e-05}, "num_agent_steps_sampled_lifetime": {"default_agent": 4000}, "module_to_env_connector": {"timers": {"connectors": {"tensor_to_numpy": 1.408009968620839e-05, "get_actions": 3.9301143651600335e-05, "listify_data_for_vector_env": 1.1335768965198304e-05, "normalize_and_clip_actions": 1.005752801021329e-05, "remove_single_ts_time_rank_from_batch": 5.737071370463012e-07, "un_batch_to_individual_items": 5.521861666229004e-06}}, "connector_pipeline_timer": 0.00010781863188120997}, "agent_episode_returns_mean": {"default_agent": -0.6}, "num_env_steps_sampled": 400, "env_to_module_sum_episodes_length_out": 10.368238394574323, "num_episodes": 20, "num_agent_steps_sampled": {"default_agent": 400}, "num_episodes_lifetime": 200, "weights_seq_no": 10.0, "env_reset_timer": 0.00015489277685467944, "module_episode_returns_mean": {"default_policy": -0.6}, "rlmodule_inference_timer": 2.9418151036352142e-05, "env_to_module_sum_episodes_length_in": 10.368238394574323, "episode_return_max": 12.5, "episode_len_min": 20, "episode_len_mean": 20.0, "episode_duration_sec_mean": 0.004558510862989351, "env_step_timer": 1.4777332128406526e-05, "episode_return_mean": -0.6, "num_module_steps_sampled_lifetime": {"default_policy": 4000}, "episode_return_min": -12.5, "episode_len_max": 20, "num_env_steps_sampled_lifetime": 50400, "time_between_sampling": 1.8680216330858885}, "num_healthy_workers": 1, "actor_manager_num_outstanding_async_reqs": 0, "num_remote_worker_restarts": 0}, "num_env_steps_sampled_lifetime": -4930000.0, "fault_tolerance": {"num_healthy_workers": 0, "num_remote_worker_restarts": 0}, "env_runner_group": {"actor_manager_num_outstanding_async_reqs": 0}, "done": false, "training_iteration": 10, "trial_id": "43778_00000", "date": "2025-08-11_19-20-23", "timestamp": 1754932823, "time_this_iter_s": 1.7682788372039795, "time_total_s": 18.405816078186035, "pid": 14172, "hostname": "Mac", "node_ip": "127.0.0.1", "config": {"exploration_config": {}, "extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "placement_strategy": "PACK", "num_gpus": 0, "_fake_gpus": false, "num_cpus_for_main_process": 2, "eager_tracing": true, "eager_max_retraces": 20, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "torch_compile_learner": false, "torch_compile_learner_what_to_compile": "forward_train", "torch_compile_learner_dynamo_backend": "aot_eager", "torch_compile_learner_dynamo_mode": null, "torch_compile_worker": false, "torch_compile_worker_dynamo_backend": "aot_eager", "torch_compile_worker_dynamo_mode": null, "torch_ddp_kwargs": {}, "torch_skip_nan_gradients": false, "env": "Umbrella", "env_config": {}, "observation_space": null, "action_space": null, "clip_rewards": null, "normalize_actions": true, "clip_actions": false, "_is_atari": null, "disable_env_checking": false, "render_env": false, "action_mask_key": "action_mask", "env_runner_cls": null, "num_env_runners": 0, "create_local_env_runner": true, "num_envs_per_env_runner": 1, "gym_env_vectorize_mode": "SYNC", "num_cpus_per_env_runner": 1, "num_gpus_per_env_runner": 0, "custom_resources_per_env_runner": {}, "validate_env_runners_after_construction": true, "episodes_to_numpy": true, "max_requests_in_flight_per_env_runner": 1, "sample_timeout_s": 60.0, "_env_to_module_connector": null, "add_default_connectors_to_env_to_module_pipeline": true, "_module_to_env_connector": null, "add_default_connectors_to_module_to_env_pipeline": true, "merge_env_runner_states": "training_only", "broadcast_env_runner_states": true, "episode_lookback_horizon": 1, "rollout_fragment_length": "auto", "batch_mode": "complete_episodes", "compress_observations": false, "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "enable_tf1_exec_eagerly": false, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "preprocessor_pref": "deepmind", "observation_filter": "NoFilter", "update_worker_filter_stats": true, "use_worker_filter_stats": true, "sampler_perf_stats_ema_coef": null, "_is_online": true, "num_learners": 0, "num_gpus_per_learner": 0, "num_cpus_per_learner": "auto", "num_aggregator_actors_per_learner": 0, "max_requests_in_flight_per_aggregator_actor": 3, "local_gpu_idx": 0, "max_requests_in_flight_per_learner": 3, "gamma": 1, "lr": 0.0002847858517, "grad_clip": 0.5, "grad_clip_by": "global_norm", "_train_batch_size_per_learner": 5000, "train_batch_size": 4000, "num_epochs": 1, "minibatch_size": 1000, "shuffle_batch_per_epoch": true, "model": {"fcnet_hiddens": [256, 256], "fcnet_activation": "tanh", "fcnet_weights_initializer": null, "fcnet_weights_initializer_config": null, "fcnet_bias_initializer": null, "fcnet_bias_initializer_config": null, "conv_filters": null, "conv_activation": "relu", "conv_kernel_initializer": null, "conv_kernel_initializer_config": null, "conv_bias_initializer": null, "conv_bias_initializer_config": null, "conv_transpose_kernel_initializer": null, "conv_transpose_kernel_initializer_config": null, "conv_transpose_bias_initializer": null, "conv_transpose_bias_initializer_config": null, "post_fcnet_hiddens": [], "post_fcnet_activation": "relu", "post_fcnet_weights_initializer": null, "post_fcnet_weights_initializer_config": null, "post_fcnet_bias_initializer": null, "post_fcnet_bias_initializer_config": null, "free_log_std": false, "log_std_clip_param": 20.0, "no_final_linear": false, "vf_share_layers": false, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "lstm_weights_initializer": null, "lstm_weights_initializer_config": null, "lstm_bias_initializer": null, "lstm_bias_initializer_config": null, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "attention_use_n_prev_actions": 0, "attention_use_n_prev_rewards": 0, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": null, "custom_model_config": {}, "custom_action_dist": null, "custom_preprocessor": null, "encoder_latent_dim": null, "always_check_shapes": false, "lstm_use_prev_action_reward": -1, "_use_default_native_models": -1, "_disable_preprocessor_api": false, "_disable_action_flattening": false}, "_learner_connector": null, "add_default_connectors_to_learner_pipeline": true, "learner_config_dict": {}, "optimizer": {}, "_learner_class": null, "callbacks_on_algorithm_init": null, "callbacks_on_env_runners_recreated": null, "callbacks_on_offline_eval_runners_recreated": null, "callbacks_on_checkpoint_loaded": null, "callbacks_on_environment_created": null, "callbacks_on_episode_created": null, "callbacks_on_episode_start": null, "callbacks_on_episode_step": null, "callbacks_on_episode_end": null, "callbacks_on_evaluate_start": null, "callbacks_on_evaluate_end": null, "callbacks_on_evaluate_offline_start": null, "callbacks_on_evaluate_offline_end": null, "callbacks_on_sample_end": null, "callbacks_on_train_result": null, "explore": true, "enable_rl_module_and_learner": true, "enable_env_runner_and_connector_v2": true, "_prior_exploration_config": {"type": "StochasticSampling"}, "count_steps_by": "env_steps", "policy_map_capacity": 100, "policy_mapping_fn": "<function AlgorithmConfig.DEFAULT_POLICY_MAPPING_FN at 0x3888f18a0>", "policies_to_train": null, "policy_states_are_swappable": false, "observation_fn": null, "offline_data_class": null, "input_read_method": "read_parquet", "input_read_method_kwargs": {}, "input_read_schema": {}, "input_read_episodes": false, "input_read_sample_batches": false, "input_read_batch_size": null, "input_filesystem": null, "input_filesystem_kwargs": {}, "input_compress_columns": ["obs", "new_obs"], "input_spaces_jsonable": true, "materialize_data": false, "materialize_mapped_data": true, "map_batches_kwargs": {}, "iter_batches_kwargs": {}, "ignore_final_observation": false, "prelearner_class": null, "prelearner_buffer_class": null, "prelearner_buffer_kwargs": {}, "prelearner_module_synch_period": 10, "dataset_num_iters_per_learner": null, "input_config": {}, "actions_in_input_normalized": false, "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_config": {}, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "output_max_rows_per_file": null, "output_write_remaining_data": false, "output_write_method": "write_parquet", "output_write_method_kwargs": {}, "output_filesystem": null, "output_filesystem_kwargs": {}, "output_write_episodes": true, "offline_sampling": false, "evaluation_interval": 1, "evaluation_duration": 20, "evaluation_duration_unit": "episodes", "evaluation_sample_timeout_s": 120.0, "evaluation_auto_duration_min_env_steps_per_sample": 100, "evaluation_auto_duration_max_env_steps_per_sample": 2000, "evaluation_parallel_to_training": false, "evaluation_force_reset_envs_before_iteration": true, "evaluation_config": null, "off_policy_estimation_methods": {}, "ope_split_batch_by_episode": true, "evaluation_num_env_runners": 1, "in_evaluation": false, "sync_filters_on_rollout_workers_timeout_s": 10.0, "offline_evaluation_interval": null, "num_offline_eval_runners": 0, "offline_loss_for_module_fn": null, "offline_evaluation_duration": 1, "offline_evaluation_parallel_to_training": false, "offline_evaluation_timeout_s": 120.0, "num_cpus_per_offline_eval_runner": 1, "num_gpus_per_offline_eval_runner": 0, "custom_resources_per_offline_eval_runner": {}, "restart_failed_offline_eval_runners": true, "ignore_offline_eval_runner_failures": false, "max_num_offline_eval_runner_restarts": 1000, "offline_eval_runner_restore_timeout_s": 1800.0, "max_requests_in_flight_per_offline_eval_runner": 1, "validate_offline_eval_runners_after_construction": true, "offline_eval_runner_health_probe_timeout_s": 30.0, "offline_eval_rl_module_inference_only": false, "broadcast_offline_eval_runner_states": false, "offline_eval_batch_size_per_runner": 256, "dataset_num_iters_per_eval_runner": 1, "keep_per_episode_custom_metrics": false, "metrics_episode_collection_timeout_s": 60.0, "metrics_num_episodes_for_smoothing": 100, "min_time_s_per_iteration": null, "min_train_timesteps_per_iteration": 0, "min_sample_timesteps_per_iteration": 0, "log_gradients": true, "export_native_model_files": false, "checkpoint_trainable_policies_only": false, "logger_creator": null, "logger_config": null, "log_level": "WARN", "log_sys_usage": true, "fake_sampler": false, "seed": 1, "restart_failed_env_runners": true, "ignore_env_runner_failures": false, "max_num_env_runner_restarts": 1000, "delay_between_env_runner_restarts_s": 60.0, "restart_failed_sub_environments": false, "num_consecutive_env_runner_failures_tolerance": 100, "env_runner_health_probe_timeout_s": 30.0, "env_runner_restore_timeout_s": 1800.0, "_model_config": {}, "_rl_module_spec": "RLModuleSpec(module_class=None, observation_space=None, action_space=None, inference_only=False, learner_only=False, model_config=DefaultModelConfig(fcnet_hiddens=[60, 90], fcnet_activation='tanh', fcnet_kernel_initializer=None, fcnet_kernel_initializer_kwargs=None, fcnet_bias_initializer=None, fcnet_bias_initializer_kwargs=None, conv_filters=None, conv_activation='relu', conv_kernel_initializer=None, conv_kernel_initializer_kwargs=None, conv_bias_initializer=None, conv_bias_initializer_kwargs=None, head_fcnet_hiddens=[], head_fcnet_activation='relu', head_fcnet_kernel_initializer=None, head_fcnet_kernel_initializer_kwargs=None, head_fcnet_bias_initializer=None, head_fcnet_bias_initializer_kwargs=None, free_log_std=False, log_std_clip_param=20.0, vf_share_layers=True, use_lstm=False, max_seq_len=20, lstm_cell_size=256, lstm_use_prev_action=False, lstm_use_prev_reward=False, lstm_kernel_initializer=None, lstm_kernel_initializer_kwargs=None, lstm_bias_initializer=None, lstm_bias_initializer_kwargs=None), catalog_class=None, load_state_path=None, model_config_dict=None)", "algorithm_config_overrides_per_module": {}, "_per_module_overrides": {}, "_validate_config": true, "_use_msgpack_checkpoints": false, "_torch_grad_scaler_class": null, "_torch_lr_scheduler_classes": null, "_tf_policy_handles_more_than_one_loss": false, "_disable_preprocessor_api": false, "_disable_action_flattening": false, "_disable_initialize_loss_from_dummy_batch": false, "_dont_auto_sync_env_runner_states": false, "env_task_fn": -1, "enable_connectors": -1, "simple_optimizer": false, "policy_map_cache": -1, "worker_cls": -1, "synchronize_filters": -1, "enable_async_evaluation": -1, "custom_async_evaluation_function": -1, "_enable_rl_module_api": -1, "auto_wrap_old_gym_envs": -1, "always_attach_evaluation_results": -1, "replay_sequence_length": null, "_disable_execution_plan_api": -1, "use_critic": true, "use_gae": true, "use_kl_loss": true, "kl_coeff": 0.7464963036515, "kl_target": 0.0270990929592, "vf_loss_coeff": 0.6688075857018, "entropy_coeff": 0.0090570820258, "clip_param": 0.1221781641624, "vf_clip_param": 0.1027808522125, "entropy_coeff_schedule": null, "lr_schedule": null, "sgd_minibatch_size": -1, "vf_share_layers": -1, "__stdout_file__": null, "__stderr_file__": null, "lambda": 0.9099046732075, "input": "sampler", "policies": {"default_policy": [null, null, null, null]}, "callbacks": "<class 'ray.rllib.callbacks.callbacks.RLlibCallback'>", "create_env_on_driver": false, "custom_eval_function": null, "framework": "torch"}, "time_since_restore": 18.405816078186035, "iterations_since_restore": 10, "perf": {"cpu_util_percent": 59.4, "ram_util_percent": 81.13333333333334}}
{"timers": {"training_iteration": 1.9002994091761614, "restore_env_runners": 1.1823919642375536e-05, "training_step": 1.9001421577096942, "env_runner_sampling_timer": 1.7801965530687929, "learner_update_timer": 0.11658187886094229, "synch_weights": 0.0007367448639060947, "restore_eval_env_runners": 8.92090389390841e-06, "evaluation_iteration": 0.12836898047797227, "synch_eval_env_connectors": 0.0001187657282803669, "synch_env_connectors": 5.512214670883994e-06}, "env_runners": {"env_to_module_connector": {"timers": {"connectors": {"add_observations_from_episodes_to_batch": 3.1097180216913344e-06, "batch_individual_items": 6.733229078645925e-06, "numpy_to_tensor": 8.947010936377501e-06, "add_states_from_episodes_to_batch": 1.7708113303300179e-06, "add_time_dim_to_batch_and_zero_pad": 2.406637165516333e-06}}, "connector_pipeline_timer": 4.471541027864034e-05}, "episode_len_mean": 20.0, "sample": 0.0051389764919326005, "module_to_env_connector": {"timers": {"connectors": {"get_actions": 4.126147358118932e-05, "un_batch_to_individual_items": 5.497681808467711e-06, "normalize_and_clip_actions": 9.604123296612906e-06, "listify_data_for_vector_env": 1.1745143404762588e-05, "remove_single_ts_time_rank_from_batch": 6.508335476021376e-07, "tensor_to_numpy": 1.4071180636051284e-05}}, "connector_pipeline_timer": 0.00010894441071771947}, "num_module_steps_sampled": {"default_policy": 5000.0}, "num_agent_steps_sampled_lifetime": {"default_agent": -5547500.0}, "num_env_steps_sampled": 5000.0, "episode_duration_sec_mean": 0.0047951697143726055, "num_agent_steps_sampled": {"default_agent": 5000.0}, "env_to_module_sum_episodes_length_out": 10.36823839457432, "num_episodes": 250.0, "time_between_sampling": 0.0019231072659949468, "env_step_timer": 1.441553020842736e-05, "agent_episode_returns_mean": {"default_agent": 5.980000000000002}, "episode_return_mean": 5.980000000000002, "num_module_steps_sampled_lifetime": {"default_policy": -5547500.0}, "env_to_module_sum_episodes_length_in": 10.36823839457432, "episode_return_max": 9.5, "num_episodes_lifetime": -277375.0, "weights_seq_no": 10.0, "module_episode_returns_mean": {"default_policy": 5.980000000000002}, "episode_return_min": -10.5, "episode_len_min": 20, "episode_len_max": 20, "env_reset_timer": 3.8962437251265804e-05, "num_env_steps_sampled_lifetime": -5547500.0, "rlmodule_inference_timer": 2.9797833833592108e-05, "num_env_steps_sampled_lifetime_throughput": 3663.614385207458}, "learners": {"__all_modules__": {"num_module_steps_trained_lifetime": 66000, "learner_connector_sum_episodes_length_in": 5000.0, "learner_connector": {"timers": {"connectors": {"add_observations_from_episodes_to_batch": 0.0008257045717678545, "batch_individual_items": 0.033661822131444356, "general_advantage_estimation": 0.007900902374652108, "add_one_ts_to_episodes_and_truncate": 0.008560431233727355, "add_time_dim_to_batch_and_zero_pad": 1.219334042737048e-05, "add_states_from_episodes_to_batch": 3.7602003409675107e-06, "add_columns_from_episodes_to_train_batch": 0.034371281359874044, "numpy_to_tensor": 7.187199155687104e-05}}, "connector_pipeline_timer": 0.08555116956443895}, "num_env_steps_trained": 31500, "num_env_steps_trained_lifetime": 346500, "num_non_trainable_parameters": 0, "learner_connector_sum_episodes_length_out": 5250.0, "num_module_steps_trained": 6000, "num_trainable_parameters": 6003, "num_env_steps_trained_lifetime_throughput": 1745122.069091751, "num_module_steps_trained_throughput": 333402.619389723, "num_module_steps_trained_lifetime_throughput": 332992.0615642861}, "default_policy": {"vf_loss": 0.10278083384037018, "curr_entropy_coeff": 0.0090570820258, "mean_kl_loss": 8.655712736072019e-05, "weights_seq_no": 11.0, "module_train_batch_size_mean": 1000.0, "vf_explained_var": -0.020464658737182617, "gradients_default_optimizer_global_norm": 0.06588909029960632, "diff_num_grad_updates_vs_sampler_policy": 1.0, "default_optimizer_learning_rate": 0.0002847858517, "curr_kl_coeff": 0.0003645001561380923, "num_module_steps_trained": 6000, "num_trainable_parameters": 6003, "total_loss": 0.06442416459321976, "num_module_steps_trained_lifetime": 66000, "vf_loss_unclipped": 27.205020904541016, "policy_loss": 0.0011768140830099583, "entropy": 0.6065216660499573, "num_module_steps_trained_lifetime_throughput": 333661.68980214186}}, "num_training_step_calls_per_iteration": 1, "evaluation": {"env_runners": {"sample": 0.12031975693764563, "num_module_steps_sampled": {"default_policy": 400}, "env_to_module_connector": {"timers": {"connectors": {"add_observations_from_episodes_to_batch": 2.8193940749815858e-06, "numpy_to_tensor": 8.31223317932672e-06, "batch_individual_items": 6.125464147542024e-06, "add_time_dim_to_batch_and_zero_pad": 2.2212770120732928e-06, "add_states_from_episodes_to_batch": 1.6106603270466494e-06}}, "connector_pipeline_timer": 4.2852588037506725e-05}, "num_agent_steps_sampled_lifetime": {"default_agent": 4400}, "module_to_env_connector": {"timers": {"connectors": {"tensor_to_numpy": 1.305583366322323e-05, "get_actions": 3.668551641616818e-05, "listify_data_for_vector_env": 1.090358633701428e-05, "normalize_and_clip_actions": 9.308353203839309e-06, "remove_single_ts_time_rank_from_batch": 5.759896483105172e-07, "un_batch_to_individual_items": 5.307136209191116e-06}}, "connector_pipeline_timer": 0.0001017958403221661}, "agent_episode_returns_mean": {"default_agent": -1.0}, "num_env_steps_sampled": 400, "env_to_module_sum_episodes_length_out": 10.368238394574323, "num_episodes": 20, "num_agent_steps_sampled": {"default_agent": 400}, "num_episodes_lifetime": 220, "weights_seq_no": 11.0, "env_reset_timer": 0.0001543017690693259, "module_episode_returns_mean": {"default_policy": -1.0}, "rlmodule_inference_timer": 2.726920178241099e-05, "env_to_module_sum_episodes_length_in": 10.368238394574323, "episode_return_max": 11.5, "episode_len_min": 20, "episode_len_mean": 20.0, "episode_duration_sec_mean": 0.0045589820900931955, "env_step_timer": 1.4075263299774417e-05, "episode_return_mean": -1.0, "num_module_steps_sampled_lifetime": {"default_policy": 4400}, "episode_return_min": -12.5, "episode_len_max": 20, "num_env_steps_sampled_lifetime": 55400, "time_between_sampling": 1.8650591438347843}, "num_healthy_workers": 1, "actor_manager_num_outstanding_async_reqs": 0, "num_remote_worker_restarts": 0}, "num_env_steps_sampled_lifetime": -5547500.0, "fault_tolerance": {"num_healthy_workers": 0, "num_remote_worker_restarts": 0}, "env_runner_group": {"actor_manager_num_outstanding_async_reqs": 0}, "done": false, "training_iteration": 11, "trial_id": "43778_00000", "date": "2025-08-11_19-20-25", "timestamp": 1754932825, "time_this_iter_s": 1.65966796875, "time_total_s": 20.065484046936035, "pid": 14172, "hostname": "Mac", "node_ip": "127.0.0.1", "config": {"exploration_config": {}, "extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "placement_strategy": "PACK", "num_gpus": 0, "_fake_gpus": false, "num_cpus_for_main_process": 2, "eager_tracing": true, "eager_max_retraces": 20, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "torch_compile_learner": false, "torch_compile_learner_what_to_compile": "forward_train", "torch_compile_learner_dynamo_backend": "aot_eager", "torch_compile_learner_dynamo_mode": null, "torch_compile_worker": false, "torch_compile_worker_dynamo_backend": "aot_eager", "torch_compile_worker_dynamo_mode": null, "torch_ddp_kwargs": {}, "torch_skip_nan_gradients": false, "env": "Umbrella", "env_config": {}, "observation_space": null, "action_space": null, "clip_rewards": null, "normalize_actions": true, "clip_actions": false, "_is_atari": null, "disable_env_checking": false, "render_env": false, "action_mask_key": "action_mask", "env_runner_cls": null, "num_env_runners": 0, "create_local_env_runner": true, "num_envs_per_env_runner": 1, "gym_env_vectorize_mode": "SYNC", "num_cpus_per_env_runner": 1, "num_gpus_per_env_runner": 0, "custom_resources_per_env_runner": {}, "validate_env_runners_after_construction": true, "episodes_to_numpy": true, "max_requests_in_flight_per_env_runner": 1, "sample_timeout_s": 60.0, "_env_to_module_connector": null, "add_default_connectors_to_env_to_module_pipeline": true, "_module_to_env_connector": null, "add_default_connectors_to_module_to_env_pipeline": true, "merge_env_runner_states": "training_only", "broadcast_env_runner_states": true, "episode_lookback_horizon": 1, "rollout_fragment_length": "auto", "batch_mode": "complete_episodes", "compress_observations": false, "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "enable_tf1_exec_eagerly": false, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "preprocessor_pref": "deepmind", "observation_filter": "NoFilter", "update_worker_filter_stats": true, "use_worker_filter_stats": true, "sampler_perf_stats_ema_coef": null, "_is_online": true, "num_learners": 0, "num_gpus_per_learner": 0, "num_cpus_per_learner": "auto", "num_aggregator_actors_per_learner": 0, "max_requests_in_flight_per_aggregator_actor": 3, "local_gpu_idx": 0, "max_requests_in_flight_per_learner": 3, "gamma": 1, "lr": 0.0002847858517, "grad_clip": 0.5, "grad_clip_by": "global_norm", "_train_batch_size_per_learner": 5000, "train_batch_size": 4000, "num_epochs": 1, "minibatch_size": 1000, "shuffle_batch_per_epoch": true, "model": {"fcnet_hiddens": [256, 256], "fcnet_activation": "tanh", "fcnet_weights_initializer": null, "fcnet_weights_initializer_config": null, "fcnet_bias_initializer": null, "fcnet_bias_initializer_config": null, "conv_filters": null, "conv_activation": "relu", "conv_kernel_initializer": null, "conv_kernel_initializer_config": null, "conv_bias_initializer": null, "conv_bias_initializer_config": null, "conv_transpose_kernel_initializer": null, "conv_transpose_kernel_initializer_config": null, "conv_transpose_bias_initializer": null, "conv_transpose_bias_initializer_config": null, "post_fcnet_hiddens": [], "post_fcnet_activation": "relu", "post_fcnet_weights_initializer": null, "post_fcnet_weights_initializer_config": null, "post_fcnet_bias_initializer": null, "post_fcnet_bias_initializer_config": null, "free_log_std": false, "log_std_clip_param": 20.0, "no_final_linear": false, "vf_share_layers": false, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "lstm_weights_initializer": null, "lstm_weights_initializer_config": null, "lstm_bias_initializer": null, "lstm_bias_initializer_config": null, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "attention_use_n_prev_actions": 0, "attention_use_n_prev_rewards": 0, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": null, "custom_model_config": {}, "custom_action_dist": null, "custom_preprocessor": null, "encoder_latent_dim": null, "always_check_shapes": false, "lstm_use_prev_action_reward": -1, "_use_default_native_models": -1, "_disable_preprocessor_api": false, "_disable_action_flattening": false}, "_learner_connector": null, "add_default_connectors_to_learner_pipeline": true, "learner_config_dict": {}, "optimizer": {}, "_learner_class": null, "callbacks_on_algorithm_init": null, "callbacks_on_env_runners_recreated": null, "callbacks_on_offline_eval_runners_recreated": null, "callbacks_on_checkpoint_loaded": null, "callbacks_on_environment_created": null, "callbacks_on_episode_created": null, "callbacks_on_episode_start": null, "callbacks_on_episode_step": null, "callbacks_on_episode_end": null, "callbacks_on_evaluate_start": null, "callbacks_on_evaluate_end": null, "callbacks_on_evaluate_offline_start": null, "callbacks_on_evaluate_offline_end": null, "callbacks_on_sample_end": null, "callbacks_on_train_result": null, "explore": true, "enable_rl_module_and_learner": true, "enable_env_runner_and_connector_v2": true, "_prior_exploration_config": {"type": "StochasticSampling"}, "count_steps_by": "env_steps", "policy_map_capacity": 100, "policy_mapping_fn": "<function AlgorithmConfig.DEFAULT_POLICY_MAPPING_FN at 0x3888f18a0>", "policies_to_train": null, "policy_states_are_swappable": false, "observation_fn": null, "offline_data_class": null, "input_read_method": "read_parquet", "input_read_method_kwargs": {}, "input_read_schema": {}, "input_read_episodes": false, "input_read_sample_batches": false, "input_read_batch_size": null, "input_filesystem": null, "input_filesystem_kwargs": {}, "input_compress_columns": ["obs", "new_obs"], "input_spaces_jsonable": true, "materialize_data": false, "materialize_mapped_data": true, "map_batches_kwargs": {}, "iter_batches_kwargs": {}, "ignore_final_observation": false, "prelearner_class": null, "prelearner_buffer_class": null, "prelearner_buffer_kwargs": {}, "prelearner_module_synch_period": 10, "dataset_num_iters_per_learner": null, "input_config": {}, "actions_in_input_normalized": false, "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_config": {}, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "output_max_rows_per_file": null, "output_write_remaining_data": false, "output_write_method": "write_parquet", "output_write_method_kwargs": {}, "output_filesystem": null, "output_filesystem_kwargs": {}, "output_write_episodes": true, "offline_sampling": false, "evaluation_interval": 1, "evaluation_duration": 20, "evaluation_duration_unit": "episodes", "evaluation_sample_timeout_s": 120.0, "evaluation_auto_duration_min_env_steps_per_sample": 100, "evaluation_auto_duration_max_env_steps_per_sample": 2000, "evaluation_parallel_to_training": false, "evaluation_force_reset_envs_before_iteration": true, "evaluation_config": null, "off_policy_estimation_methods": {}, "ope_split_batch_by_episode": true, "evaluation_num_env_runners": 1, "in_evaluation": false, "sync_filters_on_rollout_workers_timeout_s": 10.0, "offline_evaluation_interval": null, "num_offline_eval_runners": 0, "offline_loss_for_module_fn": null, "offline_evaluation_duration": 1, "offline_evaluation_parallel_to_training": false, "offline_evaluation_timeout_s": 120.0, "num_cpus_per_offline_eval_runner": 1, "num_gpus_per_offline_eval_runner": 0, "custom_resources_per_offline_eval_runner": {}, "restart_failed_offline_eval_runners": true, "ignore_offline_eval_runner_failures": false, "max_num_offline_eval_runner_restarts": 1000, "offline_eval_runner_restore_timeout_s": 1800.0, "max_requests_in_flight_per_offline_eval_runner": 1, "validate_offline_eval_runners_after_construction": true, "offline_eval_runner_health_probe_timeout_s": 30.0, "offline_eval_rl_module_inference_only": false, "broadcast_offline_eval_runner_states": false, "offline_eval_batch_size_per_runner": 256, "dataset_num_iters_per_eval_runner": 1, "keep_per_episode_custom_metrics": false, "metrics_episode_collection_timeout_s": 60.0, "metrics_num_episodes_for_smoothing": 100, "min_time_s_per_iteration": null, "min_train_timesteps_per_iteration": 0, "min_sample_timesteps_per_iteration": 0, "log_gradients": true, "export_native_model_files": false, "checkpoint_trainable_policies_only": false, "logger_creator": null, "logger_config": null, "log_level": "WARN", "log_sys_usage": true, "fake_sampler": false, "seed": 1, "restart_failed_env_runners": true, "ignore_env_runner_failures": false, "max_num_env_runner_restarts": 1000, "delay_between_env_runner_restarts_s": 60.0, "restart_failed_sub_environments": false, "num_consecutive_env_runner_failures_tolerance": 100, "env_runner_health_probe_timeout_s": 30.0, "env_runner_restore_timeout_s": 1800.0, "_model_config": {}, "_rl_module_spec": "RLModuleSpec(module_class=None, observation_space=None, action_space=None, inference_only=False, learner_only=False, model_config=DefaultModelConfig(fcnet_hiddens=[60, 90], fcnet_activation='tanh', fcnet_kernel_initializer=None, fcnet_kernel_initializer_kwargs=None, fcnet_bias_initializer=None, fcnet_bias_initializer_kwargs=None, conv_filters=None, conv_activation='relu', conv_kernel_initializer=None, conv_kernel_initializer_kwargs=None, conv_bias_initializer=None, conv_bias_initializer_kwargs=None, head_fcnet_hiddens=[], head_fcnet_activation='relu', head_fcnet_kernel_initializer=None, head_fcnet_kernel_initializer_kwargs=None, head_fcnet_bias_initializer=None, head_fcnet_bias_initializer_kwargs=None, free_log_std=False, log_std_clip_param=20.0, vf_share_layers=True, use_lstm=False, max_seq_len=20, lstm_cell_size=256, lstm_use_prev_action=False, lstm_use_prev_reward=False, lstm_kernel_initializer=None, lstm_kernel_initializer_kwargs=None, lstm_bias_initializer=None, lstm_bias_initializer_kwargs=None), catalog_class=None, load_state_path=None, model_config_dict=None)", "algorithm_config_overrides_per_module": {}, "_per_module_overrides": {}, "_validate_config": true, "_use_msgpack_checkpoints": false, "_torch_grad_scaler_class": null, "_torch_lr_scheduler_classes": null, "_tf_policy_handles_more_than_one_loss": false, "_disable_preprocessor_api": false, "_disable_action_flattening": false, "_disable_initialize_loss_from_dummy_batch": false, "_dont_auto_sync_env_runner_states": false, "env_task_fn": -1, "enable_connectors": -1, "simple_optimizer": false, "policy_map_cache": -1, "worker_cls": -1, "synchronize_filters": -1, "enable_async_evaluation": -1, "custom_async_evaluation_function": -1, "_enable_rl_module_api": -1, "auto_wrap_old_gym_envs": -1, "always_attach_evaluation_results": -1, "replay_sequence_length": null, "_disable_execution_plan_api": -1, "use_critic": true, "use_gae": true, "use_kl_loss": true, "kl_coeff": 0.7464963036515, "kl_target": 0.0270990929592, "vf_loss_coeff": 0.6688075857018, "entropy_coeff": 0.0090570820258, "clip_param": 0.1221781641624, "vf_clip_param": 0.1027808522125, "entropy_coeff_schedule": null, "lr_schedule": null, "sgd_minibatch_size": -1, "vf_share_layers": -1, "__stdout_file__": null, "__stderr_file__": null, "lambda": 0.9099046732075, "input": "sampler", "policies": {"default_policy": [null, null, null, null]}, "callbacks": "<class 'ray.rllib.callbacks.callbacks.RLlibCallback'>", "create_env_on_driver": false, "custom_eval_function": null, "framework": "torch"}, "time_since_restore": 20.065484046936035, "iterations_since_restore": 11, "perf": {"cpu_util_percent": 63.85, "ram_util_percent": 80.6}}
{"timers": {"training_iteration": 1.8979450838336578, "restore_env_runners": 1.1794430830699762e-05, "training_step": 1.8977873619617591, "env_runner_sampling_timer": 1.7779467029575187, "learner_update_timer": 0.11647193757208088, "synch_weights": 0.0007359978347115499, "restore_eval_env_runners": 8.920024980405513e-06, "evaluation_iteration": 0.12812477692356702, "synch_eval_env_connectors": 0.0001186447310404154, "synch_env_connectors": 5.582502093766438e-06}, "env_runners": {"env_to_module_connector": {"timers": {"connectors": {"add_observations_from_episodes_to_batch": 3.146289051569218e-06, "batch_individual_items": 6.5575711126205464e-06, "numpy_to_tensor": 9.023532720008046e-06, "add_states_from_episodes_to_batch": 1.770543621998995e-06, "add_time_dim_to_batch_and_zero_pad": 2.4356357213597115e-06}}, "connector_pipeline_timer": 4.475581474480858e-05}, "episode_len_mean": 20.0, "sample": 0.005019389640543943, "module_to_env_connector": {"timers": {"connectors": {"get_actions": 4.064827274799835e-05, "un_batch_to_individual_items": 5.564889677651713e-06, "normalize_and_clip_actions": 9.728870250336482e-06, "listify_data_for_vector_env": 1.139509159471028e-05, "remove_single_ts_time_rank_from_batch": 6.025496700991548e-07, "tensor_to_numpy": 1.3775610663181347e-05}}, "connector_pipeline_timer": 0.00010768718706763665}, "num_module_steps_sampled": {"default_policy": 5000.0}, "num_agent_steps_sampled_lifetime": {"default_agent": -6165000.0}, "num_env_steps_sampled": 5000.0, "episode_duration_sec_mean": 0.004709851807914674, "num_agent_steps_sampled": {"default_agent": 5000.0}, "env_to_module_sum_episodes_length_out": 10.36823839457432, "num_episodes": 250.0, "time_between_sampling": 0.0019869172325386237, "env_step_timer": 1.4323770503316784e-05, "agent_episode_returns_mean": {"default_agent": 5.740000000000001}, "episode_return_mean": 5.740000000000001, "num_module_steps_sampled_lifetime": {"default_policy": -6165000.0}, "env_to_module_sum_episodes_length_in": 10.36823839457432, "episode_return_max": 9.5, "num_episodes_lifetime": -308250.0, "weights_seq_no": 11.0, "module_episode_returns_mean": {"default_policy": 5.740000000000001}, "episode_return_min": -10.5, "episode_len_min": 20, "episode_len_max": 20, "env_reset_timer": 3.953314224878071e-05, "num_env_steps_sampled_lifetime": -6165000.0, "rlmodule_inference_timer": 2.90730323157529e-05, "num_env_steps_sampled_lifetime_throughput": 3596.5562488755772}, "learners": {"__all_modules__": {"num_module_steps_trained_lifetime": 72000, "learner_connector_sum_episodes_length_in": 5000.0, "learner_connector": {"timers": {"connectors": {"add_observations_from_episodes_to_batch": 0.00082586961579081, "batch_individual_items": 0.03365751598997491, "general_advantage_estimation": 0.007879205021294612, "add_one_ts_to_episodes_and_truncate": 0.00859635192123958, "add_time_dim_to_batch_and_zero_pad": 1.2209736365104414e-05, "add_states_from_episodes_to_batch": 3.7534274430840444e-06, "add_columns_from_episodes_to_train_batch": 0.03440145813712168, "numpy_to_tensor": 7.181577144721469e-05}}, "connector_pipeline_timer": 0.0855911416187132}, "num_env_steps_trained": 31500, "num_env_steps_trained_lifetime": 378000, "num_non_trainable_parameters": 0, "learner_connector_sum_episodes_length_out": 5250.0, "num_module_steps_trained": 6000, "num_trainable_parameters": 6003, "num_env_steps_trained_lifetime_throughput": 1757313.6038194434, "num_module_steps_trained_throughput": 335690.721107066, "num_module_steps_trained_lifetime_throughput": 335290.87591094576}, "default_policy": {"vf_loss": 0.10278083384037018, "curr_entropy_coeff": 0.0090570820258, "mean_kl_loss": 1.5084176993696019e-05, "weights_seq_no": 12.0, "module_train_batch_size_mean": 1000.0, "vf_explained_var": -0.020839571952819824, "gradients_default_optimizer_global_norm": 0.020691007375717163, "diff_num_grad_updates_vs_sampler_policy": 1.0, "default_optimizer_learning_rate": 0.0002847858517, "curr_kl_coeff": 0.00018225007806904614, "num_module_steps_trained": 6000, "num_trainable_parameters": 6003, "total_loss": -0.13557009398937225, "num_module_steps_trained_lifetime": 72000, "vf_loss_unclipped": 26.743595123291016, "policy_loss": -0.19873479008674622, "entropy": 0.6156450510025024, "num_module_steps_trained_lifetime_throughput": 335901.8906572568}}, "num_training_step_calls_per_iteration": 1, "evaluation": {"env_runners": {"sample": 0.1201243910283685, "num_module_steps_sampled": {"default_policy": 400}, "env_to_module_connector": {"timers": {"connectors": {"add_observations_from_episodes_to_batch": 2.8245573294377264e-06, "numpy_to_tensor": 8.226926893584984e-06, "batch_individual_items": 6.068776661934289e-06, "add_time_dim_to_batch_and_zero_pad": 2.2222003136425053e-06, "add_states_from_episodes_to_batch": 1.6034376347419643e-06}}, "connector_pipeline_timer": 4.257188017811563e-05}, "num_agent_steps_sampled_lifetime": {"default_agent": 4800}, "module_to_env_connector": {"timers": {"connectors": {"tensor_to_numpy": 1.3016015655130652e-05, "get_actions": 3.647605933682389e-05, "listify_data_for_vector_env": 1.0686703615460542e-05, "normalize_and_clip_actions": 9.469704461437559e-06, "remove_single_ts_time_rank_from_batch": 5.646916450586375e-07, "un_batch_to_individual_items": 5.331696260094557e-06}}, "connector_pipeline_timer": 0.00010137584713661189}, "agent_episode_returns_mean": {"default_agent": -1.0}, "num_env_steps_sampled": 400, "env_to_module_sum_episodes_length_out": 10.368238394574323, "num_episodes": 20, "num_agent_steps_sampled": {"default_agent": 400}, "num_episodes_lifetime": 240, "weights_seq_no": 12.0, "env_reset_timer": 0.00015487709114072427, "module_episode_returns_mean": {"default_policy": -1.0}, "rlmodule_inference_timer": 2.7219787924119926e-05, "env_to_module_sum_episodes_length_in": 10.368238394574323, "episode_return_max": 11.5, "episode_len_min": 20, "episode_len_mean": 20.0, "episode_duration_sec_mean": 0.004575569572625682, "env_step_timer": 1.372875106367362e-05, "episode_return_mean": -1.0, "num_module_steps_sampled_lifetime": {"default_policy": 4800}, "episode_return_min": -12.5, "episode_len_max": 20, "num_env_steps_sampled_lifetime": 60400, "time_between_sampling": 1.8632557736470823}, "num_healthy_workers": 1, "actor_manager_num_outstanding_async_reqs": 0, "num_remote_worker_restarts": 0}, "num_env_steps_sampled_lifetime": -6165000.0, "fault_tolerance": {"num_healthy_workers": 0, "num_remote_worker_restarts": 0}, "env_runner_group": {"actor_manager_num_outstanding_async_reqs": 0}, "done": false, "training_iteration": 12, "trial_id": "43778_00000", "date": "2025-08-11_19-20-27", "timestamp": 1754932827, "time_this_iter_s": 1.7758851051330566, "time_total_s": 21.841369152069092, "pid": 14172, "hostname": "Mac", "node_ip": "127.0.0.1", "config": {"exploration_config": {}, "extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "placement_strategy": "PACK", "num_gpus": 0, "_fake_gpus": false, "num_cpus_for_main_process": 2, "eager_tracing": true, "eager_max_retraces": 20, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "torch_compile_learner": false, "torch_compile_learner_what_to_compile": "forward_train", "torch_compile_learner_dynamo_backend": "aot_eager", "torch_compile_learner_dynamo_mode": null, "torch_compile_worker": false, "torch_compile_worker_dynamo_backend": "aot_eager", "torch_compile_worker_dynamo_mode": null, "torch_ddp_kwargs": {}, "torch_skip_nan_gradients": false, "env": "Umbrella", "env_config": {}, "observation_space": null, "action_space": null, "clip_rewards": null, "normalize_actions": true, "clip_actions": false, "_is_atari": null, "disable_env_checking": false, "render_env": false, "action_mask_key": "action_mask", "env_runner_cls": null, "num_env_runners": 0, "create_local_env_runner": true, "num_envs_per_env_runner": 1, "gym_env_vectorize_mode": "SYNC", "num_cpus_per_env_runner": 1, "num_gpus_per_env_runner": 0, "custom_resources_per_env_runner": {}, "validate_env_runners_after_construction": true, "episodes_to_numpy": true, "max_requests_in_flight_per_env_runner": 1, "sample_timeout_s": 60.0, "_env_to_module_connector": null, "add_default_connectors_to_env_to_module_pipeline": true, "_module_to_env_connector": null, "add_default_connectors_to_module_to_env_pipeline": true, "merge_env_runner_states": "training_only", "broadcast_env_runner_states": true, "episode_lookback_horizon": 1, "rollout_fragment_length": "auto", "batch_mode": "complete_episodes", "compress_observations": false, "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "enable_tf1_exec_eagerly": false, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "preprocessor_pref": "deepmind", "observation_filter": "NoFilter", "update_worker_filter_stats": true, "use_worker_filter_stats": true, "sampler_perf_stats_ema_coef": null, "_is_online": true, "num_learners": 0, "num_gpus_per_learner": 0, "num_cpus_per_learner": "auto", "num_aggregator_actors_per_learner": 0, "max_requests_in_flight_per_aggregator_actor": 3, "local_gpu_idx": 0, "max_requests_in_flight_per_learner": 3, "gamma": 1, "lr": 0.0002847858517, "grad_clip": 0.5, "grad_clip_by": "global_norm", "_train_batch_size_per_learner": 5000, "train_batch_size": 4000, "num_epochs": 1, "minibatch_size": 1000, "shuffle_batch_per_epoch": true, "model": {"fcnet_hiddens": [256, 256], "fcnet_activation": "tanh", "fcnet_weights_initializer": null, "fcnet_weights_initializer_config": null, "fcnet_bias_initializer": null, "fcnet_bias_initializer_config": null, "conv_filters": null, "conv_activation": "relu", "conv_kernel_initializer": null, "conv_kernel_initializer_config": null, "conv_bias_initializer": null, "conv_bias_initializer_config": null, "conv_transpose_kernel_initializer": null, "conv_transpose_kernel_initializer_config": null, "conv_transpose_bias_initializer": null, "conv_transpose_bias_initializer_config": null, "post_fcnet_hiddens": [], "post_fcnet_activation": "relu", "post_fcnet_weights_initializer": null, "post_fcnet_weights_initializer_config": null, "post_fcnet_bias_initializer": null, "post_fcnet_bias_initializer_config": null, "free_log_std": false, "log_std_clip_param": 20.0, "no_final_linear": false, "vf_share_layers": false, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "lstm_weights_initializer": null, "lstm_weights_initializer_config": null, "lstm_bias_initializer": null, "lstm_bias_initializer_config": null, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "attention_use_n_prev_actions": 0, "attention_use_n_prev_rewards": 0, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": null, "custom_model_config": {}, "custom_action_dist": null, "custom_preprocessor": null, "encoder_latent_dim": null, "always_check_shapes": false, "lstm_use_prev_action_reward": -1, "_use_default_native_models": -1, "_disable_preprocessor_api": false, "_disable_action_flattening": false}, "_learner_connector": null, "add_default_connectors_to_learner_pipeline": true, "learner_config_dict": {}, "optimizer": {}, "_learner_class": null, "callbacks_on_algorithm_init": null, "callbacks_on_env_runners_recreated": null, "callbacks_on_offline_eval_runners_recreated": null, "callbacks_on_checkpoint_loaded": null, "callbacks_on_environment_created": null, "callbacks_on_episode_created": null, "callbacks_on_episode_start": null, "callbacks_on_episode_step": null, "callbacks_on_episode_end": null, "callbacks_on_evaluate_start": null, "callbacks_on_evaluate_end": null, "callbacks_on_evaluate_offline_start": null, "callbacks_on_evaluate_offline_end": null, "callbacks_on_sample_end": null, "callbacks_on_train_result": null, "explore": true, "enable_rl_module_and_learner": true, "enable_env_runner_and_connector_v2": true, "_prior_exploration_config": {"type": "StochasticSampling"}, "count_steps_by": "env_steps", "policy_map_capacity": 100, "policy_mapping_fn": "<function AlgorithmConfig.DEFAULT_POLICY_MAPPING_FN at 0x3888f18a0>", "policies_to_train": null, "policy_states_are_swappable": false, "observation_fn": null, "offline_data_class": null, "input_read_method": "read_parquet", "input_read_method_kwargs": {}, "input_read_schema": {}, "input_read_episodes": false, "input_read_sample_batches": false, "input_read_batch_size": null, "input_filesystem": null, "input_filesystem_kwargs": {}, "input_compress_columns": ["obs", "new_obs"], "input_spaces_jsonable": true, "materialize_data": false, "materialize_mapped_data": true, "map_batches_kwargs": {}, "iter_batches_kwargs": {}, "ignore_final_observation": false, "prelearner_class": null, "prelearner_buffer_class": null, "prelearner_buffer_kwargs": {}, "prelearner_module_synch_period": 10, "dataset_num_iters_per_learner": null, "input_config": {}, "actions_in_input_normalized": false, "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_config": {}, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "output_max_rows_per_file": null, "output_write_remaining_data": false, "output_write_method": "write_parquet", "output_write_method_kwargs": {}, "output_filesystem": null, "output_filesystem_kwargs": {}, "output_write_episodes": true, "offline_sampling": false, "evaluation_interval": 1, "evaluation_duration": 20, "evaluation_duration_unit": "episodes", "evaluation_sample_timeout_s": 120.0, "evaluation_auto_duration_min_env_steps_per_sample": 100, "evaluation_auto_duration_max_env_steps_per_sample": 2000, "evaluation_parallel_to_training": false, "evaluation_force_reset_envs_before_iteration": true, "evaluation_config": null, "off_policy_estimation_methods": {}, "ope_split_batch_by_episode": true, "evaluation_num_env_runners": 1, "in_evaluation": false, "sync_filters_on_rollout_workers_timeout_s": 10.0, "offline_evaluation_interval": null, "num_offline_eval_runners": 0, "offline_loss_for_module_fn": null, "offline_evaluation_duration": 1, "offline_evaluation_parallel_to_training": false, "offline_evaluation_timeout_s": 120.0, "num_cpus_per_offline_eval_runner": 1, "num_gpus_per_offline_eval_runner": 0, "custom_resources_per_offline_eval_runner": {}, "restart_failed_offline_eval_runners": true, "ignore_offline_eval_runner_failures": false, "max_num_offline_eval_runner_restarts": 1000, "offline_eval_runner_restore_timeout_s": 1800.0, "max_requests_in_flight_per_offline_eval_runner": 1, "validate_offline_eval_runners_after_construction": true, "offline_eval_runner_health_probe_timeout_s": 30.0, "offline_eval_rl_module_inference_only": false, "broadcast_offline_eval_runner_states": false, "offline_eval_batch_size_per_runner": 256, "dataset_num_iters_per_eval_runner": 1, "keep_per_episode_custom_metrics": false, "metrics_episode_collection_timeout_s": 60.0, "metrics_num_episodes_for_smoothing": 100, "min_time_s_per_iteration": null, "min_train_timesteps_per_iteration": 0, "min_sample_timesteps_per_iteration": 0, "log_gradients": true, "export_native_model_files": false, "checkpoint_trainable_policies_only": false, "logger_creator": null, "logger_config": null, "log_level": "WARN", "log_sys_usage": true, "fake_sampler": false, "seed": 1, "restart_failed_env_runners": true, "ignore_env_runner_failures": false, "max_num_env_runner_restarts": 1000, "delay_between_env_runner_restarts_s": 60.0, "restart_failed_sub_environments": false, "num_consecutive_env_runner_failures_tolerance": 100, "env_runner_health_probe_timeout_s": 30.0, "env_runner_restore_timeout_s": 1800.0, "_model_config": {}, "_rl_module_spec": "RLModuleSpec(module_class=None, observation_space=None, action_space=None, inference_only=False, learner_only=False, model_config=DefaultModelConfig(fcnet_hiddens=[60, 90], fcnet_activation='tanh', fcnet_kernel_initializer=None, fcnet_kernel_initializer_kwargs=None, fcnet_bias_initializer=None, fcnet_bias_initializer_kwargs=None, conv_filters=None, conv_activation='relu', conv_kernel_initializer=None, conv_kernel_initializer_kwargs=None, conv_bias_initializer=None, conv_bias_initializer_kwargs=None, head_fcnet_hiddens=[], head_fcnet_activation='relu', head_fcnet_kernel_initializer=None, head_fcnet_kernel_initializer_kwargs=None, head_fcnet_bias_initializer=None, head_fcnet_bias_initializer_kwargs=None, free_log_std=False, log_std_clip_param=20.0, vf_share_layers=True, use_lstm=False, max_seq_len=20, lstm_cell_size=256, lstm_use_prev_action=False, lstm_use_prev_reward=False, lstm_kernel_initializer=None, lstm_kernel_initializer_kwargs=None, lstm_bias_initializer=None, lstm_bias_initializer_kwargs=None), catalog_class=None, load_state_path=None, model_config_dict=None)", "algorithm_config_overrides_per_module": {}, "_per_module_overrides": {}, "_validate_config": true, "_use_msgpack_checkpoints": false, "_torch_grad_scaler_class": null, "_torch_lr_scheduler_classes": null, "_tf_policy_handles_more_than_one_loss": false, "_disable_preprocessor_api": false, "_disable_action_flattening": false, "_disable_initialize_loss_from_dummy_batch": false, "_dont_auto_sync_env_runner_states": false, "env_task_fn": -1, "enable_connectors": -1, "simple_optimizer": false, "policy_map_cache": -1, "worker_cls": -1, "synchronize_filters": -1, "enable_async_evaluation": -1, "custom_async_evaluation_function": -1, "_enable_rl_module_api": -1, "auto_wrap_old_gym_envs": -1, "always_attach_evaluation_results": -1, "replay_sequence_length": null, "_disable_execution_plan_api": -1, "use_critic": true, "use_gae": true, "use_kl_loss": true, "kl_coeff": 0.7464963036515, "kl_target": 0.0270990929592, "vf_loss_coeff": 0.6688075857018, "entropy_coeff": 0.0090570820258, "clip_param": 0.1221781641624, "vf_clip_param": 0.1027808522125, "entropy_coeff_schedule": null, "lr_schedule": null, "sgd_minibatch_size": -1, "vf_share_layers": -1, "__stdout_file__": null, "__stderr_file__": null, "lambda": 0.9099046732075, "input": "sampler", "policies": {"default_policy": [null, null, null, null]}, "callbacks": "<class 'ray.rllib.callbacks.callbacks.RLlibCallback'>", "create_env_on_driver": false, "custom_eval_function": null, "framework": "torch"}, "time_since_restore": 21.841369152069092, "iterations_since_restore": 12, "perf": {"cpu_util_percent": 79.96666666666665, "ram_util_percent": 82.36666666666667}}
{"timers": {"training_iteration": 1.8975824488252038, "restore_env_runners": 1.1967316443534032e-05, "training_step": 1.8974236287523507, "env_runner_sampling_timer": 1.7774443155075967, "learner_update_timer": 0.1165409594462492, "synch_weights": 0.0007946478560829515, "restore_eval_env_runners": 8.907484220024494e-06, "evaluation_iteration": 0.12792993581436476, "synch_eval_env_connectors": 0.00011859120388158764, "synch_env_connectors": 5.566676213255289e-06}, "env_runners": {"env_to_module_connector": {"timers": {"connectors": {"add_observations_from_episodes_to_batch": 3.1815438870661423e-06, "batch_individual_items": 7.115194753813261e-06, "numpy_to_tensor": 9.500663995240619e-06, "add_states_from_episodes_to_batch": 1.8142111211577465e-06, "add_time_dim_to_batch_and_zero_pad": 2.5095962383175533e-06}}, "connector_pipeline_timer": 4.675181743876439e-05}, "episode_len_mean": 20.0, "sample": 0.005155334859155655, "module_to_env_connector": {"timers": {"connectors": {"get_actions": 4.348979344155511e-05, "un_batch_to_individual_items": 5.691059963783035e-06, "normalize_and_clip_actions": 1.0889941284512913e-05, "listify_data_for_vector_env": 1.1718264659934813e-05, "remove_single_ts_time_rank_from_batch": 6.135883077930444e-07, "tensor_to_numpy": 1.4529657235509374e-05}}, "connector_pipeline_timer": 0.00011404856643561386}, "num_module_steps_sampled": {"default_policy": 5000.0}, "num_agent_steps_sampled_lifetime": {"default_agent": -6782500.0}, "num_env_steps_sampled": 5000.0, "episode_duration_sec_mean": 0.0049842414725571865, "num_agent_steps_sampled": {"default_agent": 5000.0}, "env_to_module_sum_episodes_length_out": 10.36823839457432, "num_episodes": 250.0, "time_between_sampling": 0.001857630643237741, "env_step_timer": 1.5008189492679814e-05, "agent_episode_returns_mean": {"default_agent": 6.940000000000001}, "episode_return_mean": 6.940000000000001, "num_module_steps_sampled_lifetime": {"default_policy": -6782500.0}, "env_to_module_sum_episodes_length_in": 10.36823839457432, "episode_return_max": 9.5, "num_episodes_lifetime": -339125.0, "weights_seq_no": 12.0, "module_episode_returns_mean": {"default_policy": 6.940000000000001}, "episode_return_min": -10.5, "episode_len_min": 20, "episode_len_max": 20, "env_reset_timer": 4.122544519009207e-05, "num_env_steps_sampled_lifetime": -6782500.0, "rlmodule_inference_timer": 3.160309664777061e-05, "num_env_steps_sampled_lifetime_throughput": 3520.001087641056}, "learners": {"__all_modules__": {"num_module_steps_trained_lifetime": 78000, "learner_connector_sum_episodes_length_in": 5000.0, "learner_connector": {"timers": {"connectors": {"add_observations_from_episodes_to_batch": 0.0008264534200252494, "batch_individual_items": 0.033650914580124404, "general_advantage_estimation": 0.007874007561730675, "add_one_ts_to_episodes_and_truncate": 0.008596710491218709, "add_time_dim_to_batch_and_zero_pad": 1.230305973372802e-05, "add_states_from_episodes_to_batch": 3.7488037801336785e-06, "add_columns_from_episodes_to_train_batch": 0.03440116813576645, "numpy_to_tensor": 7.184386272117721e-05}}, "connector_pipeline_timer": 0.08557998854291647}, "num_env_steps_trained": 31500, "num_env_steps_trained_lifetime": 409500, "num_non_trainable_parameters": 0, "learner_connector_sum_episodes_length_out": 5250.0, "num_module_steps_trained": 6000, "num_trainable_parameters": 6003, "num_env_steps_trained_lifetime_throughput": 1752276.5692081335, "num_module_steps_trained_throughput": 334690.8186205768, "num_module_steps_trained_lifetime_throughput": 334302.90481257986}, "default_policy": {"vf_loss": 0.10278083384037018, "curr_entropy_coeff": 0.0090570820258, "mean_kl_loss": 7.769689545966685e-05, "weights_seq_no": 13.0, "module_train_batch_size_mean": 1000.0, "vf_explained_var": -0.02140367031097412, "gradients_default_optimizer_global_norm": 0.05055728554725647, "diff_num_grad_updates_vs_sampler_policy": 1.0, "default_optimizer_learning_rate": 0.0002847858517, "curr_kl_coeff": 9.112503903452307e-05, "num_module_steps_trained": 6000, "num_trainable_parameters": 6003, "total_loss": 0.02526637353003025, "num_module_steps_trained_lifetime": 78000, "vf_loss_unclipped": 26.886669158935547, "policy_loss": -0.037887606769800186, "entropy": 0.6168266534805298, "num_module_steps_trained_lifetime_throughput": 334866.4484345384}}, "num_training_step_calls_per_iteration": 1, "evaluation": {"env_runners": {"sample": 0.12076686503821307, "num_module_steps_sampled": {"default_policy": 400}, "env_to_module_connector": {"timers": {"connectors": {"add_observations_from_episodes_to_batch": 6.6162493088078534e-06, "numpy_to_tensor": 1.9170275729562762e-05, "batch_individual_items": 1.361667895489579e-05, "add_time_dim_to_batch_and_zero_pad": 5.564180654650579e-06, "add_states_from_episodes_to_batch": 4.176916212150989e-06}}, "connector_pipeline_timer": 9.391240462959787e-05}, "num_agent_steps_sampled_lifetime": {"default_agent": 5200}, "module_to_env_connector": {"timers": {"connectors": {"tensor_to_numpy": 3.763426921849827e-05, "get_actions": 0.00011101941371876328, "listify_data_for_vector_env": 2.9388208933152247e-05, "normalize_and_clip_actions": 2.0831449133266668e-05, "remove_single_ts_time_rank_from_batch": 1.6324857956240846e-06, "un_batch_to_individual_items": 1.5283577279090435e-05}}, "connector_pipeline_timer": 0.00027815708585173676}, "agent_episode_returns_mean": {"default_agent": -0.2}, "num_env_steps_sampled": 400, "env_to_module_sum_episodes_length_out": 10.368238394574323, "num_episodes": 20, "num_agent_steps_sampled": {"default_agent": 400}, "num_episodes_lifetime": 260, "weights_seq_no": 13.0, "env_reset_timer": 0.00016203957049537726, "module_episode_returns_mean": {"default_policy": -0.2}, "rlmodule_inference_timer": 8.275728820847207e-05, "env_to_module_sum_episodes_length_in": 10.368238394574323, "episode_return_max": 11.5, "episode_len_min": 20, "episode_len_mean": 20.0, "episode_duration_sec_mean": 0.005349831661442294, "env_step_timer": 3.779227934444866e-05, "episode_return_mean": -0.2, "num_module_steps_sampled_lifetime": {"default_policy": 5200}, "episode_return_min": -12.5, "episode_len_max": 20, "num_env_steps_sampled_lifetime": 65400, "time_between_sampling": 1.8635845171609948}, "num_healthy_workers": 1, "actor_manager_num_outstanding_async_reqs": 0, "num_remote_worker_restarts": 0}, "num_env_steps_sampled_lifetime": -6782500.0, "fault_tolerance": {"num_healthy_workers": 0, "num_remote_worker_restarts": 0}, "env_runner_group": {"actor_manager_num_outstanding_async_reqs": 0}, "done": false, "training_iteration": 13, "trial_id": "43778_00000", "date": "2025-08-11_19-20-29", "timestamp": 1754932829, "time_this_iter_s": 2.078315019607544, "time_total_s": 23.919684171676636, "pid": 14172, "hostname": "Mac", "node_ip": "127.0.0.1", "config": {"exploration_config": {}, "extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "placement_strategy": "PACK", "num_gpus": 0, "_fake_gpus": false, "num_cpus_for_main_process": 2, "eager_tracing": true, "eager_max_retraces": 20, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "torch_compile_learner": false, "torch_compile_learner_what_to_compile": "forward_train", "torch_compile_learner_dynamo_backend": "aot_eager", "torch_compile_learner_dynamo_mode": null, "torch_compile_worker": false, "torch_compile_worker_dynamo_backend": "aot_eager", "torch_compile_worker_dynamo_mode": null, "torch_ddp_kwargs": {}, "torch_skip_nan_gradients": false, "env": "Umbrella", "env_config": {}, "observation_space": null, "action_space": null, "clip_rewards": null, "normalize_actions": true, "clip_actions": false, "_is_atari": null, "disable_env_checking": false, "render_env": false, "action_mask_key": "action_mask", "env_runner_cls": null, "num_env_runners": 0, "create_local_env_runner": true, "num_envs_per_env_runner": 1, "gym_env_vectorize_mode": "SYNC", "num_cpus_per_env_runner": 1, "num_gpus_per_env_runner": 0, "custom_resources_per_env_runner": {}, "validate_env_runners_after_construction": true, "episodes_to_numpy": true, "max_requests_in_flight_per_env_runner": 1, "sample_timeout_s": 60.0, "_env_to_module_connector": null, "add_default_connectors_to_env_to_module_pipeline": true, "_module_to_env_connector": null, "add_default_connectors_to_module_to_env_pipeline": true, "merge_env_runner_states": "training_only", "broadcast_env_runner_states": true, "episode_lookback_horizon": 1, "rollout_fragment_length": "auto", "batch_mode": "complete_episodes", "compress_observations": false, "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "enable_tf1_exec_eagerly": false, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "preprocessor_pref": "deepmind", "observation_filter": "NoFilter", "update_worker_filter_stats": true, "use_worker_filter_stats": true, "sampler_perf_stats_ema_coef": null, "_is_online": true, "num_learners": 0, "num_gpus_per_learner": 0, "num_cpus_per_learner": "auto", "num_aggregator_actors_per_learner": 0, "max_requests_in_flight_per_aggregator_actor": 3, "local_gpu_idx": 0, "max_requests_in_flight_per_learner": 3, "gamma": 1, "lr": 0.0002847858517, "grad_clip": 0.5, "grad_clip_by": "global_norm", "_train_batch_size_per_learner": 5000, "train_batch_size": 4000, "num_epochs": 1, "minibatch_size": 1000, "shuffle_batch_per_epoch": true, "model": {"fcnet_hiddens": [256, 256], "fcnet_activation": "tanh", "fcnet_weights_initializer": null, "fcnet_weights_initializer_config": null, "fcnet_bias_initializer": null, "fcnet_bias_initializer_config": null, "conv_filters": null, "conv_activation": "relu", "conv_kernel_initializer": null, "conv_kernel_initializer_config": null, "conv_bias_initializer": null, "conv_bias_initializer_config": null, "conv_transpose_kernel_initializer": null, "conv_transpose_kernel_initializer_config": null, "conv_transpose_bias_initializer": null, "conv_transpose_bias_initializer_config": null, "post_fcnet_hiddens": [], "post_fcnet_activation": "relu", "post_fcnet_weights_initializer": null, "post_fcnet_weights_initializer_config": null, "post_fcnet_bias_initializer": null, "post_fcnet_bias_initializer_config": null, "free_log_std": false, "log_std_clip_param": 20.0, "no_final_linear": false, "vf_share_layers": false, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "lstm_weights_initializer": null, "lstm_weights_initializer_config": null, "lstm_bias_initializer": null, "lstm_bias_initializer_config": null, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "attention_use_n_prev_actions": 0, "attention_use_n_prev_rewards": 0, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": null, "custom_model_config": {}, "custom_action_dist": null, "custom_preprocessor": null, "encoder_latent_dim": null, "always_check_shapes": false, "lstm_use_prev_action_reward": -1, "_use_default_native_models": -1, "_disable_preprocessor_api": false, "_disable_action_flattening": false}, "_learner_connector": null, "add_default_connectors_to_learner_pipeline": true, "learner_config_dict": {}, "optimizer": {}, "_learner_class": null, "callbacks_on_algorithm_init": null, "callbacks_on_env_runners_recreated": null, "callbacks_on_offline_eval_runners_recreated": null, "callbacks_on_checkpoint_loaded": null, "callbacks_on_environment_created": null, "callbacks_on_episode_created": null, "callbacks_on_episode_start": null, "callbacks_on_episode_step": null, "callbacks_on_episode_end": null, "callbacks_on_evaluate_start": null, "callbacks_on_evaluate_end": null, "callbacks_on_evaluate_offline_start": null, "callbacks_on_evaluate_offline_end": null, "callbacks_on_sample_end": null, "callbacks_on_train_result": null, "explore": true, "enable_rl_module_and_learner": true, "enable_env_runner_and_connector_v2": true, "_prior_exploration_config": {"type": "StochasticSampling"}, "count_steps_by": "env_steps", "policy_map_capacity": 100, "policy_mapping_fn": "<function AlgorithmConfig.DEFAULT_POLICY_MAPPING_FN at 0x3888f18a0>", "policies_to_train": null, "policy_states_are_swappable": false, "observation_fn": null, "offline_data_class": null, "input_read_method": "read_parquet", "input_read_method_kwargs": {}, "input_read_schema": {}, "input_read_episodes": false, "input_read_sample_batches": false, "input_read_batch_size": null, "input_filesystem": null, "input_filesystem_kwargs": {}, "input_compress_columns": ["obs", "new_obs"], "input_spaces_jsonable": true, "materialize_data": false, "materialize_mapped_data": true, "map_batches_kwargs": {}, "iter_batches_kwargs": {}, "ignore_final_observation": false, "prelearner_class": null, "prelearner_buffer_class": null, "prelearner_buffer_kwargs": {}, "prelearner_module_synch_period": 10, "dataset_num_iters_per_learner": null, "input_config": {}, "actions_in_input_normalized": false, "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_config": {}, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "output_max_rows_per_file": null, "output_write_remaining_data": false, "output_write_method": "write_parquet", "output_write_method_kwargs": {}, "output_filesystem": null, "output_filesystem_kwargs": {}, "output_write_episodes": true, "offline_sampling": false, "evaluation_interval": 1, "evaluation_duration": 20, "evaluation_duration_unit": "episodes", "evaluation_sample_timeout_s": 120.0, "evaluation_auto_duration_min_env_steps_per_sample": 100, "evaluation_auto_duration_max_env_steps_per_sample": 2000, "evaluation_parallel_to_training": false, "evaluation_force_reset_envs_before_iteration": true, "evaluation_config": null, "off_policy_estimation_methods": {}, "ope_split_batch_by_episode": true, "evaluation_num_env_runners": 1, "in_evaluation": false, "sync_filters_on_rollout_workers_timeout_s": 10.0, "offline_evaluation_interval": null, "num_offline_eval_runners": 0, "offline_loss_for_module_fn": null, "offline_evaluation_duration": 1, "offline_evaluation_parallel_to_training": false, "offline_evaluation_timeout_s": 120.0, "num_cpus_per_offline_eval_runner": 1, "num_gpus_per_offline_eval_runner": 0, "custom_resources_per_offline_eval_runner": {}, "restart_failed_offline_eval_runners": true, "ignore_offline_eval_runner_failures": false, "max_num_offline_eval_runner_restarts": 1000, "offline_eval_runner_restore_timeout_s": 1800.0, "max_requests_in_flight_per_offline_eval_runner": 1, "validate_offline_eval_runners_after_construction": true, "offline_eval_runner_health_probe_timeout_s": 30.0, "offline_eval_rl_module_inference_only": false, "broadcast_offline_eval_runner_states": false, "offline_eval_batch_size_per_runner": 256, "dataset_num_iters_per_eval_runner": 1, "keep_per_episode_custom_metrics": false, "metrics_episode_collection_timeout_s": 60.0, "metrics_num_episodes_for_smoothing": 100, "min_time_s_per_iteration": null, "min_train_timesteps_per_iteration": 0, "min_sample_timesteps_per_iteration": 0, "log_gradients": true, "export_native_model_files": false, "checkpoint_trainable_policies_only": false, "logger_creator": null, "logger_config": null, "log_level": "WARN", "log_sys_usage": true, "fake_sampler": false, "seed": 1, "restart_failed_env_runners": true, "ignore_env_runner_failures": false, "max_num_env_runner_restarts": 1000, "delay_between_env_runner_restarts_s": 60.0, "restart_failed_sub_environments": false, "num_consecutive_env_runner_failures_tolerance": 100, "env_runner_health_probe_timeout_s": 30.0, "env_runner_restore_timeout_s": 1800.0, "_model_config": {}, "_rl_module_spec": "RLModuleSpec(module_class=None, observation_space=None, action_space=None, inference_only=False, learner_only=False, model_config=DefaultModelConfig(fcnet_hiddens=[60, 90], fcnet_activation='tanh', fcnet_kernel_initializer=None, fcnet_kernel_initializer_kwargs=None, fcnet_bias_initializer=None, fcnet_bias_initializer_kwargs=None, conv_filters=None, conv_activation='relu', conv_kernel_initializer=None, conv_kernel_initializer_kwargs=None, conv_bias_initializer=None, conv_bias_initializer_kwargs=None, head_fcnet_hiddens=[], head_fcnet_activation='relu', head_fcnet_kernel_initializer=None, head_fcnet_kernel_initializer_kwargs=None, head_fcnet_bias_initializer=None, head_fcnet_bias_initializer_kwargs=None, free_log_std=False, log_std_clip_param=20.0, vf_share_layers=True, use_lstm=False, max_seq_len=20, lstm_cell_size=256, lstm_use_prev_action=False, lstm_use_prev_reward=False, lstm_kernel_initializer=None, lstm_kernel_initializer_kwargs=None, lstm_bias_initializer=None, lstm_bias_initializer_kwargs=None), catalog_class=None, load_state_path=None, model_config_dict=None)", "algorithm_config_overrides_per_module": {}, "_per_module_overrides": {}, "_validate_config": true, "_use_msgpack_checkpoints": false, "_torch_grad_scaler_class": null, "_torch_lr_scheduler_classes": null, "_tf_policy_handles_more_than_one_loss": false, "_disable_preprocessor_api": false, "_disable_action_flattening": false, "_disable_initialize_loss_from_dummy_batch": false, "_dont_auto_sync_env_runner_states": false, "env_task_fn": -1, "enable_connectors": -1, "simple_optimizer": false, "policy_map_cache": -1, "worker_cls": -1, "synchronize_filters": -1, "enable_async_evaluation": -1, "custom_async_evaluation_function": -1, "_enable_rl_module_api": -1, "auto_wrap_old_gym_envs": -1, "always_attach_evaluation_results": -1, "replay_sequence_length": null, "_disable_execution_plan_api": -1, "use_critic": true, "use_gae": true, "use_kl_loss": true, "kl_coeff": 0.7464963036515, "kl_target": 0.0270990929592, "vf_loss_coeff": 0.6688075857018, "entropy_coeff": 0.0090570820258, "clip_param": 0.1221781641624, "vf_clip_param": 0.1027808522125, "entropy_coeff_schedule": null, "lr_schedule": null, "sgd_minibatch_size": -1, "vf_share_layers": -1, "__stdout_file__": null, "__stderr_file__": null, "lambda": 0.9099046732075, "input": "sampler", "policies": {"default_policy": [null, null, null, null]}, "callbacks": "<class 'ray.rllib.callbacks.callbacks.RLlibCallback'>", "create_env_on_driver": false, "custom_eval_function": null, "framework": "torch"}, "time_since_restore": 23.919684171676636, "iterations_since_restore": 13, "perf": {"cpu_util_percent": 78.16666666666667, "ram_util_percent": 82.76666666666667}}
{"timers": {"training_iteration": 1.8976657739179594, "restore_env_runners": 1.1924313245900692e-05, "training_step": 1.8975057924649448, "env_runner_sampling_timer": 1.775943370681622, "learner_update_timer": 0.11812607610166109, "synch_weights": 0.0007925413765887877, "restore_eval_env_runners": 9.377989890169087e-06, "evaluation_iteration": 0.12876296645660304, "synch_eval_env_connectors": 0.00012195862220647753, "synch_env_connectors": 5.609759912015653e-06}, "env_runners": {"env_to_module_connector": {"timers": {"connectors": {"add_observations_from_episodes_to_batch": 3.414357437967334e-06, "batch_individual_items": 7.563812056118421e-06, "numpy_to_tensor": 1.0367819999610582e-05, "add_states_from_episodes_to_batch": 1.9320472436363833e-06, "add_time_dim_to_batch_and_zero_pad": 2.722949523682944e-06}}, "connector_pipeline_timer": 4.989864925151918e-05}, "episode_len_mean": 20.0, "sample": 0.006219085983280116, "module_to_env_connector": {"timers": {"connectors": {"get_actions": 4.858976186864687e-05, "un_batch_to_individual_items": 6.260790195476967e-06, "normalize_and_clip_actions": 1.130962816056322e-05, "listify_data_for_vector_env": 1.287923626852135e-05, "remove_single_ts_time_rank_from_batch": 7.214978821847335e-07, "tensor_to_numpy": 1.6023639082653767e-05}}, "connector_pipeline_timer": 0.00012490513030208889}, "num_module_steps_sampled": {"default_policy": 5000.0}, "num_agent_steps_sampled_lifetime": {"default_agent": -7400000.0}, "num_env_steps_sampled": 5000.0, "episode_duration_sec_mean": 0.005390469204168766, "num_agent_steps_sampled": {"default_agent": 5000.0}, "env_to_module_sum_episodes_length_out": 10.36823839457432, "num_episodes": 250.0, "time_between_sampling": 0.0024997448469771828, "env_step_timer": 1.667613771653353e-05, "agent_episode_returns_mean": {"default_agent": 6.62}, "episode_return_mean": 6.62, "num_module_steps_sampled_lifetime": {"default_policy": -7400000.0}, "env_to_module_sum_episodes_length_in": 10.36823839457432, "episode_return_max": 9.5, "num_episodes_lifetime": -370000.0, "weights_seq_no": 13.0, "module_episode_returns_mean": {"default_policy": 6.62}, "episode_return_min": -10.5, "episode_len_min": 20, "episode_len_max": 20, "env_reset_timer": 5.339564568586069e-05, "num_env_steps_sampled_lifetime": -7400000.0, "rlmodule_inference_timer": 3.415060205785963e-05, "num_env_steps_sampled_lifetime_throughput": 3212.0468870354434}, "learners": {"__all_modules__": {"num_module_steps_trained_lifetime": 84000, "learner_connector_sum_episodes_length_in": 5000.0, "learner_connector": {"timers": {"connectors": {"add_observations_from_episodes_to_batch": 0.0008269384658357687, "batch_individual_items": 0.03540737210449359, "general_advantage_estimation": 0.007854468315241172, "add_one_ts_to_episodes_and_truncate": 0.008596962135945168, "add_time_dim_to_batch_and_zero_pad": 1.2313778699637705e-05, "add_states_from_episodes_to_batch": 3.7458957495278143e-06, "add_columns_from_episodes_to_train_batch": 0.03441156520425367, "numpy_to_tensor": 7.184250405936316e-05}}, "connector_pipeline_timer": 0.08732774990821307}, "num_env_steps_trained": 31500, "num_env_steps_trained_lifetime": 441000, "num_non_trainable_parameters": 0, "learner_connector_sum_episodes_length_out": 5250.0, "num_module_steps_trained": 6000, "num_trainable_parameters": 6003, "num_env_steps_trained_lifetime_throughput": 1753709.7629461884, "num_module_steps_trained_throughput": 334929.05860265024, "num_module_steps_trained_lifetime_throughput": 334550.7190062585}, "default_policy": {"vf_loss": 0.10278083384037018, "curr_entropy_coeff": 0.0090570820258, "mean_kl_loss": 6.392585055436939e-05, "weights_seq_no": 14.0, "module_train_batch_size_mean": 1000.0, "vf_explained_var": -0.022045254707336426, "gradients_default_optimizer_global_norm": 0.02799815684556961, "diff_num_grad_updates_vs_sampler_policy": 1.0, "default_optimizer_learning_rate": 0.0002847858517, "curr_kl_coeff": 4.5562519517261535e-05, "num_module_steps_trained": 6000, "num_trainable_parameters": 6003, "total_loss": 0.08509045839309692, "num_module_steps_trained_lifetime": 84000, "vf_loss_unclipped": 27.137771606445312, "policy_loss": 0.021915465593338013, "entropy": 0.6145032048225403, "num_module_steps_trained_lifetime_throughput": 335065.3590369897}}, "num_training_step_calls_per_iteration": 1, "evaluation": {"env_runners": {"sample": 0.12069812013808992, "num_module_steps_sampled": {"default_policy": 400}, "env_to_module_connector": {"timers": {"connectors": {"add_observations_from_episodes_to_batch": 3.1439566309154426e-06, "numpy_to_tensor": 9.923947845212663e-06, "batch_individual_items": 7.086973199833234e-06, "add_time_dim_to_batch_and_zero_pad": 2.7153536480733034e-06, "add_states_from_episodes_to_batch": 1.7587349103401324e-06}}, "connector_pipeline_timer": 4.8650515682627205e-05}, "num_agent_steps_sampled_lifetime": {"default_agent": 5600}, "module_to_env_connector": {"timers": {"connectors": {"tensor_to_numpy": 1.491463688770891e-05, "get_actions": 4.400082837272848e-05, "listify_data_for_vector_env": 1.2902015527135488e-05, "normalize_and_clip_actions": 1.1014276771608648e-05, "remove_single_ts_time_rank_from_batch": 6.140184708072137e-07, "un_batch_to_individual_items": 5.904644708280953e-06}}, "connector_pipeline_timer": 0.00011860421276443758}, "agent_episode_returns_mean": {"default_agent": 0.0}, "num_env_steps_sampled": 400, "env_to_module_sum_episodes_length_out": 10.368238394574323, "num_episodes": 20, "num_agent_steps_sampled": {"default_agent": 400}, "num_episodes_lifetime": 280, "weights_seq_no": 14.0, "env_reset_timer": 0.00016352626480538781, "module_episode_returns_mean": {"default_policy": 0.0}, "rlmodule_inference_timer": 3.066692167629716e-05, "env_to_module_sum_episodes_length_in": 10.368238394574323, "episode_return_max": 12.5, "episode_len_min": 20, "episode_len_mean": 20.0, "episode_duration_sec_mean": 0.005500584561377764, "env_step_timer": 1.5781768585061816e-05, "episode_return_mean": 0.0, "num_module_steps_sampled_lifetime": {"default_policy": 5600}, "episode_return_min": -12.5, "episode_len_max": 20, "num_env_steps_sampled_lifetime": 70400, "time_between_sampling": 1.8645351469896358}, "num_healthy_workers": 1, "actor_manager_num_outstanding_async_reqs": 0, "num_remote_worker_restarts": 0}, "num_env_steps_sampled_lifetime": -7400000.0, "fault_tolerance": {"num_healthy_workers": 0, "num_remote_worker_restarts": 0}, "env_runner_group": {"actor_manager_num_outstanding_async_reqs": 0}, "done": false, "training_iteration": 14, "trial_id": "43778_00000", "date": "2025-08-11_19-20-31", "timestamp": 1754932831, "time_this_iter_s": 2.0285003185272217, "time_total_s": 25.948184490203857, "pid": 14172, "hostname": "Mac", "node_ip": "127.0.0.1", "config": {"exploration_config": {}, "extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "placement_strategy": "PACK", "num_gpus": 0, "_fake_gpus": false, "num_cpus_for_main_process": 2, "eager_tracing": true, "eager_max_retraces": 20, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "torch_compile_learner": false, "torch_compile_learner_what_to_compile": "forward_train", "torch_compile_learner_dynamo_backend": "aot_eager", "torch_compile_learner_dynamo_mode": null, "torch_compile_worker": false, "torch_compile_worker_dynamo_backend": "aot_eager", "torch_compile_worker_dynamo_mode": null, "torch_ddp_kwargs": {}, "torch_skip_nan_gradients": false, "env": "Umbrella", "env_config": {}, "observation_space": null, "action_space": null, "clip_rewards": null, "normalize_actions": true, "clip_actions": false, "_is_atari": null, "disable_env_checking": false, "render_env": false, "action_mask_key": "action_mask", "env_runner_cls": null, "num_env_runners": 0, "create_local_env_runner": true, "num_envs_per_env_runner": 1, "gym_env_vectorize_mode": "SYNC", "num_cpus_per_env_runner": 1, "num_gpus_per_env_runner": 0, "custom_resources_per_env_runner": {}, "validate_env_runners_after_construction": true, "episodes_to_numpy": true, "max_requests_in_flight_per_env_runner": 1, "sample_timeout_s": 60.0, "_env_to_module_connector": null, "add_default_connectors_to_env_to_module_pipeline": true, "_module_to_env_connector": null, "add_default_connectors_to_module_to_env_pipeline": true, "merge_env_runner_states": "training_only", "broadcast_env_runner_states": true, "episode_lookback_horizon": 1, "rollout_fragment_length": "auto", "batch_mode": "complete_episodes", "compress_observations": false, "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "enable_tf1_exec_eagerly": false, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "preprocessor_pref": "deepmind", "observation_filter": "NoFilter", "update_worker_filter_stats": true, "use_worker_filter_stats": true, "sampler_perf_stats_ema_coef": null, "_is_online": true, "num_learners": 0, "num_gpus_per_learner": 0, "num_cpus_per_learner": "auto", "num_aggregator_actors_per_learner": 0, "max_requests_in_flight_per_aggregator_actor": 3, "local_gpu_idx": 0, "max_requests_in_flight_per_learner": 3, "gamma": 1, "lr": 0.0002847858517, "grad_clip": 0.5, "grad_clip_by": "global_norm", "_train_batch_size_per_learner": 5000, "train_batch_size": 4000, "num_epochs": 1, "minibatch_size": 1000, "shuffle_batch_per_epoch": true, "model": {"fcnet_hiddens": [256, 256], "fcnet_activation": "tanh", "fcnet_weights_initializer": null, "fcnet_weights_initializer_config": null, "fcnet_bias_initializer": null, "fcnet_bias_initializer_config": null, "conv_filters": null, "conv_activation": "relu", "conv_kernel_initializer": null, "conv_kernel_initializer_config": null, "conv_bias_initializer": null, "conv_bias_initializer_config": null, "conv_transpose_kernel_initializer": null, "conv_transpose_kernel_initializer_config": null, "conv_transpose_bias_initializer": null, "conv_transpose_bias_initializer_config": null, "post_fcnet_hiddens": [], "post_fcnet_activation": "relu", "post_fcnet_weights_initializer": null, "post_fcnet_weights_initializer_config": null, "post_fcnet_bias_initializer": null, "post_fcnet_bias_initializer_config": null, "free_log_std": false, "log_std_clip_param": 20.0, "no_final_linear": false, "vf_share_layers": false, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "lstm_weights_initializer": null, "lstm_weights_initializer_config": null, "lstm_bias_initializer": null, "lstm_bias_initializer_config": null, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "attention_use_n_prev_actions": 0, "attention_use_n_prev_rewards": 0, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": null, "custom_model_config": {}, "custom_action_dist": null, "custom_preprocessor": null, "encoder_latent_dim": null, "always_check_shapes": false, "lstm_use_prev_action_reward": -1, "_use_default_native_models": -1, "_disable_preprocessor_api": false, "_disable_action_flattening": false}, "_learner_connector": null, "add_default_connectors_to_learner_pipeline": true, "learner_config_dict": {}, "optimizer": {}, "_learner_class": null, "callbacks_on_algorithm_init": null, "callbacks_on_env_runners_recreated": null, "callbacks_on_offline_eval_runners_recreated": null, "callbacks_on_checkpoint_loaded": null, "callbacks_on_environment_created": null, "callbacks_on_episode_created": null, "callbacks_on_episode_start": null, "callbacks_on_episode_step": null, "callbacks_on_episode_end": null, "callbacks_on_evaluate_start": null, "callbacks_on_evaluate_end": null, "callbacks_on_evaluate_offline_start": null, "callbacks_on_evaluate_offline_end": null, "callbacks_on_sample_end": null, "callbacks_on_train_result": null, "explore": true, "enable_rl_module_and_learner": true, "enable_env_runner_and_connector_v2": true, "_prior_exploration_config": {"type": "StochasticSampling"}, "count_steps_by": "env_steps", "policy_map_capacity": 100, "policy_mapping_fn": "<function AlgorithmConfig.DEFAULT_POLICY_MAPPING_FN at 0x3888f18a0>", "policies_to_train": null, "policy_states_are_swappable": false, "observation_fn": null, "offline_data_class": null, "input_read_method": "read_parquet", "input_read_method_kwargs": {}, "input_read_schema": {}, "input_read_episodes": false, "input_read_sample_batches": false, "input_read_batch_size": null, "input_filesystem": null, "input_filesystem_kwargs": {}, "input_compress_columns": ["obs", "new_obs"], "input_spaces_jsonable": true, "materialize_data": false, "materialize_mapped_data": true, "map_batches_kwargs": {}, "iter_batches_kwargs": {}, "ignore_final_observation": false, "prelearner_class": null, "prelearner_buffer_class": null, "prelearner_buffer_kwargs": {}, "prelearner_module_synch_period": 10, "dataset_num_iters_per_learner": null, "input_config": {}, "actions_in_input_normalized": false, "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_config": {}, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "output_max_rows_per_file": null, "output_write_remaining_data": false, "output_write_method": "write_parquet", "output_write_method_kwargs": {}, "output_filesystem": null, "output_filesystem_kwargs": {}, "output_write_episodes": true, "offline_sampling": false, "evaluation_interval": 1, "evaluation_duration": 20, "evaluation_duration_unit": "episodes", "evaluation_sample_timeout_s": 120.0, "evaluation_auto_duration_min_env_steps_per_sample": 100, "evaluation_auto_duration_max_env_steps_per_sample": 2000, "evaluation_parallel_to_training": false, "evaluation_force_reset_envs_before_iteration": true, "evaluation_config": null, "off_policy_estimation_methods": {}, "ope_split_batch_by_episode": true, "evaluation_num_env_runners": 1, "in_evaluation": false, "sync_filters_on_rollout_workers_timeout_s": 10.0, "offline_evaluation_interval": null, "num_offline_eval_runners": 0, "offline_loss_for_module_fn": null, "offline_evaluation_duration": 1, "offline_evaluation_parallel_to_training": false, "offline_evaluation_timeout_s": 120.0, "num_cpus_per_offline_eval_runner": 1, "num_gpus_per_offline_eval_runner": 0, "custom_resources_per_offline_eval_runner": {}, "restart_failed_offline_eval_runners": true, "ignore_offline_eval_runner_failures": false, "max_num_offline_eval_runner_restarts": 1000, "offline_eval_runner_restore_timeout_s": 1800.0, "max_requests_in_flight_per_offline_eval_runner": 1, "validate_offline_eval_runners_after_construction": true, "offline_eval_runner_health_probe_timeout_s": 30.0, "offline_eval_rl_module_inference_only": false, "broadcast_offline_eval_runner_states": false, "offline_eval_batch_size_per_runner": 256, "dataset_num_iters_per_eval_runner": 1, "keep_per_episode_custom_metrics": false, "metrics_episode_collection_timeout_s": 60.0, "metrics_num_episodes_for_smoothing": 100, "min_time_s_per_iteration": null, "min_train_timesteps_per_iteration": 0, "min_sample_timesteps_per_iteration": 0, "log_gradients": true, "export_native_model_files": false, "checkpoint_trainable_policies_only": false, "logger_creator": null, "logger_config": null, "log_level": "WARN", "log_sys_usage": true, "fake_sampler": false, "seed": 1, "restart_failed_env_runners": true, "ignore_env_runner_failures": false, "max_num_env_runner_restarts": 1000, "delay_between_env_runner_restarts_s": 60.0, "restart_failed_sub_environments": false, "num_consecutive_env_runner_failures_tolerance": 100, "env_runner_health_probe_timeout_s": 30.0, "env_runner_restore_timeout_s": 1800.0, "_model_config": {}, "_rl_module_spec": "RLModuleSpec(module_class=None, observation_space=None, action_space=None, inference_only=False, learner_only=False, model_config=DefaultModelConfig(fcnet_hiddens=[60, 90], fcnet_activation='tanh', fcnet_kernel_initializer=None, fcnet_kernel_initializer_kwargs=None, fcnet_bias_initializer=None, fcnet_bias_initializer_kwargs=None, conv_filters=None, conv_activation='relu', conv_kernel_initializer=None, conv_kernel_initializer_kwargs=None, conv_bias_initializer=None, conv_bias_initializer_kwargs=None, head_fcnet_hiddens=[], head_fcnet_activation='relu', head_fcnet_kernel_initializer=None, head_fcnet_kernel_initializer_kwargs=None, head_fcnet_bias_initializer=None, head_fcnet_bias_initializer_kwargs=None, free_log_std=False, log_std_clip_param=20.0, vf_share_layers=True, use_lstm=False, max_seq_len=20, lstm_cell_size=256, lstm_use_prev_action=False, lstm_use_prev_reward=False, lstm_kernel_initializer=None, lstm_kernel_initializer_kwargs=None, lstm_bias_initializer=None, lstm_bias_initializer_kwargs=None), catalog_class=None, load_state_path=None, model_config_dict=None)", "algorithm_config_overrides_per_module": {}, "_per_module_overrides": {}, "_validate_config": true, "_use_msgpack_checkpoints": false, "_torch_grad_scaler_class": null, "_torch_lr_scheduler_classes": null, "_tf_policy_handles_more_than_one_loss": false, "_disable_preprocessor_api": false, "_disable_action_flattening": false, "_disable_initialize_loss_from_dummy_batch": false, "_dont_auto_sync_env_runner_states": false, "env_task_fn": -1, "enable_connectors": -1, "simple_optimizer": false, "policy_map_cache": -1, "worker_cls": -1, "synchronize_filters": -1, "enable_async_evaluation": -1, "custom_async_evaluation_function": -1, "_enable_rl_module_api": -1, "auto_wrap_old_gym_envs": -1, "always_attach_evaluation_results": -1, "replay_sequence_length": null, "_disable_execution_plan_api": -1, "use_critic": true, "use_gae": true, "use_kl_loss": true, "kl_coeff": 0.7464963036515, "kl_target": 0.0270990929592, "vf_loss_coeff": 0.6688075857018, "entropy_coeff": 0.0090570820258, "clip_param": 0.1221781641624, "vf_clip_param": 0.1027808522125, "entropy_coeff_schedule": null, "lr_schedule": null, "sgd_minibatch_size": -1, "vf_share_layers": -1, "__stdout_file__": null, "__stderr_file__": null, "lambda": 0.9099046732075, "input": "sampler", "policies": {"default_policy": [null, null, null, null]}, "callbacks": "<class 'ray.rllib.callbacks.callbacks.RLlibCallback'>", "create_env_on_driver": false, "custom_eval_function": null, "framework": "torch"}, "time_since_restore": 25.948184490203857, "iterations_since_restore": 14, "perf": {"cpu_util_percent": 58.76666666666667, "ram_util_percent": 83.2}}
{"timers": {"training_iteration": 1.8999377761790537, "restore_env_runners": 1.1867990266582707e-05, "training_step": 1.899775771620084, "env_runner_sampling_timer": 1.7736058978047955, "learner_update_timer": 0.122720063680277, "synch_weights": 0.0007972884621107734, "restore_eval_env_runners": 9.349620268142295e-06, "evaluation_iteration": 0.12867747804228788, "synch_eval_env_connectors": 0.0001217827866560826, "synch_env_connectors": 5.603252911687334e-06}, "env_runners": {"env_to_module_connector": {"timers": {"connectors": {"add_observations_from_episodes_to_batch": 3.3069478287412545e-06, "batch_individual_items": 7.085979380801416e-06, "numpy_to_tensor": 9.75823324911839e-06, "add_states_from_episodes_to_batch": 1.8726867163911801e-06, "add_time_dim_to_batch_and_zero_pad": 2.5569050998202388e-06}}, "connector_pipeline_timer": 4.7370995522176375e-05}, "episode_len_mean": 20.0, "sample": 0.005431779608883791, "module_to_env_connector": {"timers": {"connectors": {"get_actions": 4.428567234283623e-05, "un_batch_to_individual_items": 5.8456938245526825e-06, "normalize_and_clip_actions": 1.0277838816392148e-05, "listify_data_for_vector_env": 1.2103707432902491e-05, "remove_single_ts_time_rank_from_batch": 6.349311314297563e-07, "tensor_to_numpy": 1.459128131556712e-05}}, "connector_pipeline_timer": 0.00011491988965432528}, "num_module_steps_sampled": {"default_policy": 5000.0}, "num_agent_steps_sampled_lifetime": {"default_agent": -8017500.0}, "num_env_steps_sampled": 5000.0, "episode_duration_sec_mean": 0.005019339361693709, "num_agent_steps_sampled": {"default_agent": 5000.0}, "env_to_module_sum_episodes_length_out": 10.36823839457432, "num_episodes": 250.0, "time_between_sampling": 0.0023709324609046275, "env_step_timer": 1.5276788230520572e-05, "agent_episode_returns_mean": {"default_agent": 6.46}, "episode_return_mean": 6.46, "num_module_steps_sampled_lifetime": {"default_policy": -8017500.0}, "env_to_module_sum_episodes_length_in": 10.36823839457432, "episode_return_max": 9.5, "num_episodes_lifetime": -400875.0, "weights_seq_no": 14.0, "module_episode_returns_mean": {"default_policy": 6.46}, "episode_return_min": -10.5, "episode_len_min": 20, "episode_len_max": 20, "env_reset_timer": 4.4732573978377974e-05, "num_env_steps_sampled_lifetime": -8017500.0, "rlmodule_inference_timer": 3.103320173120494e-05, "num_env_steps_sampled_lifetime_throughput": 3418.2288746463737}, "learners": {"__all_modules__": {"num_module_steps_trained_lifetime": 90000, "learner_connector_sum_episodes_length_in": 5000.0, "learner_connector": {"timers": {"connectors": {"add_observations_from_episodes_to_batch": 0.0008423324208481585, "batch_individual_items": 0.03766194797326849, "general_advantage_estimation": 0.007892411131415228, "add_one_ts_to_episodes_and_truncate": 0.009215206675381971, "add_time_dim_to_batch_and_zero_pad": 1.5693560484115524e-05, "add_states_from_episodes_to_batch": 4.0296872009203994e-06, "add_columns_from_episodes_to_train_batch": 0.03609814872263853, "numpy_to_tensor": 7.339990892068829e-05}}, "connector_pipeline_timer": 0.09196633990857557}, "num_env_steps_trained": 31500, "num_env_steps_trained_lifetime": 472500, "num_non_trainable_parameters": 0, "learner_connector_sum_episodes_length_out": 5250.0, "num_module_steps_trained": 6000, "num_trainable_parameters": 6003, "num_env_steps_trained_lifetime_throughput": 1746504.1171734547, "num_module_steps_trained_throughput": 333521.7630576571, "num_module_steps_trained_lifetime_throughput": 333154.03254632436}, "default_policy": {"vf_loss": 0.10278083384037018, "curr_entropy_coeff": 0.0090570820258, "mean_kl_loss": 2.6270066882716492e-05, "weights_seq_no": 15.0, "module_train_batch_size_mean": 1000.0, "vf_explained_var": -0.022460103034973145, "gradients_default_optimizer_global_norm": 0.07249045372009277, "diff_num_grad_updates_vs_sampler_policy": 1.0, "default_optimizer_learning_rate": 0.0002847858517, "curr_kl_coeff": 2.2781259758630767e-05, "num_module_steps_trained": 6000, "num_trainable_parameters": 6003, "total_loss": 0.20799577236175537, "num_module_steps_trained_lifetime": 90000, "vf_loss_unclipped": 27.49070930480957, "policy_loss": 0.14473199844360352, "entropy": 0.6047009825706482, "num_module_steps_trained_lifetime_throughput": 333622.55264860217}}, "num_training_step_calls_per_iteration": 1, "evaluation": {"env_runners": {"sample": 0.12114707768660911, "num_module_steps_sampled": {"default_policy": 400}, "env_to_module_connector": {"timers": {"connectors": {"add_observations_from_episodes_to_batch": 5.614558697756502e-06, "numpy_to_tensor": 1.5034542965042785e-05, "batch_individual_items": 9.872282484265214e-06, "add_time_dim_to_batch_and_zero_pad": 3.853932364631487e-06, "add_states_from_episodes_to_batch": 1.9333384575187156e-06}}, "connector_pipeline_timer": 6.795319205270629e-05}, "num_agent_steps_sampled_lifetime": {"default_agent": 6000}, "module_to_env_connector": {"timers": {"connectors": {"tensor_to_numpy": 2.2417826815632543e-05, "get_actions": 7.254482124041512e-05, "listify_data_for_vector_env": 1.6830630339115773e-05, "normalize_and_clip_actions": 1.35006273377311e-05, "remove_single_ts_time_rank_from_batch": 7.356479268142492e-07, "un_batch_to_individual_items": 7.90794040699055e-06}}, "connector_pipeline_timer": 0.0001745694829691274}, "agent_episode_returns_mean": {"default_agent": 0.0}, "num_env_steps_sampled": 400, "env_to_module_sum_episodes_length_out": 10.368238394574323, "num_episodes": 20, "num_agent_steps_sampled": {"default_agent": 400}, "num_episodes_lifetime": 300, "weights_seq_no": 15.0, "env_reset_timer": 0.0001954880926717107, "module_episode_returns_mean": {"default_policy": 0.0}, "rlmodule_inference_timer": 4.6732224278642024e-05, "env_to_module_sum_episodes_length_in": 10.368238394574323, "episode_return_max": 12.5, "episode_len_min": 20, "episode_len_mean": 20.0, "episode_duration_sec_mean": 0.006019712869310752, "env_step_timer": 2.3518632688651437e-05, "episode_return_mean": 0.0, "num_module_steps_sampled_lifetime": {"default_policy": 6000}, "episode_return_min": -12.5, "episode_len_max": 20, "num_env_steps_sampled_lifetime": 75400, "time_between_sampling": 1.8673983338492477}, "num_healthy_workers": 1, "actor_manager_num_outstanding_async_reqs": 0, "num_remote_worker_restarts": 0}, "num_env_steps_sampled_lifetime": -8017500.0, "fault_tolerance": {"num_healthy_workers": 0, "num_remote_worker_restarts": 0}, "env_runner_group": {"actor_manager_num_outstanding_async_reqs": 0}, "done": false, "training_iteration": 15, "trial_id": "43778_00000", "date": "2025-08-11_19-20-33", "timestamp": 1754932833, "time_this_iter_s": 2.3042688369750977, "time_total_s": 28.252453327178955, "pid": 14172, "hostname": "Mac", "node_ip": "127.0.0.1", "config": {"exploration_config": {}, "extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "placement_strategy": "PACK", "num_gpus": 0, "_fake_gpus": false, "num_cpus_for_main_process": 2, "eager_tracing": true, "eager_max_retraces": 20, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "torch_compile_learner": false, "torch_compile_learner_what_to_compile": "forward_train", "torch_compile_learner_dynamo_backend": "aot_eager", "torch_compile_learner_dynamo_mode": null, "torch_compile_worker": false, "torch_compile_worker_dynamo_backend": "aot_eager", "torch_compile_worker_dynamo_mode": null, "torch_ddp_kwargs": {}, "torch_skip_nan_gradients": false, "env": "Umbrella", "env_config": {}, "observation_space": null, "action_space": null, "clip_rewards": null, "normalize_actions": true, "clip_actions": false, "_is_atari": null, "disable_env_checking": false, "render_env": false, "action_mask_key": "action_mask", "env_runner_cls": null, "num_env_runners": 0, "create_local_env_runner": true, "num_envs_per_env_runner": 1, "gym_env_vectorize_mode": "SYNC", "num_cpus_per_env_runner": 1, "num_gpus_per_env_runner": 0, "custom_resources_per_env_runner": {}, "validate_env_runners_after_construction": true, "episodes_to_numpy": true, "max_requests_in_flight_per_env_runner": 1, "sample_timeout_s": 60.0, "_env_to_module_connector": null, "add_default_connectors_to_env_to_module_pipeline": true, "_module_to_env_connector": null, "add_default_connectors_to_module_to_env_pipeline": true, "merge_env_runner_states": "training_only", "broadcast_env_runner_states": true, "episode_lookback_horizon": 1, "rollout_fragment_length": "auto", "batch_mode": "complete_episodes", "compress_observations": false, "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "enable_tf1_exec_eagerly": false, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "preprocessor_pref": "deepmind", "observation_filter": "NoFilter", "update_worker_filter_stats": true, "use_worker_filter_stats": true, "sampler_perf_stats_ema_coef": null, "_is_online": true, "num_learners": 0, "num_gpus_per_learner": 0, "num_cpus_per_learner": "auto", "num_aggregator_actors_per_learner": 0, "max_requests_in_flight_per_aggregator_actor": 3, "local_gpu_idx": 0, "max_requests_in_flight_per_learner": 3, "gamma": 1, "lr": 0.0002847858517, "grad_clip": 0.5, "grad_clip_by": "global_norm", "_train_batch_size_per_learner": 5000, "train_batch_size": 4000, "num_epochs": 1, "minibatch_size": 1000, "shuffle_batch_per_epoch": true, "model": {"fcnet_hiddens": [256, 256], "fcnet_activation": "tanh", "fcnet_weights_initializer": null, "fcnet_weights_initializer_config": null, "fcnet_bias_initializer": null, "fcnet_bias_initializer_config": null, "conv_filters": null, "conv_activation": "relu", "conv_kernel_initializer": null, "conv_kernel_initializer_config": null, "conv_bias_initializer": null, "conv_bias_initializer_config": null, "conv_transpose_kernel_initializer": null, "conv_transpose_kernel_initializer_config": null, "conv_transpose_bias_initializer": null, "conv_transpose_bias_initializer_config": null, "post_fcnet_hiddens": [], "post_fcnet_activation": "relu", "post_fcnet_weights_initializer": null, "post_fcnet_weights_initializer_config": null, "post_fcnet_bias_initializer": null, "post_fcnet_bias_initializer_config": null, "free_log_std": false, "log_std_clip_param": 20.0, "no_final_linear": false, "vf_share_layers": false, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "lstm_weights_initializer": null, "lstm_weights_initializer_config": null, "lstm_bias_initializer": null, "lstm_bias_initializer_config": null, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "attention_use_n_prev_actions": 0, "attention_use_n_prev_rewards": 0, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": null, "custom_model_config": {}, "custom_action_dist": null, "custom_preprocessor": null, "encoder_latent_dim": null, "always_check_shapes": false, "lstm_use_prev_action_reward": -1, "_use_default_native_models": -1, "_disable_preprocessor_api": false, "_disable_action_flattening": false}, "_learner_connector": null, "add_default_connectors_to_learner_pipeline": true, "learner_config_dict": {}, "optimizer": {}, "_learner_class": null, "callbacks_on_algorithm_init": null, "callbacks_on_env_runners_recreated": null, "callbacks_on_offline_eval_runners_recreated": null, "callbacks_on_checkpoint_loaded": null, "callbacks_on_environment_created": null, "callbacks_on_episode_created": null, "callbacks_on_episode_start": null, "callbacks_on_episode_step": null, "callbacks_on_episode_end": null, "callbacks_on_evaluate_start": null, "callbacks_on_evaluate_end": null, "callbacks_on_evaluate_offline_start": null, "callbacks_on_evaluate_offline_end": null, "callbacks_on_sample_end": null, "callbacks_on_train_result": null, "explore": true, "enable_rl_module_and_learner": true, "enable_env_runner_and_connector_v2": true, "_prior_exploration_config": {"type": "StochasticSampling"}, "count_steps_by": "env_steps", "policy_map_capacity": 100, "policy_mapping_fn": "<function AlgorithmConfig.DEFAULT_POLICY_MAPPING_FN at 0x3888f18a0>", "policies_to_train": null, "policy_states_are_swappable": false, "observation_fn": null, "offline_data_class": null, "input_read_method": "read_parquet", "input_read_method_kwargs": {}, "input_read_schema": {}, "input_read_episodes": false, "input_read_sample_batches": false, "input_read_batch_size": null, "input_filesystem": null, "input_filesystem_kwargs": {}, "input_compress_columns": ["obs", "new_obs"], "input_spaces_jsonable": true, "materialize_data": false, "materialize_mapped_data": true, "map_batches_kwargs": {}, "iter_batches_kwargs": {}, "ignore_final_observation": false, "prelearner_class": null, "prelearner_buffer_class": null, "prelearner_buffer_kwargs": {}, "prelearner_module_synch_period": 10, "dataset_num_iters_per_learner": null, "input_config": {}, "actions_in_input_normalized": false, "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_config": {}, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "output_max_rows_per_file": null, "output_write_remaining_data": false, "output_write_method": "write_parquet", "output_write_method_kwargs": {}, "output_filesystem": null, "output_filesystem_kwargs": {}, "output_write_episodes": true, "offline_sampling": false, "evaluation_interval": 1, "evaluation_duration": 20, "evaluation_duration_unit": "episodes", "evaluation_sample_timeout_s": 120.0, "evaluation_auto_duration_min_env_steps_per_sample": 100, "evaluation_auto_duration_max_env_steps_per_sample": 2000, "evaluation_parallel_to_training": false, "evaluation_force_reset_envs_before_iteration": true, "evaluation_config": null, "off_policy_estimation_methods": {}, "ope_split_batch_by_episode": true, "evaluation_num_env_runners": 1, "in_evaluation": false, "sync_filters_on_rollout_workers_timeout_s": 10.0, "offline_evaluation_interval": null, "num_offline_eval_runners": 0, "offline_loss_for_module_fn": null, "offline_evaluation_duration": 1, "offline_evaluation_parallel_to_training": false, "offline_evaluation_timeout_s": 120.0, "num_cpus_per_offline_eval_runner": 1, "num_gpus_per_offline_eval_runner": 0, "custom_resources_per_offline_eval_runner": {}, "restart_failed_offline_eval_runners": true, "ignore_offline_eval_runner_failures": false, "max_num_offline_eval_runner_restarts": 1000, "offline_eval_runner_restore_timeout_s": 1800.0, "max_requests_in_flight_per_offline_eval_runner": 1, "validate_offline_eval_runners_after_construction": true, "offline_eval_runner_health_probe_timeout_s": 30.0, "offline_eval_rl_module_inference_only": false, "broadcast_offline_eval_runner_states": false, "offline_eval_batch_size_per_runner": 256, "dataset_num_iters_per_eval_runner": 1, "keep_per_episode_custom_metrics": false, "metrics_episode_collection_timeout_s": 60.0, "metrics_num_episodes_for_smoothing": 100, "min_time_s_per_iteration": null, "min_train_timesteps_per_iteration": 0, "min_sample_timesteps_per_iteration": 0, "log_gradients": true, "export_native_model_files": false, "checkpoint_trainable_policies_only": false, "logger_creator": null, "logger_config": null, "log_level": "WARN", "log_sys_usage": true, "fake_sampler": false, "seed": 1, "restart_failed_env_runners": true, "ignore_env_runner_failures": false, "max_num_env_runner_restarts": 1000, "delay_between_env_runner_restarts_s": 60.0, "restart_failed_sub_environments": false, "num_consecutive_env_runner_failures_tolerance": 100, "env_runner_health_probe_timeout_s": 30.0, "env_runner_restore_timeout_s": 1800.0, "_model_config": {}, "_rl_module_spec": "RLModuleSpec(module_class=None, observation_space=None, action_space=None, inference_only=False, learner_only=False, model_config=DefaultModelConfig(fcnet_hiddens=[60, 90], fcnet_activation='tanh', fcnet_kernel_initializer=None, fcnet_kernel_initializer_kwargs=None, fcnet_bias_initializer=None, fcnet_bias_initializer_kwargs=None, conv_filters=None, conv_activation='relu', conv_kernel_initializer=None, conv_kernel_initializer_kwargs=None, conv_bias_initializer=None, conv_bias_initializer_kwargs=None, head_fcnet_hiddens=[], head_fcnet_activation='relu', head_fcnet_kernel_initializer=None, head_fcnet_kernel_initializer_kwargs=None, head_fcnet_bias_initializer=None, head_fcnet_bias_initializer_kwargs=None, free_log_std=False, log_std_clip_param=20.0, vf_share_layers=True, use_lstm=False, max_seq_len=20, lstm_cell_size=256, lstm_use_prev_action=False, lstm_use_prev_reward=False, lstm_kernel_initializer=None, lstm_kernel_initializer_kwargs=None, lstm_bias_initializer=None, lstm_bias_initializer_kwargs=None), catalog_class=None, load_state_path=None, model_config_dict=None)", "algorithm_config_overrides_per_module": {}, "_per_module_overrides": {}, "_validate_config": true, "_use_msgpack_checkpoints": false, "_torch_grad_scaler_class": null, "_torch_lr_scheduler_classes": null, "_tf_policy_handles_more_than_one_loss": false, "_disable_preprocessor_api": false, "_disable_action_flattening": false, "_disable_initialize_loss_from_dummy_batch": false, "_dont_auto_sync_env_runner_states": false, "env_task_fn": -1, "enable_connectors": -1, "simple_optimizer": false, "policy_map_cache": -1, "worker_cls": -1, "synchronize_filters": -1, "enable_async_evaluation": -1, "custom_async_evaluation_function": -1, "_enable_rl_module_api": -1, "auto_wrap_old_gym_envs": -1, "always_attach_evaluation_results": -1, "replay_sequence_length": null, "_disable_execution_plan_api": -1, "use_critic": true, "use_gae": true, "use_kl_loss": true, "kl_coeff": 0.7464963036515, "kl_target": 0.0270990929592, "vf_loss_coeff": 0.6688075857018, "entropy_coeff": 0.0090570820258, "clip_param": 0.1221781641624, "vf_clip_param": 0.1027808522125, "entropy_coeff_schedule": null, "lr_schedule": null, "sgd_minibatch_size": -1, "vf_share_layers": -1, "__stdout_file__": null, "__stderr_file__": null, "lambda": 0.9099046732075, "input": "sampler", "policies": {"default_policy": [null, null, null, null]}, "callbacks": "<class 'ray.rllib.callbacks.callbacks.RLlibCallback'>", "create_env_on_driver": false, "custom_eval_function": null, "framework": "torch"}, "time_since_restore": 28.252453327178955, "iterations_since_restore": 15, "perf": {"cpu_util_percent": 51.56666666666666, "ram_util_percent": 83.03333333333335}}
{"timers": {"training_iteration": 1.9005424242473123, "restore_env_runners": 1.1838479843823439e-05, "training_step": 1.9003798901541187, "env_runner_sampling_timer": 1.7745031038261185, "learner_update_timer": 0.12242913971401957, "synch_weights": 0.0007953451670569991, "restore_eval_env_runners": 9.4307039745322e-06, "evaluation_iteration": 0.12915440951221405, "synch_eval_env_connectors": 0.00012327537872935268, "synch_env_connectors": 5.594299902870492e-06}, "env_runners": {"env_to_module_connector": {"timers": {"connectors": {"add_observations_from_episodes_to_batch": 3.712177164577035e-06, "batch_individual_items": 8.23486310565903e-06, "numpy_to_tensor": 1.1556017812718378e-05, "add_states_from_episodes_to_batch": 2.0672152345790295e-06, "add_time_dim_to_batch_and_zero_pad": 2.964025103300723e-06}}, "connector_pipeline_timer": 5.406860682037999e-05}, "episode_len_mean": 20.0, "sample": 0.006398438933030315, "module_to_env_connector": {"timers": {"connectors": {"get_actions": 5.756766291963921e-05, "un_batch_to_individual_items": 7.272795456630747e-06, "normalize_and_clip_actions": 1.163717919441331e-05, "listify_data_for_vector_env": 1.4941201650045362e-05, "remove_single_ts_time_rank_from_batch": 7.270787630451905e-07, "tensor_to_numpy": 1.7099250712026518e-05}}, "connector_pipeline_timer": 0.00014155604871362082}, "num_module_steps_sampled": {"default_policy": 5000.0}, "num_agent_steps_sampled_lifetime": {"default_agent": -8635000.0}, "num_env_steps_sampled": 5000.0, "episode_duration_sec_mean": 0.0060872004656121114, "num_agent_steps_sampled": {"default_agent": 5000.0}, "env_to_module_sum_episodes_length_out": 10.36823839457432, "num_episodes": 250.0, "time_between_sampling": 0.003998059695122472, "env_step_timer": 1.8285154453334998e-05, "agent_episode_returns_mean": {"default_agent": 6.7799999999999985}, "episode_return_mean": 6.7799999999999985, "num_module_steps_sampled_lifetime": {"default_policy": -8635000.0}, "env_to_module_sum_episodes_length_in": 10.36823839457432, "episode_return_max": 9.5, "num_episodes_lifetime": -431750.0, "weights_seq_no": 15.0, "module_episode_returns_mean": {"default_policy": 6.7799999999999985}, "episode_return_min": -10.5, "episode_len_min": 20, "episode_len_max": 20, "env_reset_timer": 5.9149129120449906e-05, "num_env_steps_sampled_lifetime": -8635000.0, "rlmodule_inference_timer": 4.0248159883957465e-05, "num_env_steps_sampled_lifetime_throughput": 3102.1944986549493}, "learners": {"__all_modules__": {"num_module_steps_trained_lifetime": 96000, "learner_connector_sum_episodes_length_in": 5000.0, "learner_connector": {"timers": {"connectors": {"add_observations_from_episodes_to_batch": 0.0008420665964727094, "batch_individual_items": 0.03758790224333136, "general_advantage_estimation": 0.007880674940313822, "add_one_ts_to_episodes_and_truncate": 0.009207821268048135, "add_time_dim_to_batch_and_zero_pad": 1.5633704780299067e-05, "add_states_from_episodes_to_batch": 4.019390557345996e-06, "add_columns_from_episodes_to_train_batch": 0.036084415155411206, "numpy_to_tensor": 7.319632946986182e-05}}, "connector_pipeline_timer": 0.09185809901048202}, "num_env_steps_trained": 31500, "num_env_steps_trained_lifetime": 504000, "num_non_trainable_parameters": 0, "learner_connector_sum_episodes_length_out": 5250.0, "num_module_steps_trained": 6000, "num_trainable_parameters": 6003, "num_env_steps_trained_lifetime_throughput": 1751538.927827805, "num_module_steps_trained_throughput": 334448.9631857534, "num_module_steps_trained_lifetime_throughput": 334090.7532750217}, "default_policy": {"vf_loss": 0.10278083384037018, "curr_entropy_coeff": 0.0090570820258, "mean_kl_loss": 7.574491610284895e-05, "weights_seq_no": 16.0, "module_train_batch_size_mean": 1000.0, "vf_explained_var": -0.022913694381713867, "gradients_default_optimizer_global_norm": 0.0359240286052227, "diff_num_grad_updates_vs_sampler_policy": 1.0, "default_optimizer_learning_rate": 0.0002847858517, "curr_kl_coeff": 1.1390629879315384e-05, "num_module_steps_trained": 6000, "num_trainable_parameters": 6003, "total_loss": 0.15125392377376556, "num_module_steps_trained_lifetime": 96000, "vf_loss_unclipped": 27.252580642700195, "policy_loss": 0.08797918260097504, "entropy": 0.6034906506538391, "num_module_steps_trained_lifetime_throughput": 334517.0392680826}}, "num_training_step_calls_per_iteration": 1, "evaluation": {"env_runners": {"sample": 0.12097541065962471, "num_module_steps_sampled": {"default_policy": 400}, "env_to_module_connector": {"timers": {"connectors": {"add_observations_from_episodes_to_batch": 2.9660942196342987e-06, "numpy_to_tensor": 8.938455756017058e-06, "batch_individual_items": 6.3011540667198035e-06, "add_time_dim_to_batch_and_zero_pad": 2.267514996075543e-06, "add_states_from_episodes_to_batch": 1.5893657712429875e-06}}, "connector_pipeline_timer": 4.429788247921298e-05}, "num_agent_steps_sampled_lifetime": {"default_agent": 6400}, "module_to_env_connector": {"timers": {"connectors": {"tensor_to_numpy": 1.780245761573848e-05, "get_actions": 3.887969976467604e-05, "listify_data_for_vector_env": 1.1316549201986494e-05, "normalize_and_clip_actions": 9.611038972977957e-06, "remove_single_ts_time_rank_from_batch": 5.727473762292955e-07, "un_batch_to_individual_items": 5.4880596108618914e-06}}, "connector_pipeline_timer": 0.00011046443340348596}, "agent_episode_returns_mean": {"default_agent": 0.2}, "num_env_steps_sampled": 400, "env_to_module_sum_episodes_length_out": 10.368238394574323, "num_episodes": 20, "num_agent_steps_sampled": {"default_agent": 400}, "num_episodes_lifetime": 320, "weights_seq_no": 16.0, "env_reset_timer": 0.00019480487218466368, "module_episode_returns_mean": {"default_policy": 0.2}, "rlmodule_inference_timer": 2.8124849135579034e-05, "env_to_module_sum_episodes_length_in": 10.368238394574323, "episode_return_max": 12.5, "episode_len_min": 20, "episode_len_mean": 20.0, "episode_duration_sec_mean": 0.006041384994750843, "env_step_timer": 1.4662038017760699e-05, "episode_return_mean": 0.2, "num_module_steps_sampled_lifetime": {"default_policy": 6400}, "episode_return_min": -12.5, "episode_len_max": 20, "num_env_steps_sampled_lifetime": 80400, "time_between_sampling": 1.8686878767615496}, "num_healthy_workers": 1, "actor_manager_num_outstanding_async_reqs": 0, "num_remote_worker_restarts": 0}, "num_env_steps_sampled_lifetime": -8635000.0, "fault_tolerance": {"num_healthy_workers": 0, "num_remote_worker_restarts": 0}, "env_runner_group": {"actor_manager_num_outstanding_async_reqs": 0}, "done": false, "training_iteration": 16, "trial_id": "43778_00000", "date": "2025-08-11_19-20-35", "timestamp": 1754932835, "time_this_iter_s": 2.072114944458008, "time_total_s": 30.324568271636963, "pid": 14172, "hostname": "Mac", "node_ip": "127.0.0.1", "config": {"exploration_config": {}, "extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "placement_strategy": "PACK", "num_gpus": 0, "_fake_gpus": false, "num_cpus_for_main_process": 2, "eager_tracing": true, "eager_max_retraces": 20, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "torch_compile_learner": false, "torch_compile_learner_what_to_compile": "forward_train", "torch_compile_learner_dynamo_backend": "aot_eager", "torch_compile_learner_dynamo_mode": null, "torch_compile_worker": false, "torch_compile_worker_dynamo_backend": "aot_eager", "torch_compile_worker_dynamo_mode": null, "torch_ddp_kwargs": {}, "torch_skip_nan_gradients": false, "env": "Umbrella", "env_config": {}, "observation_space": null, "action_space": null, "clip_rewards": null, "normalize_actions": true, "clip_actions": false, "_is_atari": null, "disable_env_checking": false, "render_env": false, "action_mask_key": "action_mask", "env_runner_cls": null, "num_env_runners": 0, "create_local_env_runner": true, "num_envs_per_env_runner": 1, "gym_env_vectorize_mode": "SYNC", "num_cpus_per_env_runner": 1, "num_gpus_per_env_runner": 0, "custom_resources_per_env_runner": {}, "validate_env_runners_after_construction": true, "episodes_to_numpy": true, "max_requests_in_flight_per_env_runner": 1, "sample_timeout_s": 60.0, "_env_to_module_connector": null, "add_default_connectors_to_env_to_module_pipeline": true, "_module_to_env_connector": null, "add_default_connectors_to_module_to_env_pipeline": true, "merge_env_runner_states": "training_only", "broadcast_env_runner_states": true, "episode_lookback_horizon": 1, "rollout_fragment_length": "auto", "batch_mode": "complete_episodes", "compress_observations": false, "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "enable_tf1_exec_eagerly": false, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "preprocessor_pref": "deepmind", "observation_filter": "NoFilter", "update_worker_filter_stats": true, "use_worker_filter_stats": true, "sampler_perf_stats_ema_coef": null, "_is_online": true, "num_learners": 0, "num_gpus_per_learner": 0, "num_cpus_per_learner": "auto", "num_aggregator_actors_per_learner": 0, "max_requests_in_flight_per_aggregator_actor": 3, "local_gpu_idx": 0, "max_requests_in_flight_per_learner": 3, "gamma": 1, "lr": 0.0002847858517, "grad_clip": 0.5, "grad_clip_by": "global_norm", "_train_batch_size_per_learner": 5000, "train_batch_size": 4000, "num_epochs": 1, "minibatch_size": 1000, "shuffle_batch_per_epoch": true, "model": {"fcnet_hiddens": [256, 256], "fcnet_activation": "tanh", "fcnet_weights_initializer": null, "fcnet_weights_initializer_config": null, "fcnet_bias_initializer": null, "fcnet_bias_initializer_config": null, "conv_filters": null, "conv_activation": "relu", "conv_kernel_initializer": null, "conv_kernel_initializer_config": null, "conv_bias_initializer": null, "conv_bias_initializer_config": null, "conv_transpose_kernel_initializer": null, "conv_transpose_kernel_initializer_config": null, "conv_transpose_bias_initializer": null, "conv_transpose_bias_initializer_config": null, "post_fcnet_hiddens": [], "post_fcnet_activation": "relu", "post_fcnet_weights_initializer": null, "post_fcnet_weights_initializer_config": null, "post_fcnet_bias_initializer": null, "post_fcnet_bias_initializer_config": null, "free_log_std": false, "log_std_clip_param": 20.0, "no_final_linear": false, "vf_share_layers": false, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "lstm_weights_initializer": null, "lstm_weights_initializer_config": null, "lstm_bias_initializer": null, "lstm_bias_initializer_config": null, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "attention_use_n_prev_actions": 0, "attention_use_n_prev_rewards": 0, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": null, "custom_model_config": {}, "custom_action_dist": null, "custom_preprocessor": null, "encoder_latent_dim": null, "always_check_shapes": false, "lstm_use_prev_action_reward": -1, "_use_default_native_models": -1, "_disable_preprocessor_api": false, "_disable_action_flattening": false}, "_learner_connector": null, "add_default_connectors_to_learner_pipeline": true, "learner_config_dict": {}, "optimizer": {}, "_learner_class": null, "callbacks_on_algorithm_init": null, "callbacks_on_env_runners_recreated": null, "callbacks_on_offline_eval_runners_recreated": null, "callbacks_on_checkpoint_loaded": null, "callbacks_on_environment_created": null, "callbacks_on_episode_created": null, "callbacks_on_episode_start": null, "callbacks_on_episode_step": null, "callbacks_on_episode_end": null, "callbacks_on_evaluate_start": null, "callbacks_on_evaluate_end": null, "callbacks_on_evaluate_offline_start": null, "callbacks_on_evaluate_offline_end": null, "callbacks_on_sample_end": null, "callbacks_on_train_result": null, "explore": true, "enable_rl_module_and_learner": true, "enable_env_runner_and_connector_v2": true, "_prior_exploration_config": {"type": "StochasticSampling"}, "count_steps_by": "env_steps", "policy_map_capacity": 100, "policy_mapping_fn": "<function AlgorithmConfig.DEFAULT_POLICY_MAPPING_FN at 0x3888f18a0>", "policies_to_train": null, "policy_states_are_swappable": false, "observation_fn": null, "offline_data_class": null, "input_read_method": "read_parquet", "input_read_method_kwargs": {}, "input_read_schema": {}, "input_read_episodes": false, "input_read_sample_batches": false, "input_read_batch_size": null, "input_filesystem": null, "input_filesystem_kwargs": {}, "input_compress_columns": ["obs", "new_obs"], "input_spaces_jsonable": true, "materialize_data": false, "materialize_mapped_data": true, "map_batches_kwargs": {}, "iter_batches_kwargs": {}, "ignore_final_observation": false, "prelearner_class": null, "prelearner_buffer_class": null, "prelearner_buffer_kwargs": {}, "prelearner_module_synch_period": 10, "dataset_num_iters_per_learner": null, "input_config": {}, "actions_in_input_normalized": false, "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_config": {}, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "output_max_rows_per_file": null, "output_write_remaining_data": false, "output_write_method": "write_parquet", "output_write_method_kwargs": {}, "output_filesystem": null, "output_filesystem_kwargs": {}, "output_write_episodes": true, "offline_sampling": false, "evaluation_interval": 1, "evaluation_duration": 20, "evaluation_duration_unit": "episodes", "evaluation_sample_timeout_s": 120.0, "evaluation_auto_duration_min_env_steps_per_sample": 100, "evaluation_auto_duration_max_env_steps_per_sample": 2000, "evaluation_parallel_to_training": false, "evaluation_force_reset_envs_before_iteration": true, "evaluation_config": null, "off_policy_estimation_methods": {}, "ope_split_batch_by_episode": true, "evaluation_num_env_runners": 1, "in_evaluation": false, "sync_filters_on_rollout_workers_timeout_s": 10.0, "offline_evaluation_interval": null, "num_offline_eval_runners": 0, "offline_loss_for_module_fn": null, "offline_evaluation_duration": 1, "offline_evaluation_parallel_to_training": false, "offline_evaluation_timeout_s": 120.0, "num_cpus_per_offline_eval_runner": 1, "num_gpus_per_offline_eval_runner": 0, "custom_resources_per_offline_eval_runner": {}, "restart_failed_offline_eval_runners": true, "ignore_offline_eval_runner_failures": false, "max_num_offline_eval_runner_restarts": 1000, "offline_eval_runner_restore_timeout_s": 1800.0, "max_requests_in_flight_per_offline_eval_runner": 1, "validate_offline_eval_runners_after_construction": true, "offline_eval_runner_health_probe_timeout_s": 30.0, "offline_eval_rl_module_inference_only": false, "broadcast_offline_eval_runner_states": false, "offline_eval_batch_size_per_runner": 256, "dataset_num_iters_per_eval_runner": 1, "keep_per_episode_custom_metrics": false, "metrics_episode_collection_timeout_s": 60.0, "metrics_num_episodes_for_smoothing": 100, "min_time_s_per_iteration": null, "min_train_timesteps_per_iteration": 0, "min_sample_timesteps_per_iteration": 0, "log_gradients": true, "export_native_model_files": false, "checkpoint_trainable_policies_only": false, "logger_creator": null, "logger_config": null, "log_level": "WARN", "log_sys_usage": true, "fake_sampler": false, "seed": 1, "restart_failed_env_runners": true, "ignore_env_runner_failures": false, "max_num_env_runner_restarts": 1000, "delay_between_env_runner_restarts_s": 60.0, "restart_failed_sub_environments": false, "num_consecutive_env_runner_failures_tolerance": 100, "env_runner_health_probe_timeout_s": 30.0, "env_runner_restore_timeout_s": 1800.0, "_model_config": {}, "_rl_module_spec": "RLModuleSpec(module_class=None, observation_space=None, action_space=None, inference_only=False, learner_only=False, model_config=DefaultModelConfig(fcnet_hiddens=[60, 90], fcnet_activation='tanh', fcnet_kernel_initializer=None, fcnet_kernel_initializer_kwargs=None, fcnet_bias_initializer=None, fcnet_bias_initializer_kwargs=None, conv_filters=None, conv_activation='relu', conv_kernel_initializer=None, conv_kernel_initializer_kwargs=None, conv_bias_initializer=None, conv_bias_initializer_kwargs=None, head_fcnet_hiddens=[], head_fcnet_activation='relu', head_fcnet_kernel_initializer=None, head_fcnet_kernel_initializer_kwargs=None, head_fcnet_bias_initializer=None, head_fcnet_bias_initializer_kwargs=None, free_log_std=False, log_std_clip_param=20.0, vf_share_layers=True, use_lstm=False, max_seq_len=20, lstm_cell_size=256, lstm_use_prev_action=False, lstm_use_prev_reward=False, lstm_kernel_initializer=None, lstm_kernel_initializer_kwargs=None, lstm_bias_initializer=None, lstm_bias_initializer_kwargs=None), catalog_class=None, load_state_path=None, model_config_dict=None)", "algorithm_config_overrides_per_module": {}, "_per_module_overrides": {}, "_validate_config": true, "_use_msgpack_checkpoints": false, "_torch_grad_scaler_class": null, "_torch_lr_scheduler_classes": null, "_tf_policy_handles_more_than_one_loss": false, "_disable_preprocessor_api": false, "_disable_action_flattening": false, "_disable_initialize_loss_from_dummy_batch": false, "_dont_auto_sync_env_runner_states": false, "env_task_fn": -1, "enable_connectors": -1, "simple_optimizer": false, "policy_map_cache": -1, "worker_cls": -1, "synchronize_filters": -1, "enable_async_evaluation": -1, "custom_async_evaluation_function": -1, "_enable_rl_module_api": -1, "auto_wrap_old_gym_envs": -1, "always_attach_evaluation_results": -1, "replay_sequence_length": null, "_disable_execution_plan_api": -1, "use_critic": true, "use_gae": true, "use_kl_loss": true, "kl_coeff": 0.7464963036515, "kl_target": 0.0270990929592, "vf_loss_coeff": 0.6688075857018, "entropy_coeff": 0.0090570820258, "clip_param": 0.1221781641624, "vf_clip_param": 0.1027808522125, "entropy_coeff_schedule": null, "lr_schedule": null, "sgd_minibatch_size": -1, "vf_share_layers": -1, "__stdout_file__": null, "__stderr_file__": null, "lambda": 0.9099046732075, "input": "sampler", "policies": {"default_policy": [null, null, null, null]}, "callbacks": "<class 'ray.rllib.callbacks.callbacks.RLlibCallback'>", "create_env_on_driver": false, "custom_eval_function": null, "framework": "torch"}, "time_since_restore": 30.324568271636963, "iterations_since_restore": 16, "perf": {"cpu_util_percent": 64.46666666666667, "ram_util_percent": 83.36666666666666}}
{"timers": {"training_iteration": 1.8975283450038956, "restore_env_runners": 1.177842494238659e-05, "training_step": 1.8973658150029675, "env_runner_sampling_timer": 1.7717870165379332, "learner_update_timer": 0.12213197747656088, "synch_weights": 0.0007950904655098107, "restore_eval_env_runners": 9.395566186258634e-06, "evaluation_iteration": 0.12895504082652254, "synch_eval_env_connectors": 0.0001230676245978423, "synch_env_connectors": 5.582106945937568e-06}, "env_runners": {"env_to_module_connector": {"timers": {"connectors": {"add_observations_from_episodes_to_batch": 3.0574459157099724e-06, "batch_individual_items": 6.350085753453433e-06, "numpy_to_tensor": 8.613604505518564e-06, "add_states_from_episodes_to_batch": 1.750683756099709e-06, "add_time_dim_to_batch_and_zero_pad": 2.3718660643960377e-06}}, "connector_pipeline_timer": 4.352715207257902e-05}, "episode_len_mean": 20.0, "sample": 0.005447038238996807, "module_to_env_connector": {"timers": {"connectors": {"get_actions": 3.902219481152963e-05, "un_batch_to_individual_items": 5.430600421758919e-06, "normalize_and_clip_actions": 9.430801609013537e-06, "listify_data_for_vector_env": 1.1012135837305004e-05, "remove_single_ts_time_rank_from_batch": 5.881518452772902e-07, "tensor_to_numpy": 1.3233662062914701e-05}}, "connector_pipeline_timer": 0.00010397502369390745}, "num_module_steps_sampled": {"default_policy": 5000.0}, "num_agent_steps_sampled_lifetime": {"default_agent": -9252500.0}, "num_env_steps_sampled": 5000.0, "episode_duration_sec_mean": 0.005054529323242604, "num_agent_steps_sampled": {"default_agent": 5000.0}, "env_to_module_sum_episodes_length_out": 10.36823839457432, "num_episodes": 250.0, "time_between_sampling": 0.0017389027143542126, "env_step_timer": 1.3753363869422788e-05, "agent_episode_returns_mean": {"default_agent": 6.62}, "episode_return_mean": 6.62, "num_module_steps_sampled_lifetime": {"default_policy": -9252500.0}, "env_to_module_sum_episodes_length_in": 10.36823839457432, "episode_return_max": 9.5, "num_episodes_lifetime": -462625.0, "weights_seq_no": 16.0, "module_episode_returns_mean": {"default_policy": 6.62}, "episode_return_min": -10.5, "episode_len_min": 20, "episode_len_max": 20, "env_reset_timer": 3.8037135029662495e-05, "num_env_steps_sampled_lifetime": -9252500.0, "rlmodule_inference_timer": 5.080958321276613e-05, "num_env_steps_sampled_lifetime_throughput": 3715.4728740833366}, "learners": {"__all_modules__": {"num_module_steps_trained_lifetime": 102000, "learner_connector_sum_episodes_length_in": 5000.0, "learner_connector": {"timers": {"connectors": {"add_observations_from_episodes_to_batch": 0.0008443609306065535, "batch_individual_items": 0.03751290197175688, "general_advantage_estimation": 0.007854581521280126, "add_one_ts_to_episodes_and_truncate": 0.009194043475795348, "add_time_dim_to_batch_and_zero_pad": 1.5593617744566015e-05, "add_states_from_episodes_to_batch": 4.01502695952443e-06, "add_columns_from_episodes_to_train_batch": 0.03607133892315908, "numpy_to_tensor": 7.328936663635413e-05}}, "connector_pipeline_timer": 0.09173186385108222}, "num_env_steps_trained": 31500, "num_env_steps_trained_lifetime": 535500, "num_non_trainable_parameters": 0, "learner_connector_sum_episodes_length_out": 5250.0, "num_module_steps_trained": 6000, "num_trainable_parameters": 6003, "num_env_steps_trained_lifetime_throughput": 1762373.184715548, "num_module_steps_trained_throughput": 336484.13044261787, "num_module_steps_trained_lifetime_throughput": 336133.83633498225}, "default_policy": {"vf_loss": 0.10278083384037018, "curr_entropy_coeff": 0.0090570820258, "mean_kl_loss": 0.0002801602240651846, "weights_seq_no": 17.0, "module_train_batch_size_mean": 1000.0, "vf_explained_var": -0.023396968841552734, "gradients_default_optimizer_global_norm": 0.03156490996479988, "diff_num_grad_updates_vs_sampler_policy": 1.0, "default_optimizer_learning_rate": 0.0002847858517, "curr_kl_coeff": 5.695314939657692e-06, "num_module_steps_trained": 6000, "num_trainable_parameters": 6003, "total_loss": -0.007574191316962242, "num_module_steps_trained_lifetime": 102000, "vf_loss_unclipped": 26.885883331298828, "policy_loss": -0.07086284458637238, "entropy": 0.6019554734230042, "num_module_steps_trained_lifetime_throughput": 336516.0598226337}}, "num_training_step_calls_per_iteration": 1, "evaluation": {"env_runners": {"sample": 0.12079724988300011, "num_module_steps_sampled": {"default_policy": 400}, "env_to_module_connector": {"timers": {"connectors": {"add_observations_from_episodes_to_batch": 2.997933012102526e-06, "numpy_to_tensor": 9.269600550893185e-06, "batch_individual_items": 6.899168182296336e-06, "add_time_dim_to_batch_and_zero_pad": 2.2558813427996984e-06, "add_states_from_episodes_to_batch": 1.5875541952025703e-06}}, "connector_pipeline_timer": 4.554132672657573e-05}, "num_agent_steps_sampled_lifetime": {"default_agent": 6800}, "module_to_env_connector": {"timers": {"connectors": {"tensor_to_numpy": 1.3664615520724134e-05, "get_actions": 3.9023592887463404e-05, "listify_data_for_vector_env": 1.1476867710718444e-05, "normalize_and_clip_actions": 9.973905075030033e-06, "remove_single_ts_time_rank_from_batch": 7.199749808768465e-07, "un_batch_to_individual_items": 5.5989396164713285e-06}}, "connector_pipeline_timer": 0.00010731937023068546}, "agent_episode_returns_mean": {"default_agent": 0.0}, "num_env_steps_sampled": 400, "env_to_module_sum_episodes_length_out": 10.368238394574323, "num_episodes": 20, "num_agent_steps_sampled": {"default_agent": 400}, "num_episodes_lifetime": 340, "weights_seq_no": 17.0, "env_reset_timer": 0.00019357390342821475, "module_episode_returns_mean": {"default_policy": 0.0}, "rlmodule_inference_timer": 2.9499789912626188e-05, "env_to_module_sum_episodes_length_in": 10.368238394574323, "episode_return_max": 12.5, "episode_len_min": 20, "episode_len_mean": 20.0, "episode_duration_sec_mean": 0.006063459176803007, "env_step_timer": 1.5078223350247587e-05, "episode_return_mean": 0.0, "num_module_steps_sampled_lifetime": {"default_policy": 6800}, "episode_return_min": -12.5, "episode_len_max": 20, "num_env_steps_sampled_lifetime": 85400, "time_between_sampling": 1.866171496743641}, "num_healthy_workers": 1, "actor_manager_num_outstanding_async_reqs": 0, "num_remote_worker_restarts": 0}, "num_env_steps_sampled_lifetime": -9252500.0, "fault_tolerance": {"num_healthy_workers": 0, "num_remote_worker_restarts": 0}, "env_runner_group": {"actor_manager_num_outstanding_async_reqs": 0}, "done": false, "training_iteration": 17, "trial_id": "43778_00000", "date": "2025-08-11_19-20-37", "timestamp": 1754932837, "time_this_iter_s": 1.7097537517547607, "time_total_s": 32.034322023391724, "pid": 14172, "hostname": "Mac", "node_ip": "127.0.0.1", "config": {"exploration_config": {}, "extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "placement_strategy": "PACK", "num_gpus": 0, "_fake_gpus": false, "num_cpus_for_main_process": 2, "eager_tracing": true, "eager_max_retraces": 20, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "torch_compile_learner": false, "torch_compile_learner_what_to_compile": "forward_train", "torch_compile_learner_dynamo_backend": "aot_eager", "torch_compile_learner_dynamo_mode": null, "torch_compile_worker": false, "torch_compile_worker_dynamo_backend": "aot_eager", "torch_compile_worker_dynamo_mode": null, "torch_ddp_kwargs": {}, "torch_skip_nan_gradients": false, "env": "Umbrella", "env_config": {}, "observation_space": null, "action_space": null, "clip_rewards": null, "normalize_actions": true, "clip_actions": false, "_is_atari": null, "disable_env_checking": false, "render_env": false, "action_mask_key": "action_mask", "env_runner_cls": null, "num_env_runners": 0, "create_local_env_runner": true, "num_envs_per_env_runner": 1, "gym_env_vectorize_mode": "SYNC", "num_cpus_per_env_runner": 1, "num_gpus_per_env_runner": 0, "custom_resources_per_env_runner": {}, "validate_env_runners_after_construction": true, "episodes_to_numpy": true, "max_requests_in_flight_per_env_runner": 1, "sample_timeout_s": 60.0, "_env_to_module_connector": null, "add_default_connectors_to_env_to_module_pipeline": true, "_module_to_env_connector": null, "add_default_connectors_to_module_to_env_pipeline": true, "merge_env_runner_states": "training_only", "broadcast_env_runner_states": true, "episode_lookback_horizon": 1, "rollout_fragment_length": "auto", "batch_mode": "complete_episodes", "compress_observations": false, "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "enable_tf1_exec_eagerly": false, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "preprocessor_pref": "deepmind", "observation_filter": "NoFilter", "update_worker_filter_stats": true, "use_worker_filter_stats": true, "sampler_perf_stats_ema_coef": null, "_is_online": true, "num_learners": 0, "num_gpus_per_learner": 0, "num_cpus_per_learner": "auto", "num_aggregator_actors_per_learner": 0, "max_requests_in_flight_per_aggregator_actor": 3, "local_gpu_idx": 0, "max_requests_in_flight_per_learner": 3, "gamma": 1, "lr": 0.0002847858517, "grad_clip": 0.5, "grad_clip_by": "global_norm", "_train_batch_size_per_learner": 5000, "train_batch_size": 4000, "num_epochs": 1, "minibatch_size": 1000, "shuffle_batch_per_epoch": true, "model": {"fcnet_hiddens": [256, 256], "fcnet_activation": "tanh", "fcnet_weights_initializer": null, "fcnet_weights_initializer_config": null, "fcnet_bias_initializer": null, "fcnet_bias_initializer_config": null, "conv_filters": null, "conv_activation": "relu", "conv_kernel_initializer": null, "conv_kernel_initializer_config": null, "conv_bias_initializer": null, "conv_bias_initializer_config": null, "conv_transpose_kernel_initializer": null, "conv_transpose_kernel_initializer_config": null, "conv_transpose_bias_initializer": null, "conv_transpose_bias_initializer_config": null, "post_fcnet_hiddens": [], "post_fcnet_activation": "relu", "post_fcnet_weights_initializer": null, "post_fcnet_weights_initializer_config": null, "post_fcnet_bias_initializer": null, "post_fcnet_bias_initializer_config": null, "free_log_std": false, "log_std_clip_param": 20.0, "no_final_linear": false, "vf_share_layers": false, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "lstm_weights_initializer": null, "lstm_weights_initializer_config": null, "lstm_bias_initializer": null, "lstm_bias_initializer_config": null, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "attention_use_n_prev_actions": 0, "attention_use_n_prev_rewards": 0, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": null, "custom_model_config": {}, "custom_action_dist": null, "custom_preprocessor": null, "encoder_latent_dim": null, "always_check_shapes": false, "lstm_use_prev_action_reward": -1, "_use_default_native_models": -1, "_disable_preprocessor_api": false, "_disable_action_flattening": false}, "_learner_connector": null, "add_default_connectors_to_learner_pipeline": true, "learner_config_dict": {}, "optimizer": {}, "_learner_class": null, "callbacks_on_algorithm_init": null, "callbacks_on_env_runners_recreated": null, "callbacks_on_offline_eval_runners_recreated": null, "callbacks_on_checkpoint_loaded": null, "callbacks_on_environment_created": null, "callbacks_on_episode_created": null, "callbacks_on_episode_start": null, "callbacks_on_episode_step": null, "callbacks_on_episode_end": null, "callbacks_on_evaluate_start": null, "callbacks_on_evaluate_end": null, "callbacks_on_evaluate_offline_start": null, "callbacks_on_evaluate_offline_end": null, "callbacks_on_sample_end": null, "callbacks_on_train_result": null, "explore": true, "enable_rl_module_and_learner": true, "enable_env_runner_and_connector_v2": true, "_prior_exploration_config": {"type": "StochasticSampling"}, "count_steps_by": "env_steps", "policy_map_capacity": 100, "policy_mapping_fn": "<function AlgorithmConfig.DEFAULT_POLICY_MAPPING_FN at 0x3888f18a0>", "policies_to_train": null, "policy_states_are_swappable": false, "observation_fn": null, "offline_data_class": null, "input_read_method": "read_parquet", "input_read_method_kwargs": {}, "input_read_schema": {}, "input_read_episodes": false, "input_read_sample_batches": false, "input_read_batch_size": null, "input_filesystem": null, "input_filesystem_kwargs": {}, "input_compress_columns": ["obs", "new_obs"], "input_spaces_jsonable": true, "materialize_data": false, "materialize_mapped_data": true, "map_batches_kwargs": {}, "iter_batches_kwargs": {}, "ignore_final_observation": false, "prelearner_class": null, "prelearner_buffer_class": null, "prelearner_buffer_kwargs": {}, "prelearner_module_synch_period": 10, "dataset_num_iters_per_learner": null, "input_config": {}, "actions_in_input_normalized": false, "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_config": {}, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "output_max_rows_per_file": null, "output_write_remaining_data": false, "output_write_method": "write_parquet", "output_write_method_kwargs": {}, "output_filesystem": null, "output_filesystem_kwargs": {}, "output_write_episodes": true, "offline_sampling": false, "evaluation_interval": 1, "evaluation_duration": 20, "evaluation_duration_unit": "episodes", "evaluation_sample_timeout_s": 120.0, "evaluation_auto_duration_min_env_steps_per_sample": 100, "evaluation_auto_duration_max_env_steps_per_sample": 2000, "evaluation_parallel_to_training": false, "evaluation_force_reset_envs_before_iteration": true, "evaluation_config": null, "off_policy_estimation_methods": {}, "ope_split_batch_by_episode": true, "evaluation_num_env_runners": 1, "in_evaluation": false, "sync_filters_on_rollout_workers_timeout_s": 10.0, "offline_evaluation_interval": null, "num_offline_eval_runners": 0, "offline_loss_for_module_fn": null, "offline_evaluation_duration": 1, "offline_evaluation_parallel_to_training": false, "offline_evaluation_timeout_s": 120.0, "num_cpus_per_offline_eval_runner": 1, "num_gpus_per_offline_eval_runner": 0, "custom_resources_per_offline_eval_runner": {}, "restart_failed_offline_eval_runners": true, "ignore_offline_eval_runner_failures": false, "max_num_offline_eval_runner_restarts": 1000, "offline_eval_runner_restore_timeout_s": 1800.0, "max_requests_in_flight_per_offline_eval_runner": 1, "validate_offline_eval_runners_after_construction": true, "offline_eval_runner_health_probe_timeout_s": 30.0, "offline_eval_rl_module_inference_only": false, "broadcast_offline_eval_runner_states": false, "offline_eval_batch_size_per_runner": 256, "dataset_num_iters_per_eval_runner": 1, "keep_per_episode_custom_metrics": false, "metrics_episode_collection_timeout_s": 60.0, "metrics_num_episodes_for_smoothing": 100, "min_time_s_per_iteration": null, "min_train_timesteps_per_iteration": 0, "min_sample_timesteps_per_iteration": 0, "log_gradients": true, "export_native_model_files": false, "checkpoint_trainable_policies_only": false, "logger_creator": null, "logger_config": null, "log_level": "WARN", "log_sys_usage": true, "fake_sampler": false, "seed": 1, "restart_failed_env_runners": true, "ignore_env_runner_failures": false, "max_num_env_runner_restarts": 1000, "delay_between_env_runner_restarts_s": 60.0, "restart_failed_sub_environments": false, "num_consecutive_env_runner_failures_tolerance": 100, "env_runner_health_probe_timeout_s": 30.0, "env_runner_restore_timeout_s": 1800.0, "_model_config": {}, "_rl_module_spec": "RLModuleSpec(module_class=None, observation_space=None, action_space=None, inference_only=False, learner_only=False, model_config=DefaultModelConfig(fcnet_hiddens=[60, 90], fcnet_activation='tanh', fcnet_kernel_initializer=None, fcnet_kernel_initializer_kwargs=None, fcnet_bias_initializer=None, fcnet_bias_initializer_kwargs=None, conv_filters=None, conv_activation='relu', conv_kernel_initializer=None, conv_kernel_initializer_kwargs=None, conv_bias_initializer=None, conv_bias_initializer_kwargs=None, head_fcnet_hiddens=[], head_fcnet_activation='relu', head_fcnet_kernel_initializer=None, head_fcnet_kernel_initializer_kwargs=None, head_fcnet_bias_initializer=None, head_fcnet_bias_initializer_kwargs=None, free_log_std=False, log_std_clip_param=20.0, vf_share_layers=True, use_lstm=False, max_seq_len=20, lstm_cell_size=256, lstm_use_prev_action=False, lstm_use_prev_reward=False, lstm_kernel_initializer=None, lstm_kernel_initializer_kwargs=None, lstm_bias_initializer=None, lstm_bias_initializer_kwargs=None), catalog_class=None, load_state_path=None, model_config_dict=None)", "algorithm_config_overrides_per_module": {}, "_per_module_overrides": {}, "_validate_config": true, "_use_msgpack_checkpoints": false, "_torch_grad_scaler_class": null, "_torch_lr_scheduler_classes": null, "_tf_policy_handles_more_than_one_loss": false, "_disable_preprocessor_api": false, "_disable_action_flattening": false, "_disable_initialize_loss_from_dummy_batch": false, "_dont_auto_sync_env_runner_states": false, "env_task_fn": -1, "enable_connectors": -1, "simple_optimizer": false, "policy_map_cache": -1, "worker_cls": -1, "synchronize_filters": -1, "enable_async_evaluation": -1, "custom_async_evaluation_function": -1, "_enable_rl_module_api": -1, "auto_wrap_old_gym_envs": -1, "always_attach_evaluation_results": -1, "replay_sequence_length": null, "_disable_execution_plan_api": -1, "use_critic": true, "use_gae": true, "use_kl_loss": true, "kl_coeff": 0.7464963036515, "kl_target": 0.0270990929592, "vf_loss_coeff": 0.6688075857018, "entropy_coeff": 0.0090570820258, "clip_param": 0.1221781641624, "vf_clip_param": 0.1027808522125, "entropy_coeff_schedule": null, "lr_schedule": null, "sgd_minibatch_size": -1, "vf_share_layers": -1, "__stdout_file__": null, "__stderr_file__": null, "lambda": 0.9099046732075, "input": "sampler", "policies": {"default_policy": [null, null, null, null]}, "callbacks": "<class 'ray.rllib.callbacks.callbacks.RLlibCallback'>", "create_env_on_driver": false, "custom_eval_function": null, "framework": "torch"}, "time_since_restore": 32.034322023391724, "iterations_since_restore": 17, "perf": {"cpu_util_percent": 41.95, "ram_util_percent": 82.0}}
{"timers": {"training_iteration": 1.8943925494746046, "restore_env_runners": 1.1735221004737931e-05, "training_step": 1.894229761023603, "env_runner_sampling_timer": 1.7680611851224108, "learner_update_timer": 0.12272438104196014, "synch_weights": 0.000793177481102476, "restore_eval_env_runners": 9.357860079596385e-06, "evaluation_iteration": 0.12874825999820988, "synch_eval_env_connectors": 0.00012285027853578713, "synch_env_connectors": 5.590456330175635e-06}, "env_runners": {"env_to_module_connector": {"timers": {"connectors": {"add_observations_from_episodes_to_batch": 2.999299592982001e-06, "batch_individual_items": 6.376071795569572e-06, "numpy_to_tensor": 8.706198758748517e-06, "add_states_from_episodes_to_batch": 1.762274306845752e-06, "add_time_dim_to_batch_and_zero_pad": 2.387322836746468e-06}}, "connector_pipeline_timer": 4.3682942628796714e-05}, "episode_len_mean": 20.0, "sample": 0.0050816752106099235, "module_to_env_connector": {"timers": {"connectors": {"get_actions": 3.977157835024607e-05, "un_batch_to_individual_items": 5.410139382716548e-06, "normalize_and_clip_actions": 9.526567600293977e-06, "listify_data_for_vector_env": 1.1110937208429702e-05, "remove_single_ts_time_rank_from_batch": 5.901493063880229e-07, "tensor_to_numpy": 1.3368586880189184e-05}}, "connector_pipeline_timer": 0.00010526766534376594}, "num_module_steps_sampled": {"default_policy": 5000.0}, "num_agent_steps_sampled_lifetime": {"default_agent": -9870000.0}, "num_env_steps_sampled": 5000.0, "episode_duration_sec_mean": 0.004604866007808594, "num_agent_steps_sampled": {"default_agent": 5000.0}, "env_to_module_sum_episodes_length_out": 10.36823839457432, "num_episodes": 250.0, "time_between_sampling": 0.001545861962068935, "env_step_timer": 1.3873021929078563e-05, "agent_episode_returns_mean": {"default_agent": 6.7799999999999985}, "episode_return_mean": 6.7799999999999985, "num_module_steps_sampled_lifetime": {"default_policy": -9870000.0}, "env_to_module_sum_episodes_length_in": 10.36823839457432, "episode_return_max": 9.5, "num_episodes_lifetime": -493500.0, "weights_seq_no": 17.0, "module_episode_returns_mean": {"default_policy": 6.7799999999999985}, "episode_return_min": -10.5, "episode_len_min": 20, "episode_len_max": 20, "env_reset_timer": 3.6165323058003516e-05, "num_env_steps_sampled_lifetime": -9870000.0, "rlmodule_inference_timer": 2.878881485757982e-05, "num_env_steps_sampled_lifetime_throughput": 3689.7813671442786}, "learners": {"__all_modules__": {"num_module_steps_trained_lifetime": 108000, "learner_connector_sum_episodes_length_in": 5000.0, "learner_connector": {"timers": {"connectors": {"add_observations_from_episodes_to_batch": 0.0008441419112834893, "batch_individual_items": 0.03834300712223216, "general_advantage_estimation": 0.007829221956219391, "add_one_ts_to_episodes_and_truncate": 0.00918014721038699, "add_time_dim_to_batch_and_zero_pad": 1.5554761620434922e-05, "add_states_from_episodes_to_batch": 4.010705833527861e-06, "add_columns_from_episodes_to_train_batch": 0.036044511784082536, "numpy_to_tensor": 7.317355333809218e-05}}, "connector_pipeline_timer": 0.09249490687253593}, "num_env_steps_trained": 31500, "num_env_steps_trained_lifetime": 567000, "num_non_trainable_parameters": 0, "learner_connector_sum_episodes_length_out": 5250.0, "num_module_steps_trained": 6000, "num_trainable_parameters": 6003, "num_env_steps_trained_lifetime_throughput": 1777473.2837768595, "num_module_steps_trained_throughput": 339332.51941320876, "num_module_steps_trained_lifetime_throughput": 338990.40174376866}, "default_policy": {"vf_loss": 0.10278083384037018, "curr_entropy_coeff": 0.0090570820258, "mean_kl_loss": 0.0001861961354734376, "weights_seq_no": 18.0, "module_train_batch_size_mean": 1000.0, "vf_explained_var": -0.02406442165374756, "gradients_default_optimizer_global_norm": 0.02470725029706955, "diff_num_grad_updates_vs_sampler_policy": 1.0, "default_optimizer_learning_rate": 0.0002847858517, "curr_kl_coeff": 2.847657469828846e-06, "num_module_steps_trained": 6000, "num_trainable_parameters": 6003, "total_loss": -0.08611404895782471, "num_module_steps_trained_lifetime": 108000, "vf_loss_unclipped": 26.647491455078125, "policy_loss": -0.1494331955909729, "entropy": 0.5985884666442871, "num_module_steps_trained_lifetime_throughput": 339327.4832962327}}, "num_training_step_calls_per_iteration": 1, "evaluation": {"env_runners": {"sample": 0.12057139905455592, "num_module_steps_sampled": {"default_policy": 400}, "env_to_module_connector": {"timers": {"connectors": {"add_observations_from_episodes_to_batch": 2.8265274680756672e-06, "numpy_to_tensor": 8.296894713795034e-06, "batch_individual_items": 6.109639667378334e-06, "add_time_dim_to_batch_and_zero_pad": 2.1742370422899684e-06, "add_states_from_episodes_to_batch": 1.6054586416071985e-06}}, "connector_pipeline_timer": 4.2684000042308686e-05}, "num_agent_steps_sampled_lifetime": {"default_agent": 7200}, "module_to_env_connector": {"timers": {"connectors": {"tensor_to_numpy": 1.3016873331197665e-05, "get_actions": 3.590528124195327e-05, "listify_data_for_vector_env": 1.0929940973265195e-05, "normalize_and_clip_actions": 9.415208901321684e-06, "remove_single_ts_time_rank_from_batch": 5.791436965193018e-07, "un_batch_to_individual_items": 5.347435099867736e-06}}, "connector_pipeline_timer": 0.00010145220949343531}, "agent_episode_returns_mean": {"default_agent": 0.0}, "num_env_steps_sampled": 400, "env_to_module_sum_episodes_length_out": 10.368238394574323, "num_episodes": 20, "num_agent_steps_sampled": {"default_agent": 400}, "num_episodes_lifetime": 360, "weights_seq_no": 18.0, "env_reset_timer": 0.0001926210845674882, "module_episode_returns_mean": {"default_policy": 0.0}, "rlmodule_inference_timer": 2.712515489843881e-05, "env_to_module_sum_episodes_length_in": 10.368238394574323, "episode_return_max": 12.5, "episode_len_min": 20, "episode_len_mean": 20.0, "episode_duration_sec_mean": 0.005285886696074158, "env_step_timer": 1.3911226893598066e-05, "episode_return_mean": 0.0, "num_module_steps_sampled_lifetime": {"default_policy": 7200}, "episode_return_min": -12.5, "episode_len_max": 20, "num_env_steps_sampled_lifetime": 90400, "time_between_sampling": 1.863546637185825}, "num_healthy_workers": 1, "actor_manager_num_outstanding_async_reqs": 0, "num_remote_worker_restarts": 0}, "num_env_steps_sampled_lifetime": -9870000.0, "fault_tolerance": {"num_healthy_workers": 0, "num_remote_worker_restarts": 0}, "env_runner_group": {"actor_manager_num_outstanding_async_reqs": 0}, "done": false, "training_iteration": 18, "trial_id": "43778_00000", "date": "2025-08-11_19-20-39", "timestamp": 1754932839, "time_this_iter_s": 1.68963623046875, "time_total_s": 33.723958253860474, "pid": 14172, "hostname": "Mac", "node_ip": "127.0.0.1", "config": {"exploration_config": {}, "extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "placement_strategy": "PACK", "num_gpus": 0, "_fake_gpus": false, "num_cpus_for_main_process": 2, "eager_tracing": true, "eager_max_retraces": 20, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "torch_compile_learner": false, "torch_compile_learner_what_to_compile": "forward_train", "torch_compile_learner_dynamo_backend": "aot_eager", "torch_compile_learner_dynamo_mode": null, "torch_compile_worker": false, "torch_compile_worker_dynamo_backend": "aot_eager", "torch_compile_worker_dynamo_mode": null, "torch_ddp_kwargs": {}, "torch_skip_nan_gradients": false, "env": "Umbrella", "env_config": {}, "observation_space": null, "action_space": null, "clip_rewards": null, "normalize_actions": true, "clip_actions": false, "_is_atari": null, "disable_env_checking": false, "render_env": false, "action_mask_key": "action_mask", "env_runner_cls": null, "num_env_runners": 0, "create_local_env_runner": true, "num_envs_per_env_runner": 1, "gym_env_vectorize_mode": "SYNC", "num_cpus_per_env_runner": 1, "num_gpus_per_env_runner": 0, "custom_resources_per_env_runner": {}, "validate_env_runners_after_construction": true, "episodes_to_numpy": true, "max_requests_in_flight_per_env_runner": 1, "sample_timeout_s": 60.0, "_env_to_module_connector": null, "add_default_connectors_to_env_to_module_pipeline": true, "_module_to_env_connector": null, "add_default_connectors_to_module_to_env_pipeline": true, "merge_env_runner_states": "training_only", "broadcast_env_runner_states": true, "episode_lookback_horizon": 1, "rollout_fragment_length": "auto", "batch_mode": "complete_episodes", "compress_observations": false, "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "enable_tf1_exec_eagerly": false, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "preprocessor_pref": "deepmind", "observation_filter": "NoFilter", "update_worker_filter_stats": true, "use_worker_filter_stats": true, "sampler_perf_stats_ema_coef": null, "_is_online": true, "num_learners": 0, "num_gpus_per_learner": 0, "num_cpus_per_learner": "auto", "num_aggregator_actors_per_learner": 0, "max_requests_in_flight_per_aggregator_actor": 3, "local_gpu_idx": 0, "max_requests_in_flight_per_learner": 3, "gamma": 1, "lr": 0.0002847858517, "grad_clip": 0.5, "grad_clip_by": "global_norm", "_train_batch_size_per_learner": 5000, "train_batch_size": 4000, "num_epochs": 1, "minibatch_size": 1000, "shuffle_batch_per_epoch": true, "model": {"fcnet_hiddens": [256, 256], "fcnet_activation": "tanh", "fcnet_weights_initializer": null, "fcnet_weights_initializer_config": null, "fcnet_bias_initializer": null, "fcnet_bias_initializer_config": null, "conv_filters": null, "conv_activation": "relu", "conv_kernel_initializer": null, "conv_kernel_initializer_config": null, "conv_bias_initializer": null, "conv_bias_initializer_config": null, "conv_transpose_kernel_initializer": null, "conv_transpose_kernel_initializer_config": null, "conv_transpose_bias_initializer": null, "conv_transpose_bias_initializer_config": null, "post_fcnet_hiddens": [], "post_fcnet_activation": "relu", "post_fcnet_weights_initializer": null, "post_fcnet_weights_initializer_config": null, "post_fcnet_bias_initializer": null, "post_fcnet_bias_initializer_config": null, "free_log_std": false, "log_std_clip_param": 20.0, "no_final_linear": false, "vf_share_layers": false, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "lstm_weights_initializer": null, "lstm_weights_initializer_config": null, "lstm_bias_initializer": null, "lstm_bias_initializer_config": null, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "attention_use_n_prev_actions": 0, "attention_use_n_prev_rewards": 0, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": null, "custom_model_config": {}, "custom_action_dist": null, "custom_preprocessor": null, "encoder_latent_dim": null, "always_check_shapes": false, "lstm_use_prev_action_reward": -1, "_use_default_native_models": -1, "_disable_preprocessor_api": false, "_disable_action_flattening": false}, "_learner_connector": null, "add_default_connectors_to_learner_pipeline": true, "learner_config_dict": {}, "optimizer": {}, "_learner_class": null, "callbacks_on_algorithm_init": null, "callbacks_on_env_runners_recreated": null, "callbacks_on_offline_eval_runners_recreated": null, "callbacks_on_checkpoint_loaded": null, "callbacks_on_environment_created": null, "callbacks_on_episode_created": null, "callbacks_on_episode_start": null, "callbacks_on_episode_step": null, "callbacks_on_episode_end": null, "callbacks_on_evaluate_start": null, "callbacks_on_evaluate_end": null, "callbacks_on_evaluate_offline_start": null, "callbacks_on_evaluate_offline_end": null, "callbacks_on_sample_end": null, "callbacks_on_train_result": null, "explore": true, "enable_rl_module_and_learner": true, "enable_env_runner_and_connector_v2": true, "_prior_exploration_config": {"type": "StochasticSampling"}, "count_steps_by": "env_steps", "policy_map_capacity": 100, "policy_mapping_fn": "<function AlgorithmConfig.DEFAULT_POLICY_MAPPING_FN at 0x3888f18a0>", "policies_to_train": null, "policy_states_are_swappable": false, "observation_fn": null, "offline_data_class": null, "input_read_method": "read_parquet", "input_read_method_kwargs": {}, "input_read_schema": {}, "input_read_episodes": false, "input_read_sample_batches": false, "input_read_batch_size": null, "input_filesystem": null, "input_filesystem_kwargs": {}, "input_compress_columns": ["obs", "new_obs"], "input_spaces_jsonable": true, "materialize_data": false, "materialize_mapped_data": true, "map_batches_kwargs": {}, "iter_batches_kwargs": {}, "ignore_final_observation": false, "prelearner_class": null, "prelearner_buffer_class": null, "prelearner_buffer_kwargs": {}, "prelearner_module_synch_period": 10, "dataset_num_iters_per_learner": null, "input_config": {}, "actions_in_input_normalized": false, "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_config": {}, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "output_max_rows_per_file": null, "output_write_remaining_data": false, "output_write_method": "write_parquet", "output_write_method_kwargs": {}, "output_filesystem": null, "output_filesystem_kwargs": {}, "output_write_episodes": true, "offline_sampling": false, "evaluation_interval": 1, "evaluation_duration": 20, "evaluation_duration_unit": "episodes", "evaluation_sample_timeout_s": 120.0, "evaluation_auto_duration_min_env_steps_per_sample": 100, "evaluation_auto_duration_max_env_steps_per_sample": 2000, "evaluation_parallel_to_training": false, "evaluation_force_reset_envs_before_iteration": true, "evaluation_config": null, "off_policy_estimation_methods": {}, "ope_split_batch_by_episode": true, "evaluation_num_env_runners": 1, "in_evaluation": false, "sync_filters_on_rollout_workers_timeout_s": 10.0, "offline_evaluation_interval": null, "num_offline_eval_runners": 0, "offline_loss_for_module_fn": null, "offline_evaluation_duration": 1, "offline_evaluation_parallel_to_training": false, "offline_evaluation_timeout_s": 120.0, "num_cpus_per_offline_eval_runner": 1, "num_gpus_per_offline_eval_runner": 0, "custom_resources_per_offline_eval_runner": {}, "restart_failed_offline_eval_runners": true, "ignore_offline_eval_runner_failures": false, "max_num_offline_eval_runner_restarts": 1000, "offline_eval_runner_restore_timeout_s": 1800.0, "max_requests_in_flight_per_offline_eval_runner": 1, "validate_offline_eval_runners_after_construction": true, "offline_eval_runner_health_probe_timeout_s": 30.0, "offline_eval_rl_module_inference_only": false, "broadcast_offline_eval_runner_states": false, "offline_eval_batch_size_per_runner": 256, "dataset_num_iters_per_eval_runner": 1, "keep_per_episode_custom_metrics": false, "metrics_episode_collection_timeout_s": 60.0, "metrics_num_episodes_for_smoothing": 100, "min_time_s_per_iteration": null, "min_train_timesteps_per_iteration": 0, "min_sample_timesteps_per_iteration": 0, "log_gradients": true, "export_native_model_files": false, "checkpoint_trainable_policies_only": false, "logger_creator": null, "logger_config": null, "log_level": "WARN", "log_sys_usage": true, "fake_sampler": false, "seed": 1, "restart_failed_env_runners": true, "ignore_env_runner_failures": false, "max_num_env_runner_restarts": 1000, "delay_between_env_runner_restarts_s": 60.0, "restart_failed_sub_environments": false, "num_consecutive_env_runner_failures_tolerance": 100, "env_runner_health_probe_timeout_s": 30.0, "env_runner_restore_timeout_s": 1800.0, "_model_config": {}, "_rl_module_spec": "RLModuleSpec(module_class=None, observation_space=None, action_space=None, inference_only=False, learner_only=False, model_config=DefaultModelConfig(fcnet_hiddens=[60, 90], fcnet_activation='tanh', fcnet_kernel_initializer=None, fcnet_kernel_initializer_kwargs=None, fcnet_bias_initializer=None, fcnet_bias_initializer_kwargs=None, conv_filters=None, conv_activation='relu', conv_kernel_initializer=None, conv_kernel_initializer_kwargs=None, conv_bias_initializer=None, conv_bias_initializer_kwargs=None, head_fcnet_hiddens=[], head_fcnet_activation='relu', head_fcnet_kernel_initializer=None, head_fcnet_kernel_initializer_kwargs=None, head_fcnet_bias_initializer=None, head_fcnet_bias_initializer_kwargs=None, free_log_std=False, log_std_clip_param=20.0, vf_share_layers=True, use_lstm=False, max_seq_len=20, lstm_cell_size=256, lstm_use_prev_action=False, lstm_use_prev_reward=False, lstm_kernel_initializer=None, lstm_kernel_initializer_kwargs=None, lstm_bias_initializer=None, lstm_bias_initializer_kwargs=None), catalog_class=None, load_state_path=None, model_config_dict=None)", "algorithm_config_overrides_per_module": {}, "_per_module_overrides": {}, "_validate_config": true, "_use_msgpack_checkpoints": false, "_torch_grad_scaler_class": null, "_torch_lr_scheduler_classes": null, "_tf_policy_handles_more_than_one_loss": false, "_disable_preprocessor_api": false, "_disable_action_flattening": false, "_disable_initialize_loss_from_dummy_batch": false, "_dont_auto_sync_env_runner_states": false, "env_task_fn": -1, "enable_connectors": -1, "simple_optimizer": false, "policy_map_cache": -1, "worker_cls": -1, "synchronize_filters": -1, "enable_async_evaluation": -1, "custom_async_evaluation_function": -1, "_enable_rl_module_api": -1, "auto_wrap_old_gym_envs": -1, "always_attach_evaluation_results": -1, "replay_sequence_length": null, "_disable_execution_plan_api": -1, "use_critic": true, "use_gae": true, "use_kl_loss": true, "kl_coeff": 0.7464963036515, "kl_target": 0.0270990929592, "vf_loss_coeff": 0.6688075857018, "entropy_coeff": 0.0090570820258, "clip_param": 0.1221781641624, "vf_clip_param": 0.1027808522125, "entropy_coeff_schedule": null, "lr_schedule": null, "sgd_minibatch_size": -1, "vf_share_layers": -1, "__stdout_file__": null, "__stderr_file__": null, "lambda": 0.9099046732075, "input": "sampler", "policies": {"default_policy": [null, null, null, null]}, "callbacks": "<class 'ray.rllib.callbacks.callbacks.RLlibCallback'>", "create_env_on_driver": false, "custom_eval_function": null, "framework": "torch"}, "time_since_restore": 33.723958253860474, "iterations_since_restore": 18, "perf": {"cpu_util_percent": 47.199999999999996, "ram_util_percent": 82.0}}
{"timers": {"training_iteration": 1.8913830356396952, "restore_env_runners": 1.1667039134170593e-05, "training_step": 1.8912201746632828, "env_runner_sampling_timer": 1.7644684778616015, "learner_update_timer": 0.1233087522308553, "synch_weights": 0.0007914827863793366, "restore_eval_env_runners": 9.322621853180772e-06, "evaluation_iteration": 0.12849394031756659, "synch_eval_env_connectors": 0.00012251802588103794, "synch_env_connectors": 5.570801169784349e-06}, "env_runners": {"env_to_module_connector": {"timers": {"connectors": {"add_observations_from_episodes_to_batch": 3.0476787979496096e-06, "batch_individual_items": 6.496746172452337e-06, "numpy_to_tensor": 8.813829782666978e-06, "add_states_from_episodes_to_batch": 1.7644429316720495e-06, "add_time_dim_to_batch_and_zero_pad": 2.4174703933327368e-06}}, "connector_pipeline_timer": 4.425160740829973e-05}, "episode_len_mean": 20.0, "sample": 0.0049909488896062604, "module_to_env_connector": {"timers": {"connectors": {"get_actions": 4.0223761209805574e-05, "un_batch_to_individual_items": 5.5034967810452095e-06, "normalize_and_clip_actions": 9.608338829141317e-06, "listify_data_for_vector_env": 1.120150308806143e-05, "remove_single_ts_time_rank_from_batch": 5.999235123082289e-07, "tensor_to_numpy": 1.355727217123631e-05}}, "connector_pipeline_timer": 0.00010635819847103163}, "num_module_steps_sampled": {"default_policy": 5000.0}, "num_agent_steps_sampled_lifetime": {"default_agent": -10487500.0}, "num_env_steps_sampled": 5000.0, "episode_duration_sec_mean": 0.004656019206624477, "num_agent_steps_sampled": {"default_agent": 5000.0}, "env_to_module_sum_episodes_length_out": 10.36823839457432, "num_episodes": 250.0, "time_between_sampling": 0.001833296613149249, "env_step_timer": 1.4080589083623113e-05, "agent_episode_returns_mean": {"default_agent": 7.1}, "episode_return_mean": 7.1, "num_module_steps_sampled_lifetime": {"default_policy": -10487500.0}, "env_to_module_sum_episodes_length_in": 10.36823839457432, "episode_return_max": 9.5, "num_episodes_lifetime": -524375.0, "weights_seq_no": 18.0, "module_episode_returns_mean": {"default_policy": 7.1}, "episode_return_min": -10.5, "episode_len_min": 20, "episode_len_max": 20, "env_reset_timer": 3.6580072798203066e-05, "num_env_steps_sampled_lifetime": -10487500.0, "rlmodule_inference_timer": 2.9042597404443264e-05, "num_env_steps_sampled_lifetime_throughput": 3647.175521539138}, "learners": {"__all_modules__": {"num_module_steps_trained_lifetime": 114000, "learner_connector_sum_episodes_length_in": 5000.0, "learner_connector": {"timers": {"connectors": {"add_observations_from_episodes_to_batch": 0.0008440288221752421, "batch_individual_items": 0.03914320789139703, "general_advantage_estimation": 0.0078054251469524, "add_one_ts_to_episodes_and_truncate": 0.009168051158931798, "add_time_dim_to_batch_and_zero_pad": 1.5502554721263124e-05, "add_states_from_episodes_to_batch": 4.001849304183805e-06, "add_columns_from_episodes_to_train_batch": 0.036031321665456494, "numpy_to_tensor": 7.306431847019712e-05}}, "connector_pipeline_timer": 0.09324511822393779}, "num_env_steps_trained": 31500, "num_env_steps_trained_lifetime": 598500, "num_non_trainable_parameters": 0, "learner_connector_sum_episodes_length_out": 5250.0, "num_module_steps_trained": 6000, "num_trainable_parameters": 6003, "num_env_steps_trained_lifetime_throughput": 1794661.879145389, "num_module_steps_trained_throughput": 342584.04443553113, "num_module_steps_trained_lifetime_throughput": 342248.1552356602}, "default_policy": {"vf_loss": 0.10278083384037018, "curr_entropy_coeff": 0.0090570820258, "mean_kl_loss": 0.00044902059016749263, "weights_seq_no": 19.0, "module_train_batch_size_mean": 1000.0, "vf_explained_var": -0.024727582931518555, "gradients_default_optimizer_global_norm": 0.021649973466992378, "diff_num_grad_updates_vs_sampler_policy": 1.0, "default_optimizer_learning_rate": 0.0002847858517, "curr_kl_coeff": 1.423828734914423e-06, "num_module_steps_trained": 6000, "num_trainable_parameters": 6003, "total_loss": 0.04370664060115814, "num_module_steps_trained_lifetime": 114000, "vf_loss_unclipped": 26.865428924560547, "policy_loss": -0.019801601767539978, "entropy": 0.577710747718811, "num_module_steps_trained_lifetime_throughput": 342543.4915252384}}, "num_training_step_calls_per_iteration": 1, "evaluation": {"env_runners": {"sample": 0.12035435881455434, "num_module_steps_sampled": {"default_policy": 400}, "env_to_module_connector": {"timers": {"connectors": {"add_observations_from_episodes_to_batch": 2.8822024861650563e-06, "numpy_to_tensor": 8.322744135581619e-06, "batch_individual_items": 6.068730755827304e-06, "add_time_dim_to_batch_and_zero_pad": 2.2121695557333264e-06, "add_states_from_episodes_to_batch": 1.6626176042465832e-06}}, "connector_pipeline_timer": 4.3067811059708855e-05}, "num_agent_steps_sampled_lifetime": {"default_agent": 7600}, "module_to_env_connector": {"timers": {"connectors": {"tensor_to_numpy": 1.3025814810811221e-05, "get_actions": 3.599326894390702e-05, "listify_data_for_vector_env": 1.0878437386170014e-05, "normalize_and_clip_actions": 9.395541703808204e-06, "remove_single_ts_time_rank_from_batch": 5.592107027136139e-07, "un_batch_to_individual_items": 5.371402677218312e-06}}, "connector_pipeline_timer": 0.00010118937083507312}, "agent_episode_returns_mean": {"default_agent": -0.2}, "num_env_steps_sampled": 400, "env_to_module_sum_episodes_length_out": 10.368238394574323, "num_episodes": 20, "num_agent_steps_sampled": {"default_agent": 400}, "num_episodes_lifetime": 380, "weights_seq_no": 19.0, "env_reset_timer": 0.0001914457036531619, "module_episode_returns_mean": {"default_policy": -0.2}, "rlmodule_inference_timer": 2.705298325545339e-05, "env_to_module_sum_episodes_length_in": 10.368238394574323, "episode_return_max": 12.5, "episode_len_min": 20, "episode_len_mean": 20.0, "episode_duration_sec_mean": 0.005149651707615704, "env_step_timer": 1.398777756166806e-05, "episode_return_mean": -0.2, "num_module_steps_sampled_lifetime": {"default_policy": 7600}, "episode_return_min": -12.5, "episode_len_max": 20, "num_env_steps_sampled_lifetime": 95400, "time_between_sampling": 1.8610214783148973}, "num_healthy_workers": 1, "actor_manager_num_outstanding_async_reqs": 0, "num_remote_worker_restarts": 0}, "num_env_steps_sampled_lifetime": -10487500.0, "fault_tolerance": {"num_healthy_workers": 0, "num_remote_worker_restarts": 0}, "env_runner_group": {"actor_manager_num_outstanding_async_reqs": 0}, "done": false, "training_iteration": 19, "trial_id": "43778_00000", "date": "2025-08-11_19-20-41", "timestamp": 1754932841, "time_this_iter_s": 1.7004070281982422, "time_total_s": 35.424365282058716, "pid": 14172, "hostname": "Mac", "node_ip": "127.0.0.1", "config": {"exploration_config": {}, "extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "placement_strategy": "PACK", "num_gpus": 0, "_fake_gpus": false, "num_cpus_for_main_process": 2, "eager_tracing": true, "eager_max_retraces": 20, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "torch_compile_learner": false, "torch_compile_learner_what_to_compile": "forward_train", "torch_compile_learner_dynamo_backend": "aot_eager", "torch_compile_learner_dynamo_mode": null, "torch_compile_worker": false, "torch_compile_worker_dynamo_backend": "aot_eager", "torch_compile_worker_dynamo_mode": null, "torch_ddp_kwargs": {}, "torch_skip_nan_gradients": false, "env": "Umbrella", "env_config": {}, "observation_space": null, "action_space": null, "clip_rewards": null, "normalize_actions": true, "clip_actions": false, "_is_atari": null, "disable_env_checking": false, "render_env": false, "action_mask_key": "action_mask", "env_runner_cls": null, "num_env_runners": 0, "create_local_env_runner": true, "num_envs_per_env_runner": 1, "gym_env_vectorize_mode": "SYNC", "num_cpus_per_env_runner": 1, "num_gpus_per_env_runner": 0, "custom_resources_per_env_runner": {}, "validate_env_runners_after_construction": true, "episodes_to_numpy": true, "max_requests_in_flight_per_env_runner": 1, "sample_timeout_s": 60.0, "_env_to_module_connector": null, "add_default_connectors_to_env_to_module_pipeline": true, "_module_to_env_connector": null, "add_default_connectors_to_module_to_env_pipeline": true, "merge_env_runner_states": "training_only", "broadcast_env_runner_states": true, "episode_lookback_horizon": 1, "rollout_fragment_length": "auto", "batch_mode": "complete_episodes", "compress_observations": false, "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "enable_tf1_exec_eagerly": false, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "preprocessor_pref": "deepmind", "observation_filter": "NoFilter", "update_worker_filter_stats": true, "use_worker_filter_stats": true, "sampler_perf_stats_ema_coef": null, "_is_online": true, "num_learners": 0, "num_gpus_per_learner": 0, "num_cpus_per_learner": "auto", "num_aggregator_actors_per_learner": 0, "max_requests_in_flight_per_aggregator_actor": 3, "local_gpu_idx": 0, "max_requests_in_flight_per_learner": 3, "gamma": 1, "lr": 0.0002847858517, "grad_clip": 0.5, "grad_clip_by": "global_norm", "_train_batch_size_per_learner": 5000, "train_batch_size": 4000, "num_epochs": 1, "minibatch_size": 1000, "shuffle_batch_per_epoch": true, "model": {"fcnet_hiddens": [256, 256], "fcnet_activation": "tanh", "fcnet_weights_initializer": null, "fcnet_weights_initializer_config": null, "fcnet_bias_initializer": null, "fcnet_bias_initializer_config": null, "conv_filters": null, "conv_activation": "relu", "conv_kernel_initializer": null, "conv_kernel_initializer_config": null, "conv_bias_initializer": null, "conv_bias_initializer_config": null, "conv_transpose_kernel_initializer": null, "conv_transpose_kernel_initializer_config": null, "conv_transpose_bias_initializer": null, "conv_transpose_bias_initializer_config": null, "post_fcnet_hiddens": [], "post_fcnet_activation": "relu", "post_fcnet_weights_initializer": null, "post_fcnet_weights_initializer_config": null, "post_fcnet_bias_initializer": null, "post_fcnet_bias_initializer_config": null, "free_log_std": false, "log_std_clip_param": 20.0, "no_final_linear": false, "vf_share_layers": false, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "lstm_weights_initializer": null, "lstm_weights_initializer_config": null, "lstm_bias_initializer": null, "lstm_bias_initializer_config": null, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "attention_use_n_prev_actions": 0, "attention_use_n_prev_rewards": 0, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": null, "custom_model_config": {}, "custom_action_dist": null, "custom_preprocessor": null, "encoder_latent_dim": null, "always_check_shapes": false, "lstm_use_prev_action_reward": -1, "_use_default_native_models": -1, "_disable_preprocessor_api": false, "_disable_action_flattening": false}, "_learner_connector": null, "add_default_connectors_to_learner_pipeline": true, "learner_config_dict": {}, "optimizer": {}, "_learner_class": null, "callbacks_on_algorithm_init": null, "callbacks_on_env_runners_recreated": null, "callbacks_on_offline_eval_runners_recreated": null, "callbacks_on_checkpoint_loaded": null, "callbacks_on_environment_created": null, "callbacks_on_episode_created": null, "callbacks_on_episode_start": null, "callbacks_on_episode_step": null, "callbacks_on_episode_end": null, "callbacks_on_evaluate_start": null, "callbacks_on_evaluate_end": null, "callbacks_on_evaluate_offline_start": null, "callbacks_on_evaluate_offline_end": null, "callbacks_on_sample_end": null, "callbacks_on_train_result": null, "explore": true, "enable_rl_module_and_learner": true, "enable_env_runner_and_connector_v2": true, "_prior_exploration_config": {"type": "StochasticSampling"}, "count_steps_by": "env_steps", "policy_map_capacity": 100, "policy_mapping_fn": "<function AlgorithmConfig.DEFAULT_POLICY_MAPPING_FN at 0x3888f18a0>", "policies_to_train": null, "policy_states_are_swappable": false, "observation_fn": null, "offline_data_class": null, "input_read_method": "read_parquet", "input_read_method_kwargs": {}, "input_read_schema": {}, "input_read_episodes": false, "input_read_sample_batches": false, "input_read_batch_size": null, "input_filesystem": null, "input_filesystem_kwargs": {}, "input_compress_columns": ["obs", "new_obs"], "input_spaces_jsonable": true, "materialize_data": false, "materialize_mapped_data": true, "map_batches_kwargs": {}, "iter_batches_kwargs": {}, "ignore_final_observation": false, "prelearner_class": null, "prelearner_buffer_class": null, "prelearner_buffer_kwargs": {}, "prelearner_module_synch_period": 10, "dataset_num_iters_per_learner": null, "input_config": {}, "actions_in_input_normalized": false, "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_config": {}, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "output_max_rows_per_file": null, "output_write_remaining_data": false, "output_write_method": "write_parquet", "output_write_method_kwargs": {}, "output_filesystem": null, "output_filesystem_kwargs": {}, "output_write_episodes": true, "offline_sampling": false, "evaluation_interval": 1, "evaluation_duration": 20, "evaluation_duration_unit": "episodes", "evaluation_sample_timeout_s": 120.0, "evaluation_auto_duration_min_env_steps_per_sample": 100, "evaluation_auto_duration_max_env_steps_per_sample": 2000, "evaluation_parallel_to_training": false, "evaluation_force_reset_envs_before_iteration": true, "evaluation_config": null, "off_policy_estimation_methods": {}, "ope_split_batch_by_episode": true, "evaluation_num_env_runners": 1, "in_evaluation": false, "sync_filters_on_rollout_workers_timeout_s": 10.0, "offline_evaluation_interval": null, "num_offline_eval_runners": 0, "offline_loss_for_module_fn": null, "offline_evaluation_duration": 1, "offline_evaluation_parallel_to_training": false, "offline_evaluation_timeout_s": 120.0, "num_cpus_per_offline_eval_runner": 1, "num_gpus_per_offline_eval_runner": 0, "custom_resources_per_offline_eval_runner": {}, "restart_failed_offline_eval_runners": true, "ignore_offline_eval_runner_failures": false, "max_num_offline_eval_runner_restarts": 1000, "offline_eval_runner_restore_timeout_s": 1800.0, "max_requests_in_flight_per_offline_eval_runner": 1, "validate_offline_eval_runners_after_construction": true, "offline_eval_runner_health_probe_timeout_s": 30.0, "offline_eval_rl_module_inference_only": false, "broadcast_offline_eval_runner_states": false, "offline_eval_batch_size_per_runner": 256, "dataset_num_iters_per_eval_runner": 1, "keep_per_episode_custom_metrics": false, "metrics_episode_collection_timeout_s": 60.0, "metrics_num_episodes_for_smoothing": 100, "min_time_s_per_iteration": null, "min_train_timesteps_per_iteration": 0, "min_sample_timesteps_per_iteration": 0, "log_gradients": true, "export_native_model_files": false, "checkpoint_trainable_policies_only": false, "logger_creator": null, "logger_config": null, "log_level": "WARN", "log_sys_usage": true, "fake_sampler": false, "seed": 1, "restart_failed_env_runners": true, "ignore_env_runner_failures": false, "max_num_env_runner_restarts": 1000, "delay_between_env_runner_restarts_s": 60.0, "restart_failed_sub_environments": false, "num_consecutive_env_runner_failures_tolerance": 100, "env_runner_health_probe_timeout_s": 30.0, "env_runner_restore_timeout_s": 1800.0, "_model_config": {}, "_rl_module_spec": "RLModuleSpec(module_class=None, observation_space=None, action_space=None, inference_only=False, learner_only=False, model_config=DefaultModelConfig(fcnet_hiddens=[60, 90], fcnet_activation='tanh', fcnet_kernel_initializer=None, fcnet_kernel_initializer_kwargs=None, fcnet_bias_initializer=None, fcnet_bias_initializer_kwargs=None, conv_filters=None, conv_activation='relu', conv_kernel_initializer=None, conv_kernel_initializer_kwargs=None, conv_bias_initializer=None, conv_bias_initializer_kwargs=None, head_fcnet_hiddens=[], head_fcnet_activation='relu', head_fcnet_kernel_initializer=None, head_fcnet_kernel_initializer_kwargs=None, head_fcnet_bias_initializer=None, head_fcnet_bias_initializer_kwargs=None, free_log_std=False, log_std_clip_param=20.0, vf_share_layers=True, use_lstm=False, max_seq_len=20, lstm_cell_size=256, lstm_use_prev_action=False, lstm_use_prev_reward=False, lstm_kernel_initializer=None, lstm_kernel_initializer_kwargs=None, lstm_bias_initializer=None, lstm_bias_initializer_kwargs=None), catalog_class=None, load_state_path=None, model_config_dict=None)", "algorithm_config_overrides_per_module": {}, "_per_module_overrides": {}, "_validate_config": true, "_use_msgpack_checkpoints": false, "_torch_grad_scaler_class": null, "_torch_lr_scheduler_classes": null, "_tf_policy_handles_more_than_one_loss": false, "_disable_preprocessor_api": false, "_disable_action_flattening": false, "_disable_initialize_loss_from_dummy_batch": false, "_dont_auto_sync_env_runner_states": false, "env_task_fn": -1, "enable_connectors": -1, "simple_optimizer": false, "policy_map_cache": -1, "worker_cls": -1, "synchronize_filters": -1, "enable_async_evaluation": -1, "custom_async_evaluation_function": -1, "_enable_rl_module_api": -1, "auto_wrap_old_gym_envs": -1, "always_attach_evaluation_results": -1, "replay_sequence_length": null, "_disable_execution_plan_api": -1, "use_critic": true, "use_gae": true, "use_kl_loss": true, "kl_coeff": 0.7464963036515, "kl_target": 0.0270990929592, "vf_loss_coeff": 0.6688075857018, "entropy_coeff": 0.0090570820258, "clip_param": 0.1221781641624, "vf_clip_param": 0.1027808522125, "entropy_coeff_schedule": null, "lr_schedule": null, "sgd_minibatch_size": -1, "vf_share_layers": -1, "__stdout_file__": null, "__stderr_file__": null, "lambda": 0.9099046732075, "input": "sampler", "policies": {"default_policy": [null, null, null, null]}, "callbacks": "<class 'ray.rllib.callbacks.callbacks.RLlibCallback'>", "create_env_on_driver": false, "custom_eval_function": null, "framework": "torch"}, "time_since_restore": 35.424365282058716, "iterations_since_restore": 19, "perf": {"cpu_util_percent": 21.8, "ram_util_percent": 81.35}}
{"timers": {"training_iteration": 1.8876390019533869, "restore_env_runners": 1.1608288857897442e-05, "training_step": 1.8874759812564743, "env_runner_sampling_timer": 1.7610333935022573, "learner_update_timer": 0.12300123262933214, "synch_weights": 0.0007902808687690978, "restore_eval_env_runners": 9.299815262822077e-06, "evaluation_iteration": 0.1282532338248899, "synch_eval_env_connectors": 0.00012417618655279376, "synch_env_connectors": 5.555513721978035e-06}, "env_runners": {"env_to_module_connector": {"timers": {"connectors": {"add_observations_from_episodes_to_batch": 3.0481714349654746e-06, "batch_individual_items": 6.44361085507393e-06, "numpy_to_tensor": 8.841586261560979e-06, "add_states_from_episodes_to_batch": 1.7589372066167254e-06, "add_time_dim_to_batch_and_zero_pad": 2.4013514362324576e-06}}, "connector_pipeline_timer": 4.416425739567764e-05}, "episode_len_mean": 20.0, "sample": 0.004975851637056232, "module_to_env_connector": {"timers": {"connectors": {"get_actions": 4.053948573559264e-05, "un_batch_to_individual_items": 5.5575957028288775e-06, "normalize_and_clip_actions": 9.660074431207446e-06, "listify_data_for_vector_env": 1.1246175133412355e-05, "remove_single_ts_time_rank_from_batch": 5.998896925516419e-07, "tensor_to_numpy": 1.3612888093239866e-05}}, "connector_pipeline_timer": 0.00010700482854067836}, "num_module_steps_sampled": {"default_policy": 5000.0}, "num_agent_steps_sampled_lifetime": {"default_agent": -11105000.0}, "num_env_steps_sampled": 5000.0, "episode_duration_sec_mean": 0.004668723191134634, "num_agent_steps_sampled": {"default_agent": 5000.0}, "env_to_module_sum_episodes_length_out": 10.36823839457432, "num_episodes": 250.0, "time_between_sampling": 0.0018674685595237426, "env_step_timer": 1.408674283159139e-05, "agent_episode_returns_mean": {"default_agent": 6.940000000000001}, "episode_return_mean": 6.940000000000001, "num_module_steps_sampled_lifetime": {"default_policy": -11105000.0}, "env_to_module_sum_episodes_length_in": 10.36823839457432, "episode_return_max": 9.5, "num_episodes_lifetime": -555250.0, "weights_seq_no": 19.0, "module_episode_returns_mean": {"default_policy": 6.940000000000001}, "episode_return_min": -10.5, "episode_len_min": 20, "episode_len_max": 20, "env_reset_timer": 3.7948704491025334e-05, "num_env_steps_sampled_lifetime": -11105000.0, "rlmodule_inference_timer": 2.8877469830977388e-05, "num_env_steps_sampled_lifetime_throughput": 3631.6250506327597}, "learners": {"__all_modules__": {"num_module_steps_trained_lifetime": 120000, "learner_connector_sum_episodes_length_in": 5000.0, "learner_connector": {"timers": {"connectors": {"add_observations_from_episodes_to_batch": 0.0008438156128960717, "batch_individual_items": 0.039056638721734885, "general_advantage_estimation": 0.007780536306128182, "add_one_ts_to_episodes_and_truncate": 0.009154580227730401, "add_time_dim_to_batch_and_zero_pad": 1.5432528657129212e-05, "add_states_from_episodes_to_batch": 3.99308134013319e-06, "add_columns_from_episodes_to_train_batch": 0.03601524094886705, "numpy_to_tensor": 7.282284548289262e-05}}, "connector_pipeline_timer": 0.09310281370199093}, "num_env_steps_trained": 31500, "num_env_steps_trained_lifetime": 630000, "num_non_trainable_parameters": 0, "learner_connector_sum_episodes_length_out": 5250.0, "num_module_steps_trained": 6000, "num_trainable_parameters": 6003, "num_env_steps_trained_lifetime_throughput": 1813886.7313635882, "num_module_steps_trained_throughput": 346223.30458026746, "num_module_steps_trained_lifetime_throughput": 345893.8709576825}, "default_policy": {"vf_loss": 0.10278083384037018, "curr_entropy_coeff": 0.0090570820258, "mean_kl_loss": 0.0002637100697029382, "weights_seq_no": 20.0, "module_train_batch_size_mean": 1000.0, "vf_explained_var": -0.02492392063140869, "gradients_default_optimizer_global_norm": 0.0137735391035676, "diff_num_grad_updates_vs_sampler_policy": 1.0, "default_optimizer_learning_rate": 0.0002847858517, "curr_kl_coeff": 7.119143674572115e-07, "num_module_steps_trained": 6000, "num_trainable_parameters": 6003, "total_loss": -0.021787814795970917, "num_module_steps_trained_lifetime": 120000, "vf_loss_unclipped": 26.72565269470215, "policy_loss": -0.08537109941244125, "entropy": 0.5694254040718079, "num_module_steps_trained_lifetime_throughput": 346145.9858674532}}, "num_training_step_calls_per_iteration": 1, "evaluation": {"env_runners": {"sample": 0.1201286698060959, "num_module_steps_sampled": {"default_policy": 400}, "env_to_module_connector": {"timers": {"connectors": {"add_observations_from_episodes_to_batch": 3.110067441746142e-06, "numpy_to_tensor": 8.168135877720132e-06, "batch_individual_items": 6.046318194471795e-06, "add_time_dim_to_batch_and_zero_pad": 2.2106890695400452e-06, "add_states_from_episodes_to_batch": 1.6038343941772508e-06}}, "connector_pipeline_timer": 4.257483844554886e-05}, "num_agent_steps_sampled_lifetime": {"default_agent": 8000}, "module_to_env_connector": {"timers": {"connectors": {"tensor_to_numpy": 1.2857021983796212e-05, "get_actions": 3.597236401037268e-05, "listify_data_for_vector_env": 1.082311601144441e-05, "normalize_and_clip_actions": 9.275500230147962e-06, "remove_single_ts_time_rank_from_batch": 5.623715831578082e-07, "un_batch_to_individual_items": 5.303977886121783e-06}}, "connector_pipeline_timer": 0.00010058174117408613}, "agent_episode_returns_mean": {"default_agent": -1.0}, "num_env_steps_sampled": 400, "env_to_module_sum_episodes_length_out": 10.368238394574323, "num_episodes": 20, "num_agent_steps_sampled": {"default_agent": 400}, "num_episodes_lifetime": 400, "weights_seq_no": 20.0, "env_reset_timer": 0.00019040832663619374, "module_episode_returns_mean": {"default_policy": -1.0}, "rlmodule_inference_timer": 2.734610271607445e-05, "env_to_module_sum_episodes_length_in": 10.368238394574323, "episode_return_max": 11.5, "episode_len_min": 20, "episode_len_mean": 20.0, "episode_duration_sec_mean": 0.004574065470369533, "env_step_timer": 1.3706213883421444e-05, "episode_return_mean": -1.0, "num_module_steps_sampled_lifetime": {"default_policy": 8000}, "episode_return_min": -12.5, "episode_len_max": 20, "num_env_steps_sampled_lifetime": 100400, "time_between_sampling": 1.8577602964525335}, "num_healthy_workers": 1, "actor_manager_num_outstanding_async_reqs": 0, "num_remote_worker_restarts": 0}, "num_env_steps_sampled_lifetime": -11105000.0, "fault_tolerance": {"num_healthy_workers": 0, "num_remote_worker_restarts": 0}, "env_runner_group": {"actor_manager_num_outstanding_async_reqs": 0}, "done": true, "training_iteration": 20, "trial_id": "43778_00000", "date": "2025-08-11_19-20-42", "timestamp": 1754932842, "time_this_iter_s": 1.6223361492156982, "time_total_s": 37.046701431274414, "pid": 14172, "hostname": "Mac", "node_ip": "127.0.0.1", "config": {"exploration_config": {}, "extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "placement_strategy": "PACK", "num_gpus": 0, "_fake_gpus": false, "num_cpus_for_main_process": 2, "eager_tracing": true, "eager_max_retraces": 20, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "torch_compile_learner": false, "torch_compile_learner_what_to_compile": "forward_train", "torch_compile_learner_dynamo_backend": "aot_eager", "torch_compile_learner_dynamo_mode": null, "torch_compile_worker": false, "torch_compile_worker_dynamo_backend": "aot_eager", "torch_compile_worker_dynamo_mode": null, "torch_ddp_kwargs": {}, "torch_skip_nan_gradients": false, "env": "Umbrella", "env_config": {}, "observation_space": null, "action_space": null, "clip_rewards": null, "normalize_actions": true, "clip_actions": false, "_is_atari": null, "disable_env_checking": false, "render_env": false, "action_mask_key": "action_mask", "env_runner_cls": null, "num_env_runners": 0, "create_local_env_runner": true, "num_envs_per_env_runner": 1, "gym_env_vectorize_mode": "SYNC", "num_cpus_per_env_runner": 1, "num_gpus_per_env_runner": 0, "custom_resources_per_env_runner": {}, "validate_env_runners_after_construction": true, "episodes_to_numpy": true, "max_requests_in_flight_per_env_runner": 1, "sample_timeout_s": 60.0, "_env_to_module_connector": null, "add_default_connectors_to_env_to_module_pipeline": true, "_module_to_env_connector": null, "add_default_connectors_to_module_to_env_pipeline": true, "merge_env_runner_states": "training_only", "broadcast_env_runner_states": true, "episode_lookback_horizon": 1, "rollout_fragment_length": "auto", "batch_mode": "complete_episodes", "compress_observations": false, "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "enable_tf1_exec_eagerly": false, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "preprocessor_pref": "deepmind", "observation_filter": "NoFilter", "update_worker_filter_stats": true, "use_worker_filter_stats": true, "sampler_perf_stats_ema_coef": null, "_is_online": true, "num_learners": 0, "num_gpus_per_learner": 0, "num_cpus_per_learner": "auto", "num_aggregator_actors_per_learner": 0, "max_requests_in_flight_per_aggregator_actor": 3, "local_gpu_idx": 0, "max_requests_in_flight_per_learner": 3, "gamma": 1, "lr": 0.0002847858517, "grad_clip": 0.5, "grad_clip_by": "global_norm", "_train_batch_size_per_learner": 5000, "train_batch_size": 4000, "num_epochs": 1, "minibatch_size": 1000, "shuffle_batch_per_epoch": true, "model": {"fcnet_hiddens": [256, 256], "fcnet_activation": "tanh", "fcnet_weights_initializer": null, "fcnet_weights_initializer_config": null, "fcnet_bias_initializer": null, "fcnet_bias_initializer_config": null, "conv_filters": null, "conv_activation": "relu", "conv_kernel_initializer": null, "conv_kernel_initializer_config": null, "conv_bias_initializer": null, "conv_bias_initializer_config": null, "conv_transpose_kernel_initializer": null, "conv_transpose_kernel_initializer_config": null, "conv_transpose_bias_initializer": null, "conv_transpose_bias_initializer_config": null, "post_fcnet_hiddens": [], "post_fcnet_activation": "relu", "post_fcnet_weights_initializer": null, "post_fcnet_weights_initializer_config": null, "post_fcnet_bias_initializer": null, "post_fcnet_bias_initializer_config": null, "free_log_std": false, "log_std_clip_param": 20.0, "no_final_linear": false, "vf_share_layers": false, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "lstm_weights_initializer": null, "lstm_weights_initializer_config": null, "lstm_bias_initializer": null, "lstm_bias_initializer_config": null, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "attention_use_n_prev_actions": 0, "attention_use_n_prev_rewards": 0, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": null, "custom_model_config": {}, "custom_action_dist": null, "custom_preprocessor": null, "encoder_latent_dim": null, "always_check_shapes": false, "lstm_use_prev_action_reward": -1, "_use_default_native_models": -1, "_disable_preprocessor_api": false, "_disable_action_flattening": false}, "_learner_connector": null, "add_default_connectors_to_learner_pipeline": true, "learner_config_dict": {}, "optimizer": {}, "_learner_class": null, "callbacks_on_algorithm_init": null, "callbacks_on_env_runners_recreated": null, "callbacks_on_offline_eval_runners_recreated": null, "callbacks_on_checkpoint_loaded": null, "callbacks_on_environment_created": null, "callbacks_on_episode_created": null, "callbacks_on_episode_start": null, "callbacks_on_episode_step": null, "callbacks_on_episode_end": null, "callbacks_on_evaluate_start": null, "callbacks_on_evaluate_end": null, "callbacks_on_evaluate_offline_start": null, "callbacks_on_evaluate_offline_end": null, "callbacks_on_sample_end": null, "callbacks_on_train_result": null, "explore": true, "enable_rl_module_and_learner": true, "enable_env_runner_and_connector_v2": true, "_prior_exploration_config": {"type": "StochasticSampling"}, "count_steps_by": "env_steps", "policy_map_capacity": 100, "policy_mapping_fn": "<function AlgorithmConfig.DEFAULT_POLICY_MAPPING_FN at 0x3888f18a0>", "policies_to_train": null, "policy_states_are_swappable": false, "observation_fn": null, "offline_data_class": null, "input_read_method": "read_parquet", "input_read_method_kwargs": {}, "input_read_schema": {}, "input_read_episodes": false, "input_read_sample_batches": false, "input_read_batch_size": null, "input_filesystem": null, "input_filesystem_kwargs": {}, "input_compress_columns": ["obs", "new_obs"], "input_spaces_jsonable": true, "materialize_data": false, "materialize_mapped_data": true, "map_batches_kwargs": {}, "iter_batches_kwargs": {}, "ignore_final_observation": false, "prelearner_class": null, "prelearner_buffer_class": null, "prelearner_buffer_kwargs": {}, "prelearner_module_synch_period": 10, "dataset_num_iters_per_learner": null, "input_config": {}, "actions_in_input_normalized": false, "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_config": {}, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "output_max_rows_per_file": null, "output_write_remaining_data": false, "output_write_method": "write_parquet", "output_write_method_kwargs": {}, "output_filesystem": null, "output_filesystem_kwargs": {}, "output_write_episodes": true, "offline_sampling": false, "evaluation_interval": 1, "evaluation_duration": 20, "evaluation_duration_unit": "episodes", "evaluation_sample_timeout_s": 120.0, "evaluation_auto_duration_min_env_steps_per_sample": 100, "evaluation_auto_duration_max_env_steps_per_sample": 2000, "evaluation_parallel_to_training": false, "evaluation_force_reset_envs_before_iteration": true, "evaluation_config": null, "off_policy_estimation_methods": {}, "ope_split_batch_by_episode": true, "evaluation_num_env_runners": 1, "in_evaluation": false, "sync_filters_on_rollout_workers_timeout_s": 10.0, "offline_evaluation_interval": null, "num_offline_eval_runners": 0, "offline_loss_for_module_fn": null, "offline_evaluation_duration": 1, "offline_evaluation_parallel_to_training": false, "offline_evaluation_timeout_s": 120.0, "num_cpus_per_offline_eval_runner": 1, "num_gpus_per_offline_eval_runner": 0, "custom_resources_per_offline_eval_runner": {}, "restart_failed_offline_eval_runners": true, "ignore_offline_eval_runner_failures": false, "max_num_offline_eval_runner_restarts": 1000, "offline_eval_runner_restore_timeout_s": 1800.0, "max_requests_in_flight_per_offline_eval_runner": 1, "validate_offline_eval_runners_after_construction": true, "offline_eval_runner_health_probe_timeout_s": 30.0, "offline_eval_rl_module_inference_only": false, "broadcast_offline_eval_runner_states": false, "offline_eval_batch_size_per_runner": 256, "dataset_num_iters_per_eval_runner": 1, "keep_per_episode_custom_metrics": false, "metrics_episode_collection_timeout_s": 60.0, "metrics_num_episodes_for_smoothing": 100, "min_time_s_per_iteration": null, "min_train_timesteps_per_iteration": 0, "min_sample_timesteps_per_iteration": 0, "log_gradients": true, "export_native_model_files": false, "checkpoint_trainable_policies_only": false, "logger_creator": null, "logger_config": null, "log_level": "WARN", "log_sys_usage": true, "fake_sampler": false, "seed": 1, "restart_failed_env_runners": true, "ignore_env_runner_failures": false, "max_num_env_runner_restarts": 1000, "delay_between_env_runner_restarts_s": 60.0, "restart_failed_sub_environments": false, "num_consecutive_env_runner_failures_tolerance": 100, "env_runner_health_probe_timeout_s": 30.0, "env_runner_restore_timeout_s": 1800.0, "_model_config": {}, "_rl_module_spec": "RLModuleSpec(module_class=None, observation_space=None, action_space=None, inference_only=False, learner_only=False, model_config=DefaultModelConfig(fcnet_hiddens=[60, 90], fcnet_activation='tanh', fcnet_kernel_initializer=None, fcnet_kernel_initializer_kwargs=None, fcnet_bias_initializer=None, fcnet_bias_initializer_kwargs=None, conv_filters=None, conv_activation='relu', conv_kernel_initializer=None, conv_kernel_initializer_kwargs=None, conv_bias_initializer=None, conv_bias_initializer_kwargs=None, head_fcnet_hiddens=[], head_fcnet_activation='relu', head_fcnet_kernel_initializer=None, head_fcnet_kernel_initializer_kwargs=None, head_fcnet_bias_initializer=None, head_fcnet_bias_initializer_kwargs=None, free_log_std=False, log_std_clip_param=20.0, vf_share_layers=True, use_lstm=False, max_seq_len=20, lstm_cell_size=256, lstm_use_prev_action=False, lstm_use_prev_reward=False, lstm_kernel_initializer=None, lstm_kernel_initializer_kwargs=None, lstm_bias_initializer=None, lstm_bias_initializer_kwargs=None), catalog_class=None, load_state_path=None, model_config_dict=None)", "algorithm_config_overrides_per_module": {}, "_per_module_overrides": {}, "_validate_config": true, "_use_msgpack_checkpoints": false, "_torch_grad_scaler_class": null, "_torch_lr_scheduler_classes": null, "_tf_policy_handles_more_than_one_loss": false, "_disable_preprocessor_api": false, "_disable_action_flattening": false, "_disable_initialize_loss_from_dummy_batch": false, "_dont_auto_sync_env_runner_states": false, "env_task_fn": -1, "enable_connectors": -1, "simple_optimizer": false, "policy_map_cache": -1, "worker_cls": -1, "synchronize_filters": -1, "enable_async_evaluation": -1, "custom_async_evaluation_function": -1, "_enable_rl_module_api": -1, "auto_wrap_old_gym_envs": -1, "always_attach_evaluation_results": -1, "replay_sequence_length": null, "_disable_execution_plan_api": -1, "use_critic": true, "use_gae": true, "use_kl_loss": true, "kl_coeff": 0.7464963036515, "kl_target": 0.0270990929592, "vf_loss_coeff": 0.6688075857018, "entropy_coeff": 0.0090570820258, "clip_param": 0.1221781641624, "vf_clip_param": 0.1027808522125, "entropy_coeff_schedule": null, "lr_schedule": null, "sgd_minibatch_size": -1, "vf_share_layers": -1, "__stdout_file__": null, "__stderr_file__": null, "lambda": 0.9099046732075, "input": "sampler", "policies": {"default_policy": [null, null, null, null]}, "callbacks": "<class 'ray.rllib.callbacks.callbacks.RLlibCallback'>", "create_env_on_driver": false, "custom_eval_function": null, "framework": "torch"}, "time_since_restore": 37.046701431274414, "iterations_since_restore": 20, "perf": {"cpu_util_percent": 48.25, "ram_util_percent": 81.75}}
