{"timers": {"training_iteration": 2.7525092919822782, "restore_env_runners": 1.2209056876599789e-05, "training_step": 2.7523058749502525, "env_runner_sampling_timer": 2.5699543330119923, "learner_update_timer": 0.1776989169884473, "synch_weights": 0.0009949170053005219}, "env_runners": {"num_env_steps_sampled_lifetime": 627500.0, "module_to_env_connector": {"timers": {"connectors": {"tensor_to_numpy": 2.5542867124781565e-05, "normalize_and_clip_actions": 2.5953030076039034e-05, "un_batch_to_individual_items": 9.158549630727342e-06, "listify_data_for_vector_env": 1.893863928033747e-05, "remove_single_ts_time_rank_from_batch": 9.523423130047654e-07, "get_actions": 9.615601212617411e-05}}, "connector_pipeline_timer": 0.00021922077639313197}, "episode_len_min": 20, "episode_return_max": 9.5, "num_episodes": 250.0, "num_agent_steps_sampled": {"default_agent": 5000.0}, "env_to_module_connector": {"timers": {"connectors": {"add_states_from_episodes_to_batch": 2.796708416748497e-06, "numpy_to_tensor": 1.7974835703838092e-05, "batch_individual_items": 1.6485635056685016e-05, "add_time_dim_to_batch_and_zero_pad": 3.817237570351223e-06, "add_observations_from_episodes_to_batch": 5.061374809632259e-06}}, "connector_pipeline_timer": 8.627396699866652e-05}, "env_step_timer": 2.596930177381677e-05, "env_reset_timer": 0.0002242782049238845, "episode_duration_sec_mean": 0.008606824123766272, "episode_return_min": -10.5, "sample": 0.015651619806928026, "episode_len_max": 20, "module_episode_returns_mean": {"default_policy": -0.09999999999999998}, "agent_episode_returns_mean": {"default_agent": -0.09999999999999998}, "weights_seq_no": 0.0, "num_agent_steps_sampled_lifetime": {"default_agent": 627500.0}, "env_to_module_sum_episodes_length_in": 10.191744832559449, "env_to_module_sum_episodes_length_out": 10.191744832559449, "num_episodes_lifetime": 31375.0, "episode_return_mean": -0.09999999999999998, "time_between_sampling": 0.0022495817790004987, "num_module_steps_sampled": {"default_policy": 5000.0}, "num_module_steps_sampled_lifetime": {"default_policy": 627500.0}, "rlmodule_inference_timer": 8.751793819967815e-05, "num_env_steps_sampled": 5000.0, "episode_len_mean": 20.0, "num_env_steps_sampled_lifetime_throughput": 2263.9276218245163}, "learners": {"__all_modules__": {"num_module_steps_trained_lifetime": 6000, "learner_connector": {"timers": {"connectors": {"add_observations_from_episodes_to_batch": 0.00092224997933954, "add_states_from_episodes_to_batch": 5.08397351950407e-06, "add_columns_from_episodes_to_train_batch": 0.040293792029842734, "batch_individual_items": 0.0329781660111621, "add_time_dim_to_batch_and_zero_pad": 1.3584038242697716e-05, "numpy_to_tensor": 7.50409672036767e-05, "general_advantage_estimation": 0.012954500038176775, "add_one_ts_to_episodes_and_truncate": 0.008535041939467192}}, "connector_pipeline_timer": 0.09595712507143617}, "num_module_steps_trained": 6000, "learner_connector_sum_episodes_length_in": 5000, "num_non_trainable_parameters": 0, "num_env_steps_trained": 31500, "num_env_steps_trained_lifetime": 31500, "learner_connector_sum_episodes_length_out": 5250, "num_trainable_parameters": 6003, "num_env_steps_trained_lifetime_throughput": 740440.8638985093, "num_module_steps_trained_throughput": 141853.4795924271, "num_module_steps_trained_lifetime_throughput": 141847.00488485576}, "default_policy": {"num_module_steps_trained_lifetime": 6000, "num_trainable_parameters": 6003, "entropy": 0.6927757263183594, "vf_explained_var": -0.011646151542663574, "num_module_steps_trained": 6000, "weights_seq_no": 1.0, "curr_entropy_coeff": 0.0090570820258, "diff_num_grad_updates_vs_sampler_policy": 1.0, "gradients_default_optimizer_global_norm": 0.026657981798052788, "curr_kl_coeff": 0.3732481598854065, "default_optimizer_learning_rate": 0.0002847858517, "vf_loss_unclipped": 28.586095809936523, "total_loss": 0.015051513910293579, "mean_kl_loss": 6.952471449039876e-05, "policy_loss": -0.0474664680659771, "module_train_batch_size_mean": 1000.0, "vf_loss": 0.10278083384037018, "num_module_steps_trained_lifetime_throughput": 142352.53600202818}}, "num_training_step_calls_per_iteration": 1, "num_env_steps_sampled_lifetime": 627500.0, "evaluation": {"env_runners": {"num_module_steps_sampled": {"default_policy": 400}, "num_episodes_lifetime": 20, "rlmodule_inference_timer": 5.502269173628235e-05, "module_to_env_connector": {"timers": {"connectors": {"remove_single_ts_time_rank_from_batch": 8.346791572249036e-07, "normalize_and_clip_actions": 1.6035782602748128e-05, "listify_data_for_vector_env": 1.8173269934360153e-05, "un_batch_to_individual_items": 7.910720639590523e-06, "get_actions": 7.215429040343833e-05, "tensor_to_numpy": 2.568397005058997e-05}}, "connector_pipeline_timer": 0.0001812553269849473}, "module_episode_returns_mean": {"default_policy": -4.8}, "agent_episode_returns_mean": {"default_agent": -4.8}, "env_reset_timer": 0.0002014579949900508, "episode_len_max": 20, "num_agent_steps_sampled_lifetime": {"default_agent": 400}, "episode_return_mean": -4.8, "num_agent_steps_sampled": {"default_agent": 400}, "num_env_steps_sampled": 400, "episode_len_mean": 20.0, "num_env_steps_sampled_lifetime": 5400, "episode_return_max": 11.5, "env_to_module_connector": {"connector_pipeline_timer": 7.089726177749827e-05, "timers": {"connectors": {"numpy_to_tensor": 1.794014392925391e-05, "add_observations_from_episodes_to_batch": 4.256750701727517e-06, "batch_individual_items": 1.0200839452278491e-05, "add_states_from_episodes_to_batch": 2.047083900888796e-06, "add_time_dim_to_batch_and_zero_pad": 3.3603815271464207e-06}}}, "episode_len_min": 20, "env_to_module_sum_episodes_length_in": 10.216013141322508, "num_episodes": 20, "sample": 0.18862037500366569, "weights_seq_no": 1.0, "env_to_module_sum_episodes_length_out": 10.216013141322508, "env_step_timer": 2.4860521821436365e-05, "episode_duration_sec_mean": 0.00866962515283376, "episode_return_min": -12.5, "num_module_steps_sampled_lifetime": {"default_policy": 400}}, "num_healthy_workers": 1, "actor_manager_num_outstanding_async_reqs": 0, "num_remote_worker_restarts": 0}, "fault_tolerance": {"num_healthy_workers": 0, "num_remote_worker_restarts": 0}, "env_runner_group": {"actor_manager_num_outstanding_async_reqs": 0}, "done": false, "training_iteration": 1, "trial_id": "4380e_00000", "date": "2025-08-11_19-34-14", "timestamp": 1754933654, "time_this_iter_s": 2.954237222671509, "time_total_s": 2.954237222671509, "pid": 26823, "hostname": "Mac", "node_ip": "127.0.0.1", "config": {"exploration_config": {}, "extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "placement_strategy": "PACK", "num_gpus": 0, "_fake_gpus": false, "num_cpus_for_main_process": 2, "eager_tracing": true, "eager_max_retraces": 20, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "torch_compile_learner": false, "torch_compile_learner_what_to_compile": "forward_train", "torch_compile_learner_dynamo_backend": "aot_eager", "torch_compile_learner_dynamo_mode": null, "torch_compile_worker": false, "torch_compile_worker_dynamo_backend": "aot_eager", "torch_compile_worker_dynamo_mode": null, "torch_ddp_kwargs": {}, "torch_skip_nan_gradients": false, "env": "Umbrella", "env_config": {}, "observation_space": null, "action_space": null, "clip_rewards": null, "normalize_actions": true, "clip_actions": false, "_is_atari": null, "disable_env_checking": false, "render_env": false, "action_mask_key": "action_mask", "env_runner_cls": null, "num_env_runners": 0, "create_local_env_runner": true, "num_envs_per_env_runner": 1, "gym_env_vectorize_mode": "SYNC", "num_cpus_per_env_runner": 1, "num_gpus_per_env_runner": 0, "custom_resources_per_env_runner": {}, "validate_env_runners_after_construction": true, "episodes_to_numpy": true, "max_requests_in_flight_per_env_runner": 1, "sample_timeout_s": 60.0, "_env_to_module_connector": null, "add_default_connectors_to_env_to_module_pipeline": true, "_module_to_env_connector": null, "add_default_connectors_to_module_to_env_pipeline": true, "merge_env_runner_states": "training_only", "broadcast_env_runner_states": true, "episode_lookback_horizon": 1, "rollout_fragment_length": "auto", "batch_mode": "complete_episodes", "compress_observations": false, "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "enable_tf1_exec_eagerly": false, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "preprocessor_pref": "deepmind", "observation_filter": "NoFilter", "update_worker_filter_stats": true, "use_worker_filter_stats": true, "sampler_perf_stats_ema_coef": null, "_is_online": true, "num_learners": 0, "num_gpus_per_learner": 0, "num_cpus_per_learner": "auto", "num_aggregator_actors_per_learner": 0, "max_requests_in_flight_per_aggregator_actor": 3, "local_gpu_idx": 0, "max_requests_in_flight_per_learner": 3, "gamma": 1, "lr": 0.0002847858517, "grad_clip": 0.5, "grad_clip_by": "global_norm", "_train_batch_size_per_learner": 5000, "train_batch_size": 4000, "num_epochs": 1, "minibatch_size": 1000, "shuffle_batch_per_epoch": true, "model": {"fcnet_hiddens": [256, 256], "fcnet_activation": "tanh", "fcnet_weights_initializer": null, "fcnet_weights_initializer_config": null, "fcnet_bias_initializer": null, "fcnet_bias_initializer_config": null, "conv_filters": null, "conv_activation": "relu", "conv_kernel_initializer": null, "conv_kernel_initializer_config": null, "conv_bias_initializer": null, "conv_bias_initializer_config": null, "conv_transpose_kernel_initializer": null, "conv_transpose_kernel_initializer_config": null, "conv_transpose_bias_initializer": null, "conv_transpose_bias_initializer_config": null, "post_fcnet_hiddens": [], "post_fcnet_activation": "relu", "post_fcnet_weights_initializer": null, "post_fcnet_weights_initializer_config": null, "post_fcnet_bias_initializer": null, "post_fcnet_bias_initializer_config": null, "free_log_std": false, "log_std_clip_param": 20.0, "no_final_linear": false, "vf_share_layers": false, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "lstm_weights_initializer": null, "lstm_weights_initializer_config": null, "lstm_bias_initializer": null, "lstm_bias_initializer_config": null, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "attention_use_n_prev_actions": 0, "attention_use_n_prev_rewards": 0, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": null, "custom_model_config": {}, "custom_action_dist": null, "custom_preprocessor": null, "encoder_latent_dim": null, "always_check_shapes": false, "lstm_use_prev_action_reward": -1, "_use_default_native_models": -1, "_disable_preprocessor_api": false, "_disable_action_flattening": false}, "_learner_connector": null, "add_default_connectors_to_learner_pipeline": true, "learner_config_dict": {}, "optimizer": {}, "_learner_class": null, "callbacks_on_algorithm_init": null, "callbacks_on_env_runners_recreated": null, "callbacks_on_offline_eval_runners_recreated": null, "callbacks_on_checkpoint_loaded": null, "callbacks_on_environment_created": null, "callbacks_on_episode_created": null, "callbacks_on_episode_start": null, "callbacks_on_episode_step": null, "callbacks_on_episode_end": null, "callbacks_on_evaluate_start": null, "callbacks_on_evaluate_end": null, "callbacks_on_evaluate_offline_start": null, "callbacks_on_evaluate_offline_end": null, "callbacks_on_sample_end": null, "callbacks_on_train_result": null, "explore": true, "enable_rl_module_and_learner": true, "enable_env_runner_and_connector_v2": true, "_prior_exploration_config": {"type": "StochasticSampling"}, "count_steps_by": "env_steps", "policy_map_capacity": 100, "policy_mapping_fn": "<function AlgorithmConfig.DEFAULT_POLICY_MAPPING_FN at 0x14cce9b20>", "policies_to_train": null, "policy_states_are_swappable": false, "observation_fn": null, "offline_data_class": null, "input_read_method": "read_parquet", "input_read_method_kwargs": {}, "input_read_schema": {}, "input_read_episodes": false, "input_read_sample_batches": false, "input_read_batch_size": null, "input_filesystem": null, "input_filesystem_kwargs": {}, "input_compress_columns": ["obs", "new_obs"], "input_spaces_jsonable": true, "materialize_data": false, "materialize_mapped_data": true, "map_batches_kwargs": {}, "iter_batches_kwargs": {}, "ignore_final_observation": false, "prelearner_class": null, "prelearner_buffer_class": null, "prelearner_buffer_kwargs": {}, "prelearner_module_synch_period": 10, "dataset_num_iters_per_learner": null, "input_config": {}, "actions_in_input_normalized": false, "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_config": {}, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "output_max_rows_per_file": null, "output_write_remaining_data": false, "output_write_method": "write_parquet", "output_write_method_kwargs": {}, "output_filesystem": null, "output_filesystem_kwargs": {}, "output_write_episodes": true, "offline_sampling": false, "evaluation_interval": 1, "evaluation_duration": 20, "evaluation_duration_unit": "episodes", "evaluation_sample_timeout_s": 120.0, "evaluation_auto_duration_min_env_steps_per_sample": 100, "evaluation_auto_duration_max_env_steps_per_sample": 2000, "evaluation_parallel_to_training": false, "evaluation_force_reset_envs_before_iteration": true, "evaluation_config": null, "off_policy_estimation_methods": {}, "ope_split_batch_by_episode": true, "evaluation_num_env_runners": 1, "in_evaluation": false, "sync_filters_on_rollout_workers_timeout_s": 10.0, "offline_evaluation_interval": null, "num_offline_eval_runners": 0, "offline_loss_for_module_fn": null, "offline_evaluation_duration": 1, "offline_evaluation_parallel_to_training": false, "offline_evaluation_timeout_s": 120.0, "num_cpus_per_offline_eval_runner": 1, "num_gpus_per_offline_eval_runner": 0, "custom_resources_per_offline_eval_runner": {}, "restart_failed_offline_eval_runners": true, "ignore_offline_eval_runner_failures": false, "max_num_offline_eval_runner_restarts": 1000, "offline_eval_runner_restore_timeout_s": 1800.0, "max_requests_in_flight_per_offline_eval_runner": 1, "validate_offline_eval_runners_after_construction": true, "offline_eval_runner_health_probe_timeout_s": 30.0, "offline_eval_rl_module_inference_only": false, "broadcast_offline_eval_runner_states": false, "offline_eval_batch_size_per_runner": 256, "dataset_num_iters_per_eval_runner": 1, "keep_per_episode_custom_metrics": false, "metrics_episode_collection_timeout_s": 60.0, "metrics_num_episodes_for_smoothing": 100, "min_time_s_per_iteration": null, "min_train_timesteps_per_iteration": 0, "min_sample_timesteps_per_iteration": 0, "log_gradients": true, "export_native_model_files": false, "checkpoint_trainable_policies_only": false, "logger_creator": null, "logger_config": null, "log_level": "WARN", "log_sys_usage": true, "fake_sampler": false, "seed": 1, "restart_failed_env_runners": true, "ignore_env_runner_failures": false, "max_num_env_runner_restarts": 1000, "delay_between_env_runner_restarts_s": 60.0, "restart_failed_sub_environments": false, "num_consecutive_env_runner_failures_tolerance": 100, "env_runner_health_probe_timeout_s": 30.0, "env_runner_restore_timeout_s": 1800.0, "_model_config": {}, "_rl_module_spec": "RLModuleSpec(module_class=None, observation_space=None, action_space=None, inference_only=False, learner_only=False, model_config=DefaultModelConfig(fcnet_hiddens=[60, 90], fcnet_activation='tanh', fcnet_kernel_initializer=None, fcnet_kernel_initializer_kwargs=None, fcnet_bias_initializer=None, fcnet_bias_initializer_kwargs=None, conv_filters=None, conv_activation='relu', conv_kernel_initializer=None, conv_kernel_initializer_kwargs=None, conv_bias_initializer=None, conv_bias_initializer_kwargs=None, head_fcnet_hiddens=[], head_fcnet_activation='relu', head_fcnet_kernel_initializer=None, head_fcnet_kernel_initializer_kwargs=None, head_fcnet_bias_initializer=None, head_fcnet_bias_initializer_kwargs=None, free_log_std=False, log_std_clip_param=20.0, vf_share_layers=True, use_lstm=False, max_seq_len=20, lstm_cell_size=256, lstm_use_prev_action=False, lstm_use_prev_reward=False, lstm_kernel_initializer=None, lstm_kernel_initializer_kwargs=None, lstm_bias_initializer=None, lstm_bias_initializer_kwargs=None), catalog_class=None, load_state_path=None, model_config_dict=None)", "algorithm_config_overrides_per_module": {}, "_per_module_overrides": {}, "_validate_config": true, "_use_msgpack_checkpoints": false, "_torch_grad_scaler_class": null, "_torch_lr_scheduler_classes": null, "_tf_policy_handles_more_than_one_loss": false, "_disable_preprocessor_api": false, "_disable_action_flattening": false, "_disable_initialize_loss_from_dummy_batch": false, "_dont_auto_sync_env_runner_states": false, "env_task_fn": -1, "enable_connectors": -1, "simple_optimizer": false, "policy_map_cache": -1, "worker_cls": -1, "synchronize_filters": -1, "enable_async_evaluation": -1, "custom_async_evaluation_function": -1, "_enable_rl_module_api": -1, "auto_wrap_old_gym_envs": -1, "always_attach_evaluation_results": -1, "replay_sequence_length": null, "_disable_execution_plan_api": -1, "use_critic": true, "use_gae": true, "use_kl_loss": true, "kl_coeff": 0.7464963036515, "kl_target": 0.0270990929592, "vf_loss_coeff": 0.6688075857018, "entropy_coeff": 0.0090570820258, "clip_param": 0.1221781641624, "vf_clip_param": 0.1027808522125, "entropy_coeff_schedule": null, "lr_schedule": null, "sgd_minibatch_size": -1, "vf_share_layers": -1, "__stdout_file__": null, "__stderr_file__": null, "lambda": 0.9099046732075, "input": "sampler", "policies": {"default_policy": [null, null, null, null]}, "callbacks": "<class 'ray.rllib.callbacks.callbacks.RLlibCallback'>", "create_env_on_driver": false, "custom_eval_function": null, "framework": "torch"}, "time_since_restore": 2.954237222671509, "iterations_since_restore": 1, "perf": {"cpu_util_percent": 44.36, "ram_util_percent": 77.42}}
{"timers": {"training_iteration": 2.7506531132222154, "restore_env_runners": 1.2237377231940628e-05, "training_step": 2.7504482457903214, "env_runner_sampling_timer": 2.567276846772293, "learner_update_timer": 0.17852347364882007, "synch_weights": 0.0009915103355888277, "restore_eval_env_runners": 1.7249956727027893e-05, "evaluation_iteration": 0.1982649159617722, "synch_eval_env_connectors": 0.00032408395782113075, "synch_env_connectors": 5.875015631318092e-06}, "env_runners": {"num_env_steps_sampled_lifetime": 10000.0, "module_to_env_connector": {"timers": {"connectors": {"tensor_to_numpy": 2.2834484323992175e-05, "normalize_and_clip_actions": 1.5100001301522647e-05, "un_batch_to_individual_items": 8.393630076588074e-06, "listify_data_for_vector_env": 1.7934084067466162e-05, "remove_single_ts_time_rank_from_batch": 9.007394346985472e-07, "get_actions": 7.48036486088455e-05}}, "connector_pipeline_timer": 0.00018002649416445872}, "episode_len_min": 20, "episode_return_max": 9.5, "num_episodes": 250.0, "num_agent_steps_sampled": {"default_agent": 5000.0}, "env_to_module_connector": {"timers": {"connectors": {"add_states_from_episodes_to_batch": 2.460845739852221e-06, "numpy_to_tensor": 1.5248961707665682e-05, "batch_individual_items": 1.0742657795562328e-05, "add_time_dim_to_batch_and_zero_pad": 3.622223707476709e-06, "add_observations_from_episodes_to_batch": 4.762020547368151e-06}}, "connector_pipeline_timer": 6.782331215434154e-05}, "env_step_timer": 2.4128357497402697e-05, "env_reset_timer": 8.26909459497997e-05, "episode_duration_sec_mean": 0.007688914850819857, "episode_return_min": -10.5, "sample": 0.009155030877839832, "episode_len_max": 20, "module_episode_returns_mean": {"default_policy": -0.8199999999999998}, "agent_episode_returns_mean": {"default_agent": -0.8199999999999998}, "weights_seq_no": 1.0, "num_agent_steps_sampled_lifetime": {"default_agent": 10000.0}, "env_to_module_sum_episodes_length_in": 10.36823839457432, "env_to_module_sum_episodes_length_out": 10.36823839457432, "num_episodes_lifetime": 500.0, "episode_return_mean": -0.8199999999999998, "time_between_sampling": 0.0027200829761986384, "num_module_steps_sampled": {"default_policy": 5000.0}, "num_module_steps_sampled_lifetime": {"default_policy": 10000.0}, "rlmodule_inference_timer": 5.1100349274796214e-05, "num_env_steps_sampled": 5000.0, "episode_len_mean": 20.0, "num_env_steps_sampled_lifetime_throughput": 2422.0233733389027}, "learners": {"__all_modules__": {"num_module_steps_trained_lifetime": 12000, "learner_connector": {"timers": {"connectors": {"add_observations_from_episodes_to_batch": 0.000923354149563238, "add_states_from_episodes_to_batch": 5.072713829576969e-06, "add_columns_from_episodes_to_train_batch": 0.04037214535987005, "batch_individual_items": 0.03438213227083907, "add_time_dim_to_batch_and_zero_pad": 1.3581528328359127e-05, "numpy_to_tensor": 7.496889680624009e-05, "general_advantage_estimation": 0.012889129207469523, "add_one_ts_to_episodes_and_truncate": 0.008547620690660552}}, "connector_pipeline_timer": 0.0973871059017256}, "num_module_steps_trained": 6000, "learner_connector_sum_episodes_length_in": 5000.0, "num_non_trainable_parameters": 0, "num_env_steps_trained": 31500, "num_env_steps_trained_lifetime": 63000, "learner_connector_sum_episodes_length_out": 5250.0, "num_trainable_parameters": 6003, "num_env_steps_trained_lifetime_throughput": 749120.1010621486, "num_module_steps_trained_throughput": 143527.21642235527, "num_module_steps_trained_lifetime_throughput": 143515.12113554883}, "default_policy": {"num_module_steps_trained_lifetime": 12000, "num_trainable_parameters": 6003, "entropy": 0.6898306608200073, "vf_explained_var": -0.012287616729736328, "num_module_steps_trained": 6000, "weights_seq_no": 2.0, "curr_entropy_coeff": 0.0090570820258, "diff_num_grad_updates_vs_sampler_policy": 1.0, "gradients_default_optimizer_global_norm": 0.09095917642116547, "curr_kl_coeff": 0.18662407994270325, "default_optimizer_learning_rate": 0.0002847858517, "vf_loss_unclipped": 28.918132781982422, "total_loss": 0.08293826133012772, "mean_kl_loss": 0.0015428205952048302, "policy_loss": 0.01986965350806713, "module_train_batch_size_mean": 1000.0, "vf_loss": 0.10278083384037018, "num_module_steps_trained_lifetime_throughput": 144015.57006292196}}, "num_training_step_calls_per_iteration": 1, "evaluation": {"env_runners": {"num_module_steps_sampled": {"default_policy": 400}, "num_episodes_lifetime": 40, "rlmodule_inference_timer": 3.532917293291419e-05, "module_to_env_connector": {"timers": {"connectors": {"remove_single_ts_time_rank_from_batch": 7.245529058786813e-07, "normalize_and_clip_actions": 1.1487402597575671e-05, "listify_data_for_vector_env": 1.362744793643288e-05, "un_batch_to_individual_items": 6.112102784827319e-06, "get_actions": 4.878271648473483e-05, "tensor_to_numpy": 1.5499623446152615e-05}}, "connector_pipeline_timer": 0.0001263432036802722}, "module_episode_returns_mean": {"default_policy": -3.8}, "agent_episode_returns_mean": {"default_agent": -3.8}, "env_reset_timer": 0.00020024550496600566, "episode_len_max": 20, "num_agent_steps_sampled_lifetime": {"default_agent": 800}, "episode_return_mean": -3.8, "num_agent_steps_sampled": {"default_agent": 400}, "num_env_steps_sampled": 400, "episode_len_mean": 20.0, "num_env_steps_sampled_lifetime": 10400, "episode_return_max": 11.5, "env_to_module_connector": {"connector_pipeline_timer": 4.94301749986349e-05, "timers": {"connectors": {"numpy_to_tensor": 1.0436532472128038e-05, "add_observations_from_episodes_to_batch": 3.2543553125666454e-06, "batch_individual_items": 7.280955620608936e-06, "add_states_from_episodes_to_batch": 1.8637816309126506e-06, "add_time_dim_to_batch_and_zero_pad": 2.4757853606932727e-06}}}, "episode_len_min": 20, "env_to_module_sum_episodes_length_in": 10.366003441359926, "num_episodes": 20, "sample": 0.18796662917360665, "weights_seq_no": 2.0, "env_to_module_sum_episodes_length_out": 10.366003441359926, "env_step_timer": 1.659216637417008e-05, "episode_duration_sec_mean": 0.007142851123353467, "episode_return_min": -12.5, "num_module_steps_sampled_lifetime": {"default_policy": 800}, "time_between_sampling": 2.6443509999662638}, "num_healthy_workers": 1, "actor_manager_num_outstanding_async_reqs": 0, "num_remote_worker_restarts": 0}, "num_env_steps_sampled_lifetime": 10000.0, "fault_tolerance": {"num_healthy_workers": 0, "num_remote_worker_restarts": 0}, "env_runner_group": {"actor_manager_num_outstanding_async_reqs": 0}, "done": false, "training_iteration": 2, "trial_id": "4380e_00000", "date": "2025-08-11_19-34-17", "timestamp": 1754933657, "time_this_iter_s": 2.700044631958008, "time_total_s": 5.654281854629517, "pid": 26823, "hostname": "Mac", "node_ip": "127.0.0.1", "config": {"exploration_config": {}, "extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "placement_strategy": "PACK", "num_gpus": 0, "_fake_gpus": false, "num_cpus_for_main_process": 2, "eager_tracing": true, "eager_max_retraces": 20, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "torch_compile_learner": false, "torch_compile_learner_what_to_compile": "forward_train", "torch_compile_learner_dynamo_backend": "aot_eager", "torch_compile_learner_dynamo_mode": null, "torch_compile_worker": false, "torch_compile_worker_dynamo_backend": "aot_eager", "torch_compile_worker_dynamo_mode": null, "torch_ddp_kwargs": {}, "torch_skip_nan_gradients": false, "env": "Umbrella", "env_config": {}, "observation_space": null, "action_space": null, "clip_rewards": null, "normalize_actions": true, "clip_actions": false, "_is_atari": null, "disable_env_checking": false, "render_env": false, "action_mask_key": "action_mask", "env_runner_cls": null, "num_env_runners": 0, "create_local_env_runner": true, "num_envs_per_env_runner": 1, "gym_env_vectorize_mode": "SYNC", "num_cpus_per_env_runner": 1, "num_gpus_per_env_runner": 0, "custom_resources_per_env_runner": {}, "validate_env_runners_after_construction": true, "episodes_to_numpy": true, "max_requests_in_flight_per_env_runner": 1, "sample_timeout_s": 60.0, "_env_to_module_connector": null, "add_default_connectors_to_env_to_module_pipeline": true, "_module_to_env_connector": null, "add_default_connectors_to_module_to_env_pipeline": true, "merge_env_runner_states": "training_only", "broadcast_env_runner_states": true, "episode_lookback_horizon": 1, "rollout_fragment_length": "auto", "batch_mode": "complete_episodes", "compress_observations": false, "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "enable_tf1_exec_eagerly": false, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "preprocessor_pref": "deepmind", "observation_filter": "NoFilter", "update_worker_filter_stats": true, "use_worker_filter_stats": true, "sampler_perf_stats_ema_coef": null, "_is_online": true, "num_learners": 0, "num_gpus_per_learner": 0, "num_cpus_per_learner": "auto", "num_aggregator_actors_per_learner": 0, "max_requests_in_flight_per_aggregator_actor": 3, "local_gpu_idx": 0, "max_requests_in_flight_per_learner": 3, "gamma": 1, "lr": 0.0002847858517, "grad_clip": 0.5, "grad_clip_by": "global_norm", "_train_batch_size_per_learner": 5000, "train_batch_size": 4000, "num_epochs": 1, "minibatch_size": 1000, "shuffle_batch_per_epoch": true, "model": {"fcnet_hiddens": [256, 256], "fcnet_activation": "tanh", "fcnet_weights_initializer": null, "fcnet_weights_initializer_config": null, "fcnet_bias_initializer": null, "fcnet_bias_initializer_config": null, "conv_filters": null, "conv_activation": "relu", "conv_kernel_initializer": null, "conv_kernel_initializer_config": null, "conv_bias_initializer": null, "conv_bias_initializer_config": null, "conv_transpose_kernel_initializer": null, "conv_transpose_kernel_initializer_config": null, "conv_transpose_bias_initializer": null, "conv_transpose_bias_initializer_config": null, "post_fcnet_hiddens": [], "post_fcnet_activation": "relu", "post_fcnet_weights_initializer": null, "post_fcnet_weights_initializer_config": null, "post_fcnet_bias_initializer": null, "post_fcnet_bias_initializer_config": null, "free_log_std": false, "log_std_clip_param": 20.0, "no_final_linear": false, "vf_share_layers": false, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "lstm_weights_initializer": null, "lstm_weights_initializer_config": null, "lstm_bias_initializer": null, "lstm_bias_initializer_config": null, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "attention_use_n_prev_actions": 0, "attention_use_n_prev_rewards": 0, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": null, "custom_model_config": {}, "custom_action_dist": null, "custom_preprocessor": null, "encoder_latent_dim": null, "always_check_shapes": false, "lstm_use_prev_action_reward": -1, "_use_default_native_models": -1, "_disable_preprocessor_api": false, "_disable_action_flattening": false}, "_learner_connector": null, "add_default_connectors_to_learner_pipeline": true, "learner_config_dict": {}, "optimizer": {}, "_learner_class": null, "callbacks_on_algorithm_init": null, "callbacks_on_env_runners_recreated": null, "callbacks_on_offline_eval_runners_recreated": null, "callbacks_on_checkpoint_loaded": null, "callbacks_on_environment_created": null, "callbacks_on_episode_created": null, "callbacks_on_episode_start": null, "callbacks_on_episode_step": null, "callbacks_on_episode_end": null, "callbacks_on_evaluate_start": null, "callbacks_on_evaluate_end": null, "callbacks_on_evaluate_offline_start": null, "callbacks_on_evaluate_offline_end": null, "callbacks_on_sample_end": null, "callbacks_on_train_result": null, "explore": true, "enable_rl_module_and_learner": true, "enable_env_runner_and_connector_v2": true, "_prior_exploration_config": {"type": "StochasticSampling"}, "count_steps_by": "env_steps", "policy_map_capacity": 100, "policy_mapping_fn": "<function AlgorithmConfig.DEFAULT_POLICY_MAPPING_FN at 0x14cce9b20>", "policies_to_train": null, "policy_states_are_swappable": false, "observation_fn": null, "offline_data_class": null, "input_read_method": "read_parquet", "input_read_method_kwargs": {}, "input_read_schema": {}, "input_read_episodes": false, "input_read_sample_batches": false, "input_read_batch_size": null, "input_filesystem": null, "input_filesystem_kwargs": {}, "input_compress_columns": ["obs", "new_obs"], "input_spaces_jsonable": true, "materialize_data": false, "materialize_mapped_data": true, "map_batches_kwargs": {}, "iter_batches_kwargs": {}, "ignore_final_observation": false, "prelearner_class": null, "prelearner_buffer_class": null, "prelearner_buffer_kwargs": {}, "prelearner_module_synch_period": 10, "dataset_num_iters_per_learner": null, "input_config": {}, "actions_in_input_normalized": false, "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_config": {}, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "output_max_rows_per_file": null, "output_write_remaining_data": false, "output_write_method": "write_parquet", "output_write_method_kwargs": {}, "output_filesystem": null, "output_filesystem_kwargs": {}, "output_write_episodes": true, "offline_sampling": false, "evaluation_interval": 1, "evaluation_duration": 20, "evaluation_duration_unit": "episodes", "evaluation_sample_timeout_s": 120.0, "evaluation_auto_duration_min_env_steps_per_sample": 100, "evaluation_auto_duration_max_env_steps_per_sample": 2000, "evaluation_parallel_to_training": false, "evaluation_force_reset_envs_before_iteration": true, "evaluation_config": null, "off_policy_estimation_methods": {}, "ope_split_batch_by_episode": true, "evaluation_num_env_runners": 1, "in_evaluation": false, "sync_filters_on_rollout_workers_timeout_s": 10.0, "offline_evaluation_interval": null, "num_offline_eval_runners": 0, "offline_loss_for_module_fn": null, "offline_evaluation_duration": 1, "offline_evaluation_parallel_to_training": false, "offline_evaluation_timeout_s": 120.0, "num_cpus_per_offline_eval_runner": 1, "num_gpus_per_offline_eval_runner": 0, "custom_resources_per_offline_eval_runner": {}, "restart_failed_offline_eval_runners": true, "ignore_offline_eval_runner_failures": false, "max_num_offline_eval_runner_restarts": 1000, "offline_eval_runner_restore_timeout_s": 1800.0, "max_requests_in_flight_per_offline_eval_runner": 1, "validate_offline_eval_runners_after_construction": true, "offline_eval_runner_health_probe_timeout_s": 30.0, "offline_eval_rl_module_inference_only": false, "broadcast_offline_eval_runner_states": false, "offline_eval_batch_size_per_runner": 256, "dataset_num_iters_per_eval_runner": 1, "keep_per_episode_custom_metrics": false, "metrics_episode_collection_timeout_s": 60.0, "metrics_num_episodes_for_smoothing": 100, "min_time_s_per_iteration": null, "min_train_timesteps_per_iteration": 0, "min_sample_timesteps_per_iteration": 0, "log_gradients": true, "export_native_model_files": false, "checkpoint_trainable_policies_only": false, "logger_creator": null, "logger_config": null, "log_level": "WARN", "log_sys_usage": true, "fake_sampler": false, "seed": 1, "restart_failed_env_runners": true, "ignore_env_runner_failures": false, "max_num_env_runner_restarts": 1000, "delay_between_env_runner_restarts_s": 60.0, "restart_failed_sub_environments": false, "num_consecutive_env_runner_failures_tolerance": 100, "env_runner_health_probe_timeout_s": 30.0, "env_runner_restore_timeout_s": 1800.0, "_model_config": {}, "_rl_module_spec": "RLModuleSpec(module_class=None, observation_space=None, action_space=None, inference_only=False, learner_only=False, model_config=DefaultModelConfig(fcnet_hiddens=[60, 90], fcnet_activation='tanh', fcnet_kernel_initializer=None, fcnet_kernel_initializer_kwargs=None, fcnet_bias_initializer=None, fcnet_bias_initializer_kwargs=None, conv_filters=None, conv_activation='relu', conv_kernel_initializer=None, conv_kernel_initializer_kwargs=None, conv_bias_initializer=None, conv_bias_initializer_kwargs=None, head_fcnet_hiddens=[], head_fcnet_activation='relu', head_fcnet_kernel_initializer=None, head_fcnet_kernel_initializer_kwargs=None, head_fcnet_bias_initializer=None, head_fcnet_bias_initializer_kwargs=None, free_log_std=False, log_std_clip_param=20.0, vf_share_layers=True, use_lstm=False, max_seq_len=20, lstm_cell_size=256, lstm_use_prev_action=False, lstm_use_prev_reward=False, lstm_kernel_initializer=None, lstm_kernel_initializer_kwargs=None, lstm_bias_initializer=None, lstm_bias_initializer_kwargs=None), catalog_class=None, load_state_path=None, model_config_dict=None)", "algorithm_config_overrides_per_module": {}, "_per_module_overrides": {}, "_validate_config": true, "_use_msgpack_checkpoints": false, "_torch_grad_scaler_class": null, "_torch_lr_scheduler_classes": null, "_tf_policy_handles_more_than_one_loss": false, "_disable_preprocessor_api": false, "_disable_action_flattening": false, "_disable_initialize_loss_from_dummy_batch": false, "_dont_auto_sync_env_runner_states": false, "env_task_fn": -1, "enable_connectors": -1, "simple_optimizer": false, "policy_map_cache": -1, "worker_cls": -1, "synchronize_filters": -1, "enable_async_evaluation": -1, "custom_async_evaluation_function": -1, "_enable_rl_module_api": -1, "auto_wrap_old_gym_envs": -1, "always_attach_evaluation_results": -1, "replay_sequence_length": null, "_disable_execution_plan_api": -1, "use_critic": true, "use_gae": true, "use_kl_loss": true, "kl_coeff": 0.7464963036515, "kl_target": 0.0270990929592, "vf_loss_coeff": 0.6688075857018, "entropy_coeff": 0.0090570820258, "clip_param": 0.1221781641624, "vf_clip_param": 0.1027808522125, "entropy_coeff_schedule": null, "lr_schedule": null, "sgd_minibatch_size": -1, "vf_share_layers": -1, "__stdout_file__": null, "__stderr_file__": null, "lambda": 0.9099046732075, "input": "sampler", "policies": {"default_policy": [null, null, null, null]}, "callbacks": "<class 'ray.rllib.callbacks.callbacks.RLlibCallback'>", "create_env_on_driver": false, "custom_eval_function": null, "framework": "torch"}, "time_since_restore": 5.654281854629517, "iterations_since_restore": 2, "perf": {"cpu_util_percent": 68.875, "ram_util_percent": 77.575}}
{"timers": {"training_iteration": 2.7503705258401347, "restore_env_runners": 1.2185413774568588e-05, "training_step": 2.7501653058326103, "env_runner_sampling_timer": 2.5674761633047254, "learner_update_timer": 0.17804892349198925, "synch_weights": 0.0009897089820238762, "restore_eval_env_runners": 1.717620762065053e-05, "evaluation_iteration": 0.19759057097136976, "synch_eval_env_connectors": 0.00032198394765146075, "synch_env_connectors": 5.867514992132783e-06}, "env_runners": {"num_env_steps_sampled_lifetime": -607500.0, "module_to_env_connector": {"timers": {"connectors": {"tensor_to_numpy": 2.4267396192317685e-05, "normalize_and_clip_actions": 1.5824724315246053e-05, "un_batch_to_individual_items": 8.95947238623504e-06, "listify_data_for_vector_env": 1.8799003567675846e-05, "remove_single_ts_time_rank_from_batch": 1.0837992322939159e-06, "get_actions": 8.229929781527248e-05}}, "connector_pipeline_timer": 0.00019309962207597576}, "episode_len_min": 20, "episode_return_max": 9.5, "num_episodes": 250.0, "num_agent_steps_sampled": {"default_agent": 5000.0}, "env_to_module_connector": {"timers": {"connectors": {"add_states_from_episodes_to_batch": 2.9143701990983215e-06, "numpy_to_tensor": 1.6813530026164356e-05, "batch_individual_items": 1.1351075813449297e-05, "add_time_dim_to_batch_and_zero_pad": 4.602860471280798e-06, "add_observations_from_episodes_to_batch": 5.14220058396916e-06}}, "connector_pipeline_timer": 7.425674343917841e-05}, "env_step_timer": 2.69861112306916e-05, "env_reset_timer": 8.326128948392017e-05, "episode_duration_sec_mean": 0.008626464131753891, "episode_return_min": -10.5, "sample": 0.009143272374538774, "episode_len_max": 20, "module_episode_returns_mean": {"default_policy": 0.22}, "agent_episode_returns_mean": {"default_agent": 0.22}, "weights_seq_no": 2.0, "num_agent_steps_sampled_lifetime": {"default_agent": -607500.0}, "env_to_module_sum_episodes_length_in": 10.36823839457432, "env_to_module_sum_episodes_length_out": 10.36823839457432, "num_episodes_lifetime": -30375.0, "episode_return_mean": 0.22, "time_between_sampling": 0.002690469225245001, "num_module_steps_sampled": {"default_policy": 5000.0}, "num_module_steps_sampled_lifetime": {"default_policy": -607500.0}, "rlmodule_inference_timer": 6.695073055005414e-05, "num_env_steps_sampled": 5000.0, "episode_len_mean": 20.0, "num_env_steps_sampled_lifetime_throughput": 2302.3959875554538}, "learners": {"__all_modules__": {"num_module_steps_trained_lifetime": 18000, "learner_connector": {"timers": {"connectors": {"add_observations_from_episodes_to_batch": 0.0009359014374786057, "add_states_from_episodes_to_batch": 5.055736657232046e-06, "add_columns_from_episodes_to_train_batch": 0.04043848057629075, "batch_individual_items": 0.03442524844740984, "add_time_dim_to_batch_and_zero_pad": 1.3636553846299648e-05, "numpy_to_tensor": 7.516087857075036e-05, "general_advantage_estimation": 0.012829308335389943, "add_one_ts_to_episodes_and_truncate": 0.00863146614440484}}, "connector_pipeline_timer": 0.09753391151223333}, "num_module_steps_trained": 6000, "learner_connector_sum_episodes_length_in": 5000.0, "num_non_trainable_parameters": 0, "num_env_steps_trained": 31500, "num_env_steps_trained_lifetime": 94500, "learner_connector_sum_episodes_length_out": 5250.0, "num_trainable_parameters": 6003, "num_env_steps_trained_lifetime_throughput": 767757.4410812254, "num_module_steps_trained_throughput": 147079.79677925742, "num_module_steps_trained_lifetime_throughput": 147063.13087040224}, "default_policy": {"num_module_steps_trained_lifetime": 18000, "num_trainable_parameters": 6003, "entropy": 0.6824526190757751, "vf_explained_var": -0.014024496078491211, "num_module_steps_trained": 6000, "weights_seq_no": 3.0, "curr_entropy_coeff": 0.0090570820258, "diff_num_grad_updates_vs_sampler_policy": 1.0, "gradients_default_optimizer_global_norm": 0.04352671653032303, "curr_kl_coeff": 0.09331203997135162, "default_optimizer_learning_rate": 0.0002847858517, "vf_loss_unclipped": 28.84691619873047, "total_loss": 0.11864931136369705, "mean_kl_loss": 0.0014687618240714073, "policy_loss": 0.05581562593579292, "module_train_batch_size_mean": 1000.0, "vf_loss": 0.10278083384037018, "num_module_steps_trained_lifetime_throughput": 147549.07359184435}}, "num_training_step_calls_per_iteration": 1, "evaluation": {"env_runners": {"num_module_steps_sampled": {"default_policy": 400}, "num_episodes_lifetime": 60, "rlmodule_inference_timer": 4.2797502374378565e-05, "module_to_env_connector": {"timers": {"connectors": {"remove_single_ts_time_rank_from_batch": 8.169302420096117e-07, "normalize_and_clip_actions": 1.428047912249273e-05, "listify_data_for_vector_env": 1.4709517522482335e-05, "un_batch_to_individual_items": 8.071858831944348e-06, "get_actions": 6.033163197656235e-05, "tensor_to_numpy": 1.8850346928560963e-05}}, "connector_pipeline_timer": 0.00015356902618149568}, "module_episode_returns_mean": {"default_policy": -3.466666666666667}, "agent_episode_returns_mean": {"default_agent": -3.466666666666667}, "env_reset_timer": 0.00019915804989868773, "episode_len_max": 20, "num_agent_steps_sampled_lifetime": {"default_agent": 1200}, "episode_return_mean": -3.466666666666667, "num_agent_steps_sampled": {"default_agent": 400}, "num_env_steps_sampled": 400, "episode_len_mean": 20.0, "num_env_steps_sampled_lifetime": 15400, "episode_return_max": 11.5, "env_to_module_connector": {"connector_pipeline_timer": 5.78903196789728e-05, "timers": {"connectors": {"numpy_to_tensor": 1.3143295124198796e-05, "add_observations_from_episodes_to_batch": 3.7409916095789506e-06, "batch_individual_items": 8.686798229721216e-06, "add_states_from_episodes_to_batch": 1.8976806988338342e-06, "add_time_dim_to_batch_and_zero_pad": 3.23329530152164e-06}}}, "episode_len_min": 20, "env_to_module_sum_episodes_length_in": 10.368205581254823, "num_episodes": 20, "sample": 0.18743872871147468, "weights_seq_no": 3.0, "env_to_module_sum_episodes_length_out": 10.368205581254823, "env_step_timer": 2.2570842875937952e-05, "episode_duration_sec_mean": 0.006837216031271964, "episode_return_min": -12.5, "num_module_steps_sampled_lifetime": {"default_policy": 1200}, "time_between_sampling": 2.6454071520466824}, "num_healthy_workers": 1, "actor_manager_num_outstanding_async_reqs": 0, "num_remote_worker_restarts": 0}, "num_env_steps_sampled_lifetime": -607500.0, "fault_tolerance": {"num_healthy_workers": 0, "num_remote_worker_restarts": 0}, "env_runner_group": {"actor_manager_num_outstanding_async_reqs": 0}, "done": false, "training_iteration": 3, "trial_id": "4380e_00000", "date": "2025-08-11_19-34-20", "timestamp": 1754933660, "time_this_iter_s": 2.8677449226379395, "time_total_s": 8.522026777267456, "pid": 26823, "hostname": "Mac", "node_ip": "127.0.0.1", "config": {"exploration_config": {}, "extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "placement_strategy": "PACK", "num_gpus": 0, "_fake_gpus": false, "num_cpus_for_main_process": 2, "eager_tracing": true, "eager_max_retraces": 20, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "torch_compile_learner": false, "torch_compile_learner_what_to_compile": "forward_train", "torch_compile_learner_dynamo_backend": "aot_eager", "torch_compile_learner_dynamo_mode": null, "torch_compile_worker": false, "torch_compile_worker_dynamo_backend": "aot_eager", "torch_compile_worker_dynamo_mode": null, "torch_ddp_kwargs": {}, "torch_skip_nan_gradients": false, "env": "Umbrella", "env_config": {}, "observation_space": null, "action_space": null, "clip_rewards": null, "normalize_actions": true, "clip_actions": false, "_is_atari": null, "disable_env_checking": false, "render_env": false, "action_mask_key": "action_mask", "env_runner_cls": null, "num_env_runners": 0, "create_local_env_runner": true, "num_envs_per_env_runner": 1, "gym_env_vectorize_mode": "SYNC", "num_cpus_per_env_runner": 1, "num_gpus_per_env_runner": 0, "custom_resources_per_env_runner": {}, "validate_env_runners_after_construction": true, "episodes_to_numpy": true, "max_requests_in_flight_per_env_runner": 1, "sample_timeout_s": 60.0, "_env_to_module_connector": null, "add_default_connectors_to_env_to_module_pipeline": true, "_module_to_env_connector": null, "add_default_connectors_to_module_to_env_pipeline": true, "merge_env_runner_states": "training_only", "broadcast_env_runner_states": true, "episode_lookback_horizon": 1, "rollout_fragment_length": "auto", "batch_mode": "complete_episodes", "compress_observations": false, "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "enable_tf1_exec_eagerly": false, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "preprocessor_pref": "deepmind", "observation_filter": "NoFilter", "update_worker_filter_stats": true, "use_worker_filter_stats": true, "sampler_perf_stats_ema_coef": null, "_is_online": true, "num_learners": 0, "num_gpus_per_learner": 0, "num_cpus_per_learner": "auto", "num_aggregator_actors_per_learner": 0, "max_requests_in_flight_per_aggregator_actor": 3, "local_gpu_idx": 0, "max_requests_in_flight_per_learner": 3, "gamma": 1, "lr": 0.0002847858517, "grad_clip": 0.5, "grad_clip_by": "global_norm", "_train_batch_size_per_learner": 5000, "train_batch_size": 4000, "num_epochs": 1, "minibatch_size": 1000, "shuffle_batch_per_epoch": true, "model": {"fcnet_hiddens": [256, 256], "fcnet_activation": "tanh", "fcnet_weights_initializer": null, "fcnet_weights_initializer_config": null, "fcnet_bias_initializer": null, "fcnet_bias_initializer_config": null, "conv_filters": null, "conv_activation": "relu", "conv_kernel_initializer": null, "conv_kernel_initializer_config": null, "conv_bias_initializer": null, "conv_bias_initializer_config": null, "conv_transpose_kernel_initializer": null, "conv_transpose_kernel_initializer_config": null, "conv_transpose_bias_initializer": null, "conv_transpose_bias_initializer_config": null, "post_fcnet_hiddens": [], "post_fcnet_activation": "relu", "post_fcnet_weights_initializer": null, "post_fcnet_weights_initializer_config": null, "post_fcnet_bias_initializer": null, "post_fcnet_bias_initializer_config": null, "free_log_std": false, "log_std_clip_param": 20.0, "no_final_linear": false, "vf_share_layers": false, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "lstm_weights_initializer": null, "lstm_weights_initializer_config": null, "lstm_bias_initializer": null, "lstm_bias_initializer_config": null, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "attention_use_n_prev_actions": 0, "attention_use_n_prev_rewards": 0, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": null, "custom_model_config": {}, "custom_action_dist": null, "custom_preprocessor": null, "encoder_latent_dim": null, "always_check_shapes": false, "lstm_use_prev_action_reward": -1, "_use_default_native_models": -1, "_disable_preprocessor_api": false, "_disable_action_flattening": false}, "_learner_connector": null, "add_default_connectors_to_learner_pipeline": true, "learner_config_dict": {}, "optimizer": {}, "_learner_class": null, "callbacks_on_algorithm_init": null, "callbacks_on_env_runners_recreated": null, "callbacks_on_offline_eval_runners_recreated": null, "callbacks_on_checkpoint_loaded": null, "callbacks_on_environment_created": null, "callbacks_on_episode_created": null, "callbacks_on_episode_start": null, "callbacks_on_episode_step": null, "callbacks_on_episode_end": null, "callbacks_on_evaluate_start": null, "callbacks_on_evaluate_end": null, "callbacks_on_evaluate_offline_start": null, "callbacks_on_evaluate_offline_end": null, "callbacks_on_sample_end": null, "callbacks_on_train_result": null, "explore": true, "enable_rl_module_and_learner": true, "enable_env_runner_and_connector_v2": true, "_prior_exploration_config": {"type": "StochasticSampling"}, "count_steps_by": "env_steps", "policy_map_capacity": 100, "policy_mapping_fn": "<function AlgorithmConfig.DEFAULT_POLICY_MAPPING_FN at 0x14cce9b20>", "policies_to_train": null, "policy_states_are_swappable": false, "observation_fn": null, "offline_data_class": null, "input_read_method": "read_parquet", "input_read_method_kwargs": {}, "input_read_schema": {}, "input_read_episodes": false, "input_read_sample_batches": false, "input_read_batch_size": null, "input_filesystem": null, "input_filesystem_kwargs": {}, "input_compress_columns": ["obs", "new_obs"], "input_spaces_jsonable": true, "materialize_data": false, "materialize_mapped_data": true, "map_batches_kwargs": {}, "iter_batches_kwargs": {}, "ignore_final_observation": false, "prelearner_class": null, "prelearner_buffer_class": null, "prelearner_buffer_kwargs": {}, "prelearner_module_synch_period": 10, "dataset_num_iters_per_learner": null, "input_config": {}, "actions_in_input_normalized": false, "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_config": {}, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "output_max_rows_per_file": null, "output_write_remaining_data": false, "output_write_method": "write_parquet", "output_write_method_kwargs": {}, "output_filesystem": null, "output_filesystem_kwargs": {}, "output_write_episodes": true, "offline_sampling": false, "evaluation_interval": 1, "evaluation_duration": 20, "evaluation_duration_unit": "episodes", "evaluation_sample_timeout_s": 120.0, "evaluation_auto_duration_min_env_steps_per_sample": 100, "evaluation_auto_duration_max_env_steps_per_sample": 2000, "evaluation_parallel_to_training": false, "evaluation_force_reset_envs_before_iteration": true, "evaluation_config": null, "off_policy_estimation_methods": {}, "ope_split_batch_by_episode": true, "evaluation_num_env_runners": 1, "in_evaluation": false, "sync_filters_on_rollout_workers_timeout_s": 10.0, "offline_evaluation_interval": null, "num_offline_eval_runners": 0, "offline_loss_for_module_fn": null, "offline_evaluation_duration": 1, "offline_evaluation_parallel_to_training": false, "offline_evaluation_timeout_s": 120.0, "num_cpus_per_offline_eval_runner": 1, "num_gpus_per_offline_eval_runner": 0, "custom_resources_per_offline_eval_runner": {}, "restart_failed_offline_eval_runners": true, "ignore_offline_eval_runner_failures": false, "max_num_offline_eval_runner_restarts": 1000, "offline_eval_runner_restore_timeout_s": 1800.0, "max_requests_in_flight_per_offline_eval_runner": 1, "validate_offline_eval_runners_after_construction": true, "offline_eval_runner_health_probe_timeout_s": 30.0, "offline_eval_rl_module_inference_only": false, "broadcast_offline_eval_runner_states": false, "offline_eval_batch_size_per_runner": 256, "dataset_num_iters_per_eval_runner": 1, "keep_per_episode_custom_metrics": false, "metrics_episode_collection_timeout_s": 60.0, "metrics_num_episodes_for_smoothing": 100, "min_time_s_per_iteration": null, "min_train_timesteps_per_iteration": 0, "min_sample_timesteps_per_iteration": 0, "log_gradients": true, "export_native_model_files": false, "checkpoint_trainable_policies_only": false, "logger_creator": null, "logger_config": null, "log_level": "WARN", "log_sys_usage": true, "fake_sampler": false, "seed": 1, "restart_failed_env_runners": true, "ignore_env_runner_failures": false, "max_num_env_runner_restarts": 1000, "delay_between_env_runner_restarts_s": 60.0, "restart_failed_sub_environments": false, "num_consecutive_env_runner_failures_tolerance": 100, "env_runner_health_probe_timeout_s": 30.0, "env_runner_restore_timeout_s": 1800.0, "_model_config": {}, "_rl_module_spec": "RLModuleSpec(module_class=None, observation_space=None, action_space=None, inference_only=False, learner_only=False, model_config=DefaultModelConfig(fcnet_hiddens=[60, 90], fcnet_activation='tanh', fcnet_kernel_initializer=None, fcnet_kernel_initializer_kwargs=None, fcnet_bias_initializer=None, fcnet_bias_initializer_kwargs=None, conv_filters=None, conv_activation='relu', conv_kernel_initializer=None, conv_kernel_initializer_kwargs=None, conv_bias_initializer=None, conv_bias_initializer_kwargs=None, head_fcnet_hiddens=[], head_fcnet_activation='relu', head_fcnet_kernel_initializer=None, head_fcnet_kernel_initializer_kwargs=None, head_fcnet_bias_initializer=None, head_fcnet_bias_initializer_kwargs=None, free_log_std=False, log_std_clip_param=20.0, vf_share_layers=True, use_lstm=False, max_seq_len=20, lstm_cell_size=256, lstm_use_prev_action=False, lstm_use_prev_reward=False, lstm_kernel_initializer=None, lstm_kernel_initializer_kwargs=None, lstm_bias_initializer=None, lstm_bias_initializer_kwargs=None), catalog_class=None, load_state_path=None, model_config_dict=None)", "algorithm_config_overrides_per_module": {}, "_per_module_overrides": {}, "_validate_config": true, "_use_msgpack_checkpoints": false, "_torch_grad_scaler_class": null, "_torch_lr_scheduler_classes": null, "_tf_policy_handles_more_than_one_loss": false, "_disable_preprocessor_api": false, "_disable_action_flattening": false, "_disable_initialize_loss_from_dummy_batch": false, "_dont_auto_sync_env_runner_states": false, "env_task_fn": -1, "enable_connectors": -1, "simple_optimizer": false, "policy_map_cache": -1, "worker_cls": -1, "synchronize_filters": -1, "enable_async_evaluation": -1, "custom_async_evaluation_function": -1, "_enable_rl_module_api": -1, "auto_wrap_old_gym_envs": -1, "always_attach_evaluation_results": -1, "replay_sequence_length": null, "_disable_execution_plan_api": -1, "use_critic": true, "use_gae": true, "use_kl_loss": true, "kl_coeff": 0.7464963036515, "kl_target": 0.0270990929592, "vf_loss_coeff": 0.6688075857018, "entropy_coeff": 0.0090570820258, "clip_param": 0.1221781641624, "vf_clip_param": 0.1027808522125, "entropy_coeff_schedule": null, "lr_schedule": null, "sgd_minibatch_size": -1, "vf_share_layers": -1, "__stdout_file__": null, "__stderr_file__": null, "lambda": 0.9099046732075, "input": "sampler", "policies": {"default_policy": [null, null, null, null]}, "callbacks": "<class 'ray.rllib.callbacks.callbacks.RLlibCallback'>", "create_env_on_driver": false, "custom_eval_function": null, "framework": "torch"}, "time_since_restore": 8.522026777267456, "iterations_since_restore": 3, "perf": {"cpu_util_percent": 74.65, "ram_util_percent": 77.925}}
{"timers": {"training_iteration": 2.747922234752226, "restore_env_runners": 1.214522964169737e-05, "training_step": 2.747716815273382, "env_runner_sampling_timer": 2.565405677921795, "learner_update_timer": 0.17768379842658505, "synch_weights": 0.0009859764723215486, "restore_eval_env_runners": 1.7106944578699768e-05, "evaluation_iteration": 0.19703831276199782, "synch_eval_env_connectors": 0.0003238391084014438, "synch_env_connectors": 5.853839020710438e-06}, "env_runners": {"num_env_steps_sampled_lifetime": -1225000.0, "module_to_env_connector": {"timers": {"connectors": {"tensor_to_numpy": 2.1492523331278063e-05, "normalize_and_clip_actions": 1.450372111771301e-05, "un_batch_to_individual_items": 8.16708958838301e-06, "listify_data_for_vector_env": 1.6851900542335057e-05, "remove_single_ts_time_rank_from_batch": 9.275244190667695e-07, "get_actions": 7.19066767519608e-05}}, "connector_pipeline_timer": 0.00017197089479664896}, "episode_len_min": 20, "episode_return_max": 9.5, "num_episodes": 250.0, "num_agent_steps_sampled": {"default_agent": 5000.0}, "env_to_module_connector": {"timers": {"connectors": {"add_states_from_episodes_to_batch": 2.5313546648756524e-06, "numpy_to_tensor": 1.481465290335564e-05, "batch_individual_items": 1.0272695230415222e-05, "add_time_dim_to_batch_and_zero_pad": 3.594260574252827e-06, "add_observations_from_episodes_to_batch": 4.529067860185164e-06}}, "connector_pipeline_timer": 6.648835654540892e-05}, "env_step_timer": 2.271477126764049e-05, "env_reset_timer": 7.313010597237507e-05, "episode_duration_sec_mean": 0.0074144753445871195, "episode_return_min": -10.5, "sample": 0.008271433378529997, "episode_len_max": 20, "module_episode_returns_mean": {"default_policy": 1.8199999999999996}, "agent_episode_returns_mean": {"default_agent": 1.8199999999999996}, "weights_seq_no": 3.0, "num_agent_steps_sampled_lifetime": {"default_agent": -1225000.0}, "env_to_module_sum_episodes_length_in": 10.36823839457432, "env_to_module_sum_episodes_length_out": 10.36823839457432, "num_episodes_lifetime": -61250.0, "episode_return_mean": 1.8199999999999996, "time_between_sampling": 0.002573854062642964, "num_module_steps_sampled": {"default_policy": 5000.0}, "num_module_steps_sampled_lifetime": {"default_policy": -1225000.0}, "rlmodule_inference_timer": 4.825935496552447e-05, "num_env_steps_sampled": 5000.0, "episode_len_mean": 20.0, "num_env_steps_sampled_lifetime_throughput": 2496.8800913893447}, "learners": {"__all_modules__": {"num_module_steps_trained_lifetime": 24000, "learner_connector": {"timers": {"connectors": {"add_observations_from_episodes_to_batch": 0.0009434999235876603, "add_states_from_episodes_to_batch": 5.050179633311928e-06, "add_columns_from_episodes_to_train_batch": 0.04057863117995416, "batch_individual_items": 0.03446172263378208, "add_time_dim_to_batch_and_zero_pad": 1.3618938921019434e-05, "numpy_to_tensor": 7.515260955458507e-05, "general_advantage_estimation": 0.012767244832006284, "add_one_ts_to_episodes_and_truncate": 0.00876864148273191}}, "connector_pipeline_timer": 0.09779269614700228}, "num_module_steps_trained": 6000, "learner_connector_sum_episodes_length_in": 5000.0, "num_non_trainable_parameters": 0, "num_env_steps_trained": 31500, "num_env_steps_trained_lifetime": 126000, "learner_connector_sum_episodes_length_out": 5250.0, "num_trainable_parameters": 6003, "num_env_steps_trained_lifetime_throughput": 792962.0269128402, "num_module_steps_trained_throughput": 151874.88977780708, "num_module_steps_trained_lifetime_throughput": 151853.3424073256}, "default_policy": {"num_module_steps_trained_lifetime": 24000, "num_trainable_parameters": 6003, "entropy": 0.6710050106048584, "vf_explained_var": -0.01594841480255127, "num_module_steps_trained": 6000, "weights_seq_no": 4.0, "curr_entropy_coeff": 0.0090570820258, "diff_num_grad_updates_vs_sampler_policy": 1.0, "gradients_default_optimizer_global_norm": 0.13250532746315002, "curr_kl_coeff": 0.04665601998567581, "default_optimizer_learning_rate": 0.0002847858517, "vf_loss_unclipped": 28.459375381469727, "total_loss": 0.10210534930229187, "mean_kl_loss": 0.0022027352824807167, "policy_loss": 0.03923654928803444, "module_train_batch_size_mean": 1000.0, "vf_loss": 0.10278083384037018, "num_module_steps_trained_lifetime_throughput": 152318.98103172192}}, "num_training_step_calls_per_iteration": 1, "evaluation": {"env_runners": {"num_module_steps_sampled": {"default_policy": 400}, "num_episodes_lifetime": 80, "rlmodule_inference_timer": 3.623555880149176e-05, "module_to_env_connector": {"timers": {"connectors": {"remove_single_ts_time_rank_from_batch": 7.945286666229552e-07, "normalize_and_clip_actions": 1.251548502297045e-05, "listify_data_for_vector_env": 1.3947343556024462e-05, "un_batch_to_individual_items": 6.468260065317062e-06, "get_actions": 5.168417569760694e-05, "tensor_to_numpy": 1.6068978941097885e-05}}, "connector_pipeline_timer": 0.00013273933195192788}, "module_episode_returns_mean": {"default_policy": -2.55}, "agent_episode_returns_mean": {"default_agent": -2.55}, "env_reset_timer": 0.00019803271930187474, "episode_len_max": 20, "num_agent_steps_sampled_lifetime": {"default_agent": 1600}, "episode_return_mean": -2.55, "num_agent_steps_sampled": {"default_agent": 400}, "num_env_steps_sampled": 400, "episode_len_mean": 20.0, "num_env_steps_sampled_lifetime": 20400, "episode_return_max": 12.5, "env_to_module_connector": {"connector_pipeline_timer": 5.294578476911089e-05, "timers": {"connectors": {"numpy_to_tensor": 1.0960183478215983e-05, "add_observations_from_episodes_to_batch": 3.486785213364305e-06, "batch_individual_items": 8.00102337832805e-06, "add_states_from_episodes_to_batch": 1.8969075044807023e-06, "add_time_dim_to_batch_and_zero_pad": 2.8222679450221573e-06}}}, "episode_len_min": 20, "env_to_module_sum_episodes_length_in": 10.368237912813044, "num_episodes": 20, "sample": 0.18683159142416061, "weights_seq_no": 4.0, "env_to_module_sum_episodes_length_out": 10.368237912813044, "env_step_timer": 1.7853288194020226e-05, "episode_duration_sec_mean": 0.006580255198059604, "episode_return_min": -12.5, "num_module_steps_sampled_lifetime": {"default_policy": 1600}, "time_between_sampling": 2.6442260213565434}, "num_healthy_workers": 1, "actor_manager_num_outstanding_async_reqs": 0, "num_remote_worker_restarts": 0}, "num_env_steps_sampled_lifetime": -1225000.0, "fault_tolerance": {"num_healthy_workers": 0, "num_remote_worker_restarts": 0}, "env_runner_group": {"actor_manager_num_outstanding_async_reqs": 0}, "done": false, "training_iteration": 4, "trial_id": "4380e_00000", "date": "2025-08-11_19-34-22", "timestamp": 1754933662, "time_this_iter_s": 2.639707088470459, "time_total_s": 11.161733865737915, "pid": 26823, "hostname": "Mac", "node_ip": "127.0.0.1", "config": {"exploration_config": {}, "extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "placement_strategy": "PACK", "num_gpus": 0, "_fake_gpus": false, "num_cpus_for_main_process": 2, "eager_tracing": true, "eager_max_retraces": 20, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "torch_compile_learner": false, "torch_compile_learner_what_to_compile": "forward_train", "torch_compile_learner_dynamo_backend": "aot_eager", "torch_compile_learner_dynamo_mode": null, "torch_compile_worker": false, "torch_compile_worker_dynamo_backend": "aot_eager", "torch_compile_worker_dynamo_mode": null, "torch_ddp_kwargs": {}, "torch_skip_nan_gradients": false, "env": "Umbrella", "env_config": {}, "observation_space": null, "action_space": null, "clip_rewards": null, "normalize_actions": true, "clip_actions": false, "_is_atari": null, "disable_env_checking": false, "render_env": false, "action_mask_key": "action_mask", "env_runner_cls": null, "num_env_runners": 0, "create_local_env_runner": true, "num_envs_per_env_runner": 1, "gym_env_vectorize_mode": "SYNC", "num_cpus_per_env_runner": 1, "num_gpus_per_env_runner": 0, "custom_resources_per_env_runner": {}, "validate_env_runners_after_construction": true, "episodes_to_numpy": true, "max_requests_in_flight_per_env_runner": 1, "sample_timeout_s": 60.0, "_env_to_module_connector": null, "add_default_connectors_to_env_to_module_pipeline": true, "_module_to_env_connector": null, "add_default_connectors_to_module_to_env_pipeline": true, "merge_env_runner_states": "training_only", "broadcast_env_runner_states": true, "episode_lookback_horizon": 1, "rollout_fragment_length": "auto", "batch_mode": "complete_episodes", "compress_observations": false, "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "enable_tf1_exec_eagerly": false, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "preprocessor_pref": "deepmind", "observation_filter": "NoFilter", "update_worker_filter_stats": true, "use_worker_filter_stats": true, "sampler_perf_stats_ema_coef": null, "_is_online": true, "num_learners": 0, "num_gpus_per_learner": 0, "num_cpus_per_learner": "auto", "num_aggregator_actors_per_learner": 0, "max_requests_in_flight_per_aggregator_actor": 3, "local_gpu_idx": 0, "max_requests_in_flight_per_learner": 3, "gamma": 1, "lr": 0.0002847858517, "grad_clip": 0.5, "grad_clip_by": "global_norm", "_train_batch_size_per_learner": 5000, "train_batch_size": 4000, "num_epochs": 1, "minibatch_size": 1000, "shuffle_batch_per_epoch": true, "model": {"fcnet_hiddens": [256, 256], "fcnet_activation": "tanh", "fcnet_weights_initializer": null, "fcnet_weights_initializer_config": null, "fcnet_bias_initializer": null, "fcnet_bias_initializer_config": null, "conv_filters": null, "conv_activation": "relu", "conv_kernel_initializer": null, "conv_kernel_initializer_config": null, "conv_bias_initializer": null, "conv_bias_initializer_config": null, "conv_transpose_kernel_initializer": null, "conv_transpose_kernel_initializer_config": null, "conv_transpose_bias_initializer": null, "conv_transpose_bias_initializer_config": null, "post_fcnet_hiddens": [], "post_fcnet_activation": "relu", "post_fcnet_weights_initializer": null, "post_fcnet_weights_initializer_config": null, "post_fcnet_bias_initializer": null, "post_fcnet_bias_initializer_config": null, "free_log_std": false, "log_std_clip_param": 20.0, "no_final_linear": false, "vf_share_layers": false, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "lstm_weights_initializer": null, "lstm_weights_initializer_config": null, "lstm_bias_initializer": null, "lstm_bias_initializer_config": null, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "attention_use_n_prev_actions": 0, "attention_use_n_prev_rewards": 0, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": null, "custom_model_config": {}, "custom_action_dist": null, "custom_preprocessor": null, "encoder_latent_dim": null, "always_check_shapes": false, "lstm_use_prev_action_reward": -1, "_use_default_native_models": -1, "_disable_preprocessor_api": false, "_disable_action_flattening": false}, "_learner_connector": null, "add_default_connectors_to_learner_pipeline": true, "learner_config_dict": {}, "optimizer": {}, "_learner_class": null, "callbacks_on_algorithm_init": null, "callbacks_on_env_runners_recreated": null, "callbacks_on_offline_eval_runners_recreated": null, "callbacks_on_checkpoint_loaded": null, "callbacks_on_environment_created": null, "callbacks_on_episode_created": null, "callbacks_on_episode_start": null, "callbacks_on_episode_step": null, "callbacks_on_episode_end": null, "callbacks_on_evaluate_start": null, "callbacks_on_evaluate_end": null, "callbacks_on_evaluate_offline_start": null, "callbacks_on_evaluate_offline_end": null, "callbacks_on_sample_end": null, "callbacks_on_train_result": null, "explore": true, "enable_rl_module_and_learner": true, "enable_env_runner_and_connector_v2": true, "_prior_exploration_config": {"type": "StochasticSampling"}, "count_steps_by": "env_steps", "policy_map_capacity": 100, "policy_mapping_fn": "<function AlgorithmConfig.DEFAULT_POLICY_MAPPING_FN at 0x14cce9b20>", "policies_to_train": null, "policy_states_are_swappable": false, "observation_fn": null, "offline_data_class": null, "input_read_method": "read_parquet", "input_read_method_kwargs": {}, "input_read_schema": {}, "input_read_episodes": false, "input_read_sample_batches": false, "input_read_batch_size": null, "input_filesystem": null, "input_filesystem_kwargs": {}, "input_compress_columns": ["obs", "new_obs"], "input_spaces_jsonable": true, "materialize_data": false, "materialize_mapped_data": true, "map_batches_kwargs": {}, "iter_batches_kwargs": {}, "ignore_final_observation": false, "prelearner_class": null, "prelearner_buffer_class": null, "prelearner_buffer_kwargs": {}, "prelearner_module_synch_period": 10, "dataset_num_iters_per_learner": null, "input_config": {}, "actions_in_input_normalized": false, "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_config": {}, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "output_max_rows_per_file": null, "output_write_remaining_data": false, "output_write_method": "write_parquet", "output_write_method_kwargs": {}, "output_filesystem": null, "output_filesystem_kwargs": {}, "output_write_episodes": true, "offline_sampling": false, "evaluation_interval": 1, "evaluation_duration": 20, "evaluation_duration_unit": "episodes", "evaluation_sample_timeout_s": 120.0, "evaluation_auto_duration_min_env_steps_per_sample": 100, "evaluation_auto_duration_max_env_steps_per_sample": 2000, "evaluation_parallel_to_training": false, "evaluation_force_reset_envs_before_iteration": true, "evaluation_config": null, "off_policy_estimation_methods": {}, "ope_split_batch_by_episode": true, "evaluation_num_env_runners": 1, "in_evaluation": false, "sync_filters_on_rollout_workers_timeout_s": 10.0, "offline_evaluation_interval": null, "num_offline_eval_runners": 0, "offline_loss_for_module_fn": null, "offline_evaluation_duration": 1, "offline_evaluation_parallel_to_training": false, "offline_evaluation_timeout_s": 120.0, "num_cpus_per_offline_eval_runner": 1, "num_gpus_per_offline_eval_runner": 0, "custom_resources_per_offline_eval_runner": {}, "restart_failed_offline_eval_runners": true, "ignore_offline_eval_runner_failures": false, "max_num_offline_eval_runner_restarts": 1000, "offline_eval_runner_restore_timeout_s": 1800.0, "max_requests_in_flight_per_offline_eval_runner": 1, "validate_offline_eval_runners_after_construction": true, "offline_eval_runner_health_probe_timeout_s": 30.0, "offline_eval_rl_module_inference_only": false, "broadcast_offline_eval_runner_states": false, "offline_eval_batch_size_per_runner": 256, "dataset_num_iters_per_eval_runner": 1, "keep_per_episode_custom_metrics": false, "metrics_episode_collection_timeout_s": 60.0, "metrics_num_episodes_for_smoothing": 100, "min_time_s_per_iteration": null, "min_train_timesteps_per_iteration": 0, "min_sample_timesteps_per_iteration": 0, "log_gradients": true, "export_native_model_files": false, "checkpoint_trainable_policies_only": false, "logger_creator": null, "logger_config": null, "log_level": "WARN", "log_sys_usage": true, "fake_sampler": false, "seed": 1, "restart_failed_env_runners": true, "ignore_env_runner_failures": false, "max_num_env_runner_restarts": 1000, "delay_between_env_runner_restarts_s": 60.0, "restart_failed_sub_environments": false, "num_consecutive_env_runner_failures_tolerance": 100, "env_runner_health_probe_timeout_s": 30.0, "env_runner_restore_timeout_s": 1800.0, "_model_config": {}, "_rl_module_spec": "RLModuleSpec(module_class=None, observation_space=None, action_space=None, inference_only=False, learner_only=False, model_config=DefaultModelConfig(fcnet_hiddens=[60, 90], fcnet_activation='tanh', fcnet_kernel_initializer=None, fcnet_kernel_initializer_kwargs=None, fcnet_bias_initializer=None, fcnet_bias_initializer_kwargs=None, conv_filters=None, conv_activation='relu', conv_kernel_initializer=None, conv_kernel_initializer_kwargs=None, conv_bias_initializer=None, conv_bias_initializer_kwargs=None, head_fcnet_hiddens=[], head_fcnet_activation='relu', head_fcnet_kernel_initializer=None, head_fcnet_kernel_initializer_kwargs=None, head_fcnet_bias_initializer=None, head_fcnet_bias_initializer_kwargs=None, free_log_std=False, log_std_clip_param=20.0, vf_share_layers=True, use_lstm=False, max_seq_len=20, lstm_cell_size=256, lstm_use_prev_action=False, lstm_use_prev_reward=False, lstm_kernel_initializer=None, lstm_kernel_initializer_kwargs=None, lstm_bias_initializer=None, lstm_bias_initializer_kwargs=None), catalog_class=None, load_state_path=None, model_config_dict=None)", "algorithm_config_overrides_per_module": {}, "_per_module_overrides": {}, "_validate_config": true, "_use_msgpack_checkpoints": false, "_torch_grad_scaler_class": null, "_torch_lr_scheduler_classes": null, "_tf_policy_handles_more_than_one_loss": false, "_disable_preprocessor_api": false, "_disable_action_flattening": false, "_disable_initialize_loss_from_dummy_batch": false, "_dont_auto_sync_env_runner_states": false, "env_task_fn": -1, "enable_connectors": -1, "simple_optimizer": false, "policy_map_cache": -1, "worker_cls": -1, "synchronize_filters": -1, "enable_async_evaluation": -1, "custom_async_evaluation_function": -1, "_enable_rl_module_api": -1, "auto_wrap_old_gym_envs": -1, "always_attach_evaluation_results": -1, "replay_sequence_length": null, "_disable_execution_plan_api": -1, "use_critic": true, "use_gae": true, "use_kl_loss": true, "kl_coeff": 0.7464963036515, "kl_target": 0.0270990929592, "vf_loss_coeff": 0.6688075857018, "entropy_coeff": 0.0090570820258, "clip_param": 0.1221781641624, "vf_clip_param": 0.1027808522125, "entropy_coeff_schedule": null, "lr_schedule": null, "sgd_minibatch_size": -1, "vf_share_layers": -1, "__stdout_file__": null, "__stderr_file__": null, "lambda": 0.9099046732075, "input": "sampler", "policies": {"default_policy": [null, null, null, null]}, "callbacks": "<class 'ray.rllib.callbacks.callbacks.RLlibCallback'>", "create_env_on_driver": false, "custom_eval_function": null, "framework": "torch"}, "time_since_restore": 11.161733865737915, "iterations_since_restore": 4, "perf": {"cpu_util_percent": 68.92500000000001, "ram_util_percent": 77.44999999999999}}
{"timers": {"training_iteration": 2.7456868490646418, "restore_env_runners": 1.2135866673748242e-05, "training_step": 2.7454805312808057, "env_runner_sampling_timer": 2.5636427273916427, "learner_update_timer": 0.17722147211281739, "synch_weights": 0.0009830812973002985, "restore_eval_env_runners": 1.7032534774625674e-05, "evaluation_iteration": 0.19638660379407974, "synch_eval_env_connectors": 0.0003216752970946254, "synch_env_connectors": 5.838220631354488e-06}, "env_runners": {"num_env_steps_sampled_lifetime": -1842500.0, "module_to_env_connector": {"timers": {"connectors": {"tensor_to_numpy": 2.2124844135289087e-05, "normalize_and_clip_actions": 1.470082442436084e-05, "un_batch_to_individual_items": 8.328299255928152e-06, "listify_data_for_vector_env": 1.7487959893835303e-05, "remove_single_ts_time_rank_from_batch": 8.878135588761665e-07, "get_actions": 7.165512845887588e-05}}, "connector_pipeline_timer": 0.0001742449580299348}, "episode_len_min": 20, "episode_return_max": 9.5, "num_episodes": 250.0, "num_agent_steps_sampled": {"default_agent": 5000.0}, "env_to_module_connector": {"timers": {"connectors": {"add_states_from_episodes_to_batch": 2.500176723605952e-06, "numpy_to_tensor": 1.5036208374705963e-05, "batch_individual_items": 1.0397610706954886e-05, "add_time_dim_to_batch_and_zero_pad": 3.6183257980000605e-06, "add_observations_from_episodes_to_batch": 4.5388053028467115e-06}}, "connector_pipeline_timer": 6.650825411473503e-05}, "env_step_timer": 2.2942287252363838e-05, "env_reset_timer": 6.90707495131628e-05, "episode_duration_sec_mean": 0.007953574699349701, "episode_return_min": -10.5, "sample": 0.008067699676969924, "episode_len_max": 20, "module_episode_returns_mean": {"default_policy": 3.66}, "agent_episode_returns_mean": {"default_agent": 3.66}, "weights_seq_no": 4.0, "num_agent_steps_sampled_lifetime": {"default_agent": -1842500.0}, "env_to_module_sum_episodes_length_in": 10.36823839457432, "env_to_module_sum_episodes_length_out": 10.36823839457432, "num_episodes_lifetime": -92125.0, "episode_return_mean": 3.66, "time_between_sampling": 0.002324570170127597, "num_module_steps_sampled": {"default_policy": 5000.0}, "num_module_steps_sampled_lifetime": {"default_policy": -1842500.0}, "rlmodule_inference_timer": 7.183724312738296e-05, "num_env_steps_sampled": 5000.0, "episode_len_mean": 20.0, "num_env_steps_sampled_lifetime_throughput": 2494.340890476209}, "learners": {"__all_modules__": {"num_module_steps_trained_lifetime": 30000, "learner_connector": {"timers": {"connectors": {"add_observations_from_episodes_to_batch": 0.0009560153347979357, "add_states_from_episodes_to_batch": 5.0342578441742815e-06, "add_columns_from_episodes_to_train_batch": 0.040684587367811595, "batch_individual_items": 0.03448349873748558, "add_time_dim_to_batch_and_zero_pad": 1.3590659550223498e-05, "numpy_to_tensor": 7.512400281697977e-05, "general_advantage_estimation": 0.012703366133700378, "add_one_ts_to_episodes_and_truncate": 0.00884243715780221}}, "connector_pipeline_timer": 0.0979426062658079}, "num_module_steps_trained": 6000, "learner_connector_sum_episodes_length_in": 5000.0, "num_non_trainable_parameters": 0, "num_env_steps_trained": 31500, "num_env_steps_trained_lifetime": 157500, "learner_connector_sum_episodes_length_out": 5250.0, "num_trainable_parameters": 6003, "num_env_steps_trained_lifetime_throughput": 821435.6743505938, "num_module_steps_trained_throughput": 157282.51049584214, "num_module_steps_trained_lifetime_throughput": 157258.4524608513}, "default_policy": {"num_module_steps_trained_lifetime": 30000, "num_trainable_parameters": 6003, "entropy": 0.6537670493125916, "vf_explained_var": -0.01769888401031494, "num_module_steps_trained": 6000, "weights_seq_no": 5.0, "curr_entropy_coeff": 0.0090570820258, "diff_num_grad_updates_vs_sampler_policy": 1.0, "gradients_default_optimizer_global_norm": 0.3231657147407532, "curr_kl_coeff": 0.023328009992837906, "default_optimizer_learning_rate": 0.0002847858517, "vf_loss_unclipped": 27.58094024658203, "total_loss": -0.026010937988758087, "mean_kl_loss": 0.003353710984811187, "policy_loss": -0.08898680657148361, "module_train_batch_size_mean": 1000.0, "vf_loss": 0.10278083384037018, "num_module_steps_trained_lifetime_throughput": 157690.2230884931}}, "num_training_step_calls_per_iteration": 1, "evaluation": {"env_runners": {"num_module_steps_sampled": {"default_policy": 400}, "num_episodes_lifetime": 100, "rlmodule_inference_timer": 4.9560680828822776e-05, "module_to_env_connector": {"timers": {"connectors": {"remove_single_ts_time_rank_from_batch": 1.0182410752292758e-06, "normalize_and_clip_actions": 1.4195331200567474e-05, "listify_data_for_vector_env": 1.5756051669472974e-05, "un_batch_to_individual_items": 7.153135982083407e-06, "get_actions": 6.927202447116308e-05, "tensor_to_numpy": 2.2359815467770157e-05}}, "connector_pipeline_timer": 0.000166736175406172}, "module_episode_returns_mean": {"default_policy": -1.8}, "agent_episode_returns_mean": {"default_agent": -1.8}, "env_reset_timer": 0.00019790614196334616, "episode_len_max": 20, "num_agent_steps_sampled_lifetime": {"default_agent": 2000}, "episode_return_mean": -1.8, "num_agent_steps_sampled": {"default_agent": 400}, "num_env_steps_sampled": 400, "episode_len_mean": 20.0, "num_env_steps_sampled_lifetime": 25400, "episode_return_max": 12.5, "env_to_module_connector": {"connector_pipeline_timer": 6.264611813871514e-05, "timers": {"connectors": {"numpy_to_tensor": 1.5265320687334022e-05, "add_observations_from_episodes_to_batch": 4.500146997056576e-06, "batch_individual_items": 8.846881471418521e-06, "add_states_from_episodes_to_batch": 2.298209854557093e-06, "add_time_dim_to_batch_and_zero_pad": 3.0879714824183775e-06}}}, "episode_len_min": 20, "env_to_module_sum_episodes_length_in": 10.368238387501162, "num_episodes": 20, "sample": 0.18631362592944406, "weights_seq_no": 5.0, "env_to_module_sum_episodes_length_out": 10.368238387501162, "env_step_timer": 2.2330777451217104e-05, "episode_duration_sec_mean": 0.006506618759594858, "episode_return_min": -12.5, "num_module_steps_sampled_lifetime": {"default_policy": 2000}, "time_between_sampling": 2.643229286983601}, "num_healthy_workers": 1, "actor_manager_num_outstanding_async_reqs": 0, "num_remote_worker_restarts": 0}, "num_env_steps_sampled_lifetime": -1842500.0, "fault_tolerance": {"num_healthy_workers": 0, "num_remote_worker_restarts": 0}, "env_runner_group": {"actor_manager_num_outstanding_async_reqs": 0}, "done": false, "training_iteration": 5, "trial_id": "4380e_00000", "date": "2025-08-11_19-34-25", "timestamp": 1754933665, "time_this_iter_s": 2.6696770191192627, "time_total_s": 13.831410884857178, "pid": 26823, "hostname": "Mac", "node_ip": "127.0.0.1", "config": {"exploration_config": {}, "extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "placement_strategy": "PACK", "num_gpus": 0, "_fake_gpus": false, "num_cpus_for_main_process": 2, "eager_tracing": true, "eager_max_retraces": 20, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "torch_compile_learner": false, "torch_compile_learner_what_to_compile": "forward_train", "torch_compile_learner_dynamo_backend": "aot_eager", "torch_compile_learner_dynamo_mode": null, "torch_compile_worker": false, "torch_compile_worker_dynamo_backend": "aot_eager", "torch_compile_worker_dynamo_mode": null, "torch_ddp_kwargs": {}, "torch_skip_nan_gradients": false, "env": "Umbrella", "env_config": {}, "observation_space": null, "action_space": null, "clip_rewards": null, "normalize_actions": true, "clip_actions": false, "_is_atari": null, "disable_env_checking": false, "render_env": false, "action_mask_key": "action_mask", "env_runner_cls": null, "num_env_runners": 0, "create_local_env_runner": true, "num_envs_per_env_runner": 1, "gym_env_vectorize_mode": "SYNC", "num_cpus_per_env_runner": 1, "num_gpus_per_env_runner": 0, "custom_resources_per_env_runner": {}, "validate_env_runners_after_construction": true, "episodes_to_numpy": true, "max_requests_in_flight_per_env_runner": 1, "sample_timeout_s": 60.0, "_env_to_module_connector": null, "add_default_connectors_to_env_to_module_pipeline": true, "_module_to_env_connector": null, "add_default_connectors_to_module_to_env_pipeline": true, "merge_env_runner_states": "training_only", "broadcast_env_runner_states": true, "episode_lookback_horizon": 1, "rollout_fragment_length": "auto", "batch_mode": "complete_episodes", "compress_observations": false, "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "enable_tf1_exec_eagerly": false, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "preprocessor_pref": "deepmind", "observation_filter": "NoFilter", "update_worker_filter_stats": true, "use_worker_filter_stats": true, "sampler_perf_stats_ema_coef": null, "_is_online": true, "num_learners": 0, "num_gpus_per_learner": 0, "num_cpus_per_learner": "auto", "num_aggregator_actors_per_learner": 0, "max_requests_in_flight_per_aggregator_actor": 3, "local_gpu_idx": 0, "max_requests_in_flight_per_learner": 3, "gamma": 1, "lr": 0.0002847858517, "grad_clip": 0.5, "grad_clip_by": "global_norm", "_train_batch_size_per_learner": 5000, "train_batch_size": 4000, "num_epochs": 1, "minibatch_size": 1000, "shuffle_batch_per_epoch": true, "model": {"fcnet_hiddens": [256, 256], "fcnet_activation": "tanh", "fcnet_weights_initializer": null, "fcnet_weights_initializer_config": null, "fcnet_bias_initializer": null, "fcnet_bias_initializer_config": null, "conv_filters": null, "conv_activation": "relu", "conv_kernel_initializer": null, "conv_kernel_initializer_config": null, "conv_bias_initializer": null, "conv_bias_initializer_config": null, "conv_transpose_kernel_initializer": null, "conv_transpose_kernel_initializer_config": null, "conv_transpose_bias_initializer": null, "conv_transpose_bias_initializer_config": null, "post_fcnet_hiddens": [], "post_fcnet_activation": "relu", "post_fcnet_weights_initializer": null, "post_fcnet_weights_initializer_config": null, "post_fcnet_bias_initializer": null, "post_fcnet_bias_initializer_config": null, "free_log_std": false, "log_std_clip_param": 20.0, "no_final_linear": false, "vf_share_layers": false, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "lstm_weights_initializer": null, "lstm_weights_initializer_config": null, "lstm_bias_initializer": null, "lstm_bias_initializer_config": null, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "attention_use_n_prev_actions": 0, "attention_use_n_prev_rewards": 0, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": null, "custom_model_config": {}, "custom_action_dist": null, "custom_preprocessor": null, "encoder_latent_dim": null, "always_check_shapes": false, "lstm_use_prev_action_reward": -1, "_use_default_native_models": -1, "_disable_preprocessor_api": false, "_disable_action_flattening": false}, "_learner_connector": null, "add_default_connectors_to_learner_pipeline": true, "learner_config_dict": {}, "optimizer": {}, "_learner_class": null, "callbacks_on_algorithm_init": null, "callbacks_on_env_runners_recreated": null, "callbacks_on_offline_eval_runners_recreated": null, "callbacks_on_checkpoint_loaded": null, "callbacks_on_environment_created": null, "callbacks_on_episode_created": null, "callbacks_on_episode_start": null, "callbacks_on_episode_step": null, "callbacks_on_episode_end": null, "callbacks_on_evaluate_start": null, "callbacks_on_evaluate_end": null, "callbacks_on_evaluate_offline_start": null, "callbacks_on_evaluate_offline_end": null, "callbacks_on_sample_end": null, "callbacks_on_train_result": null, "explore": true, "enable_rl_module_and_learner": true, "enable_env_runner_and_connector_v2": true, "_prior_exploration_config": {"type": "StochasticSampling"}, "count_steps_by": "env_steps", "policy_map_capacity": 100, "policy_mapping_fn": "<function AlgorithmConfig.DEFAULT_POLICY_MAPPING_FN at 0x14cce9b20>", "policies_to_train": null, "policy_states_are_swappable": false, "observation_fn": null, "offline_data_class": null, "input_read_method": "read_parquet", "input_read_method_kwargs": {}, "input_read_schema": {}, "input_read_episodes": false, "input_read_sample_batches": false, "input_read_batch_size": null, "input_filesystem": null, "input_filesystem_kwargs": {}, "input_compress_columns": ["obs", "new_obs"], "input_spaces_jsonable": true, "materialize_data": false, "materialize_mapped_data": true, "map_batches_kwargs": {}, "iter_batches_kwargs": {}, "ignore_final_observation": false, "prelearner_class": null, "prelearner_buffer_class": null, "prelearner_buffer_kwargs": {}, "prelearner_module_synch_period": 10, "dataset_num_iters_per_learner": null, "input_config": {}, "actions_in_input_normalized": false, "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_config": {}, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "output_max_rows_per_file": null, "output_write_remaining_data": false, "output_write_method": "write_parquet", "output_write_method_kwargs": {}, "output_filesystem": null, "output_filesystem_kwargs": {}, "output_write_episodes": true, "offline_sampling": false, "evaluation_interval": 1, "evaluation_duration": 20, "evaluation_duration_unit": "episodes", "evaluation_sample_timeout_s": 120.0, "evaluation_auto_duration_min_env_steps_per_sample": 100, "evaluation_auto_duration_max_env_steps_per_sample": 2000, "evaluation_parallel_to_training": false, "evaluation_force_reset_envs_before_iteration": true, "evaluation_config": null, "off_policy_estimation_methods": {}, "ope_split_batch_by_episode": true, "evaluation_num_env_runners": 1, "in_evaluation": false, "sync_filters_on_rollout_workers_timeout_s": 10.0, "offline_evaluation_interval": null, "num_offline_eval_runners": 0, "offline_loss_for_module_fn": null, "offline_evaluation_duration": 1, "offline_evaluation_parallel_to_training": false, "offline_evaluation_timeout_s": 120.0, "num_cpus_per_offline_eval_runner": 1, "num_gpus_per_offline_eval_runner": 0, "custom_resources_per_offline_eval_runner": {}, "restart_failed_offline_eval_runners": true, "ignore_offline_eval_runner_failures": false, "max_num_offline_eval_runner_restarts": 1000, "offline_eval_runner_restore_timeout_s": 1800.0, "max_requests_in_flight_per_offline_eval_runner": 1, "validate_offline_eval_runners_after_construction": true, "offline_eval_runner_health_probe_timeout_s": 30.0, "offline_eval_rl_module_inference_only": false, "broadcast_offline_eval_runner_states": false, "offline_eval_batch_size_per_runner": 256, "dataset_num_iters_per_eval_runner": 1, "keep_per_episode_custom_metrics": false, "metrics_episode_collection_timeout_s": 60.0, "metrics_num_episodes_for_smoothing": 100, "min_time_s_per_iteration": null, "min_train_timesteps_per_iteration": 0, "min_sample_timesteps_per_iteration": 0, "log_gradients": true, "export_native_model_files": false, "checkpoint_trainable_policies_only": false, "logger_creator": null, "logger_config": null, "log_level": "WARN", "log_sys_usage": true, "fake_sampler": false, "seed": 1, "restart_failed_env_runners": true, "ignore_env_runner_failures": false, "max_num_env_runner_restarts": 1000, "delay_between_env_runner_restarts_s": 60.0, "restart_failed_sub_environments": false, "num_consecutive_env_runner_failures_tolerance": 100, "env_runner_health_probe_timeout_s": 30.0, "env_runner_restore_timeout_s": 1800.0, "_model_config": {}, "_rl_module_spec": "RLModuleSpec(module_class=None, observation_space=None, action_space=None, inference_only=False, learner_only=False, model_config=DefaultModelConfig(fcnet_hiddens=[60, 90], fcnet_activation='tanh', fcnet_kernel_initializer=None, fcnet_kernel_initializer_kwargs=None, fcnet_bias_initializer=None, fcnet_bias_initializer_kwargs=None, conv_filters=None, conv_activation='relu', conv_kernel_initializer=None, conv_kernel_initializer_kwargs=None, conv_bias_initializer=None, conv_bias_initializer_kwargs=None, head_fcnet_hiddens=[], head_fcnet_activation='relu', head_fcnet_kernel_initializer=None, head_fcnet_kernel_initializer_kwargs=None, head_fcnet_bias_initializer=None, head_fcnet_bias_initializer_kwargs=None, free_log_std=False, log_std_clip_param=20.0, vf_share_layers=True, use_lstm=False, max_seq_len=20, lstm_cell_size=256, lstm_use_prev_action=False, lstm_use_prev_reward=False, lstm_kernel_initializer=None, lstm_kernel_initializer_kwargs=None, lstm_bias_initializer=None, lstm_bias_initializer_kwargs=None), catalog_class=None, load_state_path=None, model_config_dict=None)", "algorithm_config_overrides_per_module": {}, "_per_module_overrides": {}, "_validate_config": true, "_use_msgpack_checkpoints": false, "_torch_grad_scaler_class": null, "_torch_lr_scheduler_classes": null, "_tf_policy_handles_more_than_one_loss": false, "_disable_preprocessor_api": false, "_disable_action_flattening": false, "_disable_initialize_loss_from_dummy_batch": false, "_dont_auto_sync_env_runner_states": false, "env_task_fn": -1, "enable_connectors": -1, "simple_optimizer": false, "policy_map_cache": -1, "worker_cls": -1, "synchronize_filters": -1, "enable_async_evaluation": -1, "custom_async_evaluation_function": -1, "_enable_rl_module_api": -1, "auto_wrap_old_gym_envs": -1, "always_attach_evaluation_results": -1, "replay_sequence_length": null, "_disable_execution_plan_api": -1, "use_critic": true, "use_gae": true, "use_kl_loss": true, "kl_coeff": 0.7464963036515, "kl_target": 0.0270990929592, "vf_loss_coeff": 0.6688075857018, "entropy_coeff": 0.0090570820258, "clip_param": 0.1221781641624, "vf_clip_param": 0.1027808522125, "entropy_coeff_schedule": null, "lr_schedule": null, "sgd_minibatch_size": -1, "vf_share_layers": -1, "__stdout_file__": null, "__stderr_file__": null, "lambda": 0.9099046732075, "input": "sampler", "policies": {"default_policy": [null, null, null, null]}, "callbacks": "<class 'ray.rllib.callbacks.callbacks.RLlibCallback'>", "create_env_on_driver": false, "custom_eval_function": null, "framework": "torch"}, "time_since_restore": 13.831410884857178, "iterations_since_restore": 5, "perf": {"cpu_util_percent": 67.06666666666666, "ram_util_percent": 77.00000000000001}}
{"timers": {"training_iteration": 2.7429990768239425, "restore_env_runners": 1.2140758095225633e-05, "training_step": 2.7427906455481907, "env_runner_sampling_timer": 2.560097576367575, "learner_update_timer": 0.1780837732215392, "synch_weights": 0.0009814446549867035, "restore_eval_env_runners": 1.6949289251759182e-05, "evaluation_iteration": 0.1958538523366212, "synch_eval_env_connectors": 0.00032005688341869387, "synch_env_connectors": 5.8202578247792545e-06}, "env_runners": {"num_env_steps_sampled_lifetime": -2460000.0, "module_to_env_connector": {"timers": {"connectors": {"tensor_to_numpy": 2.1416445985687718e-05, "normalize_and_clip_actions": 1.4464816915393996e-05, "un_batch_to_individual_items": 8.370325948443117e-06, "listify_data_for_vector_env": 1.6958430225846437e-05, "remove_single_ts_time_rank_from_batch": 8.455313782711605e-07, "get_actions": 7.08399783229716e-05}}, "connector_pipeline_timer": 0.00017089048964077198}, "episode_len_min": 20, "episode_return_max": 9.5, "num_episodes": 250.0, "num_agent_steps_sampled": {"default_agent": 5000.0}, "env_to_module_connector": {"timers": {"connectors": {"add_states_from_episodes_to_batch": 2.2941073983333898e-06, "numpy_to_tensor": 1.4297011910338322e-05, "batch_individual_items": 9.929070325881972e-06, "add_time_dim_to_batch_and_zero_pad": 3.4906297487432596e-06, "add_observations_from_episodes_to_batch": 4.3560719983573835e-06}}, "connector_pipeline_timer": 6.408002615421803e-05}, "env_step_timer": 2.2473220658598025e-05, "env_reset_timer": 6.866528969247477e-05, "episode_duration_sec_mean": 0.007274405025877061, "episode_return_min": -10.5, "sample": 0.008259226526032443, "episode_len_max": 20, "module_episode_returns_mean": {"default_policy": 3.98}, "agent_episode_returns_mean": {"default_agent": 3.98}, "weights_seq_no": 5.0, "num_agent_steps_sampled_lifetime": {"default_agent": -2460000.0}, "env_to_module_sum_episodes_length_in": 10.36823839457432, "env_to_module_sum_episodes_length_out": 10.36823839457432, "num_episodes_lifetime": -123000.0, "episode_return_mean": 3.98, "time_between_sampling": 0.0023192001407122617, "num_module_steps_sampled": {"default_policy": 5000.0}, "num_module_steps_sampled_lifetime": {"default_policy": -2460000.0}, "rlmodule_inference_timer": 4.766193003292822e-05, "num_env_steps_sampled": 5000.0, "episode_len_mean": 20.0, "num_env_steps_sampled_lifetime_throughput": 2500.985867841726}, "learners": {"__all_modules__": {"num_module_steps_trained_lifetime": 36000, "learner_connector": {"timers": {"connectors": {"add_observations_from_episodes_to_batch": 0.0009628489314246245, "add_states_from_episodes_to_batch": 5.01808549099518e-06, "add_columns_from_episodes_to_train_batch": 0.04072314024414994, "batch_individual_items": 0.03586364250068233, "add_time_dim_to_batch_and_zero_pad": 1.3567253229275157e-05, "numpy_to_tensor": 7.541943315675123e-05, "general_advantage_estimation": 0.012652035381743571, "add_one_ts_to_episodes_and_truncate": 0.008911900705564472}}, "connector_pipeline_timer": 0.09938603145272544}, "num_module_steps_trained": 6000, "learner_connector_sum_episodes_length_in": 5000.0, "num_non_trainable_parameters": 0, "num_env_steps_trained": 31500, "num_env_steps_trained_lifetime": 189000, "learner_connector_sum_episodes_length_out": 5250.0, "num_trainable_parameters": 6003, "num_env_steps_trained_lifetime_throughput": 849740.9909762763, "num_module_steps_trained_throughput": 162652.9495241245, "num_module_steps_trained_lifetime_throughput": 162626.1824628358}, "default_policy": {"num_module_steps_trained_lifetime": 36000, "num_trainable_parameters": 6003, "entropy": 0.6439688205718994, "vf_explained_var": -0.018162131309509277, "num_module_steps_trained": 6000, "weights_seq_no": 6.0, "curr_entropy_coeff": 0.0090570820258, "diff_num_grad_updates_vs_sampler_policy": 1.0, "gradients_default_optimizer_global_norm": 0.053384359925985336, "curr_kl_coeff": 0.011664004996418953, "default_optimizer_learning_rate": 0.0002847858517, "vf_loss_unclipped": 27.55246925354004, "total_loss": -0.015575570054352283, "mean_kl_loss": 0.00046910226228646934, "policy_loss": -0.07849463820457458, "module_train_batch_size_mean": 1000.0, "vf_loss": 0.10278083384037018, "num_module_steps_trained_lifetime_throughput": 163016.8336599622}}, "num_training_step_calls_per_iteration": 1, "evaluation": {"env_runners": {"num_module_steps_sampled": {"default_policy": 400}, "num_episodes_lifetime": 120, "rlmodule_inference_timer": 5.248160782301371e-05, "module_to_env_connector": {"timers": {"connectors": {"remove_single_ts_time_rank_from_batch": 1.0257590417276442e-06, "normalize_and_clip_actions": 1.5187128186843519e-05, "listify_data_for_vector_env": 1.908272112134017e-05, "un_batch_to_individual_items": 7.543115841760684e-06, "get_actions": 6.668818742745806e-05, "tensor_to_numpy": 2.0563795320050353e-05}}, "connector_pipeline_timer": 0.0001683612183201832}, "module_episode_returns_mean": {"default_policy": -1.0}, "agent_episode_returns_mean": {"default_agent": -1.0}, "env_reset_timer": 0.00019868083026632757, "episode_len_max": 20, "num_agent_steps_sampled_lifetime": {"default_agent": 2400}, "episode_return_mean": -1.0, "num_agent_steps_sampled": {"default_agent": 400}, "num_env_steps_sampled": 400, "episode_len_mean": 20.0, "num_env_steps_sampled_lifetime": 30400, "episode_return_max": 12.5, "env_to_module_connector": {"connector_pipeline_timer": 7.216294018792471e-05, "timers": {"connectors": {"numpy_to_tensor": 1.600892193234761e-05, "add_observations_from_episodes_to_batch": 4.769967752312571e-06, "batch_individual_items": 1.1074173952891546e-05, "add_states_from_episodes_to_batch": 2.6149888236035484e-06, "add_time_dim_to_batch_and_zero_pad": 3.76879232728245e-06}}}, "episode_len_min": 20, "env_to_module_sum_episodes_length_in": 10.368238394470474, "num_episodes": 20, "sample": 0.1859418238395542, "weights_seq_no": 6.0, "env_to_module_sum_episodes_length_out": 10.368238394470474, "env_step_timer": 2.694100444768067e-05, "episode_duration_sec_mean": 0.006128253338392824, "episode_return_min": -12.5, "num_module_steps_sampled_lifetime": {"default_policy": 2400}, "time_between_sampling": 2.6418854907829608}, "num_healthy_workers": 1, "actor_manager_num_outstanding_async_reqs": 0, "num_remote_worker_restarts": 0}, "num_env_steps_sampled_lifetime": -2460000.0, "fault_tolerance": {"num_healthy_workers": 0, "num_remote_worker_restarts": 0}, "env_runner_group": {"actor_manager_num_outstanding_async_reqs": 0}, "done": false, "training_iteration": 6, "trial_id": "4380e_00000", "date": "2025-08-11_19-34-28", "timestamp": 1754933668, "time_this_iter_s": 2.635471820831299, "time_total_s": 16.466882705688477, "pid": 26823, "hostname": "Mac", "node_ip": "127.0.0.1", "config": {"exploration_config": {}, "extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "placement_strategy": "PACK", "num_gpus": 0, "_fake_gpus": false, "num_cpus_for_main_process": 2, "eager_tracing": true, "eager_max_retraces": 20, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "torch_compile_learner": false, "torch_compile_learner_what_to_compile": "forward_train", "torch_compile_learner_dynamo_backend": "aot_eager", "torch_compile_learner_dynamo_mode": null, "torch_compile_worker": false, "torch_compile_worker_dynamo_backend": "aot_eager", "torch_compile_worker_dynamo_mode": null, "torch_ddp_kwargs": {}, "torch_skip_nan_gradients": false, "env": "Umbrella", "env_config": {}, "observation_space": null, "action_space": null, "clip_rewards": null, "normalize_actions": true, "clip_actions": false, "_is_atari": null, "disable_env_checking": false, "render_env": false, "action_mask_key": "action_mask", "env_runner_cls": null, "num_env_runners": 0, "create_local_env_runner": true, "num_envs_per_env_runner": 1, "gym_env_vectorize_mode": "SYNC", "num_cpus_per_env_runner": 1, "num_gpus_per_env_runner": 0, "custom_resources_per_env_runner": {}, "validate_env_runners_after_construction": true, "episodes_to_numpy": true, "max_requests_in_flight_per_env_runner": 1, "sample_timeout_s": 60.0, "_env_to_module_connector": null, "add_default_connectors_to_env_to_module_pipeline": true, "_module_to_env_connector": null, "add_default_connectors_to_module_to_env_pipeline": true, "merge_env_runner_states": "training_only", "broadcast_env_runner_states": true, "episode_lookback_horizon": 1, "rollout_fragment_length": "auto", "batch_mode": "complete_episodes", "compress_observations": false, "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "enable_tf1_exec_eagerly": false, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "preprocessor_pref": "deepmind", "observation_filter": "NoFilter", "update_worker_filter_stats": true, "use_worker_filter_stats": true, "sampler_perf_stats_ema_coef": null, "_is_online": true, "num_learners": 0, "num_gpus_per_learner": 0, "num_cpus_per_learner": "auto", "num_aggregator_actors_per_learner": 0, "max_requests_in_flight_per_aggregator_actor": 3, "local_gpu_idx": 0, "max_requests_in_flight_per_learner": 3, "gamma": 1, "lr": 0.0002847858517, "grad_clip": 0.5, "grad_clip_by": "global_norm", "_train_batch_size_per_learner": 5000, "train_batch_size": 4000, "num_epochs": 1, "minibatch_size": 1000, "shuffle_batch_per_epoch": true, "model": {"fcnet_hiddens": [256, 256], "fcnet_activation": "tanh", "fcnet_weights_initializer": null, "fcnet_weights_initializer_config": null, "fcnet_bias_initializer": null, "fcnet_bias_initializer_config": null, "conv_filters": null, "conv_activation": "relu", "conv_kernel_initializer": null, "conv_kernel_initializer_config": null, "conv_bias_initializer": null, "conv_bias_initializer_config": null, "conv_transpose_kernel_initializer": null, "conv_transpose_kernel_initializer_config": null, "conv_transpose_bias_initializer": null, "conv_transpose_bias_initializer_config": null, "post_fcnet_hiddens": [], "post_fcnet_activation": "relu", "post_fcnet_weights_initializer": null, "post_fcnet_weights_initializer_config": null, "post_fcnet_bias_initializer": null, "post_fcnet_bias_initializer_config": null, "free_log_std": false, "log_std_clip_param": 20.0, "no_final_linear": false, "vf_share_layers": false, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "lstm_weights_initializer": null, "lstm_weights_initializer_config": null, "lstm_bias_initializer": null, "lstm_bias_initializer_config": null, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "attention_use_n_prev_actions": 0, "attention_use_n_prev_rewards": 0, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": null, "custom_model_config": {}, "custom_action_dist": null, "custom_preprocessor": null, "encoder_latent_dim": null, "always_check_shapes": false, "lstm_use_prev_action_reward": -1, "_use_default_native_models": -1, "_disable_preprocessor_api": false, "_disable_action_flattening": false}, "_learner_connector": null, "add_default_connectors_to_learner_pipeline": true, "learner_config_dict": {}, "optimizer": {}, "_learner_class": null, "callbacks_on_algorithm_init": null, "callbacks_on_env_runners_recreated": null, "callbacks_on_offline_eval_runners_recreated": null, "callbacks_on_checkpoint_loaded": null, "callbacks_on_environment_created": null, "callbacks_on_episode_created": null, "callbacks_on_episode_start": null, "callbacks_on_episode_step": null, "callbacks_on_episode_end": null, "callbacks_on_evaluate_start": null, "callbacks_on_evaluate_end": null, "callbacks_on_evaluate_offline_start": null, "callbacks_on_evaluate_offline_end": null, "callbacks_on_sample_end": null, "callbacks_on_train_result": null, "explore": true, "enable_rl_module_and_learner": true, "enable_env_runner_and_connector_v2": true, "_prior_exploration_config": {"type": "StochasticSampling"}, "count_steps_by": "env_steps", "policy_map_capacity": 100, "policy_mapping_fn": "<function AlgorithmConfig.DEFAULT_POLICY_MAPPING_FN at 0x14cce9b20>", "policies_to_train": null, "policy_states_are_swappable": false, "observation_fn": null, "offline_data_class": null, "input_read_method": "read_parquet", "input_read_method_kwargs": {}, "input_read_schema": {}, "input_read_episodes": false, "input_read_sample_batches": false, "input_read_batch_size": null, "input_filesystem": null, "input_filesystem_kwargs": {}, "input_compress_columns": ["obs", "new_obs"], "input_spaces_jsonable": true, "materialize_data": false, "materialize_mapped_data": true, "map_batches_kwargs": {}, "iter_batches_kwargs": {}, "ignore_final_observation": false, "prelearner_class": null, "prelearner_buffer_class": null, "prelearner_buffer_kwargs": {}, "prelearner_module_synch_period": 10, "dataset_num_iters_per_learner": null, "input_config": {}, "actions_in_input_normalized": false, "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_config": {}, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "output_max_rows_per_file": null, "output_write_remaining_data": false, "output_write_method": "write_parquet", "output_write_method_kwargs": {}, "output_filesystem": null, "output_filesystem_kwargs": {}, "output_write_episodes": true, "offline_sampling": false, "evaluation_interval": 1, "evaluation_duration": 20, "evaluation_duration_unit": "episodes", "evaluation_sample_timeout_s": 120.0, "evaluation_auto_duration_min_env_steps_per_sample": 100, "evaluation_auto_duration_max_env_steps_per_sample": 2000, "evaluation_parallel_to_training": false, "evaluation_force_reset_envs_before_iteration": true, "evaluation_config": null, "off_policy_estimation_methods": {}, "ope_split_batch_by_episode": true, "evaluation_num_env_runners": 1, "in_evaluation": false, "sync_filters_on_rollout_workers_timeout_s": 10.0, "offline_evaluation_interval": null, "num_offline_eval_runners": 0, "offline_loss_for_module_fn": null, "offline_evaluation_duration": 1, "offline_evaluation_parallel_to_training": false, "offline_evaluation_timeout_s": 120.0, "num_cpus_per_offline_eval_runner": 1, "num_gpus_per_offline_eval_runner": 0, "custom_resources_per_offline_eval_runner": {}, "restart_failed_offline_eval_runners": true, "ignore_offline_eval_runner_failures": false, "max_num_offline_eval_runner_restarts": 1000, "offline_eval_runner_restore_timeout_s": 1800.0, "max_requests_in_flight_per_offline_eval_runner": 1, "validate_offline_eval_runners_after_construction": true, "offline_eval_runner_health_probe_timeout_s": 30.0, "offline_eval_rl_module_inference_only": false, "broadcast_offline_eval_runner_states": false, "offline_eval_batch_size_per_runner": 256, "dataset_num_iters_per_eval_runner": 1, "keep_per_episode_custom_metrics": false, "metrics_episode_collection_timeout_s": 60.0, "metrics_num_episodes_for_smoothing": 100, "min_time_s_per_iteration": null, "min_train_timesteps_per_iteration": 0, "min_sample_timesteps_per_iteration": 0, "log_gradients": true, "export_native_model_files": false, "checkpoint_trainable_policies_only": false, "logger_creator": null, "logger_config": null, "log_level": "WARN", "log_sys_usage": true, "fake_sampler": false, "seed": 1, "restart_failed_env_runners": true, "ignore_env_runner_failures": false, "max_num_env_runner_restarts": 1000, "delay_between_env_runner_restarts_s": 60.0, "restart_failed_sub_environments": false, "num_consecutive_env_runner_failures_tolerance": 100, "env_runner_health_probe_timeout_s": 30.0, "env_runner_restore_timeout_s": 1800.0, "_model_config": {}, "_rl_module_spec": "RLModuleSpec(module_class=None, observation_space=None, action_space=None, inference_only=False, learner_only=False, model_config=DefaultModelConfig(fcnet_hiddens=[60, 90], fcnet_activation='tanh', fcnet_kernel_initializer=None, fcnet_kernel_initializer_kwargs=None, fcnet_bias_initializer=None, fcnet_bias_initializer_kwargs=None, conv_filters=None, conv_activation='relu', conv_kernel_initializer=None, conv_kernel_initializer_kwargs=None, conv_bias_initializer=None, conv_bias_initializer_kwargs=None, head_fcnet_hiddens=[], head_fcnet_activation='relu', head_fcnet_kernel_initializer=None, head_fcnet_kernel_initializer_kwargs=None, head_fcnet_bias_initializer=None, head_fcnet_bias_initializer_kwargs=None, free_log_std=False, log_std_clip_param=20.0, vf_share_layers=True, use_lstm=False, max_seq_len=20, lstm_cell_size=256, lstm_use_prev_action=False, lstm_use_prev_reward=False, lstm_kernel_initializer=None, lstm_kernel_initializer_kwargs=None, lstm_bias_initializer=None, lstm_bias_initializer_kwargs=None), catalog_class=None, load_state_path=None, model_config_dict=None)", "algorithm_config_overrides_per_module": {}, "_per_module_overrides": {}, "_validate_config": true, "_use_msgpack_checkpoints": false, "_torch_grad_scaler_class": null, "_torch_lr_scheduler_classes": null, "_tf_policy_handles_more_than_one_loss": false, "_disable_preprocessor_api": false, "_disable_action_flattening": false, "_disable_initialize_loss_from_dummy_batch": false, "_dont_auto_sync_env_runner_states": false, "env_task_fn": -1, "enable_connectors": -1, "simple_optimizer": false, "policy_map_cache": -1, "worker_cls": -1, "synchronize_filters": -1, "enable_async_evaluation": -1, "custom_async_evaluation_function": -1, "_enable_rl_module_api": -1, "auto_wrap_old_gym_envs": -1, "always_attach_evaluation_results": -1, "replay_sequence_length": null, "_disable_execution_plan_api": -1, "use_critic": true, "use_gae": true, "use_kl_loss": true, "kl_coeff": 0.7464963036515, "kl_target": 0.0270990929592, "vf_loss_coeff": 0.6688075857018, "entropy_coeff": 0.0090570820258, "clip_param": 0.1221781641624, "vf_clip_param": 0.1027808522125, "entropy_coeff_schedule": null, "lr_schedule": null, "sgd_minibatch_size": -1, "vf_share_layers": -1, "__stdout_file__": null, "__stderr_file__": null, "lambda": 0.9099046732075, "input": "sampler", "policies": {"default_policy": [null, null, null, null]}, "callbacks": "<class 'ray.rllib.callbacks.callbacks.RLlibCallback'>", "create_env_on_driver": false, "custom_eval_function": null, "framework": "torch"}, "time_since_restore": 16.466882705688477, "iterations_since_restore": 6, "perf": {"cpu_util_percent": 68.375, "ram_util_percent": 77.375}}
{"timers": {"training_iteration": 2.738729248964892, "restore_env_runners": 1.2088100746731492e-05, "training_step": 2.7385207120131616, "env_runner_sampling_timer": 2.556488986853957, "learner_update_timer": 0.17743460256965912, "synch_weights": 0.0009781147874989256, "restore_eval_env_runners": 1.686520678840636e-05, "evaluation_iteration": 0.19545519840335174, "synch_eval_env_connectors": 0.0003188604846763297, "synch_env_connectors": 5.8033046875144e-06}, "env_runners": {"num_env_steps_sampled_lifetime": -3077500.0, "module_to_env_connector": {"timers": {"connectors": {"tensor_to_numpy": 2.0957589238468158e-05, "normalize_and_clip_actions": 1.4364754819919701e-05, "un_batch_to_individual_items": 8.018582379108227e-06, "listify_data_for_vector_env": 1.692014021194572e-05, "remove_single_ts_time_rank_from_batch": 9.11037836043616e-07, "get_actions": 6.960318093372675e-05}}, "connector_pipeline_timer": 0.00016821053586960866}, "episode_len_min": 20, "episode_return_max": 9.5, "num_episodes": 250.0, "num_agent_steps_sampled": {"default_agent": 5000.0}, "env_to_module_connector": {"timers": {"connectors": {"add_states_from_episodes_to_batch": 2.449772493371955e-06, "numpy_to_tensor": 1.4548878937787603e-05, "batch_individual_items": 1.0106872900084865e-05, "add_time_dim_to_batch_and_zero_pad": 3.541105095899586e-06, "add_observations_from_episodes_to_batch": 4.7347066075118685e-06}}, "connector_pipeline_timer": 6.539552974195307e-05}, "env_step_timer": 2.2550035060563952e-05, "env_reset_timer": 6.631905465863995e-05, "episode_duration_sec_mean": 0.007286652672570199, "episode_return_min": -10.5, "sample": 0.007736487420133547, "episode_len_max": 20, "module_episode_returns_mean": {"default_policy": 3.98}, "agent_episode_returns_mean": {"default_agent": 3.98}, "weights_seq_no": 6.0, "num_agent_steps_sampled_lifetime": {"default_agent": -3077500.0}, "env_to_module_sum_episodes_length_in": 10.36823839457432, "env_to_module_sum_episodes_length_out": 10.36823839457432, "num_episodes_lifetime": -153875.0, "episode_return_mean": 3.98, "time_between_sampling": 0.0027078139732368313, "num_module_steps_sampled": {"default_policy": 5000.0}, "num_module_steps_sampled_lifetime": {"default_policy": -3077500.0}, "rlmodule_inference_timer": 4.693347420823439e-05, "num_env_steps_sampled": 5000.0, "episode_len_mean": 20.0, "num_env_steps_sampled_lifetime_throughput": 2547.4587364083186}, "learners": {"__all_modules__": {"num_module_steps_trained_lifetime": 42000, "learner_connector": {"timers": {"connectors": {"add_observations_from_episodes_to_batch": 0.0009645850222424454, "add_states_from_episodes_to_batch": 5.002484643280701e-06, "add_columns_from_episodes_to_train_batch": 0.0407402875923214, "batch_individual_items": 0.03586943273532847, "add_time_dim_to_batch_and_zero_pad": 1.3531580294278524e-05, "numpy_to_tensor": 7.559273948478363e-05, "general_advantage_estimation": 0.012579089198377748, "add_one_ts_to_episodes_and_truncate": 0.008932702528509018}}, "connector_pipeline_timer": 0.09935811197757635}, "num_module_steps_trained": 6000, "learner_connector_sum_episodes_length_in": 5000.0, "num_non_trainable_parameters": 0, "num_env_steps_trained": 31500, "num_env_steps_trained_lifetime": 220500, "learner_connector_sum_episodes_length_out": 5250.0, "num_trainable_parameters": 6003, "num_env_steps_trained_lifetime_throughput": 882764.5350546994, "num_module_steps_trained_throughput": 168919.40513599722, "num_module_steps_trained_lifetime_throughput": 168888.98217087472}, "default_policy": {"num_module_steps_trained_lifetime": 42000, "num_trainable_parameters": 6003, "entropy": 0.6286616325378418, "vf_explained_var": -0.018402576446533203, "num_module_steps_trained": 6000, "weights_seq_no": 7.0, "curr_entropy_coeff": 0.0090570820258, "diff_num_grad_updates_vs_sampler_policy": 1.0, "gradients_default_optimizer_global_norm": 0.07997886091470718, "curr_kl_coeff": 0.0058320024982094765, "default_optimizer_learning_rate": 0.0002847858517, "vf_loss_unclipped": 27.66732406616211, "total_loss": 0.04111754521727562, "mean_kl_loss": 0.0006850841455161572, "policy_loss": -0.02193720079958439, "module_train_batch_size_mean": 1000.0, "vf_loss": 0.10278083384037018, "num_module_steps_trained_lifetime_throughput": 169241.47457193278}}, "num_training_step_calls_per_iteration": 1, "evaluation": {"env_runners": {"num_module_steps_sampled": {"default_policy": 400}, "num_episodes_lifetime": 140, "rlmodule_inference_timer": 3.63539155473093e-05, "module_to_env_connector": {"timers": {"connectors": {"remove_single_ts_time_rank_from_batch": 6.743674931064392e-07, "normalize_and_clip_actions": 1.1594086708403118e-05, "listify_data_for_vector_env": 1.3603250061983649e-05, "un_batch_to_individual_items": 6.483703020191818e-06, "get_actions": 5.051989985174557e-05, "tensor_to_numpy": 1.6536205084000836e-05}}, "connector_pipeline_timer": 0.0001297334522575521}, "module_episode_returns_mean": {"default_policy": -0.4}, "agent_episode_returns_mean": {"default_agent": -0.4}, "env_reset_timer": 0.0001975806818000609, "episode_len_max": 20, "num_agent_steps_sampled_lifetime": {"default_agent": 2800}, "episode_return_mean": -0.4, "num_agent_steps_sampled": {"default_agent": 400}, "num_env_steps_sampled": 400, "episode_len_mean": 20.0, "num_env_steps_sampled_lifetime": 35400, "episode_return_max": 12.5, "env_to_module_connector": {"connector_pipeline_timer": 5.2127935271386695e-05, "timers": {"connectors": {"numpy_to_tensor": 1.0881565301413893e-05, "add_observations_from_episodes_to_batch": 3.3076506485259996e-06, "batch_individual_items": 8.036262949908562e-06, "add_states_from_episodes_to_batch": 1.971035156499016e-06, "add_time_dim_to_batch_and_zero_pad": 2.707227292805437e-06}}}, "episode_len_min": 20, "env_to_module_sum_episodes_length_in": 10.368238394572801, "num_episodes": 20, "sample": 0.1853717222707308, "weights_seq_no": 7.0, "env_to_module_sum_episodes_length_out": 10.368238394572801, "env_step_timer": 1.76864012672215e-05, "episode_duration_sec_mean": 0.0061769720981828865, "episode_return_min": -12.5, "num_module_steps_sampled_lifetime": {"default_policy": 2800}, "time_between_sampling": 2.638862018784934}, "num_healthy_workers": 1, "actor_manager_num_outstanding_async_reqs": 0, "num_remote_worker_restarts": 0}, "num_env_steps_sampled_lifetime": -3077500.0, "fault_tolerance": {"num_healthy_workers": 0, "num_remote_worker_restarts": 0}, "env_runner_group": {"actor_manager_num_outstanding_async_reqs": 0}, "done": false, "training_iteration": 7, "trial_id": "4380e_00000", "date": "2025-08-11_19-34-30", "timestamp": 1754933670, "time_this_iter_s": 2.452336072921753, "time_total_s": 18.91921877861023, "pid": 26823, "hostname": "Mac", "node_ip": "127.0.0.1", "config": {"exploration_config": {}, "extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "placement_strategy": "PACK", "num_gpus": 0, "_fake_gpus": false, "num_cpus_for_main_process": 2, "eager_tracing": true, "eager_max_retraces": 20, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "torch_compile_learner": false, "torch_compile_learner_what_to_compile": "forward_train", "torch_compile_learner_dynamo_backend": "aot_eager", "torch_compile_learner_dynamo_mode": null, "torch_compile_worker": false, "torch_compile_worker_dynamo_backend": "aot_eager", "torch_compile_worker_dynamo_mode": null, "torch_ddp_kwargs": {}, "torch_skip_nan_gradients": false, "env": "Umbrella", "env_config": {}, "observation_space": null, "action_space": null, "clip_rewards": null, "normalize_actions": true, "clip_actions": false, "_is_atari": null, "disable_env_checking": false, "render_env": false, "action_mask_key": "action_mask", "env_runner_cls": null, "num_env_runners": 0, "create_local_env_runner": true, "num_envs_per_env_runner": 1, "gym_env_vectorize_mode": "SYNC", "num_cpus_per_env_runner": 1, "num_gpus_per_env_runner": 0, "custom_resources_per_env_runner": {}, "validate_env_runners_after_construction": true, "episodes_to_numpy": true, "max_requests_in_flight_per_env_runner": 1, "sample_timeout_s": 60.0, "_env_to_module_connector": null, "add_default_connectors_to_env_to_module_pipeline": true, "_module_to_env_connector": null, "add_default_connectors_to_module_to_env_pipeline": true, "merge_env_runner_states": "training_only", "broadcast_env_runner_states": true, "episode_lookback_horizon": 1, "rollout_fragment_length": "auto", "batch_mode": "complete_episodes", "compress_observations": false, "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "enable_tf1_exec_eagerly": false, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "preprocessor_pref": "deepmind", "observation_filter": "NoFilter", "update_worker_filter_stats": true, "use_worker_filter_stats": true, "sampler_perf_stats_ema_coef": null, "_is_online": true, "num_learners": 0, "num_gpus_per_learner": 0, "num_cpus_per_learner": "auto", "num_aggregator_actors_per_learner": 0, "max_requests_in_flight_per_aggregator_actor": 3, "local_gpu_idx": 0, "max_requests_in_flight_per_learner": 3, "gamma": 1, "lr": 0.0002847858517, "grad_clip": 0.5, "grad_clip_by": "global_norm", "_train_batch_size_per_learner": 5000, "train_batch_size": 4000, "num_epochs": 1, "minibatch_size": 1000, "shuffle_batch_per_epoch": true, "model": {"fcnet_hiddens": [256, 256], "fcnet_activation": "tanh", "fcnet_weights_initializer": null, "fcnet_weights_initializer_config": null, "fcnet_bias_initializer": null, "fcnet_bias_initializer_config": null, "conv_filters": null, "conv_activation": "relu", "conv_kernel_initializer": null, "conv_kernel_initializer_config": null, "conv_bias_initializer": null, "conv_bias_initializer_config": null, "conv_transpose_kernel_initializer": null, "conv_transpose_kernel_initializer_config": null, "conv_transpose_bias_initializer": null, "conv_transpose_bias_initializer_config": null, "post_fcnet_hiddens": [], "post_fcnet_activation": "relu", "post_fcnet_weights_initializer": null, "post_fcnet_weights_initializer_config": null, "post_fcnet_bias_initializer": null, "post_fcnet_bias_initializer_config": null, "free_log_std": false, "log_std_clip_param": 20.0, "no_final_linear": false, "vf_share_layers": false, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "lstm_weights_initializer": null, "lstm_weights_initializer_config": null, "lstm_bias_initializer": null, "lstm_bias_initializer_config": null, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "attention_use_n_prev_actions": 0, "attention_use_n_prev_rewards": 0, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": null, "custom_model_config": {}, "custom_action_dist": null, "custom_preprocessor": null, "encoder_latent_dim": null, "always_check_shapes": false, "lstm_use_prev_action_reward": -1, "_use_default_native_models": -1, "_disable_preprocessor_api": false, "_disable_action_flattening": false}, "_learner_connector": null, "add_default_connectors_to_learner_pipeline": true, "learner_config_dict": {}, "optimizer": {}, "_learner_class": null, "callbacks_on_algorithm_init": null, "callbacks_on_env_runners_recreated": null, "callbacks_on_offline_eval_runners_recreated": null, "callbacks_on_checkpoint_loaded": null, "callbacks_on_environment_created": null, "callbacks_on_episode_created": null, "callbacks_on_episode_start": null, "callbacks_on_episode_step": null, "callbacks_on_episode_end": null, "callbacks_on_evaluate_start": null, "callbacks_on_evaluate_end": null, "callbacks_on_evaluate_offline_start": null, "callbacks_on_evaluate_offline_end": null, "callbacks_on_sample_end": null, "callbacks_on_train_result": null, "explore": true, "enable_rl_module_and_learner": true, "enable_env_runner_and_connector_v2": true, "_prior_exploration_config": {"type": "StochasticSampling"}, "count_steps_by": "env_steps", "policy_map_capacity": 100, "policy_mapping_fn": "<function AlgorithmConfig.DEFAULT_POLICY_MAPPING_FN at 0x14cce9b20>", "policies_to_train": null, "policy_states_are_swappable": false, "observation_fn": null, "offline_data_class": null, "input_read_method": "read_parquet", "input_read_method_kwargs": {}, "input_read_schema": {}, "input_read_episodes": false, "input_read_sample_batches": false, "input_read_batch_size": null, "input_filesystem": null, "input_filesystem_kwargs": {}, "input_compress_columns": ["obs", "new_obs"], "input_spaces_jsonable": true, "materialize_data": false, "materialize_mapped_data": true, "map_batches_kwargs": {}, "iter_batches_kwargs": {}, "ignore_final_observation": false, "prelearner_class": null, "prelearner_buffer_class": null, "prelearner_buffer_kwargs": {}, "prelearner_module_synch_period": 10, "dataset_num_iters_per_learner": null, "input_config": {}, "actions_in_input_normalized": false, "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_config": {}, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "output_max_rows_per_file": null, "output_write_remaining_data": false, "output_write_method": "write_parquet", "output_write_method_kwargs": {}, "output_filesystem": null, "output_filesystem_kwargs": {}, "output_write_episodes": true, "offline_sampling": false, "evaluation_interval": 1, "evaluation_duration": 20, "evaluation_duration_unit": "episodes", "evaluation_sample_timeout_s": 120.0, "evaluation_auto_duration_min_env_steps_per_sample": 100, "evaluation_auto_duration_max_env_steps_per_sample": 2000, "evaluation_parallel_to_training": false, "evaluation_force_reset_envs_before_iteration": true, "evaluation_config": null, "off_policy_estimation_methods": {}, "ope_split_batch_by_episode": true, "evaluation_num_env_runners": 1, "in_evaluation": false, "sync_filters_on_rollout_workers_timeout_s": 10.0, "offline_evaluation_interval": null, "num_offline_eval_runners": 0, "offline_loss_for_module_fn": null, "offline_evaluation_duration": 1, "offline_evaluation_parallel_to_training": false, "offline_evaluation_timeout_s": 120.0, "num_cpus_per_offline_eval_runner": 1, "num_gpus_per_offline_eval_runner": 0, "custom_resources_per_offline_eval_runner": {}, "restart_failed_offline_eval_runners": true, "ignore_offline_eval_runner_failures": false, "max_num_offline_eval_runner_restarts": 1000, "offline_eval_runner_restore_timeout_s": 1800.0, "max_requests_in_flight_per_offline_eval_runner": 1, "validate_offline_eval_runners_after_construction": true, "offline_eval_runner_health_probe_timeout_s": 30.0, "offline_eval_rl_module_inference_only": false, "broadcast_offline_eval_runner_states": false, "offline_eval_batch_size_per_runner": 256, "dataset_num_iters_per_eval_runner": 1, "keep_per_episode_custom_metrics": false, "metrics_episode_collection_timeout_s": 60.0, "metrics_num_episodes_for_smoothing": 100, "min_time_s_per_iteration": null, "min_train_timesteps_per_iteration": 0, "min_sample_timesteps_per_iteration": 0, "log_gradients": true, "export_native_model_files": false, "checkpoint_trainable_policies_only": false, "logger_creator": null, "logger_config": null, "log_level": "WARN", "log_sys_usage": true, "fake_sampler": false, "seed": 1, "restart_failed_env_runners": true, "ignore_env_runner_failures": false, "max_num_env_runner_restarts": 1000, "delay_between_env_runner_restarts_s": 60.0, "restart_failed_sub_environments": false, "num_consecutive_env_runner_failures_tolerance": 100, "env_runner_health_probe_timeout_s": 30.0, "env_runner_restore_timeout_s": 1800.0, "_model_config": {}, "_rl_module_spec": "RLModuleSpec(module_class=None, observation_space=None, action_space=None, inference_only=False, learner_only=False, model_config=DefaultModelConfig(fcnet_hiddens=[60, 90], fcnet_activation='tanh', fcnet_kernel_initializer=None, fcnet_kernel_initializer_kwargs=None, fcnet_bias_initializer=None, fcnet_bias_initializer_kwargs=None, conv_filters=None, conv_activation='relu', conv_kernel_initializer=None, conv_kernel_initializer_kwargs=None, conv_bias_initializer=None, conv_bias_initializer_kwargs=None, head_fcnet_hiddens=[], head_fcnet_activation='relu', head_fcnet_kernel_initializer=None, head_fcnet_kernel_initializer_kwargs=None, head_fcnet_bias_initializer=None, head_fcnet_bias_initializer_kwargs=None, free_log_std=False, log_std_clip_param=20.0, vf_share_layers=True, use_lstm=False, max_seq_len=20, lstm_cell_size=256, lstm_use_prev_action=False, lstm_use_prev_reward=False, lstm_kernel_initializer=None, lstm_kernel_initializer_kwargs=None, lstm_bias_initializer=None, lstm_bias_initializer_kwargs=None), catalog_class=None, load_state_path=None, model_config_dict=None)", "algorithm_config_overrides_per_module": {}, "_per_module_overrides": {}, "_validate_config": true, "_use_msgpack_checkpoints": false, "_torch_grad_scaler_class": null, "_torch_lr_scheduler_classes": null, "_tf_policy_handles_more_than_one_loss": false, "_disable_preprocessor_api": false, "_disable_action_flattening": false, "_disable_initialize_loss_from_dummy_batch": false, "_dont_auto_sync_env_runner_states": false, "env_task_fn": -1, "enable_connectors": -1, "simple_optimizer": false, "policy_map_cache": -1, "worker_cls": -1, "synchronize_filters": -1, "enable_async_evaluation": -1, "custom_async_evaluation_function": -1, "_enable_rl_module_api": -1, "auto_wrap_old_gym_envs": -1, "always_attach_evaluation_results": -1, "replay_sequence_length": null, "_disable_execution_plan_api": -1, "use_critic": true, "use_gae": true, "use_kl_loss": true, "kl_coeff": 0.7464963036515, "kl_target": 0.0270990929592, "vf_loss_coeff": 0.6688075857018, "entropy_coeff": 0.0090570820258, "clip_param": 0.1221781641624, "vf_clip_param": 0.1027808522125, "entropy_coeff_schedule": null, "lr_schedule": null, "sgd_minibatch_size": -1, "vf_share_layers": -1, "__stdout_file__": null, "__stderr_file__": null, "lambda": 0.9099046732075, "input": "sampler", "policies": {"default_policy": [null, null, null, null]}, "callbacks": "<class 'ray.rllib.callbacks.callbacks.RLlibCallback'>", "create_env_on_driver": false, "custom_eval_function": null, "framework": "torch"}, "time_since_restore": 18.91921877861023, "iterations_since_restore": 7, "perf": {"cpu_util_percent": 66.83333333333333, "ram_util_percent": 77.3}}
{"timers": {"training_iteration": 2.7365719210551642, "restore_env_runners": 1.2025560113644528e-05, "training_step": 2.73636336030206, "env_runner_sampling_timer": 2.5549596669852503, "learner_update_timer": 0.17681696737378114, "synch_weights": 0.0009766277994032613, "restore_eval_env_runners": 1.6767394608007207e-05, "evaluation_iteration": 0.19484041933920962, "synch_eval_env_connectors": 0.0003167673002776759, "synch_env_connectors": 5.799440854038547e-06}, "env_runners": {"num_env_steps_sampled_lifetime": -3695000.0, "module_to_env_connector": {"timers": {"connectors": {"tensor_to_numpy": 2.2324331717968383e-05, "normalize_and_clip_actions": 1.5074809900790205e-05, "un_batch_to_individual_items": 8.423842422507163e-06, "listify_data_for_vector_env": 1.7701333634142535e-05, "remove_single_ts_time_rank_from_batch": 9.632938514628239e-07, "get_actions": 7.210018442399382e-05}}, "connector_pipeline_timer": 0.00017532734184945225}, "episode_len_min": 20, "episode_return_max": 9.5, "num_episodes": 250.0, "num_agent_steps_sampled": {"default_agent": 5000.0}, "env_to_module_connector": {"timers": {"connectors": {"add_states_from_episodes_to_batch": 2.456229708466444e-06, "numpy_to_tensor": 1.5058599752557961e-05, "batch_individual_items": 1.0663675488418106e-05, "add_time_dim_to_batch_and_zero_pad": 3.946748929183216e-06, "add_observations_from_episodes_to_batch": 4.712249791151092e-06}}, "connector_pipeline_timer": 6.774431662375732e-05}, "env_step_timer": 2.317048572982284e-05, "env_reset_timer": 6.988422893484936e-05, "episode_duration_sec_mean": 0.00806017635576427, "episode_return_min": -10.5, "sample": 0.008347468843162576, "episode_len_max": 20, "module_episode_returns_mean": {"default_policy": 3.339999999999999}, "agent_episode_returns_mean": {"default_agent": 3.339999999999999}, "weights_seq_no": 7.0, "num_agent_steps_sampled_lifetime": {"default_agent": -3695000.0}, "env_to_module_sum_episodes_length_in": 10.36823839457432, "env_to_module_sum_episodes_length_out": 10.36823839457432, "num_episodes_lifetime": -184750.0, "episode_return_mean": 3.339999999999999, "time_between_sampling": 0.00216962047992266, "num_module_steps_sampled": {"default_policy": 5000.0}, "num_module_steps_sampled_lifetime": {"default_policy": -3695000.0}, "rlmodule_inference_timer": 6.94509936931641e-05, "num_env_steps_sampled": 5000.0, "episode_len_mean": 20.0, "num_env_steps_sampled_lifetime_throughput": 2477.3720687347864}, "learners": {"__all_modules__": {"num_module_steps_trained_lifetime": 48000, "learner_connector": {"timers": {"connectors": {"add_observations_from_episodes_to_batch": 0.0009677133414650588, "add_states_from_episodes_to_batch": 4.985789503486946e-06, "add_columns_from_episodes_to_train_batch": 0.04072967596707596, "batch_individual_items": 0.03587237423846138, "add_time_dim_to_batch_and_zero_pad": 1.3525434275822033e-05, "numpy_to_tensor": 7.556640204581704e-05, "general_advantage_estimation": 0.01253210539657024, "add_one_ts_to_episodes_and_truncate": 0.008944898002686517}}, "connector_pipeline_timer": 0.0993184258580758}, "num_module_steps_trained": 6000, "learner_connector_sum_episodes_length_in": 5000.0, "num_non_trainable_parameters": 0, "num_env_steps_trained": 31500, "num_env_steps_trained_lifetime": 252000, "learner_connector_sum_episodes_length_out": 5250.0, "num_trainable_parameters": 6003, "num_env_steps_trained_lifetime_throughput": 914021.1821284726, "num_module_steps_trained_throughput": 174837.24056681164, "num_module_steps_trained_lifetime_throughput": 174809.5651633076}, "default_policy": {"num_module_steps_trained_lifetime": 48000, "num_trainable_parameters": 6003, "entropy": 0.6131623983383179, "vf_explained_var": -0.018987655639648438, "num_module_steps_trained": 6000, "weights_seq_no": 8.0, "curr_entropy_coeff": 0.0090570820258, "diff_num_grad_updates_vs_sampler_policy": 1.0, "gradients_default_optimizer_global_norm": 0.016191862523555756, "curr_kl_coeff": 0.0029160012491047382, "default_optimizer_learning_rate": 0.0002847858517, "vf_loss_unclipped": 27.65814781188965, "total_loss": -0.014293914660811424, "mean_kl_loss": 0.0005429149605333805, "policy_loss": -0.07748422771692276, "module_train_batch_size_mean": 1000.0, "vf_loss": 0.10278083384037018, "num_module_steps_trained_lifetime_throughput": 175120.04124471053}}, "num_training_step_calls_per_iteration": 1, "evaluation": {"env_runners": {"num_module_steps_sampled": {"default_policy": 400}, "num_episodes_lifetime": 160, "rlmodule_inference_timer": 5.199500187232982e-05, "module_to_env_connector": {"timers": {"connectors": {"remove_single_ts_time_rank_from_batch": 9.129297754670224e-07, "normalize_and_clip_actions": 1.7069526605697056e-05, "listify_data_for_vector_env": 2.0604363664649455e-05, "un_batch_to_individual_items": 9.470763618351542e-06, "get_actions": 7.97054226536871e-05, "tensor_to_numpy": 2.8078584639199416e-05}}, "connector_pipeline_timer": 0.00019965520360112223}, "module_episode_returns_mean": {"default_policy": -0.6}, "agent_episode_returns_mean": {"default_agent": -0.6}, "env_reset_timer": 0.0001963898751386715, "episode_len_max": 20, "num_agent_steps_sampled_lifetime": {"default_agent": 3200}, "episode_return_mean": -0.6, "num_agent_steps_sampled": {"default_agent": 400}, "num_env_steps_sampled": 400, "episode_len_mean": 20.0, "num_env_steps_sampled_lifetime": 40400, "episode_return_max": 12.5, "env_to_module_connector": {"connector_pipeline_timer": 7.217794450754227e-05, "timers": {"connectors": {"numpy_to_tensor": 1.616824749669534e-05, "add_observations_from_episodes_to_batch": 4.36018464805088e-06, "batch_individual_items": 1.1429802811996045e-05, "add_states_from_episodes_to_batch": 2.8062904880689374e-06, "add_time_dim_to_batch_and_zero_pad": 4.2009369195313925e-06}}}, "episode_len_min": 20, "env_to_module_sum_episodes_length_in": 10.3682383945743, "num_episodes": 20, "sample": 0.1853572662985939, "weights_seq_no": 8.0, "env_to_module_sum_episodes_length_out": 10.3682383945743, "env_step_timer": 2.6778964150354176e-05, "episode_duration_sec_mean": 0.00663175206980668, "episode_return_min": -12.5, "num_module_steps_sampled_lifetime": {"default_policy": 3200}, "time_between_sampling": 2.637924649007491}, "num_healthy_workers": 1, "actor_manager_num_outstanding_async_reqs": 0, "num_remote_worker_restarts": 0}, "num_env_steps_sampled_lifetime": -3695000.0, "fault_tolerance": {"num_healthy_workers": 0, "num_remote_worker_restarts": 0}, "env_runner_group": {"actor_manager_num_outstanding_async_reqs": 0}, "done": false, "training_iteration": 8, "trial_id": "4380e_00000", "date": "2025-08-11_19-34-33", "timestamp": 1754933673, "time_this_iter_s": 2.7164418697357178, "time_total_s": 21.635660648345947, "pid": 26823, "hostname": "Mac", "node_ip": "127.0.0.1", "config": {"exploration_config": {}, "extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "placement_strategy": "PACK", "num_gpus": 0, "_fake_gpus": false, "num_cpus_for_main_process": 2, "eager_tracing": true, "eager_max_retraces": 20, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "torch_compile_learner": false, "torch_compile_learner_what_to_compile": "forward_train", "torch_compile_learner_dynamo_backend": "aot_eager", "torch_compile_learner_dynamo_mode": null, "torch_compile_worker": false, "torch_compile_worker_dynamo_backend": "aot_eager", "torch_compile_worker_dynamo_mode": null, "torch_ddp_kwargs": {}, "torch_skip_nan_gradients": false, "env": "Umbrella", "env_config": {}, "observation_space": null, "action_space": null, "clip_rewards": null, "normalize_actions": true, "clip_actions": false, "_is_atari": null, "disable_env_checking": false, "render_env": false, "action_mask_key": "action_mask", "env_runner_cls": null, "num_env_runners": 0, "create_local_env_runner": true, "num_envs_per_env_runner": 1, "gym_env_vectorize_mode": "SYNC", "num_cpus_per_env_runner": 1, "num_gpus_per_env_runner": 0, "custom_resources_per_env_runner": {}, "validate_env_runners_after_construction": true, "episodes_to_numpy": true, "max_requests_in_flight_per_env_runner": 1, "sample_timeout_s": 60.0, "_env_to_module_connector": null, "add_default_connectors_to_env_to_module_pipeline": true, "_module_to_env_connector": null, "add_default_connectors_to_module_to_env_pipeline": true, "merge_env_runner_states": "training_only", "broadcast_env_runner_states": true, "episode_lookback_horizon": 1, "rollout_fragment_length": "auto", "batch_mode": "complete_episodes", "compress_observations": false, "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "enable_tf1_exec_eagerly": false, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "preprocessor_pref": "deepmind", "observation_filter": "NoFilter", "update_worker_filter_stats": true, "use_worker_filter_stats": true, "sampler_perf_stats_ema_coef": null, "_is_online": true, "num_learners": 0, "num_gpus_per_learner": 0, "num_cpus_per_learner": "auto", "num_aggregator_actors_per_learner": 0, "max_requests_in_flight_per_aggregator_actor": 3, "local_gpu_idx": 0, "max_requests_in_flight_per_learner": 3, "gamma": 1, "lr": 0.0002847858517, "grad_clip": 0.5, "grad_clip_by": "global_norm", "_train_batch_size_per_learner": 5000, "train_batch_size": 4000, "num_epochs": 1, "minibatch_size": 1000, "shuffle_batch_per_epoch": true, "model": {"fcnet_hiddens": [256, 256], "fcnet_activation": "tanh", "fcnet_weights_initializer": null, "fcnet_weights_initializer_config": null, "fcnet_bias_initializer": null, "fcnet_bias_initializer_config": null, "conv_filters": null, "conv_activation": "relu", "conv_kernel_initializer": null, "conv_kernel_initializer_config": null, "conv_bias_initializer": null, "conv_bias_initializer_config": null, "conv_transpose_kernel_initializer": null, "conv_transpose_kernel_initializer_config": null, "conv_transpose_bias_initializer": null, "conv_transpose_bias_initializer_config": null, "post_fcnet_hiddens": [], "post_fcnet_activation": "relu", "post_fcnet_weights_initializer": null, "post_fcnet_weights_initializer_config": null, "post_fcnet_bias_initializer": null, "post_fcnet_bias_initializer_config": null, "free_log_std": false, "log_std_clip_param": 20.0, "no_final_linear": false, "vf_share_layers": false, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "lstm_weights_initializer": null, "lstm_weights_initializer_config": null, "lstm_bias_initializer": null, "lstm_bias_initializer_config": null, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "attention_use_n_prev_actions": 0, "attention_use_n_prev_rewards": 0, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": null, "custom_model_config": {}, "custom_action_dist": null, "custom_preprocessor": null, "encoder_latent_dim": null, "always_check_shapes": false, "lstm_use_prev_action_reward": -1, "_use_default_native_models": -1, "_disable_preprocessor_api": false, "_disable_action_flattening": false}, "_learner_connector": null, "add_default_connectors_to_learner_pipeline": true, "learner_config_dict": {}, "optimizer": {}, "_learner_class": null, "callbacks_on_algorithm_init": null, "callbacks_on_env_runners_recreated": null, "callbacks_on_offline_eval_runners_recreated": null, "callbacks_on_checkpoint_loaded": null, "callbacks_on_environment_created": null, "callbacks_on_episode_created": null, "callbacks_on_episode_start": null, "callbacks_on_episode_step": null, "callbacks_on_episode_end": null, "callbacks_on_evaluate_start": null, "callbacks_on_evaluate_end": null, "callbacks_on_evaluate_offline_start": null, "callbacks_on_evaluate_offline_end": null, "callbacks_on_sample_end": null, "callbacks_on_train_result": null, "explore": true, "enable_rl_module_and_learner": true, "enable_env_runner_and_connector_v2": true, "_prior_exploration_config": {"type": "StochasticSampling"}, "count_steps_by": "env_steps", "policy_map_capacity": 100, "policy_mapping_fn": "<function AlgorithmConfig.DEFAULT_POLICY_MAPPING_FN at 0x14cce9b20>", "policies_to_train": null, "policy_states_are_swappable": false, "observation_fn": null, "offline_data_class": null, "input_read_method": "read_parquet", "input_read_method_kwargs": {}, "input_read_schema": {}, "input_read_episodes": false, "input_read_sample_batches": false, "input_read_batch_size": null, "input_filesystem": null, "input_filesystem_kwargs": {}, "input_compress_columns": ["obs", "new_obs"], "input_spaces_jsonable": true, "materialize_data": false, "materialize_mapped_data": true, "map_batches_kwargs": {}, "iter_batches_kwargs": {}, "ignore_final_observation": false, "prelearner_class": null, "prelearner_buffer_class": null, "prelearner_buffer_kwargs": {}, "prelearner_module_synch_period": 10, "dataset_num_iters_per_learner": null, "input_config": {}, "actions_in_input_normalized": false, "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_config": {}, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "output_max_rows_per_file": null, "output_write_remaining_data": false, "output_write_method": "write_parquet", "output_write_method_kwargs": {}, "output_filesystem": null, "output_filesystem_kwargs": {}, "output_write_episodes": true, "offline_sampling": false, "evaluation_interval": 1, "evaluation_duration": 20, "evaluation_duration_unit": "episodes", "evaluation_sample_timeout_s": 120.0, "evaluation_auto_duration_min_env_steps_per_sample": 100, "evaluation_auto_duration_max_env_steps_per_sample": 2000, "evaluation_parallel_to_training": false, "evaluation_force_reset_envs_before_iteration": true, "evaluation_config": null, "off_policy_estimation_methods": {}, "ope_split_batch_by_episode": true, "evaluation_num_env_runners": 1, "in_evaluation": false, "sync_filters_on_rollout_workers_timeout_s": 10.0, "offline_evaluation_interval": null, "num_offline_eval_runners": 0, "offline_loss_for_module_fn": null, "offline_evaluation_duration": 1, "offline_evaluation_parallel_to_training": false, "offline_evaluation_timeout_s": 120.0, "num_cpus_per_offline_eval_runner": 1, "num_gpus_per_offline_eval_runner": 0, "custom_resources_per_offline_eval_runner": {}, "restart_failed_offline_eval_runners": true, "ignore_offline_eval_runner_failures": false, "max_num_offline_eval_runner_restarts": 1000, "offline_eval_runner_restore_timeout_s": 1800.0, "max_requests_in_flight_per_offline_eval_runner": 1, "validate_offline_eval_runners_after_construction": true, "offline_eval_runner_health_probe_timeout_s": 30.0, "offline_eval_rl_module_inference_only": false, "broadcast_offline_eval_runner_states": false, "offline_eval_batch_size_per_runner": 256, "dataset_num_iters_per_eval_runner": 1, "keep_per_episode_custom_metrics": false, "metrics_episode_collection_timeout_s": 60.0, "metrics_num_episodes_for_smoothing": 100, "min_time_s_per_iteration": null, "min_train_timesteps_per_iteration": 0, "min_sample_timesteps_per_iteration": 0, "log_gradients": true, "export_native_model_files": false, "checkpoint_trainable_policies_only": false, "logger_creator": null, "logger_config": null, "log_level": "WARN", "log_sys_usage": true, "fake_sampler": false, "seed": 1, "restart_failed_env_runners": true, "ignore_env_runner_failures": false, "max_num_env_runner_restarts": 1000, "delay_between_env_runner_restarts_s": 60.0, "restart_failed_sub_environments": false, "num_consecutive_env_runner_failures_tolerance": 100, "env_runner_health_probe_timeout_s": 30.0, "env_runner_restore_timeout_s": 1800.0, "_model_config": {}, "_rl_module_spec": "RLModuleSpec(module_class=None, observation_space=None, action_space=None, inference_only=False, learner_only=False, model_config=DefaultModelConfig(fcnet_hiddens=[60, 90], fcnet_activation='tanh', fcnet_kernel_initializer=None, fcnet_kernel_initializer_kwargs=None, fcnet_bias_initializer=None, fcnet_bias_initializer_kwargs=None, conv_filters=None, conv_activation='relu', conv_kernel_initializer=None, conv_kernel_initializer_kwargs=None, conv_bias_initializer=None, conv_bias_initializer_kwargs=None, head_fcnet_hiddens=[], head_fcnet_activation='relu', head_fcnet_kernel_initializer=None, head_fcnet_kernel_initializer_kwargs=None, head_fcnet_bias_initializer=None, head_fcnet_bias_initializer_kwargs=None, free_log_std=False, log_std_clip_param=20.0, vf_share_layers=True, use_lstm=False, max_seq_len=20, lstm_cell_size=256, lstm_use_prev_action=False, lstm_use_prev_reward=False, lstm_kernel_initializer=None, lstm_kernel_initializer_kwargs=None, lstm_bias_initializer=None, lstm_bias_initializer_kwargs=None), catalog_class=None, load_state_path=None, model_config_dict=None)", "algorithm_config_overrides_per_module": {}, "_per_module_overrides": {}, "_validate_config": true, "_use_msgpack_checkpoints": false, "_torch_grad_scaler_class": null, "_torch_lr_scheduler_classes": null, "_tf_policy_handles_more_than_one_loss": false, "_disable_preprocessor_api": false, "_disable_action_flattening": false, "_disable_initialize_loss_from_dummy_batch": false, "_dont_auto_sync_env_runner_states": false, "env_task_fn": -1, "enable_connectors": -1, "simple_optimizer": false, "policy_map_cache": -1, "worker_cls": -1, "synchronize_filters": -1, "enable_async_evaluation": -1, "custom_async_evaluation_function": -1, "_enable_rl_module_api": -1, "auto_wrap_old_gym_envs": -1, "always_attach_evaluation_results": -1, "replay_sequence_length": null, "_disable_execution_plan_api": -1, "use_critic": true, "use_gae": true, "use_kl_loss": true, "kl_coeff": 0.7464963036515, "kl_target": 0.0270990929592, "vf_loss_coeff": 0.6688075857018, "entropy_coeff": 0.0090570820258, "clip_param": 0.1221781641624, "vf_clip_param": 0.1027808522125, "entropy_coeff_schedule": null, "lr_schedule": null, "sgd_minibatch_size": -1, "vf_share_layers": -1, "__stdout_file__": null, "__stderr_file__": null, "lambda": 0.9099046732075, "input": "sampler", "policies": {"default_policy": [null, null, null, null]}, "callbacks": "<class 'ray.rllib.callbacks.callbacks.RLlibCallback'>", "create_env_on_driver": false, "custom_eval_function": null, "framework": "torch"}, "time_since_restore": 21.635660648345947, "iterations_since_restore": 8, "perf": {"cpu_util_percent": 67.07500000000002, "ram_util_percent": 77.25}}
{"timers": {"training_iteration": 2.741370154754954, "restore_env_runners": 1.1971555308006573e-05, "training_step": 2.741160386279298, "env_runner_sampling_timer": 2.5580979948951152, "learner_update_timer": 0.17847716686916681, "synch_weights": 0.0009801398611658813, "restore_eval_env_runners": 1.668972018307832e-05, "evaluation_iteration": 0.19480288348645505, "synch_eval_env_connectors": 0.00031526462714734523, "synch_env_connectors": 5.781865845236473e-06}, "env_runners": {"num_env_steps_sampled_lifetime": -4312500.0, "module_to_env_connector": {"timers": {"connectors": {"tensor_to_numpy": 2.998936835432581e-05, "normalize_and_clip_actions": 1.8762907998447112e-05, "un_batch_to_individual_items": 9.616945780598928e-06, "listify_data_for_vector_env": 2.154508716022936e-05, "remove_single_ts_time_rank_from_batch": 1.0920170946461227e-06, "get_actions": 0.00010068474002457398}}, "connector_pipeline_timer": 0.0002296586367655182}, "episode_len_min": 20, "episode_return_max": 9.5, "num_episodes": 250.0, "num_agent_steps_sampled": {"default_agent": 5000.0}, "env_to_module_connector": {"timers": {"connectors": {"add_states_from_episodes_to_batch": 2.8659278252079915e-06, "numpy_to_tensor": 1.9101049656767975e-05, "batch_individual_items": 1.3289865873410736e-05, "add_time_dim_to_batch_and_zero_pad": 4.654099419257931e-06, "add_observations_from_episodes_to_batch": 5.572427129109311e-06}}, "connector_pipeline_timer": 8.250865317836212e-05}, "env_step_timer": 3.1004393847068474e-05, "env_reset_timer": 8.561219849517968e-05, "episode_duration_sec_mean": 0.009673083361238245, "episode_return_min": -10.5, "sample": 0.009897270751963855, "episode_len_max": 20, "module_episode_returns_mean": {"default_policy": 5.259999999999999}, "agent_episode_returns_mean": {"default_agent": 5.259999999999999}, "weights_seq_no": 8.0, "num_agent_steps_sampled_lifetime": {"default_agent": -4312500.0}, "env_to_module_sum_episodes_length_in": 10.36823839457432, "env_to_module_sum_episodes_length_out": 10.36823839457432, "num_episodes_lifetime": -215625.0, "episode_return_mean": 5.259999999999999, "time_between_sampling": 0.002446670335320891, "num_module_steps_sampled": {"default_policy": 5000.0}, "num_module_steps_sampled_lifetime": {"default_policy": -4312500.0}, "rlmodule_inference_timer": 6.549059805689997e-05, "num_env_steps_sampled": 5000.0, "episode_len_mean": 20.0, "num_env_steps_sampled_lifetime_throughput": 2172.7191221481526}, "learners": {"__all_modules__": {"num_module_steps_trained_lifetime": 54000, "learner_connector": {"timers": {"connectors": {"add_observations_from_episodes_to_batch": 0.0009726999588218414, "add_states_from_episodes_to_batch": 4.975510489566798e-06, "add_columns_from_episodes_to_train_batch": 0.04101107003696164, "batch_individual_items": 0.03610220799623613, "add_time_dim_to_batch_and_zero_pad": 1.352310061921937e-05, "numpy_to_tensor": 7.801740737830753e-05, "general_advantage_estimation": 0.012504188092428108, "add_one_ts_to_episodes_and_truncate": 0.010692686102985955}}, "connector_pipeline_timer": 0.10155768535009817}, "num_module_steps_trained": 6000, "learner_connector_sum_episodes_length_in": 5000.0, "num_non_trainable_parameters": 0, "num_env_steps_trained": 31500, "num_env_steps_trained_lifetime": 283500, "learner_connector_sum_episodes_length_out": 5250.0, "num_trainable_parameters": 6003, "num_env_steps_trained_lifetime_throughput": 946161.3861111676, "num_module_steps_trained_throughput": 180917.68562934076, "num_module_steps_trained_lifetime_throughput": 180890.32785122847}, "default_policy": {"num_module_steps_trained_lifetime": 54000, "num_trainable_parameters": 6003, "entropy": 0.6017114520072937, "vf_explained_var": -0.019598960876464844, "num_module_steps_trained": 6000, "weights_seq_no": 9.0, "curr_entropy_coeff": 0.0090570820258, "diff_num_grad_updates_vs_sampler_policy": 1.0, "gradients_default_optimizer_global_norm": 0.05883348360657692, "curr_kl_coeff": 0.0014580006245523691, "default_optimizer_learning_rate": 0.0002847858517, "vf_loss_unclipped": 27.53458595275879, "total_loss": 0.12476349622011185, "mean_kl_loss": 0.0004298215499147773, "policy_loss": 0.06147141009569168, "module_train_batch_size_mean": 1000.0, "vf_loss": 0.10278083384037018, "num_module_steps_trained_lifetime_throughput": 181162.05457495962}}, "num_training_step_calls_per_iteration": 1, "evaluation": {"env_runners": {"num_module_steps_sampled": {"default_policy": 400}, "num_episodes_lifetime": 180, "rlmodule_inference_timer": 6.220621816632185e-05, "module_to_env_connector": {"timers": {"connectors": {"remove_single_ts_time_rank_from_batch": 1.3227562604310271e-06, "normalize_and_clip_actions": 1.7193196954563156e-05, "listify_data_for_vector_env": 2.0978129010606402e-05, "un_batch_to_individual_items": 1.034909840305122e-05, "get_actions": 8.45672424993745e-05, "tensor_to_numpy": 2.499947423821214e-05}}, "connector_pipeline_timer": 0.0002054617814430708}, "module_episode_returns_mean": {"default_policy": -0.2}, "agent_episode_returns_mean": {"default_agent": -0.2}, "env_reset_timer": 0.00019776597620832184, "episode_len_max": 20, "num_agent_steps_sampled_lifetime": {"default_agent": 3600}, "episode_return_mean": -0.2, "num_agent_steps_sampled": {"default_agent": 400}, "num_env_steps_sampled": 400, "episode_len_mean": 20.0, "num_env_steps_sampled_lifetime": 45400, "episode_return_max": 11.5, "env_to_module_connector": {"connector_pipeline_timer": 8.164139815233132e-05, "timers": {"connectors": {"numpy_to_tensor": 1.8723428953301194e-05, "add_observations_from_episodes_to_batch": 4.979504155158178e-06, "batch_individual_items": 1.3427055963321073e-05, "add_states_from_episodes_to_batch": 2.790648656607893e-06, "add_time_dim_to_batch_and_zero_pad": 3.729289781847723e-06}}}, "episode_len_min": 20, "env_to_module_sum_episodes_length_in": 10.368238394574323, "num_episodes": 20, "sample": 0.18523622113516078, "weights_seq_no": 9.0, "env_to_module_sum_episodes_length_out": 10.368238394574323, "env_step_timer": 2.7336295640162007e-05, "episode_duration_sec_mean": 0.007025518780574202, "episode_return_min": -12.5, "num_module_steps_sampled_lifetime": {"default_policy": 3600}, "time_between_sampling": 2.644019338767151}, "num_healthy_workers": 1, "actor_manager_num_outstanding_async_reqs": 0, "num_remote_worker_restarts": 0}, "num_env_steps_sampled_lifetime": -4312500.0, "fault_tolerance": {"num_healthy_workers": 0, "num_remote_worker_restarts": 0}, "env_runner_group": {"actor_manager_num_outstanding_async_reqs": 0}, "done": false, "training_iteration": 9, "trial_id": "4380e_00000", "date": "2025-08-11_19-34-36", "timestamp": 1754933676, "time_this_iter_s": 3.409468173980713, "time_total_s": 25.04512882232666, "pid": 26823, "hostname": "Mac", "node_ip": "127.0.0.1", "config": {"exploration_config": {}, "extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "placement_strategy": "PACK", "num_gpus": 0, "_fake_gpus": false, "num_cpus_for_main_process": 2, "eager_tracing": true, "eager_max_retraces": 20, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "torch_compile_learner": false, "torch_compile_learner_what_to_compile": "forward_train", "torch_compile_learner_dynamo_backend": "aot_eager", "torch_compile_learner_dynamo_mode": null, "torch_compile_worker": false, "torch_compile_worker_dynamo_backend": "aot_eager", "torch_compile_worker_dynamo_mode": null, "torch_ddp_kwargs": {}, "torch_skip_nan_gradients": false, "env": "Umbrella", "env_config": {}, "observation_space": null, "action_space": null, "clip_rewards": null, "normalize_actions": true, "clip_actions": false, "_is_atari": null, "disable_env_checking": false, "render_env": false, "action_mask_key": "action_mask", "env_runner_cls": null, "num_env_runners": 0, "create_local_env_runner": true, "num_envs_per_env_runner": 1, "gym_env_vectorize_mode": "SYNC", "num_cpus_per_env_runner": 1, "num_gpus_per_env_runner": 0, "custom_resources_per_env_runner": {}, "validate_env_runners_after_construction": true, "episodes_to_numpy": true, "max_requests_in_flight_per_env_runner": 1, "sample_timeout_s": 60.0, "_env_to_module_connector": null, "add_default_connectors_to_env_to_module_pipeline": true, "_module_to_env_connector": null, "add_default_connectors_to_module_to_env_pipeline": true, "merge_env_runner_states": "training_only", "broadcast_env_runner_states": true, "episode_lookback_horizon": 1, "rollout_fragment_length": "auto", "batch_mode": "complete_episodes", "compress_observations": false, "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "enable_tf1_exec_eagerly": false, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "preprocessor_pref": "deepmind", "observation_filter": "NoFilter", "update_worker_filter_stats": true, "use_worker_filter_stats": true, "sampler_perf_stats_ema_coef": null, "_is_online": true, "num_learners": 0, "num_gpus_per_learner": 0, "num_cpus_per_learner": "auto", "num_aggregator_actors_per_learner": 0, "max_requests_in_flight_per_aggregator_actor": 3, "local_gpu_idx": 0, "max_requests_in_flight_per_learner": 3, "gamma": 1, "lr": 0.0002847858517, "grad_clip": 0.5, "grad_clip_by": "global_norm", "_train_batch_size_per_learner": 5000, "train_batch_size": 4000, "num_epochs": 1, "minibatch_size": 1000, "shuffle_batch_per_epoch": true, "model": {"fcnet_hiddens": [256, 256], "fcnet_activation": "tanh", "fcnet_weights_initializer": null, "fcnet_weights_initializer_config": null, "fcnet_bias_initializer": null, "fcnet_bias_initializer_config": null, "conv_filters": null, "conv_activation": "relu", "conv_kernel_initializer": null, "conv_kernel_initializer_config": null, "conv_bias_initializer": null, "conv_bias_initializer_config": null, "conv_transpose_kernel_initializer": null, "conv_transpose_kernel_initializer_config": null, "conv_transpose_bias_initializer": null, "conv_transpose_bias_initializer_config": null, "post_fcnet_hiddens": [], "post_fcnet_activation": "relu", "post_fcnet_weights_initializer": null, "post_fcnet_weights_initializer_config": null, "post_fcnet_bias_initializer": null, "post_fcnet_bias_initializer_config": null, "free_log_std": false, "log_std_clip_param": 20.0, "no_final_linear": false, "vf_share_layers": false, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "lstm_weights_initializer": null, "lstm_weights_initializer_config": null, "lstm_bias_initializer": null, "lstm_bias_initializer_config": null, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "attention_use_n_prev_actions": 0, "attention_use_n_prev_rewards": 0, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": null, "custom_model_config": {}, "custom_action_dist": null, "custom_preprocessor": null, "encoder_latent_dim": null, "always_check_shapes": false, "lstm_use_prev_action_reward": -1, "_use_default_native_models": -1, "_disable_preprocessor_api": false, "_disable_action_flattening": false}, "_learner_connector": null, "add_default_connectors_to_learner_pipeline": true, "learner_config_dict": {}, "optimizer": {}, "_learner_class": null, "callbacks_on_algorithm_init": null, "callbacks_on_env_runners_recreated": null, "callbacks_on_offline_eval_runners_recreated": null, "callbacks_on_checkpoint_loaded": null, "callbacks_on_environment_created": null, "callbacks_on_episode_created": null, "callbacks_on_episode_start": null, "callbacks_on_episode_step": null, "callbacks_on_episode_end": null, "callbacks_on_evaluate_start": null, "callbacks_on_evaluate_end": null, "callbacks_on_evaluate_offline_start": null, "callbacks_on_evaluate_offline_end": null, "callbacks_on_sample_end": null, "callbacks_on_train_result": null, "explore": true, "enable_rl_module_and_learner": true, "enable_env_runner_and_connector_v2": true, "_prior_exploration_config": {"type": "StochasticSampling"}, "count_steps_by": "env_steps", "policy_map_capacity": 100, "policy_mapping_fn": "<function AlgorithmConfig.DEFAULT_POLICY_MAPPING_FN at 0x14cce9b20>", "policies_to_train": null, "policy_states_are_swappable": false, "observation_fn": null, "offline_data_class": null, "input_read_method": "read_parquet", "input_read_method_kwargs": {}, "input_read_schema": {}, "input_read_episodes": false, "input_read_sample_batches": false, "input_read_batch_size": null, "input_filesystem": null, "input_filesystem_kwargs": {}, "input_compress_columns": ["obs", "new_obs"], "input_spaces_jsonable": true, "materialize_data": false, "materialize_mapped_data": true, "map_batches_kwargs": {}, "iter_batches_kwargs": {}, "ignore_final_observation": false, "prelearner_class": null, "prelearner_buffer_class": null, "prelearner_buffer_kwargs": {}, "prelearner_module_synch_period": 10, "dataset_num_iters_per_learner": null, "input_config": {}, "actions_in_input_normalized": false, "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_config": {}, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "output_max_rows_per_file": null, "output_write_remaining_data": false, "output_write_method": "write_parquet", "output_write_method_kwargs": {}, "output_filesystem": null, "output_filesystem_kwargs": {}, "output_write_episodes": true, "offline_sampling": false, "evaluation_interval": 1, "evaluation_duration": 20, "evaluation_duration_unit": "episodes", "evaluation_sample_timeout_s": 120.0, "evaluation_auto_duration_min_env_steps_per_sample": 100, "evaluation_auto_duration_max_env_steps_per_sample": 2000, "evaluation_parallel_to_training": false, "evaluation_force_reset_envs_before_iteration": true, "evaluation_config": null, "off_policy_estimation_methods": {}, "ope_split_batch_by_episode": true, "evaluation_num_env_runners": 1, "in_evaluation": false, "sync_filters_on_rollout_workers_timeout_s": 10.0, "offline_evaluation_interval": null, "num_offline_eval_runners": 0, "offline_loss_for_module_fn": null, "offline_evaluation_duration": 1, "offline_evaluation_parallel_to_training": false, "offline_evaluation_timeout_s": 120.0, "num_cpus_per_offline_eval_runner": 1, "num_gpus_per_offline_eval_runner": 0, "custom_resources_per_offline_eval_runner": {}, "restart_failed_offline_eval_runners": true, "ignore_offline_eval_runner_failures": false, "max_num_offline_eval_runner_restarts": 1000, "offline_eval_runner_restore_timeout_s": 1800.0, "max_requests_in_flight_per_offline_eval_runner": 1, "validate_offline_eval_runners_after_construction": true, "offline_eval_runner_health_probe_timeout_s": 30.0, "offline_eval_rl_module_inference_only": false, "broadcast_offline_eval_runner_states": false, "offline_eval_batch_size_per_runner": 256, "dataset_num_iters_per_eval_runner": 1, "keep_per_episode_custom_metrics": false, "metrics_episode_collection_timeout_s": 60.0, "metrics_num_episodes_for_smoothing": 100, "min_time_s_per_iteration": null, "min_train_timesteps_per_iteration": 0, "min_sample_timesteps_per_iteration": 0, "log_gradients": true, "export_native_model_files": false, "checkpoint_trainable_policies_only": false, "logger_creator": null, "logger_config": null, "log_level": "WARN", "log_sys_usage": true, "fake_sampler": false, "seed": 1, "restart_failed_env_runners": true, "ignore_env_runner_failures": false, "max_num_env_runner_restarts": 1000, "delay_between_env_runner_restarts_s": 60.0, "restart_failed_sub_environments": false, "num_consecutive_env_runner_failures_tolerance": 100, "env_runner_health_probe_timeout_s": 30.0, "env_runner_restore_timeout_s": 1800.0, "_model_config": {}, "_rl_module_spec": "RLModuleSpec(module_class=None, observation_space=None, action_space=None, inference_only=False, learner_only=False, model_config=DefaultModelConfig(fcnet_hiddens=[60, 90], fcnet_activation='tanh', fcnet_kernel_initializer=None, fcnet_kernel_initializer_kwargs=None, fcnet_bias_initializer=None, fcnet_bias_initializer_kwargs=None, conv_filters=None, conv_activation='relu', conv_kernel_initializer=None, conv_kernel_initializer_kwargs=None, conv_bias_initializer=None, conv_bias_initializer_kwargs=None, head_fcnet_hiddens=[], head_fcnet_activation='relu', head_fcnet_kernel_initializer=None, head_fcnet_kernel_initializer_kwargs=None, head_fcnet_bias_initializer=None, head_fcnet_bias_initializer_kwargs=None, free_log_std=False, log_std_clip_param=20.0, vf_share_layers=True, use_lstm=False, max_seq_len=20, lstm_cell_size=256, lstm_use_prev_action=False, lstm_use_prev_reward=False, lstm_kernel_initializer=None, lstm_kernel_initializer_kwargs=None, lstm_bias_initializer=None, lstm_bias_initializer_kwargs=None), catalog_class=None, load_state_path=None, model_config_dict=None)", "algorithm_config_overrides_per_module": {}, "_per_module_overrides": {}, "_validate_config": true, "_use_msgpack_checkpoints": false, "_torch_grad_scaler_class": null, "_torch_lr_scheduler_classes": null, "_tf_policy_handles_more_than_one_loss": false, "_disable_preprocessor_api": false, "_disable_action_flattening": false, "_disable_initialize_loss_from_dummy_batch": false, "_dont_auto_sync_env_runner_states": false, "env_task_fn": -1, "enable_connectors": -1, "simple_optimizer": false, "policy_map_cache": -1, "worker_cls": -1, "synchronize_filters": -1, "enable_async_evaluation": -1, "custom_async_evaluation_function": -1, "_enable_rl_module_api": -1, "auto_wrap_old_gym_envs": -1, "always_attach_evaluation_results": -1, "replay_sequence_length": null, "_disable_execution_plan_api": -1, "use_critic": true, "use_gae": true, "use_kl_loss": true, "kl_coeff": 0.7464963036515, "kl_target": 0.0270990929592, "vf_loss_coeff": 0.6688075857018, "entropy_coeff": 0.0090570820258, "clip_param": 0.1221781641624, "vf_clip_param": 0.1027808522125, "entropy_coeff_schedule": null, "lr_schedule": null, "sgd_minibatch_size": -1, "vf_share_layers": -1, "__stdout_file__": null, "__stderr_file__": null, "lambda": 0.9099046732075, "input": "sampler", "policies": {"default_policy": [null, null, null, null]}, "callbacks": "<class 'ray.rllib.callbacks.callbacks.RLlibCallback'>", "create_env_on_driver": false, "custom_eval_function": null, "framework": "torch"}, "time_since_restore": 25.04512882232666, "iterations_since_restore": 9, "perf": {"cpu_util_percent": 75.02000000000001, "ram_util_percent": 80.02000000000001}}
{"timers": {"training_iteration": 2.740869328627353, "restore_env_runners": 1.192558886130387e-05, "training_step": 2.7406584828355607, "env_runner_sampling_timer": 2.556833082446204, "learner_update_timer": 0.17922317895059198, "synch_weights": 0.0009850034624620588, "restore_eval_env_runners": 1.6638652734005683e-05, "evaluation_iteration": 0.19475980090173303, "synch_eval_env_connectors": 0.00031489281113065005, "synch_env_connectors": 5.764467750675638e-06}, "env_runners": {"num_env_steps_sampled_lifetime": -4930000.0, "module_to_env_connector": {"timers": {"connectors": {"tensor_to_numpy": 2.311525589148077e-05, "normalize_and_clip_actions": 1.559919277879339e-05, "un_batch_to_individual_items": 8.617062869923576e-06, "listify_data_for_vector_env": 1.8810478016081383e-05, "remove_single_ts_time_rank_from_batch": 9.779381055295898e-07, "get_actions": 7.994901110810646e-05}}, "connector_pipeline_timer": 0.00018842090646637133}, "episode_len_min": 20, "episode_return_max": 9.5, "num_episodes": 250.0, "num_agent_steps_sampled": {"default_agent": 5000.0}, "env_to_module_connector": {"timers": {"connectors": {"add_states_from_episodes_to_batch": 2.5203326184432593e-06, "numpy_to_tensor": 1.6186619823128922e-05, "batch_individual_items": 1.1074378277116614e-05, "add_time_dim_to_batch_and_zero_pad": 3.885674115312345e-06, "add_observations_from_episodes_to_batch": 5.143889021654777e-06}}, "connector_pipeline_timer": 7.147059558115937e-05}, "env_step_timer": 2.5352736297225732e-05, "env_reset_timer": 7.928264238788262e-05, "episode_duration_sec_mean": 0.00813053146516904, "episode_return_min": -10.5, "sample": 0.009038505521301407, "episode_len_max": 20, "module_episode_returns_mean": {"default_policy": 5.100000000000001}, "agent_episode_returns_mean": {"default_agent": 5.100000000000001}, "weights_seq_no": 9.0, "num_agent_steps_sampled_lifetime": {"default_agent": -4930000.0}, "env_to_module_sum_episodes_length_in": 10.36823839457432, "env_to_module_sum_episodes_length_out": 10.36823839457432, "num_episodes_lifetime": -246500.0, "episode_return_mean": 5.100000000000001, "time_between_sampling": 0.0032213616965912784, "num_module_steps_sampled": {"default_policy": 5000.0}, "num_module_steps_sampled_lifetime": {"default_policy": -4930000.0}, "rlmodule_inference_timer": 5.212424328478032e-05, "num_env_steps_sampled": 5000.0, "episode_len_mean": 20.0, "num_env_steps_sampled_lifetime_throughput": 2347.130752003313}, "learners": {"__all_modules__": {"num_module_steps_trained_lifetime": 60000, "learner_connector": {"timers": {"connectors": {"add_observations_from_episodes_to_batch": 0.0009722192089168242, "add_states_from_episodes_to_batch": 4.964925648006239e-06, "add_columns_from_episodes_to_train_batch": 0.04098163267641528, "batch_individual_items": 0.03725966216662239, "add_time_dim_to_batch_and_zero_pad": 1.3549948844840726e-05, "numpy_to_tensor": 7.832598315469328e-05, "general_advantage_estimation": 0.01247667704262101, "add_one_ts_to_episodes_and_truncate": 0.010674625072286273}}, "connector_pipeline_timer": 0.10263971807639316}, "num_module_steps_trained": 6000, "learner_connector_sum_episodes_length_in": 5000.0, "num_non_trainable_parameters": 0, "num_env_steps_trained": 31500, "num_env_steps_trained_lifetime": 315000, "learner_connector_sum_episodes_length_out": 5250.0, "num_trainable_parameters": 6003, "num_env_steps_trained_lifetime_throughput": 965711.1540465468, "num_module_steps_trained_throughput": 184600.72768494763, "num_module_steps_trained_lifetime_throughput": 184573.9748361117}, "default_policy": {"num_module_steps_trained_lifetime": 60000, "num_trainable_parameters": 6003, "entropy": 0.5956794023513794, "vf_explained_var": -0.02006387710571289, "num_module_steps_trained": 6000, "weights_seq_no": 10.0, "curr_entropy_coeff": 0.0090570820258, "diff_num_grad_updates_vs_sampler_policy": 1.0, "gradients_default_optimizer_global_norm": 0.018817108124494553, "curr_kl_coeff": 0.0007290003122761846, "default_optimizer_learning_rate": 0.0002847858517, "vf_loss_unclipped": 27.54096031188965, "total_loss": 0.10759363323450089, "mean_kl_loss": 5.7940360420616344e-05, "policy_loss": 0.044248078018426895, "module_train_batch_size_mean": 1000.0, "vf_loss": 0.10278083384037018, "num_module_steps_trained_lifetime_throughput": 184812.9457924602}}, "num_training_step_calls_per_iteration": 1, "evaluation": {"env_runners": {"num_module_steps_sampled": {"default_policy": 400}, "num_episodes_lifetime": 200, "rlmodule_inference_timer": 3.733336674045373e-05, "module_to_env_connector": {"timers": {"connectors": {"remove_single_ts_time_rank_from_batch": 7.470361815206909e-07, "normalize_and_clip_actions": 1.2059598814378655e-05, "listify_data_for_vector_env": 1.421902312624373e-05, "un_batch_to_individual_items": 7.066171246320086e-06, "get_actions": 5.535186447401667e-05, "tensor_to_numpy": 1.774457799293797e-05}}, "connector_pipeline_timer": 0.00013937127417221372}, "module_episode_returns_mean": {"default_policy": -0.4}, "agent_episode_returns_mean": {"default_agent": -0.4}, "env_reset_timer": 0.0001966483160097836, "episode_len_max": 20, "num_agent_steps_sampled_lifetime": {"default_agent": 4000}, "episode_return_mean": -0.4, "num_agent_steps_sampled": {"default_agent": 400}, "num_env_steps_sampled": 400, "episode_len_mean": 20.0, "num_env_steps_sampled_lifetime": 50400, "episode_return_max": 11.5, "env_to_module_connector": {"connector_pipeline_timer": 5.433553178514759e-05, "timers": {"connectors": {"numpy_to_tensor": 1.1447953607367703e-05, "add_observations_from_episodes_to_batch": 3.557944354284114e-06, "batch_individual_items": 8.309964040710636e-06, "add_states_from_episodes_to_batch": 1.9979627232969576e-06, "add_time_dim_to_batch_and_zero_pad": 2.780434849615367e-06}}}, "episode_len_min": 20, "env_to_module_sum_episodes_length_in": 10.368238394574323, "num_episodes": 20, "sample": 0.18502393767401534, "weights_seq_no": 10.0, "env_to_module_sum_episodes_length_out": 10.368238394574323, "env_step_timer": 1.83763842300214e-05, "episode_duration_sec_mean": 0.00728788333828561, "episode_return_min": -12.5, "num_module_steps_sampled_lifetime": {"default_policy": 4000}, "time_between_sampling": 2.6448364957995927}, "num_healthy_workers": 1, "actor_manager_num_outstanding_async_reqs": 0, "num_remote_worker_restarts": 0}, "num_env_steps_sampled_lifetime": -4930000.0, "fault_tolerance": {"num_healthy_workers": 0, "num_remote_worker_restarts": 0}, "env_runner_group": {"actor_manager_num_outstanding_async_reqs": 0}, "done": false, "training_iteration": 10, "trial_id": "4380e_00000", "date": "2025-08-11_19-34-39", "timestamp": 1754933679, "time_this_iter_s": 2.8671038150787354, "time_total_s": 27.912232637405396, "pid": 26823, "hostname": "Mac", "node_ip": "127.0.0.1", "config": {"exploration_config": {}, "extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "placement_strategy": "PACK", "num_gpus": 0, "_fake_gpus": false, "num_cpus_for_main_process": 2, "eager_tracing": true, "eager_max_retraces": 20, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "torch_compile_learner": false, "torch_compile_learner_what_to_compile": "forward_train", "torch_compile_learner_dynamo_backend": "aot_eager", "torch_compile_learner_dynamo_mode": null, "torch_compile_worker": false, "torch_compile_worker_dynamo_backend": "aot_eager", "torch_compile_worker_dynamo_mode": null, "torch_ddp_kwargs": {}, "torch_skip_nan_gradients": false, "env": "Umbrella", "env_config": {}, "observation_space": null, "action_space": null, "clip_rewards": null, "normalize_actions": true, "clip_actions": false, "_is_atari": null, "disable_env_checking": false, "render_env": false, "action_mask_key": "action_mask", "env_runner_cls": null, "num_env_runners": 0, "create_local_env_runner": true, "num_envs_per_env_runner": 1, "gym_env_vectorize_mode": "SYNC", "num_cpus_per_env_runner": 1, "num_gpus_per_env_runner": 0, "custom_resources_per_env_runner": {}, "validate_env_runners_after_construction": true, "episodes_to_numpy": true, "max_requests_in_flight_per_env_runner": 1, "sample_timeout_s": 60.0, "_env_to_module_connector": null, "add_default_connectors_to_env_to_module_pipeline": true, "_module_to_env_connector": null, "add_default_connectors_to_module_to_env_pipeline": true, "merge_env_runner_states": "training_only", "broadcast_env_runner_states": true, "episode_lookback_horizon": 1, "rollout_fragment_length": "auto", "batch_mode": "complete_episodes", "compress_observations": false, "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "enable_tf1_exec_eagerly": false, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "preprocessor_pref": "deepmind", "observation_filter": "NoFilter", "update_worker_filter_stats": true, "use_worker_filter_stats": true, "sampler_perf_stats_ema_coef": null, "_is_online": true, "num_learners": 0, "num_gpus_per_learner": 0, "num_cpus_per_learner": "auto", "num_aggregator_actors_per_learner": 0, "max_requests_in_flight_per_aggregator_actor": 3, "local_gpu_idx": 0, "max_requests_in_flight_per_learner": 3, "gamma": 1, "lr": 0.0002847858517, "grad_clip": 0.5, "grad_clip_by": "global_norm", "_train_batch_size_per_learner": 5000, "train_batch_size": 4000, "num_epochs": 1, "minibatch_size": 1000, "shuffle_batch_per_epoch": true, "model": {"fcnet_hiddens": [256, 256], "fcnet_activation": "tanh", "fcnet_weights_initializer": null, "fcnet_weights_initializer_config": null, "fcnet_bias_initializer": null, "fcnet_bias_initializer_config": null, "conv_filters": null, "conv_activation": "relu", "conv_kernel_initializer": null, "conv_kernel_initializer_config": null, "conv_bias_initializer": null, "conv_bias_initializer_config": null, "conv_transpose_kernel_initializer": null, "conv_transpose_kernel_initializer_config": null, "conv_transpose_bias_initializer": null, "conv_transpose_bias_initializer_config": null, "post_fcnet_hiddens": [], "post_fcnet_activation": "relu", "post_fcnet_weights_initializer": null, "post_fcnet_weights_initializer_config": null, "post_fcnet_bias_initializer": null, "post_fcnet_bias_initializer_config": null, "free_log_std": false, "log_std_clip_param": 20.0, "no_final_linear": false, "vf_share_layers": false, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "lstm_weights_initializer": null, "lstm_weights_initializer_config": null, "lstm_bias_initializer": null, "lstm_bias_initializer_config": null, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "attention_use_n_prev_actions": 0, "attention_use_n_prev_rewards": 0, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": null, "custom_model_config": {}, "custom_action_dist": null, "custom_preprocessor": null, "encoder_latent_dim": null, "always_check_shapes": false, "lstm_use_prev_action_reward": -1, "_use_default_native_models": -1, "_disable_preprocessor_api": false, "_disable_action_flattening": false}, "_learner_connector": null, "add_default_connectors_to_learner_pipeline": true, "learner_config_dict": {}, "optimizer": {}, "_learner_class": null, "callbacks_on_algorithm_init": null, "callbacks_on_env_runners_recreated": null, "callbacks_on_offline_eval_runners_recreated": null, "callbacks_on_checkpoint_loaded": null, "callbacks_on_environment_created": null, "callbacks_on_episode_created": null, "callbacks_on_episode_start": null, "callbacks_on_episode_step": null, "callbacks_on_episode_end": null, "callbacks_on_evaluate_start": null, "callbacks_on_evaluate_end": null, "callbacks_on_evaluate_offline_start": null, "callbacks_on_evaluate_offline_end": null, "callbacks_on_sample_end": null, "callbacks_on_train_result": null, "explore": true, "enable_rl_module_and_learner": true, "enable_env_runner_and_connector_v2": true, "_prior_exploration_config": {"type": "StochasticSampling"}, "count_steps_by": "env_steps", "policy_map_capacity": 100, "policy_mapping_fn": "<function AlgorithmConfig.DEFAULT_POLICY_MAPPING_FN at 0x14cce9b20>", "policies_to_train": null, "policy_states_are_swappable": false, "observation_fn": null, "offline_data_class": null, "input_read_method": "read_parquet", "input_read_method_kwargs": {}, "input_read_schema": {}, "input_read_episodes": false, "input_read_sample_batches": false, "input_read_batch_size": null, "input_filesystem": null, "input_filesystem_kwargs": {}, "input_compress_columns": ["obs", "new_obs"], "input_spaces_jsonable": true, "materialize_data": false, "materialize_mapped_data": true, "map_batches_kwargs": {}, "iter_batches_kwargs": {}, "ignore_final_observation": false, "prelearner_class": null, "prelearner_buffer_class": null, "prelearner_buffer_kwargs": {}, "prelearner_module_synch_period": 10, "dataset_num_iters_per_learner": null, "input_config": {}, "actions_in_input_normalized": false, "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_config": {}, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "output_max_rows_per_file": null, "output_write_remaining_data": false, "output_write_method": "write_parquet", "output_write_method_kwargs": {}, "output_filesystem": null, "output_filesystem_kwargs": {}, "output_write_episodes": true, "offline_sampling": false, "evaluation_interval": 1, "evaluation_duration": 20, "evaluation_duration_unit": "episodes", "evaluation_sample_timeout_s": 120.0, "evaluation_auto_duration_min_env_steps_per_sample": 100, "evaluation_auto_duration_max_env_steps_per_sample": 2000, "evaluation_parallel_to_training": false, "evaluation_force_reset_envs_before_iteration": true, "evaluation_config": null, "off_policy_estimation_methods": {}, "ope_split_batch_by_episode": true, "evaluation_num_env_runners": 1, "in_evaluation": false, "sync_filters_on_rollout_workers_timeout_s": 10.0, "offline_evaluation_interval": null, "num_offline_eval_runners": 0, "offline_loss_for_module_fn": null, "offline_evaluation_duration": 1, "offline_evaluation_parallel_to_training": false, "offline_evaluation_timeout_s": 120.0, "num_cpus_per_offline_eval_runner": 1, "num_gpus_per_offline_eval_runner": 0, "custom_resources_per_offline_eval_runner": {}, "restart_failed_offline_eval_runners": true, "ignore_offline_eval_runner_failures": false, "max_num_offline_eval_runner_restarts": 1000, "offline_eval_runner_restore_timeout_s": 1800.0, "max_requests_in_flight_per_offline_eval_runner": 1, "validate_offline_eval_runners_after_construction": true, "offline_eval_runner_health_probe_timeout_s": 30.0, "offline_eval_rl_module_inference_only": false, "broadcast_offline_eval_runner_states": false, "offline_eval_batch_size_per_runner": 256, "dataset_num_iters_per_eval_runner": 1, "keep_per_episode_custom_metrics": false, "metrics_episode_collection_timeout_s": 60.0, "metrics_num_episodes_for_smoothing": 100, "min_time_s_per_iteration": null, "min_train_timesteps_per_iteration": 0, "min_sample_timesteps_per_iteration": 0, "log_gradients": true, "export_native_model_files": false, "checkpoint_trainable_policies_only": false, "logger_creator": null, "logger_config": null, "log_level": "WARN", "log_sys_usage": true, "fake_sampler": false, "seed": 1, "restart_failed_env_runners": true, "ignore_env_runner_failures": false, "max_num_env_runner_restarts": 1000, "delay_between_env_runner_restarts_s": 60.0, "restart_failed_sub_environments": false, "num_consecutive_env_runner_failures_tolerance": 100, "env_runner_health_probe_timeout_s": 30.0, "env_runner_restore_timeout_s": 1800.0, "_model_config": {}, "_rl_module_spec": "RLModuleSpec(module_class=None, observation_space=None, action_space=None, inference_only=False, learner_only=False, model_config=DefaultModelConfig(fcnet_hiddens=[60, 90], fcnet_activation='tanh', fcnet_kernel_initializer=None, fcnet_kernel_initializer_kwargs=None, fcnet_bias_initializer=None, fcnet_bias_initializer_kwargs=None, conv_filters=None, conv_activation='relu', conv_kernel_initializer=None, conv_kernel_initializer_kwargs=None, conv_bias_initializer=None, conv_bias_initializer_kwargs=None, head_fcnet_hiddens=[], head_fcnet_activation='relu', head_fcnet_kernel_initializer=None, head_fcnet_kernel_initializer_kwargs=None, head_fcnet_bias_initializer=None, head_fcnet_bias_initializer_kwargs=None, free_log_std=False, log_std_clip_param=20.0, vf_share_layers=True, use_lstm=False, max_seq_len=20, lstm_cell_size=256, lstm_use_prev_action=False, lstm_use_prev_reward=False, lstm_kernel_initializer=None, lstm_kernel_initializer_kwargs=None, lstm_bias_initializer=None, lstm_bias_initializer_kwargs=None), catalog_class=None, load_state_path=None, model_config_dict=None)", "algorithm_config_overrides_per_module": {}, "_per_module_overrides": {}, "_validate_config": true, "_use_msgpack_checkpoints": false, "_torch_grad_scaler_class": null, "_torch_lr_scheduler_classes": null, "_tf_policy_handles_more_than_one_loss": false, "_disable_preprocessor_api": false, "_disable_action_flattening": false, "_disable_initialize_loss_from_dummy_batch": false, "_dont_auto_sync_env_runner_states": false, "env_task_fn": -1, "enable_connectors": -1, "simple_optimizer": false, "policy_map_cache": -1, "worker_cls": -1, "synchronize_filters": -1, "enable_async_evaluation": -1, "custom_async_evaluation_function": -1, "_enable_rl_module_api": -1, "auto_wrap_old_gym_envs": -1, "always_attach_evaluation_results": -1, "replay_sequence_length": null, "_disable_execution_plan_api": -1, "use_critic": true, "use_gae": true, "use_kl_loss": true, "kl_coeff": 0.7464963036515, "kl_target": 0.0270990929592, "vf_loss_coeff": 0.6688075857018, "entropy_coeff": 0.0090570820258, "clip_param": 0.1221781641624, "vf_clip_param": 0.1027808522125, "entropy_coeff_schedule": null, "lr_schedule": null, "sgd_minibatch_size": -1, "vf_share_layers": -1, "__stdout_file__": null, "__stderr_file__": null, "lambda": 0.9099046732075, "input": "sampler", "policies": {"default_policy": [null, null, null, null]}, "callbacks": "<class 'ray.rllib.callbacks.callbacks.RLlibCallback'>", "create_env_on_driver": false, "custom_eval_function": null, "framework": "torch"}, "time_since_restore": 27.912232637405396, "iterations_since_restore": 10, "perf": {"cpu_util_percent": 70.17500000000001, "ram_util_percent": 78.325}}
{"timers": {"training_iteration": 2.736356321590328, "restore_env_runners": 1.1869673385143649e-05, "training_step": 2.7361450000970797, "env_runner_sampling_timer": 2.552826762452709, "learner_update_timer": 0.17872579175167919, "synch_weights": 0.0009818563473280736, "restore_eval_env_runners": 1.6606845811157217e-05, "evaluation_iteration": 0.19452562456343567, "synch_eval_env_connectors": 0.0003142984729018365, "synch_env_connectors": 5.7584835363828026e-06}, "env_runners": {"num_env_steps_sampled_lifetime": -5547500.0, "module_to_env_connector": {"timers": {"connectors": {"tensor_to_numpy": 2.090586291854684e-05, "normalize_and_clip_actions": 1.3663492381889025e-05, "un_batch_to_individual_items": 7.822324043095776e-06, "listify_data_for_vector_env": 1.660728156922141e-05, "remove_single_ts_time_rank_from_batch": 8.131156086095652e-07, "get_actions": 6.875038304696294e-05}}, "connector_pipeline_timer": 0.00016568521193598793}, "episode_len_min": 20, "episode_return_max": 9.5, "num_episodes": 250.0, "num_agent_steps_sampled": {"default_agent": 5000.0}, "env_to_module_connector": {"timers": {"connectors": {"add_states_from_episodes_to_batch": 2.340447758870032e-06, "numpy_to_tensor": 1.417014913743056e-05, "batch_individual_items": 9.883089979099758e-06, "add_time_dim_to_batch_and_zero_pad": 3.4737637951852607e-06, "add_observations_from_episodes_to_batch": 4.382113480886695e-06}}, "connector_pipeline_timer": 6.446205792490904e-05}, "env_step_timer": 2.219652977398626e-05, "env_reset_timer": 6.909267922953914e-05, "episode_duration_sec_mean": 0.007174858142156153, "episode_return_min": -10.5, "sample": 0.0078970615419406, "episode_len_max": 20, "module_episode_returns_mean": {"default_policy": 5.980000000000002}, "agent_episode_returns_mean": {"default_agent": 5.980000000000002}, "weights_seq_no": 10.0, "num_agent_steps_sampled_lifetime": {"default_agent": -5547500.0}, "env_to_module_sum_episodes_length_in": 10.36823839457432, "env_to_module_sum_episodes_length_out": 10.36823839457432, "num_episodes_lifetime": -277375.0, "episode_return_mean": 5.980000000000002, "time_between_sampling": 0.0027637074285427714, "num_module_steps_sampled": {"default_policy": 5000.0}, "num_module_steps_sampled_lifetime": {"default_policy": -5547500.0}, "rlmodule_inference_timer": 4.687938796112984e-05, "num_env_steps_sampled": 5000.0, "episode_len_mean": 20.0, "num_env_steps_sampled_lifetime_throughput": 2580.621070433586}, "learners": {"__all_modules__": {"num_module_steps_trained_lifetime": 66000, "learner_connector": {"timers": {"connectors": {"add_observations_from_episodes_to_batch": 0.0009772882668237072, "add_states_from_episodes_to_batch": 4.9486165755441924e-06, "add_columns_from_episodes_to_train_batch": 0.0410541446800506, "batch_individual_items": 0.03727763720461986, "add_time_dim_to_batch_and_zero_pad": 1.3541539963230783e-05, "numpy_to_tensor": 7.828730408001924e-05, "general_advantage_estimation": 0.012419778192928787, "add_one_ts_to_episodes_and_truncate": 0.010715355901444765}}, "connector_pipeline_timer": 0.10271853256497555}, "num_module_steps_trained": 6000, "learner_connector_sum_episodes_length_in": 5000.0, "num_non_trainable_parameters": 0, "num_env_steps_trained": 31500, "num_env_steps_trained_lifetime": 346500, "learner_connector_sum_episodes_length_out": 5250.0, "num_trainable_parameters": 6003, "num_env_steps_trained_lifetime_throughput": 987368.5078984977, "num_module_steps_trained_throughput": 188691.77213141794, "num_module_steps_trained_lifetime_throughput": 188663.53040574916}, "default_policy": {"num_module_steps_trained_lifetime": 66000, "num_trainable_parameters": 6003, "entropy": 0.6065216660499573, "vf_explained_var": -0.020464658737182617, "num_module_steps_trained": 6000, "weights_seq_no": 11.0, "curr_entropy_coeff": 0.0090570820258, "diff_num_grad_updates_vs_sampler_policy": 1.0, "gradients_default_optimizer_global_norm": 0.06588909029960632, "curr_kl_coeff": 0.0003645001561380923, "default_optimizer_learning_rate": 0.0002847858517, "vf_loss_unclipped": 27.205020904541016, "total_loss": 0.06442416459321976, "mean_kl_loss": 8.655712736072019e-05, "policy_loss": 0.0011768140830099583, "module_train_batch_size_mean": 1000.0, "vf_loss": 0.10278083384037018, "num_module_steps_trained_lifetime_throughput": 188867.92279121577}}, "num_training_step_calls_per_iteration": 1, "evaluation": {"env_runners": {"num_module_steps_sampled": {"default_policy": 400}, "num_episodes_lifetime": 220, "rlmodule_inference_timer": 4.127275507127826e-05, "module_to_env_connector": {"timers": {"connectors": {"remove_single_ts_time_rank_from_batch": 8.248856671503229e-07, "normalize_and_clip_actions": 1.2298631624290522e-05, "listify_data_for_vector_env": 1.538290305836378e-05, "un_batch_to_individual_items": 7.463253223419137e-06, "get_actions": 5.6095302711776155e-05, "tensor_to_numpy": 1.9082479321558384e-05}}, "connector_pipeline_timer": 0.00014581761757690852}, "module_episode_returns_mean": {"default_policy": 0.0}, "agent_episode_returns_mean": {"default_agent": 0.0}, "env_reset_timer": 0.0001954680821427002, "episode_len_max": 20, "num_agent_steps_sampled_lifetime": {"default_agent": 4400}, "episode_return_mean": 0.0, "num_agent_steps_sampled": {"default_agent": 400}, "num_env_steps_sampled": 400, "episode_len_mean": 20.0, "num_env_steps_sampled_lifetime": 55400, "episode_return_max": 12.5, "env_to_module_connector": {"connector_pipeline_timer": 5.3462613494660554e-05, "timers": {"connectors": {"numpy_to_tensor": 1.1547583898693591e-05, "add_observations_from_episodes_to_batch": 3.517858359879325e-06, "batch_individual_items": 8.122551654456605e-06, "add_states_from_episodes_to_batch": 1.799327862386412e-06, "add_time_dim_to_batch_and_zero_pad": 2.7768426792435615e-06}}}, "episode_len_min": 20, "env_to_module_sum_episodes_length_in": 10.368238394574323, "num_episodes": 20, "sample": 0.18448100871736367, "weights_seq_no": 11.0, "env_to_module_sum_episodes_length_out": 10.368238394574323, "env_step_timer": 1.7939727715327605e-05, "episode_duration_sec_mean": 0.007122564151650294, "episode_return_min": -12.5, "num_module_steps_sampled_lifetime": {"default_policy": 4400}, "time_between_sampling": 2.641491757092119}, "num_healthy_workers": 1, "actor_manager_num_outstanding_async_reqs": 0, "num_remote_worker_restarts": 0}, "num_env_steps_sampled_lifetime": -5547500.0, "fault_tolerance": {"num_healthy_workers": 0, "num_remote_worker_restarts": 0}, "env_runner_group": {"actor_manager_num_outstanding_async_reqs": 0}, "done": false, "training_iteration": 11, "trial_id": "4380e_00000", "date": "2025-08-11_19-34-42", "timestamp": 1754933682, "time_this_iter_s": 2.429588794708252, "time_total_s": 30.341821432113647, "pid": 26823, "hostname": "Mac", "node_ip": "127.0.0.1", "config": {"exploration_config": {}, "extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "placement_strategy": "PACK", "num_gpus": 0, "_fake_gpus": false, "num_cpus_for_main_process": 2, "eager_tracing": true, "eager_max_retraces": 20, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "torch_compile_learner": false, "torch_compile_learner_what_to_compile": "forward_train", "torch_compile_learner_dynamo_backend": "aot_eager", "torch_compile_learner_dynamo_mode": null, "torch_compile_worker": false, "torch_compile_worker_dynamo_backend": "aot_eager", "torch_compile_worker_dynamo_mode": null, "torch_ddp_kwargs": {}, "torch_skip_nan_gradients": false, "env": "Umbrella", "env_config": {}, "observation_space": null, "action_space": null, "clip_rewards": null, "normalize_actions": true, "clip_actions": false, "_is_atari": null, "disable_env_checking": false, "render_env": false, "action_mask_key": "action_mask", "env_runner_cls": null, "num_env_runners": 0, "create_local_env_runner": true, "num_envs_per_env_runner": 1, "gym_env_vectorize_mode": "SYNC", "num_cpus_per_env_runner": 1, "num_gpus_per_env_runner": 0, "custom_resources_per_env_runner": {}, "validate_env_runners_after_construction": true, "episodes_to_numpy": true, "max_requests_in_flight_per_env_runner": 1, "sample_timeout_s": 60.0, "_env_to_module_connector": null, "add_default_connectors_to_env_to_module_pipeline": true, "_module_to_env_connector": null, "add_default_connectors_to_module_to_env_pipeline": true, "merge_env_runner_states": "training_only", "broadcast_env_runner_states": true, "episode_lookback_horizon": 1, "rollout_fragment_length": "auto", "batch_mode": "complete_episodes", "compress_observations": false, "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "enable_tf1_exec_eagerly": false, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "preprocessor_pref": "deepmind", "observation_filter": "NoFilter", "update_worker_filter_stats": true, "use_worker_filter_stats": true, "sampler_perf_stats_ema_coef": null, "_is_online": true, "num_learners": 0, "num_gpus_per_learner": 0, "num_cpus_per_learner": "auto", "num_aggregator_actors_per_learner": 0, "max_requests_in_flight_per_aggregator_actor": 3, "local_gpu_idx": 0, "max_requests_in_flight_per_learner": 3, "gamma": 1, "lr": 0.0002847858517, "grad_clip": 0.5, "grad_clip_by": "global_norm", "_train_batch_size_per_learner": 5000, "train_batch_size": 4000, "num_epochs": 1, "minibatch_size": 1000, "shuffle_batch_per_epoch": true, "model": {"fcnet_hiddens": [256, 256], "fcnet_activation": "tanh", "fcnet_weights_initializer": null, "fcnet_weights_initializer_config": null, "fcnet_bias_initializer": null, "fcnet_bias_initializer_config": null, "conv_filters": null, "conv_activation": "relu", "conv_kernel_initializer": null, "conv_kernel_initializer_config": null, "conv_bias_initializer": null, "conv_bias_initializer_config": null, "conv_transpose_kernel_initializer": null, "conv_transpose_kernel_initializer_config": null, "conv_transpose_bias_initializer": null, "conv_transpose_bias_initializer_config": null, "post_fcnet_hiddens": [], "post_fcnet_activation": "relu", "post_fcnet_weights_initializer": null, "post_fcnet_weights_initializer_config": null, "post_fcnet_bias_initializer": null, "post_fcnet_bias_initializer_config": null, "free_log_std": false, "log_std_clip_param": 20.0, "no_final_linear": false, "vf_share_layers": false, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "lstm_weights_initializer": null, "lstm_weights_initializer_config": null, "lstm_bias_initializer": null, "lstm_bias_initializer_config": null, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "attention_use_n_prev_actions": 0, "attention_use_n_prev_rewards": 0, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": null, "custom_model_config": {}, "custom_action_dist": null, "custom_preprocessor": null, "encoder_latent_dim": null, "always_check_shapes": false, "lstm_use_prev_action_reward": -1, "_use_default_native_models": -1, "_disable_preprocessor_api": false, "_disable_action_flattening": false}, "_learner_connector": null, "add_default_connectors_to_learner_pipeline": true, "learner_config_dict": {}, "optimizer": {}, "_learner_class": null, "callbacks_on_algorithm_init": null, "callbacks_on_env_runners_recreated": null, "callbacks_on_offline_eval_runners_recreated": null, "callbacks_on_checkpoint_loaded": null, "callbacks_on_environment_created": null, "callbacks_on_episode_created": null, "callbacks_on_episode_start": null, "callbacks_on_episode_step": null, "callbacks_on_episode_end": null, "callbacks_on_evaluate_start": null, "callbacks_on_evaluate_end": null, "callbacks_on_evaluate_offline_start": null, "callbacks_on_evaluate_offline_end": null, "callbacks_on_sample_end": null, "callbacks_on_train_result": null, "explore": true, "enable_rl_module_and_learner": true, "enable_env_runner_and_connector_v2": true, "_prior_exploration_config": {"type": "StochasticSampling"}, "count_steps_by": "env_steps", "policy_map_capacity": 100, "policy_mapping_fn": "<function AlgorithmConfig.DEFAULT_POLICY_MAPPING_FN at 0x14cce9b20>", "policies_to_train": null, "policy_states_are_swappable": false, "observation_fn": null, "offline_data_class": null, "input_read_method": "read_parquet", "input_read_method_kwargs": {}, "input_read_schema": {}, "input_read_episodes": false, "input_read_sample_batches": false, "input_read_batch_size": null, "input_filesystem": null, "input_filesystem_kwargs": {}, "input_compress_columns": ["obs", "new_obs"], "input_spaces_jsonable": true, "materialize_data": false, "materialize_mapped_data": true, "map_batches_kwargs": {}, "iter_batches_kwargs": {}, "ignore_final_observation": false, "prelearner_class": null, "prelearner_buffer_class": null, "prelearner_buffer_kwargs": {}, "prelearner_module_synch_period": 10, "dataset_num_iters_per_learner": null, "input_config": {}, "actions_in_input_normalized": false, "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_config": {}, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "output_max_rows_per_file": null, "output_write_remaining_data": false, "output_write_method": "write_parquet", "output_write_method_kwargs": {}, "output_filesystem": null, "output_filesystem_kwargs": {}, "output_write_episodes": true, "offline_sampling": false, "evaluation_interval": 1, "evaluation_duration": 20, "evaluation_duration_unit": "episodes", "evaluation_sample_timeout_s": 120.0, "evaluation_auto_duration_min_env_steps_per_sample": 100, "evaluation_auto_duration_max_env_steps_per_sample": 2000, "evaluation_parallel_to_training": false, "evaluation_force_reset_envs_before_iteration": true, "evaluation_config": null, "off_policy_estimation_methods": {}, "ope_split_batch_by_episode": true, "evaluation_num_env_runners": 1, "in_evaluation": false, "sync_filters_on_rollout_workers_timeout_s": 10.0, "offline_evaluation_interval": null, "num_offline_eval_runners": 0, "offline_loss_for_module_fn": null, "offline_evaluation_duration": 1, "offline_evaluation_parallel_to_training": false, "offline_evaluation_timeout_s": 120.0, "num_cpus_per_offline_eval_runner": 1, "num_gpus_per_offline_eval_runner": 0, "custom_resources_per_offline_eval_runner": {}, "restart_failed_offline_eval_runners": true, "ignore_offline_eval_runner_failures": false, "max_num_offline_eval_runner_restarts": 1000, "offline_eval_runner_restore_timeout_s": 1800.0, "max_requests_in_flight_per_offline_eval_runner": 1, "validate_offline_eval_runners_after_construction": true, "offline_eval_runner_health_probe_timeout_s": 30.0, "offline_eval_rl_module_inference_only": false, "broadcast_offline_eval_runner_states": false, "offline_eval_batch_size_per_runner": 256, "dataset_num_iters_per_eval_runner": 1, "keep_per_episode_custom_metrics": false, "metrics_episode_collection_timeout_s": 60.0, "metrics_num_episodes_for_smoothing": 100, "min_time_s_per_iteration": null, "min_train_timesteps_per_iteration": 0, "min_sample_timesteps_per_iteration": 0, "log_gradients": true, "export_native_model_files": false, "checkpoint_trainable_policies_only": false, "logger_creator": null, "logger_config": null, "log_level": "WARN", "log_sys_usage": true, "fake_sampler": false, "seed": 1, "restart_failed_env_runners": true, "ignore_env_runner_failures": false, "max_num_env_runner_restarts": 1000, "delay_between_env_runner_restarts_s": 60.0, "restart_failed_sub_environments": false, "num_consecutive_env_runner_failures_tolerance": 100, "env_runner_health_probe_timeout_s": 30.0, "env_runner_restore_timeout_s": 1800.0, "_model_config": {}, "_rl_module_spec": "RLModuleSpec(module_class=None, observation_space=None, action_space=None, inference_only=False, learner_only=False, model_config=DefaultModelConfig(fcnet_hiddens=[60, 90], fcnet_activation='tanh', fcnet_kernel_initializer=None, fcnet_kernel_initializer_kwargs=None, fcnet_bias_initializer=None, fcnet_bias_initializer_kwargs=None, conv_filters=None, conv_activation='relu', conv_kernel_initializer=None, conv_kernel_initializer_kwargs=None, conv_bias_initializer=None, conv_bias_initializer_kwargs=None, head_fcnet_hiddens=[], head_fcnet_activation='relu', head_fcnet_kernel_initializer=None, head_fcnet_kernel_initializer_kwargs=None, head_fcnet_bias_initializer=None, head_fcnet_bias_initializer_kwargs=None, free_log_std=False, log_std_clip_param=20.0, vf_share_layers=True, use_lstm=False, max_seq_len=20, lstm_cell_size=256, lstm_use_prev_action=False, lstm_use_prev_reward=False, lstm_kernel_initializer=None, lstm_kernel_initializer_kwargs=None, lstm_bias_initializer=None, lstm_bias_initializer_kwargs=None), catalog_class=None, load_state_path=None, model_config_dict=None)", "algorithm_config_overrides_per_module": {}, "_per_module_overrides": {}, "_validate_config": true, "_use_msgpack_checkpoints": false, "_torch_grad_scaler_class": null, "_torch_lr_scheduler_classes": null, "_tf_policy_handles_more_than_one_loss": false, "_disable_preprocessor_api": false, "_disable_action_flattening": false, "_disable_initialize_loss_from_dummy_batch": false, "_dont_auto_sync_env_runner_states": false, "env_task_fn": -1, "enable_connectors": -1, "simple_optimizer": false, "policy_map_cache": -1, "worker_cls": -1, "synchronize_filters": -1, "enable_async_evaluation": -1, "custom_async_evaluation_function": -1, "_enable_rl_module_api": -1, "auto_wrap_old_gym_envs": -1, "always_attach_evaluation_results": -1, "replay_sequence_length": null, "_disable_execution_plan_api": -1, "use_critic": true, "use_gae": true, "use_kl_loss": true, "kl_coeff": 0.7464963036515, "kl_target": 0.0270990929592, "vf_loss_coeff": 0.6688075857018, "entropy_coeff": 0.0090570820258, "clip_param": 0.1221781641624, "vf_clip_param": 0.1027808522125, "entropy_coeff_schedule": null, "lr_schedule": null, "sgd_minibatch_size": -1, "vf_share_layers": -1, "__stdout_file__": null, "__stderr_file__": null, "lambda": 0.9099046732075, "input": "sampler", "policies": {"default_policy": [null, null, null, null]}, "callbacks": "<class 'ray.rllib.callbacks.callbacks.RLlibCallback'>", "create_env_on_driver": false, "custom_eval_function": null, "framework": "torch"}, "time_since_restore": 30.341821432113647, "iterations_since_restore": 11, "perf": {"cpu_util_percent": 68.2, "ram_util_percent": 77.95}}
{"timers": {"training_iteration": 2.738692895034091, "restore_env_runners": 1.1816817664857873e-05, "training_step": 2.7384798596765765, "env_runner_sampling_timer": 2.555716013168466, "learner_update_timer": 0.17816729091338743, "synch_weights": 0.0009908657048672094, "restore_eval_env_runners": 1.6513277323019803e-05, "evaluation_iteration": 0.19395315623879228, "synch_eval_env_connectors": 0.00031221965809193644, "synch_env_connectors": 5.746727920762584e-06}, "env_runners": {"num_env_steps_sampled_lifetime": -6165000.0, "module_to_env_connector": {"timers": {"connectors": {"tensor_to_numpy": 2.527910536492594e-05, "normalize_and_clip_actions": 1.6281885638765563e-05, "un_batch_to_individual_items": 9.175416879203022e-06, "listify_data_for_vector_env": 1.9154012019707088e-05, "remove_single_ts_time_rank_from_batch": 1.198212720254756e-06, "get_actions": 8.693980831658728e-05}}, "connector_pipeline_timer": 0.000201859442061839}, "episode_len_min": 20, "episode_return_max": 9.5, "num_episodes": 250.0, "num_agent_steps_sampled": {"default_agent": 5000.0}, "env_to_module_connector": {"timers": {"connectors": {"add_states_from_episodes_to_batch": 2.6258440552930354e-06, "numpy_to_tensor": 1.7778324382687467e-05, "batch_individual_items": 1.198161111090903e-05, "add_time_dim_to_batch_and_zero_pad": 4.042923427331028e-06, "add_observations_from_episodes_to_batch": 5.948585010908487e-06}}, "connector_pipeline_timer": 7.79401928371563e-05}, "env_step_timer": 2.685133491491287e-05, "env_reset_timer": 7.352869205044655e-05, "episode_duration_sec_mean": 0.009031920634675769, "episode_return_min": -10.5, "sample": 0.009223212960472254, "episode_len_max": 20, "module_episode_returns_mean": {"default_policy": 5.740000000000001}, "agent_episode_returns_mean": {"default_agent": 5.740000000000001}, "weights_seq_no": 11.0, "num_agent_steps_sampled_lifetime": {"default_agent": -6165000.0}, "env_to_module_sum_episodes_length_in": 10.36823839457432, "env_to_module_sum_episodes_length_out": 10.36823839457432, "num_episodes_lifetime": -308250.0, "episode_return_mean": 5.740000000000001, "time_between_sampling": 0.0028898066058588912, "num_module_steps_sampled": {"default_policy": 5000.0}, "num_module_steps_sampled_lifetime": {"default_policy": -6165000.0}, "rlmodule_inference_timer": 6.930136573804793e-05, "num_env_steps_sampled": 5000.0, "episode_len_mean": 20.0, "num_env_steps_sampled_lifetime_throughput": 2335.7311584533145}, "learners": {"__all_modules__": {"num_module_steps_trained_lifetime": 72000, "learner_connector": {"timers": {"connectors": {"add_observations_from_episodes_to_batch": 0.0009765683040778665, "add_states_from_episodes_to_batch": 4.933720894363187e-06, "add_columns_from_episodes_to_train_batch": 0.04109981490262062, "batch_individual_items": 0.03727479833279159, "add_time_dim_to_batch_and_zero_pad": 1.3541954468646488e-05, "numpy_to_tensor": 7.957693110418811e-05, "general_advantage_estimation": 0.012367139990809626, "add_one_ts_to_episodes_and_truncate": 0.010694466092411616}}, "connector_pipeline_timer": 0.10268816182950609}, "num_module_steps_trained": 6000, "learner_connector_sum_episodes_length_in": 5000.0, "num_non_trainable_parameters": 0, "num_env_steps_trained": 31500, "num_env_steps_trained_lifetime": 378000, "learner_connector_sum_episodes_length_out": 5250.0, "num_trainable_parameters": 6003, "num_env_steps_trained_lifetime_throughput": 1006990.0545742237, "num_module_steps_trained_throughput": 192399.8441693564, "num_module_steps_trained_lifetime_throughput": 192369.38653439662}, "default_policy": {"num_module_steps_trained_lifetime": 72000, "num_trainable_parameters": 6003, "entropy": 0.6156450510025024, "vf_explained_var": -0.020839571952819824, "num_module_steps_trained": 6000, "weights_seq_no": 12.0, "curr_entropy_coeff": 0.0090570820258, "diff_num_grad_updates_vs_sampler_policy": 1.0, "gradients_default_optimizer_global_norm": 0.020691007375717163, "curr_kl_coeff": 0.00018225007806904614, "default_optimizer_learning_rate": 0.0002847858517, "vf_loss_unclipped": 26.743595123291016, "total_loss": -0.13557009398937225, "mean_kl_loss": 1.5084176993696019e-05, "policy_loss": -0.19873479008674622, "module_train_batch_size_mean": 1000.0, "vf_loss": 0.10278083384037018, "num_module_steps_trained_lifetime_throughput": 192544.1757821519}}, "num_training_step_calls_per_iteration": 1, "evaluation": {"env_runners": {"num_module_steps_sampled": {"default_policy": 400}, "num_episodes_lifetime": 240, "rlmodule_inference_timer": 5.435502455054732e-05, "module_to_env_connector": {"timers": {"connectors": {"remove_single_ts_time_rank_from_batch": 9.303940825162807e-07, "normalize_and_clip_actions": 1.6395162640321964e-05, "listify_data_for_vector_env": 1.8805113447515813e-05, "un_batch_to_individual_items": 8.607334307167648e-06, "get_actions": 7.812335367818926e-05, "tensor_to_numpy": 2.267356791896732e-05}}, "connector_pipeline_timer": 0.0001896131167781488}, "module_episode_returns_mean": {"default_policy": -0.2}, "agent_episode_returns_mean": {"default_agent": -0.2}, "env_reset_timer": 0.00019426506129386636, "episode_len_max": 20, "num_agent_steps_sampled_lifetime": {"default_agent": 4800}, "episode_return_mean": -0.2, "num_agent_steps_sampled": {"default_agent": 400}, "num_env_steps_sampled": 400, "episode_len_mean": 20.0, "num_env_steps_sampled_lifetime": 60400, "episode_return_max": 12.5, "env_to_module_connector": {"connector_pipeline_timer": 7.171170657416896e-05, "timers": {"connectors": {"numpy_to_tensor": 1.654636396463801e-05, "add_observations_from_episodes_to_batch": 4.445957002948961e-06, "batch_individual_items": 1.163137139902997e-05, "add_states_from_episodes_to_batch": 2.7489200548980635e-06, "add_time_dim_to_batch_and_zero_pad": 3.742018360491649e-06}}}, "episode_len_min": 20, "env_to_module_sum_episodes_length_in": 10.368238394574323, "num_episodes": 20, "sample": 0.18453280863059363, "weights_seq_no": 12.0, "env_to_module_sum_episodes_length_out": 10.368238394574323, "env_step_timer": 2.8345511847471414e-05, "episode_duration_sec_mean": 0.007668146652868017, "episode_return_min": -12.5, "num_module_steps_sampled_lifetime": {"default_policy": 4800}, "time_between_sampling": 2.645040711601168}, "num_healthy_workers": 1, "actor_manager_num_outstanding_async_reqs": 0, "num_remote_worker_restarts": 0}, "num_env_steps_sampled_lifetime": -6165000.0, "fault_tolerance": {"num_healthy_workers": 0, "num_remote_worker_restarts": 0}, "env_runner_group": {"actor_manager_num_outstanding_async_reqs": 0}, "done": false, "training_iteration": 12, "trial_id": "4380e_00000", "date": "2025-08-11_19-34-45", "timestamp": 1754933685, "time_this_iter_s": 3.1682088375091553, "time_total_s": 33.5100302696228, "pid": 26823, "hostname": "Mac", "node_ip": "127.0.0.1", "config": {"exploration_config": {}, "extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "placement_strategy": "PACK", "num_gpus": 0, "_fake_gpus": false, "num_cpus_for_main_process": 2, "eager_tracing": true, "eager_max_retraces": 20, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "torch_compile_learner": false, "torch_compile_learner_what_to_compile": "forward_train", "torch_compile_learner_dynamo_backend": "aot_eager", "torch_compile_learner_dynamo_mode": null, "torch_compile_worker": false, "torch_compile_worker_dynamo_backend": "aot_eager", "torch_compile_worker_dynamo_mode": null, "torch_ddp_kwargs": {}, "torch_skip_nan_gradients": false, "env": "Umbrella", "env_config": {}, "observation_space": null, "action_space": null, "clip_rewards": null, "normalize_actions": true, "clip_actions": false, "_is_atari": null, "disable_env_checking": false, "render_env": false, "action_mask_key": "action_mask", "env_runner_cls": null, "num_env_runners": 0, "create_local_env_runner": true, "num_envs_per_env_runner": 1, "gym_env_vectorize_mode": "SYNC", "num_cpus_per_env_runner": 1, "num_gpus_per_env_runner": 0, "custom_resources_per_env_runner": {}, "validate_env_runners_after_construction": true, "episodes_to_numpy": true, "max_requests_in_flight_per_env_runner": 1, "sample_timeout_s": 60.0, "_env_to_module_connector": null, "add_default_connectors_to_env_to_module_pipeline": true, "_module_to_env_connector": null, "add_default_connectors_to_module_to_env_pipeline": true, "merge_env_runner_states": "training_only", "broadcast_env_runner_states": true, "episode_lookback_horizon": 1, "rollout_fragment_length": "auto", "batch_mode": "complete_episodes", "compress_observations": false, "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "enable_tf1_exec_eagerly": false, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "preprocessor_pref": "deepmind", "observation_filter": "NoFilter", "update_worker_filter_stats": true, "use_worker_filter_stats": true, "sampler_perf_stats_ema_coef": null, "_is_online": true, "num_learners": 0, "num_gpus_per_learner": 0, "num_cpus_per_learner": "auto", "num_aggregator_actors_per_learner": 0, "max_requests_in_flight_per_aggregator_actor": 3, "local_gpu_idx": 0, "max_requests_in_flight_per_learner": 3, "gamma": 1, "lr": 0.0002847858517, "grad_clip": 0.5, "grad_clip_by": "global_norm", "_train_batch_size_per_learner": 5000, "train_batch_size": 4000, "num_epochs": 1, "minibatch_size": 1000, "shuffle_batch_per_epoch": true, "model": {"fcnet_hiddens": [256, 256], "fcnet_activation": "tanh", "fcnet_weights_initializer": null, "fcnet_weights_initializer_config": null, "fcnet_bias_initializer": null, "fcnet_bias_initializer_config": null, "conv_filters": null, "conv_activation": "relu", "conv_kernel_initializer": null, "conv_kernel_initializer_config": null, "conv_bias_initializer": null, "conv_bias_initializer_config": null, "conv_transpose_kernel_initializer": null, "conv_transpose_kernel_initializer_config": null, "conv_transpose_bias_initializer": null, "conv_transpose_bias_initializer_config": null, "post_fcnet_hiddens": [], "post_fcnet_activation": "relu", "post_fcnet_weights_initializer": null, "post_fcnet_weights_initializer_config": null, "post_fcnet_bias_initializer": null, "post_fcnet_bias_initializer_config": null, "free_log_std": false, "log_std_clip_param": 20.0, "no_final_linear": false, "vf_share_layers": false, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "lstm_weights_initializer": null, "lstm_weights_initializer_config": null, "lstm_bias_initializer": null, "lstm_bias_initializer_config": null, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "attention_use_n_prev_actions": 0, "attention_use_n_prev_rewards": 0, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": null, "custom_model_config": {}, "custom_action_dist": null, "custom_preprocessor": null, "encoder_latent_dim": null, "always_check_shapes": false, "lstm_use_prev_action_reward": -1, "_use_default_native_models": -1, "_disable_preprocessor_api": false, "_disable_action_flattening": false}, "_learner_connector": null, "add_default_connectors_to_learner_pipeline": true, "learner_config_dict": {}, "optimizer": {}, "_learner_class": null, "callbacks_on_algorithm_init": null, "callbacks_on_env_runners_recreated": null, "callbacks_on_offline_eval_runners_recreated": null, "callbacks_on_checkpoint_loaded": null, "callbacks_on_environment_created": null, "callbacks_on_episode_created": null, "callbacks_on_episode_start": null, "callbacks_on_episode_step": null, "callbacks_on_episode_end": null, "callbacks_on_evaluate_start": null, "callbacks_on_evaluate_end": null, "callbacks_on_evaluate_offline_start": null, "callbacks_on_evaluate_offline_end": null, "callbacks_on_sample_end": null, "callbacks_on_train_result": null, "explore": true, "enable_rl_module_and_learner": true, "enable_env_runner_and_connector_v2": true, "_prior_exploration_config": {"type": "StochasticSampling"}, "count_steps_by": "env_steps", "policy_map_capacity": 100, "policy_mapping_fn": "<function AlgorithmConfig.DEFAULT_POLICY_MAPPING_FN at 0x14cce9b20>", "policies_to_train": null, "policy_states_are_swappable": false, "observation_fn": null, "offline_data_class": null, "input_read_method": "read_parquet", "input_read_method_kwargs": {}, "input_read_schema": {}, "input_read_episodes": false, "input_read_sample_batches": false, "input_read_batch_size": null, "input_filesystem": null, "input_filesystem_kwargs": {}, "input_compress_columns": ["obs", "new_obs"], "input_spaces_jsonable": true, "materialize_data": false, "materialize_mapped_data": true, "map_batches_kwargs": {}, "iter_batches_kwargs": {}, "ignore_final_observation": false, "prelearner_class": null, "prelearner_buffer_class": null, "prelearner_buffer_kwargs": {}, "prelearner_module_synch_period": 10, "dataset_num_iters_per_learner": null, "input_config": {}, "actions_in_input_normalized": false, "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_config": {}, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "output_max_rows_per_file": null, "output_write_remaining_data": false, "output_write_method": "write_parquet", "output_write_method_kwargs": {}, "output_filesystem": null, "output_filesystem_kwargs": {}, "output_write_episodes": true, "offline_sampling": false, "evaluation_interval": 1, "evaluation_duration": 20, "evaluation_duration_unit": "episodes", "evaluation_sample_timeout_s": 120.0, "evaluation_auto_duration_min_env_steps_per_sample": 100, "evaluation_auto_duration_max_env_steps_per_sample": 2000, "evaluation_parallel_to_training": false, "evaluation_force_reset_envs_before_iteration": true, "evaluation_config": null, "off_policy_estimation_methods": {}, "ope_split_batch_by_episode": true, "evaluation_num_env_runners": 1, "in_evaluation": false, "sync_filters_on_rollout_workers_timeout_s": 10.0, "offline_evaluation_interval": null, "num_offline_eval_runners": 0, "offline_loss_for_module_fn": null, "offline_evaluation_duration": 1, "offline_evaluation_parallel_to_training": false, "offline_evaluation_timeout_s": 120.0, "num_cpus_per_offline_eval_runner": 1, "num_gpus_per_offline_eval_runner": 0, "custom_resources_per_offline_eval_runner": {}, "restart_failed_offline_eval_runners": true, "ignore_offline_eval_runner_failures": false, "max_num_offline_eval_runner_restarts": 1000, "offline_eval_runner_restore_timeout_s": 1800.0, "max_requests_in_flight_per_offline_eval_runner": 1, "validate_offline_eval_runners_after_construction": true, "offline_eval_runner_health_probe_timeout_s": 30.0, "offline_eval_rl_module_inference_only": false, "broadcast_offline_eval_runner_states": false, "offline_eval_batch_size_per_runner": 256, "dataset_num_iters_per_eval_runner": 1, "keep_per_episode_custom_metrics": false, "metrics_episode_collection_timeout_s": 60.0, "metrics_num_episodes_for_smoothing": 100, "min_time_s_per_iteration": null, "min_train_timesteps_per_iteration": 0, "min_sample_timesteps_per_iteration": 0, "log_gradients": true, "export_native_model_files": false, "checkpoint_trainable_policies_only": false, "logger_creator": null, "logger_config": null, "log_level": "WARN", "log_sys_usage": true, "fake_sampler": false, "seed": 1, "restart_failed_env_runners": true, "ignore_env_runner_failures": false, "max_num_env_runner_restarts": 1000, "delay_between_env_runner_restarts_s": 60.0, "restart_failed_sub_environments": false, "num_consecutive_env_runner_failures_tolerance": 100, "env_runner_health_probe_timeout_s": 30.0, "env_runner_restore_timeout_s": 1800.0, "_model_config": {}, "_rl_module_spec": "RLModuleSpec(module_class=None, observation_space=None, action_space=None, inference_only=False, learner_only=False, model_config=DefaultModelConfig(fcnet_hiddens=[60, 90], fcnet_activation='tanh', fcnet_kernel_initializer=None, fcnet_kernel_initializer_kwargs=None, fcnet_bias_initializer=None, fcnet_bias_initializer_kwargs=None, conv_filters=None, conv_activation='relu', conv_kernel_initializer=None, conv_kernel_initializer_kwargs=None, conv_bias_initializer=None, conv_bias_initializer_kwargs=None, head_fcnet_hiddens=[], head_fcnet_activation='relu', head_fcnet_kernel_initializer=None, head_fcnet_kernel_initializer_kwargs=None, head_fcnet_bias_initializer=None, head_fcnet_bias_initializer_kwargs=None, free_log_std=False, log_std_clip_param=20.0, vf_share_layers=True, use_lstm=False, max_seq_len=20, lstm_cell_size=256, lstm_use_prev_action=False, lstm_use_prev_reward=False, lstm_kernel_initializer=None, lstm_kernel_initializer_kwargs=None, lstm_bias_initializer=None, lstm_bias_initializer_kwargs=None), catalog_class=None, load_state_path=None, model_config_dict=None)", "algorithm_config_overrides_per_module": {}, "_per_module_overrides": {}, "_validate_config": true, "_use_msgpack_checkpoints": false, "_torch_grad_scaler_class": null, "_torch_lr_scheduler_classes": null, "_tf_policy_handles_more_than_one_loss": false, "_disable_preprocessor_api": false, "_disable_action_flattening": false, "_disable_initialize_loss_from_dummy_batch": false, "_dont_auto_sync_env_runner_states": false, "env_task_fn": -1, "enable_connectors": -1, "simple_optimizer": false, "policy_map_cache": -1, "worker_cls": -1, "synchronize_filters": -1, "enable_async_evaluation": -1, "custom_async_evaluation_function": -1, "_enable_rl_module_api": -1, "auto_wrap_old_gym_envs": -1, "always_attach_evaluation_results": -1, "replay_sequence_length": null, "_disable_execution_plan_api": -1, "use_critic": true, "use_gae": true, "use_kl_loss": true, "kl_coeff": 0.7464963036515, "kl_target": 0.0270990929592, "vf_loss_coeff": 0.6688075857018, "entropy_coeff": 0.0090570820258, "clip_param": 0.1221781641624, "vf_clip_param": 0.1027808522125, "entropy_coeff_schedule": null, "lr_schedule": null, "sgd_minibatch_size": -1, "vf_share_layers": -1, "__stdout_file__": null, "__stderr_file__": null, "lambda": 0.9099046732075, "input": "sampler", "policies": {"default_policy": [null, null, null, null]}, "callbacks": "<class 'ray.rllib.callbacks.callbacks.RLlibCallback'>", "create_env_on_driver": false, "custom_eval_function": null, "framework": "torch"}, "time_since_restore": 33.5100302696228, "iterations_since_restore": 12, "perf": {"cpu_util_percent": 75.375, "ram_util_percent": 79.65}}
{"timers": {"training_iteration": 2.7361901319130304, "restore_env_runners": 1.1816979842080281e-05, "training_step": 2.7359767781593627, "env_runner_sampling_timer": 2.5539709192870292, "learner_update_timer": 0.17741984258359714, "synch_weights": 0.0009874637073747175, "restore_eval_env_runners": 1.6446895010682522e-05, "evaluation_iteration": 0.19397125884577987, "synch_eval_env_connectors": 0.00031016955116447924, "synch_env_connectors": 5.7292609461346926e-06}, "env_runners": {"num_env_steps_sampled_lifetime": -6782500.0, "module_to_env_connector": {"timers": {"connectors": {"tensor_to_numpy": 2.1967847376147683e-05, "normalize_and_clip_actions": 1.4557002989918893e-05, "un_batch_to_individual_items": 8.095591433149076e-06, "listify_data_for_vector_env": 1.7178333383958773e-05, "remove_single_ts_time_rank_from_batch": 9.123300282699251e-07, "get_actions": 7.27491253661442e-05}}, "connector_pipeline_timer": 0.00017383073130938415}, "episode_len_min": 20, "episode_return_max": 9.5, "num_episodes": 250.0, "num_agent_steps_sampled": {"default_agent": 5000.0}, "env_to_module_connector": {"timers": {"connectors": {"add_states_from_episodes_to_batch": 2.4657396835693823e-06, "numpy_to_tensor": 1.4898939923273115e-05, "batch_individual_items": 1.0478836234527816e-05, "add_time_dim_to_batch_and_zero_pad": 3.632544037522379e-06, "add_observations_from_episodes_to_batch": 4.522751973009611e-06}}, "connector_pipeline_timer": 6.661241583265042e-05}, "env_step_timer": 2.3285324351597103e-05, "env_reset_timer": 6.837709531746422e-05, "episode_duration_sec_mean": 0.007451259521301838, "episode_return_min": -10.5, "sample": 0.008286324291345067, "episode_len_max": 20, "module_episode_returns_mean": {"default_policy": 6.940000000000001}, "agent_episode_returns_mean": {"default_agent": 6.940000000000001}, "weights_seq_no": 12.0, "num_agent_steps_sampled_lifetime": {"default_agent": -6782500.0}, "env_to_module_sum_episodes_length_in": 10.36823839457432, "env_to_module_sum_episodes_length_out": 10.36823839457432, "num_episodes_lifetime": -339125.0, "episode_return_mean": 6.940000000000001, "time_between_sampling": 0.0026819703227870173, "num_module_steps_sampled": {"default_policy": 5000.0}, "num_module_steps_sampled_lifetime": {"default_policy": -6782500.0}, "rlmodule_inference_timer": 4.8250419335023215e-05, "num_env_steps_sampled": 5000.0, "episode_len_mean": 20.0, "num_env_steps_sampled_lifetime_throughput": 2461.508472648785}, "learners": {"__all_modules__": {"num_module_steps_trained_lifetime": 78000, "learner_connector": {"timers": {"connectors": {"add_observations_from_episodes_to_batch": 0.0009754355412538568, "add_states_from_episodes_to_batch": 4.917713392058607e-06, "add_columns_from_episodes_to_train_batch": 0.04105396091347209, "batch_individual_items": 0.03723457951943666, "add_time_dim_to_batch_and_zero_pad": 1.352778497410243e-05, "numpy_to_tensor": 7.973533087467024e-05, "general_advantage_estimation": 0.012305891920701896, "add_one_ts_to_episodes_and_truncate": 0.010676006842157318}}, "connector_pipeline_timer": 0.1025208656202637}, "num_module_steps_trained": 6000, "learner_connector_sum_episodes_length_in": 5000.0, "num_non_trainable_parameters": 0, "num_env_steps_trained": 31500, "num_env_steps_trained_lifetime": 409500, "learner_connector_sum_episodes_length_out": 5250.0, "num_trainable_parameters": 6003, "num_env_steps_trained_lifetime_throughput": 1032897.3788728205, "num_module_steps_trained_throughput": 197311.53158953704, "num_module_steps_trained_lifetime_throughput": 197276.4337826367}, "default_policy": {"num_module_steps_trained_lifetime": 78000, "num_trainable_parameters": 6003, "entropy": 0.6168266534805298, "vf_explained_var": -0.02140367031097412, "num_module_steps_trained": 6000, "weights_seq_no": 13.0, "curr_entropy_coeff": 0.0090570820258, "diff_num_grad_updates_vs_sampler_policy": 1.0, "gradients_default_optimizer_global_norm": 0.05055728554725647, "curr_kl_coeff": 9.112503903452307e-05, "default_optimizer_learning_rate": 0.0002847858517, "vf_loss_unclipped": 26.886669158935547, "total_loss": 0.02526637353003025, "mean_kl_loss": 7.769689545966685e-05, "policy_loss": -0.037887606769800186, "module_train_batch_size_mean": 1000.0, "vf_loss": 0.10278083384037018, "num_module_steps_trained_lifetime_throughput": 197418.4579309108}}, "num_training_step_calls_per_iteration": 1, "evaluation": {"env_runners": {"num_module_steps_sampled": {"default_policy": 400}, "num_episodes_lifetime": 260, "rlmodule_inference_timer": 5.28088132052561e-05, "module_to_env_connector": {"timers": {"connectors": {"remove_single_ts_time_rank_from_batch": 8.813379677789446e-07, "normalize_and_clip_actions": 1.6827484039809512e-05, "listify_data_for_vector_env": 2.1859914707544204e-05, "un_batch_to_individual_items": 9.853689653503549e-06, "get_actions": 7.638383672112673e-05, "tensor_to_numpy": 2.4226823475716857e-05}}, "connector_pipeline_timer": 0.0001953702993714324}, "module_episode_returns_mean": {"default_policy": -0.2}, "agent_episode_returns_mean": {"default_agent": -0.2}, "env_reset_timer": 0.00019320949077663606, "episode_len_max": 20, "num_agent_steps_sampled_lifetime": {"default_agent": 5200}, "episode_return_mean": -0.2, "num_agent_steps_sampled": {"default_agent": 400}, "num_env_steps_sampled": 400, "episode_len_mean": 20.0, "num_env_steps_sampled_lifetime": 65400, "episode_return_max": 12.5, "env_to_module_connector": {"connector_pipeline_timer": 7.505132889490465e-05, "timers": {"connectors": {"numpy_to_tensor": 1.6279029140743974e-05, "add_observations_from_episodes_to_batch": 5.086295453595708e-06, "batch_individual_items": 1.2797275646315663e-05, "add_states_from_episodes_to_batch": 2.5356877048133553e-06, "add_time_dim_to_batch_and_zero_pad": 4.15550323732035e-06}}}, "episode_len_min": 20, "env_to_module_sum_episodes_length_in": 10.368238394574323, "num_episodes": 20, "sample": 0.18472659096386096, "weights_seq_no": 13.0, "env_to_module_sum_episodes_length_out": 10.368238394574323, "env_step_timer": 2.8151759505806028e-05, "episode_duration_sec_mean": 0.007853637954685837, "episode_return_min": -12.5, "num_module_steps_sampled_lifetime": {"default_policy": 5200}, "time_between_sampling": 2.6437185774048393}, "num_healthy_workers": 1, "actor_manager_num_outstanding_async_reqs": 0, "num_remote_worker_restarts": 0}, "num_env_steps_sampled_lifetime": -6782500.0, "fault_tolerance": {"num_healthy_workers": 0, "num_remote_worker_restarts": 0}, "env_runner_group": {"actor_manager_num_outstanding_async_reqs": 0}, "done": false, "training_iteration": 13, "trial_id": "4380e_00000", "date": "2025-08-11_19-34-48", "timestamp": 1754933688, "time_this_iter_s": 2.7020890712738037, "time_total_s": 36.212119340896606, "pid": 26823, "hostname": "Mac", "node_ip": "127.0.0.1", "config": {"exploration_config": {}, "extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "placement_strategy": "PACK", "num_gpus": 0, "_fake_gpus": false, "num_cpus_for_main_process": 2, "eager_tracing": true, "eager_max_retraces": 20, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "torch_compile_learner": false, "torch_compile_learner_what_to_compile": "forward_train", "torch_compile_learner_dynamo_backend": "aot_eager", "torch_compile_learner_dynamo_mode": null, "torch_compile_worker": false, "torch_compile_worker_dynamo_backend": "aot_eager", "torch_compile_worker_dynamo_mode": null, "torch_ddp_kwargs": {}, "torch_skip_nan_gradients": false, "env": "Umbrella", "env_config": {}, "observation_space": null, "action_space": null, "clip_rewards": null, "normalize_actions": true, "clip_actions": false, "_is_atari": null, "disable_env_checking": false, "render_env": false, "action_mask_key": "action_mask", "env_runner_cls": null, "num_env_runners": 0, "create_local_env_runner": true, "num_envs_per_env_runner": 1, "gym_env_vectorize_mode": "SYNC", "num_cpus_per_env_runner": 1, "num_gpus_per_env_runner": 0, "custom_resources_per_env_runner": {}, "validate_env_runners_after_construction": true, "episodes_to_numpy": true, "max_requests_in_flight_per_env_runner": 1, "sample_timeout_s": 60.0, "_env_to_module_connector": null, "add_default_connectors_to_env_to_module_pipeline": true, "_module_to_env_connector": null, "add_default_connectors_to_module_to_env_pipeline": true, "merge_env_runner_states": "training_only", "broadcast_env_runner_states": true, "episode_lookback_horizon": 1, "rollout_fragment_length": "auto", "batch_mode": "complete_episodes", "compress_observations": false, "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "enable_tf1_exec_eagerly": false, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "preprocessor_pref": "deepmind", "observation_filter": "NoFilter", "update_worker_filter_stats": true, "use_worker_filter_stats": true, "sampler_perf_stats_ema_coef": null, "_is_online": true, "num_learners": 0, "num_gpus_per_learner": 0, "num_cpus_per_learner": "auto", "num_aggregator_actors_per_learner": 0, "max_requests_in_flight_per_aggregator_actor": 3, "local_gpu_idx": 0, "max_requests_in_flight_per_learner": 3, "gamma": 1, "lr": 0.0002847858517, "grad_clip": 0.5, "grad_clip_by": "global_norm", "_train_batch_size_per_learner": 5000, "train_batch_size": 4000, "num_epochs": 1, "minibatch_size": 1000, "shuffle_batch_per_epoch": true, "model": {"fcnet_hiddens": [256, 256], "fcnet_activation": "tanh", "fcnet_weights_initializer": null, "fcnet_weights_initializer_config": null, "fcnet_bias_initializer": null, "fcnet_bias_initializer_config": null, "conv_filters": null, "conv_activation": "relu", "conv_kernel_initializer": null, "conv_kernel_initializer_config": null, "conv_bias_initializer": null, "conv_bias_initializer_config": null, "conv_transpose_kernel_initializer": null, "conv_transpose_kernel_initializer_config": null, "conv_transpose_bias_initializer": null, "conv_transpose_bias_initializer_config": null, "post_fcnet_hiddens": [], "post_fcnet_activation": "relu", "post_fcnet_weights_initializer": null, "post_fcnet_weights_initializer_config": null, "post_fcnet_bias_initializer": null, "post_fcnet_bias_initializer_config": null, "free_log_std": false, "log_std_clip_param": 20.0, "no_final_linear": false, "vf_share_layers": false, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "lstm_weights_initializer": null, "lstm_weights_initializer_config": null, "lstm_bias_initializer": null, "lstm_bias_initializer_config": null, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "attention_use_n_prev_actions": 0, "attention_use_n_prev_rewards": 0, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": null, "custom_model_config": {}, "custom_action_dist": null, "custom_preprocessor": null, "encoder_latent_dim": null, "always_check_shapes": false, "lstm_use_prev_action_reward": -1, "_use_default_native_models": -1, "_disable_preprocessor_api": false, "_disable_action_flattening": false}, "_learner_connector": null, "add_default_connectors_to_learner_pipeline": true, "learner_config_dict": {}, "optimizer": {}, "_learner_class": null, "callbacks_on_algorithm_init": null, "callbacks_on_env_runners_recreated": null, "callbacks_on_offline_eval_runners_recreated": null, "callbacks_on_checkpoint_loaded": null, "callbacks_on_environment_created": null, "callbacks_on_episode_created": null, "callbacks_on_episode_start": null, "callbacks_on_episode_step": null, "callbacks_on_episode_end": null, "callbacks_on_evaluate_start": null, "callbacks_on_evaluate_end": null, "callbacks_on_evaluate_offline_start": null, "callbacks_on_evaluate_offline_end": null, "callbacks_on_sample_end": null, "callbacks_on_train_result": null, "explore": true, "enable_rl_module_and_learner": true, "enable_env_runner_and_connector_v2": true, "_prior_exploration_config": {"type": "StochasticSampling"}, "count_steps_by": "env_steps", "policy_map_capacity": 100, "policy_mapping_fn": "<function AlgorithmConfig.DEFAULT_POLICY_MAPPING_FN at 0x14cce9b20>", "policies_to_train": null, "policy_states_are_swappable": false, "observation_fn": null, "offline_data_class": null, "input_read_method": "read_parquet", "input_read_method_kwargs": {}, "input_read_schema": {}, "input_read_episodes": false, "input_read_sample_batches": false, "input_read_batch_size": null, "input_filesystem": null, "input_filesystem_kwargs": {}, "input_compress_columns": ["obs", "new_obs"], "input_spaces_jsonable": true, "materialize_data": false, "materialize_mapped_data": true, "map_batches_kwargs": {}, "iter_batches_kwargs": {}, "ignore_final_observation": false, "prelearner_class": null, "prelearner_buffer_class": null, "prelearner_buffer_kwargs": {}, "prelearner_module_synch_period": 10, "dataset_num_iters_per_learner": null, "input_config": {}, "actions_in_input_normalized": false, "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_config": {}, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "output_max_rows_per_file": null, "output_write_remaining_data": false, "output_write_method": "write_parquet", "output_write_method_kwargs": {}, "output_filesystem": null, "output_filesystem_kwargs": {}, "output_write_episodes": true, "offline_sampling": false, "evaluation_interval": 1, "evaluation_duration": 20, "evaluation_duration_unit": "episodes", "evaluation_sample_timeout_s": 120.0, "evaluation_auto_duration_min_env_steps_per_sample": 100, "evaluation_auto_duration_max_env_steps_per_sample": 2000, "evaluation_parallel_to_training": false, "evaluation_force_reset_envs_before_iteration": true, "evaluation_config": null, "off_policy_estimation_methods": {}, "ope_split_batch_by_episode": true, "evaluation_num_env_runners": 1, "in_evaluation": false, "sync_filters_on_rollout_workers_timeout_s": 10.0, "offline_evaluation_interval": null, "num_offline_eval_runners": 0, "offline_loss_for_module_fn": null, "offline_evaluation_duration": 1, "offline_evaluation_parallel_to_training": false, "offline_evaluation_timeout_s": 120.0, "num_cpus_per_offline_eval_runner": 1, "num_gpus_per_offline_eval_runner": 0, "custom_resources_per_offline_eval_runner": {}, "restart_failed_offline_eval_runners": true, "ignore_offline_eval_runner_failures": false, "max_num_offline_eval_runner_restarts": 1000, "offline_eval_runner_restore_timeout_s": 1800.0, "max_requests_in_flight_per_offline_eval_runner": 1, "validate_offline_eval_runners_after_construction": true, "offline_eval_runner_health_probe_timeout_s": 30.0, "offline_eval_rl_module_inference_only": false, "broadcast_offline_eval_runner_states": false, "offline_eval_batch_size_per_runner": 256, "dataset_num_iters_per_eval_runner": 1, "keep_per_episode_custom_metrics": false, "metrics_episode_collection_timeout_s": 60.0, "metrics_num_episodes_for_smoothing": 100, "min_time_s_per_iteration": null, "min_train_timesteps_per_iteration": 0, "min_sample_timesteps_per_iteration": 0, "log_gradients": true, "export_native_model_files": false, "checkpoint_trainable_policies_only": false, "logger_creator": null, "logger_config": null, "log_level": "WARN", "log_sys_usage": true, "fake_sampler": false, "seed": 1, "restart_failed_env_runners": true, "ignore_env_runner_failures": false, "max_num_env_runner_restarts": 1000, "delay_between_env_runner_restarts_s": 60.0, "restart_failed_sub_environments": false, "num_consecutive_env_runner_failures_tolerance": 100, "env_runner_health_probe_timeout_s": 30.0, "env_runner_restore_timeout_s": 1800.0, "_model_config": {}, "_rl_module_spec": "RLModuleSpec(module_class=None, observation_space=None, action_space=None, inference_only=False, learner_only=False, model_config=DefaultModelConfig(fcnet_hiddens=[60, 90], fcnet_activation='tanh', fcnet_kernel_initializer=None, fcnet_kernel_initializer_kwargs=None, fcnet_bias_initializer=None, fcnet_bias_initializer_kwargs=None, conv_filters=None, conv_activation='relu', conv_kernel_initializer=None, conv_kernel_initializer_kwargs=None, conv_bias_initializer=None, conv_bias_initializer_kwargs=None, head_fcnet_hiddens=[], head_fcnet_activation='relu', head_fcnet_kernel_initializer=None, head_fcnet_kernel_initializer_kwargs=None, head_fcnet_bias_initializer=None, head_fcnet_bias_initializer_kwargs=None, free_log_std=False, log_std_clip_param=20.0, vf_share_layers=True, use_lstm=False, max_seq_len=20, lstm_cell_size=256, lstm_use_prev_action=False, lstm_use_prev_reward=False, lstm_kernel_initializer=None, lstm_kernel_initializer_kwargs=None, lstm_bias_initializer=None, lstm_bias_initializer_kwargs=None), catalog_class=None, load_state_path=None, model_config_dict=None)", "algorithm_config_overrides_per_module": {}, "_per_module_overrides": {}, "_validate_config": true, "_use_msgpack_checkpoints": false, "_torch_grad_scaler_class": null, "_torch_lr_scheduler_classes": null, "_tf_policy_handles_more_than_one_loss": false, "_disable_preprocessor_api": false, "_disable_action_flattening": false, "_disable_initialize_loss_from_dummy_batch": false, "_dont_auto_sync_env_runner_states": false, "env_task_fn": -1, "enable_connectors": -1, "simple_optimizer": false, "policy_map_cache": -1, "worker_cls": -1, "synchronize_filters": -1, "enable_async_evaluation": -1, "custom_async_evaluation_function": -1, "_enable_rl_module_api": -1, "auto_wrap_old_gym_envs": -1, "always_attach_evaluation_results": -1, "replay_sequence_length": null, "_disable_execution_plan_api": -1, "use_critic": true, "use_gae": true, "use_kl_loss": true, "kl_coeff": 0.7464963036515, "kl_target": 0.0270990929592, "vf_loss_coeff": 0.6688075857018, "entropy_coeff": 0.0090570820258, "clip_param": 0.1221781641624, "vf_clip_param": 0.1027808522125, "entropy_coeff_schedule": null, "lr_schedule": null, "sgd_minibatch_size": -1, "vf_share_layers": -1, "__stdout_file__": null, "__stderr_file__": null, "lambda": 0.9099046732075, "input": "sampler", "policies": {"default_policy": [null, null, null, null]}, "callbacks": "<class 'ray.rllib.callbacks.callbacks.RLlibCallback'>", "create_env_on_driver": false, "custom_eval_function": null, "framework": "torch"}, "time_since_restore": 36.212119340896606, "iterations_since_restore": 13, "perf": {"cpu_util_percent": 69.22500000000001, "ram_util_percent": 78.575}}
{"timers": {"training_iteration": 2.733776282263535, "restore_env_runners": 1.1755059598859815e-05, "training_step": 2.73356300871745, "env_runner_sampling_timer": 2.5507326000940793, "learner_update_timer": 0.17823800082724486, "synch_weights": 0.000987874070617769, "restore_eval_env_runners": 1.636284692904696e-05, "evaluation_iteration": 0.19414013541664685, "synch_eval_env_connectors": 0.00030808451647911515, "synch_env_connectors": 6.027378493444886e-06}, "env_runners": {"num_env_steps_sampled_lifetime": -7400000.0, "module_to_env_connector": {"timers": {"connectors": {"tensor_to_numpy": 2.096887691578961e-05, "normalize_and_clip_actions": 1.412063666702245e-05, "un_batch_to_individual_items": 7.85019941773644e-06, "listify_data_for_vector_env": 1.708968544789014e-05, "remove_single_ts_time_rank_from_batch": 8.556415741943927e-07, "get_actions": 6.914212914914175e-05}}, "connector_pipeline_timer": 0.00016701631637726223}, "episode_len_min": 20, "episode_return_max": 9.5, "num_episodes": 250.0, "num_agent_steps_sampled": {"default_agent": 5000.0}, "env_to_module_connector": {"timers": {"connectors": {"add_states_from_episodes_to_batch": 2.354293005269163e-06, "numpy_to_tensor": 1.47004470409301e-05, "batch_individual_items": 1.0165937111233793e-05, "add_time_dim_to_batch_and_zero_pad": 3.5636033127441483e-06, "add_observations_from_episodes_to_batch": 4.505387488149564e-06}}, "connector_pipeline_timer": 6.549348788801812e-05}, "env_step_timer": 2.2020936480982563e-05, "env_reset_timer": 6.879058489582703e-05, "episode_duration_sec_mean": 0.007315114186611028, "episode_return_min": -10.5, "sample": 0.007753398804258559, "episode_len_max": 20, "module_episode_returns_mean": {"default_policy": 6.62}, "agent_episode_returns_mean": {"default_agent": 6.62}, "weights_seq_no": 13.0, "num_agent_steps_sampled_lifetime": {"default_agent": -7400000.0}, "env_to_module_sum_episodes_length_in": 10.36823839457432, "env_to_module_sum_episodes_length_out": 10.36823839457432, "num_episodes_lifetime": -370000.0, "episode_return_mean": 6.62, "time_between_sampling": 0.002645481972373009, "num_module_steps_sampled": {"default_policy": 5000.0}, "num_module_steps_sampled_lifetime": {"default_policy": -7400000.0}, "rlmodule_inference_timer": 4.686730958737451e-05, "num_env_steps_sampled": 5000.0, "episode_len_mean": 20.0, "num_env_steps_sampled_lifetime_throughput": 2527.1374545606914}, "learners": {"__all_modules__": {"num_module_steps_trained_lifetime": 84000, "learner_connector": {"timers": {"connectors": {"add_observations_from_episodes_to_batch": 0.0009743482751191967, "add_states_from_episodes_to_batch": 4.900196569062074e-06, "add_columns_from_episodes_to_train_batch": 0.0411522017243967, "batch_individual_items": 0.03849508580475322, "add_time_dim_to_batch_and_zero_pad": 1.3525837592449795e-05, "numpy_to_tensor": 7.984297747212073e-05, "general_advantage_estimation": 0.012238265921839051, "add_one_ts_to_episodes_and_truncate": 0.010673531353601379}}, "connector_pipeline_timer": 0.10380817863430757}, "num_module_steps_trained": 6000, "learner_connector_sum_episodes_length_in": 5000.0, "num_non_trainable_parameters": 0, "num_env_steps_trained": 31500, "num_env_steps_trained_lifetime": 441000, "learner_connector_sum_episodes_length_out": 5250.0, "num_trainable_parameters": 6003, "num_env_steps_trained_lifetime_throughput": 1050371.2439607675, "num_module_steps_trained_throughput": 200614.35980035097, "num_module_steps_trained_lifetime_throughput": 200577.46177216442}, "default_policy": {"num_module_steps_trained_lifetime": 84000, "num_trainable_parameters": 6003, "entropy": 0.6145032048225403, "vf_explained_var": -0.022045254707336426, "num_module_steps_trained": 6000, "weights_seq_no": 14.0, "curr_entropy_coeff": 0.0090570820258, "diff_num_grad_updates_vs_sampler_policy": 1.0, "gradients_default_optimizer_global_norm": 0.02799815684556961, "curr_kl_coeff": 4.5562519517261535e-05, "default_optimizer_learning_rate": 0.0002847858517, "vf_loss_unclipped": 27.137771606445312, "total_loss": 0.08509045839309692, "mean_kl_loss": 6.392585055436939e-05, "policy_loss": 0.021915465593338013, "module_train_batch_size_mean": 1000.0, "vf_loss": 0.10278083384037018, "num_module_steps_trained_lifetime_throughput": 200691.0600727438}}, "num_training_step_calls_per_iteration": 1, "evaluation": {"env_runners": {"num_module_steps_sampled": {"default_policy": 400}, "num_episodes_lifetime": 280, "rlmodule_inference_timer": 3.8838363960464736e-05, "module_to_env_connector": {"timers": {"connectors": {"remove_single_ts_time_rank_from_batch": 7.252397128855297e-07, "normalize_and_clip_actions": 1.2879600648277052e-05, "listify_data_for_vector_env": 1.4113011556056212e-05, "un_batch_to_individual_items": 6.939560840544542e-06, "get_actions": 5.807961261487431e-05, "tensor_to_numpy": 1.7616120449783223e-05}}, "connector_pipeline_timer": 0.00014383781348614882}, "module_episode_returns_mean": {"default_policy": -1.2}, "agent_episode_returns_mean": {"default_agent": -1.2}, "env_reset_timer": 0.00019227281555552988, "episode_len_max": 20, "num_agent_steps_sampled_lifetime": {"default_agent": 5600}, "episode_return_mean": -1.2, "num_agent_steps_sampled": {"default_agent": 400}, "num_env_steps_sampled": 400, "episode_len_mean": 20.0, "num_env_steps_sampled_lifetime": 70400, "episode_return_max": 12.5, "env_to_module_connector": {"connector_pipeline_timer": 5.6751814000604286e-05, "timers": {"connectors": {"numpy_to_tensor": 1.2560210027275924e-05, "add_observations_from_episodes_to_batch": 3.6587228368451238e-06, "batch_individual_items": 8.677443150763347e-06, "add_states_from_episodes_to_batch": 2.007188729902035e-06, "add_time_dim_to_batch_and_zero_pad": 2.7097778750849466e-06}}}, "episode_len_min": 20, "env_to_module_sum_episodes_length_in": 10.368238394574323, "num_episodes": 20, "sample": 0.18445786505528688, "weights_seq_no": 14.0, "env_to_module_sum_episodes_length_out": 10.368238394574323, "env_step_timer": 2.03453501652823e-05, "episode_duration_sec_mean": 0.00776184591348283, "episode_return_min": -12.5, "num_module_steps_sampled_lifetime": {"default_policy": 5600}, "time_between_sampling": 2.642483492040451}, "num_healthy_workers": 1, "actor_manager_num_outstanding_async_reqs": 0, "num_remote_worker_restarts": 0}, "num_env_steps_sampled_lifetime": -7400000.0, "fault_tolerance": {"num_healthy_workers": 0, "num_remote_worker_restarts": 0}, "env_runner_group": {"actor_manager_num_outstanding_async_reqs": 0}, "done": false, "training_iteration": 14, "trial_id": "4380e_00000", "date": "2025-08-11_19-34-50", "timestamp": 1754933690, "time_this_iter_s": 2.6630170345306396, "time_total_s": 38.875136375427246, "pid": 26823, "hostname": "Mac", "node_ip": "127.0.0.1", "config": {"exploration_config": {}, "extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "placement_strategy": "PACK", "num_gpus": 0, "_fake_gpus": false, "num_cpus_for_main_process": 2, "eager_tracing": true, "eager_max_retraces": 20, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "torch_compile_learner": false, "torch_compile_learner_what_to_compile": "forward_train", "torch_compile_learner_dynamo_backend": "aot_eager", "torch_compile_learner_dynamo_mode": null, "torch_compile_worker": false, "torch_compile_worker_dynamo_backend": "aot_eager", "torch_compile_worker_dynamo_mode": null, "torch_ddp_kwargs": {}, "torch_skip_nan_gradients": false, "env": "Umbrella", "env_config": {}, "observation_space": null, "action_space": null, "clip_rewards": null, "normalize_actions": true, "clip_actions": false, "_is_atari": null, "disable_env_checking": false, "render_env": false, "action_mask_key": "action_mask", "env_runner_cls": null, "num_env_runners": 0, "create_local_env_runner": true, "num_envs_per_env_runner": 1, "gym_env_vectorize_mode": "SYNC", "num_cpus_per_env_runner": 1, "num_gpus_per_env_runner": 0, "custom_resources_per_env_runner": {}, "validate_env_runners_after_construction": true, "episodes_to_numpy": true, "max_requests_in_flight_per_env_runner": 1, "sample_timeout_s": 60.0, "_env_to_module_connector": null, "add_default_connectors_to_env_to_module_pipeline": true, "_module_to_env_connector": null, "add_default_connectors_to_module_to_env_pipeline": true, "merge_env_runner_states": "training_only", "broadcast_env_runner_states": true, "episode_lookback_horizon": 1, "rollout_fragment_length": "auto", "batch_mode": "complete_episodes", "compress_observations": false, "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "enable_tf1_exec_eagerly": false, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "preprocessor_pref": "deepmind", "observation_filter": "NoFilter", "update_worker_filter_stats": true, "use_worker_filter_stats": true, "sampler_perf_stats_ema_coef": null, "_is_online": true, "num_learners": 0, "num_gpus_per_learner": 0, "num_cpus_per_learner": "auto", "num_aggregator_actors_per_learner": 0, "max_requests_in_flight_per_aggregator_actor": 3, "local_gpu_idx": 0, "max_requests_in_flight_per_learner": 3, "gamma": 1, "lr": 0.0002847858517, "grad_clip": 0.5, "grad_clip_by": "global_norm", "_train_batch_size_per_learner": 5000, "train_batch_size": 4000, "num_epochs": 1, "minibatch_size": 1000, "shuffle_batch_per_epoch": true, "model": {"fcnet_hiddens": [256, 256], "fcnet_activation": "tanh", "fcnet_weights_initializer": null, "fcnet_weights_initializer_config": null, "fcnet_bias_initializer": null, "fcnet_bias_initializer_config": null, "conv_filters": null, "conv_activation": "relu", "conv_kernel_initializer": null, "conv_kernel_initializer_config": null, "conv_bias_initializer": null, "conv_bias_initializer_config": null, "conv_transpose_kernel_initializer": null, "conv_transpose_kernel_initializer_config": null, "conv_transpose_bias_initializer": null, "conv_transpose_bias_initializer_config": null, "post_fcnet_hiddens": [], "post_fcnet_activation": "relu", "post_fcnet_weights_initializer": null, "post_fcnet_weights_initializer_config": null, "post_fcnet_bias_initializer": null, "post_fcnet_bias_initializer_config": null, "free_log_std": false, "log_std_clip_param": 20.0, "no_final_linear": false, "vf_share_layers": false, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "lstm_weights_initializer": null, "lstm_weights_initializer_config": null, "lstm_bias_initializer": null, "lstm_bias_initializer_config": null, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "attention_use_n_prev_actions": 0, "attention_use_n_prev_rewards": 0, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": null, "custom_model_config": {}, "custom_action_dist": null, "custom_preprocessor": null, "encoder_latent_dim": null, "always_check_shapes": false, "lstm_use_prev_action_reward": -1, "_use_default_native_models": -1, "_disable_preprocessor_api": false, "_disable_action_flattening": false}, "_learner_connector": null, "add_default_connectors_to_learner_pipeline": true, "learner_config_dict": {}, "optimizer": {}, "_learner_class": null, "callbacks_on_algorithm_init": null, "callbacks_on_env_runners_recreated": null, "callbacks_on_offline_eval_runners_recreated": null, "callbacks_on_checkpoint_loaded": null, "callbacks_on_environment_created": null, "callbacks_on_episode_created": null, "callbacks_on_episode_start": null, "callbacks_on_episode_step": null, "callbacks_on_episode_end": null, "callbacks_on_evaluate_start": null, "callbacks_on_evaluate_end": null, "callbacks_on_evaluate_offline_start": null, "callbacks_on_evaluate_offline_end": null, "callbacks_on_sample_end": null, "callbacks_on_train_result": null, "explore": true, "enable_rl_module_and_learner": true, "enable_env_runner_and_connector_v2": true, "_prior_exploration_config": {"type": "StochasticSampling"}, "count_steps_by": "env_steps", "policy_map_capacity": 100, "policy_mapping_fn": "<function AlgorithmConfig.DEFAULT_POLICY_MAPPING_FN at 0x14cce9b20>", "policies_to_train": null, "policy_states_are_swappable": false, "observation_fn": null, "offline_data_class": null, "input_read_method": "read_parquet", "input_read_method_kwargs": {}, "input_read_schema": {}, "input_read_episodes": false, "input_read_sample_batches": false, "input_read_batch_size": null, "input_filesystem": null, "input_filesystem_kwargs": {}, "input_compress_columns": ["obs", "new_obs"], "input_spaces_jsonable": true, "materialize_data": false, "materialize_mapped_data": true, "map_batches_kwargs": {}, "iter_batches_kwargs": {}, "ignore_final_observation": false, "prelearner_class": null, "prelearner_buffer_class": null, "prelearner_buffer_kwargs": {}, "prelearner_module_synch_period": 10, "dataset_num_iters_per_learner": null, "input_config": {}, "actions_in_input_normalized": false, "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_config": {}, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "output_max_rows_per_file": null, "output_write_remaining_data": false, "output_write_method": "write_parquet", "output_write_method_kwargs": {}, "output_filesystem": null, "output_filesystem_kwargs": {}, "output_write_episodes": true, "offline_sampling": false, "evaluation_interval": 1, "evaluation_duration": 20, "evaluation_duration_unit": "episodes", "evaluation_sample_timeout_s": 120.0, "evaluation_auto_duration_min_env_steps_per_sample": 100, "evaluation_auto_duration_max_env_steps_per_sample": 2000, "evaluation_parallel_to_training": false, "evaluation_force_reset_envs_before_iteration": true, "evaluation_config": null, "off_policy_estimation_methods": {}, "ope_split_batch_by_episode": true, "evaluation_num_env_runners": 1, "in_evaluation": false, "sync_filters_on_rollout_workers_timeout_s": 10.0, "offline_evaluation_interval": null, "num_offline_eval_runners": 0, "offline_loss_for_module_fn": null, "offline_evaluation_duration": 1, "offline_evaluation_parallel_to_training": false, "offline_evaluation_timeout_s": 120.0, "num_cpus_per_offline_eval_runner": 1, "num_gpus_per_offline_eval_runner": 0, "custom_resources_per_offline_eval_runner": {}, "restart_failed_offline_eval_runners": true, "ignore_offline_eval_runner_failures": false, "max_num_offline_eval_runner_restarts": 1000, "offline_eval_runner_restore_timeout_s": 1800.0, "max_requests_in_flight_per_offline_eval_runner": 1, "validate_offline_eval_runners_after_construction": true, "offline_eval_runner_health_probe_timeout_s": 30.0, "offline_eval_rl_module_inference_only": false, "broadcast_offline_eval_runner_states": false, "offline_eval_batch_size_per_runner": 256, "dataset_num_iters_per_eval_runner": 1, "keep_per_episode_custom_metrics": false, "metrics_episode_collection_timeout_s": 60.0, "metrics_num_episodes_for_smoothing": 100, "min_time_s_per_iteration": null, "min_train_timesteps_per_iteration": 0, "min_sample_timesteps_per_iteration": 0, "log_gradients": true, "export_native_model_files": false, "checkpoint_trainable_policies_only": false, "logger_creator": null, "logger_config": null, "log_level": "WARN", "log_sys_usage": true, "fake_sampler": false, "seed": 1, "restart_failed_env_runners": true, "ignore_env_runner_failures": false, "max_num_env_runner_restarts": 1000, "delay_between_env_runner_restarts_s": 60.0, "restart_failed_sub_environments": false, "num_consecutive_env_runner_failures_tolerance": 100, "env_runner_health_probe_timeout_s": 30.0, "env_runner_restore_timeout_s": 1800.0, "_model_config": {}, "_rl_module_spec": "RLModuleSpec(module_class=None, observation_space=None, action_space=None, inference_only=False, learner_only=False, model_config=DefaultModelConfig(fcnet_hiddens=[60, 90], fcnet_activation='tanh', fcnet_kernel_initializer=None, fcnet_kernel_initializer_kwargs=None, fcnet_bias_initializer=None, fcnet_bias_initializer_kwargs=None, conv_filters=None, conv_activation='relu', conv_kernel_initializer=None, conv_kernel_initializer_kwargs=None, conv_bias_initializer=None, conv_bias_initializer_kwargs=None, head_fcnet_hiddens=[], head_fcnet_activation='relu', head_fcnet_kernel_initializer=None, head_fcnet_kernel_initializer_kwargs=None, head_fcnet_bias_initializer=None, head_fcnet_bias_initializer_kwargs=None, free_log_std=False, log_std_clip_param=20.0, vf_share_layers=True, use_lstm=False, max_seq_len=20, lstm_cell_size=256, lstm_use_prev_action=False, lstm_use_prev_reward=False, lstm_kernel_initializer=None, lstm_kernel_initializer_kwargs=None, lstm_bias_initializer=None, lstm_bias_initializer_kwargs=None), catalog_class=None, load_state_path=None, model_config_dict=None)", "algorithm_config_overrides_per_module": {}, "_per_module_overrides": {}, "_validate_config": true, "_use_msgpack_checkpoints": false, "_torch_grad_scaler_class": null, "_torch_lr_scheduler_classes": null, "_tf_policy_handles_more_than_one_loss": false, "_disable_preprocessor_api": false, "_disable_action_flattening": false, "_disable_initialize_loss_from_dummy_batch": false, "_dont_auto_sync_env_runner_states": false, "env_task_fn": -1, "enable_connectors": -1, "simple_optimizer": false, "policy_map_cache": -1, "worker_cls": -1, "synchronize_filters": -1, "enable_async_evaluation": -1, "custom_async_evaluation_function": -1, "_enable_rl_module_api": -1, "auto_wrap_old_gym_envs": -1, "always_attach_evaluation_results": -1, "replay_sequence_length": null, "_disable_execution_plan_api": -1, "use_critic": true, "use_gae": true, "use_kl_loss": true, "kl_coeff": 0.7464963036515, "kl_target": 0.0270990929592, "vf_loss_coeff": 0.6688075857018, "entropy_coeff": 0.0090570820258, "clip_param": 0.1221781641624, "vf_clip_param": 0.1027808522125, "entropy_coeff_schedule": null, "lr_schedule": null, "sgd_minibatch_size": -1, "vf_share_layers": -1, "__stdout_file__": null, "__stderr_file__": null, "lambda": 0.9099046732075, "input": "sampler", "policies": {"default_policy": [null, null, null, null]}, "callbacks": "<class 'ray.rllib.callbacks.callbacks.RLlibCallback'>", "create_env_on_driver": false, "custom_eval_function": null, "framework": "torch"}, "time_since_restore": 38.875136375427246, "iterations_since_restore": 14, "perf": {"cpu_util_percent": 67.76666666666667, "ram_util_percent": 78.10000000000001}}
{"timers": {"training_iteration": 2.7314649144404854, "restore_env_runners": 1.1703759798369708e-05, "training_step": 2.7312512990499016, "env_runner_sampling_timer": 2.5476887899224336, "learner_update_timer": 0.17897031498906746, "synch_weights": 0.0009849203302550631, "restore_eval_env_runners": 1.630254869941008e-05, "evaluation_iteration": 0.19384284906227942, "synch_eval_env_connectors": 0.00030638700198730337, "synch_env_connectors": 6.006695231157341e-06}, "env_runners": {"num_env_steps_sampled_lifetime": -8017500.0, "module_to_env_connector": {"timers": {"connectors": {"tensor_to_numpy": 2.200118366390264e-05, "normalize_and_clip_actions": 1.4614298592176254e-05, "un_batch_to_individual_items": 8.526571933735419e-06, "listify_data_for_vector_env": 1.774707765275586e-05, "remove_single_ts_time_rank_from_batch": 9.244920231550824e-07, "get_actions": 7.330460295683903e-05}}, "connector_pipeline_timer": 0.00017590693897620352}, "episode_len_min": 20, "episode_return_max": 9.5, "num_episodes": 250.0, "num_agent_steps_sampled": {"default_agent": 5000.0}, "env_to_module_connector": {"timers": {"connectors": {"add_states_from_episodes_to_batch": 2.457787595223163e-06, "numpy_to_tensor": 1.4964138222885462e-05, "batch_individual_items": 1.0389525458506516e-05, "add_time_dim_to_batch_and_zero_pad": 3.6540933016716777e-06, "add_observations_from_episodes_to_batch": 4.8081589488209085e-06}}, "connector_pipeline_timer": 6.729185438290498e-05}, "env_step_timer": 2.3967898702883484e-05, "env_reset_timer": 6.979457940430659e-05, "episode_duration_sec_mean": 0.007460883172228931, "episode_return_min": -10.5, "sample": 0.008039982965715248, "episode_len_max": 20, "module_episode_returns_mean": {"default_policy": 6.46}, "agent_episode_returns_mean": {"default_agent": 6.46}, "weights_seq_no": 14.0, "num_agent_steps_sampled_lifetime": {"default_agent": -8017500.0}, "env_to_module_sum_episodes_length_in": 10.36823839457432, "env_to_module_sum_episodes_length_out": 10.36823839457432, "num_episodes_lifetime": -400875.0, "episode_return_mean": 6.46, "time_between_sampling": 0.0028184943740196303, "num_module_steps_sampled": {"default_policy": 5000.0}, "num_module_steps_sampled_lifetime": {"default_policy": -8017500.0}, "rlmodule_inference_timer": 4.7892452791819e-05, "num_env_steps_sampled": 5000.0, "episode_len_mean": 20.0, "num_env_steps_sampled_lifetime_throughput": 2487.443221859053}, "learners": {"__all_modules__": {"num_module_steps_trained_lifetime": 90000, "learner_connector": {"timers": {"connectors": {"add_observations_from_episodes_to_batch": 0.00097641938174736, "add_states_from_episodes_to_batch": 4.966194314884972e-06, "add_columns_from_episodes_to_train_batch": 0.04112696720730324, "batch_individual_items": 0.03983921285654596, "add_time_dim_to_batch_and_zero_pad": 1.3899749566212635e-05, "numpy_to_tensor": 8.022995718928124e-05, "general_advantage_estimation": 0.012199605342491883, "add_one_ts_to_episodes_and_truncate": 0.010677303960682604}}, "connector_pipeline_timer": 0.10509663059812975}, "num_module_steps_trained": 6000, "learner_connector_sum_episodes_length_in": 5000.0, "num_non_trainable_parameters": 0, "num_env_steps_trained": 31500, "num_env_steps_trained_lifetime": 472500, "learner_connector_sum_episodes_length_out": 5250.0, "num_trainable_parameters": 6003, "num_env_steps_trained_lifetime_throughput": 1070350.9354400006, "num_module_steps_trained_throughput": 204393.87745313867, "num_module_steps_trained_lifetime_throughput": 204357.62896652642}, "default_policy": {"num_module_steps_trained_lifetime": 90000, "num_trainable_parameters": 6003, "entropy": 0.6047009825706482, "vf_explained_var": -0.022460103034973145, "num_module_steps_trained": 6000, "weights_seq_no": 15.0, "curr_entropy_coeff": 0.0090570820258, "diff_num_grad_updates_vs_sampler_policy": 1.0, "gradients_default_optimizer_global_norm": 0.07249045372009277, "curr_kl_coeff": 2.2781259758630767e-05, "default_optimizer_learning_rate": 0.0002847858517, "vf_loss_unclipped": 27.49070930480957, "total_loss": 0.20799577236175537, "mean_kl_loss": 2.6270066882716492e-05, "policy_loss": 0.14473199844360352, "module_train_batch_size_mean": 1000.0, "vf_loss": 0.10278083384037018, "num_module_steps_trained_lifetime_throughput": 204439.05315204206}}, "num_training_step_calls_per_iteration": 1, "evaluation": {"env_runners": {"num_module_steps_sampled": {"default_policy": 400}, "num_episodes_lifetime": 300, "rlmodule_inference_timer": 4.317771511049621e-05, "module_to_env_connector": {"timers": {"connectors": {"remove_single_ts_time_rank_from_batch": 7.666202800403085e-07, "normalize_and_clip_actions": 1.3694847961525052e-05, "listify_data_for_vector_env": 1.542890961879346e-05, "un_batch_to_individual_items": 7.564237970591159e-06, "get_actions": 6.168868314777367e-05, "tensor_to_numpy": 1.9049695082476087e-05}}, "connector_pipeline_timer": 0.0001543899957896391}, "module_episode_returns_mean": {"default_policy": -1.2}, "agent_episode_returns_mean": {"default_agent": -1.2}, "env_reset_timer": 0.00019122591711898161, "episode_len_max": 20, "num_agent_steps_sampled_lifetime": {"default_agent": 6000}, "episode_return_mean": -1.2, "num_agent_steps_sampled": {"default_agent": 400}, "num_env_steps_sampled": 400, "episode_len_mean": 20.0, "num_env_steps_sampled_lifetime": 75400, "episode_return_max": 12.5, "env_to_module_connector": {"connector_pipeline_timer": 5.981771236410116e-05, "timers": {"connectors": {"numpy_to_tensor": 1.3320469509154641e-05, "add_observations_from_episodes_to_batch": 3.916166516916677e-06, "batch_individual_items": 8.957985437389767e-06, "add_states_from_episodes_to_batch": 2.004593491892708e-06, "add_time_dim_to_batch_and_zero_pad": 3.030204468812105e-06}}}, "episode_len_min": 20, "env_to_module_sum_episodes_length_in": 10.368238394574323, "num_episodes": 20, "sample": 0.18440157057447684, "weights_seq_no": 15.0, "env_to_module_sum_episodes_length_out": 10.368238394574323, "env_step_timer": 2.0716786591784847e-05, "episode_duration_sec_mean": 0.007896320085274055, "episode_return_min": -12.5, "num_module_steps_sampled_lifetime": {"default_policy": 6000}, "time_between_sampling": 2.641316457950342}, "num_healthy_workers": 1, "actor_manager_num_outstanding_async_reqs": 0, "num_remote_worker_restarts": 0}, "num_env_steps_sampled_lifetime": -8017500.0, "fault_tolerance": {"num_healthy_workers": 0, "num_remote_worker_restarts": 0}, "env_runner_group": {"actor_manager_num_outstanding_async_reqs": 0}, "done": false, "training_iteration": 15, "trial_id": "4380e_00000", "date": "2025-08-11_19-34-53", "timestamp": 1754933693, "time_this_iter_s": 2.6904990673065186, "time_total_s": 41.565635442733765, "pid": 26823, "hostname": "Mac", "node_ip": "127.0.0.1", "config": {"exploration_config": {}, "extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "placement_strategy": "PACK", "num_gpus": 0, "_fake_gpus": false, "num_cpus_for_main_process": 2, "eager_tracing": true, "eager_max_retraces": 20, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "torch_compile_learner": false, "torch_compile_learner_what_to_compile": "forward_train", "torch_compile_learner_dynamo_backend": "aot_eager", "torch_compile_learner_dynamo_mode": null, "torch_compile_worker": false, "torch_compile_worker_dynamo_backend": "aot_eager", "torch_compile_worker_dynamo_mode": null, "torch_ddp_kwargs": {}, "torch_skip_nan_gradients": false, "env": "Umbrella", "env_config": {}, "observation_space": null, "action_space": null, "clip_rewards": null, "normalize_actions": true, "clip_actions": false, "_is_atari": null, "disable_env_checking": false, "render_env": false, "action_mask_key": "action_mask", "env_runner_cls": null, "num_env_runners": 0, "create_local_env_runner": true, "num_envs_per_env_runner": 1, "gym_env_vectorize_mode": "SYNC", "num_cpus_per_env_runner": 1, "num_gpus_per_env_runner": 0, "custom_resources_per_env_runner": {}, "validate_env_runners_after_construction": true, "episodes_to_numpy": true, "max_requests_in_flight_per_env_runner": 1, "sample_timeout_s": 60.0, "_env_to_module_connector": null, "add_default_connectors_to_env_to_module_pipeline": true, "_module_to_env_connector": null, "add_default_connectors_to_module_to_env_pipeline": true, "merge_env_runner_states": "training_only", "broadcast_env_runner_states": true, "episode_lookback_horizon": 1, "rollout_fragment_length": "auto", "batch_mode": "complete_episodes", "compress_observations": false, "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "enable_tf1_exec_eagerly": false, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "preprocessor_pref": "deepmind", "observation_filter": "NoFilter", "update_worker_filter_stats": true, "use_worker_filter_stats": true, "sampler_perf_stats_ema_coef": null, "_is_online": true, "num_learners": 0, "num_gpus_per_learner": 0, "num_cpus_per_learner": "auto", "num_aggregator_actors_per_learner": 0, "max_requests_in_flight_per_aggregator_actor": 3, "local_gpu_idx": 0, "max_requests_in_flight_per_learner": 3, "gamma": 1, "lr": 0.0002847858517, "grad_clip": 0.5, "grad_clip_by": "global_norm", "_train_batch_size_per_learner": 5000, "train_batch_size": 4000, "num_epochs": 1, "minibatch_size": 1000, "shuffle_batch_per_epoch": true, "model": {"fcnet_hiddens": [256, 256], "fcnet_activation": "tanh", "fcnet_weights_initializer": null, "fcnet_weights_initializer_config": null, "fcnet_bias_initializer": null, "fcnet_bias_initializer_config": null, "conv_filters": null, "conv_activation": "relu", "conv_kernel_initializer": null, "conv_kernel_initializer_config": null, "conv_bias_initializer": null, "conv_bias_initializer_config": null, "conv_transpose_kernel_initializer": null, "conv_transpose_kernel_initializer_config": null, "conv_transpose_bias_initializer": null, "conv_transpose_bias_initializer_config": null, "post_fcnet_hiddens": [], "post_fcnet_activation": "relu", "post_fcnet_weights_initializer": null, "post_fcnet_weights_initializer_config": null, "post_fcnet_bias_initializer": null, "post_fcnet_bias_initializer_config": null, "free_log_std": false, "log_std_clip_param": 20.0, "no_final_linear": false, "vf_share_layers": false, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "lstm_weights_initializer": null, "lstm_weights_initializer_config": null, "lstm_bias_initializer": null, "lstm_bias_initializer_config": null, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "attention_use_n_prev_actions": 0, "attention_use_n_prev_rewards": 0, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": null, "custom_model_config": {}, "custom_action_dist": null, "custom_preprocessor": null, "encoder_latent_dim": null, "always_check_shapes": false, "lstm_use_prev_action_reward": -1, "_use_default_native_models": -1, "_disable_preprocessor_api": false, "_disable_action_flattening": false}, "_learner_connector": null, "add_default_connectors_to_learner_pipeline": true, "learner_config_dict": {}, "optimizer": {}, "_learner_class": null, "callbacks_on_algorithm_init": null, "callbacks_on_env_runners_recreated": null, "callbacks_on_offline_eval_runners_recreated": null, "callbacks_on_checkpoint_loaded": null, "callbacks_on_environment_created": null, "callbacks_on_episode_created": null, "callbacks_on_episode_start": null, "callbacks_on_episode_step": null, "callbacks_on_episode_end": null, "callbacks_on_evaluate_start": null, "callbacks_on_evaluate_end": null, "callbacks_on_evaluate_offline_start": null, "callbacks_on_evaluate_offline_end": null, "callbacks_on_sample_end": null, "callbacks_on_train_result": null, "explore": true, "enable_rl_module_and_learner": true, "enable_env_runner_and_connector_v2": true, "_prior_exploration_config": {"type": "StochasticSampling"}, "count_steps_by": "env_steps", "policy_map_capacity": 100, "policy_mapping_fn": "<function AlgorithmConfig.DEFAULT_POLICY_MAPPING_FN at 0x14cce9b20>", "policies_to_train": null, "policy_states_are_swappable": false, "observation_fn": null, "offline_data_class": null, "input_read_method": "read_parquet", "input_read_method_kwargs": {}, "input_read_schema": {}, "input_read_episodes": false, "input_read_sample_batches": false, "input_read_batch_size": null, "input_filesystem": null, "input_filesystem_kwargs": {}, "input_compress_columns": ["obs", "new_obs"], "input_spaces_jsonable": true, "materialize_data": false, "materialize_mapped_data": true, "map_batches_kwargs": {}, "iter_batches_kwargs": {}, "ignore_final_observation": false, "prelearner_class": null, "prelearner_buffer_class": null, "prelearner_buffer_kwargs": {}, "prelearner_module_synch_period": 10, "dataset_num_iters_per_learner": null, "input_config": {}, "actions_in_input_normalized": false, "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_config": {}, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "output_max_rows_per_file": null, "output_write_remaining_data": false, "output_write_method": "write_parquet", "output_write_method_kwargs": {}, "output_filesystem": null, "output_filesystem_kwargs": {}, "output_write_episodes": true, "offline_sampling": false, "evaluation_interval": 1, "evaluation_duration": 20, "evaluation_duration_unit": "episodes", "evaluation_sample_timeout_s": 120.0, "evaluation_auto_duration_min_env_steps_per_sample": 100, "evaluation_auto_duration_max_env_steps_per_sample": 2000, "evaluation_parallel_to_training": false, "evaluation_force_reset_envs_before_iteration": true, "evaluation_config": null, "off_policy_estimation_methods": {}, "ope_split_batch_by_episode": true, "evaluation_num_env_runners": 1, "in_evaluation": false, "sync_filters_on_rollout_workers_timeout_s": 10.0, "offline_evaluation_interval": null, "num_offline_eval_runners": 0, "offline_loss_for_module_fn": null, "offline_evaluation_duration": 1, "offline_evaluation_parallel_to_training": false, "offline_evaluation_timeout_s": 120.0, "num_cpus_per_offline_eval_runner": 1, "num_gpus_per_offline_eval_runner": 0, "custom_resources_per_offline_eval_runner": {}, "restart_failed_offline_eval_runners": true, "ignore_offline_eval_runner_failures": false, "max_num_offline_eval_runner_restarts": 1000, "offline_eval_runner_restore_timeout_s": 1800.0, "max_requests_in_flight_per_offline_eval_runner": 1, "validate_offline_eval_runners_after_construction": true, "offline_eval_runner_health_probe_timeout_s": 30.0, "offline_eval_rl_module_inference_only": false, "broadcast_offline_eval_runner_states": false, "offline_eval_batch_size_per_runner": 256, "dataset_num_iters_per_eval_runner": 1, "keep_per_episode_custom_metrics": false, "metrics_episode_collection_timeout_s": 60.0, "metrics_num_episodes_for_smoothing": 100, "min_time_s_per_iteration": null, "min_train_timesteps_per_iteration": 0, "min_sample_timesteps_per_iteration": 0, "log_gradients": true, "export_native_model_files": false, "checkpoint_trainable_policies_only": false, "logger_creator": null, "logger_config": null, "log_level": "WARN", "log_sys_usage": true, "fake_sampler": false, "seed": 1, "restart_failed_env_runners": true, "ignore_env_runner_failures": false, "max_num_env_runner_restarts": 1000, "delay_between_env_runner_restarts_s": 60.0, "restart_failed_sub_environments": false, "num_consecutive_env_runner_failures_tolerance": 100, "env_runner_health_probe_timeout_s": 30.0, "env_runner_restore_timeout_s": 1800.0, "_model_config": {}, "_rl_module_spec": "RLModuleSpec(module_class=None, observation_space=None, action_space=None, inference_only=False, learner_only=False, model_config=DefaultModelConfig(fcnet_hiddens=[60, 90], fcnet_activation='tanh', fcnet_kernel_initializer=None, fcnet_kernel_initializer_kwargs=None, fcnet_bias_initializer=None, fcnet_bias_initializer_kwargs=None, conv_filters=None, conv_activation='relu', conv_kernel_initializer=None, conv_kernel_initializer_kwargs=None, conv_bias_initializer=None, conv_bias_initializer_kwargs=None, head_fcnet_hiddens=[], head_fcnet_activation='relu', head_fcnet_kernel_initializer=None, head_fcnet_kernel_initializer_kwargs=None, head_fcnet_bias_initializer=None, head_fcnet_bias_initializer_kwargs=None, free_log_std=False, log_std_clip_param=20.0, vf_share_layers=True, use_lstm=False, max_seq_len=20, lstm_cell_size=256, lstm_use_prev_action=False, lstm_use_prev_reward=False, lstm_kernel_initializer=None, lstm_kernel_initializer_kwargs=None, lstm_bias_initializer=None, lstm_bias_initializer_kwargs=None), catalog_class=None, load_state_path=None, model_config_dict=None)", "algorithm_config_overrides_per_module": {}, "_per_module_overrides": {}, "_validate_config": true, "_use_msgpack_checkpoints": false, "_torch_grad_scaler_class": null, "_torch_lr_scheduler_classes": null, "_tf_policy_handles_more_than_one_loss": false, "_disable_preprocessor_api": false, "_disable_action_flattening": false, "_disable_initialize_loss_from_dummy_batch": false, "_dont_auto_sync_env_runner_states": false, "env_task_fn": -1, "enable_connectors": -1, "simple_optimizer": false, "policy_map_cache": -1, "worker_cls": -1, "synchronize_filters": -1, "enable_async_evaluation": -1, "custom_async_evaluation_function": -1, "_enable_rl_module_api": -1, "auto_wrap_old_gym_envs": -1, "always_attach_evaluation_results": -1, "replay_sequence_length": null, "_disable_execution_plan_api": -1, "use_critic": true, "use_gae": true, "use_kl_loss": true, "kl_coeff": 0.7464963036515, "kl_target": 0.0270990929592, "vf_loss_coeff": 0.6688075857018, "entropy_coeff": 0.0090570820258, "clip_param": 0.1221781641624, "vf_clip_param": 0.1027808522125, "entropy_coeff_schedule": null, "lr_schedule": null, "sgd_minibatch_size": -1, "vf_share_layers": -1, "__stdout_file__": null, "__stderr_file__": null, "lambda": 0.9099046732075, "input": "sampler", "policies": {"default_policy": [null, null, null, null]}, "callbacks": "<class 'ray.rllib.callbacks.callbacks.RLlibCallback'>", "create_env_on_driver": false, "custom_eval_function": null, "framework": "torch"}, "time_since_restore": 41.565635442733765, "iterations_since_restore": 15, "perf": {"cpu_util_percent": 51.400000000000006, "ram_util_percent": 78.32499999999999}}
{"timers": {"training_iteration": 2.736434308626081, "restore_env_runners": 1.1656721569247327e-05, "training_step": 2.7362206585591364, "env_runner_sampling_timer": 2.552748527023159, "learner_update_timer": 0.1788831230892182, "synch_weights": 0.0009872744678368105, "restore_eval_env_runners": 1.6207432926250502e-05, "evaluation_iteration": 0.19374679390180272, "synch_eval_env_connectors": 0.0003048122923170229, "synch_env_connectors": 5.982458586597662e-06}, "env_runners": {"num_env_steps_sampled_lifetime": -8635000.0, "module_to_env_connector": {"timers": {"connectors": {"tensor_to_numpy": 3.0314770154594193e-05, "normalize_and_clip_actions": 1.8043155471185828e-05, "un_batch_to_individual_items": 1.0077212757675112e-05, "listify_data_for_vector_env": 2.2043611467602706e-05, "remove_single_ts_time_rank_from_batch": 1.086655933210594e-06, "get_actions": 0.00010479962514837967}}, "connector_pipeline_timer": 0.00023685929851926184}, "episode_len_min": 20, "episode_return_max": 9.5, "num_episodes": 250.0, "num_agent_steps_sampled": {"default_agent": 5000.0}, "env_to_module_connector": {"timers": {"connectors": {"add_states_from_episodes_to_batch": 2.8975794090693603e-06, "numpy_to_tensor": 2.1071509647424085e-05, "batch_individual_items": 1.2950028780484228e-05, "add_time_dim_to_batch_and_zero_pad": 4.821406132972809e-06, "add_observations_from_episodes_to_batch": 5.821246412931192e-06}}, "connector_pipeline_timer": 8.751633155549369e-05}, "env_step_timer": 3.3554651767678495e-05, "env_reset_timer": 9.320395379290048e-05, "episode_duration_sec_mean": 0.01025837434828282, "episode_return_min": -10.5, "sample": 0.010151628236270076, "episode_len_max": 20, "module_episode_returns_mean": {"default_policy": 6.7799999999999985}, "agent_episode_returns_mean": {"default_agent": 6.7799999999999985}, "weights_seq_no": 15.0, "num_agent_steps_sampled_lifetime": {"default_agent": -8635000.0}, "env_to_module_sum_episodes_length_in": 10.36823839457432, "env_to_module_sum_episodes_length_out": 10.36823839457432, "num_episodes_lifetime": -431750.0, "episode_return_mean": 6.7799999999999985, "time_between_sampling": 0.0030291539524596126, "num_module_steps_sampled": {"default_policy": 5000.0}, "num_module_steps_sampled_lifetime": {"default_policy": -8635000.0}, "rlmodule_inference_timer": 6.708833319756106e-05, "num_env_steps_sampled": 5000.0, "episode_len_mean": 20.0, "num_env_steps_sampled_lifetime_throughput": 2110.458493602311}, "learners": {"__all_modules__": {"num_module_steps_trained_lifetime": 96000, "learner_connector": {"timers": {"connectors": {"add_observations_from_episodes_to_batch": 0.0009914401880622833, "add_states_from_episodes_to_batch": 4.956532676315857e-06, "add_columns_from_episodes_to_train_batch": 0.04140759545556305, "batch_individual_items": 0.03988870780893489, "add_time_dim_to_batch_and_zero_pad": 1.40924228148951e-05, "numpy_to_tensor": 8.016974708637422e-05, "general_advantage_estimation": 0.012160479708204145, "add_one_ts_to_episodes_and_truncate": 0.010798413841374503}}, "connector_pipeline_timer": 0.10552367012257981}, "num_module_steps_trained": 6000, "learner_connector_sum_episodes_length_in": 5000.0, "num_non_trainable_parameters": 0, "num_env_steps_trained": 31500, "num_env_steps_trained_lifetime": 504000, "learner_connector_sum_episodes_length_out": 5250.0, "num_trainable_parameters": 6003, "num_env_steps_trained_lifetime_throughput": 1088733.7668435758, "num_module_steps_trained_throughput": 207872.1648829267, "num_module_steps_trained_lifetime_throughput": 207835.353744316}, "default_policy": {"num_module_steps_trained_lifetime": 96000, "num_trainable_parameters": 6003, "entropy": 0.6034906506538391, "vf_explained_var": -0.022913694381713867, "num_module_steps_trained": 6000, "weights_seq_no": 16.0, "curr_entropy_coeff": 0.0090570820258, "diff_num_grad_updates_vs_sampler_policy": 1.0, "gradients_default_optimizer_global_norm": 0.0359240286052227, "curr_kl_coeff": 1.1390629879315384e-05, "default_optimizer_learning_rate": 0.0002847858517, "vf_loss_unclipped": 27.252580642700195, "total_loss": 0.15125392377376556, "mean_kl_loss": 7.574491610284895e-05, "policy_loss": 0.08797918260097504, "module_train_batch_size_mean": 1000.0, "vf_loss": 0.10278083384037018, "num_module_steps_trained_lifetime_throughput": 207889.545575984}}, "num_training_step_calls_per_iteration": 1, "evaluation": {"env_runners": {"num_module_steps_sampled": {"default_policy": 400}, "num_episodes_lifetime": 320, "rlmodule_inference_timer": 4.5660806826696965e-05, "module_to_env_connector": {"timers": {"connectors": {"remove_single_ts_time_rank_from_batch": 9.278907455916465e-07, "normalize_and_clip_actions": 1.6448620347593118e-05, "listify_data_for_vector_env": 1.9120621088549792e-05, "un_batch_to_individual_items": 8.108891243682488e-06, "get_actions": 6.939368364304734e-05, "tensor_to_numpy": 2.1559583447899126e-05}}, "connector_pipeline_timer": 0.00017386606829115496}, "module_episode_returns_mean": {"default_policy": -1.6}, "agent_episode_returns_mean": {"default_agent": -1.6}, "env_reset_timer": 0.00019095323737056372, "episode_len_max": 20, "num_agent_steps_sampled_lifetime": {"default_agent": 6400}, "episode_return_mean": -1.6, "num_agent_steps_sampled": {"default_agent": 400}, "num_env_steps_sampled": 400, "episode_len_mean": 20.0, "num_env_steps_sampled_lifetime": 80400, "episode_return_max": 11.5, "env_to_module_connector": {"connector_pipeline_timer": 7.632778967516211e-05, "timers": {"connectors": {"numpy_to_tensor": 1.581588924110933e-05, "add_observations_from_episodes_to_batch": 5.038078756221038e-06, "batch_individual_items": 1.21263301303619e-05, "add_states_from_episodes_to_batch": 3.0849267238366737e-06, "add_time_dim_to_batch_and_zero_pad": 4.04473299005382e-06}}}, "episode_len_min": 20, "env_to_module_sum_episodes_length_in": 10.368238394574323, "num_episodes": 20, "sample": 0.18432634861882072, "weights_seq_no": 16.0, "env_to_module_sum_episodes_length_out": 10.368238394574323, "env_step_timer": 2.3772712797679644e-05, "episode_duration_sec_mean": 0.008325877604074777, "episode_return_min": -12.5, "num_module_steps_sampled_lifetime": {"default_policy": 6400}, "time_between_sampling": 2.647410522961394}, "num_healthy_workers": 1, "actor_manager_num_outstanding_async_reqs": 0, "num_remote_worker_restarts": 0}, "num_env_steps_sampled_lifetime": -8635000.0, "fault_tolerance": {"num_healthy_workers": 0, "num_remote_worker_restarts": 0}, "env_runner_group": {"actor_manager_num_outstanding_async_reqs": 0}, "done": false, "training_iteration": 16, "trial_id": "4380e_00000", "date": "2025-08-11_19-34-56", "timestamp": 1754933696, "time_this_iter_s": 3.418745994567871, "time_total_s": 44.984381437301636, "pid": 26823, "hostname": "Mac", "node_ip": "127.0.0.1", "config": {"exploration_config": {}, "extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "placement_strategy": "PACK", "num_gpus": 0, "_fake_gpus": false, "num_cpus_for_main_process": 2, "eager_tracing": true, "eager_max_retraces": 20, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "torch_compile_learner": false, "torch_compile_learner_what_to_compile": "forward_train", "torch_compile_learner_dynamo_backend": "aot_eager", "torch_compile_learner_dynamo_mode": null, "torch_compile_worker": false, "torch_compile_worker_dynamo_backend": "aot_eager", "torch_compile_worker_dynamo_mode": null, "torch_ddp_kwargs": {}, "torch_skip_nan_gradients": false, "env": "Umbrella", "env_config": {}, "observation_space": null, "action_space": null, "clip_rewards": null, "normalize_actions": true, "clip_actions": false, "_is_atari": null, "disable_env_checking": false, "render_env": false, "action_mask_key": "action_mask", "env_runner_cls": null, "num_env_runners": 0, "create_local_env_runner": true, "num_envs_per_env_runner": 1, "gym_env_vectorize_mode": "SYNC", "num_cpus_per_env_runner": 1, "num_gpus_per_env_runner": 0, "custom_resources_per_env_runner": {}, "validate_env_runners_after_construction": true, "episodes_to_numpy": true, "max_requests_in_flight_per_env_runner": 1, "sample_timeout_s": 60.0, "_env_to_module_connector": null, "add_default_connectors_to_env_to_module_pipeline": true, "_module_to_env_connector": null, "add_default_connectors_to_module_to_env_pipeline": true, "merge_env_runner_states": "training_only", "broadcast_env_runner_states": true, "episode_lookback_horizon": 1, "rollout_fragment_length": "auto", "batch_mode": "complete_episodes", "compress_observations": false, "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "enable_tf1_exec_eagerly": false, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "preprocessor_pref": "deepmind", "observation_filter": "NoFilter", "update_worker_filter_stats": true, "use_worker_filter_stats": true, "sampler_perf_stats_ema_coef": null, "_is_online": true, "num_learners": 0, "num_gpus_per_learner": 0, "num_cpus_per_learner": "auto", "num_aggregator_actors_per_learner": 0, "max_requests_in_flight_per_aggregator_actor": 3, "local_gpu_idx": 0, "max_requests_in_flight_per_learner": 3, "gamma": 1, "lr": 0.0002847858517, "grad_clip": 0.5, "grad_clip_by": "global_norm", "_train_batch_size_per_learner": 5000, "train_batch_size": 4000, "num_epochs": 1, "minibatch_size": 1000, "shuffle_batch_per_epoch": true, "model": {"fcnet_hiddens": [256, 256], "fcnet_activation": "tanh", "fcnet_weights_initializer": null, "fcnet_weights_initializer_config": null, "fcnet_bias_initializer": null, "fcnet_bias_initializer_config": null, "conv_filters": null, "conv_activation": "relu", "conv_kernel_initializer": null, "conv_kernel_initializer_config": null, "conv_bias_initializer": null, "conv_bias_initializer_config": null, "conv_transpose_kernel_initializer": null, "conv_transpose_kernel_initializer_config": null, "conv_transpose_bias_initializer": null, "conv_transpose_bias_initializer_config": null, "post_fcnet_hiddens": [], "post_fcnet_activation": "relu", "post_fcnet_weights_initializer": null, "post_fcnet_weights_initializer_config": null, "post_fcnet_bias_initializer": null, "post_fcnet_bias_initializer_config": null, "free_log_std": false, "log_std_clip_param": 20.0, "no_final_linear": false, "vf_share_layers": false, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "lstm_weights_initializer": null, "lstm_weights_initializer_config": null, "lstm_bias_initializer": null, "lstm_bias_initializer_config": null, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "attention_use_n_prev_actions": 0, "attention_use_n_prev_rewards": 0, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": null, "custom_model_config": {}, "custom_action_dist": null, "custom_preprocessor": null, "encoder_latent_dim": null, "always_check_shapes": false, "lstm_use_prev_action_reward": -1, "_use_default_native_models": -1, "_disable_preprocessor_api": false, "_disable_action_flattening": false}, "_learner_connector": null, "add_default_connectors_to_learner_pipeline": true, "learner_config_dict": {}, "optimizer": {}, "_learner_class": null, "callbacks_on_algorithm_init": null, "callbacks_on_env_runners_recreated": null, "callbacks_on_offline_eval_runners_recreated": null, "callbacks_on_checkpoint_loaded": null, "callbacks_on_environment_created": null, "callbacks_on_episode_created": null, "callbacks_on_episode_start": null, "callbacks_on_episode_step": null, "callbacks_on_episode_end": null, "callbacks_on_evaluate_start": null, "callbacks_on_evaluate_end": null, "callbacks_on_evaluate_offline_start": null, "callbacks_on_evaluate_offline_end": null, "callbacks_on_sample_end": null, "callbacks_on_train_result": null, "explore": true, "enable_rl_module_and_learner": true, "enable_env_runner_and_connector_v2": true, "_prior_exploration_config": {"type": "StochasticSampling"}, "count_steps_by": "env_steps", "policy_map_capacity": 100, "policy_mapping_fn": "<function AlgorithmConfig.DEFAULT_POLICY_MAPPING_FN at 0x14cce9b20>", "policies_to_train": null, "policy_states_are_swappable": false, "observation_fn": null, "offline_data_class": null, "input_read_method": "read_parquet", "input_read_method_kwargs": {}, "input_read_schema": {}, "input_read_episodes": false, "input_read_sample_batches": false, "input_read_batch_size": null, "input_filesystem": null, "input_filesystem_kwargs": {}, "input_compress_columns": ["obs", "new_obs"], "input_spaces_jsonable": true, "materialize_data": false, "materialize_mapped_data": true, "map_batches_kwargs": {}, "iter_batches_kwargs": {}, "ignore_final_observation": false, "prelearner_class": null, "prelearner_buffer_class": null, "prelearner_buffer_kwargs": {}, "prelearner_module_synch_period": 10, "dataset_num_iters_per_learner": null, "input_config": {}, "actions_in_input_normalized": false, "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_config": {}, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "output_max_rows_per_file": null, "output_write_remaining_data": false, "output_write_method": "write_parquet", "output_write_method_kwargs": {}, "output_filesystem": null, "output_filesystem_kwargs": {}, "output_write_episodes": true, "offline_sampling": false, "evaluation_interval": 1, "evaluation_duration": 20, "evaluation_duration_unit": "episodes", "evaluation_sample_timeout_s": 120.0, "evaluation_auto_duration_min_env_steps_per_sample": 100, "evaluation_auto_duration_max_env_steps_per_sample": 2000, "evaluation_parallel_to_training": false, "evaluation_force_reset_envs_before_iteration": true, "evaluation_config": null, "off_policy_estimation_methods": {}, "ope_split_batch_by_episode": true, "evaluation_num_env_runners": 1, "in_evaluation": false, "sync_filters_on_rollout_workers_timeout_s": 10.0, "offline_evaluation_interval": null, "num_offline_eval_runners": 0, "offline_loss_for_module_fn": null, "offline_evaluation_duration": 1, "offline_evaluation_parallel_to_training": false, "offline_evaluation_timeout_s": 120.0, "num_cpus_per_offline_eval_runner": 1, "num_gpus_per_offline_eval_runner": 0, "custom_resources_per_offline_eval_runner": {}, "restart_failed_offline_eval_runners": true, "ignore_offline_eval_runner_failures": false, "max_num_offline_eval_runner_restarts": 1000, "offline_eval_runner_restore_timeout_s": 1800.0, "max_requests_in_flight_per_offline_eval_runner": 1, "validate_offline_eval_runners_after_construction": true, "offline_eval_runner_health_probe_timeout_s": 30.0, "offline_eval_rl_module_inference_only": false, "broadcast_offline_eval_runner_states": false, "offline_eval_batch_size_per_runner": 256, "dataset_num_iters_per_eval_runner": 1, "keep_per_episode_custom_metrics": false, "metrics_episode_collection_timeout_s": 60.0, "metrics_num_episodes_for_smoothing": 100, "min_time_s_per_iteration": null, "min_train_timesteps_per_iteration": 0, "min_sample_timesteps_per_iteration": 0, "log_gradients": true, "export_native_model_files": false, "checkpoint_trainable_policies_only": false, "logger_creator": null, "logger_config": null, "log_level": "WARN", "log_sys_usage": true, "fake_sampler": false, "seed": 1, "restart_failed_env_runners": true, "ignore_env_runner_failures": false, "max_num_env_runner_restarts": 1000, "delay_between_env_runner_restarts_s": 60.0, "restart_failed_sub_environments": false, "num_consecutive_env_runner_failures_tolerance": 100, "env_runner_health_probe_timeout_s": 30.0, "env_runner_restore_timeout_s": 1800.0, "_model_config": {}, "_rl_module_spec": "RLModuleSpec(module_class=None, observation_space=None, action_space=None, inference_only=False, learner_only=False, model_config=DefaultModelConfig(fcnet_hiddens=[60, 90], fcnet_activation='tanh', fcnet_kernel_initializer=None, fcnet_kernel_initializer_kwargs=None, fcnet_bias_initializer=None, fcnet_bias_initializer_kwargs=None, conv_filters=None, conv_activation='relu', conv_kernel_initializer=None, conv_kernel_initializer_kwargs=None, conv_bias_initializer=None, conv_bias_initializer_kwargs=None, head_fcnet_hiddens=[], head_fcnet_activation='relu', head_fcnet_kernel_initializer=None, head_fcnet_kernel_initializer_kwargs=None, head_fcnet_bias_initializer=None, head_fcnet_bias_initializer_kwargs=None, free_log_std=False, log_std_clip_param=20.0, vf_share_layers=True, use_lstm=False, max_seq_len=20, lstm_cell_size=256, lstm_use_prev_action=False, lstm_use_prev_reward=False, lstm_kernel_initializer=None, lstm_kernel_initializer_kwargs=None, lstm_bias_initializer=None, lstm_bias_initializer_kwargs=None), catalog_class=None, load_state_path=None, model_config_dict=None)", "algorithm_config_overrides_per_module": {}, "_per_module_overrides": {}, "_validate_config": true, "_use_msgpack_checkpoints": false, "_torch_grad_scaler_class": null, "_torch_lr_scheduler_classes": null, "_tf_policy_handles_more_than_one_loss": false, "_disable_preprocessor_api": false, "_disable_action_flattening": false, "_disable_initialize_loss_from_dummy_batch": false, "_dont_auto_sync_env_runner_states": false, "env_task_fn": -1, "enable_connectors": -1, "simple_optimizer": false, "policy_map_cache": -1, "worker_cls": -1, "synchronize_filters": -1, "enable_async_evaluation": -1, "custom_async_evaluation_function": -1, "_enable_rl_module_api": -1, "auto_wrap_old_gym_envs": -1, "always_attach_evaluation_results": -1, "replay_sequence_length": null, "_disable_execution_plan_api": -1, "use_critic": true, "use_gae": true, "use_kl_loss": true, "kl_coeff": 0.7464963036515, "kl_target": 0.0270990929592, "vf_loss_coeff": 0.6688075857018, "entropy_coeff": 0.0090570820258, "clip_param": 0.1221781641624, "vf_clip_param": 0.1027808522125, "entropy_coeff_schedule": null, "lr_schedule": null, "sgd_minibatch_size": -1, "vf_share_layers": -1, "__stdout_file__": null, "__stderr_file__": null, "lambda": 0.9099046732075, "input": "sampler", "policies": {"default_policy": [null, null, null, null]}, "callbacks": "<class 'ray.rllib.callbacks.callbacks.RLlibCallback'>", "create_env_on_driver": false, "custom_eval_function": null, "framework": "torch"}, "time_since_restore": 44.984381437301636, "iterations_since_restore": 16, "perf": {"cpu_util_percent": 60.5, "ram_util_percent": 78.98}}
{"timers": {"training_iteration": 2.738578465960309, "restore_env_runners": 1.1619324921469698e-05, "training_step": 2.7383632169732737, "env_runner_sampling_timer": 2.55545646633298, "learner_update_timer": 0.1783258564373919, "synch_weights": 0.0009848725530364447, "restore_eval_env_runners": 1.6243698873244202e-05, "evaluation_iteration": 0.1936785872124517, "synch_eval_env_connectors": 0.00030369832963943514, "synch_env_connectors": 5.970543562276342e-06}, "env_runners": {"num_env_steps_sampled_lifetime": -9252500.0, "module_to_env_connector": {"timers": {"connectors": {"tensor_to_numpy": 2.4780402453383106e-05, "normalize_and_clip_actions": 1.598251586128171e-05, "un_batch_to_individual_items": 9.216666631255097e-06, "listify_data_for_vector_env": 1.9366100575710575e-05, "remove_single_ts_time_rank_from_batch": 9.33501545481016e-07, "get_actions": 8.355945302408918e-05}}, "connector_pipeline_timer": 0.00019641997961332677}, "episode_len_min": 20, "episode_return_max": 9.5, "num_episodes": 250.0, "num_agent_steps_sampled": {"default_agent": 5000.0}, "env_to_module_connector": {"timers": {"connectors": {"add_states_from_episodes_to_batch": 2.6621345851018594e-06, "numpy_to_tensor": 1.6914866436296486e-05, "batch_individual_items": 1.1555007422631686e-05, "add_time_dim_to_batch_and_zero_pad": 4.297366159467594e-06, "add_observations_from_episodes_to_batch": 5.2955386662170825e-06}}, "connector_pipeline_timer": 7.453684308947503e-05}, "env_step_timer": 3.5874953961779893e-05, "env_reset_timer": 8.289182968646159e-05, "episode_duration_sec_mean": 0.009513142013922334, "episode_return_min": -10.5, "sample": 0.009644322622042246, "episode_len_max": 20, "module_episode_returns_mean": {"default_policy": 6.62}, "agent_episode_returns_mean": {"default_agent": 6.62}, "weights_seq_no": 16.0, "num_agent_steps_sampled_lifetime": {"default_agent": -9252500.0}, "env_to_module_sum_episodes_length_in": 10.36823839457432, "env_to_module_sum_episodes_length_out": 10.36823839457432, "num_episodes_lifetime": -462625.0, "episode_return_mean": 6.62, "time_between_sampling": 0.002699271161095691, "num_module_steps_sampled": {"default_policy": 5000.0}, "num_module_steps_sampled_lifetime": {"default_policy": -9252500.0}, "rlmodule_inference_timer": 9.20527006477388e-05, "num_env_steps_sampled": 5000.0, "episode_len_mean": 20.0, "num_env_steps_sampled_lifetime_throughput": 2291.3514173663934}, "learners": {"__all_modules__": {"num_module_steps_trained_lifetime": 102000, "learner_connector": {"timers": {"connectors": {"add_observations_from_episodes_to_batch": 0.0010036649466098565, "add_states_from_episodes_to_batch": 4.938216714390702e-06, "add_columns_from_episodes_to_train_batch": 0.041440089921179486, "batch_individual_items": 0.03983102990055559, "add_time_dim_to_batch_and_zero_pad": 1.4056079126956158e-05, "numpy_to_tensor": 8.014180055957354e-05, "general_advantage_estimation": 0.012101177820913573, "add_one_ts_to_episodes_and_truncate": 0.010838522203127724}}, "connector_pipeline_timer": 0.10549102842204013}, "num_module_steps_trained": 6000, "learner_connector_sum_episodes_length_in": 5000.0, "num_non_trainable_parameters": 0, "num_env_steps_trained": 31500, "num_env_steps_trained_lifetime": 535500, "learner_connector_sum_episodes_length_out": 5250.0, "num_trainable_parameters": 6003, "num_env_steps_trained_lifetime_throughput": 1107156.5071299518, "num_module_steps_trained_throughput": 211359.24542294926, "num_module_steps_trained_lifetime_throughput": 211321.97648337483}, "default_policy": {"num_module_steps_trained_lifetime": 102000, "num_trainable_parameters": 6003, "entropy": 0.6019554734230042, "vf_explained_var": -0.023396968841552734, "num_module_steps_trained": 6000, "weights_seq_no": 17.0, "curr_entropy_coeff": 0.0090570820258, "diff_num_grad_updates_vs_sampler_policy": 1.0, "gradients_default_optimizer_global_norm": 0.03156490996479988, "curr_kl_coeff": 5.695314939657692e-06, "default_optimizer_learning_rate": 0.0002847858517, "vf_loss_unclipped": 26.885883331298828, "total_loss": -0.007574191316962242, "mean_kl_loss": 0.0002801602240651846, "policy_loss": -0.07086284458637238, "module_train_batch_size_mean": 1000.0, "vf_loss": 0.10278083384037018, "num_module_steps_trained_lifetime_throughput": 211353.39929878208}}, "num_training_step_calls_per_iteration": 1, "evaluation": {"env_runners": {"num_module_steps_sampled": {"default_policy": 400}, "num_episodes_lifetime": 340, "rlmodule_inference_timer": 9.147475929995822e-05, "module_to_env_connector": {"timers": {"connectors": {"remove_single_ts_time_rank_from_batch": 1.4375637138290278e-06, "normalize_and_clip_actions": 2.2064809306326274e-05, "listify_data_for_vector_env": 3.615947410659964e-05, "un_batch_to_individual_items": 1.3204910919492408e-05, "get_actions": 0.00012437229516695181, "tensor_to_numpy": 3.544225643567487e-05}}, "connector_pipeline_timer": 0.00029840063738111814}, "module_episode_returns_mean": {"default_policy": -1.4}, "agent_episode_returns_mean": {"default_agent": -1.4}, "env_reset_timer": 0.00018985954473637446, "episode_len_max": 20, "num_agent_steps_sampled_lifetime": {"default_agent": 6800}, "episode_return_mean": -1.4, "num_agent_steps_sampled": {"default_agent": 400}, "num_env_steps_sampled": 400, "episode_len_mean": 20.0, "num_env_steps_sampled_lifetime": 85400, "episode_return_max": 12.5, "env_to_module_connector": {"connector_pipeline_timer": 0.00011420891558856972, "timers": {"connectors": {"numpy_to_tensor": 2.877638087012699e-05, "add_observations_from_episodes_to_batch": 6.4092791123214975e-06, "batch_individual_items": 1.87582850853653e-05, "add_states_from_episodes_to_batch": 2.8166138580045875e-06, "add_time_dim_to_batch_and_zero_pad": 7.721959357743685e-06}}}, "episode_len_min": 20, "env_to_module_sum_episodes_length_in": 10.368238394574323, "num_episodes": 20, "sample": 0.18432355596284392, "weights_seq_no": 17.0, "env_to_module_sum_episodes_length_out": 10.368238394574323, "env_step_timer": 4.7756017593290006e-05, "episode_duration_sec_mean": 0.00830513465916738, "episode_return_min": -12.5, "num_module_steps_sampled_lifetime": {"default_policy": 6800}, "time_between_sampling": 2.6507393960720838}, "num_healthy_workers": 1, "actor_manager_num_outstanding_async_reqs": 0, "num_remote_worker_restarts": 0}, "num_env_steps_sampled_lifetime": -9252500.0, "fault_tolerance": {"num_healthy_workers": 0, "num_remote_worker_restarts": 0}, "env_runner_group": {"actor_manager_num_outstanding_async_reqs": 0}, "done": false, "training_iteration": 17, "trial_id": "4380e_00000", "date": "2025-08-11_19-35-00", "timestamp": 1754933700, "time_this_iter_s": 3.14803409576416, "time_total_s": 48.132415533065796, "pid": 26823, "hostname": "Mac", "node_ip": "127.0.0.1", "config": {"exploration_config": {}, "extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "placement_strategy": "PACK", "num_gpus": 0, "_fake_gpus": false, "num_cpus_for_main_process": 2, "eager_tracing": true, "eager_max_retraces": 20, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "torch_compile_learner": false, "torch_compile_learner_what_to_compile": "forward_train", "torch_compile_learner_dynamo_backend": "aot_eager", "torch_compile_learner_dynamo_mode": null, "torch_compile_worker": false, "torch_compile_worker_dynamo_backend": "aot_eager", "torch_compile_worker_dynamo_mode": null, "torch_ddp_kwargs": {}, "torch_skip_nan_gradients": false, "env": "Umbrella", "env_config": {}, "observation_space": null, "action_space": null, "clip_rewards": null, "normalize_actions": true, "clip_actions": false, "_is_atari": null, "disable_env_checking": false, "render_env": false, "action_mask_key": "action_mask", "env_runner_cls": null, "num_env_runners": 0, "create_local_env_runner": true, "num_envs_per_env_runner": 1, "gym_env_vectorize_mode": "SYNC", "num_cpus_per_env_runner": 1, "num_gpus_per_env_runner": 0, "custom_resources_per_env_runner": {}, "validate_env_runners_after_construction": true, "episodes_to_numpy": true, "max_requests_in_flight_per_env_runner": 1, "sample_timeout_s": 60.0, "_env_to_module_connector": null, "add_default_connectors_to_env_to_module_pipeline": true, "_module_to_env_connector": null, "add_default_connectors_to_module_to_env_pipeline": true, "merge_env_runner_states": "training_only", "broadcast_env_runner_states": true, "episode_lookback_horizon": 1, "rollout_fragment_length": "auto", "batch_mode": "complete_episodes", "compress_observations": false, "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "enable_tf1_exec_eagerly": false, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "preprocessor_pref": "deepmind", "observation_filter": "NoFilter", "update_worker_filter_stats": true, "use_worker_filter_stats": true, "sampler_perf_stats_ema_coef": null, "_is_online": true, "num_learners": 0, "num_gpus_per_learner": 0, "num_cpus_per_learner": "auto", "num_aggregator_actors_per_learner": 0, "max_requests_in_flight_per_aggregator_actor": 3, "local_gpu_idx": 0, "max_requests_in_flight_per_learner": 3, "gamma": 1, "lr": 0.0002847858517, "grad_clip": 0.5, "grad_clip_by": "global_norm", "_train_batch_size_per_learner": 5000, "train_batch_size": 4000, "num_epochs": 1, "minibatch_size": 1000, "shuffle_batch_per_epoch": true, "model": {"fcnet_hiddens": [256, 256], "fcnet_activation": "tanh", "fcnet_weights_initializer": null, "fcnet_weights_initializer_config": null, "fcnet_bias_initializer": null, "fcnet_bias_initializer_config": null, "conv_filters": null, "conv_activation": "relu", "conv_kernel_initializer": null, "conv_kernel_initializer_config": null, "conv_bias_initializer": null, "conv_bias_initializer_config": null, "conv_transpose_kernel_initializer": null, "conv_transpose_kernel_initializer_config": null, "conv_transpose_bias_initializer": null, "conv_transpose_bias_initializer_config": null, "post_fcnet_hiddens": [], "post_fcnet_activation": "relu", "post_fcnet_weights_initializer": null, "post_fcnet_weights_initializer_config": null, "post_fcnet_bias_initializer": null, "post_fcnet_bias_initializer_config": null, "free_log_std": false, "log_std_clip_param": 20.0, "no_final_linear": false, "vf_share_layers": false, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "lstm_weights_initializer": null, "lstm_weights_initializer_config": null, "lstm_bias_initializer": null, "lstm_bias_initializer_config": null, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "attention_use_n_prev_actions": 0, "attention_use_n_prev_rewards": 0, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": null, "custom_model_config": {}, "custom_action_dist": null, "custom_preprocessor": null, "encoder_latent_dim": null, "always_check_shapes": false, "lstm_use_prev_action_reward": -1, "_use_default_native_models": -1, "_disable_preprocessor_api": false, "_disable_action_flattening": false}, "_learner_connector": null, "add_default_connectors_to_learner_pipeline": true, "learner_config_dict": {}, "optimizer": {}, "_learner_class": null, "callbacks_on_algorithm_init": null, "callbacks_on_env_runners_recreated": null, "callbacks_on_offline_eval_runners_recreated": null, "callbacks_on_checkpoint_loaded": null, "callbacks_on_environment_created": null, "callbacks_on_episode_created": null, "callbacks_on_episode_start": null, "callbacks_on_episode_step": null, "callbacks_on_episode_end": null, "callbacks_on_evaluate_start": null, "callbacks_on_evaluate_end": null, "callbacks_on_evaluate_offline_start": null, "callbacks_on_evaluate_offline_end": null, "callbacks_on_sample_end": null, "callbacks_on_train_result": null, "explore": true, "enable_rl_module_and_learner": true, "enable_env_runner_and_connector_v2": true, "_prior_exploration_config": {"type": "StochasticSampling"}, "count_steps_by": "env_steps", "policy_map_capacity": 100, "policy_mapping_fn": "<function AlgorithmConfig.DEFAULT_POLICY_MAPPING_FN at 0x14cce9b20>", "policies_to_train": null, "policy_states_are_swappable": false, "observation_fn": null, "offline_data_class": null, "input_read_method": "read_parquet", "input_read_method_kwargs": {}, "input_read_schema": {}, "input_read_episodes": false, "input_read_sample_batches": false, "input_read_batch_size": null, "input_filesystem": null, "input_filesystem_kwargs": {}, "input_compress_columns": ["obs", "new_obs"], "input_spaces_jsonable": true, "materialize_data": false, "materialize_mapped_data": true, "map_batches_kwargs": {}, "iter_batches_kwargs": {}, "ignore_final_observation": false, "prelearner_class": null, "prelearner_buffer_class": null, "prelearner_buffer_kwargs": {}, "prelearner_module_synch_period": 10, "dataset_num_iters_per_learner": null, "input_config": {}, "actions_in_input_normalized": false, "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_config": {}, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "output_max_rows_per_file": null, "output_write_remaining_data": false, "output_write_method": "write_parquet", "output_write_method_kwargs": {}, "output_filesystem": null, "output_filesystem_kwargs": {}, "output_write_episodes": true, "offline_sampling": false, "evaluation_interval": 1, "evaluation_duration": 20, "evaluation_duration_unit": "episodes", "evaluation_sample_timeout_s": 120.0, "evaluation_auto_duration_min_env_steps_per_sample": 100, "evaluation_auto_duration_max_env_steps_per_sample": 2000, "evaluation_parallel_to_training": false, "evaluation_force_reset_envs_before_iteration": true, "evaluation_config": null, "off_policy_estimation_methods": {}, "ope_split_batch_by_episode": true, "evaluation_num_env_runners": 1, "in_evaluation": false, "sync_filters_on_rollout_workers_timeout_s": 10.0, "offline_evaluation_interval": null, "num_offline_eval_runners": 0, "offline_loss_for_module_fn": null, "offline_evaluation_duration": 1, "offline_evaluation_parallel_to_training": false, "offline_evaluation_timeout_s": 120.0, "num_cpus_per_offline_eval_runner": 1, "num_gpus_per_offline_eval_runner": 0, "custom_resources_per_offline_eval_runner": {}, "restart_failed_offline_eval_runners": true, "ignore_offline_eval_runner_failures": false, "max_num_offline_eval_runner_restarts": 1000, "offline_eval_runner_restore_timeout_s": 1800.0, "max_requests_in_flight_per_offline_eval_runner": 1, "validate_offline_eval_runners_after_construction": true, "offline_eval_runner_health_probe_timeout_s": 30.0, "offline_eval_rl_module_inference_only": false, "broadcast_offline_eval_runner_states": false, "offline_eval_batch_size_per_runner": 256, "dataset_num_iters_per_eval_runner": 1, "keep_per_episode_custom_metrics": false, "metrics_episode_collection_timeout_s": 60.0, "metrics_num_episodes_for_smoothing": 100, "min_time_s_per_iteration": null, "min_train_timesteps_per_iteration": 0, "min_sample_timesteps_per_iteration": 0, "log_gradients": true, "export_native_model_files": false, "checkpoint_trainable_policies_only": false, "logger_creator": null, "logger_config": null, "log_level": "WARN", "log_sys_usage": true, "fake_sampler": false, "seed": 1, "restart_failed_env_runners": true, "ignore_env_runner_failures": false, "max_num_env_runner_restarts": 1000, "delay_between_env_runner_restarts_s": 60.0, "restart_failed_sub_environments": false, "num_consecutive_env_runner_failures_tolerance": 100, "env_runner_health_probe_timeout_s": 30.0, "env_runner_restore_timeout_s": 1800.0, "_model_config": {}, "_rl_module_spec": "RLModuleSpec(module_class=None, observation_space=None, action_space=None, inference_only=False, learner_only=False, model_config=DefaultModelConfig(fcnet_hiddens=[60, 90], fcnet_activation='tanh', fcnet_kernel_initializer=None, fcnet_kernel_initializer_kwargs=None, fcnet_bias_initializer=None, fcnet_bias_initializer_kwargs=None, conv_filters=None, conv_activation='relu', conv_kernel_initializer=None, conv_kernel_initializer_kwargs=None, conv_bias_initializer=None, conv_bias_initializer_kwargs=None, head_fcnet_hiddens=[], head_fcnet_activation='relu', head_fcnet_kernel_initializer=None, head_fcnet_kernel_initializer_kwargs=None, head_fcnet_bias_initializer=None, head_fcnet_bias_initializer_kwargs=None, free_log_std=False, log_std_clip_param=20.0, vf_share_layers=True, use_lstm=False, max_seq_len=20, lstm_cell_size=256, lstm_use_prev_action=False, lstm_use_prev_reward=False, lstm_kernel_initializer=None, lstm_kernel_initializer_kwargs=None, lstm_bias_initializer=None, lstm_bias_initializer_kwargs=None), catalog_class=None, load_state_path=None, model_config_dict=None)", "algorithm_config_overrides_per_module": {}, "_per_module_overrides": {}, "_validate_config": true, "_use_msgpack_checkpoints": false, "_torch_grad_scaler_class": null, "_torch_lr_scheduler_classes": null, "_tf_policy_handles_more_than_one_loss": false, "_disable_preprocessor_api": false, "_disable_action_flattening": false, "_disable_initialize_loss_from_dummy_batch": false, "_dont_auto_sync_env_runner_states": false, "env_task_fn": -1, "enable_connectors": -1, "simple_optimizer": false, "policy_map_cache": -1, "worker_cls": -1, "synchronize_filters": -1, "enable_async_evaluation": -1, "custom_async_evaluation_function": -1, "_enable_rl_module_api": -1, "auto_wrap_old_gym_envs": -1, "always_attach_evaluation_results": -1, "replay_sequence_length": null, "_disable_execution_plan_api": -1, "use_critic": true, "use_gae": true, "use_kl_loss": true, "kl_coeff": 0.7464963036515, "kl_target": 0.0270990929592, "vf_loss_coeff": 0.6688075857018, "entropy_coeff": 0.0090570820258, "clip_param": 0.1221781641624, "vf_clip_param": 0.1027808522125, "entropy_coeff_schedule": null, "lr_schedule": null, "sgd_minibatch_size": -1, "vf_share_layers": -1, "__stdout_file__": null, "__stderr_file__": null, "lambda": 0.9099046732075, "input": "sampler", "policies": {"default_policy": [null, null, null, null]}, "callbacks": "<class 'ray.rllib.callbacks.callbacks.RLlibCallback'>", "create_env_on_driver": false, "custom_eval_function": null, "framework": "torch"}, "time_since_restore": 48.132415533065796, "iterations_since_restore": 17, "perf": {"cpu_util_percent": 73.42, "ram_util_percent": 77.82}}
{"timers": {"training_iteration": 2.7458598196415887, "restore_env_runners": 1.1616461988053521e-05, "training_step": 2.74564341438349, "env_runner_sampling_timer": 2.560751097089228, "learner_update_timer": 0.18029552120377576, "synch_weights": 0.0009884375769084691, "restore_eval_env_runners": 1.6154182113797717e-05, "evaluation_iteration": 0.19368730258961075, "synch_eval_env_connectors": 0.00030160425689879094, "synch_env_connectors": 5.957928124332574e-06}, "env_runners": {"num_env_steps_sampled_lifetime": -9870000.0, "module_to_env_connector": {"timers": {"connectors": {"tensor_to_numpy": 2.976472209558044e-05, "normalize_and_clip_actions": 1.805217723294727e-05, "un_batch_to_individual_items": 1.0552195606350128e-05, "listify_data_for_vector_env": 2.210633187946653e-05, "remove_single_ts_time_rank_from_batch": 1.3417339900504565e-06, "get_actions": 0.00010811948650240597}}, "connector_pipeline_timer": 0.0002400832941385403}, "episode_len_min": 20, "episode_return_max": 9.5, "num_episodes": 250.0, "num_agent_steps_sampled": {"default_agent": 5000.0}, "env_to_module_connector": {"timers": {"connectors": {"add_states_from_episodes_to_batch": 2.9179675337071816e-06, "numpy_to_tensor": 2.0553217105463318e-05, "batch_individual_items": 1.5607473238371736e-05, "add_time_dim_to_batch_and_zero_pad": 1.330337334744637e-05, "add_observations_from_episodes_to_batch": 5.863455937164471e-06}}, "connector_pipeline_timer": 0.00010115513181834596}, "env_step_timer": 3.5522219807364486e-05, "env_reset_timer": 8.821428742458219e-05, "episode_duration_sec_mean": 0.010442033821251244, "episode_return_min": -10.5, "sample": 0.011175345015990521, "episode_len_max": 20, "module_episode_returns_mean": {"default_policy": 6.7799999999999985}, "agent_episode_returns_mean": {"default_agent": 6.7799999999999985}, "weights_seq_no": 17.0, "num_agent_steps_sampled_lifetime": {"default_agent": -9870000.0}, "env_to_module_sum_episodes_length_in": 10.36823839457432, "env_to_module_sum_episodes_length_out": 10.36823839457432, "num_episodes_lifetime": -493500.0, "episode_return_mean": 6.7799999999999985, "time_between_sampling": 0.0027107838052235983, "num_module_steps_sampled": {"default_policy": 5000.0}, "num_module_steps_sampled_lifetime": {"default_policy": -9870000.0}, "rlmodule_inference_timer": 6.629618312749803e-05, "num_env_steps_sampled": 5000.0, "episode_len_mean": 20.0, "num_env_steps_sampled_lifetime_throughput": 1993.5618469834976}, "learners": {"__all_modules__": {"num_module_steps_trained_lifetime": 108000, "learner_connector": {"timers": {"connectors": {"add_observations_from_episodes_to_batch": 0.0010038366368069803, "add_states_from_episodes_to_batch": 4.925924468780857e-06, "add_columns_from_episodes_to_train_batch": 0.04154567277180437, "batch_individual_items": 0.04136627127090366, "add_time_dim_to_batch_and_zero_pad": 1.4120097309039506e-05, "numpy_to_tensor": 8.089122323353393e-05, "general_advantage_estimation": 0.012477903963081842, "add_one_ts_to_episodes_and_truncate": 0.010859753231147632}}, "connector_pipeline_timer": 0.1075320239675064}, "num_module_steps_trained": 6000, "learner_connector_sum_episodes_length_in": 5000.0, "num_non_trainable_parameters": 0, "num_env_steps_trained": 31500, "num_env_steps_trained_lifetime": 567000, "learner_connector_sum_episodes_length_out": 5250.0, "num_trainable_parameters": 6003, "num_env_steps_trained_lifetime_throughput": 1112412.1521737806, "num_module_steps_trained_throughput": 212340.37796693516, "num_module_steps_trained_lifetime_throughput": 212302.39429395428}, "default_policy": {"num_module_steps_trained_lifetime": 108000, "num_trainable_parameters": 6003, "entropy": 0.5985884666442871, "vf_explained_var": -0.02406442165374756, "num_module_steps_trained": 6000, "weights_seq_no": 18.0, "curr_entropy_coeff": 0.0090570820258, "diff_num_grad_updates_vs_sampler_policy": 1.0, "gradients_default_optimizer_global_norm": 0.02470725029706955, "curr_kl_coeff": 2.847657469828846e-06, "default_optimizer_learning_rate": 0.0002847858517, "vf_loss_unclipped": 26.647491455078125, "total_loss": -0.08611404895782471, "mean_kl_loss": 0.0001861961354734376, "policy_loss": -0.1494331955909729, "module_train_batch_size_mean": 1000.0, "vf_loss": 0.10278083384037018, "num_module_steps_trained_lifetime_throughput": 212319.9572885439}}, "num_training_step_calls_per_iteration": 1, "evaluation": {"env_runners": {"num_module_steps_sampled": {"default_policy": 400}, "num_episodes_lifetime": 360, "rlmodule_inference_timer": 7.809609324815862e-05, "module_to_env_connector": {"timers": {"connectors": {"remove_single_ts_time_rank_from_batch": 1.7144777049561398e-06, "normalize_and_clip_actions": 2.3053481832255644e-05, "listify_data_for_vector_env": 2.642289342647584e-05, "un_batch_to_individual_items": 1.2439903556725645e-05, "get_actions": 0.00011466789654294215, "tensor_to_numpy": 3.3817787771271526e-05}}, "connector_pipeline_timer": 0.0002695804406413245}, "module_episode_returns_mean": {"default_policy": -0.6}, "agent_episode_returns_mean": {"default_agent": -0.6}, "env_reset_timer": 0.00019210261994074458, "episode_len_max": 20, "num_agent_steps_sampled_lifetime": {"default_agent": 7200}, "episode_return_mean": -0.6, "num_agent_steps_sampled": {"default_agent": 400}, "num_env_steps_sampled": 400, "episode_len_mean": 20.0, "num_env_steps_sampled_lifetime": 90400, "episode_return_max": 12.5, "env_to_module_connector": {"connector_pipeline_timer": 9.338859751210142e-05, "timers": {"connectors": {"numpy_to_tensor": 2.1523397666112422e-05, "add_observations_from_episodes_to_batch": 5.7206711246968565e-06, "batch_individual_items": 1.4370037636646942e-05, "add_states_from_episodes_to_batch": 2.9170924490517758e-06, "add_time_dim_to_batch_and_zero_pad": 5.853647219427065e-06}}}, "episode_len_min": 20, "env_to_module_sum_episodes_length_in": 10.368238394574323, "num_episodes": 20, "sample": 0.1843899820629535, "weights_seq_no": 18.0, "env_to_module_sum_episodes_length_out": 10.368238394574323, "env_step_timer": 3.687266205425023e-05, "episode_duration_sec_mean": 0.008173213369445875, "episode_return_min": -12.5, "num_module_steps_sampled_lifetime": {"default_policy": 7200}, "time_between_sampling": 2.659334573771317}, "num_healthy_workers": 1, "actor_manager_num_outstanding_async_reqs": 0, "num_remote_worker_restarts": 0}, "num_env_steps_sampled_lifetime": -9870000.0, "fault_tolerance": {"num_healthy_workers": 0, "num_remote_worker_restarts": 0}, "env_runner_group": {"actor_manager_num_outstanding_async_reqs": 0}, "done": false, "training_iteration": 18, "trial_id": "4380e_00000", "date": "2025-08-11_19-35-03", "timestamp": 1754933703, "time_this_iter_s": 3.6867218017578125, "time_total_s": 51.81913733482361, "pid": 26823, "hostname": "Mac", "node_ip": "127.0.0.1", "config": {"exploration_config": {}, "extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "placement_strategy": "PACK", "num_gpus": 0, "_fake_gpus": false, "num_cpus_for_main_process": 2, "eager_tracing": true, "eager_max_retraces": 20, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "torch_compile_learner": false, "torch_compile_learner_what_to_compile": "forward_train", "torch_compile_learner_dynamo_backend": "aot_eager", "torch_compile_learner_dynamo_mode": null, "torch_compile_worker": false, "torch_compile_worker_dynamo_backend": "aot_eager", "torch_compile_worker_dynamo_mode": null, "torch_ddp_kwargs": {}, "torch_skip_nan_gradients": false, "env": "Umbrella", "env_config": {}, "observation_space": null, "action_space": null, "clip_rewards": null, "normalize_actions": true, "clip_actions": false, "_is_atari": null, "disable_env_checking": false, "render_env": false, "action_mask_key": "action_mask", "env_runner_cls": null, "num_env_runners": 0, "create_local_env_runner": true, "num_envs_per_env_runner": 1, "gym_env_vectorize_mode": "SYNC", "num_cpus_per_env_runner": 1, "num_gpus_per_env_runner": 0, "custom_resources_per_env_runner": {}, "validate_env_runners_after_construction": true, "episodes_to_numpy": true, "max_requests_in_flight_per_env_runner": 1, "sample_timeout_s": 60.0, "_env_to_module_connector": null, "add_default_connectors_to_env_to_module_pipeline": true, "_module_to_env_connector": null, "add_default_connectors_to_module_to_env_pipeline": true, "merge_env_runner_states": "training_only", "broadcast_env_runner_states": true, "episode_lookback_horizon": 1, "rollout_fragment_length": "auto", "batch_mode": "complete_episodes", "compress_observations": false, "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "enable_tf1_exec_eagerly": false, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "preprocessor_pref": "deepmind", "observation_filter": "NoFilter", "update_worker_filter_stats": true, "use_worker_filter_stats": true, "sampler_perf_stats_ema_coef": null, "_is_online": true, "num_learners": 0, "num_gpus_per_learner": 0, "num_cpus_per_learner": "auto", "num_aggregator_actors_per_learner": 0, "max_requests_in_flight_per_aggregator_actor": 3, "local_gpu_idx": 0, "max_requests_in_flight_per_learner": 3, "gamma": 1, "lr": 0.0002847858517, "grad_clip": 0.5, "grad_clip_by": "global_norm", "_train_batch_size_per_learner": 5000, "train_batch_size": 4000, "num_epochs": 1, "minibatch_size": 1000, "shuffle_batch_per_epoch": true, "model": {"fcnet_hiddens": [256, 256], "fcnet_activation": "tanh", "fcnet_weights_initializer": null, "fcnet_weights_initializer_config": null, "fcnet_bias_initializer": null, "fcnet_bias_initializer_config": null, "conv_filters": null, "conv_activation": "relu", "conv_kernel_initializer": null, "conv_kernel_initializer_config": null, "conv_bias_initializer": null, "conv_bias_initializer_config": null, "conv_transpose_kernel_initializer": null, "conv_transpose_kernel_initializer_config": null, "conv_transpose_bias_initializer": null, "conv_transpose_bias_initializer_config": null, "post_fcnet_hiddens": [], "post_fcnet_activation": "relu", "post_fcnet_weights_initializer": null, "post_fcnet_weights_initializer_config": null, "post_fcnet_bias_initializer": null, "post_fcnet_bias_initializer_config": null, "free_log_std": false, "log_std_clip_param": 20.0, "no_final_linear": false, "vf_share_layers": false, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "lstm_weights_initializer": null, "lstm_weights_initializer_config": null, "lstm_bias_initializer": null, "lstm_bias_initializer_config": null, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "attention_use_n_prev_actions": 0, "attention_use_n_prev_rewards": 0, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": null, "custom_model_config": {}, "custom_action_dist": null, "custom_preprocessor": null, "encoder_latent_dim": null, "always_check_shapes": false, "lstm_use_prev_action_reward": -1, "_use_default_native_models": -1, "_disable_preprocessor_api": false, "_disable_action_flattening": false}, "_learner_connector": null, "add_default_connectors_to_learner_pipeline": true, "learner_config_dict": {}, "optimizer": {}, "_learner_class": null, "callbacks_on_algorithm_init": null, "callbacks_on_env_runners_recreated": null, "callbacks_on_offline_eval_runners_recreated": null, "callbacks_on_checkpoint_loaded": null, "callbacks_on_environment_created": null, "callbacks_on_episode_created": null, "callbacks_on_episode_start": null, "callbacks_on_episode_step": null, "callbacks_on_episode_end": null, "callbacks_on_evaluate_start": null, "callbacks_on_evaluate_end": null, "callbacks_on_evaluate_offline_start": null, "callbacks_on_evaluate_offline_end": null, "callbacks_on_sample_end": null, "callbacks_on_train_result": null, "explore": true, "enable_rl_module_and_learner": true, "enable_env_runner_and_connector_v2": true, "_prior_exploration_config": {"type": "StochasticSampling"}, "count_steps_by": "env_steps", "policy_map_capacity": 100, "policy_mapping_fn": "<function AlgorithmConfig.DEFAULT_POLICY_MAPPING_FN at 0x14cce9b20>", "policies_to_train": null, "policy_states_are_swappable": false, "observation_fn": null, "offline_data_class": null, "input_read_method": "read_parquet", "input_read_method_kwargs": {}, "input_read_schema": {}, "input_read_episodes": false, "input_read_sample_batches": false, "input_read_batch_size": null, "input_filesystem": null, "input_filesystem_kwargs": {}, "input_compress_columns": ["obs", "new_obs"], "input_spaces_jsonable": true, "materialize_data": false, "materialize_mapped_data": true, "map_batches_kwargs": {}, "iter_batches_kwargs": {}, "ignore_final_observation": false, "prelearner_class": null, "prelearner_buffer_class": null, "prelearner_buffer_kwargs": {}, "prelearner_module_synch_period": 10, "dataset_num_iters_per_learner": null, "input_config": {}, "actions_in_input_normalized": false, "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_config": {}, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "output_max_rows_per_file": null, "output_write_remaining_data": false, "output_write_method": "write_parquet", "output_write_method_kwargs": {}, "output_filesystem": null, "output_filesystem_kwargs": {}, "output_write_episodes": true, "offline_sampling": false, "evaluation_interval": 1, "evaluation_duration": 20, "evaluation_duration_unit": "episodes", "evaluation_sample_timeout_s": 120.0, "evaluation_auto_duration_min_env_steps_per_sample": 100, "evaluation_auto_duration_max_env_steps_per_sample": 2000, "evaluation_parallel_to_training": false, "evaluation_force_reset_envs_before_iteration": true, "evaluation_config": null, "off_policy_estimation_methods": {}, "ope_split_batch_by_episode": true, "evaluation_num_env_runners": 1, "in_evaluation": false, "sync_filters_on_rollout_workers_timeout_s": 10.0, "offline_evaluation_interval": null, "num_offline_eval_runners": 0, "offline_loss_for_module_fn": null, "offline_evaluation_duration": 1, "offline_evaluation_parallel_to_training": false, "offline_evaluation_timeout_s": 120.0, "num_cpus_per_offline_eval_runner": 1, "num_gpus_per_offline_eval_runner": 0, "custom_resources_per_offline_eval_runner": {}, "restart_failed_offline_eval_runners": true, "ignore_offline_eval_runner_failures": false, "max_num_offline_eval_runner_restarts": 1000, "offline_eval_runner_restore_timeout_s": 1800.0, "max_requests_in_flight_per_offline_eval_runner": 1, "validate_offline_eval_runners_after_construction": true, "offline_eval_runner_health_probe_timeout_s": 30.0, "offline_eval_rl_module_inference_only": false, "broadcast_offline_eval_runner_states": false, "offline_eval_batch_size_per_runner": 256, "dataset_num_iters_per_eval_runner": 1, "keep_per_episode_custom_metrics": false, "metrics_episode_collection_timeout_s": 60.0, "metrics_num_episodes_for_smoothing": 100, "min_time_s_per_iteration": null, "min_train_timesteps_per_iteration": 0, "min_sample_timesteps_per_iteration": 0, "log_gradients": true, "export_native_model_files": false, "checkpoint_trainable_policies_only": false, "logger_creator": null, "logger_config": null, "log_level": "WARN", "log_sys_usage": true, "fake_sampler": false, "seed": 1, "restart_failed_env_runners": true, "ignore_env_runner_failures": false, "max_num_env_runner_restarts": 1000, "delay_between_env_runner_restarts_s": 60.0, "restart_failed_sub_environments": false, "num_consecutive_env_runner_failures_tolerance": 100, "env_runner_health_probe_timeout_s": 30.0, "env_runner_restore_timeout_s": 1800.0, "_model_config": {}, "_rl_module_spec": "RLModuleSpec(module_class=None, observation_space=None, action_space=None, inference_only=False, learner_only=False, model_config=DefaultModelConfig(fcnet_hiddens=[60, 90], fcnet_activation='tanh', fcnet_kernel_initializer=None, fcnet_kernel_initializer_kwargs=None, fcnet_bias_initializer=None, fcnet_bias_initializer_kwargs=None, conv_filters=None, conv_activation='relu', conv_kernel_initializer=None, conv_kernel_initializer_kwargs=None, conv_bias_initializer=None, conv_bias_initializer_kwargs=None, head_fcnet_hiddens=[], head_fcnet_activation='relu', head_fcnet_kernel_initializer=None, head_fcnet_kernel_initializer_kwargs=None, head_fcnet_bias_initializer=None, head_fcnet_bias_initializer_kwargs=None, free_log_std=False, log_std_clip_param=20.0, vf_share_layers=True, use_lstm=False, max_seq_len=20, lstm_cell_size=256, lstm_use_prev_action=False, lstm_use_prev_reward=False, lstm_kernel_initializer=None, lstm_kernel_initializer_kwargs=None, lstm_bias_initializer=None, lstm_bias_initializer_kwargs=None), catalog_class=None, load_state_path=None, model_config_dict=None)", "algorithm_config_overrides_per_module": {}, "_per_module_overrides": {}, "_validate_config": true, "_use_msgpack_checkpoints": false, "_torch_grad_scaler_class": null, "_torch_lr_scheduler_classes": null, "_tf_policy_handles_more_than_one_loss": false, "_disable_preprocessor_api": false, "_disable_action_flattening": false, "_disable_initialize_loss_from_dummy_batch": false, "_dont_auto_sync_env_runner_states": false, "env_task_fn": -1, "enable_connectors": -1, "simple_optimizer": false, "policy_map_cache": -1, "worker_cls": -1, "synchronize_filters": -1, "enable_async_evaluation": -1, "custom_async_evaluation_function": -1, "_enable_rl_module_api": -1, "auto_wrap_old_gym_envs": -1, "always_attach_evaluation_results": -1, "replay_sequence_length": null, "_disable_execution_plan_api": -1, "use_critic": true, "use_gae": true, "use_kl_loss": true, "kl_coeff": 0.7464963036515, "kl_target": 0.0270990929592, "vf_loss_coeff": 0.6688075857018, "entropy_coeff": 0.0090570820258, "clip_param": 0.1221781641624, "vf_clip_param": 0.1027808522125, "entropy_coeff_schedule": null, "lr_schedule": null, "sgd_minibatch_size": -1, "vf_share_layers": -1, "__stdout_file__": null, "__stderr_file__": null, "lambda": 0.9099046732075, "input": "sampler", "policies": {"default_policy": [null, null, null, null]}, "callbacks": "<class 'ray.rllib.callbacks.callbacks.RLlibCallback'>", "create_env_on_driver": false, "custom_eval_function": null, "framework": "torch"}, "time_since_restore": 51.81913733482361, "iterations_since_restore": 18, "perf": {"cpu_util_percent": 77.5, "ram_util_percent": 79.52000000000001}}
{"timers": {"training_iteration": 2.7472495664443057, "restore_env_runners": 1.1654467343021613e-05, "training_step": 2.747031356909386, "env_runner_sampling_timer": 2.5610615890292476, "learner_update_timer": 0.18137382515092298, "synch_weights": 0.0009865698710292965, "restore_eval_env_runners": 1.6097220832869747e-05, "evaluation_iteration": 0.19392373123325082, "synch_eval_env_connectors": 0.00030016571411805757, "synch_env_connectors": 5.954188616356757e-06}, "env_runners": {"num_env_steps_sampled_lifetime": -10487500.0, "module_to_env_connector": {"timers": {"connectors": {"tensor_to_numpy": 2.625278764246049e-05, "normalize_and_clip_actions": 1.6251662641661022e-05, "un_batch_to_individual_items": 9.539115350272572e-06, "listify_data_for_vector_env": 2.0360518915369602e-05, "remove_single_ts_time_rank_from_batch": 1.0154961720165128e-06, "get_actions": 8.670566671880006e-05}}, "connector_pipeline_timer": 0.0002038194415540732}, "episode_len_min": 20, "episode_return_max": 9.5, "num_episodes": 250.0, "num_agent_steps_sampled": {"default_agent": 5000.0}, "env_to_module_connector": {"timers": {"connectors": {"add_states_from_episodes_to_batch": 2.8307394004340528e-06, "numpy_to_tensor": 1.898762153659254e-05, "batch_individual_items": 1.2264748471932246e-05, "add_time_dim_to_batch_and_zero_pad": 4.081173699124086e-06, "add_observations_from_episodes_to_batch": 5.440311311177408e-06}}, "connector_pipeline_timer": 7.920315635780139e-05}, "env_step_timer": 2.7762284640789213e-05, "env_reset_timer": 8.425597286542391e-05, "episode_duration_sec_mean": 0.008692626531235873, "episode_return_min": -10.5, "sample": 0.009931453588437833, "episode_len_max": 20, "module_episode_returns_mean": {"default_policy": 7.1}, "agent_episode_returns_mean": {"default_agent": 7.1}, "weights_seq_no": 18.0, "num_agent_steps_sampled_lifetime": {"default_agent": -10487500.0}, "env_to_module_sum_episodes_length_in": 10.36823839457432, "env_to_module_sum_episodes_length_out": 10.36823839457432, "num_episodes_lifetime": -524375.0, "episode_return_mean": 7.1, "time_between_sampling": 0.003690874767622244, "num_module_steps_sampled": {"default_policy": 5000.0}, "num_module_steps_sampled_lifetime": {"default_policy": -10487500.0}, "rlmodule_inference_timer": 5.8464150030098453e-05, "num_env_steps_sampled": 5000.0, "episode_len_mean": 20.0, "num_env_steps_sampled_lifetime_throughput": 2202.8965715149707}, "learners": {"__all_modules__": {"num_module_steps_trained_lifetime": 114000, "learner_connector": {"timers": {"connectors": {"add_observations_from_episodes_to_batch": 0.0010120832699715356, "add_states_from_episodes_to_batch": 4.9112452312885205e-06, "add_columns_from_episodes_to_train_batch": 0.041764561043066264, "batch_individual_items": 0.04276160480881473, "add_time_dim_to_batch_and_zero_pad": 1.4110565557395028e-05, "numpy_to_tensor": 8.12469007769248e-05, "general_advantage_estimation": 0.01242293575304203, "add_one_ts_to_episodes_and_truncate": 0.010876319039544396}}, "connector_pipeline_timer": 0.10911817372799779}, "num_module_steps_trained": 6000, "learner_connector_sum_episodes_length_in": 5000.0, "num_non_trainable_parameters": 0, "num_env_steps_trained": 31500, "num_env_steps_trained_lifetime": 598500, "learner_connector_sum_episodes_length_out": 5250.0, "num_trainable_parameters": 6003, "num_env_steps_trained_lifetime_throughput": 1118863.1374381583, "num_module_steps_trained_throughput": 213551.24665328654, "num_module_steps_trained_lifetime_throughput": 213512.12985006627}, "default_policy": {"num_module_steps_trained_lifetime": 114000, "num_trainable_parameters": 6003, "entropy": 0.577710747718811, "vf_explained_var": -0.024727582931518555, "num_module_steps_trained": 6000, "weights_seq_no": 19.0, "curr_entropy_coeff": 0.0090570820258, "diff_num_grad_updates_vs_sampler_policy": 1.0, "gradients_default_optimizer_global_norm": 0.021649973466992378, "curr_kl_coeff": 1.423828734914423e-06, "default_optimizer_learning_rate": 0.0002847858517, "vf_loss_unclipped": 26.865428924560547, "total_loss": 0.04370664060115814, "mean_kl_loss": 0.00044902059016749263, "policy_loss": -0.019801601767539978, "module_train_batch_size_mean": 1000.0, "vf_loss": 0.10278083384037018, "num_module_steps_trained_lifetime_throughput": 213518.84436766536}}, "num_training_step_calls_per_iteration": 1, "evaluation": {"env_runners": {"num_module_steps_sampled": {"default_policy": 400}, "num_episodes_lifetime": 380, "rlmodule_inference_timer": 7.564016948484847e-05, "module_to_env_connector": {"timers": {"connectors": {"remove_single_ts_time_rank_from_batch": 1.434060378380941e-06, "normalize_and_clip_actions": 2.0177460114291624e-05, "listify_data_for_vector_env": 2.2512835636133922e-05, "un_batch_to_individual_items": 1.2996605812480676e-05, "get_actions": 0.00011345076917248454, "tensor_to_numpy": 3.194736284795884e-05}}, "connector_pipeline_timer": 0.0002568506442880401}, "module_episode_returns_mean": {"default_policy": -0.8}, "agent_episode_returns_mean": {"default_agent": -0.8}, "env_reset_timer": 0.00019108201386877367, "episode_len_max": 20, "num_agent_steps_sampled_lifetime": {"default_agent": 7600}, "episode_return_mean": -0.8, "num_agent_steps_sampled": {"default_agent": 400}, "num_env_steps_sampled": 400, "episode_len_mean": 20.0, "num_env_steps_sampled_lifetime": 95400, "episode_return_max": 12.5, "env_to_module_connector": {"connector_pipeline_timer": 9.933494915518028e-05, "timers": {"connectors": {"numpy_to_tensor": 2.2008461414632905e-05, "add_observations_from_episodes_to_batch": 6.810077634442602e-06, "batch_individual_items": 1.5914506785593275e-05, "add_states_from_episodes_to_batch": 3.7344660036722553e-06, "add_time_dim_to_batch_and_zero_pad": 5.327078012810492e-06}}}, "episode_len_min": 20, "env_to_module_sum_episodes_length_in": 10.368238394574323, "num_episodes": 20, "sample": 0.18432633974210075, "weights_seq_no": 19.0, "env_to_module_sum_episodes_length_out": 10.368238394574323, "env_step_timer": 3.691304564996691e-05, "episode_duration_sec_mean": 0.008350837908219546, "episode_return_min": -12.5, "num_module_steps_sampled_lifetime": {"default_policy": 7600}, "time_between_sampling": 2.6623277405335584}, "num_healthy_workers": 1, "actor_manager_num_outstanding_async_reqs": 0, "num_remote_worker_restarts": 0}, "num_env_steps_sampled_lifetime": -10487500.0, "fault_tolerance": {"num_healthy_workers": 0, "num_remote_worker_restarts": 0}, "env_runner_group": {"actor_manager_num_outstanding_async_reqs": 0}, "done": false, "training_iteration": 19, "trial_id": "4380e_00000", "date": "2025-08-11_19-35-06", "timestamp": 1754933706, "time_this_iter_s": 3.073129892349243, "time_total_s": 54.89226722717285, "pid": 26823, "hostname": "Mac", "node_ip": "127.0.0.1", "config": {"exploration_config": {}, "extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "placement_strategy": "PACK", "num_gpus": 0, "_fake_gpus": false, "num_cpus_for_main_process": 2, "eager_tracing": true, "eager_max_retraces": 20, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "torch_compile_learner": false, "torch_compile_learner_what_to_compile": "forward_train", "torch_compile_learner_dynamo_backend": "aot_eager", "torch_compile_learner_dynamo_mode": null, "torch_compile_worker": false, "torch_compile_worker_dynamo_backend": "aot_eager", "torch_compile_worker_dynamo_mode": null, "torch_ddp_kwargs": {}, "torch_skip_nan_gradients": false, "env": "Umbrella", "env_config": {}, "observation_space": null, "action_space": null, "clip_rewards": null, "normalize_actions": true, "clip_actions": false, "_is_atari": null, "disable_env_checking": false, "render_env": false, "action_mask_key": "action_mask", "env_runner_cls": null, "num_env_runners": 0, "create_local_env_runner": true, "num_envs_per_env_runner": 1, "gym_env_vectorize_mode": "SYNC", "num_cpus_per_env_runner": 1, "num_gpus_per_env_runner": 0, "custom_resources_per_env_runner": {}, "validate_env_runners_after_construction": true, "episodes_to_numpy": true, "max_requests_in_flight_per_env_runner": 1, "sample_timeout_s": 60.0, "_env_to_module_connector": null, "add_default_connectors_to_env_to_module_pipeline": true, "_module_to_env_connector": null, "add_default_connectors_to_module_to_env_pipeline": true, "merge_env_runner_states": "training_only", "broadcast_env_runner_states": true, "episode_lookback_horizon": 1, "rollout_fragment_length": "auto", "batch_mode": "complete_episodes", "compress_observations": false, "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "enable_tf1_exec_eagerly": false, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "preprocessor_pref": "deepmind", "observation_filter": "NoFilter", "update_worker_filter_stats": true, "use_worker_filter_stats": true, "sampler_perf_stats_ema_coef": null, "_is_online": true, "num_learners": 0, "num_gpus_per_learner": 0, "num_cpus_per_learner": "auto", "num_aggregator_actors_per_learner": 0, "max_requests_in_flight_per_aggregator_actor": 3, "local_gpu_idx": 0, "max_requests_in_flight_per_learner": 3, "gamma": 1, "lr": 0.0002847858517, "grad_clip": 0.5, "grad_clip_by": "global_norm", "_train_batch_size_per_learner": 5000, "train_batch_size": 4000, "num_epochs": 1, "minibatch_size": 1000, "shuffle_batch_per_epoch": true, "model": {"fcnet_hiddens": [256, 256], "fcnet_activation": "tanh", "fcnet_weights_initializer": null, "fcnet_weights_initializer_config": null, "fcnet_bias_initializer": null, "fcnet_bias_initializer_config": null, "conv_filters": null, "conv_activation": "relu", "conv_kernel_initializer": null, "conv_kernel_initializer_config": null, "conv_bias_initializer": null, "conv_bias_initializer_config": null, "conv_transpose_kernel_initializer": null, "conv_transpose_kernel_initializer_config": null, "conv_transpose_bias_initializer": null, "conv_transpose_bias_initializer_config": null, "post_fcnet_hiddens": [], "post_fcnet_activation": "relu", "post_fcnet_weights_initializer": null, "post_fcnet_weights_initializer_config": null, "post_fcnet_bias_initializer": null, "post_fcnet_bias_initializer_config": null, "free_log_std": false, "log_std_clip_param": 20.0, "no_final_linear": false, "vf_share_layers": false, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "lstm_weights_initializer": null, "lstm_weights_initializer_config": null, "lstm_bias_initializer": null, "lstm_bias_initializer_config": null, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "attention_use_n_prev_actions": 0, "attention_use_n_prev_rewards": 0, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": null, "custom_model_config": {}, "custom_action_dist": null, "custom_preprocessor": null, "encoder_latent_dim": null, "always_check_shapes": false, "lstm_use_prev_action_reward": -1, "_use_default_native_models": -1, "_disable_preprocessor_api": false, "_disable_action_flattening": false}, "_learner_connector": null, "add_default_connectors_to_learner_pipeline": true, "learner_config_dict": {}, "optimizer": {}, "_learner_class": null, "callbacks_on_algorithm_init": null, "callbacks_on_env_runners_recreated": null, "callbacks_on_offline_eval_runners_recreated": null, "callbacks_on_checkpoint_loaded": null, "callbacks_on_environment_created": null, "callbacks_on_episode_created": null, "callbacks_on_episode_start": null, "callbacks_on_episode_step": null, "callbacks_on_episode_end": null, "callbacks_on_evaluate_start": null, "callbacks_on_evaluate_end": null, "callbacks_on_evaluate_offline_start": null, "callbacks_on_evaluate_offline_end": null, "callbacks_on_sample_end": null, "callbacks_on_train_result": null, "explore": true, "enable_rl_module_and_learner": true, "enable_env_runner_and_connector_v2": true, "_prior_exploration_config": {"type": "StochasticSampling"}, "count_steps_by": "env_steps", "policy_map_capacity": 100, "policy_mapping_fn": "<function AlgorithmConfig.DEFAULT_POLICY_MAPPING_FN at 0x14cce9b20>", "policies_to_train": null, "policy_states_are_swappable": false, "observation_fn": null, "offline_data_class": null, "input_read_method": "read_parquet", "input_read_method_kwargs": {}, "input_read_schema": {}, "input_read_episodes": false, "input_read_sample_batches": false, "input_read_batch_size": null, "input_filesystem": null, "input_filesystem_kwargs": {}, "input_compress_columns": ["obs", "new_obs"], "input_spaces_jsonable": true, "materialize_data": false, "materialize_mapped_data": true, "map_batches_kwargs": {}, "iter_batches_kwargs": {}, "ignore_final_observation": false, "prelearner_class": null, "prelearner_buffer_class": null, "prelearner_buffer_kwargs": {}, "prelearner_module_synch_period": 10, "dataset_num_iters_per_learner": null, "input_config": {}, "actions_in_input_normalized": false, "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_config": {}, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "output_max_rows_per_file": null, "output_write_remaining_data": false, "output_write_method": "write_parquet", "output_write_method_kwargs": {}, "output_filesystem": null, "output_filesystem_kwargs": {}, "output_write_episodes": true, "offline_sampling": false, "evaluation_interval": 1, "evaluation_duration": 20, "evaluation_duration_unit": "episodes", "evaluation_sample_timeout_s": 120.0, "evaluation_auto_duration_min_env_steps_per_sample": 100, "evaluation_auto_duration_max_env_steps_per_sample": 2000, "evaluation_parallel_to_training": false, "evaluation_force_reset_envs_before_iteration": true, "evaluation_config": null, "off_policy_estimation_methods": {}, "ope_split_batch_by_episode": true, "evaluation_num_env_runners": 1, "in_evaluation": false, "sync_filters_on_rollout_workers_timeout_s": 10.0, "offline_evaluation_interval": null, "num_offline_eval_runners": 0, "offline_loss_for_module_fn": null, "offline_evaluation_duration": 1, "offline_evaluation_parallel_to_training": false, "offline_evaluation_timeout_s": 120.0, "num_cpus_per_offline_eval_runner": 1, "num_gpus_per_offline_eval_runner": 0, "custom_resources_per_offline_eval_runner": {}, "restart_failed_offline_eval_runners": true, "ignore_offline_eval_runner_failures": false, "max_num_offline_eval_runner_restarts": 1000, "offline_eval_runner_restore_timeout_s": 1800.0, "max_requests_in_flight_per_offline_eval_runner": 1, "validate_offline_eval_runners_after_construction": true, "offline_eval_runner_health_probe_timeout_s": 30.0, "offline_eval_rl_module_inference_only": false, "broadcast_offline_eval_runner_states": false, "offline_eval_batch_size_per_runner": 256, "dataset_num_iters_per_eval_runner": 1, "keep_per_episode_custom_metrics": false, "metrics_episode_collection_timeout_s": 60.0, "metrics_num_episodes_for_smoothing": 100, "min_time_s_per_iteration": null, "min_train_timesteps_per_iteration": 0, "min_sample_timesteps_per_iteration": 0, "log_gradients": true, "export_native_model_files": false, "checkpoint_trainable_policies_only": false, "logger_creator": null, "logger_config": null, "log_level": "WARN", "log_sys_usage": true, "fake_sampler": false, "seed": 1, "restart_failed_env_runners": true, "ignore_env_runner_failures": false, "max_num_env_runner_restarts": 1000, "delay_between_env_runner_restarts_s": 60.0, "restart_failed_sub_environments": false, "num_consecutive_env_runner_failures_tolerance": 100, "env_runner_health_probe_timeout_s": 30.0, "env_runner_restore_timeout_s": 1800.0, "_model_config": {}, "_rl_module_spec": "RLModuleSpec(module_class=None, observation_space=None, action_space=None, inference_only=False, learner_only=False, model_config=DefaultModelConfig(fcnet_hiddens=[60, 90], fcnet_activation='tanh', fcnet_kernel_initializer=None, fcnet_kernel_initializer_kwargs=None, fcnet_bias_initializer=None, fcnet_bias_initializer_kwargs=None, conv_filters=None, conv_activation='relu', conv_kernel_initializer=None, conv_kernel_initializer_kwargs=None, conv_bias_initializer=None, conv_bias_initializer_kwargs=None, head_fcnet_hiddens=[], head_fcnet_activation='relu', head_fcnet_kernel_initializer=None, head_fcnet_kernel_initializer_kwargs=None, head_fcnet_bias_initializer=None, head_fcnet_bias_initializer_kwargs=None, free_log_std=False, log_std_clip_param=20.0, vf_share_layers=True, use_lstm=False, max_seq_len=20, lstm_cell_size=256, lstm_use_prev_action=False, lstm_use_prev_reward=False, lstm_kernel_initializer=None, lstm_kernel_initializer_kwargs=None, lstm_bias_initializer=None, lstm_bias_initializer_kwargs=None), catalog_class=None, load_state_path=None, model_config_dict=None)", "algorithm_config_overrides_per_module": {}, "_per_module_overrides": {}, "_validate_config": true, "_use_msgpack_checkpoints": false, "_torch_grad_scaler_class": null, "_torch_lr_scheduler_classes": null, "_tf_policy_handles_more_than_one_loss": false, "_disable_preprocessor_api": false, "_disable_action_flattening": false, "_disable_initialize_loss_from_dummy_batch": false, "_dont_auto_sync_env_runner_states": false, "env_task_fn": -1, "enable_connectors": -1, "simple_optimizer": false, "policy_map_cache": -1, "worker_cls": -1, "synchronize_filters": -1, "enable_async_evaluation": -1, "custom_async_evaluation_function": -1, "_enable_rl_module_api": -1, "auto_wrap_old_gym_envs": -1, "always_attach_evaluation_results": -1, "replay_sequence_length": null, "_disable_execution_plan_api": -1, "use_critic": true, "use_gae": true, "use_kl_loss": true, "kl_coeff": 0.7464963036515, "kl_target": 0.0270990929592, "vf_loss_coeff": 0.6688075857018, "entropy_coeff": 0.0090570820258, "clip_param": 0.1221781641624, "vf_clip_param": 0.1027808522125, "entropy_coeff_schedule": null, "lr_schedule": null, "sgd_minibatch_size": -1, "vf_share_layers": -1, "__stdout_file__": null, "__stderr_file__": null, "lambda": 0.9099046732075, "input": "sampler", "policies": {"default_policy": [null, null, null, null]}, "callbacks": "<class 'ray.rllib.callbacks.callbacks.RLlibCallback'>", "create_env_on_driver": false, "custom_eval_function": null, "framework": "torch"}, "time_since_restore": 54.89226722717285, "iterations_since_restore": 19, "perf": {"cpu_util_percent": 72.67500000000001, "ram_util_percent": 78.85}}
{"timers": {"training_iteration": 2.747720803689488, "restore_env_runners": 1.1597093085216373e-05, "training_step": 2.747500919179803, "env_runner_sampling_timer": 2.5618363993890085, "learner_update_timer": 0.181055601899256, "synch_weights": 0.0009928883328048674, "restore_eval_env_runners": 1.6023328449420818e-05, "evaluation_iteration": 0.19384127601037152, "synch_eval_env_connectors": 0.00029841238778605296, "synch_env_connectors": 5.937566731044343e-06}, "env_runners": {"num_env_steps_sampled_lifetime": -11105000.0, "module_to_env_connector": {"timers": {"connectors": {"tensor_to_numpy": 2.7612033852026186e-05, "normalize_and_clip_actions": 1.652953582229941e-05, "un_batch_to_individual_items": 9.210374750474025e-06, "listify_data_for_vector_env": 2.295549016138651e-05, "remove_single_ts_time_rank_from_batch": 9.781793436466183e-07, "get_actions": 8.688293280624726e-05}}, "connector_pipeline_timer": 0.00020788578934540042}, "episode_len_min": 20, "episode_return_max": 9.5, "num_episodes": 250.0, "num_agent_steps_sampled": {"default_agent": 5000.0}, "env_to_module_connector": {"timers": {"connectors": {"add_states_from_episodes_to_batch": 2.60083039404394e-06, "numpy_to_tensor": 1.7518277594256193e-05, "batch_individual_items": 1.8105165980632132e-05, "add_time_dim_to_batch_and_zero_pad": 4.336493833859157e-06, "add_observations_from_episodes_to_batch": 5.005666295624672e-06}}, "connector_pipeline_timer": 8.163652161767725e-05}, "env_step_timer": 2.698096158176181e-05, "env_reset_timer": 8.371088699851925e-05, "episode_duration_sec_mean": 0.008893171492964029, "episode_return_min": -10.5, "sample": 0.009379471593398516, "episode_len_max": 20, "module_episode_returns_mean": {"default_policy": 6.940000000000001}, "agent_episode_returns_mean": {"default_agent": 6.940000000000001}, "weights_seq_no": 19.0, "num_agent_steps_sampled_lifetime": {"default_agent": -11105000.0}, "env_to_module_sum_episodes_length_in": 10.36823839457432, "env_to_module_sum_episodes_length_out": 10.36823839457432, "num_episodes_lifetime": -555250.0, "episode_return_mean": 6.940000000000001, "time_between_sampling": 0.003083007525435206, "num_module_steps_sampled": {"default_policy": 5000.0}, "num_module_steps_sampled_lifetime": {"default_policy": -11105000.0}, "rlmodule_inference_timer": 5.7709111249760265e-05, "num_env_steps_sampled": 5000.0, "episode_len_mean": 20.0, "num_env_steps_sampled_lifetime_throughput": 2264.6802927973827}, "learners": {"__all_modules__": {"num_module_steps_trained_lifetime": 120000, "learner_connector": {"timers": {"connectors": {"add_observations_from_episodes_to_batch": 0.001012859106972562, "add_states_from_episodes_to_batch": 4.89463244437006e-06, "add_columns_from_episodes_to_train_batch": 0.04174927377226939, "batch_individual_items": 0.04271939251025958, "add_time_dim_to_batch_and_zero_pad": 1.4152800063859882e-05, "numpy_to_tensor": 8.156735192073195e-05, "general_advantage_estimation": 0.012448943476618362, "add_one_ts_to_episodes_and_truncate": 0.010862526269617551}}, "connector_pipeline_timer": 0.10907404366074756}, "num_module_steps_trained": 6000, "learner_connector_sum_episodes_length_in": 5000.0, "num_non_trainable_parameters": 0, "num_env_steps_trained": 31500, "num_env_steps_trained_lifetime": 630000, "learner_connector_sum_episodes_length_out": 5250.0, "num_trainable_parameters": 6003, "num_env_steps_trained_lifetime_throughput": 1117116.126606492, "num_module_steps_trained_throughput": 213203.30952609898, "num_module_steps_trained_lifetime_throughput": 213163.07635391795}, "default_policy": {"num_module_steps_trained_lifetime": 120000, "num_trainable_parameters": 6003, "entropy": 0.5694254040718079, "vf_explained_var": -0.02492392063140869, "num_module_steps_trained": 6000, "weights_seq_no": 20.0, "curr_entropy_coeff": 0.0090570820258, "diff_num_grad_updates_vs_sampler_policy": 1.0, "gradients_default_optimizer_global_norm": 0.0137735391035676, "curr_kl_coeff": 7.119143674572115e-07, "default_optimizer_learning_rate": 0.0002847858517, "vf_loss_unclipped": 26.72565269470215, "total_loss": -0.021787814795970917, "mean_kl_loss": 0.0002637100697029382, "policy_loss": -0.08537109941244125, "module_train_batch_size_mean": 1000.0, "vf_loss": 0.10278083384037018, "num_module_steps_trained_lifetime_throughput": 213162.46933353486}}, "num_training_step_calls_per_iteration": 1, "evaluation": {"env_runners": {"num_module_steps_sampled": {"default_policy": 400}, "num_episodes_lifetime": 400, "rlmodule_inference_timer": 5.1339956222771846e-05, "module_to_env_connector": {"timers": {"connectors": {"remove_single_ts_time_rank_from_batch": 8.650850109384205e-07, "normalize_and_clip_actions": 1.6002762792263104e-05, "listify_data_for_vector_env": 1.895963944914826e-05, "un_batch_to_individual_items": 9.06250218478128e-06, "get_actions": 7.699698160859505e-05, "tensor_to_numpy": 2.5651128345416613e-05}}, "connector_pipeline_timer": 0.00019163529800046787}, "module_episode_returns_mean": {"default_policy": -0.4}, "agent_episode_returns_mean": {"default_agent": -0.4}, "env_reset_timer": 0.0001902399445921181, "episode_len_max": 20, "num_agent_steps_sampled_lifetime": {"default_agent": 8000}, "episode_return_mean": -0.4, "num_agent_steps_sampled": {"default_agent": 400}, "num_env_steps_sampled": 400, "episode_len_mean": 20.0, "num_env_steps_sampled_lifetime": 100400, "episode_return_max": 12.5, "env_to_module_connector": {"connector_pipeline_timer": 7.302348151130415e-05, "timers": {"connectors": {"numpy_to_tensor": 1.7165711731701962e-05, "add_observations_from_episodes_to_batch": 4.505764727172385e-06, "batch_individual_items": 1.1567331453906767e-05, "add_states_from_episodes_to_batch": 2.47797215719225e-06, "add_time_dim_to_batch_and_zero_pad": 3.6604278512256174e-06}}}, "episode_len_min": 20, "env_to_module_sum_episodes_length_in": 10.368238394574323, "num_episodes": 20, "sample": 0.18395126300488385, "weights_seq_no": 20.0, "env_to_module_sum_episodes_length_out": 10.368238394574323, "env_step_timer": 2.8159741156438237e-05, "episode_duration_sec_mean": 0.00805973872775212, "episode_return_min": -12.5, "num_module_steps_sampled_lifetime": {"default_policy": 8000}, "time_between_sampling": 2.663923554377853}, "num_healthy_workers": 1, "actor_manager_num_outstanding_async_reqs": 0, "num_remote_worker_restarts": 0}, "num_env_steps_sampled_lifetime": -11105000.0, "fault_tolerance": {"num_healthy_workers": 0, "num_remote_worker_restarts": 0}, "env_runner_group": {"actor_manager_num_outstanding_async_reqs": 0}, "done": true, "training_iteration": 20, "trial_id": "4380e_00000", "date": "2025-08-11_19-35-09", "timestamp": 1754933709, "time_this_iter_s": 2.9536080360412598, "time_total_s": 57.84587526321411, "pid": 26823, "hostname": "Mac", "node_ip": "127.0.0.1", "config": {"exploration_config": {}, "extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "placement_strategy": "PACK", "num_gpus": 0, "_fake_gpus": false, "num_cpus_for_main_process": 2, "eager_tracing": true, "eager_max_retraces": 20, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "torch_compile_learner": false, "torch_compile_learner_what_to_compile": "forward_train", "torch_compile_learner_dynamo_backend": "aot_eager", "torch_compile_learner_dynamo_mode": null, "torch_compile_worker": false, "torch_compile_worker_dynamo_backend": "aot_eager", "torch_compile_worker_dynamo_mode": null, "torch_ddp_kwargs": {}, "torch_skip_nan_gradients": false, "env": "Umbrella", "env_config": {}, "observation_space": null, "action_space": null, "clip_rewards": null, "normalize_actions": true, "clip_actions": false, "_is_atari": null, "disable_env_checking": false, "render_env": false, "action_mask_key": "action_mask", "env_runner_cls": null, "num_env_runners": 0, "create_local_env_runner": true, "num_envs_per_env_runner": 1, "gym_env_vectorize_mode": "SYNC", "num_cpus_per_env_runner": 1, "num_gpus_per_env_runner": 0, "custom_resources_per_env_runner": {}, "validate_env_runners_after_construction": true, "episodes_to_numpy": true, "max_requests_in_flight_per_env_runner": 1, "sample_timeout_s": 60.0, "_env_to_module_connector": null, "add_default_connectors_to_env_to_module_pipeline": true, "_module_to_env_connector": null, "add_default_connectors_to_module_to_env_pipeline": true, "merge_env_runner_states": "training_only", "broadcast_env_runner_states": true, "episode_lookback_horizon": 1, "rollout_fragment_length": "auto", "batch_mode": "complete_episodes", "compress_observations": false, "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "enable_tf1_exec_eagerly": false, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "preprocessor_pref": "deepmind", "observation_filter": "NoFilter", "update_worker_filter_stats": true, "use_worker_filter_stats": true, "sampler_perf_stats_ema_coef": null, "_is_online": true, "num_learners": 0, "num_gpus_per_learner": 0, "num_cpus_per_learner": "auto", "num_aggregator_actors_per_learner": 0, "max_requests_in_flight_per_aggregator_actor": 3, "local_gpu_idx": 0, "max_requests_in_flight_per_learner": 3, "gamma": 1, "lr": 0.0002847858517, "grad_clip": 0.5, "grad_clip_by": "global_norm", "_train_batch_size_per_learner": 5000, "train_batch_size": 4000, "num_epochs": 1, "minibatch_size": 1000, "shuffle_batch_per_epoch": true, "model": {"fcnet_hiddens": [256, 256], "fcnet_activation": "tanh", "fcnet_weights_initializer": null, "fcnet_weights_initializer_config": null, "fcnet_bias_initializer": null, "fcnet_bias_initializer_config": null, "conv_filters": null, "conv_activation": "relu", "conv_kernel_initializer": null, "conv_kernel_initializer_config": null, "conv_bias_initializer": null, "conv_bias_initializer_config": null, "conv_transpose_kernel_initializer": null, "conv_transpose_kernel_initializer_config": null, "conv_transpose_bias_initializer": null, "conv_transpose_bias_initializer_config": null, "post_fcnet_hiddens": [], "post_fcnet_activation": "relu", "post_fcnet_weights_initializer": null, "post_fcnet_weights_initializer_config": null, "post_fcnet_bias_initializer": null, "post_fcnet_bias_initializer_config": null, "free_log_std": false, "log_std_clip_param": 20.0, "no_final_linear": false, "vf_share_layers": false, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "lstm_weights_initializer": null, "lstm_weights_initializer_config": null, "lstm_bias_initializer": null, "lstm_bias_initializer_config": null, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "attention_use_n_prev_actions": 0, "attention_use_n_prev_rewards": 0, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": null, "custom_model_config": {}, "custom_action_dist": null, "custom_preprocessor": null, "encoder_latent_dim": null, "always_check_shapes": false, "lstm_use_prev_action_reward": -1, "_use_default_native_models": -1, "_disable_preprocessor_api": false, "_disable_action_flattening": false}, "_learner_connector": null, "add_default_connectors_to_learner_pipeline": true, "learner_config_dict": {}, "optimizer": {}, "_learner_class": null, "callbacks_on_algorithm_init": null, "callbacks_on_env_runners_recreated": null, "callbacks_on_offline_eval_runners_recreated": null, "callbacks_on_checkpoint_loaded": null, "callbacks_on_environment_created": null, "callbacks_on_episode_created": null, "callbacks_on_episode_start": null, "callbacks_on_episode_step": null, "callbacks_on_episode_end": null, "callbacks_on_evaluate_start": null, "callbacks_on_evaluate_end": null, "callbacks_on_evaluate_offline_start": null, "callbacks_on_evaluate_offline_end": null, "callbacks_on_sample_end": null, "callbacks_on_train_result": null, "explore": true, "enable_rl_module_and_learner": true, "enable_env_runner_and_connector_v2": true, "_prior_exploration_config": {"type": "StochasticSampling"}, "count_steps_by": "env_steps", "policy_map_capacity": 100, "policy_mapping_fn": "<function AlgorithmConfig.DEFAULT_POLICY_MAPPING_FN at 0x14cce9b20>", "policies_to_train": null, "policy_states_are_swappable": false, "observation_fn": null, "offline_data_class": null, "input_read_method": "read_parquet", "input_read_method_kwargs": {}, "input_read_schema": {}, "input_read_episodes": false, "input_read_sample_batches": false, "input_read_batch_size": null, "input_filesystem": null, "input_filesystem_kwargs": {}, "input_compress_columns": ["obs", "new_obs"], "input_spaces_jsonable": true, "materialize_data": false, "materialize_mapped_data": true, "map_batches_kwargs": {}, "iter_batches_kwargs": {}, "ignore_final_observation": false, "prelearner_class": null, "prelearner_buffer_class": null, "prelearner_buffer_kwargs": {}, "prelearner_module_synch_period": 10, "dataset_num_iters_per_learner": null, "input_config": {}, "actions_in_input_normalized": false, "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_config": {}, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "output_max_rows_per_file": null, "output_write_remaining_data": false, "output_write_method": "write_parquet", "output_write_method_kwargs": {}, "output_filesystem": null, "output_filesystem_kwargs": {}, "output_write_episodes": true, "offline_sampling": false, "evaluation_interval": 1, "evaluation_duration": 20, "evaluation_duration_unit": "episodes", "evaluation_sample_timeout_s": 120.0, "evaluation_auto_duration_min_env_steps_per_sample": 100, "evaluation_auto_duration_max_env_steps_per_sample": 2000, "evaluation_parallel_to_training": false, "evaluation_force_reset_envs_before_iteration": true, "evaluation_config": null, "off_policy_estimation_methods": {}, "ope_split_batch_by_episode": true, "evaluation_num_env_runners": 1, "in_evaluation": false, "sync_filters_on_rollout_workers_timeout_s": 10.0, "offline_evaluation_interval": null, "num_offline_eval_runners": 0, "offline_loss_for_module_fn": null, "offline_evaluation_duration": 1, "offline_evaluation_parallel_to_training": false, "offline_evaluation_timeout_s": 120.0, "num_cpus_per_offline_eval_runner": 1, "num_gpus_per_offline_eval_runner": 0, "custom_resources_per_offline_eval_runner": {}, "restart_failed_offline_eval_runners": true, "ignore_offline_eval_runner_failures": false, "max_num_offline_eval_runner_restarts": 1000, "offline_eval_runner_restore_timeout_s": 1800.0, "max_requests_in_flight_per_offline_eval_runner": 1, "validate_offline_eval_runners_after_construction": true, "offline_eval_runner_health_probe_timeout_s": 30.0, "offline_eval_rl_module_inference_only": false, "broadcast_offline_eval_runner_states": false, "offline_eval_batch_size_per_runner": 256, "dataset_num_iters_per_eval_runner": 1, "keep_per_episode_custom_metrics": false, "metrics_episode_collection_timeout_s": 60.0, "metrics_num_episodes_for_smoothing": 100, "min_time_s_per_iteration": null, "min_train_timesteps_per_iteration": 0, "min_sample_timesteps_per_iteration": 0, "log_gradients": true, "export_native_model_files": false, "checkpoint_trainable_policies_only": false, "logger_creator": null, "logger_config": null, "log_level": "WARN", "log_sys_usage": true, "fake_sampler": false, "seed": 1, "restart_failed_env_runners": true, "ignore_env_runner_failures": false, "max_num_env_runner_restarts": 1000, "delay_between_env_runner_restarts_s": 60.0, "restart_failed_sub_environments": false, "num_consecutive_env_runner_failures_tolerance": 100, "env_runner_health_probe_timeout_s": 30.0, "env_runner_restore_timeout_s": 1800.0, "_model_config": {}, "_rl_module_spec": "RLModuleSpec(module_class=None, observation_space=None, action_space=None, inference_only=False, learner_only=False, model_config=DefaultModelConfig(fcnet_hiddens=[60, 90], fcnet_activation='tanh', fcnet_kernel_initializer=None, fcnet_kernel_initializer_kwargs=None, fcnet_bias_initializer=None, fcnet_bias_initializer_kwargs=None, conv_filters=None, conv_activation='relu', conv_kernel_initializer=None, conv_kernel_initializer_kwargs=None, conv_bias_initializer=None, conv_bias_initializer_kwargs=None, head_fcnet_hiddens=[], head_fcnet_activation='relu', head_fcnet_kernel_initializer=None, head_fcnet_kernel_initializer_kwargs=None, head_fcnet_bias_initializer=None, head_fcnet_bias_initializer_kwargs=None, free_log_std=False, log_std_clip_param=20.0, vf_share_layers=True, use_lstm=False, max_seq_len=20, lstm_cell_size=256, lstm_use_prev_action=False, lstm_use_prev_reward=False, lstm_kernel_initializer=None, lstm_kernel_initializer_kwargs=None, lstm_bias_initializer=None, lstm_bias_initializer_kwargs=None), catalog_class=None, load_state_path=None, model_config_dict=None)", "algorithm_config_overrides_per_module": {}, "_per_module_overrides": {}, "_validate_config": true, "_use_msgpack_checkpoints": false, "_torch_grad_scaler_class": null, "_torch_lr_scheduler_classes": null, "_tf_policy_handles_more_than_one_loss": false, "_disable_preprocessor_api": false, "_disable_action_flattening": false, "_disable_initialize_loss_from_dummy_batch": false, "_dont_auto_sync_env_runner_states": false, "env_task_fn": -1, "enable_connectors": -1, "simple_optimizer": false, "policy_map_cache": -1, "worker_cls": -1, "synchronize_filters": -1, "enable_async_evaluation": -1, "custom_async_evaluation_function": -1, "_enable_rl_module_api": -1, "auto_wrap_old_gym_envs": -1, "always_attach_evaluation_results": -1, "replay_sequence_length": null, "_disable_execution_plan_api": -1, "use_critic": true, "use_gae": true, "use_kl_loss": true, "kl_coeff": 0.7464963036515, "kl_target": 0.0270990929592, "vf_loss_coeff": 0.6688075857018, "entropy_coeff": 0.0090570820258, "clip_param": 0.1221781641624, "vf_clip_param": 0.1027808522125, "entropy_coeff_schedule": null, "lr_schedule": null, "sgd_minibatch_size": -1, "vf_share_layers": -1, "__stdout_file__": null, "__stderr_file__": null, "lambda": 0.9099046732075, "input": "sampler", "policies": {"default_policy": [null, null, null, null]}, "callbacks": "<class 'ray.rllib.callbacks.callbacks.RLlibCallback'>", "create_env_on_driver": false, "custom_eval_function": null, "framework": "torch"}, "time_since_restore": 57.84587526321411, "iterations_since_restore": 20, "perf": {"cpu_util_percent": 71.1, "ram_util_percent": 78.72500000000001}}
