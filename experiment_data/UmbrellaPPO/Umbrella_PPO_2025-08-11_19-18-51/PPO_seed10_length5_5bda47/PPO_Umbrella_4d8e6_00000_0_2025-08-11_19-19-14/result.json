{"timers": {"training_iteration": 17.365084125078283, "restore_env_runners": 0.00012099999003112316, "training_step": 17.364522582967766, "env_runner_sampling_timer": 16.6797967919847, "learner_update_timer": 0.6738218750106171, "synch_weights": 0.001746416906826198}, "env_runners": {"episode_return_min": -10.5, "num_agent_steps_sampled_lifetime": {"default_agent": 627500.0}, "module_to_env_connector": {"timers": {"connectors": {"remove_single_ts_time_rank_from_batch": 3.2287215291605625e-06, "normalize_and_clip_actions": 0.0001050074796316826, "listify_data_for_vector_env": 0.00010470034697907165, "get_actions": 0.0006549553570095013, "tensor_to_numpy": 0.0001850905202546564, "un_batch_to_individual_items": 5.12034721855124e-05}}, "connector_pipeline_timer": 0.0013311483060832296}, "episode_len_mean": 20.0, "num_module_steps_sampled": {"default_policy": 5000.0}, "env_to_module_connector": {"timers": {"connectors": {"add_states_from_episodes_to_batch": 8.982675701191129e-06, "add_time_dim_to_batch_and_zero_pad": 1.9840716813548666e-05, "numpy_to_tensor": 0.00011495961298023297, "add_observations_from_episodes_to_batch": 3.062683531172759e-05, "batch_individual_items": 7.983170712793e-05}}, "connector_pipeline_timer": 0.00043829997503527}, "sample": 0.04701670693607012, "env_to_module_sum_episodes_length_out": 10.191744832559449, "weights_seq_no": 0.0, "num_env_steps_sampled_lifetime": 627500.0, "episode_return_max": 9.5, "episode_return_mean": -2.0200000000000005, "module_episode_returns_mean": {"default_policy": -2.0200000000000005}, "time_between_sampling": 0.003034542941012588, "rlmodule_inference_timer": 0.0005672955342409709, "env_step_timer": 0.00021225482333771137, "env_reset_timer": 0.0004448776367933643, "agent_episode_returns_mean": {"default_agent": -2.0200000000000005}, "num_env_steps_sampled": 5000.0, "episode_duration_sec_mean": 0.05800167633127422, "env_to_module_sum_episodes_length_in": 10.191744832559449, "episode_len_min": 20, "num_agent_steps_sampled": {"default_agent": 5000.0}, "num_episodes": 250.0, "num_module_steps_sampled_lifetime": {"default_policy": 627500.0}, "episode_len_max": 20, "num_episodes_lifetime": 31375.0, "num_env_steps_sampled_lifetime_throughput": 604.7141421306486}, "learners": {"__all_modules__": {"learner_connector": {"timers": {"connectors": {"general_advantage_estimation": 0.06808612507302314, "numpy_to_tensor": 0.0006760000251233578, "add_observations_from_episodes_to_batch": 0.004550208919681609, "add_one_ts_to_episodes_and_truncate": 0.028678208007477224, "batch_individual_items": 0.10438516596332192, "add_states_from_episodes_to_batch": 3.875000402331352e-06, "add_columns_from_episodes_to_train_batch": 0.19394133402965963, "add_time_dim_to_batch_and_zero_pad": 1.725007314234972e-05}}, "connector_pipeline_timer": 0.40088537498377264}, "num_module_steps_trained_lifetime": 6000, "num_non_trainable_parameters": 0, "learner_connector_sum_episodes_length_out": 5250, "num_module_steps_trained": 6000, "num_trainable_parameters": 6003, "num_env_steps_trained": 31500, "num_env_steps_trained_lifetime": 31500, "learner_connector_sum_episodes_length_in": 5000, "num_env_steps_trained_lifetime_throughput": 211207.8808475594, "num_module_steps_trained_throughput": 40321.672861806896, "num_module_steps_trained_lifetime_throughput": 40311.990338171905}, "default_policy": {"curr_kl_coeff": 0.3732481598854065, "entropy": 0.6901261210441589, "vf_loss": 0.10278083384037018, "default_optimizer_learning_rate": 0.0002847858517, "vf_explained_var": -0.009449124336242676, "total_loss": 0.11597263813018799, "num_trainable_parameters": 6003, "vf_loss_unclipped": 28.793254852294922, "curr_entropy_coeff": 0.0090570820258, "policy_loss": 0.05304957553744316, "diff_num_grad_updates_vs_sampler_policy": 1.0, "mean_kl_loss": 0.0005800133803859353, "gradients_default_optimizer_global_norm": 0.10005132108926773, "num_module_steps_trained_lifetime": 6000, "weights_seq_no": 1.0, "num_module_steps_trained": 6000, "module_train_batch_size_mean": 1000.0, "num_module_steps_trained_lifetime_throughput": 40290.283107125}}, "num_training_step_calls_per_iteration": 1, "num_env_steps_sampled_lifetime": 627500.0, "evaluation": {"env_runners": {"env_to_module_connector": {"timers": {"connectors": {"add_states_from_episodes_to_batch": 1.0705987942848386e-05, "numpy_to_tensor": 0.00012623451092978917, "add_time_dim_to_batch_and_zero_pad": 2.3247370465364965e-05, "add_observations_from_episodes_to_batch": 2.4223993330383664e-05, "batch_individual_items": 8.311506093645532e-05}}, "connector_pipeline_timer": 0.00046224526252108117}, "agent_episode_returns_mean": {"default_agent": -0.55}, "num_agent_steps_sampled": {"default_agent": 400}, "num_env_steps_sampled_lifetime": 5400, "num_env_steps_sampled": 400, "num_episodes": 20, "episode_len_max": 20, "episode_return_min": -12.5, "episode_len_mean": 20.0, "env_to_module_sum_episodes_length_out": 10.216013141322508, "num_module_steps_sampled_lifetime": {"default_policy": 400}, "num_agent_steps_sampled_lifetime": {"default_agent": 400}, "module_to_env_connector": {"timers": {"connectors": {"get_actions": 0.0007902378349455272, "normalize_and_clip_actions": 0.00018027739014838542, "tensor_to_numpy": 0.000245058606721873, "remove_single_ts_time_rank_from_batch": 5.684917889692101e-06, "listify_data_for_vector_env": 0.0001096315272393877, "un_batch_to_individual_items": 5.20893956789726e-05}}, "connector_pipeline_timer": 0.0017163819202011747}, "episode_return_mean": -0.55, "env_reset_timer": 0.004733292036689818, "module_episode_returns_mean": {"default_policy": -0.55}, "num_episodes_lifetime": 20, "sample": 1.0864530409453437, "num_module_steps_sampled": {"default_policy": 400}, "env_step_timer": 0.0002448318581383437, "episode_duration_sec_mean": 0.051410591491730884, "env_to_module_sum_episodes_length_in": 10.216013141322508, "episode_len_min": 20, "weights_seq_no": 1.0, "episode_return_max": 13.5, "rlmodule_inference_timer": 0.0006286439102427458}, "num_healthy_workers": 1, "actor_manager_num_outstanding_async_reqs": 0, "num_remote_worker_restarts": 0}, "fault_tolerance": {"num_healthy_workers": 0, "num_remote_worker_restarts": 0}, "env_runner_group": {"actor_manager_num_outstanding_async_reqs": 0}, "done": false, "training_iteration": 1, "trial_id": "4d8e6_00000", "date": "2025-08-11_19-28-20", "timestamp": 1754933300, "time_this_iter_s": 18.51020622253418, "time_total_s": 18.51020622253418, "pid": 19818, "hostname": "Mac", "node_ip": "127.0.0.1", "config": {"exploration_config": {}, "extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "placement_strategy": "PACK", "num_gpus": 0, "_fake_gpus": false, "num_cpus_for_main_process": 2, "eager_tracing": true, "eager_max_retraces": 20, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "torch_compile_learner": false, "torch_compile_learner_what_to_compile": "forward_train", "torch_compile_learner_dynamo_backend": "aot_eager", "torch_compile_learner_dynamo_mode": null, "torch_compile_worker": false, "torch_compile_worker_dynamo_backend": "aot_eager", "torch_compile_worker_dynamo_mode": null, "torch_ddp_kwargs": {}, "torch_skip_nan_gradients": false, "env": "Umbrella", "env_config": {}, "observation_space": null, "action_space": null, "clip_rewards": null, "normalize_actions": true, "clip_actions": false, "_is_atari": null, "disable_env_checking": false, "render_env": false, "action_mask_key": "action_mask", "env_runner_cls": null, "num_env_runners": 0, "create_local_env_runner": true, "num_envs_per_env_runner": 1, "gym_env_vectorize_mode": "SYNC", "num_cpus_per_env_runner": 1, "num_gpus_per_env_runner": 0, "custom_resources_per_env_runner": {}, "validate_env_runners_after_construction": true, "episodes_to_numpy": true, "max_requests_in_flight_per_env_runner": 1, "sample_timeout_s": 60.0, "_env_to_module_connector": null, "add_default_connectors_to_env_to_module_pipeline": true, "_module_to_env_connector": null, "add_default_connectors_to_module_to_env_pipeline": true, "merge_env_runner_states": "training_only", "broadcast_env_runner_states": true, "episode_lookback_horizon": 1, "rollout_fragment_length": "auto", "batch_mode": "complete_episodes", "compress_observations": false, "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "enable_tf1_exec_eagerly": false, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "preprocessor_pref": "deepmind", "observation_filter": "NoFilter", "update_worker_filter_stats": true, "use_worker_filter_stats": true, "sampler_perf_stats_ema_coef": null, "_is_online": true, "num_learners": 0, "num_gpus_per_learner": 0, "num_cpus_per_learner": "auto", "num_aggregator_actors_per_learner": 0, "max_requests_in_flight_per_aggregator_actor": 3, "local_gpu_idx": 0, "max_requests_in_flight_per_learner": 3, "gamma": 1, "lr": 0.0002847858517, "grad_clip": 0.5, "grad_clip_by": "global_norm", "_train_batch_size_per_learner": 5000, "train_batch_size": 4000, "num_epochs": 1, "minibatch_size": 1000, "shuffle_batch_per_epoch": true, "model": {"fcnet_hiddens": [256, 256], "fcnet_activation": "tanh", "fcnet_weights_initializer": null, "fcnet_weights_initializer_config": null, "fcnet_bias_initializer": null, "fcnet_bias_initializer_config": null, "conv_filters": null, "conv_activation": "relu", "conv_kernel_initializer": null, "conv_kernel_initializer_config": null, "conv_bias_initializer": null, "conv_bias_initializer_config": null, "conv_transpose_kernel_initializer": null, "conv_transpose_kernel_initializer_config": null, "conv_transpose_bias_initializer": null, "conv_transpose_bias_initializer_config": null, "post_fcnet_hiddens": [], "post_fcnet_activation": "relu", "post_fcnet_weights_initializer": null, "post_fcnet_weights_initializer_config": null, "post_fcnet_bias_initializer": null, "post_fcnet_bias_initializer_config": null, "free_log_std": false, "log_std_clip_param": 20.0, "no_final_linear": false, "vf_share_layers": false, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "lstm_weights_initializer": null, "lstm_weights_initializer_config": null, "lstm_bias_initializer": null, "lstm_bias_initializer_config": null, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "attention_use_n_prev_actions": 0, "attention_use_n_prev_rewards": 0, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": null, "custom_model_config": {}, "custom_action_dist": null, "custom_preprocessor": null, "encoder_latent_dim": null, "always_check_shapes": false, "lstm_use_prev_action_reward": -1, "_use_default_native_models": -1, "_disable_preprocessor_api": false, "_disable_action_flattening": false}, "_learner_connector": null, "add_default_connectors_to_learner_pipeline": true, "learner_config_dict": {}, "optimizer": {}, "_learner_class": null, "callbacks_on_algorithm_init": null, "callbacks_on_env_runners_recreated": null, "callbacks_on_offline_eval_runners_recreated": null, "callbacks_on_checkpoint_loaded": null, "callbacks_on_environment_created": null, "callbacks_on_episode_created": null, "callbacks_on_episode_start": null, "callbacks_on_episode_step": null, "callbacks_on_episode_end": null, "callbacks_on_evaluate_start": null, "callbacks_on_evaluate_end": null, "callbacks_on_evaluate_offline_start": null, "callbacks_on_evaluate_offline_end": null, "callbacks_on_sample_end": null, "callbacks_on_train_result": null, "explore": true, "enable_rl_module_and_learner": true, "enable_env_runner_and_connector_v2": true, "_prior_exploration_config": {"type": "StochasticSampling"}, "count_steps_by": "env_steps", "policy_map_capacity": 100, "policy_mapping_fn": "<function AlgorithmConfig.DEFAULT_POLICY_MAPPING_FN at 0x161a518a0>", "policies_to_train": null, "policy_states_are_swappable": false, "observation_fn": null, "offline_data_class": null, "input_read_method": "read_parquet", "input_read_method_kwargs": {}, "input_read_schema": {}, "input_read_episodes": false, "input_read_sample_batches": false, "input_read_batch_size": null, "input_filesystem": null, "input_filesystem_kwargs": {}, "input_compress_columns": ["obs", "new_obs"], "input_spaces_jsonable": true, "materialize_data": false, "materialize_mapped_data": true, "map_batches_kwargs": {}, "iter_batches_kwargs": {}, "ignore_final_observation": false, "prelearner_class": null, "prelearner_buffer_class": null, "prelearner_buffer_kwargs": {}, "prelearner_module_synch_period": 10, "dataset_num_iters_per_learner": null, "input_config": {}, "actions_in_input_normalized": false, "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_config": {}, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "output_max_rows_per_file": null, "output_write_remaining_data": false, "output_write_method": "write_parquet", "output_write_method_kwargs": {}, "output_filesystem": null, "output_filesystem_kwargs": {}, "output_write_episodes": true, "offline_sampling": false, "evaluation_interval": 1, "evaluation_duration": 20, "evaluation_duration_unit": "episodes", "evaluation_sample_timeout_s": 120.0, "evaluation_auto_duration_min_env_steps_per_sample": 100, "evaluation_auto_duration_max_env_steps_per_sample": 2000, "evaluation_parallel_to_training": false, "evaluation_force_reset_envs_before_iteration": true, "evaluation_config": null, "off_policy_estimation_methods": {}, "ope_split_batch_by_episode": true, "evaluation_num_env_runners": 1, "in_evaluation": false, "sync_filters_on_rollout_workers_timeout_s": 10.0, "offline_evaluation_interval": null, "num_offline_eval_runners": 0, "offline_loss_for_module_fn": null, "offline_evaluation_duration": 1, "offline_evaluation_parallel_to_training": false, "offline_evaluation_timeout_s": 120.0, "num_cpus_per_offline_eval_runner": 1, "num_gpus_per_offline_eval_runner": 0, "custom_resources_per_offline_eval_runner": {}, "restart_failed_offline_eval_runners": true, "ignore_offline_eval_runner_failures": false, "max_num_offline_eval_runner_restarts": 1000, "offline_eval_runner_restore_timeout_s": 1800.0, "max_requests_in_flight_per_offline_eval_runner": 1, "validate_offline_eval_runners_after_construction": true, "offline_eval_runner_health_probe_timeout_s": 30.0, "offline_eval_rl_module_inference_only": false, "broadcast_offline_eval_runner_states": false, "offline_eval_batch_size_per_runner": 256, "dataset_num_iters_per_eval_runner": 1, "keep_per_episode_custom_metrics": false, "metrics_episode_collection_timeout_s": 60.0, "metrics_num_episodes_for_smoothing": 100, "min_time_s_per_iteration": null, "min_train_timesteps_per_iteration": 0, "min_sample_timesteps_per_iteration": 0, "log_gradients": true, "export_native_model_files": false, "checkpoint_trainable_policies_only": false, "logger_creator": null, "logger_config": null, "log_level": "WARN", "log_sys_usage": true, "fake_sampler": false, "seed": 10, "restart_failed_env_runners": true, "ignore_env_runner_failures": false, "max_num_env_runner_restarts": 1000, "delay_between_env_runner_restarts_s": 60.0, "restart_failed_sub_environments": false, "num_consecutive_env_runner_failures_tolerance": 100, "env_runner_health_probe_timeout_s": 30.0, "env_runner_restore_timeout_s": 1800.0, "_model_config": {}, "_rl_module_spec": "RLModuleSpec(module_class=None, observation_space=None, action_space=None, inference_only=False, learner_only=False, model_config=DefaultModelConfig(fcnet_hiddens=[60, 90], fcnet_activation='tanh', fcnet_kernel_initializer=None, fcnet_kernel_initializer_kwargs=None, fcnet_bias_initializer=None, fcnet_bias_initializer_kwargs=None, conv_filters=None, conv_activation='relu', conv_kernel_initializer=None, conv_kernel_initializer_kwargs=None, conv_bias_initializer=None, conv_bias_initializer_kwargs=None, head_fcnet_hiddens=[], head_fcnet_activation='relu', head_fcnet_kernel_initializer=None, head_fcnet_kernel_initializer_kwargs=None, head_fcnet_bias_initializer=None, head_fcnet_bias_initializer_kwargs=None, free_log_std=False, log_std_clip_param=20.0, vf_share_layers=True, use_lstm=False, max_seq_len=20, lstm_cell_size=256, lstm_use_prev_action=False, lstm_use_prev_reward=False, lstm_kernel_initializer=None, lstm_kernel_initializer_kwargs=None, lstm_bias_initializer=None, lstm_bias_initializer_kwargs=None), catalog_class=None, load_state_path=None, model_config_dict=None)", "algorithm_config_overrides_per_module": {}, "_per_module_overrides": {}, "_validate_config": true, "_use_msgpack_checkpoints": false, "_torch_grad_scaler_class": null, "_torch_lr_scheduler_classes": null, "_tf_policy_handles_more_than_one_loss": false, "_disable_preprocessor_api": false, "_disable_action_flattening": false, "_disable_initialize_loss_from_dummy_batch": false, "_dont_auto_sync_env_runner_states": false, "env_task_fn": -1, "enable_connectors": -1, "simple_optimizer": false, "policy_map_cache": -1, "worker_cls": -1, "synchronize_filters": -1, "enable_async_evaluation": -1, "custom_async_evaluation_function": -1, "_enable_rl_module_api": -1, "auto_wrap_old_gym_envs": -1, "always_attach_evaluation_results": -1, "replay_sequence_length": null, "_disable_execution_plan_api": -1, "use_critic": true, "use_gae": true, "use_kl_loss": true, "kl_coeff": 0.7464963036515, "kl_target": 0.0270990929592, "vf_loss_coeff": 0.6688075857018, "entropy_coeff": 0.0090570820258, "clip_param": 0.1221781641624, "vf_clip_param": 0.1027808522125, "entropy_coeff_schedule": null, "lr_schedule": null, "sgd_minibatch_size": -1, "vf_share_layers": -1, "__stdout_file__": null, "__stderr_file__": null, "lambda": 0.9099046732075, "input": "sampler", "policies": {"default_policy": [null, null, null, null]}, "callbacks": "<class 'ray.rllib.callbacks.callbacks.RLlibCallback'>", "create_env_on_driver": false, "custom_eval_function": null, "framework": "torch"}, "time_since_restore": 18.51020622253418, "iterations_since_restore": 1, "perf": {"cpu_util_percent": 96.15, "ram_util_percent": 82.94615384615385}}
{"timers": {"training_iteration": 17.30896398798679, "restore_env_runners": 0.00011994124040938913, "training_step": 17.30840483463835, "env_runner_sampling_timer": 16.622687312815103, "learner_update_timer": 0.6748478225106374, "synch_weights": 0.0017461852380074561, "restore_eval_env_runners": 3.341701813042164e-05, "evaluation_iteration": 1.1405729170655832, "synch_eval_env_connectors": 0.0004963749088346958, "synch_env_connectors": 9.040930308401585e-06}, "env_runners": {"episode_return_min": -10.5, "num_agent_steps_sampled_lifetime": {"default_agent": 10000.0}, "module_to_env_connector": {"timers": {"connectors": {"remove_single_ts_time_rank_from_batch": 3.7028282534135433e-06, "normalize_and_clip_actions": 5.235848265625953e-05, "listify_data_for_vector_env": 7.177420510709306e-05, "get_actions": 0.0005146731205156062, "tensor_to_numpy": 0.00015045924425546457, "un_batch_to_individual_items": 3.71203293712105e-05}}, "connector_pipeline_timer": 0.0009714091084206791}, "episode_len_mean": 20.0, "num_module_steps_sampled": {"default_policy": 5000.0}, "env_to_module_connector": {"timers": {"connectors": {"add_states_from_episodes_to_batch": 5.6017111752062945e-06, "add_time_dim_to_batch_and_zero_pad": 1.4086170626885051e-05, "numpy_to_tensor": 6.906748951241055e-05, "add_observations_from_episodes_to_batch": 2.0173786452968932e-05, "batch_individual_items": 4.26816803391096e-05}}, "connector_pipeline_timer": 0.0002575132239537217}, "sample": 0.052070699949350145, "env_to_module_sum_episodes_length_out": 10.36823839457432, "weights_seq_no": 1.0, "num_env_steps_sampled_lifetime": 10000.0, "episode_return_max": 9.5, "episode_return_mean": -1.3799999999999994, "module_episode_returns_mean": {"default_policy": -1.3799999999999994}, "time_between_sampling": 0.011781240740083703, "rlmodule_inference_timer": 0.00031010514744024033, "env_step_timer": 9.366847003407016e-05, "env_reset_timer": 0.0002610490915451167, "agent_episode_returns_mean": {"default_agent": -1.3799999999999994}, "num_env_steps_sampled": 5000.0, "episode_duration_sec_mean": 0.03866458517778664, "env_to_module_sum_episodes_length_in": 10.36823839457432, "episode_len_min": 20, "num_agent_steps_sampled": {"default_agent": 5000.0}, "num_episodes": 250.0, "num_module_steps_sampled_lifetime": {"default_policy": 10000.0}, "episode_len_max": 20, "num_episodes_lifetime": 500.0, "num_env_steps_sampled_lifetime_throughput": 914.8309072714163}, "learners": {"__all_modules__": {"learner_connector": {"timers": {"connectors": {"general_advantage_estimation": 0.06754138632211834, "numpy_to_tensor": 0.0006701933545991778, "add_observations_from_episodes_to_batch": 0.004515103490557522, "add_one_ts_to_episodes_and_truncate": 0.02856816758750938, "batch_individual_items": 0.1088936443044804, "add_states_from_episodes_to_batch": 3.885420737788081e-06, "add_columns_from_episodes_to_train_batch": 0.19313695276970974, "add_time_dim_to_batch_and_zero_pad": 1.7661731690168384e-05}}, "connector_pipeline_timer": 0.4038904599833768}, "num_module_steps_trained_lifetime": 12000, "num_non_trainable_parameters": 0, "learner_connector_sum_episodes_length_out": 5250.0, "num_module_steps_trained": 6000, "num_trainable_parameters": 6003, "num_env_steps_trained": 31500, "num_env_steps_trained_lifetime": 63000, "learner_connector_sum_episodes_length_in": 5000.0, "num_env_steps_trained_lifetime_throughput": 213745.5276693641, "num_module_steps_trained_throughput": 40804.42256936702, "num_module_steps_trained_lifetime_throughput": 40794.86817733171}, "default_policy": {"curr_kl_coeff": 0.18662407994270325, "entropy": 0.691680371761322, "vf_loss": 0.10278083384037018, "default_optimizer_learning_rate": 0.0002847858517, "vf_explained_var": -0.009900569915771484, "total_loss": 0.05817184969782829, "num_trainable_parameters": 6003, "vf_loss_unclipped": 28.727876663208008, "curr_entropy_coeff": 0.0090570820258, "policy_loss": -0.00450977822765708, "diff_num_grad_updates_vs_sampler_policy": 1.0, "mean_kl_loss": 0.0005508643225766718, "gradients_default_optimizer_global_norm": 0.09314917027950287, "num_module_steps_trained_lifetime": 12000, "weights_seq_no": 2.0, "num_module_steps_trained": 6000, "module_train_batch_size_mean": 1000.0, "num_module_steps_trained_lifetime_throughput": 40773.3103831839}}, "num_training_step_calls_per_iteration": 1, "evaluation": {"env_runners": {"env_to_module_connector": {"timers": {"connectors": {"add_states_from_episodes_to_batch": 4.6729487972464625e-06, "numpy_to_tensor": 4.029323160968575e-05, "add_time_dim_to_batch_and_zero_pad": 8.894882479674974e-06, "add_observations_from_episodes_to_batch": 1.0516825506453377e-05, "batch_individual_items": 1.97856949641864e-05}}, "connector_pipeline_timer": 0.0001401233671748134}, "agent_episode_returns_mean": {"default_agent": -0.05}, "num_agent_steps_sampled": {"default_agent": 400}, "num_env_steps_sampled_lifetime": 10400, "num_env_steps_sampled": 400, "num_episodes": 20, "episode_len_max": 20, "episode_return_min": -14.5, "episode_len_mean": 20.0, "env_to_module_sum_episodes_length_out": 10.366003441359926, "num_module_steps_sampled_lifetime": {"default_policy": 800}, "num_agent_steps_sampled_lifetime": {"default_agent": 800}, "module_to_env_connector": {"timers": {"connectors": {"get_actions": 0.00020349037401919614, "normalize_and_clip_actions": 4.563068799788148e-05, "tensor_to_numpy": 5.3744035008665054e-05, "remove_single_ts_time_rank_from_batch": 1.487299237893282e-06, "listify_data_for_vector_env": 4.131981265997489e-05, "un_batch_to_individual_items": 1.541933496353891e-05}}, "connector_pipeline_timer": 0.00047959988605503147}, "episode_return_mean": -0.05, "env_reset_timer": 0.004702180776512251, "module_episode_returns_mean": {"default_policy": -0.05}, "num_episodes_lifetime": 40, "sample": 1.0803059038659557, "num_module_steps_sampled": {"default_policy": 400}, "env_step_timer": 6.416294536754075e-05, "episode_duration_sec_mean": 0.03557728957966901, "env_to_module_sum_episodes_length_in": 10.366003441359926, "episode_len_min": 20, "weights_seq_no": 2.0, "episode_return_max": 13.5, "rlmodule_inference_timer": 0.00016508237992594386, "time_between_sampling": 11.876725125010125}, "num_healthy_workers": 1, "actor_manager_num_outstanding_async_reqs": 0, "num_remote_worker_restarts": 0}, "num_env_steps_sampled_lifetime": 10000.0, "fault_tolerance": {"num_healthy_workers": 0, "num_remote_worker_restarts": 0}, "env_runner_group": {"actor_manager_num_outstanding_async_reqs": 0}, "done": false, "training_iteration": 2, "trial_id": "4d8e6_00000", "date": "2025-08-11_19-28-32", "timestamp": 1754933312, "time_this_iter_s": 12.248353242874146, "time_total_s": 30.758559465408325, "pid": 19818, "hostname": "Mac", "node_ip": "127.0.0.1", "config": {"exploration_config": {}, "extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "placement_strategy": "PACK", "num_gpus": 0, "_fake_gpus": false, "num_cpus_for_main_process": 2, "eager_tracing": true, "eager_max_retraces": 20, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "torch_compile_learner": false, "torch_compile_learner_what_to_compile": "forward_train", "torch_compile_learner_dynamo_backend": "aot_eager", "torch_compile_learner_dynamo_mode": null, "torch_compile_worker": false, "torch_compile_worker_dynamo_backend": "aot_eager", "torch_compile_worker_dynamo_mode": null, "torch_ddp_kwargs": {}, "torch_skip_nan_gradients": false, "env": "Umbrella", "env_config": {}, "observation_space": null, "action_space": null, "clip_rewards": null, "normalize_actions": true, "clip_actions": false, "_is_atari": null, "disable_env_checking": false, "render_env": false, "action_mask_key": "action_mask", "env_runner_cls": null, "num_env_runners": 0, "create_local_env_runner": true, "num_envs_per_env_runner": 1, "gym_env_vectorize_mode": "SYNC", "num_cpus_per_env_runner": 1, "num_gpus_per_env_runner": 0, "custom_resources_per_env_runner": {}, "validate_env_runners_after_construction": true, "episodes_to_numpy": true, "max_requests_in_flight_per_env_runner": 1, "sample_timeout_s": 60.0, "_env_to_module_connector": null, "add_default_connectors_to_env_to_module_pipeline": true, "_module_to_env_connector": null, "add_default_connectors_to_module_to_env_pipeline": true, "merge_env_runner_states": "training_only", "broadcast_env_runner_states": true, "episode_lookback_horizon": 1, "rollout_fragment_length": "auto", "batch_mode": "complete_episodes", "compress_observations": false, "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "enable_tf1_exec_eagerly": false, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "preprocessor_pref": "deepmind", "observation_filter": "NoFilter", "update_worker_filter_stats": true, "use_worker_filter_stats": true, "sampler_perf_stats_ema_coef": null, "_is_online": true, "num_learners": 0, "num_gpus_per_learner": 0, "num_cpus_per_learner": "auto", "num_aggregator_actors_per_learner": 0, "max_requests_in_flight_per_aggregator_actor": 3, "local_gpu_idx": 0, "max_requests_in_flight_per_learner": 3, "gamma": 1, "lr": 0.0002847858517, "grad_clip": 0.5, "grad_clip_by": "global_norm", "_train_batch_size_per_learner": 5000, "train_batch_size": 4000, "num_epochs": 1, "minibatch_size": 1000, "shuffle_batch_per_epoch": true, "model": {"fcnet_hiddens": [256, 256], "fcnet_activation": "tanh", "fcnet_weights_initializer": null, "fcnet_weights_initializer_config": null, "fcnet_bias_initializer": null, "fcnet_bias_initializer_config": null, "conv_filters": null, "conv_activation": "relu", "conv_kernel_initializer": null, "conv_kernel_initializer_config": null, "conv_bias_initializer": null, "conv_bias_initializer_config": null, "conv_transpose_kernel_initializer": null, "conv_transpose_kernel_initializer_config": null, "conv_transpose_bias_initializer": null, "conv_transpose_bias_initializer_config": null, "post_fcnet_hiddens": [], "post_fcnet_activation": "relu", "post_fcnet_weights_initializer": null, "post_fcnet_weights_initializer_config": null, "post_fcnet_bias_initializer": null, "post_fcnet_bias_initializer_config": null, "free_log_std": false, "log_std_clip_param": 20.0, "no_final_linear": false, "vf_share_layers": false, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "lstm_weights_initializer": null, "lstm_weights_initializer_config": null, "lstm_bias_initializer": null, "lstm_bias_initializer_config": null, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "attention_use_n_prev_actions": 0, "attention_use_n_prev_rewards": 0, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": null, "custom_model_config": {}, "custom_action_dist": null, "custom_preprocessor": null, "encoder_latent_dim": null, "always_check_shapes": false, "lstm_use_prev_action_reward": -1, "_use_default_native_models": -1, "_disable_preprocessor_api": false, "_disable_action_flattening": false}, "_learner_connector": null, "add_default_connectors_to_learner_pipeline": true, "learner_config_dict": {}, "optimizer": {}, "_learner_class": null, "callbacks_on_algorithm_init": null, "callbacks_on_env_runners_recreated": null, "callbacks_on_offline_eval_runners_recreated": null, "callbacks_on_checkpoint_loaded": null, "callbacks_on_environment_created": null, "callbacks_on_episode_created": null, "callbacks_on_episode_start": null, "callbacks_on_episode_step": null, "callbacks_on_episode_end": null, "callbacks_on_evaluate_start": null, "callbacks_on_evaluate_end": null, "callbacks_on_evaluate_offline_start": null, "callbacks_on_evaluate_offline_end": null, "callbacks_on_sample_end": null, "callbacks_on_train_result": null, "explore": true, "enable_rl_module_and_learner": true, "enable_env_runner_and_connector_v2": true, "_prior_exploration_config": {"type": "StochasticSampling"}, "count_steps_by": "env_steps", "policy_map_capacity": 100, "policy_mapping_fn": "<function AlgorithmConfig.DEFAULT_POLICY_MAPPING_FN at 0x161a518a0>", "policies_to_train": null, "policy_states_are_swappable": false, "observation_fn": null, "offline_data_class": null, "input_read_method": "read_parquet", "input_read_method_kwargs": {}, "input_read_schema": {}, "input_read_episodes": false, "input_read_sample_batches": false, "input_read_batch_size": null, "input_filesystem": null, "input_filesystem_kwargs": {}, "input_compress_columns": ["obs", "new_obs"], "input_spaces_jsonable": true, "materialize_data": false, "materialize_mapped_data": true, "map_batches_kwargs": {}, "iter_batches_kwargs": {}, "ignore_final_observation": false, "prelearner_class": null, "prelearner_buffer_class": null, "prelearner_buffer_kwargs": {}, "prelearner_module_synch_period": 10, "dataset_num_iters_per_learner": null, "input_config": {}, "actions_in_input_normalized": false, "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_config": {}, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "output_max_rows_per_file": null, "output_write_remaining_data": false, "output_write_method": "write_parquet", "output_write_method_kwargs": {}, "output_filesystem": null, "output_filesystem_kwargs": {}, "output_write_episodes": true, "offline_sampling": false, "evaluation_interval": 1, "evaluation_duration": 20, "evaluation_duration_unit": "episodes", "evaluation_sample_timeout_s": 120.0, "evaluation_auto_duration_min_env_steps_per_sample": 100, "evaluation_auto_duration_max_env_steps_per_sample": 2000, "evaluation_parallel_to_training": false, "evaluation_force_reset_envs_before_iteration": true, "evaluation_config": null, "off_policy_estimation_methods": {}, "ope_split_batch_by_episode": true, "evaluation_num_env_runners": 1, "in_evaluation": false, "sync_filters_on_rollout_workers_timeout_s": 10.0, "offline_evaluation_interval": null, "num_offline_eval_runners": 0, "offline_loss_for_module_fn": null, "offline_evaluation_duration": 1, "offline_evaluation_parallel_to_training": false, "offline_evaluation_timeout_s": 120.0, "num_cpus_per_offline_eval_runner": 1, "num_gpus_per_offline_eval_runner": 0, "custom_resources_per_offline_eval_runner": {}, "restart_failed_offline_eval_runners": true, "ignore_offline_eval_runner_failures": false, "max_num_offline_eval_runner_restarts": 1000, "offline_eval_runner_restore_timeout_s": 1800.0, "max_requests_in_flight_per_offline_eval_runner": 1, "validate_offline_eval_runners_after_construction": true, "offline_eval_runner_health_probe_timeout_s": 30.0, "offline_eval_rl_module_inference_only": false, "broadcast_offline_eval_runner_states": false, "offline_eval_batch_size_per_runner": 256, "dataset_num_iters_per_eval_runner": 1, "keep_per_episode_custom_metrics": false, "metrics_episode_collection_timeout_s": 60.0, "metrics_num_episodes_for_smoothing": 100, "min_time_s_per_iteration": null, "min_train_timesteps_per_iteration": 0, "min_sample_timesteps_per_iteration": 0, "log_gradients": true, "export_native_model_files": false, "checkpoint_trainable_policies_only": false, "logger_creator": null, "logger_config": null, "log_level": "WARN", "log_sys_usage": true, "fake_sampler": false, "seed": 10, "restart_failed_env_runners": true, "ignore_env_runner_failures": false, "max_num_env_runner_restarts": 1000, "delay_between_env_runner_restarts_s": 60.0, "restart_failed_sub_environments": false, "num_consecutive_env_runner_failures_tolerance": 100, "env_runner_health_probe_timeout_s": 30.0, "env_runner_restore_timeout_s": 1800.0, "_model_config": {}, "_rl_module_spec": "RLModuleSpec(module_class=None, observation_space=None, action_space=None, inference_only=False, learner_only=False, model_config=DefaultModelConfig(fcnet_hiddens=[60, 90], fcnet_activation='tanh', fcnet_kernel_initializer=None, fcnet_kernel_initializer_kwargs=None, fcnet_bias_initializer=None, fcnet_bias_initializer_kwargs=None, conv_filters=None, conv_activation='relu', conv_kernel_initializer=None, conv_kernel_initializer_kwargs=None, conv_bias_initializer=None, conv_bias_initializer_kwargs=None, head_fcnet_hiddens=[], head_fcnet_activation='relu', head_fcnet_kernel_initializer=None, head_fcnet_kernel_initializer_kwargs=None, head_fcnet_bias_initializer=None, head_fcnet_bias_initializer_kwargs=None, free_log_std=False, log_std_clip_param=20.0, vf_share_layers=True, use_lstm=False, max_seq_len=20, lstm_cell_size=256, lstm_use_prev_action=False, lstm_use_prev_reward=False, lstm_kernel_initializer=None, lstm_kernel_initializer_kwargs=None, lstm_bias_initializer=None, lstm_bias_initializer_kwargs=None), catalog_class=None, load_state_path=None, model_config_dict=None)", "algorithm_config_overrides_per_module": {}, "_per_module_overrides": {}, "_validate_config": true, "_use_msgpack_checkpoints": false, "_torch_grad_scaler_class": null, "_torch_lr_scheduler_classes": null, "_tf_policy_handles_more_than_one_loss": false, "_disable_preprocessor_api": false, "_disable_action_flattening": false, "_disable_initialize_loss_from_dummy_batch": false, "_dont_auto_sync_env_runner_states": false, "env_task_fn": -1, "enable_connectors": -1, "simple_optimizer": false, "policy_map_cache": -1, "worker_cls": -1, "synchronize_filters": -1, "enable_async_evaluation": -1, "custom_async_evaluation_function": -1, "_enable_rl_module_api": -1, "auto_wrap_old_gym_envs": -1, "always_attach_evaluation_results": -1, "replay_sequence_length": null, "_disable_execution_plan_api": -1, "use_critic": true, "use_gae": true, "use_kl_loss": true, "kl_coeff": 0.7464963036515, "kl_target": 0.0270990929592, "vf_loss_coeff": 0.6688075857018, "entropy_coeff": 0.0090570820258, "clip_param": 0.1221781641624, "vf_clip_param": 0.1027808522125, "entropy_coeff_schedule": null, "lr_schedule": null, "sgd_minibatch_size": -1, "vf_share_layers": -1, "__stdout_file__": null, "__stderr_file__": null, "lambda": 0.9099046732075, "input": "sampler", "policies": {"default_policy": [null, null, null, null]}, "callbacks": "<class 'ray.rllib.callbacks.callbacks.RLlibCallback'>", "create_env_on_driver": false, "custom_eval_function": null, "framework": "torch"}, "time_since_restore": 30.758559465408325, "iterations_since_restore": 2, "perf": {"cpu_util_percent": 99.4375, "ram_util_percent": 81.9125}}
{"timers": {"training_iteration": 17.21986570060592, "restore_env_runners": 0.00011882015805458649, "training_step": 17.219309230871268, "env_runner_sampling_timer": 16.53755859385669, "learner_update_timer": 0.6709354567854665, "synch_weights": 0.001739394224737771, "restore_eval_env_runners": 3.3223257632926105e-05, "evaluation_iteration": 1.1340862587245648, "synch_eval_env_connectors": 0.000496567819500342, "synch_env_connectors": 9.05218068510294e-06}, "env_runners": {"episode_return_min": -10.5, "num_agent_steps_sampled_lifetime": {"default_agent": -607500.0}, "module_to_env_connector": {"timers": {"connectors": {"remove_single_ts_time_rank_from_batch": 2.5457903407543726e-06, "normalize_and_clip_actions": 4.637169660281776e-05, "listify_data_for_vector_env": 6.101403928379508e-05, "get_actions": 0.00030670892550535057, "tensor_to_numpy": 0.0001062889147977355, "un_batch_to_individual_items": 2.644802612659639e-05}}, "connector_pipeline_timer": 0.0006652064214191433}, "episode_len_mean": 20.0, "num_module_steps_sampled": {"default_policy": 5000.0}, "env_to_module_connector": {"timers": {"connectors": {"add_states_from_episodes_to_batch": 6.754603409529948e-06, "add_time_dim_to_batch_and_zero_pad": 1.6248714007320317e-05, "numpy_to_tensor": 6.7600228920685e-05, "add_observations_from_episodes_to_batch": 1.379633944416887e-05, "batch_individual_items": 3.396996181462267e-05}}, "connector_pipeline_timer": 0.0002256235263035884}, "sample": 0.03294767959340782, "env_to_module_sum_episodes_length_out": 10.36823839457432, "weights_seq_no": 2.0, "num_env_steps_sampled_lifetime": -607500.0, "episode_return_max": 9.5, "episode_return_mean": -1.1400000000000001, "module_episode_returns_mean": {"default_policy": -1.1400000000000001}, "time_between_sampling": 0.008944446890909145, "rlmodule_inference_timer": 0.00020362964218071058, "env_step_timer": 9.320631913504368e-05, "env_reset_timer": 0.00019886855145830214, "agent_episode_returns_mean": {"default_agent": -1.1400000000000001}, "num_env_steps_sampled": 5000.0, "episode_duration_sec_mean": 0.02830527219641954, "env_to_module_sum_episodes_length_in": 10.36823839457432, "episode_len_min": 20, "num_agent_steps_sampled": {"default_agent": 5000.0}, "num_episodes": 250.0, "num_module_steps_sampled_lifetime": {"default_policy": -607500.0}, "episode_len_max": 20, "num_episodes_lifetime": -30375.0, "num_env_steps_sampled_lifetime_throughput": 988.7961380376887}, "learners": {"__all_modules__": {"learner_connector": {"timers": {"connectors": {"general_advantage_estimation": 0.0669444853791967, "numpy_to_tensor": 0.0006649176705628633, "add_observations_from_episodes_to_batch": 0.004495572875416838, "add_one_ts_to_episodes_and_truncate": 0.028436571321228985, "batch_individual_items": 0.10852752620230893, "add_states_from_episodes_to_batch": 5.34406570950523e-06, "add_columns_from_episodes_to_train_batch": 0.1926946890719817, "add_time_dim_to_batch_and_zero_pad": 1.791553441435099e-05}}, "connector_pipeline_timer": 0.40232734204434095}, "num_module_steps_trained_lifetime": 18000, "num_non_trainable_parameters": 0, "learner_connector_sum_episodes_length_out": 5250.0, "num_module_steps_trained": 6000, "num_trainable_parameters": 6003, "num_env_steps_trained": 31500, "num_env_steps_trained_lifetime": 94500, "learner_connector_sum_episodes_length_in": 5000.0, "num_env_steps_trained_lifetime_throughput": 223016.96310408507, "num_module_steps_trained_throughput": 42568.530030078764, "num_module_steps_trained_lifetime_throughput": 42558.86502787118}, "default_policy": {"curr_kl_coeff": 0.09331203997135162, "entropy": 0.6914566159248352, "vf_loss": 0.10278083384037018, "default_optimizer_learning_rate": 0.0002847858517, "vf_explained_var": -0.010045528411865234, "total_loss": 0.05550922453403473, "num_trainable_parameters": 6003, "vf_loss_unclipped": 28.677812576293945, "curr_entropy_coeff": 0.0090570820258, "policy_loss": -0.007170871365815401, "diff_num_grad_updates_vs_sampler_policy": 1.0, "mean_kl_loss": 0.0010828013764694333, "gradients_default_optimizer_global_norm": 0.03816163167357445, "num_module_steps_trained_lifetime": 18000, "weights_seq_no": 3.0, "num_module_steps_trained": 6000, "module_train_batch_size_mean": 1000.0, "num_module_steps_trained_lifetime_throughput": 42533.87958444214}}, "num_training_step_calls_per_iteration": 1, "evaluation": {"env_runners": {"env_to_module_connector": {"timers": {"connectors": {"add_states_from_episodes_to_batch": 2.437039582999072e-06, "numpy_to_tensor": 1.9712054868691124e-05, "add_time_dim_to_batch_and_zero_pad": 6.272164584406284e-06, "add_observations_from_episodes_to_batch": 5.197897422256256e-06, "batch_individual_items": 1.2719080449498354e-05}}, "connector_pipeline_timer": 8.090568513983488e-05}, "agent_episode_returns_mean": {"default_agent": -0.21666666666666667}, "num_agent_steps_sampled": {"default_agent": 400}, "num_env_steps_sampled_lifetime": 15400, "num_env_steps_sampled": 400, "num_episodes": 20, "episode_len_max": 20, "episode_return_min": -14.5, "episode_len_mean": 20.0, "env_to_module_sum_episodes_length_out": 10.368205581254823, "num_module_steps_sampled_lifetime": {"default_policy": 1200}, "num_agent_steps_sampled_lifetime": {"default_agent": 1200}, "module_to_env_connector": {"timers": {"connectors": {"get_actions": 9.653927581373847e-05, "normalize_and_clip_actions": 1.701329108340853e-05, "tensor_to_numpy": 2.6517878452007788e-05, "remove_single_ts_time_rank_from_batch": 9.684107354138842e-07, "listify_data_for_vector_env": 2.1728423812259778e-05, "un_batch_to_individual_items": 9.66722157942053e-06}}, "connector_pipeline_timer": 0.00021866863251926923}, "episode_return_mean": -0.21666666666666667, "env_reset_timer": 0.004663736058503855, "module_episode_returns_mean": {"default_policy": -0.21666666666666667}, "num_episodes_lifetime": 60, "sample": 1.0721757548272608, "num_module_steps_sampled": {"default_policy": 400}, "env_step_timer": 3.145562105539934e-05, "episode_duration_sec_mean": 0.027786510404742632, "env_to_module_sum_episodes_length_in": 10.368205581254823, "episode_len_min": 20, "weights_seq_no": 3.0, "episode_return_max": 13.5, "rlmodule_inference_timer": 6.584609468917093e-05, "time_between_sampling": 11.842857109599281}, "num_healthy_workers": 1, "actor_manager_num_outstanding_async_reqs": 0, "num_remote_worker_restarts": 0}, "num_env_steps_sampled_lifetime": -607500.0, "fault_tolerance": {"num_healthy_workers": 0, "num_remote_worker_restarts": 0}, "env_runner_group": {"actor_manager_num_outstanding_async_reqs": 0}, "done": false, "training_iteration": 3, "trial_id": "4d8e6_00000", "date": "2025-08-11_19-28-41", "timestamp": 1754933321, "time_this_iter_s": 8.7185640335083, "time_total_s": 39.477123498916626, "pid": 19818, "hostname": "Mac", "node_ip": "127.0.0.1", "config": {"exploration_config": {}, "extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "placement_strategy": "PACK", "num_gpus": 0, "_fake_gpus": false, "num_cpus_for_main_process": 2, "eager_tracing": true, "eager_max_retraces": 20, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "torch_compile_learner": false, "torch_compile_learner_what_to_compile": "forward_train", "torch_compile_learner_dynamo_backend": "aot_eager", "torch_compile_learner_dynamo_mode": null, "torch_compile_worker": false, "torch_compile_worker_dynamo_backend": "aot_eager", "torch_compile_worker_dynamo_mode": null, "torch_ddp_kwargs": {}, "torch_skip_nan_gradients": false, "env": "Umbrella", "env_config": {}, "observation_space": null, "action_space": null, "clip_rewards": null, "normalize_actions": true, "clip_actions": false, "_is_atari": null, "disable_env_checking": false, "render_env": false, "action_mask_key": "action_mask", "env_runner_cls": null, "num_env_runners": 0, "create_local_env_runner": true, "num_envs_per_env_runner": 1, "gym_env_vectorize_mode": "SYNC", "num_cpus_per_env_runner": 1, "num_gpus_per_env_runner": 0, "custom_resources_per_env_runner": {}, "validate_env_runners_after_construction": true, "episodes_to_numpy": true, "max_requests_in_flight_per_env_runner": 1, "sample_timeout_s": 60.0, "_env_to_module_connector": null, "add_default_connectors_to_env_to_module_pipeline": true, "_module_to_env_connector": null, "add_default_connectors_to_module_to_env_pipeline": true, "merge_env_runner_states": "training_only", "broadcast_env_runner_states": true, "episode_lookback_horizon": 1, "rollout_fragment_length": "auto", "batch_mode": "complete_episodes", "compress_observations": false, "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "enable_tf1_exec_eagerly": false, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "preprocessor_pref": "deepmind", "observation_filter": "NoFilter", "update_worker_filter_stats": true, "use_worker_filter_stats": true, "sampler_perf_stats_ema_coef": null, "_is_online": true, "num_learners": 0, "num_gpus_per_learner": 0, "num_cpus_per_learner": "auto", "num_aggregator_actors_per_learner": 0, "max_requests_in_flight_per_aggregator_actor": 3, "local_gpu_idx": 0, "max_requests_in_flight_per_learner": 3, "gamma": 1, "lr": 0.0002847858517, "grad_clip": 0.5, "grad_clip_by": "global_norm", "_train_batch_size_per_learner": 5000, "train_batch_size": 4000, "num_epochs": 1, "minibatch_size": 1000, "shuffle_batch_per_epoch": true, "model": {"fcnet_hiddens": [256, 256], "fcnet_activation": "tanh", "fcnet_weights_initializer": null, "fcnet_weights_initializer_config": null, "fcnet_bias_initializer": null, "fcnet_bias_initializer_config": null, "conv_filters": null, "conv_activation": "relu", "conv_kernel_initializer": null, "conv_kernel_initializer_config": null, "conv_bias_initializer": null, "conv_bias_initializer_config": null, "conv_transpose_kernel_initializer": null, "conv_transpose_kernel_initializer_config": null, "conv_transpose_bias_initializer": null, "conv_transpose_bias_initializer_config": null, "post_fcnet_hiddens": [], "post_fcnet_activation": "relu", "post_fcnet_weights_initializer": null, "post_fcnet_weights_initializer_config": null, "post_fcnet_bias_initializer": null, "post_fcnet_bias_initializer_config": null, "free_log_std": false, "log_std_clip_param": 20.0, "no_final_linear": false, "vf_share_layers": false, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "lstm_weights_initializer": null, "lstm_weights_initializer_config": null, "lstm_bias_initializer": null, "lstm_bias_initializer_config": null, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "attention_use_n_prev_actions": 0, "attention_use_n_prev_rewards": 0, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": null, "custom_model_config": {}, "custom_action_dist": null, "custom_preprocessor": null, "encoder_latent_dim": null, "always_check_shapes": false, "lstm_use_prev_action_reward": -1, "_use_default_native_models": -1, "_disable_preprocessor_api": false, "_disable_action_flattening": false}, "_learner_connector": null, "add_default_connectors_to_learner_pipeline": true, "learner_config_dict": {}, "optimizer": {}, "_learner_class": null, "callbacks_on_algorithm_init": null, "callbacks_on_env_runners_recreated": null, "callbacks_on_offline_eval_runners_recreated": null, "callbacks_on_checkpoint_loaded": null, "callbacks_on_environment_created": null, "callbacks_on_episode_created": null, "callbacks_on_episode_start": null, "callbacks_on_episode_step": null, "callbacks_on_episode_end": null, "callbacks_on_evaluate_start": null, "callbacks_on_evaluate_end": null, "callbacks_on_evaluate_offline_start": null, "callbacks_on_evaluate_offline_end": null, "callbacks_on_sample_end": null, "callbacks_on_train_result": null, "explore": true, "enable_rl_module_and_learner": true, "enable_env_runner_and_connector_v2": true, "_prior_exploration_config": {"type": "StochasticSampling"}, "count_steps_by": "env_steps", "policy_map_capacity": 100, "policy_mapping_fn": "<function AlgorithmConfig.DEFAULT_POLICY_MAPPING_FN at 0x161a518a0>", "policies_to_train": null, "policy_states_are_swappable": false, "observation_fn": null, "offline_data_class": null, "input_read_method": "read_parquet", "input_read_method_kwargs": {}, "input_read_schema": {}, "input_read_episodes": false, "input_read_sample_batches": false, "input_read_batch_size": null, "input_filesystem": null, "input_filesystem_kwargs": {}, "input_compress_columns": ["obs", "new_obs"], "input_spaces_jsonable": true, "materialize_data": false, "materialize_mapped_data": true, "map_batches_kwargs": {}, "iter_batches_kwargs": {}, "ignore_final_observation": false, "prelearner_class": null, "prelearner_buffer_class": null, "prelearner_buffer_kwargs": {}, "prelearner_module_synch_period": 10, "dataset_num_iters_per_learner": null, "input_config": {}, "actions_in_input_normalized": false, "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_config": {}, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "output_max_rows_per_file": null, "output_write_remaining_data": false, "output_write_method": "write_parquet", "output_write_method_kwargs": {}, "output_filesystem": null, "output_filesystem_kwargs": {}, "output_write_episodes": true, "offline_sampling": false, "evaluation_interval": 1, "evaluation_duration": 20, "evaluation_duration_unit": "episodes", "evaluation_sample_timeout_s": 120.0, "evaluation_auto_duration_min_env_steps_per_sample": 100, "evaluation_auto_duration_max_env_steps_per_sample": 2000, "evaluation_parallel_to_training": false, "evaluation_force_reset_envs_before_iteration": true, "evaluation_config": null, "off_policy_estimation_methods": {}, "ope_split_batch_by_episode": true, "evaluation_num_env_runners": 1, "in_evaluation": false, "sync_filters_on_rollout_workers_timeout_s": 10.0, "offline_evaluation_interval": null, "num_offline_eval_runners": 0, "offline_loss_for_module_fn": null, "offline_evaluation_duration": 1, "offline_evaluation_parallel_to_training": false, "offline_evaluation_timeout_s": 120.0, "num_cpus_per_offline_eval_runner": 1, "num_gpus_per_offline_eval_runner": 0, "custom_resources_per_offline_eval_runner": {}, "restart_failed_offline_eval_runners": true, "ignore_offline_eval_runner_failures": false, "max_num_offline_eval_runner_restarts": 1000, "offline_eval_runner_restore_timeout_s": 1800.0, "max_requests_in_flight_per_offline_eval_runner": 1, "validate_offline_eval_runners_after_construction": true, "offline_eval_runner_health_probe_timeout_s": 30.0, "offline_eval_rl_module_inference_only": false, "broadcast_offline_eval_runner_states": false, "offline_eval_batch_size_per_runner": 256, "dataset_num_iters_per_eval_runner": 1, "keep_per_episode_custom_metrics": false, "metrics_episode_collection_timeout_s": 60.0, "metrics_num_episodes_for_smoothing": 100, "min_time_s_per_iteration": null, "min_train_timesteps_per_iteration": 0, "min_sample_timesteps_per_iteration": 0, "log_gradients": true, "export_native_model_files": false, "checkpoint_trainable_policies_only": false, "logger_creator": null, "logger_config": null, "log_level": "WARN", "log_sys_usage": true, "fake_sampler": false, "seed": 10, "restart_failed_env_runners": true, "ignore_env_runner_failures": false, "max_num_env_runner_restarts": 1000, "delay_between_env_runner_restarts_s": 60.0, "restart_failed_sub_environments": false, "num_consecutive_env_runner_failures_tolerance": 100, "env_runner_health_probe_timeout_s": 30.0, "env_runner_restore_timeout_s": 1800.0, "_model_config": {}, "_rl_module_spec": "RLModuleSpec(module_class=None, observation_space=None, action_space=None, inference_only=False, learner_only=False, model_config=DefaultModelConfig(fcnet_hiddens=[60, 90], fcnet_activation='tanh', fcnet_kernel_initializer=None, fcnet_kernel_initializer_kwargs=None, fcnet_bias_initializer=None, fcnet_bias_initializer_kwargs=None, conv_filters=None, conv_activation='relu', conv_kernel_initializer=None, conv_kernel_initializer_kwargs=None, conv_bias_initializer=None, conv_bias_initializer_kwargs=None, head_fcnet_hiddens=[], head_fcnet_activation='relu', head_fcnet_kernel_initializer=None, head_fcnet_kernel_initializer_kwargs=None, head_fcnet_bias_initializer=None, head_fcnet_bias_initializer_kwargs=None, free_log_std=False, log_std_clip_param=20.0, vf_share_layers=True, use_lstm=False, max_seq_len=20, lstm_cell_size=256, lstm_use_prev_action=False, lstm_use_prev_reward=False, lstm_kernel_initializer=None, lstm_kernel_initializer_kwargs=None, lstm_bias_initializer=None, lstm_bias_initializer_kwargs=None), catalog_class=None, load_state_path=None, model_config_dict=None)", "algorithm_config_overrides_per_module": {}, "_per_module_overrides": {}, "_validate_config": true, "_use_msgpack_checkpoints": false, "_torch_grad_scaler_class": null, "_torch_lr_scheduler_classes": null, "_tf_policy_handles_more_than_one_loss": false, "_disable_preprocessor_api": false, "_disable_action_flattening": false, "_disable_initialize_loss_from_dummy_batch": false, "_dont_auto_sync_env_runner_states": false, "env_task_fn": -1, "enable_connectors": -1, "simple_optimizer": false, "policy_map_cache": -1, "worker_cls": -1, "synchronize_filters": -1, "enable_async_evaluation": -1, "custom_async_evaluation_function": -1, "_enable_rl_module_api": -1, "auto_wrap_old_gym_envs": -1, "always_attach_evaluation_results": -1, "replay_sequence_length": null, "_disable_execution_plan_api": -1, "use_critic": true, "use_gae": true, "use_kl_loss": true, "kl_coeff": 0.7464963036515, "kl_target": 0.0270990929592, "vf_loss_coeff": 0.6688075857018, "entropy_coeff": 0.0090570820258, "clip_param": 0.1221781641624, "vf_clip_param": 0.1027808522125, "entropy_coeff_schedule": null, "lr_schedule": null, "sgd_minibatch_size": -1, "vf_share_layers": -1, "__stdout_file__": null, "__stderr_file__": null, "lambda": 0.9099046732075, "input": "sampler", "policies": {"default_policy": [null, null, null, null]}, "callbacks": "<class 'ray.rllib.callbacks.callbacks.RLlibCallback'>", "create_env_on_driver": false, "custom_eval_function": null, "framework": "torch"}, "time_since_restore": 39.477123498916626, "iterations_since_restore": 3, "perf": {"cpu_util_percent": 97.34615384615383, "ram_util_percent": 78.55384615384615}}
{"timers": {"training_iteration": 17.091289507769606, "restore_env_runners": 0.00011778986687317954, "training_step": 17.090735204812365, "env_runner_sampling_timer": 16.413607964167664, "learner_update_timer": 0.6662682947176964, "synch_weights": 0.001758961122715613, "restore_eval_env_runners": 3.56426956015639e-05, "evaluation_iteration": 1.125861564467044, "synch_eval_env_connectors": 0.0004956246410845778, "synch_env_connectors": 9.065829636529088e-06}, "env_runners": {"episode_return_min": -10.5, "num_agent_steps_sampled_lifetime": {"default_agent": -1225000.0}, "module_to_env_connector": {"timers": {"connectors": {"remove_single_ts_time_rank_from_batch": 1.6711363458124488e-06, "normalize_and_clip_actions": 2.4118035543175362e-05, "listify_data_for_vector_env": 2.943499593333141e-05, "get_actions": 0.00014522771072175879, "tensor_to_numpy": 4.095506589849248e-05, "un_batch_to_individual_items": 1.3064687022892644e-05}}, "connector_pipeline_timer": 0.0003191072357895342}, "episode_len_mean": 20.0, "num_module_steps_sampled": {"default_policy": 5000.0}, "env_to_module_connector": {"timers": {"connectors": {"add_states_from_episodes_to_batch": 3.591444259175948e-06, "add_time_dim_to_batch_and_zero_pad": 7.030051110113813e-06, "numpy_to_tensor": 2.9749878318899235e-05, "add_observations_from_episodes_to_batch": 1.0410708150866948e-05, "batch_individual_items": 1.9395933969118075e-05}}, "connector_pipeline_timer": 0.000119785349564514}, "sample": 0.019193036663695012, "env_to_module_sum_episodes_length_out": 10.36823839457432, "weights_seq_no": 3.0, "num_env_steps_sampled_lifetime": -1225000.0, "episode_return_max": 9.5, "episode_return_mean": -0.3400000000000001, "module_episode_returns_mean": {"default_policy": -0.3400000000000001}, "time_between_sampling": 0.005531592344721878, "rlmodule_inference_timer": 8.965837483638266e-05, "env_step_timer": 4.778282489187779e-05, "env_reset_timer": 0.0001485076641955118, "agent_episode_returns_mean": {"default_agent": -0.3400000000000001}, "num_env_steps_sampled": 5000.0, "episode_duration_sec_mean": 0.013489957854617391, "env_to_module_sum_episodes_length_in": 10.36823839457432, "episode_len_min": 20, "num_agent_steps_sampled": {"default_agent": 5000.0}, "num_episodes": 250.0, "num_module_steps_sampled_lifetime": {"default_policy": -1225000.0}, "episode_len_max": 20, "num_episodes_lifetime": -61250.0, "num_env_steps_sampled_lifetime_throughput": 1665.6391205460989}, "learners": {"__all_modules__": {"learner_connector": {"timers": {"connectors": {"general_advantage_estimation": 0.06640017636532149, "numpy_to_tensor": 0.0006605701633039862, "add_observations_from_episodes_to_batch": 0.004467510476692813, "add_one_ts_to_episodes_and_truncate": 0.028282261027884555, "batch_individual_items": 0.1082169163604623, "add_states_from_episodes_to_batch": 5.4268752167699855e-06, "add_columns_from_episodes_to_train_batch": 0.1911835267616621, "add_time_dim_to_batch_and_zero_pad": 1.846345911175013e-05}}, "connector_pipeline_timer": 0.3997722348741674}, "num_module_steps_trained_lifetime": 24000, "num_non_trainable_parameters": 0, "learner_connector_sum_episodes_length_out": 5250.0, "num_module_steps_trained": 6000, "num_trainable_parameters": 6003, "num_env_steps_trained": 31500, "num_env_steps_trained_lifetime": 126000, "learner_connector_sum_episodes_length_in": 5000.0, "num_env_steps_trained_lifetime_throughput": 234021.31957397875, "num_module_steps_trained_throughput": 44664.42564671796, "num_module_steps_trained_lifetime_throughput": 44653.57586786109}, "default_policy": {"curr_kl_coeff": 0.04665601998567581, "entropy": 0.6889801025390625, "vf_loss": 0.10278083384037018, "default_optimizer_learning_rate": 0.0002847858517, "vf_explained_var": -0.010156989097595215, "total_loss": 0.10854453593492508, "num_trainable_parameters": 6003, "vf_loss_unclipped": 28.70688247680664, "curr_entropy_coeff": 0.0090570820258, "policy_loss": 0.04596720635890961, "diff_num_grad_updates_vs_sampler_policy": 1.0, "mean_kl_loss": 0.0008237484726123512, "gradients_default_optimizer_global_norm": 0.021336890757083893, "num_module_steps_trained_lifetime": 24000, "weights_seq_no": 4.0, "num_module_steps_trained": 6000, "module_train_batch_size_mean": 1000.0, "num_module_steps_trained_lifetime_throughput": 44623.36046062099}}, "num_training_step_calls_per_iteration": 1, "evaluation": {"env_runners": {"env_to_module_connector": {"timers": {"connectors": {"add_states_from_episodes_to_batch": 3.140161914028352e-06, "numpy_to_tensor": 2.8601506330607375e-05, "add_time_dim_to_batch_and_zero_pad": 6.565410936378514e-06, "add_observations_from_episodes_to_batch": 6.1773380634766185e-06, "batch_individual_items": 1.553683548229949e-05}}, "connector_pipeline_timer": 0.00010277369613714889}, "agent_episode_returns_mean": {"default_agent": -0.05}, "num_agent_steps_sampled": {"default_agent": 400}, "num_env_steps_sampled_lifetime": 20400, "num_env_steps_sampled": 400, "num_episodes": 20, "episode_len_max": 20, "episode_return_min": -14.5, "episode_len_mean": 20.0, "env_to_module_sum_episodes_length_out": 10.368237912813044, "num_module_steps_sampled_lifetime": {"default_policy": 1600}, "num_agent_steps_sampled_lifetime": {"default_agent": 1600}, "module_to_env_connector": {"timers": {"connectors": {"get_actions": 0.00011401809598828968, "normalize_and_clip_actions": 2.1016615327577537e-05, "tensor_to_numpy": 3.794429927584566e-05, "remove_single_ts_time_rank_from_batch": 2.5892165099945062e-06, "listify_data_for_vector_env": 2.7270985949984492e-05, "un_batch_to_individual_items": 1.2663877450973233e-05}}, "connector_pipeline_timer": 0.00027114833357009876}, "episode_return_mean": -0.05, "env_reset_timer": 0.004619008287546574, "module_episode_returns_mean": {"default_policy": -0.05}, "num_episodes_lifetime": 80, "sample": 1.0643447914490773, "num_module_steps_sampled": {"default_policy": 400}, "env_step_timer": 3.7912837112136397e-05, "episode_duration_sec_mean": 0.02413387134874938, "env_to_module_sum_episodes_length_in": 10.368237912813044, "episode_len_min": 20, "weights_seq_no": 4.0, "episode_return_max": 13.5, "rlmodule_inference_timer": 7.579176439658035e-05, "time_between_sampling": 11.768997654332942}, "num_healthy_workers": 1, "actor_manager_num_outstanding_async_reqs": 0, "num_remote_worker_restarts": 0}, "num_env_steps_sampled_lifetime": -1225000.0, "fault_tolerance": {"num_healthy_workers": 0, "num_remote_worker_restarts": 0}, "env_runner_group": {"actor_manager_num_outstanding_async_reqs": 0}, "done": false, "training_iteration": 4, "trial_id": "4d8e6_00000", "date": "2025-08-11_19-28-45", "timestamp": 1754933325, "time_this_iter_s": 4.673108816146851, "time_total_s": 44.15023231506348, "pid": 19818, "hostname": "Mac", "node_ip": "127.0.0.1", "config": {"exploration_config": {}, "extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "placement_strategy": "PACK", "num_gpus": 0, "_fake_gpus": false, "num_cpus_for_main_process": 2, "eager_tracing": true, "eager_max_retraces": 20, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "torch_compile_learner": false, "torch_compile_learner_what_to_compile": "forward_train", "torch_compile_learner_dynamo_backend": "aot_eager", "torch_compile_learner_dynamo_mode": null, "torch_compile_worker": false, "torch_compile_worker_dynamo_backend": "aot_eager", "torch_compile_worker_dynamo_mode": null, "torch_ddp_kwargs": {}, "torch_skip_nan_gradients": false, "env": "Umbrella", "env_config": {}, "observation_space": null, "action_space": null, "clip_rewards": null, "normalize_actions": true, "clip_actions": false, "_is_atari": null, "disable_env_checking": false, "render_env": false, "action_mask_key": "action_mask", "env_runner_cls": null, "num_env_runners": 0, "create_local_env_runner": true, "num_envs_per_env_runner": 1, "gym_env_vectorize_mode": "SYNC", "num_cpus_per_env_runner": 1, "num_gpus_per_env_runner": 0, "custom_resources_per_env_runner": {}, "validate_env_runners_after_construction": true, "episodes_to_numpy": true, "max_requests_in_flight_per_env_runner": 1, "sample_timeout_s": 60.0, "_env_to_module_connector": null, "add_default_connectors_to_env_to_module_pipeline": true, "_module_to_env_connector": null, "add_default_connectors_to_module_to_env_pipeline": true, "merge_env_runner_states": "training_only", "broadcast_env_runner_states": true, "episode_lookback_horizon": 1, "rollout_fragment_length": "auto", "batch_mode": "complete_episodes", "compress_observations": false, "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "enable_tf1_exec_eagerly": false, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "preprocessor_pref": "deepmind", "observation_filter": "NoFilter", "update_worker_filter_stats": true, "use_worker_filter_stats": true, "sampler_perf_stats_ema_coef": null, "_is_online": true, "num_learners": 0, "num_gpus_per_learner": 0, "num_cpus_per_learner": "auto", "num_aggregator_actors_per_learner": 0, "max_requests_in_flight_per_aggregator_actor": 3, "local_gpu_idx": 0, "max_requests_in_flight_per_learner": 3, "gamma": 1, "lr": 0.0002847858517, "grad_clip": 0.5, "grad_clip_by": "global_norm", "_train_batch_size_per_learner": 5000, "train_batch_size": 4000, "num_epochs": 1, "minibatch_size": 1000, "shuffle_batch_per_epoch": true, "model": {"fcnet_hiddens": [256, 256], "fcnet_activation": "tanh", "fcnet_weights_initializer": null, "fcnet_weights_initializer_config": null, "fcnet_bias_initializer": null, "fcnet_bias_initializer_config": null, "conv_filters": null, "conv_activation": "relu", "conv_kernel_initializer": null, "conv_kernel_initializer_config": null, "conv_bias_initializer": null, "conv_bias_initializer_config": null, "conv_transpose_kernel_initializer": null, "conv_transpose_kernel_initializer_config": null, "conv_transpose_bias_initializer": null, "conv_transpose_bias_initializer_config": null, "post_fcnet_hiddens": [], "post_fcnet_activation": "relu", "post_fcnet_weights_initializer": null, "post_fcnet_weights_initializer_config": null, "post_fcnet_bias_initializer": null, "post_fcnet_bias_initializer_config": null, "free_log_std": false, "log_std_clip_param": 20.0, "no_final_linear": false, "vf_share_layers": false, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "lstm_weights_initializer": null, "lstm_weights_initializer_config": null, "lstm_bias_initializer": null, "lstm_bias_initializer_config": null, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "attention_use_n_prev_actions": 0, "attention_use_n_prev_rewards": 0, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": null, "custom_model_config": {}, "custom_action_dist": null, "custom_preprocessor": null, "encoder_latent_dim": null, "always_check_shapes": false, "lstm_use_prev_action_reward": -1, "_use_default_native_models": -1, "_disable_preprocessor_api": false, "_disable_action_flattening": false}, "_learner_connector": null, "add_default_connectors_to_learner_pipeline": true, "learner_config_dict": {}, "optimizer": {}, "_learner_class": null, "callbacks_on_algorithm_init": null, "callbacks_on_env_runners_recreated": null, "callbacks_on_offline_eval_runners_recreated": null, "callbacks_on_checkpoint_loaded": null, "callbacks_on_environment_created": null, "callbacks_on_episode_created": null, "callbacks_on_episode_start": null, "callbacks_on_episode_step": null, "callbacks_on_episode_end": null, "callbacks_on_evaluate_start": null, "callbacks_on_evaluate_end": null, "callbacks_on_evaluate_offline_start": null, "callbacks_on_evaluate_offline_end": null, "callbacks_on_sample_end": null, "callbacks_on_train_result": null, "explore": true, "enable_rl_module_and_learner": true, "enable_env_runner_and_connector_v2": true, "_prior_exploration_config": {"type": "StochasticSampling"}, "count_steps_by": "env_steps", "policy_map_capacity": 100, "policy_mapping_fn": "<function AlgorithmConfig.DEFAULT_POLICY_MAPPING_FN at 0x161a518a0>", "policies_to_train": null, "policy_states_are_swappable": false, "observation_fn": null, "offline_data_class": null, "input_read_method": "read_parquet", "input_read_method_kwargs": {}, "input_read_schema": {}, "input_read_episodes": false, "input_read_sample_batches": false, "input_read_batch_size": null, "input_filesystem": null, "input_filesystem_kwargs": {}, "input_compress_columns": ["obs", "new_obs"], "input_spaces_jsonable": true, "materialize_data": false, "materialize_mapped_data": true, "map_batches_kwargs": {}, "iter_batches_kwargs": {}, "ignore_final_observation": false, "prelearner_class": null, "prelearner_buffer_class": null, "prelearner_buffer_kwargs": {}, "prelearner_module_synch_period": 10, "dataset_num_iters_per_learner": null, "input_config": {}, "actions_in_input_normalized": false, "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_config": {}, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "output_max_rows_per_file": null, "output_write_remaining_data": false, "output_write_method": "write_parquet", "output_write_method_kwargs": {}, "output_filesystem": null, "output_filesystem_kwargs": {}, "output_write_episodes": true, "offline_sampling": false, "evaluation_interval": 1, "evaluation_duration": 20, "evaluation_duration_unit": "episodes", "evaluation_sample_timeout_s": 120.0, "evaluation_auto_duration_min_env_steps_per_sample": 100, "evaluation_auto_duration_max_env_steps_per_sample": 2000, "evaluation_parallel_to_training": false, "evaluation_force_reset_envs_before_iteration": true, "evaluation_config": null, "off_policy_estimation_methods": {}, "ope_split_batch_by_episode": true, "evaluation_num_env_runners": 1, "in_evaluation": false, "sync_filters_on_rollout_workers_timeout_s": 10.0, "offline_evaluation_interval": null, "num_offline_eval_runners": 0, "offline_loss_for_module_fn": null, "offline_evaluation_duration": 1, "offline_evaluation_parallel_to_training": false, "offline_evaluation_timeout_s": 120.0, "num_cpus_per_offline_eval_runner": 1, "num_gpus_per_offline_eval_runner": 0, "custom_resources_per_offline_eval_runner": {}, "restart_failed_offline_eval_runners": true, "ignore_offline_eval_runner_failures": false, "max_num_offline_eval_runner_restarts": 1000, "offline_eval_runner_restore_timeout_s": 1800.0, "max_requests_in_flight_per_offline_eval_runner": 1, "validate_offline_eval_runners_after_construction": true, "offline_eval_runner_health_probe_timeout_s": 30.0, "offline_eval_rl_module_inference_only": false, "broadcast_offline_eval_runner_states": false, "offline_eval_batch_size_per_runner": 256, "dataset_num_iters_per_eval_runner": 1, "keep_per_episode_custom_metrics": false, "metrics_episode_collection_timeout_s": 60.0, "metrics_num_episodes_for_smoothing": 100, "min_time_s_per_iteration": null, "min_train_timesteps_per_iteration": 0, "min_sample_timesteps_per_iteration": 0, "log_gradients": true, "export_native_model_files": false, "checkpoint_trainable_policies_only": false, "logger_creator": null, "logger_config": null, "log_level": "WARN", "log_sys_usage": true, "fake_sampler": false, "seed": 10, "restart_failed_env_runners": true, "ignore_env_runner_failures": false, "max_num_env_runner_restarts": 1000, "delay_between_env_runner_restarts_s": 60.0, "restart_failed_sub_environments": false, "num_consecutive_env_runner_failures_tolerance": 100, "env_runner_health_probe_timeout_s": 30.0, "env_runner_restore_timeout_s": 1800.0, "_model_config": {}, "_rl_module_spec": "RLModuleSpec(module_class=None, observation_space=None, action_space=None, inference_only=False, learner_only=False, model_config=DefaultModelConfig(fcnet_hiddens=[60, 90], fcnet_activation='tanh', fcnet_kernel_initializer=None, fcnet_kernel_initializer_kwargs=None, fcnet_bias_initializer=None, fcnet_bias_initializer_kwargs=None, conv_filters=None, conv_activation='relu', conv_kernel_initializer=None, conv_kernel_initializer_kwargs=None, conv_bias_initializer=None, conv_bias_initializer_kwargs=None, head_fcnet_hiddens=[], head_fcnet_activation='relu', head_fcnet_kernel_initializer=None, head_fcnet_kernel_initializer_kwargs=None, head_fcnet_bias_initializer=None, head_fcnet_bias_initializer_kwargs=None, free_log_std=False, log_std_clip_param=20.0, vf_share_layers=True, use_lstm=False, max_seq_len=20, lstm_cell_size=256, lstm_use_prev_action=False, lstm_use_prev_reward=False, lstm_kernel_initializer=None, lstm_kernel_initializer_kwargs=None, lstm_bias_initializer=None, lstm_bias_initializer_kwargs=None), catalog_class=None, load_state_path=None, model_config_dict=None)", "algorithm_config_overrides_per_module": {}, "_per_module_overrides": {}, "_validate_config": true, "_use_msgpack_checkpoints": false, "_torch_grad_scaler_class": null, "_torch_lr_scheduler_classes": null, "_tf_policy_handles_more_than_one_loss": false, "_disable_preprocessor_api": false, "_disable_action_flattening": false, "_disable_initialize_loss_from_dummy_batch": false, "_dont_auto_sync_env_runner_states": false, "env_task_fn": -1, "enable_connectors": -1, "simple_optimizer": false, "policy_map_cache": -1, "worker_cls": -1, "synchronize_filters": -1, "enable_async_evaluation": -1, "custom_async_evaluation_function": -1, "_enable_rl_module_api": -1, "auto_wrap_old_gym_envs": -1, "always_attach_evaluation_results": -1, "replay_sequence_length": null, "_disable_execution_plan_api": -1, "use_critic": true, "use_gae": true, "use_kl_loss": true, "kl_coeff": 0.7464963036515, "kl_target": 0.0270990929592, "vf_loss_coeff": 0.6688075857018, "entropy_coeff": 0.0090570820258, "clip_param": 0.1221781641624, "vf_clip_param": 0.1027808522125, "entropy_coeff_schedule": null, "lr_schedule": null, "sgd_minibatch_size": -1, "vf_share_layers": -1, "__stdout_file__": null, "__stderr_file__": null, "lambda": 0.9099046732075, "input": "sampler", "policies": {"default_policy": [null, null, null, null]}, "callbacks": "<class 'ray.rllib.callbacks.callbacks.RLlibCallback'>", "create_env_on_driver": false, "custom_eval_function": null, "framework": "torch"}, "time_since_restore": 44.15023231506348, "iterations_since_restore": 4, "perf": {"cpu_util_percent": 87.31666666666666, "ram_util_percent": 76.91666666666667}}
{"timers": {"training_iteration": 16.964297058521772, "restore_env_runners": 0.00011667237844325018, "training_step": 16.963746381514312, "env_runner_sampling_timer": 16.291113738695998, "learner_update_timer": 0.6618368421908127, "synch_weights": 0.0017537565114975466, "restore_eval_env_runners": 3.54175187718356e-05, "evaluation_iteration": 1.1176574075716215, "synch_eval_env_connectors": 0.000492028394552064, "synch_env_connectors": 9.02767115784809e-06}, "env_runners": {"episode_return_min": -10.5, "num_agent_steps_sampled_lifetime": {"default_agent": -1842500.0}, "module_to_env_connector": {"timers": {"connectors": {"remove_single_ts_time_rank_from_batch": 1.418582061713697e-06, "normalize_and_clip_actions": 2.6136622367500406e-05, "listify_data_for_vector_env": 2.9272525007519426e-05, "get_actions": 0.00013738498460786252, "tensor_to_numpy": 3.697716887895862e-05, "un_batch_to_individual_items": 1.4464838373900738e-05}}, "connector_pipeline_timer": 0.000310262564810618}, "episode_len_mean": 20.0, "num_module_steps_sampled": {"default_policy": 5000.0}, "env_to_module_connector": {"timers": {"connectors": {"add_states_from_episodes_to_batch": 3.968047101555945e-06, "add_time_dim_to_batch_and_zero_pad": 6.469472676845157e-06, "numpy_to_tensor": 2.9206495258249343e-05, "add_observations_from_episodes_to_batch": 7.260115513907828e-06, "batch_individual_items": 1.8580091530432253e-05}}, "connector_pipeline_timer": 0.00011468260748120077}, "sample": 0.014758365703566987, "env_to_module_sum_episodes_length_out": 10.36823839457432, "weights_seq_no": 4.0, "num_env_steps_sampled_lifetime": -1842500.0, "episode_return_max": 9.5, "episode_return_mean": -1.1400000000000001, "module_episode_returns_mean": {"default_policy": -1.1400000000000001}, "time_between_sampling": 0.0038834553352606036, "rlmodule_inference_timer": 0.00013555080756747978, "env_step_timer": 4.527910976700644e-05, "env_reset_timer": 0.00011675702101631135, "agent_episode_returns_mean": {"default_agent": -1.1400000000000001}, "num_env_steps_sampled": 5000.0, "episode_duration_sec_mean": 0.014384090174920861, "env_to_module_sum_episodes_length_in": 10.36823839457432, "episode_len_min": 20, "num_agent_steps_sampled": {"default_agent": 5000.0}, "num_episodes": 250.0, "num_module_steps_sampled_lifetime": {"default_policy": -1842500.0}, "episode_len_max": 20, "num_episodes_lifetime": -92125.0, "num_env_steps_sampled_lifetime_throughput": 1783.3820402808026}, "learners": {"__all_modules__": {"learner_connector": {"timers": {"connectors": {"general_advantage_estimation": 0.06589665376192681, "numpy_to_tensor": 0.0006546236215212754, "add_observations_from_episodes_to_batch": 0.00443092704122273, "add_one_ts_to_episodes_and_truncate": 0.02808172466815042, "batch_individual_items": 0.10777406844676737, "add_states_from_episodes_to_batch": 5.413015386961633e-06, "add_columns_from_episodes_to_train_batch": 0.1901594064933077, "add_time_dim_to_batch_and_zero_pad": 1.8410074646919967e-05}}, "connector_pipeline_timer": 0.3975559225252471}, "num_module_steps_trained_lifetime": 30000, "num_non_trainable_parameters": 0, "learner_connector_sum_episodes_length_out": 5250.0, "num_module_steps_trained": 6000, "num_trainable_parameters": 6003, "num_env_steps_trained": 31500, "num_env_steps_trained_lifetime": 157500, "learner_connector_sum_episodes_length_in": 5000.0, "num_env_steps_trained_lifetime_throughput": 248822.48488731185, "num_module_steps_trained_throughput": 47480.18517321074, "num_module_steps_trained_lifetime_throughput": 47469.056337465336}, "default_policy": {"curr_kl_coeff": 0.023328009992837906, "entropy": 0.6833857297897339, "vf_loss": 0.10278083384037018, "default_optimizer_learning_rate": 0.0002847858517, "vf_explained_var": -0.010284781455993652, "total_loss": 0.05677541345357895, "num_trainable_parameters": 6003, "vf_loss_unclipped": 28.676191329956055, "curr_entropy_coeff": 0.0090570820258, "policy_loss": -0.005832438822835684, "diff_num_grad_updates_vs_sampler_policy": 1.0, "mean_kl_loss": 0.0012158984318375587, "gradients_default_optimizer_global_norm": 0.02561800181865692, "num_module_steps_trained_lifetime": 30000, "weights_seq_no": 5.0, "num_module_steps_trained": 6000, "module_train_batch_size_mean": 1000.0, "num_module_steps_trained_lifetime_throughput": 47431.91026568515}}, "num_training_step_calls_per_iteration": 1, "evaluation": {"env_runners": {"env_to_module_connector": {"timers": {"connectors": {"add_states_from_episodes_to_batch": 3.1289817249543345e-06, "numpy_to_tensor": 2.122746800854878e-05, "add_time_dim_to_batch_and_zero_pad": 6.8711275726514545e-06, "add_observations_from_episodes_to_batch": 6.562906124261644e-06, "batch_individual_items": 1.5645324754046005e-05}}, "connector_pipeline_timer": 0.00010557428700443193}, "agent_episode_returns_mean": {"default_agent": -0.35}, "num_agent_steps_sampled": {"default_agent": 400}, "num_env_steps_sampled_lifetime": 25400, "num_env_steps_sampled": 400, "num_episodes": 20, "episode_len_max": 20, "episode_return_min": -14.5, "episode_len_mean": 20.0, "env_to_module_sum_episodes_length_out": 10.368238387501162, "num_module_steps_sampled_lifetime": {"default_policy": 2000}, "num_agent_steps_sampled_lifetime": {"default_agent": 2000}, "module_to_env_connector": {"timers": {"connectors": {"get_actions": 9.707079647031814e-05, "normalize_and_clip_actions": 2.549169779542156e-05, "tensor_to_numpy": 3.7633703085073394e-05, "remove_single_ts_time_rank_from_batch": 1.1777661258173394e-06, "listify_data_for_vector_env": 2.432992109769813e-05, "un_batch_to_individual_items": 1.2067995854609606e-05}}, "connector_pipeline_timer": 0.0002521727865306881}, "episode_return_mean": -0.35, "env_reset_timer": 0.004574744874754884, "module_episode_returns_mean": {"default_policy": -0.35}, "num_episodes_lifetime": 100, "sample": 1.0560725135338285, "num_module_steps_sampled": {"default_policy": 400}, "env_step_timer": 3.4029384634413054e-05, "episode_duration_sec_mean": 0.02151295333984308, "env_to_module_sum_episodes_length_in": 10.368238387501162, "episode_len_min": 20, "weights_seq_no": 5.0, "episode_return_max": 13.5, "rlmodule_inference_timer": 6.490356804785876e-05, "time_between_sampling": 11.695538249459371}, "num_healthy_workers": 1, "actor_manager_num_outstanding_async_reqs": 0, "num_remote_worker_restarts": 0}, "num_env_steps_sampled_lifetime": -1842500.0, "fault_tolerance": {"num_healthy_workers": 0, "num_remote_worker_restarts": 0}, "env_runner_group": {"actor_manager_num_outstanding_async_reqs": 0}, "done": false, "training_iteration": 5, "trial_id": "4d8e6_00000", "date": "2025-08-11_19-28-50", "timestamp": 1754933330, "time_this_iter_s": 4.641869783401489, "time_total_s": 48.792102098464966, "pid": 19818, "hostname": "Mac", "node_ip": "127.0.0.1", "config": {"exploration_config": {}, "extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "placement_strategy": "PACK", "num_gpus": 0, "_fake_gpus": false, "num_cpus_for_main_process": 2, "eager_tracing": true, "eager_max_retraces": 20, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "torch_compile_learner": false, "torch_compile_learner_what_to_compile": "forward_train", "torch_compile_learner_dynamo_backend": "aot_eager", "torch_compile_learner_dynamo_mode": null, "torch_compile_worker": false, "torch_compile_worker_dynamo_backend": "aot_eager", "torch_compile_worker_dynamo_mode": null, "torch_ddp_kwargs": {}, "torch_skip_nan_gradients": false, "env": "Umbrella", "env_config": {}, "observation_space": null, "action_space": null, "clip_rewards": null, "normalize_actions": true, "clip_actions": false, "_is_atari": null, "disable_env_checking": false, "render_env": false, "action_mask_key": "action_mask", "env_runner_cls": null, "num_env_runners": 0, "create_local_env_runner": true, "num_envs_per_env_runner": 1, "gym_env_vectorize_mode": "SYNC", "num_cpus_per_env_runner": 1, "num_gpus_per_env_runner": 0, "custom_resources_per_env_runner": {}, "validate_env_runners_after_construction": true, "episodes_to_numpy": true, "max_requests_in_flight_per_env_runner": 1, "sample_timeout_s": 60.0, "_env_to_module_connector": null, "add_default_connectors_to_env_to_module_pipeline": true, "_module_to_env_connector": null, "add_default_connectors_to_module_to_env_pipeline": true, "merge_env_runner_states": "training_only", "broadcast_env_runner_states": true, "episode_lookback_horizon": 1, "rollout_fragment_length": "auto", "batch_mode": "complete_episodes", "compress_observations": false, "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "enable_tf1_exec_eagerly": false, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "preprocessor_pref": "deepmind", "observation_filter": "NoFilter", "update_worker_filter_stats": true, "use_worker_filter_stats": true, "sampler_perf_stats_ema_coef": null, "_is_online": true, "num_learners": 0, "num_gpus_per_learner": 0, "num_cpus_per_learner": "auto", "num_aggregator_actors_per_learner": 0, "max_requests_in_flight_per_aggregator_actor": 3, "local_gpu_idx": 0, "max_requests_in_flight_per_learner": 3, "gamma": 1, "lr": 0.0002847858517, "grad_clip": 0.5, "grad_clip_by": "global_norm", "_train_batch_size_per_learner": 5000, "train_batch_size": 4000, "num_epochs": 1, "minibatch_size": 1000, "shuffle_batch_per_epoch": true, "model": {"fcnet_hiddens": [256, 256], "fcnet_activation": "tanh", "fcnet_weights_initializer": null, "fcnet_weights_initializer_config": null, "fcnet_bias_initializer": null, "fcnet_bias_initializer_config": null, "conv_filters": null, "conv_activation": "relu", "conv_kernel_initializer": null, "conv_kernel_initializer_config": null, "conv_bias_initializer": null, "conv_bias_initializer_config": null, "conv_transpose_kernel_initializer": null, "conv_transpose_kernel_initializer_config": null, "conv_transpose_bias_initializer": null, "conv_transpose_bias_initializer_config": null, "post_fcnet_hiddens": [], "post_fcnet_activation": "relu", "post_fcnet_weights_initializer": null, "post_fcnet_weights_initializer_config": null, "post_fcnet_bias_initializer": null, "post_fcnet_bias_initializer_config": null, "free_log_std": false, "log_std_clip_param": 20.0, "no_final_linear": false, "vf_share_layers": false, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "lstm_weights_initializer": null, "lstm_weights_initializer_config": null, "lstm_bias_initializer": null, "lstm_bias_initializer_config": null, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "attention_use_n_prev_actions": 0, "attention_use_n_prev_rewards": 0, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": null, "custom_model_config": {}, "custom_action_dist": null, "custom_preprocessor": null, "encoder_latent_dim": null, "always_check_shapes": false, "lstm_use_prev_action_reward": -1, "_use_default_native_models": -1, "_disable_preprocessor_api": false, "_disable_action_flattening": false}, "_learner_connector": null, "add_default_connectors_to_learner_pipeline": true, "learner_config_dict": {}, "optimizer": {}, "_learner_class": null, "callbacks_on_algorithm_init": null, "callbacks_on_env_runners_recreated": null, "callbacks_on_offline_eval_runners_recreated": null, "callbacks_on_checkpoint_loaded": null, "callbacks_on_environment_created": null, "callbacks_on_episode_created": null, "callbacks_on_episode_start": null, "callbacks_on_episode_step": null, "callbacks_on_episode_end": null, "callbacks_on_evaluate_start": null, "callbacks_on_evaluate_end": null, "callbacks_on_evaluate_offline_start": null, "callbacks_on_evaluate_offline_end": null, "callbacks_on_sample_end": null, "callbacks_on_train_result": null, "explore": true, "enable_rl_module_and_learner": true, "enable_env_runner_and_connector_v2": true, "_prior_exploration_config": {"type": "StochasticSampling"}, "count_steps_by": "env_steps", "policy_map_capacity": 100, "policy_mapping_fn": "<function AlgorithmConfig.DEFAULT_POLICY_MAPPING_FN at 0x161a518a0>", "policies_to_train": null, "policy_states_are_swappable": false, "observation_fn": null, "offline_data_class": null, "input_read_method": "read_parquet", "input_read_method_kwargs": {}, "input_read_schema": {}, "input_read_episodes": false, "input_read_sample_batches": false, "input_read_batch_size": null, "input_filesystem": null, "input_filesystem_kwargs": {}, "input_compress_columns": ["obs", "new_obs"], "input_spaces_jsonable": true, "materialize_data": false, "materialize_mapped_data": true, "map_batches_kwargs": {}, "iter_batches_kwargs": {}, "ignore_final_observation": false, "prelearner_class": null, "prelearner_buffer_class": null, "prelearner_buffer_kwargs": {}, "prelearner_module_synch_period": 10, "dataset_num_iters_per_learner": null, "input_config": {}, "actions_in_input_normalized": false, "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_config": {}, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "output_max_rows_per_file": null, "output_write_remaining_data": false, "output_write_method": "write_parquet", "output_write_method_kwargs": {}, "output_filesystem": null, "output_filesystem_kwargs": {}, "output_write_episodes": true, "offline_sampling": false, "evaluation_interval": 1, "evaluation_duration": 20, "evaluation_duration_unit": "episodes", "evaluation_sample_timeout_s": 120.0, "evaluation_auto_duration_min_env_steps_per_sample": 100, "evaluation_auto_duration_max_env_steps_per_sample": 2000, "evaluation_parallel_to_training": false, "evaluation_force_reset_envs_before_iteration": true, "evaluation_config": null, "off_policy_estimation_methods": {}, "ope_split_batch_by_episode": true, "evaluation_num_env_runners": 1, "in_evaluation": false, "sync_filters_on_rollout_workers_timeout_s": 10.0, "offline_evaluation_interval": null, "num_offline_eval_runners": 0, "offline_loss_for_module_fn": null, "offline_evaluation_duration": 1, "offline_evaluation_parallel_to_training": false, "offline_evaluation_timeout_s": 120.0, "num_cpus_per_offline_eval_runner": 1, "num_gpus_per_offline_eval_runner": 0, "custom_resources_per_offline_eval_runner": {}, "restart_failed_offline_eval_runners": true, "ignore_offline_eval_runner_failures": false, "max_num_offline_eval_runner_restarts": 1000, "offline_eval_runner_restore_timeout_s": 1800.0, "max_requests_in_flight_per_offline_eval_runner": 1, "validate_offline_eval_runners_after_construction": true, "offline_eval_runner_health_probe_timeout_s": 30.0, "offline_eval_rl_module_inference_only": false, "broadcast_offline_eval_runner_states": false, "offline_eval_batch_size_per_runner": 256, "dataset_num_iters_per_eval_runner": 1, "keep_per_episode_custom_metrics": false, "metrics_episode_collection_timeout_s": 60.0, "metrics_num_episodes_for_smoothing": 100, "min_time_s_per_iteration": null, "min_train_timesteps_per_iteration": 0, "min_sample_timesteps_per_iteration": 0, "log_gradients": true, "export_native_model_files": false, "checkpoint_trainable_policies_only": false, "logger_creator": null, "logger_config": null, "log_level": "WARN", "log_sys_usage": true, "fake_sampler": false, "seed": 10, "restart_failed_env_runners": true, "ignore_env_runner_failures": false, "max_num_env_runner_restarts": 1000, "delay_between_env_runner_restarts_s": 60.0, "restart_failed_sub_environments": false, "num_consecutive_env_runner_failures_tolerance": 100, "env_runner_health_probe_timeout_s": 30.0, "env_runner_restore_timeout_s": 1800.0, "_model_config": {}, "_rl_module_spec": "RLModuleSpec(module_class=None, observation_space=None, action_space=None, inference_only=False, learner_only=False, model_config=DefaultModelConfig(fcnet_hiddens=[60, 90], fcnet_activation='tanh', fcnet_kernel_initializer=None, fcnet_kernel_initializer_kwargs=None, fcnet_bias_initializer=None, fcnet_bias_initializer_kwargs=None, conv_filters=None, conv_activation='relu', conv_kernel_initializer=None, conv_kernel_initializer_kwargs=None, conv_bias_initializer=None, conv_bias_initializer_kwargs=None, head_fcnet_hiddens=[], head_fcnet_activation='relu', head_fcnet_kernel_initializer=None, head_fcnet_kernel_initializer_kwargs=None, head_fcnet_bias_initializer=None, head_fcnet_bias_initializer_kwargs=None, free_log_std=False, log_std_clip_param=20.0, vf_share_layers=True, use_lstm=False, max_seq_len=20, lstm_cell_size=256, lstm_use_prev_action=False, lstm_use_prev_reward=False, lstm_kernel_initializer=None, lstm_kernel_initializer_kwargs=None, lstm_bias_initializer=None, lstm_bias_initializer_kwargs=None), catalog_class=None, load_state_path=None, model_config_dict=None)", "algorithm_config_overrides_per_module": {}, "_per_module_overrides": {}, "_validate_config": true, "_use_msgpack_checkpoints": false, "_torch_grad_scaler_class": null, "_torch_lr_scheduler_classes": null, "_tf_policy_handles_more_than_one_loss": false, "_disable_preprocessor_api": false, "_disable_action_flattening": false, "_disable_initialize_loss_from_dummy_batch": false, "_dont_auto_sync_env_runner_states": false, "env_task_fn": -1, "enable_connectors": -1, "simple_optimizer": false, "policy_map_cache": -1, "worker_cls": -1, "synchronize_filters": -1, "enable_async_evaluation": -1, "custom_async_evaluation_function": -1, "_enable_rl_module_api": -1, "auto_wrap_old_gym_envs": -1, "always_attach_evaluation_results": -1, "replay_sequence_length": null, "_disable_execution_plan_api": -1, "use_critic": true, "use_gae": true, "use_kl_loss": true, "kl_coeff": 0.7464963036515, "kl_target": 0.0270990929592, "vf_loss_coeff": 0.6688075857018, "entropy_coeff": 0.0090570820258, "clip_param": 0.1221781641624, "vf_clip_param": 0.1027808522125, "entropy_coeff_schedule": null, "lr_schedule": null, "sgd_minibatch_size": -1, "vf_share_layers": -1, "__stdout_file__": null, "__stderr_file__": null, "lambda": 0.9099046732075, "input": "sampler", "policies": {"default_policy": [null, null, null, null]}, "callbacks": "<class 'ray.rllib.callbacks.callbacks.RLlibCallback'>", "create_env_on_driver": false, "custom_eval_function": null, "framework": "torch"}, "time_since_restore": 48.792102098464966, "iterations_since_restore": 5, "perf": {"cpu_util_percent": 87.5, "ram_util_percent": 76.94285714285715}}
{"timers": {"training_iteration": 16.835362397517358, "restore_env_runners": 0.00011586649559035244, "training_step": 16.834814188529247, "env_runner_sampling_timer": 16.16534119088888, "learner_update_timer": 0.6587397741893025, "synch_weights": 0.0017484214455840924, "restore_eval_env_runners": 3.5141682946634244e-05, "evaluation_iteration": 1.1089349459963234, "synch_eval_env_connectors": 0.0004885131108275276, "synch_env_connectors": 8.984064184636808e-06}, "env_runners": {"episode_return_min": -10.5, "num_agent_steps_sampled_lifetime": {"default_agent": -2460000.0}, "module_to_env_connector": {"timers": {"connectors": {"remove_single_ts_time_rank_from_batch": 1.6597365760223302e-06, "normalize_and_clip_actions": 2.2153581399893574e-05, "listify_data_for_vector_env": 2.8454886850110146e-05, "get_actions": 0.00012524588095841877, "tensor_to_numpy": 3.884544490210102e-05, "un_batch_to_individual_items": 1.2370604007154514e-05}}, "connector_pipeline_timer": 0.0002864546295853497}, "episode_len_mean": 20.0, "num_module_steps_sampled": {"default_policy": 5000.0}, "env_to_module_connector": {"timers": {"connectors": {"add_states_from_episodes_to_batch": 3.86591583738337e-06, "add_time_dim_to_batch_and_zero_pad": 6.1333253595065685e-06, "numpy_to_tensor": 2.8123915075622476e-05, "add_observations_from_episodes_to_batch": 6.4072295139966665e-06, "batch_individual_items": 1.7245104541965754e-05}}, "connector_pipeline_timer": 0.00010863514633103063}, "sample": 0.014350597861896845, "env_to_module_sum_episodes_length_out": 10.36823839457432, "weights_seq_no": 5.0, "num_env_steps_sampled_lifetime": -2460000.0, "episode_return_max": 9.5, "episode_return_mean": 0.54, "module_episode_returns_mean": {"default_policy": 0.54}, "time_between_sampling": 0.0035674601739910114, "rlmodule_inference_timer": 8.42437770644639e-05, "env_step_timer": 4.2067225195151354e-05, "env_reset_timer": 0.00011814778839871328, "agent_episode_returns_mean": {"default_agent": 0.54}, "num_env_steps_sampled": 5000.0, "episode_duration_sec_mean": 0.012466795660555361, "env_to_module_sum_episodes_length_in": 10.36823839457432, "episode_len_min": 20, "num_agent_steps_sampled": {"default_agent": 5000.0}, "num_episodes": 250.0, "num_module_steps_sampled_lifetime": {"default_policy": -2460000.0}, "episode_len_max": 20, "num_episodes_lifetime": -123000.0, "num_env_steps_sampled_lifetime_throughput": 1870.9205569780322}, "learners": {"__all_modules__": {"learner_connector": {"timers": {"connectors": {"general_advantage_estimation": 0.06530662764447694, "numpy_to_tensor": 0.0006487453054093593, "add_observations_from_episodes_to_batch": 0.004397265270977172, "add_one_ts_to_episodes_and_truncate": 0.02792859533204061, "batch_individual_items": 0.10932991276201189, "add_states_from_episodes_to_batch": 5.391795844572491e-06, "add_columns_from_episodes_to_train_batch": 0.18873941617816953, "add_time_dim_to_batch_and_zero_pad": 1.8337644133760037e-05}}, "connector_pipeline_timer": 0.3969048599703878}, "num_module_steps_trained_lifetime": 36000, "num_non_trainable_parameters": 0, "learner_connector_sum_episodes_length_out": 5250.0, "num_module_steps_trained": 6000, "num_trainable_parameters": 6003, "num_env_steps_trained": 31500, "num_env_steps_trained_lifetime": 189000, "learner_connector_sum_episodes_length_in": 5000.0, "num_env_steps_trained_lifetime_throughput": 275869.682694197, "num_module_steps_trained_throughput": 52631.32907428856, "num_module_steps_trained_lifetime_throughput": 52618.188550150364}, "default_policy": {"curr_kl_coeff": 0.011664004996418953, "entropy": 0.6760303974151611, "vf_loss": 0.10278083384037018, "default_optimizer_learning_rate": 0.0002847858517, "vf_explained_var": -0.010419487953186035, "total_loss": 0.20164747536182404, "num_trainable_parameters": 6003, "vf_loss_unclipped": 28.676469802856445, "curr_entropy_coeff": 0.0090570820258, "policy_loss": 0.13901302218437195, "diff_num_grad_updates_vs_sampler_policy": 1.0, "mean_kl_loss": 0.0007163780392147601, "gradients_default_optimizer_global_norm": 0.013501612469553947, "num_module_steps_trained_lifetime": 36000, "weights_seq_no": 6.0, "num_module_steps_trained": 6000, "module_train_batch_size_mean": 1000.0, "num_module_steps_trained_lifetime_throughput": 52571.50845549724}}, "num_training_step_calls_per_iteration": 1, "evaluation": {"env_runners": {"env_to_module_connector": {"timers": {"connectors": {"add_states_from_episodes_to_batch": 2.1700702896550435e-06, "numpy_to_tensor": 1.5858027784581608e-05, "add_time_dim_to_batch_and_zero_pad": 3.837934907153772e-06, "add_observations_from_episodes_to_batch": 4.418145900806103e-06, "batch_individual_items": 9.990727036885127e-06}}, "connector_pipeline_timer": 6.77613117798969e-05}, "agent_episode_returns_mean": {"default_agent": -0.35}, "num_agent_steps_sampled": {"default_agent": 400}, "num_env_steps_sampled_lifetime": 30400, "num_env_steps_sampled": 400, "num_episodes": 20, "episode_len_max": 20, "episode_return_min": -14.5, "episode_len_mean": 20.0, "env_to_module_sum_episodes_length_out": 10.368238394470474, "num_module_steps_sampled_lifetime": {"default_policy": 2400}, "num_agent_steps_sampled_lifetime": {"default_agent": 2400}, "module_to_env_connector": {"timers": {"connectors": {"get_actions": 7.70508875345936e-05, "normalize_and_clip_actions": 1.5644156273780965e-05, "tensor_to_numpy": 2.3183707716880808e-05, "remove_single_ts_time_rank_from_batch": 1.036187299572728e-06, "listify_data_for_vector_env": 1.9671366902664634e-05, "un_batch_to_individual_items": 8.069151649036309e-06}}, "connector_pipeline_timer": 0.00018383442417187453}, "episode_return_mean": -0.35, "env_reset_timer": 0.004529755765891095, "module_episode_returns_mean": {"default_policy": -0.35}, "num_episodes_lifetime": 120, "sample": 1.0478992613193083, "num_module_steps_sampled": {"default_policy": 400}, "env_step_timer": 2.411368299185307e-05, "episode_duration_sec_mean": 0.0133797975408379, "env_to_module_sum_episodes_length_in": 10.368238394470474, "episode_len_min": 20, "weights_seq_no": 6.0, "episode_return_max": 13.5, "rlmodule_inference_timer": 5.247965240767742e-05, "time_between_sampling": 11.6196323140442}, "num_healthy_workers": 1, "actor_manager_num_outstanding_async_reqs": 0, "num_remote_worker_restarts": 0}, "num_env_steps_sampled_lifetime": -2460000.0, "fault_tolerance": {"num_healthy_workers": 0, "num_remote_worker_restarts": 0}, "env_runner_group": {"actor_manager_num_outstanding_async_reqs": 0}, "done": false, "training_iteration": 6, "trial_id": "4d8e6_00000", "date": "2025-08-11_19-28-54", "timestamp": 1754933334, "time_this_iter_s": 4.324002027511597, "time_total_s": 53.11610412597656, "pid": 19818, "hostname": "Mac", "node_ip": "127.0.0.1", "config": {"exploration_config": {}, "extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "placement_strategy": "PACK", "num_gpus": 0, "_fake_gpus": false, "num_cpus_for_main_process": 2, "eager_tracing": true, "eager_max_retraces": 20, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "torch_compile_learner": false, "torch_compile_learner_what_to_compile": "forward_train", "torch_compile_learner_dynamo_backend": "aot_eager", "torch_compile_learner_dynamo_mode": null, "torch_compile_worker": false, "torch_compile_worker_dynamo_backend": "aot_eager", "torch_compile_worker_dynamo_mode": null, "torch_ddp_kwargs": {}, "torch_skip_nan_gradients": false, "env": "Umbrella", "env_config": {}, "observation_space": null, "action_space": null, "clip_rewards": null, "normalize_actions": true, "clip_actions": false, "_is_atari": null, "disable_env_checking": false, "render_env": false, "action_mask_key": "action_mask", "env_runner_cls": null, "num_env_runners": 0, "create_local_env_runner": true, "num_envs_per_env_runner": 1, "gym_env_vectorize_mode": "SYNC", "num_cpus_per_env_runner": 1, "num_gpus_per_env_runner": 0, "custom_resources_per_env_runner": {}, "validate_env_runners_after_construction": true, "episodes_to_numpy": true, "max_requests_in_flight_per_env_runner": 1, "sample_timeout_s": 60.0, "_env_to_module_connector": null, "add_default_connectors_to_env_to_module_pipeline": true, "_module_to_env_connector": null, "add_default_connectors_to_module_to_env_pipeline": true, "merge_env_runner_states": "training_only", "broadcast_env_runner_states": true, "episode_lookback_horizon": 1, "rollout_fragment_length": "auto", "batch_mode": "complete_episodes", "compress_observations": false, "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "enable_tf1_exec_eagerly": false, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "preprocessor_pref": "deepmind", "observation_filter": "NoFilter", "update_worker_filter_stats": true, "use_worker_filter_stats": true, "sampler_perf_stats_ema_coef": null, "_is_online": true, "num_learners": 0, "num_gpus_per_learner": 0, "num_cpus_per_learner": "auto", "num_aggregator_actors_per_learner": 0, "max_requests_in_flight_per_aggregator_actor": 3, "local_gpu_idx": 0, "max_requests_in_flight_per_learner": 3, "gamma": 1, "lr": 0.0002847858517, "grad_clip": 0.5, "grad_clip_by": "global_norm", "_train_batch_size_per_learner": 5000, "train_batch_size": 4000, "num_epochs": 1, "minibatch_size": 1000, "shuffle_batch_per_epoch": true, "model": {"fcnet_hiddens": [256, 256], "fcnet_activation": "tanh", "fcnet_weights_initializer": null, "fcnet_weights_initializer_config": null, "fcnet_bias_initializer": null, "fcnet_bias_initializer_config": null, "conv_filters": null, "conv_activation": "relu", "conv_kernel_initializer": null, "conv_kernel_initializer_config": null, "conv_bias_initializer": null, "conv_bias_initializer_config": null, "conv_transpose_kernel_initializer": null, "conv_transpose_kernel_initializer_config": null, "conv_transpose_bias_initializer": null, "conv_transpose_bias_initializer_config": null, "post_fcnet_hiddens": [], "post_fcnet_activation": "relu", "post_fcnet_weights_initializer": null, "post_fcnet_weights_initializer_config": null, "post_fcnet_bias_initializer": null, "post_fcnet_bias_initializer_config": null, "free_log_std": false, "log_std_clip_param": 20.0, "no_final_linear": false, "vf_share_layers": false, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "lstm_weights_initializer": null, "lstm_weights_initializer_config": null, "lstm_bias_initializer": null, "lstm_bias_initializer_config": null, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "attention_use_n_prev_actions": 0, "attention_use_n_prev_rewards": 0, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": null, "custom_model_config": {}, "custom_action_dist": null, "custom_preprocessor": null, "encoder_latent_dim": null, "always_check_shapes": false, "lstm_use_prev_action_reward": -1, "_use_default_native_models": -1, "_disable_preprocessor_api": false, "_disable_action_flattening": false}, "_learner_connector": null, "add_default_connectors_to_learner_pipeline": true, "learner_config_dict": {}, "optimizer": {}, "_learner_class": null, "callbacks_on_algorithm_init": null, "callbacks_on_env_runners_recreated": null, "callbacks_on_offline_eval_runners_recreated": null, "callbacks_on_checkpoint_loaded": null, "callbacks_on_environment_created": null, "callbacks_on_episode_created": null, "callbacks_on_episode_start": null, "callbacks_on_episode_step": null, "callbacks_on_episode_end": null, "callbacks_on_evaluate_start": null, "callbacks_on_evaluate_end": null, "callbacks_on_evaluate_offline_start": null, "callbacks_on_evaluate_offline_end": null, "callbacks_on_sample_end": null, "callbacks_on_train_result": null, "explore": true, "enable_rl_module_and_learner": true, "enable_env_runner_and_connector_v2": true, "_prior_exploration_config": {"type": "StochasticSampling"}, "count_steps_by": "env_steps", "policy_map_capacity": 100, "policy_mapping_fn": "<function AlgorithmConfig.DEFAULT_POLICY_MAPPING_FN at 0x161a518a0>", "policies_to_train": null, "policy_states_are_swappable": false, "observation_fn": null, "offline_data_class": null, "input_read_method": "read_parquet", "input_read_method_kwargs": {}, "input_read_schema": {}, "input_read_episodes": false, "input_read_sample_batches": false, "input_read_batch_size": null, "input_filesystem": null, "input_filesystem_kwargs": {}, "input_compress_columns": ["obs", "new_obs"], "input_spaces_jsonable": true, "materialize_data": false, "materialize_mapped_data": true, "map_batches_kwargs": {}, "iter_batches_kwargs": {}, "ignore_final_observation": false, "prelearner_class": null, "prelearner_buffer_class": null, "prelearner_buffer_kwargs": {}, "prelearner_module_synch_period": 10, "dataset_num_iters_per_learner": null, "input_config": {}, "actions_in_input_normalized": false, "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_config": {}, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "output_max_rows_per_file": null, "output_write_remaining_data": false, "output_write_method": "write_parquet", "output_write_method_kwargs": {}, "output_filesystem": null, "output_filesystem_kwargs": {}, "output_write_episodes": true, "offline_sampling": false, "evaluation_interval": 1, "evaluation_duration": 20, "evaluation_duration_unit": "episodes", "evaluation_sample_timeout_s": 120.0, "evaluation_auto_duration_min_env_steps_per_sample": 100, "evaluation_auto_duration_max_env_steps_per_sample": 2000, "evaluation_parallel_to_training": false, "evaluation_force_reset_envs_before_iteration": true, "evaluation_config": null, "off_policy_estimation_methods": {}, "ope_split_batch_by_episode": true, "evaluation_num_env_runners": 1, "in_evaluation": false, "sync_filters_on_rollout_workers_timeout_s": 10.0, "offline_evaluation_interval": null, "num_offline_eval_runners": 0, "offline_loss_for_module_fn": null, "offline_evaluation_duration": 1, "offline_evaluation_parallel_to_training": false, "offline_evaluation_timeout_s": 120.0, "num_cpus_per_offline_eval_runner": 1, "num_gpus_per_offline_eval_runner": 0, "custom_resources_per_offline_eval_runner": {}, "restart_failed_offline_eval_runners": true, "ignore_offline_eval_runner_failures": false, "max_num_offline_eval_runner_restarts": 1000, "offline_eval_runner_restore_timeout_s": 1800.0, "max_requests_in_flight_per_offline_eval_runner": 1, "validate_offline_eval_runners_after_construction": true, "offline_eval_runner_health_probe_timeout_s": 30.0, "offline_eval_rl_module_inference_only": false, "broadcast_offline_eval_runner_states": false, "offline_eval_batch_size_per_runner": 256, "dataset_num_iters_per_eval_runner": 1, "keep_per_episode_custom_metrics": false, "metrics_episode_collection_timeout_s": 60.0, "metrics_num_episodes_for_smoothing": 100, "min_time_s_per_iteration": null, "min_train_timesteps_per_iteration": 0, "min_sample_timesteps_per_iteration": 0, "log_gradients": true, "export_native_model_files": false, "checkpoint_trainable_policies_only": false, "logger_creator": null, "logger_config": null, "log_level": "WARN", "log_sys_usage": true, "fake_sampler": false, "seed": 10, "restart_failed_env_runners": true, "ignore_env_runner_failures": false, "max_num_env_runner_restarts": 1000, "delay_between_env_runner_restarts_s": 60.0, "restart_failed_sub_environments": false, "num_consecutive_env_runner_failures_tolerance": 100, "env_runner_health_probe_timeout_s": 30.0, "env_runner_restore_timeout_s": 1800.0, "_model_config": {}, "_rl_module_spec": "RLModuleSpec(module_class=None, observation_space=None, action_space=None, inference_only=False, learner_only=False, model_config=DefaultModelConfig(fcnet_hiddens=[60, 90], fcnet_activation='tanh', fcnet_kernel_initializer=None, fcnet_kernel_initializer_kwargs=None, fcnet_bias_initializer=None, fcnet_bias_initializer_kwargs=None, conv_filters=None, conv_activation='relu', conv_kernel_initializer=None, conv_kernel_initializer_kwargs=None, conv_bias_initializer=None, conv_bias_initializer_kwargs=None, head_fcnet_hiddens=[], head_fcnet_activation='relu', head_fcnet_kernel_initializer=None, head_fcnet_kernel_initializer_kwargs=None, head_fcnet_bias_initializer=None, head_fcnet_bias_initializer_kwargs=None, free_log_std=False, log_std_clip_param=20.0, vf_share_layers=True, use_lstm=False, max_seq_len=20, lstm_cell_size=256, lstm_use_prev_action=False, lstm_use_prev_reward=False, lstm_kernel_initializer=None, lstm_kernel_initializer_kwargs=None, lstm_bias_initializer=None, lstm_bias_initializer_kwargs=None), catalog_class=None, load_state_path=None, model_config_dict=None)", "algorithm_config_overrides_per_module": {}, "_per_module_overrides": {}, "_validate_config": true, "_use_msgpack_checkpoints": false, "_torch_grad_scaler_class": null, "_torch_lr_scheduler_classes": null, "_tf_policy_handles_more_than_one_loss": false, "_disable_preprocessor_api": false, "_disable_action_flattening": false, "_disable_initialize_loss_from_dummy_batch": false, "_dont_auto_sync_env_runner_states": false, "env_task_fn": -1, "enable_connectors": -1, "simple_optimizer": false, "policy_map_cache": -1, "worker_cls": -1, "synchronize_filters": -1, "enable_async_evaluation": -1, "custom_async_evaluation_function": -1, "_enable_rl_module_api": -1, "auto_wrap_old_gym_envs": -1, "always_attach_evaluation_results": -1, "replay_sequence_length": null, "_disable_execution_plan_api": -1, "use_critic": true, "use_gae": true, "use_kl_loss": true, "kl_coeff": 0.7464963036515, "kl_target": 0.0270990929592, "vf_loss_coeff": 0.6688075857018, "entropy_coeff": 0.0090570820258, "clip_param": 0.1221781641624, "vf_clip_param": 0.1027808522125, "entropy_coeff_schedule": null, "lr_schedule": null, "sgd_minibatch_size": -1, "vf_share_layers": -1, "__stdout_file__": null, "__stderr_file__": null, "lambda": 0.9099046732075, "input": "sampler", "policies": {"default_policy": [null, null, null, null]}, "callbacks": "<class 'ray.rllib.callbacks.callbacks.RLlibCallback'>", "create_env_on_driver": false, "custom_eval_function": null, "framework": "torch"}, "time_since_restore": 53.11610412597656, "iterations_since_restore": 6, "perf": {"cpu_util_percent": 86.36666666666667, "ram_util_percent": 76.89999999999999}}
{"timers": {"training_iteration": 16.705236478541917, "restore_env_runners": 0.00011496533084895114, "training_step": 16.704685923723783, "env_runner_sampling_timer": 16.04021355356065, "learner_update_timer": 0.6538081272773688, "synch_weights": 0.0017419013914476691, "restore_eval_env_runners": 3.486943552092953e-05, "evaluation_iteration": 1.1003476086261863, "synch_eval_env_connectors": 0.0005032784005917469, "synch_env_connectors": 8.936304189171223e-06}, "env_runners": {"episode_return_min": -10.5, "num_agent_steps_sampled_lifetime": {"default_agent": -3077500.0}, "module_to_env_connector": {"timers": {"connectors": {"remove_single_ts_time_rank_from_batch": 1.3218606357266673e-06, "normalize_and_clip_actions": 2.408949681326753e-05, "listify_data_for_vector_env": 2.6765966576474135e-05, "get_actions": 0.00012605180102495203, "tensor_to_numpy": 3.498905226124756e-05, "un_batch_to_individual_items": 1.3053164460164742e-05}}, "connector_pipeline_timer": 0.00028495466432681185}, "episode_len_mean": 20.0, "num_module_steps_sampled": {"default_policy": 5000.0}, "env_to_module_connector": {"timers": {"connectors": {"add_states_from_episodes_to_batch": 3.422588978071378e-06, "add_time_dim_to_batch_and_zero_pad": 6.30512395397499e-06, "numpy_to_tensor": 2.541640227375739e-05, "add_observations_from_episodes_to_batch": 7.865371355437471e-06, "batch_individual_items": 1.685829283562638e-05}}, "connector_pipeline_timer": 0.00010417187662207958}, "sample": 0.013151200907810735, "env_to_module_sum_episodes_length_out": 10.36823839457432, "weights_seq_no": 6.0, "num_env_steps_sampled_lifetime": -3077500.0, "episode_return_max": 9.5, "episode_return_mean": 2.0599999999999996, "module_episode_returns_mean": {"default_policy": 2.0599999999999996}, "time_between_sampling": 0.004233937369720259, "rlmodule_inference_timer": 8.377026515026251e-05, "env_step_timer": 3.950482492937965e-05, "env_reset_timer": 0.0001159398510141009, "agent_episode_returns_mean": {"default_agent": 2.0599999999999996}, "num_env_steps_sampled": 5000.0, "episode_duration_sec_mean": 0.0122856722115539, "env_to_module_sum_episodes_length_in": 10.36823839457432, "episode_len_min": 20, "num_agent_steps_sampled": {"default_agent": 5000.0}, "num_episodes": 250.0, "num_module_steps_sampled_lifetime": {"default_policy": -3077500.0}, "episode_len_max": 20, "num_episodes_lifetime": -153875.0, "num_env_steps_sampled_lifetime_throughput": 1890.0740614222934}, "learners": {"__all_modules__": {"learner_connector": {"timers": {"connectors": {"general_advantage_estimation": 0.06471857511802279, "numpy_to_tensor": 0.0006429082717432321, "add_observations_from_episodes_to_batch": 0.004378420958616002, "add_one_ts_to_episodes_and_truncate": 0.027843807299758622, "batch_individual_items": 0.10863974030350809, "add_states_from_episodes_to_batch": 5.3703787156744104e-06, "add_columns_from_episodes_to_train_batch": 0.18758773326684203, "add_time_dim_to_batch_and_zero_pad": 1.8292598198583293e-05}}, "connector_pipeline_timer": 0.3943615338716918}, "num_module_steps_trained_lifetime": 42000, "num_non_trainable_parameters": 0, "learner_connector_sum_episodes_length_out": 5250.0, "num_module_steps_trained": 6000, "num_trainable_parameters": 6003, "num_env_steps_trained": 31500, "num_env_steps_trained_lifetime": 220500, "learner_connector_sum_episodes_length_in": 5000.0, "num_env_steps_trained_lifetime_throughput": 308964.3213603344, "num_module_steps_trained_throughput": 58939.933235342345, "num_module_steps_trained_lifetime_throughput": 58921.00399748359}, "default_policy": {"curr_kl_coeff": 0.0058320024982094765, "entropy": 0.6714522838592529, "vf_loss": 0.10278083384037018, "default_optimizer_learning_rate": 0.0002847858517, "vf_explained_var": -0.010401129722595215, "total_loss": 0.027804788202047348, "num_trainable_parameters": 6003, "vf_loss_unclipped": 28.562328338623047, "curr_entropy_coeff": 0.0090570820258, "policy_loss": -0.034859273582696915, "diff_num_grad_updates_vs_sampler_policy": 1.0, "mean_kl_loss": 0.00041595392394810915, "gradients_default_optimizer_global_norm": 0.058202605694532394, "num_module_steps_trained_lifetime": 42000, "weights_seq_no": 7.0, "num_module_steps_trained": 6000, "module_train_batch_size_mean": 1000.0, "num_module_steps_trained_lifetime_throughput": 58868.63508549821}}, "num_training_step_calls_per_iteration": 1, "evaluation": {"env_runners": {"env_to_module_connector": {"timers": {"connectors": {"add_states_from_episodes_to_batch": 2.1558234516866064e-06, "numpy_to_tensor": 1.531422189733414e-05, "add_time_dim_to_batch_and_zero_pad": 3.190662736560653e-06, "add_observations_from_episodes_to_batch": 3.92567001436453e-06, "batch_individual_items": 1.0417054733748999e-05}}, "connector_pipeline_timer": 6.435037508886281e-05}, "agent_episode_returns_mean": {"default_agent": -0.15}, "num_agent_steps_sampled": {"default_agent": 400}, "num_env_steps_sampled_lifetime": 35400, "num_env_steps_sampled": 400, "num_episodes": 20, "episode_len_max": 20, "episode_return_min": -14.5, "episode_len_mean": 20.0, "env_to_module_sum_episodes_length_out": 10.368238394572801, "num_module_steps_sampled_lifetime": {"default_policy": 2800}, "num_agent_steps_sampled_lifetime": {"default_agent": 2800}, "module_to_env_connector": {"timers": {"connectors": {"get_actions": 6.355820708581324e-05, "normalize_and_clip_actions": 1.3461783186505832e-05, "tensor_to_numpy": 1.9197811338246742e-05, "remove_single_ts_time_rank_from_batch": 8.355241943499984e-07, "listify_data_for_vector_env": 1.651181086005572e-05, "un_batch_to_individual_items": 7.876520479037453e-06}}, "connector_pipeline_timer": 0.00015643367359925996}, "episode_return_mean": -0.15, "env_reset_timer": 0.0044852365377908545, "module_episode_returns_mean": {"default_policy": -0.15}, "num_episodes_lifetime": 140, "sample": 1.0397646174568909, "num_module_steps_sampled": {"default_policy": 400}, "env_step_timer": 2.1769081611714285e-05, "episode_duration_sec_mean": 0.011558436248451471, "env_to_module_sum_episodes_length_in": 10.368238394572801, "episode_len_min": 20, "weights_seq_no": 7.0, "episode_return_max": 13.5, "rlmodule_inference_timer": 4.564879156951037e-05, "time_between_sampling": 11.542538810903437}, "num_healthy_workers": 1, "actor_manager_num_outstanding_async_reqs": 0, "num_remote_worker_restarts": 0}, "num_env_steps_sampled_lifetime": -3077500.0, "fault_tolerance": {"num_healthy_workers": 0, "num_remote_worker_restarts": 0}, "env_runner_group": {"actor_manager_num_outstanding_async_reqs": 0}, "done": false, "training_iteration": 7, "trial_id": "4d8e6_00000", "date": "2025-08-11_19-28-59", "timestamp": 1754933339, "time_this_iter_s": 4.0673668384552, "time_total_s": 57.18347096443176, "pid": 19818, "hostname": "Mac", "node_ip": "127.0.0.1", "config": {"exploration_config": {}, "extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "placement_strategy": "PACK", "num_gpus": 0, "_fake_gpus": false, "num_cpus_for_main_process": 2, "eager_tracing": true, "eager_max_retraces": 20, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "torch_compile_learner": false, "torch_compile_learner_what_to_compile": "forward_train", "torch_compile_learner_dynamo_backend": "aot_eager", "torch_compile_learner_dynamo_mode": null, "torch_compile_worker": false, "torch_compile_worker_dynamo_backend": "aot_eager", "torch_compile_worker_dynamo_mode": null, "torch_ddp_kwargs": {}, "torch_skip_nan_gradients": false, "env": "Umbrella", "env_config": {}, "observation_space": null, "action_space": null, "clip_rewards": null, "normalize_actions": true, "clip_actions": false, "_is_atari": null, "disable_env_checking": false, "render_env": false, "action_mask_key": "action_mask", "env_runner_cls": null, "num_env_runners": 0, "create_local_env_runner": true, "num_envs_per_env_runner": 1, "gym_env_vectorize_mode": "SYNC", "num_cpus_per_env_runner": 1, "num_gpus_per_env_runner": 0, "custom_resources_per_env_runner": {}, "validate_env_runners_after_construction": true, "episodes_to_numpy": true, "max_requests_in_flight_per_env_runner": 1, "sample_timeout_s": 60.0, "_env_to_module_connector": null, "add_default_connectors_to_env_to_module_pipeline": true, "_module_to_env_connector": null, "add_default_connectors_to_module_to_env_pipeline": true, "merge_env_runner_states": "training_only", "broadcast_env_runner_states": true, "episode_lookback_horizon": 1, "rollout_fragment_length": "auto", "batch_mode": "complete_episodes", "compress_observations": false, "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "enable_tf1_exec_eagerly": false, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "preprocessor_pref": "deepmind", "observation_filter": "NoFilter", "update_worker_filter_stats": true, "use_worker_filter_stats": true, "sampler_perf_stats_ema_coef": null, "_is_online": true, "num_learners": 0, "num_gpus_per_learner": 0, "num_cpus_per_learner": "auto", "num_aggregator_actors_per_learner": 0, "max_requests_in_flight_per_aggregator_actor": 3, "local_gpu_idx": 0, "max_requests_in_flight_per_learner": 3, "gamma": 1, "lr": 0.0002847858517, "grad_clip": 0.5, "grad_clip_by": "global_norm", "_train_batch_size_per_learner": 5000, "train_batch_size": 4000, "num_epochs": 1, "minibatch_size": 1000, "shuffle_batch_per_epoch": true, "model": {"fcnet_hiddens": [256, 256], "fcnet_activation": "tanh", "fcnet_weights_initializer": null, "fcnet_weights_initializer_config": null, "fcnet_bias_initializer": null, "fcnet_bias_initializer_config": null, "conv_filters": null, "conv_activation": "relu", "conv_kernel_initializer": null, "conv_kernel_initializer_config": null, "conv_bias_initializer": null, "conv_bias_initializer_config": null, "conv_transpose_kernel_initializer": null, "conv_transpose_kernel_initializer_config": null, "conv_transpose_bias_initializer": null, "conv_transpose_bias_initializer_config": null, "post_fcnet_hiddens": [], "post_fcnet_activation": "relu", "post_fcnet_weights_initializer": null, "post_fcnet_weights_initializer_config": null, "post_fcnet_bias_initializer": null, "post_fcnet_bias_initializer_config": null, "free_log_std": false, "log_std_clip_param": 20.0, "no_final_linear": false, "vf_share_layers": false, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "lstm_weights_initializer": null, "lstm_weights_initializer_config": null, "lstm_bias_initializer": null, "lstm_bias_initializer_config": null, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "attention_use_n_prev_actions": 0, "attention_use_n_prev_rewards": 0, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": null, "custom_model_config": {}, "custom_action_dist": null, "custom_preprocessor": null, "encoder_latent_dim": null, "always_check_shapes": false, "lstm_use_prev_action_reward": -1, "_use_default_native_models": -1, "_disable_preprocessor_api": false, "_disable_action_flattening": false}, "_learner_connector": null, "add_default_connectors_to_learner_pipeline": true, "learner_config_dict": {}, "optimizer": {}, "_learner_class": null, "callbacks_on_algorithm_init": null, "callbacks_on_env_runners_recreated": null, "callbacks_on_offline_eval_runners_recreated": null, "callbacks_on_checkpoint_loaded": null, "callbacks_on_environment_created": null, "callbacks_on_episode_created": null, "callbacks_on_episode_start": null, "callbacks_on_episode_step": null, "callbacks_on_episode_end": null, "callbacks_on_evaluate_start": null, "callbacks_on_evaluate_end": null, "callbacks_on_evaluate_offline_start": null, "callbacks_on_evaluate_offline_end": null, "callbacks_on_sample_end": null, "callbacks_on_train_result": null, "explore": true, "enable_rl_module_and_learner": true, "enable_env_runner_and_connector_v2": true, "_prior_exploration_config": {"type": "StochasticSampling"}, "count_steps_by": "env_steps", "policy_map_capacity": 100, "policy_mapping_fn": "<function AlgorithmConfig.DEFAULT_POLICY_MAPPING_FN at 0x161a518a0>", "policies_to_train": null, "policy_states_are_swappable": false, "observation_fn": null, "offline_data_class": null, "input_read_method": "read_parquet", "input_read_method_kwargs": {}, "input_read_schema": {}, "input_read_episodes": false, "input_read_sample_batches": false, "input_read_batch_size": null, "input_filesystem": null, "input_filesystem_kwargs": {}, "input_compress_columns": ["obs", "new_obs"], "input_spaces_jsonable": true, "materialize_data": false, "materialize_mapped_data": true, "map_batches_kwargs": {}, "iter_batches_kwargs": {}, "ignore_final_observation": false, "prelearner_class": null, "prelearner_buffer_class": null, "prelearner_buffer_kwargs": {}, "prelearner_module_synch_period": 10, "dataset_num_iters_per_learner": null, "input_config": {}, "actions_in_input_normalized": false, "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_config": {}, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "output_max_rows_per_file": null, "output_write_remaining_data": false, "output_write_method": "write_parquet", "output_write_method_kwargs": {}, "output_filesystem": null, "output_filesystem_kwargs": {}, "output_write_episodes": true, "offline_sampling": false, "evaluation_interval": 1, "evaluation_duration": 20, "evaluation_duration_unit": "episodes", "evaluation_sample_timeout_s": 120.0, "evaluation_auto_duration_min_env_steps_per_sample": 100, "evaluation_auto_duration_max_env_steps_per_sample": 2000, "evaluation_parallel_to_training": false, "evaluation_force_reset_envs_before_iteration": true, "evaluation_config": null, "off_policy_estimation_methods": {}, "ope_split_batch_by_episode": true, "evaluation_num_env_runners": 1, "in_evaluation": false, "sync_filters_on_rollout_workers_timeout_s": 10.0, "offline_evaluation_interval": null, "num_offline_eval_runners": 0, "offline_loss_for_module_fn": null, "offline_evaluation_duration": 1, "offline_evaluation_parallel_to_training": false, "offline_evaluation_timeout_s": 120.0, "num_cpus_per_offline_eval_runner": 1, "num_gpus_per_offline_eval_runner": 0, "custom_resources_per_offline_eval_runner": {}, "restart_failed_offline_eval_runners": true, "ignore_offline_eval_runner_failures": false, "max_num_offline_eval_runner_restarts": 1000, "offline_eval_runner_restore_timeout_s": 1800.0, "max_requests_in_flight_per_offline_eval_runner": 1, "validate_offline_eval_runners_after_construction": true, "offline_eval_runner_health_probe_timeout_s": 30.0, "offline_eval_rl_module_inference_only": false, "broadcast_offline_eval_runner_states": false, "offline_eval_batch_size_per_runner": 256, "dataset_num_iters_per_eval_runner": 1, "keep_per_episode_custom_metrics": false, "metrics_episode_collection_timeout_s": 60.0, "metrics_num_episodes_for_smoothing": 100, "min_time_s_per_iteration": null, "min_train_timesteps_per_iteration": 0, "min_sample_timesteps_per_iteration": 0, "log_gradients": true, "export_native_model_files": false, "checkpoint_trainable_policies_only": false, "logger_creator": null, "logger_config": null, "log_level": "WARN", "log_sys_usage": true, "fake_sampler": false, "seed": 10, "restart_failed_env_runners": true, "ignore_env_runner_failures": false, "max_num_env_runner_restarts": 1000, "delay_between_env_runner_restarts_s": 60.0, "restart_failed_sub_environments": false, "num_consecutive_env_runner_failures_tolerance": 100, "env_runner_health_probe_timeout_s": 30.0, "env_runner_restore_timeout_s": 1800.0, "_model_config": {}, "_rl_module_spec": "RLModuleSpec(module_class=None, observation_space=None, action_space=None, inference_only=False, learner_only=False, model_config=DefaultModelConfig(fcnet_hiddens=[60, 90], fcnet_activation='tanh', fcnet_kernel_initializer=None, fcnet_kernel_initializer_kwargs=None, fcnet_bias_initializer=None, fcnet_bias_initializer_kwargs=None, conv_filters=None, conv_activation='relu', conv_kernel_initializer=None, conv_kernel_initializer_kwargs=None, conv_bias_initializer=None, conv_bias_initializer_kwargs=None, head_fcnet_hiddens=[], head_fcnet_activation='relu', head_fcnet_kernel_initializer=None, head_fcnet_kernel_initializer_kwargs=None, head_fcnet_bias_initializer=None, head_fcnet_bias_initializer_kwargs=None, free_log_std=False, log_std_clip_param=20.0, vf_share_layers=True, use_lstm=False, max_seq_len=20, lstm_cell_size=256, lstm_use_prev_action=False, lstm_use_prev_reward=False, lstm_kernel_initializer=None, lstm_kernel_initializer_kwargs=None, lstm_bias_initializer=None, lstm_bias_initializer_kwargs=None), catalog_class=None, load_state_path=None, model_config_dict=None)", "algorithm_config_overrides_per_module": {}, "_per_module_overrides": {}, "_validate_config": true, "_use_msgpack_checkpoints": false, "_torch_grad_scaler_class": null, "_torch_lr_scheduler_classes": null, "_tf_policy_handles_more_than_one_loss": false, "_disable_preprocessor_api": false, "_disable_action_flattening": false, "_disable_initialize_loss_from_dummy_batch": false, "_dont_auto_sync_env_runner_states": false, "env_task_fn": -1, "enable_connectors": -1, "simple_optimizer": false, "policy_map_cache": -1, "worker_cls": -1, "synchronize_filters": -1, "enable_async_evaluation": -1, "custom_async_evaluation_function": -1, "_enable_rl_module_api": -1, "auto_wrap_old_gym_envs": -1, "always_attach_evaluation_results": -1, "replay_sequence_length": null, "_disable_execution_plan_api": -1, "use_critic": true, "use_gae": true, "use_kl_loss": true, "kl_coeff": 0.7464963036515, "kl_target": 0.0270990929592, "vf_loss_coeff": 0.6688075857018, "entropy_coeff": 0.0090570820258, "clip_param": 0.1221781641624, "vf_clip_param": 0.1027808522125, "entropy_coeff_schedule": null, "lr_schedule": null, "sgd_minibatch_size": -1, "vf_share_layers": -1, "__stdout_file__": null, "__stderr_file__": null, "lambda": 0.9099046732075, "input": "sampler", "policies": {"default_policy": [null, null, null, null]}, "callbacks": "<class 'ray.rllib.callbacks.callbacks.RLlibCallback'>", "create_env_on_driver": false, "custom_eval_function": null, "framework": "torch"}, "time_since_restore": 57.18347096443176, "iterations_since_restore": 7, "perf": {"cpu_util_percent": 85.91666666666667, "ram_util_percent": 76.88333333333334}}
{"timers": {"training_iteration": 16.616591420426474, "restore_env_runners": 0.00011388775725112399, "training_step": 16.616043481156638, "env_runner_sampling_timer": 15.955607185935357, "learner_update_timer": 0.6497706472548078, "synch_weights": 0.0017476307074617099, "restore_eval_env_runners": 3.459699087321044e-05, "evaluation_iteration": 1.0917652929500827, "synch_eval_env_connectors": 0.0004992506172534759, "synch_env_connectors": 8.888191752415667e-06}, "env_runners": {"episode_return_min": -10.5, "num_agent_steps_sampled_lifetime": {"default_agent": -3695000.0}, "module_to_env_connector": {"timers": {"connectors": {"remove_single_ts_time_rank_from_batch": 2.0632268037288506e-06, "normalize_and_clip_actions": 4.4405882283476684e-05, "listify_data_for_vector_env": 5.333926698346622e-05, "get_actions": 0.00026618581300631044, "tensor_to_numpy": 7.861583635408277e-05, "un_batch_to_individual_items": 1.9638146205343985e-05}}, "connector_pipeline_timer": 0.0005725632561686885}, "episode_len_mean": 20.0, "num_module_steps_sampled": {"default_policy": 5000.0}, "env_to_module_connector": {"timers": {"connectors": {"add_states_from_episodes_to_batch": 7.494645898713659e-06, "add_time_dim_to_batch_and_zero_pad": 1.6546881236041222e-05, "numpy_to_tensor": 6.198984022053656e-05, "add_observations_from_episodes_to_batch": 1.4514887370487266e-05, "batch_individual_items": 3.444004742081354e-05}}, "connector_pipeline_timer": 0.00021743640197679383}, "sample": 0.022566954234284196, "env_to_module_sum_episodes_length_out": 10.36823839457432, "weights_seq_no": 7.0, "num_env_steps_sampled_lifetime": -3695000.0, "episode_return_max": 9.5, "episode_return_mean": 1.6599999999999997, "module_episode_returns_mean": {"default_policy": 1.6599999999999997}, "time_between_sampling": 0.003974376458574171, "rlmodule_inference_timer": 0.00024880032382715176, "env_step_timer": 7.807944995895705e-05, "env_reset_timer": 0.00017067574779938645, "agent_episode_returns_mean": {"default_agent": 1.6599999999999997}, "num_env_steps_sampled": 5000.0, "episode_duration_sec_mean": 0.026544746289961035, "env_to_module_sum_episodes_length_in": 10.36823839457432, "episode_len_min": 20, "num_agent_steps_sampled": {"default_agent": 5000.0}, "num_episodes": 250.0, "num_module_steps_sampled_lifetime": {"default_policy": -3695000.0}, "episode_len_max": 20, "num_episodes_lifetime": -184750.0, "num_env_steps_sampled_lifetime_throughput": 1267.8741587484856}, "learners": {"__all_modules__": {"learner_connector": {"timers": {"connectors": {"general_advantage_estimation": 0.0642115593666376, "numpy_to_tensor": 0.000637317109259407, "add_observations_from_episodes_to_batch": 0.004362930078553718, "add_one_ts_to_episodes_and_truncate": 0.02777136381624813, "batch_individual_items": 0.10814223498059562, "add_states_from_episodes_to_batch": 5.386674297378984e-06, "add_columns_from_episodes_to_train_batch": 0.18662432593450395, "add_time_dim_to_batch_and_zero_pad": 1.870259291296031e-05}}, "connector_pipeline_timer": 0.39229774728336364}, "num_module_steps_trained_lifetime": 48000, "num_non_trainable_parameters": 0, "learner_connector_sum_episodes_length_out": 5250.0, "num_module_steps_trained": 6000, "num_trainable_parameters": 6003, "num_env_steps_trained": 31500, "num_env_steps_trained_lifetime": 252000, "learner_connector_sum_episodes_length_in": 5000.0, "num_env_steps_trained_lifetime_throughput": 335695.96378546424, "num_module_steps_trained_throughput": 64101.96994192495, "num_module_steps_trained_lifetime_throughput": 64012.28485452943}, "default_policy": {"curr_kl_coeff": 0.0029160012491047382, "entropy": 0.6594521403312683, "vf_loss": 0.10278083384037018, "default_optimizer_learning_rate": 0.0002847858517, "vf_explained_var": -0.010833382606506348, "total_loss": 0.06938596069812775, "num_trainable_parameters": 6003, "vf_loss_unclipped": 28.607404708862305, "curr_entropy_coeff": 0.0090570820258, "policy_loss": 0.006612226366996765, "diff_num_grad_updates_vs_sampler_policy": 1.0, "mean_kl_loss": 0.0010036317398771644, "gradients_default_optimizer_global_norm": 0.019486667588353157, "num_module_steps_trained_lifetime": 48000, "weights_seq_no": 8.0, "num_module_steps_trained": 6000, "module_train_batch_size_mean": 1000.0, "num_module_steps_trained_lifetime_throughput": 64017.70316241981}}, "num_training_step_calls_per_iteration": 1, "evaluation": {"env_runners": {"env_to_module_connector": {"timers": {"connectors": {"add_states_from_episodes_to_batch": 1.3922146825485421e-05, "numpy_to_tensor": 3.660570434643288e-05, "add_time_dim_to_batch_and_zero_pad": 6.394833294923489e-06, "add_observations_from_episodes_to_batch": 7.835490845587217e-06, "batch_individual_items": 1.6401538820670046e-05}}, "connector_pipeline_timer": 0.00013311351409187763}, "agent_episode_returns_mean": {"default_agent": 0.45}, "num_agent_steps_sampled": {"default_agent": 400}, "num_env_steps_sampled_lifetime": 40400, "num_env_steps_sampled": 400, "num_episodes": 20, "episode_len_max": 20, "episode_return_min": -14.5, "episode_len_mean": 20.0, "env_to_module_sum_episodes_length_out": 10.3682383945743, "num_module_steps_sampled_lifetime": {"default_policy": 3200}, "num_agent_steps_sampled_lifetime": {"default_agent": 3200}, "module_to_env_connector": {"timers": {"connectors": {"get_actions": 0.0001477534155212877, "normalize_and_clip_actions": 2.3176071200932275e-05, "tensor_to_numpy": 4.1448060996392657e-05, "remove_single_ts_time_rank_from_batch": 1.2664910641427948e-06, "listify_data_for_vector_env": 4.769305126292344e-05, "un_batch_to_individual_items": 1.6305743694795925e-05}}, "connector_pipeline_timer": 0.00035899166548946786}, "episode_return_mean": 0.45, "env_reset_timer": 0.0044531833420483466, "module_episode_returns_mean": {"default_policy": 0.45}, "num_episodes_lifetime": 160, "sample": 1.0321672216931228, "num_module_steps_sampled": {"default_policy": 400}, "env_step_timer": 4.213159551411362e-05, "episode_duration_sec_mean": 0.011597576667554677, "env_to_module_sum_episodes_length_in": 10.3682383945743, "episode_len_min": 20, "weights_seq_no": 8.0, "episode_return_max": 13.5, "rlmodule_inference_timer": 0.00010900196154569079, "time_between_sampling": 11.505954419044913}, "num_healthy_workers": 1, "actor_manager_num_outstanding_async_reqs": 0, "num_remote_worker_restarts": 0}, "num_env_steps_sampled_lifetime": -3695000.0, "fault_tolerance": {"num_healthy_workers": 0, "num_remote_worker_restarts": 0}, "env_runner_group": {"actor_manager_num_outstanding_async_reqs": 0}, "done": false, "training_iteration": 8, "trial_id": "4d8e6_00000", "date": "2025-08-11_19-29-07", "timestamp": 1754933347, "time_this_iter_s": 8.151384830474854, "time_total_s": 65.33485579490662, "pid": 19818, "hostname": "Mac", "node_ip": "127.0.0.1", "config": {"exploration_config": {}, "extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "placement_strategy": "PACK", "num_gpus": 0, "_fake_gpus": false, "num_cpus_for_main_process": 2, "eager_tracing": true, "eager_max_retraces": 20, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "torch_compile_learner": false, "torch_compile_learner_what_to_compile": "forward_train", "torch_compile_learner_dynamo_backend": "aot_eager", "torch_compile_learner_dynamo_mode": null, "torch_compile_worker": false, "torch_compile_worker_dynamo_backend": "aot_eager", "torch_compile_worker_dynamo_mode": null, "torch_ddp_kwargs": {}, "torch_skip_nan_gradients": false, "env": "Umbrella", "env_config": {}, "observation_space": null, "action_space": null, "clip_rewards": null, "normalize_actions": true, "clip_actions": false, "_is_atari": null, "disable_env_checking": false, "render_env": false, "action_mask_key": "action_mask", "env_runner_cls": null, "num_env_runners": 0, "create_local_env_runner": true, "num_envs_per_env_runner": 1, "gym_env_vectorize_mode": "SYNC", "num_cpus_per_env_runner": 1, "num_gpus_per_env_runner": 0, "custom_resources_per_env_runner": {}, "validate_env_runners_after_construction": true, "episodes_to_numpy": true, "max_requests_in_flight_per_env_runner": 1, "sample_timeout_s": 60.0, "_env_to_module_connector": null, "add_default_connectors_to_env_to_module_pipeline": true, "_module_to_env_connector": null, "add_default_connectors_to_module_to_env_pipeline": true, "merge_env_runner_states": "training_only", "broadcast_env_runner_states": true, "episode_lookback_horizon": 1, "rollout_fragment_length": "auto", "batch_mode": "complete_episodes", "compress_observations": false, "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "enable_tf1_exec_eagerly": false, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "preprocessor_pref": "deepmind", "observation_filter": "NoFilter", "update_worker_filter_stats": true, "use_worker_filter_stats": true, "sampler_perf_stats_ema_coef": null, "_is_online": true, "num_learners": 0, "num_gpus_per_learner": 0, "num_cpus_per_learner": "auto", "num_aggregator_actors_per_learner": 0, "max_requests_in_flight_per_aggregator_actor": 3, "local_gpu_idx": 0, "max_requests_in_flight_per_learner": 3, "gamma": 1, "lr": 0.0002847858517, "grad_clip": 0.5, "grad_clip_by": "global_norm", "_train_batch_size_per_learner": 5000, "train_batch_size": 4000, "num_epochs": 1, "minibatch_size": 1000, "shuffle_batch_per_epoch": true, "model": {"fcnet_hiddens": [256, 256], "fcnet_activation": "tanh", "fcnet_weights_initializer": null, "fcnet_weights_initializer_config": null, "fcnet_bias_initializer": null, "fcnet_bias_initializer_config": null, "conv_filters": null, "conv_activation": "relu", "conv_kernel_initializer": null, "conv_kernel_initializer_config": null, "conv_bias_initializer": null, "conv_bias_initializer_config": null, "conv_transpose_kernel_initializer": null, "conv_transpose_kernel_initializer_config": null, "conv_transpose_bias_initializer": null, "conv_transpose_bias_initializer_config": null, "post_fcnet_hiddens": [], "post_fcnet_activation": "relu", "post_fcnet_weights_initializer": null, "post_fcnet_weights_initializer_config": null, "post_fcnet_bias_initializer": null, "post_fcnet_bias_initializer_config": null, "free_log_std": false, "log_std_clip_param": 20.0, "no_final_linear": false, "vf_share_layers": false, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "lstm_weights_initializer": null, "lstm_weights_initializer_config": null, "lstm_bias_initializer": null, "lstm_bias_initializer_config": null, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "attention_use_n_prev_actions": 0, "attention_use_n_prev_rewards": 0, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": null, "custom_model_config": {}, "custom_action_dist": null, "custom_preprocessor": null, "encoder_latent_dim": null, "always_check_shapes": false, "lstm_use_prev_action_reward": -1, "_use_default_native_models": -1, "_disable_preprocessor_api": false, "_disable_action_flattening": false}, "_learner_connector": null, "add_default_connectors_to_learner_pipeline": true, "learner_config_dict": {}, "optimizer": {}, "_learner_class": null, "callbacks_on_algorithm_init": null, "callbacks_on_env_runners_recreated": null, "callbacks_on_offline_eval_runners_recreated": null, "callbacks_on_checkpoint_loaded": null, "callbacks_on_environment_created": null, "callbacks_on_episode_created": null, "callbacks_on_episode_start": null, "callbacks_on_episode_step": null, "callbacks_on_episode_end": null, "callbacks_on_evaluate_start": null, "callbacks_on_evaluate_end": null, "callbacks_on_evaluate_offline_start": null, "callbacks_on_evaluate_offline_end": null, "callbacks_on_sample_end": null, "callbacks_on_train_result": null, "explore": true, "enable_rl_module_and_learner": true, "enable_env_runner_and_connector_v2": true, "_prior_exploration_config": {"type": "StochasticSampling"}, "count_steps_by": "env_steps", "policy_map_capacity": 100, "policy_mapping_fn": "<function AlgorithmConfig.DEFAULT_POLICY_MAPPING_FN at 0x161a518a0>", "policies_to_train": null, "policy_states_are_swappable": false, "observation_fn": null, "offline_data_class": null, "input_read_method": "read_parquet", "input_read_method_kwargs": {}, "input_read_schema": {}, "input_read_episodes": false, "input_read_sample_batches": false, "input_read_batch_size": null, "input_filesystem": null, "input_filesystem_kwargs": {}, "input_compress_columns": ["obs", "new_obs"], "input_spaces_jsonable": true, "materialize_data": false, "materialize_mapped_data": true, "map_batches_kwargs": {}, "iter_batches_kwargs": {}, "ignore_final_observation": false, "prelearner_class": null, "prelearner_buffer_class": null, "prelearner_buffer_kwargs": {}, "prelearner_module_synch_period": 10, "dataset_num_iters_per_learner": null, "input_config": {}, "actions_in_input_normalized": false, "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_config": {}, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "output_max_rows_per_file": null, "output_write_remaining_data": false, "output_write_method": "write_parquet", "output_write_method_kwargs": {}, "output_filesystem": null, "output_filesystem_kwargs": {}, "output_write_episodes": true, "offline_sampling": false, "evaluation_interval": 1, "evaluation_duration": 20, "evaluation_duration_unit": "episodes", "evaluation_sample_timeout_s": 120.0, "evaluation_auto_duration_min_env_steps_per_sample": 100, "evaluation_auto_duration_max_env_steps_per_sample": 2000, "evaluation_parallel_to_training": false, "evaluation_force_reset_envs_before_iteration": true, "evaluation_config": null, "off_policy_estimation_methods": {}, "ope_split_batch_by_episode": true, "evaluation_num_env_runners": 1, "in_evaluation": false, "sync_filters_on_rollout_workers_timeout_s": 10.0, "offline_evaluation_interval": null, "num_offline_eval_runners": 0, "offline_loss_for_module_fn": null, "offline_evaluation_duration": 1, "offline_evaluation_parallel_to_training": false, "offline_evaluation_timeout_s": 120.0, "num_cpus_per_offline_eval_runner": 1, "num_gpus_per_offline_eval_runner": 0, "custom_resources_per_offline_eval_runner": {}, "restart_failed_offline_eval_runners": true, "ignore_offline_eval_runner_failures": false, "max_num_offline_eval_runner_restarts": 1000, "offline_eval_runner_restore_timeout_s": 1800.0, "max_requests_in_flight_per_offline_eval_runner": 1, "validate_offline_eval_runners_after_construction": true, "offline_eval_runner_health_probe_timeout_s": 30.0, "offline_eval_rl_module_inference_only": false, "broadcast_offline_eval_runner_states": false, "offline_eval_batch_size_per_runner": 256, "dataset_num_iters_per_eval_runner": 1, "keep_per_episode_custom_metrics": false, "metrics_episode_collection_timeout_s": 60.0, "metrics_num_episodes_for_smoothing": 100, "min_time_s_per_iteration": null, "min_train_timesteps_per_iteration": 0, "min_sample_timesteps_per_iteration": 0, "log_gradients": true, "export_native_model_files": false, "checkpoint_trainable_policies_only": false, "logger_creator": null, "logger_config": null, "log_level": "WARN", "log_sys_usage": true, "fake_sampler": false, "seed": 10, "restart_failed_env_runners": true, "ignore_env_runner_failures": false, "max_num_env_runner_restarts": 1000, "delay_between_env_runner_restarts_s": 60.0, "restart_failed_sub_environments": false, "num_consecutive_env_runner_failures_tolerance": 100, "env_runner_health_probe_timeout_s": 30.0, "env_runner_restore_timeout_s": 1800.0, "_model_config": {}, "_rl_module_spec": "RLModuleSpec(module_class=None, observation_space=None, action_space=None, inference_only=False, learner_only=False, model_config=DefaultModelConfig(fcnet_hiddens=[60, 90], fcnet_activation='tanh', fcnet_kernel_initializer=None, fcnet_kernel_initializer_kwargs=None, fcnet_bias_initializer=None, fcnet_bias_initializer_kwargs=None, conv_filters=None, conv_activation='relu', conv_kernel_initializer=None, conv_kernel_initializer_kwargs=None, conv_bias_initializer=None, conv_bias_initializer_kwargs=None, head_fcnet_hiddens=[], head_fcnet_activation='relu', head_fcnet_kernel_initializer=None, head_fcnet_kernel_initializer_kwargs=None, head_fcnet_bias_initializer=None, head_fcnet_bias_initializer_kwargs=None, free_log_std=False, log_std_clip_param=20.0, vf_share_layers=True, use_lstm=False, max_seq_len=20, lstm_cell_size=256, lstm_use_prev_action=False, lstm_use_prev_reward=False, lstm_kernel_initializer=None, lstm_kernel_initializer_kwargs=None, lstm_bias_initializer=None, lstm_bias_initializer_kwargs=None), catalog_class=None, load_state_path=None, model_config_dict=None)", "algorithm_config_overrides_per_module": {}, "_per_module_overrides": {}, "_validate_config": true, "_use_msgpack_checkpoints": false, "_torch_grad_scaler_class": null, "_torch_lr_scheduler_classes": null, "_tf_policy_handles_more_than_one_loss": false, "_disable_preprocessor_api": false, "_disable_action_flattening": false, "_disable_initialize_loss_from_dummy_batch": false, "_dont_auto_sync_env_runner_states": false, "env_task_fn": -1, "enable_connectors": -1, "simple_optimizer": false, "policy_map_cache": -1, "worker_cls": -1, "synchronize_filters": -1, "enable_async_evaluation": -1, "custom_async_evaluation_function": -1, "_enable_rl_module_api": -1, "auto_wrap_old_gym_envs": -1, "always_attach_evaluation_results": -1, "replay_sequence_length": null, "_disable_execution_plan_api": -1, "use_critic": true, "use_gae": true, "use_kl_loss": true, "kl_coeff": 0.7464963036515, "kl_target": 0.0270990929592, "vf_loss_coeff": 0.6688075857018, "entropy_coeff": 0.0090570820258, "clip_param": 0.1221781641624, "vf_clip_param": 0.1027808522125, "entropy_coeff_schedule": null, "lr_schedule": null, "sgd_minibatch_size": -1, "vf_share_layers": -1, "__stdout_file__": null, "__stderr_file__": null, "lambda": 0.9099046732075, "input": "sampler", "policies": {"default_policy": [null, null, null, null]}, "callbacks": "<class 'ray.rllib.callbacks.callbacks.RLlibCallback'>", "create_env_on_driver": false, "custom_eval_function": null, "framework": "torch"}, "time_since_restore": 65.33485579490662, "iterations_since_restore": 8, "perf": {"cpu_util_percent": 94.07272727272726, "ram_util_percent": 79.90909090909089}}
{"timers": {"training_iteration": 16.50747012914243, "restore_env_runners": 0.00011320012991323153, "training_step": 16.50692180718457, "env_runner_sampling_timer": 15.84713571115532, "learner_update_timer": 0.6491548474427662, "synch_weights": 0.0017485706500460054, "restore_eval_env_runners": 3.5134771581982455e-05, "evaluation_iteration": 1.083893714191434, "synch_eval_env_connectors": 0.0004973431112885888, "synch_env_connectors": 8.934309698694896e-06}, "env_runners": {"episode_return_min": -10.5, "num_agent_steps_sampled_lifetime": {"default_agent": -4312500.0}, "module_to_env_connector": {"timers": {"connectors": {"remove_single_ts_time_rank_from_batch": 1.7107894513803465e-06, "normalize_and_clip_actions": 2.9903304621969073e-05, "listify_data_for_vector_env": 3.9192849883751225e-05, "get_actions": 0.00016370467823623462, "tensor_to_numpy": 7.200955449160154e-05, "un_batch_to_individual_items": 2.3687999983904894e-05}}, "connector_pipeline_timer": 0.00040707330582475813}, "episode_len_mean": 20.0, "num_module_steps_sampled": {"default_policy": 5000.0}, "env_to_module_connector": {"timers": {"connectors": {"add_states_from_episodes_to_batch": 3.6352398425547734e-06, "add_time_dim_to_batch_and_zero_pad": 6.685694462195176e-06, "numpy_to_tensor": 3.441362300831731e-05, "add_observations_from_episodes_to_batch": 8.850782572765418e-06, "batch_individual_items": 2.1799904149097466e-05}}, "connector_pipeline_timer": 0.00013225999984129555}, "sample": 0.019557553561623156, "env_to_module_sum_episodes_length_out": 10.36823839457432, "weights_seq_no": 8.0, "num_env_steps_sampled_lifetime": -4312500.0, "episode_return_max": 9.5, "episode_return_mean": 2.379999999999999, "module_episode_returns_mean": {"default_policy": 2.379999999999999}, "time_between_sampling": 0.004370326974862918, "rlmodule_inference_timer": 0.00011330731763177531, "env_step_timer": 5.930256103174844e-05, "env_reset_timer": 0.00014240355782091832, "agent_episode_returns_mean": {"default_agent": 2.379999999999999}, "num_env_steps_sampled": 5000.0, "episode_duration_sec_mean": 0.017411732530687007, "env_to_module_sum_episodes_length_in": 10.36823839457432, "episode_len_min": 20, "num_agent_steps_sampled": {"default_agent": 5000.0}, "num_episodes": 250.0, "num_module_steps_sampled_lifetime": {"default_policy": -4312500.0}, "episode_len_max": 20, "num_episodes_lifetime": -215625.0, "num_env_steps_sampled_lifetime_throughput": 1645.1379857802212}, "learners": {"__all_modules__": {"learner_connector": {"timers": {"connectors": {"general_advantage_estimation": 0.06369288752317015, "numpy_to_tensor": 0.0006337943486952939, "add_observations_from_episodes_to_batch": 0.004328210357833119, "add_one_ts_to_episodes_and_truncate": 0.03132087934821435, "batch_individual_items": 0.10762626137990162, "add_states_from_episodes_to_batch": 5.366977779667836e-06, "add_columns_from_episodes_to_train_batch": 0.18554000558598707, "add_time_dim_to_batch_and_zero_pad": 1.8640146512177364e-05}}, "connector_pipeline_timer": 0.39368648064037653}, "num_module_steps_trained_lifetime": 54000, "num_non_trainable_parameters": 0, "learner_connector_sum_episodes_length_out": 5250.0, "num_module_steps_trained": 6000, "num_trainable_parameters": 6003, "num_env_steps_trained": 31500, "num_env_steps_trained_lifetime": 283500, "learner_connector_sum_episodes_length_in": 5000.0, "num_env_steps_trained_lifetime_throughput": 357219.9456390698, "num_module_steps_trained_throughput": 68249.18406541094, "num_module_steps_trained_lifetime_throughput": 68110.84416380458}, "default_policy": {"curr_kl_coeff": 0.0014580006245523691, "entropy": 0.6498231291770935, "vf_loss": 0.10278083384037018, "default_optimizer_learning_rate": 0.0002847858517, "vf_explained_var": -0.010897278785705566, "total_loss": -0.021834900602698326, "num_trainable_parameters": 6003, "vf_loss_unclipped": 28.564573287963867, "curr_entropy_coeff": 0.0090570820258, "policy_loss": -0.08469157665967941, "diff_num_grad_updates_vs_sampler_policy": 1.0, "mean_kl_loss": 0.000535716419108212, "gradients_default_optimizer_global_norm": 0.05511411279439926, "num_module_steps_trained_lifetime": 54000, "weights_seq_no": 9.0, "num_module_steps_trained": 6000, "module_train_batch_size_mean": 1000.0, "num_module_steps_trained_lifetime_throughput": 68156.04644773211}}, "num_training_step_calls_per_iteration": 1, "evaluation": {"env_runners": {"env_to_module_connector": {"timers": {"connectors": {"add_states_from_episodes_to_batch": 2.4349171709806024e-06, "numpy_to_tensor": 1.4168730072631946e-05, "add_time_dim_to_batch_and_zero_pad": 3.532250554578546e-06, "add_observations_from_episodes_to_batch": 4.138617653285591e-06, "batch_individual_items": 1.0043309485258833e-05}}, "connector_pipeline_timer": 6.85528838779087e-05}, "agent_episode_returns_mean": {"default_agent": 0.65}, "num_agent_steps_sampled": {"default_agent": 400}, "num_env_steps_sampled_lifetime": 45400, "num_env_steps_sampled": 400, "num_episodes": 20, "episode_len_max": 20, "episode_return_min": -14.5, "episode_len_mean": 20.0, "env_to_module_sum_episodes_length_out": 10.368238394574323, "num_module_steps_sampled_lifetime": {"default_policy": 3600}, "num_agent_steps_sampled_lifetime": {"default_agent": 3600}, "module_to_env_connector": {"timers": {"connectors": {"get_actions": 7.28789015518459e-05, "normalize_and_clip_actions": 1.55632970159244e-05, "tensor_to_numpy": 2.2569937135897844e-05, "remove_single_ts_time_rank_from_batch": 9.23881283447682e-07, "listify_data_for_vector_env": 1.6697392627656657e-05, "un_batch_to_individual_items": 7.7614799081634e-06}}, "connector_pipeline_timer": 0.0001742166107621069}, "episode_return_mean": 0.65, "env_reset_timer": 0.004418451508744092, "module_episode_returns_mean": {"default_policy": 0.65}, "num_episodes_lifetime": 180, "sample": 1.0245094632260485, "num_module_steps_sampled": {"default_policy": 400}, "env_step_timer": 2.279395111278585e-05, "episode_duration_sec_mean": 0.01140038539422676, "env_to_module_sum_episodes_length_in": 10.368238394574323, "episode_len_min": 20, "weights_seq_no": 9.0, "episode_return_max": 13.5, "rlmodule_inference_timer": 4.937947169188209e-05, "time_between_sampling": 11.448672289444119}, "num_healthy_workers": 1, "actor_manager_num_outstanding_async_reqs": 0, "num_remote_worker_restarts": 0}, "num_env_steps_sampled_lifetime": -4312500.0, "fault_tolerance": {"num_healthy_workers": 0, "num_remote_worker_restarts": 0}, "env_runner_group": {"actor_manager_num_outstanding_async_reqs": 0}, "done": false, "training_iteration": 9, "trial_id": "4d8e6_00000", "date": "2025-08-11_19-29-13", "timestamp": 1754933353, "time_this_iter_s": 5.99388313293457, "time_total_s": 71.32873892784119, "pid": 19818, "hostname": "Mac", "node_ip": "127.0.0.1", "config": {"exploration_config": {}, "extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "placement_strategy": "PACK", "num_gpus": 0, "_fake_gpus": false, "num_cpus_for_main_process": 2, "eager_tracing": true, "eager_max_retraces": 20, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "torch_compile_learner": false, "torch_compile_learner_what_to_compile": "forward_train", "torch_compile_learner_dynamo_backend": "aot_eager", "torch_compile_learner_dynamo_mode": null, "torch_compile_worker": false, "torch_compile_worker_dynamo_backend": "aot_eager", "torch_compile_worker_dynamo_mode": null, "torch_ddp_kwargs": {}, "torch_skip_nan_gradients": false, "env": "Umbrella", "env_config": {}, "observation_space": null, "action_space": null, "clip_rewards": null, "normalize_actions": true, "clip_actions": false, "_is_atari": null, "disable_env_checking": false, "render_env": false, "action_mask_key": "action_mask", "env_runner_cls": null, "num_env_runners": 0, "create_local_env_runner": true, "num_envs_per_env_runner": 1, "gym_env_vectorize_mode": "SYNC", "num_cpus_per_env_runner": 1, "num_gpus_per_env_runner": 0, "custom_resources_per_env_runner": {}, "validate_env_runners_after_construction": true, "episodes_to_numpy": true, "max_requests_in_flight_per_env_runner": 1, "sample_timeout_s": 60.0, "_env_to_module_connector": null, "add_default_connectors_to_env_to_module_pipeline": true, "_module_to_env_connector": null, "add_default_connectors_to_module_to_env_pipeline": true, "merge_env_runner_states": "training_only", "broadcast_env_runner_states": true, "episode_lookback_horizon": 1, "rollout_fragment_length": "auto", "batch_mode": "complete_episodes", "compress_observations": false, "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "enable_tf1_exec_eagerly": false, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "preprocessor_pref": "deepmind", "observation_filter": "NoFilter", "update_worker_filter_stats": true, "use_worker_filter_stats": true, "sampler_perf_stats_ema_coef": null, "_is_online": true, "num_learners": 0, "num_gpus_per_learner": 0, "num_cpus_per_learner": "auto", "num_aggregator_actors_per_learner": 0, "max_requests_in_flight_per_aggregator_actor": 3, "local_gpu_idx": 0, "max_requests_in_flight_per_learner": 3, "gamma": 1, "lr": 0.0002847858517, "grad_clip": 0.5, "grad_clip_by": "global_norm", "_train_batch_size_per_learner": 5000, "train_batch_size": 4000, "num_epochs": 1, "minibatch_size": 1000, "shuffle_batch_per_epoch": true, "model": {"fcnet_hiddens": [256, 256], "fcnet_activation": "tanh", "fcnet_weights_initializer": null, "fcnet_weights_initializer_config": null, "fcnet_bias_initializer": null, "fcnet_bias_initializer_config": null, "conv_filters": null, "conv_activation": "relu", "conv_kernel_initializer": null, "conv_kernel_initializer_config": null, "conv_bias_initializer": null, "conv_bias_initializer_config": null, "conv_transpose_kernel_initializer": null, "conv_transpose_kernel_initializer_config": null, "conv_transpose_bias_initializer": null, "conv_transpose_bias_initializer_config": null, "post_fcnet_hiddens": [], "post_fcnet_activation": "relu", "post_fcnet_weights_initializer": null, "post_fcnet_weights_initializer_config": null, "post_fcnet_bias_initializer": null, "post_fcnet_bias_initializer_config": null, "free_log_std": false, "log_std_clip_param": 20.0, "no_final_linear": false, "vf_share_layers": false, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "lstm_weights_initializer": null, "lstm_weights_initializer_config": null, "lstm_bias_initializer": null, "lstm_bias_initializer_config": null, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "attention_use_n_prev_actions": 0, "attention_use_n_prev_rewards": 0, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": null, "custom_model_config": {}, "custom_action_dist": null, "custom_preprocessor": null, "encoder_latent_dim": null, "always_check_shapes": false, "lstm_use_prev_action_reward": -1, "_use_default_native_models": -1, "_disable_preprocessor_api": false, "_disable_action_flattening": false}, "_learner_connector": null, "add_default_connectors_to_learner_pipeline": true, "learner_config_dict": {}, "optimizer": {}, "_learner_class": null, "callbacks_on_algorithm_init": null, "callbacks_on_env_runners_recreated": null, "callbacks_on_offline_eval_runners_recreated": null, "callbacks_on_checkpoint_loaded": null, "callbacks_on_environment_created": null, "callbacks_on_episode_created": null, "callbacks_on_episode_start": null, "callbacks_on_episode_step": null, "callbacks_on_episode_end": null, "callbacks_on_evaluate_start": null, "callbacks_on_evaluate_end": null, "callbacks_on_evaluate_offline_start": null, "callbacks_on_evaluate_offline_end": null, "callbacks_on_sample_end": null, "callbacks_on_train_result": null, "explore": true, "enable_rl_module_and_learner": true, "enable_env_runner_and_connector_v2": true, "_prior_exploration_config": {"type": "StochasticSampling"}, "count_steps_by": "env_steps", "policy_map_capacity": 100, "policy_mapping_fn": "<function AlgorithmConfig.DEFAULT_POLICY_MAPPING_FN at 0x161a518a0>", "policies_to_train": null, "policy_states_are_swappable": false, "observation_fn": null, "offline_data_class": null, "input_read_method": "read_parquet", "input_read_method_kwargs": {}, "input_read_schema": {}, "input_read_episodes": false, "input_read_sample_batches": false, "input_read_batch_size": null, "input_filesystem": null, "input_filesystem_kwargs": {}, "input_compress_columns": ["obs", "new_obs"], "input_spaces_jsonable": true, "materialize_data": false, "materialize_mapped_data": true, "map_batches_kwargs": {}, "iter_batches_kwargs": {}, "ignore_final_observation": false, "prelearner_class": null, "prelearner_buffer_class": null, "prelearner_buffer_kwargs": {}, "prelearner_module_synch_period": 10, "dataset_num_iters_per_learner": null, "input_config": {}, "actions_in_input_normalized": false, "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_config": {}, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "output_max_rows_per_file": null, "output_write_remaining_data": false, "output_write_method": "write_parquet", "output_write_method_kwargs": {}, "output_filesystem": null, "output_filesystem_kwargs": {}, "output_write_episodes": true, "offline_sampling": false, "evaluation_interval": 1, "evaluation_duration": 20, "evaluation_duration_unit": "episodes", "evaluation_sample_timeout_s": 120.0, "evaluation_auto_duration_min_env_steps_per_sample": 100, "evaluation_auto_duration_max_env_steps_per_sample": 2000, "evaluation_parallel_to_training": false, "evaluation_force_reset_envs_before_iteration": true, "evaluation_config": null, "off_policy_estimation_methods": {}, "ope_split_batch_by_episode": true, "evaluation_num_env_runners": 1, "in_evaluation": false, "sync_filters_on_rollout_workers_timeout_s": 10.0, "offline_evaluation_interval": null, "num_offline_eval_runners": 0, "offline_loss_for_module_fn": null, "offline_evaluation_duration": 1, "offline_evaluation_parallel_to_training": false, "offline_evaluation_timeout_s": 120.0, "num_cpus_per_offline_eval_runner": 1, "num_gpus_per_offline_eval_runner": 0, "custom_resources_per_offline_eval_runner": {}, "restart_failed_offline_eval_runners": true, "ignore_offline_eval_runner_failures": false, "max_num_offline_eval_runner_restarts": 1000, "offline_eval_runner_restore_timeout_s": 1800.0, "max_requests_in_flight_per_offline_eval_runner": 1, "validate_offline_eval_runners_after_construction": true, "offline_eval_runner_health_probe_timeout_s": 30.0, "offline_eval_rl_module_inference_only": false, "broadcast_offline_eval_runner_states": false, "offline_eval_batch_size_per_runner": 256, "dataset_num_iters_per_eval_runner": 1, "keep_per_episode_custom_metrics": false, "metrics_episode_collection_timeout_s": 60.0, "metrics_num_episodes_for_smoothing": 100, "min_time_s_per_iteration": null, "min_train_timesteps_per_iteration": 0, "min_sample_timesteps_per_iteration": 0, "log_gradients": true, "export_native_model_files": false, "checkpoint_trainable_policies_only": false, "logger_creator": null, "logger_config": null, "log_level": "WARN", "log_sys_usage": true, "fake_sampler": false, "seed": 10, "restart_failed_env_runners": true, "ignore_env_runner_failures": false, "max_num_env_runner_restarts": 1000, "delay_between_env_runner_restarts_s": 60.0, "restart_failed_sub_environments": false, "num_consecutive_env_runner_failures_tolerance": 100, "env_runner_health_probe_timeout_s": 30.0, "env_runner_restore_timeout_s": 1800.0, "_model_config": {}, "_rl_module_spec": "RLModuleSpec(module_class=None, observation_space=None, action_space=None, inference_only=False, learner_only=False, model_config=DefaultModelConfig(fcnet_hiddens=[60, 90], fcnet_activation='tanh', fcnet_kernel_initializer=None, fcnet_kernel_initializer_kwargs=None, fcnet_bias_initializer=None, fcnet_bias_initializer_kwargs=None, conv_filters=None, conv_activation='relu', conv_kernel_initializer=None, conv_kernel_initializer_kwargs=None, conv_bias_initializer=None, conv_bias_initializer_kwargs=None, head_fcnet_hiddens=[], head_fcnet_activation='relu', head_fcnet_kernel_initializer=None, head_fcnet_kernel_initializer_kwargs=None, head_fcnet_bias_initializer=None, head_fcnet_bias_initializer_kwargs=None, free_log_std=False, log_std_clip_param=20.0, vf_share_layers=True, use_lstm=False, max_seq_len=20, lstm_cell_size=256, lstm_use_prev_action=False, lstm_use_prev_reward=False, lstm_kernel_initializer=None, lstm_kernel_initializer_kwargs=None, lstm_bias_initializer=None, lstm_bias_initializer_kwargs=None), catalog_class=None, load_state_path=None, model_config_dict=None)", "algorithm_config_overrides_per_module": {}, "_per_module_overrides": {}, "_validate_config": true, "_use_msgpack_checkpoints": false, "_torch_grad_scaler_class": null, "_torch_lr_scheduler_classes": null, "_tf_policy_handles_more_than_one_loss": false, "_disable_preprocessor_api": false, "_disable_action_flattening": false, "_disable_initialize_loss_from_dummy_batch": false, "_dont_auto_sync_env_runner_states": false, "env_task_fn": -1, "enable_connectors": -1, "simple_optimizer": false, "policy_map_cache": -1, "worker_cls": -1, "synchronize_filters": -1, "enable_async_evaluation": -1, "custom_async_evaluation_function": -1, "_enable_rl_module_api": -1, "auto_wrap_old_gym_envs": -1, "always_attach_evaluation_results": -1, "replay_sequence_length": null, "_disable_execution_plan_api": -1, "use_critic": true, "use_gae": true, "use_kl_loss": true, "kl_coeff": 0.7464963036515, "kl_target": 0.0270990929592, "vf_loss_coeff": 0.6688075857018, "entropy_coeff": 0.0090570820258, "clip_param": 0.1221781641624, "vf_clip_param": 0.1027808522125, "entropy_coeff_schedule": null, "lr_schedule": null, "sgd_minibatch_size": -1, "vf_share_layers": -1, "__stdout_file__": null, "__stderr_file__": null, "lambda": 0.9099046732075, "input": "sampler", "policies": {"default_policy": [null, null, null, null]}, "callbacks": "<class 'ray.rllib.callbacks.callbacks.RLlibCallback'>", "create_env_on_driver": false, "custom_eval_function": null, "framework": "torch"}, "time_since_restore": 71.32873892784119, "iterations_since_restore": 9, "perf": {"cpu_util_percent": 91.48888888888888, "ram_util_percent": 82.9888888888889}}
{"timers": {"training_iteration": 16.389856854930986, "restore_env_runners": 0.00011212853885290165, "training_step": 16.389311929942824, "env_runner_sampling_timer": 15.73091758446394, "learner_update_timer": 0.6478300147977388, "synch_weights": 0.0017396678529042107, "restore_eval_env_runners": 3.495384309163186e-05, "evaluation_iteration": 1.0758925907998946, "synch_eval_env_connectors": 0.0004938846800701282, "synch_env_connectors": 8.884546646975886e-06}, "env_runners": {"episode_return_min": -10.5, "num_agent_steps_sampled_lifetime": {"default_agent": -4930000.0}, "module_to_env_connector": {"timers": {"connectors": {"remove_single_ts_time_rank_from_batch": 1.9985751024440552e-06, "normalize_and_clip_actions": 2.557670795631948e-05, "listify_data_for_vector_env": 3.29402303800089e-05, "get_actions": 0.00014979818280311147, "tensor_to_numpy": 4.374459249113278e-05, "un_batch_to_individual_items": 2.025830457451092e-05}}, "connector_pipeline_timer": 0.0003436457942868366}, "episode_len_mean": 20.0, "num_module_steps_sampled": {"default_policy": 5000.0}, "env_to_module_connector": {"timers": {"connectors": {"add_states_from_episodes_to_batch": 3.576988807782119e-06, "add_time_dim_to_batch_and_zero_pad": 6.45859479864506e-06, "numpy_to_tensor": 2.9660902191488997e-05, "add_observations_from_episodes_to_batch": 1.0111580097851216e-05, "batch_individual_items": 2.1263481860148492e-05}}, "connector_pipeline_timer": 0.00011981322383400939}, "sample": 0.017827811132501682, "env_to_module_sum_episodes_length_out": 10.36823839457432, "weights_seq_no": 9.0, "num_env_steps_sampled_lifetime": -4930000.0, "episode_return_max": 9.5, "episode_return_mean": 2.460000000000001, "module_episode_returns_mean": {"default_policy": 2.460000000000001}, "time_between_sampling": 0.005504225959857467, "rlmodule_inference_timer": 9.972028649063761e-05, "env_step_timer": 4.8077332087997984e-05, "env_reset_timer": 0.00013940301551327477, "agent_episode_returns_mean": {"default_agent": 2.460000000000001}, "num_env_steps_sampled": 5000.0, "episode_duration_sec_mean": 0.01449368650279939, "env_to_module_sum_episodes_length_in": 10.36823839457432, "episode_len_min": 20, "num_agent_steps_sampled": {"default_agent": 5000.0}, "num_episodes": 250.0, "num_module_steps_sampled_lifetime": {"default_policy": -4930000.0}, "episode_len_max": 20, "num_episodes_lifetime": -246500.0, "num_env_steps_sampled_lifetime_throughput": 1633.276883758051}, "learners": {"__all_modules__": {"learner_connector": {"timers": {"connectors": {"general_advantage_estimation": 0.06316365614785441, "numpy_to_tensor": 0.000628158905318833, "add_observations_from_episodes_to_batch": 0.004344418673480555, "add_one_ts_to_episodes_and_truncate": 0.03131233138561179, "batch_individual_items": 0.1094432204261541, "add_states_from_episodes_to_batch": 5.402477481777716e-06, "add_columns_from_episodes_to_train_batch": 0.18513474470017408, "add_time_dim_to_batch_and_zero_pad": 1.876916421247314e-05}}, "connector_pipeline_timer": 0.3945684108337101}, "num_module_steps_trained_lifetime": 60000, "num_non_trainable_parameters": 0, "learner_connector_sum_episodes_length_out": 5250.0, "num_module_steps_trained": 6000, "num_trainable_parameters": 6003, "num_env_steps_trained": 31500, "num_env_steps_trained_lifetime": 315000, "learner_connector_sum_episodes_length_in": 5000.0, "num_env_steps_trained_lifetime_throughput": 379390.1638017562, "num_module_steps_trained_throughput": 72501.69407032694, "num_module_steps_trained_lifetime_throughput": 72330.96450169972}, "default_policy": {"curr_kl_coeff": 0.0007290003122761846, "entropy": 0.6338445544242859, "vf_loss": 0.10278083384037018, "default_optimizer_learning_rate": 0.0002847858517, "vf_explained_var": -0.010891318321228027, "total_loss": -0.09232137352228165, "num_trainable_parameters": 6003, "vf_loss_unclipped": 28.557741165161133, "curr_entropy_coeff": 0.0090570820258, "policy_loss": -0.15532250702381134, "diff_num_grad_updates_vs_sampler_policy": 1.0, "mean_kl_loss": 0.0009032915695570409, "gradients_default_optimizer_global_norm": 0.012517706491053104, "num_module_steps_trained_lifetime": 60000, "weights_seq_no": 10.0, "num_module_steps_trained": 6000, "module_train_batch_size_mean": 1000.0, "num_module_steps_trained_lifetime_throughput": 72401.39606062122}}, "num_training_step_calls_per_iteration": 1, "evaluation": {"env_runners": {"env_to_module_connector": {"timers": {"connectors": {"add_states_from_episodes_to_batch": 6.481185167407693e-06, "numpy_to_tensor": 2.581294294264369e-05, "add_time_dim_to_batch_and_zero_pad": 6.230215058961104e-06, "add_observations_from_episodes_to_batch": 1.2229587077214368e-05, "batch_individual_items": 1.8164923920636383e-05}}, "connector_pipeline_timer": 0.0001296897569859309}, "agent_episode_returns_mean": {"default_agent": 0.65}, "num_agent_steps_sampled": {"default_agent": 400}, "num_env_steps_sampled_lifetime": 50400, "num_env_steps_sampled": 400, "num_episodes": 20, "episode_len_max": 20, "episode_return_min": -14.5, "episode_len_mean": 20.0, "env_to_module_sum_episodes_length_out": 10.368238394574323, "num_module_steps_sampled_lifetime": {"default_policy": 4000}, "num_agent_steps_sampled_lifetime": {"default_agent": 4000}, "module_to_env_connector": {"timers": {"connectors": {"get_actions": 0.00021254139473516245, "normalize_and_clip_actions": 2.6814075741772403e-05, "tensor_to_numpy": 5.261630035778432e-05, "remove_single_ts_time_rank_from_batch": 1.3225091899325661e-06, "listify_data_for_vector_env": 2.752820365225935e-05, "un_batch_to_individual_items": 1.3556501952134419e-05}}, "connector_pipeline_timer": 0.0004260837291344772}, "episode_return_mean": 0.65, "env_reset_timer": 0.004375207414088668, "module_episode_returns_mean": {"default_policy": 0.65}, "num_episodes_lifetime": 200, "sample": 1.0179286148441977, "num_module_steps_sampled": {"default_policy": 400}, "env_step_timer": 4.667232039405981e-05, "episode_duration_sec_mean": 0.01261303375242278, "env_to_module_sum_episodes_length_in": 10.368238394574323, "episode_len_min": 20, "weights_seq_no": 10.0, "episode_return_max": 13.5, "rlmodule_inference_timer": 8.701920535305099e-05, "time_between_sampling": 11.382051239050016}, "num_healthy_workers": 1, "actor_manager_num_outstanding_async_reqs": 0, "num_remote_worker_restarts": 0}, "num_env_steps_sampled_lifetime": -4930000.0, "fault_tolerance": {"num_healthy_workers": 0, "num_remote_worker_restarts": 0}, "env_runner_group": {"actor_manager_num_outstanding_async_reqs": 0}, "done": false, "training_iteration": 10, "trial_id": "4d8e6_00000", "date": "2025-08-11_19-29-18", "timestamp": 1754933358, "time_this_iter_s": 5.1324827671051025, "time_total_s": 76.46122169494629, "pid": 19818, "hostname": "Mac", "node_ip": "127.0.0.1", "config": {"exploration_config": {}, "extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "placement_strategy": "PACK", "num_gpus": 0, "_fake_gpus": false, "num_cpus_for_main_process": 2, "eager_tracing": true, "eager_max_retraces": 20, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "torch_compile_learner": false, "torch_compile_learner_what_to_compile": "forward_train", "torch_compile_learner_dynamo_backend": "aot_eager", "torch_compile_learner_dynamo_mode": null, "torch_compile_worker": false, "torch_compile_worker_dynamo_backend": "aot_eager", "torch_compile_worker_dynamo_mode": null, "torch_ddp_kwargs": {}, "torch_skip_nan_gradients": false, "env": "Umbrella", "env_config": {}, "observation_space": null, "action_space": null, "clip_rewards": null, "normalize_actions": true, "clip_actions": false, "_is_atari": null, "disable_env_checking": false, "render_env": false, "action_mask_key": "action_mask", "env_runner_cls": null, "num_env_runners": 0, "create_local_env_runner": true, "num_envs_per_env_runner": 1, "gym_env_vectorize_mode": "SYNC", "num_cpus_per_env_runner": 1, "num_gpus_per_env_runner": 0, "custom_resources_per_env_runner": {}, "validate_env_runners_after_construction": true, "episodes_to_numpy": true, "max_requests_in_flight_per_env_runner": 1, "sample_timeout_s": 60.0, "_env_to_module_connector": null, "add_default_connectors_to_env_to_module_pipeline": true, "_module_to_env_connector": null, "add_default_connectors_to_module_to_env_pipeline": true, "merge_env_runner_states": "training_only", "broadcast_env_runner_states": true, "episode_lookback_horizon": 1, "rollout_fragment_length": "auto", "batch_mode": "complete_episodes", "compress_observations": false, "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "enable_tf1_exec_eagerly": false, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "preprocessor_pref": "deepmind", "observation_filter": "NoFilter", "update_worker_filter_stats": true, "use_worker_filter_stats": true, "sampler_perf_stats_ema_coef": null, "_is_online": true, "num_learners": 0, "num_gpus_per_learner": 0, "num_cpus_per_learner": "auto", "num_aggregator_actors_per_learner": 0, "max_requests_in_flight_per_aggregator_actor": 3, "local_gpu_idx": 0, "max_requests_in_flight_per_learner": 3, "gamma": 1, "lr": 0.0002847858517, "grad_clip": 0.5, "grad_clip_by": "global_norm", "_train_batch_size_per_learner": 5000, "train_batch_size": 4000, "num_epochs": 1, "minibatch_size": 1000, "shuffle_batch_per_epoch": true, "model": {"fcnet_hiddens": [256, 256], "fcnet_activation": "tanh", "fcnet_weights_initializer": null, "fcnet_weights_initializer_config": null, "fcnet_bias_initializer": null, "fcnet_bias_initializer_config": null, "conv_filters": null, "conv_activation": "relu", "conv_kernel_initializer": null, "conv_kernel_initializer_config": null, "conv_bias_initializer": null, "conv_bias_initializer_config": null, "conv_transpose_kernel_initializer": null, "conv_transpose_kernel_initializer_config": null, "conv_transpose_bias_initializer": null, "conv_transpose_bias_initializer_config": null, "post_fcnet_hiddens": [], "post_fcnet_activation": "relu", "post_fcnet_weights_initializer": null, "post_fcnet_weights_initializer_config": null, "post_fcnet_bias_initializer": null, "post_fcnet_bias_initializer_config": null, "free_log_std": false, "log_std_clip_param": 20.0, "no_final_linear": false, "vf_share_layers": false, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "lstm_weights_initializer": null, "lstm_weights_initializer_config": null, "lstm_bias_initializer": null, "lstm_bias_initializer_config": null, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "attention_use_n_prev_actions": 0, "attention_use_n_prev_rewards": 0, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": null, "custom_model_config": {}, "custom_action_dist": null, "custom_preprocessor": null, "encoder_latent_dim": null, "always_check_shapes": false, "lstm_use_prev_action_reward": -1, "_use_default_native_models": -1, "_disable_preprocessor_api": false, "_disable_action_flattening": false}, "_learner_connector": null, "add_default_connectors_to_learner_pipeline": true, "learner_config_dict": {}, "optimizer": {}, "_learner_class": null, "callbacks_on_algorithm_init": null, "callbacks_on_env_runners_recreated": null, "callbacks_on_offline_eval_runners_recreated": null, "callbacks_on_checkpoint_loaded": null, "callbacks_on_environment_created": null, "callbacks_on_episode_created": null, "callbacks_on_episode_start": null, "callbacks_on_episode_step": null, "callbacks_on_episode_end": null, "callbacks_on_evaluate_start": null, "callbacks_on_evaluate_end": null, "callbacks_on_evaluate_offline_start": null, "callbacks_on_evaluate_offline_end": null, "callbacks_on_sample_end": null, "callbacks_on_train_result": null, "explore": true, "enable_rl_module_and_learner": true, "enable_env_runner_and_connector_v2": true, "_prior_exploration_config": {"type": "StochasticSampling"}, "count_steps_by": "env_steps", "policy_map_capacity": 100, "policy_mapping_fn": "<function AlgorithmConfig.DEFAULT_POLICY_MAPPING_FN at 0x161a518a0>", "policies_to_train": null, "policy_states_are_swappable": false, "observation_fn": null, "offline_data_class": null, "input_read_method": "read_parquet", "input_read_method_kwargs": {}, "input_read_schema": {}, "input_read_episodes": false, "input_read_sample_batches": false, "input_read_batch_size": null, "input_filesystem": null, "input_filesystem_kwargs": {}, "input_compress_columns": ["obs", "new_obs"], "input_spaces_jsonable": true, "materialize_data": false, "materialize_mapped_data": true, "map_batches_kwargs": {}, "iter_batches_kwargs": {}, "ignore_final_observation": false, "prelearner_class": null, "prelearner_buffer_class": null, "prelearner_buffer_kwargs": {}, "prelearner_module_synch_period": 10, "dataset_num_iters_per_learner": null, "input_config": {}, "actions_in_input_normalized": false, "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_config": {}, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "output_max_rows_per_file": null, "output_write_remaining_data": false, "output_write_method": "write_parquet", "output_write_method_kwargs": {}, "output_filesystem": null, "output_filesystem_kwargs": {}, "output_write_episodes": true, "offline_sampling": false, "evaluation_interval": 1, "evaluation_duration": 20, "evaluation_duration_unit": "episodes", "evaluation_sample_timeout_s": 120.0, "evaluation_auto_duration_min_env_steps_per_sample": 100, "evaluation_auto_duration_max_env_steps_per_sample": 2000, "evaluation_parallel_to_training": false, "evaluation_force_reset_envs_before_iteration": true, "evaluation_config": null, "off_policy_estimation_methods": {}, "ope_split_batch_by_episode": true, "evaluation_num_env_runners": 1, "in_evaluation": false, "sync_filters_on_rollout_workers_timeout_s": 10.0, "offline_evaluation_interval": null, "num_offline_eval_runners": 0, "offline_loss_for_module_fn": null, "offline_evaluation_duration": 1, "offline_evaluation_parallel_to_training": false, "offline_evaluation_timeout_s": 120.0, "num_cpus_per_offline_eval_runner": 1, "num_gpus_per_offline_eval_runner": 0, "custom_resources_per_offline_eval_runner": {}, "restart_failed_offline_eval_runners": true, "ignore_offline_eval_runner_failures": false, "max_num_offline_eval_runner_restarts": 1000, "offline_eval_runner_restore_timeout_s": 1800.0, "max_requests_in_flight_per_offline_eval_runner": 1, "validate_offline_eval_runners_after_construction": true, "offline_eval_runner_health_probe_timeout_s": 30.0, "offline_eval_rl_module_inference_only": false, "broadcast_offline_eval_runner_states": false, "offline_eval_batch_size_per_runner": 256, "dataset_num_iters_per_eval_runner": 1, "keep_per_episode_custom_metrics": false, "metrics_episode_collection_timeout_s": 60.0, "metrics_num_episodes_for_smoothing": 100, "min_time_s_per_iteration": null, "min_train_timesteps_per_iteration": 0, "min_sample_timesteps_per_iteration": 0, "log_gradients": true, "export_native_model_files": false, "checkpoint_trainable_policies_only": false, "logger_creator": null, "logger_config": null, "log_level": "WARN", "log_sys_usage": true, "fake_sampler": false, "seed": 10, "restart_failed_env_runners": true, "ignore_env_runner_failures": false, "max_num_env_runner_restarts": 1000, "delay_between_env_runner_restarts_s": 60.0, "restart_failed_sub_environments": false, "num_consecutive_env_runner_failures_tolerance": 100, "env_runner_health_probe_timeout_s": 30.0, "env_runner_restore_timeout_s": 1800.0, "_model_config": {}, "_rl_module_spec": "RLModuleSpec(module_class=None, observation_space=None, action_space=None, inference_only=False, learner_only=False, model_config=DefaultModelConfig(fcnet_hiddens=[60, 90], fcnet_activation='tanh', fcnet_kernel_initializer=None, fcnet_kernel_initializer_kwargs=None, fcnet_bias_initializer=None, fcnet_bias_initializer_kwargs=None, conv_filters=None, conv_activation='relu', conv_kernel_initializer=None, conv_kernel_initializer_kwargs=None, conv_bias_initializer=None, conv_bias_initializer_kwargs=None, head_fcnet_hiddens=[], head_fcnet_activation='relu', head_fcnet_kernel_initializer=None, head_fcnet_kernel_initializer_kwargs=None, head_fcnet_bias_initializer=None, head_fcnet_bias_initializer_kwargs=None, free_log_std=False, log_std_clip_param=20.0, vf_share_layers=True, use_lstm=False, max_seq_len=20, lstm_cell_size=256, lstm_use_prev_action=False, lstm_use_prev_reward=False, lstm_kernel_initializer=None, lstm_kernel_initializer_kwargs=None, lstm_bias_initializer=None, lstm_bias_initializer_kwargs=None), catalog_class=None, load_state_path=None, model_config_dict=None)", "algorithm_config_overrides_per_module": {}, "_per_module_overrides": {}, "_validate_config": true, "_use_msgpack_checkpoints": false, "_torch_grad_scaler_class": null, "_torch_lr_scheduler_classes": null, "_tf_policy_handles_more_than_one_loss": false, "_disable_preprocessor_api": false, "_disable_action_flattening": false, "_disable_initialize_loss_from_dummy_batch": false, "_dont_auto_sync_env_runner_states": false, "env_task_fn": -1, "enable_connectors": -1, "simple_optimizer": false, "policy_map_cache": -1, "worker_cls": -1, "synchronize_filters": -1, "enable_async_evaluation": -1, "custom_async_evaluation_function": -1, "_enable_rl_module_api": -1, "auto_wrap_old_gym_envs": -1, "always_attach_evaluation_results": -1, "replay_sequence_length": null, "_disable_execution_plan_api": -1, "use_critic": true, "use_gae": true, "use_kl_loss": true, "kl_coeff": 0.7464963036515, "kl_target": 0.0270990929592, "vf_loss_coeff": 0.6688075857018, "entropy_coeff": 0.0090570820258, "clip_param": 0.1221781641624, "vf_clip_param": 0.1027808522125, "entropy_coeff_schedule": null, "lr_schedule": null, "sgd_minibatch_size": -1, "vf_share_layers": -1, "__stdout_file__": null, "__stderr_file__": null, "lambda": 0.9099046732075, "input": "sampler", "policies": {"default_policy": [null, null, null, null]}, "callbacks": "<class 'ray.rllib.callbacks.callbacks.RLlibCallback'>", "create_env_on_driver": false, "custom_eval_function": null, "framework": "torch"}, "time_since_restore": 76.46122169494629, "iterations_since_restore": 10, "perf": {"cpu_util_percent": 77.75714285714287, "ram_util_percent": 82.8142857142857}}
{"timers": {"training_iteration": 16.27446936055191, "restore_env_runners": 0.00011106892331695723, "training_step": 16.273927980644306, "env_runner_sampling_timer": 15.61965640986932, "learner_update_timer": 0.6437769021499552, "synch_weights": 0.0017294545049743872, "restore_eval_env_runners": 3.467763467193433e-05, "evaluation_iteration": 1.0689663919816528, "synch_eval_env_connectors": 0.0004909954239632136, "synch_env_connectors": 8.853201036262886e-06}, "env_runners": {"episode_return_min": -10.5, "num_agent_steps_sampled_lifetime": {"default_agent": -5547500.0}, "module_to_env_connector": {"timers": {"connectors": {"remove_single_ts_time_rank_from_batch": 1.538611422844051e-06, "normalize_and_clip_actions": 2.4663143039978117e-05, "listify_data_for_vector_env": 3.8925683810661e-05, "get_actions": 0.00015581772549412386, "tensor_to_numpy": 4.259698752295579e-05, "un_batch_to_individual_items": 1.5809958609740277e-05}}, "connector_pipeline_timer": 0.0003582445952659665}, "episode_len_mean": 20.0, "num_module_steps_sampled": {"default_policy": 5000.0}, "env_to_module_connector": {"timers": {"connectors": {"add_states_from_episodes_to_batch": 3.7917152738275744e-06, "add_time_dim_to_batch_and_zero_pad": 6.546319908950105e-06, "numpy_to_tensor": 3.0609190995577635e-05, "add_observations_from_episodes_to_batch": 8.469065095030877e-06, "batch_individual_items": 2.156834090469562e-05}}, "connector_pipeline_timer": 0.0001234003169890923}, "sample": 0.01485798766297949, "env_to_module_sum_episodes_length_out": 10.36823839457432, "weights_seq_no": 10.0, "num_env_steps_sampled_lifetime": -5547500.0, "episode_return_max": 9.5, "episode_return_mean": 2.8600000000000008, "module_episode_returns_mean": {"default_policy": 2.8600000000000008}, "time_between_sampling": 0.005265918357546706, "rlmodule_inference_timer": 9.938414073365469e-05, "env_step_timer": 4.4778510578681524e-05, "env_reset_timer": 0.00011490501043801834, "agent_episode_returns_mean": {"default_agent": 2.8600000000000008}, "num_env_steps_sampled": 5000.0, "episode_duration_sec_mean": 0.01515355366980657, "env_to_module_sum_episodes_length_in": 10.36823839457432, "episode_len_min": 20, "num_agent_steps_sampled": {"default_agent": 5000.0}, "num_episodes": 250.0, "num_module_steps_sampled_lifetime": {"default_policy": -5547500.0}, "episode_len_max": 20, "num_episodes_lifetime": -277375.0, "num_env_steps_sampled_lifetime_throughput": 1716.5768459924743}, "learners": {"__all_modules__": {"learner_connector": {"timers": {"connectors": {"general_advantage_estimation": 0.06260819958669966, "numpy_to_tensor": 0.0006225781469804218, "add_observations_from_episodes_to_batch": 0.004328822397278477, "add_one_ts_to_episodes_and_truncate": 0.031805836402366366, "batch_individual_items": 0.1090261544716215, "add_states_from_episodes_to_batch": 5.383872068625784e-06, "add_columns_from_episodes_to_train_batch": 0.18387100267274104, "add_time_dim_to_batch_and_zero_pad": 1.8713552737880377e-05}}, "connector_pipeline_timer": 0.3928012288151826}, "num_module_steps_trained_lifetime": 66000, "num_non_trainable_parameters": 0, "learner_connector_sum_episodes_length_out": 5250.0, "num_module_steps_trained": 6000, "num_trainable_parameters": 6003, "num_env_steps_trained": 31500, "num_env_steps_trained_lifetime": 346500, "learner_connector_sum_episodes_length_in": 5000.0, "num_env_steps_trained_lifetime_throughput": 406276.3584565963, "num_module_steps_trained_throughput": 77641.27918032763, "num_module_steps_trained_lifetime_throughput": 77449.68840344249}, "default_policy": {"curr_kl_coeff": 0.0003645001561380923, "entropy": 0.6183834671974182, "vf_loss": 0.10278083384037018, "default_optimizer_learning_rate": 0.0002847858517, "vf_explained_var": -0.0113600492477417, "total_loss": 0.04307083040475845, "num_trainable_parameters": 6003, "vf_loss_unclipped": 28.637535095214844, "curr_entropy_coeff": 0.0090570820258, "policy_loss": -0.020069513469934464, "diff_num_grad_updates_vs_sampler_policy": 1.0, "mean_kl_loss": 0.0006507525686174631, "gradients_default_optimizer_global_norm": 0.01735222153365612, "num_module_steps_trained_lifetime": 66000, "weights_seq_no": 11.0, "num_module_steps_trained": 6000, "module_train_batch_size_mean": 1000.0, "num_module_steps_trained_lifetime_throughput": 77531.28602381544}}, "num_training_step_calls_per_iteration": 1, "evaluation": {"env_runners": {"env_to_module_connector": {"timers": {"connectors": {"add_states_from_episodes_to_batch": 3.30886948567368e-06, "numpy_to_tensor": 2.4537805030760392e-05, "add_time_dim_to_batch_and_zero_pad": 5.83336901604058e-06, "add_observations_from_episodes_to_batch": 6.568586112791368e-06, "batch_individual_items": 1.6585220668226067e-05}}, "connector_pipeline_timer": 9.62480795569203e-05}, "agent_episode_returns_mean": {"default_agent": 0.05}, "num_agent_steps_sampled": {"default_agent": 400}, "num_env_steps_sampled_lifetime": 55400, "num_env_steps_sampled": 400, "num_episodes": 20, "episode_len_max": 20, "episode_return_min": -14.5, "episode_len_mean": 20.0, "env_to_module_sum_episodes_length_out": 10.368238394574323, "num_module_steps_sampled_lifetime": {"default_policy": 4400}, "num_agent_steps_sampled_lifetime": {"default_agent": 4400}, "module_to_env_connector": {"timers": {"connectors": {"get_actions": 0.00010501303798698161, "normalize_and_clip_actions": 2.2861545715314266e-05, "tensor_to_numpy": 4.179150883118066e-05, "remove_single_ts_time_rank_from_batch": 2.6778546077456567e-06, "listify_data_for_vector_env": 3.357070480693951e-05, "un_batch_to_individual_items": 1.135502515977585e-05}}, "connector_pipeline_timer": 0.00029233118061346597}, "episode_return_mean": 0.05, "env_reset_timer": 0.004335665749190441, "module_episode_returns_mean": {"default_policy": 0.05}, "num_episodes_lifetime": 220, "sample": 1.0109898170349711, "num_module_steps_sampled": {"default_policy": 400}, "env_step_timer": 3.7137904532136076e-05, "episode_duration_sec_mean": 0.013380997055210174, "env_to_module_sum_episodes_length_in": 10.368238394574323, "episode_len_min": 20, "weights_seq_no": 11.0, "episode_return_max": 13.5, "rlmodule_inference_timer": 7.597014828931332e-05, "time_between_sampling": 11.317181932908701}, "num_healthy_workers": 1, "actor_manager_num_outstanding_async_reqs": 0, "num_remote_worker_restarts": 0}, "num_env_steps_sampled_lifetime": -5547500.0, "fault_tolerance": {"num_healthy_workers": 0, "num_remote_worker_restarts": 0}, "env_runner_group": {"actor_manager_num_outstanding_async_reqs": 0}, "done": false, "training_iteration": 11, "trial_id": "4d8e6_00000", "date": "2025-08-11_19-29-23", "timestamp": 1754933363, "time_this_iter_s": 5.19851279258728, "time_total_s": 81.65973448753357, "pid": 19818, "hostname": "Mac", "node_ip": "127.0.0.1", "config": {"exploration_config": {}, "extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "placement_strategy": "PACK", "num_gpus": 0, "_fake_gpus": false, "num_cpus_for_main_process": 2, "eager_tracing": true, "eager_max_retraces": 20, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "torch_compile_learner": false, "torch_compile_learner_what_to_compile": "forward_train", "torch_compile_learner_dynamo_backend": "aot_eager", "torch_compile_learner_dynamo_mode": null, "torch_compile_worker": false, "torch_compile_worker_dynamo_backend": "aot_eager", "torch_compile_worker_dynamo_mode": null, "torch_ddp_kwargs": {}, "torch_skip_nan_gradients": false, "env": "Umbrella", "env_config": {}, "observation_space": null, "action_space": null, "clip_rewards": null, "normalize_actions": true, "clip_actions": false, "_is_atari": null, "disable_env_checking": false, "render_env": false, "action_mask_key": "action_mask", "env_runner_cls": null, "num_env_runners": 0, "create_local_env_runner": true, "num_envs_per_env_runner": 1, "gym_env_vectorize_mode": "SYNC", "num_cpus_per_env_runner": 1, "num_gpus_per_env_runner": 0, "custom_resources_per_env_runner": {}, "validate_env_runners_after_construction": true, "episodes_to_numpy": true, "max_requests_in_flight_per_env_runner": 1, "sample_timeout_s": 60.0, "_env_to_module_connector": null, "add_default_connectors_to_env_to_module_pipeline": true, "_module_to_env_connector": null, "add_default_connectors_to_module_to_env_pipeline": true, "merge_env_runner_states": "training_only", "broadcast_env_runner_states": true, "episode_lookback_horizon": 1, "rollout_fragment_length": "auto", "batch_mode": "complete_episodes", "compress_observations": false, "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "enable_tf1_exec_eagerly": false, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "preprocessor_pref": "deepmind", "observation_filter": "NoFilter", "update_worker_filter_stats": true, "use_worker_filter_stats": true, "sampler_perf_stats_ema_coef": null, "_is_online": true, "num_learners": 0, "num_gpus_per_learner": 0, "num_cpus_per_learner": "auto", "num_aggregator_actors_per_learner": 0, "max_requests_in_flight_per_aggregator_actor": 3, "local_gpu_idx": 0, "max_requests_in_flight_per_learner": 3, "gamma": 1, "lr": 0.0002847858517, "grad_clip": 0.5, "grad_clip_by": "global_norm", "_train_batch_size_per_learner": 5000, "train_batch_size": 4000, "num_epochs": 1, "minibatch_size": 1000, "shuffle_batch_per_epoch": true, "model": {"fcnet_hiddens": [256, 256], "fcnet_activation": "tanh", "fcnet_weights_initializer": null, "fcnet_weights_initializer_config": null, "fcnet_bias_initializer": null, "fcnet_bias_initializer_config": null, "conv_filters": null, "conv_activation": "relu", "conv_kernel_initializer": null, "conv_kernel_initializer_config": null, "conv_bias_initializer": null, "conv_bias_initializer_config": null, "conv_transpose_kernel_initializer": null, "conv_transpose_kernel_initializer_config": null, "conv_transpose_bias_initializer": null, "conv_transpose_bias_initializer_config": null, "post_fcnet_hiddens": [], "post_fcnet_activation": "relu", "post_fcnet_weights_initializer": null, "post_fcnet_weights_initializer_config": null, "post_fcnet_bias_initializer": null, "post_fcnet_bias_initializer_config": null, "free_log_std": false, "log_std_clip_param": 20.0, "no_final_linear": false, "vf_share_layers": false, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "lstm_weights_initializer": null, "lstm_weights_initializer_config": null, "lstm_bias_initializer": null, "lstm_bias_initializer_config": null, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "attention_use_n_prev_actions": 0, "attention_use_n_prev_rewards": 0, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": null, "custom_model_config": {}, "custom_action_dist": null, "custom_preprocessor": null, "encoder_latent_dim": null, "always_check_shapes": false, "lstm_use_prev_action_reward": -1, "_use_default_native_models": -1, "_disable_preprocessor_api": false, "_disable_action_flattening": false}, "_learner_connector": null, "add_default_connectors_to_learner_pipeline": true, "learner_config_dict": {}, "optimizer": {}, "_learner_class": null, "callbacks_on_algorithm_init": null, "callbacks_on_env_runners_recreated": null, "callbacks_on_offline_eval_runners_recreated": null, "callbacks_on_checkpoint_loaded": null, "callbacks_on_environment_created": null, "callbacks_on_episode_created": null, "callbacks_on_episode_start": null, "callbacks_on_episode_step": null, "callbacks_on_episode_end": null, "callbacks_on_evaluate_start": null, "callbacks_on_evaluate_end": null, "callbacks_on_evaluate_offline_start": null, "callbacks_on_evaluate_offline_end": null, "callbacks_on_sample_end": null, "callbacks_on_train_result": null, "explore": true, "enable_rl_module_and_learner": true, "enable_env_runner_and_connector_v2": true, "_prior_exploration_config": {"type": "StochasticSampling"}, "count_steps_by": "env_steps", "policy_map_capacity": 100, "policy_mapping_fn": "<function AlgorithmConfig.DEFAULT_POLICY_MAPPING_FN at 0x161a518a0>", "policies_to_train": null, "policy_states_are_swappable": false, "observation_fn": null, "offline_data_class": null, "input_read_method": "read_parquet", "input_read_method_kwargs": {}, "input_read_schema": {}, "input_read_episodes": false, "input_read_sample_batches": false, "input_read_batch_size": null, "input_filesystem": null, "input_filesystem_kwargs": {}, "input_compress_columns": ["obs", "new_obs"], "input_spaces_jsonable": true, "materialize_data": false, "materialize_mapped_data": true, "map_batches_kwargs": {}, "iter_batches_kwargs": {}, "ignore_final_observation": false, "prelearner_class": null, "prelearner_buffer_class": null, "prelearner_buffer_kwargs": {}, "prelearner_module_synch_period": 10, "dataset_num_iters_per_learner": null, "input_config": {}, "actions_in_input_normalized": false, "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_config": {}, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "output_max_rows_per_file": null, "output_write_remaining_data": false, "output_write_method": "write_parquet", "output_write_method_kwargs": {}, "output_filesystem": null, "output_filesystem_kwargs": {}, "output_write_episodes": true, "offline_sampling": false, "evaluation_interval": 1, "evaluation_duration": 20, "evaluation_duration_unit": "episodes", "evaluation_sample_timeout_s": 120.0, "evaluation_auto_duration_min_env_steps_per_sample": 100, "evaluation_auto_duration_max_env_steps_per_sample": 2000, "evaluation_parallel_to_training": false, "evaluation_force_reset_envs_before_iteration": true, "evaluation_config": null, "off_policy_estimation_methods": {}, "ope_split_batch_by_episode": true, "evaluation_num_env_runners": 1, "in_evaluation": false, "sync_filters_on_rollout_workers_timeout_s": 10.0, "offline_evaluation_interval": null, "num_offline_eval_runners": 0, "offline_loss_for_module_fn": null, "offline_evaluation_duration": 1, "offline_evaluation_parallel_to_training": false, "offline_evaluation_timeout_s": 120.0, "num_cpus_per_offline_eval_runner": 1, "num_gpus_per_offline_eval_runner": 0, "custom_resources_per_offline_eval_runner": {}, "restart_failed_offline_eval_runners": true, "ignore_offline_eval_runner_failures": false, "max_num_offline_eval_runner_restarts": 1000, "offline_eval_runner_restore_timeout_s": 1800.0, "max_requests_in_flight_per_offline_eval_runner": 1, "validate_offline_eval_runners_after_construction": true, "offline_eval_runner_health_probe_timeout_s": 30.0, "offline_eval_rl_module_inference_only": false, "broadcast_offline_eval_runner_states": false, "offline_eval_batch_size_per_runner": 256, "dataset_num_iters_per_eval_runner": 1, "keep_per_episode_custom_metrics": false, "metrics_episode_collection_timeout_s": 60.0, "metrics_num_episodes_for_smoothing": 100, "min_time_s_per_iteration": null, "min_train_timesteps_per_iteration": 0, "min_sample_timesteps_per_iteration": 0, "log_gradients": true, "export_native_model_files": false, "checkpoint_trainable_policies_only": false, "logger_creator": null, "logger_config": null, "log_level": "WARN", "log_sys_usage": true, "fake_sampler": false, "seed": 10, "restart_failed_env_runners": true, "ignore_env_runner_failures": false, "max_num_env_runner_restarts": 1000, "delay_between_env_runner_restarts_s": 60.0, "restart_failed_sub_environments": false, "num_consecutive_env_runner_failures_tolerance": 100, "env_runner_health_probe_timeout_s": 30.0, "env_runner_restore_timeout_s": 1800.0, "_model_config": {}, "_rl_module_spec": "RLModuleSpec(module_class=None, observation_space=None, action_space=None, inference_only=False, learner_only=False, model_config=DefaultModelConfig(fcnet_hiddens=[60, 90], fcnet_activation='tanh', fcnet_kernel_initializer=None, fcnet_kernel_initializer_kwargs=None, fcnet_bias_initializer=None, fcnet_bias_initializer_kwargs=None, conv_filters=None, conv_activation='relu', conv_kernel_initializer=None, conv_kernel_initializer_kwargs=None, conv_bias_initializer=None, conv_bias_initializer_kwargs=None, head_fcnet_hiddens=[], head_fcnet_activation='relu', head_fcnet_kernel_initializer=None, head_fcnet_kernel_initializer_kwargs=None, head_fcnet_bias_initializer=None, head_fcnet_bias_initializer_kwargs=None, free_log_std=False, log_std_clip_param=20.0, vf_share_layers=True, use_lstm=False, max_seq_len=20, lstm_cell_size=256, lstm_use_prev_action=False, lstm_use_prev_reward=False, lstm_kernel_initializer=None, lstm_kernel_initializer_kwargs=None, lstm_bias_initializer=None, lstm_bias_initializer_kwargs=None), catalog_class=None, load_state_path=None, model_config_dict=None)", "algorithm_config_overrides_per_module": {}, "_per_module_overrides": {}, "_validate_config": true, "_use_msgpack_checkpoints": false, "_torch_grad_scaler_class": null, "_torch_lr_scheduler_classes": null, "_tf_policy_handles_more_than_one_loss": false, "_disable_preprocessor_api": false, "_disable_action_flattening": false, "_disable_initialize_loss_from_dummy_batch": false, "_dont_auto_sync_env_runner_states": false, "env_task_fn": -1, "enable_connectors": -1, "simple_optimizer": false, "policy_map_cache": -1, "worker_cls": -1, "synchronize_filters": -1, "enable_async_evaluation": -1, "custom_async_evaluation_function": -1, "_enable_rl_module_api": -1, "auto_wrap_old_gym_envs": -1, "always_attach_evaluation_results": -1, "replay_sequence_length": null, "_disable_execution_plan_api": -1, "use_critic": true, "use_gae": true, "use_kl_loss": true, "kl_coeff": 0.7464963036515, "kl_target": 0.0270990929592, "vf_loss_coeff": 0.6688075857018, "entropy_coeff": 0.0090570820258, "clip_param": 0.1221781641624, "vf_clip_param": 0.1027808522125, "entropy_coeff_schedule": null, "lr_schedule": null, "sgd_minibatch_size": -1, "vf_share_layers": -1, "__stdout_file__": null, "__stderr_file__": null, "lambda": 0.9099046732075, "input": "sampler", "policies": {"default_policy": [null, null, null, null]}, "callbacks": "<class 'ray.rllib.callbacks.callbacks.RLlibCallback'>", "create_env_on_driver": false, "custom_eval_function": null, "framework": "torch"}, "time_since_restore": 81.65973448753357, "iterations_since_restore": 11, "perf": {"cpu_util_percent": 90.14999999999999, "ram_util_percent": 81.85}}
{"timers": {"training_iteration": 16.166267778616458, "restore_env_runners": 0.00011012323417602585, "training_step": 16.165728575838344, "env_runner_sampling_timer": 15.51587730993029, "learner_update_timer": 0.6393564685486973, "synch_weights": 0.0017277470401946954, "restore_eval_env_runners": 3.440585773214877e-05, "evaluation_iteration": 1.061727567232091, "synch_eval_env_connectors": 0.00048790505051696226, "synch_env_connectors": 8.856748888852491e-06}, "env_runners": {"episode_return_min": -10.5, "num_agent_steps_sampled_lifetime": {"default_agent": -6165000.0}, "module_to_env_connector": {"timers": {"connectors": {"remove_single_ts_time_rank_from_batch": 2.282521398745288e-06, "normalize_and_clip_actions": 2.7747840134058415e-05, "listify_data_for_vector_env": 3.518527461119028e-05, "get_actions": 0.00020694044125301435, "tensor_to_numpy": 5.089484798970271e-05, "un_batch_to_individual_items": 1.468245639580492e-05}}, "connector_pipeline_timer": 0.00041336504186216836}, "episode_len_mean": 20.0, "num_module_steps_sampled": {"default_policy": 5000.0}, "env_to_module_connector": {"timers": {"connectors": {"add_states_from_episodes_to_batch": 4.534690897511976e-06, "add_time_dim_to_batch_and_zero_pad": 7.432179877153916e-06, "numpy_to_tensor": 3.707692885443684e-05, "add_observations_from_episodes_to_batch": 8.469159412221316e-06, "batch_individual_items": 2.0501076349008864e-05}}, "connector_pipeline_timer": 0.000138960184537312}, "sample": 0.019468451909357504, "env_to_module_sum_episodes_length_out": 10.36823839457432, "weights_seq_no": 11.0, "num_env_steps_sampled_lifetime": -6165000.0, "episode_return_max": 9.5, "episode_return_mean": 4.380000000000001, "module_episode_returns_mean": {"default_policy": 4.380000000000001}, "time_between_sampling": 0.006445016119594975, "rlmodule_inference_timer": 0.00010642779248565055, "env_step_timer": 5.253465323516814e-05, "env_reset_timer": 0.00024698704477753286, "agent_episode_returns_mean": {"default_agent": 4.380000000000001}, "num_env_steps_sampled": 5000.0, "episode_duration_sec_mean": 0.016505780179519206, "env_to_module_sum_episodes_length_in": 10.36823839457432, "episode_len_min": 20, "num_agent_steps_sampled": {"default_agent": 5000.0}, "num_episodes": 250.0, "num_module_steps_sampled_lifetime": {"default_policy": -6165000.0}, "episode_len_max": 20, "num_episodes_lifetime": -308250.0, "num_env_steps_sampled_lifetime_throughput": 1486.8174954790422}, "learners": {"__all_modules__": {"learner_connector": {"timers": {"connectors": {"general_advantage_estimation": 0.06210009718068237, "numpy_to_tensor": 0.0006173898646795053, "add_observations_from_episodes_to_batch": 0.004301406672512727, "add_one_ts_to_episodes_and_truncate": 0.031629732207718524, "batch_individual_items": 0.1087516925066281, "add_states_from_episodes_to_batch": 5.370443434452092e-06, "add_columns_from_episodes_to_train_batch": 0.1825088376459968, "add_time_dim_to_batch_and_zero_pad": 1.8701827160817528e-05}}, "connector_pipeline_timer": 0.3904446611061981}, "num_module_steps_trained_lifetime": 72000, "num_non_trainable_parameters": 0, "learner_connector_sum_episodes_length_out": 5250.0, "num_module_steps_trained": 6000, "num_trainable_parameters": 6003, "num_env_steps_trained": 31500, "num_env_steps_trained_lifetime": 378000, "learner_connector_sum_episodes_length_in": 5000.0, "num_env_steps_trained_lifetime_throughput": 428563.20548964315, "num_module_steps_trained_throughput": 81892.08994274677, "num_module_steps_trained_lifetime_throughput": 81689.89425367891}, "default_policy": {"curr_kl_coeff": 0.00018225007806904614, "entropy": 0.6033130884170532, "vf_loss": 0.10278083384037018, "default_optimizer_learning_rate": 0.0002847858517, "vf_explained_var": -0.01087331771850586, "total_loss": 0.01771397329866886, "num_trainable_parameters": 6003, "vf_loss_unclipped": 28.60890007019043, "curr_entropy_coeff": 0.0090570820258, "policy_loss": -0.04556255415081978, "diff_num_grad_updates_vs_sampler_policy": 1.0, "mean_kl_loss": 0.0004655509255826473, "gradients_default_optimizer_global_norm": 0.02542821504175663, "num_module_steps_trained_lifetime": 72000, "weights_seq_no": 12.0, "num_module_steps_trained": 6000, "module_train_batch_size_mean": 1000.0, "num_module_steps_trained_lifetime_throughput": 81775.69602588349}}, "num_training_step_calls_per_iteration": 1, "evaluation": {"env_runners": {"env_to_module_connector": {"timers": {"connectors": {"add_states_from_episodes_to_batch": 2.829770749315125e-06, "numpy_to_tensor": 2.3066309366663085e-05, "add_time_dim_to_batch_and_zero_pad": 6.300334051883216e-06, "add_observations_from_episodes_to_batch": 8.993461053725053e-06, "batch_individual_items": 2.227464875859428e-05}}, "connector_pipeline_timer": 0.00011040133458262769}, "agent_episode_returns_mean": {"default_agent": -0.55}, "num_agent_steps_sampled": {"default_agent": 400}, "num_env_steps_sampled_lifetime": 60400, "num_env_steps_sampled": 400, "num_episodes": 20, "episode_len_max": 20, "episode_return_min": -14.5, "episode_len_mean": 20.0, "env_to_module_sum_episodes_length_out": 10.368238394574323, "num_module_steps_sampled_lifetime": {"default_policy": 4800}, "num_agent_steps_sampled_lifetime": {"default_agent": 4800}, "module_to_env_connector": {"timers": {"connectors": {"get_actions": 0.00012238180090696766, "normalize_and_clip_actions": 2.597983596681395e-05, "tensor_to_numpy": 3.175328264941352e-05, "remove_single_ts_time_rank_from_batch": 1.2724822672099124e-06, "listify_data_for_vector_env": 2.842758262878597e-05, "un_batch_to_individual_items": 1.2762062861325599e-05}}, "connector_pipeline_timer": 0.0002852770319697885}, "episode_return_mean": -0.55, "env_reset_timer": 0.004294661171307946, "module_episode_returns_mean": {"default_policy": -0.55}, "num_episodes_lifetime": 240, "sample": 1.003163916364238, "num_module_steps_sampled": {"default_policy": 400}, "env_step_timer": 4.063048118003537e-05, "episode_duration_sec_mean": 0.013340294564841315, "env_to_module_sum_episodes_length_in": 10.368238394574323, "episode_len_min": 20, "weights_seq_no": 12.0, "episode_return_max": 13.5, "rlmodule_inference_timer": 7.287140584600657e-05, "time_between_sampling": 11.259470157330549}, "num_healthy_workers": 1, "actor_manager_num_outstanding_async_reqs": 0, "num_remote_worker_restarts": 0}, "num_env_steps_sampled_lifetime": -6165000.0, "fault_tolerance": {"num_healthy_workers": 0, "num_remote_worker_restarts": 0}, "env_runner_group": {"actor_manager_num_outstanding_async_reqs": 0}, "done": false, "training_iteration": 12, "trial_id": "4d8e6_00000", "date": "2025-08-11_19-29-29", "timestamp": 1754933369, "time_this_iter_s": 5.699950218200684, "time_total_s": 87.35968470573425, "pid": 19818, "hostname": "Mac", "node_ip": "127.0.0.1", "config": {"exploration_config": {}, "extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "placement_strategy": "PACK", "num_gpus": 0, "_fake_gpus": false, "num_cpus_for_main_process": 2, "eager_tracing": true, "eager_max_retraces": 20, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "torch_compile_learner": false, "torch_compile_learner_what_to_compile": "forward_train", "torch_compile_learner_dynamo_backend": "aot_eager", "torch_compile_learner_dynamo_mode": null, "torch_compile_worker": false, "torch_compile_worker_dynamo_backend": "aot_eager", "torch_compile_worker_dynamo_mode": null, "torch_ddp_kwargs": {}, "torch_skip_nan_gradients": false, "env": "Umbrella", "env_config": {}, "observation_space": null, "action_space": null, "clip_rewards": null, "normalize_actions": true, "clip_actions": false, "_is_atari": null, "disable_env_checking": false, "render_env": false, "action_mask_key": "action_mask", "env_runner_cls": null, "num_env_runners": 0, "create_local_env_runner": true, "num_envs_per_env_runner": 1, "gym_env_vectorize_mode": "SYNC", "num_cpus_per_env_runner": 1, "num_gpus_per_env_runner": 0, "custom_resources_per_env_runner": {}, "validate_env_runners_after_construction": true, "episodes_to_numpy": true, "max_requests_in_flight_per_env_runner": 1, "sample_timeout_s": 60.0, "_env_to_module_connector": null, "add_default_connectors_to_env_to_module_pipeline": true, "_module_to_env_connector": null, "add_default_connectors_to_module_to_env_pipeline": true, "merge_env_runner_states": "training_only", "broadcast_env_runner_states": true, "episode_lookback_horizon": 1, "rollout_fragment_length": "auto", "batch_mode": "complete_episodes", "compress_observations": false, "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "enable_tf1_exec_eagerly": false, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "preprocessor_pref": "deepmind", "observation_filter": "NoFilter", "update_worker_filter_stats": true, "use_worker_filter_stats": true, "sampler_perf_stats_ema_coef": null, "_is_online": true, "num_learners": 0, "num_gpus_per_learner": 0, "num_cpus_per_learner": "auto", "num_aggregator_actors_per_learner": 0, "max_requests_in_flight_per_aggregator_actor": 3, "local_gpu_idx": 0, "max_requests_in_flight_per_learner": 3, "gamma": 1, "lr": 0.0002847858517, "grad_clip": 0.5, "grad_clip_by": "global_norm", "_train_batch_size_per_learner": 5000, "train_batch_size": 4000, "num_epochs": 1, "minibatch_size": 1000, "shuffle_batch_per_epoch": true, "model": {"fcnet_hiddens": [256, 256], "fcnet_activation": "tanh", "fcnet_weights_initializer": null, "fcnet_weights_initializer_config": null, "fcnet_bias_initializer": null, "fcnet_bias_initializer_config": null, "conv_filters": null, "conv_activation": "relu", "conv_kernel_initializer": null, "conv_kernel_initializer_config": null, "conv_bias_initializer": null, "conv_bias_initializer_config": null, "conv_transpose_kernel_initializer": null, "conv_transpose_kernel_initializer_config": null, "conv_transpose_bias_initializer": null, "conv_transpose_bias_initializer_config": null, "post_fcnet_hiddens": [], "post_fcnet_activation": "relu", "post_fcnet_weights_initializer": null, "post_fcnet_weights_initializer_config": null, "post_fcnet_bias_initializer": null, "post_fcnet_bias_initializer_config": null, "free_log_std": false, "log_std_clip_param": 20.0, "no_final_linear": false, "vf_share_layers": false, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "lstm_weights_initializer": null, "lstm_weights_initializer_config": null, "lstm_bias_initializer": null, "lstm_bias_initializer_config": null, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "attention_use_n_prev_actions": 0, "attention_use_n_prev_rewards": 0, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": null, "custom_model_config": {}, "custom_action_dist": null, "custom_preprocessor": null, "encoder_latent_dim": null, "always_check_shapes": false, "lstm_use_prev_action_reward": -1, "_use_default_native_models": -1, "_disable_preprocessor_api": false, "_disable_action_flattening": false}, "_learner_connector": null, "add_default_connectors_to_learner_pipeline": true, "learner_config_dict": {}, "optimizer": {}, "_learner_class": null, "callbacks_on_algorithm_init": null, "callbacks_on_env_runners_recreated": null, "callbacks_on_offline_eval_runners_recreated": null, "callbacks_on_checkpoint_loaded": null, "callbacks_on_environment_created": null, "callbacks_on_episode_created": null, "callbacks_on_episode_start": null, "callbacks_on_episode_step": null, "callbacks_on_episode_end": null, "callbacks_on_evaluate_start": null, "callbacks_on_evaluate_end": null, "callbacks_on_evaluate_offline_start": null, "callbacks_on_evaluate_offline_end": null, "callbacks_on_sample_end": null, "callbacks_on_train_result": null, "explore": true, "enable_rl_module_and_learner": true, "enable_env_runner_and_connector_v2": true, "_prior_exploration_config": {"type": "StochasticSampling"}, "count_steps_by": "env_steps", "policy_map_capacity": 100, "policy_mapping_fn": "<function AlgorithmConfig.DEFAULT_POLICY_MAPPING_FN at 0x161a518a0>", "policies_to_train": null, "policy_states_are_swappable": false, "observation_fn": null, "offline_data_class": null, "input_read_method": "read_parquet", "input_read_method_kwargs": {}, "input_read_schema": {}, "input_read_episodes": false, "input_read_sample_batches": false, "input_read_batch_size": null, "input_filesystem": null, "input_filesystem_kwargs": {}, "input_compress_columns": ["obs", "new_obs"], "input_spaces_jsonable": true, "materialize_data": false, "materialize_mapped_data": true, "map_batches_kwargs": {}, "iter_batches_kwargs": {}, "ignore_final_observation": false, "prelearner_class": null, "prelearner_buffer_class": null, "prelearner_buffer_kwargs": {}, "prelearner_module_synch_period": 10, "dataset_num_iters_per_learner": null, "input_config": {}, "actions_in_input_normalized": false, "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_config": {}, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "output_max_rows_per_file": null, "output_write_remaining_data": false, "output_write_method": "write_parquet", "output_write_method_kwargs": {}, "output_filesystem": null, "output_filesystem_kwargs": {}, "output_write_episodes": true, "offline_sampling": false, "evaluation_interval": 1, "evaluation_duration": 20, "evaluation_duration_unit": "episodes", "evaluation_sample_timeout_s": 120.0, "evaluation_auto_duration_min_env_steps_per_sample": 100, "evaluation_auto_duration_max_env_steps_per_sample": 2000, "evaluation_parallel_to_training": false, "evaluation_force_reset_envs_before_iteration": true, "evaluation_config": null, "off_policy_estimation_methods": {}, "ope_split_batch_by_episode": true, "evaluation_num_env_runners": 1, "in_evaluation": false, "sync_filters_on_rollout_workers_timeout_s": 10.0, "offline_evaluation_interval": null, "num_offline_eval_runners": 0, "offline_loss_for_module_fn": null, "offline_evaluation_duration": 1, "offline_evaluation_parallel_to_training": false, "offline_evaluation_timeout_s": 120.0, "num_cpus_per_offline_eval_runner": 1, "num_gpus_per_offline_eval_runner": 0, "custom_resources_per_offline_eval_runner": {}, "restart_failed_offline_eval_runners": true, "ignore_offline_eval_runner_failures": false, "max_num_offline_eval_runner_restarts": 1000, "offline_eval_runner_restore_timeout_s": 1800.0, "max_requests_in_flight_per_offline_eval_runner": 1, "validate_offline_eval_runners_after_construction": true, "offline_eval_runner_health_probe_timeout_s": 30.0, "offline_eval_rl_module_inference_only": false, "broadcast_offline_eval_runner_states": false, "offline_eval_batch_size_per_runner": 256, "dataset_num_iters_per_eval_runner": 1, "keep_per_episode_custom_metrics": false, "metrics_episode_collection_timeout_s": 60.0, "metrics_num_episodes_for_smoothing": 100, "min_time_s_per_iteration": null, "min_train_timesteps_per_iteration": 0, "min_sample_timesteps_per_iteration": 0, "log_gradients": true, "export_native_model_files": false, "checkpoint_trainable_policies_only": false, "logger_creator": null, "logger_config": null, "log_level": "WARN", "log_sys_usage": true, "fake_sampler": false, "seed": 10, "restart_failed_env_runners": true, "ignore_env_runner_failures": false, "max_num_env_runner_restarts": 1000, "delay_between_env_runner_restarts_s": 60.0, "restart_failed_sub_environments": false, "num_consecutive_env_runner_failures_tolerance": 100, "env_runner_health_probe_timeout_s": 30.0, "env_runner_restore_timeout_s": 1800.0, "_model_config": {}, "_rl_module_spec": "RLModuleSpec(module_class=None, observation_space=None, action_space=None, inference_only=False, learner_only=False, model_config=DefaultModelConfig(fcnet_hiddens=[60, 90], fcnet_activation='tanh', fcnet_kernel_initializer=None, fcnet_kernel_initializer_kwargs=None, fcnet_bias_initializer=None, fcnet_bias_initializer_kwargs=None, conv_filters=None, conv_activation='relu', conv_kernel_initializer=None, conv_kernel_initializer_kwargs=None, conv_bias_initializer=None, conv_bias_initializer_kwargs=None, head_fcnet_hiddens=[], head_fcnet_activation='relu', head_fcnet_kernel_initializer=None, head_fcnet_kernel_initializer_kwargs=None, head_fcnet_bias_initializer=None, head_fcnet_bias_initializer_kwargs=None, free_log_std=False, log_std_clip_param=20.0, vf_share_layers=True, use_lstm=False, max_seq_len=20, lstm_cell_size=256, lstm_use_prev_action=False, lstm_use_prev_reward=False, lstm_kernel_initializer=None, lstm_kernel_initializer_kwargs=None, lstm_bias_initializer=None, lstm_bias_initializer_kwargs=None), catalog_class=None, load_state_path=None, model_config_dict=None)", "algorithm_config_overrides_per_module": {}, "_per_module_overrides": {}, "_validate_config": true, "_use_msgpack_checkpoints": false, "_torch_grad_scaler_class": null, "_torch_lr_scheduler_classes": null, "_tf_policy_handles_more_than_one_loss": false, "_disable_preprocessor_api": false, "_disable_action_flattening": false, "_disable_initialize_loss_from_dummy_batch": false, "_dont_auto_sync_env_runner_states": false, "env_task_fn": -1, "enable_connectors": -1, "simple_optimizer": false, "policy_map_cache": -1, "worker_cls": -1, "synchronize_filters": -1, "enable_async_evaluation": -1, "custom_async_evaluation_function": -1, "_enable_rl_module_api": -1, "auto_wrap_old_gym_envs": -1, "always_attach_evaluation_results": -1, "replay_sequence_length": null, "_disable_execution_plan_api": -1, "use_critic": true, "use_gae": true, "use_kl_loss": true, "kl_coeff": 0.7464963036515, "kl_target": 0.0270990929592, "vf_loss_coeff": 0.6688075857018, "entropy_coeff": 0.0090570820258, "clip_param": 0.1221781641624, "vf_clip_param": 0.1027808522125, "entropy_coeff_schedule": null, "lr_schedule": null, "sgd_minibatch_size": -1, "vf_share_layers": -1, "__stdout_file__": null, "__stderr_file__": null, "lambda": 0.9099046732075, "input": "sampler", "policies": {"default_policy": [null, null, null, null]}, "callbacks": "<class 'ray.rllib.callbacks.callbacks.RLlibCallback'>", "create_env_on_driver": false, "custom_eval_function": null, "framework": "torch"}, "time_since_restore": 87.35968470573425, "iterations_since_restore": 12, "perf": {"cpu_util_percent": 92.475, "ram_util_percent": 81.2125}}
{"timers": {"training_iteration": 16.06106410875006, "restore_env_runners": 0.00010910325157982827, "training_step": 16.060526171329187, "env_runner_sampling_timer": 15.4150358205801, "learner_update_timer": 0.634989160953248, "synch_weights": 0.001739460819648356, "restore_eval_env_runners": 3.422638946513264e-05, "evaluation_iteration": 1.053525218229796, "synch_eval_env_connectors": 0.0004856718304027675, "synch_env_connectors": 8.826511296965351e-06}, "env_runners": {"episode_return_min": -10.5, "num_agent_steps_sampled_lifetime": {"default_agent": -6782500.0}, "module_to_env_connector": {"timers": {"connectors": {"remove_single_ts_time_rank_from_batch": 1.6898555517313299e-06, "normalize_and_clip_actions": 3.0006644360972647e-05, "listify_data_for_vector_env": 3.963596367915138e-05, "get_actions": 0.0001751028723182632, "tensor_to_numpy": 5.609172170315651e-05, "un_batch_to_individual_items": 1.51445398068197e-05}}, "connector_pipeline_timer": 0.0003982042524013274}, "episode_len_mean": 20.0, "num_module_steps_sampled": {"default_policy": 5000.0}, "env_to_module_connector": {"timers": {"connectors": {"add_states_from_episodes_to_batch": 4.502082113331909e-06, "add_time_dim_to_batch_and_zero_pad": 7.729268940601004e-06, "numpy_to_tensor": 3.930604206144793e-05, "add_observations_from_episodes_to_batch": 9.366697322665597e-06, "batch_individual_items": 2.349198704512813e-05}}, "connector_pipeline_timer": 0.00015126106991304134}, "sample": 0.01836394512724819, "env_to_module_sum_episodes_length_out": 10.36823839457432, "weights_seq_no": 12.0, "num_env_steps_sampled_lifetime": -6782500.0, "episode_return_max": 9.5, "episode_return_mean": 3.339999999999999, "module_episode_returns_mean": {"default_policy": 3.339999999999999}, "time_between_sampling": 0.0044115960839402266, "rlmodule_inference_timer": 0.00012194387019596968, "env_step_timer": 6.229577472797342e-05, "env_reset_timer": 0.0001691387266523855, "agent_episode_returns_mean": {"default_agent": 3.339999999999999}, "num_env_steps_sampled": 5000.0, "episode_duration_sec_mean": 0.0174106952957809, "env_to_module_sum_episodes_length_in": 10.36823839457432, "episode_len_min": 20, "num_agent_steps_sampled": {"default_agent": 5000.0}, "num_episodes": 250.0, "num_module_steps_sampled_lifetime": {"default_policy": -6782500.0}, "episode_len_max": 20, "num_episodes_lifetime": -339125.0, "num_env_steps_sampled_lifetime_throughput": 1373.2142129893186}, "learners": {"__all_modules__": {"learner_connector": {"timers": {"connectors": {"general_advantage_estimation": 0.06158557161916002, "numpy_to_tensor": 0.0006123863754103746, "add_observations_from_episodes_to_batch": 0.004287308435976962, "add_one_ts_to_episodes_and_truncate": 0.031501058635594104, "batch_individual_items": 0.10808209308157903, "add_states_from_episodes_to_batch": 5.35298956717126e-06, "add_columns_from_episodes_to_train_batch": 0.18145540801955493, "add_time_dim_to_batch_and_zero_pad": 1.8678559845044336e-05}}, "connector_pipeline_timer": 0.3880565236544783}, "num_module_steps_trained_lifetime": 78000, "num_non_trainable_parameters": 0, "learner_connector_sum_episodes_length_out": 5250.0, "num_module_steps_trained": 6000, "num_trainable_parameters": 6003, "num_env_steps_trained": 31500, "num_env_steps_trained_lifetime": 409500, "learner_connector_sum_episodes_length_in": 5000.0, "num_env_steps_trained_lifetime_throughput": 445987.5270636144, "num_module_steps_trained_throughput": 85211.81340278592, "num_module_steps_trained_lifetime_throughput": 85004.65600649835}, "default_policy": {"curr_kl_coeff": 9.112503903452307e-05, "entropy": 0.5803787112236023, "vf_loss": 0.10278083384037018, "default_optimizer_learning_rate": 0.0002847858517, "vf_explained_var": -0.011479973793029785, "total_loss": 0.023966753855347633, "num_trainable_parameters": 6003, "vf_loss_unclipped": 28.610172271728516, "curr_entropy_coeff": 0.0090570820258, "policy_loss": -0.039517566561698914, "diff_num_grad_updates_vs_sampler_policy": 1.0, "mean_kl_loss": 0.0013015683507546782, "gradients_default_optimizer_global_norm": 0.02619677409529686, "num_module_steps_trained_lifetime": 78000, "weights_seq_no": 13.0, "num_module_steps_trained": 6000, "module_train_batch_size_mean": 1000.0, "num_module_steps_trained_lifetime_throughput": 85091.50634109291}}, "num_training_step_calls_per_iteration": 1, "evaluation": {"env_runners": {"env_to_module_connector": {"timers": {"connectors": {"add_states_from_episodes_to_batch": 3.711725004422085e-06, "numpy_to_tensor": 4.770768714214954e-05, "add_time_dim_to_batch_and_zero_pad": 9.480760690314369e-06, "add_observations_from_episodes_to_batch": 1.0789730898491276e-05, "batch_individual_items": 2.0464454424413154e-05}}, "connector_pipeline_timer": 0.00015307256009083152}, "agent_episode_returns_mean": {"default_agent": -0.75}, "num_agent_steps_sampled": {"default_agent": 400}, "num_env_steps_sampled_lifetime": 65400, "num_env_steps_sampled": 400, "num_episodes": 20, "episode_len_max": 20, "episode_return_min": -14.5, "episode_len_mean": 20.0, "env_to_module_sum_episodes_length_out": 10.368238394574323, "num_module_steps_sampled_lifetime": {"default_policy": 5200}, "num_agent_steps_sampled_lifetime": {"default_agent": 5200}, "module_to_env_connector": {"timers": {"connectors": {"get_actions": 0.00017893530594467364, "normalize_and_clip_actions": 3.1290106279381e-05, "tensor_to_numpy": 5.2862632949054195e-05, "remove_single_ts_time_rank_from_batch": 1.8381700330531122e-06, "listify_data_for_vector_env": 3.5361291679679144e-05, "un_batch_to_individual_items": 1.7906418910098936e-05}}, "connector_pipeline_timer": 0.00041474345460655593}, "episode_return_mean": -0.75, "env_reset_timer": 0.004254720399711978, "module_episode_returns_mean": {"default_policy": -0.75}, "num_episodes_lifetime": 260, "sample": 0.9964280113609426, "num_module_steps_sampled": {"default_policy": 400}, "env_step_timer": 0.00012022144797643817, "episode_duration_sec_mean": 0.013887164543848484, "env_to_module_sum_episodes_length_in": 10.368238394574323, "episode_len_min": 20, "weights_seq_no": 13.0, "episode_return_max": 13.5, "rlmodule_inference_timer": 0.00011906032522278817, "time_between_sampling": 11.203677958256439}, "num_healthy_workers": 1, "actor_manager_num_outstanding_async_reqs": 0, "num_remote_worker_restarts": 0}, "num_env_steps_sampled_lifetime": -6782500.0, "fault_tolerance": {"num_healthy_workers": 0, "num_remote_worker_restarts": 0}, "env_runner_group": {"actor_manager_num_outstanding_async_reqs": 0}, "done": false, "training_iteration": 13, "trial_id": "4d8e6_00000", "date": "2025-08-11_19-29-35", "timestamp": 1754933375, "time_this_iter_s": 5.995449781417847, "time_total_s": 93.3551344871521, "pid": 19818, "hostname": "Mac", "node_ip": "127.0.0.1", "config": {"exploration_config": {}, "extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "placement_strategy": "PACK", "num_gpus": 0, "_fake_gpus": false, "num_cpus_for_main_process": 2, "eager_tracing": true, "eager_max_retraces": 20, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "torch_compile_learner": false, "torch_compile_learner_what_to_compile": "forward_train", "torch_compile_learner_dynamo_backend": "aot_eager", "torch_compile_learner_dynamo_mode": null, "torch_compile_worker": false, "torch_compile_worker_dynamo_backend": "aot_eager", "torch_compile_worker_dynamo_mode": null, "torch_ddp_kwargs": {}, "torch_skip_nan_gradients": false, "env": "Umbrella", "env_config": {}, "observation_space": null, "action_space": null, "clip_rewards": null, "normalize_actions": true, "clip_actions": false, "_is_atari": null, "disable_env_checking": false, "render_env": false, "action_mask_key": "action_mask", "env_runner_cls": null, "num_env_runners": 0, "create_local_env_runner": true, "num_envs_per_env_runner": 1, "gym_env_vectorize_mode": "SYNC", "num_cpus_per_env_runner": 1, "num_gpus_per_env_runner": 0, "custom_resources_per_env_runner": {}, "validate_env_runners_after_construction": true, "episodes_to_numpy": true, "max_requests_in_flight_per_env_runner": 1, "sample_timeout_s": 60.0, "_env_to_module_connector": null, "add_default_connectors_to_env_to_module_pipeline": true, "_module_to_env_connector": null, "add_default_connectors_to_module_to_env_pipeline": true, "merge_env_runner_states": "training_only", "broadcast_env_runner_states": true, "episode_lookback_horizon": 1, "rollout_fragment_length": "auto", "batch_mode": "complete_episodes", "compress_observations": false, "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "enable_tf1_exec_eagerly": false, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "preprocessor_pref": "deepmind", "observation_filter": "NoFilter", "update_worker_filter_stats": true, "use_worker_filter_stats": true, "sampler_perf_stats_ema_coef": null, "_is_online": true, "num_learners": 0, "num_gpus_per_learner": 0, "num_cpus_per_learner": "auto", "num_aggregator_actors_per_learner": 0, "max_requests_in_flight_per_aggregator_actor": 3, "local_gpu_idx": 0, "max_requests_in_flight_per_learner": 3, "gamma": 1, "lr": 0.0002847858517, "grad_clip": 0.5, "grad_clip_by": "global_norm", "_train_batch_size_per_learner": 5000, "train_batch_size": 4000, "num_epochs": 1, "minibatch_size": 1000, "shuffle_batch_per_epoch": true, "model": {"fcnet_hiddens": [256, 256], "fcnet_activation": "tanh", "fcnet_weights_initializer": null, "fcnet_weights_initializer_config": null, "fcnet_bias_initializer": null, "fcnet_bias_initializer_config": null, "conv_filters": null, "conv_activation": "relu", "conv_kernel_initializer": null, "conv_kernel_initializer_config": null, "conv_bias_initializer": null, "conv_bias_initializer_config": null, "conv_transpose_kernel_initializer": null, "conv_transpose_kernel_initializer_config": null, "conv_transpose_bias_initializer": null, "conv_transpose_bias_initializer_config": null, "post_fcnet_hiddens": [], "post_fcnet_activation": "relu", "post_fcnet_weights_initializer": null, "post_fcnet_weights_initializer_config": null, "post_fcnet_bias_initializer": null, "post_fcnet_bias_initializer_config": null, "free_log_std": false, "log_std_clip_param": 20.0, "no_final_linear": false, "vf_share_layers": false, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "lstm_weights_initializer": null, "lstm_weights_initializer_config": null, "lstm_bias_initializer": null, "lstm_bias_initializer_config": null, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "attention_use_n_prev_actions": 0, "attention_use_n_prev_rewards": 0, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": null, "custom_model_config": {}, "custom_action_dist": null, "custom_preprocessor": null, "encoder_latent_dim": null, "always_check_shapes": false, "lstm_use_prev_action_reward": -1, "_use_default_native_models": -1, "_disable_preprocessor_api": false, "_disable_action_flattening": false}, "_learner_connector": null, "add_default_connectors_to_learner_pipeline": true, "learner_config_dict": {}, "optimizer": {}, "_learner_class": null, "callbacks_on_algorithm_init": null, "callbacks_on_env_runners_recreated": null, "callbacks_on_offline_eval_runners_recreated": null, "callbacks_on_checkpoint_loaded": null, "callbacks_on_environment_created": null, "callbacks_on_episode_created": null, "callbacks_on_episode_start": null, "callbacks_on_episode_step": null, "callbacks_on_episode_end": null, "callbacks_on_evaluate_start": null, "callbacks_on_evaluate_end": null, "callbacks_on_evaluate_offline_start": null, "callbacks_on_evaluate_offline_end": null, "callbacks_on_sample_end": null, "callbacks_on_train_result": null, "explore": true, "enable_rl_module_and_learner": true, "enable_env_runner_and_connector_v2": true, "_prior_exploration_config": {"type": "StochasticSampling"}, "count_steps_by": "env_steps", "policy_map_capacity": 100, "policy_mapping_fn": "<function AlgorithmConfig.DEFAULT_POLICY_MAPPING_FN at 0x161a518a0>", "policies_to_train": null, "policy_states_are_swappable": false, "observation_fn": null, "offline_data_class": null, "input_read_method": "read_parquet", "input_read_method_kwargs": {}, "input_read_schema": {}, "input_read_episodes": false, "input_read_sample_batches": false, "input_read_batch_size": null, "input_filesystem": null, "input_filesystem_kwargs": {}, "input_compress_columns": ["obs", "new_obs"], "input_spaces_jsonable": true, "materialize_data": false, "materialize_mapped_data": true, "map_batches_kwargs": {}, "iter_batches_kwargs": {}, "ignore_final_observation": false, "prelearner_class": null, "prelearner_buffer_class": null, "prelearner_buffer_kwargs": {}, "prelearner_module_synch_period": 10, "dataset_num_iters_per_learner": null, "input_config": {}, "actions_in_input_normalized": false, "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_config": {}, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "output_max_rows_per_file": null, "output_write_remaining_data": false, "output_write_method": "write_parquet", "output_write_method_kwargs": {}, "output_filesystem": null, "output_filesystem_kwargs": {}, "output_write_episodes": true, "offline_sampling": false, "evaluation_interval": 1, "evaluation_duration": 20, "evaluation_duration_unit": "episodes", "evaluation_sample_timeout_s": 120.0, "evaluation_auto_duration_min_env_steps_per_sample": 100, "evaluation_auto_duration_max_env_steps_per_sample": 2000, "evaluation_parallel_to_training": false, "evaluation_force_reset_envs_before_iteration": true, "evaluation_config": null, "off_policy_estimation_methods": {}, "ope_split_batch_by_episode": true, "evaluation_num_env_runners": 1, "in_evaluation": false, "sync_filters_on_rollout_workers_timeout_s": 10.0, "offline_evaluation_interval": null, "num_offline_eval_runners": 0, "offline_loss_for_module_fn": null, "offline_evaluation_duration": 1, "offline_evaluation_parallel_to_training": false, "offline_evaluation_timeout_s": 120.0, "num_cpus_per_offline_eval_runner": 1, "num_gpus_per_offline_eval_runner": 0, "custom_resources_per_offline_eval_runner": {}, "restart_failed_offline_eval_runners": true, "ignore_offline_eval_runner_failures": false, "max_num_offline_eval_runner_restarts": 1000, "offline_eval_runner_restore_timeout_s": 1800.0, "max_requests_in_flight_per_offline_eval_runner": 1, "validate_offline_eval_runners_after_construction": true, "offline_eval_runner_health_probe_timeout_s": 30.0, "offline_eval_rl_module_inference_only": false, "broadcast_offline_eval_runner_states": false, "offline_eval_batch_size_per_runner": 256, "dataset_num_iters_per_eval_runner": 1, "keep_per_episode_custom_metrics": false, "metrics_episode_collection_timeout_s": 60.0, "metrics_num_episodes_for_smoothing": 100, "min_time_s_per_iteration": null, "min_train_timesteps_per_iteration": 0, "min_sample_timesteps_per_iteration": 0, "log_gradients": true, "export_native_model_files": false, "checkpoint_trainable_policies_only": false, "logger_creator": null, "logger_config": null, "log_level": "WARN", "log_sys_usage": true, "fake_sampler": false, "seed": 10, "restart_failed_env_runners": true, "ignore_env_runner_failures": false, "max_num_env_runner_restarts": 1000, "delay_between_env_runner_restarts_s": 60.0, "restart_failed_sub_environments": false, "num_consecutive_env_runner_failures_tolerance": 100, "env_runner_health_probe_timeout_s": 30.0, "env_runner_restore_timeout_s": 1800.0, "_model_config": {}, "_rl_module_spec": "RLModuleSpec(module_class=None, observation_space=None, action_space=None, inference_only=False, learner_only=False, model_config=DefaultModelConfig(fcnet_hiddens=[60, 90], fcnet_activation='tanh', fcnet_kernel_initializer=None, fcnet_kernel_initializer_kwargs=None, fcnet_bias_initializer=None, fcnet_bias_initializer_kwargs=None, conv_filters=None, conv_activation='relu', conv_kernel_initializer=None, conv_kernel_initializer_kwargs=None, conv_bias_initializer=None, conv_bias_initializer_kwargs=None, head_fcnet_hiddens=[], head_fcnet_activation='relu', head_fcnet_kernel_initializer=None, head_fcnet_kernel_initializer_kwargs=None, head_fcnet_bias_initializer=None, head_fcnet_bias_initializer_kwargs=None, free_log_std=False, log_std_clip_param=20.0, vf_share_layers=True, use_lstm=False, max_seq_len=20, lstm_cell_size=256, lstm_use_prev_action=False, lstm_use_prev_reward=False, lstm_kernel_initializer=None, lstm_kernel_initializer_kwargs=None, lstm_bias_initializer=None, lstm_bias_initializer_kwargs=None), catalog_class=None, load_state_path=None, model_config_dict=None)", "algorithm_config_overrides_per_module": {}, "_per_module_overrides": {}, "_validate_config": true, "_use_msgpack_checkpoints": false, "_torch_grad_scaler_class": null, "_torch_lr_scheduler_classes": null, "_tf_policy_handles_more_than_one_loss": false, "_disable_preprocessor_api": false, "_disable_action_flattening": false, "_disable_initialize_loss_from_dummy_batch": false, "_dont_auto_sync_env_runner_states": false, "env_task_fn": -1, "enable_connectors": -1, "simple_optimizer": false, "policy_map_cache": -1, "worker_cls": -1, "synchronize_filters": -1, "enable_async_evaluation": -1, "custom_async_evaluation_function": -1, "_enable_rl_module_api": -1, "auto_wrap_old_gym_envs": -1, "always_attach_evaluation_results": -1, "replay_sequence_length": null, "_disable_execution_plan_api": -1, "use_critic": true, "use_gae": true, "use_kl_loss": true, "kl_coeff": 0.7464963036515, "kl_target": 0.0270990929592, "vf_loss_coeff": 0.6688075857018, "entropy_coeff": 0.0090570820258, "clip_param": 0.1221781641624, "vf_clip_param": 0.1027808522125, "entropy_coeff_schedule": null, "lr_schedule": null, "sgd_minibatch_size": -1, "vf_share_layers": -1, "__stdout_file__": null, "__stderr_file__": null, "lambda": 0.9099046732075, "input": "sampler", "policies": {"default_policy": [null, null, null, null]}, "callbacks": "<class 'ray.rllib.callbacks.callbacks.RLlibCallback'>", "create_env_on_driver": false, "custom_eval_function": null, "framework": "torch"}, "time_since_restore": 93.3551344871521, "iterations_since_restore": 13, "perf": {"cpu_util_percent": 91.075, "ram_util_percent": 80.9125}}
{"timers": {"training_iteration": 15.9484818226624, "restore_env_runners": 0.00010819096896992915, "training_step": 15.947940920446264, "env_runner_sampling_timer": 15.304783323204482, "learner_update_timer": 0.6326853743434403, "synch_weights": 0.0017391149617574208, "restore_eval_env_runners": 3.405370544148017e-05, "evaluation_iteration": 1.0464277672965907, "synch_eval_env_connectors": 0.0004842759521879865, "synch_env_connectors": 8.789915960435365e-06}, "env_runners": {"episode_return_min": -10.5, "num_agent_steps_sampled_lifetime": {"default_agent": -7400000.0}, "module_to_env_connector": {"timers": {"connectors": {"remove_single_ts_time_rank_from_batch": 1.6629361700811569e-06, "normalize_and_clip_actions": 2.77613056690969e-05, "listify_data_for_vector_env": 3.359024362372876e-05, "get_actions": 0.0001579831918778031, "tensor_to_numpy": 4.02084550616819e-05, "un_batch_to_individual_items": 1.4114717882349155e-05}}, "connector_pipeline_timer": 0.0003463215905026282}, "episode_len_mean": 20.0, "num_module_steps_sampled": {"default_policy": 5000.0}, "env_to_module_connector": {"timers": {"connectors": {"add_states_from_episodes_to_batch": 3.7789877950190096e-06, "add_time_dim_to_batch_and_zero_pad": 6.821920098478536e-06, "numpy_to_tensor": 3.0312118765634538e-05, "add_observations_from_episodes_to_batch": 8.728137625696794e-06, "batch_individual_items": 2.0543248817602667e-05}}, "connector_pipeline_timer": 0.00012744480488820808}, "sample": 0.016051012414828408, "env_to_module_sum_episodes_length_out": 10.36823839457432, "weights_seq_no": 13.0, "num_env_steps_sampled_lifetime": -7400000.0, "episode_return_max": 9.5, "episode_return_mean": 5.019999999999998, "module_episode_returns_mean": {"default_policy": 5.019999999999998}, "time_between_sampling": 0.004930486746515349, "rlmodule_inference_timer": 0.00010398044739470047, "env_step_timer": 5.067970979682811e-05, "env_reset_timer": 0.00013017940643237938, "agent_episode_returns_mean": {"default_agent": 5.019999999999998}, "num_env_steps_sampled": 5000.0, "episode_duration_sec_mean": 0.014964357344899329, "env_to_module_sum_episodes_length_in": 10.36823839457432, "episode_len_min": 20, "num_agent_steps_sampled": {"default_agent": 5000.0}, "num_episodes": 250.0, "num_module_steps_sampled_lifetime": {"default_policy": -7400000.0}, "episode_len_max": 20, "num_episodes_lifetime": -370000.0, "num_env_steps_sampled_lifetime_throughput": 1543.7301951299512}, "learners": {"__all_modules__": {"learner_connector": {"timers": {"connectors": {"general_advantage_estimation": 0.06106404757235676, "numpy_to_tensor": 0.0006069525122536583, "add_observations_from_episodes_to_batch": 0.0042660249316091884, "add_one_ts_to_episodes_and_truncate": 0.031335661379378876, "batch_individual_items": 0.10922461381017315, "add_states_from_episodes_to_batch": 5.338209675522861e-06, "add_columns_from_episodes_to_train_batch": 0.18051707518986923, "add_time_dim_to_batch_and_zero_pad": 1.8678443886836948e-05}}, "connector_pipeline_timer": 0.38754389966825964}, "num_module_steps_trained_lifetime": 84000, "num_non_trainable_parameters": 0, "learner_connector_sum_episodes_length_out": 5250.0, "num_module_steps_trained": 6000, "num_trainable_parameters": 6003, "num_env_steps_trained": 31500, "num_env_steps_trained_lifetime": 441000, "learner_connector_sum_episodes_length_in": 5000.0, "num_env_steps_trained_lifetime_throughput": 458283.3617479683, "num_module_steps_trained_throughput": 87556.3798805472, "num_module_steps_trained_lifetime_throughput": 87345.91228518636}, "default_policy": {"curr_kl_coeff": 4.5562519517261535e-05, "entropy": 0.5491995215415955, "vf_loss": 0.10278083384037018, "default_optimizer_learning_rate": 0.0002847858517, "vf_explained_var": -0.00948035717010498, "total_loss": -0.1332673281431198, "num_trainable_parameters": 6003, "vf_loss_unclipped": 28.610187530517578, "curr_entropy_coeff": 0.0090570820258, "policy_loss": -0.19703388214111328, "diff_num_grad_updates_vs_sampler_policy": 1.0, "mean_kl_loss": 0.001021185191348195, "gradients_default_optimizer_global_norm": 0.035518303513526917, "num_module_steps_trained_lifetime": 84000, "weights_seq_no": 14.0, "num_module_steps_trained": 6000, "module_train_batch_size_mean": 1000.0, "num_module_steps_trained_lifetime_throughput": 87442.94078175232}}, "num_training_step_calls_per_iteration": 1, "evaluation": {"env_runners": {"env_to_module_connector": {"timers": {"connectors": {"add_states_from_episodes_to_batch": 2.7502348000371593e-06, "numpy_to_tensor": 2.7222267204427683e-05, "add_time_dim_to_batch_and_zero_pad": 7.213292687883648e-06, "add_observations_from_episodes_to_batch": 7.485261898429118e-06, "batch_individual_items": 1.6214115305357192e-05}}, "connector_pipeline_timer": 0.00010417978273421161}, "agent_episode_returns_mean": {"default_agent": -1.15}, "num_agent_steps_sampled": {"default_agent": 400}, "num_env_steps_sampled_lifetime": 70400, "num_env_steps_sampled": 400, "num_episodes": 20, "episode_len_max": 20, "episode_return_min": -14.5, "episode_len_mean": 20.0, "env_to_module_sum_episodes_length_out": 10.368238394574323, "num_module_steps_sampled_lifetime": {"default_policy": 5600}, "num_agent_steps_sampled_lifetime": {"default_agent": 5600}, "module_to_env_connector": {"timers": {"connectors": {"get_actions": 0.00017403780249859146, "normalize_and_clip_actions": 3.5767550384022115e-05, "tensor_to_numpy": 9.930611651727321e-05, "remove_single_ts_time_rank_from_batch": 1.1766772285191256e-06, "listify_data_for_vector_env": 3.038681102221722e-05, "un_batch_to_individual_items": 1.8280780359383975e-05}}, "connector_pipeline_timer": 0.0004441866647833417}, "episode_return_mean": -1.15, "env_reset_timer": 0.004214573195363191, "module_episode_returns_mean": {"default_policy": -1.15}, "num_episodes_lifetime": 280, "sample": 0.989027238747205, "num_module_steps_sampled": {"default_policy": 400}, "env_step_timer": 6.670714876432803e-05, "episode_duration_sec_mean": 0.013846875380259006, "env_to_module_sum_episodes_length_in": 10.368238394574323, "episode_len_min": 20, "weights_seq_no": 14.0, "episode_return_max": 13.5, "rlmodule_inference_timer": 9.537318562295415e-05, "time_between_sampling": 11.140358908673791}, "num_healthy_workers": 1, "actor_manager_num_outstanding_async_reqs": 0, "num_remote_worker_restarts": 0}, "num_env_steps_sampled_lifetime": -7400000.0, "fault_tolerance": {"num_healthy_workers": 0, "num_remote_worker_restarts": 0}, "env_runner_group": {"actor_manager_num_outstanding_async_reqs": 0}, "done": false, "training_iteration": 14, "trial_id": "4d8e6_00000", "date": "2025-08-11_19-29-40", "timestamp": 1754933380, "time_this_iter_s": 5.081331014633179, "time_total_s": 98.43646550178528, "pid": 19818, "hostname": "Mac", "node_ip": "127.0.0.1", "config": {"exploration_config": {}, "extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "placement_strategy": "PACK", "num_gpus": 0, "_fake_gpus": false, "num_cpus_for_main_process": 2, "eager_tracing": true, "eager_max_retraces": 20, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "torch_compile_learner": false, "torch_compile_learner_what_to_compile": "forward_train", "torch_compile_learner_dynamo_backend": "aot_eager", "torch_compile_learner_dynamo_mode": null, "torch_compile_worker": false, "torch_compile_worker_dynamo_backend": "aot_eager", "torch_compile_worker_dynamo_mode": null, "torch_ddp_kwargs": {}, "torch_skip_nan_gradients": false, "env": "Umbrella", "env_config": {}, "observation_space": null, "action_space": null, "clip_rewards": null, "normalize_actions": true, "clip_actions": false, "_is_atari": null, "disable_env_checking": false, "render_env": false, "action_mask_key": "action_mask", "env_runner_cls": null, "num_env_runners": 0, "create_local_env_runner": true, "num_envs_per_env_runner": 1, "gym_env_vectorize_mode": "SYNC", "num_cpus_per_env_runner": 1, "num_gpus_per_env_runner": 0, "custom_resources_per_env_runner": {}, "validate_env_runners_after_construction": true, "episodes_to_numpy": true, "max_requests_in_flight_per_env_runner": 1, "sample_timeout_s": 60.0, "_env_to_module_connector": null, "add_default_connectors_to_env_to_module_pipeline": true, "_module_to_env_connector": null, "add_default_connectors_to_module_to_env_pipeline": true, "merge_env_runner_states": "training_only", "broadcast_env_runner_states": true, "episode_lookback_horizon": 1, "rollout_fragment_length": "auto", "batch_mode": "complete_episodes", "compress_observations": false, "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "enable_tf1_exec_eagerly": false, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "preprocessor_pref": "deepmind", "observation_filter": "NoFilter", "update_worker_filter_stats": true, "use_worker_filter_stats": true, "sampler_perf_stats_ema_coef": null, "_is_online": true, "num_learners": 0, "num_gpus_per_learner": 0, "num_cpus_per_learner": "auto", "num_aggregator_actors_per_learner": 0, "max_requests_in_flight_per_aggregator_actor": 3, "local_gpu_idx": 0, "max_requests_in_flight_per_learner": 3, "gamma": 1, "lr": 0.0002847858517, "grad_clip": 0.5, "grad_clip_by": "global_norm", "_train_batch_size_per_learner": 5000, "train_batch_size": 4000, "num_epochs": 1, "minibatch_size": 1000, "shuffle_batch_per_epoch": true, "model": {"fcnet_hiddens": [256, 256], "fcnet_activation": "tanh", "fcnet_weights_initializer": null, "fcnet_weights_initializer_config": null, "fcnet_bias_initializer": null, "fcnet_bias_initializer_config": null, "conv_filters": null, "conv_activation": "relu", "conv_kernel_initializer": null, "conv_kernel_initializer_config": null, "conv_bias_initializer": null, "conv_bias_initializer_config": null, "conv_transpose_kernel_initializer": null, "conv_transpose_kernel_initializer_config": null, "conv_transpose_bias_initializer": null, "conv_transpose_bias_initializer_config": null, "post_fcnet_hiddens": [], "post_fcnet_activation": "relu", "post_fcnet_weights_initializer": null, "post_fcnet_weights_initializer_config": null, "post_fcnet_bias_initializer": null, "post_fcnet_bias_initializer_config": null, "free_log_std": false, "log_std_clip_param": 20.0, "no_final_linear": false, "vf_share_layers": false, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "lstm_weights_initializer": null, "lstm_weights_initializer_config": null, "lstm_bias_initializer": null, "lstm_bias_initializer_config": null, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "attention_use_n_prev_actions": 0, "attention_use_n_prev_rewards": 0, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": null, "custom_model_config": {}, "custom_action_dist": null, "custom_preprocessor": null, "encoder_latent_dim": null, "always_check_shapes": false, "lstm_use_prev_action_reward": -1, "_use_default_native_models": -1, "_disable_preprocessor_api": false, "_disable_action_flattening": false}, "_learner_connector": null, "add_default_connectors_to_learner_pipeline": true, "learner_config_dict": {}, "optimizer": {}, "_learner_class": null, "callbacks_on_algorithm_init": null, "callbacks_on_env_runners_recreated": null, "callbacks_on_offline_eval_runners_recreated": null, "callbacks_on_checkpoint_loaded": null, "callbacks_on_environment_created": null, "callbacks_on_episode_created": null, "callbacks_on_episode_start": null, "callbacks_on_episode_step": null, "callbacks_on_episode_end": null, "callbacks_on_evaluate_start": null, "callbacks_on_evaluate_end": null, "callbacks_on_evaluate_offline_start": null, "callbacks_on_evaluate_offline_end": null, "callbacks_on_sample_end": null, "callbacks_on_train_result": null, "explore": true, "enable_rl_module_and_learner": true, "enable_env_runner_and_connector_v2": true, "_prior_exploration_config": {"type": "StochasticSampling"}, "count_steps_by": "env_steps", "policy_map_capacity": 100, "policy_mapping_fn": "<function AlgorithmConfig.DEFAULT_POLICY_MAPPING_FN at 0x161a518a0>", "policies_to_train": null, "policy_states_are_swappable": false, "observation_fn": null, "offline_data_class": null, "input_read_method": "read_parquet", "input_read_method_kwargs": {}, "input_read_schema": {}, "input_read_episodes": false, "input_read_sample_batches": false, "input_read_batch_size": null, "input_filesystem": null, "input_filesystem_kwargs": {}, "input_compress_columns": ["obs", "new_obs"], "input_spaces_jsonable": true, "materialize_data": false, "materialize_mapped_data": true, "map_batches_kwargs": {}, "iter_batches_kwargs": {}, "ignore_final_observation": false, "prelearner_class": null, "prelearner_buffer_class": null, "prelearner_buffer_kwargs": {}, "prelearner_module_synch_period": 10, "dataset_num_iters_per_learner": null, "input_config": {}, "actions_in_input_normalized": false, "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_config": {}, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "output_max_rows_per_file": null, "output_write_remaining_data": false, "output_write_method": "write_parquet", "output_write_method_kwargs": {}, "output_filesystem": null, "output_filesystem_kwargs": {}, "output_write_episodes": true, "offline_sampling": false, "evaluation_interval": 1, "evaluation_duration": 20, "evaluation_duration_unit": "episodes", "evaluation_sample_timeout_s": 120.0, "evaluation_auto_duration_min_env_steps_per_sample": 100, "evaluation_auto_duration_max_env_steps_per_sample": 2000, "evaluation_parallel_to_training": false, "evaluation_force_reset_envs_before_iteration": true, "evaluation_config": null, "off_policy_estimation_methods": {}, "ope_split_batch_by_episode": true, "evaluation_num_env_runners": 1, "in_evaluation": false, "sync_filters_on_rollout_workers_timeout_s": 10.0, "offline_evaluation_interval": null, "num_offline_eval_runners": 0, "offline_loss_for_module_fn": null, "offline_evaluation_duration": 1, "offline_evaluation_parallel_to_training": false, "offline_evaluation_timeout_s": 120.0, "num_cpus_per_offline_eval_runner": 1, "num_gpus_per_offline_eval_runner": 0, "custom_resources_per_offline_eval_runner": {}, "restart_failed_offline_eval_runners": true, "ignore_offline_eval_runner_failures": false, "max_num_offline_eval_runner_restarts": 1000, "offline_eval_runner_restore_timeout_s": 1800.0, "max_requests_in_flight_per_offline_eval_runner": 1, "validate_offline_eval_runners_after_construction": true, "offline_eval_runner_health_probe_timeout_s": 30.0, "offline_eval_rl_module_inference_only": false, "broadcast_offline_eval_runner_states": false, "offline_eval_batch_size_per_runner": 256, "dataset_num_iters_per_eval_runner": 1, "keep_per_episode_custom_metrics": false, "metrics_episode_collection_timeout_s": 60.0, "metrics_num_episodes_for_smoothing": 100, "min_time_s_per_iteration": null, "min_train_timesteps_per_iteration": 0, "min_sample_timesteps_per_iteration": 0, "log_gradients": true, "export_native_model_files": false, "checkpoint_trainable_policies_only": false, "logger_creator": null, "logger_config": null, "log_level": "WARN", "log_sys_usage": true, "fake_sampler": false, "seed": 10, "restart_failed_env_runners": true, "ignore_env_runner_failures": false, "max_num_env_runner_restarts": 1000, "delay_between_env_runner_restarts_s": 60.0, "restart_failed_sub_environments": false, "num_consecutive_env_runner_failures_tolerance": 100, "env_runner_health_probe_timeout_s": 30.0, "env_runner_restore_timeout_s": 1800.0, "_model_config": {}, "_rl_module_spec": "RLModuleSpec(module_class=None, observation_space=None, action_space=None, inference_only=False, learner_only=False, model_config=DefaultModelConfig(fcnet_hiddens=[60, 90], fcnet_activation='tanh', fcnet_kernel_initializer=None, fcnet_kernel_initializer_kwargs=None, fcnet_bias_initializer=None, fcnet_bias_initializer_kwargs=None, conv_filters=None, conv_activation='relu', conv_kernel_initializer=None, conv_kernel_initializer_kwargs=None, conv_bias_initializer=None, conv_bias_initializer_kwargs=None, head_fcnet_hiddens=[], head_fcnet_activation='relu', head_fcnet_kernel_initializer=None, head_fcnet_kernel_initializer_kwargs=None, head_fcnet_bias_initializer=None, head_fcnet_bias_initializer_kwargs=None, free_log_std=False, log_std_clip_param=20.0, vf_share_layers=True, use_lstm=False, max_seq_len=20, lstm_cell_size=256, lstm_use_prev_action=False, lstm_use_prev_reward=False, lstm_kernel_initializer=None, lstm_kernel_initializer_kwargs=None, lstm_bias_initializer=None, lstm_bias_initializer_kwargs=None), catalog_class=None, load_state_path=None, model_config_dict=None)", "algorithm_config_overrides_per_module": {}, "_per_module_overrides": {}, "_validate_config": true, "_use_msgpack_checkpoints": false, "_torch_grad_scaler_class": null, "_torch_lr_scheduler_classes": null, "_tf_policy_handles_more_than_one_loss": false, "_disable_preprocessor_api": false, "_disable_action_flattening": false, "_disable_initialize_loss_from_dummy_batch": false, "_dont_auto_sync_env_runner_states": false, "env_task_fn": -1, "enable_connectors": -1, "simple_optimizer": false, "policy_map_cache": -1, "worker_cls": -1, "synchronize_filters": -1, "enable_async_evaluation": -1, "custom_async_evaluation_function": -1, "_enable_rl_module_api": -1, "auto_wrap_old_gym_envs": -1, "always_attach_evaluation_results": -1, "replay_sequence_length": null, "_disable_execution_plan_api": -1, "use_critic": true, "use_gae": true, "use_kl_loss": true, "kl_coeff": 0.7464963036515, "kl_target": 0.0270990929592, "vf_loss_coeff": 0.6688075857018, "entropy_coeff": 0.0090570820258, "clip_param": 0.1221781641624, "vf_clip_param": 0.1027808522125, "entropy_coeff_schedule": null, "lr_schedule": null, "sgd_minibatch_size": -1, "vf_share_layers": -1, "__stdout_file__": null, "__stderr_file__": null, "lambda": 0.9099046732075, "input": "sampler", "policies": {"default_policy": [null, null, null, null]}, "callbacks": "<class 'ray.rllib.callbacks.callbacks.RLlibCallback'>", "create_env_on_driver": false, "custom_eval_function": null, "framework": "torch"}, "time_since_restore": 98.43646550178528, "iterations_since_restore": 14, "perf": {"cpu_util_percent": 90.91428571428571, "ram_util_percent": 80.61428571428573}}
{"timers": {"training_iteration": 15.830962887765752, "restore_env_runners": 0.00010716697939529842, "training_step": 15.830425298742082, "env_runner_sampling_timer": 15.189642580381864, "learner_update_timer": 0.6303465543496347, "synch_weights": 0.0017331479817826972, "restore_eval_env_runners": 3.385524863074227e-05, "evaluation_iteration": 1.0386774800341818, "synch_eval_env_connectors": 0.0004862469418714277, "synch_env_connectors": 8.971596269125989e-06}, "env_runners": {"episode_return_min": -10.5, "num_agent_steps_sampled_lifetime": {"default_agent": -8017500.0}, "module_to_env_connector": {"timers": {"connectors": {"remove_single_ts_time_rank_from_batch": 1.2741009271453152e-06, "normalize_and_clip_actions": 2.5170774666350396e-05, "listify_data_for_vector_env": 2.994940640200704e-05, "get_actions": 0.00012795628375523478, "tensor_to_numpy": 3.615613367639948e-05, "un_batch_to_individual_items": 1.3613850705053613e-05}}, "connector_pipeline_timer": 0.00029510333943348486}, "episode_len_mean": 20.0, "num_module_steps_sampled": {"default_policy": 5000.0}, "env_to_module_connector": {"timers": {"connectors": {"add_states_from_episodes_to_batch": 3.3488181310390616e-06, "add_time_dim_to_batch_and_zero_pad": 5.9307309361967965e-06, "numpy_to_tensor": 2.6619549536979985e-05, "add_observations_from_episodes_to_batch": 7.474151445492657e-06, "batch_individual_items": 1.7412045494916484e-05}}, "connector_pipeline_timer": 0.00010689646376720258}, "sample": 0.014345852213553598, "env_to_module_sum_episodes_length_out": 10.36823839457432, "weights_seq_no": 14.0, "num_env_steps_sampled_lifetime": -8017500.0, "episode_return_max": 9.5, "episode_return_mean": 4.14, "module_episode_returns_mean": {"default_policy": 4.14}, "time_between_sampling": 0.00447837069965595, "rlmodule_inference_timer": 8.385686544538782e-05, "env_step_timer": 4.3028153194975655e-05, "env_reset_timer": 0.00011580516785849171, "agent_episode_returns_mean": {"default_agent": 4.14}, "num_env_steps_sampled": 5000.0, "episode_duration_sec_mean": 0.012634837689343844, "env_to_module_sum_episodes_length_in": 10.36823839457432, "episode_len_min": 20, "num_agent_steps_sampled": {"default_agent": 5000.0}, "num_episodes": 250.0, "num_module_steps_sampled_lifetime": {"default_policy": -8017500.0}, "episode_len_max": 20, "num_episodes_lifetime": -400875.0, "num_env_steps_sampled_lifetime_throughput": 1681.1927793575414}, "learners": {"__all_modules__": {"learner_connector": {"timers": {"connectors": {"general_advantage_estimation": 0.06055590959773722, "numpy_to_tensor": 0.000601628818188551, "add_observations_from_episodes_to_batch": 0.0042551734320657045, "add_one_ts_to_episodes_and_truncate": 0.031204061845720957, "batch_individual_items": 0.11091936933239792, "add_states_from_episodes_to_batch": 5.352746605827903e-06, "add_columns_from_episodes_to_train_batch": 0.17934179568825306, "add_time_dim_to_batch_and_zero_pad": 1.875749849197326e-05}}, "connector_pipeline_timer": 0.38740534525157083}, "num_module_steps_trained_lifetime": 90000, "num_non_trainable_parameters": 0, "learner_connector_sum_episodes_length_out": 5250.0, "num_module_steps_trained": 6000, "num_trainable_parameters": 6003, "num_env_steps_trained": 31500, "num_env_steps_trained_lifetime": 472500, "learner_connector_sum_episodes_length_in": 5000.0, "num_env_steps_trained_lifetime_throughput": 478597.56078421365, "num_module_steps_trained_throughput": 91422.41364546321, "num_module_steps_trained_lifetime_throughput": 91213.76465947874}, "default_policy": {"curr_kl_coeff": 2.2781259758630767e-05, "entropy": 0.5368001461029053, "vf_loss": 0.10278083384037018, "default_optimizer_learning_rate": 0.0002847858517, "vf_explained_var": -0.012212872505187988, "total_loss": 0.2012055665254593, "num_trainable_parameters": 6003, "vf_loss_unclipped": 28.692230224609375, "curr_entropy_coeff": 0.0090570820258, "policy_loss": 0.13732679188251495, "diff_num_grad_updates_vs_sampler_policy": 1.0, "mean_kl_loss": 0.0006800030241720378, "gradients_default_optimizer_global_norm": 0.1371627002954483, "num_module_steps_trained_lifetime": 90000, "weights_seq_no": 15.0, "num_module_steps_trained": 6000, "module_train_batch_size_mean": 1000.0, "num_module_steps_trained_lifetime_throughput": 91310.54185214428}}, "num_training_step_calls_per_iteration": 1, "evaluation": {"env_runners": {"env_to_module_connector": {"timers": {"connectors": {"add_states_from_episodes_to_batch": 2.8728273308675503e-06, "numpy_to_tensor": 1.7558706927721602e-05, "add_time_dim_to_batch_and_zero_pad": 4.488913116758725e-06, "add_observations_from_episodes_to_batch": 4.892557982727248e-06, "batch_individual_items": 1.1073896260486057e-05}}, "connector_pipeline_timer": 7.771540368661919e-05}, "agent_episode_returns_mean": {"default_agent": -0.15}, "num_agent_steps_sampled": {"default_agent": 400}, "num_env_steps_sampled_lifetime": 75400, "num_env_steps_sampled": 400, "num_episodes": 20, "episode_len_max": 20, "episode_return_min": -14.5, "episode_len_mean": 20.0, "env_to_module_sum_episodes_length_out": 10.368238394574323, "num_module_steps_sampled_lifetime": {"default_policy": 6000}, "num_agent_steps_sampled_lifetime": {"default_agent": 6000}, "module_to_env_connector": {"timers": {"connectors": {"get_actions": 7.960837683729157e-05, "normalize_and_clip_actions": 1.8222580560142037e-05, "tensor_to_numpy": 2.6007943650092298e-05, "remove_single_ts_time_rank_from_batch": 1.218972085550358e-06, "listify_data_for_vector_env": 2.382514784173414e-05, "un_batch_to_individual_items": 1.0297184854285892e-05}}, "connector_pipeline_timer": 0.00020335457740730957}, "episode_return_mean": -0.15, "env_reset_timer": 0.004173149543413029, "module_episode_returns_mean": {"default_policy": -0.15}, "num_episodes_lifetime": 300, "sample": 0.9817286405199452, "num_module_steps_sampled": {"default_policy": 400}, "env_step_timer": 3.0439085003927187e-05, "episode_duration_sec_mean": 0.012819476210279391, "env_to_module_sum_episodes_length_in": 10.368238394574323, "episode_len_min": 20, "weights_seq_no": 15.0, "episode_return_max": 13.5, "rlmodule_inference_timer": 6.03131853697554e-05, "time_between_sampling": 11.071235509167105}, "num_healthy_workers": 1, "actor_manager_num_outstanding_async_reqs": 0, "num_remote_worker_restarts": 0}, "num_env_steps_sampled_lifetime": -8017500.0, "fault_tolerance": {"num_healthy_workers": 0, "num_remote_worker_restarts": 0}, "env_runner_group": {"actor_manager_num_outstanding_async_reqs": 0}, "done": false, "training_iteration": 15, "trial_id": "4d8e6_00000", "date": "2025-08-11_19-29-45", "timestamp": 1754933385, "time_this_iter_s": 4.464602947235107, "time_total_s": 102.90106844902039, "pid": 19818, "hostname": "Mac", "node_ip": "127.0.0.1", "config": {"exploration_config": {}, "extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "placement_strategy": "PACK", "num_gpus": 0, "_fake_gpus": false, "num_cpus_for_main_process": 2, "eager_tracing": true, "eager_max_retraces": 20, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "torch_compile_learner": false, "torch_compile_learner_what_to_compile": "forward_train", "torch_compile_learner_dynamo_backend": "aot_eager", "torch_compile_learner_dynamo_mode": null, "torch_compile_worker": false, "torch_compile_worker_dynamo_backend": "aot_eager", "torch_compile_worker_dynamo_mode": null, "torch_ddp_kwargs": {}, "torch_skip_nan_gradients": false, "env": "Umbrella", "env_config": {}, "observation_space": null, "action_space": null, "clip_rewards": null, "normalize_actions": true, "clip_actions": false, "_is_atari": null, "disable_env_checking": false, "render_env": false, "action_mask_key": "action_mask", "env_runner_cls": null, "num_env_runners": 0, "create_local_env_runner": true, "num_envs_per_env_runner": 1, "gym_env_vectorize_mode": "SYNC", "num_cpus_per_env_runner": 1, "num_gpus_per_env_runner": 0, "custom_resources_per_env_runner": {}, "validate_env_runners_after_construction": true, "episodes_to_numpy": true, "max_requests_in_flight_per_env_runner": 1, "sample_timeout_s": 60.0, "_env_to_module_connector": null, "add_default_connectors_to_env_to_module_pipeline": true, "_module_to_env_connector": null, "add_default_connectors_to_module_to_env_pipeline": true, "merge_env_runner_states": "training_only", "broadcast_env_runner_states": true, "episode_lookback_horizon": 1, "rollout_fragment_length": "auto", "batch_mode": "complete_episodes", "compress_observations": false, "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "enable_tf1_exec_eagerly": false, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "preprocessor_pref": "deepmind", "observation_filter": "NoFilter", "update_worker_filter_stats": true, "use_worker_filter_stats": true, "sampler_perf_stats_ema_coef": null, "_is_online": true, "num_learners": 0, "num_gpus_per_learner": 0, "num_cpus_per_learner": "auto", "num_aggregator_actors_per_learner": 0, "max_requests_in_flight_per_aggregator_actor": 3, "local_gpu_idx": 0, "max_requests_in_flight_per_learner": 3, "gamma": 1, "lr": 0.0002847858517, "grad_clip": 0.5, "grad_clip_by": "global_norm", "_train_batch_size_per_learner": 5000, "train_batch_size": 4000, "num_epochs": 1, "minibatch_size": 1000, "shuffle_batch_per_epoch": true, "model": {"fcnet_hiddens": [256, 256], "fcnet_activation": "tanh", "fcnet_weights_initializer": null, "fcnet_weights_initializer_config": null, "fcnet_bias_initializer": null, "fcnet_bias_initializer_config": null, "conv_filters": null, "conv_activation": "relu", "conv_kernel_initializer": null, "conv_kernel_initializer_config": null, "conv_bias_initializer": null, "conv_bias_initializer_config": null, "conv_transpose_kernel_initializer": null, "conv_transpose_kernel_initializer_config": null, "conv_transpose_bias_initializer": null, "conv_transpose_bias_initializer_config": null, "post_fcnet_hiddens": [], "post_fcnet_activation": "relu", "post_fcnet_weights_initializer": null, "post_fcnet_weights_initializer_config": null, "post_fcnet_bias_initializer": null, "post_fcnet_bias_initializer_config": null, "free_log_std": false, "log_std_clip_param": 20.0, "no_final_linear": false, "vf_share_layers": false, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "lstm_weights_initializer": null, "lstm_weights_initializer_config": null, "lstm_bias_initializer": null, "lstm_bias_initializer_config": null, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "attention_use_n_prev_actions": 0, "attention_use_n_prev_rewards": 0, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": null, "custom_model_config": {}, "custom_action_dist": null, "custom_preprocessor": null, "encoder_latent_dim": null, "always_check_shapes": false, "lstm_use_prev_action_reward": -1, "_use_default_native_models": -1, "_disable_preprocessor_api": false, "_disable_action_flattening": false}, "_learner_connector": null, "add_default_connectors_to_learner_pipeline": true, "learner_config_dict": {}, "optimizer": {}, "_learner_class": null, "callbacks_on_algorithm_init": null, "callbacks_on_env_runners_recreated": null, "callbacks_on_offline_eval_runners_recreated": null, "callbacks_on_checkpoint_loaded": null, "callbacks_on_environment_created": null, "callbacks_on_episode_created": null, "callbacks_on_episode_start": null, "callbacks_on_episode_step": null, "callbacks_on_episode_end": null, "callbacks_on_evaluate_start": null, "callbacks_on_evaluate_end": null, "callbacks_on_evaluate_offline_start": null, "callbacks_on_evaluate_offline_end": null, "callbacks_on_sample_end": null, "callbacks_on_train_result": null, "explore": true, "enable_rl_module_and_learner": true, "enable_env_runner_and_connector_v2": true, "_prior_exploration_config": {"type": "StochasticSampling"}, "count_steps_by": "env_steps", "policy_map_capacity": 100, "policy_mapping_fn": "<function AlgorithmConfig.DEFAULT_POLICY_MAPPING_FN at 0x161a518a0>", "policies_to_train": null, "policy_states_are_swappable": false, "observation_fn": null, "offline_data_class": null, "input_read_method": "read_parquet", "input_read_method_kwargs": {}, "input_read_schema": {}, "input_read_episodes": false, "input_read_sample_batches": false, "input_read_batch_size": null, "input_filesystem": null, "input_filesystem_kwargs": {}, "input_compress_columns": ["obs", "new_obs"], "input_spaces_jsonable": true, "materialize_data": false, "materialize_mapped_data": true, "map_batches_kwargs": {}, "iter_batches_kwargs": {}, "ignore_final_observation": false, "prelearner_class": null, "prelearner_buffer_class": null, "prelearner_buffer_kwargs": {}, "prelearner_module_synch_period": 10, "dataset_num_iters_per_learner": null, "input_config": {}, "actions_in_input_normalized": false, "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_config": {}, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "output_max_rows_per_file": null, "output_write_remaining_data": false, "output_write_method": "write_parquet", "output_write_method_kwargs": {}, "output_filesystem": null, "output_filesystem_kwargs": {}, "output_write_episodes": true, "offline_sampling": false, "evaluation_interval": 1, "evaluation_duration": 20, "evaluation_duration_unit": "episodes", "evaluation_sample_timeout_s": 120.0, "evaluation_auto_duration_min_env_steps_per_sample": 100, "evaluation_auto_duration_max_env_steps_per_sample": 2000, "evaluation_parallel_to_training": false, "evaluation_force_reset_envs_before_iteration": true, "evaluation_config": null, "off_policy_estimation_methods": {}, "ope_split_batch_by_episode": true, "evaluation_num_env_runners": 1, "in_evaluation": false, "sync_filters_on_rollout_workers_timeout_s": 10.0, "offline_evaluation_interval": null, "num_offline_eval_runners": 0, "offline_loss_for_module_fn": null, "offline_evaluation_duration": 1, "offline_evaluation_parallel_to_training": false, "offline_evaluation_timeout_s": 120.0, "num_cpus_per_offline_eval_runner": 1, "num_gpus_per_offline_eval_runner": 0, "custom_resources_per_offline_eval_runner": {}, "restart_failed_offline_eval_runners": true, "ignore_offline_eval_runner_failures": false, "max_num_offline_eval_runner_restarts": 1000, "offline_eval_runner_restore_timeout_s": 1800.0, "max_requests_in_flight_per_offline_eval_runner": 1, "validate_offline_eval_runners_after_construction": true, "offline_eval_runner_health_probe_timeout_s": 30.0, "offline_eval_rl_module_inference_only": false, "broadcast_offline_eval_runner_states": false, "offline_eval_batch_size_per_runner": 256, "dataset_num_iters_per_eval_runner": 1, "keep_per_episode_custom_metrics": false, "metrics_episode_collection_timeout_s": 60.0, "metrics_num_episodes_for_smoothing": 100, "min_time_s_per_iteration": null, "min_train_timesteps_per_iteration": 0, "min_sample_timesteps_per_iteration": 0, "log_gradients": true, "export_native_model_files": false, "checkpoint_trainable_policies_only": false, "logger_creator": null, "logger_config": null, "log_level": "WARN", "log_sys_usage": true, "fake_sampler": false, "seed": 10, "restart_failed_env_runners": true, "ignore_env_runner_failures": false, "max_num_env_runner_restarts": 1000, "delay_between_env_runner_restarts_s": 60.0, "restart_failed_sub_environments": false, "num_consecutive_env_runner_failures_tolerance": 100, "env_runner_health_probe_timeout_s": 30.0, "env_runner_restore_timeout_s": 1800.0, "_model_config": {}, "_rl_module_spec": "RLModuleSpec(module_class=None, observation_space=None, action_space=None, inference_only=False, learner_only=False, model_config=DefaultModelConfig(fcnet_hiddens=[60, 90], fcnet_activation='tanh', fcnet_kernel_initializer=None, fcnet_kernel_initializer_kwargs=None, fcnet_bias_initializer=None, fcnet_bias_initializer_kwargs=None, conv_filters=None, conv_activation='relu', conv_kernel_initializer=None, conv_kernel_initializer_kwargs=None, conv_bias_initializer=None, conv_bias_initializer_kwargs=None, head_fcnet_hiddens=[], head_fcnet_activation='relu', head_fcnet_kernel_initializer=None, head_fcnet_kernel_initializer_kwargs=None, head_fcnet_bias_initializer=None, head_fcnet_bias_initializer_kwargs=None, free_log_std=False, log_std_clip_param=20.0, vf_share_layers=True, use_lstm=False, max_seq_len=20, lstm_cell_size=256, lstm_use_prev_action=False, lstm_use_prev_reward=False, lstm_kernel_initializer=None, lstm_kernel_initializer_kwargs=None, lstm_bias_initializer=None, lstm_bias_initializer_kwargs=None), catalog_class=None, load_state_path=None, model_config_dict=None)", "algorithm_config_overrides_per_module": {}, "_per_module_overrides": {}, "_validate_config": true, "_use_msgpack_checkpoints": false, "_torch_grad_scaler_class": null, "_torch_lr_scheduler_classes": null, "_tf_policy_handles_more_than_one_loss": false, "_disable_preprocessor_api": false, "_disable_action_flattening": false, "_disable_initialize_loss_from_dummy_batch": false, "_dont_auto_sync_env_runner_states": false, "env_task_fn": -1, "enable_connectors": -1, "simple_optimizer": false, "policy_map_cache": -1, "worker_cls": -1, "synchronize_filters": -1, "enable_async_evaluation": -1, "custom_async_evaluation_function": -1, "_enable_rl_module_api": -1, "auto_wrap_old_gym_envs": -1, "always_attach_evaluation_results": -1, "replay_sequence_length": null, "_disable_execution_plan_api": -1, "use_critic": true, "use_gae": true, "use_kl_loss": true, "kl_coeff": 0.7464963036515, "kl_target": 0.0270990929592, "vf_loss_coeff": 0.6688075857018, "entropy_coeff": 0.0090570820258, "clip_param": 0.1221781641624, "vf_clip_param": 0.1027808522125, "entropy_coeff_schedule": null, "lr_schedule": null, "sgd_minibatch_size": -1, "vf_share_layers": -1, "__stdout_file__": null, "__stderr_file__": null, "lambda": 0.9099046732075, "input": "sampler", "policies": {"default_policy": [null, null, null, null]}, "callbacks": "<class 'ray.rllib.callbacks.callbacks.RLlibCallback'>", "create_env_on_driver": false, "custom_eval_function": null, "framework": "torch"}, "time_since_restore": 102.90106844902039, "iterations_since_restore": 15, "perf": {"cpu_util_percent": 89.78571428571426, "ram_util_percent": 80.11428571428571}}
{"timers": {"training_iteration": 15.719063572638477, "restore_env_runners": 0.00010616365005187072, "training_step": 15.718527945754953, "env_runner_sampling_timer": 15.08163834498787, "learner_update_timer": 0.62647395713655, "synch_weights": 0.0017332156717023435, "restore_eval_env_runners": 3.3585026117581165e-05, "evaluation_iteration": 1.0309470243938543, "synch_eval_env_connectors": 0.00048282655211785274, "synch_env_connectors": 8.927290431019762e-06}, "env_runners": {"episode_return_min": -10.5, "num_agent_steps_sampled_lifetime": {"default_agent": -8635000.0}, "module_to_env_connector": {"timers": {"connectors": {"remove_single_ts_time_rank_from_batch": 2.082483744663154e-06, "normalize_and_clip_actions": 2.5894753949850116e-05, "listify_data_for_vector_env": 3.1229404616922075e-05, "get_actions": 0.0001484695072233468, "tensor_to_numpy": 4.4522450735306993e-05, "un_batch_to_individual_items": 1.285103519407784e-05}}, "connector_pipeline_timer": 0.00033380231036934596}, "episode_len_mean": 20.0, "num_module_steps_sampled": {"default_policy": 5000.0}, "env_to_module_connector": {"timers": {"connectors": {"add_states_from_episodes_to_batch": 3.8115200458248945e-06, "add_time_dim_to_batch_and_zero_pad": 6.67985111830601e-06, "numpy_to_tensor": 3.344387834057368e-05, "add_observations_from_episodes_to_batch": 8.940892430436585e-06, "batch_individual_items": 1.8846597035651812e-05}}, "connector_pipeline_timer": 0.00012407152969893027}, "sample": 0.014720630645316703, "env_to_module_sum_episodes_length_out": 10.36823839457432, "weights_seq_no": 15.0, "num_env_steps_sampled_lifetime": -8635000.0, "episode_return_max": 9.5, "episode_return_mean": 6.62, "module_episode_returns_mean": {"default_policy": 6.62}, "time_between_sampling": 0.004533989392945851, "rlmodule_inference_timer": 0.0001044020885926982, "env_step_timer": 4.815681999102755e-05, "env_reset_timer": 0.0001285514040350251, "agent_episode_returns_mean": {"default_agent": 6.62}, "num_env_steps_sampled": 5000.0, "episode_duration_sec_mean": 0.014593276993371547, "env_to_module_sum_episodes_length_in": 10.36823839457432, "episode_len_min": 20, "num_agent_steps_sampled": {"default_agent": 5000.0}, "num_episodes": 250.0, "num_module_steps_sampled_lifetime": {"default_policy": -8635000.0}, "episode_len_max": 20, "num_episodes_lifetime": -431750.0, "num_env_steps_sampled_lifetime_throughput": 1615.0756856298383}, "learners": {"__all_modules__": {"learner_connector": {"timers": {"connectors": {"general_advantage_estimation": 0.060036988000803565, "numpy_to_tensor": 0.0005962404393280034, "add_observations_from_episodes_to_batch": 0.004231250857057742, "add_one_ts_to_episodes_and_truncate": 0.0310467941473321, "batch_individual_items": 0.11027070438904653, "add_states_from_episodes_to_batch": 5.333389365032265e-06, "add_columns_from_episodes_to_train_batch": 0.17811885940122676, "add_time_dim_to_batch_and_zero_pad": 1.8692423857752353e-05}}, "connector_pipeline_timer": 0.38482438221913173}, "num_module_steps_trained_lifetime": 96000, "num_non_trainable_parameters": 0, "learner_connector_sum_episodes_length_out": 5250.0, "num_module_steps_trained": 6000, "num_trainable_parameters": 6003, "num_env_steps_trained": 31500, "num_env_steps_trained_lifetime": 504000, "learner_connector_sum_episodes_length_in": 5000.0, "num_env_steps_trained_lifetime_throughput": 493049.20723994577, "num_module_steps_trained_throughput": 94172.35060132448, "num_module_steps_trained_lifetime_throughput": 93965.03298355812}, "default_policy": {"curr_kl_coeff": 1.1390629879315384e-05, "entropy": 0.4997800886631012, "vf_loss": 0.10278083384037018, "default_optimizer_learning_rate": 0.0002847858517, "vf_explained_var": -0.011586427688598633, "total_loss": 0.2740742564201355, "num_trainable_parameters": 6003, "vf_loss_unclipped": 28.64261817932129, "curr_entropy_coeff": 0.0090570820258, "policy_loss": 0.2098601907491684, "diff_num_grad_updates_vs_sampler_policy": 1.0, "mean_kl_loss": 0.0011202433379366994, "gradients_default_optimizer_global_norm": 0.06061369180679321, "num_module_steps_trained_lifetime": 96000, "weights_seq_no": 16.0, "num_module_steps_trained": 6000, "module_train_batch_size_mean": 1000.0, "num_module_steps_trained_lifetime_throughput": 94062.1858839192}}, "num_training_step_calls_per_iteration": 1, "evaluation": {"env_runners": {"env_to_module_connector": {"timers": {"connectors": {"add_states_from_episodes_to_batch": 4.5240159621386715e-06, "numpy_to_tensor": 4.23257512978089e-05, "add_time_dim_to_batch_and_zero_pad": 7.1127347875779185e-06, "add_observations_from_episodes_to_batch": 9.926648082490347e-06, "batch_individual_items": 2.5937789171356362e-05}}, "connector_pipeline_timer": 0.0001499180668713411}, "agent_episode_returns_mean": {"default_agent": 0.45}, "num_agent_steps_sampled": {"default_agent": 400}, "num_env_steps_sampled_lifetime": 80400, "num_env_steps_sampled": 400, "num_episodes": 20, "episode_len_max": 20, "episode_return_min": -14.5, "episode_len_mean": 20.0, "env_to_module_sum_episodes_length_out": 10.368238394574323, "num_module_steps_sampled_lifetime": {"default_policy": 6400}, "num_agent_steps_sampled_lifetime": {"default_agent": 6400}, "module_to_env_connector": {"timers": {"connectors": {"get_actions": 0.00022504377437786814, "normalize_and_clip_actions": 3.556673906111791e-05, "tensor_to_numpy": 4.884729960062636e-05, "remove_single_ts_time_rank_from_batch": 2.186100703882692e-06, "listify_data_for_vector_env": 3.7693061440072376e-05, "un_batch_to_individual_items": 3.092176438764869e-05}}, "connector_pipeline_timer": 0.00047616820405008234}, "episode_return_mean": 0.45, "env_reset_timer": 0.004132289297919145, "module_episode_returns_mean": {"default_policy": 0.45}, "num_episodes_lifetime": 320, "sample": 0.9752997786944985, "num_module_steps_sampled": {"default_policy": 400}, "env_step_timer": 6.448163050645543e-05, "episode_duration_sec_mean": 0.012987181688658892, "env_to_module_sum_episodes_length_in": 10.368238394574323, "episode_len_min": 20, "weights_seq_no": 16.0, "episode_return_max": 13.5, "rlmodule_inference_timer": 0.00012353913001014543, "time_between_sampling": 11.007402672824625}, "num_healthy_workers": 1, "actor_manager_num_outstanding_async_reqs": 0, "num_remote_worker_restarts": 0}, "num_env_steps_sampled_lifetime": -8635000.0, "fault_tolerance": {"num_healthy_workers": 0, "num_remote_worker_restarts": 0}, "env_runner_group": {"actor_manager_num_outstanding_async_reqs": 0}, "done": false, "training_iteration": 16, "trial_id": "4d8e6_00000", "date": "2025-08-11_19-29-50", "timestamp": 1754933390, "time_this_iter_s": 5.004258155822754, "time_total_s": 107.90532660484314, "pid": 19818, "hostname": "Mac", "node_ip": "127.0.0.1", "config": {"exploration_config": {}, "extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "placement_strategy": "PACK", "num_gpus": 0, "_fake_gpus": false, "num_cpus_for_main_process": 2, "eager_tracing": true, "eager_max_retraces": 20, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "torch_compile_learner": false, "torch_compile_learner_what_to_compile": "forward_train", "torch_compile_learner_dynamo_backend": "aot_eager", "torch_compile_learner_dynamo_mode": null, "torch_compile_worker": false, "torch_compile_worker_dynamo_backend": "aot_eager", "torch_compile_worker_dynamo_mode": null, "torch_ddp_kwargs": {}, "torch_skip_nan_gradients": false, "env": "Umbrella", "env_config": {}, "observation_space": null, "action_space": null, "clip_rewards": null, "normalize_actions": true, "clip_actions": false, "_is_atari": null, "disable_env_checking": false, "render_env": false, "action_mask_key": "action_mask", "env_runner_cls": null, "num_env_runners": 0, "create_local_env_runner": true, "num_envs_per_env_runner": 1, "gym_env_vectorize_mode": "SYNC", "num_cpus_per_env_runner": 1, "num_gpus_per_env_runner": 0, "custom_resources_per_env_runner": {}, "validate_env_runners_after_construction": true, "episodes_to_numpy": true, "max_requests_in_flight_per_env_runner": 1, "sample_timeout_s": 60.0, "_env_to_module_connector": null, "add_default_connectors_to_env_to_module_pipeline": true, "_module_to_env_connector": null, "add_default_connectors_to_module_to_env_pipeline": true, "merge_env_runner_states": "training_only", "broadcast_env_runner_states": true, "episode_lookback_horizon": 1, "rollout_fragment_length": "auto", "batch_mode": "complete_episodes", "compress_observations": false, "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "enable_tf1_exec_eagerly": false, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "preprocessor_pref": "deepmind", "observation_filter": "NoFilter", "update_worker_filter_stats": true, "use_worker_filter_stats": true, "sampler_perf_stats_ema_coef": null, "_is_online": true, "num_learners": 0, "num_gpus_per_learner": 0, "num_cpus_per_learner": "auto", "num_aggregator_actors_per_learner": 0, "max_requests_in_flight_per_aggregator_actor": 3, "local_gpu_idx": 0, "max_requests_in_flight_per_learner": 3, "gamma": 1, "lr": 0.0002847858517, "grad_clip": 0.5, "grad_clip_by": "global_norm", "_train_batch_size_per_learner": 5000, "train_batch_size": 4000, "num_epochs": 1, "minibatch_size": 1000, "shuffle_batch_per_epoch": true, "model": {"fcnet_hiddens": [256, 256], "fcnet_activation": "tanh", "fcnet_weights_initializer": null, "fcnet_weights_initializer_config": null, "fcnet_bias_initializer": null, "fcnet_bias_initializer_config": null, "conv_filters": null, "conv_activation": "relu", "conv_kernel_initializer": null, "conv_kernel_initializer_config": null, "conv_bias_initializer": null, "conv_bias_initializer_config": null, "conv_transpose_kernel_initializer": null, "conv_transpose_kernel_initializer_config": null, "conv_transpose_bias_initializer": null, "conv_transpose_bias_initializer_config": null, "post_fcnet_hiddens": [], "post_fcnet_activation": "relu", "post_fcnet_weights_initializer": null, "post_fcnet_weights_initializer_config": null, "post_fcnet_bias_initializer": null, "post_fcnet_bias_initializer_config": null, "free_log_std": false, "log_std_clip_param": 20.0, "no_final_linear": false, "vf_share_layers": false, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "lstm_weights_initializer": null, "lstm_weights_initializer_config": null, "lstm_bias_initializer": null, "lstm_bias_initializer_config": null, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "attention_use_n_prev_actions": 0, "attention_use_n_prev_rewards": 0, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": null, "custom_model_config": {}, "custom_action_dist": null, "custom_preprocessor": null, "encoder_latent_dim": null, "always_check_shapes": false, "lstm_use_prev_action_reward": -1, "_use_default_native_models": -1, "_disable_preprocessor_api": false, "_disable_action_flattening": false}, "_learner_connector": null, "add_default_connectors_to_learner_pipeline": true, "learner_config_dict": {}, "optimizer": {}, "_learner_class": null, "callbacks_on_algorithm_init": null, "callbacks_on_env_runners_recreated": null, "callbacks_on_offline_eval_runners_recreated": null, "callbacks_on_checkpoint_loaded": null, "callbacks_on_environment_created": null, "callbacks_on_episode_created": null, "callbacks_on_episode_start": null, "callbacks_on_episode_step": null, "callbacks_on_episode_end": null, "callbacks_on_evaluate_start": null, "callbacks_on_evaluate_end": null, "callbacks_on_evaluate_offline_start": null, "callbacks_on_evaluate_offline_end": null, "callbacks_on_sample_end": null, "callbacks_on_train_result": null, "explore": true, "enable_rl_module_and_learner": true, "enable_env_runner_and_connector_v2": true, "_prior_exploration_config": {"type": "StochasticSampling"}, "count_steps_by": "env_steps", "policy_map_capacity": 100, "policy_mapping_fn": "<function AlgorithmConfig.DEFAULT_POLICY_MAPPING_FN at 0x161a518a0>", "policies_to_train": null, "policy_states_are_swappable": false, "observation_fn": null, "offline_data_class": null, "input_read_method": "read_parquet", "input_read_method_kwargs": {}, "input_read_schema": {}, "input_read_episodes": false, "input_read_sample_batches": false, "input_read_batch_size": null, "input_filesystem": null, "input_filesystem_kwargs": {}, "input_compress_columns": ["obs", "new_obs"], "input_spaces_jsonable": true, "materialize_data": false, "materialize_mapped_data": true, "map_batches_kwargs": {}, "iter_batches_kwargs": {}, "ignore_final_observation": false, "prelearner_class": null, "prelearner_buffer_class": null, "prelearner_buffer_kwargs": {}, "prelearner_module_synch_period": 10, "dataset_num_iters_per_learner": null, "input_config": {}, "actions_in_input_normalized": false, "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_config": {}, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "output_max_rows_per_file": null, "output_write_remaining_data": false, "output_write_method": "write_parquet", "output_write_method_kwargs": {}, "output_filesystem": null, "output_filesystem_kwargs": {}, "output_write_episodes": true, "offline_sampling": false, "evaluation_interval": 1, "evaluation_duration": 20, "evaluation_duration_unit": "episodes", "evaluation_sample_timeout_s": 120.0, "evaluation_auto_duration_min_env_steps_per_sample": 100, "evaluation_auto_duration_max_env_steps_per_sample": 2000, "evaluation_parallel_to_training": false, "evaluation_force_reset_envs_before_iteration": true, "evaluation_config": null, "off_policy_estimation_methods": {}, "ope_split_batch_by_episode": true, "evaluation_num_env_runners": 1, "in_evaluation": false, "sync_filters_on_rollout_workers_timeout_s": 10.0, "offline_evaluation_interval": null, "num_offline_eval_runners": 0, "offline_loss_for_module_fn": null, "offline_evaluation_duration": 1, "offline_evaluation_parallel_to_training": false, "offline_evaluation_timeout_s": 120.0, "num_cpus_per_offline_eval_runner": 1, "num_gpus_per_offline_eval_runner": 0, "custom_resources_per_offline_eval_runner": {}, "restart_failed_offline_eval_runners": true, "ignore_offline_eval_runner_failures": false, "max_num_offline_eval_runner_restarts": 1000, "offline_eval_runner_restore_timeout_s": 1800.0, "max_requests_in_flight_per_offline_eval_runner": 1, "validate_offline_eval_runners_after_construction": true, "offline_eval_runner_health_probe_timeout_s": 30.0, "offline_eval_rl_module_inference_only": false, "broadcast_offline_eval_runner_states": false, "offline_eval_batch_size_per_runner": 256, "dataset_num_iters_per_eval_runner": 1, "keep_per_episode_custom_metrics": false, "metrics_episode_collection_timeout_s": 60.0, "metrics_num_episodes_for_smoothing": 100, "min_time_s_per_iteration": null, "min_train_timesteps_per_iteration": 0, "min_sample_timesteps_per_iteration": 0, "log_gradients": true, "export_native_model_files": false, "checkpoint_trainable_policies_only": false, "logger_creator": null, "logger_config": null, "log_level": "WARN", "log_sys_usage": true, "fake_sampler": false, "seed": 10, "restart_failed_env_runners": true, "ignore_env_runner_failures": false, "max_num_env_runner_restarts": 1000, "delay_between_env_runner_restarts_s": 60.0, "restart_failed_sub_environments": false, "num_consecutive_env_runner_failures_tolerance": 100, "env_runner_health_probe_timeout_s": 30.0, "env_runner_restore_timeout_s": 1800.0, "_model_config": {}, "_rl_module_spec": "RLModuleSpec(module_class=None, observation_space=None, action_space=None, inference_only=False, learner_only=False, model_config=DefaultModelConfig(fcnet_hiddens=[60, 90], fcnet_activation='tanh', fcnet_kernel_initializer=None, fcnet_kernel_initializer_kwargs=None, fcnet_bias_initializer=None, fcnet_bias_initializer_kwargs=None, conv_filters=None, conv_activation='relu', conv_kernel_initializer=None, conv_kernel_initializer_kwargs=None, conv_bias_initializer=None, conv_bias_initializer_kwargs=None, head_fcnet_hiddens=[], head_fcnet_activation='relu', head_fcnet_kernel_initializer=None, head_fcnet_kernel_initializer_kwargs=None, head_fcnet_bias_initializer=None, head_fcnet_bias_initializer_kwargs=None, free_log_std=False, log_std_clip_param=20.0, vf_share_layers=True, use_lstm=False, max_seq_len=20, lstm_cell_size=256, lstm_use_prev_action=False, lstm_use_prev_reward=False, lstm_kernel_initializer=None, lstm_kernel_initializer_kwargs=None, lstm_bias_initializer=None, lstm_bias_initializer_kwargs=None), catalog_class=None, load_state_path=None, model_config_dict=None)", "algorithm_config_overrides_per_module": {}, "_per_module_overrides": {}, "_validate_config": true, "_use_msgpack_checkpoints": false, "_torch_grad_scaler_class": null, "_torch_lr_scheduler_classes": null, "_tf_policy_handles_more_than_one_loss": false, "_disable_preprocessor_api": false, "_disable_action_flattening": false, "_disable_initialize_loss_from_dummy_batch": false, "_dont_auto_sync_env_runner_states": false, "env_task_fn": -1, "enable_connectors": -1, "simple_optimizer": false, "policy_map_cache": -1, "worker_cls": -1, "synchronize_filters": -1, "enable_async_evaluation": -1, "custom_async_evaluation_function": -1, "_enable_rl_module_api": -1, "auto_wrap_old_gym_envs": -1, "always_attach_evaluation_results": -1, "replay_sequence_length": null, "_disable_execution_plan_api": -1, "use_critic": true, "use_gae": true, "use_kl_loss": true, "kl_coeff": 0.7464963036515, "kl_target": 0.0270990929592, "vf_loss_coeff": 0.6688075857018, "entropy_coeff": 0.0090570820258, "clip_param": 0.1221781641624, "vf_clip_param": 0.1027808522125, "entropy_coeff_schedule": null, "lr_schedule": null, "sgd_minibatch_size": -1, "vf_share_layers": -1, "__stdout_file__": null, "__stderr_file__": null, "lambda": 0.9099046732075, "input": "sampler", "policies": {"default_policy": [null, null, null, null]}, "callbacks": "<class 'ray.rllib.callbacks.callbacks.RLlibCallback'>", "create_env_on_driver": false, "custom_eval_function": null, "framework": "torch"}, "time_since_restore": 107.90532660484314, "iterations_since_restore": 16, "perf": {"cpu_util_percent": 92.15714285714286, "ram_util_percent": 80.3142857142857}}
{"timers": {"training_iteration": 15.6202479014918, "restore_env_runners": 0.00010516326314462482, "training_step": 15.619713640876999, "env_runner_sampling_timer": 14.986952836537789, "learner_update_timer": 0.6223706375645045, "synch_weights": 0.0017294655951223046, "restore_eval_env_runners": 3.338542602076516e-05, "evaluation_iteration": 1.024179780809981, "synch_eval_env_connectors": 0.0004947899464696531, "synch_env_connectors": 8.88218782811714e-06}, "env_runners": {"episode_return_min": -10.5, "num_agent_steps_sampled_lifetime": {"default_agent": -9252500.0}, "module_to_env_connector": {"timers": {"connectors": {"remove_single_ts_time_rank_from_batch": 1.9667456231951015e-06, "normalize_and_clip_actions": 3.422881298278254e-05, "listify_data_for_vector_env": 4.073882438173709e-05, "get_actions": 0.00018889517697569513, "tensor_to_numpy": 5.584670445380775e-05, "un_batch_to_individual_items": 1.905866968598491e-05}}, "connector_pipeline_timer": 0.00043453783489927757}, "episode_len_mean": 20.0, "num_module_steps_sampled": {"default_policy": 5000.0}, "env_to_module_connector": {"timers": {"connectors": {"add_states_from_episodes_to_batch": 5.0471491462086205e-06, "add_time_dim_to_batch_and_zero_pad": 8.153655068611271e-06, "numpy_to_tensor": 3.9977454060179016e-05, "add_observations_from_episodes_to_batch": 1.3087954537490416e-05, "batch_individual_items": 2.4033771662720195e-05}}, "connector_pipeline_timer": 0.00015412147587013503}, "sample": 0.018722423160956635, "env_to_module_sum_episodes_length_out": 10.36823839457432, "weights_seq_no": 16.0, "num_env_steps_sampled_lifetime": -9252500.0, "episode_return_max": 9.5, "episode_return_mean": 7.18, "module_episode_returns_mean": {"default_policy": 7.18}, "time_between_sampling": 0.00468615419063499, "rlmodule_inference_timer": 0.000170424872630183, "env_step_timer": 6.556597163650286e-05, "env_reset_timer": 0.00014393518594116008, "agent_episode_returns_mean": {"default_agent": 7.18}, "num_env_steps_sampled": 5000.0, "episode_duration_sec_mean": 0.019398825674783435, "env_to_module_sum_episodes_length_in": 10.36823839457432, "episode_len_min": 20, "num_agent_steps_sampled": {"default_agent": 5000.0}, "num_episodes": 250.0, "num_module_steps_sampled_lifetime": {"default_policy": -9252500.0}, "episode_len_max": 20, "num_episodes_lifetime": -462625.0, "num_env_steps_sampled_lifetime_throughput": 1364.3564284875167}, "learners": {"__all_modules__": {"learner_connector": {"timers": {"connectors": {"general_advantage_estimation": 0.05958073353014369, "numpy_to_tensor": 0.0005910176144893706, "add_observations_from_episodes_to_batch": 0.004206354598680657, "add_one_ts_to_episodes_and_truncate": 0.030925562455866303, "batch_individual_items": 0.11002097400540023, "add_states_from_episodes_to_batch": 5.3129753960881625e-06, "add_columns_from_episodes_to_train_batch": 0.17685500330752696, "add_time_dim_to_batch_and_zero_pad": 1.862925027043008e-05}}, "connector_pipeline_timer": 0.3826997592268113}, "num_module_steps_trained_lifetime": 102000, "num_non_trainable_parameters": 0, "learner_connector_sum_episodes_length_out": 5250.0, "num_module_steps_trained": 6000, "num_trainable_parameters": 6003, "num_env_steps_trained": 31500, "num_env_steps_trained_lifetime": 535500, "learner_connector_sum_episodes_length_in": 5000.0, "num_env_steps_trained_lifetime_throughput": 505620.0840751008, "num_module_steps_trained_throughput": 96562.208384942, "num_module_steps_trained_lifetime_throughput": 96357.68418444695}, "default_policy": {"curr_kl_coeff": 5.695314939657692e-06, "entropy": 0.4579978883266449, "vf_loss": 0.10278083384037018, "default_optimizer_learning_rate": 0.0002847858517, "vf_explained_var": -0.01027071475982666, "total_loss": 0.14732712507247925, "num_trainable_parameters": 6003, "vf_loss_unclipped": 28.64337730407715, "curr_entropy_coeff": 0.0090570820258, "policy_loss": 0.08273464441299438, "diff_num_grad_updates_vs_sampler_policy": 1.0, "mean_kl_loss": 0.0014901324175298214, "gradients_default_optimizer_global_norm": 0.09873435646295547, "num_module_steps_trained_lifetime": 102000, "weights_seq_no": 17.0, "num_module_steps_trained": 6000, "module_train_batch_size_mean": 1000.0, "num_module_steps_trained_lifetime_throughput": 96450.3871427614}}, "num_training_step_calls_per_iteration": 1, "evaluation": {"env_runners": {"env_to_module_connector": {"timers": {"connectors": {"add_states_from_episodes_to_batch": 6.181528205250509e-06, "numpy_to_tensor": 6.401113827090344e-05, "add_time_dim_to_batch_and_zero_pad": 2.5260352480007877e-05, "add_observations_from_episodes_to_batch": 1.8486465032155496e-05, "batch_individual_items": 4.220697562287276e-05}}, "connector_pipeline_timer": 0.0002757471841787897}, "agent_episode_returns_mean": {"default_agent": 1.05}, "num_agent_steps_sampled": {"default_agent": 400}, "num_env_steps_sampled_lifetime": 85400, "num_env_steps_sampled": 400, "num_episodes": 20, "episode_len_max": 20, "episode_return_min": -14.5, "episode_len_mean": 20.0, "env_to_module_sum_episodes_length_out": 10.368238394574323, "num_module_steps_sampled_lifetime": {"default_policy": 6800}, "num_agent_steps_sampled_lifetime": {"default_agent": 6800}, "module_to_env_connector": {"timers": {"connectors": {"get_actions": 0.00041144278659436206, "normalize_and_clip_actions": 6.297653624030081e-05, "tensor_to_numpy": 7.948965112492165e-05, "remove_single_ts_time_rank_from_batch": 2.5660502203597333e-06, "listify_data_for_vector_env": 0.00019649203889971194, "un_batch_to_individual_items": 3.075005581453638e-05}}, "connector_pipeline_timer": 0.0009323140018749434}, "episode_return_mean": 1.05, "env_reset_timer": 0.0041053909850893066, "module_episode_returns_mean": {"default_policy": 1.05}, "num_episodes_lifetime": 340, "sample": 0.9744117942384956, "num_module_steps_sampled": {"default_policy": 400}, "env_step_timer": 0.0001246656947607384, "episode_duration_sec_mean": 0.018992361676646398, "env_to_module_sum_episodes_length_in": 10.368238394574323, "episode_len_min": 20, "weights_seq_no": 17.0, "episode_return_max": 13.5, "rlmodule_inference_timer": 0.0003079265415735786, "time_between_sampling": 10.956282981936331}, "num_healthy_workers": 1, "actor_manager_num_outstanding_async_reqs": 0, "num_remote_worker_restarts": 0}, "num_env_steps_sampled_lifetime": -9252500.0, "fault_tolerance": {"num_healthy_workers": 0, "num_remote_worker_restarts": 0}, "env_runner_group": {"actor_manager_num_outstanding_async_reqs": 0}, "done": false, "training_iteration": 17, "trial_id": "4d8e6_00000", "date": "2025-08-11_19-29-56", "timestamp": 1754933396, "time_this_iter_s": 6.75394082069397, "time_total_s": 114.65926742553711, "pid": 19818, "hostname": "Mac", "node_ip": "127.0.0.1", "config": {"exploration_config": {}, "extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "placement_strategy": "PACK", "num_gpus": 0, "_fake_gpus": false, "num_cpus_for_main_process": 2, "eager_tracing": true, "eager_max_retraces": 20, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "torch_compile_learner": false, "torch_compile_learner_what_to_compile": "forward_train", "torch_compile_learner_dynamo_backend": "aot_eager", "torch_compile_learner_dynamo_mode": null, "torch_compile_worker": false, "torch_compile_worker_dynamo_backend": "aot_eager", "torch_compile_worker_dynamo_mode": null, "torch_ddp_kwargs": {}, "torch_skip_nan_gradients": false, "env": "Umbrella", "env_config": {}, "observation_space": null, "action_space": null, "clip_rewards": null, "normalize_actions": true, "clip_actions": false, "_is_atari": null, "disable_env_checking": false, "render_env": false, "action_mask_key": "action_mask", "env_runner_cls": null, "num_env_runners": 0, "create_local_env_runner": true, "num_envs_per_env_runner": 1, "gym_env_vectorize_mode": "SYNC", "num_cpus_per_env_runner": 1, "num_gpus_per_env_runner": 0, "custom_resources_per_env_runner": {}, "validate_env_runners_after_construction": true, "episodes_to_numpy": true, "max_requests_in_flight_per_env_runner": 1, "sample_timeout_s": 60.0, "_env_to_module_connector": null, "add_default_connectors_to_env_to_module_pipeline": true, "_module_to_env_connector": null, "add_default_connectors_to_module_to_env_pipeline": true, "merge_env_runner_states": "training_only", "broadcast_env_runner_states": true, "episode_lookback_horizon": 1, "rollout_fragment_length": "auto", "batch_mode": "complete_episodes", "compress_observations": false, "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "enable_tf1_exec_eagerly": false, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "preprocessor_pref": "deepmind", "observation_filter": "NoFilter", "update_worker_filter_stats": true, "use_worker_filter_stats": true, "sampler_perf_stats_ema_coef": null, "_is_online": true, "num_learners": 0, "num_gpus_per_learner": 0, "num_cpus_per_learner": "auto", "num_aggregator_actors_per_learner": 0, "max_requests_in_flight_per_aggregator_actor": 3, "local_gpu_idx": 0, "max_requests_in_flight_per_learner": 3, "gamma": 1, "lr": 0.0002847858517, "grad_clip": 0.5, "grad_clip_by": "global_norm", "_train_batch_size_per_learner": 5000, "train_batch_size": 4000, "num_epochs": 1, "minibatch_size": 1000, "shuffle_batch_per_epoch": true, "model": {"fcnet_hiddens": [256, 256], "fcnet_activation": "tanh", "fcnet_weights_initializer": null, "fcnet_weights_initializer_config": null, "fcnet_bias_initializer": null, "fcnet_bias_initializer_config": null, "conv_filters": null, "conv_activation": "relu", "conv_kernel_initializer": null, "conv_kernel_initializer_config": null, "conv_bias_initializer": null, "conv_bias_initializer_config": null, "conv_transpose_kernel_initializer": null, "conv_transpose_kernel_initializer_config": null, "conv_transpose_bias_initializer": null, "conv_transpose_bias_initializer_config": null, "post_fcnet_hiddens": [], "post_fcnet_activation": "relu", "post_fcnet_weights_initializer": null, "post_fcnet_weights_initializer_config": null, "post_fcnet_bias_initializer": null, "post_fcnet_bias_initializer_config": null, "free_log_std": false, "log_std_clip_param": 20.0, "no_final_linear": false, "vf_share_layers": false, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "lstm_weights_initializer": null, "lstm_weights_initializer_config": null, "lstm_bias_initializer": null, "lstm_bias_initializer_config": null, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "attention_use_n_prev_actions": 0, "attention_use_n_prev_rewards": 0, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": null, "custom_model_config": {}, "custom_action_dist": null, "custom_preprocessor": null, "encoder_latent_dim": null, "always_check_shapes": false, "lstm_use_prev_action_reward": -1, "_use_default_native_models": -1, "_disable_preprocessor_api": false, "_disable_action_flattening": false}, "_learner_connector": null, "add_default_connectors_to_learner_pipeline": true, "learner_config_dict": {}, "optimizer": {}, "_learner_class": null, "callbacks_on_algorithm_init": null, "callbacks_on_env_runners_recreated": null, "callbacks_on_offline_eval_runners_recreated": null, "callbacks_on_checkpoint_loaded": null, "callbacks_on_environment_created": null, "callbacks_on_episode_created": null, "callbacks_on_episode_start": null, "callbacks_on_episode_step": null, "callbacks_on_episode_end": null, "callbacks_on_evaluate_start": null, "callbacks_on_evaluate_end": null, "callbacks_on_evaluate_offline_start": null, "callbacks_on_evaluate_offline_end": null, "callbacks_on_sample_end": null, "callbacks_on_train_result": null, "explore": true, "enable_rl_module_and_learner": true, "enable_env_runner_and_connector_v2": true, "_prior_exploration_config": {"type": "StochasticSampling"}, "count_steps_by": "env_steps", "policy_map_capacity": 100, "policy_mapping_fn": "<function AlgorithmConfig.DEFAULT_POLICY_MAPPING_FN at 0x161a518a0>", "policies_to_train": null, "policy_states_are_swappable": false, "observation_fn": null, "offline_data_class": null, "input_read_method": "read_parquet", "input_read_method_kwargs": {}, "input_read_schema": {}, "input_read_episodes": false, "input_read_sample_batches": false, "input_read_batch_size": null, "input_filesystem": null, "input_filesystem_kwargs": {}, "input_compress_columns": ["obs", "new_obs"], "input_spaces_jsonable": true, "materialize_data": false, "materialize_mapped_data": true, "map_batches_kwargs": {}, "iter_batches_kwargs": {}, "ignore_final_observation": false, "prelearner_class": null, "prelearner_buffer_class": null, "prelearner_buffer_kwargs": {}, "prelearner_module_synch_period": 10, "dataset_num_iters_per_learner": null, "input_config": {}, "actions_in_input_normalized": false, "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_config": {}, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "output_max_rows_per_file": null, "output_write_remaining_data": false, "output_write_method": "write_parquet", "output_write_method_kwargs": {}, "output_filesystem": null, "output_filesystem_kwargs": {}, "output_write_episodes": true, "offline_sampling": false, "evaluation_interval": 1, "evaluation_duration": 20, "evaluation_duration_unit": "episodes", "evaluation_sample_timeout_s": 120.0, "evaluation_auto_duration_min_env_steps_per_sample": 100, "evaluation_auto_duration_max_env_steps_per_sample": 2000, "evaluation_parallel_to_training": false, "evaluation_force_reset_envs_before_iteration": true, "evaluation_config": null, "off_policy_estimation_methods": {}, "ope_split_batch_by_episode": true, "evaluation_num_env_runners": 1, "in_evaluation": false, "sync_filters_on_rollout_workers_timeout_s": 10.0, "offline_evaluation_interval": null, "num_offline_eval_runners": 0, "offline_loss_for_module_fn": null, "offline_evaluation_duration": 1, "offline_evaluation_parallel_to_training": false, "offline_evaluation_timeout_s": 120.0, "num_cpus_per_offline_eval_runner": 1, "num_gpus_per_offline_eval_runner": 0, "custom_resources_per_offline_eval_runner": {}, "restart_failed_offline_eval_runners": true, "ignore_offline_eval_runner_failures": false, "max_num_offline_eval_runner_restarts": 1000, "offline_eval_runner_restore_timeout_s": 1800.0, "max_requests_in_flight_per_offline_eval_runner": 1, "validate_offline_eval_runners_after_construction": true, "offline_eval_runner_health_probe_timeout_s": 30.0, "offline_eval_rl_module_inference_only": false, "broadcast_offline_eval_runner_states": false, "offline_eval_batch_size_per_runner": 256, "dataset_num_iters_per_eval_runner": 1, "keep_per_episode_custom_metrics": false, "metrics_episode_collection_timeout_s": 60.0, "metrics_num_episodes_for_smoothing": 100, "min_time_s_per_iteration": null, "min_train_timesteps_per_iteration": 0, "min_sample_timesteps_per_iteration": 0, "log_gradients": true, "export_native_model_files": false, "checkpoint_trainable_policies_only": false, "logger_creator": null, "logger_config": null, "log_level": "WARN", "log_sys_usage": true, "fake_sampler": false, "seed": 10, "restart_failed_env_runners": true, "ignore_env_runner_failures": false, "max_num_env_runner_restarts": 1000, "delay_between_env_runner_restarts_s": 60.0, "restart_failed_sub_environments": false, "num_consecutive_env_runner_failures_tolerance": 100, "env_runner_health_probe_timeout_s": 30.0, "env_runner_restore_timeout_s": 1800.0, "_model_config": {}, "_rl_module_spec": "RLModuleSpec(module_class=None, observation_space=None, action_space=None, inference_only=False, learner_only=False, model_config=DefaultModelConfig(fcnet_hiddens=[60, 90], fcnet_activation='tanh', fcnet_kernel_initializer=None, fcnet_kernel_initializer_kwargs=None, fcnet_bias_initializer=None, fcnet_bias_initializer_kwargs=None, conv_filters=None, conv_activation='relu', conv_kernel_initializer=None, conv_kernel_initializer_kwargs=None, conv_bias_initializer=None, conv_bias_initializer_kwargs=None, head_fcnet_hiddens=[], head_fcnet_activation='relu', head_fcnet_kernel_initializer=None, head_fcnet_kernel_initializer_kwargs=None, head_fcnet_bias_initializer=None, head_fcnet_bias_initializer_kwargs=None, free_log_std=False, log_std_clip_param=20.0, vf_share_layers=True, use_lstm=False, max_seq_len=20, lstm_cell_size=256, lstm_use_prev_action=False, lstm_use_prev_reward=False, lstm_kernel_initializer=None, lstm_kernel_initializer_kwargs=None, lstm_bias_initializer=None, lstm_bias_initializer_kwargs=None), catalog_class=None, load_state_path=None, model_config_dict=None)", "algorithm_config_overrides_per_module": {}, "_per_module_overrides": {}, "_validate_config": true, "_use_msgpack_checkpoints": false, "_torch_grad_scaler_class": null, "_torch_lr_scheduler_classes": null, "_tf_policy_handles_more_than_one_loss": false, "_disable_preprocessor_api": false, "_disable_action_flattening": false, "_disable_initialize_loss_from_dummy_batch": false, "_dont_auto_sync_env_runner_states": false, "env_task_fn": -1, "enable_connectors": -1, "simple_optimizer": false, "policy_map_cache": -1, "worker_cls": -1, "synchronize_filters": -1, "enable_async_evaluation": -1, "custom_async_evaluation_function": -1, "_enable_rl_module_api": -1, "auto_wrap_old_gym_envs": -1, "always_attach_evaluation_results": -1, "replay_sequence_length": null, "_disable_execution_plan_api": -1, "use_critic": true, "use_gae": true, "use_kl_loss": true, "kl_coeff": 0.7464963036515, "kl_target": 0.0270990929592, "vf_loss_coeff": 0.6688075857018, "entropy_coeff": 0.0090570820258, "clip_param": 0.1221781641624, "vf_clip_param": 0.1027808522125, "entropy_coeff_schedule": null, "lr_schedule": null, "sgd_minibatch_size": -1, "vf_share_layers": -1, "__stdout_file__": null, "__stderr_file__": null, "lambda": 0.9099046732075, "input": "sampler", "policies": {"default_policy": [null, null, null, null]}, "callbacks": "<class 'ray.rllib.callbacks.callbacks.RLlibCallback'>", "create_env_on_driver": false, "custom_eval_function": null, "framework": "torch"}, "time_since_restore": 114.65926742553711, "iterations_since_restore": 17, "perf": {"cpu_util_percent": 94.22999999999999, "ram_util_percent": 81.71}}
{"timers": {"training_iteration": 15.513192619566505, "restore_env_runners": 0.00010419079060371444, "training_step": 15.51265755738767, "env_runner_sampling_timer": 14.881170673592246, "learner_update_timer": 0.6211437353589371, "synch_weights": 0.001720687600062555, "restore_eval_env_runners": 3.3140322145305485e-05, "evaluation_iteration": 1.0230409146717945, "synch_eval_env_connectors": 0.0004999245463618969, "synch_env_connectors": 8.83711599193175e-06}, "env_runners": {"episode_return_min": -10.5, "num_agent_steps_sampled_lifetime": {"default_agent": -9870000.0}, "module_to_env_connector": {"timers": {"connectors": {"remove_single_ts_time_rank_from_batch": 2.5146805951417737e-06, "normalize_and_clip_actions": 2.718659153760404e-05, "listify_data_for_vector_env": 3.513612771646878e-05, "get_actions": 0.00014716997992960298, "tensor_to_numpy": 4.124361528409673e-05, "un_batch_to_individual_items": 1.4244986113688247e-05}}, "connector_pipeline_timer": 0.0003349508109057994}, "episode_len_mean": 20.0, "num_module_steps_sampled": {"default_policy": 5000.0}, "env_to_module_connector": {"timers": {"connectors": {"add_states_from_episodes_to_batch": 3.973814079311274e-06, "add_time_dim_to_batch_and_zero_pad": 9.678259522161493e-06, "numpy_to_tensor": 3.102651843494223e-05, "add_observations_from_episodes_to_batch": 9.127531870364268e-06, "batch_individual_items": 1.9887366910277627e-05}}, "connector_pipeline_timer": 0.0001310133933345028}, "sample": 0.01714449768479446, "env_to_module_sum_episodes_length_out": 10.36823839457432, "weights_seq_no": 17.0, "num_env_steps_sampled_lifetime": -9870000.0, "episode_return_max": 9.5, "episode_return_mean": 6.700000000000004, "module_episode_returns_mean": {"default_policy": 6.700000000000004}, "time_between_sampling": 0.006958871989611411, "rlmodule_inference_timer": 9.748044607062626e-05, "env_step_timer": 4.7186420810040756e-05, "env_reset_timer": 0.00014105417045153358, "agent_episode_returns_mean": {"default_agent": 6.700000000000004}, "num_env_steps_sampled": 5000.0, "episode_duration_sec_mean": 0.01451918386109173, "env_to_module_sum_episodes_length_in": 10.36823839457432, "episode_len_min": 20, "num_agent_steps_sampled": {"default_agent": 5000.0}, "num_episodes": 250.0, "num_module_steps_sampled_lifetime": {"default_policy": -9870000.0}, "episode_len_max": 20, "num_episodes_lifetime": -493500.0, "num_env_steps_sampled_lifetime_throughput": 1591.4512334805008}, "learners": {"__all_modules__": {"learner_connector": {"timers": {"connectors": {"general_advantage_estimation": 0.05907938744379701, "numpy_to_tensor": 0.0005860790988281054, "add_observations_from_episodes_to_batch": 0.004172521882538102, "add_one_ts_to_episodes_and_truncate": 0.030696076831027798, "batch_individual_items": 0.11245406468514993, "add_states_from_episodes_to_batch": 5.29609620919097e-06, "add_columns_from_episodes_to_train_batch": 0.17562797619528187, "add_time_dim_to_batch_and_zero_pad": 1.8628367794186666e-05}}, "connector_pipeline_timer": 0.3831326724648398}, "num_module_steps_trained_lifetime": 108000, "num_non_trainable_parameters": 0, "learner_connector_sum_episodes_length_out": 5250.0, "num_module_steps_trained": 6000, "num_trainable_parameters": 6003, "num_env_steps_trained": 31500, "num_env_steps_trained_lifetime": 567000, "learner_connector_sum_episodes_length_in": 5000.0, "num_env_steps_trained_lifetime_throughput": 514588.5348424073, "num_module_steps_trained_throughput": 98264.47727091877, "num_module_steps_trained_lifetime_throughput": 98063.07600870814}, "default_policy": {"curr_kl_coeff": 2.847657469828846e-06, "entropy": 0.43784546852111816, "vf_loss": 0.10278083384037018, "default_optimizer_learning_rate": 0.0002847858517, "vf_explained_var": -0.008368968963623047, "total_loss": -0.04717446491122246, "num_trainable_parameters": 6003, "vf_loss_unclipped": 28.636436462402344, "curr_entropy_coeff": 0.0090570820258, "policy_loss": -0.11194947361946106, "diff_num_grad_updates_vs_sampler_policy": 1.0, "mean_kl_loss": 0.00018082500901073217, "gradients_default_optimizer_global_norm": 0.05914563685655594, "num_module_steps_trained_lifetime": 108000, "weights_seq_no": 18.0, "num_module_steps_trained": 6000, "module_train_batch_size_mean": 1000.0, "num_module_steps_trained_lifetime_throughput": 98155.32796318263}}, "num_training_step_calls_per_iteration": 1, "evaluation": {"env_runners": {"env_to_module_connector": {"timers": {"connectors": {"add_states_from_episodes_to_batch": 4.112174136546269e-06, "numpy_to_tensor": 4.17128028138989e-05, "add_time_dim_to_batch_and_zero_pad": 7.800610039945354e-06, "add_observations_from_episodes_to_batch": 7.918580048604137e-06, "batch_individual_items": 1.8437947726402696e-05}}, "connector_pipeline_timer": 0.00013779257973437885}, "agent_episode_returns_mean": {"default_agent": 0.85}, "num_agent_steps_sampled": {"default_agent": 400}, "num_env_steps_sampled_lifetime": 90400, "num_env_steps_sampled": 400, "num_episodes": 20, "episode_len_max": 20, "episode_return_min": -14.5, "episode_len_mean": 20.0, "env_to_module_sum_episodes_length_out": 10.368238394574323, "num_module_steps_sampled_lifetime": {"default_policy": 7200}, "num_agent_steps_sampled_lifetime": {"default_agent": 7200}, "module_to_env_connector": {"timers": {"connectors": {"get_actions": 0.00016953852172690772, "normalize_and_clip_actions": 2.720871664073252e-05, "tensor_to_numpy": 4.444561431305527e-05, "remove_single_ts_time_rank_from_batch": 1.5157278629544784e-06, "listify_data_for_vector_env": 3.83689182542506e-05, "un_batch_to_individual_items": 1.4631239740641787e-05}}, "connector_pipeline_timer": 0.0003739379705701178}, "episode_return_mean": 0.85, "env_reset_timer": 0.004066145405655092, "module_episode_returns_mean": {"default_policy": 0.85}, "num_episodes_lifetime": 360, "sample": 0.9677260862954682, "num_module_steps_sampled": {"default_policy": 400}, "env_step_timer": 5.751196868894057e-05, "episode_duration_sec_mean": 0.01875002167536877, "env_to_module_sum_episodes_length_in": 10.368238394574323, "episode_len_min": 20, "weights_seq_no": 18.0, "episode_return_max": 13.5, "rlmodule_inference_timer": 0.00010528379752890559, "time_between_sampling": 10.896819481276097}, "num_healthy_workers": 1, "actor_manager_num_outstanding_async_reqs": 0, "num_remote_worker_restarts": 0}, "num_env_steps_sampled_lifetime": -9870000.0, "fault_tolerance": {"num_healthy_workers": 0, "num_remote_worker_restarts": 0}, "env_runner_group": {"actor_manager_num_outstanding_async_reqs": 0}, "done": false, "training_iteration": 18, "trial_id": "4d8e6_00000", "date": "2025-08-11_19-30-02", "timestamp": 1754933402, "time_this_iter_s": 5.241186857223511, "time_total_s": 119.90045428276062, "pid": 19818, "hostname": "Mac", "node_ip": "127.0.0.1", "config": {"exploration_config": {}, "extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "placement_strategy": "PACK", "num_gpus": 0, "_fake_gpus": false, "num_cpus_for_main_process": 2, "eager_tracing": true, "eager_max_retraces": 20, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "torch_compile_learner": false, "torch_compile_learner_what_to_compile": "forward_train", "torch_compile_learner_dynamo_backend": "aot_eager", "torch_compile_learner_dynamo_mode": null, "torch_compile_worker": false, "torch_compile_worker_dynamo_backend": "aot_eager", "torch_compile_worker_dynamo_mode": null, "torch_ddp_kwargs": {}, "torch_skip_nan_gradients": false, "env": "Umbrella", "env_config": {}, "observation_space": null, "action_space": null, "clip_rewards": null, "normalize_actions": true, "clip_actions": false, "_is_atari": null, "disable_env_checking": false, "render_env": false, "action_mask_key": "action_mask", "env_runner_cls": null, "num_env_runners": 0, "create_local_env_runner": true, "num_envs_per_env_runner": 1, "gym_env_vectorize_mode": "SYNC", "num_cpus_per_env_runner": 1, "num_gpus_per_env_runner": 0, "custom_resources_per_env_runner": {}, "validate_env_runners_after_construction": true, "episodes_to_numpy": true, "max_requests_in_flight_per_env_runner": 1, "sample_timeout_s": 60.0, "_env_to_module_connector": null, "add_default_connectors_to_env_to_module_pipeline": true, "_module_to_env_connector": null, "add_default_connectors_to_module_to_env_pipeline": true, "merge_env_runner_states": "training_only", "broadcast_env_runner_states": true, "episode_lookback_horizon": 1, "rollout_fragment_length": "auto", "batch_mode": "complete_episodes", "compress_observations": false, "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "enable_tf1_exec_eagerly": false, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "preprocessor_pref": "deepmind", "observation_filter": "NoFilter", "update_worker_filter_stats": true, "use_worker_filter_stats": true, "sampler_perf_stats_ema_coef": null, "_is_online": true, "num_learners": 0, "num_gpus_per_learner": 0, "num_cpus_per_learner": "auto", "num_aggregator_actors_per_learner": 0, "max_requests_in_flight_per_aggregator_actor": 3, "local_gpu_idx": 0, "max_requests_in_flight_per_learner": 3, "gamma": 1, "lr": 0.0002847858517, "grad_clip": 0.5, "grad_clip_by": "global_norm", "_train_batch_size_per_learner": 5000, "train_batch_size": 4000, "num_epochs": 1, "minibatch_size": 1000, "shuffle_batch_per_epoch": true, "model": {"fcnet_hiddens": [256, 256], "fcnet_activation": "tanh", "fcnet_weights_initializer": null, "fcnet_weights_initializer_config": null, "fcnet_bias_initializer": null, "fcnet_bias_initializer_config": null, "conv_filters": null, "conv_activation": "relu", "conv_kernel_initializer": null, "conv_kernel_initializer_config": null, "conv_bias_initializer": null, "conv_bias_initializer_config": null, "conv_transpose_kernel_initializer": null, "conv_transpose_kernel_initializer_config": null, "conv_transpose_bias_initializer": null, "conv_transpose_bias_initializer_config": null, "post_fcnet_hiddens": [], "post_fcnet_activation": "relu", "post_fcnet_weights_initializer": null, "post_fcnet_weights_initializer_config": null, "post_fcnet_bias_initializer": null, "post_fcnet_bias_initializer_config": null, "free_log_std": false, "log_std_clip_param": 20.0, "no_final_linear": false, "vf_share_layers": false, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "lstm_weights_initializer": null, "lstm_weights_initializer_config": null, "lstm_bias_initializer": null, "lstm_bias_initializer_config": null, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "attention_use_n_prev_actions": 0, "attention_use_n_prev_rewards": 0, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": null, "custom_model_config": {}, "custom_action_dist": null, "custom_preprocessor": null, "encoder_latent_dim": null, "always_check_shapes": false, "lstm_use_prev_action_reward": -1, "_use_default_native_models": -1, "_disable_preprocessor_api": false, "_disable_action_flattening": false}, "_learner_connector": null, "add_default_connectors_to_learner_pipeline": true, "learner_config_dict": {}, "optimizer": {}, "_learner_class": null, "callbacks_on_algorithm_init": null, "callbacks_on_env_runners_recreated": null, "callbacks_on_offline_eval_runners_recreated": null, "callbacks_on_checkpoint_loaded": null, "callbacks_on_environment_created": null, "callbacks_on_episode_created": null, "callbacks_on_episode_start": null, "callbacks_on_episode_step": null, "callbacks_on_episode_end": null, "callbacks_on_evaluate_start": null, "callbacks_on_evaluate_end": null, "callbacks_on_evaluate_offline_start": null, "callbacks_on_evaluate_offline_end": null, "callbacks_on_sample_end": null, "callbacks_on_train_result": null, "explore": true, "enable_rl_module_and_learner": true, "enable_env_runner_and_connector_v2": true, "_prior_exploration_config": {"type": "StochasticSampling"}, "count_steps_by": "env_steps", "policy_map_capacity": 100, "policy_mapping_fn": "<function AlgorithmConfig.DEFAULT_POLICY_MAPPING_FN at 0x161a518a0>", "policies_to_train": null, "policy_states_are_swappable": false, "observation_fn": null, "offline_data_class": null, "input_read_method": "read_parquet", "input_read_method_kwargs": {}, "input_read_schema": {}, "input_read_episodes": false, "input_read_sample_batches": false, "input_read_batch_size": null, "input_filesystem": null, "input_filesystem_kwargs": {}, "input_compress_columns": ["obs", "new_obs"], "input_spaces_jsonable": true, "materialize_data": false, "materialize_mapped_data": true, "map_batches_kwargs": {}, "iter_batches_kwargs": {}, "ignore_final_observation": false, "prelearner_class": null, "prelearner_buffer_class": null, "prelearner_buffer_kwargs": {}, "prelearner_module_synch_period": 10, "dataset_num_iters_per_learner": null, "input_config": {}, "actions_in_input_normalized": false, "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_config": {}, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "output_max_rows_per_file": null, "output_write_remaining_data": false, "output_write_method": "write_parquet", "output_write_method_kwargs": {}, "output_filesystem": null, "output_filesystem_kwargs": {}, "output_write_episodes": true, "offline_sampling": false, "evaluation_interval": 1, "evaluation_duration": 20, "evaluation_duration_unit": "episodes", "evaluation_sample_timeout_s": 120.0, "evaluation_auto_duration_min_env_steps_per_sample": 100, "evaluation_auto_duration_max_env_steps_per_sample": 2000, "evaluation_parallel_to_training": false, "evaluation_force_reset_envs_before_iteration": true, "evaluation_config": null, "off_policy_estimation_methods": {}, "ope_split_batch_by_episode": true, "evaluation_num_env_runners": 1, "in_evaluation": false, "sync_filters_on_rollout_workers_timeout_s": 10.0, "offline_evaluation_interval": null, "num_offline_eval_runners": 0, "offline_loss_for_module_fn": null, "offline_evaluation_duration": 1, "offline_evaluation_parallel_to_training": false, "offline_evaluation_timeout_s": 120.0, "num_cpus_per_offline_eval_runner": 1, "num_gpus_per_offline_eval_runner": 0, "custom_resources_per_offline_eval_runner": {}, "restart_failed_offline_eval_runners": true, "ignore_offline_eval_runner_failures": false, "max_num_offline_eval_runner_restarts": 1000, "offline_eval_runner_restore_timeout_s": 1800.0, "max_requests_in_flight_per_offline_eval_runner": 1, "validate_offline_eval_runners_after_construction": true, "offline_eval_runner_health_probe_timeout_s": 30.0, "offline_eval_rl_module_inference_only": false, "broadcast_offline_eval_runner_states": false, "offline_eval_batch_size_per_runner": 256, "dataset_num_iters_per_eval_runner": 1, "keep_per_episode_custom_metrics": false, "metrics_episode_collection_timeout_s": 60.0, "metrics_num_episodes_for_smoothing": 100, "min_time_s_per_iteration": null, "min_train_timesteps_per_iteration": 0, "min_sample_timesteps_per_iteration": 0, "log_gradients": true, "export_native_model_files": false, "checkpoint_trainable_policies_only": false, "logger_creator": null, "logger_config": null, "log_level": "WARN", "log_sys_usage": true, "fake_sampler": false, "seed": 10, "restart_failed_env_runners": true, "ignore_env_runner_failures": false, "max_num_env_runner_restarts": 1000, "delay_between_env_runner_restarts_s": 60.0, "restart_failed_sub_environments": false, "num_consecutive_env_runner_failures_tolerance": 100, "env_runner_health_probe_timeout_s": 30.0, "env_runner_restore_timeout_s": 1800.0, "_model_config": {}, "_rl_module_spec": "RLModuleSpec(module_class=None, observation_space=None, action_space=None, inference_only=False, learner_only=False, model_config=DefaultModelConfig(fcnet_hiddens=[60, 90], fcnet_activation='tanh', fcnet_kernel_initializer=None, fcnet_kernel_initializer_kwargs=None, fcnet_bias_initializer=None, fcnet_bias_initializer_kwargs=None, conv_filters=None, conv_activation='relu', conv_kernel_initializer=None, conv_kernel_initializer_kwargs=None, conv_bias_initializer=None, conv_bias_initializer_kwargs=None, head_fcnet_hiddens=[], head_fcnet_activation='relu', head_fcnet_kernel_initializer=None, head_fcnet_kernel_initializer_kwargs=None, head_fcnet_bias_initializer=None, head_fcnet_bias_initializer_kwargs=None, free_log_std=False, log_std_clip_param=20.0, vf_share_layers=True, use_lstm=False, max_seq_len=20, lstm_cell_size=256, lstm_use_prev_action=False, lstm_use_prev_reward=False, lstm_kernel_initializer=None, lstm_kernel_initializer_kwargs=None, lstm_bias_initializer=None, lstm_bias_initializer_kwargs=None), catalog_class=None, load_state_path=None, model_config_dict=None)", "algorithm_config_overrides_per_module": {}, "_per_module_overrides": {}, "_validate_config": true, "_use_msgpack_checkpoints": false, "_torch_grad_scaler_class": null, "_torch_lr_scheduler_classes": null, "_tf_policy_handles_more_than_one_loss": false, "_disable_preprocessor_api": false, "_disable_action_flattening": false, "_disable_initialize_loss_from_dummy_batch": false, "_dont_auto_sync_env_runner_states": false, "env_task_fn": -1, "enable_connectors": -1, "simple_optimizer": false, "policy_map_cache": -1, "worker_cls": -1, "synchronize_filters": -1, "enable_async_evaluation": -1, "custom_async_evaluation_function": -1, "_enable_rl_module_api": -1, "auto_wrap_old_gym_envs": -1, "always_attach_evaluation_results": -1, "replay_sequence_length": null, "_disable_execution_plan_api": -1, "use_critic": true, "use_gae": true, "use_kl_loss": true, "kl_coeff": 0.7464963036515, "kl_target": 0.0270990929592, "vf_loss_coeff": 0.6688075857018, "entropy_coeff": 0.0090570820258, "clip_param": 0.1221781641624, "vf_clip_param": 0.1027808522125, "entropy_coeff_schedule": null, "lr_schedule": null, "sgd_minibatch_size": -1, "vf_share_layers": -1, "__stdout_file__": null, "__stderr_file__": null, "lambda": 0.9099046732075, "input": "sampler", "policies": {"default_policy": [null, null, null, null]}, "callbacks": "<class 'ray.rllib.callbacks.callbacks.RLlibCallback'>", "create_env_on_driver": false, "custom_eval_function": null, "framework": "torch"}, "time_since_restore": 119.90045428276062, "iterations_since_restore": 18, "perf": {"cpu_util_percent": 92.77142857142857, "ram_util_percent": 82.3142857142857}}
{"timers": {"training_iteration": 15.403671980450358, "restore_env_runners": 0.0001032168028888908, "training_step": 15.403139582234902, "env_runner_sampling_timer": 14.774176432276203, "learner_update_timer": 0.6186655309149284, "synch_weights": 0.0017181386435898922, "restore_eval_env_runners": 3.2903088441831454e-05, "evaluation_iteration": 1.0160224509449747, "synch_eval_env_connectors": 0.0004983336306924614, "synch_env_connectors": 9.036244110796231e-06}, "env_runners": {"episode_return_min": -10.5, "num_agent_steps_sampled_lifetime": {"default_agent": -10487500.0}, "module_to_env_connector": {"timers": {"connectors": {"remove_single_ts_time_rank_from_batch": 3.3425169629532806e-06, "normalize_and_clip_actions": 2.518585308575124e-05, "listify_data_for_vector_env": 3.1152292680412786e-05, "get_actions": 0.00013784042801645086, "tensor_to_numpy": 3.8542389502226436e-05, "un_batch_to_individual_items": 1.304634962703368e-05}}, "connector_pipeline_timer": 0.00031189211997246146}, "episode_len_mean": 20.0, "num_module_steps_sampled": {"default_policy": 5000.0}, "env_to_module_connector": {"timers": {"connectors": {"add_states_from_episodes_to_batch": 3.667096802326822e-06, "add_time_dim_to_batch_and_zero_pad": 7.803269030089442e-06, "numpy_to_tensor": 2.7720766092182095e-05, "add_observations_from_episodes_to_batch": 8.360644158780447e-06, "batch_individual_items": 1.9082264932304994e-05}}, "connector_pipeline_timer": 0.00011664884676113893}, "sample": 0.0147744566672939, "env_to_module_sum_episodes_length_out": 10.36823839457432, "weights_seq_no": 18.0, "num_env_steps_sampled_lifetime": -10487500.0, "episode_return_max": 9.5, "episode_return_mean": 7.659999999999997, "module_episode_returns_mean": {"default_policy": 7.659999999999997}, "time_between_sampling": 0.005159141181402338, "rlmodule_inference_timer": 9.757543892846992e-05, "env_step_timer": 4.858638025334444e-05, "env_reset_timer": 0.00012738387155087816, "agent_episode_returns_mean": {"default_agent": 7.659999999999997}, "num_env_steps_sampled": 5000.0, "episode_duration_sec_mean": 0.014103690495248884, "env_to_module_sum_episodes_length_in": 10.36823839457432, "episode_len_min": 20, "num_agent_steps_sampled": {"default_agent": 5000.0}, "num_episodes": 250.0, "num_module_steps_sampled_lifetime": {"default_policy": -10487500.0}, "episode_len_max": 20, "num_episodes_lifetime": -524375.0, "num_env_steps_sampled_lifetime_throughput": 1629.6820772380165}, "learners": {"__all_modules__": {"learner_connector": {"timers": {"connectors": {"general_advantage_estimation": 0.05858158273958437, "numpy_to_tensor": 0.0005824545576964752, "add_observations_from_episodes_to_batch": 0.004145985004043218, "add_one_ts_to_episodes_and_truncate": 0.030608166472222663, "batch_individual_items": 0.11379980986792074, "add_states_from_episodes_to_batch": 5.305635140928287e-06, "add_columns_from_episodes_to_train_batch": 0.17440394518342522, "add_time_dim_to_batch_and_zero_pad": 1.8652504810446984e-05}}, "connector_pipeline_timer": 0.3826356490696573}, "num_module_steps_trained_lifetime": 114000, "num_non_trainable_parameters": 0, "learner_connector_sum_episodes_length_out": 5250.0, "num_module_steps_trained": 6000, "num_trainable_parameters": 6003, "num_env_steps_trained": 31500, "num_env_steps_trained_lifetime": 598500, "learner_connector_sum_episodes_length_in": 5000.0, "num_env_steps_trained_lifetime_throughput": 524686.1320072975, "num_module_steps_trained_throughput": 100179.33267672978, "num_module_steps_trained_lifetime_throughput": 99982.73696993475}, "default_policy": {"curr_kl_coeff": 1.423828734914423e-06, "entropy": 0.44391682744026184, "vf_loss": 0.10278083384037018, "default_optimizer_learning_rate": 0.0002847858517, "vf_explained_var": -0.009635567665100098, "total_loss": 0.16122514009475708, "num_trainable_parameters": 6003, "vf_loss_unclipped": 28.636056900024414, "curr_entropy_coeff": 0.0090570820258, "policy_loss": 0.09650514274835587, "diff_num_grad_updates_vs_sampler_policy": 1.0, "mean_kl_loss": 1.3710978237213567e-05, "gradients_default_optimizer_global_norm": 0.0536673404276371, "num_module_steps_trained_lifetime": 114000, "weights_seq_no": 19.0, "num_module_steps_trained": 6000, "module_train_batch_size_mean": 1000.0, "num_module_steps_trained_lifetime_throughput": 100069.44752058944}}, "num_training_step_calls_per_iteration": 1, "evaluation": {"env_runners": {"env_to_module_connector": {"timers": {"connectors": {"add_states_from_episodes_to_batch": 5.2123502971552364e-06, "numpy_to_tensor": 4.275568009174179e-05, "add_time_dim_to_batch_and_zero_pad": 8.098531289241367e-06, "add_observations_from_episodes_to_batch": 7.683568169437472e-06, "batch_individual_items": 2.0255876402405327e-05}}, "connector_pipeline_timer": 0.00014745965038368667}, "agent_episode_returns_mean": {"default_agent": 0.65}, "num_agent_steps_sampled": {"default_agent": 400}, "num_env_steps_sampled_lifetime": 95400, "num_env_steps_sampled": 400, "num_episodes": 20, "episode_len_max": 20, "episode_return_min": -14.5, "episode_len_mean": 20.0, "env_to_module_sum_episodes_length_out": 10.368238394574323, "num_module_steps_sampled_lifetime": {"default_policy": 7600}, "num_agent_steps_sampled_lifetime": {"default_agent": 7600}, "module_to_env_connector": {"timers": {"connectors": {"get_actions": 0.00017182486399223935, "normalize_and_clip_actions": 3.2801713413003274e-05, "tensor_to_numpy": 4.486505522319777e-05, "remove_single_ts_time_rank_from_batch": 1.431577600487006e-06, "listify_data_for_vector_env": 4.152340507093209e-05, "un_batch_to_individual_items": 1.7568758481905354e-05}}, "connector_pipeline_timer": 0.0003927276497750602}, "episode_return_mean": 0.65, "env_reset_timer": 0.004028933952257173, "module_episode_returns_mean": {"default_policy": 0.65}, "num_episodes_lifetime": 380, "sample": 0.9619486408421906, "num_module_steps_sampled": {"default_policy": 400}, "env_step_timer": 7.390150169647897e-05, "episode_duration_sec_mean": 0.019999569633509965, "env_to_module_sum_episodes_length_in": 10.368238394574323, "episode_len_min": 20, "weights_seq_no": 19.0, "episode_return_max": 13.5, "rlmodule_inference_timer": 9.660283268730306e-05, "time_between_sampling": 10.833848618963165}, "num_healthy_workers": 1, "actor_manager_num_outstanding_async_reqs": 0, "num_remote_worker_restarts": 0}, "num_env_steps_sampled_lifetime": -10487500.0, "fault_tolerance": {"num_healthy_workers": 0, "num_remote_worker_restarts": 0}, "env_runner_group": {"actor_manager_num_outstanding_async_reqs": 0}, "done": false, "training_iteration": 19, "trial_id": "4d8e6_00000", "date": "2025-08-11_19-30-07", "timestamp": 1754933407, "time_this_iter_s": 4.971069097518921, "time_total_s": 124.87152338027954, "pid": 19818, "hostname": "Mac", "node_ip": "127.0.0.1", "config": {"exploration_config": {}, "extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "placement_strategy": "PACK", "num_gpus": 0, "_fake_gpus": false, "num_cpus_for_main_process": 2, "eager_tracing": true, "eager_max_retraces": 20, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "torch_compile_learner": false, "torch_compile_learner_what_to_compile": "forward_train", "torch_compile_learner_dynamo_backend": "aot_eager", "torch_compile_learner_dynamo_mode": null, "torch_compile_worker": false, "torch_compile_worker_dynamo_backend": "aot_eager", "torch_compile_worker_dynamo_mode": null, "torch_ddp_kwargs": {}, "torch_skip_nan_gradients": false, "env": "Umbrella", "env_config": {}, "observation_space": null, "action_space": null, "clip_rewards": null, "normalize_actions": true, "clip_actions": false, "_is_atari": null, "disable_env_checking": false, "render_env": false, "action_mask_key": "action_mask", "env_runner_cls": null, "num_env_runners": 0, "create_local_env_runner": true, "num_envs_per_env_runner": 1, "gym_env_vectorize_mode": "SYNC", "num_cpus_per_env_runner": 1, "num_gpus_per_env_runner": 0, "custom_resources_per_env_runner": {}, "validate_env_runners_after_construction": true, "episodes_to_numpy": true, "max_requests_in_flight_per_env_runner": 1, "sample_timeout_s": 60.0, "_env_to_module_connector": null, "add_default_connectors_to_env_to_module_pipeline": true, "_module_to_env_connector": null, "add_default_connectors_to_module_to_env_pipeline": true, "merge_env_runner_states": "training_only", "broadcast_env_runner_states": true, "episode_lookback_horizon": 1, "rollout_fragment_length": "auto", "batch_mode": "complete_episodes", "compress_observations": false, "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "enable_tf1_exec_eagerly": false, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "preprocessor_pref": "deepmind", "observation_filter": "NoFilter", "update_worker_filter_stats": true, "use_worker_filter_stats": true, "sampler_perf_stats_ema_coef": null, "_is_online": true, "num_learners": 0, "num_gpus_per_learner": 0, "num_cpus_per_learner": "auto", "num_aggregator_actors_per_learner": 0, "max_requests_in_flight_per_aggregator_actor": 3, "local_gpu_idx": 0, "max_requests_in_flight_per_learner": 3, "gamma": 1, "lr": 0.0002847858517, "grad_clip": 0.5, "grad_clip_by": "global_norm", "_train_batch_size_per_learner": 5000, "train_batch_size": 4000, "num_epochs": 1, "minibatch_size": 1000, "shuffle_batch_per_epoch": true, "model": {"fcnet_hiddens": [256, 256], "fcnet_activation": "tanh", "fcnet_weights_initializer": null, "fcnet_weights_initializer_config": null, "fcnet_bias_initializer": null, "fcnet_bias_initializer_config": null, "conv_filters": null, "conv_activation": "relu", "conv_kernel_initializer": null, "conv_kernel_initializer_config": null, "conv_bias_initializer": null, "conv_bias_initializer_config": null, "conv_transpose_kernel_initializer": null, "conv_transpose_kernel_initializer_config": null, "conv_transpose_bias_initializer": null, "conv_transpose_bias_initializer_config": null, "post_fcnet_hiddens": [], "post_fcnet_activation": "relu", "post_fcnet_weights_initializer": null, "post_fcnet_weights_initializer_config": null, "post_fcnet_bias_initializer": null, "post_fcnet_bias_initializer_config": null, "free_log_std": false, "log_std_clip_param": 20.0, "no_final_linear": false, "vf_share_layers": false, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "lstm_weights_initializer": null, "lstm_weights_initializer_config": null, "lstm_bias_initializer": null, "lstm_bias_initializer_config": null, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "attention_use_n_prev_actions": 0, "attention_use_n_prev_rewards": 0, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": null, "custom_model_config": {}, "custom_action_dist": null, "custom_preprocessor": null, "encoder_latent_dim": null, "always_check_shapes": false, "lstm_use_prev_action_reward": -1, "_use_default_native_models": -1, "_disable_preprocessor_api": false, "_disable_action_flattening": false}, "_learner_connector": null, "add_default_connectors_to_learner_pipeline": true, "learner_config_dict": {}, "optimizer": {}, "_learner_class": null, "callbacks_on_algorithm_init": null, "callbacks_on_env_runners_recreated": null, "callbacks_on_offline_eval_runners_recreated": null, "callbacks_on_checkpoint_loaded": null, "callbacks_on_environment_created": null, "callbacks_on_episode_created": null, "callbacks_on_episode_start": null, "callbacks_on_episode_step": null, "callbacks_on_episode_end": null, "callbacks_on_evaluate_start": null, "callbacks_on_evaluate_end": null, "callbacks_on_evaluate_offline_start": null, "callbacks_on_evaluate_offline_end": null, "callbacks_on_sample_end": null, "callbacks_on_train_result": null, "explore": true, "enable_rl_module_and_learner": true, "enable_env_runner_and_connector_v2": true, "_prior_exploration_config": {"type": "StochasticSampling"}, "count_steps_by": "env_steps", "policy_map_capacity": 100, "policy_mapping_fn": "<function AlgorithmConfig.DEFAULT_POLICY_MAPPING_FN at 0x161a518a0>", "policies_to_train": null, "policy_states_are_swappable": false, "observation_fn": null, "offline_data_class": null, "input_read_method": "read_parquet", "input_read_method_kwargs": {}, "input_read_schema": {}, "input_read_episodes": false, "input_read_sample_batches": false, "input_read_batch_size": null, "input_filesystem": null, "input_filesystem_kwargs": {}, "input_compress_columns": ["obs", "new_obs"], "input_spaces_jsonable": true, "materialize_data": false, "materialize_mapped_data": true, "map_batches_kwargs": {}, "iter_batches_kwargs": {}, "ignore_final_observation": false, "prelearner_class": null, "prelearner_buffer_class": null, "prelearner_buffer_kwargs": {}, "prelearner_module_synch_period": 10, "dataset_num_iters_per_learner": null, "input_config": {}, "actions_in_input_normalized": false, "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_config": {}, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "output_max_rows_per_file": null, "output_write_remaining_data": false, "output_write_method": "write_parquet", "output_write_method_kwargs": {}, "output_filesystem": null, "output_filesystem_kwargs": {}, "output_write_episodes": true, "offline_sampling": false, "evaluation_interval": 1, "evaluation_duration": 20, "evaluation_duration_unit": "episodes", "evaluation_sample_timeout_s": 120.0, "evaluation_auto_duration_min_env_steps_per_sample": 100, "evaluation_auto_duration_max_env_steps_per_sample": 2000, "evaluation_parallel_to_training": false, "evaluation_force_reset_envs_before_iteration": true, "evaluation_config": null, "off_policy_estimation_methods": {}, "ope_split_batch_by_episode": true, "evaluation_num_env_runners": 1, "in_evaluation": false, "sync_filters_on_rollout_workers_timeout_s": 10.0, "offline_evaluation_interval": null, "num_offline_eval_runners": 0, "offline_loss_for_module_fn": null, "offline_evaluation_duration": 1, "offline_evaluation_parallel_to_training": false, "offline_evaluation_timeout_s": 120.0, "num_cpus_per_offline_eval_runner": 1, "num_gpus_per_offline_eval_runner": 0, "custom_resources_per_offline_eval_runner": {}, "restart_failed_offline_eval_runners": true, "ignore_offline_eval_runner_failures": false, "max_num_offline_eval_runner_restarts": 1000, "offline_eval_runner_restore_timeout_s": 1800.0, "max_requests_in_flight_per_offline_eval_runner": 1, "validate_offline_eval_runners_after_construction": true, "offline_eval_runner_health_probe_timeout_s": 30.0, "offline_eval_rl_module_inference_only": false, "broadcast_offline_eval_runner_states": false, "offline_eval_batch_size_per_runner": 256, "dataset_num_iters_per_eval_runner": 1, "keep_per_episode_custom_metrics": false, "metrics_episode_collection_timeout_s": 60.0, "metrics_num_episodes_for_smoothing": 100, "min_time_s_per_iteration": null, "min_train_timesteps_per_iteration": 0, "min_sample_timesteps_per_iteration": 0, "log_gradients": true, "export_native_model_files": false, "checkpoint_trainable_policies_only": false, "logger_creator": null, "logger_config": null, "log_level": "WARN", "log_sys_usage": true, "fake_sampler": false, "seed": 10, "restart_failed_env_runners": true, "ignore_env_runner_failures": false, "max_num_env_runner_restarts": 1000, "delay_between_env_runner_restarts_s": 60.0, "restart_failed_sub_environments": false, "num_consecutive_env_runner_failures_tolerance": 100, "env_runner_health_probe_timeout_s": 30.0, "env_runner_restore_timeout_s": 1800.0, "_model_config": {}, "_rl_module_spec": "RLModuleSpec(module_class=None, observation_space=None, action_space=None, inference_only=False, learner_only=False, model_config=DefaultModelConfig(fcnet_hiddens=[60, 90], fcnet_activation='tanh', fcnet_kernel_initializer=None, fcnet_kernel_initializer_kwargs=None, fcnet_bias_initializer=None, fcnet_bias_initializer_kwargs=None, conv_filters=None, conv_activation='relu', conv_kernel_initializer=None, conv_kernel_initializer_kwargs=None, conv_bias_initializer=None, conv_bias_initializer_kwargs=None, head_fcnet_hiddens=[], head_fcnet_activation='relu', head_fcnet_kernel_initializer=None, head_fcnet_kernel_initializer_kwargs=None, head_fcnet_bias_initializer=None, head_fcnet_bias_initializer_kwargs=None, free_log_std=False, log_std_clip_param=20.0, vf_share_layers=True, use_lstm=False, max_seq_len=20, lstm_cell_size=256, lstm_use_prev_action=False, lstm_use_prev_reward=False, lstm_kernel_initializer=None, lstm_kernel_initializer_kwargs=None, lstm_bias_initializer=None, lstm_bias_initializer_kwargs=None), catalog_class=None, load_state_path=None, model_config_dict=None)", "algorithm_config_overrides_per_module": {}, "_per_module_overrides": {}, "_validate_config": true, "_use_msgpack_checkpoints": false, "_torch_grad_scaler_class": null, "_torch_lr_scheduler_classes": null, "_tf_policy_handles_more_than_one_loss": false, "_disable_preprocessor_api": false, "_disable_action_flattening": false, "_disable_initialize_loss_from_dummy_batch": false, "_dont_auto_sync_env_runner_states": false, "env_task_fn": -1, "enable_connectors": -1, "simple_optimizer": false, "policy_map_cache": -1, "worker_cls": -1, "synchronize_filters": -1, "enable_async_evaluation": -1, "custom_async_evaluation_function": -1, "_enable_rl_module_api": -1, "auto_wrap_old_gym_envs": -1, "always_attach_evaluation_results": -1, "replay_sequence_length": null, "_disable_execution_plan_api": -1, "use_critic": true, "use_gae": true, "use_kl_loss": true, "kl_coeff": 0.7464963036515, "kl_target": 0.0270990929592, "vf_loss_coeff": 0.6688075857018, "entropy_coeff": 0.0090570820258, "clip_param": 0.1221781641624, "vf_clip_param": 0.1027808522125, "entropy_coeff_schedule": null, "lr_schedule": null, "sgd_minibatch_size": -1, "vf_share_layers": -1, "__stdout_file__": null, "__stderr_file__": null, "lambda": 0.9099046732075, "input": "sampler", "policies": {"default_policy": [null, null, null, null]}, "callbacks": "<class 'ray.rllib.callbacks.callbacks.RLlibCallback'>", "create_env_on_driver": false, "custom_eval_function": null, "framework": "torch"}, "time_since_restore": 124.87152338027954, "iterations_since_restore": 19, "perf": {"cpu_util_percent": 91.41428571428571, "ram_util_percent": 81.58571428571429}}
{"timers": {"training_iteration": 15.288988280225867, "restore_env_runners": 0.00010225088449134715, "training_step": 15.28845760724223, "env_runner_sampling_timer": 14.663699413793081, "learner_update_timer": 0.6145021160255822, "synch_weights": 0.0017143747574580514, "restore_eval_env_runners": 3.2791147685402785e-05, "evaluation_iteration": 1.0099271368555085, "synch_eval_env_connectors": 0.0004948073741648934, "synch_env_connectors": 9.139631689804838e-06}, "env_runners": {"episode_return_min": -10.5, "num_agent_steps_sampled_lifetime": {"default_agent": -11105000.0}, "module_to_env_connector": {"timers": {"connectors": {"remove_single_ts_time_rank_from_batch": 1.6716948665735504e-06, "normalize_and_clip_actions": 2.2229900583829418e-05, "listify_data_for_vector_env": 3.111185750958351e-05, "get_actions": 0.00013138167686356598, "tensor_to_numpy": 3.705401417768628e-05, "un_batch_to_individual_items": 1.336622339648478e-05}}, "connector_pipeline_timer": 0.0002998655528113011}, "episode_len_mean": 20.0, "num_module_steps_sampled": {"default_policy": 5000.0}, "env_to_module_connector": {"timers": {"connectors": {"add_states_from_episodes_to_batch": 3.831892514353675e-06, "add_time_dim_to_batch_and_zero_pad": 7.29432545548493e-06, "numpy_to_tensor": 2.8202764902882494e-05, "add_observations_from_episodes_to_batch": 8.244925980783747e-06, "batch_individual_items": 1.838117091364005e-05}}, "connector_pipeline_timer": 0.00011839586635232313}, "sample": 0.014514016822587671, "env_to_module_sum_episodes_length_out": 10.36823839457432, "weights_seq_no": 19.0, "num_env_steps_sampled_lifetime": -11105000.0, "episode_return_max": 9.5, "episode_return_mean": 6.2200000000000015, "module_episode_returns_mean": {"default_policy": 6.2200000000000015}, "time_between_sampling": 0.005040767047843699, "rlmodule_inference_timer": 8.675523539287024e-05, "env_step_timer": 4.3047329104817355e-05, "env_reset_timer": 0.0001116143608517075, "agent_episode_returns_mean": {"default_agent": 6.2200000000000015}, "num_env_steps_sampled": 5000.0, "episode_duration_sec_mean": 0.012702420979738234, "env_to_module_sum_episodes_length_in": 10.36823839457432, "episode_len_min": 20, "num_agent_steps_sampled": {"default_agent": 5000.0}, "num_episodes": 250.0, "num_module_steps_sampled_lifetime": {"default_policy": -11105000.0}, "episode_len_max": 20, "num_episodes_lifetime": -555250.0, "num_env_steps_sampled_lifetime_throughput": 1714.5107835980077}, "learners": {"__all_modules__": {"learner_connector": {"timers": {"connectors": {"general_advantage_estimation": 0.05813240733213924, "numpy_to_tensor": 0.0005774304221722718, "add_observations_from_episodes_to_batch": 0.004113015983498499, "add_one_ts_to_episodes_and_truncate": 0.03042185689761136, "batch_individual_items": 0.113486268430017, "add_states_from_episodes_to_batch": 5.284249577822022e-06, "add_columns_from_episodes_to_train_batch": 0.17306381740086388, "add_time_dim_to_batch_and_zero_pad": 1.857848003689641e-05}}, "connector_pipeline_timer": 0.38030506924901436}, "num_module_steps_trained_lifetime": 120000, "num_non_trainable_parameters": 0, "learner_connector_sum_episodes_length_out": 5250.0, "num_module_steps_trained": 6000, "num_trainable_parameters": 6003, "num_env_steps_trained": 31500, "num_env_steps_trained_lifetime": 630000, "learner_connector_sum_episodes_length_in": 5000.0, "num_env_steps_trained_lifetime_throughput": 532495.333511736, "num_module_steps_trained_throughput": 101660.61500314472, "num_module_steps_trained_lifetime_throughput": 101468.87310771206}, "default_policy": {"curr_kl_coeff": 7.119143674572115e-07, "entropy": 0.4487060010433197, "vf_loss": 0.10278083384037018, "default_optimizer_learning_rate": 0.0002847858517, "vf_explained_var": -0.01161646842956543, "total_loss": 0.2269459366798401, "num_trainable_parameters": 6003, "vf_loss_unclipped": 28.659807205200195, "curr_entropy_coeff": 0.0090570820258, "policy_loss": 0.16226932406425476, "diff_num_grad_updates_vs_sampler_policy": 1.0, "mean_kl_loss": 2.8233316697878763e-05, "gradients_default_optimizer_global_norm": 0.05579276755452156, "num_module_steps_trained_lifetime": 120000, "weights_seq_no": 20.0, "num_module_steps_trained": 6000, "module_train_batch_size_mean": 1000.0, "num_module_steps_trained_lifetime_throughput": 101554.9252861832}}, "num_training_step_calls_per_iteration": 1, "evaluation": {"env_runners": {"env_to_module_connector": {"timers": {"connectors": {"add_states_from_episodes_to_batch": 3.9945877414164295e-06, "numpy_to_tensor": 3.848143922555901e-05, "add_time_dim_to_batch_and_zero_pad": 6.039261237811925e-06, "add_observations_from_episodes_to_batch": 7.444188502931053e-06, "batch_individual_items": 1.5865651982976977e-05}}, "connector_pipeline_timer": 0.00011763674939522297}, "agent_episode_returns_mean": {"default_agent": -0.75}, "num_agent_steps_sampled": {"default_agent": 400}, "num_env_steps_sampled_lifetime": 100400, "num_env_steps_sampled": 400, "num_episodes": 20, "episode_len_max": 20, "episode_return_min": -14.5, "episode_len_mean": 20.0, "env_to_module_sum_episodes_length_out": 10.368238394574323, "num_module_steps_sampled_lifetime": {"default_policy": 8000}, "num_agent_steps_sampled_lifetime": {"default_agent": 8000}, "module_to_env_connector": {"timers": {"connectors": {"get_actions": 0.00017535029383102508, "normalize_and_clip_actions": 2.423477927923207e-05, "tensor_to_numpy": 4.453924244807954e-05, "remove_single_ts_time_rank_from_batch": 1.181943165778433e-06, "listify_data_for_vector_env": 2.880630636132343e-05, "un_batch_to_individual_items": 1.466005994188007e-05}}, "connector_pipeline_timer": 0.00034889323949060174}, "episode_return_mean": -0.75, "env_reset_timer": 0.00399080711232072, "module_episode_returns_mean": {"default_policy": -0.75}, "num_episodes_lifetime": 400, "sample": 0.95542315277396, "num_module_steps_sampled": {"default_policy": 400}, "env_step_timer": 4.8033483750670014e-05, "episode_duration_sec_mean": 0.020464198796544222, "env_to_module_sum_episodes_length_in": 10.368238394574323, "episode_len_min": 20, "weights_seq_no": 20.0, "episode_return_max": 13.5, "rlmodule_inference_timer": 9.466822938365403e-05, "time_between_sampling": 10.765346443603965}, "num_healthy_workers": 1, "actor_manager_num_outstanding_async_reqs": 0, "num_remote_worker_restarts": 0}, "num_env_steps_sampled_lifetime": -11105000.0, "fault_tolerance": {"num_healthy_workers": 0, "num_remote_worker_restarts": 0}, "env_runner_group": {"actor_manager_num_outstanding_async_reqs": 0}, "done": true, "training_iteration": 20, "trial_id": "4d8e6_00000", "date": "2025-08-11_19-30-11", "timestamp": 1754933411, "time_this_iter_s": 4.267880201339722, "time_total_s": 129.13940358161926, "pid": 19818, "hostname": "Mac", "node_ip": "127.0.0.1", "config": {"exploration_config": {}, "extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "placement_strategy": "PACK", "num_gpus": 0, "_fake_gpus": false, "num_cpus_for_main_process": 2, "eager_tracing": true, "eager_max_retraces": 20, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "torch_compile_learner": false, "torch_compile_learner_what_to_compile": "forward_train", "torch_compile_learner_dynamo_backend": "aot_eager", "torch_compile_learner_dynamo_mode": null, "torch_compile_worker": false, "torch_compile_worker_dynamo_backend": "aot_eager", "torch_compile_worker_dynamo_mode": null, "torch_ddp_kwargs": {}, "torch_skip_nan_gradients": false, "env": "Umbrella", "env_config": {}, "observation_space": null, "action_space": null, "clip_rewards": null, "normalize_actions": true, "clip_actions": false, "_is_atari": null, "disable_env_checking": false, "render_env": false, "action_mask_key": "action_mask", "env_runner_cls": null, "num_env_runners": 0, "create_local_env_runner": true, "num_envs_per_env_runner": 1, "gym_env_vectorize_mode": "SYNC", "num_cpus_per_env_runner": 1, "num_gpus_per_env_runner": 0, "custom_resources_per_env_runner": {}, "validate_env_runners_after_construction": true, "episodes_to_numpy": true, "max_requests_in_flight_per_env_runner": 1, "sample_timeout_s": 60.0, "_env_to_module_connector": null, "add_default_connectors_to_env_to_module_pipeline": true, "_module_to_env_connector": null, "add_default_connectors_to_module_to_env_pipeline": true, "merge_env_runner_states": "training_only", "broadcast_env_runner_states": true, "episode_lookback_horizon": 1, "rollout_fragment_length": "auto", "batch_mode": "complete_episodes", "compress_observations": false, "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "enable_tf1_exec_eagerly": false, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "preprocessor_pref": "deepmind", "observation_filter": "NoFilter", "update_worker_filter_stats": true, "use_worker_filter_stats": true, "sampler_perf_stats_ema_coef": null, "_is_online": true, "num_learners": 0, "num_gpus_per_learner": 0, "num_cpus_per_learner": "auto", "num_aggregator_actors_per_learner": 0, "max_requests_in_flight_per_aggregator_actor": 3, "local_gpu_idx": 0, "max_requests_in_flight_per_learner": 3, "gamma": 1, "lr": 0.0002847858517, "grad_clip": 0.5, "grad_clip_by": "global_norm", "_train_batch_size_per_learner": 5000, "train_batch_size": 4000, "num_epochs": 1, "minibatch_size": 1000, "shuffle_batch_per_epoch": true, "model": {"fcnet_hiddens": [256, 256], "fcnet_activation": "tanh", "fcnet_weights_initializer": null, "fcnet_weights_initializer_config": null, "fcnet_bias_initializer": null, "fcnet_bias_initializer_config": null, "conv_filters": null, "conv_activation": "relu", "conv_kernel_initializer": null, "conv_kernel_initializer_config": null, "conv_bias_initializer": null, "conv_bias_initializer_config": null, "conv_transpose_kernel_initializer": null, "conv_transpose_kernel_initializer_config": null, "conv_transpose_bias_initializer": null, "conv_transpose_bias_initializer_config": null, "post_fcnet_hiddens": [], "post_fcnet_activation": "relu", "post_fcnet_weights_initializer": null, "post_fcnet_weights_initializer_config": null, "post_fcnet_bias_initializer": null, "post_fcnet_bias_initializer_config": null, "free_log_std": false, "log_std_clip_param": 20.0, "no_final_linear": false, "vf_share_layers": false, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "lstm_weights_initializer": null, "lstm_weights_initializer_config": null, "lstm_bias_initializer": null, "lstm_bias_initializer_config": null, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "attention_use_n_prev_actions": 0, "attention_use_n_prev_rewards": 0, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": null, "custom_model_config": {}, "custom_action_dist": null, "custom_preprocessor": null, "encoder_latent_dim": null, "always_check_shapes": false, "lstm_use_prev_action_reward": -1, "_use_default_native_models": -1, "_disable_preprocessor_api": false, "_disable_action_flattening": false}, "_learner_connector": null, "add_default_connectors_to_learner_pipeline": true, "learner_config_dict": {}, "optimizer": {}, "_learner_class": null, "callbacks_on_algorithm_init": null, "callbacks_on_env_runners_recreated": null, "callbacks_on_offline_eval_runners_recreated": null, "callbacks_on_checkpoint_loaded": null, "callbacks_on_environment_created": null, "callbacks_on_episode_created": null, "callbacks_on_episode_start": null, "callbacks_on_episode_step": null, "callbacks_on_episode_end": null, "callbacks_on_evaluate_start": null, "callbacks_on_evaluate_end": null, "callbacks_on_evaluate_offline_start": null, "callbacks_on_evaluate_offline_end": null, "callbacks_on_sample_end": null, "callbacks_on_train_result": null, "explore": true, "enable_rl_module_and_learner": true, "enable_env_runner_and_connector_v2": true, "_prior_exploration_config": {"type": "StochasticSampling"}, "count_steps_by": "env_steps", "policy_map_capacity": 100, "policy_mapping_fn": "<function AlgorithmConfig.DEFAULT_POLICY_MAPPING_FN at 0x161a518a0>", "policies_to_train": null, "policy_states_are_swappable": false, "observation_fn": null, "offline_data_class": null, "input_read_method": "read_parquet", "input_read_method_kwargs": {}, "input_read_schema": {}, "input_read_episodes": false, "input_read_sample_batches": false, "input_read_batch_size": null, "input_filesystem": null, "input_filesystem_kwargs": {}, "input_compress_columns": ["obs", "new_obs"], "input_spaces_jsonable": true, "materialize_data": false, "materialize_mapped_data": true, "map_batches_kwargs": {}, "iter_batches_kwargs": {}, "ignore_final_observation": false, "prelearner_class": null, "prelearner_buffer_class": null, "prelearner_buffer_kwargs": {}, "prelearner_module_synch_period": 10, "dataset_num_iters_per_learner": null, "input_config": {}, "actions_in_input_normalized": false, "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_config": {}, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "output_max_rows_per_file": null, "output_write_remaining_data": false, "output_write_method": "write_parquet", "output_write_method_kwargs": {}, "output_filesystem": null, "output_filesystem_kwargs": {}, "output_write_episodes": true, "offline_sampling": false, "evaluation_interval": 1, "evaluation_duration": 20, "evaluation_duration_unit": "episodes", "evaluation_sample_timeout_s": 120.0, "evaluation_auto_duration_min_env_steps_per_sample": 100, "evaluation_auto_duration_max_env_steps_per_sample": 2000, "evaluation_parallel_to_training": false, "evaluation_force_reset_envs_before_iteration": true, "evaluation_config": null, "off_policy_estimation_methods": {}, "ope_split_batch_by_episode": true, "evaluation_num_env_runners": 1, "in_evaluation": false, "sync_filters_on_rollout_workers_timeout_s": 10.0, "offline_evaluation_interval": null, "num_offline_eval_runners": 0, "offline_loss_for_module_fn": null, "offline_evaluation_duration": 1, "offline_evaluation_parallel_to_training": false, "offline_evaluation_timeout_s": 120.0, "num_cpus_per_offline_eval_runner": 1, "num_gpus_per_offline_eval_runner": 0, "custom_resources_per_offline_eval_runner": {}, "restart_failed_offline_eval_runners": true, "ignore_offline_eval_runner_failures": false, "max_num_offline_eval_runner_restarts": 1000, "offline_eval_runner_restore_timeout_s": 1800.0, "max_requests_in_flight_per_offline_eval_runner": 1, "validate_offline_eval_runners_after_construction": true, "offline_eval_runner_health_probe_timeout_s": 30.0, "offline_eval_rl_module_inference_only": false, "broadcast_offline_eval_runner_states": false, "offline_eval_batch_size_per_runner": 256, "dataset_num_iters_per_eval_runner": 1, "keep_per_episode_custom_metrics": false, "metrics_episode_collection_timeout_s": 60.0, "metrics_num_episodes_for_smoothing": 100, "min_time_s_per_iteration": null, "min_train_timesteps_per_iteration": 0, "min_sample_timesteps_per_iteration": 0, "log_gradients": true, "export_native_model_files": false, "checkpoint_trainable_policies_only": false, "logger_creator": null, "logger_config": null, "log_level": "WARN", "log_sys_usage": true, "fake_sampler": false, "seed": 10, "restart_failed_env_runners": true, "ignore_env_runner_failures": false, "max_num_env_runner_restarts": 1000, "delay_between_env_runner_restarts_s": 60.0, "restart_failed_sub_environments": false, "num_consecutive_env_runner_failures_tolerance": 100, "env_runner_health_probe_timeout_s": 30.0, "env_runner_restore_timeout_s": 1800.0, "_model_config": {}, "_rl_module_spec": "RLModuleSpec(module_class=None, observation_space=None, action_space=None, inference_only=False, learner_only=False, model_config=DefaultModelConfig(fcnet_hiddens=[60, 90], fcnet_activation='tanh', fcnet_kernel_initializer=None, fcnet_kernel_initializer_kwargs=None, fcnet_bias_initializer=None, fcnet_bias_initializer_kwargs=None, conv_filters=None, conv_activation='relu', conv_kernel_initializer=None, conv_kernel_initializer_kwargs=None, conv_bias_initializer=None, conv_bias_initializer_kwargs=None, head_fcnet_hiddens=[], head_fcnet_activation='relu', head_fcnet_kernel_initializer=None, head_fcnet_kernel_initializer_kwargs=None, head_fcnet_bias_initializer=None, head_fcnet_bias_initializer_kwargs=None, free_log_std=False, log_std_clip_param=20.0, vf_share_layers=True, use_lstm=False, max_seq_len=20, lstm_cell_size=256, lstm_use_prev_action=False, lstm_use_prev_reward=False, lstm_kernel_initializer=None, lstm_kernel_initializer_kwargs=None, lstm_bias_initializer=None, lstm_bias_initializer_kwargs=None), catalog_class=None, load_state_path=None, model_config_dict=None)", "algorithm_config_overrides_per_module": {}, "_per_module_overrides": {}, "_validate_config": true, "_use_msgpack_checkpoints": false, "_torch_grad_scaler_class": null, "_torch_lr_scheduler_classes": null, "_tf_policy_handles_more_than_one_loss": false, "_disable_preprocessor_api": false, "_disable_action_flattening": false, "_disable_initialize_loss_from_dummy_batch": false, "_dont_auto_sync_env_runner_states": false, "env_task_fn": -1, "enable_connectors": -1, "simple_optimizer": false, "policy_map_cache": -1, "worker_cls": -1, "synchronize_filters": -1, "enable_async_evaluation": -1, "custom_async_evaluation_function": -1, "_enable_rl_module_api": -1, "auto_wrap_old_gym_envs": -1, "always_attach_evaluation_results": -1, "replay_sequence_length": null, "_disable_execution_plan_api": -1, "use_critic": true, "use_gae": true, "use_kl_loss": true, "kl_coeff": 0.7464963036515, "kl_target": 0.0270990929592, "vf_loss_coeff": 0.6688075857018, "entropy_coeff": 0.0090570820258, "clip_param": 0.1221781641624, "vf_clip_param": 0.1027808522125, "entropy_coeff_schedule": null, "lr_schedule": null, "sgd_minibatch_size": -1, "vf_share_layers": -1, "__stdout_file__": null, "__stderr_file__": null, "lambda": 0.9099046732075, "input": "sampler", "policies": {"default_policy": [null, null, null, null]}, "callbacks": "<class 'ray.rllib.callbacks.callbacks.RLlibCallback'>", "create_env_on_driver": false, "custom_eval_function": null, "framework": "torch"}, "time_since_restore": 129.13940358161926, "iterations_since_restore": 20, "perf": {"cpu_util_percent": 90.68333333333334, "ram_util_percent": 81.46666666666665}}
