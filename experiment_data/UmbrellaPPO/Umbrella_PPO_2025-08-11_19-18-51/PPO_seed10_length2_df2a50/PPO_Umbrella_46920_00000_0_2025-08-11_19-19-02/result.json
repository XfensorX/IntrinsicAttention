{"timers": {"training_iteration": 2.6653067090082914, "restore_env_runners": 1.4832941815257072e-05, "training_step": 2.6651291250018403, "env_runner_sampling_timer": 2.5075972919585183, "learner_update_timer": 0.15450945892371237, "synch_weights": 0.0005776669131591916}, "env_runners": {"num_episodes": 250.0, "module_to_env_connector": {"timers": {"connectors": {"remove_single_ts_time_rank_from_batch": 9.702465020834778e-07, "listify_data_for_vector_env": 1.919620771824422e-05, "get_actions": 0.00021506354475126795, "tensor_to_numpy": 2.300868558526324e-05, "un_batch_to_individual_items": 8.767048073687208e-06, "normalize_and_clip_actions": 0.0003078839496498631}}, "connector_pipeline_timer": 0.0006165797707005194}, "episode_duration_sec_mean": 0.008416664990130815, "env_to_module_sum_episodes_length_in": 10.191744832559449, "episode_return_min": -10.5, "episode_len_max": 20, "episode_len_mean": 20.0, "env_step_timer": 2.627970571388774e-05, "num_agent_steps_sampled": {"default_agent": 5000.0}, "module_episode_returns_mean": {"default_policy": -2.0200000000000005}, "num_agent_steps_sampled_lifetime": {"default_agent": 627500.0}, "agent_episode_returns_mean": {"default_agent": -2.0200000000000005}, "weights_seq_no": 0.0, "env_to_module_connector": {"timers": {"connectors": {"add_observations_from_episodes_to_batch": 4.968982006690853e-06, "numpy_to_tensor": 1.6843743710658868e-05, "add_states_from_episodes_to_batch": 6.708869123655526e-06, "add_time_dim_to_batch_and_zero_pad": 4.53085361350647e-06, "batch_individual_items": 1.2477748250127024e-05}}, "connector_pipeline_timer": 0.00015254642079713454}, "sample": 0.023667165241387927, "num_module_steps_sampled_lifetime": {"default_policy": 627500.0}, "num_env_steps_sampled_lifetime": 627500.0, "episode_len_min": 20, "episode_return_max": 9.5, "num_episodes_lifetime": 31375.0, "time_between_sampling": 0.0012382273130319389, "num_module_steps_sampled": {"default_policy": 5000.0}, "env_reset_timer": 0.0001063443932763841, "num_env_steps_sampled": 5000.0, "episode_return_mean": -2.0200000000000005, "rlmodule_inference_timer": 8.046684242833918e-05, "env_to_module_sum_episodes_length_out": 10.191744832559449, "num_env_steps_sampled_lifetime_throughput": 2254.6303338099897}, "learners": {"__all_modules__": {"num_trainable_parameters": 6003, "learner_connector": {"timers": {"connectors": {"add_time_dim_to_batch_and_zero_pad": 2.5707995519042015e-05, "batch_individual_items": 0.03591537498869002, "add_states_from_episodes_to_batch": 7.4999406933784485e-06, "general_advantage_estimation": 0.007595833973027766, "add_columns_from_episodes_to_train_batch": 0.05988641607109457, "numpy_to_tensor": 7.31669133529067e-05, "add_one_ts_to_episodes_and_truncate": 0.013014708063565195, "add_observations_from_episodes_to_batch": 0.001993749989196658}}, "connector_pipeline_timer": 0.11879695800598711}, "learner_connector_sum_episodes_length_in": 5000, "num_module_steps_trained": 6000, "num_non_trainable_parameters": 0, "num_module_steps_trained_lifetime": 6000, "learner_connector_sum_episodes_length_out": 5250, "num_env_steps_trained_lifetime": 31500, "num_env_steps_trained": 31500, "num_env_steps_trained_lifetime_throughput": 1794358.7662441034, "num_module_steps_trained_throughput": 343410.5852152555, "num_module_steps_trained_lifetime_throughput": 342749.26786932343}, "default_policy": {"vf_loss_unclipped": 28.793254852294922, "total_loss": 0.11597263813018799, "entropy": 0.6901261210441589, "num_trainable_parameters": 6003, "num_module_steps_trained_lifetime": 6000, "curr_kl_coeff": 0.3732481598854065, "vf_explained_var": -0.009449124336242676, "weights_seq_no": 1.0, "policy_loss": 0.05304957553744316, "num_module_steps_trained": 6000, "curr_entropy_coeff": 0.0090570820258, "mean_kl_loss": 0.0005800133803859353, "module_train_batch_size_mean": 1000.0, "vf_loss": 0.10278083384037018, "gradients_default_optimizer_global_norm": 0.10005132108926773, "default_optimizer_learning_rate": 0.0002847858517, "diff_num_grad_updates_vs_sampler_policy": 1.0, "num_module_steps_trained_lifetime_throughput": 344515.81196968764}}, "num_training_step_calls_per_iteration": 1, "num_env_steps_sampled_lifetime": 627500.0, "evaluation": {"env_runners": {"weights_seq_no": 1.0, "num_env_steps_sampled_lifetime": 5400, "module_to_env_connector": {"timers": {"connectors": {"remove_single_ts_time_rank_from_batch": 6.682208464978938e-07, "listify_data_for_vector_env": 1.3783955883030678e-05, "get_actions": 5.223494833177071e-05, "un_batch_to_individual_items": 6.864204582704985e-06, "tensor_to_numpy": 1.809320051928355e-05, "normalize_and_clip_actions": 1.2971648310929758e-05}}, "connector_pipeline_timer": 0.00013525980604975194}, "module_episode_returns_mean": {"default_policy": 0.45}, "episode_return_mean": 0.45, "rlmodule_inference_timer": 3.844789263790994e-05, "episode_duration_sec_mean": 0.005828125099651515, "env_to_module_connector": {"timers": {"connectors": {"add_observations_from_episodes_to_batch": 3.7211406297762046e-06, "add_time_dim_to_batch_and_zero_pad": 3.060497196212689e-06, "batch_individual_items": 8.391115080664097e-06, "add_states_from_episodes_to_batch": 1.7964379315630397e-06, "numpy_to_tensor": 1.1379605703857283e-05}}, "connector_pipeline_timer": 5.532585819459598e-05}, "num_module_steps_sampled": {"default_policy": 400}, "episode_len_max": 20, "env_step_timer": 1.9601427827317485e-05, "sample": 0.12775887502357364, "agent_episode_returns_mean": {"default_agent": 0.45}, "env_reset_timer": 0.0003573748981580138, "env_to_module_sum_episodes_length_in": 10.216013141322508, "episode_len_mean": 20.0, "num_agent_steps_sampled": {"default_agent": 400}, "num_agent_steps_sampled_lifetime": {"default_agent": 400}, "num_env_steps_sampled": 400, "num_module_steps_sampled_lifetime": {"default_policy": 400}, "env_to_module_sum_episodes_length_out": 10.216013141322508, "num_episodes": 20, "episode_return_min": -12.5, "episode_len_min": 20, "episode_return_max": 13.5, "num_episodes_lifetime": 20}, "num_healthy_workers": 1, "actor_manager_num_outstanding_async_reqs": 0, "num_remote_worker_restarts": 0}, "fault_tolerance": {"num_healthy_workers": 0, "num_remote_worker_restarts": 0}, "env_runner_group": {"actor_manager_num_outstanding_async_reqs": 0}, "done": false, "training_iteration": 1, "trial_id": "46920_00000", "date": "2025-08-11_19-35-22", "timestamp": 1754933722, "time_this_iter_s": 2.801922082901001, "time_total_s": 2.801922082901001, "pid": 27748, "hostname": "Mac", "node_ip": "127.0.0.1", "config": {"exploration_config": {}, "extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "placement_strategy": "PACK", "num_gpus": 0, "_fake_gpus": false, "num_cpus_for_main_process": 2, "eager_tracing": true, "eager_max_retraces": 20, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "torch_compile_learner": false, "torch_compile_learner_what_to_compile": "forward_train", "torch_compile_learner_dynamo_backend": "aot_eager", "torch_compile_learner_dynamo_mode": null, "torch_compile_worker": false, "torch_compile_worker_dynamo_backend": "aot_eager", "torch_compile_worker_dynamo_mode": null, "torch_ddp_kwargs": {}, "torch_skip_nan_gradients": false, "env": "Umbrella", "env_config": {}, "observation_space": null, "action_space": null, "clip_rewards": null, "normalize_actions": true, "clip_actions": false, "_is_atari": null, "disable_env_checking": false, "render_env": false, "action_mask_key": "action_mask", "env_runner_cls": null, "num_env_runners": 0, "create_local_env_runner": true, "num_envs_per_env_runner": 1, "gym_env_vectorize_mode": "SYNC", "num_cpus_per_env_runner": 1, "num_gpus_per_env_runner": 0, "custom_resources_per_env_runner": {}, "validate_env_runners_after_construction": true, "episodes_to_numpy": true, "max_requests_in_flight_per_env_runner": 1, "sample_timeout_s": 60.0, "_env_to_module_connector": null, "add_default_connectors_to_env_to_module_pipeline": true, "_module_to_env_connector": null, "add_default_connectors_to_module_to_env_pipeline": true, "merge_env_runner_states": "training_only", "broadcast_env_runner_states": true, "episode_lookback_horizon": 1, "rollout_fragment_length": "auto", "batch_mode": "complete_episodes", "compress_observations": false, "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "enable_tf1_exec_eagerly": false, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "preprocessor_pref": "deepmind", "observation_filter": "NoFilter", "update_worker_filter_stats": true, "use_worker_filter_stats": true, "sampler_perf_stats_ema_coef": null, "_is_online": true, "num_learners": 0, "num_gpus_per_learner": 0, "num_cpus_per_learner": "auto", "num_aggregator_actors_per_learner": 0, "max_requests_in_flight_per_aggregator_actor": 3, "local_gpu_idx": 0, "max_requests_in_flight_per_learner": 3, "gamma": 1, "lr": 0.0002847858517, "grad_clip": 0.5, "grad_clip_by": "global_norm", "_train_batch_size_per_learner": 5000, "train_batch_size": 4000, "num_epochs": 1, "minibatch_size": 1000, "shuffle_batch_per_epoch": true, "model": {"fcnet_hiddens": [256, 256], "fcnet_activation": "tanh", "fcnet_weights_initializer": null, "fcnet_weights_initializer_config": null, "fcnet_bias_initializer": null, "fcnet_bias_initializer_config": null, "conv_filters": null, "conv_activation": "relu", "conv_kernel_initializer": null, "conv_kernel_initializer_config": null, "conv_bias_initializer": null, "conv_bias_initializer_config": null, "conv_transpose_kernel_initializer": null, "conv_transpose_kernel_initializer_config": null, "conv_transpose_bias_initializer": null, "conv_transpose_bias_initializer_config": null, "post_fcnet_hiddens": [], "post_fcnet_activation": "relu", "post_fcnet_weights_initializer": null, "post_fcnet_weights_initializer_config": null, "post_fcnet_bias_initializer": null, "post_fcnet_bias_initializer_config": null, "free_log_std": false, "log_std_clip_param": 20.0, "no_final_linear": false, "vf_share_layers": false, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "lstm_weights_initializer": null, "lstm_weights_initializer_config": null, "lstm_bias_initializer": null, "lstm_bias_initializer_config": null, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "attention_use_n_prev_actions": 0, "attention_use_n_prev_rewards": 0, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": null, "custom_model_config": {}, "custom_action_dist": null, "custom_preprocessor": null, "encoder_latent_dim": null, "always_check_shapes": false, "lstm_use_prev_action_reward": -1, "_use_default_native_models": -1, "_disable_preprocessor_api": false, "_disable_action_flattening": false}, "_learner_connector": null, "add_default_connectors_to_learner_pipeline": true, "learner_config_dict": {}, "optimizer": {}, "_learner_class": null, "callbacks_on_algorithm_init": null, "callbacks_on_env_runners_recreated": null, "callbacks_on_offline_eval_runners_recreated": null, "callbacks_on_checkpoint_loaded": null, "callbacks_on_environment_created": null, "callbacks_on_episode_created": null, "callbacks_on_episode_start": null, "callbacks_on_episode_step": null, "callbacks_on_episode_end": null, "callbacks_on_evaluate_start": null, "callbacks_on_evaluate_end": null, "callbacks_on_evaluate_offline_start": null, "callbacks_on_evaluate_offline_end": null, "callbacks_on_sample_end": null, "callbacks_on_train_result": null, "explore": true, "enable_rl_module_and_learner": true, "enable_env_runner_and_connector_v2": true, "_prior_exploration_config": {"type": "StochasticSampling"}, "count_steps_by": "env_steps", "policy_map_capacity": 100, "policy_mapping_fn": "<function AlgorithmConfig.DEFAULT_POLICY_MAPPING_FN at 0x3847e9b20>", "policies_to_train": null, "policy_states_are_swappable": false, "observation_fn": null, "offline_data_class": null, "input_read_method": "read_parquet", "input_read_method_kwargs": {}, "input_read_schema": {}, "input_read_episodes": false, "input_read_sample_batches": false, "input_read_batch_size": null, "input_filesystem": null, "input_filesystem_kwargs": {}, "input_compress_columns": ["obs", "new_obs"], "input_spaces_jsonable": true, "materialize_data": false, "materialize_mapped_data": true, "map_batches_kwargs": {}, "iter_batches_kwargs": {}, "ignore_final_observation": false, "prelearner_class": null, "prelearner_buffer_class": null, "prelearner_buffer_kwargs": {}, "prelearner_module_synch_period": 10, "dataset_num_iters_per_learner": null, "input_config": {}, "actions_in_input_normalized": false, "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_config": {}, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "output_max_rows_per_file": null, "output_write_remaining_data": false, "output_write_method": "write_parquet", "output_write_method_kwargs": {}, "output_filesystem": null, "output_filesystem_kwargs": {}, "output_write_episodes": true, "offline_sampling": false, "evaluation_interval": 1, "evaluation_duration": 20, "evaluation_duration_unit": "episodes", "evaluation_sample_timeout_s": 120.0, "evaluation_auto_duration_min_env_steps_per_sample": 100, "evaluation_auto_duration_max_env_steps_per_sample": 2000, "evaluation_parallel_to_training": false, "evaluation_force_reset_envs_before_iteration": true, "evaluation_config": null, "off_policy_estimation_methods": {}, "ope_split_batch_by_episode": true, "evaluation_num_env_runners": 1, "in_evaluation": false, "sync_filters_on_rollout_workers_timeout_s": 10.0, "offline_evaluation_interval": null, "num_offline_eval_runners": 0, "offline_loss_for_module_fn": null, "offline_evaluation_duration": 1, "offline_evaluation_parallel_to_training": false, "offline_evaluation_timeout_s": 120.0, "num_cpus_per_offline_eval_runner": 1, "num_gpus_per_offline_eval_runner": 0, "custom_resources_per_offline_eval_runner": {}, "restart_failed_offline_eval_runners": true, "ignore_offline_eval_runner_failures": false, "max_num_offline_eval_runner_restarts": 1000, "offline_eval_runner_restore_timeout_s": 1800.0, "max_requests_in_flight_per_offline_eval_runner": 1, "validate_offline_eval_runners_after_construction": true, "offline_eval_runner_health_probe_timeout_s": 30.0, "offline_eval_rl_module_inference_only": false, "broadcast_offline_eval_runner_states": false, "offline_eval_batch_size_per_runner": 256, "dataset_num_iters_per_eval_runner": 1, "keep_per_episode_custom_metrics": false, "metrics_episode_collection_timeout_s": 60.0, "metrics_num_episodes_for_smoothing": 100, "min_time_s_per_iteration": null, "min_train_timesteps_per_iteration": 0, "min_sample_timesteps_per_iteration": 0, "log_gradients": true, "export_native_model_files": false, "checkpoint_trainable_policies_only": false, "logger_creator": null, "logger_config": null, "log_level": "WARN", "log_sys_usage": true, "fake_sampler": false, "seed": 10, "restart_failed_env_runners": true, "ignore_env_runner_failures": false, "max_num_env_runner_restarts": 1000, "delay_between_env_runner_restarts_s": 60.0, "restart_failed_sub_environments": false, "num_consecutive_env_runner_failures_tolerance": 100, "env_runner_health_probe_timeout_s": 30.0, "env_runner_restore_timeout_s": 1800.0, "_model_config": {}, "_rl_module_spec": "RLModuleSpec(module_class=None, observation_space=None, action_space=None, inference_only=False, learner_only=False, model_config=DefaultModelConfig(fcnet_hiddens=[60, 90], fcnet_activation='tanh', fcnet_kernel_initializer=None, fcnet_kernel_initializer_kwargs=None, fcnet_bias_initializer=None, fcnet_bias_initializer_kwargs=None, conv_filters=None, conv_activation='relu', conv_kernel_initializer=None, conv_kernel_initializer_kwargs=None, conv_bias_initializer=None, conv_bias_initializer_kwargs=None, head_fcnet_hiddens=[], head_fcnet_activation='relu', head_fcnet_kernel_initializer=None, head_fcnet_kernel_initializer_kwargs=None, head_fcnet_bias_initializer=None, head_fcnet_bias_initializer_kwargs=None, free_log_std=False, log_std_clip_param=20.0, vf_share_layers=True, use_lstm=False, max_seq_len=20, lstm_cell_size=256, lstm_use_prev_action=False, lstm_use_prev_reward=False, lstm_kernel_initializer=None, lstm_kernel_initializer_kwargs=None, lstm_bias_initializer=None, lstm_bias_initializer_kwargs=None), catalog_class=None, load_state_path=None, model_config_dict=None)", "algorithm_config_overrides_per_module": {}, "_per_module_overrides": {}, "_validate_config": true, "_use_msgpack_checkpoints": false, "_torch_grad_scaler_class": null, "_torch_lr_scheduler_classes": null, "_tf_policy_handles_more_than_one_loss": false, "_disable_preprocessor_api": false, "_disable_action_flattening": false, "_disable_initialize_loss_from_dummy_batch": false, "_dont_auto_sync_env_runner_states": false, "env_task_fn": -1, "enable_connectors": -1, "simple_optimizer": false, "policy_map_cache": -1, "worker_cls": -1, "synchronize_filters": -1, "enable_async_evaluation": -1, "custom_async_evaluation_function": -1, "_enable_rl_module_api": -1, "auto_wrap_old_gym_envs": -1, "always_attach_evaluation_results": -1, "replay_sequence_length": null, "_disable_execution_plan_api": -1, "use_critic": true, "use_gae": true, "use_kl_loss": true, "kl_coeff": 0.7464963036515, "kl_target": 0.0270990929592, "vf_loss_coeff": 0.6688075857018, "entropy_coeff": 0.0090570820258, "clip_param": 0.1221781641624, "vf_clip_param": 0.1027808522125, "entropy_coeff_schedule": null, "lr_schedule": null, "sgd_minibatch_size": -1, "vf_share_layers": -1, "__stdout_file__": null, "__stderr_file__": null, "lambda": 0.9099046732075, "input": "sampler", "policies": {"default_policy": [null, null, null, null]}, "callbacks": "<class 'ray.rllib.callbacks.callbacks.RLlibCallback'>", "create_env_on_driver": false, "custom_eval_function": null, "framework": "torch"}, "time_since_restore": 2.801922082901001, "iterations_since_restore": 1, "perf": {"cpu_util_percent": 57.879999999999995, "ram_util_percent": 76.28}}
{"timers": {"training_iteration": 2.6628357894183137, "restore_env_runners": 1.475586206652224e-05, "training_step": 2.662657579171937, "env_runner_sampling_timer": 2.5039681498683057, "learner_update_timer": 0.1556423639145214, "synch_weights": 0.0005820964940357953, "restore_eval_env_runners": 8.916947990655899e-06, "evaluation_iteration": 0.13499004195909947, "synch_eval_env_connectors": 0.00023345800582319498, "synch_env_connectors": 4.790956154465675e-06}, "env_runners": {"num_episodes": 250.0, "module_to_env_connector": {"timers": {"connectors": {"remove_single_ts_time_rank_from_batch": 8.496607897583366e-07, "listify_data_for_vector_env": 1.6974319338077134e-05, "get_actions": 6.548826232377426e-05, "tensor_to_numpy": 2.069607697785321e-05, "un_batch_to_individual_items": 7.856716506793564e-06, "normalize_and_clip_actions": 1.4149398860524344e-05}}, "connector_pipeline_timer": 0.00016340087466025892}, "episode_duration_sec_mean": 0.0070893708122894165, "env_to_module_sum_episodes_length_in": 10.36823839457432, "episode_return_min": -10.5, "episode_len_max": 20, "episode_len_mean": 20.0, "env_step_timer": 2.2547053038407734e-05, "num_agent_steps_sampled": {"default_agent": 5000.0}, "module_episode_returns_mean": {"default_policy": -1.3799999999999994}, "num_agent_steps_sampled_lifetime": {"default_agent": 10000.0}, "agent_episode_returns_mean": {"default_agent": -1.3799999999999994}, "weights_seq_no": 1.0, "env_to_module_connector": {"timers": {"connectors": {"add_observations_from_episodes_to_batch": 4.353794998308399e-06, "numpy_to_tensor": 1.420445721879466e-05, "add_states_from_episodes_to_batch": 2.3571999945731472e-06, "add_time_dim_to_batch_and_zero_pad": 3.630959970581172e-06, "batch_individual_items": 9.891399397850957e-06}}, "connector_pipeline_timer": 6.501883147364216e-05}, "sample": 0.009599061912388952, "num_module_steps_sampled_lifetime": {"default_policy": 10000.0}, "num_env_steps_sampled_lifetime": 10000.0, "episode_len_min": 20, "episode_return_max": 9.5, "num_episodes_lifetime": 500.0, "time_between_sampling": 0.002201399483799519, "num_module_steps_sampled": {"default_policy": 5000.0}, "env_reset_timer": 7.63590227912302e-05, "num_env_steps_sampled": 5000.0, "episode_return_mean": -1.3799999999999994, "rlmodule_inference_timer": 4.4320421132760076e-05, "env_to_module_sum_episodes_length_out": 10.36823839457432, "num_env_steps_sampled_lifetime_throughput": 2546.480897556656}, "learners": {"__all_modules__": {"num_trainable_parameters": 6003, "learner_connector": {"timers": {"connectors": {"add_time_dim_to_batch_and_zero_pad": 2.558008534833789e-05, "batch_individual_items": 0.03738354665925726, "add_states_from_episodes_to_batch": 7.470351411029697e-06, "general_advantage_estimation": 0.007601358554093167, "add_columns_from_episodes_to_train_batch": 0.05968265108065679, "numpy_to_tensor": 7.334899506531657e-05, "add_one_ts_to_episodes_and_truncate": 0.012970368904061617, "add_observations_from_episodes_to_batch": 0.0019825404102448373}}, "connector_pipeline_timer": 0.12000970717635936}, "learner_connector_sum_episodes_length_in": 5000.0, "num_module_steps_trained": 6000, "num_non_trainable_parameters": 0, "num_module_steps_trained_lifetime": 12000, "learner_connector_sum_episodes_length_out": 5250.0, "num_env_steps_trained_lifetime": 63000, "num_env_steps_trained": 31500, "num_env_steps_trained_lifetime_throughput": 1784363.8327646952, "num_module_steps_trained_throughput": 341474.9785007846, "num_module_steps_trained_lifetime_throughput": 340823.4200121614}, "default_policy": {"vf_loss_unclipped": 28.727876663208008, "total_loss": 0.05817184969782829, "entropy": 0.691680371761322, "num_trainable_parameters": 6003, "num_module_steps_trained_lifetime": 12000, "curr_kl_coeff": 0.18662407994270325, "vf_explained_var": -0.009900569915771484, "weights_seq_no": 2.0, "policy_loss": -0.00450977822765708, "num_module_steps_trained": 6000, "curr_entropy_coeff": 0.0090570820258, "mean_kl_loss": 0.0005508643225766718, "module_train_batch_size_mean": 1000.0, "vf_loss": 0.10278083384037018, "gradients_default_optimizer_global_norm": 0.09314917027950287, "default_optimizer_learning_rate": 0.0002847858517, "diff_num_grad_updates_vs_sampler_policy": 1.0, "num_module_steps_trained_lifetime_throughput": 342554.8841519893}}, "num_training_step_calls_per_iteration": 1, "evaluation": {"env_runners": {"weights_seq_no": 2.0, "num_env_steps_sampled_lifetime": 10400, "module_to_env_connector": {"timers": {"connectors": {"remove_single_ts_time_rank_from_batch": 6.992334709741452e-07, "listify_data_for_vector_env": 1.554566955264932e-05, "get_actions": 5.5278751970075565e-05, "un_batch_to_individual_items": 7.285592689767359e-06, "tensor_to_numpy": 1.81786921072327e-05, "normalize_and_clip_actions": 1.2235001927145467e-05}}, "connector_pipeline_timer": 0.0001426518463572196}, "module_episode_returns_mean": {"default_policy": 0.95}, "episode_return_mean": 0.95, "rlmodule_inference_timer": 4.085763267955061e-05, "episode_duration_sec_mean": 0.006106563549838029, "env_to_module_connector": {"timers": {"connectors": {"add_observations_from_episodes_to_batch": 3.569303528729356e-06, "add_time_dim_to_batch_and_zero_pad": 3.079227797941601e-06, "batch_individual_items": 8.93466649458765e-06, "add_states_from_episodes_to_batch": 1.8348346385764015e-06, "numpy_to_tensor": 1.2247631417250005e-05}}, "connector_pipeline_timer": 5.6317373147335835e-05}, "num_module_steps_sampled": {"default_policy": 400}, "episode_len_max": 20, "env_step_timer": 2.0305472211189377e-05, "sample": 0.12787535960320384, "agent_episode_returns_mean": {"default_agent": 0.95}, "env_reset_timer": 0.0003546782291959971, "env_to_module_sum_episodes_length_in": 10.366003441359926, "episode_len_mean": 20.0, "num_agent_steps_sampled": {"default_agent": 400}, "num_agent_steps_sampled_lifetime": {"default_agent": 800}, "num_env_steps_sampled": 400, "num_module_steps_sampled_lifetime": {"default_policy": 800}, "env_to_module_sum_episodes_length_out": 10.366003441359926, "num_episodes": 20, "episode_return_min": -12.5, "episode_len_min": 20, "episode_return_max": 13.5, "num_episodes_lifetime": 40, "time_between_sampling": 2.448291916050948}, "num_healthy_workers": 1, "actor_manager_num_outstanding_async_reqs": 0, "num_remote_worker_restarts": 0}, "num_env_steps_sampled_lifetime": 10000.0, "fault_tolerance": {"num_healthy_workers": 0, "num_remote_worker_restarts": 0}, "env_runner_group": {"actor_manager_num_outstanding_async_reqs": 0}, "done": false, "training_iteration": 2, "trial_id": "46920_00000", "date": "2025-08-11_19-35-25", "timestamp": 1754933725, "time_this_iter_s": 2.565980911254883, "time_total_s": 5.367902994155884, "pid": 27748, "hostname": "Mac", "node_ip": "127.0.0.1", "config": {"exploration_config": {}, "extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "placement_strategy": "PACK", "num_gpus": 0, "_fake_gpus": false, "num_cpus_for_main_process": 2, "eager_tracing": true, "eager_max_retraces": 20, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "torch_compile_learner": false, "torch_compile_learner_what_to_compile": "forward_train", "torch_compile_learner_dynamo_backend": "aot_eager", "torch_compile_learner_dynamo_mode": null, "torch_compile_worker": false, "torch_compile_worker_dynamo_backend": "aot_eager", "torch_compile_worker_dynamo_mode": null, "torch_ddp_kwargs": {}, "torch_skip_nan_gradients": false, "env": "Umbrella", "env_config": {}, "observation_space": null, "action_space": null, "clip_rewards": null, "normalize_actions": true, "clip_actions": false, "_is_atari": null, "disable_env_checking": false, "render_env": false, "action_mask_key": "action_mask", "env_runner_cls": null, "num_env_runners": 0, "create_local_env_runner": true, "num_envs_per_env_runner": 1, "gym_env_vectorize_mode": "SYNC", "num_cpus_per_env_runner": 1, "num_gpus_per_env_runner": 0, "custom_resources_per_env_runner": {}, "validate_env_runners_after_construction": true, "episodes_to_numpy": true, "max_requests_in_flight_per_env_runner": 1, "sample_timeout_s": 60.0, "_env_to_module_connector": null, "add_default_connectors_to_env_to_module_pipeline": true, "_module_to_env_connector": null, "add_default_connectors_to_module_to_env_pipeline": true, "merge_env_runner_states": "training_only", "broadcast_env_runner_states": true, "episode_lookback_horizon": 1, "rollout_fragment_length": "auto", "batch_mode": "complete_episodes", "compress_observations": false, "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "enable_tf1_exec_eagerly": false, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "preprocessor_pref": "deepmind", "observation_filter": "NoFilter", "update_worker_filter_stats": true, "use_worker_filter_stats": true, "sampler_perf_stats_ema_coef": null, "_is_online": true, "num_learners": 0, "num_gpus_per_learner": 0, "num_cpus_per_learner": "auto", "num_aggregator_actors_per_learner": 0, "max_requests_in_flight_per_aggregator_actor": 3, "local_gpu_idx": 0, "max_requests_in_flight_per_learner": 3, "gamma": 1, "lr": 0.0002847858517, "grad_clip": 0.5, "grad_clip_by": "global_norm", "_train_batch_size_per_learner": 5000, "train_batch_size": 4000, "num_epochs": 1, "minibatch_size": 1000, "shuffle_batch_per_epoch": true, "model": {"fcnet_hiddens": [256, 256], "fcnet_activation": "tanh", "fcnet_weights_initializer": null, "fcnet_weights_initializer_config": null, "fcnet_bias_initializer": null, "fcnet_bias_initializer_config": null, "conv_filters": null, "conv_activation": "relu", "conv_kernel_initializer": null, "conv_kernel_initializer_config": null, "conv_bias_initializer": null, "conv_bias_initializer_config": null, "conv_transpose_kernel_initializer": null, "conv_transpose_kernel_initializer_config": null, "conv_transpose_bias_initializer": null, "conv_transpose_bias_initializer_config": null, "post_fcnet_hiddens": [], "post_fcnet_activation": "relu", "post_fcnet_weights_initializer": null, "post_fcnet_weights_initializer_config": null, "post_fcnet_bias_initializer": null, "post_fcnet_bias_initializer_config": null, "free_log_std": false, "log_std_clip_param": 20.0, "no_final_linear": false, "vf_share_layers": false, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "lstm_weights_initializer": null, "lstm_weights_initializer_config": null, "lstm_bias_initializer": null, "lstm_bias_initializer_config": null, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "attention_use_n_prev_actions": 0, "attention_use_n_prev_rewards": 0, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": null, "custom_model_config": {}, "custom_action_dist": null, "custom_preprocessor": null, "encoder_latent_dim": null, "always_check_shapes": false, "lstm_use_prev_action_reward": -1, "_use_default_native_models": -1, "_disable_preprocessor_api": false, "_disable_action_flattening": false}, "_learner_connector": null, "add_default_connectors_to_learner_pipeline": true, "learner_config_dict": {}, "optimizer": {}, "_learner_class": null, "callbacks_on_algorithm_init": null, "callbacks_on_env_runners_recreated": null, "callbacks_on_offline_eval_runners_recreated": null, "callbacks_on_checkpoint_loaded": null, "callbacks_on_environment_created": null, "callbacks_on_episode_created": null, "callbacks_on_episode_start": null, "callbacks_on_episode_step": null, "callbacks_on_episode_end": null, "callbacks_on_evaluate_start": null, "callbacks_on_evaluate_end": null, "callbacks_on_evaluate_offline_start": null, "callbacks_on_evaluate_offline_end": null, "callbacks_on_sample_end": null, "callbacks_on_train_result": null, "explore": true, "enable_rl_module_and_learner": true, "enable_env_runner_and_connector_v2": true, "_prior_exploration_config": {"type": "StochasticSampling"}, "count_steps_by": "env_steps", "policy_map_capacity": 100, "policy_mapping_fn": "<function AlgorithmConfig.DEFAULT_POLICY_MAPPING_FN at 0x3847e9b20>", "policies_to_train": null, "policy_states_are_swappable": false, "observation_fn": null, "offline_data_class": null, "input_read_method": "read_parquet", "input_read_method_kwargs": {}, "input_read_schema": {}, "input_read_episodes": false, "input_read_sample_batches": false, "input_read_batch_size": null, "input_filesystem": null, "input_filesystem_kwargs": {}, "input_compress_columns": ["obs", "new_obs"], "input_spaces_jsonable": true, "materialize_data": false, "materialize_mapped_data": true, "map_batches_kwargs": {}, "iter_batches_kwargs": {}, "ignore_final_observation": false, "prelearner_class": null, "prelearner_buffer_class": null, "prelearner_buffer_kwargs": {}, "prelearner_module_synch_period": 10, "dataset_num_iters_per_learner": null, "input_config": {}, "actions_in_input_normalized": false, "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_config": {}, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "output_max_rows_per_file": null, "output_write_remaining_data": false, "output_write_method": "write_parquet", "output_write_method_kwargs": {}, "output_filesystem": null, "output_filesystem_kwargs": {}, "output_write_episodes": true, "offline_sampling": false, "evaluation_interval": 1, "evaluation_duration": 20, "evaluation_duration_unit": "episodes", "evaluation_sample_timeout_s": 120.0, "evaluation_auto_duration_min_env_steps_per_sample": 100, "evaluation_auto_duration_max_env_steps_per_sample": 2000, "evaluation_parallel_to_training": false, "evaluation_force_reset_envs_before_iteration": true, "evaluation_config": null, "off_policy_estimation_methods": {}, "ope_split_batch_by_episode": true, "evaluation_num_env_runners": 1, "in_evaluation": false, "sync_filters_on_rollout_workers_timeout_s": 10.0, "offline_evaluation_interval": null, "num_offline_eval_runners": 0, "offline_loss_for_module_fn": null, "offline_evaluation_duration": 1, "offline_evaluation_parallel_to_training": false, "offline_evaluation_timeout_s": 120.0, "num_cpus_per_offline_eval_runner": 1, "num_gpus_per_offline_eval_runner": 0, "custom_resources_per_offline_eval_runner": {}, "restart_failed_offline_eval_runners": true, "ignore_offline_eval_runner_failures": false, "max_num_offline_eval_runner_restarts": 1000, "offline_eval_runner_restore_timeout_s": 1800.0, "max_requests_in_flight_per_offline_eval_runner": 1, "validate_offline_eval_runners_after_construction": true, "offline_eval_runner_health_probe_timeout_s": 30.0, "offline_eval_rl_module_inference_only": false, "broadcast_offline_eval_runner_states": false, "offline_eval_batch_size_per_runner": 256, "dataset_num_iters_per_eval_runner": 1, "keep_per_episode_custom_metrics": false, "metrics_episode_collection_timeout_s": 60.0, "metrics_num_episodes_for_smoothing": 100, "min_time_s_per_iteration": null, "min_train_timesteps_per_iteration": 0, "min_sample_timesteps_per_iteration": 0, "log_gradients": true, "export_native_model_files": false, "checkpoint_trainable_policies_only": false, "logger_creator": null, "logger_config": null, "log_level": "WARN", "log_sys_usage": true, "fake_sampler": false, "seed": 10, "restart_failed_env_runners": true, "ignore_env_runner_failures": false, "max_num_env_runner_restarts": 1000, "delay_between_env_runner_restarts_s": 60.0, "restart_failed_sub_environments": false, "num_consecutive_env_runner_failures_tolerance": 100, "env_runner_health_probe_timeout_s": 30.0, "env_runner_restore_timeout_s": 1800.0, "_model_config": {}, "_rl_module_spec": "RLModuleSpec(module_class=None, observation_space=None, action_space=None, inference_only=False, learner_only=False, model_config=DefaultModelConfig(fcnet_hiddens=[60, 90], fcnet_activation='tanh', fcnet_kernel_initializer=None, fcnet_kernel_initializer_kwargs=None, fcnet_bias_initializer=None, fcnet_bias_initializer_kwargs=None, conv_filters=None, conv_activation='relu', conv_kernel_initializer=None, conv_kernel_initializer_kwargs=None, conv_bias_initializer=None, conv_bias_initializer_kwargs=None, head_fcnet_hiddens=[], head_fcnet_activation='relu', head_fcnet_kernel_initializer=None, head_fcnet_kernel_initializer_kwargs=None, head_fcnet_bias_initializer=None, head_fcnet_bias_initializer_kwargs=None, free_log_std=False, log_std_clip_param=20.0, vf_share_layers=True, use_lstm=False, max_seq_len=20, lstm_cell_size=256, lstm_use_prev_action=False, lstm_use_prev_reward=False, lstm_kernel_initializer=None, lstm_kernel_initializer_kwargs=None, lstm_bias_initializer=None, lstm_bias_initializer_kwargs=None), catalog_class=None, load_state_path=None, model_config_dict=None)", "algorithm_config_overrides_per_module": {}, "_per_module_overrides": {}, "_validate_config": true, "_use_msgpack_checkpoints": false, "_torch_grad_scaler_class": null, "_torch_lr_scheduler_classes": null, "_tf_policy_handles_more_than_one_loss": false, "_disable_preprocessor_api": false, "_disable_action_flattening": false, "_disable_initialize_loss_from_dummy_batch": false, "_dont_auto_sync_env_runner_states": false, "env_task_fn": -1, "enable_connectors": -1, "simple_optimizer": false, "policy_map_cache": -1, "worker_cls": -1, "synchronize_filters": -1, "enable_async_evaluation": -1, "custom_async_evaluation_function": -1, "_enable_rl_module_api": -1, "auto_wrap_old_gym_envs": -1, "always_attach_evaluation_results": -1, "replay_sequence_length": null, "_disable_execution_plan_api": -1, "use_critic": true, "use_gae": true, "use_kl_loss": true, "kl_coeff": 0.7464963036515, "kl_target": 0.0270990929592, "vf_loss_coeff": 0.6688075857018, "entropy_coeff": 0.0090570820258, "clip_param": 0.1221781641624, "vf_clip_param": 0.1027808522125, "entropy_coeff_schedule": null, "lr_schedule": null, "sgd_minibatch_size": -1, "vf_share_layers": -1, "__stdout_file__": null, "__stderr_file__": null, "lambda": 0.9099046732075, "input": "sampler", "policies": {"default_policy": [null, null, null, null]}, "callbacks": "<class 'ray.rllib.callbacks.callbacks.RLlibCallback'>", "create_env_on_driver": false, "custom_eval_function": null, "framework": "torch"}, "time_since_restore": 5.367902994155884, "iterations_since_restore": 2, "perf": {"cpu_util_percent": 66.3, "ram_util_percent": 75.36666666666667}}
{"timers": {"training_iteration": 2.6590742715246276, "restore_env_runners": 1.4676642732229084e-05, "training_step": 2.6588958696299465, "env_runner_sampling_timer": 2.500399761279323, "learner_update_timer": 0.15544401736607544, "synch_weights": 0.0005825430285069159, "restore_eval_env_runners": 8.91860807314515e-06, "evaluation_iteration": 0.13509101320873015, "synch_eval_env_connectors": 0.0002324705058708787, "synch_env_connectors": 4.789717495441437e-06}, "env_runners": {"num_episodes": 250.0, "module_to_env_connector": {"timers": {"connectors": {"remove_single_ts_time_rank_from_batch": 9.199277994809325e-07, "listify_data_for_vector_env": 1.6940160772120037e-05, "get_actions": 6.592769173020291e-05, "tensor_to_numpy": 2.0901670299144523e-05, "un_batch_to_individual_items": 8.18761424669336e-06, "normalize_and_clip_actions": 1.4127676463572036e-05}}, "connector_pipeline_timer": 0.00016445707050918168}, "episode_duration_sec_mean": 0.007119892474263908, "env_to_module_sum_episodes_length_in": 10.36823839457432, "episode_return_min": -10.5, "episode_len_max": 20, "episode_len_mean": 20.0, "env_step_timer": 2.2573496440584332e-05, "num_agent_steps_sampled": {"default_agent": 5000.0}, "module_episode_returns_mean": {"default_policy": -1.1400000000000001}, "num_agent_steps_sampled_lifetime": {"default_agent": -607500.0}, "agent_episode_returns_mean": {"default_agent": -1.1400000000000001}, "weights_seq_no": 2.0, "env_to_module_connector": {"timers": {"connectors": {"add_observations_from_episodes_to_batch": 4.364360086892636e-06, "numpy_to_tensor": 1.4022410024597578e-05, "add_states_from_episodes_to_batch": 2.5003279596671125e-06, "add_time_dim_to_batch_and_zero_pad": 3.6510250076963767e-06, "batch_individual_items": 1.012646517316471e-05}}, "connector_pipeline_timer": 6.546455348059989e-05}, "sample": 0.00782080666131456, "num_module_steps_sampled_lifetime": {"default_policy": -607500.0}, "num_env_steps_sampled_lifetime": -607500.0, "episode_len_min": 20, "episode_return_max": 9.5, "num_episodes_lifetime": -30375.0, "time_between_sampling": 0.002622928943502774, "num_module_steps_sampled": {"default_policy": 5000.0}, "env_reset_timer": 6.814090214438207e-05, "num_env_steps_sampled": 5000.0, "episode_return_mean": -1.1400000000000001, "rlmodule_inference_timer": 4.412476172480389e-05, "env_to_module_sum_episodes_length_out": 10.36823839457432, "num_env_steps_sampled_lifetime_throughput": 2567.2339374725243}, "learners": {"__all_modules__": {"num_trainable_parameters": 6003, "learner_connector": {"timers": {"connectors": {"add_time_dim_to_batch_and_zero_pad": 2.5464284396730363e-05, "batch_individual_items": 0.03737491286287549, "add_states_from_episodes_to_batch": 7.436068460810929e-06, "general_advantage_estimation": 0.007603105388360564, "add_columns_from_episodes_to_train_batch": 0.05960899665013421, "numpy_to_tensor": 7.33159144059755e-05, "add_one_ts_to_episodes_and_truncate": 0.01299702480491251, "add_observations_from_episodes_to_batch": 0.0019766375056351534}}, "connector_pipeline_timer": 0.11994848177413223}, "learner_connector_sum_episodes_length_in": 5000.0, "num_module_steps_trained": 6000, "num_non_trainable_parameters": 0, "num_module_steps_trained_lifetime": 18000, "learner_connector_sum_episodes_length_out": 5250.0, "num_env_steps_trained_lifetime": 94500, "num_env_steps_trained": 31500, "num_env_steps_trained_lifetime_throughput": 1771833.911906322, "num_module_steps_trained_throughput": 339052.3827991155, "num_module_steps_trained_lifetime_throughput": 338415.9225864442}, "default_policy": {"vf_loss_unclipped": 28.677812576293945, "total_loss": 0.05550922453403473, "entropy": 0.6914566159248352, "num_trainable_parameters": 6003, "num_module_steps_trained_lifetime": 18000, "curr_kl_coeff": 0.09331203997135162, "vf_explained_var": -0.010045528411865234, "weights_seq_no": 3.0, "policy_loss": -0.007170871365815401, "num_module_steps_trained": 6000, "curr_entropy_coeff": 0.0090570820258, "mean_kl_loss": 0.0010828013764694333, "module_train_batch_size_mean": 1000.0, "vf_loss": 0.10278083384037018, "gradients_default_optimizer_global_norm": 0.03816163167357445, "default_optimizer_learning_rate": 0.0002847858517, "diff_num_grad_updates_vs_sampler_policy": 1.0, "num_module_steps_trained_lifetime_throughput": 340096.2921372594}}, "num_training_step_calls_per_iteration": 1, "evaluation": {"env_runners": {"weights_seq_no": 3.0, "num_env_steps_sampled_lifetime": 15400, "module_to_env_connector": {"timers": {"connectors": {"remove_single_ts_time_rank_from_batch": 6.950092473516428e-07, "listify_data_for_vector_env": 1.6197370588569795e-05, "get_actions": 6.636721742745551e-05, "un_batch_to_individual_items": 8.55624436558367e-06, "tensor_to_numpy": 1.983095403919862e-05, "normalize_and_clip_actions": 1.5177061971447312e-05}}, "connector_pipeline_timer": 0.00016061601220530687}, "module_episode_returns_mean": {"default_policy": -0.55}, "episode_return_mean": -0.55, "rlmodule_inference_timer": 4.4800207452728855e-05, "episode_duration_sec_mean": 0.0060198062681593, "env_to_module_connector": {"timers": {"connectors": {"add_observations_from_episodes_to_batch": 3.5088382909386272e-06, "add_time_dim_to_batch_and_zero_pad": 3.238496653555995e-06, "batch_individual_items": 1.236210242757065e-05, "add_states_from_episodes_to_batch": 2.293245875654373e-06, "numpy_to_tensor": 1.2709376967697041e-05}}, "connector_pipeline_timer": 6.215174004444811e-05}, "num_module_steps_sampled": {"default_policy": 400}, "episode_len_max": 20, "env_step_timer": 2.1098209272073158e-05, "sample": 0.1278774610081222, "agent_episode_returns_mean": {"default_agent": -0.55}, "env_reset_timer": 0.0003535514467046596, "env_to_module_sum_episodes_length_in": 10.368205581254823, "episode_len_mean": 20.0, "num_agent_steps_sampled": {"default_agent": 400}, "num_agent_steps_sampled_lifetime": {"default_agent": 1200}, "num_env_steps_sampled": 400, "num_module_steps_sampled_lifetime": {"default_policy": 1200}, "env_to_module_sum_episodes_length_out": 10.368205581254823, "num_episodes": 20, "episode_return_min": -14.5, "episode_len_min": 20, "episode_return_max": 13.5, "num_episodes_lifetime": 60, "time_between_sampling": 2.4468747202202215}, "num_healthy_workers": 1, "actor_manager_num_outstanding_async_reqs": 0, "num_remote_worker_restarts": 0}, "num_env_steps_sampled_lifetime": -607500.0, "fault_tolerance": {"num_healthy_workers": 0, "num_remote_worker_restarts": 0}, "env_runner_group": {"actor_manager_num_outstanding_async_reqs": 0}, "done": false, "training_iteration": 3, "trial_id": "46920_00000", "date": "2025-08-11_19-35-27", "timestamp": 1754933727, "time_this_iter_s": 2.4246459007263184, "time_total_s": 7.792548894882202, "pid": 27748, "hostname": "Mac", "node_ip": "127.0.0.1", "config": {"exploration_config": {}, "extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "placement_strategy": "PACK", "num_gpus": 0, "_fake_gpus": false, "num_cpus_for_main_process": 2, "eager_tracing": true, "eager_max_retraces": 20, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "torch_compile_learner": false, "torch_compile_learner_what_to_compile": "forward_train", "torch_compile_learner_dynamo_backend": "aot_eager", "torch_compile_learner_dynamo_mode": null, "torch_compile_worker": false, "torch_compile_worker_dynamo_backend": "aot_eager", "torch_compile_worker_dynamo_mode": null, "torch_ddp_kwargs": {}, "torch_skip_nan_gradients": false, "env": "Umbrella", "env_config": {}, "observation_space": null, "action_space": null, "clip_rewards": null, "normalize_actions": true, "clip_actions": false, "_is_atari": null, "disable_env_checking": false, "render_env": false, "action_mask_key": "action_mask", "env_runner_cls": null, "num_env_runners": 0, "create_local_env_runner": true, "num_envs_per_env_runner": 1, "gym_env_vectorize_mode": "SYNC", "num_cpus_per_env_runner": 1, "num_gpus_per_env_runner": 0, "custom_resources_per_env_runner": {}, "validate_env_runners_after_construction": true, "episodes_to_numpy": true, "max_requests_in_flight_per_env_runner": 1, "sample_timeout_s": 60.0, "_env_to_module_connector": null, "add_default_connectors_to_env_to_module_pipeline": true, "_module_to_env_connector": null, "add_default_connectors_to_module_to_env_pipeline": true, "merge_env_runner_states": "training_only", "broadcast_env_runner_states": true, "episode_lookback_horizon": 1, "rollout_fragment_length": "auto", "batch_mode": "complete_episodes", "compress_observations": false, "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "enable_tf1_exec_eagerly": false, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "preprocessor_pref": "deepmind", "observation_filter": "NoFilter", "update_worker_filter_stats": true, "use_worker_filter_stats": true, "sampler_perf_stats_ema_coef": null, "_is_online": true, "num_learners": 0, "num_gpus_per_learner": 0, "num_cpus_per_learner": "auto", "num_aggregator_actors_per_learner": 0, "max_requests_in_flight_per_aggregator_actor": 3, "local_gpu_idx": 0, "max_requests_in_flight_per_learner": 3, "gamma": 1, "lr": 0.0002847858517, "grad_clip": 0.5, "grad_clip_by": "global_norm", "_train_batch_size_per_learner": 5000, "train_batch_size": 4000, "num_epochs": 1, "minibatch_size": 1000, "shuffle_batch_per_epoch": true, "model": {"fcnet_hiddens": [256, 256], "fcnet_activation": "tanh", "fcnet_weights_initializer": null, "fcnet_weights_initializer_config": null, "fcnet_bias_initializer": null, "fcnet_bias_initializer_config": null, "conv_filters": null, "conv_activation": "relu", "conv_kernel_initializer": null, "conv_kernel_initializer_config": null, "conv_bias_initializer": null, "conv_bias_initializer_config": null, "conv_transpose_kernel_initializer": null, "conv_transpose_kernel_initializer_config": null, "conv_transpose_bias_initializer": null, "conv_transpose_bias_initializer_config": null, "post_fcnet_hiddens": [], "post_fcnet_activation": "relu", "post_fcnet_weights_initializer": null, "post_fcnet_weights_initializer_config": null, "post_fcnet_bias_initializer": null, "post_fcnet_bias_initializer_config": null, "free_log_std": false, "log_std_clip_param": 20.0, "no_final_linear": false, "vf_share_layers": false, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "lstm_weights_initializer": null, "lstm_weights_initializer_config": null, "lstm_bias_initializer": null, "lstm_bias_initializer_config": null, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "attention_use_n_prev_actions": 0, "attention_use_n_prev_rewards": 0, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": null, "custom_model_config": {}, "custom_action_dist": null, "custom_preprocessor": null, "encoder_latent_dim": null, "always_check_shapes": false, "lstm_use_prev_action_reward": -1, "_use_default_native_models": -1, "_disable_preprocessor_api": false, "_disable_action_flattening": false}, "_learner_connector": null, "add_default_connectors_to_learner_pipeline": true, "learner_config_dict": {}, "optimizer": {}, "_learner_class": null, "callbacks_on_algorithm_init": null, "callbacks_on_env_runners_recreated": null, "callbacks_on_offline_eval_runners_recreated": null, "callbacks_on_checkpoint_loaded": null, "callbacks_on_environment_created": null, "callbacks_on_episode_created": null, "callbacks_on_episode_start": null, "callbacks_on_episode_step": null, "callbacks_on_episode_end": null, "callbacks_on_evaluate_start": null, "callbacks_on_evaluate_end": null, "callbacks_on_evaluate_offline_start": null, "callbacks_on_evaluate_offline_end": null, "callbacks_on_sample_end": null, "callbacks_on_train_result": null, "explore": true, "enable_rl_module_and_learner": true, "enable_env_runner_and_connector_v2": true, "_prior_exploration_config": {"type": "StochasticSampling"}, "count_steps_by": "env_steps", "policy_map_capacity": 100, "policy_mapping_fn": "<function AlgorithmConfig.DEFAULT_POLICY_MAPPING_FN at 0x3847e9b20>", "policies_to_train": null, "policy_states_are_swappable": false, "observation_fn": null, "offline_data_class": null, "input_read_method": "read_parquet", "input_read_method_kwargs": {}, "input_read_schema": {}, "input_read_episodes": false, "input_read_sample_batches": false, "input_read_batch_size": null, "input_filesystem": null, "input_filesystem_kwargs": {}, "input_compress_columns": ["obs", "new_obs"], "input_spaces_jsonable": true, "materialize_data": false, "materialize_mapped_data": true, "map_batches_kwargs": {}, "iter_batches_kwargs": {}, "ignore_final_observation": false, "prelearner_class": null, "prelearner_buffer_class": null, "prelearner_buffer_kwargs": {}, "prelearner_module_synch_period": 10, "dataset_num_iters_per_learner": null, "input_config": {}, "actions_in_input_normalized": false, "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_config": {}, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "output_max_rows_per_file": null, "output_write_remaining_data": false, "output_write_method": "write_parquet", "output_write_method_kwargs": {}, "output_filesystem": null, "output_filesystem_kwargs": {}, "output_write_episodes": true, "offline_sampling": false, "evaluation_interval": 1, "evaluation_duration": 20, "evaluation_duration_unit": "episodes", "evaluation_sample_timeout_s": 120.0, "evaluation_auto_duration_min_env_steps_per_sample": 100, "evaluation_auto_duration_max_env_steps_per_sample": 2000, "evaluation_parallel_to_training": false, "evaluation_force_reset_envs_before_iteration": true, "evaluation_config": null, "off_policy_estimation_methods": {}, "ope_split_batch_by_episode": true, "evaluation_num_env_runners": 1, "in_evaluation": false, "sync_filters_on_rollout_workers_timeout_s": 10.0, "offline_evaluation_interval": null, "num_offline_eval_runners": 0, "offline_loss_for_module_fn": null, "offline_evaluation_duration": 1, "offline_evaluation_parallel_to_training": false, "offline_evaluation_timeout_s": 120.0, "num_cpus_per_offline_eval_runner": 1, "num_gpus_per_offline_eval_runner": 0, "custom_resources_per_offline_eval_runner": {}, "restart_failed_offline_eval_runners": true, "ignore_offline_eval_runner_failures": false, "max_num_offline_eval_runner_restarts": 1000, "offline_eval_runner_restore_timeout_s": 1800.0, "max_requests_in_flight_per_offline_eval_runner": 1, "validate_offline_eval_runners_after_construction": true, "offline_eval_runner_health_probe_timeout_s": 30.0, "offline_eval_rl_module_inference_only": false, "broadcast_offline_eval_runner_states": false, "offline_eval_batch_size_per_runner": 256, "dataset_num_iters_per_eval_runner": 1, "keep_per_episode_custom_metrics": false, "metrics_episode_collection_timeout_s": 60.0, "metrics_num_episodes_for_smoothing": 100, "min_time_s_per_iteration": null, "min_train_timesteps_per_iteration": 0, "min_sample_timesteps_per_iteration": 0, "log_gradients": true, "export_native_model_files": false, "checkpoint_trainable_policies_only": false, "logger_creator": null, "logger_config": null, "log_level": "WARN", "log_sys_usage": true, "fake_sampler": false, "seed": 10, "restart_failed_env_runners": true, "ignore_env_runner_failures": false, "max_num_env_runner_restarts": 1000, "delay_between_env_runner_restarts_s": 60.0, "restart_failed_sub_environments": false, "num_consecutive_env_runner_failures_tolerance": 100, "env_runner_health_probe_timeout_s": 30.0, "env_runner_restore_timeout_s": 1800.0, "_model_config": {}, "_rl_module_spec": "RLModuleSpec(module_class=None, observation_space=None, action_space=None, inference_only=False, learner_only=False, model_config=DefaultModelConfig(fcnet_hiddens=[60, 90], fcnet_activation='tanh', fcnet_kernel_initializer=None, fcnet_kernel_initializer_kwargs=None, fcnet_bias_initializer=None, fcnet_bias_initializer_kwargs=None, conv_filters=None, conv_activation='relu', conv_kernel_initializer=None, conv_kernel_initializer_kwargs=None, conv_bias_initializer=None, conv_bias_initializer_kwargs=None, head_fcnet_hiddens=[], head_fcnet_activation='relu', head_fcnet_kernel_initializer=None, head_fcnet_kernel_initializer_kwargs=None, head_fcnet_bias_initializer=None, head_fcnet_bias_initializer_kwargs=None, free_log_std=False, log_std_clip_param=20.0, vf_share_layers=True, use_lstm=False, max_seq_len=20, lstm_cell_size=256, lstm_use_prev_action=False, lstm_use_prev_reward=False, lstm_kernel_initializer=None, lstm_kernel_initializer_kwargs=None, lstm_bias_initializer=None, lstm_bias_initializer_kwargs=None), catalog_class=None, load_state_path=None, model_config_dict=None)", "algorithm_config_overrides_per_module": {}, "_per_module_overrides": {}, "_validate_config": true, "_use_msgpack_checkpoints": false, "_torch_grad_scaler_class": null, "_torch_lr_scheduler_classes": null, "_tf_policy_handles_more_than_one_loss": false, "_disable_preprocessor_api": false, "_disable_action_flattening": false, "_disable_initialize_loss_from_dummy_batch": false, "_dont_auto_sync_env_runner_states": false, "env_task_fn": -1, "enable_connectors": -1, "simple_optimizer": false, "policy_map_cache": -1, "worker_cls": -1, "synchronize_filters": -1, "enable_async_evaluation": -1, "custom_async_evaluation_function": -1, "_enable_rl_module_api": -1, "auto_wrap_old_gym_envs": -1, "always_attach_evaluation_results": -1, "replay_sequence_length": null, "_disable_execution_plan_api": -1, "use_critic": true, "use_gae": true, "use_kl_loss": true, "kl_coeff": 0.7464963036515, "kl_target": 0.0270990929592, "vf_loss_coeff": 0.6688075857018, "entropy_coeff": 0.0090570820258, "clip_param": 0.1221781641624, "vf_clip_param": 0.1027808522125, "entropy_coeff_schedule": null, "lr_schedule": null, "sgd_minibatch_size": -1, "vf_share_layers": -1, "__stdout_file__": null, "__stderr_file__": null, "lambda": 0.9099046732075, "input": "sampler", "policies": {"default_policy": [null, null, null, null]}, "callbacks": "<class 'ray.rllib.callbacks.callbacks.RLlibCallback'>", "create_env_on_driver": false, "custom_eval_function": null, "framework": "torch"}, "time_since_restore": 7.792548894882202, "iterations_since_restore": 3, "perf": {"cpu_util_percent": 66.55000000000001, "ram_util_percent": 75.5}}
{"timers": {"training_iteration": 2.6571181508898656, "restore_env_runners": 1.4608626613509842e-05, "training_step": 2.656938617603108, "env_runner_sampling_timer": 2.4986328157467512, "learner_update_timer": 0.15519124927271358, "synch_weights": 0.0005934305077862226, "restore_eval_env_runners": 8.954011998139322e-06, "evaluation_iteration": 0.13509470765661682, "synch_eval_env_connectors": 0.00023113955110311507, "synch_env_connectors": 4.791400441899895e-06}, "env_runners": {"num_episodes": 250.0, "module_to_env_connector": {"timers": {"connectors": {"remove_single_ts_time_rank_from_batch": 9.099030991317878e-07, "listify_data_for_vector_env": 1.6972859213051716e-05, "get_actions": 6.843365669880436e-05, "tensor_to_numpy": 2.118575659143682e-05, "un_batch_to_individual_items": 9.044944626898636e-06, "normalize_and_clip_actions": 1.4537818948838312e-05}}, "connector_pipeline_timer": 0.00016965140625038112}, "episode_duration_sec_mean": 0.007336305989418177, "env_to_module_sum_episodes_length_in": 10.36823839457432, "episode_return_min": -10.5, "episode_len_max": 20, "episode_len_mean": 20.0, "env_step_timer": 2.2980794447250756e-05, "num_agent_steps_sampled": {"default_agent": 5000.0}, "module_episode_returns_mean": {"default_policy": -0.3400000000000001}, "num_agent_steps_sampled_lifetime": {"default_agent": -1225000.0}, "agent_episode_returns_mean": {"default_agent": -0.3400000000000001}, "weights_seq_no": 3.0, "env_to_module_connector": {"timers": {"connectors": {"add_observations_from_episodes_to_batch": 4.655530347611126e-06, "numpy_to_tensor": 1.481209172903166e-05, "add_states_from_episodes_to_batch": 2.4004856199058295e-06, "add_time_dim_to_batch_and_zero_pad": 3.533050843146828e-06, "batch_individual_items": 1.0223007556384692e-05}}, "connector_pipeline_timer": 6.668918616295811e-05}, "sample": 0.007778800858624278, "num_module_steps_sampled_lifetime": {"default_policy": -1225000.0}, "num_env_steps_sampled_lifetime": -1225000.0, "episode_len_min": 20, "episode_return_max": 9.5, "num_episodes_lifetime": -61250.0, "time_between_sampling": 0.00253520990897197, "num_module_steps_sampled": {"default_policy": 5000.0}, "env_reset_timer": 7.116134608009484e-05, "num_env_steps_sampled": 5000.0, "episode_return_mean": -0.3400000000000001, "rlmodule_inference_timer": 4.6522613777981835e-05, "env_to_module_sum_episodes_length_out": 10.36823839457432, "num_env_steps_sampled_lifetime_throughput": 2524.4020076181455}, "learners": {"__all_modules__": {"num_trainable_parameters": 6003, "learner_connector": {"timers": {"connectors": {"add_time_dim_to_batch_and_zero_pad": 2.533339103986509e-05, "batch_individual_items": 0.03735947040434251, "add_states_from_episodes_to_batch": 7.406287859543227e-06, "general_advantage_estimation": 0.007616889335014741, "add_columns_from_episodes_to_train_batch": 0.059379124183464554, "numpy_to_tensor": 7.697817522648257e-05, "add_one_ts_to_episodes_and_truncate": 0.01295513330669515, "add_observations_from_episodes_to_batch": 0.001965708630933077}}, "connector_pipeline_timer": 0.11966608778585272}, "learner_connector_sum_episodes_length_in": 5000.0, "num_module_steps_trained": 6000, "num_non_trainable_parameters": 0, "num_module_steps_trained_lifetime": 24000, "learner_connector_sum_episodes_length_out": 5250.0, "num_env_steps_trained_lifetime": 126000, "num_env_steps_trained": 31500, "num_env_steps_trained_lifetime_throughput": 1749150.5360712297, "num_module_steps_trained_throughput": 334690.3152408686, "num_module_steps_trained_lifetime_throughput": 334070.72762272635}, "default_policy": {"vf_loss_unclipped": 28.70688247680664, "total_loss": 0.10854453593492508, "entropy": 0.6889801025390625, "num_trainable_parameters": 6003, "num_module_steps_trained_lifetime": 24000, "curr_kl_coeff": 0.04665601998567581, "vf_explained_var": -0.010156989097595215, "weights_seq_no": 4.0, "policy_loss": 0.04596720635890961, "num_module_steps_trained": 6000, "curr_entropy_coeff": 0.0090570820258, "mean_kl_loss": 0.0008237484726123512, "module_train_batch_size_mean": 1000.0, "vf_loss": 0.10278083384037018, "gradients_default_optimizer_global_norm": 0.021336890757083893, "default_optimizer_learning_rate": 0.0002847858517, "diff_num_grad_updates_vs_sampler_policy": 1.0, "num_module_steps_trained_lifetime_throughput": 335697.4152150051}}, "num_training_step_calls_per_iteration": 1, "evaluation": {"env_runners": {"weights_seq_no": 4.0, "num_env_steps_sampled_lifetime": 20400, "module_to_env_connector": {"timers": {"connectors": {"remove_single_ts_time_rank_from_batch": 9.46486862193439e-07, "listify_data_for_vector_env": 1.8304773349608804e-05, "get_actions": 7.389061838244377e-05, "un_batch_to_individual_items": 8.228416480491165e-06, "tensor_to_numpy": 2.4587011469303104e-05, "normalize_and_clip_actions": 1.6946102314600128e-05}}, "connector_pipeline_timer": 0.0001855997340182176}, "module_episode_returns_mean": {"default_policy": -0.55}, "episode_return_mean": -0.55, "rlmodule_inference_timer": 5.6236151123556345e-05, "episode_duration_sec_mean": 0.006605016726825852, "env_to_module_connector": {"timers": {"connectors": {"add_observations_from_episodes_to_batch": 4.535858953006707e-06, "add_time_dim_to_batch_and_zero_pad": 4.0673894957729785e-06, "batch_individual_items": 1.1598412218355187e-05, "add_states_from_episodes_to_batch": 2.6181017819036596e-06, "numpy_to_tensor": 1.7549594591894744e-05}}, "connector_pipeline_timer": 7.335040695172699e-05}, "num_module_steps_sampled": {"default_policy": 400}, "episode_len_max": 20, "env_step_timer": 2.5749644187774863e-05, "sample": 0.12843739556873823, "agent_episode_returns_mean": {"default_agent": -0.55}, "env_reset_timer": 0.0003526880224327324, "env_to_module_sum_episodes_length_in": 10.368237912813044, "episode_len_mean": 20.0, "num_agent_steps_sampled": {"default_agent": 400}, "num_agent_steps_sampled_lifetime": {"default_agent": 1600}, "num_env_steps_sampled": 400, "num_module_steps_sampled_lifetime": {"default_policy": 1600}, "env_to_module_sum_episodes_length_out": 10.368237912813044, "num_episodes": 20, "episode_return_min": -14.5, "episode_len_min": 20, "episode_return_max": 13.5, "num_episodes_lifetime": 80, "time_between_sampling": 2.447328195928701}, "num_healthy_workers": 1, "actor_manager_num_outstanding_async_reqs": 0, "num_remote_worker_restarts": 0}, "num_env_steps_sampled_lifetime": -1225000.0, "fault_tolerance": {"num_healthy_workers": 0, "num_remote_worker_restarts": 0}, "env_runner_group": {"actor_manager_num_outstanding_async_reqs": 0}, "done": false, "training_iteration": 4, "trial_id": "46920_00000", "date": "2025-08-11_19-35-30", "timestamp": 1754933730, "time_this_iter_s": 2.66129994392395, "time_total_s": 10.453848838806152, "pid": 27748, "hostname": "Mac", "node_ip": "127.0.0.1", "config": {"exploration_config": {}, "extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "placement_strategy": "PACK", "num_gpus": 0, "_fake_gpus": false, "num_cpus_for_main_process": 2, "eager_tracing": true, "eager_max_retraces": 20, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "torch_compile_learner": false, "torch_compile_learner_what_to_compile": "forward_train", "torch_compile_learner_dynamo_backend": "aot_eager", "torch_compile_learner_dynamo_mode": null, "torch_compile_worker": false, "torch_compile_worker_dynamo_backend": "aot_eager", "torch_compile_worker_dynamo_mode": null, "torch_ddp_kwargs": {}, "torch_skip_nan_gradients": false, "env": "Umbrella", "env_config": {}, "observation_space": null, "action_space": null, "clip_rewards": null, "normalize_actions": true, "clip_actions": false, "_is_atari": null, "disable_env_checking": false, "render_env": false, "action_mask_key": "action_mask", "env_runner_cls": null, "num_env_runners": 0, "create_local_env_runner": true, "num_envs_per_env_runner": 1, "gym_env_vectorize_mode": "SYNC", "num_cpus_per_env_runner": 1, "num_gpus_per_env_runner": 0, "custom_resources_per_env_runner": {}, "validate_env_runners_after_construction": true, "episodes_to_numpy": true, "max_requests_in_flight_per_env_runner": 1, "sample_timeout_s": 60.0, "_env_to_module_connector": null, "add_default_connectors_to_env_to_module_pipeline": true, "_module_to_env_connector": null, "add_default_connectors_to_module_to_env_pipeline": true, "merge_env_runner_states": "training_only", "broadcast_env_runner_states": true, "episode_lookback_horizon": 1, "rollout_fragment_length": "auto", "batch_mode": "complete_episodes", "compress_observations": false, "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "enable_tf1_exec_eagerly": false, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "preprocessor_pref": "deepmind", "observation_filter": "NoFilter", "update_worker_filter_stats": true, "use_worker_filter_stats": true, "sampler_perf_stats_ema_coef": null, "_is_online": true, "num_learners": 0, "num_gpus_per_learner": 0, "num_cpus_per_learner": "auto", "num_aggregator_actors_per_learner": 0, "max_requests_in_flight_per_aggregator_actor": 3, "local_gpu_idx": 0, "max_requests_in_flight_per_learner": 3, "gamma": 1, "lr": 0.0002847858517, "grad_clip": 0.5, "grad_clip_by": "global_norm", "_train_batch_size_per_learner": 5000, "train_batch_size": 4000, "num_epochs": 1, "minibatch_size": 1000, "shuffle_batch_per_epoch": true, "model": {"fcnet_hiddens": [256, 256], "fcnet_activation": "tanh", "fcnet_weights_initializer": null, "fcnet_weights_initializer_config": null, "fcnet_bias_initializer": null, "fcnet_bias_initializer_config": null, "conv_filters": null, "conv_activation": "relu", "conv_kernel_initializer": null, "conv_kernel_initializer_config": null, "conv_bias_initializer": null, "conv_bias_initializer_config": null, "conv_transpose_kernel_initializer": null, "conv_transpose_kernel_initializer_config": null, "conv_transpose_bias_initializer": null, "conv_transpose_bias_initializer_config": null, "post_fcnet_hiddens": [], "post_fcnet_activation": "relu", "post_fcnet_weights_initializer": null, "post_fcnet_weights_initializer_config": null, "post_fcnet_bias_initializer": null, "post_fcnet_bias_initializer_config": null, "free_log_std": false, "log_std_clip_param": 20.0, "no_final_linear": false, "vf_share_layers": false, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "lstm_weights_initializer": null, "lstm_weights_initializer_config": null, "lstm_bias_initializer": null, "lstm_bias_initializer_config": null, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "attention_use_n_prev_actions": 0, "attention_use_n_prev_rewards": 0, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": null, "custom_model_config": {}, "custom_action_dist": null, "custom_preprocessor": null, "encoder_latent_dim": null, "always_check_shapes": false, "lstm_use_prev_action_reward": -1, "_use_default_native_models": -1, "_disable_preprocessor_api": false, "_disable_action_flattening": false}, "_learner_connector": null, "add_default_connectors_to_learner_pipeline": true, "learner_config_dict": {}, "optimizer": {}, "_learner_class": null, "callbacks_on_algorithm_init": null, "callbacks_on_env_runners_recreated": null, "callbacks_on_offline_eval_runners_recreated": null, "callbacks_on_checkpoint_loaded": null, "callbacks_on_environment_created": null, "callbacks_on_episode_created": null, "callbacks_on_episode_start": null, "callbacks_on_episode_step": null, "callbacks_on_episode_end": null, "callbacks_on_evaluate_start": null, "callbacks_on_evaluate_end": null, "callbacks_on_evaluate_offline_start": null, "callbacks_on_evaluate_offline_end": null, "callbacks_on_sample_end": null, "callbacks_on_train_result": null, "explore": true, "enable_rl_module_and_learner": true, "enable_env_runner_and_connector_v2": true, "_prior_exploration_config": {"type": "StochasticSampling"}, "count_steps_by": "env_steps", "policy_map_capacity": 100, "policy_mapping_fn": "<function AlgorithmConfig.DEFAULT_POLICY_MAPPING_FN at 0x3847e9b20>", "policies_to_train": null, "policy_states_are_swappable": false, "observation_fn": null, "offline_data_class": null, "input_read_method": "read_parquet", "input_read_method_kwargs": {}, "input_read_schema": {}, "input_read_episodes": false, "input_read_sample_batches": false, "input_read_batch_size": null, "input_filesystem": null, "input_filesystem_kwargs": {}, "input_compress_columns": ["obs", "new_obs"], "input_spaces_jsonable": true, "materialize_data": false, "materialize_mapped_data": true, "map_batches_kwargs": {}, "iter_batches_kwargs": {}, "ignore_final_observation": false, "prelearner_class": null, "prelearner_buffer_class": null, "prelearner_buffer_kwargs": {}, "prelearner_module_synch_period": 10, "dataset_num_iters_per_learner": null, "input_config": {}, "actions_in_input_normalized": false, "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_config": {}, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "output_max_rows_per_file": null, "output_write_remaining_data": false, "output_write_method": "write_parquet", "output_write_method_kwargs": {}, "output_filesystem": null, "output_filesystem_kwargs": {}, "output_write_episodes": true, "offline_sampling": false, "evaluation_interval": 1, "evaluation_duration": 20, "evaluation_duration_unit": "episodes", "evaluation_sample_timeout_s": 120.0, "evaluation_auto_duration_min_env_steps_per_sample": 100, "evaluation_auto_duration_max_env_steps_per_sample": 2000, "evaluation_parallel_to_training": false, "evaluation_force_reset_envs_before_iteration": true, "evaluation_config": null, "off_policy_estimation_methods": {}, "ope_split_batch_by_episode": true, "evaluation_num_env_runners": 1, "in_evaluation": false, "sync_filters_on_rollout_workers_timeout_s": 10.0, "offline_evaluation_interval": null, "num_offline_eval_runners": 0, "offline_loss_for_module_fn": null, "offline_evaluation_duration": 1, "offline_evaluation_parallel_to_training": false, "offline_evaluation_timeout_s": 120.0, "num_cpus_per_offline_eval_runner": 1, "num_gpus_per_offline_eval_runner": 0, "custom_resources_per_offline_eval_runner": {}, "restart_failed_offline_eval_runners": true, "ignore_offline_eval_runner_failures": false, "max_num_offline_eval_runner_restarts": 1000, "offline_eval_runner_restore_timeout_s": 1800.0, "max_requests_in_flight_per_offline_eval_runner": 1, "validate_offline_eval_runners_after_construction": true, "offline_eval_runner_health_probe_timeout_s": 30.0, "offline_eval_rl_module_inference_only": false, "broadcast_offline_eval_runner_states": false, "offline_eval_batch_size_per_runner": 256, "dataset_num_iters_per_eval_runner": 1, "keep_per_episode_custom_metrics": false, "metrics_episode_collection_timeout_s": 60.0, "metrics_num_episodes_for_smoothing": 100, "min_time_s_per_iteration": null, "min_train_timesteps_per_iteration": 0, "min_sample_timesteps_per_iteration": 0, "log_gradients": true, "export_native_model_files": false, "checkpoint_trainable_policies_only": false, "logger_creator": null, "logger_config": null, "log_level": "WARN", "log_sys_usage": true, "fake_sampler": false, "seed": 10, "restart_failed_env_runners": true, "ignore_env_runner_failures": false, "max_num_env_runner_restarts": 1000, "delay_between_env_runner_restarts_s": 60.0, "restart_failed_sub_environments": false, "num_consecutive_env_runner_failures_tolerance": 100, "env_runner_health_probe_timeout_s": 30.0, "env_runner_restore_timeout_s": 1800.0, "_model_config": {}, "_rl_module_spec": "RLModuleSpec(module_class=None, observation_space=None, action_space=None, inference_only=False, learner_only=False, model_config=DefaultModelConfig(fcnet_hiddens=[60, 90], fcnet_activation='tanh', fcnet_kernel_initializer=None, fcnet_kernel_initializer_kwargs=None, fcnet_bias_initializer=None, fcnet_bias_initializer_kwargs=None, conv_filters=None, conv_activation='relu', conv_kernel_initializer=None, conv_kernel_initializer_kwargs=None, conv_bias_initializer=None, conv_bias_initializer_kwargs=None, head_fcnet_hiddens=[], head_fcnet_activation='relu', head_fcnet_kernel_initializer=None, head_fcnet_kernel_initializer_kwargs=None, head_fcnet_bias_initializer=None, head_fcnet_bias_initializer_kwargs=None, free_log_std=False, log_std_clip_param=20.0, vf_share_layers=True, use_lstm=False, max_seq_len=20, lstm_cell_size=256, lstm_use_prev_action=False, lstm_use_prev_reward=False, lstm_kernel_initializer=None, lstm_kernel_initializer_kwargs=None, lstm_bias_initializer=None, lstm_bias_initializer_kwargs=None), catalog_class=None, load_state_path=None, model_config_dict=None)", "algorithm_config_overrides_per_module": {}, "_per_module_overrides": {}, "_validate_config": true, "_use_msgpack_checkpoints": false, "_torch_grad_scaler_class": null, "_torch_lr_scheduler_classes": null, "_tf_policy_handles_more_than_one_loss": false, "_disable_preprocessor_api": false, "_disable_action_flattening": false, "_disable_initialize_loss_from_dummy_batch": false, "_dont_auto_sync_env_runner_states": false, "env_task_fn": -1, "enable_connectors": -1, "simple_optimizer": false, "policy_map_cache": -1, "worker_cls": -1, "synchronize_filters": -1, "enable_async_evaluation": -1, "custom_async_evaluation_function": -1, "_enable_rl_module_api": -1, "auto_wrap_old_gym_envs": -1, "always_attach_evaluation_results": -1, "replay_sequence_length": null, "_disable_execution_plan_api": -1, "use_critic": true, "use_gae": true, "use_kl_loss": true, "kl_coeff": 0.7464963036515, "kl_target": 0.0270990929592, "vf_loss_coeff": 0.6688075857018, "entropy_coeff": 0.0090570820258, "clip_param": 0.1221781641624, "vf_clip_param": 0.1027808522125, "entropy_coeff_schedule": null, "lr_schedule": null, "sgd_minibatch_size": -1, "vf_share_layers": -1, "__stdout_file__": null, "__stderr_file__": null, "lambda": 0.9099046732075, "input": "sampler", "policies": {"default_policy": [null, null, null, null]}, "callbacks": "<class 'ray.rllib.callbacks.callbacks.RLlibCallback'>", "create_env_on_driver": false, "custom_eval_function": null, "framework": "torch"}, "time_since_restore": 10.453848838806152, "iterations_since_restore": 4, "perf": {"cpu_util_percent": 68.93333333333334, "ram_util_percent": 75.83333333333333}}
{"timers": {"training_iteration": 2.654737913130821, "restore_env_runners": 1.451878990257508e-05, "training_step": 2.654558313927602, "env_runner_sampling_timer": 2.496426341758632, "learner_update_timer": 0.15501454720021499, "synch_weights": 0.0005945745325080571, "restore_eval_env_runners": 8.972381896572188e-06, "evaluation_iteration": 0.1356769843295616, "synch_eval_env_connectors": 0.0002326319051608443, "synch_env_connectors": 4.7918162583373486e-06}, "env_runners": {"num_episodes": 250.0, "module_to_env_connector": {"timers": {"connectors": {"remove_single_ts_time_rank_from_batch": 8.492056031799437e-07, "listify_data_for_vector_env": 1.6708773176529314e-05, "get_actions": 6.609605054560034e-05, "tensor_to_numpy": 2.0413505860513325e-05, "un_batch_to_individual_items": 7.90359344678662e-06, "normalize_and_clip_actions": 1.3831606516277843e-05}}, "connector_pipeline_timer": 0.000162810245524244}, "episode_duration_sec_mean": 0.007550299800932407, "env_to_module_sum_episodes_length_in": 10.36823839457432, "episode_return_min": -10.5, "episode_len_max": 20, "episode_len_mean": 20.0, "env_step_timer": 2.1999408335983103e-05, "num_agent_steps_sampled": {"default_agent": 5000.0}, "module_episode_returns_mean": {"default_policy": -1.1400000000000001}, "num_agent_steps_sampled_lifetime": {"default_agent": -1842500.0}, "agent_episode_returns_mean": {"default_agent": -1.1400000000000001}, "weights_seq_no": 4.0, "env_to_module_connector": {"timers": {"connectors": {"add_observations_from_episodes_to_batch": 4.394176832876953e-06, "numpy_to_tensor": 1.3768045555863951e-05, "add_states_from_episodes_to_batch": 2.698585204906856e-06, "add_time_dim_to_batch_and_zero_pad": 3.470112622026727e-06, "batch_individual_items": 1.019076236209333e-05}}, "connector_pipeline_timer": 6.535778088594941e-05}, "sample": 0.00771151778009037, "num_module_steps_sampled_lifetime": {"default_policy": -1842500.0}, "num_env_steps_sampled_lifetime": -1842500.0, "episode_len_min": 20, "episode_return_max": 9.5, "num_episodes_lifetime": -92125.0, "time_between_sampling": 0.002449155358085469, "num_module_steps_sampled": {"default_policy": 5000.0}, "env_reset_timer": 7.281829924641776e-05, "num_env_steps_sampled": 5000.0, "episode_return_mean": -1.1400000000000001, "rlmodule_inference_timer": 6.886024602116054e-05, "env_to_module_sum_episodes_length_out": 10.36823839457432, "num_env_steps_sampled_lifetime_throughput": 2606.5244542953214}, "learners": {"__all_modules__": {"num_trainable_parameters": 6003, "learner_connector": {"timers": {"connectors": {"add_time_dim_to_batch_and_zero_pad": 2.5295467384362123e-05, "batch_individual_items": 0.037351116530295846, "add_states_from_episodes_to_batch": 7.440554094520631e-06, "general_advantage_estimation": 0.007614842940873491, "add_columns_from_episodes_to_train_batch": 0.059295910860824384, "numpy_to_tensor": 7.688547313503571e-05, "add_one_ts_to_episodes_and_truncate": 0.01303368281314621, "add_observations_from_episodes_to_batch": 0.0019665840443897236}}, "connector_pipeline_timer": 0.11965109107799303}, "learner_connector_sum_episodes_length_in": 5000.0, "num_module_steps_trained": 6000, "num_non_trainable_parameters": 0, "num_module_steps_trained_lifetime": 30000, "learner_connector_sum_episodes_length_out": 5250.0, "num_env_steps_trained_lifetime": 157500, "num_env_steps_trained": 31500, "num_env_steps_trained_lifetime_throughput": 1729940.5755533108, "num_module_steps_trained_throughput": 330984.25839011115, "num_module_steps_trained_lifetime_throughput": 330382.5572482181}, "default_policy": {"vf_loss_unclipped": 28.676191329956055, "total_loss": 0.05677541345357895, "entropy": 0.6833857297897339, "num_trainable_parameters": 6003, "num_module_steps_trained_lifetime": 30000, "curr_kl_coeff": 0.023328009992837906, "vf_explained_var": -0.010284781455993652, "weights_seq_no": 5.0, "policy_loss": -0.005832438822835684, "num_module_steps_trained": 6000, "curr_entropy_coeff": 0.0090570820258, "mean_kl_loss": 0.0012158984318375587, "module_train_batch_size_mean": 1000.0, "vf_loss": 0.10278083384037018, "gradients_default_optimizer_global_norm": 0.02561800181865692, "default_optimizer_learning_rate": 0.0002847858517, "diff_num_grad_updates_vs_sampler_policy": 1.0, "num_module_steps_trained_lifetime_throughput": 331950.2902772871}}, "num_training_step_calls_per_iteration": 1, "evaluation": {"env_runners": {"weights_seq_no": 5.0, "num_env_steps_sampled_lifetime": 25400, "module_to_env_connector": {"timers": {"connectors": {"remove_single_ts_time_rank_from_batch": 6.697913141094824e-07, "listify_data_for_vector_env": 1.3887976499307509e-05, "get_actions": 5.064083801453649e-05, "un_batch_to_individual_items": 6.329386878924867e-06, "tensor_to_numpy": 1.7001936109444527e-05, "normalize_and_clip_actions": 1.1057359825919567e-05}}, "connector_pipeline_timer": 0.00012969186651170335}, "module_episode_returns_mean": {"default_policy": -1.15}, "episode_return_mean": -1.15, "rlmodule_inference_timer": 3.8848378918879466e-05, "episode_duration_sec_mean": 0.006455159622710198, "env_to_module_connector": {"timers": {"connectors": {"add_observations_from_episodes_to_batch": 3.334472438760625e-06, "add_time_dim_to_batch_and_zero_pad": 2.7432600755638162e-06, "batch_individual_items": 7.506135844061565e-06, "add_states_from_episodes_to_batch": 1.8151574400297025e-06, "numpy_to_tensor": 1.0926178946056271e-05}}, "connector_pipeline_timer": 5.2090660713551895e-05}, "num_module_steps_sampled": {"default_policy": 400}, "episode_len_max": 20, "env_step_timer": 1.9420787886609044e-05, "sample": 0.12842718370273581, "agent_episode_returns_mean": {"default_agent": -1.15}, "env_reset_timer": 0.0003502215623900073, "env_to_module_sum_episodes_length_in": 10.368238387501162, "episode_len_mean": 20.0, "num_agent_steps_sampled": {"default_agent": 400}, "num_agent_steps_sampled_lifetime": {"default_agent": 2000}, "num_env_steps_sampled": 400, "num_module_steps_sampled_lifetime": {"default_policy": 2000}, "env_to_module_sum_episodes_length_out": 10.368238387501162, "num_episodes": 20, "episode_return_min": -14.5, "episode_len_min": 20, "episode_return_max": 13.5, "num_episodes_lifetime": 100, "time_between_sampling": 2.447290766889119}, "num_healthy_workers": 1, "actor_manager_num_outstanding_async_reqs": 0, "num_remote_worker_restarts": 0}, "num_env_steps_sampled_lifetime": -1842500.0, "fault_tolerance": {"num_healthy_workers": 0, "num_remote_worker_restarts": 0}, "env_runner_group": {"actor_manager_num_outstanding_async_reqs": 0}, "done": false, "training_iteration": 5, "trial_id": "46920_00000", "date": "2025-08-11_19-35-33", "timestamp": 1754933733, "time_this_iter_s": 2.554007053375244, "time_total_s": 13.007855892181396, "pid": 27748, "hostname": "Mac", "node_ip": "127.0.0.1", "config": {"exploration_config": {}, "extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "placement_strategy": "PACK", "num_gpus": 0, "_fake_gpus": false, "num_cpus_for_main_process": 2, "eager_tracing": true, "eager_max_retraces": 20, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "torch_compile_learner": false, "torch_compile_learner_what_to_compile": "forward_train", "torch_compile_learner_dynamo_backend": "aot_eager", "torch_compile_learner_dynamo_mode": null, "torch_compile_worker": false, "torch_compile_worker_dynamo_backend": "aot_eager", "torch_compile_worker_dynamo_mode": null, "torch_ddp_kwargs": {}, "torch_skip_nan_gradients": false, "env": "Umbrella", "env_config": {}, "observation_space": null, "action_space": null, "clip_rewards": null, "normalize_actions": true, "clip_actions": false, "_is_atari": null, "disable_env_checking": false, "render_env": false, "action_mask_key": "action_mask", "env_runner_cls": null, "num_env_runners": 0, "create_local_env_runner": true, "num_envs_per_env_runner": 1, "gym_env_vectorize_mode": "SYNC", "num_cpus_per_env_runner": 1, "num_gpus_per_env_runner": 0, "custom_resources_per_env_runner": {}, "validate_env_runners_after_construction": true, "episodes_to_numpy": true, "max_requests_in_flight_per_env_runner": 1, "sample_timeout_s": 60.0, "_env_to_module_connector": null, "add_default_connectors_to_env_to_module_pipeline": true, "_module_to_env_connector": null, "add_default_connectors_to_module_to_env_pipeline": true, "merge_env_runner_states": "training_only", "broadcast_env_runner_states": true, "episode_lookback_horizon": 1, "rollout_fragment_length": "auto", "batch_mode": "complete_episodes", "compress_observations": false, "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "enable_tf1_exec_eagerly": false, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "preprocessor_pref": "deepmind", "observation_filter": "NoFilter", "update_worker_filter_stats": true, "use_worker_filter_stats": true, "sampler_perf_stats_ema_coef": null, "_is_online": true, "num_learners": 0, "num_gpus_per_learner": 0, "num_cpus_per_learner": "auto", "num_aggregator_actors_per_learner": 0, "max_requests_in_flight_per_aggregator_actor": 3, "local_gpu_idx": 0, "max_requests_in_flight_per_learner": 3, "gamma": 1, "lr": 0.0002847858517, "grad_clip": 0.5, "grad_clip_by": "global_norm", "_train_batch_size_per_learner": 5000, "train_batch_size": 4000, "num_epochs": 1, "minibatch_size": 1000, "shuffle_batch_per_epoch": true, "model": {"fcnet_hiddens": [256, 256], "fcnet_activation": "tanh", "fcnet_weights_initializer": null, "fcnet_weights_initializer_config": null, "fcnet_bias_initializer": null, "fcnet_bias_initializer_config": null, "conv_filters": null, "conv_activation": "relu", "conv_kernel_initializer": null, "conv_kernel_initializer_config": null, "conv_bias_initializer": null, "conv_bias_initializer_config": null, "conv_transpose_kernel_initializer": null, "conv_transpose_kernel_initializer_config": null, "conv_transpose_bias_initializer": null, "conv_transpose_bias_initializer_config": null, "post_fcnet_hiddens": [], "post_fcnet_activation": "relu", "post_fcnet_weights_initializer": null, "post_fcnet_weights_initializer_config": null, "post_fcnet_bias_initializer": null, "post_fcnet_bias_initializer_config": null, "free_log_std": false, "log_std_clip_param": 20.0, "no_final_linear": false, "vf_share_layers": false, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "lstm_weights_initializer": null, "lstm_weights_initializer_config": null, "lstm_bias_initializer": null, "lstm_bias_initializer_config": null, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "attention_use_n_prev_actions": 0, "attention_use_n_prev_rewards": 0, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": null, "custom_model_config": {}, "custom_action_dist": null, "custom_preprocessor": null, "encoder_latent_dim": null, "always_check_shapes": false, "lstm_use_prev_action_reward": -1, "_use_default_native_models": -1, "_disable_preprocessor_api": false, "_disable_action_flattening": false}, "_learner_connector": null, "add_default_connectors_to_learner_pipeline": true, "learner_config_dict": {}, "optimizer": {}, "_learner_class": null, "callbacks_on_algorithm_init": null, "callbacks_on_env_runners_recreated": null, "callbacks_on_offline_eval_runners_recreated": null, "callbacks_on_checkpoint_loaded": null, "callbacks_on_environment_created": null, "callbacks_on_episode_created": null, "callbacks_on_episode_start": null, "callbacks_on_episode_step": null, "callbacks_on_episode_end": null, "callbacks_on_evaluate_start": null, "callbacks_on_evaluate_end": null, "callbacks_on_evaluate_offline_start": null, "callbacks_on_evaluate_offline_end": null, "callbacks_on_sample_end": null, "callbacks_on_train_result": null, "explore": true, "enable_rl_module_and_learner": true, "enable_env_runner_and_connector_v2": true, "_prior_exploration_config": {"type": "StochasticSampling"}, "count_steps_by": "env_steps", "policy_map_capacity": 100, "policy_mapping_fn": "<function AlgorithmConfig.DEFAULT_POLICY_MAPPING_FN at 0x3847e9b20>", "policies_to_train": null, "policy_states_are_swappable": false, "observation_fn": null, "offline_data_class": null, "input_read_method": "read_parquet", "input_read_method_kwargs": {}, "input_read_schema": {}, "input_read_episodes": false, "input_read_sample_batches": false, "input_read_batch_size": null, "input_filesystem": null, "input_filesystem_kwargs": {}, "input_compress_columns": ["obs", "new_obs"], "input_spaces_jsonable": true, "materialize_data": false, "materialize_mapped_data": true, "map_batches_kwargs": {}, "iter_batches_kwargs": {}, "ignore_final_observation": false, "prelearner_class": null, "prelearner_buffer_class": null, "prelearner_buffer_kwargs": {}, "prelearner_module_synch_period": 10, "dataset_num_iters_per_learner": null, "input_config": {}, "actions_in_input_normalized": false, "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_config": {}, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "output_max_rows_per_file": null, "output_write_remaining_data": false, "output_write_method": "write_parquet", "output_write_method_kwargs": {}, "output_filesystem": null, "output_filesystem_kwargs": {}, "output_write_episodes": true, "offline_sampling": false, "evaluation_interval": 1, "evaluation_duration": 20, "evaluation_duration_unit": "episodes", "evaluation_sample_timeout_s": 120.0, "evaluation_auto_duration_min_env_steps_per_sample": 100, "evaluation_auto_duration_max_env_steps_per_sample": 2000, "evaluation_parallel_to_training": false, "evaluation_force_reset_envs_before_iteration": true, "evaluation_config": null, "off_policy_estimation_methods": {}, "ope_split_batch_by_episode": true, "evaluation_num_env_runners": 1, "in_evaluation": false, "sync_filters_on_rollout_workers_timeout_s": 10.0, "offline_evaluation_interval": null, "num_offline_eval_runners": 0, "offline_loss_for_module_fn": null, "offline_evaluation_duration": 1, "offline_evaluation_parallel_to_training": false, "offline_evaluation_timeout_s": 120.0, "num_cpus_per_offline_eval_runner": 1, "num_gpus_per_offline_eval_runner": 0, "custom_resources_per_offline_eval_runner": {}, "restart_failed_offline_eval_runners": true, "ignore_offline_eval_runner_failures": false, "max_num_offline_eval_runner_restarts": 1000, "offline_eval_runner_restore_timeout_s": 1800.0, "max_requests_in_flight_per_offline_eval_runner": 1, "validate_offline_eval_runners_after_construction": true, "offline_eval_runner_health_probe_timeout_s": 30.0, "offline_eval_rl_module_inference_only": false, "broadcast_offline_eval_runner_states": false, "offline_eval_batch_size_per_runner": 256, "dataset_num_iters_per_eval_runner": 1, "keep_per_episode_custom_metrics": false, "metrics_episode_collection_timeout_s": 60.0, "metrics_num_episodes_for_smoothing": 100, "min_time_s_per_iteration": null, "min_train_timesteps_per_iteration": 0, "min_sample_timesteps_per_iteration": 0, "log_gradients": true, "export_native_model_files": false, "checkpoint_trainable_policies_only": false, "logger_creator": null, "logger_config": null, "log_level": "WARN", "log_sys_usage": true, "fake_sampler": false, "seed": 10, "restart_failed_env_runners": true, "ignore_env_runner_failures": false, "max_num_env_runner_restarts": 1000, "delay_between_env_runner_restarts_s": 60.0, "restart_failed_sub_environments": false, "num_consecutive_env_runner_failures_tolerance": 100, "env_runner_health_probe_timeout_s": 30.0, "env_runner_restore_timeout_s": 1800.0, "_model_config": {}, "_rl_module_spec": "RLModuleSpec(module_class=None, observation_space=None, action_space=None, inference_only=False, learner_only=False, model_config=DefaultModelConfig(fcnet_hiddens=[60, 90], fcnet_activation='tanh', fcnet_kernel_initializer=None, fcnet_kernel_initializer_kwargs=None, fcnet_bias_initializer=None, fcnet_bias_initializer_kwargs=None, conv_filters=None, conv_activation='relu', conv_kernel_initializer=None, conv_kernel_initializer_kwargs=None, conv_bias_initializer=None, conv_bias_initializer_kwargs=None, head_fcnet_hiddens=[], head_fcnet_activation='relu', head_fcnet_kernel_initializer=None, head_fcnet_kernel_initializer_kwargs=None, head_fcnet_bias_initializer=None, head_fcnet_bias_initializer_kwargs=None, free_log_std=False, log_std_clip_param=20.0, vf_share_layers=True, use_lstm=False, max_seq_len=20, lstm_cell_size=256, lstm_use_prev_action=False, lstm_use_prev_reward=False, lstm_kernel_initializer=None, lstm_kernel_initializer_kwargs=None, lstm_bias_initializer=None, lstm_bias_initializer_kwargs=None), catalog_class=None, load_state_path=None, model_config_dict=None)", "algorithm_config_overrides_per_module": {}, "_per_module_overrides": {}, "_validate_config": true, "_use_msgpack_checkpoints": false, "_torch_grad_scaler_class": null, "_torch_lr_scheduler_classes": null, "_tf_policy_handles_more_than_one_loss": false, "_disable_preprocessor_api": false, "_disable_action_flattening": false, "_disable_initialize_loss_from_dummy_batch": false, "_dont_auto_sync_env_runner_states": false, "env_task_fn": -1, "enable_connectors": -1, "simple_optimizer": false, "policy_map_cache": -1, "worker_cls": -1, "synchronize_filters": -1, "enable_async_evaluation": -1, "custom_async_evaluation_function": -1, "_enable_rl_module_api": -1, "auto_wrap_old_gym_envs": -1, "always_attach_evaluation_results": -1, "replay_sequence_length": null, "_disable_execution_plan_api": -1, "use_critic": true, "use_gae": true, "use_kl_loss": true, "kl_coeff": 0.7464963036515, "kl_target": 0.0270990929592, "vf_loss_coeff": 0.6688075857018, "entropy_coeff": 0.0090570820258, "clip_param": 0.1221781641624, "vf_clip_param": 0.1027808522125, "entropy_coeff_schedule": null, "lr_schedule": null, "sgd_minibatch_size": -1, "vf_share_layers": -1, "__stdout_file__": null, "__stderr_file__": null, "lambda": 0.9099046732075, "input": "sampler", "policies": {"default_policy": [null, null, null, null]}, "callbacks": "<class 'ray.rllib.callbacks.callbacks.RLlibCallback'>", "create_env_on_driver": false, "custom_eval_function": null, "framework": "torch"}, "time_since_restore": 13.007855892181396, "iterations_since_restore": 5, "perf": {"cpu_util_percent": 67.375, "ram_util_percent": 75.575}}
{"timers": {"training_iteration": 2.6523180265002146, "restore_env_runners": 1.4426931862478248e-05, "training_step": 2.65213788536785, "env_runner_sampling_timer": 2.493110212511146, "learner_update_timer": 0.15588508380876853, "synch_weights": 0.0006012079563073415, "restore_eval_env_runners": 8.95890778509667e-06, "evaluation_iteration": 0.13564717615610405, "synch_eval_env_connectors": 0.00023167974558316169, "synch_env_connectors": 4.785567796048709e-06}, "env_runners": {"num_episodes": 250.0, "module_to_env_connector": {"timers": {"connectors": {"remove_single_ts_time_rank_from_batch": 8.999615405924194e-07, "listify_data_for_vector_env": 1.7043052496114243e-05, "get_actions": 6.852864557476088e-05, "tensor_to_numpy": 2.138201637653863e-05, "un_batch_to_individual_items": 8.16814920982651e-06, "normalize_and_clip_actions": 1.4103007299480993e-05}}, "connector_pipeline_timer": 0.0001680573549852621}, "episode_duration_sec_mean": 0.007216441506054255, "env_to_module_sum_episodes_length_in": 10.36823839457432, "episode_return_min": -10.5, "episode_len_max": 20, "episode_len_mean": 20.0, "env_step_timer": 2.2457000315389173e-05, "num_agent_steps_sampled": {"default_agent": 5000.0}, "module_episode_returns_mean": {"default_policy": 0.54}, "num_agent_steps_sampled_lifetime": {"default_agent": -2460000.0}, "agent_episode_returns_mean": {"default_agent": 0.54}, "weights_seq_no": 5.0, "env_to_module_connector": {"timers": {"connectors": {"add_observations_from_episodes_to_batch": 4.367480052987684e-06, "numpy_to_tensor": 1.4453596772626796e-05, "add_states_from_episodes_to_batch": 2.381672236752635e-06, "add_time_dim_to_batch_and_zero_pad": 3.4977932526012704e-06, "batch_individual_items": 1.0020421095052052e-05}}, "connector_pipeline_timer": 6.570383607896136e-05}, "sample": 0.008143121712188206, "num_module_steps_sampled_lifetime": {"default_policy": -2460000.0}, "num_env_steps_sampled_lifetime": -2460000.0, "episode_len_min": 20, "episode_return_max": 9.5, "num_episodes_lifetime": -123000.0, "time_between_sampling": 0.002223765421806858, "num_module_steps_sampled": {"default_policy": 5000.0}, "env_reset_timer": 6.968975828483094e-05, "num_env_steps_sampled": 5000.0, "episode_return_mean": 0.54, "rlmodule_inference_timer": 4.645372407929288e-05, "env_to_module_sum_episodes_length_out": 10.36823839457432, "num_env_steps_sampled_lifetime_throughput": 2545.6473796905516}, "learners": {"__all_modules__": {"num_trainable_parameters": 6003, "learner_connector": {"timers": {"connectors": {"add_time_dim_to_batch_and_zero_pad": 2.5216262578345203e-05, "batch_individual_items": 0.03846088244510782, "add_states_from_episodes_to_batch": 7.445728903423098e-06, "general_advantage_estimation": 0.007624756591691595, "add_columns_from_episodes_to_train_batch": 0.059135167172512555, "numpy_to_tensor": 7.683369836908308e-05, "add_one_ts_to_episodes_and_truncate": 0.012997745985540385, "add_observations_from_episodes_to_batch": 0.0019576748737446924}}, "connector_pipeline_timer": 0.12056387558686325}, "learner_connector_sum_episodes_length_in": 5000.0, "num_module_steps_trained": 6000, "num_non_trainable_parameters": 0, "num_module_steps_trained_lifetime": 36000, "learner_connector_sum_episodes_length_out": 5250.0, "num_env_steps_trained_lifetime": 189000, "num_env_steps_trained": 31500, "num_env_steps_trained_lifetime_throughput": 1706148.2762262272, "num_module_steps_trained_throughput": 326406.0345686084, "num_module_steps_trained_lifetime_throughput": 325821.78505562345}, "default_policy": {"vf_loss_unclipped": 28.676469802856445, "total_loss": 0.20164747536182404, "entropy": 0.6760303974151611, "num_trainable_parameters": 6003, "num_module_steps_trained_lifetime": 36000, "curr_kl_coeff": 0.011664004996418953, "vf_explained_var": -0.010419487953186035, "weights_seq_no": 6.0, "policy_loss": 0.13901302218437195, "num_module_steps_trained": 6000, "curr_entropy_coeff": 0.0090570820258, "mean_kl_loss": 0.0007163780392147601, "module_train_batch_size_mean": 1000.0, "vf_loss": 0.10278083384037018, "gradients_default_optimizer_global_norm": 0.013501612469553947, "default_optimizer_learning_rate": 0.0002847858517, "diff_num_grad_updates_vs_sampler_policy": 1.0, "num_module_steps_trained_lifetime_throughput": 327329.81946896866}}, "num_training_step_calls_per_iteration": 1, "evaluation": {"env_runners": {"weights_seq_no": 6.0, "num_env_steps_sampled_lifetime": 30400, "module_to_env_connector": {"timers": {"connectors": {"remove_single_ts_time_rank_from_batch": 1.0071725959337377e-06, "listify_data_for_vector_env": 1.8949805977476834e-05, "get_actions": 6.847254072769194e-05, "un_batch_to_individual_items": 8.778303486598226e-06, "tensor_to_numpy": 2.1761071934084524e-05, "normalize_and_clip_actions": 1.5595727271152568e-05}}, "connector_pipeline_timer": 0.00017545777503697116}, "module_episode_returns_mean": {"default_policy": -0.95}, "episode_return_mean": -0.95, "rlmodule_inference_timer": 4.84298106590062e-05, "episode_duration_sec_mean": 0.007022262933896854, "env_to_module_connector": {"timers": {"connectors": {"add_observations_from_episodes_to_batch": 4.27222288950665e-06, "add_time_dim_to_batch_and_zero_pad": 3.855298078295906e-06, "batch_individual_items": 1.0499802631588543e-05, "add_states_from_episodes_to_batch": 2.3080542347990953e-06, "numpy_to_tensor": 1.576471868162447e-05}}, "connector_pipeline_timer": 6.826327810474722e-05}, "num_module_steps_sampled": {"default_policy": 400}, "episode_len_max": 20, "env_step_timer": 2.5181455247211268e-05, "sample": 0.12902077436480394, "agent_episode_returns_mean": {"default_agent": -0.95}, "env_reset_timer": 0.0003482655960253705, "env_to_module_sum_episodes_length_in": 10.368238394470474, "episode_len_mean": 20.0, "num_agent_steps_sampled": {"default_agent": 400}, "num_agent_steps_sampled_lifetime": {"default_agent": 2400}, "num_env_steps_sampled": 400, "num_module_steps_sampled_lifetime": {"default_policy": 2400}, "env_to_module_sum_episodes_length_out": 10.368238394470474, "num_episodes": 20, "episode_return_min": -14.5, "episode_len_min": 20, "episode_return_max": 13.5, "num_episodes_lifetime": 120, "time_between_sampling": 2.4471904750507347}, "num_healthy_workers": 1, "actor_manager_num_outstanding_async_reqs": 0, "num_remote_worker_restarts": 0}, "num_env_steps_sampled_lifetime": -2460000.0, "fault_tolerance": {"num_healthy_workers": 0, "num_remote_worker_restarts": 0}, "env_runner_group": {"actor_manager_num_outstanding_async_reqs": 0}, "done": false, "training_iteration": 6, "trial_id": "46920_00000", "date": "2025-08-11_19-35-35", "timestamp": 1754933735, "time_this_iter_s": 2.611217975616455, "time_total_s": 15.619073867797852, "pid": 27748, "hostname": "Mac", "node_ip": "127.0.0.1", "config": {"exploration_config": {}, "extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "placement_strategy": "PACK", "num_gpus": 0, "_fake_gpus": false, "num_cpus_for_main_process": 2, "eager_tracing": true, "eager_max_retraces": 20, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "torch_compile_learner": false, "torch_compile_learner_what_to_compile": "forward_train", "torch_compile_learner_dynamo_backend": "aot_eager", "torch_compile_learner_dynamo_mode": null, "torch_compile_worker": false, "torch_compile_worker_dynamo_backend": "aot_eager", "torch_compile_worker_dynamo_mode": null, "torch_ddp_kwargs": {}, "torch_skip_nan_gradients": false, "env": "Umbrella", "env_config": {}, "observation_space": null, "action_space": null, "clip_rewards": null, "normalize_actions": true, "clip_actions": false, "_is_atari": null, "disable_env_checking": false, "render_env": false, "action_mask_key": "action_mask", "env_runner_cls": null, "num_env_runners": 0, "create_local_env_runner": true, "num_envs_per_env_runner": 1, "gym_env_vectorize_mode": "SYNC", "num_cpus_per_env_runner": 1, "num_gpus_per_env_runner": 0, "custom_resources_per_env_runner": {}, "validate_env_runners_after_construction": true, "episodes_to_numpy": true, "max_requests_in_flight_per_env_runner": 1, "sample_timeout_s": 60.0, "_env_to_module_connector": null, "add_default_connectors_to_env_to_module_pipeline": true, "_module_to_env_connector": null, "add_default_connectors_to_module_to_env_pipeline": true, "merge_env_runner_states": "training_only", "broadcast_env_runner_states": true, "episode_lookback_horizon": 1, "rollout_fragment_length": "auto", "batch_mode": "complete_episodes", "compress_observations": false, "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "enable_tf1_exec_eagerly": false, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "preprocessor_pref": "deepmind", "observation_filter": "NoFilter", "update_worker_filter_stats": true, "use_worker_filter_stats": true, "sampler_perf_stats_ema_coef": null, "_is_online": true, "num_learners": 0, "num_gpus_per_learner": 0, "num_cpus_per_learner": "auto", "num_aggregator_actors_per_learner": 0, "max_requests_in_flight_per_aggregator_actor": 3, "local_gpu_idx": 0, "max_requests_in_flight_per_learner": 3, "gamma": 1, "lr": 0.0002847858517, "grad_clip": 0.5, "grad_clip_by": "global_norm", "_train_batch_size_per_learner": 5000, "train_batch_size": 4000, "num_epochs": 1, "minibatch_size": 1000, "shuffle_batch_per_epoch": true, "model": {"fcnet_hiddens": [256, 256], "fcnet_activation": "tanh", "fcnet_weights_initializer": null, "fcnet_weights_initializer_config": null, "fcnet_bias_initializer": null, "fcnet_bias_initializer_config": null, "conv_filters": null, "conv_activation": "relu", "conv_kernel_initializer": null, "conv_kernel_initializer_config": null, "conv_bias_initializer": null, "conv_bias_initializer_config": null, "conv_transpose_kernel_initializer": null, "conv_transpose_kernel_initializer_config": null, "conv_transpose_bias_initializer": null, "conv_transpose_bias_initializer_config": null, "post_fcnet_hiddens": [], "post_fcnet_activation": "relu", "post_fcnet_weights_initializer": null, "post_fcnet_weights_initializer_config": null, "post_fcnet_bias_initializer": null, "post_fcnet_bias_initializer_config": null, "free_log_std": false, "log_std_clip_param": 20.0, "no_final_linear": false, "vf_share_layers": false, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "lstm_weights_initializer": null, "lstm_weights_initializer_config": null, "lstm_bias_initializer": null, "lstm_bias_initializer_config": null, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "attention_use_n_prev_actions": 0, "attention_use_n_prev_rewards": 0, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": null, "custom_model_config": {}, "custom_action_dist": null, "custom_preprocessor": null, "encoder_latent_dim": null, "always_check_shapes": false, "lstm_use_prev_action_reward": -1, "_use_default_native_models": -1, "_disable_preprocessor_api": false, "_disable_action_flattening": false}, "_learner_connector": null, "add_default_connectors_to_learner_pipeline": true, "learner_config_dict": {}, "optimizer": {}, "_learner_class": null, "callbacks_on_algorithm_init": null, "callbacks_on_env_runners_recreated": null, "callbacks_on_offline_eval_runners_recreated": null, "callbacks_on_checkpoint_loaded": null, "callbacks_on_environment_created": null, "callbacks_on_episode_created": null, "callbacks_on_episode_start": null, "callbacks_on_episode_step": null, "callbacks_on_episode_end": null, "callbacks_on_evaluate_start": null, "callbacks_on_evaluate_end": null, "callbacks_on_evaluate_offline_start": null, "callbacks_on_evaluate_offline_end": null, "callbacks_on_sample_end": null, "callbacks_on_train_result": null, "explore": true, "enable_rl_module_and_learner": true, "enable_env_runner_and_connector_v2": true, "_prior_exploration_config": {"type": "StochasticSampling"}, "count_steps_by": "env_steps", "policy_map_capacity": 100, "policy_mapping_fn": "<function AlgorithmConfig.DEFAULT_POLICY_MAPPING_FN at 0x3847e9b20>", "policies_to_train": null, "policy_states_are_swappable": false, "observation_fn": null, "offline_data_class": null, "input_read_method": "read_parquet", "input_read_method_kwargs": {}, "input_read_schema": {}, "input_read_episodes": false, "input_read_sample_batches": false, "input_read_batch_size": null, "input_filesystem": null, "input_filesystem_kwargs": {}, "input_compress_columns": ["obs", "new_obs"], "input_spaces_jsonable": true, "materialize_data": false, "materialize_mapped_data": true, "map_batches_kwargs": {}, "iter_batches_kwargs": {}, "ignore_final_observation": false, "prelearner_class": null, "prelearner_buffer_class": null, "prelearner_buffer_kwargs": {}, "prelearner_module_synch_period": 10, "dataset_num_iters_per_learner": null, "input_config": {}, "actions_in_input_normalized": false, "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_config": {}, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "output_max_rows_per_file": null, "output_write_remaining_data": false, "output_write_method": "write_parquet", "output_write_method_kwargs": {}, "output_filesystem": null, "output_filesystem_kwargs": {}, "output_write_episodes": true, "offline_sampling": false, "evaluation_interval": 1, "evaluation_duration": 20, "evaluation_duration_unit": "episodes", "evaluation_sample_timeout_s": 120.0, "evaluation_auto_duration_min_env_steps_per_sample": 100, "evaluation_auto_duration_max_env_steps_per_sample": 2000, "evaluation_parallel_to_training": false, "evaluation_force_reset_envs_before_iteration": true, "evaluation_config": null, "off_policy_estimation_methods": {}, "ope_split_batch_by_episode": true, "evaluation_num_env_runners": 1, "in_evaluation": false, "sync_filters_on_rollout_workers_timeout_s": 10.0, "offline_evaluation_interval": null, "num_offline_eval_runners": 0, "offline_loss_for_module_fn": null, "offline_evaluation_duration": 1, "offline_evaluation_parallel_to_training": false, "offline_evaluation_timeout_s": 120.0, "num_cpus_per_offline_eval_runner": 1, "num_gpus_per_offline_eval_runner": 0, "custom_resources_per_offline_eval_runner": {}, "restart_failed_offline_eval_runners": true, "ignore_offline_eval_runner_failures": false, "max_num_offline_eval_runner_restarts": 1000, "offline_eval_runner_restore_timeout_s": 1800.0, "max_requests_in_flight_per_offline_eval_runner": 1, "validate_offline_eval_runners_after_construction": true, "offline_eval_runner_health_probe_timeout_s": 30.0, "offline_eval_rl_module_inference_only": false, "broadcast_offline_eval_runner_states": false, "offline_eval_batch_size_per_runner": 256, "dataset_num_iters_per_eval_runner": 1, "keep_per_episode_custom_metrics": false, "metrics_episode_collection_timeout_s": 60.0, "metrics_num_episodes_for_smoothing": 100, "min_time_s_per_iteration": null, "min_train_timesteps_per_iteration": 0, "min_sample_timesteps_per_iteration": 0, "log_gradients": true, "export_native_model_files": false, "checkpoint_trainable_policies_only": false, "logger_creator": null, "logger_config": null, "log_level": "WARN", "log_sys_usage": true, "fake_sampler": false, "seed": 10, "restart_failed_env_runners": true, "ignore_env_runner_failures": false, "max_num_env_runner_restarts": 1000, "delay_between_env_runner_restarts_s": 60.0, "restart_failed_sub_environments": false, "num_consecutive_env_runner_failures_tolerance": 100, "env_runner_health_probe_timeout_s": 30.0, "env_runner_restore_timeout_s": 1800.0, "_model_config": {}, "_rl_module_spec": "RLModuleSpec(module_class=None, observation_space=None, action_space=None, inference_only=False, learner_only=False, model_config=DefaultModelConfig(fcnet_hiddens=[60, 90], fcnet_activation='tanh', fcnet_kernel_initializer=None, fcnet_kernel_initializer_kwargs=None, fcnet_bias_initializer=None, fcnet_bias_initializer_kwargs=None, conv_filters=None, conv_activation='relu', conv_kernel_initializer=None, conv_kernel_initializer_kwargs=None, conv_bias_initializer=None, conv_bias_initializer_kwargs=None, head_fcnet_hiddens=[], head_fcnet_activation='relu', head_fcnet_kernel_initializer=None, head_fcnet_kernel_initializer_kwargs=None, head_fcnet_bias_initializer=None, head_fcnet_bias_initializer_kwargs=None, free_log_std=False, log_std_clip_param=20.0, vf_share_layers=True, use_lstm=False, max_seq_len=20, lstm_cell_size=256, lstm_use_prev_action=False, lstm_use_prev_reward=False, lstm_kernel_initializer=None, lstm_kernel_initializer_kwargs=None, lstm_bias_initializer=None, lstm_bias_initializer_kwargs=None), catalog_class=None, load_state_path=None, model_config_dict=None)", "algorithm_config_overrides_per_module": {}, "_per_module_overrides": {}, "_validate_config": true, "_use_msgpack_checkpoints": false, "_torch_grad_scaler_class": null, "_torch_lr_scheduler_classes": null, "_tf_policy_handles_more_than_one_loss": false, "_disable_preprocessor_api": false, "_disable_action_flattening": false, "_disable_initialize_loss_from_dummy_batch": false, "_dont_auto_sync_env_runner_states": false, "env_task_fn": -1, "enable_connectors": -1, "simple_optimizer": false, "policy_map_cache": -1, "worker_cls": -1, "synchronize_filters": -1, "enable_async_evaluation": -1, "custom_async_evaluation_function": -1, "_enable_rl_module_api": -1, "auto_wrap_old_gym_envs": -1, "always_attach_evaluation_results": -1, "replay_sequence_length": null, "_disable_execution_plan_api": -1, "use_critic": true, "use_gae": true, "use_kl_loss": true, "kl_coeff": 0.7464963036515, "kl_target": 0.0270990929592, "vf_loss_coeff": 0.6688075857018, "entropy_coeff": 0.0090570820258, "clip_param": 0.1221781641624, "vf_clip_param": 0.1027808522125, "entropy_coeff_schedule": null, "lr_schedule": null, "sgd_minibatch_size": -1, "vf_share_layers": -1, "__stdout_file__": null, "__stderr_file__": null, "lambda": 0.9099046732075, "input": "sampler", "policies": {"default_policy": [null, null, null, null]}, "callbacks": "<class 'ray.rllib.callbacks.callbacks.RLlibCallback'>", "create_env_on_driver": false, "custom_eval_function": null, "framework": "torch"}, "time_since_restore": 15.619073867797852, "iterations_since_restore": 6, "perf": {"cpu_util_percent": 51.35, "ram_util_percent": 75.55}}
{"timers": {"training_iteration": 2.6483837637353194, "restore_env_runners": 1.434058265892202e-05, "training_step": 2.648202881934386, "env_runner_sampling_timer": 2.4893033008064127, "learner_update_timer": 0.15575372756085154, "synch_weights": 0.0006024246267812975, "restore_eval_env_runners": 9.002238229248043e-06, "evaluation_iteration": 0.1362413993935021, "synch_eval_env_connectors": 0.00023407752884575795, "synch_env_connectors": 4.777712422667956e-06}, "env_runners": {"num_episodes": 250.0, "module_to_env_connector": {"timers": {"connectors": {"remove_single_ts_time_rank_from_batch": 8.65572503122303e-07, "listify_data_for_vector_env": 1.6454867116850533e-05, "get_actions": 6.494986878538236e-05, "tensor_to_numpy": 2.0237872403570564e-05, "un_batch_to_individual_items": 7.83032350096689e-06, "normalize_and_clip_actions": 1.3870488021722523e-05}}, "connector_pipeline_timer": 0.00016090472921379697}, "episode_duration_sec_mean": 0.006964438691735267, "env_to_module_sum_episodes_length_in": 10.36823839457432, "episode_return_min": -10.5, "episode_len_max": 20, "episode_len_mean": 20.0, "env_step_timer": 2.1791664152927884e-05, "num_agent_steps_sampled": {"default_agent": 5000.0}, "module_episode_returns_mean": {"default_policy": 2.0599999999999996}, "num_agent_steps_sampled_lifetime": {"default_agent": -3077500.0}, "agent_episode_returns_mean": {"default_agent": 2.0599999999999996}, "weights_seq_no": 6.0, "env_to_module_connector": {"timers": {"connectors": {"add_observations_from_episodes_to_batch": 4.2043658600719616e-06, "numpy_to_tensor": 1.3812920772207191e-05, "add_states_from_episodes_to_batch": 2.3323775091870866e-06, "add_time_dim_to_batch_and_zero_pad": 3.3533756435099187e-06, "batch_individual_items": 9.667758203785733e-06}}, "connector_pipeline_timer": 6.287183270907453e-05}, "sample": 0.007480518716034393, "num_module_steps_sampled_lifetime": {"default_policy": -3077500.0}, "num_env_steps_sampled_lifetime": -3077500.0, "episode_len_min": 20, "episode_return_max": 9.5, "num_episodes_lifetime": -153875.0, "time_between_sampling": 0.002733741809495274, "num_module_steps_sampled": {"default_policy": 5000.0}, "env_reset_timer": 6.684770495534584e-05, "num_env_steps_sampled": 5000.0, "episode_return_mean": 2.0599999999999996, "rlmodule_inference_timer": 4.429138471500171e-05, "env_to_module_sum_episodes_length_out": 10.36823839457432, "num_env_steps_sampled_lifetime_throughput": 2633.780006369434}, "learners": {"__all_modules__": {"num_trainable_parameters": 6003, "learner_connector": {"timers": {"connectors": {"add_time_dim_to_batch_and_zero_pad": 2.509494029691626e-05, "batch_individual_items": 0.03852206071123206, "add_states_from_episodes_to_batch": 7.462931218029304e-06, "general_advantage_estimation": 0.00760832110635542, "add_columns_from_episodes_to_train_batch": 0.05913031967099287, "numpy_to_tensor": 7.718453172330766e-05, "add_one_ts_to_episodes_and_truncate": 0.013000096445976555, "add_observations_from_episodes_to_batch": 0.0019469910343980973}}, "connector_pipeline_timer": 0.12059501391075192}, "learner_connector_sum_episodes_length_in": 5000.0, "num_module_steps_trained": 6000, "num_non_trainable_parameters": 0, "num_module_steps_trained_lifetime": 42000, "learner_connector_sum_episodes_length_out": 5250.0, "num_env_steps_trained_lifetime": 220500, "num_env_steps_trained": 31500, "num_env_steps_trained_lifetime_throughput": 1687638.4713390768, "num_module_steps_trained_throughput": 322831.6905250098, "num_module_steps_trained_lifetime_throughput": 322266.37404438475}, "default_policy": {"vf_loss_unclipped": 28.562328338623047, "total_loss": 0.027804788202047348, "entropy": 0.6714522838592529, "num_trainable_parameters": 6003, "num_module_steps_trained_lifetime": 42000, "curr_kl_coeff": 0.0058320024982094765, "vf_explained_var": -0.010401129722595215, "weights_seq_no": 7.0, "policy_loss": -0.034859273582696915, "num_module_steps_trained": 6000, "curr_entropy_coeff": 0.0090570820258, "mean_kl_loss": 0.00041595392394810915, "module_train_batch_size_mean": 1000.0, "vf_loss": 0.10278083384037018, "gradients_default_optimizer_global_norm": 0.058202605694532394, "default_optimizer_learning_rate": 0.0002847858517, "diff_num_grad_updates_vs_sampler_policy": 1.0, "num_module_steps_trained_lifetime_throughput": 323706.88214640453}}, "num_training_step_calls_per_iteration": 1, "evaluation": {"env_runners": {"weights_seq_no": 7.0, "num_env_steps_sampled_lifetime": 35400, "module_to_env_connector": {"timers": {"connectors": {"remove_single_ts_time_rank_from_batch": 7.533475285067808e-07, "listify_data_for_vector_env": 1.3633900182888472e-05, "get_actions": 5.112374220709184e-05, "un_batch_to_individual_items": 6.60745598392802e-06, "tensor_to_numpy": 1.607542908460798e-05, "normalize_and_clip_actions": 1.1884691944153401e-05}}, "connector_pipeline_timer": 0.0001315809082524556}, "module_episode_returns_mean": {"default_policy": -1.15}, "episode_return_mean": -1.15, "rlmodule_inference_timer": 3.603560848408445e-05, "episode_duration_sec_mean": 0.006988443349255249, "env_to_module_connector": {"timers": {"connectors": {"add_observations_from_episodes_to_batch": 3.408120659424891e-06, "add_time_dim_to_batch_and_zero_pad": 2.8417464623613383e-06, "batch_individual_items": 7.555497296187076e-06, "add_states_from_episodes_to_batch": 1.7225197916548682e-06, "numpy_to_tensor": 1.1244291767907995e-05}}, "connector_pipeline_timer": 5.1878784607195716e-05}, "num_module_steps_sampled": {"default_policy": 400}, "episode_len_max": 20, "env_step_timer": 1.8196055073398072e-05, "sample": 0.129091491200359, "agent_episode_returns_mean": {"default_agent": -1.15}, "env_reset_timer": 0.0003455212704833608, "env_to_module_sum_episodes_length_in": 10.368238394572801, "episode_len_mean": 20.0, "num_agent_steps_sampled": {"default_agent": 400}, "num_agent_steps_sampled_lifetime": {"default_agent": 2800}, "num_env_steps_sampled": 400, "num_module_steps_sampled_lifetime": {"default_policy": 2800}, "env_to_module_sum_episodes_length_out": 10.368238394572801, "num_episodes": 20, "episode_return_min": -14.5, "episode_len_min": 20, "episode_return_max": 13.5, "num_episodes_lifetime": 140, "time_between_sampling": 2.4455195278002306}, "num_healthy_workers": 1, "actor_manager_num_outstanding_async_reqs": 0, "num_remote_worker_restarts": 0}, "num_env_steps_sampled_lifetime": -3077500.0, "fault_tolerance": {"num_healthy_workers": 0, "num_remote_worker_restarts": 0}, "env_runner_group": {"actor_manager_num_outstanding_async_reqs": 0}, "done": false, "training_iteration": 7, "trial_id": "46920_00000", "date": "2025-08-11_19-35-38", "timestamp": 1754933738, "time_this_iter_s": 2.4030978679656982, "time_total_s": 18.02217173576355, "pid": 27748, "hostname": "Mac", "node_ip": "127.0.0.1", "config": {"exploration_config": {}, "extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "placement_strategy": "PACK", "num_gpus": 0, "_fake_gpus": false, "num_cpus_for_main_process": 2, "eager_tracing": true, "eager_max_retraces": 20, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "torch_compile_learner": false, "torch_compile_learner_what_to_compile": "forward_train", "torch_compile_learner_dynamo_backend": "aot_eager", "torch_compile_learner_dynamo_mode": null, "torch_compile_worker": false, "torch_compile_worker_dynamo_backend": "aot_eager", "torch_compile_worker_dynamo_mode": null, "torch_ddp_kwargs": {}, "torch_skip_nan_gradients": false, "env": "Umbrella", "env_config": {}, "observation_space": null, "action_space": null, "clip_rewards": null, "normalize_actions": true, "clip_actions": false, "_is_atari": null, "disable_env_checking": false, "render_env": false, "action_mask_key": "action_mask", "env_runner_cls": null, "num_env_runners": 0, "create_local_env_runner": true, "num_envs_per_env_runner": 1, "gym_env_vectorize_mode": "SYNC", "num_cpus_per_env_runner": 1, "num_gpus_per_env_runner": 0, "custom_resources_per_env_runner": {}, "validate_env_runners_after_construction": true, "episodes_to_numpy": true, "max_requests_in_flight_per_env_runner": 1, "sample_timeout_s": 60.0, "_env_to_module_connector": null, "add_default_connectors_to_env_to_module_pipeline": true, "_module_to_env_connector": null, "add_default_connectors_to_module_to_env_pipeline": true, "merge_env_runner_states": "training_only", "broadcast_env_runner_states": true, "episode_lookback_horizon": 1, "rollout_fragment_length": "auto", "batch_mode": "complete_episodes", "compress_observations": false, "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "enable_tf1_exec_eagerly": false, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "preprocessor_pref": "deepmind", "observation_filter": "NoFilter", "update_worker_filter_stats": true, "use_worker_filter_stats": true, "sampler_perf_stats_ema_coef": null, "_is_online": true, "num_learners": 0, "num_gpus_per_learner": 0, "num_cpus_per_learner": "auto", "num_aggregator_actors_per_learner": 0, "max_requests_in_flight_per_aggregator_actor": 3, "local_gpu_idx": 0, "max_requests_in_flight_per_learner": 3, "gamma": 1, "lr": 0.0002847858517, "grad_clip": 0.5, "grad_clip_by": "global_norm", "_train_batch_size_per_learner": 5000, "train_batch_size": 4000, "num_epochs": 1, "minibatch_size": 1000, "shuffle_batch_per_epoch": true, "model": {"fcnet_hiddens": [256, 256], "fcnet_activation": "tanh", "fcnet_weights_initializer": null, "fcnet_weights_initializer_config": null, "fcnet_bias_initializer": null, "fcnet_bias_initializer_config": null, "conv_filters": null, "conv_activation": "relu", "conv_kernel_initializer": null, "conv_kernel_initializer_config": null, "conv_bias_initializer": null, "conv_bias_initializer_config": null, "conv_transpose_kernel_initializer": null, "conv_transpose_kernel_initializer_config": null, "conv_transpose_bias_initializer": null, "conv_transpose_bias_initializer_config": null, "post_fcnet_hiddens": [], "post_fcnet_activation": "relu", "post_fcnet_weights_initializer": null, "post_fcnet_weights_initializer_config": null, "post_fcnet_bias_initializer": null, "post_fcnet_bias_initializer_config": null, "free_log_std": false, "log_std_clip_param": 20.0, "no_final_linear": false, "vf_share_layers": false, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "lstm_weights_initializer": null, "lstm_weights_initializer_config": null, "lstm_bias_initializer": null, "lstm_bias_initializer_config": null, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "attention_use_n_prev_actions": 0, "attention_use_n_prev_rewards": 0, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": null, "custom_model_config": {}, "custom_action_dist": null, "custom_preprocessor": null, "encoder_latent_dim": null, "always_check_shapes": false, "lstm_use_prev_action_reward": -1, "_use_default_native_models": -1, "_disable_preprocessor_api": false, "_disable_action_flattening": false}, "_learner_connector": null, "add_default_connectors_to_learner_pipeline": true, "learner_config_dict": {}, "optimizer": {}, "_learner_class": null, "callbacks_on_algorithm_init": null, "callbacks_on_env_runners_recreated": null, "callbacks_on_offline_eval_runners_recreated": null, "callbacks_on_checkpoint_loaded": null, "callbacks_on_environment_created": null, "callbacks_on_episode_created": null, "callbacks_on_episode_start": null, "callbacks_on_episode_step": null, "callbacks_on_episode_end": null, "callbacks_on_evaluate_start": null, "callbacks_on_evaluate_end": null, "callbacks_on_evaluate_offline_start": null, "callbacks_on_evaluate_offline_end": null, "callbacks_on_sample_end": null, "callbacks_on_train_result": null, "explore": true, "enable_rl_module_and_learner": true, "enable_env_runner_and_connector_v2": true, "_prior_exploration_config": {"type": "StochasticSampling"}, "count_steps_by": "env_steps", "policy_map_capacity": 100, "policy_mapping_fn": "<function AlgorithmConfig.DEFAULT_POLICY_MAPPING_FN at 0x3847e9b20>", "policies_to_train": null, "policy_states_are_swappable": false, "observation_fn": null, "offline_data_class": null, "input_read_method": "read_parquet", "input_read_method_kwargs": {}, "input_read_schema": {}, "input_read_episodes": false, "input_read_sample_batches": false, "input_read_batch_size": null, "input_filesystem": null, "input_filesystem_kwargs": {}, "input_compress_columns": ["obs", "new_obs"], "input_spaces_jsonable": true, "materialize_data": false, "materialize_mapped_data": true, "map_batches_kwargs": {}, "iter_batches_kwargs": {}, "ignore_final_observation": false, "prelearner_class": null, "prelearner_buffer_class": null, "prelearner_buffer_kwargs": {}, "prelearner_module_synch_period": 10, "dataset_num_iters_per_learner": null, "input_config": {}, "actions_in_input_normalized": false, "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_config": {}, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "output_max_rows_per_file": null, "output_write_remaining_data": false, "output_write_method": "write_parquet", "output_write_method_kwargs": {}, "output_filesystem": null, "output_filesystem_kwargs": {}, "output_write_episodes": true, "offline_sampling": false, "evaluation_interval": 1, "evaluation_duration": 20, "evaluation_duration_unit": "episodes", "evaluation_sample_timeout_s": 120.0, "evaluation_auto_duration_min_env_steps_per_sample": 100, "evaluation_auto_duration_max_env_steps_per_sample": 2000, "evaluation_parallel_to_training": false, "evaluation_force_reset_envs_before_iteration": true, "evaluation_config": null, "off_policy_estimation_methods": {}, "ope_split_batch_by_episode": true, "evaluation_num_env_runners": 1, "in_evaluation": false, "sync_filters_on_rollout_workers_timeout_s": 10.0, "offline_evaluation_interval": null, "num_offline_eval_runners": 0, "offline_loss_for_module_fn": null, "offline_evaluation_duration": 1, "offline_evaluation_parallel_to_training": false, "offline_evaluation_timeout_s": 120.0, "num_cpus_per_offline_eval_runner": 1, "num_gpus_per_offline_eval_runner": 0, "custom_resources_per_offline_eval_runner": {}, "restart_failed_offline_eval_runners": true, "ignore_offline_eval_runner_failures": false, "max_num_offline_eval_runner_restarts": 1000, "offline_eval_runner_restore_timeout_s": 1800.0, "max_requests_in_flight_per_offline_eval_runner": 1, "validate_offline_eval_runners_after_construction": true, "offline_eval_runner_health_probe_timeout_s": 30.0, "offline_eval_rl_module_inference_only": false, "broadcast_offline_eval_runner_states": false, "offline_eval_batch_size_per_runner": 256, "dataset_num_iters_per_eval_runner": 1, "keep_per_episode_custom_metrics": false, "metrics_episode_collection_timeout_s": 60.0, "metrics_num_episodes_for_smoothing": 100, "min_time_s_per_iteration": null, "min_train_timesteps_per_iteration": 0, "min_sample_timesteps_per_iteration": 0, "log_gradients": true, "export_native_model_files": false, "checkpoint_trainable_policies_only": false, "logger_creator": null, "logger_config": null, "log_level": "WARN", "log_sys_usage": true, "fake_sampler": false, "seed": 10, "restart_failed_env_runners": true, "ignore_env_runner_failures": false, "max_num_env_runner_restarts": 1000, "delay_between_env_runner_restarts_s": 60.0, "restart_failed_sub_environments": false, "num_consecutive_env_runner_failures_tolerance": 100, "env_runner_health_probe_timeout_s": 30.0, "env_runner_restore_timeout_s": 1800.0, "_model_config": {}, "_rl_module_spec": "RLModuleSpec(module_class=None, observation_space=None, action_space=None, inference_only=False, learner_only=False, model_config=DefaultModelConfig(fcnet_hiddens=[60, 90], fcnet_activation='tanh', fcnet_kernel_initializer=None, fcnet_kernel_initializer_kwargs=None, fcnet_bias_initializer=None, fcnet_bias_initializer_kwargs=None, conv_filters=None, conv_activation='relu', conv_kernel_initializer=None, conv_kernel_initializer_kwargs=None, conv_bias_initializer=None, conv_bias_initializer_kwargs=None, head_fcnet_hiddens=[], head_fcnet_activation='relu', head_fcnet_kernel_initializer=None, head_fcnet_kernel_initializer_kwargs=None, head_fcnet_bias_initializer=None, head_fcnet_bias_initializer_kwargs=None, free_log_std=False, log_std_clip_param=20.0, vf_share_layers=True, use_lstm=False, max_seq_len=20, lstm_cell_size=256, lstm_use_prev_action=False, lstm_use_prev_reward=False, lstm_kernel_initializer=None, lstm_kernel_initializer_kwargs=None, lstm_bias_initializer=None, lstm_bias_initializer_kwargs=None), catalog_class=None, load_state_path=None, model_config_dict=None)", "algorithm_config_overrides_per_module": {}, "_per_module_overrides": {}, "_validate_config": true, "_use_msgpack_checkpoints": false, "_torch_grad_scaler_class": null, "_torch_lr_scheduler_classes": null, "_tf_policy_handles_more_than_one_loss": false, "_disable_preprocessor_api": false, "_disable_action_flattening": false, "_disable_initialize_loss_from_dummy_batch": false, "_dont_auto_sync_env_runner_states": false, "env_task_fn": -1, "enable_connectors": -1, "simple_optimizer": false, "policy_map_cache": -1, "worker_cls": -1, "synchronize_filters": -1, "enable_async_evaluation": -1, "custom_async_evaluation_function": -1, "_enable_rl_module_api": -1, "auto_wrap_old_gym_envs": -1, "always_attach_evaluation_results": -1, "replay_sequence_length": null, "_disable_execution_plan_api": -1, "use_critic": true, "use_gae": true, "use_kl_loss": true, "kl_coeff": 0.7464963036515, "kl_target": 0.0270990929592, "vf_loss_coeff": 0.6688075857018, "entropy_coeff": 0.0090570820258, "clip_param": 0.1221781641624, "vf_clip_param": 0.1027808522125, "entropy_coeff_schedule": null, "lr_schedule": null, "sgd_minibatch_size": -1, "vf_share_layers": -1, "__stdout_file__": null, "__stderr_file__": null, "lambda": 0.9099046732075, "input": "sampler", "policies": {"default_policy": [null, null, null, null]}, "callbacks": "<class 'ray.rllib.callbacks.callbacks.RLlibCallback'>", "create_env_on_driver": false, "custom_eval_function": null, "framework": "torch"}, "time_since_restore": 18.02217173576355, "iterations_since_restore": 7, "perf": {"cpu_util_percent": 67.33333333333333, "ram_util_percent": 75.53333333333333}}
{"timers": {"training_iteration": 2.6462549765176564, "restore_env_runners": 1.4275086622312259e-05, "training_step": 2.646072796444717, "env_runner_sampling_timer": 2.4875164744585074, "learner_update_timer": 0.15539037695455174, "synch_weights": 0.0006092158005636585, "restore_eval_env_runners": 8.97804521898904e-06, "evaluation_iteration": 0.13629740206846086, "synch_eval_env_connectors": 0.00023299634405640345, "synch_env_connectors": 4.785354812396989e-06}, "env_runners": {"num_episodes": 250.0, "module_to_env_connector": {"timers": {"connectors": {"remove_single_ts_time_rank_from_batch": 8.525367766115784e-07, "listify_data_for_vector_env": 1.6972588221719054e-05, "get_actions": 6.718737386159443e-05, "tensor_to_numpy": 2.120221957141654e-05, "un_batch_to_individual_items": 8.132690702622809e-06, "normalize_and_clip_actions": 1.4204776392275628e-05}}, "connector_pipeline_timer": 0.00016713905935377077}, "episode_duration_sec_mean": 0.007742072318214923, "env_to_module_sum_episodes_length_in": 10.36823839457432, "episode_return_min": -10.5, "episode_len_max": 20, "episode_len_mean": 20.0, "env_step_timer": 2.2577710763248832e-05, "num_agent_steps_sampled": {"default_agent": 5000.0}, "module_episode_returns_mean": {"default_policy": 1.6599999999999997}, "num_agent_steps_sampled_lifetime": {"default_agent": -3695000.0}, "agent_episode_returns_mean": {"default_agent": 1.6599999999999997}, "weights_seq_no": 7.0, "env_to_module_connector": {"timers": {"connectors": {"add_observations_from_episodes_to_batch": 4.301597328303758e-06, "numpy_to_tensor": 1.3999300649987358e-05, "add_states_from_episodes_to_batch": 2.375670673935841e-06, "add_time_dim_to_batch_and_zero_pad": 3.4763904208445866e-06, "batch_individual_items": 1.0966314324278043e-05}}, "connector_pipeline_timer": 6.678945455630744e-05}, "sample": 0.008043109016594156, "num_module_steps_sampled_lifetime": {"default_policy": -3695000.0}, "num_env_steps_sampled_lifetime": -3695000.0, "episode_len_min": 20, "episode_return_max": 9.5, "num_episodes_lifetime": -184750.0, "time_between_sampling": 0.0022485427110317743, "num_module_steps_sampled": {"default_policy": 5000.0}, "env_reset_timer": 6.569333924884272e-05, "num_env_steps_sampled": 5000.0, "episode_return_mean": 1.6599999999999997, "rlmodule_inference_timer": 6.895785993534262e-05, "env_to_module_sum_episodes_length_out": 10.36823839457432, "num_env_steps_sampled_lifetime_throughput": 2575.436165869783}, "learners": {"__all_modules__": {"num_trainable_parameters": 6003, "learner_connector": {"timers": {"connectors": {"add_time_dim_to_batch_and_zero_pad": 2.496233172519705e-05, "batch_individual_items": 0.03853695802390005, "add_states_from_episodes_to_batch": 7.427891264342696e-06, "general_advantage_estimation": 0.007593669145361156, "add_columns_from_episodes_to_train_batch": 0.058938589394569973, "numpy_to_tensor": 7.706351674012702e-05, "add_one_ts_to_episodes_and_truncate": 0.012952814231280235, "add_observations_from_episodes_to_batch": 0.0019570636249057922}}, "connector_pipeline_timer": 0.12036457419145646}, "learner_connector_sum_episodes_length_in": 5000.0, "num_module_steps_trained": 6000, "num_non_trainable_parameters": 0, "num_module_steps_trained_lifetime": 48000, "learner_connector_sum_episodes_length_out": 5250.0, "num_env_steps_trained_lifetime": 252000, "num_env_steps_trained": 31500, "num_env_steps_trained_lifetime_throughput": 1670584.2341875418, "num_module_steps_trained_throughput": 319524.72156970773, "num_module_steps_trained_lifetime_throughput": 318980.6048611673}, "default_policy": {"vf_loss_unclipped": 28.607404708862305, "total_loss": 0.06938596069812775, "entropy": 0.6594521403312683, "num_trainable_parameters": 6003, "num_module_steps_trained_lifetime": 48000, "curr_kl_coeff": 0.0029160012491047382, "vf_explained_var": -0.010833382606506348, "weights_seq_no": 8.0, "policy_loss": 0.006612226366996765, "num_module_steps_trained": 6000, "curr_entropy_coeff": 0.0090570820258, "mean_kl_loss": 0.0010036317398771644, "module_train_batch_size_mean": 1000.0, "vf_loss": 0.10278083384037018, "gradients_default_optimizer_global_norm": 0.019486667588353157, "default_optimizer_learning_rate": 0.0002847858517, "diff_num_grad_updates_vs_sampler_policy": 1.0, "num_module_steps_trained_lifetime_throughput": 320348.6554767082}}, "num_training_step_calls_per_iteration": 1, "evaluation": {"env_runners": {"weights_seq_no": 8.0, "num_env_steps_sampled_lifetime": 40400, "module_to_env_connector": {"timers": {"connectors": {"remove_single_ts_time_rank_from_batch": 7.773992935862966e-07, "listify_data_for_vector_env": 1.5745152868328103e-05, "get_actions": 5.1296081987697886e-05, "un_batch_to_individual_items": 8.218260666305083e-06, "tensor_to_numpy": 1.6999442007017966e-05, "normalize_and_clip_actions": 1.6206844111420302e-05}}, "connector_pipeline_timer": 0.00014122939873728653}, "module_episode_returns_mean": {"default_policy": -0.55}, "episode_return_mean": -0.55, "rlmodule_inference_timer": 3.534526826158786e-05, "episode_duration_sec_mean": 0.007088061247486621, "env_to_module_connector": {"timers": {"connectors": {"add_observations_from_episodes_to_batch": 3.761753005393602e-06, "add_time_dim_to_batch_and_zero_pad": 2.97835852318514e-06, "batch_individual_items": 8.424014201223965e-06, "add_states_from_episodes_to_batch": 2.46564173620218e-06, "numpy_to_tensor": 1.1824517900856338e-05}}, "connector_pipeline_timer": 5.6710871069118654e-05}, "num_module_steps_sampled": {"default_policy": 400}, "episode_len_max": 20, "env_step_timer": 1.9928518591491828e-05, "sample": 0.12917555795829733, "agent_episode_returns_mean": {"default_agent": -0.55}, "env_reset_timer": 0.00034287438756563254, "env_to_module_sum_episodes_length_in": 10.3682383945743, "episode_len_mean": 20.0, "num_agent_steps_sampled": {"default_agent": 400}, "num_agent_steps_sampled_lifetime": {"default_agent": 3200}, "num_env_steps_sampled": 400, "num_module_steps_sampled_lifetime": {"default_policy": 3200}, "env_to_module_sum_episodes_length_out": 10.3682383945743, "num_episodes": 20, "episode_return_min": -14.5, "episode_len_min": 20, "episode_return_max": 13.5, "num_episodes_lifetime": 160, "time_between_sampling": 2.445649765862627}, "num_healthy_workers": 1, "actor_manager_num_outstanding_async_reqs": 0, "num_remote_worker_restarts": 0}, "num_env_steps_sampled_lifetime": -3695000.0, "fault_tolerance": {"num_healthy_workers": 0, "num_remote_worker_restarts": 0}, "env_runner_group": {"actor_manager_num_outstanding_async_reqs": 0}, "done": false, "training_iteration": 8, "trial_id": "46920_00000", "date": "2025-08-11_19-35-40", "timestamp": 1754933740, "time_this_iter_s": 2.5836901664733887, "time_total_s": 20.60586190223694, "pid": 27748, "hostname": "Mac", "node_ip": "127.0.0.1", "config": {"exploration_config": {}, "extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "placement_strategy": "PACK", "num_gpus": 0, "_fake_gpus": false, "num_cpus_for_main_process": 2, "eager_tracing": true, "eager_max_retraces": 20, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "torch_compile_learner": false, "torch_compile_learner_what_to_compile": "forward_train", "torch_compile_learner_dynamo_backend": "aot_eager", "torch_compile_learner_dynamo_mode": null, "torch_compile_worker": false, "torch_compile_worker_dynamo_backend": "aot_eager", "torch_compile_worker_dynamo_mode": null, "torch_ddp_kwargs": {}, "torch_skip_nan_gradients": false, "env": "Umbrella", "env_config": {}, "observation_space": null, "action_space": null, "clip_rewards": null, "normalize_actions": true, "clip_actions": false, "_is_atari": null, "disable_env_checking": false, "render_env": false, "action_mask_key": "action_mask", "env_runner_cls": null, "num_env_runners": 0, "create_local_env_runner": true, "num_envs_per_env_runner": 1, "gym_env_vectorize_mode": "SYNC", "num_cpus_per_env_runner": 1, "num_gpus_per_env_runner": 0, "custom_resources_per_env_runner": {}, "validate_env_runners_after_construction": true, "episodes_to_numpy": true, "max_requests_in_flight_per_env_runner": 1, "sample_timeout_s": 60.0, "_env_to_module_connector": null, "add_default_connectors_to_env_to_module_pipeline": true, "_module_to_env_connector": null, "add_default_connectors_to_module_to_env_pipeline": true, "merge_env_runner_states": "training_only", "broadcast_env_runner_states": true, "episode_lookback_horizon": 1, "rollout_fragment_length": "auto", "batch_mode": "complete_episodes", "compress_observations": false, "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "enable_tf1_exec_eagerly": false, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "preprocessor_pref": "deepmind", "observation_filter": "NoFilter", "update_worker_filter_stats": true, "use_worker_filter_stats": true, "sampler_perf_stats_ema_coef": null, "_is_online": true, "num_learners": 0, "num_gpus_per_learner": 0, "num_cpus_per_learner": "auto", "num_aggregator_actors_per_learner": 0, "max_requests_in_flight_per_aggregator_actor": 3, "local_gpu_idx": 0, "max_requests_in_flight_per_learner": 3, "gamma": 1, "lr": 0.0002847858517, "grad_clip": 0.5, "grad_clip_by": "global_norm", "_train_batch_size_per_learner": 5000, "train_batch_size": 4000, "num_epochs": 1, "minibatch_size": 1000, "shuffle_batch_per_epoch": true, "model": {"fcnet_hiddens": [256, 256], "fcnet_activation": "tanh", "fcnet_weights_initializer": null, "fcnet_weights_initializer_config": null, "fcnet_bias_initializer": null, "fcnet_bias_initializer_config": null, "conv_filters": null, "conv_activation": "relu", "conv_kernel_initializer": null, "conv_kernel_initializer_config": null, "conv_bias_initializer": null, "conv_bias_initializer_config": null, "conv_transpose_kernel_initializer": null, "conv_transpose_kernel_initializer_config": null, "conv_transpose_bias_initializer": null, "conv_transpose_bias_initializer_config": null, "post_fcnet_hiddens": [], "post_fcnet_activation": "relu", "post_fcnet_weights_initializer": null, "post_fcnet_weights_initializer_config": null, "post_fcnet_bias_initializer": null, "post_fcnet_bias_initializer_config": null, "free_log_std": false, "log_std_clip_param": 20.0, "no_final_linear": false, "vf_share_layers": false, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "lstm_weights_initializer": null, "lstm_weights_initializer_config": null, "lstm_bias_initializer": null, "lstm_bias_initializer_config": null, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "attention_use_n_prev_actions": 0, "attention_use_n_prev_rewards": 0, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": null, "custom_model_config": {}, "custom_action_dist": null, "custom_preprocessor": null, "encoder_latent_dim": null, "always_check_shapes": false, "lstm_use_prev_action_reward": -1, "_use_default_native_models": -1, "_disable_preprocessor_api": false, "_disable_action_flattening": false}, "_learner_connector": null, "add_default_connectors_to_learner_pipeline": true, "learner_config_dict": {}, "optimizer": {}, "_learner_class": null, "callbacks_on_algorithm_init": null, "callbacks_on_env_runners_recreated": null, "callbacks_on_offline_eval_runners_recreated": null, "callbacks_on_checkpoint_loaded": null, "callbacks_on_environment_created": null, "callbacks_on_episode_created": null, "callbacks_on_episode_start": null, "callbacks_on_episode_step": null, "callbacks_on_episode_end": null, "callbacks_on_evaluate_start": null, "callbacks_on_evaluate_end": null, "callbacks_on_evaluate_offline_start": null, "callbacks_on_evaluate_offline_end": null, "callbacks_on_sample_end": null, "callbacks_on_train_result": null, "explore": true, "enable_rl_module_and_learner": true, "enable_env_runner_and_connector_v2": true, "_prior_exploration_config": {"type": "StochasticSampling"}, "count_steps_by": "env_steps", "policy_map_capacity": 100, "policy_mapping_fn": "<function AlgorithmConfig.DEFAULT_POLICY_MAPPING_FN at 0x3847e9b20>", "policies_to_train": null, "policy_states_are_swappable": false, "observation_fn": null, "offline_data_class": null, "input_read_method": "read_parquet", "input_read_method_kwargs": {}, "input_read_schema": {}, "input_read_episodes": false, "input_read_sample_batches": false, "input_read_batch_size": null, "input_filesystem": null, "input_filesystem_kwargs": {}, "input_compress_columns": ["obs", "new_obs"], "input_spaces_jsonable": true, "materialize_data": false, "materialize_mapped_data": true, "map_batches_kwargs": {}, "iter_batches_kwargs": {}, "ignore_final_observation": false, "prelearner_class": null, "prelearner_buffer_class": null, "prelearner_buffer_kwargs": {}, "prelearner_module_synch_period": 10, "dataset_num_iters_per_learner": null, "input_config": {}, "actions_in_input_normalized": false, "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_config": {}, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "output_max_rows_per_file": null, "output_write_remaining_data": false, "output_write_method": "write_parquet", "output_write_method_kwargs": {}, "output_filesystem": null, "output_filesystem_kwargs": {}, "output_write_episodes": true, "offline_sampling": false, "evaluation_interval": 1, "evaluation_duration": 20, "evaluation_duration_unit": "episodes", "evaluation_sample_timeout_s": 120.0, "evaluation_auto_duration_min_env_steps_per_sample": 100, "evaluation_auto_duration_max_env_steps_per_sample": 2000, "evaluation_parallel_to_training": false, "evaluation_force_reset_envs_before_iteration": true, "evaluation_config": null, "off_policy_estimation_methods": {}, "ope_split_batch_by_episode": true, "evaluation_num_env_runners": 1, "in_evaluation": false, "sync_filters_on_rollout_workers_timeout_s": 10.0, "offline_evaluation_interval": null, "num_offline_eval_runners": 0, "offline_loss_for_module_fn": null, "offline_evaluation_duration": 1, "offline_evaluation_parallel_to_training": false, "offline_evaluation_timeout_s": 120.0, "num_cpus_per_offline_eval_runner": 1, "num_gpus_per_offline_eval_runner": 0, "custom_resources_per_offline_eval_runner": {}, "restart_failed_offline_eval_runners": true, "ignore_offline_eval_runner_failures": false, "max_num_offline_eval_runner_restarts": 1000, "offline_eval_runner_restore_timeout_s": 1800.0, "max_requests_in_flight_per_offline_eval_runner": 1, "validate_offline_eval_runners_after_construction": true, "offline_eval_runner_health_probe_timeout_s": 30.0, "offline_eval_rl_module_inference_only": false, "broadcast_offline_eval_runner_states": false, "offline_eval_batch_size_per_runner": 256, "dataset_num_iters_per_eval_runner": 1, "keep_per_episode_custom_metrics": false, "metrics_episode_collection_timeout_s": 60.0, "metrics_num_episodes_for_smoothing": 100, "min_time_s_per_iteration": null, "min_train_timesteps_per_iteration": 0, "min_sample_timesteps_per_iteration": 0, "log_gradients": true, "export_native_model_files": false, "checkpoint_trainable_policies_only": false, "logger_creator": null, "logger_config": null, "log_level": "WARN", "log_sys_usage": true, "fake_sampler": false, "seed": 10, "restart_failed_env_runners": true, "ignore_env_runner_failures": false, "max_num_env_runner_restarts": 1000, "delay_between_env_runner_restarts_s": 60.0, "restart_failed_sub_environments": false, "num_consecutive_env_runner_failures_tolerance": 100, "env_runner_health_probe_timeout_s": 30.0, "env_runner_restore_timeout_s": 1800.0, "_model_config": {}, "_rl_module_spec": "RLModuleSpec(module_class=None, observation_space=None, action_space=None, inference_only=False, learner_only=False, model_config=DefaultModelConfig(fcnet_hiddens=[60, 90], fcnet_activation='tanh', fcnet_kernel_initializer=None, fcnet_kernel_initializer_kwargs=None, fcnet_bias_initializer=None, fcnet_bias_initializer_kwargs=None, conv_filters=None, conv_activation='relu', conv_kernel_initializer=None, conv_kernel_initializer_kwargs=None, conv_bias_initializer=None, conv_bias_initializer_kwargs=None, head_fcnet_hiddens=[], head_fcnet_activation='relu', head_fcnet_kernel_initializer=None, head_fcnet_kernel_initializer_kwargs=None, head_fcnet_bias_initializer=None, head_fcnet_bias_initializer_kwargs=None, free_log_std=False, log_std_clip_param=20.0, vf_share_layers=True, use_lstm=False, max_seq_len=20, lstm_cell_size=256, lstm_use_prev_action=False, lstm_use_prev_reward=False, lstm_kernel_initializer=None, lstm_kernel_initializer_kwargs=None, lstm_bias_initializer=None, lstm_bias_initializer_kwargs=None), catalog_class=None, load_state_path=None, model_config_dict=None)", "algorithm_config_overrides_per_module": {}, "_per_module_overrides": {}, "_validate_config": true, "_use_msgpack_checkpoints": false, "_torch_grad_scaler_class": null, "_torch_lr_scheduler_classes": null, "_tf_policy_handles_more_than_one_loss": false, "_disable_preprocessor_api": false, "_disable_action_flattening": false, "_disable_initialize_loss_from_dummy_batch": false, "_dont_auto_sync_env_runner_states": false, "env_task_fn": -1, "enable_connectors": -1, "simple_optimizer": false, "policy_map_cache": -1, "worker_cls": -1, "synchronize_filters": -1, "enable_async_evaluation": -1, "custom_async_evaluation_function": -1, "_enable_rl_module_api": -1, "auto_wrap_old_gym_envs": -1, "always_attach_evaluation_results": -1, "replay_sequence_length": null, "_disable_execution_plan_api": -1, "use_critic": true, "use_gae": true, "use_kl_loss": true, "kl_coeff": 0.7464963036515, "kl_target": 0.0270990929592, "vf_loss_coeff": 0.6688075857018, "entropy_coeff": 0.0090570820258, "clip_param": 0.1221781641624, "vf_clip_param": 0.1027808522125, "entropy_coeff_schedule": null, "lr_schedule": null, "sgd_minibatch_size": -1, "vf_share_layers": -1, "__stdout_file__": null, "__stderr_file__": null, "lambda": 0.9099046732075, "input": "sampler", "policies": {"default_policy": [null, null, null, null]}, "callbacks": "<class 'ray.rllib.callbacks.callbacks.RLlibCallback'>", "create_env_on_driver": false, "custom_eval_function": null, "framework": "torch"}, "time_since_restore": 20.60586190223694, "iterations_since_restore": 8, "perf": {"cpu_util_percent": 68.1, "ram_util_percent": 75.32499999999999}}
{"timers": {"training_iteration": 2.643300946753094, "restore_env_runners": 1.4190665653090523e-05, "training_step": 2.6431184489011468, "env_runner_sampling_timer": 2.483534274713579, "learner_update_timer": 0.15641325818528018, "synch_weights": 0.0006103703030923144, "restore_eval_env_runners": 8.963265337886152e-06, "evaluation_iteration": 0.1363758197076768, "synch_eval_env_connectors": 0.0002332592909298182, "synch_env_connectors": 4.780421265124174e-06}, "env_runners": {"num_episodes": 250.0, "module_to_env_connector": {"timers": {"connectors": {"remove_single_ts_time_rank_from_batch": 8.747592623227412e-07, "listify_data_for_vector_env": 1.649263744426648e-05, "get_actions": 6.408074581906635e-05, "tensor_to_numpy": 2.0693598089058442e-05, "un_batch_to_individual_items": 7.615027851712576e-06, "normalize_and_clip_actions": 1.3601422988684078e-05}}, "connector_pipeline_timer": 0.00016003111532184218}, "episode_duration_sec_mean": 0.006938955281861129, "env_to_module_sum_episodes_length_in": 10.36823839457432, "episode_return_min": -10.5, "episode_len_max": 20, "episode_len_mean": 20.0, "env_step_timer": 2.1903315886095673e-05, "num_agent_steps_sampled": {"default_agent": 5000.0}, "module_episode_returns_mean": {"default_policy": 2.379999999999999}, "num_agent_steps_sampled_lifetime": {"default_agent": -4312500.0}, "agent_episode_returns_mean": {"default_agent": 2.379999999999999}, "weights_seq_no": 8.0, "env_to_module_connector": {"timers": {"connectors": {"add_observations_from_episodes_to_batch": 4.315708218555818e-06, "numpy_to_tensor": 1.3895741595389532e-05, "add_states_from_episodes_to_batch": 2.2515735347740493e-06, "add_time_dim_to_batch_and_zero_pad": 3.339031393005735e-06, "batch_individual_items": 9.66542687272818e-06}}, "connector_pipeline_timer": 6.319297812303871e-05}, "sample": 0.007617490051512031, "num_module_steps_sampled_lifetime": {"default_policy": -4312500.0}, "num_env_steps_sampled_lifetime": -4312500.0, "episode_len_min": 20, "episode_return_max": 9.5, "num_episodes_lifetime": -215625.0, "time_between_sampling": 0.0020853155703254513, "num_module_steps_sampled": {"default_policy": 5000.0}, "env_reset_timer": 6.533982934973919e-05, "num_env_steps_sampled": 5000.0, "episode_return_mean": 2.379999999999999, "rlmodule_inference_timer": 4.338260518318232e-05, "env_to_module_sum_episodes_length_out": 10.36823839457432, "num_env_steps_sampled_lifetime_throughput": 2652.9065807470206}, "learners": {"__all_modules__": {"num_trainable_parameters": 6003, "learner_connector": {"timers": {"connectors": {"add_time_dim_to_batch_and_zero_pad": 2.483853823684816e-05, "batch_individual_items": 0.038548267194064276, "add_states_from_episodes_to_batch": 7.391942096410787e-06, "general_advantage_estimation": 0.007584949533830101, "add_columns_from_episodes_to_train_batch": 0.05882096558060264, "numpy_to_tensor": 7.698621164831756e-05, "add_one_ts_to_episodes_and_truncate": 0.014281681509308253, "add_observations_from_episodes_to_batch": 0.0019475875684316205}}, "connector_pipeline_timer": 0.1215673071999984}, "learner_connector_sum_episodes_length_in": 5000.0, "num_module_steps_trained": 6000, "num_non_trainable_parameters": 0, "num_module_steps_trained_lifetime": 54000, "learner_connector_sum_episodes_length_out": 5250.0, "num_env_steps_trained_lifetime": 283500, "num_env_steps_trained": 31500, "num_env_steps_trained_lifetime_throughput": 1659812.4759513065, "num_module_steps_trained_throughput": 317418.2511832716, "num_module_steps_trained_lifetime_throughput": 316893.8780227356}, "default_policy": {"vf_loss_unclipped": 28.564573287963867, "total_loss": -0.021834900602698326, "entropy": 0.6498231291770935, "num_trainable_parameters": 6003, "num_module_steps_trained_lifetime": 54000, "curr_kl_coeff": 0.0014580006245523691, "vf_explained_var": -0.010897278785705566, "weights_seq_no": 9.0, "policy_loss": -0.08469157665967941, "num_module_steps_trained": 6000, "curr_entropy_coeff": 0.0090570820258, "mean_kl_loss": 0.000535716419108212, "module_train_batch_size_mean": 1000.0, "vf_loss": 0.10278083384037018, "gradients_default_optimizer_global_norm": 0.05511411279439926, "default_optimizer_learning_rate": 0.0002847858517, "diff_num_grad_updates_vs_sampler_policy": 1.0, "num_module_steps_trained_lifetime_throughput": 318185.6322377196}}, "num_training_step_calls_per_iteration": 1, "evaluation": {"env_runners": {"weights_seq_no": 9.0, "num_env_steps_sampled_lifetime": 45400, "module_to_env_connector": {"timers": {"connectors": {"remove_single_ts_time_rank_from_batch": 6.477812679699803e-07, "listify_data_for_vector_env": 1.2418083648416944e-05, "get_actions": 4.3287571542610407e-05, "un_batch_to_individual_items": 6.073357168279604e-06, "tensor_to_numpy": 1.478165529688009e-05, "normalize_and_clip_actions": 1.0672239749268178e-05}}, "connector_pipeline_timer": 0.0001157720853222091}, "module_episode_returns_mean": {"default_policy": -0.35}, "episode_return_mean": -0.35, "rlmodule_inference_timer": 3.217060393890602e-05, "episode_duration_sec_mean": 0.006494273317512125, "env_to_module_connector": {"timers": {"connectors": {"add_observations_from_episodes_to_batch": 3.022995227808622e-06, "add_time_dim_to_batch_and_zero_pad": 2.415988023723502e-06, "batch_individual_items": 7.048947287721288e-06, "add_states_from_episodes_to_batch": 1.6021366194130737e-06, "numpy_to_tensor": 9.912921859811995e-06}}, "connector_pipeline_timer": 4.7184775149617976e-05}, "num_module_steps_sampled": {"default_policy": 400}, "episode_len_max": 20, "env_step_timer": 1.5972666391104284e-05, "sample": 0.12905986195888955, "agent_episode_returns_mean": {"default_agent": -0.35}, "env_reset_timer": 0.000340194394443677, "env_to_module_sum_episodes_length_in": 10.368238394574323, "episode_len_mean": 20.0, "num_agent_steps_sampled": {"default_agent": 400}, "num_agent_steps_sampled_lifetime": {"default_agent": 3600}, "num_env_steps_sampled": 400, "num_module_steps_sampled_lifetime": {"default_policy": 3600}, "env_to_module_sum_episodes_length_out": 10.368238394574323, "num_episodes": 20, "episode_return_min": -14.5, "episode_len_min": 20, "episode_return_max": 13.5, "num_episodes_lifetime": 180, "time_between_sampling": 2.4449110011143005}, "num_healthy_workers": 1, "actor_manager_num_outstanding_async_reqs": 0, "num_remote_worker_restarts": 0}, "num_env_steps_sampled_lifetime": -4312500.0, "fault_tolerance": {"num_healthy_workers": 0, "num_remote_worker_restarts": 0}, "env_runner_group": {"actor_manager_num_outstanding_async_reqs": 0}, "done": false, "training_iteration": 9, "trial_id": "46920_00000", "date": "2025-08-11_19-35-43", "timestamp": 1754933743, "time_this_iter_s": 2.475996971130371, "time_total_s": 23.08185887336731, "pid": 27748, "hostname": "Mac", "node_ip": "127.0.0.1", "config": {"exploration_config": {}, "extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "placement_strategy": "PACK", "num_gpus": 0, "_fake_gpus": false, "num_cpus_for_main_process": 2, "eager_tracing": true, "eager_max_retraces": 20, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "torch_compile_learner": false, "torch_compile_learner_what_to_compile": "forward_train", "torch_compile_learner_dynamo_backend": "aot_eager", "torch_compile_learner_dynamo_mode": null, "torch_compile_worker": false, "torch_compile_worker_dynamo_backend": "aot_eager", "torch_compile_worker_dynamo_mode": null, "torch_ddp_kwargs": {}, "torch_skip_nan_gradients": false, "env": "Umbrella", "env_config": {}, "observation_space": null, "action_space": null, "clip_rewards": null, "normalize_actions": true, "clip_actions": false, "_is_atari": null, "disable_env_checking": false, "render_env": false, "action_mask_key": "action_mask", "env_runner_cls": null, "num_env_runners": 0, "create_local_env_runner": true, "num_envs_per_env_runner": 1, "gym_env_vectorize_mode": "SYNC", "num_cpus_per_env_runner": 1, "num_gpus_per_env_runner": 0, "custom_resources_per_env_runner": {}, "validate_env_runners_after_construction": true, "episodes_to_numpy": true, "max_requests_in_flight_per_env_runner": 1, "sample_timeout_s": 60.0, "_env_to_module_connector": null, "add_default_connectors_to_env_to_module_pipeline": true, "_module_to_env_connector": null, "add_default_connectors_to_module_to_env_pipeline": true, "merge_env_runner_states": "training_only", "broadcast_env_runner_states": true, "episode_lookback_horizon": 1, "rollout_fragment_length": "auto", "batch_mode": "complete_episodes", "compress_observations": false, "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "enable_tf1_exec_eagerly": false, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "preprocessor_pref": "deepmind", "observation_filter": "NoFilter", "update_worker_filter_stats": true, "use_worker_filter_stats": true, "sampler_perf_stats_ema_coef": null, "_is_online": true, "num_learners": 0, "num_gpus_per_learner": 0, "num_cpus_per_learner": "auto", "num_aggregator_actors_per_learner": 0, "max_requests_in_flight_per_aggregator_actor": 3, "local_gpu_idx": 0, "max_requests_in_flight_per_learner": 3, "gamma": 1, "lr": 0.0002847858517, "grad_clip": 0.5, "grad_clip_by": "global_norm", "_train_batch_size_per_learner": 5000, "train_batch_size": 4000, "num_epochs": 1, "minibatch_size": 1000, "shuffle_batch_per_epoch": true, "model": {"fcnet_hiddens": [256, 256], "fcnet_activation": "tanh", "fcnet_weights_initializer": null, "fcnet_weights_initializer_config": null, "fcnet_bias_initializer": null, "fcnet_bias_initializer_config": null, "conv_filters": null, "conv_activation": "relu", "conv_kernel_initializer": null, "conv_kernel_initializer_config": null, "conv_bias_initializer": null, "conv_bias_initializer_config": null, "conv_transpose_kernel_initializer": null, "conv_transpose_kernel_initializer_config": null, "conv_transpose_bias_initializer": null, "conv_transpose_bias_initializer_config": null, "post_fcnet_hiddens": [], "post_fcnet_activation": "relu", "post_fcnet_weights_initializer": null, "post_fcnet_weights_initializer_config": null, "post_fcnet_bias_initializer": null, "post_fcnet_bias_initializer_config": null, "free_log_std": false, "log_std_clip_param": 20.0, "no_final_linear": false, "vf_share_layers": false, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "lstm_weights_initializer": null, "lstm_weights_initializer_config": null, "lstm_bias_initializer": null, "lstm_bias_initializer_config": null, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "attention_use_n_prev_actions": 0, "attention_use_n_prev_rewards": 0, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": null, "custom_model_config": {}, "custom_action_dist": null, "custom_preprocessor": null, "encoder_latent_dim": null, "always_check_shapes": false, "lstm_use_prev_action_reward": -1, "_use_default_native_models": -1, "_disable_preprocessor_api": false, "_disable_action_flattening": false}, "_learner_connector": null, "add_default_connectors_to_learner_pipeline": true, "learner_config_dict": {}, "optimizer": {}, "_learner_class": null, "callbacks_on_algorithm_init": null, "callbacks_on_env_runners_recreated": null, "callbacks_on_offline_eval_runners_recreated": null, "callbacks_on_checkpoint_loaded": null, "callbacks_on_environment_created": null, "callbacks_on_episode_created": null, "callbacks_on_episode_start": null, "callbacks_on_episode_step": null, "callbacks_on_episode_end": null, "callbacks_on_evaluate_start": null, "callbacks_on_evaluate_end": null, "callbacks_on_evaluate_offline_start": null, "callbacks_on_evaluate_offline_end": null, "callbacks_on_sample_end": null, "callbacks_on_train_result": null, "explore": true, "enable_rl_module_and_learner": true, "enable_env_runner_and_connector_v2": true, "_prior_exploration_config": {"type": "StochasticSampling"}, "count_steps_by": "env_steps", "policy_map_capacity": 100, "policy_mapping_fn": "<function AlgorithmConfig.DEFAULT_POLICY_MAPPING_FN at 0x3847e9b20>", "policies_to_train": null, "policy_states_are_swappable": false, "observation_fn": null, "offline_data_class": null, "input_read_method": "read_parquet", "input_read_method_kwargs": {}, "input_read_schema": {}, "input_read_episodes": false, "input_read_sample_batches": false, "input_read_batch_size": null, "input_filesystem": null, "input_filesystem_kwargs": {}, "input_compress_columns": ["obs", "new_obs"], "input_spaces_jsonable": true, "materialize_data": false, "materialize_mapped_data": true, "map_batches_kwargs": {}, "iter_batches_kwargs": {}, "ignore_final_observation": false, "prelearner_class": null, "prelearner_buffer_class": null, "prelearner_buffer_kwargs": {}, "prelearner_module_synch_period": 10, "dataset_num_iters_per_learner": null, "input_config": {}, "actions_in_input_normalized": false, "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_config": {}, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "output_max_rows_per_file": null, "output_write_remaining_data": false, "output_write_method": "write_parquet", "output_write_method_kwargs": {}, "output_filesystem": null, "output_filesystem_kwargs": {}, "output_write_episodes": true, "offline_sampling": false, "evaluation_interval": 1, "evaluation_duration": 20, "evaluation_duration_unit": "episodes", "evaluation_sample_timeout_s": 120.0, "evaluation_auto_duration_min_env_steps_per_sample": 100, "evaluation_auto_duration_max_env_steps_per_sample": 2000, "evaluation_parallel_to_training": false, "evaluation_force_reset_envs_before_iteration": true, "evaluation_config": null, "off_policy_estimation_methods": {}, "ope_split_batch_by_episode": true, "evaluation_num_env_runners": 1, "in_evaluation": false, "sync_filters_on_rollout_workers_timeout_s": 10.0, "offline_evaluation_interval": null, "num_offline_eval_runners": 0, "offline_loss_for_module_fn": null, "offline_evaluation_duration": 1, "offline_evaluation_parallel_to_training": false, "offline_evaluation_timeout_s": 120.0, "num_cpus_per_offline_eval_runner": 1, "num_gpus_per_offline_eval_runner": 0, "custom_resources_per_offline_eval_runner": {}, "restart_failed_offline_eval_runners": true, "ignore_offline_eval_runner_failures": false, "max_num_offline_eval_runner_restarts": 1000, "offline_eval_runner_restore_timeout_s": 1800.0, "max_requests_in_flight_per_offline_eval_runner": 1, "validate_offline_eval_runners_after_construction": true, "offline_eval_runner_health_probe_timeout_s": 30.0, "offline_eval_rl_module_inference_only": false, "broadcast_offline_eval_runner_states": false, "offline_eval_batch_size_per_runner": 256, "dataset_num_iters_per_eval_runner": 1, "keep_per_episode_custom_metrics": false, "metrics_episode_collection_timeout_s": 60.0, "metrics_num_episodes_for_smoothing": 100, "min_time_s_per_iteration": null, "min_train_timesteps_per_iteration": 0, "min_sample_timesteps_per_iteration": 0, "log_gradients": true, "export_native_model_files": false, "checkpoint_trainable_policies_only": false, "logger_creator": null, "logger_config": null, "log_level": "WARN", "log_sys_usage": true, "fake_sampler": false, "seed": 10, "restart_failed_env_runners": true, "ignore_env_runner_failures": false, "max_num_env_runner_restarts": 1000, "delay_between_env_runner_restarts_s": 60.0, "restart_failed_sub_environments": false, "num_consecutive_env_runner_failures_tolerance": 100, "env_runner_health_probe_timeout_s": 30.0, "env_runner_restore_timeout_s": 1800.0, "_model_config": {}, "_rl_module_spec": "RLModuleSpec(module_class=None, observation_space=None, action_space=None, inference_only=False, learner_only=False, model_config=DefaultModelConfig(fcnet_hiddens=[60, 90], fcnet_activation='tanh', fcnet_kernel_initializer=None, fcnet_kernel_initializer_kwargs=None, fcnet_bias_initializer=None, fcnet_bias_initializer_kwargs=None, conv_filters=None, conv_activation='relu', conv_kernel_initializer=None, conv_kernel_initializer_kwargs=None, conv_bias_initializer=None, conv_bias_initializer_kwargs=None, head_fcnet_hiddens=[], head_fcnet_activation='relu', head_fcnet_kernel_initializer=None, head_fcnet_kernel_initializer_kwargs=None, head_fcnet_bias_initializer=None, head_fcnet_bias_initializer_kwargs=None, free_log_std=False, log_std_clip_param=20.0, vf_share_layers=True, use_lstm=False, max_seq_len=20, lstm_cell_size=256, lstm_use_prev_action=False, lstm_use_prev_reward=False, lstm_kernel_initializer=None, lstm_kernel_initializer_kwargs=None, lstm_bias_initializer=None, lstm_bias_initializer_kwargs=None), catalog_class=None, load_state_path=None, model_config_dict=None)", "algorithm_config_overrides_per_module": {}, "_per_module_overrides": {}, "_validate_config": true, "_use_msgpack_checkpoints": false, "_torch_grad_scaler_class": null, "_torch_lr_scheduler_classes": null, "_tf_policy_handles_more_than_one_loss": false, "_disable_preprocessor_api": false, "_disable_action_flattening": false, "_disable_initialize_loss_from_dummy_batch": false, "_dont_auto_sync_env_runner_states": false, "env_task_fn": -1, "enable_connectors": -1, "simple_optimizer": false, "policy_map_cache": -1, "worker_cls": -1, "synchronize_filters": -1, "enable_async_evaluation": -1, "custom_async_evaluation_function": -1, "_enable_rl_module_api": -1, "auto_wrap_old_gym_envs": -1, "always_attach_evaluation_results": -1, "replay_sequence_length": null, "_disable_execution_plan_api": -1, "use_critic": true, "use_gae": true, "use_kl_loss": true, "kl_coeff": 0.7464963036515, "kl_target": 0.0270990929592, "vf_loss_coeff": 0.6688075857018, "entropy_coeff": 0.0090570820258, "clip_param": 0.1221781641624, "vf_clip_param": 0.1027808522125, "entropy_coeff_schedule": null, "lr_schedule": null, "sgd_minibatch_size": -1, "vf_share_layers": -1, "__stdout_file__": null, "__stderr_file__": null, "lambda": 0.9099046732075, "input": "sampler", "policies": {"default_policy": [null, null, null, null]}, "callbacks": "<class 'ray.rllib.callbacks.callbacks.RLlibCallback'>", "create_env_on_driver": false, "custom_eval_function": null, "framework": "torch"}, "time_since_restore": 23.08185887336731, "iterations_since_restore": 9, "perf": {"cpu_util_percent": 66.93333333333334, "ram_util_percent": 75.5}}
{"timers": {"training_iteration": 2.6351386993663555, "restore_env_runners": 1.4121258966533778e-05, "training_step": 2.6349561885720645, "env_runner_sampling_timer": 2.4750835815458565, "learner_update_timer": 0.15670371477397085, "synch_weights": 0.0006095478498211101, "restore_eval_env_runners": 8.951962733798545e-06, "evaluation_iteration": 0.13623718609068716, "synch_eval_env_connectors": 0.00023288836837080342, "synch_env_connectors": 4.775526575945122e-06}, "env_runners": {"num_episodes": 250.0, "module_to_env_connector": {"timers": {"connectors": {"remove_single_ts_time_rank_from_batch": 6.739845433098382e-07, "listify_data_for_vector_env": 1.3119353171408526e-05, "get_actions": 4.917554742489881e-05, "tensor_to_numpy": 1.6077322810511427e-05, "un_batch_to_individual_items": 6.2628839936363475e-06, "normalize_and_clip_actions": 1.1067263355821472e-05}}, "connector_pipeline_timer": 0.00012625093214824106}, "episode_duration_sec_mean": 0.005437191828154028, "env_to_module_sum_episodes_length_in": 10.36823839457432, "episode_return_min": -10.5, "episode_len_max": 20, "episode_len_mean": 20.0, "env_step_timer": 1.7094405613815243e-05, "num_agent_steps_sampled": {"default_agent": 5000.0}, "module_episode_returns_mean": {"default_policy": 2.460000000000001}, "num_agent_steps_sampled_lifetime": {"default_agent": -4930000.0}, "agent_episode_returns_mean": {"default_agent": 2.460000000000001}, "weights_seq_no": 9.0, "env_to_module_connector": {"timers": {"connectors": {"add_observations_from_episodes_to_batch": 3.4266062722606175e-06, "numpy_to_tensor": 1.0443242650655709e-05, "add_states_from_episodes_to_batch": 1.9463150660488735e-06, "add_time_dim_to_batch_and_zero_pad": 2.791984236036745e-06, "batch_individual_items": 7.743945710142452e-06}}, "connector_pipeline_timer": 5.124049928258663e-05}, "sample": 0.006662628088228906, "num_module_steps_sampled_lifetime": {"default_policy": -4930000.0}, "num_env_steps_sampled_lifetime": -4930000.0, "episode_len_min": 20, "episode_return_max": 9.5, "num_episodes_lifetime": -246500.0, "time_between_sampling": 0.0024088794973028166, "num_module_steps_sampled": {"default_policy": 5000.0}, "env_reset_timer": 5.8261381903282615e-05, "num_env_steps_sampled": 5000.0, "episode_return_mean": 2.460000000000001, "rlmodule_inference_timer": 3.324679599427123e-05, "env_to_module_sum_episodes_length_out": 10.36823839457432, "num_env_steps_sampled_lifetime_throughput": 3219.6823115848383}, "learners": {"__all_modules__": {"num_trainable_parameters": 6003, "learner_connector": {"timers": {"connectors": {"add_time_dim_to_batch_and_zero_pad": 2.467598237880302e-05, "batch_individual_items": 0.039392792022977026, "add_states_from_episodes_to_batch": 7.349692299596478e-06, "general_advantage_estimation": 0.007562350457933411, "add_columns_from_episodes_to_train_batch": 0.0585824146745614, "numpy_to_tensor": 7.680342967150118e-05, "add_one_ts_to_episodes_and_truncate": 0.014216446775063686, "add_observations_from_episodes_to_batch": 0.0019361316921154205}}, "connector_pipeline_timer": 0.12207169829749286}, "learner_connector_sum_episodes_length_in": 5000.0, "num_module_steps_trained": 6000, "num_non_trainable_parameters": 0, "num_module_steps_trained_lifetime": 60000, "learner_connector_sum_episodes_length_out": 5250.0, "num_env_steps_trained_lifetime": 315000, "num_env_steps_trained": 31500, "num_env_steps_trained_lifetime_throughput": 1660013.385055399, "num_module_steps_trained_throughput": 317405.7938931934, "num_module_steps_trained_lifetime_throughput": 316898.8792088638}, "default_policy": {"vf_loss_unclipped": 28.557741165161133, "total_loss": -0.09232137352228165, "entropy": 0.6338445544242859, "num_trainable_parameters": 6003, "num_module_steps_trained_lifetime": 60000, "curr_kl_coeff": 0.0007290003122761846, "vf_explained_var": -0.010891318321228027, "weights_seq_no": 10.0, "policy_loss": -0.15532250702381134, "num_module_steps_trained": 6000, "curr_entropy_coeff": 0.0090570820258, "mean_kl_loss": 0.0009032915695570409, "module_train_batch_size_mean": 1000.0, "vf_loss": 0.10278083384037018, "gradients_default_optimizer_global_norm": 0.012517706491053104, "default_optimizer_learning_rate": 0.0002847858517, "diff_num_grad_updates_vs_sampler_policy": 1.0, "num_module_steps_trained_lifetime_throughput": 318112.53012386325}}, "num_training_step_calls_per_iteration": 1, "evaluation": {"env_runners": {"weights_seq_no": 10.0, "num_env_steps_sampled_lifetime": 50400, "module_to_env_connector": {"timers": {"connectors": {"remove_single_ts_time_rank_from_batch": 5.710519192063084e-07, "listify_data_for_vector_env": 1.0790235070680333e-05, "get_actions": 3.541743315600775e-05, "un_batch_to_individual_items": 5.2643605388345915e-06, "tensor_to_numpy": 1.2845865891755683e-05, "normalize_and_clip_actions": 9.25146623851749e-06}}, "connector_pipeline_timer": 9.9268968453407e-05}, "module_episode_returns_mean": {"default_policy": 1.05}, "episode_return_mean": 1.05, "rlmodule_inference_timer": 2.6402498892626387e-05, "episode_duration_sec_mean": 0.006202894133748487, "env_to_module_connector": {"timers": {"connectors": {"add_observations_from_episodes_to_batch": 2.7535799139138783e-06, "add_time_dim_to_batch_and_zero_pad": 2.2114647775696648e-06, "batch_individual_items": 6.053836142064802e-06, "add_states_from_episodes_to_batch": 1.5210651522479068e-06, "numpy_to_tensor": 8.218486221491707e-06}}, "connector_pipeline_timer": 4.205123490967631e-05}, "num_module_steps_sampled": {"default_policy": 400}, "episode_len_max": 20, "env_step_timer": 1.3639318040999628e-05, "sample": 0.1287252500097519, "agent_episode_returns_mean": {"default_agent": 1.05}, "env_reset_timer": 0.0003375145305027104, "env_to_module_sum_episodes_length_in": 10.368238394574323, "episode_len_mean": 20.0, "num_agent_steps_sampled": {"default_agent": 400}, "num_agent_steps_sampled_lifetime": {"default_agent": 4000}, "num_env_steps_sampled": 400, "num_module_steps_sampled_lifetime": {"default_policy": 4000}, "env_to_module_sum_episodes_length_out": 10.368238394574323, "num_episodes": 20, "episode_return_min": -14.5, "episode_len_min": 20, "episode_return_max": 13.5, "num_episodes_lifetime": 200, "time_between_sampling": 2.4389225211034935}, "num_healthy_workers": 1, "actor_manager_num_outstanding_async_reqs": 0, "num_remote_worker_restarts": 0}, "num_env_steps_sampled_lifetime": -4930000.0, "fault_tolerance": {"num_healthy_workers": 0, "num_remote_worker_restarts": 0}, "env_runner_group": {"actor_manager_num_outstanding_async_reqs": 0}, "done": false, "training_iteration": 10, "trial_id": "46920_00000", "date": "2025-08-11_19-35-45", "timestamp": 1754933745, "time_this_iter_s": 1.9294500350952148, "time_total_s": 25.011308908462524, "pid": 27748, "hostname": "Mac", "node_ip": "127.0.0.1", "config": {"exploration_config": {}, "extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "placement_strategy": "PACK", "num_gpus": 0, "_fake_gpus": false, "num_cpus_for_main_process": 2, "eager_tracing": true, "eager_max_retraces": 20, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "torch_compile_learner": false, "torch_compile_learner_what_to_compile": "forward_train", "torch_compile_learner_dynamo_backend": "aot_eager", "torch_compile_learner_dynamo_mode": null, "torch_compile_worker": false, "torch_compile_worker_dynamo_backend": "aot_eager", "torch_compile_worker_dynamo_mode": null, "torch_ddp_kwargs": {}, "torch_skip_nan_gradients": false, "env": "Umbrella", "env_config": {}, "observation_space": null, "action_space": null, "clip_rewards": null, "normalize_actions": true, "clip_actions": false, "_is_atari": null, "disable_env_checking": false, "render_env": false, "action_mask_key": "action_mask", "env_runner_cls": null, "num_env_runners": 0, "create_local_env_runner": true, "num_envs_per_env_runner": 1, "gym_env_vectorize_mode": "SYNC", "num_cpus_per_env_runner": 1, "num_gpus_per_env_runner": 0, "custom_resources_per_env_runner": {}, "validate_env_runners_after_construction": true, "episodes_to_numpy": true, "max_requests_in_flight_per_env_runner": 1, "sample_timeout_s": 60.0, "_env_to_module_connector": null, "add_default_connectors_to_env_to_module_pipeline": true, "_module_to_env_connector": null, "add_default_connectors_to_module_to_env_pipeline": true, "merge_env_runner_states": "training_only", "broadcast_env_runner_states": true, "episode_lookback_horizon": 1, "rollout_fragment_length": "auto", "batch_mode": "complete_episodes", "compress_observations": false, "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "enable_tf1_exec_eagerly": false, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "preprocessor_pref": "deepmind", "observation_filter": "NoFilter", "update_worker_filter_stats": true, "use_worker_filter_stats": true, "sampler_perf_stats_ema_coef": null, "_is_online": true, "num_learners": 0, "num_gpus_per_learner": 0, "num_cpus_per_learner": "auto", "num_aggregator_actors_per_learner": 0, "max_requests_in_flight_per_aggregator_actor": 3, "local_gpu_idx": 0, "max_requests_in_flight_per_learner": 3, "gamma": 1, "lr": 0.0002847858517, "grad_clip": 0.5, "grad_clip_by": "global_norm", "_train_batch_size_per_learner": 5000, "train_batch_size": 4000, "num_epochs": 1, "minibatch_size": 1000, "shuffle_batch_per_epoch": true, "model": {"fcnet_hiddens": [256, 256], "fcnet_activation": "tanh", "fcnet_weights_initializer": null, "fcnet_weights_initializer_config": null, "fcnet_bias_initializer": null, "fcnet_bias_initializer_config": null, "conv_filters": null, "conv_activation": "relu", "conv_kernel_initializer": null, "conv_kernel_initializer_config": null, "conv_bias_initializer": null, "conv_bias_initializer_config": null, "conv_transpose_kernel_initializer": null, "conv_transpose_kernel_initializer_config": null, "conv_transpose_bias_initializer": null, "conv_transpose_bias_initializer_config": null, "post_fcnet_hiddens": [], "post_fcnet_activation": "relu", "post_fcnet_weights_initializer": null, "post_fcnet_weights_initializer_config": null, "post_fcnet_bias_initializer": null, "post_fcnet_bias_initializer_config": null, "free_log_std": false, "log_std_clip_param": 20.0, "no_final_linear": false, "vf_share_layers": false, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "lstm_weights_initializer": null, "lstm_weights_initializer_config": null, "lstm_bias_initializer": null, "lstm_bias_initializer_config": null, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "attention_use_n_prev_actions": 0, "attention_use_n_prev_rewards": 0, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": null, "custom_model_config": {}, "custom_action_dist": null, "custom_preprocessor": null, "encoder_latent_dim": null, "always_check_shapes": false, "lstm_use_prev_action_reward": -1, "_use_default_native_models": -1, "_disable_preprocessor_api": false, "_disable_action_flattening": false}, "_learner_connector": null, "add_default_connectors_to_learner_pipeline": true, "learner_config_dict": {}, "optimizer": {}, "_learner_class": null, "callbacks_on_algorithm_init": null, "callbacks_on_env_runners_recreated": null, "callbacks_on_offline_eval_runners_recreated": null, "callbacks_on_checkpoint_loaded": null, "callbacks_on_environment_created": null, "callbacks_on_episode_created": null, "callbacks_on_episode_start": null, "callbacks_on_episode_step": null, "callbacks_on_episode_end": null, "callbacks_on_evaluate_start": null, "callbacks_on_evaluate_end": null, "callbacks_on_evaluate_offline_start": null, "callbacks_on_evaluate_offline_end": null, "callbacks_on_sample_end": null, "callbacks_on_train_result": null, "explore": true, "enable_rl_module_and_learner": true, "enable_env_runner_and_connector_v2": true, "_prior_exploration_config": {"type": "StochasticSampling"}, "count_steps_by": "env_steps", "policy_map_capacity": 100, "policy_mapping_fn": "<function AlgorithmConfig.DEFAULT_POLICY_MAPPING_FN at 0x3847e9b20>", "policies_to_train": null, "policy_states_are_swappable": false, "observation_fn": null, "offline_data_class": null, "input_read_method": "read_parquet", "input_read_method_kwargs": {}, "input_read_schema": {}, "input_read_episodes": false, "input_read_sample_batches": false, "input_read_batch_size": null, "input_filesystem": null, "input_filesystem_kwargs": {}, "input_compress_columns": ["obs", "new_obs"], "input_spaces_jsonable": true, "materialize_data": false, "materialize_mapped_data": true, "map_batches_kwargs": {}, "iter_batches_kwargs": {}, "ignore_final_observation": false, "prelearner_class": null, "prelearner_buffer_class": null, "prelearner_buffer_kwargs": {}, "prelearner_module_synch_period": 10, "dataset_num_iters_per_learner": null, "input_config": {}, "actions_in_input_normalized": false, "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_config": {}, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "output_max_rows_per_file": null, "output_write_remaining_data": false, "output_write_method": "write_parquet", "output_write_method_kwargs": {}, "output_filesystem": null, "output_filesystem_kwargs": {}, "output_write_episodes": true, "offline_sampling": false, "evaluation_interval": 1, "evaluation_duration": 20, "evaluation_duration_unit": "episodes", "evaluation_sample_timeout_s": 120.0, "evaluation_auto_duration_min_env_steps_per_sample": 100, "evaluation_auto_duration_max_env_steps_per_sample": 2000, "evaluation_parallel_to_training": false, "evaluation_force_reset_envs_before_iteration": true, "evaluation_config": null, "off_policy_estimation_methods": {}, "ope_split_batch_by_episode": true, "evaluation_num_env_runners": 1, "in_evaluation": false, "sync_filters_on_rollout_workers_timeout_s": 10.0, "offline_evaluation_interval": null, "num_offline_eval_runners": 0, "offline_loss_for_module_fn": null, "offline_evaluation_duration": 1, "offline_evaluation_parallel_to_training": false, "offline_evaluation_timeout_s": 120.0, "num_cpus_per_offline_eval_runner": 1, "num_gpus_per_offline_eval_runner": 0, "custom_resources_per_offline_eval_runner": {}, "restart_failed_offline_eval_runners": true, "ignore_offline_eval_runner_failures": false, "max_num_offline_eval_runner_restarts": 1000, "offline_eval_runner_restore_timeout_s": 1800.0, "max_requests_in_flight_per_offline_eval_runner": 1, "validate_offline_eval_runners_after_construction": true, "offline_eval_runner_health_probe_timeout_s": 30.0, "offline_eval_rl_module_inference_only": false, "broadcast_offline_eval_runner_states": false, "offline_eval_batch_size_per_runner": 256, "dataset_num_iters_per_eval_runner": 1, "keep_per_episode_custom_metrics": false, "metrics_episode_collection_timeout_s": 60.0, "metrics_num_episodes_for_smoothing": 100, "min_time_s_per_iteration": null, "min_train_timesteps_per_iteration": 0, "min_sample_timesteps_per_iteration": 0, "log_gradients": true, "export_native_model_files": false, "checkpoint_trainable_policies_only": false, "logger_creator": null, "logger_config": null, "log_level": "WARN", "log_sys_usage": true, "fake_sampler": false, "seed": 10, "restart_failed_env_runners": true, "ignore_env_runner_failures": false, "max_num_env_runner_restarts": 1000, "delay_between_env_runner_restarts_s": 60.0, "restart_failed_sub_environments": false, "num_consecutive_env_runner_failures_tolerance": 100, "env_runner_health_probe_timeout_s": 30.0, "env_runner_restore_timeout_s": 1800.0, "_model_config": {}, "_rl_module_spec": "RLModuleSpec(module_class=None, observation_space=None, action_space=None, inference_only=False, learner_only=False, model_config=DefaultModelConfig(fcnet_hiddens=[60, 90], fcnet_activation='tanh', fcnet_kernel_initializer=None, fcnet_kernel_initializer_kwargs=None, fcnet_bias_initializer=None, fcnet_bias_initializer_kwargs=None, conv_filters=None, conv_activation='relu', conv_kernel_initializer=None, conv_kernel_initializer_kwargs=None, conv_bias_initializer=None, conv_bias_initializer_kwargs=None, head_fcnet_hiddens=[], head_fcnet_activation='relu', head_fcnet_kernel_initializer=None, head_fcnet_kernel_initializer_kwargs=None, head_fcnet_bias_initializer=None, head_fcnet_bias_initializer_kwargs=None, free_log_std=False, log_std_clip_param=20.0, vf_share_layers=True, use_lstm=False, max_seq_len=20, lstm_cell_size=256, lstm_use_prev_action=False, lstm_use_prev_reward=False, lstm_kernel_initializer=None, lstm_kernel_initializer_kwargs=None, lstm_bias_initializer=None, lstm_bias_initializer_kwargs=None), catalog_class=None, load_state_path=None, model_config_dict=None)", "algorithm_config_overrides_per_module": {}, "_per_module_overrides": {}, "_validate_config": true, "_use_msgpack_checkpoints": false, "_torch_grad_scaler_class": null, "_torch_lr_scheduler_classes": null, "_tf_policy_handles_more_than_one_loss": false, "_disable_preprocessor_api": false, "_disable_action_flattening": false, "_disable_initialize_loss_from_dummy_batch": false, "_dont_auto_sync_env_runner_states": false, "env_task_fn": -1, "enable_connectors": -1, "simple_optimizer": false, "policy_map_cache": -1, "worker_cls": -1, "synchronize_filters": -1, "enable_async_evaluation": -1, "custom_async_evaluation_function": -1, "_enable_rl_module_api": -1, "auto_wrap_old_gym_envs": -1, "always_attach_evaluation_results": -1, "replay_sequence_length": null, "_disable_execution_plan_api": -1, "use_critic": true, "use_gae": true, "use_kl_loss": true, "kl_coeff": 0.7464963036515, "kl_target": 0.0270990929592, "vf_loss_coeff": 0.6688075857018, "entropy_coeff": 0.0090570820258, "clip_param": 0.1221781641624, "vf_clip_param": 0.1027808522125, "entropy_coeff_schedule": null, "lr_schedule": null, "sgd_minibatch_size": -1, "vf_share_layers": -1, "__stdout_file__": null, "__stderr_file__": null, "lambda": 0.9099046732075, "input": "sampler", "policies": {"default_policy": [null, null, null, null]}, "callbacks": "<class 'ray.rllib.callbacks.callbacks.RLlibCallback'>", "create_env_on_driver": false, "custom_eval_function": null, "framework": "torch"}, "time_since_restore": 25.011308908462524, "iterations_since_restore": 10, "perf": {"cpu_util_percent": 60.96666666666667, "ram_util_percent": 75.26666666666667}}
{"timers": {"training_iteration": 2.623431461121758, "restore_env_runners": 1.4028385510950638e-05, "training_step": 2.6232491437664085, "env_runner_sampling_timer": 2.4640031328098715, "learner_update_timer": 0.15607476387632957, "synch_weights": 0.0006093961220526833, "restore_eval_env_runners": 8.930352820295082e-06, "evaluation_iteration": 0.13587668297951616, "synch_eval_env_connectors": 0.00023148531362267386, "synch_env_connectors": 4.768601656010032e-06}, "env_runners": {"num_episodes": 250.0, "module_to_env_connector": {"timers": {"connectors": {"remove_single_ts_time_rank_from_batch": 5.849895208622349e-07, "listify_data_for_vector_env": 1.0858414909698289e-05, "get_actions": 3.883164270176849e-05, "tensor_to_numpy": 1.3202964477066956e-05, "un_batch_to_individual_items": 5.371009975681363e-06, "normalize_and_clip_actions": 9.3974558725756e-06}}, "connector_pipeline_timer": 0.00010392242959811373}, "episode_duration_sec_mean": 0.004539838159456849, "env_to_module_sum_episodes_length_in": 10.36823839457432, "episode_return_min": -10.5, "episode_len_max": 20, "episode_len_mean": 20.0, "env_step_timer": 1.3601999396339691e-05, "num_agent_steps_sampled": {"default_agent": 5000.0}, "module_episode_returns_mean": {"default_policy": 2.8600000000000008}, "num_agent_steps_sampled_lifetime": {"default_agent": -5547500.0}, "agent_episode_returns_mean": {"default_agent": 2.8600000000000008}, "weights_seq_no": 10.0, "env_to_module_connector": {"timers": {"connectors": {"add_observations_from_episodes_to_batch": 2.9389540641277313e-06, "numpy_to_tensor": 8.550418524235287e-06, "add_states_from_episodes_to_batch": 1.7148515024950619e-06, "add_time_dim_to_batch_and_zero_pad": 2.311216000176399e-06, "batch_individual_items": 6.284477489284763e-06}}, "connector_pipeline_timer": 4.3694811374785425e-05}, "sample": 0.005040972348336174, "num_module_steps_sampled_lifetime": {"default_policy": -5547500.0}, "num_env_steps_sampled_lifetime": -5547500.0, "episode_len_min": 20, "episode_return_max": 9.5, "num_episodes_lifetime": -277375.0, "time_between_sampling": 0.0018765249499792655, "num_module_steps_sampled": {"default_policy": 5000.0}, "env_reset_timer": 3.456252605992339e-05, "num_env_steps_sampled": 5000.0, "episode_return_mean": 2.8600000000000008, "rlmodule_inference_timer": 2.754077527882975e-05, "env_to_module_sum_episodes_length_out": 10.36823839457432, "num_env_steps_sampled_lifetime_throughput": 3756.8661685099046}, "learners": {"__all_modules__": {"num_trainable_parameters": 6003, "learner_connector": {"timers": {"connectors": {"add_time_dim_to_batch_and_zero_pad": 2.450464222126057e-05, "batch_individual_items": 0.03930286035231497, "add_states_from_episodes_to_batch": 7.304945304478893e-06, "general_advantage_estimation": 0.007542058202376933, "add_columns_from_episodes_to_train_batch": 0.05834584136877027, "numpy_to_tensor": 7.678331608724228e-05, "add_one_ts_to_episodes_and_truncate": 0.014149394807075374, "add_observations_from_episodes_to_batch": 0.0019250812044835238}}, "connector_pipeline_timer": 0.12164470589378885}, "learner_connector_sum_episodes_length_in": 5000.0, "num_module_steps_trained": 6000, "num_non_trainable_parameters": 0, "num_module_steps_trained_lifetime": 66000, "learner_connector_sum_episodes_length_out": 5250.0, "num_env_steps_trained_lifetime": 346500, "num_env_steps_trained": 31500, "num_env_steps_trained_lifetime_throughput": 1665921.4606292862, "num_module_steps_trained_throughput": 318483.60931576666, "num_module_steps_trained_lifetime_throughput": 317992.6415821035}, "default_policy": {"vf_loss_unclipped": 28.637535095214844, "total_loss": 0.04307083040475845, "entropy": 0.6183834671974182, "num_trainable_parameters": 6003, "num_module_steps_trained_lifetime": 66000, "curr_kl_coeff": 0.0003645001561380923, "vf_explained_var": -0.0113600492477417, "weights_seq_no": 11.0, "policy_loss": -0.020069513469934464, "num_module_steps_trained": 6000, "curr_entropy_coeff": 0.0090570820258, "mean_kl_loss": 0.0006507525686174631, "module_train_batch_size_mean": 1000.0, "vf_loss": 0.10278083384037018, "gradients_default_optimizer_global_norm": 0.01735222153365612, "default_optimizer_learning_rate": 0.0002847858517, "diff_num_grad_updates_vs_sampler_policy": 1.0, "num_module_steps_trained_lifetime_throughput": 319126.88596473704}}, "num_training_step_calls_per_iteration": 1, "evaluation": {"env_runners": {"weights_seq_no": 11.0, "num_env_steps_sampled_lifetime": 55400, "module_to_env_connector": {"timers": {"connectors": {"remove_single_ts_time_rank_from_batch": 5.804186629562011e-07, "listify_data_for_vector_env": 1.085158768601783e-05, "get_actions": 3.672468835099553e-05, "un_batch_to_individual_items": 5.323140399554664e-06, "tensor_to_numpy": 1.2994886625598341e-05, "normalize_and_clip_actions": 9.295396541167309e-06}}, "connector_pipeline_timer": 0.00010105159801387677}, "module_episode_returns_mean": {"default_policy": 0.25}, "episode_return_mean": 0.25, "rlmodule_inference_timer": 2.6955078061944047e-05, "episode_duration_sec_mean": 0.005362855811836198, "env_to_module_connector": {"timers": {"connectors": {"add_observations_from_episodes_to_batch": 2.7875872305067957e-06, "add_time_dim_to_batch_and_zero_pad": 2.2351737201250515e-06, "batch_individual_items": 6.057884185368031e-06, "add_states_from_episodes_to_batch": 1.591307389382692e-06, "numpy_to_tensor": 8.241208139505854e-06}}, "connector_pipeline_timer": 4.226842211557639e-05}, "num_module_steps_sampled": {"default_policy": 400}, "episode_len_max": 20, "env_step_timer": 1.3838200043896924e-05, "sample": 0.12841102917950953, "agent_episode_returns_mean": {"default_agent": 0.25}, "env_reset_timer": 0.0003351393846631042, "env_to_module_sum_episodes_length_in": 10.368238394574323, "episode_len_mean": 20.0, "num_agent_steps_sampled": {"default_agent": 400}, "num_agent_steps_sampled_lifetime": {"default_agent": 4400}, "num_env_steps_sampled": 400, "num_module_steps_sampled_lifetime": {"default_policy": 4400}, "env_to_module_sum_episodes_length_out": 10.368238394574323, "num_episodes": 20, "episode_return_min": -14.5, "episode_len_min": 20, "episode_return_max": 13.5, "num_episodes_lifetime": 220, "time_between_sampling": 2.4293472383930816}, "num_healthy_workers": 1, "actor_manager_num_outstanding_async_reqs": 0, "num_remote_worker_restarts": 0}, "num_env_steps_sampled_lifetime": -5547500.0, "fault_tolerance": {"num_healthy_workers": 0, "num_remote_worker_restarts": 0}, "env_runner_group": {"actor_manager_num_outstanding_async_reqs": 0}, "done": false, "training_iteration": 11, "trial_id": "46920_00000", "date": "2025-08-11_19-35-46", "timestamp": 1754933746, "time_this_iter_s": 1.5685677528381348, "time_total_s": 26.57987666130066, "pid": 27748, "hostname": "Mac", "node_ip": "127.0.0.1", "config": {"exploration_config": {}, "extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "placement_strategy": "PACK", "num_gpus": 0, "_fake_gpus": false, "num_cpus_for_main_process": 2, "eager_tracing": true, "eager_max_retraces": 20, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "torch_compile_learner": false, "torch_compile_learner_what_to_compile": "forward_train", "torch_compile_learner_dynamo_backend": "aot_eager", "torch_compile_learner_dynamo_mode": null, "torch_compile_worker": false, "torch_compile_worker_dynamo_backend": "aot_eager", "torch_compile_worker_dynamo_mode": null, "torch_ddp_kwargs": {}, "torch_skip_nan_gradients": false, "env": "Umbrella", "env_config": {}, "observation_space": null, "action_space": null, "clip_rewards": null, "normalize_actions": true, "clip_actions": false, "_is_atari": null, "disable_env_checking": false, "render_env": false, "action_mask_key": "action_mask", "env_runner_cls": null, "num_env_runners": 0, "create_local_env_runner": true, "num_envs_per_env_runner": 1, "gym_env_vectorize_mode": "SYNC", "num_cpus_per_env_runner": 1, "num_gpus_per_env_runner": 0, "custom_resources_per_env_runner": {}, "validate_env_runners_after_construction": true, "episodes_to_numpy": true, "max_requests_in_flight_per_env_runner": 1, "sample_timeout_s": 60.0, "_env_to_module_connector": null, "add_default_connectors_to_env_to_module_pipeline": true, "_module_to_env_connector": null, "add_default_connectors_to_module_to_env_pipeline": true, "merge_env_runner_states": "training_only", "broadcast_env_runner_states": true, "episode_lookback_horizon": 1, "rollout_fragment_length": "auto", "batch_mode": "complete_episodes", "compress_observations": false, "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "enable_tf1_exec_eagerly": false, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "preprocessor_pref": "deepmind", "observation_filter": "NoFilter", "update_worker_filter_stats": true, "use_worker_filter_stats": true, "sampler_perf_stats_ema_coef": null, "_is_online": true, "num_learners": 0, "num_gpus_per_learner": 0, "num_cpus_per_learner": "auto", "num_aggregator_actors_per_learner": 0, "max_requests_in_flight_per_aggregator_actor": 3, "local_gpu_idx": 0, "max_requests_in_flight_per_learner": 3, "gamma": 1, "lr": 0.0002847858517, "grad_clip": 0.5, "grad_clip_by": "global_norm", "_train_batch_size_per_learner": 5000, "train_batch_size": 4000, "num_epochs": 1, "minibatch_size": 1000, "shuffle_batch_per_epoch": true, "model": {"fcnet_hiddens": [256, 256], "fcnet_activation": "tanh", "fcnet_weights_initializer": null, "fcnet_weights_initializer_config": null, "fcnet_bias_initializer": null, "fcnet_bias_initializer_config": null, "conv_filters": null, "conv_activation": "relu", "conv_kernel_initializer": null, "conv_kernel_initializer_config": null, "conv_bias_initializer": null, "conv_bias_initializer_config": null, "conv_transpose_kernel_initializer": null, "conv_transpose_kernel_initializer_config": null, "conv_transpose_bias_initializer": null, "conv_transpose_bias_initializer_config": null, "post_fcnet_hiddens": [], "post_fcnet_activation": "relu", "post_fcnet_weights_initializer": null, "post_fcnet_weights_initializer_config": null, "post_fcnet_bias_initializer": null, "post_fcnet_bias_initializer_config": null, "free_log_std": false, "log_std_clip_param": 20.0, "no_final_linear": false, "vf_share_layers": false, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "lstm_weights_initializer": null, "lstm_weights_initializer_config": null, "lstm_bias_initializer": null, "lstm_bias_initializer_config": null, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "attention_use_n_prev_actions": 0, "attention_use_n_prev_rewards": 0, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": null, "custom_model_config": {}, "custom_action_dist": null, "custom_preprocessor": null, "encoder_latent_dim": null, "always_check_shapes": false, "lstm_use_prev_action_reward": -1, "_use_default_native_models": -1, "_disable_preprocessor_api": false, "_disable_action_flattening": false}, "_learner_connector": null, "add_default_connectors_to_learner_pipeline": true, "learner_config_dict": {}, "optimizer": {}, "_learner_class": null, "callbacks_on_algorithm_init": null, "callbacks_on_env_runners_recreated": null, "callbacks_on_offline_eval_runners_recreated": null, "callbacks_on_checkpoint_loaded": null, "callbacks_on_environment_created": null, "callbacks_on_episode_created": null, "callbacks_on_episode_start": null, "callbacks_on_episode_step": null, "callbacks_on_episode_end": null, "callbacks_on_evaluate_start": null, "callbacks_on_evaluate_end": null, "callbacks_on_evaluate_offline_start": null, "callbacks_on_evaluate_offline_end": null, "callbacks_on_sample_end": null, "callbacks_on_train_result": null, "explore": true, "enable_rl_module_and_learner": true, "enable_env_runner_and_connector_v2": true, "_prior_exploration_config": {"type": "StochasticSampling"}, "count_steps_by": "env_steps", "policy_map_capacity": 100, "policy_mapping_fn": "<function AlgorithmConfig.DEFAULT_POLICY_MAPPING_FN at 0x3847e9b20>", "policies_to_train": null, "policy_states_are_swappable": false, "observation_fn": null, "offline_data_class": null, "input_read_method": "read_parquet", "input_read_method_kwargs": {}, "input_read_schema": {}, "input_read_episodes": false, "input_read_sample_batches": false, "input_read_batch_size": null, "input_filesystem": null, "input_filesystem_kwargs": {}, "input_compress_columns": ["obs", "new_obs"], "input_spaces_jsonable": true, "materialize_data": false, "materialize_mapped_data": true, "map_batches_kwargs": {}, "iter_batches_kwargs": {}, "ignore_final_observation": false, "prelearner_class": null, "prelearner_buffer_class": null, "prelearner_buffer_kwargs": {}, "prelearner_module_synch_period": 10, "dataset_num_iters_per_learner": null, "input_config": {}, "actions_in_input_normalized": false, "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_config": {}, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "output_max_rows_per_file": null, "output_write_remaining_data": false, "output_write_method": "write_parquet", "output_write_method_kwargs": {}, "output_filesystem": null, "output_filesystem_kwargs": {}, "output_write_episodes": true, "offline_sampling": false, "evaluation_interval": 1, "evaluation_duration": 20, "evaluation_duration_unit": "episodes", "evaluation_sample_timeout_s": 120.0, "evaluation_auto_duration_min_env_steps_per_sample": 100, "evaluation_auto_duration_max_env_steps_per_sample": 2000, "evaluation_parallel_to_training": false, "evaluation_force_reset_envs_before_iteration": true, "evaluation_config": null, "off_policy_estimation_methods": {}, "ope_split_batch_by_episode": true, "evaluation_num_env_runners": 1, "in_evaluation": false, "sync_filters_on_rollout_workers_timeout_s": 10.0, "offline_evaluation_interval": null, "num_offline_eval_runners": 0, "offline_loss_for_module_fn": null, "offline_evaluation_duration": 1, "offline_evaluation_parallel_to_training": false, "offline_evaluation_timeout_s": 120.0, "num_cpus_per_offline_eval_runner": 1, "num_gpus_per_offline_eval_runner": 0, "custom_resources_per_offline_eval_runner": {}, "restart_failed_offline_eval_runners": true, "ignore_offline_eval_runner_failures": false, "max_num_offline_eval_runner_restarts": 1000, "offline_eval_runner_restore_timeout_s": 1800.0, "max_requests_in_flight_per_offline_eval_runner": 1, "validate_offline_eval_runners_after_construction": true, "offline_eval_runner_health_probe_timeout_s": 30.0, "offline_eval_rl_module_inference_only": false, "broadcast_offline_eval_runner_states": false, "offline_eval_batch_size_per_runner": 256, "dataset_num_iters_per_eval_runner": 1, "keep_per_episode_custom_metrics": false, "metrics_episode_collection_timeout_s": 60.0, "metrics_num_episodes_for_smoothing": 100, "min_time_s_per_iteration": null, "min_train_timesteps_per_iteration": 0, "min_sample_timesteps_per_iteration": 0, "log_gradients": true, "export_native_model_files": false, "checkpoint_trainable_policies_only": false, "logger_creator": null, "logger_config": null, "log_level": "WARN", "log_sys_usage": true, "fake_sampler": false, "seed": 10, "restart_failed_env_runners": true, "ignore_env_runner_failures": false, "max_num_env_runner_restarts": 1000, "delay_between_env_runner_restarts_s": 60.0, "restart_failed_sub_environments": false, "num_consecutive_env_runner_failures_tolerance": 100, "env_runner_health_probe_timeout_s": 30.0, "env_runner_restore_timeout_s": 1800.0, "_model_config": {}, "_rl_module_spec": "RLModuleSpec(module_class=None, observation_space=None, action_space=None, inference_only=False, learner_only=False, model_config=DefaultModelConfig(fcnet_hiddens=[60, 90], fcnet_activation='tanh', fcnet_kernel_initializer=None, fcnet_kernel_initializer_kwargs=None, fcnet_bias_initializer=None, fcnet_bias_initializer_kwargs=None, conv_filters=None, conv_activation='relu', conv_kernel_initializer=None, conv_kernel_initializer_kwargs=None, conv_bias_initializer=None, conv_bias_initializer_kwargs=None, head_fcnet_hiddens=[], head_fcnet_activation='relu', head_fcnet_kernel_initializer=None, head_fcnet_kernel_initializer_kwargs=None, head_fcnet_bias_initializer=None, head_fcnet_bias_initializer_kwargs=None, free_log_std=False, log_std_clip_param=20.0, vf_share_layers=True, use_lstm=False, max_seq_len=20, lstm_cell_size=256, lstm_use_prev_action=False, lstm_use_prev_reward=False, lstm_kernel_initializer=None, lstm_kernel_initializer_kwargs=None, lstm_bias_initializer=None, lstm_bias_initializer_kwargs=None), catalog_class=None, load_state_path=None, model_config_dict=None)", "algorithm_config_overrides_per_module": {}, "_per_module_overrides": {}, "_validate_config": true, "_use_msgpack_checkpoints": false, "_torch_grad_scaler_class": null, "_torch_lr_scheduler_classes": null, "_tf_policy_handles_more_than_one_loss": false, "_disable_preprocessor_api": false, "_disable_action_flattening": false, "_disable_initialize_loss_from_dummy_batch": false, "_dont_auto_sync_env_runner_states": false, "env_task_fn": -1, "enable_connectors": -1, "simple_optimizer": false, "policy_map_cache": -1, "worker_cls": -1, "synchronize_filters": -1, "enable_async_evaluation": -1, "custom_async_evaluation_function": -1, "_enable_rl_module_api": -1, "auto_wrap_old_gym_envs": -1, "always_attach_evaluation_results": -1, "replay_sequence_length": null, "_disable_execution_plan_api": -1, "use_critic": true, "use_gae": true, "use_kl_loss": true, "kl_coeff": 0.7464963036515, "kl_target": 0.0270990929592, "vf_loss_coeff": 0.6688075857018, "entropy_coeff": 0.0090570820258, "clip_param": 0.1221781641624, "vf_clip_param": 0.1027808522125, "entropy_coeff_schedule": null, "lr_schedule": null, "sgd_minibatch_size": -1, "vf_share_layers": -1, "__stdout_file__": null, "__stderr_file__": null, "lambda": 0.9099046732075, "input": "sampler", "policies": {"default_policy": [null, null, null, null]}, "callbacks": "<class 'ray.rllib.callbacks.callbacks.RLlibCallback'>", "create_env_on_driver": false, "custom_eval_function": null, "framework": "torch"}, "time_since_restore": 26.57987666130066, "iterations_since_restore": 11, "perf": {"cpu_util_percent": 17.45, "ram_util_percent": 74.6}}
{"timers": {"training_iteration": 2.6132260619307153, "restore_env_runners": 1.3947692330777904e-05, "training_step": 2.613043846078068, "env_runner_sampling_timer": 2.454453854821237, "learner_update_timer": 0.15542056915675292, "synch_weights": 0.0006082992512686746, "restore_eval_env_runners": 8.913549262066293e-06, "evaluation_iteration": 0.13553670822971545, "synch_eval_env_connectors": 0.0002302625398148202, "synch_env_connectors": 4.7629951216774954e-06}, "env_runners": {"num_episodes": 250.0, "module_to_env_connector": {"timers": {"connectors": {"remove_single_ts_time_rank_from_batch": 6.107300788692806e-07, "listify_data_for_vector_env": 1.1296924492631832e-05, "get_actions": 4.1219186905432015e-05, "tensor_to_numpy": 1.3712750637779124e-05, "un_batch_to_individual_items": 5.543771501523328e-06, "normalize_and_clip_actions": 9.691213595875239e-06}}, "connector_pipeline_timer": 0.00010867984735790317}, "episode_duration_sec_mean": 0.004722688036505133, "env_to_module_sum_episodes_length_in": 10.36823839457432, "episode_return_min": -10.5, "episode_len_max": 20, "episode_len_mean": 20.0, "env_step_timer": 1.4181795678644927e-05, "num_agent_steps_sampled": {"default_agent": 5000.0}, "module_episode_returns_mean": {"default_policy": 4.380000000000001}, "num_agent_steps_sampled_lifetime": {"default_agent": -6165000.0}, "agent_episode_returns_mean": {"default_agent": 4.380000000000001}, "weights_seq_no": 11.0, "env_to_module_connector": {"timers": {"connectors": {"add_observations_from_episodes_to_batch": 3.214147333151698e-06, "numpy_to_tensor": 8.910791062304232e-06, "add_states_from_episodes_to_batch": 1.786359747987888e-06, "add_time_dim_to_batch_and_zero_pad": 2.4035583482298892e-06, "batch_individual_items": 6.532383607180125e-06}}, "connector_pipeline_timer": 4.5297687445267856e-05}, "sample": 0.005024728468869688, "num_module_steps_sampled_lifetime": {"default_policy": -6165000.0}, "num_env_steps_sampled_lifetime": -6165000.0, "episode_len_min": 20, "episode_return_max": 9.5, "num_episodes_lifetime": -308250.0, "time_between_sampling": 0.0018139657035238102, "num_module_steps_sampled": {"default_policy": 5000.0}, "env_reset_timer": 3.3265098611001994e-05, "num_env_steps_sampled": 5000.0, "episode_return_mean": 4.380000000000001, "rlmodule_inference_timer": 2.8492880729236466e-05, "env_to_module_sum_episodes_length_out": 10.36823839457432, "num_env_steps_sampled_lifetime_throughput": 3662.720353120016}, "learners": {"__all_modules__": {"num_trainable_parameters": 6003, "learner_connector": {"timers": {"connectors": {"add_time_dim_to_batch_and_zero_pad": 2.4360435914967674e-05, "batch_individual_items": 0.03920792216875668, "add_states_from_episodes_to_batch": 7.260645779312484e-06, "general_advantage_estimation": 0.007519066779757873, "add_columns_from_episodes_to_train_batch": 0.05810190336455299, "numpy_to_tensor": 7.665506288372094e-05, "add_one_ts_to_episodes_and_truncate": 0.014084669610027958, "add_observations_from_episodes_to_batch": 0.0019137966428527174}}, "connector_pipeline_timer": 0.12120471091473195}, "learner_connector_sum_episodes_length_in": 5000.0, "num_module_steps_trained": 6000, "num_non_trainable_parameters": 0, "num_module_steps_trained_lifetime": 72000, "learner_connector_sum_episodes_length_out": 5250.0, "num_env_steps_trained_lifetime": 378000, "num_env_steps_trained": 31500, "num_env_steps_trained_lifetime_throughput": 1678631.7620899798, "num_module_steps_trained_throughput": 320860.7073273899, "num_module_steps_trained_lifetime_throughput": 320384.4450444671}, "default_policy": {"vf_loss_unclipped": 28.60890007019043, "total_loss": 0.01771397329866886, "entropy": 0.6033130884170532, "num_trainable_parameters": 6003, "num_module_steps_trained_lifetime": 72000, "curr_kl_coeff": 0.00018225007806904614, "vf_explained_var": -0.01087331771850586, "weights_seq_no": 12.0, "policy_loss": -0.04556255415081978, "num_module_steps_trained": 6000, "curr_entropy_coeff": 0.0090570820258, "mean_kl_loss": 0.0004655509255826473, "module_train_batch_size_mean": 1000.0, "vf_loss": 0.10278083384037018, "gradients_default_optimizer_global_norm": 0.02542821504175663, "default_optimizer_learning_rate": 0.0002847858517, "diff_num_grad_updates_vs_sampler_policy": 1.0, "num_module_steps_trained_lifetime_throughput": 321442.0611236532}}, "num_training_step_calls_per_iteration": 1, "evaluation": {"env_runners": {"weights_seq_no": 12.0, "num_env_steps_sampled_lifetime": 60400, "module_to_env_connector": {"timers": {"connectors": {"remove_single_ts_time_rank_from_batch": 5.746407126925824e-07, "listify_data_for_vector_env": 1.092456898747853e-05, "get_actions": 3.881876520928446e-05, "un_batch_to_individual_items": 5.400046488095795e-06, "tensor_to_numpy": 1.3236301592829998e-05, "normalize_and_clip_actions": 9.388117249974418e-06}}, "connector_pipeline_timer": 0.00010395899321408447}, "module_episode_returns_mean": {"default_policy": 0.65}, "episode_return_mean": 0.65, "rlmodule_inference_timer": 2.7796052697126634e-05, "episode_duration_sec_mean": 0.005027270405553281, "env_to_module_connector": {"timers": {"connectors": {"add_observations_from_episodes_to_batch": 2.7822633152612534e-06, "add_time_dim_to_batch_and_zero_pad": 2.2452703502243965e-06, "batch_individual_items": 6.190139873165259e-06, "add_states_from_episodes_to_batch": 1.5494345429076247e-06, "numpy_to_tensor": 8.461618319278007e-06}}, "connector_pipeline_timer": 4.2757304110792576e-05}, "num_module_steps_sampled": {"default_policy": 400}, "episode_len_max": 20, "env_step_timer": 1.3907163994939925e-05, "sample": 0.12811506013827823, "agent_episode_returns_mean": {"default_agent": 0.65}, "env_reset_timer": 0.0003325013210443548, "env_to_module_sum_episodes_length_in": 10.368238394574323, "episode_len_mean": 20.0, "num_agent_steps_sampled": {"default_agent": 400}, "num_agent_steps_sampled_lifetime": {"default_agent": 4800}, "num_env_steps_sampled": 400, "num_module_steps_sampled_lifetime": {"default_policy": 4800}, "env_to_module_sum_episodes_length_out": 10.368238394574323, "num_episodes": 20, "episode_return_min": -14.5, "episode_len_min": 20, "episode_return_max": 13.5, "num_episodes_lifetime": 240, "time_between_sampling": 2.421246707679457}, "num_healthy_workers": 1, "actor_manager_num_outstanding_async_reqs": 0, "num_remote_worker_restarts": 0}, "num_env_steps_sampled_lifetime": -6165000.0, "fault_tolerance": {"num_healthy_workers": 0, "num_remote_worker_restarts": 0}, "env_runner_group": {"actor_manager_num_outstanding_async_reqs": 0}, "done": false, "training_iteration": 12, "trial_id": "46920_00000", "date": "2025-08-11_19-35-48", "timestamp": 1754933748, "time_this_iter_s": 1.7083969116210938, "time_total_s": 28.288273572921753, "pid": 27748, "hostname": "Mac", "node_ip": "127.0.0.1", "config": {"exploration_config": {}, "extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "placement_strategy": "PACK", "num_gpus": 0, "_fake_gpus": false, "num_cpus_for_main_process": 2, "eager_tracing": true, "eager_max_retraces": 20, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "torch_compile_learner": false, "torch_compile_learner_what_to_compile": "forward_train", "torch_compile_learner_dynamo_backend": "aot_eager", "torch_compile_learner_dynamo_mode": null, "torch_compile_worker": false, "torch_compile_worker_dynamo_backend": "aot_eager", "torch_compile_worker_dynamo_mode": null, "torch_ddp_kwargs": {}, "torch_skip_nan_gradients": false, "env": "Umbrella", "env_config": {}, "observation_space": null, "action_space": null, "clip_rewards": null, "normalize_actions": true, "clip_actions": false, "_is_atari": null, "disable_env_checking": false, "render_env": false, "action_mask_key": "action_mask", "env_runner_cls": null, "num_env_runners": 0, "create_local_env_runner": true, "num_envs_per_env_runner": 1, "gym_env_vectorize_mode": "SYNC", "num_cpus_per_env_runner": 1, "num_gpus_per_env_runner": 0, "custom_resources_per_env_runner": {}, "validate_env_runners_after_construction": true, "episodes_to_numpy": true, "max_requests_in_flight_per_env_runner": 1, "sample_timeout_s": 60.0, "_env_to_module_connector": null, "add_default_connectors_to_env_to_module_pipeline": true, "_module_to_env_connector": null, "add_default_connectors_to_module_to_env_pipeline": true, "merge_env_runner_states": "training_only", "broadcast_env_runner_states": true, "episode_lookback_horizon": 1, "rollout_fragment_length": "auto", "batch_mode": "complete_episodes", "compress_observations": false, "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "enable_tf1_exec_eagerly": false, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "preprocessor_pref": "deepmind", "observation_filter": "NoFilter", "update_worker_filter_stats": true, "use_worker_filter_stats": true, "sampler_perf_stats_ema_coef": null, "_is_online": true, "num_learners": 0, "num_gpus_per_learner": 0, "num_cpus_per_learner": "auto", "num_aggregator_actors_per_learner": 0, "max_requests_in_flight_per_aggregator_actor": 3, "local_gpu_idx": 0, "max_requests_in_flight_per_learner": 3, "gamma": 1, "lr": 0.0002847858517, "grad_clip": 0.5, "grad_clip_by": "global_norm", "_train_batch_size_per_learner": 5000, "train_batch_size": 4000, "num_epochs": 1, "minibatch_size": 1000, "shuffle_batch_per_epoch": true, "model": {"fcnet_hiddens": [256, 256], "fcnet_activation": "tanh", "fcnet_weights_initializer": null, "fcnet_weights_initializer_config": null, "fcnet_bias_initializer": null, "fcnet_bias_initializer_config": null, "conv_filters": null, "conv_activation": "relu", "conv_kernel_initializer": null, "conv_kernel_initializer_config": null, "conv_bias_initializer": null, "conv_bias_initializer_config": null, "conv_transpose_kernel_initializer": null, "conv_transpose_kernel_initializer_config": null, "conv_transpose_bias_initializer": null, "conv_transpose_bias_initializer_config": null, "post_fcnet_hiddens": [], "post_fcnet_activation": "relu", "post_fcnet_weights_initializer": null, "post_fcnet_weights_initializer_config": null, "post_fcnet_bias_initializer": null, "post_fcnet_bias_initializer_config": null, "free_log_std": false, "log_std_clip_param": 20.0, "no_final_linear": false, "vf_share_layers": false, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "lstm_weights_initializer": null, "lstm_weights_initializer_config": null, "lstm_bias_initializer": null, "lstm_bias_initializer_config": null, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "attention_use_n_prev_actions": 0, "attention_use_n_prev_rewards": 0, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": null, "custom_model_config": {}, "custom_action_dist": null, "custom_preprocessor": null, "encoder_latent_dim": null, "always_check_shapes": false, "lstm_use_prev_action_reward": -1, "_use_default_native_models": -1, "_disable_preprocessor_api": false, "_disable_action_flattening": false}, "_learner_connector": null, "add_default_connectors_to_learner_pipeline": true, "learner_config_dict": {}, "optimizer": {}, "_learner_class": null, "callbacks_on_algorithm_init": null, "callbacks_on_env_runners_recreated": null, "callbacks_on_offline_eval_runners_recreated": null, "callbacks_on_checkpoint_loaded": null, "callbacks_on_environment_created": null, "callbacks_on_episode_created": null, "callbacks_on_episode_start": null, "callbacks_on_episode_step": null, "callbacks_on_episode_end": null, "callbacks_on_evaluate_start": null, "callbacks_on_evaluate_end": null, "callbacks_on_evaluate_offline_start": null, "callbacks_on_evaluate_offline_end": null, "callbacks_on_sample_end": null, "callbacks_on_train_result": null, "explore": true, "enable_rl_module_and_learner": true, "enable_env_runner_and_connector_v2": true, "_prior_exploration_config": {"type": "StochasticSampling"}, "count_steps_by": "env_steps", "policy_map_capacity": 100, "policy_mapping_fn": "<function AlgorithmConfig.DEFAULT_POLICY_MAPPING_FN at 0x3847e9b20>", "policies_to_train": null, "policy_states_are_swappable": false, "observation_fn": null, "offline_data_class": null, "input_read_method": "read_parquet", "input_read_method_kwargs": {}, "input_read_schema": {}, "input_read_episodes": false, "input_read_sample_batches": false, "input_read_batch_size": null, "input_filesystem": null, "input_filesystem_kwargs": {}, "input_compress_columns": ["obs", "new_obs"], "input_spaces_jsonable": true, "materialize_data": false, "materialize_mapped_data": true, "map_batches_kwargs": {}, "iter_batches_kwargs": {}, "ignore_final_observation": false, "prelearner_class": null, "prelearner_buffer_class": null, "prelearner_buffer_kwargs": {}, "prelearner_module_synch_period": 10, "dataset_num_iters_per_learner": null, "input_config": {}, "actions_in_input_normalized": false, "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_config": {}, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "output_max_rows_per_file": null, "output_write_remaining_data": false, "output_write_method": "write_parquet", "output_write_method_kwargs": {}, "output_filesystem": null, "output_filesystem_kwargs": {}, "output_write_episodes": true, "offline_sampling": false, "evaluation_interval": 1, "evaluation_duration": 20, "evaluation_duration_unit": "episodes", "evaluation_sample_timeout_s": 120.0, "evaluation_auto_duration_min_env_steps_per_sample": 100, "evaluation_auto_duration_max_env_steps_per_sample": 2000, "evaluation_parallel_to_training": false, "evaluation_force_reset_envs_before_iteration": true, "evaluation_config": null, "off_policy_estimation_methods": {}, "ope_split_batch_by_episode": true, "evaluation_num_env_runners": 1, "in_evaluation": false, "sync_filters_on_rollout_workers_timeout_s": 10.0, "offline_evaluation_interval": null, "num_offline_eval_runners": 0, "offline_loss_for_module_fn": null, "offline_evaluation_duration": 1, "offline_evaluation_parallel_to_training": false, "offline_evaluation_timeout_s": 120.0, "num_cpus_per_offline_eval_runner": 1, "num_gpus_per_offline_eval_runner": 0, "custom_resources_per_offline_eval_runner": {}, "restart_failed_offline_eval_runners": true, "ignore_offline_eval_runner_failures": false, "max_num_offline_eval_runner_restarts": 1000, "offline_eval_runner_restore_timeout_s": 1800.0, "max_requests_in_flight_per_offline_eval_runner": 1, "validate_offline_eval_runners_after_construction": true, "offline_eval_runner_health_probe_timeout_s": 30.0, "offline_eval_rl_module_inference_only": false, "broadcast_offline_eval_runner_states": false, "offline_eval_batch_size_per_runner": 256, "dataset_num_iters_per_eval_runner": 1, "keep_per_episode_custom_metrics": false, "metrics_episode_collection_timeout_s": 60.0, "metrics_num_episodes_for_smoothing": 100, "min_time_s_per_iteration": null, "min_train_timesteps_per_iteration": 0, "min_sample_timesteps_per_iteration": 0, "log_gradients": true, "export_native_model_files": false, "checkpoint_trainable_policies_only": false, "logger_creator": null, "logger_config": null, "log_level": "WARN", "log_sys_usage": true, "fake_sampler": false, "seed": 10, "restart_failed_env_runners": true, "ignore_env_runner_failures": false, "max_num_env_runner_restarts": 1000, "delay_between_env_runner_restarts_s": 60.0, "restart_failed_sub_environments": false, "num_consecutive_env_runner_failures_tolerance": 100, "env_runner_health_probe_timeout_s": 30.0, "env_runner_restore_timeout_s": 1800.0, "_model_config": {}, "_rl_module_spec": "RLModuleSpec(module_class=None, observation_space=None, action_space=None, inference_only=False, learner_only=False, model_config=DefaultModelConfig(fcnet_hiddens=[60, 90], fcnet_activation='tanh', fcnet_kernel_initializer=None, fcnet_kernel_initializer_kwargs=None, fcnet_bias_initializer=None, fcnet_bias_initializer_kwargs=None, conv_filters=None, conv_activation='relu', conv_kernel_initializer=None, conv_kernel_initializer_kwargs=None, conv_bias_initializer=None, conv_bias_initializer_kwargs=None, head_fcnet_hiddens=[], head_fcnet_activation='relu', head_fcnet_kernel_initializer=None, head_fcnet_kernel_initializer_kwargs=None, head_fcnet_bias_initializer=None, head_fcnet_bias_initializer_kwargs=None, free_log_std=False, log_std_clip_param=20.0, vf_share_layers=True, use_lstm=False, max_seq_len=20, lstm_cell_size=256, lstm_use_prev_action=False, lstm_use_prev_reward=False, lstm_kernel_initializer=None, lstm_kernel_initializer_kwargs=None, lstm_bias_initializer=None, lstm_bias_initializer_kwargs=None), catalog_class=None, load_state_path=None, model_config_dict=None)", "algorithm_config_overrides_per_module": {}, "_per_module_overrides": {}, "_validate_config": true, "_use_msgpack_checkpoints": false, "_torch_grad_scaler_class": null, "_torch_lr_scheduler_classes": null, "_tf_policy_handles_more_than_one_loss": false, "_disable_preprocessor_api": false, "_disable_action_flattening": false, "_disable_initialize_loss_from_dummy_batch": false, "_dont_auto_sync_env_runner_states": false, "env_task_fn": -1, "enable_connectors": -1, "simple_optimizer": false, "policy_map_cache": -1, "worker_cls": -1, "synchronize_filters": -1, "enable_async_evaluation": -1, "custom_async_evaluation_function": -1, "_enable_rl_module_api": -1, "auto_wrap_old_gym_envs": -1, "always_attach_evaluation_results": -1, "replay_sequence_length": null, "_disable_execution_plan_api": -1, "use_critic": true, "use_gae": true, "use_kl_loss": true, "kl_coeff": 0.7464963036515, "kl_target": 0.0270990929592, "vf_loss_coeff": 0.6688075857018, "entropy_coeff": 0.0090570820258, "clip_param": 0.1221781641624, "vf_clip_param": 0.1027808522125, "entropy_coeff_schedule": null, "lr_schedule": null, "sgd_minibatch_size": -1, "vf_share_layers": -1, "__stdout_file__": null, "__stderr_file__": null, "lambda": 0.9099046732075, "input": "sampler", "policies": {"default_policy": [null, null, null, null]}, "callbacks": "<class 'ray.rllib.callbacks.callbacks.RLlibCallback'>", "create_env_on_driver": false, "custom_eval_function": null, "framework": "torch"}, "time_since_restore": 28.288273572921753, "iterations_since_restore": 12, "perf": {"cpu_util_percent": 40.63333333333333, "ram_util_percent": 74.83333333333333}}
{"timers": {"training_iteration": 2.6027929342309526, "restore_env_runners": 1.3861545266399044e-05, "training_step": 2.6026108580374077, "env_runner_sampling_timer": 2.444649700852661, "learner_update_timer": 0.15479251096547128, "synch_weights": 0.0006077650088063538, "restore_eval_env_runners": 8.890243141479106e-06, "evaluation_iteration": 0.1352144319777332, "synch_eval_env_connectors": 0.00022886241488590954, "synch_env_connectors": 4.751615737524409e-06}, "env_runners": {"num_episodes": 250.0, "module_to_env_connector": {"timers": {"connectors": {"remove_single_ts_time_rank_from_batch": 5.79134567175622e-07, "listify_data_for_vector_env": 1.0975554432194864e-05, "get_actions": 3.890712385705208e-05, "tensor_to_numpy": 1.3277341350181221e-05, "un_batch_to_individual_items": 5.396362417513958e-06, "normalize_and_clip_actions": 9.451104621093859e-06}}, "connector_pipeline_timer": 0.00010438407877597679}, "episode_duration_sec_mean": 0.00455599663220346, "env_to_module_sum_episodes_length_in": 10.36823839457432, "episode_return_min": -10.5, "episode_len_max": 20, "episode_len_mean": 20.0, "env_step_timer": 1.3756761768125538e-05, "num_agent_steps_sampled": {"default_agent": 5000.0}, "module_episode_returns_mean": {"default_policy": 3.339999999999999}, "num_agent_steps_sampled_lifetime": {"default_agent": -6782500.0}, "agent_episode_returns_mean": {"default_agent": 3.339999999999999}, "weights_seq_no": 12.0, "env_to_module_connector": {"timers": {"connectors": {"add_observations_from_episodes_to_batch": 2.9155856157545057e-06, "numpy_to_tensor": 8.57610615870614e-06, "add_states_from_episodes_to_batch": 1.730598769288306e-06, "add_time_dim_to_batch_and_zero_pad": 2.3137402357279303e-06, "batch_individual_items": 6.3528070496843315e-06}}, "connector_pipeline_timer": 4.394693735916302e-05}, "sample": 0.00484015906859982, "num_module_steps_sampled_lifetime": {"default_policy": -6782500.0}, "num_env_steps_sampled_lifetime": -6782500.0, "episode_len_min": 20, "episode_return_max": 9.5, "num_episodes_lifetime": -339125.0, "time_between_sampling": 0.0016780506132791897, "num_module_steps_sampled": {"default_policy": 5000.0}, "env_reset_timer": 3.1198335042868566e-05, "num_env_steps_sampled": 5000.0, "episode_return_mean": 3.339999999999999, "rlmodule_inference_timer": 2.7024969708964257e-05, "env_to_module_sum_episodes_length_out": 10.36823839457432, "num_env_steps_sampled_lifetime_throughput": 3742.818162059204}, "learners": {"__all_modules__": {"num_trainable_parameters": 6003, "learner_connector": {"timers": {"connectors": {"add_time_dim_to_batch_and_zero_pad": 2.4244330780436072e-05, "batch_individual_items": 0.03912545628713772, "add_states_from_episodes_to_batch": 7.226369066230877e-06, "general_advantage_estimation": 0.007498639861900616, "add_columns_from_episodes_to_train_batch": 0.057862715160764376, "numpy_to_tensor": 7.669017144404836e-05, "add_one_ts_to_episodes_and_truncate": 0.014025922493667993, "add_observations_from_episodes_to_batch": 0.0019032303365703073}}, "connector_pipeline_timer": 0.12079170421578662}, "learner_connector_sum_episodes_length_in": 5000.0, "num_module_steps_trained": 6000, "num_non_trainable_parameters": 0, "num_module_steps_trained_lifetime": 78000, "learner_connector_sum_episodes_length_out": 5250.0, "num_env_steps_trained_lifetime": 409500, "num_env_steps_trained": 31500, "num_env_steps_trained_lifetime_throughput": 1697463.7108328457, "num_module_steps_trained_throughput": 324405.99955060903, "num_module_steps_trained_lifetime_throughput": 323943.39536736126}, "default_policy": {"vf_loss_unclipped": 28.610172271728516, "total_loss": 0.023966753855347633, "entropy": 0.5803787112236023, "num_trainable_parameters": 6003, "num_module_steps_trained_lifetime": 78000, "curr_kl_coeff": 9.112503903452307e-05, "vf_explained_var": -0.011479973793029785, "weights_seq_no": 13.0, "policy_loss": -0.039517566561698914, "num_module_steps_trained": 6000, "curr_entropy_coeff": 0.0090570820258, "mean_kl_loss": 0.0013015683507546782, "module_train_batch_size_mean": 1000.0, "vf_loss": 0.10278083384037018, "gradients_default_optimizer_global_norm": 0.02619677409529686, "default_optimizer_learning_rate": 0.0002847858517, "diff_num_grad_updates_vs_sampler_policy": 1.0, "num_module_steps_trained_lifetime_throughput": 324924.37178252}}, "num_training_step_calls_per_iteration": 1, "evaluation": {"env_runners": {"weights_seq_no": 13.0, "num_env_steps_sampled_lifetime": 65400, "module_to_env_connector": {"timers": {"connectors": {"remove_single_ts_time_rank_from_batch": 5.903256251424924e-07, "listify_data_for_vector_env": 1.1474089603435856e-05, "get_actions": 4.0167189155182976e-05, "un_batch_to_individual_items": 5.758446219873959e-06, "tensor_to_numpy": 1.3646436560696824e-05, "normalize_and_clip_actions": 9.80429785033118e-06}}, "connector_pipeline_timer": 0.00010739675262806663}, "module_episode_returns_mean": {"default_policy": 1.65}, "episode_return_mean": 1.65, "rlmodule_inference_timer": 2.831040826673794e-05, "episode_duration_sec_mean": 0.004711632075486705, "env_to_module_connector": {"timers": {"connectors": {"add_observations_from_episodes_to_batch": 2.8892398627703788e-06, "add_time_dim_to_batch_and_zero_pad": 2.3137162219754544e-06, "batch_individual_items": 6.324179959173387e-06, "add_states_from_episodes_to_batch": 1.9667477087730565e-06, "numpy_to_tensor": 8.821528831508107e-06}}, "connector_pipeline_timer": 4.416963807080896e-05}, "num_module_steps_sampled": {"default_policy": 400}, "episode_len_max": 20, "env_step_timer": 1.6469828704890267e-05, "sample": 0.12787243703724546, "agent_episode_returns_mean": {"default_agent": 1.65}, "env_reset_timer": 0.0003299679785884631, "env_to_module_sum_episodes_length_in": 10.368238394574323, "episode_len_mean": 20.0, "num_agent_steps_sampled": {"default_agent": 400}, "num_agent_steps_sampled_lifetime": {"default_agent": 5200}, "num_env_steps_sampled": 400, "num_module_steps_sampled_lifetime": {"default_policy": 5200}, "env_to_module_sum_episodes_length_out": 10.368238394574323, "num_episodes": 20, "episode_return_min": -14.5, "episode_len_min": 20, "episode_return_max": 13.5, "num_episodes_lifetime": 260, "time_between_sampling": 2.4128986047733645}, "num_healthy_workers": 1, "actor_manager_num_outstanding_async_reqs": 0, "num_remote_worker_restarts": 0}, "num_env_steps_sampled_lifetime": -6782500.0, "fault_tolerance": {"num_healthy_workers": 0, "num_remote_worker_restarts": 0}, "env_runner_group": {"actor_manager_num_outstanding_async_reqs": 0}, "done": false, "training_iteration": 13, "trial_id": "46920_00000", "date": "2025-08-11_19-35-50", "timestamp": 1754933750, "time_this_iter_s": 1.6811068058013916, "time_total_s": 29.969380378723145, "pid": 27748, "hostname": "Mac", "node_ip": "127.0.0.1", "config": {"exploration_config": {}, "extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "placement_strategy": "PACK", "num_gpus": 0, "_fake_gpus": false, "num_cpus_for_main_process": 2, "eager_tracing": true, "eager_max_retraces": 20, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "torch_compile_learner": false, "torch_compile_learner_what_to_compile": "forward_train", "torch_compile_learner_dynamo_backend": "aot_eager", "torch_compile_learner_dynamo_mode": null, "torch_compile_worker": false, "torch_compile_worker_dynamo_backend": "aot_eager", "torch_compile_worker_dynamo_mode": null, "torch_ddp_kwargs": {}, "torch_skip_nan_gradients": false, "env": "Umbrella", "env_config": {}, "observation_space": null, "action_space": null, "clip_rewards": null, "normalize_actions": true, "clip_actions": false, "_is_atari": null, "disable_env_checking": false, "render_env": false, "action_mask_key": "action_mask", "env_runner_cls": null, "num_env_runners": 0, "create_local_env_runner": true, "num_envs_per_env_runner": 1, "gym_env_vectorize_mode": "SYNC", "num_cpus_per_env_runner": 1, "num_gpus_per_env_runner": 0, "custom_resources_per_env_runner": {}, "validate_env_runners_after_construction": true, "episodes_to_numpy": true, "max_requests_in_flight_per_env_runner": 1, "sample_timeout_s": 60.0, "_env_to_module_connector": null, "add_default_connectors_to_env_to_module_pipeline": true, "_module_to_env_connector": null, "add_default_connectors_to_module_to_env_pipeline": true, "merge_env_runner_states": "training_only", "broadcast_env_runner_states": true, "episode_lookback_horizon": 1, "rollout_fragment_length": "auto", "batch_mode": "complete_episodes", "compress_observations": false, "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "enable_tf1_exec_eagerly": false, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "preprocessor_pref": "deepmind", "observation_filter": "NoFilter", "update_worker_filter_stats": true, "use_worker_filter_stats": true, "sampler_perf_stats_ema_coef": null, "_is_online": true, "num_learners": 0, "num_gpus_per_learner": 0, "num_cpus_per_learner": "auto", "num_aggregator_actors_per_learner": 0, "max_requests_in_flight_per_aggregator_actor": 3, "local_gpu_idx": 0, "max_requests_in_flight_per_learner": 3, "gamma": 1, "lr": 0.0002847858517, "grad_clip": 0.5, "grad_clip_by": "global_norm", "_train_batch_size_per_learner": 5000, "train_batch_size": 4000, "num_epochs": 1, "minibatch_size": 1000, "shuffle_batch_per_epoch": true, "model": {"fcnet_hiddens": [256, 256], "fcnet_activation": "tanh", "fcnet_weights_initializer": null, "fcnet_weights_initializer_config": null, "fcnet_bias_initializer": null, "fcnet_bias_initializer_config": null, "conv_filters": null, "conv_activation": "relu", "conv_kernel_initializer": null, "conv_kernel_initializer_config": null, "conv_bias_initializer": null, "conv_bias_initializer_config": null, "conv_transpose_kernel_initializer": null, "conv_transpose_kernel_initializer_config": null, "conv_transpose_bias_initializer": null, "conv_transpose_bias_initializer_config": null, "post_fcnet_hiddens": [], "post_fcnet_activation": "relu", "post_fcnet_weights_initializer": null, "post_fcnet_weights_initializer_config": null, "post_fcnet_bias_initializer": null, "post_fcnet_bias_initializer_config": null, "free_log_std": false, "log_std_clip_param": 20.0, "no_final_linear": false, "vf_share_layers": false, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "lstm_weights_initializer": null, "lstm_weights_initializer_config": null, "lstm_bias_initializer": null, "lstm_bias_initializer_config": null, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "attention_use_n_prev_actions": 0, "attention_use_n_prev_rewards": 0, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": null, "custom_model_config": {}, "custom_action_dist": null, "custom_preprocessor": null, "encoder_latent_dim": null, "always_check_shapes": false, "lstm_use_prev_action_reward": -1, "_use_default_native_models": -1, "_disable_preprocessor_api": false, "_disable_action_flattening": false}, "_learner_connector": null, "add_default_connectors_to_learner_pipeline": true, "learner_config_dict": {}, "optimizer": {}, "_learner_class": null, "callbacks_on_algorithm_init": null, "callbacks_on_env_runners_recreated": null, "callbacks_on_offline_eval_runners_recreated": null, "callbacks_on_checkpoint_loaded": null, "callbacks_on_environment_created": null, "callbacks_on_episode_created": null, "callbacks_on_episode_start": null, "callbacks_on_episode_step": null, "callbacks_on_episode_end": null, "callbacks_on_evaluate_start": null, "callbacks_on_evaluate_end": null, "callbacks_on_evaluate_offline_start": null, "callbacks_on_evaluate_offline_end": null, "callbacks_on_sample_end": null, "callbacks_on_train_result": null, "explore": true, "enable_rl_module_and_learner": true, "enable_env_runner_and_connector_v2": true, "_prior_exploration_config": {"type": "StochasticSampling"}, "count_steps_by": "env_steps", "policy_map_capacity": 100, "policy_mapping_fn": "<function AlgorithmConfig.DEFAULT_POLICY_MAPPING_FN at 0x3847e9b20>", "policies_to_train": null, "policy_states_are_swappable": false, "observation_fn": null, "offline_data_class": null, "input_read_method": "read_parquet", "input_read_method_kwargs": {}, "input_read_schema": {}, "input_read_episodes": false, "input_read_sample_batches": false, "input_read_batch_size": null, "input_filesystem": null, "input_filesystem_kwargs": {}, "input_compress_columns": ["obs", "new_obs"], "input_spaces_jsonable": true, "materialize_data": false, "materialize_mapped_data": true, "map_batches_kwargs": {}, "iter_batches_kwargs": {}, "ignore_final_observation": false, "prelearner_class": null, "prelearner_buffer_class": null, "prelearner_buffer_kwargs": {}, "prelearner_module_synch_period": 10, "dataset_num_iters_per_learner": null, "input_config": {}, "actions_in_input_normalized": false, "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_config": {}, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "output_max_rows_per_file": null, "output_write_remaining_data": false, "output_write_method": "write_parquet", "output_write_method_kwargs": {}, "output_filesystem": null, "output_filesystem_kwargs": {}, "output_write_episodes": true, "offline_sampling": false, "evaluation_interval": 1, "evaluation_duration": 20, "evaluation_duration_unit": "episodes", "evaluation_sample_timeout_s": 120.0, "evaluation_auto_duration_min_env_steps_per_sample": 100, "evaluation_auto_duration_max_env_steps_per_sample": 2000, "evaluation_parallel_to_training": false, "evaluation_force_reset_envs_before_iteration": true, "evaluation_config": null, "off_policy_estimation_methods": {}, "ope_split_batch_by_episode": true, "evaluation_num_env_runners": 1, "in_evaluation": false, "sync_filters_on_rollout_workers_timeout_s": 10.0, "offline_evaluation_interval": null, "num_offline_eval_runners": 0, "offline_loss_for_module_fn": null, "offline_evaluation_duration": 1, "offline_evaluation_parallel_to_training": false, "offline_evaluation_timeout_s": 120.0, "num_cpus_per_offline_eval_runner": 1, "num_gpus_per_offline_eval_runner": 0, "custom_resources_per_offline_eval_runner": {}, "restart_failed_offline_eval_runners": true, "ignore_offline_eval_runner_failures": false, "max_num_offline_eval_runner_restarts": 1000, "offline_eval_runner_restore_timeout_s": 1800.0, "max_requests_in_flight_per_offline_eval_runner": 1, "validate_offline_eval_runners_after_construction": true, "offline_eval_runner_health_probe_timeout_s": 30.0, "offline_eval_rl_module_inference_only": false, "broadcast_offline_eval_runner_states": false, "offline_eval_batch_size_per_runner": 256, "dataset_num_iters_per_eval_runner": 1, "keep_per_episode_custom_metrics": false, "metrics_episode_collection_timeout_s": 60.0, "metrics_num_episodes_for_smoothing": 100, "min_time_s_per_iteration": null, "min_train_timesteps_per_iteration": 0, "min_sample_timesteps_per_iteration": 0, "log_gradients": true, "export_native_model_files": false, "checkpoint_trainable_policies_only": false, "logger_creator": null, "logger_config": null, "log_level": "WARN", "log_sys_usage": true, "fake_sampler": false, "seed": 10, "restart_failed_env_runners": true, "ignore_env_runner_failures": false, "max_num_env_runner_restarts": 1000, "delay_between_env_runner_restarts_s": 60.0, "restart_failed_sub_environments": false, "num_consecutive_env_runner_failures_tolerance": 100, "env_runner_health_probe_timeout_s": 30.0, "env_runner_restore_timeout_s": 1800.0, "_model_config": {}, "_rl_module_spec": "RLModuleSpec(module_class=None, observation_space=None, action_space=None, inference_only=False, learner_only=False, model_config=DefaultModelConfig(fcnet_hiddens=[60, 90], fcnet_activation='tanh', fcnet_kernel_initializer=None, fcnet_kernel_initializer_kwargs=None, fcnet_bias_initializer=None, fcnet_bias_initializer_kwargs=None, conv_filters=None, conv_activation='relu', conv_kernel_initializer=None, conv_kernel_initializer_kwargs=None, conv_bias_initializer=None, conv_bias_initializer_kwargs=None, head_fcnet_hiddens=[], head_fcnet_activation='relu', head_fcnet_kernel_initializer=None, head_fcnet_kernel_initializer_kwargs=None, head_fcnet_bias_initializer=None, head_fcnet_bias_initializer_kwargs=None, free_log_std=False, log_std_clip_param=20.0, vf_share_layers=True, use_lstm=False, max_seq_len=20, lstm_cell_size=256, lstm_use_prev_action=False, lstm_use_prev_reward=False, lstm_kernel_initializer=None, lstm_kernel_initializer_kwargs=None, lstm_bias_initializer=None, lstm_bias_initializer_kwargs=None), catalog_class=None, load_state_path=None, model_config_dict=None)", "algorithm_config_overrides_per_module": {}, "_per_module_overrides": {}, "_validate_config": true, "_use_msgpack_checkpoints": false, "_torch_grad_scaler_class": null, "_torch_lr_scheduler_classes": null, "_tf_policy_handles_more_than_one_loss": false, "_disable_preprocessor_api": false, "_disable_action_flattening": false, "_disable_initialize_loss_from_dummy_batch": false, "_dont_auto_sync_env_runner_states": false, "env_task_fn": -1, "enable_connectors": -1, "simple_optimizer": false, "policy_map_cache": -1, "worker_cls": -1, "synchronize_filters": -1, "enable_async_evaluation": -1, "custom_async_evaluation_function": -1, "_enable_rl_module_api": -1, "auto_wrap_old_gym_envs": -1, "always_attach_evaluation_results": -1, "replay_sequence_length": null, "_disable_execution_plan_api": -1, "use_critic": true, "use_gae": true, "use_kl_loss": true, "kl_coeff": 0.7464963036515, "kl_target": 0.0270990929592, "vf_loss_coeff": 0.6688075857018, "entropy_coeff": 0.0090570820258, "clip_param": 0.1221781641624, "vf_clip_param": 0.1027808522125, "entropy_coeff_schedule": null, "lr_schedule": null, "sgd_minibatch_size": -1, "vf_share_layers": -1, "__stdout_file__": null, "__stderr_file__": null, "lambda": 0.9099046732075, "input": "sampler", "policies": {"default_policy": [null, null, null, null]}, "callbacks": "<class 'ray.rllib.callbacks.callbacks.RLlibCallback'>", "create_env_on_driver": false, "custom_eval_function": null, "framework": "torch"}, "time_since_restore": 29.969380378723145, "iterations_since_restore": 13, "perf": {"cpu_util_percent": 37.15, "ram_util_percent": 74.65}}
{"timers": {"training_iteration": 2.5931608157183517, "restore_env_runners": 1.3779179368935391e-05, "training_step": 2.5929786277970566, "env_runner_sampling_timer": 2.4346155955141824, "learner_update_timer": 0.15519341752626847, "synch_weights": 0.000607706938896253, "restore_eval_env_runners": 8.867591505562806e-06, "evaluation_iteration": 0.1349514201583026, "synch_eval_env_connectors": 0.00022770212063248722, "synch_env_connectors": 4.749509704734198e-06}, "env_runners": {"num_episodes": 250.0, "module_to_env_connector": {"timers": {"connectors": {"remove_single_ts_time_rank_from_batch": 5.908155529943279e-07, "listify_data_for_vector_env": 1.141305709405951e-05, "get_actions": 4.199922371771854e-05, "tensor_to_numpy": 1.392647368215714e-05, "un_batch_to_individual_items": 5.609718449375091e-06, "normalize_and_clip_actions": 9.849987984865882e-06}}, "connector_pipeline_timer": 0.000109786438440019}, "episode_duration_sec_mean": 0.004768442205153405, "env_to_module_sum_episodes_length_in": 10.36823839457432, "episode_return_min": -10.5, "episode_len_max": 20, "episode_len_mean": 20.0, "env_step_timer": 1.4417564389304424e-05, "num_agent_steps_sampled": {"default_agent": 5000.0}, "module_episode_returns_mean": {"default_policy": 5.019999999999998}, "num_agent_steps_sampled_lifetime": {"default_agent": -7400000.0}, "agent_episode_returns_mean": {"default_agent": 5.019999999999998}, "weights_seq_no": 13.0, "env_to_module_connector": {"timers": {"connectors": {"add_observations_from_episodes_to_batch": 3.0007778187722636e-06, "numpy_to_tensor": 9.042065522434586e-06, "add_states_from_episodes_to_batch": 1.768021491459168e-06, "add_time_dim_to_batch_and_zero_pad": 2.4204991585743807e-06, "batch_individual_items": 6.613771902870278e-06}}, "connector_pipeline_timer": 4.547997248508602e-05}, "sample": 0.005063256293055373, "num_module_steps_sampled_lifetime": {"default_policy": -7400000.0}, "num_env_steps_sampled_lifetime": -7400000.0, "episode_len_min": 20, "episode_return_max": 9.5, "num_episodes_lifetime": -370000.0, "time_between_sampling": 0.0017452231148790307, "num_module_steps_sampled": {"default_policy": 5000.0}, "env_reset_timer": 3.7464498966816845e-05, "num_env_steps_sampled": 5000.0, "episode_return_mean": 5.019999999999998, "rlmodule_inference_timer": 2.9130969783918464e-05, "env_to_module_sum_episodes_length_out": 10.36823839457432, "num_env_steps_sampled_lifetime_throughput": 3555.343772790148}, "learners": {"__all_modules__": {"num_trainable_parameters": 6003, "learner_connector": {"timers": {"connectors": {"add_time_dim_to_batch_and_zero_pad": 2.411813748470165e-05, "batch_individual_items": 0.04005275838481979, "add_states_from_episodes_to_batch": 7.187014822895824e-06, "general_advantage_estimation": 0.007491979302519851, "add_columns_from_episodes_to_train_batch": 0.057626896759149136, "numpy_to_tensor": 7.662952074176925e-05, "add_one_ts_to_episodes_and_truncate": 0.013961816188522951, "add_observations_from_episodes_to_batch": 0.0018922992834824366}}, "connector_pipeline_timer": 0.12139964800387616}, "learner_connector_sum_episodes_length_in": 5000.0, "num_module_steps_trained": 6000, "num_non_trainable_parameters": 0, "num_module_steps_trained_lifetime": 84000, "learner_connector_sum_episodes_length_out": 5250.0, "num_env_steps_trained_lifetime": 441000, "num_env_steps_trained": 31500, "num_env_steps_trained_lifetime_throughput": 1719224.1096215616, "num_module_steps_trained_throughput": 328511.10603962763, "num_module_steps_trained_lifetime_throughput": 328061.5602305168}, "default_policy": {"vf_loss_unclipped": 28.610187530517578, "total_loss": -0.1332673281431198, "entropy": 0.5491995215415955, "num_trainable_parameters": 6003, "num_module_steps_trained_lifetime": 84000, "curr_kl_coeff": 4.5562519517261535e-05, "vf_explained_var": -0.00948035717010498, "weights_seq_no": 14.0, "policy_loss": -0.19703388214111328, "num_module_steps_trained": 6000, "curr_entropy_coeff": 0.0090570820258, "mean_kl_loss": 0.001021185191348195, "module_train_batch_size_mean": 1000.0, "vf_loss": 0.10278083384037018, "gradients_default_optimizer_global_norm": 0.035518303513526917, "default_optimizer_learning_rate": 0.0002847858517, "diff_num_grad_updates_vs_sampler_policy": 1.0, "num_module_steps_trained_lifetime_throughput": 328968.5011138697}}, "num_training_step_calls_per_iteration": 1, "evaluation": {"env_runners": {"weights_seq_no": 14.0, "num_env_steps_sampled_lifetime": 70400, "module_to_env_connector": {"timers": {"connectors": {"remove_single_ts_time_rank_from_batch": 5.774426507488462e-07, "listify_data_for_vector_env": 1.0928654040891053e-05, "get_actions": 3.712378745388262e-05, "un_batch_to_individual_items": 5.314463560529312e-06, "tensor_to_numpy": 1.3113531737299077e-05, "normalize_and_clip_actions": 9.415252775032324e-06}}, "connector_pipeline_timer": 0.00010182139768247446}, "module_episode_returns_mean": {"default_policy": 1.45}, "episode_return_mean": 1.45, "rlmodule_inference_timer": 2.7026441646163825e-05, "episode_duration_sec_mean": 0.004536289117531851, "env_to_module_connector": {"timers": {"connectors": {"add_observations_from_episodes_to_batch": 2.7490919356870586e-06, "add_time_dim_to_batch_and_zero_pad": 2.1877474381538353e-06, "batch_individual_items": 6.133568586903057e-06, "add_states_from_episodes_to_batch": 1.5185568385821262e-06, "numpy_to_tensor": 8.347916964157569e-06}}, "connector_pipeline_timer": 4.204806438948921e-05}, "num_module_steps_sampled": {"default_policy": 400}, "episode_len_max": 20, "env_step_timer": 1.3737600351556097e-05, "sample": 0.12757528099660773, "agent_episode_returns_mean": {"default_agent": 1.45}, "env_reset_timer": 0.00032746204873477814, "env_to_module_sum_episodes_length_in": 10.368238394574323, "episode_len_mean": 20.0, "num_agent_steps_sampled": {"default_agent": 400}, "num_agent_steps_sampled_lifetime": {"default_agent": 5600}, "num_env_steps_sampled": 400, "num_module_steps_sampled_lifetime": {"default_policy": 5600}, "env_to_module_sum_episodes_length_out": 10.368238394574323, "num_episodes": 20, "episode_return_min": -14.5, "episode_len_min": 20, "episode_return_max": 13.5, "num_episodes_lifetime": 280, "time_between_sampling": 2.4053395937255053}, "num_healthy_workers": 1, "actor_manager_num_outstanding_async_reqs": 0, "num_remote_worker_restarts": 0}, "num_env_steps_sampled_lifetime": -7400000.0, "fault_tolerance": {"num_healthy_workers": 0, "num_remote_worker_restarts": 0}, "env_runner_group": {"actor_manager_num_outstanding_async_reqs": 0}, "done": false, "training_iteration": 14, "trial_id": "46920_00000", "date": "2025-08-11_19-35-51", "timestamp": 1754933751, "time_this_iter_s": 1.7450249195098877, "time_total_s": 31.714405298233032, "pid": 27748, "hostname": "Mac", "node_ip": "127.0.0.1", "config": {"exploration_config": {}, "extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "placement_strategy": "PACK", "num_gpus": 0, "_fake_gpus": false, "num_cpus_for_main_process": 2, "eager_tracing": true, "eager_max_retraces": 20, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "torch_compile_learner": false, "torch_compile_learner_what_to_compile": "forward_train", "torch_compile_learner_dynamo_backend": "aot_eager", "torch_compile_learner_dynamo_mode": null, "torch_compile_worker": false, "torch_compile_worker_dynamo_backend": "aot_eager", "torch_compile_worker_dynamo_mode": null, "torch_ddp_kwargs": {}, "torch_skip_nan_gradients": false, "env": "Umbrella", "env_config": {}, "observation_space": null, "action_space": null, "clip_rewards": null, "normalize_actions": true, "clip_actions": false, "_is_atari": null, "disable_env_checking": false, "render_env": false, "action_mask_key": "action_mask", "env_runner_cls": null, "num_env_runners": 0, "create_local_env_runner": true, "num_envs_per_env_runner": 1, "gym_env_vectorize_mode": "SYNC", "num_cpus_per_env_runner": 1, "num_gpus_per_env_runner": 0, "custom_resources_per_env_runner": {}, "validate_env_runners_after_construction": true, "episodes_to_numpy": true, "max_requests_in_flight_per_env_runner": 1, "sample_timeout_s": 60.0, "_env_to_module_connector": null, "add_default_connectors_to_env_to_module_pipeline": true, "_module_to_env_connector": null, "add_default_connectors_to_module_to_env_pipeline": true, "merge_env_runner_states": "training_only", "broadcast_env_runner_states": true, "episode_lookback_horizon": 1, "rollout_fragment_length": "auto", "batch_mode": "complete_episodes", "compress_observations": false, "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "enable_tf1_exec_eagerly": false, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "preprocessor_pref": "deepmind", "observation_filter": "NoFilter", "update_worker_filter_stats": true, "use_worker_filter_stats": true, "sampler_perf_stats_ema_coef": null, "_is_online": true, "num_learners": 0, "num_gpus_per_learner": 0, "num_cpus_per_learner": "auto", "num_aggregator_actors_per_learner": 0, "max_requests_in_flight_per_aggregator_actor": 3, "local_gpu_idx": 0, "max_requests_in_flight_per_learner": 3, "gamma": 1, "lr": 0.0002847858517, "grad_clip": 0.5, "grad_clip_by": "global_norm", "_train_batch_size_per_learner": 5000, "train_batch_size": 4000, "num_epochs": 1, "minibatch_size": 1000, "shuffle_batch_per_epoch": true, "model": {"fcnet_hiddens": [256, 256], "fcnet_activation": "tanh", "fcnet_weights_initializer": null, "fcnet_weights_initializer_config": null, "fcnet_bias_initializer": null, "fcnet_bias_initializer_config": null, "conv_filters": null, "conv_activation": "relu", "conv_kernel_initializer": null, "conv_kernel_initializer_config": null, "conv_bias_initializer": null, "conv_bias_initializer_config": null, "conv_transpose_kernel_initializer": null, "conv_transpose_kernel_initializer_config": null, "conv_transpose_bias_initializer": null, "conv_transpose_bias_initializer_config": null, "post_fcnet_hiddens": [], "post_fcnet_activation": "relu", "post_fcnet_weights_initializer": null, "post_fcnet_weights_initializer_config": null, "post_fcnet_bias_initializer": null, "post_fcnet_bias_initializer_config": null, "free_log_std": false, "log_std_clip_param": 20.0, "no_final_linear": false, "vf_share_layers": false, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "lstm_weights_initializer": null, "lstm_weights_initializer_config": null, "lstm_bias_initializer": null, "lstm_bias_initializer_config": null, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "attention_use_n_prev_actions": 0, "attention_use_n_prev_rewards": 0, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": null, "custom_model_config": {}, "custom_action_dist": null, "custom_preprocessor": null, "encoder_latent_dim": null, "always_check_shapes": false, "lstm_use_prev_action_reward": -1, "_use_default_native_models": -1, "_disable_preprocessor_api": false, "_disable_action_flattening": false}, "_learner_connector": null, "add_default_connectors_to_learner_pipeline": true, "learner_config_dict": {}, "optimizer": {}, "_learner_class": null, "callbacks_on_algorithm_init": null, "callbacks_on_env_runners_recreated": null, "callbacks_on_offline_eval_runners_recreated": null, "callbacks_on_checkpoint_loaded": null, "callbacks_on_environment_created": null, "callbacks_on_episode_created": null, "callbacks_on_episode_start": null, "callbacks_on_episode_step": null, "callbacks_on_episode_end": null, "callbacks_on_evaluate_start": null, "callbacks_on_evaluate_end": null, "callbacks_on_evaluate_offline_start": null, "callbacks_on_evaluate_offline_end": null, "callbacks_on_sample_end": null, "callbacks_on_train_result": null, "explore": true, "enable_rl_module_and_learner": true, "enable_env_runner_and_connector_v2": true, "_prior_exploration_config": {"type": "StochasticSampling"}, "count_steps_by": "env_steps", "policy_map_capacity": 100, "policy_mapping_fn": "<function AlgorithmConfig.DEFAULT_POLICY_MAPPING_FN at 0x3847e9b20>", "policies_to_train": null, "policy_states_are_swappable": false, "observation_fn": null, "offline_data_class": null, "input_read_method": "read_parquet", "input_read_method_kwargs": {}, "input_read_schema": {}, "input_read_episodes": false, "input_read_sample_batches": false, "input_read_batch_size": null, "input_filesystem": null, "input_filesystem_kwargs": {}, "input_compress_columns": ["obs", "new_obs"], "input_spaces_jsonable": true, "materialize_data": false, "materialize_mapped_data": true, "map_batches_kwargs": {}, "iter_batches_kwargs": {}, "ignore_final_observation": false, "prelearner_class": null, "prelearner_buffer_class": null, "prelearner_buffer_kwargs": {}, "prelearner_module_synch_period": 10, "dataset_num_iters_per_learner": null, "input_config": {}, "actions_in_input_normalized": false, "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_config": {}, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "output_max_rows_per_file": null, "output_write_remaining_data": false, "output_write_method": "write_parquet", "output_write_method_kwargs": {}, "output_filesystem": null, "output_filesystem_kwargs": {}, "output_write_episodes": true, "offline_sampling": false, "evaluation_interval": 1, "evaluation_duration": 20, "evaluation_duration_unit": "episodes", "evaluation_sample_timeout_s": 120.0, "evaluation_auto_duration_min_env_steps_per_sample": 100, "evaluation_auto_duration_max_env_steps_per_sample": 2000, "evaluation_parallel_to_training": false, "evaluation_force_reset_envs_before_iteration": true, "evaluation_config": null, "off_policy_estimation_methods": {}, "ope_split_batch_by_episode": true, "evaluation_num_env_runners": 1, "in_evaluation": false, "sync_filters_on_rollout_workers_timeout_s": 10.0, "offline_evaluation_interval": null, "num_offline_eval_runners": 0, "offline_loss_for_module_fn": null, "offline_evaluation_duration": 1, "offline_evaluation_parallel_to_training": false, "offline_evaluation_timeout_s": 120.0, "num_cpus_per_offline_eval_runner": 1, "num_gpus_per_offline_eval_runner": 0, "custom_resources_per_offline_eval_runner": {}, "restart_failed_offline_eval_runners": true, "ignore_offline_eval_runner_failures": false, "max_num_offline_eval_runner_restarts": 1000, "offline_eval_runner_restore_timeout_s": 1800.0, "max_requests_in_flight_per_offline_eval_runner": 1, "validate_offline_eval_runners_after_construction": true, "offline_eval_runner_health_probe_timeout_s": 30.0, "offline_eval_rl_module_inference_only": false, "broadcast_offline_eval_runner_states": false, "offline_eval_batch_size_per_runner": 256, "dataset_num_iters_per_eval_runner": 1, "keep_per_episode_custom_metrics": false, "metrics_episode_collection_timeout_s": 60.0, "metrics_num_episodes_for_smoothing": 100, "min_time_s_per_iteration": null, "min_train_timesteps_per_iteration": 0, "min_sample_timesteps_per_iteration": 0, "log_gradients": true, "export_native_model_files": false, "checkpoint_trainable_policies_only": false, "logger_creator": null, "logger_config": null, "log_level": "WARN", "log_sys_usage": true, "fake_sampler": false, "seed": 10, "restart_failed_env_runners": true, "ignore_env_runner_failures": false, "max_num_env_runner_restarts": 1000, "delay_between_env_runner_restarts_s": 60.0, "restart_failed_sub_environments": false, "num_consecutive_env_runner_failures_tolerance": 100, "env_runner_health_probe_timeout_s": 30.0, "env_runner_restore_timeout_s": 1800.0, "_model_config": {}, "_rl_module_spec": "RLModuleSpec(module_class=None, observation_space=None, action_space=None, inference_only=False, learner_only=False, model_config=DefaultModelConfig(fcnet_hiddens=[60, 90], fcnet_activation='tanh', fcnet_kernel_initializer=None, fcnet_kernel_initializer_kwargs=None, fcnet_bias_initializer=None, fcnet_bias_initializer_kwargs=None, conv_filters=None, conv_activation='relu', conv_kernel_initializer=None, conv_kernel_initializer_kwargs=None, conv_bias_initializer=None, conv_bias_initializer_kwargs=None, head_fcnet_hiddens=[], head_fcnet_activation='relu', head_fcnet_kernel_initializer=None, head_fcnet_kernel_initializer_kwargs=None, head_fcnet_bias_initializer=None, head_fcnet_bias_initializer_kwargs=None, free_log_std=False, log_std_clip_param=20.0, vf_share_layers=True, use_lstm=False, max_seq_len=20, lstm_cell_size=256, lstm_use_prev_action=False, lstm_use_prev_reward=False, lstm_kernel_initializer=None, lstm_kernel_initializer_kwargs=None, lstm_bias_initializer=None, lstm_bias_initializer_kwargs=None), catalog_class=None, load_state_path=None, model_config_dict=None)", "algorithm_config_overrides_per_module": {}, "_per_module_overrides": {}, "_validate_config": true, "_use_msgpack_checkpoints": false, "_torch_grad_scaler_class": null, "_torch_lr_scheduler_classes": null, "_tf_policy_handles_more_than_one_loss": false, "_disable_preprocessor_api": false, "_disable_action_flattening": false, "_disable_initialize_loss_from_dummy_batch": false, "_dont_auto_sync_env_runner_states": false, "env_task_fn": -1, "enable_connectors": -1, "simple_optimizer": false, "policy_map_cache": -1, "worker_cls": -1, "synchronize_filters": -1, "enable_async_evaluation": -1, "custom_async_evaluation_function": -1, "_enable_rl_module_api": -1, "auto_wrap_old_gym_envs": -1, "always_attach_evaluation_results": -1, "replay_sequence_length": null, "_disable_execution_plan_api": -1, "use_critic": true, "use_gae": true, "use_kl_loss": true, "kl_coeff": 0.7464963036515, "kl_target": 0.0270990929592, "vf_loss_coeff": 0.6688075857018, "entropy_coeff": 0.0090570820258, "clip_param": 0.1221781641624, "vf_clip_param": 0.1027808522125, "entropy_coeff_schedule": null, "lr_schedule": null, "sgd_minibatch_size": -1, "vf_share_layers": -1, "__stdout_file__": null, "__stderr_file__": null, "lambda": 0.9099046732075, "input": "sampler", "policies": {"default_policy": [null, null, null, null]}, "callbacks": "<class 'ray.rllib.callbacks.callbacks.RLlibCallback'>", "create_env_on_driver": false, "custom_eval_function": null, "framework": "torch"}, "time_since_restore": 31.714405298233032, "iterations_since_restore": 14, "perf": {"cpu_util_percent": 38.333333333333336, "ram_util_percent": 74.66666666666667}}
{"timers": {"training_iteration": 2.585790090480869, "restore_env_runners": 1.3699717472247423e-05, "training_step": 2.5856081873595627, "env_runner_sampling_timer": 2.4266336687187033, "learner_update_timer": 0.15580547043157236, "synch_weights": 0.0006070544498112426, "restore_eval_env_runners": 8.853084956196336e-06, "evaluation_iteration": 0.1346329292963208, "synch_eval_env_connectors": 0.0002263721788145871, "synch_env_connectors": 4.745345554624059e-06}, "env_runners": {"num_episodes": 250.0, "module_to_env_connector": {"timers": {"connectors": {"remove_single_ts_time_rank_from_batch": 6.629347052890856e-07, "listify_data_for_vector_env": 1.286039969588831e-05, "get_actions": 4.854033530868528e-05, "tensor_to_numpy": 1.805561763411285e-05, "un_batch_to_individual_items": 6.0976978872486395e-06, "normalize_and_clip_actions": 1.0742523322255085e-05}}, "connector_pipeline_timer": 0.00012609737760476517}, "episode_duration_sec_mean": 0.005466317342128606, "env_to_module_sum_episodes_length_in": 10.36823839457432, "episode_return_min": -10.5, "episode_len_max": 20, "episode_len_mean": 20.0, "env_step_timer": 1.709337057858018e-05, "num_agent_steps_sampled": {"default_agent": 5000.0}, "module_episode_returns_mean": {"default_policy": 4.14}, "num_agent_steps_sampled_lifetime": {"default_agent": -8017500.0}, "agent_episode_returns_mean": {"default_agent": 4.14}, "weights_seq_no": 14.0, "env_to_module_connector": {"timers": {"connectors": {"add_observations_from_episodes_to_batch": 3.4763397256572286e-06, "numpy_to_tensor": 1.0322589238134585e-05, "add_states_from_episodes_to_batch": 1.963493771949028e-06, "add_time_dim_to_batch_and_zero_pad": 2.7460155252769903e-06, "batch_individual_items": 7.376348225897255e-06}}, "connector_pipeline_timer": 5.0196288918277044e-05}, "sample": 0.005340478675243213, "num_module_steps_sampled_lifetime": {"default_policy": -8017500.0}, "num_env_steps_sampled_lifetime": -8017500.0, "episode_len_min": 20, "episode_return_max": 9.5, "num_episodes_lifetime": -400875.0, "time_between_sampling": 0.0019091362703993133, "num_module_steps_sampled": {"default_policy": 5000.0}, "env_reset_timer": 3.753529301084474e-05, "num_env_steps_sampled": 5000.0, "episode_return_mean": 4.14, "rlmodule_inference_timer": 3.293234023669596e-05, "env_to_module_sum_episodes_length_out": 10.36823839457432, "num_env_steps_sampled_lifetime_throughput": 3484.6787032887632}, "learners": {"__all_modules__": {"num_trainable_parameters": 6003, "learner_connector": {"timers": {"connectors": {"add_time_dim_to_batch_and_zero_pad": 2.4041956202092823e-05, "batch_individual_items": 0.041096079551758445, "add_states_from_episodes_to_batch": 7.147225244902715e-06, "general_advantage_estimation": 0.007480039089165007, "add_columns_from_episodes_to_train_batch": 0.05744100320176426, "numpy_to_tensor": 7.66453164720703e-05, "add_one_ts_to_episodes_and_truncate": 0.01391385510639398, "add_observations_from_episodes_to_batch": 0.0018970604605118944}}, "connector_pipeline_timer": 0.12220078777366648}, "learner_connector_sum_episodes_length_in": 5000.0, "num_module_steps_trained": 6000, "num_non_trainable_parameters": 0, "num_module_steps_trained_lifetime": 90000, "learner_connector_sum_episodes_length_out": 5250.0, "num_env_steps_trained_lifetime": 472500, "num_env_steps_trained": 31500, "num_env_steps_trained_lifetime_throughput": 1742839.489930872, "num_module_steps_trained_throughput": 332971.4576438051, "num_module_steps_trained_lifetime_throughput": 332534.11974586867}, "default_policy": {"vf_loss_unclipped": 28.692230224609375, "total_loss": 0.2012055665254593, "entropy": 0.5368001461029053, "num_trainable_parameters": 6003, "num_module_steps_trained_lifetime": 90000, "curr_kl_coeff": 2.2781259758630767e-05, "vf_explained_var": -0.012212872505187988, "weights_seq_no": 15.0, "policy_loss": 0.13732679188251495, "num_module_steps_trained": 6000, "curr_entropy_coeff": 0.0090570820258, "mean_kl_loss": 0.0006800030241720378, "module_train_batch_size_mean": 1000.0, "vf_loss": 0.10278083384037018, "gradients_default_optimizer_global_norm": 0.1371627002954483, "default_optimizer_learning_rate": 0.0002847858517, "diff_num_grad_updates_vs_sampler_policy": 1.0, "num_module_steps_trained_lifetime_throughput": 333367.10732461396}}, "num_training_step_calls_per_iteration": 1, "evaluation": {"env_runners": {"weights_seq_no": 15.0, "num_env_steps_sampled_lifetime": 75400, "module_to_env_connector": {"timers": {"connectors": {"remove_single_ts_time_rank_from_batch": 5.792556165856782e-07, "listify_data_for_vector_env": 1.1023005818889183e-05, "get_actions": 3.580077303521781e-05, "un_batch_to_individual_items": 5.312656642734512e-06, "tensor_to_numpy": 1.2908792789205079e-05, "normalize_and_clip_actions": 9.371621303540778e-06}}, "connector_pipeline_timer": 0.00010030992600557494}, "module_episode_returns_mean": {"default_policy": 0.85}, "episode_return_mean": 0.85, "rlmodule_inference_timer": 2.6856520882221133e-05, "episode_duration_sec_mean": 0.004540744120022282, "env_to_module_connector": {"timers": {"connectors": {"add_observations_from_episodes_to_batch": 2.784187998581567e-06, "add_time_dim_to_batch_and_zero_pad": 2.216520826602534e-06, "batch_individual_items": 6.025403669700557e-06, "add_states_from_episodes_to_batch": 1.5238891375416568e-06, "numpy_to_tensor": 8.203648482957065e-06}}, "connector_pipeline_timer": 4.202373276531973e-05}, "num_module_steps_sampled": {"default_policy": 400}, "episode_len_max": 20, "env_step_timer": 1.3794873488672679e-05, "sample": 0.12726233193694056, "agent_episode_returns_mean": {"default_agent": 0.85}, "env_reset_timer": 0.00032526200802462636, "env_to_module_sum_episodes_length_in": 10.368238394574323, "episode_len_mean": 20.0, "num_agent_steps_sampled": {"default_agent": 400}, "num_agent_steps_sampled_lifetime": {"default_agent": 6000}, "num_env_steps_sampled": 400, "num_module_steps_sampled_lifetime": {"default_policy": 6000}, "env_to_module_sum_episodes_length_out": 10.368238394574323, "num_episodes": 20, "episode_return_min": -14.5, "episode_len_min": 20, "episode_return_max": 13.5, "num_episodes_lifetime": 300, "time_between_sampling": 2.4000111915384705}, "num_healthy_workers": 1, "actor_manager_num_outstanding_async_reqs": 0, "num_remote_worker_restarts": 0}, "num_env_steps_sampled_lifetime": -8017500.0, "fault_tolerance": {"num_healthy_workers": 0, "num_remote_worker_restarts": 0}, "env_runner_group": {"actor_manager_num_outstanding_async_reqs": 0}, "done": false, "training_iteration": 15, "trial_id": "46920_00000", "date": "2025-08-11_19-35-53", "timestamp": 1754933753, "time_this_iter_s": 1.9597089290618896, "time_total_s": 33.67411422729492, "pid": 27748, "hostname": "Mac", "node_ip": "127.0.0.1", "config": {"exploration_config": {}, "extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "placement_strategy": "PACK", "num_gpus": 0, "_fake_gpus": false, "num_cpus_for_main_process": 2, "eager_tracing": true, "eager_max_retraces": 20, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "torch_compile_learner": false, "torch_compile_learner_what_to_compile": "forward_train", "torch_compile_learner_dynamo_backend": "aot_eager", "torch_compile_learner_dynamo_mode": null, "torch_compile_worker": false, "torch_compile_worker_dynamo_backend": "aot_eager", "torch_compile_worker_dynamo_mode": null, "torch_ddp_kwargs": {}, "torch_skip_nan_gradients": false, "env": "Umbrella", "env_config": {}, "observation_space": null, "action_space": null, "clip_rewards": null, "normalize_actions": true, "clip_actions": false, "_is_atari": null, "disable_env_checking": false, "render_env": false, "action_mask_key": "action_mask", "env_runner_cls": null, "num_env_runners": 0, "create_local_env_runner": true, "num_envs_per_env_runner": 1, "gym_env_vectorize_mode": "SYNC", "num_cpus_per_env_runner": 1, "num_gpus_per_env_runner": 0, "custom_resources_per_env_runner": {}, "validate_env_runners_after_construction": true, "episodes_to_numpy": true, "max_requests_in_flight_per_env_runner": 1, "sample_timeout_s": 60.0, "_env_to_module_connector": null, "add_default_connectors_to_env_to_module_pipeline": true, "_module_to_env_connector": null, "add_default_connectors_to_module_to_env_pipeline": true, "merge_env_runner_states": "training_only", "broadcast_env_runner_states": true, "episode_lookback_horizon": 1, "rollout_fragment_length": "auto", "batch_mode": "complete_episodes", "compress_observations": false, "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "enable_tf1_exec_eagerly": false, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "preprocessor_pref": "deepmind", "observation_filter": "NoFilter", "update_worker_filter_stats": true, "use_worker_filter_stats": true, "sampler_perf_stats_ema_coef": null, "_is_online": true, "num_learners": 0, "num_gpus_per_learner": 0, "num_cpus_per_learner": "auto", "num_aggregator_actors_per_learner": 0, "max_requests_in_flight_per_aggregator_actor": 3, "local_gpu_idx": 0, "max_requests_in_flight_per_learner": 3, "gamma": 1, "lr": 0.0002847858517, "grad_clip": 0.5, "grad_clip_by": "global_norm", "_train_batch_size_per_learner": 5000, "train_batch_size": 4000, "num_epochs": 1, "minibatch_size": 1000, "shuffle_batch_per_epoch": true, "model": {"fcnet_hiddens": [256, 256], "fcnet_activation": "tanh", "fcnet_weights_initializer": null, "fcnet_weights_initializer_config": null, "fcnet_bias_initializer": null, "fcnet_bias_initializer_config": null, "conv_filters": null, "conv_activation": "relu", "conv_kernel_initializer": null, "conv_kernel_initializer_config": null, "conv_bias_initializer": null, "conv_bias_initializer_config": null, "conv_transpose_kernel_initializer": null, "conv_transpose_kernel_initializer_config": null, "conv_transpose_bias_initializer": null, "conv_transpose_bias_initializer_config": null, "post_fcnet_hiddens": [], "post_fcnet_activation": "relu", "post_fcnet_weights_initializer": null, "post_fcnet_weights_initializer_config": null, "post_fcnet_bias_initializer": null, "post_fcnet_bias_initializer_config": null, "free_log_std": false, "log_std_clip_param": 20.0, "no_final_linear": false, "vf_share_layers": false, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "lstm_weights_initializer": null, "lstm_weights_initializer_config": null, "lstm_bias_initializer": null, "lstm_bias_initializer_config": null, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "attention_use_n_prev_actions": 0, "attention_use_n_prev_rewards": 0, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": null, "custom_model_config": {}, "custom_action_dist": null, "custom_preprocessor": null, "encoder_latent_dim": null, "always_check_shapes": false, "lstm_use_prev_action_reward": -1, "_use_default_native_models": -1, "_disable_preprocessor_api": false, "_disable_action_flattening": false}, "_learner_connector": null, "add_default_connectors_to_learner_pipeline": true, "learner_config_dict": {}, "optimizer": {}, "_learner_class": null, "callbacks_on_algorithm_init": null, "callbacks_on_env_runners_recreated": null, "callbacks_on_offline_eval_runners_recreated": null, "callbacks_on_checkpoint_loaded": null, "callbacks_on_environment_created": null, "callbacks_on_episode_created": null, "callbacks_on_episode_start": null, "callbacks_on_episode_step": null, "callbacks_on_episode_end": null, "callbacks_on_evaluate_start": null, "callbacks_on_evaluate_end": null, "callbacks_on_evaluate_offline_start": null, "callbacks_on_evaluate_offline_end": null, "callbacks_on_sample_end": null, "callbacks_on_train_result": null, "explore": true, "enable_rl_module_and_learner": true, "enable_env_runner_and_connector_v2": true, "_prior_exploration_config": {"type": "StochasticSampling"}, "count_steps_by": "env_steps", "policy_map_capacity": 100, "policy_mapping_fn": "<function AlgorithmConfig.DEFAULT_POLICY_MAPPING_FN at 0x3847e9b20>", "policies_to_train": null, "policy_states_are_swappable": false, "observation_fn": null, "offline_data_class": null, "input_read_method": "read_parquet", "input_read_method_kwargs": {}, "input_read_schema": {}, "input_read_episodes": false, "input_read_sample_batches": false, "input_read_batch_size": null, "input_filesystem": null, "input_filesystem_kwargs": {}, "input_compress_columns": ["obs", "new_obs"], "input_spaces_jsonable": true, "materialize_data": false, "materialize_mapped_data": true, "map_batches_kwargs": {}, "iter_batches_kwargs": {}, "ignore_final_observation": false, "prelearner_class": null, "prelearner_buffer_class": null, "prelearner_buffer_kwargs": {}, "prelearner_module_synch_period": 10, "dataset_num_iters_per_learner": null, "input_config": {}, "actions_in_input_normalized": false, "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_config": {}, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "output_max_rows_per_file": null, "output_write_remaining_data": false, "output_write_method": "write_parquet", "output_write_method_kwargs": {}, "output_filesystem": null, "output_filesystem_kwargs": {}, "output_write_episodes": true, "offline_sampling": false, "evaluation_interval": 1, "evaluation_duration": 20, "evaluation_duration_unit": "episodes", "evaluation_sample_timeout_s": 120.0, "evaluation_auto_duration_min_env_steps_per_sample": 100, "evaluation_auto_duration_max_env_steps_per_sample": 2000, "evaluation_parallel_to_training": false, "evaluation_force_reset_envs_before_iteration": true, "evaluation_config": null, "off_policy_estimation_methods": {}, "ope_split_batch_by_episode": true, "evaluation_num_env_runners": 1, "in_evaluation": false, "sync_filters_on_rollout_workers_timeout_s": 10.0, "offline_evaluation_interval": null, "num_offline_eval_runners": 0, "offline_loss_for_module_fn": null, "offline_evaluation_duration": 1, "offline_evaluation_parallel_to_training": false, "offline_evaluation_timeout_s": 120.0, "num_cpus_per_offline_eval_runner": 1, "num_gpus_per_offline_eval_runner": 0, "custom_resources_per_offline_eval_runner": {}, "restart_failed_offline_eval_runners": true, "ignore_offline_eval_runner_failures": false, "max_num_offline_eval_runner_restarts": 1000, "offline_eval_runner_restore_timeout_s": 1800.0, "max_requests_in_flight_per_offline_eval_runner": 1, "validate_offline_eval_runners_after_construction": true, "offline_eval_runner_health_probe_timeout_s": 30.0, "offline_eval_rl_module_inference_only": false, "broadcast_offline_eval_runner_states": false, "offline_eval_batch_size_per_runner": 256, "dataset_num_iters_per_eval_runner": 1, "keep_per_episode_custom_metrics": false, "metrics_episode_collection_timeout_s": 60.0, "metrics_num_episodes_for_smoothing": 100, "min_time_s_per_iteration": null, "min_train_timesteps_per_iteration": 0, "min_sample_timesteps_per_iteration": 0, "log_gradients": true, "export_native_model_files": false, "checkpoint_trainable_policies_only": false, "logger_creator": null, "logger_config": null, "log_level": "WARN", "log_sys_usage": true, "fake_sampler": false, "seed": 10, "restart_failed_env_runners": true, "ignore_env_runner_failures": false, "max_num_env_runner_restarts": 1000, "delay_between_env_runner_restarts_s": 60.0, "restart_failed_sub_environments": false, "num_consecutive_env_runner_failures_tolerance": 100, "env_runner_health_probe_timeout_s": 30.0, "env_runner_restore_timeout_s": 1800.0, "_model_config": {}, "_rl_module_spec": "RLModuleSpec(module_class=None, observation_space=None, action_space=None, inference_only=False, learner_only=False, model_config=DefaultModelConfig(fcnet_hiddens=[60, 90], fcnet_activation='tanh', fcnet_kernel_initializer=None, fcnet_kernel_initializer_kwargs=None, fcnet_bias_initializer=None, fcnet_bias_initializer_kwargs=None, conv_filters=None, conv_activation='relu', conv_kernel_initializer=None, conv_kernel_initializer_kwargs=None, conv_bias_initializer=None, conv_bias_initializer_kwargs=None, head_fcnet_hiddens=[], head_fcnet_activation='relu', head_fcnet_kernel_initializer=None, head_fcnet_kernel_initializer_kwargs=None, head_fcnet_bias_initializer=None, head_fcnet_bias_initializer_kwargs=None, free_log_std=False, log_std_clip_param=20.0, vf_share_layers=True, use_lstm=False, max_seq_len=20, lstm_cell_size=256, lstm_use_prev_action=False, lstm_use_prev_reward=False, lstm_kernel_initializer=None, lstm_kernel_initializer_kwargs=None, lstm_bias_initializer=None, lstm_bias_initializer_kwargs=None), catalog_class=None, load_state_path=None, model_config_dict=None)", "algorithm_config_overrides_per_module": {}, "_per_module_overrides": {}, "_validate_config": true, "_use_msgpack_checkpoints": false, "_torch_grad_scaler_class": null, "_torch_lr_scheduler_classes": null, "_tf_policy_handles_more_than_one_loss": false, "_disable_preprocessor_api": false, "_disable_action_flattening": false, "_disable_initialize_loss_from_dummy_batch": false, "_dont_auto_sync_env_runner_states": false, "env_task_fn": -1, "enable_connectors": -1, "simple_optimizer": false, "policy_map_cache": -1, "worker_cls": -1, "synchronize_filters": -1, "enable_async_evaluation": -1, "custom_async_evaluation_function": -1, "_enable_rl_module_api": -1, "auto_wrap_old_gym_envs": -1, "always_attach_evaluation_results": -1, "replay_sequence_length": null, "_disable_execution_plan_api": -1, "use_critic": true, "use_gae": true, "use_kl_loss": true, "kl_coeff": 0.7464963036515, "kl_target": 0.0270990929592, "vf_loss_coeff": 0.6688075857018, "entropy_coeff": 0.0090570820258, "clip_param": 0.1221781641624, "vf_clip_param": 0.1027808522125, "entropy_coeff_schedule": null, "lr_schedule": null, "sgd_minibatch_size": -1, "vf_share_layers": -1, "__stdout_file__": null, "__stderr_file__": null, "lambda": 0.9099046732075, "input": "sampler", "policies": {"default_policy": [null, null, null, null]}, "callbacks": "<class 'ray.rllib.callbacks.callbacks.RLlibCallback'>", "create_env_on_driver": false, "custom_eval_function": null, "framework": "torch"}, "time_since_restore": 33.67411422729492, "iterations_since_restore": 15, "perf": {"cpu_util_percent": 44.25, "ram_util_percent": 76.55000000000001}}
{"timers": {"training_iteration": 2.5750671179061406, "restore_env_runners": 1.3618139811480661e-05, "training_step": 2.574885550906037, "env_runner_sampling_timer": 2.4165568149506895, "learner_update_timer": 0.15516150864797723, "synch_weights": 0.0006058976551849057, "restore_eval_env_runners": 8.838714159097784e-06, "evaluation_iteration": 0.13429968167316503, "synch_eval_env_connectors": 0.00022501929632518127, "synch_env_connectors": 4.738312662969348e-06}, "env_runners": {"num_episodes": 250.0, "module_to_env_connector": {"timers": {"connectors": {"remove_single_ts_time_rank_from_batch": 6.062398997034205e-07, "listify_data_for_vector_env": 1.1347768863091051e-05, "get_actions": 4.124197337593152e-05, "tensor_to_numpy": 1.3684790835877348e-05, "un_batch_to_individual_items": 5.572577572284573e-06, "normalize_and_clip_actions": 9.670346331740444e-06}}, "connector_pipeline_timer": 0.00010851898663683004}, "episode_duration_sec_mean": 0.004712460505310447, "env_to_module_sum_episodes_length_in": 10.36823839457432, "episode_return_min": -10.5, "episode_len_max": 20, "episode_len_mean": 20.0, "env_step_timer": 1.4312406956291797e-05, "num_agent_steps_sampled": {"default_agent": 5000.0}, "module_episode_returns_mean": {"default_policy": 6.62}, "num_agent_steps_sampled_lifetime": {"default_agent": -8635000.0}, "agent_episode_returns_mean": {"default_agent": 6.62}, "weights_seq_no": 15.0, "env_to_module_connector": {"timers": {"connectors": {"add_observations_from_episodes_to_batch": 3.0449699338747645e-06, "numpy_to_tensor": 8.903630653696518e-06, "add_states_from_episodes_to_batch": 1.75305211473132e-06, "add_time_dim_to_batch_and_zero_pad": 2.3861114045287e-06, "batch_individual_items": 6.5481691304382005e-06}}, "connector_pipeline_timer": 4.517274333372509e-05}, "sample": 0.005494908618978315, "num_module_steps_sampled_lifetime": {"default_policy": -8635000.0}, "num_env_steps_sampled_lifetime": -8635000.0, "episode_len_min": 20, "episode_return_max": 9.5, "num_episodes_lifetime": -431750.0, "time_between_sampling": 0.0020144924365508962, "num_module_steps_sampled": {"default_policy": 5000.0}, "env_reset_timer": 3.8566390472472244e-05, "num_env_steps_sampled": 5000.0, "episode_return_mean": 6.62, "rlmodule_inference_timer": 2.8431304387995596e-05, "env_to_module_sum_episodes_length_out": 10.36823839457432, "num_env_steps_sampled_lifetime_throughput": 3616.7701850401736}, "learners": {"__all_modules__": {"num_trainable_parameters": 6003, "learner_connector": {"timers": {"connectors": {"add_time_dim_to_batch_and_zero_pad": 2.3908206835308696e-05, "batch_individual_items": 0.0409839437557223, "add_states_from_episodes_to_batch": 7.102842837842815e-06, "general_advantage_estimation": 0.007457506608487497, "add_columns_from_episodes_to_train_batch": 0.05721018566959508, "numpy_to_tensor": 7.659761266846232e-05, "add_one_ts_to_episodes_and_truncate": 0.013858135724862174, "add_observations_from_episodes_to_batch": 0.0018863365252197145}}, "connector_pipeline_timer": 0.12176684905495513}, "learner_connector_sum_episodes_length_in": 5000.0, "num_module_steps_trained": 6000, "num_non_trainable_parameters": 0, "num_module_steps_trained_lifetime": 96000, "learner_connector_sum_episodes_length_out": 5250.0, "num_env_steps_trained_lifetime": 504000, "num_env_steps_trained": 31500, "num_env_steps_trained_lifetime_throughput": 1768496.4715112185, "num_module_steps_trained_throughput": 337823.2368899889, "num_module_steps_trained_lifetime_throughput": 337397.03634703794}, "default_policy": {"vf_loss_unclipped": 28.64261817932129, "total_loss": 0.2740742564201355, "entropy": 0.4997800886631012, "num_trainable_parameters": 6003, "num_module_steps_trained_lifetime": 96000, "curr_kl_coeff": 1.1390629879315384e-05, "vf_explained_var": -0.011586427688598633, "weights_seq_no": 16.0, "policy_loss": 0.2098601907491684, "num_module_steps_trained": 6000, "curr_entropy_coeff": 0.0090570820258, "mean_kl_loss": 0.0011202433379366994, "module_train_batch_size_mean": 1000.0, "vf_loss": 0.10278083384037018, "gradients_default_optimizer_global_norm": 0.06061369180679321, "default_optimizer_learning_rate": 0.0002847858517, "diff_num_grad_updates_vs_sampler_policy": 1.0, "num_module_steps_trained_lifetime_throughput": 338160.76320962375}}, "num_training_step_calls_per_iteration": 1, "evaluation": {"env_runners": {"weights_seq_no": 16.0, "num_env_steps_sampled_lifetime": 80400, "module_to_env_connector": {"timers": {"connectors": {"remove_single_ts_time_rank_from_batch": 5.795992022256417e-07, "listify_data_for_vector_env": 1.0751000252707795e-05, "get_actions": 3.549490041623115e-05, "un_batch_to_individual_items": 5.272715034529556e-06, "tensor_to_numpy": 1.2772551928862042e-05, "normalize_and_clip_actions": 9.230014458266085e-06}}, "connector_pipeline_timer": 9.938880229995297e-05}, "module_episode_returns_mean": {"default_policy": 1.05}, "episode_return_mean": 1.05, "rlmodule_inference_timer": 2.6731174985464383e-05, "episode_duration_sec_mean": 0.004529956188052893, "env_to_module_connector": {"timers": {"connectors": {"add_observations_from_episodes_to_batch": 2.7761491467253725e-06, "add_time_dim_to_batch_and_zero_pad": 2.2214105058968435e-06, "batch_individual_items": 6.032228432868443e-06, "add_states_from_episodes_to_batch": 1.537317966429484e-06, "numpy_to_tensor": 8.153578950594552e-06}}, "connector_pipeline_timer": 4.213988387998009e-05}, "num_module_steps_sampled": {"default_policy": 400}, "episode_len_max": 20, "env_step_timer": 1.356299038218424e-05, "sample": 0.12694799986785218, "agent_episode_returns_mean": {"default_agent": 1.05}, "env_reset_timer": 0.00032277521798994605, "env_to_module_sum_episodes_length_in": 10.368238394574323, "episode_len_mean": 20.0, "num_agent_steps_sampled": {"default_agent": 400}, "num_agent_steps_sampled_lifetime": {"default_agent": 6400}, "num_env_steps_sampled": 400, "num_module_steps_sampled_lifetime": {"default_policy": 6400}, "env_to_module_sum_episodes_length_out": 10.368238394574323, "num_episodes": 20, "episode_return_min": -14.5, "episode_len_min": 20, "episode_return_max": 13.5, "num_episodes_lifetime": 320, "time_between_sampling": 2.3913212600326648}, "num_healthy_workers": 1, "actor_manager_num_outstanding_async_reqs": 0, "num_remote_worker_restarts": 0}, "num_env_steps_sampled_lifetime": -8635000.0, "fault_tolerance": {"num_healthy_workers": 0, "num_remote_worker_restarts": 0}, "env_runner_group": {"actor_manager_num_outstanding_async_reqs": 0}, "done": false, "training_iteration": 16, "trial_id": "46920_00000", "date": "2025-08-11_19-35-55", "timestamp": 1754933755, "time_this_iter_s": 1.6165001392364502, "time_total_s": 35.29061436653137, "pid": 27748, "hostname": "Mac", "node_ip": "127.0.0.1", "config": {"exploration_config": {}, "extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "placement_strategy": "PACK", "num_gpus": 0, "_fake_gpus": false, "num_cpus_for_main_process": 2, "eager_tracing": true, "eager_max_retraces": 20, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "torch_compile_learner": false, "torch_compile_learner_what_to_compile": "forward_train", "torch_compile_learner_dynamo_backend": "aot_eager", "torch_compile_learner_dynamo_mode": null, "torch_compile_worker": false, "torch_compile_worker_dynamo_backend": "aot_eager", "torch_compile_worker_dynamo_mode": null, "torch_ddp_kwargs": {}, "torch_skip_nan_gradients": false, "env": "Umbrella", "env_config": {}, "observation_space": null, "action_space": null, "clip_rewards": null, "normalize_actions": true, "clip_actions": false, "_is_atari": null, "disable_env_checking": false, "render_env": false, "action_mask_key": "action_mask", "env_runner_cls": null, "num_env_runners": 0, "create_local_env_runner": true, "num_envs_per_env_runner": 1, "gym_env_vectorize_mode": "SYNC", "num_cpus_per_env_runner": 1, "num_gpus_per_env_runner": 0, "custom_resources_per_env_runner": {}, "validate_env_runners_after_construction": true, "episodes_to_numpy": true, "max_requests_in_flight_per_env_runner": 1, "sample_timeout_s": 60.0, "_env_to_module_connector": null, "add_default_connectors_to_env_to_module_pipeline": true, "_module_to_env_connector": null, "add_default_connectors_to_module_to_env_pipeline": true, "merge_env_runner_states": "training_only", "broadcast_env_runner_states": true, "episode_lookback_horizon": 1, "rollout_fragment_length": "auto", "batch_mode": "complete_episodes", "compress_observations": false, "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "enable_tf1_exec_eagerly": false, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "preprocessor_pref": "deepmind", "observation_filter": "NoFilter", "update_worker_filter_stats": true, "use_worker_filter_stats": true, "sampler_perf_stats_ema_coef": null, "_is_online": true, "num_learners": 0, "num_gpus_per_learner": 0, "num_cpus_per_learner": "auto", "num_aggregator_actors_per_learner": 0, "max_requests_in_flight_per_aggregator_actor": 3, "local_gpu_idx": 0, "max_requests_in_flight_per_learner": 3, "gamma": 1, "lr": 0.0002847858517, "grad_clip": 0.5, "grad_clip_by": "global_norm", "_train_batch_size_per_learner": 5000, "train_batch_size": 4000, "num_epochs": 1, "minibatch_size": 1000, "shuffle_batch_per_epoch": true, "model": {"fcnet_hiddens": [256, 256], "fcnet_activation": "tanh", "fcnet_weights_initializer": null, "fcnet_weights_initializer_config": null, "fcnet_bias_initializer": null, "fcnet_bias_initializer_config": null, "conv_filters": null, "conv_activation": "relu", "conv_kernel_initializer": null, "conv_kernel_initializer_config": null, "conv_bias_initializer": null, "conv_bias_initializer_config": null, "conv_transpose_kernel_initializer": null, "conv_transpose_kernel_initializer_config": null, "conv_transpose_bias_initializer": null, "conv_transpose_bias_initializer_config": null, "post_fcnet_hiddens": [], "post_fcnet_activation": "relu", "post_fcnet_weights_initializer": null, "post_fcnet_weights_initializer_config": null, "post_fcnet_bias_initializer": null, "post_fcnet_bias_initializer_config": null, "free_log_std": false, "log_std_clip_param": 20.0, "no_final_linear": false, "vf_share_layers": false, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "lstm_weights_initializer": null, "lstm_weights_initializer_config": null, "lstm_bias_initializer": null, "lstm_bias_initializer_config": null, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "attention_use_n_prev_actions": 0, "attention_use_n_prev_rewards": 0, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": null, "custom_model_config": {}, "custom_action_dist": null, "custom_preprocessor": null, "encoder_latent_dim": null, "always_check_shapes": false, "lstm_use_prev_action_reward": -1, "_use_default_native_models": -1, "_disable_preprocessor_api": false, "_disable_action_flattening": false}, "_learner_connector": null, "add_default_connectors_to_learner_pipeline": true, "learner_config_dict": {}, "optimizer": {}, "_learner_class": null, "callbacks_on_algorithm_init": null, "callbacks_on_env_runners_recreated": null, "callbacks_on_offline_eval_runners_recreated": null, "callbacks_on_checkpoint_loaded": null, "callbacks_on_environment_created": null, "callbacks_on_episode_created": null, "callbacks_on_episode_start": null, "callbacks_on_episode_step": null, "callbacks_on_episode_end": null, "callbacks_on_evaluate_start": null, "callbacks_on_evaluate_end": null, "callbacks_on_evaluate_offline_start": null, "callbacks_on_evaluate_offline_end": null, "callbacks_on_sample_end": null, "callbacks_on_train_result": null, "explore": true, "enable_rl_module_and_learner": true, "enable_env_runner_and_connector_v2": true, "_prior_exploration_config": {"type": "StochasticSampling"}, "count_steps_by": "env_steps", "policy_map_capacity": 100, "policy_mapping_fn": "<function AlgorithmConfig.DEFAULT_POLICY_MAPPING_FN at 0x3847e9b20>", "policies_to_train": null, "policy_states_are_swappable": false, "observation_fn": null, "offline_data_class": null, "input_read_method": "read_parquet", "input_read_method_kwargs": {}, "input_read_schema": {}, "input_read_episodes": false, "input_read_sample_batches": false, "input_read_batch_size": null, "input_filesystem": null, "input_filesystem_kwargs": {}, "input_compress_columns": ["obs", "new_obs"], "input_spaces_jsonable": true, "materialize_data": false, "materialize_mapped_data": true, "map_batches_kwargs": {}, "iter_batches_kwargs": {}, "ignore_final_observation": false, "prelearner_class": null, "prelearner_buffer_class": null, "prelearner_buffer_kwargs": {}, "prelearner_module_synch_period": 10, "dataset_num_iters_per_learner": null, "input_config": {}, "actions_in_input_normalized": false, "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_config": {}, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "output_max_rows_per_file": null, "output_write_remaining_data": false, "output_write_method": "write_parquet", "output_write_method_kwargs": {}, "output_filesystem": null, "output_filesystem_kwargs": {}, "output_write_episodes": true, "offline_sampling": false, "evaluation_interval": 1, "evaluation_duration": 20, "evaluation_duration_unit": "episodes", "evaluation_sample_timeout_s": 120.0, "evaluation_auto_duration_min_env_steps_per_sample": 100, "evaluation_auto_duration_max_env_steps_per_sample": 2000, "evaluation_parallel_to_training": false, "evaluation_force_reset_envs_before_iteration": true, "evaluation_config": null, "off_policy_estimation_methods": {}, "ope_split_batch_by_episode": true, "evaluation_num_env_runners": 1, "in_evaluation": false, "sync_filters_on_rollout_workers_timeout_s": 10.0, "offline_evaluation_interval": null, "num_offline_eval_runners": 0, "offline_loss_for_module_fn": null, "offline_evaluation_duration": 1, "offline_evaluation_parallel_to_training": false, "offline_evaluation_timeout_s": 120.0, "num_cpus_per_offline_eval_runner": 1, "num_gpus_per_offline_eval_runner": 0, "custom_resources_per_offline_eval_runner": {}, "restart_failed_offline_eval_runners": true, "ignore_offline_eval_runner_failures": false, "max_num_offline_eval_runner_restarts": 1000, "offline_eval_runner_restore_timeout_s": 1800.0, "max_requests_in_flight_per_offline_eval_runner": 1, "validate_offline_eval_runners_after_construction": true, "offline_eval_runner_health_probe_timeout_s": 30.0, "offline_eval_rl_module_inference_only": false, "broadcast_offline_eval_runner_states": false, "offline_eval_batch_size_per_runner": 256, "dataset_num_iters_per_eval_runner": 1, "keep_per_episode_custom_metrics": false, "metrics_episode_collection_timeout_s": 60.0, "metrics_num_episodes_for_smoothing": 100, "min_time_s_per_iteration": null, "min_train_timesteps_per_iteration": 0, "min_sample_timesteps_per_iteration": 0, "log_gradients": true, "export_native_model_files": false, "checkpoint_trainable_policies_only": false, "logger_creator": null, "logger_config": null, "log_level": "WARN", "log_sys_usage": true, "fake_sampler": false, "seed": 10, "restart_failed_env_runners": true, "ignore_env_runner_failures": false, "max_num_env_runner_restarts": 1000, "delay_between_env_runner_restarts_s": 60.0, "restart_failed_sub_environments": false, "num_consecutive_env_runner_failures_tolerance": 100, "env_runner_health_probe_timeout_s": 30.0, "env_runner_restore_timeout_s": 1800.0, "_model_config": {}, "_rl_module_spec": "RLModuleSpec(module_class=None, observation_space=None, action_space=None, inference_only=False, learner_only=False, model_config=DefaultModelConfig(fcnet_hiddens=[60, 90], fcnet_activation='tanh', fcnet_kernel_initializer=None, fcnet_kernel_initializer_kwargs=None, fcnet_bias_initializer=None, fcnet_bias_initializer_kwargs=None, conv_filters=None, conv_activation='relu', conv_kernel_initializer=None, conv_kernel_initializer_kwargs=None, conv_bias_initializer=None, conv_bias_initializer_kwargs=None, head_fcnet_hiddens=[], head_fcnet_activation='relu', head_fcnet_kernel_initializer=None, head_fcnet_kernel_initializer_kwargs=None, head_fcnet_bias_initializer=None, head_fcnet_bias_initializer_kwargs=None, free_log_std=False, log_std_clip_param=20.0, vf_share_layers=True, use_lstm=False, max_seq_len=20, lstm_cell_size=256, lstm_use_prev_action=False, lstm_use_prev_reward=False, lstm_kernel_initializer=None, lstm_kernel_initializer_kwargs=None, lstm_bias_initializer=None, lstm_bias_initializer_kwargs=None), catalog_class=None, load_state_path=None, model_config_dict=None)", "algorithm_config_overrides_per_module": {}, "_per_module_overrides": {}, "_validate_config": true, "_use_msgpack_checkpoints": false, "_torch_grad_scaler_class": null, "_torch_lr_scheduler_classes": null, "_tf_policy_handles_more_than_one_loss": false, "_disable_preprocessor_api": false, "_disable_action_flattening": false, "_disable_initialize_loss_from_dummy_batch": false, "_dont_auto_sync_env_runner_states": false, "env_task_fn": -1, "enable_connectors": -1, "simple_optimizer": false, "policy_map_cache": -1, "worker_cls": -1, "synchronize_filters": -1, "enable_async_evaluation": -1, "custom_async_evaluation_function": -1, "_enable_rl_module_api": -1, "auto_wrap_old_gym_envs": -1, "always_attach_evaluation_results": -1, "replay_sequence_length": null, "_disable_execution_plan_api": -1, "use_critic": true, "use_gae": true, "use_kl_loss": true, "kl_coeff": 0.7464963036515, "kl_target": 0.0270990929592, "vf_loss_coeff": 0.6688075857018, "entropy_coeff": 0.0090570820258, "clip_param": 0.1221781641624, "vf_clip_param": 0.1027808522125, "entropy_coeff_schedule": null, "lr_schedule": null, "sgd_minibatch_size": -1, "vf_share_layers": -1, "__stdout_file__": null, "__stderr_file__": null, "lambda": 0.9099046732075, "input": "sampler", "policies": {"default_policy": [null, null, null, null]}, "callbacks": "<class 'ray.rllib.callbacks.callbacks.RLlibCallback'>", "create_env_on_driver": false, "custom_eval_function": null, "framework": "torch"}, "time_since_restore": 35.29061436653137, "iterations_since_restore": 16, "perf": {"cpu_util_percent": 43.333333333333336, "ram_util_percent": 76.23333333333333}}
{"timers": {"training_iteration": 2.5647839846468368, "restore_env_runners": 1.353987852843441e-05, "training_step": 2.56460219414754, "env_runner_sampling_timer": 2.4068558284611776, "learner_update_timer": 0.15457305522139012, "synch_weights": 0.0006061657582420931, "restore_eval_env_runners": 8.824487069970218e-06, "evaluation_iteration": 0.1339636623563617, "synch_eval_env_connectors": 0.00022431160288367667, "synch_env_connectors": 4.728839021739378e-06}, "env_runners": {"num_episodes": 250.0, "module_to_env_connector": {"timers": {"connectors": {"remove_single_ts_time_rank_from_batch": 5.815378833734575e-07, "listify_data_for_vector_env": 1.0820736354761225e-05, "get_actions": 3.825337189857443e-05, "tensor_to_numpy": 1.3142116762387874e-05, "un_batch_to_individual_items": 5.353690489831481e-06, "normalize_and_clip_actions": 9.344549753417117e-06}}, "connector_pipeline_timer": 0.00010307285848553363}, "episode_duration_sec_mean": 0.004866101993713526, "env_to_module_sum_episodes_length_in": 10.36823839457432, "episode_return_min": -10.5, "episode_len_max": 20, "episode_len_mean": 20.0, "env_step_timer": 1.3477757136573027e-05, "num_agent_steps_sampled": {"default_agent": 5000.0}, "module_episode_returns_mean": {"default_policy": 7.18}, "num_agent_steps_sampled_lifetime": {"default_agent": -9252500.0}, "agent_episode_returns_mean": {"default_agent": 7.18}, "weights_seq_no": 16.0, "env_to_module_connector": {"timers": {"connectors": {"add_observations_from_episodes_to_batch": 2.963101565453451e-06, "numpy_to_tensor": 8.46918043287174e-06, "add_states_from_episodes_to_batch": 1.720794024638791e-06, "add_time_dim_to_batch_and_zero_pad": 2.295499893491061e-06, "batch_individual_items": 6.290108058515989e-06}}, "connector_pipeline_timer": 4.358188410399152e-05}, "sample": 0.005127819881762314, "num_module_steps_sampled_lifetime": {"default_policy": -9252500.0}, "num_env_steps_sampled_lifetime": -9252500.0, "episode_len_min": 20, "episode_return_max": 9.5, "num_episodes_lifetime": -462625.0, "time_between_sampling": 0.0014966932090499903, "num_module_steps_sampled": {"default_policy": 5000.0}, "env_reset_timer": 3.150903148953263e-05, "num_env_steps_sampled": 5000.0, "episode_return_mean": 7.18, "rlmodule_inference_timer": 4.3593177200707654e-05, "env_to_module_sum_episodes_length_out": 10.36823839457432, "num_env_steps_sampled_lifetime_throughput": 3774.0979603334117}, "learners": {"__all_modules__": {"num_trainable_parameters": 6003, "learner_connector": {"timers": {"connectors": {"add_time_dim_to_batch_and_zero_pad": 2.3774125566477412e-05, "batch_individual_items": 0.04088933556829844, "add_states_from_episodes_to_batch": 7.062233733057765e-06, "general_advantage_estimation": 0.007441380292462674, "add_columns_from_episodes_to_train_batch": 0.05697871756262815, "numpy_to_tensor": 7.642871675758943e-05, "add_one_ts_to_episodes_and_truncate": 0.013795344367296009, "add_observations_from_episodes_to_batch": 0.0018777689997149312}}, "connector_pipeline_timer": 0.12135122931416165}, "learner_connector_sum_episodes_length_in": 5000.0, "num_module_steps_trained": 6000, "num_non_trainable_parameters": 0, "num_module_steps_trained_lifetime": 102000, "learner_connector_sum_episodes_length_out": 5250.0, "num_env_steps_trained_lifetime": 535500, "num_env_steps_trained": 31500, "num_env_steps_trained_lifetime_throughput": 1788407.5283570064, "num_module_steps_trained_throughput": 341578.91866523813, "num_module_steps_trained_lifetime_throughput": 341163.91816509946}, "default_policy": {"vf_loss_unclipped": 28.64337730407715, "total_loss": 0.14732712507247925, "entropy": 0.4579978883266449, "num_trainable_parameters": 6003, "num_module_steps_trained_lifetime": 102000, "curr_kl_coeff": 5.695314939657692e-06, "vf_explained_var": -0.01027071475982666, "weights_seq_no": 17.0, "policy_loss": 0.08273464441299438, "num_module_steps_trained": 6000, "curr_entropy_coeff": 0.0090570820258, "mean_kl_loss": 0.0014901324175298214, "module_train_batch_size_mean": 1000.0, "vf_loss": 0.10278083384037018, "gradients_default_optimizer_global_norm": 0.09873435646295547, "default_optimizer_learning_rate": 0.0002847858517, "diff_num_grad_updates_vs_sampler_policy": 1.0, "num_module_steps_trained_lifetime_throughput": 341858.9003890764}}, "num_training_step_calls_per_iteration": 1, "evaluation": {"env_runners": {"weights_seq_no": 17.0, "num_env_steps_sampled_lifetime": 85400, "module_to_env_connector": {"timers": {"connectors": {"remove_single_ts_time_rank_from_batch": 5.808916120464123e-07, "listify_data_for_vector_env": 1.1069855006143104e-05, "get_actions": 3.734593587129067e-05, "un_batch_to_individual_items": 5.392526548523846e-06, "tensor_to_numpy": 1.326880587965282e-05, "normalize_and_clip_actions": 9.471498701657845e-06}}, "connector_pipeline_timer": 0.00010278804584068359}, "module_episode_returns_mean": {"default_policy": 0.25}, "episode_return_mean": 0.25, "rlmodule_inference_timer": 2.7638731886474005e-05, "episode_duration_sec_mean": 0.004591059132944792, "env_to_module_connector": {"timers": {"connectors": {"add_observations_from_episodes_to_batch": 2.8761286065897553e-06, "add_time_dim_to_batch_and_zero_pad": 2.2732121474894146e-06, "batch_individual_items": 6.216827659744378e-06, "add_states_from_episodes_to_batch": 1.5782596536081371e-06, "numpy_to_tensor": 8.554893610594155e-06}}, "connector_pipeline_timer": 4.323094734262483e-05}, "num_module_steps_sampled": {"default_policy": 400}, "episode_len_max": 20, "env_step_timer": 1.397978250383158e-05, "sample": 0.12673730528861915, "agent_episode_returns_mean": {"default_agent": 0.25}, "env_reset_timer": 0.00032059205583618677, "env_to_module_sum_episodes_length_in": 10.368238394574323, "episode_len_mean": 20.0, "num_agent_steps_sampled": {"default_agent": 400}, "num_agent_steps_sampled_lifetime": {"default_agent": 6800}, "num_env_steps_sampled": 400, "num_module_steps_sampled_lifetime": {"default_policy": 6800}, "env_to_module_sum_episodes_length_out": 10.368238394574323, "num_episodes": 20, "episode_return_min": -14.5, "episode_len_min": 20, "episode_return_max": 13.5, "num_episodes_lifetime": 340, "time_between_sampling": 2.383043950763324}, "num_healthy_workers": 1, "actor_manager_num_outstanding_async_reqs": 0, "num_remote_worker_restarts": 0}, "num_env_steps_sampled_lifetime": -9252500.0, "fault_tolerance": {"num_healthy_workers": 0, "num_remote_worker_restarts": 0}, "env_runner_group": {"actor_manager_num_outstanding_async_reqs": 0}, "done": false, "training_iteration": 17, "trial_id": "46920_00000", "date": "2025-08-11_19-35-57", "timestamp": 1754933757, "time_this_iter_s": 1.6601967811584473, "time_total_s": 36.95081114768982, "pid": 27748, "hostname": "Mac", "node_ip": "127.0.0.1", "config": {"exploration_config": {}, "extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "placement_strategy": "PACK", "num_gpus": 0, "_fake_gpus": false, "num_cpus_for_main_process": 2, "eager_tracing": true, "eager_max_retraces": 20, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "torch_compile_learner": false, "torch_compile_learner_what_to_compile": "forward_train", "torch_compile_learner_dynamo_backend": "aot_eager", "torch_compile_learner_dynamo_mode": null, "torch_compile_worker": false, "torch_compile_worker_dynamo_backend": "aot_eager", "torch_compile_worker_dynamo_mode": null, "torch_ddp_kwargs": {}, "torch_skip_nan_gradients": false, "env": "Umbrella", "env_config": {}, "observation_space": null, "action_space": null, "clip_rewards": null, "normalize_actions": true, "clip_actions": false, "_is_atari": null, "disable_env_checking": false, "render_env": false, "action_mask_key": "action_mask", "env_runner_cls": null, "num_env_runners": 0, "create_local_env_runner": true, "num_envs_per_env_runner": 1, "gym_env_vectorize_mode": "SYNC", "num_cpus_per_env_runner": 1, "num_gpus_per_env_runner": 0, "custom_resources_per_env_runner": {}, "validate_env_runners_after_construction": true, "episodes_to_numpy": true, "max_requests_in_flight_per_env_runner": 1, "sample_timeout_s": 60.0, "_env_to_module_connector": null, "add_default_connectors_to_env_to_module_pipeline": true, "_module_to_env_connector": null, "add_default_connectors_to_module_to_env_pipeline": true, "merge_env_runner_states": "training_only", "broadcast_env_runner_states": true, "episode_lookback_horizon": 1, "rollout_fragment_length": "auto", "batch_mode": "complete_episodes", "compress_observations": false, "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "enable_tf1_exec_eagerly": false, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "preprocessor_pref": "deepmind", "observation_filter": "NoFilter", "update_worker_filter_stats": true, "use_worker_filter_stats": true, "sampler_perf_stats_ema_coef": null, "_is_online": true, "num_learners": 0, "num_gpus_per_learner": 0, "num_cpus_per_learner": "auto", "num_aggregator_actors_per_learner": 0, "max_requests_in_flight_per_aggregator_actor": 3, "local_gpu_idx": 0, "max_requests_in_flight_per_learner": 3, "gamma": 1, "lr": 0.0002847858517, "grad_clip": 0.5, "grad_clip_by": "global_norm", "_train_batch_size_per_learner": 5000, "train_batch_size": 4000, "num_epochs": 1, "minibatch_size": 1000, "shuffle_batch_per_epoch": true, "model": {"fcnet_hiddens": [256, 256], "fcnet_activation": "tanh", "fcnet_weights_initializer": null, "fcnet_weights_initializer_config": null, "fcnet_bias_initializer": null, "fcnet_bias_initializer_config": null, "conv_filters": null, "conv_activation": "relu", "conv_kernel_initializer": null, "conv_kernel_initializer_config": null, "conv_bias_initializer": null, "conv_bias_initializer_config": null, "conv_transpose_kernel_initializer": null, "conv_transpose_kernel_initializer_config": null, "conv_transpose_bias_initializer": null, "conv_transpose_bias_initializer_config": null, "post_fcnet_hiddens": [], "post_fcnet_activation": "relu", "post_fcnet_weights_initializer": null, "post_fcnet_weights_initializer_config": null, "post_fcnet_bias_initializer": null, "post_fcnet_bias_initializer_config": null, "free_log_std": false, "log_std_clip_param": 20.0, "no_final_linear": false, "vf_share_layers": false, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "lstm_weights_initializer": null, "lstm_weights_initializer_config": null, "lstm_bias_initializer": null, "lstm_bias_initializer_config": null, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "attention_use_n_prev_actions": 0, "attention_use_n_prev_rewards": 0, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": null, "custom_model_config": {}, "custom_action_dist": null, "custom_preprocessor": null, "encoder_latent_dim": null, "always_check_shapes": false, "lstm_use_prev_action_reward": -1, "_use_default_native_models": -1, "_disable_preprocessor_api": false, "_disable_action_flattening": false}, "_learner_connector": null, "add_default_connectors_to_learner_pipeline": true, "learner_config_dict": {}, "optimizer": {}, "_learner_class": null, "callbacks_on_algorithm_init": null, "callbacks_on_env_runners_recreated": null, "callbacks_on_offline_eval_runners_recreated": null, "callbacks_on_checkpoint_loaded": null, "callbacks_on_environment_created": null, "callbacks_on_episode_created": null, "callbacks_on_episode_start": null, "callbacks_on_episode_step": null, "callbacks_on_episode_end": null, "callbacks_on_evaluate_start": null, "callbacks_on_evaluate_end": null, "callbacks_on_evaluate_offline_start": null, "callbacks_on_evaluate_offline_end": null, "callbacks_on_sample_end": null, "callbacks_on_train_result": null, "explore": true, "enable_rl_module_and_learner": true, "enable_env_runner_and_connector_v2": true, "_prior_exploration_config": {"type": "StochasticSampling"}, "count_steps_by": "env_steps", "policy_map_capacity": 100, "policy_mapping_fn": "<function AlgorithmConfig.DEFAULT_POLICY_MAPPING_FN at 0x3847e9b20>", "policies_to_train": null, "policy_states_are_swappable": false, "observation_fn": null, "offline_data_class": null, "input_read_method": "read_parquet", "input_read_method_kwargs": {}, "input_read_schema": {}, "input_read_episodes": false, "input_read_sample_batches": false, "input_read_batch_size": null, "input_filesystem": null, "input_filesystem_kwargs": {}, "input_compress_columns": ["obs", "new_obs"], "input_spaces_jsonable": true, "materialize_data": false, "materialize_mapped_data": true, "map_batches_kwargs": {}, "iter_batches_kwargs": {}, "ignore_final_observation": false, "prelearner_class": null, "prelearner_buffer_class": null, "prelearner_buffer_kwargs": {}, "prelearner_module_synch_period": 10, "dataset_num_iters_per_learner": null, "input_config": {}, "actions_in_input_normalized": false, "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_config": {}, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "output_max_rows_per_file": null, "output_write_remaining_data": false, "output_write_method": "write_parquet", "output_write_method_kwargs": {}, "output_filesystem": null, "output_filesystem_kwargs": {}, "output_write_episodes": true, "offline_sampling": false, "evaluation_interval": 1, "evaluation_duration": 20, "evaluation_duration_unit": "episodes", "evaluation_sample_timeout_s": 120.0, "evaluation_auto_duration_min_env_steps_per_sample": 100, "evaluation_auto_duration_max_env_steps_per_sample": 2000, "evaluation_parallel_to_training": false, "evaluation_force_reset_envs_before_iteration": true, "evaluation_config": null, "off_policy_estimation_methods": {}, "ope_split_batch_by_episode": true, "evaluation_num_env_runners": 1, "in_evaluation": false, "sync_filters_on_rollout_workers_timeout_s": 10.0, "offline_evaluation_interval": null, "num_offline_eval_runners": 0, "offline_loss_for_module_fn": null, "offline_evaluation_duration": 1, "offline_evaluation_parallel_to_training": false, "offline_evaluation_timeout_s": 120.0, "num_cpus_per_offline_eval_runner": 1, "num_gpus_per_offline_eval_runner": 0, "custom_resources_per_offline_eval_runner": {}, "restart_failed_offline_eval_runners": true, "ignore_offline_eval_runner_failures": false, "max_num_offline_eval_runner_restarts": 1000, "offline_eval_runner_restore_timeout_s": 1800.0, "max_requests_in_flight_per_offline_eval_runner": 1, "validate_offline_eval_runners_after_construction": true, "offline_eval_runner_health_probe_timeout_s": 30.0, "offline_eval_rl_module_inference_only": false, "broadcast_offline_eval_runner_states": false, "offline_eval_batch_size_per_runner": 256, "dataset_num_iters_per_eval_runner": 1, "keep_per_episode_custom_metrics": false, "metrics_episode_collection_timeout_s": 60.0, "metrics_num_episodes_for_smoothing": 100, "min_time_s_per_iteration": null, "min_train_timesteps_per_iteration": 0, "min_sample_timesteps_per_iteration": 0, "log_gradients": true, "export_native_model_files": false, "checkpoint_trainable_policies_only": false, "logger_creator": null, "logger_config": null, "log_level": "WARN", "log_sys_usage": true, "fake_sampler": false, "seed": 10, "restart_failed_env_runners": true, "ignore_env_runner_failures": false, "max_num_env_runner_restarts": 1000, "delay_between_env_runner_restarts_s": 60.0, "restart_failed_sub_environments": false, "num_consecutive_env_runner_failures_tolerance": 100, "env_runner_health_probe_timeout_s": 30.0, "env_runner_restore_timeout_s": 1800.0, "_model_config": {}, "_rl_module_spec": "RLModuleSpec(module_class=None, observation_space=None, action_space=None, inference_only=False, learner_only=False, model_config=DefaultModelConfig(fcnet_hiddens=[60, 90], fcnet_activation='tanh', fcnet_kernel_initializer=None, fcnet_kernel_initializer_kwargs=None, fcnet_bias_initializer=None, fcnet_bias_initializer_kwargs=None, conv_filters=None, conv_activation='relu', conv_kernel_initializer=None, conv_kernel_initializer_kwargs=None, conv_bias_initializer=None, conv_bias_initializer_kwargs=None, head_fcnet_hiddens=[], head_fcnet_activation='relu', head_fcnet_kernel_initializer=None, head_fcnet_kernel_initializer_kwargs=None, head_fcnet_bias_initializer=None, head_fcnet_bias_initializer_kwargs=None, free_log_std=False, log_std_clip_param=20.0, vf_share_layers=True, use_lstm=False, max_seq_len=20, lstm_cell_size=256, lstm_use_prev_action=False, lstm_use_prev_reward=False, lstm_kernel_initializer=None, lstm_kernel_initializer_kwargs=None, lstm_bias_initializer=None, lstm_bias_initializer_kwargs=None), catalog_class=None, load_state_path=None, model_config_dict=None)", "algorithm_config_overrides_per_module": {}, "_per_module_overrides": {}, "_validate_config": true, "_use_msgpack_checkpoints": false, "_torch_grad_scaler_class": null, "_torch_lr_scheduler_classes": null, "_tf_policy_handles_more_than_one_loss": false, "_disable_preprocessor_api": false, "_disable_action_flattening": false, "_disable_initialize_loss_from_dummy_batch": false, "_dont_auto_sync_env_runner_states": false, "env_task_fn": -1, "enable_connectors": -1, "simple_optimizer": false, "policy_map_cache": -1, "worker_cls": -1, "synchronize_filters": -1, "enable_async_evaluation": -1, "custom_async_evaluation_function": -1, "_enable_rl_module_api": -1, "auto_wrap_old_gym_envs": -1, "always_attach_evaluation_results": -1, "replay_sequence_length": null, "_disable_execution_plan_api": -1, "use_critic": true, "use_gae": true, "use_kl_loss": true, "kl_coeff": 0.7464963036515, "kl_target": 0.0270990929592, "vf_loss_coeff": 0.6688075857018, "entropy_coeff": 0.0090570820258, "clip_param": 0.1221781641624, "vf_clip_param": 0.1027808522125, "entropy_coeff_schedule": null, "lr_schedule": null, "sgd_minibatch_size": -1, "vf_share_layers": -1, "__stdout_file__": null, "__stderr_file__": null, "lambda": 0.9099046732075, "input": "sampler", "policies": {"default_policy": [null, null, null, null]}, "callbacks": "<class 'ray.rllib.callbacks.callbacks.RLlibCallback'>", "create_env_on_driver": false, "custom_eval_function": null, "framework": "torch"}, "time_since_restore": 36.95081114768982, "iterations_since_restore": 17, "perf": {"cpu_util_percent": 36.35, "ram_util_percent": 74.9}}
{"timers": {"training_iteration": 2.558844396470604, "restore_env_runners": 1.3464480200019668e-05, "training_step": 2.558662547625693, "env_runner_sampling_timer": 2.400390284336979, "learner_update_timer": 0.1550834709192826, "synch_weights": 0.0006074020200243183, "restore_eval_env_runners": 8.811242770357519e-06, "evaluation_iteration": 0.13373233865276682, "synch_eval_env_connectors": 0.00022320390644337592, "synch_env_connectors": 4.72196071803455e-06}, "env_runners": {"num_episodes": 250.0, "module_to_env_connector": {"timers": {"connectors": {"remove_single_ts_time_rank_from_batch": 6.710347052314098e-07, "listify_data_for_vector_env": 1.3130160684044292e-05, "get_actions": 5.4079431570607534e-05, "tensor_to_numpy": 1.8334578910979627e-05, "un_batch_to_individual_items": 6.409454056364961e-06, "normalize_and_clip_actions": 1.2151750495341369e-05}}, "connector_pipeline_timer": 0.00013549412746144027}, "episode_duration_sec_mean": 0.005858423330821095, "env_to_module_sum_episodes_length_in": 10.36823839457432, "episode_return_min": -10.5, "episode_len_max": 20, "episode_len_mean": 20.0, "env_step_timer": 1.838368605504482e-05, "num_agent_steps_sampled": {"default_agent": 5000.0}, "module_episode_returns_mean": {"default_policy": 6.700000000000004}, "num_agent_steps_sampled_lifetime": {"default_agent": -9870000.0}, "agent_episode_returns_mean": {"default_agent": 6.700000000000004}, "weights_seq_no": 17.0, "env_to_module_connector": {"timers": {"connectors": {"add_observations_from_episodes_to_batch": 3.5060817151951865e-06, "numpy_to_tensor": 1.2664176842566169e-05, "add_states_from_episodes_to_batch": 2.0300202277876947e-06, "add_time_dim_to_batch_and_zero_pad": 2.812226719862116e-06, "batch_individual_items": 7.718565833107353e-06}}, "connector_pipeline_timer": 5.4961864119600525e-05}, "sample": 0.00585360413301011, "num_module_steps_sampled_lifetime": {"default_policy": -9870000.0}, "num_env_steps_sampled_lifetime": -9870000.0, "episode_len_min": 20, "episode_return_max": 9.5, "num_episodes_lifetime": -493500.0, "time_between_sampling": 0.0015831444624305276, "num_module_steps_sampled": {"default_policy": 5000.0}, "env_reset_timer": 4.4874118758166764e-05, "num_env_steps_sampled": 5000.0, "episode_return_mean": 6.700000000000004, "rlmodule_inference_timer": 3.64229407964326e-05, "env_to_module_sum_episodes_length_out": 10.36823839457432, "num_env_steps_sampled_lifetime_throughput": 3215.280663026915}, "learners": {"__all_modules__": {"num_trainable_parameters": 6003, "learner_connector": {"timers": {"connectors": {"add_time_dim_to_batch_and_zero_pad": 2.365513492399542e-05, "batch_individual_items": 0.04185793471308455, "add_states_from_episodes_to_batch": 7.027441703479082e-06, "general_advantage_estimation": 0.007425694410524759, "add_columns_from_episodes_to_train_batch": 0.05677874872682469, "numpy_to_tensor": 7.639984962521186e-05, "add_one_ts_to_episodes_and_truncate": 0.01374254425304202, "add_observations_from_episodes_to_batch": 0.0018722500591040775}}, "connector_pipeline_timer": 0.12204442493067671}, "learner_connector_sum_episodes_length_in": 5000.0, "num_module_steps_trained": 6000, "num_non_trainable_parameters": 0, "num_module_steps_trained_lifetime": 108000, "learner_connector_sum_episodes_length_out": 5250.0, "num_env_steps_trained_lifetime": 567000, "num_env_steps_trained": 31500, "num_env_steps_trained_lifetime_throughput": 1807904.7060121526, "num_module_steps_trained_throughput": 345260.70527032483, "num_module_steps_trained_lifetime_throughput": 344855.79089228803}, "default_policy": {"vf_loss_unclipped": 28.636436462402344, "total_loss": -0.04717446491122246, "entropy": 0.43784546852111816, "num_trainable_parameters": 6003, "num_module_steps_trained_lifetime": 108000, "curr_kl_coeff": 2.847657469828846e-06, "vf_explained_var": -0.008368968963623047, "weights_seq_no": 18.0, "policy_loss": -0.11194947361946106, "num_module_steps_trained": 6000, "curr_entropy_coeff": 0.0090570820258, "mean_kl_loss": 0.00018082500901073217, "module_train_batch_size_mean": 1000.0, "vf_loss": 0.10278083384037018, "gradients_default_optimizer_global_norm": 0.05914563685655594, "default_optimizer_learning_rate": 0.0002847858517, "diff_num_grad_updates_vs_sampler_policy": 1.0, "num_module_steps_trained_lifetime_throughput": 345485.6623781324}}, "num_training_step_calls_per_iteration": 1, "evaluation": {"env_runners": {"weights_seq_no": 18.0, "num_env_steps_sampled_lifetime": 90400, "module_to_env_connector": {"timers": {"connectors": {"remove_single_ts_time_rank_from_batch": 6.951712788443141e-07, "listify_data_for_vector_env": 1.3143286193131308e-05, "get_actions": 4.788595078544982e-05, "un_batch_to_individual_items": 6.349420185487949e-06, "tensor_to_numpy": 1.5898781987704492e-05, "normalize_and_clip_actions": 1.11405662395327e-05}}, "connector_pipeline_timer": 0.0001257610217821192}, "module_episode_returns_mean": {"default_policy": -0.75}, "episode_return_mean": -0.75, "rlmodule_inference_timer": 3.401973669794358e-05, "episode_duration_sec_mean": 0.004721670381259173, "env_to_module_connector": {"timers": {"connectors": {"add_observations_from_episodes_to_batch": 3.225052744287114e-06, "add_time_dim_to_batch_and_zero_pad": 3.5691043552863845e-06, "batch_individual_items": 7.869967067971882e-06, "add_states_from_episodes_to_batch": 1.822878486180799e-06, "numpy_to_tensor": 1.0833584154844498e-05}}, "connector_pipeline_timer": 5.370371803484814e-05}, "num_module_steps_sampled": {"default_policy": 400}, "episode_len_max": 20, "env_step_timer": 1.6851820917879564e-05, "sample": 0.12665383264627522, "agent_episode_returns_mean": {"default_agent": -0.75}, "env_reset_timer": 0.00031829279526651136, "env_to_module_sum_episodes_length_in": 10.368238394574323, "episode_len_mean": 20.0, "num_agent_steps_sampled": {"default_agent": 400}, "num_agent_steps_sampled_lifetime": {"default_agent": 7200}, "num_env_steps_sampled": 400, "num_module_steps_sampled_lifetime": {"default_policy": 7200}, "env_to_module_sum_episodes_length_out": 10.368238394574323, "num_episodes": 20, "episode_return_min": -14.5, "episode_len_min": 20, "episode_return_max": 13.5, "num_episodes_lifetime": 360, "time_between_sampling": 2.379094615415558}, "num_healthy_workers": 1, "actor_manager_num_outstanding_async_reqs": 0, "num_remote_worker_restarts": 0}, "num_env_steps_sampled_lifetime": -9870000.0, "fault_tolerance": {"num_healthy_workers": 0, "num_remote_worker_restarts": 0}, "env_runner_group": {"actor_manager_num_outstanding_async_reqs": 0}, "done": false, "training_iteration": 18, "trial_id": "46920_00000", "date": "2025-08-11_19-35-59", "timestamp": 1754933759, "time_this_iter_s": 2.0977189540863037, "time_total_s": 39.04853010177612, "pid": 27748, "hostname": "Mac", "node_ip": "127.0.0.1", "config": {"exploration_config": {}, "extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "placement_strategy": "PACK", "num_gpus": 0, "_fake_gpus": false, "num_cpus_for_main_process": 2, "eager_tracing": true, "eager_max_retraces": 20, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "torch_compile_learner": false, "torch_compile_learner_what_to_compile": "forward_train", "torch_compile_learner_dynamo_backend": "aot_eager", "torch_compile_learner_dynamo_mode": null, "torch_compile_worker": false, "torch_compile_worker_dynamo_backend": "aot_eager", "torch_compile_worker_dynamo_mode": null, "torch_ddp_kwargs": {}, "torch_skip_nan_gradients": false, "env": "Umbrella", "env_config": {}, "observation_space": null, "action_space": null, "clip_rewards": null, "normalize_actions": true, "clip_actions": false, "_is_atari": null, "disable_env_checking": false, "render_env": false, "action_mask_key": "action_mask", "env_runner_cls": null, "num_env_runners": 0, "create_local_env_runner": true, "num_envs_per_env_runner": 1, "gym_env_vectorize_mode": "SYNC", "num_cpus_per_env_runner": 1, "num_gpus_per_env_runner": 0, "custom_resources_per_env_runner": {}, "validate_env_runners_after_construction": true, "episodes_to_numpy": true, "max_requests_in_flight_per_env_runner": 1, "sample_timeout_s": 60.0, "_env_to_module_connector": null, "add_default_connectors_to_env_to_module_pipeline": true, "_module_to_env_connector": null, "add_default_connectors_to_module_to_env_pipeline": true, "merge_env_runner_states": "training_only", "broadcast_env_runner_states": true, "episode_lookback_horizon": 1, "rollout_fragment_length": "auto", "batch_mode": "complete_episodes", "compress_observations": false, "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "enable_tf1_exec_eagerly": false, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "preprocessor_pref": "deepmind", "observation_filter": "NoFilter", "update_worker_filter_stats": true, "use_worker_filter_stats": true, "sampler_perf_stats_ema_coef": null, "_is_online": true, "num_learners": 0, "num_gpus_per_learner": 0, "num_cpus_per_learner": "auto", "num_aggregator_actors_per_learner": 0, "max_requests_in_flight_per_aggregator_actor": 3, "local_gpu_idx": 0, "max_requests_in_flight_per_learner": 3, "gamma": 1, "lr": 0.0002847858517, "grad_clip": 0.5, "grad_clip_by": "global_norm", "_train_batch_size_per_learner": 5000, "train_batch_size": 4000, "num_epochs": 1, "minibatch_size": 1000, "shuffle_batch_per_epoch": true, "model": {"fcnet_hiddens": [256, 256], "fcnet_activation": "tanh", "fcnet_weights_initializer": null, "fcnet_weights_initializer_config": null, "fcnet_bias_initializer": null, "fcnet_bias_initializer_config": null, "conv_filters": null, "conv_activation": "relu", "conv_kernel_initializer": null, "conv_kernel_initializer_config": null, "conv_bias_initializer": null, "conv_bias_initializer_config": null, "conv_transpose_kernel_initializer": null, "conv_transpose_kernel_initializer_config": null, "conv_transpose_bias_initializer": null, "conv_transpose_bias_initializer_config": null, "post_fcnet_hiddens": [], "post_fcnet_activation": "relu", "post_fcnet_weights_initializer": null, "post_fcnet_weights_initializer_config": null, "post_fcnet_bias_initializer": null, "post_fcnet_bias_initializer_config": null, "free_log_std": false, "log_std_clip_param": 20.0, "no_final_linear": false, "vf_share_layers": false, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "lstm_weights_initializer": null, "lstm_weights_initializer_config": null, "lstm_bias_initializer": null, "lstm_bias_initializer_config": null, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "attention_use_n_prev_actions": 0, "attention_use_n_prev_rewards": 0, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": null, "custom_model_config": {}, "custom_action_dist": null, "custom_preprocessor": null, "encoder_latent_dim": null, "always_check_shapes": false, "lstm_use_prev_action_reward": -1, "_use_default_native_models": -1, "_disable_preprocessor_api": false, "_disable_action_flattening": false}, "_learner_connector": null, "add_default_connectors_to_learner_pipeline": true, "learner_config_dict": {}, "optimizer": {}, "_learner_class": null, "callbacks_on_algorithm_init": null, "callbacks_on_env_runners_recreated": null, "callbacks_on_offline_eval_runners_recreated": null, "callbacks_on_checkpoint_loaded": null, "callbacks_on_environment_created": null, "callbacks_on_episode_created": null, "callbacks_on_episode_start": null, "callbacks_on_episode_step": null, "callbacks_on_episode_end": null, "callbacks_on_evaluate_start": null, "callbacks_on_evaluate_end": null, "callbacks_on_evaluate_offline_start": null, "callbacks_on_evaluate_offline_end": null, "callbacks_on_sample_end": null, "callbacks_on_train_result": null, "explore": true, "enable_rl_module_and_learner": true, "enable_env_runner_and_connector_v2": true, "_prior_exploration_config": {"type": "StochasticSampling"}, "count_steps_by": "env_steps", "policy_map_capacity": 100, "policy_mapping_fn": "<function AlgorithmConfig.DEFAULT_POLICY_MAPPING_FN at 0x3847e9b20>", "policies_to_train": null, "policy_states_are_swappable": false, "observation_fn": null, "offline_data_class": null, "input_read_method": "read_parquet", "input_read_method_kwargs": {}, "input_read_schema": {}, "input_read_episodes": false, "input_read_sample_batches": false, "input_read_batch_size": null, "input_filesystem": null, "input_filesystem_kwargs": {}, "input_compress_columns": ["obs", "new_obs"], "input_spaces_jsonable": true, "materialize_data": false, "materialize_mapped_data": true, "map_batches_kwargs": {}, "iter_batches_kwargs": {}, "ignore_final_observation": false, "prelearner_class": null, "prelearner_buffer_class": null, "prelearner_buffer_kwargs": {}, "prelearner_module_synch_period": 10, "dataset_num_iters_per_learner": null, "input_config": {}, "actions_in_input_normalized": false, "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_config": {}, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "output_max_rows_per_file": null, "output_write_remaining_data": false, "output_write_method": "write_parquet", "output_write_method_kwargs": {}, "output_filesystem": null, "output_filesystem_kwargs": {}, "output_write_episodes": true, "offline_sampling": false, "evaluation_interval": 1, "evaluation_duration": 20, "evaluation_duration_unit": "episodes", "evaluation_sample_timeout_s": 120.0, "evaluation_auto_duration_min_env_steps_per_sample": 100, "evaluation_auto_duration_max_env_steps_per_sample": 2000, "evaluation_parallel_to_training": false, "evaluation_force_reset_envs_before_iteration": true, "evaluation_config": null, "off_policy_estimation_methods": {}, "ope_split_batch_by_episode": true, "evaluation_num_env_runners": 1, "in_evaluation": false, "sync_filters_on_rollout_workers_timeout_s": 10.0, "offline_evaluation_interval": null, "num_offline_eval_runners": 0, "offline_loss_for_module_fn": null, "offline_evaluation_duration": 1, "offline_evaluation_parallel_to_training": false, "offline_evaluation_timeout_s": 120.0, "num_cpus_per_offline_eval_runner": 1, "num_gpus_per_offline_eval_runner": 0, "custom_resources_per_offline_eval_runner": {}, "restart_failed_offline_eval_runners": true, "ignore_offline_eval_runner_failures": false, "max_num_offline_eval_runner_restarts": 1000, "offline_eval_runner_restore_timeout_s": 1800.0, "max_requests_in_flight_per_offline_eval_runner": 1, "validate_offline_eval_runners_after_construction": true, "offline_eval_runner_health_probe_timeout_s": 30.0, "offline_eval_rl_module_inference_only": false, "broadcast_offline_eval_runner_states": false, "offline_eval_batch_size_per_runner": 256, "dataset_num_iters_per_eval_runner": 1, "keep_per_episode_custom_metrics": false, "metrics_episode_collection_timeout_s": 60.0, "metrics_num_episodes_for_smoothing": 100, "min_time_s_per_iteration": null, "min_train_timesteps_per_iteration": 0, "min_sample_timesteps_per_iteration": 0, "log_gradients": true, "export_native_model_files": false, "checkpoint_trainable_policies_only": false, "logger_creator": null, "logger_config": null, "log_level": "WARN", "log_sys_usage": true, "fake_sampler": false, "seed": 10, "restart_failed_env_runners": true, "ignore_env_runner_failures": false, "max_num_env_runner_restarts": 1000, "delay_between_env_runner_restarts_s": 60.0, "restart_failed_sub_environments": false, "num_consecutive_env_runner_failures_tolerance": 100, "env_runner_health_probe_timeout_s": 30.0, "env_runner_restore_timeout_s": 1800.0, "_model_config": {}, "_rl_module_spec": "RLModuleSpec(module_class=None, observation_space=None, action_space=None, inference_only=False, learner_only=False, model_config=DefaultModelConfig(fcnet_hiddens=[60, 90], fcnet_activation='tanh', fcnet_kernel_initializer=None, fcnet_kernel_initializer_kwargs=None, fcnet_bias_initializer=None, fcnet_bias_initializer_kwargs=None, conv_filters=None, conv_activation='relu', conv_kernel_initializer=None, conv_kernel_initializer_kwargs=None, conv_bias_initializer=None, conv_bias_initializer_kwargs=None, head_fcnet_hiddens=[], head_fcnet_activation='relu', head_fcnet_kernel_initializer=None, head_fcnet_kernel_initializer_kwargs=None, head_fcnet_bias_initializer=None, head_fcnet_bias_initializer_kwargs=None, free_log_std=False, log_std_clip_param=20.0, vf_share_layers=True, use_lstm=False, max_seq_len=20, lstm_cell_size=256, lstm_use_prev_action=False, lstm_use_prev_reward=False, lstm_kernel_initializer=None, lstm_kernel_initializer_kwargs=None, lstm_bias_initializer=None, lstm_bias_initializer_kwargs=None), catalog_class=None, load_state_path=None, model_config_dict=None)", "algorithm_config_overrides_per_module": {}, "_per_module_overrides": {}, "_validate_config": true, "_use_msgpack_checkpoints": false, "_torch_grad_scaler_class": null, "_torch_lr_scheduler_classes": null, "_tf_policy_handles_more_than_one_loss": false, "_disable_preprocessor_api": false, "_disable_action_flattening": false, "_disable_initialize_loss_from_dummy_batch": false, "_dont_auto_sync_env_runner_states": false, "env_task_fn": -1, "enable_connectors": -1, "simple_optimizer": false, "policy_map_cache": -1, "worker_cls": -1, "synchronize_filters": -1, "enable_async_evaluation": -1, "custom_async_evaluation_function": -1, "_enable_rl_module_api": -1, "auto_wrap_old_gym_envs": -1, "always_attach_evaluation_results": -1, "replay_sequence_length": null, "_disable_execution_plan_api": -1, "use_critic": true, "use_gae": true, "use_kl_loss": true, "kl_coeff": 0.7464963036515, "kl_target": 0.0270990929592, "vf_loss_coeff": 0.6688075857018, "entropy_coeff": 0.0090570820258, "clip_param": 0.1221781641624, "vf_clip_param": 0.1027808522125, "entropy_coeff_schedule": null, "lr_schedule": null, "sgd_minibatch_size": -1, "vf_share_layers": -1, "__stdout_file__": null, "__stderr_file__": null, "lambda": 0.9099046732075, "input": "sampler", "policies": {"default_policy": [null, null, null, null]}, "callbacks": "<class 'ray.rllib.callbacks.callbacks.RLlibCallback'>", "create_env_on_driver": false, "custom_eval_function": null, "framework": "torch"}, "time_since_restore": 39.04853010177612, "iterations_since_restore": 18, "perf": {"cpu_util_percent": 51.666666666666664, "ram_util_percent": 77.33333333333333}}
{"timers": {"training_iteration": 2.5520813654258756, "restore_env_runners": 1.3391084991292276e-05, "training_step": 2.5518993708996263, "env_runner_sampling_timer": 2.393114667324077, "learner_update_timer": 0.1555921682904011, "synch_weights": 0.0006079900796556604, "restore_eval_env_runners": 8.826049636221482e-06, "evaluation_iteration": 0.13363496026534538, "synch_eval_env_connectors": 0.00022210311697065037, "synch_env_connectors": 4.7159905518371425e-06}, "env_runners": {"num_episodes": 250.0, "module_to_env_connector": {"timers": {"connectors": {"remove_single_ts_time_rank_from_batch": 6.936865622053424e-07, "listify_data_for_vector_env": 1.3355537183768018e-05, "get_actions": 4.930467964230455e-05, "tensor_to_numpy": 1.6295717254544392e-05, "un_batch_to_individual_items": 6.323588153601374e-06, "normalize_and_clip_actions": 1.1053283061880634e-05}}, "connector_pipeline_timer": 0.00012992033759121402}, "episode_duration_sec_mean": 0.005562612685840576, "env_to_module_sum_episodes_length_in": 10.36823839457432, "episode_return_min": -10.5, "episode_len_max": 20, "episode_len_mean": 20.0, "env_step_timer": 1.6956908531292023e-05, "num_agent_steps_sampled": {"default_agent": 5000.0}, "module_episode_returns_mean": {"default_policy": 7.659999999999997}, "num_agent_steps_sampled_lifetime": {"default_agent": -10487500.0}, "agent_episode_returns_mean": {"default_agent": 7.659999999999997}, "weights_seq_no": 18.0, "env_to_module_connector": {"timers": {"connectors": {"add_observations_from_episodes_to_batch": 3.5706173499653405e-06, "numpy_to_tensor": 1.0756851483673915e-05, "add_states_from_episodes_to_batch": 1.9910043932273778e-06, "add_time_dim_to_batch_and_zero_pad": 2.783118478355383e-06, "batch_individual_items": 7.664715540819741e-06}}, "connector_pipeline_timer": 5.155237656933777e-05}, "sample": 0.006019178135543646, "num_module_steps_sampled_lifetime": {"default_policy": -10487500.0}, "num_env_steps_sampled_lifetime": -10487500.0, "episode_len_min": 20, "episode_return_max": 9.5, "num_episodes_lifetime": -524375.0, "time_between_sampling": 0.0021091339804680423, "num_module_steps_sampled": {"default_policy": 5000.0}, "env_reset_timer": 5.117446249890906e-05, "num_env_steps_sampled": 5000.0, "episode_return_mean": 7.659999999999997, "rlmodule_inference_timer": 3.388535842849692e-05, "env_to_module_sum_episodes_length_out": 10.36823839457432, "num_env_steps_sampled_lifetime_throughput": 3225.464213728175}, "learners": {"__all_modules__": {"num_trainable_parameters": 6003, "learner_connector": {"timers": {"connectors": {"add_time_dim_to_batch_and_zero_pad": 2.3525674029304063e-05, "batch_individual_items": 0.042809928696158635, "add_states_from_episodes_to_batch": 6.992586648110136e-06, "general_advantage_estimation": 0.007416826215773099, "add_columns_from_episodes_to_train_batch": 0.05655691623934976, "numpy_to_tensor": 7.628710055817075e-05, "add_one_ts_to_episodes_and_truncate": 0.013683099220353585, "add_observations_from_episodes_to_batch": 0.0018618121384755288}}, "connector_pipeline_timer": 0.1226940731818368}, "learner_connector_sum_episodes_length_in": 5000.0, "num_module_steps_trained": 6000, "num_non_trainable_parameters": 0, "num_module_steps_trained_lifetime": 114000, "learner_connector_sum_episodes_length_out": 5250.0, "num_env_steps_trained_lifetime": 598500, "num_env_steps_trained": 31500, "num_env_steps_trained_lifetime_throughput": 1821747.1970522364, "num_module_steps_trained_throughput": 347867.5034255617, "num_module_steps_trained_lifetime_throughput": 347472.63078632526}, "default_policy": {"vf_loss_unclipped": 28.636056900024414, "total_loss": 0.16122514009475708, "entropy": 0.44391682744026184, "num_trainable_parameters": 6003, "num_module_steps_trained_lifetime": 114000, "curr_kl_coeff": 1.423828734914423e-06, "vf_explained_var": -0.009635567665100098, "weights_seq_no": 19.0, "policy_loss": 0.09650514274835587, "num_module_steps_trained": 6000, "curr_entropy_coeff": 0.0090570820258, "mean_kl_loss": 1.3710978237213567e-05, "module_train_batch_size_mean": 1000.0, "vf_loss": 0.10278083384037018, "gradients_default_optimizer_global_norm": 0.0536673404276371, "default_optimizer_learning_rate": 0.0002847858517, "diff_num_grad_updates_vs_sampler_policy": 1.0, "num_module_steps_trained_lifetime_throughput": 348043.48362672486}}, "num_training_step_calls_per_iteration": 1, "evaluation": {"env_runners": {"weights_seq_no": 19.0, "num_env_steps_sampled_lifetime": 95400, "module_to_env_connector": {"timers": {"connectors": {"remove_single_ts_time_rank_from_batch": 6.037352401755015e-07, "listify_data_for_vector_env": 1.1809562522793139e-05, "get_actions": 4.078156635869652e-05, "un_batch_to_individual_items": 5.747772497234621e-06, "tensor_to_numpy": 1.4382236823673497e-05, "normalize_and_clip_actions": 1.00061817474251e-05}}, "connector_pipeline_timer": 0.00011002745238644643}, "module_episode_returns_mean": {"default_policy": -0.95}, "episode_return_mean": -0.95, "rlmodule_inference_timer": 2.99676658418379e-05, "episode_duration_sec_mean": 0.004865776268998161, "env_to_module_connector": {"timers": {"connectors": {"add_observations_from_episodes_to_batch": 2.949371388800643e-06, "add_time_dim_to_batch_and_zero_pad": 2.385188219991151e-06, "batch_individual_items": 6.5723194370077705e-06, "add_states_from_episodes_to_batch": 1.6308904245331637e-06, "numpy_to_tensor": 9.167337306503374e-06}}, "connector_pipeline_timer": 4.5723693040643614e-05}, "num_module_steps_sampled": {"default_policy": 400}, "episode_len_max": 20, "env_step_timer": 1.513217857811284e-05, "sample": 0.12653300890874145, "agent_episode_returns_mean": {"default_agent": -0.95}, "env_reset_timer": 0.00031598819646981287, "env_to_module_sum_episodes_length_in": 10.368238394574323, "episode_len_mean": 20.0, "num_agent_steps_sampled": {"default_agent": 400}, "num_agent_steps_sampled_lifetime": {"default_agent": 7600}, "num_env_steps_sampled": 400, "num_module_steps_sampled_lifetime": {"default_policy": 7600}, "env_to_module_sum_episodes_length_out": 10.368238394574323, "num_episodes": 20, "episode_return_min": -14.5, "episode_len_min": 20, "episode_return_max": 13.5, "num_episodes_lifetime": 380, "time_between_sampling": 2.374361771342001}, "num_healthy_workers": 1, "actor_manager_num_outstanding_async_reqs": 0, "num_remote_worker_restarts": 0}, "num_env_steps_sampled_lifetime": -10487500.0, "fault_tolerance": {"num_healthy_workers": 0, "num_remote_worker_restarts": 0}, "env_runner_group": {"actor_manager_num_outstanding_async_reqs": 0}, "done": false, "training_iteration": 19, "trial_id": "46920_00000", "date": "2025-08-11_19-36-01", "timestamp": 1754933761, "time_this_iter_s": 2.005247116088867, "time_total_s": 41.05377721786499, "pid": 27748, "hostname": "Mac", "node_ip": "127.0.0.1", "config": {"exploration_config": {}, "extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "placement_strategy": "PACK", "num_gpus": 0, "_fake_gpus": false, "num_cpus_for_main_process": 2, "eager_tracing": true, "eager_max_retraces": 20, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "torch_compile_learner": false, "torch_compile_learner_what_to_compile": "forward_train", "torch_compile_learner_dynamo_backend": "aot_eager", "torch_compile_learner_dynamo_mode": null, "torch_compile_worker": false, "torch_compile_worker_dynamo_backend": "aot_eager", "torch_compile_worker_dynamo_mode": null, "torch_ddp_kwargs": {}, "torch_skip_nan_gradients": false, "env": "Umbrella", "env_config": {}, "observation_space": null, "action_space": null, "clip_rewards": null, "normalize_actions": true, "clip_actions": false, "_is_atari": null, "disable_env_checking": false, "render_env": false, "action_mask_key": "action_mask", "env_runner_cls": null, "num_env_runners": 0, "create_local_env_runner": true, "num_envs_per_env_runner": 1, "gym_env_vectorize_mode": "SYNC", "num_cpus_per_env_runner": 1, "num_gpus_per_env_runner": 0, "custom_resources_per_env_runner": {}, "validate_env_runners_after_construction": true, "episodes_to_numpy": true, "max_requests_in_flight_per_env_runner": 1, "sample_timeout_s": 60.0, "_env_to_module_connector": null, "add_default_connectors_to_env_to_module_pipeline": true, "_module_to_env_connector": null, "add_default_connectors_to_module_to_env_pipeline": true, "merge_env_runner_states": "training_only", "broadcast_env_runner_states": true, "episode_lookback_horizon": 1, "rollout_fragment_length": "auto", "batch_mode": "complete_episodes", "compress_observations": false, "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "enable_tf1_exec_eagerly": false, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "preprocessor_pref": "deepmind", "observation_filter": "NoFilter", "update_worker_filter_stats": true, "use_worker_filter_stats": true, "sampler_perf_stats_ema_coef": null, "_is_online": true, "num_learners": 0, "num_gpus_per_learner": 0, "num_cpus_per_learner": "auto", "num_aggregator_actors_per_learner": 0, "max_requests_in_flight_per_aggregator_actor": 3, "local_gpu_idx": 0, "max_requests_in_flight_per_learner": 3, "gamma": 1, "lr": 0.0002847858517, "grad_clip": 0.5, "grad_clip_by": "global_norm", "_train_batch_size_per_learner": 5000, "train_batch_size": 4000, "num_epochs": 1, "minibatch_size": 1000, "shuffle_batch_per_epoch": true, "model": {"fcnet_hiddens": [256, 256], "fcnet_activation": "tanh", "fcnet_weights_initializer": null, "fcnet_weights_initializer_config": null, "fcnet_bias_initializer": null, "fcnet_bias_initializer_config": null, "conv_filters": null, "conv_activation": "relu", "conv_kernel_initializer": null, "conv_kernel_initializer_config": null, "conv_bias_initializer": null, "conv_bias_initializer_config": null, "conv_transpose_kernel_initializer": null, "conv_transpose_kernel_initializer_config": null, "conv_transpose_bias_initializer": null, "conv_transpose_bias_initializer_config": null, "post_fcnet_hiddens": [], "post_fcnet_activation": "relu", "post_fcnet_weights_initializer": null, "post_fcnet_weights_initializer_config": null, "post_fcnet_bias_initializer": null, "post_fcnet_bias_initializer_config": null, "free_log_std": false, "log_std_clip_param": 20.0, "no_final_linear": false, "vf_share_layers": false, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "lstm_weights_initializer": null, "lstm_weights_initializer_config": null, "lstm_bias_initializer": null, "lstm_bias_initializer_config": null, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "attention_use_n_prev_actions": 0, "attention_use_n_prev_rewards": 0, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": null, "custom_model_config": {}, "custom_action_dist": null, "custom_preprocessor": null, "encoder_latent_dim": null, "always_check_shapes": false, "lstm_use_prev_action_reward": -1, "_use_default_native_models": -1, "_disable_preprocessor_api": false, "_disable_action_flattening": false}, "_learner_connector": null, "add_default_connectors_to_learner_pipeline": true, "learner_config_dict": {}, "optimizer": {}, "_learner_class": null, "callbacks_on_algorithm_init": null, "callbacks_on_env_runners_recreated": null, "callbacks_on_offline_eval_runners_recreated": null, "callbacks_on_checkpoint_loaded": null, "callbacks_on_environment_created": null, "callbacks_on_episode_created": null, "callbacks_on_episode_start": null, "callbacks_on_episode_step": null, "callbacks_on_episode_end": null, "callbacks_on_evaluate_start": null, "callbacks_on_evaluate_end": null, "callbacks_on_evaluate_offline_start": null, "callbacks_on_evaluate_offline_end": null, "callbacks_on_sample_end": null, "callbacks_on_train_result": null, "explore": true, "enable_rl_module_and_learner": true, "enable_env_runner_and_connector_v2": true, "_prior_exploration_config": {"type": "StochasticSampling"}, "count_steps_by": "env_steps", "policy_map_capacity": 100, "policy_mapping_fn": "<function AlgorithmConfig.DEFAULT_POLICY_MAPPING_FN at 0x3847e9b20>", "policies_to_train": null, "policy_states_are_swappable": false, "observation_fn": null, "offline_data_class": null, "input_read_method": "read_parquet", "input_read_method_kwargs": {}, "input_read_schema": {}, "input_read_episodes": false, "input_read_sample_batches": false, "input_read_batch_size": null, "input_filesystem": null, "input_filesystem_kwargs": {}, "input_compress_columns": ["obs", "new_obs"], "input_spaces_jsonable": true, "materialize_data": false, "materialize_mapped_data": true, "map_batches_kwargs": {}, "iter_batches_kwargs": {}, "ignore_final_observation": false, "prelearner_class": null, "prelearner_buffer_class": null, "prelearner_buffer_kwargs": {}, "prelearner_module_synch_period": 10, "dataset_num_iters_per_learner": null, "input_config": {}, "actions_in_input_normalized": false, "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_config": {}, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "output_max_rows_per_file": null, "output_write_remaining_data": false, "output_write_method": "write_parquet", "output_write_method_kwargs": {}, "output_filesystem": null, "output_filesystem_kwargs": {}, "output_write_episodes": true, "offline_sampling": false, "evaluation_interval": 1, "evaluation_duration": 20, "evaluation_duration_unit": "episodes", "evaluation_sample_timeout_s": 120.0, "evaluation_auto_duration_min_env_steps_per_sample": 100, "evaluation_auto_duration_max_env_steps_per_sample": 2000, "evaluation_parallel_to_training": false, "evaluation_force_reset_envs_before_iteration": true, "evaluation_config": null, "off_policy_estimation_methods": {}, "ope_split_batch_by_episode": true, "evaluation_num_env_runners": 1, "in_evaluation": false, "sync_filters_on_rollout_workers_timeout_s": 10.0, "offline_evaluation_interval": null, "num_offline_eval_runners": 0, "offline_loss_for_module_fn": null, "offline_evaluation_duration": 1, "offline_evaluation_parallel_to_training": false, "offline_evaluation_timeout_s": 120.0, "num_cpus_per_offline_eval_runner": 1, "num_gpus_per_offline_eval_runner": 0, "custom_resources_per_offline_eval_runner": {}, "restart_failed_offline_eval_runners": true, "ignore_offline_eval_runner_failures": false, "max_num_offline_eval_runner_restarts": 1000, "offline_eval_runner_restore_timeout_s": 1800.0, "max_requests_in_flight_per_offline_eval_runner": 1, "validate_offline_eval_runners_after_construction": true, "offline_eval_runner_health_probe_timeout_s": 30.0, "offline_eval_rl_module_inference_only": false, "broadcast_offline_eval_runner_states": false, "offline_eval_batch_size_per_runner": 256, "dataset_num_iters_per_eval_runner": 1, "keep_per_episode_custom_metrics": false, "metrics_episode_collection_timeout_s": 60.0, "metrics_num_episodes_for_smoothing": 100, "min_time_s_per_iteration": null, "min_train_timesteps_per_iteration": 0, "min_sample_timesteps_per_iteration": 0, "log_gradients": true, "export_native_model_files": false, "checkpoint_trainable_policies_only": false, "logger_creator": null, "logger_config": null, "log_level": "WARN", "log_sys_usage": true, "fake_sampler": false, "seed": 10, "restart_failed_env_runners": true, "ignore_env_runner_failures": false, "max_num_env_runner_restarts": 1000, "delay_between_env_runner_restarts_s": 60.0, "restart_failed_sub_environments": false, "num_consecutive_env_runner_failures_tolerance": 100, "env_runner_health_probe_timeout_s": 30.0, "env_runner_restore_timeout_s": 1800.0, "_model_config": {}, "_rl_module_spec": "RLModuleSpec(module_class=None, observation_space=None, action_space=None, inference_only=False, learner_only=False, model_config=DefaultModelConfig(fcnet_hiddens=[60, 90], fcnet_activation='tanh', fcnet_kernel_initializer=None, fcnet_kernel_initializer_kwargs=None, fcnet_bias_initializer=None, fcnet_bias_initializer_kwargs=None, conv_filters=None, conv_activation='relu', conv_kernel_initializer=None, conv_kernel_initializer_kwargs=None, conv_bias_initializer=None, conv_bias_initializer_kwargs=None, head_fcnet_hiddens=[], head_fcnet_activation='relu', head_fcnet_kernel_initializer=None, head_fcnet_kernel_initializer_kwargs=None, head_fcnet_bias_initializer=None, head_fcnet_bias_initializer_kwargs=None, free_log_std=False, log_std_clip_param=20.0, vf_share_layers=True, use_lstm=False, max_seq_len=20, lstm_cell_size=256, lstm_use_prev_action=False, lstm_use_prev_reward=False, lstm_kernel_initializer=None, lstm_kernel_initializer_kwargs=None, lstm_bias_initializer=None, lstm_bias_initializer_kwargs=None), catalog_class=None, load_state_path=None, model_config_dict=None)", "algorithm_config_overrides_per_module": {}, "_per_module_overrides": {}, "_validate_config": true, "_use_msgpack_checkpoints": false, "_torch_grad_scaler_class": null, "_torch_lr_scheduler_classes": null, "_tf_policy_handles_more_than_one_loss": false, "_disable_preprocessor_api": false, "_disable_action_flattening": false, "_disable_initialize_loss_from_dummy_batch": false, "_dont_auto_sync_env_runner_states": false, "env_task_fn": -1, "enable_connectors": -1, "simple_optimizer": false, "policy_map_cache": -1, "worker_cls": -1, "synchronize_filters": -1, "enable_async_evaluation": -1, "custom_async_evaluation_function": -1, "_enable_rl_module_api": -1, "auto_wrap_old_gym_envs": -1, "always_attach_evaluation_results": -1, "replay_sequence_length": null, "_disable_execution_plan_api": -1, "use_critic": true, "use_gae": true, "use_kl_loss": true, "kl_coeff": 0.7464963036515, "kl_target": 0.0270990929592, "vf_loss_coeff": 0.6688075857018, "entropy_coeff": 0.0090570820258, "clip_param": 0.1221781641624, "vf_clip_param": 0.1027808522125, "entropy_coeff_schedule": null, "lr_schedule": null, "sgd_minibatch_size": -1, "vf_share_layers": -1, "__stdout_file__": null, "__stderr_file__": null, "lambda": 0.9099046732075, "input": "sampler", "policies": {"default_policy": [null, null, null, null]}, "callbacks": "<class 'ray.rllib.callbacks.callbacks.RLlibCallback'>", "create_env_on_driver": false, "custom_eval_function": null, "framework": "torch"}, "time_since_restore": 41.05377721786499, "iterations_since_restore": 19, "perf": {"cpu_util_percent": 45.9, "ram_util_percent": 76.7}}
{"timers": {"training_iteration": 2.5445668455208206, "restore_env_runners": 1.3308833440440055e-05, "training_step": 2.544384784280532, "env_runner_sampling_timer": 2.3862223402404883, "learner_update_timer": 0.15496264827851927, "synch_weights": 0.0006082822599749457, "restore_eval_env_runners": 8.803209894113133e-06, "evaluation_iteration": 0.13349792650376885, "synch_eval_env_connectors": 0.00022104416566233147, "synch_env_connectors": 4.7105003466135045e-06}, "env_runners": {"num_episodes": 250.0, "module_to_env_connector": {"timers": {"connectors": {"remove_single_ts_time_rank_from_batch": 6.823429166910664e-07, "listify_data_for_vector_env": 1.3097487583871876e-05, "get_actions": 5.0502381391725275e-05, "tensor_to_numpy": 1.5714304037066762e-05, "un_batch_to_individual_items": 6.564926049603102e-06, "normalize_and_clip_actions": 1.1239663413474623e-05}}, "connector_pipeline_timer": 0.00012744813212621693}, "episode_duration_sec_mean": 0.0056226329901255655, "env_to_module_sum_episodes_length_in": 10.36823839457432, "episode_return_min": -10.5, "episode_len_max": 20, "episode_len_mean": 20.0, "env_step_timer": 1.6870929375552316e-05, "num_agent_steps_sampled": {"default_agent": 5000.0}, "module_episode_returns_mean": {"default_policy": 6.2200000000000015}, "num_agent_steps_sampled_lifetime": {"default_agent": -11105000.0}, "agent_episode_returns_mean": {"default_agent": 6.2200000000000015}, "weights_seq_no": 19.0, "env_to_module_connector": {"timers": {"connectors": {"add_observations_from_episodes_to_batch": 5.282195535397793e-06, "numpy_to_tensor": 1.0933471330723095e-05, "add_states_from_episodes_to_batch": 1.9237999260133455e-06, "add_time_dim_to_batch_and_zero_pad": 2.8975932493623586e-06, "batch_individual_items": 8.103282413238672e-06}}, "connector_pipeline_timer": 5.575795243720325e-05}, "sample": 0.005898356921458691, "num_module_steps_sampled_lifetime": {"default_policy": -11105000.0}, "num_env_steps_sampled_lifetime": -11105000.0, "episode_len_min": 20, "episode_return_max": 9.5, "num_episodes_lifetime": -555250.0, "time_between_sampling": 0.002117743219495406, "num_module_steps_sampled": {"default_policy": 5000.0}, "env_reset_timer": 4.891058577652299e-05, "num_env_steps_sampled": 5000.0, "episode_return_mean": 6.2200000000000015, "rlmodule_inference_timer": 3.3349651870588184e-05, "env_to_module_sum_episodes_length_out": 10.36823839457432, "num_env_steps_sampled_lifetime_throughput": 3229.9790646660867}, "learners": {"__all_modules__": {"num_trainable_parameters": 6003, "learner_connector": {"timers": {"connectors": {"add_time_dim_to_batch_and_zero_pad": 2.3409586997352383e-05, "batch_individual_items": 0.042696058989305126, "add_states_from_episodes_to_batch": 6.9539101464670385e-06, "general_advantage_estimation": 0.007395026283686117, "add_columns_from_episodes_to_train_batch": 0.05633253790659652, "numpy_to_tensor": 7.60879788976085e-05, "add_one_ts_to_episodes_and_truncate": 0.013620907818607132, "add_observations_from_episodes_to_batch": 0.0018512548479688673}}, "connector_pipeline_timer": 0.12225933453108405}, "learner_connector_sum_episodes_length_in": 5000.0, "num_module_steps_trained": 6000, "num_non_trainable_parameters": 0, "num_module_steps_trained_lifetime": 120000, "learner_connector_sum_episodes_length_out": 5250.0, "num_env_steps_trained_lifetime": 630000, "num_env_steps_trained": 31500, "num_env_steps_trained_lifetime_throughput": 1837381.472406435, "num_module_steps_trained_throughput": 350815.969385881, "num_module_steps_trained_lifetime_throughput": 350431.22933091805}, "default_policy": {"vf_loss_unclipped": 28.659807205200195, "total_loss": 0.2269459366798401, "entropy": 0.4487060010433197, "num_trainable_parameters": 6003, "num_module_steps_trained_lifetime": 120000, "curr_kl_coeff": 7.119143674572115e-07, "vf_explained_var": -0.01161646842956543, "weights_seq_no": 20.0, "policy_loss": 0.16226932406425476, "num_module_steps_trained": 6000, "curr_entropy_coeff": 0.0090570820258, "mean_kl_loss": 2.8233316697878763e-05, "module_train_batch_size_mean": 1000.0, "vf_loss": 0.10278083384037018, "gradients_default_optimizer_global_norm": 0.05579276755452156, "default_optimizer_learning_rate": 0.0002847858517, "diff_num_grad_updates_vs_sampler_policy": 1.0, "num_module_steps_trained_lifetime_throughput": 350944.8120896319}}, "num_training_step_calls_per_iteration": 1, "evaluation": {"env_runners": {"weights_seq_no": 20.0, "num_env_steps_sampled_lifetime": 100400, "module_to_env_connector": {"timers": {"connectors": {"remove_single_ts_time_rank_from_batch": 6.007321996905313e-07, "listify_data_for_vector_env": 1.1283832074533295e-05, "get_actions": 3.917280452360979e-05, "un_batch_to_individual_items": 5.542575844272751e-06, "tensor_to_numpy": 1.4120858251972572e-05, "normalize_and_clip_actions": 9.790724839047109e-06}}, "connector_pipeline_timer": 0.00010682834297004025}, "module_episode_returns_mean": {"default_policy": -0.55}, "episode_return_mean": -0.55, "rlmodule_inference_timer": 2.8743770202309224e-05, "episode_duration_sec_mean": 0.004965187113266438, "env_to_module_connector": {"timers": {"connectors": {"add_observations_from_episodes_to_batch": 2.8400993894184317e-06, "add_time_dim_to_batch_and_zero_pad": 2.318897055961128e-06, "batch_individual_items": 6.456913574428279e-06, "add_states_from_episodes_to_batch": 1.5762912115692367e-06, "numpy_to_tensor": 8.87825093693523e-06}}, "connector_pipeline_timer": 4.437541245107973e-05}, "num_module_steps_sampled": {"default_policy": 400}, "episode_len_max": 20, "env_step_timer": 1.4798278660722016e-05, "sample": 0.12634096090012367, "agent_episode_returns_mean": {"default_agent": -0.55}, "env_reset_timer": 0.0003135154035553034, "env_to_module_sum_episodes_length_in": 10.368238394574323, "episode_len_mean": 20.0, "num_agent_steps_sampled": {"default_agent": 400}, "num_agent_steps_sampled_lifetime": {"default_agent": 8000}, "num_env_steps_sampled": 400, "num_module_steps_sampled_lifetime": {"default_policy": 8000}, "env_to_module_sum_episodes_length_out": 10.368238394574323, "num_episodes": 20, "episode_return_min": -14.5, "episode_len_min": 20, "episode_return_max": 13.5, "num_episodes_lifetime": 400, "time_between_sampling": 2.3688018407087443}, "num_healthy_workers": 1, "actor_manager_num_outstanding_async_reqs": 0, "num_remote_worker_restarts": 0}, "num_env_steps_sampled_lifetime": -11105000.0, "fault_tolerance": {"num_healthy_workers": 0, "num_remote_worker_restarts": 0}, "env_runner_group": {"actor_manager_num_outstanding_async_reqs": 0}, "done": true, "training_iteration": 20, "trial_id": "46920_00000", "date": "2025-08-11_19-36-03", "timestamp": 1754933763, "time_this_iter_s": 1.9155981540679932, "time_total_s": 42.96937537193298, "pid": 27748, "hostname": "Mac", "node_ip": "127.0.0.1", "config": {"exploration_config": {}, "extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "placement_strategy": "PACK", "num_gpus": 0, "_fake_gpus": false, "num_cpus_for_main_process": 2, "eager_tracing": true, "eager_max_retraces": 20, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "torch_compile_learner": false, "torch_compile_learner_what_to_compile": "forward_train", "torch_compile_learner_dynamo_backend": "aot_eager", "torch_compile_learner_dynamo_mode": null, "torch_compile_worker": false, "torch_compile_worker_dynamo_backend": "aot_eager", "torch_compile_worker_dynamo_mode": null, "torch_ddp_kwargs": {}, "torch_skip_nan_gradients": false, "env": "Umbrella", "env_config": {}, "observation_space": null, "action_space": null, "clip_rewards": null, "normalize_actions": true, "clip_actions": false, "_is_atari": null, "disable_env_checking": false, "render_env": false, "action_mask_key": "action_mask", "env_runner_cls": null, "num_env_runners": 0, "create_local_env_runner": true, "num_envs_per_env_runner": 1, "gym_env_vectorize_mode": "SYNC", "num_cpus_per_env_runner": 1, "num_gpus_per_env_runner": 0, "custom_resources_per_env_runner": {}, "validate_env_runners_after_construction": true, "episodes_to_numpy": true, "max_requests_in_flight_per_env_runner": 1, "sample_timeout_s": 60.0, "_env_to_module_connector": null, "add_default_connectors_to_env_to_module_pipeline": true, "_module_to_env_connector": null, "add_default_connectors_to_module_to_env_pipeline": true, "merge_env_runner_states": "training_only", "broadcast_env_runner_states": true, "episode_lookback_horizon": 1, "rollout_fragment_length": "auto", "batch_mode": "complete_episodes", "compress_observations": false, "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "enable_tf1_exec_eagerly": false, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "preprocessor_pref": "deepmind", "observation_filter": "NoFilter", "update_worker_filter_stats": true, "use_worker_filter_stats": true, "sampler_perf_stats_ema_coef": null, "_is_online": true, "num_learners": 0, "num_gpus_per_learner": 0, "num_cpus_per_learner": "auto", "num_aggregator_actors_per_learner": 0, "max_requests_in_flight_per_aggregator_actor": 3, "local_gpu_idx": 0, "max_requests_in_flight_per_learner": 3, "gamma": 1, "lr": 0.0002847858517, "grad_clip": 0.5, "grad_clip_by": "global_norm", "_train_batch_size_per_learner": 5000, "train_batch_size": 4000, "num_epochs": 1, "minibatch_size": 1000, "shuffle_batch_per_epoch": true, "model": {"fcnet_hiddens": [256, 256], "fcnet_activation": "tanh", "fcnet_weights_initializer": null, "fcnet_weights_initializer_config": null, "fcnet_bias_initializer": null, "fcnet_bias_initializer_config": null, "conv_filters": null, "conv_activation": "relu", "conv_kernel_initializer": null, "conv_kernel_initializer_config": null, "conv_bias_initializer": null, "conv_bias_initializer_config": null, "conv_transpose_kernel_initializer": null, "conv_transpose_kernel_initializer_config": null, "conv_transpose_bias_initializer": null, "conv_transpose_bias_initializer_config": null, "post_fcnet_hiddens": [], "post_fcnet_activation": "relu", "post_fcnet_weights_initializer": null, "post_fcnet_weights_initializer_config": null, "post_fcnet_bias_initializer": null, "post_fcnet_bias_initializer_config": null, "free_log_std": false, "log_std_clip_param": 20.0, "no_final_linear": false, "vf_share_layers": false, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "lstm_weights_initializer": null, "lstm_weights_initializer_config": null, "lstm_bias_initializer": null, "lstm_bias_initializer_config": null, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "attention_use_n_prev_actions": 0, "attention_use_n_prev_rewards": 0, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": null, "custom_model_config": {}, "custom_action_dist": null, "custom_preprocessor": null, "encoder_latent_dim": null, "always_check_shapes": false, "lstm_use_prev_action_reward": -1, "_use_default_native_models": -1, "_disable_preprocessor_api": false, "_disable_action_flattening": false}, "_learner_connector": null, "add_default_connectors_to_learner_pipeline": true, "learner_config_dict": {}, "optimizer": {}, "_learner_class": null, "callbacks_on_algorithm_init": null, "callbacks_on_env_runners_recreated": null, "callbacks_on_offline_eval_runners_recreated": null, "callbacks_on_checkpoint_loaded": null, "callbacks_on_environment_created": null, "callbacks_on_episode_created": null, "callbacks_on_episode_start": null, "callbacks_on_episode_step": null, "callbacks_on_episode_end": null, "callbacks_on_evaluate_start": null, "callbacks_on_evaluate_end": null, "callbacks_on_evaluate_offline_start": null, "callbacks_on_evaluate_offline_end": null, "callbacks_on_sample_end": null, "callbacks_on_train_result": null, "explore": true, "enable_rl_module_and_learner": true, "enable_env_runner_and_connector_v2": true, "_prior_exploration_config": {"type": "StochasticSampling"}, "count_steps_by": "env_steps", "policy_map_capacity": 100, "policy_mapping_fn": "<function AlgorithmConfig.DEFAULT_POLICY_MAPPING_FN at 0x3847e9b20>", "policies_to_train": null, "policy_states_are_swappable": false, "observation_fn": null, "offline_data_class": null, "input_read_method": "read_parquet", "input_read_method_kwargs": {}, "input_read_schema": {}, "input_read_episodes": false, "input_read_sample_batches": false, "input_read_batch_size": null, "input_filesystem": null, "input_filesystem_kwargs": {}, "input_compress_columns": ["obs", "new_obs"], "input_spaces_jsonable": true, "materialize_data": false, "materialize_mapped_data": true, "map_batches_kwargs": {}, "iter_batches_kwargs": {}, "ignore_final_observation": false, "prelearner_class": null, "prelearner_buffer_class": null, "prelearner_buffer_kwargs": {}, "prelearner_module_synch_period": 10, "dataset_num_iters_per_learner": null, "input_config": {}, "actions_in_input_normalized": false, "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_config": {}, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "output_max_rows_per_file": null, "output_write_remaining_data": false, "output_write_method": "write_parquet", "output_write_method_kwargs": {}, "output_filesystem": null, "output_filesystem_kwargs": {}, "output_write_episodes": true, "offline_sampling": false, "evaluation_interval": 1, "evaluation_duration": 20, "evaluation_duration_unit": "episodes", "evaluation_sample_timeout_s": 120.0, "evaluation_auto_duration_min_env_steps_per_sample": 100, "evaluation_auto_duration_max_env_steps_per_sample": 2000, "evaluation_parallel_to_training": false, "evaluation_force_reset_envs_before_iteration": true, "evaluation_config": null, "off_policy_estimation_methods": {}, "ope_split_batch_by_episode": true, "evaluation_num_env_runners": 1, "in_evaluation": false, "sync_filters_on_rollout_workers_timeout_s": 10.0, "offline_evaluation_interval": null, "num_offline_eval_runners": 0, "offline_loss_for_module_fn": null, "offline_evaluation_duration": 1, "offline_evaluation_parallel_to_training": false, "offline_evaluation_timeout_s": 120.0, "num_cpus_per_offline_eval_runner": 1, "num_gpus_per_offline_eval_runner": 0, "custom_resources_per_offline_eval_runner": {}, "restart_failed_offline_eval_runners": true, "ignore_offline_eval_runner_failures": false, "max_num_offline_eval_runner_restarts": 1000, "offline_eval_runner_restore_timeout_s": 1800.0, "max_requests_in_flight_per_offline_eval_runner": 1, "validate_offline_eval_runners_after_construction": true, "offline_eval_runner_health_probe_timeout_s": 30.0, "offline_eval_rl_module_inference_only": false, "broadcast_offline_eval_runner_states": false, "offline_eval_batch_size_per_runner": 256, "dataset_num_iters_per_eval_runner": 1, "keep_per_episode_custom_metrics": false, "metrics_episode_collection_timeout_s": 60.0, "metrics_num_episodes_for_smoothing": 100, "min_time_s_per_iteration": null, "min_train_timesteps_per_iteration": 0, "min_sample_timesteps_per_iteration": 0, "log_gradients": true, "export_native_model_files": false, "checkpoint_trainable_policies_only": false, "logger_creator": null, "logger_config": null, "log_level": "WARN", "log_sys_usage": true, "fake_sampler": false, "seed": 10, "restart_failed_env_runners": true, "ignore_env_runner_failures": false, "max_num_env_runner_restarts": 1000, "delay_between_env_runner_restarts_s": 60.0, "restart_failed_sub_environments": false, "num_consecutive_env_runner_failures_tolerance": 100, "env_runner_health_probe_timeout_s": 30.0, "env_runner_restore_timeout_s": 1800.0, "_model_config": {}, "_rl_module_spec": "RLModuleSpec(module_class=None, observation_space=None, action_space=None, inference_only=False, learner_only=False, model_config=DefaultModelConfig(fcnet_hiddens=[60, 90], fcnet_activation='tanh', fcnet_kernel_initializer=None, fcnet_kernel_initializer_kwargs=None, fcnet_bias_initializer=None, fcnet_bias_initializer_kwargs=None, conv_filters=None, conv_activation='relu', conv_kernel_initializer=None, conv_kernel_initializer_kwargs=None, conv_bias_initializer=None, conv_bias_initializer_kwargs=None, head_fcnet_hiddens=[], head_fcnet_activation='relu', head_fcnet_kernel_initializer=None, head_fcnet_kernel_initializer_kwargs=None, head_fcnet_bias_initializer=None, head_fcnet_bias_initializer_kwargs=None, free_log_std=False, log_std_clip_param=20.0, vf_share_layers=True, use_lstm=False, max_seq_len=20, lstm_cell_size=256, lstm_use_prev_action=False, lstm_use_prev_reward=False, lstm_kernel_initializer=None, lstm_kernel_initializer_kwargs=None, lstm_bias_initializer=None, lstm_bias_initializer_kwargs=None), catalog_class=None, load_state_path=None, model_config_dict=None)", "algorithm_config_overrides_per_module": {}, "_per_module_overrides": {}, "_validate_config": true, "_use_msgpack_checkpoints": false, "_torch_grad_scaler_class": null, "_torch_lr_scheduler_classes": null, "_tf_policy_handles_more_than_one_loss": false, "_disable_preprocessor_api": false, "_disable_action_flattening": false, "_disable_initialize_loss_from_dummy_batch": false, "_dont_auto_sync_env_runner_states": false, "env_task_fn": -1, "enable_connectors": -1, "simple_optimizer": false, "policy_map_cache": -1, "worker_cls": -1, "synchronize_filters": -1, "enable_async_evaluation": -1, "custom_async_evaluation_function": -1, "_enable_rl_module_api": -1, "auto_wrap_old_gym_envs": -1, "always_attach_evaluation_results": -1, "replay_sequence_length": null, "_disable_execution_plan_api": -1, "use_critic": true, "use_gae": true, "use_kl_loss": true, "kl_coeff": 0.7464963036515, "kl_target": 0.0270990929592, "vf_loss_coeff": 0.6688075857018, "entropy_coeff": 0.0090570820258, "clip_param": 0.1221781641624, "vf_clip_param": 0.1027808522125, "entropy_coeff_schedule": null, "lr_schedule": null, "sgd_minibatch_size": -1, "vf_share_layers": -1, "__stdout_file__": null, "__stderr_file__": null, "lambda": 0.9099046732075, "input": "sampler", "policies": {"default_policy": [null, null, null, null]}, "callbacks": "<class 'ray.rllib.callbacks.callbacks.RLlibCallback'>", "create_env_on_driver": false, "custom_eval_function": null, "framework": "torch"}, "time_since_restore": 42.96937537193298, "iterations_since_restore": 20, "perf": {"cpu_util_percent": 46.6, "ram_util_percent": 75.96666666666667}}
