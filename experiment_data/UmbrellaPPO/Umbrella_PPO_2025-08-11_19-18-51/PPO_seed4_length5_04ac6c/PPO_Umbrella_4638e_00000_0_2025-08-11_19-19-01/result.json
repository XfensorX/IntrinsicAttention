{"timers": {"training_iteration": 3.4909861250780523, "restore_env_runners": 5.0958944484591484e-05, "training_step": 3.490630624932237, "env_runner_sampling_timer": 3.3212557500228286, "learner_update_timer": 0.1622132919728756, "synch_weights": 0.001221582992002368}, "env_runners": {"agent_episode_returns_mean": {"default_agent": 2.899999999999998}, "env_to_module_connector": {"timers": {"connectors": {"add_time_dim_to_batch_and_zero_pad": 6.660206431176421e-06, "add_states_from_episodes_to_batch": 3.1545643822599138e-06, "numpy_to_tensor": 2.1991335067163112e-05, "add_observations_from_episodes_to_batch": 7.706619677423636e-06, "batch_individual_items": 1.55723683209045e-05}}, "connector_pipeline_timer": 0.00010087154566336049}, "episode_len_mean": 20.0, "episode_len_min": 20, "episode_return_max": 12.5, "num_agent_steps_sampled": {"default_agent": 5000.0}, "module_to_env_connector": {"timers": {"connectors": {"listify_data_for_vector_env": 2.4785372545024002e-05, "tensor_to_numpy": 3.2933863881775744e-05, "normalize_and_clip_actions": 2.8748053567389534e-05, "get_actions": 0.00011840919765618895, "un_batch_to_individual_items": 1.1089457870678734e-05, "remove_single_ts_time_rank_from_batch": 1.2614117146469255e-06}}, "connector_pipeline_timer": 0.00027043602893903485}, "num_env_steps_sampled": 5000.0, "episode_return_mean": 2.899999999999998, "num_episodes_lifetime": 31375.0, "episode_return_min": -7.5, "time_between_sampling": 0.0012287041316574243, "episode_len_max": 20, "env_reset_timer": 0.00015228113590930867, "num_env_steps_sampled_lifetime": 627500.0, "env_to_module_sum_episodes_length_in": 10.191744832559449, "sample": 0.014242069587826808, "num_episodes": 250.0, "num_module_steps_sampled_lifetime": {"default_policy": 627500.0}, "module_episode_returns_mean": {"default_policy": 2.899999999999998}, "env_step_timer": 3.498784934017715e-05, "weights_seq_no": 0.0, "num_agent_steps_sampled_lifetime": {"default_agent": 627500.0}, "rlmodule_inference_timer": 0.00010180187477046518, "env_to_module_sum_episodes_length_out": 10.191744832559449, "num_module_steps_sampled": {"default_policy": 5000.0}, "episode_duration_sec_mean": 0.011326232994440943, "num_env_steps_sampled_lifetime_throughput": 1839.0154806212108}, "learners": {"__all_modules__": {"learner_connector": {"timers": {"connectors": {"numpy_to_tensor": 8.495897054672241e-05, "add_columns_from_episodes_to_train_batch": 0.051095625036396086, "add_observations_from_episodes_to_batch": 0.0018872079672291875, "add_states_from_episodes_to_batch": 4.708068445324898e-06, "general_advantage_estimation": 0.007052124943584204, "batch_individual_items": 0.03783612500410527, "add_one_ts_to_episodes_and_truncate": 0.00945474999025464, "add_time_dim_to_batch_and_zero_pad": 1.866708043962717e-05}}, "connector_pipeline_timer": 0.10765008395537734}, "num_module_steps_trained_lifetime": 6000, "learner_connector_sum_episodes_length_in": 5000, "num_trainable_parameters": 6003, "learner_connector_sum_episodes_length_out": 5250, "num_env_steps_trained_lifetime": 31500, "num_module_steps_trained": 6000, "num_env_steps_trained": 31500, "num_non_trainable_parameters": 0, "num_env_steps_trained_lifetime_throughput": 1179894.6008141318, "num_module_steps_trained_throughput": 226337.01144489553, "num_module_steps_trained_lifetime_throughput": 224510.0424650902}, "default_policy": {"policy_loss": -0.07757909595966339, "mean_kl_loss": 5.3182855481281877e-05, "diff_num_grad_updates_vs_sampler_policy": 1.0, "num_module_steps_trained_lifetime": 6000, "entropy": 0.6919029951095581, "vf_explained_var": 0.012743055820465088, "gradients_default_optimizer_global_norm": 0.10145387798547745, "module_train_batch_size_mean": 1000.0, "weights_seq_no": 1.0, "total_loss": -0.016456305980682373, "curr_kl_coeff": 0.3732481598854065, "default_optimizer_learning_rate": 0.0002847858517, "vf_loss_unclipped": 28.695228576660156, "vf_loss": 0.10070119053125381, "curr_entropy_coeff": 0.0090570820258, "num_trainable_parameters": 6003, "num_module_steps_trained": 6000, "num_module_steps_trained_lifetime_throughput": 229678.3610187238}}, "num_training_step_calls_per_iteration": 1, "num_env_steps_sampled_lifetime": 627500.0, "evaluation": {"env_runners": {"module_to_env_connector": {"timers": {"connectors": {"tensor_to_numpy": 3.439061282121028e-05, "normalize_and_clip_actions": 2.390629194093243e-05, "get_actions": 9.916977838667968e-05, "un_batch_to_individual_items": 1.0111694044426418e-05, "remove_single_ts_time_rank_from_batch": 1.1624975280191826e-06, "listify_data_for_vector_env": 2.3201549159077557e-05}}, "connector_pipeline_timer": 0.00023907377376437586}, "episode_duration_sec_mean": 0.008722214488079772, "module_episode_returns_mean": {"default_policy": 0.15}, "episode_len_mean": 20.0, "env_to_module_connector": {"timers": {"connectors": {"add_time_dim_to_batch_and_zero_pad": 4.2671264383078285e-06, "add_states_from_episodes_to_batch": 2.6633791557084834e-06, "add_observations_from_episodes_to_batch": 5.005661332338211e-06, "batch_individual_items": 1.3515827469461115e-05, "numpy_to_tensor": 1.9540889968498273e-05}}, "connector_pipeline_timer": 8.374276016072508e-05}, "num_env_steps_sampled_lifetime": 5400, "env_to_module_sum_episodes_length_out": 10.216013141322508, "num_agent_steps_sampled": {"default_agent": 400}, "env_reset_timer": 0.0005065000150352716, "env_step_timer": 3.140722145181639e-05, "weights_seq_no": 1.0, "rlmodule_inference_timer": 6.591863470609035e-05, "num_module_steps_sampled": {"default_policy": 400}, "agent_episode_returns_mean": {"default_agent": 0.15}, "env_to_module_sum_episodes_length_in": 10.216013141322508, "episode_len_max": 20, "sample": 0.19005804206244648, "episode_len_min": 20, "num_module_steps_sampled_lifetime": {"default_policy": 400}, "episode_return_max": 10.5, "num_agent_steps_sampled_lifetime": {"default_agent": 400}, "num_env_steps_sampled": 400, "episode_return_min": -13.5, "episode_return_mean": 0.15, "num_episodes_lifetime": 20, "num_episodes": 20}, "num_healthy_workers": 1, "actor_manager_num_outstanding_async_reqs": 0, "num_remote_worker_restarts": 0}, "fault_tolerance": {"num_healthy_workers": 0, "num_remote_worker_restarts": 0}, "env_runner_group": {"actor_manager_num_outstanding_async_reqs": 0}, "done": false, "training_iteration": 1, "trial_id": "4638e_00000", "date": "2025-08-11_19-33-04", "timestamp": 1754933584, "time_this_iter_s": 3.6978278160095215, "time_total_s": 3.6978278160095215, "pid": 25862, "hostname": "Mac", "node_ip": "127.0.0.1", "config": {"exploration_config": {}, "extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "placement_strategy": "PACK", "num_gpus": 0, "_fake_gpus": false, "num_cpus_for_main_process": 2, "eager_tracing": true, "eager_max_retraces": 20, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "torch_compile_learner": false, "torch_compile_learner_what_to_compile": "forward_train", "torch_compile_learner_dynamo_backend": "aot_eager", "torch_compile_learner_dynamo_mode": null, "torch_compile_worker": false, "torch_compile_worker_dynamo_backend": "aot_eager", "torch_compile_worker_dynamo_mode": null, "torch_ddp_kwargs": {}, "torch_skip_nan_gradients": false, "env": "Umbrella", "env_config": {}, "observation_space": null, "action_space": null, "clip_rewards": null, "normalize_actions": true, "clip_actions": false, "_is_atari": null, "disable_env_checking": false, "render_env": false, "action_mask_key": "action_mask", "env_runner_cls": null, "num_env_runners": 0, "create_local_env_runner": true, "num_envs_per_env_runner": 1, "gym_env_vectorize_mode": "SYNC", "num_cpus_per_env_runner": 1, "num_gpus_per_env_runner": 0, "custom_resources_per_env_runner": {}, "validate_env_runners_after_construction": true, "episodes_to_numpy": true, "max_requests_in_flight_per_env_runner": 1, "sample_timeout_s": 60.0, "_env_to_module_connector": null, "add_default_connectors_to_env_to_module_pipeline": true, "_module_to_env_connector": null, "add_default_connectors_to_module_to_env_pipeline": true, "merge_env_runner_states": "training_only", "broadcast_env_runner_states": true, "episode_lookback_horizon": 1, "rollout_fragment_length": "auto", "batch_mode": "complete_episodes", "compress_observations": false, "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "enable_tf1_exec_eagerly": false, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "preprocessor_pref": "deepmind", "observation_filter": "NoFilter", "update_worker_filter_stats": true, "use_worker_filter_stats": true, "sampler_perf_stats_ema_coef": null, "_is_online": true, "num_learners": 0, "num_gpus_per_learner": 0, "num_cpus_per_learner": "auto", "num_aggregator_actors_per_learner": 0, "max_requests_in_flight_per_aggregator_actor": 3, "local_gpu_idx": 0, "max_requests_in_flight_per_learner": 3, "gamma": 1, "lr": 0.0002847858517, "grad_clip": 0.5, "grad_clip_by": "global_norm", "_train_batch_size_per_learner": 5000, "train_batch_size": 4000, "num_epochs": 1, "minibatch_size": 1000, "shuffle_batch_per_epoch": true, "model": {"fcnet_hiddens": [256, 256], "fcnet_activation": "tanh", "fcnet_weights_initializer": null, "fcnet_weights_initializer_config": null, "fcnet_bias_initializer": null, "fcnet_bias_initializer_config": null, "conv_filters": null, "conv_activation": "relu", "conv_kernel_initializer": null, "conv_kernel_initializer_config": null, "conv_bias_initializer": null, "conv_bias_initializer_config": null, "conv_transpose_kernel_initializer": null, "conv_transpose_kernel_initializer_config": null, "conv_transpose_bias_initializer": null, "conv_transpose_bias_initializer_config": null, "post_fcnet_hiddens": [], "post_fcnet_activation": "relu", "post_fcnet_weights_initializer": null, "post_fcnet_weights_initializer_config": null, "post_fcnet_bias_initializer": null, "post_fcnet_bias_initializer_config": null, "free_log_std": false, "log_std_clip_param": 20.0, "no_final_linear": false, "vf_share_layers": false, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "lstm_weights_initializer": null, "lstm_weights_initializer_config": null, "lstm_bias_initializer": null, "lstm_bias_initializer_config": null, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "attention_use_n_prev_actions": 0, "attention_use_n_prev_rewards": 0, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": null, "custom_model_config": {}, "custom_action_dist": null, "custom_preprocessor": null, "encoder_latent_dim": null, "always_check_shapes": false, "lstm_use_prev_action_reward": -1, "_use_default_native_models": -1, "_disable_preprocessor_api": false, "_disable_action_flattening": false}, "_learner_connector": null, "add_default_connectors_to_learner_pipeline": true, "learner_config_dict": {}, "optimizer": {}, "_learner_class": null, "callbacks_on_algorithm_init": null, "callbacks_on_env_runners_recreated": null, "callbacks_on_offline_eval_runners_recreated": null, "callbacks_on_checkpoint_loaded": null, "callbacks_on_environment_created": null, "callbacks_on_episode_created": null, "callbacks_on_episode_start": null, "callbacks_on_episode_step": null, "callbacks_on_episode_end": null, "callbacks_on_evaluate_start": null, "callbacks_on_evaluate_end": null, "callbacks_on_evaluate_offline_start": null, "callbacks_on_evaluate_offline_end": null, "callbacks_on_sample_end": null, "callbacks_on_train_result": null, "explore": true, "enable_rl_module_and_learner": true, "enable_env_runner_and_connector_v2": true, "_prior_exploration_config": {"type": "StochasticSampling"}, "count_steps_by": "env_steps", "policy_map_capacity": 100, "policy_mapping_fn": "<function AlgorithmConfig.DEFAULT_POLICY_MAPPING_FN at 0x161d55b20>", "policies_to_train": null, "policy_states_are_swappable": false, "observation_fn": null, "offline_data_class": null, "input_read_method": "read_parquet", "input_read_method_kwargs": {}, "input_read_schema": {}, "input_read_episodes": false, "input_read_sample_batches": false, "input_read_batch_size": null, "input_filesystem": null, "input_filesystem_kwargs": {}, "input_compress_columns": ["obs", "new_obs"], "input_spaces_jsonable": true, "materialize_data": false, "materialize_mapped_data": true, "map_batches_kwargs": {}, "iter_batches_kwargs": {}, "ignore_final_observation": false, "prelearner_class": null, "prelearner_buffer_class": null, "prelearner_buffer_kwargs": {}, "prelearner_module_synch_period": 10, "dataset_num_iters_per_learner": null, "input_config": {}, "actions_in_input_normalized": false, "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_config": {}, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "output_max_rows_per_file": null, "output_write_remaining_data": false, "output_write_method": "write_parquet", "output_write_method_kwargs": {}, "output_filesystem": null, "output_filesystem_kwargs": {}, "output_write_episodes": true, "offline_sampling": false, "evaluation_interval": 1, "evaluation_duration": 20, "evaluation_duration_unit": "episodes", "evaluation_sample_timeout_s": 120.0, "evaluation_auto_duration_min_env_steps_per_sample": 100, "evaluation_auto_duration_max_env_steps_per_sample": 2000, "evaluation_parallel_to_training": false, "evaluation_force_reset_envs_before_iteration": true, "evaluation_config": null, "off_policy_estimation_methods": {}, "ope_split_batch_by_episode": true, "evaluation_num_env_runners": 1, "in_evaluation": false, "sync_filters_on_rollout_workers_timeout_s": 10.0, "offline_evaluation_interval": null, "num_offline_eval_runners": 0, "offline_loss_for_module_fn": null, "offline_evaluation_duration": 1, "offline_evaluation_parallel_to_training": false, "offline_evaluation_timeout_s": 120.0, "num_cpus_per_offline_eval_runner": 1, "num_gpus_per_offline_eval_runner": 0, "custom_resources_per_offline_eval_runner": {}, "restart_failed_offline_eval_runners": true, "ignore_offline_eval_runner_failures": false, "max_num_offline_eval_runner_restarts": 1000, "offline_eval_runner_restore_timeout_s": 1800.0, "max_requests_in_flight_per_offline_eval_runner": 1, "validate_offline_eval_runners_after_construction": true, "offline_eval_runner_health_probe_timeout_s": 30.0, "offline_eval_rl_module_inference_only": false, "broadcast_offline_eval_runner_states": false, "offline_eval_batch_size_per_runner": 256, "dataset_num_iters_per_eval_runner": 1, "keep_per_episode_custom_metrics": false, "metrics_episode_collection_timeout_s": 60.0, "metrics_num_episodes_for_smoothing": 100, "min_time_s_per_iteration": null, "min_train_timesteps_per_iteration": 0, "min_sample_timesteps_per_iteration": 0, "log_gradients": true, "export_native_model_files": false, "checkpoint_trainable_policies_only": false, "logger_creator": null, "logger_config": null, "log_level": "WARN", "log_sys_usage": true, "fake_sampler": false, "seed": 4, "restart_failed_env_runners": true, "ignore_env_runner_failures": false, "max_num_env_runner_restarts": 1000, "delay_between_env_runner_restarts_s": 60.0, "restart_failed_sub_environments": false, "num_consecutive_env_runner_failures_tolerance": 100, "env_runner_health_probe_timeout_s": 30.0, "env_runner_restore_timeout_s": 1800.0, "_model_config": {}, "_rl_module_spec": "RLModuleSpec(module_class=None, observation_space=None, action_space=None, inference_only=False, learner_only=False, model_config=DefaultModelConfig(fcnet_hiddens=[60, 90], fcnet_activation='tanh', fcnet_kernel_initializer=None, fcnet_kernel_initializer_kwargs=None, fcnet_bias_initializer=None, fcnet_bias_initializer_kwargs=None, conv_filters=None, conv_activation='relu', conv_kernel_initializer=None, conv_kernel_initializer_kwargs=None, conv_bias_initializer=None, conv_bias_initializer_kwargs=None, head_fcnet_hiddens=[], head_fcnet_activation='relu', head_fcnet_kernel_initializer=None, head_fcnet_kernel_initializer_kwargs=None, head_fcnet_bias_initializer=None, head_fcnet_bias_initializer_kwargs=None, free_log_std=False, log_std_clip_param=20.0, vf_share_layers=True, use_lstm=False, max_seq_len=20, lstm_cell_size=256, lstm_use_prev_action=False, lstm_use_prev_reward=False, lstm_kernel_initializer=None, lstm_kernel_initializer_kwargs=None, lstm_bias_initializer=None, lstm_bias_initializer_kwargs=None), catalog_class=None, load_state_path=None, model_config_dict=None)", "algorithm_config_overrides_per_module": {}, "_per_module_overrides": {}, "_validate_config": true, "_use_msgpack_checkpoints": false, "_torch_grad_scaler_class": null, "_torch_lr_scheduler_classes": null, "_tf_policy_handles_more_than_one_loss": false, "_disable_preprocessor_api": false, "_disable_action_flattening": false, "_disable_initialize_loss_from_dummy_batch": false, "_dont_auto_sync_env_runner_states": false, "env_task_fn": -1, "enable_connectors": -1, "simple_optimizer": false, "policy_map_cache": -1, "worker_cls": -1, "synchronize_filters": -1, "enable_async_evaluation": -1, "custom_async_evaluation_function": -1, "_enable_rl_module_api": -1, "auto_wrap_old_gym_envs": -1, "always_attach_evaluation_results": -1, "replay_sequence_length": null, "_disable_execution_plan_api": -1, "use_critic": true, "use_gae": true, "use_kl_loss": true, "kl_coeff": 0.7464963036515, "kl_target": 0.0270990929592, "vf_loss_coeff": 0.6688075857018, "entropy_coeff": 0.0090570820258, "clip_param": 0.1221781641624, "vf_clip_param": 0.1027808522125, "entropy_coeff_schedule": null, "lr_schedule": null, "sgd_minibatch_size": -1, "vf_share_layers": -1, "__stdout_file__": null, "__stderr_file__": null, "lambda": 0.9099046732075, "input": "sampler", "policies": {"default_policy": [null, null, null, null]}, "callbacks": "<class 'ray.rllib.callbacks.callbacks.RLlibCallback'>", "create_env_on_driver": false, "custom_eval_function": null, "framework": "torch"}, "time_since_restore": 3.6978278160095215, "iterations_since_restore": 1, "perf": {"cpu_util_percent": 70.81666666666666, "ram_util_percent": 78.2}}
{"timers": {"training_iteration": 3.4829762659070544, "restore_env_runners": 5.052726482972502e-05, "training_step": 3.482621441592928, "env_runner_sampling_timer": 3.311845986692933, "learner_update_timer": 0.16362842239323072, "synch_weights": 0.0012220363225787878, "restore_eval_env_runners": 1.083302777260542e-05, "evaluation_iteration": 0.20306683308444917, "synch_eval_env_connectors": 0.00047037494368851185, "synch_env_connectors": 6.082933396100998e-06}, "env_runners": {"agent_episode_returns_mean": {"default_agent": 3.1399999999999992}, "env_to_module_connector": {"timers": {"connectors": {"add_time_dim_to_batch_and_zero_pad": 4.175984731652816e-06, "add_states_from_episodes_to_batch": 2.5337102699118816e-06, "numpy_to_tensor": 1.57514163786124e-05, "add_observations_from_episodes_to_batch": 4.723354877852002e-06, "batch_individual_items": 1.1131530950127547e-05}}, "connector_pipeline_timer": 7.058008085401362e-05}, "episode_len_mean": 20.0, "episode_len_min": 20, "episode_return_max": 12.5, "num_agent_steps_sampled": {"default_agent": 5000.0}, "module_to_env_connector": {"timers": {"connectors": {"listify_data_for_vector_env": 1.8319542508203876e-05, "tensor_to_numpy": 2.3457307523330205e-05, "normalize_and_clip_actions": 1.520273643361468e-05, "get_actions": 7.851760336208881e-05, "un_batch_to_individual_items": 8.702061871572741e-06, "remove_single_ts_time_rank_from_batch": 9.73194289424159e-07}}, "connector_pipeline_timer": 0.00018615065011525983}, "num_env_steps_sampled": 5000.0, "episode_return_mean": 3.1399999999999992, "num_episodes_lifetime": 500.0, "episode_return_min": -7.5, "time_between_sampling": 0.0025819827943924525, "episode_len_max": 20, "env_reset_timer": 8.948428756748755e-05, "num_env_steps_sampled_lifetime": 10000.0, "env_to_module_sum_episodes_length_in": 10.36823839457432, "sample": 0.010017857879096271, "num_episodes": 250.0, "num_module_steps_sampled_lifetime": {"default_policy": 10000.0}, "module_episode_returns_mean": {"default_policy": 3.1399999999999992}, "env_step_timer": 2.4791406614896376e-05, "weights_seq_no": 1.0, "num_agent_steps_sampled_lifetime": {"default_agent": 10000.0}, "rlmodule_inference_timer": 5.2321036888456315e-05, "env_to_module_sum_episodes_length_out": 10.36823839457432, "num_module_steps_sampled": {"default_policy": 5000.0}, "episode_duration_sec_mean": 0.00787054900592193, "num_env_steps_sampled_lifetime_throughput": 2366.079623799892}, "learners": {"__all_modules__": {"learner_connector": {"timers": {"connectors": {"numpy_to_tensor": 8.487979997880756e-05, "add_columns_from_episodes_to_train_batch": 0.05111079961643555, "add_observations_from_episodes_to_batch": 0.0018821471370756627, "add_states_from_episodes_to_batch": 4.700578283518553e-06, "general_advantage_estimation": 0.00710770035511814, "batch_individual_items": 0.03915500125382096, "add_one_ts_to_episodes_and_truncate": 0.009512492490466684, "add_time_dim_to_batch_and_zero_pad": 1.8631239654496313e-05}}, "connector_pipeline_timer": 0.10909180353512057}, "num_module_steps_trained_lifetime": 12000, "learner_connector_sum_episodes_length_in": 5000.0, "num_trainable_parameters": 6003, "learner_connector_sum_episodes_length_out": 5250.0, "num_env_steps_trained_lifetime": 63000, "num_module_steps_trained": 6000, "num_env_steps_trained": 31500, "num_non_trainable_parameters": 0, "num_env_steps_trained_lifetime_throughput": 1171844.6833909387, "num_module_steps_trained_throughput": 224784.83087560572, "num_module_steps_trained_lifetime_throughput": 222981.45409790875}, "default_policy": {"policy_loss": 0.15436917543411255, "mean_kl_loss": 0.00033477909164503217, "diff_num_grad_updates_vs_sampler_policy": 1.0, "num_module_steps_trained_lifetime": 12000, "entropy": 0.6910908818244934, "vf_explained_var": 0.01552802324295044, "gradients_default_optimizer_global_norm": 0.09580280631780624, "module_train_batch_size_mean": 1000.0, "weights_seq_no": 2.0, "total_loss": 0.21512305736541748, "curr_kl_coeff": 0.18662407994270325, "default_optimizer_learning_rate": 0.0002847858517, "vf_loss_unclipped": 28.312942504882812, "vf_loss": 0.10001108795404434, "curr_entropy_coeff": 0.0090570820258, "num_trainable_parameters": 6003, "num_module_steps_trained": 6000, "num_module_steps_trained_lifetime_throughput": 228080.6455109878}}, "num_training_step_calls_per_iteration": 1, "evaluation": {"env_runners": {"module_to_env_connector": {"timers": {"connectors": {"tensor_to_numpy": 1.995151954267264e-05, "normalize_and_clip_actions": 1.3560770994586898e-05, "get_actions": 6.660041677476152e-05, "un_batch_to_individual_items": 7.534177539129822e-06, "remove_single_ts_time_rank_from_batch": 8.383780780307164e-07, "listify_data_for_vector_env": 1.6379045329468894e-05}}, "connector_pipeline_timer": 0.00016066492317089452}, "episode_duration_sec_mean": 0.008737637416925282, "module_episode_returns_mean": {"default_policy": -0.85}, "episode_len_mean": 20.0, "env_to_module_connector": {"timers": {"connectors": {"add_time_dim_to_batch_and_zero_pad": 3.302117802515539e-06, "add_states_from_episodes_to_batch": 1.9994027286274253e-06, "add_observations_from_episodes_to_batch": 4.173343965942534e-06, "batch_individual_items": 9.399148341639204e-06, "numpy_to_tensor": 1.3785801626951247e-05}}, "connector_pipeline_timer": 6.182532181387923e-05}, "num_env_steps_sampled_lifetime": 10400, "env_to_module_sum_episodes_length_out": 10.366003441359926, "num_agent_steps_sampled": {"default_agent": 400}, "env_reset_timer": 0.0005034175154287367, "env_step_timer": 2.2535035038336124e-05, "weights_seq_no": 2.0, "rlmodule_inference_timer": 4.256914108480048e-05, "num_module_steps_sampled": {"default_policy": 400}, "agent_episode_returns_mean": {"default_agent": -0.85}, "env_to_module_sum_episodes_length_in": 10.366003441359926, "episode_len_max": 20, "sample": 0.19006196456262842, "episode_len_min": 20, "num_module_steps_sampled_lifetime": {"default_policy": 800}, "episode_return_max": 11.5, "num_agent_steps_sampled_lifetime": {"default_agent": 800}, "num_env_steps_sampled": 400, "episode_return_min": -14.5, "episode_return_mean": -0.85, "num_episodes_lifetime": 40, "num_episodes": 20, "time_between_sampling": 2.727452125051059}, "num_healthy_workers": 1, "actor_manager_num_outstanding_async_reqs": 0, "num_remote_worker_restarts": 0}, "num_env_steps_sampled_lifetime": 10000.0, "fault_tolerance": {"num_healthy_workers": 0, "num_remote_worker_restarts": 0}, "env_runner_group": {"actor_manager_num_outstanding_async_reqs": 0}, "done": false, "training_iteration": 2, "trial_id": "4638e_00000", "date": "2025-08-11_19-33-07", "timestamp": 1754933587, "time_this_iter_s": 2.893199920654297, "time_total_s": 6.591027736663818, "pid": 25862, "hostname": "Mac", "node_ip": "127.0.0.1", "config": {"exploration_config": {}, "extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "placement_strategy": "PACK", "num_gpus": 0, "_fake_gpus": false, "num_cpus_for_main_process": 2, "eager_tracing": true, "eager_max_retraces": 20, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "torch_compile_learner": false, "torch_compile_learner_what_to_compile": "forward_train", "torch_compile_learner_dynamo_backend": "aot_eager", "torch_compile_learner_dynamo_mode": null, "torch_compile_worker": false, "torch_compile_worker_dynamo_backend": "aot_eager", "torch_compile_worker_dynamo_mode": null, "torch_ddp_kwargs": {}, "torch_skip_nan_gradients": false, "env": "Umbrella", "env_config": {}, "observation_space": null, "action_space": null, "clip_rewards": null, "normalize_actions": true, "clip_actions": false, "_is_atari": null, "disable_env_checking": false, "render_env": false, "action_mask_key": "action_mask", "env_runner_cls": null, "num_env_runners": 0, "create_local_env_runner": true, "num_envs_per_env_runner": 1, "gym_env_vectorize_mode": "SYNC", "num_cpus_per_env_runner": 1, "num_gpus_per_env_runner": 0, "custom_resources_per_env_runner": {}, "validate_env_runners_after_construction": true, "episodes_to_numpy": true, "max_requests_in_flight_per_env_runner": 1, "sample_timeout_s": 60.0, "_env_to_module_connector": null, "add_default_connectors_to_env_to_module_pipeline": true, "_module_to_env_connector": null, "add_default_connectors_to_module_to_env_pipeline": true, "merge_env_runner_states": "training_only", "broadcast_env_runner_states": true, "episode_lookback_horizon": 1, "rollout_fragment_length": "auto", "batch_mode": "complete_episodes", "compress_observations": false, "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "enable_tf1_exec_eagerly": false, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "preprocessor_pref": "deepmind", "observation_filter": "NoFilter", "update_worker_filter_stats": true, "use_worker_filter_stats": true, "sampler_perf_stats_ema_coef": null, "_is_online": true, "num_learners": 0, "num_gpus_per_learner": 0, "num_cpus_per_learner": "auto", "num_aggregator_actors_per_learner": 0, "max_requests_in_flight_per_aggregator_actor": 3, "local_gpu_idx": 0, "max_requests_in_flight_per_learner": 3, "gamma": 1, "lr": 0.0002847858517, "grad_clip": 0.5, "grad_clip_by": "global_norm", "_train_batch_size_per_learner": 5000, "train_batch_size": 4000, "num_epochs": 1, "minibatch_size": 1000, "shuffle_batch_per_epoch": true, "model": {"fcnet_hiddens": [256, 256], "fcnet_activation": "tanh", "fcnet_weights_initializer": null, "fcnet_weights_initializer_config": null, "fcnet_bias_initializer": null, "fcnet_bias_initializer_config": null, "conv_filters": null, "conv_activation": "relu", "conv_kernel_initializer": null, "conv_kernel_initializer_config": null, "conv_bias_initializer": null, "conv_bias_initializer_config": null, "conv_transpose_kernel_initializer": null, "conv_transpose_kernel_initializer_config": null, "conv_transpose_bias_initializer": null, "conv_transpose_bias_initializer_config": null, "post_fcnet_hiddens": [], "post_fcnet_activation": "relu", "post_fcnet_weights_initializer": null, "post_fcnet_weights_initializer_config": null, "post_fcnet_bias_initializer": null, "post_fcnet_bias_initializer_config": null, "free_log_std": false, "log_std_clip_param": 20.0, "no_final_linear": false, "vf_share_layers": false, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "lstm_weights_initializer": null, "lstm_weights_initializer_config": null, "lstm_bias_initializer": null, "lstm_bias_initializer_config": null, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "attention_use_n_prev_actions": 0, "attention_use_n_prev_rewards": 0, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": null, "custom_model_config": {}, "custom_action_dist": null, "custom_preprocessor": null, "encoder_latent_dim": null, "always_check_shapes": false, "lstm_use_prev_action_reward": -1, "_use_default_native_models": -1, "_disable_preprocessor_api": false, "_disable_action_flattening": false}, "_learner_connector": null, "add_default_connectors_to_learner_pipeline": true, "learner_config_dict": {}, "optimizer": {}, "_learner_class": null, "callbacks_on_algorithm_init": null, "callbacks_on_env_runners_recreated": null, "callbacks_on_offline_eval_runners_recreated": null, "callbacks_on_checkpoint_loaded": null, "callbacks_on_environment_created": null, "callbacks_on_episode_created": null, "callbacks_on_episode_start": null, "callbacks_on_episode_step": null, "callbacks_on_episode_end": null, "callbacks_on_evaluate_start": null, "callbacks_on_evaluate_end": null, "callbacks_on_evaluate_offline_start": null, "callbacks_on_evaluate_offline_end": null, "callbacks_on_sample_end": null, "callbacks_on_train_result": null, "explore": true, "enable_rl_module_and_learner": true, "enable_env_runner_and_connector_v2": true, "_prior_exploration_config": {"type": "StochasticSampling"}, "count_steps_by": "env_steps", "policy_map_capacity": 100, "policy_mapping_fn": "<function AlgorithmConfig.DEFAULT_POLICY_MAPPING_FN at 0x161d55b20>", "policies_to_train": null, "policy_states_are_swappable": false, "observation_fn": null, "offline_data_class": null, "input_read_method": "read_parquet", "input_read_method_kwargs": {}, "input_read_schema": {}, "input_read_episodes": false, "input_read_sample_batches": false, "input_read_batch_size": null, "input_filesystem": null, "input_filesystem_kwargs": {}, "input_compress_columns": ["obs", "new_obs"], "input_spaces_jsonable": true, "materialize_data": false, "materialize_mapped_data": true, "map_batches_kwargs": {}, "iter_batches_kwargs": {}, "ignore_final_observation": false, "prelearner_class": null, "prelearner_buffer_class": null, "prelearner_buffer_kwargs": {}, "prelearner_module_synch_period": 10, "dataset_num_iters_per_learner": null, "input_config": {}, "actions_in_input_normalized": false, "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_config": {}, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "output_max_rows_per_file": null, "output_write_remaining_data": false, "output_write_method": "write_parquet", "output_write_method_kwargs": {}, "output_filesystem": null, "output_filesystem_kwargs": {}, "output_write_episodes": true, "offline_sampling": false, "evaluation_interval": 1, "evaluation_duration": 20, "evaluation_duration_unit": "episodes", "evaluation_sample_timeout_s": 120.0, "evaluation_auto_duration_min_env_steps_per_sample": 100, "evaluation_auto_duration_max_env_steps_per_sample": 2000, "evaluation_parallel_to_training": false, "evaluation_force_reset_envs_before_iteration": true, "evaluation_config": null, "off_policy_estimation_methods": {}, "ope_split_batch_by_episode": true, "evaluation_num_env_runners": 1, "in_evaluation": false, "sync_filters_on_rollout_workers_timeout_s": 10.0, "offline_evaluation_interval": null, "num_offline_eval_runners": 0, "offline_loss_for_module_fn": null, "offline_evaluation_duration": 1, "offline_evaluation_parallel_to_training": false, "offline_evaluation_timeout_s": 120.0, "num_cpus_per_offline_eval_runner": 1, "num_gpus_per_offline_eval_runner": 0, "custom_resources_per_offline_eval_runner": {}, "restart_failed_offline_eval_runners": true, "ignore_offline_eval_runner_failures": false, "max_num_offline_eval_runner_restarts": 1000, "offline_eval_runner_restore_timeout_s": 1800.0, "max_requests_in_flight_per_offline_eval_runner": 1, "validate_offline_eval_runners_after_construction": true, "offline_eval_runner_health_probe_timeout_s": 30.0, "offline_eval_rl_module_inference_only": false, "broadcast_offline_eval_runner_states": false, "offline_eval_batch_size_per_runner": 256, "dataset_num_iters_per_eval_runner": 1, "keep_per_episode_custom_metrics": false, "metrics_episode_collection_timeout_s": 60.0, "metrics_num_episodes_for_smoothing": 100, "min_time_s_per_iteration": null, "min_train_timesteps_per_iteration": 0, "min_sample_timesteps_per_iteration": 0, "log_gradients": true, "export_native_model_files": false, "checkpoint_trainable_policies_only": false, "logger_creator": null, "logger_config": null, "log_level": "WARN", "log_sys_usage": true, "fake_sampler": false, "seed": 4, "restart_failed_env_runners": true, "ignore_env_runner_failures": false, "max_num_env_runner_restarts": 1000, "delay_between_env_runner_restarts_s": 60.0, "restart_failed_sub_environments": false, "num_consecutive_env_runner_failures_tolerance": 100, "env_runner_health_probe_timeout_s": 30.0, "env_runner_restore_timeout_s": 1800.0, "_model_config": {}, "_rl_module_spec": "RLModuleSpec(module_class=None, observation_space=None, action_space=None, inference_only=False, learner_only=False, model_config=DefaultModelConfig(fcnet_hiddens=[60, 90], fcnet_activation='tanh', fcnet_kernel_initializer=None, fcnet_kernel_initializer_kwargs=None, fcnet_bias_initializer=None, fcnet_bias_initializer_kwargs=None, conv_filters=None, conv_activation='relu', conv_kernel_initializer=None, conv_kernel_initializer_kwargs=None, conv_bias_initializer=None, conv_bias_initializer_kwargs=None, head_fcnet_hiddens=[], head_fcnet_activation='relu', head_fcnet_kernel_initializer=None, head_fcnet_kernel_initializer_kwargs=None, head_fcnet_bias_initializer=None, head_fcnet_bias_initializer_kwargs=None, free_log_std=False, log_std_clip_param=20.0, vf_share_layers=True, use_lstm=False, max_seq_len=20, lstm_cell_size=256, lstm_use_prev_action=False, lstm_use_prev_reward=False, lstm_kernel_initializer=None, lstm_kernel_initializer_kwargs=None, lstm_bias_initializer=None, lstm_bias_initializer_kwargs=None), catalog_class=None, load_state_path=None, model_config_dict=None)", "algorithm_config_overrides_per_module": {}, "_per_module_overrides": {}, "_validate_config": true, "_use_msgpack_checkpoints": false, "_torch_grad_scaler_class": null, "_torch_lr_scheduler_classes": null, "_tf_policy_handles_more_than_one_loss": false, "_disable_preprocessor_api": false, "_disable_action_flattening": false, "_disable_initialize_loss_from_dummy_batch": false, "_dont_auto_sync_env_runner_states": false, "env_task_fn": -1, "enable_connectors": -1, "simple_optimizer": false, "policy_map_cache": -1, "worker_cls": -1, "synchronize_filters": -1, "enable_async_evaluation": -1, "custom_async_evaluation_function": -1, "_enable_rl_module_api": -1, "auto_wrap_old_gym_envs": -1, "always_attach_evaluation_results": -1, "replay_sequence_length": null, "_disable_execution_plan_api": -1, "use_critic": true, "use_gae": true, "use_kl_loss": true, "kl_coeff": 0.7464963036515, "kl_target": 0.0270990929592, "vf_loss_coeff": 0.6688075857018, "entropy_coeff": 0.0090570820258, "clip_param": 0.1221781641624, "vf_clip_param": 0.1027808522125, "entropy_coeff_schedule": null, "lr_schedule": null, "sgd_minibatch_size": -1, "vf_share_layers": -1, "__stdout_file__": null, "__stderr_file__": null, "lambda": 0.9099046732075, "input": "sampler", "policies": {"default_policy": [null, null, null, null]}, "callbacks": "<class 'ray.rllib.callbacks.callbacks.RLlibCallback'>", "create_env_on_driver": false, "custom_eval_function": null, "framework": "torch"}, "time_since_restore": 6.591027736663818, "iterations_since_restore": 2, "perf": {"cpu_util_percent": 71.7, "ram_util_percent": 77.775}}
{"timers": {"training_iteration": 3.478555329917429, "restore_env_runners": 5.010449222754686e-05, "training_step": 3.4781992305175167, "env_runner_sampling_timer": 3.3076450339058994, "learner_update_timer": 0.16341782941977726, "synch_weights": 0.001221448458870873, "restore_eval_env_runners": 1.0825537610799075e-05, "evaluation_iteration": 0.2030057830840815, "synch_eval_env_connectors": 0.00046886953408829867, "synch_env_connectors": 6.070854142308235e-06}, "env_runners": {"agent_episode_returns_mean": {"default_agent": 3.06}, "env_to_module_connector": {"timers": {"connectors": {"add_time_dim_to_batch_and_zero_pad": 4.859603018320046e-06, "add_states_from_episodes_to_batch": 2.9925132952258997e-06, "numpy_to_tensor": 1.9295966268869264e-05, "add_observations_from_episodes_to_batch": 6.004450588325521e-06, "batch_individual_items": 1.3549177699722487e-05}}, "connector_pipeline_timer": 8.406676859262562e-05}, "episode_len_mean": 20.0, "episode_len_min": 20, "episode_return_max": 12.5, "num_agent_steps_sampled": {"default_agent": 5000.0}, "module_to_env_connector": {"timers": {"connectors": {"listify_data_for_vector_env": 2.1721235585737463e-05, "tensor_to_numpy": 2.756883826103326e-05, "normalize_and_clip_actions": 1.7539094141614564e-05, "get_actions": 9.681410432875942e-05, "un_batch_to_individual_items": 1.0225101263557973e-05, "remove_single_ts_time_rank_from_batch": 1.024010753419802e-06}}, "connector_pipeline_timer": 0.00022246354097481312}, "num_env_steps_sampled": 5000.0, "episode_return_mean": 3.06, "num_episodes_lifetime": -30375.0, "episode_return_min": -7.5, "time_between_sampling": 0.003239250828589981, "episode_len_max": 20, "env_reset_timer": 8.70980536072356e-05, "num_env_steps_sampled_lifetime": -607500.0, "env_to_module_sum_episodes_length_in": 10.36823839457432, "sample": 0.009753921526824364, "num_episodes": 250.0, "num_module_steps_sampled_lifetime": {"default_policy": -607500.0}, "module_episode_returns_mean": {"default_policy": 3.06}, "env_step_timer": 3.1181101098200285e-05, "weights_seq_no": 2.0, "num_agent_steps_sampled_lifetime": {"default_agent": -607500.0}, "rlmodule_inference_timer": 6.361356476323623e-05, "env_to_module_sum_episodes_length_out": 10.36823839457432, "num_module_steps_sampled": {"default_policy": 5000.0}, "episode_duration_sec_mean": 0.009667218673508613, "num_env_steps_sampled_lifetime_throughput": 2036.5675498099972}, "learners": {"__all_modules__": {"learner_connector": {"timers": {"connectors": {"numpy_to_tensor": 8.577142268186434e-05, "add_columns_from_episodes_to_train_batch": 0.05111079952953151, "add_observations_from_episodes_to_batch": 0.0018791969157755375, "add_states_from_episodes_to_batch": 4.751913179643453e-06, "general_advantage_estimation": 0.007115248351881746, "batch_individual_items": 0.039209229991864415, "add_one_ts_to_episodes_and_truncate": 0.009552550476160831, "add_time_dim_to_batch_and_zero_pad": 1.8850756890606133e-05}}, "connector_pipeline_timer": 0.10919184882905103}, "num_module_steps_trained_lifetime": 18000, "learner_connector_sum_episodes_length_in": 5000.0, "num_trainable_parameters": 6003, "learner_connector_sum_episodes_length_out": 5250.0, "num_env_steps_trained_lifetime": 94500, "num_module_steps_trained": 6000, "num_env_steps_trained": 31500, "num_non_trainable_parameters": 0, "num_env_steps_trained_lifetime_throughput": 1170950.8599843425, "num_module_steps_trained_throughput": 224586.83368171193, "num_module_steps_trained_lifetime_throughput": 222818.71331906976}, "default_policy": {"policy_loss": 0.07159475237131119, "mean_kl_loss": 0.0003109359822701663, "diff_num_grad_updates_vs_sampler_policy": 1.0, "num_module_steps_trained_lifetime": 18000, "entropy": 0.6889595985412598, "vf_explained_var": 0.01814943552017212, "gradients_default_optimizer_global_norm": 0.10330437868833542, "module_train_batch_size_mean": 1000.0, "weights_seq_no": 3.0, "total_loss": 0.13235385715961456, "curr_kl_coeff": 0.09331203997135162, "default_optimizer_learning_rate": 0.0002847858517, "vf_loss_unclipped": 28.33220672607422, "vf_loss": 0.1000901460647583, "curr_entropy_coeff": 0.0090570820258, "num_trainable_parameters": 6003, "num_module_steps_trained": 6000, "num_module_steps_trained_lifetime_throughput": 227801.46643654528}}, "num_training_step_calls_per_iteration": 1, "evaluation": {"env_runners": {"module_to_env_connector": {"timers": {"connectors": {"tensor_to_numpy": 1.898190225075527e-05, "normalize_and_clip_actions": 1.2786018009683764e-05, "get_actions": 6.193988437066901e-05, "un_batch_to_individual_items": 7.265744249832414e-06, "remove_single_ts_time_rank_from_batch": 9.481334457084332e-07, "listify_data_for_vector_env": 1.6439720154142726e-05}}, "connector_pipeline_timer": 0.00015379991532628898}, "episode_duration_sec_mean": 0.008651652012486011, "module_episode_returns_mean": {"default_policy": 0.48333333333333334}, "episode_len_mean": 20.0, "env_to_module_connector": {"timers": {"connectors": {"add_time_dim_to_batch_and_zero_pad": 3.2048164128356675e-06, "add_states_from_episodes_to_batch": 1.937141701564403e-06, "add_observations_from_episodes_to_batch": 4.138252440460109e-06, "batch_individual_items": 8.602322836150979e-06, "numpy_to_tensor": 1.3414356074719144e-05}}, "connector_pipeline_timer": 5.940773055684191e-05}, "num_env_steps_sampled_lifetime": 15400, "env_to_module_sum_episodes_length_out": 10.368205581254823, "num_agent_steps_sampled": {"default_agent": 400}, "env_reset_timer": 0.0004992945905192755, "env_step_timer": 2.001415508278839e-05, "weights_seq_no": 3.0, "rlmodule_inference_timer": 4.7109376776399826e-05, "num_module_steps_sampled": {"default_policy": 400}, "agent_episode_returns_mean": {"default_agent": 0.48333333333333334}, "env_to_module_sum_episodes_length_in": 10.368205581254823, "episode_len_max": 20, "sample": 0.1900358895060839, "episode_len_min": 20, "num_module_steps_sampled_lifetime": {"default_policy": 1200}, "episode_return_max": 12.5, "num_agent_steps_sampled_lifetime": {"default_agent": 1200}, "num_env_steps_sampled": 400, "episode_return_min": -14.5, "episode_return_mean": 0.48333333333333334, "num_episodes_lifetime": 60, "num_episodes": 20, "time_between_sampling": 2.7308513233810663}, "num_healthy_workers": 1, "actor_manager_num_outstanding_async_reqs": 0, "num_remote_worker_restarts": 0}, "num_env_steps_sampled_lifetime": -607500.0, "fault_tolerance": {"num_healthy_workers": 0, "num_remote_worker_restarts": 0}, "env_runner_group": {"actor_manager_num_outstanding_async_reqs": 0}, "done": false, "training_iteration": 3, "trial_id": "4638e_00000", "date": "2025-08-11_19-33-10", "timestamp": 1754933590, "time_this_iter_s": 3.2430689334869385, "time_total_s": 9.834096670150757, "pid": 25862, "hostname": "Mac", "node_ip": "127.0.0.1", "config": {"exploration_config": {}, "extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "placement_strategy": "PACK", "num_gpus": 0, "_fake_gpus": false, "num_cpus_for_main_process": 2, "eager_tracing": true, "eager_max_retraces": 20, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "torch_compile_learner": false, "torch_compile_learner_what_to_compile": "forward_train", "torch_compile_learner_dynamo_backend": "aot_eager", "torch_compile_learner_dynamo_mode": null, "torch_compile_worker": false, "torch_compile_worker_dynamo_backend": "aot_eager", "torch_compile_worker_dynamo_mode": null, "torch_ddp_kwargs": {}, "torch_skip_nan_gradients": false, "env": "Umbrella", "env_config": {}, "observation_space": null, "action_space": null, "clip_rewards": null, "normalize_actions": true, "clip_actions": false, "_is_atari": null, "disable_env_checking": false, "render_env": false, "action_mask_key": "action_mask", "env_runner_cls": null, "num_env_runners": 0, "create_local_env_runner": true, "num_envs_per_env_runner": 1, "gym_env_vectorize_mode": "SYNC", "num_cpus_per_env_runner": 1, "num_gpus_per_env_runner": 0, "custom_resources_per_env_runner": {}, "validate_env_runners_after_construction": true, "episodes_to_numpy": true, "max_requests_in_flight_per_env_runner": 1, "sample_timeout_s": 60.0, "_env_to_module_connector": null, "add_default_connectors_to_env_to_module_pipeline": true, "_module_to_env_connector": null, "add_default_connectors_to_module_to_env_pipeline": true, "merge_env_runner_states": "training_only", "broadcast_env_runner_states": true, "episode_lookback_horizon": 1, "rollout_fragment_length": "auto", "batch_mode": "complete_episodes", "compress_observations": false, "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "enable_tf1_exec_eagerly": false, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "preprocessor_pref": "deepmind", "observation_filter": "NoFilter", "update_worker_filter_stats": true, "use_worker_filter_stats": true, "sampler_perf_stats_ema_coef": null, "_is_online": true, "num_learners": 0, "num_gpus_per_learner": 0, "num_cpus_per_learner": "auto", "num_aggregator_actors_per_learner": 0, "max_requests_in_flight_per_aggregator_actor": 3, "local_gpu_idx": 0, "max_requests_in_flight_per_learner": 3, "gamma": 1, "lr": 0.0002847858517, "grad_clip": 0.5, "grad_clip_by": "global_norm", "_train_batch_size_per_learner": 5000, "train_batch_size": 4000, "num_epochs": 1, "minibatch_size": 1000, "shuffle_batch_per_epoch": true, "model": {"fcnet_hiddens": [256, 256], "fcnet_activation": "tanh", "fcnet_weights_initializer": null, "fcnet_weights_initializer_config": null, "fcnet_bias_initializer": null, "fcnet_bias_initializer_config": null, "conv_filters": null, "conv_activation": "relu", "conv_kernel_initializer": null, "conv_kernel_initializer_config": null, "conv_bias_initializer": null, "conv_bias_initializer_config": null, "conv_transpose_kernel_initializer": null, "conv_transpose_kernel_initializer_config": null, "conv_transpose_bias_initializer": null, "conv_transpose_bias_initializer_config": null, "post_fcnet_hiddens": [], "post_fcnet_activation": "relu", "post_fcnet_weights_initializer": null, "post_fcnet_weights_initializer_config": null, "post_fcnet_bias_initializer": null, "post_fcnet_bias_initializer_config": null, "free_log_std": false, "log_std_clip_param": 20.0, "no_final_linear": false, "vf_share_layers": false, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "lstm_weights_initializer": null, "lstm_weights_initializer_config": null, "lstm_bias_initializer": null, "lstm_bias_initializer_config": null, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "attention_use_n_prev_actions": 0, "attention_use_n_prev_rewards": 0, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": null, "custom_model_config": {}, "custom_action_dist": null, "custom_preprocessor": null, "encoder_latent_dim": null, "always_check_shapes": false, "lstm_use_prev_action_reward": -1, "_use_default_native_models": -1, "_disable_preprocessor_api": false, "_disable_action_flattening": false}, "_learner_connector": null, "add_default_connectors_to_learner_pipeline": true, "learner_config_dict": {}, "optimizer": {}, "_learner_class": null, "callbacks_on_algorithm_init": null, "callbacks_on_env_runners_recreated": null, "callbacks_on_offline_eval_runners_recreated": null, "callbacks_on_checkpoint_loaded": null, "callbacks_on_environment_created": null, "callbacks_on_episode_created": null, "callbacks_on_episode_start": null, "callbacks_on_episode_step": null, "callbacks_on_episode_end": null, "callbacks_on_evaluate_start": null, "callbacks_on_evaluate_end": null, "callbacks_on_evaluate_offline_start": null, "callbacks_on_evaluate_offline_end": null, "callbacks_on_sample_end": null, "callbacks_on_train_result": null, "explore": true, "enable_rl_module_and_learner": true, "enable_env_runner_and_connector_v2": true, "_prior_exploration_config": {"type": "StochasticSampling"}, "count_steps_by": "env_steps", "policy_map_capacity": 100, "policy_mapping_fn": "<function AlgorithmConfig.DEFAULT_POLICY_MAPPING_FN at 0x161d55b20>", "policies_to_train": null, "policy_states_are_swappable": false, "observation_fn": null, "offline_data_class": null, "input_read_method": "read_parquet", "input_read_method_kwargs": {}, "input_read_schema": {}, "input_read_episodes": false, "input_read_sample_batches": false, "input_read_batch_size": null, "input_filesystem": null, "input_filesystem_kwargs": {}, "input_compress_columns": ["obs", "new_obs"], "input_spaces_jsonable": true, "materialize_data": false, "materialize_mapped_data": true, "map_batches_kwargs": {}, "iter_batches_kwargs": {}, "ignore_final_observation": false, "prelearner_class": null, "prelearner_buffer_class": null, "prelearner_buffer_kwargs": {}, "prelearner_module_synch_period": 10, "dataset_num_iters_per_learner": null, "input_config": {}, "actions_in_input_normalized": false, "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_config": {}, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "output_max_rows_per_file": null, "output_write_remaining_data": false, "output_write_method": "write_parquet", "output_write_method_kwargs": {}, "output_filesystem": null, "output_filesystem_kwargs": {}, "output_write_episodes": true, "offline_sampling": false, "evaluation_interval": 1, "evaluation_duration": 20, "evaluation_duration_unit": "episodes", "evaluation_sample_timeout_s": 120.0, "evaluation_auto_duration_min_env_steps_per_sample": 100, "evaluation_auto_duration_max_env_steps_per_sample": 2000, "evaluation_parallel_to_training": false, "evaluation_force_reset_envs_before_iteration": true, "evaluation_config": null, "off_policy_estimation_methods": {}, "ope_split_batch_by_episode": true, "evaluation_num_env_runners": 1, "in_evaluation": false, "sync_filters_on_rollout_workers_timeout_s": 10.0, "offline_evaluation_interval": null, "num_offline_eval_runners": 0, "offline_loss_for_module_fn": null, "offline_evaluation_duration": 1, "offline_evaluation_parallel_to_training": false, "offline_evaluation_timeout_s": 120.0, "num_cpus_per_offline_eval_runner": 1, "num_gpus_per_offline_eval_runner": 0, "custom_resources_per_offline_eval_runner": {}, "restart_failed_offline_eval_runners": true, "ignore_offline_eval_runner_failures": false, "max_num_offline_eval_runner_restarts": 1000, "offline_eval_runner_restore_timeout_s": 1800.0, "max_requests_in_flight_per_offline_eval_runner": 1, "validate_offline_eval_runners_after_construction": true, "offline_eval_runner_health_probe_timeout_s": 30.0, "offline_eval_rl_module_inference_only": false, "broadcast_offline_eval_runner_states": false, "offline_eval_batch_size_per_runner": 256, "dataset_num_iters_per_eval_runner": 1, "keep_per_episode_custom_metrics": false, "metrics_episode_collection_timeout_s": 60.0, "metrics_num_episodes_for_smoothing": 100, "min_time_s_per_iteration": null, "min_train_timesteps_per_iteration": 0, "min_sample_timesteps_per_iteration": 0, "log_gradients": true, "export_native_model_files": false, "checkpoint_trainable_policies_only": false, "logger_creator": null, "logger_config": null, "log_level": "WARN", "log_sys_usage": true, "fake_sampler": false, "seed": 4, "restart_failed_env_runners": true, "ignore_env_runner_failures": false, "max_num_env_runner_restarts": 1000, "delay_between_env_runner_restarts_s": 60.0, "restart_failed_sub_environments": false, "num_consecutive_env_runner_failures_tolerance": 100, "env_runner_health_probe_timeout_s": 30.0, "env_runner_restore_timeout_s": 1800.0, "_model_config": {}, "_rl_module_spec": "RLModuleSpec(module_class=None, observation_space=None, action_space=None, inference_only=False, learner_only=False, model_config=DefaultModelConfig(fcnet_hiddens=[60, 90], fcnet_activation='tanh', fcnet_kernel_initializer=None, fcnet_kernel_initializer_kwargs=None, fcnet_bias_initializer=None, fcnet_bias_initializer_kwargs=None, conv_filters=None, conv_activation='relu', conv_kernel_initializer=None, conv_kernel_initializer_kwargs=None, conv_bias_initializer=None, conv_bias_initializer_kwargs=None, head_fcnet_hiddens=[], head_fcnet_activation='relu', head_fcnet_kernel_initializer=None, head_fcnet_kernel_initializer_kwargs=None, head_fcnet_bias_initializer=None, head_fcnet_bias_initializer_kwargs=None, free_log_std=False, log_std_clip_param=20.0, vf_share_layers=True, use_lstm=False, max_seq_len=20, lstm_cell_size=256, lstm_use_prev_action=False, lstm_use_prev_reward=False, lstm_kernel_initializer=None, lstm_kernel_initializer_kwargs=None, lstm_bias_initializer=None, lstm_bias_initializer_kwargs=None), catalog_class=None, load_state_path=None, model_config_dict=None)", "algorithm_config_overrides_per_module": {}, "_per_module_overrides": {}, "_validate_config": true, "_use_msgpack_checkpoints": false, "_torch_grad_scaler_class": null, "_torch_lr_scheduler_classes": null, "_tf_policy_handles_more_than_one_loss": false, "_disable_preprocessor_api": false, "_disable_action_flattening": false, "_disable_initialize_loss_from_dummy_batch": false, "_dont_auto_sync_env_runner_states": false, "env_task_fn": -1, "enable_connectors": -1, "simple_optimizer": false, "policy_map_cache": -1, "worker_cls": -1, "synchronize_filters": -1, "enable_async_evaluation": -1, "custom_async_evaluation_function": -1, "_enable_rl_module_api": -1, "auto_wrap_old_gym_envs": -1, "always_attach_evaluation_results": -1, "replay_sequence_length": null, "_disable_execution_plan_api": -1, "use_critic": true, "use_gae": true, "use_kl_loss": true, "kl_coeff": 0.7464963036515, "kl_target": 0.0270990929592, "vf_loss_coeff": 0.6688075857018, "entropy_coeff": 0.0090570820258, "clip_param": 0.1221781641624, "vf_clip_param": 0.1027808522125, "entropy_coeff_schedule": null, "lr_schedule": null, "sgd_minibatch_size": -1, "vf_share_layers": -1, "__stdout_file__": null, "__stderr_file__": null, "lambda": 0.9099046732075, "input": "sampler", "policies": {"default_policy": [null, null, null, null]}, "callbacks": "<class 'ray.rllib.callbacks.callbacks.RLlibCallback'>", "create_env_on_driver": false, "custom_eval_function": null, "framework": "torch"}, "time_since_restore": 9.834096670150757, "iterations_since_restore": 3, "perf": {"cpu_util_percent": 62.65999999999999, "ram_util_percent": 77.67999999999999}}
{"timers": {"training_iteration": 3.4723479941181443, "restore_env_runners": 4.967344783828593e-05, "training_step": 3.4719933282129114, "env_runner_sampling_timer": 3.301482369816774, "learner_update_timer": 0.16335292904564122, "synch_weights": 0.0012283623038684018, "restore_eval_env_runners": 1.0820611310191452e-05, "evaluation_iteration": 0.20295043025341583, "synch_eval_env_connectors": 0.000467437508481089, "synch_env_connectors": 6.056804861873388e-06}, "env_runners": {"agent_episode_returns_mean": {"default_agent": 3.7799999999999994}, "env_to_module_connector": {"timers": {"connectors": {"add_time_dim_to_batch_and_zero_pad": 4.3147272237089985e-06, "add_states_from_episodes_to_batch": 2.638528436756043e-06, "numpy_to_tensor": 1.7079579214083506e-05, "add_observations_from_episodes_to_batch": 5.270936614924666e-06, "batch_individual_items": 1.2222771982591495e-05}}, "connector_pipeline_timer": 7.589449133765076e-05}, "episode_len_mean": 20.0, "episode_len_min": 20, "episode_return_max": 12.5, "num_agent_steps_sampled": {"default_agent": 5000.0}, "module_to_env_connector": {"timers": {"connectors": {"listify_data_for_vector_env": 1.951267331318124e-05, "tensor_to_numpy": 2.4380610611889004e-05, "normalize_and_clip_actions": 1.579979411151143e-05, "get_actions": 8.386911677071878e-05, "un_batch_to_individual_items": 9.251830369304267e-06, "remove_single_ts_time_rank_from_batch": 1.0106330408804284e-06}}, "connector_pipeline_timer": 0.0001970200659509944}, "num_env_steps_sampled": 5000.0, "episode_return_mean": 3.7799999999999994, "num_episodes_lifetime": -61250.0, "episode_return_min": -7.5, "time_between_sampling": 0.003084857752270121, "episode_len_max": 20, "env_reset_timer": 8.305109072793611e-05, "num_env_steps_sampled_lifetime": -1225000.0, "env_to_module_sum_episodes_length_in": 10.36823839457432, "sample": 0.009471059069812483, "num_episodes": 250.0, "num_module_steps_sampled_lifetime": {"default_policy": -1225000.0}, "module_episode_returns_mean": {"default_policy": 3.7799999999999994}, "env_step_timer": 2.7063846163104755e-05, "weights_seq_no": 3.0, "num_agent_steps_sampled_lifetime": {"default_agent": -1225000.0}, "rlmodule_inference_timer": 5.588884546530061e-05, "env_to_module_sum_episodes_length_out": 10.36823839457432, "num_module_steps_sampled": {"default_policy": 5000.0}, "episode_duration_sec_mean": 0.008484525684732942, "num_env_steps_sampled_lifetime_throughput": 2236.4625827910486}, "learners": {"__all_modules__": {"learner_connector": {"timers": {"connectors": {"numpy_to_tensor": 8.6113708279212e-05, "add_columns_from_episodes_to_train_batch": 0.050977949454037594, "add_observations_from_episodes_to_batch": 0.0018698782771918922, "add_states_from_episodes_to_batch": 4.825644097989425e-06, "general_advantage_estimation": 0.007173026287813554, "batch_individual_items": 0.03921961519197468, "add_one_ts_to_episodes_and_truncate": 0.009564277061637257, "add_time_dim_to_batch_and_zero_pad": 1.9145578962401482e-05}}, "connector_pipeline_timer": 0.10913038159102308}, "num_module_steps_trained_lifetime": 24000, "learner_connector_sum_episodes_length_in": 5000.0, "num_trainable_parameters": 6003, "learner_connector_sum_episodes_length_out": 5250.0, "num_env_steps_trained_lifetime": 126000, "num_module_steps_trained": 6000, "num_env_steps_trained": 31500, "num_non_trainable_parameters": 0, "num_env_steps_trained_lifetime_throughput": 1161962.0479674146, "num_module_steps_trained_throughput": 222840.87462510404, "num_module_steps_trained_lifetime_throughput": 221120.24953747148}, "default_policy": {"policy_loss": 0.1708587259054184, "mean_kl_loss": 0.0018568553496152163, "diff_num_grad_updates_vs_sampler_policy": 1.0, "num_module_steps_trained_lifetime": 24000, "entropy": 0.6815755367279053, "vf_explained_var": 0.01967012882232666, "gradients_default_optimizer_global_norm": 0.026392024010419846, "module_train_batch_size_mean": 1000.0, "weights_seq_no": 4.0, "total_loss": 0.23179858922958374, "curr_kl_coeff": 0.04665601998567581, "default_optimizer_learning_rate": 0.0002847858517, "vf_loss_unclipped": 28.318328857421875, "vf_loss": 0.10008808225393295, "curr_entropy_coeff": 0.0090570820258, "num_trainable_parameters": 6003, "num_module_steps_trained": 6000, "num_module_steps_trained_lifetime_throughput": 225952.93442512388}}, "num_training_step_calls_per_iteration": 1, "evaluation": {"env_runners": {"module_to_env_connector": {"timers": {"connectors": {"tensor_to_numpy": 2.5780662948918646e-05, "normalize_and_clip_actions": 1.8379377813015263e-05, "get_actions": 7.524324684068977e-05, "un_batch_to_individual_items": 1.012844353143357e-05, "remove_single_ts_time_rank_from_batch": 9.006726283521224e-07, "listify_data_for_vector_env": 2.1641434277310014e-05}}, "connector_pipeline_timer": 0.0001961596865459401}, "episode_duration_sec_mean": 0.009248246773495339, "module_episode_returns_mean": {"default_policy": 1.65}, "episode_len_mean": 20.0, "env_to_module_connector": {"timers": {"connectors": {"add_time_dim_to_batch_and_zero_pad": 4.053875711361627e-06, "add_states_from_episodes_to_batch": 2.9615130173823948e-06, "add_observations_from_episodes_to_batch": 4.449544248727967e-06, "batch_individual_items": 1.2110199466293078e-05, "numpy_to_tensor": 1.7851722148798583e-05}}, "connector_pipeline_timer": 7.525563502552061e-05}, "num_env_steps_sampled_lifetime": 20400, "env_to_module_sum_episodes_length_out": 10.368237912813044, "num_agent_steps_sampled": {"default_agent": 400}, "env_reset_timer": 0.0004952695553601952, "env_step_timer": 2.9890811879832572e-05, "weights_seq_no": 4.0, "rlmodule_inference_timer": 5.859608724136573e-05, "num_module_steps_sampled": {"default_policy": 400}, "agent_episode_returns_mean": {"default_agent": 1.65}, "env_to_module_sum_episodes_length_in": 10.368237912813044, "episode_len_max": 20, "sample": 0.19054205186198256, "episode_len_min": 20, "num_module_steps_sampled_lifetime": {"default_policy": 1600}, "episode_return_max": 12.5, "num_agent_steps_sampled_lifetime": {"default_agent": 1600}, "num_env_steps_sampled": 400, "episode_return_min": -14.5, "episode_return_mean": 1.65, "num_episodes_lifetime": 80, "num_episodes": 20, "time_between_sampling": 2.732356483896356}, "num_healthy_workers": 1, "actor_manager_num_outstanding_async_reqs": 0, "num_remote_worker_restarts": 0}, "num_env_steps_sampled_lifetime": -1225000.0, "fault_tolerance": {"num_healthy_workers": 0, "num_remote_worker_restarts": 0}, "env_runner_group": {"actor_manager_num_outstanding_async_reqs": 0}, "done": false, "training_iteration": 4, "trial_id": "4638e_00000", "date": "2025-08-11_19-33-13", "timestamp": 1754933593, "time_this_iter_s": 3.111844062805176, "time_total_s": 12.945940732955933, "pid": 25862, "hostname": "Mac", "node_ip": "127.0.0.1", "config": {"exploration_config": {}, "extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "placement_strategy": "PACK", "num_gpus": 0, "_fake_gpus": false, "num_cpus_for_main_process": 2, "eager_tracing": true, "eager_max_retraces": 20, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "torch_compile_learner": false, "torch_compile_learner_what_to_compile": "forward_train", "torch_compile_learner_dynamo_backend": "aot_eager", "torch_compile_learner_dynamo_mode": null, "torch_compile_worker": false, "torch_compile_worker_dynamo_backend": "aot_eager", "torch_compile_worker_dynamo_mode": null, "torch_ddp_kwargs": {}, "torch_skip_nan_gradients": false, "env": "Umbrella", "env_config": {}, "observation_space": null, "action_space": null, "clip_rewards": null, "normalize_actions": true, "clip_actions": false, "_is_atari": null, "disable_env_checking": false, "render_env": false, "action_mask_key": "action_mask", "env_runner_cls": null, "num_env_runners": 0, "create_local_env_runner": true, "num_envs_per_env_runner": 1, "gym_env_vectorize_mode": "SYNC", "num_cpus_per_env_runner": 1, "num_gpus_per_env_runner": 0, "custom_resources_per_env_runner": {}, "validate_env_runners_after_construction": true, "episodes_to_numpy": true, "max_requests_in_flight_per_env_runner": 1, "sample_timeout_s": 60.0, "_env_to_module_connector": null, "add_default_connectors_to_env_to_module_pipeline": true, "_module_to_env_connector": null, "add_default_connectors_to_module_to_env_pipeline": true, "merge_env_runner_states": "training_only", "broadcast_env_runner_states": true, "episode_lookback_horizon": 1, "rollout_fragment_length": "auto", "batch_mode": "complete_episodes", "compress_observations": false, "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "enable_tf1_exec_eagerly": false, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "preprocessor_pref": "deepmind", "observation_filter": "NoFilter", "update_worker_filter_stats": true, "use_worker_filter_stats": true, "sampler_perf_stats_ema_coef": null, "_is_online": true, "num_learners": 0, "num_gpus_per_learner": 0, "num_cpus_per_learner": "auto", "num_aggregator_actors_per_learner": 0, "max_requests_in_flight_per_aggregator_actor": 3, "local_gpu_idx": 0, "max_requests_in_flight_per_learner": 3, "gamma": 1, "lr": 0.0002847858517, "grad_clip": 0.5, "grad_clip_by": "global_norm", "_train_batch_size_per_learner": 5000, "train_batch_size": 4000, "num_epochs": 1, "minibatch_size": 1000, "shuffle_batch_per_epoch": true, "model": {"fcnet_hiddens": [256, 256], "fcnet_activation": "tanh", "fcnet_weights_initializer": null, "fcnet_weights_initializer_config": null, "fcnet_bias_initializer": null, "fcnet_bias_initializer_config": null, "conv_filters": null, "conv_activation": "relu", "conv_kernel_initializer": null, "conv_kernel_initializer_config": null, "conv_bias_initializer": null, "conv_bias_initializer_config": null, "conv_transpose_kernel_initializer": null, "conv_transpose_kernel_initializer_config": null, "conv_transpose_bias_initializer": null, "conv_transpose_bias_initializer_config": null, "post_fcnet_hiddens": [], "post_fcnet_activation": "relu", "post_fcnet_weights_initializer": null, "post_fcnet_weights_initializer_config": null, "post_fcnet_bias_initializer": null, "post_fcnet_bias_initializer_config": null, "free_log_std": false, "log_std_clip_param": 20.0, "no_final_linear": false, "vf_share_layers": false, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "lstm_weights_initializer": null, "lstm_weights_initializer_config": null, "lstm_bias_initializer": null, "lstm_bias_initializer_config": null, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "attention_use_n_prev_actions": 0, "attention_use_n_prev_rewards": 0, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": null, "custom_model_config": {}, "custom_action_dist": null, "custom_preprocessor": null, "encoder_latent_dim": null, "always_check_shapes": false, "lstm_use_prev_action_reward": -1, "_use_default_native_models": -1, "_disable_preprocessor_api": false, "_disable_action_flattening": false}, "_learner_connector": null, "add_default_connectors_to_learner_pipeline": true, "learner_config_dict": {}, "optimizer": {}, "_learner_class": null, "callbacks_on_algorithm_init": null, "callbacks_on_env_runners_recreated": null, "callbacks_on_offline_eval_runners_recreated": null, "callbacks_on_checkpoint_loaded": null, "callbacks_on_environment_created": null, "callbacks_on_episode_created": null, "callbacks_on_episode_start": null, "callbacks_on_episode_step": null, "callbacks_on_episode_end": null, "callbacks_on_evaluate_start": null, "callbacks_on_evaluate_end": null, "callbacks_on_evaluate_offline_start": null, "callbacks_on_evaluate_offline_end": null, "callbacks_on_sample_end": null, "callbacks_on_train_result": null, "explore": true, "enable_rl_module_and_learner": true, "enable_env_runner_and_connector_v2": true, "_prior_exploration_config": {"type": "StochasticSampling"}, "count_steps_by": "env_steps", "policy_map_capacity": 100, "policy_mapping_fn": "<function AlgorithmConfig.DEFAULT_POLICY_MAPPING_FN at 0x161d55b20>", "policies_to_train": null, "policy_states_are_swappable": false, "observation_fn": null, "offline_data_class": null, "input_read_method": "read_parquet", "input_read_method_kwargs": {}, "input_read_schema": {}, "input_read_episodes": false, "input_read_sample_batches": false, "input_read_batch_size": null, "input_filesystem": null, "input_filesystem_kwargs": {}, "input_compress_columns": ["obs", "new_obs"], "input_spaces_jsonable": true, "materialize_data": false, "materialize_mapped_data": true, "map_batches_kwargs": {}, "iter_batches_kwargs": {}, "ignore_final_observation": false, "prelearner_class": null, "prelearner_buffer_class": null, "prelearner_buffer_kwargs": {}, "prelearner_module_synch_period": 10, "dataset_num_iters_per_learner": null, "input_config": {}, "actions_in_input_normalized": false, "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_config": {}, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "output_max_rows_per_file": null, "output_write_remaining_data": false, "output_write_method": "write_parquet", "output_write_method_kwargs": {}, "output_filesystem": null, "output_filesystem_kwargs": {}, "output_write_episodes": true, "offline_sampling": false, "evaluation_interval": 1, "evaluation_duration": 20, "evaluation_duration_unit": "episodes", "evaluation_sample_timeout_s": 120.0, "evaluation_auto_duration_min_env_steps_per_sample": 100, "evaluation_auto_duration_max_env_steps_per_sample": 2000, "evaluation_parallel_to_training": false, "evaluation_force_reset_envs_before_iteration": true, "evaluation_config": null, "off_policy_estimation_methods": {}, "ope_split_batch_by_episode": true, "evaluation_num_env_runners": 1, "in_evaluation": false, "sync_filters_on_rollout_workers_timeout_s": 10.0, "offline_evaluation_interval": null, "num_offline_eval_runners": 0, "offline_loss_for_module_fn": null, "offline_evaluation_duration": 1, "offline_evaluation_parallel_to_training": false, "offline_evaluation_timeout_s": 120.0, "num_cpus_per_offline_eval_runner": 1, "num_gpus_per_offline_eval_runner": 0, "custom_resources_per_offline_eval_runner": {}, "restart_failed_offline_eval_runners": true, "ignore_offline_eval_runner_failures": false, "max_num_offline_eval_runner_restarts": 1000, "offline_eval_runner_restore_timeout_s": 1800.0, "max_requests_in_flight_per_offline_eval_runner": 1, "validate_offline_eval_runners_after_construction": true, "offline_eval_runner_health_probe_timeout_s": 30.0, "offline_eval_rl_module_inference_only": false, "broadcast_offline_eval_runner_states": false, "offline_eval_batch_size_per_runner": 256, "dataset_num_iters_per_eval_runner": 1, "keep_per_episode_custom_metrics": false, "metrics_episode_collection_timeout_s": 60.0, "metrics_num_episodes_for_smoothing": 100, "min_time_s_per_iteration": null, "min_train_timesteps_per_iteration": 0, "min_sample_timesteps_per_iteration": 0, "log_gradients": true, "export_native_model_files": false, "checkpoint_trainable_policies_only": false, "logger_creator": null, "logger_config": null, "log_level": "WARN", "log_sys_usage": true, "fake_sampler": false, "seed": 4, "restart_failed_env_runners": true, "ignore_env_runner_failures": false, "max_num_env_runner_restarts": 1000, "delay_between_env_runner_restarts_s": 60.0, "restart_failed_sub_environments": false, "num_consecutive_env_runner_failures_tolerance": 100, "env_runner_health_probe_timeout_s": 30.0, "env_runner_restore_timeout_s": 1800.0, "_model_config": {}, "_rl_module_spec": "RLModuleSpec(module_class=None, observation_space=None, action_space=None, inference_only=False, learner_only=False, model_config=DefaultModelConfig(fcnet_hiddens=[60, 90], fcnet_activation='tanh', fcnet_kernel_initializer=None, fcnet_kernel_initializer_kwargs=None, fcnet_bias_initializer=None, fcnet_bias_initializer_kwargs=None, conv_filters=None, conv_activation='relu', conv_kernel_initializer=None, conv_kernel_initializer_kwargs=None, conv_bias_initializer=None, conv_bias_initializer_kwargs=None, head_fcnet_hiddens=[], head_fcnet_activation='relu', head_fcnet_kernel_initializer=None, head_fcnet_kernel_initializer_kwargs=None, head_fcnet_bias_initializer=None, head_fcnet_bias_initializer_kwargs=None, free_log_std=False, log_std_clip_param=20.0, vf_share_layers=True, use_lstm=False, max_seq_len=20, lstm_cell_size=256, lstm_use_prev_action=False, lstm_use_prev_reward=False, lstm_kernel_initializer=None, lstm_kernel_initializer_kwargs=None, lstm_bias_initializer=None, lstm_bias_initializer_kwargs=None), catalog_class=None, load_state_path=None, model_config_dict=None)", "algorithm_config_overrides_per_module": {}, "_per_module_overrides": {}, "_validate_config": true, "_use_msgpack_checkpoints": false, "_torch_grad_scaler_class": null, "_torch_lr_scheduler_classes": null, "_tf_policy_handles_more_than_one_loss": false, "_disable_preprocessor_api": false, "_disable_action_flattening": false, "_disable_initialize_loss_from_dummy_batch": false, "_dont_auto_sync_env_runner_states": false, "env_task_fn": -1, "enable_connectors": -1, "simple_optimizer": false, "policy_map_cache": -1, "worker_cls": -1, "synchronize_filters": -1, "enable_async_evaluation": -1, "custom_async_evaluation_function": -1, "_enable_rl_module_api": -1, "auto_wrap_old_gym_envs": -1, "always_attach_evaluation_results": -1, "replay_sequence_length": null, "_disable_execution_plan_api": -1, "use_critic": true, "use_gae": true, "use_kl_loss": true, "kl_coeff": 0.7464963036515, "kl_target": 0.0270990929592, "vf_loss_coeff": 0.6688075857018, "entropy_coeff": 0.0090570820258, "clip_param": 0.1221781641624, "vf_clip_param": 0.1027808522125, "entropy_coeff_schedule": null, "lr_schedule": null, "sgd_minibatch_size": -1, "vf_share_layers": -1, "__stdout_file__": null, "__stderr_file__": null, "lambda": 0.9099046732075, "input": "sampler", "policies": {"default_policy": [null, null, null, null]}, "callbacks": "<class 'ray.rllib.callbacks.callbacks.RLlibCallback'>", "create_env_on_driver": false, "custom_eval_function": null, "framework": "torch"}, "time_since_restore": 12.945940732955933, "iterations_since_restore": 4, "perf": {"cpu_util_percent": 36.925, "ram_util_percent": 77.8}}
{"timers": {"training_iteration": 3.469684497507509, "restore_env_runners": 4.9240462390135495e-05, "training_step": 3.4693312295103915, "env_runner_sampling_timer": 3.2983615869578875, "learner_update_timer": 0.16383021975454623, "synch_weights": 0.001223870761116608, "restore_eval_env_runners": 1.0875324947526679e-05, "evaluation_iteration": 0.20340342179082208, "synch_eval_env_connectors": 0.0004657893834476126, "synch_env_connectors": 6.048326849006116e-06}, "env_runners": {"agent_episode_returns_mean": {"default_agent": 4.5}, "env_to_module_connector": {"timers": {"connectors": {"add_time_dim_to_batch_and_zero_pad": 4.897203061321183e-06, "add_states_from_episodes_to_batch": 2.9356125012445086e-06, "numpy_to_tensor": 1.9407599310234654e-05, "add_observations_from_episodes_to_batch": 5.79415091952853e-06, "batch_individual_items": 1.3134282843557032e-05}}, "connector_pipeline_timer": 8.369624416877163e-05}, "episode_len_mean": 20.0, "episode_len_min": 20, "episode_return_max": 12.5, "num_agent_steps_sampled": {"default_agent": 5000.0}, "module_to_env_connector": {"timers": {"connectors": {"listify_data_for_vector_env": 2.1945540856294722e-05, "tensor_to_numpy": 2.7505687658083215e-05, "normalize_and_clip_actions": 1.7914874605934356e-05, "get_actions": 9.835469835962718e-05, "un_batch_to_individual_items": 1.0160918631809733e-05, "remove_single_ts_time_rank_from_batch": 1.1230703892761304e-06}}, "connector_pipeline_timer": 0.00022478552563747189}, "num_env_steps_sampled": 5000.0, "episode_return_mean": 4.5, "num_episodes_lifetime": -92125.0, "episode_return_min": -7.5, "time_between_sampling": 0.0030656523014185185, "episode_len_max": 20, "env_reset_timer": 8.781821681089573e-05, "num_env_steps_sampled_lifetime": -1842500.0, "env_to_module_sum_episodes_length_in": 10.36823839457432, "sample": 0.009930888023925933, "num_episodes": 250.0, "num_module_steps_sampled_lifetime": {"default_policy": -1842500.0}, "module_episode_returns_mean": {"default_policy": 4.5}, "env_step_timer": 2.992570608303922e-05, "weights_seq_no": 4.0, "num_agent_steps_sampled_lifetime": {"default_agent": -1842500.0}, "rlmodule_inference_timer": 9.118463151017946e-05, "env_to_module_sum_episodes_length_out": 10.36823839457432, "num_module_steps_sampled": {"default_policy": 5000.0}, "episode_duration_sec_mean": 0.0101151900049299, "num_env_steps_sampled_lifetime_throughput": 2102.606077349689}, "learners": {"__all_modules__": {"learner_connector": {"timers": {"connectors": {"numpy_to_tensor": 8.700799084932891e-05, "add_columns_from_episodes_to_train_batch": 0.05135921661975099, "add_observations_from_episodes_to_batch": 0.001867558244280424, "add_states_from_episodes_to_batch": 4.815718565874267e-06, "general_advantage_estimation": 0.0072173247757163885, "batch_individual_items": 0.03946785821000199, "add_one_ts_to_episodes_and_truncate": 0.009597343871770157, "add_time_dim_to_batch_and_zero_pad": 1.9081623561548763e-05}}, "connector_pipeline_timer": 0.10983640652478442}, "num_module_steps_trained_lifetime": 30000, "learner_connector_sum_episodes_length_in": 5000.0, "num_trainable_parameters": 6003, "learner_connector_sum_episodes_length_out": 5250.0, "num_env_steps_trained_lifetime": 157500, "num_module_steps_trained": 6000, "num_env_steps_trained": 31500, "num_non_trainable_parameters": 0, "num_env_steps_trained_lifetime_throughput": 1154768.2603878533, "num_module_steps_trained_throughput": 221404.38179312073, "num_module_steps_trained_lifetime_throughput": 219740.79067911772}, "default_policy": {"policy_loss": 0.09948650747537613, "mean_kl_loss": 0.001579137286171317, "diff_num_grad_updates_vs_sampler_policy": 1.0, "num_module_steps_trained_lifetime": 30000, "entropy": 0.6678587794303894, "vf_explained_var": 0.02140355110168457, "gradients_default_optimizer_global_norm": 0.055656589567661285, "module_train_batch_size_mean": 1000.0, "weights_seq_no": 5.0, "total_loss": 0.16066518425941467, "curr_kl_coeff": 0.023328009992837906, "default_optimizer_learning_rate": 0.0002847858517, "vf_loss_unclipped": 28.426040649414062, "vf_loss": 0.1004083901643753, "curr_entropy_coeff": 0.0090570820258, "num_trainable_parameters": 6003, "num_module_steps_trained": 6000, "num_module_steps_trained_lifetime_throughput": 224397.88437096868}}, "num_training_step_calls_per_iteration": 1, "evaluation": {"env_runners": {"module_to_env_connector": {"timers": {"connectors": {"tensor_to_numpy": 1.85346270502157e-05, "normalize_and_clip_actions": 1.3329331354065196e-05, "get_actions": 6.593696495411074e-05, "un_batch_to_individual_items": 7.049030677918687e-06, "remove_single_ts_time_rank_from_batch": 7.848773354734364e-07, "listify_data_for_vector_env": 1.9083789124324916e-05}}, "connector_pipeline_timer": 0.0001653547328456941}, "episode_duration_sec_mean": 0.008909949474036694, "module_episode_returns_mean": {"default_policy": 1.35}, "episode_len_mean": 20.0, "env_to_module_connector": {"timers": {"connectors": {"add_time_dim_to_batch_and_zero_pad": 3.3945055924165215e-06, "add_states_from_episodes_to_batch": 2.101631051618314e-06, "add_observations_from_episodes_to_batch": 4.161268183214217e-06, "batch_individual_items": 9.37005076746724e-06, "numpy_to_tensor": 1.2882236443395156e-05}}, "connector_pipeline_timer": 6.179316776348265e-05}, "num_env_steps_sampled_lifetime": 25400, "env_to_module_sum_episodes_length_out": 10.368238387501162, "num_agent_steps_sampled": {"default_agent": 400}, "env_reset_timer": 0.0004910843604120275, "env_step_timer": 2.7307576916879274e-05, "weights_seq_no": 5.0, "rlmodule_inference_timer": 4.5762709236520885e-05, "num_module_steps_sampled": {"default_policy": 400}, "agent_episode_returns_mean": {"default_agent": 1.35}, "env_to_module_sum_episodes_length_in": 10.368238387501162, "episode_len_max": 20, "sample": 0.1902856792631446, "episode_len_min": 20, "num_module_steps_sampled_lifetime": {"default_policy": 2000}, "episode_return_max": 12.5, "num_agent_steps_sampled_lifetime": {"default_agent": 2000}, "num_env_steps_sampled": 400, "episode_return_min": -16.5, "episode_return_mean": 1.35, "num_episodes_lifetime": 100, "num_episodes": 20, "time_between_sampling": 2.7373635228071165}, "num_healthy_workers": 1, "actor_manager_num_outstanding_async_reqs": 0, "num_remote_worker_restarts": 0}, "num_env_steps_sampled_lifetime": -1842500.0, "fault_tolerance": {"num_healthy_workers": 0, "num_remote_worker_restarts": 0}, "env_runner_group": {"actor_manager_num_outstanding_async_reqs": 0}, "done": false, "training_iteration": 5, "trial_id": "4638e_00000", "date": "2025-08-11_19-33-17", "timestamp": 1754933597, "time_this_iter_s": 3.3798577785491943, "time_total_s": 16.325798511505127, "pid": 25862, "hostname": "Mac", "node_ip": "127.0.0.1", "config": {"exploration_config": {}, "extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "placement_strategy": "PACK", "num_gpus": 0, "_fake_gpus": false, "num_cpus_for_main_process": 2, "eager_tracing": true, "eager_max_retraces": 20, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "torch_compile_learner": false, "torch_compile_learner_what_to_compile": "forward_train", "torch_compile_learner_dynamo_backend": "aot_eager", "torch_compile_learner_dynamo_mode": null, "torch_compile_worker": false, "torch_compile_worker_dynamo_backend": "aot_eager", "torch_compile_worker_dynamo_mode": null, "torch_ddp_kwargs": {}, "torch_skip_nan_gradients": false, "env": "Umbrella", "env_config": {}, "observation_space": null, "action_space": null, "clip_rewards": null, "normalize_actions": true, "clip_actions": false, "_is_atari": null, "disable_env_checking": false, "render_env": false, "action_mask_key": "action_mask", "env_runner_cls": null, "num_env_runners": 0, "create_local_env_runner": true, "num_envs_per_env_runner": 1, "gym_env_vectorize_mode": "SYNC", "num_cpus_per_env_runner": 1, "num_gpus_per_env_runner": 0, "custom_resources_per_env_runner": {}, "validate_env_runners_after_construction": true, "episodes_to_numpy": true, "max_requests_in_flight_per_env_runner": 1, "sample_timeout_s": 60.0, "_env_to_module_connector": null, "add_default_connectors_to_env_to_module_pipeline": true, "_module_to_env_connector": null, "add_default_connectors_to_module_to_env_pipeline": true, "merge_env_runner_states": "training_only", "broadcast_env_runner_states": true, "episode_lookback_horizon": 1, "rollout_fragment_length": "auto", "batch_mode": "complete_episodes", "compress_observations": false, "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "enable_tf1_exec_eagerly": false, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "preprocessor_pref": "deepmind", "observation_filter": "NoFilter", "update_worker_filter_stats": true, "use_worker_filter_stats": true, "sampler_perf_stats_ema_coef": null, "_is_online": true, "num_learners": 0, "num_gpus_per_learner": 0, "num_cpus_per_learner": "auto", "num_aggregator_actors_per_learner": 0, "max_requests_in_flight_per_aggregator_actor": 3, "local_gpu_idx": 0, "max_requests_in_flight_per_learner": 3, "gamma": 1, "lr": 0.0002847858517, "grad_clip": 0.5, "grad_clip_by": "global_norm", "_train_batch_size_per_learner": 5000, "train_batch_size": 4000, "num_epochs": 1, "minibatch_size": 1000, "shuffle_batch_per_epoch": true, "model": {"fcnet_hiddens": [256, 256], "fcnet_activation": "tanh", "fcnet_weights_initializer": null, "fcnet_weights_initializer_config": null, "fcnet_bias_initializer": null, "fcnet_bias_initializer_config": null, "conv_filters": null, "conv_activation": "relu", "conv_kernel_initializer": null, "conv_kernel_initializer_config": null, "conv_bias_initializer": null, "conv_bias_initializer_config": null, "conv_transpose_kernel_initializer": null, "conv_transpose_kernel_initializer_config": null, "conv_transpose_bias_initializer": null, "conv_transpose_bias_initializer_config": null, "post_fcnet_hiddens": [], "post_fcnet_activation": "relu", "post_fcnet_weights_initializer": null, "post_fcnet_weights_initializer_config": null, "post_fcnet_bias_initializer": null, "post_fcnet_bias_initializer_config": null, "free_log_std": false, "log_std_clip_param": 20.0, "no_final_linear": false, "vf_share_layers": false, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "lstm_weights_initializer": null, "lstm_weights_initializer_config": null, "lstm_bias_initializer": null, "lstm_bias_initializer_config": null, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "attention_use_n_prev_actions": 0, "attention_use_n_prev_rewards": 0, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": null, "custom_model_config": {}, "custom_action_dist": null, "custom_preprocessor": null, "encoder_latent_dim": null, "always_check_shapes": false, "lstm_use_prev_action_reward": -1, "_use_default_native_models": -1, "_disable_preprocessor_api": false, "_disable_action_flattening": false}, "_learner_connector": null, "add_default_connectors_to_learner_pipeline": true, "learner_config_dict": {}, "optimizer": {}, "_learner_class": null, "callbacks_on_algorithm_init": null, "callbacks_on_env_runners_recreated": null, "callbacks_on_offline_eval_runners_recreated": null, "callbacks_on_checkpoint_loaded": null, "callbacks_on_environment_created": null, "callbacks_on_episode_created": null, "callbacks_on_episode_start": null, "callbacks_on_episode_step": null, "callbacks_on_episode_end": null, "callbacks_on_evaluate_start": null, "callbacks_on_evaluate_end": null, "callbacks_on_evaluate_offline_start": null, "callbacks_on_evaluate_offline_end": null, "callbacks_on_sample_end": null, "callbacks_on_train_result": null, "explore": true, "enable_rl_module_and_learner": true, "enable_env_runner_and_connector_v2": true, "_prior_exploration_config": {"type": "StochasticSampling"}, "count_steps_by": "env_steps", "policy_map_capacity": 100, "policy_mapping_fn": "<function AlgorithmConfig.DEFAULT_POLICY_MAPPING_FN at 0x161d55b20>", "policies_to_train": null, "policy_states_are_swappable": false, "observation_fn": null, "offline_data_class": null, "input_read_method": "read_parquet", "input_read_method_kwargs": {}, "input_read_schema": {}, "input_read_episodes": false, "input_read_sample_batches": false, "input_read_batch_size": null, "input_filesystem": null, "input_filesystem_kwargs": {}, "input_compress_columns": ["obs", "new_obs"], "input_spaces_jsonable": true, "materialize_data": false, "materialize_mapped_data": true, "map_batches_kwargs": {}, "iter_batches_kwargs": {}, "ignore_final_observation": false, "prelearner_class": null, "prelearner_buffer_class": null, "prelearner_buffer_kwargs": {}, "prelearner_module_synch_period": 10, "dataset_num_iters_per_learner": null, "input_config": {}, "actions_in_input_normalized": false, "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_config": {}, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "output_max_rows_per_file": null, "output_write_remaining_data": false, "output_write_method": "write_parquet", "output_write_method_kwargs": {}, "output_filesystem": null, "output_filesystem_kwargs": {}, "output_write_episodes": true, "offline_sampling": false, "evaluation_interval": 1, "evaluation_duration": 20, "evaluation_duration_unit": "episodes", "evaluation_sample_timeout_s": 120.0, "evaluation_auto_duration_min_env_steps_per_sample": 100, "evaluation_auto_duration_max_env_steps_per_sample": 2000, "evaluation_parallel_to_training": false, "evaluation_force_reset_envs_before_iteration": true, "evaluation_config": null, "off_policy_estimation_methods": {}, "ope_split_batch_by_episode": true, "evaluation_num_env_runners": 1, "in_evaluation": false, "sync_filters_on_rollout_workers_timeout_s": 10.0, "offline_evaluation_interval": null, "num_offline_eval_runners": 0, "offline_loss_for_module_fn": null, "offline_evaluation_duration": 1, "offline_evaluation_parallel_to_training": false, "offline_evaluation_timeout_s": 120.0, "num_cpus_per_offline_eval_runner": 1, "num_gpus_per_offline_eval_runner": 0, "custom_resources_per_offline_eval_runner": {}, "restart_failed_offline_eval_runners": true, "ignore_offline_eval_runner_failures": false, "max_num_offline_eval_runner_restarts": 1000, "offline_eval_runner_restore_timeout_s": 1800.0, "max_requests_in_flight_per_offline_eval_runner": 1, "validate_offline_eval_runners_after_construction": true, "offline_eval_runner_health_probe_timeout_s": 30.0, "offline_eval_rl_module_inference_only": false, "broadcast_offline_eval_runner_states": false, "offline_eval_batch_size_per_runner": 256, "dataset_num_iters_per_eval_runner": 1, "keep_per_episode_custom_metrics": false, "metrics_episode_collection_timeout_s": 60.0, "metrics_num_episodes_for_smoothing": 100, "min_time_s_per_iteration": null, "min_train_timesteps_per_iteration": 0, "min_sample_timesteps_per_iteration": 0, "log_gradients": true, "export_native_model_files": false, "checkpoint_trainable_policies_only": false, "logger_creator": null, "logger_config": null, "log_level": "WARN", "log_sys_usage": true, "fake_sampler": false, "seed": 4, "restart_failed_env_runners": true, "ignore_env_runner_failures": false, "max_num_env_runner_restarts": 1000, "delay_between_env_runner_restarts_s": 60.0, "restart_failed_sub_environments": false, "num_consecutive_env_runner_failures_tolerance": 100, "env_runner_health_probe_timeout_s": 30.0, "env_runner_restore_timeout_s": 1800.0, "_model_config": {}, "_rl_module_spec": "RLModuleSpec(module_class=None, observation_space=None, action_space=None, inference_only=False, learner_only=False, model_config=DefaultModelConfig(fcnet_hiddens=[60, 90], fcnet_activation='tanh', fcnet_kernel_initializer=None, fcnet_kernel_initializer_kwargs=None, fcnet_bias_initializer=None, fcnet_bias_initializer_kwargs=None, conv_filters=None, conv_activation='relu', conv_kernel_initializer=None, conv_kernel_initializer_kwargs=None, conv_bias_initializer=None, conv_bias_initializer_kwargs=None, head_fcnet_hiddens=[], head_fcnet_activation='relu', head_fcnet_kernel_initializer=None, head_fcnet_kernel_initializer_kwargs=None, head_fcnet_bias_initializer=None, head_fcnet_bias_initializer_kwargs=None, free_log_std=False, log_std_clip_param=20.0, vf_share_layers=True, use_lstm=False, max_seq_len=20, lstm_cell_size=256, lstm_use_prev_action=False, lstm_use_prev_reward=False, lstm_kernel_initializer=None, lstm_kernel_initializer_kwargs=None, lstm_bias_initializer=None, lstm_bias_initializer_kwargs=None), catalog_class=None, load_state_path=None, model_config_dict=None)", "algorithm_config_overrides_per_module": {}, "_per_module_overrides": {}, "_validate_config": true, "_use_msgpack_checkpoints": false, "_torch_grad_scaler_class": null, "_torch_lr_scheduler_classes": null, "_tf_policy_handles_more_than_one_loss": false, "_disable_preprocessor_api": false, "_disable_action_flattening": false, "_disable_initialize_loss_from_dummy_batch": false, "_dont_auto_sync_env_runner_states": false, "env_task_fn": -1, "enable_connectors": -1, "simple_optimizer": false, "policy_map_cache": -1, "worker_cls": -1, "synchronize_filters": -1, "enable_async_evaluation": -1, "custom_async_evaluation_function": -1, "_enable_rl_module_api": -1, "auto_wrap_old_gym_envs": -1, "always_attach_evaluation_results": -1, "replay_sequence_length": null, "_disable_execution_plan_api": -1, "use_critic": true, "use_gae": true, "use_kl_loss": true, "kl_coeff": 0.7464963036515, "kl_target": 0.0270990929592, "vf_loss_coeff": 0.6688075857018, "entropy_coeff": 0.0090570820258, "clip_param": 0.1221781641624, "vf_clip_param": 0.1027808522125, "entropy_coeff_schedule": null, "lr_schedule": null, "sgd_minibatch_size": -1, "vf_share_layers": -1, "__stdout_file__": null, "__stderr_file__": null, "lambda": 0.9099046732075, "input": "sampler", "policies": {"default_policy": [null, null, null, null]}, "callbacks": "<class 'ray.rllib.callbacks.callbacks.RLlibCallback'>", "create_env_on_driver": false, "custom_eval_function": null, "framework": "torch"}, "time_since_restore": 16.325798511505127, "iterations_since_restore": 5, "perf": {"cpu_util_percent": 61.98, "ram_util_percent": 78.05999999999999}}
{"timers": {"training_iteration": 3.468637437122086, "restore_env_runners": 4.881722825800405e-05, "training_step": 3.4682854130552654, "env_runner_sampling_timer": 3.295925246498808, "learner_update_timer": 0.16523665921712447, "synch_weights": 0.0012252099729588243, "restore_eval_env_runners": 1.0830742151748856e-05, "evaluation_iteration": 0.20307283507222632, "synch_eval_env_connectors": 0.0004622052393490879, "synch_env_connectors": 6.033673964412882e-06}, "env_runners": {"agent_episode_returns_mean": {"default_agent": 6.3400000000000025}, "env_to_module_connector": {"timers": {"connectors": {"add_time_dim_to_batch_and_zero_pad": 5.528746144899531e-06, "add_states_from_episodes_to_batch": 3.222644540786804e-06, "numpy_to_tensor": 2.1307326754980106e-05, "add_observations_from_episodes_to_batch": 5.939660651373958e-06, "batch_individual_items": 1.4614691236402072e-05}}, "connector_pipeline_timer": 9.084027379396258e-05}, "episode_len_mean": 20.0, "episode_len_min": 20, "episode_return_max": 12.5, "num_agent_steps_sampled": {"default_agent": 5000.0}, "module_to_env_connector": {"timers": {"connectors": {"listify_data_for_vector_env": 2.2783729584913244e-05, "tensor_to_numpy": 2.9655651644022972e-05, "normalize_and_clip_actions": 1.9247798087529112e-05, "get_actions": 0.00010550069551093192, "un_batch_to_individual_items": 1.0337705926362282e-05, "remove_single_ts_time_rank_from_batch": 1.093200265082468e-06}}, "connector_pipeline_timer": 0.0002389553448376279}, "num_env_steps_sampled": 5000.0, "episode_return_mean": 6.3400000000000025, "num_episodes_lifetime": -123000.0, "episode_return_min": -7.5, "time_between_sampling": 0.002918592999497227, "episode_len_max": 20, "env_reset_timer": 9.861697345428453e-05, "num_env_steps_sampled_lifetime": -2460000.0, "env_to_module_sum_episodes_length_in": 10.36823839457432, "sample": 0.011679284849315588, "num_episodes": 250.0, "num_module_steps_sampled_lifetime": {"default_policy": -2460000.0}, "module_episode_returns_mean": {"default_policy": 6.3400000000000025}, "env_step_timer": 3.305000751588074e-05, "weights_seq_no": 5.0, "num_agent_steps_sampled_lifetime": {"default_agent": -2460000.0}, "rlmodule_inference_timer": 6.796849194454638e-05, "env_to_module_sum_episodes_length_out": 10.36823839457432, "num_module_steps_sampled": {"default_policy": 5000.0}, "episode_duration_sec_mean": 0.010262960673309863, "num_env_steps_sampled_lifetime_throughput": 1983.2107677213473}, "learners": {"__all_modules__": {"learner_connector": {"timers": {"connectors": {"numpy_to_tensor": 8.694000086669103e-05, "add_columns_from_episodes_to_train_batch": 0.051388566124418306, "add_observations_from_episodes_to_batch": 0.0018731772519494417, "add_states_from_episodes_to_batch": 4.802561646722793e-06, "general_advantage_estimation": 0.007218729447934148, "batch_individual_items": 0.04105946879777415, "add_one_ts_to_episodes_and_truncate": 0.009625294183413883, "add_time_dim_to_batch_and_zero_pad": 1.9072057832945284e-05}}, "connector_pipeline_timer": 0.11149222620873922}, "num_module_steps_trained_lifetime": 36000, "learner_connector_sum_episodes_length_in": 5000.0, "num_trainable_parameters": 6003, "learner_connector_sum_episodes_length_out": 5250.0, "num_env_steps_trained_lifetime": 189000, "num_module_steps_trained": 6000, "num_env_steps_trained": 31500, "num_non_trainable_parameters": 0, "num_env_steps_trained_lifetime_throughput": 1149044.116767374, "num_module_steps_trained_throughput": 220231.94405666285, "num_module_steps_trained_lifetime_throughput": 218630.30449390112}, "default_policy": {"policy_loss": -0.2132357954978943, "mean_kl_loss": 0.0009678311762399971, "diff_num_grad_updates_vs_sampler_policy": 1.0, "num_module_steps_trained_lifetime": 36000, "entropy": 0.6470538377761841, "vf_explained_var": 0.02075040340423584, "gradients_default_optimizer_global_norm": 0.029508594423532486, "module_train_batch_size_mean": 1000.0, "weights_seq_no": 6.0, "total_loss": -0.15098221600055695, "curr_kl_coeff": 0.011664004996418953, "default_optimizer_learning_rate": 0.0002847858517, "vf_loss_unclipped": 28.623245239257812, "vf_loss": 0.10181018710136414, "curr_entropy_coeff": 0.0090570820258, "num_trainable_parameters": 6003, "num_module_steps_trained": 6000, "num_module_steps_trained_lifetime_throughput": 223083.46673959584}}, "num_training_step_calls_per_iteration": 1, "evaluation": {"env_runners": {"module_to_env_connector": {"timers": {"connectors": {"tensor_to_numpy": 2.7064536662419545e-05, "normalize_and_clip_actions": 1.7029094424106655e-05, "get_actions": 8.783240955498434e-05, "un_batch_to_individual_items": 1.1859878152659989e-05, "remove_single_ts_time_rank_from_batch": 1.0954222238601204e-06, "listify_data_for_vector_env": 2.5554198660840426e-05}}, "connector_pipeline_timer": 0.00021710877693066855}, "episode_duration_sec_mean": 0.009615721168229356, "module_episode_returns_mean": {"default_policy": 1.55}, "episode_len_mean": 20.0, "env_to_module_connector": {"timers": {"connectors": {"add_time_dim_to_batch_and_zero_pad": 4.592647719189873e-06, "add_states_from_episodes_to_batch": 2.972496943622845e-06, "add_observations_from_episodes_to_batch": 6.462945084403574e-06, "batch_individual_items": 1.3625638593317099e-05, "numpy_to_tensor": 1.9663808864173423e-05}}, "connector_pipeline_timer": 8.534232381853631e-05}, "num_env_steps_sampled_lifetime": 30400, "env_to_module_sum_episodes_length_out": 10.368238394470474, "num_agent_steps_sampled": {"default_agent": 400}, "env_reset_timer": 0.0004897610167673015, "env_step_timer": 3.26947186749236e-05, "weights_seq_no": 6.0, "rlmodule_inference_timer": 6.306171504388565e-05, "num_module_steps_sampled": {"default_policy": 400}, "agent_episode_returns_mean": {"default_agent": 1.55}, "env_to_module_sum_episodes_length_in": 10.368238394470474, "episode_len_max": 20, "sample": 0.1910520699711116, "episode_len_min": 20, "num_module_steps_sampled_lifetime": {"default_policy": 2400}, "episode_return_max": 12.5, "num_agent_steps_sampled_lifetime": {"default_agent": 2400}, "num_env_steps_sampled": 400, "episode_return_min": -16.5, "episode_return_mean": 1.55, "num_episodes_lifetime": 120, "num_episodes": 20, "time_between_sampling": 2.743966040078717}, "num_healthy_workers": 1, "actor_manager_num_outstanding_async_reqs": 0, "num_remote_worker_restarts": 0}, "num_env_steps_sampled_lifetime": -2460000.0, "fault_tolerance": {"num_healthy_workers": 0, "num_remote_worker_restarts": 0}, "env_runner_group": {"actor_manager_num_outstanding_async_reqs": 0}, "done": false, "training_iteration": 6, "trial_id": "4638e_00000", "date": "2025-08-11_19-33-21", "timestamp": 1754933601, "time_this_iter_s": 3.643998146057129, "time_total_s": 19.969796657562256, "pid": 25862, "hostname": "Mac", "node_ip": "127.0.0.1", "config": {"exploration_config": {}, "extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "placement_strategy": "PACK", "num_gpus": 0, "_fake_gpus": false, "num_cpus_for_main_process": 2, "eager_tracing": true, "eager_max_retraces": 20, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "torch_compile_learner": false, "torch_compile_learner_what_to_compile": "forward_train", "torch_compile_learner_dynamo_backend": "aot_eager", "torch_compile_learner_dynamo_mode": null, "torch_compile_worker": false, "torch_compile_worker_dynamo_backend": "aot_eager", "torch_compile_worker_dynamo_mode": null, "torch_ddp_kwargs": {}, "torch_skip_nan_gradients": false, "env": "Umbrella", "env_config": {}, "observation_space": null, "action_space": null, "clip_rewards": null, "normalize_actions": true, "clip_actions": false, "_is_atari": null, "disable_env_checking": false, "render_env": false, "action_mask_key": "action_mask", "env_runner_cls": null, "num_env_runners": 0, "create_local_env_runner": true, "num_envs_per_env_runner": 1, "gym_env_vectorize_mode": "SYNC", "num_cpus_per_env_runner": 1, "num_gpus_per_env_runner": 0, "custom_resources_per_env_runner": {}, "validate_env_runners_after_construction": true, "episodes_to_numpy": true, "max_requests_in_flight_per_env_runner": 1, "sample_timeout_s": 60.0, "_env_to_module_connector": null, "add_default_connectors_to_env_to_module_pipeline": true, "_module_to_env_connector": null, "add_default_connectors_to_module_to_env_pipeline": true, "merge_env_runner_states": "training_only", "broadcast_env_runner_states": true, "episode_lookback_horizon": 1, "rollout_fragment_length": "auto", "batch_mode": "complete_episodes", "compress_observations": false, "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "enable_tf1_exec_eagerly": false, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "preprocessor_pref": "deepmind", "observation_filter": "NoFilter", "update_worker_filter_stats": true, "use_worker_filter_stats": true, "sampler_perf_stats_ema_coef": null, "_is_online": true, "num_learners": 0, "num_gpus_per_learner": 0, "num_cpus_per_learner": "auto", "num_aggregator_actors_per_learner": 0, "max_requests_in_flight_per_aggregator_actor": 3, "local_gpu_idx": 0, "max_requests_in_flight_per_learner": 3, "gamma": 1, "lr": 0.0002847858517, "grad_clip": 0.5, "grad_clip_by": "global_norm", "_train_batch_size_per_learner": 5000, "train_batch_size": 4000, "num_epochs": 1, "minibatch_size": 1000, "shuffle_batch_per_epoch": true, "model": {"fcnet_hiddens": [256, 256], "fcnet_activation": "tanh", "fcnet_weights_initializer": null, "fcnet_weights_initializer_config": null, "fcnet_bias_initializer": null, "fcnet_bias_initializer_config": null, "conv_filters": null, "conv_activation": "relu", "conv_kernel_initializer": null, "conv_kernel_initializer_config": null, "conv_bias_initializer": null, "conv_bias_initializer_config": null, "conv_transpose_kernel_initializer": null, "conv_transpose_kernel_initializer_config": null, "conv_transpose_bias_initializer": null, "conv_transpose_bias_initializer_config": null, "post_fcnet_hiddens": [], "post_fcnet_activation": "relu", "post_fcnet_weights_initializer": null, "post_fcnet_weights_initializer_config": null, "post_fcnet_bias_initializer": null, "post_fcnet_bias_initializer_config": null, "free_log_std": false, "log_std_clip_param": 20.0, "no_final_linear": false, "vf_share_layers": false, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "lstm_weights_initializer": null, "lstm_weights_initializer_config": null, "lstm_bias_initializer": null, "lstm_bias_initializer_config": null, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "attention_use_n_prev_actions": 0, "attention_use_n_prev_rewards": 0, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": null, "custom_model_config": {}, "custom_action_dist": null, "custom_preprocessor": null, "encoder_latent_dim": null, "always_check_shapes": false, "lstm_use_prev_action_reward": -1, "_use_default_native_models": -1, "_disable_preprocessor_api": false, "_disable_action_flattening": false}, "_learner_connector": null, "add_default_connectors_to_learner_pipeline": true, "learner_config_dict": {}, "optimizer": {}, "_learner_class": null, "callbacks_on_algorithm_init": null, "callbacks_on_env_runners_recreated": null, "callbacks_on_offline_eval_runners_recreated": null, "callbacks_on_checkpoint_loaded": null, "callbacks_on_environment_created": null, "callbacks_on_episode_created": null, "callbacks_on_episode_start": null, "callbacks_on_episode_step": null, "callbacks_on_episode_end": null, "callbacks_on_evaluate_start": null, "callbacks_on_evaluate_end": null, "callbacks_on_evaluate_offline_start": null, "callbacks_on_evaluate_offline_end": null, "callbacks_on_sample_end": null, "callbacks_on_train_result": null, "explore": true, "enable_rl_module_and_learner": true, "enable_env_runner_and_connector_v2": true, "_prior_exploration_config": {"type": "StochasticSampling"}, "count_steps_by": "env_steps", "policy_map_capacity": 100, "policy_mapping_fn": "<function AlgorithmConfig.DEFAULT_POLICY_MAPPING_FN at 0x161d55b20>", "policies_to_train": null, "policy_states_are_swappable": false, "observation_fn": null, "offline_data_class": null, "input_read_method": "read_parquet", "input_read_method_kwargs": {}, "input_read_schema": {}, "input_read_episodes": false, "input_read_sample_batches": false, "input_read_batch_size": null, "input_filesystem": null, "input_filesystem_kwargs": {}, "input_compress_columns": ["obs", "new_obs"], "input_spaces_jsonable": true, "materialize_data": false, "materialize_mapped_data": true, "map_batches_kwargs": {}, "iter_batches_kwargs": {}, "ignore_final_observation": false, "prelearner_class": null, "prelearner_buffer_class": null, "prelearner_buffer_kwargs": {}, "prelearner_module_synch_period": 10, "dataset_num_iters_per_learner": null, "input_config": {}, "actions_in_input_normalized": false, "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_config": {}, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "output_max_rows_per_file": null, "output_write_remaining_data": false, "output_write_method": "write_parquet", "output_write_method_kwargs": {}, "output_filesystem": null, "output_filesystem_kwargs": {}, "output_write_episodes": true, "offline_sampling": false, "evaluation_interval": 1, "evaluation_duration": 20, "evaluation_duration_unit": "episodes", "evaluation_sample_timeout_s": 120.0, "evaluation_auto_duration_min_env_steps_per_sample": 100, "evaluation_auto_duration_max_env_steps_per_sample": 2000, "evaluation_parallel_to_training": false, "evaluation_force_reset_envs_before_iteration": true, "evaluation_config": null, "off_policy_estimation_methods": {}, "ope_split_batch_by_episode": true, "evaluation_num_env_runners": 1, "in_evaluation": false, "sync_filters_on_rollout_workers_timeout_s": 10.0, "offline_evaluation_interval": null, "num_offline_eval_runners": 0, "offline_loss_for_module_fn": null, "offline_evaluation_duration": 1, "offline_evaluation_parallel_to_training": false, "offline_evaluation_timeout_s": 120.0, "num_cpus_per_offline_eval_runner": 1, "num_gpus_per_offline_eval_runner": 0, "custom_resources_per_offline_eval_runner": {}, "restart_failed_offline_eval_runners": true, "ignore_offline_eval_runner_failures": false, "max_num_offline_eval_runner_restarts": 1000, "offline_eval_runner_restore_timeout_s": 1800.0, "max_requests_in_flight_per_offline_eval_runner": 1, "validate_offline_eval_runners_after_construction": true, "offline_eval_runner_health_probe_timeout_s": 30.0, "offline_eval_rl_module_inference_only": false, "broadcast_offline_eval_runner_states": false, "offline_eval_batch_size_per_runner": 256, "dataset_num_iters_per_eval_runner": 1, "keep_per_episode_custom_metrics": false, "metrics_episode_collection_timeout_s": 60.0, "metrics_num_episodes_for_smoothing": 100, "min_time_s_per_iteration": null, "min_train_timesteps_per_iteration": 0, "min_sample_timesteps_per_iteration": 0, "log_gradients": true, "export_native_model_files": false, "checkpoint_trainable_policies_only": false, "logger_creator": null, "logger_config": null, "log_level": "WARN", "log_sys_usage": true, "fake_sampler": false, "seed": 4, "restart_failed_env_runners": true, "ignore_env_runner_failures": false, "max_num_env_runner_restarts": 1000, "delay_between_env_runner_restarts_s": 60.0, "restart_failed_sub_environments": false, "num_consecutive_env_runner_failures_tolerance": 100, "env_runner_health_probe_timeout_s": 30.0, "env_runner_restore_timeout_s": 1800.0, "_model_config": {}, "_rl_module_spec": "RLModuleSpec(module_class=None, observation_space=None, action_space=None, inference_only=False, learner_only=False, model_config=DefaultModelConfig(fcnet_hiddens=[60, 90], fcnet_activation='tanh', fcnet_kernel_initializer=None, fcnet_kernel_initializer_kwargs=None, fcnet_bias_initializer=None, fcnet_bias_initializer_kwargs=None, conv_filters=None, conv_activation='relu', conv_kernel_initializer=None, conv_kernel_initializer_kwargs=None, conv_bias_initializer=None, conv_bias_initializer_kwargs=None, head_fcnet_hiddens=[], head_fcnet_activation='relu', head_fcnet_kernel_initializer=None, head_fcnet_kernel_initializer_kwargs=None, head_fcnet_bias_initializer=None, head_fcnet_bias_initializer_kwargs=None, free_log_std=False, log_std_clip_param=20.0, vf_share_layers=True, use_lstm=False, max_seq_len=20, lstm_cell_size=256, lstm_use_prev_action=False, lstm_use_prev_reward=False, lstm_kernel_initializer=None, lstm_kernel_initializer_kwargs=None, lstm_bias_initializer=None, lstm_bias_initializer_kwargs=None), catalog_class=None, load_state_path=None, model_config_dict=None)", "algorithm_config_overrides_per_module": {}, "_per_module_overrides": {}, "_validate_config": true, "_use_msgpack_checkpoints": false, "_torch_grad_scaler_class": null, "_torch_lr_scheduler_classes": null, "_tf_policy_handles_more_than_one_loss": false, "_disable_preprocessor_api": false, "_disable_action_flattening": false, "_disable_initialize_loss_from_dummy_batch": false, "_dont_auto_sync_env_runner_states": false, "env_task_fn": -1, "enable_connectors": -1, "simple_optimizer": false, "policy_map_cache": -1, "worker_cls": -1, "synchronize_filters": -1, "enable_async_evaluation": -1, "custom_async_evaluation_function": -1, "_enable_rl_module_api": -1, "auto_wrap_old_gym_envs": -1, "always_attach_evaluation_results": -1, "replay_sequence_length": null, "_disable_execution_plan_api": -1, "use_critic": true, "use_gae": true, "use_kl_loss": true, "kl_coeff": 0.7464963036515, "kl_target": 0.0270990929592, "vf_loss_coeff": 0.6688075857018, "entropy_coeff": 0.0090570820258, "clip_param": 0.1221781641624, "vf_clip_param": 0.1027808522125, "entropy_coeff_schedule": null, "lr_schedule": null, "sgd_minibatch_size": -1, "vf_share_layers": -1, "__stdout_file__": null, "__stderr_file__": null, "lambda": 0.9099046732075, "input": "sampler", "policies": {"default_policy": [null, null, null, null]}, "callbacks": "<class 'ray.rllib.callbacks.callbacks.RLlibCallback'>", "create_env_on_driver": false, "custom_eval_function": null, "framework": "torch"}, "time_since_restore": 19.969796657562256, "iterations_since_restore": 6, "perf": {"cpu_util_percent": 79.36000000000001, "ram_util_percent": 79.05999999999999}}
{"timers": {"training_iteration": 3.458784611500895, "restore_env_runners": 4.83978050437289e-05, "training_step": 3.4584337972648336, "env_runner_sampling_timer": 3.2861696773640316, "learner_update_timer": 0.1651562922048541, "synch_weights": 0.0012255737027025975, "restore_eval_env_runners": 1.0842014220505557e-05, "evaluation_iteration": 0.20380150881079065, "synch_eval_env_connectors": 0.00045976110691524645, "synch_env_connectors": 6.017506362023111e-06}, "env_runners": {"agent_episode_returns_mean": {"default_agent": 6.820000000000002}, "env_to_module_connector": {"timers": {"connectors": {"add_time_dim_to_batch_and_zero_pad": 3.950251677498879e-06, "add_states_from_episodes_to_batch": 2.5147011325851733e-06, "numpy_to_tensor": 1.533942351123901e-05, "add_observations_from_episodes_to_batch": 5.020339658099414e-06, "batch_individual_items": 1.0727845921341878e-05}}, "connector_pipeline_timer": 6.979397508451935e-05}, "episode_len_mean": 20.0, "episode_len_min": 20, "episode_return_max": 12.5, "num_agent_steps_sampled": {"default_agent": 5000.0}, "module_to_env_connector": {"timers": {"connectors": {"listify_data_for_vector_env": 1.8301354932059414e-05, "tensor_to_numpy": 2.2499982066120936e-05, "normalize_and_clip_actions": 1.4771066750223262e-05, "get_actions": 7.541254913244819e-05, "un_batch_to_individual_items": 8.208022982847194e-06, "remove_single_ts_time_rank_from_batch": 9.359910621132725e-07}}, "connector_pipeline_timer": 0.00017987778693502205}, "num_env_steps_sampled": 5000.0, "episode_return_mean": 6.820000000000002, "num_episodes_lifetime": -153875.0, "episode_return_min": -7.5, "time_between_sampling": 0.0034207207573973206, "episode_len_max": 20, "env_reset_timer": 8.313819523579346e-05, "num_env_steps_sampled_lifetime": -3077500.0, "env_to_module_sum_episodes_length_in": 10.36823839457432, "sample": 0.008876104345904263, "num_episodes": 250.0, "num_module_steps_sampled_lifetime": {"default_policy": -3077500.0}, "module_episode_returns_mean": {"default_policy": 6.820000000000002}, "env_step_timer": 2.453177413998698e-05, "weights_seq_no": 6.0, "num_agent_steps_sampled_lifetime": {"default_agent": -3077500.0}, "rlmodule_inference_timer": 5.0061061189632226e-05, "env_to_module_sum_episodes_length_out": 10.36823839457432, "num_module_steps_sampled": {"default_policy": 5000.0}, "episode_duration_sec_mean": 0.007731577516067774, "num_env_steps_sampled_lifetime_throughput": 2457.6515262749767}, "learners": {"__all_modules__": {"learner_connector": {"timers": {"connectors": {"numpy_to_tensor": 8.804727015837169e-05, "add_columns_from_episodes_to_train_batch": 0.051290120873316886, "add_observations_from_episodes_to_batch": 0.0018631667297721525, "add_states_from_episodes_to_batch": 1.0939116300456534e-05, "general_advantage_estimation": 0.007313919233524662, "batch_individual_items": 0.04121838202951398, "add_one_ts_to_episodes_and_truncate": 0.009611472901846337, "add_time_dim_to_batch_and_zero_pad": 1.9095497208955095e-05}}, "connector_pipeline_timer": 0.11163131602725976}, "num_module_steps_trained_lifetime": 42000, "learner_connector_sum_episodes_length_in": 5000.0, "num_trainable_parameters": 6003, "learner_connector_sum_episodes_length_out": 5250.0, "num_env_steps_trained_lifetime": 220500, "num_module_steps_trained": 6000, "num_env_steps_trained": 31500, "num_non_trainable_parameters": 0, "num_env_steps_trained_lifetime_throughput": 1143221.1101799142, "num_module_steps_trained_throughput": 219060.11703297935, "num_module_steps_trained_lifetime_throughput": 217518.6478316786}, "default_policy": {"policy_loss": -0.04889311641454697, "mean_kl_loss": 0.0012224273523315787, "diff_num_grad_updates_vs_sampler_policy": 1.0, "num_module_steps_trained_lifetime": 42000, "entropy": 0.6315293908119202, "vf_explained_var": 0.021754086017608643, "gradients_default_optimizer_global_norm": 0.06353103369474411, "module_train_batch_size_mean": 1000.0, "weights_seq_no": 7.0, "total_loss": 0.01327641773968935, "curr_kl_coeff": 0.0058320024982094765, "default_optimizer_learning_rate": 0.0002847858517, "vf_loss_unclipped": 28.57539176940918, "vf_loss": 0.10148672014474869, "curr_entropy_coeff": 0.0090570820258, "num_trainable_parameters": 6003, "num_module_steps_trained": 6000, "num_module_steps_trained_lifetime_throughput": 221782.41613677613}}, "num_training_step_calls_per_iteration": 1, "evaluation": {"env_runners": {"module_to_env_connector": {"timers": {"connectors": {"tensor_to_numpy": 1.8597173712839274e-05, "normalize_and_clip_actions": 1.2484708868474983e-05, "get_actions": 5.694713373506312e-05, "un_batch_to_individual_items": 7.284234315683927e-06, "remove_single_ts_time_rank_from_batch": 9.929935551555941e-07, "listify_data_for_vector_env": 1.557124918475471e-05}}, "connector_pipeline_timer": 0.00014535621258554213}, "episode_duration_sec_mean": 0.009290828244993464, "module_episode_returns_mean": {"default_policy": 2.55}, "episode_len_mean": 20.0, "env_to_module_connector": {"timers": {"connectors": {"add_time_dim_to_batch_and_zero_pad": 2.8188747796536476e-06, "add_states_from_episodes_to_batch": 2.200718398001044e-06, "add_observations_from_episodes_to_batch": 3.893089310200144e-06, "batch_individual_items": 9.043374203961127e-06, "numpy_to_tensor": 1.1562178709957228e-05}}, "connector_pipeline_timer": 5.7196174903472706e-05}, "num_env_steps_sampled_lifetime": 35400, "env_to_module_sum_episodes_length_out": 10.368238394572801, "num_agent_steps_sampled": {"default_agent": 400}, "env_reset_timer": 0.0004863579965598311, "env_step_timer": 2.0027300466635256e-05, "weights_seq_no": 7.0, "rlmodule_inference_timer": 3.972174733712856e-05, "num_module_steps_sampled": {"default_policy": 400}, "agent_episode_returns_mean": {"default_agent": 2.55}, "env_to_module_sum_episodes_length_in": 10.368238394572801, "episode_len_max": 20, "sample": 0.1907041317714466, "episode_len_min": 20, "num_module_steps_sampled_lifetime": {"default_policy": 2800}, "episode_return_max": 12.5, "num_agent_steps_sampled_lifetime": {"default_agent": 2800}, "num_env_steps_sampled": 400, "episode_return_min": -16.5, "episode_return_mean": 2.55, "num_episodes_lifetime": 140, "num_episodes": 20, "time_between_sampling": 2.741639272177822}, "num_healthy_workers": 1, "actor_manager_num_outstanding_async_reqs": 0, "num_remote_worker_restarts": 0}, "num_env_steps_sampled_lifetime": -3077500.0, "fault_tolerance": {"num_healthy_workers": 0, "num_remote_worker_restarts": 0}, "env_runner_group": {"actor_manager_num_outstanding_async_reqs": 0}, "done": false, "training_iteration": 7, "trial_id": "4638e_00000", "date": "2025-08-11_19-33-23", "timestamp": 1754933603, "time_this_iter_s": 2.6504669189453125, "time_total_s": 22.62026357650757, "pid": 25862, "hostname": "Mac", "node_ip": "127.0.0.1", "config": {"exploration_config": {}, "extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "placement_strategy": "PACK", "num_gpus": 0, "_fake_gpus": false, "num_cpus_for_main_process": 2, "eager_tracing": true, "eager_max_retraces": 20, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "torch_compile_learner": false, "torch_compile_learner_what_to_compile": "forward_train", "torch_compile_learner_dynamo_backend": "aot_eager", "torch_compile_learner_dynamo_mode": null, "torch_compile_worker": false, "torch_compile_worker_dynamo_backend": "aot_eager", "torch_compile_worker_dynamo_mode": null, "torch_ddp_kwargs": {}, "torch_skip_nan_gradients": false, "env": "Umbrella", "env_config": {}, "observation_space": null, "action_space": null, "clip_rewards": null, "normalize_actions": true, "clip_actions": false, "_is_atari": null, "disable_env_checking": false, "render_env": false, "action_mask_key": "action_mask", "env_runner_cls": null, "num_env_runners": 0, "create_local_env_runner": true, "num_envs_per_env_runner": 1, "gym_env_vectorize_mode": "SYNC", "num_cpus_per_env_runner": 1, "num_gpus_per_env_runner": 0, "custom_resources_per_env_runner": {}, "validate_env_runners_after_construction": true, "episodes_to_numpy": true, "max_requests_in_flight_per_env_runner": 1, "sample_timeout_s": 60.0, "_env_to_module_connector": null, "add_default_connectors_to_env_to_module_pipeline": true, "_module_to_env_connector": null, "add_default_connectors_to_module_to_env_pipeline": true, "merge_env_runner_states": "training_only", "broadcast_env_runner_states": true, "episode_lookback_horizon": 1, "rollout_fragment_length": "auto", "batch_mode": "complete_episodes", "compress_observations": false, "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "enable_tf1_exec_eagerly": false, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "preprocessor_pref": "deepmind", "observation_filter": "NoFilter", "update_worker_filter_stats": true, "use_worker_filter_stats": true, "sampler_perf_stats_ema_coef": null, "_is_online": true, "num_learners": 0, "num_gpus_per_learner": 0, "num_cpus_per_learner": "auto", "num_aggregator_actors_per_learner": 0, "max_requests_in_flight_per_aggregator_actor": 3, "local_gpu_idx": 0, "max_requests_in_flight_per_learner": 3, "gamma": 1, "lr": 0.0002847858517, "grad_clip": 0.5, "grad_clip_by": "global_norm", "_train_batch_size_per_learner": 5000, "train_batch_size": 4000, "num_epochs": 1, "minibatch_size": 1000, "shuffle_batch_per_epoch": true, "model": {"fcnet_hiddens": [256, 256], "fcnet_activation": "tanh", "fcnet_weights_initializer": null, "fcnet_weights_initializer_config": null, "fcnet_bias_initializer": null, "fcnet_bias_initializer_config": null, "conv_filters": null, "conv_activation": "relu", "conv_kernel_initializer": null, "conv_kernel_initializer_config": null, "conv_bias_initializer": null, "conv_bias_initializer_config": null, "conv_transpose_kernel_initializer": null, "conv_transpose_kernel_initializer_config": null, "conv_transpose_bias_initializer": null, "conv_transpose_bias_initializer_config": null, "post_fcnet_hiddens": [], "post_fcnet_activation": "relu", "post_fcnet_weights_initializer": null, "post_fcnet_weights_initializer_config": null, "post_fcnet_bias_initializer": null, "post_fcnet_bias_initializer_config": null, "free_log_std": false, "log_std_clip_param": 20.0, "no_final_linear": false, "vf_share_layers": false, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "lstm_weights_initializer": null, "lstm_weights_initializer_config": null, "lstm_bias_initializer": null, "lstm_bias_initializer_config": null, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "attention_use_n_prev_actions": 0, "attention_use_n_prev_rewards": 0, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": null, "custom_model_config": {}, "custom_action_dist": null, "custom_preprocessor": null, "encoder_latent_dim": null, "always_check_shapes": false, "lstm_use_prev_action_reward": -1, "_use_default_native_models": -1, "_disable_preprocessor_api": false, "_disable_action_flattening": false}, "_learner_connector": null, "add_default_connectors_to_learner_pipeline": true, "learner_config_dict": {}, "optimizer": {}, "_learner_class": null, "callbacks_on_algorithm_init": null, "callbacks_on_env_runners_recreated": null, "callbacks_on_offline_eval_runners_recreated": null, "callbacks_on_checkpoint_loaded": null, "callbacks_on_environment_created": null, "callbacks_on_episode_created": null, "callbacks_on_episode_start": null, "callbacks_on_episode_step": null, "callbacks_on_episode_end": null, "callbacks_on_evaluate_start": null, "callbacks_on_evaluate_end": null, "callbacks_on_evaluate_offline_start": null, "callbacks_on_evaluate_offline_end": null, "callbacks_on_sample_end": null, "callbacks_on_train_result": null, "explore": true, "enable_rl_module_and_learner": true, "enable_env_runner_and_connector_v2": true, "_prior_exploration_config": {"type": "StochasticSampling"}, "count_steps_by": "env_steps", "policy_map_capacity": 100, "policy_mapping_fn": "<function AlgorithmConfig.DEFAULT_POLICY_MAPPING_FN at 0x161d55b20>", "policies_to_train": null, "policy_states_are_swappable": false, "observation_fn": null, "offline_data_class": null, "input_read_method": "read_parquet", "input_read_method_kwargs": {}, "input_read_schema": {}, "input_read_episodes": false, "input_read_sample_batches": false, "input_read_batch_size": null, "input_filesystem": null, "input_filesystem_kwargs": {}, "input_compress_columns": ["obs", "new_obs"], "input_spaces_jsonable": true, "materialize_data": false, "materialize_mapped_data": true, "map_batches_kwargs": {}, "iter_batches_kwargs": {}, "ignore_final_observation": false, "prelearner_class": null, "prelearner_buffer_class": null, "prelearner_buffer_kwargs": {}, "prelearner_module_synch_period": 10, "dataset_num_iters_per_learner": null, "input_config": {}, "actions_in_input_normalized": false, "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_config": {}, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "output_max_rows_per_file": null, "output_write_remaining_data": false, "output_write_method": "write_parquet", "output_write_method_kwargs": {}, "output_filesystem": null, "output_filesystem_kwargs": {}, "output_write_episodes": true, "offline_sampling": false, "evaluation_interval": 1, "evaluation_duration": 20, "evaluation_duration_unit": "episodes", "evaluation_sample_timeout_s": 120.0, "evaluation_auto_duration_min_env_steps_per_sample": 100, "evaluation_auto_duration_max_env_steps_per_sample": 2000, "evaluation_parallel_to_training": false, "evaluation_force_reset_envs_before_iteration": true, "evaluation_config": null, "off_policy_estimation_methods": {}, "ope_split_batch_by_episode": true, "evaluation_num_env_runners": 1, "in_evaluation": false, "sync_filters_on_rollout_workers_timeout_s": 10.0, "offline_evaluation_interval": null, "num_offline_eval_runners": 0, "offline_loss_for_module_fn": null, "offline_evaluation_duration": 1, "offline_evaluation_parallel_to_training": false, "offline_evaluation_timeout_s": 120.0, "num_cpus_per_offline_eval_runner": 1, "num_gpus_per_offline_eval_runner": 0, "custom_resources_per_offline_eval_runner": {}, "restart_failed_offline_eval_runners": true, "ignore_offline_eval_runner_failures": false, "max_num_offline_eval_runner_restarts": 1000, "offline_eval_runner_restore_timeout_s": 1800.0, "max_requests_in_flight_per_offline_eval_runner": 1, "validate_offline_eval_runners_after_construction": true, "offline_eval_runner_health_probe_timeout_s": 30.0, "offline_eval_rl_module_inference_only": false, "broadcast_offline_eval_runner_states": false, "offline_eval_batch_size_per_runner": 256, "dataset_num_iters_per_eval_runner": 1, "keep_per_episode_custom_metrics": false, "metrics_episode_collection_timeout_s": 60.0, "metrics_num_episodes_for_smoothing": 100, "min_time_s_per_iteration": null, "min_train_timesteps_per_iteration": 0, "min_sample_timesteps_per_iteration": 0, "log_gradients": true, "export_native_model_files": false, "checkpoint_trainable_policies_only": false, "logger_creator": null, "logger_config": null, "log_level": "WARN", "log_sys_usage": true, "fake_sampler": false, "seed": 4, "restart_failed_env_runners": true, "ignore_env_runner_failures": false, "max_num_env_runner_restarts": 1000, "delay_between_env_runner_restarts_s": 60.0, "restart_failed_sub_environments": false, "num_consecutive_env_runner_failures_tolerance": 100, "env_runner_health_probe_timeout_s": 30.0, "env_runner_restore_timeout_s": 1800.0, "_model_config": {}, "_rl_module_spec": "RLModuleSpec(module_class=None, observation_space=None, action_space=None, inference_only=False, learner_only=False, model_config=DefaultModelConfig(fcnet_hiddens=[60, 90], fcnet_activation='tanh', fcnet_kernel_initializer=None, fcnet_kernel_initializer_kwargs=None, fcnet_bias_initializer=None, fcnet_bias_initializer_kwargs=None, conv_filters=None, conv_activation='relu', conv_kernel_initializer=None, conv_kernel_initializer_kwargs=None, conv_bias_initializer=None, conv_bias_initializer_kwargs=None, head_fcnet_hiddens=[], head_fcnet_activation='relu', head_fcnet_kernel_initializer=None, head_fcnet_kernel_initializer_kwargs=None, head_fcnet_bias_initializer=None, head_fcnet_bias_initializer_kwargs=None, free_log_std=False, log_std_clip_param=20.0, vf_share_layers=True, use_lstm=False, max_seq_len=20, lstm_cell_size=256, lstm_use_prev_action=False, lstm_use_prev_reward=False, lstm_kernel_initializer=None, lstm_kernel_initializer_kwargs=None, lstm_bias_initializer=None, lstm_bias_initializer_kwargs=None), catalog_class=None, load_state_path=None, model_config_dict=None)", "algorithm_config_overrides_per_module": {}, "_per_module_overrides": {}, "_validate_config": true, "_use_msgpack_checkpoints": false, "_torch_grad_scaler_class": null, "_torch_lr_scheduler_classes": null, "_tf_policy_handles_more_than_one_loss": false, "_disable_preprocessor_api": false, "_disable_action_flattening": false, "_disable_initialize_loss_from_dummy_batch": false, "_dont_auto_sync_env_runner_states": false, "env_task_fn": -1, "enable_connectors": -1, "simple_optimizer": false, "policy_map_cache": -1, "worker_cls": -1, "synchronize_filters": -1, "enable_async_evaluation": -1, "custom_async_evaluation_function": -1, "_enable_rl_module_api": -1, "auto_wrap_old_gym_envs": -1, "always_attach_evaluation_results": -1, "replay_sequence_length": null, "_disable_execution_plan_api": -1, "use_critic": true, "use_gae": true, "use_kl_loss": true, "kl_coeff": 0.7464963036515, "kl_target": 0.0270990929592, "vf_loss_coeff": 0.6688075857018, "entropy_coeff": 0.0090570820258, "clip_param": 0.1221781641624, "vf_clip_param": 0.1027808522125, "entropy_coeff_schedule": null, "lr_schedule": null, "sgd_minibatch_size": -1, "vf_share_layers": -1, "__stdout_file__": null, "__stderr_file__": null, "lambda": 0.9099046732075, "input": "sampler", "policies": {"default_policy": [null, null, null, null]}, "callbacks": "<class 'ray.rllib.callbacks.callbacks.RLlibCallback'>", "create_env_on_driver": false, "custom_eval_function": null, "framework": "torch"}, "time_since_restore": 22.62026357650757, "iterations_since_restore": 7, "perf": {"cpu_util_percent": 76.47500000000001, "ram_util_percent": 79.475}}
{"timers": {"training_iteration": 3.4503438108056703, "restore_env_runners": 4.802549722660088e-05, "training_step": 3.449993441792256, "env_runner_sampling_timer": 3.2781135880904118, "learner_update_timer": 0.16477643428276836, "synch_weights": 0.0012243379657682566, "restore_eval_env_runners": 1.0864423945276049e-05, "evaluation_iteration": 0.2033975291335079, "synch_eval_env_connectors": 0.00045871390588395425, "synch_env_connectors": 5.999831039942239e-06}, "env_runners": {"agent_episode_returns_mean": {"default_agent": 7.46}, "env_to_module_connector": {"timers": {"connectors": {"add_time_dim_to_batch_and_zero_pad": 4.055796983794935e-06, "add_states_from_episodes_to_batch": 2.5059600325042905e-06, "numpy_to_tensor": 1.541065701027685e-05, "add_observations_from_episodes_to_batch": 4.976126728013619e-06, "batch_individual_items": 1.0966006194958429e-05}}, "connector_pipeline_timer": 7.025251372273909e-05}, "episode_len_mean": 20.0, "episode_len_min": 20, "episode_return_max": 12.5, "num_agent_steps_sampled": {"default_agent": 5000.0}, "module_to_env_connector": {"timers": {"connectors": {"listify_data_for_vector_env": 1.8104007994077603e-05, "tensor_to_numpy": 2.23943353047827e-05, "normalize_and_clip_actions": 1.513485067584747e-05, "get_actions": 7.554382423290227e-05, "un_batch_to_individual_items": 8.38233171579643e-06, "remove_single_ts_time_rank_from_batch": 9.561141361406374e-07}}, "connector_pipeline_timer": 0.00018067816795311423}, "num_env_steps_sampled": 5000.0, "episode_return_mean": 7.46, "num_episodes_lifetime": -184750.0, "episode_return_min": -7.5, "time_between_sampling": 0.002474702237398464, "episode_len_max": 20, "env_reset_timer": 7.729956288879347e-05, "num_env_steps_sampled_lifetime": -3695000.0, "env_to_module_sum_episodes_length_in": 10.36823839457432, "sample": 0.008749257945570943, "num_episodes": 250.0, "num_module_steps_sampled_lifetime": {"default_policy": -3695000.0}, "module_episode_returns_mean": {"default_policy": 7.46}, "env_step_timer": 2.410711124418775e-05, "weights_seq_no": 7.0, "num_agent_steps_sampled_lifetime": {"default_agent": -3695000.0}, "rlmodule_inference_timer": 7.413561821695749e-05, "env_to_module_sum_episodes_length_out": 10.36823839457432, "num_module_steps_sampled": {"default_policy": 5000.0}, "episode_duration_sec_mean": 0.008329364501405508, "num_env_steps_sampled_lifetime_throughput": 2403.299260048416}, "learners": {"__all_modules__": {"learner_connector": {"timers": {"connectors": {"numpy_to_tensor": 8.792429798607721e-05, "add_columns_from_episodes_to_train_batch": 0.051173898414986936, "add_observations_from_episodes_to_batch": 0.0018657992325380906, "add_states_from_episodes_to_batch": 1.086264506215819e-05, "general_advantage_estimation": 0.0072973637910182755, "batch_individual_items": 0.04114982737872951, "add_one_ts_to_episodes_and_truncate": 0.009608479012274657, "add_time_dim_to_batch_and_zero_pad": 1.9032872666881466e-05}}, "connector_pipeline_timer": 0.11142860244751351}, "num_module_steps_trained_lifetime": 48000, "learner_connector_sum_episodes_length_in": 5000.0, "num_trainable_parameters": 6003, "learner_connector_sum_episodes_length_out": 5250.0, "num_env_steps_trained_lifetime": 252000, "num_module_steps_trained": 6000, "num_env_steps_trained": 31500, "num_non_trainable_parameters": 0, "num_env_steps_trained_lifetime_throughput": 1135645.1829271603, "num_module_steps_trained_throughput": 217560.6189983626, "num_module_steps_trained_lifetime_throughput": 216076.34472295392}, "default_policy": {"policy_loss": -0.1171649619936943, "mean_kl_loss": 0.0014844421530142426, "diff_num_grad_updates_vs_sampler_policy": 1.0, "num_module_steps_trained_lifetime": 48000, "entropy": 0.6054023504257202, "vf_explained_var": 0.020945727825164795, "gradients_default_optimizer_global_norm": 0.14886373281478882, "module_train_batch_size_mean": 1000.0, "weights_seq_no": 8.0, "total_loss": -0.05461999401450157, "curr_kl_coeff": 0.0029160012491047382, "default_optimizer_learning_rate": 0.0002847858517, "vf_loss_unclipped": 28.60869026184082, "vf_loss": 0.10170264542102814, "curr_entropy_coeff": 0.0090570820258, "num_trainable_parameters": 6003, "num_module_steps_trained": 6000, "num_module_steps_trained_lifetime_throughput": 220153.40961394957}}, "num_training_step_calls_per_iteration": 1, "evaluation": {"env_runners": {"module_to_env_connector": {"timers": {"connectors": {"tensor_to_numpy": 2.2964898325490427e-05, "normalize_and_clip_actions": 1.4471169032684718e-05, "get_actions": 6.617919561329382e-05, "un_batch_to_individual_items": 8.366738504347933e-06, "remove_single_ts_time_rank_from_batch": 8.30150858409482e-07, "listify_data_for_vector_env": 1.6641429263379788e-05}}, "connector_pipeline_timer": 0.0002608814360923318}, "episode_duration_sec_mean": 0.009633633273188025, "module_episode_returns_mean": {"default_policy": 2.35}, "episode_len_mean": 20.0, "env_to_module_connector": {"timers": {"connectors": {"add_time_dim_to_batch_and_zero_pad": 3.4653494049753937e-06, "add_states_from_episodes_to_batch": 2.0408656974114753e-06, "add_observations_from_episodes_to_batch": 4.2086207299005755e-06, "batch_individual_items": 9.652751819332825e-06, "numpy_to_tensor": 1.3936020281586843e-05}}, "connector_pipeline_timer": 6.222165102478451e-05}, "num_env_steps_sampled_lifetime": 40400, "env_to_module_sum_episodes_length_out": 10.3682383945743, "num_agent_steps_sampled": {"default_agent": 400}, "env_reset_timer": 0.00048270608705441225, "env_step_timer": 2.3569488143002844e-05, "weights_seq_no": 8.0, "rlmodule_inference_timer": 0.00014594372198435785, "num_module_steps_sampled": {"default_policy": 400}, "agent_episode_returns_mean": {"default_agent": 2.35}, "env_to_module_sum_episodes_length_in": 10.3682383945743, "episode_len_max": 20, "sample": 0.19128804628358534, "episode_len_min": 20, "num_module_steps_sampled_lifetime": {"default_policy": 3200}, "episode_return_max": 12.5, "num_agent_steps_sampled_lifetime": {"default_agent": 3200}, "num_env_steps_sampled": 400, "episode_return_min": -16.5, "episode_return_mean": 2.35, "num_episodes_lifetime": 160, "num_episodes": 20, "time_between_sampling": 2.7406737265360213}, "num_healthy_workers": 1, "actor_manager_num_outstanding_async_reqs": 0, "num_remote_worker_restarts": 0}, "num_env_steps_sampled_lifetime": -3695000.0, "fault_tolerance": {"num_healthy_workers": 0, "num_remote_worker_restarts": 0}, "env_runner_group": {"actor_manager_num_outstanding_async_reqs": 0}, "done": false, "training_iteration": 8, "trial_id": "4638e_00000", "date": "2025-08-11_19-33-26", "timestamp": 1754933606, "time_this_iter_s": 2.884962797164917, "time_total_s": 25.505226373672485, "pid": 25862, "hostname": "Mac", "node_ip": "127.0.0.1", "config": {"exploration_config": {}, "extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "placement_strategy": "PACK", "num_gpus": 0, "_fake_gpus": false, "num_cpus_for_main_process": 2, "eager_tracing": true, "eager_max_retraces": 20, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "torch_compile_learner": false, "torch_compile_learner_what_to_compile": "forward_train", "torch_compile_learner_dynamo_backend": "aot_eager", "torch_compile_learner_dynamo_mode": null, "torch_compile_worker": false, "torch_compile_worker_dynamo_backend": "aot_eager", "torch_compile_worker_dynamo_mode": null, "torch_ddp_kwargs": {}, "torch_skip_nan_gradients": false, "env": "Umbrella", "env_config": {}, "observation_space": null, "action_space": null, "clip_rewards": null, "normalize_actions": true, "clip_actions": false, "_is_atari": null, "disable_env_checking": false, "render_env": false, "action_mask_key": "action_mask", "env_runner_cls": null, "num_env_runners": 0, "create_local_env_runner": true, "num_envs_per_env_runner": 1, "gym_env_vectorize_mode": "SYNC", "num_cpus_per_env_runner": 1, "num_gpus_per_env_runner": 0, "custom_resources_per_env_runner": {}, "validate_env_runners_after_construction": true, "episodes_to_numpy": true, "max_requests_in_flight_per_env_runner": 1, "sample_timeout_s": 60.0, "_env_to_module_connector": null, "add_default_connectors_to_env_to_module_pipeline": true, "_module_to_env_connector": null, "add_default_connectors_to_module_to_env_pipeline": true, "merge_env_runner_states": "training_only", "broadcast_env_runner_states": true, "episode_lookback_horizon": 1, "rollout_fragment_length": "auto", "batch_mode": "complete_episodes", "compress_observations": false, "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "enable_tf1_exec_eagerly": false, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "preprocessor_pref": "deepmind", "observation_filter": "NoFilter", "update_worker_filter_stats": true, "use_worker_filter_stats": true, "sampler_perf_stats_ema_coef": null, "_is_online": true, "num_learners": 0, "num_gpus_per_learner": 0, "num_cpus_per_learner": "auto", "num_aggregator_actors_per_learner": 0, "max_requests_in_flight_per_aggregator_actor": 3, "local_gpu_idx": 0, "max_requests_in_flight_per_learner": 3, "gamma": 1, "lr": 0.0002847858517, "grad_clip": 0.5, "grad_clip_by": "global_norm", "_train_batch_size_per_learner": 5000, "train_batch_size": 4000, "num_epochs": 1, "minibatch_size": 1000, "shuffle_batch_per_epoch": true, "model": {"fcnet_hiddens": [256, 256], "fcnet_activation": "tanh", "fcnet_weights_initializer": null, "fcnet_weights_initializer_config": null, "fcnet_bias_initializer": null, "fcnet_bias_initializer_config": null, "conv_filters": null, "conv_activation": "relu", "conv_kernel_initializer": null, "conv_kernel_initializer_config": null, "conv_bias_initializer": null, "conv_bias_initializer_config": null, "conv_transpose_kernel_initializer": null, "conv_transpose_kernel_initializer_config": null, "conv_transpose_bias_initializer": null, "conv_transpose_bias_initializer_config": null, "post_fcnet_hiddens": [], "post_fcnet_activation": "relu", "post_fcnet_weights_initializer": null, "post_fcnet_weights_initializer_config": null, "post_fcnet_bias_initializer": null, "post_fcnet_bias_initializer_config": null, "free_log_std": false, "log_std_clip_param": 20.0, "no_final_linear": false, "vf_share_layers": false, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "lstm_weights_initializer": null, "lstm_weights_initializer_config": null, "lstm_bias_initializer": null, "lstm_bias_initializer_config": null, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "attention_use_n_prev_actions": 0, "attention_use_n_prev_rewards": 0, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": null, "custom_model_config": {}, "custom_action_dist": null, "custom_preprocessor": null, "encoder_latent_dim": null, "always_check_shapes": false, "lstm_use_prev_action_reward": -1, "_use_default_native_models": -1, "_disable_preprocessor_api": false, "_disable_action_flattening": false}, "_learner_connector": null, "add_default_connectors_to_learner_pipeline": true, "learner_config_dict": {}, "optimizer": {}, "_learner_class": null, "callbacks_on_algorithm_init": null, "callbacks_on_env_runners_recreated": null, "callbacks_on_offline_eval_runners_recreated": null, "callbacks_on_checkpoint_loaded": null, "callbacks_on_environment_created": null, "callbacks_on_episode_created": null, "callbacks_on_episode_start": null, "callbacks_on_episode_step": null, "callbacks_on_episode_end": null, "callbacks_on_evaluate_start": null, "callbacks_on_evaluate_end": null, "callbacks_on_evaluate_offline_start": null, "callbacks_on_evaluate_offline_end": null, "callbacks_on_sample_end": null, "callbacks_on_train_result": null, "explore": true, "enable_rl_module_and_learner": true, "enable_env_runner_and_connector_v2": true, "_prior_exploration_config": {"type": "StochasticSampling"}, "count_steps_by": "env_steps", "policy_map_capacity": 100, "policy_mapping_fn": "<function AlgorithmConfig.DEFAULT_POLICY_MAPPING_FN at 0x161d55b20>", "policies_to_train": null, "policy_states_are_swappable": false, "observation_fn": null, "offline_data_class": null, "input_read_method": "read_parquet", "input_read_method_kwargs": {}, "input_read_schema": {}, "input_read_episodes": false, "input_read_sample_batches": false, "input_read_batch_size": null, "input_filesystem": null, "input_filesystem_kwargs": {}, "input_compress_columns": ["obs", "new_obs"], "input_spaces_jsonable": true, "materialize_data": false, "materialize_mapped_data": true, "map_batches_kwargs": {}, "iter_batches_kwargs": {}, "ignore_final_observation": false, "prelearner_class": null, "prelearner_buffer_class": null, "prelearner_buffer_kwargs": {}, "prelearner_module_synch_period": 10, "dataset_num_iters_per_learner": null, "input_config": {}, "actions_in_input_normalized": false, "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_config": {}, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "output_max_rows_per_file": null, "output_write_remaining_data": false, "output_write_method": "write_parquet", "output_write_method_kwargs": {}, "output_filesystem": null, "output_filesystem_kwargs": {}, "output_write_episodes": true, "offline_sampling": false, "evaluation_interval": 1, "evaluation_duration": 20, "evaluation_duration_unit": "episodes", "evaluation_sample_timeout_s": 120.0, "evaluation_auto_duration_min_env_steps_per_sample": 100, "evaluation_auto_duration_max_env_steps_per_sample": 2000, "evaluation_parallel_to_training": false, "evaluation_force_reset_envs_before_iteration": true, "evaluation_config": null, "off_policy_estimation_methods": {}, "ope_split_batch_by_episode": true, "evaluation_num_env_runners": 1, "in_evaluation": false, "sync_filters_on_rollout_workers_timeout_s": 10.0, "offline_evaluation_interval": null, "num_offline_eval_runners": 0, "offline_loss_for_module_fn": null, "offline_evaluation_duration": 1, "offline_evaluation_parallel_to_training": false, "offline_evaluation_timeout_s": 120.0, "num_cpus_per_offline_eval_runner": 1, "num_gpus_per_offline_eval_runner": 0, "custom_resources_per_offline_eval_runner": {}, "restart_failed_offline_eval_runners": true, "ignore_offline_eval_runner_failures": false, "max_num_offline_eval_runner_restarts": 1000, "offline_eval_runner_restore_timeout_s": 1800.0, "max_requests_in_flight_per_offline_eval_runner": 1, "validate_offline_eval_runners_after_construction": true, "offline_eval_runner_health_probe_timeout_s": 30.0, "offline_eval_rl_module_inference_only": false, "broadcast_offline_eval_runner_states": false, "offline_eval_batch_size_per_runner": 256, "dataset_num_iters_per_eval_runner": 1, "keep_per_episode_custom_metrics": false, "metrics_episode_collection_timeout_s": 60.0, "metrics_num_episodes_for_smoothing": 100, "min_time_s_per_iteration": null, "min_train_timesteps_per_iteration": 0, "min_sample_timesteps_per_iteration": 0, "log_gradients": true, "export_native_model_files": false, "checkpoint_trainable_policies_only": false, "logger_creator": null, "logger_config": null, "log_level": "WARN", "log_sys_usage": true, "fake_sampler": false, "seed": 4, "restart_failed_env_runners": true, "ignore_env_runner_failures": false, "max_num_env_runner_restarts": 1000, "delay_between_env_runner_restarts_s": 60.0, "restart_failed_sub_environments": false, "num_consecutive_env_runner_failures_tolerance": 100, "env_runner_health_probe_timeout_s": 30.0, "env_runner_restore_timeout_s": 1800.0, "_model_config": {}, "_rl_module_spec": "RLModuleSpec(module_class=None, observation_space=None, action_space=None, inference_only=False, learner_only=False, model_config=DefaultModelConfig(fcnet_hiddens=[60, 90], fcnet_activation='tanh', fcnet_kernel_initializer=None, fcnet_kernel_initializer_kwargs=None, fcnet_bias_initializer=None, fcnet_bias_initializer_kwargs=None, conv_filters=None, conv_activation='relu', conv_kernel_initializer=None, conv_kernel_initializer_kwargs=None, conv_bias_initializer=None, conv_bias_initializer_kwargs=None, head_fcnet_hiddens=[], head_fcnet_activation='relu', head_fcnet_kernel_initializer=None, head_fcnet_kernel_initializer_kwargs=None, head_fcnet_bias_initializer=None, head_fcnet_bias_initializer_kwargs=None, free_log_std=False, log_std_clip_param=20.0, vf_share_layers=True, use_lstm=False, max_seq_len=20, lstm_cell_size=256, lstm_use_prev_action=False, lstm_use_prev_reward=False, lstm_kernel_initializer=None, lstm_kernel_initializer_kwargs=None, lstm_bias_initializer=None, lstm_bias_initializer_kwargs=None), catalog_class=None, load_state_path=None, model_config_dict=None)", "algorithm_config_overrides_per_module": {}, "_per_module_overrides": {}, "_validate_config": true, "_use_msgpack_checkpoints": false, "_torch_grad_scaler_class": null, "_torch_lr_scheduler_classes": null, "_tf_policy_handles_more_than_one_loss": false, "_disable_preprocessor_api": false, "_disable_action_flattening": false, "_disable_initialize_loss_from_dummy_batch": false, "_dont_auto_sync_env_runner_states": false, "env_task_fn": -1, "enable_connectors": -1, "simple_optimizer": false, "policy_map_cache": -1, "worker_cls": -1, "synchronize_filters": -1, "enable_async_evaluation": -1, "custom_async_evaluation_function": -1, "_enable_rl_module_api": -1, "auto_wrap_old_gym_envs": -1, "always_attach_evaluation_results": -1, "replay_sequence_length": null, "_disable_execution_plan_api": -1, "use_critic": true, "use_gae": true, "use_kl_loss": true, "kl_coeff": 0.7464963036515, "kl_target": 0.0270990929592, "vf_loss_coeff": 0.6688075857018, "entropy_coeff": 0.0090570820258, "clip_param": 0.1221781641624, "vf_clip_param": 0.1027808522125, "entropy_coeff_schedule": null, "lr_schedule": null, "sgd_minibatch_size": -1, "vf_share_layers": -1, "__stdout_file__": null, "__stderr_file__": null, "lambda": 0.9099046732075, "input": "sampler", "policies": {"default_policy": [null, null, null, null]}, "callbacks": "<class 'ray.rllib.callbacks.callbacks.RLlibCallback'>", "create_env_on_driver": false, "custom_eval_function": null, "framework": "torch"}, "time_since_restore": 25.505226373672485, "iterations_since_restore": 8, "perf": {"cpu_util_percent": 35.525000000000006, "ram_util_percent": 79.825}}
{"timers": {"training_iteration": 3.443012932277681, "restore_env_runners": 4.7618991360712235e-05, "training_step": 3.442661003204551, "env_runner_sampling_timer": 3.269698538459446, "learner_update_timer": 0.16588422243879725, "synch_weights": 0.0012194712453064442, "restore_eval_env_runners": 1.0900359386459812e-05, "evaluation_iteration": 0.2040096755112678, "synch_eval_env_connectors": 0.0004586225973330637, "synch_env_connectors": 6.00108348696884e-06}, "env_runners": {"agent_episode_returns_mean": {"default_agent": 8.980000000000004}, "env_to_module_connector": {"timers": {"connectors": {"add_time_dim_to_batch_and_zero_pad": 4.075692225544942e-06, "add_states_from_episodes_to_batch": 2.68972929531547e-06, "numpy_to_tensor": 1.6592656320331036e-05, "add_observations_from_episodes_to_batch": 4.828327400084704e-06, "batch_individual_items": 1.134593268192006e-05}}, "connector_pipeline_timer": 7.266839642114942e-05}, "episode_len_mean": 20.0, "episode_len_min": 20, "episode_return_max": 12.5, "num_agent_steps_sampled": {"default_agent": 5000.0}, "module_to_env_connector": {"timers": {"connectors": {"listify_data_for_vector_env": 1.8334812403500474e-05, "tensor_to_numpy": 2.3202030899480876e-05, "normalize_and_clip_actions": 1.552071971246905e-05, "get_actions": 7.96556913267133e-05, "un_batch_to_individual_items": 8.878040473694956e-06, "remove_single_ts_time_rank_from_batch": 9.563217802288891e-07}}, "connector_pipeline_timer": 0.00018756900979971313}, "num_env_steps_sampled": 5000.0, "episode_return_mean": 8.980000000000004, "num_episodes_lifetime": -215625.0, "episode_return_min": -7.5, "time_between_sampling": 0.00278719153350852, "episode_len_max": 20, "env_reset_timer": 7.736007177673543e-05, "num_env_steps_sampled_lifetime": -4312500.0, "env_to_module_sum_episodes_length_in": 10.36823839457432, "sample": 0.008778720734565213, "num_episodes": 250.0, "num_module_steps_sampled_lifetime": {"default_policy": -4312500.0}, "module_episode_returns_mean": {"default_policy": 8.980000000000004}, "env_step_timer": 2.544146389204931e-05, "weights_seq_no": 8.0, "num_agent_steps_sampled_lifetime": {"default_agent": -4312500.0}, "rlmodule_inference_timer": 5.2977195741192275e-05, "env_to_module_sum_episodes_length_out": 10.36823839457432, "num_module_steps_sampled": {"default_policy": 5000.0}, "episode_duration_sec_mean": 0.008118467289954426, "num_env_steps_sampled_lifetime_throughput": 2345.6985019610906}, "learners": {"__all_modules__": {"learner_connector": {"timers": {"connectors": {"numpy_to_tensor": 8.780630527302172e-05, "add_columns_from_episodes_to_train_batch": 0.051121481930646855, "add_observations_from_episodes_to_batch": 0.0018663358205944457, "add_states_from_episodes_to_batch": 1.0795268052519545e-05, "general_advantage_estimation": 0.007294707652447673, "batch_individual_items": 0.04111112535451813, "add_one_ts_to_episodes_and_truncate": 0.011088793812273493, "add_time_dim_to_batch_and_zero_pad": 1.8982134060155676e-05}}, "connector_pipeline_timer": 0.11281500017213299}, "num_module_steps_trained_lifetime": 54000, "learner_connector_sum_episodes_length_in": 5000.0, "num_trainable_parameters": 6003, "learner_connector_sum_episodes_length_out": 5250.0, "num_env_steps_trained_lifetime": 283500, "num_module_steps_trained": 6000, "num_env_steps_trained": 31500, "num_non_trainable_parameters": 0, "num_env_steps_trained_lifetime_throughput": 1130683.044668173, "num_module_steps_trained_throughput": 216565.3967490809, "num_module_steps_trained_lifetime_throughput": 215136.912105202}, "default_policy": {"policy_loss": -0.10377395898103714, "mean_kl_loss": 0.0018121906323358417, "diff_num_grad_updates_vs_sampler_policy": 1.0, "num_module_steps_trained_lifetime": 54000, "entropy": 0.5701533555984497, "vf_explained_var": 0.019284963607788086, "gradients_default_optimizer_global_norm": 0.023104187101125717, "module_train_batch_size_mean": 1000.0, "weights_seq_no": 9.0, "total_loss": -0.04069652780890465, "curr_kl_coeff": 0.0014580006245523691, "default_optimizer_learning_rate": 0.0002847858517, "vf_loss_unclipped": 28.674518585205078, "vf_loss": 0.10202646255493164, "curr_entropy_coeff": 0.0090570820258, "num_trainable_parameters": 6003, "num_module_steps_trained": 6000, "num_module_steps_trained_lifetime_throughput": 219037.5016048921}}, "num_training_step_calls_per_iteration": 1, "evaluation": {"env_runners": {"module_to_env_connector": {"timers": {"connectors": {"tensor_to_numpy": 2.2040193112923583e-05, "normalize_and_clip_actions": 1.6332116858235364e-05, "get_actions": 8.176453478690727e-05, "un_batch_to_individual_items": 8.872883205499947e-06, "remove_single_ts_time_rank_from_batch": 7.660798149458302e-07, "listify_data_for_vector_env": 1.9849210164012437e-05}}, "connector_pipeline_timer": 0.00018929797012610556}, "episode_duration_sec_mean": 0.008755884529091418, "module_episode_returns_mean": {"default_policy": 1.35}, "episode_len_mean": 20.0, "env_to_module_connector": {"timers": {"connectors": {"add_time_dim_to_batch_and_zero_pad": 3.6141798419270675e-06, "add_states_from_episodes_to_batch": 2.265556393175275e-06, "add_observations_from_episodes_to_batch": 4.6659340640894445e-06, "batch_individual_items": 1.1554084110084545e-05, "numpy_to_tensor": 1.7747182885684523e-05}}, "connector_pipeline_timer": 7.409556193261813e-05}, "num_env_steps_sampled_lifetime": 45400, "env_to_module_sum_episodes_length_out": 10.368238394574323, "num_agent_steps_sampled": {"default_agent": 400}, "env_reset_timer": 0.0004786281960327274, "env_step_timer": 2.7472168371048444e-05, "weights_seq_no": 9.0, "rlmodule_inference_timer": 5.179534007014115e-05, "num_module_steps_sampled": {"default_policy": 400}, "agent_episode_returns_mean": {"default_agent": 1.35}, "env_to_module_sum_episodes_length_in": 10.368238394574323, "episode_len_max": 20, "sample": 0.1908416191604212, "episode_len_min": 20, "num_module_steps_sampled_lifetime": {"default_policy": 3600}, "episode_return_max": 12.5, "num_agent_steps_sampled_lifetime": {"default_agent": 3600}, "num_env_steps_sampled": 400, "episode_return_min": -16.5, "episode_return_mean": 1.35, "num_episodes_lifetime": 180, "num_episodes": 20, "time_between_sampling": 2.7409672542705366}, "num_healthy_workers": 1, "actor_manager_num_outstanding_async_reqs": 0, "num_remote_worker_restarts": 0}, "num_env_steps_sampled_lifetime": -4312500.0, "fault_tolerance": {"num_healthy_workers": 0, "num_remote_worker_restarts": 0}, "env_runner_group": {"actor_manager_num_outstanding_async_reqs": 0}, "done": false, "training_iteration": 9, "trial_id": "4638e_00000", "date": "2025-08-11_19-33-29", "timestamp": 1754933609, "time_this_iter_s": 2.8757238388061523, "time_total_s": 28.380950212478638, "pid": 25862, "hostname": "Mac", "node_ip": "127.0.0.1", "config": {"exploration_config": {}, "extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "placement_strategy": "PACK", "num_gpus": 0, "_fake_gpus": false, "num_cpus_for_main_process": 2, "eager_tracing": true, "eager_max_retraces": 20, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "torch_compile_learner": false, "torch_compile_learner_what_to_compile": "forward_train", "torch_compile_learner_dynamo_backend": "aot_eager", "torch_compile_learner_dynamo_mode": null, "torch_compile_worker": false, "torch_compile_worker_dynamo_backend": "aot_eager", "torch_compile_worker_dynamo_mode": null, "torch_ddp_kwargs": {}, "torch_skip_nan_gradients": false, "env": "Umbrella", "env_config": {}, "observation_space": null, "action_space": null, "clip_rewards": null, "normalize_actions": true, "clip_actions": false, "_is_atari": null, "disable_env_checking": false, "render_env": false, "action_mask_key": "action_mask", "env_runner_cls": null, "num_env_runners": 0, "create_local_env_runner": true, "num_envs_per_env_runner": 1, "gym_env_vectorize_mode": "SYNC", "num_cpus_per_env_runner": 1, "num_gpus_per_env_runner": 0, "custom_resources_per_env_runner": {}, "validate_env_runners_after_construction": true, "episodes_to_numpy": true, "max_requests_in_flight_per_env_runner": 1, "sample_timeout_s": 60.0, "_env_to_module_connector": null, "add_default_connectors_to_env_to_module_pipeline": true, "_module_to_env_connector": null, "add_default_connectors_to_module_to_env_pipeline": true, "merge_env_runner_states": "training_only", "broadcast_env_runner_states": true, "episode_lookback_horizon": 1, "rollout_fragment_length": "auto", "batch_mode": "complete_episodes", "compress_observations": false, "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "enable_tf1_exec_eagerly": false, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "preprocessor_pref": "deepmind", "observation_filter": "NoFilter", "update_worker_filter_stats": true, "use_worker_filter_stats": true, "sampler_perf_stats_ema_coef": null, "_is_online": true, "num_learners": 0, "num_gpus_per_learner": 0, "num_cpus_per_learner": "auto", "num_aggregator_actors_per_learner": 0, "max_requests_in_flight_per_aggregator_actor": 3, "local_gpu_idx": 0, "max_requests_in_flight_per_learner": 3, "gamma": 1, "lr": 0.0002847858517, "grad_clip": 0.5, "grad_clip_by": "global_norm", "_train_batch_size_per_learner": 5000, "train_batch_size": 4000, "num_epochs": 1, "minibatch_size": 1000, "shuffle_batch_per_epoch": true, "model": {"fcnet_hiddens": [256, 256], "fcnet_activation": "tanh", "fcnet_weights_initializer": null, "fcnet_weights_initializer_config": null, "fcnet_bias_initializer": null, "fcnet_bias_initializer_config": null, "conv_filters": null, "conv_activation": "relu", "conv_kernel_initializer": null, "conv_kernel_initializer_config": null, "conv_bias_initializer": null, "conv_bias_initializer_config": null, "conv_transpose_kernel_initializer": null, "conv_transpose_kernel_initializer_config": null, "conv_transpose_bias_initializer": null, "conv_transpose_bias_initializer_config": null, "post_fcnet_hiddens": [], "post_fcnet_activation": "relu", "post_fcnet_weights_initializer": null, "post_fcnet_weights_initializer_config": null, "post_fcnet_bias_initializer": null, "post_fcnet_bias_initializer_config": null, "free_log_std": false, "log_std_clip_param": 20.0, "no_final_linear": false, "vf_share_layers": false, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "lstm_weights_initializer": null, "lstm_weights_initializer_config": null, "lstm_bias_initializer": null, "lstm_bias_initializer_config": null, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "attention_use_n_prev_actions": 0, "attention_use_n_prev_rewards": 0, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": null, "custom_model_config": {}, "custom_action_dist": null, "custom_preprocessor": null, "encoder_latent_dim": null, "always_check_shapes": false, "lstm_use_prev_action_reward": -1, "_use_default_native_models": -1, "_disable_preprocessor_api": false, "_disable_action_flattening": false}, "_learner_connector": null, "add_default_connectors_to_learner_pipeline": true, "learner_config_dict": {}, "optimizer": {}, "_learner_class": null, "callbacks_on_algorithm_init": null, "callbacks_on_env_runners_recreated": null, "callbacks_on_offline_eval_runners_recreated": null, "callbacks_on_checkpoint_loaded": null, "callbacks_on_environment_created": null, "callbacks_on_episode_created": null, "callbacks_on_episode_start": null, "callbacks_on_episode_step": null, "callbacks_on_episode_end": null, "callbacks_on_evaluate_start": null, "callbacks_on_evaluate_end": null, "callbacks_on_evaluate_offline_start": null, "callbacks_on_evaluate_offline_end": null, "callbacks_on_sample_end": null, "callbacks_on_train_result": null, "explore": true, "enable_rl_module_and_learner": true, "enable_env_runner_and_connector_v2": true, "_prior_exploration_config": {"type": "StochasticSampling"}, "count_steps_by": "env_steps", "policy_map_capacity": 100, "policy_mapping_fn": "<function AlgorithmConfig.DEFAULT_POLICY_MAPPING_FN at 0x161d55b20>", "policies_to_train": null, "policy_states_are_swappable": false, "observation_fn": null, "offline_data_class": null, "input_read_method": "read_parquet", "input_read_method_kwargs": {}, "input_read_schema": {}, "input_read_episodes": false, "input_read_sample_batches": false, "input_read_batch_size": null, "input_filesystem": null, "input_filesystem_kwargs": {}, "input_compress_columns": ["obs", "new_obs"], "input_spaces_jsonable": true, "materialize_data": false, "materialize_mapped_data": true, "map_batches_kwargs": {}, "iter_batches_kwargs": {}, "ignore_final_observation": false, "prelearner_class": null, "prelearner_buffer_class": null, "prelearner_buffer_kwargs": {}, "prelearner_module_synch_period": 10, "dataset_num_iters_per_learner": null, "input_config": {}, "actions_in_input_normalized": false, "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_config": {}, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "output_max_rows_per_file": null, "output_write_remaining_data": false, "output_write_method": "write_parquet", "output_write_method_kwargs": {}, "output_filesystem": null, "output_filesystem_kwargs": {}, "output_write_episodes": true, "offline_sampling": false, "evaluation_interval": 1, "evaluation_duration": 20, "evaluation_duration_unit": "episodes", "evaluation_sample_timeout_s": 120.0, "evaluation_auto_duration_min_env_steps_per_sample": 100, "evaluation_auto_duration_max_env_steps_per_sample": 2000, "evaluation_parallel_to_training": false, "evaluation_force_reset_envs_before_iteration": true, "evaluation_config": null, "off_policy_estimation_methods": {}, "ope_split_batch_by_episode": true, "evaluation_num_env_runners": 1, "in_evaluation": false, "sync_filters_on_rollout_workers_timeout_s": 10.0, "offline_evaluation_interval": null, "num_offline_eval_runners": 0, "offline_loss_for_module_fn": null, "offline_evaluation_duration": 1, "offline_evaluation_parallel_to_training": false, "offline_evaluation_timeout_s": 120.0, "num_cpus_per_offline_eval_runner": 1, "num_gpus_per_offline_eval_runner": 0, "custom_resources_per_offline_eval_runner": {}, "restart_failed_offline_eval_runners": true, "ignore_offline_eval_runner_failures": false, "max_num_offline_eval_runner_restarts": 1000, "offline_eval_runner_restore_timeout_s": 1800.0, "max_requests_in_flight_per_offline_eval_runner": 1, "validate_offline_eval_runners_after_construction": true, "offline_eval_runner_health_probe_timeout_s": 30.0, "offline_eval_rl_module_inference_only": false, "broadcast_offline_eval_runner_states": false, "offline_eval_batch_size_per_runner": 256, "dataset_num_iters_per_eval_runner": 1, "keep_per_episode_custom_metrics": false, "metrics_episode_collection_timeout_s": 60.0, "metrics_num_episodes_for_smoothing": 100, "min_time_s_per_iteration": null, "min_train_timesteps_per_iteration": 0, "min_sample_timesteps_per_iteration": 0, "log_gradients": true, "export_native_model_files": false, "checkpoint_trainable_policies_only": false, "logger_creator": null, "logger_config": null, "log_level": "WARN", "log_sys_usage": true, "fake_sampler": false, "seed": 4, "restart_failed_env_runners": true, "ignore_env_runner_failures": false, "max_num_env_runner_restarts": 1000, "delay_between_env_runner_restarts_s": 60.0, "restart_failed_sub_environments": false, "num_consecutive_env_runner_failures_tolerance": 100, "env_runner_health_probe_timeout_s": 30.0, "env_runner_restore_timeout_s": 1800.0, "_model_config": {}, "_rl_module_spec": "RLModuleSpec(module_class=None, observation_space=None, action_space=None, inference_only=False, learner_only=False, model_config=DefaultModelConfig(fcnet_hiddens=[60, 90], fcnet_activation='tanh', fcnet_kernel_initializer=None, fcnet_kernel_initializer_kwargs=None, fcnet_bias_initializer=None, fcnet_bias_initializer_kwargs=None, conv_filters=None, conv_activation='relu', conv_kernel_initializer=None, conv_kernel_initializer_kwargs=None, conv_bias_initializer=None, conv_bias_initializer_kwargs=None, head_fcnet_hiddens=[], head_fcnet_activation='relu', head_fcnet_kernel_initializer=None, head_fcnet_kernel_initializer_kwargs=None, head_fcnet_bias_initializer=None, head_fcnet_bias_initializer_kwargs=None, free_log_std=False, log_std_clip_param=20.0, vf_share_layers=True, use_lstm=False, max_seq_len=20, lstm_cell_size=256, lstm_use_prev_action=False, lstm_use_prev_reward=False, lstm_kernel_initializer=None, lstm_kernel_initializer_kwargs=None, lstm_bias_initializer=None, lstm_bias_initializer_kwargs=None), catalog_class=None, load_state_path=None, model_config_dict=None)", "algorithm_config_overrides_per_module": {}, "_per_module_overrides": {}, "_validate_config": true, "_use_msgpack_checkpoints": false, "_torch_grad_scaler_class": null, "_torch_lr_scheduler_classes": null, "_tf_policy_handles_more_than_one_loss": false, "_disable_preprocessor_api": false, "_disable_action_flattening": false, "_disable_initialize_loss_from_dummy_batch": false, "_dont_auto_sync_env_runner_states": false, "env_task_fn": -1, "enable_connectors": -1, "simple_optimizer": false, "policy_map_cache": -1, "worker_cls": -1, "synchronize_filters": -1, "enable_async_evaluation": -1, "custom_async_evaluation_function": -1, "_enable_rl_module_api": -1, "auto_wrap_old_gym_envs": -1, "always_attach_evaluation_results": -1, "replay_sequence_length": null, "_disable_execution_plan_api": -1, "use_critic": true, "use_gae": true, "use_kl_loss": true, "kl_coeff": 0.7464963036515, "kl_target": 0.0270990929592, "vf_loss_coeff": 0.6688075857018, "entropy_coeff": 0.0090570820258, "clip_param": 0.1221781641624, "vf_clip_param": 0.1027808522125, "entropy_coeff_schedule": null, "lr_schedule": null, "sgd_minibatch_size": -1, "vf_share_layers": -1, "__stdout_file__": null, "__stderr_file__": null, "lambda": 0.9099046732075, "input": "sampler", "policies": {"default_policy": [null, null, null, null]}, "callbacks": "<class 'ray.rllib.callbacks.callbacks.RLlibCallback'>", "create_env_on_driver": false, "custom_eval_function": null, "framework": "torch"}, "time_since_restore": 28.380950212478638, "iterations_since_restore": 9, "perf": {"cpu_util_percent": 56.75, "ram_util_percent": 78.85}}
{"timers": {"training_iteration": 3.435004287124454, "restore_env_runners": 4.7210301379006804e-05, "training_step": 3.4346532265023133, "env_runner_sampling_timer": 3.2609964459849743, "learner_update_timer": 0.1665808502151755, "synch_weights": 0.0012325215329959838, "restore_eval_env_runners": 1.0863435503257579e-05, "evaluation_iteration": 0.20352646833625218, "synch_eval_env_connectors": 0.00045564887141449483, "synch_env_connectors": 5.994402511028071e-06}, "env_runners": {"agent_episode_returns_mean": {"default_agent": 8.260000000000002}, "env_to_module_connector": {"timers": {"connectors": {"add_time_dim_to_batch_and_zero_pad": 4.005471087292687e-06, "add_states_from_episodes_to_batch": 2.5976054772588183e-06, "numpy_to_tensor": 1.5491901424297895e-05, "add_observations_from_episodes_to_batch": 4.919786746438769e-06, "batch_individual_items": 1.0822248125842578e-05}}, "connector_pipeline_timer": 7.017919629868322e-05}, "episode_len_mean": 20.0, "episode_len_min": 20, "episode_return_max": 12.5, "num_agent_steps_sampled": {"default_agent": 5000.0}, "module_to_env_connector": {"timers": {"connectors": {"listify_data_for_vector_env": 1.8555682088750418e-05, "tensor_to_numpy": 2.25042362480691e-05, "normalize_and_clip_actions": 1.5113400868079498e-05, "get_actions": 7.693732434708525e-05, "un_batch_to_individual_items": 8.591033233988188e-06, "remove_single_ts_time_rank_from_batch": 9.353093746485418e-07}}, "connector_pipeline_timer": 0.00018304376452870657}, "num_env_steps_sampled": 5000.0, "episode_return_mean": 8.260000000000002, "num_episodes_lifetime": -246500.0, "episode_return_min": -7.5, "time_between_sampling": 0.002823664696270658, "episode_len_max": 20, "env_reset_timer": 7.901951746699622e-05, "num_env_steps_sampled_lifetime": -4930000.0, "env_to_module_sum_episodes_length_in": 10.36823839457432, "sample": 0.0084811410835791, "num_episodes": 250.0, "num_module_steps_sampled_lifetime": {"default_policy": -4930000.0}, "module_episode_returns_mean": {"default_policy": 8.260000000000002}, "env_step_timer": 2.440512879893176e-05, "weights_seq_no": 9.0, "num_agent_steps_sampled_lifetime": {"default_agent": -4930000.0}, "rlmodule_inference_timer": 5.1460427634435186e-05, "env_to_module_sum_episodes_length_out": 10.36823839457432, "num_module_steps_sampled": {"default_policy": 5000.0}, "episode_duration_sec_mean": 0.007953273524530234, "num_env_steps_sampled_lifetime_throughput": 2407.4312222482276}, "learners": {"__all_modules__": {"learner_connector": {"timers": {"connectors": {"numpy_to_tensor": 8.763782271065713e-05, "add_columns_from_episodes_to_train_batch": 0.05099131545169078, "add_observations_from_episodes_to_batch": 0.001858782041743026, "add_states_from_episodes_to_batch": 1.0722315638501616e-05, "general_advantage_estimation": 0.007279893495871744, "batch_individual_items": 0.0421298511909362, "add_one_ts_to_episodes_and_truncate": 0.011119322124413168, "add_time_dim_to_batch_and_zero_pad": 1.891647198858898e-05}}, "connector_pipeline_timer": 0.11371052934093637}, "num_module_steps_trained_lifetime": 60000, "learner_connector_sum_episodes_length_in": 5000.0, "num_trainable_parameters": 6003, "learner_connector_sum_episodes_length_out": 5250.0, "num_env_steps_trained_lifetime": 315000, "num_module_steps_trained": 6000, "num_env_steps_trained": 31500, "num_non_trainable_parameters": 0, "num_env_steps_trained_lifetime_throughput": 1124784.3501465935, "num_module_steps_trained_throughput": 215388.4726065804, "num_module_steps_trained_lifetime_throughput": 214015.82748538436}, "default_policy": {"policy_loss": -0.12937036156654358, "mean_kl_loss": 0.0017268538940697908, "diff_num_grad_updates_vs_sampler_policy": 1.0, "num_module_steps_trained_lifetime": 60000, "entropy": 0.5392490029335022, "vf_explained_var": 0.019550085067749023, "gradients_default_optimizer_global_norm": 0.07620148360729218, "module_train_batch_size_mean": 1000.0, "weights_seq_no": 10.0, "total_loss": -0.06608772277832031, "curr_kl_coeff": 0.0007290003122761846, "default_optimizer_learning_rate": 0.0002847858517, "vf_loss_unclipped": 28.66448402404785, "vf_loss": 0.10191888362169266, "curr_entropy_coeff": 0.0090570820258, "num_trainable_parameters": 6003, "num_module_steps_trained": 6000, "num_module_steps_trained_lifetime_throughput": 217742.389346654}}, "num_training_step_calls_per_iteration": 1, "evaluation": {"env_runners": {"module_to_env_connector": {"timers": {"connectors": {"tensor_to_numpy": 2.253079521520001e-05, "normalize_and_clip_actions": 1.3988399844650188e-05, "get_actions": 6.631638471004849e-05, "un_batch_to_individual_items": 7.970530799687922e-06, "remove_single_ts_time_rank_from_batch": 8.027590196329074e-07, "listify_data_for_vector_env": 1.768213027244939e-05}}, "connector_pipeline_timer": 0.0001673248044847421}, "episode_duration_sec_mean": 0.009025007471209393, "module_episode_returns_mean": {"default_policy": 1.55}, "episode_len_mean": 20.0, "env_to_module_connector": {"timers": {"connectors": {"add_time_dim_to_batch_and_zero_pad": 3.7861480059963767e-06, "add_states_from_episodes_to_batch": 2.381046379805359e-06, "add_observations_from_episodes_to_batch": 4.4254313428846865e-06, "batch_individual_items": 9.590877119770103e-06, "numpy_to_tensor": 1.2932459633749756e-05}}, "connector_pipeline_timer": 6.195290299355328e-05}, "num_env_steps_sampled_lifetime": 50400, "env_to_module_sum_episodes_length_out": 10.368238394574323, "num_agent_steps_sampled": {"default_agent": 400}, "env_reset_timer": 0.0004752748341800181, "env_step_timer": 2.402183394993925e-05, "weights_seq_no": 10.0, "rlmodule_inference_timer": 4.564941292366676e-05, "num_module_steps_sampled": {"default_policy": 400}, "agent_episode_returns_mean": {"default_agent": 1.55}, "env_to_module_sum_episodes_length_in": 10.368238394574323, "episode_len_max": 20, "sample": 0.1908762621284926, "episode_len_min": 20, "num_module_steps_sampled_lifetime": {"default_policy": 4000}, "episode_return_max": 12.5, "num_agent_steps_sampled_lifetime": {"default_agent": 4000}, "num_env_steps_sampled": 400, "episode_return_min": -16.5, "episode_return_mean": 1.55, "num_episodes_lifetime": 200, "num_episodes": 20, "time_between_sampling": 2.7403424167269566}, "num_healthy_workers": 1, "actor_manager_num_outstanding_async_reqs": 0, "num_remote_worker_restarts": 0}, "num_env_steps_sampled_lifetime": -4930000.0, "fault_tolerance": {"num_healthy_workers": 0, "num_remote_worker_restarts": 0}, "env_runner_group": {"actor_manager_num_outstanding_async_reqs": 0}, "done": false, "training_iteration": 10, "trial_id": "4638e_00000", "date": "2025-08-11_19-33-32", "timestamp": 1754933612, "time_this_iter_s": 2.8500609397888184, "time_total_s": 31.231011152267456, "pid": 25862, "hostname": "Mac", "node_ip": "127.0.0.1", "config": {"exploration_config": {}, "extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "placement_strategy": "PACK", "num_gpus": 0, "_fake_gpus": false, "num_cpus_for_main_process": 2, "eager_tracing": true, "eager_max_retraces": 20, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "torch_compile_learner": false, "torch_compile_learner_what_to_compile": "forward_train", "torch_compile_learner_dynamo_backend": "aot_eager", "torch_compile_learner_dynamo_mode": null, "torch_compile_worker": false, "torch_compile_worker_dynamo_backend": "aot_eager", "torch_compile_worker_dynamo_mode": null, "torch_ddp_kwargs": {}, "torch_skip_nan_gradients": false, "env": "Umbrella", "env_config": {}, "observation_space": null, "action_space": null, "clip_rewards": null, "normalize_actions": true, "clip_actions": false, "_is_atari": null, "disable_env_checking": false, "render_env": false, "action_mask_key": "action_mask", "env_runner_cls": null, "num_env_runners": 0, "create_local_env_runner": true, "num_envs_per_env_runner": 1, "gym_env_vectorize_mode": "SYNC", "num_cpus_per_env_runner": 1, "num_gpus_per_env_runner": 0, "custom_resources_per_env_runner": {}, "validate_env_runners_after_construction": true, "episodes_to_numpy": true, "max_requests_in_flight_per_env_runner": 1, "sample_timeout_s": 60.0, "_env_to_module_connector": null, "add_default_connectors_to_env_to_module_pipeline": true, "_module_to_env_connector": null, "add_default_connectors_to_module_to_env_pipeline": true, "merge_env_runner_states": "training_only", "broadcast_env_runner_states": true, "episode_lookback_horizon": 1, "rollout_fragment_length": "auto", "batch_mode": "complete_episodes", "compress_observations": false, "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "enable_tf1_exec_eagerly": false, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "preprocessor_pref": "deepmind", "observation_filter": "NoFilter", "update_worker_filter_stats": true, "use_worker_filter_stats": true, "sampler_perf_stats_ema_coef": null, "_is_online": true, "num_learners": 0, "num_gpus_per_learner": 0, "num_cpus_per_learner": "auto", "num_aggregator_actors_per_learner": 0, "max_requests_in_flight_per_aggregator_actor": 3, "local_gpu_idx": 0, "max_requests_in_flight_per_learner": 3, "gamma": 1, "lr": 0.0002847858517, "grad_clip": 0.5, "grad_clip_by": "global_norm", "_train_batch_size_per_learner": 5000, "train_batch_size": 4000, "num_epochs": 1, "minibatch_size": 1000, "shuffle_batch_per_epoch": true, "model": {"fcnet_hiddens": [256, 256], "fcnet_activation": "tanh", "fcnet_weights_initializer": null, "fcnet_weights_initializer_config": null, "fcnet_bias_initializer": null, "fcnet_bias_initializer_config": null, "conv_filters": null, "conv_activation": "relu", "conv_kernel_initializer": null, "conv_kernel_initializer_config": null, "conv_bias_initializer": null, "conv_bias_initializer_config": null, "conv_transpose_kernel_initializer": null, "conv_transpose_kernel_initializer_config": null, "conv_transpose_bias_initializer": null, "conv_transpose_bias_initializer_config": null, "post_fcnet_hiddens": [], "post_fcnet_activation": "relu", "post_fcnet_weights_initializer": null, "post_fcnet_weights_initializer_config": null, "post_fcnet_bias_initializer": null, "post_fcnet_bias_initializer_config": null, "free_log_std": false, "log_std_clip_param": 20.0, "no_final_linear": false, "vf_share_layers": false, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "lstm_weights_initializer": null, "lstm_weights_initializer_config": null, "lstm_bias_initializer": null, "lstm_bias_initializer_config": null, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "attention_use_n_prev_actions": 0, "attention_use_n_prev_rewards": 0, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": null, "custom_model_config": {}, "custom_action_dist": null, "custom_preprocessor": null, "encoder_latent_dim": null, "always_check_shapes": false, "lstm_use_prev_action_reward": -1, "_use_default_native_models": -1, "_disable_preprocessor_api": false, "_disable_action_flattening": false}, "_learner_connector": null, "add_default_connectors_to_learner_pipeline": true, "learner_config_dict": {}, "optimizer": {}, "_learner_class": null, "callbacks_on_algorithm_init": null, "callbacks_on_env_runners_recreated": null, "callbacks_on_offline_eval_runners_recreated": null, "callbacks_on_checkpoint_loaded": null, "callbacks_on_environment_created": null, "callbacks_on_episode_created": null, "callbacks_on_episode_start": null, "callbacks_on_episode_step": null, "callbacks_on_episode_end": null, "callbacks_on_evaluate_start": null, "callbacks_on_evaluate_end": null, "callbacks_on_evaluate_offline_start": null, "callbacks_on_evaluate_offline_end": null, "callbacks_on_sample_end": null, "callbacks_on_train_result": null, "explore": true, "enable_rl_module_and_learner": true, "enable_env_runner_and_connector_v2": true, "_prior_exploration_config": {"type": "StochasticSampling"}, "count_steps_by": "env_steps", "policy_map_capacity": 100, "policy_mapping_fn": "<function AlgorithmConfig.DEFAULT_POLICY_MAPPING_FN at 0x161d55b20>", "policies_to_train": null, "policy_states_are_swappable": false, "observation_fn": null, "offline_data_class": null, "input_read_method": "read_parquet", "input_read_method_kwargs": {}, "input_read_schema": {}, "input_read_episodes": false, "input_read_sample_batches": false, "input_read_batch_size": null, "input_filesystem": null, "input_filesystem_kwargs": {}, "input_compress_columns": ["obs", "new_obs"], "input_spaces_jsonable": true, "materialize_data": false, "materialize_mapped_data": true, "map_batches_kwargs": {}, "iter_batches_kwargs": {}, "ignore_final_observation": false, "prelearner_class": null, "prelearner_buffer_class": null, "prelearner_buffer_kwargs": {}, "prelearner_module_synch_period": 10, "dataset_num_iters_per_learner": null, "input_config": {}, "actions_in_input_normalized": false, "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_config": {}, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "output_max_rows_per_file": null, "output_write_remaining_data": false, "output_write_method": "write_parquet", "output_write_method_kwargs": {}, "output_filesystem": null, "output_filesystem_kwargs": {}, "output_write_episodes": true, "offline_sampling": false, "evaluation_interval": 1, "evaluation_duration": 20, "evaluation_duration_unit": "episodes", "evaluation_sample_timeout_s": 120.0, "evaluation_auto_duration_min_env_steps_per_sample": 100, "evaluation_auto_duration_max_env_steps_per_sample": 2000, "evaluation_parallel_to_training": false, "evaluation_force_reset_envs_before_iteration": true, "evaluation_config": null, "off_policy_estimation_methods": {}, "ope_split_batch_by_episode": true, "evaluation_num_env_runners": 1, "in_evaluation": false, "sync_filters_on_rollout_workers_timeout_s": 10.0, "offline_evaluation_interval": null, "num_offline_eval_runners": 0, "offline_loss_for_module_fn": null, "offline_evaluation_duration": 1, "offline_evaluation_parallel_to_training": false, "offline_evaluation_timeout_s": 120.0, "num_cpus_per_offline_eval_runner": 1, "num_gpus_per_offline_eval_runner": 0, "custom_resources_per_offline_eval_runner": {}, "restart_failed_offline_eval_runners": true, "ignore_offline_eval_runner_failures": false, "max_num_offline_eval_runner_restarts": 1000, "offline_eval_runner_restore_timeout_s": 1800.0, "max_requests_in_flight_per_offline_eval_runner": 1, "validate_offline_eval_runners_after_construction": true, "offline_eval_runner_health_probe_timeout_s": 30.0, "offline_eval_rl_module_inference_only": false, "broadcast_offline_eval_runner_states": false, "offline_eval_batch_size_per_runner": 256, "dataset_num_iters_per_eval_runner": 1, "keep_per_episode_custom_metrics": false, "metrics_episode_collection_timeout_s": 60.0, "metrics_num_episodes_for_smoothing": 100, "min_time_s_per_iteration": null, "min_train_timesteps_per_iteration": 0, "min_sample_timesteps_per_iteration": 0, "log_gradients": true, "export_native_model_files": false, "checkpoint_trainable_policies_only": false, "logger_creator": null, "logger_config": null, "log_level": "WARN", "log_sys_usage": true, "fake_sampler": false, "seed": 4, "restart_failed_env_runners": true, "ignore_env_runner_failures": false, "max_num_env_runner_restarts": 1000, "delay_between_env_runner_restarts_s": 60.0, "restart_failed_sub_environments": false, "num_consecutive_env_runner_failures_tolerance": 100, "env_runner_health_probe_timeout_s": 30.0, "env_runner_restore_timeout_s": 1800.0, "_model_config": {}, "_rl_module_spec": "RLModuleSpec(module_class=None, observation_space=None, action_space=None, inference_only=False, learner_only=False, model_config=DefaultModelConfig(fcnet_hiddens=[60, 90], fcnet_activation='tanh', fcnet_kernel_initializer=None, fcnet_kernel_initializer_kwargs=None, fcnet_bias_initializer=None, fcnet_bias_initializer_kwargs=None, conv_filters=None, conv_activation='relu', conv_kernel_initializer=None, conv_kernel_initializer_kwargs=None, conv_bias_initializer=None, conv_bias_initializer_kwargs=None, head_fcnet_hiddens=[], head_fcnet_activation='relu', head_fcnet_kernel_initializer=None, head_fcnet_kernel_initializer_kwargs=None, head_fcnet_bias_initializer=None, head_fcnet_bias_initializer_kwargs=None, free_log_std=False, log_std_clip_param=20.0, vf_share_layers=True, use_lstm=False, max_seq_len=20, lstm_cell_size=256, lstm_use_prev_action=False, lstm_use_prev_reward=False, lstm_kernel_initializer=None, lstm_kernel_initializer_kwargs=None, lstm_bias_initializer=None, lstm_bias_initializer_kwargs=None), catalog_class=None, load_state_path=None, model_config_dict=None)", "algorithm_config_overrides_per_module": {}, "_per_module_overrides": {}, "_validate_config": true, "_use_msgpack_checkpoints": false, "_torch_grad_scaler_class": null, "_torch_lr_scheduler_classes": null, "_tf_policy_handles_more_than_one_loss": false, "_disable_preprocessor_api": false, "_disable_action_flattening": false, "_disable_initialize_loss_from_dummy_batch": false, "_dont_auto_sync_env_runner_states": false, "env_task_fn": -1, "enable_connectors": -1, "simple_optimizer": false, "policy_map_cache": -1, "worker_cls": -1, "synchronize_filters": -1, "enable_async_evaluation": -1, "custom_async_evaluation_function": -1, "_enable_rl_module_api": -1, "auto_wrap_old_gym_envs": -1, "always_attach_evaluation_results": -1, "replay_sequence_length": null, "_disable_execution_plan_api": -1, "use_critic": true, "use_gae": true, "use_kl_loss": true, "kl_coeff": 0.7464963036515, "kl_target": 0.0270990929592, "vf_loss_coeff": 0.6688075857018, "entropy_coeff": 0.0090570820258, "clip_param": 0.1221781641624, "vf_clip_param": 0.1027808522125, "entropy_coeff_schedule": null, "lr_schedule": null, "sgd_minibatch_size": -1, "vf_share_layers": -1, "__stdout_file__": null, "__stderr_file__": null, "lambda": 0.9099046732075, "input": "sampler", "policies": {"default_policy": [null, null, null, null]}, "callbacks": "<class 'ray.rllib.callbacks.callbacks.RLlibCallback'>", "create_env_on_driver": false, "custom_eval_function": null, "framework": "torch"}, "time_since_restore": 31.231011152267456, "iterations_since_restore": 10, "perf": {"cpu_util_percent": 52.474999999999994, "ram_util_percent": 79.675}}
{"timers": {"training_iteration": 3.424894998003992, "restore_env_runners": 4.6815279278104784e-05, "training_step": 3.4245443963175712, "env_runner_sampling_timer": 3.2511317798550983, "learner_update_timer": 0.16633684962194245, "synch_weights": 0.0012329763171903788, "restore_eval_env_runners": 1.0834381498072677e-05, "evaluation_iteration": 0.20350304240263925, "synch_eval_env_connectors": 0.0004545294728997906, "synch_env_connectors": 5.976117708833558e-06}, "env_runners": {"agent_episode_returns_mean": {"default_agent": 8.980000000000004}, "env_to_module_connector": {"timers": {"connectors": {"add_time_dim_to_batch_and_zero_pad": 3.98270527331243e-06, "add_states_from_episodes_to_batch": 2.4499944552298815e-06, "numpy_to_tensor": 1.5546894628788456e-05, "add_observations_from_episodes_to_batch": 4.760619535743717e-06, "batch_individual_items": 1.081817481462944e-05}}, "connector_pipeline_timer": 7.011187979797753e-05}, "episode_len_mean": 20.0, "episode_len_min": 20, "episode_return_max": 12.5, "num_agent_steps_sampled": {"default_agent": 5000.0}, "module_to_env_connector": {"timers": {"connectors": {"listify_data_for_vector_env": 1.7205771372591356e-05, "tensor_to_numpy": 2.1909525578835156e-05, "normalize_and_clip_actions": 1.4462671798578884e-05, "get_actions": 7.447273284688116e-05, "un_batch_to_individual_items": 8.507272161147841e-06, "remove_single_ts_time_rank_from_batch": 9.058830729262545e-07}}, "connector_pipeline_timer": 0.0001768590687405399}, "num_env_steps_sampled": 5000.0, "episode_return_mean": 8.980000000000004, "num_episodes_lifetime": -277375.0, "episode_return_min": -7.5, "time_between_sampling": 0.002911373417922457, "episode_len_max": 20, "env_reset_timer": 7.19093145981614e-05, "num_env_steps_sampled_lifetime": -5547500.0, "env_to_module_sum_episodes_length_in": 10.36823839457432, "sample": 0.008241204857625004, "num_episodes": 250.0, "num_module_steps_sampled_lifetime": {"default_policy": -5547500.0}, "module_episode_returns_mean": {"default_policy": 8.980000000000004}, "env_step_timer": 2.3726040226433376e-05, "weights_seq_no": 10.0, "num_agent_steps_sampled_lifetime": {"default_agent": -5547500.0}, "rlmodule_inference_timer": 4.946788637558902e-05, "env_to_module_sum_episodes_length_out": 10.36823839457432, "num_module_steps_sampled": {"default_policy": 5000.0}, "episode_duration_sec_mean": 0.007589409681968392, "num_env_steps_sampled_lifetime_throughput": 2446.955982047555}, "learners": {"__all_modules__": {"learner_connector": {"timers": {"connectors": {"numpy_to_tensor": 8.757394543163693e-05, "add_columns_from_episodes_to_train_batch": 0.050897534796404895, "add_observations_from_episodes_to_batch": 0.0018492008812915578, "add_states_from_episodes_to_batch": 1.065718244172313e-05, "general_advantage_estimation": 0.007304475390888035, "batch_individual_items": 0.04217248184953664, "add_one_ts_to_episodes_and_truncate": 0.011087640573797599, "add_time_dim_to_batch_and_zero_pad": 1.8905647392669427e-05}}, "connector_pipeline_timer": 0.11364176238720967}, "num_module_steps_trained_lifetime": 66000, "learner_connector_sum_episodes_length_in": 5000.0, "num_trainable_parameters": 6003, "learner_connector_sum_episodes_length_out": 5250.0, "num_env_steps_trained_lifetime": 346500, "num_module_steps_trained": 6000, "num_env_steps_trained": 31500, "num_non_trainable_parameters": 0, "num_env_steps_trained_lifetime_throughput": 1117247.7568754326, "num_module_steps_trained_throughput": 213898.88974332868, "num_module_steps_trained_lifetime_throughput": 212585.12752339436}, "default_policy": {"policy_loss": -0.011589430272579193, "mean_kl_loss": 0.0015682962257415056, "diff_num_grad_updates_vs_sampler_policy": 1.0, "num_module_steps_trained_lifetime": 66000, "entropy": 0.5055301785469055, "vf_explained_var": 0.019914567470550537, "gradients_default_optimizer_global_norm": 0.041982702910900116, "module_train_batch_size_mean": 1000.0, "weights_seq_no": 11.0, "total_loss": 0.05192509666085243, "curr_kl_coeff": 0.0003645001561380923, "default_optimizer_learning_rate": 0.0002847858517, "vf_loss_unclipped": 28.64272689819336, "vf_loss": 0.10181104391813278, "curr_entropy_coeff": 0.0090570820258, "num_trainable_parameters": 6003, "num_module_steps_trained": 6000, "num_module_steps_trained_lifetime_throughput": 216122.1629443022}}, "num_training_step_calls_per_iteration": 1, "evaluation": {"env_runners": {"module_to_env_connector": {"timers": {"connectors": {"tensor_to_numpy": 1.7322483267465784e-05, "normalize_and_clip_actions": 1.1813022582986305e-05, "get_actions": 5.0261477626137865e-05, "un_batch_to_individual_items": 6.609211161163046e-06, "remove_single_ts_time_rank_from_batch": 7.549822634185205e-07, "listify_data_for_vector_env": 1.3711195560408475e-05}}, "connector_pipeline_timer": 0.00013095333709358547}, "episode_duration_sec_mean": 0.008031432429561391, "module_episode_returns_mean": {"default_policy": 1.95}, "episode_len_mean": 20.0, "env_to_module_connector": {"timers": {"connectors": {"add_time_dim_to_batch_and_zero_pad": 2.737418651571982e-06, "add_states_from_episodes_to_batch": 2.092418806575996e-06, "add_observations_from_episodes_to_batch": 3.564439371847072e-06, "batch_individual_items": 8.246855130535942e-06, "numpy_to_tensor": 1.127243964058546e-05}}, "connector_pipeline_timer": 5.330274062307808e-05}, "num_env_steps_sampled_lifetime": 55400, "env_to_module_sum_episodes_length_out": 10.368238394574323, "num_agent_steps_sampled": {"default_agent": 400}, "env_reset_timer": 0.000472533335145761, "env_step_timer": 1.8485329511792394e-05, "weights_seq_no": 11.0, "rlmodule_inference_timer": 3.738971211677594e-05, "num_module_steps_sampled": {"default_policy": 400}, "agent_episode_returns_mean": {"default_agent": 1.95}, "env_to_module_sum_episodes_length_in": 10.368238394574323, "episode_len_max": 20, "sample": 0.19055915159763606, "episode_len_min": 20, "num_module_steps_sampled_lifetime": {"default_policy": 4400}, "episode_return_max": 12.5, "num_agent_steps_sampled_lifetime": {"default_agent": 4400}, "num_env_steps_sampled": 400, "episode_return_min": -16.5, "episode_return_mean": 1.95, "num_episodes_lifetime": 220, "num_episodes": 20, "time_between_sampling": 2.7374555896506747}, "num_healthy_workers": 1, "actor_manager_num_outstanding_async_reqs": 0, "num_remote_worker_restarts": 0}, "num_env_steps_sampled_lifetime": -5547500.0, "fault_tolerance": {"num_healthy_workers": 0, "num_remote_worker_restarts": 0}, "env_runner_group": {"actor_manager_num_outstanding_async_reqs": 0}, "done": false, "training_iteration": 11, "trial_id": "4638e_00000", "date": "2025-08-11_19-33-34", "timestamp": 1754933614, "time_this_iter_s": 2.5978798866271973, "time_total_s": 33.82889103889465, "pid": 25862, "hostname": "Mac", "node_ip": "127.0.0.1", "config": {"exploration_config": {}, "extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "placement_strategy": "PACK", "num_gpus": 0, "_fake_gpus": false, "num_cpus_for_main_process": 2, "eager_tracing": true, "eager_max_retraces": 20, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "torch_compile_learner": false, "torch_compile_learner_what_to_compile": "forward_train", "torch_compile_learner_dynamo_backend": "aot_eager", "torch_compile_learner_dynamo_mode": null, "torch_compile_worker": false, "torch_compile_worker_dynamo_backend": "aot_eager", "torch_compile_worker_dynamo_mode": null, "torch_ddp_kwargs": {}, "torch_skip_nan_gradients": false, "env": "Umbrella", "env_config": {}, "observation_space": null, "action_space": null, "clip_rewards": null, "normalize_actions": true, "clip_actions": false, "_is_atari": null, "disable_env_checking": false, "render_env": false, "action_mask_key": "action_mask", "env_runner_cls": null, "num_env_runners": 0, "create_local_env_runner": true, "num_envs_per_env_runner": 1, "gym_env_vectorize_mode": "SYNC", "num_cpus_per_env_runner": 1, "num_gpus_per_env_runner": 0, "custom_resources_per_env_runner": {}, "validate_env_runners_after_construction": true, "episodes_to_numpy": true, "max_requests_in_flight_per_env_runner": 1, "sample_timeout_s": 60.0, "_env_to_module_connector": null, "add_default_connectors_to_env_to_module_pipeline": true, "_module_to_env_connector": null, "add_default_connectors_to_module_to_env_pipeline": true, "merge_env_runner_states": "training_only", "broadcast_env_runner_states": true, "episode_lookback_horizon": 1, "rollout_fragment_length": "auto", "batch_mode": "complete_episodes", "compress_observations": false, "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "enable_tf1_exec_eagerly": false, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "preprocessor_pref": "deepmind", "observation_filter": "NoFilter", "update_worker_filter_stats": true, "use_worker_filter_stats": true, "sampler_perf_stats_ema_coef": null, "_is_online": true, "num_learners": 0, "num_gpus_per_learner": 0, "num_cpus_per_learner": "auto", "num_aggregator_actors_per_learner": 0, "max_requests_in_flight_per_aggregator_actor": 3, "local_gpu_idx": 0, "max_requests_in_flight_per_learner": 3, "gamma": 1, "lr": 0.0002847858517, "grad_clip": 0.5, "grad_clip_by": "global_norm", "_train_batch_size_per_learner": 5000, "train_batch_size": 4000, "num_epochs": 1, "minibatch_size": 1000, "shuffle_batch_per_epoch": true, "model": {"fcnet_hiddens": [256, 256], "fcnet_activation": "tanh", "fcnet_weights_initializer": null, "fcnet_weights_initializer_config": null, "fcnet_bias_initializer": null, "fcnet_bias_initializer_config": null, "conv_filters": null, "conv_activation": "relu", "conv_kernel_initializer": null, "conv_kernel_initializer_config": null, "conv_bias_initializer": null, "conv_bias_initializer_config": null, "conv_transpose_kernel_initializer": null, "conv_transpose_kernel_initializer_config": null, "conv_transpose_bias_initializer": null, "conv_transpose_bias_initializer_config": null, "post_fcnet_hiddens": [], "post_fcnet_activation": "relu", "post_fcnet_weights_initializer": null, "post_fcnet_weights_initializer_config": null, "post_fcnet_bias_initializer": null, "post_fcnet_bias_initializer_config": null, "free_log_std": false, "log_std_clip_param": 20.0, "no_final_linear": false, "vf_share_layers": false, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "lstm_weights_initializer": null, "lstm_weights_initializer_config": null, "lstm_bias_initializer": null, "lstm_bias_initializer_config": null, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "attention_use_n_prev_actions": 0, "attention_use_n_prev_rewards": 0, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": null, "custom_model_config": {}, "custom_action_dist": null, "custom_preprocessor": null, "encoder_latent_dim": null, "always_check_shapes": false, "lstm_use_prev_action_reward": -1, "_use_default_native_models": -1, "_disable_preprocessor_api": false, "_disable_action_flattening": false}, "_learner_connector": null, "add_default_connectors_to_learner_pipeline": true, "learner_config_dict": {}, "optimizer": {}, "_learner_class": null, "callbacks_on_algorithm_init": null, "callbacks_on_env_runners_recreated": null, "callbacks_on_offline_eval_runners_recreated": null, "callbacks_on_checkpoint_loaded": null, "callbacks_on_environment_created": null, "callbacks_on_episode_created": null, "callbacks_on_episode_start": null, "callbacks_on_episode_step": null, "callbacks_on_episode_end": null, "callbacks_on_evaluate_start": null, "callbacks_on_evaluate_end": null, "callbacks_on_evaluate_offline_start": null, "callbacks_on_evaluate_offline_end": null, "callbacks_on_sample_end": null, "callbacks_on_train_result": null, "explore": true, "enable_rl_module_and_learner": true, "enable_env_runner_and_connector_v2": true, "_prior_exploration_config": {"type": "StochasticSampling"}, "count_steps_by": "env_steps", "policy_map_capacity": 100, "policy_mapping_fn": "<function AlgorithmConfig.DEFAULT_POLICY_MAPPING_FN at 0x161d55b20>", "policies_to_train": null, "policy_states_are_swappable": false, "observation_fn": null, "offline_data_class": null, "input_read_method": "read_parquet", "input_read_method_kwargs": {}, "input_read_schema": {}, "input_read_episodes": false, "input_read_sample_batches": false, "input_read_batch_size": null, "input_filesystem": null, "input_filesystem_kwargs": {}, "input_compress_columns": ["obs", "new_obs"], "input_spaces_jsonable": true, "materialize_data": false, "materialize_mapped_data": true, "map_batches_kwargs": {}, "iter_batches_kwargs": {}, "ignore_final_observation": false, "prelearner_class": null, "prelearner_buffer_class": null, "prelearner_buffer_kwargs": {}, "prelearner_module_synch_period": 10, "dataset_num_iters_per_learner": null, "input_config": {}, "actions_in_input_normalized": false, "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_config": {}, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "output_max_rows_per_file": null, "output_write_remaining_data": false, "output_write_method": "write_parquet", "output_write_method_kwargs": {}, "output_filesystem": null, "output_filesystem_kwargs": {}, "output_write_episodes": true, "offline_sampling": false, "evaluation_interval": 1, "evaluation_duration": 20, "evaluation_duration_unit": "episodes", "evaluation_sample_timeout_s": 120.0, "evaluation_auto_duration_min_env_steps_per_sample": 100, "evaluation_auto_duration_max_env_steps_per_sample": 2000, "evaluation_parallel_to_training": false, "evaluation_force_reset_envs_before_iteration": true, "evaluation_config": null, "off_policy_estimation_methods": {}, "ope_split_batch_by_episode": true, "evaluation_num_env_runners": 1, "in_evaluation": false, "sync_filters_on_rollout_workers_timeout_s": 10.0, "offline_evaluation_interval": null, "num_offline_eval_runners": 0, "offline_loss_for_module_fn": null, "offline_evaluation_duration": 1, "offline_evaluation_parallel_to_training": false, "offline_evaluation_timeout_s": 120.0, "num_cpus_per_offline_eval_runner": 1, "num_gpus_per_offline_eval_runner": 0, "custom_resources_per_offline_eval_runner": {}, "restart_failed_offline_eval_runners": true, "ignore_offline_eval_runner_failures": false, "max_num_offline_eval_runner_restarts": 1000, "offline_eval_runner_restore_timeout_s": 1800.0, "max_requests_in_flight_per_offline_eval_runner": 1, "validate_offline_eval_runners_after_construction": true, "offline_eval_runner_health_probe_timeout_s": 30.0, "offline_eval_rl_module_inference_only": false, "broadcast_offline_eval_runner_states": false, "offline_eval_batch_size_per_runner": 256, "dataset_num_iters_per_eval_runner": 1, "keep_per_episode_custom_metrics": false, "metrics_episode_collection_timeout_s": 60.0, "metrics_num_episodes_for_smoothing": 100, "min_time_s_per_iteration": null, "min_train_timesteps_per_iteration": 0, "min_sample_timesteps_per_iteration": 0, "log_gradients": true, "export_native_model_files": false, "checkpoint_trainable_policies_only": false, "logger_creator": null, "logger_config": null, "log_level": "WARN", "log_sys_usage": true, "fake_sampler": false, "seed": 4, "restart_failed_env_runners": true, "ignore_env_runner_failures": false, "max_num_env_runner_restarts": 1000, "delay_between_env_runner_restarts_s": 60.0, "restart_failed_sub_environments": false, "num_consecutive_env_runner_failures_tolerance": 100, "env_runner_health_probe_timeout_s": 30.0, "env_runner_restore_timeout_s": 1800.0, "_model_config": {}, "_rl_module_spec": "RLModuleSpec(module_class=None, observation_space=None, action_space=None, inference_only=False, learner_only=False, model_config=DefaultModelConfig(fcnet_hiddens=[60, 90], fcnet_activation='tanh', fcnet_kernel_initializer=None, fcnet_kernel_initializer_kwargs=None, fcnet_bias_initializer=None, fcnet_bias_initializer_kwargs=None, conv_filters=None, conv_activation='relu', conv_kernel_initializer=None, conv_kernel_initializer_kwargs=None, conv_bias_initializer=None, conv_bias_initializer_kwargs=None, head_fcnet_hiddens=[], head_fcnet_activation='relu', head_fcnet_kernel_initializer=None, head_fcnet_kernel_initializer_kwargs=None, head_fcnet_bias_initializer=None, head_fcnet_bias_initializer_kwargs=None, free_log_std=False, log_std_clip_param=20.0, vf_share_layers=True, use_lstm=False, max_seq_len=20, lstm_cell_size=256, lstm_use_prev_action=False, lstm_use_prev_reward=False, lstm_kernel_initializer=None, lstm_kernel_initializer_kwargs=None, lstm_bias_initializer=None, lstm_bias_initializer_kwargs=None), catalog_class=None, load_state_path=None, model_config_dict=None)", "algorithm_config_overrides_per_module": {}, "_per_module_overrides": {}, "_validate_config": true, "_use_msgpack_checkpoints": false, "_torch_grad_scaler_class": null, "_torch_lr_scheduler_classes": null, "_tf_policy_handles_more_than_one_loss": false, "_disable_preprocessor_api": false, "_disable_action_flattening": false, "_disable_initialize_loss_from_dummy_batch": false, "_dont_auto_sync_env_runner_states": false, "env_task_fn": -1, "enable_connectors": -1, "simple_optimizer": false, "policy_map_cache": -1, "worker_cls": -1, "synchronize_filters": -1, "enable_async_evaluation": -1, "custom_async_evaluation_function": -1, "_enable_rl_module_api": -1, "auto_wrap_old_gym_envs": -1, "always_attach_evaluation_results": -1, "replay_sequence_length": null, "_disable_execution_plan_api": -1, "use_critic": true, "use_gae": true, "use_kl_loss": true, "kl_coeff": 0.7464963036515, "kl_target": 0.0270990929592, "vf_loss_coeff": 0.6688075857018, "entropy_coeff": 0.0090570820258, "clip_param": 0.1221781641624, "vf_clip_param": 0.1027808522125, "entropy_coeff_schedule": null, "lr_schedule": null, "sgd_minibatch_size": -1, "vf_share_layers": -1, "__stdout_file__": null, "__stderr_file__": null, "lambda": 0.9099046732075, "input": "sampler", "policies": {"default_policy": [null, null, null, null]}, "callbacks": "<class 'ray.rllib.callbacks.callbacks.RLlibCallback'>", "create_env_on_driver": false, "custom_eval_function": null, "framework": "torch"}, "time_since_restore": 33.82889103889465, "iterations_since_restore": 11, "perf": {"cpu_util_percent": 70.57499999999999, "ram_util_percent": 79.05}}
{"timers": {"training_iteration": 3.4156937671940586, "restore_env_runners": 4.6432127132555675e-05, "training_step": 3.4153439744341165, "env_runner_sampling_timer": 3.242537694136677, "learner_update_timer": 0.16576724821549227, "synch_weights": 0.0012271073948322904, "restore_eval_env_runners": 1.1821867913134288e-05, "evaluation_iteration": 0.20313573614886926, "synch_eval_env_connectors": 0.0004521220978258624, "synch_env_connectors": 5.958856273284582e-06}, "env_runners": {"agent_episode_returns_mean": {"default_agent": 9.700000000000003}, "env_to_module_connector": {"timers": {"connectors": {"add_time_dim_to_batch_and_zero_pad": 3.7254879969524507e-06, "add_states_from_episodes_to_batch": 2.355899661170312e-06, "numpy_to_tensor": 1.5178279375827081e-05, "add_observations_from_episodes_to_batch": 4.564981257189361e-06, "batch_individual_items": 1.0761408472319216e-05}}, "connector_pipeline_timer": 6.807534152411034e-05}, "episode_len_mean": 20.0, "episode_len_min": 20, "episode_return_max": 12.5, "num_agent_steps_sampled": {"default_agent": 5000.0}, "module_to_env_connector": {"timers": {"connectors": {"listify_data_for_vector_env": 1.750108071736842e-05, "tensor_to_numpy": 2.1861303226188397e-05, "normalize_and_clip_actions": 1.4291879422721202e-05, "get_actions": 7.201671113167615e-05, "un_batch_to_individual_items": 8.288815753719802e-06, "remove_single_ts_time_rank_from_batch": 9.430529983847087e-07}}, "connector_pipeline_timer": 0.00017392022532176276}, "num_env_steps_sampled": 5000.0, "episode_return_mean": 9.700000000000003, "num_episodes_lifetime": -308250.0, "episode_return_min": -7.5, "time_between_sampling": 0.0027760299143432254, "episode_len_max": 20, "env_reset_timer": 7.048463899041643e-05, "num_env_steps_sampled_lifetime": -6165000.0, "env_to_module_sum_episodes_length_in": 10.36823839457432, "sample": 0.008040472501443723, "num_episodes": 250.0, "num_module_steps_sampled_lifetime": {"default_policy": -6165000.0}, "module_episode_returns_mean": {"default_policy": 9.700000000000003}, "env_step_timer": 2.3213189132840804e-05, "weights_seq_no": 11.0, "num_agent_steps_sampled_lifetime": {"default_agent": -6165000.0}, "rlmodule_inference_timer": 4.8074224784425707e-05, "env_to_module_sum_episodes_length_out": 10.36823839457432, "num_module_steps_sampled": {"default_policy": 5000.0}, "episode_duration_sec_mean": 0.00753515405021608, "num_env_steps_sampled_lifetime_throughput": 2465.529730840662}, "learners": {"__all_modules__": {"learner_connector": {"timers": {"connectors": {"numpy_to_tensor": 8.801028581672896e-05, "add_columns_from_episodes_to_train_batch": 0.0507924902785116, "add_observations_from_episodes_to_batch": 0.0018398367929721258, "add_states_from_episodes_to_batch": 1.0581859982143902e-05, "general_advantage_estimation": 0.007302052296958379, "batch_individual_items": 0.04210360953155074, "add_one_ts_to_episodes_and_truncate": 0.011065055007981307, "add_time_dim_to_batch_and_zero_pad": 1.884575139000328e-05}}, "connector_pipeline_timer": 0.1134331826734682}, "num_module_steps_trained_lifetime": 72000, "learner_connector_sum_episodes_length_in": 5000.0, "num_trainable_parameters": 6003, "learner_connector_sum_episodes_length_out": 5250.0, "num_env_steps_trained_lifetime": 378000, "num_module_steps_trained": 6000, "num_env_steps_trained": 31500, "num_non_trainable_parameters": 0, "num_env_steps_trained_lifetime_throughput": 1122097.8296877802, "num_module_steps_trained_throughput": 214771.37359143642, "num_module_steps_trained_lifetime_throughput": 213514.8357686887}, "default_policy": {"policy_loss": -0.02900618687272072, "mean_kl_loss": 0.00028911055414937437, "diff_num_grad_updates_vs_sampler_policy": 1.0, "num_module_steps_trained_lifetime": 72000, "entropy": 0.4821460247039795, "vf_explained_var": 0.01924508810043335, "gradients_default_optimizer_global_norm": 0.05857674777507782, "module_train_batch_size_mean": 1000.0, "weights_seq_no": 12.0, "total_loss": 0.03486289083957672, "curr_kl_coeff": 0.00018225007806904614, "default_optimizer_learning_rate": 0.0002847858517, "vf_loss_unclipped": 28.63893699645996, "vf_loss": 0.1020260602235794, "curr_entropy_coeff": 0.0090570820258, "num_trainable_parameters": 6003, "num_module_steps_trained": 6000, "num_module_steps_trained_lifetime_throughput": 216864.56657144282}}, "num_training_step_calls_per_iteration": 1, "evaluation": {"env_runners": {"module_to_env_connector": {"timers": {"connectors": {"tensor_to_numpy": 2.3418244194858543e-05, "normalize_and_clip_actions": 1.6015662958129883e-05, "get_actions": 7.264263044193295e-05, "un_batch_to_individual_items": 8.672473866518567e-06, "remove_single_ts_time_rank_from_batch": 1.0378171353997456e-06, "listify_data_for_vector_env": 1.8826867599877174e-05}}, "connector_pipeline_timer": 0.00018554079572342437}, "episode_duration_sec_mean": 0.008338144500739872, "module_episode_returns_mean": {"default_policy": 1.35}, "episode_len_mean": 20.0, "env_to_module_connector": {"timers": {"connectors": {"add_time_dim_to_batch_and_zero_pad": 4.269199435633641e-06, "add_states_from_episodes_to_batch": 2.182888475928549e-06, "add_observations_from_episodes_to_batch": 5.3574217455580754e-06, "batch_individual_items": 1.065894687482506e-05, "numpy_to_tensor": 1.5294830003157363e-05}}, "connector_pipeline_timer": 7.049532376437904e-05}, "num_env_steps_sampled_lifetime": 60400, "env_to_module_sum_episodes_length_out": 10.368238394574323, "num_agent_steps_sampled": {"default_agent": 400}, "env_reset_timer": 0.00046854467213005814, "env_step_timer": 2.5699817199354673e-05, "weights_seq_no": 12.0, "rlmodule_inference_timer": 4.9826463412958134e-05, "num_module_steps_sampled": {"default_policy": 400}, "agent_episode_returns_mean": {"default_agent": 1.35}, "env_to_module_sum_episodes_length_in": 10.368238394574323, "episode_len_max": 20, "sample": 0.1905389105015666, "episode_len_min": 20, "num_module_steps_sampled_lifetime": {"default_policy": 4800}, "episode_return_max": 12.5, "num_agent_steps_sampled_lifetime": {"default_agent": 4800}, "num_env_steps_sampled": 400, "episode_return_min": -16.5, "episode_return_mean": 1.35, "num_episodes_lifetime": 240, "num_episodes": 20, "time_between_sampling": 2.7353457604241616}, "num_healthy_workers": 1, "actor_manager_num_outstanding_async_reqs": 0, "num_remote_worker_restarts": 0}, "num_env_steps_sampled_lifetime": -6165000.0, "fault_tolerance": {"num_healthy_workers": 0, "num_remote_worker_restarts": 0}, "env_runner_group": {"actor_manager_num_outstanding_async_reqs": 0}, "done": false, "training_iteration": 12, "trial_id": "4638e_00000", "date": "2025-08-11_19-33-37", "timestamp": 1754933617, "time_this_iter_s": 2.703031063079834, "time_total_s": 36.53192210197449, "pid": 25862, "hostname": "Mac", "node_ip": "127.0.0.1", "config": {"exploration_config": {}, "extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "placement_strategy": "PACK", "num_gpus": 0, "_fake_gpus": false, "num_cpus_for_main_process": 2, "eager_tracing": true, "eager_max_retraces": 20, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "torch_compile_learner": false, "torch_compile_learner_what_to_compile": "forward_train", "torch_compile_learner_dynamo_backend": "aot_eager", "torch_compile_learner_dynamo_mode": null, "torch_compile_worker": false, "torch_compile_worker_dynamo_backend": "aot_eager", "torch_compile_worker_dynamo_mode": null, "torch_ddp_kwargs": {}, "torch_skip_nan_gradients": false, "env": "Umbrella", "env_config": {}, "observation_space": null, "action_space": null, "clip_rewards": null, "normalize_actions": true, "clip_actions": false, "_is_atari": null, "disable_env_checking": false, "render_env": false, "action_mask_key": "action_mask", "env_runner_cls": null, "num_env_runners": 0, "create_local_env_runner": true, "num_envs_per_env_runner": 1, "gym_env_vectorize_mode": "SYNC", "num_cpus_per_env_runner": 1, "num_gpus_per_env_runner": 0, "custom_resources_per_env_runner": {}, "validate_env_runners_after_construction": true, "episodes_to_numpy": true, "max_requests_in_flight_per_env_runner": 1, "sample_timeout_s": 60.0, "_env_to_module_connector": null, "add_default_connectors_to_env_to_module_pipeline": true, "_module_to_env_connector": null, "add_default_connectors_to_module_to_env_pipeline": true, "merge_env_runner_states": "training_only", "broadcast_env_runner_states": true, "episode_lookback_horizon": 1, "rollout_fragment_length": "auto", "batch_mode": "complete_episodes", "compress_observations": false, "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "enable_tf1_exec_eagerly": false, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "preprocessor_pref": "deepmind", "observation_filter": "NoFilter", "update_worker_filter_stats": true, "use_worker_filter_stats": true, "sampler_perf_stats_ema_coef": null, "_is_online": true, "num_learners": 0, "num_gpus_per_learner": 0, "num_cpus_per_learner": "auto", "num_aggregator_actors_per_learner": 0, "max_requests_in_flight_per_aggregator_actor": 3, "local_gpu_idx": 0, "max_requests_in_flight_per_learner": 3, "gamma": 1, "lr": 0.0002847858517, "grad_clip": 0.5, "grad_clip_by": "global_norm", "_train_batch_size_per_learner": 5000, "train_batch_size": 4000, "num_epochs": 1, "minibatch_size": 1000, "shuffle_batch_per_epoch": true, "model": {"fcnet_hiddens": [256, 256], "fcnet_activation": "tanh", "fcnet_weights_initializer": null, "fcnet_weights_initializer_config": null, "fcnet_bias_initializer": null, "fcnet_bias_initializer_config": null, "conv_filters": null, "conv_activation": "relu", "conv_kernel_initializer": null, "conv_kernel_initializer_config": null, "conv_bias_initializer": null, "conv_bias_initializer_config": null, "conv_transpose_kernel_initializer": null, "conv_transpose_kernel_initializer_config": null, "conv_transpose_bias_initializer": null, "conv_transpose_bias_initializer_config": null, "post_fcnet_hiddens": [], "post_fcnet_activation": "relu", "post_fcnet_weights_initializer": null, "post_fcnet_weights_initializer_config": null, "post_fcnet_bias_initializer": null, "post_fcnet_bias_initializer_config": null, "free_log_std": false, "log_std_clip_param": 20.0, "no_final_linear": false, "vf_share_layers": false, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "lstm_weights_initializer": null, "lstm_weights_initializer_config": null, "lstm_bias_initializer": null, "lstm_bias_initializer_config": null, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "attention_use_n_prev_actions": 0, "attention_use_n_prev_rewards": 0, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": null, "custom_model_config": {}, "custom_action_dist": null, "custom_preprocessor": null, "encoder_latent_dim": null, "always_check_shapes": false, "lstm_use_prev_action_reward": -1, "_use_default_native_models": -1, "_disable_preprocessor_api": false, "_disable_action_flattening": false}, "_learner_connector": null, "add_default_connectors_to_learner_pipeline": true, "learner_config_dict": {}, "optimizer": {}, "_learner_class": null, "callbacks_on_algorithm_init": null, "callbacks_on_env_runners_recreated": null, "callbacks_on_offline_eval_runners_recreated": null, "callbacks_on_checkpoint_loaded": null, "callbacks_on_environment_created": null, "callbacks_on_episode_created": null, "callbacks_on_episode_start": null, "callbacks_on_episode_step": null, "callbacks_on_episode_end": null, "callbacks_on_evaluate_start": null, "callbacks_on_evaluate_end": null, "callbacks_on_evaluate_offline_start": null, "callbacks_on_evaluate_offline_end": null, "callbacks_on_sample_end": null, "callbacks_on_train_result": null, "explore": true, "enable_rl_module_and_learner": true, "enable_env_runner_and_connector_v2": true, "_prior_exploration_config": {"type": "StochasticSampling"}, "count_steps_by": "env_steps", "policy_map_capacity": 100, "policy_mapping_fn": "<function AlgorithmConfig.DEFAULT_POLICY_MAPPING_FN at 0x161d55b20>", "policies_to_train": null, "policy_states_are_swappable": false, "observation_fn": null, "offline_data_class": null, "input_read_method": "read_parquet", "input_read_method_kwargs": {}, "input_read_schema": {}, "input_read_episodes": false, "input_read_sample_batches": false, "input_read_batch_size": null, "input_filesystem": null, "input_filesystem_kwargs": {}, "input_compress_columns": ["obs", "new_obs"], "input_spaces_jsonable": true, "materialize_data": false, "materialize_mapped_data": true, "map_batches_kwargs": {}, "iter_batches_kwargs": {}, "ignore_final_observation": false, "prelearner_class": null, "prelearner_buffer_class": null, "prelearner_buffer_kwargs": {}, "prelearner_module_synch_period": 10, "dataset_num_iters_per_learner": null, "input_config": {}, "actions_in_input_normalized": false, "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_config": {}, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "output_max_rows_per_file": null, "output_write_remaining_data": false, "output_write_method": "write_parquet", "output_write_method_kwargs": {}, "output_filesystem": null, "output_filesystem_kwargs": {}, "output_write_episodes": true, "offline_sampling": false, "evaluation_interval": 1, "evaluation_duration": 20, "evaluation_duration_unit": "episodes", "evaluation_sample_timeout_s": 120.0, "evaluation_auto_duration_min_env_steps_per_sample": 100, "evaluation_auto_duration_max_env_steps_per_sample": 2000, "evaluation_parallel_to_training": false, "evaluation_force_reset_envs_before_iteration": true, "evaluation_config": null, "off_policy_estimation_methods": {}, "ope_split_batch_by_episode": true, "evaluation_num_env_runners": 1, "in_evaluation": false, "sync_filters_on_rollout_workers_timeout_s": 10.0, "offline_evaluation_interval": null, "num_offline_eval_runners": 0, "offline_loss_for_module_fn": null, "offline_evaluation_duration": 1, "offline_evaluation_parallel_to_training": false, "offline_evaluation_timeout_s": 120.0, "num_cpus_per_offline_eval_runner": 1, "num_gpus_per_offline_eval_runner": 0, "custom_resources_per_offline_eval_runner": {}, "restart_failed_offline_eval_runners": true, "ignore_offline_eval_runner_failures": false, "max_num_offline_eval_runner_restarts": 1000, "offline_eval_runner_restore_timeout_s": 1800.0, "max_requests_in_flight_per_offline_eval_runner": 1, "validate_offline_eval_runners_after_construction": true, "offline_eval_runner_health_probe_timeout_s": 30.0, "offline_eval_rl_module_inference_only": false, "broadcast_offline_eval_runner_states": false, "offline_eval_batch_size_per_runner": 256, "dataset_num_iters_per_eval_runner": 1, "keep_per_episode_custom_metrics": false, "metrics_episode_collection_timeout_s": 60.0, "metrics_num_episodes_for_smoothing": 100, "min_time_s_per_iteration": null, "min_train_timesteps_per_iteration": 0, "min_sample_timesteps_per_iteration": 0, "log_gradients": true, "export_native_model_files": false, "checkpoint_trainable_policies_only": false, "logger_creator": null, "logger_config": null, "log_level": "WARN", "log_sys_usage": true, "fake_sampler": false, "seed": 4, "restart_failed_env_runners": true, "ignore_env_runner_failures": false, "max_num_env_runner_restarts": 1000, "delay_between_env_runner_restarts_s": 60.0, "restart_failed_sub_environments": false, "num_consecutive_env_runner_failures_tolerance": 100, "env_runner_health_probe_timeout_s": 30.0, "env_runner_restore_timeout_s": 1800.0, "_model_config": {}, "_rl_module_spec": "RLModuleSpec(module_class=None, observation_space=None, action_space=None, inference_only=False, learner_only=False, model_config=DefaultModelConfig(fcnet_hiddens=[60, 90], fcnet_activation='tanh', fcnet_kernel_initializer=None, fcnet_kernel_initializer_kwargs=None, fcnet_bias_initializer=None, fcnet_bias_initializer_kwargs=None, conv_filters=None, conv_activation='relu', conv_kernel_initializer=None, conv_kernel_initializer_kwargs=None, conv_bias_initializer=None, conv_bias_initializer_kwargs=None, head_fcnet_hiddens=[], head_fcnet_activation='relu', head_fcnet_kernel_initializer=None, head_fcnet_kernel_initializer_kwargs=None, head_fcnet_bias_initializer=None, head_fcnet_bias_initializer_kwargs=None, free_log_std=False, log_std_clip_param=20.0, vf_share_layers=True, use_lstm=False, max_seq_len=20, lstm_cell_size=256, lstm_use_prev_action=False, lstm_use_prev_reward=False, lstm_kernel_initializer=None, lstm_kernel_initializer_kwargs=None, lstm_bias_initializer=None, lstm_bias_initializer_kwargs=None), catalog_class=None, load_state_path=None, model_config_dict=None)", "algorithm_config_overrides_per_module": {}, "_per_module_overrides": {}, "_validate_config": true, "_use_msgpack_checkpoints": false, "_torch_grad_scaler_class": null, "_torch_lr_scheduler_classes": null, "_tf_policy_handles_more_than_one_loss": false, "_disable_preprocessor_api": false, "_disable_action_flattening": false, "_disable_initialize_loss_from_dummy_batch": false, "_dont_auto_sync_env_runner_states": false, "env_task_fn": -1, "enable_connectors": -1, "simple_optimizer": false, "policy_map_cache": -1, "worker_cls": -1, "synchronize_filters": -1, "enable_async_evaluation": -1, "custom_async_evaluation_function": -1, "_enable_rl_module_api": -1, "auto_wrap_old_gym_envs": -1, "always_attach_evaluation_results": -1, "replay_sequence_length": null, "_disable_execution_plan_api": -1, "use_critic": true, "use_gae": true, "use_kl_loss": true, "kl_coeff": 0.7464963036515, "kl_target": 0.0270990929592, "vf_loss_coeff": 0.6688075857018, "entropy_coeff": 0.0090570820258, "clip_param": 0.1221781641624, "vf_clip_param": 0.1027808522125, "entropy_coeff_schedule": null, "lr_schedule": null, "sgd_minibatch_size": -1, "vf_share_layers": -1, "__stdout_file__": null, "__stderr_file__": null, "lambda": 0.9099046732075, "input": "sampler", "policies": {"default_policy": [null, null, null, null]}, "callbacks": "<class 'ray.rllib.callbacks.callbacks.RLlibCallback'>", "create_env_on_driver": false, "custom_eval_function": null, "framework": "torch"}, "time_since_restore": 36.53192210197449, "iterations_since_restore": 12, "perf": {"cpu_util_percent": 70.06666666666666, "ram_util_percent": 79.03333333333335}}
{"timers": {"training_iteration": 3.406183729102375, "restore_env_runners": 4.605113594859384e-05, "training_step": 3.4058350159396276, "env_runner_sampling_timer": 3.233634880534521, "learner_update_timer": 0.16519438198304714, "synch_weights": 0.0012233417313987395, "restore_eval_env_runners": 1.1786979321366665e-05, "evaluation_iteration": 0.20305254753776728, "synch_eval_env_connectors": 0.00044899254635008556, "synch_env_connectors": 5.94218771140289e-06}, "env_runners": {"agent_episode_returns_mean": {"default_agent": 9.700000000000003}, "env_to_module_connector": {"timers": {"connectors": {"add_time_dim_to_batch_and_zero_pad": 3.7372931569569706e-06, "add_states_from_episodes_to_batch": 2.3672397869380975e-06, "numpy_to_tensor": 1.4156435004590618e-05, "add_observations_from_episodes_to_batch": 4.316477232282845e-06, "batch_individual_items": 1.0335348156318904e-05}}, "connector_pipeline_timer": 6.54283655498872e-05}, "episode_len_mean": 20.0, "episode_len_min": 20, "episode_return_max": 12.5, "num_agent_steps_sampled": {"default_agent": 5000.0}, "module_to_env_connector": {"timers": {"connectors": {"listify_data_for_vector_env": 1.726068613056553e-05, "tensor_to_numpy": 2.091361366575693e-05, "normalize_and_clip_actions": 1.4136194947010937e-05, "get_actions": 7.102114889369776e-05, "un_batch_to_individual_items": 8.267700243224397e-06, "remove_single_ts_time_rank_from_batch": 8.881037554952364e-07}}, "connector_pipeline_timer": 0.00017071731203442719}, "num_env_steps_sampled": 5000.0, "episode_return_mean": 9.700000000000003, "num_episodes_lifetime": -339125.0, "episode_return_min": -7.5, "time_between_sampling": 0.0026445818663627285, "episode_len_max": 20, "env_reset_timer": 7.158817718108009e-05, "num_env_steps_sampled_lifetime": -6782500.0, "env_to_module_sum_episodes_length_in": 10.36823839457432, "sample": 0.007868143395357451, "num_episodes": 250.0, "num_module_steps_sampled_lifetime": {"default_policy": -6782500.0}, "module_episode_returns_mean": {"default_policy": 9.700000000000003}, "env_step_timer": 2.311062901603546e-05, "weights_seq_no": 12.0, "num_agent_steps_sampled_lifetime": {"default_agent": -6782500.0}, "rlmodule_inference_timer": 4.59606531826282e-05, "env_to_module_sum_episodes_length_out": 10.36823839457432, "num_module_steps_sampled": {"default_policy": 5000.0}, "episode_duration_sec_mean": 0.007293582655955105, "num_env_steps_sampled_lifetime_throughput": 2543.618418980324}, "learners": {"__all_modules__": {"learner_connector": {"timers": {"connectors": {"numpy_to_tensor": 8.777935321012486e-05, "add_columns_from_episodes_to_train_batch": 0.050671494536176136, "add_observations_from_episodes_to_batch": 0.0018305971758055676, "add_states_from_episodes_to_batch": 1.0515631904969367e-05, "general_advantage_estimation": 0.007283004693693188, "batch_individual_items": 0.04200826176599336, "add_one_ts_to_episodes_and_truncate": 0.011049943628917338, "add_time_dim_to_batch_and_zero_pad": 1.8778543926245657e-05}}, "connector_pipeline_timer": 0.11317218876679018}, "num_module_steps_trained_lifetime": 78000, "learner_connector_sum_episodes_length_in": 5000.0, "num_trainable_parameters": 6003, "learner_connector_sum_episodes_length_out": 5250.0, "num_env_steps_trained_lifetime": 409500, "num_module_steps_trained": 6000, "num_env_steps_trained": 31500, "num_non_trainable_parameters": 0, "num_env_steps_trained_lifetime_throughput": 1136059.4588981173, "num_module_steps_trained_throughput": 217384.30322400943, "num_module_steps_trained_lifetime_throughput": 216181.48172989202}, "default_policy": {"policy_loss": -0.030638419091701508, "mean_kl_loss": 0.0008334144367836416, "diff_num_grad_updates_vs_sampler_policy": 1.0, "num_module_steps_trained_lifetime": 78000, "entropy": 0.45641592144966125, "vf_explained_var": 0.019546985626220703, "gradients_default_optimizer_global_norm": 0.049361228942871094, "module_train_batch_size_mean": 1000.0, "weights_seq_no": 13.0, "total_loss": 0.03346370533108711, "curr_kl_coeff": 9.112503903452307e-05, "default_optimizer_learning_rate": 0.0002847858517, "vf_loss_unclipped": 28.627490997314453, "vf_loss": 0.10202598571777344, "curr_entropy_coeff": 0.0090570820258, "num_trainable_parameters": 6003, "num_module_steps_trained": 6000, "num_module_steps_trained_lifetime_throughput": 219347.42382087078}}, "num_training_step_calls_per_iteration": 1, "evaluation": {"env_runners": {"module_to_env_connector": {"timers": {"connectors": {"tensor_to_numpy": 2.2466451307663168e-05, "normalize_and_clip_actions": 1.4926895400638111e-05, "get_actions": 7.378764378000723e-05, "un_batch_to_individual_items": 1.0272932798228773e-05, "remove_single_ts_time_rank_from_batch": 1.0816053761116101e-06, "listify_data_for_vector_env": 1.9993882111562126e-05}}, "connector_pipeline_timer": 0.00018320684103814358}, "episode_duration_sec_mean": 0.008137824472505599, "module_episode_returns_mean": {"default_policy": 1.35}, "episode_len_mean": 20.0, "env_to_module_connector": {"timers": {"connectors": {"add_time_dim_to_batch_and_zero_pad": 3.748049143098383e-06, "add_states_from_episodes_to_batch": 2.891194319115139e-06, "add_observations_from_episodes_to_batch": 4.790097763171856e-06, "batch_individual_items": 1.15424911566433e-05, "numpy_to_tensor": 1.6197942940746224e-05}}, "connector_pipeline_timer": 7.28634879231195e-05}, "num_env_steps_sampled_lifetime": 65400, "env_to_module_sum_episodes_length_out": 10.368238394574323, "num_agent_steps_sampled": {"default_agent": 400}, "env_reset_timer": 0.0004646154756374904, "env_step_timer": 2.497869730406824e-05, "weights_seq_no": 13.0, "rlmodule_inference_timer": 4.923549629244479e-05, "num_module_steps_sampled": {"default_policy": 400}, "agent_episode_returns_mean": {"default_agent": 1.35}, "env_to_module_sum_episodes_length_in": 10.368238394574323, "episode_len_max": 20, "sample": 0.19063929181720654, "episode_len_min": 20, "num_module_steps_sampled_lifetime": {"default_policy": 5200}, "episode_return_max": 12.5, "num_agent_steps_sampled_lifetime": {"default_agent": 5200}, "num_env_steps_sampled": 400, "episode_return_min": -16.5, "episode_return_mean": 1.35, "num_episodes_lifetime": 260, "num_episodes": 20, "time_between_sampling": 2.7328679215701492}, "num_healthy_workers": 1, "actor_manager_num_outstanding_async_reqs": 0, "num_remote_worker_restarts": 0}, "num_env_steps_sampled_lifetime": -6782500.0, "fault_tolerance": {"num_healthy_workers": 0, "num_remote_worker_restarts": 0}, "env_runner_group": {"actor_manager_num_outstanding_async_reqs": 0}, "done": false, "training_iteration": 13, "trial_id": "4638e_00000", "date": "2025-08-11_19-33-40", "timestamp": 1754933620, "time_this_iter_s": 2.6733758449554443, "time_total_s": 39.20529794692993, "pid": 25862, "hostname": "Mac", "node_ip": "127.0.0.1", "config": {"exploration_config": {}, "extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "placement_strategy": "PACK", "num_gpus": 0, "_fake_gpus": false, "num_cpus_for_main_process": 2, "eager_tracing": true, "eager_max_retraces": 20, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "torch_compile_learner": false, "torch_compile_learner_what_to_compile": "forward_train", "torch_compile_learner_dynamo_backend": "aot_eager", "torch_compile_learner_dynamo_mode": null, "torch_compile_worker": false, "torch_compile_worker_dynamo_backend": "aot_eager", "torch_compile_worker_dynamo_mode": null, "torch_ddp_kwargs": {}, "torch_skip_nan_gradients": false, "env": "Umbrella", "env_config": {}, "observation_space": null, "action_space": null, "clip_rewards": null, "normalize_actions": true, "clip_actions": false, "_is_atari": null, "disable_env_checking": false, "render_env": false, "action_mask_key": "action_mask", "env_runner_cls": null, "num_env_runners": 0, "create_local_env_runner": true, "num_envs_per_env_runner": 1, "gym_env_vectorize_mode": "SYNC", "num_cpus_per_env_runner": 1, "num_gpus_per_env_runner": 0, "custom_resources_per_env_runner": {}, "validate_env_runners_after_construction": true, "episodes_to_numpy": true, "max_requests_in_flight_per_env_runner": 1, "sample_timeout_s": 60.0, "_env_to_module_connector": null, "add_default_connectors_to_env_to_module_pipeline": true, "_module_to_env_connector": null, "add_default_connectors_to_module_to_env_pipeline": true, "merge_env_runner_states": "training_only", "broadcast_env_runner_states": true, "episode_lookback_horizon": 1, "rollout_fragment_length": "auto", "batch_mode": "complete_episodes", "compress_observations": false, "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "enable_tf1_exec_eagerly": false, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "preprocessor_pref": "deepmind", "observation_filter": "NoFilter", "update_worker_filter_stats": true, "use_worker_filter_stats": true, "sampler_perf_stats_ema_coef": null, "_is_online": true, "num_learners": 0, "num_gpus_per_learner": 0, "num_cpus_per_learner": "auto", "num_aggregator_actors_per_learner": 0, "max_requests_in_flight_per_aggregator_actor": 3, "local_gpu_idx": 0, "max_requests_in_flight_per_learner": 3, "gamma": 1, "lr": 0.0002847858517, "grad_clip": 0.5, "grad_clip_by": "global_norm", "_train_batch_size_per_learner": 5000, "train_batch_size": 4000, "num_epochs": 1, "minibatch_size": 1000, "shuffle_batch_per_epoch": true, "model": {"fcnet_hiddens": [256, 256], "fcnet_activation": "tanh", "fcnet_weights_initializer": null, "fcnet_weights_initializer_config": null, "fcnet_bias_initializer": null, "fcnet_bias_initializer_config": null, "conv_filters": null, "conv_activation": "relu", "conv_kernel_initializer": null, "conv_kernel_initializer_config": null, "conv_bias_initializer": null, "conv_bias_initializer_config": null, "conv_transpose_kernel_initializer": null, "conv_transpose_kernel_initializer_config": null, "conv_transpose_bias_initializer": null, "conv_transpose_bias_initializer_config": null, "post_fcnet_hiddens": [], "post_fcnet_activation": "relu", "post_fcnet_weights_initializer": null, "post_fcnet_weights_initializer_config": null, "post_fcnet_bias_initializer": null, "post_fcnet_bias_initializer_config": null, "free_log_std": false, "log_std_clip_param": 20.0, "no_final_linear": false, "vf_share_layers": false, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "lstm_weights_initializer": null, "lstm_weights_initializer_config": null, "lstm_bias_initializer": null, "lstm_bias_initializer_config": null, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "attention_use_n_prev_actions": 0, "attention_use_n_prev_rewards": 0, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": null, "custom_model_config": {}, "custom_action_dist": null, "custom_preprocessor": null, "encoder_latent_dim": null, "always_check_shapes": false, "lstm_use_prev_action_reward": -1, "_use_default_native_models": -1, "_disable_preprocessor_api": false, "_disable_action_flattening": false}, "_learner_connector": null, "add_default_connectors_to_learner_pipeline": true, "learner_config_dict": {}, "optimizer": {}, "_learner_class": null, "callbacks_on_algorithm_init": null, "callbacks_on_env_runners_recreated": null, "callbacks_on_offline_eval_runners_recreated": null, "callbacks_on_checkpoint_loaded": null, "callbacks_on_environment_created": null, "callbacks_on_episode_created": null, "callbacks_on_episode_start": null, "callbacks_on_episode_step": null, "callbacks_on_episode_end": null, "callbacks_on_evaluate_start": null, "callbacks_on_evaluate_end": null, "callbacks_on_evaluate_offline_start": null, "callbacks_on_evaluate_offline_end": null, "callbacks_on_sample_end": null, "callbacks_on_train_result": null, "explore": true, "enable_rl_module_and_learner": true, "enable_env_runner_and_connector_v2": true, "_prior_exploration_config": {"type": "StochasticSampling"}, "count_steps_by": "env_steps", "policy_map_capacity": 100, "policy_mapping_fn": "<function AlgorithmConfig.DEFAULT_POLICY_MAPPING_FN at 0x161d55b20>", "policies_to_train": null, "policy_states_are_swappable": false, "observation_fn": null, "offline_data_class": null, "input_read_method": "read_parquet", "input_read_method_kwargs": {}, "input_read_schema": {}, "input_read_episodes": false, "input_read_sample_batches": false, "input_read_batch_size": null, "input_filesystem": null, "input_filesystem_kwargs": {}, "input_compress_columns": ["obs", "new_obs"], "input_spaces_jsonable": true, "materialize_data": false, "materialize_mapped_data": true, "map_batches_kwargs": {}, "iter_batches_kwargs": {}, "ignore_final_observation": false, "prelearner_class": null, "prelearner_buffer_class": null, "prelearner_buffer_kwargs": {}, "prelearner_module_synch_period": 10, "dataset_num_iters_per_learner": null, "input_config": {}, "actions_in_input_normalized": false, "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_config": {}, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "output_max_rows_per_file": null, "output_write_remaining_data": false, "output_write_method": "write_parquet", "output_write_method_kwargs": {}, "output_filesystem": null, "output_filesystem_kwargs": {}, "output_write_episodes": true, "offline_sampling": false, "evaluation_interval": 1, "evaluation_duration": 20, "evaluation_duration_unit": "episodes", "evaluation_sample_timeout_s": 120.0, "evaluation_auto_duration_min_env_steps_per_sample": 100, "evaluation_auto_duration_max_env_steps_per_sample": 2000, "evaluation_parallel_to_training": false, "evaluation_force_reset_envs_before_iteration": true, "evaluation_config": null, "off_policy_estimation_methods": {}, "ope_split_batch_by_episode": true, "evaluation_num_env_runners": 1, "in_evaluation": false, "sync_filters_on_rollout_workers_timeout_s": 10.0, "offline_evaluation_interval": null, "num_offline_eval_runners": 0, "offline_loss_for_module_fn": null, "offline_evaluation_duration": 1, "offline_evaluation_parallel_to_training": false, "offline_evaluation_timeout_s": 120.0, "num_cpus_per_offline_eval_runner": 1, "num_gpus_per_offline_eval_runner": 0, "custom_resources_per_offline_eval_runner": {}, "restart_failed_offline_eval_runners": true, "ignore_offline_eval_runner_failures": false, "max_num_offline_eval_runner_restarts": 1000, "offline_eval_runner_restore_timeout_s": 1800.0, "max_requests_in_flight_per_offline_eval_runner": 1, "validate_offline_eval_runners_after_construction": true, "offline_eval_runner_health_probe_timeout_s": 30.0, "offline_eval_rl_module_inference_only": false, "broadcast_offline_eval_runner_states": false, "offline_eval_batch_size_per_runner": 256, "dataset_num_iters_per_eval_runner": 1, "keep_per_episode_custom_metrics": false, "metrics_episode_collection_timeout_s": 60.0, "metrics_num_episodes_for_smoothing": 100, "min_time_s_per_iteration": null, "min_train_timesteps_per_iteration": 0, "min_sample_timesteps_per_iteration": 0, "log_gradients": true, "export_native_model_files": false, "checkpoint_trainable_policies_only": false, "logger_creator": null, "logger_config": null, "log_level": "WARN", "log_sys_usage": true, "fake_sampler": false, "seed": 4, "restart_failed_env_runners": true, "ignore_env_runner_failures": false, "max_num_env_runner_restarts": 1000, "delay_between_env_runner_restarts_s": 60.0, "restart_failed_sub_environments": false, "num_consecutive_env_runner_failures_tolerance": 100, "env_runner_health_probe_timeout_s": 30.0, "env_runner_restore_timeout_s": 1800.0, "_model_config": {}, "_rl_module_spec": "RLModuleSpec(module_class=None, observation_space=None, action_space=None, inference_only=False, learner_only=False, model_config=DefaultModelConfig(fcnet_hiddens=[60, 90], fcnet_activation='tanh', fcnet_kernel_initializer=None, fcnet_kernel_initializer_kwargs=None, fcnet_bias_initializer=None, fcnet_bias_initializer_kwargs=None, conv_filters=None, conv_activation='relu', conv_kernel_initializer=None, conv_kernel_initializer_kwargs=None, conv_bias_initializer=None, conv_bias_initializer_kwargs=None, head_fcnet_hiddens=[], head_fcnet_activation='relu', head_fcnet_kernel_initializer=None, head_fcnet_kernel_initializer_kwargs=None, head_fcnet_bias_initializer=None, head_fcnet_bias_initializer_kwargs=None, free_log_std=False, log_std_clip_param=20.0, vf_share_layers=True, use_lstm=False, max_seq_len=20, lstm_cell_size=256, lstm_use_prev_action=False, lstm_use_prev_reward=False, lstm_kernel_initializer=None, lstm_kernel_initializer_kwargs=None, lstm_bias_initializer=None, lstm_bias_initializer_kwargs=None), catalog_class=None, load_state_path=None, model_config_dict=None)", "algorithm_config_overrides_per_module": {}, "_per_module_overrides": {}, "_validate_config": true, "_use_msgpack_checkpoints": false, "_torch_grad_scaler_class": null, "_torch_lr_scheduler_classes": null, "_tf_policy_handles_more_than_one_loss": false, "_disable_preprocessor_api": false, "_disable_action_flattening": false, "_disable_initialize_loss_from_dummy_batch": false, "_dont_auto_sync_env_runner_states": false, "env_task_fn": -1, "enable_connectors": -1, "simple_optimizer": false, "policy_map_cache": -1, "worker_cls": -1, "synchronize_filters": -1, "enable_async_evaluation": -1, "custom_async_evaluation_function": -1, "_enable_rl_module_api": -1, "auto_wrap_old_gym_envs": -1, "always_attach_evaluation_results": -1, "replay_sequence_length": null, "_disable_execution_plan_api": -1, "use_critic": true, "use_gae": true, "use_kl_loss": true, "kl_coeff": 0.7464963036515, "kl_target": 0.0270990929592, "vf_loss_coeff": 0.6688075857018, "entropy_coeff": 0.0090570820258, "clip_param": 0.1221781641624, "vf_clip_param": 0.1027808522125, "entropy_coeff_schedule": null, "lr_schedule": null, "sgd_minibatch_size": -1, "vf_share_layers": -1, "__stdout_file__": null, "__stderr_file__": null, "lambda": 0.9099046732075, "input": "sampler", "policies": {"default_policy": [null, null, null, null]}, "callbacks": "<class 'ray.rllib.callbacks.callbacks.RLlibCallback'>", "create_env_on_driver": false, "custom_eval_function": null, "framework": "torch"}, "time_since_restore": 39.20529794692993, "iterations_since_restore": 13, "perf": {"cpu_util_percent": 70.85, "ram_util_percent": 78.975}}
{"timers": {"training_iteration": 3.3986937530607455, "restore_env_runners": 4.565562508404997e-05, "training_step": 3.3983451303599903, "env_runner_sampling_timer": 3.2251623058993437, "learner_update_timer": 0.16619814816259731, "synch_weights": 0.0012211441448674787, "restore_eval_env_runners": 1.1733269504471478e-05, "evaluation_iteration": 0.20308536706230457, "synch_eval_env_connectors": 0.00044555469991037805, "synch_env_connectors": 5.927766176941063e-06}, "env_runners": {"agent_episode_returns_mean": {"default_agent": 10.42}, "env_to_module_connector": {"timers": {"connectors": {"add_time_dim_to_batch_and_zero_pad": 3.985210827931642e-06, "add_states_from_episodes_to_batch": 2.479067218925034e-06, "numpy_to_tensor": 1.5468735759419114e-05, "add_observations_from_episodes_to_batch": 4.711750573040133e-06, "batch_individual_items": 1.1070659680714682e-05}}, "connector_pipeline_timer": 6.966536202921309e-05}, "episode_len_mean": 20.0, "episode_len_min": 20, "episode_return_max": 12.5, "num_agent_steps_sampled": {"default_agent": 5000.0}, "module_to_env_connector": {"timers": {"connectors": {"listify_data_for_vector_env": 1.818947557591385e-05, "tensor_to_numpy": 2.2806420795120907e-05, "normalize_and_clip_actions": 1.4792016451403818e-05, "get_actions": 7.72155096124848e-05, "un_batch_to_individual_items": 8.946855803567547e-06, "remove_single_ts_time_rank_from_batch": 8.729321249559044e-07}}, "connector_pipeline_timer": 0.00018415953508605574}, "num_env_steps_sampled": 5000.0, "episode_return_mean": 10.42, "num_episodes_lifetime": -370000.0, "episode_return_min": -7.5, "time_between_sampling": 0.0026818399806351643, "episode_len_max": 20, "env_reset_timer": 7.144349301097055e-05, "num_env_steps_sampled_lifetime": -7400000.0, "env_to_module_sum_episodes_length_in": 10.36823839457432, "sample": 0.008031729653606448, "num_episodes": 250.0, "num_module_steps_sampled_lifetime": {"default_policy": -7400000.0}, "module_episode_returns_mean": {"default_policy": 10.42}, "env_step_timer": 2.4622520452878645e-05, "weights_seq_no": 13.0, "num_agent_steps_sampled_lifetime": {"default_agent": -7400000.0}, "rlmodule_inference_timer": 5.091491588725169e-05, "env_to_module_sum_episodes_length_out": 10.36823839457432, "num_module_steps_sampled": {"default_policy": 5000.0}, "episode_duration_sec_mean": 0.0079188023195602, "num_env_steps_sampled_lifetime_throughput": 2429.67684304236}, "learners": {"__all_modules__": {"learner_connector": {"timers": {"connectors": {"numpy_to_tensor": 8.921613958396569e-05, "add_columns_from_episodes_to_train_batch": 0.05054352292059828, "add_observations_from_episodes_to_batch": 0.001821191203131463, "add_states_from_episodes_to_batch": 1.044422555187052e-05, "general_advantage_estimation": 0.007296635057140718, "batch_individual_items": 0.04338975330867832, "add_one_ts_to_episodes_and_truncate": 0.011018899193442216, "add_time_dim_to_batch_and_zero_pad": 1.872075831271412e-05}}, "connector_pipeline_timer": 0.11440010562874409}, "num_module_steps_trained_lifetime": 84000, "learner_connector_sum_episodes_length_in": 5000.0, "num_trainable_parameters": 6003, "learner_connector_sum_episodes_length_out": 5250.0, "num_env_steps_trained_lifetime": 441000, "num_module_steps_trained": 6000, "num_env_steps_trained": 31500, "num_non_trainable_parameters": 0, "num_env_steps_trained_lifetime_throughput": 1143560.163478506, "num_module_steps_trained_throughput": 218773.17409650702, "num_module_steps_trained_lifetime_throughput": 217620.18018937632}, "default_policy": {"policy_loss": -0.10505218803882599, "mean_kl_loss": 0.0003316231013741344, "diff_num_grad_updates_vs_sampler_policy": 1.0, "num_module_steps_trained_lifetime": 84000, "entropy": 0.42842739820480347, "vf_explained_var": 0.01694488525390625, "gradients_default_optimizer_global_norm": 0.06715603172779083, "module_train_batch_size_mean": 1000.0, "weights_seq_no": 14.0, "total_loss": -0.04048038646578789, "curr_kl_coeff": 4.5562519517261535e-05, "default_optimizer_learning_rate": 0.0002847858517, "vf_loss_unclipped": 28.65528678894043, "vf_loss": 0.10234943777322769, "curr_entropy_coeff": 0.0090570820258, "num_trainable_parameters": 6003, "num_module_steps_trained": 6000, "num_module_steps_trained_lifetime_throughput": 220619.62093594897}}, "num_training_step_calls_per_iteration": 1, "evaluation": {"env_runners": {"module_to_env_connector": {"timers": {"connectors": {"tensor_to_numpy": 1.9780652639965264e-05, "normalize_and_clip_actions": 1.2103788595959849e-05, "get_actions": 5.769207669616162e-05, "un_batch_to_individual_items": 7.438922468259952e-06, "remove_single_ts_time_rank_from_batch": 7.407422348898045e-07, "listify_data_for_vector_env": 1.4325593759696542e-05}}, "connector_pipeline_timer": 0.0001453414609432621}, "episode_duration_sec_mean": 0.008156851587118581, "module_episode_returns_mean": {"default_policy": 1.75}, "episode_len_mean": 20.0, "env_to_module_connector": {"timers": {"connectors": {"add_time_dim_to_batch_and_zero_pad": 2.808712130075437e-06, "add_states_from_episodes_to_batch": 1.8241767729148842e-06, "add_observations_from_episodes_to_batch": 3.7374511468286776e-06, "batch_individual_items": 8.752500314916217e-06, "numpy_to_tensor": 1.2691937781104923e-05}}, "connector_pipeline_timer": 5.670723087368786e-05}, "num_env_steps_sampled_lifetime": 70400, "env_to_module_sum_episodes_length_out": 10.368238394574323, "num_agent_steps_sampled": {"default_agent": 400}, "env_reset_timer": 0.0004610514012974969, "env_step_timer": 2.1935014746575217e-05, "weights_seq_no": 14.0, "rlmodule_inference_timer": 4.068223377385158e-05, "num_module_steps_sampled": {"default_policy": 400}, "agent_episode_returns_mean": {"default_agent": 1.75}, "env_to_module_sum_episodes_length_in": 10.368238394574323, "episode_len_max": 20, "sample": 0.1902073309793201, "episode_len_min": 20, "num_module_steps_sampled_lifetime": {"default_policy": 5600}, "episode_return_max": 12.5, "num_agent_steps_sampled_lifetime": {"default_agent": 5600}, "num_env_steps_sampled": 400, "episode_return_min": -16.5, "episode_return_mean": 1.75, "num_episodes_lifetime": 280, "num_episodes": 20, "time_between_sampling": 2.732357095693464}, "num_healthy_workers": 1, "actor_manager_num_outstanding_async_reqs": 0, "num_remote_worker_restarts": 0}, "num_env_steps_sampled_lifetime": -7400000.0, "fault_tolerance": {"num_healthy_workers": 0, "num_remote_worker_restarts": 0}, "env_runner_group": {"actor_manager_num_outstanding_async_reqs": 0}, "done": false, "training_iteration": 14, "trial_id": "4638e_00000", "date": "2025-08-11_19-33-43", "timestamp": 1754933623, "time_this_iter_s": 2.8141908645629883, "time_total_s": 42.01948881149292, "pid": 25862, "hostname": "Mac", "node_ip": "127.0.0.1", "config": {"exploration_config": {}, "extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "placement_strategy": "PACK", "num_gpus": 0, "_fake_gpus": false, "num_cpus_for_main_process": 2, "eager_tracing": true, "eager_max_retraces": 20, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "torch_compile_learner": false, "torch_compile_learner_what_to_compile": "forward_train", "torch_compile_learner_dynamo_backend": "aot_eager", "torch_compile_learner_dynamo_mode": null, "torch_compile_worker": false, "torch_compile_worker_dynamo_backend": "aot_eager", "torch_compile_worker_dynamo_mode": null, "torch_ddp_kwargs": {}, "torch_skip_nan_gradients": false, "env": "Umbrella", "env_config": {}, "observation_space": null, "action_space": null, "clip_rewards": null, "normalize_actions": true, "clip_actions": false, "_is_atari": null, "disable_env_checking": false, "render_env": false, "action_mask_key": "action_mask", "env_runner_cls": null, "num_env_runners": 0, "create_local_env_runner": true, "num_envs_per_env_runner": 1, "gym_env_vectorize_mode": "SYNC", "num_cpus_per_env_runner": 1, "num_gpus_per_env_runner": 0, "custom_resources_per_env_runner": {}, "validate_env_runners_after_construction": true, "episodes_to_numpy": true, "max_requests_in_flight_per_env_runner": 1, "sample_timeout_s": 60.0, "_env_to_module_connector": null, "add_default_connectors_to_env_to_module_pipeline": true, "_module_to_env_connector": null, "add_default_connectors_to_module_to_env_pipeline": true, "merge_env_runner_states": "training_only", "broadcast_env_runner_states": true, "episode_lookback_horizon": 1, "rollout_fragment_length": "auto", "batch_mode": "complete_episodes", "compress_observations": false, "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "enable_tf1_exec_eagerly": false, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "preprocessor_pref": "deepmind", "observation_filter": "NoFilter", "update_worker_filter_stats": true, "use_worker_filter_stats": true, "sampler_perf_stats_ema_coef": null, "_is_online": true, "num_learners": 0, "num_gpus_per_learner": 0, "num_cpus_per_learner": "auto", "num_aggregator_actors_per_learner": 0, "max_requests_in_flight_per_aggregator_actor": 3, "local_gpu_idx": 0, "max_requests_in_flight_per_learner": 3, "gamma": 1, "lr": 0.0002847858517, "grad_clip": 0.5, "grad_clip_by": "global_norm", "_train_batch_size_per_learner": 5000, "train_batch_size": 4000, "num_epochs": 1, "minibatch_size": 1000, "shuffle_batch_per_epoch": true, "model": {"fcnet_hiddens": [256, 256], "fcnet_activation": "tanh", "fcnet_weights_initializer": null, "fcnet_weights_initializer_config": null, "fcnet_bias_initializer": null, "fcnet_bias_initializer_config": null, "conv_filters": null, "conv_activation": "relu", "conv_kernel_initializer": null, "conv_kernel_initializer_config": null, "conv_bias_initializer": null, "conv_bias_initializer_config": null, "conv_transpose_kernel_initializer": null, "conv_transpose_kernel_initializer_config": null, "conv_transpose_bias_initializer": null, "conv_transpose_bias_initializer_config": null, "post_fcnet_hiddens": [], "post_fcnet_activation": "relu", "post_fcnet_weights_initializer": null, "post_fcnet_weights_initializer_config": null, "post_fcnet_bias_initializer": null, "post_fcnet_bias_initializer_config": null, "free_log_std": false, "log_std_clip_param": 20.0, "no_final_linear": false, "vf_share_layers": false, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "lstm_weights_initializer": null, "lstm_weights_initializer_config": null, "lstm_bias_initializer": null, "lstm_bias_initializer_config": null, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "attention_use_n_prev_actions": 0, "attention_use_n_prev_rewards": 0, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": null, "custom_model_config": {}, "custom_action_dist": null, "custom_preprocessor": null, "encoder_latent_dim": null, "always_check_shapes": false, "lstm_use_prev_action_reward": -1, "_use_default_native_models": -1, "_disable_preprocessor_api": false, "_disable_action_flattening": false}, "_learner_connector": null, "add_default_connectors_to_learner_pipeline": true, "learner_config_dict": {}, "optimizer": {}, "_learner_class": null, "callbacks_on_algorithm_init": null, "callbacks_on_env_runners_recreated": null, "callbacks_on_offline_eval_runners_recreated": null, "callbacks_on_checkpoint_loaded": null, "callbacks_on_environment_created": null, "callbacks_on_episode_created": null, "callbacks_on_episode_start": null, "callbacks_on_episode_step": null, "callbacks_on_episode_end": null, "callbacks_on_evaluate_start": null, "callbacks_on_evaluate_end": null, "callbacks_on_evaluate_offline_start": null, "callbacks_on_evaluate_offline_end": null, "callbacks_on_sample_end": null, "callbacks_on_train_result": null, "explore": true, "enable_rl_module_and_learner": true, "enable_env_runner_and_connector_v2": true, "_prior_exploration_config": {"type": "StochasticSampling"}, "count_steps_by": "env_steps", "policy_map_capacity": 100, "policy_mapping_fn": "<function AlgorithmConfig.DEFAULT_POLICY_MAPPING_FN at 0x161d55b20>", "policies_to_train": null, "policy_states_are_swappable": false, "observation_fn": null, "offline_data_class": null, "input_read_method": "read_parquet", "input_read_method_kwargs": {}, "input_read_schema": {}, "input_read_episodes": false, "input_read_sample_batches": false, "input_read_batch_size": null, "input_filesystem": null, "input_filesystem_kwargs": {}, "input_compress_columns": ["obs", "new_obs"], "input_spaces_jsonable": true, "materialize_data": false, "materialize_mapped_data": true, "map_batches_kwargs": {}, "iter_batches_kwargs": {}, "ignore_final_observation": false, "prelearner_class": null, "prelearner_buffer_class": null, "prelearner_buffer_kwargs": {}, "prelearner_module_synch_period": 10, "dataset_num_iters_per_learner": null, "input_config": {}, "actions_in_input_normalized": false, "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_config": {}, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "output_max_rows_per_file": null, "output_write_remaining_data": false, "output_write_method": "write_parquet", "output_write_method_kwargs": {}, "output_filesystem": null, "output_filesystem_kwargs": {}, "output_write_episodes": true, "offline_sampling": false, "evaluation_interval": 1, "evaluation_duration": 20, "evaluation_duration_unit": "episodes", "evaluation_sample_timeout_s": 120.0, "evaluation_auto_duration_min_env_steps_per_sample": 100, "evaluation_auto_duration_max_env_steps_per_sample": 2000, "evaluation_parallel_to_training": false, "evaluation_force_reset_envs_before_iteration": true, "evaluation_config": null, "off_policy_estimation_methods": {}, "ope_split_batch_by_episode": true, "evaluation_num_env_runners": 1, "in_evaluation": false, "sync_filters_on_rollout_workers_timeout_s": 10.0, "offline_evaluation_interval": null, "num_offline_eval_runners": 0, "offline_loss_for_module_fn": null, "offline_evaluation_duration": 1, "offline_evaluation_parallel_to_training": false, "offline_evaluation_timeout_s": 120.0, "num_cpus_per_offline_eval_runner": 1, "num_gpus_per_offline_eval_runner": 0, "custom_resources_per_offline_eval_runner": {}, "restart_failed_offline_eval_runners": true, "ignore_offline_eval_runner_failures": false, "max_num_offline_eval_runner_restarts": 1000, "offline_eval_runner_restore_timeout_s": 1800.0, "max_requests_in_flight_per_offline_eval_runner": 1, "validate_offline_eval_runners_after_construction": true, "offline_eval_runner_health_probe_timeout_s": 30.0, "offline_eval_rl_module_inference_only": false, "broadcast_offline_eval_runner_states": false, "offline_eval_batch_size_per_runner": 256, "dataset_num_iters_per_eval_runner": 1, "keep_per_episode_custom_metrics": false, "metrics_episode_collection_timeout_s": 60.0, "metrics_num_episodes_for_smoothing": 100, "min_time_s_per_iteration": null, "min_train_timesteps_per_iteration": 0, "min_sample_timesteps_per_iteration": 0, "log_gradients": true, "export_native_model_files": false, "checkpoint_trainable_policies_only": false, "logger_creator": null, "logger_config": null, "log_level": "WARN", "log_sys_usage": true, "fake_sampler": false, "seed": 4, "restart_failed_env_runners": true, "ignore_env_runner_failures": false, "max_num_env_runner_restarts": 1000, "delay_between_env_runner_restarts_s": 60.0, "restart_failed_sub_environments": false, "num_consecutive_env_runner_failures_tolerance": 100, "env_runner_health_probe_timeout_s": 30.0, "env_runner_restore_timeout_s": 1800.0, "_model_config": {}, "_rl_module_spec": "RLModuleSpec(module_class=None, observation_space=None, action_space=None, inference_only=False, learner_only=False, model_config=DefaultModelConfig(fcnet_hiddens=[60, 90], fcnet_activation='tanh', fcnet_kernel_initializer=None, fcnet_kernel_initializer_kwargs=None, fcnet_bias_initializer=None, fcnet_bias_initializer_kwargs=None, conv_filters=None, conv_activation='relu', conv_kernel_initializer=None, conv_kernel_initializer_kwargs=None, conv_bias_initializer=None, conv_bias_initializer_kwargs=None, head_fcnet_hiddens=[], head_fcnet_activation='relu', head_fcnet_kernel_initializer=None, head_fcnet_kernel_initializer_kwargs=None, head_fcnet_bias_initializer=None, head_fcnet_bias_initializer_kwargs=None, free_log_std=False, log_std_clip_param=20.0, vf_share_layers=True, use_lstm=False, max_seq_len=20, lstm_cell_size=256, lstm_use_prev_action=False, lstm_use_prev_reward=False, lstm_kernel_initializer=None, lstm_kernel_initializer_kwargs=None, lstm_bias_initializer=None, lstm_bias_initializer_kwargs=None), catalog_class=None, load_state_path=None, model_config_dict=None)", "algorithm_config_overrides_per_module": {}, "_per_module_overrides": {}, "_validate_config": true, "_use_msgpack_checkpoints": false, "_torch_grad_scaler_class": null, "_torch_lr_scheduler_classes": null, "_tf_policy_handles_more_than_one_loss": false, "_disable_preprocessor_api": false, "_disable_action_flattening": false, "_disable_initialize_loss_from_dummy_batch": false, "_dont_auto_sync_env_runner_states": false, "env_task_fn": -1, "enable_connectors": -1, "simple_optimizer": false, "policy_map_cache": -1, "worker_cls": -1, "synchronize_filters": -1, "enable_async_evaluation": -1, "custom_async_evaluation_function": -1, "_enable_rl_module_api": -1, "auto_wrap_old_gym_envs": -1, "always_attach_evaluation_results": -1, "replay_sequence_length": null, "_disable_execution_plan_api": -1, "use_critic": true, "use_gae": true, "use_kl_loss": true, "kl_coeff": 0.7464963036515, "kl_target": 0.0270990929592, "vf_loss_coeff": 0.6688075857018, "entropy_coeff": 0.0090570820258, "clip_param": 0.1221781641624, "vf_clip_param": 0.1027808522125, "entropy_coeff_schedule": null, "lr_schedule": null, "sgd_minibatch_size": -1, "vf_share_layers": -1, "__stdout_file__": null, "__stderr_file__": null, "lambda": 0.9099046732075, "input": "sampler", "policies": {"default_policy": [null, null, null, null]}, "callbacks": "<class 'ray.rllib.callbacks.callbacks.RLlibCallback'>", "create_env_on_driver": false, "custom_eval_function": null, "framework": "torch"}, "time_since_restore": 42.01948881149292, "iterations_since_restore": 14, "perf": {"cpu_util_percent": 70.625, "ram_util_percent": 79.275}}
{"timers": {"training_iteration": 3.3912728963594994, "restore_env_runners": 4.6005319442666964e-05, "training_step": 3.39092117738627, "env_runner_sampling_timer": 3.216234007010547, "learner_update_timer": 0.16773753502149527, "synch_weights": 0.0012158456233443296, "restore_eval_env_runners": 1.1693027035540559e-05, "evaluation_iteration": 0.20258709756202672, "synch_eval_env_connectors": 0.0004467991532402174, "synch_env_connectors": 5.91390911713565e-06}, "env_runners": {"agent_episode_returns_mean": {"default_agent": 10.18}, "env_to_module_connector": {"timers": {"connectors": {"add_time_dim_to_batch_and_zero_pad": 4.18178163358991e-06, "add_states_from_episodes_to_batch": 2.5169218867683364e-06, "numpy_to_tensor": 1.5338402406645123e-05, "add_observations_from_episodes_to_batch": 4.931120325052784e-06, "batch_individual_items": 1.1494969423746358e-05}}, "connector_pipeline_timer": 7.057177605454196e-05}, "episode_len_mean": 20.0, "episode_len_min": 20, "episode_return_max": 12.5, "num_agent_steps_sampled": {"default_agent": 5000.0}, "module_to_env_connector": {"timers": {"connectors": {"listify_data_for_vector_env": 1.8192144825097987e-05, "tensor_to_numpy": 2.235166605808979e-05, "normalize_and_clip_actions": 1.4898277866694235e-05, "get_actions": 7.516183284508393e-05, "un_batch_to_individual_items": 8.631772169158754e-06, "remove_single_ts_time_rank_from_batch": 8.790422321519512e-07}}, "connector_pipeline_timer": 0.00017968750174160761}, "num_env_steps_sampled": 5000.0, "episode_return_mean": 10.18, "num_episodes_lifetime": -400875.0, "episode_return_min": -7.5, "time_between_sampling": 0.002857466555102384, "episode_len_max": 20, "env_reset_timer": 8.153003970682038e-05, "num_env_steps_sampled_lifetime": -8017500.0, "env_to_module_sum_episodes_length_in": 10.36823839457432, "sample": 0.00867181924647214, "num_episodes": 250.0, "num_module_steps_sampled_lifetime": {"default_policy": -8017500.0}, "module_episode_returns_mean": {"default_policy": 10.18}, "env_step_timer": 2.4262310196228095e-05, "weights_seq_no": 14.0, "num_agent_steps_sampled_lifetime": {"default_agent": -8017500.0}, "rlmodule_inference_timer": 4.9653736508089624e-05, "env_to_module_sum_episodes_length_out": 10.36823839457432, "num_module_steps_sampled": {"default_policy": 5000.0}, "episode_duration_sec_mean": 0.007694387118332088, "num_env_steps_sampled_lifetime_throughput": 2396.067102644084}, "learners": {"__all_modules__": {"learner_connector": {"timers": {"connectors": {"numpy_to_tensor": 8.909231814803058e-05, "add_columns_from_episodes_to_train_batch": 0.050676047272027944, "add_observations_from_episodes_to_batch": 0.0018236063806434165, "add_states_from_episodes_to_batch": 1.0393943196525359e-05, "general_advantage_estimation": 0.007297138707212593, "batch_individual_items": 0.0449569549453115, "add_one_ts_to_episodes_and_truncate": 0.011101570200877623, "add_time_dim_to_batch_and_zero_pad": 1.895772043204238e-05}}, "connector_pipeline_timer": 0.11618515123288552}, "num_module_steps_trained_lifetime": 90000, "learner_connector_sum_episodes_length_in": 5000.0, "num_trainable_parameters": 6003, "learner_connector_sum_episodes_length_out": 5250.0, "num_env_steps_trained_lifetime": 472500, "num_module_steps_trained": 6000, "num_env_steps_trained": 31500, "num_non_trainable_parameters": 0, "num_env_steps_trained_lifetime_throughput": 1146940.1355652846, "num_module_steps_trained_throughput": 219379.43106266344, "num_module_steps_trained_lifetime_throughput": 218274.14811134504}, "default_policy": {"policy_loss": -0.02631792053580284, "mean_kl_loss": 0.00024917605333030224, "diff_num_grad_updates_vs_sampler_policy": 1.0, "num_module_steps_trained_lifetime": 90000, "entropy": 0.4188220798969269, "vf_explained_var": 0.019069373607635498, "gradients_default_optimizer_global_norm": 0.008220300078392029, "module_train_batch_size_mean": 1000.0, "weights_seq_no": 15.0, "total_loss": 0.0381966270506382, "curr_kl_coeff": 2.2781259758630767e-05, "default_optimizer_learning_rate": 0.0002847858517, "vf_loss_unclipped": 28.625947952270508, "vf_loss": 0.10213375091552734, "curr_entropy_coeff": 0.0090570820258, "num_trainable_parameters": 6003, "num_module_steps_trained": 6000, "num_module_steps_trained_lifetime_throughput": 221116.18958754427}}, "num_training_step_calls_per_iteration": 1, "evaluation": {"env_runners": {"module_to_env_connector": {"timers": {"connectors": {"tensor_to_numpy": 2.610183648476528e-05, "normalize_and_clip_actions": 1.733307272568068e-05, "get_actions": 8.583159059002163e-05, "un_batch_to_individual_items": 8.71070163141449e-06, "remove_single_ts_time_rank_from_batch": 8.890061345962274e-07, "listify_data_for_vector_env": 1.9747759812645133e-05}}, "connector_pipeline_timer": 0.00020131812721266824}, "episode_duration_sec_mean": 0.008182681991020218, "module_episode_returns_mean": {"default_policy": 2.35}, "episode_len_mean": 20.0, "env_to_module_connector": {"timers": {"connectors": {"add_time_dim_to_batch_and_zero_pad": 4.430526651303813e-06, "add_states_from_episodes_to_batch": 2.765619564352527e-06, "add_observations_from_episodes_to_batch": 5.002881941026052e-06, "batch_individual_items": 1.1486891651328516e-05, "numpy_to_tensor": 1.7228095446961453e-05}}, "connector_pipeline_timer": 7.534212121285537e-05}, "num_env_steps_sampled_lifetime": 75400, "env_to_module_sum_episodes_length_out": 10.368238394574323, "num_agent_steps_sampled": {"default_agent": 400}, "env_reset_timer": 0.0004571804668391691, "env_step_timer": 3.0366545634464376e-05, "weights_seq_no": 15.0, "rlmodule_inference_timer": 6.199210165287564e-05, "num_module_steps_sampled": {"default_policy": 400}, "agent_episode_returns_mean": {"default_agent": 2.35}, "env_to_module_sum_episodes_length_in": 10.368238394574323, "episode_len_max": 20, "sample": 0.19027260349958, "episode_len_min": 20, "num_module_steps_sampled_lifetime": {"default_policy": 6000}, "episode_return_max": 12.5, "num_agent_steps_sampled_lifetime": {"default_agent": 6000}, "num_env_steps_sampled": 400, "episode_return_min": -16.5, "episode_return_mean": 2.35, "num_episodes_lifetime": 300, "num_episodes": 20, "time_between_sampling": 2.7318286264063794}, "num_healthy_workers": 1, "actor_manager_num_outstanding_async_reqs": 0, "num_remote_worker_restarts": 0}, "num_env_steps_sampled_lifetime": -8017500.0, "fault_tolerance": {"num_healthy_workers": 0, "num_remote_worker_restarts": 0}, "env_runner_group": {"actor_manager_num_outstanding_async_reqs": 0}, "done": false, "training_iteration": 15, "trial_id": "4638e_00000", "date": "2025-08-11_19-33-46", "timestamp": 1754933626, "time_this_iter_s": 2.862744092941284, "time_total_s": 44.882232904434204, "pid": 25862, "hostname": "Mac", "node_ip": "127.0.0.1", "config": {"exploration_config": {}, "extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "placement_strategy": "PACK", "num_gpus": 0, "_fake_gpus": false, "num_cpus_for_main_process": 2, "eager_tracing": true, "eager_max_retraces": 20, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "torch_compile_learner": false, "torch_compile_learner_what_to_compile": "forward_train", "torch_compile_learner_dynamo_backend": "aot_eager", "torch_compile_learner_dynamo_mode": null, "torch_compile_worker": false, "torch_compile_worker_dynamo_backend": "aot_eager", "torch_compile_worker_dynamo_mode": null, "torch_ddp_kwargs": {}, "torch_skip_nan_gradients": false, "env": "Umbrella", "env_config": {}, "observation_space": null, "action_space": null, "clip_rewards": null, "normalize_actions": true, "clip_actions": false, "_is_atari": null, "disable_env_checking": false, "render_env": false, "action_mask_key": "action_mask", "env_runner_cls": null, "num_env_runners": 0, "create_local_env_runner": true, "num_envs_per_env_runner": 1, "gym_env_vectorize_mode": "SYNC", "num_cpus_per_env_runner": 1, "num_gpus_per_env_runner": 0, "custom_resources_per_env_runner": {}, "validate_env_runners_after_construction": true, "episodes_to_numpy": true, "max_requests_in_flight_per_env_runner": 1, "sample_timeout_s": 60.0, "_env_to_module_connector": null, "add_default_connectors_to_env_to_module_pipeline": true, "_module_to_env_connector": null, "add_default_connectors_to_module_to_env_pipeline": true, "merge_env_runner_states": "training_only", "broadcast_env_runner_states": true, "episode_lookback_horizon": 1, "rollout_fragment_length": "auto", "batch_mode": "complete_episodes", "compress_observations": false, "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "enable_tf1_exec_eagerly": false, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "preprocessor_pref": "deepmind", "observation_filter": "NoFilter", "update_worker_filter_stats": true, "use_worker_filter_stats": true, "sampler_perf_stats_ema_coef": null, "_is_online": true, "num_learners": 0, "num_gpus_per_learner": 0, "num_cpus_per_learner": "auto", "num_aggregator_actors_per_learner": 0, "max_requests_in_flight_per_aggregator_actor": 3, "local_gpu_idx": 0, "max_requests_in_flight_per_learner": 3, "gamma": 1, "lr": 0.0002847858517, "grad_clip": 0.5, "grad_clip_by": "global_norm", "_train_batch_size_per_learner": 5000, "train_batch_size": 4000, "num_epochs": 1, "minibatch_size": 1000, "shuffle_batch_per_epoch": true, "model": {"fcnet_hiddens": [256, 256], "fcnet_activation": "tanh", "fcnet_weights_initializer": null, "fcnet_weights_initializer_config": null, "fcnet_bias_initializer": null, "fcnet_bias_initializer_config": null, "conv_filters": null, "conv_activation": "relu", "conv_kernel_initializer": null, "conv_kernel_initializer_config": null, "conv_bias_initializer": null, "conv_bias_initializer_config": null, "conv_transpose_kernel_initializer": null, "conv_transpose_kernel_initializer_config": null, "conv_transpose_bias_initializer": null, "conv_transpose_bias_initializer_config": null, "post_fcnet_hiddens": [], "post_fcnet_activation": "relu", "post_fcnet_weights_initializer": null, "post_fcnet_weights_initializer_config": null, "post_fcnet_bias_initializer": null, "post_fcnet_bias_initializer_config": null, "free_log_std": false, "log_std_clip_param": 20.0, "no_final_linear": false, "vf_share_layers": false, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "lstm_weights_initializer": null, "lstm_weights_initializer_config": null, "lstm_bias_initializer": null, "lstm_bias_initializer_config": null, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "attention_use_n_prev_actions": 0, "attention_use_n_prev_rewards": 0, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": null, "custom_model_config": {}, "custom_action_dist": null, "custom_preprocessor": null, "encoder_latent_dim": null, "always_check_shapes": false, "lstm_use_prev_action_reward": -1, "_use_default_native_models": -1, "_disable_preprocessor_api": false, "_disable_action_flattening": false}, "_learner_connector": null, "add_default_connectors_to_learner_pipeline": true, "learner_config_dict": {}, "optimizer": {}, "_learner_class": null, "callbacks_on_algorithm_init": null, "callbacks_on_env_runners_recreated": null, "callbacks_on_offline_eval_runners_recreated": null, "callbacks_on_checkpoint_loaded": null, "callbacks_on_environment_created": null, "callbacks_on_episode_created": null, "callbacks_on_episode_start": null, "callbacks_on_episode_step": null, "callbacks_on_episode_end": null, "callbacks_on_evaluate_start": null, "callbacks_on_evaluate_end": null, "callbacks_on_evaluate_offline_start": null, "callbacks_on_evaluate_offline_end": null, "callbacks_on_sample_end": null, "callbacks_on_train_result": null, "explore": true, "enable_rl_module_and_learner": true, "enable_env_runner_and_connector_v2": true, "_prior_exploration_config": {"type": "StochasticSampling"}, "count_steps_by": "env_steps", "policy_map_capacity": 100, "policy_mapping_fn": "<function AlgorithmConfig.DEFAULT_POLICY_MAPPING_FN at 0x161d55b20>", "policies_to_train": null, "policy_states_are_swappable": false, "observation_fn": null, "offline_data_class": null, "input_read_method": "read_parquet", "input_read_method_kwargs": {}, "input_read_schema": {}, "input_read_episodes": false, "input_read_sample_batches": false, "input_read_batch_size": null, "input_filesystem": null, "input_filesystem_kwargs": {}, "input_compress_columns": ["obs", "new_obs"], "input_spaces_jsonable": true, "materialize_data": false, "materialize_mapped_data": true, "map_batches_kwargs": {}, "iter_batches_kwargs": {}, "ignore_final_observation": false, "prelearner_class": null, "prelearner_buffer_class": null, "prelearner_buffer_kwargs": {}, "prelearner_module_synch_period": 10, "dataset_num_iters_per_learner": null, "input_config": {}, "actions_in_input_normalized": false, "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_config": {}, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "output_max_rows_per_file": null, "output_write_remaining_data": false, "output_write_method": "write_parquet", "output_write_method_kwargs": {}, "output_filesystem": null, "output_filesystem_kwargs": {}, "output_write_episodes": true, "offline_sampling": false, "evaluation_interval": 1, "evaluation_duration": 20, "evaluation_duration_unit": "episodes", "evaluation_sample_timeout_s": 120.0, "evaluation_auto_duration_min_env_steps_per_sample": 100, "evaluation_auto_duration_max_env_steps_per_sample": 2000, "evaluation_parallel_to_training": false, "evaluation_force_reset_envs_before_iteration": true, "evaluation_config": null, "off_policy_estimation_methods": {}, "ope_split_batch_by_episode": true, "evaluation_num_env_runners": 1, "in_evaluation": false, "sync_filters_on_rollout_workers_timeout_s": 10.0, "offline_evaluation_interval": null, "num_offline_eval_runners": 0, "offline_loss_for_module_fn": null, "offline_evaluation_duration": 1, "offline_evaluation_parallel_to_training": false, "offline_evaluation_timeout_s": 120.0, "num_cpus_per_offline_eval_runner": 1, "num_gpus_per_offline_eval_runner": 0, "custom_resources_per_offline_eval_runner": {}, "restart_failed_offline_eval_runners": true, "ignore_offline_eval_runner_failures": false, "max_num_offline_eval_runner_restarts": 1000, "offline_eval_runner_restore_timeout_s": 1800.0, "max_requests_in_flight_per_offline_eval_runner": 1, "validate_offline_eval_runners_after_construction": true, "offline_eval_runner_health_probe_timeout_s": 30.0, "offline_eval_rl_module_inference_only": false, "broadcast_offline_eval_runner_states": false, "offline_eval_batch_size_per_runner": 256, "dataset_num_iters_per_eval_runner": 1, "keep_per_episode_custom_metrics": false, "metrics_episode_collection_timeout_s": 60.0, "metrics_num_episodes_for_smoothing": 100, "min_time_s_per_iteration": null, "min_train_timesteps_per_iteration": 0, "min_sample_timesteps_per_iteration": 0, "log_gradients": true, "export_native_model_files": false, "checkpoint_trainable_policies_only": false, "logger_creator": null, "logger_config": null, "log_level": "WARN", "log_sys_usage": true, "fake_sampler": false, "seed": 4, "restart_failed_env_runners": true, "ignore_env_runner_failures": false, "max_num_env_runner_restarts": 1000, "delay_between_env_runner_restarts_s": 60.0, "restart_failed_sub_environments": false, "num_consecutive_env_runner_failures_tolerance": 100, "env_runner_health_probe_timeout_s": 30.0, "env_runner_restore_timeout_s": 1800.0, "_model_config": {}, "_rl_module_spec": "RLModuleSpec(module_class=None, observation_space=None, action_space=None, inference_only=False, learner_only=False, model_config=DefaultModelConfig(fcnet_hiddens=[60, 90], fcnet_activation='tanh', fcnet_kernel_initializer=None, fcnet_kernel_initializer_kwargs=None, fcnet_bias_initializer=None, fcnet_bias_initializer_kwargs=None, conv_filters=None, conv_activation='relu', conv_kernel_initializer=None, conv_kernel_initializer_kwargs=None, conv_bias_initializer=None, conv_bias_initializer_kwargs=None, head_fcnet_hiddens=[], head_fcnet_activation='relu', head_fcnet_kernel_initializer=None, head_fcnet_kernel_initializer_kwargs=None, head_fcnet_bias_initializer=None, head_fcnet_bias_initializer_kwargs=None, free_log_std=False, log_std_clip_param=20.0, vf_share_layers=True, use_lstm=False, max_seq_len=20, lstm_cell_size=256, lstm_use_prev_action=False, lstm_use_prev_reward=False, lstm_kernel_initializer=None, lstm_kernel_initializer_kwargs=None, lstm_bias_initializer=None, lstm_bias_initializer_kwargs=None), catalog_class=None, load_state_path=None, model_config_dict=None)", "algorithm_config_overrides_per_module": {}, "_per_module_overrides": {}, "_validate_config": true, "_use_msgpack_checkpoints": false, "_torch_grad_scaler_class": null, "_torch_lr_scheduler_classes": null, "_tf_policy_handles_more_than_one_loss": false, "_disable_preprocessor_api": false, "_disable_action_flattening": false, "_disable_initialize_loss_from_dummy_batch": false, "_dont_auto_sync_env_runner_states": false, "env_task_fn": -1, "enable_connectors": -1, "simple_optimizer": false, "policy_map_cache": -1, "worker_cls": -1, "synchronize_filters": -1, "enable_async_evaluation": -1, "custom_async_evaluation_function": -1, "_enable_rl_module_api": -1, "auto_wrap_old_gym_envs": -1, "always_attach_evaluation_results": -1, "replay_sequence_length": null, "_disable_execution_plan_api": -1, "use_critic": true, "use_gae": true, "use_kl_loss": true, "kl_coeff": 0.7464963036515, "kl_target": 0.0270990929592, "vf_loss_coeff": 0.6688075857018, "entropy_coeff": 0.0090570820258, "clip_param": 0.1221781641624, "vf_clip_param": 0.1027808522125, "entropy_coeff_schedule": null, "lr_schedule": null, "sgd_minibatch_size": -1, "vf_share_layers": -1, "__stdout_file__": null, "__stderr_file__": null, "lambda": 0.9099046732075, "input": "sampler", "policies": {"default_policy": [null, null, null, null]}, "callbacks": "<class 'ray.rllib.callbacks.callbacks.RLlibCallback'>", "create_env_on_driver": false, "custom_eval_function": null, "framework": "torch"}, "time_since_restore": 44.882232904434204, "iterations_since_restore": 15, "perf": {"cpu_util_percent": 71.7, "ram_util_percent": 79.225}}
{"timers": {"training_iteration": 3.3840609603162144, "restore_env_runners": 4.5611517043738784e-05, "training_step": 3.383710610611822, "env_runner_sampling_timer": 3.209356233191071, "learner_update_timer": 0.16738271051125767, "synch_weights": 0.0012252063379520884, "restore_eval_env_runners": 1.164609613404647e-05, "evaluation_iteration": 0.20259908408607857, "synch_eval_env_connectors": 0.00044334241271409066, "synch_env_connectors": 5.901860023643288e-06}, "env_runners": {"agent_episode_returns_mean": {"default_agent": 11.059999999999997}, "env_to_module_connector": {"timers": {"connectors": {"add_time_dim_to_batch_and_zero_pad": 4.144782249290678e-06, "add_states_from_episodes_to_batch": 2.5140357675435985e-06, "numpy_to_tensor": 1.657719828507657e-05, "add_observations_from_episodes_to_batch": 4.9746134868506004e-06, "batch_individual_items": 1.3151696445517193e-05}}, "connector_pipeline_timer": 7.482917521971283e-05}, "episode_len_mean": 20.0, "episode_len_min": 20, "episode_return_max": 12.5, "num_agent_steps_sampled": {"default_agent": 5000.0}, "module_to_env_connector": {"timers": {"connectors": {"listify_data_for_vector_env": 1.8901490529237127e-05, "tensor_to_numpy": 2.401554207304471e-05, "normalize_and_clip_actions": 1.544742063134413e-05, "get_actions": 8.197680404051222e-05, "un_batch_to_individual_items": 9.638927027890344e-06, "remove_single_ts_time_rank_from_batch": 9.385732347788288e-07}}, "connector_pipeline_timer": 0.00019315376332523033}, "num_env_steps_sampled": 5000.0, "episode_return_mean": 11.059999999999997, "num_episodes_lifetime": -431750.0, "episode_return_min": -7.5, "time_between_sampling": 0.003192624760220939, "episode_len_max": 20, "env_reset_timer": 7.759156591953206e-05, "num_env_steps_sampled_lifetime": -8635000.0, "env_to_module_sum_episodes_length_in": 10.36823839457432, "sample": 0.00855489867256271, "num_episodes": 250.0, "num_module_steps_sampled_lifetime": {"default_policy": -8635000.0}, "module_episode_returns_mean": {"default_policy": 11.059999999999997}, "env_step_timer": 2.639196823482466e-05, "weights_seq_no": 15.0, "num_agent_steps_sampled_lifetime": {"default_agent": -8635000.0}, "rlmodule_inference_timer": 5.52213251081369e-05, "env_to_module_sum_episodes_length_out": 10.36823839457432, "num_module_steps_sampled": {"default_policy": 5000.0}, "episode_duration_sec_mean": 0.008324965673964471, "num_env_steps_sampled_lifetime_throughput": 2378.8592027462632}, "learners": {"__all_modules__": {"learner_connector": {"timers": {"connectors": {"numpy_to_tensor": 8.959181533262889e-05, "add_columns_from_episodes_to_train_batch": 0.05065125096861062, "add_observations_from_episodes_to_batch": 0.001823467406906187, "add_states_from_episodes_to_batch": 1.0325004031067372e-05, "general_advantage_estimation": 0.007282584409889594, "batch_individual_items": 0.04484939539588051, "add_one_ts_to_episodes_and_truncate": 0.011121605749369452, "add_time_dim_to_batch_and_zero_pad": 1.8992303258206155e-05}}, "connector_pipeline_timer": 0.11605828097038828}, "num_module_steps_trained_lifetime": 96000, "learner_connector_sum_episodes_length_in": 5000.0, "num_trainable_parameters": 6003, "learner_connector_sum_episodes_length_out": 5250.0, "num_env_steps_trained_lifetime": 504000, "num_module_steps_trained": 6000, "num_env_steps_trained": 31500, "num_non_trainable_parameters": 0, "num_env_steps_trained_lifetime_throughput": 1147871.378665462, "num_module_steps_trained_throughput": 219530.65368053122, "num_module_steps_trained_lifetime_throughput": 218469.61881695595}, "default_policy": {"policy_loss": -0.08910641074180603, "mean_kl_loss": 6.365888111758977e-05, "diff_num_grad_updates_vs_sampler_policy": 1.0, "num_module_steps_trained_lifetime": 96000, "entropy": 0.4002242386341095, "vf_explained_var": 0.015397906303405762, "gradients_default_optimizer_global_norm": 0.06402754038572311, "module_train_batch_size_mean": 1000.0, "weights_seq_no": 16.0, "total_loss": -0.02420705370604992, "curr_kl_coeff": 1.1390629879315384e-05, "default_optimizer_learning_rate": 0.0002847858517, "vf_loss_unclipped": 28.66145133972168, "vf_loss": 0.10245729237794876, "curr_entropy_coeff": 0.0090570820258, "num_trainable_parameters": 6003, "num_module_steps_trained": 6000, "num_module_steps_trained_lifetime_throughput": 221171.80632967956}}, "num_training_step_calls_per_iteration": 1, "evaluation": {"env_runners": {"module_to_env_connector": {"timers": {"connectors": {"tensor_to_numpy": 1.701644172627025e-05, "normalize_and_clip_actions": 1.150359005719912e-05, "get_actions": 4.8182625158809655e-05, "un_batch_to_individual_items": 6.7216842627588325e-06, "remove_single_ts_time_rank_from_batch": 6.747175374713622e-07, "listify_data_for_vector_env": 1.3378155186435515e-05}}, "connector_pipeline_timer": 0.0001279036404706942}, "episode_duration_sec_mean": 0.007988376182038338, "module_episode_returns_mean": {"default_policy": 1.95}, "episode_len_mean": 20.0, "env_to_module_connector": {"timers": {"connectors": {"add_time_dim_to_batch_and_zero_pad": 3.320644064218758e-06, "add_states_from_episodes_to_batch": 1.8634029040712157e-06, "add_observations_from_episodes_to_batch": 3.5328191433030586e-06, "batch_individual_items": 8.204161186057673e-06, "numpy_to_tensor": 1.1467528508646466e-05}}, "connector_pipeline_timer": 5.4503534390721313e-05}, "num_env_steps_sampled_lifetime": 80400, "env_to_module_sum_episodes_length_out": 10.368238394574323, "num_agent_steps_sampled": {"default_agent": 400}, "env_reset_timer": 0.0004543269919021524, "env_step_timer": 1.866099928499981e-05, "weights_seq_no": 16.0, "rlmodule_inference_timer": 3.5551989121857905e-05, "num_module_steps_sampled": {"default_policy": 400}, "agent_episode_returns_mean": {"default_agent": 1.95}, "env_to_module_sum_episodes_length_in": 10.368238394574323, "episode_len_max": 20, "sample": 0.1897546166349008, "episode_len_min": 20, "num_module_steps_sampled_lifetime": {"default_policy": 6400}, "episode_return_max": 12.5, "num_agent_steps_sampled_lifetime": {"default_agent": 6400}, "num_env_steps_sampled": 400, "episode_return_min": -16.5, "episode_return_mean": 1.95, "num_episodes_lifetime": 320, "num_episodes": 20, "time_between_sampling": 2.731453548473092}, "num_healthy_workers": 1, "actor_manager_num_outstanding_async_reqs": 0, "num_remote_worker_restarts": 0}, "num_env_steps_sampled_lifetime": -8635000.0, "fault_tolerance": {"num_healthy_workers": 0, "num_remote_worker_restarts": 0}, "env_runner_group": {"actor_manager_num_outstanding_async_reqs": 0}, "done": false, "training_iteration": 16, "trial_id": "4638e_00000", "date": "2025-08-11_19-33-48", "timestamp": 1754933628, "time_this_iter_s": 2.818908929824829, "time_total_s": 47.70114183425903, "pid": 25862, "hostname": "Mac", "node_ip": "127.0.0.1", "config": {"exploration_config": {}, "extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "placement_strategy": "PACK", "num_gpus": 0, "_fake_gpus": false, "num_cpus_for_main_process": 2, "eager_tracing": true, "eager_max_retraces": 20, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "torch_compile_learner": false, "torch_compile_learner_what_to_compile": "forward_train", "torch_compile_learner_dynamo_backend": "aot_eager", "torch_compile_learner_dynamo_mode": null, "torch_compile_worker": false, "torch_compile_worker_dynamo_backend": "aot_eager", "torch_compile_worker_dynamo_mode": null, "torch_ddp_kwargs": {}, "torch_skip_nan_gradients": false, "env": "Umbrella", "env_config": {}, "observation_space": null, "action_space": null, "clip_rewards": null, "normalize_actions": true, "clip_actions": false, "_is_atari": null, "disable_env_checking": false, "render_env": false, "action_mask_key": "action_mask", "env_runner_cls": null, "num_env_runners": 0, "create_local_env_runner": true, "num_envs_per_env_runner": 1, "gym_env_vectorize_mode": "SYNC", "num_cpus_per_env_runner": 1, "num_gpus_per_env_runner": 0, "custom_resources_per_env_runner": {}, "validate_env_runners_after_construction": true, "episodes_to_numpy": true, "max_requests_in_flight_per_env_runner": 1, "sample_timeout_s": 60.0, "_env_to_module_connector": null, "add_default_connectors_to_env_to_module_pipeline": true, "_module_to_env_connector": null, "add_default_connectors_to_module_to_env_pipeline": true, "merge_env_runner_states": "training_only", "broadcast_env_runner_states": true, "episode_lookback_horizon": 1, "rollout_fragment_length": "auto", "batch_mode": "complete_episodes", "compress_observations": false, "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "enable_tf1_exec_eagerly": false, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "preprocessor_pref": "deepmind", "observation_filter": "NoFilter", "update_worker_filter_stats": true, "use_worker_filter_stats": true, "sampler_perf_stats_ema_coef": null, "_is_online": true, "num_learners": 0, "num_gpus_per_learner": 0, "num_cpus_per_learner": "auto", "num_aggregator_actors_per_learner": 0, "max_requests_in_flight_per_aggregator_actor": 3, "local_gpu_idx": 0, "max_requests_in_flight_per_learner": 3, "gamma": 1, "lr": 0.0002847858517, "grad_clip": 0.5, "grad_clip_by": "global_norm", "_train_batch_size_per_learner": 5000, "train_batch_size": 4000, "num_epochs": 1, "minibatch_size": 1000, "shuffle_batch_per_epoch": true, "model": {"fcnet_hiddens": [256, 256], "fcnet_activation": "tanh", "fcnet_weights_initializer": null, "fcnet_weights_initializer_config": null, "fcnet_bias_initializer": null, "fcnet_bias_initializer_config": null, "conv_filters": null, "conv_activation": "relu", "conv_kernel_initializer": null, "conv_kernel_initializer_config": null, "conv_bias_initializer": null, "conv_bias_initializer_config": null, "conv_transpose_kernel_initializer": null, "conv_transpose_kernel_initializer_config": null, "conv_transpose_bias_initializer": null, "conv_transpose_bias_initializer_config": null, "post_fcnet_hiddens": [], "post_fcnet_activation": "relu", "post_fcnet_weights_initializer": null, "post_fcnet_weights_initializer_config": null, "post_fcnet_bias_initializer": null, "post_fcnet_bias_initializer_config": null, "free_log_std": false, "log_std_clip_param": 20.0, "no_final_linear": false, "vf_share_layers": false, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "lstm_weights_initializer": null, "lstm_weights_initializer_config": null, "lstm_bias_initializer": null, "lstm_bias_initializer_config": null, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "attention_use_n_prev_actions": 0, "attention_use_n_prev_rewards": 0, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": null, "custom_model_config": {}, "custom_action_dist": null, "custom_preprocessor": null, "encoder_latent_dim": null, "always_check_shapes": false, "lstm_use_prev_action_reward": -1, "_use_default_native_models": -1, "_disable_preprocessor_api": false, "_disable_action_flattening": false}, "_learner_connector": null, "add_default_connectors_to_learner_pipeline": true, "learner_config_dict": {}, "optimizer": {}, "_learner_class": null, "callbacks_on_algorithm_init": null, "callbacks_on_env_runners_recreated": null, "callbacks_on_offline_eval_runners_recreated": null, "callbacks_on_checkpoint_loaded": null, "callbacks_on_environment_created": null, "callbacks_on_episode_created": null, "callbacks_on_episode_start": null, "callbacks_on_episode_step": null, "callbacks_on_episode_end": null, "callbacks_on_evaluate_start": null, "callbacks_on_evaluate_end": null, "callbacks_on_evaluate_offline_start": null, "callbacks_on_evaluate_offline_end": null, "callbacks_on_sample_end": null, "callbacks_on_train_result": null, "explore": true, "enable_rl_module_and_learner": true, "enable_env_runner_and_connector_v2": true, "_prior_exploration_config": {"type": "StochasticSampling"}, "count_steps_by": "env_steps", "policy_map_capacity": 100, "policy_mapping_fn": "<function AlgorithmConfig.DEFAULT_POLICY_MAPPING_FN at 0x161d55b20>", "policies_to_train": null, "policy_states_are_swappable": false, "observation_fn": null, "offline_data_class": null, "input_read_method": "read_parquet", "input_read_method_kwargs": {}, "input_read_schema": {}, "input_read_episodes": false, "input_read_sample_batches": false, "input_read_batch_size": null, "input_filesystem": null, "input_filesystem_kwargs": {}, "input_compress_columns": ["obs", "new_obs"], "input_spaces_jsonable": true, "materialize_data": false, "materialize_mapped_data": true, "map_batches_kwargs": {}, "iter_batches_kwargs": {}, "ignore_final_observation": false, "prelearner_class": null, "prelearner_buffer_class": null, "prelearner_buffer_kwargs": {}, "prelearner_module_synch_period": 10, "dataset_num_iters_per_learner": null, "input_config": {}, "actions_in_input_normalized": false, "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_config": {}, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "output_max_rows_per_file": null, "output_write_remaining_data": false, "output_write_method": "write_parquet", "output_write_method_kwargs": {}, "output_filesystem": null, "output_filesystem_kwargs": {}, "output_write_episodes": true, "offline_sampling": false, "evaluation_interval": 1, "evaluation_duration": 20, "evaluation_duration_unit": "episodes", "evaluation_sample_timeout_s": 120.0, "evaluation_auto_duration_min_env_steps_per_sample": 100, "evaluation_auto_duration_max_env_steps_per_sample": 2000, "evaluation_parallel_to_training": false, "evaluation_force_reset_envs_before_iteration": true, "evaluation_config": null, "off_policy_estimation_methods": {}, "ope_split_batch_by_episode": true, "evaluation_num_env_runners": 1, "in_evaluation": false, "sync_filters_on_rollout_workers_timeout_s": 10.0, "offline_evaluation_interval": null, "num_offline_eval_runners": 0, "offline_loss_for_module_fn": null, "offline_evaluation_duration": 1, "offline_evaluation_parallel_to_training": false, "offline_evaluation_timeout_s": 120.0, "num_cpus_per_offline_eval_runner": 1, "num_gpus_per_offline_eval_runner": 0, "custom_resources_per_offline_eval_runner": {}, "restart_failed_offline_eval_runners": true, "ignore_offline_eval_runner_failures": false, "max_num_offline_eval_runner_restarts": 1000, "offline_eval_runner_restore_timeout_s": 1800.0, "max_requests_in_flight_per_offline_eval_runner": 1, "validate_offline_eval_runners_after_construction": true, "offline_eval_runner_health_probe_timeout_s": 30.0, "offline_eval_rl_module_inference_only": false, "broadcast_offline_eval_runner_states": false, "offline_eval_batch_size_per_runner": 256, "dataset_num_iters_per_eval_runner": 1, "keep_per_episode_custom_metrics": false, "metrics_episode_collection_timeout_s": 60.0, "metrics_num_episodes_for_smoothing": 100, "min_time_s_per_iteration": null, "min_train_timesteps_per_iteration": 0, "min_sample_timesteps_per_iteration": 0, "log_gradients": true, "export_native_model_files": false, "checkpoint_trainable_policies_only": false, "logger_creator": null, "logger_config": null, "log_level": "WARN", "log_sys_usage": true, "fake_sampler": false, "seed": 4, "restart_failed_env_runners": true, "ignore_env_runner_failures": false, "max_num_env_runner_restarts": 1000, "delay_between_env_runner_restarts_s": 60.0, "restart_failed_sub_environments": false, "num_consecutive_env_runner_failures_tolerance": 100, "env_runner_health_probe_timeout_s": 30.0, "env_runner_restore_timeout_s": 1800.0, "_model_config": {}, "_rl_module_spec": "RLModuleSpec(module_class=None, observation_space=None, action_space=None, inference_only=False, learner_only=False, model_config=DefaultModelConfig(fcnet_hiddens=[60, 90], fcnet_activation='tanh', fcnet_kernel_initializer=None, fcnet_kernel_initializer_kwargs=None, fcnet_bias_initializer=None, fcnet_bias_initializer_kwargs=None, conv_filters=None, conv_activation='relu', conv_kernel_initializer=None, conv_kernel_initializer_kwargs=None, conv_bias_initializer=None, conv_bias_initializer_kwargs=None, head_fcnet_hiddens=[], head_fcnet_activation='relu', head_fcnet_kernel_initializer=None, head_fcnet_kernel_initializer_kwargs=None, head_fcnet_bias_initializer=None, head_fcnet_bias_initializer_kwargs=None, free_log_std=False, log_std_clip_param=20.0, vf_share_layers=True, use_lstm=False, max_seq_len=20, lstm_cell_size=256, lstm_use_prev_action=False, lstm_use_prev_reward=False, lstm_kernel_initializer=None, lstm_kernel_initializer_kwargs=None, lstm_bias_initializer=None, lstm_bias_initializer_kwargs=None), catalog_class=None, load_state_path=None, model_config_dict=None)", "algorithm_config_overrides_per_module": {}, "_per_module_overrides": {}, "_validate_config": true, "_use_msgpack_checkpoints": false, "_torch_grad_scaler_class": null, "_torch_lr_scheduler_classes": null, "_tf_policy_handles_more_than_one_loss": false, "_disable_preprocessor_api": false, "_disable_action_flattening": false, "_disable_initialize_loss_from_dummy_batch": false, "_dont_auto_sync_env_runner_states": false, "env_task_fn": -1, "enable_connectors": -1, "simple_optimizer": false, "policy_map_cache": -1, "worker_cls": -1, "synchronize_filters": -1, "enable_async_evaluation": -1, "custom_async_evaluation_function": -1, "_enable_rl_module_api": -1, "auto_wrap_old_gym_envs": -1, "always_attach_evaluation_results": -1, "replay_sequence_length": null, "_disable_execution_plan_api": -1, "use_critic": true, "use_gae": true, "use_kl_loss": true, "kl_coeff": 0.7464963036515, "kl_target": 0.0270990929592, "vf_loss_coeff": 0.6688075857018, "entropy_coeff": 0.0090570820258, "clip_param": 0.1221781641624, "vf_clip_param": 0.1027808522125, "entropy_coeff_schedule": null, "lr_schedule": null, "sgd_minibatch_size": -1, "vf_share_layers": -1, "__stdout_file__": null, "__stderr_file__": null, "lambda": 0.9099046732075, "input": "sampler", "policies": {"default_policy": [null, null, null, null]}, "callbacks": "<class 'ray.rllib.callbacks.callbacks.RLlibCallback'>", "create_env_on_driver": false, "custom_eval_function": null, "framework": "torch"}, "time_since_restore": 47.70114183425903, "iterations_since_restore": 16, "perf": {"cpu_util_percent": 75.325, "ram_util_percent": 79.475}}
{"timers": {"training_iteration": 3.3775768973832507, "restore_env_runners": 4.521957232699884e-05, "training_step": 3.3772261586654717, "env_runner_sampling_timer": 3.2032487429391376, "learner_update_timer": 0.16701955882624497, "synch_weights": 0.0012227738650591536, "restore_eval_env_runners": 1.1619634693857189e-05, "evaluation_iteration": 0.2020151524154397, "synch_eval_env_connectors": 0.00044212690831659977, "synch_env_connectors": 5.888251547991888e-06}, "env_runners": {"agent_episode_returns_mean": {"default_agent": 10.5}, "env_to_module_connector": {"timers": {"connectors": {"add_time_dim_to_batch_and_zero_pad": 4.245645599583044e-06, "add_states_from_episodes_to_batch": 2.4587310482431783e-06, "numpy_to_tensor": 1.6759645147842768e-05, "add_observations_from_episodes_to_batch": 5.074009472264112e-06, "batch_individual_items": 1.1495840847049878e-05}}, "connector_pipeline_timer": 7.370851334630463e-05}, "episode_len_mean": 20.0, "episode_len_min": 20, "episode_return_max": 12.5, "num_agent_steps_sampled": {"default_agent": 5000.0}, "module_to_env_connector": {"timers": {"connectors": {"listify_data_for_vector_env": 1.9082050294456416e-05, "tensor_to_numpy": 2.455380673753331e-05, "normalize_and_clip_actions": 1.5690806959717517e-05, "get_actions": 8.314215254126881e-05, "un_batch_to_individual_items": 9.184962443892946e-06, "remove_single_ts_time_rank_from_batch": 9.368898296159809e-07}}, "connector_pipeline_timer": 0.00019473802590294046}, "num_env_steps_sampled": 5000.0, "episode_return_mean": 10.5, "num_episodes_lifetime": -462625.0, "episode_return_min": -7.5, "time_between_sampling": 0.0024115491386429424, "episode_len_max": 20, "env_reset_timer": 8.167461396447035e-05, "num_env_steps_sampled_lifetime": -9252500.0, "env_to_module_sum_episodes_length_in": 10.36823839457432, "sample": 0.009474118360975954, "num_episodes": 250.0, "num_module_steps_sampled_lifetime": {"default_policy": -9252500.0}, "module_episode_returns_mean": {"default_policy": 10.5}, "env_step_timer": 2.5788664813391906e-05, "weights_seq_no": 16.0, "num_agent_steps_sampled_lifetime": {"default_agent": -9252500.0}, "rlmodule_inference_timer": 7.349018315254289e-05, "env_to_module_sum_episodes_length_out": 10.36823839457432, "num_module_steps_sampled": {"default_policy": 5000.0}, "episode_duration_sec_mean": 0.008768309148959815, "num_env_steps_sampled_lifetime_throughput": 2318.9468115501045}, "learners": {"__all_modules__": {"learner_connector": {"timers": {"connectors": {"numpy_to_tensor": 8.942964665463271e-05, "add_columns_from_episodes_to_train_batch": 0.050529460958799864, "add_observations_from_episodes_to_batch": 0.0018212827328136557, "add_states_from_episodes_to_batch": 1.0256754257263966e-05, "general_advantage_estimation": 0.0072983206452631655, "batch_individual_items": 0.04475643310252879, "add_one_ts_to_episodes_and_truncate": 0.01109705553106542, "add_time_dim_to_batch_and_zero_pad": 1.8916129636581194e-05}}, "connector_pipeline_timer": 0.1158318464913915}, "num_module_steps_trained_lifetime": 102000, "learner_connector_sum_episodes_length_in": 5000.0, "num_trainable_parameters": 6003, "learner_connector_sum_episodes_length_out": 5250.0, "num_env_steps_trained_lifetime": 535500, "num_module_steps_trained": 6000, "num_env_steps_trained": 31500, "num_non_trainable_parameters": 0, "num_env_steps_trained_lifetime_throughput": 1143680.3495742062, "num_module_steps_trained_throughput": 218697.541339983, "num_module_steps_trained_lifetime_throughput": 217680.05834994745}, "default_policy": {"policy_loss": -0.09787576645612717, "mean_kl_loss": 0.00011660082236630842, "diff_num_grad_updates_vs_sampler_policy": 1.0, "num_module_steps_trained_lifetime": 102000, "entropy": 0.3960508704185486, "vf_explained_var": 0.01704394817352295, "gradients_default_optimizer_global_norm": 0.12811815738677979, "module_train_batch_size_mean": 1000.0, "weights_seq_no": 17.0, "total_loss": -0.03301073610782623, "curr_kl_coeff": 5.695314939657692e-06, "default_optimizer_learning_rate": 0.0002847858517, "vf_loss_unclipped": 28.645084381103516, "vf_loss": 0.10234946012496948, "curr_entropy_coeff": 0.0090570820258, "num_trainable_parameters": 6003, "num_module_steps_trained": 6000, "num_module_steps_trained_lifetime_throughput": 220249.3244819994}}, "num_training_step_calls_per_iteration": 1, "evaluation": {"env_runners": {"module_to_env_connector": {"timers": {"connectors": {"tensor_to_numpy": 2.2075609568283448e-05, "normalize_and_clip_actions": 1.3089251046827865e-05, "get_actions": 6.574851493915609e-05, "un_batch_to_individual_items": 7.944306163590757e-06, "remove_single_ts_time_rank_from_batch": 7.769097651498461e-07, "listify_data_for_vector_env": 1.7207908389394233e-05}}, "connector_pipeline_timer": 0.0001632788638760984}, "episode_duration_sec_mean": 0.007888047893065958, "module_episode_returns_mean": {"default_policy": 1.95}, "episode_len_mean": 20.0, "env_to_module_connector": {"timers": {"connectors": {"add_time_dim_to_batch_and_zero_pad": 4.103445188708017e-06, "add_states_from_episodes_to_batch": 2.4570124344844477e-06, "add_observations_from_episodes_to_batch": 4.0594379739983275e-06, "batch_individual_items": 9.941154843793603e-06, "numpy_to_tensor": 1.425602634358722e-05}}, "connector_pipeline_timer": 6.543897610892656e-05}, "num_env_steps_sampled_lifetime": 85400, "env_to_module_sum_episodes_length_out": 10.368238394574323, "num_agent_steps_sampled": {"default_agent": 400}, "env_reset_timer": 0.00045088497251055746, "env_step_timer": 2.3284893246424845e-05, "weights_seq_no": 17.0, "rlmodule_inference_timer": 4.4174086260103865e-05, "num_module_steps_sampled": {"default_policy": 400}, "agent_episode_returns_mean": {"default_agent": 1.95}, "env_to_module_sum_episodes_length_in": 10.368238394574323, "episode_len_max": 20, "sample": 0.1896234375482419, "episode_len_min": 20, "num_module_steps_sampled_lifetime": {"default_policy": 6800}, "episode_return_max": 12.5, "num_agent_steps_sampled_lifetime": {"default_agent": 6800}, "num_env_steps_sampled": 400, "episode_return_min": -16.5, "episode_return_mean": 1.95, "num_episodes_lifetime": 340, "num_episodes": 20, "time_between_sampling": 2.731753057568038}, "num_healthy_workers": 1, "actor_manager_num_outstanding_async_reqs": 0, "num_remote_worker_restarts": 0}, "num_env_steps_sampled_lifetime": -9252500.0, "fault_tolerance": {"num_healthy_workers": 0, "num_remote_worker_restarts": 0}, "env_runner_group": {"actor_manager_num_outstanding_async_reqs": 0}, "done": false, "training_iteration": 17, "trial_id": "4638e_00000", "date": "2025-08-11_19-33-51", "timestamp": 1754933631, "time_this_iter_s": 2.9223248958587646, "time_total_s": 50.6234667301178, "pid": 25862, "hostname": "Mac", "node_ip": "127.0.0.1", "config": {"exploration_config": {}, "extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "placement_strategy": "PACK", "num_gpus": 0, "_fake_gpus": false, "num_cpus_for_main_process": 2, "eager_tracing": true, "eager_max_retraces": 20, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "torch_compile_learner": false, "torch_compile_learner_what_to_compile": "forward_train", "torch_compile_learner_dynamo_backend": "aot_eager", "torch_compile_learner_dynamo_mode": null, "torch_compile_worker": false, "torch_compile_worker_dynamo_backend": "aot_eager", "torch_compile_worker_dynamo_mode": null, "torch_ddp_kwargs": {}, "torch_skip_nan_gradients": false, "env": "Umbrella", "env_config": {}, "observation_space": null, "action_space": null, "clip_rewards": null, "normalize_actions": true, "clip_actions": false, "_is_atari": null, "disable_env_checking": false, "render_env": false, "action_mask_key": "action_mask", "env_runner_cls": null, "num_env_runners": 0, "create_local_env_runner": true, "num_envs_per_env_runner": 1, "gym_env_vectorize_mode": "SYNC", "num_cpus_per_env_runner": 1, "num_gpus_per_env_runner": 0, "custom_resources_per_env_runner": {}, "validate_env_runners_after_construction": true, "episodes_to_numpy": true, "max_requests_in_flight_per_env_runner": 1, "sample_timeout_s": 60.0, "_env_to_module_connector": null, "add_default_connectors_to_env_to_module_pipeline": true, "_module_to_env_connector": null, "add_default_connectors_to_module_to_env_pipeline": true, "merge_env_runner_states": "training_only", "broadcast_env_runner_states": true, "episode_lookback_horizon": 1, "rollout_fragment_length": "auto", "batch_mode": "complete_episodes", "compress_observations": false, "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "enable_tf1_exec_eagerly": false, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "preprocessor_pref": "deepmind", "observation_filter": "NoFilter", "update_worker_filter_stats": true, "use_worker_filter_stats": true, "sampler_perf_stats_ema_coef": null, "_is_online": true, "num_learners": 0, "num_gpus_per_learner": 0, "num_cpus_per_learner": "auto", "num_aggregator_actors_per_learner": 0, "max_requests_in_flight_per_aggregator_actor": 3, "local_gpu_idx": 0, "max_requests_in_flight_per_learner": 3, "gamma": 1, "lr": 0.0002847858517, "grad_clip": 0.5, "grad_clip_by": "global_norm", "_train_batch_size_per_learner": 5000, "train_batch_size": 4000, "num_epochs": 1, "minibatch_size": 1000, "shuffle_batch_per_epoch": true, "model": {"fcnet_hiddens": [256, 256], "fcnet_activation": "tanh", "fcnet_weights_initializer": null, "fcnet_weights_initializer_config": null, "fcnet_bias_initializer": null, "fcnet_bias_initializer_config": null, "conv_filters": null, "conv_activation": "relu", "conv_kernel_initializer": null, "conv_kernel_initializer_config": null, "conv_bias_initializer": null, "conv_bias_initializer_config": null, "conv_transpose_kernel_initializer": null, "conv_transpose_kernel_initializer_config": null, "conv_transpose_bias_initializer": null, "conv_transpose_bias_initializer_config": null, "post_fcnet_hiddens": [], "post_fcnet_activation": "relu", "post_fcnet_weights_initializer": null, "post_fcnet_weights_initializer_config": null, "post_fcnet_bias_initializer": null, "post_fcnet_bias_initializer_config": null, "free_log_std": false, "log_std_clip_param": 20.0, "no_final_linear": false, "vf_share_layers": false, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "lstm_weights_initializer": null, "lstm_weights_initializer_config": null, "lstm_bias_initializer": null, "lstm_bias_initializer_config": null, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "attention_use_n_prev_actions": 0, "attention_use_n_prev_rewards": 0, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": null, "custom_model_config": {}, "custom_action_dist": null, "custom_preprocessor": null, "encoder_latent_dim": null, "always_check_shapes": false, "lstm_use_prev_action_reward": -1, "_use_default_native_models": -1, "_disable_preprocessor_api": false, "_disable_action_flattening": false}, "_learner_connector": null, "add_default_connectors_to_learner_pipeline": true, "learner_config_dict": {}, "optimizer": {}, "_learner_class": null, "callbacks_on_algorithm_init": null, "callbacks_on_env_runners_recreated": null, "callbacks_on_offline_eval_runners_recreated": null, "callbacks_on_checkpoint_loaded": null, "callbacks_on_environment_created": null, "callbacks_on_episode_created": null, "callbacks_on_episode_start": null, "callbacks_on_episode_step": null, "callbacks_on_episode_end": null, "callbacks_on_evaluate_start": null, "callbacks_on_evaluate_end": null, "callbacks_on_evaluate_offline_start": null, "callbacks_on_evaluate_offline_end": null, "callbacks_on_sample_end": null, "callbacks_on_train_result": null, "explore": true, "enable_rl_module_and_learner": true, "enable_env_runner_and_connector_v2": true, "_prior_exploration_config": {"type": "StochasticSampling"}, "count_steps_by": "env_steps", "policy_map_capacity": 100, "policy_mapping_fn": "<function AlgorithmConfig.DEFAULT_POLICY_MAPPING_FN at 0x161d55b20>", "policies_to_train": null, "policy_states_are_swappable": false, "observation_fn": null, "offline_data_class": null, "input_read_method": "read_parquet", "input_read_method_kwargs": {}, "input_read_schema": {}, "input_read_episodes": false, "input_read_sample_batches": false, "input_read_batch_size": null, "input_filesystem": null, "input_filesystem_kwargs": {}, "input_compress_columns": ["obs", "new_obs"], "input_spaces_jsonable": true, "materialize_data": false, "materialize_mapped_data": true, "map_batches_kwargs": {}, "iter_batches_kwargs": {}, "ignore_final_observation": false, "prelearner_class": null, "prelearner_buffer_class": null, "prelearner_buffer_kwargs": {}, "prelearner_module_synch_period": 10, "dataset_num_iters_per_learner": null, "input_config": {}, "actions_in_input_normalized": false, "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_config": {}, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "output_max_rows_per_file": null, "output_write_remaining_data": false, "output_write_method": "write_parquet", "output_write_method_kwargs": {}, "output_filesystem": null, "output_filesystem_kwargs": {}, "output_write_episodes": true, "offline_sampling": false, "evaluation_interval": 1, "evaluation_duration": 20, "evaluation_duration_unit": "episodes", "evaluation_sample_timeout_s": 120.0, "evaluation_auto_duration_min_env_steps_per_sample": 100, "evaluation_auto_duration_max_env_steps_per_sample": 2000, "evaluation_parallel_to_training": false, "evaluation_force_reset_envs_before_iteration": true, "evaluation_config": null, "off_policy_estimation_methods": {}, "ope_split_batch_by_episode": true, "evaluation_num_env_runners": 1, "in_evaluation": false, "sync_filters_on_rollout_workers_timeout_s": 10.0, "offline_evaluation_interval": null, "num_offline_eval_runners": 0, "offline_loss_for_module_fn": null, "offline_evaluation_duration": 1, "offline_evaluation_parallel_to_training": false, "offline_evaluation_timeout_s": 120.0, "num_cpus_per_offline_eval_runner": 1, "num_gpus_per_offline_eval_runner": 0, "custom_resources_per_offline_eval_runner": {}, "restart_failed_offline_eval_runners": true, "ignore_offline_eval_runner_failures": false, "max_num_offline_eval_runner_restarts": 1000, "offline_eval_runner_restore_timeout_s": 1800.0, "max_requests_in_flight_per_offline_eval_runner": 1, "validate_offline_eval_runners_after_construction": true, "offline_eval_runner_health_probe_timeout_s": 30.0, "offline_eval_rl_module_inference_only": false, "broadcast_offline_eval_runner_states": false, "offline_eval_batch_size_per_runner": 256, "dataset_num_iters_per_eval_runner": 1, "keep_per_episode_custom_metrics": false, "metrics_episode_collection_timeout_s": 60.0, "metrics_num_episodes_for_smoothing": 100, "min_time_s_per_iteration": null, "min_train_timesteps_per_iteration": 0, "min_sample_timesteps_per_iteration": 0, "log_gradients": true, "export_native_model_files": false, "checkpoint_trainable_policies_only": false, "logger_creator": null, "logger_config": null, "log_level": "WARN", "log_sys_usage": true, "fake_sampler": false, "seed": 4, "restart_failed_env_runners": true, "ignore_env_runner_failures": false, "max_num_env_runner_restarts": 1000, "delay_between_env_runner_restarts_s": 60.0, "restart_failed_sub_environments": false, "num_consecutive_env_runner_failures_tolerance": 100, "env_runner_health_probe_timeout_s": 30.0, "env_runner_restore_timeout_s": 1800.0, "_model_config": {}, "_rl_module_spec": "RLModuleSpec(module_class=None, observation_space=None, action_space=None, inference_only=False, learner_only=False, model_config=DefaultModelConfig(fcnet_hiddens=[60, 90], fcnet_activation='tanh', fcnet_kernel_initializer=None, fcnet_kernel_initializer_kwargs=None, fcnet_bias_initializer=None, fcnet_bias_initializer_kwargs=None, conv_filters=None, conv_activation='relu', conv_kernel_initializer=None, conv_kernel_initializer_kwargs=None, conv_bias_initializer=None, conv_bias_initializer_kwargs=None, head_fcnet_hiddens=[], head_fcnet_activation='relu', head_fcnet_kernel_initializer=None, head_fcnet_kernel_initializer_kwargs=None, head_fcnet_bias_initializer=None, head_fcnet_bias_initializer_kwargs=None, free_log_std=False, log_std_clip_param=20.0, vf_share_layers=True, use_lstm=False, max_seq_len=20, lstm_cell_size=256, lstm_use_prev_action=False, lstm_use_prev_reward=False, lstm_kernel_initializer=None, lstm_kernel_initializer_kwargs=None, lstm_bias_initializer=None, lstm_bias_initializer_kwargs=None), catalog_class=None, load_state_path=None, model_config_dict=None)", "algorithm_config_overrides_per_module": {}, "_per_module_overrides": {}, "_validate_config": true, "_use_msgpack_checkpoints": false, "_torch_grad_scaler_class": null, "_torch_lr_scheduler_classes": null, "_tf_policy_handles_more_than_one_loss": false, "_disable_preprocessor_api": false, "_disable_action_flattening": false, "_disable_initialize_loss_from_dummy_batch": false, "_dont_auto_sync_env_runner_states": false, "env_task_fn": -1, "enable_connectors": -1, "simple_optimizer": false, "policy_map_cache": -1, "worker_cls": -1, "synchronize_filters": -1, "enable_async_evaluation": -1, "custom_async_evaluation_function": -1, "_enable_rl_module_api": -1, "auto_wrap_old_gym_envs": -1, "always_attach_evaluation_results": -1, "replay_sequence_length": null, "_disable_execution_plan_api": -1, "use_critic": true, "use_gae": true, "use_kl_loss": true, "kl_coeff": 0.7464963036515, "kl_target": 0.0270990929592, "vf_loss_coeff": 0.6688075857018, "entropy_coeff": 0.0090570820258, "clip_param": 0.1221781641624, "vf_clip_param": 0.1027808522125, "entropy_coeff_schedule": null, "lr_schedule": null, "sgd_minibatch_size": -1, "vf_share_layers": -1, "__stdout_file__": null, "__stderr_file__": null, "lambda": 0.9099046732075, "input": "sampler", "policies": {"default_policy": [null, null, null, null]}, "callbacks": "<class 'ray.rllib.callbacks.callbacks.RLlibCallback'>", "create_env_on_driver": false, "custom_eval_function": null, "framework": "torch"}, "time_since_restore": 50.6234667301178, "iterations_since_restore": 17, "perf": {"cpu_util_percent": 57.67999999999999, "ram_util_percent": 79.28}}
{"timers": {"training_iteration": 3.3784869717495396, "restore_env_runners": 4.482987649755807e-05, "training_step": 3.378137385418468, "env_runner_sampling_timer": 3.2025052459288714, "learner_update_timer": 0.16868902448717496, "synch_weights": 0.0012276123762652875, "restore_eval_env_runners": 1.1573847497712765e-05, "evaluation_iteration": 0.20182776256151524, "synch_eval_env_connectors": 0.0004405498087365116, "synch_env_connectors": 5.867709254602451e-06}, "env_runners": {"agent_episode_returns_mean": {"default_agent": 10.980000000000002}, "env_to_module_connector": {"timers": {"connectors": {"add_time_dim_to_batch_and_zero_pad": 5.791075107503395e-06, "add_states_from_episodes_to_batch": 3.6620080759408054e-06, "numpy_to_tensor": 2.1043316653458566e-05, "add_observations_from_episodes_to_batch": 5.849768844986324e-06, "batch_individual_items": 1.874057586537524e-05}}, "connector_pipeline_timer": 9.868343667191024e-05}, "episode_len_mean": 20.0, "episode_len_min": 20, "episode_return_max": 12.5, "num_agent_steps_sampled": {"default_agent": 5000.0}, "module_to_env_connector": {"timers": {"connectors": {"listify_data_for_vector_env": 2.3373995961826183e-05, "tensor_to_numpy": 2.7337633985869817e-05, "normalize_and_clip_actions": 1.981843217850255e-05, "get_actions": 0.0001025903941072581, "un_batch_to_individual_items": 1.1725549460761257e-05, "remove_single_ts_time_rank_from_batch": 1.2884328532692253e-06}}, "connector_pipeline_timer": 0.00023893302936231362}, "num_env_steps_sampled": 5000.0, "episode_return_mean": 10.980000000000002, "num_episodes_lifetime": -493500.0, "episode_return_min": -7.5, "time_between_sampling": 0.0023989226166629845, "episode_len_max": 20, "env_reset_timer": 9.051677312269688e-05, "num_env_steps_sampled_lifetime": -9870000.0, "env_to_module_sum_episodes_length_in": 10.36823839457432, "sample": 0.009619339377780369, "num_episodes": 250.0, "num_module_steps_sampled_lifetime": {"default_policy": -9870000.0}, "module_episode_returns_mean": {"default_policy": 10.980000000000002}, "env_step_timer": 3.1804546090489075e-05, "weights_seq_no": 17.0, "num_agent_steps_sampled_lifetime": {"default_agent": -9870000.0}, "rlmodule_inference_timer": 6.65878853206326e-05, "env_to_module_sum_episodes_length_out": 10.36823839457432, "num_module_steps_sampled": {"default_policy": 5000.0}, "episode_duration_sec_mean": 0.010453975507523866, "num_env_steps_sampled_lifetime_throughput": 2197.734633901178}, "learners": {"__all_modules__": {"learner_connector": {"timers": {"connectors": {"numpy_to_tensor": 9.035077029786503e-05, "add_columns_from_episodes_to_train_batch": 0.05038085759839245, "add_observations_from_episodes_to_batch": 0.0018119836555472843, "add_states_from_episodes_to_batch": 1.0197936756787107e-05, "general_advantage_estimation": 0.007327487859235994, "batch_individual_items": 0.046708669191310934, "add_one_ts_to_episodes_and_truncate": 0.01114616664521016, "add_time_dim_to_batch_and_zero_pad": 1.9190297828626928e-05}}, "connector_pipeline_timer": 0.11770520135659274}, "num_module_steps_trained_lifetime": 108000, "learner_connector_sum_episodes_length_in": 5000.0, "num_trainable_parameters": 6003, "learner_connector_sum_episodes_length_out": 5250.0, "num_env_steps_trained_lifetime": 567000, "num_module_steps_trained": 6000, "num_env_steps_trained": 31500, "num_non_trainable_parameters": 0, "num_env_steps_trained_lifetime_throughput": 1138256.0485094907, "num_module_steps_trained_throughput": 217632.00581367395, "num_module_steps_trained_lifetime_throughput": 216658.0662016459}, "default_policy": {"policy_loss": -0.10068020969629288, "mean_kl_loss": 0.0005068923346698284, "diff_num_grad_updates_vs_sampler_policy": 1.0, "num_module_steps_trained_lifetime": 108000, "entropy": 0.36843931674957275, "vf_explained_var": 0.015502631664276123, "gradients_default_optimizer_global_norm": 0.10874442011117935, "module_train_batch_size_mean": 1000.0, "weights_seq_no": 18.0, "total_loss": -0.03549296036362648, "curr_kl_coeff": 2.847657469828846e-06, "default_optimizer_learning_rate": 0.0002847858517, "vf_loss_unclipped": 28.66659927368164, "vf_loss": 0.10245733708143234, "curr_entropy_coeff": 0.0090570820258, "num_trainable_parameters": 6003, "num_module_steps_trained": 6000, "num_module_steps_trained_lifetime_throughput": 219098.7735209715}}, "num_training_step_calls_per_iteration": 1, "evaluation": {"env_runners": {"module_to_env_connector": {"timers": {"connectors": {"tensor_to_numpy": 1.953221252290077e-05, "normalize_and_clip_actions": 1.2920791734816517e-05, "get_actions": 5.920931059557215e-05, "un_batch_to_individual_items": 7.003270125776039e-06, "remove_single_ts_time_rank_from_batch": 7.356616655185053e-07, "listify_data_for_vector_env": 1.600125315840392e-05}}, "connector_pipeline_timer": 0.00014916223986941303}, "episode_duration_sec_mean": 0.0076429524912964555, "module_episode_returns_mean": {"default_policy": 1.55}, "episode_len_mean": 20.0, "env_to_module_connector": {"timers": {"connectors": {"add_time_dim_to_batch_and_zero_pad": 2.850268322287204e-06, "add_states_from_episodes_to_batch": 1.8551572158051033e-06, "add_observations_from_episodes_to_batch": 4.463252393727982e-06, "batch_individual_items": 8.27041245133317e-06, "numpy_to_tensor": 1.2483914640794635e-05}}, "connector_pipeline_timer": 5.565730957701298e-05}, "num_env_steps_sampled_lifetime": 90400, "env_to_module_sum_episodes_length_out": 10.368238394574323, "num_agent_steps_sampled": {"default_agent": 400}, "env_reset_timer": 0.0004519036223829715, "env_step_timer": 1.9852384372634757e-05, "weights_seq_no": 18.0, "rlmodule_inference_timer": 3.8923026864951276e-05, "num_module_steps_sampled": {"default_policy": 400}, "agent_episode_returns_mean": {"default_agent": 1.55}, "env_to_module_sum_episodes_length_in": 10.368238394574323, "episode_len_max": 20, "sample": 0.18946466692293748, "episode_len_min": 20, "num_module_steps_sampled_lifetime": {"default_policy": 7200}, "episode_return_max": 12.5, "num_agent_steps_sampled_lifetime": {"default_agent": 7200}, "num_env_steps_sampled": 400, "episode_return_min": -16.5, "episode_return_mean": 1.55, "num_episodes_lifetime": 360, "num_episodes": 20, "time_between_sampling": 2.7393912053219283}, "num_healthy_workers": 1, "actor_manager_num_outstanding_async_reqs": 0, "num_remote_worker_restarts": 0}, "num_env_steps_sampled_lifetime": -9870000.0, "fault_tolerance": {"num_healthy_workers": 0, "num_remote_worker_restarts": 0}, "env_runner_group": {"actor_manager_num_outstanding_async_reqs": 0}, "done": false, "training_iteration": 18, "trial_id": "4638e_00000", "date": "2025-08-11_19-33-55", "timestamp": 1754933635, "time_this_iter_s": 3.659792184829712, "time_total_s": 54.28325891494751, "pid": 25862, "hostname": "Mac", "node_ip": "127.0.0.1", "config": {"exploration_config": {}, "extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "placement_strategy": "PACK", "num_gpus": 0, "_fake_gpus": false, "num_cpus_for_main_process": 2, "eager_tracing": true, "eager_max_retraces": 20, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "torch_compile_learner": false, "torch_compile_learner_what_to_compile": "forward_train", "torch_compile_learner_dynamo_backend": "aot_eager", "torch_compile_learner_dynamo_mode": null, "torch_compile_worker": false, "torch_compile_worker_dynamo_backend": "aot_eager", "torch_compile_worker_dynamo_mode": null, "torch_ddp_kwargs": {}, "torch_skip_nan_gradients": false, "env": "Umbrella", "env_config": {}, "observation_space": null, "action_space": null, "clip_rewards": null, "normalize_actions": true, "clip_actions": false, "_is_atari": null, "disable_env_checking": false, "render_env": false, "action_mask_key": "action_mask", "env_runner_cls": null, "num_env_runners": 0, "create_local_env_runner": true, "num_envs_per_env_runner": 1, "gym_env_vectorize_mode": "SYNC", "num_cpus_per_env_runner": 1, "num_gpus_per_env_runner": 0, "custom_resources_per_env_runner": {}, "validate_env_runners_after_construction": true, "episodes_to_numpy": true, "max_requests_in_flight_per_env_runner": 1, "sample_timeout_s": 60.0, "_env_to_module_connector": null, "add_default_connectors_to_env_to_module_pipeline": true, "_module_to_env_connector": null, "add_default_connectors_to_module_to_env_pipeline": true, "merge_env_runner_states": "training_only", "broadcast_env_runner_states": true, "episode_lookback_horizon": 1, "rollout_fragment_length": "auto", "batch_mode": "complete_episodes", "compress_observations": false, "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "enable_tf1_exec_eagerly": false, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "preprocessor_pref": "deepmind", "observation_filter": "NoFilter", "update_worker_filter_stats": true, "use_worker_filter_stats": true, "sampler_perf_stats_ema_coef": null, "_is_online": true, "num_learners": 0, "num_gpus_per_learner": 0, "num_cpus_per_learner": "auto", "num_aggregator_actors_per_learner": 0, "max_requests_in_flight_per_aggregator_actor": 3, "local_gpu_idx": 0, "max_requests_in_flight_per_learner": 3, "gamma": 1, "lr": 0.0002847858517, "grad_clip": 0.5, "grad_clip_by": "global_norm", "_train_batch_size_per_learner": 5000, "train_batch_size": 4000, "num_epochs": 1, "minibatch_size": 1000, "shuffle_batch_per_epoch": true, "model": {"fcnet_hiddens": [256, 256], "fcnet_activation": "tanh", "fcnet_weights_initializer": null, "fcnet_weights_initializer_config": null, "fcnet_bias_initializer": null, "fcnet_bias_initializer_config": null, "conv_filters": null, "conv_activation": "relu", "conv_kernel_initializer": null, "conv_kernel_initializer_config": null, "conv_bias_initializer": null, "conv_bias_initializer_config": null, "conv_transpose_kernel_initializer": null, "conv_transpose_kernel_initializer_config": null, "conv_transpose_bias_initializer": null, "conv_transpose_bias_initializer_config": null, "post_fcnet_hiddens": [], "post_fcnet_activation": "relu", "post_fcnet_weights_initializer": null, "post_fcnet_weights_initializer_config": null, "post_fcnet_bias_initializer": null, "post_fcnet_bias_initializer_config": null, "free_log_std": false, "log_std_clip_param": 20.0, "no_final_linear": false, "vf_share_layers": false, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "lstm_weights_initializer": null, "lstm_weights_initializer_config": null, "lstm_bias_initializer": null, "lstm_bias_initializer_config": null, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "attention_use_n_prev_actions": 0, "attention_use_n_prev_rewards": 0, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": null, "custom_model_config": {}, "custom_action_dist": null, "custom_preprocessor": null, "encoder_latent_dim": null, "always_check_shapes": false, "lstm_use_prev_action_reward": -1, "_use_default_native_models": -1, "_disable_preprocessor_api": false, "_disable_action_flattening": false}, "_learner_connector": null, "add_default_connectors_to_learner_pipeline": true, "learner_config_dict": {}, "optimizer": {}, "_learner_class": null, "callbacks_on_algorithm_init": null, "callbacks_on_env_runners_recreated": null, "callbacks_on_offline_eval_runners_recreated": null, "callbacks_on_checkpoint_loaded": null, "callbacks_on_environment_created": null, "callbacks_on_episode_created": null, "callbacks_on_episode_start": null, "callbacks_on_episode_step": null, "callbacks_on_episode_end": null, "callbacks_on_evaluate_start": null, "callbacks_on_evaluate_end": null, "callbacks_on_evaluate_offline_start": null, "callbacks_on_evaluate_offline_end": null, "callbacks_on_sample_end": null, "callbacks_on_train_result": null, "explore": true, "enable_rl_module_and_learner": true, "enable_env_runner_and_connector_v2": true, "_prior_exploration_config": {"type": "StochasticSampling"}, "count_steps_by": "env_steps", "policy_map_capacity": 100, "policy_mapping_fn": "<function AlgorithmConfig.DEFAULT_POLICY_MAPPING_FN at 0x161d55b20>", "policies_to_train": null, "policy_states_are_swappable": false, "observation_fn": null, "offline_data_class": null, "input_read_method": "read_parquet", "input_read_method_kwargs": {}, "input_read_schema": {}, "input_read_episodes": false, "input_read_sample_batches": false, "input_read_batch_size": null, "input_filesystem": null, "input_filesystem_kwargs": {}, "input_compress_columns": ["obs", "new_obs"], "input_spaces_jsonable": true, "materialize_data": false, "materialize_mapped_data": true, "map_batches_kwargs": {}, "iter_batches_kwargs": {}, "ignore_final_observation": false, "prelearner_class": null, "prelearner_buffer_class": null, "prelearner_buffer_kwargs": {}, "prelearner_module_synch_period": 10, "dataset_num_iters_per_learner": null, "input_config": {}, "actions_in_input_normalized": false, "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_config": {}, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "output_max_rows_per_file": null, "output_write_remaining_data": false, "output_write_method": "write_parquet", "output_write_method_kwargs": {}, "output_filesystem": null, "output_filesystem_kwargs": {}, "output_write_episodes": true, "offline_sampling": false, "evaluation_interval": 1, "evaluation_duration": 20, "evaluation_duration_unit": "episodes", "evaluation_sample_timeout_s": 120.0, "evaluation_auto_duration_min_env_steps_per_sample": 100, "evaluation_auto_duration_max_env_steps_per_sample": 2000, "evaluation_parallel_to_training": false, "evaluation_force_reset_envs_before_iteration": true, "evaluation_config": null, "off_policy_estimation_methods": {}, "ope_split_batch_by_episode": true, "evaluation_num_env_runners": 1, "in_evaluation": false, "sync_filters_on_rollout_workers_timeout_s": 10.0, "offline_evaluation_interval": null, "num_offline_eval_runners": 0, "offline_loss_for_module_fn": null, "offline_evaluation_duration": 1, "offline_evaluation_parallel_to_training": false, "offline_evaluation_timeout_s": 120.0, "num_cpus_per_offline_eval_runner": 1, "num_gpus_per_offline_eval_runner": 0, "custom_resources_per_offline_eval_runner": {}, "restart_failed_offline_eval_runners": true, "ignore_offline_eval_runner_failures": false, "max_num_offline_eval_runner_restarts": 1000, "offline_eval_runner_restore_timeout_s": 1800.0, "max_requests_in_flight_per_offline_eval_runner": 1, "validate_offline_eval_runners_after_construction": true, "offline_eval_runner_health_probe_timeout_s": 30.0, "offline_eval_rl_module_inference_only": false, "broadcast_offline_eval_runner_states": false, "offline_eval_batch_size_per_runner": 256, "dataset_num_iters_per_eval_runner": 1, "keep_per_episode_custom_metrics": false, "metrics_episode_collection_timeout_s": 60.0, "metrics_num_episodes_for_smoothing": 100, "min_time_s_per_iteration": null, "min_train_timesteps_per_iteration": 0, "min_sample_timesteps_per_iteration": 0, "log_gradients": true, "export_native_model_files": false, "checkpoint_trainable_policies_only": false, "logger_creator": null, "logger_config": null, "log_level": "WARN", "log_sys_usage": true, "fake_sampler": false, "seed": 4, "restart_failed_env_runners": true, "ignore_env_runner_failures": false, "max_num_env_runner_restarts": 1000, "delay_between_env_runner_restarts_s": 60.0, "restart_failed_sub_environments": false, "num_consecutive_env_runner_failures_tolerance": 100, "env_runner_health_probe_timeout_s": 30.0, "env_runner_restore_timeout_s": 1800.0, "_model_config": {}, "_rl_module_spec": "RLModuleSpec(module_class=None, observation_space=None, action_space=None, inference_only=False, learner_only=False, model_config=DefaultModelConfig(fcnet_hiddens=[60, 90], fcnet_activation='tanh', fcnet_kernel_initializer=None, fcnet_kernel_initializer_kwargs=None, fcnet_bias_initializer=None, fcnet_bias_initializer_kwargs=None, conv_filters=None, conv_activation='relu', conv_kernel_initializer=None, conv_kernel_initializer_kwargs=None, conv_bias_initializer=None, conv_bias_initializer_kwargs=None, head_fcnet_hiddens=[], head_fcnet_activation='relu', head_fcnet_kernel_initializer=None, head_fcnet_kernel_initializer_kwargs=None, head_fcnet_bias_initializer=None, head_fcnet_bias_initializer_kwargs=None, free_log_std=False, log_std_clip_param=20.0, vf_share_layers=True, use_lstm=False, max_seq_len=20, lstm_cell_size=256, lstm_use_prev_action=False, lstm_use_prev_reward=False, lstm_kernel_initializer=None, lstm_kernel_initializer_kwargs=None, lstm_bias_initializer=None, lstm_bias_initializer_kwargs=None), catalog_class=None, load_state_path=None, model_config_dict=None)", "algorithm_config_overrides_per_module": {}, "_per_module_overrides": {}, "_validate_config": true, "_use_msgpack_checkpoints": false, "_torch_grad_scaler_class": null, "_torch_lr_scheduler_classes": null, "_tf_policy_handles_more_than_one_loss": false, "_disable_preprocessor_api": false, "_disable_action_flattening": false, "_disable_initialize_loss_from_dummy_batch": false, "_dont_auto_sync_env_runner_states": false, "env_task_fn": -1, "enable_connectors": -1, "simple_optimizer": false, "policy_map_cache": -1, "worker_cls": -1, "synchronize_filters": -1, "enable_async_evaluation": -1, "custom_async_evaluation_function": -1, "_enable_rl_module_api": -1, "auto_wrap_old_gym_envs": -1, "always_attach_evaluation_results": -1, "replay_sequence_length": null, "_disable_execution_plan_api": -1, "use_critic": true, "use_gae": true, "use_kl_loss": true, "kl_coeff": 0.7464963036515, "kl_target": 0.0270990929592, "vf_loss_coeff": 0.6688075857018, "entropy_coeff": 0.0090570820258, "clip_param": 0.1221781641624, "vf_clip_param": 0.1027808522125, "entropy_coeff_schedule": null, "lr_schedule": null, "sgd_minibatch_size": -1, "vf_share_layers": -1, "__stdout_file__": null, "__stderr_file__": null, "lambda": 0.9099046732075, "input": "sampler", "policies": {"default_policy": [null, null, null, null]}, "callbacks": "<class 'ray.rllib.callbacks.callbacks.RLlibCallback'>", "create_env_on_driver": false, "custom_eval_function": null, "framework": "torch"}, "time_since_restore": 54.28325891494751, "iterations_since_restore": 18, "perf": {"cpu_util_percent": 78.6, "ram_util_percent": 80.84}}
{"timers": {"training_iteration": 3.381855501201955, "restore_env_runners": 4.445115684213201e-05, "training_step": 3.381506257814959, "env_runner_sampling_timer": 3.203984382639781, "learner_update_timer": 0.1706121854921556, "synch_weights": 0.0012220775029021347, "restore_eval_env_runners": 1.173893886773197e-05, "evaluation_iteration": 0.20168093743624527, "synch_eval_env_connectors": 0.0004379072216280151, "synch_env_connectors": 5.854451599867205e-06}, "env_runners": {"agent_episode_returns_mean": {"default_agent": 10.66}, "env_to_module_connector": {"timers": {"connectors": {"add_time_dim_to_batch_and_zero_pad": 5.799642014070701e-06, "add_states_from_episodes_to_batch": 3.7901190338133886e-06, "numpy_to_tensor": 2.6932867272383465e-05, "add_observations_from_episodes_to_batch": 6.635326739683598e-06, "batch_individual_items": 1.602193280416898e-05}}, "connector_pipeline_timer": 0.00010083065634382327}, "episode_len_mean": 20.0, "episode_len_min": 20, "episode_return_max": 12.5, "num_agent_steps_sampled": {"default_agent": 5000.0}, "module_to_env_connector": {"timers": {"connectors": {"listify_data_for_vector_env": 2.550562211858233e-05, "tensor_to_numpy": 3.2420652123684586e-05, "normalize_and_clip_actions": 2.0006580828311196e-05, "get_actions": 0.0001170247474665185, "un_batch_to_individual_items": 1.2774131557757675e-05, "remove_single_ts_time_rank_from_batch": 1.2911316661934635e-06}}, "connector_pipeline_timer": 0.00026323398405307495}, "num_env_steps_sampled": 5000.0, "episode_return_mean": 10.66, "num_episodes_lifetime": -524375.0, "episode_return_min": -7.5, "time_between_sampling": 0.003495091099770526, "episode_len_max": 20, "env_reset_timer": 0.00010588617917447571, "num_env_steps_sampled_lifetime": -10487500.0, "env_to_module_sum_episodes_length_in": 10.36823839457432, "sample": 0.012401997953184822, "num_episodes": 250.0, "num_module_steps_sampled_lifetime": {"default_policy": -10487500.0}, "module_episode_returns_mean": {"default_policy": 10.66}, "env_step_timer": 3.702230054411362e-05, "weights_seq_no": 18.0, "num_agent_steps_sampled_lifetime": {"default_agent": -10487500.0}, "rlmodule_inference_timer": 7.654737702279219e-05, "env_to_module_sum_episodes_length_out": 10.36823839457432, "num_module_steps_sampled": {"default_policy": 5000.0}, "episode_duration_sec_mean": 0.01136403832165525, "num_env_steps_sampled_lifetime_throughput": 1866.3005863813853}, "learners": {"__all_modules__": {"learner_connector": {"timers": {"connectors": {"numpy_to_tensor": 9.023559222970184e-05, "add_columns_from_episodes_to_train_batch": 0.05081799194152313, "add_observations_from_episodes_to_batch": 0.0018211550687084659, "add_states_from_episodes_to_batch": 1.0151376903174948e-05, "general_advantage_estimation": 0.007308654650133822, "batch_individual_items": 0.04825389374867072, "add_one_ts_to_episodes_and_truncate": 0.011346877479174695, "add_time_dim_to_batch_and_zero_pad": 1.954631520405131e-05}}, "connector_pipeline_timer": 0.11987904267308862}, "num_module_steps_trained_lifetime": 114000, "learner_connector_sum_episodes_length_in": 5000.0, "num_trainable_parameters": 6003, "learner_connector_sum_episodes_length_out": 5250.0, "num_env_steps_trained_lifetime": 598500, "num_module_steps_trained": 6000, "num_env_steps_trained": 31500, "num_non_trainable_parameters": 0, "num_env_steps_trained_lifetime_throughput": 1134999.2483770587, "num_module_steps_trained_throughput": 216978.2451162439, "num_module_steps_trained_lifetime_throughput": 216047.13997466353}, "default_policy": {"policy_loss": -0.04904314875602722, "mean_kl_loss": 0.0003655123873613775, "diff_num_grad_updates_vs_sampler_policy": 1.0, "num_module_steps_trained_lifetime": 114000, "entropy": 0.352801650762558, "vf_explained_var": 0.018101215362548828, "gradients_default_optimizer_global_norm": 0.07589247077703476, "module_train_batch_size_mean": 1000.0, "weights_seq_no": 19.0, "total_loss": 0.01614151895046234, "curr_kl_coeff": 1.423828734914423e-06, "default_optimizer_learning_rate": 0.0002847858517, "vf_loss_unclipped": 28.553913116455078, "vf_loss": 0.10224167257547379, "curr_entropy_coeff": 0.0090570820258, "num_trainable_parameters": 6003, "num_module_steps_trained": 6000, "num_module_steps_trained_lifetime_throughput": 218364.3476766755}}, "num_training_step_calls_per_iteration": 1, "evaluation": {"env_runners": {"module_to_env_connector": {"timers": {"connectors": {"tensor_to_numpy": 2.6982600559405175e-05, "normalize_and_clip_actions": 1.6968011486992155e-05, "get_actions": 9.271243906689369e-05, "un_batch_to_individual_items": 1.0041566820179081e-05, "remove_single_ts_time_rank_from_batch": 1.043820131750111e-06, "listify_data_for_vector_env": 2.0586017504004257e-05}}, "connector_pipeline_timer": 0.00021672321803598225}, "episode_duration_sec_mean": 0.00831613497575745, "module_episode_returns_mean": {"default_policy": 1.15}, "episode_len_mean": 20.0, "env_to_module_connector": {"timers": {"connectors": {"add_time_dim_to_batch_and_zero_pad": 4.122357217963771e-06, "add_states_from_episodes_to_batch": 2.63266697951682e-06, "add_observations_from_episodes_to_batch": 5.626131962304798e-06, "batch_individual_items": 1.3009237962878488e-05, "numpy_to_tensor": 1.83279899324404e-05}}, "connector_pipeline_timer": 7.98094916365897e-05}, "num_env_steps_sampled_lifetime": 95400, "env_to_module_sum_episodes_length_out": 10.368238394574323, "num_agent_steps_sampled": {"default_agent": 400}, "env_reset_timer": 0.00044902750670165016, "env_step_timer": 2.9782670911945717e-05, "weights_seq_no": 19.0, "rlmodule_inference_timer": 6.134332911999187e-05, "num_module_steps_sampled": {"default_policy": 400}, "agent_episode_returns_mean": {"default_agent": 1.15}, "env_to_module_sum_episodes_length_in": 10.368238394574323, "episode_len_max": 20, "sample": 0.18980196525336568, "episode_len_min": 20, "num_module_steps_sampled_lifetime": {"default_policy": 7600}, "episode_return_max": 12.5, "num_agent_steps_sampled_lifetime": {"default_agent": 7600}, "num_env_steps_sampled": 400, "episode_return_min": -16.5, "episode_return_mean": 1.15, "num_episodes_lifetime": 380, "num_episodes": 20, "time_between_sampling": 2.7495033815991197}, "num_healthy_workers": 1, "actor_manager_num_outstanding_async_reqs": 0, "num_remote_worker_restarts": 0}, "num_env_steps_sampled_lifetime": -10487500.0, "fault_tolerance": {"num_healthy_workers": 0, "num_remote_worker_restarts": 0}, "env_runner_group": {"actor_manager_num_outstanding_async_reqs": 0}, "done": false, "training_iteration": 19, "trial_id": "4638e_00000", "date": "2025-08-11_19-33-59", "timestamp": 1754933639, "time_this_iter_s": 3.9507949352264404, "time_total_s": 58.23405385017395, "pid": 25862, "hostname": "Mac", "node_ip": "127.0.0.1", "config": {"exploration_config": {}, "extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "placement_strategy": "PACK", "num_gpus": 0, "_fake_gpus": false, "num_cpus_for_main_process": 2, "eager_tracing": true, "eager_max_retraces": 20, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "torch_compile_learner": false, "torch_compile_learner_what_to_compile": "forward_train", "torch_compile_learner_dynamo_backend": "aot_eager", "torch_compile_learner_dynamo_mode": null, "torch_compile_worker": false, "torch_compile_worker_dynamo_backend": "aot_eager", "torch_compile_worker_dynamo_mode": null, "torch_ddp_kwargs": {}, "torch_skip_nan_gradients": false, "env": "Umbrella", "env_config": {}, "observation_space": null, "action_space": null, "clip_rewards": null, "normalize_actions": true, "clip_actions": false, "_is_atari": null, "disable_env_checking": false, "render_env": false, "action_mask_key": "action_mask", "env_runner_cls": null, "num_env_runners": 0, "create_local_env_runner": true, "num_envs_per_env_runner": 1, "gym_env_vectorize_mode": "SYNC", "num_cpus_per_env_runner": 1, "num_gpus_per_env_runner": 0, "custom_resources_per_env_runner": {}, "validate_env_runners_after_construction": true, "episodes_to_numpy": true, "max_requests_in_flight_per_env_runner": 1, "sample_timeout_s": 60.0, "_env_to_module_connector": null, "add_default_connectors_to_env_to_module_pipeline": true, "_module_to_env_connector": null, "add_default_connectors_to_module_to_env_pipeline": true, "merge_env_runner_states": "training_only", "broadcast_env_runner_states": true, "episode_lookback_horizon": 1, "rollout_fragment_length": "auto", "batch_mode": "complete_episodes", "compress_observations": false, "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "enable_tf1_exec_eagerly": false, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "preprocessor_pref": "deepmind", "observation_filter": "NoFilter", "update_worker_filter_stats": true, "use_worker_filter_stats": true, "sampler_perf_stats_ema_coef": null, "_is_online": true, "num_learners": 0, "num_gpus_per_learner": 0, "num_cpus_per_learner": "auto", "num_aggregator_actors_per_learner": 0, "max_requests_in_flight_per_aggregator_actor": 3, "local_gpu_idx": 0, "max_requests_in_flight_per_learner": 3, "gamma": 1, "lr": 0.0002847858517, "grad_clip": 0.5, "grad_clip_by": "global_norm", "_train_batch_size_per_learner": 5000, "train_batch_size": 4000, "num_epochs": 1, "minibatch_size": 1000, "shuffle_batch_per_epoch": true, "model": {"fcnet_hiddens": [256, 256], "fcnet_activation": "tanh", "fcnet_weights_initializer": null, "fcnet_weights_initializer_config": null, "fcnet_bias_initializer": null, "fcnet_bias_initializer_config": null, "conv_filters": null, "conv_activation": "relu", "conv_kernel_initializer": null, "conv_kernel_initializer_config": null, "conv_bias_initializer": null, "conv_bias_initializer_config": null, "conv_transpose_kernel_initializer": null, "conv_transpose_kernel_initializer_config": null, "conv_transpose_bias_initializer": null, "conv_transpose_bias_initializer_config": null, "post_fcnet_hiddens": [], "post_fcnet_activation": "relu", "post_fcnet_weights_initializer": null, "post_fcnet_weights_initializer_config": null, "post_fcnet_bias_initializer": null, "post_fcnet_bias_initializer_config": null, "free_log_std": false, "log_std_clip_param": 20.0, "no_final_linear": false, "vf_share_layers": false, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "lstm_weights_initializer": null, "lstm_weights_initializer_config": null, "lstm_bias_initializer": null, "lstm_bias_initializer_config": null, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "attention_use_n_prev_actions": 0, "attention_use_n_prev_rewards": 0, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": null, "custom_model_config": {}, "custom_action_dist": null, "custom_preprocessor": null, "encoder_latent_dim": null, "always_check_shapes": false, "lstm_use_prev_action_reward": -1, "_use_default_native_models": -1, "_disable_preprocessor_api": false, "_disable_action_flattening": false}, "_learner_connector": null, "add_default_connectors_to_learner_pipeline": true, "learner_config_dict": {}, "optimizer": {}, "_learner_class": null, "callbacks_on_algorithm_init": null, "callbacks_on_env_runners_recreated": null, "callbacks_on_offline_eval_runners_recreated": null, "callbacks_on_checkpoint_loaded": null, "callbacks_on_environment_created": null, "callbacks_on_episode_created": null, "callbacks_on_episode_start": null, "callbacks_on_episode_step": null, "callbacks_on_episode_end": null, "callbacks_on_evaluate_start": null, "callbacks_on_evaluate_end": null, "callbacks_on_evaluate_offline_start": null, "callbacks_on_evaluate_offline_end": null, "callbacks_on_sample_end": null, "callbacks_on_train_result": null, "explore": true, "enable_rl_module_and_learner": true, "enable_env_runner_and_connector_v2": true, "_prior_exploration_config": {"type": "StochasticSampling"}, "count_steps_by": "env_steps", "policy_map_capacity": 100, "policy_mapping_fn": "<function AlgorithmConfig.DEFAULT_POLICY_MAPPING_FN at 0x161d55b20>", "policies_to_train": null, "policy_states_are_swappable": false, "observation_fn": null, "offline_data_class": null, "input_read_method": "read_parquet", "input_read_method_kwargs": {}, "input_read_schema": {}, "input_read_episodes": false, "input_read_sample_batches": false, "input_read_batch_size": null, "input_filesystem": null, "input_filesystem_kwargs": {}, "input_compress_columns": ["obs", "new_obs"], "input_spaces_jsonable": true, "materialize_data": false, "materialize_mapped_data": true, "map_batches_kwargs": {}, "iter_batches_kwargs": {}, "ignore_final_observation": false, "prelearner_class": null, "prelearner_buffer_class": null, "prelearner_buffer_kwargs": {}, "prelearner_module_synch_period": 10, "dataset_num_iters_per_learner": null, "input_config": {}, "actions_in_input_normalized": false, "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_config": {}, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "output_max_rows_per_file": null, "output_write_remaining_data": false, "output_write_method": "write_parquet", "output_write_method_kwargs": {}, "output_filesystem": null, "output_filesystem_kwargs": {}, "output_write_episodes": true, "offline_sampling": false, "evaluation_interval": 1, "evaluation_duration": 20, "evaluation_duration_unit": "episodes", "evaluation_sample_timeout_s": 120.0, "evaluation_auto_duration_min_env_steps_per_sample": 100, "evaluation_auto_duration_max_env_steps_per_sample": 2000, "evaluation_parallel_to_training": false, "evaluation_force_reset_envs_before_iteration": true, "evaluation_config": null, "off_policy_estimation_methods": {}, "ope_split_batch_by_episode": true, "evaluation_num_env_runners": 1, "in_evaluation": false, "sync_filters_on_rollout_workers_timeout_s": 10.0, "offline_evaluation_interval": null, "num_offline_eval_runners": 0, "offline_loss_for_module_fn": null, "offline_evaluation_duration": 1, "offline_evaluation_parallel_to_training": false, "offline_evaluation_timeout_s": 120.0, "num_cpus_per_offline_eval_runner": 1, "num_gpus_per_offline_eval_runner": 0, "custom_resources_per_offline_eval_runner": {}, "restart_failed_offline_eval_runners": true, "ignore_offline_eval_runner_failures": false, "max_num_offline_eval_runner_restarts": 1000, "offline_eval_runner_restore_timeout_s": 1800.0, "max_requests_in_flight_per_offline_eval_runner": 1, "validate_offline_eval_runners_after_construction": true, "offline_eval_runner_health_probe_timeout_s": 30.0, "offline_eval_rl_module_inference_only": false, "broadcast_offline_eval_runner_states": false, "offline_eval_batch_size_per_runner": 256, "dataset_num_iters_per_eval_runner": 1, "keep_per_episode_custom_metrics": false, "metrics_episode_collection_timeout_s": 60.0, "metrics_num_episodes_for_smoothing": 100, "min_time_s_per_iteration": null, "min_train_timesteps_per_iteration": 0, "min_sample_timesteps_per_iteration": 0, "log_gradients": true, "export_native_model_files": false, "checkpoint_trainable_policies_only": false, "logger_creator": null, "logger_config": null, "log_level": "WARN", "log_sys_usage": true, "fake_sampler": false, "seed": 4, "restart_failed_env_runners": true, "ignore_env_runner_failures": false, "max_num_env_runner_restarts": 1000, "delay_between_env_runner_restarts_s": 60.0, "restart_failed_sub_environments": false, "num_consecutive_env_runner_failures_tolerance": 100, "env_runner_health_probe_timeout_s": 30.0, "env_runner_restore_timeout_s": 1800.0, "_model_config": {}, "_rl_module_spec": "RLModuleSpec(module_class=None, observation_space=None, action_space=None, inference_only=False, learner_only=False, model_config=DefaultModelConfig(fcnet_hiddens=[60, 90], fcnet_activation='tanh', fcnet_kernel_initializer=None, fcnet_kernel_initializer_kwargs=None, fcnet_bias_initializer=None, fcnet_bias_initializer_kwargs=None, conv_filters=None, conv_activation='relu', conv_kernel_initializer=None, conv_kernel_initializer_kwargs=None, conv_bias_initializer=None, conv_bias_initializer_kwargs=None, head_fcnet_hiddens=[], head_fcnet_activation='relu', head_fcnet_kernel_initializer=None, head_fcnet_kernel_initializer_kwargs=None, head_fcnet_bias_initializer=None, head_fcnet_bias_initializer_kwargs=None, free_log_std=False, log_std_clip_param=20.0, vf_share_layers=True, use_lstm=False, max_seq_len=20, lstm_cell_size=256, lstm_use_prev_action=False, lstm_use_prev_reward=False, lstm_kernel_initializer=None, lstm_kernel_initializer_kwargs=None, lstm_bias_initializer=None, lstm_bias_initializer_kwargs=None), catalog_class=None, load_state_path=None, model_config_dict=None)", "algorithm_config_overrides_per_module": {}, "_per_module_overrides": {}, "_validate_config": true, "_use_msgpack_checkpoints": false, "_torch_grad_scaler_class": null, "_torch_lr_scheduler_classes": null, "_tf_policy_handles_more_than_one_loss": false, "_disable_preprocessor_api": false, "_disable_action_flattening": false, "_disable_initialize_loss_from_dummy_batch": false, "_dont_auto_sync_env_runner_states": false, "env_task_fn": -1, "enable_connectors": -1, "simple_optimizer": false, "policy_map_cache": -1, "worker_cls": -1, "synchronize_filters": -1, "enable_async_evaluation": -1, "custom_async_evaluation_function": -1, "_enable_rl_module_api": -1, "auto_wrap_old_gym_envs": -1, "always_attach_evaluation_results": -1, "replay_sequence_length": null, "_disable_execution_plan_api": -1, "use_critic": true, "use_gae": true, "use_kl_loss": true, "kl_coeff": 0.7464963036515, "kl_target": 0.0270990929592, "vf_loss_coeff": 0.6688075857018, "entropy_coeff": 0.0090570820258, "clip_param": 0.1221781641624, "vf_clip_param": 0.1027808522125, "entropy_coeff_schedule": null, "lr_schedule": null, "sgd_minibatch_size": -1, "vf_share_layers": -1, "__stdout_file__": null, "__stderr_file__": null, "lambda": 0.9099046732075, "input": "sampler", "policies": {"default_policy": [null, null, null, null]}, "callbacks": "<class 'ray.rllib.callbacks.callbacks.RLlibCallback'>", "create_env_on_driver": false, "custom_eval_function": null, "framework": "torch"}, "time_since_restore": 58.23405385017395, "iterations_since_restore": 19, "perf": {"cpu_util_percent": 46.58, "ram_util_percent": 80.58}}
{"timers": {"training_iteration": 3.3783255674400094, "restore_env_runners": 4.407498572423597e-05, "training_step": 3.3779773556567374, "env_runner_sampling_timer": 3.201062833813318, "learner_update_timer": 0.17004091572785168, "synch_weights": 0.0012153088078043874, "restore_eval_env_runners": 1.1716549038278301e-05, "evaluation_iteration": 0.2019834997214243, "synch_eval_env_connectors": 0.00043481647936133744, "synch_env_connectors": 5.836746742918639e-06}, "env_runners": {"agent_episode_returns_mean": {"default_agent": 10.66}, "env_to_module_connector": {"timers": {"connectors": {"add_time_dim_to_batch_and_zero_pad": 6.080360619468149e-06, "add_states_from_episodes_to_batch": 2.751700976001037e-06, "numpy_to_tensor": 2.0365867872873236e-05, "add_observations_from_episodes_to_batch": 5.929817684655237e-06, "batch_individual_items": 2.000106745304825e-05}}, "connector_pipeline_timer": 9.368796673907588e-05}, "episode_len_mean": 20.0, "episode_len_min": 20, "episode_return_max": 12.5, "num_agent_steps_sampled": {"default_agent": 5000.0}, "module_to_env_connector": {"timers": {"connectors": {"listify_data_for_vector_env": 2.2286702750695628e-05, "tensor_to_numpy": 2.742659470905401e-05, "normalize_and_clip_actions": 1.7411850648650782e-05, "get_actions": 9.809153441527404e-05, "un_batch_to_individual_items": 1.0068461233621599e-05, "remove_single_ts_time_rank_from_batch": 1.1386253003831825e-06}}, "connector_pipeline_timer": 0.0002248943070203651}, "num_env_steps_sampled": 5000.0, "episode_return_mean": 10.66, "num_episodes_lifetime": -555250.0, "episode_return_min": -7.5, "time_between_sampling": 0.00374275819076546, "episode_len_max": 20, "env_reset_timer": 0.00010289624584700676, "num_env_steps_sampled_lifetime": -11105000.0, "env_to_module_sum_episodes_length_in": 10.36823839457432, "sample": 0.011451857610424138, "num_episodes": 250.0, "num_module_steps_sampled_lifetime": {"default_policy": -11105000.0}, "module_episode_returns_mean": {"default_policy": 10.66}, "env_step_timer": 3.156250546872915e-05, "weights_seq_no": 19.0, "num_agent_steps_sampled_lifetime": {"default_agent": -11105000.0}, "rlmodule_inference_timer": 6.276471341305278e-05, "env_to_module_sum_episodes_length_out": 10.36823839457432, "num_module_steps_sampled": {"default_policy": 5000.0}, "episode_duration_sec_mean": 0.009878318493254485, "num_env_steps_sampled_lifetime_throughput": 2047.6465930694274}, "learners": {"__all_modules__": {"learner_connector": {"timers": {"connectors": {"numpy_to_tensor": 9.033990637076634e-05, "add_columns_from_episodes_to_train_batch": 0.05080093577221526, "add_observations_from_episodes_to_batch": 0.001812223937929845, "add_states_from_episodes_to_batch": 1.0083613100094046e-05, "general_advantage_estimation": 0.00729749893375725, "batch_individual_items": 0.04810990564167676, "add_one_ts_to_episodes_and_truncate": 0.011315689124848344, "add_time_dim_to_batch_and_zero_pad": 1.9505852068104052e-05}}, "connector_pipeline_timer": 0.11966599599554599}, "num_module_steps_trained_lifetime": 120000, "learner_connector_sum_episodes_length_in": 5000.0, "num_trainable_parameters": 6003, "learner_connector_sum_episodes_length_out": 5250.0, "num_env_steps_trained_lifetime": 630000, "num_module_steps_trained": 6000, "num_env_steps_trained": 31500, "num_non_trainable_parameters": 0, "num_env_steps_trained_lifetime_throughput": 1145555.6533093038, "num_module_steps_trained_throughput": 218958.35925469227, "num_module_steps_trained_lifetime_throughput": 218066.90480462767}, "default_policy": {"policy_loss": -0.025547273457050323, "mean_kl_loss": 0.00021589340758509934, "diff_num_grad_updates_vs_sampler_policy": 1.0, "num_module_steps_trained_lifetime": 120000, "entropy": 0.33666831254959106, "vf_explained_var": 0.018335282802581787, "gradients_default_optimizer_global_norm": 0.03212713077664375, "module_train_batch_size_mean": 1000.0, "weights_seq_no": 20.0, "total_loss": 0.03985561802983284, "curr_kl_coeff": 7.119143674572115e-07, "default_optimizer_learning_rate": 0.0002847858517, "vf_loss_unclipped": 28.65300178527832, "vf_loss": 0.10234948992729187, "curr_entropy_coeff": 0.0090570820258, "num_trainable_parameters": 6003, "num_module_steps_trained": 6000, "num_module_steps_trained_lifetime_throughput": 220255.37533512572}}, "num_training_step_calls_per_iteration": 1, "evaluation": {"env_runners": {"module_to_env_connector": {"timers": {"connectors": {"tensor_to_numpy": 2.3204257711205332e-05, "normalize_and_clip_actions": 1.5899430408758508e-05, "get_actions": 7.785261860874473e-05, "un_batch_to_individual_items": 7.868285480095172e-06, "remove_single_ts_time_rank_from_batch": 1.0668133109745443e-06, "listify_data_for_vector_env": 2.1387518234985656e-05}}, "connector_pipeline_timer": 0.00018948556861065442}, "episode_duration_sec_mean": 0.00784947999403812, "module_episode_returns_mean": {"default_policy": 1.15}, "episode_len_mean": 20.0, "env_to_module_connector": {"timers": {"connectors": {"add_time_dim_to_batch_and_zero_pad": 3.527591637326406e-06, "add_states_from_episodes_to_batch": 2.371331750639515e-06, "add_observations_from_episodes_to_batch": 6.045207975643525e-06, "batch_individual_items": 1.083664837166523e-05, "numpy_to_tensor": 1.429670570119579e-05}}, "connector_pipeline_timer": 6.918250515194934e-05}, "num_env_steps_sampled_lifetime": 100400, "env_to_module_sum_episodes_length_out": 10.368238394574323, "num_agent_steps_sampled": {"default_agent": 400}, "env_reset_timer": 0.00044539598089762226, "env_step_timer": 2.5594750702923187e-05, "weights_seq_no": 20.0, "rlmodule_inference_timer": 5.333211519192815e-05, "num_module_steps_sampled": {"default_policy": 400}, "agent_episode_returns_mean": {"default_agent": 1.15}, "env_to_module_sum_episodes_length_in": 10.368238394574323, "episode_len_max": 20, "sample": 0.18937314309993214, "episode_len_min": 20, "num_module_steps_sampled_lifetime": {"default_policy": 8000}, "episode_return_max": 12.5, "num_agent_steps_sampled_lifetime": {"default_agent": 8000}, "num_env_steps_sampled": 400, "episode_return_min": -16.5, "episode_return_mean": 1.15, "num_episodes_lifetime": 400, "num_episodes": 20, "time_between_sampling": 2.7526223452825866}, "num_healthy_workers": 1, "actor_manager_num_outstanding_async_reqs": 0, "num_remote_worker_restarts": 0}, "num_env_steps_sampled_lifetime": -11105000.0, "fault_tolerance": {"num_healthy_workers": 0, "num_remote_worker_restarts": 0}, "env_runner_group": {"actor_manager_num_outstanding_async_reqs": 0}, "done": true, "training_iteration": 20, "trial_id": "4638e_00000", "date": "2025-08-11_19-34-02", "timestamp": 1754933642, "time_this_iter_s": 3.1871390342712402, "time_total_s": 61.42119288444519, "pid": 25862, "hostname": "Mac", "node_ip": "127.0.0.1", "config": {"exploration_config": {}, "extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "placement_strategy": "PACK", "num_gpus": 0, "_fake_gpus": false, "num_cpus_for_main_process": 2, "eager_tracing": true, "eager_max_retraces": 20, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "torch_compile_learner": false, "torch_compile_learner_what_to_compile": "forward_train", "torch_compile_learner_dynamo_backend": "aot_eager", "torch_compile_learner_dynamo_mode": null, "torch_compile_worker": false, "torch_compile_worker_dynamo_backend": "aot_eager", "torch_compile_worker_dynamo_mode": null, "torch_ddp_kwargs": {}, "torch_skip_nan_gradients": false, "env": "Umbrella", "env_config": {}, "observation_space": null, "action_space": null, "clip_rewards": null, "normalize_actions": true, "clip_actions": false, "_is_atari": null, "disable_env_checking": false, "render_env": false, "action_mask_key": "action_mask", "env_runner_cls": null, "num_env_runners": 0, "create_local_env_runner": true, "num_envs_per_env_runner": 1, "gym_env_vectorize_mode": "SYNC", "num_cpus_per_env_runner": 1, "num_gpus_per_env_runner": 0, "custom_resources_per_env_runner": {}, "validate_env_runners_after_construction": true, "episodes_to_numpy": true, "max_requests_in_flight_per_env_runner": 1, "sample_timeout_s": 60.0, "_env_to_module_connector": null, "add_default_connectors_to_env_to_module_pipeline": true, "_module_to_env_connector": null, "add_default_connectors_to_module_to_env_pipeline": true, "merge_env_runner_states": "training_only", "broadcast_env_runner_states": true, "episode_lookback_horizon": 1, "rollout_fragment_length": "auto", "batch_mode": "complete_episodes", "compress_observations": false, "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "enable_tf1_exec_eagerly": false, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "preprocessor_pref": "deepmind", "observation_filter": "NoFilter", "update_worker_filter_stats": true, "use_worker_filter_stats": true, "sampler_perf_stats_ema_coef": null, "_is_online": true, "num_learners": 0, "num_gpus_per_learner": 0, "num_cpus_per_learner": "auto", "num_aggregator_actors_per_learner": 0, "max_requests_in_flight_per_aggregator_actor": 3, "local_gpu_idx": 0, "max_requests_in_flight_per_learner": 3, "gamma": 1, "lr": 0.0002847858517, "grad_clip": 0.5, "grad_clip_by": "global_norm", "_train_batch_size_per_learner": 5000, "train_batch_size": 4000, "num_epochs": 1, "minibatch_size": 1000, "shuffle_batch_per_epoch": true, "model": {"fcnet_hiddens": [256, 256], "fcnet_activation": "tanh", "fcnet_weights_initializer": null, "fcnet_weights_initializer_config": null, "fcnet_bias_initializer": null, "fcnet_bias_initializer_config": null, "conv_filters": null, "conv_activation": "relu", "conv_kernel_initializer": null, "conv_kernel_initializer_config": null, "conv_bias_initializer": null, "conv_bias_initializer_config": null, "conv_transpose_kernel_initializer": null, "conv_transpose_kernel_initializer_config": null, "conv_transpose_bias_initializer": null, "conv_transpose_bias_initializer_config": null, "post_fcnet_hiddens": [], "post_fcnet_activation": "relu", "post_fcnet_weights_initializer": null, "post_fcnet_weights_initializer_config": null, "post_fcnet_bias_initializer": null, "post_fcnet_bias_initializer_config": null, "free_log_std": false, "log_std_clip_param": 20.0, "no_final_linear": false, "vf_share_layers": false, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "lstm_weights_initializer": null, "lstm_weights_initializer_config": null, "lstm_bias_initializer": null, "lstm_bias_initializer_config": null, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "attention_use_n_prev_actions": 0, "attention_use_n_prev_rewards": 0, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": null, "custom_model_config": {}, "custom_action_dist": null, "custom_preprocessor": null, "encoder_latent_dim": null, "always_check_shapes": false, "lstm_use_prev_action_reward": -1, "_use_default_native_models": -1, "_disable_preprocessor_api": false, "_disable_action_flattening": false}, "_learner_connector": null, "add_default_connectors_to_learner_pipeline": true, "learner_config_dict": {}, "optimizer": {}, "_learner_class": null, "callbacks_on_algorithm_init": null, "callbacks_on_env_runners_recreated": null, "callbacks_on_offline_eval_runners_recreated": null, "callbacks_on_checkpoint_loaded": null, "callbacks_on_environment_created": null, "callbacks_on_episode_created": null, "callbacks_on_episode_start": null, "callbacks_on_episode_step": null, "callbacks_on_episode_end": null, "callbacks_on_evaluate_start": null, "callbacks_on_evaluate_end": null, "callbacks_on_evaluate_offline_start": null, "callbacks_on_evaluate_offline_end": null, "callbacks_on_sample_end": null, "callbacks_on_train_result": null, "explore": true, "enable_rl_module_and_learner": true, "enable_env_runner_and_connector_v2": true, "_prior_exploration_config": {"type": "StochasticSampling"}, "count_steps_by": "env_steps", "policy_map_capacity": 100, "policy_mapping_fn": "<function AlgorithmConfig.DEFAULT_POLICY_MAPPING_FN at 0x161d55b20>", "policies_to_train": null, "policy_states_are_swappable": false, "observation_fn": null, "offline_data_class": null, "input_read_method": "read_parquet", "input_read_method_kwargs": {}, "input_read_schema": {}, "input_read_episodes": false, "input_read_sample_batches": false, "input_read_batch_size": null, "input_filesystem": null, "input_filesystem_kwargs": {}, "input_compress_columns": ["obs", "new_obs"], "input_spaces_jsonable": true, "materialize_data": false, "materialize_mapped_data": true, "map_batches_kwargs": {}, "iter_batches_kwargs": {}, "ignore_final_observation": false, "prelearner_class": null, "prelearner_buffer_class": null, "prelearner_buffer_kwargs": {}, "prelearner_module_synch_period": 10, "dataset_num_iters_per_learner": null, "input_config": {}, "actions_in_input_normalized": false, "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_config": {}, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "output_max_rows_per_file": null, "output_write_remaining_data": false, "output_write_method": "write_parquet", "output_write_method_kwargs": {}, "output_filesystem": null, "output_filesystem_kwargs": {}, "output_write_episodes": true, "offline_sampling": false, "evaluation_interval": 1, "evaluation_duration": 20, "evaluation_duration_unit": "episodes", "evaluation_sample_timeout_s": 120.0, "evaluation_auto_duration_min_env_steps_per_sample": 100, "evaluation_auto_duration_max_env_steps_per_sample": 2000, "evaluation_parallel_to_training": false, "evaluation_force_reset_envs_before_iteration": true, "evaluation_config": null, "off_policy_estimation_methods": {}, "ope_split_batch_by_episode": true, "evaluation_num_env_runners": 1, "in_evaluation": false, "sync_filters_on_rollout_workers_timeout_s": 10.0, "offline_evaluation_interval": null, "num_offline_eval_runners": 0, "offline_loss_for_module_fn": null, "offline_evaluation_duration": 1, "offline_evaluation_parallel_to_training": false, "offline_evaluation_timeout_s": 120.0, "num_cpus_per_offline_eval_runner": 1, "num_gpus_per_offline_eval_runner": 0, "custom_resources_per_offline_eval_runner": {}, "restart_failed_offline_eval_runners": true, "ignore_offline_eval_runner_failures": false, "max_num_offline_eval_runner_restarts": 1000, "offline_eval_runner_restore_timeout_s": 1800.0, "max_requests_in_flight_per_offline_eval_runner": 1, "validate_offline_eval_runners_after_construction": true, "offline_eval_runner_health_probe_timeout_s": 30.0, "offline_eval_rl_module_inference_only": false, "broadcast_offline_eval_runner_states": false, "offline_eval_batch_size_per_runner": 256, "dataset_num_iters_per_eval_runner": 1, "keep_per_episode_custom_metrics": false, "metrics_episode_collection_timeout_s": 60.0, "metrics_num_episodes_for_smoothing": 100, "min_time_s_per_iteration": null, "min_train_timesteps_per_iteration": 0, "min_sample_timesteps_per_iteration": 0, "log_gradients": true, "export_native_model_files": false, "checkpoint_trainable_policies_only": false, "logger_creator": null, "logger_config": null, "log_level": "WARN", "log_sys_usage": true, "fake_sampler": false, "seed": 4, "restart_failed_env_runners": true, "ignore_env_runner_failures": false, "max_num_env_runner_restarts": 1000, "delay_between_env_runner_restarts_s": 60.0, "restart_failed_sub_environments": false, "num_consecutive_env_runner_failures_tolerance": 100, "env_runner_health_probe_timeout_s": 30.0, "env_runner_restore_timeout_s": 1800.0, "_model_config": {}, "_rl_module_spec": "RLModuleSpec(module_class=None, observation_space=None, action_space=None, inference_only=False, learner_only=False, model_config=DefaultModelConfig(fcnet_hiddens=[60, 90], fcnet_activation='tanh', fcnet_kernel_initializer=None, fcnet_kernel_initializer_kwargs=None, fcnet_bias_initializer=None, fcnet_bias_initializer_kwargs=None, conv_filters=None, conv_activation='relu', conv_kernel_initializer=None, conv_kernel_initializer_kwargs=None, conv_bias_initializer=None, conv_bias_initializer_kwargs=None, head_fcnet_hiddens=[], head_fcnet_activation='relu', head_fcnet_kernel_initializer=None, head_fcnet_kernel_initializer_kwargs=None, head_fcnet_bias_initializer=None, head_fcnet_bias_initializer_kwargs=None, free_log_std=False, log_std_clip_param=20.0, vf_share_layers=True, use_lstm=False, max_seq_len=20, lstm_cell_size=256, lstm_use_prev_action=False, lstm_use_prev_reward=False, lstm_kernel_initializer=None, lstm_kernel_initializer_kwargs=None, lstm_bias_initializer=None, lstm_bias_initializer_kwargs=None), catalog_class=None, load_state_path=None, model_config_dict=None)", "algorithm_config_overrides_per_module": {}, "_per_module_overrides": {}, "_validate_config": true, "_use_msgpack_checkpoints": false, "_torch_grad_scaler_class": null, "_torch_lr_scheduler_classes": null, "_tf_policy_handles_more_than_one_loss": false, "_disable_preprocessor_api": false, "_disable_action_flattening": false, "_disable_initialize_loss_from_dummy_batch": false, "_dont_auto_sync_env_runner_states": false, "env_task_fn": -1, "enable_connectors": -1, "simple_optimizer": false, "policy_map_cache": -1, "worker_cls": -1, "synchronize_filters": -1, "enable_async_evaluation": -1, "custom_async_evaluation_function": -1, "_enable_rl_module_api": -1, "auto_wrap_old_gym_envs": -1, "always_attach_evaluation_results": -1, "replay_sequence_length": null, "_disable_execution_plan_api": -1, "use_critic": true, "use_gae": true, "use_kl_loss": true, "kl_coeff": 0.7464963036515, "kl_target": 0.0270990929592, "vf_loss_coeff": 0.6688075857018, "entropy_coeff": 0.0090570820258, "clip_param": 0.1221781641624, "vf_clip_param": 0.1027808522125, "entropy_coeff_schedule": null, "lr_schedule": null, "sgd_minibatch_size": -1, "vf_share_layers": -1, "__stdout_file__": null, "__stderr_file__": null, "lambda": 0.9099046732075, "input": "sampler", "policies": {"default_policy": [null, null, null, null]}, "callbacks": "<class 'ray.rllib.callbacks.callbacks.RLlibCallback'>", "create_env_on_driver": false, "custom_eval_function": null, "framework": "torch"}, "time_since_restore": 61.42119288444519, "iterations_since_restore": 20, "perf": {"cpu_util_percent": 72.76, "ram_util_percent": 78.47999999999999}}
