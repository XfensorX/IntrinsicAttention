{"timers": {"training_iteration": 1.5504707499640062, "restore_env_runners": 1.2165983207523823e-05, "training_step": 1.5503374580293894, "env_runner_sampling_timer": 1.443371667061001, "learner_update_timer": 0.10395395895466208, "synch_weights": 0.0005470840260386467}, "env_runners": {"num_module_steps_sampled_lifetime": {"default_policy": 627500.0}, "num_env_steps_sampled_lifetime": 627500.0, "episode_len_mean": 20.0, "env_to_module_connector": {"timers": {"connectors": {"add_time_dim_to_batch_and_zero_pad": 2.5141703032079097e-06, "add_observations_from_episodes_to_batch": 3.1480191771696223e-06, "add_states_from_episodes_to_batch": 1.709786667541071e-06, "numpy_to_tensor": 8.805768234147717e-06, "batch_individual_items": 6.393257393991748e-06}}, "connector_pipeline_timer": 4.581009138487992e-05}, "weights_seq_no": 0.0, "episode_len_min": 20, "num_agent_steps_sampled_lifetime": {"default_agent": 627500.0}, "module_to_env_connector": {"connector_pipeline_timer": 0.00011339924186046922, "timers": {"connectors": {"tensor_to_numpy": 1.3316375324219267e-05, "listify_data_for_vector_env": 1.0932134101479161e-05, "get_actions": 4.474440720267776e-05, "un_batch_to_individual_items": 5.441251781317803e-06, "normalize_and_clip_actions": 1.2471714328559646e-05, "remove_single_ts_time_rank_from_batch": 6.134802045330853e-07}}}, "env_reset_timer": 7.035374791018159e-05, "env_to_module_sum_episodes_length_out": 10.191744832559449, "env_to_module_sum_episodes_length_in": 10.191744832559449, "num_module_steps_sampled": {"default_policy": 5000.0}, "episode_return_mean": 0.8199999999999998, "episode_len_max": 20, "num_env_steps_sampled": 5000.0, "num_episodes_lifetime": 31375.0, "agent_episode_returns_mean": {"default_agent": 0.8199999999999998}, "episode_return_min": -11.5, "sample": 0.005590130739859318, "num_episodes": 250.0, "num_agent_steps_sampled": {"default_agent": 5000.0}, "rlmodule_inference_timer": 4.887936055616263e-05, "module_episode_returns_mean": {"default_policy": 0.8199999999999998}, "episode_return_max": 8.5, "env_step_timer": 1.4347103828579684e-05, "time_between_sampling": 0.0005057432281523791, "episode_duration_sec_mean": 0.004862743359524757, "num_env_steps_sampled_lifetime_throughput": 3545.953937662906}, "learners": {"__all_modules__": {"learner_connector": {"timers": {"connectors": {"numpy_to_tensor": 5.795806646347046e-05, "add_observations_from_episodes_to_batch": 0.0008142919978126884, "add_one_ts_to_episodes_and_truncate": 0.007573083974421024, "add_states_from_episodes_to_batch": 2.8330832719802856e-06, "add_columns_from_episodes_to_train_batch": 0.03449100011494011, "add_time_dim_to_batch_and_zero_pad": 1.0041985660791397e-05, "general_advantage_estimation": 0.006402833038009703, "batch_individual_items": 0.029955458012409508}}, "connector_pipeline_timer": 0.07942229195032269}, "num_module_steps_trained": 6000, "num_trainable_parameters": 6003, "num_module_steps_trained_lifetime": 6000, "learner_connector_sum_episodes_length_out": 5250, "num_env_steps_trained_lifetime": 31500, "num_env_steps_trained": 31500, "learner_connector_sum_episodes_length_in": 5000, "num_non_trainable_parameters": 0, "num_env_steps_trained_lifetime_throughput": 2378567.902790729, "num_module_steps_trained_throughput": 455764.2003547495, "num_module_steps_trained_lifetime_throughput": 454843.0622644262}, "default_policy": {"module_train_batch_size_mean": 1000.0, "entropy": 0.6600642800331116, "mean_kl_loss": 0.00025177394854836166, "policy_loss": -0.2681262493133545, "default_optimizer_learning_rate": 0.0002847858517, "total_loss": -0.2051759511232376, "gradients_default_optimizer_global_norm": 0.07857398688793182, "diff_num_grad_updates_vs_sampler_policy": 1.0, "num_module_steps_trained": 6000, "num_trainable_parameters": 6003, "num_module_steps_trained_lifetime": 6000, "vf_loss_unclipped": 28.039243698120117, "vf_explained_var": -0.009175658226013184, "curr_entropy_coeff": 0.0090570820258, "curr_kl_coeff": 0.3732481598854065, "weights_seq_no": 1.0, "vf_loss": 0.10278083384037018, "num_module_steps_trained_lifetime_throughput": 457005.04708607635}}, "num_training_step_calls_per_iteration": 1, "num_env_steps_sampled_lifetime": 627500.0, "evaluation": {"env_runners": {"env_to_module_connector": {"timers": {"connectors": {"add_time_dim_to_batch_and_zero_pad": 2.3577517673207398e-06, "batch_individual_items": 6.265129750061125e-06, "numpy_to_tensor": 8.583558904154347e-06, "add_observations_from_episodes_to_batch": 2.9012474849375754e-06, "add_states_from_episodes_to_batch": 1.6565404366813462e-06}}, "connector_pipeline_timer": 4.4357955262366526e-05}, "module_episode_returns_mean": {"default_policy": 0.8}, "num_module_steps_sampled_lifetime": {"default_policy": 400}, "episode_return_mean": 0.8, "env_step_timer": 1.497954585616311e-05, "num_module_steps_sampled": {"default_policy": 400}, "episode_len_mean": 20.0, "module_to_env_connector": {"timers": {"connectors": {"normalize_and_clip_actions": 1.0705875400146303e-05, "listify_data_for_vector_env": 1.1112682035004931e-05, "get_actions": 3.9862327894873903e-05, "remove_single_ts_time_rank_from_batch": 5.937537504043394e-07, "tensor_to_numpy": 1.4724455977043648e-05, "un_batch_to_individual_items": 5.5336953873907655e-06}}, "connector_pipeline_timer": 0.00010818197412507112}, "num_env_steps_sampled": 400, "num_episodes_lifetime": 20, "sample": 0.09866908297408372, "episode_duration_sec_mean": 0.004514712549280375, "num_env_steps_sampled_lifetime": 5400, "agent_episode_returns_mean": {"default_agent": 0.8}, "env_reset_timer": 0.00014637503772974014, "rlmodule_inference_timer": 2.9965323750132133e-05, "num_agent_steps_sampled_lifetime": {"default_agent": 400}, "episode_len_min": 20, "weights_seq_no": 1.0, "env_to_module_sum_episodes_length_out": 10.216013141322508, "num_agent_steps_sampled": {"default_agent": 400}, "env_to_module_sum_episodes_length_in": 10.216013141322508, "episode_len_max": 20, "episode_return_min": -14.5, "num_episodes": 20, "episode_return_max": 14.5}, "num_healthy_workers": 1, "actor_manager_num_outstanding_async_reqs": 0, "num_remote_worker_restarts": 0}, "fault_tolerance": {"num_healthy_workers": 0, "num_remote_worker_restarts": 0}, "env_runner_group": {"actor_manager_num_outstanding_async_reqs": 0}, "done": false, "training_iteration": 1, "trial_id": "43aed_00000", "date": "2025-08-11_19-23-01", "timestamp": 1754932981, "time_this_iter_s": 1.6570119857788086, "time_total_s": 1.6570119857788086, "pid": 14402, "hostname": "Mac", "node_ip": "127.0.0.1", "config": {"exploration_config": {}, "extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "placement_strategy": "PACK", "num_gpus": 0, "_fake_gpus": false, "num_cpus_for_main_process": 2, "eager_tracing": true, "eager_max_retraces": 20, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "torch_compile_learner": false, "torch_compile_learner_what_to_compile": "forward_train", "torch_compile_learner_dynamo_backend": "aot_eager", "torch_compile_learner_dynamo_mode": null, "torch_compile_worker": false, "torch_compile_worker_dynamo_backend": "aot_eager", "torch_compile_worker_dynamo_mode": null, "torch_ddp_kwargs": {}, "torch_skip_nan_gradients": false, "env": "Umbrella", "env_config": {}, "observation_space": null, "action_space": null, "clip_rewards": null, "normalize_actions": true, "clip_actions": false, "_is_atari": null, "disable_env_checking": false, "render_env": false, "action_mask_key": "action_mask", "env_runner_cls": null, "num_env_runners": 0, "create_local_env_runner": true, "num_envs_per_env_runner": 1, "gym_env_vectorize_mode": "SYNC", "num_cpus_per_env_runner": 1, "num_gpus_per_env_runner": 0, "custom_resources_per_env_runner": {}, "validate_env_runners_after_construction": true, "episodes_to_numpy": true, "max_requests_in_flight_per_env_runner": 1, "sample_timeout_s": 60.0, "_env_to_module_connector": null, "add_default_connectors_to_env_to_module_pipeline": true, "_module_to_env_connector": null, "add_default_connectors_to_module_to_env_pipeline": true, "merge_env_runner_states": "training_only", "broadcast_env_runner_states": true, "episode_lookback_horizon": 1, "rollout_fragment_length": "auto", "batch_mode": "complete_episodes", "compress_observations": false, "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "enable_tf1_exec_eagerly": false, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "preprocessor_pref": "deepmind", "observation_filter": "NoFilter", "update_worker_filter_stats": true, "use_worker_filter_stats": true, "sampler_perf_stats_ema_coef": null, "_is_online": true, "num_learners": 0, "num_gpus_per_learner": 0, "num_cpus_per_learner": "auto", "num_aggregator_actors_per_learner": 0, "max_requests_in_flight_per_aggregator_actor": 3, "local_gpu_idx": 0, "max_requests_in_flight_per_learner": 3, "gamma": 1, "lr": 0.0002847858517, "grad_clip": 0.5, "grad_clip_by": "global_norm", "_train_batch_size_per_learner": 5000, "train_batch_size": 4000, "num_epochs": 1, "minibatch_size": 1000, "shuffle_batch_per_epoch": true, "model": {"fcnet_hiddens": [256, 256], "fcnet_activation": "tanh", "fcnet_weights_initializer": null, "fcnet_weights_initializer_config": null, "fcnet_bias_initializer": null, "fcnet_bias_initializer_config": null, "conv_filters": null, "conv_activation": "relu", "conv_kernel_initializer": null, "conv_kernel_initializer_config": null, "conv_bias_initializer": null, "conv_bias_initializer_config": null, "conv_transpose_kernel_initializer": null, "conv_transpose_kernel_initializer_config": null, "conv_transpose_bias_initializer": null, "conv_transpose_bias_initializer_config": null, "post_fcnet_hiddens": [], "post_fcnet_activation": "relu", "post_fcnet_weights_initializer": null, "post_fcnet_weights_initializer_config": null, "post_fcnet_bias_initializer": null, "post_fcnet_bias_initializer_config": null, "free_log_std": false, "log_std_clip_param": 20.0, "no_final_linear": false, "vf_share_layers": false, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "lstm_weights_initializer": null, "lstm_weights_initializer_config": null, "lstm_bias_initializer": null, "lstm_bias_initializer_config": null, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "attention_use_n_prev_actions": 0, "attention_use_n_prev_rewards": 0, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": null, "custom_model_config": {}, "custom_action_dist": null, "custom_preprocessor": null, "encoder_latent_dim": null, "always_check_shapes": false, "lstm_use_prev_action_reward": -1, "_use_default_native_models": -1, "_disable_preprocessor_api": false, "_disable_action_flattening": false}, "_learner_connector": null, "add_default_connectors_to_learner_pipeline": true, "learner_config_dict": {}, "optimizer": {}, "_learner_class": null, "callbacks_on_algorithm_init": null, "callbacks_on_env_runners_recreated": null, "callbacks_on_offline_eval_runners_recreated": null, "callbacks_on_checkpoint_loaded": null, "callbacks_on_environment_created": null, "callbacks_on_episode_created": null, "callbacks_on_episode_start": null, "callbacks_on_episode_step": null, "callbacks_on_episode_end": null, "callbacks_on_evaluate_start": null, "callbacks_on_evaluate_end": null, "callbacks_on_evaluate_offline_start": null, "callbacks_on_evaluate_offline_end": null, "callbacks_on_sample_end": null, "callbacks_on_train_result": null, "explore": true, "enable_rl_module_and_learner": true, "enable_env_runner_and_connector_v2": true, "_prior_exploration_config": {"type": "StochasticSampling"}, "count_steps_by": "env_steps", "policy_map_capacity": 100, "policy_mapping_fn": "<function AlgorithmConfig.DEFAULT_POLICY_MAPPING_FN at 0x3881edb20>", "policies_to_train": null, "policy_states_are_swappable": false, "observation_fn": null, "offline_data_class": null, "input_read_method": "read_parquet", "input_read_method_kwargs": {}, "input_read_schema": {}, "input_read_episodes": false, "input_read_sample_batches": false, "input_read_batch_size": null, "input_filesystem": null, "input_filesystem_kwargs": {}, "input_compress_columns": ["obs", "new_obs"], "input_spaces_jsonable": true, "materialize_data": false, "materialize_mapped_data": true, "map_batches_kwargs": {}, "iter_batches_kwargs": {}, "ignore_final_observation": false, "prelearner_class": null, "prelearner_buffer_class": null, "prelearner_buffer_kwargs": {}, "prelearner_module_synch_period": 10, "dataset_num_iters_per_learner": null, "input_config": {}, "actions_in_input_normalized": false, "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_config": {}, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "output_max_rows_per_file": null, "output_write_remaining_data": false, "output_write_method": "write_parquet", "output_write_method_kwargs": {}, "output_filesystem": null, "output_filesystem_kwargs": {}, "output_write_episodes": true, "offline_sampling": false, "evaluation_interval": 1, "evaluation_duration": 20, "evaluation_duration_unit": "episodes", "evaluation_sample_timeout_s": 120.0, "evaluation_auto_duration_min_env_steps_per_sample": 100, "evaluation_auto_duration_max_env_steps_per_sample": 2000, "evaluation_parallel_to_training": false, "evaluation_force_reset_envs_before_iteration": true, "evaluation_config": null, "off_policy_estimation_methods": {}, "ope_split_batch_by_episode": true, "evaluation_num_env_runners": 1, "in_evaluation": false, "sync_filters_on_rollout_workers_timeout_s": 10.0, "offline_evaluation_interval": null, "num_offline_eval_runners": 0, "offline_loss_for_module_fn": null, "offline_evaluation_duration": 1, "offline_evaluation_parallel_to_training": false, "offline_evaluation_timeout_s": 120.0, "num_cpus_per_offline_eval_runner": 1, "num_gpus_per_offline_eval_runner": 0, "custom_resources_per_offline_eval_runner": {}, "restart_failed_offline_eval_runners": true, "ignore_offline_eval_runner_failures": false, "max_num_offline_eval_runner_restarts": 1000, "offline_eval_runner_restore_timeout_s": 1800.0, "max_requests_in_flight_per_offline_eval_runner": 1, "validate_offline_eval_runners_after_construction": true, "offline_eval_runner_health_probe_timeout_s": 30.0, "offline_eval_rl_module_inference_only": false, "broadcast_offline_eval_runner_states": false, "offline_eval_batch_size_per_runner": 256, "dataset_num_iters_per_eval_runner": 1, "keep_per_episode_custom_metrics": false, "metrics_episode_collection_timeout_s": 60.0, "metrics_num_episodes_for_smoothing": 100, "min_time_s_per_iteration": null, "min_train_timesteps_per_iteration": 0, "min_sample_timesteps_per_iteration": 0, "log_gradients": true, "export_native_model_files": false, "checkpoint_trainable_policies_only": false, "logger_creator": null, "logger_config": null, "log_level": "WARN", "log_sys_usage": true, "fake_sampler": false, "seed": 2, "restart_failed_env_runners": true, "ignore_env_runner_failures": false, "max_num_env_runner_restarts": 1000, "delay_between_env_runner_restarts_s": 60.0, "restart_failed_sub_environments": false, "num_consecutive_env_runner_failures_tolerance": 100, "env_runner_health_probe_timeout_s": 30.0, "env_runner_restore_timeout_s": 1800.0, "_model_config": {}, "_rl_module_spec": "RLModuleSpec(module_class=None, observation_space=None, action_space=None, inference_only=False, learner_only=False, model_config=DefaultModelConfig(fcnet_hiddens=[60, 90], fcnet_activation='tanh', fcnet_kernel_initializer=None, fcnet_kernel_initializer_kwargs=None, fcnet_bias_initializer=None, fcnet_bias_initializer_kwargs=None, conv_filters=None, conv_activation='relu', conv_kernel_initializer=None, conv_kernel_initializer_kwargs=None, conv_bias_initializer=None, conv_bias_initializer_kwargs=None, head_fcnet_hiddens=[], head_fcnet_activation='relu', head_fcnet_kernel_initializer=None, head_fcnet_kernel_initializer_kwargs=None, head_fcnet_bias_initializer=None, head_fcnet_bias_initializer_kwargs=None, free_log_std=False, log_std_clip_param=20.0, vf_share_layers=True, use_lstm=False, max_seq_len=20, lstm_cell_size=256, lstm_use_prev_action=False, lstm_use_prev_reward=False, lstm_kernel_initializer=None, lstm_kernel_initializer_kwargs=None, lstm_bias_initializer=None, lstm_bias_initializer_kwargs=None), catalog_class=None, load_state_path=None, model_config_dict=None)", "algorithm_config_overrides_per_module": {}, "_per_module_overrides": {}, "_validate_config": true, "_use_msgpack_checkpoints": false, "_torch_grad_scaler_class": null, "_torch_lr_scheduler_classes": null, "_tf_policy_handles_more_than_one_loss": false, "_disable_preprocessor_api": false, "_disable_action_flattening": false, "_disable_initialize_loss_from_dummy_batch": false, "_dont_auto_sync_env_runner_states": false, "env_task_fn": -1, "enable_connectors": -1, "simple_optimizer": false, "policy_map_cache": -1, "worker_cls": -1, "synchronize_filters": -1, "enable_async_evaluation": -1, "custom_async_evaluation_function": -1, "_enable_rl_module_api": -1, "auto_wrap_old_gym_envs": -1, "always_attach_evaluation_results": -1, "replay_sequence_length": null, "_disable_execution_plan_api": -1, "use_critic": true, "use_gae": true, "use_kl_loss": true, "kl_coeff": 0.7464963036515, "kl_target": 0.0270990929592, "vf_loss_coeff": 0.6688075857018, "entropy_coeff": 0.0090570820258, "clip_param": 0.1221781641624, "vf_clip_param": 0.1027808522125, "entropy_coeff_schedule": null, "lr_schedule": null, "sgd_minibatch_size": -1, "vf_share_layers": -1, "__stdout_file__": null, "__stderr_file__": null, "lambda": 0.9099046732075, "input": "sampler", "policies": {"default_policy": [null, null, null, null]}, "callbacks": "<class 'ray.rllib.callbacks.callbacks.RLlibCallback'>", "create_env_on_driver": false, "custom_eval_function": null, "framework": "torch"}, "time_since_restore": 1.6570119857788086, "iterations_since_restore": 1, "perf": {"cpu_util_percent": 27.566666666666666, "ram_util_percent": 78.63333333333333}}
{"timers": {"training_iteration": 1.55069981579436, "restore_env_runners": 1.2108493829146027e-05, "training_step": 1.550565855948953, "env_runner_sampling_timer": 1.4428127266408408, "learner_update_timer": 0.10473793561570346, "synch_weights": 0.0005480656854342669, "restore_eval_env_runners": 7.916009053587914e-06, "evaluation_iteration": 0.10492924996651709, "synch_eval_env_connectors": 0.0002181249437853694, "synch_env_connectors": 4.292000085115433e-06}, "env_runners": {"num_module_steps_sampled_lifetime": {"default_policy": 10000.0}, "num_env_steps_sampled_lifetime": 10000.0, "episode_len_mean": 20.0, "env_to_module_connector": {"timers": {"connectors": {"add_time_dim_to_batch_and_zero_pad": 2.4291834289200883e-06, "add_observations_from_episodes_to_batch": 2.9653369125642373e-06, "add_states_from_episodes_to_batch": 1.7175987674064631e-06, "numpy_to_tensor": 8.516828305430541e-06, "batch_individual_items": 6.2624470700902855e-06}}, "connector_pipeline_timer": 4.359568183040709e-05}, "weights_seq_no": 1.0, "episode_len_min": 20, "num_agent_steps_sampled_lifetime": {"default_agent": 10000.0}, "module_to_env_connector": {"connector_pipeline_timer": 0.00010448634723446891, "timers": {"connectors": {"tensor_to_numpy": 1.3148227383552434e-05, "listify_data_for_vector_env": 1.084058405217137e-05, "get_actions": 3.951392498830833e-05, "un_batch_to_individual_items": 5.342991986098996e-06, "normalize_and_clip_actions": 9.376751085192875e-06, "remove_single_ts_time_rank_from_batch": 6.044892769831379e-07}}}, "env_reset_timer": 4.069489663874573e-05, "env_to_module_sum_episodes_length_out": 10.36823839457432, "env_to_module_sum_episodes_length_in": 10.36823839457432, "num_module_steps_sampled": {"default_policy": 5000.0}, "episode_return_mean": 1.2200000000000002, "episode_len_max": 20, "num_env_steps_sampled": 5000.0, "num_episodes_lifetime": 500.0, "agent_episode_returns_mean": {"default_agent": 1.2200000000000002}, "episode_return_min": -11.5, "sample": 0.00521536347596809, "num_episodes": 250.0, "num_agent_steps_sampled": {"default_agent": 5000.0}, "rlmodule_inference_timer": 2.799394262849139e-05, "module_episode_returns_mean": {"default_policy": 1.2200000000000002}, "episode_return_max": 8.5, "env_step_timer": 1.3855879882204213e-05, "time_between_sampling": 0.0014942890489013122, "episode_duration_sec_mean": 0.004552457281854003, "num_env_steps_sampled_lifetime_throughput": 3692.421356873252}, "learners": {"__all_modules__": {"learner_connector": {"timers": {"connectors": {"numpy_to_tensor": 5.806931643746793e-05, "add_observations_from_episodes_to_batch": 0.0008141586580313741, "add_one_ts_to_episodes_and_truncate": 0.007571876884903759, "add_states_from_episodes_to_batch": 2.836422063410282e-06, "add_columns_from_episodes_to_train_batch": 0.034493169704219326, "add_time_dim_to_batch_and_zero_pad": 1.0056155733764172e-05, "general_advantage_estimation": 0.0063920401269569995, "batch_individual_items": 0.03085577135323547}}, "connector_pipeline_timer": 0.08031254361034372}, "num_module_steps_trained": 6000, "num_trainable_parameters": 6003, "num_module_steps_trained_lifetime": 12000, "learner_connector_sum_episodes_length_out": 5250.0, "num_env_steps_trained_lifetime": 63000, "num_env_steps_trained": 31500, "learner_connector_sum_episodes_length_in": 5000.0, "num_non_trainable_parameters": 0, "num_env_steps_trained_lifetime_throughput": 2376395.96518871, "num_module_steps_trained_throughput": 455319.11186702794, "num_module_steps_trained_lifetime_throughput": 454407.22674762306}, "default_policy": {"module_train_batch_size_mean": 1000.0, "entropy": 0.6536862254142761, "mean_kl_loss": 0.0004314855032134801, "policy_loss": -0.003029095707461238, "default_optimizer_learning_rate": 0.0002847858517, "total_loss": 0.05995207279920578, "gradients_default_optimizer_global_norm": 0.04126502946019173, "diff_num_grad_updates_vs_sampler_policy": 1.0, "num_module_steps_trained": 6000, "num_trainable_parameters": 6003, "num_module_steps_trained_lifetime": 12000, "vf_loss_unclipped": 28.439332962036133, "vf_explained_var": -0.012158751487731934, "curr_entropy_coeff": 0.0090570820258, "curr_kl_coeff": 0.18662407994270325, "weights_seq_no": 2.0, "vf_loss": 0.10278083384037018, "num_module_steps_trained_lifetime_throughput": 456534.339837875}}, "num_training_step_calls_per_iteration": 1, "evaluation": {"env_runners": {"env_to_module_connector": {"timers": {"connectors": {"add_time_dim_to_batch_and_zero_pad": 2.250574201310226e-06, "batch_individual_items": 6.128988050457049e-06, "numpy_to_tensor": 8.322128452372775e-06, "add_observations_from_episodes_to_batch": 2.804733656597366e-06, "add_states_from_episodes_to_batch": 1.6295003635424653e-06}}, "connector_pipeline_timer": 4.244888697422784e-05}, "module_episode_returns_mean": {"default_policy": -0.2}, "num_module_steps_sampled_lifetime": {"default_policy": 800}, "episode_return_mean": -0.2, "env_step_timer": 1.376258853157443e-05, "num_module_steps_sampled": {"default_policy": 400}, "episode_len_mean": 20.0, "module_to_env_connector": {"timers": {"connectors": {"normalize_and_clip_actions": 9.394337541927831e-06, "listify_data_for_vector_env": 1.0731789097219099e-05, "get_actions": 3.581633890188939e-05, "remove_single_ts_time_rank_from_batch": 5.671825223513044e-07, "tensor_to_numpy": 1.2884743593260304e-05, "un_batch_to_individual_items": 5.365784506627157e-06}}, "connector_pipeline_timer": 9.983022316281093e-05}, "num_env_steps_sampled": 400, "num_episodes_lifetime": 40, "sample": 0.09866430381429381, "episode_duration_sec_mean": 0.004503737494815141, "num_env_steps_sampled_lifetime": 10400, "agent_episode_returns_mean": {"default_agent": -0.2}, "env_reset_timer": 0.00014570628758519888, "rlmodule_inference_timer": 2.747106085638894e-05, "num_agent_steps_sampled_lifetime": {"default_agent": 800}, "episode_len_min": 20, "weights_seq_no": 2.0, "env_to_module_sum_episodes_length_out": 10.366003441359926, "num_agent_steps_sampled": {"default_agent": 400}, "env_to_module_sum_episodes_length_in": 10.366003441359926, "episode_len_max": 20, "episode_return_min": -14.5, "num_episodes": 20, "episode_return_max": 14.5, "time_between_sampling": 1.6066624590894207}, "num_healthy_workers": 1, "actor_manager_num_outstanding_async_reqs": 0, "num_remote_worker_restarts": 0}, "num_env_steps_sampled_lifetime": 10000.0, "fault_tolerance": {"num_healthy_workers": 0, "num_remote_worker_restarts": 0}, "env_runner_group": {"actor_manager_num_outstanding_async_reqs": 0}, "done": false, "training_iteration": 2, "trial_id": "43aed_00000", "date": "2025-08-11_19-23-02", "timestamp": 1754932982, "time_this_iter_s": 1.678952932357788, "time_total_s": 3.3359649181365967, "pid": 14402, "hostname": "Mac", "node_ip": "127.0.0.1", "config": {"exploration_config": {}, "extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "placement_strategy": "PACK", "num_gpus": 0, "_fake_gpus": false, "num_cpus_for_main_process": 2, "eager_tracing": true, "eager_max_retraces": 20, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "torch_compile_learner": false, "torch_compile_learner_what_to_compile": "forward_train", "torch_compile_learner_dynamo_backend": "aot_eager", "torch_compile_learner_dynamo_mode": null, "torch_compile_worker": false, "torch_compile_worker_dynamo_backend": "aot_eager", "torch_compile_worker_dynamo_mode": null, "torch_ddp_kwargs": {}, "torch_skip_nan_gradients": false, "env": "Umbrella", "env_config": {}, "observation_space": null, "action_space": null, "clip_rewards": null, "normalize_actions": true, "clip_actions": false, "_is_atari": null, "disable_env_checking": false, "render_env": false, "action_mask_key": "action_mask", "env_runner_cls": null, "num_env_runners": 0, "create_local_env_runner": true, "num_envs_per_env_runner": 1, "gym_env_vectorize_mode": "SYNC", "num_cpus_per_env_runner": 1, "num_gpus_per_env_runner": 0, "custom_resources_per_env_runner": {}, "validate_env_runners_after_construction": true, "episodes_to_numpy": true, "max_requests_in_flight_per_env_runner": 1, "sample_timeout_s": 60.0, "_env_to_module_connector": null, "add_default_connectors_to_env_to_module_pipeline": true, "_module_to_env_connector": null, "add_default_connectors_to_module_to_env_pipeline": true, "merge_env_runner_states": "training_only", "broadcast_env_runner_states": true, "episode_lookback_horizon": 1, "rollout_fragment_length": "auto", "batch_mode": "complete_episodes", "compress_observations": false, "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "enable_tf1_exec_eagerly": false, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "preprocessor_pref": "deepmind", "observation_filter": "NoFilter", "update_worker_filter_stats": true, "use_worker_filter_stats": true, "sampler_perf_stats_ema_coef": null, "_is_online": true, "num_learners": 0, "num_gpus_per_learner": 0, "num_cpus_per_learner": "auto", "num_aggregator_actors_per_learner": 0, "max_requests_in_flight_per_aggregator_actor": 3, "local_gpu_idx": 0, "max_requests_in_flight_per_learner": 3, "gamma": 1, "lr": 0.0002847858517, "grad_clip": 0.5, "grad_clip_by": "global_norm", "_train_batch_size_per_learner": 5000, "train_batch_size": 4000, "num_epochs": 1, "minibatch_size": 1000, "shuffle_batch_per_epoch": true, "model": {"fcnet_hiddens": [256, 256], "fcnet_activation": "tanh", "fcnet_weights_initializer": null, "fcnet_weights_initializer_config": null, "fcnet_bias_initializer": null, "fcnet_bias_initializer_config": null, "conv_filters": null, "conv_activation": "relu", "conv_kernel_initializer": null, "conv_kernel_initializer_config": null, "conv_bias_initializer": null, "conv_bias_initializer_config": null, "conv_transpose_kernel_initializer": null, "conv_transpose_kernel_initializer_config": null, "conv_transpose_bias_initializer": null, "conv_transpose_bias_initializer_config": null, "post_fcnet_hiddens": [], "post_fcnet_activation": "relu", "post_fcnet_weights_initializer": null, "post_fcnet_weights_initializer_config": null, "post_fcnet_bias_initializer": null, "post_fcnet_bias_initializer_config": null, "free_log_std": false, "log_std_clip_param": 20.0, "no_final_linear": false, "vf_share_layers": false, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "lstm_weights_initializer": null, "lstm_weights_initializer_config": null, "lstm_bias_initializer": null, "lstm_bias_initializer_config": null, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "attention_use_n_prev_actions": 0, "attention_use_n_prev_rewards": 0, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": null, "custom_model_config": {}, "custom_action_dist": null, "custom_preprocessor": null, "encoder_latent_dim": null, "always_check_shapes": false, "lstm_use_prev_action_reward": -1, "_use_default_native_models": -1, "_disable_preprocessor_api": false, "_disable_action_flattening": false}, "_learner_connector": null, "add_default_connectors_to_learner_pipeline": true, "learner_config_dict": {}, "optimizer": {}, "_learner_class": null, "callbacks_on_algorithm_init": null, "callbacks_on_env_runners_recreated": null, "callbacks_on_offline_eval_runners_recreated": null, "callbacks_on_checkpoint_loaded": null, "callbacks_on_environment_created": null, "callbacks_on_episode_created": null, "callbacks_on_episode_start": null, "callbacks_on_episode_step": null, "callbacks_on_episode_end": null, "callbacks_on_evaluate_start": null, "callbacks_on_evaluate_end": null, "callbacks_on_evaluate_offline_start": null, "callbacks_on_evaluate_offline_end": null, "callbacks_on_sample_end": null, "callbacks_on_train_result": null, "explore": true, "enable_rl_module_and_learner": true, "enable_env_runner_and_connector_v2": true, "_prior_exploration_config": {"type": "StochasticSampling"}, "count_steps_by": "env_steps", "policy_map_capacity": 100, "policy_mapping_fn": "<function AlgorithmConfig.DEFAULT_POLICY_MAPPING_FN at 0x3881edb20>", "policies_to_train": null, "policy_states_are_swappable": false, "observation_fn": null, "offline_data_class": null, "input_read_method": "read_parquet", "input_read_method_kwargs": {}, "input_read_schema": {}, "input_read_episodes": false, "input_read_sample_batches": false, "input_read_batch_size": null, "input_filesystem": null, "input_filesystem_kwargs": {}, "input_compress_columns": ["obs", "new_obs"], "input_spaces_jsonable": true, "materialize_data": false, "materialize_mapped_data": true, "map_batches_kwargs": {}, "iter_batches_kwargs": {}, "ignore_final_observation": false, "prelearner_class": null, "prelearner_buffer_class": null, "prelearner_buffer_kwargs": {}, "prelearner_module_synch_period": 10, "dataset_num_iters_per_learner": null, "input_config": {}, "actions_in_input_normalized": false, "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_config": {}, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "output_max_rows_per_file": null, "output_write_remaining_data": false, "output_write_method": "write_parquet", "output_write_method_kwargs": {}, "output_filesystem": null, "output_filesystem_kwargs": {}, "output_write_episodes": true, "offline_sampling": false, "evaluation_interval": 1, "evaluation_duration": 20, "evaluation_duration_unit": "episodes", "evaluation_sample_timeout_s": 120.0, "evaluation_auto_duration_min_env_steps_per_sample": 100, "evaluation_auto_duration_max_env_steps_per_sample": 2000, "evaluation_parallel_to_training": false, "evaluation_force_reset_envs_before_iteration": true, "evaluation_config": null, "off_policy_estimation_methods": {}, "ope_split_batch_by_episode": true, "evaluation_num_env_runners": 1, "in_evaluation": false, "sync_filters_on_rollout_workers_timeout_s": 10.0, "offline_evaluation_interval": null, "num_offline_eval_runners": 0, "offline_loss_for_module_fn": null, "offline_evaluation_duration": 1, "offline_evaluation_parallel_to_training": false, "offline_evaluation_timeout_s": 120.0, "num_cpus_per_offline_eval_runner": 1, "num_gpus_per_offline_eval_runner": 0, "custom_resources_per_offline_eval_runner": {}, "restart_failed_offline_eval_runners": true, "ignore_offline_eval_runner_failures": false, "max_num_offline_eval_runner_restarts": 1000, "offline_eval_runner_restore_timeout_s": 1800.0, "max_requests_in_flight_per_offline_eval_runner": 1, "validate_offline_eval_runners_after_construction": true, "offline_eval_runner_health_probe_timeout_s": 30.0, "offline_eval_rl_module_inference_only": false, "broadcast_offline_eval_runner_states": false, "offline_eval_batch_size_per_runner": 256, "dataset_num_iters_per_eval_runner": 1, "keep_per_episode_custom_metrics": false, "metrics_episode_collection_timeout_s": 60.0, "metrics_num_episodes_for_smoothing": 100, "min_time_s_per_iteration": null, "min_train_timesteps_per_iteration": 0, "min_sample_timesteps_per_iteration": 0, "log_gradients": true, "export_native_model_files": false, "checkpoint_trainable_policies_only": false, "logger_creator": null, "logger_config": null, "log_level": "WARN", "log_sys_usage": true, "fake_sampler": false, "seed": 2, "restart_failed_env_runners": true, "ignore_env_runner_failures": false, "max_num_env_runner_restarts": 1000, "delay_between_env_runner_restarts_s": 60.0, "restart_failed_sub_environments": false, "num_consecutive_env_runner_failures_tolerance": 100, "env_runner_health_probe_timeout_s": 30.0, "env_runner_restore_timeout_s": 1800.0, "_model_config": {}, "_rl_module_spec": "RLModuleSpec(module_class=None, observation_space=None, action_space=None, inference_only=False, learner_only=False, model_config=DefaultModelConfig(fcnet_hiddens=[60, 90], fcnet_activation='tanh', fcnet_kernel_initializer=None, fcnet_kernel_initializer_kwargs=None, fcnet_bias_initializer=None, fcnet_bias_initializer_kwargs=None, conv_filters=None, conv_activation='relu', conv_kernel_initializer=None, conv_kernel_initializer_kwargs=None, conv_bias_initializer=None, conv_bias_initializer_kwargs=None, head_fcnet_hiddens=[], head_fcnet_activation='relu', head_fcnet_kernel_initializer=None, head_fcnet_kernel_initializer_kwargs=None, head_fcnet_bias_initializer=None, head_fcnet_bias_initializer_kwargs=None, free_log_std=False, log_std_clip_param=20.0, vf_share_layers=True, use_lstm=False, max_seq_len=20, lstm_cell_size=256, lstm_use_prev_action=False, lstm_use_prev_reward=False, lstm_kernel_initializer=None, lstm_kernel_initializer_kwargs=None, lstm_bias_initializer=None, lstm_bias_initializer_kwargs=None), catalog_class=None, load_state_path=None, model_config_dict=None)", "algorithm_config_overrides_per_module": {}, "_per_module_overrides": {}, "_validate_config": true, "_use_msgpack_checkpoints": false, "_torch_grad_scaler_class": null, "_torch_lr_scheduler_classes": null, "_tf_policy_handles_more_than_one_loss": false, "_disable_preprocessor_api": false, "_disable_action_flattening": false, "_disable_initialize_loss_from_dummy_batch": false, "_dont_auto_sync_env_runner_states": false, "env_task_fn": -1, "enable_connectors": -1, "simple_optimizer": false, "policy_map_cache": -1, "worker_cls": -1, "synchronize_filters": -1, "enable_async_evaluation": -1, "custom_async_evaluation_function": -1, "_enable_rl_module_api": -1, "auto_wrap_old_gym_envs": -1, "always_attach_evaluation_results": -1, "replay_sequence_length": null, "_disable_execution_plan_api": -1, "use_critic": true, "use_gae": true, "use_kl_loss": true, "kl_coeff": 0.7464963036515, "kl_target": 0.0270990929592, "vf_loss_coeff": 0.6688075857018, "entropy_coeff": 0.0090570820258, "clip_param": 0.1221781641624, "vf_clip_param": 0.1027808522125, "entropy_coeff_schedule": null, "lr_schedule": null, "sgd_minibatch_size": -1, "vf_share_layers": -1, "__stdout_file__": null, "__stderr_file__": null, "lambda": 0.9099046732075, "input": "sampler", "policies": {"default_policy": [null, null, null, null]}, "callbacks": "<class 'ray.rllib.callbacks.callbacks.RLlibCallback'>", "create_env_on_driver": false, "custom_eval_function": null, "framework": "torch"}, "time_since_restore": 3.3359649181365967, "iterations_since_restore": 2, "perf": {"cpu_util_percent": 44.05, "ram_util_percent": 78.4}}
{"timers": {"training_iteration": 1.5498283601360163, "restore_env_runners": 1.2051159085240216e-05, "training_step": 1.5496940182193766, "env_runner_sampling_timer": 1.4420571631247292, "learner_update_timer": 0.10462054584962316, "synch_weights": 0.0005484879384865053, "restore_eval_env_runners": 7.924758829176426e-06, "evaluation_iteration": 0.10491524704615585, "synch_eval_env_connectors": 0.00021719910437241195, "synch_env_connectors": 4.292409867048263e-06}, "env_runners": {"num_module_steps_sampled_lifetime": {"default_policy": -607500.0}, "num_env_steps_sampled_lifetime": -607500.0, "episode_len_mean": 20.0, "env_to_module_connector": {"timers": {"connectors": {"add_time_dim_to_batch_and_zero_pad": 2.3857828349130955e-06, "add_observations_from_episodes_to_batch": 2.987286229527477e-06, "add_states_from_episodes_to_batch": 1.6969072529961699e-06, "numpy_to_tensor": 8.423016329323572e-06, "batch_individual_items": 6.179811850737944e-06}}, "connector_pipeline_timer": 4.330678444934001e-05}, "weights_seq_no": 2.0, "episode_len_min": 20, "num_agent_steps_sampled_lifetime": {"default_agent": -607500.0}, "module_to_env_connector": {"connector_pipeline_timer": 0.00010306223340184242, "timers": {"connectors": {"tensor_to_numpy": 1.2966463678174226e-05, "listify_data_for_vector_env": 1.0809083648804305e-05, "get_actions": 3.853061461668663e-05, "un_batch_to_individual_items": 5.355027229188825e-06, "normalize_and_clip_actions": 9.32981973316644e-06, "remove_single_ts_time_rank_from_batch": 6.015263990545217e-07}}}, "env_reset_timer": 3.3391154811874596e-05, "env_to_module_sum_episodes_length_out": 10.36823839457432, "env_to_module_sum_episodes_length_in": 10.36823839457432, "num_module_steps_sampled": {"default_policy": 5000.0}, "episode_return_mean": 1.0600000000000005, "episode_len_max": 20, "num_env_steps_sampled": 5000.0, "num_episodes_lifetime": -30375.0, "agent_episode_returns_mean": {"default_agent": 1.0600000000000005}, "episode_return_min": -11.5, "sample": 0.0048544211154351365, "num_episodes": 250.0, "num_agent_steps_sampled": {"default_agent": 5000.0}, "rlmodule_inference_timer": 2.7336453231364356e-05, "module_episode_returns_mean": {"default_policy": 1.0600000000000005}, "episode_return_max": 8.5, "env_step_timer": 1.3645713139456774e-05, "time_between_sampling": 0.0018165634018464207, "episode_duration_sec_mean": 0.004511488322634249, "num_env_steps_sampled_lifetime_throughput": 3757.3936448503787}, "learners": {"__all_modules__": {"learner_connector": {"timers": {"connectors": {"numpy_to_tensor": 5.798528363229707e-05, "add_observations_from_episodes_to_batch": 0.0008141579006100073, "add_one_ts_to_episodes_and_truncate": 0.007571280615893192, "add_states_from_episodes_to_batch": 2.8359777294099335e-06, "add_columns_from_episodes_to_train_batch": 0.034497075926477556, "add_time_dim_to_batch_and_zero_pad": 1.0056844074279069e-05, "general_advantage_estimation": 0.006379330975934863, "batch_individual_items": 0.030845505309163128}}, "connector_pipeline_timer": 0.08029245901441902}, "num_module_steps_trained": 6000, "num_trainable_parameters": 6003, "num_module_steps_trained_lifetime": 18000, "learner_connector_sum_episodes_length_out": 5250.0, "num_env_steps_trained_lifetime": 94500, "num_env_steps_trained": 31500, "learner_connector_sum_episodes_length_in": 5000.0, "num_non_trainable_parameters": 0, "num_env_steps_trained_lifetime_throughput": 2370433.7558796722, "num_module_steps_trained_throughput": 454129.95650385297, "num_module_steps_trained_lifetime_throughput": 453234.0247900998}, "default_policy": {"module_train_batch_size_mean": 1000.0, "entropy": 0.6424447298049927, "mean_kl_loss": 0.0006657454650849104, "policy_loss": 0.04044210910797119, "default_optimizer_learning_rate": 0.0002847858517, "total_loss": 0.10348828136920929, "gradients_default_optimizer_global_norm": 0.039692364633083344, "diff_num_grad_updates_vs_sampler_policy": 1.0, "num_module_steps_trained": 6000, "num_trainable_parameters": 6003, "num_module_steps_trained_lifetime": 18000, "vf_loss_unclipped": 28.58755874633789, "vf_explained_var": -0.012941598892211914, "curr_entropy_coeff": 0.0090570820258, "curr_kl_coeff": 0.09331203997135162, "weights_seq_no": 3.0, "vf_loss": 0.10278083384037018, "num_module_steps_trained_lifetime_throughput": 455303.44046589907}}, "num_training_step_calls_per_iteration": 1, "evaluation": {"env_runners": {"env_to_module_connector": {"timers": {"connectors": {"add_time_dim_to_batch_and_zero_pad": 2.2396206121690215e-06, "batch_individual_items": 6.075697294543213e-06, "numpy_to_tensor": 8.11469505265381e-06, "add_observations_from_episodes_to_batch": 2.7702102587657605e-06, "add_states_from_episodes_to_batch": 1.6371852179960508e-06}}, "connector_pipeline_timer": 4.205528167072218e-05}, "module_episode_returns_mean": {"default_policy": -1.2}, "num_module_steps_sampled_lifetime": {"default_policy": 1200}, "episode_return_mean": -1.2, "env_step_timer": 1.3677671095269721e-05, "num_module_steps_sampled": {"default_policy": 400}, "episode_len_mean": 20.0, "module_to_env_connector": {"timers": {"connectors": {"normalize_and_clip_actions": 9.212979784569567e-06, "listify_data_for_vector_env": 1.0681792150200307e-05, "get_actions": 3.425891535097584e-05, "remove_single_ts_time_rank_from_batch": 5.682119796168518e-07, "tensor_to_numpy": 1.2721040550824926e-05, "un_batch_to_individual_items": 5.3686958904865925e-06}}, "connector_pipeline_timer": 9.787912141278024e-05}, "num_env_steps_sampled": 400, "num_episodes_lifetime": 60, "sample": 0.0986437111961073, "episode_duration_sec_mean": 0.004477826399185384, "num_env_steps_sampled_lifetime": 15400, "agent_episode_returns_mean": {"default_agent": -1.2}, "env_reset_timer": 0.00014499381477944552, "rlmodule_inference_timer": 2.7112867738310037e-05, "num_agent_steps_sampled_lifetime": {"default_agent": 1200}, "episode_len_min": 20, "weights_seq_no": 3.0, "env_to_module_sum_episodes_length_out": 10.368205581254823, "num_agent_steps_sampled": {"default_agent": 400}, "env_to_module_sum_episodes_length_in": 10.368205581254823, "episode_len_max": 20, "episode_return_min": -14.5, "num_episodes": 20, "episode_return_max": 14.5, "time_between_sampling": 1.605402276578825}, "num_healthy_workers": 1, "actor_manager_num_outstanding_async_reqs": 0, "num_remote_worker_restarts": 0}, "num_env_steps_sampled_lifetime": -607500.0, "fault_tolerance": {"num_healthy_workers": 0, "num_remote_worker_restarts": 0}, "env_runner_group": {"actor_manager_num_outstanding_async_reqs": 0}, "done": false, "training_iteration": 3, "trial_id": "43aed_00000", "date": "2025-08-11_19-23-04", "timestamp": 1754932984, "time_this_iter_s": 1.5667479038238525, "time_total_s": 4.902712821960449, "pid": 14402, "hostname": "Mac", "node_ip": "127.0.0.1", "config": {"exploration_config": {}, "extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "placement_strategy": "PACK", "num_gpus": 0, "_fake_gpus": false, "num_cpus_for_main_process": 2, "eager_tracing": true, "eager_max_retraces": 20, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "torch_compile_learner": false, "torch_compile_learner_what_to_compile": "forward_train", "torch_compile_learner_dynamo_backend": "aot_eager", "torch_compile_learner_dynamo_mode": null, "torch_compile_worker": false, "torch_compile_worker_dynamo_backend": "aot_eager", "torch_compile_worker_dynamo_mode": null, "torch_ddp_kwargs": {}, "torch_skip_nan_gradients": false, "env": "Umbrella", "env_config": {}, "observation_space": null, "action_space": null, "clip_rewards": null, "normalize_actions": true, "clip_actions": false, "_is_atari": null, "disable_env_checking": false, "render_env": false, "action_mask_key": "action_mask", "env_runner_cls": null, "num_env_runners": 0, "create_local_env_runner": true, "num_envs_per_env_runner": 1, "gym_env_vectorize_mode": "SYNC", "num_cpus_per_env_runner": 1, "num_gpus_per_env_runner": 0, "custom_resources_per_env_runner": {}, "validate_env_runners_after_construction": true, "episodes_to_numpy": true, "max_requests_in_flight_per_env_runner": 1, "sample_timeout_s": 60.0, "_env_to_module_connector": null, "add_default_connectors_to_env_to_module_pipeline": true, "_module_to_env_connector": null, "add_default_connectors_to_module_to_env_pipeline": true, "merge_env_runner_states": "training_only", "broadcast_env_runner_states": true, "episode_lookback_horizon": 1, "rollout_fragment_length": "auto", "batch_mode": "complete_episodes", "compress_observations": false, "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "enable_tf1_exec_eagerly": false, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "preprocessor_pref": "deepmind", "observation_filter": "NoFilter", "update_worker_filter_stats": true, "use_worker_filter_stats": true, "sampler_perf_stats_ema_coef": null, "_is_online": true, "num_learners": 0, "num_gpus_per_learner": 0, "num_cpus_per_learner": "auto", "num_aggregator_actors_per_learner": 0, "max_requests_in_flight_per_aggregator_actor": 3, "local_gpu_idx": 0, "max_requests_in_flight_per_learner": 3, "gamma": 1, "lr": 0.0002847858517, "grad_clip": 0.5, "grad_clip_by": "global_norm", "_train_batch_size_per_learner": 5000, "train_batch_size": 4000, "num_epochs": 1, "minibatch_size": 1000, "shuffle_batch_per_epoch": true, "model": {"fcnet_hiddens": [256, 256], "fcnet_activation": "tanh", "fcnet_weights_initializer": null, "fcnet_weights_initializer_config": null, "fcnet_bias_initializer": null, "fcnet_bias_initializer_config": null, "conv_filters": null, "conv_activation": "relu", "conv_kernel_initializer": null, "conv_kernel_initializer_config": null, "conv_bias_initializer": null, "conv_bias_initializer_config": null, "conv_transpose_kernel_initializer": null, "conv_transpose_kernel_initializer_config": null, "conv_transpose_bias_initializer": null, "conv_transpose_bias_initializer_config": null, "post_fcnet_hiddens": [], "post_fcnet_activation": "relu", "post_fcnet_weights_initializer": null, "post_fcnet_weights_initializer_config": null, "post_fcnet_bias_initializer": null, "post_fcnet_bias_initializer_config": null, "free_log_std": false, "log_std_clip_param": 20.0, "no_final_linear": false, "vf_share_layers": false, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "lstm_weights_initializer": null, "lstm_weights_initializer_config": null, "lstm_bias_initializer": null, "lstm_bias_initializer_config": null, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "attention_use_n_prev_actions": 0, "attention_use_n_prev_rewards": 0, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": null, "custom_model_config": {}, "custom_action_dist": null, "custom_preprocessor": null, "encoder_latent_dim": null, "always_check_shapes": false, "lstm_use_prev_action_reward": -1, "_use_default_native_models": -1, "_disable_preprocessor_api": false, "_disable_action_flattening": false}, "_learner_connector": null, "add_default_connectors_to_learner_pipeline": true, "learner_config_dict": {}, "optimizer": {}, "_learner_class": null, "callbacks_on_algorithm_init": null, "callbacks_on_env_runners_recreated": null, "callbacks_on_offline_eval_runners_recreated": null, "callbacks_on_checkpoint_loaded": null, "callbacks_on_environment_created": null, "callbacks_on_episode_created": null, "callbacks_on_episode_start": null, "callbacks_on_episode_step": null, "callbacks_on_episode_end": null, "callbacks_on_evaluate_start": null, "callbacks_on_evaluate_end": null, "callbacks_on_evaluate_offline_start": null, "callbacks_on_evaluate_offline_end": null, "callbacks_on_sample_end": null, "callbacks_on_train_result": null, "explore": true, "enable_rl_module_and_learner": true, "enable_env_runner_and_connector_v2": true, "_prior_exploration_config": {"type": "StochasticSampling"}, "count_steps_by": "env_steps", "policy_map_capacity": 100, "policy_mapping_fn": "<function AlgorithmConfig.DEFAULT_POLICY_MAPPING_FN at 0x3881edb20>", "policies_to_train": null, "policy_states_are_swappable": false, "observation_fn": null, "offline_data_class": null, "input_read_method": "read_parquet", "input_read_method_kwargs": {}, "input_read_schema": {}, "input_read_episodes": false, "input_read_sample_batches": false, "input_read_batch_size": null, "input_filesystem": null, "input_filesystem_kwargs": {}, "input_compress_columns": ["obs", "new_obs"], "input_spaces_jsonable": true, "materialize_data": false, "materialize_mapped_data": true, "map_batches_kwargs": {}, "iter_batches_kwargs": {}, "ignore_final_observation": false, "prelearner_class": null, "prelearner_buffer_class": null, "prelearner_buffer_kwargs": {}, "prelearner_module_synch_period": 10, "dataset_num_iters_per_learner": null, "input_config": {}, "actions_in_input_normalized": false, "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_config": {}, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "output_max_rows_per_file": null, "output_write_remaining_data": false, "output_write_method": "write_parquet", "output_write_method_kwargs": {}, "output_filesystem": null, "output_filesystem_kwargs": {}, "output_write_episodes": true, "offline_sampling": false, "evaluation_interval": 1, "evaluation_duration": 20, "evaluation_duration_unit": "episodes", "evaluation_sample_timeout_s": 120.0, "evaluation_auto_duration_min_env_steps_per_sample": 100, "evaluation_auto_duration_max_env_steps_per_sample": 2000, "evaluation_parallel_to_training": false, "evaluation_force_reset_envs_before_iteration": true, "evaluation_config": null, "off_policy_estimation_methods": {}, "ope_split_batch_by_episode": true, "evaluation_num_env_runners": 1, "in_evaluation": false, "sync_filters_on_rollout_workers_timeout_s": 10.0, "offline_evaluation_interval": null, "num_offline_eval_runners": 0, "offline_loss_for_module_fn": null, "offline_evaluation_duration": 1, "offline_evaluation_parallel_to_training": false, "offline_evaluation_timeout_s": 120.0, "num_cpus_per_offline_eval_runner": 1, "num_gpus_per_offline_eval_runner": 0, "custom_resources_per_offline_eval_runner": {}, "restart_failed_offline_eval_runners": true, "ignore_offline_eval_runner_failures": false, "max_num_offline_eval_runner_restarts": 1000, "offline_eval_runner_restore_timeout_s": 1800.0, "max_requests_in_flight_per_offline_eval_runner": 1, "validate_offline_eval_runners_after_construction": true, "offline_eval_runner_health_probe_timeout_s": 30.0, "offline_eval_rl_module_inference_only": false, "broadcast_offline_eval_runner_states": false, "offline_eval_batch_size_per_runner": 256, "dataset_num_iters_per_eval_runner": 1, "keep_per_episode_custom_metrics": false, "metrics_episode_collection_timeout_s": 60.0, "metrics_num_episodes_for_smoothing": 100, "min_time_s_per_iteration": null, "min_train_timesteps_per_iteration": 0, "min_sample_timesteps_per_iteration": 0, "log_gradients": true, "export_native_model_files": false, "checkpoint_trainable_policies_only": false, "logger_creator": null, "logger_config": null, "log_level": "WARN", "log_sys_usage": true, "fake_sampler": false, "seed": 2, "restart_failed_env_runners": true, "ignore_env_runner_failures": false, "max_num_env_runner_restarts": 1000, "delay_between_env_runner_restarts_s": 60.0, "restart_failed_sub_environments": false, "num_consecutive_env_runner_failures_tolerance": 100, "env_runner_health_probe_timeout_s": 30.0, "env_runner_restore_timeout_s": 1800.0, "_model_config": {}, "_rl_module_spec": "RLModuleSpec(module_class=None, observation_space=None, action_space=None, inference_only=False, learner_only=False, model_config=DefaultModelConfig(fcnet_hiddens=[60, 90], fcnet_activation='tanh', fcnet_kernel_initializer=None, fcnet_kernel_initializer_kwargs=None, fcnet_bias_initializer=None, fcnet_bias_initializer_kwargs=None, conv_filters=None, conv_activation='relu', conv_kernel_initializer=None, conv_kernel_initializer_kwargs=None, conv_bias_initializer=None, conv_bias_initializer_kwargs=None, head_fcnet_hiddens=[], head_fcnet_activation='relu', head_fcnet_kernel_initializer=None, head_fcnet_kernel_initializer_kwargs=None, head_fcnet_bias_initializer=None, head_fcnet_bias_initializer_kwargs=None, free_log_std=False, log_std_clip_param=20.0, vf_share_layers=True, use_lstm=False, max_seq_len=20, lstm_cell_size=256, lstm_use_prev_action=False, lstm_use_prev_reward=False, lstm_kernel_initializer=None, lstm_kernel_initializer_kwargs=None, lstm_bias_initializer=None, lstm_bias_initializer_kwargs=None), catalog_class=None, load_state_path=None, model_config_dict=None)", "algorithm_config_overrides_per_module": {}, "_per_module_overrides": {}, "_validate_config": true, "_use_msgpack_checkpoints": false, "_torch_grad_scaler_class": null, "_torch_lr_scheduler_classes": null, "_tf_policy_handles_more_than_one_loss": false, "_disable_preprocessor_api": false, "_disable_action_flattening": false, "_disable_initialize_loss_from_dummy_batch": false, "_dont_auto_sync_env_runner_states": false, "env_task_fn": -1, "enable_connectors": -1, "simple_optimizer": false, "policy_map_cache": -1, "worker_cls": -1, "synchronize_filters": -1, "enable_async_evaluation": -1, "custom_async_evaluation_function": -1, "_enable_rl_module_api": -1, "auto_wrap_old_gym_envs": -1, "always_attach_evaluation_results": -1, "replay_sequence_length": null, "_disable_execution_plan_api": -1, "use_critic": true, "use_gae": true, "use_kl_loss": true, "kl_coeff": 0.7464963036515, "kl_target": 0.0270990929592, "vf_loss_coeff": 0.6688075857018, "entropy_coeff": 0.0090570820258, "clip_param": 0.1221781641624, "vf_clip_param": 0.1027808522125, "entropy_coeff_schedule": null, "lr_schedule": null, "sgd_minibatch_size": -1, "vf_share_layers": -1, "__stdout_file__": null, "__stderr_file__": null, "lambda": 0.9099046732075, "input": "sampler", "policies": {"default_policy": [null, null, null, null]}, "callbacks": "<class 'ray.rllib.callbacks.callbacks.RLlibCallback'>", "create_env_on_driver": false, "custom_eval_function": null, "framework": "torch"}, "time_since_restore": 4.902712821960449, "iterations_since_restore": 3, "perf": {"cpu_util_percent": 26.3, "ram_util_percent": 78.63333333333334}}
{"timers": {"training_iteration": 1.5502895186144219, "restore_env_runners": 1.199106821056921e-05, "training_step": 1.5501548742871871, "env_runner_sampling_timer": 1.4425850002426692, "learner_update_timer": 0.10455210289095108, "synch_weights": 0.0005487330584948649, "restore_eval_env_runners": 7.918431470170618e-06, "evaluation_iteration": 0.10487787874668138, "synch_eval_env_connectors": 0.0002160121138440445, "synch_env_connectors": 4.29531498812139e-06}, "env_runners": {"num_module_steps_sampled_lifetime": {"default_policy": -1225000.0}, "num_env_steps_sampled_lifetime": -1225000.0, "episode_len_mean": 20.0, "env_to_module_connector": {"timers": {"connectors": {"add_time_dim_to_batch_and_zero_pad": 2.8474935160798088e-06, "add_observations_from_episodes_to_batch": 3.068036389638103e-06, "add_states_from_episodes_to_batch": 1.7031622781944947e-06, "numpy_to_tensor": 8.593304314411771e-06, "batch_individual_items": 6.228326869162522e-06}}, "connector_pipeline_timer": 4.5181124943147266e-05}, "weights_seq_no": 3.0, "episode_len_min": 20, "num_agent_steps_sampled_lifetime": {"default_agent": -1225000.0}, "module_to_env_connector": {"connector_pipeline_timer": 0.00010661851734051288, "timers": {"connectors": {"tensor_to_numpy": 1.3302040661128064e-05, "listify_data_for_vector_env": 1.088731924413314e-05, "get_actions": 4.130581511130574e-05, "un_batch_to_individual_items": 5.375429180847773e-06, "normalize_and_clip_actions": 9.383376399107202e-06, "remove_single_ts_time_rank_from_batch": 6.071630155645043e-07}}}, "env_reset_timer": 3.29192554030678e-05, "env_to_module_sum_episodes_length_out": 10.36823839457432, "env_to_module_sum_episodes_length_in": 10.36823839457432, "num_module_steps_sampled": {"default_policy": 5000.0}, "episode_return_mean": 0.7399999999999999, "episode_len_max": 20, "num_env_steps_sampled": 5000.0, "num_episodes_lifetime": -61250.0, "agent_episode_returns_mean": {"default_agent": 0.7399999999999999}, "episode_return_min": -11.5, "sample": 0.004815821909136709, "num_episodes": 250.0, "num_agent_steps_sampled": {"default_agent": 5000.0}, "rlmodule_inference_timer": 2.7370769046837023e-05, "module_episode_returns_mean": {"default_policy": 0.7399999999999999}, "episode_return_max": 8.5, "env_step_timer": 1.3999873353287277e-05, "time_between_sampling": 0.0017594775739831832, "episode_duration_sec_mean": 0.004664120833855124, "num_env_steps_sampled_lifetime_throughput": 3744.2131475932697}, "learners": {"__all_modules__": {"learner_connector": {"timers": {"connectors": {"numpy_to_tensor": 5.803085115773138e-05, "add_observations_from_episodes_to_batch": 0.0008145834008071106, "add_one_ts_to_episodes_and_truncate": 0.007573194469501963, "add_states_from_episodes_to_batch": 2.8605380291119224e-06, "add_columns_from_episodes_to_train_batch": 0.034555445997447594, "add_time_dim_to_batch_and_zero_pad": 1.0094606139697134e-05, "general_advantage_estimation": 0.00636906849520281, "batch_individual_items": 0.030836051506021877}}, "connector_pipeline_timer": 0.08033353817451898}, "num_module_steps_trained": 6000, "num_trainable_parameters": 6003, "num_module_steps_trained_lifetime": 24000, "learner_connector_sum_episodes_length_out": 5250.0, "num_env_steps_trained_lifetime": 126000, "num_env_steps_trained": 31500, "learner_connector_sum_episodes_length_in": 5000.0, "num_non_trainable_parameters": 0, "num_env_steps_trained_lifetime_throughput": 2365541.47748334, "num_module_steps_trained_throughput": 453129.4124789907, "num_module_steps_trained_lifetime_throughput": 452253.992444655}, "default_policy": {"module_train_batch_size_mean": 1000.0, "entropy": 0.6283105611801147, "mean_kl_loss": 0.0006002793088555336, "policy_loss": 0.07163538783788681, "default_optimizer_learning_rate": 0.0002847858517, "total_loss": 0.13474135100841522, "gradients_default_optimizer_global_norm": 0.0398266464471817, "diff_num_grad_updates_vs_sampler_policy": 1.0, "num_module_steps_trained": 6000, "num_trainable_parameters": 6003, "num_module_steps_trained_lifetime": 24000, "vf_loss_unclipped": 28.65396499633789, "vf_explained_var": -0.013248324394226074, "curr_entropy_coeff": 0.0090570820258, "curr_kl_coeff": 0.04665601998567581, "weights_seq_no": 4.0, "vf_loss": 0.10278083384037018, "num_module_steps_trained_lifetime_throughput": 454248.6831167799}}, "num_training_step_calls_per_iteration": 1, "evaluation": {"env_runners": {"env_to_module_connector": {"timers": {"connectors": {"add_time_dim_to_batch_and_zero_pad": 2.293195295255343e-06, "batch_individual_items": 6.233867439675632e-06, "numpy_to_tensor": 8.405725607983541e-06, "add_observations_from_episodes_to_batch": 2.8186263906383878e-06, "add_states_from_episodes_to_batch": 1.6572396933438396e-06}}, "connector_pipeline_timer": 4.2889774709642746e-05}, "module_episode_returns_mean": {"default_policy": -0.7}, "num_module_steps_sampled_lifetime": {"default_policy": 1600}, "episode_return_mean": -0.7, "env_step_timer": 1.4077954768879542e-05, "num_module_steps_sampled": {"default_policy": 400}, "episode_len_mean": 20.0, "module_to_env_connector": {"timers": {"connectors": {"normalize_and_clip_actions": 9.494847441576695e-06, "listify_data_for_vector_env": 1.0880273803888712e-05, "get_actions": 3.51716805111553e-05, "remove_single_ts_time_rank_from_batch": 5.906696989032444e-07, "tensor_to_numpy": 1.2959843201287558e-05, "un_batch_to_individual_items": 5.381180713030582e-06}}, "connector_pipeline_timer": 9.996800702982777e-05}, "num_env_steps_sampled": 400, "num_episodes_lifetime": 80, "sample": 0.09865393742404795, "episode_duration_sec_mean": 0.004496076576469932, "num_env_steps_sampled_lifetime": 20400, "agent_episode_returns_mean": {"default_agent": -0.7}, "env_reset_timer": 0.00014437554652662945, "rlmodule_inference_timer": 2.8007898739620833e-05, "num_agent_steps_sampled_lifetime": {"default_agent": 1600}, "episode_len_min": 20, "weights_seq_no": 4.0, "env_to_module_sum_episodes_length_out": 10.368237912813044, "num_agent_steps_sampled": {"default_agent": 400}, "env_to_module_sum_episodes_length_in": 10.368237912813044, "episode_len_max": 20, "episode_return_min": -14.5, "num_episodes": 20, "episode_return_max": 14.5, "time_between_sampling": 1.605473472563713}, "num_healthy_workers": 1, "actor_manager_num_outstanding_async_reqs": 0, "num_remote_worker_restarts": 0}, "num_env_steps_sampled_lifetime": -1225000.0, "fault_tolerance": {"num_healthy_workers": 0, "num_remote_worker_restarts": 0}, "env_runner_group": {"actor_manager_num_outstanding_async_reqs": 0}, "done": false, "training_iteration": 4, "trial_id": "43aed_00000", "date": "2025-08-11_19-23-06", "timestamp": 1754932986, "time_this_iter_s": 1.7024610042572021, "time_total_s": 6.605173826217651, "pid": 14402, "hostname": "Mac", "node_ip": "127.0.0.1", "config": {"exploration_config": {}, "extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "placement_strategy": "PACK", "num_gpus": 0, "_fake_gpus": false, "num_cpus_for_main_process": 2, "eager_tracing": true, "eager_max_retraces": 20, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "torch_compile_learner": false, "torch_compile_learner_what_to_compile": "forward_train", "torch_compile_learner_dynamo_backend": "aot_eager", "torch_compile_learner_dynamo_mode": null, "torch_compile_worker": false, "torch_compile_worker_dynamo_backend": "aot_eager", "torch_compile_worker_dynamo_mode": null, "torch_ddp_kwargs": {}, "torch_skip_nan_gradients": false, "env": "Umbrella", "env_config": {}, "observation_space": null, "action_space": null, "clip_rewards": null, "normalize_actions": true, "clip_actions": false, "_is_atari": null, "disable_env_checking": false, "render_env": false, "action_mask_key": "action_mask", "env_runner_cls": null, "num_env_runners": 0, "create_local_env_runner": true, "num_envs_per_env_runner": 1, "gym_env_vectorize_mode": "SYNC", "num_cpus_per_env_runner": 1, "num_gpus_per_env_runner": 0, "custom_resources_per_env_runner": {}, "validate_env_runners_after_construction": true, "episodes_to_numpy": true, "max_requests_in_flight_per_env_runner": 1, "sample_timeout_s": 60.0, "_env_to_module_connector": null, "add_default_connectors_to_env_to_module_pipeline": true, "_module_to_env_connector": null, "add_default_connectors_to_module_to_env_pipeline": true, "merge_env_runner_states": "training_only", "broadcast_env_runner_states": true, "episode_lookback_horizon": 1, "rollout_fragment_length": "auto", "batch_mode": "complete_episodes", "compress_observations": false, "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "enable_tf1_exec_eagerly": false, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "preprocessor_pref": "deepmind", "observation_filter": "NoFilter", "update_worker_filter_stats": true, "use_worker_filter_stats": true, "sampler_perf_stats_ema_coef": null, "_is_online": true, "num_learners": 0, "num_gpus_per_learner": 0, "num_cpus_per_learner": "auto", "num_aggregator_actors_per_learner": 0, "max_requests_in_flight_per_aggregator_actor": 3, "local_gpu_idx": 0, "max_requests_in_flight_per_learner": 3, "gamma": 1, "lr": 0.0002847858517, "grad_clip": 0.5, "grad_clip_by": "global_norm", "_train_batch_size_per_learner": 5000, "train_batch_size": 4000, "num_epochs": 1, "minibatch_size": 1000, "shuffle_batch_per_epoch": true, "model": {"fcnet_hiddens": [256, 256], "fcnet_activation": "tanh", "fcnet_weights_initializer": null, "fcnet_weights_initializer_config": null, "fcnet_bias_initializer": null, "fcnet_bias_initializer_config": null, "conv_filters": null, "conv_activation": "relu", "conv_kernel_initializer": null, "conv_kernel_initializer_config": null, "conv_bias_initializer": null, "conv_bias_initializer_config": null, "conv_transpose_kernel_initializer": null, "conv_transpose_kernel_initializer_config": null, "conv_transpose_bias_initializer": null, "conv_transpose_bias_initializer_config": null, "post_fcnet_hiddens": [], "post_fcnet_activation": "relu", "post_fcnet_weights_initializer": null, "post_fcnet_weights_initializer_config": null, "post_fcnet_bias_initializer": null, "post_fcnet_bias_initializer_config": null, "free_log_std": false, "log_std_clip_param": 20.0, "no_final_linear": false, "vf_share_layers": false, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "lstm_weights_initializer": null, "lstm_weights_initializer_config": null, "lstm_bias_initializer": null, "lstm_bias_initializer_config": null, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "attention_use_n_prev_actions": 0, "attention_use_n_prev_rewards": 0, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": null, "custom_model_config": {}, "custom_action_dist": null, "custom_preprocessor": null, "encoder_latent_dim": null, "always_check_shapes": false, "lstm_use_prev_action_reward": -1, "_use_default_native_models": -1, "_disable_preprocessor_api": false, "_disable_action_flattening": false}, "_learner_connector": null, "add_default_connectors_to_learner_pipeline": true, "learner_config_dict": {}, "optimizer": {}, "_learner_class": null, "callbacks_on_algorithm_init": null, "callbacks_on_env_runners_recreated": null, "callbacks_on_offline_eval_runners_recreated": null, "callbacks_on_checkpoint_loaded": null, "callbacks_on_environment_created": null, "callbacks_on_episode_created": null, "callbacks_on_episode_start": null, "callbacks_on_episode_step": null, "callbacks_on_episode_end": null, "callbacks_on_evaluate_start": null, "callbacks_on_evaluate_end": null, "callbacks_on_evaluate_offline_start": null, "callbacks_on_evaluate_offline_end": null, "callbacks_on_sample_end": null, "callbacks_on_train_result": null, "explore": true, "enable_rl_module_and_learner": true, "enable_env_runner_and_connector_v2": true, "_prior_exploration_config": {"type": "StochasticSampling"}, "count_steps_by": "env_steps", "policy_map_capacity": 100, "policy_mapping_fn": "<function AlgorithmConfig.DEFAULT_POLICY_MAPPING_FN at 0x3881edb20>", "policies_to_train": null, "policy_states_are_swappable": false, "observation_fn": null, "offline_data_class": null, "input_read_method": "read_parquet", "input_read_method_kwargs": {}, "input_read_schema": {}, "input_read_episodes": false, "input_read_sample_batches": false, "input_read_batch_size": null, "input_filesystem": null, "input_filesystem_kwargs": {}, "input_compress_columns": ["obs", "new_obs"], "input_spaces_jsonable": true, "materialize_data": false, "materialize_mapped_data": true, "map_batches_kwargs": {}, "iter_batches_kwargs": {}, "ignore_final_observation": false, "prelearner_class": null, "prelearner_buffer_class": null, "prelearner_buffer_kwargs": {}, "prelearner_module_synch_period": 10, "dataset_num_iters_per_learner": null, "input_config": {}, "actions_in_input_normalized": false, "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_config": {}, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "output_max_rows_per_file": null, "output_write_remaining_data": false, "output_write_method": "write_parquet", "output_write_method_kwargs": {}, "output_filesystem": null, "output_filesystem_kwargs": {}, "output_write_episodes": true, "offline_sampling": false, "evaluation_interval": 1, "evaluation_duration": 20, "evaluation_duration_unit": "episodes", "evaluation_sample_timeout_s": 120.0, "evaluation_auto_duration_min_env_steps_per_sample": 100, "evaluation_auto_duration_max_env_steps_per_sample": 2000, "evaluation_parallel_to_training": false, "evaluation_force_reset_envs_before_iteration": true, "evaluation_config": null, "off_policy_estimation_methods": {}, "ope_split_batch_by_episode": true, "evaluation_num_env_runners": 1, "in_evaluation": false, "sync_filters_on_rollout_workers_timeout_s": 10.0, "offline_evaluation_interval": null, "num_offline_eval_runners": 0, "offline_loss_for_module_fn": null, "offline_evaluation_duration": 1, "offline_evaluation_parallel_to_training": false, "offline_evaluation_timeout_s": 120.0, "num_cpus_per_offline_eval_runner": 1, "num_gpus_per_offline_eval_runner": 0, "custom_resources_per_offline_eval_runner": {}, "restart_failed_offline_eval_runners": true, "ignore_offline_eval_runner_failures": false, "max_num_offline_eval_runner_restarts": 1000, "offline_eval_runner_restore_timeout_s": 1800.0, "max_requests_in_flight_per_offline_eval_runner": 1, "validate_offline_eval_runners_after_construction": true, "offline_eval_runner_health_probe_timeout_s": 30.0, "offline_eval_rl_module_inference_only": false, "broadcast_offline_eval_runner_states": false, "offline_eval_batch_size_per_runner": 256, "dataset_num_iters_per_eval_runner": 1, "keep_per_episode_custom_metrics": false, "metrics_episode_collection_timeout_s": 60.0, "metrics_num_episodes_for_smoothing": 100, "min_time_s_per_iteration": null, "min_train_timesteps_per_iteration": 0, "min_sample_timesteps_per_iteration": 0, "log_gradients": true, "export_native_model_files": false, "checkpoint_trainable_policies_only": false, "logger_creator": null, "logger_config": null, "log_level": "WARN", "log_sys_usage": true, "fake_sampler": false, "seed": 2, "restart_failed_env_runners": true, "ignore_env_runner_failures": false, "max_num_env_runner_restarts": 1000, "delay_between_env_runner_restarts_s": 60.0, "restart_failed_sub_environments": false, "num_consecutive_env_runner_failures_tolerance": 100, "env_runner_health_probe_timeout_s": 30.0, "env_runner_restore_timeout_s": 1800.0, "_model_config": {}, "_rl_module_spec": "RLModuleSpec(module_class=None, observation_space=None, action_space=None, inference_only=False, learner_only=False, model_config=DefaultModelConfig(fcnet_hiddens=[60, 90], fcnet_activation='tanh', fcnet_kernel_initializer=None, fcnet_kernel_initializer_kwargs=None, fcnet_bias_initializer=None, fcnet_bias_initializer_kwargs=None, conv_filters=None, conv_activation='relu', conv_kernel_initializer=None, conv_kernel_initializer_kwargs=None, conv_bias_initializer=None, conv_bias_initializer_kwargs=None, head_fcnet_hiddens=[], head_fcnet_activation='relu', head_fcnet_kernel_initializer=None, head_fcnet_kernel_initializer_kwargs=None, head_fcnet_bias_initializer=None, head_fcnet_bias_initializer_kwargs=None, free_log_std=False, log_std_clip_param=20.0, vf_share_layers=True, use_lstm=False, max_seq_len=20, lstm_cell_size=256, lstm_use_prev_action=False, lstm_use_prev_reward=False, lstm_kernel_initializer=None, lstm_kernel_initializer_kwargs=None, lstm_bias_initializer=None, lstm_bias_initializer_kwargs=None), catalog_class=None, load_state_path=None, model_config_dict=None)", "algorithm_config_overrides_per_module": {}, "_per_module_overrides": {}, "_validate_config": true, "_use_msgpack_checkpoints": false, "_torch_grad_scaler_class": null, "_torch_lr_scheduler_classes": null, "_tf_policy_handles_more_than_one_loss": false, "_disable_preprocessor_api": false, "_disable_action_flattening": false, "_disable_initialize_loss_from_dummy_batch": false, "_dont_auto_sync_env_runner_states": false, "env_task_fn": -1, "enable_connectors": -1, "simple_optimizer": false, "policy_map_cache": -1, "worker_cls": -1, "synchronize_filters": -1, "enable_async_evaluation": -1, "custom_async_evaluation_function": -1, "_enable_rl_module_api": -1, "auto_wrap_old_gym_envs": -1, "always_attach_evaluation_results": -1, "replay_sequence_length": null, "_disable_execution_plan_api": -1, "use_critic": true, "use_gae": true, "use_kl_loss": true, "kl_coeff": 0.7464963036515, "kl_target": 0.0270990929592, "vf_loss_coeff": 0.6688075857018, "entropy_coeff": 0.0090570820258, "clip_param": 0.1221781641624, "vf_clip_param": 0.1027808522125, "entropy_coeff_schedule": null, "lr_schedule": null, "sgd_minibatch_size": -1, "vf_share_layers": -1, "__stdout_file__": null, "__stderr_file__": null, "lambda": 0.9099046732075, "input": "sampler", "policies": {"default_policy": [null, null, null, null]}, "callbacks": "<class 'ray.rllib.callbacks.callbacks.RLlibCallback'>", "create_env_on_driver": false, "custom_eval_function": null, "framework": "torch"}, "time_since_restore": 6.605173826217651, "iterations_since_restore": 4, "perf": {"cpu_util_percent": 39.35, "ram_util_percent": 78.6}}
{"timers": {"training_iteration": 1.5501375617582165, "restore_env_runners": 1.1926987988505278e-05, "training_step": 1.5500024226239126, "env_runner_sampling_timer": 1.4425720877398251, "learner_update_timer": 0.10441268144133858, "synch_weights": 0.0005485569778980699, "restore_eval_env_runners": 7.93799645220861e-06, "evaluation_iteration": 0.10487323370947071, "synch_eval_env_connectors": 0.00021484365217736923, "synch_env_connectors": 4.296951234806328e-06}, "env_runners": {"num_module_steps_sampled_lifetime": {"default_policy": -1842500.0}, "num_env_steps_sampled_lifetime": -1842500.0, "episode_len_mean": 20.0, "env_to_module_connector": {"timers": {"connectors": {"add_time_dim_to_batch_and_zero_pad": 2.4143792959055804e-06, "add_observations_from_episodes_to_batch": 2.943914165149641e-06, "add_states_from_episodes_to_batch": 1.6899723033810542e-06, "numpy_to_tensor": 8.34411740252541e-06, "batch_individual_items": 6.108411134782085e-06}}, "connector_pipeline_timer": 4.300408179193807e-05}, "weights_seq_no": 4.0, "episode_len_min": 20, "num_agent_steps_sampled_lifetime": {"default_agent": -1842500.0}, "module_to_env_connector": {"connector_pipeline_timer": 0.00010284063059141476, "timers": {"connectors": {"tensor_to_numpy": 1.2901167129510239e-05, "listify_data_for_vector_env": 1.0727155122727088e-05, "get_actions": 3.8758982409114085e-05, "un_batch_to_individual_items": 5.290780740672561e-06, "normalize_and_clip_actions": 9.23257111294565e-06, "remove_single_ts_time_rank_from_batch": 5.994450284176507e-07}}}, "env_reset_timer": 3.326760261234458e-05, "env_to_module_sum_episodes_length_out": 10.36823839457432, "env_to_module_sum_episodes_length_in": 10.36823839457432, "num_module_steps_sampled": {"default_policy": 5000.0}, "episode_return_mean": 2.8199999999999994, "episode_len_max": 20, "num_env_steps_sampled": 5000.0, "num_episodes_lifetime": -92125.0, "agent_episode_returns_mean": {"default_agent": 2.8199999999999994}, "episode_return_min": -11.5, "sample": 0.004982920360818373, "num_episodes": 250.0, "num_agent_steps_sampled": {"default_agent": 5000.0}, "rlmodule_inference_timer": 4.47089501918369e-05, "module_episode_returns_mean": {"default_policy": 2.8199999999999994}, "episode_return_max": 8.5, "env_step_timer": 1.3611583803495635e-05, "time_between_sampling": 0.0016086531119448397, "episode_duration_sec_mean": 0.004816819693893194, "num_env_steps_sampled_lifetime_throughput": 3759.95287093559}, "learners": {"__all_modules__": {"learner_connector": {"timers": {"connectors": {"numpy_to_tensor": 5.7935542846723695e-05, "add_observations_from_episodes_to_batch": 0.0008144013166119554, "add_one_ts_to_episodes_and_truncate": 0.00757170127402791, "add_states_from_episodes_to_batch": 2.8569328391831373e-06, "add_columns_from_episodes_to_train_batch": 0.03455246903774194, "add_time_dim_to_batch_and_zero_pad": 1.00815792576503e-05, "general_advantage_estimation": 0.006360428230592794, "batch_individual_items": 0.030824151400843203}}, "connector_pipeline_timer": 0.08030792904300878}, "num_module_steps_trained": 6000, "num_trainable_parameters": 6003, "num_module_steps_trained_lifetime": 30000, "learner_connector_sum_episodes_length_out": 5250.0, "num_env_steps_trained_lifetime": 157500, "num_env_steps_trained": 31500, "learner_connector_sum_episodes_length_in": 5000.0, "num_non_trainable_parameters": 0, "num_env_steps_trained_lifetime_throughput": 2362747.4748404743, "num_module_steps_trained_throughput": 452518.71361946146, "num_module_steps_trained_lifetime_throughput": 451666.84836155205}, "default_policy": {"module_train_batch_size_mean": 1000.0, "entropy": 0.6176988482475281, "mean_kl_loss": 0.0002633107651490718, "policy_loss": 0.042711563408374786, "default_optimizer_learning_rate": 0.0002847858517, "total_loss": 0.10586991161108017, "gradients_default_optimizer_global_norm": 0.029085060581564903, "diff_num_grad_updates_vs_sampler_policy": 1.0, "num_module_steps_trained": 6000, "num_trainable_parameters": 6003, "num_module_steps_trained_lifetime": 30000, "vf_loss_unclipped": 28.329936981201172, "vf_explained_var": -0.010551810264587402, "curr_entropy_coeff": 0.0090570820258, "curr_kl_coeff": 0.023328009992837906, "weights_seq_no": 5.0, "vf_loss": 0.10278083384037018, "num_module_steps_trained_lifetime_throughput": 453576.2669964596}}, "num_training_step_calls_per_iteration": 1, "evaluation": {"env_runners": {"env_to_module_connector": {"timers": {"connectors": {"add_time_dim_to_batch_and_zero_pad": 2.3653211608051274e-06, "batch_individual_items": 6.092675062625575e-06, "numpy_to_tensor": 8.145863975544047e-06, "add_observations_from_episodes_to_batch": 2.7731868369696326e-06, "add_states_from_episodes_to_batch": 1.6333811279535056e-06}}, "connector_pipeline_timer": 4.242959075604749e-05}, "module_episode_returns_mean": {"default_policy": -0.8}, "num_module_steps_sampled_lifetime": {"default_policy": 2000}, "episode_return_mean": -0.8, "env_step_timer": 1.3726885499190632e-05, "num_module_steps_sampled": {"default_policy": 400}, "episode_len_mean": 20.0, "module_to_env_connector": {"timers": {"connectors": {"normalize_and_clip_actions": 9.260053614460219e-06, "listify_data_for_vector_env": 1.070108736933782e-05, "get_actions": 3.4422200113064984e-05, "remove_single_ts_time_rank_from_batch": 5.657095986082203e-07, "tensor_to_numpy": 1.2705463385157783e-05, "un_batch_to_individual_items": 5.3010231024451335e-06}}, "connector_pipeline_timer": 9.819937586875195e-05}, "num_env_steps_sampled": 400, "num_episodes_lifetime": 100, "sample": 0.09863100637899182, "episode_duration_sec_mean": 0.004481690030079335, "num_env_steps_sampled_lifetime": 25400, "agent_episode_returns_mean": {"default_agent": -0.8}, "env_reset_timer": 0.0001436738712171232, "rlmodule_inference_timer": 2.6728398826049675e-05, "num_agent_steps_sampled_lifetime": {"default_agent": 2000}, "episode_len_min": 20, "weights_seq_no": 5.0, "env_to_module_sum_episodes_length_out": 10.368238387501162, "num_agent_steps_sampled": {"default_agent": 400}, "env_to_module_sum_episodes_length_in": 10.368238387501162, "episode_len_max": 20, "episode_return_min": -14.5, "num_episodes": 20, "episode_return_max": 14.5, "time_between_sampling": 1.6049459815884783}, "num_healthy_workers": 1, "actor_manager_num_outstanding_async_reqs": 0, "num_remote_worker_restarts": 0}, "num_env_steps_sampled_lifetime": -1842500.0, "fault_tolerance": {"num_healthy_workers": 0, "num_remote_worker_restarts": 0}, "env_runner_group": {"actor_manager_num_outstanding_async_reqs": 0}, "done": false, "training_iteration": 5, "trial_id": "43aed_00000", "date": "2025-08-11_19-23-07", "timestamp": 1754932987, "time_this_iter_s": 1.6383659839630127, "time_total_s": 8.243539810180664, "pid": 14402, "hostname": "Mac", "node_ip": "127.0.0.1", "config": {"exploration_config": {}, "extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "placement_strategy": "PACK", "num_gpus": 0, "_fake_gpus": false, "num_cpus_for_main_process": 2, "eager_tracing": true, "eager_max_retraces": 20, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "torch_compile_learner": false, "torch_compile_learner_what_to_compile": "forward_train", "torch_compile_learner_dynamo_backend": "aot_eager", "torch_compile_learner_dynamo_mode": null, "torch_compile_worker": false, "torch_compile_worker_dynamo_backend": "aot_eager", "torch_compile_worker_dynamo_mode": null, "torch_ddp_kwargs": {}, "torch_skip_nan_gradients": false, "env": "Umbrella", "env_config": {}, "observation_space": null, "action_space": null, "clip_rewards": null, "normalize_actions": true, "clip_actions": false, "_is_atari": null, "disable_env_checking": false, "render_env": false, "action_mask_key": "action_mask", "env_runner_cls": null, "num_env_runners": 0, "create_local_env_runner": true, "num_envs_per_env_runner": 1, "gym_env_vectorize_mode": "SYNC", "num_cpus_per_env_runner": 1, "num_gpus_per_env_runner": 0, "custom_resources_per_env_runner": {}, "validate_env_runners_after_construction": true, "episodes_to_numpy": true, "max_requests_in_flight_per_env_runner": 1, "sample_timeout_s": 60.0, "_env_to_module_connector": null, "add_default_connectors_to_env_to_module_pipeline": true, "_module_to_env_connector": null, "add_default_connectors_to_module_to_env_pipeline": true, "merge_env_runner_states": "training_only", "broadcast_env_runner_states": true, "episode_lookback_horizon": 1, "rollout_fragment_length": "auto", "batch_mode": "complete_episodes", "compress_observations": false, "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "enable_tf1_exec_eagerly": false, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "preprocessor_pref": "deepmind", "observation_filter": "NoFilter", "update_worker_filter_stats": true, "use_worker_filter_stats": true, "sampler_perf_stats_ema_coef": null, "_is_online": true, "num_learners": 0, "num_gpus_per_learner": 0, "num_cpus_per_learner": "auto", "num_aggregator_actors_per_learner": 0, "max_requests_in_flight_per_aggregator_actor": 3, "local_gpu_idx": 0, "max_requests_in_flight_per_learner": 3, "gamma": 1, "lr": 0.0002847858517, "grad_clip": 0.5, "grad_clip_by": "global_norm", "_train_batch_size_per_learner": 5000, "train_batch_size": 4000, "num_epochs": 1, "minibatch_size": 1000, "shuffle_batch_per_epoch": true, "model": {"fcnet_hiddens": [256, 256], "fcnet_activation": "tanh", "fcnet_weights_initializer": null, "fcnet_weights_initializer_config": null, "fcnet_bias_initializer": null, "fcnet_bias_initializer_config": null, "conv_filters": null, "conv_activation": "relu", "conv_kernel_initializer": null, "conv_kernel_initializer_config": null, "conv_bias_initializer": null, "conv_bias_initializer_config": null, "conv_transpose_kernel_initializer": null, "conv_transpose_kernel_initializer_config": null, "conv_transpose_bias_initializer": null, "conv_transpose_bias_initializer_config": null, "post_fcnet_hiddens": [], "post_fcnet_activation": "relu", "post_fcnet_weights_initializer": null, "post_fcnet_weights_initializer_config": null, "post_fcnet_bias_initializer": null, "post_fcnet_bias_initializer_config": null, "free_log_std": false, "log_std_clip_param": 20.0, "no_final_linear": false, "vf_share_layers": false, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "lstm_weights_initializer": null, "lstm_weights_initializer_config": null, "lstm_bias_initializer": null, "lstm_bias_initializer_config": null, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "attention_use_n_prev_actions": 0, "attention_use_n_prev_rewards": 0, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": null, "custom_model_config": {}, "custom_action_dist": null, "custom_preprocessor": null, "encoder_latent_dim": null, "always_check_shapes": false, "lstm_use_prev_action_reward": -1, "_use_default_native_models": -1, "_disable_preprocessor_api": false, "_disable_action_flattening": false}, "_learner_connector": null, "add_default_connectors_to_learner_pipeline": true, "learner_config_dict": {}, "optimizer": {}, "_learner_class": null, "callbacks_on_algorithm_init": null, "callbacks_on_env_runners_recreated": null, "callbacks_on_offline_eval_runners_recreated": null, "callbacks_on_checkpoint_loaded": null, "callbacks_on_environment_created": null, "callbacks_on_episode_created": null, "callbacks_on_episode_start": null, "callbacks_on_episode_step": null, "callbacks_on_episode_end": null, "callbacks_on_evaluate_start": null, "callbacks_on_evaluate_end": null, "callbacks_on_evaluate_offline_start": null, "callbacks_on_evaluate_offline_end": null, "callbacks_on_sample_end": null, "callbacks_on_train_result": null, "explore": true, "enable_rl_module_and_learner": true, "enable_env_runner_and_connector_v2": true, "_prior_exploration_config": {"type": "StochasticSampling"}, "count_steps_by": "env_steps", "policy_map_capacity": 100, "policy_mapping_fn": "<function AlgorithmConfig.DEFAULT_POLICY_MAPPING_FN at 0x3881edb20>", "policies_to_train": null, "policy_states_are_swappable": false, "observation_fn": null, "offline_data_class": null, "input_read_method": "read_parquet", "input_read_method_kwargs": {}, "input_read_schema": {}, "input_read_episodes": false, "input_read_sample_batches": false, "input_read_batch_size": null, "input_filesystem": null, "input_filesystem_kwargs": {}, "input_compress_columns": ["obs", "new_obs"], "input_spaces_jsonable": true, "materialize_data": false, "materialize_mapped_data": true, "map_batches_kwargs": {}, "iter_batches_kwargs": {}, "ignore_final_observation": false, "prelearner_class": null, "prelearner_buffer_class": null, "prelearner_buffer_kwargs": {}, "prelearner_module_synch_period": 10, "dataset_num_iters_per_learner": null, "input_config": {}, "actions_in_input_normalized": false, "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_config": {}, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "output_max_rows_per_file": null, "output_write_remaining_data": false, "output_write_method": "write_parquet", "output_write_method_kwargs": {}, "output_filesystem": null, "output_filesystem_kwargs": {}, "output_write_episodes": true, "offline_sampling": false, "evaluation_interval": 1, "evaluation_duration": 20, "evaluation_duration_unit": "episodes", "evaluation_sample_timeout_s": 120.0, "evaluation_auto_duration_min_env_steps_per_sample": 100, "evaluation_auto_duration_max_env_steps_per_sample": 2000, "evaluation_parallel_to_training": false, "evaluation_force_reset_envs_before_iteration": true, "evaluation_config": null, "off_policy_estimation_methods": {}, "ope_split_batch_by_episode": true, "evaluation_num_env_runners": 1, "in_evaluation": false, "sync_filters_on_rollout_workers_timeout_s": 10.0, "offline_evaluation_interval": null, "num_offline_eval_runners": 0, "offline_loss_for_module_fn": null, "offline_evaluation_duration": 1, "offline_evaluation_parallel_to_training": false, "offline_evaluation_timeout_s": 120.0, "num_cpus_per_offline_eval_runner": 1, "num_gpus_per_offline_eval_runner": 0, "custom_resources_per_offline_eval_runner": {}, "restart_failed_offline_eval_runners": true, "ignore_offline_eval_runner_failures": false, "max_num_offline_eval_runner_restarts": 1000, "offline_eval_runner_restore_timeout_s": 1800.0, "max_requests_in_flight_per_offline_eval_runner": 1, "validate_offline_eval_runners_after_construction": true, "offline_eval_runner_health_probe_timeout_s": 30.0, "offline_eval_rl_module_inference_only": false, "broadcast_offline_eval_runner_states": false, "offline_eval_batch_size_per_runner": 256, "dataset_num_iters_per_eval_runner": 1, "keep_per_episode_custom_metrics": false, "metrics_episode_collection_timeout_s": 60.0, "metrics_num_episodes_for_smoothing": 100, "min_time_s_per_iteration": null, "min_train_timesteps_per_iteration": 0, "min_sample_timesteps_per_iteration": 0, "log_gradients": true, "export_native_model_files": false, "checkpoint_trainable_policies_only": false, "logger_creator": null, "logger_config": null, "log_level": "WARN", "log_sys_usage": true, "fake_sampler": false, "seed": 2, "restart_failed_env_runners": true, "ignore_env_runner_failures": false, "max_num_env_runner_restarts": 1000, "delay_between_env_runner_restarts_s": 60.0, "restart_failed_sub_environments": false, "num_consecutive_env_runner_failures_tolerance": 100, "env_runner_health_probe_timeout_s": 30.0, "env_runner_restore_timeout_s": 1800.0, "_model_config": {}, "_rl_module_spec": "RLModuleSpec(module_class=None, observation_space=None, action_space=None, inference_only=False, learner_only=False, model_config=DefaultModelConfig(fcnet_hiddens=[60, 90], fcnet_activation='tanh', fcnet_kernel_initializer=None, fcnet_kernel_initializer_kwargs=None, fcnet_bias_initializer=None, fcnet_bias_initializer_kwargs=None, conv_filters=None, conv_activation='relu', conv_kernel_initializer=None, conv_kernel_initializer_kwargs=None, conv_bias_initializer=None, conv_bias_initializer_kwargs=None, head_fcnet_hiddens=[], head_fcnet_activation='relu', head_fcnet_kernel_initializer=None, head_fcnet_kernel_initializer_kwargs=None, head_fcnet_bias_initializer=None, head_fcnet_bias_initializer_kwargs=None, free_log_std=False, log_std_clip_param=20.0, vf_share_layers=True, use_lstm=False, max_seq_len=20, lstm_cell_size=256, lstm_use_prev_action=False, lstm_use_prev_reward=False, lstm_kernel_initializer=None, lstm_kernel_initializer_kwargs=None, lstm_bias_initializer=None, lstm_bias_initializer_kwargs=None), catalog_class=None, load_state_path=None, model_config_dict=None)", "algorithm_config_overrides_per_module": {}, "_per_module_overrides": {}, "_validate_config": true, "_use_msgpack_checkpoints": false, "_torch_grad_scaler_class": null, "_torch_lr_scheduler_classes": null, "_tf_policy_handles_more_than_one_loss": false, "_disable_preprocessor_api": false, "_disable_action_flattening": false, "_disable_initialize_loss_from_dummy_batch": false, "_dont_auto_sync_env_runner_states": false, "env_task_fn": -1, "enable_connectors": -1, "simple_optimizer": false, "policy_map_cache": -1, "worker_cls": -1, "synchronize_filters": -1, "enable_async_evaluation": -1, "custom_async_evaluation_function": -1, "_enable_rl_module_api": -1, "auto_wrap_old_gym_envs": -1, "always_attach_evaluation_results": -1, "replay_sequence_length": null, "_disable_execution_plan_api": -1, "use_critic": true, "use_gae": true, "use_kl_loss": true, "kl_coeff": 0.7464963036515, "kl_target": 0.0270990929592, "vf_loss_coeff": 0.6688075857018, "entropy_coeff": 0.0090570820258, "clip_param": 0.1221781641624, "vf_clip_param": 0.1027808522125, "entropy_coeff_schedule": null, "lr_schedule": null, "sgd_minibatch_size": -1, "vf_share_layers": -1, "__stdout_file__": null, "__stderr_file__": null, "lambda": 0.9099046732075, "input": "sampler", "policies": {"default_policy": [null, null, null, null]}, "callbacks": "<class 'ray.rllib.callbacks.callbacks.RLlibCallback'>", "create_env_on_driver": false, "custom_eval_function": null, "framework": "torch"}, "time_since_restore": 8.243539810180664, "iterations_since_restore": 5, "perf": {"cpu_util_percent": 41.45, "ram_util_percent": 78.6}}
{"timers": {"training_iteration": 1.5501218436407376, "restore_env_runners": 1.186146822686094e-05, "training_step": 1.5499862921474434, "env_runner_sampling_timer": 1.4417956722726444, "learner_update_timer": 0.1051697471266224, "synch_weights": 0.0005492047377080091, "restore_eval_env_runners": 7.922786941383967e-06, "evaluation_iteration": 0.1048360367824468, "synch_eval_env_connectors": 0.0002136497956832056, "synch_env_connectors": 4.28940108412411e-06}, "env_runners": {"num_module_steps_sampled_lifetime": {"default_policy": -2460000.0}, "num_env_steps_sampled_lifetime": -2460000.0, "episode_len_mean": 20.0, "env_to_module_connector": {"timers": {"connectors": {"add_time_dim_to_batch_and_zero_pad": 2.391519868671853e-06, "add_observations_from_episodes_to_batch": 2.9376235819275307e-06, "add_states_from_episodes_to_batch": 1.6977331314668243e-06, "numpy_to_tensor": 8.3960393254774e-06, "batch_individual_items": 6.129707206619936e-06}}, "connector_pipeline_timer": 4.308972834300509e-05}, "weights_seq_no": 5.0, "episode_len_min": 20, "num_agent_steps_sampled_lifetime": {"default_agent": -2460000.0}, "module_to_env_connector": {"connector_pipeline_timer": 0.00010308771696696255, "timers": {"connectors": {"tensor_to_numpy": 1.3015572330952237e-05, "listify_data_for_vector_env": 1.073850267916789e-05, "get_actions": 3.879639649314477e-05, "un_batch_to_individual_items": 5.284971959453893e-06, "normalize_and_clip_actions": 9.265562817962345e-06, "remove_single_ts_time_rank_from_batch": 5.960704786342843e-07}}}, "env_reset_timer": 3.2363366718690315e-05, "env_to_module_sum_episodes_length_out": 10.36823839457432, "env_to_module_sum_episodes_length_in": 10.36823839457432, "num_module_steps_sampled": {"default_policy": 5000.0}, "episode_return_mean": 2.34, "episode_len_max": 20, "num_env_steps_sampled": 5000.0, "num_episodes_lifetime": -123000.0, "agent_episode_returns_mean": {"default_agent": 2.34}, "episode_return_min": -11.5, "sample": 0.005069160437764, "num_episodes": 250.0, "num_agent_steps_sampled": {"default_agent": 5000.0}, "rlmodule_inference_timer": 2.7807959748446318e-05, "module_episode_returns_mean": {"default_policy": 2.34}, "episode_return_max": 8.5, "env_step_timer": 1.360961116850026e-05, "time_between_sampling": 0.0014800217853953802, "episode_duration_sec_mean": 0.004503006862476468, "num_env_steps_sampled_lifetime_throughput": 3757.422072838739}, "learners": {"__all_modules__": {"learner_connector": {"timers": {"connectors": {"numpy_to_tensor": 5.7978686919589094e-05, "add_observations_from_episodes_to_batch": 0.000814029803839748, "add_one_ts_to_episodes_and_truncate": 0.007570933841299521, "add_states_from_episodes_to_batch": 2.8537839604654357e-06, "add_columns_from_episodes_to_train_batch": 0.03454473975766978, "add_time_dim_to_batch_and_zero_pad": 1.0062843251881095e-05, "general_advantage_estimation": 0.0063525718687013, "batch_individual_items": 0.03170222446709834}}, "connector_pipeline_timer": 0.0811690572522858}, "num_module_steps_trained": 6000, "num_trainable_parameters": 6003, "num_module_steps_trained_lifetime": 36000, "learner_connector_sum_episodes_length_out": 5250.0, "num_env_steps_trained_lifetime": 189000, "num_env_steps_trained": 31500, "learner_connector_sum_episodes_length_in": 5000.0, "num_non_trainable_parameters": 0, "num_env_steps_trained_lifetime_throughput": 2358910.0058972635, "num_module_steps_trained_throughput": 451704.70770021225, "num_module_steps_trained_lifetime_throughput": 450878.02556481294}, "default_policy": {"module_train_batch_size_mean": 1000.0, "entropy": 0.6058812141418457, "mean_kl_loss": 0.0003197113692294806, "policy_loss": -0.2018829733133316, "default_optimizer_learning_rate": 0.0002847858517, "total_loss": -0.1386224329471588, "gradients_default_optimizer_global_norm": 0.044034115970134735, "diff_num_grad_updates_vs_sampler_policy": 1.0, "num_module_steps_trained": 6000, "num_trainable_parameters": 6003, "num_module_steps_trained_lifetime": 36000, "vf_loss_unclipped": 28.01873207092285, "vf_explained_var": -0.0063784122467041016, "curr_entropy_coeff": 0.0090570820258, "curr_kl_coeff": 0.011664004996418953, "weights_seq_no": 6.0, "vf_loss": 0.10278083384037018, "num_module_steps_trained_lifetime_throughput": 452695.7607800148}}, "num_training_step_calls_per_iteration": 1, "evaluation": {"env_runners": {"env_to_module_connector": {"timers": {"connectors": {"add_time_dim_to_batch_and_zero_pad": 2.2673700474913655e-06, "batch_individual_items": 6.110990300382016e-06, "numpy_to_tensor": 8.199252315832958e-06, "add_observations_from_episodes_to_batch": 2.7432189889537647e-06, "add_states_from_episodes_to_batch": 1.633636234460312e-06}}, "connector_pipeline_timer": 4.237138896463502e-05}, "module_episode_returns_mean": {"default_policy": -1.0}, "num_module_steps_sampled_lifetime": {"default_policy": 2400}, "episode_return_mean": -1.0, "env_step_timer": 1.3738763399032041e-05, "num_module_steps_sampled": {"default_policy": 400}, "episode_len_mean": 20.0, "module_to_env_connector": {"timers": {"connectors": {"normalize_and_clip_actions": 9.263434430808531e-06, "listify_data_for_vector_env": 1.0757646545329702e-05, "get_actions": 3.461339905163087e-05, "remove_single_ts_time_rank_from_batch": 5.656005077565541e-07, "tensor_to_numpy": 1.2657793455216692e-05, "un_batch_to_individual_items": 5.306044003020711e-06}}, "connector_pipeline_timer": 9.845904310607325e-05}, "num_env_steps_sampled": 400, "num_episodes_lifetime": 120, "sample": 0.09862040839545519, "episode_duration_sec_mean": 0.004473757556406781, "num_env_steps_sampled_lifetime": 30400, "agent_episode_returns_mean": {"default_agent": -1.0}, "env_reset_timer": 0.0001430054724648565, "rlmodule_inference_timer": 2.7189756802265977e-05, "num_agent_steps_sampled_lifetime": {"default_agent": 2400}, "episode_len_min": 20, "weights_seq_no": 6.0, "env_to_module_sum_episodes_length_out": 10.368238394470474, "num_agent_steps_sampled": {"default_agent": 400}, "env_to_module_sum_episodes_length_in": 10.368238394470474, "episode_len_max": 20, "episode_return_min": -14.5, "num_episodes": 20, "episode_return_max": 14.5, "time_between_sampling": 1.6045443976033573}, "num_healthy_workers": 1, "actor_manager_num_outstanding_async_reqs": 0, "num_remote_worker_restarts": 0}, "num_env_steps_sampled_lifetime": -2460000.0, "fault_tolerance": {"num_healthy_workers": 0, "num_remote_worker_restarts": 0}, "env_runner_group": {"actor_manager_num_outstanding_async_reqs": 0}, "done": false, "training_iteration": 6, "trial_id": "43aed_00000", "date": "2025-08-11_19-23-09", "timestamp": 1754932989, "time_this_iter_s": 1.653252124786377, "time_total_s": 9.896791934967041, "pid": 14402, "hostname": "Mac", "node_ip": "127.0.0.1", "config": {"exploration_config": {}, "extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "placement_strategy": "PACK", "num_gpus": 0, "_fake_gpus": false, "num_cpus_for_main_process": 2, "eager_tracing": true, "eager_max_retraces": 20, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "torch_compile_learner": false, "torch_compile_learner_what_to_compile": "forward_train", "torch_compile_learner_dynamo_backend": "aot_eager", "torch_compile_learner_dynamo_mode": null, "torch_compile_worker": false, "torch_compile_worker_dynamo_backend": "aot_eager", "torch_compile_worker_dynamo_mode": null, "torch_ddp_kwargs": {}, "torch_skip_nan_gradients": false, "env": "Umbrella", "env_config": {}, "observation_space": null, "action_space": null, "clip_rewards": null, "normalize_actions": true, "clip_actions": false, "_is_atari": null, "disable_env_checking": false, "render_env": false, "action_mask_key": "action_mask", "env_runner_cls": null, "num_env_runners": 0, "create_local_env_runner": true, "num_envs_per_env_runner": 1, "gym_env_vectorize_mode": "SYNC", "num_cpus_per_env_runner": 1, "num_gpus_per_env_runner": 0, "custom_resources_per_env_runner": {}, "validate_env_runners_after_construction": true, "episodes_to_numpy": true, "max_requests_in_flight_per_env_runner": 1, "sample_timeout_s": 60.0, "_env_to_module_connector": null, "add_default_connectors_to_env_to_module_pipeline": true, "_module_to_env_connector": null, "add_default_connectors_to_module_to_env_pipeline": true, "merge_env_runner_states": "training_only", "broadcast_env_runner_states": true, "episode_lookback_horizon": 1, "rollout_fragment_length": "auto", "batch_mode": "complete_episodes", "compress_observations": false, "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "enable_tf1_exec_eagerly": false, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "preprocessor_pref": "deepmind", "observation_filter": "NoFilter", "update_worker_filter_stats": true, "use_worker_filter_stats": true, "sampler_perf_stats_ema_coef": null, "_is_online": true, "num_learners": 0, "num_gpus_per_learner": 0, "num_cpus_per_learner": "auto", "num_aggregator_actors_per_learner": 0, "max_requests_in_flight_per_aggregator_actor": 3, "local_gpu_idx": 0, "max_requests_in_flight_per_learner": 3, "gamma": 1, "lr": 0.0002847858517, "grad_clip": 0.5, "grad_clip_by": "global_norm", "_train_batch_size_per_learner": 5000, "train_batch_size": 4000, "num_epochs": 1, "minibatch_size": 1000, "shuffle_batch_per_epoch": true, "model": {"fcnet_hiddens": [256, 256], "fcnet_activation": "tanh", "fcnet_weights_initializer": null, "fcnet_weights_initializer_config": null, "fcnet_bias_initializer": null, "fcnet_bias_initializer_config": null, "conv_filters": null, "conv_activation": "relu", "conv_kernel_initializer": null, "conv_kernel_initializer_config": null, "conv_bias_initializer": null, "conv_bias_initializer_config": null, "conv_transpose_kernel_initializer": null, "conv_transpose_kernel_initializer_config": null, "conv_transpose_bias_initializer": null, "conv_transpose_bias_initializer_config": null, "post_fcnet_hiddens": [], "post_fcnet_activation": "relu", "post_fcnet_weights_initializer": null, "post_fcnet_weights_initializer_config": null, "post_fcnet_bias_initializer": null, "post_fcnet_bias_initializer_config": null, "free_log_std": false, "log_std_clip_param": 20.0, "no_final_linear": false, "vf_share_layers": false, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "lstm_weights_initializer": null, "lstm_weights_initializer_config": null, "lstm_bias_initializer": null, "lstm_bias_initializer_config": null, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "attention_use_n_prev_actions": 0, "attention_use_n_prev_rewards": 0, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": null, "custom_model_config": {}, "custom_action_dist": null, "custom_preprocessor": null, "encoder_latent_dim": null, "always_check_shapes": false, "lstm_use_prev_action_reward": -1, "_use_default_native_models": -1, "_disable_preprocessor_api": false, "_disable_action_flattening": false}, "_learner_connector": null, "add_default_connectors_to_learner_pipeline": true, "learner_config_dict": {}, "optimizer": {}, "_learner_class": null, "callbacks_on_algorithm_init": null, "callbacks_on_env_runners_recreated": null, "callbacks_on_offline_eval_runners_recreated": null, "callbacks_on_checkpoint_loaded": null, "callbacks_on_environment_created": null, "callbacks_on_episode_created": null, "callbacks_on_episode_start": null, "callbacks_on_episode_step": null, "callbacks_on_episode_end": null, "callbacks_on_evaluate_start": null, "callbacks_on_evaluate_end": null, "callbacks_on_evaluate_offline_start": null, "callbacks_on_evaluate_offline_end": null, "callbacks_on_sample_end": null, "callbacks_on_train_result": null, "explore": true, "enable_rl_module_and_learner": true, "enable_env_runner_and_connector_v2": true, "_prior_exploration_config": {"type": "StochasticSampling"}, "count_steps_by": "env_steps", "policy_map_capacity": 100, "policy_mapping_fn": "<function AlgorithmConfig.DEFAULT_POLICY_MAPPING_FN at 0x3881edb20>", "policies_to_train": null, "policy_states_are_swappable": false, "observation_fn": null, "offline_data_class": null, "input_read_method": "read_parquet", "input_read_method_kwargs": {}, "input_read_schema": {}, "input_read_episodes": false, "input_read_sample_batches": false, "input_read_batch_size": null, "input_filesystem": null, "input_filesystem_kwargs": {}, "input_compress_columns": ["obs", "new_obs"], "input_spaces_jsonable": true, "materialize_data": false, "materialize_mapped_data": true, "map_batches_kwargs": {}, "iter_batches_kwargs": {}, "ignore_final_observation": false, "prelearner_class": null, "prelearner_buffer_class": null, "prelearner_buffer_kwargs": {}, "prelearner_module_synch_period": 10, "dataset_num_iters_per_learner": null, "input_config": {}, "actions_in_input_normalized": false, "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_config": {}, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "output_max_rows_per_file": null, "output_write_remaining_data": false, "output_write_method": "write_parquet", "output_write_method_kwargs": {}, "output_filesystem": null, "output_filesystem_kwargs": {}, "output_write_episodes": true, "offline_sampling": false, "evaluation_interval": 1, "evaluation_duration": 20, "evaluation_duration_unit": "episodes", "evaluation_sample_timeout_s": 120.0, "evaluation_auto_duration_min_env_steps_per_sample": 100, "evaluation_auto_duration_max_env_steps_per_sample": 2000, "evaluation_parallel_to_training": false, "evaluation_force_reset_envs_before_iteration": true, "evaluation_config": null, "off_policy_estimation_methods": {}, "ope_split_batch_by_episode": true, "evaluation_num_env_runners": 1, "in_evaluation": false, "sync_filters_on_rollout_workers_timeout_s": 10.0, "offline_evaluation_interval": null, "num_offline_eval_runners": 0, "offline_loss_for_module_fn": null, "offline_evaluation_duration": 1, "offline_evaluation_parallel_to_training": false, "offline_evaluation_timeout_s": 120.0, "num_cpus_per_offline_eval_runner": 1, "num_gpus_per_offline_eval_runner": 0, "custom_resources_per_offline_eval_runner": {}, "restart_failed_offline_eval_runners": true, "ignore_offline_eval_runner_failures": false, "max_num_offline_eval_runner_restarts": 1000, "offline_eval_runner_restore_timeout_s": 1800.0, "max_requests_in_flight_per_offline_eval_runner": 1, "validate_offline_eval_runners_after_construction": true, "offline_eval_runner_health_probe_timeout_s": 30.0, "offline_eval_rl_module_inference_only": false, "broadcast_offline_eval_runner_states": false, "offline_eval_batch_size_per_runner": 256, "dataset_num_iters_per_eval_runner": 1, "keep_per_episode_custom_metrics": false, "metrics_episode_collection_timeout_s": 60.0, "metrics_num_episodes_for_smoothing": 100, "min_time_s_per_iteration": null, "min_train_timesteps_per_iteration": 0, "min_sample_timesteps_per_iteration": 0, "log_gradients": true, "export_native_model_files": false, "checkpoint_trainable_policies_only": false, "logger_creator": null, "logger_config": null, "log_level": "WARN", "log_sys_usage": true, "fake_sampler": false, "seed": 2, "restart_failed_env_runners": true, "ignore_env_runner_failures": false, "max_num_env_runner_restarts": 1000, "delay_between_env_runner_restarts_s": 60.0, "restart_failed_sub_environments": false, "num_consecutive_env_runner_failures_tolerance": 100, "env_runner_health_probe_timeout_s": 30.0, "env_runner_restore_timeout_s": 1800.0, "_model_config": {}, "_rl_module_spec": "RLModuleSpec(module_class=None, observation_space=None, action_space=None, inference_only=False, learner_only=False, model_config=DefaultModelConfig(fcnet_hiddens=[60, 90], fcnet_activation='tanh', fcnet_kernel_initializer=None, fcnet_kernel_initializer_kwargs=None, fcnet_bias_initializer=None, fcnet_bias_initializer_kwargs=None, conv_filters=None, conv_activation='relu', conv_kernel_initializer=None, conv_kernel_initializer_kwargs=None, conv_bias_initializer=None, conv_bias_initializer_kwargs=None, head_fcnet_hiddens=[], head_fcnet_activation='relu', head_fcnet_kernel_initializer=None, head_fcnet_kernel_initializer_kwargs=None, head_fcnet_bias_initializer=None, head_fcnet_bias_initializer_kwargs=None, free_log_std=False, log_std_clip_param=20.0, vf_share_layers=True, use_lstm=False, max_seq_len=20, lstm_cell_size=256, lstm_use_prev_action=False, lstm_use_prev_reward=False, lstm_kernel_initializer=None, lstm_kernel_initializer_kwargs=None, lstm_bias_initializer=None, lstm_bias_initializer_kwargs=None), catalog_class=None, load_state_path=None, model_config_dict=None)", "algorithm_config_overrides_per_module": {}, "_per_module_overrides": {}, "_validate_config": true, "_use_msgpack_checkpoints": false, "_torch_grad_scaler_class": null, "_torch_lr_scheduler_classes": null, "_tf_policy_handles_more_than_one_loss": false, "_disable_preprocessor_api": false, "_disable_action_flattening": false, "_disable_initialize_loss_from_dummy_batch": false, "_dont_auto_sync_env_runner_states": false, "env_task_fn": -1, "enable_connectors": -1, "simple_optimizer": false, "policy_map_cache": -1, "worker_cls": -1, "synchronize_filters": -1, "enable_async_evaluation": -1, "custom_async_evaluation_function": -1, "_enable_rl_module_api": -1, "auto_wrap_old_gym_envs": -1, "always_attach_evaluation_results": -1, "replay_sequence_length": null, "_disable_execution_plan_api": -1, "use_critic": true, "use_gae": true, "use_kl_loss": true, "kl_coeff": 0.7464963036515, "kl_target": 0.0270990929592, "vf_loss_coeff": 0.6688075857018, "entropy_coeff": 0.0090570820258, "clip_param": 0.1221781641624, "vf_clip_param": 0.1027808522125, "entropy_coeff_schedule": null, "lr_schedule": null, "sgd_minibatch_size": -1, "vf_share_layers": -1, "__stdout_file__": null, "__stderr_file__": null, "lambda": 0.9099046732075, "input": "sampler", "policies": {"default_policy": [null, null, null, null]}, "callbacks": "<class 'ray.rllib.callbacks.callbacks.RLlibCallback'>", "create_env_on_driver": false, "custom_eval_function": null, "framework": "torch"}, "time_since_restore": 9.896791934967041, "iterations_since_restore": 6, "perf": {"cpu_util_percent": 39.43333333333333, "ram_util_percent": 78.26666666666667}}
{"timers": {"training_iteration": 1.5492440197942015, "restore_env_runners": 1.1798682840480875e-05, "training_step": 1.5491081713061676, "env_runner_sampling_timer": 1.4410562155503053, "learner_update_timer": 0.1050305079955279, "synch_weights": 0.0005500576909146075, "restore_eval_env_runners": 7.920229038772129e-06, "evaluation_iteration": 0.10481235308424418, "synch_eval_env_connectors": 0.00021331871776000724, "synch_env_connectors": 4.28733741910723e-06}, "env_runners": {"num_module_steps_sampled_lifetime": {"default_policy": -3077500.0}, "num_env_steps_sampled_lifetime": -3077500.0, "episode_len_mean": 20.0, "env_to_module_connector": {"timers": {"connectors": {"add_time_dim_to_batch_and_zero_pad": 2.4100173307035153e-06, "add_observations_from_episodes_to_batch": 2.984096961677287e-06, "add_states_from_episodes_to_batch": 1.7005697099838815e-06, "numpy_to_tensor": 8.441050396079238e-06, "batch_individual_items": 6.237974416503719e-06}}, "connector_pipeline_timer": 4.338590354787267e-05}, "weights_seq_no": 6.0, "episode_len_min": 20, "num_agent_steps_sampled_lifetime": {"default_agent": -3077500.0}, "module_to_env_connector": {"connector_pipeline_timer": 0.00010329976816391818, "timers": {"connectors": {"tensor_to_numpy": 1.3071179934809391e-05, "listify_data_for_vector_env": 1.0823622894700085e-05, "get_actions": 3.85046883780456e-05, "un_batch_to_individual_items": 5.351230869992772e-06, "normalize_and_clip_actions": 9.34466900211211e-06, "remove_single_ts_time_rank_from_batch": 6.06328320287198e-07}}}, "env_reset_timer": 3.2299127754670494e-05, "env_to_module_sum_episodes_length_out": 10.36823839457432, "env_to_module_sum_episodes_length_in": 10.36823839457432, "num_module_steps_sampled": {"default_policy": 5000.0}, "episode_return_mean": 2.259999999999999, "episode_len_max": 20, "num_env_steps_sampled": 5000.0, "num_episodes_lifetime": -153875.0, "agent_episode_returns_mean": {"default_agent": 2.259999999999999}, "episode_return_min": -11.5, "sample": 0.0048417503648806315, "num_episodes": 250.0, "num_agent_steps_sampled": {"default_agent": 5000.0}, "rlmodule_inference_timer": 2.7375634595838312e-05, "module_episode_returns_mean": {"default_policy": 2.259999999999999}, "episode_return_max": 8.5, "env_step_timer": 1.3691650857787214e-05, "time_between_sampling": 0.0018076213856173355, "episode_duration_sec_mean": 0.004519607864320277, "num_env_steps_sampled_lifetime_throughput": 3755.305096682307}, "learners": {"__all_modules__": {"learner_connector": {"timers": {"connectors": {"numpy_to_tensor": 5.796057021776484e-05, "add_observations_from_episodes_to_batch": 0.0008139640958063311, "add_one_ts_to_episodes_and_truncate": 0.0075728253335867746, "add_states_from_episodes_to_batch": 2.8510856656934876e-06, "add_columns_from_episodes_to_train_batch": 0.03454431193949246, "add_time_dim_to_batch_and_zero_pad": 1.0043464564924956e-05, "general_advantage_estimation": 0.006341229070058575, "batch_individual_items": 0.031682569312088196}}, "connector_pipeline_timer": 0.0811391670902404}, "num_module_steps_trained": 6000, "num_trainable_parameters": 6003, "num_module_steps_trained_lifetime": 42000, "learner_connector_sum_episodes_length_out": 5250.0, "num_env_steps_trained_lifetime": 220500, "num_env_steps_trained": 31500, "learner_connector_sum_episodes_length_in": 5000.0, "num_non_trainable_parameters": 0, "num_env_steps_trained_lifetime_throughput": 2356295.818472788, "num_module_steps_trained_throughput": 451121.5592915804, "num_module_steps_trained_lifetime_throughput": 450320.64688654226}, "default_policy": {"module_train_batch_size_mean": 1000.0, "entropy": 0.5972712635993958, "mean_kl_loss": 0.00020801420032512397, "policy_loss": -0.02636248804628849, "default_optimizer_learning_rate": 0.0002847858517, "total_loss": 0.03697100281715393, "gradients_default_optimizer_global_norm": 0.013988404534757137, "diff_num_grad_updates_vs_sampler_policy": 1.0, "num_module_steps_trained": 6000, "num_trainable_parameters": 6003, "num_module_steps_trained_lifetime": 42000, "vf_loss_unclipped": 28.27447509765625, "vf_explained_var": -0.008970975875854492, "curr_entropy_coeff": 0.0090570820258, "curr_kl_coeff": 0.0058320024982094765, "weights_seq_no": 7.0, "vf_loss": 0.10278083384037018, "num_module_steps_trained_lifetime_throughput": 452044.24571378133}}, "num_training_step_calls_per_iteration": 1, "evaluation": {"env_runners": {"env_to_module_connector": {"timers": {"connectors": {"add_time_dim_to_batch_and_zero_pad": 2.219807492547259e-06, "batch_individual_items": 6.018433172706201e-06, "numpy_to_tensor": 8.176952526201714e-06, "add_observations_from_episodes_to_batch": 2.772272695496193e-06, "add_states_from_episodes_to_batch": 1.6201313940413957e-06}}, "connector_pipeline_timer": 4.196179408926781e-05}, "module_episode_returns_mean": {"default_policy": -1.0}, "num_module_steps_sampled_lifetime": {"default_policy": 2800}, "episode_return_mean": -1.0, "env_step_timer": 1.3580990502756008e-05, "num_module_steps_sampled": {"default_policy": 400}, "episode_len_mean": 20.0, "module_to_env_connector": {"timers": {"connectors": {"normalize_and_clip_actions": 9.274616646795803e-06, "listify_data_for_vector_env": 1.0594024991464822e-05, "get_actions": 3.4484382471949976e-05, "remove_single_ts_time_rank_from_batch": 5.681775977023094e-07, "tensor_to_numpy": 1.262904995108109e-05, "un_batch_to_individual_items": 5.303949096432116e-06}}, "connector_pipeline_timer": 9.800591314393195e-05}, "num_env_steps_sampled": 400, "num_episodes_lifetime": 140, "sample": 0.0985972839009197, "episode_duration_sec_mean": 0.004457883427385241, "num_env_steps_sampled_lifetime": 35400, "agent_episode_returns_mean": {"default_agent": -1.0}, "env_reset_timer": 0.0001422787572051704, "rlmodule_inference_timer": 2.7019203996680262e-05, "num_agent_steps_sampled_lifetime": {"default_agent": 2800}, "episode_len_min": 20, "weights_seq_no": 7.0, "env_to_module_sum_episodes_length_out": 10.368238394572801, "num_agent_steps_sampled": {"default_agent": 400}, "env_to_module_sum_episodes_length_in": 10.368238394572801, "episode_len_max": 20, "episode_return_min": -14.5, "num_episodes": 20, "episode_return_max": 14.5, "time_between_sampling": 1.60329194112671}, "num_healthy_workers": 1, "actor_manager_num_outstanding_async_reqs": 0, "num_remote_worker_restarts": 0}, "num_env_steps_sampled_lifetime": -3077500.0, "fault_tolerance": {"num_healthy_workers": 0, "num_remote_worker_restarts": 0}, "env_runner_group": {"actor_manager_num_outstanding_async_reqs": 0}, "done": false, "training_iteration": 7, "trial_id": "43aed_00000", "date": "2025-08-11_19-23-11", "timestamp": 1754932991, "time_this_iter_s": 1.5657341480255127, "time_total_s": 11.462526082992554, "pid": 14402, "hostname": "Mac", "node_ip": "127.0.0.1", "config": {"exploration_config": {}, "extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "placement_strategy": "PACK", "num_gpus": 0, "_fake_gpus": false, "num_cpus_for_main_process": 2, "eager_tracing": true, "eager_max_retraces": 20, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "torch_compile_learner": false, "torch_compile_learner_what_to_compile": "forward_train", "torch_compile_learner_dynamo_backend": "aot_eager", "torch_compile_learner_dynamo_mode": null, "torch_compile_worker": false, "torch_compile_worker_dynamo_backend": "aot_eager", "torch_compile_worker_dynamo_mode": null, "torch_ddp_kwargs": {}, "torch_skip_nan_gradients": false, "env": "Umbrella", "env_config": {}, "observation_space": null, "action_space": null, "clip_rewards": null, "normalize_actions": true, "clip_actions": false, "_is_atari": null, "disable_env_checking": false, "render_env": false, "action_mask_key": "action_mask", "env_runner_cls": null, "num_env_runners": 0, "create_local_env_runner": true, "num_envs_per_env_runner": 1, "gym_env_vectorize_mode": "SYNC", "num_cpus_per_env_runner": 1, "num_gpus_per_env_runner": 0, "custom_resources_per_env_runner": {}, "validate_env_runners_after_construction": true, "episodes_to_numpy": true, "max_requests_in_flight_per_env_runner": 1, "sample_timeout_s": 60.0, "_env_to_module_connector": null, "add_default_connectors_to_env_to_module_pipeline": true, "_module_to_env_connector": null, "add_default_connectors_to_module_to_env_pipeline": true, "merge_env_runner_states": "training_only", "broadcast_env_runner_states": true, "episode_lookback_horizon": 1, "rollout_fragment_length": "auto", "batch_mode": "complete_episodes", "compress_observations": false, "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "enable_tf1_exec_eagerly": false, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "preprocessor_pref": "deepmind", "observation_filter": "NoFilter", "update_worker_filter_stats": true, "use_worker_filter_stats": true, "sampler_perf_stats_ema_coef": null, "_is_online": true, "num_learners": 0, "num_gpus_per_learner": 0, "num_cpus_per_learner": "auto", "num_aggregator_actors_per_learner": 0, "max_requests_in_flight_per_aggregator_actor": 3, "local_gpu_idx": 0, "max_requests_in_flight_per_learner": 3, "gamma": 1, "lr": 0.0002847858517, "grad_clip": 0.5, "grad_clip_by": "global_norm", "_train_batch_size_per_learner": 5000, "train_batch_size": 4000, "num_epochs": 1, "minibatch_size": 1000, "shuffle_batch_per_epoch": true, "model": {"fcnet_hiddens": [256, 256], "fcnet_activation": "tanh", "fcnet_weights_initializer": null, "fcnet_weights_initializer_config": null, "fcnet_bias_initializer": null, "fcnet_bias_initializer_config": null, "conv_filters": null, "conv_activation": "relu", "conv_kernel_initializer": null, "conv_kernel_initializer_config": null, "conv_bias_initializer": null, "conv_bias_initializer_config": null, "conv_transpose_kernel_initializer": null, "conv_transpose_kernel_initializer_config": null, "conv_transpose_bias_initializer": null, "conv_transpose_bias_initializer_config": null, "post_fcnet_hiddens": [], "post_fcnet_activation": "relu", "post_fcnet_weights_initializer": null, "post_fcnet_weights_initializer_config": null, "post_fcnet_bias_initializer": null, "post_fcnet_bias_initializer_config": null, "free_log_std": false, "log_std_clip_param": 20.0, "no_final_linear": false, "vf_share_layers": false, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "lstm_weights_initializer": null, "lstm_weights_initializer_config": null, "lstm_bias_initializer": null, "lstm_bias_initializer_config": null, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "attention_use_n_prev_actions": 0, "attention_use_n_prev_rewards": 0, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": null, "custom_model_config": {}, "custom_action_dist": null, "custom_preprocessor": null, "encoder_latent_dim": null, "always_check_shapes": false, "lstm_use_prev_action_reward": -1, "_use_default_native_models": -1, "_disable_preprocessor_api": false, "_disable_action_flattening": false}, "_learner_connector": null, "add_default_connectors_to_learner_pipeline": true, "learner_config_dict": {}, "optimizer": {}, "_learner_class": null, "callbacks_on_algorithm_init": null, "callbacks_on_env_runners_recreated": null, "callbacks_on_offline_eval_runners_recreated": null, "callbacks_on_checkpoint_loaded": null, "callbacks_on_environment_created": null, "callbacks_on_episode_created": null, "callbacks_on_episode_start": null, "callbacks_on_episode_step": null, "callbacks_on_episode_end": null, "callbacks_on_evaluate_start": null, "callbacks_on_evaluate_end": null, "callbacks_on_evaluate_offline_start": null, "callbacks_on_evaluate_offline_end": null, "callbacks_on_sample_end": null, "callbacks_on_train_result": null, "explore": true, "enable_rl_module_and_learner": true, "enable_env_runner_and_connector_v2": true, "_prior_exploration_config": {"type": "StochasticSampling"}, "count_steps_by": "env_steps", "policy_map_capacity": 100, "policy_mapping_fn": "<function AlgorithmConfig.DEFAULT_POLICY_MAPPING_FN at 0x3881edb20>", "policies_to_train": null, "policy_states_are_swappable": false, "observation_fn": null, "offline_data_class": null, "input_read_method": "read_parquet", "input_read_method_kwargs": {}, "input_read_schema": {}, "input_read_episodes": false, "input_read_sample_batches": false, "input_read_batch_size": null, "input_filesystem": null, "input_filesystem_kwargs": {}, "input_compress_columns": ["obs", "new_obs"], "input_spaces_jsonable": true, "materialize_data": false, "materialize_mapped_data": true, "map_batches_kwargs": {}, "iter_batches_kwargs": {}, "ignore_final_observation": false, "prelearner_class": null, "prelearner_buffer_class": null, "prelearner_buffer_kwargs": {}, "prelearner_module_synch_period": 10, "dataset_num_iters_per_learner": null, "input_config": {}, "actions_in_input_normalized": false, "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_config": {}, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "output_max_rows_per_file": null, "output_write_remaining_data": false, "output_write_method": "write_parquet", "output_write_method_kwargs": {}, "output_filesystem": null, "output_filesystem_kwargs": {}, "output_write_episodes": true, "offline_sampling": false, "evaluation_interval": 1, "evaluation_duration": 20, "evaluation_duration_unit": "episodes", "evaluation_sample_timeout_s": 120.0, "evaluation_auto_duration_min_env_steps_per_sample": 100, "evaluation_auto_duration_max_env_steps_per_sample": 2000, "evaluation_parallel_to_training": false, "evaluation_force_reset_envs_before_iteration": true, "evaluation_config": null, "off_policy_estimation_methods": {}, "ope_split_batch_by_episode": true, "evaluation_num_env_runners": 1, "in_evaluation": false, "sync_filters_on_rollout_workers_timeout_s": 10.0, "offline_evaluation_interval": null, "num_offline_eval_runners": 0, "offline_loss_for_module_fn": null, "offline_evaluation_duration": 1, "offline_evaluation_parallel_to_training": false, "offline_evaluation_timeout_s": 120.0, "num_cpus_per_offline_eval_runner": 1, "num_gpus_per_offline_eval_runner": 0, "custom_resources_per_offline_eval_runner": {}, "restart_failed_offline_eval_runners": true, "ignore_offline_eval_runner_failures": false, "max_num_offline_eval_runner_restarts": 1000, "offline_eval_runner_restore_timeout_s": 1800.0, "max_requests_in_flight_per_offline_eval_runner": 1, "validate_offline_eval_runners_after_construction": true, "offline_eval_runner_health_probe_timeout_s": 30.0, "offline_eval_rl_module_inference_only": false, "broadcast_offline_eval_runner_states": false, "offline_eval_batch_size_per_runner": 256, "dataset_num_iters_per_eval_runner": 1, "keep_per_episode_custom_metrics": false, "metrics_episode_collection_timeout_s": 60.0, "metrics_num_episodes_for_smoothing": 100, "min_time_s_per_iteration": null, "min_train_timesteps_per_iteration": 0, "min_sample_timesteps_per_iteration": 0, "log_gradients": true, "export_native_model_files": false, "checkpoint_trainable_policies_only": false, "logger_creator": null, "logger_config": null, "log_level": "WARN", "log_sys_usage": true, "fake_sampler": false, "seed": 2, "restart_failed_env_runners": true, "ignore_env_runner_failures": false, "max_num_env_runner_restarts": 1000, "delay_between_env_runner_restarts_s": 60.0, "restart_failed_sub_environments": false, "num_consecutive_env_runner_failures_tolerance": 100, "env_runner_health_probe_timeout_s": 30.0, "env_runner_restore_timeout_s": 1800.0, "_model_config": {}, "_rl_module_spec": "RLModuleSpec(module_class=None, observation_space=None, action_space=None, inference_only=False, learner_only=False, model_config=DefaultModelConfig(fcnet_hiddens=[60, 90], fcnet_activation='tanh', fcnet_kernel_initializer=None, fcnet_kernel_initializer_kwargs=None, fcnet_bias_initializer=None, fcnet_bias_initializer_kwargs=None, conv_filters=None, conv_activation='relu', conv_kernel_initializer=None, conv_kernel_initializer_kwargs=None, conv_bias_initializer=None, conv_bias_initializer_kwargs=None, head_fcnet_hiddens=[], head_fcnet_activation='relu', head_fcnet_kernel_initializer=None, head_fcnet_kernel_initializer_kwargs=None, head_fcnet_bias_initializer=None, head_fcnet_bias_initializer_kwargs=None, free_log_std=False, log_std_clip_param=20.0, vf_share_layers=True, use_lstm=False, max_seq_len=20, lstm_cell_size=256, lstm_use_prev_action=False, lstm_use_prev_reward=False, lstm_kernel_initializer=None, lstm_kernel_initializer_kwargs=None, lstm_bias_initializer=None, lstm_bias_initializer_kwargs=None), catalog_class=None, load_state_path=None, model_config_dict=None)", "algorithm_config_overrides_per_module": {}, "_per_module_overrides": {}, "_validate_config": true, "_use_msgpack_checkpoints": false, "_torch_grad_scaler_class": null, "_torch_lr_scheduler_classes": null, "_tf_policy_handles_more_than_one_loss": false, "_disable_preprocessor_api": false, "_disable_action_flattening": false, "_disable_initialize_loss_from_dummy_batch": false, "_dont_auto_sync_env_runner_states": false, "env_task_fn": -1, "enable_connectors": -1, "simple_optimizer": false, "policy_map_cache": -1, "worker_cls": -1, "synchronize_filters": -1, "enable_async_evaluation": -1, "custom_async_evaluation_function": -1, "_enable_rl_module_api": -1, "auto_wrap_old_gym_envs": -1, "always_attach_evaluation_results": -1, "replay_sequence_length": null, "_disable_execution_plan_api": -1, "use_critic": true, "use_gae": true, "use_kl_loss": true, "kl_coeff": 0.7464963036515, "kl_target": 0.0270990929592, "vf_loss_coeff": 0.6688075857018, "entropy_coeff": 0.0090570820258, "clip_param": 0.1221781641624, "vf_clip_param": 0.1027808522125, "entropy_coeff_schedule": null, "lr_schedule": null, "sgd_minibatch_size": -1, "vf_share_layers": -1, "__stdout_file__": null, "__stderr_file__": null, "lambda": 0.9099046732075, "input": "sampler", "policies": {"default_policy": [null, null, null, null]}, "callbacks": "<class 'ray.rllib.callbacks.callbacks.RLlibCallback'>", "create_env_on_driver": false, "custom_eval_function": null, "framework": "torch"}, "time_since_restore": 11.462526082992554, "iterations_since_restore": 7, "perf": {"cpu_util_percent": 41.0, "ram_util_percent": 78.5}}
{"timers": {"training_iteration": 1.549081684596435, "restore_env_runners": 1.1735695266719984e-05, "training_step": 1.5489457012524577, "env_runner_sampling_timer": 1.4410220517349026, "learner_update_timer": 0.1048996433345201, "synch_weights": 0.0005501183647330851, "restore_eval_env_runners": 7.908946939597894e-06, "evaluation_iteration": 0.10477636080386517, "synch_eval_env_connectors": 0.00021211428037841025, "synch_env_connectors": 4.283623830872302e-06}, "env_runners": {"num_module_steps_sampled_lifetime": {"default_policy": -3695000.0}, "num_env_steps_sampled_lifetime": -3695000.0, "episode_len_mean": 20.0, "env_to_module_connector": {"timers": {"connectors": {"add_time_dim_to_batch_and_zero_pad": 2.390051880464277e-06, "add_observations_from_episodes_to_batch": 3.0313585694734887e-06, "add_states_from_episodes_to_batch": 1.6992298427396133e-06, "numpy_to_tensor": 8.303998807706019e-06, "batch_individual_items": 6.143423311716654e-06}}, "connector_pipeline_timer": 4.3157990427602325e-05}, "weights_seq_no": 7.0, "episode_len_min": 20, "num_agent_steps_sampled_lifetime": {"default_agent": -3695000.0}, "module_to_env_connector": {"connector_pipeline_timer": 0.00010236081895112895, "timers": {"connectors": {"tensor_to_numpy": 1.2910647679338777e-05, "listify_data_for_vector_env": 1.0721884826800458e-05, "get_actions": 3.8110873329191055e-05, "un_batch_to_individual_items": 5.3333424800326796e-06, "normalize_and_clip_actions": 9.286101972120547e-06, "remove_single_ts_time_rank_from_batch": 5.978585869794543e-07}}}, "env_reset_timer": 3.1578687590197156e-05, "env_to_module_sum_episodes_length_out": 10.36823839457432, "env_to_module_sum_episodes_length_in": 10.36823839457432, "num_module_steps_sampled": {"default_policy": 5000.0}, "episode_return_mean": 2.899999999999998, "episode_len_max": 20, "num_env_steps_sampled": 5000.0, "num_episodes_lifetime": -184750.0, "agent_episode_returns_mean": {"default_agent": 2.899999999999998}, "episode_return_min": -11.5, "sample": 0.005063613250370828, "num_episodes": 250.0, "num_agent_steps_sampled": {"default_agent": 5000.0}, "rlmodule_inference_timer": 4.2166338970820064e-05, "module_episode_returns_mean": {"default_policy": 2.899999999999998}, "episode_return_max": 8.5, "env_step_timer": 1.3547832288804515e-05, "time_between_sampling": 0.0014934152839204508, "episode_duration_sec_mean": 0.004813088655471802, "num_env_steps_sampled_lifetime_throughput": 3770.8885349107118}, "learners": {"__all_modules__": {"learner_connector": {"timers": {"connectors": {"numpy_to_tensor": 5.7992214804371694e-05, "add_observations_from_episodes_to_batch": 0.0008169773651497296, "add_one_ts_to_episodes_and_truncate": 0.007574717500157359, "add_states_from_episodes_to_batch": 2.851325901068151e-06, "add_columns_from_episodes_to_train_batch": 0.034549414240176095, "add_time_dim_to_batch_and_zero_pad": 1.005886083618707e-05, "general_advantage_estimation": 0.0063289580290724085, "batch_individual_items": 0.031661961118966644}}, "connector_pipeline_timer": 0.08111616375890777}, "num_module_steps_trained": 6000, "num_trainable_parameters": 6003, "num_module_steps_trained_lifetime": 48000, "learner_connector_sum_episodes_length_out": 5250.0, "num_env_steps_trained_lifetime": 252000, "num_env_steps_trained": 31500, "learner_connector_sum_episodes_length_in": 5000.0, "num_non_trainable_parameters": 0, "num_env_steps_trained_lifetime_throughput": 2353902.6174525265, "num_module_steps_trained_throughput": 450580.08204806776, "num_module_steps_trained_lifetime_throughput": 449804.5781964408}, "default_policy": {"module_train_batch_size_mean": 1000.0, "entropy": 0.5958549976348877, "mean_kl_loss": 9.257249621441588e-05, "policy_loss": -0.07245510071516037, "default_optimizer_learning_rate": 0.0002847858517, "total_loss": -0.009110665880143642, "gradients_default_optimizer_global_norm": 0.025655152276158333, "diff_num_grad_updates_vs_sampler_policy": 1.0, "num_module_steps_trained": 6000, "num_trainable_parameters": 6003, "num_module_steps_trained_lifetime": 48000, "vf_loss_unclipped": 28.120574951171875, "vf_explained_var": -0.0067958831787109375, "curr_entropy_coeff": 0.0090570820258, "curr_kl_coeff": 0.0029160012491047382, "weights_seq_no": 8.0, "vf_loss": 0.10278083384037018, "num_module_steps_trained_lifetime_throughput": 451432.3487728237}}, "num_training_step_calls_per_iteration": 1, "evaluation": {"env_runners": {"env_to_module_connector": {"timers": {"connectors": {"add_time_dim_to_batch_and_zero_pad": 2.2344276609050214e-06, "batch_individual_items": 6.149863217761357e-06, "numpy_to_tensor": 8.31799846160528e-06, "add_observations_from_episodes_to_batch": 2.7946806083907487e-06, "add_states_from_episodes_to_batch": 1.6329351372966353e-06}}, "connector_pipeline_timer": 4.256632357037977e-05}, "module_episode_returns_mean": {"default_policy": -0.6}, "num_module_steps_sampled_lifetime": {"default_policy": 3200}, "episode_return_mean": -0.6, "env_step_timer": 1.3853352011561297e-05, "num_module_steps_sampled": {"default_policy": 400}, "episode_len_mean": 20.0, "module_to_env_connector": {"timers": {"connectors": {"normalize_and_clip_actions": 9.286926143987143e-06, "listify_data_for_vector_env": 1.0720833457149029e-05, "get_actions": 3.587521390016823e-05, "remove_single_ts_time_rank_from_batch": 5.625624978650467e-07, "tensor_to_numpy": 1.2981295013823881e-05, "un_batch_to_individual_items": 5.329636174497177e-06}}, "connector_pipeline_timer": 9.998728432753948e-05}, "num_env_steps_sampled": 400, "num_episodes_lifetime": 160, "sample": 0.09859151398194689, "episode_duration_sec_mean": 0.004472495516529307, "num_env_steps_sampled_lifetime": 40400, "agent_episode_returns_mean": {"default_agent": -0.6}, "env_reset_timer": 0.00014162389049786464, "rlmodule_inference_timer": 2.740833917562979e-05, "num_agent_steps_sampled_lifetime": {"default_agent": 3200}, "episode_len_min": 20, "weights_seq_no": 8.0, "env_to_module_sum_episodes_length_out": 10.3682383945743, "num_agent_steps_sampled": {"default_agent": 400}, "env_to_module_sum_episodes_length_in": 10.3682383945743, "episode_len_max": 20, "episode_return_min": -14.5, "num_episodes": 20, "episode_return_max": 14.5, "time_between_sampling": 1.602756254626154}, "num_healthy_workers": 1, "actor_manager_num_outstanding_async_reqs": 0, "num_remote_worker_restarts": 0}, "num_env_steps_sampled_lifetime": -3695000.0, "fault_tolerance": {"num_healthy_workers": 0, "num_remote_worker_restarts": 0}, "env_runner_group": {"actor_manager_num_outstanding_async_reqs": 0}, "done": false, "training_iteration": 8, "trial_id": "43aed_00000", "date": "2025-08-11_19-23-12", "timestamp": 1754932992, "time_this_iter_s": 1.638016939163208, "time_total_s": 13.100543022155762, "pid": 14402, "hostname": "Mac", "node_ip": "127.0.0.1", "config": {"exploration_config": {}, "extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "placement_strategy": "PACK", "num_gpus": 0, "_fake_gpus": false, "num_cpus_for_main_process": 2, "eager_tracing": true, "eager_max_retraces": 20, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "torch_compile_learner": false, "torch_compile_learner_what_to_compile": "forward_train", "torch_compile_learner_dynamo_backend": "aot_eager", "torch_compile_learner_dynamo_mode": null, "torch_compile_worker": false, "torch_compile_worker_dynamo_backend": "aot_eager", "torch_compile_worker_dynamo_mode": null, "torch_ddp_kwargs": {}, "torch_skip_nan_gradients": false, "env": "Umbrella", "env_config": {}, "observation_space": null, "action_space": null, "clip_rewards": null, "normalize_actions": true, "clip_actions": false, "_is_atari": null, "disable_env_checking": false, "render_env": false, "action_mask_key": "action_mask", "env_runner_cls": null, "num_env_runners": 0, "create_local_env_runner": true, "num_envs_per_env_runner": 1, "gym_env_vectorize_mode": "SYNC", "num_cpus_per_env_runner": 1, "num_gpus_per_env_runner": 0, "custom_resources_per_env_runner": {}, "validate_env_runners_after_construction": true, "episodes_to_numpy": true, "max_requests_in_flight_per_env_runner": 1, "sample_timeout_s": 60.0, "_env_to_module_connector": null, "add_default_connectors_to_env_to_module_pipeline": true, "_module_to_env_connector": null, "add_default_connectors_to_module_to_env_pipeline": true, "merge_env_runner_states": "training_only", "broadcast_env_runner_states": true, "episode_lookback_horizon": 1, "rollout_fragment_length": "auto", "batch_mode": "complete_episodes", "compress_observations": false, "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "enable_tf1_exec_eagerly": false, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "preprocessor_pref": "deepmind", "observation_filter": "NoFilter", "update_worker_filter_stats": true, "use_worker_filter_stats": true, "sampler_perf_stats_ema_coef": null, "_is_online": true, "num_learners": 0, "num_gpus_per_learner": 0, "num_cpus_per_learner": "auto", "num_aggregator_actors_per_learner": 0, "max_requests_in_flight_per_aggregator_actor": 3, "local_gpu_idx": 0, "max_requests_in_flight_per_learner": 3, "gamma": 1, "lr": 0.0002847858517, "grad_clip": 0.5, "grad_clip_by": "global_norm", "_train_batch_size_per_learner": 5000, "train_batch_size": 4000, "num_epochs": 1, "minibatch_size": 1000, "shuffle_batch_per_epoch": true, "model": {"fcnet_hiddens": [256, 256], "fcnet_activation": "tanh", "fcnet_weights_initializer": null, "fcnet_weights_initializer_config": null, "fcnet_bias_initializer": null, "fcnet_bias_initializer_config": null, "conv_filters": null, "conv_activation": "relu", "conv_kernel_initializer": null, "conv_kernel_initializer_config": null, "conv_bias_initializer": null, "conv_bias_initializer_config": null, "conv_transpose_kernel_initializer": null, "conv_transpose_kernel_initializer_config": null, "conv_transpose_bias_initializer": null, "conv_transpose_bias_initializer_config": null, "post_fcnet_hiddens": [], "post_fcnet_activation": "relu", "post_fcnet_weights_initializer": null, "post_fcnet_weights_initializer_config": null, "post_fcnet_bias_initializer": null, "post_fcnet_bias_initializer_config": null, "free_log_std": false, "log_std_clip_param": 20.0, "no_final_linear": false, "vf_share_layers": false, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "lstm_weights_initializer": null, "lstm_weights_initializer_config": null, "lstm_bias_initializer": null, "lstm_bias_initializer_config": null, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "attention_use_n_prev_actions": 0, "attention_use_n_prev_rewards": 0, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": null, "custom_model_config": {}, "custom_action_dist": null, "custom_preprocessor": null, "encoder_latent_dim": null, "always_check_shapes": false, "lstm_use_prev_action_reward": -1, "_use_default_native_models": -1, "_disable_preprocessor_api": false, "_disable_action_flattening": false}, "_learner_connector": null, "add_default_connectors_to_learner_pipeline": true, "learner_config_dict": {}, "optimizer": {}, "_learner_class": null, "callbacks_on_algorithm_init": null, "callbacks_on_env_runners_recreated": null, "callbacks_on_offline_eval_runners_recreated": null, "callbacks_on_checkpoint_loaded": null, "callbacks_on_environment_created": null, "callbacks_on_episode_created": null, "callbacks_on_episode_start": null, "callbacks_on_episode_step": null, "callbacks_on_episode_end": null, "callbacks_on_evaluate_start": null, "callbacks_on_evaluate_end": null, "callbacks_on_evaluate_offline_start": null, "callbacks_on_evaluate_offline_end": null, "callbacks_on_sample_end": null, "callbacks_on_train_result": null, "explore": true, "enable_rl_module_and_learner": true, "enable_env_runner_and_connector_v2": true, "_prior_exploration_config": {"type": "StochasticSampling"}, "count_steps_by": "env_steps", "policy_map_capacity": 100, "policy_mapping_fn": "<function AlgorithmConfig.DEFAULT_POLICY_MAPPING_FN at 0x3881edb20>", "policies_to_train": null, "policy_states_are_swappable": false, "observation_fn": null, "offline_data_class": null, "input_read_method": "read_parquet", "input_read_method_kwargs": {}, "input_read_schema": {}, "input_read_episodes": false, "input_read_sample_batches": false, "input_read_batch_size": null, "input_filesystem": null, "input_filesystem_kwargs": {}, "input_compress_columns": ["obs", "new_obs"], "input_spaces_jsonable": true, "materialize_data": false, "materialize_mapped_data": true, "map_batches_kwargs": {}, "iter_batches_kwargs": {}, "ignore_final_observation": false, "prelearner_class": null, "prelearner_buffer_class": null, "prelearner_buffer_kwargs": {}, "prelearner_module_synch_period": 10, "dataset_num_iters_per_learner": null, "input_config": {}, "actions_in_input_normalized": false, "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_config": {}, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "output_max_rows_per_file": null, "output_write_remaining_data": false, "output_write_method": "write_parquet", "output_write_method_kwargs": {}, "output_filesystem": null, "output_filesystem_kwargs": {}, "output_write_episodes": true, "offline_sampling": false, "evaluation_interval": 1, "evaluation_duration": 20, "evaluation_duration_unit": "episodes", "evaluation_sample_timeout_s": 120.0, "evaluation_auto_duration_min_env_steps_per_sample": 100, "evaluation_auto_duration_max_env_steps_per_sample": 2000, "evaluation_parallel_to_training": false, "evaluation_force_reset_envs_before_iteration": true, "evaluation_config": null, "off_policy_estimation_methods": {}, "ope_split_batch_by_episode": true, "evaluation_num_env_runners": 1, "in_evaluation": false, "sync_filters_on_rollout_workers_timeout_s": 10.0, "offline_evaluation_interval": null, "num_offline_eval_runners": 0, "offline_loss_for_module_fn": null, "offline_evaluation_duration": 1, "offline_evaluation_parallel_to_training": false, "offline_evaluation_timeout_s": 120.0, "num_cpus_per_offline_eval_runner": 1, "num_gpus_per_offline_eval_runner": 0, "custom_resources_per_offline_eval_runner": {}, "restart_failed_offline_eval_runners": true, "ignore_offline_eval_runner_failures": false, "max_num_offline_eval_runner_restarts": 1000, "offline_eval_runner_restore_timeout_s": 1800.0, "max_requests_in_flight_per_offline_eval_runner": 1, "validate_offline_eval_runners_after_construction": true, "offline_eval_runner_health_probe_timeout_s": 30.0, "offline_eval_rl_module_inference_only": false, "broadcast_offline_eval_runner_states": false, "offline_eval_batch_size_per_runner": 256, "dataset_num_iters_per_eval_runner": 1, "keep_per_episode_custom_metrics": false, "metrics_episode_collection_timeout_s": 60.0, "metrics_num_episodes_for_smoothing": 100, "min_time_s_per_iteration": null, "min_train_timesteps_per_iteration": 0, "min_sample_timesteps_per_iteration": 0, "log_gradients": true, "export_native_model_files": false, "checkpoint_trainable_policies_only": false, "logger_creator": null, "logger_config": null, "log_level": "WARN", "log_sys_usage": true, "fake_sampler": false, "seed": 2, "restart_failed_env_runners": true, "ignore_env_runner_failures": false, "max_num_env_runner_restarts": 1000, "delay_between_env_runner_restarts_s": 60.0, "restart_failed_sub_environments": false, "num_consecutive_env_runner_failures_tolerance": 100, "env_runner_health_probe_timeout_s": 30.0, "env_runner_restore_timeout_s": 1800.0, "_model_config": {}, "_rl_module_spec": "RLModuleSpec(module_class=None, observation_space=None, action_space=None, inference_only=False, learner_only=False, model_config=DefaultModelConfig(fcnet_hiddens=[60, 90], fcnet_activation='tanh', fcnet_kernel_initializer=None, fcnet_kernel_initializer_kwargs=None, fcnet_bias_initializer=None, fcnet_bias_initializer_kwargs=None, conv_filters=None, conv_activation='relu', conv_kernel_initializer=None, conv_kernel_initializer_kwargs=None, conv_bias_initializer=None, conv_bias_initializer_kwargs=None, head_fcnet_hiddens=[], head_fcnet_activation='relu', head_fcnet_kernel_initializer=None, head_fcnet_kernel_initializer_kwargs=None, head_fcnet_bias_initializer=None, head_fcnet_bias_initializer_kwargs=None, free_log_std=False, log_std_clip_param=20.0, vf_share_layers=True, use_lstm=False, max_seq_len=20, lstm_cell_size=256, lstm_use_prev_action=False, lstm_use_prev_reward=False, lstm_kernel_initializer=None, lstm_kernel_initializer_kwargs=None, lstm_bias_initializer=None, lstm_bias_initializer_kwargs=None), catalog_class=None, load_state_path=None, model_config_dict=None)", "algorithm_config_overrides_per_module": {}, "_per_module_overrides": {}, "_validate_config": true, "_use_msgpack_checkpoints": false, "_torch_grad_scaler_class": null, "_torch_lr_scheduler_classes": null, "_tf_policy_handles_more_than_one_loss": false, "_disable_preprocessor_api": false, "_disable_action_flattening": false, "_disable_initialize_loss_from_dummy_batch": false, "_dont_auto_sync_env_runner_states": false, "env_task_fn": -1, "enable_connectors": -1, "simple_optimizer": false, "policy_map_cache": -1, "worker_cls": -1, "synchronize_filters": -1, "enable_async_evaluation": -1, "custom_async_evaluation_function": -1, "_enable_rl_module_api": -1, "auto_wrap_old_gym_envs": -1, "always_attach_evaluation_results": -1, "replay_sequence_length": null, "_disable_execution_plan_api": -1, "use_critic": true, "use_gae": true, "use_kl_loss": true, "kl_coeff": 0.7464963036515, "kl_target": 0.0270990929592, "vf_loss_coeff": 0.6688075857018, "entropy_coeff": 0.0090570820258, "clip_param": 0.1221781641624, "vf_clip_param": 0.1027808522125, "entropy_coeff_schedule": null, "lr_schedule": null, "sgd_minibatch_size": -1, "vf_share_layers": -1, "__stdout_file__": null, "__stderr_file__": null, "lambda": 0.9099046732075, "input": "sampler", "policies": {"default_policy": [null, null, null, null]}, "callbacks": "<class 'ray.rllib.callbacks.callbacks.RLlibCallback'>", "create_env_on_driver": false, "custom_eval_function": null, "framework": "torch"}, "time_since_restore": 13.100543022155762, "iterations_since_restore": 8, "perf": {"cpu_util_percent": 37.75, "ram_util_percent": 78.6}}
{"timers": {"training_iteration": 1.549242587750203, "restore_env_runners": 1.1675838169809543e-05, "training_step": 1.5491063067404323, "env_runner_sampling_timer": 1.440264014137458, "learner_update_timer": 0.10581779232108732, "synch_weights": 0.0005500846813905575, "restore_eval_env_runners": 7.891527322786517e-06, "evaluation_iteration": 0.10475696969568547, "synch_eval_env_connectors": 0.00021103396738587134, "synch_env_connectors": 4.285367675903985e-06}, "env_runners": {"num_module_steps_sampled_lifetime": {"default_policy": -4312500.0}, "num_env_steps_sampled_lifetime": -4312500.0, "episode_len_mean": 20.0, "env_to_module_connector": {"timers": {"connectors": {"add_time_dim_to_batch_and_zero_pad": 2.3863849659360706e-06, "add_observations_from_episodes_to_batch": 2.939628898542649e-06, "add_states_from_episodes_to_batch": 1.6842451425455478e-06, "numpy_to_tensor": 8.35204528616098e-06, "batch_individual_items": 6.112168589612349e-06}}, "connector_pipeline_timer": 4.30286886304679e-05}, "weights_seq_no": 8.0, "episode_len_min": 20, "num_agent_steps_sampled_lifetime": {"default_agent": -4312500.0}, "module_to_env_connector": {"connector_pipeline_timer": 0.00010293378396365757, "timers": {"connectors": {"tensor_to_numpy": 1.300199846536843e-05, "listify_data_for_vector_env": 1.0695735252562784e-05, "get_actions": 3.860426306301296e-05, "un_batch_to_individual_items": 5.298289505234638e-06, "normalize_and_clip_actions": 9.245710672288662e-06, "remove_single_ts_time_rank_from_batch": 5.966926752256309e-07}}}, "env_reset_timer": 3.1540576594233845e-05, "env_to_module_sum_episodes_length_out": 10.36823839457432, "env_to_module_sum_episodes_length_in": 10.36823839457432, "num_module_steps_sampled": {"default_policy": 5000.0}, "episode_return_mean": 4.740000000000002, "episode_len_max": 20, "num_env_steps_sampled": 5000.0, "num_episodes_lifetime": -215625.0, "agent_episode_returns_mean": {"default_agent": 4.740000000000002}, "episode_return_min": -11.5, "sample": 0.0048603560039129886, "num_episodes": 250.0, "num_agent_steps_sampled": {"default_agent": 5000.0}, "rlmodule_inference_timer": 2.7385568203757716e-05, "module_episode_returns_mean": {"default_policy": 4.740000000000002}, "episode_return_max": 8.5, "env_step_timer": 1.3551577360332947e-05, "time_between_sampling": 0.0014753256901246302, "episode_duration_sec_mean": 0.004507149024866522, "num_env_steps_sampled_lifetime_throughput": 3778.452613567769}, "learners": {"__all_modules__": {"learner_connector": {"timers": {"connectors": {"numpy_to_tensor": 5.804062340113093e-05, "add_observations_from_episodes_to_batch": 0.0008174338411170606, "add_one_ts_to_episodes_and_truncate": 0.008611796154924339, "add_states_from_episodes_to_batch": 2.8623915231721905e-06, "add_columns_from_episodes_to_train_batch": 0.03455371718852266, "add_time_dim_to_batch_and_zero_pad": 1.0109932288335238e-05, "general_advantage_estimation": 0.006318662618309349, "batch_individual_items": 0.03165144150793866}}, "connector_pipeline_timer": 0.08213736129139419}, "num_module_steps_trained": 6000, "num_trainable_parameters": 6003, "num_module_steps_trained_lifetime": 54000, "learner_connector_sum_episodes_length_out": 5250.0, "num_env_steps_trained_lifetime": 283500, "num_env_steps_trained": 31500, "learner_connector_sum_episodes_length_in": 5000.0, "num_non_trainable_parameters": 0, "num_env_steps_trained_lifetime_throughput": 2350881.574507429, "num_module_steps_trained_throughput": 449919.17812242394, "num_module_steps_trained_lifetime_throughput": 449168.92045905377}, "default_policy": {"module_train_batch_size_mean": 1000.0, "entropy": 0.5808447599411011, "mean_kl_loss": 0.0007413393468596041, "policy_loss": -0.16278362274169922, "default_optimizer_learning_rate": 0.0002847858517, "total_loss": -0.09930161386728287, "gradients_default_optimizer_global_norm": 0.05536004900932312, "diff_num_grad_updates_vs_sampler_policy": 1.0, "num_module_steps_trained": 6000, "num_trainable_parameters": 6003, "num_module_steps_trained_lifetime": 54000, "vf_loss_unclipped": 27.78199577331543, "vf_explained_var": 0.0010166168212890625, "curr_entropy_coeff": 0.0090570820258, "curr_kl_coeff": 0.0014580006245523691, "weights_seq_no": 9.0, "vf_loss": 0.10278083384037018, "num_module_steps_trained_lifetime_throughput": 450702.1421667515}}, "num_training_step_calls_per_iteration": 1, "evaluation": {"env_runners": {"env_to_module_connector": {"timers": {"connectors": {"add_time_dim_to_batch_and_zero_pad": 2.243037346910748e-06, "batch_individual_items": 6.0263500605024685e-06, "numpy_to_tensor": 8.135049033836349e-06, "add_observations_from_episodes_to_batch": 2.7578996452253927e-06, "add_states_from_episodes_to_batch": 1.6571838305872829e-06}}, "connector_pipeline_timer": 4.243645802457812e-05}, "module_episode_returns_mean": {"default_policy": -1.2}, "num_module_steps_sampled_lifetime": {"default_policy": 3600}, "episode_return_mean": -1.2, "env_step_timer": 1.3640709151110132e-05, "num_module_steps_sampled": {"default_policy": 400}, "episode_len_mean": 20.0, "module_to_env_connector": {"timers": {"connectors": {"normalize_and_clip_actions": 9.289311800949814e-06, "listify_data_for_vector_env": 1.0700704741110457e-05, "get_actions": 3.467337696802432e-05, "remove_single_ts_time_rank_from_batch": 5.655462887712905e-07, "tensor_to_numpy": 1.2854555868619008e-05, "un_batch_to_individual_items": 5.463295306394623e-06}}, "connector_pipeline_timer": 9.885731402720595e-05}, "num_env_steps_sampled": 400, "num_episodes_lifetime": 180, "sample": 0.09857607676145452, "episode_duration_sec_mean": 0.004453716761199758, "num_env_steps_sampled_lifetime": 45400, "agent_episode_returns_mean": {"default_agent": -1.2}, "env_reset_timer": 0.00014094098197305752, "rlmodule_inference_timer": 2.6832416108680905e-05, "num_agent_steps_sampled_lifetime": {"default_agent": 3600}, "episode_len_min": 20, "weights_seq_no": 9.0, "env_to_module_sum_episodes_length_out": 10.368238394574323, "num_agent_steps_sampled": {"default_agent": 400}, "env_to_module_sum_episodes_length_in": 10.368238394574323, "episode_len_max": 20, "episode_return_min": -14.5, "num_episodes": 20, "episode_return_max": 14.5, "time_between_sampling": 1.6025498074905462}, "num_healthy_workers": 1, "actor_manager_num_outstanding_async_reqs": 0, "num_remote_worker_restarts": 0}, "num_env_steps_sampled_lifetime": -4312500.0, "fault_tolerance": {"num_healthy_workers": 0, "num_remote_worker_restarts": 0}, "env_runner_group": {"actor_manager_num_outstanding_async_reqs": 0}, "done": false, "training_iteration": 9, "trial_id": "43aed_00000", "date": "2025-08-11_19-23-14", "timestamp": 1754932994, "time_this_iter_s": 1.669013261795044, "time_total_s": 14.769556283950806, "pid": 14402, "hostname": "Mac", "node_ip": "127.0.0.1", "config": {"exploration_config": {}, "extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "placement_strategy": "PACK", "num_gpus": 0, "_fake_gpus": false, "num_cpus_for_main_process": 2, "eager_tracing": true, "eager_max_retraces": 20, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "torch_compile_learner": false, "torch_compile_learner_what_to_compile": "forward_train", "torch_compile_learner_dynamo_backend": "aot_eager", "torch_compile_learner_dynamo_mode": null, "torch_compile_worker": false, "torch_compile_worker_dynamo_backend": "aot_eager", "torch_compile_worker_dynamo_mode": null, "torch_ddp_kwargs": {}, "torch_skip_nan_gradients": false, "env": "Umbrella", "env_config": {}, "observation_space": null, "action_space": null, "clip_rewards": null, "normalize_actions": true, "clip_actions": false, "_is_atari": null, "disable_env_checking": false, "render_env": false, "action_mask_key": "action_mask", "env_runner_cls": null, "num_env_runners": 0, "create_local_env_runner": true, "num_envs_per_env_runner": 1, "gym_env_vectorize_mode": "SYNC", "num_cpus_per_env_runner": 1, "num_gpus_per_env_runner": 0, "custom_resources_per_env_runner": {}, "validate_env_runners_after_construction": true, "episodes_to_numpy": true, "max_requests_in_flight_per_env_runner": 1, "sample_timeout_s": 60.0, "_env_to_module_connector": null, "add_default_connectors_to_env_to_module_pipeline": true, "_module_to_env_connector": null, "add_default_connectors_to_module_to_env_pipeline": true, "merge_env_runner_states": "training_only", "broadcast_env_runner_states": true, "episode_lookback_horizon": 1, "rollout_fragment_length": "auto", "batch_mode": "complete_episodes", "compress_observations": false, "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "enable_tf1_exec_eagerly": false, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "preprocessor_pref": "deepmind", "observation_filter": "NoFilter", "update_worker_filter_stats": true, "use_worker_filter_stats": true, "sampler_perf_stats_ema_coef": null, "_is_online": true, "num_learners": 0, "num_gpus_per_learner": 0, "num_cpus_per_learner": "auto", "num_aggregator_actors_per_learner": 0, "max_requests_in_flight_per_aggregator_actor": 3, "local_gpu_idx": 0, "max_requests_in_flight_per_learner": 3, "gamma": 1, "lr": 0.0002847858517, "grad_clip": 0.5, "grad_clip_by": "global_norm", "_train_batch_size_per_learner": 5000, "train_batch_size": 4000, "num_epochs": 1, "minibatch_size": 1000, "shuffle_batch_per_epoch": true, "model": {"fcnet_hiddens": [256, 256], "fcnet_activation": "tanh", "fcnet_weights_initializer": null, "fcnet_weights_initializer_config": null, "fcnet_bias_initializer": null, "fcnet_bias_initializer_config": null, "conv_filters": null, "conv_activation": "relu", "conv_kernel_initializer": null, "conv_kernel_initializer_config": null, "conv_bias_initializer": null, "conv_bias_initializer_config": null, "conv_transpose_kernel_initializer": null, "conv_transpose_kernel_initializer_config": null, "conv_transpose_bias_initializer": null, "conv_transpose_bias_initializer_config": null, "post_fcnet_hiddens": [], "post_fcnet_activation": "relu", "post_fcnet_weights_initializer": null, "post_fcnet_weights_initializer_config": null, "post_fcnet_bias_initializer": null, "post_fcnet_bias_initializer_config": null, "free_log_std": false, "log_std_clip_param": 20.0, "no_final_linear": false, "vf_share_layers": false, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "lstm_weights_initializer": null, "lstm_weights_initializer_config": null, "lstm_bias_initializer": null, "lstm_bias_initializer_config": null, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "attention_use_n_prev_actions": 0, "attention_use_n_prev_rewards": 0, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": null, "custom_model_config": {}, "custom_action_dist": null, "custom_preprocessor": null, "encoder_latent_dim": null, "always_check_shapes": false, "lstm_use_prev_action_reward": -1, "_use_default_native_models": -1, "_disable_preprocessor_api": false, "_disable_action_flattening": false}, "_learner_connector": null, "add_default_connectors_to_learner_pipeline": true, "learner_config_dict": {}, "optimizer": {}, "_learner_class": null, "callbacks_on_algorithm_init": null, "callbacks_on_env_runners_recreated": null, "callbacks_on_offline_eval_runners_recreated": null, "callbacks_on_checkpoint_loaded": null, "callbacks_on_environment_created": null, "callbacks_on_episode_created": null, "callbacks_on_episode_start": null, "callbacks_on_episode_step": null, "callbacks_on_episode_end": null, "callbacks_on_evaluate_start": null, "callbacks_on_evaluate_end": null, "callbacks_on_evaluate_offline_start": null, "callbacks_on_evaluate_offline_end": null, "callbacks_on_sample_end": null, "callbacks_on_train_result": null, "explore": true, "enable_rl_module_and_learner": true, "enable_env_runner_and_connector_v2": true, "_prior_exploration_config": {"type": "StochasticSampling"}, "count_steps_by": "env_steps", "policy_map_capacity": 100, "policy_mapping_fn": "<function AlgorithmConfig.DEFAULT_POLICY_MAPPING_FN at 0x3881edb20>", "policies_to_train": null, "policy_states_are_swappable": false, "observation_fn": null, "offline_data_class": null, "input_read_method": "read_parquet", "input_read_method_kwargs": {}, "input_read_schema": {}, "input_read_episodes": false, "input_read_sample_batches": false, "input_read_batch_size": null, "input_filesystem": null, "input_filesystem_kwargs": {}, "input_compress_columns": ["obs", "new_obs"], "input_spaces_jsonable": true, "materialize_data": false, "materialize_mapped_data": true, "map_batches_kwargs": {}, "iter_batches_kwargs": {}, "ignore_final_observation": false, "prelearner_class": null, "prelearner_buffer_class": null, "prelearner_buffer_kwargs": {}, "prelearner_module_synch_period": 10, "dataset_num_iters_per_learner": null, "input_config": {}, "actions_in_input_normalized": false, "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_config": {}, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "output_max_rows_per_file": null, "output_write_remaining_data": false, "output_write_method": "write_parquet", "output_write_method_kwargs": {}, "output_filesystem": null, "output_filesystem_kwargs": {}, "output_write_episodes": true, "offline_sampling": false, "evaluation_interval": 1, "evaluation_duration": 20, "evaluation_duration_unit": "episodes", "evaluation_sample_timeout_s": 120.0, "evaluation_auto_duration_min_env_steps_per_sample": 100, "evaluation_auto_duration_max_env_steps_per_sample": 2000, "evaluation_parallel_to_training": false, "evaluation_force_reset_envs_before_iteration": true, "evaluation_config": null, "off_policy_estimation_methods": {}, "ope_split_batch_by_episode": true, "evaluation_num_env_runners": 1, "in_evaluation": false, "sync_filters_on_rollout_workers_timeout_s": 10.0, "offline_evaluation_interval": null, "num_offline_eval_runners": 0, "offline_loss_for_module_fn": null, "offline_evaluation_duration": 1, "offline_evaluation_parallel_to_training": false, "offline_evaluation_timeout_s": 120.0, "num_cpus_per_offline_eval_runner": 1, "num_gpus_per_offline_eval_runner": 0, "custom_resources_per_offline_eval_runner": {}, "restart_failed_offline_eval_runners": true, "ignore_offline_eval_runner_failures": false, "max_num_offline_eval_runner_restarts": 1000, "offline_eval_runner_restore_timeout_s": 1800.0, "max_requests_in_flight_per_offline_eval_runner": 1, "validate_offline_eval_runners_after_construction": true, "offline_eval_runner_health_probe_timeout_s": 30.0, "offline_eval_rl_module_inference_only": false, "broadcast_offline_eval_runner_states": false, "offline_eval_batch_size_per_runner": 256, "dataset_num_iters_per_eval_runner": 1, "keep_per_episode_custom_metrics": false, "metrics_episode_collection_timeout_s": 60.0, "metrics_num_episodes_for_smoothing": 100, "min_time_s_per_iteration": null, "min_train_timesteps_per_iteration": 0, "min_sample_timesteps_per_iteration": 0, "log_gradients": true, "export_native_model_files": false, "checkpoint_trainable_policies_only": false, "logger_creator": null, "logger_config": null, "log_level": "WARN", "log_sys_usage": true, "fake_sampler": false, "seed": 2, "restart_failed_env_runners": true, "ignore_env_runner_failures": false, "max_num_env_runner_restarts": 1000, "delay_between_env_runner_restarts_s": 60.0, "restart_failed_sub_environments": false, "num_consecutive_env_runner_failures_tolerance": 100, "env_runner_health_probe_timeout_s": 30.0, "env_runner_restore_timeout_s": 1800.0, "_model_config": {}, "_rl_module_spec": "RLModuleSpec(module_class=None, observation_space=None, action_space=None, inference_only=False, learner_only=False, model_config=DefaultModelConfig(fcnet_hiddens=[60, 90], fcnet_activation='tanh', fcnet_kernel_initializer=None, fcnet_kernel_initializer_kwargs=None, fcnet_bias_initializer=None, fcnet_bias_initializer_kwargs=None, conv_filters=None, conv_activation='relu', conv_kernel_initializer=None, conv_kernel_initializer_kwargs=None, conv_bias_initializer=None, conv_bias_initializer_kwargs=None, head_fcnet_hiddens=[], head_fcnet_activation='relu', head_fcnet_kernel_initializer=None, head_fcnet_kernel_initializer_kwargs=None, head_fcnet_bias_initializer=None, head_fcnet_bias_initializer_kwargs=None, free_log_std=False, log_std_clip_param=20.0, vf_share_layers=True, use_lstm=False, max_seq_len=20, lstm_cell_size=256, lstm_use_prev_action=False, lstm_use_prev_reward=False, lstm_kernel_initializer=None, lstm_kernel_initializer_kwargs=None, lstm_bias_initializer=None, lstm_bias_initializer_kwargs=None), catalog_class=None, load_state_path=None, model_config_dict=None)", "algorithm_config_overrides_per_module": {}, "_per_module_overrides": {}, "_validate_config": true, "_use_msgpack_checkpoints": false, "_torch_grad_scaler_class": null, "_torch_lr_scheduler_classes": null, "_tf_policy_handles_more_than_one_loss": false, "_disable_preprocessor_api": false, "_disable_action_flattening": false, "_disable_initialize_loss_from_dummy_batch": false, "_dont_auto_sync_env_runner_states": false, "env_task_fn": -1, "enable_connectors": -1, "simple_optimizer": false, "policy_map_cache": -1, "worker_cls": -1, "synchronize_filters": -1, "enable_async_evaluation": -1, "custom_async_evaluation_function": -1, "_enable_rl_module_api": -1, "auto_wrap_old_gym_envs": -1, "always_attach_evaluation_results": -1, "replay_sequence_length": null, "_disable_execution_plan_api": -1, "use_critic": true, "use_gae": true, "use_kl_loss": true, "kl_coeff": 0.7464963036515, "kl_target": 0.0270990929592, "vf_loss_coeff": 0.6688075857018, "entropy_coeff": 0.0090570820258, "clip_param": 0.1221781641624, "vf_clip_param": 0.1027808522125, "entropy_coeff_schedule": null, "lr_schedule": null, "sgd_minibatch_size": -1, "vf_share_layers": -1, "__stdout_file__": null, "__stderr_file__": null, "lambda": 0.9099046732075, "input": "sampler", "policies": {"default_policy": [null, null, null, null]}, "callbacks": "<class 'ray.rllib.callbacks.callbacks.RLlibCallback'>", "create_env_on_driver": false, "custom_eval_function": null, "framework": "torch"}, "time_since_restore": 14.769556283950806, "iterations_since_restore": 9, "perf": {"cpu_util_percent": 36.800000000000004, "ram_util_percent": 78.56666666666668}}
{"timers": {"training_iteration": 1.5496293164621937, "restore_env_runners": 1.1616579643868208e-05, "training_step": 1.5494925982523071, "env_runner_sampling_timer": 1.4397929698258647, "learner_update_timer": 0.10667228731802898, "synch_weights": 0.0005509684152055984, "restore_eval_env_runners": 7.872192247116459e-06, "evaluation_iteration": 0.1047260024986048, "synch_eval_env_connectors": 0.00021003737775254379, "synch_env_connectors": 4.281684262480054e-06}, "env_runners": {"num_module_steps_sampled_lifetime": {"default_policy": -4930000.0}, "num_env_steps_sampled_lifetime": -4930000.0, "episode_len_mean": 20.0, "env_to_module_connector": {"timers": {"connectors": {"add_time_dim_to_batch_and_zero_pad": 2.4300368407286756e-06, "add_observations_from_episodes_to_batch": 3.063019840846195e-06, "add_states_from_episodes_to_batch": 1.6878441713827939e-06, "numpy_to_tensor": 8.534523237045747e-06, "batch_individual_items": 6.243241981886269e-06}}, "connector_pipeline_timer": 4.3633979639242164e-05}, "weights_seq_no": 9.0, "episode_len_min": 20, "num_agent_steps_sampled_lifetime": {"default_agent": -4930000.0}, "module_to_env_connector": {"connector_pipeline_timer": 0.00010471080545279495, "timers": {"connectors": {"tensor_to_numpy": 1.3207528246924609e-05, "listify_data_for_vector_env": 1.0872015936332524e-05, "get_actions": 3.9599261300015105e-05, "un_batch_to_individual_items": 5.346043989561379e-06, "normalize_and_clip_actions": 9.3945744680928e-06, "remove_single_ts_time_rank_from_batch": 6.031571863563414e-07}}}, "env_reset_timer": 3.6132557976911886e-05, "env_to_module_sum_episodes_length_out": 10.36823839457432, "env_to_module_sum_episodes_length_in": 10.36823839457432, "num_module_steps_sampled": {"default_policy": 5000.0}, "episode_return_mean": 3.7, "episode_len_max": 20, "num_env_steps_sampled": 5000.0, "num_episodes_lifetime": -246500.0, "agent_episode_returns_mean": {"default_agent": 3.7}, "episode_return_min": -11.5, "sample": 0.004869187966392936, "num_episodes": 250.0, "num_agent_steps_sampled": {"default_agent": 5000.0}, "rlmodule_inference_timer": 2.7524877157993188e-05, "module_episode_returns_mean": {"default_policy": 3.7}, "episode_return_max": 8.5, "env_step_timer": 1.385370674130065e-05, "time_between_sampling": 0.00188061305691671, "episode_duration_sec_mean": 0.004568750176113098, "num_env_steps_sampled_lifetime_throughput": 3698.2952494261945}, "learners": {"__all_modules__": {"learner_connector": {"timers": {"connectors": {"numpy_to_tensor": 5.806729745907628e-05, "add_observations_from_episodes_to_batch": 0.0008177103318970233, "add_one_ts_to_episodes_and_truncate": 0.008603533603429421, "add_states_from_episodes_to_batch": 2.8600169347060057e-06, "add_columns_from_episodes_to_train_batch": 0.03455593793702743, "add_time_dim_to_batch_and_zero_pad": 1.0106333125788381e-05, "general_advantage_estimation": 0.0063094734929258515, "batch_individual_items": 0.03259254417181363}}, "connector_pipeline_timer": 0.08306334267743203}, "num_module_steps_trained": 6000, "num_trainable_parameters": 6003, "num_module_steps_trained_lifetime": 60000, "learner_connector_sum_episodes_length_out": 5250.0, "num_env_steps_trained_lifetime": 315000, "num_env_steps_trained": 31500, "learner_connector_sum_episodes_length_in": 5000.0, "num_non_trainable_parameters": 0, "num_env_steps_trained_lifetime_throughput": 2341773.0254030325, "num_module_steps_trained_throughput": 448100.55779174843, "num_module_steps_trained_lifetime_throughput": 447375.4220229245}, "default_policy": {"module_train_batch_size_mean": 1000.0, "entropy": 0.5488011240959167, "mean_kl_loss": 0.001431760611012578, "policy_loss": -0.01831967383623123, "default_optimizer_learning_rate": 0.0002847858517, "total_loss": 0.045452482998371124, "gradients_default_optimizer_global_norm": 0.05242887884378433, "diff_num_grad_updates_vs_sampler_policy": 1.0, "num_module_steps_trained": 6000, "num_trainable_parameters": 6003, "num_module_steps_trained_lifetime": 60000, "vf_loss_unclipped": 28.12540626525879, "vf_explained_var": -0.005507946014404297, "curr_entropy_coeff": 0.0090570820258, "curr_kl_coeff": 0.0007290003122761846, "weights_seq_no": 10.0, "vf_loss": 0.10278083384037018, "num_module_steps_trained_lifetime_throughput": 448815.21559423354}}, "num_training_step_calls_per_iteration": 1, "evaluation": {"env_runners": {"env_to_module_connector": {"timers": {"connectors": {"add_time_dim_to_batch_and_zero_pad": 2.271757268970496e-06, "batch_individual_items": 6.165853680464445e-06, "numpy_to_tensor": 8.331988780139326e-06, "add_observations_from_episodes_to_batch": 2.834859844591312e-06, "add_states_from_episodes_to_batch": 1.6457384485155806e-06}}, "connector_pipeline_timer": 4.2926514319848336e-05}, "module_episode_returns_mean": {"default_policy": -1.4}, "num_module_steps_sampled_lifetime": {"default_policy": 4000}, "episode_return_mean": -1.4, "env_step_timer": 1.3883550630517677e-05, "num_module_steps_sampled": {"default_policy": 400}, "episode_len_mean": 20.0, "module_to_env_connector": {"timers": {"connectors": {"normalize_and_clip_actions": 9.467136897678287e-06, "listify_data_for_vector_env": 1.0813823324869611e-05, "get_actions": 3.498628788779864e-05, "remove_single_ts_time_rank_from_batch": 5.77026153371156e-07, "tensor_to_numpy": 1.2811192598729821e-05, "un_batch_to_individual_items": 5.419119305765208e-06}}, "connector_pipeline_timer": 9.94751939628466e-05}, "num_env_steps_sampled": 400, "num_episodes_lifetime": 200, "sample": 0.09857772349376429, "episode_duration_sec_mean": 0.004471053411252797, "num_env_steps_sampled_lifetime": 50400, "agent_episode_returns_mean": {"default_agent": -1.4}, "env_reset_timer": 0.00014036407208955, "rlmodule_inference_timer": 2.710553170391201e-05, "num_agent_steps_sampled_lifetime": {"default_agent": 4000}, "episode_len_min": 20, "weights_seq_no": 10.0, "env_to_module_sum_episodes_length_out": 10.368238394574323, "num_agent_steps_sampled": {"default_agent": 400}, "env_to_module_sum_episodes_length_in": 10.368238394574323, "episode_len_max": 20, "episode_return_min": -14.5, "num_episodes": 20, "episode_return_max": 14.5, "time_between_sampling": 1.6025741231660735}, "num_healthy_workers": 1, "actor_manager_num_outstanding_async_reqs": 0, "num_remote_worker_restarts": 0}, "num_env_steps_sampled_lifetime": -4930000.0, "fault_tolerance": {"num_healthy_workers": 0, "num_remote_worker_restarts": 0}, "env_runner_group": {"actor_manager_num_outstanding_async_reqs": 0}, "done": false, "training_iteration": 10, "trial_id": "43aed_00000", "date": "2025-08-11_19-23-16", "timestamp": 1754932996, "time_this_iter_s": 1.694018840789795, "time_total_s": 16.4635751247406, "pid": 14402, "hostname": "Mac", "node_ip": "127.0.0.1", "config": {"exploration_config": {}, "extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "placement_strategy": "PACK", "num_gpus": 0, "_fake_gpus": false, "num_cpus_for_main_process": 2, "eager_tracing": true, "eager_max_retraces": 20, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "torch_compile_learner": false, "torch_compile_learner_what_to_compile": "forward_train", "torch_compile_learner_dynamo_backend": "aot_eager", "torch_compile_learner_dynamo_mode": null, "torch_compile_worker": false, "torch_compile_worker_dynamo_backend": "aot_eager", "torch_compile_worker_dynamo_mode": null, "torch_ddp_kwargs": {}, "torch_skip_nan_gradients": false, "env": "Umbrella", "env_config": {}, "observation_space": null, "action_space": null, "clip_rewards": null, "normalize_actions": true, "clip_actions": false, "_is_atari": null, "disable_env_checking": false, "render_env": false, "action_mask_key": "action_mask", "env_runner_cls": null, "num_env_runners": 0, "create_local_env_runner": true, "num_envs_per_env_runner": 1, "gym_env_vectorize_mode": "SYNC", "num_cpus_per_env_runner": 1, "num_gpus_per_env_runner": 0, "custom_resources_per_env_runner": {}, "validate_env_runners_after_construction": true, "episodes_to_numpy": true, "max_requests_in_flight_per_env_runner": 1, "sample_timeout_s": 60.0, "_env_to_module_connector": null, "add_default_connectors_to_env_to_module_pipeline": true, "_module_to_env_connector": null, "add_default_connectors_to_module_to_env_pipeline": true, "merge_env_runner_states": "training_only", "broadcast_env_runner_states": true, "episode_lookback_horizon": 1, "rollout_fragment_length": "auto", "batch_mode": "complete_episodes", "compress_observations": false, "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "enable_tf1_exec_eagerly": false, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "preprocessor_pref": "deepmind", "observation_filter": "NoFilter", "update_worker_filter_stats": true, "use_worker_filter_stats": true, "sampler_perf_stats_ema_coef": null, "_is_online": true, "num_learners": 0, "num_gpus_per_learner": 0, "num_cpus_per_learner": "auto", "num_aggregator_actors_per_learner": 0, "max_requests_in_flight_per_aggregator_actor": 3, "local_gpu_idx": 0, "max_requests_in_flight_per_learner": 3, "gamma": 1, "lr": 0.0002847858517, "grad_clip": 0.5, "grad_clip_by": "global_norm", "_train_batch_size_per_learner": 5000, "train_batch_size": 4000, "num_epochs": 1, "minibatch_size": 1000, "shuffle_batch_per_epoch": true, "model": {"fcnet_hiddens": [256, 256], "fcnet_activation": "tanh", "fcnet_weights_initializer": null, "fcnet_weights_initializer_config": null, "fcnet_bias_initializer": null, "fcnet_bias_initializer_config": null, "conv_filters": null, "conv_activation": "relu", "conv_kernel_initializer": null, "conv_kernel_initializer_config": null, "conv_bias_initializer": null, "conv_bias_initializer_config": null, "conv_transpose_kernel_initializer": null, "conv_transpose_kernel_initializer_config": null, "conv_transpose_bias_initializer": null, "conv_transpose_bias_initializer_config": null, "post_fcnet_hiddens": [], "post_fcnet_activation": "relu", "post_fcnet_weights_initializer": null, "post_fcnet_weights_initializer_config": null, "post_fcnet_bias_initializer": null, "post_fcnet_bias_initializer_config": null, "free_log_std": false, "log_std_clip_param": 20.0, "no_final_linear": false, "vf_share_layers": false, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "lstm_weights_initializer": null, "lstm_weights_initializer_config": null, "lstm_bias_initializer": null, "lstm_bias_initializer_config": null, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "attention_use_n_prev_actions": 0, "attention_use_n_prev_rewards": 0, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": null, "custom_model_config": {}, "custom_action_dist": null, "custom_preprocessor": null, "encoder_latent_dim": null, "always_check_shapes": false, "lstm_use_prev_action_reward": -1, "_use_default_native_models": -1, "_disable_preprocessor_api": false, "_disable_action_flattening": false}, "_learner_connector": null, "add_default_connectors_to_learner_pipeline": true, "learner_config_dict": {}, "optimizer": {}, "_learner_class": null, "callbacks_on_algorithm_init": null, "callbacks_on_env_runners_recreated": null, "callbacks_on_offline_eval_runners_recreated": null, "callbacks_on_checkpoint_loaded": null, "callbacks_on_environment_created": null, "callbacks_on_episode_created": null, "callbacks_on_episode_start": null, "callbacks_on_episode_step": null, "callbacks_on_episode_end": null, "callbacks_on_evaluate_start": null, "callbacks_on_evaluate_end": null, "callbacks_on_evaluate_offline_start": null, "callbacks_on_evaluate_offline_end": null, "callbacks_on_sample_end": null, "callbacks_on_train_result": null, "explore": true, "enable_rl_module_and_learner": true, "enable_env_runner_and_connector_v2": true, "_prior_exploration_config": {"type": "StochasticSampling"}, "count_steps_by": "env_steps", "policy_map_capacity": 100, "policy_mapping_fn": "<function AlgorithmConfig.DEFAULT_POLICY_MAPPING_FN at 0x3881edb20>", "policies_to_train": null, "policy_states_are_swappable": false, "observation_fn": null, "offline_data_class": null, "input_read_method": "read_parquet", "input_read_method_kwargs": {}, "input_read_schema": {}, "input_read_episodes": false, "input_read_sample_batches": false, "input_read_batch_size": null, "input_filesystem": null, "input_filesystem_kwargs": {}, "input_compress_columns": ["obs", "new_obs"], "input_spaces_jsonable": true, "materialize_data": false, "materialize_mapped_data": true, "map_batches_kwargs": {}, "iter_batches_kwargs": {}, "ignore_final_observation": false, "prelearner_class": null, "prelearner_buffer_class": null, "prelearner_buffer_kwargs": {}, "prelearner_module_synch_period": 10, "dataset_num_iters_per_learner": null, "input_config": {}, "actions_in_input_normalized": false, "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_config": {}, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "output_max_rows_per_file": null, "output_write_remaining_data": false, "output_write_method": "write_parquet", "output_write_method_kwargs": {}, "output_filesystem": null, "output_filesystem_kwargs": {}, "output_write_episodes": true, "offline_sampling": false, "evaluation_interval": 1, "evaluation_duration": 20, "evaluation_duration_unit": "episodes", "evaluation_sample_timeout_s": 120.0, "evaluation_auto_duration_min_env_steps_per_sample": 100, "evaluation_auto_duration_max_env_steps_per_sample": 2000, "evaluation_parallel_to_training": false, "evaluation_force_reset_envs_before_iteration": true, "evaluation_config": null, "off_policy_estimation_methods": {}, "ope_split_batch_by_episode": true, "evaluation_num_env_runners": 1, "in_evaluation": false, "sync_filters_on_rollout_workers_timeout_s": 10.0, "offline_evaluation_interval": null, "num_offline_eval_runners": 0, "offline_loss_for_module_fn": null, "offline_evaluation_duration": 1, "offline_evaluation_parallel_to_training": false, "offline_evaluation_timeout_s": 120.0, "num_cpus_per_offline_eval_runner": 1, "num_gpus_per_offline_eval_runner": 0, "custom_resources_per_offline_eval_runner": {}, "restart_failed_offline_eval_runners": true, "ignore_offline_eval_runner_failures": false, "max_num_offline_eval_runner_restarts": 1000, "offline_eval_runner_restore_timeout_s": 1800.0, "max_requests_in_flight_per_offline_eval_runner": 1, "validate_offline_eval_runners_after_construction": true, "offline_eval_runner_health_probe_timeout_s": 30.0, "offline_eval_rl_module_inference_only": false, "broadcast_offline_eval_runner_states": false, "offline_eval_batch_size_per_runner": 256, "dataset_num_iters_per_eval_runner": 1, "keep_per_episode_custom_metrics": false, "metrics_episode_collection_timeout_s": 60.0, "metrics_num_episodes_for_smoothing": 100, "min_time_s_per_iteration": null, "min_train_timesteps_per_iteration": 0, "min_sample_timesteps_per_iteration": 0, "log_gradients": true, "export_native_model_files": false, "checkpoint_trainable_policies_only": false, "logger_creator": null, "logger_config": null, "log_level": "WARN", "log_sys_usage": true, "fake_sampler": false, "seed": 2, "restart_failed_env_runners": true, "ignore_env_runner_failures": false, "max_num_env_runner_restarts": 1000, "delay_between_env_runner_restarts_s": 60.0, "restart_failed_sub_environments": false, "num_consecutive_env_runner_failures_tolerance": 100, "env_runner_health_probe_timeout_s": 30.0, "env_runner_restore_timeout_s": 1800.0, "_model_config": {}, "_rl_module_spec": "RLModuleSpec(module_class=None, observation_space=None, action_space=None, inference_only=False, learner_only=False, model_config=DefaultModelConfig(fcnet_hiddens=[60, 90], fcnet_activation='tanh', fcnet_kernel_initializer=None, fcnet_kernel_initializer_kwargs=None, fcnet_bias_initializer=None, fcnet_bias_initializer_kwargs=None, conv_filters=None, conv_activation='relu', conv_kernel_initializer=None, conv_kernel_initializer_kwargs=None, conv_bias_initializer=None, conv_bias_initializer_kwargs=None, head_fcnet_hiddens=[], head_fcnet_activation='relu', head_fcnet_kernel_initializer=None, head_fcnet_kernel_initializer_kwargs=None, head_fcnet_bias_initializer=None, head_fcnet_bias_initializer_kwargs=None, free_log_std=False, log_std_clip_param=20.0, vf_share_layers=True, use_lstm=False, max_seq_len=20, lstm_cell_size=256, lstm_use_prev_action=False, lstm_use_prev_reward=False, lstm_kernel_initializer=None, lstm_kernel_initializer_kwargs=None, lstm_bias_initializer=None, lstm_bias_initializer_kwargs=None), catalog_class=None, load_state_path=None, model_config_dict=None)", "algorithm_config_overrides_per_module": {}, "_per_module_overrides": {}, "_validate_config": true, "_use_msgpack_checkpoints": false, "_torch_grad_scaler_class": null, "_torch_lr_scheduler_classes": null, "_tf_policy_handles_more_than_one_loss": false, "_disable_preprocessor_api": false, "_disable_action_flattening": false, "_disable_initialize_loss_from_dummy_batch": false, "_dont_auto_sync_env_runner_states": false, "env_task_fn": -1, "enable_connectors": -1, "simple_optimizer": false, "policy_map_cache": -1, "worker_cls": -1, "synchronize_filters": -1, "enable_async_evaluation": -1, "custom_async_evaluation_function": -1, "_enable_rl_module_api": -1, "auto_wrap_old_gym_envs": -1, "always_attach_evaluation_results": -1, "replay_sequence_length": null, "_disable_execution_plan_api": -1, "use_critic": true, "use_gae": true, "use_kl_loss": true, "kl_coeff": 0.7464963036515, "kl_target": 0.0270990929592, "vf_loss_coeff": 0.6688075857018, "entropy_coeff": 0.0090570820258, "clip_param": 0.1221781641624, "vf_clip_param": 0.1027808522125, "entropy_coeff_schedule": null, "lr_schedule": null, "sgd_minibatch_size": -1, "vf_share_layers": -1, "__stdout_file__": null, "__stderr_file__": null, "lambda": 0.9099046732075, "input": "sampler", "policies": {"default_policy": [null, null, null, null]}, "callbacks": "<class 'ray.rllib.callbacks.callbacks.RLlibCallback'>", "create_env_on_driver": false, "custom_eval_function": null, "framework": "torch"}, "time_since_restore": 16.4635751247406, "iterations_since_restore": 10, "perf": {"cpu_util_percent": 47.5, "ram_util_percent": 77.4}}
{"timers": {"training_iteration": 1.5485557966275787, "restore_env_runners": 1.1554583060828817e-05, "training_step": 1.5484188839394712, "env_runner_sampling_timer": 1.4388775809676564, "learner_update_timer": 0.1065124669441128, "synch_weights": 0.000551079561978724, "restore_eval_env_runners": 7.858470819587364e-06, "evaluation_iteration": 0.1047170074737162, "synch_eval_env_connectors": 0.00020942658341976947, "synch_env_connectors": 4.278866560281769e-06}, "env_runners": {"num_module_steps_sampled_lifetime": {"default_policy": -5547500.0}, "num_env_steps_sampled_lifetime": -5547500.0, "episode_len_mean": 20.0, "env_to_module_connector": {"timers": {"connectors": {"add_time_dim_to_batch_and_zero_pad": 2.3918949684802604e-06, "add_observations_from_episodes_to_batch": 2.9435123627061765e-06, "add_states_from_episodes_to_batch": 1.689775361711886e-06, "numpy_to_tensor": 8.238586737480651e-06, "batch_individual_items": 6.086079625846337e-06}}, "connector_pipeline_timer": 4.277564564614689e-05}, "weights_seq_no": 10.0, "episode_len_min": 20, "num_agent_steps_sampled_lifetime": {"default_agent": -5547500.0}, "module_to_env_connector": {"connector_pipeline_timer": 0.00010201778696597953, "timers": {"connectors": {"tensor_to_numpy": 1.2846205834603848e-05, "listify_data_for_vector_env": 1.0651352866277788e-05, "get_actions": 3.810913789368142e-05, "un_batch_to_individual_items": 5.267341259353997e-06, "normalize_and_clip_actions": 9.205108773544279e-06, "remove_single_ts_time_rank_from_batch": 5.954623718427491e-07}}}, "env_reset_timer": 3.2945945395688245e-05, "env_to_module_sum_episodes_length_out": 10.36823839457432, "env_to_module_sum_episodes_length_in": 10.36823839457432, "num_module_steps_sampled": {"default_policy": 5000.0}, "episode_return_mean": 5.14, "episode_len_max": 20, "num_env_steps_sampled": 5000.0, "num_episodes_lifetime": -277375.0, "agent_episode_returns_mean": {"default_agent": 5.14}, "episode_return_min": -11.5, "sample": 0.004817468070170411, "num_episodes": 250.0, "num_agent_steps_sampled": {"default_agent": 5000.0}, "rlmodule_inference_timer": 2.7371221661238067e-05, "module_episode_returns_mean": {"default_policy": 5.14}, "episode_return_max": 8.5, "env_step_timer": 1.3532663635021806e-05, "time_between_sampling": 0.0018777232984228474, "episode_duration_sec_mean": 0.004467487485148012, "num_env_steps_sampled_lifetime_throughput": 3798.590988835434}, "learners": {"__all_modules__": {"learner_connector": {"timers": {"connectors": {"numpy_to_tensor": 5.796829404269768e-05, "add_observations_from_episodes_to_batch": 0.0008175440683886481, "add_one_ts_to_episodes_and_truncate": 0.008592755348002244, "add_states_from_episodes_to_batch": 2.8585066107480735e-06, "add_columns_from_episodes_to_train_batch": 0.03455529605828159, "add_time_dim_to_batch_and_zero_pad": 1.0086929322026e-05, "general_advantage_estimation": 0.006299237918347228, "batch_individual_items": 0.032563169569070724}}, "connector_pipeline_timer": 0.08301171675046243}, "num_module_steps_trained": 6000, "num_trainable_parameters": 6003, "num_module_steps_trained_lifetime": 66000, "learner_connector_sum_episodes_length_out": 5250.0, "num_env_steps_trained_lifetime": 346500, "num_env_steps_trained": 31500, "learner_connector_sum_episodes_length_in": 5000.0, "num_non_trainable_parameters": 0, "num_env_steps_trained_lifetime_throughput": 2337489.341296038, "num_module_steps_trained_throughput": 447201.46896895126, "num_module_steps_trained_lifetime_throughput": 446501.385418175}, "default_policy": {"module_train_batch_size_mean": 1000.0, "entropy": 0.5197477340698242, "mean_kl_loss": 0.0012500360608100891, "policy_loss": -0.03413091599941254, "default_optimizer_learning_rate": 0.0002847858517, "total_loss": 0.02990320324897766, "gradients_default_optimizer_global_norm": 0.034589968621730804, "diff_num_grad_updates_vs_sampler_policy": 1.0, "num_module_steps_trained": 6000, "num_trainable_parameters": 6003, "num_module_steps_trained_lifetime": 66000, "vf_loss_unclipped": 27.9683895111084, "vf_explained_var": -0.0021424293518066406, "curr_entropy_coeff": 0.0090570820258, "curr_kl_coeff": 0.0003645001561380923, "weights_seq_no": 11.0, "vf_loss": 0.10278083384037018, "num_module_steps_trained_lifetime_throughput": 447848.4405580754}}, "num_training_step_calls_per_iteration": 1, "evaluation": {"env_runners": {"env_to_module_connector": {"timers": {"connectors": {"add_time_dim_to_batch_and_zero_pad": 2.244360981646829e-06, "batch_individual_items": 6.05080678335536e-06, "numpy_to_tensor": 8.169286914290267e-06, "add_observations_from_episodes_to_batch": 2.7569292145165555e-06, "add_states_from_episodes_to_batch": 1.6515404733643158e-06}}, "connector_pipeline_timer": 4.227480668356652e-05}, "module_episode_returns_mean": {"default_policy": -1.2}, "num_module_steps_sampled_lifetime": {"default_policy": 4400}, "episode_return_mean": -1.2, "env_step_timer": 1.3639604311414706e-05, "num_module_steps_sampled": {"default_policy": 400}, "episode_len_mean": 20.0, "module_to_env_connector": {"timers": {"connectors": {"normalize_and_clip_actions": 9.32560284150753e-06, "listify_data_for_vector_env": 1.0700132561874554e-05, "get_actions": 3.409874616084099e-05, "remove_single_ts_time_rank_from_batch": 5.793109409507642e-07, "tensor_to_numpy": 1.2661409976580453e-05, "un_batch_to_individual_items": 5.336738481546827e-06}}, "connector_pipeline_timer": 9.819235569019469e-05}, "num_env_steps_sampled": 400, "num_episodes_lifetime": 220, "sample": 0.09855667917981045, "episode_duration_sec_mean": 0.004462762953480705, "num_env_steps_sampled_lifetime": 55400, "agent_episode_returns_mean": {"default_agent": -1.2}, "env_reset_timer": 0.00013967585125156294, "rlmodule_inference_timer": 2.6836938904152558e-05, "num_agent_steps_sampled_lifetime": {"default_agent": 4400}, "episode_len_min": 20, "weights_seq_no": 11.0, "env_to_module_sum_episodes_length_out": 10.368238394574323, "num_agent_steps_sampled": {"default_agent": 400}, "env_to_module_sum_episodes_length_in": 10.368238394574323, "episode_len_max": 20, "episode_return_min": -14.5, "num_episodes": 20, "episode_return_max": 14.5, "time_between_sampling": 1.6011403402639601}, "num_healthy_workers": 1, "actor_manager_num_outstanding_async_reqs": 0, "num_remote_worker_restarts": 0}, "num_env_steps_sampled_lifetime": -5547500.0, "fault_tolerance": {"num_healthy_workers": 0, "num_remote_worker_restarts": 0}, "env_runner_group": {"actor_manager_num_outstanding_async_reqs": 0}, "done": false, "training_iteration": 11, "trial_id": "43aed_00000", "date": "2025-08-11_19-23-17", "timestamp": 1754932997, "time_this_iter_s": 1.545544147491455, "time_total_s": 18.009119272232056, "pid": 14402, "hostname": "Mac", "node_ip": "127.0.0.1", "config": {"exploration_config": {}, "extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "placement_strategy": "PACK", "num_gpus": 0, "_fake_gpus": false, "num_cpus_for_main_process": 2, "eager_tracing": true, "eager_max_retraces": 20, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "torch_compile_learner": false, "torch_compile_learner_what_to_compile": "forward_train", "torch_compile_learner_dynamo_backend": "aot_eager", "torch_compile_learner_dynamo_mode": null, "torch_compile_worker": false, "torch_compile_worker_dynamo_backend": "aot_eager", "torch_compile_worker_dynamo_mode": null, "torch_ddp_kwargs": {}, "torch_skip_nan_gradients": false, "env": "Umbrella", "env_config": {}, "observation_space": null, "action_space": null, "clip_rewards": null, "normalize_actions": true, "clip_actions": false, "_is_atari": null, "disable_env_checking": false, "render_env": false, "action_mask_key": "action_mask", "env_runner_cls": null, "num_env_runners": 0, "create_local_env_runner": true, "num_envs_per_env_runner": 1, "gym_env_vectorize_mode": "SYNC", "num_cpus_per_env_runner": 1, "num_gpus_per_env_runner": 0, "custom_resources_per_env_runner": {}, "validate_env_runners_after_construction": true, "episodes_to_numpy": true, "max_requests_in_flight_per_env_runner": 1, "sample_timeout_s": 60.0, "_env_to_module_connector": null, "add_default_connectors_to_env_to_module_pipeline": true, "_module_to_env_connector": null, "add_default_connectors_to_module_to_env_pipeline": true, "merge_env_runner_states": "training_only", "broadcast_env_runner_states": true, "episode_lookback_horizon": 1, "rollout_fragment_length": "auto", "batch_mode": "complete_episodes", "compress_observations": false, "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "enable_tf1_exec_eagerly": false, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "preprocessor_pref": "deepmind", "observation_filter": "NoFilter", "update_worker_filter_stats": true, "use_worker_filter_stats": true, "sampler_perf_stats_ema_coef": null, "_is_online": true, "num_learners": 0, "num_gpus_per_learner": 0, "num_cpus_per_learner": "auto", "num_aggregator_actors_per_learner": 0, "max_requests_in_flight_per_aggregator_actor": 3, "local_gpu_idx": 0, "max_requests_in_flight_per_learner": 3, "gamma": 1, "lr": 0.0002847858517, "grad_clip": 0.5, "grad_clip_by": "global_norm", "_train_batch_size_per_learner": 5000, "train_batch_size": 4000, "num_epochs": 1, "minibatch_size": 1000, "shuffle_batch_per_epoch": true, "model": {"fcnet_hiddens": [256, 256], "fcnet_activation": "tanh", "fcnet_weights_initializer": null, "fcnet_weights_initializer_config": null, "fcnet_bias_initializer": null, "fcnet_bias_initializer_config": null, "conv_filters": null, "conv_activation": "relu", "conv_kernel_initializer": null, "conv_kernel_initializer_config": null, "conv_bias_initializer": null, "conv_bias_initializer_config": null, "conv_transpose_kernel_initializer": null, "conv_transpose_kernel_initializer_config": null, "conv_transpose_bias_initializer": null, "conv_transpose_bias_initializer_config": null, "post_fcnet_hiddens": [], "post_fcnet_activation": "relu", "post_fcnet_weights_initializer": null, "post_fcnet_weights_initializer_config": null, "post_fcnet_bias_initializer": null, "post_fcnet_bias_initializer_config": null, "free_log_std": false, "log_std_clip_param": 20.0, "no_final_linear": false, "vf_share_layers": false, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "lstm_weights_initializer": null, "lstm_weights_initializer_config": null, "lstm_bias_initializer": null, "lstm_bias_initializer_config": null, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "attention_use_n_prev_actions": 0, "attention_use_n_prev_rewards": 0, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": null, "custom_model_config": {}, "custom_action_dist": null, "custom_preprocessor": null, "encoder_latent_dim": null, "always_check_shapes": false, "lstm_use_prev_action_reward": -1, "_use_default_native_models": -1, "_disable_preprocessor_api": false, "_disable_action_flattening": false}, "_learner_connector": null, "add_default_connectors_to_learner_pipeline": true, "learner_config_dict": {}, "optimizer": {}, "_learner_class": null, "callbacks_on_algorithm_init": null, "callbacks_on_env_runners_recreated": null, "callbacks_on_offline_eval_runners_recreated": null, "callbacks_on_checkpoint_loaded": null, "callbacks_on_environment_created": null, "callbacks_on_episode_created": null, "callbacks_on_episode_start": null, "callbacks_on_episode_step": null, "callbacks_on_episode_end": null, "callbacks_on_evaluate_start": null, "callbacks_on_evaluate_end": null, "callbacks_on_evaluate_offline_start": null, "callbacks_on_evaluate_offline_end": null, "callbacks_on_sample_end": null, "callbacks_on_train_result": null, "explore": true, "enable_rl_module_and_learner": true, "enable_env_runner_and_connector_v2": true, "_prior_exploration_config": {"type": "StochasticSampling"}, "count_steps_by": "env_steps", "policy_map_capacity": 100, "policy_mapping_fn": "<function AlgorithmConfig.DEFAULT_POLICY_MAPPING_FN at 0x3881edb20>", "policies_to_train": null, "policy_states_are_swappable": false, "observation_fn": null, "offline_data_class": null, "input_read_method": "read_parquet", "input_read_method_kwargs": {}, "input_read_schema": {}, "input_read_episodes": false, "input_read_sample_batches": false, "input_read_batch_size": null, "input_filesystem": null, "input_filesystem_kwargs": {}, "input_compress_columns": ["obs", "new_obs"], "input_spaces_jsonable": true, "materialize_data": false, "materialize_mapped_data": true, "map_batches_kwargs": {}, "iter_batches_kwargs": {}, "ignore_final_observation": false, "prelearner_class": null, "prelearner_buffer_class": null, "prelearner_buffer_kwargs": {}, "prelearner_module_synch_period": 10, "dataset_num_iters_per_learner": null, "input_config": {}, "actions_in_input_normalized": false, "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_config": {}, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "output_max_rows_per_file": null, "output_write_remaining_data": false, "output_write_method": "write_parquet", "output_write_method_kwargs": {}, "output_filesystem": null, "output_filesystem_kwargs": {}, "output_write_episodes": true, "offline_sampling": false, "evaluation_interval": 1, "evaluation_duration": 20, "evaluation_duration_unit": "episodes", "evaluation_sample_timeout_s": 120.0, "evaluation_auto_duration_min_env_steps_per_sample": 100, "evaluation_auto_duration_max_env_steps_per_sample": 2000, "evaluation_parallel_to_training": false, "evaluation_force_reset_envs_before_iteration": true, "evaluation_config": null, "off_policy_estimation_methods": {}, "ope_split_batch_by_episode": true, "evaluation_num_env_runners": 1, "in_evaluation": false, "sync_filters_on_rollout_workers_timeout_s": 10.0, "offline_evaluation_interval": null, "num_offline_eval_runners": 0, "offline_loss_for_module_fn": null, "offline_evaluation_duration": 1, "offline_evaluation_parallel_to_training": false, "offline_evaluation_timeout_s": 120.0, "num_cpus_per_offline_eval_runner": 1, "num_gpus_per_offline_eval_runner": 0, "custom_resources_per_offline_eval_runner": {}, "restart_failed_offline_eval_runners": true, "ignore_offline_eval_runner_failures": false, "max_num_offline_eval_runner_restarts": 1000, "offline_eval_runner_restore_timeout_s": 1800.0, "max_requests_in_flight_per_offline_eval_runner": 1, "validate_offline_eval_runners_after_construction": true, "offline_eval_runner_health_probe_timeout_s": 30.0, "offline_eval_rl_module_inference_only": false, "broadcast_offline_eval_runner_states": false, "offline_eval_batch_size_per_runner": 256, "dataset_num_iters_per_eval_runner": 1, "keep_per_episode_custom_metrics": false, "metrics_episode_collection_timeout_s": 60.0, "metrics_num_episodes_for_smoothing": 100, "min_time_s_per_iteration": null, "min_train_timesteps_per_iteration": 0, "min_sample_timesteps_per_iteration": 0, "log_gradients": true, "export_native_model_files": false, "checkpoint_trainable_policies_only": false, "logger_creator": null, "logger_config": null, "log_level": "WARN", "log_sys_usage": true, "fake_sampler": false, "seed": 2, "restart_failed_env_runners": true, "ignore_env_runner_failures": false, "max_num_env_runner_restarts": 1000, "delay_between_env_runner_restarts_s": 60.0, "restart_failed_sub_environments": false, "num_consecutive_env_runner_failures_tolerance": 100, "env_runner_health_probe_timeout_s": 30.0, "env_runner_restore_timeout_s": 1800.0, "_model_config": {}, "_rl_module_spec": "RLModuleSpec(module_class=None, observation_space=None, action_space=None, inference_only=False, learner_only=False, model_config=DefaultModelConfig(fcnet_hiddens=[60, 90], fcnet_activation='tanh', fcnet_kernel_initializer=None, fcnet_kernel_initializer_kwargs=None, fcnet_bias_initializer=None, fcnet_bias_initializer_kwargs=None, conv_filters=None, conv_activation='relu', conv_kernel_initializer=None, conv_kernel_initializer_kwargs=None, conv_bias_initializer=None, conv_bias_initializer_kwargs=None, head_fcnet_hiddens=[], head_fcnet_activation='relu', head_fcnet_kernel_initializer=None, head_fcnet_kernel_initializer_kwargs=None, head_fcnet_bias_initializer=None, head_fcnet_bias_initializer_kwargs=None, free_log_std=False, log_std_clip_param=20.0, vf_share_layers=True, use_lstm=False, max_seq_len=20, lstm_cell_size=256, lstm_use_prev_action=False, lstm_use_prev_reward=False, lstm_kernel_initializer=None, lstm_kernel_initializer_kwargs=None, lstm_bias_initializer=None, lstm_bias_initializer_kwargs=None), catalog_class=None, load_state_path=None, model_config_dict=None)", "algorithm_config_overrides_per_module": {}, "_per_module_overrides": {}, "_validate_config": true, "_use_msgpack_checkpoints": false, "_torch_grad_scaler_class": null, "_torch_lr_scheduler_classes": null, "_tf_policy_handles_more_than_one_loss": false, "_disable_preprocessor_api": false, "_disable_action_flattening": false, "_disable_initialize_loss_from_dummy_batch": false, "_dont_auto_sync_env_runner_states": false, "env_task_fn": -1, "enable_connectors": -1, "simple_optimizer": false, "policy_map_cache": -1, "worker_cls": -1, "synchronize_filters": -1, "enable_async_evaluation": -1, "custom_async_evaluation_function": -1, "_enable_rl_module_api": -1, "auto_wrap_old_gym_envs": -1, "always_attach_evaluation_results": -1, "replay_sequence_length": null, "_disable_execution_plan_api": -1, "use_critic": true, "use_gae": true, "use_kl_loss": true, "kl_coeff": 0.7464963036515, "kl_target": 0.0270990929592, "vf_loss_coeff": 0.6688075857018, "entropy_coeff": 0.0090570820258, "clip_param": 0.1221781641624, "vf_clip_param": 0.1027808522125, "entropy_coeff_schedule": null, "lr_schedule": null, "sgd_minibatch_size": -1, "vf_share_layers": -1, "__stdout_file__": null, "__stderr_file__": null, "lambda": 0.9099046732075, "input": "sampler", "policies": {"default_policy": [null, null, null, null]}, "callbacks": "<class 'ray.rllib.callbacks.callbacks.RLlibCallback'>", "create_env_on_driver": false, "custom_eval_function": null, "framework": "torch"}, "time_since_restore": 18.009119272232056, "iterations_since_restore": 11, "perf": {"cpu_util_percent": 40.0, "ram_util_percent": 77.25}}
{"timers": {"training_iteration": 1.5485125574111498, "restore_env_runners": 1.1492787348461244e-05, "training_step": 1.5483754651000632, "env_runner_sampling_timer": 1.438972090988336, "learner_update_timer": 0.10637366769365805, "synch_weights": 0.0005507654357307354, "restore_eval_env_runners": 7.8407154453525e-06, "evaluation_iteration": 0.10468034197931474, "synch_eval_env_connectors": 0.0002086169082750372, "synch_env_connectors": 4.273157338834049e-06}, "env_runners": {"num_module_steps_sampled_lifetime": {"default_policy": -6165000.0}, "num_env_steps_sampled_lifetime": -6165000.0, "episode_len_mean": 20.0, "env_to_module_connector": {"timers": {"connectors": {"add_time_dim_to_batch_and_zero_pad": 2.3992343639721296e-06, "add_observations_from_episodes_to_batch": 3.0242159447204964e-06, "add_states_from_episodes_to_batch": 1.6898079608510218e-06, "numpy_to_tensor": 8.344174130995708e-06, "batch_individual_items": 6.151178656806781e-06}}, "connector_pipeline_timer": 4.31624154193922e-05}, "weights_seq_no": 11.0, "episode_len_min": 20, "num_agent_steps_sampled_lifetime": {"default_agent": -6165000.0}, "module_to_env_connector": {"connector_pipeline_timer": 0.0001031272810693043, "timers": {"connectors": {"tensor_to_numpy": 1.3001853320012608e-05, "listify_data_for_vector_env": 1.0748528196172267e-05, "get_actions": 3.870694593781801e-05, "un_batch_to_individual_items": 5.325280107200115e-06, "normalize_and_clip_actions": 9.291329547140151e-06, "remove_single_ts_time_rank_from_batch": 6.03592518306719e-07}}}, "env_reset_timer": 3.191284734937292e-05, "env_to_module_sum_episodes_length_out": 10.36823839457432, "env_to_module_sum_episodes_length_in": 10.36823839457432, "num_module_steps_sampled": {"default_policy": 5000.0}, "episode_return_mean": 4.980000000000002, "episode_len_max": 20, "num_env_steps_sampled": 5000.0, "num_episodes_lifetime": -308250.0, "agent_episode_returns_mean": {"default_agent": 4.980000000000002}, "episode_return_min": -11.5, "sample": 0.004803198654972806, "num_episodes": 250.0, "num_agent_steps_sampled": {"default_agent": 5000.0}, "rlmodule_inference_timer": 2.7194919585871475e-05, "module_episode_returns_mean": {"default_policy": 4.980000000000002}, "episode_return_max": 8.5, "env_step_timer": 1.3621762294366267e-05, "time_between_sampling": 0.0017845070229966903, "episode_duration_sec_mean": 0.004505125807132573, "num_env_steps_sampled_lifetime_throughput": 3756.8845540422526}, "learners": {"__all_modules__": {"learner_connector": {"timers": {"connectors": {"numpy_to_tensor": 5.843278086909912e-05, "add_observations_from_episodes_to_batch": 0.0008175277980976623, "add_one_ts_to_episodes_and_truncate": 0.00858273612455855, "add_states_from_episodes_to_batch": 2.8570113900297206e-06, "add_columns_from_episodes_to_train_batch": 0.03455786851797671, "add_time_dim_to_batch_and_zero_pad": 1.009481056584359e-05, "general_advantage_estimation": 0.006292854289182978, "batch_individual_items": 0.0325395557935649}}, "connector_pipeline_timer": 0.08297463624313729}, "num_module_steps_trained": 6000, "num_trainable_parameters": 6003, "num_module_steps_trained_lifetime": 72000, "learner_connector_sum_episodes_length_out": 5250.0, "num_env_steps_trained_lifetime": 378000, "num_env_steps_trained": 31500, "learner_connector_sum_episodes_length_in": 5000.0, "num_non_trainable_parameters": 0, "num_env_steps_trained_lifetime_throughput": 2334508.0582950134, "num_module_steps_trained_throughput": 446552.3551971329, "num_module_steps_trained_lifetime_throughput": 445876.4842725239}, "default_policy": {"module_train_batch_size_mean": 1000.0, "entropy": 0.4981132447719574, "mean_kl_loss": 0.0005731904529966414, "policy_loss": -0.09440136700868607, "default_optimizer_learning_rate": 0.0002847858517, "total_loss": -0.030171997845172882, "gradients_default_optimizer_global_norm": 0.06014768406748772, "diff_num_grad_updates_vs_sampler_policy": 1.0, "num_module_steps_trained": 6000, "num_trainable_parameters": 6003, "num_module_steps_trained_lifetime": 72000, "vf_loss_unclipped": 27.940900802612305, "vf_explained_var": -0.00040781497955322266, "curr_entropy_coeff": 0.0090570820258, "curr_kl_coeff": 0.00018225007806904614, "weights_seq_no": 12.0, "vf_loss": 0.10278083384037018, "num_module_steps_trained_lifetime_throughput": 447129.18579181575}}, "num_training_step_calls_per_iteration": 1, "evaluation": {"env_runners": {"env_to_module_connector": {"timers": {"connectors": {"add_time_dim_to_batch_and_zero_pad": 2.244108954076259e-06, "batch_individual_items": 6.0794454412522114e-06, "numpy_to_tensor": 8.1712195790065e-06, "add_observations_from_episodes_to_batch": 2.8446584033945027e-06, "add_states_from_episodes_to_batch": 1.6503002413193236e-06}}, "connector_pipeline_timer": 4.252363173698506e-05}, "module_episode_returns_mean": {"default_policy": -1.0}, "num_module_steps_sampled_lifetime": {"default_policy": 4800}, "episode_return_mean": -1.0, "env_step_timer": 1.3572508530180688e-05, "num_module_steps_sampled": {"default_policy": 400}, "episode_len_mean": 20.0, "module_to_env_connector": {"timers": {"connectors": {"normalize_and_clip_actions": 9.310791364738499e-06, "listify_data_for_vector_env": 1.06784990914478e-05, "get_actions": 3.4455764593235955e-05, "remove_single_ts_time_rank_from_batch": 5.729454617945529e-07, "tensor_to_numpy": 1.2667390319849749e-05, "un_batch_to_individual_items": 5.375544682082068e-06}}, "connector_pipeline_timer": 9.836738995902961e-05}, "num_env_steps_sampled": 400, "num_episodes_lifetime": 240, "sample": 0.09854140238739864, "episode_duration_sec_mean": 0.0044708875135984275, "num_env_steps_sampled_lifetime": 60400, "agent_episode_returns_mean": {"default_agent": -1.0}, "env_reset_timer": 0.00013901117281866243, "rlmodule_inference_timer": 2.672241422565425e-05, "num_agent_steps_sampled_lifetime": {"default_agent": 4800}, "episode_len_min": 20, "weights_seq_no": 12.0, "env_to_module_sum_episodes_length_out": 10.368238394574323, "num_agent_steps_sampled": {"default_agent": 400}, "env_to_module_sum_episodes_length_in": 10.368238394574323, "episode_len_max": 20, "episode_return_min": -14.5, "num_episodes": 20, "episode_return_max": 14.5, "time_between_sampling": 1.6007366726902827}, "num_healthy_workers": 1, "actor_manager_num_outstanding_async_reqs": 0, "num_remote_worker_restarts": 0}, "num_env_steps_sampled_lifetime": -6165000.0, "fault_tolerance": {"num_healthy_workers": 0, "num_remote_worker_restarts": 0}, "env_runner_group": {"actor_manager_num_outstanding_async_reqs": 0}, "done": false, "training_iteration": 12, "trial_id": "43aed_00000", "date": "2025-08-11_19-23-19", "timestamp": 1754932999, "time_this_iter_s": 1.6483209133148193, "time_total_s": 19.657440185546875, "pid": 14402, "hostname": "Mac", "node_ip": "127.0.0.1", "config": {"exploration_config": {}, "extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "placement_strategy": "PACK", "num_gpus": 0, "_fake_gpus": false, "num_cpus_for_main_process": 2, "eager_tracing": true, "eager_max_retraces": 20, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "torch_compile_learner": false, "torch_compile_learner_what_to_compile": "forward_train", "torch_compile_learner_dynamo_backend": "aot_eager", "torch_compile_learner_dynamo_mode": null, "torch_compile_worker": false, "torch_compile_worker_dynamo_backend": "aot_eager", "torch_compile_worker_dynamo_mode": null, "torch_ddp_kwargs": {}, "torch_skip_nan_gradients": false, "env": "Umbrella", "env_config": {}, "observation_space": null, "action_space": null, "clip_rewards": null, "normalize_actions": true, "clip_actions": false, "_is_atari": null, "disable_env_checking": false, "render_env": false, "action_mask_key": "action_mask", "env_runner_cls": null, "num_env_runners": 0, "create_local_env_runner": true, "num_envs_per_env_runner": 1, "gym_env_vectorize_mode": "SYNC", "num_cpus_per_env_runner": 1, "num_gpus_per_env_runner": 0, "custom_resources_per_env_runner": {}, "validate_env_runners_after_construction": true, "episodes_to_numpy": true, "max_requests_in_flight_per_env_runner": 1, "sample_timeout_s": 60.0, "_env_to_module_connector": null, "add_default_connectors_to_env_to_module_pipeline": true, "_module_to_env_connector": null, "add_default_connectors_to_module_to_env_pipeline": true, "merge_env_runner_states": "training_only", "broadcast_env_runner_states": true, "episode_lookback_horizon": 1, "rollout_fragment_length": "auto", "batch_mode": "complete_episodes", "compress_observations": false, "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "enable_tf1_exec_eagerly": false, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "preprocessor_pref": "deepmind", "observation_filter": "NoFilter", "update_worker_filter_stats": true, "use_worker_filter_stats": true, "sampler_perf_stats_ema_coef": null, "_is_online": true, "num_learners": 0, "num_gpus_per_learner": 0, "num_cpus_per_learner": "auto", "num_aggregator_actors_per_learner": 0, "max_requests_in_flight_per_aggregator_actor": 3, "local_gpu_idx": 0, "max_requests_in_flight_per_learner": 3, "gamma": 1, "lr": 0.0002847858517, "grad_clip": 0.5, "grad_clip_by": "global_norm", "_train_batch_size_per_learner": 5000, "train_batch_size": 4000, "num_epochs": 1, "minibatch_size": 1000, "shuffle_batch_per_epoch": true, "model": {"fcnet_hiddens": [256, 256], "fcnet_activation": "tanh", "fcnet_weights_initializer": null, "fcnet_weights_initializer_config": null, "fcnet_bias_initializer": null, "fcnet_bias_initializer_config": null, "conv_filters": null, "conv_activation": "relu", "conv_kernel_initializer": null, "conv_kernel_initializer_config": null, "conv_bias_initializer": null, "conv_bias_initializer_config": null, "conv_transpose_kernel_initializer": null, "conv_transpose_kernel_initializer_config": null, "conv_transpose_bias_initializer": null, "conv_transpose_bias_initializer_config": null, "post_fcnet_hiddens": [], "post_fcnet_activation": "relu", "post_fcnet_weights_initializer": null, "post_fcnet_weights_initializer_config": null, "post_fcnet_bias_initializer": null, "post_fcnet_bias_initializer_config": null, "free_log_std": false, "log_std_clip_param": 20.0, "no_final_linear": false, "vf_share_layers": false, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "lstm_weights_initializer": null, "lstm_weights_initializer_config": null, "lstm_bias_initializer": null, "lstm_bias_initializer_config": null, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "attention_use_n_prev_actions": 0, "attention_use_n_prev_rewards": 0, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": null, "custom_model_config": {}, "custom_action_dist": null, "custom_preprocessor": null, "encoder_latent_dim": null, "always_check_shapes": false, "lstm_use_prev_action_reward": -1, "_use_default_native_models": -1, "_disable_preprocessor_api": false, "_disable_action_flattening": false}, "_learner_connector": null, "add_default_connectors_to_learner_pipeline": true, "learner_config_dict": {}, "optimizer": {}, "_learner_class": null, "callbacks_on_algorithm_init": null, "callbacks_on_env_runners_recreated": null, "callbacks_on_offline_eval_runners_recreated": null, "callbacks_on_checkpoint_loaded": null, "callbacks_on_environment_created": null, "callbacks_on_episode_created": null, "callbacks_on_episode_start": null, "callbacks_on_episode_step": null, "callbacks_on_episode_end": null, "callbacks_on_evaluate_start": null, "callbacks_on_evaluate_end": null, "callbacks_on_evaluate_offline_start": null, "callbacks_on_evaluate_offline_end": null, "callbacks_on_sample_end": null, "callbacks_on_train_result": null, "explore": true, "enable_rl_module_and_learner": true, "enable_env_runner_and_connector_v2": true, "_prior_exploration_config": {"type": "StochasticSampling"}, "count_steps_by": "env_steps", "policy_map_capacity": 100, "policy_mapping_fn": "<function AlgorithmConfig.DEFAULT_POLICY_MAPPING_FN at 0x3881edb20>", "policies_to_train": null, "policy_states_are_swappable": false, "observation_fn": null, "offline_data_class": null, "input_read_method": "read_parquet", "input_read_method_kwargs": {}, "input_read_schema": {}, "input_read_episodes": false, "input_read_sample_batches": false, "input_read_batch_size": null, "input_filesystem": null, "input_filesystem_kwargs": {}, "input_compress_columns": ["obs", "new_obs"], "input_spaces_jsonable": true, "materialize_data": false, "materialize_mapped_data": true, "map_batches_kwargs": {}, "iter_batches_kwargs": {}, "ignore_final_observation": false, "prelearner_class": null, "prelearner_buffer_class": null, "prelearner_buffer_kwargs": {}, "prelearner_module_synch_period": 10, "dataset_num_iters_per_learner": null, "input_config": {}, "actions_in_input_normalized": false, "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_config": {}, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "output_max_rows_per_file": null, "output_write_remaining_data": false, "output_write_method": "write_parquet", "output_write_method_kwargs": {}, "output_filesystem": null, "output_filesystem_kwargs": {}, "output_write_episodes": true, "offline_sampling": false, "evaluation_interval": 1, "evaluation_duration": 20, "evaluation_duration_unit": "episodes", "evaluation_sample_timeout_s": 120.0, "evaluation_auto_duration_min_env_steps_per_sample": 100, "evaluation_auto_duration_max_env_steps_per_sample": 2000, "evaluation_parallel_to_training": false, "evaluation_force_reset_envs_before_iteration": true, "evaluation_config": null, "off_policy_estimation_methods": {}, "ope_split_batch_by_episode": true, "evaluation_num_env_runners": 1, "in_evaluation": false, "sync_filters_on_rollout_workers_timeout_s": 10.0, "offline_evaluation_interval": null, "num_offline_eval_runners": 0, "offline_loss_for_module_fn": null, "offline_evaluation_duration": 1, "offline_evaluation_parallel_to_training": false, "offline_evaluation_timeout_s": 120.0, "num_cpus_per_offline_eval_runner": 1, "num_gpus_per_offline_eval_runner": 0, "custom_resources_per_offline_eval_runner": {}, "restart_failed_offline_eval_runners": true, "ignore_offline_eval_runner_failures": false, "max_num_offline_eval_runner_restarts": 1000, "offline_eval_runner_restore_timeout_s": 1800.0, "max_requests_in_flight_per_offline_eval_runner": 1, "validate_offline_eval_runners_after_construction": true, "offline_eval_runner_health_probe_timeout_s": 30.0, "offline_eval_rl_module_inference_only": false, "broadcast_offline_eval_runner_states": false, "offline_eval_batch_size_per_runner": 256, "dataset_num_iters_per_eval_runner": 1, "keep_per_episode_custom_metrics": false, "metrics_episode_collection_timeout_s": 60.0, "metrics_num_episodes_for_smoothing": 100, "min_time_s_per_iteration": null, "min_train_timesteps_per_iteration": 0, "min_sample_timesteps_per_iteration": 0, "log_gradients": true, "export_native_model_files": false, "checkpoint_trainable_policies_only": false, "logger_creator": null, "logger_config": null, "log_level": "WARN", "log_sys_usage": true, "fake_sampler": false, "seed": 2, "restart_failed_env_runners": true, "ignore_env_runner_failures": false, "max_num_env_runner_restarts": 1000, "delay_between_env_runner_restarts_s": 60.0, "restart_failed_sub_environments": false, "num_consecutive_env_runner_failures_tolerance": 100, "env_runner_health_probe_timeout_s": 30.0, "env_runner_restore_timeout_s": 1800.0, "_model_config": {}, "_rl_module_spec": "RLModuleSpec(module_class=None, observation_space=None, action_space=None, inference_only=False, learner_only=False, model_config=DefaultModelConfig(fcnet_hiddens=[60, 90], fcnet_activation='tanh', fcnet_kernel_initializer=None, fcnet_kernel_initializer_kwargs=None, fcnet_bias_initializer=None, fcnet_bias_initializer_kwargs=None, conv_filters=None, conv_activation='relu', conv_kernel_initializer=None, conv_kernel_initializer_kwargs=None, conv_bias_initializer=None, conv_bias_initializer_kwargs=None, head_fcnet_hiddens=[], head_fcnet_activation='relu', head_fcnet_kernel_initializer=None, head_fcnet_kernel_initializer_kwargs=None, head_fcnet_bias_initializer=None, head_fcnet_bias_initializer_kwargs=None, free_log_std=False, log_std_clip_param=20.0, vf_share_layers=True, use_lstm=False, max_seq_len=20, lstm_cell_size=256, lstm_use_prev_action=False, lstm_use_prev_reward=False, lstm_kernel_initializer=None, lstm_kernel_initializer_kwargs=None, lstm_bias_initializer=None, lstm_bias_initializer_kwargs=None), catalog_class=None, load_state_path=None, model_config_dict=None)", "algorithm_config_overrides_per_module": {}, "_per_module_overrides": {}, "_validate_config": true, "_use_msgpack_checkpoints": false, "_torch_grad_scaler_class": null, "_torch_lr_scheduler_classes": null, "_tf_policy_handles_more_than_one_loss": false, "_disable_preprocessor_api": false, "_disable_action_flattening": false, "_disable_initialize_loss_from_dummy_batch": false, "_dont_auto_sync_env_runner_states": false, "env_task_fn": -1, "enable_connectors": -1, "simple_optimizer": false, "policy_map_cache": -1, "worker_cls": -1, "synchronize_filters": -1, "enable_async_evaluation": -1, "custom_async_evaluation_function": -1, "_enable_rl_module_api": -1, "auto_wrap_old_gym_envs": -1, "always_attach_evaluation_results": -1, "replay_sequence_length": null, "_disable_execution_plan_api": -1, "use_critic": true, "use_gae": true, "use_kl_loss": true, "kl_coeff": 0.7464963036515, "kl_target": 0.0270990929592, "vf_loss_coeff": 0.6688075857018, "entropy_coeff": 0.0090570820258, "clip_param": 0.1221781641624, "vf_clip_param": 0.1027808522125, "entropy_coeff_schedule": null, "lr_schedule": null, "sgd_minibatch_size": -1, "vf_share_layers": -1, "__stdout_file__": null, "__stderr_file__": null, "lambda": 0.9099046732075, "input": "sampler", "policies": {"default_policy": [null, null, null, null]}, "callbacks": "<class 'ray.rllib.callbacks.callbacks.RLlibCallback'>", "create_env_on_driver": false, "custom_eval_function": null, "framework": "torch"}, "time_since_restore": 19.657440185546875, "iterations_since_restore": 12, "perf": {"cpu_util_percent": 39.86666666666667, "ram_util_percent": 77.49999999999999}}
{"timers": {"training_iteration": 1.5484446359963502, "restore_env_runners": 1.1430359292660925e-05, "training_step": 1.5483072462895011, "env_runner_sampling_timer": 1.439062799669365, "learner_update_timer": 0.10621422226676595, "synch_weights": 0.000550513202065693, "restore_eval_env_runners": 7.823138789013203e-06, "evaluation_iteration": 0.10465183188950182, "synch_eval_env_connectors": 0.00020743198936096796, "synch_env_connectors": 4.268345728224396e-06}, "env_runners": {"num_module_steps_sampled_lifetime": {"default_policy": -6782500.0}, "num_env_steps_sampled_lifetime": -6782500.0, "episode_len_mean": 20.0, "env_to_module_connector": {"timers": {"connectors": {"add_time_dim_to_batch_and_zero_pad": 2.406300595115733e-06, "add_observations_from_episodes_to_batch": 2.9415582997481363e-06, "add_states_from_episodes_to_batch": 1.6826699179483714e-06, "numpy_to_tensor": 8.343250781536726e-06, "batch_individual_items": 6.111217212743257e-06}}, "connector_pipeline_timer": 4.293400779906303e-05}, "weights_seq_no": 12.0, "episode_len_min": 20, "num_agent_steps_sampled_lifetime": {"default_agent": -6782500.0}, "module_to_env_connector": {"connector_pipeline_timer": 0.00010268350300471838, "timers": {"connectors": {"tensor_to_numpy": 1.2926757626011811e-05, "listify_data_for_vector_env": 1.071141639118193e-05, "get_actions": 3.8564669172318684e-05, "un_batch_to_individual_items": 5.272970250713256e-06, "normalize_and_clip_actions": 9.27089863767197e-06, "remove_single_ts_time_rank_from_batch": 5.981578006724165e-07}}}, "env_reset_timer": 3.14963652074244e-05, "env_to_module_sum_episodes_length_out": 10.36823839457432, "env_to_module_sum_episodes_length_in": 10.36823839457432, "num_module_steps_sampled": {"default_policy": 5000.0}, "episode_return_mean": 5.619999999999999, "episode_len_max": 20, "num_env_steps_sampled": 5000.0, "num_episodes_lifetime": -339125.0, "agent_episode_returns_mean": {"default_agent": 5.619999999999999}, "episode_return_min": -11.5, "sample": 0.0047764215044425375, "num_episodes": 250.0, "num_agent_steps_sampled": {"default_agent": 5000.0}, "rlmodule_inference_timer": 2.6908130287932946e-05, "module_episode_returns_mean": {"default_policy": 5.619999999999999}, "episode_return_max": 8.5, "env_step_timer": 1.3625163669062497e-05, "time_between_sampling": 0.0016731623153997401, "episode_duration_sec_mean": 0.0044822236630134285, "num_env_steps_sampled_lifetime_throughput": 3776.4101352262787}, "learners": {"__all_modules__": {"learner_connector": {"timers": {"connectors": {"numpy_to_tensor": 5.836470262581576e-05, "add_observations_from_episodes_to_batch": 0.0008171625202140647, "add_one_ts_to_episodes_and_truncate": 0.008572038352844535, "add_states_from_episodes_to_batch": 2.855110862206756e-06, "add_columns_from_episodes_to_train_batch": 0.03455059358224649, "add_time_dim_to_batch_and_zero_pad": 1.008219258562134e-05, "general_advantage_estimation": 0.006282493656461331, "batch_individual_items": 0.032513464815013875}}, "connector_pipeline_timer": 0.08291949571020744}, "num_module_steps_trained": 6000, "num_trainable_parameters": 6003, "num_module_steps_trained_lifetime": 78000, "learner_connector_sum_episodes_length_out": 5250.0, "num_env_steps_trained_lifetime": 409500, "num_env_steps_trained": 31500, "learner_connector_sum_episodes_length_in": 5000.0, "num_non_trainable_parameters": 0, "num_env_steps_trained_lifetime_throughput": 2332976.3506110976, "num_module_steps_trained_throughput": 446183.6947226192, "num_module_steps_trained_lifetime_throughput": 445530.35182292206}, "default_policy": {"module_train_batch_size_mean": 1000.0, "entropy": 0.47185197472572327, "mean_kl_loss": 0.00074898696038872, "policy_loss": 0.06699463725090027, "default_optimizer_learning_rate": 0.0002847858517, "total_loss": 0.13146176934242249, "gradients_default_optimizer_global_norm": 0.030830301344394684, "diff_num_grad_updates_vs_sampler_policy": 1.0, "num_module_steps_trained": 6000, "num_trainable_parameters": 6003, "num_module_steps_trained_lifetime": 78000, "vf_loss_unclipped": 28.0755558013916, "vf_explained_var": -0.003191232681274414, "curr_entropy_coeff": 0.0090570820258, "curr_kl_coeff": 9.112503903452307e-05, "weights_seq_no": 13.0, "vf_loss": 0.10278083384037018, "num_module_steps_trained_lifetime_throughput": 446692.8647152353}}, "num_training_step_calls_per_iteration": 1, "evaluation": {"env_runners": {"env_to_module_connector": {"timers": {"connectors": {"add_time_dim_to_batch_and_zero_pad": 2.235386960250816e-06, "batch_individual_items": 6.0696768167581464e-06, "numpy_to_tensor": 8.149347132708482e-06, "add_observations_from_episodes_to_batch": 2.7609854140923585e-06, "add_states_from_episodes_to_batch": 1.6562773789849257e-06}}, "connector_pipeline_timer": 4.218326649901116e-05}, "module_episode_returns_mean": {"default_policy": -0.2}, "num_module_steps_sampled_lifetime": {"default_policy": 5200}, "episode_return_mean": -0.2, "env_step_timer": 1.360780156809322e-05, "num_module_steps_sampled": {"default_policy": 400}, "episode_len_mean": 20.0, "module_to_env_connector": {"timers": {"connectors": {"normalize_and_clip_actions": 9.169133168303785e-06, "listify_data_for_vector_env": 1.0639876519230994e-05, "get_actions": 3.437141308184366e-05, "remove_single_ts_time_rank_from_batch": 5.763381889095566e-07, "tensor_to_numpy": 1.2777176154976134e-05, "un_batch_to_individual_items": 5.307670541596105e-06}}, "connector_pipeline_timer": 9.816853508023426e-05}, "num_env_steps_sampled": 400, "num_episodes_lifetime": 260, "sample": 0.09852100919356917, "episode_duration_sec_mean": 0.004458397898124531, "num_env_steps_sampled_lifetime": 65400, "agent_episode_returns_mean": {"default_agent": -0.2}, "env_reset_timer": 0.0001383248103373711, "rlmodule_inference_timer": 2.6733771335156042e-05, "num_agent_steps_sampled_lifetime": {"default_agent": 5200}, "episode_len_min": 20, "weights_seq_no": 13.0, "env_to_module_sum_episodes_length_out": 10.368238394574323, "num_agent_steps_sampled": {"default_agent": 400}, "env_to_module_sum_episodes_length_in": 10.368238394574323, "episode_len_max": 20, "episode_return_min": -14.5, "num_episodes": 20, "episode_return_max": 14.5, "time_between_sampling": 1.600310493883559}, "num_healthy_workers": 1, "actor_manager_num_outstanding_async_reqs": 0, "num_remote_worker_restarts": 0}, "num_env_steps_sampled_lifetime": -6782500.0, "fault_tolerance": {"num_healthy_workers": 0, "num_remote_worker_restarts": 0}, "env_runner_group": {"actor_manager_num_outstanding_async_reqs": 0}, "done": false, "training_iteration": 13, "trial_id": "43aed_00000", "date": "2025-08-11_19-23-21", "timestamp": 1754933001, "time_this_iter_s": 1.6450870037078857, "time_total_s": 21.30252718925476, "pid": 14402, "hostname": "Mac", "node_ip": "127.0.0.1", "config": {"exploration_config": {}, "extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "placement_strategy": "PACK", "num_gpus": 0, "_fake_gpus": false, "num_cpus_for_main_process": 2, "eager_tracing": true, "eager_max_retraces": 20, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "torch_compile_learner": false, "torch_compile_learner_what_to_compile": "forward_train", "torch_compile_learner_dynamo_backend": "aot_eager", "torch_compile_learner_dynamo_mode": null, "torch_compile_worker": false, "torch_compile_worker_dynamo_backend": "aot_eager", "torch_compile_worker_dynamo_mode": null, "torch_ddp_kwargs": {}, "torch_skip_nan_gradients": false, "env": "Umbrella", "env_config": {}, "observation_space": null, "action_space": null, "clip_rewards": null, "normalize_actions": true, "clip_actions": false, "_is_atari": null, "disable_env_checking": false, "render_env": false, "action_mask_key": "action_mask", "env_runner_cls": null, "num_env_runners": 0, "create_local_env_runner": true, "num_envs_per_env_runner": 1, "gym_env_vectorize_mode": "SYNC", "num_cpus_per_env_runner": 1, "num_gpus_per_env_runner": 0, "custom_resources_per_env_runner": {}, "validate_env_runners_after_construction": true, "episodes_to_numpy": true, "max_requests_in_flight_per_env_runner": 1, "sample_timeout_s": 60.0, "_env_to_module_connector": null, "add_default_connectors_to_env_to_module_pipeline": true, "_module_to_env_connector": null, "add_default_connectors_to_module_to_env_pipeline": true, "merge_env_runner_states": "training_only", "broadcast_env_runner_states": true, "episode_lookback_horizon": 1, "rollout_fragment_length": "auto", "batch_mode": "complete_episodes", "compress_observations": false, "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "enable_tf1_exec_eagerly": false, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "preprocessor_pref": "deepmind", "observation_filter": "NoFilter", "update_worker_filter_stats": true, "use_worker_filter_stats": true, "sampler_perf_stats_ema_coef": null, "_is_online": true, "num_learners": 0, "num_gpus_per_learner": 0, "num_cpus_per_learner": "auto", "num_aggregator_actors_per_learner": 0, "max_requests_in_flight_per_aggregator_actor": 3, "local_gpu_idx": 0, "max_requests_in_flight_per_learner": 3, "gamma": 1, "lr": 0.0002847858517, "grad_clip": 0.5, "grad_clip_by": "global_norm", "_train_batch_size_per_learner": 5000, "train_batch_size": 4000, "num_epochs": 1, "minibatch_size": 1000, "shuffle_batch_per_epoch": true, "model": {"fcnet_hiddens": [256, 256], "fcnet_activation": "tanh", "fcnet_weights_initializer": null, "fcnet_weights_initializer_config": null, "fcnet_bias_initializer": null, "fcnet_bias_initializer_config": null, "conv_filters": null, "conv_activation": "relu", "conv_kernel_initializer": null, "conv_kernel_initializer_config": null, "conv_bias_initializer": null, "conv_bias_initializer_config": null, "conv_transpose_kernel_initializer": null, "conv_transpose_kernel_initializer_config": null, "conv_transpose_bias_initializer": null, "conv_transpose_bias_initializer_config": null, "post_fcnet_hiddens": [], "post_fcnet_activation": "relu", "post_fcnet_weights_initializer": null, "post_fcnet_weights_initializer_config": null, "post_fcnet_bias_initializer": null, "post_fcnet_bias_initializer_config": null, "free_log_std": false, "log_std_clip_param": 20.0, "no_final_linear": false, "vf_share_layers": false, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "lstm_weights_initializer": null, "lstm_weights_initializer_config": null, "lstm_bias_initializer": null, "lstm_bias_initializer_config": null, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "attention_use_n_prev_actions": 0, "attention_use_n_prev_rewards": 0, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": null, "custom_model_config": {}, "custom_action_dist": null, "custom_preprocessor": null, "encoder_latent_dim": null, "always_check_shapes": false, "lstm_use_prev_action_reward": -1, "_use_default_native_models": -1, "_disable_preprocessor_api": false, "_disable_action_flattening": false}, "_learner_connector": null, "add_default_connectors_to_learner_pipeline": true, "learner_config_dict": {}, "optimizer": {}, "_learner_class": null, "callbacks_on_algorithm_init": null, "callbacks_on_env_runners_recreated": null, "callbacks_on_offline_eval_runners_recreated": null, "callbacks_on_checkpoint_loaded": null, "callbacks_on_environment_created": null, "callbacks_on_episode_created": null, "callbacks_on_episode_start": null, "callbacks_on_episode_step": null, "callbacks_on_episode_end": null, "callbacks_on_evaluate_start": null, "callbacks_on_evaluate_end": null, "callbacks_on_evaluate_offline_start": null, "callbacks_on_evaluate_offline_end": null, "callbacks_on_sample_end": null, "callbacks_on_train_result": null, "explore": true, "enable_rl_module_and_learner": true, "enable_env_runner_and_connector_v2": true, "_prior_exploration_config": {"type": "StochasticSampling"}, "count_steps_by": "env_steps", "policy_map_capacity": 100, "policy_mapping_fn": "<function AlgorithmConfig.DEFAULT_POLICY_MAPPING_FN at 0x3881edb20>", "policies_to_train": null, "policy_states_are_swappable": false, "observation_fn": null, "offline_data_class": null, "input_read_method": "read_parquet", "input_read_method_kwargs": {}, "input_read_schema": {}, "input_read_episodes": false, "input_read_sample_batches": false, "input_read_batch_size": null, "input_filesystem": null, "input_filesystem_kwargs": {}, "input_compress_columns": ["obs", "new_obs"], "input_spaces_jsonable": true, "materialize_data": false, "materialize_mapped_data": true, "map_batches_kwargs": {}, "iter_batches_kwargs": {}, "ignore_final_observation": false, "prelearner_class": null, "prelearner_buffer_class": null, "prelearner_buffer_kwargs": {}, "prelearner_module_synch_period": 10, "dataset_num_iters_per_learner": null, "input_config": {}, "actions_in_input_normalized": false, "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_config": {}, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "output_max_rows_per_file": null, "output_write_remaining_data": false, "output_write_method": "write_parquet", "output_write_method_kwargs": {}, "output_filesystem": null, "output_filesystem_kwargs": {}, "output_write_episodes": true, "offline_sampling": false, "evaluation_interval": 1, "evaluation_duration": 20, "evaluation_duration_unit": "episodes", "evaluation_sample_timeout_s": 120.0, "evaluation_auto_duration_min_env_steps_per_sample": 100, "evaluation_auto_duration_max_env_steps_per_sample": 2000, "evaluation_parallel_to_training": false, "evaluation_force_reset_envs_before_iteration": true, "evaluation_config": null, "off_policy_estimation_methods": {}, "ope_split_batch_by_episode": true, "evaluation_num_env_runners": 1, "in_evaluation": false, "sync_filters_on_rollout_workers_timeout_s": 10.0, "offline_evaluation_interval": null, "num_offline_eval_runners": 0, "offline_loss_for_module_fn": null, "offline_evaluation_duration": 1, "offline_evaluation_parallel_to_training": false, "offline_evaluation_timeout_s": 120.0, "num_cpus_per_offline_eval_runner": 1, "num_gpus_per_offline_eval_runner": 0, "custom_resources_per_offline_eval_runner": {}, "restart_failed_offline_eval_runners": true, "ignore_offline_eval_runner_failures": false, "max_num_offline_eval_runner_restarts": 1000, "offline_eval_runner_restore_timeout_s": 1800.0, "max_requests_in_flight_per_offline_eval_runner": 1, "validate_offline_eval_runners_after_construction": true, "offline_eval_runner_health_probe_timeout_s": 30.0, "offline_eval_rl_module_inference_only": false, "broadcast_offline_eval_runner_states": false, "offline_eval_batch_size_per_runner": 256, "dataset_num_iters_per_eval_runner": 1, "keep_per_episode_custom_metrics": false, "metrics_episode_collection_timeout_s": 60.0, "metrics_num_episodes_for_smoothing": 100, "min_time_s_per_iteration": null, "min_train_timesteps_per_iteration": 0, "min_sample_timesteps_per_iteration": 0, "log_gradients": true, "export_native_model_files": false, "checkpoint_trainable_policies_only": false, "logger_creator": null, "logger_config": null, "log_level": "WARN", "log_sys_usage": true, "fake_sampler": false, "seed": 2, "restart_failed_env_runners": true, "ignore_env_runner_failures": false, "max_num_env_runner_restarts": 1000, "delay_between_env_runner_restarts_s": 60.0, "restart_failed_sub_environments": false, "num_consecutive_env_runner_failures_tolerance": 100, "env_runner_health_probe_timeout_s": 30.0, "env_runner_restore_timeout_s": 1800.0, "_model_config": {}, "_rl_module_spec": "RLModuleSpec(module_class=None, observation_space=None, action_space=None, inference_only=False, learner_only=False, model_config=DefaultModelConfig(fcnet_hiddens=[60, 90], fcnet_activation='tanh', fcnet_kernel_initializer=None, fcnet_kernel_initializer_kwargs=None, fcnet_bias_initializer=None, fcnet_bias_initializer_kwargs=None, conv_filters=None, conv_activation='relu', conv_kernel_initializer=None, conv_kernel_initializer_kwargs=None, conv_bias_initializer=None, conv_bias_initializer_kwargs=None, head_fcnet_hiddens=[], head_fcnet_activation='relu', head_fcnet_kernel_initializer=None, head_fcnet_kernel_initializer_kwargs=None, head_fcnet_bias_initializer=None, head_fcnet_bias_initializer_kwargs=None, free_log_std=False, log_std_clip_param=20.0, vf_share_layers=True, use_lstm=False, max_seq_len=20, lstm_cell_size=256, lstm_use_prev_action=False, lstm_use_prev_reward=False, lstm_kernel_initializer=None, lstm_kernel_initializer_kwargs=None, lstm_bias_initializer=None, lstm_bias_initializer_kwargs=None), catalog_class=None, load_state_path=None, model_config_dict=None)", "algorithm_config_overrides_per_module": {}, "_per_module_overrides": {}, "_validate_config": true, "_use_msgpack_checkpoints": false, "_torch_grad_scaler_class": null, "_torch_lr_scheduler_classes": null, "_tf_policy_handles_more_than_one_loss": false, "_disable_preprocessor_api": false, "_disable_action_flattening": false, "_disable_initialize_loss_from_dummy_batch": false, "_dont_auto_sync_env_runner_states": false, "env_task_fn": -1, "enable_connectors": -1, "simple_optimizer": false, "policy_map_cache": -1, "worker_cls": -1, "synchronize_filters": -1, "enable_async_evaluation": -1, "custom_async_evaluation_function": -1, "_enable_rl_module_api": -1, "auto_wrap_old_gym_envs": -1, "always_attach_evaluation_results": -1, "replay_sequence_length": null, "_disable_execution_plan_api": -1, "use_critic": true, "use_gae": true, "use_kl_loss": true, "kl_coeff": 0.7464963036515, "kl_target": 0.0270990929592, "vf_loss_coeff": 0.6688075857018, "entropy_coeff": 0.0090570820258, "clip_param": 0.1221781641624, "vf_clip_param": 0.1027808522125, "entropy_coeff_schedule": null, "lr_schedule": null, "sgd_minibatch_size": -1, "vf_share_layers": -1, "__stdout_file__": null, "__stderr_file__": null, "lambda": 0.9099046732075, "input": "sampler", "policies": {"default_policy": [null, null, null, null]}, "callbacks": "<class 'ray.rllib.callbacks.callbacks.RLlibCallback'>", "create_env_on_driver": false, "custom_eval_function": null, "framework": "torch"}, "time_since_restore": 21.30252718925476, "iterations_since_restore": 13, "perf": {"cpu_util_percent": 40.2, "ram_util_percent": 77.45}}
{"timers": {"training_iteration": 1.5486835683854854, "restore_env_runners": 1.1372305254934654e-05, "training_step": 1.5485458950764714, "env_runner_sampling_timer": 1.4384807437531233, "learner_update_timer": 0.10703485337453345, "synch_weights": 0.0005507222392827988, "restore_eval_env_runners": 7.803237298124457e-06, "evaluation_iteration": 0.10461629107072512, "synch_eval_env_connectors": 0.00020625725024032445, "synch_env_connectors": 4.264002493032634e-06}, "env_runners": {"num_module_steps_sampled_lifetime": {"default_policy": -7400000.0}, "num_env_steps_sampled_lifetime": -7400000.0, "episode_len_mean": 20.0, "env_to_module_connector": {"timers": {"connectors": {"add_time_dim_to_batch_and_zero_pad": 2.416425756041493e-06, "add_observations_from_episodes_to_batch": 2.9661914425024576e-06, "add_states_from_episodes_to_batch": 1.6824087124796047e-06, "numpy_to_tensor": 8.551776743614562e-06, "batch_individual_items": 6.2961984370958936e-06}}, "connector_pipeline_timer": 4.349958436735557e-05}, "weights_seq_no": 13.0, "episode_len_min": 20, "num_agent_steps_sampled_lifetime": {"default_agent": -7400000.0}, "module_to_env_connector": {"connector_pipeline_timer": 0.00010444701153103567, "timers": {"connectors": {"tensor_to_numpy": 1.320012315629392e-05, "listify_data_for_vector_env": 1.0949243397771408e-05, "get_actions": 3.932983478106195e-05, "un_batch_to_individual_items": 5.322286962784043e-06, "normalize_and_clip_actions": 9.42646273109843e-06, "remove_single_ts_time_rank_from_batch": 6.135092441117585e-07}}}, "env_reset_timer": 3.36456187790443e-05, "env_to_module_sum_episodes_length_out": 10.36823839457432, "env_to_module_sum_episodes_length_in": 10.36823839457432, "num_module_steps_sampled": {"default_policy": 5000.0}, "episode_return_mean": 5.299999999999998, "episode_len_max": 20, "num_env_steps_sampled": 5000.0, "num_episodes_lifetime": -370000.0, "agent_episode_returns_mean": {"default_agent": 5.299999999999998}, "episode_return_min": -11.5, "sample": 0.004856000428842028, "num_episodes": 250.0, "num_agent_steps_sampled": {"default_agent": 5000.0}, "rlmodule_inference_timer": 2.7875528447960578e-05, "module_episode_returns_mean": {"default_policy": 5.299999999999998}, "episode_return_max": 8.5, "env_step_timer": 1.391070771757408e-05, "time_between_sampling": 0.001669600700594646, "episode_duration_sec_mean": 0.004566366170998662, "num_env_steps_sampled_lifetime_throughput": 3730.229685317482}, "learners": {"__all_modules__": {"learner_connector": {"timers": {"connectors": {"numpy_to_tensor": 5.8451054880502066e-05, "add_observations_from_episodes_to_batch": 0.0008174404750666542, "add_one_ts_to_episodes_and_truncate": 0.008561768388997236, "add_states_from_episodes_to_batch": 2.8536495989738162e-06, "add_columns_from_episodes_to_train_batch": 0.034550960555953164, "add_time_dim_to_batch_and_zero_pad": 1.0073870782029155e-05, "general_advantage_estimation": 0.006272556219229145, "batch_individual_items": 0.03345150350698502}}, "connector_pipeline_timer": 0.08383798200250411}, "num_module_steps_trained": 6000, "num_trainable_parameters": 6003, "num_module_steps_trained_lifetime": 84000, "learner_connector_sum_episodes_length_out": 5250.0, "num_env_steps_trained_lifetime": 441000, "num_env_steps_trained": 31500, "learner_connector_sum_episodes_length_in": 5000.0, "num_non_trainable_parameters": 0, "num_env_steps_trained_lifetime_throughput": 2331025.62740341, "num_module_steps_trained_throughput": 445737.99587579153, "num_module_steps_trained_lifetime_throughput": 445106.4897149294}, "default_policy": {"module_train_batch_size_mean": 1000.0, "entropy": 0.4444359540939331, "mean_kl_loss": 0.000890470459125936, "policy_loss": -0.10861422121524811, "default_optimizer_learning_rate": 0.0002847858517, "total_loss": -0.043898805975914, "gradients_default_optimizer_global_norm": 0.011624989099800587, "diff_num_grad_updates_vs_sampler_policy": 1.0, "num_module_steps_trained": 6000, "num_trainable_parameters": 6003, "num_module_steps_trained_lifetime": 84000, "vf_loss_unclipped": 27.947935104370117, "vf_explained_var": 0.001467287540435791, "curr_entropy_coeff": 0.0090570820258, "curr_kl_coeff": 4.5562519517261535e-05, "weights_seq_no": 14.0, "vf_loss": 0.10278083384037018, "num_module_steps_trained_lifetime_throughput": 446181.6505733474}}, "num_training_step_calls_per_iteration": 1, "evaluation": {"env_runners": {"env_to_module_connector": {"timers": {"connectors": {"add_time_dim_to_batch_and_zero_pad": 2.2454250620635374e-06, "batch_individual_items": 6.081720912426275e-06, "numpy_to_tensor": 8.166668437343389e-06, "add_observations_from_episodes_to_batch": 2.7561871682372806e-06, "add_states_from_episodes_to_batch": 1.6471367769376139e-06}}, "connector_pipeline_timer": 4.223532080979067e-05}, "module_episode_returns_mean": {"default_policy": 0.2}, "num_module_steps_sampled_lifetime": {"default_policy": 5600}, "episode_return_mean": 0.2, "env_step_timer": 1.3547581340175449e-05, "num_module_steps_sampled": {"default_policy": 400}, "episode_len_mean": 20.0, "module_to_env_connector": {"timers": {"connectors": {"normalize_and_clip_actions": 9.253345603614997e-06, "listify_data_for_vector_env": 1.0644013587487665e-05, "get_actions": 3.402365895439691e-05, "remove_single_ts_time_rank_from_batch": 5.801575874081758e-07, "tensor_to_numpy": 1.2631302618017269e-05, "un_batch_to_individual_items": 5.272901317886713e-06}}, "connector_pipeline_timer": 9.763478785604685e-05}, "num_env_steps_sampled": 400, "num_episodes_lifetime": 280, "sample": 0.09850142618192871, "episode_duration_sec_mean": 0.004453984571155161, "num_env_steps_sampled_lifetime": 70400, "agent_episode_returns_mean": {"default_agent": 0.2}, "env_reset_timer": 0.0001376815620479564, "rlmodule_inference_timer": 2.674224937713241e-05, "num_agent_steps_sampled_lifetime": {"default_agent": 5600}, "episode_len_min": 20, "weights_seq_no": 14.0, "env_to_module_sum_episodes_length_out": 10.368238394574323, "num_agent_steps_sampled": {"default_agent": 400}, "env_to_module_sum_episodes_length_in": 10.368238394574323, "episode_len_max": 20, "episode_return_min": -14.5, "num_episodes": 20, "episode_return_max": 14.5, "time_between_sampling": 1.60019061311468}, "num_healthy_workers": 1, "actor_manager_num_outstanding_async_reqs": 0, "num_remote_worker_restarts": 0}, "num_env_steps_sampled_lifetime": -7400000.0, "fault_tolerance": {"num_healthy_workers": 0, "num_remote_worker_restarts": 0}, "env_runner_group": {"actor_manager_num_outstanding_async_reqs": 0}, "done": false, "training_iteration": 14, "trial_id": "43aed_00000", "date": "2025-08-11_19-23-22", "timestamp": 1754933002, "time_this_iter_s": 1.6759798526763916, "time_total_s": 22.978507041931152, "pid": 14402, "hostname": "Mac", "node_ip": "127.0.0.1", "config": {"exploration_config": {}, "extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "placement_strategy": "PACK", "num_gpus": 0, "_fake_gpus": false, "num_cpus_for_main_process": 2, "eager_tracing": true, "eager_max_retraces": 20, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "torch_compile_learner": false, "torch_compile_learner_what_to_compile": "forward_train", "torch_compile_learner_dynamo_backend": "aot_eager", "torch_compile_learner_dynamo_mode": null, "torch_compile_worker": false, "torch_compile_worker_dynamo_backend": "aot_eager", "torch_compile_worker_dynamo_mode": null, "torch_ddp_kwargs": {}, "torch_skip_nan_gradients": false, "env": "Umbrella", "env_config": {}, "observation_space": null, "action_space": null, "clip_rewards": null, "normalize_actions": true, "clip_actions": false, "_is_atari": null, "disable_env_checking": false, "render_env": false, "action_mask_key": "action_mask", "env_runner_cls": null, "num_env_runners": 0, "create_local_env_runner": true, "num_envs_per_env_runner": 1, "gym_env_vectorize_mode": "SYNC", "num_cpus_per_env_runner": 1, "num_gpus_per_env_runner": 0, "custom_resources_per_env_runner": {}, "validate_env_runners_after_construction": true, "episodes_to_numpy": true, "max_requests_in_flight_per_env_runner": 1, "sample_timeout_s": 60.0, "_env_to_module_connector": null, "add_default_connectors_to_env_to_module_pipeline": true, "_module_to_env_connector": null, "add_default_connectors_to_module_to_env_pipeline": true, "merge_env_runner_states": "training_only", "broadcast_env_runner_states": true, "episode_lookback_horizon": 1, "rollout_fragment_length": "auto", "batch_mode": "complete_episodes", "compress_observations": false, "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "enable_tf1_exec_eagerly": false, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "preprocessor_pref": "deepmind", "observation_filter": "NoFilter", "update_worker_filter_stats": true, "use_worker_filter_stats": true, "sampler_perf_stats_ema_coef": null, "_is_online": true, "num_learners": 0, "num_gpus_per_learner": 0, "num_cpus_per_learner": "auto", "num_aggregator_actors_per_learner": 0, "max_requests_in_flight_per_aggregator_actor": 3, "local_gpu_idx": 0, "max_requests_in_flight_per_learner": 3, "gamma": 1, "lr": 0.0002847858517, "grad_clip": 0.5, "grad_clip_by": "global_norm", "_train_batch_size_per_learner": 5000, "train_batch_size": 4000, "num_epochs": 1, "minibatch_size": 1000, "shuffle_batch_per_epoch": true, "model": {"fcnet_hiddens": [256, 256], "fcnet_activation": "tanh", "fcnet_weights_initializer": null, "fcnet_weights_initializer_config": null, "fcnet_bias_initializer": null, "fcnet_bias_initializer_config": null, "conv_filters": null, "conv_activation": "relu", "conv_kernel_initializer": null, "conv_kernel_initializer_config": null, "conv_bias_initializer": null, "conv_bias_initializer_config": null, "conv_transpose_kernel_initializer": null, "conv_transpose_kernel_initializer_config": null, "conv_transpose_bias_initializer": null, "conv_transpose_bias_initializer_config": null, "post_fcnet_hiddens": [], "post_fcnet_activation": "relu", "post_fcnet_weights_initializer": null, "post_fcnet_weights_initializer_config": null, "post_fcnet_bias_initializer": null, "post_fcnet_bias_initializer_config": null, "free_log_std": false, "log_std_clip_param": 20.0, "no_final_linear": false, "vf_share_layers": false, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "lstm_weights_initializer": null, "lstm_weights_initializer_config": null, "lstm_bias_initializer": null, "lstm_bias_initializer_config": null, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "attention_use_n_prev_actions": 0, "attention_use_n_prev_rewards": 0, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": null, "custom_model_config": {}, "custom_action_dist": null, "custom_preprocessor": null, "encoder_latent_dim": null, "always_check_shapes": false, "lstm_use_prev_action_reward": -1, "_use_default_native_models": -1, "_disable_preprocessor_api": false, "_disable_action_flattening": false}, "_learner_connector": null, "add_default_connectors_to_learner_pipeline": true, "learner_config_dict": {}, "optimizer": {}, "_learner_class": null, "callbacks_on_algorithm_init": null, "callbacks_on_env_runners_recreated": null, "callbacks_on_offline_eval_runners_recreated": null, "callbacks_on_checkpoint_loaded": null, "callbacks_on_environment_created": null, "callbacks_on_episode_created": null, "callbacks_on_episode_start": null, "callbacks_on_episode_step": null, "callbacks_on_episode_end": null, "callbacks_on_evaluate_start": null, "callbacks_on_evaluate_end": null, "callbacks_on_evaluate_offline_start": null, "callbacks_on_evaluate_offline_end": null, "callbacks_on_sample_end": null, "callbacks_on_train_result": null, "explore": true, "enable_rl_module_and_learner": true, "enable_env_runner_and_connector_v2": true, "_prior_exploration_config": {"type": "StochasticSampling"}, "count_steps_by": "env_steps", "policy_map_capacity": 100, "policy_mapping_fn": "<function AlgorithmConfig.DEFAULT_POLICY_MAPPING_FN at 0x3881edb20>", "policies_to_train": null, "policy_states_are_swappable": false, "observation_fn": null, "offline_data_class": null, "input_read_method": "read_parquet", "input_read_method_kwargs": {}, "input_read_schema": {}, "input_read_episodes": false, "input_read_sample_batches": false, "input_read_batch_size": null, "input_filesystem": null, "input_filesystem_kwargs": {}, "input_compress_columns": ["obs", "new_obs"], "input_spaces_jsonable": true, "materialize_data": false, "materialize_mapped_data": true, "map_batches_kwargs": {}, "iter_batches_kwargs": {}, "ignore_final_observation": false, "prelearner_class": null, "prelearner_buffer_class": null, "prelearner_buffer_kwargs": {}, "prelearner_module_synch_period": 10, "dataset_num_iters_per_learner": null, "input_config": {}, "actions_in_input_normalized": false, "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_config": {}, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "output_max_rows_per_file": null, "output_write_remaining_data": false, "output_write_method": "write_parquet", "output_write_method_kwargs": {}, "output_filesystem": null, "output_filesystem_kwargs": {}, "output_write_episodes": true, "offline_sampling": false, "evaluation_interval": 1, "evaluation_duration": 20, "evaluation_duration_unit": "episodes", "evaluation_sample_timeout_s": 120.0, "evaluation_auto_duration_min_env_steps_per_sample": 100, "evaluation_auto_duration_max_env_steps_per_sample": 2000, "evaluation_parallel_to_training": false, "evaluation_force_reset_envs_before_iteration": true, "evaluation_config": null, "off_policy_estimation_methods": {}, "ope_split_batch_by_episode": true, "evaluation_num_env_runners": 1, "in_evaluation": false, "sync_filters_on_rollout_workers_timeout_s": 10.0, "offline_evaluation_interval": null, "num_offline_eval_runners": 0, "offline_loss_for_module_fn": null, "offline_evaluation_duration": 1, "offline_evaluation_parallel_to_training": false, "offline_evaluation_timeout_s": 120.0, "num_cpus_per_offline_eval_runner": 1, "num_gpus_per_offline_eval_runner": 0, "custom_resources_per_offline_eval_runner": {}, "restart_failed_offline_eval_runners": true, "ignore_offline_eval_runner_failures": false, "max_num_offline_eval_runner_restarts": 1000, "offline_eval_runner_restore_timeout_s": 1800.0, "max_requests_in_flight_per_offline_eval_runner": 1, "validate_offline_eval_runners_after_construction": true, "offline_eval_runner_health_probe_timeout_s": 30.0, "offline_eval_rl_module_inference_only": false, "broadcast_offline_eval_runner_states": false, "offline_eval_batch_size_per_runner": 256, "dataset_num_iters_per_eval_runner": 1, "keep_per_episode_custom_metrics": false, "metrics_episode_collection_timeout_s": 60.0, "metrics_num_episodes_for_smoothing": 100, "min_time_s_per_iteration": null, "min_train_timesteps_per_iteration": 0, "min_sample_timesteps_per_iteration": 0, "log_gradients": true, "export_native_model_files": false, "checkpoint_trainable_policies_only": false, "logger_creator": null, "logger_config": null, "log_level": "WARN", "log_sys_usage": true, "fake_sampler": false, "seed": 2, "restart_failed_env_runners": true, "ignore_env_runner_failures": false, "max_num_env_runner_restarts": 1000, "delay_between_env_runner_restarts_s": 60.0, "restart_failed_sub_environments": false, "num_consecutive_env_runner_failures_tolerance": 100, "env_runner_health_probe_timeout_s": 30.0, "env_runner_restore_timeout_s": 1800.0, "_model_config": {}, "_rl_module_spec": "RLModuleSpec(module_class=None, observation_space=None, action_space=None, inference_only=False, learner_only=False, model_config=DefaultModelConfig(fcnet_hiddens=[60, 90], fcnet_activation='tanh', fcnet_kernel_initializer=None, fcnet_kernel_initializer_kwargs=None, fcnet_bias_initializer=None, fcnet_bias_initializer_kwargs=None, conv_filters=None, conv_activation='relu', conv_kernel_initializer=None, conv_kernel_initializer_kwargs=None, conv_bias_initializer=None, conv_bias_initializer_kwargs=None, head_fcnet_hiddens=[], head_fcnet_activation='relu', head_fcnet_kernel_initializer=None, head_fcnet_kernel_initializer_kwargs=None, head_fcnet_bias_initializer=None, head_fcnet_bias_initializer_kwargs=None, free_log_std=False, log_std_clip_param=20.0, vf_share_layers=True, use_lstm=False, max_seq_len=20, lstm_cell_size=256, lstm_use_prev_action=False, lstm_use_prev_reward=False, lstm_kernel_initializer=None, lstm_kernel_initializer_kwargs=None, lstm_bias_initializer=None, lstm_bias_initializer_kwargs=None), catalog_class=None, load_state_path=None, model_config_dict=None)", "algorithm_config_overrides_per_module": {}, "_per_module_overrides": {}, "_validate_config": true, "_use_msgpack_checkpoints": false, "_torch_grad_scaler_class": null, "_torch_lr_scheduler_classes": null, "_tf_policy_handles_more_than_one_loss": false, "_disable_preprocessor_api": false, "_disable_action_flattening": false, "_disable_initialize_loss_from_dummy_batch": false, "_dont_auto_sync_env_runner_states": false, "env_task_fn": -1, "enable_connectors": -1, "simple_optimizer": false, "policy_map_cache": -1, "worker_cls": -1, "synchronize_filters": -1, "enable_async_evaluation": -1, "custom_async_evaluation_function": -1, "_enable_rl_module_api": -1, "auto_wrap_old_gym_envs": -1, "always_attach_evaluation_results": -1, "replay_sequence_length": null, "_disable_execution_plan_api": -1, "use_critic": true, "use_gae": true, "use_kl_loss": true, "kl_coeff": 0.7464963036515, "kl_target": 0.0270990929592, "vf_loss_coeff": 0.6688075857018, "entropy_coeff": 0.0090570820258, "clip_param": 0.1221781641624, "vf_clip_param": 0.1027808522125, "entropy_coeff_schedule": null, "lr_schedule": null, "sgd_minibatch_size": -1, "vf_share_layers": -1, "__stdout_file__": null, "__stderr_file__": null, "lambda": 0.9099046732075, "input": "sampler", "policies": {"default_policy": [null, null, null, null]}, "callbacks": "<class 'ray.rllib.callbacks.callbacks.RLlibCallback'>", "create_env_on_driver": false, "custom_eval_function": null, "framework": "torch"}, "time_since_restore": 22.978507041931152, "iterations_since_restore": 14, "perf": {"cpu_util_percent": 41.0, "ram_util_percent": 77.85}}
{"timers": {"training_iteration": 1.5488648977008548, "restore_env_runners": 1.1319831795658113e-05, "training_step": 1.5487266040456964, "env_runner_sampling_timer": 1.4378763725659733, "learner_update_timer": 0.10781826734147468, "synch_weights": 0.0005514912672411912, "restore_eval_env_runners": 7.791865502574533e-06, "evaluation_iteration": 0.10458365316032558, "synch_eval_env_connectors": 0.00020531509837639305, "synch_env_connectors": 4.2572032532331665e-06}, "env_runners": {"num_module_steps_sampled_lifetime": {"default_policy": -8017500.0}, "num_env_steps_sampled_lifetime": -8017500.0, "episode_len_mean": 20.0, "env_to_module_connector": {"timers": {"connectors": {"add_time_dim_to_batch_and_zero_pad": 2.405083047923023e-06, "add_observations_from_episodes_to_batch": 3.0375765934033326e-06, "add_states_from_episodes_to_batch": 1.7087624373902885e-06, "numpy_to_tensor": 8.477123953980637e-06, "batch_individual_items": 6.22058919809226e-06}}, "connector_pipeline_timer": 4.3588286655635796e-05}, "weights_seq_no": 14.0, "episode_len_min": 20, "num_agent_steps_sampled_lifetime": {"default_agent": -8017500.0}, "module_to_env_connector": {"connector_pipeline_timer": 0.00010390986081858647, "timers": {"connectors": {"tensor_to_numpy": 1.3054020951787472e-05, "listify_data_for_vector_env": 1.0872597700546575e-05, "get_actions": 3.9011582177538284e-05, "un_batch_to_individual_items": 5.383167425168987e-06, "normalize_and_clip_actions": 9.3454604635348e-06, "remove_single_ts_time_rank_from_batch": 6.112495406088315e-07}}}, "env_reset_timer": 3.259256252987333e-05, "env_to_module_sum_episodes_length_out": 10.36823839457432, "env_to_module_sum_episodes_length_in": 10.36823839457432, "num_module_steps_sampled": {"default_policy": 5000.0}, "episode_return_mean": 6.74, "episode_len_max": 20, "num_env_steps_sampled": 5000.0, "num_episodes_lifetime": -400875.0, "agent_episode_returns_mean": {"default_agent": 6.74}, "episode_return_min": -11.5, "sample": 0.00482642321159771, "num_episodes": 250.0, "num_agent_steps_sampled": {"default_agent": 5000.0}, "rlmodule_inference_timer": 2.7195388894685992e-05, "module_episode_returns_mean": {"default_policy": 6.74}, "episode_return_max": 8.5, "env_step_timer": 1.3833714642847643e-05, "time_between_sampling": 0.001852972543292855, "episode_duration_sec_mean": 0.004545505500864237, "num_env_steps_sampled_lifetime_throughput": 3757.0807304095406}, "learners": {"__all_modules__": {"learner_connector": {"timers": {"connectors": {"numpy_to_tensor": 5.848904383302968e-05, "add_observations_from_episodes_to_batch": 0.0008173339908871807, "add_one_ts_to_episodes_and_truncate": 0.008552361125918813, "add_states_from_episodes_to_batch": 2.8509433345910384e-06, "add_columns_from_episodes_to_train_batch": 0.03454227053021844, "add_time_dim_to_batch_and_zero_pad": 1.00497915636319e-05, "general_advantage_estimation": 0.0062661064860111745, "batch_individual_items": 0.03434885555153821}}, "connector_pipeline_timer": 0.08471043426188589}, "num_module_steps_trained": 6000, "num_trainable_parameters": 6003, "num_module_steps_trained_lifetime": 90000, "learner_connector_sum_episodes_length_out": 5250.0, "num_env_steps_trained_lifetime": 472500, "num_env_steps_trained": 31500, "learner_connector_sum_episodes_length_in": 5000.0, "num_non_trainable_parameters": 0, "num_env_steps_trained_lifetime_throughput": 2326528.2923096516, "num_module_steps_trained_throughput": 444809.7700978536, "num_module_steps_trained_lifetime_throughput": 444199.9061652003}, "default_policy": {"module_train_batch_size_mean": 1000.0, "entropy": 0.4242554008960724, "mean_kl_loss": 0.00040324131259694695, "policy_loss": -0.0023636831901967525, "default_optimizer_learning_rate": 0.0002847858517, "total_loss": 0.06253442168235779, "gradients_default_optimizer_global_norm": 0.04951922968029976, "diff_num_grad_updates_vs_sampler_policy": 1.0, "num_module_steps_trained": 6000, "num_trainable_parameters": 6003, "num_module_steps_trained_lifetime": 90000, "vf_loss_unclipped": 27.907155990600586, "vf_explained_var": 0.004027366638183594, "curr_entropy_coeff": 0.0090570820258, "curr_kl_coeff": 2.2781259758630767e-05, "weights_seq_no": 15.0, "vf_loss": 0.10278083384037018, "num_module_steps_trained_lifetime_throughput": 445194.68955094414}}, "num_training_step_calls_per_iteration": 1, "evaluation": {"env_runners": {"env_to_module_connector": {"timers": {"connectors": {"add_time_dim_to_batch_and_zero_pad": 2.251528301160439e-06, "batch_individual_items": 6.121542554604179e-06, "numpy_to_tensor": 8.193049765670877e-06, "add_observations_from_episodes_to_batch": 2.8091552323329093e-06, "add_states_from_episodes_to_batch": 1.6475453612128996e-06}}, "connector_pipeline_timer": 4.246920229090862e-05}, "module_episode_returns_mean": {"default_policy": 0.8}, "num_module_steps_sampled_lifetime": {"default_policy": 6000}, "episode_return_mean": 0.8, "env_step_timer": 1.3780520224723952e-05, "num_module_steps_sampled": {"default_policy": 400}, "episode_len_mean": 20.0, "module_to_env_connector": {"timers": {"connectors": {"normalize_and_clip_actions": 9.208627477682104e-06, "listify_data_for_vector_env": 1.0651927033858615e-05, "get_actions": 3.4676187221285504e-05, "remove_single_ts_time_rank_from_batch": 5.597443673190966e-07, "tensor_to_numpy": 1.28622913051016e-05, "un_batch_to_individual_items": 5.354008903172775e-06}}, "connector_pipeline_timer": 9.837017773426858e-05}, "num_env_steps_sampled": 400, "num_episodes_lifetime": 300, "sample": 0.09849641692012887, "episode_duration_sec_mean": 0.004451289601856843, "num_env_steps_sampled_lifetime": 75400, "agent_episode_returns_mean": {"default_agent": 0.8}, "env_reset_timer": 0.00013711057677762254, "rlmodule_inference_timer": 2.7436576393055744e-05, "num_agent_steps_sampled_lifetime": {"default_agent": 6000}, "episode_len_min": 20, "weights_seq_no": 15.0, "env_to_module_sum_episodes_length_out": 10.368238394574323, "num_agent_steps_sampled": {"default_agent": 400}, "env_to_module_sum_episodes_length_in": 10.368238394574323, "episode_len_max": 20, "episode_return_min": -14.5, "num_episodes": 20, "episode_return_max": 14.5, "time_between_sampling": 1.6000479982331866}, "num_healthy_workers": 1, "actor_manager_num_outstanding_async_reqs": 0, "num_remote_worker_restarts": 0}, "num_env_steps_sampled_lifetime": -8017500.0, "fault_tolerance": {"num_healthy_workers": 0, "num_remote_worker_restarts": 0}, "env_runner_group": {"actor_manager_num_outstanding_async_reqs": 0}, "done": false, "training_iteration": 15, "trial_id": "43aed_00000", "date": "2025-08-11_19-23-24", "timestamp": 1754933004, "time_this_iter_s": 1.6720929145812988, "time_total_s": 24.65059995651245, "pid": 14402, "hostname": "Mac", "node_ip": "127.0.0.1", "config": {"exploration_config": {}, "extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "placement_strategy": "PACK", "num_gpus": 0, "_fake_gpus": false, "num_cpus_for_main_process": 2, "eager_tracing": true, "eager_max_retraces": 20, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "torch_compile_learner": false, "torch_compile_learner_what_to_compile": "forward_train", "torch_compile_learner_dynamo_backend": "aot_eager", "torch_compile_learner_dynamo_mode": null, "torch_compile_worker": false, "torch_compile_worker_dynamo_backend": "aot_eager", "torch_compile_worker_dynamo_mode": null, "torch_ddp_kwargs": {}, "torch_skip_nan_gradients": false, "env": "Umbrella", "env_config": {}, "observation_space": null, "action_space": null, "clip_rewards": null, "normalize_actions": true, "clip_actions": false, "_is_atari": null, "disable_env_checking": false, "render_env": false, "action_mask_key": "action_mask", "env_runner_cls": null, "num_env_runners": 0, "create_local_env_runner": true, "num_envs_per_env_runner": 1, "gym_env_vectorize_mode": "SYNC", "num_cpus_per_env_runner": 1, "num_gpus_per_env_runner": 0, "custom_resources_per_env_runner": {}, "validate_env_runners_after_construction": true, "episodes_to_numpy": true, "max_requests_in_flight_per_env_runner": 1, "sample_timeout_s": 60.0, "_env_to_module_connector": null, "add_default_connectors_to_env_to_module_pipeline": true, "_module_to_env_connector": null, "add_default_connectors_to_module_to_env_pipeline": true, "merge_env_runner_states": "training_only", "broadcast_env_runner_states": true, "episode_lookback_horizon": 1, "rollout_fragment_length": "auto", "batch_mode": "complete_episodes", "compress_observations": false, "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "enable_tf1_exec_eagerly": false, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "preprocessor_pref": "deepmind", "observation_filter": "NoFilter", "update_worker_filter_stats": true, "use_worker_filter_stats": true, "sampler_perf_stats_ema_coef": null, "_is_online": true, "num_learners": 0, "num_gpus_per_learner": 0, "num_cpus_per_learner": "auto", "num_aggregator_actors_per_learner": 0, "max_requests_in_flight_per_aggregator_actor": 3, "local_gpu_idx": 0, "max_requests_in_flight_per_learner": 3, "gamma": 1, "lr": 0.0002847858517, "grad_clip": 0.5, "grad_clip_by": "global_norm", "_train_batch_size_per_learner": 5000, "train_batch_size": 4000, "num_epochs": 1, "minibatch_size": 1000, "shuffle_batch_per_epoch": true, "model": {"fcnet_hiddens": [256, 256], "fcnet_activation": "tanh", "fcnet_weights_initializer": null, "fcnet_weights_initializer_config": null, "fcnet_bias_initializer": null, "fcnet_bias_initializer_config": null, "conv_filters": null, "conv_activation": "relu", "conv_kernel_initializer": null, "conv_kernel_initializer_config": null, "conv_bias_initializer": null, "conv_bias_initializer_config": null, "conv_transpose_kernel_initializer": null, "conv_transpose_kernel_initializer_config": null, "conv_transpose_bias_initializer": null, "conv_transpose_bias_initializer_config": null, "post_fcnet_hiddens": [], "post_fcnet_activation": "relu", "post_fcnet_weights_initializer": null, "post_fcnet_weights_initializer_config": null, "post_fcnet_bias_initializer": null, "post_fcnet_bias_initializer_config": null, "free_log_std": false, "log_std_clip_param": 20.0, "no_final_linear": false, "vf_share_layers": false, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "lstm_weights_initializer": null, "lstm_weights_initializer_config": null, "lstm_bias_initializer": null, "lstm_bias_initializer_config": null, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "attention_use_n_prev_actions": 0, "attention_use_n_prev_rewards": 0, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": null, "custom_model_config": {}, "custom_action_dist": null, "custom_preprocessor": null, "encoder_latent_dim": null, "always_check_shapes": false, "lstm_use_prev_action_reward": -1, "_use_default_native_models": -1, "_disable_preprocessor_api": false, "_disable_action_flattening": false}, "_learner_connector": null, "add_default_connectors_to_learner_pipeline": true, "learner_config_dict": {}, "optimizer": {}, "_learner_class": null, "callbacks_on_algorithm_init": null, "callbacks_on_env_runners_recreated": null, "callbacks_on_offline_eval_runners_recreated": null, "callbacks_on_checkpoint_loaded": null, "callbacks_on_environment_created": null, "callbacks_on_episode_created": null, "callbacks_on_episode_start": null, "callbacks_on_episode_step": null, "callbacks_on_episode_end": null, "callbacks_on_evaluate_start": null, "callbacks_on_evaluate_end": null, "callbacks_on_evaluate_offline_start": null, "callbacks_on_evaluate_offline_end": null, "callbacks_on_sample_end": null, "callbacks_on_train_result": null, "explore": true, "enable_rl_module_and_learner": true, "enable_env_runner_and_connector_v2": true, "_prior_exploration_config": {"type": "StochasticSampling"}, "count_steps_by": "env_steps", "policy_map_capacity": 100, "policy_mapping_fn": "<function AlgorithmConfig.DEFAULT_POLICY_MAPPING_FN at 0x3881edb20>", "policies_to_train": null, "policy_states_are_swappable": false, "observation_fn": null, "offline_data_class": null, "input_read_method": "read_parquet", "input_read_method_kwargs": {}, "input_read_schema": {}, "input_read_episodes": false, "input_read_sample_batches": false, "input_read_batch_size": null, "input_filesystem": null, "input_filesystem_kwargs": {}, "input_compress_columns": ["obs", "new_obs"], "input_spaces_jsonable": true, "materialize_data": false, "materialize_mapped_data": true, "map_batches_kwargs": {}, "iter_batches_kwargs": {}, "ignore_final_observation": false, "prelearner_class": null, "prelearner_buffer_class": null, "prelearner_buffer_kwargs": {}, "prelearner_module_synch_period": 10, "dataset_num_iters_per_learner": null, "input_config": {}, "actions_in_input_normalized": false, "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_config": {}, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "output_max_rows_per_file": null, "output_write_remaining_data": false, "output_write_method": "write_parquet", "output_write_method_kwargs": {}, "output_filesystem": null, "output_filesystem_kwargs": {}, "output_write_episodes": true, "offline_sampling": false, "evaluation_interval": 1, "evaluation_duration": 20, "evaluation_duration_unit": "episodes", "evaluation_sample_timeout_s": 120.0, "evaluation_auto_duration_min_env_steps_per_sample": 100, "evaluation_auto_duration_max_env_steps_per_sample": 2000, "evaluation_parallel_to_training": false, "evaluation_force_reset_envs_before_iteration": true, "evaluation_config": null, "off_policy_estimation_methods": {}, "ope_split_batch_by_episode": true, "evaluation_num_env_runners": 1, "in_evaluation": false, "sync_filters_on_rollout_workers_timeout_s": 10.0, "offline_evaluation_interval": null, "num_offline_eval_runners": 0, "offline_loss_for_module_fn": null, "offline_evaluation_duration": 1, "offline_evaluation_parallel_to_training": false, "offline_evaluation_timeout_s": 120.0, "num_cpus_per_offline_eval_runner": 1, "num_gpus_per_offline_eval_runner": 0, "custom_resources_per_offline_eval_runner": {}, "restart_failed_offline_eval_runners": true, "ignore_offline_eval_runner_failures": false, "max_num_offline_eval_runner_restarts": 1000, "offline_eval_runner_restore_timeout_s": 1800.0, "max_requests_in_flight_per_offline_eval_runner": 1, "validate_offline_eval_runners_after_construction": true, "offline_eval_runner_health_probe_timeout_s": 30.0, "offline_eval_rl_module_inference_only": false, "broadcast_offline_eval_runner_states": false, "offline_eval_batch_size_per_runner": 256, "dataset_num_iters_per_eval_runner": 1, "keep_per_episode_custom_metrics": false, "metrics_episode_collection_timeout_s": 60.0, "metrics_num_episodes_for_smoothing": 100, "min_time_s_per_iteration": null, "min_train_timesteps_per_iteration": 0, "min_sample_timesteps_per_iteration": 0, "log_gradients": true, "export_native_model_files": false, "checkpoint_trainable_policies_only": false, "logger_creator": null, "logger_config": null, "log_level": "WARN", "log_sys_usage": true, "fake_sampler": false, "seed": 2, "restart_failed_env_runners": true, "ignore_env_runner_failures": false, "max_num_env_runner_restarts": 1000, "delay_between_env_runner_restarts_s": 60.0, "restart_failed_sub_environments": false, "num_consecutive_env_runner_failures_tolerance": 100, "env_runner_health_probe_timeout_s": 30.0, "env_runner_restore_timeout_s": 1800.0, "_model_config": {}, "_rl_module_spec": "RLModuleSpec(module_class=None, observation_space=None, action_space=None, inference_only=False, learner_only=False, model_config=DefaultModelConfig(fcnet_hiddens=[60, 90], fcnet_activation='tanh', fcnet_kernel_initializer=None, fcnet_kernel_initializer_kwargs=None, fcnet_bias_initializer=None, fcnet_bias_initializer_kwargs=None, conv_filters=None, conv_activation='relu', conv_kernel_initializer=None, conv_kernel_initializer_kwargs=None, conv_bias_initializer=None, conv_bias_initializer_kwargs=None, head_fcnet_hiddens=[], head_fcnet_activation='relu', head_fcnet_kernel_initializer=None, head_fcnet_kernel_initializer_kwargs=None, head_fcnet_bias_initializer=None, head_fcnet_bias_initializer_kwargs=None, free_log_std=False, log_std_clip_param=20.0, vf_share_layers=True, use_lstm=False, max_seq_len=20, lstm_cell_size=256, lstm_use_prev_action=False, lstm_use_prev_reward=False, lstm_kernel_initializer=None, lstm_kernel_initializer_kwargs=None, lstm_bias_initializer=None, lstm_bias_initializer_kwargs=None), catalog_class=None, load_state_path=None, model_config_dict=None)", "algorithm_config_overrides_per_module": {}, "_per_module_overrides": {}, "_validate_config": true, "_use_msgpack_checkpoints": false, "_torch_grad_scaler_class": null, "_torch_lr_scheduler_classes": null, "_tf_policy_handles_more_than_one_loss": false, "_disable_preprocessor_api": false, "_disable_action_flattening": false, "_disable_initialize_loss_from_dummy_batch": false, "_dont_auto_sync_env_runner_states": false, "env_task_fn": -1, "enable_connectors": -1, "simple_optimizer": false, "policy_map_cache": -1, "worker_cls": -1, "synchronize_filters": -1, "enable_async_evaluation": -1, "custom_async_evaluation_function": -1, "_enable_rl_module_api": -1, "auto_wrap_old_gym_envs": -1, "always_attach_evaluation_results": -1, "replay_sequence_length": null, "_disable_execution_plan_api": -1, "use_critic": true, "use_gae": true, "use_kl_loss": true, "kl_coeff": 0.7464963036515, "kl_target": 0.0270990929592, "vf_loss_coeff": 0.6688075857018, "entropy_coeff": 0.0090570820258, "clip_param": 0.1221781641624, "vf_clip_param": 0.1027808522125, "entropy_coeff_schedule": null, "lr_schedule": null, "sgd_minibatch_size": -1, "vf_share_layers": -1, "__stdout_file__": null, "__stderr_file__": null, "lambda": 0.9099046732075, "input": "sampler", "policies": {"default_policy": [null, null, null, null]}, "callbacks": "<class 'ray.rllib.callbacks.callbacks.RLlibCallback'>", "create_env_on_driver": false, "custom_eval_function": null, "framework": "torch"}, "time_since_restore": 24.65059995651245, "iterations_since_restore": 15, "perf": {"cpu_util_percent": 40.73333333333334, "ram_util_percent": 78.33333333333333}}
{"timers": {"training_iteration": 1.5494865641433468, "restore_env_runners": 1.1264553592770086e-05, "training_step": 1.5493476413349139, "env_runner_sampling_timer": 1.4386475167605903, "learner_update_timer": 0.10766435466860151, "synch_weights": 0.0005521405249047576, "restore_eval_env_runners": 7.778527083179061e-06, "evaluation_iteration": 0.10456674996870742, "synch_eval_env_connectors": 0.00020434277750845404, "synch_env_connectors": 4.253381224724148e-06}, "env_runners": {"num_module_steps_sampled_lifetime": {"default_policy": -8635000.0}, "num_env_steps_sampled_lifetime": -8635000.0, "episode_len_mean": 20.0, "env_to_module_connector": {"timers": {"connectors": {"add_time_dim_to_batch_and_zero_pad": 2.6299263725818104e-06, "add_observations_from_episodes_to_batch": 3.1847728521365554e-06, "add_states_from_episodes_to_batch": 1.7774674092971207e-06, "numpy_to_tensor": 9.370941538148487e-06, "batch_individual_items": 6.857910710314408e-06}}, "connector_pipeline_timer": 4.6761390567654487e-05}, "weights_seq_no": 15.0, "episode_len_min": 20, "num_agent_steps_sampled_lifetime": {"default_agent": -8635000.0}, "module_to_env_connector": {"connector_pipeline_timer": 0.00011550921923368142, "timers": {"connectors": {"tensor_to_numpy": 1.4514141035531427e-05, "listify_data_for_vector_env": 1.1706354658222244e-05, "get_actions": 4.450943330378314e-05, "un_batch_to_individual_items": 5.665213490640599e-06, "normalize_and_clip_actions": 1.0015235996133554e-05, "remove_single_ts_time_rank_from_batch": 6.433948787137927e-07}}}, "env_reset_timer": 3.980723804932122e-05, "env_to_module_sum_episodes_length_out": 10.36823839457432, "env_to_module_sum_episodes_length_in": 10.36823839457432, "num_module_steps_sampled": {"default_policy": 5000.0}, "episode_return_mean": 7.059999999999999, "episode_len_max": 20, "num_env_steps_sampled": 5000.0, "num_episodes_lifetime": -431750.0, "agent_episode_returns_mean": {"default_agent": 7.059999999999999}, "episode_return_min": -11.5, "sample": 0.005154816874830369, "num_episodes": 250.0, "num_agent_steps_sampled": {"default_agent": 5000.0}, "rlmodule_inference_timer": 2.988361028996331e-05, "module_episode_returns_mean": {"default_policy": 7.059999999999999}, "episode_return_max": 8.5, "env_step_timer": 1.5079691744369875e-05, "time_between_sampling": 0.0018966494297928964, "episode_duration_sec_mean": 0.0049904573569074274, "num_env_steps_sampled_lifetime_throughput": 3475.7448200189774}, "learners": {"__all_modules__": {"learner_connector": {"timers": {"connectors": {"numpy_to_tensor": 5.8564983804896764e-05, "add_observations_from_episodes_to_batch": 0.0008173273103688628, "add_one_ts_to_episodes_and_truncate": 0.008546216675548118, "add_states_from_episodes_to_batch": 2.8561838671959745e-06, "add_columns_from_episodes_to_train_batch": 0.03454179532460497, "add_time_dim_to_batch_and_zero_pad": 1.0153873785501708e-05, "general_advantage_estimation": 0.006257973761848352, "batch_individual_items": 0.034304117416356646}}, "connector_pipeline_timer": 0.08465105116993892}, "num_module_steps_trained": 6000, "num_trainable_parameters": 6003, "num_module_steps_trained_lifetime": 96000, "learner_connector_sum_episodes_length_out": 5250.0, "num_env_steps_trained_lifetime": 504000, "num_env_steps_trained": 31500, "learner_connector_sum_episodes_length_in": 5000.0, "num_non_trainable_parameters": 0, "num_env_steps_trained_lifetime_throughput": 2322249.6961352034, "num_module_steps_trained_throughput": 443926.67224237893, "num_module_steps_trained_lifetime_throughput": 443337.2569949663}, "default_policy": {"module_train_batch_size_mean": 1000.0, "entropy": 0.4163439869880676, "mean_kl_loss": 6.271064921747893e-05, "policy_loss": -0.07398297637701035, "default_optimizer_learning_rate": 0.0002847858517, "total_loss": -0.009013228118419647, "gradients_default_optimizer_global_norm": 0.09217683970928192, "diff_num_grad_updates_vs_sampler_policy": 1.0, "num_module_steps_trained": 6000, "num_trainable_parameters": 6003, "num_module_steps_trained_lifetime": 96000, "vf_loss_unclipped": 27.8068904876709, "vf_explained_var": 0.010698795318603516, "curr_entropy_coeff": 0.0090570820258, "curr_kl_coeff": 1.1390629879315384e-05, "weights_seq_no": 16.0, "vf_loss": 0.10278083384037018, "num_module_steps_trained_lifetime_throughput": 444256.7506969669}}, "num_training_step_calls_per_iteration": 1, "evaluation": {"env_runners": {"env_to_module_connector": {"timers": {"connectors": {"add_time_dim_to_batch_and_zero_pad": 2.2402563226087826e-06, "batch_individual_items": 6.052840138474132e-06, "numpy_to_tensor": 8.252561351219824e-06, "add_observations_from_episodes_to_batch": 2.7484206926833954e-06, "add_states_from_episodes_to_batch": 1.6247367159598683e-06}}, "connector_pipeline_timer": 4.224804944547576e-05}, "module_episode_returns_mean": {"default_policy": 0.2}, "num_module_steps_sampled_lifetime": {"default_policy": 6400}, "episode_return_mean": 0.2, "env_step_timer": 1.3668582900898866e-05, "num_module_steps_sampled": {"default_policy": 400}, "episode_len_mean": 20.0, "module_to_env_connector": {"timers": {"connectors": {"normalize_and_clip_actions": 9.23167638347112e-06, "listify_data_for_vector_env": 1.0673185857849757e-05, "get_actions": 3.509109155801455e-05, "remove_single_ts_time_rank_from_batch": 5.65112786931925e-07, "tensor_to_numpy": 1.2741037561895647e-05, "un_batch_to_individual_items": 5.28528014861219e-06}}, "connector_pipeline_timer": 9.882003715337194e-05}, "num_env_steps_sampled": 400, "num_episodes_lifetime": 320, "sample": 0.09851272358109318, "episode_duration_sec_mean": 0.0044810666656121614, "num_env_steps_sampled_lifetime": 80400, "agent_episode_returns_mean": {"default_agent": 0.2}, "env_reset_timer": 0.00013697197166356027, "rlmodule_inference_timer": 2.70774852971834e-05, "num_agent_steps_sampled_lifetime": {"default_agent": 6400}, "episode_len_min": 20, "weights_seq_no": 16.0, "env_to_module_sum_episodes_length_out": 10.368238394574323, "num_agent_steps_sampled": {"default_agent": 400}, "env_to_module_sum_episodes_length_in": 10.368238394574323, "episode_len_max": 20, "episode_return_min": -13.5, "num_episodes": 20, "episode_return_max": 14.5, "time_between_sampling": 1.6003425240906384}, "num_healthy_workers": 1, "actor_manager_num_outstanding_async_reqs": 0, "num_remote_worker_restarts": 0}, "num_env_steps_sampled_lifetime": -8635000.0, "fault_tolerance": {"num_healthy_workers": 0, "num_remote_worker_restarts": 0}, "env_runner_group": {"actor_manager_num_outstanding_async_reqs": 0}, "done": false, "training_iteration": 16, "trial_id": "43aed_00000", "date": "2025-08-11_19-23-26", "timestamp": 1754933006, "time_this_iter_s": 1.7187209129333496, "time_total_s": 26.3693208694458, "pid": 14402, "hostname": "Mac", "node_ip": "127.0.0.1", "config": {"exploration_config": {}, "extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "placement_strategy": "PACK", "num_gpus": 0, "_fake_gpus": false, "num_cpus_for_main_process": 2, "eager_tracing": true, "eager_max_retraces": 20, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "torch_compile_learner": false, "torch_compile_learner_what_to_compile": "forward_train", "torch_compile_learner_dynamo_backend": "aot_eager", "torch_compile_learner_dynamo_mode": null, "torch_compile_worker": false, "torch_compile_worker_dynamo_backend": "aot_eager", "torch_compile_worker_dynamo_mode": null, "torch_ddp_kwargs": {}, "torch_skip_nan_gradients": false, "env": "Umbrella", "env_config": {}, "observation_space": null, "action_space": null, "clip_rewards": null, "normalize_actions": true, "clip_actions": false, "_is_atari": null, "disable_env_checking": false, "render_env": false, "action_mask_key": "action_mask", "env_runner_cls": null, "num_env_runners": 0, "create_local_env_runner": true, "num_envs_per_env_runner": 1, "gym_env_vectorize_mode": "SYNC", "num_cpus_per_env_runner": 1, "num_gpus_per_env_runner": 0, "custom_resources_per_env_runner": {}, "validate_env_runners_after_construction": true, "episodes_to_numpy": true, "max_requests_in_flight_per_env_runner": 1, "sample_timeout_s": 60.0, "_env_to_module_connector": null, "add_default_connectors_to_env_to_module_pipeline": true, "_module_to_env_connector": null, "add_default_connectors_to_module_to_env_pipeline": true, "merge_env_runner_states": "training_only", "broadcast_env_runner_states": true, "episode_lookback_horizon": 1, "rollout_fragment_length": "auto", "batch_mode": "complete_episodes", "compress_observations": false, "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "enable_tf1_exec_eagerly": false, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "preprocessor_pref": "deepmind", "observation_filter": "NoFilter", "update_worker_filter_stats": true, "use_worker_filter_stats": true, "sampler_perf_stats_ema_coef": null, "_is_online": true, "num_learners": 0, "num_gpus_per_learner": 0, "num_cpus_per_learner": "auto", "num_aggregator_actors_per_learner": 0, "max_requests_in_flight_per_aggregator_actor": 3, "local_gpu_idx": 0, "max_requests_in_flight_per_learner": 3, "gamma": 1, "lr": 0.0002847858517, "grad_clip": 0.5, "grad_clip_by": "global_norm", "_train_batch_size_per_learner": 5000, "train_batch_size": 4000, "num_epochs": 1, "minibatch_size": 1000, "shuffle_batch_per_epoch": true, "model": {"fcnet_hiddens": [256, 256], "fcnet_activation": "tanh", "fcnet_weights_initializer": null, "fcnet_weights_initializer_config": null, "fcnet_bias_initializer": null, "fcnet_bias_initializer_config": null, "conv_filters": null, "conv_activation": "relu", "conv_kernel_initializer": null, "conv_kernel_initializer_config": null, "conv_bias_initializer": null, "conv_bias_initializer_config": null, "conv_transpose_kernel_initializer": null, "conv_transpose_kernel_initializer_config": null, "conv_transpose_bias_initializer": null, "conv_transpose_bias_initializer_config": null, "post_fcnet_hiddens": [], "post_fcnet_activation": "relu", "post_fcnet_weights_initializer": null, "post_fcnet_weights_initializer_config": null, "post_fcnet_bias_initializer": null, "post_fcnet_bias_initializer_config": null, "free_log_std": false, "log_std_clip_param": 20.0, "no_final_linear": false, "vf_share_layers": false, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "lstm_weights_initializer": null, "lstm_weights_initializer_config": null, "lstm_bias_initializer": null, "lstm_bias_initializer_config": null, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "attention_use_n_prev_actions": 0, "attention_use_n_prev_rewards": 0, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": null, "custom_model_config": {}, "custom_action_dist": null, "custom_preprocessor": null, "encoder_latent_dim": null, "always_check_shapes": false, "lstm_use_prev_action_reward": -1, "_use_default_native_models": -1, "_disable_preprocessor_api": false, "_disable_action_flattening": false}, "_learner_connector": null, "add_default_connectors_to_learner_pipeline": true, "learner_config_dict": {}, "optimizer": {}, "_learner_class": null, "callbacks_on_algorithm_init": null, "callbacks_on_env_runners_recreated": null, "callbacks_on_offline_eval_runners_recreated": null, "callbacks_on_checkpoint_loaded": null, "callbacks_on_environment_created": null, "callbacks_on_episode_created": null, "callbacks_on_episode_start": null, "callbacks_on_episode_step": null, "callbacks_on_episode_end": null, "callbacks_on_evaluate_start": null, "callbacks_on_evaluate_end": null, "callbacks_on_evaluate_offline_start": null, "callbacks_on_evaluate_offline_end": null, "callbacks_on_sample_end": null, "callbacks_on_train_result": null, "explore": true, "enable_rl_module_and_learner": true, "enable_env_runner_and_connector_v2": true, "_prior_exploration_config": {"type": "StochasticSampling"}, "count_steps_by": "env_steps", "policy_map_capacity": 100, "policy_mapping_fn": "<function AlgorithmConfig.DEFAULT_POLICY_MAPPING_FN at 0x3881edb20>", "policies_to_train": null, "policy_states_are_swappable": false, "observation_fn": null, "offline_data_class": null, "input_read_method": "read_parquet", "input_read_method_kwargs": {}, "input_read_schema": {}, "input_read_episodes": false, "input_read_sample_batches": false, "input_read_batch_size": null, "input_filesystem": null, "input_filesystem_kwargs": {}, "input_compress_columns": ["obs", "new_obs"], "input_spaces_jsonable": true, "materialize_data": false, "materialize_mapped_data": true, "map_batches_kwargs": {}, "iter_batches_kwargs": {}, "ignore_final_observation": false, "prelearner_class": null, "prelearner_buffer_class": null, "prelearner_buffer_kwargs": {}, "prelearner_module_synch_period": 10, "dataset_num_iters_per_learner": null, "input_config": {}, "actions_in_input_normalized": false, "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_config": {}, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "output_max_rows_per_file": null, "output_write_remaining_data": false, "output_write_method": "write_parquet", "output_write_method_kwargs": {}, "output_filesystem": null, "output_filesystem_kwargs": {}, "output_write_episodes": true, "offline_sampling": false, "evaluation_interval": 1, "evaluation_duration": 20, "evaluation_duration_unit": "episodes", "evaluation_sample_timeout_s": 120.0, "evaluation_auto_duration_min_env_steps_per_sample": 100, "evaluation_auto_duration_max_env_steps_per_sample": 2000, "evaluation_parallel_to_training": false, "evaluation_force_reset_envs_before_iteration": true, "evaluation_config": null, "off_policy_estimation_methods": {}, "ope_split_batch_by_episode": true, "evaluation_num_env_runners": 1, "in_evaluation": false, "sync_filters_on_rollout_workers_timeout_s": 10.0, "offline_evaluation_interval": null, "num_offline_eval_runners": 0, "offline_loss_for_module_fn": null, "offline_evaluation_duration": 1, "offline_evaluation_parallel_to_training": false, "offline_evaluation_timeout_s": 120.0, "num_cpus_per_offline_eval_runner": 1, "num_gpus_per_offline_eval_runner": 0, "custom_resources_per_offline_eval_runner": {}, "restart_failed_offline_eval_runners": true, "ignore_offline_eval_runner_failures": false, "max_num_offline_eval_runner_restarts": 1000, "offline_eval_runner_restore_timeout_s": 1800.0, "max_requests_in_flight_per_offline_eval_runner": 1, "validate_offline_eval_runners_after_construction": true, "offline_eval_runner_health_probe_timeout_s": 30.0, "offline_eval_rl_module_inference_only": false, "broadcast_offline_eval_runner_states": false, "offline_eval_batch_size_per_runner": 256, "dataset_num_iters_per_eval_runner": 1, "keep_per_episode_custom_metrics": false, "metrics_episode_collection_timeout_s": 60.0, "metrics_num_episodes_for_smoothing": 100, "min_time_s_per_iteration": null, "min_train_timesteps_per_iteration": 0, "min_sample_timesteps_per_iteration": 0, "log_gradients": true, "export_native_model_files": false, "checkpoint_trainable_policies_only": false, "logger_creator": null, "logger_config": null, "log_level": "WARN", "log_sys_usage": true, "fake_sampler": false, "seed": 2, "restart_failed_env_runners": true, "ignore_env_runner_failures": false, "max_num_env_runner_restarts": 1000, "delay_between_env_runner_restarts_s": 60.0, "restart_failed_sub_environments": false, "num_consecutive_env_runner_failures_tolerance": 100, "env_runner_health_probe_timeout_s": 30.0, "env_runner_restore_timeout_s": 1800.0, "_model_config": {}, "_rl_module_spec": "RLModuleSpec(module_class=None, observation_space=None, action_space=None, inference_only=False, learner_only=False, model_config=DefaultModelConfig(fcnet_hiddens=[60, 90], fcnet_activation='tanh', fcnet_kernel_initializer=None, fcnet_kernel_initializer_kwargs=None, fcnet_bias_initializer=None, fcnet_bias_initializer_kwargs=None, conv_filters=None, conv_activation='relu', conv_kernel_initializer=None, conv_kernel_initializer_kwargs=None, conv_bias_initializer=None, conv_bias_initializer_kwargs=None, head_fcnet_hiddens=[], head_fcnet_activation='relu', head_fcnet_kernel_initializer=None, head_fcnet_kernel_initializer_kwargs=None, head_fcnet_bias_initializer=None, head_fcnet_bias_initializer_kwargs=None, free_log_std=False, log_std_clip_param=20.0, vf_share_layers=True, use_lstm=False, max_seq_len=20, lstm_cell_size=256, lstm_use_prev_action=False, lstm_use_prev_reward=False, lstm_kernel_initializer=None, lstm_kernel_initializer_kwargs=None, lstm_bias_initializer=None, lstm_bias_initializer_kwargs=None), catalog_class=None, load_state_path=None, model_config_dict=None)", "algorithm_config_overrides_per_module": {}, "_per_module_overrides": {}, "_validate_config": true, "_use_msgpack_checkpoints": false, "_torch_grad_scaler_class": null, "_torch_lr_scheduler_classes": null, "_tf_policy_handles_more_than_one_loss": false, "_disable_preprocessor_api": false, "_disable_action_flattening": false, "_disable_initialize_loss_from_dummy_batch": false, "_dont_auto_sync_env_runner_states": false, "env_task_fn": -1, "enable_connectors": -1, "simple_optimizer": false, "policy_map_cache": -1, "worker_cls": -1, "synchronize_filters": -1, "enable_async_evaluation": -1, "custom_async_evaluation_function": -1, "_enable_rl_module_api": -1, "auto_wrap_old_gym_envs": -1, "always_attach_evaluation_results": -1, "replay_sequence_length": null, "_disable_execution_plan_api": -1, "use_critic": true, "use_gae": true, "use_kl_loss": true, "kl_coeff": 0.7464963036515, "kl_target": 0.0270990929592, "vf_loss_coeff": 0.6688075857018, "entropy_coeff": 0.0090570820258, "clip_param": 0.1221781641624, "vf_clip_param": 0.1027808522125, "entropy_coeff_schedule": null, "lr_schedule": null, "sgd_minibatch_size": -1, "vf_share_layers": -1, "__stdout_file__": null, "__stderr_file__": null, "lambda": 0.9099046732075, "input": "sampler", "policies": {"default_policy": [null, null, null, null]}, "callbacks": "<class 'ray.rllib.callbacks.callbacks.RLlibCallback'>", "create_env_on_driver": false, "custom_eval_function": null, "framework": "torch"}, "time_since_restore": 26.3693208694458, "iterations_since_restore": 16, "perf": {"cpu_util_percent": 49.349999999999994, "ram_util_percent": 78.55000000000001}}
{"timers": {"training_iteration": 1.553844123081353, "restore_env_runners": 1.120273731465846e-05, "training_step": 1.5537050224215516, "env_runner_sampling_timer": 1.4431333386732181, "learner_update_timer": 0.10752996528151504, "synch_weights": 0.0005541412002149934, "restore_eval_env_runners": 7.82449246360252e-06, "evaluation_iteration": 0.10457376371975088, "synch_eval_env_connectors": 0.0002032364406871815, "synch_env_connectors": 4.250847717056641e-06}, "env_runners": {"num_module_steps_sampled_lifetime": {"default_policy": -9252500.0}, "num_env_steps_sampled_lifetime": -9252500.0, "episode_len_mean": 20.0, "env_to_module_connector": {"timers": {"connectors": {"add_time_dim_to_batch_and_zero_pad": 3.0129792266340275e-06, "add_observations_from_episodes_to_batch": 3.744469011421356e-06, "add_states_from_episodes_to_batch": 2.0462824318761295e-06, "numpy_to_tensor": 1.1458690130162445e-05, "batch_individual_items": 7.96392201598341e-06}}, "connector_pipeline_timer": 5.390224778729825e-05}, "weights_seq_no": 16.0, "episode_len_min": 20, "num_agent_steps_sampled_lifetime": {"default_agent": -9252500.0}, "module_to_env_connector": {"connector_pipeline_timer": 0.00013583328244608667, "timers": {"connectors": {"tensor_to_numpy": 1.7116552372944968e-05, "listify_data_for_vector_env": 1.3945477963529282e-05, "get_actions": 5.4803709486516504e-05, "un_batch_to_individual_items": 6.5822147404732745e-06, "normalize_and_clip_actions": 1.170681736393921e-05, "remove_single_ts_time_rank_from_batch": 7.129766565233192e-07}}}, "env_reset_timer": 5.589247583932147e-05, "env_to_module_sum_episodes_length_out": 10.36823839457432, "env_to_module_sum_episodes_length_in": 10.36823839457432, "num_module_steps_sampled": {"default_policy": 5000.0}, "episode_return_mean": 6.9, "episode_len_max": 20, "num_env_steps_sampled": 5000.0, "num_episodes_lifetime": -462625.0, "agent_episode_returns_mean": {"default_agent": 6.9}, "episode_return_min": -11.5, "sample": 0.006435180453609111, "num_episodes": 250.0, "num_agent_steps_sampled": {"default_agent": 5000.0}, "rlmodule_inference_timer": 5.683566962686733e-05, "module_episode_returns_mean": {"default_policy": 6.9}, "episode_return_max": 8.5, "env_step_timer": 1.819310405827965e-05, "time_between_sampling": 0.0016795284828678627, "episode_duration_sec_mean": 0.006315928194671869, "num_env_steps_sampled_lifetime_throughput": 3010.624232932839}, "learners": {"__all_modules__": {"learner_connector": {"timers": {"connectors": {"numpy_to_tensor": 5.8597254853572987e-05, "add_observations_from_episodes_to_batch": 0.0008198352873977946, "add_one_ts_to_episodes_and_truncate": 0.00853704616887237, "add_states_from_episodes_to_batch": 2.8563719564023946e-06, "add_columns_from_episodes_to_train_batch": 0.034537904870617434, "add_time_dim_to_batch_and_zero_pad": 1.0147334606870341e-05, "general_advantage_estimation": 0.006249114854703917, "batch_individual_items": 0.03426036874232391}}, "connector_pipeline_timer": 0.08458775273837174}, "num_module_steps_trained": 6000, "num_trainable_parameters": 6003, "num_module_steps_trained_lifetime": 102000, "learner_connector_sum_episodes_length_out": 5250.0, "num_env_steps_trained_lifetime": 535500, "num_env_steps_trained": 31500, "learner_connector_sum_episodes_length_in": 5000.0, "num_non_trainable_parameters": 0, "num_env_steps_trained_lifetime_throughput": 2314329.6689562853, "num_module_steps_trained_throughput": 442352.27949215175, "num_module_steps_trained_lifetime_throughput": 441783.1245294551}, "default_policy": {"module_train_batch_size_mean": 1000.0, "entropy": 0.4231090247631073, "mean_kl_loss": 8.43530724523589e-05, "policy_loss": -0.09269465506076813, "default_optimizer_learning_rate": 0.0002847858517, "total_loss": -0.027786191552877426, "gradients_default_optimizer_global_norm": 0.06734903156757355, "diff_num_grad_updates_vs_sampler_policy": 1.0, "num_module_steps_trained": 6000, "num_trainable_parameters": 6003, "num_module_steps_trained_lifetime": 102000, "vf_loss_unclipped": 27.776878356933594, "vf_explained_var": 0.011242687702178955, "curr_entropy_coeff": 0.0090570820258, "curr_kl_coeff": 5.695314939657692e-06, "weights_seq_no": 17.0, "vf_loss": 0.10278083384037018, "num_module_steps_trained_lifetime_throughput": 442634.10616544547}}, "num_training_step_calls_per_iteration": 1, "evaluation": {"env_runners": {"env_to_module_connector": {"timers": {"connectors": {"add_time_dim_to_batch_and_zero_pad": 2.2922729344043917e-06, "batch_individual_items": 6.145836677396048e-06, "numpy_to_tensor": 8.3598751082807e-06, "add_observations_from_episodes_to_batch": 2.851541041217575e-06, "add_states_from_episodes_to_batch": 1.6719039469049024e-06}}, "connector_pipeline_timer": 4.281744539117285e-05}, "module_episode_returns_mean": {"default_policy": 0.0}, "num_module_steps_sampled_lifetime": {"default_policy": 6800}, "episode_return_mean": 0.0, "env_step_timer": 1.4154425095052699e-05, "num_module_steps_sampled": {"default_policy": 400}, "episode_len_mean": 20.0, "module_to_env_connector": {"timers": {"connectors": {"normalize_and_clip_actions": 9.42721134623112e-06, "listify_data_for_vector_env": 1.1141392959193089e-05, "get_actions": 3.605083202726673e-05, "remove_single_ts_time_rank_from_batch": 5.8459683686222e-07, "tensor_to_numpy": 1.3078448894863083e-05, "un_batch_to_individual_items": 5.393776659333681e-06}}, "connector_pipeline_timer": 0.0001014401556184416}, "num_env_steps_sampled": 400, "num_episodes_lifetime": 340, "sample": 0.09853484676463446, "episode_duration_sec_mean": 0.004510307076852769, "num_env_steps_sampled_lifetime": 85400, "agent_episode_returns_mean": {"default_agent": 0.0}, "env_reset_timer": 0.00013647183132730278, "rlmodule_inference_timer": 2.8001856761212524e-05, "num_agent_steps_sampled_lifetime": {"default_agent": 6800}, "episode_len_min": 20, "weights_seq_no": 17.0, "env_to_module_sum_episodes_length_out": 10.368238394574323, "num_agent_steps_sampled": {"default_agent": 400}, "env_to_module_sum_episodes_length_in": 10.368238394574323, "episode_len_max": 20, "episode_return_min": -13.5, "num_episodes": 20, "episode_return_max": 14.5, "time_between_sampling": 1.6043698000998026}, "num_healthy_workers": 1, "actor_manager_num_outstanding_async_reqs": 0, "num_remote_worker_restarts": 0}, "num_env_steps_sampled_lifetime": -9252500.0, "fault_tolerance": {"num_healthy_workers": 0, "num_remote_worker_restarts": 0}, "env_runner_group": {"actor_manager_num_outstanding_async_reqs": 0}, "done": false, "training_iteration": 17, "trial_id": "43aed_00000", "date": "2025-08-11_19-23-28", "timestamp": 1754933008, "time_this_iter_s": 2.0939338207244873, "time_total_s": 28.463254690170288, "pid": 14402, "hostname": "Mac", "node_ip": "127.0.0.1", "config": {"exploration_config": {}, "extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "placement_strategy": "PACK", "num_gpus": 0, "_fake_gpus": false, "num_cpus_for_main_process": 2, "eager_tracing": true, "eager_max_retraces": 20, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "torch_compile_learner": false, "torch_compile_learner_what_to_compile": "forward_train", "torch_compile_learner_dynamo_backend": "aot_eager", "torch_compile_learner_dynamo_mode": null, "torch_compile_worker": false, "torch_compile_worker_dynamo_backend": "aot_eager", "torch_compile_worker_dynamo_mode": null, "torch_ddp_kwargs": {}, "torch_skip_nan_gradients": false, "env": "Umbrella", "env_config": {}, "observation_space": null, "action_space": null, "clip_rewards": null, "normalize_actions": true, "clip_actions": false, "_is_atari": null, "disable_env_checking": false, "render_env": false, "action_mask_key": "action_mask", "env_runner_cls": null, "num_env_runners": 0, "create_local_env_runner": true, "num_envs_per_env_runner": 1, "gym_env_vectorize_mode": "SYNC", "num_cpus_per_env_runner": 1, "num_gpus_per_env_runner": 0, "custom_resources_per_env_runner": {}, "validate_env_runners_after_construction": true, "episodes_to_numpy": true, "max_requests_in_flight_per_env_runner": 1, "sample_timeout_s": 60.0, "_env_to_module_connector": null, "add_default_connectors_to_env_to_module_pipeline": true, "_module_to_env_connector": null, "add_default_connectors_to_module_to_env_pipeline": true, "merge_env_runner_states": "training_only", "broadcast_env_runner_states": true, "episode_lookback_horizon": 1, "rollout_fragment_length": "auto", "batch_mode": "complete_episodes", "compress_observations": false, "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "enable_tf1_exec_eagerly": false, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "preprocessor_pref": "deepmind", "observation_filter": "NoFilter", "update_worker_filter_stats": true, "use_worker_filter_stats": true, "sampler_perf_stats_ema_coef": null, "_is_online": true, "num_learners": 0, "num_gpus_per_learner": 0, "num_cpus_per_learner": "auto", "num_aggregator_actors_per_learner": 0, "max_requests_in_flight_per_aggregator_actor": 3, "local_gpu_idx": 0, "max_requests_in_flight_per_learner": 3, "gamma": 1, "lr": 0.0002847858517, "grad_clip": 0.5, "grad_clip_by": "global_norm", "_train_batch_size_per_learner": 5000, "train_batch_size": 4000, "num_epochs": 1, "minibatch_size": 1000, "shuffle_batch_per_epoch": true, "model": {"fcnet_hiddens": [256, 256], "fcnet_activation": "tanh", "fcnet_weights_initializer": null, "fcnet_weights_initializer_config": null, "fcnet_bias_initializer": null, "fcnet_bias_initializer_config": null, "conv_filters": null, "conv_activation": "relu", "conv_kernel_initializer": null, "conv_kernel_initializer_config": null, "conv_bias_initializer": null, "conv_bias_initializer_config": null, "conv_transpose_kernel_initializer": null, "conv_transpose_kernel_initializer_config": null, "conv_transpose_bias_initializer": null, "conv_transpose_bias_initializer_config": null, "post_fcnet_hiddens": [], "post_fcnet_activation": "relu", "post_fcnet_weights_initializer": null, "post_fcnet_weights_initializer_config": null, "post_fcnet_bias_initializer": null, "post_fcnet_bias_initializer_config": null, "free_log_std": false, "log_std_clip_param": 20.0, "no_final_linear": false, "vf_share_layers": false, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "lstm_weights_initializer": null, "lstm_weights_initializer_config": null, "lstm_bias_initializer": null, "lstm_bias_initializer_config": null, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "attention_use_n_prev_actions": 0, "attention_use_n_prev_rewards": 0, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": null, "custom_model_config": {}, "custom_action_dist": null, "custom_preprocessor": null, "encoder_latent_dim": null, "always_check_shapes": false, "lstm_use_prev_action_reward": -1, "_use_default_native_models": -1, "_disable_preprocessor_api": false, "_disable_action_flattening": false}, "_learner_connector": null, "add_default_connectors_to_learner_pipeline": true, "learner_config_dict": {}, "optimizer": {}, "_learner_class": null, "callbacks_on_algorithm_init": null, "callbacks_on_env_runners_recreated": null, "callbacks_on_offline_eval_runners_recreated": null, "callbacks_on_checkpoint_loaded": null, "callbacks_on_environment_created": null, "callbacks_on_episode_created": null, "callbacks_on_episode_start": null, "callbacks_on_episode_step": null, "callbacks_on_episode_end": null, "callbacks_on_evaluate_start": null, "callbacks_on_evaluate_end": null, "callbacks_on_evaluate_offline_start": null, "callbacks_on_evaluate_offline_end": null, "callbacks_on_sample_end": null, "callbacks_on_train_result": null, "explore": true, "enable_rl_module_and_learner": true, "enable_env_runner_and_connector_v2": true, "_prior_exploration_config": {"type": "StochasticSampling"}, "count_steps_by": "env_steps", "policy_map_capacity": 100, "policy_mapping_fn": "<function AlgorithmConfig.DEFAULT_POLICY_MAPPING_FN at 0x3881edb20>", "policies_to_train": null, "policy_states_are_swappable": false, "observation_fn": null, "offline_data_class": null, "input_read_method": "read_parquet", "input_read_method_kwargs": {}, "input_read_schema": {}, "input_read_episodes": false, "input_read_sample_batches": false, "input_read_batch_size": null, "input_filesystem": null, "input_filesystem_kwargs": {}, "input_compress_columns": ["obs", "new_obs"], "input_spaces_jsonable": true, "materialize_data": false, "materialize_mapped_data": true, "map_batches_kwargs": {}, "iter_batches_kwargs": {}, "ignore_final_observation": false, "prelearner_class": null, "prelearner_buffer_class": null, "prelearner_buffer_kwargs": {}, "prelearner_module_synch_period": 10, "dataset_num_iters_per_learner": null, "input_config": {}, "actions_in_input_normalized": false, "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_config": {}, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "output_max_rows_per_file": null, "output_write_remaining_data": false, "output_write_method": "write_parquet", "output_write_method_kwargs": {}, "output_filesystem": null, "output_filesystem_kwargs": {}, "output_write_episodes": true, "offline_sampling": false, "evaluation_interval": 1, "evaluation_duration": 20, "evaluation_duration_unit": "episodes", "evaluation_sample_timeout_s": 120.0, "evaluation_auto_duration_min_env_steps_per_sample": 100, "evaluation_auto_duration_max_env_steps_per_sample": 2000, "evaluation_parallel_to_training": false, "evaluation_force_reset_envs_before_iteration": true, "evaluation_config": null, "off_policy_estimation_methods": {}, "ope_split_batch_by_episode": true, "evaluation_num_env_runners": 1, "in_evaluation": false, "sync_filters_on_rollout_workers_timeout_s": 10.0, "offline_evaluation_interval": null, "num_offline_eval_runners": 0, "offline_loss_for_module_fn": null, "offline_evaluation_duration": 1, "offline_evaluation_parallel_to_training": false, "offline_evaluation_timeout_s": 120.0, "num_cpus_per_offline_eval_runner": 1, "num_gpus_per_offline_eval_runner": 0, "custom_resources_per_offline_eval_runner": {}, "restart_failed_offline_eval_runners": true, "ignore_offline_eval_runner_failures": false, "max_num_offline_eval_runner_restarts": 1000, "offline_eval_runner_restore_timeout_s": 1800.0, "max_requests_in_flight_per_offline_eval_runner": 1, "validate_offline_eval_runners_after_construction": true, "offline_eval_runner_health_probe_timeout_s": 30.0, "offline_eval_rl_module_inference_only": false, "broadcast_offline_eval_runner_states": false, "offline_eval_batch_size_per_runner": 256, "dataset_num_iters_per_eval_runner": 1, "keep_per_episode_custom_metrics": false, "metrics_episode_collection_timeout_s": 60.0, "metrics_num_episodes_for_smoothing": 100, "min_time_s_per_iteration": null, "min_train_timesteps_per_iteration": 0, "min_sample_timesteps_per_iteration": 0, "log_gradients": true, "export_native_model_files": false, "checkpoint_trainable_policies_only": false, "logger_creator": null, "logger_config": null, "log_level": "WARN", "log_sys_usage": true, "fake_sampler": false, "seed": 2, "restart_failed_env_runners": true, "ignore_env_runner_failures": false, "max_num_env_runner_restarts": 1000, "delay_between_env_runner_restarts_s": 60.0, "restart_failed_sub_environments": false, "num_consecutive_env_runner_failures_tolerance": 100, "env_runner_health_probe_timeout_s": 30.0, "env_runner_restore_timeout_s": 1800.0, "_model_config": {}, "_rl_module_spec": "RLModuleSpec(module_class=None, observation_space=None, action_space=None, inference_only=False, learner_only=False, model_config=DefaultModelConfig(fcnet_hiddens=[60, 90], fcnet_activation='tanh', fcnet_kernel_initializer=None, fcnet_kernel_initializer_kwargs=None, fcnet_bias_initializer=None, fcnet_bias_initializer_kwargs=None, conv_filters=None, conv_activation='relu', conv_kernel_initializer=None, conv_kernel_initializer_kwargs=None, conv_bias_initializer=None, conv_bias_initializer_kwargs=None, head_fcnet_hiddens=[], head_fcnet_activation='relu', head_fcnet_kernel_initializer=None, head_fcnet_kernel_initializer_kwargs=None, head_fcnet_bias_initializer=None, head_fcnet_bias_initializer_kwargs=None, free_log_std=False, log_std_clip_param=20.0, vf_share_layers=True, use_lstm=False, max_seq_len=20, lstm_cell_size=256, lstm_use_prev_action=False, lstm_use_prev_reward=False, lstm_kernel_initializer=None, lstm_kernel_initializer_kwargs=None, lstm_bias_initializer=None, lstm_bias_initializer_kwargs=None), catalog_class=None, load_state_path=None, model_config_dict=None)", "algorithm_config_overrides_per_module": {}, "_per_module_overrides": {}, "_validate_config": true, "_use_msgpack_checkpoints": false, "_torch_grad_scaler_class": null, "_torch_lr_scheduler_classes": null, "_tf_policy_handles_more_than_one_loss": false, "_disable_preprocessor_api": false, "_disable_action_flattening": false, "_disable_initialize_loss_from_dummy_batch": false, "_dont_auto_sync_env_runner_states": false, "env_task_fn": -1, "enable_connectors": -1, "simple_optimizer": false, "policy_map_cache": -1, "worker_cls": -1, "synchronize_filters": -1, "enable_async_evaluation": -1, "custom_async_evaluation_function": -1, "_enable_rl_module_api": -1, "auto_wrap_old_gym_envs": -1, "always_attach_evaluation_results": -1, "replay_sequence_length": null, "_disable_execution_plan_api": -1, "use_critic": true, "use_gae": true, "use_kl_loss": true, "kl_coeff": 0.7464963036515, "kl_target": 0.0270990929592, "vf_loss_coeff": 0.6688075857018, "entropy_coeff": 0.0090570820258, "clip_param": 0.1221781641624, "vf_clip_param": 0.1027808522125, "entropy_coeff_schedule": null, "lr_schedule": null, "sgd_minibatch_size": -1, "vf_share_layers": -1, "__stdout_file__": null, "__stderr_file__": null, "lambda": 0.9099046732075, "input": "sampler", "policies": {"default_policy": [null, null, null, null]}, "callbacks": "<class 'ray.rllib.callbacks.callbacks.RLlibCallback'>", "create_env_on_driver": false, "custom_eval_function": null, "framework": "torch"}, "time_since_restore": 28.463254690170288, "iterations_since_restore": 17, "perf": {"cpu_util_percent": 53.333333333333336, "ram_util_percent": 79.0}}
{"timers": {"training_iteration": 1.5546691285106464, "restore_env_runners": 1.1159459009816773e-05, "training_step": 1.5545294438668515, "env_runner_sampling_timer": 1.4429526794562293, "learner_update_timer": 0.10853317020854011, "synch_weights": 0.0005549218689479607, "restore_eval_env_runners": 7.808747432795722e-06, "evaluation_iteration": 0.1045907977418978, "synch_eval_env_connectors": 0.00020235740636610877, "synch_env_connectors": 4.246670148750812e-06}, "env_runners": {"num_module_steps_sampled_lifetime": {"default_policy": -9870000.0}, "num_env_steps_sampled_lifetime": -9870000.0, "episode_len_mean": 20.0, "env_to_module_connector": {"timers": {"connectors": {"add_time_dim_to_batch_and_zero_pad": 2.4551951547552216e-06, "add_observations_from_episodes_to_batch": 3.040766661930485e-06, "add_states_from_episodes_to_batch": 1.6986647904924253e-06, "numpy_to_tensor": 8.830161025392361e-06, "batch_individual_items": 6.357325898033111e-06}}, "connector_pipeline_timer": 4.426062875942958e-05}, "weights_seq_no": 17.0, "episode_len_min": 20, "num_agent_steps_sampled_lifetime": {"default_agent": -9870000.0}, "module_to_env_connector": {"connector_pipeline_timer": 0.00010699517521339788, "timers": {"connectors": {"tensor_to_numpy": 1.3510426937953752e-05, "listify_data_for_vector_env": 1.1108783072122295e-05, "get_actions": 4.063954338341916e-05, "un_batch_to_individual_items": 5.409095950994568e-06, "normalize_and_clip_actions": 9.601013208682019e-06, "remove_single_ts_time_rank_from_batch": 6.091373547248519e-07}}}, "env_reset_timer": 4.530688702822687e-05, "env_to_module_sum_episodes_length_out": 10.36823839457432, "env_to_module_sum_episodes_length_in": 10.36823839457432, "num_module_steps_sampled": {"default_policy": 5000.0}, "episode_return_mean": 7.059999999999999, "episode_len_max": 20, "num_env_steps_sampled": 5000.0, "num_episodes_lifetime": -493500.0, "agent_episode_returns_mean": {"default_agent": 7.059999999999999}, "episode_return_min": -11.5, "sample": 0.005411963496422102, "num_episodes": 250.0, "num_agent_steps_sampled": {"default_agent": 5000.0}, "rlmodule_inference_timer": 2.8813903955444393e-05, "module_episode_returns_mean": {"default_policy": 7.059999999999999}, "episode_return_max": 8.5, "env_step_timer": 1.4300551058488702e-05, "time_between_sampling": 0.001571002573912672, "episode_duration_sec_mean": 0.004678026488982141, "num_env_steps_sampled_lifetime_throughput": 3626.078258615641}, "learners": {"__all_modules__": {"learner_connector": {"timers": {"connectors": {"numpy_to_tensor": 5.86333615470581e-05, "add_observations_from_episodes_to_batch": 0.0008196935942409294, "add_one_ts_to_episodes_and_truncate": 0.008530992367014158, "add_states_from_episodes_to_batch": 2.8798877952108685e-06, "add_columns_from_episodes_to_train_batch": 0.03453071582194985, "add_time_dim_to_batch_and_zero_pad": 1.0152531456038439e-05, "general_advantage_estimation": 0.006240067036264135, "batch_individual_items": 0.03537624755506637}}, "connector_pipeline_timer": 0.08568125396080005}, "num_module_steps_trained": 6000, "num_trainable_parameters": 6003, "num_module_steps_trained_lifetime": 108000, "learner_connector_sum_episodes_length_out": 5250.0, "num_env_steps_trained_lifetime": 567000, "num_env_steps_trained": 31500, "learner_connector_sum_episodes_length_in": 5000.0, "num_non_trainable_parameters": 0, "num_env_steps_trained_lifetime_throughput": 2306768.212999887, "num_module_steps_trained_throughput": 440849.34021658124, "num_module_steps_trained_lifetime_throughput": 440299.2493227913}, "default_policy": {"module_train_batch_size_mean": 1000.0, "entropy": 0.43428218364715576, "mean_kl_loss": 0.00011860190716106445, "policy_loss": -0.1296107918024063, "default_optimizer_learning_rate": 0.0002847858517, "total_loss": -0.06480350345373154, "gradients_default_optimizer_global_norm": 0.08864210546016693, "diff_num_grad_updates_vs_sampler_policy": 1.0, "num_module_steps_trained": 6000, "num_trainable_parameters": 6003, "num_module_steps_trained_lifetime": 108000, "vf_loss_unclipped": 27.705440521240234, "vf_explained_var": 0.01639944314956665, "curr_entropy_coeff": 0.0090570820258, "curr_kl_coeff": 2.847657469828846e-06, "weights_seq_no": 18.0, "vf_loss": 0.10278083384037018, "num_module_steps_trained_lifetime_throughput": 441085.41319924314}}, "num_training_step_calls_per_iteration": 1, "evaluation": {"env_runners": {"env_to_module_connector": {"timers": {"connectors": {"add_time_dim_to_batch_and_zero_pad": 2.2645296732750084e-06, "batch_individual_items": 6.290522253637905e-06, "numpy_to_tensor": 8.691848353469747e-06, "add_observations_from_episodes_to_batch": 2.7752022871552976e-06, "add_states_from_episodes_to_batch": 1.6516243880461435e-06}}, "connector_pipeline_timer": 4.315122458616524e-05}, "module_episode_returns_mean": {"default_policy": 0.0}, "num_module_steps_sampled_lifetime": {"default_policy": 7200}, "episode_return_mean": 0.0, "env_step_timer": 1.4468643348354415e-05, "num_module_steps_sampled": {"default_policy": 400}, "episode_len_mean": 20.0, "module_to_env_connector": {"timers": {"connectors": {"normalize_and_clip_actions": 9.487803848563972e-06, "listify_data_for_vector_env": 1.0919668056689236e-05, "get_actions": 3.695576430164068e-05, "remove_single_ts_time_rank_from_batch": 5.852307255528429e-07, "tensor_to_numpy": 1.30728185606522e-05, "un_batch_to_individual_items": 5.4526400301973915e-06}}, "connector_pipeline_timer": 0.00010220096011685394}, "num_env_steps_sampled": 400, "num_episodes_lifetime": 360, "sample": 0.09854493704782138, "episode_duration_sec_mean": 0.004534420830896124, "num_env_steps_sampled_lifetime": 90400, "agent_episode_returns_mean": {"default_agent": 0.0}, "env_reset_timer": 0.00013594961302639772, "rlmodule_inference_timer": 2.795963317368485e-05, "num_agent_steps_sampled_lifetime": {"default_agent": 7200}, "episode_len_min": 20, "weights_seq_no": 18.0, "env_to_module_sum_episodes_length_out": 10.368238394574323, "num_agent_steps_sampled": {"default_agent": 400}, "env_to_module_sum_episodes_length_in": 10.368238394574323, "episode_len_max": 20, "episode_return_min": -13.5, "num_episodes": 20, "episode_return_max": 14.5, "time_between_sampling": 1.6048799520992958}, "num_healthy_workers": 1, "actor_manager_num_outstanding_async_reqs": 0, "num_remote_worker_restarts": 0}, "num_env_steps_sampled_lifetime": -9870000.0, "fault_tolerance": {"num_healthy_workers": 0, "num_remote_worker_restarts": 0}, "env_runner_group": {"actor_manager_num_outstanding_async_reqs": 0}, "done": false, "training_iteration": 18, "trial_id": "43aed_00000", "date": "2025-08-11_19-23-29", "timestamp": 1754933009, "time_this_iter_s": 1.743394136428833, "time_total_s": 30.20664882659912, "pid": 14402, "hostname": "Mac", "node_ip": "127.0.0.1", "config": {"exploration_config": {}, "extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "placement_strategy": "PACK", "num_gpus": 0, "_fake_gpus": false, "num_cpus_for_main_process": 2, "eager_tracing": true, "eager_max_retraces": 20, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "torch_compile_learner": false, "torch_compile_learner_what_to_compile": "forward_train", "torch_compile_learner_dynamo_backend": "aot_eager", "torch_compile_learner_dynamo_mode": null, "torch_compile_worker": false, "torch_compile_worker_dynamo_backend": "aot_eager", "torch_compile_worker_dynamo_mode": null, "torch_ddp_kwargs": {}, "torch_skip_nan_gradients": false, "env": "Umbrella", "env_config": {}, "observation_space": null, "action_space": null, "clip_rewards": null, "normalize_actions": true, "clip_actions": false, "_is_atari": null, "disable_env_checking": false, "render_env": false, "action_mask_key": "action_mask", "env_runner_cls": null, "num_env_runners": 0, "create_local_env_runner": true, "num_envs_per_env_runner": 1, "gym_env_vectorize_mode": "SYNC", "num_cpus_per_env_runner": 1, "num_gpus_per_env_runner": 0, "custom_resources_per_env_runner": {}, "validate_env_runners_after_construction": true, "episodes_to_numpy": true, "max_requests_in_flight_per_env_runner": 1, "sample_timeout_s": 60.0, "_env_to_module_connector": null, "add_default_connectors_to_env_to_module_pipeline": true, "_module_to_env_connector": null, "add_default_connectors_to_module_to_env_pipeline": true, "merge_env_runner_states": "training_only", "broadcast_env_runner_states": true, "episode_lookback_horizon": 1, "rollout_fragment_length": "auto", "batch_mode": "complete_episodes", "compress_observations": false, "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "enable_tf1_exec_eagerly": false, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "preprocessor_pref": "deepmind", "observation_filter": "NoFilter", "update_worker_filter_stats": true, "use_worker_filter_stats": true, "sampler_perf_stats_ema_coef": null, "_is_online": true, "num_learners": 0, "num_gpus_per_learner": 0, "num_cpus_per_learner": "auto", "num_aggregator_actors_per_learner": 0, "max_requests_in_flight_per_aggregator_actor": 3, "local_gpu_idx": 0, "max_requests_in_flight_per_learner": 3, "gamma": 1, "lr": 0.0002847858517, "grad_clip": 0.5, "grad_clip_by": "global_norm", "_train_batch_size_per_learner": 5000, "train_batch_size": 4000, "num_epochs": 1, "minibatch_size": 1000, "shuffle_batch_per_epoch": true, "model": {"fcnet_hiddens": [256, 256], "fcnet_activation": "tanh", "fcnet_weights_initializer": null, "fcnet_weights_initializer_config": null, "fcnet_bias_initializer": null, "fcnet_bias_initializer_config": null, "conv_filters": null, "conv_activation": "relu", "conv_kernel_initializer": null, "conv_kernel_initializer_config": null, "conv_bias_initializer": null, "conv_bias_initializer_config": null, "conv_transpose_kernel_initializer": null, "conv_transpose_kernel_initializer_config": null, "conv_transpose_bias_initializer": null, "conv_transpose_bias_initializer_config": null, "post_fcnet_hiddens": [], "post_fcnet_activation": "relu", "post_fcnet_weights_initializer": null, "post_fcnet_weights_initializer_config": null, "post_fcnet_bias_initializer": null, "post_fcnet_bias_initializer_config": null, "free_log_std": false, "log_std_clip_param": 20.0, "no_final_linear": false, "vf_share_layers": false, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "lstm_weights_initializer": null, "lstm_weights_initializer_config": null, "lstm_bias_initializer": null, "lstm_bias_initializer_config": null, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "attention_use_n_prev_actions": 0, "attention_use_n_prev_rewards": 0, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": null, "custom_model_config": {}, "custom_action_dist": null, "custom_preprocessor": null, "encoder_latent_dim": null, "always_check_shapes": false, "lstm_use_prev_action_reward": -1, "_use_default_native_models": -1, "_disable_preprocessor_api": false, "_disable_action_flattening": false}, "_learner_connector": null, "add_default_connectors_to_learner_pipeline": true, "learner_config_dict": {}, "optimizer": {}, "_learner_class": null, "callbacks_on_algorithm_init": null, "callbacks_on_env_runners_recreated": null, "callbacks_on_offline_eval_runners_recreated": null, "callbacks_on_checkpoint_loaded": null, "callbacks_on_environment_created": null, "callbacks_on_episode_created": null, "callbacks_on_episode_start": null, "callbacks_on_episode_step": null, "callbacks_on_episode_end": null, "callbacks_on_evaluate_start": null, "callbacks_on_evaluate_end": null, "callbacks_on_evaluate_offline_start": null, "callbacks_on_evaluate_offline_end": null, "callbacks_on_sample_end": null, "callbacks_on_train_result": null, "explore": true, "enable_rl_module_and_learner": true, "enable_env_runner_and_connector_v2": true, "_prior_exploration_config": {"type": "StochasticSampling"}, "count_steps_by": "env_steps", "policy_map_capacity": 100, "policy_mapping_fn": "<function AlgorithmConfig.DEFAULT_POLICY_MAPPING_FN at 0x3881edb20>", "policies_to_train": null, "policy_states_are_swappable": false, "observation_fn": null, "offline_data_class": null, "input_read_method": "read_parquet", "input_read_method_kwargs": {}, "input_read_schema": {}, "input_read_episodes": false, "input_read_sample_batches": false, "input_read_batch_size": null, "input_filesystem": null, "input_filesystem_kwargs": {}, "input_compress_columns": ["obs", "new_obs"], "input_spaces_jsonable": true, "materialize_data": false, "materialize_mapped_data": true, "map_batches_kwargs": {}, "iter_batches_kwargs": {}, "ignore_final_observation": false, "prelearner_class": null, "prelearner_buffer_class": null, "prelearner_buffer_kwargs": {}, "prelearner_module_synch_period": 10, "dataset_num_iters_per_learner": null, "input_config": {}, "actions_in_input_normalized": false, "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_config": {}, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "output_max_rows_per_file": null, "output_write_remaining_data": false, "output_write_method": "write_parquet", "output_write_method_kwargs": {}, "output_filesystem": null, "output_filesystem_kwargs": {}, "output_write_episodes": true, "offline_sampling": false, "evaluation_interval": 1, "evaluation_duration": 20, "evaluation_duration_unit": "episodes", "evaluation_sample_timeout_s": 120.0, "evaluation_auto_duration_min_env_steps_per_sample": 100, "evaluation_auto_duration_max_env_steps_per_sample": 2000, "evaluation_parallel_to_training": false, "evaluation_force_reset_envs_before_iteration": true, "evaluation_config": null, "off_policy_estimation_methods": {}, "ope_split_batch_by_episode": true, "evaluation_num_env_runners": 1, "in_evaluation": false, "sync_filters_on_rollout_workers_timeout_s": 10.0, "offline_evaluation_interval": null, "num_offline_eval_runners": 0, "offline_loss_for_module_fn": null, "offline_evaluation_duration": 1, "offline_evaluation_parallel_to_training": false, "offline_evaluation_timeout_s": 120.0, "num_cpus_per_offline_eval_runner": 1, "num_gpus_per_offline_eval_runner": 0, "custom_resources_per_offline_eval_runner": {}, "restart_failed_offline_eval_runners": true, "ignore_offline_eval_runner_failures": false, "max_num_offline_eval_runner_restarts": 1000, "offline_eval_runner_restore_timeout_s": 1800.0, "max_requests_in_flight_per_offline_eval_runner": 1, "validate_offline_eval_runners_after_construction": true, "offline_eval_runner_health_probe_timeout_s": 30.0, "offline_eval_rl_module_inference_only": false, "broadcast_offline_eval_runner_states": false, "offline_eval_batch_size_per_runner": 256, "dataset_num_iters_per_eval_runner": 1, "keep_per_episode_custom_metrics": false, "metrics_episode_collection_timeout_s": 60.0, "metrics_num_episodes_for_smoothing": 100, "min_time_s_per_iteration": null, "min_train_timesteps_per_iteration": 0, "min_sample_timesteps_per_iteration": 0, "log_gradients": true, "export_native_model_files": false, "checkpoint_trainable_policies_only": false, "logger_creator": null, "logger_config": null, "log_level": "WARN", "log_sys_usage": true, "fake_sampler": false, "seed": 2, "restart_failed_env_runners": true, "ignore_env_runner_failures": false, "max_num_env_runner_restarts": 1000, "delay_between_env_runner_restarts_s": 60.0, "restart_failed_sub_environments": false, "num_consecutive_env_runner_failures_tolerance": 100, "env_runner_health_probe_timeout_s": 30.0, "env_runner_restore_timeout_s": 1800.0, "_model_config": {}, "_rl_module_spec": "RLModuleSpec(module_class=None, observation_space=None, action_space=None, inference_only=False, learner_only=False, model_config=DefaultModelConfig(fcnet_hiddens=[60, 90], fcnet_activation='tanh', fcnet_kernel_initializer=None, fcnet_kernel_initializer_kwargs=None, fcnet_bias_initializer=None, fcnet_bias_initializer_kwargs=None, conv_filters=None, conv_activation='relu', conv_kernel_initializer=None, conv_kernel_initializer_kwargs=None, conv_bias_initializer=None, conv_bias_initializer_kwargs=None, head_fcnet_hiddens=[], head_fcnet_activation='relu', head_fcnet_kernel_initializer=None, head_fcnet_kernel_initializer_kwargs=None, head_fcnet_bias_initializer=None, head_fcnet_bias_initializer_kwargs=None, free_log_std=False, log_std_clip_param=20.0, vf_share_layers=True, use_lstm=False, max_seq_len=20, lstm_cell_size=256, lstm_use_prev_action=False, lstm_use_prev_reward=False, lstm_kernel_initializer=None, lstm_kernel_initializer_kwargs=None, lstm_bias_initializer=None, lstm_bias_initializer_kwargs=None), catalog_class=None, load_state_path=None, model_config_dict=None)", "algorithm_config_overrides_per_module": {}, "_per_module_overrides": {}, "_validate_config": true, "_use_msgpack_checkpoints": false, "_torch_grad_scaler_class": null, "_torch_lr_scheduler_classes": null, "_tf_policy_handles_more_than_one_loss": false, "_disable_preprocessor_api": false, "_disable_action_flattening": false, "_disable_initialize_loss_from_dummy_batch": false, "_dont_auto_sync_env_runner_states": false, "env_task_fn": -1, "enable_connectors": -1, "simple_optimizer": false, "policy_map_cache": -1, "worker_cls": -1, "synchronize_filters": -1, "enable_async_evaluation": -1, "custom_async_evaluation_function": -1, "_enable_rl_module_api": -1, "auto_wrap_old_gym_envs": -1, "always_attach_evaluation_results": -1, "replay_sequence_length": null, "_disable_execution_plan_api": -1, "use_critic": true, "use_gae": true, "use_kl_loss": true, "kl_coeff": 0.7464963036515, "kl_target": 0.0270990929592, "vf_loss_coeff": 0.6688075857018, "entropy_coeff": 0.0090570820258, "clip_param": 0.1221781641624, "vf_clip_param": 0.1027808522125, "entropy_coeff_schedule": null, "lr_schedule": null, "sgd_minibatch_size": -1, "vf_share_layers": -1, "__stdout_file__": null, "__stderr_file__": null, "lambda": 0.9099046732075, "input": "sampler", "policies": {"default_policy": [null, null, null, null]}, "callbacks": "<class 'ray.rllib.callbacks.callbacks.RLlibCallback'>", "create_env_on_driver": false, "custom_eval_function": null, "framework": "torch"}, "time_since_restore": 30.20664882659912, "iterations_since_restore": 18, "perf": {"cpu_util_percent": 50.633333333333326, "ram_util_percent": 78.26666666666667}}
{"timers": {"training_iteration": 1.554729379305734, "restore_env_runners": 1.1100774019335729e-05, "training_step": 1.5545893006775118, "env_runner_sampling_timer": 1.442238735581207, "learner_update_timer": 0.10930565350598481, "synch_weights": 0.0005554301503992226, "restore_eval_env_runners": 7.790249469251317e-06, "evaluation_iteration": 0.10459122934410388, "synch_eval_env_connectors": 0.00020129675232371342, "synch_env_connectors": 4.239622808929148e-06}, "env_runners": {"num_module_steps_sampled_lifetime": {"default_policy": -10487500.0}, "num_env_steps_sampled_lifetime": -10487500.0, "episode_len_mean": 20.0, "env_to_module_connector": {"timers": {"connectors": {"add_time_dim_to_batch_and_zero_pad": 2.3868123735343466e-06, "add_observations_from_episodes_to_batch": 2.97534109371713e-06, "add_states_from_episodes_to_batch": 1.691569814015179e-06, "numpy_to_tensor": 8.457258036439135e-06, "batch_individual_items": 6.188458850129764e-06}}, "connector_pipeline_timer": 4.3304833743597224e-05}, "weights_seq_no": 18.0, "episode_len_min": 20, "num_agent_steps_sampled_lifetime": {"default_agent": -10487500.0}, "module_to_env_connector": {"connector_pipeline_timer": 0.0001037769926970998, "timers": {"connectors": {"tensor_to_numpy": 1.3096938253099234e-05, "listify_data_for_vector_env": 1.0796185656855168e-05, "get_actions": 3.9047943432122444e-05, "un_batch_to_individual_items": 5.348356520367884e-06, "normalize_and_clip_actions": 9.322808173779045e-06, "remove_single_ts_time_rank_from_batch": 6.017748138758619e-07}}}, "env_reset_timer": 3.6816304354361884e-05, "env_to_module_sum_episodes_length_out": 10.36823839457432, "env_to_module_sum_episodes_length_in": 10.36823839457432, "num_module_steps_sampled": {"default_policy": 5000.0}, "episode_return_mean": 6.74, "episode_len_max": 20, "num_env_steps_sampled": 5000.0, "num_episodes_lifetime": -524375.0, "agent_episode_returns_mean": {"default_agent": 6.74}, "episode_return_min": -11.5, "sample": 0.004954992368882369, "num_episodes": 250.0, "num_agent_steps_sampled": {"default_agent": 5000.0}, "rlmodule_inference_timer": 2.7810336943126086e-05, "module_episode_returns_mean": {"default_policy": 6.74}, "episode_return_max": 8.5, "env_step_timer": 1.3737811450856498e-05, "time_between_sampling": 0.0019450186702859927, "episode_duration_sec_mean": 0.004535358835011722, "num_env_steps_sampled_lifetime_throughput": 3723.7437070714527}, "learners": {"__all_modules__": {"learner_connector": {"timers": {"connectors": {"numpy_to_tensor": 5.870744855985206e-05, "add_observations_from_episodes_to_batch": 0.0008197766584822514, "add_one_ts_to_episodes_and_truncate": 0.008521921614083444, "add_states_from_episodes_to_batch": 2.8790099680457318e-06, "add_columns_from_episodes_to_train_batch": 0.03453196074373949, "add_time_dim_to_batch_and_zero_pad": 1.0130595804551474e-05, "general_advantage_estimation": 0.006231662196141222, "batch_individual_items": 0.036245588829314314}}, "connector_pipeline_timer": 0.08653425892127856}, "num_module_steps_trained": 6000, "num_trainable_parameters": 6003, "num_module_steps_trained_lifetime": 114000, "learner_connector_sum_episodes_length_out": 5250.0, "num_env_steps_trained_lifetime": 598500, "num_env_steps_trained": 31500, "learner_connector_sum_episodes_length_in": 5000.0, "num_non_trainable_parameters": 0, "num_env_steps_trained_lifetime_throughput": 2298091.6416025558, "num_module_steps_trained_throughput": 439136.4088934276, "num_module_steps_trained_lifetime_throughput": 438605.0185669643}, "default_policy": {"module_train_batch_size_mean": 1000.0, "entropy": 0.41222673654556274, "mean_kl_loss": 0.000583978951908648, "policy_loss": -0.059229280799627304, "default_optimizer_learning_rate": 0.0002847858517, "total_loss": 0.005777741316705942, "gradients_default_optimizer_global_norm": 0.13775816559791565, "diff_num_grad_updates_vs_sampler_policy": 1.0, "num_module_steps_trained": 6000, "num_trainable_parameters": 6003, "num_module_steps_trained_lifetime": 114000, "vf_loss_unclipped": 27.868133544921875, "vf_explained_var": 0.007687926292419434, "curr_entropy_coeff": 0.0090570820258, "curr_kl_coeff": 1.423828734914423e-06, "weights_seq_no": 19.0, "vf_loss": 0.10278083384037018, "num_module_steps_trained_lifetime_throughput": 439331.201868645}}, "num_training_step_calls_per_iteration": 1, "evaluation": {"env_runners": {"env_to_module_connector": {"timers": {"connectors": {"add_time_dim_to_batch_and_zero_pad": 2.209983834229262e-06, "batch_individual_items": 6.017471003000492e-06, "numpy_to_tensor": 8.096622375788064e-06, "add_observations_from_episodes_to_batch": 2.7673741236739733e-06, "add_states_from_episodes_to_batch": 1.6198242046637137e-06}}, "connector_pipeline_timer": 4.194213598300127e-05}, "module_episode_returns_mean": {"default_policy": 0.0}, "num_module_steps_sampled_lifetime": {"default_policy": 7600}, "episode_return_mean": 0.0, "env_step_timer": 1.3649416436928865e-05, "num_module_steps_sampled": {"default_policy": 400}, "episode_len_mean": 20.0, "module_to_env_connector": {"timers": {"connectors": {"normalize_and_clip_actions": 9.230264153036042e-06, "listify_data_for_vector_env": 1.0672033756537346e-05, "get_actions": 3.421177184701495e-05, "remove_single_ts_time_rank_from_batch": 5.589929940453665e-07, "tensor_to_numpy": 1.2855007674680037e-05, "un_batch_to_individual_items": 5.284988194878457e-06}}, "connector_pipeline_timer": 9.783578638083324e-05}, "num_env_steps_sampled": 400, "num_episodes_lifetime": 380, "sample": 0.09852387476798703, "episode_duration_sec_mean": 0.004532561680534854, "num_env_steps_sampled_lifetime": 95400, "agent_episode_returns_mean": {"default_agent": 0.0}, "env_reset_timer": 0.00013541386705676826, "rlmodule_inference_timer": 2.6657356602768977e-05, "num_agent_steps_sampled_lifetime": {"default_agent": 7600}, "episode_len_min": 20, "weights_seq_no": 19.0, "env_to_module_sum_episodes_length_out": 10.368238394574323, "num_agent_steps_sampled": {"default_agent": 400}, "env_to_module_sum_episodes_length_in": 10.368238394574323, "episode_len_max": 20, "episode_return_min": -13.5, "num_episodes": 20, "episode_return_max": 14.5, "time_between_sampling": 1.604623223408078}, "num_healthy_workers": 1, "actor_manager_num_outstanding_async_reqs": 0, "num_remote_worker_restarts": 0}, "num_env_steps_sampled_lifetime": -10487500.0, "fault_tolerance": {"num_healthy_workers": 0, "num_remote_worker_restarts": 0}, "env_runner_group": {"actor_manager_num_outstanding_async_reqs": 0}, "done": false, "training_iteration": 19, "trial_id": "43aed_00000", "date": "2025-08-11_19-23-31", "timestamp": 1754933011, "time_this_iter_s": 1.6645278930664062, "time_total_s": 31.871176719665527, "pid": 14402, "hostname": "Mac", "node_ip": "127.0.0.1", "config": {"exploration_config": {}, "extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "placement_strategy": "PACK", "num_gpus": 0, "_fake_gpus": false, "num_cpus_for_main_process": 2, "eager_tracing": true, "eager_max_retraces": 20, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "torch_compile_learner": false, "torch_compile_learner_what_to_compile": "forward_train", "torch_compile_learner_dynamo_backend": "aot_eager", "torch_compile_learner_dynamo_mode": null, "torch_compile_worker": false, "torch_compile_worker_dynamo_backend": "aot_eager", "torch_compile_worker_dynamo_mode": null, "torch_ddp_kwargs": {}, "torch_skip_nan_gradients": false, "env": "Umbrella", "env_config": {}, "observation_space": null, "action_space": null, "clip_rewards": null, "normalize_actions": true, "clip_actions": false, "_is_atari": null, "disable_env_checking": false, "render_env": false, "action_mask_key": "action_mask", "env_runner_cls": null, "num_env_runners": 0, "create_local_env_runner": true, "num_envs_per_env_runner": 1, "gym_env_vectorize_mode": "SYNC", "num_cpus_per_env_runner": 1, "num_gpus_per_env_runner": 0, "custom_resources_per_env_runner": {}, "validate_env_runners_after_construction": true, "episodes_to_numpy": true, "max_requests_in_flight_per_env_runner": 1, "sample_timeout_s": 60.0, "_env_to_module_connector": null, "add_default_connectors_to_env_to_module_pipeline": true, "_module_to_env_connector": null, "add_default_connectors_to_module_to_env_pipeline": true, "merge_env_runner_states": "training_only", "broadcast_env_runner_states": true, "episode_lookback_horizon": 1, "rollout_fragment_length": "auto", "batch_mode": "complete_episodes", "compress_observations": false, "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "enable_tf1_exec_eagerly": false, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "preprocessor_pref": "deepmind", "observation_filter": "NoFilter", "update_worker_filter_stats": true, "use_worker_filter_stats": true, "sampler_perf_stats_ema_coef": null, "_is_online": true, "num_learners": 0, "num_gpus_per_learner": 0, "num_cpus_per_learner": "auto", "num_aggregator_actors_per_learner": 0, "max_requests_in_flight_per_aggregator_actor": 3, "local_gpu_idx": 0, "max_requests_in_flight_per_learner": 3, "gamma": 1, "lr": 0.0002847858517, "grad_clip": 0.5, "grad_clip_by": "global_norm", "_train_batch_size_per_learner": 5000, "train_batch_size": 4000, "num_epochs": 1, "minibatch_size": 1000, "shuffle_batch_per_epoch": true, "model": {"fcnet_hiddens": [256, 256], "fcnet_activation": "tanh", "fcnet_weights_initializer": null, "fcnet_weights_initializer_config": null, "fcnet_bias_initializer": null, "fcnet_bias_initializer_config": null, "conv_filters": null, "conv_activation": "relu", "conv_kernel_initializer": null, "conv_kernel_initializer_config": null, "conv_bias_initializer": null, "conv_bias_initializer_config": null, "conv_transpose_kernel_initializer": null, "conv_transpose_kernel_initializer_config": null, "conv_transpose_bias_initializer": null, "conv_transpose_bias_initializer_config": null, "post_fcnet_hiddens": [], "post_fcnet_activation": "relu", "post_fcnet_weights_initializer": null, "post_fcnet_weights_initializer_config": null, "post_fcnet_bias_initializer": null, "post_fcnet_bias_initializer_config": null, "free_log_std": false, "log_std_clip_param": 20.0, "no_final_linear": false, "vf_share_layers": false, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "lstm_weights_initializer": null, "lstm_weights_initializer_config": null, "lstm_bias_initializer": null, "lstm_bias_initializer_config": null, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "attention_use_n_prev_actions": 0, "attention_use_n_prev_rewards": 0, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": null, "custom_model_config": {}, "custom_action_dist": null, "custom_preprocessor": null, "encoder_latent_dim": null, "always_check_shapes": false, "lstm_use_prev_action_reward": -1, "_use_default_native_models": -1, "_disable_preprocessor_api": false, "_disable_action_flattening": false}, "_learner_connector": null, "add_default_connectors_to_learner_pipeline": true, "learner_config_dict": {}, "optimizer": {}, "_learner_class": null, "callbacks_on_algorithm_init": null, "callbacks_on_env_runners_recreated": null, "callbacks_on_offline_eval_runners_recreated": null, "callbacks_on_checkpoint_loaded": null, "callbacks_on_environment_created": null, "callbacks_on_episode_created": null, "callbacks_on_episode_start": null, "callbacks_on_episode_step": null, "callbacks_on_episode_end": null, "callbacks_on_evaluate_start": null, "callbacks_on_evaluate_end": null, "callbacks_on_evaluate_offline_start": null, "callbacks_on_evaluate_offline_end": null, "callbacks_on_sample_end": null, "callbacks_on_train_result": null, "explore": true, "enable_rl_module_and_learner": true, "enable_env_runner_and_connector_v2": true, "_prior_exploration_config": {"type": "StochasticSampling"}, "count_steps_by": "env_steps", "policy_map_capacity": 100, "policy_mapping_fn": "<function AlgorithmConfig.DEFAULT_POLICY_MAPPING_FN at 0x3881edb20>", "policies_to_train": null, "policy_states_are_swappable": false, "observation_fn": null, "offline_data_class": null, "input_read_method": "read_parquet", "input_read_method_kwargs": {}, "input_read_schema": {}, "input_read_episodes": false, "input_read_sample_batches": false, "input_read_batch_size": null, "input_filesystem": null, "input_filesystem_kwargs": {}, "input_compress_columns": ["obs", "new_obs"], "input_spaces_jsonable": true, "materialize_data": false, "materialize_mapped_data": true, "map_batches_kwargs": {}, "iter_batches_kwargs": {}, "ignore_final_observation": false, "prelearner_class": null, "prelearner_buffer_class": null, "prelearner_buffer_kwargs": {}, "prelearner_module_synch_period": 10, "dataset_num_iters_per_learner": null, "input_config": {}, "actions_in_input_normalized": false, "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_config": {}, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "output_max_rows_per_file": null, "output_write_remaining_data": false, "output_write_method": "write_parquet", "output_write_method_kwargs": {}, "output_filesystem": null, "output_filesystem_kwargs": {}, "output_write_episodes": true, "offline_sampling": false, "evaluation_interval": 1, "evaluation_duration": 20, "evaluation_duration_unit": "episodes", "evaluation_sample_timeout_s": 120.0, "evaluation_auto_duration_min_env_steps_per_sample": 100, "evaluation_auto_duration_max_env_steps_per_sample": 2000, "evaluation_parallel_to_training": false, "evaluation_force_reset_envs_before_iteration": true, "evaluation_config": null, "off_policy_estimation_methods": {}, "ope_split_batch_by_episode": true, "evaluation_num_env_runners": 1, "in_evaluation": false, "sync_filters_on_rollout_workers_timeout_s": 10.0, "offline_evaluation_interval": null, "num_offline_eval_runners": 0, "offline_loss_for_module_fn": null, "offline_evaluation_duration": 1, "offline_evaluation_parallel_to_training": false, "offline_evaluation_timeout_s": 120.0, "num_cpus_per_offline_eval_runner": 1, "num_gpus_per_offline_eval_runner": 0, "custom_resources_per_offline_eval_runner": {}, "restart_failed_offline_eval_runners": true, "ignore_offline_eval_runner_failures": false, "max_num_offline_eval_runner_restarts": 1000, "offline_eval_runner_restore_timeout_s": 1800.0, "max_requests_in_flight_per_offline_eval_runner": 1, "validate_offline_eval_runners_after_construction": true, "offline_eval_runner_health_probe_timeout_s": 30.0, "offline_eval_rl_module_inference_only": false, "broadcast_offline_eval_runner_states": false, "offline_eval_batch_size_per_runner": 256, "dataset_num_iters_per_eval_runner": 1, "keep_per_episode_custom_metrics": false, "metrics_episode_collection_timeout_s": 60.0, "metrics_num_episodes_for_smoothing": 100, "min_time_s_per_iteration": null, "min_train_timesteps_per_iteration": 0, "min_sample_timesteps_per_iteration": 0, "log_gradients": true, "export_native_model_files": false, "checkpoint_trainable_policies_only": false, "logger_creator": null, "logger_config": null, "log_level": "WARN", "log_sys_usage": true, "fake_sampler": false, "seed": 2, "restart_failed_env_runners": true, "ignore_env_runner_failures": false, "max_num_env_runner_restarts": 1000, "delay_between_env_runner_restarts_s": 60.0, "restart_failed_sub_environments": false, "num_consecutive_env_runner_failures_tolerance": 100, "env_runner_health_probe_timeout_s": 30.0, "env_runner_restore_timeout_s": 1800.0, "_model_config": {}, "_rl_module_spec": "RLModuleSpec(module_class=None, observation_space=None, action_space=None, inference_only=False, learner_only=False, model_config=DefaultModelConfig(fcnet_hiddens=[60, 90], fcnet_activation='tanh', fcnet_kernel_initializer=None, fcnet_kernel_initializer_kwargs=None, fcnet_bias_initializer=None, fcnet_bias_initializer_kwargs=None, conv_filters=None, conv_activation='relu', conv_kernel_initializer=None, conv_kernel_initializer_kwargs=None, conv_bias_initializer=None, conv_bias_initializer_kwargs=None, head_fcnet_hiddens=[], head_fcnet_activation='relu', head_fcnet_kernel_initializer=None, head_fcnet_kernel_initializer_kwargs=None, head_fcnet_bias_initializer=None, head_fcnet_bias_initializer_kwargs=None, free_log_std=False, log_std_clip_param=20.0, vf_share_layers=True, use_lstm=False, max_seq_len=20, lstm_cell_size=256, lstm_use_prev_action=False, lstm_use_prev_reward=False, lstm_kernel_initializer=None, lstm_kernel_initializer_kwargs=None, lstm_bias_initializer=None, lstm_bias_initializer_kwargs=None), catalog_class=None, load_state_path=None, model_config_dict=None)", "algorithm_config_overrides_per_module": {}, "_per_module_overrides": {}, "_validate_config": true, "_use_msgpack_checkpoints": false, "_torch_grad_scaler_class": null, "_torch_lr_scheduler_classes": null, "_tf_policy_handles_more_than_one_loss": false, "_disable_preprocessor_api": false, "_disable_action_flattening": false, "_disable_initialize_loss_from_dummy_batch": false, "_dont_auto_sync_env_runner_states": false, "env_task_fn": -1, "enable_connectors": -1, "simple_optimizer": false, "policy_map_cache": -1, "worker_cls": -1, "synchronize_filters": -1, "enable_async_evaluation": -1, "custom_async_evaluation_function": -1, "_enable_rl_module_api": -1, "auto_wrap_old_gym_envs": -1, "always_attach_evaluation_results": -1, "replay_sequence_length": null, "_disable_execution_plan_api": -1, "use_critic": true, "use_gae": true, "use_kl_loss": true, "kl_coeff": 0.7464963036515, "kl_target": 0.0270990929592, "vf_loss_coeff": 0.6688075857018, "entropy_coeff": 0.0090570820258, "clip_param": 0.1221781641624, "vf_clip_param": 0.1027808522125, "entropy_coeff_schedule": null, "lr_schedule": null, "sgd_minibatch_size": -1, "vf_share_layers": -1, "__stdout_file__": null, "__stderr_file__": null, "lambda": 0.9099046732075, "input": "sampler", "policies": {"default_policy": [null, null, null, null]}, "callbacks": "<class 'ray.rllib.callbacks.callbacks.RLlibCallback'>", "create_env_on_driver": false, "custom_eval_function": null, "framework": "torch"}, "time_since_restore": 31.871176719665527, "iterations_since_restore": 19, "perf": {"cpu_util_percent": 48.0, "ram_util_percent": 78.1}}
{"timers": {"training_iteration": 1.553797609262639, "restore_env_runners": 1.1046016998495927e-05, "training_step": 1.5536570435006194, "env_runner_sampling_timer": 1.4414882915553682, "learner_update_timer": 0.10912209905110098, "synch_weights": 0.0005562908488477702, "restore_eval_env_runners": 7.779846906460498e-06, "evaluation_iteration": 0.10455929705094268, "synch_eval_env_connectors": 0.0002003279545673047, "synch_env_connectors": 4.233477147903546e-06}, "env_runners": {"num_module_steps_sampled_lifetime": {"default_policy": -11105000.0}, "num_env_steps_sampled_lifetime": -11105000.0, "episode_len_mean": 20.0, "env_to_module_connector": {"timers": {"connectors": {"add_time_dim_to_batch_and_zero_pad": 2.384679180938474e-06, "add_observations_from_episodes_to_batch": 2.9647633367027226e-06, "add_states_from_episodes_to_batch": 1.6733405060640589e-06, "numpy_to_tensor": 8.475948578368285e-06, "batch_individual_items": 6.1973636057364996e-06}}, "connector_pipeline_timer": 4.325015511932436e-05}, "weights_seq_no": 19.0, "episode_len_min": 20, "num_agent_steps_sampled_lifetime": {"default_agent": -11105000.0}, "module_to_env_connector": {"connector_pipeline_timer": 0.00010321986019621035, "timers": {"connectors": {"tensor_to_numpy": 1.3043350891999209e-05, "listify_data_for_vector_env": 1.074102425668476e-05, "get_actions": 3.870934790533225e-05, "un_batch_to_individual_items": 5.32052802665261e-06, "normalize_and_clip_actions": 9.352939149138263e-06, "remove_single_ts_time_rank_from_batch": 5.963284299492666e-07}}}, "env_reset_timer": 3.2964731167362304e-05, "env_to_module_sum_episodes_length_out": 10.36823839457432, "env_to_module_sum_episodes_length_in": 10.36823839457432, "num_module_steps_sampled": {"default_policy": 5000.0}, "episode_return_mean": 6.5, "episode_len_max": 20, "num_env_steps_sampled": 5000.0, "num_episodes_lifetime": -555250.0, "agent_episode_returns_mean": {"default_agent": 6.5}, "episode_return_min": -11.5, "sample": 0.004833657066971592, "num_episodes": 250.0, "num_agent_steps_sampled": {"default_agent": 5000.0}, "rlmodule_inference_timer": 2.726352402856564e-05, "module_episode_returns_mean": {"default_policy": 6.5}, "episode_return_max": 8.5, "env_step_timer": 1.3662096791159932e-05, "time_between_sampling": 0.001859904564234931, "episode_duration_sec_mean": 0.00451073447242379, "num_env_steps_sampled_lifetime_throughput": 3773.206525562895}, "learners": {"__all_modules__": {"learner_connector": {"timers": {"connectors": {"numpy_to_tensor": 5.8958704089793664e-05, "add_observations_from_episodes_to_batch": 0.0008199659813715555, "add_one_ts_to_episodes_and_truncate": 0.008513562817882812, "add_states_from_episodes_to_batch": 2.8852201348725425e-06, "add_columns_from_episodes_to_train_batch": 0.03452900863613602, "add_time_dim_to_batch_and_zero_pad": 1.0153460757073004e-05, "general_advantage_estimation": 0.006222530164249386, "batch_individual_items": 0.036180132530794065}}, "connector_pipeline_timer": 0.08644874842254975}, "num_module_steps_trained": 6000, "num_trainable_parameters": 6003, "num_module_steps_trained_lifetime": 120000, "learner_connector_sum_episodes_length_out": 5250.0, "num_env_steps_trained_lifetime": 630000, "num_env_steps_trained": 31500, "learner_connector_sum_episodes_length_in": 5000.0, "num_non_trainable_parameters": 0, "num_env_steps_trained_lifetime_throughput": 2293142.6822109832, "num_module_steps_trained_throughput": 438137.0976411529, "num_module_steps_trained_lifetime_throughput": 437623.07840193436}, "default_policy": {"module_train_batch_size_mean": 1000.0, "entropy": 0.37009090185165405, "mean_kl_loss": 0.001483448431827128, "policy_loss": -0.0328749418258667, "default_optimizer_learning_rate": 0.0002847858517, "total_loss": 0.03251373767852783, "gradients_default_optimizer_global_norm": 0.04194527864456177, "diff_num_grad_updates_vs_sampler_policy": 1.0, "num_module_steps_trained": 6000, "num_trainable_parameters": 6003, "num_module_steps_trained_lifetime": 120000, "vf_loss_unclipped": 27.988771438598633, "vf_explained_var": 0.004387497901916504, "curr_entropy_coeff": 0.0090570820258, "curr_kl_coeff": 7.119143674572115e-07, "weights_seq_no": 20.0, "vf_loss": 0.10278083384037018, "num_module_steps_trained_lifetime_throughput": 438287.8066809311}}, "num_training_step_calls_per_iteration": 1, "evaluation": {"env_runners": {"env_to_module_connector": {"timers": {"connectors": {"add_time_dim_to_batch_and_zero_pad": 2.2197818988326373e-06, "batch_individual_items": 6.066368556610774e-06, "numpy_to_tensor": 8.276176970135825e-06, "add_observations_from_episodes_to_batch": 2.7472092393893547e-06, "add_states_from_episodes_to_batch": 1.619449235418506e-06}}, "connector_pipeline_timer": 4.216463298613749e-05}, "module_episode_returns_mean": {"default_policy": 0.0}, "num_module_steps_sampled_lifetime": {"default_policy": 8000}, "episode_return_mean": 0.0, "env_step_timer": 1.3678764669282165e-05, "num_module_steps_sampled": {"default_policy": 400}, "episode_len_mean": 20.0, "module_to_env_connector": {"timers": {"connectors": {"normalize_and_clip_actions": 9.292012819343694e-06, "listify_data_for_vector_env": 1.072196057669384e-05, "get_actions": 3.46086572416042e-05, "remove_single_ts_time_rank_from_batch": 5.769544222032616e-07, "tensor_to_numpy": 1.2715412143666076e-05, "un_batch_to_individual_items": 5.363951881641951e-06}}, "connector_pipeline_timer": 9.832100733509398e-05}, "num_env_steps_sampled": 400, "num_episodes_lifetime": 400, "sample": 0.09851665268970347, "episode_duration_sec_mean": 0.0045293020806275305, "num_env_steps_sampled_lifetime": 100400, "agent_episode_returns_mean": {"default_agent": 0.0}, "env_reset_timer": 0.00013494597844066432, "rlmodule_inference_timer": 2.710174763130996e-05, "num_agent_steps_sampled_lifetime": {"default_agent": 8000}, "episode_len_min": 20, "weights_seq_no": 20.0, "env_to_module_sum_episodes_length_out": 10.368238394574323, "num_agent_steps_sampled": {"default_agent": 400}, "env_to_module_sum_episodes_length_in": 10.368238394574323, "episode_len_max": 20, "episode_return_min": -14.5, "num_episodes": 20, "episode_return_max": 12.5, "time_between_sampling": 1.6033733836736992}, "num_healthy_workers": 1, "actor_manager_num_outstanding_async_reqs": 0, "num_remote_worker_restarts": 0}, "num_env_steps_sampled_lifetime": -11105000.0, "fault_tolerance": {"num_healthy_workers": 0, "num_remote_worker_restarts": 0}, "env_runner_group": {"actor_manager_num_outstanding_async_reqs": 0}, "done": true, "training_iteration": 20, "trial_id": "43aed_00000", "date": "2025-08-11_19-23-33", "timestamp": 1754933013, "time_this_iter_s": 1.5665767192840576, "time_total_s": 33.437753438949585, "pid": 14402, "hostname": "Mac", "node_ip": "127.0.0.1", "config": {"exploration_config": {}, "extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "placement_strategy": "PACK", "num_gpus": 0, "_fake_gpus": false, "num_cpus_for_main_process": 2, "eager_tracing": true, "eager_max_retraces": 20, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "torch_compile_learner": false, "torch_compile_learner_what_to_compile": "forward_train", "torch_compile_learner_dynamo_backend": "aot_eager", "torch_compile_learner_dynamo_mode": null, "torch_compile_worker": false, "torch_compile_worker_dynamo_backend": "aot_eager", "torch_compile_worker_dynamo_mode": null, "torch_ddp_kwargs": {}, "torch_skip_nan_gradients": false, "env": "Umbrella", "env_config": {}, "observation_space": null, "action_space": null, "clip_rewards": null, "normalize_actions": true, "clip_actions": false, "_is_atari": null, "disable_env_checking": false, "render_env": false, "action_mask_key": "action_mask", "env_runner_cls": null, "num_env_runners": 0, "create_local_env_runner": true, "num_envs_per_env_runner": 1, "gym_env_vectorize_mode": "SYNC", "num_cpus_per_env_runner": 1, "num_gpus_per_env_runner": 0, "custom_resources_per_env_runner": {}, "validate_env_runners_after_construction": true, "episodes_to_numpy": true, "max_requests_in_flight_per_env_runner": 1, "sample_timeout_s": 60.0, "_env_to_module_connector": null, "add_default_connectors_to_env_to_module_pipeline": true, "_module_to_env_connector": null, "add_default_connectors_to_module_to_env_pipeline": true, "merge_env_runner_states": "training_only", "broadcast_env_runner_states": true, "episode_lookback_horizon": 1, "rollout_fragment_length": "auto", "batch_mode": "complete_episodes", "compress_observations": false, "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "enable_tf1_exec_eagerly": false, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "preprocessor_pref": "deepmind", "observation_filter": "NoFilter", "update_worker_filter_stats": true, "use_worker_filter_stats": true, "sampler_perf_stats_ema_coef": null, "_is_online": true, "num_learners": 0, "num_gpus_per_learner": 0, "num_cpus_per_learner": "auto", "num_aggregator_actors_per_learner": 0, "max_requests_in_flight_per_aggregator_actor": 3, "local_gpu_idx": 0, "max_requests_in_flight_per_learner": 3, "gamma": 1, "lr": 0.0002847858517, "grad_clip": 0.5, "grad_clip_by": "global_norm", "_train_batch_size_per_learner": 5000, "train_batch_size": 4000, "num_epochs": 1, "minibatch_size": 1000, "shuffle_batch_per_epoch": true, "model": {"fcnet_hiddens": [256, 256], "fcnet_activation": "tanh", "fcnet_weights_initializer": null, "fcnet_weights_initializer_config": null, "fcnet_bias_initializer": null, "fcnet_bias_initializer_config": null, "conv_filters": null, "conv_activation": "relu", "conv_kernel_initializer": null, "conv_kernel_initializer_config": null, "conv_bias_initializer": null, "conv_bias_initializer_config": null, "conv_transpose_kernel_initializer": null, "conv_transpose_kernel_initializer_config": null, "conv_transpose_bias_initializer": null, "conv_transpose_bias_initializer_config": null, "post_fcnet_hiddens": [], "post_fcnet_activation": "relu", "post_fcnet_weights_initializer": null, "post_fcnet_weights_initializer_config": null, "post_fcnet_bias_initializer": null, "post_fcnet_bias_initializer_config": null, "free_log_std": false, "log_std_clip_param": 20.0, "no_final_linear": false, "vf_share_layers": false, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "lstm_weights_initializer": null, "lstm_weights_initializer_config": null, "lstm_bias_initializer": null, "lstm_bias_initializer_config": null, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "attention_use_n_prev_actions": 0, "attention_use_n_prev_rewards": 0, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": null, "custom_model_config": {}, "custom_action_dist": null, "custom_preprocessor": null, "encoder_latent_dim": null, "always_check_shapes": false, "lstm_use_prev_action_reward": -1, "_use_default_native_models": -1, "_disable_preprocessor_api": false, "_disable_action_flattening": false}, "_learner_connector": null, "add_default_connectors_to_learner_pipeline": true, "learner_config_dict": {}, "optimizer": {}, "_learner_class": null, "callbacks_on_algorithm_init": null, "callbacks_on_env_runners_recreated": null, "callbacks_on_offline_eval_runners_recreated": null, "callbacks_on_checkpoint_loaded": null, "callbacks_on_environment_created": null, "callbacks_on_episode_created": null, "callbacks_on_episode_start": null, "callbacks_on_episode_step": null, "callbacks_on_episode_end": null, "callbacks_on_evaluate_start": null, "callbacks_on_evaluate_end": null, "callbacks_on_evaluate_offline_start": null, "callbacks_on_evaluate_offline_end": null, "callbacks_on_sample_end": null, "callbacks_on_train_result": null, "explore": true, "enable_rl_module_and_learner": true, "enable_env_runner_and_connector_v2": true, "_prior_exploration_config": {"type": "StochasticSampling"}, "count_steps_by": "env_steps", "policy_map_capacity": 100, "policy_mapping_fn": "<function AlgorithmConfig.DEFAULT_POLICY_MAPPING_FN at 0x3881edb20>", "policies_to_train": null, "policy_states_are_swappable": false, "observation_fn": null, "offline_data_class": null, "input_read_method": "read_parquet", "input_read_method_kwargs": {}, "input_read_schema": {}, "input_read_episodes": false, "input_read_sample_batches": false, "input_read_batch_size": null, "input_filesystem": null, "input_filesystem_kwargs": {}, "input_compress_columns": ["obs", "new_obs"], "input_spaces_jsonable": true, "materialize_data": false, "materialize_mapped_data": true, "map_batches_kwargs": {}, "iter_batches_kwargs": {}, "ignore_final_observation": false, "prelearner_class": null, "prelearner_buffer_class": null, "prelearner_buffer_kwargs": {}, "prelearner_module_synch_period": 10, "dataset_num_iters_per_learner": null, "input_config": {}, "actions_in_input_normalized": false, "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_config": {}, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "output_max_rows_per_file": null, "output_write_remaining_data": false, "output_write_method": "write_parquet", "output_write_method_kwargs": {}, "output_filesystem": null, "output_filesystem_kwargs": {}, "output_write_episodes": true, "offline_sampling": false, "evaluation_interval": 1, "evaluation_duration": 20, "evaluation_duration_unit": "episodes", "evaluation_sample_timeout_s": 120.0, "evaluation_auto_duration_min_env_steps_per_sample": 100, "evaluation_auto_duration_max_env_steps_per_sample": 2000, "evaluation_parallel_to_training": false, "evaluation_force_reset_envs_before_iteration": true, "evaluation_config": null, "off_policy_estimation_methods": {}, "ope_split_batch_by_episode": true, "evaluation_num_env_runners": 1, "in_evaluation": false, "sync_filters_on_rollout_workers_timeout_s": 10.0, "offline_evaluation_interval": null, "num_offline_eval_runners": 0, "offline_loss_for_module_fn": null, "offline_evaluation_duration": 1, "offline_evaluation_parallel_to_training": false, "offline_evaluation_timeout_s": 120.0, "num_cpus_per_offline_eval_runner": 1, "num_gpus_per_offline_eval_runner": 0, "custom_resources_per_offline_eval_runner": {}, "restart_failed_offline_eval_runners": true, "ignore_offline_eval_runner_failures": false, "max_num_offline_eval_runner_restarts": 1000, "offline_eval_runner_restore_timeout_s": 1800.0, "max_requests_in_flight_per_offline_eval_runner": 1, "validate_offline_eval_runners_after_construction": true, "offline_eval_runner_health_probe_timeout_s": 30.0, "offline_eval_rl_module_inference_only": false, "broadcast_offline_eval_runner_states": false, "offline_eval_batch_size_per_runner": 256, "dataset_num_iters_per_eval_runner": 1, "keep_per_episode_custom_metrics": false, "metrics_episode_collection_timeout_s": 60.0, "metrics_num_episodes_for_smoothing": 100, "min_time_s_per_iteration": null, "min_train_timesteps_per_iteration": 0, "min_sample_timesteps_per_iteration": 0, "log_gradients": true, "export_native_model_files": false, "checkpoint_trainable_policies_only": false, "logger_creator": null, "logger_config": null, "log_level": "WARN", "log_sys_usage": true, "fake_sampler": false, "seed": 2, "restart_failed_env_runners": true, "ignore_env_runner_failures": false, "max_num_env_runner_restarts": 1000, "delay_between_env_runner_restarts_s": 60.0, "restart_failed_sub_environments": false, "num_consecutive_env_runner_failures_tolerance": 100, "env_runner_health_probe_timeout_s": 30.0, "env_runner_restore_timeout_s": 1800.0, "_model_config": {}, "_rl_module_spec": "RLModuleSpec(module_class=None, observation_space=None, action_space=None, inference_only=False, learner_only=False, model_config=DefaultModelConfig(fcnet_hiddens=[60, 90], fcnet_activation='tanh', fcnet_kernel_initializer=None, fcnet_kernel_initializer_kwargs=None, fcnet_bias_initializer=None, fcnet_bias_initializer_kwargs=None, conv_filters=None, conv_activation='relu', conv_kernel_initializer=None, conv_kernel_initializer_kwargs=None, conv_bias_initializer=None, conv_bias_initializer_kwargs=None, head_fcnet_hiddens=[], head_fcnet_activation='relu', head_fcnet_kernel_initializer=None, head_fcnet_kernel_initializer_kwargs=None, head_fcnet_bias_initializer=None, head_fcnet_bias_initializer_kwargs=None, free_log_std=False, log_std_clip_param=20.0, vf_share_layers=True, use_lstm=False, max_seq_len=20, lstm_cell_size=256, lstm_use_prev_action=False, lstm_use_prev_reward=False, lstm_kernel_initializer=None, lstm_kernel_initializer_kwargs=None, lstm_bias_initializer=None, lstm_bias_initializer_kwargs=None), catalog_class=None, load_state_path=None, model_config_dict=None)", "algorithm_config_overrides_per_module": {}, "_per_module_overrides": {}, "_validate_config": true, "_use_msgpack_checkpoints": false, "_torch_grad_scaler_class": null, "_torch_lr_scheduler_classes": null, "_tf_policy_handles_more_than_one_loss": false, "_disable_preprocessor_api": false, "_disable_action_flattening": false, "_disable_initialize_loss_from_dummy_batch": false, "_dont_auto_sync_env_runner_states": false, "env_task_fn": -1, "enable_connectors": -1, "simple_optimizer": false, "policy_map_cache": -1, "worker_cls": -1, "synchronize_filters": -1, "enable_async_evaluation": -1, "custom_async_evaluation_function": -1, "_enable_rl_module_api": -1, "auto_wrap_old_gym_envs": -1, "always_attach_evaluation_results": -1, "replay_sequence_length": null, "_disable_execution_plan_api": -1, "use_critic": true, "use_gae": true, "use_kl_loss": true, "kl_coeff": 0.7464963036515, "kl_target": 0.0270990929592, "vf_loss_coeff": 0.6688075857018, "entropy_coeff": 0.0090570820258, "clip_param": 0.1221781641624, "vf_clip_param": 0.1027808522125, "entropy_coeff_schedule": null, "lr_schedule": null, "sgd_minibatch_size": -1, "vf_share_layers": -1, "__stdout_file__": null, "__stderr_file__": null, "lambda": 0.9099046732075, "input": "sampler", "policies": {"default_policy": [null, null, null, null]}, "callbacks": "<class 'ray.rllib.callbacks.callbacks.RLlibCallback'>", "create_env_on_driver": false, "custom_eval_function": null, "framework": "torch"}, "time_since_restore": 33.437753438949585, "iterations_since_restore": 20, "perf": {"cpu_util_percent": 36.0, "ram_util_percent": 77.6}}
