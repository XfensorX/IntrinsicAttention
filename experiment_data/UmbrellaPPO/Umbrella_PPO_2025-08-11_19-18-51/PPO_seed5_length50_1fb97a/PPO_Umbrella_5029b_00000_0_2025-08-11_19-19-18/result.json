{"timers": {"training_iteration": 1.8007286669453606, "restore_env_runners": 3.9375037886202335e-05, "training_step": 1.8003631660249084, "env_runner_sampling_timer": 1.685580666991882, "learner_update_timer": 0.11139341699890792, "synch_weights": 0.000665290979668498}, "env_runners": {"env_to_module_sum_episodes_length_in": 10.191744832559449, "episode_return_min": -13.5, "module_to_env_connector": {"timers": {"connectors": {"get_actions": 5.482736940898346e-05, "un_batch_to_individual_items": 6.336212376932408e-06, "tensor_to_numpy": 1.637256051770704e-05, "normalize_and_clip_actions": 1.5327927022687605e-05, "remove_single_ts_time_rank_from_batch": 6.69133256470183e-07, "listify_data_for_vector_env": 1.2896514511602106e-05}}, "connector_pipeline_timer": 0.00013486089967833765}, "env_reset_timer": 0.00016335571737237768, "env_to_module_connector": {"timers": {"connectors": {"numpy_to_tensor": 1.0585700679324064e-05, "batch_individual_items": 7.72061600841611e-06, "add_states_from_episodes_to_batch": 1.9201414441670116e-06, "add_time_dim_to_batch_and_zero_pad": 2.940190516028085e-06, "add_observations_from_episodes_to_batch": 3.666415004256741e-06}}, "connector_pipeline_timer": 5.262573934350258e-05}, "num_agent_steps_sampled_lifetime": {"default_agent": 627500.0}, "agent_episode_returns_mean": {"default_agent": -3.7400000000000015}, "num_episodes": 250.0, "num_env_steps_sampled_lifetime": 627500.0, "episode_len_max": 20, "rlmodule_inference_timer": 5.776176632204342e-05, "weights_seq_no": 0.0, "episode_len_min": 20, "num_env_steps_sampled": 5000.0, "time_between_sampling": 0.0006274609329071161, "episode_len_mean": 20.0, "episode_duration_sec_mean": 0.005637999195139854, "env_step_timer": 1.769384553400309e-05, "num_agent_steps_sampled": {"default_agent": 5000.0}, "num_episodes_lifetime": 31375.0, "module_episode_returns_mean": {"default_policy": -3.7400000000000015}, "num_module_steps_sampled": {"default_policy": 5000.0}, "episode_return_max": 6.5, "sample": 0.007120432357398897, "episode_return_mean": -3.7400000000000015, "env_to_module_sum_episodes_length_out": 10.191744832559449, "num_module_steps_sampled_lifetime": {"default_policy": 627500.0}, "num_env_steps_sampled_lifetime_throughput": 3047.7562265665083}, "learners": {"default_policy": {"num_trainable_parameters": 6003, "diff_num_grad_updates_vs_sampler_policy": 1.0, "gradients_default_optimizer_global_norm": 0.11001160740852356, "default_optimizer_learning_rate": 0.0002847858517, "module_train_batch_size_mean": 1000.0, "vf_loss_unclipped": 31.674436569213867, "curr_entropy_coeff": 0.0090570820258, "num_module_steps_trained": 6000, "total_loss": 0.12488927692174911, "vf_explained_var": -0.009245157241821289, "num_module_steps_trained_lifetime": 6000, "curr_kl_coeff": 0.3732481598854065, "policy_loss": 0.061082545667886734, "mean_kl_loss": 0.0017906971042975783, "entropy": 0.6923456788063049, "vf_loss": 0.10278083384037018, "weights_seq_no": 1.0, "num_module_steps_trained_lifetime_throughput": 347187.0659706999}, "__all_modules__": {"learner_connector": {"timers": {"connectors": {"add_observations_from_episodes_to_batch": 0.000870457966811955, "general_advantage_estimation": 0.0068521249340847135, "batch_individual_items": 0.03082962497137487, "numpy_to_tensor": 8.054205682128668e-05, "add_one_ts_to_episodes_and_truncate": 0.008188500069081783, "add_time_dim_to_batch_and_zero_pad": 1.2082979083061218e-05, "add_columns_from_episodes_to_train_batch": 0.034235082915984094, "add_states_from_episodes_to_batch": 4.332978278398514e-06}}, "connector_pipeline_timer": 0.08122724993154407}, "learner_connector_sum_episodes_length_in": 5000, "num_trainable_parameters": 6003, "num_env_steps_trained": 31500, "num_module_steps_trained": 6000, "learner_connector_sum_episodes_length_out": 5250, "num_non_trainable_parameters": 0, "num_module_steps_trained_lifetime": 6000, "num_env_steps_trained_lifetime": 31500, "num_env_steps_trained_lifetime_throughput": 1811513.1081990206, "num_module_steps_trained_throughput": 346462.252677197, "num_module_steps_trained_lifetime_throughput": 345917.0998165277}}, "num_training_step_calls_per_iteration": 1, "num_env_steps_sampled_lifetime": 627500.0, "evaluation": {"env_runners": {"num_agent_steps_sampled_lifetime": {"default_agent": 400}, "env_to_module_sum_episodes_length_in": 10.216013141322508, "agent_episode_returns_mean": {"default_agent": 4.7}, "env_to_module_connector": {"timers": {"connectors": {"add_observations_from_episodes_to_batch": 3.6959336658096653e-06, "batch_individual_items": 7.087108215795488e-06, "numpy_to_tensor": 1.0019327614133559e-05, "add_time_dim_to_batch_and_zero_pad": 3.0101966835931593e-06, "add_states_from_episodes_to_batch": 1.7197724444185035e-06}}, "connector_pipeline_timer": 5.2687858645257704e-05}, "module_to_env_connector": {"connector_pipeline_timer": 0.00015193397831613387, "timers": {"connectors": {"remove_single_ts_time_rank_from_batch": 7.227587399528924e-07, "listify_data_for_vector_env": 1.2764580804580642e-05, "tensor_to_numpy": 1.9112272144170246e-05, "normalize_and_clip_actions": 1.3217796286589908e-05, "un_batch_to_individual_items": 6.099810539882515e-06, "get_actions": 6.340464865984785e-05}}}, "episode_duration_sec_mean": 0.005465681466739624, "sample": 0.12621358293108642, "num_episodes": 20, "episode_len_min": 20, "num_module_steps_sampled": {"default_policy": 400}, "num_env_steps_sampled": 400, "num_episodes_lifetime": 20, "env_to_module_sum_episodes_length_out": 10.216013141322508, "episode_return_min": -15.5, "module_episode_returns_mean": {"default_policy": 4.7}, "num_env_steps_sampled_lifetime": 5400, "rlmodule_inference_timer": 3.8498161394109546e-05, "weights_seq_no": 1.0, "num_module_steps_sampled_lifetime": {"default_policy": 400}, "env_step_timer": 1.7769005017480313e-05, "episode_return_max": 13.5, "episode_return_mean": 4.7, "env_reset_timer": 0.0026177919935435057, "episode_len_max": 20, "num_agent_steps_sampled": {"default_agent": 400}, "episode_len_mean": 20.0}, "num_healthy_workers": 1, "actor_manager_num_outstanding_async_reqs": 0, "num_remote_worker_restarts": 0}, "fault_tolerance": {"num_healthy_workers": 0, "num_remote_worker_restarts": 0}, "env_runner_group": {"actor_manager_num_outstanding_async_reqs": 0}, "done": false, "training_iteration": 1, "trial_id": "5029b_00000", "date": "2025-08-11_19-21-37", "timestamp": 1754932897, "time_this_iter_s": 1.943176031112671, "time_total_s": 1.943176031112671, "pid": 14328, "hostname": "Mac", "node_ip": "127.0.0.1", "config": {"exploration_config": {}, "extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "placement_strategy": "PACK", "num_gpus": 0, "_fake_gpus": false, "num_cpus_for_main_process": 2, "eager_tracing": true, "eager_max_retraces": 20, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "torch_compile_learner": false, "torch_compile_learner_what_to_compile": "forward_train", "torch_compile_learner_dynamo_backend": "aot_eager", "torch_compile_learner_dynamo_mode": null, "torch_compile_worker": false, "torch_compile_worker_dynamo_backend": "aot_eager", "torch_compile_worker_dynamo_mode": null, "torch_ddp_kwargs": {}, "torch_skip_nan_gradients": false, "env": "Umbrella", "env_config": {}, "observation_space": null, "action_space": null, "clip_rewards": null, "normalize_actions": true, "clip_actions": false, "_is_atari": null, "disable_env_checking": false, "render_env": false, "action_mask_key": "action_mask", "env_runner_cls": null, "num_env_runners": 0, "create_local_env_runner": true, "num_envs_per_env_runner": 1, "gym_env_vectorize_mode": "SYNC", "num_cpus_per_env_runner": 1, "num_gpus_per_env_runner": 0, "custom_resources_per_env_runner": {}, "validate_env_runners_after_construction": true, "episodes_to_numpy": true, "max_requests_in_flight_per_env_runner": 1, "sample_timeout_s": 60.0, "_env_to_module_connector": null, "add_default_connectors_to_env_to_module_pipeline": true, "_module_to_env_connector": null, "add_default_connectors_to_module_to_env_pipeline": true, "merge_env_runner_states": "training_only", "broadcast_env_runner_states": true, "episode_lookback_horizon": 1, "rollout_fragment_length": "auto", "batch_mode": "complete_episodes", "compress_observations": false, "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "enable_tf1_exec_eagerly": false, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "preprocessor_pref": "deepmind", "observation_filter": "NoFilter", "update_worker_filter_stats": true, "use_worker_filter_stats": true, "sampler_perf_stats_ema_coef": null, "_is_online": true, "num_learners": 0, "num_gpus_per_learner": 0, "num_cpus_per_learner": "auto", "num_aggregator_actors_per_learner": 0, "max_requests_in_flight_per_aggregator_actor": 3, "local_gpu_idx": 0, "max_requests_in_flight_per_learner": 3, "gamma": 1, "lr": 0.0002847858517, "grad_clip": 0.5, "grad_clip_by": "global_norm", "_train_batch_size_per_learner": 5000, "train_batch_size": 4000, "num_epochs": 1, "minibatch_size": 1000, "shuffle_batch_per_epoch": true, "model": {"fcnet_hiddens": [256, 256], "fcnet_activation": "tanh", "fcnet_weights_initializer": null, "fcnet_weights_initializer_config": null, "fcnet_bias_initializer": null, "fcnet_bias_initializer_config": null, "conv_filters": null, "conv_activation": "relu", "conv_kernel_initializer": null, "conv_kernel_initializer_config": null, "conv_bias_initializer": null, "conv_bias_initializer_config": null, "conv_transpose_kernel_initializer": null, "conv_transpose_kernel_initializer_config": null, "conv_transpose_bias_initializer": null, "conv_transpose_bias_initializer_config": null, "post_fcnet_hiddens": [], "post_fcnet_activation": "relu", "post_fcnet_weights_initializer": null, "post_fcnet_weights_initializer_config": null, "post_fcnet_bias_initializer": null, "post_fcnet_bias_initializer_config": null, "free_log_std": false, "log_std_clip_param": 20.0, "no_final_linear": false, "vf_share_layers": false, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "lstm_weights_initializer": null, "lstm_weights_initializer_config": null, "lstm_bias_initializer": null, "lstm_bias_initializer_config": null, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "attention_use_n_prev_actions": 0, "attention_use_n_prev_rewards": 0, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": null, "custom_model_config": {}, "custom_action_dist": null, "custom_preprocessor": null, "encoder_latent_dim": null, "always_check_shapes": false, "lstm_use_prev_action_reward": -1, "_use_default_native_models": -1, "_disable_preprocessor_api": false, "_disable_action_flattening": false}, "_learner_connector": null, "add_default_connectors_to_learner_pipeline": true, "learner_config_dict": {}, "optimizer": {}, "_learner_class": null, "callbacks_on_algorithm_init": null, "callbacks_on_env_runners_recreated": null, "callbacks_on_offline_eval_runners_recreated": null, "callbacks_on_checkpoint_loaded": null, "callbacks_on_environment_created": null, "callbacks_on_episode_created": null, "callbacks_on_episode_start": null, "callbacks_on_episode_step": null, "callbacks_on_episode_end": null, "callbacks_on_evaluate_start": null, "callbacks_on_evaluate_end": null, "callbacks_on_evaluate_offline_start": null, "callbacks_on_evaluate_offline_end": null, "callbacks_on_sample_end": null, "callbacks_on_train_result": null, "explore": true, "enable_rl_module_and_learner": true, "enable_env_runner_and_connector_v2": true, "_prior_exploration_config": {"type": "StochasticSampling"}, "count_steps_by": "env_steps", "policy_map_capacity": 100, "policy_mapping_fn": "<function AlgorithmConfig.DEFAULT_POLICY_MAPPING_FN at 0x157405b20>", "policies_to_train": null, "policy_states_are_swappable": false, "observation_fn": null, "offline_data_class": null, "input_read_method": "read_parquet", "input_read_method_kwargs": {}, "input_read_schema": {}, "input_read_episodes": false, "input_read_sample_batches": false, "input_read_batch_size": null, "input_filesystem": null, "input_filesystem_kwargs": {}, "input_compress_columns": ["obs", "new_obs"], "input_spaces_jsonable": true, "materialize_data": false, "materialize_mapped_data": true, "map_batches_kwargs": {}, "iter_batches_kwargs": {}, "ignore_final_observation": false, "prelearner_class": null, "prelearner_buffer_class": null, "prelearner_buffer_kwargs": {}, "prelearner_module_synch_period": 10, "dataset_num_iters_per_learner": null, "input_config": {}, "actions_in_input_normalized": false, "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_config": {}, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "output_max_rows_per_file": null, "output_write_remaining_data": false, "output_write_method": "write_parquet", "output_write_method_kwargs": {}, "output_filesystem": null, "output_filesystem_kwargs": {}, "output_write_episodes": true, "offline_sampling": false, "evaluation_interval": 1, "evaluation_duration": 20, "evaluation_duration_unit": "episodes", "evaluation_sample_timeout_s": 120.0, "evaluation_auto_duration_min_env_steps_per_sample": 100, "evaluation_auto_duration_max_env_steps_per_sample": 2000, "evaluation_parallel_to_training": false, "evaluation_force_reset_envs_before_iteration": true, "evaluation_config": null, "off_policy_estimation_methods": {}, "ope_split_batch_by_episode": true, "evaluation_num_env_runners": 1, "in_evaluation": false, "sync_filters_on_rollout_workers_timeout_s": 10.0, "offline_evaluation_interval": null, "num_offline_eval_runners": 0, "offline_loss_for_module_fn": null, "offline_evaluation_duration": 1, "offline_evaluation_parallel_to_training": false, "offline_evaluation_timeout_s": 120.0, "num_cpus_per_offline_eval_runner": 1, "num_gpus_per_offline_eval_runner": 0, "custom_resources_per_offline_eval_runner": {}, "restart_failed_offline_eval_runners": true, "ignore_offline_eval_runner_failures": false, "max_num_offline_eval_runner_restarts": 1000, "offline_eval_runner_restore_timeout_s": 1800.0, "max_requests_in_flight_per_offline_eval_runner": 1, "validate_offline_eval_runners_after_construction": true, "offline_eval_runner_health_probe_timeout_s": 30.0, "offline_eval_rl_module_inference_only": false, "broadcast_offline_eval_runner_states": false, "offline_eval_batch_size_per_runner": 256, "dataset_num_iters_per_eval_runner": 1, "keep_per_episode_custom_metrics": false, "metrics_episode_collection_timeout_s": 60.0, "metrics_num_episodes_for_smoothing": 100, "min_time_s_per_iteration": null, "min_train_timesteps_per_iteration": 0, "min_sample_timesteps_per_iteration": 0, "log_gradients": true, "export_native_model_files": false, "checkpoint_trainable_policies_only": false, "logger_creator": null, "logger_config": null, "log_level": "WARN", "log_sys_usage": true, "fake_sampler": false, "seed": 5, "restart_failed_env_runners": true, "ignore_env_runner_failures": false, "max_num_env_runner_restarts": 1000, "delay_between_env_runner_restarts_s": 60.0, "restart_failed_sub_environments": false, "num_consecutive_env_runner_failures_tolerance": 100, "env_runner_health_probe_timeout_s": 30.0, "env_runner_restore_timeout_s": 1800.0, "_model_config": {}, "_rl_module_spec": "RLModuleSpec(module_class=None, observation_space=None, action_space=None, inference_only=False, learner_only=False, model_config=DefaultModelConfig(fcnet_hiddens=[60, 90], fcnet_activation='tanh', fcnet_kernel_initializer=None, fcnet_kernel_initializer_kwargs=None, fcnet_bias_initializer=None, fcnet_bias_initializer_kwargs=None, conv_filters=None, conv_activation='relu', conv_kernel_initializer=None, conv_kernel_initializer_kwargs=None, conv_bias_initializer=None, conv_bias_initializer_kwargs=None, head_fcnet_hiddens=[], head_fcnet_activation='relu', head_fcnet_kernel_initializer=None, head_fcnet_kernel_initializer_kwargs=None, head_fcnet_bias_initializer=None, head_fcnet_bias_initializer_kwargs=None, free_log_std=False, log_std_clip_param=20.0, vf_share_layers=True, use_lstm=False, max_seq_len=20, lstm_cell_size=256, lstm_use_prev_action=False, lstm_use_prev_reward=False, lstm_kernel_initializer=None, lstm_kernel_initializer_kwargs=None, lstm_bias_initializer=None, lstm_bias_initializer_kwargs=None), catalog_class=None, load_state_path=None, model_config_dict=None)", "algorithm_config_overrides_per_module": {}, "_per_module_overrides": {}, "_validate_config": true, "_use_msgpack_checkpoints": false, "_torch_grad_scaler_class": null, "_torch_lr_scheduler_classes": null, "_tf_policy_handles_more_than_one_loss": false, "_disable_preprocessor_api": false, "_disable_action_flattening": false, "_disable_initialize_loss_from_dummy_batch": false, "_dont_auto_sync_env_runner_states": false, "env_task_fn": -1, "enable_connectors": -1, "simple_optimizer": false, "policy_map_cache": -1, "worker_cls": -1, "synchronize_filters": -1, "enable_async_evaluation": -1, "custom_async_evaluation_function": -1, "_enable_rl_module_api": -1, "auto_wrap_old_gym_envs": -1, "always_attach_evaluation_results": -1, "replay_sequence_length": null, "_disable_execution_plan_api": -1, "use_critic": true, "use_gae": true, "use_kl_loss": true, "kl_coeff": 0.7464963036515, "kl_target": 0.0270990929592, "vf_loss_coeff": 0.6688075857018, "entropy_coeff": 0.0090570820258, "clip_param": 0.1221781641624, "vf_clip_param": 0.1027808522125, "entropy_coeff_schedule": null, "lr_schedule": null, "sgd_minibatch_size": -1, "vf_share_layers": -1, "__stdout_file__": null, "__stderr_file__": null, "lambda": 0.9099046732075, "input": "sampler", "policies": {"default_policy": [null, null, null, null]}, "callbacks": "<class 'ray.rllib.callbacks.callbacks.RLlibCallback'>", "create_env_on_driver": false, "custom_eval_function": null, "framework": "torch"}, "time_since_restore": 1.943176031112671, "iterations_since_restore": 1, "perf": {"cpu_util_percent": 21.7, "ram_util_percent": 83.73333333333333}}
{"timers": {"training_iteration": 1.7996643706958275, "restore_env_runners": 3.905169782228768e-05, "training_step": 1.799300576444948, "env_runner_sampling_timer": 1.683680646162247, "learner_update_timer": 0.11223293741815724, "synch_weights": 0.0006656534795183689, "restore_eval_env_runners": 1.029099803417921e-05, "evaluation_iteration": 0.14067179104313254, "synch_eval_env_connectors": 0.00014758296310901642, "synch_env_connectors": 4.832982085645199e-06}, "env_runners": {"env_to_module_sum_episodes_length_in": 10.36823839457432, "episode_return_min": -13.5, "module_to_env_connector": {"timers": {"connectors": {"get_actions": 4.461280837390494e-05, "un_batch_to_individual_items": 5.632931081380832e-06, "tensor_to_numpy": 1.4296068934509708e-05, "normalize_and_clip_actions": 1.0426840612582894e-05, "remove_single_ts_time_rank_from_batch": 6.319532592240257e-07, "listify_data_for_vector_env": 1.1529187474465452e-05}}, "connector_pipeline_timer": 0.00011367552878746626}, "env_reset_timer": 5.0115720911213596e-05, "env_to_module_connector": {"timers": {"connectors": {"numpy_to_tensor": 1.0565144194925824e-05, "batch_individual_items": 6.701876446640885e-06, "add_states_from_episodes_to_batch": 1.7860454360691295e-06, "add_time_dim_to_batch_and_zero_pad": 2.4705548849520273e-06, "add_observations_from_episodes_to_batch": 3.1560735255693194e-06}}, "connector_pipeline_timer": 4.778513113406555e-05}, "num_agent_steps_sampled_lifetime": {"default_agent": 10000.0}, "agent_episode_returns_mean": {"default_agent": -3.8199999999999994}, "num_episodes": 250.0, "num_env_steps_sampled_lifetime": 10000.0, "episode_len_max": 20, "rlmodule_inference_timer": 3.119953018047347e-05, "weights_seq_no": 1.0, "episode_len_min": 20, "num_env_steps_sampled": 5000.0, "time_between_sampling": 0.001754847387676829, "episode_len_mean": 20.0, "episode_duration_sec_mean": 0.004954179802443831, "env_step_timer": 1.4788958984847988e-05, "num_agent_steps_sampled": {"default_agent": 5000.0}, "num_episodes_lifetime": 500.0, "module_episode_returns_mean": {"default_policy": -3.8199999999999994}, "num_module_steps_sampled": {"default_policy": 5000.0}, "episode_return_max": 6.5, "sample": 0.005699142710299378, "episode_return_mean": -3.8199999999999994, "env_to_module_sum_episodes_length_out": 10.36823839457432, "num_module_steps_sampled_lifetime": {"default_policy": 10000.0}, "num_env_steps_sampled_lifetime_throughput": 3576.063918914889}, "learners": {"default_policy": {"num_trainable_parameters": 6003, "diff_num_grad_updates_vs_sampler_policy": 1.0, "gradients_default_optimizer_global_norm": 0.14527708292007446, "default_optimizer_learning_rate": 0.0002847858517, "module_train_batch_size_mean": 1000.0, "vf_loss_unclipped": 29.594585418701172, "curr_entropy_coeff": 0.0090570820258, "num_module_steps_trained": 6000, "total_loss": -0.06935101747512817, "vf_explained_var": -0.011589646339416504, "num_module_steps_trained_lifetime": 12000, "curr_kl_coeff": 0.18662407994270325, "policy_loss": -0.13185341656208038, "mean_kl_loss": 7.931759319035336e-05, "entropy": 0.6920329928398132, "vf_loss": 0.10278083384037018, "weights_seq_no": 2.0, "num_module_steps_trained_lifetime_throughput": 347233.4291714668}, "__all_modules__": {"learner_connector": {"timers": {"connectors": {"add_observations_from_episodes_to_batch": 0.0008703979675192385, "general_advantage_estimation": 0.006839771604863927, "batch_individual_items": 0.03179928247234784, "numpy_to_tensor": 8.042704663239419e-05, "add_one_ts_to_episodes_and_truncate": 0.008190157148055733, "add_time_dim_to_batch_and_zero_pad": 1.2094229459762573e-05, "add_columns_from_episodes_to_train_batch": 0.034249621666967864, "add_states_from_episodes_to_batch": 4.3271481990814215e-06}}, "connector_pipeline_timer": 0.08220015452243389}, "learner_connector_sum_episodes_length_in": 5000.0, "num_trainable_parameters": 6003, "num_env_steps_trained": 31500, "num_module_steps_trained": 6000, "learner_connector_sum_episodes_length_out": 5250.0, "num_non_trainable_parameters": 0, "num_module_steps_trained_lifetime": 12000, "num_env_steps_trained_lifetime": 63000, "num_env_steps_trained_lifetime_throughput": 1811927.8409674533, "num_module_steps_trained_throughput": 346523.94233287, "num_module_steps_trained_lifetime_throughput": 345984.89821134496}}, "num_training_step_calls_per_iteration": 1, "evaluation": {"env_runners": {"num_agent_steps_sampled_lifetime": {"default_agent": 800}, "env_to_module_sum_episodes_length_in": 10.366003441359926, "agent_episode_returns_mean": {"default_agent": 2.7}, "env_to_module_connector": {"timers": {"connectors": {"add_observations_from_episodes_to_batch": 2.853533951179483e-06, "batch_individual_items": 6.28714357417553e-06, "numpy_to_tensor": 8.520351540849578e-06, "add_time_dim_to_batch_and_zero_pad": 2.3670152023356095e-06, "add_states_from_episodes_to_batch": 1.606365911790812e-06}}, "connector_pipeline_timer": 4.3785025524496994e-05}, "module_to_env_connector": {"connector_pipeline_timer": 0.00011330633261205472, "timers": {"connectors": {"remove_single_ts_time_rank_from_batch": 6.011686140154043e-07, "listify_data_for_vector_env": 1.1499200134873022e-05, "tensor_to_numpy": 1.3611017427166366e-05, "normalize_and_clip_actions": 9.751214738409209e-06, "un_batch_to_individual_items": 5.500040716304082e-06, "get_actions": 4.563532261227817e-05}}}, "episode_duration_sec_mean": 0.005063415772747248, "sample": 0.12596682419185526, "num_episodes": 20, "episode_len_min": 20, "num_module_steps_sampled": {"default_policy": 400}, "num_env_steps_sampled": 400, "num_episodes_lifetime": 40, "env_to_module_sum_episodes_length_out": 10.366003441359926, "episode_return_min": -15.5, "module_episode_returns_mean": {"default_policy": 2.7}, "num_env_steps_sampled_lifetime": 10400, "rlmodule_inference_timer": 2.8091809769741014e-05, "weights_seq_no": 2.0, "num_module_steps_sampled_lifetime": {"default_policy": 800}, "env_step_timer": 1.458222588656906e-05, "episode_return_max": 13.5, "episode_return_mean": 2.7, "env_reset_timer": 0.0025923894834704695, "episode_len_max": 20, "num_agent_steps_sampled": {"default_agent": 400}, "episode_len_mean": 20.0, "time_between_sampling": 1.7497455830452964}, "num_healthy_workers": 1, "actor_manager_num_outstanding_async_reqs": 0, "num_remote_worker_restarts": 0}, "num_env_steps_sampled_lifetime": 10000.0, "fault_tolerance": {"num_healthy_workers": 0, "num_remote_worker_restarts": 0}, "env_runner_group": {"actor_manager_num_outstanding_async_reqs": 0}, "done": false, "training_iteration": 2, "trial_id": "5029b_00000", "date": "2025-08-11_19-21-39", "timestamp": 1754932899, "time_this_iter_s": 1.8029937744140625, "time_total_s": 3.7461698055267334, "pid": 14328, "hostname": "Mac", "node_ip": "127.0.0.1", "config": {"exploration_config": {}, "extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "placement_strategy": "PACK", "num_gpus": 0, "_fake_gpus": false, "num_cpus_for_main_process": 2, "eager_tracing": true, "eager_max_retraces": 20, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "torch_compile_learner": false, "torch_compile_learner_what_to_compile": "forward_train", "torch_compile_learner_dynamo_backend": "aot_eager", "torch_compile_learner_dynamo_mode": null, "torch_compile_worker": false, "torch_compile_worker_dynamo_backend": "aot_eager", "torch_compile_worker_dynamo_mode": null, "torch_ddp_kwargs": {}, "torch_skip_nan_gradients": false, "env": "Umbrella", "env_config": {}, "observation_space": null, "action_space": null, "clip_rewards": null, "normalize_actions": true, "clip_actions": false, "_is_atari": null, "disable_env_checking": false, "render_env": false, "action_mask_key": "action_mask", "env_runner_cls": null, "num_env_runners": 0, "create_local_env_runner": true, "num_envs_per_env_runner": 1, "gym_env_vectorize_mode": "SYNC", "num_cpus_per_env_runner": 1, "num_gpus_per_env_runner": 0, "custom_resources_per_env_runner": {}, "validate_env_runners_after_construction": true, "episodes_to_numpy": true, "max_requests_in_flight_per_env_runner": 1, "sample_timeout_s": 60.0, "_env_to_module_connector": null, "add_default_connectors_to_env_to_module_pipeline": true, "_module_to_env_connector": null, "add_default_connectors_to_module_to_env_pipeline": true, "merge_env_runner_states": "training_only", "broadcast_env_runner_states": true, "episode_lookback_horizon": 1, "rollout_fragment_length": "auto", "batch_mode": "complete_episodes", "compress_observations": false, "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "enable_tf1_exec_eagerly": false, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "preprocessor_pref": "deepmind", "observation_filter": "NoFilter", "update_worker_filter_stats": true, "use_worker_filter_stats": true, "sampler_perf_stats_ema_coef": null, "_is_online": true, "num_learners": 0, "num_gpus_per_learner": 0, "num_cpus_per_learner": "auto", "num_aggregator_actors_per_learner": 0, "max_requests_in_flight_per_aggregator_actor": 3, "local_gpu_idx": 0, "max_requests_in_flight_per_learner": 3, "gamma": 1, "lr": 0.0002847858517, "grad_clip": 0.5, "grad_clip_by": "global_norm", "_train_batch_size_per_learner": 5000, "train_batch_size": 4000, "num_epochs": 1, "minibatch_size": 1000, "shuffle_batch_per_epoch": true, "model": {"fcnet_hiddens": [256, 256], "fcnet_activation": "tanh", "fcnet_weights_initializer": null, "fcnet_weights_initializer_config": null, "fcnet_bias_initializer": null, "fcnet_bias_initializer_config": null, "conv_filters": null, "conv_activation": "relu", "conv_kernel_initializer": null, "conv_kernel_initializer_config": null, "conv_bias_initializer": null, "conv_bias_initializer_config": null, "conv_transpose_kernel_initializer": null, "conv_transpose_kernel_initializer_config": null, "conv_transpose_bias_initializer": null, "conv_transpose_bias_initializer_config": null, "post_fcnet_hiddens": [], "post_fcnet_activation": "relu", "post_fcnet_weights_initializer": null, "post_fcnet_weights_initializer_config": null, "post_fcnet_bias_initializer": null, "post_fcnet_bias_initializer_config": null, "free_log_std": false, "log_std_clip_param": 20.0, "no_final_linear": false, "vf_share_layers": false, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "lstm_weights_initializer": null, "lstm_weights_initializer_config": null, "lstm_bias_initializer": null, "lstm_bias_initializer_config": null, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "attention_use_n_prev_actions": 0, "attention_use_n_prev_rewards": 0, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": null, "custom_model_config": {}, "custom_action_dist": null, "custom_preprocessor": null, "encoder_latent_dim": null, "always_check_shapes": false, "lstm_use_prev_action_reward": -1, "_use_default_native_models": -1, "_disable_preprocessor_api": false, "_disable_action_flattening": false}, "_learner_connector": null, "add_default_connectors_to_learner_pipeline": true, "learner_config_dict": {}, "optimizer": {}, "_learner_class": null, "callbacks_on_algorithm_init": null, "callbacks_on_env_runners_recreated": null, "callbacks_on_offline_eval_runners_recreated": null, "callbacks_on_checkpoint_loaded": null, "callbacks_on_environment_created": null, "callbacks_on_episode_created": null, "callbacks_on_episode_start": null, "callbacks_on_episode_step": null, "callbacks_on_episode_end": null, "callbacks_on_evaluate_start": null, "callbacks_on_evaluate_end": null, "callbacks_on_evaluate_offline_start": null, "callbacks_on_evaluate_offline_end": null, "callbacks_on_sample_end": null, "callbacks_on_train_result": null, "explore": true, "enable_rl_module_and_learner": true, "enable_env_runner_and_connector_v2": true, "_prior_exploration_config": {"type": "StochasticSampling"}, "count_steps_by": "env_steps", "policy_map_capacity": 100, "policy_mapping_fn": "<function AlgorithmConfig.DEFAULT_POLICY_MAPPING_FN at 0x157405b20>", "policies_to_train": null, "policy_states_are_swappable": false, "observation_fn": null, "offline_data_class": null, "input_read_method": "read_parquet", "input_read_method_kwargs": {}, "input_read_schema": {}, "input_read_episodes": false, "input_read_sample_batches": false, "input_read_batch_size": null, "input_filesystem": null, "input_filesystem_kwargs": {}, "input_compress_columns": ["obs", "new_obs"], "input_spaces_jsonable": true, "materialize_data": false, "materialize_mapped_data": true, "map_batches_kwargs": {}, "iter_batches_kwargs": {}, "ignore_final_observation": false, "prelearner_class": null, "prelearner_buffer_class": null, "prelearner_buffer_kwargs": {}, "prelearner_module_synch_period": 10, "dataset_num_iters_per_learner": null, "input_config": {}, "actions_in_input_normalized": false, "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_config": {}, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "output_max_rows_per_file": null, "output_write_remaining_data": false, "output_write_method": "write_parquet", "output_write_method_kwargs": {}, "output_filesystem": null, "output_filesystem_kwargs": {}, "output_write_episodes": true, "offline_sampling": false, "evaluation_interval": 1, "evaluation_duration": 20, "evaluation_duration_unit": "episodes", "evaluation_sample_timeout_s": 120.0, "evaluation_auto_duration_min_env_steps_per_sample": 100, "evaluation_auto_duration_max_env_steps_per_sample": 2000, "evaluation_parallel_to_training": false, "evaluation_force_reset_envs_before_iteration": true, "evaluation_config": null, "off_policy_estimation_methods": {}, "ope_split_batch_by_episode": true, "evaluation_num_env_runners": 1, "in_evaluation": false, "sync_filters_on_rollout_workers_timeout_s": 10.0, "offline_evaluation_interval": null, "num_offline_eval_runners": 0, "offline_loss_for_module_fn": null, "offline_evaluation_duration": 1, "offline_evaluation_parallel_to_training": false, "offline_evaluation_timeout_s": 120.0, "num_cpus_per_offline_eval_runner": 1, "num_gpus_per_offline_eval_runner": 0, "custom_resources_per_offline_eval_runner": {}, "restart_failed_offline_eval_runners": true, "ignore_offline_eval_runner_failures": false, "max_num_offline_eval_runner_restarts": 1000, "offline_eval_runner_restore_timeout_s": 1800.0, "max_requests_in_flight_per_offline_eval_runner": 1, "validate_offline_eval_runners_after_construction": true, "offline_eval_runner_health_probe_timeout_s": 30.0, "offline_eval_rl_module_inference_only": false, "broadcast_offline_eval_runner_states": false, "offline_eval_batch_size_per_runner": 256, "dataset_num_iters_per_eval_runner": 1, "keep_per_episode_custom_metrics": false, "metrics_episode_collection_timeout_s": 60.0, "metrics_num_episodes_for_smoothing": 100, "min_time_s_per_iteration": null, "min_train_timesteps_per_iteration": 0, "min_sample_timesteps_per_iteration": 0, "log_gradients": true, "export_native_model_files": false, "checkpoint_trainable_policies_only": false, "logger_creator": null, "logger_config": null, "log_level": "WARN", "log_sys_usage": true, "fake_sampler": false, "seed": 5, "restart_failed_env_runners": true, "ignore_env_runner_failures": false, "max_num_env_runner_restarts": 1000, "delay_between_env_runner_restarts_s": 60.0, "restart_failed_sub_environments": false, "num_consecutive_env_runner_failures_tolerance": 100, "env_runner_health_probe_timeout_s": 30.0, "env_runner_restore_timeout_s": 1800.0, "_model_config": {}, "_rl_module_spec": "RLModuleSpec(module_class=None, observation_space=None, action_space=None, inference_only=False, learner_only=False, model_config=DefaultModelConfig(fcnet_hiddens=[60, 90], fcnet_activation='tanh', fcnet_kernel_initializer=None, fcnet_kernel_initializer_kwargs=None, fcnet_bias_initializer=None, fcnet_bias_initializer_kwargs=None, conv_filters=None, conv_activation='relu', conv_kernel_initializer=None, conv_kernel_initializer_kwargs=None, conv_bias_initializer=None, conv_bias_initializer_kwargs=None, head_fcnet_hiddens=[], head_fcnet_activation='relu', head_fcnet_kernel_initializer=None, head_fcnet_kernel_initializer_kwargs=None, head_fcnet_bias_initializer=None, head_fcnet_bias_initializer_kwargs=None, free_log_std=False, log_std_clip_param=20.0, vf_share_layers=True, use_lstm=False, max_seq_len=20, lstm_cell_size=256, lstm_use_prev_action=False, lstm_use_prev_reward=False, lstm_kernel_initializer=None, lstm_kernel_initializer_kwargs=None, lstm_bias_initializer=None, lstm_bias_initializer_kwargs=None), catalog_class=None, load_state_path=None, model_config_dict=None)", "algorithm_config_overrides_per_module": {}, "_per_module_overrides": {}, "_validate_config": true, "_use_msgpack_checkpoints": false, "_torch_grad_scaler_class": null, "_torch_lr_scheduler_classes": null, "_tf_policy_handles_more_than_one_loss": false, "_disable_preprocessor_api": false, "_disable_action_flattening": false, "_disable_initialize_loss_from_dummy_batch": false, "_dont_auto_sync_env_runner_states": false, "env_task_fn": -1, "enable_connectors": -1, "simple_optimizer": false, "policy_map_cache": -1, "worker_cls": -1, "synchronize_filters": -1, "enable_async_evaluation": -1, "custom_async_evaluation_function": -1, "_enable_rl_module_api": -1, "auto_wrap_old_gym_envs": -1, "always_attach_evaluation_results": -1, "replay_sequence_length": null, "_disable_execution_plan_api": -1, "use_critic": true, "use_gae": true, "use_kl_loss": true, "kl_coeff": 0.7464963036515, "kl_target": 0.0270990929592, "vf_loss_coeff": 0.6688075857018, "entropy_coeff": 0.0090570820258, "clip_param": 0.1221781641624, "vf_clip_param": 0.1027808522125, "entropy_coeff_schedule": null, "lr_schedule": null, "sgd_minibatch_size": -1, "vf_share_layers": -1, "__stdout_file__": null, "__stderr_file__": null, "lambda": 0.9099046732075, "input": "sampler", "policies": {"default_policy": [null, null, null, null]}, "callbacks": "<class 'ray.rllib.callbacks.callbacks.RLlibCallback'>", "create_env_on_driver": false, "custom_eval_function": null, "framework": "torch"}, "time_since_restore": 3.7461698055267334, "iterations_since_restore": 2, "perf": {"cpu_util_percent": 45.833333333333336, "ram_util_percent": 81.06666666666666}}
{"timers": {"training_iteration": 1.796285348239087, "restore_env_runners": 3.8727431639563295e-05, "training_step": 1.7959232790209234, "env_runner_sampling_timer": 1.680490634280315, "learner_update_timer": 0.11204802221445133, "synch_weights": 0.0006647673646803015, "restore_eval_env_runners": 1.0271418141201138e-05, "evaluation_iteration": 0.14033118063234726, "synch_eval_env_connectors": 0.0001471388037316501, "synch_env_connectors": 4.837572341784835e-06}, "env_runners": {"env_to_module_sum_episodes_length_in": 10.36823839457432, "episode_return_min": -13.5, "module_to_env_connector": {"timers": {"connectors": {"get_actions": 3.8669392693666205e-05, "un_batch_to_individual_items": 5.431373020673218e-06, "tensor_to_numpy": 1.2955750123037868e-05, "normalize_and_clip_actions": 9.3877232561333e-06, "remove_single_ts_time_rank_from_batch": 5.79941184406883e-07, "listify_data_for_vector_env": 1.0902577270821865e-05}}, "connector_pipeline_timer": 0.00010309521414913975}, "env_reset_timer": 3.577821085747262e-05, "env_to_module_connector": {"timers": {"connectors": {"numpy_to_tensor": 8.443845787993182e-06, "batch_individual_items": 6.314507344166607e-06, "add_states_from_episodes_to_batch": 1.72952309280186e-06, "add_time_dim_to_batch_and_zero_pad": 2.3281762644742303e-06, "add_observations_from_episodes_to_batch": 2.9986256272714388e-06}}, "connector_pipeline_timer": 4.331343133509791e-05}, "num_agent_steps_sampled_lifetime": {"default_agent": -607500.0}, "agent_episode_returns_mean": {"default_agent": -2.0599999999999996}, "num_episodes": 250.0, "num_env_steps_sampled_lifetime": -607500.0, "episode_len_max": 20, "rlmodule_inference_timer": 2.7518899375804726e-05, "weights_seq_no": 2.0, "episode_len_min": 20, "num_env_steps_sampled": 5000.0, "time_between_sampling": 0.0019198631788929718, "episode_len_mean": 20.0, "episode_duration_sec_mean": 0.004504054528661074, "env_step_timer": 1.349914534621315e-05, "num_agent_steps_sampled": {"default_agent": 5000.0}, "num_episodes_lifetime": -30375.0, "module_episode_returns_mean": {"default_policy": -2.0599999999999996}, "num_module_steps_sampled": {"default_policy": 5000.0}, "episode_return_max": 6.5, "sample": 0.005025014942616763, "episode_return_mean": -2.0599999999999996, "env_to_module_sum_episodes_length_out": 10.36823839457432, "num_module_steps_sampled_lifetime": {"default_policy": -607500.0}, "num_env_steps_sampled_lifetime_throughput": 3757.5505464641715}, "learners": {"default_policy": {"num_trainable_parameters": 6003, "diff_num_grad_updates_vs_sampler_policy": 1.0, "gradients_default_optimizer_global_norm": 0.11601883918046951, "default_optimizer_learning_rate": 0.0002847858517, "module_train_batch_size_mean": 1000.0, "vf_loss_unclipped": 31.712276458740234, "curr_entropy_coeff": 0.0090570820258, "num_module_steps_trained": 6000, "total_loss": 0.2806500792503357, "vf_explained_var": -0.009776949882507324, "num_module_steps_trained_lifetime": 18000, "curr_kl_coeff": 0.09331203997135162, "policy_loss": 0.21789036691188812, "mean_kl_loss": 0.0014248319203034043, "entropy": 0.6897167563438416, "vf_loss": 0.10278083384037018, "weights_seq_no": 3.0, "num_module_steps_trained_lifetime_throughput": 347849.7802286755}, "__all_modules__": {"learner_connector": {"timers": {"connectors": {"add_observations_from_episodes_to_batch": 0.0008698060670751147, "general_advantage_estimation": 0.006824035969667602, "batch_individual_items": 0.03179371130709769, "numpy_to_tensor": 8.027902563335374e-05, "add_one_ts_to_episodes_and_truncate": 0.008184893486090004, "add_time_dim_to_batch_and_zero_pad": 1.2073287926614284e-05, "add_columns_from_episodes_to_train_batch": 0.03424325461043044, "add_states_from_episodes_to_batch": 4.311376344412566e-06}}, "connector_pipeline_timer": 0.0821657663062215}, "learner_connector_sum_episodes_length_in": 5000.0, "num_trainable_parameters": 6003, "num_env_steps_trained": 31500, "num_module_steps_trained": 6000, "learner_connector_sum_episodes_length_out": 5250.0, "num_non_trainable_parameters": 0, "num_module_steps_trained_lifetime": 18000, "num_env_steps_trained_lifetime": 94500, "num_env_steps_trained_lifetime_throughput": 1815464.4076651752, "num_module_steps_trained_throughput": 347170.0329862406, "num_module_steps_trained_lifetime_throughput": 346639.93690280436}}, "num_training_step_calls_per_iteration": 1, "evaluation": {"env_runners": {"num_agent_steps_sampled_lifetime": {"default_agent": 1200}, "env_to_module_sum_episodes_length_in": 10.368205581254823, "agent_episode_returns_mean": {"default_agent": 0.7}, "env_to_module_connector": {"timers": {"connectors": {"add_observations_from_episodes_to_batch": 2.7384472974519296e-06, "batch_individual_items": 6.061594313819951e-06, "numpy_to_tensor": 8.153332057286439e-06, "add_time_dim_to_batch_and_zero_pad": 2.269008911262745e-06, "add_states_from_episodes_to_batch": 1.5583595318095098e-06}}, "connector_pipeline_timer": 4.233882446942623e-05}, "module_to_env_connector": {"connector_pipeline_timer": 0.00010056762317812606, "timers": {"connectors": {"remove_single_ts_time_rank_from_batch": 5.869280189062775e-07, "listify_data_for_vector_env": 1.0998786685337797e-05, "tensor_to_numpy": 1.2911853282802047e-05, "normalize_and_clip_actions": 9.291942564930779e-06, "un_batch_to_individual_items": 5.379481593546436e-06, "get_actions": 3.565112300609933e-05}}}, "episode_duration_sec_mean": 0.00488145078610008, "sample": 0.12569469719942425, "num_episodes": 20, "episode_len_min": 20, "num_module_steps_sampled": {"default_policy": 400}, "num_env_steps_sampled": 400, "num_episodes_lifetime": 60, "env_to_module_sum_episodes_length_out": 10.368205581254823, "episode_return_min": -15.5, "module_episode_returns_mean": {"default_policy": 0.7}, "num_env_steps_sampled_lifetime": 15400, "rlmodule_inference_timer": 2.7045129906754038e-05, "weights_seq_no": 3.0, "num_module_steps_sampled_lifetime": {"default_policy": 1200}, "env_step_timer": 1.3940002913318106e-05, "episode_return_max": 13.5, "episode_return_mean": 0.7, "env_reset_timer": 0.0025672630883054803, "episode_len_max": 20, "num_agent_steps_sampled": {"default_agent": 400}, "episode_len_mean": 20.0, "time_between_sampling": 1.7470743805542588}, "num_healthy_workers": 1, "actor_manager_num_outstanding_async_reqs": 0, "num_remote_worker_restarts": 0}, "num_env_steps_sampled_lifetime": -607500.0, "fault_tolerance": {"num_healthy_workers": 0, "num_remote_worker_restarts": 0}, "env_runner_group": {"actor_manager_num_outstanding_async_reqs": 0}, "done": false, "training_iteration": 3, "trial_id": "5029b_00000", "date": "2025-08-11_19-21-40", "timestamp": 1754932900, "time_this_iter_s": 1.5679080486297607, "time_total_s": 5.314077854156494, "pid": 14328, "hostname": "Mac", "node_ip": "127.0.0.1", "config": {"exploration_config": {}, "extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "placement_strategy": "PACK", "num_gpus": 0, "_fake_gpus": false, "num_cpus_for_main_process": 2, "eager_tracing": true, "eager_max_retraces": 20, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "torch_compile_learner": false, "torch_compile_learner_what_to_compile": "forward_train", "torch_compile_learner_dynamo_backend": "aot_eager", "torch_compile_learner_dynamo_mode": null, "torch_compile_worker": false, "torch_compile_worker_dynamo_backend": "aot_eager", "torch_compile_worker_dynamo_mode": null, "torch_ddp_kwargs": {}, "torch_skip_nan_gradients": false, "env": "Umbrella", "env_config": {}, "observation_space": null, "action_space": null, "clip_rewards": null, "normalize_actions": true, "clip_actions": false, "_is_atari": null, "disable_env_checking": false, "render_env": false, "action_mask_key": "action_mask", "env_runner_cls": null, "num_env_runners": 0, "create_local_env_runner": true, "num_envs_per_env_runner": 1, "gym_env_vectorize_mode": "SYNC", "num_cpus_per_env_runner": 1, "num_gpus_per_env_runner": 0, "custom_resources_per_env_runner": {}, "validate_env_runners_after_construction": true, "episodes_to_numpy": true, "max_requests_in_flight_per_env_runner": 1, "sample_timeout_s": 60.0, "_env_to_module_connector": null, "add_default_connectors_to_env_to_module_pipeline": true, "_module_to_env_connector": null, "add_default_connectors_to_module_to_env_pipeline": true, "merge_env_runner_states": "training_only", "broadcast_env_runner_states": true, "episode_lookback_horizon": 1, "rollout_fragment_length": "auto", "batch_mode": "complete_episodes", "compress_observations": false, "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "enable_tf1_exec_eagerly": false, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "preprocessor_pref": "deepmind", "observation_filter": "NoFilter", "update_worker_filter_stats": true, "use_worker_filter_stats": true, "sampler_perf_stats_ema_coef": null, "_is_online": true, "num_learners": 0, "num_gpus_per_learner": 0, "num_cpus_per_learner": "auto", "num_aggregator_actors_per_learner": 0, "max_requests_in_flight_per_aggregator_actor": 3, "local_gpu_idx": 0, "max_requests_in_flight_per_learner": 3, "gamma": 1, "lr": 0.0002847858517, "grad_clip": 0.5, "grad_clip_by": "global_norm", "_train_batch_size_per_learner": 5000, "train_batch_size": 4000, "num_epochs": 1, "minibatch_size": 1000, "shuffle_batch_per_epoch": true, "model": {"fcnet_hiddens": [256, 256], "fcnet_activation": "tanh", "fcnet_weights_initializer": null, "fcnet_weights_initializer_config": null, "fcnet_bias_initializer": null, "fcnet_bias_initializer_config": null, "conv_filters": null, "conv_activation": "relu", "conv_kernel_initializer": null, "conv_kernel_initializer_config": null, "conv_bias_initializer": null, "conv_bias_initializer_config": null, "conv_transpose_kernel_initializer": null, "conv_transpose_kernel_initializer_config": null, "conv_transpose_bias_initializer": null, "conv_transpose_bias_initializer_config": null, "post_fcnet_hiddens": [], "post_fcnet_activation": "relu", "post_fcnet_weights_initializer": null, "post_fcnet_weights_initializer_config": null, "post_fcnet_bias_initializer": null, "post_fcnet_bias_initializer_config": null, "free_log_std": false, "log_std_clip_param": 20.0, "no_final_linear": false, "vf_share_layers": false, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "lstm_weights_initializer": null, "lstm_weights_initializer_config": null, "lstm_bias_initializer": null, "lstm_bias_initializer_config": null, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "attention_use_n_prev_actions": 0, "attention_use_n_prev_rewards": 0, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": null, "custom_model_config": {}, "custom_action_dist": null, "custom_preprocessor": null, "encoder_latent_dim": null, "always_check_shapes": false, "lstm_use_prev_action_reward": -1, "_use_default_native_models": -1, "_disable_preprocessor_api": false, "_disable_action_flattening": false}, "_learner_connector": null, "add_default_connectors_to_learner_pipeline": true, "learner_config_dict": {}, "optimizer": {}, "_learner_class": null, "callbacks_on_algorithm_init": null, "callbacks_on_env_runners_recreated": null, "callbacks_on_offline_eval_runners_recreated": null, "callbacks_on_checkpoint_loaded": null, "callbacks_on_environment_created": null, "callbacks_on_episode_created": null, "callbacks_on_episode_start": null, "callbacks_on_episode_step": null, "callbacks_on_episode_end": null, "callbacks_on_evaluate_start": null, "callbacks_on_evaluate_end": null, "callbacks_on_evaluate_offline_start": null, "callbacks_on_evaluate_offline_end": null, "callbacks_on_sample_end": null, "callbacks_on_train_result": null, "explore": true, "enable_rl_module_and_learner": true, "enable_env_runner_and_connector_v2": true, "_prior_exploration_config": {"type": "StochasticSampling"}, "count_steps_by": "env_steps", "policy_map_capacity": 100, "policy_mapping_fn": "<function AlgorithmConfig.DEFAULT_POLICY_MAPPING_FN at 0x157405b20>", "policies_to_train": null, "policy_states_are_swappable": false, "observation_fn": null, "offline_data_class": null, "input_read_method": "read_parquet", "input_read_method_kwargs": {}, "input_read_schema": {}, "input_read_episodes": false, "input_read_sample_batches": false, "input_read_batch_size": null, "input_filesystem": null, "input_filesystem_kwargs": {}, "input_compress_columns": ["obs", "new_obs"], "input_spaces_jsonable": true, "materialize_data": false, "materialize_mapped_data": true, "map_batches_kwargs": {}, "iter_batches_kwargs": {}, "ignore_final_observation": false, "prelearner_class": null, "prelearner_buffer_class": null, "prelearner_buffer_kwargs": {}, "prelearner_module_synch_period": 10, "dataset_num_iters_per_learner": null, "input_config": {}, "actions_in_input_normalized": false, "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_config": {}, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "output_max_rows_per_file": null, "output_write_remaining_data": false, "output_write_method": "write_parquet", "output_write_method_kwargs": {}, "output_filesystem": null, "output_filesystem_kwargs": {}, "output_write_episodes": true, "offline_sampling": false, "evaluation_interval": 1, "evaluation_duration": 20, "evaluation_duration_unit": "episodes", "evaluation_sample_timeout_s": 120.0, "evaluation_auto_duration_min_env_steps_per_sample": 100, "evaluation_auto_duration_max_env_steps_per_sample": 2000, "evaluation_parallel_to_training": false, "evaluation_force_reset_envs_before_iteration": true, "evaluation_config": null, "off_policy_estimation_methods": {}, "ope_split_batch_by_episode": true, "evaluation_num_env_runners": 1, "in_evaluation": false, "sync_filters_on_rollout_workers_timeout_s": 10.0, "offline_evaluation_interval": null, "num_offline_eval_runners": 0, "offline_loss_for_module_fn": null, "offline_evaluation_duration": 1, "offline_evaluation_parallel_to_training": false, "offline_evaluation_timeout_s": 120.0, "num_cpus_per_offline_eval_runner": 1, "num_gpus_per_offline_eval_runner": 0, "custom_resources_per_offline_eval_runner": {}, "restart_failed_offline_eval_runners": true, "ignore_offline_eval_runner_failures": false, "max_num_offline_eval_runner_restarts": 1000, "offline_eval_runner_restore_timeout_s": 1800.0, "max_requests_in_flight_per_offline_eval_runner": 1, "validate_offline_eval_runners_after_construction": true, "offline_eval_runner_health_probe_timeout_s": 30.0, "offline_eval_rl_module_inference_only": false, "broadcast_offline_eval_runner_states": false, "offline_eval_batch_size_per_runner": 256, "dataset_num_iters_per_eval_runner": 1, "keep_per_episode_custom_metrics": false, "metrics_episode_collection_timeout_s": 60.0, "metrics_num_episodes_for_smoothing": 100, "min_time_s_per_iteration": null, "min_train_timesteps_per_iteration": 0, "min_sample_timesteps_per_iteration": 0, "log_gradients": true, "export_native_model_files": false, "checkpoint_trainable_policies_only": false, "logger_creator": null, "logger_config": null, "log_level": "WARN", "log_sys_usage": true, "fake_sampler": false, "seed": 5, "restart_failed_env_runners": true, "ignore_env_runner_failures": false, "max_num_env_runner_restarts": 1000, "delay_between_env_runner_restarts_s": 60.0, "restart_failed_sub_environments": false, "num_consecutive_env_runner_failures_tolerance": 100, "env_runner_health_probe_timeout_s": 30.0, "env_runner_restore_timeout_s": 1800.0, "_model_config": {}, "_rl_module_spec": "RLModuleSpec(module_class=None, observation_space=None, action_space=None, inference_only=False, learner_only=False, model_config=DefaultModelConfig(fcnet_hiddens=[60, 90], fcnet_activation='tanh', fcnet_kernel_initializer=None, fcnet_kernel_initializer_kwargs=None, fcnet_bias_initializer=None, fcnet_bias_initializer_kwargs=None, conv_filters=None, conv_activation='relu', conv_kernel_initializer=None, conv_kernel_initializer_kwargs=None, conv_bias_initializer=None, conv_bias_initializer_kwargs=None, head_fcnet_hiddens=[], head_fcnet_activation='relu', head_fcnet_kernel_initializer=None, head_fcnet_kernel_initializer_kwargs=None, head_fcnet_bias_initializer=None, head_fcnet_bias_initializer_kwargs=None, free_log_std=False, log_std_clip_param=20.0, vf_share_layers=True, use_lstm=False, max_seq_len=20, lstm_cell_size=256, lstm_use_prev_action=False, lstm_use_prev_reward=False, lstm_kernel_initializer=None, lstm_kernel_initializer_kwargs=None, lstm_bias_initializer=None, lstm_bias_initializer_kwargs=None), catalog_class=None, load_state_path=None, model_config_dict=None)", "algorithm_config_overrides_per_module": {}, "_per_module_overrides": {}, "_validate_config": true, "_use_msgpack_checkpoints": false, "_torch_grad_scaler_class": null, "_torch_lr_scheduler_classes": null, "_tf_policy_handles_more_than_one_loss": false, "_disable_preprocessor_api": false, "_disable_action_flattening": false, "_disable_initialize_loss_from_dummy_batch": false, "_dont_auto_sync_env_runner_states": false, "env_task_fn": -1, "enable_connectors": -1, "simple_optimizer": false, "policy_map_cache": -1, "worker_cls": -1, "synchronize_filters": -1, "enable_async_evaluation": -1, "custom_async_evaluation_function": -1, "_enable_rl_module_api": -1, "auto_wrap_old_gym_envs": -1, "always_attach_evaluation_results": -1, "replay_sequence_length": null, "_disable_execution_plan_api": -1, "use_critic": true, "use_gae": true, "use_kl_loss": true, "kl_coeff": 0.7464963036515, "kl_target": 0.0270990929592, "vf_loss_coeff": 0.6688075857018, "entropy_coeff": 0.0090570820258, "clip_param": 0.1221781641624, "vf_clip_param": 0.1027808522125, "entropy_coeff_schedule": null, "lr_schedule": null, "sgd_minibatch_size": -1, "vf_share_layers": -1, "__stdout_file__": null, "__stderr_file__": null, "lambda": 0.9099046732075, "input": "sampler", "policies": {"default_policy": [null, null, null, null]}, "callbacks": "<class 'ray.rllib.callbacks.callbacks.RLlibCallback'>", "create_env_on_driver": false, "custom_eval_function": null, "framework": "torch"}, "time_since_restore": 5.314077854156494, "iterations_since_restore": 3, "perf": {"cpu_util_percent": 42.25, "ram_util_percent": 80.1}}
{"timers": {"training_iteration": 1.7937695522574106, "restore_env_runners": 3.840890755562577e-05, "training_step": 1.793409283730376, "env_runner_sampling_timer": 1.6781666550176608, "learner_update_timer": 0.11185949116191464, "synch_weights": 0.0006652405310521136, "restore_eval_env_runners": 1.027079321211204e-05, "evaluation_iteration": 0.13996809674560792, "synch_eval_env_connectors": 0.00014664616587106136, "synch_env_connectors": 4.8546173726208506e-06}, "env_runners": {"env_to_module_sum_episodes_length_in": 10.36823839457432, "episode_return_min": -13.5, "module_to_env_connector": {"timers": {"connectors": {"get_actions": 3.876957003422971e-05, "un_batch_to_individual_items": 5.35590671426734e-06, "tensor_to_numpy": 1.2992576170969261e-05, "normalize_and_clip_actions": 9.293270876116477e-06, "remove_single_ts_time_rank_from_batch": 5.825398137014281e-07, "listify_data_for_vector_env": 1.0899492190784259e-05}}, "connector_pipeline_timer": 0.00010310341592850765}, "env_reset_timer": 3.294028458232312e-05, "env_to_module_connector": {"timers": {"connectors": {"numpy_to_tensor": 8.426599928520745e-06, "batch_individual_items": 6.242810715310055e-06, "add_states_from_episodes_to_batch": 1.7322652880968173e-06, "add_time_dim_to_batch_and_zero_pad": 2.3365242546685166e-06, "add_observations_from_episodes_to_batch": 3.050333810287876e-06}}, "connector_pipeline_timer": 4.3280081451682224e-05}, "num_agent_steps_sampled_lifetime": {"default_agent": -1225000.0}, "agent_episode_returns_mean": {"default_agent": -3.0199999999999996}, "num_episodes": 250.0, "num_env_steps_sampled_lifetime": -1225000.0, "episode_len_max": 20, "rlmodule_inference_timer": 2.7317211913184357e-05, "weights_seq_no": 3.0, "episode_len_min": 20, "num_env_steps_sampled": 5000.0, "time_between_sampling": 0.0017779121395030339, "episode_len_mean": 20.0, "episode_duration_sec_mean": 0.004502114656381309, "env_step_timer": 1.3512844759681468e-05, "num_agent_steps_sampled": {"default_agent": 5000.0}, "num_episodes_lifetime": -61250.0, "module_episode_returns_mean": {"default_policy": -3.0199999999999996}, "num_module_steps_sampled": {"default_policy": 5000.0}, "episode_return_max": 6.5, "sample": 0.004814590548317913, "episode_return_mean": -3.0199999999999996, "env_to_module_sum_episodes_length_out": 10.36823839457432, "num_module_steps_sampled_lifetime": {"default_policy": -1225000.0}, "num_env_steps_sampled_lifetime_throughput": 3755.629010448619}, "learners": {"default_policy": {"num_trainable_parameters": 6003, "diff_num_grad_updates_vs_sampler_policy": 1.0, "gradients_default_optimizer_global_norm": 0.11352477222681046, "default_optimizer_learning_rate": 0.0002847858517, "module_train_batch_size_mean": 1000.0, "vf_loss_unclipped": 27.08785629272461, "curr_entropy_coeff": 0.0090570820258, "num_module_steps_trained": 6000, "total_loss": -0.23051778972148895, "vf_explained_var": -0.01489114761352539, "num_module_steps_trained_lifetime": 24000, "curr_kl_coeff": 0.04665601998567581, "policy_loss": -0.29342687129974365, "mean_kl_loss": 0.003163272514939308, "entropy": 0.6764528751373291, "vf_loss": 0.10278083384037018, "weights_seq_no": 4.0, "num_module_steps_trained_lifetime_throughput": 348870.8159625469}, "__all_modules__": {"learner_connector": {"timers": {"connectors": {"add_observations_from_episodes_to_batch": 0.0008695800872124965, "general_advantage_estimation": 0.006809391449970542, "batch_individual_items": 0.03177788127437827, "numpy_to_tensor": 8.01391449648654e-05, "add_one_ts_to_episodes_and_truncate": 0.008179970800541341, "add_time_dim_to_batch_and_zero_pad": 1.2057974942028522e-05, "add_columns_from_episodes_to_train_batch": 0.03424032164360303, "add_states_from_episodes_to_batch": 4.304103366099299e-06}}, "connector_pipeline_timer": 0.08212643239289523}, "learner_connector_sum_episodes_length_in": 5000.0, "num_trainable_parameters": 6003, "num_env_steps_trained": 31500, "num_module_steps_trained": 6000, "learner_connector_sum_episodes_length_out": 5250.0, "num_non_trainable_parameters": 0, "num_module_steps_trained_lifetime": 24000, "num_env_steps_trained_lifetime": 126000, "num_env_steps_trained_lifetime_throughput": 1821207.8838995304, "num_module_steps_trained_throughput": 348228.72271595645, "num_module_steps_trained_lifetime_throughput": 347710.21547025227}}, "num_training_step_calls_per_iteration": 1, "evaluation": {"env_runners": {"num_agent_steps_sampled_lifetime": {"default_agent": 1600}, "env_to_module_sum_episodes_length_in": 10.368237912813044, "agent_episode_returns_mean": {"default_agent": 0.7}, "env_to_module_connector": {"timers": {"connectors": {"add_observations_from_episodes_to_batch": 2.7700229867575874e-06, "batch_individual_items": 6.045362072360028e-06, "numpy_to_tensor": 8.220748240210972e-06, "add_time_dim_to_batch_and_zero_pad": 2.2356243118264835e-06, "add_states_from_episodes_to_batch": 1.5615065909233415e-06}}, "connector_pipeline_timer": 4.2715682413797576e-05}, "module_to_env_connector": {"connector_pipeline_timer": 0.00010088220088505692, "timers": {"connectors": {"remove_single_ts_time_rank_from_batch": 5.802187700261097e-07, "listify_data_for_vector_env": 1.1040136221919557e-05, "tensor_to_numpy": 1.2907316005741479e-05, "normalize_and_clip_actions": 9.364904040405701e-06, "un_batch_to_individual_items": 5.32649286631791e-06, "get_actions": 3.5658280550116805e-05}}}, "episode_duration_sec_mean": 0.0047884443745715545, "sample": 0.12542101230812921, "num_episodes": 20, "episode_len_min": 20, "num_module_steps_sampled": {"default_policy": 400}, "num_env_steps_sampled": 400, "num_episodes_lifetime": 80, "env_to_module_sum_episodes_length_out": 10.368237912813044, "episode_return_min": -15.5, "module_episode_returns_mean": {"default_policy": 0.7}, "num_env_steps_sampled_lifetime": 20400, "rlmodule_inference_timer": 2.688257444008821e-05, "weights_seq_no": 4.0, "num_module_steps_sampled_lifetime": {"default_policy": 1600}, "env_step_timer": 1.389742122293626e-05, "episode_return_max": 13.5, "episode_return_mean": 0.7, "env_reset_timer": 0.0025423454573506015, "episode_len_max": 20, "num_agent_steps_sampled": {"default_agent": 400}, "episode_len_mean": 20.0, "time_between_sampling": 1.745220950498106}, "num_healthy_workers": 1, "actor_manager_num_outstanding_async_reqs": 0, "num_remote_worker_restarts": 0}, "num_env_steps_sampled_lifetime": -1225000.0, "fault_tolerance": {"num_healthy_workers": 0, "num_remote_worker_restarts": 0}, "env_runner_group": {"actor_manager_num_outstanding_async_reqs": 0}, "done": false, "training_iteration": 4, "trial_id": "5029b_00000", "date": "2025-08-11_19-21-42", "timestamp": 1754932902, "time_this_iter_s": 1.6501691341400146, "time_total_s": 6.964246988296509, "pid": 14328, "hostname": "Mac", "node_ip": "127.0.0.1", "config": {"exploration_config": {}, "extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "placement_strategy": "PACK", "num_gpus": 0, "_fake_gpus": false, "num_cpus_for_main_process": 2, "eager_tracing": true, "eager_max_retraces": 20, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "torch_compile_learner": false, "torch_compile_learner_what_to_compile": "forward_train", "torch_compile_learner_dynamo_backend": "aot_eager", "torch_compile_learner_dynamo_mode": null, "torch_compile_worker": false, "torch_compile_worker_dynamo_backend": "aot_eager", "torch_compile_worker_dynamo_mode": null, "torch_ddp_kwargs": {}, "torch_skip_nan_gradients": false, "env": "Umbrella", "env_config": {}, "observation_space": null, "action_space": null, "clip_rewards": null, "normalize_actions": true, "clip_actions": false, "_is_atari": null, "disable_env_checking": false, "render_env": false, "action_mask_key": "action_mask", "env_runner_cls": null, "num_env_runners": 0, "create_local_env_runner": true, "num_envs_per_env_runner": 1, "gym_env_vectorize_mode": "SYNC", "num_cpus_per_env_runner": 1, "num_gpus_per_env_runner": 0, "custom_resources_per_env_runner": {}, "validate_env_runners_after_construction": true, "episodes_to_numpy": true, "max_requests_in_flight_per_env_runner": 1, "sample_timeout_s": 60.0, "_env_to_module_connector": null, "add_default_connectors_to_env_to_module_pipeline": true, "_module_to_env_connector": null, "add_default_connectors_to_module_to_env_pipeline": true, "merge_env_runner_states": "training_only", "broadcast_env_runner_states": true, "episode_lookback_horizon": 1, "rollout_fragment_length": "auto", "batch_mode": "complete_episodes", "compress_observations": false, "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "enable_tf1_exec_eagerly": false, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "preprocessor_pref": "deepmind", "observation_filter": "NoFilter", "update_worker_filter_stats": true, "use_worker_filter_stats": true, "sampler_perf_stats_ema_coef": null, "_is_online": true, "num_learners": 0, "num_gpus_per_learner": 0, "num_cpus_per_learner": "auto", "num_aggregator_actors_per_learner": 0, "max_requests_in_flight_per_aggregator_actor": 3, "local_gpu_idx": 0, "max_requests_in_flight_per_learner": 3, "gamma": 1, "lr": 0.0002847858517, "grad_clip": 0.5, "grad_clip_by": "global_norm", "_train_batch_size_per_learner": 5000, "train_batch_size": 4000, "num_epochs": 1, "minibatch_size": 1000, "shuffle_batch_per_epoch": true, "model": {"fcnet_hiddens": [256, 256], "fcnet_activation": "tanh", "fcnet_weights_initializer": null, "fcnet_weights_initializer_config": null, "fcnet_bias_initializer": null, "fcnet_bias_initializer_config": null, "conv_filters": null, "conv_activation": "relu", "conv_kernel_initializer": null, "conv_kernel_initializer_config": null, "conv_bias_initializer": null, "conv_bias_initializer_config": null, "conv_transpose_kernel_initializer": null, "conv_transpose_kernel_initializer_config": null, "conv_transpose_bias_initializer": null, "conv_transpose_bias_initializer_config": null, "post_fcnet_hiddens": [], "post_fcnet_activation": "relu", "post_fcnet_weights_initializer": null, "post_fcnet_weights_initializer_config": null, "post_fcnet_bias_initializer": null, "post_fcnet_bias_initializer_config": null, "free_log_std": false, "log_std_clip_param": 20.0, "no_final_linear": false, "vf_share_layers": false, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "lstm_weights_initializer": null, "lstm_weights_initializer_config": null, "lstm_bias_initializer": null, "lstm_bias_initializer_config": null, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "attention_use_n_prev_actions": 0, "attention_use_n_prev_rewards": 0, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": null, "custom_model_config": {}, "custom_action_dist": null, "custom_preprocessor": null, "encoder_latent_dim": null, "always_check_shapes": false, "lstm_use_prev_action_reward": -1, "_use_default_native_models": -1, "_disable_preprocessor_api": false, "_disable_action_flattening": false}, "_learner_connector": null, "add_default_connectors_to_learner_pipeline": true, "learner_config_dict": {}, "optimizer": {}, "_learner_class": null, "callbacks_on_algorithm_init": null, "callbacks_on_env_runners_recreated": null, "callbacks_on_offline_eval_runners_recreated": null, "callbacks_on_checkpoint_loaded": null, "callbacks_on_environment_created": null, "callbacks_on_episode_created": null, "callbacks_on_episode_start": null, "callbacks_on_episode_step": null, "callbacks_on_episode_end": null, "callbacks_on_evaluate_start": null, "callbacks_on_evaluate_end": null, "callbacks_on_evaluate_offline_start": null, "callbacks_on_evaluate_offline_end": null, "callbacks_on_sample_end": null, "callbacks_on_train_result": null, "explore": true, "enable_rl_module_and_learner": true, "enable_env_runner_and_connector_v2": true, "_prior_exploration_config": {"type": "StochasticSampling"}, "count_steps_by": "env_steps", "policy_map_capacity": 100, "policy_mapping_fn": "<function AlgorithmConfig.DEFAULT_POLICY_MAPPING_FN at 0x157405b20>", "policies_to_train": null, "policy_states_are_swappable": false, "observation_fn": null, "offline_data_class": null, "input_read_method": "read_parquet", "input_read_method_kwargs": {}, "input_read_schema": {}, "input_read_episodes": false, "input_read_sample_batches": false, "input_read_batch_size": null, "input_filesystem": null, "input_filesystem_kwargs": {}, "input_compress_columns": ["obs", "new_obs"], "input_spaces_jsonable": true, "materialize_data": false, "materialize_mapped_data": true, "map_batches_kwargs": {}, "iter_batches_kwargs": {}, "ignore_final_observation": false, "prelearner_class": null, "prelearner_buffer_class": null, "prelearner_buffer_kwargs": {}, "prelearner_module_synch_period": 10, "dataset_num_iters_per_learner": null, "input_config": {}, "actions_in_input_normalized": false, "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_config": {}, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "output_max_rows_per_file": null, "output_write_remaining_data": false, "output_write_method": "write_parquet", "output_write_method_kwargs": {}, "output_filesystem": null, "output_filesystem_kwargs": {}, "output_write_episodes": true, "offline_sampling": false, "evaluation_interval": 1, "evaluation_duration": 20, "evaluation_duration_unit": "episodes", "evaluation_sample_timeout_s": 120.0, "evaluation_auto_duration_min_env_steps_per_sample": 100, "evaluation_auto_duration_max_env_steps_per_sample": 2000, "evaluation_parallel_to_training": false, "evaluation_force_reset_envs_before_iteration": true, "evaluation_config": null, "off_policy_estimation_methods": {}, "ope_split_batch_by_episode": true, "evaluation_num_env_runners": 1, "in_evaluation": false, "sync_filters_on_rollout_workers_timeout_s": 10.0, "offline_evaluation_interval": null, "num_offline_eval_runners": 0, "offline_loss_for_module_fn": null, "offline_evaluation_duration": 1, "offline_evaluation_parallel_to_training": false, "offline_evaluation_timeout_s": 120.0, "num_cpus_per_offline_eval_runner": 1, "num_gpus_per_offline_eval_runner": 0, "custom_resources_per_offline_eval_runner": {}, "restart_failed_offline_eval_runners": true, "ignore_offline_eval_runner_failures": false, "max_num_offline_eval_runner_restarts": 1000, "offline_eval_runner_restore_timeout_s": 1800.0, "max_requests_in_flight_per_offline_eval_runner": 1, "validate_offline_eval_runners_after_construction": true, "offline_eval_runner_health_probe_timeout_s": 30.0, "offline_eval_rl_module_inference_only": false, "broadcast_offline_eval_runner_states": false, "offline_eval_batch_size_per_runner": 256, "dataset_num_iters_per_eval_runner": 1, "keep_per_episode_custom_metrics": false, "metrics_episode_collection_timeout_s": 60.0, "metrics_num_episodes_for_smoothing": 100, "min_time_s_per_iteration": null, "min_train_timesteps_per_iteration": 0, "min_sample_timesteps_per_iteration": 0, "log_gradients": true, "export_native_model_files": false, "checkpoint_trainable_policies_only": false, "logger_creator": null, "logger_config": null, "log_level": "WARN", "log_sys_usage": true, "fake_sampler": false, "seed": 5, "restart_failed_env_runners": true, "ignore_env_runner_failures": false, "max_num_env_runner_restarts": 1000, "delay_between_env_runner_restarts_s": 60.0, "restart_failed_sub_environments": false, "num_consecutive_env_runner_failures_tolerance": 100, "env_runner_health_probe_timeout_s": 30.0, "env_runner_restore_timeout_s": 1800.0, "_model_config": {}, "_rl_module_spec": "RLModuleSpec(module_class=None, observation_space=None, action_space=None, inference_only=False, learner_only=False, model_config=DefaultModelConfig(fcnet_hiddens=[60, 90], fcnet_activation='tanh', fcnet_kernel_initializer=None, fcnet_kernel_initializer_kwargs=None, fcnet_bias_initializer=None, fcnet_bias_initializer_kwargs=None, conv_filters=None, conv_activation='relu', conv_kernel_initializer=None, conv_kernel_initializer_kwargs=None, conv_bias_initializer=None, conv_bias_initializer_kwargs=None, head_fcnet_hiddens=[], head_fcnet_activation='relu', head_fcnet_kernel_initializer=None, head_fcnet_kernel_initializer_kwargs=None, head_fcnet_bias_initializer=None, head_fcnet_bias_initializer_kwargs=None, free_log_std=False, log_std_clip_param=20.0, vf_share_layers=True, use_lstm=False, max_seq_len=20, lstm_cell_size=256, lstm_use_prev_action=False, lstm_use_prev_reward=False, lstm_kernel_initializer=None, lstm_kernel_initializer_kwargs=None, lstm_bias_initializer=None, lstm_bias_initializer_kwargs=None), catalog_class=None, load_state_path=None, model_config_dict=None)", "algorithm_config_overrides_per_module": {}, "_per_module_overrides": {}, "_validate_config": true, "_use_msgpack_checkpoints": false, "_torch_grad_scaler_class": null, "_torch_lr_scheduler_classes": null, "_tf_policy_handles_more_than_one_loss": false, "_disable_preprocessor_api": false, "_disable_action_flattening": false, "_disable_initialize_loss_from_dummy_batch": false, "_dont_auto_sync_env_runner_states": false, "env_task_fn": -1, "enable_connectors": -1, "simple_optimizer": false, "policy_map_cache": -1, "worker_cls": -1, "synchronize_filters": -1, "enable_async_evaluation": -1, "custom_async_evaluation_function": -1, "_enable_rl_module_api": -1, "auto_wrap_old_gym_envs": -1, "always_attach_evaluation_results": -1, "replay_sequence_length": null, "_disable_execution_plan_api": -1, "use_critic": true, "use_gae": true, "use_kl_loss": true, "kl_coeff": 0.7464963036515, "kl_target": 0.0270990929592, "vf_loss_coeff": 0.6688075857018, "entropy_coeff": 0.0090570820258, "clip_param": 0.1221781641624, "vf_clip_param": 0.1027808522125, "entropy_coeff_schedule": null, "lr_schedule": null, "sgd_minibatch_size": -1, "vf_share_layers": -1, "__stdout_file__": null, "__stderr_file__": null, "lambda": 0.9099046732075, "input": "sampler", "policies": {"default_policy": [null, null, null, null]}, "callbacks": "<class 'ray.rllib.callbacks.callbacks.RLlibCallback'>", "create_env_on_driver": false, "custom_eval_function": null, "framework": "torch"}, "time_since_restore": 6.964246988296509, "iterations_since_restore": 4, "perf": {"cpu_util_percent": 38.7, "ram_util_percent": 79.7}}
{"timers": {"training_iteration": 1.797724078825228, "restore_env_runners": 3.808231833582627e-05, "training_step": 1.7973650046438217, "env_runner_sampling_timer": 1.6819684405574067, "learner_update_timer": 0.1120061316701463, "synch_weights": 0.0006671347856973474, "restore_eval_env_runners": 1.0260174456168897e-05, "evaluation_iteration": 0.13960223077812525, "synch_eval_env_connectors": 0.0001461363738949876, "synch_env_connectors": 4.853572142659686e-06}, "env_runners": {"env_to_module_sum_episodes_length_in": 10.36823839457432, "episode_return_min": -13.5, "module_to_env_connector": {"timers": {"connectors": {"get_actions": 6.701336338603886e-05, "un_batch_to_individual_items": 6.670263425776764e-06, "tensor_to_numpy": 2.1670209529123955e-05, "normalize_and_clip_actions": 1.2230828251207341e-05, "remove_single_ts_time_rank_from_batch": 6.769961271852617e-07, "listify_data_for_vector_env": 1.3182614649276377e-05}}, "connector_pipeline_timer": 0.00016404574077405286}, "env_reset_timer": 4.361217958918303e-05, "env_to_module_connector": {"timers": {"connectors": {"numpy_to_tensor": 1.0840919153485572e-05, "batch_individual_items": 7.997168607430934e-06, "add_states_from_episodes_to_batch": 1.9877058637632917e-06, "add_time_dim_to_batch_and_zero_pad": 2.8287852132845742e-06, "add_observations_from_episodes_to_batch": 3.53123143484766e-06}}, "connector_pipeline_timer": 5.229444839075827e-05}, "num_agent_steps_sampled_lifetime": {"default_agent": -1842500.0}, "agent_episode_returns_mean": {"default_agent": -1.0199999999999996}, "num_episodes": 250.0, "num_env_steps_sampled_lifetime": -1842500.0, "episode_len_max": 20, "rlmodule_inference_timer": 7.205595559452998e-05, "weights_seq_no": 4.0, "episode_len_min": 20, "num_env_steps_sampled": 5000.0, "time_between_sampling": 0.0016453446359799046, "episode_len_mean": 20.0, "episode_duration_sec_mean": 0.007001307365950196, "env_step_timer": 1.7187150174256517e-05, "num_agent_steps_sampled": {"default_agent": 5000.0}, "num_episodes_lifetime": -92125.0, "module_episode_returns_mean": {"default_policy": -1.0199999999999996}, "num_module_steps_sampled": {"default_policy": 5000.0}, "episode_return_max": 6.5, "sample": 0.005657275827736266, "episode_return_mean": -1.0199999999999996, "env_to_module_sum_episodes_length_out": 10.36823839457432, "num_module_steps_sampled_lifetime": {"default_policy": -1842500.0}, "num_env_steps_sampled_lifetime_throughput": 3222.02373604879}, "learners": {"default_policy": {"num_trainable_parameters": 6003, "diff_num_grad_updates_vs_sampler_policy": 1.0, "gradients_default_optimizer_global_norm": 0.16659164428710938, "default_optimizer_learning_rate": 0.0002847858517, "module_train_batch_size_mean": 1000.0, "vf_loss_unclipped": 29.599639892578125, "curr_entropy_coeff": 0.0090570820258, "num_module_steps_trained": 6000, "total_loss": 0.17368201911449432, "vf_explained_var": -0.012921690940856934, "num_module_steps_trained_lifetime": 30000, "curr_kl_coeff": 0.023328009992837906, "policy_loss": 0.11087483167648315, "mean_kl_loss": 0.0017101932317018509, "entropy": 0.6639235019683838, "vf_loss": 0.10278083384037018, "weights_seq_no": 5.0, "num_module_steps_trained_lifetime_throughput": 348934.7600490085}, "__all_modules__": {"learner_connector": {"timers": {"connectors": {"add_observations_from_episodes_to_batch": 0.0008707638668064482, "general_advantage_estimation": 0.00684309961564202, "batch_individual_items": 0.03190952037147461, "numpy_to_tensor": 8.040442287129466e-05, "add_one_ts_to_episodes_and_truncate": 0.008204082762788608, "add_time_dim_to_batch_and_zero_pad": 1.2069475360140203e-05, "add_columns_from_episodes_to_train_batch": 0.03428675092806993, "add_states_from_episodes_to_batch": 4.294392039077358e-06}}, "connector_pipeline_timer": 0.08236384931881764}, "learner_connector_sum_episodes_length_in": 5000.0, "num_trainable_parameters": 6003, "num_env_steps_trained": 31500, "num_module_steps_trained": 6000, "learner_connector_sum_episodes_length_out": 5250.0, "num_non_trainable_parameters": 0, "num_module_steps_trained_lifetime": 30000, "num_env_steps_trained_lifetime": 157500, "num_env_steps_trained_lifetime_throughput": 1821982.8128779577, "num_module_steps_trained_throughput": 348335.02630912344, "num_module_steps_trained_lifetime_throughput": 347830.4455184436}}, "num_training_step_calls_per_iteration": 1, "evaluation": {"env_runners": {"num_agent_steps_sampled_lifetime": {"default_agent": 2000}, "env_to_module_sum_episodes_length_in": 10.368238387501162, "agent_episode_returns_mean": {"default_agent": 0.3}, "env_to_module_connector": {"timers": {"connectors": {"add_observations_from_episodes_to_batch": 3.0016494763725493e-06, "batch_individual_items": 6.7028792366768745e-06, "numpy_to_tensor": 9.21851783930218e-06, "add_time_dim_to_batch_and_zero_pad": 2.4124201642640895e-06, "add_states_from_episodes_to_batch": 1.6818715144198752e-06}}, "connector_pipeline_timer": 4.599226434485265e-05}, "module_to_env_connector": {"connector_pipeline_timer": 0.00011207447645892415, "timers": {"connectors": {"remove_single_ts_time_rank_from_batch": 6.177963132054045e-07, "listify_data_for_vector_env": 1.2296329785359444e-05, "tensor_to_numpy": 1.4252588981681006e-05, "normalize_and_clip_actions": 1.0032169452053483e-05, "un_batch_to_individual_items": 5.980057810393994e-06, "get_actions": 4.1373049055792176e-05}}}, "episode_duration_sec_mean": 0.004936516317538917, "sample": 0.12539257009482993, "num_episodes": 20, "episode_len_min": 20, "num_module_steps_sampled": {"default_policy": 400}, "num_env_steps_sampled": 400, "num_episodes_lifetime": 100, "env_to_module_sum_episodes_length_out": 10.368238387501162, "episode_return_min": -15.5, "module_episode_returns_mean": {"default_policy": 0.3}, "num_env_steps_sampled_lifetime": 25400, "rlmodule_inference_timer": 3.134064364601032e-05, "weights_seq_no": 5.0, "num_module_steps_sampled_lifetime": {"default_policy": 2000}, "env_step_timer": 1.5741120342343506e-05, "episode_return_max": 13.5, "episode_return_mean": 0.3, "env_reset_timer": 0.00252152866299973, "episode_len_max": 20, "num_agent_steps_sampled": {"default_agent": 400}, "episode_len_mean": 20.0, "time_between_sampling": 1.749877869743287}, "num_healthy_workers": 1, "actor_manager_num_outstanding_async_reqs": 0, "num_remote_worker_restarts": 0}, "num_env_steps_sampled_lifetime": -1842500.0, "fault_tolerance": {"num_healthy_workers": 0, "num_remote_worker_restarts": 0}, "env_runner_group": {"actor_manager_num_outstanding_async_reqs": 0}, "done": false, "training_iteration": 5, "trial_id": "5029b_00000", "date": "2025-08-11_19-21-44", "timestamp": 1754932904, "time_this_iter_s": 2.3238792419433594, "time_total_s": 9.288126230239868, "pid": 14328, "hostname": "Mac", "node_ip": "127.0.0.1", "config": {"exploration_config": {}, "extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "placement_strategy": "PACK", "num_gpus": 0, "_fake_gpus": false, "num_cpus_for_main_process": 2, "eager_tracing": true, "eager_max_retraces": 20, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "torch_compile_learner": false, "torch_compile_learner_what_to_compile": "forward_train", "torch_compile_learner_dynamo_backend": "aot_eager", "torch_compile_learner_dynamo_mode": null, "torch_compile_worker": false, "torch_compile_worker_dynamo_backend": "aot_eager", "torch_compile_worker_dynamo_mode": null, "torch_ddp_kwargs": {}, "torch_skip_nan_gradients": false, "env": "Umbrella", "env_config": {}, "observation_space": null, "action_space": null, "clip_rewards": null, "normalize_actions": true, "clip_actions": false, "_is_atari": null, "disable_env_checking": false, "render_env": false, "action_mask_key": "action_mask", "env_runner_cls": null, "num_env_runners": 0, "create_local_env_runner": true, "num_envs_per_env_runner": 1, "gym_env_vectorize_mode": "SYNC", "num_cpus_per_env_runner": 1, "num_gpus_per_env_runner": 0, "custom_resources_per_env_runner": {}, "validate_env_runners_after_construction": true, "episodes_to_numpy": true, "max_requests_in_flight_per_env_runner": 1, "sample_timeout_s": 60.0, "_env_to_module_connector": null, "add_default_connectors_to_env_to_module_pipeline": true, "_module_to_env_connector": null, "add_default_connectors_to_module_to_env_pipeline": true, "merge_env_runner_states": "training_only", "broadcast_env_runner_states": true, "episode_lookback_horizon": 1, "rollout_fragment_length": "auto", "batch_mode": "complete_episodes", "compress_observations": false, "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "enable_tf1_exec_eagerly": false, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "preprocessor_pref": "deepmind", "observation_filter": "NoFilter", "update_worker_filter_stats": true, "use_worker_filter_stats": true, "sampler_perf_stats_ema_coef": null, "_is_online": true, "num_learners": 0, "num_gpus_per_learner": 0, "num_cpus_per_learner": "auto", "num_aggregator_actors_per_learner": 0, "max_requests_in_flight_per_aggregator_actor": 3, "local_gpu_idx": 0, "max_requests_in_flight_per_learner": 3, "gamma": 1, "lr": 0.0002847858517, "grad_clip": 0.5, "grad_clip_by": "global_norm", "_train_batch_size_per_learner": 5000, "train_batch_size": 4000, "num_epochs": 1, "minibatch_size": 1000, "shuffle_batch_per_epoch": true, "model": {"fcnet_hiddens": [256, 256], "fcnet_activation": "tanh", "fcnet_weights_initializer": null, "fcnet_weights_initializer_config": null, "fcnet_bias_initializer": null, "fcnet_bias_initializer_config": null, "conv_filters": null, "conv_activation": "relu", "conv_kernel_initializer": null, "conv_kernel_initializer_config": null, "conv_bias_initializer": null, "conv_bias_initializer_config": null, "conv_transpose_kernel_initializer": null, "conv_transpose_kernel_initializer_config": null, "conv_transpose_bias_initializer": null, "conv_transpose_bias_initializer_config": null, "post_fcnet_hiddens": [], "post_fcnet_activation": "relu", "post_fcnet_weights_initializer": null, "post_fcnet_weights_initializer_config": null, "post_fcnet_bias_initializer": null, "post_fcnet_bias_initializer_config": null, "free_log_std": false, "log_std_clip_param": 20.0, "no_final_linear": false, "vf_share_layers": false, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "lstm_weights_initializer": null, "lstm_weights_initializer_config": null, "lstm_bias_initializer": null, "lstm_bias_initializer_config": null, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "attention_use_n_prev_actions": 0, "attention_use_n_prev_rewards": 0, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": null, "custom_model_config": {}, "custom_action_dist": null, "custom_preprocessor": null, "encoder_latent_dim": null, "always_check_shapes": false, "lstm_use_prev_action_reward": -1, "_use_default_native_models": -1, "_disable_preprocessor_api": false, "_disable_action_flattening": false}, "_learner_connector": null, "add_default_connectors_to_learner_pipeline": true, "learner_config_dict": {}, "optimizer": {}, "_learner_class": null, "callbacks_on_algorithm_init": null, "callbacks_on_env_runners_recreated": null, "callbacks_on_offline_eval_runners_recreated": null, "callbacks_on_checkpoint_loaded": null, "callbacks_on_environment_created": null, "callbacks_on_episode_created": null, "callbacks_on_episode_start": null, "callbacks_on_episode_step": null, "callbacks_on_episode_end": null, "callbacks_on_evaluate_start": null, "callbacks_on_evaluate_end": null, "callbacks_on_evaluate_offline_start": null, "callbacks_on_evaluate_offline_end": null, "callbacks_on_sample_end": null, "callbacks_on_train_result": null, "explore": true, "enable_rl_module_and_learner": true, "enable_env_runner_and_connector_v2": true, "_prior_exploration_config": {"type": "StochasticSampling"}, "count_steps_by": "env_steps", "policy_map_capacity": 100, "policy_mapping_fn": "<function AlgorithmConfig.DEFAULT_POLICY_MAPPING_FN at 0x157405b20>", "policies_to_train": null, "policy_states_are_swappable": false, "observation_fn": null, "offline_data_class": null, "input_read_method": "read_parquet", "input_read_method_kwargs": {}, "input_read_schema": {}, "input_read_episodes": false, "input_read_sample_batches": false, "input_read_batch_size": null, "input_filesystem": null, "input_filesystem_kwargs": {}, "input_compress_columns": ["obs", "new_obs"], "input_spaces_jsonable": true, "materialize_data": false, "materialize_mapped_data": true, "map_batches_kwargs": {}, "iter_batches_kwargs": {}, "ignore_final_observation": false, "prelearner_class": null, "prelearner_buffer_class": null, "prelearner_buffer_kwargs": {}, "prelearner_module_synch_period": 10, "dataset_num_iters_per_learner": null, "input_config": {}, "actions_in_input_normalized": false, "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_config": {}, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "output_max_rows_per_file": null, "output_write_remaining_data": false, "output_write_method": "write_parquet", "output_write_method_kwargs": {}, "output_filesystem": null, "output_filesystem_kwargs": {}, "output_write_episodes": true, "offline_sampling": false, "evaluation_interval": 1, "evaluation_duration": 20, "evaluation_duration_unit": "episodes", "evaluation_sample_timeout_s": 120.0, "evaluation_auto_duration_min_env_steps_per_sample": 100, "evaluation_auto_duration_max_env_steps_per_sample": 2000, "evaluation_parallel_to_training": false, "evaluation_force_reset_envs_before_iteration": true, "evaluation_config": null, "off_policy_estimation_methods": {}, "ope_split_batch_by_episode": true, "evaluation_num_env_runners": 1, "in_evaluation": false, "sync_filters_on_rollout_workers_timeout_s": 10.0, "offline_evaluation_interval": null, "num_offline_eval_runners": 0, "offline_loss_for_module_fn": null, "offline_evaluation_duration": 1, "offline_evaluation_parallel_to_training": false, "offline_evaluation_timeout_s": 120.0, "num_cpus_per_offline_eval_runner": 1, "num_gpus_per_offline_eval_runner": 0, "custom_resources_per_offline_eval_runner": {}, "restart_failed_offline_eval_runners": true, "ignore_offline_eval_runner_failures": false, "max_num_offline_eval_runner_restarts": 1000, "offline_eval_runner_restore_timeout_s": 1800.0, "max_requests_in_flight_per_offline_eval_runner": 1, "validate_offline_eval_runners_after_construction": true, "offline_eval_runner_health_probe_timeout_s": 30.0, "offline_eval_rl_module_inference_only": false, "broadcast_offline_eval_runner_states": false, "offline_eval_batch_size_per_runner": 256, "dataset_num_iters_per_eval_runner": 1, "keep_per_episode_custom_metrics": false, "metrics_episode_collection_timeout_s": 60.0, "metrics_num_episodes_for_smoothing": 100, "min_time_s_per_iteration": null, "min_train_timesteps_per_iteration": 0, "min_sample_timesteps_per_iteration": 0, "log_gradients": true, "export_native_model_files": false, "checkpoint_trainable_policies_only": false, "logger_creator": null, "logger_config": null, "log_level": "WARN", "log_sys_usage": true, "fake_sampler": false, "seed": 5, "restart_failed_env_runners": true, "ignore_env_runner_failures": false, "max_num_env_runner_restarts": 1000, "delay_between_env_runner_restarts_s": 60.0, "restart_failed_sub_environments": false, "num_consecutive_env_runner_failures_tolerance": 100, "env_runner_health_probe_timeout_s": 30.0, "env_runner_restore_timeout_s": 1800.0, "_model_config": {}, "_rl_module_spec": "RLModuleSpec(module_class=None, observation_space=None, action_space=None, inference_only=False, learner_only=False, model_config=DefaultModelConfig(fcnet_hiddens=[60, 90], fcnet_activation='tanh', fcnet_kernel_initializer=None, fcnet_kernel_initializer_kwargs=None, fcnet_bias_initializer=None, fcnet_bias_initializer_kwargs=None, conv_filters=None, conv_activation='relu', conv_kernel_initializer=None, conv_kernel_initializer_kwargs=None, conv_bias_initializer=None, conv_bias_initializer_kwargs=None, head_fcnet_hiddens=[], head_fcnet_activation='relu', head_fcnet_kernel_initializer=None, head_fcnet_kernel_initializer_kwargs=None, head_fcnet_bias_initializer=None, head_fcnet_bias_initializer_kwargs=None, free_log_std=False, log_std_clip_param=20.0, vf_share_layers=True, use_lstm=False, max_seq_len=20, lstm_cell_size=256, lstm_use_prev_action=False, lstm_use_prev_reward=False, lstm_kernel_initializer=None, lstm_kernel_initializer_kwargs=None, lstm_bias_initializer=None, lstm_bias_initializer_kwargs=None), catalog_class=None, load_state_path=None, model_config_dict=None)", "algorithm_config_overrides_per_module": {}, "_per_module_overrides": {}, "_validate_config": true, "_use_msgpack_checkpoints": false, "_torch_grad_scaler_class": null, "_torch_lr_scheduler_classes": null, "_tf_policy_handles_more_than_one_loss": false, "_disable_preprocessor_api": false, "_disable_action_flattening": false, "_disable_initialize_loss_from_dummy_batch": false, "_dont_auto_sync_env_runner_states": false, "env_task_fn": -1, "enable_connectors": -1, "simple_optimizer": false, "policy_map_cache": -1, "worker_cls": -1, "synchronize_filters": -1, "enable_async_evaluation": -1, "custom_async_evaluation_function": -1, "_enable_rl_module_api": -1, "auto_wrap_old_gym_envs": -1, "always_attach_evaluation_results": -1, "replay_sequence_length": null, "_disable_execution_plan_api": -1, "use_critic": true, "use_gae": true, "use_kl_loss": true, "kl_coeff": 0.7464963036515, "kl_target": 0.0270990929592, "vf_loss_coeff": 0.6688075857018, "entropy_coeff": 0.0090570820258, "clip_param": 0.1221781641624, "vf_clip_param": 0.1027808522125, "entropy_coeff_schedule": null, "lr_schedule": null, "sgd_minibatch_size": -1, "vf_share_layers": -1, "__stdout_file__": null, "__stderr_file__": null, "lambda": 0.9099046732075, "input": "sampler", "policies": {"default_policy": [null, null, null, null]}, "callbacks": "<class 'ray.rllib.callbacks.callbacks.RLlibCallback'>", "create_env_on_driver": false, "custom_eval_function": null, "framework": "torch"}, "time_since_restore": 9.288126230239868, "iterations_since_restore": 5, "perf": {"cpu_util_percent": 36.3, "ram_util_percent": 80.96666666666667}}
{"timers": {"training_iteration": 1.7956353126264222, "restore_env_runners": 3.7761494445184394e-05, "training_step": 1.7952778275173393, "env_runner_sampling_timer": 1.6791394353220703, "learner_update_timer": 0.11274936576373892, "synch_weights": 0.0006663817681204842, "restore_eval_env_runners": 1.0251742229586234e-05, "evaluation_iteration": 0.13952774180082736, "synch_eval_env_connectors": 0.00014659542990118495, "synch_env_connectors": 4.84586676705745e-06}, "env_runners": {"env_to_module_sum_episodes_length_in": 10.36823839457432, "episode_return_min": -13.5, "module_to_env_connector": {"timers": {"connectors": {"get_actions": 4.0304921376325834e-05, "un_batch_to_individual_items": 5.428598367464609e-06, "tensor_to_numpy": 1.331084382108266e-05, "normalize_and_clip_actions": 9.462202421286085e-06, "remove_single_ts_time_rank_from_batch": 5.932581857365747e-07, "listify_data_for_vector_env": 1.0986486655038156e-05}}, "connector_pipeline_timer": 0.00010601793212631306}, "env_reset_timer": 4.735832818822695e-05, "env_to_module_connector": {"timers": {"connectors": {"numpy_to_tensor": 8.596324068961321e-06, "batch_individual_items": 6.318892844126925e-06, "add_states_from_episodes_to_batch": 1.7271813670816663e-06, "add_time_dim_to_batch_and_zero_pad": 2.3494239266910354e-06, "add_observations_from_episodes_to_batch": 2.999301676018448e-06}}, "connector_pipeline_timer": 4.396129569942249e-05}, "num_agent_steps_sampled_lifetime": {"default_agent": -2460000.0}, "agent_episode_returns_mean": {"default_agent": 0.5}, "num_episodes": 250.0, "num_env_steps_sampled_lifetime": -2460000.0, "episode_len_max": 20, "rlmodule_inference_timer": 2.8884888228259508e-05, "weights_seq_no": 5.0, "episode_len_min": 20, "num_env_steps_sampled": 5000.0, "time_between_sampling": 0.0018357771691821607, "episode_len_mean": 20.0, "episode_duration_sec_mean": 0.004597750836052002, "env_step_timer": 1.3813603303879498e-05, "num_agent_steps_sampled": {"default_agent": 5000.0}, "num_episodes_lifetime": -123000.0, "module_episode_returns_mean": {"default_policy": 0.5}, "num_module_steps_sampled": {"default_policy": 5000.0}, "episode_return_max": 6.5, "sample": 0.006507618340772261, "episode_return_mean": 0.5, "env_to_module_sum_episodes_length_out": 10.36823839457432, "num_module_steps_sampled_lifetime": {"default_policy": -2460000.0}, "num_env_steps_sampled_lifetime_throughput": 3623.6562748462147}, "learners": {"default_policy": {"num_trainable_parameters": 6003, "diff_num_grad_updates_vs_sampler_policy": 1.0, "gradients_default_optimizer_global_norm": 0.017227962613105774, "default_optimizer_learning_rate": 0.0002847858517, "module_train_batch_size_mean": 1000.0, "vf_loss_unclipped": 28.372112274169922, "curr_entropy_coeff": 0.0090570820258, "num_module_steps_trained": 6000, "total_loss": 0.20755812525749207, "vf_explained_var": -0.013740062713623047, "num_module_steps_trained_lifetime": 36000, "curr_kl_coeff": 0.011664004996418953, "policy_loss": 0.14476658403873444, "mean_kl_loss": 9.704682452138513e-05, "entropy": 0.6570912599563599, "vf_loss": 0.10278083384037018, "weights_seq_no": 6.0, "num_module_steps_trained_lifetime_throughput": 349267.25085906486}, "__all_modules__": {"learner_connector": {"timers": {"connectors": {"add_observations_from_episodes_to_batch": 0.0008707712281419601, "general_advantage_estimation": 0.006832438620489119, "batch_individual_items": 0.03281759308820217, "numpy_to_tensor": 8.033662871902466e-05, "add_one_ts_to_episodes_and_truncate": 0.008199762774923782, "add_time_dim_to_batch_and_zero_pad": 1.203836103253141e-05, "add_columns_from_episodes_to_train_batch": 0.03427966550875838, "add_states_from_episodes_to_batch": 4.278947746008543e-06}}, "connector_pipeline_timer": 0.0832493029162343}, "learner_connector_sum_episodes_length_in": 5000.0, "num_trainable_parameters": 6003, "num_env_steps_trained": 31500, "num_module_steps_trained": 6000, "learner_connector_sum_episodes_length_out": 5250.0, "num_non_trainable_parameters": 0, "num_module_steps_trained_lifetime": 36000, "num_env_steps_trained_lifetime": 189000, "num_env_steps_trained_lifetime_throughput": 1824195.0270116641, "num_module_steps_trained_throughput": 348712.39835985354, "num_module_steps_trained_lifetime_throughput": 348222.7383316121}}, "num_training_step_calls_per_iteration": 1, "evaluation": {"env_runners": {"num_agent_steps_sampled_lifetime": {"default_agent": 2400}, "env_to_module_sum_episodes_length_in": 10.368238394470474, "agent_episode_returns_mean": {"default_agent": -0.5}, "env_to_module_connector": {"timers": {"connectors": {"add_observations_from_episodes_to_batch": 2.7549911859363754e-06, "batch_individual_items": 6.017948866785649e-06, "numpy_to_tensor": 8.19002356864801e-06, "add_time_dim_to_batch_and_zero_pad": 2.232808561654274e-06, "add_states_from_episodes_to_batch": 1.5583687671619388e-06}}, "connector_pipeline_timer": 4.2403561125338835e-05}, "module_to_env_connector": {"connector_pipeline_timer": 0.0001004319807791713, "timers": {"connectors": {"remove_single_ts_time_rank_from_batch": 5.955977733157883e-07, "listify_data_for_vector_env": 1.0902608198287326e-05, "tensor_to_numpy": 1.2876940626119597e-05, "normalize_and_clip_actions": 9.278230072816282e-06, "un_batch_to_individual_items": 5.296031661262903e-06, "get_actions": 3.56009401762274e-05}}}, "episode_duration_sec_mean": 0.004740189203293994, "sample": 0.1251146843939776, "num_episodes": 20, "episode_len_min": 20, "num_module_steps_sampled": {"default_policy": 400}, "num_env_steps_sampled": 400, "num_episodes_lifetime": 120, "env_to_module_sum_episodes_length_out": 10.368238394470474, "episode_return_min": -15.5, "module_episode_returns_mean": {"default_policy": -0.5}, "num_env_steps_sampled_lifetime": 30400, "rlmodule_inference_timer": 2.664805900345365e-05, "weights_seq_no": 6.0, "num_module_steps_sampled_lifetime": {"default_policy": 2400}, "env_step_timer": 1.3843065311747595e-05, "episode_return_max": 13.5, "episode_return_mean": -0.5, "env_reset_timer": 0.002497121706156838, "episode_len_max": 20, "num_agent_steps_sampled": {"default_agent": 400}, "episode_len_mean": 20.0, "time_between_sampling": 1.748474458965042}, "num_healthy_workers": 1, "actor_manager_num_outstanding_async_reqs": 0, "num_remote_worker_restarts": 0}, "num_env_steps_sampled_lifetime": -2460000.0, "fault_tolerance": {"num_healthy_workers": 0, "num_remote_worker_restarts": 0}, "env_runner_group": {"actor_manager_num_outstanding_async_reqs": 0}, "done": false, "training_iteration": 6, "trial_id": "5029b_00000", "date": "2025-08-11_19-21-46", "timestamp": 1754932906, "time_this_iter_s": 1.6942219734191895, "time_total_s": 10.982348203659058, "pid": 14328, "hostname": "Mac", "node_ip": "127.0.0.1", "config": {"exploration_config": {}, "extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "placement_strategy": "PACK", "num_gpus": 0, "_fake_gpus": false, "num_cpus_for_main_process": 2, "eager_tracing": true, "eager_max_retraces": 20, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "torch_compile_learner": false, "torch_compile_learner_what_to_compile": "forward_train", "torch_compile_learner_dynamo_backend": "aot_eager", "torch_compile_learner_dynamo_mode": null, "torch_compile_worker": false, "torch_compile_worker_dynamo_backend": "aot_eager", "torch_compile_worker_dynamo_mode": null, "torch_ddp_kwargs": {}, "torch_skip_nan_gradients": false, "env": "Umbrella", "env_config": {}, "observation_space": null, "action_space": null, "clip_rewards": null, "normalize_actions": true, "clip_actions": false, "_is_atari": null, "disable_env_checking": false, "render_env": false, "action_mask_key": "action_mask", "env_runner_cls": null, "num_env_runners": 0, "create_local_env_runner": true, "num_envs_per_env_runner": 1, "gym_env_vectorize_mode": "SYNC", "num_cpus_per_env_runner": 1, "num_gpus_per_env_runner": 0, "custom_resources_per_env_runner": {}, "validate_env_runners_after_construction": true, "episodes_to_numpy": true, "max_requests_in_flight_per_env_runner": 1, "sample_timeout_s": 60.0, "_env_to_module_connector": null, "add_default_connectors_to_env_to_module_pipeline": true, "_module_to_env_connector": null, "add_default_connectors_to_module_to_env_pipeline": true, "merge_env_runner_states": "training_only", "broadcast_env_runner_states": true, "episode_lookback_horizon": 1, "rollout_fragment_length": "auto", "batch_mode": "complete_episodes", "compress_observations": false, "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "enable_tf1_exec_eagerly": false, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "preprocessor_pref": "deepmind", "observation_filter": "NoFilter", "update_worker_filter_stats": true, "use_worker_filter_stats": true, "sampler_perf_stats_ema_coef": null, "_is_online": true, "num_learners": 0, "num_gpus_per_learner": 0, "num_cpus_per_learner": "auto", "num_aggregator_actors_per_learner": 0, "max_requests_in_flight_per_aggregator_actor": 3, "local_gpu_idx": 0, "max_requests_in_flight_per_learner": 3, "gamma": 1, "lr": 0.0002847858517, "grad_clip": 0.5, "grad_clip_by": "global_norm", "_train_batch_size_per_learner": 5000, "train_batch_size": 4000, "num_epochs": 1, "minibatch_size": 1000, "shuffle_batch_per_epoch": true, "model": {"fcnet_hiddens": [256, 256], "fcnet_activation": "tanh", "fcnet_weights_initializer": null, "fcnet_weights_initializer_config": null, "fcnet_bias_initializer": null, "fcnet_bias_initializer_config": null, "conv_filters": null, "conv_activation": "relu", "conv_kernel_initializer": null, "conv_kernel_initializer_config": null, "conv_bias_initializer": null, "conv_bias_initializer_config": null, "conv_transpose_kernel_initializer": null, "conv_transpose_kernel_initializer_config": null, "conv_transpose_bias_initializer": null, "conv_transpose_bias_initializer_config": null, "post_fcnet_hiddens": [], "post_fcnet_activation": "relu", "post_fcnet_weights_initializer": null, "post_fcnet_weights_initializer_config": null, "post_fcnet_bias_initializer": null, "post_fcnet_bias_initializer_config": null, "free_log_std": false, "log_std_clip_param": 20.0, "no_final_linear": false, "vf_share_layers": false, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "lstm_weights_initializer": null, "lstm_weights_initializer_config": null, "lstm_bias_initializer": null, "lstm_bias_initializer_config": null, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "attention_use_n_prev_actions": 0, "attention_use_n_prev_rewards": 0, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": null, "custom_model_config": {}, "custom_action_dist": null, "custom_preprocessor": null, "encoder_latent_dim": null, "always_check_shapes": false, "lstm_use_prev_action_reward": -1, "_use_default_native_models": -1, "_disable_preprocessor_api": false, "_disable_action_flattening": false}, "_learner_connector": null, "add_default_connectors_to_learner_pipeline": true, "learner_config_dict": {}, "optimizer": {}, "_learner_class": null, "callbacks_on_algorithm_init": null, "callbacks_on_env_runners_recreated": null, "callbacks_on_offline_eval_runners_recreated": null, "callbacks_on_checkpoint_loaded": null, "callbacks_on_environment_created": null, "callbacks_on_episode_created": null, "callbacks_on_episode_start": null, "callbacks_on_episode_step": null, "callbacks_on_episode_end": null, "callbacks_on_evaluate_start": null, "callbacks_on_evaluate_end": null, "callbacks_on_evaluate_offline_start": null, "callbacks_on_evaluate_offline_end": null, "callbacks_on_sample_end": null, "callbacks_on_train_result": null, "explore": true, "enable_rl_module_and_learner": true, "enable_env_runner_and_connector_v2": true, "_prior_exploration_config": {"type": "StochasticSampling"}, "count_steps_by": "env_steps", "policy_map_capacity": 100, "policy_mapping_fn": "<function AlgorithmConfig.DEFAULT_POLICY_MAPPING_FN at 0x157405b20>", "policies_to_train": null, "policy_states_are_swappable": false, "observation_fn": null, "offline_data_class": null, "input_read_method": "read_parquet", "input_read_method_kwargs": {}, "input_read_schema": {}, "input_read_episodes": false, "input_read_sample_batches": false, "input_read_batch_size": null, "input_filesystem": null, "input_filesystem_kwargs": {}, "input_compress_columns": ["obs", "new_obs"], "input_spaces_jsonable": true, "materialize_data": false, "materialize_mapped_data": true, "map_batches_kwargs": {}, "iter_batches_kwargs": {}, "ignore_final_observation": false, "prelearner_class": null, "prelearner_buffer_class": null, "prelearner_buffer_kwargs": {}, "prelearner_module_synch_period": 10, "dataset_num_iters_per_learner": null, "input_config": {}, "actions_in_input_normalized": false, "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_config": {}, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "output_max_rows_per_file": null, "output_write_remaining_data": false, "output_write_method": "write_parquet", "output_write_method_kwargs": {}, "output_filesystem": null, "output_filesystem_kwargs": {}, "output_write_episodes": true, "offline_sampling": false, "evaluation_interval": 1, "evaluation_duration": 20, "evaluation_duration_unit": "episodes", "evaluation_sample_timeout_s": 120.0, "evaluation_auto_duration_min_env_steps_per_sample": 100, "evaluation_auto_duration_max_env_steps_per_sample": 2000, "evaluation_parallel_to_training": false, "evaluation_force_reset_envs_before_iteration": true, "evaluation_config": null, "off_policy_estimation_methods": {}, "ope_split_batch_by_episode": true, "evaluation_num_env_runners": 1, "in_evaluation": false, "sync_filters_on_rollout_workers_timeout_s": 10.0, "offline_evaluation_interval": null, "num_offline_eval_runners": 0, "offline_loss_for_module_fn": null, "offline_evaluation_duration": 1, "offline_evaluation_parallel_to_training": false, "offline_evaluation_timeout_s": 120.0, "num_cpus_per_offline_eval_runner": 1, "num_gpus_per_offline_eval_runner": 0, "custom_resources_per_offline_eval_runner": {}, "restart_failed_offline_eval_runners": true, "ignore_offline_eval_runner_failures": false, "max_num_offline_eval_runner_restarts": 1000, "offline_eval_runner_restore_timeout_s": 1800.0, "max_requests_in_flight_per_offline_eval_runner": 1, "validate_offline_eval_runners_after_construction": true, "offline_eval_runner_health_probe_timeout_s": 30.0, "offline_eval_rl_module_inference_only": false, "broadcast_offline_eval_runner_states": false, "offline_eval_batch_size_per_runner": 256, "dataset_num_iters_per_eval_runner": 1, "keep_per_episode_custom_metrics": false, "metrics_episode_collection_timeout_s": 60.0, "metrics_num_episodes_for_smoothing": 100, "min_time_s_per_iteration": null, "min_train_timesteps_per_iteration": 0, "min_sample_timesteps_per_iteration": 0, "log_gradients": true, "export_native_model_files": false, "checkpoint_trainable_policies_only": false, "logger_creator": null, "logger_config": null, "log_level": "WARN", "log_sys_usage": true, "fake_sampler": false, "seed": 5, "restart_failed_env_runners": true, "ignore_env_runner_failures": false, "max_num_env_runner_restarts": 1000, "delay_between_env_runner_restarts_s": 60.0, "restart_failed_sub_environments": false, "num_consecutive_env_runner_failures_tolerance": 100, "env_runner_health_probe_timeout_s": 30.0, "env_runner_restore_timeout_s": 1800.0, "_model_config": {}, "_rl_module_spec": "RLModuleSpec(module_class=None, observation_space=None, action_space=None, inference_only=False, learner_only=False, model_config=DefaultModelConfig(fcnet_hiddens=[60, 90], fcnet_activation='tanh', fcnet_kernel_initializer=None, fcnet_kernel_initializer_kwargs=None, fcnet_bias_initializer=None, fcnet_bias_initializer_kwargs=None, conv_filters=None, conv_activation='relu', conv_kernel_initializer=None, conv_kernel_initializer_kwargs=None, conv_bias_initializer=None, conv_bias_initializer_kwargs=None, head_fcnet_hiddens=[], head_fcnet_activation='relu', head_fcnet_kernel_initializer=None, head_fcnet_kernel_initializer_kwargs=None, head_fcnet_bias_initializer=None, head_fcnet_bias_initializer_kwargs=None, free_log_std=False, log_std_clip_param=20.0, vf_share_layers=True, use_lstm=False, max_seq_len=20, lstm_cell_size=256, lstm_use_prev_action=False, lstm_use_prev_reward=False, lstm_kernel_initializer=None, lstm_kernel_initializer_kwargs=None, lstm_bias_initializer=None, lstm_bias_initializer_kwargs=None), catalog_class=None, load_state_path=None, model_config_dict=None)", "algorithm_config_overrides_per_module": {}, "_per_module_overrides": {}, "_validate_config": true, "_use_msgpack_checkpoints": false, "_torch_grad_scaler_class": null, "_torch_lr_scheduler_classes": null, "_tf_policy_handles_more_than_one_loss": false, "_disable_preprocessor_api": false, "_disable_action_flattening": false, "_disable_initialize_loss_from_dummy_batch": false, "_dont_auto_sync_env_runner_states": false, "env_task_fn": -1, "enable_connectors": -1, "simple_optimizer": false, "policy_map_cache": -1, "worker_cls": -1, "synchronize_filters": -1, "enable_async_evaluation": -1, "custom_async_evaluation_function": -1, "_enable_rl_module_api": -1, "auto_wrap_old_gym_envs": -1, "always_attach_evaluation_results": -1, "replay_sequence_length": null, "_disable_execution_plan_api": -1, "use_critic": true, "use_gae": true, "use_kl_loss": true, "kl_coeff": 0.7464963036515, "kl_target": 0.0270990929592, "vf_loss_coeff": 0.6688075857018, "entropy_coeff": 0.0090570820258, "clip_param": 0.1221781641624, "vf_clip_param": 0.1027808522125, "entropy_coeff_schedule": null, "lr_schedule": null, "sgd_minibatch_size": -1, "vf_share_layers": -1, "__stdout_file__": null, "__stderr_file__": null, "lambda": 0.9099046732075, "input": "sampler", "policies": {"default_policy": [null, null, null, null]}, "callbacks": "<class 'ray.rllib.callbacks.callbacks.RLlibCallback'>", "create_env_on_driver": false, "custom_eval_function": null, "framework": "torch"}, "time_since_restore": 10.982348203659058, "iterations_since_restore": 6, "perf": {"cpu_util_percent": 52.65, "ram_util_percent": 79.8}}
{"timers": {"training_iteration": 1.7931260594994496, "restore_env_runners": 3.745221995125783e-05, "training_step": 1.7927702329928736, "env_runner_sampling_timer": 1.6767610467984055, "learner_update_timer": 0.11262179627525637, "synch_weights": 0.0006675071203431239, "restore_eval_env_runners": 1.0222554818509157e-05, "evaluation_iteration": 0.1391645860532515, "synch_eval_env_connectors": 0.00014621030571799803, "synch_env_connectors": 4.84073788217086e-06}, "env_runners": {"env_to_module_sum_episodes_length_in": 10.36823839457432, "episode_return_min": -13.5, "module_to_env_connector": {"timers": {"connectors": {"get_actions": 4.0974545597616095e-05, "un_batch_to_individual_items": 5.5663637710151676e-06, "tensor_to_numpy": 1.359779549774786e-05, "normalize_and_clip_actions": 9.68473024245215e-06, "remove_single_ts_time_rank_from_batch": 5.906382108710786e-07, "listify_data_for_vector_env": 1.1358857793826618e-05}}, "connector_pipeline_timer": 0.00010752647374629809}, "env_reset_timer": 3.918452838984003e-05, "env_to_module_connector": {"timers": {"connectors": {"numpy_to_tensor": 8.954611189756872e-06, "batch_individual_items": 6.625764998780831e-06, "add_states_from_episodes_to_batch": 1.7501474990267544e-06, "add_time_dim_to_batch_and_zero_pad": 2.3914338466700482e-06, "add_observations_from_episodes_to_batch": 3.0891727923065022e-06}}, "connector_pipeline_timer": 4.490202127306821e-05}, "num_agent_steps_sampled_lifetime": {"default_agent": -3077500.0}, "agent_episode_returns_mean": {"default_agent": 0.58}, "num_episodes": 250.0, "num_env_steps_sampled_lifetime": -3077500.0, "episode_len_max": 20, "rlmodule_inference_timer": 2.882626844491715e-05, "weights_seq_no": 6.0, "episode_len_min": 20, "num_env_steps_sampled": 5000.0, "time_between_sampling": 0.0018847122495650826, "episode_len_mean": 20.0, "episode_duration_sec_mean": 0.004710405526682733, "env_step_timer": 1.4307898430599756e-05, "num_agent_steps_sampled": {"default_agent": 5000.0}, "num_episodes_lifetime": -153875.0, "module_episode_returns_mean": {"default_policy": 0.58}, "num_module_steps_sampled": {"default_policy": 5000.0}, "episode_return_max": 6.5, "sample": 0.005105225879087187, "episode_return_mean": 0.58, "env_to_module_sum_episodes_length_out": 10.36823839457432, "num_module_steps_sampled_lifetime": {"default_policy": -3077500.0}, "num_env_steps_sampled_lifetime_throughput": 3615.337618287314}, "learners": {"default_policy": {"num_trainable_parameters": 6003, "diff_num_grad_updates_vs_sampler_policy": 1.0, "gradients_default_optimizer_global_norm": 0.058299656957387924, "default_optimizer_learning_rate": 0.0002847858517, "module_train_batch_size_mean": 1000.0, "vf_loss_unclipped": 26.70923614501953, "curr_entropy_coeff": 0.0090570820258, "num_module_steps_trained": 6000, "total_loss": 0.040499333292245865, "vf_explained_var": -0.016066908836364746, "num_module_steps_trained_lifetime": 42000, "curr_kl_coeff": 0.0058320024982094765, "policy_loss": -0.022446408867836, "mean_kl_loss": 0.0009009736822918057, "entropy": 0.640975832939148, "vf_loss": 0.10278083384037018, "weights_seq_no": 7.0, "num_module_steps_trained_lifetime_throughput": 350141.97018261306}, "__all_modules__": {"learner_connector": {"timers": {"connectors": {"add_observations_from_episodes_to_batch": 0.000870475175952492, "general_advantage_estimation": 0.0068399500643505804, "batch_individual_items": 0.03281772840693391, "numpy_to_tensor": 8.122117283961602e-05, "add_one_ts_to_episodes_and_truncate": 0.008196092226710937, "add_time_dim_to_batch_and_zero_pad": 1.2020057361303262e-05, "add_columns_from_episodes_to_train_batch": 0.034289574272734366, "add_states_from_episodes_to_batch": 4.2682388387843065e-06}}, "connector_pipeline_timer": 0.0832633294667172}, "learner_connector_sum_episodes_length_in": 5000.0, "num_trainable_parameters": 6003, "num_env_steps_trained": 31500, "num_module_steps_trained": 6000, "learner_connector_sum_episodes_length_out": 5250.0, "num_non_trainable_parameters": 0, "num_module_steps_trained_lifetime": 42000, "num_env_steps_trained_lifetime": 220500, "num_env_steps_trained_lifetime_throughput": 1829257.3075361757, "num_module_steps_trained_throughput": 349634.2778569263, "num_module_steps_trained_lifetime_throughput": 349158.9026829297}}, "num_training_step_calls_per_iteration": 1, "evaluation": {"env_runners": {"num_agent_steps_sampled_lifetime": {"default_agent": 2800}, "env_to_module_sum_episodes_length_in": 10.368238394572801, "agent_episode_returns_mean": {"default_agent": 0.3}, "env_to_module_connector": {"timers": {"connectors": {"add_observations_from_episodes_to_batch": 2.81418228420665e-06, "batch_individual_items": 6.090753151297353e-06, "numpy_to_tensor": 8.38278651396683e-06, "add_time_dim_to_batch_and_zero_pad": 2.3248501300405184e-06, "add_states_from_episodes_to_batch": 1.5961525770833591e-06}}, "connector_pipeline_timer": 4.310382895792414e-05}, "module_to_env_connector": {"connector_pipeline_timer": 0.00010380330264797807, "timers": {"connectors": {"remove_single_ts_time_rank_from_batch": 5.958780110583644e-07, "listify_data_for_vector_env": 1.1208905667121244e-05, "tensor_to_numpy": 1.3255836233255148e-05, "normalize_and_clip_actions": 9.739245111667689e-06, "un_batch_to_individual_items": 5.3813670906959745e-06, "get_actions": 3.680337613344676e-05}}}, "episode_duration_sec_mean": 0.004719475848833099, "sample": 0.1248597362996732, "num_episodes": 20, "episode_len_min": 20, "num_module_steps_sampled": {"default_policy": 400}, "num_env_steps_sampled": 400, "num_episodes_lifetime": 140, "env_to_module_sum_episodes_length_out": 10.368238394572801, "episode_return_min": -15.5, "module_episode_returns_mean": {"default_policy": 0.3}, "num_env_steps_sampled_lifetime": 35400, "rlmodule_inference_timer": 2.7499784957112228e-05, "weights_seq_no": 7.0, "num_module_steps_sampled_lifetime": {"default_policy": 2800}, "env_step_timer": 1.4949466115618368e-05, "episode_return_max": 13.5, "episode_return_mean": 0.3, "env_reset_timer": 0.0024728871594310244, "episode_len_max": 20, "num_agent_steps_sampled": {"default_agent": 400}, "episode_len_mean": 20.0, "time_between_sampling": 1.7466163735451847}, "num_healthy_workers": 1, "actor_manager_num_outstanding_async_reqs": 0, "num_remote_worker_restarts": 0}, "num_env_steps_sampled_lifetime": -3077500.0, "fault_tolerance": {"num_healthy_workers": 0, "num_remote_worker_restarts": 0}, "env_runner_group": {"actor_manager_num_outstanding_async_reqs": 0}, "done": false, "training_iteration": 7, "trial_id": "5029b_00000", "date": "2025-08-11_19-21-48", "timestamp": 1754932908, "time_this_iter_s": 1.651968002319336, "time_total_s": 12.634316205978394, "pid": 14328, "hostname": "Mac", "node_ip": "127.0.0.1", "config": {"exploration_config": {}, "extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "placement_strategy": "PACK", "num_gpus": 0, "_fake_gpus": false, "num_cpus_for_main_process": 2, "eager_tracing": true, "eager_max_retraces": 20, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "torch_compile_learner": false, "torch_compile_learner_what_to_compile": "forward_train", "torch_compile_learner_dynamo_backend": "aot_eager", "torch_compile_learner_dynamo_mode": null, "torch_compile_worker": false, "torch_compile_worker_dynamo_backend": "aot_eager", "torch_compile_worker_dynamo_mode": null, "torch_ddp_kwargs": {}, "torch_skip_nan_gradients": false, "env": "Umbrella", "env_config": {}, "observation_space": null, "action_space": null, "clip_rewards": null, "normalize_actions": true, "clip_actions": false, "_is_atari": null, "disable_env_checking": false, "render_env": false, "action_mask_key": "action_mask", "env_runner_cls": null, "num_env_runners": 0, "create_local_env_runner": true, "num_envs_per_env_runner": 1, "gym_env_vectorize_mode": "SYNC", "num_cpus_per_env_runner": 1, "num_gpus_per_env_runner": 0, "custom_resources_per_env_runner": {}, "validate_env_runners_after_construction": true, "episodes_to_numpy": true, "max_requests_in_flight_per_env_runner": 1, "sample_timeout_s": 60.0, "_env_to_module_connector": null, "add_default_connectors_to_env_to_module_pipeline": true, "_module_to_env_connector": null, "add_default_connectors_to_module_to_env_pipeline": true, "merge_env_runner_states": "training_only", "broadcast_env_runner_states": true, "episode_lookback_horizon": 1, "rollout_fragment_length": "auto", "batch_mode": "complete_episodes", "compress_observations": false, "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "enable_tf1_exec_eagerly": false, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "preprocessor_pref": "deepmind", "observation_filter": "NoFilter", "update_worker_filter_stats": true, "use_worker_filter_stats": true, "sampler_perf_stats_ema_coef": null, "_is_online": true, "num_learners": 0, "num_gpus_per_learner": 0, "num_cpus_per_learner": "auto", "num_aggregator_actors_per_learner": 0, "max_requests_in_flight_per_aggregator_actor": 3, "local_gpu_idx": 0, "max_requests_in_flight_per_learner": 3, "gamma": 1, "lr": 0.0002847858517, "grad_clip": 0.5, "grad_clip_by": "global_norm", "_train_batch_size_per_learner": 5000, "train_batch_size": 4000, "num_epochs": 1, "minibatch_size": 1000, "shuffle_batch_per_epoch": true, "model": {"fcnet_hiddens": [256, 256], "fcnet_activation": "tanh", "fcnet_weights_initializer": null, "fcnet_weights_initializer_config": null, "fcnet_bias_initializer": null, "fcnet_bias_initializer_config": null, "conv_filters": null, "conv_activation": "relu", "conv_kernel_initializer": null, "conv_kernel_initializer_config": null, "conv_bias_initializer": null, "conv_bias_initializer_config": null, "conv_transpose_kernel_initializer": null, "conv_transpose_kernel_initializer_config": null, "conv_transpose_bias_initializer": null, "conv_transpose_bias_initializer_config": null, "post_fcnet_hiddens": [], "post_fcnet_activation": "relu", "post_fcnet_weights_initializer": null, "post_fcnet_weights_initializer_config": null, "post_fcnet_bias_initializer": null, "post_fcnet_bias_initializer_config": null, "free_log_std": false, "log_std_clip_param": 20.0, "no_final_linear": false, "vf_share_layers": false, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "lstm_weights_initializer": null, "lstm_weights_initializer_config": null, "lstm_bias_initializer": null, "lstm_bias_initializer_config": null, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "attention_use_n_prev_actions": 0, "attention_use_n_prev_rewards": 0, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": null, "custom_model_config": {}, "custom_action_dist": null, "custom_preprocessor": null, "encoder_latent_dim": null, "always_check_shapes": false, "lstm_use_prev_action_reward": -1, "_use_default_native_models": -1, "_disable_preprocessor_api": false, "_disable_action_flattening": false}, "_learner_connector": null, "add_default_connectors_to_learner_pipeline": true, "learner_config_dict": {}, "optimizer": {}, "_learner_class": null, "callbacks_on_algorithm_init": null, "callbacks_on_env_runners_recreated": null, "callbacks_on_offline_eval_runners_recreated": null, "callbacks_on_checkpoint_loaded": null, "callbacks_on_environment_created": null, "callbacks_on_episode_created": null, "callbacks_on_episode_start": null, "callbacks_on_episode_step": null, "callbacks_on_episode_end": null, "callbacks_on_evaluate_start": null, "callbacks_on_evaluate_end": null, "callbacks_on_evaluate_offline_start": null, "callbacks_on_evaluate_offline_end": null, "callbacks_on_sample_end": null, "callbacks_on_train_result": null, "explore": true, "enable_rl_module_and_learner": true, "enable_env_runner_and_connector_v2": true, "_prior_exploration_config": {"type": "StochasticSampling"}, "count_steps_by": "env_steps", "policy_map_capacity": 100, "policy_mapping_fn": "<function AlgorithmConfig.DEFAULT_POLICY_MAPPING_FN at 0x157405b20>", "policies_to_train": null, "policy_states_are_swappable": false, "observation_fn": null, "offline_data_class": null, "input_read_method": "read_parquet", "input_read_method_kwargs": {}, "input_read_schema": {}, "input_read_episodes": false, "input_read_sample_batches": false, "input_read_batch_size": null, "input_filesystem": null, "input_filesystem_kwargs": {}, "input_compress_columns": ["obs", "new_obs"], "input_spaces_jsonable": true, "materialize_data": false, "materialize_mapped_data": true, "map_batches_kwargs": {}, "iter_batches_kwargs": {}, "ignore_final_observation": false, "prelearner_class": null, "prelearner_buffer_class": null, "prelearner_buffer_kwargs": {}, "prelearner_module_synch_period": 10, "dataset_num_iters_per_learner": null, "input_config": {}, "actions_in_input_normalized": false, "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_config": {}, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "output_max_rows_per_file": null, "output_write_remaining_data": false, "output_write_method": "write_parquet", "output_write_method_kwargs": {}, "output_filesystem": null, "output_filesystem_kwargs": {}, "output_write_episodes": true, "offline_sampling": false, "evaluation_interval": 1, "evaluation_duration": 20, "evaluation_duration_unit": "episodes", "evaluation_sample_timeout_s": 120.0, "evaluation_auto_duration_min_env_steps_per_sample": 100, "evaluation_auto_duration_max_env_steps_per_sample": 2000, "evaluation_parallel_to_training": false, "evaluation_force_reset_envs_before_iteration": true, "evaluation_config": null, "off_policy_estimation_methods": {}, "ope_split_batch_by_episode": true, "evaluation_num_env_runners": 1, "in_evaluation": false, "sync_filters_on_rollout_workers_timeout_s": 10.0, "offline_evaluation_interval": null, "num_offline_eval_runners": 0, "offline_loss_for_module_fn": null, "offline_evaluation_duration": 1, "offline_evaluation_parallel_to_training": false, "offline_evaluation_timeout_s": 120.0, "num_cpus_per_offline_eval_runner": 1, "num_gpus_per_offline_eval_runner": 0, "custom_resources_per_offline_eval_runner": {}, "restart_failed_offline_eval_runners": true, "ignore_offline_eval_runner_failures": false, "max_num_offline_eval_runner_restarts": 1000, "offline_eval_runner_restore_timeout_s": 1800.0, "max_requests_in_flight_per_offline_eval_runner": 1, "validate_offline_eval_runners_after_construction": true, "offline_eval_runner_health_probe_timeout_s": 30.0, "offline_eval_rl_module_inference_only": false, "broadcast_offline_eval_runner_states": false, "offline_eval_batch_size_per_runner": 256, "dataset_num_iters_per_eval_runner": 1, "keep_per_episode_custom_metrics": false, "metrics_episode_collection_timeout_s": 60.0, "metrics_num_episodes_for_smoothing": 100, "min_time_s_per_iteration": null, "min_train_timesteps_per_iteration": 0, "min_sample_timesteps_per_iteration": 0, "log_gradients": true, "export_native_model_files": false, "checkpoint_trainable_policies_only": false, "logger_creator": null, "logger_config": null, "log_level": "WARN", "log_sys_usage": true, "fake_sampler": false, "seed": 5, "restart_failed_env_runners": true, "ignore_env_runner_failures": false, "max_num_env_runner_restarts": 1000, "delay_between_env_runner_restarts_s": 60.0, "restart_failed_sub_environments": false, "num_consecutive_env_runner_failures_tolerance": 100, "env_runner_health_probe_timeout_s": 30.0, "env_runner_restore_timeout_s": 1800.0, "_model_config": {}, "_rl_module_spec": "RLModuleSpec(module_class=None, observation_space=None, action_space=None, inference_only=False, learner_only=False, model_config=DefaultModelConfig(fcnet_hiddens=[60, 90], fcnet_activation='tanh', fcnet_kernel_initializer=None, fcnet_kernel_initializer_kwargs=None, fcnet_bias_initializer=None, fcnet_bias_initializer_kwargs=None, conv_filters=None, conv_activation='relu', conv_kernel_initializer=None, conv_kernel_initializer_kwargs=None, conv_bias_initializer=None, conv_bias_initializer_kwargs=None, head_fcnet_hiddens=[], head_fcnet_activation='relu', head_fcnet_kernel_initializer=None, head_fcnet_kernel_initializer_kwargs=None, head_fcnet_bias_initializer=None, head_fcnet_bias_initializer_kwargs=None, free_log_std=False, log_std_clip_param=20.0, vf_share_layers=True, use_lstm=False, max_seq_len=20, lstm_cell_size=256, lstm_use_prev_action=False, lstm_use_prev_reward=False, lstm_kernel_initializer=None, lstm_kernel_initializer_kwargs=None, lstm_bias_initializer=None, lstm_bias_initializer_kwargs=None), catalog_class=None, load_state_path=None, model_config_dict=None)", "algorithm_config_overrides_per_module": {}, "_per_module_overrides": {}, "_validate_config": true, "_use_msgpack_checkpoints": false, "_torch_grad_scaler_class": null, "_torch_lr_scheduler_classes": null, "_tf_policy_handles_more_than_one_loss": false, "_disable_preprocessor_api": false, "_disable_action_flattening": false, "_disable_initialize_loss_from_dummy_batch": false, "_dont_auto_sync_env_runner_states": false, "env_task_fn": -1, "enable_connectors": -1, "simple_optimizer": false, "policy_map_cache": -1, "worker_cls": -1, "synchronize_filters": -1, "enable_async_evaluation": -1, "custom_async_evaluation_function": -1, "_enable_rl_module_api": -1, "auto_wrap_old_gym_envs": -1, "always_attach_evaluation_results": -1, "replay_sequence_length": null, "_disable_execution_plan_api": -1, "use_critic": true, "use_gae": true, "use_kl_loss": true, "kl_coeff": 0.7464963036515, "kl_target": 0.0270990929592, "vf_loss_coeff": 0.6688075857018, "entropy_coeff": 0.0090570820258, "clip_param": 0.1221781641624, "vf_clip_param": 0.1027808522125, "entropy_coeff_schedule": null, "lr_schedule": null, "sgd_minibatch_size": -1, "vf_share_layers": -1, "__stdout_file__": null, "__stderr_file__": null, "lambda": 0.9099046732075, "input": "sampler", "policies": {"default_policy": [null, null, null, null]}, "callbacks": "<class 'ray.rllib.callbacks.callbacks.RLlibCallback'>", "create_env_on_driver": false, "custom_eval_function": null, "framework": "torch"}, "time_since_restore": 12.634316205978394, "iterations_since_restore": 7, "perf": {"cpu_util_percent": 48.56666666666666, "ram_util_percent": 79.56666666666666}}
{"timers": {"training_iteration": 1.7914217534845067, "restore_env_runners": 3.7141447946130894e-05, "training_step": 1.7910674014925552, "env_runner_sampling_timer": 1.6752207209097263, "learner_update_timer": 0.11246014164197507, "synch_weights": 0.0006668012086776191, "restore_eval_env_runners": 1.0203659357687785e-05, "evaluation_iteration": 0.13882308311329503, "synch_eval_env_connectors": 0.0001459848721472066, "synch_env_connectors": 4.844411225874867e-06}, "env_runners": {"env_to_module_sum_episodes_length_in": 10.36823839457432, "episode_return_min": -13.5, "module_to_env_connector": {"timers": {"connectors": {"get_actions": 4.159671069434233e-05, "un_batch_to_individual_items": 5.5727126849238765e-06, "tensor_to_numpy": 1.3662219835528219e-05, "normalize_and_clip_actions": 9.722736411353402e-06, "remove_single_ts_time_rank_from_batch": 5.978124546455961e-07, "listify_data_for_vector_env": 1.1353323396338156e-05}}, "connector_pipeline_timer": 0.00010854873301429202}, "env_reset_timer": 4.0080808455273866e-05, "env_to_module_connector": {"timers": {"connectors": {"numpy_to_tensor": 8.828159239425261e-06, "batch_individual_items": 6.516648140900572e-06, "add_states_from_episodes_to_batch": 1.7771917245462278e-06, "add_time_dim_to_batch_and_zero_pad": 2.4258581850388485e-06, "add_observations_from_episodes_to_batch": 3.1449349065376774e-06}}, "connector_pipeline_timer": 4.4741517904952184e-05}, "num_agent_steps_sampled_lifetime": {"default_agent": -3695000.0}, "agent_episode_returns_mean": {"default_agent": 0.26}, "num_episodes": 250.0, "num_env_steps_sampled_lifetime": -3695000.0, "episode_len_max": 20, "rlmodule_inference_timer": 4.517542565359374e-05, "weights_seq_no": 7.0, "episode_len_min": 20, "num_env_steps_sampled": 5000.0, "time_between_sampling": 0.0016202562398251368, "episode_len_mean": 20.0, "episode_duration_sec_mean": 0.00507988118706271, "env_step_timer": 1.4266250984931404e-05, "num_agent_steps_sampled": {"default_agent": 5000.0}, "num_episodes_lifetime": -184750.0, "module_episode_returns_mean": {"default_policy": 0.26}, "num_module_steps_sampled": {"default_policy": 5000.0}, "episode_return_max": 6.5, "sample": 0.005360479190322975, "episode_return_mean": 0.26, "env_to_module_sum_episodes_length_out": 10.36823839457432, "num_module_steps_sampled_lifetime": {"default_policy": -3695000.0}, "num_env_steps_sampled_lifetime_throughput": 3582.4983753234446}, "learners": {"default_policy": {"num_trainable_parameters": 6003, "diff_num_grad_updates_vs_sampler_policy": 1.0, "gradients_default_optimizer_global_norm": 0.0506206676363945, "default_optimizer_learning_rate": 0.0002847858517, "module_train_batch_size_mean": 1000.0, "vf_loss_unclipped": 26.320615768432617, "curr_entropy_coeff": 0.0090570820258, "num_module_steps_trained": 6000, "total_loss": -0.010954849421977997, "vf_explained_var": -0.016090035438537598, "num_module_steps_trained_lifetime": 48000, "curr_kl_coeff": 0.0029160012491047382, "policy_loss": -0.0741666927933693, "mean_kl_loss": 0.002404420170933008, "entropy": 0.6119840741157532, "vf_loss": 0.10278083384037018, "weights_seq_no": 8.0, "num_module_steps_trained_lifetime_throughput": 350975.9093519477}, "__all_modules__": {"learner_connector": {"timers": {"connectors": {"add_observations_from_episodes_to_batch": 0.0008729591741154064, "general_advantage_estimation": 0.00683487264307501, "batch_individual_items": 0.03279293820248531, "numpy_to_tensor": 8.112521103537295e-05, "add_one_ts_to_episodes_and_truncate": 0.008190578384798966, "add_time_dim_to_batch_and_zero_pad": 1.2025267521434732e-05, "add_columns_from_episodes_to_train_batch": 0.034295888530138305, "add_states_from_episodes_to_batch": 4.260136457591936e-06}}, "connector_pipeline_timer": 0.08323615492216015}, "learner_connector_sum_episodes_length_in": 5000.0, "num_trainable_parameters": 6003, "num_env_steps_trained": 31500, "num_module_steps_trained": 6000, "learner_connector_sum_episodes_length_out": 5250.0, "num_non_trainable_parameters": 0, "num_module_steps_trained_lifetime": 48000, "num_env_steps_trained_lifetime": 252000, "num_env_steps_trained_lifetime_throughput": 1834107.5990644484, "num_module_steps_trained_throughput": 350515.2128093409, "num_module_steps_trained_lifetime_throughput": 350054.3117569707}}, "num_training_step_calls_per_iteration": 1, "evaluation": {"env_runners": {"num_agent_steps_sampled_lifetime": {"default_agent": 3200}, "env_to_module_sum_episodes_length_in": 10.3682383945743, "agent_episode_returns_mean": {"default_agent": 1.3}, "env_to_module_connector": {"timers": {"connectors": {"add_observations_from_episodes_to_batch": 2.8584288280314118e-06, "batch_individual_items": 6.488666188160627e-06, "numpy_to_tensor": 8.633017792810636e-06, "add_time_dim_to_batch_and_zero_pad": 2.3535051669399756e-06, "add_states_from_episodes_to_batch": 1.6139347894845012e-06}}, "connector_pipeline_timer": 4.426565052387315e-05}, "module_to_env_connector": {"connector_pipeline_timer": 0.0001075604061006413, "timers": {"connectors": {"remove_single_ts_time_rank_from_batch": 6.178733693430354e-07, "listify_data_for_vector_env": 1.162492003737294e-05, "tensor_to_numpy": 1.3686277703072136e-05, "normalize_and_clip_actions": 9.807073717868132e-06, "un_batch_to_individual_items": 5.795182978571314e-06, "get_actions": 3.904938574283995e-05}}}, "episode_duration_sec_mean": 0.004750863724621013, "sample": 0.1246330580963608, "num_episodes": 20, "episode_len_min": 20, "num_module_steps_sampled": {"default_policy": 400}, "num_env_steps_sampled": 400, "num_episodes_lifetime": 160, "env_to_module_sum_episodes_length_out": 10.3682383945743, "episode_return_min": -15.5, "module_episode_returns_mean": {"default_policy": 1.3}, "num_env_steps_sampled_lifetime": 40400, "rlmodule_inference_timer": 2.859823124373965e-05, "weights_seq_no": 8.0, "num_module_steps_sampled_lifetime": {"default_policy": 3200}, "env_step_timer": 1.5026025659543524e-05, "episode_return_max": 13.5, "episode_return_mean": 1.3, "env_reset_timer": 0.0024489316173573125, "episode_len_max": 20, "num_agent_steps_sampled": {"default_agent": 400}, "episode_len_mean": 20.0, "time_between_sampling": 1.74556574647998}, "num_healthy_workers": 1, "actor_manager_num_outstanding_async_reqs": 0, "num_remote_worker_restarts": 0}, "num_env_steps_sampled_lifetime": -3695000.0, "fault_tolerance": {"num_healthy_workers": 0, "num_remote_worker_restarts": 0}, "env_runner_group": {"actor_manager_num_outstanding_async_reqs": 0}, "done": false, "training_iteration": 8, "trial_id": "5029b_00000", "date": "2025-08-11_19-21-50", "timestamp": 1754932910, "time_this_iter_s": 1.7329490184783936, "time_total_s": 14.367265224456787, "pid": 14328, "hostname": "Mac", "node_ip": "127.0.0.1", "config": {"exploration_config": {}, "extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "placement_strategy": "PACK", "num_gpus": 0, "_fake_gpus": false, "num_cpus_for_main_process": 2, "eager_tracing": true, "eager_max_retraces": 20, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "torch_compile_learner": false, "torch_compile_learner_what_to_compile": "forward_train", "torch_compile_learner_dynamo_backend": "aot_eager", "torch_compile_learner_dynamo_mode": null, "torch_compile_worker": false, "torch_compile_worker_dynamo_backend": "aot_eager", "torch_compile_worker_dynamo_mode": null, "torch_ddp_kwargs": {}, "torch_skip_nan_gradients": false, "env": "Umbrella", "env_config": {}, "observation_space": null, "action_space": null, "clip_rewards": null, "normalize_actions": true, "clip_actions": false, "_is_atari": null, "disable_env_checking": false, "render_env": false, "action_mask_key": "action_mask", "env_runner_cls": null, "num_env_runners": 0, "create_local_env_runner": true, "num_envs_per_env_runner": 1, "gym_env_vectorize_mode": "SYNC", "num_cpus_per_env_runner": 1, "num_gpus_per_env_runner": 0, "custom_resources_per_env_runner": {}, "validate_env_runners_after_construction": true, "episodes_to_numpy": true, "max_requests_in_flight_per_env_runner": 1, "sample_timeout_s": 60.0, "_env_to_module_connector": null, "add_default_connectors_to_env_to_module_pipeline": true, "_module_to_env_connector": null, "add_default_connectors_to_module_to_env_pipeline": true, "merge_env_runner_states": "training_only", "broadcast_env_runner_states": true, "episode_lookback_horizon": 1, "rollout_fragment_length": "auto", "batch_mode": "complete_episodes", "compress_observations": false, "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "enable_tf1_exec_eagerly": false, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "preprocessor_pref": "deepmind", "observation_filter": "NoFilter", "update_worker_filter_stats": true, "use_worker_filter_stats": true, "sampler_perf_stats_ema_coef": null, "_is_online": true, "num_learners": 0, "num_gpus_per_learner": 0, "num_cpus_per_learner": "auto", "num_aggregator_actors_per_learner": 0, "max_requests_in_flight_per_aggregator_actor": 3, "local_gpu_idx": 0, "max_requests_in_flight_per_learner": 3, "gamma": 1, "lr": 0.0002847858517, "grad_clip": 0.5, "grad_clip_by": "global_norm", "_train_batch_size_per_learner": 5000, "train_batch_size": 4000, "num_epochs": 1, "minibatch_size": 1000, "shuffle_batch_per_epoch": true, "model": {"fcnet_hiddens": [256, 256], "fcnet_activation": "tanh", "fcnet_weights_initializer": null, "fcnet_weights_initializer_config": null, "fcnet_bias_initializer": null, "fcnet_bias_initializer_config": null, "conv_filters": null, "conv_activation": "relu", "conv_kernel_initializer": null, "conv_kernel_initializer_config": null, "conv_bias_initializer": null, "conv_bias_initializer_config": null, "conv_transpose_kernel_initializer": null, "conv_transpose_kernel_initializer_config": null, "conv_transpose_bias_initializer": null, "conv_transpose_bias_initializer_config": null, "post_fcnet_hiddens": [], "post_fcnet_activation": "relu", "post_fcnet_weights_initializer": null, "post_fcnet_weights_initializer_config": null, "post_fcnet_bias_initializer": null, "post_fcnet_bias_initializer_config": null, "free_log_std": false, "log_std_clip_param": 20.0, "no_final_linear": false, "vf_share_layers": false, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "lstm_weights_initializer": null, "lstm_weights_initializer_config": null, "lstm_bias_initializer": null, "lstm_bias_initializer_config": null, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "attention_use_n_prev_actions": 0, "attention_use_n_prev_rewards": 0, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": null, "custom_model_config": {}, "custom_action_dist": null, "custom_preprocessor": null, "encoder_latent_dim": null, "always_check_shapes": false, "lstm_use_prev_action_reward": -1, "_use_default_native_models": -1, "_disable_preprocessor_api": false, "_disable_action_flattening": false}, "_learner_connector": null, "add_default_connectors_to_learner_pipeline": true, "learner_config_dict": {}, "optimizer": {}, "_learner_class": null, "callbacks_on_algorithm_init": null, "callbacks_on_env_runners_recreated": null, "callbacks_on_offline_eval_runners_recreated": null, "callbacks_on_checkpoint_loaded": null, "callbacks_on_environment_created": null, "callbacks_on_episode_created": null, "callbacks_on_episode_start": null, "callbacks_on_episode_step": null, "callbacks_on_episode_end": null, "callbacks_on_evaluate_start": null, "callbacks_on_evaluate_end": null, "callbacks_on_evaluate_offline_start": null, "callbacks_on_evaluate_offline_end": null, "callbacks_on_sample_end": null, "callbacks_on_train_result": null, "explore": true, "enable_rl_module_and_learner": true, "enable_env_runner_and_connector_v2": true, "_prior_exploration_config": {"type": "StochasticSampling"}, "count_steps_by": "env_steps", "policy_map_capacity": 100, "policy_mapping_fn": "<function AlgorithmConfig.DEFAULT_POLICY_MAPPING_FN at 0x157405b20>", "policies_to_train": null, "policy_states_are_swappable": false, "observation_fn": null, "offline_data_class": null, "input_read_method": "read_parquet", "input_read_method_kwargs": {}, "input_read_schema": {}, "input_read_episodes": false, "input_read_sample_batches": false, "input_read_batch_size": null, "input_filesystem": null, "input_filesystem_kwargs": {}, "input_compress_columns": ["obs", "new_obs"], "input_spaces_jsonable": true, "materialize_data": false, "materialize_mapped_data": true, "map_batches_kwargs": {}, "iter_batches_kwargs": {}, "ignore_final_observation": false, "prelearner_class": null, "prelearner_buffer_class": null, "prelearner_buffer_kwargs": {}, "prelearner_module_synch_period": 10, "dataset_num_iters_per_learner": null, "input_config": {}, "actions_in_input_normalized": false, "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_config": {}, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "output_max_rows_per_file": null, "output_write_remaining_data": false, "output_write_method": "write_parquet", "output_write_method_kwargs": {}, "output_filesystem": null, "output_filesystem_kwargs": {}, "output_write_episodes": true, "offline_sampling": false, "evaluation_interval": 1, "evaluation_duration": 20, "evaluation_duration_unit": "episodes", "evaluation_sample_timeout_s": 120.0, "evaluation_auto_duration_min_env_steps_per_sample": 100, "evaluation_auto_duration_max_env_steps_per_sample": 2000, "evaluation_parallel_to_training": false, "evaluation_force_reset_envs_before_iteration": true, "evaluation_config": null, "off_policy_estimation_methods": {}, "ope_split_batch_by_episode": true, "evaluation_num_env_runners": 1, "in_evaluation": false, "sync_filters_on_rollout_workers_timeout_s": 10.0, "offline_evaluation_interval": null, "num_offline_eval_runners": 0, "offline_loss_for_module_fn": null, "offline_evaluation_duration": 1, "offline_evaluation_parallel_to_training": false, "offline_evaluation_timeout_s": 120.0, "num_cpus_per_offline_eval_runner": 1, "num_gpus_per_offline_eval_runner": 0, "custom_resources_per_offline_eval_runner": {}, "restart_failed_offline_eval_runners": true, "ignore_offline_eval_runner_failures": false, "max_num_offline_eval_runner_restarts": 1000, "offline_eval_runner_restore_timeout_s": 1800.0, "max_requests_in_flight_per_offline_eval_runner": 1, "validate_offline_eval_runners_after_construction": true, "offline_eval_runner_health_probe_timeout_s": 30.0, "offline_eval_rl_module_inference_only": false, "broadcast_offline_eval_runner_states": false, "offline_eval_batch_size_per_runner": 256, "dataset_num_iters_per_eval_runner": 1, "keep_per_episode_custom_metrics": false, "metrics_episode_collection_timeout_s": 60.0, "metrics_num_episodes_for_smoothing": 100, "min_time_s_per_iteration": null, "min_train_timesteps_per_iteration": 0, "min_sample_timesteps_per_iteration": 0, "log_gradients": true, "export_native_model_files": false, "checkpoint_trainable_policies_only": false, "logger_creator": null, "logger_config": null, "log_level": "WARN", "log_sys_usage": true, "fake_sampler": false, "seed": 5, "restart_failed_env_runners": true, "ignore_env_runner_failures": false, "max_num_env_runner_restarts": 1000, "delay_between_env_runner_restarts_s": 60.0, "restart_failed_sub_environments": false, "num_consecutive_env_runner_failures_tolerance": 100, "env_runner_health_probe_timeout_s": 30.0, "env_runner_restore_timeout_s": 1800.0, "_model_config": {}, "_rl_module_spec": "RLModuleSpec(module_class=None, observation_space=None, action_space=None, inference_only=False, learner_only=False, model_config=DefaultModelConfig(fcnet_hiddens=[60, 90], fcnet_activation='tanh', fcnet_kernel_initializer=None, fcnet_kernel_initializer_kwargs=None, fcnet_bias_initializer=None, fcnet_bias_initializer_kwargs=None, conv_filters=None, conv_activation='relu', conv_kernel_initializer=None, conv_kernel_initializer_kwargs=None, conv_bias_initializer=None, conv_bias_initializer_kwargs=None, head_fcnet_hiddens=[], head_fcnet_activation='relu', head_fcnet_kernel_initializer=None, head_fcnet_kernel_initializer_kwargs=None, head_fcnet_bias_initializer=None, head_fcnet_bias_initializer_kwargs=None, free_log_std=False, log_std_clip_param=20.0, vf_share_layers=True, use_lstm=False, max_seq_len=20, lstm_cell_size=256, lstm_use_prev_action=False, lstm_use_prev_reward=False, lstm_kernel_initializer=None, lstm_kernel_initializer_kwargs=None, lstm_bias_initializer=None, lstm_bias_initializer_kwargs=None), catalog_class=None, load_state_path=None, model_config_dict=None)", "algorithm_config_overrides_per_module": {}, "_per_module_overrides": {}, "_validate_config": true, "_use_msgpack_checkpoints": false, "_torch_grad_scaler_class": null, "_torch_lr_scheduler_classes": null, "_tf_policy_handles_more_than_one_loss": false, "_disable_preprocessor_api": false, "_disable_action_flattening": false, "_disable_initialize_loss_from_dummy_batch": false, "_dont_auto_sync_env_runner_states": false, "env_task_fn": -1, "enable_connectors": -1, "simple_optimizer": false, "policy_map_cache": -1, "worker_cls": -1, "synchronize_filters": -1, "enable_async_evaluation": -1, "custom_async_evaluation_function": -1, "_enable_rl_module_api": -1, "auto_wrap_old_gym_envs": -1, "always_attach_evaluation_results": -1, "replay_sequence_length": null, "_disable_execution_plan_api": -1, "use_critic": true, "use_gae": true, "use_kl_loss": true, "kl_coeff": 0.7464963036515, "kl_target": 0.0270990929592, "vf_loss_coeff": 0.6688075857018, "entropy_coeff": 0.0090570820258, "clip_param": 0.1221781641624, "vf_clip_param": 0.1027808522125, "entropy_coeff_schedule": null, "lr_schedule": null, "sgd_minibatch_size": -1, "vf_share_layers": -1, "__stdout_file__": null, "__stderr_file__": null, "lambda": 0.9099046732075, "input": "sampler", "policies": {"default_policy": [null, null, null, null]}, "callbacks": "<class 'ray.rllib.callbacks.callbacks.RLlibCallback'>", "create_env_on_driver": false, "custom_eval_function": null, "framework": "torch"}, "time_since_restore": 14.367265224456787, "iterations_since_restore": 8, "perf": {"cpu_util_percent": 49.4, "ram_util_percent": 79.2}}
{"timers": {"training_iteration": 1.7894849121997463, "restore_env_runners": 3.682503388546672e-05, "training_step": 1.7891321812276273, "env_runner_sampling_timer": 1.6723724582814448, "learner_update_timer": 0.11336992231576065, "synch_weights": 0.0006669740263283274, "restore_eval_env_runners": 1.0168702436700806e-05, "evaluation_iteration": 0.1385148164519288, "synch_eval_env_connectors": 0.00014561502357645978, "synch_env_connectors": 4.8413772382011514e-06}, "env_runners": {"env_to_module_sum_episodes_length_in": 10.36823839457432, "episode_return_min": -13.5, "module_to_env_connector": {"timers": {"connectors": {"get_actions": 3.974312434161049e-05, "un_batch_to_individual_items": 5.391486669214129e-06, "tensor_to_numpy": 1.339417030517671e-05, "normalize_and_clip_actions": 9.421633409310645e-06, "remove_single_ts_time_rank_from_batch": 5.872835319199364e-07, "listify_data_for_vector_env": 1.0979972810390619e-05}}, "connector_pipeline_timer": 0.00010498907680243116}, "env_reset_timer": 3.5383263546410996e-05, "env_to_module_connector": {"timers": {"connectors": {"numpy_to_tensor": 8.632966015019468e-06, "batch_individual_items": 6.33282313629973e-06, "add_states_from_episodes_to_batch": 1.740521992771167e-06, "add_time_dim_to_batch_and_zero_pad": 2.3611098249598643e-06, "add_observations_from_episodes_to_batch": 3.0075061137549004e-06}}, "connector_pipeline_timer": 4.3795424547008046e-05}, "num_agent_steps_sampled_lifetime": {"default_agent": -4312500.0}, "agent_episode_returns_mean": {"default_agent": 1.8600000000000003}, "num_episodes": 250.0, "num_env_steps_sampled_lifetime": -4312500.0, "episode_len_max": 20, "rlmodule_inference_timer": 2.823896510506168e-05, "weights_seq_no": 8.0, "episode_len_min": 20, "num_env_steps_sampled": 5000.0, "time_between_sampling": 0.0015458157028112546, "episode_len_mean": 20.0, "episode_duration_sec_mean": 0.004583382184151559, "env_step_timer": 1.3720455118478483e-05, "num_agent_steps_sampled": {"default_agent": 5000.0}, "num_episodes_lifetime": -215625.0, "module_episode_returns_mean": {"default_policy": 1.8600000000000003}, "num_module_steps_sampled": {"default_policy": 5000.0}, "episode_return_max": 6.5, "sample": 0.0049968455476791275, "episode_return_mean": 1.8600000000000003, "env_to_module_sum_episodes_length_out": 10.36823839457432, "num_module_steps_sampled_lifetime": {"default_policy": -4312500.0}, "num_env_steps_sampled_lifetime_throughput": 3709.708547774339}, "learners": {"default_policy": {"num_trainable_parameters": 6003, "diff_num_grad_updates_vs_sampler_policy": 1.0, "gradients_default_optimizer_global_norm": 0.02396991103887558, "default_optimizer_learning_rate": 0.0002847858517, "module_train_batch_size_mean": 1000.0, "vf_loss_unclipped": 26.345033645629883, "curr_entropy_coeff": 0.0090570820258, "num_module_steps_trained": 6000, "total_loss": 0.13819031417369843, "vf_explained_var": -0.01631009578704834, "num_module_steps_trained_lifetime": 54000, "curr_kl_coeff": 0.0014580006245523691, "policy_loss": 0.07479322701692581, "mean_kl_loss": 0.0008853764156810939, "entropy": 0.5902684926986694, "vf_loss": 0.10278083384037018, "weights_seq_no": 9.0, "num_module_steps_trained_lifetime_throughput": 350846.0921743983}, "__all_modules__": {"learner_connector": {"timers": {"connectors": {"add_observations_from_episodes_to_batch": 0.0008739291614697203, "general_advantage_estimation": 0.006831866836778104, "batch_individual_items": 0.032792372160644546, "numpy_to_tensor": 8.123062946722957e-05, "add_one_ts_to_episodes_and_truncate": 0.009185500930774887, "add_time_dim_to_batch_and_zero_pad": 1.2023765459403168e-05, "add_columns_from_episodes_to_train_batch": 0.03431636672535992, "add_states_from_episodes_to_batch": 4.247955580762613e-06}}, "connector_pipeline_timer": 0.08424888504275879}, "learner_connector_sum_episodes_length_in": 5000.0, "num_trainable_parameters": 6003, "num_env_steps_trained": 31500, "num_module_steps_trained": 6000, "learner_connector_sum_episodes_length_out": 5250.0, "num_non_trainable_parameters": 0, "num_module_steps_trained_lifetime": 54000, "num_env_steps_trained_lifetime": 283500, "num_env_steps_trained_lifetime_throughput": 1833891.5458433097, "num_module_steps_trained_throughput": 350430.1432956637, "num_module_steps_trained_lifetime_throughput": 349984.3241272848}}, "num_training_step_calls_per_iteration": 1, "evaluation": {"env_runners": {"num_agent_steps_sampled_lifetime": {"default_agent": 3600}, "env_to_module_sum_episodes_length_in": 10.368238394574323, "agent_episode_returns_mean": {"default_agent": 1.5}, "env_to_module_connector": {"timers": {"connectors": {"add_observations_from_episodes_to_batch": 2.8320338913313584e-06, "batch_individual_items": 6.391834457018228e-06, "numpy_to_tensor": 8.66962512009976e-06, "add_time_dim_to_batch_and_zero_pad": 2.318510793599203e-06, "add_states_from_episodes_to_batch": 1.6085821758693565e-06}}, "connector_pipeline_timer": 4.461156445440617e-05}, "module_to_env_connector": {"connector_pipeline_timer": 0.00010570071843732652, "timers": {"connectors": {"remove_single_ts_time_rank_from_batch": 5.973337263417263e-07, "listify_data_for_vector_env": 1.1469816666893434e-05, "tensor_to_numpy": 1.3670193790612214e-05, "normalize_and_clip_actions": 9.631990360366357e-06, "un_batch_to_individual_items": 5.524024592688582e-06, "get_actions": 3.826025827161878e-05}}}, "episode_duration_sec_mean": 0.0048017728561535475, "sample": 0.12443250417571847, "num_episodes": 20, "episode_len_min": 20, "num_module_steps_sampled": {"default_policy": 400}, "num_env_steps_sampled": 400, "num_episodes_lifetime": 180, "env_to_module_sum_episodes_length_out": 10.368238394574323, "episode_return_min": -15.5, "module_episode_returns_mean": {"default_policy": 1.5}, "num_env_steps_sampled_lifetime": 45400, "rlmodule_inference_timer": 2.874315631501823e-05, "weights_seq_no": 9.0, "num_module_steps_sampled_lifetime": {"default_policy": 3600}, "env_step_timer": 1.457473429141519e-05, "episode_return_max": 13.5, "episode_return_mean": 1.5, "env_reset_timer": 0.002425445221509585, "episode_len_max": 20, "num_agent_steps_sampled": {"default_agent": 400}, "episode_len_mean": 20.0, "time_between_sampling": 1.744284764425328}, "num_healthy_workers": 1, "actor_manager_num_outstanding_async_reqs": 0, "num_remote_worker_restarts": 0}, "num_env_steps_sampled_lifetime": -4312500.0, "fault_tolerance": {"num_healthy_workers": 0, "num_remote_worker_restarts": 0}, "env_runner_group": {"actor_manager_num_outstanding_async_reqs": 0}, "done": false, "training_iteration": 9, "trial_id": "5029b_00000", "date": "2025-08-11_19-21-51", "timestamp": 1754932911, "time_this_iter_s": 1.7103710174560547, "time_total_s": 16.077636241912842, "pid": 14328, "hostname": "Mac", "node_ip": "127.0.0.1", "config": {"exploration_config": {}, "extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "placement_strategy": "PACK", "num_gpus": 0, "_fake_gpus": false, "num_cpus_for_main_process": 2, "eager_tracing": true, "eager_max_retraces": 20, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "torch_compile_learner": false, "torch_compile_learner_what_to_compile": "forward_train", "torch_compile_learner_dynamo_backend": "aot_eager", "torch_compile_learner_dynamo_mode": null, "torch_compile_worker": false, "torch_compile_worker_dynamo_backend": "aot_eager", "torch_compile_worker_dynamo_mode": null, "torch_ddp_kwargs": {}, "torch_skip_nan_gradients": false, "env": "Umbrella", "env_config": {}, "observation_space": null, "action_space": null, "clip_rewards": null, "normalize_actions": true, "clip_actions": false, "_is_atari": null, "disable_env_checking": false, "render_env": false, "action_mask_key": "action_mask", "env_runner_cls": null, "num_env_runners": 0, "create_local_env_runner": true, "num_envs_per_env_runner": 1, "gym_env_vectorize_mode": "SYNC", "num_cpus_per_env_runner": 1, "num_gpus_per_env_runner": 0, "custom_resources_per_env_runner": {}, "validate_env_runners_after_construction": true, "episodes_to_numpy": true, "max_requests_in_flight_per_env_runner": 1, "sample_timeout_s": 60.0, "_env_to_module_connector": null, "add_default_connectors_to_env_to_module_pipeline": true, "_module_to_env_connector": null, "add_default_connectors_to_module_to_env_pipeline": true, "merge_env_runner_states": "training_only", "broadcast_env_runner_states": true, "episode_lookback_horizon": 1, "rollout_fragment_length": "auto", "batch_mode": "complete_episodes", "compress_observations": false, "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "enable_tf1_exec_eagerly": false, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "preprocessor_pref": "deepmind", "observation_filter": "NoFilter", "update_worker_filter_stats": true, "use_worker_filter_stats": true, "sampler_perf_stats_ema_coef": null, "_is_online": true, "num_learners": 0, "num_gpus_per_learner": 0, "num_cpus_per_learner": "auto", "num_aggregator_actors_per_learner": 0, "max_requests_in_flight_per_aggregator_actor": 3, "local_gpu_idx": 0, "max_requests_in_flight_per_learner": 3, "gamma": 1, "lr": 0.0002847858517, "grad_clip": 0.5, "grad_clip_by": "global_norm", "_train_batch_size_per_learner": 5000, "train_batch_size": 4000, "num_epochs": 1, "minibatch_size": 1000, "shuffle_batch_per_epoch": true, "model": {"fcnet_hiddens": [256, 256], "fcnet_activation": "tanh", "fcnet_weights_initializer": null, "fcnet_weights_initializer_config": null, "fcnet_bias_initializer": null, "fcnet_bias_initializer_config": null, "conv_filters": null, "conv_activation": "relu", "conv_kernel_initializer": null, "conv_kernel_initializer_config": null, "conv_bias_initializer": null, "conv_bias_initializer_config": null, "conv_transpose_kernel_initializer": null, "conv_transpose_kernel_initializer_config": null, "conv_transpose_bias_initializer": null, "conv_transpose_bias_initializer_config": null, "post_fcnet_hiddens": [], "post_fcnet_activation": "relu", "post_fcnet_weights_initializer": null, "post_fcnet_weights_initializer_config": null, "post_fcnet_bias_initializer": null, "post_fcnet_bias_initializer_config": null, "free_log_std": false, "log_std_clip_param": 20.0, "no_final_linear": false, "vf_share_layers": false, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "lstm_weights_initializer": null, "lstm_weights_initializer_config": null, "lstm_bias_initializer": null, "lstm_bias_initializer_config": null, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "attention_use_n_prev_actions": 0, "attention_use_n_prev_rewards": 0, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": null, "custom_model_config": {}, "custom_action_dist": null, "custom_preprocessor": null, "encoder_latent_dim": null, "always_check_shapes": false, "lstm_use_prev_action_reward": -1, "_use_default_native_models": -1, "_disable_preprocessor_api": false, "_disable_action_flattening": false}, "_learner_connector": null, "add_default_connectors_to_learner_pipeline": true, "learner_config_dict": {}, "optimizer": {}, "_learner_class": null, "callbacks_on_algorithm_init": null, "callbacks_on_env_runners_recreated": null, "callbacks_on_offline_eval_runners_recreated": null, "callbacks_on_checkpoint_loaded": null, "callbacks_on_environment_created": null, "callbacks_on_episode_created": null, "callbacks_on_episode_start": null, "callbacks_on_episode_step": null, "callbacks_on_episode_end": null, "callbacks_on_evaluate_start": null, "callbacks_on_evaluate_end": null, "callbacks_on_evaluate_offline_start": null, "callbacks_on_evaluate_offline_end": null, "callbacks_on_sample_end": null, "callbacks_on_train_result": null, "explore": true, "enable_rl_module_and_learner": true, "enable_env_runner_and_connector_v2": true, "_prior_exploration_config": {"type": "StochasticSampling"}, "count_steps_by": "env_steps", "policy_map_capacity": 100, "policy_mapping_fn": "<function AlgorithmConfig.DEFAULT_POLICY_MAPPING_FN at 0x157405b20>", "policies_to_train": null, "policy_states_are_swappable": false, "observation_fn": null, "offline_data_class": null, "input_read_method": "read_parquet", "input_read_method_kwargs": {}, "input_read_schema": {}, "input_read_episodes": false, "input_read_sample_batches": false, "input_read_batch_size": null, "input_filesystem": null, "input_filesystem_kwargs": {}, "input_compress_columns": ["obs", "new_obs"], "input_spaces_jsonable": true, "materialize_data": false, "materialize_mapped_data": true, "map_batches_kwargs": {}, "iter_batches_kwargs": {}, "ignore_final_observation": false, "prelearner_class": null, "prelearner_buffer_class": null, "prelearner_buffer_kwargs": {}, "prelearner_module_synch_period": 10, "dataset_num_iters_per_learner": null, "input_config": {}, "actions_in_input_normalized": false, "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_config": {}, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "output_max_rows_per_file": null, "output_write_remaining_data": false, "output_write_method": "write_parquet", "output_write_method_kwargs": {}, "output_filesystem": null, "output_filesystem_kwargs": {}, "output_write_episodes": true, "offline_sampling": false, "evaluation_interval": 1, "evaluation_duration": 20, "evaluation_duration_unit": "episodes", "evaluation_sample_timeout_s": 120.0, "evaluation_auto_duration_min_env_steps_per_sample": 100, "evaluation_auto_duration_max_env_steps_per_sample": 2000, "evaluation_parallel_to_training": false, "evaluation_force_reset_envs_before_iteration": true, "evaluation_config": null, "off_policy_estimation_methods": {}, "ope_split_batch_by_episode": true, "evaluation_num_env_runners": 1, "in_evaluation": false, "sync_filters_on_rollout_workers_timeout_s": 10.0, "offline_evaluation_interval": null, "num_offline_eval_runners": 0, "offline_loss_for_module_fn": null, "offline_evaluation_duration": 1, "offline_evaluation_parallel_to_training": false, "offline_evaluation_timeout_s": 120.0, "num_cpus_per_offline_eval_runner": 1, "num_gpus_per_offline_eval_runner": 0, "custom_resources_per_offline_eval_runner": {}, "restart_failed_offline_eval_runners": true, "ignore_offline_eval_runner_failures": false, "max_num_offline_eval_runner_restarts": 1000, "offline_eval_runner_restore_timeout_s": 1800.0, "max_requests_in_flight_per_offline_eval_runner": 1, "validate_offline_eval_runners_after_construction": true, "offline_eval_runner_health_probe_timeout_s": 30.0, "offline_eval_rl_module_inference_only": false, "broadcast_offline_eval_runner_states": false, "offline_eval_batch_size_per_runner": 256, "dataset_num_iters_per_eval_runner": 1, "keep_per_episode_custom_metrics": false, "metrics_episode_collection_timeout_s": 60.0, "metrics_num_episodes_for_smoothing": 100, "min_time_s_per_iteration": null, "min_train_timesteps_per_iteration": 0, "min_sample_timesteps_per_iteration": 0, "log_gradients": true, "export_native_model_files": false, "checkpoint_trainable_policies_only": false, "logger_creator": null, "logger_config": null, "log_level": "WARN", "log_sys_usage": true, "fake_sampler": false, "seed": 5, "restart_failed_env_runners": true, "ignore_env_runner_failures": false, "max_num_env_runner_restarts": 1000, "delay_between_env_runner_restarts_s": 60.0, "restart_failed_sub_environments": false, "num_consecutive_env_runner_failures_tolerance": 100, "env_runner_health_probe_timeout_s": 30.0, "env_runner_restore_timeout_s": 1800.0, "_model_config": {}, "_rl_module_spec": "RLModuleSpec(module_class=None, observation_space=None, action_space=None, inference_only=False, learner_only=False, model_config=DefaultModelConfig(fcnet_hiddens=[60, 90], fcnet_activation='tanh', fcnet_kernel_initializer=None, fcnet_kernel_initializer_kwargs=None, fcnet_bias_initializer=None, fcnet_bias_initializer_kwargs=None, conv_filters=None, conv_activation='relu', conv_kernel_initializer=None, conv_kernel_initializer_kwargs=None, conv_bias_initializer=None, conv_bias_initializer_kwargs=None, head_fcnet_hiddens=[], head_fcnet_activation='relu', head_fcnet_kernel_initializer=None, head_fcnet_kernel_initializer_kwargs=None, head_fcnet_bias_initializer=None, head_fcnet_bias_initializer_kwargs=None, free_log_std=False, log_std_clip_param=20.0, vf_share_layers=True, use_lstm=False, max_seq_len=20, lstm_cell_size=256, lstm_use_prev_action=False, lstm_use_prev_reward=False, lstm_kernel_initializer=None, lstm_kernel_initializer_kwargs=None, lstm_bias_initializer=None, lstm_bias_initializer_kwargs=None), catalog_class=None, load_state_path=None, model_config_dict=None)", "algorithm_config_overrides_per_module": {}, "_per_module_overrides": {}, "_validate_config": true, "_use_msgpack_checkpoints": false, "_torch_grad_scaler_class": null, "_torch_lr_scheduler_classes": null, "_tf_policy_handles_more_than_one_loss": false, "_disable_preprocessor_api": false, "_disable_action_flattening": false, "_disable_initialize_loss_from_dummy_batch": false, "_dont_auto_sync_env_runner_states": false, "env_task_fn": -1, "enable_connectors": -1, "simple_optimizer": false, "policy_map_cache": -1, "worker_cls": -1, "synchronize_filters": -1, "enable_async_evaluation": -1, "custom_async_evaluation_function": -1, "_enable_rl_module_api": -1, "auto_wrap_old_gym_envs": -1, "always_attach_evaluation_results": -1, "replay_sequence_length": null, "_disable_execution_plan_api": -1, "use_critic": true, "use_gae": true, "use_kl_loss": true, "kl_coeff": 0.7464963036515, "kl_target": 0.0270990929592, "vf_loss_coeff": 0.6688075857018, "entropy_coeff": 0.0090570820258, "clip_param": 0.1221781641624, "vf_clip_param": 0.1027808522125, "entropy_coeff_schedule": null, "lr_schedule": null, "sgd_minibatch_size": -1, "vf_share_layers": -1, "__stdout_file__": null, "__stderr_file__": null, "lambda": 0.9099046732075, "input": "sampler", "policies": {"default_policy": [null, null, null, null]}, "callbacks": "<class 'ray.rllib.callbacks.callbacks.RLlibCallback'>", "create_env_on_driver": false, "custom_eval_function": null, "framework": "torch"}, "time_since_restore": 16.077636241912842, "iterations_since_restore": 9, "perf": {"cpu_util_percent": 31.133333333333336, "ram_util_percent": 79.4}}
{"timers": {"training_iteration": 1.7870470472477629, "restore_env_runners": 3.651803313988486e-05, "training_step": 1.7866961639951604, "env_runner_sampling_timer": 1.669200220787765, "learner_update_timer": 0.11410883475194919, "synch_weights": 0.0006657934559178523, "restore_eval_env_runners": 1.0150764594856093e-05, "evaluation_iteration": 0.13823198286833993, "synch_eval_env_connectors": 0.00014538262305466737, "synch_env_connectors": 4.832962606245656e-06}, "env_runners": {"env_to_module_sum_episodes_length_in": 10.36823839457432, "episode_return_min": -13.5, "module_to_env_connector": {"timers": {"connectors": {"get_actions": 3.869265719909934e-05, "un_batch_to_individual_items": 5.301211108338243e-06, "tensor_to_numpy": 1.2921807389789978e-05, "normalize_and_clip_actions": 9.246516221031717e-06, "remove_single_ts_time_rank_from_batch": 5.781011090350758e-07, "listify_data_for_vector_env": 1.0844842940103155e-05}}, "connector_pipeline_timer": 0.00010274384990770284}, "env_reset_timer": 3.437019209019397e-05, "env_to_module_connector": {"timers": {"connectors": {"numpy_to_tensor": 8.391410658959952e-06, "batch_individual_items": 6.195636467514392e-06, "add_states_from_episodes_to_batch": 1.7093400057291148e-06, "add_time_dim_to_batch_and_zero_pad": 2.3086507532976643e-06, "add_observations_from_episodes_to_batch": 3.002212363739049e-06}}, "connector_pipeline_timer": 4.301972690122391e-05}, "num_agent_steps_sampled_lifetime": {"default_agent": -4930000.0}, "agent_episode_returns_mean": {"default_agent": 2.1}, "num_episodes": 250.0, "num_env_steps_sampled_lifetime": -4930000.0, "episode_len_max": 20, "rlmodule_inference_timer": 2.712090831779889e-05, "weights_seq_no": 9.0, "episode_len_min": 20, "num_env_steps_sampled": 5000.0, "time_between_sampling": 0.0019340017443179574, "episode_len_mean": 20.0, "episode_duration_sec_mean": 0.004476378826890141, "env_step_timer": 1.346539977967107e-05, "num_agent_steps_sampled": {"default_agent": 5000.0}, "num_episodes_lifetime": -246500.0, "module_episode_returns_mean": {"default_policy": 2.1}, "num_module_steps_sampled": {"default_policy": 5000.0}, "episode_return_max": 6.5, "sample": 0.004873630374326849, "episode_return_mean": 2.1, "env_to_module_sum_episodes_length_out": 10.36823839457432, "num_module_steps_sampled_lifetime": {"default_policy": -4930000.0}, "num_env_steps_sampled_lifetime_throughput": 3774.6239773832917}, "learners": {"default_policy": {"num_trainable_parameters": 6003, "diff_num_grad_updates_vs_sampler_policy": 1.0, "gradients_default_optimizer_global_norm": 0.14334608614444733, "default_optimizer_learning_rate": 0.0002847858517, "module_train_batch_size_mean": 1000.0, "vf_loss_unclipped": 26.331432342529297, "curr_entropy_coeff": 0.0090570820258, "num_module_steps_trained": 6000, "total_loss": 0.14046528935432434, "vf_explained_var": -0.016974687576293945, "num_module_steps_trained_lifetime": 60000, "curr_kl_coeff": 0.0007290003122761846, "policy_loss": 0.07686588913202286, "mean_kl_loss": 0.0009531740797683597, "entropy": 0.5677953362464905, "vf_loss": 0.10278083384037018, "weights_seq_no": 10.0, "num_module_steps_trained_lifetime_throughput": 351326.93238053605}, "__all_modules__": {"learner_connector": {"timers": {"connectors": {"add_observations_from_episodes_to_batch": 0.0008733069491241639, "general_advantage_estimation": 0.006816981917536593, "batch_individual_items": 0.03370363426938348, "numpy_to_tensor": 8.094666363328985e-05, "add_one_ts_to_episodes_and_truncate": 0.009171369671613245, "add_time_dim_to_batch_and_zero_pad": 1.1988527287887855e-05, "add_columns_from_episodes_to_train_batch": 0.03431553805827485, "add_states_from_episodes_to_batch": 4.234225952833366e-06}}, "connector_pipeline_timer": 0.0851287224419139}, "learner_connector_sum_episodes_length_in": 5000.0, "num_trainable_parameters": 6003, "num_env_steps_trained": 31500, "num_module_steps_trained": 6000, "learner_connector_sum_episodes_length_out": 5250.0, "num_non_trainable_parameters": 0, "num_module_steps_trained_lifetime": 60000, "num_env_steps_trained_lifetime": 315000, "num_env_steps_trained_lifetime_throughput": 1836900.52237171, "num_module_steps_trained_throughput": 350959.75455343974, "num_module_steps_trained_lifetime_throughput": 350528.5714955169}}, "num_training_step_calls_per_iteration": 1, "evaluation": {"env_runners": {"num_agent_steps_sampled_lifetime": {"default_agent": 4000}, "env_to_module_sum_episodes_length_in": 10.368238394574323, "agent_episode_returns_mean": {"default_agent": 2.3}, "env_to_module_connector": {"timers": {"connectors": {"add_observations_from_episodes_to_batch": 2.795322836028167e-06, "batch_individual_items": 6.1948423137248764e-06, "numpy_to_tensor": 8.411911706503922e-06, "add_time_dim_to_batch_and_zero_pad": 2.2777294581129486e-06, "add_states_from_episodes_to_batch": 1.5736099462501125e-06}}, "connector_pipeline_timer": 4.3113582870809824e-05}, "module_to_env_connector": {"connector_pipeline_timer": 0.00010283939036624211, "timers": {"connectors": {"remove_single_ts_time_rank_from_batch": 6.082817619571856e-07, "listify_data_for_vector_env": 1.1283403263244453e-05, "tensor_to_numpy": 1.3145282029929525e-05, "normalize_and_clip_actions": 9.498650353969933e-06, "un_batch_to_individual_items": 5.426907718033392e-06, "get_actions": 3.666421182058546e-05}}}, "episode_duration_sec_mean": 0.004607722053769976, "sample": 0.1241818649645786, "num_episodes": 20, "episode_len_min": 20, "num_module_steps_sampled": {"default_policy": 400}, "num_env_steps_sampled": 400, "num_episodes_lifetime": 200, "env_to_module_sum_episodes_length_out": 10.368238394574323, "episode_return_min": -15.5, "module_episode_returns_mean": {"default_policy": 2.3}, "num_env_steps_sampled_lifetime": 50400, "rlmodule_inference_timer": 2.7207095677744484e-05, "weights_seq_no": 10.0, "num_module_steps_sampled_lifetime": {"default_policy": 4000}, "env_step_timer": 1.414440833868083e-05, "episode_return_max": 13.5, "episode_return_mean": 2.3, "env_reset_timer": 0.0024019932690022778, "episode_len_max": 20, "num_agent_steps_sampled": {"default_agent": 400}, "episode_len_mean": 20.0, "time_between_sampling": 1.7424801972011734}, "num_healthy_workers": 1, "actor_manager_num_outstanding_async_reqs": 0, "num_remote_worker_restarts": 0}, "num_env_steps_sampled_lifetime": -4930000.0, "fault_tolerance": {"num_healthy_workers": 0, "num_remote_worker_restarts": 0}, "env_runner_group": {"actor_manager_num_outstanding_async_reqs": 0}, "done": false, "training_iteration": 10, "trial_id": "5029b_00000", "date": "2025-08-11_19-21-53", "timestamp": 1754932913, "time_this_iter_s": 1.6534161567687988, "time_total_s": 17.73105239868164, "pid": 14328, "hostname": "Mac", "node_ip": "127.0.0.1", "config": {"exploration_config": {}, "extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "placement_strategy": "PACK", "num_gpus": 0, "_fake_gpus": false, "num_cpus_for_main_process": 2, "eager_tracing": true, "eager_max_retraces": 20, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "torch_compile_learner": false, "torch_compile_learner_what_to_compile": "forward_train", "torch_compile_learner_dynamo_backend": "aot_eager", "torch_compile_learner_dynamo_mode": null, "torch_compile_worker": false, "torch_compile_worker_dynamo_backend": "aot_eager", "torch_compile_worker_dynamo_mode": null, "torch_ddp_kwargs": {}, "torch_skip_nan_gradients": false, "env": "Umbrella", "env_config": {}, "observation_space": null, "action_space": null, "clip_rewards": null, "normalize_actions": true, "clip_actions": false, "_is_atari": null, "disable_env_checking": false, "render_env": false, "action_mask_key": "action_mask", "env_runner_cls": null, "num_env_runners": 0, "create_local_env_runner": true, "num_envs_per_env_runner": 1, "gym_env_vectorize_mode": "SYNC", "num_cpus_per_env_runner": 1, "num_gpus_per_env_runner": 0, "custom_resources_per_env_runner": {}, "validate_env_runners_after_construction": true, "episodes_to_numpy": true, "max_requests_in_flight_per_env_runner": 1, "sample_timeout_s": 60.0, "_env_to_module_connector": null, "add_default_connectors_to_env_to_module_pipeline": true, "_module_to_env_connector": null, "add_default_connectors_to_module_to_env_pipeline": true, "merge_env_runner_states": "training_only", "broadcast_env_runner_states": true, "episode_lookback_horizon": 1, "rollout_fragment_length": "auto", "batch_mode": "complete_episodes", "compress_observations": false, "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "enable_tf1_exec_eagerly": false, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "preprocessor_pref": "deepmind", "observation_filter": "NoFilter", "update_worker_filter_stats": true, "use_worker_filter_stats": true, "sampler_perf_stats_ema_coef": null, "_is_online": true, "num_learners": 0, "num_gpus_per_learner": 0, "num_cpus_per_learner": "auto", "num_aggregator_actors_per_learner": 0, "max_requests_in_flight_per_aggregator_actor": 3, "local_gpu_idx": 0, "max_requests_in_flight_per_learner": 3, "gamma": 1, "lr": 0.0002847858517, "grad_clip": 0.5, "grad_clip_by": "global_norm", "_train_batch_size_per_learner": 5000, "train_batch_size": 4000, "num_epochs": 1, "minibatch_size": 1000, "shuffle_batch_per_epoch": true, "model": {"fcnet_hiddens": [256, 256], "fcnet_activation": "tanh", "fcnet_weights_initializer": null, "fcnet_weights_initializer_config": null, "fcnet_bias_initializer": null, "fcnet_bias_initializer_config": null, "conv_filters": null, "conv_activation": "relu", "conv_kernel_initializer": null, "conv_kernel_initializer_config": null, "conv_bias_initializer": null, "conv_bias_initializer_config": null, "conv_transpose_kernel_initializer": null, "conv_transpose_kernel_initializer_config": null, "conv_transpose_bias_initializer": null, "conv_transpose_bias_initializer_config": null, "post_fcnet_hiddens": [], "post_fcnet_activation": "relu", "post_fcnet_weights_initializer": null, "post_fcnet_weights_initializer_config": null, "post_fcnet_bias_initializer": null, "post_fcnet_bias_initializer_config": null, "free_log_std": false, "log_std_clip_param": 20.0, "no_final_linear": false, "vf_share_layers": false, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "lstm_weights_initializer": null, "lstm_weights_initializer_config": null, "lstm_bias_initializer": null, "lstm_bias_initializer_config": null, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "attention_use_n_prev_actions": 0, "attention_use_n_prev_rewards": 0, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": null, "custom_model_config": {}, "custom_action_dist": null, "custom_preprocessor": null, "encoder_latent_dim": null, "always_check_shapes": false, "lstm_use_prev_action_reward": -1, "_use_default_native_models": -1, "_disable_preprocessor_api": false, "_disable_action_flattening": false}, "_learner_connector": null, "add_default_connectors_to_learner_pipeline": true, "learner_config_dict": {}, "optimizer": {}, "_learner_class": null, "callbacks_on_algorithm_init": null, "callbacks_on_env_runners_recreated": null, "callbacks_on_offline_eval_runners_recreated": null, "callbacks_on_checkpoint_loaded": null, "callbacks_on_environment_created": null, "callbacks_on_episode_created": null, "callbacks_on_episode_start": null, "callbacks_on_episode_step": null, "callbacks_on_episode_end": null, "callbacks_on_evaluate_start": null, "callbacks_on_evaluate_end": null, "callbacks_on_evaluate_offline_start": null, "callbacks_on_evaluate_offline_end": null, "callbacks_on_sample_end": null, "callbacks_on_train_result": null, "explore": true, "enable_rl_module_and_learner": true, "enable_env_runner_and_connector_v2": true, "_prior_exploration_config": {"type": "StochasticSampling"}, "count_steps_by": "env_steps", "policy_map_capacity": 100, "policy_mapping_fn": "<function AlgorithmConfig.DEFAULT_POLICY_MAPPING_FN at 0x157405b20>", "policies_to_train": null, "policy_states_are_swappable": false, "observation_fn": null, "offline_data_class": null, "input_read_method": "read_parquet", "input_read_method_kwargs": {}, "input_read_schema": {}, "input_read_episodes": false, "input_read_sample_batches": false, "input_read_batch_size": null, "input_filesystem": null, "input_filesystem_kwargs": {}, "input_compress_columns": ["obs", "new_obs"], "input_spaces_jsonable": true, "materialize_data": false, "materialize_mapped_data": true, "map_batches_kwargs": {}, "iter_batches_kwargs": {}, "ignore_final_observation": false, "prelearner_class": null, "prelearner_buffer_class": null, "prelearner_buffer_kwargs": {}, "prelearner_module_synch_period": 10, "dataset_num_iters_per_learner": null, "input_config": {}, "actions_in_input_normalized": false, "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_config": {}, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "output_max_rows_per_file": null, "output_write_remaining_data": false, "output_write_method": "write_parquet", "output_write_method_kwargs": {}, "output_filesystem": null, "output_filesystem_kwargs": {}, "output_write_episodes": true, "offline_sampling": false, "evaluation_interval": 1, "evaluation_duration": 20, "evaluation_duration_unit": "episodes", "evaluation_sample_timeout_s": 120.0, "evaluation_auto_duration_min_env_steps_per_sample": 100, "evaluation_auto_duration_max_env_steps_per_sample": 2000, "evaluation_parallel_to_training": false, "evaluation_force_reset_envs_before_iteration": true, "evaluation_config": null, "off_policy_estimation_methods": {}, "ope_split_batch_by_episode": true, "evaluation_num_env_runners": 1, "in_evaluation": false, "sync_filters_on_rollout_workers_timeout_s": 10.0, "offline_evaluation_interval": null, "num_offline_eval_runners": 0, "offline_loss_for_module_fn": null, "offline_evaluation_duration": 1, "offline_evaluation_parallel_to_training": false, "offline_evaluation_timeout_s": 120.0, "num_cpus_per_offline_eval_runner": 1, "num_gpus_per_offline_eval_runner": 0, "custom_resources_per_offline_eval_runner": {}, "restart_failed_offline_eval_runners": true, "ignore_offline_eval_runner_failures": false, "max_num_offline_eval_runner_restarts": 1000, "offline_eval_runner_restore_timeout_s": 1800.0, "max_requests_in_flight_per_offline_eval_runner": 1, "validate_offline_eval_runners_after_construction": true, "offline_eval_runner_health_probe_timeout_s": 30.0, "offline_eval_rl_module_inference_only": false, "broadcast_offline_eval_runner_states": false, "offline_eval_batch_size_per_runner": 256, "dataset_num_iters_per_eval_runner": 1, "keep_per_episode_custom_metrics": false, "metrics_episode_collection_timeout_s": 60.0, "metrics_num_episodes_for_smoothing": 100, "min_time_s_per_iteration": null, "min_train_timesteps_per_iteration": 0, "min_sample_timesteps_per_iteration": 0, "log_gradients": true, "export_native_model_files": false, "checkpoint_trainable_policies_only": false, "logger_creator": null, "logger_config": null, "log_level": "WARN", "log_sys_usage": true, "fake_sampler": false, "seed": 5, "restart_failed_env_runners": true, "ignore_env_runner_failures": false, "max_num_env_runner_restarts": 1000, "delay_between_env_runner_restarts_s": 60.0, "restart_failed_sub_environments": false, "num_consecutive_env_runner_failures_tolerance": 100, "env_runner_health_probe_timeout_s": 30.0, "env_runner_restore_timeout_s": 1800.0, "_model_config": {}, "_rl_module_spec": "RLModuleSpec(module_class=None, observation_space=None, action_space=None, inference_only=False, learner_only=False, model_config=DefaultModelConfig(fcnet_hiddens=[60, 90], fcnet_activation='tanh', fcnet_kernel_initializer=None, fcnet_kernel_initializer_kwargs=None, fcnet_bias_initializer=None, fcnet_bias_initializer_kwargs=None, conv_filters=None, conv_activation='relu', conv_kernel_initializer=None, conv_kernel_initializer_kwargs=None, conv_bias_initializer=None, conv_bias_initializer_kwargs=None, head_fcnet_hiddens=[], head_fcnet_activation='relu', head_fcnet_kernel_initializer=None, head_fcnet_kernel_initializer_kwargs=None, head_fcnet_bias_initializer=None, head_fcnet_bias_initializer_kwargs=None, free_log_std=False, log_std_clip_param=20.0, vf_share_layers=True, use_lstm=False, max_seq_len=20, lstm_cell_size=256, lstm_use_prev_action=False, lstm_use_prev_reward=False, lstm_kernel_initializer=None, lstm_kernel_initializer_kwargs=None, lstm_bias_initializer=None, lstm_bias_initializer_kwargs=None), catalog_class=None, load_state_path=None, model_config_dict=None)", "algorithm_config_overrides_per_module": {}, "_per_module_overrides": {}, "_validate_config": true, "_use_msgpack_checkpoints": false, "_torch_grad_scaler_class": null, "_torch_lr_scheduler_classes": null, "_tf_policy_handles_more_than_one_loss": false, "_disable_preprocessor_api": false, "_disable_action_flattening": false, "_disable_initialize_loss_from_dummy_batch": false, "_dont_auto_sync_env_runner_states": false, "env_task_fn": -1, "enable_connectors": -1, "simple_optimizer": false, "policy_map_cache": -1, "worker_cls": -1, "synchronize_filters": -1, "enable_async_evaluation": -1, "custom_async_evaluation_function": -1, "_enable_rl_module_api": -1, "auto_wrap_old_gym_envs": -1, "always_attach_evaluation_results": -1, "replay_sequence_length": null, "_disable_execution_plan_api": -1, "use_critic": true, "use_gae": true, "use_kl_loss": true, "kl_coeff": 0.7464963036515, "kl_target": 0.0270990929592, "vf_loss_coeff": 0.6688075857018, "entropy_coeff": 0.0090570820258, "clip_param": 0.1221781641624, "vf_clip_param": 0.1027808522125, "entropy_coeff_schedule": null, "lr_schedule": null, "sgd_minibatch_size": -1, "vf_share_layers": -1, "__stdout_file__": null, "__stderr_file__": null, "lambda": 0.9099046732075, "input": "sampler", "policies": {"default_policy": [null, null, null, null]}, "callbacks": "<class 'ray.rllib.callbacks.callbacks.RLlibCallback'>", "create_env_on_driver": false, "custom_eval_function": null, "framework": "torch"}, "time_since_restore": 17.73105239868164, "iterations_since_restore": 10, "perf": {"cpu_util_percent": 41.6, "ram_util_percent": 79.75}}
{"timers": {"training_iteration": 1.7839612484348666, "restore_env_runners": 3.6206182667414925e-05, "training_step": 1.7836122961052199, "env_runner_sampling_timer": 1.666330930659742, "learner_update_timer": 0.11389643349448385, "synch_weights": 0.0006656651019275686, "restore_eval_env_runners": 1.011134706080393e-05, "evaluation_iteration": 0.1379048322103789, "synch_eval_env_connectors": 0.0001449850470088951, "synch_env_connectors": 4.823792766139343e-06}, "env_runners": {"env_to_module_sum_episodes_length_in": 10.36823839457432, "episode_return_min": -13.5, "module_to_env_connector": {"timers": {"connectors": {"get_actions": 3.9668712844572704e-05, "un_batch_to_individual_items": 5.368828959152251e-06, "tensor_to_numpy": 1.3266354732031406e-05, "normalize_and_clip_actions": 9.387436021975417e-06, "remove_single_ts_time_rank_from_batch": 5.810724445654043e-07, "listify_data_for_vector_env": 1.0999280741270762e-05}}, "connector_pipeline_timer": 0.00010468908212613265}, "env_reset_timer": 3.220629548476399e-05, "env_to_module_connector": {"timers": {"connectors": {"numpy_to_tensor": 8.531298519574047e-06, "batch_individual_items": 6.300909028689071e-06, "add_states_from_episodes_to_batch": 1.7297454160975205e-06, "add_time_dim_to_batch_and_zero_pad": 2.336031323719169e-06, "add_observations_from_episodes_to_batch": 2.997727124715181e-06}}, "connector_pipeline_timer": 4.3537233374732076e-05}, "num_agent_steps_sampled_lifetime": {"default_agent": -5547500.0}, "agent_episode_returns_mean": {"default_agent": 2.899999999999998}, "num_episodes": 250.0, "num_env_steps_sampled_lifetime": -5547500.0, "episode_len_max": 20, "rlmodule_inference_timer": 2.8402817661319386e-05, "weights_seq_no": 10.0, "episode_len_min": 20, "num_env_steps_sampled": 5000.0, "time_between_sampling": 0.0018613730975491232, "episode_len_mean": 20.0, "episode_duration_sec_mean": 0.004577351602260024, "env_step_timer": 1.3719439114264837e-05, "num_agent_steps_sampled": {"default_agent": 5000.0}, "num_episodes_lifetime": -277375.0, "module_episode_returns_mean": {"default_policy": 2.899999999999998}, "num_module_steps_sampled": {"default_policy": 5000.0}, "episode_return_max": 6.5, "sample": 0.004812725940671603, "episode_return_mean": 2.899999999999998, "env_to_module_sum_episodes_length_out": 10.36823839457432, "num_module_steps_sampled_lifetime": {"default_policy": -5547500.0}, "num_env_steps_sampled_lifetime_throughput": 3750.912496294927}, "learners": {"default_policy": {"num_trainable_parameters": 6003, "diff_num_grad_updates_vs_sampler_policy": 1.0, "gradients_default_optimizer_global_norm": 0.028718072921037674, "default_optimizer_learning_rate": 0.0002847858517, "module_train_batch_size_mean": 1000.0, "vf_loss_unclipped": 24.314098358154297, "curr_entropy_coeff": 0.0090570820258, "num_module_steps_trained": 6000, "total_loss": 0.02838999032974243, "vf_explained_var": -0.0189741849899292, "num_module_steps_trained_lifetime": 66000, "curr_kl_coeff": 0.0003645001561380923, "policy_loss": -0.03556709364056587, "mean_kl_loss": 0.001295494264923036, "entropy": 0.5282582640647888, "vf_loss": 0.10278083384037018, "weights_seq_no": 11.0, "num_module_steps_trained_lifetime_throughput": 352846.2570901517}, "__all_modules__": {"learner_connector": {"timers": {"connectors": {"add_observations_from_episodes_to_batch": 0.0008732413798568867, "general_advantage_estimation": 0.006800627928299505, "batch_individual_items": 0.03367803083707425, "numpy_to_tensor": 8.075969649828959e-05, "add_one_ts_to_episodes_and_truncate": 0.009154575565157945, "add_time_dim_to_batch_and_zero_pad": 1.1963642738385847e-05, "add_columns_from_episodes_to_train_batch": 0.034321592257564065, "add_states_from_episodes_to_batch": 4.221463662428038e-06}}, "connector_pipeline_timer": 0.08507518187744977}, "learner_connector_sum_episodes_length_in": 5000.0, "num_trainable_parameters": 6003, "num_env_steps_trained": 31500, "num_module_steps_trained": 6000, "learner_connector_sum_episodes_length_out": 5250.0, "num_non_trainable_parameters": 0, "num_module_steps_trained_lifetime": 66000, "num_env_steps_trained_lifetime": 346500, "num_env_steps_trained_lifetime_throughput": 1845350.3763921969, "num_module_steps_trained_throughput": 352527.7171509082, "num_module_steps_trained_lifetime_throughput": 352109.9302216271}}, "num_training_step_calls_per_iteration": 1, "evaluation": {"env_runners": {"num_agent_steps_sampled_lifetime": {"default_agent": 4400}, "env_to_module_sum_episodes_length_in": 10.368238394574323, "agent_episode_returns_mean": {"default_agent": 1.9}, "env_to_module_connector": {"timers": {"connectors": {"add_observations_from_episodes_to_batch": 2.7670082329631986e-06, "batch_individual_items": 5.99791178498371e-06, "numpy_to_tensor": 8.205373289730354e-06, "add_time_dim_to_batch_and_zero_pad": 2.2621059506392076e-06, "add_states_from_episodes_to_batch": 1.5587074038570352e-06}}, "connector_pipeline_timer": 4.266627532811012e-05}, "module_to_env_connector": {"connector_pipeline_timer": 0.00010070032665878232, "timers": {"connectors": {"remove_single_ts_time_rank_from_batch": 5.67448383511724e-07, "listify_data_for_vector_env": 1.1120044811106796e-05, "tensor_to_numpy": 1.2884939317954062e-05, "normalize_and_clip_actions": 9.223456529640773e-06, "un_batch_to_individual_items": 5.2605117037737185e-06, "get_actions": 3.5830065273547676e-05}}}, "episode_duration_sec_mean": 0.004605574943125248, "sample": 0.12391288714515086, "num_episodes": 20, "episode_len_min": 20, "num_module_steps_sampled": {"default_policy": 400}, "num_env_steps_sampled": 400, "num_episodes_lifetime": 220, "env_to_module_sum_episodes_length_out": 10.368238394574323, "episode_return_min": -15.5, "module_episode_returns_mean": {"default_policy": 1.9}, "num_env_steps_sampled_lifetime": 55400, "rlmodule_inference_timer": 2.6795922570810078e-05, "weights_seq_no": 11.0, "num_module_steps_sampled_lifetime": {"default_policy": 4400}, "env_step_timer": 1.3785280223921203e-05, "episode_return_max": 12.5, "episode_return_mean": 1.9, "env_reset_timer": 0.0023786908365369644, "episode_len_max": 20, "num_agent_steps_sampled": {"default_agent": 400}, "episode_len_mean": 20.0, "time_between_sampling": 1.7400119823083755}, "num_healthy_workers": 1, "actor_manager_num_outstanding_async_reqs": 0, "num_remote_worker_restarts": 0}, "num_env_steps_sampled_lifetime": -5547500.0, "fault_tolerance": {"num_healthy_workers": 0, "num_remote_worker_restarts": 0}, "env_runner_group": {"actor_manager_num_outstanding_async_reqs": 0}, "done": false, "training_iteration": 11, "trial_id": "5029b_00000", "date": "2025-08-11_19-21-55", "timestamp": 1754932915, "time_this_iter_s": 1.5831091403961182, "time_total_s": 19.31416153907776, "pid": 14328, "hostname": "Mac", "node_ip": "127.0.0.1", "config": {"exploration_config": {}, "extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "placement_strategy": "PACK", "num_gpus": 0, "_fake_gpus": false, "num_cpus_for_main_process": 2, "eager_tracing": true, "eager_max_retraces": 20, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "torch_compile_learner": false, "torch_compile_learner_what_to_compile": "forward_train", "torch_compile_learner_dynamo_backend": "aot_eager", "torch_compile_learner_dynamo_mode": null, "torch_compile_worker": false, "torch_compile_worker_dynamo_backend": "aot_eager", "torch_compile_worker_dynamo_mode": null, "torch_ddp_kwargs": {}, "torch_skip_nan_gradients": false, "env": "Umbrella", "env_config": {}, "observation_space": null, "action_space": null, "clip_rewards": null, "normalize_actions": true, "clip_actions": false, "_is_atari": null, "disable_env_checking": false, "render_env": false, "action_mask_key": "action_mask", "env_runner_cls": null, "num_env_runners": 0, "create_local_env_runner": true, "num_envs_per_env_runner": 1, "gym_env_vectorize_mode": "SYNC", "num_cpus_per_env_runner": 1, "num_gpus_per_env_runner": 0, "custom_resources_per_env_runner": {}, "validate_env_runners_after_construction": true, "episodes_to_numpy": true, "max_requests_in_flight_per_env_runner": 1, "sample_timeout_s": 60.0, "_env_to_module_connector": null, "add_default_connectors_to_env_to_module_pipeline": true, "_module_to_env_connector": null, "add_default_connectors_to_module_to_env_pipeline": true, "merge_env_runner_states": "training_only", "broadcast_env_runner_states": true, "episode_lookback_horizon": 1, "rollout_fragment_length": "auto", "batch_mode": "complete_episodes", "compress_observations": false, "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "enable_tf1_exec_eagerly": false, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "preprocessor_pref": "deepmind", "observation_filter": "NoFilter", "update_worker_filter_stats": true, "use_worker_filter_stats": true, "sampler_perf_stats_ema_coef": null, "_is_online": true, "num_learners": 0, "num_gpus_per_learner": 0, "num_cpus_per_learner": "auto", "num_aggregator_actors_per_learner": 0, "max_requests_in_flight_per_aggregator_actor": 3, "local_gpu_idx": 0, "max_requests_in_flight_per_learner": 3, "gamma": 1, "lr": 0.0002847858517, "grad_clip": 0.5, "grad_clip_by": "global_norm", "_train_batch_size_per_learner": 5000, "train_batch_size": 4000, "num_epochs": 1, "minibatch_size": 1000, "shuffle_batch_per_epoch": true, "model": {"fcnet_hiddens": [256, 256], "fcnet_activation": "tanh", "fcnet_weights_initializer": null, "fcnet_weights_initializer_config": null, "fcnet_bias_initializer": null, "fcnet_bias_initializer_config": null, "conv_filters": null, "conv_activation": "relu", "conv_kernel_initializer": null, "conv_kernel_initializer_config": null, "conv_bias_initializer": null, "conv_bias_initializer_config": null, "conv_transpose_kernel_initializer": null, "conv_transpose_kernel_initializer_config": null, "conv_transpose_bias_initializer": null, "conv_transpose_bias_initializer_config": null, "post_fcnet_hiddens": [], "post_fcnet_activation": "relu", "post_fcnet_weights_initializer": null, "post_fcnet_weights_initializer_config": null, "post_fcnet_bias_initializer": null, "post_fcnet_bias_initializer_config": null, "free_log_std": false, "log_std_clip_param": 20.0, "no_final_linear": false, "vf_share_layers": false, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "lstm_weights_initializer": null, "lstm_weights_initializer_config": null, "lstm_bias_initializer": null, "lstm_bias_initializer_config": null, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "attention_use_n_prev_actions": 0, "attention_use_n_prev_rewards": 0, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": null, "custom_model_config": {}, "custom_action_dist": null, "custom_preprocessor": null, "encoder_latent_dim": null, "always_check_shapes": false, "lstm_use_prev_action_reward": -1, "_use_default_native_models": -1, "_disable_preprocessor_api": false, "_disable_action_flattening": false}, "_learner_connector": null, "add_default_connectors_to_learner_pipeline": true, "learner_config_dict": {}, "optimizer": {}, "_learner_class": null, "callbacks_on_algorithm_init": null, "callbacks_on_env_runners_recreated": null, "callbacks_on_offline_eval_runners_recreated": null, "callbacks_on_checkpoint_loaded": null, "callbacks_on_environment_created": null, "callbacks_on_episode_created": null, "callbacks_on_episode_start": null, "callbacks_on_episode_step": null, "callbacks_on_episode_end": null, "callbacks_on_evaluate_start": null, "callbacks_on_evaluate_end": null, "callbacks_on_evaluate_offline_start": null, "callbacks_on_evaluate_offline_end": null, "callbacks_on_sample_end": null, "callbacks_on_train_result": null, "explore": true, "enable_rl_module_and_learner": true, "enable_env_runner_and_connector_v2": true, "_prior_exploration_config": {"type": "StochasticSampling"}, "count_steps_by": "env_steps", "policy_map_capacity": 100, "policy_mapping_fn": "<function AlgorithmConfig.DEFAULT_POLICY_MAPPING_FN at 0x157405b20>", "policies_to_train": null, "policy_states_are_swappable": false, "observation_fn": null, "offline_data_class": null, "input_read_method": "read_parquet", "input_read_method_kwargs": {}, "input_read_schema": {}, "input_read_episodes": false, "input_read_sample_batches": false, "input_read_batch_size": null, "input_filesystem": null, "input_filesystem_kwargs": {}, "input_compress_columns": ["obs", "new_obs"], "input_spaces_jsonable": true, "materialize_data": false, "materialize_mapped_data": true, "map_batches_kwargs": {}, "iter_batches_kwargs": {}, "ignore_final_observation": false, "prelearner_class": null, "prelearner_buffer_class": null, "prelearner_buffer_kwargs": {}, "prelearner_module_synch_period": 10, "dataset_num_iters_per_learner": null, "input_config": {}, "actions_in_input_normalized": false, "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_config": {}, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "output_max_rows_per_file": null, "output_write_remaining_data": false, "output_write_method": "write_parquet", "output_write_method_kwargs": {}, "output_filesystem": null, "output_filesystem_kwargs": {}, "output_write_episodes": true, "offline_sampling": false, "evaluation_interval": 1, "evaluation_duration": 20, "evaluation_duration_unit": "episodes", "evaluation_sample_timeout_s": 120.0, "evaluation_auto_duration_min_env_steps_per_sample": 100, "evaluation_auto_duration_max_env_steps_per_sample": 2000, "evaluation_parallel_to_training": false, "evaluation_force_reset_envs_before_iteration": true, "evaluation_config": null, "off_policy_estimation_methods": {}, "ope_split_batch_by_episode": true, "evaluation_num_env_runners": 1, "in_evaluation": false, "sync_filters_on_rollout_workers_timeout_s": 10.0, "offline_evaluation_interval": null, "num_offline_eval_runners": 0, "offline_loss_for_module_fn": null, "offline_evaluation_duration": 1, "offline_evaluation_parallel_to_training": false, "offline_evaluation_timeout_s": 120.0, "num_cpus_per_offline_eval_runner": 1, "num_gpus_per_offline_eval_runner": 0, "custom_resources_per_offline_eval_runner": {}, "restart_failed_offline_eval_runners": true, "ignore_offline_eval_runner_failures": false, "max_num_offline_eval_runner_restarts": 1000, "offline_eval_runner_restore_timeout_s": 1800.0, "max_requests_in_flight_per_offline_eval_runner": 1, "validate_offline_eval_runners_after_construction": true, "offline_eval_runner_health_probe_timeout_s": 30.0, "offline_eval_rl_module_inference_only": false, "broadcast_offline_eval_runner_states": false, "offline_eval_batch_size_per_runner": 256, "dataset_num_iters_per_eval_runner": 1, "keep_per_episode_custom_metrics": false, "metrics_episode_collection_timeout_s": 60.0, "metrics_num_episodes_for_smoothing": 100, "min_time_s_per_iteration": null, "min_train_timesteps_per_iteration": 0, "min_sample_timesteps_per_iteration": 0, "log_gradients": true, "export_native_model_files": false, "checkpoint_trainable_policies_only": false, "logger_creator": null, "logger_config": null, "log_level": "WARN", "log_sys_usage": true, "fake_sampler": false, "seed": 5, "restart_failed_env_runners": true, "ignore_env_runner_failures": false, "max_num_env_runner_restarts": 1000, "delay_between_env_runner_restarts_s": 60.0, "restart_failed_sub_environments": false, "num_consecutive_env_runner_failures_tolerance": 100, "env_runner_health_probe_timeout_s": 30.0, "env_runner_restore_timeout_s": 1800.0, "_model_config": {}, "_rl_module_spec": "RLModuleSpec(module_class=None, observation_space=None, action_space=None, inference_only=False, learner_only=False, model_config=DefaultModelConfig(fcnet_hiddens=[60, 90], fcnet_activation='tanh', fcnet_kernel_initializer=None, fcnet_kernel_initializer_kwargs=None, fcnet_bias_initializer=None, fcnet_bias_initializer_kwargs=None, conv_filters=None, conv_activation='relu', conv_kernel_initializer=None, conv_kernel_initializer_kwargs=None, conv_bias_initializer=None, conv_bias_initializer_kwargs=None, head_fcnet_hiddens=[], head_fcnet_activation='relu', head_fcnet_kernel_initializer=None, head_fcnet_kernel_initializer_kwargs=None, head_fcnet_bias_initializer=None, head_fcnet_bias_initializer_kwargs=None, free_log_std=False, log_std_clip_param=20.0, vf_share_layers=True, use_lstm=False, max_seq_len=20, lstm_cell_size=256, lstm_use_prev_action=False, lstm_use_prev_reward=False, lstm_kernel_initializer=None, lstm_kernel_initializer_kwargs=None, lstm_bias_initializer=None, lstm_bias_initializer_kwargs=None), catalog_class=None, load_state_path=None, model_config_dict=None)", "algorithm_config_overrides_per_module": {}, "_per_module_overrides": {}, "_validate_config": true, "_use_msgpack_checkpoints": false, "_torch_grad_scaler_class": null, "_torch_lr_scheduler_classes": null, "_tf_policy_handles_more_than_one_loss": false, "_disable_preprocessor_api": false, "_disable_action_flattening": false, "_disable_initialize_loss_from_dummy_batch": false, "_dont_auto_sync_env_runner_states": false, "env_task_fn": -1, "enable_connectors": -1, "simple_optimizer": false, "policy_map_cache": -1, "worker_cls": -1, "synchronize_filters": -1, "enable_async_evaluation": -1, "custom_async_evaluation_function": -1, "_enable_rl_module_api": -1, "auto_wrap_old_gym_envs": -1, "always_attach_evaluation_results": -1, "replay_sequence_length": null, "_disable_execution_plan_api": -1, "use_critic": true, "use_gae": true, "use_kl_loss": true, "kl_coeff": 0.7464963036515, "kl_target": 0.0270990929592, "vf_loss_coeff": 0.6688075857018, "entropy_coeff": 0.0090570820258, "clip_param": 0.1221781641624, "vf_clip_param": 0.1027808522125, "entropy_coeff_schedule": null, "lr_schedule": null, "sgd_minibatch_size": -1, "vf_share_layers": -1, "__stdout_file__": null, "__stderr_file__": null, "lambda": 0.9099046732075, "input": "sampler", "policies": {"default_policy": [null, null, null, null]}, "callbacks": "<class 'ray.rllib.callbacks.callbacks.RLlibCallback'>", "create_env_on_driver": false, "custom_eval_function": null, "framework": "torch"}, "time_since_restore": 19.31416153907776, "iterations_since_restore": 11, "perf": {"cpu_util_percent": 39.900000000000006, "ram_util_percent": 78.4}}
{"timers": {"training_iteration": 1.7844065809507137, "restore_env_runners": 3.590162186065075e-05, "training_step": 1.7840582548035853, "env_runner_sampling_timer": 1.6667540213528245, "learner_update_timer": 0.11386861291014325, "synch_weights": 0.0007079622008462295, "restore_eval_env_runners": 1.0080234123210426e-05, "evaluation_iteration": 0.13754950763795185, "synch_eval_env_connectors": 0.00014446144689784962, "synch_env_connectors": 4.815555143057684e-06}, "env_runners": {"env_to_module_sum_episodes_length_in": 10.36823839457432, "episode_return_min": -13.5, "module_to_env_connector": {"timers": {"connectors": {"get_actions": 4.6786400826852546e-05, "un_batch_to_individual_items": 7.01387792846681e-06, "tensor_to_numpy": 1.4580259537299522e-05, "normalize_and_clip_actions": 1.1025038039109348e-05, "remove_single_ts_time_rank_from_batch": 6.457060887105557e-07, "listify_data_for_vector_env": 1.2069578078884382e-05}}, "connector_pipeline_timer": 0.00012013825165506}, "env_reset_timer": 3.703317326321087e-05, "env_to_module_connector": {"timers": {"connectors": {"numpy_to_tensor": 9.584478663957546e-06, "batch_individual_items": 6.8748173774879296e-06, "add_states_from_episodes_to_batch": 1.8366323842100342e-06, "add_time_dim_to_batch_and_zero_pad": 2.6906769985573952e-06, "add_observations_from_episodes_to_batch": 3.418343681722704e-06}}, "connector_pipeline_timer": 4.756934131206529e-05}, "num_agent_steps_sampled_lifetime": {"default_agent": -6165000.0}, "agent_episode_returns_mean": {"default_agent": 3.38}, "num_episodes": 250.0, "num_env_steps_sampled_lifetime": -6165000.0, "episode_len_max": 20, "rlmodule_inference_timer": 3.268265413042763e-05, "weights_seq_no": 11.0, "episode_len_min": 20, "num_env_steps_sampled": 5000.0, "time_between_sampling": 0.001853649339019553, "episode_len_mean": 20.0, "episode_duration_sec_mean": 0.005251723005902023, "env_step_timer": 1.555071853373595e-05, "num_agent_steps_sampled": {"default_agent": 5000.0}, "num_episodes_lifetime": -308250.0, "module_episode_returns_mean": {"default_policy": 3.38}, "num_module_steps_sampled": {"default_policy": 5000.0}, "episode_return_max": 6.5, "sample": 0.0050581211750596895, "episode_return_mean": 3.38, "env_to_module_sum_episodes_length_out": 10.36823839457432, "num_module_steps_sampled_lifetime": {"default_policy": -6165000.0}, "num_env_steps_sampled_lifetime_throughput": 3519.6197054850686}, "learners": {"default_policy": {"num_trainable_parameters": 6003, "diff_num_grad_updates_vs_sampler_policy": 1.0, "gradients_default_optimizer_global_norm": 0.04764096066355705, "default_optimizer_learning_rate": 0.0002847858517, "module_train_batch_size_mean": 1000.0, "vf_loss_unclipped": 23.894079208374023, "curr_entropy_coeff": 0.0090570820258, "num_module_steps_trained": 6000, "total_loss": 0.010113202035427094, "vf_explained_var": -0.02031266689300537, "num_module_steps_trained_lifetime": 72000, "curr_kl_coeff": 0.00018225007806904614, "policy_loss": -0.0541551373898983, "mean_kl_loss": 0.0012555166613310575, "entropy": 0.493836909532547, "vf_loss": 0.10278083384037018, "weights_seq_no": 12.0, "num_module_steps_trained_lifetime_throughput": 352961.6970669535}, "__all_modules__": {"learner_connector": {"timers": {"connectors": {"add_observations_from_episodes_to_batch": 0.000875928545445029, "general_advantage_estimation": 0.006801717058724607, "batch_individual_items": 0.03364950719953614, "numpy_to_tensor": 8.072792965501759e-05, "add_one_ts_to_episodes_and_truncate": 0.00917446980939781, "add_time_dim_to_batch_and_zero_pad": 1.2137757092567894e-05, "add_columns_from_episodes_to_train_batch": 0.03435746300498853, "add_states_from_episodes_to_batch": 4.213839510378194e-06}}, "connector_pipeline_timer": 0.0851062296392046}, "learner_connector_sum_episodes_length_in": 5000.0, "num_trainable_parameters": 6003, "num_env_steps_trained": 31500, "num_module_steps_trained": 6000, "learner_connector_sum_episodes_length_out": 5250.0, "num_non_trainable_parameters": 0, "num_module_steps_trained_lifetime": 72000, "num_env_steps_trained_lifetime": 378000, "num_env_steps_trained_lifetime_throughput": 1846396.6985764918, "num_module_steps_trained_throughput": 352685.52765721944, "num_module_steps_trained_lifetime_throughput": 352281.6789499988}}, "num_training_step_calls_per_iteration": 1, "evaluation": {"env_runners": {"num_agent_steps_sampled_lifetime": {"default_agent": 4800}, "env_to_module_sum_episodes_length_in": 10.368238394574323, "agent_episode_returns_mean": {"default_agent": 1.5}, "env_to_module_connector": {"timers": {"connectors": {"add_observations_from_episodes_to_batch": 2.856227593174063e-06, "batch_individual_items": 6.22940092476119e-06, "numpy_to_tensor": 8.699672800066579e-06, "add_time_dim_to_batch_and_zero_pad": 2.315911854323742e-06, "add_states_from_episodes_to_batch": 1.5921241249470352e-06}}, "connector_pipeline_timer": 4.404457865413056e-05}, "module_to_env_connector": {"connector_pipeline_timer": 0.00010565343883210755, "timers": {"connectors": {"remove_single_ts_time_rank_from_batch": 5.928741459889428e-07, "listify_data_for_vector_env": 1.1499369751015426e-05, "tensor_to_numpy": 1.3527059506828999e-05, "normalize_and_clip_actions": 9.733138496478652e-06, "un_batch_to_individual_items": 5.599366589612216e-06, "get_actions": 3.822247884084125e-05}}}, "episode_duration_sec_mean": 0.004646281623281539, "sample": 0.12372268952381521, "num_episodes": 20, "episode_len_min": 20, "num_module_steps_sampled": {"default_policy": 400}, "num_env_steps_sampled": 400, "num_episodes_lifetime": 240, "env_to_module_sum_episodes_length_out": 10.368238394574323, "episode_return_min": -15.5, "module_episode_returns_mean": {"default_policy": 1.5}, "num_env_steps_sampled_lifetime": 60400, "rlmodule_inference_timer": 2.8533698899018712e-05, "weights_seq_no": 12.0, "num_module_steps_sampled_lifetime": {"default_policy": 4800}, "env_step_timer": 1.4685226165319563e-05, "episode_return_max": 12.5, "episode_return_mean": 1.5, "env_reset_timer": 0.0023577593387381483, "episode_len_max": 20, "num_agent_steps_sampled": {"default_agent": 400}, "episode_len_mean": 20.0, "time_between_sampling": 1.7411658112346142}, "num_healthy_workers": 1, "actor_manager_num_outstanding_async_reqs": 0, "num_remote_worker_restarts": 0}, "num_env_steps_sampled_lifetime": -6165000.0, "fault_tolerance": {"num_healthy_workers": 0, "num_remote_worker_restarts": 0}, "env_runner_group": {"actor_manager_num_outstanding_async_reqs": 0}, "done": false, "training_iteration": 12, "trial_id": "5029b_00000", "date": "2025-08-11_19-21-56", "timestamp": 1754932916, "time_this_iter_s": 1.948850154876709, "time_total_s": 21.263011693954468, "pid": 14328, "hostname": "Mac", "node_ip": "127.0.0.1", "config": {"exploration_config": {}, "extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "placement_strategy": "PACK", "num_gpus": 0, "_fake_gpus": false, "num_cpus_for_main_process": 2, "eager_tracing": true, "eager_max_retraces": 20, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "torch_compile_learner": false, "torch_compile_learner_what_to_compile": "forward_train", "torch_compile_learner_dynamo_backend": "aot_eager", "torch_compile_learner_dynamo_mode": null, "torch_compile_worker": false, "torch_compile_worker_dynamo_backend": "aot_eager", "torch_compile_worker_dynamo_mode": null, "torch_ddp_kwargs": {}, "torch_skip_nan_gradients": false, "env": "Umbrella", "env_config": {}, "observation_space": null, "action_space": null, "clip_rewards": null, "normalize_actions": true, "clip_actions": false, "_is_atari": null, "disable_env_checking": false, "render_env": false, "action_mask_key": "action_mask", "env_runner_cls": null, "num_env_runners": 0, "create_local_env_runner": true, "num_envs_per_env_runner": 1, "gym_env_vectorize_mode": "SYNC", "num_cpus_per_env_runner": 1, "num_gpus_per_env_runner": 0, "custom_resources_per_env_runner": {}, "validate_env_runners_after_construction": true, "episodes_to_numpy": true, "max_requests_in_flight_per_env_runner": 1, "sample_timeout_s": 60.0, "_env_to_module_connector": null, "add_default_connectors_to_env_to_module_pipeline": true, "_module_to_env_connector": null, "add_default_connectors_to_module_to_env_pipeline": true, "merge_env_runner_states": "training_only", "broadcast_env_runner_states": true, "episode_lookback_horizon": 1, "rollout_fragment_length": "auto", "batch_mode": "complete_episodes", "compress_observations": false, "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "enable_tf1_exec_eagerly": false, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "preprocessor_pref": "deepmind", "observation_filter": "NoFilter", "update_worker_filter_stats": true, "use_worker_filter_stats": true, "sampler_perf_stats_ema_coef": null, "_is_online": true, "num_learners": 0, "num_gpus_per_learner": 0, "num_cpus_per_learner": "auto", "num_aggregator_actors_per_learner": 0, "max_requests_in_flight_per_aggregator_actor": 3, "local_gpu_idx": 0, "max_requests_in_flight_per_learner": 3, "gamma": 1, "lr": 0.0002847858517, "grad_clip": 0.5, "grad_clip_by": "global_norm", "_train_batch_size_per_learner": 5000, "train_batch_size": 4000, "num_epochs": 1, "minibatch_size": 1000, "shuffle_batch_per_epoch": true, "model": {"fcnet_hiddens": [256, 256], "fcnet_activation": "tanh", "fcnet_weights_initializer": null, "fcnet_weights_initializer_config": null, "fcnet_bias_initializer": null, "fcnet_bias_initializer_config": null, "conv_filters": null, "conv_activation": "relu", "conv_kernel_initializer": null, "conv_kernel_initializer_config": null, "conv_bias_initializer": null, "conv_bias_initializer_config": null, "conv_transpose_kernel_initializer": null, "conv_transpose_kernel_initializer_config": null, "conv_transpose_bias_initializer": null, "conv_transpose_bias_initializer_config": null, "post_fcnet_hiddens": [], "post_fcnet_activation": "relu", "post_fcnet_weights_initializer": null, "post_fcnet_weights_initializer_config": null, "post_fcnet_bias_initializer": null, "post_fcnet_bias_initializer_config": null, "free_log_std": false, "log_std_clip_param": 20.0, "no_final_linear": false, "vf_share_layers": false, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "lstm_weights_initializer": null, "lstm_weights_initializer_config": null, "lstm_bias_initializer": null, "lstm_bias_initializer_config": null, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "attention_use_n_prev_actions": 0, "attention_use_n_prev_rewards": 0, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": null, "custom_model_config": {}, "custom_action_dist": null, "custom_preprocessor": null, "encoder_latent_dim": null, "always_check_shapes": false, "lstm_use_prev_action_reward": -1, "_use_default_native_models": -1, "_disable_preprocessor_api": false, "_disable_action_flattening": false}, "_learner_connector": null, "add_default_connectors_to_learner_pipeline": true, "learner_config_dict": {}, "optimizer": {}, "_learner_class": null, "callbacks_on_algorithm_init": null, "callbacks_on_env_runners_recreated": null, "callbacks_on_offline_eval_runners_recreated": null, "callbacks_on_checkpoint_loaded": null, "callbacks_on_environment_created": null, "callbacks_on_episode_created": null, "callbacks_on_episode_start": null, "callbacks_on_episode_step": null, "callbacks_on_episode_end": null, "callbacks_on_evaluate_start": null, "callbacks_on_evaluate_end": null, "callbacks_on_evaluate_offline_start": null, "callbacks_on_evaluate_offline_end": null, "callbacks_on_sample_end": null, "callbacks_on_train_result": null, "explore": true, "enable_rl_module_and_learner": true, "enable_env_runner_and_connector_v2": true, "_prior_exploration_config": {"type": "StochasticSampling"}, "count_steps_by": "env_steps", "policy_map_capacity": 100, "policy_mapping_fn": "<function AlgorithmConfig.DEFAULT_POLICY_MAPPING_FN at 0x157405b20>", "policies_to_train": null, "policy_states_are_swappable": false, "observation_fn": null, "offline_data_class": null, "input_read_method": "read_parquet", "input_read_method_kwargs": {}, "input_read_schema": {}, "input_read_episodes": false, "input_read_sample_batches": false, "input_read_batch_size": null, "input_filesystem": null, "input_filesystem_kwargs": {}, "input_compress_columns": ["obs", "new_obs"], "input_spaces_jsonable": true, "materialize_data": false, "materialize_mapped_data": true, "map_batches_kwargs": {}, "iter_batches_kwargs": {}, "ignore_final_observation": false, "prelearner_class": null, "prelearner_buffer_class": null, "prelearner_buffer_kwargs": {}, "prelearner_module_synch_period": 10, "dataset_num_iters_per_learner": null, "input_config": {}, "actions_in_input_normalized": false, "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_config": {}, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "output_max_rows_per_file": null, "output_write_remaining_data": false, "output_write_method": "write_parquet", "output_write_method_kwargs": {}, "output_filesystem": null, "output_filesystem_kwargs": {}, "output_write_episodes": true, "offline_sampling": false, "evaluation_interval": 1, "evaluation_duration": 20, "evaluation_duration_unit": "episodes", "evaluation_sample_timeout_s": 120.0, "evaluation_auto_duration_min_env_steps_per_sample": 100, "evaluation_auto_duration_max_env_steps_per_sample": 2000, "evaluation_parallel_to_training": false, "evaluation_force_reset_envs_before_iteration": true, "evaluation_config": null, "off_policy_estimation_methods": {}, "ope_split_batch_by_episode": true, "evaluation_num_env_runners": 1, "in_evaluation": false, "sync_filters_on_rollout_workers_timeout_s": 10.0, "offline_evaluation_interval": null, "num_offline_eval_runners": 0, "offline_loss_for_module_fn": null, "offline_evaluation_duration": 1, "offline_evaluation_parallel_to_training": false, "offline_evaluation_timeout_s": 120.0, "num_cpus_per_offline_eval_runner": 1, "num_gpus_per_offline_eval_runner": 0, "custom_resources_per_offline_eval_runner": {}, "restart_failed_offline_eval_runners": true, "ignore_offline_eval_runner_failures": false, "max_num_offline_eval_runner_restarts": 1000, "offline_eval_runner_restore_timeout_s": 1800.0, "max_requests_in_flight_per_offline_eval_runner": 1, "validate_offline_eval_runners_after_construction": true, "offline_eval_runner_health_probe_timeout_s": 30.0, "offline_eval_rl_module_inference_only": false, "broadcast_offline_eval_runner_states": false, "offline_eval_batch_size_per_runner": 256, "dataset_num_iters_per_eval_runner": 1, "keep_per_episode_custom_metrics": false, "metrics_episode_collection_timeout_s": 60.0, "metrics_num_episodes_for_smoothing": 100, "min_time_s_per_iteration": null, "min_train_timesteps_per_iteration": 0, "min_sample_timesteps_per_iteration": 0, "log_gradients": true, "export_native_model_files": false, "checkpoint_trainable_policies_only": false, "logger_creator": null, "logger_config": null, "log_level": "WARN", "log_sys_usage": true, "fake_sampler": false, "seed": 5, "restart_failed_env_runners": true, "ignore_env_runner_failures": false, "max_num_env_runner_restarts": 1000, "delay_between_env_runner_restarts_s": 60.0, "restart_failed_sub_environments": false, "num_consecutive_env_runner_failures_tolerance": 100, "env_runner_health_probe_timeout_s": 30.0, "env_runner_restore_timeout_s": 1800.0, "_model_config": {}, "_rl_module_spec": "RLModuleSpec(module_class=None, observation_space=None, action_space=None, inference_only=False, learner_only=False, model_config=DefaultModelConfig(fcnet_hiddens=[60, 90], fcnet_activation='tanh', fcnet_kernel_initializer=None, fcnet_kernel_initializer_kwargs=None, fcnet_bias_initializer=None, fcnet_bias_initializer_kwargs=None, conv_filters=None, conv_activation='relu', conv_kernel_initializer=None, conv_kernel_initializer_kwargs=None, conv_bias_initializer=None, conv_bias_initializer_kwargs=None, head_fcnet_hiddens=[], head_fcnet_activation='relu', head_fcnet_kernel_initializer=None, head_fcnet_kernel_initializer_kwargs=None, head_fcnet_bias_initializer=None, head_fcnet_bias_initializer_kwargs=None, free_log_std=False, log_std_clip_param=20.0, vf_share_layers=True, use_lstm=False, max_seq_len=20, lstm_cell_size=256, lstm_use_prev_action=False, lstm_use_prev_reward=False, lstm_kernel_initializer=None, lstm_kernel_initializer_kwargs=None, lstm_bias_initializer=None, lstm_bias_initializer_kwargs=None), catalog_class=None, load_state_path=None, model_config_dict=None)", "algorithm_config_overrides_per_module": {}, "_per_module_overrides": {}, "_validate_config": true, "_use_msgpack_checkpoints": false, "_torch_grad_scaler_class": null, "_torch_lr_scheduler_classes": null, "_tf_policy_handles_more_than_one_loss": false, "_disable_preprocessor_api": false, "_disable_action_flattening": false, "_disable_initialize_loss_from_dummy_batch": false, "_dont_auto_sync_env_runner_states": false, "env_task_fn": -1, "enable_connectors": -1, "simple_optimizer": false, "policy_map_cache": -1, "worker_cls": -1, "synchronize_filters": -1, "enable_async_evaluation": -1, "custom_async_evaluation_function": -1, "_enable_rl_module_api": -1, "auto_wrap_old_gym_envs": -1, "always_attach_evaluation_results": -1, "replay_sequence_length": null, "_disable_execution_plan_api": -1, "use_critic": true, "use_gae": true, "use_kl_loss": true, "kl_coeff": 0.7464963036515, "kl_target": 0.0270990929592, "vf_loss_coeff": 0.6688075857018, "entropy_coeff": 0.0090570820258, "clip_param": 0.1221781641624, "vf_clip_param": 0.1027808522125, "entropy_coeff_schedule": null, "lr_schedule": null, "sgd_minibatch_size": -1, "vf_share_layers": -1, "__stdout_file__": null, "__stderr_file__": null, "lambda": 0.9099046732075, "input": "sampler", "policies": {"default_policy": [null, null, null, null]}, "callbacks": "<class 'ray.rllib.callbacks.callbacks.RLlibCallback'>", "create_env_on_driver": false, "custom_eval_function": null, "framework": "torch"}, "time_since_restore": 21.263011693954468, "iterations_since_restore": 12, "perf": {"cpu_util_percent": 50.43333333333334, "ram_util_percent": 80.53333333333335}}
{"timers": {"training_iteration": 1.784381870141017, "restore_env_runners": 3.5669695084729486e-05, "training_step": 1.784034879755888, "env_runner_sampling_timer": 1.6667878540500527, "learner_update_timer": 0.11381170553039972, "synch_weights": 0.0007075384083307236, "restore_eval_env_runners": 1.0381931936428856e-05, "evaluation_iteration": 0.13733760339139175, "synch_eval_env_connectors": 0.00014436641197174642, "synch_env_connectors": 4.933229725109922e-06}, "env_runners": {"env_to_module_sum_episodes_length_in": 10.36823839457432, "episode_return_min": -13.5, "module_to_env_connector": {"timers": {"connectors": {"get_actions": 4.590138662601006e-05, "un_batch_to_individual_items": 6.064549215979309e-06, "tensor_to_numpy": 1.438794033436702e-05, "normalize_and_clip_actions": 1.0268638715311388e-05, "remove_single_ts_time_rank_from_batch": 6.472980437821095e-07, "listify_data_for_vector_env": 1.2798166084405323e-05}}, "connector_pipeline_timer": 0.00011761687557643183}, "env_reset_timer": 4.7152544600549124e-05, "env_to_module_connector": {"timers": {"connectors": {"numpy_to_tensor": 9.360083781021537e-06, "batch_individual_items": 6.771576181615135e-06, "add_states_from_episodes_to_batch": 1.834989572755186e-06, "add_time_dim_to_batch_and_zero_pad": 3.712229971814548e-06, "add_observations_from_episodes_to_batch": 3.4051798089903446e-06}}, "connector_pipeline_timer": 4.7861961816734386e-05}, "num_agent_steps_sampled_lifetime": {"default_agent": -6782500.0}, "agent_episode_returns_mean": {"default_agent": 3.7799999999999994}, "num_episodes": 250.0, "num_env_steps_sampled_lifetime": -6782500.0, "episode_len_max": 20, "rlmodule_inference_timer": 3.025999981430023e-05, "weights_seq_no": 12.0, "episode_len_min": 20, "num_env_steps_sampled": 5000.0, "time_between_sampling": 0.0021443681238398015, "episode_len_mean": 20.0, "episode_duration_sec_mean": 0.00498583613615483, "env_step_timer": 1.5291769727416398e-05, "num_agent_steps_sampled": {"default_agent": 5000.0}, "num_episodes_lifetime": -339125.0, "module_episode_returns_mean": {"default_policy": 3.7799999999999994}, "num_module_steps_sampled": {"default_policy": 5000.0}, "episode_return_max": 6.5, "sample": 0.005589774165088866, "episode_return_mean": 3.7799999999999994, "env_to_module_sum_episodes_length_out": 10.36823839457432, "num_module_steps_sampled_lifetime": {"default_policy": -6782500.0}, "num_env_steps_sampled_lifetime_throughput": 3471.010623993994}, "learners": {"default_policy": {"num_trainable_parameters": 6003, "diff_num_grad_updates_vs_sampler_policy": 1.0, "gradients_default_optimizer_global_norm": 0.11829666048288345, "default_optimizer_learning_rate": 0.0002847858517, "module_train_batch_size_mean": 1000.0, "vf_loss_unclipped": 23.493480682373047, "curr_entropy_coeff": 0.0090570820258, "num_module_steps_trained": 6000, "total_loss": 0.006881259847432375, "vf_explained_var": -0.021043896675109863, "num_module_steps_trained_lifetime": 78000, "curr_kl_coeff": 9.112503903452307e-05, "policy_loss": -0.0575651116669178, "mean_kl_loss": 0.00026610048371367157, "entropy": 0.47413647174835205, "vf_loss": 0.10278083384037018, "weights_seq_no": 13.0, "num_module_steps_trained_lifetime_throughput": 352342.08918095386}, "__all_modules__": {"learner_connector": {"timers": {"connectors": {"add_observations_from_episodes_to_batch": 0.0008765371799832342, "general_advantage_estimation": 0.00680434946800322, "batch_individual_items": 0.03363769212715305, "numpy_to_tensor": 8.080065007430226e-05, "add_one_ts_to_episodes_and_truncate": 0.009163828861575555, "add_time_dim_to_batch_and_zero_pad": 1.2298039407883174e-05, "add_columns_from_episodes_to_train_batch": 0.034402473784321, "add_states_from_episodes_to_batch": 4.229200971031171e-06}}, "connector_pipeline_timer": 0.08513242109245321}, "learner_connector_sum_episodes_length_in": 5000.0, "num_trainable_parameters": 6003, "num_env_steps_trained": 31500, "num_module_steps_trained": 6000, "learner_connector_sum_episodes_length_out": 5250.0, "num_non_trainable_parameters": 0, "num_module_steps_trained_lifetime": 78000, "num_env_steps_trained_lifetime": 409500, "num_env_steps_trained_lifetime_throughput": 1843581.0386729997, "num_module_steps_trained_throughput": 352108.0883681354, "num_module_steps_trained_lifetime_throughput": 351718.2472696389}}, "num_training_step_calls_per_iteration": 1, "evaluation": {"env_runners": {"num_agent_steps_sampled_lifetime": {"default_agent": 5200}, "env_to_module_sum_episodes_length_in": 10.368238394574323, "agent_episode_returns_mean": {"default_agent": 1.5}, "env_to_module_connector": {"timers": {"connectors": {"add_observations_from_episodes_to_batch": 2.864242602034498e-06, "batch_individual_items": 6.3120162945997865e-06, "numpy_to_tensor": 8.799697149094838e-06, "add_time_dim_to_batch_and_zero_pad": 2.423555694422175e-06, "add_states_from_episodes_to_batch": 1.6139168273293561e-06}}, "connector_pipeline_timer": 4.4140610089829575e-05}, "module_to_env_connector": {"connector_pipeline_timer": 0.00010861225846086383, "timers": {"connectors": {"remove_single_ts_time_rank_from_batch": 6.002793683875943e-07, "listify_data_for_vector_env": 1.1725542557780548e-05, "tensor_to_numpy": 1.390355208894084e-05, "normalize_and_clip_actions": 1.0161097066624232e-05, "un_batch_to_individual_items": 5.521320570109651e-06, "get_actions": 3.9665154372066624e-05}}}, "episode_duration_sec_mean": 0.004675712073221803, "sample": 0.1235370597185494, "num_episodes": 20, "episode_len_min": 20, "num_module_steps_sampled": {"default_policy": 400}, "num_env_steps_sampled": 400, "num_episodes_lifetime": 260, "env_to_module_sum_episodes_length_out": 10.368238394574323, "episode_return_min": -15.5, "module_episode_returns_mean": {"default_policy": 1.5}, "num_env_steps_sampled_lifetime": 65400, "rlmodule_inference_timer": 2.9239497365920285e-05, "weights_seq_no": 13.0, "num_module_steps_sampled_lifetime": {"default_policy": 5200}, "env_step_timer": 1.5259708934345867e-05, "episode_return_max": 12.5, "episode_return_mean": 1.5, "env_reset_timer": 0.002334891744936291, "episode_len_max": 20, "num_agent_steps_sampled": {"default_agent": 400}, "episode_len_mean": 20.0, "time_between_sampling": 1.7418278718714875}, "num_healthy_workers": 1, "actor_manager_num_outstanding_async_reqs": 0, "num_remote_worker_restarts": 0}, "num_env_steps_sampled_lifetime": -6782500.0, "fault_tolerance": {"num_healthy_workers": 0, "num_remote_worker_restarts": 0}, "env_runner_group": {"actor_manager_num_outstanding_async_reqs": 0}, "done": false, "training_iteration": 13, "trial_id": "5029b_00000", "date": "2025-08-11_19-21-58", "timestamp": 1754932918, "time_this_iter_s": 1.8953397274017334, "time_total_s": 23.1583514213562, "pid": 14328, "hostname": "Mac", "node_ip": "127.0.0.1", "config": {"exploration_config": {}, "extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "placement_strategy": "PACK", "num_gpus": 0, "_fake_gpus": false, "num_cpus_for_main_process": 2, "eager_tracing": true, "eager_max_retraces": 20, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "torch_compile_learner": false, "torch_compile_learner_what_to_compile": "forward_train", "torch_compile_learner_dynamo_backend": "aot_eager", "torch_compile_learner_dynamo_mode": null, "torch_compile_worker": false, "torch_compile_worker_dynamo_backend": "aot_eager", "torch_compile_worker_dynamo_mode": null, "torch_ddp_kwargs": {}, "torch_skip_nan_gradients": false, "env": "Umbrella", "env_config": {}, "observation_space": null, "action_space": null, "clip_rewards": null, "normalize_actions": true, "clip_actions": false, "_is_atari": null, "disable_env_checking": false, "render_env": false, "action_mask_key": "action_mask", "env_runner_cls": null, "num_env_runners": 0, "create_local_env_runner": true, "num_envs_per_env_runner": 1, "gym_env_vectorize_mode": "SYNC", "num_cpus_per_env_runner": 1, "num_gpus_per_env_runner": 0, "custom_resources_per_env_runner": {}, "validate_env_runners_after_construction": true, "episodes_to_numpy": true, "max_requests_in_flight_per_env_runner": 1, "sample_timeout_s": 60.0, "_env_to_module_connector": null, "add_default_connectors_to_env_to_module_pipeline": true, "_module_to_env_connector": null, "add_default_connectors_to_module_to_env_pipeline": true, "merge_env_runner_states": "training_only", "broadcast_env_runner_states": true, "episode_lookback_horizon": 1, "rollout_fragment_length": "auto", "batch_mode": "complete_episodes", "compress_observations": false, "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "enable_tf1_exec_eagerly": false, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "preprocessor_pref": "deepmind", "observation_filter": "NoFilter", "update_worker_filter_stats": true, "use_worker_filter_stats": true, "sampler_perf_stats_ema_coef": null, "_is_online": true, "num_learners": 0, "num_gpus_per_learner": 0, "num_cpus_per_learner": "auto", "num_aggregator_actors_per_learner": 0, "max_requests_in_flight_per_aggregator_actor": 3, "local_gpu_idx": 0, "max_requests_in_flight_per_learner": 3, "gamma": 1, "lr": 0.0002847858517, "grad_clip": 0.5, "grad_clip_by": "global_norm", "_train_batch_size_per_learner": 5000, "train_batch_size": 4000, "num_epochs": 1, "minibatch_size": 1000, "shuffle_batch_per_epoch": true, "model": {"fcnet_hiddens": [256, 256], "fcnet_activation": "tanh", "fcnet_weights_initializer": null, "fcnet_weights_initializer_config": null, "fcnet_bias_initializer": null, "fcnet_bias_initializer_config": null, "conv_filters": null, "conv_activation": "relu", "conv_kernel_initializer": null, "conv_kernel_initializer_config": null, "conv_bias_initializer": null, "conv_bias_initializer_config": null, "conv_transpose_kernel_initializer": null, "conv_transpose_kernel_initializer_config": null, "conv_transpose_bias_initializer": null, "conv_transpose_bias_initializer_config": null, "post_fcnet_hiddens": [], "post_fcnet_activation": "relu", "post_fcnet_weights_initializer": null, "post_fcnet_weights_initializer_config": null, "post_fcnet_bias_initializer": null, "post_fcnet_bias_initializer_config": null, "free_log_std": false, "log_std_clip_param": 20.0, "no_final_linear": false, "vf_share_layers": false, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "lstm_weights_initializer": null, "lstm_weights_initializer_config": null, "lstm_bias_initializer": null, "lstm_bias_initializer_config": null, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "attention_use_n_prev_actions": 0, "attention_use_n_prev_rewards": 0, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": null, "custom_model_config": {}, "custom_action_dist": null, "custom_preprocessor": null, "encoder_latent_dim": null, "always_check_shapes": false, "lstm_use_prev_action_reward": -1, "_use_default_native_models": -1, "_disable_preprocessor_api": false, "_disable_action_flattening": false}, "_learner_connector": null, "add_default_connectors_to_learner_pipeline": true, "learner_config_dict": {}, "optimizer": {}, "_learner_class": null, "callbacks_on_algorithm_init": null, "callbacks_on_env_runners_recreated": null, "callbacks_on_offline_eval_runners_recreated": null, "callbacks_on_checkpoint_loaded": null, "callbacks_on_environment_created": null, "callbacks_on_episode_created": null, "callbacks_on_episode_start": null, "callbacks_on_episode_step": null, "callbacks_on_episode_end": null, "callbacks_on_evaluate_start": null, "callbacks_on_evaluate_end": null, "callbacks_on_evaluate_offline_start": null, "callbacks_on_evaluate_offline_end": null, "callbacks_on_sample_end": null, "callbacks_on_train_result": null, "explore": true, "enable_rl_module_and_learner": true, "enable_env_runner_and_connector_v2": true, "_prior_exploration_config": {"type": "StochasticSampling"}, "count_steps_by": "env_steps", "policy_map_capacity": 100, "policy_mapping_fn": "<function AlgorithmConfig.DEFAULT_POLICY_MAPPING_FN at 0x157405b20>", "policies_to_train": null, "policy_states_are_swappable": false, "observation_fn": null, "offline_data_class": null, "input_read_method": "read_parquet", "input_read_method_kwargs": {}, "input_read_schema": {}, "input_read_episodes": false, "input_read_sample_batches": false, "input_read_batch_size": null, "input_filesystem": null, "input_filesystem_kwargs": {}, "input_compress_columns": ["obs", "new_obs"], "input_spaces_jsonable": true, "materialize_data": false, "materialize_mapped_data": true, "map_batches_kwargs": {}, "iter_batches_kwargs": {}, "ignore_final_observation": false, "prelearner_class": null, "prelearner_buffer_class": null, "prelearner_buffer_kwargs": {}, "prelearner_module_synch_period": 10, "dataset_num_iters_per_learner": null, "input_config": {}, "actions_in_input_normalized": false, "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_config": {}, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "output_max_rows_per_file": null, "output_write_remaining_data": false, "output_write_method": "write_parquet", "output_write_method_kwargs": {}, "output_filesystem": null, "output_filesystem_kwargs": {}, "output_write_episodes": true, "offline_sampling": false, "evaluation_interval": 1, "evaluation_duration": 20, "evaluation_duration_unit": "episodes", "evaluation_sample_timeout_s": 120.0, "evaluation_auto_duration_min_env_steps_per_sample": 100, "evaluation_auto_duration_max_env_steps_per_sample": 2000, "evaluation_parallel_to_training": false, "evaluation_force_reset_envs_before_iteration": true, "evaluation_config": null, "off_policy_estimation_methods": {}, "ope_split_batch_by_episode": true, "evaluation_num_env_runners": 1, "in_evaluation": false, "sync_filters_on_rollout_workers_timeout_s": 10.0, "offline_evaluation_interval": null, "num_offline_eval_runners": 0, "offline_loss_for_module_fn": null, "offline_evaluation_duration": 1, "offline_evaluation_parallel_to_training": false, "offline_evaluation_timeout_s": 120.0, "num_cpus_per_offline_eval_runner": 1, "num_gpus_per_offline_eval_runner": 0, "custom_resources_per_offline_eval_runner": {}, "restart_failed_offline_eval_runners": true, "ignore_offline_eval_runner_failures": false, "max_num_offline_eval_runner_restarts": 1000, "offline_eval_runner_restore_timeout_s": 1800.0, "max_requests_in_flight_per_offline_eval_runner": 1, "validate_offline_eval_runners_after_construction": true, "offline_eval_runner_health_probe_timeout_s": 30.0, "offline_eval_rl_module_inference_only": false, "broadcast_offline_eval_runner_states": false, "offline_eval_batch_size_per_runner": 256, "dataset_num_iters_per_eval_runner": 1, "keep_per_episode_custom_metrics": false, "metrics_episode_collection_timeout_s": 60.0, "metrics_num_episodes_for_smoothing": 100, "min_time_s_per_iteration": null, "min_train_timesteps_per_iteration": 0, "min_sample_timesteps_per_iteration": 0, "log_gradients": true, "export_native_model_files": false, "checkpoint_trainable_policies_only": false, "logger_creator": null, "logger_config": null, "log_level": "WARN", "log_sys_usage": true, "fake_sampler": false, "seed": 5, "restart_failed_env_runners": true, "ignore_env_runner_failures": false, "max_num_env_runner_restarts": 1000, "delay_between_env_runner_restarts_s": 60.0, "restart_failed_sub_environments": false, "num_consecutive_env_runner_failures_tolerance": 100, "env_runner_health_probe_timeout_s": 30.0, "env_runner_restore_timeout_s": 1800.0, "_model_config": {}, "_rl_module_spec": "RLModuleSpec(module_class=None, observation_space=None, action_space=None, inference_only=False, learner_only=False, model_config=DefaultModelConfig(fcnet_hiddens=[60, 90], fcnet_activation='tanh', fcnet_kernel_initializer=None, fcnet_kernel_initializer_kwargs=None, fcnet_bias_initializer=None, fcnet_bias_initializer_kwargs=None, conv_filters=None, conv_activation='relu', conv_kernel_initializer=None, conv_kernel_initializer_kwargs=None, conv_bias_initializer=None, conv_bias_initializer_kwargs=None, head_fcnet_hiddens=[], head_fcnet_activation='relu', head_fcnet_kernel_initializer=None, head_fcnet_kernel_initializer_kwargs=None, head_fcnet_bias_initializer=None, head_fcnet_bias_initializer_kwargs=None, free_log_std=False, log_std_clip_param=20.0, vf_share_layers=True, use_lstm=False, max_seq_len=20, lstm_cell_size=256, lstm_use_prev_action=False, lstm_use_prev_reward=False, lstm_kernel_initializer=None, lstm_kernel_initializer_kwargs=None, lstm_bias_initializer=None, lstm_bias_initializer_kwargs=None), catalog_class=None, load_state_path=None, model_config_dict=None)", "algorithm_config_overrides_per_module": {}, "_per_module_overrides": {}, "_validate_config": true, "_use_msgpack_checkpoints": false, "_torch_grad_scaler_class": null, "_torch_lr_scheduler_classes": null, "_tf_policy_handles_more_than_one_loss": false, "_disable_preprocessor_api": false, "_disable_action_flattening": false, "_disable_initialize_loss_from_dummy_batch": false, "_dont_auto_sync_env_runner_states": false, "env_task_fn": -1, "enable_connectors": -1, "simple_optimizer": false, "policy_map_cache": -1, "worker_cls": -1, "synchronize_filters": -1, "enable_async_evaluation": -1, "custom_async_evaluation_function": -1, "_enable_rl_module_api": -1, "auto_wrap_old_gym_envs": -1, "always_attach_evaluation_results": -1, "replay_sequence_length": null, "_disable_execution_plan_api": -1, "use_critic": true, "use_gae": true, "use_kl_loss": true, "kl_coeff": 0.7464963036515, "kl_target": 0.0270990929592, "vf_loss_coeff": 0.6688075857018, "entropy_coeff": 0.0090570820258, "clip_param": 0.1221781641624, "vf_clip_param": 0.1027808522125, "entropy_coeff_schedule": null, "lr_schedule": null, "sgd_minibatch_size": -1, "vf_share_layers": -1, "__stdout_file__": null, "__stderr_file__": null, "lambda": 0.9099046732075, "input": "sampler", "policies": {"default_policy": [null, null, null, null]}, "callbacks": "<class 'ray.rllib.callbacks.callbacks.RLlibCallback'>", "create_env_on_driver": false, "custom_eval_function": null, "framework": "torch"}, "time_since_restore": 23.1583514213562, "iterations_since_restore": 13, "perf": {"cpu_util_percent": 45.9, "ram_util_percent": 82.95}}
{"timers": {"training_iteration": 1.7826637022692422, "restore_env_runners": 3.5372578331439995e-05, "training_step": 1.7823184205382325, "env_runner_sampling_timer": 1.664291882589424, "learner_update_timer": 0.11459313972585339, "synch_weights": 0.0007069180245045359, "restore_eval_env_runners": 1.0382271733809563e-05, "evaluation_iteration": 0.13707376777806224, "synch_eval_env_connectors": 0.0001439769176950023, "synch_env_connectors": 4.926817428709977e-06}, "env_runners": {"env_to_module_sum_episodes_length_in": 10.36823839457432, "episode_return_min": -13.5, "module_to_env_connector": {"timers": {"connectors": {"get_actions": 4.1227715902938334e-05, "un_batch_to_individual_items": 5.5311722915376525e-06, "tensor_to_numpy": 1.361057468410613e-05, "normalize_and_clip_actions": 9.619590990830412e-06, "remove_single_ts_time_rank_from_batch": 5.91426965199005e-07, "listify_data_for_vector_env": 1.1268409960981727e-05}}, "connector_pipeline_timer": 0.0001076586314203238}, "env_reset_timer": 4.182306242351408e-05, "env_to_module_connector": {"timers": {"connectors": {"numpy_to_tensor": 8.864568952820068e-06, "batch_individual_items": 6.497304651501214e-06, "add_states_from_episodes_to_batch": 1.7380040583673553e-06, "add_time_dim_to_batch_and_zero_pad": 2.3836949428570836e-06, "add_observations_from_episodes_to_batch": 3.0461422444407103e-06}}, "connector_pipeline_timer": 4.440029431469594e-05}, "num_agent_steps_sampled_lifetime": {"default_agent": -7400000.0}, "agent_episode_returns_mean": {"default_agent": 4.18}, "num_episodes": 250.0, "num_env_steps_sampled_lifetime": -7400000.0, "episode_len_max": 20, "rlmodule_inference_timer": 2.901379214471953e-05, "weights_seq_no": 13.0, "episode_len_min": 20, "num_env_steps_sampled": 5000.0, "time_between_sampling": 0.0020147923135658205, "episode_len_mean": 20.0, "episode_duration_sec_mean": 0.004687576326541603, "env_step_timer": 1.4222499721033729e-05, "num_agent_steps_sampled": {"default_agent": 5000.0}, "num_episodes_lifetime": -370000.0, "module_episode_returns_mean": {"default_policy": 4.18}, "num_module_steps_sampled": {"default_policy": 5000.0}, "episode_return_max": 6.5, "sample": 0.005304359310871809, "episode_return_mean": 4.18, "env_to_module_sum_episodes_length_out": 10.36823839457432, "num_module_steps_sampled_lifetime": {"default_policy": -7400000.0}, "num_env_steps_sampled_lifetime_throughput": 3599.4894949953705}, "learners": {"default_policy": {"num_trainable_parameters": 6003, "diff_num_grad_updates_vs_sampler_policy": 1.0, "gradients_default_optimizer_global_norm": 0.035817701369524, "default_optimizer_learning_rate": 0.0002847858517, "module_train_batch_size_mean": 1000.0, "vf_loss_unclipped": 23.913816452026367, "curr_entropy_coeff": 0.0090570820258, "num_module_steps_trained": 6000, "total_loss": 0.11405530571937561, "vf_explained_var": -0.019382357597351074, "num_module_steps_trained_lifetime": 84000, "curr_kl_coeff": 4.5562519517261535e-05, "policy_loss": 0.04959893226623535, "mean_kl_loss": 4.542641545413062e-05, "entropy": 0.47302621603012085, "vf_loss": 0.10278083384037018, "weights_seq_no": 14.0, "num_module_steps_trained_lifetime_throughput": 352402.2465131012}, "__all_modules__": {"learner_connector": {"timers": {"connectors": {"add_observations_from_episodes_to_batch": 0.0008759763887008875, "general_advantage_estimation": 0.006792367633029944, "batch_individual_items": 0.034573898125218376, "numpy_to_tensor": 8.06834742121914e-05, "add_one_ts_to_episodes_and_truncate": 0.009148195573115218, "add_time_dim_to_batch_and_zero_pad": 1.227172913289621e-05, "add_columns_from_episodes_to_train_batch": 0.03441290279666532, "add_states_from_episodes_to_batch": 4.216068671132071e-06}}, "connector_pipeline_timer": 0.08605023479139741}, "learner_connector_sum_episodes_length_in": 5000.0, "num_trainable_parameters": 6003, "num_env_steps_trained": 31500, "num_module_steps_trained": 6000, "learner_connector_sum_episodes_length_out": 5250.0, "num_non_trainable_parameters": 0, "num_module_steps_trained_lifetime": 84000, "num_env_steps_trained_lifetime": 441000, "num_env_steps_trained_lifetime_throughput": 1844321.998719776, "num_module_steps_trained_throughput": 352210.532172806, "num_module_steps_trained_lifetime_throughput": 351833.74646807474}}, "num_training_step_calls_per_iteration": 1, "evaluation": {"env_runners": {"num_agent_steps_sampled_lifetime": {"default_agent": 5600}, "env_to_module_sum_episodes_length_in": 10.368238394574323, "agent_episode_returns_mean": {"default_agent": 1.9}, "env_to_module_connector": {"timers": {"connectors": {"add_observations_from_episodes_to_batch": 2.771323158764382e-06, "batch_individual_items": 6.082349551903698e-06, "numpy_to_tensor": 8.309513350596608e-06, "add_time_dim_to_batch_and_zero_pad": 2.277327128644747e-06, "add_states_from_episodes_to_batch": 1.6114291869604108e-06}}, "connector_pipeline_timer": 4.275097721632728e-05}, "module_to_env_connector": {"connector_pipeline_timer": 0.00010202577588681031, "timers": {"connectors": {"remove_single_ts_time_rank_from_batch": 5.881318247783678e-07, "listify_data_for_vector_env": 1.109932409590924e-05, "tensor_to_numpy": 1.3052413548503144e-05, "normalize_and_clip_actions": 9.477329122148637e-06, "un_batch_to_individual_items": 5.371073746986362e-06, "get_actions": 3.6348565364510855e-05}}}, "episode_duration_sec_mean": 0.004625041225226596, "sample": 0.12328756328132398, "num_episodes": 20, "episode_len_min": 20, "num_module_steps_sampled": {"default_policy": 400}, "num_env_steps_sampled": 400, "num_episodes_lifetime": 280, "env_to_module_sum_episodes_length_out": 10.368238394574323, "episode_return_min": -15.5, "module_episode_returns_mean": {"default_policy": 1.9}, "num_env_steps_sampled_lifetime": 70400, "rlmodule_inference_timer": 2.7204105984839532e-05, "weights_seq_no": 14.0, "num_module_steps_sampled_lifetime": {"default_policy": 5600}, "env_step_timer": 1.4011491929904845e-05, "episode_return_max": 12.5, "episode_return_mean": 1.9, "env_reset_timer": 0.0023123190767037976, "episode_len_max": 20, "num_agent_steps_sampled": {"default_agent": 400}, "episode_len_mean": 20.0, "time_between_sampling": 1.740730816903483}, "num_healthy_workers": 1, "actor_manager_num_outstanding_async_reqs": 0, "num_remote_worker_restarts": 0}, "num_env_steps_sampled_lifetime": -7400000.0, "fault_tolerance": {"num_healthy_workers": 0, "num_remote_worker_restarts": 0}, "env_runner_group": {"actor_manager_num_outstanding_async_reqs": 0}, "done": false, "training_iteration": 14, "trial_id": "5029b_00000", "date": "2025-08-11_19-22-00", "timestamp": 1754932920, "time_this_iter_s": 1.7189488410949707, "time_total_s": 24.877300262451172, "pid": 14328, "hostname": "Mac", "node_ip": "127.0.0.1", "config": {"exploration_config": {}, "extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "placement_strategy": "PACK", "num_gpus": 0, "_fake_gpus": false, "num_cpus_for_main_process": 2, "eager_tracing": true, "eager_max_retraces": 20, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "torch_compile_learner": false, "torch_compile_learner_what_to_compile": "forward_train", "torch_compile_learner_dynamo_backend": "aot_eager", "torch_compile_learner_dynamo_mode": null, "torch_compile_worker": false, "torch_compile_worker_dynamo_backend": "aot_eager", "torch_compile_worker_dynamo_mode": null, "torch_ddp_kwargs": {}, "torch_skip_nan_gradients": false, "env": "Umbrella", "env_config": {}, "observation_space": null, "action_space": null, "clip_rewards": null, "normalize_actions": true, "clip_actions": false, "_is_atari": null, "disable_env_checking": false, "render_env": false, "action_mask_key": "action_mask", "env_runner_cls": null, "num_env_runners": 0, "create_local_env_runner": true, "num_envs_per_env_runner": 1, "gym_env_vectorize_mode": "SYNC", "num_cpus_per_env_runner": 1, "num_gpus_per_env_runner": 0, "custom_resources_per_env_runner": {}, "validate_env_runners_after_construction": true, "episodes_to_numpy": true, "max_requests_in_flight_per_env_runner": 1, "sample_timeout_s": 60.0, "_env_to_module_connector": null, "add_default_connectors_to_env_to_module_pipeline": true, "_module_to_env_connector": null, "add_default_connectors_to_module_to_env_pipeline": true, "merge_env_runner_states": "training_only", "broadcast_env_runner_states": true, "episode_lookback_horizon": 1, "rollout_fragment_length": "auto", "batch_mode": "complete_episodes", "compress_observations": false, "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "enable_tf1_exec_eagerly": false, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "preprocessor_pref": "deepmind", "observation_filter": "NoFilter", "update_worker_filter_stats": true, "use_worker_filter_stats": true, "sampler_perf_stats_ema_coef": null, "_is_online": true, "num_learners": 0, "num_gpus_per_learner": 0, "num_cpus_per_learner": "auto", "num_aggregator_actors_per_learner": 0, "max_requests_in_flight_per_aggregator_actor": 3, "local_gpu_idx": 0, "max_requests_in_flight_per_learner": 3, "gamma": 1, "lr": 0.0002847858517, "grad_clip": 0.5, "grad_clip_by": "global_norm", "_train_batch_size_per_learner": 5000, "train_batch_size": 4000, "num_epochs": 1, "minibatch_size": 1000, "shuffle_batch_per_epoch": true, "model": {"fcnet_hiddens": [256, 256], "fcnet_activation": "tanh", "fcnet_weights_initializer": null, "fcnet_weights_initializer_config": null, "fcnet_bias_initializer": null, "fcnet_bias_initializer_config": null, "conv_filters": null, "conv_activation": "relu", "conv_kernel_initializer": null, "conv_kernel_initializer_config": null, "conv_bias_initializer": null, "conv_bias_initializer_config": null, "conv_transpose_kernel_initializer": null, "conv_transpose_kernel_initializer_config": null, "conv_transpose_bias_initializer": null, "conv_transpose_bias_initializer_config": null, "post_fcnet_hiddens": [], "post_fcnet_activation": "relu", "post_fcnet_weights_initializer": null, "post_fcnet_weights_initializer_config": null, "post_fcnet_bias_initializer": null, "post_fcnet_bias_initializer_config": null, "free_log_std": false, "log_std_clip_param": 20.0, "no_final_linear": false, "vf_share_layers": false, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "lstm_weights_initializer": null, "lstm_weights_initializer_config": null, "lstm_bias_initializer": null, "lstm_bias_initializer_config": null, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "attention_use_n_prev_actions": 0, "attention_use_n_prev_rewards": 0, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": null, "custom_model_config": {}, "custom_action_dist": null, "custom_preprocessor": null, "encoder_latent_dim": null, "always_check_shapes": false, "lstm_use_prev_action_reward": -1, "_use_default_native_models": -1, "_disable_preprocessor_api": false, "_disable_action_flattening": false}, "_learner_connector": null, "add_default_connectors_to_learner_pipeline": true, "learner_config_dict": {}, "optimizer": {}, "_learner_class": null, "callbacks_on_algorithm_init": null, "callbacks_on_env_runners_recreated": null, "callbacks_on_offline_eval_runners_recreated": null, "callbacks_on_checkpoint_loaded": null, "callbacks_on_environment_created": null, "callbacks_on_episode_created": null, "callbacks_on_episode_start": null, "callbacks_on_episode_step": null, "callbacks_on_episode_end": null, "callbacks_on_evaluate_start": null, "callbacks_on_evaluate_end": null, "callbacks_on_evaluate_offline_start": null, "callbacks_on_evaluate_offline_end": null, "callbacks_on_sample_end": null, "callbacks_on_train_result": null, "explore": true, "enable_rl_module_and_learner": true, "enable_env_runner_and_connector_v2": true, "_prior_exploration_config": {"type": "StochasticSampling"}, "count_steps_by": "env_steps", "policy_map_capacity": 100, "policy_mapping_fn": "<function AlgorithmConfig.DEFAULT_POLICY_MAPPING_FN at 0x157405b20>", "policies_to_train": null, "policy_states_are_swappable": false, "observation_fn": null, "offline_data_class": null, "input_read_method": "read_parquet", "input_read_method_kwargs": {}, "input_read_schema": {}, "input_read_episodes": false, "input_read_sample_batches": false, "input_read_batch_size": null, "input_filesystem": null, "input_filesystem_kwargs": {}, "input_compress_columns": ["obs", "new_obs"], "input_spaces_jsonable": true, "materialize_data": false, "materialize_mapped_data": true, "map_batches_kwargs": {}, "iter_batches_kwargs": {}, "ignore_final_observation": false, "prelearner_class": null, "prelearner_buffer_class": null, "prelearner_buffer_kwargs": {}, "prelearner_module_synch_period": 10, "dataset_num_iters_per_learner": null, "input_config": {}, "actions_in_input_normalized": false, "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_config": {}, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "output_max_rows_per_file": null, "output_write_remaining_data": false, "output_write_method": "write_parquet", "output_write_method_kwargs": {}, "output_filesystem": null, "output_filesystem_kwargs": {}, "output_write_episodes": true, "offline_sampling": false, "evaluation_interval": 1, "evaluation_duration": 20, "evaluation_duration_unit": "episodes", "evaluation_sample_timeout_s": 120.0, "evaluation_auto_duration_min_env_steps_per_sample": 100, "evaluation_auto_duration_max_env_steps_per_sample": 2000, "evaluation_parallel_to_training": false, "evaluation_force_reset_envs_before_iteration": true, "evaluation_config": null, "off_policy_estimation_methods": {}, "ope_split_batch_by_episode": true, "evaluation_num_env_runners": 1, "in_evaluation": false, "sync_filters_on_rollout_workers_timeout_s": 10.0, "offline_evaluation_interval": null, "num_offline_eval_runners": 0, "offline_loss_for_module_fn": null, "offline_evaluation_duration": 1, "offline_evaluation_parallel_to_training": false, "offline_evaluation_timeout_s": 120.0, "num_cpus_per_offline_eval_runner": 1, "num_gpus_per_offline_eval_runner": 0, "custom_resources_per_offline_eval_runner": {}, "restart_failed_offline_eval_runners": true, "ignore_offline_eval_runner_failures": false, "max_num_offline_eval_runner_restarts": 1000, "offline_eval_runner_restore_timeout_s": 1800.0, "max_requests_in_flight_per_offline_eval_runner": 1, "validate_offline_eval_runners_after_construction": true, "offline_eval_runner_health_probe_timeout_s": 30.0, "offline_eval_rl_module_inference_only": false, "broadcast_offline_eval_runner_states": false, "offline_eval_batch_size_per_runner": 256, "dataset_num_iters_per_eval_runner": 1, "keep_per_episode_custom_metrics": false, "metrics_episode_collection_timeout_s": 60.0, "metrics_num_episodes_for_smoothing": 100, "min_time_s_per_iteration": null, "min_train_timesteps_per_iteration": 0, "min_sample_timesteps_per_iteration": 0, "log_gradients": true, "export_native_model_files": false, "checkpoint_trainable_policies_only": false, "logger_creator": null, "logger_config": null, "log_level": "WARN", "log_sys_usage": true, "fake_sampler": false, "seed": 5, "restart_failed_env_runners": true, "ignore_env_runner_failures": false, "max_num_env_runner_restarts": 1000, "delay_between_env_runner_restarts_s": 60.0, "restart_failed_sub_environments": false, "num_consecutive_env_runner_failures_tolerance": 100, "env_runner_health_probe_timeout_s": 30.0, "env_runner_restore_timeout_s": 1800.0, "_model_config": {}, "_rl_module_spec": "RLModuleSpec(module_class=None, observation_space=None, action_space=None, inference_only=False, learner_only=False, model_config=DefaultModelConfig(fcnet_hiddens=[60, 90], fcnet_activation='tanh', fcnet_kernel_initializer=None, fcnet_kernel_initializer_kwargs=None, fcnet_bias_initializer=None, fcnet_bias_initializer_kwargs=None, conv_filters=None, conv_activation='relu', conv_kernel_initializer=None, conv_kernel_initializer_kwargs=None, conv_bias_initializer=None, conv_bias_initializer_kwargs=None, head_fcnet_hiddens=[], head_fcnet_activation='relu', head_fcnet_kernel_initializer=None, head_fcnet_kernel_initializer_kwargs=None, head_fcnet_bias_initializer=None, head_fcnet_bias_initializer_kwargs=None, free_log_std=False, log_std_clip_param=20.0, vf_share_layers=True, use_lstm=False, max_seq_len=20, lstm_cell_size=256, lstm_use_prev_action=False, lstm_use_prev_reward=False, lstm_kernel_initializer=None, lstm_kernel_initializer_kwargs=None, lstm_bias_initializer=None, lstm_bias_initializer_kwargs=None), catalog_class=None, load_state_path=None, model_config_dict=None)", "algorithm_config_overrides_per_module": {}, "_per_module_overrides": {}, "_validate_config": true, "_use_msgpack_checkpoints": false, "_torch_grad_scaler_class": null, "_torch_lr_scheduler_classes": null, "_tf_policy_handles_more_than_one_loss": false, "_disable_preprocessor_api": false, "_disable_action_flattening": false, "_disable_initialize_loss_from_dummy_batch": false, "_dont_auto_sync_env_runner_states": false, "env_task_fn": -1, "enable_connectors": -1, "simple_optimizer": false, "policy_map_cache": -1, "worker_cls": -1, "synchronize_filters": -1, "enable_async_evaluation": -1, "custom_async_evaluation_function": -1, "_enable_rl_module_api": -1, "auto_wrap_old_gym_envs": -1, "always_attach_evaluation_results": -1, "replay_sequence_length": null, "_disable_execution_plan_api": -1, "use_critic": true, "use_gae": true, "use_kl_loss": true, "kl_coeff": 0.7464963036515, "kl_target": 0.0270990929592, "vf_loss_coeff": 0.6688075857018, "entropy_coeff": 0.0090570820258, "clip_param": 0.1221781641624, "vf_clip_param": 0.1027808522125, "entropy_coeff_schedule": null, "lr_schedule": null, "sgd_minibatch_size": -1, "vf_share_layers": -1, "__stdout_file__": null, "__stderr_file__": null, "lambda": 0.9099046732075, "input": "sampler", "policies": {"default_policy": [null, null, null, null]}, "callbacks": "<class 'ray.rllib.callbacks.callbacks.RLlibCallback'>", "create_env_on_driver": false, "custom_eval_function": null, "framework": "torch"}, "time_since_restore": 24.877300262451172, "iterations_since_restore": 14, "perf": {"cpu_util_percent": 48.0, "ram_util_percent": 81.10000000000001}}
{"timers": {"training_iteration": 1.7803042552474768, "restore_env_runners": 3.514635293689689e-05, "training_step": 1.7799582438327797, "env_runner_sampling_timer": 1.6612015595945178, "learner_update_timer": 0.11532532999846472, "synch_weights": 0.0007056538442238023, "restore_eval_env_runners": 1.0337619432096444e-05, "evaluation_iteration": 0.1367442946796802, "synch_eval_env_connectors": 0.00014362839896933394, "synch_env_connectors": 4.921719555830453e-06}, "env_runners": {"env_to_module_sum_episodes_length_in": 10.36823839457432, "episode_return_min": -13.5, "module_to_env_connector": {"timers": {"connectors": {"get_actions": 3.835874260062974e-05, "un_batch_to_individual_items": 5.370667393316697e-06, "tensor_to_numpy": 1.2889065911928284e-05, "normalize_and_clip_actions": 9.237951267852492e-06, "remove_single_ts_time_rank_from_batch": 5.812687204766574e-07, "listify_data_for_vector_env": 1.0849979220776085e-05}}, "connector_pipeline_timer": 0.00010244286092718612}, "env_reset_timer": 3.387501218286923e-05, "env_to_module_connector": {"timers": {"connectors": {"numpy_to_tensor": 8.39776605997358e-06, "batch_individual_items": 6.231693443644336e-06, "add_states_from_episodes_to_batch": 1.7243362113909475e-06, "add_time_dim_to_batch_and_zero_pad": 2.3112001916694584e-06, "add_observations_from_episodes_to_batch": 3.0283498246843643e-06}}, "connector_pipeline_timer": 4.319742560974551e-05}, "num_agent_steps_sampled_lifetime": {"default_agent": -8017500.0}, "agent_episode_returns_mean": {"default_agent": 4.019999999999998}, "num_episodes": 250.0, "num_env_steps_sampled_lifetime": -8017500.0, "episode_len_max": 20, "rlmodule_inference_timer": 2.70021258101302e-05, "weights_seq_no": 14.0, "episode_len_min": 20, "num_env_steps_sampled": 5000.0, "time_between_sampling": 0.0019176151687636373, "episode_len_mean": 20.0, "episode_duration_sec_mean": 0.0044772881595417854, "env_step_timer": 1.3392679281015077e-05, "num_agent_steps_sampled": {"default_agent": 5000.0}, "num_episodes_lifetime": -400875.0, "module_episode_returns_mean": {"default_policy": 4.019999999999998}, "num_module_steps_sampled": {"default_policy": 5000.0}, "episode_return_max": 6.5, "sample": 0.004862343823124116, "episode_return_mean": 4.019999999999998, "env_to_module_sum_episodes_length_out": 10.36823839457432, "num_module_steps_sampled_lifetime": {"default_policy": -8017500.0}, "num_env_steps_sampled_lifetime_throughput": 3790.686706813727}, "learners": {"default_policy": {"num_trainable_parameters": 6003, "diff_num_grad_updates_vs_sampler_policy": 1.0, "gradients_default_optimizer_global_norm": 0.042700961232185364, "default_optimizer_learning_rate": 0.0002847858517, "module_train_batch_size_mean": 1000.0, "vf_loss_unclipped": 23.113862991333008, "curr_entropy_coeff": 0.0090570820258, "num_module_steps_trained": 6000, "total_loss": 0.004048810340464115, "vf_explained_var": -0.02093040943145752, "num_module_steps_trained_lifetime": 90000, "curr_kl_coeff": 2.2781259758630767e-05, "policy_loss": -0.06058907508850098, "mean_kl_loss": 0.00023884468828327954, "entropy": 0.452986478805542, "vf_loss": 0.10278083384037018, "weights_seq_no": 15.0, "num_module_steps_trained_lifetime_throughput": 353163.6007646112}, "__all_modules__": {"learner_connector": {"timers": {"connectors": {"add_observations_from_episodes_to_batch": 0.000875393713853115, "general_advantage_estimation": 0.00677893978725416, "batch_individual_items": 0.03547325914390808, "numpy_to_tensor": 8.077996998055168e-05, "add_one_ts_to_episodes_and_truncate": 0.009132743197470535, "add_time_dim_to_batch_and_zero_pad": 1.2224851767124624e-05, "add_columns_from_episodes_to_train_batch": 0.034411455438561604, "add_states_from_episodes_to_batch": 4.199327269941661e-06}}, "connector_pipeline_timer": 0.08691817077336636}, "learner_connector_sum_episodes_length_in": 5000.0, "num_trainable_parameters": 6003, "num_env_steps_trained": 31500, "num_module_steps_trained": 6000, "learner_connector_sum_episodes_length_out": 5250.0, "num_non_trainable_parameters": 0, "num_module_steps_trained_lifetime": 90000, "num_env_steps_trained_lifetime": 472500, "num_env_steps_trained_lifetime_throughput": 1848731.1734233738, "num_module_steps_trained_throughput": 353014.26319092826, "num_module_steps_trained_lifetime_throughput": 352648.23352174694}}, "num_training_step_calls_per_iteration": 1, "evaluation": {"env_runners": {"num_agent_steps_sampled_lifetime": {"default_agent": 6000}, "env_to_module_sum_episodes_length_in": 10.368238394574323, "agent_episode_returns_mean": {"default_agent": 2.3}, "env_to_module_connector": {"timers": {"connectors": {"add_observations_from_episodes_to_batch": 2.752681327439242e-06, "batch_individual_items": 5.992312221105573e-06, "numpy_to_tensor": 8.151493568853335e-06, "add_time_dim_to_batch_and_zero_pad": 2.244810558107466e-06, "add_states_from_episodes_to_batch": 1.5717971994869362e-06}}, "connector_pipeline_timer": 4.234490384917769e-05}, "module_to_env_connector": {"connector_pipeline_timer": 0.00010071003239984056, "timers": {"connectors": {"remove_single_ts_time_rank_from_batch": 5.781877592295152e-07, "listify_data_for_vector_env": 1.1007103885290734e-05, "tensor_to_numpy": 1.2933606018419081e-05, "normalize_and_clip_actions": 9.366815958166947e-06, "un_batch_to_individual_items": 5.28780546914342e-06, "get_actions": 3.573273730183084e-05}}}, "episode_duration_sec_mean": 0.004620669527212158, "sample": 0.12304556348916347, "num_episodes": 20, "episode_len_min": 20, "num_module_steps_sampled": {"default_policy": 400}, "num_env_steps_sampled": 400, "num_episodes_lifetime": 300, "env_to_module_sum_episodes_length_out": 10.368238394574323, "episode_return_min": -15.5, "module_episode_returns_mean": {"default_policy": 2.3}, "num_env_steps_sampled_lifetime": 75400, "rlmodule_inference_timer": 2.6937745562704503e-05, "weights_seq_no": 15.0, "num_module_steps_sampled_lifetime": {"default_policy": 6000}, "env_step_timer": 1.3836656619831335e-05, "episode_return_max": 13.5, "episode_return_mean": 2.3, "env_reset_timer": 0.002290057556060173, "episode_len_max": 20, "num_agent_steps_sampled": {"default_agent": 400}, "episode_len_mean": 20.0, "time_between_sampling": 1.7390361878945084}, "num_healthy_workers": 1, "actor_manager_num_outstanding_async_reqs": 0, "num_remote_worker_restarts": 0}, "num_env_steps_sampled_lifetime": -8017500.0, "fault_tolerance": {"num_healthy_workers": 0, "num_remote_worker_restarts": 0}, "env_runner_group": {"actor_manager_num_outstanding_async_reqs": 0}, "done": false, "training_iteration": 15, "trial_id": "5029b_00000", "date": "2025-08-11_19-22-02", "timestamp": 1754932922, "time_this_iter_s": 1.6538870334625244, "time_total_s": 26.531187295913696, "pid": 14328, "hostname": "Mac", "node_ip": "127.0.0.1", "config": {"exploration_config": {}, "extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "placement_strategy": "PACK", "num_gpus": 0, "_fake_gpus": false, "num_cpus_for_main_process": 2, "eager_tracing": true, "eager_max_retraces": 20, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "torch_compile_learner": false, "torch_compile_learner_what_to_compile": "forward_train", "torch_compile_learner_dynamo_backend": "aot_eager", "torch_compile_learner_dynamo_mode": null, "torch_compile_worker": false, "torch_compile_worker_dynamo_backend": "aot_eager", "torch_compile_worker_dynamo_mode": null, "torch_ddp_kwargs": {}, "torch_skip_nan_gradients": false, "env": "Umbrella", "env_config": {}, "observation_space": null, "action_space": null, "clip_rewards": null, "normalize_actions": true, "clip_actions": false, "_is_atari": null, "disable_env_checking": false, "render_env": false, "action_mask_key": "action_mask", "env_runner_cls": null, "num_env_runners": 0, "create_local_env_runner": true, "num_envs_per_env_runner": 1, "gym_env_vectorize_mode": "SYNC", "num_cpus_per_env_runner": 1, "num_gpus_per_env_runner": 0, "custom_resources_per_env_runner": {}, "validate_env_runners_after_construction": true, "episodes_to_numpy": true, "max_requests_in_flight_per_env_runner": 1, "sample_timeout_s": 60.0, "_env_to_module_connector": null, "add_default_connectors_to_env_to_module_pipeline": true, "_module_to_env_connector": null, "add_default_connectors_to_module_to_env_pipeline": true, "merge_env_runner_states": "training_only", "broadcast_env_runner_states": true, "episode_lookback_horizon": 1, "rollout_fragment_length": "auto", "batch_mode": "complete_episodes", "compress_observations": false, "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "enable_tf1_exec_eagerly": false, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "preprocessor_pref": "deepmind", "observation_filter": "NoFilter", "update_worker_filter_stats": true, "use_worker_filter_stats": true, "sampler_perf_stats_ema_coef": null, "_is_online": true, "num_learners": 0, "num_gpus_per_learner": 0, "num_cpus_per_learner": "auto", "num_aggregator_actors_per_learner": 0, "max_requests_in_flight_per_aggregator_actor": 3, "local_gpu_idx": 0, "max_requests_in_flight_per_learner": 3, "gamma": 1, "lr": 0.0002847858517, "grad_clip": 0.5, "grad_clip_by": "global_norm", "_train_batch_size_per_learner": 5000, "train_batch_size": 4000, "num_epochs": 1, "minibatch_size": 1000, "shuffle_batch_per_epoch": true, "model": {"fcnet_hiddens": [256, 256], "fcnet_activation": "tanh", "fcnet_weights_initializer": null, "fcnet_weights_initializer_config": null, "fcnet_bias_initializer": null, "fcnet_bias_initializer_config": null, "conv_filters": null, "conv_activation": "relu", "conv_kernel_initializer": null, "conv_kernel_initializer_config": null, "conv_bias_initializer": null, "conv_bias_initializer_config": null, "conv_transpose_kernel_initializer": null, "conv_transpose_kernel_initializer_config": null, "conv_transpose_bias_initializer": null, "conv_transpose_bias_initializer_config": null, "post_fcnet_hiddens": [], "post_fcnet_activation": "relu", "post_fcnet_weights_initializer": null, "post_fcnet_weights_initializer_config": null, "post_fcnet_bias_initializer": null, "post_fcnet_bias_initializer_config": null, "free_log_std": false, "log_std_clip_param": 20.0, "no_final_linear": false, "vf_share_layers": false, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "lstm_weights_initializer": null, "lstm_weights_initializer_config": null, "lstm_bias_initializer": null, "lstm_bias_initializer_config": null, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "attention_use_n_prev_actions": 0, "attention_use_n_prev_rewards": 0, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": null, "custom_model_config": {}, "custom_action_dist": null, "custom_preprocessor": null, "encoder_latent_dim": null, "always_check_shapes": false, "lstm_use_prev_action_reward": -1, "_use_default_native_models": -1, "_disable_preprocessor_api": false, "_disable_action_flattening": false}, "_learner_connector": null, "add_default_connectors_to_learner_pipeline": true, "learner_config_dict": {}, "optimizer": {}, "_learner_class": null, "callbacks_on_algorithm_init": null, "callbacks_on_env_runners_recreated": null, "callbacks_on_offline_eval_runners_recreated": null, "callbacks_on_checkpoint_loaded": null, "callbacks_on_environment_created": null, "callbacks_on_episode_created": null, "callbacks_on_episode_start": null, "callbacks_on_episode_step": null, "callbacks_on_episode_end": null, "callbacks_on_evaluate_start": null, "callbacks_on_evaluate_end": null, "callbacks_on_evaluate_offline_start": null, "callbacks_on_evaluate_offline_end": null, "callbacks_on_sample_end": null, "callbacks_on_train_result": null, "explore": true, "enable_rl_module_and_learner": true, "enable_env_runner_and_connector_v2": true, "_prior_exploration_config": {"type": "StochasticSampling"}, "count_steps_by": "env_steps", "policy_map_capacity": 100, "policy_mapping_fn": "<function AlgorithmConfig.DEFAULT_POLICY_MAPPING_FN at 0x157405b20>", "policies_to_train": null, "policy_states_are_swappable": false, "observation_fn": null, "offline_data_class": null, "input_read_method": "read_parquet", "input_read_method_kwargs": {}, "input_read_schema": {}, "input_read_episodes": false, "input_read_sample_batches": false, "input_read_batch_size": null, "input_filesystem": null, "input_filesystem_kwargs": {}, "input_compress_columns": ["obs", "new_obs"], "input_spaces_jsonable": true, "materialize_data": false, "materialize_mapped_data": true, "map_batches_kwargs": {}, "iter_batches_kwargs": {}, "ignore_final_observation": false, "prelearner_class": null, "prelearner_buffer_class": null, "prelearner_buffer_kwargs": {}, "prelearner_module_synch_period": 10, "dataset_num_iters_per_learner": null, "input_config": {}, "actions_in_input_normalized": false, "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_config": {}, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "output_max_rows_per_file": null, "output_write_remaining_data": false, "output_write_method": "write_parquet", "output_write_method_kwargs": {}, "output_filesystem": null, "output_filesystem_kwargs": {}, "output_write_episodes": true, "offline_sampling": false, "evaluation_interval": 1, "evaluation_duration": 20, "evaluation_duration_unit": "episodes", "evaluation_sample_timeout_s": 120.0, "evaluation_auto_duration_min_env_steps_per_sample": 100, "evaluation_auto_duration_max_env_steps_per_sample": 2000, "evaluation_parallel_to_training": false, "evaluation_force_reset_envs_before_iteration": true, "evaluation_config": null, "off_policy_estimation_methods": {}, "ope_split_batch_by_episode": true, "evaluation_num_env_runners": 1, "in_evaluation": false, "sync_filters_on_rollout_workers_timeout_s": 10.0, "offline_evaluation_interval": null, "num_offline_eval_runners": 0, "offline_loss_for_module_fn": null, "offline_evaluation_duration": 1, "offline_evaluation_parallel_to_training": false, "offline_evaluation_timeout_s": 120.0, "num_cpus_per_offline_eval_runner": 1, "num_gpus_per_offline_eval_runner": 0, "custom_resources_per_offline_eval_runner": {}, "restart_failed_offline_eval_runners": true, "ignore_offline_eval_runner_failures": false, "max_num_offline_eval_runner_restarts": 1000, "offline_eval_runner_restore_timeout_s": 1800.0, "max_requests_in_flight_per_offline_eval_runner": 1, "validate_offline_eval_runners_after_construction": true, "offline_eval_runner_health_probe_timeout_s": 30.0, "offline_eval_rl_module_inference_only": false, "broadcast_offline_eval_runner_states": false, "offline_eval_batch_size_per_runner": 256, "dataset_num_iters_per_eval_runner": 1, "keep_per_episode_custom_metrics": false, "metrics_episode_collection_timeout_s": 60.0, "metrics_num_episodes_for_smoothing": 100, "min_time_s_per_iteration": null, "min_train_timesteps_per_iteration": 0, "min_sample_timesteps_per_iteration": 0, "log_gradients": true, "export_native_model_files": false, "checkpoint_trainable_policies_only": false, "logger_creator": null, "logger_config": null, "log_level": "WARN", "log_sys_usage": true, "fake_sampler": false, "seed": 5, "restart_failed_env_runners": true, "ignore_env_runner_failures": false, "max_num_env_runner_restarts": 1000, "delay_between_env_runner_restarts_s": 60.0, "restart_failed_sub_environments": false, "num_consecutive_env_runner_failures_tolerance": 100, "env_runner_health_probe_timeout_s": 30.0, "env_runner_restore_timeout_s": 1800.0, "_model_config": {}, "_rl_module_spec": "RLModuleSpec(module_class=None, observation_space=None, action_space=None, inference_only=False, learner_only=False, model_config=DefaultModelConfig(fcnet_hiddens=[60, 90], fcnet_activation='tanh', fcnet_kernel_initializer=None, fcnet_kernel_initializer_kwargs=None, fcnet_bias_initializer=None, fcnet_bias_initializer_kwargs=None, conv_filters=None, conv_activation='relu', conv_kernel_initializer=None, conv_kernel_initializer_kwargs=None, conv_bias_initializer=None, conv_bias_initializer_kwargs=None, head_fcnet_hiddens=[], head_fcnet_activation='relu', head_fcnet_kernel_initializer=None, head_fcnet_kernel_initializer_kwargs=None, head_fcnet_bias_initializer=None, head_fcnet_bias_initializer_kwargs=None, free_log_std=False, log_std_clip_param=20.0, vf_share_layers=True, use_lstm=False, max_seq_len=20, lstm_cell_size=256, lstm_use_prev_action=False, lstm_use_prev_reward=False, lstm_kernel_initializer=None, lstm_kernel_initializer_kwargs=None, lstm_bias_initializer=None, lstm_bias_initializer_kwargs=None), catalog_class=None, load_state_path=None, model_config_dict=None)", "algorithm_config_overrides_per_module": {}, "_per_module_overrides": {}, "_validate_config": true, "_use_msgpack_checkpoints": false, "_torch_grad_scaler_class": null, "_torch_lr_scheduler_classes": null, "_tf_policy_handles_more_than_one_loss": false, "_disable_preprocessor_api": false, "_disable_action_flattening": false, "_disable_initialize_loss_from_dummy_batch": false, "_dont_auto_sync_env_runner_states": false, "env_task_fn": -1, "enable_connectors": -1, "simple_optimizer": false, "policy_map_cache": -1, "worker_cls": -1, "synchronize_filters": -1, "enable_async_evaluation": -1, "custom_async_evaluation_function": -1, "_enable_rl_module_api": -1, "auto_wrap_old_gym_envs": -1, "always_attach_evaluation_results": -1, "replay_sequence_length": null, "_disable_execution_plan_api": -1, "use_critic": true, "use_gae": true, "use_kl_loss": true, "kl_coeff": 0.7464963036515, "kl_target": 0.0270990929592, "vf_loss_coeff": 0.6688075857018, "entropy_coeff": 0.0090570820258, "clip_param": 0.1221781641624, "vf_clip_param": 0.1027808522125, "entropy_coeff_schedule": null, "lr_schedule": null, "sgd_minibatch_size": -1, "vf_share_layers": -1, "__stdout_file__": null, "__stderr_file__": null, "lambda": 0.9099046732075, "input": "sampler", "policies": {"default_policy": [null, null, null, null]}, "callbacks": "<class 'ray.rllib.callbacks.callbacks.RLlibCallback'>", "create_env_on_driver": false, "custom_eval_function": null, "framework": "torch"}, "time_since_restore": 26.531187295913696, "iterations_since_restore": 15, "perf": {"cpu_util_percent": 40.150000000000006, "ram_util_percent": 79.44999999999999}}
{"timers": {"training_iteration": 1.7770867797756504, "restore_env_runners": 3.4854059823152896e-05, "training_step": 1.7767421801440204, "env_runner_sampling_timer": 1.6581619598384532, "learner_update_timer": 0.11515106836947973, "synch_weights": 0.0007041573062086315, "restore_eval_env_runners": 1.030799350830606e-05, "evaluation_iteration": 0.1364240396530775, "synch_eval_env_connectors": 0.00014335044510351217, "synch_env_connectors": 4.9125026648518825e-06}, "env_runners": {"env_to_module_sum_episodes_length_in": 10.36823839457432, "episode_return_min": -13.5, "module_to_env_connector": {"timers": {"connectors": {"get_actions": 3.826598487163006e-05, "un_batch_to_individual_items": 5.339829074195954e-06, "tensor_to_numpy": 1.2890584997533625e-05, "normalize_and_clip_actions": 9.291722669226798e-06, "remove_single_ts_time_rank_from_batch": 5.818059339464518e-07, "listify_data_for_vector_env": 1.0776595166975135e-05}}, "connector_pipeline_timer": 0.00010226947329324801}, "env_reset_timer": 3.104024161265116e-05, "env_to_module_connector": {"timers": {"connectors": {"numpy_to_tensor": 8.37514916058065e-06, "batch_individual_items": 6.226316395330642e-06, "add_states_from_episodes_to_batch": 1.7199694833449006e-06, "add_time_dim_to_batch_and_zero_pad": 2.3193482641383947e-06, "add_observations_from_episodes_to_batch": 2.9776834541877184e-06}}, "connector_pipeline_timer": 4.3063476082464397e-05}, "num_agent_steps_sampled_lifetime": {"default_agent": -8635000.0}, "agent_episode_returns_mean": {"default_agent": 4.66}, "num_episodes": 250.0, "num_env_steps_sampled_lifetime": -8635000.0, "episode_len_max": 20, "rlmodule_inference_timer": 2.725014619032092e-05, "weights_seq_no": 15.0, "episode_len_min": 20, "num_env_steps_sampled": 5000.0, "time_between_sampling": 0.001866651995712129, "episode_len_mean": 20.0, "episode_duration_sec_mean": 0.004485759465023875, "env_step_timer": 1.3442434963500116e-05, "num_agent_steps_sampled": {"default_agent": 5000.0}, "num_episodes_lifetime": -431750.0, "module_episode_returns_mean": {"default_policy": 4.66}, "num_module_steps_sampled": {"default_policy": 5000.0}, "episode_return_max": 6.5, "sample": 0.004772618160822611, "episode_return_mean": 4.66, "env_to_module_sum_episodes_length_out": 10.36823839457432, "num_module_steps_sampled_lifetime": {"default_policy": -8635000.0}, "num_env_steps_sampled_lifetime_throughput": 3797.9713894059714}, "learners": {"default_policy": {"num_trainable_parameters": 6003, "diff_num_grad_updates_vs_sampler_policy": 1.0, "gradients_default_optimizer_global_norm": 0.11287917196750641, "default_optimizer_learning_rate": 0.0002847858517, "module_train_batch_size_mean": 1000.0, "vf_loss_unclipped": 24.324419021606445, "curr_entropy_coeff": 0.0090570820258, "num_module_steps_trained": 6000, "total_loss": 0.21866542100906372, "vf_explained_var": -0.018616795539855957, "num_module_steps_trained_lifetime": 96000, "curr_kl_coeff": 1.1390629879315384e-05, "policy_loss": 0.1539374142885208, "mean_kl_loss": 0.0002914517535828054, "entropy": 0.4430331587791443, "vf_loss": 0.10278083384037018, "weights_seq_no": 16.0, "num_module_steps_trained_lifetime_throughput": 353461.96210669883}, "__all_modules__": {"learner_connector": {"timers": {"connectors": {"add_observations_from_episodes_to_batch": 0.0008747731168758776, "general_advantage_estimation": 0.006780412058795736, "batch_individual_items": 0.035430128223160745, "numpy_to_tensor": 8.054132944577093e-05, "add_one_ts_to_episodes_and_truncate": 0.009119262425774568, "add_time_dim_to_batch_and_zero_pad": 1.2187183637373518e-05, "add_columns_from_episodes_to_train_batch": 0.03440716630411791, "add_states_from_episodes_to_batch": 4.183994270093831e-06}}, "connector_pipeline_timer": 0.08685722531535524}, "learner_connector_sum_episodes_length_in": 5000.0, "num_trainable_parameters": 6003, "num_env_steps_trained": 31500, "num_module_steps_trained": 6000, "learner_connector_sum_episodes_length_out": 5250.0, "num_non_trainable_parameters": 0, "num_module_steps_trained_lifetime": 96000, "num_env_steps_trained_lifetime": 504000, "num_env_steps_trained_lifetime_throughput": 1850694.819021415, "num_module_steps_trained_throughput": 353351.19607702043, "num_module_steps_trained_lifetime_throughput": 352996.6339679723}}, "num_training_step_calls_per_iteration": 1, "evaluation": {"env_runners": {"num_agent_steps_sampled_lifetime": {"default_agent": 6400}, "env_to_module_sum_episodes_length_in": 10.368238394574323, "agent_episode_returns_mean": {"default_agent": 3.1}, "env_to_module_connector": {"timers": {"connectors": {"add_observations_from_episodes_to_batch": 3.5752132454104232e-06, "batch_individual_items": 8.646097080757016e-06, "numpy_to_tensor": 1.145518017649375e-05, "add_time_dim_to_batch_and_zero_pad": 2.7845398427296355e-06, "add_states_from_episodes_to_batch": 2.0558698846575035e-06}}, "connector_pipeline_timer": 5.507065389804384e-05}, "module_to_env_connector": {"connector_pipeline_timer": 0.00013140181094194837, "timers": {"connectors": {"remove_single_ts_time_rank_from_batch": 6.98937758198585e-07, "listify_data_for_vector_env": 1.4529528574808642e-05, "tensor_to_numpy": 1.6720333557776966e-05, "normalize_and_clip_actions": 1.2315532500045768e-05, "un_batch_to_individual_items": 7.2775204939408265e-06, "get_actions": 4.796757119590083e-05}}}, "episode_duration_sec_mean": 0.004874840388074517, "sample": 0.12307516327426077, "num_episodes": 20, "episode_len_min": 20, "num_module_steps_sampled": {"default_policy": 400}, "num_env_steps_sampled": 400, "num_episodes_lifetime": 320, "env_to_module_sum_episodes_length_out": 10.368238394574323, "episode_return_min": -15.5, "module_episode_returns_mean": {"default_policy": 3.1}, "num_env_steps_sampled_lifetime": 80400, "rlmodule_inference_timer": 3.443687696960337e-05, "weights_seq_no": 16.0, "num_module_steps_sampled_lifetime": {"default_policy": 6400}, "env_step_timer": 1.8748633593130436e-05, "episode_return_max": 13.5, "episode_return_mean": 3.1, "env_reset_timer": 0.002267895731177127, "episode_len_max": 20, "num_agent_steps_sampled": {"default_agent": 400}, "episode_len_mean": 20.0, "time_between_sampling": 1.7364036472658047}, "num_healthy_workers": 1, "actor_manager_num_outstanding_async_reqs": 0, "num_remote_worker_restarts": 0}, "num_env_steps_sampled_lifetime": -8635000.0, "fault_tolerance": {"num_healthy_workers": 0, "num_remote_worker_restarts": 0}, "env_runner_group": {"actor_manager_num_outstanding_async_reqs": 0}, "done": false, "training_iteration": 16, "trial_id": "5029b_00000", "date": "2025-08-11_19-22-03", "timestamp": 1754932923, "time_this_iter_s": 1.593000888824463, "time_total_s": 28.12418818473816, "pid": 14328, "hostname": "Mac", "node_ip": "127.0.0.1", "config": {"exploration_config": {}, "extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "placement_strategy": "PACK", "num_gpus": 0, "_fake_gpus": false, "num_cpus_for_main_process": 2, "eager_tracing": true, "eager_max_retraces": 20, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "torch_compile_learner": false, "torch_compile_learner_what_to_compile": "forward_train", "torch_compile_learner_dynamo_backend": "aot_eager", "torch_compile_learner_dynamo_mode": null, "torch_compile_worker": false, "torch_compile_worker_dynamo_backend": "aot_eager", "torch_compile_worker_dynamo_mode": null, "torch_ddp_kwargs": {}, "torch_skip_nan_gradients": false, "env": "Umbrella", "env_config": {}, "observation_space": null, "action_space": null, "clip_rewards": null, "normalize_actions": true, "clip_actions": false, "_is_atari": null, "disable_env_checking": false, "render_env": false, "action_mask_key": "action_mask", "env_runner_cls": null, "num_env_runners": 0, "create_local_env_runner": true, "num_envs_per_env_runner": 1, "gym_env_vectorize_mode": "SYNC", "num_cpus_per_env_runner": 1, "num_gpus_per_env_runner": 0, "custom_resources_per_env_runner": {}, "validate_env_runners_after_construction": true, "episodes_to_numpy": true, "max_requests_in_flight_per_env_runner": 1, "sample_timeout_s": 60.0, "_env_to_module_connector": null, "add_default_connectors_to_env_to_module_pipeline": true, "_module_to_env_connector": null, "add_default_connectors_to_module_to_env_pipeline": true, "merge_env_runner_states": "training_only", "broadcast_env_runner_states": true, "episode_lookback_horizon": 1, "rollout_fragment_length": "auto", "batch_mode": "complete_episodes", "compress_observations": false, "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "enable_tf1_exec_eagerly": false, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "preprocessor_pref": "deepmind", "observation_filter": "NoFilter", "update_worker_filter_stats": true, "use_worker_filter_stats": true, "sampler_perf_stats_ema_coef": null, "_is_online": true, "num_learners": 0, "num_gpus_per_learner": 0, "num_cpus_per_learner": "auto", "num_aggregator_actors_per_learner": 0, "max_requests_in_flight_per_aggregator_actor": 3, "local_gpu_idx": 0, "max_requests_in_flight_per_learner": 3, "gamma": 1, "lr": 0.0002847858517, "grad_clip": 0.5, "grad_clip_by": "global_norm", "_train_batch_size_per_learner": 5000, "train_batch_size": 4000, "num_epochs": 1, "minibatch_size": 1000, "shuffle_batch_per_epoch": true, "model": {"fcnet_hiddens": [256, 256], "fcnet_activation": "tanh", "fcnet_weights_initializer": null, "fcnet_weights_initializer_config": null, "fcnet_bias_initializer": null, "fcnet_bias_initializer_config": null, "conv_filters": null, "conv_activation": "relu", "conv_kernel_initializer": null, "conv_kernel_initializer_config": null, "conv_bias_initializer": null, "conv_bias_initializer_config": null, "conv_transpose_kernel_initializer": null, "conv_transpose_kernel_initializer_config": null, "conv_transpose_bias_initializer": null, "conv_transpose_bias_initializer_config": null, "post_fcnet_hiddens": [], "post_fcnet_activation": "relu", "post_fcnet_weights_initializer": null, "post_fcnet_weights_initializer_config": null, "post_fcnet_bias_initializer": null, "post_fcnet_bias_initializer_config": null, "free_log_std": false, "log_std_clip_param": 20.0, "no_final_linear": false, "vf_share_layers": false, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "lstm_weights_initializer": null, "lstm_weights_initializer_config": null, "lstm_bias_initializer": null, "lstm_bias_initializer_config": null, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "attention_use_n_prev_actions": 0, "attention_use_n_prev_rewards": 0, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": null, "custom_model_config": {}, "custom_action_dist": null, "custom_preprocessor": null, "encoder_latent_dim": null, "always_check_shapes": false, "lstm_use_prev_action_reward": -1, "_use_default_native_models": -1, "_disable_preprocessor_api": false, "_disable_action_flattening": false}, "_learner_connector": null, "add_default_connectors_to_learner_pipeline": true, "learner_config_dict": {}, "optimizer": {}, "_learner_class": null, "callbacks_on_algorithm_init": null, "callbacks_on_env_runners_recreated": null, "callbacks_on_offline_eval_runners_recreated": null, "callbacks_on_checkpoint_loaded": null, "callbacks_on_environment_created": null, "callbacks_on_episode_created": null, "callbacks_on_episode_start": null, "callbacks_on_episode_step": null, "callbacks_on_episode_end": null, "callbacks_on_evaluate_start": null, "callbacks_on_evaluate_end": null, "callbacks_on_evaluate_offline_start": null, "callbacks_on_evaluate_offline_end": null, "callbacks_on_sample_end": null, "callbacks_on_train_result": null, "explore": true, "enable_rl_module_and_learner": true, "enable_env_runner_and_connector_v2": true, "_prior_exploration_config": {"type": "StochasticSampling"}, "count_steps_by": "env_steps", "policy_map_capacity": 100, "policy_mapping_fn": "<function AlgorithmConfig.DEFAULT_POLICY_MAPPING_FN at 0x157405b20>", "policies_to_train": null, "policy_states_are_swappable": false, "observation_fn": null, "offline_data_class": null, "input_read_method": "read_parquet", "input_read_method_kwargs": {}, "input_read_schema": {}, "input_read_episodes": false, "input_read_sample_batches": false, "input_read_batch_size": null, "input_filesystem": null, "input_filesystem_kwargs": {}, "input_compress_columns": ["obs", "new_obs"], "input_spaces_jsonable": true, "materialize_data": false, "materialize_mapped_data": true, "map_batches_kwargs": {}, "iter_batches_kwargs": {}, "ignore_final_observation": false, "prelearner_class": null, "prelearner_buffer_class": null, "prelearner_buffer_kwargs": {}, "prelearner_module_synch_period": 10, "dataset_num_iters_per_learner": null, "input_config": {}, "actions_in_input_normalized": false, "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_config": {}, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "output_max_rows_per_file": null, "output_write_remaining_data": false, "output_write_method": "write_parquet", "output_write_method_kwargs": {}, "output_filesystem": null, "output_filesystem_kwargs": {}, "output_write_episodes": true, "offline_sampling": false, "evaluation_interval": 1, "evaluation_duration": 20, "evaluation_duration_unit": "episodes", "evaluation_sample_timeout_s": 120.0, "evaluation_auto_duration_min_env_steps_per_sample": 100, "evaluation_auto_duration_max_env_steps_per_sample": 2000, "evaluation_parallel_to_training": false, "evaluation_force_reset_envs_before_iteration": true, "evaluation_config": null, "off_policy_estimation_methods": {}, "ope_split_batch_by_episode": true, "evaluation_num_env_runners": 1, "in_evaluation": false, "sync_filters_on_rollout_workers_timeout_s": 10.0, "offline_evaluation_interval": null, "num_offline_eval_runners": 0, "offline_loss_for_module_fn": null, "offline_evaluation_duration": 1, "offline_evaluation_parallel_to_training": false, "offline_evaluation_timeout_s": 120.0, "num_cpus_per_offline_eval_runner": 1, "num_gpus_per_offline_eval_runner": 0, "custom_resources_per_offline_eval_runner": {}, "restart_failed_offline_eval_runners": true, "ignore_offline_eval_runner_failures": false, "max_num_offline_eval_runner_restarts": 1000, "offline_eval_runner_restore_timeout_s": 1800.0, "max_requests_in_flight_per_offline_eval_runner": 1, "validate_offline_eval_runners_after_construction": true, "offline_eval_runner_health_probe_timeout_s": 30.0, "offline_eval_rl_module_inference_only": false, "broadcast_offline_eval_runner_states": false, "offline_eval_batch_size_per_runner": 256, "dataset_num_iters_per_eval_runner": 1, "keep_per_episode_custom_metrics": false, "metrics_episode_collection_timeout_s": 60.0, "metrics_num_episodes_for_smoothing": 100, "min_time_s_per_iteration": null, "min_train_timesteps_per_iteration": 0, "min_sample_timesteps_per_iteration": 0, "log_gradients": true, "export_native_model_files": false, "checkpoint_trainable_policies_only": false, "logger_creator": null, "logger_config": null, "log_level": "WARN", "log_sys_usage": true, "fake_sampler": false, "seed": 5, "restart_failed_env_runners": true, "ignore_env_runner_failures": false, "max_num_env_runner_restarts": 1000, "delay_between_env_runner_restarts_s": 60.0, "restart_failed_sub_environments": false, "num_consecutive_env_runner_failures_tolerance": 100, "env_runner_health_probe_timeout_s": 30.0, "env_runner_restore_timeout_s": 1800.0, "_model_config": {}, "_rl_module_spec": "RLModuleSpec(module_class=None, observation_space=None, action_space=None, inference_only=False, learner_only=False, model_config=DefaultModelConfig(fcnet_hiddens=[60, 90], fcnet_activation='tanh', fcnet_kernel_initializer=None, fcnet_kernel_initializer_kwargs=None, fcnet_bias_initializer=None, fcnet_bias_initializer_kwargs=None, conv_filters=None, conv_activation='relu', conv_kernel_initializer=None, conv_kernel_initializer_kwargs=None, conv_bias_initializer=None, conv_bias_initializer_kwargs=None, head_fcnet_hiddens=[], head_fcnet_activation='relu', head_fcnet_kernel_initializer=None, head_fcnet_kernel_initializer_kwargs=None, head_fcnet_bias_initializer=None, head_fcnet_bias_initializer_kwargs=None, free_log_std=False, log_std_clip_param=20.0, vf_share_layers=True, use_lstm=False, max_seq_len=20, lstm_cell_size=256, lstm_use_prev_action=False, lstm_use_prev_reward=False, lstm_kernel_initializer=None, lstm_kernel_initializer_kwargs=None, lstm_bias_initializer=None, lstm_bias_initializer_kwargs=None), catalog_class=None, load_state_path=None, model_config_dict=None)", "algorithm_config_overrides_per_module": {}, "_per_module_overrides": {}, "_validate_config": true, "_use_msgpack_checkpoints": false, "_torch_grad_scaler_class": null, "_torch_lr_scheduler_classes": null, "_tf_policy_handles_more_than_one_loss": false, "_disable_preprocessor_api": false, "_disable_action_flattening": false, "_disable_initialize_loss_from_dummy_batch": false, "_dont_auto_sync_env_runner_states": false, "env_task_fn": -1, "enable_connectors": -1, "simple_optimizer": false, "policy_map_cache": -1, "worker_cls": -1, "synchronize_filters": -1, "enable_async_evaluation": -1, "custom_async_evaluation_function": -1, "_enable_rl_module_api": -1, "auto_wrap_old_gym_envs": -1, "always_attach_evaluation_results": -1, "replay_sequence_length": null, "_disable_execution_plan_api": -1, "use_critic": true, "use_gae": true, "use_kl_loss": true, "kl_coeff": 0.7464963036515, "kl_target": 0.0270990929592, "vf_loss_coeff": 0.6688075857018, "entropy_coeff": 0.0090570820258, "clip_param": 0.1221781641624, "vf_clip_param": 0.1027808522125, "entropy_coeff_schedule": null, "lr_schedule": null, "sgd_minibatch_size": -1, "vf_share_layers": -1, "__stdout_file__": null, "__stderr_file__": null, "lambda": 0.9099046732075, "input": "sampler", "policies": {"default_policy": [null, null, null, null]}, "callbacks": "<class 'ray.rllib.callbacks.callbacks.RLlibCallback'>", "create_env_on_driver": false, "custom_eval_function": null, "framework": "torch"}, "time_since_restore": 28.12418818473816, "iterations_since_restore": 16, "perf": {"cpu_util_percent": 41.23333333333334, "ram_util_percent": 79.3}}
{"timers": {"training_iteration": 1.7764792819769282, "restore_env_runners": 3.456259998551955e-05, "training_step": 1.7761362995931145, "env_runner_sampling_timer": 1.6577627469104825, "learner_update_timer": 0.11494681018612155, "synch_weights": 0.000704060323860374, "restore_eval_env_runners": 1.027741354319716e-05, "evaluation_iteration": 0.1363797013371236, "synch_eval_env_connectors": 0.00014304111102846493, "synch_env_connectors": 4.908377980855566e-06}, "env_runners": {"env_to_module_sum_episodes_length_in": 10.36823839457432, "episode_return_min": -13.5, "module_to_env_connector": {"timers": {"connectors": {"get_actions": 4.512623872932134e-05, "un_batch_to_individual_items": 5.911386496005217e-06, "tensor_to_numpy": 1.4563547189426158e-05, "normalize_and_clip_actions": 1.0350736456537234e-05, "remove_single_ts_time_rank_from_batch": 6.272888944793434e-07, "listify_data_for_vector_env": 1.2079324618033931e-05}}, "connector_pipeline_timer": 0.00011573028225771464}, "env_reset_timer": 4.425664250614315e-05, "env_to_module_connector": {"timers": {"connectors": {"numpy_to_tensor": 9.480011569584274e-06, "batch_individual_items": 6.98569352751117e-06, "add_states_from_episodes_to_batch": 1.806650992725761e-06, "add_time_dim_to_batch_and_zero_pad": 2.5819124491224555e-06, "add_observations_from_episodes_to_batch": 3.3043143881848933e-06}}, "connector_pipeline_timer": 4.693544397524525e-05}, "num_agent_steps_sampled_lifetime": {"default_agent": -9252500.0}, "agent_episode_returns_mean": {"default_agent": 4.18}, "num_episodes": 250.0, "num_env_steps_sampled_lifetime": -9252500.0, "episode_len_max": 20, "rlmodule_inference_timer": 4.848720441959296e-05, "weights_seq_no": 16.0, "episode_len_min": 20, "num_env_steps_sampled": 5000.0, "time_between_sampling": 0.0017014183476665944, "episode_len_mean": 20.0, "episode_duration_sec_mean": 0.0054089872217737145, "env_step_timer": 1.5356421305664587e-05, "num_agent_steps_sampled": {"default_agent": 5000.0}, "num_episodes_lifetime": -462625.0, "module_episode_returns_mean": {"default_policy": 4.18}, "num_module_steps_sampled": {"default_policy": 5000.0}, "episode_return_max": 6.5, "sample": 0.005533907188588377, "episode_return_mean": 4.18, "env_to_module_sum_episodes_length_out": 10.36823839457432, "num_module_steps_sampled_lifetime": {"default_policy": -9252500.0}, "num_env_steps_sampled_lifetime_throughput": 3375.3737225201985}, "learners": {"default_policy": {"num_trainable_parameters": 6003, "diff_num_grad_updates_vs_sampler_policy": 1.0, "gradients_default_optimizer_global_norm": 0.03710363060235977, "default_optimizer_learning_rate": 0.0002847858517, "module_train_batch_size_mean": 1000.0, "vf_loss_unclipped": 23.931560516357422, "curr_entropy_coeff": 0.0090570820258, "num_module_steps_trained": 6000, "total_loss": 0.11662331223487854, "vf_explained_var": -0.019191503524780273, "num_module_steps_trained_lifetime": 102000, "curr_kl_coeff": 5.695314939657692e-06, "policy_loss": 0.05162852257490158, "mean_kl_loss": 0.0007178370142355561, "entropy": 0.4135804772377014, "vf_loss": 0.10278083384037018, "weights_seq_no": 17.0, "num_module_steps_trained_lifetime_throughput": 353880.3322058759}, "__all_modules__": {"learner_connector": {"timers": {"connectors": {"add_observations_from_episodes_to_batch": 0.0008765033048386362, "general_advantage_estimation": 0.006771518358837905, "batch_individual_items": 0.035374546520515894, "numpy_to_tensor": 8.084633554948691e-05, "add_one_ts_to_episodes_and_truncate": 0.009103503971947348, "add_time_dim_to_batch_and_zero_pad": 1.2232811330197594e-05, "add_columns_from_episodes_to_train_batch": 0.03440636714081685, "add_states_from_episodes_to_batch": 4.170074214026647e-06}}, "connector_pipeline_timer": 0.08677786848257447}, "learner_connector_sum_episodes_length_in": 5000.0, "num_trainable_parameters": 6003, "num_env_steps_trained": 31500, "num_module_steps_trained": 6000, "learner_connector_sum_episodes_length_out": 5250.0, "num_non_trainable_parameters": 0, "num_module_steps_trained_lifetime": 102000, "num_env_steps_trained_lifetime": 535500, "num_env_steps_trained_lifetime_throughput": 1853275.1797634063, "num_module_steps_trained_throughput": 353807.933685374, "num_module_steps_trained_lifetime_throughput": 353464.42985546053}}, "num_training_step_calls_per_iteration": 1, "evaluation": {"env_runners": {"num_agent_steps_sampled_lifetime": {"default_agent": 6800}, "env_to_module_sum_episodes_length_in": 10.368238394574323, "agent_episode_returns_mean": {"default_agent": 3.5}, "env_to_module_connector": {"timers": {"connectors": {"add_observations_from_episodes_to_batch": 2.7508565056817614e-06, "batch_individual_items": 6.092840247581579e-06, "numpy_to_tensor": 8.234674915582893e-06, "add_time_dim_to_batch_and_zero_pad": 2.2321014225378113e-06, "add_states_from_episodes_to_batch": 1.5587391477168864e-06}}, "connector_pipeline_timer": 4.243757057451941e-05}, "module_to_env_connector": {"connector_pipeline_timer": 0.00010092199002632742, "timers": {"connectors": {"remove_single_ts_time_rank_from_batch": 5.79566140598914e-07, "listify_data_for_vector_env": 1.1024588146787384e-05, "tensor_to_numpy": 1.2909144028216917e-05, "normalize_and_clip_actions": 9.284386114028054e-06, "un_batch_to_individual_items": 5.313326532347684e-06, "get_actions": 3.619583411755182e-05}}}, "episode_duration_sec_mean": 0.004821317025925964, "sample": 0.12282901706073483, "num_episodes": 20, "episode_len_min": 20, "num_module_steps_sampled": {"default_policy": 400}, "num_env_steps_sampled": 400, "num_episodes_lifetime": 340, "env_to_module_sum_episodes_length_out": 10.368238394574323, "episode_return_min": -15.5, "module_episode_returns_mean": {"default_policy": 3.5}, "num_env_steps_sampled_lifetime": 85400, "rlmodule_inference_timer": 2.69043817581659e-05, "weights_seq_no": 17.0, "num_module_steps_sampled_lifetime": {"default_policy": 6800}, "env_step_timer": 1.4073912421456322e-05, "episode_return_max": 13.5, "episode_return_mean": 3.5, "env_reset_timer": 0.002246016774136184, "episode_len_max": 20, "num_agent_steps_sampled": {"default_agent": 400}, "episode_len_mean": 20.0, "time_between_sampling": 1.7364118228736642}, "num_healthy_workers": 1, "actor_manager_num_outstanding_async_reqs": 0, "num_remote_worker_restarts": 0}, "num_env_steps_sampled_lifetime": -9252500.0, "fault_tolerance": {"num_healthy_workers": 0, "num_remote_worker_restarts": 0}, "env_runner_group": {"actor_manager_num_outstanding_async_reqs": 0}, "done": false, "training_iteration": 17, "trial_id": "5029b_00000", "date": "2025-08-11_19-22-05", "timestamp": 1754932925, "time_this_iter_s": 1.8224351406097412, "time_total_s": 29.9466233253479, "pid": 14328, "hostname": "Mac", "node_ip": "127.0.0.1", "config": {"exploration_config": {}, "extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "placement_strategy": "PACK", "num_gpus": 0, "_fake_gpus": false, "num_cpus_for_main_process": 2, "eager_tracing": true, "eager_max_retraces": 20, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "torch_compile_learner": false, "torch_compile_learner_what_to_compile": "forward_train", "torch_compile_learner_dynamo_backend": "aot_eager", "torch_compile_learner_dynamo_mode": null, "torch_compile_worker": false, "torch_compile_worker_dynamo_backend": "aot_eager", "torch_compile_worker_dynamo_mode": null, "torch_ddp_kwargs": {}, "torch_skip_nan_gradients": false, "env": "Umbrella", "env_config": {}, "observation_space": null, "action_space": null, "clip_rewards": null, "normalize_actions": true, "clip_actions": false, "_is_atari": null, "disable_env_checking": false, "render_env": false, "action_mask_key": "action_mask", "env_runner_cls": null, "num_env_runners": 0, "create_local_env_runner": true, "num_envs_per_env_runner": 1, "gym_env_vectorize_mode": "SYNC", "num_cpus_per_env_runner": 1, "num_gpus_per_env_runner": 0, "custom_resources_per_env_runner": {}, "validate_env_runners_after_construction": true, "episodes_to_numpy": true, "max_requests_in_flight_per_env_runner": 1, "sample_timeout_s": 60.0, "_env_to_module_connector": null, "add_default_connectors_to_env_to_module_pipeline": true, "_module_to_env_connector": null, "add_default_connectors_to_module_to_env_pipeline": true, "merge_env_runner_states": "training_only", "broadcast_env_runner_states": true, "episode_lookback_horizon": 1, "rollout_fragment_length": "auto", "batch_mode": "complete_episodes", "compress_observations": false, "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "enable_tf1_exec_eagerly": false, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "preprocessor_pref": "deepmind", "observation_filter": "NoFilter", "update_worker_filter_stats": true, "use_worker_filter_stats": true, "sampler_perf_stats_ema_coef": null, "_is_online": true, "num_learners": 0, "num_gpus_per_learner": 0, "num_cpus_per_learner": "auto", "num_aggregator_actors_per_learner": 0, "max_requests_in_flight_per_aggregator_actor": 3, "local_gpu_idx": 0, "max_requests_in_flight_per_learner": 3, "gamma": 1, "lr": 0.0002847858517, "grad_clip": 0.5, "grad_clip_by": "global_norm", "_train_batch_size_per_learner": 5000, "train_batch_size": 4000, "num_epochs": 1, "minibatch_size": 1000, "shuffle_batch_per_epoch": true, "model": {"fcnet_hiddens": [256, 256], "fcnet_activation": "tanh", "fcnet_weights_initializer": null, "fcnet_weights_initializer_config": null, "fcnet_bias_initializer": null, "fcnet_bias_initializer_config": null, "conv_filters": null, "conv_activation": "relu", "conv_kernel_initializer": null, "conv_kernel_initializer_config": null, "conv_bias_initializer": null, "conv_bias_initializer_config": null, "conv_transpose_kernel_initializer": null, "conv_transpose_kernel_initializer_config": null, "conv_transpose_bias_initializer": null, "conv_transpose_bias_initializer_config": null, "post_fcnet_hiddens": [], "post_fcnet_activation": "relu", "post_fcnet_weights_initializer": null, "post_fcnet_weights_initializer_config": null, "post_fcnet_bias_initializer": null, "post_fcnet_bias_initializer_config": null, "free_log_std": false, "log_std_clip_param": 20.0, "no_final_linear": false, "vf_share_layers": false, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "lstm_weights_initializer": null, "lstm_weights_initializer_config": null, "lstm_bias_initializer": null, "lstm_bias_initializer_config": null, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "attention_use_n_prev_actions": 0, "attention_use_n_prev_rewards": 0, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": null, "custom_model_config": {}, "custom_action_dist": null, "custom_preprocessor": null, "encoder_latent_dim": null, "always_check_shapes": false, "lstm_use_prev_action_reward": -1, "_use_default_native_models": -1, "_disable_preprocessor_api": false, "_disable_action_flattening": false}, "_learner_connector": null, "add_default_connectors_to_learner_pipeline": true, "learner_config_dict": {}, "optimizer": {}, "_learner_class": null, "callbacks_on_algorithm_init": null, "callbacks_on_env_runners_recreated": null, "callbacks_on_offline_eval_runners_recreated": null, "callbacks_on_checkpoint_loaded": null, "callbacks_on_environment_created": null, "callbacks_on_episode_created": null, "callbacks_on_episode_start": null, "callbacks_on_episode_step": null, "callbacks_on_episode_end": null, "callbacks_on_evaluate_start": null, "callbacks_on_evaluate_end": null, "callbacks_on_evaluate_offline_start": null, "callbacks_on_evaluate_offline_end": null, "callbacks_on_sample_end": null, "callbacks_on_train_result": null, "explore": true, "enable_rl_module_and_learner": true, "enable_env_runner_and_connector_v2": true, "_prior_exploration_config": {"type": "StochasticSampling"}, "count_steps_by": "env_steps", "policy_map_capacity": 100, "policy_mapping_fn": "<function AlgorithmConfig.DEFAULT_POLICY_MAPPING_FN at 0x157405b20>", "policies_to_train": null, "policy_states_are_swappable": false, "observation_fn": null, "offline_data_class": null, "input_read_method": "read_parquet", "input_read_method_kwargs": {}, "input_read_schema": {}, "input_read_episodes": false, "input_read_sample_batches": false, "input_read_batch_size": null, "input_filesystem": null, "input_filesystem_kwargs": {}, "input_compress_columns": ["obs", "new_obs"], "input_spaces_jsonable": true, "materialize_data": false, "materialize_mapped_data": true, "map_batches_kwargs": {}, "iter_batches_kwargs": {}, "ignore_final_observation": false, "prelearner_class": null, "prelearner_buffer_class": null, "prelearner_buffer_kwargs": {}, "prelearner_module_synch_period": 10, "dataset_num_iters_per_learner": null, "input_config": {}, "actions_in_input_normalized": false, "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_config": {}, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "output_max_rows_per_file": null, "output_write_remaining_data": false, "output_write_method": "write_parquet", "output_write_method_kwargs": {}, "output_filesystem": null, "output_filesystem_kwargs": {}, "output_write_episodes": true, "offline_sampling": false, "evaluation_interval": 1, "evaluation_duration": 20, "evaluation_duration_unit": "episodes", "evaluation_sample_timeout_s": 120.0, "evaluation_auto_duration_min_env_steps_per_sample": 100, "evaluation_auto_duration_max_env_steps_per_sample": 2000, "evaluation_parallel_to_training": false, "evaluation_force_reset_envs_before_iteration": true, "evaluation_config": null, "off_policy_estimation_methods": {}, "ope_split_batch_by_episode": true, "evaluation_num_env_runners": 1, "in_evaluation": false, "sync_filters_on_rollout_workers_timeout_s": 10.0, "offline_evaluation_interval": null, "num_offline_eval_runners": 0, "offline_loss_for_module_fn": null, "offline_evaluation_duration": 1, "offline_evaluation_parallel_to_training": false, "offline_evaluation_timeout_s": 120.0, "num_cpus_per_offline_eval_runner": 1, "num_gpus_per_offline_eval_runner": 0, "custom_resources_per_offline_eval_runner": {}, "restart_failed_offline_eval_runners": true, "ignore_offline_eval_runner_failures": false, "max_num_offline_eval_runner_restarts": 1000, "offline_eval_runner_restore_timeout_s": 1800.0, "max_requests_in_flight_per_offline_eval_runner": 1, "validate_offline_eval_runners_after_construction": true, "offline_eval_runner_health_probe_timeout_s": 30.0, "offline_eval_rl_module_inference_only": false, "broadcast_offline_eval_runner_states": false, "offline_eval_batch_size_per_runner": 256, "dataset_num_iters_per_eval_runner": 1, "keep_per_episode_custom_metrics": false, "metrics_episode_collection_timeout_s": 60.0, "metrics_num_episodes_for_smoothing": 100, "min_time_s_per_iteration": null, "min_train_timesteps_per_iteration": 0, "min_sample_timesteps_per_iteration": 0, "log_gradients": true, "export_native_model_files": false, "checkpoint_trainable_policies_only": false, "logger_creator": null, "logger_config": null, "log_level": "WARN", "log_sys_usage": true, "fake_sampler": false, "seed": 5, "restart_failed_env_runners": true, "ignore_env_runner_failures": false, "max_num_env_runner_restarts": 1000, "delay_between_env_runner_restarts_s": 60.0, "restart_failed_sub_environments": false, "num_consecutive_env_runner_failures_tolerance": 100, "env_runner_health_probe_timeout_s": 30.0, "env_runner_restore_timeout_s": 1800.0, "_model_config": {}, "_rl_module_spec": "RLModuleSpec(module_class=None, observation_space=None, action_space=None, inference_only=False, learner_only=False, model_config=DefaultModelConfig(fcnet_hiddens=[60, 90], fcnet_activation='tanh', fcnet_kernel_initializer=None, fcnet_kernel_initializer_kwargs=None, fcnet_bias_initializer=None, fcnet_bias_initializer_kwargs=None, conv_filters=None, conv_activation='relu', conv_kernel_initializer=None, conv_kernel_initializer_kwargs=None, conv_bias_initializer=None, conv_bias_initializer_kwargs=None, head_fcnet_hiddens=[], head_fcnet_activation='relu', head_fcnet_kernel_initializer=None, head_fcnet_kernel_initializer_kwargs=None, head_fcnet_bias_initializer=None, head_fcnet_bias_initializer_kwargs=None, free_log_std=False, log_std_clip_param=20.0, vf_share_layers=True, use_lstm=False, max_seq_len=20, lstm_cell_size=256, lstm_use_prev_action=False, lstm_use_prev_reward=False, lstm_kernel_initializer=None, lstm_kernel_initializer_kwargs=None, lstm_bias_initializer=None, lstm_bias_initializer_kwargs=None), catalog_class=None, load_state_path=None, model_config_dict=None)", "algorithm_config_overrides_per_module": {}, "_per_module_overrides": {}, "_validate_config": true, "_use_msgpack_checkpoints": false, "_torch_grad_scaler_class": null, "_torch_lr_scheduler_classes": null, "_tf_policy_handles_more_than_one_loss": false, "_disable_preprocessor_api": false, "_disable_action_flattening": false, "_disable_initialize_loss_from_dummy_batch": false, "_dont_auto_sync_env_runner_states": false, "env_task_fn": -1, "enable_connectors": -1, "simple_optimizer": false, "policy_map_cache": -1, "worker_cls": -1, "synchronize_filters": -1, "enable_async_evaluation": -1, "custom_async_evaluation_function": -1, "_enable_rl_module_api": -1, "auto_wrap_old_gym_envs": -1, "always_attach_evaluation_results": -1, "replay_sequence_length": null, "_disable_execution_plan_api": -1, "use_critic": true, "use_gae": true, "use_kl_loss": true, "kl_coeff": 0.7464963036515, "kl_target": 0.0270990929592, "vf_loss_coeff": 0.6688075857018, "entropy_coeff": 0.0090570820258, "clip_param": 0.1221781641624, "vf_clip_param": 0.1027808522125, "entropy_coeff_schedule": null, "lr_schedule": null, "sgd_minibatch_size": -1, "vf_share_layers": -1, "__stdout_file__": null, "__stderr_file__": null, "lambda": 0.9099046732075, "input": "sampler", "policies": {"default_policy": [null, null, null, null]}, "callbacks": "<class 'ray.rllib.callbacks.callbacks.RLlibCallback'>", "create_env_on_driver": false, "custom_eval_function": null, "framework": "torch"}, "time_since_restore": 29.9466233253479, "iterations_since_restore": 17, "perf": {"cpu_util_percent": 50.400000000000006, "ram_util_percent": 80.25}}
{"timers": {"training_iteration": 1.7752616654071827, "restore_env_runners": 3.427613392391037e-05, "training_step": 1.7749203132665659, "env_runner_sampling_timer": 1.6558205936016914, "learner_update_timer": 0.11567600416336735, "synch_weights": 0.0007025763810932543, "restore_eval_env_runners": 1.025130937456719e-05, "evaluation_iteration": 0.13605269932429803, "synch_eval_env_connectors": 0.00014268612021399994, "synch_env_connectors": 4.898044205070324e-06}, "env_runners": {"env_to_module_sum_episodes_length_in": 10.36823839457432, "episode_return_min": -13.5, "module_to_env_connector": {"timers": {"connectors": {"get_actions": 4.252078772178777e-05, "un_batch_to_individual_items": 5.635052546610689e-06, "tensor_to_numpy": 1.393375071551039e-05, "normalize_and_clip_actions": 9.898431666928489e-06, "remove_single_ts_time_rank_from_batch": 6.406003837395088e-07, "listify_data_for_vector_env": 1.1475749554469224e-05}}, "connector_pipeline_timer": 0.00011036228135891773}, "env_reset_timer": 4.067153646533433e-05, "env_to_module_connector": {"timers": {"connectors": {"numpy_to_tensor": 9.117672806440346e-06, "batch_individual_items": 6.686113412854162e-06, "add_states_from_episodes_to_batch": 1.7607783518214492e-06, "add_time_dim_to_batch_and_zero_pad": 2.41715138247353e-06, "add_observations_from_episodes_to_batch": 3.1170264944871017e-06}}, "connector_pipeline_timer": 4.5212677376885486e-05}, "num_agent_steps_sampled_lifetime": {"default_agent": -9870000.0}, "agent_episode_returns_mean": {"default_agent": 3.5400000000000005}, "num_episodes": 250.0, "num_env_steps_sampled_lifetime": -9870000.0, "episode_len_max": 20, "rlmodule_inference_timer": 3.020638441431013e-05, "weights_seq_no": 17.0, "episode_len_min": 20, "num_env_steps_sampled": 5000.0, "time_between_sampling": 0.0015355436256558749, "episode_len_mean": 20.0, "episode_duration_sec_mean": 0.004826603690162301, "env_step_timer": 1.467326982511744e-05, "num_agent_steps_sampled": {"default_agent": 5000.0}, "num_episodes_lifetime": -493500.0, "module_episode_returns_mean": {"default_policy": 3.5400000000000005}, "num_module_steps_sampled": {"default_policy": 5000.0}, "episode_return_max": 6.5, "sample": 0.005240034870890271, "episode_return_mean": 3.5400000000000005, "env_to_module_sum_episodes_length_out": 10.36823839457432, "num_module_steps_sampled_lifetime": {"default_policy": -9870000.0}, "num_env_steps_sampled_lifetime_throughput": 3539.0408536818827}, "learners": {"default_policy": {"num_trainable_parameters": 6003, "diff_num_grad_updates_vs_sampler_policy": 1.0, "gradients_default_optimizer_global_norm": 0.08192838728427887, "default_optimizer_learning_rate": 0.0002847858517, "module_train_batch_size_mean": 1000.0, "vf_loss_unclipped": 25.955707550048828, "curr_entropy_coeff": 0.0090570820258, "num_module_steps_trained": 6000, "total_loss": 0.271775484085083, "vf_explained_var": -0.01664602756500244, "num_module_steps_trained_lifetime": 108000, "curr_kl_coeff": 2.847657469828846e-06, "policy_loss": 0.20676639676094055, "mean_kl_loss": 0.000187661949894391, "entropy": 0.41199925541877747, "vf_loss": 0.10278083384037018, "weights_seq_no": 18.0, "num_module_steps_trained_lifetime_throughput": 354198.5294210001}, "__all_modules__": {"learner_connector": {"timers": {"connectors": {"add_observations_from_episodes_to_batch": 0.0008761107709320919, "general_advantage_estimation": 0.006762606095643172, "batch_individual_items": 0.03624878814613491, "numpy_to_tensor": 8.083204238550356e-05, "add_one_ts_to_episodes_and_truncate": 0.009088029352746614, "add_time_dim_to_batch_and_zero_pad": 1.2194652658729709e-05, "add_columns_from_episodes_to_train_batch": 0.03440236179915667, "add_states_from_episodes_to_batch": 4.156704304606183e-06}}, "connector_pipeline_timer": 0.08762272854748974}, "learner_connector_sum_episodes_length_in": 5000.0, "num_trainable_parameters": 6003, "num_env_steps_trained": 31500, "num_module_steps_trained": 6000, "learner_connector_sum_episodes_length_out": 5250.0, "num_non_trainable_parameters": 0, "num_module_steps_trained_lifetime": 108000, "num_env_steps_trained_lifetime": 567000, "num_env_steps_trained_lifetime_throughput": 1855298.8972252405, "num_module_steps_trained_throughput": 354160.65804955043, "num_module_steps_trained_lifetime_throughput": 353827.93907558423}}, "num_training_step_calls_per_iteration": 1, "evaluation": {"env_runners": {"num_agent_steps_sampled_lifetime": {"default_agent": 7200}, "env_to_module_sum_episodes_length_in": 10.368238394574323, "agent_episode_returns_mean": {"default_agent": 3.5}, "env_to_module_connector": {"timers": {"connectors": {"add_observations_from_episodes_to_batch": 2.787933003488633e-06, "batch_individual_items": 6.017408377390546e-06, "numpy_to_tensor": 8.240351530315374e-06, "add_time_dim_to_batch_and_zero_pad": 2.259071943494526e-06, "add_states_from_episodes_to_batch": 1.5660707783100355e-06}}, "connector_pipeline_timer": 4.264532604837414e-05}, "module_to_env_connector": {"connector_pipeline_timer": 0.00010278145668265119, "timers": {"connectors": {"remove_single_ts_time_rank_from_batch": 5.76209318744117e-07, "listify_data_for_vector_env": 1.120139207040992e-05, "tensor_to_numpy": 1.2978747667612726e-05, "normalize_and_clip_actions": 9.393461179533259e-06, "un_batch_to_individual_items": 5.374038768906733e-06, "get_actions": 3.652791157838663e-05}}}, "episode_duration_sec_mean": 0.004772989115444944, "sample": 0.12260038064045956, "num_episodes": 20, "episode_len_min": 20, "num_module_steps_sampled": {"default_policy": 400}, "num_env_steps_sampled": 400, "num_episodes_lifetime": 360, "env_to_module_sum_episodes_length_out": 10.368238394574323, "episode_return_min": -15.5, "module_episode_returns_mean": {"default_policy": 3.5}, "num_env_steps_sampled_lifetime": 90400, "rlmodule_inference_timer": 2.7452153054318904e-05, "weights_seq_no": 18.0, "num_module_steps_sampled_lifetime": {"default_policy": 7200}, "env_step_timer": 1.4152043968998718e-05, "episode_return_max": 13.5, "episode_return_mean": 3.5, "env_reset_timer": 0.002224391195986072, "episode_len_max": 20, "num_agent_steps_sampled": {"default_agent": 400}, "episode_len_mean": 20.0, "time_between_sampling": 1.7357712004854882}, "num_healthy_workers": 1, "actor_manager_num_outstanding_async_reqs": 0, "num_remote_worker_restarts": 0}, "num_env_steps_sampled_lifetime": -9870000.0, "fault_tolerance": {"num_healthy_workers": 0, "num_remote_worker_restarts": 0}, "env_runner_group": {"actor_manager_num_outstanding_async_reqs": 0}, "done": false, "training_iteration": 18, "trial_id": "5029b_00000", "date": "2025-08-11_19-22-07", "timestamp": 1754932927, "time_this_iter_s": 1.762570858001709, "time_total_s": 31.70919418334961, "pid": 14328, "hostname": "Mac", "node_ip": "127.0.0.1", "config": {"exploration_config": {}, "extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "placement_strategy": "PACK", "num_gpus": 0, "_fake_gpus": false, "num_cpus_for_main_process": 2, "eager_tracing": true, "eager_max_retraces": 20, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "torch_compile_learner": false, "torch_compile_learner_what_to_compile": "forward_train", "torch_compile_learner_dynamo_backend": "aot_eager", "torch_compile_learner_dynamo_mode": null, "torch_compile_worker": false, "torch_compile_worker_dynamo_backend": "aot_eager", "torch_compile_worker_dynamo_mode": null, "torch_ddp_kwargs": {}, "torch_skip_nan_gradients": false, "env": "Umbrella", "env_config": {}, "observation_space": null, "action_space": null, "clip_rewards": null, "normalize_actions": true, "clip_actions": false, "_is_atari": null, "disable_env_checking": false, "render_env": false, "action_mask_key": "action_mask", "env_runner_cls": null, "num_env_runners": 0, "create_local_env_runner": true, "num_envs_per_env_runner": 1, "gym_env_vectorize_mode": "SYNC", "num_cpus_per_env_runner": 1, "num_gpus_per_env_runner": 0, "custom_resources_per_env_runner": {}, "validate_env_runners_after_construction": true, "episodes_to_numpy": true, "max_requests_in_flight_per_env_runner": 1, "sample_timeout_s": 60.0, "_env_to_module_connector": null, "add_default_connectors_to_env_to_module_pipeline": true, "_module_to_env_connector": null, "add_default_connectors_to_module_to_env_pipeline": true, "merge_env_runner_states": "training_only", "broadcast_env_runner_states": true, "episode_lookback_horizon": 1, "rollout_fragment_length": "auto", "batch_mode": "complete_episodes", "compress_observations": false, "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "enable_tf1_exec_eagerly": false, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "preprocessor_pref": "deepmind", "observation_filter": "NoFilter", "update_worker_filter_stats": true, "use_worker_filter_stats": true, "sampler_perf_stats_ema_coef": null, "_is_online": true, "num_learners": 0, "num_gpus_per_learner": 0, "num_cpus_per_learner": "auto", "num_aggregator_actors_per_learner": 0, "max_requests_in_flight_per_aggregator_actor": 3, "local_gpu_idx": 0, "max_requests_in_flight_per_learner": 3, "gamma": 1, "lr": 0.0002847858517, "grad_clip": 0.5, "grad_clip_by": "global_norm", "_train_batch_size_per_learner": 5000, "train_batch_size": 4000, "num_epochs": 1, "minibatch_size": 1000, "shuffle_batch_per_epoch": true, "model": {"fcnet_hiddens": [256, 256], "fcnet_activation": "tanh", "fcnet_weights_initializer": null, "fcnet_weights_initializer_config": null, "fcnet_bias_initializer": null, "fcnet_bias_initializer_config": null, "conv_filters": null, "conv_activation": "relu", "conv_kernel_initializer": null, "conv_kernel_initializer_config": null, "conv_bias_initializer": null, "conv_bias_initializer_config": null, "conv_transpose_kernel_initializer": null, "conv_transpose_kernel_initializer_config": null, "conv_transpose_bias_initializer": null, "conv_transpose_bias_initializer_config": null, "post_fcnet_hiddens": [], "post_fcnet_activation": "relu", "post_fcnet_weights_initializer": null, "post_fcnet_weights_initializer_config": null, "post_fcnet_bias_initializer": null, "post_fcnet_bias_initializer_config": null, "free_log_std": false, "log_std_clip_param": 20.0, "no_final_linear": false, "vf_share_layers": false, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "lstm_weights_initializer": null, "lstm_weights_initializer_config": null, "lstm_bias_initializer": null, "lstm_bias_initializer_config": null, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "attention_use_n_prev_actions": 0, "attention_use_n_prev_rewards": 0, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": null, "custom_model_config": {}, "custom_action_dist": null, "custom_preprocessor": null, "encoder_latent_dim": null, "always_check_shapes": false, "lstm_use_prev_action_reward": -1, "_use_default_native_models": -1, "_disable_preprocessor_api": false, "_disable_action_flattening": false}, "_learner_connector": null, "add_default_connectors_to_learner_pipeline": true, "learner_config_dict": {}, "optimizer": {}, "_learner_class": null, "callbacks_on_algorithm_init": null, "callbacks_on_env_runners_recreated": null, "callbacks_on_offline_eval_runners_recreated": null, "callbacks_on_checkpoint_loaded": null, "callbacks_on_environment_created": null, "callbacks_on_episode_created": null, "callbacks_on_episode_start": null, "callbacks_on_episode_step": null, "callbacks_on_episode_end": null, "callbacks_on_evaluate_start": null, "callbacks_on_evaluate_end": null, "callbacks_on_evaluate_offline_start": null, "callbacks_on_evaluate_offline_end": null, "callbacks_on_sample_end": null, "callbacks_on_train_result": null, "explore": true, "enable_rl_module_and_learner": true, "enable_env_runner_and_connector_v2": true, "_prior_exploration_config": {"type": "StochasticSampling"}, "count_steps_by": "env_steps", "policy_map_capacity": 100, "policy_mapping_fn": "<function AlgorithmConfig.DEFAULT_POLICY_MAPPING_FN at 0x157405b20>", "policies_to_train": null, "policy_states_are_swappable": false, "observation_fn": null, "offline_data_class": null, "input_read_method": "read_parquet", "input_read_method_kwargs": {}, "input_read_schema": {}, "input_read_episodes": false, "input_read_sample_batches": false, "input_read_batch_size": null, "input_filesystem": null, "input_filesystem_kwargs": {}, "input_compress_columns": ["obs", "new_obs"], "input_spaces_jsonable": true, "materialize_data": false, "materialize_mapped_data": true, "map_batches_kwargs": {}, "iter_batches_kwargs": {}, "ignore_final_observation": false, "prelearner_class": null, "prelearner_buffer_class": null, "prelearner_buffer_kwargs": {}, "prelearner_module_synch_period": 10, "dataset_num_iters_per_learner": null, "input_config": {}, "actions_in_input_normalized": false, "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_config": {}, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "output_max_rows_per_file": null, "output_write_remaining_data": false, "output_write_method": "write_parquet", "output_write_method_kwargs": {}, "output_filesystem": null, "output_filesystem_kwargs": {}, "output_write_episodes": true, "offline_sampling": false, "evaluation_interval": 1, "evaluation_duration": 20, "evaluation_duration_unit": "episodes", "evaluation_sample_timeout_s": 120.0, "evaluation_auto_duration_min_env_steps_per_sample": 100, "evaluation_auto_duration_max_env_steps_per_sample": 2000, "evaluation_parallel_to_training": false, "evaluation_force_reset_envs_before_iteration": true, "evaluation_config": null, "off_policy_estimation_methods": {}, "ope_split_batch_by_episode": true, "evaluation_num_env_runners": 1, "in_evaluation": false, "sync_filters_on_rollout_workers_timeout_s": 10.0, "offline_evaluation_interval": null, "num_offline_eval_runners": 0, "offline_loss_for_module_fn": null, "offline_evaluation_duration": 1, "offline_evaluation_parallel_to_training": false, "offline_evaluation_timeout_s": 120.0, "num_cpus_per_offline_eval_runner": 1, "num_gpus_per_offline_eval_runner": 0, "custom_resources_per_offline_eval_runner": {}, "restart_failed_offline_eval_runners": true, "ignore_offline_eval_runner_failures": false, "max_num_offline_eval_runner_restarts": 1000, "offline_eval_runner_restore_timeout_s": 1800.0, "max_requests_in_flight_per_offline_eval_runner": 1, "validate_offline_eval_runners_after_construction": true, "offline_eval_runner_health_probe_timeout_s": 30.0, "offline_eval_rl_module_inference_only": false, "broadcast_offline_eval_runner_states": false, "offline_eval_batch_size_per_runner": 256, "dataset_num_iters_per_eval_runner": 1, "keep_per_episode_custom_metrics": false, "metrics_episode_collection_timeout_s": 60.0, "metrics_num_episodes_for_smoothing": 100, "min_time_s_per_iteration": null, "min_train_timesteps_per_iteration": 0, "min_sample_timesteps_per_iteration": 0, "log_gradients": true, "export_native_model_files": false, "checkpoint_trainable_policies_only": false, "logger_creator": null, "logger_config": null, "log_level": "WARN", "log_sys_usage": true, "fake_sampler": false, "seed": 5, "restart_failed_env_runners": true, "ignore_env_runner_failures": false, "max_num_env_runner_restarts": 1000, "delay_between_env_runner_restarts_s": 60.0, "restart_failed_sub_environments": false, "num_consecutive_env_runner_failures_tolerance": 100, "env_runner_health_probe_timeout_s": 30.0, "env_runner_restore_timeout_s": 1800.0, "_model_config": {}, "_rl_module_spec": "RLModuleSpec(module_class=None, observation_space=None, action_space=None, inference_only=False, learner_only=False, model_config=DefaultModelConfig(fcnet_hiddens=[60, 90], fcnet_activation='tanh', fcnet_kernel_initializer=None, fcnet_kernel_initializer_kwargs=None, fcnet_bias_initializer=None, fcnet_bias_initializer_kwargs=None, conv_filters=None, conv_activation='relu', conv_kernel_initializer=None, conv_kernel_initializer_kwargs=None, conv_bias_initializer=None, conv_bias_initializer_kwargs=None, head_fcnet_hiddens=[], head_fcnet_activation='relu', head_fcnet_kernel_initializer=None, head_fcnet_kernel_initializer_kwargs=None, head_fcnet_bias_initializer=None, head_fcnet_bias_initializer_kwargs=None, free_log_std=False, log_std_clip_param=20.0, vf_share_layers=True, use_lstm=False, max_seq_len=20, lstm_cell_size=256, lstm_use_prev_action=False, lstm_use_prev_reward=False, lstm_kernel_initializer=None, lstm_kernel_initializer_kwargs=None, lstm_bias_initializer=None, lstm_bias_initializer_kwargs=None), catalog_class=None, load_state_path=None, model_config_dict=None)", "algorithm_config_overrides_per_module": {}, "_per_module_overrides": {}, "_validate_config": true, "_use_msgpack_checkpoints": false, "_torch_grad_scaler_class": null, "_torch_lr_scheduler_classes": null, "_tf_policy_handles_more_than_one_loss": false, "_disable_preprocessor_api": false, "_disable_action_flattening": false, "_disable_initialize_loss_from_dummy_batch": false, "_dont_auto_sync_env_runner_states": false, "env_task_fn": -1, "enable_connectors": -1, "simple_optimizer": false, "policy_map_cache": -1, "worker_cls": -1, "synchronize_filters": -1, "enable_async_evaluation": -1, "custom_async_evaluation_function": -1, "_enable_rl_module_api": -1, "auto_wrap_old_gym_envs": -1, "always_attach_evaluation_results": -1, "replay_sequence_length": null, "_disable_execution_plan_api": -1, "use_critic": true, "use_gae": true, "use_kl_loss": true, "kl_coeff": 0.7464963036515, "kl_target": 0.0270990929592, "vf_loss_coeff": 0.6688075857018, "entropy_coeff": 0.0090570820258, "clip_param": 0.1221781641624, "vf_clip_param": 0.1027808522125, "entropy_coeff_schedule": null, "lr_schedule": null, "sgd_minibatch_size": -1, "vf_share_layers": -1, "__stdout_file__": null, "__stderr_file__": null, "lambda": 0.9099046732075, "input": "sampler", "policies": {"default_policy": [null, null, null, null]}, "callbacks": "<class 'ray.rllib.callbacks.callbacks.RLlibCallback'>", "create_env_on_driver": false, "custom_eval_function": null, "framework": "torch"}, "time_since_restore": 31.70919418334961, "iterations_since_restore": 18, "perf": {"cpu_util_percent": 44.26666666666667, "ram_util_percent": 80.4}}
{"timers": {"training_iteration": 1.7744477879241296, "restore_env_runners": 3.399046265849519e-05, "training_step": 1.7741077955535416, "env_runner_sampling_timer": 1.6539825322460255, "learner_update_timer": 0.11669533246091715, "synch_weights": 0.0007036347871041354, "restore_eval_env_runners": 1.0213795611610368e-05, "evaluation_iteration": 0.13574661608181834, "synch_eval_env_connectors": 0.00014222759933050995, "synch_env_connectors": 4.893232900273978e-06}, "env_runners": {"env_to_module_sum_episodes_length_in": 10.36823839457432, "episode_return_min": -13.5, "module_to_env_connector": {"timers": {"connectors": {"get_actions": 4.309907734147883e-05, "un_batch_to_individual_items": 5.652827493880179e-06, "tensor_to_numpy": 1.39634014160976e-05, "normalize_and_clip_actions": 1.0018789415148946e-05, "remove_single_ts_time_rank_from_batch": 6.080062447659451e-07, "listify_data_for_vector_env": 1.1743304528453467e-05}}, "connector_pipeline_timer": 0.00011180789218066157}, "env_reset_timer": 3.797166070334316e-05, "env_to_module_connector": {"timers": {"connectors": {"numpy_to_tensor": 9.180318637005234e-06, "batch_individual_items": 6.679183696291677e-06, "add_states_from_episodes_to_batch": 1.7910098287245265e-06, "add_time_dim_to_batch_and_zero_pad": 2.8947147014838014e-06, "add_observations_from_episodes_to_batch": 3.162984984431179e-06}}, "connector_pipeline_timer": 4.652232999313383e-05}, "num_agent_steps_sampled_lifetime": {"default_agent": -10487500.0}, "agent_episode_returns_mean": {"default_agent": 4.259999999999998}, "num_episodes": 250.0, "num_env_steps_sampled_lifetime": -10487500.0, "episode_len_max": 20, "rlmodule_inference_timer": 3.0708118983362196e-05, "weights_seq_no": 18.0, "episode_len_min": 20, "num_env_steps_sampled": 5000.0, "time_between_sampling": 0.0018688412236189966, "episode_len_mean": 20.0, "episode_duration_sec_mean": 0.004891595461405815, "env_step_timer": 1.4580167718511291e-05, "num_agent_steps_sampled": {"default_agent": 5000.0}, "num_episodes_lifetime": -524375.0, "module_episode_returns_mean": {"default_policy": 4.259999999999998}, "num_module_steps_sampled": {"default_policy": 5000.0}, "episode_return_max": 6.5, "sample": 0.005202009320630125, "episode_return_mean": 4.259999999999998, "env_to_module_sum_episodes_length_out": 10.36823839457432, "num_module_steps_sampled_lifetime": {"default_policy": -10487500.0}, "num_env_steps_sampled_lifetime_throughput": 3594.036015737942}, "learners": {"default_policy": {"num_trainable_parameters": 6003, "diff_num_grad_updates_vs_sampler_policy": 1.0, "gradients_default_optimizer_global_norm": 0.08828224986791611, "default_optimizer_learning_rate": 0.0002847858517, "module_train_batch_size_mean": 1000.0, "vf_loss_unclipped": 23.938852310180664, "curr_entropy_coeff": 0.0090570820258, "num_module_steps_trained": 6000, "total_loss": 0.12606894969940186, "vf_explained_var": -0.019092679023742676, "num_module_steps_trained_lifetime": 114000, "curr_kl_coeff": 1.423828734914423e-06, "policy_loss": 0.06076934561133385, "mean_kl_loss": 0.00026499663363210857, "entropy": 0.37992289662361145, "vf_loss": 0.10278083384037018, "weights_seq_no": 19.0, "num_module_steps_trained_lifetime_throughput": 353308.47556178365}, "__all_modules__": {"learner_connector": {"timers": {"connectors": {"add_observations_from_episodes_to_batch": 0.0008756904927404633, "general_advantage_estimation": 0.006761213784653808, "batch_individual_items": 0.037346286935780446, "numpy_to_tensor": 8.107289176654941e-05, "add_one_ts_to_episodes_and_truncate": 0.009073110719114404, "add_time_dim_to_batch_and_zero_pad": 1.2176456631107795e-05, "add_columns_from_episodes_to_train_batch": 0.03440781735098274, "add_states_from_episodes_to_batch": 4.145137489994922e-06}}, "connector_pipeline_timer": 0.08870886542200494}, "learner_connector_sum_episodes_length_in": 5000.0, "num_trainable_parameters": 6003, "num_env_steps_trained": 31500, "num_module_steps_trained": 6000, "learner_connector_sum_episodes_length_out": 5250.0, "num_non_trainable_parameters": 0, "num_module_steps_trained_lifetime": 114000, "num_env_steps_trained_lifetime": 598500, "num_env_steps_trained_lifetime_throughput": 1850948.75083669, "num_module_steps_trained_throughput": 353300.01380492235, "num_module_steps_trained_lifetime_throughput": 352978.1620095048}}, "num_training_step_calls_per_iteration": 1, "evaluation": {"env_runners": {"num_agent_steps_sampled_lifetime": {"default_agent": 7600}, "env_to_module_sum_episodes_length_in": 10.368238394574323, "agent_episode_returns_mean": {"default_agent": 2.9}, "env_to_module_connector": {"timers": {"connectors": {"add_observations_from_episodes_to_batch": 2.948748789730398e-06, "batch_individual_items": 6.458687570951067e-06, "numpy_to_tensor": 9.004332730329919e-06, "add_time_dim_to_batch_and_zero_pad": 2.573733761618822e-06, "add_states_from_episodes_to_batch": 1.8905112025795693e-06}}, "connector_pipeline_timer": 4.728998587561199e-05}, "module_to_env_connector": {"connector_pipeline_timer": 0.00011212626037753329, "timers": {"connectors": {"remove_single_ts_time_rank_from_batch": 6.040133216200518e-07, "listify_data_for_vector_env": 1.3235113050449632e-05, "tensor_to_numpy": 1.421517913859999e-05, "normalize_and_clip_actions": 9.73391355697693e-06, "un_batch_to_individual_items": 6.490438459921319e-06, "get_actions": 3.985340733580953e-05}}}, "episode_duration_sec_mean": 0.004886755384504795, "sample": 0.12248852766459949, "num_episodes": 20, "episode_len_min": 20, "num_module_steps_sampled": {"default_policy": 400}, "num_env_steps_sampled": 400, "num_episodes_lifetime": 380, "env_to_module_sum_episodes_length_out": 10.368238394574323, "episode_return_min": -15.5, "module_episode_returns_mean": {"default_policy": 2.9}, "num_env_steps_sampled_lifetime": 95400, "rlmodule_inference_timer": 3.083259063689112e-05, "weights_seq_no": 19.0, "num_module_steps_sampled_lifetime": {"default_policy": 7600}, "env_step_timer": 1.6368087837840937e-05, "episode_return_max": 13.5, "episode_return_mean": 2.9, "env_reset_timer": 0.002203128123857966, "episode_len_max": 20, "num_agent_steps_sampled": {"default_agent": 400}, "episode_len_mean": 20.0, "time_between_sampling": 1.7355443172307201}, "num_healthy_workers": 1, "actor_manager_num_outstanding_async_reqs": 0, "num_remote_worker_restarts": 0}, "num_env_steps_sampled_lifetime": -10487500.0, "fault_tolerance": {"num_healthy_workers": 0, "num_remote_worker_restarts": 0}, "env_runner_group": {"actor_manager_num_outstanding_async_reqs": 0}, "done": false, "training_iteration": 19, "trial_id": "5029b_00000", "date": "2025-08-11_19-22-09", "timestamp": 1754932929, "time_this_iter_s": 1.8150451183319092, "time_total_s": 33.52423930168152, "pid": 14328, "hostname": "Mac", "node_ip": "127.0.0.1", "config": {"exploration_config": {}, "extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "placement_strategy": "PACK", "num_gpus": 0, "_fake_gpus": false, "num_cpus_for_main_process": 2, "eager_tracing": true, "eager_max_retraces": 20, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "torch_compile_learner": false, "torch_compile_learner_what_to_compile": "forward_train", "torch_compile_learner_dynamo_backend": "aot_eager", "torch_compile_learner_dynamo_mode": null, "torch_compile_worker": false, "torch_compile_worker_dynamo_backend": "aot_eager", "torch_compile_worker_dynamo_mode": null, "torch_ddp_kwargs": {}, "torch_skip_nan_gradients": false, "env": "Umbrella", "env_config": {}, "observation_space": null, "action_space": null, "clip_rewards": null, "normalize_actions": true, "clip_actions": false, "_is_atari": null, "disable_env_checking": false, "render_env": false, "action_mask_key": "action_mask", "env_runner_cls": null, "num_env_runners": 0, "create_local_env_runner": true, "num_envs_per_env_runner": 1, "gym_env_vectorize_mode": "SYNC", "num_cpus_per_env_runner": 1, "num_gpus_per_env_runner": 0, "custom_resources_per_env_runner": {}, "validate_env_runners_after_construction": true, "episodes_to_numpy": true, "max_requests_in_flight_per_env_runner": 1, "sample_timeout_s": 60.0, "_env_to_module_connector": null, "add_default_connectors_to_env_to_module_pipeline": true, "_module_to_env_connector": null, "add_default_connectors_to_module_to_env_pipeline": true, "merge_env_runner_states": "training_only", "broadcast_env_runner_states": true, "episode_lookback_horizon": 1, "rollout_fragment_length": "auto", "batch_mode": "complete_episodes", "compress_observations": false, "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "enable_tf1_exec_eagerly": false, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "preprocessor_pref": "deepmind", "observation_filter": "NoFilter", "update_worker_filter_stats": true, "use_worker_filter_stats": true, "sampler_perf_stats_ema_coef": null, "_is_online": true, "num_learners": 0, "num_gpus_per_learner": 0, "num_cpus_per_learner": "auto", "num_aggregator_actors_per_learner": 0, "max_requests_in_flight_per_aggregator_actor": 3, "local_gpu_idx": 0, "max_requests_in_flight_per_learner": 3, "gamma": 1, "lr": 0.0002847858517, "grad_clip": 0.5, "grad_clip_by": "global_norm", "_train_batch_size_per_learner": 5000, "train_batch_size": 4000, "num_epochs": 1, "minibatch_size": 1000, "shuffle_batch_per_epoch": true, "model": {"fcnet_hiddens": [256, 256], "fcnet_activation": "tanh", "fcnet_weights_initializer": null, "fcnet_weights_initializer_config": null, "fcnet_bias_initializer": null, "fcnet_bias_initializer_config": null, "conv_filters": null, "conv_activation": "relu", "conv_kernel_initializer": null, "conv_kernel_initializer_config": null, "conv_bias_initializer": null, "conv_bias_initializer_config": null, "conv_transpose_kernel_initializer": null, "conv_transpose_kernel_initializer_config": null, "conv_transpose_bias_initializer": null, "conv_transpose_bias_initializer_config": null, "post_fcnet_hiddens": [], "post_fcnet_activation": "relu", "post_fcnet_weights_initializer": null, "post_fcnet_weights_initializer_config": null, "post_fcnet_bias_initializer": null, "post_fcnet_bias_initializer_config": null, "free_log_std": false, "log_std_clip_param": 20.0, "no_final_linear": false, "vf_share_layers": false, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "lstm_weights_initializer": null, "lstm_weights_initializer_config": null, "lstm_bias_initializer": null, "lstm_bias_initializer_config": null, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "attention_use_n_prev_actions": 0, "attention_use_n_prev_rewards": 0, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": null, "custom_model_config": {}, "custom_action_dist": null, "custom_preprocessor": null, "encoder_latent_dim": null, "always_check_shapes": false, "lstm_use_prev_action_reward": -1, "_use_default_native_models": -1, "_disable_preprocessor_api": false, "_disable_action_flattening": false}, "_learner_connector": null, "add_default_connectors_to_learner_pipeline": true, "learner_config_dict": {}, "optimizer": {}, "_learner_class": null, "callbacks_on_algorithm_init": null, "callbacks_on_env_runners_recreated": null, "callbacks_on_offline_eval_runners_recreated": null, "callbacks_on_checkpoint_loaded": null, "callbacks_on_environment_created": null, "callbacks_on_episode_created": null, "callbacks_on_episode_start": null, "callbacks_on_episode_step": null, "callbacks_on_episode_end": null, "callbacks_on_evaluate_start": null, "callbacks_on_evaluate_end": null, "callbacks_on_evaluate_offline_start": null, "callbacks_on_evaluate_offline_end": null, "callbacks_on_sample_end": null, "callbacks_on_train_result": null, "explore": true, "enable_rl_module_and_learner": true, "enable_env_runner_and_connector_v2": true, "_prior_exploration_config": {"type": "StochasticSampling"}, "count_steps_by": "env_steps", "policy_map_capacity": 100, "policy_mapping_fn": "<function AlgorithmConfig.DEFAULT_POLICY_MAPPING_FN at 0x157405b20>", "policies_to_train": null, "policy_states_are_swappable": false, "observation_fn": null, "offline_data_class": null, "input_read_method": "read_parquet", "input_read_method_kwargs": {}, "input_read_schema": {}, "input_read_episodes": false, "input_read_sample_batches": false, "input_read_batch_size": null, "input_filesystem": null, "input_filesystem_kwargs": {}, "input_compress_columns": ["obs", "new_obs"], "input_spaces_jsonable": true, "materialize_data": false, "materialize_mapped_data": true, "map_batches_kwargs": {}, "iter_batches_kwargs": {}, "ignore_final_observation": false, "prelearner_class": null, "prelearner_buffer_class": null, "prelearner_buffer_kwargs": {}, "prelearner_module_synch_period": 10, "dataset_num_iters_per_learner": null, "input_config": {}, "actions_in_input_normalized": false, "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_config": {}, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "output_max_rows_per_file": null, "output_write_remaining_data": false, "output_write_method": "write_parquet", "output_write_method_kwargs": {}, "output_filesystem": null, "output_filesystem_kwargs": {}, "output_write_episodes": true, "offline_sampling": false, "evaluation_interval": 1, "evaluation_duration": 20, "evaluation_duration_unit": "episodes", "evaluation_sample_timeout_s": 120.0, "evaluation_auto_duration_min_env_steps_per_sample": 100, "evaluation_auto_duration_max_env_steps_per_sample": 2000, "evaluation_parallel_to_training": false, "evaluation_force_reset_envs_before_iteration": true, "evaluation_config": null, "off_policy_estimation_methods": {}, "ope_split_batch_by_episode": true, "evaluation_num_env_runners": 1, "in_evaluation": false, "sync_filters_on_rollout_workers_timeout_s": 10.0, "offline_evaluation_interval": null, "num_offline_eval_runners": 0, "offline_loss_for_module_fn": null, "offline_evaluation_duration": 1, "offline_evaluation_parallel_to_training": false, "offline_evaluation_timeout_s": 120.0, "num_cpus_per_offline_eval_runner": 1, "num_gpus_per_offline_eval_runner": 0, "custom_resources_per_offline_eval_runner": {}, "restart_failed_offline_eval_runners": true, "ignore_offline_eval_runner_failures": false, "max_num_offline_eval_runner_restarts": 1000, "offline_eval_runner_restore_timeout_s": 1800.0, "max_requests_in_flight_per_offline_eval_runner": 1, "validate_offline_eval_runners_after_construction": true, "offline_eval_runner_health_probe_timeout_s": 30.0, "offline_eval_rl_module_inference_only": false, "broadcast_offline_eval_runner_states": false, "offline_eval_batch_size_per_runner": 256, "dataset_num_iters_per_eval_runner": 1, "keep_per_episode_custom_metrics": false, "metrics_episode_collection_timeout_s": 60.0, "metrics_num_episodes_for_smoothing": 100, "min_time_s_per_iteration": null, "min_train_timesteps_per_iteration": 0, "min_sample_timesteps_per_iteration": 0, "log_gradients": true, "export_native_model_files": false, "checkpoint_trainable_policies_only": false, "logger_creator": null, "logger_config": null, "log_level": "WARN", "log_sys_usage": true, "fake_sampler": false, "seed": 5, "restart_failed_env_runners": true, "ignore_env_runner_failures": false, "max_num_env_runner_restarts": 1000, "delay_between_env_runner_restarts_s": 60.0, "restart_failed_sub_environments": false, "num_consecutive_env_runner_failures_tolerance": 100, "env_runner_health_probe_timeout_s": 30.0, "env_runner_restore_timeout_s": 1800.0, "_model_config": {}, "_rl_module_spec": "RLModuleSpec(module_class=None, observation_space=None, action_space=None, inference_only=False, learner_only=False, model_config=DefaultModelConfig(fcnet_hiddens=[60, 90], fcnet_activation='tanh', fcnet_kernel_initializer=None, fcnet_kernel_initializer_kwargs=None, fcnet_bias_initializer=None, fcnet_bias_initializer_kwargs=None, conv_filters=None, conv_activation='relu', conv_kernel_initializer=None, conv_kernel_initializer_kwargs=None, conv_bias_initializer=None, conv_bias_initializer_kwargs=None, head_fcnet_hiddens=[], head_fcnet_activation='relu', head_fcnet_kernel_initializer=None, head_fcnet_kernel_initializer_kwargs=None, head_fcnet_bias_initializer=None, head_fcnet_bias_initializer_kwargs=None, free_log_std=False, log_std_clip_param=20.0, vf_share_layers=True, use_lstm=False, max_seq_len=20, lstm_cell_size=256, lstm_use_prev_action=False, lstm_use_prev_reward=False, lstm_kernel_initializer=None, lstm_kernel_initializer_kwargs=None, lstm_bias_initializer=None, lstm_bias_initializer_kwargs=None), catalog_class=None, load_state_path=None, model_config_dict=None)", "algorithm_config_overrides_per_module": {}, "_per_module_overrides": {}, "_validate_config": true, "_use_msgpack_checkpoints": false, "_torch_grad_scaler_class": null, "_torch_lr_scheduler_classes": null, "_tf_policy_handles_more_than_one_loss": false, "_disable_preprocessor_api": false, "_disable_action_flattening": false, "_disable_initialize_loss_from_dummy_batch": false, "_dont_auto_sync_env_runner_states": false, "env_task_fn": -1, "enable_connectors": -1, "simple_optimizer": false, "policy_map_cache": -1, "worker_cls": -1, "synchronize_filters": -1, "enable_async_evaluation": -1, "custom_async_evaluation_function": -1, "_enable_rl_module_api": -1, "auto_wrap_old_gym_envs": -1, "always_attach_evaluation_results": -1, "replay_sequence_length": null, "_disable_execution_plan_api": -1, "use_critic": true, "use_gae": true, "use_kl_loss": true, "kl_coeff": 0.7464963036515, "kl_target": 0.0270990929592, "vf_loss_coeff": 0.6688075857018, "entropy_coeff": 0.0090570820258, "clip_param": 0.1221781641624, "vf_clip_param": 0.1027808522125, "entropy_coeff_schedule": null, "lr_schedule": null, "sgd_minibatch_size": -1, "vf_share_layers": -1, "__stdout_file__": null, "__stderr_file__": null, "lambda": 0.9099046732075, "input": "sampler", "policies": {"default_policy": [null, null, null, null]}, "callbacks": "<class 'ray.rllib.callbacks.callbacks.RLlibCallback'>", "create_env_on_driver": false, "custom_eval_function": null, "framework": "torch"}, "time_since_restore": 33.52423930168152, "iterations_since_restore": 19, "perf": {"cpu_util_percent": 43.7, "ram_util_percent": 79.5}}
{"timers": {"training_iteration": 1.772246636294933, "restore_env_runners": 3.370638732779879e-05, "training_step": 1.771908184677899, "env_runner_sampling_timer": 1.6520216540038646, "learner_update_timer": 0.1164561458060824, "synch_weights": 0.000706091769959494, "restore_eval_env_runners": 1.018498766671305e-05, "evaluation_iteration": 0.13556870325071194, "synch_eval_env_connectors": 0.00014361698269750933, "synch_env_connectors": 4.8847106577838045e-06}, "env_runners": {"env_to_module_sum_episodes_length_in": 10.36823839457432, "episode_return_min": -13.5, "module_to_env_connector": {"timers": {"connectors": {"get_actions": 4.2436721324614566e-05, "un_batch_to_individual_items": 5.577089082908281e-06, "tensor_to_numpy": 1.3860168504453488e-05, "normalize_and_clip_actions": 9.811005657796243e-06, "remove_single_ts_time_rank_from_batch": 6.030992018230526e-07, "listify_data_for_vector_env": 1.1537580335918181e-05}}, "connector_pipeline_timer": 0.0001099011875905856}, "env_reset_timer": 4.1888616109162e-05, "env_to_module_connector": {"timers": {"connectors": {"numpy_to_tensor": 9.093902946724405e-06, "batch_individual_items": 6.639697149859675e-06, "add_states_from_episodes_to_batch": 1.7465667357362881e-06, "add_time_dim_to_batch_and_zero_pad": 2.4249991000789216e-06, "add_observations_from_episodes_to_batch": 3.163960034952633e-06}}, "connector_pipeline_timer": 4.5269343247813e-05}, "num_agent_steps_sampled_lifetime": {"default_agent": -11105000.0}, "agent_episode_returns_mean": {"default_agent": 5.380000000000001}, "num_episodes": 250.0, "num_env_steps_sampled_lifetime": -11105000.0, "episode_len_max": 20, "rlmodule_inference_timer": 2.9528162652578085e-05, "weights_seq_no": 19.0, "episode_len_min": 20, "num_env_steps_sampled": 5000.0, "time_between_sampling": 0.002087812343745496, "episode_len_mean": 20.0, "episode_duration_sec_mean": 0.004788343181833625, "env_step_timer": 1.4649623606036504e-05, "num_agent_steps_sampled": {"default_agent": 5000.0}, "num_episodes_lifetime": -555250.0, "module_episode_returns_mean": {"default_policy": 5.380000000000001}, "num_module_steps_sampled": {"default_policy": 5000.0}, "episode_return_max": 6.5, "sample": 0.0051998986500054155, "episode_return_mean": 5.380000000000001, "env_to_module_sum_episodes_length_out": 10.36823839457432, "num_module_steps_sampled_lifetime": {"default_policy": -11105000.0}, "num_env_steps_sampled_lifetime_throughput": 3515.1837094797206}, "learners": {"default_policy": {"num_trainable_parameters": 6003, "diff_num_grad_updates_vs_sampler_policy": 1.0, "gradients_default_optimizer_global_norm": 0.03705389052629471, "default_optimizer_learning_rate": 0.0002847858517, "module_train_batch_size_mean": 1000.0, "vf_loss_unclipped": 22.31365966796875, "curr_entropy_coeff": 0.0090570820258, "num_module_steps_trained": 6000, "total_loss": 0.05449638143181801, "vf_explained_var": -0.02270638942718506, "num_module_steps_trained_lifetime": 120000, "curr_kl_coeff": 7.119143674572115e-07, "policy_loss": -0.010907428339123726, "mean_kl_loss": 1.596551010152325e-05, "entropy": 0.36841875314712524, "vf_loss": 0.10278083384037018, "weights_seq_no": 20.0, "num_module_steps_trained_lifetime_throughput": 354078.8255016943}, "__all_modules__": {"learner_connector": {"timers": {"connectors": {"add_observations_from_episodes_to_batch": 0.0008749773370709808, "general_advantage_estimation": 0.006749589566720875, "batch_individual_items": 0.03727909281641407, "numpy_to_tensor": 8.112175263049606e-05, "add_one_ts_to_episodes_and_truncate": 0.00905875794204594, "add_time_dim_to_batch_and_zero_pad": 1.2210942381446392e-05, "add_columns_from_episodes_to_train_batch": 0.034403251266740285, "add_states_from_episodes_to_batch": 4.139525736072613e-06}}, "connector_pipeline_timer": 0.08861007301701436}, "learner_connector_sum_episodes_length_in": 5000.0, "num_trainable_parameters": 6003, "num_env_steps_trained": 31500, "num_module_steps_trained": 6000, "learner_connector_sum_episodes_length_out": 5250.0, "num_non_trainable_parameters": 0, "num_module_steps_trained_lifetime": 120000, "num_env_steps_trained_lifetime": 630000, "num_env_steps_trained_lifetime_throughput": 1855329.0950628093, "num_module_steps_trained_throughput": 354103.84386469674, "num_module_steps_trained_lifetime_throughput": 353792.42810909956}}, "num_training_step_calls_per_iteration": 1, "evaluation": {"env_runners": {"num_agent_steps_sampled_lifetime": {"default_agent": 8000}, "env_to_module_sum_episodes_length_in": 10.368238394574323, "agent_episode_returns_mean": {"default_agent": 2.5}, "env_to_module_connector": {"timers": {"connectors": {"add_observations_from_episodes_to_batch": 3.3870378944836024e-06, "batch_individual_items": 6.5179421436582835e-06, "numpy_to_tensor": 9.581252274382337e-06, "add_time_dim_to_batch_and_zero_pad": 2.3821255159499533e-06, "add_states_from_episodes_to_batch": 1.616508596894046e-06}}, "connector_pipeline_timer": 4.641532329700731e-05}, "module_to_env_connector": {"connector_pipeline_timer": 0.00010955994330920555, "timers": {"connectors": {"remove_single_ts_time_rank_from_batch": 6.189625027873794e-07, "listify_data_for_vector_env": 1.2095767524623437e-05, "tensor_to_numpy": 1.4136065243056542e-05, "normalize_and_clip_actions": 9.869744158191702e-06, "un_batch_to_individual_items": 5.623771682127715e-06, "get_actions": 3.965164115276763e-05}}}, "episode_duration_sec_mean": 0.00491193208610639, "sample": 0.12227949280759776, "num_episodes": 20, "episode_len_min": 20, "num_module_steps_sampled": {"default_policy": 400}, "num_env_steps_sampled": 400, "num_episodes_lifetime": 400, "env_to_module_sum_episodes_length_out": 10.368238394574323, "episode_return_min": -15.5, "module_episode_returns_mean": {"default_policy": 2.5}, "num_env_steps_sampled_lifetime": 100400, "rlmodule_inference_timer": 3.024323760326619e-05, "weights_seq_no": 20.0, "num_module_steps_sampled_lifetime": {"default_policy": 8000}, "env_step_timer": 1.5151997228092529e-05, "episode_return_max": 12.5, "episode_return_mean": 2.5, "env_reset_timer": 0.0021818997625864863, "episode_len_max": 20, "num_agent_steps_sampled": {"default_agent": 400}, "episode_len_mean": 20.0, "time_between_sampling": 1.7339405111484103}, "num_healthy_workers": 1, "actor_manager_num_outstanding_async_reqs": 0, "num_remote_worker_restarts": 0}, "num_env_steps_sampled_lifetime": -11105000.0, "fault_tolerance": {"num_healthy_workers": 0, "num_remote_worker_restarts": 0}, "env_runner_group": {"actor_manager_num_outstanding_async_reqs": 0}, "done": true, "training_iteration": 20, "trial_id": "5029b_00000", "date": "2025-08-11_19-22-11", "timestamp": 1754932931, "time_this_iter_s": 1.6644139289855957, "time_total_s": 35.188653230667114, "pid": 14328, "hostname": "Mac", "node_ip": "127.0.0.1", "config": {"exploration_config": {}, "extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "placement_strategy": "PACK", "num_gpus": 0, "_fake_gpus": false, "num_cpus_for_main_process": 2, "eager_tracing": true, "eager_max_retraces": 20, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "torch_compile_learner": false, "torch_compile_learner_what_to_compile": "forward_train", "torch_compile_learner_dynamo_backend": "aot_eager", "torch_compile_learner_dynamo_mode": null, "torch_compile_worker": false, "torch_compile_worker_dynamo_backend": "aot_eager", "torch_compile_worker_dynamo_mode": null, "torch_ddp_kwargs": {}, "torch_skip_nan_gradients": false, "env": "Umbrella", "env_config": {}, "observation_space": null, "action_space": null, "clip_rewards": null, "normalize_actions": true, "clip_actions": false, "_is_atari": null, "disable_env_checking": false, "render_env": false, "action_mask_key": "action_mask", "env_runner_cls": null, "num_env_runners": 0, "create_local_env_runner": true, "num_envs_per_env_runner": 1, "gym_env_vectorize_mode": "SYNC", "num_cpus_per_env_runner": 1, "num_gpus_per_env_runner": 0, "custom_resources_per_env_runner": {}, "validate_env_runners_after_construction": true, "episodes_to_numpy": true, "max_requests_in_flight_per_env_runner": 1, "sample_timeout_s": 60.0, "_env_to_module_connector": null, "add_default_connectors_to_env_to_module_pipeline": true, "_module_to_env_connector": null, "add_default_connectors_to_module_to_env_pipeline": true, "merge_env_runner_states": "training_only", "broadcast_env_runner_states": true, "episode_lookback_horizon": 1, "rollout_fragment_length": "auto", "batch_mode": "complete_episodes", "compress_observations": false, "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "enable_tf1_exec_eagerly": false, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "preprocessor_pref": "deepmind", "observation_filter": "NoFilter", "update_worker_filter_stats": true, "use_worker_filter_stats": true, "sampler_perf_stats_ema_coef": null, "_is_online": true, "num_learners": 0, "num_gpus_per_learner": 0, "num_cpus_per_learner": "auto", "num_aggregator_actors_per_learner": 0, "max_requests_in_flight_per_aggregator_actor": 3, "local_gpu_idx": 0, "max_requests_in_flight_per_learner": 3, "gamma": 1, "lr": 0.0002847858517, "grad_clip": 0.5, "grad_clip_by": "global_norm", "_train_batch_size_per_learner": 5000, "train_batch_size": 4000, "num_epochs": 1, "minibatch_size": 1000, "shuffle_batch_per_epoch": true, "model": {"fcnet_hiddens": [256, 256], "fcnet_activation": "tanh", "fcnet_weights_initializer": null, "fcnet_weights_initializer_config": null, "fcnet_bias_initializer": null, "fcnet_bias_initializer_config": null, "conv_filters": null, "conv_activation": "relu", "conv_kernel_initializer": null, "conv_kernel_initializer_config": null, "conv_bias_initializer": null, "conv_bias_initializer_config": null, "conv_transpose_kernel_initializer": null, "conv_transpose_kernel_initializer_config": null, "conv_transpose_bias_initializer": null, "conv_transpose_bias_initializer_config": null, "post_fcnet_hiddens": [], "post_fcnet_activation": "relu", "post_fcnet_weights_initializer": null, "post_fcnet_weights_initializer_config": null, "post_fcnet_bias_initializer": null, "post_fcnet_bias_initializer_config": null, "free_log_std": false, "log_std_clip_param": 20.0, "no_final_linear": false, "vf_share_layers": false, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "lstm_weights_initializer": null, "lstm_weights_initializer_config": null, "lstm_bias_initializer": null, "lstm_bias_initializer_config": null, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "attention_use_n_prev_actions": 0, "attention_use_n_prev_rewards": 0, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": null, "custom_model_config": {}, "custom_action_dist": null, "custom_preprocessor": null, "encoder_latent_dim": null, "always_check_shapes": false, "lstm_use_prev_action_reward": -1, "_use_default_native_models": -1, "_disable_preprocessor_api": false, "_disable_action_flattening": false}, "_learner_connector": null, "add_default_connectors_to_learner_pipeline": true, "learner_config_dict": {}, "optimizer": {}, "_learner_class": null, "callbacks_on_algorithm_init": null, "callbacks_on_env_runners_recreated": null, "callbacks_on_offline_eval_runners_recreated": null, "callbacks_on_checkpoint_loaded": null, "callbacks_on_environment_created": null, "callbacks_on_episode_created": null, "callbacks_on_episode_start": null, "callbacks_on_episode_step": null, "callbacks_on_episode_end": null, "callbacks_on_evaluate_start": null, "callbacks_on_evaluate_end": null, "callbacks_on_evaluate_offline_start": null, "callbacks_on_evaluate_offline_end": null, "callbacks_on_sample_end": null, "callbacks_on_train_result": null, "explore": true, "enable_rl_module_and_learner": true, "enable_env_runner_and_connector_v2": true, "_prior_exploration_config": {"type": "StochasticSampling"}, "count_steps_by": "env_steps", "policy_map_capacity": 100, "policy_mapping_fn": "<function AlgorithmConfig.DEFAULT_POLICY_MAPPING_FN at 0x157405b20>", "policies_to_train": null, "policy_states_are_swappable": false, "observation_fn": null, "offline_data_class": null, "input_read_method": "read_parquet", "input_read_method_kwargs": {}, "input_read_schema": {}, "input_read_episodes": false, "input_read_sample_batches": false, "input_read_batch_size": null, "input_filesystem": null, "input_filesystem_kwargs": {}, "input_compress_columns": ["obs", "new_obs"], "input_spaces_jsonable": true, "materialize_data": false, "materialize_mapped_data": true, "map_batches_kwargs": {}, "iter_batches_kwargs": {}, "ignore_final_observation": false, "prelearner_class": null, "prelearner_buffer_class": null, "prelearner_buffer_kwargs": {}, "prelearner_module_synch_period": 10, "dataset_num_iters_per_learner": null, "input_config": {}, "actions_in_input_normalized": false, "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_config": {}, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "output_max_rows_per_file": null, "output_write_remaining_data": false, "output_write_method": "write_parquet", "output_write_method_kwargs": {}, "output_filesystem": null, "output_filesystem_kwargs": {}, "output_write_episodes": true, "offline_sampling": false, "evaluation_interval": 1, "evaluation_duration": 20, "evaluation_duration_unit": "episodes", "evaluation_sample_timeout_s": 120.0, "evaluation_auto_duration_min_env_steps_per_sample": 100, "evaluation_auto_duration_max_env_steps_per_sample": 2000, "evaluation_parallel_to_training": false, "evaluation_force_reset_envs_before_iteration": true, "evaluation_config": null, "off_policy_estimation_methods": {}, "ope_split_batch_by_episode": true, "evaluation_num_env_runners": 1, "in_evaluation": false, "sync_filters_on_rollout_workers_timeout_s": 10.0, "offline_evaluation_interval": null, "num_offline_eval_runners": 0, "offline_loss_for_module_fn": null, "offline_evaluation_duration": 1, "offline_evaluation_parallel_to_training": false, "offline_evaluation_timeout_s": 120.0, "num_cpus_per_offline_eval_runner": 1, "num_gpus_per_offline_eval_runner": 0, "custom_resources_per_offline_eval_runner": {}, "restart_failed_offline_eval_runners": true, "ignore_offline_eval_runner_failures": false, "max_num_offline_eval_runner_restarts": 1000, "offline_eval_runner_restore_timeout_s": 1800.0, "max_requests_in_flight_per_offline_eval_runner": 1, "validate_offline_eval_runners_after_construction": true, "offline_eval_runner_health_probe_timeout_s": 30.0, "offline_eval_rl_module_inference_only": false, "broadcast_offline_eval_runner_states": false, "offline_eval_batch_size_per_runner": 256, "dataset_num_iters_per_eval_runner": 1, "keep_per_episode_custom_metrics": false, "metrics_episode_collection_timeout_s": 60.0, "metrics_num_episodes_for_smoothing": 100, "min_time_s_per_iteration": null, "min_train_timesteps_per_iteration": 0, "min_sample_timesteps_per_iteration": 0, "log_gradients": true, "export_native_model_files": false, "checkpoint_trainable_policies_only": false, "logger_creator": null, "logger_config": null, "log_level": "WARN", "log_sys_usage": true, "fake_sampler": false, "seed": 5, "restart_failed_env_runners": true, "ignore_env_runner_failures": false, "max_num_env_runner_restarts": 1000, "delay_between_env_runner_restarts_s": 60.0, "restart_failed_sub_environments": false, "num_consecutive_env_runner_failures_tolerance": 100, "env_runner_health_probe_timeout_s": 30.0, "env_runner_restore_timeout_s": 1800.0, "_model_config": {}, "_rl_module_spec": "RLModuleSpec(module_class=None, observation_space=None, action_space=None, inference_only=False, learner_only=False, model_config=DefaultModelConfig(fcnet_hiddens=[60, 90], fcnet_activation='tanh', fcnet_kernel_initializer=None, fcnet_kernel_initializer_kwargs=None, fcnet_bias_initializer=None, fcnet_bias_initializer_kwargs=None, conv_filters=None, conv_activation='relu', conv_kernel_initializer=None, conv_kernel_initializer_kwargs=None, conv_bias_initializer=None, conv_bias_initializer_kwargs=None, head_fcnet_hiddens=[], head_fcnet_activation='relu', head_fcnet_kernel_initializer=None, head_fcnet_kernel_initializer_kwargs=None, head_fcnet_bias_initializer=None, head_fcnet_bias_initializer_kwargs=None, free_log_std=False, log_std_clip_param=20.0, vf_share_layers=True, use_lstm=False, max_seq_len=20, lstm_cell_size=256, lstm_use_prev_action=False, lstm_use_prev_reward=False, lstm_kernel_initializer=None, lstm_kernel_initializer_kwargs=None, lstm_bias_initializer=None, lstm_bias_initializer_kwargs=None), catalog_class=None, load_state_path=None, model_config_dict=None)", "algorithm_config_overrides_per_module": {}, "_per_module_overrides": {}, "_validate_config": true, "_use_msgpack_checkpoints": false, "_torch_grad_scaler_class": null, "_torch_lr_scheduler_classes": null, "_tf_policy_handles_more_than_one_loss": false, "_disable_preprocessor_api": false, "_disable_action_flattening": false, "_disable_initialize_loss_from_dummy_batch": false, "_dont_auto_sync_env_runner_states": false, "env_task_fn": -1, "enable_connectors": -1, "simple_optimizer": false, "policy_map_cache": -1, "worker_cls": -1, "synchronize_filters": -1, "enable_async_evaluation": -1, "custom_async_evaluation_function": -1, "_enable_rl_module_api": -1, "auto_wrap_old_gym_envs": -1, "always_attach_evaluation_results": -1, "replay_sequence_length": null, "_disable_execution_plan_api": -1, "use_critic": true, "use_gae": true, "use_kl_loss": true, "kl_coeff": 0.7464963036515, "kl_target": 0.0270990929592, "vf_loss_coeff": 0.6688075857018, "entropy_coeff": 0.0090570820258, "clip_param": 0.1221781641624, "vf_clip_param": 0.1027808522125, "entropy_coeff_schedule": null, "lr_schedule": null, "sgd_minibatch_size": -1, "vf_share_layers": -1, "__stdout_file__": null, "__stderr_file__": null, "lambda": 0.9099046732075, "input": "sampler", "policies": {"default_policy": [null, null, null, null]}, "callbacks": "<class 'ray.rllib.callbacks.callbacks.RLlibCallback'>", "create_env_on_driver": false, "custom_eval_function": null, "framework": "torch"}, "time_since_restore": 35.188653230667114, "iterations_since_restore": 20, "perf": {"cpu_util_percent": 41.1, "ram_util_percent": 79.2}}
