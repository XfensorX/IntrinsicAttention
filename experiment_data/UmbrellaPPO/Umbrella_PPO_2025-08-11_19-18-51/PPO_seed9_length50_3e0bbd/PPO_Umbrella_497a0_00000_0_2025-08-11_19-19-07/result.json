{"timers": {"training_iteration": 19.333287375047803, "restore_env_runners": 3.50000336766243e-05, "training_step": 19.332428374909796, "env_runner_sampling_timer": 18.13471504196059, "learner_update_timer": 1.128342832904309, "synch_weights": 0.04591062502004206}, "env_runners": {"module_to_env_connector": {"timers": {"connectors": {"un_batch_to_individual_items": 6.731655754027388e-05, "tensor_to_numpy": 0.0002137544864374339, "normalize_and_clip_actions": 0.00010760770414346737, "remove_single_ts_time_rank_from_batch": 3.397364753288875e-06, "listify_data_for_vector_env": 0.00014788782396767946, "get_actions": 0.0007378619664258559}}, "connector_pipeline_timer": 0.0014973889212354656}, "time_between_sampling": 0.012835065264311461, "episode_len_max": 20, "num_env_steps_sampled_lifetime": 627500.0, "env_to_module_sum_episodes_length_in": 10.191744832559449, "sample": 0.10649530654349998, "num_agent_steps_sampled_lifetime": {"default_agent": 627500.0}, "episode_len_mean": 20.0, "rlmodule_inference_timer": 0.0006183224649069283, "num_episodes_lifetime": 31375.0, "num_module_steps_sampled": {"default_policy": 5000.0}, "env_to_module_connector": {"connector_pipeline_timer": 0.00045279266623329334, "timers": {"connectors": {"add_states_from_episodes_to_batch": 1.2043978098795416e-05, "batch_individual_items": 0.00010343047128763933, "add_observations_from_episodes_to_batch": 2.6272788365195532e-05, "add_time_dim_to_batch_and_zero_pad": 2.2367571889006926e-05, "numpy_to_tensor": 0.00012221346368684256}}}, "module_episode_returns_mean": {"default_policy": 2.740000000000001}, "num_agent_steps_sampled": {"default_agent": 5000.0}, "num_episodes": 250.0, "episode_len_min": 20, "env_to_module_sum_episodes_length_out": 10.191744832559449, "num_module_steps_sampled_lifetime": {"default_policy": 627500.0}, "env_reset_timer": 0.0023404599314372832, "episode_duration_sec_mean": 0.06386102345446125, "episode_return_max": 14.5, "weights_seq_no": 0.0, "env_step_timer": 0.00022223544409981762, "episode_return_min": -5.5, "agent_episode_returns_mean": {"default_agent": 2.740000000000001}, "num_env_steps_sampled": 5000.0, "episode_return_mean": 2.740000000000001, "num_env_steps_sampled_lifetime_throughput": 588.0103111905855}, "learners": {"__all_modules__": {"num_non_trainable_parameters": 0, "learner_connector": {"timers": {"connectors": {"add_time_dim_to_batch_and_zero_pad": 0.00017079198732972145, "numpy_to_tensor": 0.0001391249243170023, "general_advantage_estimation": 0.06085912499111146, "add_states_from_episodes_to_batch": 6.4159976318478584e-06, "add_one_ts_to_episodes_and_truncate": 0.11620658403262496, "batch_individual_items": 0.35570920805912465, "add_observations_from_episodes_to_batch": 0.004459624993614852, "add_columns_from_episodes_to_train_batch": 0.34283408301416785}}, "connector_pipeline_timer": 0.8810342920478433}, "learner_connector_sum_episodes_length_in": 5000, "num_module_steps_trained": 6000, "num_module_steps_trained_lifetime": 6000, "num_env_steps_trained": 31500, "learner_connector_sum_episodes_length_out": 5250, "num_trainable_parameters": 6003, "num_env_steps_trained_lifetime": 31500, "num_env_steps_trained_lifetime_throughput": 469003.21614768717, "num_module_steps_trained_throughput": 89678.033252463, "num_module_steps_trained_lifetime_throughput": 89557.84047764615}, "default_policy": {"module_train_batch_size_mean": 1000.0, "mean_kl_loss": 0.0010491644497960806, "curr_entropy_coeff": 0.0090570820258, "weights_seq_no": 1.0, "num_module_steps_trained": 6000, "curr_kl_coeff": 0.3732481598854065, "diff_num_grad_updates_vs_sampler_policy": 1.0, "num_module_steps_trained_lifetime": 6000, "vf_loss": 0.09794427454471588, "gradients_default_optimizer_global_norm": 0.18117614090442657, "total_loss": -0.004588165320456028, "policy_loss": -0.06464065611362457, "num_trainable_parameters": 6003, "default_optimizer_learning_rate": 0.0002847858517, "vf_explained_var": 0.0010921955108642578, "entropy": 0.6885873675346375, "vf_loss_unclipped": 30.640653610229492, "num_module_steps_trained_lifetime_throughput": 89841.95697828766}}, "num_training_step_calls_per_iteration": 1, "num_env_steps_sampled_lifetime": 627500.0, "evaluation": {"env_runners": {"module_to_env_connector": {"connector_pipeline_timer": 0.005666726806014747, "timers": {"connectors": {"remove_single_ts_time_rank_from_batch": 3.869033694460496e-05, "normalize_and_clip_actions": 0.0010174964369960272, "tensor_to_numpy": 0.001893706723310484, "listify_data_for_vector_env": 0.00013727512665215032, "un_batch_to_individual_items": 9.64654917444965e-05, "get_actions": 0.0020541743325945038}}}, "env_to_module_connector": {"timers": {"connectors": {"numpy_to_tensor": 0.00012938250577948756, "add_states_from_episodes_to_batch": 4.562230273837597e-05, "batch_individual_items": 0.0002053563381813151, "add_observations_from_episodes_to_batch": 1.7830242535475976e-05, "add_time_dim_to_batch_and_zero_pad": 2.1684609921466832e-05}}, "connector_pipeline_timer": 0.0006362683940772674}, "num_episodes": 20, "num_env_steps_sampled": 400, "num_env_steps_sampled_lifetime": 5400, "episode_len_mean": 20.0, "num_module_steps_sampled": {"default_policy": 400}, "episode_return_max": 15.5, "weights_seq_no": 1.0, "episode_len_max": 20, "num_agent_steps_sampled_lifetime": {"default_agent": 400}, "sample": 1.9034320829669014, "module_episode_returns_mean": {"default_policy": 0.7}, "num_agent_steps_sampled": {"default_agent": 400}, "agent_episode_returns_mean": {"default_agent": 0.7}, "rlmodule_inference_timer": 0.0005310473357681239, "num_episodes_lifetime": 20, "num_module_steps_sampled_lifetime": {"default_policy": 400}, "episode_len_min": 20, "env_to_module_sum_episodes_length_out": 10.216013141322508, "env_reset_timer": 0.018982958048582077, "episode_duration_sec_mean": 0.089576702110935, "env_step_timer": 0.0003748701028612349, "episode_return_min": -12.5, "episode_return_mean": 0.7, "env_to_module_sum_episodes_length_in": 10.216013141322508}, "num_healthy_workers": 1, "actor_manager_num_outstanding_async_reqs": 0, "num_remote_worker_restarts": 0}, "fault_tolerance": {"num_healthy_workers": 0, "num_remote_worker_restarts": 0}, "env_runner_group": {"actor_manager_num_outstanding_async_reqs": 0}, "done": false, "training_iteration": 1, "trial_id": "497a0_00000", "date": "2025-08-11_19-28-14", "timestamp": 1754933294, "time_this_iter_s": 21.421238899230957, "time_total_s": 21.421238899230957, "pid": 19607, "hostname": "Mac", "node_ip": "127.0.0.1", "config": {"exploration_config": {}, "extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "placement_strategy": "PACK", "num_gpus": 0, "_fake_gpus": false, "num_cpus_for_main_process": 2, "eager_tracing": true, "eager_max_retraces": 20, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "torch_compile_learner": false, "torch_compile_learner_what_to_compile": "forward_train", "torch_compile_learner_dynamo_backend": "aot_eager", "torch_compile_learner_dynamo_mode": null, "torch_compile_worker": false, "torch_compile_worker_dynamo_backend": "aot_eager", "torch_compile_worker_dynamo_mode": null, "torch_ddp_kwargs": {}, "torch_skip_nan_gradients": false, "env": "Umbrella", "env_config": {}, "observation_space": null, "action_space": null, "clip_rewards": null, "normalize_actions": true, "clip_actions": false, "_is_atari": null, "disable_env_checking": false, "render_env": false, "action_mask_key": "action_mask", "env_runner_cls": null, "num_env_runners": 0, "create_local_env_runner": true, "num_envs_per_env_runner": 1, "gym_env_vectorize_mode": "SYNC", "num_cpus_per_env_runner": 1, "num_gpus_per_env_runner": 0, "custom_resources_per_env_runner": {}, "validate_env_runners_after_construction": true, "episodes_to_numpy": true, "max_requests_in_flight_per_env_runner": 1, "sample_timeout_s": 60.0, "_env_to_module_connector": null, "add_default_connectors_to_env_to_module_pipeline": true, "_module_to_env_connector": null, "add_default_connectors_to_module_to_env_pipeline": true, "merge_env_runner_states": "training_only", "broadcast_env_runner_states": true, "episode_lookback_horizon": 1, "rollout_fragment_length": "auto", "batch_mode": "complete_episodes", "compress_observations": false, "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "enable_tf1_exec_eagerly": false, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "preprocessor_pref": "deepmind", "observation_filter": "NoFilter", "update_worker_filter_stats": true, "use_worker_filter_stats": true, "sampler_perf_stats_ema_coef": null, "_is_online": true, "num_learners": 0, "num_gpus_per_learner": 0, "num_cpus_per_learner": "auto", "num_aggregator_actors_per_learner": 0, "max_requests_in_flight_per_aggregator_actor": 3, "local_gpu_idx": 0, "max_requests_in_flight_per_learner": 3, "gamma": 1, "lr": 0.0002847858517, "grad_clip": 0.5, "grad_clip_by": "global_norm", "_train_batch_size_per_learner": 5000, "train_batch_size": 4000, "num_epochs": 1, "minibatch_size": 1000, "shuffle_batch_per_epoch": true, "model": {"fcnet_hiddens": [256, 256], "fcnet_activation": "tanh", "fcnet_weights_initializer": null, "fcnet_weights_initializer_config": null, "fcnet_bias_initializer": null, "fcnet_bias_initializer_config": null, "conv_filters": null, "conv_activation": "relu", "conv_kernel_initializer": null, "conv_kernel_initializer_config": null, "conv_bias_initializer": null, "conv_bias_initializer_config": null, "conv_transpose_kernel_initializer": null, "conv_transpose_kernel_initializer_config": null, "conv_transpose_bias_initializer": null, "conv_transpose_bias_initializer_config": null, "post_fcnet_hiddens": [], "post_fcnet_activation": "relu", "post_fcnet_weights_initializer": null, "post_fcnet_weights_initializer_config": null, "post_fcnet_bias_initializer": null, "post_fcnet_bias_initializer_config": null, "free_log_std": false, "log_std_clip_param": 20.0, "no_final_linear": false, "vf_share_layers": false, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "lstm_weights_initializer": null, "lstm_weights_initializer_config": null, "lstm_bias_initializer": null, "lstm_bias_initializer_config": null, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "attention_use_n_prev_actions": 0, "attention_use_n_prev_rewards": 0, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": null, "custom_model_config": {}, "custom_action_dist": null, "custom_preprocessor": null, "encoder_latent_dim": null, "always_check_shapes": false, "lstm_use_prev_action_reward": -1, "_use_default_native_models": -1, "_disable_preprocessor_api": false, "_disable_action_flattening": false}, "_learner_connector": null, "add_default_connectors_to_learner_pipeline": true, "learner_config_dict": {}, "optimizer": {}, "_learner_class": null, "callbacks_on_algorithm_init": null, "callbacks_on_env_runners_recreated": null, "callbacks_on_offline_eval_runners_recreated": null, "callbacks_on_checkpoint_loaded": null, "callbacks_on_environment_created": null, "callbacks_on_episode_created": null, "callbacks_on_episode_start": null, "callbacks_on_episode_step": null, "callbacks_on_episode_end": null, "callbacks_on_evaluate_start": null, "callbacks_on_evaluate_end": null, "callbacks_on_evaluate_offline_start": null, "callbacks_on_evaluate_offline_end": null, "callbacks_on_sample_end": null, "callbacks_on_train_result": null, "explore": true, "enable_rl_module_and_learner": true, "enable_env_runner_and_connector_v2": true, "_prior_exploration_config": {"type": "StochasticSampling"}, "count_steps_by": "env_steps", "policy_map_capacity": 100, "policy_mapping_fn": "<function AlgorithmConfig.DEFAULT_POLICY_MAPPING_FN at 0x3862edb20>", "policies_to_train": null, "policy_states_are_swappable": false, "observation_fn": null, "offline_data_class": null, "input_read_method": "read_parquet", "input_read_method_kwargs": {}, "input_read_schema": {}, "input_read_episodes": false, "input_read_sample_batches": false, "input_read_batch_size": null, "input_filesystem": null, "input_filesystem_kwargs": {}, "input_compress_columns": ["obs", "new_obs"], "input_spaces_jsonable": true, "materialize_data": false, "materialize_mapped_data": true, "map_batches_kwargs": {}, "iter_batches_kwargs": {}, "ignore_final_observation": false, "prelearner_class": null, "prelearner_buffer_class": null, "prelearner_buffer_kwargs": {}, "prelearner_module_synch_period": 10, "dataset_num_iters_per_learner": null, "input_config": {}, "actions_in_input_normalized": false, "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_config": {}, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "output_max_rows_per_file": null, "output_write_remaining_data": false, "output_write_method": "write_parquet", "output_write_method_kwargs": {}, "output_filesystem": null, "output_filesystem_kwargs": {}, "output_write_episodes": true, "offline_sampling": false, "evaluation_interval": 1, "evaluation_duration": 20, "evaluation_duration_unit": "episodes", "evaluation_sample_timeout_s": 120.0, "evaluation_auto_duration_min_env_steps_per_sample": 100, "evaluation_auto_duration_max_env_steps_per_sample": 2000, "evaluation_parallel_to_training": false, "evaluation_force_reset_envs_before_iteration": true, "evaluation_config": null, "off_policy_estimation_methods": {}, "ope_split_batch_by_episode": true, "evaluation_num_env_runners": 1, "in_evaluation": false, "sync_filters_on_rollout_workers_timeout_s": 10.0, "offline_evaluation_interval": null, "num_offline_eval_runners": 0, "offline_loss_for_module_fn": null, "offline_evaluation_duration": 1, "offline_evaluation_parallel_to_training": false, "offline_evaluation_timeout_s": 120.0, "num_cpus_per_offline_eval_runner": 1, "num_gpus_per_offline_eval_runner": 0, "custom_resources_per_offline_eval_runner": {}, "restart_failed_offline_eval_runners": true, "ignore_offline_eval_runner_failures": false, "max_num_offline_eval_runner_restarts": 1000, "offline_eval_runner_restore_timeout_s": 1800.0, "max_requests_in_flight_per_offline_eval_runner": 1, "validate_offline_eval_runners_after_construction": true, "offline_eval_runner_health_probe_timeout_s": 30.0, "offline_eval_rl_module_inference_only": false, "broadcast_offline_eval_runner_states": false, "offline_eval_batch_size_per_runner": 256, "dataset_num_iters_per_eval_runner": 1, "keep_per_episode_custom_metrics": false, "metrics_episode_collection_timeout_s": 60.0, "metrics_num_episodes_for_smoothing": 100, "min_time_s_per_iteration": null, "min_train_timesteps_per_iteration": 0, "min_sample_timesteps_per_iteration": 0, "log_gradients": true, "export_native_model_files": false, "checkpoint_trainable_policies_only": false, "logger_creator": null, "logger_config": null, "log_level": "WARN", "log_sys_usage": true, "fake_sampler": false, "seed": 9, "restart_failed_env_runners": true, "ignore_env_runner_failures": false, "max_num_env_runner_restarts": 1000, "delay_between_env_runner_restarts_s": 60.0, "restart_failed_sub_environments": false, "num_consecutive_env_runner_failures_tolerance": 100, "env_runner_health_probe_timeout_s": 30.0, "env_runner_restore_timeout_s": 1800.0, "_model_config": {}, "_rl_module_spec": "RLModuleSpec(module_class=None, observation_space=None, action_space=None, inference_only=False, learner_only=False, model_config=DefaultModelConfig(fcnet_hiddens=[60, 90], fcnet_activation='tanh', fcnet_kernel_initializer=None, fcnet_kernel_initializer_kwargs=None, fcnet_bias_initializer=None, fcnet_bias_initializer_kwargs=None, conv_filters=None, conv_activation='relu', conv_kernel_initializer=None, conv_kernel_initializer_kwargs=None, conv_bias_initializer=None, conv_bias_initializer_kwargs=None, head_fcnet_hiddens=[], head_fcnet_activation='relu', head_fcnet_kernel_initializer=None, head_fcnet_kernel_initializer_kwargs=None, head_fcnet_bias_initializer=None, head_fcnet_bias_initializer_kwargs=None, free_log_std=False, log_std_clip_param=20.0, vf_share_layers=True, use_lstm=False, max_seq_len=20, lstm_cell_size=256, lstm_use_prev_action=False, lstm_use_prev_reward=False, lstm_kernel_initializer=None, lstm_kernel_initializer_kwargs=None, lstm_bias_initializer=None, lstm_bias_initializer_kwargs=None), catalog_class=None, load_state_path=None, model_config_dict=None)", "algorithm_config_overrides_per_module": {}, "_per_module_overrides": {}, "_validate_config": true, "_use_msgpack_checkpoints": false, "_torch_grad_scaler_class": null, "_torch_lr_scheduler_classes": null, "_tf_policy_handles_more_than_one_loss": false, "_disable_preprocessor_api": false, "_disable_action_flattening": false, "_disable_initialize_loss_from_dummy_batch": false, "_dont_auto_sync_env_runner_states": false, "env_task_fn": -1, "enable_connectors": -1, "simple_optimizer": false, "policy_map_cache": -1, "worker_cls": -1, "synchronize_filters": -1, "enable_async_evaluation": -1, "custom_async_evaluation_function": -1, "_enable_rl_module_api": -1, "auto_wrap_old_gym_envs": -1, "always_attach_evaluation_results": -1, "replay_sequence_length": null, "_disable_execution_plan_api": -1, "use_critic": true, "use_gae": true, "use_kl_loss": true, "kl_coeff": 0.7464963036515, "kl_target": 0.0270990929592, "vf_loss_coeff": 0.6688075857018, "entropy_coeff": 0.0090570820258, "clip_param": 0.1221781641624, "vf_clip_param": 0.1027808522125, "entropy_coeff_schedule": null, "lr_schedule": null, "sgd_minibatch_size": -1, "vf_share_layers": -1, "__stdout_file__": null, "__stderr_file__": null, "lambda": 0.9099046732075, "input": "sampler", "policies": {"default_policy": [null, null, null, null]}, "callbacks": "<class 'ray.rllib.callbacks.callbacks.RLlibCallback'>", "create_env_on_driver": false, "custom_eval_function": null, "framework": "torch"}, "time_since_restore": 21.421238899230957, "iterations_since_restore": 1, "perf": {"cpu_util_percent": 93.32, "ram_util_percent": 83.18333333333332}}
{"timers": {"training_iteration": 19.28539129962679, "restore_env_runners": 3.5422123037278656e-05, "training_step": 19.284531867410987, "env_runner_sampling_timer": 18.090705354880775, "learner_update_timer": 1.1248566233250312, "synch_weights": 0.04548063959926366, "restore_eval_env_runners": 0.0002833330072462559, "evaluation_iteration": 2.071971708908677, "synch_eval_env_connectors": 0.001509708003140986, "synch_env_connectors": 2.7417088858783245e-05}, "env_runners": {"module_to_env_connector": {"timers": {"connectors": {"un_batch_to_individual_items": 0.0001637130332725934, "tensor_to_numpy": 0.00015730908337415205, "normalize_and_clip_actions": 7.825969749502629e-05, "remove_single_ts_time_rank_from_batch": 4.149728638327162e-06, "listify_data_for_vector_env": 8.146798007408032e-05, "get_actions": 0.00048793616531749056}}, "connector_pipeline_timer": 0.0011708606851239104}, "time_between_sampling": 0.018837976355328453, "episode_len_max": 20, "num_env_steps_sampled_lifetime": 10000.0, "env_to_module_sum_episodes_length_in": 10.36823839457432, "sample": 0.06032785885817606, "num_agent_steps_sampled_lifetime": {"default_agent": 10000.0}, "episode_len_mean": 20.0, "rlmodule_inference_timer": 0.0003306297084082996, "num_episodes_lifetime": 500.0, "num_module_steps_sampled": {"default_policy": 5000.0}, "env_to_module_connector": {"connector_pipeline_timer": 0.0003642000816251395, "timers": {"connectors": {"add_states_from_episodes_to_batch": 7.275054591598325e-06, "batch_individual_items": 7.85701525171435e-05, "add_observations_from_episodes_to_batch": 2.395071066939729e-05, "add_time_dim_to_batch_and_zero_pad": 1.6682380940613862e-05, "numpy_to_tensor": 9.416495475401015e-05}}}, "module_episode_returns_mean": {"default_policy": 4.5}, "num_agent_steps_sampled": {"default_agent": 5000.0}, "num_episodes": 250.0, "episode_len_min": 20, "env_to_module_sum_episodes_length_out": 10.36823839457432, "num_module_steps_sampled_lifetime": {"default_policy": 10000.0}, "env_reset_timer": 0.0008046119541191983, "episode_duration_sec_mean": 0.04820494988281279, "episode_return_max": 14.5, "weights_seq_no": 1.0, "env_step_timer": 0.0001422199893317059, "episode_return_min": -5.5, "agent_episode_returns_mean": {"default_agent": 4.5}, "num_env_steps_sampled": 5000.0, "episode_return_mean": 4.5, "num_env_steps_sampled_lifetime_throughput": 793.9913291612}, "learners": {"__all_modules__": {"num_non_trainable_parameters": 0, "learner_connector": {"timers": {"connectors": {"add_time_dim_to_batch_and_zero_pad": 0.00016990531701594592, "numpy_to_tensor": 0.00013981284573674201, "general_advantage_estimation": 0.060415406661340966, "add_states_from_episodes_to_batch": 6.432257359847427e-06, "add_one_ts_to_episodes_and_truncate": 0.11523124694242141, "batch_individual_items": 0.3563522855693009, "add_observations_from_episodes_to_batch": 0.00443925041356124, "add_columns_from_episodes_to_train_batch": 0.34163786593475376}}, "connector_pipeline_timer": 0.8790378741268069}, "learner_connector_sum_episodes_length_in": 5000.0, "num_module_steps_trained": 6000, "num_module_steps_trained_lifetime": 12000, "num_env_steps_trained": 31500, "learner_connector_sum_episodes_length_out": 5250.0, "num_trainable_parameters": 6003, "num_env_steps_trained_lifetime": 63000, "num_env_steps_trained_lifetime_throughput": 467361.14126968745, "num_module_steps_trained_throughput": 89358.8499109801, "num_module_steps_trained_lifetime_throughput": 89239.79870823637}, "default_policy": {"module_train_batch_size_mean": 1000.0, "mean_kl_loss": 0.0011109872721135616, "curr_entropy_coeff": 0.0090570820258, "weights_seq_no": 2.0, "num_module_steps_trained": 6000, "curr_kl_coeff": 0.18662407994270325, "diff_num_grad_updates_vs_sampler_policy": 1.0, "num_module_steps_trained_lifetime": 12000, "vf_loss": 0.09875519573688507, "gradients_default_optimizer_global_norm": 0.04752764850854874, "total_loss": -0.019843995571136475, "policy_loss": -0.08004441857337952, "num_trainable_parameters": 6003, "default_optimizer_learning_rate": 0.0002847858517, "vf_explained_var": 7.56978988647461e-05, "entropy": 0.691445529460907, "vf_loss_unclipped": 32.4010124206543, "num_module_steps_trained_lifetime_throughput": 89519.69150651348}}, "num_training_step_calls_per_iteration": 1, "evaluation": {"env_runners": {"module_to_env_connector": {"connector_pipeline_timer": 0.0006810987971085332, "timers": {"connectors": {"remove_single_ts_time_rank_from_batch": 3.141615244601753e-06, "normalize_and_clip_actions": 5.928571988468718e-05, "tensor_to_numpy": 0.00010988062581176741, "listify_data_for_vector_env": 6.384956779655499e-05, "un_batch_to_individual_items": 1.9882642001667323e-05, "get_actions": 0.00025161347970878103}}}, "env_to_module_connector": {"timers": {"connectors": {"numpy_to_tensor": 4.487925102876594e-05, "add_states_from_episodes_to_batch": 4.443052796619825e-06, "batch_individual_items": 3.720819438714595e-05, "add_observations_from_episodes_to_batch": 1.110819007286987e-05, "add_time_dim_to_batch_and_zero_pad": 8.964686305666599e-06}}, "connector_pipeline_timer": 0.00021805333085113176}, "num_episodes": 20, "num_env_steps_sampled": 400, "num_env_steps_sampled_lifetime": 10400, "episode_len_mean": 20.0, "num_module_steps_sampled": {"default_policy": 400}, "episode_return_max": 15.5, "weights_seq_no": 2.0, "episode_len_max": 20, "num_agent_steps_sampled_lifetime": {"default_agent": 800}, "sample": 1.8909451900573913, "module_episode_returns_mean": {"default_policy": -0.3}, "num_agent_steps_sampled": {"default_agent": 400}, "agent_episode_returns_mean": {"default_agent": -0.3}, "rlmodule_inference_timer": 0.00018585140952031464, "num_episodes_lifetime": 40, "num_module_steps_sampled_lifetime": {"default_policy": 800}, "episode_len_min": 20, "env_to_module_sum_episodes_length_out": 10.366003441359926, "env_reset_timer": 0.01880954430787824, "episode_duration_sec_mean": 0.05994821558124386, "env_step_timer": 0.00011422259233720822, "episode_return_min": -12.5, "episode_return_mean": -0.3, "env_to_module_sum_episodes_length_in": 10.366003441359926, "time_between_sampling": 14.883871707948856}, "num_healthy_workers": 1, "actor_manager_num_outstanding_async_reqs": 0, "num_remote_worker_restarts": 0}, "num_env_steps_sampled_lifetime": 10000.0, "fault_tolerance": {"num_healthy_workers": 0, "num_remote_worker_restarts": 0}, "env_runner_group": {"actor_manager_num_outstanding_async_reqs": 0}, "done": false, "training_iteration": 2, "trial_id": "497a0_00000", "date": "2025-08-11_19-28-30", "timestamp": 1754933310, "time_this_iter_s": 15.246729850769043, "time_total_s": 36.66796875, "pid": 19607, "hostname": "Mac", "node_ip": "127.0.0.1", "config": {"exploration_config": {}, "extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "placement_strategy": "PACK", "num_gpus": 0, "_fake_gpus": false, "num_cpus_for_main_process": 2, "eager_tracing": true, "eager_max_retraces": 20, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "torch_compile_learner": false, "torch_compile_learner_what_to_compile": "forward_train", "torch_compile_learner_dynamo_backend": "aot_eager", "torch_compile_learner_dynamo_mode": null, "torch_compile_worker": false, "torch_compile_worker_dynamo_backend": "aot_eager", "torch_compile_worker_dynamo_mode": null, "torch_ddp_kwargs": {}, "torch_skip_nan_gradients": false, "env": "Umbrella", "env_config": {}, "observation_space": null, "action_space": null, "clip_rewards": null, "normalize_actions": true, "clip_actions": false, "_is_atari": null, "disable_env_checking": false, "render_env": false, "action_mask_key": "action_mask", "env_runner_cls": null, "num_env_runners": 0, "create_local_env_runner": true, "num_envs_per_env_runner": 1, "gym_env_vectorize_mode": "SYNC", "num_cpus_per_env_runner": 1, "num_gpus_per_env_runner": 0, "custom_resources_per_env_runner": {}, "validate_env_runners_after_construction": true, "episodes_to_numpy": true, "max_requests_in_flight_per_env_runner": 1, "sample_timeout_s": 60.0, "_env_to_module_connector": null, "add_default_connectors_to_env_to_module_pipeline": true, "_module_to_env_connector": null, "add_default_connectors_to_module_to_env_pipeline": true, "merge_env_runner_states": "training_only", "broadcast_env_runner_states": true, "episode_lookback_horizon": 1, "rollout_fragment_length": "auto", "batch_mode": "complete_episodes", "compress_observations": false, "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "enable_tf1_exec_eagerly": false, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "preprocessor_pref": "deepmind", "observation_filter": "NoFilter", "update_worker_filter_stats": true, "use_worker_filter_stats": true, "sampler_perf_stats_ema_coef": null, "_is_online": true, "num_learners": 0, "num_gpus_per_learner": 0, "num_cpus_per_learner": "auto", "num_aggregator_actors_per_learner": 0, "max_requests_in_flight_per_aggregator_actor": 3, "local_gpu_idx": 0, "max_requests_in_flight_per_learner": 3, "gamma": 1, "lr": 0.0002847858517, "grad_clip": 0.5, "grad_clip_by": "global_norm", "_train_batch_size_per_learner": 5000, "train_batch_size": 4000, "num_epochs": 1, "minibatch_size": 1000, "shuffle_batch_per_epoch": true, "model": {"fcnet_hiddens": [256, 256], "fcnet_activation": "tanh", "fcnet_weights_initializer": null, "fcnet_weights_initializer_config": null, "fcnet_bias_initializer": null, "fcnet_bias_initializer_config": null, "conv_filters": null, "conv_activation": "relu", "conv_kernel_initializer": null, "conv_kernel_initializer_config": null, "conv_bias_initializer": null, "conv_bias_initializer_config": null, "conv_transpose_kernel_initializer": null, "conv_transpose_kernel_initializer_config": null, "conv_transpose_bias_initializer": null, "conv_transpose_bias_initializer_config": null, "post_fcnet_hiddens": [], "post_fcnet_activation": "relu", "post_fcnet_weights_initializer": null, "post_fcnet_weights_initializer_config": null, "post_fcnet_bias_initializer": null, "post_fcnet_bias_initializer_config": null, "free_log_std": false, "log_std_clip_param": 20.0, "no_final_linear": false, "vf_share_layers": false, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "lstm_weights_initializer": null, "lstm_weights_initializer_config": null, "lstm_bias_initializer": null, "lstm_bias_initializer_config": null, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "attention_use_n_prev_actions": 0, "attention_use_n_prev_rewards": 0, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": null, "custom_model_config": {}, "custom_action_dist": null, "custom_preprocessor": null, "encoder_latent_dim": null, "always_check_shapes": false, "lstm_use_prev_action_reward": -1, "_use_default_native_models": -1, "_disable_preprocessor_api": false, "_disable_action_flattening": false}, "_learner_connector": null, "add_default_connectors_to_learner_pipeline": true, "learner_config_dict": {}, "optimizer": {}, "_learner_class": null, "callbacks_on_algorithm_init": null, "callbacks_on_env_runners_recreated": null, "callbacks_on_offline_eval_runners_recreated": null, "callbacks_on_checkpoint_loaded": null, "callbacks_on_environment_created": null, "callbacks_on_episode_created": null, "callbacks_on_episode_start": null, "callbacks_on_episode_step": null, "callbacks_on_episode_end": null, "callbacks_on_evaluate_start": null, "callbacks_on_evaluate_end": null, "callbacks_on_evaluate_offline_start": null, "callbacks_on_evaluate_offline_end": null, "callbacks_on_sample_end": null, "callbacks_on_train_result": null, "explore": true, "enable_rl_module_and_learner": true, "enable_env_runner_and_connector_v2": true, "_prior_exploration_config": {"type": "StochasticSampling"}, "count_steps_by": "env_steps", "policy_map_capacity": 100, "policy_mapping_fn": "<function AlgorithmConfig.DEFAULT_POLICY_MAPPING_FN at 0x3862edb20>", "policies_to_train": null, "policy_states_are_swappable": false, "observation_fn": null, "offline_data_class": null, "input_read_method": "read_parquet", "input_read_method_kwargs": {}, "input_read_schema": {}, "input_read_episodes": false, "input_read_sample_batches": false, "input_read_batch_size": null, "input_filesystem": null, "input_filesystem_kwargs": {}, "input_compress_columns": ["obs", "new_obs"], "input_spaces_jsonable": true, "materialize_data": false, "materialize_mapped_data": true, "map_batches_kwargs": {}, "iter_batches_kwargs": {}, "ignore_final_observation": false, "prelearner_class": null, "prelearner_buffer_class": null, "prelearner_buffer_kwargs": {}, "prelearner_module_synch_period": 10, "dataset_num_iters_per_learner": null, "input_config": {}, "actions_in_input_normalized": false, "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_config": {}, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "output_max_rows_per_file": null, "output_write_remaining_data": false, "output_write_method": "write_parquet", "output_write_method_kwargs": {}, "output_filesystem": null, "output_filesystem_kwargs": {}, "output_write_episodes": true, "offline_sampling": false, "evaluation_interval": 1, "evaluation_duration": 20, "evaluation_duration_unit": "episodes", "evaluation_sample_timeout_s": 120.0, "evaluation_auto_duration_min_env_steps_per_sample": 100, "evaluation_auto_duration_max_env_steps_per_sample": 2000, "evaluation_parallel_to_training": false, "evaluation_force_reset_envs_before_iteration": true, "evaluation_config": null, "off_policy_estimation_methods": {}, "ope_split_batch_by_episode": true, "evaluation_num_env_runners": 1, "in_evaluation": false, "sync_filters_on_rollout_workers_timeout_s": 10.0, "offline_evaluation_interval": null, "num_offline_eval_runners": 0, "offline_loss_for_module_fn": null, "offline_evaluation_duration": 1, "offline_evaluation_parallel_to_training": false, "offline_evaluation_timeout_s": 120.0, "num_cpus_per_offline_eval_runner": 1, "num_gpus_per_offline_eval_runner": 0, "custom_resources_per_offline_eval_runner": {}, "restart_failed_offline_eval_runners": true, "ignore_offline_eval_runner_failures": false, "max_num_offline_eval_runner_restarts": 1000, "offline_eval_runner_restore_timeout_s": 1800.0, "max_requests_in_flight_per_offline_eval_runner": 1, "validate_offline_eval_runners_after_construction": true, "offline_eval_runner_health_probe_timeout_s": 30.0, "offline_eval_rl_module_inference_only": false, "broadcast_offline_eval_runner_states": false, "offline_eval_batch_size_per_runner": 256, "dataset_num_iters_per_eval_runner": 1, "keep_per_episode_custom_metrics": false, "metrics_episode_collection_timeout_s": 60.0, "metrics_num_episodes_for_smoothing": 100, "min_time_s_per_iteration": null, "min_train_timesteps_per_iteration": 0, "min_sample_timesteps_per_iteration": 0, "log_gradients": true, "export_native_model_files": false, "checkpoint_trainable_policies_only": false, "logger_creator": null, "logger_config": null, "log_level": "WARN", "log_sys_usage": true, "fake_sampler": false, "seed": 9, "restart_failed_env_runners": true, "ignore_env_runner_failures": false, "max_num_env_runner_restarts": 1000, "delay_between_env_runner_restarts_s": 60.0, "restart_failed_sub_environments": false, "num_consecutive_env_runner_failures_tolerance": 100, "env_runner_health_probe_timeout_s": 30.0, "env_runner_restore_timeout_s": 1800.0, "_model_config": {}, "_rl_module_spec": "RLModuleSpec(module_class=None, observation_space=None, action_space=None, inference_only=False, learner_only=False, model_config=DefaultModelConfig(fcnet_hiddens=[60, 90], fcnet_activation='tanh', fcnet_kernel_initializer=None, fcnet_kernel_initializer_kwargs=None, fcnet_bias_initializer=None, fcnet_bias_initializer_kwargs=None, conv_filters=None, conv_activation='relu', conv_kernel_initializer=None, conv_kernel_initializer_kwargs=None, conv_bias_initializer=None, conv_bias_initializer_kwargs=None, head_fcnet_hiddens=[], head_fcnet_activation='relu', head_fcnet_kernel_initializer=None, head_fcnet_kernel_initializer_kwargs=None, head_fcnet_bias_initializer=None, head_fcnet_bias_initializer_kwargs=None, free_log_std=False, log_std_clip_param=20.0, vf_share_layers=True, use_lstm=False, max_seq_len=20, lstm_cell_size=256, lstm_use_prev_action=False, lstm_use_prev_reward=False, lstm_kernel_initializer=None, lstm_kernel_initializer_kwargs=None, lstm_bias_initializer=None, lstm_bias_initializer_kwargs=None), catalog_class=None, load_state_path=None, model_config_dict=None)", "algorithm_config_overrides_per_module": {}, "_per_module_overrides": {}, "_validate_config": true, "_use_msgpack_checkpoints": false, "_torch_grad_scaler_class": null, "_torch_lr_scheduler_classes": null, "_tf_policy_handles_more_than_one_loss": false, "_disable_preprocessor_api": false, "_disable_action_flattening": false, "_disable_initialize_loss_from_dummy_batch": false, "_dont_auto_sync_env_runner_states": false, "env_task_fn": -1, "enable_connectors": -1, "simple_optimizer": false, "policy_map_cache": -1, "worker_cls": -1, "synchronize_filters": -1, "enable_async_evaluation": -1, "custom_async_evaluation_function": -1, "_enable_rl_module_api": -1, "auto_wrap_old_gym_envs": -1, "always_attach_evaluation_results": -1, "replay_sequence_length": null, "_disable_execution_plan_api": -1, "use_critic": true, "use_gae": true, "use_kl_loss": true, "kl_coeff": 0.7464963036515, "kl_target": 0.0270990929592, "vf_loss_coeff": 0.6688075857018, "entropy_coeff": 0.0090570820258, "clip_param": 0.1221781641624, "vf_clip_param": 0.1027808522125, "entropy_coeff_schedule": null, "lr_schedule": null, "sgd_minibatch_size": -1, "vf_share_layers": -1, "__stdout_file__": null, "__stderr_file__": null, "lambda": 0.9099046732075, "input": "sampler", "policies": {"default_policy": [null, null, null, null]}, "callbacks": "<class 'ray.rllib.callbacks.callbacks.RLlibCallback'>", "create_env_on_driver": false, "custom_eval_function": null, "framework": "torch"}, "time_since_restore": 36.66796875, "iterations_since_restore": 2, "perf": {"cpu_util_percent": 99.72857142857144, "ram_util_percent": 82.59047619047621}}
{"timers": {"training_iteration": 19.177242039130164, "restore_env_runners": 3.523831171914936e-05, "training_step": 19.17638189248694, "env_runner_sampling_timer": 17.99162837674193, "learner_update_timer": 1.1162717225126224, "synch_weights": 0.04504856862318701, "restore_eval_env_runners": 0.00028073133784346283, "evaluation_iteration": 2.0581423184904266, "synch_eval_env_connectors": 0.0015138392627704889, "synch_env_connectors": 2.722250879742205e-05}, "env_runners": {"module_to_env_connector": {"timers": {"connectors": {"un_batch_to_individual_items": 2.460422143197735e-05, "tensor_to_numpy": 8.51274821177615e-05, "normalize_and_clip_actions": 5.295435639411179e-05, "remove_single_ts_time_rank_from_batch": 2.729860165527159e-06, "listify_data_for_vector_env": 5.674065097583723e-05, "get_actions": 0.00030198597984869096}}, "connector_pipeline_timer": 0.0006439962234659947}, "time_between_sampling": 0.010300807315748227, "episode_len_max": 20, "num_env_steps_sampled_lifetime": -607500.0, "env_to_module_sum_episodes_length_in": 10.36823839457432, "sample": 0.03715018230950538, "num_agent_steps_sampled_lifetime": {"default_agent": -607500.0}, "episode_len_mean": 20.0, "rlmodule_inference_timer": 0.00023404226999496324, "num_episodes_lifetime": -30375.0, "num_module_steps_sampled": {"default_policy": 5000.0}, "env_to_module_connector": {"connector_pipeline_timer": 0.0002304296535750801, "timers": {"connectors": {"add_states_from_episodes_to_batch": 1.3370587487209026e-05, "batch_individual_items": 3.9571101939504775e-05, "add_observations_from_episodes_to_batch": 1.9754035847253847e-05, "add_time_dim_to_batch_and_zero_pad": 1.1221276318345749e-05, "numpy_to_tensor": 5.570616564495684e-05}}}, "module_episode_returns_mean": {"default_policy": 5.460000000000001}, "num_agent_steps_sampled": {"default_agent": 5000.0}, "num_episodes": 250.0, "episode_len_min": 20, "env_to_module_sum_episodes_length_out": 10.36823839457432, "num_module_steps_sampled_lifetime": {"default_policy": -607500.0}, "env_reset_timer": 0.00043171693539381016, "episode_duration_sec_mean": 0.028522500871680682, "episode_return_max": 14.5, "weights_seq_no": 2.0, "env_step_timer": 9.74951405487466e-05, "episode_return_min": -5.5, "agent_episode_returns_mean": {"default_agent": 5.460000000000001}, "num_env_steps_sampled": 5000.0, "episode_return_mean": 5.460000000000001, "num_env_steps_sampled_lifetime_throughput": 1009.1658586803387}, "learners": {"__all_modules__": {"num_non_trainable_parameters": 0, "learner_connector": {"timers": {"connectors": {"add_time_dim_to_batch_and_zero_pad": 0.00016968793403357267, "numpy_to_tensor": 0.00013931846688501536, "general_advantage_estimation": 0.05990292176421499, "add_states_from_episodes_to_batch": 6.585434696171433e-06, "add_one_ts_to_episodes_and_truncate": 0.1142760994737153, "batch_individual_items": 0.35332837646390547, "add_observations_from_episodes_to_batch": 0.004413544579071459, "add_columns_from_episodes_to_train_batch": 0.3391214422747376}}, "connector_pipeline_timer": 0.8719994820449036}, "learner_connector_sum_episodes_length_in": 5000.0, "num_module_steps_trained": 6000, "num_module_steps_trained_lifetime": 18000, "num_env_steps_trained": 31500, "learner_connector_sum_episodes_length_out": 5250.0, "num_trainable_parameters": 6003, "num_env_steps_trained_lifetime": 94500, "num_env_steps_trained_lifetime_throughput": 465098.65530854545, "num_module_steps_trained_throughput": 88918.64130714939, "num_module_steps_trained_lifetime_throughput": 88801.6107345873}, "default_policy": {"module_train_batch_size_mean": 1000.0, "mean_kl_loss": 0.0013817347353324294, "curr_entropy_coeff": 0.0090570820258, "weights_seq_no": 3.0, "num_module_steps_trained": 6000, "curr_kl_coeff": 0.09331203997135162, "diff_num_grad_updates_vs_sampler_policy": 1.0, "num_module_steps_trained_lifetime": 18000, "vf_loss": 0.09795084595680237, "gradients_default_optimizer_global_norm": 0.1847822666168213, "total_loss": 0.24234046041965485, "policy_loss": 0.1828346997499466, "num_trainable_parameters": 6003, "default_optimizer_learning_rate": 0.0002847858517, "vf_explained_var": 0.0010613203048706055, "entropy": 0.6914345622062683, "vf_loss_unclipped": 30.6032657623291, "num_module_steps_trained_lifetime_throughput": 89072.49583861315}}, "num_training_step_calls_per_iteration": 1, "evaluation": {"env_runners": {"module_to_env_connector": {"connector_pipeline_timer": 0.000499756878264081, "timers": {"connectors": {"remove_single_ts_time_rank_from_batch": 2.2761175500733823e-06, "normalize_and_clip_actions": 3.302930109124741e-05, "tensor_to_numpy": 5.8466426454281026e-05, "listify_data_for_vector_env": 3.7454857993040884e-05, "un_batch_to_individual_items": 1.5209958097627112e-05, "get_actions": 0.00025655044184039427}}}, "env_to_module_connector": {"timers": {"connectors": {"numpy_to_tensor": 4.3201411997538314e-05, "add_states_from_episodes_to_batch": 4.375584693640609e-06, "batch_individual_items": 5.204358442988547e-05, "add_observations_from_episodes_to_batch": 1.421014911673376e-05, "add_time_dim_to_batch_and_zero_pad": 8.332727528972187e-06}}, "connector_pipeline_timer": 0.00019484268743308458}, "num_episodes": 20, "num_env_steps_sampled": 400, "num_env_steps_sampled_lifetime": 15400, "episode_len_mean": 20.0, "num_module_steps_sampled": {"default_policy": 400}, "episode_return_max": 15.5, "weights_seq_no": 3.0, "episode_len_max": 20, "num_agent_steps_sampled_lifetime": {"default_agent": 1200}, "sample": 1.8756160977358813, "module_episode_returns_mean": {"default_policy": -0.9666666666666667}, "num_agent_steps_sampled": {"default_agent": 400}, "agent_episode_returns_mean": {"default_agent": -0.9666666666666667}, "rlmodule_inference_timer": 0.00016566602563983826, "num_episodes_lifetime": 60, "num_module_steps_sampled_lifetime": {"default_policy": 1200}, "episode_len_min": 20, "env_to_module_sum_episodes_length_out": 10.368205581254823, "env_reset_timer": 0.018622937204421035, "episode_duration_sec_mean": 0.045461496518692, "env_step_timer": 6.107291786809739e-05, "episode_return_min": -13.5, "episode_return_mean": -0.9666666666666667, "env_to_module_sum_episodes_length_in": 10.368205581254823, "time_between_sampling": 14.820900802118704}, "num_healthy_workers": 1, "actor_manager_num_outstanding_async_reqs": 0, "num_remote_worker_restarts": 0}, "num_env_steps_sampled_lifetime": -607500.0, "fault_tolerance": {"num_healthy_workers": 0, "num_remote_worker_restarts": 0}, "env_runner_group": {"actor_manager_num_outstanding_async_reqs": 0}, "done": false, "training_iteration": 3, "trial_id": "497a0_00000", "date": "2025-08-11_19-28-39", "timestamp": 1754933319, "time_this_iter_s": 8.861876964569092, "time_total_s": 45.52984571456909, "pid": 19607, "hostname": "Mac", "node_ip": "127.0.0.1", "config": {"exploration_config": {}, "extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "placement_strategy": "PACK", "num_gpus": 0, "_fake_gpus": false, "num_cpus_for_main_process": 2, "eager_tracing": true, "eager_max_retraces": 20, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "torch_compile_learner": false, "torch_compile_learner_what_to_compile": "forward_train", "torch_compile_learner_dynamo_backend": "aot_eager", "torch_compile_learner_dynamo_mode": null, "torch_compile_worker": false, "torch_compile_worker_dynamo_backend": "aot_eager", "torch_compile_worker_dynamo_mode": null, "torch_ddp_kwargs": {}, "torch_skip_nan_gradients": false, "env": "Umbrella", "env_config": {}, "observation_space": null, "action_space": null, "clip_rewards": null, "normalize_actions": true, "clip_actions": false, "_is_atari": null, "disable_env_checking": false, "render_env": false, "action_mask_key": "action_mask", "env_runner_cls": null, "num_env_runners": 0, "create_local_env_runner": true, "num_envs_per_env_runner": 1, "gym_env_vectorize_mode": "SYNC", "num_cpus_per_env_runner": 1, "num_gpus_per_env_runner": 0, "custom_resources_per_env_runner": {}, "validate_env_runners_after_construction": true, "episodes_to_numpy": true, "max_requests_in_flight_per_env_runner": 1, "sample_timeout_s": 60.0, "_env_to_module_connector": null, "add_default_connectors_to_env_to_module_pipeline": true, "_module_to_env_connector": null, "add_default_connectors_to_module_to_env_pipeline": true, "merge_env_runner_states": "training_only", "broadcast_env_runner_states": true, "episode_lookback_horizon": 1, "rollout_fragment_length": "auto", "batch_mode": "complete_episodes", "compress_observations": false, "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "enable_tf1_exec_eagerly": false, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "preprocessor_pref": "deepmind", "observation_filter": "NoFilter", "update_worker_filter_stats": true, "use_worker_filter_stats": true, "sampler_perf_stats_ema_coef": null, "_is_online": true, "num_learners": 0, "num_gpus_per_learner": 0, "num_cpus_per_learner": "auto", "num_aggregator_actors_per_learner": 0, "max_requests_in_flight_per_aggregator_actor": 3, "local_gpu_idx": 0, "max_requests_in_flight_per_learner": 3, "gamma": 1, "lr": 0.0002847858517, "grad_clip": 0.5, "grad_clip_by": "global_norm", "_train_batch_size_per_learner": 5000, "train_batch_size": 4000, "num_epochs": 1, "minibatch_size": 1000, "shuffle_batch_per_epoch": true, "model": {"fcnet_hiddens": [256, 256], "fcnet_activation": "tanh", "fcnet_weights_initializer": null, "fcnet_weights_initializer_config": null, "fcnet_bias_initializer": null, "fcnet_bias_initializer_config": null, "conv_filters": null, "conv_activation": "relu", "conv_kernel_initializer": null, "conv_kernel_initializer_config": null, "conv_bias_initializer": null, "conv_bias_initializer_config": null, "conv_transpose_kernel_initializer": null, "conv_transpose_kernel_initializer_config": null, "conv_transpose_bias_initializer": null, "conv_transpose_bias_initializer_config": null, "post_fcnet_hiddens": [], "post_fcnet_activation": "relu", "post_fcnet_weights_initializer": null, "post_fcnet_weights_initializer_config": null, "post_fcnet_bias_initializer": null, "post_fcnet_bias_initializer_config": null, "free_log_std": false, "log_std_clip_param": 20.0, "no_final_linear": false, "vf_share_layers": false, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "lstm_weights_initializer": null, "lstm_weights_initializer_config": null, "lstm_bias_initializer": null, "lstm_bias_initializer_config": null, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "attention_use_n_prev_actions": 0, "attention_use_n_prev_rewards": 0, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": null, "custom_model_config": {}, "custom_action_dist": null, "custom_preprocessor": null, "encoder_latent_dim": null, "always_check_shapes": false, "lstm_use_prev_action_reward": -1, "_use_default_native_models": -1, "_disable_preprocessor_api": false, "_disable_action_flattening": false}, "_learner_connector": null, "add_default_connectors_to_learner_pipeline": true, "learner_config_dict": {}, "optimizer": {}, "_learner_class": null, "callbacks_on_algorithm_init": null, "callbacks_on_env_runners_recreated": null, "callbacks_on_offline_eval_runners_recreated": null, "callbacks_on_checkpoint_loaded": null, "callbacks_on_environment_created": null, "callbacks_on_episode_created": null, "callbacks_on_episode_start": null, "callbacks_on_episode_step": null, "callbacks_on_episode_end": null, "callbacks_on_evaluate_start": null, "callbacks_on_evaluate_end": null, "callbacks_on_evaluate_offline_start": null, "callbacks_on_evaluate_offline_end": null, "callbacks_on_sample_end": null, "callbacks_on_train_result": null, "explore": true, "enable_rl_module_and_learner": true, "enable_env_runner_and_connector_v2": true, "_prior_exploration_config": {"type": "StochasticSampling"}, "count_steps_by": "env_steps", "policy_map_capacity": 100, "policy_mapping_fn": "<function AlgorithmConfig.DEFAULT_POLICY_MAPPING_FN at 0x3862edb20>", "policies_to_train": null, "policy_states_are_swappable": false, "observation_fn": null, "offline_data_class": null, "input_read_method": "read_parquet", "input_read_method_kwargs": {}, "input_read_schema": {}, "input_read_episodes": false, "input_read_sample_batches": false, "input_read_batch_size": null, "input_filesystem": null, "input_filesystem_kwargs": {}, "input_compress_columns": ["obs", "new_obs"], "input_spaces_jsonable": true, "materialize_data": false, "materialize_mapped_data": true, "map_batches_kwargs": {}, "iter_batches_kwargs": {}, "ignore_final_observation": false, "prelearner_class": null, "prelearner_buffer_class": null, "prelearner_buffer_kwargs": {}, "prelearner_module_synch_period": 10, "dataset_num_iters_per_learner": null, "input_config": {}, "actions_in_input_normalized": false, "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_config": {}, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "output_max_rows_per_file": null, "output_write_remaining_data": false, "output_write_method": "write_parquet", "output_write_method_kwargs": {}, "output_filesystem": null, "output_filesystem_kwargs": {}, "output_write_episodes": true, "offline_sampling": false, "evaluation_interval": 1, "evaluation_duration": 20, "evaluation_duration_unit": "episodes", "evaluation_sample_timeout_s": 120.0, "evaluation_auto_duration_min_env_steps_per_sample": 100, "evaluation_auto_duration_max_env_steps_per_sample": 2000, "evaluation_parallel_to_training": false, "evaluation_force_reset_envs_before_iteration": true, "evaluation_config": null, "off_policy_estimation_methods": {}, "ope_split_batch_by_episode": true, "evaluation_num_env_runners": 1, "in_evaluation": false, "sync_filters_on_rollout_workers_timeout_s": 10.0, "offline_evaluation_interval": null, "num_offline_eval_runners": 0, "offline_loss_for_module_fn": null, "offline_evaluation_duration": 1, "offline_evaluation_parallel_to_training": false, "offline_evaluation_timeout_s": 120.0, "num_cpus_per_offline_eval_runner": 1, "num_gpus_per_offline_eval_runner": 0, "custom_resources_per_offline_eval_runner": {}, "restart_failed_offline_eval_runners": true, "ignore_offline_eval_runner_failures": false, "max_num_offline_eval_runner_restarts": 1000, "offline_eval_runner_restore_timeout_s": 1800.0, "max_requests_in_flight_per_offline_eval_runner": 1, "validate_offline_eval_runners_after_construction": true, "offline_eval_runner_health_probe_timeout_s": 30.0, "offline_eval_rl_module_inference_only": false, "broadcast_offline_eval_runner_states": false, "offline_eval_batch_size_per_runner": 256, "dataset_num_iters_per_eval_runner": 1, "keep_per_episode_custom_metrics": false, "metrics_episode_collection_timeout_s": 60.0, "metrics_num_episodes_for_smoothing": 100, "min_time_s_per_iteration": null, "min_train_timesteps_per_iteration": 0, "min_sample_timesteps_per_iteration": 0, "log_gradients": true, "export_native_model_files": false, "checkpoint_trainable_policies_only": false, "logger_creator": null, "logger_config": null, "log_level": "WARN", "log_sys_usage": true, "fake_sampler": false, "seed": 9, "restart_failed_env_runners": true, "ignore_env_runner_failures": false, "max_num_env_runner_restarts": 1000, "delay_between_env_runner_restarts_s": 60.0, "restart_failed_sub_environments": false, "num_consecutive_env_runner_failures_tolerance": 100, "env_runner_health_probe_timeout_s": 30.0, "env_runner_restore_timeout_s": 1800.0, "_model_config": {}, "_rl_module_spec": "RLModuleSpec(module_class=None, observation_space=None, action_space=None, inference_only=False, learner_only=False, model_config=DefaultModelConfig(fcnet_hiddens=[60, 90], fcnet_activation='tanh', fcnet_kernel_initializer=None, fcnet_kernel_initializer_kwargs=None, fcnet_bias_initializer=None, fcnet_bias_initializer_kwargs=None, conv_filters=None, conv_activation='relu', conv_kernel_initializer=None, conv_kernel_initializer_kwargs=None, conv_bias_initializer=None, conv_bias_initializer_kwargs=None, head_fcnet_hiddens=[], head_fcnet_activation='relu', head_fcnet_kernel_initializer=None, head_fcnet_kernel_initializer_kwargs=None, head_fcnet_bias_initializer=None, head_fcnet_bias_initializer_kwargs=None, free_log_std=False, log_std_clip_param=20.0, vf_share_layers=True, use_lstm=False, max_seq_len=20, lstm_cell_size=256, lstm_use_prev_action=False, lstm_use_prev_reward=False, lstm_kernel_initializer=None, lstm_kernel_initializer_kwargs=None, lstm_bias_initializer=None, lstm_bias_initializer_kwargs=None), catalog_class=None, load_state_path=None, model_config_dict=None)", "algorithm_config_overrides_per_module": {}, "_per_module_overrides": {}, "_validate_config": true, "_use_msgpack_checkpoints": false, "_torch_grad_scaler_class": null, "_torch_lr_scheduler_classes": null, "_tf_policy_handles_more_than_one_loss": false, "_disable_preprocessor_api": false, "_disable_action_flattening": false, "_disable_initialize_loss_from_dummy_batch": false, "_dont_auto_sync_env_runner_states": false, "env_task_fn": -1, "enable_connectors": -1, "simple_optimizer": false, "policy_map_cache": -1, "worker_cls": -1, "synchronize_filters": -1, "enable_async_evaluation": -1, "custom_async_evaluation_function": -1, "_enable_rl_module_api": -1, "auto_wrap_old_gym_envs": -1, "always_attach_evaluation_results": -1, "replay_sequence_length": null, "_disable_execution_plan_api": -1, "use_critic": true, "use_gae": true, "use_kl_loss": true, "kl_coeff": 0.7464963036515, "kl_target": 0.0270990929592, "vf_loss_coeff": 0.6688075857018, "entropy_coeff": 0.0090570820258, "clip_param": 0.1221781641624, "vf_clip_param": 0.1027808522125, "entropy_coeff_schedule": null, "lr_schedule": null, "sgd_minibatch_size": -1, "vf_share_layers": -1, "__stdout_file__": null, "__stderr_file__": null, "lambda": 0.9099046732075, "input": "sampler", "policies": {"default_policy": [null, null, null, null]}, "callbacks": "<class 'ray.rllib.callbacks.callbacks.RLlibCallback'>", "create_env_on_driver": false, "custom_eval_function": null, "framework": "torch"}, "time_since_restore": 45.52984571456909, "iterations_since_restore": 3, "perf": {"cpu_util_percent": 90.375, "ram_util_percent": 79.21666666666665}}
{"timers": {"training_iteration": 19.035072799988555, "restore_env_runners": 3.506550854910166e-05, "training_step": 19.034216698561707, "env_runner_sampling_timer": 17.85937701422447, "learner_update_timer": 1.1070047590369094, "synch_weights": 0.04460522418690798, "restore_eval_env_runners": 0.0002787886142847128, "evaluation_iteration": 2.0414081365558547, "synch_eval_env_connectors": 0.001503021290700417, "synch_env_connectors": 2.7052363648544994e-05}, "env_runners": {"module_to_env_connector": {"timers": {"connectors": {"un_batch_to_individual_items": 1.7192807999085124e-05, "tensor_to_numpy": 4.365803551743394e-05, "normalize_and_clip_actions": 2.796520959736046e-05, "remove_single_ts_time_rank_from_batch": 1.4624577397609673e-06, "listify_data_for_vector_env": 3.666965456078713e-05, "get_actions": 0.00015729396669466393}}, "connector_pipeline_timer": 0.0003593281880954188}, "time_between_sampling": 0.006222153588150441, "episode_len_max": 20, "num_env_steps_sampled_lifetime": -1225000.0, "env_to_module_sum_episodes_length_in": 10.36823839457432, "sample": 0.02203979083025681, "num_agent_steps_sampled_lifetime": {"default_agent": -1225000.0}, "episode_len_mean": 20.0, "rlmodule_inference_timer": 0.00010381859565143833, "num_episodes_lifetime": -61250.0, "num_module_steps_sampled": {"default_policy": 5000.0}, "env_to_module_connector": {"connector_pipeline_timer": 0.00012779940598409424, "timers": {"connectors": {"add_states_from_episodes_to_batch": 4.258444972413872e-06, "batch_individual_items": 2.123510869343056e-05, "add_observations_from_episodes_to_batch": 9.568606931550826e-06, "add_time_dim_to_batch_and_zero_pad": 7.041482751134094e-06, "numpy_to_tensor": 3.486200612997106e-05}}}, "module_episode_returns_mean": {"default_policy": 5.940000000000001}, "num_agent_steps_sampled": {"default_agent": 5000.0}, "num_episodes": 250.0, "episode_len_min": 20, "env_to_module_sum_episodes_length_out": 10.36823839457432, "num_module_steps_sampled_lifetime": {"default_policy": -1225000.0}, "env_reset_timer": 0.00018533191870182908, "episode_duration_sec_mean": 0.015184253495186564, "episode_return_max": 14.5, "weights_seq_no": 3.0, "env_step_timer": 4.985391337126949e-05, "episode_return_min": -5.5, "agent_episode_returns_mean": {"default_agent": 5.940000000000001}, "num_env_steps_sampled": 5000.0, "episode_return_mean": 5.940000000000001, "num_env_steps_sampled_lifetime_throughput": 1550.1658088507818}, "learners": {"__all_modules__": {"num_non_trainable_parameters": 0, "learner_connector": {"timers": {"connectors": {"add_time_dim_to_batch_and_zero_pad": 0.00020804355408251285, "numpy_to_tensor": 0.00013856736161047591, "general_advantage_estimation": 0.059370425466454706, "add_states_from_episodes_to_batch": 6.576240850496106e-06, "add_one_ts_to_episodes_and_truncate": 0.1133372743089007, "batch_individual_items": 0.35029604477915854, "add_observations_from_episodes_to_batch": 0.004394722053614562, "add_columns_from_episodes_to_train_batch": 0.3365050445119679}}, "connector_pipeline_timer": 0.8648939338947372}, "learner_connector_sum_episodes_length_in": 5000.0, "num_module_steps_trained": 6000, "num_module_steps_trained_lifetime": 24000, "num_env_steps_trained": 31500, "learner_connector_sum_episodes_length_out": 5250.0, "num_trainable_parameters": 6003, "num_env_steps_trained_lifetime": 126000, "num_env_steps_trained_lifetime_throughput": 472040.41273215675, "num_module_steps_trained_throughput": 90230.11582693328, "num_module_steps_trained_lifetime_throughput": 90116.07071606837}, "default_policy": {"module_train_batch_size_mean": 1000.0, "mean_kl_loss": 0.0017084633000195026, "curr_entropy_coeff": 0.0090570820258, "weights_seq_no": 4.0, "num_module_steps_trained": 6000, "curr_kl_coeff": 0.04665601998567581, "diff_num_grad_updates_vs_sampler_policy": 1.0, "num_module_steps_trained_lifetime": 24000, "vf_loss": 0.09893853217363358, "gradients_default_optimizer_global_norm": 0.15090256929397583, "total_loss": 0.06070161238312721, "policy_loss": 0.0005972132785245776, "num_trainable_parameters": 6003, "default_optimizer_learning_rate": 0.0002847858517, "vf_explained_var": 0.0005099177360534668, "entropy": 0.6874051094055176, "vf_loss_unclipped": 32.7551155090332, "num_module_steps_trained_lifetime_throughput": 90375.6172374534}}, "num_training_step_calls_per_iteration": 1, "evaluation": {"env_runners": {"module_to_env_connector": {"connector_pipeline_timer": 0.00019886884123692246, "timers": {"connectors": {"remove_single_ts_time_rank_from_batch": 8.911166520492315e-07, "normalize_and_clip_actions": 1.5023643059003916e-05, "tensor_to_numpy": 2.2855990737882973e-05, "listify_data_for_vector_env": 3.0799562875591976e-05, "un_batch_to_individual_items": 9.140284253287545e-06, "get_actions": 7.656512410460219e-05}}}, "env_to_module_connector": {"timers": {"connectors": {"numpy_to_tensor": 1.5559134790695185e-05, "add_states_from_episodes_to_batch": 2.4973184526399328e-06, "batch_individual_items": 1.0918190631018716e-05, "add_observations_from_episodes_to_batch": 4.94331594481007e-06, "add_time_dim_to_batch_and_zero_pad": 3.3703194375074518e-06}}, "connector_pipeline_timer": 6.818925243027215e-05}, "num_episodes": 20, "num_env_steps_sampled": 400, "num_env_steps_sampled_lifetime": 20400, "episode_len_mean": 20.0, "num_module_steps_sampled": {"default_policy": 400}, "episode_return_max": 15.5, "weights_seq_no": 4.0, "episode_len_max": 20, "num_agent_steps_sampled_lifetime": {"default_agent": 1600}, "sample": 1.8593744700880448, "module_episode_returns_mean": {"default_policy": -0.8}, "num_agent_steps_sampled": {"default_agent": 400}, "agent_episode_returns_mean": {"default_agent": -0.8}, "rlmodule_inference_timer": 5.1912703914962574e-05, "num_episodes_lifetime": 80, "num_module_steps_sampled_lifetime": {"default_policy": 1600}, "episode_len_min": 20, "env_to_module_sum_episodes_length_out": 10.368237912813044, "env_reset_timer": 0.01843837991146499, "episode_duration_sec_mean": 0.03702839530014899, "env_step_timer": 2.61332261286846e-05, "episode_return_min": -13.5, "episode_return_mean": -0.8, "env_to_module_sum_episodes_length_in": 10.368237912813044, "time_between_sampling": 14.722928484097682}, "num_healthy_workers": 1, "actor_manager_num_outstanding_async_reqs": 0, "num_remote_worker_restarts": 0}, "num_env_steps_sampled_lifetime": -1225000.0, "fault_tolerance": {"num_healthy_workers": 0, "num_remote_worker_restarts": 0}, "env_runner_group": {"actor_manager_num_outstanding_async_reqs": 0}, "done": false, "training_iteration": 4, "trial_id": "497a0_00000", "date": "2025-08-11_19-28-44", "timestamp": 1754933324, "time_this_iter_s": 5.239502906799316, "time_total_s": 50.76934862136841, "pid": 19607, "hostname": "Mac", "node_ip": "127.0.0.1", "config": {"exploration_config": {}, "extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "placement_strategy": "PACK", "num_gpus": 0, "_fake_gpus": false, "num_cpus_for_main_process": 2, "eager_tracing": true, "eager_max_retraces": 20, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "torch_compile_learner": false, "torch_compile_learner_what_to_compile": "forward_train", "torch_compile_learner_dynamo_backend": "aot_eager", "torch_compile_learner_dynamo_mode": null, "torch_compile_worker": false, "torch_compile_worker_dynamo_backend": "aot_eager", "torch_compile_worker_dynamo_mode": null, "torch_ddp_kwargs": {}, "torch_skip_nan_gradients": false, "env": "Umbrella", "env_config": {}, "observation_space": null, "action_space": null, "clip_rewards": null, "normalize_actions": true, "clip_actions": false, "_is_atari": null, "disable_env_checking": false, "render_env": false, "action_mask_key": "action_mask", "env_runner_cls": null, "num_env_runners": 0, "create_local_env_runner": true, "num_envs_per_env_runner": 1, "gym_env_vectorize_mode": "SYNC", "num_cpus_per_env_runner": 1, "num_gpus_per_env_runner": 0, "custom_resources_per_env_runner": {}, "validate_env_runners_after_construction": true, "episodes_to_numpy": true, "max_requests_in_flight_per_env_runner": 1, "sample_timeout_s": 60.0, "_env_to_module_connector": null, "add_default_connectors_to_env_to_module_pipeline": true, "_module_to_env_connector": null, "add_default_connectors_to_module_to_env_pipeline": true, "merge_env_runner_states": "training_only", "broadcast_env_runner_states": true, "episode_lookback_horizon": 1, "rollout_fragment_length": "auto", "batch_mode": "complete_episodes", "compress_observations": false, "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "enable_tf1_exec_eagerly": false, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "preprocessor_pref": "deepmind", "observation_filter": "NoFilter", "update_worker_filter_stats": true, "use_worker_filter_stats": true, "sampler_perf_stats_ema_coef": null, "_is_online": true, "num_learners": 0, "num_gpus_per_learner": 0, "num_cpus_per_learner": "auto", "num_aggregator_actors_per_learner": 0, "max_requests_in_flight_per_aggregator_actor": 3, "local_gpu_idx": 0, "max_requests_in_flight_per_learner": 3, "gamma": 1, "lr": 0.0002847858517, "grad_clip": 0.5, "grad_clip_by": "global_norm", "_train_batch_size_per_learner": 5000, "train_batch_size": 4000, "num_epochs": 1, "minibatch_size": 1000, "shuffle_batch_per_epoch": true, "model": {"fcnet_hiddens": [256, 256], "fcnet_activation": "tanh", "fcnet_weights_initializer": null, "fcnet_weights_initializer_config": null, "fcnet_bias_initializer": null, "fcnet_bias_initializer_config": null, "conv_filters": null, "conv_activation": "relu", "conv_kernel_initializer": null, "conv_kernel_initializer_config": null, "conv_bias_initializer": null, "conv_bias_initializer_config": null, "conv_transpose_kernel_initializer": null, "conv_transpose_kernel_initializer_config": null, "conv_transpose_bias_initializer": null, "conv_transpose_bias_initializer_config": null, "post_fcnet_hiddens": [], "post_fcnet_activation": "relu", "post_fcnet_weights_initializer": null, "post_fcnet_weights_initializer_config": null, "post_fcnet_bias_initializer": null, "post_fcnet_bias_initializer_config": null, "free_log_std": false, "log_std_clip_param": 20.0, "no_final_linear": false, "vf_share_layers": false, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "lstm_weights_initializer": null, "lstm_weights_initializer_config": null, "lstm_bias_initializer": null, "lstm_bias_initializer_config": null, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "attention_use_n_prev_actions": 0, "attention_use_n_prev_rewards": 0, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": null, "custom_model_config": {}, "custom_action_dist": null, "custom_preprocessor": null, "encoder_latent_dim": null, "always_check_shapes": false, "lstm_use_prev_action_reward": -1, "_use_default_native_models": -1, "_disable_preprocessor_api": false, "_disable_action_flattening": false}, "_learner_connector": null, "add_default_connectors_to_learner_pipeline": true, "learner_config_dict": {}, "optimizer": {}, "_learner_class": null, "callbacks_on_algorithm_init": null, "callbacks_on_env_runners_recreated": null, "callbacks_on_offline_eval_runners_recreated": null, "callbacks_on_checkpoint_loaded": null, "callbacks_on_environment_created": null, "callbacks_on_episode_created": null, "callbacks_on_episode_start": null, "callbacks_on_episode_step": null, "callbacks_on_episode_end": null, "callbacks_on_evaluate_start": null, "callbacks_on_evaluate_end": null, "callbacks_on_evaluate_offline_start": null, "callbacks_on_evaluate_offline_end": null, "callbacks_on_sample_end": null, "callbacks_on_train_result": null, "explore": true, "enable_rl_module_and_learner": true, "enable_env_runner_and_connector_v2": true, "_prior_exploration_config": {"type": "StochasticSampling"}, "count_steps_by": "env_steps", "policy_map_capacity": 100, "policy_mapping_fn": "<function AlgorithmConfig.DEFAULT_POLICY_MAPPING_FN at 0x3862edb20>", "policies_to_train": null, "policy_states_are_swappable": false, "observation_fn": null, "offline_data_class": null, "input_read_method": "read_parquet", "input_read_method_kwargs": {}, "input_read_schema": {}, "input_read_episodes": false, "input_read_sample_batches": false, "input_read_batch_size": null, "input_filesystem": null, "input_filesystem_kwargs": {}, "input_compress_columns": ["obs", "new_obs"], "input_spaces_jsonable": true, "materialize_data": false, "materialize_mapped_data": true, "map_batches_kwargs": {}, "iter_batches_kwargs": {}, "ignore_final_observation": false, "prelearner_class": null, "prelearner_buffer_class": null, "prelearner_buffer_kwargs": {}, "prelearner_module_synch_period": 10, "dataset_num_iters_per_learner": null, "input_config": {}, "actions_in_input_normalized": false, "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_config": {}, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "output_max_rows_per_file": null, "output_write_remaining_data": false, "output_write_method": "write_parquet", "output_write_method_kwargs": {}, "output_filesystem": null, "output_filesystem_kwargs": {}, "output_write_episodes": true, "offline_sampling": false, "evaluation_interval": 1, "evaluation_duration": 20, "evaluation_duration_unit": "episodes", "evaluation_sample_timeout_s": 120.0, "evaluation_auto_duration_min_env_steps_per_sample": 100, "evaluation_auto_duration_max_env_steps_per_sample": 2000, "evaluation_parallel_to_training": false, "evaluation_force_reset_envs_before_iteration": true, "evaluation_config": null, "off_policy_estimation_methods": {}, "ope_split_batch_by_episode": true, "evaluation_num_env_runners": 1, "in_evaluation": false, "sync_filters_on_rollout_workers_timeout_s": 10.0, "offline_evaluation_interval": null, "num_offline_eval_runners": 0, "offline_loss_for_module_fn": null, "offline_evaluation_duration": 1, "offline_evaluation_parallel_to_training": false, "offline_evaluation_timeout_s": 120.0, "num_cpus_per_offline_eval_runner": 1, "num_gpus_per_offline_eval_runner": 0, "custom_resources_per_offline_eval_runner": {}, "restart_failed_offline_eval_runners": true, "ignore_offline_eval_runner_failures": false, "max_num_offline_eval_runner_restarts": 1000, "offline_eval_runner_restore_timeout_s": 1800.0, "max_requests_in_flight_per_offline_eval_runner": 1, "validate_offline_eval_runners_after_construction": true, "offline_eval_runner_health_probe_timeout_s": 30.0, "offline_eval_rl_module_inference_only": false, "broadcast_offline_eval_runner_states": false, "offline_eval_batch_size_per_runner": 256, "dataset_num_iters_per_eval_runner": 1, "keep_per_episode_custom_metrics": false, "metrics_episode_collection_timeout_s": 60.0, "metrics_num_episodes_for_smoothing": 100, "min_time_s_per_iteration": null, "min_train_timesteps_per_iteration": 0, "min_sample_timesteps_per_iteration": 0, "log_gradients": true, "export_native_model_files": false, "checkpoint_trainable_policies_only": false, "logger_creator": null, "logger_config": null, "log_level": "WARN", "log_sys_usage": true, "fake_sampler": false, "seed": 9, "restart_failed_env_runners": true, "ignore_env_runner_failures": false, "max_num_env_runner_restarts": 1000, "delay_between_env_runner_restarts_s": 60.0, "restart_failed_sub_environments": false, "num_consecutive_env_runner_failures_tolerance": 100, "env_runner_health_probe_timeout_s": 30.0, "env_runner_restore_timeout_s": 1800.0, "_model_config": {}, "_rl_module_spec": "RLModuleSpec(module_class=None, observation_space=None, action_space=None, inference_only=False, learner_only=False, model_config=DefaultModelConfig(fcnet_hiddens=[60, 90], fcnet_activation='tanh', fcnet_kernel_initializer=None, fcnet_kernel_initializer_kwargs=None, fcnet_bias_initializer=None, fcnet_bias_initializer_kwargs=None, conv_filters=None, conv_activation='relu', conv_kernel_initializer=None, conv_kernel_initializer_kwargs=None, conv_bias_initializer=None, conv_bias_initializer_kwargs=None, head_fcnet_hiddens=[], head_fcnet_activation='relu', head_fcnet_kernel_initializer=None, head_fcnet_kernel_initializer_kwargs=None, head_fcnet_bias_initializer=None, head_fcnet_bias_initializer_kwargs=None, free_log_std=False, log_std_clip_param=20.0, vf_share_layers=True, use_lstm=False, max_seq_len=20, lstm_cell_size=256, lstm_use_prev_action=False, lstm_use_prev_reward=False, lstm_kernel_initializer=None, lstm_kernel_initializer_kwargs=None, lstm_bias_initializer=None, lstm_bias_initializer_kwargs=None), catalog_class=None, load_state_path=None, model_config_dict=None)", "algorithm_config_overrides_per_module": {}, "_per_module_overrides": {}, "_validate_config": true, "_use_msgpack_checkpoints": false, "_torch_grad_scaler_class": null, "_torch_lr_scheduler_classes": null, "_tf_policy_handles_more_than_one_loss": false, "_disable_preprocessor_api": false, "_disable_action_flattening": false, "_disable_initialize_loss_from_dummy_batch": false, "_dont_auto_sync_env_runner_states": false, "env_task_fn": -1, "enable_connectors": -1, "simple_optimizer": false, "policy_map_cache": -1, "worker_cls": -1, "synchronize_filters": -1, "enable_async_evaluation": -1, "custom_async_evaluation_function": -1, "_enable_rl_module_api": -1, "auto_wrap_old_gym_envs": -1, "always_attach_evaluation_results": -1, "replay_sequence_length": null, "_disable_execution_plan_api": -1, "use_critic": true, "use_gae": true, "use_kl_loss": true, "kl_coeff": 0.7464963036515, "kl_target": 0.0270990929592, "vf_loss_coeff": 0.6688075857018, "entropy_coeff": 0.0090570820258, "clip_param": 0.1221781641624, "vf_clip_param": 0.1027808522125, "entropy_coeff_schedule": null, "lr_schedule": null, "sgd_minibatch_size": -1, "vf_share_layers": -1, "__stdout_file__": null, "__stderr_file__": null, "lambda": 0.9099046732075, "input": "sampler", "policies": {"default_policy": [null, null, null, null]}, "callbacks": "<class 'ray.rllib.callbacks.callbacks.RLlibCallback'>", "create_env_on_driver": false, "custom_eval_function": null, "framework": "torch"}, "time_since_restore": 50.76934862136841, "iterations_since_restore": 4, "perf": {"cpu_util_percent": 79.2125, "ram_util_percent": 76.82499999999999}}
{"timers": {"training_iteration": 18.88555915573861, "restore_env_runners": 3.479901359221899e-05, "training_step": 18.88470731574498, "env_runner_sampling_timer": 17.71999655033181, "learner_update_timer": 1.0975110185272263, "synch_weights": 0.04416710361544573, "restore_eval_env_runners": 0.0002762686382144457, "evaluation_iteration": 2.023757133939709, "synch_eval_env_connectors": 0.0014900906583905453, "synch_env_connectors": 2.6836419007391665e-05}, "env_runners": {"module_to_env_connector": {"timers": {"connectors": {"un_batch_to_individual_items": 1.1353173740253968e-05, "tensor_to_numpy": 3.649464220942156e-05, "normalize_and_clip_actions": 2.1778640107317537e-05, "remove_single_ts_time_rank_from_batch": 1.3296757386084333e-06, "listify_data_for_vector_env": 2.991489266324034e-05, "get_actions": 0.00012939270533673177}}, "connector_pipeline_timer": 0.00029160333001685513}, "time_between_sampling": 0.004171666361734583, "episode_len_max": 20, "num_env_steps_sampled_lifetime": -1842500.0, "env_to_module_sum_episodes_length_in": 10.36823839457432, "sample": 0.014322046764768146, "num_agent_steps_sampled_lifetime": {"default_agent": -1842500.0}, "episode_len_mean": 20.0, "rlmodule_inference_timer": 0.00012027248946472936, "num_episodes_lifetime": -92125.0, "num_module_steps_sampled": {"default_policy": 5000.0}, "env_to_module_connector": {"connector_pipeline_timer": 0.00010474897832617125, "timers": {"connectors": {"add_states_from_episodes_to_batch": 3.3429771700841358e-06, "batch_individual_items": 1.579161627546643e-05, "add_observations_from_episodes_to_batch": 7.3612619943424725e-06, "add_time_dim_to_batch_and_zero_pad": 6.2572809530053524e-06, "numpy_to_tensor": 2.594635826102664e-05}}}, "module_episode_returns_mean": {"default_policy": 6.5}, "num_agent_steps_sampled": {"default_agent": 5000.0}, "num_episodes": 250.0, "episode_len_min": 20, "env_to_module_sum_episodes_length_out": 10.36823839457432, "num_module_steps_sampled_lifetime": {"default_policy": -1842500.0}, "env_reset_timer": 0.00012795417137024295, "episode_duration_sec_mean": 0.013305762494914233, "episode_return_max": 14.5, "weights_seq_no": 4.0, "env_step_timer": 4.199958667575583e-05, "episode_return_min": -5.5, "agent_episode_returns_mean": {"default_agent": 6.5}, "num_env_steps_sampled": 5000.0, "episode_return_mean": 6.5, "num_env_steps_sampled_lifetime_throughput": 1842.152336277395}, "learners": {"__all_modules__": {"num_non_trainable_parameters": 0, "learner_connector": {"timers": {"connectors": {"add_time_dim_to_batch_and_zero_pad": 0.0002064893693473935, "numpy_to_tensor": 0.0001380141890947474, "general_advantage_estimation": 0.058870176621886955, "add_states_from_episodes_to_batch": 6.584648971833521e-06, "add_one_ts_to_episodes_and_truncate": 0.11238616614573738, "batch_individual_items": 0.34732863266188446, "add_observations_from_episodes_to_batch": 0.004364756912768738, "add_columns_from_episodes_to_train_batch": 0.33370935406692953}}, "connector_pipeline_timer": 0.8576432437160554}, "learner_connector_sum_episodes_length_in": 5000.0, "num_module_steps_trained": 6000, "num_module_steps_trained_lifetime": 30000, "num_env_steps_trained": 31500, "learner_connector_sum_episodes_length_out": 5250.0, "num_trainable_parameters": 6003, "num_env_steps_trained_lifetime": 157500, "num_env_steps_trained_lifetime_throughput": 493062.93704245484, "num_module_steps_trained_throughput": 94224.70682655269, "num_module_steps_trained_lifetime_throughput": 94112.62554857337}, "default_policy": {"module_train_batch_size_mean": 1000.0, "mean_kl_loss": 0.0014019616646692157, "curr_entropy_coeff": 0.0090570820258, "weights_seq_no": 5.0, "num_module_steps_trained": 6000, "curr_kl_coeff": 0.023328009992837906, "diff_num_grad_updates_vs_sampler_policy": 1.0, "num_module_steps_trained_lifetime": 30000, "vf_loss": 0.09875169396400452, "gradients_default_optimizer_global_norm": 0.07133479416370392, "total_loss": 0.13377542793750763, "policy_loss": 0.07381351292133331, "num_trainable_parameters": 6003, "default_optimizer_learning_rate": 0.0002847858517, "vf_explained_var": 0.0012282133102416992, "entropy": 0.6789590120315552, "vf_loss_unclipped": 32.43641662597656, "num_module_steps_trained_lifetime_throughput": 94355.6002449837}}, "num_training_step_calls_per_iteration": 1, "evaluation": {"env_runners": {"module_to_env_connector": {"connector_pipeline_timer": 0.00020245465733919037, "timers": {"connectors": {"remove_single_ts_time_rank_from_batch": 1.281261299797925e-06, "normalize_and_clip_actions": 1.6825635850066565e-05, "tensor_to_numpy": 2.5038878203996022e-05, "listify_data_for_vector_env": 2.0294826601590093e-05, "un_batch_to_individual_items": 9.8889952311497e-06, "get_actions": 8.254231639692222e-05}}}, "env_to_module_connector": {"timers": {"connectors": {"numpy_to_tensor": 1.7974371917316952e-05, "add_states_from_episodes_to_batch": 2.6453568278839978e-06, "batch_individual_items": 1.2652808426329432e-05, "add_observations_from_episodes_to_batch": 4.5920110195155835e-06, "add_time_dim_to_batch_and_zero_pad": 4.18398446856931e-06}}, "connector_pipeline_timer": 7.630686676024383e-05}, "num_episodes": 20, "num_env_steps_sampled": 400, "num_env_steps_sampled_lifetime": 25400, "episode_len_mean": 20.0, "num_module_steps_sampled": {"default_policy": 400}, "episode_return_max": 15.5, "weights_seq_no": 5.0, "episode_len_max": 20, "num_agent_steps_sampled_lifetime": {"default_agent": 2000}, "sample": 1.8436071024672194, "module_episode_returns_mean": {"default_policy": 0.3}, "num_agent_steps_sampled": {"default_agent": 400}, "agent_episode_returns_mean": {"default_agent": 0.3}, "rlmodule_inference_timer": 5.638151911272179e-05, "num_episodes_lifetime": 100, "num_module_steps_sampled_lifetime": {"default_policy": 2000}, "episode_len_min": 20, "env_to_module_sum_episodes_length_out": 10.368238387501162, "env_reset_timer": 0.018254828612286566, "episode_duration_sec_mean": 0.03222582501126453, "env_step_timer": 2.8586865104171266e-05, "episode_return_min": -13.5, "episode_return_mean": 0.3, "env_to_module_sum_episodes_length_in": 10.368238387501162, "time_between_sampling": 14.617387473837224}, "num_healthy_workers": 1, "actor_manager_num_outstanding_async_reqs": 0, "num_remote_worker_restarts": 0}, "num_env_steps_sampled_lifetime": -1842500.0, "fault_tolerance": {"num_healthy_workers": 0, "num_remote_worker_restarts": 0}, "env_runner_group": {"actor_manager_num_outstanding_async_reqs": 0}, "done": false, "training_iteration": 5, "trial_id": "497a0_00000", "date": "2025-08-11_19-28-48", "timestamp": 1754933328, "time_this_iter_s": 4.379411935806274, "time_total_s": 55.14876055717468, "pid": 19607, "hostname": "Mac", "node_ip": "127.0.0.1", "config": {"exploration_config": {}, "extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "placement_strategy": "PACK", "num_gpus": 0, "_fake_gpus": false, "num_cpus_for_main_process": 2, "eager_tracing": true, "eager_max_retraces": 20, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "torch_compile_learner": false, "torch_compile_learner_what_to_compile": "forward_train", "torch_compile_learner_dynamo_backend": "aot_eager", "torch_compile_learner_dynamo_mode": null, "torch_compile_worker": false, "torch_compile_worker_dynamo_backend": "aot_eager", "torch_compile_worker_dynamo_mode": null, "torch_ddp_kwargs": {}, "torch_skip_nan_gradients": false, "env": "Umbrella", "env_config": {}, "observation_space": null, "action_space": null, "clip_rewards": null, "normalize_actions": true, "clip_actions": false, "_is_atari": null, "disable_env_checking": false, "render_env": false, "action_mask_key": "action_mask", "env_runner_cls": null, "num_env_runners": 0, "create_local_env_runner": true, "num_envs_per_env_runner": 1, "gym_env_vectorize_mode": "SYNC", "num_cpus_per_env_runner": 1, "num_gpus_per_env_runner": 0, "custom_resources_per_env_runner": {}, "validate_env_runners_after_construction": true, "episodes_to_numpy": true, "max_requests_in_flight_per_env_runner": 1, "sample_timeout_s": 60.0, "_env_to_module_connector": null, "add_default_connectors_to_env_to_module_pipeline": true, "_module_to_env_connector": null, "add_default_connectors_to_module_to_env_pipeline": true, "merge_env_runner_states": "training_only", "broadcast_env_runner_states": true, "episode_lookback_horizon": 1, "rollout_fragment_length": "auto", "batch_mode": "complete_episodes", "compress_observations": false, "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "enable_tf1_exec_eagerly": false, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "preprocessor_pref": "deepmind", "observation_filter": "NoFilter", "update_worker_filter_stats": true, "use_worker_filter_stats": true, "sampler_perf_stats_ema_coef": null, "_is_online": true, "num_learners": 0, "num_gpus_per_learner": 0, "num_cpus_per_learner": "auto", "num_aggregator_actors_per_learner": 0, "max_requests_in_flight_per_aggregator_actor": 3, "local_gpu_idx": 0, "max_requests_in_flight_per_learner": 3, "gamma": 1, "lr": 0.0002847858517, "grad_clip": 0.5, "grad_clip_by": "global_norm", "_train_batch_size_per_learner": 5000, "train_batch_size": 4000, "num_epochs": 1, "minibatch_size": 1000, "shuffle_batch_per_epoch": true, "model": {"fcnet_hiddens": [256, 256], "fcnet_activation": "tanh", "fcnet_weights_initializer": null, "fcnet_weights_initializer_config": null, "fcnet_bias_initializer": null, "fcnet_bias_initializer_config": null, "conv_filters": null, "conv_activation": "relu", "conv_kernel_initializer": null, "conv_kernel_initializer_config": null, "conv_bias_initializer": null, "conv_bias_initializer_config": null, "conv_transpose_kernel_initializer": null, "conv_transpose_kernel_initializer_config": null, "conv_transpose_bias_initializer": null, "conv_transpose_bias_initializer_config": null, "post_fcnet_hiddens": [], "post_fcnet_activation": "relu", "post_fcnet_weights_initializer": null, "post_fcnet_weights_initializer_config": null, "post_fcnet_bias_initializer": null, "post_fcnet_bias_initializer_config": null, "free_log_std": false, "log_std_clip_param": 20.0, "no_final_linear": false, "vf_share_layers": false, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "lstm_weights_initializer": null, "lstm_weights_initializer_config": null, "lstm_bias_initializer": null, "lstm_bias_initializer_config": null, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "attention_use_n_prev_actions": 0, "attention_use_n_prev_rewards": 0, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": null, "custom_model_config": {}, "custom_action_dist": null, "custom_preprocessor": null, "encoder_latent_dim": null, "always_check_shapes": false, "lstm_use_prev_action_reward": -1, "_use_default_native_models": -1, "_disable_preprocessor_api": false, "_disable_action_flattening": false}, "_learner_connector": null, "add_default_connectors_to_learner_pipeline": true, "learner_config_dict": {}, "optimizer": {}, "_learner_class": null, "callbacks_on_algorithm_init": null, "callbacks_on_env_runners_recreated": null, "callbacks_on_offline_eval_runners_recreated": null, "callbacks_on_checkpoint_loaded": null, "callbacks_on_environment_created": null, "callbacks_on_episode_created": null, "callbacks_on_episode_start": null, "callbacks_on_episode_step": null, "callbacks_on_episode_end": null, "callbacks_on_evaluate_start": null, "callbacks_on_evaluate_end": null, "callbacks_on_evaluate_offline_start": null, "callbacks_on_evaluate_offline_end": null, "callbacks_on_sample_end": null, "callbacks_on_train_result": null, "explore": true, "enable_rl_module_and_learner": true, "enable_env_runner_and_connector_v2": true, "_prior_exploration_config": {"type": "StochasticSampling"}, "count_steps_by": "env_steps", "policy_map_capacity": 100, "policy_mapping_fn": "<function AlgorithmConfig.DEFAULT_POLICY_MAPPING_FN at 0x3862edb20>", "policies_to_train": null, "policy_states_are_swappable": false, "observation_fn": null, "offline_data_class": null, "input_read_method": "read_parquet", "input_read_method_kwargs": {}, "input_read_schema": {}, "input_read_episodes": false, "input_read_sample_batches": false, "input_read_batch_size": null, "input_filesystem": null, "input_filesystem_kwargs": {}, "input_compress_columns": ["obs", "new_obs"], "input_spaces_jsonable": true, "materialize_data": false, "materialize_mapped_data": true, "map_batches_kwargs": {}, "iter_batches_kwargs": {}, "ignore_final_observation": false, "prelearner_class": null, "prelearner_buffer_class": null, "prelearner_buffer_kwargs": {}, "prelearner_module_synch_period": 10, "dataset_num_iters_per_learner": null, "input_config": {}, "actions_in_input_normalized": false, "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_config": {}, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "output_max_rows_per_file": null, "output_write_remaining_data": false, "output_write_method": "write_parquet", "output_write_method_kwargs": {}, "output_filesystem": null, "output_filesystem_kwargs": {}, "output_write_episodes": true, "offline_sampling": false, "evaluation_interval": 1, "evaluation_duration": 20, "evaluation_duration_unit": "episodes", "evaluation_sample_timeout_s": 120.0, "evaluation_auto_duration_min_env_steps_per_sample": 100, "evaluation_auto_duration_max_env_steps_per_sample": 2000, "evaluation_parallel_to_training": false, "evaluation_force_reset_envs_before_iteration": true, "evaluation_config": null, "off_policy_estimation_methods": {}, "ope_split_batch_by_episode": true, "evaluation_num_env_runners": 1, "in_evaluation": false, "sync_filters_on_rollout_workers_timeout_s": 10.0, "offline_evaluation_interval": null, "num_offline_eval_runners": 0, "offline_loss_for_module_fn": null, "offline_evaluation_duration": 1, "offline_evaluation_parallel_to_training": false, "offline_evaluation_timeout_s": 120.0, "num_cpus_per_offline_eval_runner": 1, "num_gpus_per_offline_eval_runner": 0, "custom_resources_per_offline_eval_runner": {}, "restart_failed_offline_eval_runners": true, "ignore_offline_eval_runner_failures": false, "max_num_offline_eval_runner_restarts": 1000, "offline_eval_runner_restore_timeout_s": 1800.0, "max_requests_in_flight_per_offline_eval_runner": 1, "validate_offline_eval_runners_after_construction": true, "offline_eval_runner_health_probe_timeout_s": 30.0, "offline_eval_rl_module_inference_only": false, "broadcast_offline_eval_runner_states": false, "offline_eval_batch_size_per_runner": 256, "dataset_num_iters_per_eval_runner": 1, "keep_per_episode_custom_metrics": false, "metrics_episode_collection_timeout_s": 60.0, "metrics_num_episodes_for_smoothing": 100, "min_time_s_per_iteration": null, "min_train_timesteps_per_iteration": 0, "min_sample_timesteps_per_iteration": 0, "log_gradients": true, "export_native_model_files": false, "checkpoint_trainable_policies_only": false, "logger_creator": null, "logger_config": null, "log_level": "WARN", "log_sys_usage": true, "fake_sampler": false, "seed": 9, "restart_failed_env_runners": true, "ignore_env_runner_failures": false, "max_num_env_runner_restarts": 1000, "delay_between_env_runner_restarts_s": 60.0, "restart_failed_sub_environments": false, "num_consecutive_env_runner_failures_tolerance": 100, "env_runner_health_probe_timeout_s": 30.0, "env_runner_restore_timeout_s": 1800.0, "_model_config": {}, "_rl_module_spec": "RLModuleSpec(module_class=None, observation_space=None, action_space=None, inference_only=False, learner_only=False, model_config=DefaultModelConfig(fcnet_hiddens=[60, 90], fcnet_activation='tanh', fcnet_kernel_initializer=None, fcnet_kernel_initializer_kwargs=None, fcnet_bias_initializer=None, fcnet_bias_initializer_kwargs=None, conv_filters=None, conv_activation='relu', conv_kernel_initializer=None, conv_kernel_initializer_kwargs=None, conv_bias_initializer=None, conv_bias_initializer_kwargs=None, head_fcnet_hiddens=[], head_fcnet_activation='relu', head_fcnet_kernel_initializer=None, head_fcnet_kernel_initializer_kwargs=None, head_fcnet_bias_initializer=None, head_fcnet_bias_initializer_kwargs=None, free_log_std=False, log_std_clip_param=20.0, vf_share_layers=True, use_lstm=False, max_seq_len=20, lstm_cell_size=256, lstm_use_prev_action=False, lstm_use_prev_reward=False, lstm_kernel_initializer=None, lstm_kernel_initializer_kwargs=None, lstm_bias_initializer=None, lstm_bias_initializer_kwargs=None), catalog_class=None, load_state_path=None, model_config_dict=None)", "algorithm_config_overrides_per_module": {}, "_per_module_overrides": {}, "_validate_config": true, "_use_msgpack_checkpoints": false, "_torch_grad_scaler_class": null, "_torch_lr_scheduler_classes": null, "_tf_policy_handles_more_than_one_loss": false, "_disable_preprocessor_api": false, "_disable_action_flattening": false, "_disable_initialize_loss_from_dummy_batch": false, "_dont_auto_sync_env_runner_states": false, "env_task_fn": -1, "enable_connectors": -1, "simple_optimizer": false, "policy_map_cache": -1, "worker_cls": -1, "synchronize_filters": -1, "enable_async_evaluation": -1, "custom_async_evaluation_function": -1, "_enable_rl_module_api": -1, "auto_wrap_old_gym_envs": -1, "always_attach_evaluation_results": -1, "replay_sequence_length": null, "_disable_execution_plan_api": -1, "use_critic": true, "use_gae": true, "use_kl_loss": true, "kl_coeff": 0.7464963036515, "kl_target": 0.0270990929592, "vf_loss_coeff": 0.6688075857018, "entropy_coeff": 0.0090570820258, "clip_param": 0.1221781641624, "vf_clip_param": 0.1027808522125, "entropy_coeff_schedule": null, "lr_schedule": null, "sgd_minibatch_size": -1, "vf_share_layers": -1, "__stdout_file__": null, "__stderr_file__": null, "lambda": 0.9099046732075, "input": "sampler", "policies": {"default_policy": [null, null, null, null]}, "callbacks": "<class 'ray.rllib.callbacks.callbacks.RLlibCallback'>", "create_env_on_driver": false, "custom_eval_function": null, "framework": "torch"}, "time_since_restore": 55.14876055717468, "iterations_since_restore": 5, "perf": {"cpu_util_percent": 87.39999999999999, "ram_util_percent": 77.06666666666666}}
{"timers": {"training_iteration": 18.739178240851032, "restore_env_runners": 3.4536443198687313e-05, "training_step": 18.73832682050766, "env_runner_sampling_timer": 17.581190256077996, "learner_update_timer": 1.090500422922975, "synch_weights": 0.04376265882898796, "restore_eval_env_runners": 0.000273653871468521, "evaluation_iteration": 2.006444385939875, "synch_eval_env_connectors": 0.001476935581165337, "synch_env_connectors": 2.661221464134636e-05}, "env_runners": {"module_to_env_connector": {"timers": {"connectors": {"un_batch_to_individual_items": 1.2003843121052248e-05, "tensor_to_numpy": 3.698130152651961e-05, "normalize_and_clip_actions": 2.6910746862999148e-05, "remove_single_ts_time_rank_from_batch": 1.8420558429028639e-06, "listify_data_for_vector_env": 3.0024781973882415e-05, "get_actions": 0.0001335453827645158}}, "connector_pipeline_timer": 0.0003027551995824944}, "time_between_sampling": 0.0036155567481336737, "episode_len_max": 20, "num_env_steps_sampled_lifetime": -2460000.0, "env_to_module_sum_episodes_length_in": 10.36823839457432, "sample": 0.014494445574790604, "num_agent_steps_sampled_lifetime": {"default_agent": -2460000.0}, "episode_len_mean": 20.0, "rlmodule_inference_timer": 8.737247839093146e-05, "num_episodes_lifetime": -123000.0, "num_module_steps_sampled": {"default_policy": 5000.0}, "env_to_module_connector": {"connector_pipeline_timer": 0.00010912815143297186, "timers": {"connectors": {"add_states_from_episodes_to_batch": 3.5560205997514603e-06, "batch_individual_items": 1.778258721799463e-05, "add_observations_from_episodes_to_batch": 6.9916909856103306e-06, "add_time_dim_to_batch_and_zero_pad": 5.832131273166054e-06, "numpy_to_tensor": 2.7065368658900505e-05}}}, "module_episode_returns_mean": {"default_policy": 6.820000000000002}, "num_agent_steps_sampled": {"default_agent": 5000.0}, "num_episodes": 250.0, "episode_len_min": 20, "env_to_module_sum_episodes_length_out": 10.36823839457432, "num_module_steps_sampled_lifetime": {"default_policy": -2460000.0}, "env_reset_timer": 0.0001354674287362312, "episode_duration_sec_mean": 0.012930662616156044, "episode_return_max": 14.5, "weights_seq_no": 5.0, "env_step_timer": 4.1565164248473125e-05, "episode_return_min": -5.5, "agent_episode_returns_mean": {"default_agent": 6.820000000000002}, "num_env_steps_sampled": 5000.0, "episode_return_mean": 6.820000000000002, "num_env_steps_sampled_lifetime_throughput": 1794.7021580311182}, "learners": {"__all_modules__": {"num_non_trainable_parameters": 0, "learner_connector": {"timers": {"connectors": {"add_time_dim_to_batch_and_zero_pad": 0.00020453489558667243, "numpy_to_tensor": 0.00013729070761716946, "general_advantage_estimation": 0.05836172735615185, "add_states_from_episodes_to_batch": 6.5542125305552845e-06, "add_one_ts_to_episodes_and_truncate": 0.11139114781459251, "batch_individual_items": 0.3464385084143652, "add_observations_from_episodes_to_batch": 0.004336986014009067, "add_columns_from_episodes_to_train_batch": 0.330851844276972}}, "connector_pipeline_timer": 0.852357247109026}, "learner_connector_sum_episodes_length_in": 5000.0, "num_module_steps_trained": 6000, "num_module_steps_trained_lifetime": 36000, "num_env_steps_trained": 31500, "learner_connector_sum_episodes_length_out": 5250.0, "num_trainable_parameters": 6003, "num_env_steps_trained_lifetime": 189000, "num_env_steps_trained_lifetime_throughput": 509309.0018281665, "num_module_steps_trained_throughput": 97303.95932130386, "num_module_steps_trained_lifetime_throughput": 97192.93683704452}, "default_policy": {"module_train_batch_size_mean": 1000.0, "mean_kl_loss": 0.000993289751932025, "curr_entropy_coeff": 0.0090570820258, "weights_seq_no": 6.0, "num_module_steps_trained": 6000, "curr_kl_coeff": 0.011664004996418953, "diff_num_grad_updates_vs_sampler_policy": 1.0, "num_module_steps_trained_lifetime": 36000, "vf_loss": 0.09929709136486053, "gradients_default_optimizer_global_norm": 0.03585651144385338, "total_loss": 0.06740652769804001, "policy_loss": 0.007046705111861229, "num_trainable_parameters": 6003, "default_optimizer_learning_rate": 0.0002847858517, "vf_explained_var": 0.0018221735954284668, "entropy": 0.6706355810165405, "vf_loss_unclipped": 33.48452377319336, "num_module_steps_trained_lifetime_throughput": 97410.47704326065}}, "num_training_step_calls_per_iteration": 1, "evaluation": {"env_runners": {"module_to_env_connector": {"connector_pipeline_timer": 0.00017500223196295866, "timers": {"connectors": {"remove_single_ts_time_rank_from_batch": 7.060997944674608e-07, "normalize_and_clip_actions": 1.2845955998934334e-05, "tensor_to_numpy": 1.9981117630642373e-05, "listify_data_for_vector_env": 1.5493506060623527e-05, "un_batch_to_individual_items": 7.4200273735962496e-06, "get_actions": 8.328003877249238e-05}}}, "env_to_module_connector": {"timers": {"connectors": {"numpy_to_tensor": 1.550661357831945e-05, "add_states_from_episodes_to_batch": 2.218637386385224e-06, "batch_individual_items": 9.866488226268894e-06, "add_observations_from_episodes_to_batch": 3.7628849078553487e-06, "add_time_dim_to_batch_and_zero_pad": 3.984639519330937e-06}}, "connector_pipeline_timer": 6.513779146009113e-05}, "num_episodes": 20, "num_env_steps_sampled": 400, "num_env_steps_sampled_lifetime": 30400, "episode_len_mean": 20.0, "num_module_steps_sampled": {"default_policy": 400}, "episode_return_max": 15.5, "weights_seq_no": 6.0, "episode_len_max": 20, "num_agent_steps_sampled_lifetime": {"default_agent": 2400}, "sample": 1.8269655301927885, "module_episode_returns_mean": {"default_policy": 0.7}, "num_agent_steps_sampled": {"default_agent": 400}, "agent_episode_returns_mean": {"default_agent": 0.7}, "rlmodule_inference_timer": 4.351112397356238e-05, "num_episodes_lifetime": 120, "num_module_steps_sampled_lifetime": {"default_policy": 2400}, "episode_len_min": 20, "env_to_module_sum_episodes_length_out": 10.368238394470474, "env_reset_timer": 0.018074689485369555, "episode_duration_sec_mean": 0.01589961293153465, "env_step_timer": 1.9338165177273243e-05, "episode_return_min": -13.5, "episode_return_mean": 0.7, "env_to_module_sum_episodes_length_in": 10.368238394470474, "time_between_sampling": 14.514120768269064}, "num_healthy_workers": 1, "actor_manager_num_outstanding_async_reqs": 0, "num_remote_worker_restarts": 0}, "num_env_steps_sampled_lifetime": -2460000.0, "fault_tolerance": {"num_healthy_workers": 0, "num_remote_worker_restarts": 0}, "env_runner_group": {"actor_manager_num_outstanding_async_reqs": 0}, "done": false, "training_iteration": 6, "trial_id": "497a0_00000", "date": "2025-08-11_19-28-53", "timestamp": 1754933333, "time_this_iter_s": 4.457629919052124, "time_total_s": 59.60639047622681, "pid": 19607, "hostname": "Mac", "node_ip": "127.0.0.1", "config": {"exploration_config": {}, "extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "placement_strategy": "PACK", "num_gpus": 0, "_fake_gpus": false, "num_cpus_for_main_process": 2, "eager_tracing": true, "eager_max_retraces": 20, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "torch_compile_learner": false, "torch_compile_learner_what_to_compile": "forward_train", "torch_compile_learner_dynamo_backend": "aot_eager", "torch_compile_learner_dynamo_mode": null, "torch_compile_worker": false, "torch_compile_worker_dynamo_backend": "aot_eager", "torch_compile_worker_dynamo_mode": null, "torch_ddp_kwargs": {}, "torch_skip_nan_gradients": false, "env": "Umbrella", "env_config": {}, "observation_space": null, "action_space": null, "clip_rewards": null, "normalize_actions": true, "clip_actions": false, "_is_atari": null, "disable_env_checking": false, "render_env": false, "action_mask_key": "action_mask", "env_runner_cls": null, "num_env_runners": 0, "create_local_env_runner": true, "num_envs_per_env_runner": 1, "gym_env_vectorize_mode": "SYNC", "num_cpus_per_env_runner": 1, "num_gpus_per_env_runner": 0, "custom_resources_per_env_runner": {}, "validate_env_runners_after_construction": true, "episodes_to_numpy": true, "max_requests_in_flight_per_env_runner": 1, "sample_timeout_s": 60.0, "_env_to_module_connector": null, "add_default_connectors_to_env_to_module_pipeline": true, "_module_to_env_connector": null, "add_default_connectors_to_module_to_env_pipeline": true, "merge_env_runner_states": "training_only", "broadcast_env_runner_states": true, "episode_lookback_horizon": 1, "rollout_fragment_length": "auto", "batch_mode": "complete_episodes", "compress_observations": false, "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "enable_tf1_exec_eagerly": false, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "preprocessor_pref": "deepmind", "observation_filter": "NoFilter", "update_worker_filter_stats": true, "use_worker_filter_stats": true, "sampler_perf_stats_ema_coef": null, "_is_online": true, "num_learners": 0, "num_gpus_per_learner": 0, "num_cpus_per_learner": "auto", "num_aggregator_actors_per_learner": 0, "max_requests_in_flight_per_aggregator_actor": 3, "local_gpu_idx": 0, "max_requests_in_flight_per_learner": 3, "gamma": 1, "lr": 0.0002847858517, "grad_clip": 0.5, "grad_clip_by": "global_norm", "_train_batch_size_per_learner": 5000, "train_batch_size": 4000, "num_epochs": 1, "minibatch_size": 1000, "shuffle_batch_per_epoch": true, "model": {"fcnet_hiddens": [256, 256], "fcnet_activation": "tanh", "fcnet_weights_initializer": null, "fcnet_weights_initializer_config": null, "fcnet_bias_initializer": null, "fcnet_bias_initializer_config": null, "conv_filters": null, "conv_activation": "relu", "conv_kernel_initializer": null, "conv_kernel_initializer_config": null, "conv_bias_initializer": null, "conv_bias_initializer_config": null, "conv_transpose_kernel_initializer": null, "conv_transpose_kernel_initializer_config": null, "conv_transpose_bias_initializer": null, "conv_transpose_bias_initializer_config": null, "post_fcnet_hiddens": [], "post_fcnet_activation": "relu", "post_fcnet_weights_initializer": null, "post_fcnet_weights_initializer_config": null, "post_fcnet_bias_initializer": null, "post_fcnet_bias_initializer_config": null, "free_log_std": false, "log_std_clip_param": 20.0, "no_final_linear": false, "vf_share_layers": false, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "lstm_weights_initializer": null, "lstm_weights_initializer_config": null, "lstm_bias_initializer": null, "lstm_bias_initializer_config": null, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "attention_use_n_prev_actions": 0, "attention_use_n_prev_rewards": 0, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": null, "custom_model_config": {}, "custom_action_dist": null, "custom_preprocessor": null, "encoder_latent_dim": null, "always_check_shapes": false, "lstm_use_prev_action_reward": -1, "_use_default_native_models": -1, "_disable_preprocessor_api": false, "_disable_action_flattening": false}, "_learner_connector": null, "add_default_connectors_to_learner_pipeline": true, "learner_config_dict": {}, "optimizer": {}, "_learner_class": null, "callbacks_on_algorithm_init": null, "callbacks_on_env_runners_recreated": null, "callbacks_on_offline_eval_runners_recreated": null, "callbacks_on_checkpoint_loaded": null, "callbacks_on_environment_created": null, "callbacks_on_episode_created": null, "callbacks_on_episode_start": null, "callbacks_on_episode_step": null, "callbacks_on_episode_end": null, "callbacks_on_evaluate_start": null, "callbacks_on_evaluate_end": null, "callbacks_on_evaluate_offline_start": null, "callbacks_on_evaluate_offline_end": null, "callbacks_on_sample_end": null, "callbacks_on_train_result": null, "explore": true, "enable_rl_module_and_learner": true, "enable_env_runner_and_connector_v2": true, "_prior_exploration_config": {"type": "StochasticSampling"}, "count_steps_by": "env_steps", "policy_map_capacity": 100, "policy_mapping_fn": "<function AlgorithmConfig.DEFAULT_POLICY_MAPPING_FN at 0x3862edb20>", "policies_to_train": null, "policy_states_are_swappable": false, "observation_fn": null, "offline_data_class": null, "input_read_method": "read_parquet", "input_read_method_kwargs": {}, "input_read_schema": {}, "input_read_episodes": false, "input_read_sample_batches": false, "input_read_batch_size": null, "input_filesystem": null, "input_filesystem_kwargs": {}, "input_compress_columns": ["obs", "new_obs"], "input_spaces_jsonable": true, "materialize_data": false, "materialize_mapped_data": true, "map_batches_kwargs": {}, "iter_batches_kwargs": {}, "ignore_final_observation": false, "prelearner_class": null, "prelearner_buffer_class": null, "prelearner_buffer_kwargs": {}, "prelearner_module_synch_period": 10, "dataset_num_iters_per_learner": null, "input_config": {}, "actions_in_input_normalized": false, "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_config": {}, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "output_max_rows_per_file": null, "output_write_remaining_data": false, "output_write_method": "write_parquet", "output_write_method_kwargs": {}, "output_filesystem": null, "output_filesystem_kwargs": {}, "output_write_episodes": true, "offline_sampling": false, "evaluation_interval": 1, "evaluation_duration": 20, "evaluation_duration_unit": "episodes", "evaluation_sample_timeout_s": 120.0, "evaluation_auto_duration_min_env_steps_per_sample": 100, "evaluation_auto_duration_max_env_steps_per_sample": 2000, "evaluation_parallel_to_training": false, "evaluation_force_reset_envs_before_iteration": true, "evaluation_config": null, "off_policy_estimation_methods": {}, "ope_split_batch_by_episode": true, "evaluation_num_env_runners": 1, "in_evaluation": false, "sync_filters_on_rollout_workers_timeout_s": 10.0, "offline_evaluation_interval": null, "num_offline_eval_runners": 0, "offline_loss_for_module_fn": null, "offline_evaluation_duration": 1, "offline_evaluation_parallel_to_training": false, "offline_evaluation_timeout_s": 120.0, "num_cpus_per_offline_eval_runner": 1, "num_gpus_per_offline_eval_runner": 0, "custom_resources_per_offline_eval_runner": {}, "restart_failed_offline_eval_runners": true, "ignore_offline_eval_runner_failures": false, "max_num_offline_eval_runner_restarts": 1000, "offline_eval_runner_restore_timeout_s": 1800.0, "max_requests_in_flight_per_offline_eval_runner": 1, "validate_offline_eval_runners_after_construction": true, "offline_eval_runner_health_probe_timeout_s": 30.0, "offline_eval_rl_module_inference_only": false, "broadcast_offline_eval_runner_states": false, "offline_eval_batch_size_per_runner": 256, "dataset_num_iters_per_eval_runner": 1, "keep_per_episode_custom_metrics": false, "metrics_episode_collection_timeout_s": 60.0, "metrics_num_episodes_for_smoothing": 100, "min_time_s_per_iteration": null, "min_train_timesteps_per_iteration": 0, "min_sample_timesteps_per_iteration": 0, "log_gradients": true, "export_native_model_files": false, "checkpoint_trainable_policies_only": false, "logger_creator": null, "logger_config": null, "log_level": "WARN", "log_sys_usage": true, "fake_sampler": false, "seed": 9, "restart_failed_env_runners": true, "ignore_env_runner_failures": false, "max_num_env_runner_restarts": 1000, "delay_between_env_runner_restarts_s": 60.0, "restart_failed_sub_environments": false, "num_consecutive_env_runner_failures_tolerance": 100, "env_runner_health_probe_timeout_s": 30.0, "env_runner_restore_timeout_s": 1800.0, "_model_config": {}, "_rl_module_spec": "RLModuleSpec(module_class=None, observation_space=None, action_space=None, inference_only=False, learner_only=False, model_config=DefaultModelConfig(fcnet_hiddens=[60, 90], fcnet_activation='tanh', fcnet_kernel_initializer=None, fcnet_kernel_initializer_kwargs=None, fcnet_bias_initializer=None, fcnet_bias_initializer_kwargs=None, conv_filters=None, conv_activation='relu', conv_kernel_initializer=None, conv_kernel_initializer_kwargs=None, conv_bias_initializer=None, conv_bias_initializer_kwargs=None, head_fcnet_hiddens=[], head_fcnet_activation='relu', head_fcnet_kernel_initializer=None, head_fcnet_kernel_initializer_kwargs=None, head_fcnet_bias_initializer=None, head_fcnet_bias_initializer_kwargs=None, free_log_std=False, log_std_clip_param=20.0, vf_share_layers=True, use_lstm=False, max_seq_len=20, lstm_cell_size=256, lstm_use_prev_action=False, lstm_use_prev_reward=False, lstm_kernel_initializer=None, lstm_kernel_initializer_kwargs=None, lstm_bias_initializer=None, lstm_bias_initializer_kwargs=None), catalog_class=None, load_state_path=None, model_config_dict=None)", "algorithm_config_overrides_per_module": {}, "_per_module_overrides": {}, "_validate_config": true, "_use_msgpack_checkpoints": false, "_torch_grad_scaler_class": null, "_torch_lr_scheduler_classes": null, "_tf_policy_handles_more_than_one_loss": false, "_disable_preprocessor_api": false, "_disable_action_flattening": false, "_disable_initialize_loss_from_dummy_batch": false, "_dont_auto_sync_env_runner_states": false, "env_task_fn": -1, "enable_connectors": -1, "simple_optimizer": false, "policy_map_cache": -1, "worker_cls": -1, "synchronize_filters": -1, "enable_async_evaluation": -1, "custom_async_evaluation_function": -1, "_enable_rl_module_api": -1, "auto_wrap_old_gym_envs": -1, "always_attach_evaluation_results": -1, "replay_sequence_length": null, "_disable_execution_plan_api": -1, "use_critic": true, "use_gae": true, "use_kl_loss": true, "kl_coeff": 0.7464963036515, "kl_target": 0.0270990929592, "vf_loss_coeff": 0.6688075857018, "entropy_coeff": 0.0090570820258, "clip_param": 0.1221781641624, "vf_clip_param": 0.1027808522125, "entropy_coeff_schedule": null, "lr_schedule": null, "sgd_minibatch_size": -1, "vf_share_layers": -1, "__stdout_file__": null, "__stderr_file__": null, "lambda": 0.9099046732075, "input": "sampler", "policies": {"default_policy": [null, null, null, null]}, "callbacks": "<class 'ray.rllib.callbacks.callbacks.RLlibCallback'>", "create_env_on_driver": false, "custom_eval_function": null, "framework": "torch"}, "time_since_restore": 59.60639047622681, "iterations_since_restore": 6, "perf": {"cpu_util_percent": 87.35714285714286, "ram_util_percent": 76.92857142857143}}
{"timers": {"training_iteration": 18.590645016783682, "restore_env_runners": 3.432065949727279e-05, "training_step": 18.589794400642077, "env_runner_sampling_timer": 17.44275996434683, "learner_update_timer": 1.0810200545229165, "synch_weights": 0.0433324976502787, "restore_eval_env_runners": 0.000271070252428128, "evaluation_iteration": 1.9884304045806682, "synch_eval_env_connectors": 0.0014668999761831567, "synch_env_connectors": 2.639776343552578e-05}, "env_runners": {"module_to_env_connector": {"timers": {"connectors": {"un_batch_to_individual_items": 1.1957831838122654e-05, "tensor_to_numpy": 3.576795882237298e-05, "normalize_and_clip_actions": 2.5215073355120157e-05, "remove_single_ts_time_rank_from_batch": 1.5805352248173383e-06, "listify_data_for_vector_env": 2.8277973645260662e-05, "get_actions": 0.00013191165928116443}}, "connector_pipeline_timer": 0.00029219479588260327}, "time_between_sampling": 0.004133210394465389, "episode_len_max": 20, "num_env_steps_sampled_lifetime": -3077500.0, "env_to_module_sum_episodes_length_in": 10.36823839457432, "sample": 0.013399320808870826, "num_agent_steps_sampled_lifetime": {"default_agent": -3077500.0}, "episode_len_mean": 20.0, "rlmodule_inference_timer": 8.52964338505185e-05, "num_episodes_lifetime": -153875.0, "num_module_steps_sampled": {"default_policy": 5000.0}, "env_to_module_connector": {"connector_pipeline_timer": 0.0001065587932775329, "timers": {"connectors": {"add_states_from_episodes_to_batch": 3.957597643499951e-06, "batch_individual_items": 1.6481544165190437e-05, "add_observations_from_episodes_to_batch": 8.260904413700875e-06, "add_time_dim_to_batch_and_zero_pad": 6.4022723339529095e-06, "numpy_to_tensor": 2.573795994158262e-05}}}, "module_episode_returns_mean": {"default_policy": 7.54}, "num_agent_steps_sampled": {"default_agent": 5000.0}, "num_episodes": 250.0, "episode_len_min": 20, "env_to_module_sum_episodes_length_out": 10.36823839457432, "num_module_steps_sampled_lifetime": {"default_policy": -3077500.0}, "env_reset_timer": 0.0001101482449605023, "episode_duration_sec_mean": 0.012633908703457564, "episode_return_max": 14.5, "weights_seq_no": 6.0, "env_step_timer": 4.073006205517541e-05, "episode_return_min": -5.5, "agent_episode_returns_mean": {"default_agent": 7.54}, "num_env_steps_sampled": 5000.0, "episode_return_mean": 7.54, "num_env_steps_sampled_lifetime_throughput": 1853.311352830691}, "learners": {"__all_modules__": {"num_non_trainable_parameters": 0, "learner_connector": {"timers": {"connectors": {"add_time_dim_to_batch_and_zero_pad": 0.00020262204705764946, "numpy_to_tensor": 0.00013657947146981873, "general_advantage_estimation": 0.05783193217343961, "add_states_from_episodes_to_batch": 6.529089804988043e-06, "add_one_ts_to_episodes_and_truncate": 0.11048627967557427, "batch_individual_items": 0.3433465479099127, "add_observations_from_episodes_to_batch": 0.0043040186544984005, "add_columns_from_episodes_to_train_batch": 0.3280981437445084}}, "connector_pipeline_timer": 0.8450364846371671}, "learner_connector_sum_episodes_length_in": 5000.0, "num_module_steps_trained": 6000, "num_module_steps_trained_lifetime": 42000, "num_env_steps_trained": 31500, "learner_connector_sum_episodes_length_out": 5250.0, "num_trainable_parameters": 6003, "num_env_steps_trained_lifetime": 220500, "num_env_steps_trained_lifetime_throughput": 535621.207458066, "num_module_steps_trained_throughput": 102356.52498152346, "num_module_steps_trained_lifetime_throughput": 102202.6784525303}, "default_policy": {"module_train_batch_size_mean": 1000.0, "mean_kl_loss": 0.0004201476403977722, "curr_entropy_coeff": 0.0090570820258, "weights_seq_no": 7.0, "num_module_steps_trained": 6000, "curr_kl_coeff": 0.0058320024982094765, "diff_num_grad_updates_vs_sampler_policy": 1.0, "num_module_steps_trained_lifetime": 42000, "vf_loss": 0.100577712059021, "gradients_default_optimizer_global_norm": 0.03081803396344185, "total_loss": -0.14335104823112488, "policy_loss": -0.2045687586069107, "num_trainable_parameters": 6003, "default_optimizer_learning_rate": 0.0002847858517, "vf_explained_var": 0.0011950135231018066, "entropy": 0.6684635877609253, "vf_loss_unclipped": 36.07630157470703, "num_module_steps_trained_lifetime_throughput": 102464.31346333252}}, "num_training_step_calls_per_iteration": 1, "evaluation": {"env_runners": {"module_to_env_connector": {"connector_pipeline_timer": 0.00039905098207179186, "timers": {"connectors": {"remove_single_ts_time_rank_from_batch": 4.137973132745534e-06, "normalize_and_clip_actions": 5.919330023189774e-05, "tensor_to_numpy": 4.581251294410666e-05, "listify_data_for_vector_env": 6.812074139134253e-05, "un_batch_to_individual_items": 1.2987797382018447e-05, "get_actions": 0.00013870354238538354}}}, "env_to_module_connector": {"timers": {"connectors": {"numpy_to_tensor": 3.139463223229759e-05, "add_states_from_episodes_to_batch": 5.115118273536649e-06, "batch_individual_items": 1.934049452033574e-05, "add_observations_from_episodes_to_batch": 6.151801888586374e-06, "add_time_dim_to_batch_and_zero_pad": 5.154296651597018e-06}}, "connector_pipeline_timer": 0.000131806284346733}, "num_episodes": 20, "num_env_steps_sampled": 400, "num_env_steps_sampled_lifetime": 35400, "episode_len_mean": 20.0, "num_module_steps_sampled": {"default_policy": 400}, "episode_return_max": 15.5, "weights_seq_no": 7.0, "episode_len_max": 20, "num_agent_steps_sampled_lifetime": {"default_agent": 2800}, "sample": 1.8117090882212747, "module_episode_returns_mean": {"default_policy": 1.9}, "num_agent_steps_sampled": {"default_agent": 400}, "agent_episode_returns_mean": {"default_agent": 1.9}, "rlmodule_inference_timer": 0.00011416221081304624, "num_episodes_lifetime": 140, "num_module_steps_sampled_lifetime": {"default_policy": 2800}, "episode_len_min": 20, "env_to_module_sum_episodes_length_out": 10.368238394572801, "env_reset_timer": 0.01789725175075399, "episode_duration_sec_mean": 0.012554128800984473, "env_step_timer": 4.8209569207635106e-05, "episode_return_min": -13.5, "episode_return_mean": 1.9, "env_to_module_sum_episodes_length_in": 10.368238394572801, "time_between_sampling": 14.408901683505606}, "num_healthy_workers": 1, "actor_manager_num_outstanding_async_reqs": 0, "num_remote_worker_restarts": 0}, "num_env_steps_sampled_lifetime": -3077500.0, "fault_tolerance": {"num_healthy_workers": 0, "num_remote_worker_restarts": 0}, "env_runner_group": {"actor_manager_num_outstanding_async_reqs": 0}, "done": false, "training_iteration": 7, "trial_id": "497a0_00000", "date": "2025-08-11_19-28-57", "timestamp": 1754933337, "time_this_iter_s": 4.209184885025024, "time_total_s": 63.81557536125183, "pid": 19607, "hostname": "Mac", "node_ip": "127.0.0.1", "config": {"exploration_config": {}, "extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "placement_strategy": "PACK", "num_gpus": 0, "_fake_gpus": false, "num_cpus_for_main_process": 2, "eager_tracing": true, "eager_max_retraces": 20, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "torch_compile_learner": false, "torch_compile_learner_what_to_compile": "forward_train", "torch_compile_learner_dynamo_backend": "aot_eager", "torch_compile_learner_dynamo_mode": null, "torch_compile_worker": false, "torch_compile_worker_dynamo_backend": "aot_eager", "torch_compile_worker_dynamo_mode": null, "torch_ddp_kwargs": {}, "torch_skip_nan_gradients": false, "env": "Umbrella", "env_config": {}, "observation_space": null, "action_space": null, "clip_rewards": null, "normalize_actions": true, "clip_actions": false, "_is_atari": null, "disable_env_checking": false, "render_env": false, "action_mask_key": "action_mask", "env_runner_cls": null, "num_env_runners": 0, "create_local_env_runner": true, "num_envs_per_env_runner": 1, "gym_env_vectorize_mode": "SYNC", "num_cpus_per_env_runner": 1, "num_gpus_per_env_runner": 0, "custom_resources_per_env_runner": {}, "validate_env_runners_after_construction": true, "episodes_to_numpy": true, "max_requests_in_flight_per_env_runner": 1, "sample_timeout_s": 60.0, "_env_to_module_connector": null, "add_default_connectors_to_env_to_module_pipeline": true, "_module_to_env_connector": null, "add_default_connectors_to_module_to_env_pipeline": true, "merge_env_runner_states": "training_only", "broadcast_env_runner_states": true, "episode_lookback_horizon": 1, "rollout_fragment_length": "auto", "batch_mode": "complete_episodes", "compress_observations": false, "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "enable_tf1_exec_eagerly": false, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "preprocessor_pref": "deepmind", "observation_filter": "NoFilter", "update_worker_filter_stats": true, "use_worker_filter_stats": true, "sampler_perf_stats_ema_coef": null, "_is_online": true, "num_learners": 0, "num_gpus_per_learner": 0, "num_cpus_per_learner": "auto", "num_aggregator_actors_per_learner": 0, "max_requests_in_flight_per_aggregator_actor": 3, "local_gpu_idx": 0, "max_requests_in_flight_per_learner": 3, "gamma": 1, "lr": 0.0002847858517, "grad_clip": 0.5, "grad_clip_by": "global_norm", "_train_batch_size_per_learner": 5000, "train_batch_size": 4000, "num_epochs": 1, "minibatch_size": 1000, "shuffle_batch_per_epoch": true, "model": {"fcnet_hiddens": [256, 256], "fcnet_activation": "tanh", "fcnet_weights_initializer": null, "fcnet_weights_initializer_config": null, "fcnet_bias_initializer": null, "fcnet_bias_initializer_config": null, "conv_filters": null, "conv_activation": "relu", "conv_kernel_initializer": null, "conv_kernel_initializer_config": null, "conv_bias_initializer": null, "conv_bias_initializer_config": null, "conv_transpose_kernel_initializer": null, "conv_transpose_kernel_initializer_config": null, "conv_transpose_bias_initializer": null, "conv_transpose_bias_initializer_config": null, "post_fcnet_hiddens": [], "post_fcnet_activation": "relu", "post_fcnet_weights_initializer": null, "post_fcnet_weights_initializer_config": null, "post_fcnet_bias_initializer": null, "post_fcnet_bias_initializer_config": null, "free_log_std": false, "log_std_clip_param": 20.0, "no_final_linear": false, "vf_share_layers": false, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "lstm_weights_initializer": null, "lstm_weights_initializer_config": null, "lstm_bias_initializer": null, "lstm_bias_initializer_config": null, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "attention_use_n_prev_actions": 0, "attention_use_n_prev_rewards": 0, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": null, "custom_model_config": {}, "custom_action_dist": null, "custom_preprocessor": null, "encoder_latent_dim": null, "always_check_shapes": false, "lstm_use_prev_action_reward": -1, "_use_default_native_models": -1, "_disable_preprocessor_api": false, "_disable_action_flattening": false}, "_learner_connector": null, "add_default_connectors_to_learner_pipeline": true, "learner_config_dict": {}, "optimizer": {}, "_learner_class": null, "callbacks_on_algorithm_init": null, "callbacks_on_env_runners_recreated": null, "callbacks_on_offline_eval_runners_recreated": null, "callbacks_on_checkpoint_loaded": null, "callbacks_on_environment_created": null, "callbacks_on_episode_created": null, "callbacks_on_episode_start": null, "callbacks_on_episode_step": null, "callbacks_on_episode_end": null, "callbacks_on_evaluate_start": null, "callbacks_on_evaluate_end": null, "callbacks_on_evaluate_offline_start": null, "callbacks_on_evaluate_offline_end": null, "callbacks_on_sample_end": null, "callbacks_on_train_result": null, "explore": true, "enable_rl_module_and_learner": true, "enable_env_runner_and_connector_v2": true, "_prior_exploration_config": {"type": "StochasticSampling"}, "count_steps_by": "env_steps", "policy_map_capacity": 100, "policy_mapping_fn": "<function AlgorithmConfig.DEFAULT_POLICY_MAPPING_FN at 0x3862edb20>", "policies_to_train": null, "policy_states_are_swappable": false, "observation_fn": null, "offline_data_class": null, "input_read_method": "read_parquet", "input_read_method_kwargs": {}, "input_read_schema": {}, "input_read_episodes": false, "input_read_sample_batches": false, "input_read_batch_size": null, "input_filesystem": null, "input_filesystem_kwargs": {}, "input_compress_columns": ["obs", "new_obs"], "input_spaces_jsonable": true, "materialize_data": false, "materialize_mapped_data": true, "map_batches_kwargs": {}, "iter_batches_kwargs": {}, "ignore_final_observation": false, "prelearner_class": null, "prelearner_buffer_class": null, "prelearner_buffer_kwargs": {}, "prelearner_module_synch_period": 10, "dataset_num_iters_per_learner": null, "input_config": {}, "actions_in_input_normalized": false, "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_config": {}, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "output_max_rows_per_file": null, "output_write_remaining_data": false, "output_write_method": "write_parquet", "output_write_method_kwargs": {}, "output_filesystem": null, "output_filesystem_kwargs": {}, "output_write_episodes": true, "offline_sampling": false, "evaluation_interval": 1, "evaluation_duration": 20, "evaluation_duration_unit": "episodes", "evaluation_sample_timeout_s": 120.0, "evaluation_auto_duration_min_env_steps_per_sample": 100, "evaluation_auto_duration_max_env_steps_per_sample": 2000, "evaluation_parallel_to_training": false, "evaluation_force_reset_envs_before_iteration": true, "evaluation_config": null, "off_policy_estimation_methods": {}, "ope_split_batch_by_episode": true, "evaluation_num_env_runners": 1, "in_evaluation": false, "sync_filters_on_rollout_workers_timeout_s": 10.0, "offline_evaluation_interval": null, "num_offline_eval_runners": 0, "offline_loss_for_module_fn": null, "offline_evaluation_duration": 1, "offline_evaluation_parallel_to_training": false, "offline_evaluation_timeout_s": 120.0, "num_cpus_per_offline_eval_runner": 1, "num_gpus_per_offline_eval_runner": 0, "custom_resources_per_offline_eval_runner": {}, "restart_failed_offline_eval_runners": true, "ignore_offline_eval_runner_failures": false, "max_num_offline_eval_runner_restarts": 1000, "offline_eval_runner_restore_timeout_s": 1800.0, "max_requests_in_flight_per_offline_eval_runner": 1, "validate_offline_eval_runners_after_construction": true, "offline_eval_runner_health_probe_timeout_s": 30.0, "offline_eval_rl_module_inference_only": false, "broadcast_offline_eval_runner_states": false, "offline_eval_batch_size_per_runner": 256, "dataset_num_iters_per_eval_runner": 1, "keep_per_episode_custom_metrics": false, "metrics_episode_collection_timeout_s": 60.0, "metrics_num_episodes_for_smoothing": 100, "min_time_s_per_iteration": null, "min_train_timesteps_per_iteration": 0, "min_sample_timesteps_per_iteration": 0, "log_gradients": true, "export_native_model_files": false, "checkpoint_trainable_policies_only": false, "logger_creator": null, "logger_config": null, "log_level": "WARN", "log_sys_usage": true, "fake_sampler": false, "seed": 9, "restart_failed_env_runners": true, "ignore_env_runner_failures": false, "max_num_env_runner_restarts": 1000, "delay_between_env_runner_restarts_s": 60.0, "restart_failed_sub_environments": false, "num_consecutive_env_runner_failures_tolerance": 100, "env_runner_health_probe_timeout_s": 30.0, "env_runner_restore_timeout_s": 1800.0, "_model_config": {}, "_rl_module_spec": "RLModuleSpec(module_class=None, observation_space=None, action_space=None, inference_only=False, learner_only=False, model_config=DefaultModelConfig(fcnet_hiddens=[60, 90], fcnet_activation='tanh', fcnet_kernel_initializer=None, fcnet_kernel_initializer_kwargs=None, fcnet_bias_initializer=None, fcnet_bias_initializer_kwargs=None, conv_filters=None, conv_activation='relu', conv_kernel_initializer=None, conv_kernel_initializer_kwargs=None, conv_bias_initializer=None, conv_bias_initializer_kwargs=None, head_fcnet_hiddens=[], head_fcnet_activation='relu', head_fcnet_kernel_initializer=None, head_fcnet_kernel_initializer_kwargs=None, head_fcnet_bias_initializer=None, head_fcnet_bias_initializer_kwargs=None, free_log_std=False, log_std_clip_param=20.0, vf_share_layers=True, use_lstm=False, max_seq_len=20, lstm_cell_size=256, lstm_use_prev_action=False, lstm_use_prev_reward=False, lstm_kernel_initializer=None, lstm_kernel_initializer_kwargs=None, lstm_bias_initializer=None, lstm_bias_initializer_kwargs=None), catalog_class=None, load_state_path=None, model_config_dict=None)", "algorithm_config_overrides_per_module": {}, "_per_module_overrides": {}, "_validate_config": true, "_use_msgpack_checkpoints": false, "_torch_grad_scaler_class": null, "_torch_lr_scheduler_classes": null, "_tf_policy_handles_more_than_one_loss": false, "_disable_preprocessor_api": false, "_disable_action_flattening": false, "_disable_initialize_loss_from_dummy_batch": false, "_dont_auto_sync_env_runner_states": false, "env_task_fn": -1, "enable_connectors": -1, "simple_optimizer": false, "policy_map_cache": -1, "worker_cls": -1, "synchronize_filters": -1, "enable_async_evaluation": -1, "custom_async_evaluation_function": -1, "_enable_rl_module_api": -1, "auto_wrap_old_gym_envs": -1, "always_attach_evaluation_results": -1, "replay_sequence_length": null, "_disable_execution_plan_api": -1, "use_critic": true, "use_gae": true, "use_kl_loss": true, "kl_coeff": 0.7464963036515, "kl_target": 0.0270990929592, "vf_loss_coeff": 0.6688075857018, "entropy_coeff": 0.0090570820258, "clip_param": 0.1221781641624, "vf_clip_param": 0.1027808522125, "entropy_coeff_schedule": null, "lr_schedule": null, "sgd_minibatch_size": -1, "vf_share_layers": -1, "__stdout_file__": null, "__stderr_file__": null, "lambda": 0.9099046732075, "input": "sampler", "policies": {"default_policy": [null, null, null, null]}, "callbacks": "<class 'ray.rllib.callbacks.callbacks.RLlibCallback'>", "create_env_on_driver": false, "custom_eval_function": null, "framework": "torch"}, "time_since_restore": 63.81557536125183, "iterations_since_restore": 7, "perf": {"cpu_util_percent": 85.58333333333333, "ram_util_percent": 76.96666666666667}}
{"timers": {"training_iteration": 18.469300688696087, "restore_env_runners": 3.40432927517125e-05, "training_step": 18.468453780384834, "env_runner_sampling_timer": 17.328800535122696, "learner_update_timer": 1.0741936981482672, "synch_weights": 0.04293321101328461, "restore_eval_env_runners": 0.00026843120935519726, "evaluation_iteration": 1.9717178763753171, "synch_eval_env_connectors": 0.0014603655657190221, "synch_env_connectors": 2.6182115622026972e-05}, "env_runners": {"module_to_env_connector": {"timers": {"connectors": {"un_batch_to_individual_items": 2.0219645754625222e-05, "tensor_to_numpy": 6.117246127924417e-05, "normalize_and_clip_actions": 3.5561259856305006e-05, "remove_single_ts_time_rank_from_batch": 1.7140947235494553e-06, "listify_data_for_vector_env": 3.627648645457432e-05, "get_actions": 0.00021052195864819587}}, "connector_pipeline_timer": 0.00046164743794185973}, "time_between_sampling": 0.003801949582519243, "episode_len_max": 20, "num_env_steps_sampled_lifetime": -3695000.0, "env_to_module_sum_episodes_length_in": 10.36823839457432, "sample": 0.01614047821686566, "num_agent_steps_sampled_lifetime": {"default_agent": -3695000.0}, "episode_len_mean": 20.0, "rlmodule_inference_timer": 0.00014719956911037665, "num_episodes_lifetime": -184750.0, "num_module_steps_sampled": {"default_policy": 5000.0}, "env_to_module_connector": {"connector_pipeline_timer": 0.00015784939284443068, "timers": {"connectors": {"add_states_from_episodes_to_batch": 5.22306140835449e-06, "batch_individual_items": 2.5646612245418993e-05, "add_observations_from_episodes_to_batch": 1.4055194439962522e-05, "add_time_dim_to_batch_and_zero_pad": 1.0963512735061203e-05, "numpy_to_tensor": 3.990571900455321e-05}}}, "module_episode_returns_mean": {"default_policy": 8.419999999999998}, "num_agent_steps_sampled": {"default_agent": 5000.0}, "num_episodes": 250.0, "episode_len_min": 20, "env_to_module_sum_episodes_length_out": 10.36823839457432, "num_module_steps_sampled_lifetime": {"default_policy": -3695000.0}, "env_reset_timer": 0.00011563198258931787, "episode_duration_sec_mean": 0.02017688433406875, "episode_return_max": 14.5, "weights_seq_no": 7.0, "env_step_timer": 6.115186828300292e-05, "episode_return_min": -5.5, "agent_episode_returns_mean": {"default_agent": 8.419999999999998}, "num_env_steps_sampled": 5000.0, "episode_return_mean": 8.419999999999998, "num_env_steps_sampled_lifetime_throughput": 1540.5022253618897}, "learners": {"__all_modules__": {"num_non_trainable_parameters": 0, "learner_connector": {"timers": {"connectors": {"add_time_dim_to_batch_and_zero_pad": 0.00020136041680946147, "numpy_to_tensor": 0.00013609617590791504, "general_advantage_estimation": 0.057384419521763735, "add_states_from_episodes_to_batch": 6.5579591116914425e-06, "add_one_ts_to_episodes_and_truncate": 0.10955271021804493, "batch_individual_items": 0.3409401182604247, "add_observations_from_episodes_to_batch": 0.004277650138554189, "add_columns_from_episodes_to_train_batch": 0.3260347448064389}}, "connector_pipeline_timer": 0.8391538331306085}, "learner_connector_sum_episodes_length_in": 5000.0, "num_module_steps_trained": 6000, "num_module_steps_trained_lifetime": 48000, "num_env_steps_trained": 31500, "learner_connector_sum_episodes_length_out": 5250.0, "num_trainable_parameters": 6003, "num_env_steps_trained_lifetime": 252000, "num_env_steps_trained_lifetime_throughput": 552974.343375355, "num_module_steps_trained_throughput": 105690.69927651211, "num_module_steps_trained_lifetime_throughput": 105507.58579342699}, "default_policy": {"module_train_batch_size_mean": 1000.0, "mean_kl_loss": 0.0003812006616499275, "curr_entropy_coeff": 0.0090570820258, "weights_seq_no": 8.0, "num_module_steps_trained": 6000, "curr_kl_coeff": 0.0029160012491047382, "diff_num_grad_updates_vs_sampler_policy": 1.0, "num_module_steps_trained_lifetime": 48000, "vf_loss": 0.10039109736680984, "gradients_default_optimizer_global_norm": 0.0560244545340538, "total_loss": -0.045362912118434906, "policy_loss": -0.10652390867471695, "num_trainable_parameters": 6003, "default_optimizer_learning_rate": 0.0002847858517, "vf_explained_var": 0.0018621087074279785, "entropy": 0.6606499552726746, "vf_loss_unclipped": 35.76835250854492, "num_module_steps_trained_lifetime_throughput": 105798.49640072754}}, "num_training_step_calls_per_iteration": 1, "evaluation": {"env_runners": {"module_to_env_connector": {"connector_pipeline_timer": 0.0004086373861991171, "timers": {"connectors": {"remove_single_ts_time_rank_from_batch": 1.4707440664377237e-06, "normalize_and_clip_actions": 3.251616183969359e-05, "tensor_to_numpy": 4.83951525796324e-05, "listify_data_for_vector_env": 3.2087936648167724e-05, "un_batch_to_individual_items": 1.6577392872754803e-05, "get_actions": 0.00018588853061710428}}}, "env_to_module_connector": {"timers": {"connectors": {"numpy_to_tensor": 4.140728219531261e-05, "add_states_from_episodes_to_batch": 3.589757522931736e-06, "batch_individual_items": 1.9876183356289062e-05, "add_observations_from_episodes_to_batch": 1.0282938517165639e-05, "add_time_dim_to_batch_and_zero_pad": 6.5299454796986695e-06}}, "connector_pipeline_timer": 0.00014050749192824602}, "num_episodes": 20, "num_env_steps_sampled": 400, "num_env_steps_sampled_lifetime": 40400, "episode_len_mean": 20.0, "num_module_steps_sampled": {"default_policy": 400}, "episode_return_max": 15.5, "weights_seq_no": 8.0, "episode_len_max": 20, "num_agent_steps_sampled_lifetime": {"default_agent": 3200}, "sample": 1.8002265506688482, "module_episode_returns_mean": {"default_policy": 2.3}, "num_agent_steps_sampled": {"default_agent": 400}, "agent_episode_returns_mean": {"default_agent": 2.3}, "rlmodule_inference_timer": 0.00010823824083539235, "num_episodes_lifetime": 160, "num_module_steps_sampled_lifetime": {"default_policy": 3200}, "episode_len_min": 20, "env_to_module_sum_episodes_length_out": 10.3682383945743, "env_reset_timer": 0.017725397982445885, "episode_duration_sec_mean": 0.015027610912220553, "env_step_timer": 7.338931610676988e-05, "episode_return_min": -13.5, "episode_return_mean": 2.3, "env_to_module_sum_episodes_length_in": 10.3682383945743, "time_between_sampling": 14.329896667091306}, "num_healthy_workers": 1, "actor_manager_num_outstanding_async_reqs": 0, "num_remote_worker_restarts": 0}, "num_env_steps_sampled_lifetime": -3695000.0, "fault_tolerance": {"num_healthy_workers": 0, "num_remote_worker_restarts": 0}, "env_runner_group": {"actor_manager_num_outstanding_async_reqs": 0}, "done": false, "training_iteration": 8, "trial_id": "497a0_00000", "date": "2025-08-11_19-29-04", "timestamp": 1754933344, "time_this_iter_s": 7.218325614929199, "time_total_s": 71.03390097618103, "pid": 19607, "hostname": "Mac", "node_ip": "127.0.0.1", "config": {"exploration_config": {}, "extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "placement_strategy": "PACK", "num_gpus": 0, "_fake_gpus": false, "num_cpus_for_main_process": 2, "eager_tracing": true, "eager_max_retraces": 20, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "torch_compile_learner": false, "torch_compile_learner_what_to_compile": "forward_train", "torch_compile_learner_dynamo_backend": "aot_eager", "torch_compile_learner_dynamo_mode": null, "torch_compile_worker": false, "torch_compile_worker_dynamo_backend": "aot_eager", "torch_compile_worker_dynamo_mode": null, "torch_ddp_kwargs": {}, "torch_skip_nan_gradients": false, "env": "Umbrella", "env_config": {}, "observation_space": null, "action_space": null, "clip_rewards": null, "normalize_actions": true, "clip_actions": false, "_is_atari": null, "disable_env_checking": false, "render_env": false, "action_mask_key": "action_mask", "env_runner_cls": null, "num_env_runners": 0, "create_local_env_runner": true, "num_envs_per_env_runner": 1, "gym_env_vectorize_mode": "SYNC", "num_cpus_per_env_runner": 1, "num_gpus_per_env_runner": 0, "custom_resources_per_env_runner": {}, "validate_env_runners_after_construction": true, "episodes_to_numpy": true, "max_requests_in_flight_per_env_runner": 1, "sample_timeout_s": 60.0, "_env_to_module_connector": null, "add_default_connectors_to_env_to_module_pipeline": true, "_module_to_env_connector": null, "add_default_connectors_to_module_to_env_pipeline": true, "merge_env_runner_states": "training_only", "broadcast_env_runner_states": true, "episode_lookback_horizon": 1, "rollout_fragment_length": "auto", "batch_mode": "complete_episodes", "compress_observations": false, "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "enable_tf1_exec_eagerly": false, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "preprocessor_pref": "deepmind", "observation_filter": "NoFilter", "update_worker_filter_stats": true, "use_worker_filter_stats": true, "sampler_perf_stats_ema_coef": null, "_is_online": true, "num_learners": 0, "num_gpus_per_learner": 0, "num_cpus_per_learner": "auto", "num_aggregator_actors_per_learner": 0, "max_requests_in_flight_per_aggregator_actor": 3, "local_gpu_idx": 0, "max_requests_in_flight_per_learner": 3, "gamma": 1, "lr": 0.0002847858517, "grad_clip": 0.5, "grad_clip_by": "global_norm", "_train_batch_size_per_learner": 5000, "train_batch_size": 4000, "num_epochs": 1, "minibatch_size": 1000, "shuffle_batch_per_epoch": true, "model": {"fcnet_hiddens": [256, 256], "fcnet_activation": "tanh", "fcnet_weights_initializer": null, "fcnet_weights_initializer_config": null, "fcnet_bias_initializer": null, "fcnet_bias_initializer_config": null, "conv_filters": null, "conv_activation": "relu", "conv_kernel_initializer": null, "conv_kernel_initializer_config": null, "conv_bias_initializer": null, "conv_bias_initializer_config": null, "conv_transpose_kernel_initializer": null, "conv_transpose_kernel_initializer_config": null, "conv_transpose_bias_initializer": null, "conv_transpose_bias_initializer_config": null, "post_fcnet_hiddens": [], "post_fcnet_activation": "relu", "post_fcnet_weights_initializer": null, "post_fcnet_weights_initializer_config": null, "post_fcnet_bias_initializer": null, "post_fcnet_bias_initializer_config": null, "free_log_std": false, "log_std_clip_param": 20.0, "no_final_linear": false, "vf_share_layers": false, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "lstm_weights_initializer": null, "lstm_weights_initializer_config": null, "lstm_bias_initializer": null, "lstm_bias_initializer_config": null, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "attention_use_n_prev_actions": 0, "attention_use_n_prev_rewards": 0, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": null, "custom_model_config": {}, "custom_action_dist": null, "custom_preprocessor": null, "encoder_latent_dim": null, "always_check_shapes": false, "lstm_use_prev_action_reward": -1, "_use_default_native_models": -1, "_disable_preprocessor_api": false, "_disable_action_flattening": false}, "_learner_connector": null, "add_default_connectors_to_learner_pipeline": true, "learner_config_dict": {}, "optimizer": {}, "_learner_class": null, "callbacks_on_algorithm_init": null, "callbacks_on_env_runners_recreated": null, "callbacks_on_offline_eval_runners_recreated": null, "callbacks_on_checkpoint_loaded": null, "callbacks_on_environment_created": null, "callbacks_on_episode_created": null, "callbacks_on_episode_start": null, "callbacks_on_episode_step": null, "callbacks_on_episode_end": null, "callbacks_on_evaluate_start": null, "callbacks_on_evaluate_end": null, "callbacks_on_evaluate_offline_start": null, "callbacks_on_evaluate_offline_end": null, "callbacks_on_sample_end": null, "callbacks_on_train_result": null, "explore": true, "enable_rl_module_and_learner": true, "enable_env_runner_and_connector_v2": true, "_prior_exploration_config": {"type": "StochasticSampling"}, "count_steps_by": "env_steps", "policy_map_capacity": 100, "policy_mapping_fn": "<function AlgorithmConfig.DEFAULT_POLICY_MAPPING_FN at 0x3862edb20>", "policies_to_train": null, "policy_states_are_swappable": false, "observation_fn": null, "offline_data_class": null, "input_read_method": "read_parquet", "input_read_method_kwargs": {}, "input_read_schema": {}, "input_read_episodes": false, "input_read_sample_batches": false, "input_read_batch_size": null, "input_filesystem": null, "input_filesystem_kwargs": {}, "input_compress_columns": ["obs", "new_obs"], "input_spaces_jsonable": true, "materialize_data": false, "materialize_mapped_data": true, "map_batches_kwargs": {}, "iter_batches_kwargs": {}, "ignore_final_observation": false, "prelearner_class": null, "prelearner_buffer_class": null, "prelearner_buffer_kwargs": {}, "prelearner_module_synch_period": 10, "dataset_num_iters_per_learner": null, "input_config": {}, "actions_in_input_normalized": false, "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_config": {}, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "output_max_rows_per_file": null, "output_write_remaining_data": false, "output_write_method": "write_parquet", "output_write_method_kwargs": {}, "output_filesystem": null, "output_filesystem_kwargs": {}, "output_write_episodes": true, "offline_sampling": false, "evaluation_interval": 1, "evaluation_duration": 20, "evaluation_duration_unit": "episodes", "evaluation_sample_timeout_s": 120.0, "evaluation_auto_duration_min_env_steps_per_sample": 100, "evaluation_auto_duration_max_env_steps_per_sample": 2000, "evaluation_parallel_to_training": false, "evaluation_force_reset_envs_before_iteration": true, "evaluation_config": null, "off_policy_estimation_methods": {}, "ope_split_batch_by_episode": true, "evaluation_num_env_runners": 1, "in_evaluation": false, "sync_filters_on_rollout_workers_timeout_s": 10.0, "offline_evaluation_interval": null, "num_offline_eval_runners": 0, "offline_loss_for_module_fn": null, "offline_evaluation_duration": 1, "offline_evaluation_parallel_to_training": false, "offline_evaluation_timeout_s": 120.0, "num_cpus_per_offline_eval_runner": 1, "num_gpus_per_offline_eval_runner": 0, "custom_resources_per_offline_eval_runner": {}, "restart_failed_offline_eval_runners": true, "ignore_offline_eval_runner_failures": false, "max_num_offline_eval_runner_restarts": 1000, "offline_eval_runner_restore_timeout_s": 1800.0, "max_requests_in_flight_per_offline_eval_runner": 1, "validate_offline_eval_runners_after_construction": true, "offline_eval_runner_health_probe_timeout_s": 30.0, "offline_eval_rl_module_inference_only": false, "broadcast_offline_eval_runner_states": false, "offline_eval_batch_size_per_runner": 256, "dataset_num_iters_per_eval_runner": 1, "keep_per_episode_custom_metrics": false, "metrics_episode_collection_timeout_s": 60.0, "metrics_num_episodes_for_smoothing": 100, "min_time_s_per_iteration": null, "min_train_timesteps_per_iteration": 0, "min_sample_timesteps_per_iteration": 0, "log_gradients": true, "export_native_model_files": false, "checkpoint_trainable_policies_only": false, "logger_creator": null, "logger_config": null, "log_level": "WARN", "log_sys_usage": true, "fake_sampler": false, "seed": 9, "restart_failed_env_runners": true, "ignore_env_runner_failures": false, "max_num_env_runner_restarts": 1000, "delay_between_env_runner_restarts_s": 60.0, "restart_failed_sub_environments": false, "num_consecutive_env_runner_failures_tolerance": 100, "env_runner_health_probe_timeout_s": 30.0, "env_runner_restore_timeout_s": 1800.0, "_model_config": {}, "_rl_module_spec": "RLModuleSpec(module_class=None, observation_space=None, action_space=None, inference_only=False, learner_only=False, model_config=DefaultModelConfig(fcnet_hiddens=[60, 90], fcnet_activation='tanh', fcnet_kernel_initializer=None, fcnet_kernel_initializer_kwargs=None, fcnet_bias_initializer=None, fcnet_bias_initializer_kwargs=None, conv_filters=None, conv_activation='relu', conv_kernel_initializer=None, conv_kernel_initializer_kwargs=None, conv_bias_initializer=None, conv_bias_initializer_kwargs=None, head_fcnet_hiddens=[], head_fcnet_activation='relu', head_fcnet_kernel_initializer=None, head_fcnet_kernel_initializer_kwargs=None, head_fcnet_bias_initializer=None, head_fcnet_bias_initializer_kwargs=None, free_log_std=False, log_std_clip_param=20.0, vf_share_layers=True, use_lstm=False, max_seq_len=20, lstm_cell_size=256, lstm_use_prev_action=False, lstm_use_prev_reward=False, lstm_kernel_initializer=None, lstm_kernel_initializer_kwargs=None, lstm_bias_initializer=None, lstm_bias_initializer_kwargs=None), catalog_class=None, load_state_path=None, model_config_dict=None)", "algorithm_config_overrides_per_module": {}, "_per_module_overrides": {}, "_validate_config": true, "_use_msgpack_checkpoints": false, "_torch_grad_scaler_class": null, "_torch_lr_scheduler_classes": null, "_tf_policy_handles_more_than_one_loss": false, "_disable_preprocessor_api": false, "_disable_action_flattening": false, "_disable_initialize_loss_from_dummy_batch": false, "_dont_auto_sync_env_runner_states": false, "env_task_fn": -1, "enable_connectors": -1, "simple_optimizer": false, "policy_map_cache": -1, "worker_cls": -1, "synchronize_filters": -1, "enable_async_evaluation": -1, "custom_async_evaluation_function": -1, "_enable_rl_module_api": -1, "auto_wrap_old_gym_envs": -1, "always_attach_evaluation_results": -1, "replay_sequence_length": null, "_disable_execution_plan_api": -1, "use_critic": true, "use_gae": true, "use_kl_loss": true, "kl_coeff": 0.7464963036515, "kl_target": 0.0270990929592, "vf_loss_coeff": 0.6688075857018, "entropy_coeff": 0.0090570820258, "clip_param": 0.1221781641624, "vf_clip_param": 0.1027808522125, "entropy_coeff_schedule": null, "lr_schedule": null, "sgd_minibatch_size": -1, "vf_share_layers": -1, "__stdout_file__": null, "__stderr_file__": null, "lambda": 0.9099046732075, "input": "sampler", "policies": {"default_policy": [null, null, null, null]}, "callbacks": "<class 'ray.rllib.callbacks.callbacks.RLlibCallback'>", "create_env_on_driver": false, "custom_eval_function": null, "framework": "torch"}, "time_since_restore": 71.03390097618103, "iterations_since_restore": 8, "perf": {"cpu_util_percent": 92.5, "ram_util_percent": 78.43}}
{"timers": {"training_iteration": 18.336147847639065, "restore_env_runners": 3.384828002345549e-05, "training_step": 18.3353067367503, "env_runner_sampling_timer": 17.202502286431073, "learner_update_timer": 1.0679319440864357, "synch_weights": 0.04252448598322952, "restore_eval_env_runners": 0.0002663381473981399, "evaluation_iteration": 1.9595424626117695, "synch_eval_env_connectors": 0.001448009830554496, "synch_env_connectors": 2.6553204989370325e-05}, "env_runners": {"module_to_env_connector": {"timers": {"connectors": {"un_batch_to_individual_items": 2.1026557319684222e-05, "tensor_to_numpy": 5.2551915471359126e-05, "normalize_and_clip_actions": 3.48677130289137e-05, "remove_single_ts_time_rank_from_batch": 1.3697893696439698e-06, "listify_data_for_vector_env": 3.6189234831641195e-05, "get_actions": 0.00017850092872410226}}, "connector_pipeline_timer": 0.0004089637809332558}, "time_between_sampling": 0.007658375510330327, "episode_len_max": 20, "num_env_steps_sampled_lifetime": -4312500.0, "env_to_module_sum_episodes_length_in": 10.36823839457432, "sample": 0.020999089442169046, "num_agent_steps_sampled_lifetime": {"default_agent": -4312500.0}, "episode_len_mean": 20.0, "rlmodule_inference_timer": 0.00010505825142218029, "num_episodes_lifetime": -215625.0, "num_module_steps_sampled": {"default_policy": 5000.0}, "env_to_module_connector": {"connector_pipeline_timer": 0.00012958792496210275, "timers": {"connectors": {"add_states_from_episodes_to_batch": 3.989441140645388e-06, "batch_individual_items": 2.0373411284662444e-05, "add_observations_from_episodes_to_batch": 9.667657693456903e-06, "add_time_dim_to_batch_and_zero_pad": 6.747780804570842e-06, "numpy_to_tensor": 3.288803913614349e-05}}}, "module_episode_returns_mean": {"default_policy": 8.419999999999998}, "num_agent_steps_sampled": {"default_agent": 5000.0}, "num_episodes": 250.0, "episode_len_min": 20, "env_to_module_sum_episodes_length_out": 10.36823839457432, "num_module_steps_sampled_lifetime": {"default_policy": -4312500.0}, "env_reset_timer": 0.00014635130063994279, "episode_duration_sec_mean": 0.01587250086152926, "episode_return_max": 14.5, "weights_seq_no": 8.0, "env_step_timer": 5.2181613136306965e-05, "episode_return_min": -5.5, "agent_episode_returns_mean": {"default_agent": 8.419999999999998}, "num_env_steps_sampled": 5000.0, "episode_return_mean": 8.419999999999998, "num_env_steps_sampled_lifetime_throughput": 1560.680649129502}, "learners": {"__all_modules__": {"num_non_trainable_parameters": 0, "learner_connector": {"timers": {"connectors": {"add_time_dim_to_batch_and_zero_pad": 0.00019977265290369047, "numpy_to_tensor": 0.00013742021363899267, "general_advantage_estimation": 0.05689331615680363, "add_states_from_episodes_to_batch": 6.59070855800243e-06, "add_one_ts_to_episodes_and_truncate": 0.110895637286343, "batch_individual_items": 0.3381376629077521, "add_observations_from_episodes_to_batch": 0.004254419477500932, "add_columns_from_episodes_to_train_batch": 0.3236821973592339}}, "connector_pipeline_timer": 0.8348247731285903}, "learner_connector_sum_episodes_length_in": 5000.0, "num_module_steps_trained": 6000, "num_module_steps_trained_lifetime": 54000, "num_env_steps_trained": 31500, "learner_connector_sum_episodes_length_out": 5250.0, "num_trainable_parameters": 6003, "num_env_steps_trained_lifetime": 283500, "num_env_steps_trained_lifetime_throughput": 566281.4535540768, "num_module_steps_trained_throughput": 108237.73819034081, "num_module_steps_trained_lifetime_throughput": 108036.43223412466}, "default_policy": {"module_train_batch_size_mean": 1000.0, "mean_kl_loss": 0.00035186053719371557, "curr_entropy_coeff": 0.0090570820258, "weights_seq_no": 9.0, "num_module_steps_trained": 6000, "curr_kl_coeff": 0.0014580006245523691, "diff_num_grad_updates_vs_sampler_policy": 1.0, "num_module_steps_trained_lifetime": 54000, "vf_loss": 0.10038838535547256, "gradients_default_optimizer_global_norm": 0.0056614866480231285, "total_loss": -0.02790551446378231, "policy_loss": -0.0891357809305191, "num_trainable_parameters": 6003, "default_optimizer_learning_rate": 0.0002847858517, "vf_explained_var": 0.0028856992721557617, "entropy": 0.6526697874069214, "vf_loss_unclipped": 35.71833038330078, "num_module_steps_trained_lifetime_throughput": 108342.64738655838}}, "num_training_step_calls_per_iteration": 1, "evaluation": {"env_runners": {"module_to_env_connector": {"connector_pipeline_timer": 0.0005743628296297461, "timers": {"connectors": {"remove_single_ts_time_rank_from_batch": 1.3096407741793916e-06, "normalize_and_clip_actions": 3.250402806649301e-05, "tensor_to_numpy": 5.260847188543225e-05, "listify_data_for_vector_env": 0.00019096178368220012, "un_batch_to_individual_items": 1.59109626337977e-05, "get_actions": 0.00019838530949970742}}}, "env_to_module_connector": {"timers": {"connectors": {"numpy_to_tensor": 3.62384279510338e-05, "add_states_from_episodes_to_batch": 3.8447781905847465e-06, "batch_individual_items": 3.5316293643837434e-05, "add_observations_from_episodes_to_batch": 1.2768320492362675e-05, "add_time_dim_to_batch_and_zero_pad": 8.325674452588716e-06}}, "connector_pipeline_timer": 0.00017231295811853412}, "num_episodes": 20, "num_env_steps_sampled": 400, "num_env_steps_sampled_lifetime": 45400, "episode_len_mean": 20.0, "num_module_steps_sampled": {"default_policy": 400}, "episode_return_max": 15.5, "weights_seq_no": 9.0, "episode_len_max": 20, "num_agent_steps_sampled_lifetime": {"default_agent": 3600}, "sample": 1.7854107426615557, "module_episode_returns_mean": {"default_policy": 2.9}, "num_agent_steps_sampled": {"default_agent": 400}, "agent_episode_returns_mean": {"default_agent": 2.9}, "rlmodule_inference_timer": 0.00012345003772541076, "num_episodes_lifetime": 180, "num_module_steps_sampled_lifetime": {"default_policy": 3600}, "episode_len_min": 20, "env_to_module_sum_episodes_length_out": 10.368238394574323, "env_reset_timer": 0.017550028582745594, "episode_duration_sec_mean": 0.01563098591286689, "env_step_timer": 9.407443455510629e-05, "episode_return_min": -13.5, "episode_return_mean": 2.9, "env_to_module_sum_episodes_length_in": 10.368238394574323, "time_between_sampling": 14.239372078750607}, "num_healthy_workers": 1, "actor_manager_num_outstanding_async_reqs": 0, "num_remote_worker_restarts": 0}, "num_env_steps_sampled_lifetime": -4312500.0, "fault_tolerance": {"num_healthy_workers": 0, "num_remote_worker_restarts": 0}, "env_runner_group": {"actor_manager_num_outstanding_async_reqs": 0}, "done": false, "training_iteration": 9, "trial_id": "497a0_00000", "date": "2025-08-11_19-29-10", "timestamp": 1754933350, "time_this_iter_s": 5.516952991485596, "time_total_s": 76.55085396766663, "pid": 19607, "hostname": "Mac", "node_ip": "127.0.0.1", "config": {"exploration_config": {}, "extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "placement_strategy": "PACK", "num_gpus": 0, "_fake_gpus": false, "num_cpus_for_main_process": 2, "eager_tracing": true, "eager_max_retraces": 20, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "torch_compile_learner": false, "torch_compile_learner_what_to_compile": "forward_train", "torch_compile_learner_dynamo_backend": "aot_eager", "torch_compile_learner_dynamo_mode": null, "torch_compile_worker": false, "torch_compile_worker_dynamo_backend": "aot_eager", "torch_compile_worker_dynamo_mode": null, "torch_ddp_kwargs": {}, "torch_skip_nan_gradients": false, "env": "Umbrella", "env_config": {}, "observation_space": null, "action_space": null, "clip_rewards": null, "normalize_actions": true, "clip_actions": false, "_is_atari": null, "disable_env_checking": false, "render_env": false, "action_mask_key": "action_mask", "env_runner_cls": null, "num_env_runners": 0, "create_local_env_runner": true, "num_envs_per_env_runner": 1, "gym_env_vectorize_mode": "SYNC", "num_cpus_per_env_runner": 1, "num_gpus_per_env_runner": 0, "custom_resources_per_env_runner": {}, "validate_env_runners_after_construction": true, "episodes_to_numpy": true, "max_requests_in_flight_per_env_runner": 1, "sample_timeout_s": 60.0, "_env_to_module_connector": null, "add_default_connectors_to_env_to_module_pipeline": true, "_module_to_env_connector": null, "add_default_connectors_to_module_to_env_pipeline": true, "merge_env_runner_states": "training_only", "broadcast_env_runner_states": true, "episode_lookback_horizon": 1, "rollout_fragment_length": "auto", "batch_mode": "complete_episodes", "compress_observations": false, "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "enable_tf1_exec_eagerly": false, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "preprocessor_pref": "deepmind", "observation_filter": "NoFilter", "update_worker_filter_stats": true, "use_worker_filter_stats": true, "sampler_perf_stats_ema_coef": null, "_is_online": true, "num_learners": 0, "num_gpus_per_learner": 0, "num_cpus_per_learner": "auto", "num_aggregator_actors_per_learner": 0, "max_requests_in_flight_per_aggregator_actor": 3, "local_gpu_idx": 0, "max_requests_in_flight_per_learner": 3, "gamma": 1, "lr": 0.0002847858517, "grad_clip": 0.5, "grad_clip_by": "global_norm", "_train_batch_size_per_learner": 5000, "train_batch_size": 4000, "num_epochs": 1, "minibatch_size": 1000, "shuffle_batch_per_epoch": true, "model": {"fcnet_hiddens": [256, 256], "fcnet_activation": "tanh", "fcnet_weights_initializer": null, "fcnet_weights_initializer_config": null, "fcnet_bias_initializer": null, "fcnet_bias_initializer_config": null, "conv_filters": null, "conv_activation": "relu", "conv_kernel_initializer": null, "conv_kernel_initializer_config": null, "conv_bias_initializer": null, "conv_bias_initializer_config": null, "conv_transpose_kernel_initializer": null, "conv_transpose_kernel_initializer_config": null, "conv_transpose_bias_initializer": null, "conv_transpose_bias_initializer_config": null, "post_fcnet_hiddens": [], "post_fcnet_activation": "relu", "post_fcnet_weights_initializer": null, "post_fcnet_weights_initializer_config": null, "post_fcnet_bias_initializer": null, "post_fcnet_bias_initializer_config": null, "free_log_std": false, "log_std_clip_param": 20.0, "no_final_linear": false, "vf_share_layers": false, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "lstm_weights_initializer": null, "lstm_weights_initializer_config": null, "lstm_bias_initializer": null, "lstm_bias_initializer_config": null, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "attention_use_n_prev_actions": 0, "attention_use_n_prev_rewards": 0, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": null, "custom_model_config": {}, "custom_action_dist": null, "custom_preprocessor": null, "encoder_latent_dim": null, "always_check_shapes": false, "lstm_use_prev_action_reward": -1, "_use_default_native_models": -1, "_disable_preprocessor_api": false, "_disable_action_flattening": false}, "_learner_connector": null, "add_default_connectors_to_learner_pipeline": true, "learner_config_dict": {}, "optimizer": {}, "_learner_class": null, "callbacks_on_algorithm_init": null, "callbacks_on_env_runners_recreated": null, "callbacks_on_offline_eval_runners_recreated": null, "callbacks_on_checkpoint_loaded": null, "callbacks_on_environment_created": null, "callbacks_on_episode_created": null, "callbacks_on_episode_start": null, "callbacks_on_episode_step": null, "callbacks_on_episode_end": null, "callbacks_on_evaluate_start": null, "callbacks_on_evaluate_end": null, "callbacks_on_evaluate_offline_start": null, "callbacks_on_evaluate_offline_end": null, "callbacks_on_sample_end": null, "callbacks_on_train_result": null, "explore": true, "enable_rl_module_and_learner": true, "enable_env_runner_and_connector_v2": true, "_prior_exploration_config": {"type": "StochasticSampling"}, "count_steps_by": "env_steps", "policy_map_capacity": 100, "policy_mapping_fn": "<function AlgorithmConfig.DEFAULT_POLICY_MAPPING_FN at 0x3862edb20>", "policies_to_train": null, "policy_states_are_swappable": false, "observation_fn": null, "offline_data_class": null, "input_read_method": "read_parquet", "input_read_method_kwargs": {}, "input_read_schema": {}, "input_read_episodes": false, "input_read_sample_batches": false, "input_read_batch_size": null, "input_filesystem": null, "input_filesystem_kwargs": {}, "input_compress_columns": ["obs", "new_obs"], "input_spaces_jsonable": true, "materialize_data": false, "materialize_mapped_data": true, "map_batches_kwargs": {}, "iter_batches_kwargs": {}, "ignore_final_observation": false, "prelearner_class": null, "prelearner_buffer_class": null, "prelearner_buffer_kwargs": {}, "prelearner_module_synch_period": 10, "dataset_num_iters_per_learner": null, "input_config": {}, "actions_in_input_normalized": false, "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_config": {}, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "output_max_rows_per_file": null, "output_write_remaining_data": false, "output_write_method": "write_parquet", "output_write_method_kwargs": {}, "output_filesystem": null, "output_filesystem_kwargs": {}, "output_write_episodes": true, "offline_sampling": false, "evaluation_interval": 1, "evaluation_duration": 20, "evaluation_duration_unit": "episodes", "evaluation_sample_timeout_s": 120.0, "evaluation_auto_duration_min_env_steps_per_sample": 100, "evaluation_auto_duration_max_env_steps_per_sample": 2000, "evaluation_parallel_to_training": false, "evaluation_force_reset_envs_before_iteration": true, "evaluation_config": null, "off_policy_estimation_methods": {}, "ope_split_batch_by_episode": true, "evaluation_num_env_runners": 1, "in_evaluation": false, "sync_filters_on_rollout_workers_timeout_s": 10.0, "offline_evaluation_interval": null, "num_offline_eval_runners": 0, "offline_loss_for_module_fn": null, "offline_evaluation_duration": 1, "offline_evaluation_parallel_to_training": false, "offline_evaluation_timeout_s": 120.0, "num_cpus_per_offline_eval_runner": 1, "num_gpus_per_offline_eval_runner": 0, "custom_resources_per_offline_eval_runner": {}, "restart_failed_offline_eval_runners": true, "ignore_offline_eval_runner_failures": false, "max_num_offline_eval_runner_restarts": 1000, "offline_eval_runner_restore_timeout_s": 1800.0, "max_requests_in_flight_per_offline_eval_runner": 1, "validate_offline_eval_runners_after_construction": true, "offline_eval_runner_health_probe_timeout_s": 30.0, "offline_eval_rl_module_inference_only": false, "broadcast_offline_eval_runner_states": false, "offline_eval_batch_size_per_runner": 256, "dataset_num_iters_per_eval_runner": 1, "keep_per_episode_custom_metrics": false, "metrics_episode_collection_timeout_s": 60.0, "metrics_num_episodes_for_smoothing": 100, "min_time_s_per_iteration": null, "min_train_timesteps_per_iteration": 0, "min_sample_timesteps_per_iteration": 0, "log_gradients": true, "export_native_model_files": false, "checkpoint_trainable_policies_only": false, "logger_creator": null, "logger_config": null, "log_level": "WARN", "log_sys_usage": true, "fake_sampler": false, "seed": 9, "restart_failed_env_runners": true, "ignore_env_runner_failures": false, "max_num_env_runner_restarts": 1000, "delay_between_env_runner_restarts_s": 60.0, "restart_failed_sub_environments": false, "num_consecutive_env_runner_failures_tolerance": 100, "env_runner_health_probe_timeout_s": 30.0, "env_runner_restore_timeout_s": 1800.0, "_model_config": {}, "_rl_module_spec": "RLModuleSpec(module_class=None, observation_space=None, action_space=None, inference_only=False, learner_only=False, model_config=DefaultModelConfig(fcnet_hiddens=[60, 90], fcnet_activation='tanh', fcnet_kernel_initializer=None, fcnet_kernel_initializer_kwargs=None, fcnet_bias_initializer=None, fcnet_bias_initializer_kwargs=None, conv_filters=None, conv_activation='relu', conv_kernel_initializer=None, conv_kernel_initializer_kwargs=None, conv_bias_initializer=None, conv_bias_initializer_kwargs=None, head_fcnet_hiddens=[], head_fcnet_activation='relu', head_fcnet_kernel_initializer=None, head_fcnet_kernel_initializer_kwargs=None, head_fcnet_bias_initializer=None, head_fcnet_bias_initializer_kwargs=None, free_log_std=False, log_std_clip_param=20.0, vf_share_layers=True, use_lstm=False, max_seq_len=20, lstm_cell_size=256, lstm_use_prev_action=False, lstm_use_prev_reward=False, lstm_kernel_initializer=None, lstm_kernel_initializer_kwargs=None, lstm_bias_initializer=None, lstm_bias_initializer_kwargs=None), catalog_class=None, load_state_path=None, model_config_dict=None)", "algorithm_config_overrides_per_module": {}, "_per_module_overrides": {}, "_validate_config": true, "_use_msgpack_checkpoints": false, "_torch_grad_scaler_class": null, "_torch_lr_scheduler_classes": null, "_tf_policy_handles_more_than_one_loss": false, "_disable_preprocessor_api": false, "_disable_action_flattening": false, "_disable_initialize_loss_from_dummy_batch": false, "_dont_auto_sync_env_runner_states": false, "env_task_fn": -1, "enable_connectors": -1, "simple_optimizer": false, "policy_map_cache": -1, "worker_cls": -1, "synchronize_filters": -1, "enable_async_evaluation": -1, "custom_async_evaluation_function": -1, "_enable_rl_module_api": -1, "auto_wrap_old_gym_envs": -1, "always_attach_evaluation_results": -1, "replay_sequence_length": null, "_disable_execution_plan_api": -1, "use_critic": true, "use_gae": true, "use_kl_loss": true, "kl_coeff": 0.7464963036515, "kl_target": 0.0270990929592, "vf_loss_coeff": 0.6688075857018, "entropy_coeff": 0.0090570820258, "clip_param": 0.1221781641624, "vf_clip_param": 0.1027808522125, "entropy_coeff_schedule": null, "lr_schedule": null, "sgd_minibatch_size": -1, "vf_share_layers": -1, "__stdout_file__": null, "__stderr_file__": null, "lambda": 0.9099046732075, "input": "sampler", "policies": {"default_policy": [null, null, null, null]}, "callbacks": "<class 'ray.rllib.callbacks.callbacks.RLlibCallback'>", "create_env_on_driver": false, "custom_eval_function": null, "framework": "torch"}, "time_since_restore": 76.55085396766663, "iterations_since_restore": 9, "perf": {"cpu_util_percent": 90.3375, "ram_util_percent": 82.375}}
{"timers": {"training_iteration": 18.213355424992802, "restore_env_runners": 3.3649797125096794e-05, "training_step": 18.212516611052287, "env_runner_sampling_timer": 17.083271423146552, "learner_update_timer": 1.0648767929752108, "synch_weights": 0.04212636654414455, "restore_eval_env_runners": 0.00026374851619468905, "evaluation_iteration": 1.9435426321556895, "synch_eval_env_connectors": 0.001437285151996855, "synch_env_connectors": 2.63851719356599e-05}, "env_runners": {"module_to_env_connector": {"timers": {"connectors": {"un_batch_to_individual_items": 2.5015101727250135e-05, "tensor_to_numpy": 4.881425983930298e-05, "normalize_and_clip_actions": 3.0256061322731706e-05, "remove_single_ts_time_rank_from_batch": 1.963267012354274e-06, "listify_data_for_vector_env": 3.568759651890862e-05, "get_actions": 0.00018949056635406158}}, "connector_pipeline_timer": 0.00042102939399785605}, "time_between_sampling": 0.005503686145119538, "episode_len_max": 20, "num_env_steps_sampled_lifetime": -4930000.0, "env_to_module_sum_episodes_length_in": 10.36823839457432, "sample": 0.019110887938122788, "num_agent_steps_sampled_lifetime": {"default_agent": -4930000.0}, "episode_len_mean": 20.0, "rlmodule_inference_timer": 0.00012700273438335407, "num_episodes_lifetime": -246500.0, "num_module_steps_sampled": {"default_policy": 5000.0}, "env_to_module_connector": {"connector_pipeline_timer": 0.0001408019428240302, "timers": {"connectors": {"add_states_from_episodes_to_batch": 5.1937722734283935e-06, "batch_individual_items": 2.382757100998484e-05, "add_observations_from_episodes_to_batch": 1.1391901841734605e-05, "add_time_dim_to_batch_and_zero_pad": 7.942558606581526e-06, "numpy_to_tensor": 3.649520998304724e-05}}}, "module_episode_returns_mean": {"default_policy": 9.940000000000001}, "num_agent_steps_sampled": {"default_agent": 5000.0}, "num_episodes": 250.0, "episode_len_min": 20, "env_to_module_sum_episodes_length_out": 10.36823839457432, "num_module_steps_sampled_lifetime": {"default_policy": -4930000.0}, "env_reset_timer": 0.00022890739231602625, "episode_duration_sec_mean": 0.017749308633152393, "episode_return_max": 14.5, "weights_seq_no": 9.0, "env_step_timer": 5.793980232901168e-05, "episode_return_min": -5.5, "agent_episode_returns_mean": {"default_agent": 9.940000000000001}, "num_env_steps_sampled": 5000.0, "episode_return_mean": 9.940000000000001, "num_env_steps_sampled_lifetime_throughput": 1526.4974807939227}, "learners": {"__all_modules__": {"num_non_trainable_parameters": 0, "learner_connector": {"timers": {"connectors": {"add_time_dim_to_batch_and_zero_pad": 0.00019957742554786264, "numpy_to_tensor": 0.00013799393203922514, "general_advantage_estimation": 0.056420435915215734, "add_states_from_episodes_to_batch": 6.586471325007006e-06, "add_one_ts_to_episodes_and_truncate": 0.10993257758435378, "batch_individual_items": 0.33983650960897116, "add_observations_from_episodes_to_batch": 0.004230161532559103, "add_columns_from_episodes_to_train_batch": 0.3219384433051511}}, "connector_pipeline_timer": 0.8333290566476377}, "learner_connector_sum_episodes_length_in": 5000.0, "num_module_steps_trained": 6000, "num_module_steps_trained_lifetime": 60000, "num_env_steps_trained": 31500, "learner_connector_sum_episodes_length_out": 5250.0, "num_trainable_parameters": 6003, "num_env_steps_trained_lifetime": 315000, "num_env_steps_trained_lifetime_throughput": 573148.6681613006, "num_module_steps_trained_throughput": 109551.69137478845, "num_module_steps_trained_lifetime_throughput": 109339.58012822451}, "default_policy": {"module_train_batch_size_mean": 1000.0, "mean_kl_loss": 0.00015151759725995362, "curr_entropy_coeff": 0.0090570820258, "weights_seq_no": 10.0, "num_module_steps_trained": 6000, "curr_kl_coeff": 0.0007290003122761846, "diff_num_grad_updates_vs_sampler_policy": 1.0, "num_module_steps_trained_lifetime": 60000, "vf_loss": 0.10020184516906738, "gradients_default_optimizer_global_norm": 0.06948995590209961, "total_loss": 0.15950974822044373, "policy_loss": 0.09833916276693344, "num_trainable_parameters": 6003, "default_optimizer_learning_rate": 0.0002847858517, "vf_explained_var": 0.0037711262702941895, "entropy": 0.64539635181427, "vf_loss_unclipped": 35.351341247558594, "num_module_steps_trained_lifetime_throughput": 109653.66355204294}}, "num_training_step_calls_per_iteration": 1, "evaluation": {"env_runners": {"module_to_env_connector": {"connector_pipeline_timer": 0.00036197647186424556, "timers": {"connectors": {"remove_single_ts_time_rank_from_batch": 1.3208843841242676e-06, "normalize_and_clip_actions": 2.552570716593871e-05, "tensor_to_numpy": 4.2335589501368375e-05, "listify_data_for_vector_env": 3.697296059339549e-05, "un_batch_to_individual_items": 1.6104410566136576e-05, "get_actions": 0.00017295406499097006}}}, "env_to_module_connector": {"timers": {"connectors": {"numpy_to_tensor": 2.7104652820141278e-05, "add_states_from_episodes_to_batch": 3.1582212572492077e-06, "batch_individual_items": 1.8257237679489678e-05, "add_observations_from_episodes_to_batch": 6.791887704685531e-06, "add_time_dim_to_batch_and_zero_pad": 7.054809668046413e-06}}, "connector_pipeline_timer": 0.00011235352434197365}, "num_episodes": 20, "num_env_steps_sampled": 400, "num_env_steps_sampled_lifetime": 50400, "episode_len_mean": 20.0, "num_module_steps_sampled": {"default_policy": 400}, "episode_return_max": 15.5, "weights_seq_no": 10.0, "episode_len_max": 20, "num_agent_steps_sampled_lifetime": {"default_agent": 4000}, "sample": 1.7704471202350383, "module_episode_returns_mean": {"default_policy": 1.9}, "num_agent_steps_sampled": {"default_agent": 400}, "agent_episode_returns_mean": {"default_agent": 1.9}, "rlmodule_inference_timer": 9.540865681766261e-05, "num_episodes_lifetime": 200, "num_module_steps_sampled_lifetime": {"default_policy": 4000}, "episode_len_min": 20, "env_to_module_sum_episodes_length_out": 10.368238394574323, "env_reset_timer": 0.017382506216804025, "episode_duration_sec_mean": 0.01567876631161198, "env_step_timer": 5.175786099021647e-05, "episode_return_min": -13.5, "episode_return_mean": 1.9, "env_to_module_sum_episodes_length_in": 10.368238394574323, "time_between_sampling": 14.158535771293403}, "num_healthy_workers": 1, "actor_manager_num_outstanding_async_reqs": 0, "num_remote_worker_restarts": 0}, "num_env_steps_sampled_lifetime": -4930000.0, "fault_tolerance": {"num_healthy_workers": 0, "num_remote_worker_restarts": 0}, "env_runner_group": {"actor_manager_num_outstanding_async_reqs": 0}, "done": false, "training_iteration": 10, "trial_id": "497a0_00000", "date": "2025-08-11_19-29-16", "timestamp": 1754933356, "time_this_iter_s": 6.387423038482666, "time_total_s": 82.93827700614929, "pid": 19607, "hostname": "Mac", "node_ip": "127.0.0.1", "config": {"exploration_config": {}, "extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "placement_strategy": "PACK", "num_gpus": 0, "_fake_gpus": false, "num_cpus_for_main_process": 2, "eager_tracing": true, "eager_max_retraces": 20, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "torch_compile_learner": false, "torch_compile_learner_what_to_compile": "forward_train", "torch_compile_learner_dynamo_backend": "aot_eager", "torch_compile_learner_dynamo_mode": null, "torch_compile_worker": false, "torch_compile_worker_dynamo_backend": "aot_eager", "torch_compile_worker_dynamo_mode": null, "torch_ddp_kwargs": {}, "torch_skip_nan_gradients": false, "env": "Umbrella", "env_config": {}, "observation_space": null, "action_space": null, "clip_rewards": null, "normalize_actions": true, "clip_actions": false, "_is_atari": null, "disable_env_checking": false, "render_env": false, "action_mask_key": "action_mask", "env_runner_cls": null, "num_env_runners": 0, "create_local_env_runner": true, "num_envs_per_env_runner": 1, "gym_env_vectorize_mode": "SYNC", "num_cpus_per_env_runner": 1, "num_gpus_per_env_runner": 0, "custom_resources_per_env_runner": {}, "validate_env_runners_after_construction": true, "episodes_to_numpy": true, "max_requests_in_flight_per_env_runner": 1, "sample_timeout_s": 60.0, "_env_to_module_connector": null, "add_default_connectors_to_env_to_module_pipeline": true, "_module_to_env_connector": null, "add_default_connectors_to_module_to_env_pipeline": true, "merge_env_runner_states": "training_only", "broadcast_env_runner_states": true, "episode_lookback_horizon": 1, "rollout_fragment_length": "auto", "batch_mode": "complete_episodes", "compress_observations": false, "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "enable_tf1_exec_eagerly": false, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "preprocessor_pref": "deepmind", "observation_filter": "NoFilter", "update_worker_filter_stats": true, "use_worker_filter_stats": true, "sampler_perf_stats_ema_coef": null, "_is_online": true, "num_learners": 0, "num_gpus_per_learner": 0, "num_cpus_per_learner": "auto", "num_aggregator_actors_per_learner": 0, "max_requests_in_flight_per_aggregator_actor": 3, "local_gpu_idx": 0, "max_requests_in_flight_per_learner": 3, "gamma": 1, "lr": 0.0002847858517, "grad_clip": 0.5, "grad_clip_by": "global_norm", "_train_batch_size_per_learner": 5000, "train_batch_size": 4000, "num_epochs": 1, "minibatch_size": 1000, "shuffle_batch_per_epoch": true, "model": {"fcnet_hiddens": [256, 256], "fcnet_activation": "tanh", "fcnet_weights_initializer": null, "fcnet_weights_initializer_config": null, "fcnet_bias_initializer": null, "fcnet_bias_initializer_config": null, "conv_filters": null, "conv_activation": "relu", "conv_kernel_initializer": null, "conv_kernel_initializer_config": null, "conv_bias_initializer": null, "conv_bias_initializer_config": null, "conv_transpose_kernel_initializer": null, "conv_transpose_kernel_initializer_config": null, "conv_transpose_bias_initializer": null, "conv_transpose_bias_initializer_config": null, "post_fcnet_hiddens": [], "post_fcnet_activation": "relu", "post_fcnet_weights_initializer": null, "post_fcnet_weights_initializer_config": null, "post_fcnet_bias_initializer": null, "post_fcnet_bias_initializer_config": null, "free_log_std": false, "log_std_clip_param": 20.0, "no_final_linear": false, "vf_share_layers": false, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "lstm_weights_initializer": null, "lstm_weights_initializer_config": null, "lstm_bias_initializer": null, "lstm_bias_initializer_config": null, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "attention_use_n_prev_actions": 0, "attention_use_n_prev_rewards": 0, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": null, "custom_model_config": {}, "custom_action_dist": null, "custom_preprocessor": null, "encoder_latent_dim": null, "always_check_shapes": false, "lstm_use_prev_action_reward": -1, "_use_default_native_models": -1, "_disable_preprocessor_api": false, "_disable_action_flattening": false}, "_learner_connector": null, "add_default_connectors_to_learner_pipeline": true, "learner_config_dict": {}, "optimizer": {}, "_learner_class": null, "callbacks_on_algorithm_init": null, "callbacks_on_env_runners_recreated": null, "callbacks_on_offline_eval_runners_recreated": null, "callbacks_on_checkpoint_loaded": null, "callbacks_on_environment_created": null, "callbacks_on_episode_created": null, "callbacks_on_episode_start": null, "callbacks_on_episode_step": null, "callbacks_on_episode_end": null, "callbacks_on_evaluate_start": null, "callbacks_on_evaluate_end": null, "callbacks_on_evaluate_offline_start": null, "callbacks_on_evaluate_offline_end": null, "callbacks_on_sample_end": null, "callbacks_on_train_result": null, "explore": true, "enable_rl_module_and_learner": true, "enable_env_runner_and_connector_v2": true, "_prior_exploration_config": {"type": "StochasticSampling"}, "count_steps_by": "env_steps", "policy_map_capacity": 100, "policy_mapping_fn": "<function AlgorithmConfig.DEFAULT_POLICY_MAPPING_FN at 0x3862edb20>", "policies_to_train": null, "policy_states_are_swappable": false, "observation_fn": null, "offline_data_class": null, "input_read_method": "read_parquet", "input_read_method_kwargs": {}, "input_read_schema": {}, "input_read_episodes": false, "input_read_sample_batches": false, "input_read_batch_size": null, "input_filesystem": null, "input_filesystem_kwargs": {}, "input_compress_columns": ["obs", "new_obs"], "input_spaces_jsonable": true, "materialize_data": false, "materialize_mapped_data": true, "map_batches_kwargs": {}, "iter_batches_kwargs": {}, "ignore_final_observation": false, "prelearner_class": null, "prelearner_buffer_class": null, "prelearner_buffer_kwargs": {}, "prelearner_module_synch_period": 10, "dataset_num_iters_per_learner": null, "input_config": {}, "actions_in_input_normalized": false, "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_config": {}, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "output_max_rows_per_file": null, "output_write_remaining_data": false, "output_write_method": "write_parquet", "output_write_method_kwargs": {}, "output_filesystem": null, "output_filesystem_kwargs": {}, "output_write_episodes": true, "offline_sampling": false, "evaluation_interval": 1, "evaluation_duration": 20, "evaluation_duration_unit": "episodes", "evaluation_sample_timeout_s": 120.0, "evaluation_auto_duration_min_env_steps_per_sample": 100, "evaluation_auto_duration_max_env_steps_per_sample": 2000, "evaluation_parallel_to_training": false, "evaluation_force_reset_envs_before_iteration": true, "evaluation_config": null, "off_policy_estimation_methods": {}, "ope_split_batch_by_episode": true, "evaluation_num_env_runners": 1, "in_evaluation": false, "sync_filters_on_rollout_workers_timeout_s": 10.0, "offline_evaluation_interval": null, "num_offline_eval_runners": 0, "offline_loss_for_module_fn": null, "offline_evaluation_duration": 1, "offline_evaluation_parallel_to_training": false, "offline_evaluation_timeout_s": 120.0, "num_cpus_per_offline_eval_runner": 1, "num_gpus_per_offline_eval_runner": 0, "custom_resources_per_offline_eval_runner": {}, "restart_failed_offline_eval_runners": true, "ignore_offline_eval_runner_failures": false, "max_num_offline_eval_runner_restarts": 1000, "offline_eval_runner_restore_timeout_s": 1800.0, "max_requests_in_flight_per_offline_eval_runner": 1, "validate_offline_eval_runners_after_construction": true, "offline_eval_runner_health_probe_timeout_s": 30.0, "offline_eval_rl_module_inference_only": false, "broadcast_offline_eval_runner_states": false, "offline_eval_batch_size_per_runner": 256, "dataset_num_iters_per_eval_runner": 1, "keep_per_episode_custom_metrics": false, "metrics_episode_collection_timeout_s": 60.0, "metrics_num_episodes_for_smoothing": 100, "min_time_s_per_iteration": null, "min_train_timesteps_per_iteration": 0, "min_sample_timesteps_per_iteration": 0, "log_gradients": true, "export_native_model_files": false, "checkpoint_trainable_policies_only": false, "logger_creator": null, "logger_config": null, "log_level": "WARN", "log_sys_usage": true, "fake_sampler": false, "seed": 9, "restart_failed_env_runners": true, "ignore_env_runner_failures": false, "max_num_env_runner_restarts": 1000, "delay_between_env_runner_restarts_s": 60.0, "restart_failed_sub_environments": false, "num_consecutive_env_runner_failures_tolerance": 100, "env_runner_health_probe_timeout_s": 30.0, "env_runner_restore_timeout_s": 1800.0, "_model_config": {}, "_rl_module_spec": "RLModuleSpec(module_class=None, observation_space=None, action_space=None, inference_only=False, learner_only=False, model_config=DefaultModelConfig(fcnet_hiddens=[60, 90], fcnet_activation='tanh', fcnet_kernel_initializer=None, fcnet_kernel_initializer_kwargs=None, fcnet_bias_initializer=None, fcnet_bias_initializer_kwargs=None, conv_filters=None, conv_activation='relu', conv_kernel_initializer=None, conv_kernel_initializer_kwargs=None, conv_bias_initializer=None, conv_bias_initializer_kwargs=None, head_fcnet_hiddens=[], head_fcnet_activation='relu', head_fcnet_kernel_initializer=None, head_fcnet_kernel_initializer_kwargs=None, head_fcnet_bias_initializer=None, head_fcnet_bias_initializer_kwargs=None, free_log_std=False, log_std_clip_param=20.0, vf_share_layers=True, use_lstm=False, max_seq_len=20, lstm_cell_size=256, lstm_use_prev_action=False, lstm_use_prev_reward=False, lstm_kernel_initializer=None, lstm_kernel_initializer_kwargs=None, lstm_bias_initializer=None, lstm_bias_initializer_kwargs=None), catalog_class=None, load_state_path=None, model_config_dict=None)", "algorithm_config_overrides_per_module": {}, "_per_module_overrides": {}, "_validate_config": true, "_use_msgpack_checkpoints": false, "_torch_grad_scaler_class": null, "_torch_lr_scheduler_classes": null, "_tf_policy_handles_more_than_one_loss": false, "_disable_preprocessor_api": false, "_disable_action_flattening": false, "_disable_initialize_loss_from_dummy_batch": false, "_dont_auto_sync_env_runner_states": false, "env_task_fn": -1, "enable_connectors": -1, "simple_optimizer": false, "policy_map_cache": -1, "worker_cls": -1, "synchronize_filters": -1, "enable_async_evaluation": -1, "custom_async_evaluation_function": -1, "_enable_rl_module_api": -1, "auto_wrap_old_gym_envs": -1, "always_attach_evaluation_results": -1, "replay_sequence_length": null, "_disable_execution_plan_api": -1, "use_critic": true, "use_gae": true, "use_kl_loss": true, "kl_coeff": 0.7464963036515, "kl_target": 0.0270990929592, "vf_loss_coeff": 0.6688075857018, "entropy_coeff": 0.0090570820258, "clip_param": 0.1221781641624, "vf_clip_param": 0.1027808522125, "entropy_coeff_schedule": null, "lr_schedule": null, "sgd_minibatch_size": -1, "vf_share_layers": -1, "__stdout_file__": null, "__stderr_file__": null, "lambda": 0.9099046732075, "input": "sampler", "policies": {"default_policy": [null, null, null, null]}, "callbacks": "<class 'ray.rllib.callbacks.callbacks.RLlibCallback'>", "create_env_on_driver": false, "custom_eval_function": null, "framework": "torch"}, "time_since_restore": 82.93827700614929, "iterations_since_restore": 10, "perf": {"cpu_util_percent": 81.66250000000001, "ram_util_percent": 83.5625}}
{"timers": {"training_iteration": 18.072231197822973, "restore_env_runners": 3.3393298598852076e-05, "training_step": 18.071397517441785, "env_runner_sampling_timer": 16.950914381415295, "learner_update_timer": 1.0567178767155654, "synch_weights": 0.04171644037830301, "restore_eval_env_runners": 0.00026191395099984215, "evaluation_iteration": 1.9273222295836405, "synch_eval_env_connectors": 0.0014274014708642736, "synch_env_connectors": 2.6168819995915123e-05}, "env_runners": {"module_to_env_connector": {"timers": {"connectors": {"un_batch_to_individual_items": 1.2493582134398642e-05, "tensor_to_numpy": 3.6519028691308776e-05, "normalize_and_clip_actions": 2.4159962803540433e-05, "remove_single_ts_time_rank_from_batch": 1.3946663935901962e-06, "listify_data_for_vector_env": 2.9463625363412458e-05, "get_actions": 0.00014182603397046978}}, "connector_pipeline_timer": 0.0003093783050908758}, "time_between_sampling": 0.006065930691655572, "episode_len_max": 20, "num_env_steps_sampled_lifetime": -5547500.0, "env_to_module_sum_episodes_length_in": 10.36823839457432, "sample": 0.014799606619469916, "num_agent_steps_sampled_lifetime": {"default_agent": -5547500.0}, "episode_len_mean": 20.0, "rlmodule_inference_timer": 9.081901489213695e-05, "num_episodes_lifetime": -277375.0, "num_module_steps_sampled": {"default_policy": 5000.0}, "env_to_module_connector": {"connector_pipeline_timer": 0.00011284166689899729, "timers": {"connectors": {"add_states_from_episodes_to_batch": 4.164044319518015e-06, "batch_individual_items": 1.8271434661326678e-05, "add_observations_from_episodes_to_batch": 7.438875573488447e-06, "add_time_dim_to_batch_and_zero_pad": 5.803945353948979e-06, "numpy_to_tensor": 2.897759848057075e-05}}}, "module_episode_returns_mean": {"default_policy": 9.460000000000004}, "num_agent_steps_sampled": {"default_agent": 5000.0}, "num_episodes": 250.0, "episode_len_min": 20, "env_to_module_sum_episodes_length_out": 10.36823839457432, "num_module_steps_sampled_lifetime": {"default_policy": -5547500.0}, "env_reset_timer": 0.00013689294091329273, "episode_duration_sec_mean": 0.01314705217117444, "episode_return_max": 14.5, "weights_seq_no": 10.0, "env_step_timer": 4.525681222165333e-05, "episode_return_min": -5.5, "agent_episode_returns_mean": {"default_agent": 9.460000000000004}, "num_env_steps_sampled": 5000.0, "episode_return_mean": 9.460000000000004, "num_env_steps_sampled_lifetime_throughput": 1797.5829771346428}, "learners": {"__all_modules__": {"num_non_trainable_parameters": 0, "learner_connector": {"timers": {"connectors": {"add_time_dim_to_batch_and_zero_pad": 0.0001980649914104644, "numpy_to_tensor": 0.00013828066198699396, "general_advantage_estimation": 0.055952869885623514, "add_states_from_episodes_to_batch": 6.673936067981973e-06, "add_one_ts_to_episodes_and_truncate": 0.1090134068089268, "batch_individual_items": 0.3371418686827523, "add_observations_from_episodes_to_batch": 0.004221487416594103, "add_columns_from_episodes_to_train_batch": 0.3198872913717214}}, "connector_pipeline_timer": 0.827182469830628}, "learner_connector_sum_episodes_length_in": 5000.0, "num_module_steps_trained": 6000, "num_module_steps_trained_lifetime": 66000, "num_env_steps_trained": 31500, "learner_connector_sum_episodes_length_out": 5250.0, "num_trainable_parameters": 6003, "num_env_steps_trained_lifetime": 346500, "num_env_steps_trained_lifetime_throughput": 583205.0695238439, "num_module_steps_trained_throughput": 111470.86189104946, "num_module_steps_trained_lifetime_throughput": 111251.90887024021}, "default_policy": {"module_train_batch_size_mean": 1000.0, "mean_kl_loss": 0.00011596082913456485, "curr_entropy_coeff": 0.0090570820258, "weights_seq_no": 11.0, "num_module_steps_trained": 6000, "curr_kl_coeff": 0.0003645001561380923, "diff_num_grad_updates_vs_sampler_policy": 1.0, "num_module_steps_trained_lifetime": 66000, "vf_loss": 0.10056816786527634, "gradients_default_optimizer_global_norm": 0.05864938348531723, "total_loss": 0.024965224787592888, "policy_loss": -0.03647731989622116, "num_trainable_parameters": 6003, "default_optimizer_learning_rate": 0.0002847858517, "vf_explained_var": 0.003722965717315674, "entropy": 0.6424030065536499, "vf_loss_unclipped": 36.1129264831543, "num_module_steps_trained_lifetime_throughput": 111567.53284042476}}, "num_training_step_calls_per_iteration": 1, "evaluation": {"env_runners": {"module_to_env_connector": {"connector_pipeline_timer": 0.0002381354799701528, "timers": {"connectors": {"remove_single_ts_time_rank_from_batch": 1.2809314838355688e-06, "normalize_and_clip_actions": 1.931361417156309e-05, "tensor_to_numpy": 3.178710344229504e-05, "listify_data_for_vector_env": 2.635050715777601e-05, "un_batch_to_individual_items": 1.1395121140374345e-05, "get_actions": 9.600847552305043e-05}}}, "env_to_module_connector": {"timers": {"connectors": {"numpy_to_tensor": 1.9926656830447374e-05, "add_states_from_episodes_to_batch": 5.330191297088447e-06, "batch_individual_items": 1.3514552020088037e-05, "add_observations_from_episodes_to_batch": 6.339403413566934e-06, "add_time_dim_to_batch_and_zero_pad": 9.704168356722274e-06}}, "connector_pipeline_timer": 9.79577506854441e-05}, "num_episodes": 20, "num_env_steps_sampled": 400, "num_env_steps_sampled_lifetime": 55400, "episode_len_mean": 20.0, "num_module_steps_sampled": {"default_policy": 400}, "episode_return_max": 15.5, "weights_seq_no": 11.0, "episode_len_max": 20, "num_agent_steps_sampled_lifetime": {"default_agent": 4400}, "sample": 1.7549383056931664, "module_episode_returns_mean": {"default_policy": 1.7}, "num_agent_steps_sampled": {"default_agent": 400}, "agent_episode_returns_mean": {"default_agent": 1.7}, "rlmodule_inference_timer": 7.52686671412481e-05, "num_episodes_lifetime": 220, "num_module_steps_sampled_lifetime": {"default_policy": 4400}, "episode_len_min": 20, "env_to_module_sum_episodes_length_out": 10.368238394574323, "env_reset_timer": 0.017209404484940013, "episode_duration_sec_mean": 0.016105472538620234, "env_step_timer": 3.539143423301448e-05, "episode_return_min": -13.5, "episode_return_mean": 1.7, "env_to_module_sum_episodes_length_in": 10.368238394574323, "time_between_sampling": 14.058414647330482}, "num_healthy_workers": 1, "actor_manager_num_outstanding_async_reqs": 0, "num_remote_worker_restarts": 0}, "num_env_steps_sampled_lifetime": -5547500.0, "fault_tolerance": {"num_healthy_workers": 0, "num_remote_worker_restarts": 0}, "env_runner_group": {"actor_manager_num_outstanding_async_reqs": 0}, "done": false, "training_iteration": 11, "trial_id": "497a0_00000", "date": "2025-08-11_19-29-21", "timestamp": 1754933361, "time_this_iter_s": 4.334244966506958, "time_total_s": 87.27252197265625, "pid": 19607, "hostname": "Mac", "node_ip": "127.0.0.1", "config": {"exploration_config": {}, "extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "placement_strategy": "PACK", "num_gpus": 0, "_fake_gpus": false, "num_cpus_for_main_process": 2, "eager_tracing": true, "eager_max_retraces": 20, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "torch_compile_learner": false, "torch_compile_learner_what_to_compile": "forward_train", "torch_compile_learner_dynamo_backend": "aot_eager", "torch_compile_learner_dynamo_mode": null, "torch_compile_worker": false, "torch_compile_worker_dynamo_backend": "aot_eager", "torch_compile_worker_dynamo_mode": null, "torch_ddp_kwargs": {}, "torch_skip_nan_gradients": false, "env": "Umbrella", "env_config": {}, "observation_space": null, "action_space": null, "clip_rewards": null, "normalize_actions": true, "clip_actions": false, "_is_atari": null, "disable_env_checking": false, "render_env": false, "action_mask_key": "action_mask", "env_runner_cls": null, "num_env_runners": 0, "create_local_env_runner": true, "num_envs_per_env_runner": 1, "gym_env_vectorize_mode": "SYNC", "num_cpus_per_env_runner": 1, "num_gpus_per_env_runner": 0, "custom_resources_per_env_runner": {}, "validate_env_runners_after_construction": true, "episodes_to_numpy": true, "max_requests_in_flight_per_env_runner": 1, "sample_timeout_s": 60.0, "_env_to_module_connector": null, "add_default_connectors_to_env_to_module_pipeline": true, "_module_to_env_connector": null, "add_default_connectors_to_module_to_env_pipeline": true, "merge_env_runner_states": "training_only", "broadcast_env_runner_states": true, "episode_lookback_horizon": 1, "rollout_fragment_length": "auto", "batch_mode": "complete_episodes", "compress_observations": false, "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "enable_tf1_exec_eagerly": false, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "preprocessor_pref": "deepmind", "observation_filter": "NoFilter", "update_worker_filter_stats": true, "use_worker_filter_stats": true, "sampler_perf_stats_ema_coef": null, "_is_online": true, "num_learners": 0, "num_gpus_per_learner": 0, "num_cpus_per_learner": "auto", "num_aggregator_actors_per_learner": 0, "max_requests_in_flight_per_aggregator_actor": 3, "local_gpu_idx": 0, "max_requests_in_flight_per_learner": 3, "gamma": 1, "lr": 0.0002847858517, "grad_clip": 0.5, "grad_clip_by": "global_norm", "_train_batch_size_per_learner": 5000, "train_batch_size": 4000, "num_epochs": 1, "minibatch_size": 1000, "shuffle_batch_per_epoch": true, "model": {"fcnet_hiddens": [256, 256], "fcnet_activation": "tanh", "fcnet_weights_initializer": null, "fcnet_weights_initializer_config": null, "fcnet_bias_initializer": null, "fcnet_bias_initializer_config": null, "conv_filters": null, "conv_activation": "relu", "conv_kernel_initializer": null, "conv_kernel_initializer_config": null, "conv_bias_initializer": null, "conv_bias_initializer_config": null, "conv_transpose_kernel_initializer": null, "conv_transpose_kernel_initializer_config": null, "conv_transpose_bias_initializer": null, "conv_transpose_bias_initializer_config": null, "post_fcnet_hiddens": [], "post_fcnet_activation": "relu", "post_fcnet_weights_initializer": null, "post_fcnet_weights_initializer_config": null, "post_fcnet_bias_initializer": null, "post_fcnet_bias_initializer_config": null, "free_log_std": false, "log_std_clip_param": 20.0, "no_final_linear": false, "vf_share_layers": false, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "lstm_weights_initializer": null, "lstm_weights_initializer_config": null, "lstm_bias_initializer": null, "lstm_bias_initializer_config": null, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "attention_use_n_prev_actions": 0, "attention_use_n_prev_rewards": 0, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": null, "custom_model_config": {}, "custom_action_dist": null, "custom_preprocessor": null, "encoder_latent_dim": null, "always_check_shapes": false, "lstm_use_prev_action_reward": -1, "_use_default_native_models": -1, "_disable_preprocessor_api": false, "_disable_action_flattening": false}, "_learner_connector": null, "add_default_connectors_to_learner_pipeline": true, "learner_config_dict": {}, "optimizer": {}, "_learner_class": null, "callbacks_on_algorithm_init": null, "callbacks_on_env_runners_recreated": null, "callbacks_on_offline_eval_runners_recreated": null, "callbacks_on_checkpoint_loaded": null, "callbacks_on_environment_created": null, "callbacks_on_episode_created": null, "callbacks_on_episode_start": null, "callbacks_on_episode_step": null, "callbacks_on_episode_end": null, "callbacks_on_evaluate_start": null, "callbacks_on_evaluate_end": null, "callbacks_on_evaluate_offline_start": null, "callbacks_on_evaluate_offline_end": null, "callbacks_on_sample_end": null, "callbacks_on_train_result": null, "explore": true, "enable_rl_module_and_learner": true, "enable_env_runner_and_connector_v2": true, "_prior_exploration_config": {"type": "StochasticSampling"}, "count_steps_by": "env_steps", "policy_map_capacity": 100, "policy_mapping_fn": "<function AlgorithmConfig.DEFAULT_POLICY_MAPPING_FN at 0x3862edb20>", "policies_to_train": null, "policy_states_are_swappable": false, "observation_fn": null, "offline_data_class": null, "input_read_method": "read_parquet", "input_read_method_kwargs": {}, "input_read_schema": {}, "input_read_episodes": false, "input_read_sample_batches": false, "input_read_batch_size": null, "input_filesystem": null, "input_filesystem_kwargs": {}, "input_compress_columns": ["obs", "new_obs"], "input_spaces_jsonable": true, "materialize_data": false, "materialize_mapped_data": true, "map_batches_kwargs": {}, "iter_batches_kwargs": {}, "ignore_final_observation": false, "prelearner_class": null, "prelearner_buffer_class": null, "prelearner_buffer_kwargs": {}, "prelearner_module_synch_period": 10, "dataset_num_iters_per_learner": null, "input_config": {}, "actions_in_input_normalized": false, "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_config": {}, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "output_max_rows_per_file": null, "output_write_remaining_data": false, "output_write_method": "write_parquet", "output_write_method_kwargs": {}, "output_filesystem": null, "output_filesystem_kwargs": {}, "output_write_episodes": true, "offline_sampling": false, "evaluation_interval": 1, "evaluation_duration": 20, "evaluation_duration_unit": "episodes", "evaluation_sample_timeout_s": 120.0, "evaluation_auto_duration_min_env_steps_per_sample": 100, "evaluation_auto_duration_max_env_steps_per_sample": 2000, "evaluation_parallel_to_training": false, "evaluation_force_reset_envs_before_iteration": true, "evaluation_config": null, "off_policy_estimation_methods": {}, "ope_split_batch_by_episode": true, "evaluation_num_env_runners": 1, "in_evaluation": false, "sync_filters_on_rollout_workers_timeout_s": 10.0, "offline_evaluation_interval": null, "num_offline_eval_runners": 0, "offline_loss_for_module_fn": null, "offline_evaluation_duration": 1, "offline_evaluation_parallel_to_training": false, "offline_evaluation_timeout_s": 120.0, "num_cpus_per_offline_eval_runner": 1, "num_gpus_per_offline_eval_runner": 0, "custom_resources_per_offline_eval_runner": {}, "restart_failed_offline_eval_runners": true, "ignore_offline_eval_runner_failures": false, "max_num_offline_eval_runner_restarts": 1000, "offline_eval_runner_restore_timeout_s": 1800.0, "max_requests_in_flight_per_offline_eval_runner": 1, "validate_offline_eval_runners_after_construction": true, "offline_eval_runner_health_probe_timeout_s": 30.0, "offline_eval_rl_module_inference_only": false, "broadcast_offline_eval_runner_states": false, "offline_eval_batch_size_per_runner": 256, "dataset_num_iters_per_eval_runner": 1, "keep_per_episode_custom_metrics": false, "metrics_episode_collection_timeout_s": 60.0, "metrics_num_episodes_for_smoothing": 100, "min_time_s_per_iteration": null, "min_train_timesteps_per_iteration": 0, "min_sample_timesteps_per_iteration": 0, "log_gradients": true, "export_native_model_files": false, "checkpoint_trainable_policies_only": false, "logger_creator": null, "logger_config": null, "log_level": "WARN", "log_sys_usage": true, "fake_sampler": false, "seed": 9, "restart_failed_env_runners": true, "ignore_env_runner_failures": false, "max_num_env_runner_restarts": 1000, "delay_between_env_runner_restarts_s": 60.0, "restart_failed_sub_environments": false, "num_consecutive_env_runner_failures_tolerance": 100, "env_runner_health_probe_timeout_s": 30.0, "env_runner_restore_timeout_s": 1800.0, "_model_config": {}, "_rl_module_spec": "RLModuleSpec(module_class=None, observation_space=None, action_space=None, inference_only=False, learner_only=False, model_config=DefaultModelConfig(fcnet_hiddens=[60, 90], fcnet_activation='tanh', fcnet_kernel_initializer=None, fcnet_kernel_initializer_kwargs=None, fcnet_bias_initializer=None, fcnet_bias_initializer_kwargs=None, conv_filters=None, conv_activation='relu', conv_kernel_initializer=None, conv_kernel_initializer_kwargs=None, conv_bias_initializer=None, conv_bias_initializer_kwargs=None, head_fcnet_hiddens=[], head_fcnet_activation='relu', head_fcnet_kernel_initializer=None, head_fcnet_kernel_initializer_kwargs=None, head_fcnet_bias_initializer=None, head_fcnet_bias_initializer_kwargs=None, free_log_std=False, log_std_clip_param=20.0, vf_share_layers=True, use_lstm=False, max_seq_len=20, lstm_cell_size=256, lstm_use_prev_action=False, lstm_use_prev_reward=False, lstm_kernel_initializer=None, lstm_kernel_initializer_kwargs=None, lstm_bias_initializer=None, lstm_bias_initializer_kwargs=None), catalog_class=None, load_state_path=None, model_config_dict=None)", "algorithm_config_overrides_per_module": {}, "_per_module_overrides": {}, "_validate_config": true, "_use_msgpack_checkpoints": false, "_torch_grad_scaler_class": null, "_torch_lr_scheduler_classes": null, "_tf_policy_handles_more_than_one_loss": false, "_disable_preprocessor_api": false, "_disable_action_flattening": false, "_disable_initialize_loss_from_dummy_batch": false, "_dont_auto_sync_env_runner_states": false, "env_task_fn": -1, "enable_connectors": -1, "simple_optimizer": false, "policy_map_cache": -1, "worker_cls": -1, "synchronize_filters": -1, "enable_async_evaluation": -1, "custom_async_evaluation_function": -1, "_enable_rl_module_api": -1, "auto_wrap_old_gym_envs": -1, "always_attach_evaluation_results": -1, "replay_sequence_length": null, "_disable_execution_plan_api": -1, "use_critic": true, "use_gae": true, "use_kl_loss": true, "kl_coeff": 0.7464963036515, "kl_target": 0.0270990929592, "vf_loss_coeff": 0.6688075857018, "entropy_coeff": 0.0090570820258, "clip_param": 0.1221781641624, "vf_clip_param": 0.1027808522125, "entropy_coeff_schedule": null, "lr_schedule": null, "sgd_minibatch_size": -1, "vf_share_layers": -1, "__stdout_file__": null, "__stderr_file__": null, "lambda": 0.9099046732075, "input": "sampler", "policies": {"default_policy": [null, null, null, null]}, "callbacks": "<class 'ray.rllib.callbacks.callbacks.RLlibCallback'>", "create_env_on_driver": false, "custom_eval_function": null, "framework": "torch"}, "time_since_restore": 87.27252197265625, "iterations_since_restore": 11, "perf": {"cpu_util_percent": 87.5, "ram_util_percent": 82.06666666666666}}
{"timers": {"training_iteration": 17.956189602094604, "restore_env_runners": 3.3324365302397864e-05, "training_step": 17.95535964393727, "env_runner_sampling_timer": 16.84363208760042, "learner_update_timer": 1.0485605975382482, "synch_weights": 0.04130678972439883, "restore_eval_env_runners": 0.00025937064210217534, "evaluation_iteration": 1.910357435208602, "synch_eval_env_connectors": 0.0014143566168537615, "synch_env_connectors": 2.600588109269567e-05}, "env_runners": {"module_to_env_connector": {"timers": {"connectors": {"un_batch_to_individual_items": 2.389887552652763e-05, "tensor_to_numpy": 5.451016283628485e-05, "normalize_and_clip_actions": 3.536126233619076e-05, "remove_single_ts_time_rank_from_batch": 2.017798440017783e-06, "listify_data_for_vector_env": 4.0488212787514343e-05, "get_actions": 0.00019917786843638423}}, "connector_pipeline_timer": 0.0004425626115883715}, "time_between_sampling": 0.005345648126848683, "episode_len_max": 20, "num_env_steps_sampled_lifetime": -6165000.0, "env_to_module_sum_episodes_length_in": 10.36823839457432, "sample": 0.018811341812651677, "num_agent_steps_sampled_lifetime": {"default_agent": -6165000.0}, "episode_len_mean": 20.0, "rlmodule_inference_timer": 0.00012632096443824554, "num_episodes_lifetime": -308250.0, "num_module_steps_sampled": {"default_policy": 5000.0}, "env_to_module_connector": {"connector_pipeline_timer": 0.00015438025764908495, "timers": {"connectors": {"add_states_from_episodes_to_batch": 5.474948092156906e-06, "batch_individual_items": 2.7074961603411588e-05, "add_observations_from_episodes_to_batch": 1.1028058184758462e-05, "add_time_dim_to_batch_and_zero_pad": 8.56584500950418e-06, "numpy_to_tensor": 3.833560543243519e-05}}}, "module_episode_returns_mean": {"default_policy": 9.539999999999996}, "num_agent_steps_sampled": {"default_agent": 5000.0}, "num_episodes": 250.0, "episode_len_min": 20, "env_to_module_sum_episodes_length_out": 10.36823839457432, "num_module_steps_sampled_lifetime": {"default_policy": -6165000.0}, "env_reset_timer": 0.00015597419144812083, "episode_duration_sec_mean": 0.01978627483639866, "episode_return_max": 14.5, "weights_seq_no": 11.0, "env_step_timer": 7.431536790587143e-05, "episode_return_min": -5.5, "agent_episode_returns_mean": {"default_agent": 9.539999999999996}, "num_env_steps_sampled": 5000.0, "episode_return_mean": 9.539999999999996, "num_env_steps_sampled_lifetime_throughput": 1381.2718857324442}, "learners": {"__all_modules__": {"num_non_trainable_parameters": 0, "learner_connector": {"timers": {"connectors": {"add_time_dim_to_batch_and_zero_pad": 0.00019629100081151372, "numpy_to_tensor": 0.00013771452514788502, "general_advantage_estimation": 0.05560100993568434, "add_states_from_episodes_to_batch": 6.6734475028006436e-06, "add_one_ts_to_episodes_and_truncate": 0.10824218191071075, "batch_individual_items": 0.33421451457629453, "add_observations_from_episodes_to_batch": 0.004221712541952667, "add_columns_from_episodes_to_train_batch": 0.317577230537797}}, "connector_pipeline_timer": 0.820816396792555}, "learner_connector_sum_episodes_length_in": 5000.0, "num_module_steps_trained": 6000, "num_module_steps_trained_lifetime": 72000, "num_env_steps_trained": 31500, "learner_connector_sum_episodes_length_out": 5250.0, "num_trainable_parameters": 6003, "num_env_steps_trained_lifetime": 378000, "num_env_steps_trained_lifetime_throughput": 591571.7991294415, "num_module_steps_trained_throughput": 113067.62640447257, "num_module_steps_trained_lifetime_throughput": 112847.41486340102}, "default_policy": {"module_train_batch_size_mean": 1000.0, "mean_kl_loss": 0.0003195784520357847, "curr_entropy_coeff": 0.0090570820258, "weights_seq_no": 12.0, "num_module_steps_trained": 6000, "curr_kl_coeff": 0.00018225007806904614, "diff_num_grad_updates_vs_sampler_policy": 1.0, "num_module_steps_trained_lifetime": 72000, "vf_loss": 0.10111989825963974, "gradients_default_optimizer_global_norm": 0.030036011710762978, "total_loss": -0.09505714476108551, "policy_loss": -0.156912699341774, "num_trainable_parameters": 6003, "default_optimizer_learning_rate": 0.0002847858517, "vf_explained_var": 0.0028873085975646973, "entropy": 0.6375489234924316, "vf_loss_unclipped": 37.25564193725586, "num_module_steps_trained_lifetime_throughput": 113157.61857693901}}, "num_training_step_calls_per_iteration": 1, "evaluation": {"env_runners": {"module_to_env_connector": {"connector_pipeline_timer": 0.00030570142469075594, "timers": {"connectors": {"remove_single_ts_time_rank_from_batch": 1.6539856624919902e-06, "normalize_and_clip_actions": 2.3594974645745046e-05, "tensor_to_numpy": 3.596884466754727e-05, "listify_data_for_vector_env": 3.637423395413111e-05, "un_batch_to_individual_items": 1.3483970751814131e-05, "get_actions": 0.00013687607545055566}}}, "env_to_module_connector": {"timers": {"connectors": {"numpy_to_tensor": 7.048663347802266e-05, "add_states_from_episodes_to_batch": 4.029578352775901e-06, "batch_individual_items": 2.228279300315541e-05, "add_observations_from_episodes_to_batch": 6.480254236481293e-06, "add_time_dim_to_batch_and_zero_pad": 9.268351467300054e-06}}, "connector_pipeline_timer": 0.000158408889352757}, "num_episodes": 20, "num_env_steps_sampled": 400, "num_env_steps_sampled_lifetime": 60400, "episode_len_mean": 20.0, "num_module_steps_sampled": {"default_policy": 400}, "episode_return_max": 15.5, "weights_seq_no": 12.0, "episode_len_max": 20, "num_agent_steps_sampled_lifetime": {"default_agent": 4800}, "sample": 1.7402551651362568, "module_episode_returns_mean": {"default_policy": 0.5}, "num_agent_steps_sampled": {"default_agent": 400}, "agent_episode_returns_mean": {"default_agent": 0.5}, "rlmodule_inference_timer": 0.00010308757778138769, "num_episodes_lifetime": 240, "num_module_steps_sampled_lifetime": {"default_policy": 4800}, "episode_len_min": 20, "env_to_module_sum_episodes_length_out": 10.368238394574323, "env_reset_timer": 0.0170431329396061, "episode_duration_sec_mean": 0.016025259611196815, "env_step_timer": 5.660855929122942e-05, "episode_return_min": -13.5, "episode_return_mean": 0.5, "env_to_module_sum_episodes_length_in": 10.368238394574323, "time_between_sampling": 13.982982390437478}, "num_healthy_workers": 1, "actor_manager_num_outstanding_async_reqs": 0, "num_remote_worker_restarts": 0}, "num_env_steps_sampled_lifetime": -6165000.0, "fault_tolerance": {"num_healthy_workers": 0, "num_remote_worker_restarts": 0}, "env_runner_group": {"actor_manager_num_outstanding_async_reqs": 0}, "done": false, "training_iteration": 12, "trial_id": "497a0_00000", "date": "2025-08-11_19-29-28", "timestamp": 1754933368, "time_this_iter_s": 6.767663955688477, "time_total_s": 94.04018592834473, "pid": 19607, "hostname": "Mac", "node_ip": "127.0.0.1", "config": {"exploration_config": {}, "extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "placement_strategy": "PACK", "num_gpus": 0, "_fake_gpus": false, "num_cpus_for_main_process": 2, "eager_tracing": true, "eager_max_retraces": 20, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "torch_compile_learner": false, "torch_compile_learner_what_to_compile": "forward_train", "torch_compile_learner_dynamo_backend": "aot_eager", "torch_compile_learner_dynamo_mode": null, "torch_compile_worker": false, "torch_compile_worker_dynamo_backend": "aot_eager", "torch_compile_worker_dynamo_mode": null, "torch_ddp_kwargs": {}, "torch_skip_nan_gradients": false, "env": "Umbrella", "env_config": {}, "observation_space": null, "action_space": null, "clip_rewards": null, "normalize_actions": true, "clip_actions": false, "_is_atari": null, "disable_env_checking": false, "render_env": false, "action_mask_key": "action_mask", "env_runner_cls": null, "num_env_runners": 0, "create_local_env_runner": true, "num_envs_per_env_runner": 1, "gym_env_vectorize_mode": "SYNC", "num_cpus_per_env_runner": 1, "num_gpus_per_env_runner": 0, "custom_resources_per_env_runner": {}, "validate_env_runners_after_construction": true, "episodes_to_numpy": true, "max_requests_in_flight_per_env_runner": 1, "sample_timeout_s": 60.0, "_env_to_module_connector": null, "add_default_connectors_to_env_to_module_pipeline": true, "_module_to_env_connector": null, "add_default_connectors_to_module_to_env_pipeline": true, "merge_env_runner_states": "training_only", "broadcast_env_runner_states": true, "episode_lookback_horizon": 1, "rollout_fragment_length": "auto", "batch_mode": "complete_episodes", "compress_observations": false, "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "enable_tf1_exec_eagerly": false, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "preprocessor_pref": "deepmind", "observation_filter": "NoFilter", "update_worker_filter_stats": true, "use_worker_filter_stats": true, "sampler_perf_stats_ema_coef": null, "_is_online": true, "num_learners": 0, "num_gpus_per_learner": 0, "num_cpus_per_learner": "auto", "num_aggregator_actors_per_learner": 0, "max_requests_in_flight_per_aggregator_actor": 3, "local_gpu_idx": 0, "max_requests_in_flight_per_learner": 3, "gamma": 1, "lr": 0.0002847858517, "grad_clip": 0.5, "grad_clip_by": "global_norm", "_train_batch_size_per_learner": 5000, "train_batch_size": 4000, "num_epochs": 1, "minibatch_size": 1000, "shuffle_batch_per_epoch": true, "model": {"fcnet_hiddens": [256, 256], "fcnet_activation": "tanh", "fcnet_weights_initializer": null, "fcnet_weights_initializer_config": null, "fcnet_bias_initializer": null, "fcnet_bias_initializer_config": null, "conv_filters": null, "conv_activation": "relu", "conv_kernel_initializer": null, "conv_kernel_initializer_config": null, "conv_bias_initializer": null, "conv_bias_initializer_config": null, "conv_transpose_kernel_initializer": null, "conv_transpose_kernel_initializer_config": null, "conv_transpose_bias_initializer": null, "conv_transpose_bias_initializer_config": null, "post_fcnet_hiddens": [], "post_fcnet_activation": "relu", "post_fcnet_weights_initializer": null, "post_fcnet_weights_initializer_config": null, "post_fcnet_bias_initializer": null, "post_fcnet_bias_initializer_config": null, "free_log_std": false, "log_std_clip_param": 20.0, "no_final_linear": false, "vf_share_layers": false, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "lstm_weights_initializer": null, "lstm_weights_initializer_config": null, "lstm_bias_initializer": null, "lstm_bias_initializer_config": null, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "attention_use_n_prev_actions": 0, "attention_use_n_prev_rewards": 0, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": null, "custom_model_config": {}, "custom_action_dist": null, "custom_preprocessor": null, "encoder_latent_dim": null, "always_check_shapes": false, "lstm_use_prev_action_reward": -1, "_use_default_native_models": -1, "_disable_preprocessor_api": false, "_disable_action_flattening": false}, "_learner_connector": null, "add_default_connectors_to_learner_pipeline": true, "learner_config_dict": {}, "optimizer": {}, "_learner_class": null, "callbacks_on_algorithm_init": null, "callbacks_on_env_runners_recreated": null, "callbacks_on_offline_eval_runners_recreated": null, "callbacks_on_checkpoint_loaded": null, "callbacks_on_environment_created": null, "callbacks_on_episode_created": null, "callbacks_on_episode_start": null, "callbacks_on_episode_step": null, "callbacks_on_episode_end": null, "callbacks_on_evaluate_start": null, "callbacks_on_evaluate_end": null, "callbacks_on_evaluate_offline_start": null, "callbacks_on_evaluate_offline_end": null, "callbacks_on_sample_end": null, "callbacks_on_train_result": null, "explore": true, "enable_rl_module_and_learner": true, "enable_env_runner_and_connector_v2": true, "_prior_exploration_config": {"type": "StochasticSampling"}, "count_steps_by": "env_steps", "policy_map_capacity": 100, "policy_mapping_fn": "<function AlgorithmConfig.DEFAULT_POLICY_MAPPING_FN at 0x3862edb20>", "policies_to_train": null, "policy_states_are_swappable": false, "observation_fn": null, "offline_data_class": null, "input_read_method": "read_parquet", "input_read_method_kwargs": {}, "input_read_schema": {}, "input_read_episodes": false, "input_read_sample_batches": false, "input_read_batch_size": null, "input_filesystem": null, "input_filesystem_kwargs": {}, "input_compress_columns": ["obs", "new_obs"], "input_spaces_jsonable": true, "materialize_data": false, "materialize_mapped_data": true, "map_batches_kwargs": {}, "iter_batches_kwargs": {}, "ignore_final_observation": false, "prelearner_class": null, "prelearner_buffer_class": null, "prelearner_buffer_kwargs": {}, "prelearner_module_synch_period": 10, "dataset_num_iters_per_learner": null, "input_config": {}, "actions_in_input_normalized": false, "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_config": {}, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "output_max_rows_per_file": null, "output_write_remaining_data": false, "output_write_method": "write_parquet", "output_write_method_kwargs": {}, "output_filesystem": null, "output_filesystem_kwargs": {}, "output_write_episodes": true, "offline_sampling": false, "evaluation_interval": 1, "evaluation_duration": 20, "evaluation_duration_unit": "episodes", "evaluation_sample_timeout_s": 120.0, "evaluation_auto_duration_min_env_steps_per_sample": 100, "evaluation_auto_duration_max_env_steps_per_sample": 2000, "evaluation_parallel_to_training": false, "evaluation_force_reset_envs_before_iteration": true, "evaluation_config": null, "off_policy_estimation_methods": {}, "ope_split_batch_by_episode": true, "evaluation_num_env_runners": 1, "in_evaluation": false, "sync_filters_on_rollout_workers_timeout_s": 10.0, "offline_evaluation_interval": null, "num_offline_eval_runners": 0, "offline_loss_for_module_fn": null, "offline_evaluation_duration": 1, "offline_evaluation_parallel_to_training": false, "offline_evaluation_timeout_s": 120.0, "num_cpus_per_offline_eval_runner": 1, "num_gpus_per_offline_eval_runner": 0, "custom_resources_per_offline_eval_runner": {}, "restart_failed_offline_eval_runners": true, "ignore_offline_eval_runner_failures": false, "max_num_offline_eval_runner_restarts": 1000, "offline_eval_runner_restore_timeout_s": 1800.0, "max_requests_in_flight_per_offline_eval_runner": 1, "validate_offline_eval_runners_after_construction": true, "offline_eval_runner_health_probe_timeout_s": 30.0, "offline_eval_rl_module_inference_only": false, "broadcast_offline_eval_runner_states": false, "offline_eval_batch_size_per_runner": 256, "dataset_num_iters_per_eval_runner": 1, "keep_per_episode_custom_metrics": false, "metrics_episode_collection_timeout_s": 60.0, "metrics_num_episodes_for_smoothing": 100, "min_time_s_per_iteration": null, "min_train_timesteps_per_iteration": 0, "min_sample_timesteps_per_iteration": 0, "log_gradients": true, "export_native_model_files": false, "checkpoint_trainable_policies_only": false, "logger_creator": null, "logger_config": null, "log_level": "WARN", "log_sys_usage": true, "fake_sampler": false, "seed": 9, "restart_failed_env_runners": true, "ignore_env_runner_failures": false, "max_num_env_runner_restarts": 1000, "delay_between_env_runner_restarts_s": 60.0, "restart_failed_sub_environments": false, "num_consecutive_env_runner_failures_tolerance": 100, "env_runner_health_probe_timeout_s": 30.0, "env_runner_restore_timeout_s": 1800.0, "_model_config": {}, "_rl_module_spec": "RLModuleSpec(module_class=None, observation_space=None, action_space=None, inference_only=False, learner_only=False, model_config=DefaultModelConfig(fcnet_hiddens=[60, 90], fcnet_activation='tanh', fcnet_kernel_initializer=None, fcnet_kernel_initializer_kwargs=None, fcnet_bias_initializer=None, fcnet_bias_initializer_kwargs=None, conv_filters=None, conv_activation='relu', conv_kernel_initializer=None, conv_kernel_initializer_kwargs=None, conv_bias_initializer=None, conv_bias_initializer_kwargs=None, head_fcnet_hiddens=[], head_fcnet_activation='relu', head_fcnet_kernel_initializer=None, head_fcnet_kernel_initializer_kwargs=None, head_fcnet_bias_initializer=None, head_fcnet_bias_initializer_kwargs=None, free_log_std=False, log_std_clip_param=20.0, vf_share_layers=True, use_lstm=False, max_seq_len=20, lstm_cell_size=256, lstm_use_prev_action=False, lstm_use_prev_reward=False, lstm_kernel_initializer=None, lstm_kernel_initializer_kwargs=None, lstm_bias_initializer=None, lstm_bias_initializer_kwargs=None), catalog_class=None, load_state_path=None, model_config_dict=None)", "algorithm_config_overrides_per_module": {}, "_per_module_overrides": {}, "_validate_config": true, "_use_msgpack_checkpoints": false, "_torch_grad_scaler_class": null, "_torch_lr_scheduler_classes": null, "_tf_policy_handles_more_than_one_loss": false, "_disable_preprocessor_api": false, "_disable_action_flattening": false, "_disable_initialize_loss_from_dummy_batch": false, "_dont_auto_sync_env_runner_states": false, "env_task_fn": -1, "enable_connectors": -1, "simple_optimizer": false, "policy_map_cache": -1, "worker_cls": -1, "synchronize_filters": -1, "enable_async_evaluation": -1, "custom_async_evaluation_function": -1, "_enable_rl_module_api": -1, "auto_wrap_old_gym_envs": -1, "always_attach_evaluation_results": -1, "replay_sequence_length": null, "_disable_execution_plan_api": -1, "use_critic": true, "use_gae": true, "use_kl_loss": true, "kl_coeff": 0.7464963036515, "kl_target": 0.0270990929592, "vf_loss_coeff": 0.6688075857018, "entropy_coeff": 0.0090570820258, "clip_param": 0.1221781641624, "vf_clip_param": 0.1027808522125, "entropy_coeff_schedule": null, "lr_schedule": null, "sgd_minibatch_size": -1, "vf_share_layers": -1, "__stdout_file__": null, "__stderr_file__": null, "lambda": 0.9099046732075, "input": "sampler", "policies": {"default_policy": [null, null, null, null]}, "callbacks": "<class 'ray.rllib.callbacks.callbacks.RLlibCallback'>", "create_env_on_driver": false, "custom_eval_function": null, "framework": "torch"}, "time_since_restore": 94.04018592834473, "iterations_since_restore": 12, "perf": {"cpu_util_percent": 83.69999999999999, "ram_util_percent": 81.54444444444442}}
{"timers": {"training_iteration": 17.82823845024427, "restore_env_runners": 3.3106961879510996e-05, "training_step": 17.827412174577475, "env_runner_sampling_timer": 16.72463034297433, "learner_update_timer": 1.040152520733649, "synch_weights": 0.04091598307698765, "restore_eval_env_runners": 0.00025685318655279706, "evaluation_iteration": 1.8942227991862386, "synch_eval_env_connectors": 0.0014031501312566517, "synch_env_connectors": 2.5787901763996275e-05}, "env_runners": {"module_to_env_connector": {"timers": {"connectors": {"un_batch_to_individual_items": 1.5211482759196841e-05, "tensor_to_numpy": 4.5096488632662805e-05, "normalize_and_clip_actions": 2.820354646020045e-05, "remove_single_ts_time_rank_from_batch": 1.7488978046450223e-06, "listify_data_for_vector_env": 3.801885947097869e-05, "get_actions": 0.00017898840047715113}}, "connector_pipeline_timer": 0.00037583122539739706}, "time_between_sampling": 0.004935182031160256, "episode_len_max": 20, "num_env_steps_sampled_lifetime": -6782500.0, "env_to_module_sum_episodes_length_in": 10.36823839457432, "sample": 0.017367982713062866, "num_agent_steps_sampled_lifetime": {"default_agent": -6782500.0}, "episode_len_mean": 20.0, "rlmodule_inference_timer": 0.00010222337768200309, "num_episodes_lifetime": -339125.0, "num_module_steps_sampled": {"default_policy": 5000.0}, "env_to_module_connector": {"connector_pipeline_timer": 0.00013164624134534008, "timers": {"connectors": {"add_states_from_episodes_to_batch": 4.162463427192972e-06, "batch_individual_items": 2.0299598043689833e-05, "add_observations_from_episodes_to_batch": 9.908653624134503e-06, "add_time_dim_to_batch_and_zero_pad": 6.975139129468985e-06, "numpy_to_tensor": 3.2991578393826814e-05}}}, "module_episode_returns_mean": {"default_policy": 9.460000000000004}, "num_agent_steps_sampled": {"default_agent": 5000.0}, "num_episodes": 250.0, "episode_len_min": 20, "env_to_module_sum_episodes_length_out": 10.36823839457432, "num_module_steps_sampled_lifetime": {"default_policy": -6782500.0}, "env_reset_timer": 0.00014096663077617648, "episode_duration_sec_mean": 0.015916894340887663, "episode_return_max": 14.5, "weights_seq_no": 12.0, "env_step_timer": 5.183827536165457e-05, "episode_return_min": -5.5, "agent_episode_returns_mean": {"default_agent": 9.460000000000004}, "num_env_steps_sampled": 5000.0, "episode_return_mean": 9.460000000000004, "num_env_steps_sampled_lifetime_throughput": 1556.1699163134597}, "learners": {"__all_modules__": {"num_non_trainable_parameters": 0, "learner_connector": {"timers": {"connectors": {"add_time_dim_to_batch_and_zero_pad": 0.00019444268073297928, "numpy_to_tensor": 0.00013914362943670533, "general_advantage_estimation": 0.05517601525652035, "add_states_from_episodes_to_batch": 6.641713294279905e-06, "add_one_ts_to_episodes_and_truncate": 0.10731142092161897, "batch_individual_items": 0.3316981961005747, "add_observations_from_episodes_to_batch": 0.004194484166286824, "add_columns_from_episodes_to_train_batch": 0.3148156978126964}}, "connector_pipeline_timer": 0.8141507565735693}, "learner_connector_sum_episodes_length_in": 5000.0, "num_module_steps_trained": 6000, "num_module_steps_trained_lifetime": 78000, "num_env_steps_trained": 31500, "learner_connector_sum_episodes_length_out": 5250.0, "num_trainable_parameters": 6003, "num_env_steps_trained_lifetime": 409500, "num_env_steps_trained_lifetime_throughput": 596930.7615920034, "num_module_steps_trained_throughput": 114091.57109377456, "num_module_steps_trained_lifetime_throughput": 113872.1330916004}, "default_policy": {"module_train_batch_size_mean": 1000.0, "mean_kl_loss": 0.00024740456137806177, "curr_entropy_coeff": 0.0090570820258, "weights_seq_no": 13.0, "num_module_steps_trained": 6000, "curr_kl_coeff": 9.112503903452307e-05, "diff_num_grad_updates_vs_sampler_policy": 1.0, "num_module_steps_trained_lifetime": 78000, "vf_loss": 0.10056453198194504, "gradients_default_optimizer_global_norm": 0.024964654818177223, "total_loss": 0.00666135223582387, "policy_loss": -0.05494841933250427, "num_trainable_parameters": 6003, "default_optimizer_learning_rate": 0.0002847858517, "vf_explained_var": 0.004157304763793945, "entropy": 0.6236662864685059, "vf_loss_unclipped": 36.1948127746582, "num_module_steps_trained_lifetime_throughput": 114173.91875832192}}, "num_training_step_calls_per_iteration": 1, "evaluation": {"env_runners": {"module_to_env_connector": {"connector_pipeline_timer": 0.0003209933018821665, "timers": {"connectors": {"remove_single_ts_time_rank_from_batch": 1.2472311169780388e-06, "normalize_and_clip_actions": 2.505616885460814e-05, "tensor_to_numpy": 3.7726166220806526e-05, "listify_data_for_vector_env": 3.385807554171375e-05, "un_batch_to_individual_items": 1.2326794085061595e-05, "get_actions": 0.00014541794004654327}}}, "env_to_module_connector": {"timers": {"connectors": {"numpy_to_tensor": 2.7328675771374843e-05, "add_states_from_episodes_to_batch": 3.248744661727792e-06, "batch_individual_items": 2.3322382194189787e-05, "add_observations_from_episodes_to_batch": 7.4860557369245286e-06, "add_time_dim_to_batch_and_zero_pad": 5.7110087654223005e-06}}, "connector_pipeline_timer": 0.00011668239761972314}, "num_episodes": 20, "num_env_steps_sampled": 400, "num_env_steps_sampled_lifetime": 65400, "episode_len_mean": 20.0, "num_module_steps_sampled": {"default_policy": 400}, "episode_return_max": 15.5, "weights_seq_no": 13.0, "episode_len_max": 20, "num_agent_steps_sampled_lifetime": {"default_agent": 5200}, "sample": 1.7256045647339777, "module_episode_returns_mean": {"default_policy": 0.9}, "num_agent_steps_sampled": {"default_agent": 400}, "agent_episode_returns_mean": {"default_agent": 0.9}, "rlmodule_inference_timer": 0.00010197168261979446, "num_episodes_lifetime": 260, "num_module_steps_sampled_lifetime": {"default_policy": 5200}, "episode_len_min": 20, "env_to_module_sum_episodes_length_out": 10.368238394574323, "env_reset_timer": 0.016874108690772823, "episode_duration_sec_mean": 0.012766698739724233, "env_step_timer": 4.631604021258444e-05, "episode_return_min": -12.5, "episode_return_mean": 0.9, "env_to_module_sum_episodes_length_in": 10.368238394574323, "time_between_sampling": 13.895216889873414}, "num_healthy_workers": 1, "actor_manager_num_outstanding_async_reqs": 0, "num_remote_worker_restarts": 0}, "num_env_steps_sampled_lifetime": -6782500.0, "fault_tolerance": {"num_healthy_workers": 0, "num_remote_worker_restarts": 0}, "env_runner_group": {"actor_manager_num_outstanding_async_reqs": 0}, "done": false, "training_iteration": 13, "trial_id": "497a0_00000", "date": "2025-08-11_19-29-33", "timestamp": 1754933373, "time_this_iter_s": 5.454208135604858, "time_total_s": 99.49439406394958, "pid": 19607, "hostname": "Mac", "node_ip": "127.0.0.1", "config": {"exploration_config": {}, "extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "placement_strategy": "PACK", "num_gpus": 0, "_fake_gpus": false, "num_cpus_for_main_process": 2, "eager_tracing": true, "eager_max_retraces": 20, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "torch_compile_learner": false, "torch_compile_learner_what_to_compile": "forward_train", "torch_compile_learner_dynamo_backend": "aot_eager", "torch_compile_learner_dynamo_mode": null, "torch_compile_worker": false, "torch_compile_worker_dynamo_backend": "aot_eager", "torch_compile_worker_dynamo_mode": null, "torch_ddp_kwargs": {}, "torch_skip_nan_gradients": false, "env": "Umbrella", "env_config": {}, "observation_space": null, "action_space": null, "clip_rewards": null, "normalize_actions": true, "clip_actions": false, "_is_atari": null, "disable_env_checking": false, "render_env": false, "action_mask_key": "action_mask", "env_runner_cls": null, "num_env_runners": 0, "create_local_env_runner": true, "num_envs_per_env_runner": 1, "gym_env_vectorize_mode": "SYNC", "num_cpus_per_env_runner": 1, "num_gpus_per_env_runner": 0, "custom_resources_per_env_runner": {}, "validate_env_runners_after_construction": true, "episodes_to_numpy": true, "max_requests_in_flight_per_env_runner": 1, "sample_timeout_s": 60.0, "_env_to_module_connector": null, "add_default_connectors_to_env_to_module_pipeline": true, "_module_to_env_connector": null, "add_default_connectors_to_module_to_env_pipeline": true, "merge_env_runner_states": "training_only", "broadcast_env_runner_states": true, "episode_lookback_horizon": 1, "rollout_fragment_length": "auto", "batch_mode": "complete_episodes", "compress_observations": false, "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "enable_tf1_exec_eagerly": false, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "preprocessor_pref": "deepmind", "observation_filter": "NoFilter", "update_worker_filter_stats": true, "use_worker_filter_stats": true, "sampler_perf_stats_ema_coef": null, "_is_online": true, "num_learners": 0, "num_gpus_per_learner": 0, "num_cpus_per_learner": "auto", "num_aggregator_actors_per_learner": 0, "max_requests_in_flight_per_aggregator_actor": 3, "local_gpu_idx": 0, "max_requests_in_flight_per_learner": 3, "gamma": 1, "lr": 0.0002847858517, "grad_clip": 0.5, "grad_clip_by": "global_norm", "_train_batch_size_per_learner": 5000, "train_batch_size": 4000, "num_epochs": 1, "minibatch_size": 1000, "shuffle_batch_per_epoch": true, "model": {"fcnet_hiddens": [256, 256], "fcnet_activation": "tanh", "fcnet_weights_initializer": null, "fcnet_weights_initializer_config": null, "fcnet_bias_initializer": null, "fcnet_bias_initializer_config": null, "conv_filters": null, "conv_activation": "relu", "conv_kernel_initializer": null, "conv_kernel_initializer_config": null, "conv_bias_initializer": null, "conv_bias_initializer_config": null, "conv_transpose_kernel_initializer": null, "conv_transpose_kernel_initializer_config": null, "conv_transpose_bias_initializer": null, "conv_transpose_bias_initializer_config": null, "post_fcnet_hiddens": [], "post_fcnet_activation": "relu", "post_fcnet_weights_initializer": null, "post_fcnet_weights_initializer_config": null, "post_fcnet_bias_initializer": null, "post_fcnet_bias_initializer_config": null, "free_log_std": false, "log_std_clip_param": 20.0, "no_final_linear": false, "vf_share_layers": false, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "lstm_weights_initializer": null, "lstm_weights_initializer_config": null, "lstm_bias_initializer": null, "lstm_bias_initializer_config": null, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "attention_use_n_prev_actions": 0, "attention_use_n_prev_rewards": 0, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": null, "custom_model_config": {}, "custom_action_dist": null, "custom_preprocessor": null, "encoder_latent_dim": null, "always_check_shapes": false, "lstm_use_prev_action_reward": -1, "_use_default_native_models": -1, "_disable_preprocessor_api": false, "_disable_action_flattening": false}, "_learner_connector": null, "add_default_connectors_to_learner_pipeline": true, "learner_config_dict": {}, "optimizer": {}, "_learner_class": null, "callbacks_on_algorithm_init": null, "callbacks_on_env_runners_recreated": null, "callbacks_on_offline_eval_runners_recreated": null, "callbacks_on_checkpoint_loaded": null, "callbacks_on_environment_created": null, "callbacks_on_episode_created": null, "callbacks_on_episode_start": null, "callbacks_on_episode_step": null, "callbacks_on_episode_end": null, "callbacks_on_evaluate_start": null, "callbacks_on_evaluate_end": null, "callbacks_on_evaluate_offline_start": null, "callbacks_on_evaluate_offline_end": null, "callbacks_on_sample_end": null, "callbacks_on_train_result": null, "explore": true, "enable_rl_module_and_learner": true, "enable_env_runner_and_connector_v2": true, "_prior_exploration_config": {"type": "StochasticSampling"}, "count_steps_by": "env_steps", "policy_map_capacity": 100, "policy_mapping_fn": "<function AlgorithmConfig.DEFAULT_POLICY_MAPPING_FN at 0x3862edb20>", "policies_to_train": null, "policy_states_are_swappable": false, "observation_fn": null, "offline_data_class": null, "input_read_method": "read_parquet", "input_read_method_kwargs": {}, "input_read_schema": {}, "input_read_episodes": false, "input_read_sample_batches": false, "input_read_batch_size": null, "input_filesystem": null, "input_filesystem_kwargs": {}, "input_compress_columns": ["obs", "new_obs"], "input_spaces_jsonable": true, "materialize_data": false, "materialize_mapped_data": true, "map_batches_kwargs": {}, "iter_batches_kwargs": {}, "ignore_final_observation": false, "prelearner_class": null, "prelearner_buffer_class": null, "prelearner_buffer_kwargs": {}, "prelearner_module_synch_period": 10, "dataset_num_iters_per_learner": null, "input_config": {}, "actions_in_input_normalized": false, "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_config": {}, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "output_max_rows_per_file": null, "output_write_remaining_data": false, "output_write_method": "write_parquet", "output_write_method_kwargs": {}, "output_filesystem": null, "output_filesystem_kwargs": {}, "output_write_episodes": true, "offline_sampling": false, "evaluation_interval": 1, "evaluation_duration": 20, "evaluation_duration_unit": "episodes", "evaluation_sample_timeout_s": 120.0, "evaluation_auto_duration_min_env_steps_per_sample": 100, "evaluation_auto_duration_max_env_steps_per_sample": 2000, "evaluation_parallel_to_training": false, "evaluation_force_reset_envs_before_iteration": true, "evaluation_config": null, "off_policy_estimation_methods": {}, "ope_split_batch_by_episode": true, "evaluation_num_env_runners": 1, "in_evaluation": false, "sync_filters_on_rollout_workers_timeout_s": 10.0, "offline_evaluation_interval": null, "num_offline_eval_runners": 0, "offline_loss_for_module_fn": null, "offline_evaluation_duration": 1, "offline_evaluation_parallel_to_training": false, "offline_evaluation_timeout_s": 120.0, "num_cpus_per_offline_eval_runner": 1, "num_gpus_per_offline_eval_runner": 0, "custom_resources_per_offline_eval_runner": {}, "restart_failed_offline_eval_runners": true, "ignore_offline_eval_runner_failures": false, "max_num_offline_eval_runner_restarts": 1000, "offline_eval_runner_restore_timeout_s": 1800.0, "max_requests_in_flight_per_offline_eval_runner": 1, "validate_offline_eval_runners_after_construction": true, "offline_eval_runner_health_probe_timeout_s": 30.0, "offline_eval_rl_module_inference_only": false, "broadcast_offline_eval_runner_states": false, "offline_eval_batch_size_per_runner": 256, "dataset_num_iters_per_eval_runner": 1, "keep_per_episode_custom_metrics": false, "metrics_episode_collection_timeout_s": 60.0, "metrics_num_episodes_for_smoothing": 100, "min_time_s_per_iteration": null, "min_train_timesteps_per_iteration": 0, "min_sample_timesteps_per_iteration": 0, "log_gradients": true, "export_native_model_files": false, "checkpoint_trainable_policies_only": false, "logger_creator": null, "logger_config": null, "log_level": "WARN", "log_sys_usage": true, "fake_sampler": false, "seed": 9, "restart_failed_env_runners": true, "ignore_env_runner_failures": false, "max_num_env_runner_restarts": 1000, "delay_between_env_runner_restarts_s": 60.0, "restart_failed_sub_environments": false, "num_consecutive_env_runner_failures_tolerance": 100, "env_runner_health_probe_timeout_s": 30.0, "env_runner_restore_timeout_s": 1800.0, "_model_config": {}, "_rl_module_spec": "RLModuleSpec(module_class=None, observation_space=None, action_space=None, inference_only=False, learner_only=False, model_config=DefaultModelConfig(fcnet_hiddens=[60, 90], fcnet_activation='tanh', fcnet_kernel_initializer=None, fcnet_kernel_initializer_kwargs=None, fcnet_bias_initializer=None, fcnet_bias_initializer_kwargs=None, conv_filters=None, conv_activation='relu', conv_kernel_initializer=None, conv_kernel_initializer_kwargs=None, conv_bias_initializer=None, conv_bias_initializer_kwargs=None, head_fcnet_hiddens=[], head_fcnet_activation='relu', head_fcnet_kernel_initializer=None, head_fcnet_kernel_initializer_kwargs=None, head_fcnet_bias_initializer=None, head_fcnet_bias_initializer_kwargs=None, free_log_std=False, log_std_clip_param=20.0, vf_share_layers=True, use_lstm=False, max_seq_len=20, lstm_cell_size=256, lstm_use_prev_action=False, lstm_use_prev_reward=False, lstm_kernel_initializer=None, lstm_kernel_initializer_kwargs=None, lstm_bias_initializer=None, lstm_bias_initializer_kwargs=None), catalog_class=None, load_state_path=None, model_config_dict=None)", "algorithm_config_overrides_per_module": {}, "_per_module_overrides": {}, "_validate_config": true, "_use_msgpack_checkpoints": false, "_torch_grad_scaler_class": null, "_torch_lr_scheduler_classes": null, "_tf_policy_handles_more_than_one_loss": false, "_disable_preprocessor_api": false, "_disable_action_flattening": false, "_disable_initialize_loss_from_dummy_batch": false, "_dont_auto_sync_env_runner_states": false, "env_task_fn": -1, "enable_connectors": -1, "simple_optimizer": false, "policy_map_cache": -1, "worker_cls": -1, "synchronize_filters": -1, "enable_async_evaluation": -1, "custom_async_evaluation_function": -1, "_enable_rl_module_api": -1, "auto_wrap_old_gym_envs": -1, "always_attach_evaluation_results": -1, "replay_sequence_length": null, "_disable_execution_plan_api": -1, "use_critic": true, "use_gae": true, "use_kl_loss": true, "kl_coeff": 0.7464963036515, "kl_target": 0.0270990929592, "vf_loss_coeff": 0.6688075857018, "entropy_coeff": 0.0090570820258, "clip_param": 0.1221781641624, "vf_clip_param": 0.1027808522125, "entropy_coeff_schedule": null, "lr_schedule": null, "sgd_minibatch_size": -1, "vf_share_layers": -1, "__stdout_file__": null, "__stderr_file__": null, "lambda": 0.9099046732075, "input": "sampler", "policies": {"default_policy": [null, null, null, null]}, "callbacks": "<class 'ray.rllib.callbacks.callbacks.RLlibCallback'>", "create_env_on_driver": false, "custom_eval_function": null, "framework": "torch"}, "time_since_restore": 99.49439406394958, "iterations_since_restore": 13, "perf": {"cpu_util_percent": 79.6125, "ram_util_percent": 80.9875}}
{"timers": {"training_iteration": 17.69893804574222, "restore_env_runners": 3.283880310063116e-05, "training_step": 17.698116327831816, "env_runner_sampling_timer": 16.600790493704, "learner_update_timer": 1.0352154292757518, "synch_weights": 0.040524449076586845, "restore_eval_env_runners": 0.00025452131423085787, "evaluation_iteration": 1.8781436024441025, "synch_eval_env_connectors": 0.0013935857105241557, "synch_env_connectors": 2.5588361956583446e-05}, "env_runners": {"module_to_env_connector": {"timers": {"connectors": {"un_batch_to_individual_items": 1.3382228232618424e-05, "tensor_to_numpy": 4.3142786710836695e-05, "normalize_and_clip_actions": 2.9000687373305424e-05, "remove_single_ts_time_rank_from_batch": 1.7414119526533196e-06, "listify_data_for_vector_env": 3.215694666828727e-05, "get_actions": 0.00014562830669002447}}, "connector_pipeline_timer": 0.000331777469045362}, "time_between_sampling": 0.004540059661303184, "episode_len_max": 20, "num_env_steps_sampled_lifetime": -7400000.0, "env_to_module_sum_episodes_length_in": 10.36823839457432, "sample": 0.01638207798686621, "num_agent_steps_sampled_lifetime": {"default_agent": -7400000.0}, "episode_len_mean": 20.0, "rlmodule_inference_timer": 9.976936436030882e-05, "num_episodes_lifetime": -370000.0, "num_module_steps_sampled": {"default_policy": 5000.0}, "env_to_module_connector": {"connector_pipeline_timer": 0.00012363112722104378, "timers": {"connectors": {"add_states_from_episodes_to_batch": 4.548843784060454e-06, "batch_individual_items": 2.1579282495536327e-05, "add_observations_from_episodes_to_batch": 8.330265337942212e-06, "add_time_dim_to_batch_and_zero_pad": 6.465678432701428e-06, "numpy_to_tensor": 3.174026137505226e-05}}}, "module_episode_returns_mean": {"default_policy": 11.859999999999996}, "num_agent_steps_sampled": {"default_agent": 5000.0}, "num_episodes": 250.0, "episode_len_min": 20, "env_to_module_sum_episodes_length_out": 10.36823839457432, "num_module_steps_sampled_lifetime": {"default_policy": -7400000.0}, "env_reset_timer": 0.0001339071843324569, "episode_duration_sec_mean": 0.014543144994881008, "episode_return_max": 14.5, "weights_seq_no": 13.0, "env_step_timer": 4.901856921743106e-05, "episode_return_min": -5.5, "agent_episode_returns_mean": {"default_agent": 11.859999999999996}, "num_env_steps_sampled": 5000.0, "episode_return_mean": 11.859999999999996, "num_env_steps_sampled_lifetime_throughput": 1566.4928340301879}, "learners": {"__all_modules__": {"num_non_trainable_parameters": 0, "learner_connector": {"timers": {"connectors": {"add_time_dim_to_batch_and_zero_pad": 0.00019267742409086045, "numpy_to_tensor": 0.00013886803283789622, "general_advantage_estimation": 0.05477600927461135, "add_states_from_episodes_to_batch": 6.607375567419736e-06, "add_one_ts_to_episodes_and_truncate": 0.10679255171147808, "batch_individual_items": 0.33154265663940957, "add_observations_from_episodes_to_batch": 0.004192042243577032, "add_columns_from_episodes_to_train_batch": 0.3125311541648629}}, "connector_pipeline_timer": 0.8107831481767738}, "learner_connector_sum_episodes_length_in": 5000.0, "num_module_steps_trained": 6000, "num_module_steps_trained_lifetime": 84000, "num_env_steps_trained": 31500, "learner_connector_sum_episodes_length_out": 5250.0, "num_trainable_parameters": 6003, "num_env_steps_trained_lifetime": 441000, "num_env_steps_trained_lifetime_throughput": 599895.7043960287, "num_module_steps_trained_throughput": 114651.84842202539, "num_module_steps_trained_lifetime_throughput": 114436.07424990182}, "default_policy": {"module_train_batch_size_mean": 1000.0, "mean_kl_loss": 0.0002494497748557478, "curr_entropy_coeff": 0.0090570820258, "weights_seq_no": 14.0, "num_module_steps_trained": 6000, "curr_kl_coeff": 4.5562519517261535e-05, "diff_num_grad_updates_vs_sampler_policy": 1.0, "num_module_steps_trained_lifetime": 84000, "vf_loss": 0.1025959849357605, "gradients_default_optimizer_global_norm": 0.03703908249735832, "total_loss": -0.26746711134910583, "policy_loss": -0.3303236663341522, "num_trainable_parameters": 6003, "default_optimizer_learning_rate": 0.0002847858517, "vf_explained_var": -0.01017308235168457, "entropy": 0.6360170841217041, "vf_loss_unclipped": 40.3286018371582, "num_module_steps_trained_lifetime_throughput": 114724.14703282257}}, "num_training_step_calls_per_iteration": 1, "evaluation": {"env_runners": {"module_to_env_connector": {"connector_pipeline_timer": 0.00038775740328311737, "timers": {"connectors": {"remove_single_ts_time_rank_from_batch": 3.1602963008989935e-06, "normalize_and_clip_actions": 2.745732848594113e-05, "tensor_to_numpy": 4.889991865281317e-05, "listify_data_for_vector_env": 3.732900072747209e-05, "un_batch_to_individual_items": 1.3582380471733701e-05, "get_actions": 0.00018340830248473155}}}, "env_to_module_connector": {"timers": {"connectors": {"numpy_to_tensor": 2.9783089832684364e-05, "add_states_from_episodes_to_batch": 3.344737655479211e-06, "batch_individual_items": 1.9444591959920964e-05, "add_observations_from_episodes_to_batch": 9.089536788632697e-06, "add_time_dim_to_batch_and_zero_pad": 7.305185086725015e-06}}, "connector_pipeline_timer": 0.00012734317103925855}, "num_episodes": 20, "num_env_steps_sampled": 400, "num_env_steps_sampled_lifetime": 70400, "episode_len_mean": 20.0, "num_module_steps_sampled": {"default_policy": 400}, "episode_return_max": 15.5, "weights_seq_no": 14.0, "episode_len_max": 20, "num_agent_steps_sampled_lifetime": {"default_agent": 5600}, "sample": 1.711617321996517, "module_episode_returns_mean": {"default_policy": 0.7}, "num_agent_steps_sampled": {"default_agent": 400}, "agent_episode_returns_mean": {"default_agent": 0.7}, "rlmodule_inference_timer": 0.00010637874709715133, "num_episodes_lifetime": 280, "num_module_steps_sampled_lifetime": {"default_policy": 5600}, "episode_len_min": 20, "env_to_module_sum_episodes_length_out": 10.368238394574323, "env_reset_timer": 0.016706119684097, "episode_duration_sec_mean": 0.01280212664976716, "env_step_timer": 5.212807372752477e-05, "episode_return_min": -12.5, "episode_return_mean": 0.7, "env_to_module_sum_episodes_length_in": 10.368238394574323, "time_between_sampling": 13.805618434305027}, "num_healthy_workers": 1, "actor_manager_num_outstanding_async_reqs": 0, "num_remote_worker_restarts": 0}, "num_env_steps_sampled_lifetime": -7400000.0, "fault_tolerance": {"num_healthy_workers": 0, "num_remote_worker_restarts": 0}, "env_runner_group": {"actor_manager_num_outstanding_async_reqs": 0}, "done": false, "training_iteration": 14, "trial_id": "497a0_00000", "date": "2025-08-11_19-29-38", "timestamp": 1754933378, "time_this_iter_s": 5.238330125808716, "time_total_s": 104.7327241897583, "pid": 19607, "hostname": "Mac", "node_ip": "127.0.0.1", "config": {"exploration_config": {}, "extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "placement_strategy": "PACK", "num_gpus": 0, "_fake_gpus": false, "num_cpus_for_main_process": 2, "eager_tracing": true, "eager_max_retraces": 20, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "torch_compile_learner": false, "torch_compile_learner_what_to_compile": "forward_train", "torch_compile_learner_dynamo_backend": "aot_eager", "torch_compile_learner_dynamo_mode": null, "torch_compile_worker": false, "torch_compile_worker_dynamo_backend": "aot_eager", "torch_compile_worker_dynamo_mode": null, "torch_ddp_kwargs": {}, "torch_skip_nan_gradients": false, "env": "Umbrella", "env_config": {}, "observation_space": null, "action_space": null, "clip_rewards": null, "normalize_actions": true, "clip_actions": false, "_is_atari": null, "disable_env_checking": false, "render_env": false, "action_mask_key": "action_mask", "env_runner_cls": null, "num_env_runners": 0, "create_local_env_runner": true, "num_envs_per_env_runner": 1, "gym_env_vectorize_mode": "SYNC", "num_cpus_per_env_runner": 1, "num_gpus_per_env_runner": 0, "custom_resources_per_env_runner": {}, "validate_env_runners_after_construction": true, "episodes_to_numpy": true, "max_requests_in_flight_per_env_runner": 1, "sample_timeout_s": 60.0, "_env_to_module_connector": null, "add_default_connectors_to_env_to_module_pipeline": true, "_module_to_env_connector": null, "add_default_connectors_to_module_to_env_pipeline": true, "merge_env_runner_states": "training_only", "broadcast_env_runner_states": true, "episode_lookback_horizon": 1, "rollout_fragment_length": "auto", "batch_mode": "complete_episodes", "compress_observations": false, "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "enable_tf1_exec_eagerly": false, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "preprocessor_pref": "deepmind", "observation_filter": "NoFilter", "update_worker_filter_stats": true, "use_worker_filter_stats": true, "sampler_perf_stats_ema_coef": null, "_is_online": true, "num_learners": 0, "num_gpus_per_learner": 0, "num_cpus_per_learner": "auto", "num_aggregator_actors_per_learner": 0, "max_requests_in_flight_per_aggregator_actor": 3, "local_gpu_idx": 0, "max_requests_in_flight_per_learner": 3, "gamma": 1, "lr": 0.0002847858517, "grad_clip": 0.5, "grad_clip_by": "global_norm", "_train_batch_size_per_learner": 5000, "train_batch_size": 4000, "num_epochs": 1, "minibatch_size": 1000, "shuffle_batch_per_epoch": true, "model": {"fcnet_hiddens": [256, 256], "fcnet_activation": "tanh", "fcnet_weights_initializer": null, "fcnet_weights_initializer_config": null, "fcnet_bias_initializer": null, "fcnet_bias_initializer_config": null, "conv_filters": null, "conv_activation": "relu", "conv_kernel_initializer": null, "conv_kernel_initializer_config": null, "conv_bias_initializer": null, "conv_bias_initializer_config": null, "conv_transpose_kernel_initializer": null, "conv_transpose_kernel_initializer_config": null, "conv_transpose_bias_initializer": null, "conv_transpose_bias_initializer_config": null, "post_fcnet_hiddens": [], "post_fcnet_activation": "relu", "post_fcnet_weights_initializer": null, "post_fcnet_weights_initializer_config": null, "post_fcnet_bias_initializer": null, "post_fcnet_bias_initializer_config": null, "free_log_std": false, "log_std_clip_param": 20.0, "no_final_linear": false, "vf_share_layers": false, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "lstm_weights_initializer": null, "lstm_weights_initializer_config": null, "lstm_bias_initializer": null, "lstm_bias_initializer_config": null, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "attention_use_n_prev_actions": 0, "attention_use_n_prev_rewards": 0, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": null, "custom_model_config": {}, "custom_action_dist": null, "custom_preprocessor": null, "encoder_latent_dim": null, "always_check_shapes": false, "lstm_use_prev_action_reward": -1, "_use_default_native_models": -1, "_disable_preprocessor_api": false, "_disable_action_flattening": false}, "_learner_connector": null, "add_default_connectors_to_learner_pipeline": true, "learner_config_dict": {}, "optimizer": {}, "_learner_class": null, "callbacks_on_algorithm_init": null, "callbacks_on_env_runners_recreated": null, "callbacks_on_offline_eval_runners_recreated": null, "callbacks_on_checkpoint_loaded": null, "callbacks_on_environment_created": null, "callbacks_on_episode_created": null, "callbacks_on_episode_start": null, "callbacks_on_episode_step": null, "callbacks_on_episode_end": null, "callbacks_on_evaluate_start": null, "callbacks_on_evaluate_end": null, "callbacks_on_evaluate_offline_start": null, "callbacks_on_evaluate_offline_end": null, "callbacks_on_sample_end": null, "callbacks_on_train_result": null, "explore": true, "enable_rl_module_and_learner": true, "enable_env_runner_and_connector_v2": true, "_prior_exploration_config": {"type": "StochasticSampling"}, "count_steps_by": "env_steps", "policy_map_capacity": 100, "policy_mapping_fn": "<function AlgorithmConfig.DEFAULT_POLICY_MAPPING_FN at 0x3862edb20>", "policies_to_train": null, "policy_states_are_swappable": false, "observation_fn": null, "offline_data_class": null, "input_read_method": "read_parquet", "input_read_method_kwargs": {}, "input_read_schema": {}, "input_read_episodes": false, "input_read_sample_batches": false, "input_read_batch_size": null, "input_filesystem": null, "input_filesystem_kwargs": {}, "input_compress_columns": ["obs", "new_obs"], "input_spaces_jsonable": true, "materialize_data": false, "materialize_mapped_data": true, "map_batches_kwargs": {}, "iter_batches_kwargs": {}, "ignore_final_observation": false, "prelearner_class": null, "prelearner_buffer_class": null, "prelearner_buffer_kwargs": {}, "prelearner_module_synch_period": 10, "dataset_num_iters_per_learner": null, "input_config": {}, "actions_in_input_normalized": false, "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_config": {}, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "output_max_rows_per_file": null, "output_write_remaining_data": false, "output_write_method": "write_parquet", "output_write_method_kwargs": {}, "output_filesystem": null, "output_filesystem_kwargs": {}, "output_write_episodes": true, "offline_sampling": false, "evaluation_interval": 1, "evaluation_duration": 20, "evaluation_duration_unit": "episodes", "evaluation_sample_timeout_s": 120.0, "evaluation_auto_duration_min_env_steps_per_sample": 100, "evaluation_auto_duration_max_env_steps_per_sample": 2000, "evaluation_parallel_to_training": false, "evaluation_force_reset_envs_before_iteration": true, "evaluation_config": null, "off_policy_estimation_methods": {}, "ope_split_batch_by_episode": true, "evaluation_num_env_runners": 1, "in_evaluation": false, "sync_filters_on_rollout_workers_timeout_s": 10.0, "offline_evaluation_interval": null, "num_offline_eval_runners": 0, "offline_loss_for_module_fn": null, "offline_evaluation_duration": 1, "offline_evaluation_parallel_to_training": false, "offline_evaluation_timeout_s": 120.0, "num_cpus_per_offline_eval_runner": 1, "num_gpus_per_offline_eval_runner": 0, "custom_resources_per_offline_eval_runner": {}, "restart_failed_offline_eval_runners": true, "ignore_offline_eval_runner_failures": false, "max_num_offline_eval_runner_restarts": 1000, "offline_eval_runner_restore_timeout_s": 1800.0, "max_requests_in_flight_per_offline_eval_runner": 1, "validate_offline_eval_runners_after_construction": true, "offline_eval_runner_health_probe_timeout_s": 30.0, "offline_eval_rl_module_inference_only": false, "broadcast_offline_eval_runner_states": false, "offline_eval_batch_size_per_runner": 256, "dataset_num_iters_per_eval_runner": 1, "keep_per_episode_custom_metrics": false, "metrics_episode_collection_timeout_s": 60.0, "metrics_num_episodes_for_smoothing": 100, "min_time_s_per_iteration": null, "min_train_timesteps_per_iteration": 0, "min_sample_timesteps_per_iteration": 0, "log_gradients": true, "export_native_model_files": false, "checkpoint_trainable_policies_only": false, "logger_creator": null, "logger_config": null, "log_level": "WARN", "log_sys_usage": true, "fake_sampler": false, "seed": 9, "restart_failed_env_runners": true, "ignore_env_runner_failures": false, "max_num_env_runner_restarts": 1000, "delay_between_env_runner_restarts_s": 60.0, "restart_failed_sub_environments": false, "num_consecutive_env_runner_failures_tolerance": 100, "env_runner_health_probe_timeout_s": 30.0, "env_runner_restore_timeout_s": 1800.0, "_model_config": {}, "_rl_module_spec": "RLModuleSpec(module_class=None, observation_space=None, action_space=None, inference_only=False, learner_only=False, model_config=DefaultModelConfig(fcnet_hiddens=[60, 90], fcnet_activation='tanh', fcnet_kernel_initializer=None, fcnet_kernel_initializer_kwargs=None, fcnet_bias_initializer=None, fcnet_bias_initializer_kwargs=None, conv_filters=None, conv_activation='relu', conv_kernel_initializer=None, conv_kernel_initializer_kwargs=None, conv_bias_initializer=None, conv_bias_initializer_kwargs=None, head_fcnet_hiddens=[], head_fcnet_activation='relu', head_fcnet_kernel_initializer=None, head_fcnet_kernel_initializer_kwargs=None, head_fcnet_bias_initializer=None, head_fcnet_bias_initializer_kwargs=None, free_log_std=False, log_std_clip_param=20.0, vf_share_layers=True, use_lstm=False, max_seq_len=20, lstm_cell_size=256, lstm_use_prev_action=False, lstm_use_prev_reward=False, lstm_kernel_initializer=None, lstm_kernel_initializer_kwargs=None, lstm_bias_initializer=None, lstm_bias_initializer_kwargs=None), catalog_class=None, load_state_path=None, model_config_dict=None)", "algorithm_config_overrides_per_module": {}, "_per_module_overrides": {}, "_validate_config": true, "_use_msgpack_checkpoints": false, "_torch_grad_scaler_class": null, "_torch_lr_scheduler_classes": null, "_tf_policy_handles_more_than_one_loss": false, "_disable_preprocessor_api": false, "_disable_action_flattening": false, "_disable_initialize_loss_from_dummy_batch": false, "_dont_auto_sync_env_runner_states": false, "env_task_fn": -1, "enable_connectors": -1, "simple_optimizer": false, "policy_map_cache": -1, "worker_cls": -1, "synchronize_filters": -1, "enable_async_evaluation": -1, "custom_async_evaluation_function": -1, "_enable_rl_module_api": -1, "auto_wrap_old_gym_envs": -1, "always_attach_evaluation_results": -1, "replay_sequence_length": null, "_disable_execution_plan_api": -1, "use_critic": true, "use_gae": true, "use_kl_loss": true, "kl_coeff": 0.7464963036515, "kl_target": 0.0270990929592, "vf_loss_coeff": 0.6688075857018, "entropy_coeff": 0.0090570820258, "clip_param": 0.1221781641624, "vf_clip_param": 0.1027808522125, "entropy_coeff_schedule": null, "lr_schedule": null, "sgd_minibatch_size": -1, "vf_share_layers": -1, "__stdout_file__": null, "__stderr_file__": null, "lambda": 0.9099046732075, "input": "sampler", "policies": {"default_policy": [null, null, null, null]}, "callbacks": "<class 'ray.rllib.callbacks.callbacks.RLlibCallback'>", "create_env_on_driver": false, "custom_eval_function": null, "framework": "torch"}, "time_since_restore": 104.7327241897583, "iterations_since_restore": 14, "perf": {"cpu_util_percent": 90.19999999999999, "ram_util_percent": 80.6625}}
{"timers": {"training_iteration": 17.565999274875285, "restore_env_runners": 3.263666515783972e-05, "training_step": 17.565182569963593, "env_runner_sampling_timer": 16.474700111266998, "learner_update_timer": 1.0289369203926566, "synch_weights": 0.040130939166442094, "restore_eval_env_runners": 0.00025205068140032454, "evaluation_iteration": 1.862719656419278, "synch_eval_env_connectors": 0.0013827702741523809, "synch_env_connectors": 2.5384978154701903e-05}, "env_runners": {"module_to_env_connector": {"timers": {"connectors": {"un_batch_to_individual_items": 1.3251799179499144e-05, "tensor_to_numpy": 4.148518538617536e-05, "normalize_and_clip_actions": 2.429789918359201e-05, "remove_single_ts_time_rank_from_batch": 1.3833104423096214e-06, "listify_data_for_vector_env": 3.1673584610822676e-05, "get_actions": 0.0001404599536521537}}, "connector_pipeline_timer": 0.00032136538354221236}, "time_between_sampling": 0.005427894687008945, "episode_len_max": 20, "num_env_steps_sampled_lifetime": -8017500.0, "env_to_module_sum_episodes_length_in": 10.36823839457432, "sample": 0.015006643578819912, "num_agent_steps_sampled_lifetime": {"default_agent": -8017500.0}, "episode_len_mean": 20.0, "rlmodule_inference_timer": 9.140715092736765e-05, "num_episodes_lifetime": -400875.0, "num_module_steps_sampled": {"default_policy": 5000.0}, "env_to_module_connector": {"connector_pipeline_timer": 0.00011445503738389718, "timers": {"connectors": {"add_states_from_episodes_to_batch": 3.5808634120267253e-06, "batch_individual_items": 1.882429764113634e-05, "add_observations_from_episodes_to_batch": 8.296957223716417e-06, "add_time_dim_to_batch_and_zero_pad": 5.782155308218748e-06, "numpy_to_tensor": 2.9456783072053243e-05}}}, "module_episode_returns_mean": {"default_policy": 10.5}, "num_agent_steps_sampled": {"default_agent": 5000.0}, "num_episodes": 250.0, "episode_len_min": 20, "env_to_module_sum_episodes_length_out": 10.36823839457432, "num_module_steps_sampled_lifetime": {"default_policy": -8017500.0}, "env_reset_timer": 0.00012456046076274907, "episode_duration_sec_mean": 0.01335982754873112, "episode_return_max": 14.5, "weights_seq_no": 14.0, "env_step_timer": 4.067759684898417e-05, "episode_return_min": -5.5, "agent_episode_returns_mean": {"default_agent": 10.5}, "num_env_steps_sampled": 5000.0, "episode_return_mean": 10.5, "num_env_steps_sampled_lifetime_throughput": 1664.531975740891}, "learners": {"__all_modules__": {"num_non_trainable_parameters": 0, "learner_connector": {"timers": {"connectors": {"add_time_dim_to_batch_and_zero_pad": 0.0001910885697687721, "numpy_to_tensor": 0.0001381689316834398, "general_advantage_estimation": 0.05438319793214322, "add_states_from_episodes_to_batch": 6.6175515192357445e-06, "add_one_ts_to_episodes_and_truncate": 0.10583687536339632, "batch_individual_items": 0.3305200704932839, "add_observations_from_episodes_to_batch": 0.004171460981298629, "add_columns_from_episodes_to_train_batch": 0.31029225262301696}}, "connector_pipeline_timer": 0.8061466271154335}, "learner_connector_sum_episodes_length_in": 5000.0, "num_module_steps_trained": 6000, "num_module_steps_trained_lifetime": 90000, "num_env_steps_trained": 31500, "learner_connector_sum_episodes_length_out": 5250.0, "num_trainable_parameters": 6003, "num_env_steps_trained_lifetime": 472500, "num_env_steps_trained_lifetime_throughput": 601215.8850571134, "num_module_steps_trained_throughput": 114886.70797111017, "num_module_steps_trained_lifetime_throughput": 114677.96938893289}, "default_policy": {"module_train_batch_size_mean": 1000.0, "mean_kl_loss": 0.00010712061339290813, "curr_entropy_coeff": 0.0090570820258, "weights_seq_no": 15.0, "num_module_steps_trained": 6000, "curr_kl_coeff": 2.2781259758630767e-05, "diff_num_grad_updates_vs_sampler_policy": 1.0, "num_module_steps_trained_lifetime": 90000, "vf_loss": 0.10167106240987778, "gradients_default_optimizer_global_norm": 0.04398268088698387, "total_loss": -0.16265712678432465, "policy_loss": -0.22504158318042755, "num_trainable_parameters": 6003, "default_optimizer_learning_rate": 0.0002847858517, "vf_explained_var": 0.0007898807525634766, "entropy": 0.6198380589485168, "vf_loss_unclipped": 38.51253128051758, "num_module_steps_trained_lifetime_throughput": 114945.38209634428}}, "num_training_step_calls_per_iteration": 1, "evaluation": {"env_runners": {"module_to_env_connector": {"connector_pipeline_timer": 0.00023324626309488992, "timers": {"connectors": {"remove_single_ts_time_rank_from_batch": 1.0810217725422359e-06, "normalize_and_clip_actions": 1.7082023887309614e-05, "tensor_to_numpy": 3.3294215671915396e-05, "listify_data_for_vector_env": 3.0895704283785515e-05, "un_batch_to_individual_items": 9.443057777870332e-06, "get_actions": 9.213649302123713e-05}}}, "env_to_module_connector": {"timers": {"connectors": {"numpy_to_tensor": 1.8754062296539862e-05, "add_states_from_episodes_to_batch": 2.319835679179898e-06, "batch_individual_items": 1.2802753852302675e-05, "add_observations_from_episodes_to_batch": 5.271376478363631e-06, "add_time_dim_to_batch_and_zero_pad": 3.858056112973259e-06}}, "connector_pipeline_timer": 8.109746347013912e-05}, "num_episodes": 20, "num_env_steps_sampled": 400, "num_env_steps_sampled_lifetime": 75400, "episode_len_mean": 20.0, "num_module_steps_sampled": {"default_policy": 400}, "episode_return_max": 15.5, "weights_seq_no": 15.0, "episode_len_max": 20, "num_agent_steps_sampled_lifetime": {"default_agent": 6000}, "sample": 1.6966439750266076, "module_episode_returns_mean": {"default_policy": 2.1}, "num_agent_steps_sampled": {"default_agent": 400}, "agent_episode_returns_mean": {"default_agent": 2.1}, "rlmodule_inference_timer": 9.082875423807207e-05, "num_episodes_lifetime": 300, "num_module_steps_sampled_lifetime": {"default_policy": 6000}, "episode_len_min": 20, "env_to_module_sum_episodes_length_out": 10.368238394574323, "env_reset_timer": 0.01654113389653989, "episode_duration_sec_mean": 0.012102569552371278, "env_step_timer": 8.913224762730663e-05, "episode_return_min": -12.5, "episode_return_mean": 2.1, "env_to_module_sum_episodes_length_in": 10.368238394574323, "time_between_sampling": 13.71218617788187}, "num_healthy_workers": 1, "actor_manager_num_outstanding_async_reqs": 0, "num_remote_worker_restarts": 0}, "num_env_steps_sampled_lifetime": -8017500.0, "fault_tolerance": {"num_healthy_workers": 0, "num_remote_worker_restarts": 0}, "env_runner_group": {"actor_manager_num_outstanding_async_reqs": 0}, "done": false, "training_iteration": 15, "trial_id": "497a0_00000", "date": "2025-08-11_19-29-43", "timestamp": 1754933383, "time_this_iter_s": 4.638788938522339, "time_total_s": 109.37151312828064, "pid": 19607, "hostname": "Mac", "node_ip": "127.0.0.1", "config": {"exploration_config": {}, "extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "placement_strategy": "PACK", "num_gpus": 0, "_fake_gpus": false, "num_cpus_for_main_process": 2, "eager_tracing": true, "eager_max_retraces": 20, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "torch_compile_learner": false, "torch_compile_learner_what_to_compile": "forward_train", "torch_compile_learner_dynamo_backend": "aot_eager", "torch_compile_learner_dynamo_mode": null, "torch_compile_worker": false, "torch_compile_worker_dynamo_backend": "aot_eager", "torch_compile_worker_dynamo_mode": null, "torch_ddp_kwargs": {}, "torch_skip_nan_gradients": false, "env": "Umbrella", "env_config": {}, "observation_space": null, "action_space": null, "clip_rewards": null, "normalize_actions": true, "clip_actions": false, "_is_atari": null, "disable_env_checking": false, "render_env": false, "action_mask_key": "action_mask", "env_runner_cls": null, "num_env_runners": 0, "create_local_env_runner": true, "num_envs_per_env_runner": 1, "gym_env_vectorize_mode": "SYNC", "num_cpus_per_env_runner": 1, "num_gpus_per_env_runner": 0, "custom_resources_per_env_runner": {}, "validate_env_runners_after_construction": true, "episodes_to_numpy": true, "max_requests_in_flight_per_env_runner": 1, "sample_timeout_s": 60.0, "_env_to_module_connector": null, "add_default_connectors_to_env_to_module_pipeline": true, "_module_to_env_connector": null, "add_default_connectors_to_module_to_env_pipeline": true, "merge_env_runner_states": "training_only", "broadcast_env_runner_states": true, "episode_lookback_horizon": 1, "rollout_fragment_length": "auto", "batch_mode": "complete_episodes", "compress_observations": false, "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "enable_tf1_exec_eagerly": false, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "preprocessor_pref": "deepmind", "observation_filter": "NoFilter", "update_worker_filter_stats": true, "use_worker_filter_stats": true, "sampler_perf_stats_ema_coef": null, "_is_online": true, "num_learners": 0, "num_gpus_per_learner": 0, "num_cpus_per_learner": "auto", "num_aggregator_actors_per_learner": 0, "max_requests_in_flight_per_aggregator_actor": 3, "local_gpu_idx": 0, "max_requests_in_flight_per_learner": 3, "gamma": 1, "lr": 0.0002847858517, "grad_clip": 0.5, "grad_clip_by": "global_norm", "_train_batch_size_per_learner": 5000, "train_batch_size": 4000, "num_epochs": 1, "minibatch_size": 1000, "shuffle_batch_per_epoch": true, "model": {"fcnet_hiddens": [256, 256], "fcnet_activation": "tanh", "fcnet_weights_initializer": null, "fcnet_weights_initializer_config": null, "fcnet_bias_initializer": null, "fcnet_bias_initializer_config": null, "conv_filters": null, "conv_activation": "relu", "conv_kernel_initializer": null, "conv_kernel_initializer_config": null, "conv_bias_initializer": null, "conv_bias_initializer_config": null, "conv_transpose_kernel_initializer": null, "conv_transpose_kernel_initializer_config": null, "conv_transpose_bias_initializer": null, "conv_transpose_bias_initializer_config": null, "post_fcnet_hiddens": [], "post_fcnet_activation": "relu", "post_fcnet_weights_initializer": null, "post_fcnet_weights_initializer_config": null, "post_fcnet_bias_initializer": null, "post_fcnet_bias_initializer_config": null, "free_log_std": false, "log_std_clip_param": 20.0, "no_final_linear": false, "vf_share_layers": false, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "lstm_weights_initializer": null, "lstm_weights_initializer_config": null, "lstm_bias_initializer": null, "lstm_bias_initializer_config": null, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "attention_use_n_prev_actions": 0, "attention_use_n_prev_rewards": 0, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": null, "custom_model_config": {}, "custom_action_dist": null, "custom_preprocessor": null, "encoder_latent_dim": null, "always_check_shapes": false, "lstm_use_prev_action_reward": -1, "_use_default_native_models": -1, "_disable_preprocessor_api": false, "_disable_action_flattening": false}, "_learner_connector": null, "add_default_connectors_to_learner_pipeline": true, "learner_config_dict": {}, "optimizer": {}, "_learner_class": null, "callbacks_on_algorithm_init": null, "callbacks_on_env_runners_recreated": null, "callbacks_on_offline_eval_runners_recreated": null, "callbacks_on_checkpoint_loaded": null, "callbacks_on_environment_created": null, "callbacks_on_episode_created": null, "callbacks_on_episode_start": null, "callbacks_on_episode_step": null, "callbacks_on_episode_end": null, "callbacks_on_evaluate_start": null, "callbacks_on_evaluate_end": null, "callbacks_on_evaluate_offline_start": null, "callbacks_on_evaluate_offline_end": null, "callbacks_on_sample_end": null, "callbacks_on_train_result": null, "explore": true, "enable_rl_module_and_learner": true, "enable_env_runner_and_connector_v2": true, "_prior_exploration_config": {"type": "StochasticSampling"}, "count_steps_by": "env_steps", "policy_map_capacity": 100, "policy_mapping_fn": "<function AlgorithmConfig.DEFAULT_POLICY_MAPPING_FN at 0x3862edb20>", "policies_to_train": null, "policy_states_are_swappable": false, "observation_fn": null, "offline_data_class": null, "input_read_method": "read_parquet", "input_read_method_kwargs": {}, "input_read_schema": {}, "input_read_episodes": false, "input_read_sample_batches": false, "input_read_batch_size": null, "input_filesystem": null, "input_filesystem_kwargs": {}, "input_compress_columns": ["obs", "new_obs"], "input_spaces_jsonable": true, "materialize_data": false, "materialize_mapped_data": true, "map_batches_kwargs": {}, "iter_batches_kwargs": {}, "ignore_final_observation": false, "prelearner_class": null, "prelearner_buffer_class": null, "prelearner_buffer_kwargs": {}, "prelearner_module_synch_period": 10, "dataset_num_iters_per_learner": null, "input_config": {}, "actions_in_input_normalized": false, "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_config": {}, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "output_max_rows_per_file": null, "output_write_remaining_data": false, "output_write_method": "write_parquet", "output_write_method_kwargs": {}, "output_filesystem": null, "output_filesystem_kwargs": {}, "output_write_episodes": true, "offline_sampling": false, "evaluation_interval": 1, "evaluation_duration": 20, "evaluation_duration_unit": "episodes", "evaluation_sample_timeout_s": 120.0, "evaluation_auto_duration_min_env_steps_per_sample": 100, "evaluation_auto_duration_max_env_steps_per_sample": 2000, "evaluation_parallel_to_training": false, "evaluation_force_reset_envs_before_iteration": true, "evaluation_config": null, "off_policy_estimation_methods": {}, "ope_split_batch_by_episode": true, "evaluation_num_env_runners": 1, "in_evaluation": false, "sync_filters_on_rollout_workers_timeout_s": 10.0, "offline_evaluation_interval": null, "num_offline_eval_runners": 0, "offline_loss_for_module_fn": null, "offline_evaluation_duration": 1, "offline_evaluation_parallel_to_training": false, "offline_evaluation_timeout_s": 120.0, "num_cpus_per_offline_eval_runner": 1, "num_gpus_per_offline_eval_runner": 0, "custom_resources_per_offline_eval_runner": {}, "restart_failed_offline_eval_runners": true, "ignore_offline_eval_runner_failures": false, "max_num_offline_eval_runner_restarts": 1000, "offline_eval_runner_restore_timeout_s": 1800.0, "max_requests_in_flight_per_offline_eval_runner": 1, "validate_offline_eval_runners_after_construction": true, "offline_eval_runner_health_probe_timeout_s": 30.0, "offline_eval_rl_module_inference_only": false, "broadcast_offline_eval_runner_states": false, "offline_eval_batch_size_per_runner": 256, "dataset_num_iters_per_eval_runner": 1, "keep_per_episode_custom_metrics": false, "metrics_episode_collection_timeout_s": 60.0, "metrics_num_episodes_for_smoothing": 100, "min_time_s_per_iteration": null, "min_train_timesteps_per_iteration": 0, "min_sample_timesteps_per_iteration": 0, "log_gradients": true, "export_native_model_files": false, "checkpoint_trainable_policies_only": false, "logger_creator": null, "logger_config": null, "log_level": "WARN", "log_sys_usage": true, "fake_sampler": false, "seed": 9, "restart_failed_env_runners": true, "ignore_env_runner_failures": false, "max_num_env_runner_restarts": 1000, "delay_between_env_runner_restarts_s": 60.0, "restart_failed_sub_environments": false, "num_consecutive_env_runner_failures_tolerance": 100, "env_runner_health_probe_timeout_s": 30.0, "env_runner_restore_timeout_s": 1800.0, "_model_config": {}, "_rl_module_spec": "RLModuleSpec(module_class=None, observation_space=None, action_space=None, inference_only=False, learner_only=False, model_config=DefaultModelConfig(fcnet_hiddens=[60, 90], fcnet_activation='tanh', fcnet_kernel_initializer=None, fcnet_kernel_initializer_kwargs=None, fcnet_bias_initializer=None, fcnet_bias_initializer_kwargs=None, conv_filters=None, conv_activation='relu', conv_kernel_initializer=None, conv_kernel_initializer_kwargs=None, conv_bias_initializer=None, conv_bias_initializer_kwargs=None, head_fcnet_hiddens=[], head_fcnet_activation='relu', head_fcnet_kernel_initializer=None, head_fcnet_kernel_initializer_kwargs=None, head_fcnet_bias_initializer=None, head_fcnet_bias_initializer_kwargs=None, free_log_std=False, log_std_clip_param=20.0, vf_share_layers=True, use_lstm=False, max_seq_len=20, lstm_cell_size=256, lstm_use_prev_action=False, lstm_use_prev_reward=False, lstm_kernel_initializer=None, lstm_kernel_initializer_kwargs=None, lstm_bias_initializer=None, lstm_bias_initializer_kwargs=None), catalog_class=None, load_state_path=None, model_config_dict=None)", "algorithm_config_overrides_per_module": {}, "_per_module_overrides": {}, "_validate_config": true, "_use_msgpack_checkpoints": false, "_torch_grad_scaler_class": null, "_torch_lr_scheduler_classes": null, "_tf_policy_handles_more_than_one_loss": false, "_disable_preprocessor_api": false, "_disable_action_flattening": false, "_disable_initialize_loss_from_dummy_batch": false, "_dont_auto_sync_env_runner_states": false, "env_task_fn": -1, "enable_connectors": -1, "simple_optimizer": false, "policy_map_cache": -1, "worker_cls": -1, "synchronize_filters": -1, "enable_async_evaluation": -1, "custom_async_evaluation_function": -1, "_enable_rl_module_api": -1, "auto_wrap_old_gym_envs": -1, "always_attach_evaluation_results": -1, "replay_sequence_length": null, "_disable_execution_plan_api": -1, "use_critic": true, "use_gae": true, "use_kl_loss": true, "kl_coeff": 0.7464963036515, "kl_target": 0.0270990929592, "vf_loss_coeff": 0.6688075857018, "entropy_coeff": 0.0090570820258, "clip_param": 0.1221781641624, "vf_clip_param": 0.1027808522125, "entropy_coeff_schedule": null, "lr_schedule": null, "sgd_minibatch_size": -1, "vf_share_layers": -1, "__stdout_file__": null, "__stderr_file__": null, "lambda": 0.9099046732075, "input": "sampler", "policies": {"default_policy": [null, null, null, null]}, "callbacks": "<class 'ray.rllib.callbacks.callbacks.RLlibCallback'>", "create_env_on_driver": false, "custom_eval_function": null, "framework": "torch"}, "time_since_restore": 109.37151312828064, "iterations_since_restore": 15, "perf": {"cpu_util_percent": 89.80000000000001, "ram_util_percent": 80.2}}
{"timers": {"training_iteration": 17.43375537170623, "restore_env_runners": 3.238487881803653e-05, "training_step": 17.43293966468429, "env_runner_sampling_timer": 16.35075409306477, "learner_update_timer": 1.0211585891086332, "synch_weights": 0.03974789644471788, "restore_eval_env_runners": 0.0002498318451022311, "evaluation_iteration": 1.8463869102748074, "synch_eval_env_connectors": 0.0013722817411906496, "synch_env_connectors": 2.521362841927398e-05}, "env_runners": {"module_to_env_connector": {"timers": {"connectors": {"un_batch_to_individual_items": 1.3217605710356003e-05, "tensor_to_numpy": 4.128097773850541e-05, "normalize_and_clip_actions": 2.5590693297836083e-05, "remove_single_ts_time_rank_from_batch": 1.4235028642663946e-06, "listify_data_for_vector_env": 2.9892511193213276e-05, "get_actions": 0.00013873384783444432}}, "connector_pipeline_timer": 0.0003178922114247632}, "time_between_sampling": 0.004449858262433985, "episode_len_max": 20, "num_env_steps_sampled_lifetime": -8635000.0, "env_to_module_sum_episodes_length_in": 10.36823839457432, "sample": 0.014298008001027481, "num_agent_steps_sampled_lifetime": {"default_agent": -8635000.0}, "episode_len_mean": 20.0, "rlmodule_inference_timer": 9.405009550953327e-05, "num_episodes_lifetime": -431750.0, "num_module_steps_sampled": {"default_policy": 5000.0}, "env_to_module_connector": {"connector_pipeline_timer": 0.00011655447317516906, "timers": {"connectors": {"add_states_from_episodes_to_batch": 3.863678629249847e-06, "batch_individual_items": 1.948304882702285e-05, "add_observations_from_episodes_to_batch": 7.830029659521065e-06, "add_time_dim_to_batch_and_zero_pad": 6.549785269386246e-06, "numpy_to_tensor": 3.0905244591935366e-05}}}, "module_episode_returns_mean": {"default_policy": 11.700000000000003}, "num_agent_steps_sampled": {"default_agent": 5000.0}, "num_episodes": 250.0, "episode_len_min": 20, "env_to_module_sum_episodes_length_out": 10.36823839457432, "num_module_steps_sampled_lifetime": {"default_policy": -8635000.0}, "env_reset_timer": 0.00012340120358809325, "episode_duration_sec_mean": 0.013550565511453894, "episode_return_max": 14.5, "weights_seq_no": 15.0, "env_step_timer": 4.307802623372338e-05, "episode_return_min": -5.5, "agent_episode_returns_mean": {"default_agent": 11.700000000000003}, "num_env_steps_sampled": 5000.0, "episode_return_mean": 11.700000000000003, "num_env_steps_sampled_lifetime_throughput": 1695.192994245498}, "learners": {"__all_modules__": {"num_non_trainable_parameters": 0, "learner_connector": {"timers": {"connectors": {"add_time_dim_to_batch_and_zero_pad": 0.00018929310404190968, "numpy_to_tensor": 0.00013745141156823275, "general_advantage_estimation": 0.053955141783167015, "add_states_from_episodes_to_batch": 6.5855462293060285e-06, "add_one_ts_to_episodes_and_truncate": 0.10500050952952568, "batch_individual_items": 0.3276361935389848, "add_observations_from_episodes_to_batch": 0.004152988450672827, "add_columns_from_episodes_to_train_batch": 0.3078014184257127}}, "connector_pipeline_timer": 0.7994831937642486}, "learner_connector_sum_episodes_length_in": 5000.0, "num_module_steps_trained": 6000, "num_module_steps_trained_lifetime": 96000, "num_env_steps_trained": 31500, "learner_connector_sum_episodes_length_out": 5250.0, "num_trainable_parameters": 6003, "num_env_steps_trained_lifetime": 504000, "num_env_steps_trained_lifetime_throughput": 599007.486385141, "num_module_steps_trained_throughput": 114448.48469828472, "num_module_steps_trained_lifetime_throughput": 114247.76705560465}, "default_policy": {"module_train_batch_size_mean": 1000.0, "mean_kl_loss": 0.0001255715760635212, "curr_entropy_coeff": 0.0090570820258, "weights_seq_no": 16.0, "num_module_steps_trained": 6000, "curr_kl_coeff": 1.1390629879315384e-05, "diff_num_grad_updates_vs_sampler_policy": 1.0, "num_module_steps_trained_lifetime": 96000, "vf_loss": 0.10140769928693771, "gradients_default_optimizer_global_norm": 0.12816815078258514, "total_loss": 0.07125132530927658, "policy_loss": 0.00893791951239109, "num_trainable_parameters": 6003, "default_optimizer_learning_rate": 0.0002847858517, "vf_explained_var": 0.003667175769805908, "entropy": 0.6082354187965393, "vf_loss_unclipped": 37.72899627685547, "num_module_steps_trained_lifetime_throughput": 114498.139558941}}, "num_training_step_calls_per_iteration": 1, "evaluation": {"env_runners": {"module_to_env_connector": {"connector_pipeline_timer": 0.0002736792469481145, "timers": {"connectors": {"remove_single_ts_time_rank_from_batch": 1.7074829339355998e-06, "normalize_and_clip_actions": 2.325584083896913e-05, "tensor_to_numpy": 3.1461794935601844e-05, "listify_data_for_vector_env": 2.482673702370373e-05, "un_batch_to_individual_items": 1.3128955710227475e-05, "get_actions": 0.00012631023303687685}}}, "env_to_module_connector": {"timers": {"connectors": {"numpy_to_tensor": 2.26824376689024e-05, "add_states_from_episodes_to_batch": 4.727613680387575e-06, "batch_individual_items": 1.316755812003268e-05, "add_observations_from_episodes_to_batch": 6.882141724999043e-06, "add_time_dim_to_batch_and_zero_pad": 4.811226551405764e-06}}, "connector_pipeline_timer": 9.449584544378957e-05}, "num_episodes": 20, "num_env_steps_sampled": 400, "num_env_steps_sampled_lifetime": 80400, "episode_len_mean": 20.0, "num_module_steps_sampled": {"default_policy": 400}, "episode_return_max": 15.5, "weights_seq_no": 16.0, "episode_len_max": 20, "num_agent_steps_sampled_lifetime": {"default_agent": 6400}, "sample": 1.6837379415258238, "module_episode_returns_mean": {"default_policy": 2.3}, "num_agent_steps_sampled": {"default_agent": 400}, "agent_episode_returns_mean": {"default_agent": 2.3}, "rlmodule_inference_timer": 7.665489136902173e-05, "num_episodes_lifetime": 320, "num_module_steps_sampled_lifetime": {"default_policy": 6400}, "episode_len_min": 20, "env_to_module_sum_episodes_length_out": 10.368238394574323, "env_reset_timer": 0.016380644217867387, "episode_duration_sec_mean": 0.013906181222992017, "env_step_timer": 3.822580050354189e-05, "episode_return_min": -13.5, "episode_return_mean": 2.3, "env_to_module_sum_episodes_length_in": 10.368238394574323, "time_between_sampling": 13.619216831523042}, "num_healthy_workers": 1, "actor_manager_num_outstanding_async_reqs": 0, "num_remote_worker_restarts": 0}, "num_env_steps_sampled_lifetime": -8635000.0, "fault_tolerance": {"num_healthy_workers": 0, "num_remote_worker_restarts": 0}, "env_runner_group": {"actor_manager_num_outstanding_async_reqs": 0}, "done": false, "training_iteration": 16, "trial_id": "497a0_00000", "date": "2025-08-11_19-29-48", "timestamp": 1754933388, "time_this_iter_s": 4.773521900177002, "time_total_s": 114.14503502845764, "pid": 19607, "hostname": "Mac", "node_ip": "127.0.0.1", "config": {"exploration_config": {}, "extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "placement_strategy": "PACK", "num_gpus": 0, "_fake_gpus": false, "num_cpus_for_main_process": 2, "eager_tracing": true, "eager_max_retraces": 20, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "torch_compile_learner": false, "torch_compile_learner_what_to_compile": "forward_train", "torch_compile_learner_dynamo_backend": "aot_eager", "torch_compile_learner_dynamo_mode": null, "torch_compile_worker": false, "torch_compile_worker_dynamo_backend": "aot_eager", "torch_compile_worker_dynamo_mode": null, "torch_ddp_kwargs": {}, "torch_skip_nan_gradients": false, "env": "Umbrella", "env_config": {}, "observation_space": null, "action_space": null, "clip_rewards": null, "normalize_actions": true, "clip_actions": false, "_is_atari": null, "disable_env_checking": false, "render_env": false, "action_mask_key": "action_mask", "env_runner_cls": null, "num_env_runners": 0, "create_local_env_runner": true, "num_envs_per_env_runner": 1, "gym_env_vectorize_mode": "SYNC", "num_cpus_per_env_runner": 1, "num_gpus_per_env_runner": 0, "custom_resources_per_env_runner": {}, "validate_env_runners_after_construction": true, "episodes_to_numpy": true, "max_requests_in_flight_per_env_runner": 1, "sample_timeout_s": 60.0, "_env_to_module_connector": null, "add_default_connectors_to_env_to_module_pipeline": true, "_module_to_env_connector": null, "add_default_connectors_to_module_to_env_pipeline": true, "merge_env_runner_states": "training_only", "broadcast_env_runner_states": true, "episode_lookback_horizon": 1, "rollout_fragment_length": "auto", "batch_mode": "complete_episodes", "compress_observations": false, "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "enable_tf1_exec_eagerly": false, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "preprocessor_pref": "deepmind", "observation_filter": "NoFilter", "update_worker_filter_stats": true, "use_worker_filter_stats": true, "sampler_perf_stats_ema_coef": null, "_is_online": true, "num_learners": 0, "num_gpus_per_learner": 0, "num_cpus_per_learner": "auto", "num_aggregator_actors_per_learner": 0, "max_requests_in_flight_per_aggregator_actor": 3, "local_gpu_idx": 0, "max_requests_in_flight_per_learner": 3, "gamma": 1, "lr": 0.0002847858517, "grad_clip": 0.5, "grad_clip_by": "global_norm", "_train_batch_size_per_learner": 5000, "train_batch_size": 4000, "num_epochs": 1, "minibatch_size": 1000, "shuffle_batch_per_epoch": true, "model": {"fcnet_hiddens": [256, 256], "fcnet_activation": "tanh", "fcnet_weights_initializer": null, "fcnet_weights_initializer_config": null, "fcnet_bias_initializer": null, "fcnet_bias_initializer_config": null, "conv_filters": null, "conv_activation": "relu", "conv_kernel_initializer": null, "conv_kernel_initializer_config": null, "conv_bias_initializer": null, "conv_bias_initializer_config": null, "conv_transpose_kernel_initializer": null, "conv_transpose_kernel_initializer_config": null, "conv_transpose_bias_initializer": null, "conv_transpose_bias_initializer_config": null, "post_fcnet_hiddens": [], "post_fcnet_activation": "relu", "post_fcnet_weights_initializer": null, "post_fcnet_weights_initializer_config": null, "post_fcnet_bias_initializer": null, "post_fcnet_bias_initializer_config": null, "free_log_std": false, "log_std_clip_param": 20.0, "no_final_linear": false, "vf_share_layers": false, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "lstm_weights_initializer": null, "lstm_weights_initializer_config": null, "lstm_bias_initializer": null, "lstm_bias_initializer_config": null, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "attention_use_n_prev_actions": 0, "attention_use_n_prev_rewards": 0, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": null, "custom_model_config": {}, "custom_action_dist": null, "custom_preprocessor": null, "encoder_latent_dim": null, "always_check_shapes": false, "lstm_use_prev_action_reward": -1, "_use_default_native_models": -1, "_disable_preprocessor_api": false, "_disable_action_flattening": false}, "_learner_connector": null, "add_default_connectors_to_learner_pipeline": true, "learner_config_dict": {}, "optimizer": {}, "_learner_class": null, "callbacks_on_algorithm_init": null, "callbacks_on_env_runners_recreated": null, "callbacks_on_offline_eval_runners_recreated": null, "callbacks_on_checkpoint_loaded": null, "callbacks_on_environment_created": null, "callbacks_on_episode_created": null, "callbacks_on_episode_start": null, "callbacks_on_episode_step": null, "callbacks_on_episode_end": null, "callbacks_on_evaluate_start": null, "callbacks_on_evaluate_end": null, "callbacks_on_evaluate_offline_start": null, "callbacks_on_evaluate_offline_end": null, "callbacks_on_sample_end": null, "callbacks_on_train_result": null, "explore": true, "enable_rl_module_and_learner": true, "enable_env_runner_and_connector_v2": true, "_prior_exploration_config": {"type": "StochasticSampling"}, "count_steps_by": "env_steps", "policy_map_capacity": 100, "policy_mapping_fn": "<function AlgorithmConfig.DEFAULT_POLICY_MAPPING_FN at 0x3862edb20>", "policies_to_train": null, "policy_states_are_swappable": false, "observation_fn": null, "offline_data_class": null, "input_read_method": "read_parquet", "input_read_method_kwargs": {}, "input_read_schema": {}, "input_read_episodes": false, "input_read_sample_batches": false, "input_read_batch_size": null, "input_filesystem": null, "input_filesystem_kwargs": {}, "input_compress_columns": ["obs", "new_obs"], "input_spaces_jsonable": true, "materialize_data": false, "materialize_mapped_data": true, "map_batches_kwargs": {}, "iter_batches_kwargs": {}, "ignore_final_observation": false, "prelearner_class": null, "prelearner_buffer_class": null, "prelearner_buffer_kwargs": {}, "prelearner_module_synch_period": 10, "dataset_num_iters_per_learner": null, "input_config": {}, "actions_in_input_normalized": false, "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_config": {}, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "output_max_rows_per_file": null, "output_write_remaining_data": false, "output_write_method": "write_parquet", "output_write_method_kwargs": {}, "output_filesystem": null, "output_filesystem_kwargs": {}, "output_write_episodes": true, "offline_sampling": false, "evaluation_interval": 1, "evaluation_duration": 20, "evaluation_duration_unit": "episodes", "evaluation_sample_timeout_s": 120.0, "evaluation_auto_duration_min_env_steps_per_sample": 100, "evaluation_auto_duration_max_env_steps_per_sample": 2000, "evaluation_parallel_to_training": false, "evaluation_force_reset_envs_before_iteration": true, "evaluation_config": null, "off_policy_estimation_methods": {}, "ope_split_batch_by_episode": true, "evaluation_num_env_runners": 1, "in_evaluation": false, "sync_filters_on_rollout_workers_timeout_s": 10.0, "offline_evaluation_interval": null, "num_offline_eval_runners": 0, "offline_loss_for_module_fn": null, "offline_evaluation_duration": 1, "offline_evaluation_parallel_to_training": false, "offline_evaluation_timeout_s": 120.0, "num_cpus_per_offline_eval_runner": 1, "num_gpus_per_offline_eval_runner": 0, "custom_resources_per_offline_eval_runner": {}, "restart_failed_offline_eval_runners": true, "ignore_offline_eval_runner_failures": false, "max_num_offline_eval_runner_restarts": 1000, "offline_eval_runner_restore_timeout_s": 1800.0, "max_requests_in_flight_per_offline_eval_runner": 1, "validate_offline_eval_runners_after_construction": true, "offline_eval_runner_health_probe_timeout_s": 30.0, "offline_eval_rl_module_inference_only": false, "broadcast_offline_eval_runner_states": false, "offline_eval_batch_size_per_runner": 256, "dataset_num_iters_per_eval_runner": 1, "keep_per_episode_custom_metrics": false, "metrics_episode_collection_timeout_s": 60.0, "metrics_num_episodes_for_smoothing": 100, "min_time_s_per_iteration": null, "min_train_timesteps_per_iteration": 0, "min_sample_timesteps_per_iteration": 0, "log_gradients": true, "export_native_model_files": false, "checkpoint_trainable_policies_only": false, "logger_creator": null, "logger_config": null, "log_level": "WARN", "log_sys_usage": true, "fake_sampler": false, "seed": 9, "restart_failed_env_runners": true, "ignore_env_runner_failures": false, "max_num_env_runner_restarts": 1000, "delay_between_env_runner_restarts_s": 60.0, "restart_failed_sub_environments": false, "num_consecutive_env_runner_failures_tolerance": 100, "env_runner_health_probe_timeout_s": 30.0, "env_runner_restore_timeout_s": 1800.0, "_model_config": {}, "_rl_module_spec": "RLModuleSpec(module_class=None, observation_space=None, action_space=None, inference_only=False, learner_only=False, model_config=DefaultModelConfig(fcnet_hiddens=[60, 90], fcnet_activation='tanh', fcnet_kernel_initializer=None, fcnet_kernel_initializer_kwargs=None, fcnet_bias_initializer=None, fcnet_bias_initializer_kwargs=None, conv_filters=None, conv_activation='relu', conv_kernel_initializer=None, conv_kernel_initializer_kwargs=None, conv_bias_initializer=None, conv_bias_initializer_kwargs=None, head_fcnet_hiddens=[], head_fcnet_activation='relu', head_fcnet_kernel_initializer=None, head_fcnet_kernel_initializer_kwargs=None, head_fcnet_bias_initializer=None, head_fcnet_bias_initializer_kwargs=None, free_log_std=False, log_std_clip_param=20.0, vf_share_layers=True, use_lstm=False, max_seq_len=20, lstm_cell_size=256, lstm_use_prev_action=False, lstm_use_prev_reward=False, lstm_kernel_initializer=None, lstm_kernel_initializer_kwargs=None, lstm_bias_initializer=None, lstm_bias_initializer_kwargs=None), catalog_class=None, load_state_path=None, model_config_dict=None)", "algorithm_config_overrides_per_module": {}, "_per_module_overrides": {}, "_validate_config": true, "_use_msgpack_checkpoints": false, "_torch_grad_scaler_class": null, "_torch_lr_scheduler_classes": null, "_tf_policy_handles_more_than_one_loss": false, "_disable_preprocessor_api": false, "_disable_action_flattening": false, "_disable_initialize_loss_from_dummy_batch": false, "_dont_auto_sync_env_runner_states": false, "env_task_fn": -1, "enable_connectors": -1, "simple_optimizer": false, "policy_map_cache": -1, "worker_cls": -1, "synchronize_filters": -1, "enable_async_evaluation": -1, "custom_async_evaluation_function": -1, "_enable_rl_module_api": -1, "auto_wrap_old_gym_envs": -1, "always_attach_evaluation_results": -1, "replay_sequence_length": null, "_disable_execution_plan_api": -1, "use_critic": true, "use_gae": true, "use_kl_loss": true, "kl_coeff": 0.7464963036515, "kl_target": 0.0270990929592, "vf_loss_coeff": 0.6688075857018, "entropy_coeff": 0.0090570820258, "clip_param": 0.1221781641624, "vf_clip_param": 0.1027808522125, "entropy_coeff_schedule": null, "lr_schedule": null, "sgd_minibatch_size": -1, "vf_share_layers": -1, "__stdout_file__": null, "__stderr_file__": null, "lambda": 0.9099046732075, "input": "sampler", "policies": {"default_policy": [null, null, null, null]}, "callbacks": "<class 'ray.rllib.callbacks.callbacks.RLlibCallback'>", "create_env_on_driver": false, "custom_eval_function": null, "framework": "torch"}, "time_since_restore": 114.14503502845764, "iterations_since_restore": 16, "perf": {"cpu_util_percent": 90.29999999999998, "ram_util_percent": 80.22857142857141}}
{"timers": {"training_iteration": 17.313916782158927, "restore_env_runners": 3.2127699920513236e-05, "training_step": 17.313105930537134, "env_runner_sampling_timer": 16.23904273379473, "learner_update_timer": 1.0133667898873264, "synch_weights": 0.03937264415126046, "restore_eval_env_runners": 0.000247484776929786, "evaluation_iteration": 1.8321726365920288, "synch_eval_env_connectors": 0.0014198580832031225, "synch_env_connectors": 2.4998572743389554e-05}, "env_runners": {"module_to_env_connector": {"timers": {"connectors": {"un_batch_to_individual_items": 1.7629733573284657e-05, "tensor_to_numpy": 4.569843586480633e-05, "normalize_and_clip_actions": 3.310388933115851e-05, "remove_single_ts_time_rank_from_batch": 2.2620333746371063e-06, "listify_data_for_vector_env": 3.8584650474455585e-05, "get_actions": 0.00017370294152992366}}, "connector_pipeline_timer": 0.00038524671872800485}, "time_between_sampling": 0.004854661546114812, "episode_len_max": 20, "num_env_steps_sampled_lifetime": -9252500.0, "env_to_module_sum_episodes_length_in": 10.36823839457432, "sample": 0.016896098700706682, "num_agent_steps_sampled_lifetime": {"default_agent": -9252500.0}, "episode_len_mean": 20.0, "rlmodule_inference_timer": 0.00015927830239460686, "num_episodes_lifetime": -462625.0, "num_module_steps_sampled": {"default_policy": 5000.0}, "env_to_module_connector": {"connector_pipeline_timer": 0.00012943340386337154, "timers": {"connectors": {"add_states_from_episodes_to_batch": 4.493409853256673e-06, "batch_individual_items": 2.0883208477080688e-05, "add_observations_from_episodes_to_batch": 1.0455255851230839e-05, "add_time_dim_to_batch_and_zero_pad": 7.614854338294661e-06, "numpy_to_tensor": 3.233724176229407e-05}}}, "module_episode_returns_mean": {"default_policy": 11.380000000000003}, "num_agent_steps_sampled": {"default_agent": 5000.0}, "num_episodes": 250.0, "episode_len_min": 20, "env_to_module_sum_episodes_length_out": 10.36823839457432, "num_module_steps_sampled_lifetime": {"default_policy": -9252500.0}, "env_reset_timer": 0.00014632569827358752, "episode_duration_sec_mean": 0.01762524581281469, "episode_return_max": 14.5, "weights_seq_no": 16.0, "env_step_timer": 5.803831365335333e-05, "episode_return_min": -5.5, "agent_episode_returns_mean": {"default_agent": 11.380000000000003}, "num_env_steps_sampled": 5000.0, "episode_return_mean": 11.380000000000003, "num_env_steps_sampled_lifetime_throughput": 1437.7682138588577}, "learners": {"__all_modules__": {"num_non_trainable_parameters": 0, "learner_connector": {"timers": {"connectors": {"add_time_dim_to_batch_and_zero_pad": 0.00018754184346323464, "numpy_to_tensor": 0.00013702314796388377, "general_advantage_estimation": 0.05372158994564041, "add_states_from_episodes_to_batch": 6.553440732963816e-06, "add_one_ts_to_episodes_and_truncate": 0.10410859776374945, "batch_individual_items": 0.3248405999337574, "add_observations_from_episodes_to_batch": 0.00414471397654676, "add_columns_from_episodes_to_train_batch": 0.3053367821622731}}, "connector_pipeline_timer": 0.7930835184966885}, "learner_connector_sum_episodes_length_in": 5000.0, "num_module_steps_trained": 6000, "num_module_steps_trained_lifetime": 102000, "num_env_steps_trained": 31500, "learner_connector_sum_episodes_length_out": 5250.0, "num_trainable_parameters": 6003, "num_env_steps_trained_lifetime": 535500, "num_env_steps_trained_lifetime_throughput": 595129.4181046877, "num_module_steps_trained_throughput": 113700.33215094692, "num_module_steps_trained_lifetime_throughput": 113508.26294539016}, "default_policy": {"module_train_batch_size_mean": 1000.0, "mean_kl_loss": 0.00019485194934532046, "curr_entropy_coeff": 0.0090570820258, "weights_seq_no": 17.0, "num_module_steps_trained": 6000, "curr_kl_coeff": 5.695314939657692e-06, "diff_num_grad_updates_vs_sampler_policy": 1.0, "num_module_steps_trained_lifetime": 102000, "vf_loss": 0.10092901438474655, "gradients_default_optimizer_global_norm": 0.0712444856762886, "total_loss": 0.113533154129982, "policy_loss": 0.05141635611653328, "num_trainable_parameters": 6003, "default_optimizer_learning_rate": 0.0002847858517, "vf_explained_var": 0.004249453544616699, "entropy": 0.5945951342582703, "vf_loss_unclipped": 37.01144027709961, "num_module_steps_trained_lifetime_throughput": 113740.97642886003}}, "num_training_step_calls_per_iteration": 1, "evaluation": {"env_runners": {"module_to_env_connector": {"connector_pipeline_timer": 0.0005553828371387305, "timers": {"connectors": {"remove_single_ts_time_rank_from_batch": 5.801894177882203e-06, "normalize_and_clip_actions": 4.121893153027907e-05, "tensor_to_numpy": 5.673832504936764e-05, "listify_data_for_vector_env": 5.674208989282709e-05, "un_batch_to_individual_items": 2.3271142638630146e-05, "get_actions": 0.00024371925459225555}}}, "env_to_module_connector": {"timers": {"connectors": {"numpy_to_tensor": 5.716867923642419e-05, "add_states_from_episodes_to_batch": 6.836193758307592e-06, "batch_individual_items": 2.5425152925998316e-05, "add_observations_from_episodes_to_batch": 1.4253779062008722e-05, "add_time_dim_to_batch_and_zero_pad": 1.1057328490644687e-05}}, "connector_pipeline_timer": 0.0001815660707043117}, "num_episodes": 20, "num_env_steps_sampled": 400, "num_env_steps_sampled_lifetime": 85400, "episode_len_mean": 20.0, "num_module_steps_sampled": {"default_policy": 400}, "episode_return_max": 15.5, "weights_seq_no": 17.0, "episode_len_max": 20, "num_agent_steps_sampled_lifetime": {"default_agent": 6800}, "sample": 1.6725208733600787, "module_episode_returns_mean": {"default_policy": 2.9}, "num_agent_steps_sampled": {"default_agent": 400}, "agent_episode_returns_mean": {"default_agent": 2.9}, "rlmodule_inference_timer": 0.00012646420877957914, "num_episodes_lifetime": 340, "num_module_steps_sampled_lifetime": {"default_policy": 6800}, "episode_len_min": 20, "env_to_module_sum_episodes_length_out": 10.368238394574323, "env_reset_timer": 0.016217741945553664, "episode_duration_sec_mean": 0.016536743324249984, "env_step_timer": 6.75566076709349e-05, "episode_return_min": -13.5, "episode_return_mean": 2.9, "env_to_module_sum_episodes_length_in": 10.368238394574323, "time_between_sampling": 13.538915915298034}, "num_healthy_workers": 1, "actor_manager_num_outstanding_async_reqs": 0, "num_remote_worker_restarts": 0}, "num_env_steps_sampled_lifetime": -9252500.0, "fault_tolerance": {"num_healthy_workers": 0, "num_remote_worker_restarts": 0}, "env_runner_group": {"actor_manager_num_outstanding_async_reqs": 0}, "done": false, "training_iteration": 17, "trial_id": "497a0_00000", "date": "2025-08-11_19-29-54", "timestamp": 1754933394, "time_this_iter_s": 6.132090091705322, "time_total_s": 120.27712512016296, "pid": 19607, "hostname": "Mac", "node_ip": "127.0.0.1", "config": {"exploration_config": {}, "extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "placement_strategy": "PACK", "num_gpus": 0, "_fake_gpus": false, "num_cpus_for_main_process": 2, "eager_tracing": true, "eager_max_retraces": 20, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "torch_compile_learner": false, "torch_compile_learner_what_to_compile": "forward_train", "torch_compile_learner_dynamo_backend": "aot_eager", "torch_compile_learner_dynamo_mode": null, "torch_compile_worker": false, "torch_compile_worker_dynamo_backend": "aot_eager", "torch_compile_worker_dynamo_mode": null, "torch_ddp_kwargs": {}, "torch_skip_nan_gradients": false, "env": "Umbrella", "env_config": {}, "observation_space": null, "action_space": null, "clip_rewards": null, "normalize_actions": true, "clip_actions": false, "_is_atari": null, "disable_env_checking": false, "render_env": false, "action_mask_key": "action_mask", "env_runner_cls": null, "num_env_runners": 0, "create_local_env_runner": true, "num_envs_per_env_runner": 1, "gym_env_vectorize_mode": "SYNC", "num_cpus_per_env_runner": 1, "num_gpus_per_env_runner": 0, "custom_resources_per_env_runner": {}, "validate_env_runners_after_construction": true, "episodes_to_numpy": true, "max_requests_in_flight_per_env_runner": 1, "sample_timeout_s": 60.0, "_env_to_module_connector": null, "add_default_connectors_to_env_to_module_pipeline": true, "_module_to_env_connector": null, "add_default_connectors_to_module_to_env_pipeline": true, "merge_env_runner_states": "training_only", "broadcast_env_runner_states": true, "episode_lookback_horizon": 1, "rollout_fragment_length": "auto", "batch_mode": "complete_episodes", "compress_observations": false, "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "enable_tf1_exec_eagerly": false, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "preprocessor_pref": "deepmind", "observation_filter": "NoFilter", "update_worker_filter_stats": true, "use_worker_filter_stats": true, "sampler_perf_stats_ema_coef": null, "_is_online": true, "num_learners": 0, "num_gpus_per_learner": 0, "num_cpus_per_learner": "auto", "num_aggregator_actors_per_learner": 0, "max_requests_in_flight_per_aggregator_actor": 3, "local_gpu_idx": 0, "max_requests_in_flight_per_learner": 3, "gamma": 1, "lr": 0.0002847858517, "grad_clip": 0.5, "grad_clip_by": "global_norm", "_train_batch_size_per_learner": 5000, "train_batch_size": 4000, "num_epochs": 1, "minibatch_size": 1000, "shuffle_batch_per_epoch": true, "model": {"fcnet_hiddens": [256, 256], "fcnet_activation": "tanh", "fcnet_weights_initializer": null, "fcnet_weights_initializer_config": null, "fcnet_bias_initializer": null, "fcnet_bias_initializer_config": null, "conv_filters": null, "conv_activation": "relu", "conv_kernel_initializer": null, "conv_kernel_initializer_config": null, "conv_bias_initializer": null, "conv_bias_initializer_config": null, "conv_transpose_kernel_initializer": null, "conv_transpose_kernel_initializer_config": null, "conv_transpose_bias_initializer": null, "conv_transpose_bias_initializer_config": null, "post_fcnet_hiddens": [], "post_fcnet_activation": "relu", "post_fcnet_weights_initializer": null, "post_fcnet_weights_initializer_config": null, "post_fcnet_bias_initializer": null, "post_fcnet_bias_initializer_config": null, "free_log_std": false, "log_std_clip_param": 20.0, "no_final_linear": false, "vf_share_layers": false, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "lstm_weights_initializer": null, "lstm_weights_initializer_config": null, "lstm_bias_initializer": null, "lstm_bias_initializer_config": null, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "attention_use_n_prev_actions": 0, "attention_use_n_prev_rewards": 0, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": null, "custom_model_config": {}, "custom_action_dist": null, "custom_preprocessor": null, "encoder_latent_dim": null, "always_check_shapes": false, "lstm_use_prev_action_reward": -1, "_use_default_native_models": -1, "_disable_preprocessor_api": false, "_disable_action_flattening": false}, "_learner_connector": null, "add_default_connectors_to_learner_pipeline": true, "learner_config_dict": {}, "optimizer": {}, "_learner_class": null, "callbacks_on_algorithm_init": null, "callbacks_on_env_runners_recreated": null, "callbacks_on_offline_eval_runners_recreated": null, "callbacks_on_checkpoint_loaded": null, "callbacks_on_environment_created": null, "callbacks_on_episode_created": null, "callbacks_on_episode_start": null, "callbacks_on_episode_step": null, "callbacks_on_episode_end": null, "callbacks_on_evaluate_start": null, "callbacks_on_evaluate_end": null, "callbacks_on_evaluate_offline_start": null, "callbacks_on_evaluate_offline_end": null, "callbacks_on_sample_end": null, "callbacks_on_train_result": null, "explore": true, "enable_rl_module_and_learner": true, "enable_env_runner_and_connector_v2": true, "_prior_exploration_config": {"type": "StochasticSampling"}, "count_steps_by": "env_steps", "policy_map_capacity": 100, "policy_mapping_fn": "<function AlgorithmConfig.DEFAULT_POLICY_MAPPING_FN at 0x3862edb20>", "policies_to_train": null, "policy_states_are_swappable": false, "observation_fn": null, "offline_data_class": null, "input_read_method": "read_parquet", "input_read_method_kwargs": {}, "input_read_schema": {}, "input_read_episodes": false, "input_read_sample_batches": false, "input_read_batch_size": null, "input_filesystem": null, "input_filesystem_kwargs": {}, "input_compress_columns": ["obs", "new_obs"], "input_spaces_jsonable": true, "materialize_data": false, "materialize_mapped_data": true, "map_batches_kwargs": {}, "iter_batches_kwargs": {}, "ignore_final_observation": false, "prelearner_class": null, "prelearner_buffer_class": null, "prelearner_buffer_kwargs": {}, "prelearner_module_synch_period": 10, "dataset_num_iters_per_learner": null, "input_config": {}, "actions_in_input_normalized": false, "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_config": {}, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "output_max_rows_per_file": null, "output_write_remaining_data": false, "output_write_method": "write_parquet", "output_write_method_kwargs": {}, "output_filesystem": null, "output_filesystem_kwargs": {}, "output_write_episodes": true, "offline_sampling": false, "evaluation_interval": 1, "evaluation_duration": 20, "evaluation_duration_unit": "episodes", "evaluation_sample_timeout_s": 120.0, "evaluation_auto_duration_min_env_steps_per_sample": 100, "evaluation_auto_duration_max_env_steps_per_sample": 2000, "evaluation_parallel_to_training": false, "evaluation_force_reset_envs_before_iteration": true, "evaluation_config": null, "off_policy_estimation_methods": {}, "ope_split_batch_by_episode": true, "evaluation_num_env_runners": 1, "in_evaluation": false, "sync_filters_on_rollout_workers_timeout_s": 10.0, "offline_evaluation_interval": null, "num_offline_eval_runners": 0, "offline_loss_for_module_fn": null, "offline_evaluation_duration": 1, "offline_evaluation_parallel_to_training": false, "offline_evaluation_timeout_s": 120.0, "num_cpus_per_offline_eval_runner": 1, "num_gpus_per_offline_eval_runner": 0, "custom_resources_per_offline_eval_runner": {}, "restart_failed_offline_eval_runners": true, "ignore_offline_eval_runner_failures": false, "max_num_offline_eval_runner_restarts": 1000, "offline_eval_runner_restore_timeout_s": 1800.0, "max_requests_in_flight_per_offline_eval_runner": 1, "validate_offline_eval_runners_after_construction": true, "offline_eval_runner_health_probe_timeout_s": 30.0, "offline_eval_rl_module_inference_only": false, "broadcast_offline_eval_runner_states": false, "offline_eval_batch_size_per_runner": 256, "dataset_num_iters_per_eval_runner": 1, "keep_per_episode_custom_metrics": false, "metrics_episode_collection_timeout_s": 60.0, "metrics_num_episodes_for_smoothing": 100, "min_time_s_per_iteration": null, "min_train_timesteps_per_iteration": 0, "min_sample_timesteps_per_iteration": 0, "log_gradients": true, "export_native_model_files": false, "checkpoint_trainable_policies_only": false, "logger_creator": null, "logger_config": null, "log_level": "WARN", "log_sys_usage": true, "fake_sampler": false, "seed": 9, "restart_failed_env_runners": true, "ignore_env_runner_failures": false, "max_num_env_runner_restarts": 1000, "delay_between_env_runner_restarts_s": 60.0, "restart_failed_sub_environments": false, "num_consecutive_env_runner_failures_tolerance": 100, "env_runner_health_probe_timeout_s": 30.0, "env_runner_restore_timeout_s": 1800.0, "_model_config": {}, "_rl_module_spec": "RLModuleSpec(module_class=None, observation_space=None, action_space=None, inference_only=False, learner_only=False, model_config=DefaultModelConfig(fcnet_hiddens=[60, 90], fcnet_activation='tanh', fcnet_kernel_initializer=None, fcnet_kernel_initializer_kwargs=None, fcnet_bias_initializer=None, fcnet_bias_initializer_kwargs=None, conv_filters=None, conv_activation='relu', conv_kernel_initializer=None, conv_kernel_initializer_kwargs=None, conv_bias_initializer=None, conv_bias_initializer_kwargs=None, head_fcnet_hiddens=[], head_fcnet_activation='relu', head_fcnet_kernel_initializer=None, head_fcnet_kernel_initializer_kwargs=None, head_fcnet_bias_initializer=None, head_fcnet_bias_initializer_kwargs=None, free_log_std=False, log_std_clip_param=20.0, vf_share_layers=True, use_lstm=False, max_seq_len=20, lstm_cell_size=256, lstm_use_prev_action=False, lstm_use_prev_reward=False, lstm_kernel_initializer=None, lstm_kernel_initializer_kwargs=None, lstm_bias_initializer=None, lstm_bias_initializer_kwargs=None), catalog_class=None, load_state_path=None, model_config_dict=None)", "algorithm_config_overrides_per_module": {}, "_per_module_overrides": {}, "_validate_config": true, "_use_msgpack_checkpoints": false, "_torch_grad_scaler_class": null, "_torch_lr_scheduler_classes": null, "_tf_policy_handles_more_than_one_loss": false, "_disable_preprocessor_api": false, "_disable_action_flattening": false, "_disable_initialize_loss_from_dummy_batch": false, "_dont_auto_sync_env_runner_states": false, "env_task_fn": -1, "enable_connectors": -1, "simple_optimizer": false, "policy_map_cache": -1, "worker_cls": -1, "synchronize_filters": -1, "enable_async_evaluation": -1, "custom_async_evaluation_function": -1, "_enable_rl_module_api": -1, "auto_wrap_old_gym_envs": -1, "always_attach_evaluation_results": -1, "replay_sequence_length": null, "_disable_execution_plan_api": -1, "use_critic": true, "use_gae": true, "use_kl_loss": true, "kl_coeff": 0.7464963036515, "kl_target": 0.0270990929592, "vf_loss_coeff": 0.6688075857018, "entropy_coeff": 0.0090570820258, "clip_param": 0.1221781641624, "vf_clip_param": 0.1027808522125, "entropy_coeff_schedule": null, "lr_schedule": null, "sgd_minibatch_size": -1, "vf_share_layers": -1, "__stdout_file__": null, "__stderr_file__": null, "lambda": 0.9099046732075, "input": "sampler", "policies": {"default_policy": [null, null, null, null]}, "callbacks": "<class 'ray.rllib.callbacks.callbacks.RLlibCallback'>", "create_env_on_driver": false, "custom_eval_function": null, "framework": "torch"}, "time_since_restore": 120.27712512016296, "iterations_since_restore": 17, "perf": {"cpu_util_percent": 93.23333333333333, "ram_util_percent": 80.84444444444443}}
{"timers": {"training_iteration": 17.19936188391707, "restore_env_runners": 3.2043502724208655e-05, "training_step": 17.198554880400707, "env_runner_sampling_timer": 16.130430918956375, "learner_update_timer": 1.0079444132382946, "synch_weights": 0.03900962978993595, "restore_eval_env_runners": 0.0002450982592859243, "evaluation_iteration": 1.8200827427257242, "synch_eval_env_connectors": 0.0014075386621978765, "synch_env_connectors": 2.485233751492104e-05}, "env_runners": {"module_to_env_connector": {"timers": {"connectors": {"un_batch_to_individual_items": 2.0865240650914148e-05, "tensor_to_numpy": 5.3262567266691654e-05, "normalize_and_clip_actions": 3.220068380671601e-05, "remove_single_ts_time_rank_from_batch": 2.7256540701329694e-06, "listify_data_for_vector_env": 4.0167965044205176e-05, "get_actions": 0.00019970440752963014}}, "connector_pipeline_timer": 0.0004561988233529791}, "time_between_sampling": 0.005887584734742983, "episode_len_max": 20, "num_env_steps_sampled_lifetime": -9870000.0, "env_to_module_sum_episodes_length_in": 10.36823839457432, "sample": 0.020200198337124133, "num_agent_steps_sampled_lifetime": {"default_agent": -9870000.0}, "episode_len_mean": 20.0, "rlmodule_inference_timer": 0.00011773473666934348, "num_episodes_lifetime": -493500.0, "num_module_steps_sampled": {"default_policy": 5000.0}, "env_to_module_connector": {"connector_pipeline_timer": 0.00014421305703736436, "timers": {"connectors": {"add_states_from_episodes_to_batch": 4.7056262639739545e-06, "batch_individual_items": 2.2838356429237406e-05, "add_observations_from_episodes_to_batch": 1.015809220284889e-05, "add_time_dim_to_batch_and_zero_pad": 1.0959796067013202e-05, "numpy_to_tensor": 3.93409057030565e-05}}}, "module_episode_returns_mean": {"default_policy": 12.420000000000002}, "num_agent_steps_sampled": {"default_agent": 5000.0}, "num_episodes": 250.0, "episode_len_min": 20, "env_to_module_sum_episodes_length_out": 10.36823839457432, "num_module_steps_sampled_lifetime": {"default_policy": -9870000.0}, "env_reset_timer": 0.00015667650553730748, "episode_duration_sec_mean": 0.018730315803550175, "episode_return_max": 14.5, "weights_seq_no": 17.0, "env_step_timer": 5.274596094894106e-05, "episode_return_min": -5.5, "agent_episode_returns_mean": {"default_agent": 12.420000000000002}, "num_env_steps_sampled": 5000.0, "episode_return_mean": 12.420000000000002, "num_env_steps_sampled_lifetime_throughput": 1438.120790972594}, "learners": {"__all_modules__": {"num_non_trainable_parameters": 0, "learner_connector": {"timers": {"connectors": {"add_time_dim_to_batch_and_zero_pad": 0.00018671392543778817, "numpy_to_tensor": 0.0001371220859947734, "general_advantage_estimation": 0.05338147987532232, "add_states_from_episodes_to_batch": 6.6012459546584445e-06, "add_one_ts_to_episodes_and_truncate": 0.10318343512631147, "batch_individual_items": 0.3248385018546187, "add_observations_from_episodes_to_batch": 0.004115091836018725, "add_columns_from_episodes_to_train_batch": 0.30295359309094744}}, "connector_pipeline_timer": 0.7893991124817378}, "learner_connector_sum_episodes_length_in": 5000.0, "num_module_steps_trained": 6000, "num_module_steps_trained_lifetime": 108000, "num_env_steps_trained": 31500, "learner_connector_sum_episodes_length_out": 5250.0, "num_trainable_parameters": 6003, "num_env_steps_trained_lifetime": 567000, "num_env_steps_trained_lifetime_throughput": 593140.8923652517, "num_module_steps_trained_throughput": 113314.06345102726, "num_module_steps_trained_lifetime_throughput": 113127.56966672308}, "default_policy": {"module_train_batch_size_mean": 1000.0, "mean_kl_loss": 0.0001815491123124957, "curr_entropy_coeff": 0.0090570820258, "weights_seq_no": 18.0, "num_module_steps_trained": 6000, "curr_kl_coeff": 2.847657469828846e-06, "diff_num_grad_updates_vs_sampler_policy": 1.0, "num_module_steps_trained_lifetime": 108000, "vf_loss": 0.10222505033016205, "gradients_default_optimizer_global_norm": 0.019866973161697388, "total_loss": -0.1346408873796463, "policy_loss": -0.19750188291072845, "num_trainable_parameters": 6003, "default_optimizer_learning_rate": 0.0002847858517, "vf_explained_var": -0.004913330078125, "entropy": 0.6081311106681824, "vf_loss_unclipped": 39.726741790771484, "num_module_steps_trained_lifetime_throughput": 113355.29155161437}}, "num_training_step_calls_per_iteration": 1, "evaluation": {"env_runners": {"module_to_env_connector": {"connector_pipeline_timer": 0.00034129660122760784, "timers": {"connectors": {"remove_single_ts_time_rank_from_batch": 1.5034002045509917e-06, "normalize_and_clip_actions": 3.536055292710238e-05, "tensor_to_numpy": 4.491530575125288e-05, "listify_data_for_vector_env": 2.7611135988237303e-05, "un_batch_to_individual_items": 1.4849525835583209e-05, "get_actions": 0.0001489166173540256}}}, "env_to_module_connector": {"timers": {"connectors": {"numpy_to_tensor": 2.3104642586758507e-05, "add_states_from_episodes_to_batch": 2.7769138335361457e-06, "batch_individual_items": 1.4291749755798078e-05, "add_observations_from_episodes_to_batch": 6.108820629879291e-06, "add_time_dim_to_batch_and_zero_pad": 6.066313810170868e-06}}, "connector_pipeline_timer": 0.00010234604207043345}, "num_episodes": 20, "num_env_steps_sampled": 400, "num_env_steps_sampled_lifetime": 90400, "episode_len_mean": 20.0, "num_module_steps_sampled": {"default_policy": 400}, "episode_return_max": 15.5, "weights_seq_no": 18.0, "episode_len_max": 20, "num_agent_steps_sampled_lifetime": {"default_agent": 7200}, "sample": 1.658413007126494, "module_episode_returns_mean": {"default_policy": 2.9}, "num_agent_steps_sampled": {"default_agent": 400}, "agent_episode_returns_mean": {"default_agent": 2.9}, "rlmodule_inference_timer": 7.837295088660409e-05, "num_episodes_lifetime": 360, "num_module_steps_sampled_lifetime": {"default_policy": 7200}, "episode_len_min": 20, "env_to_module_sum_episodes_length_out": 10.368238394574323, "env_reset_timer": 0.016057323696652706, "episode_duration_sec_mean": 0.01645640582195483, "env_step_timer": 3.7650303145160985e-05, "episode_return_min": -13.5, "episode_return_mean": 2.9, "env_to_module_sum_episodes_length_in": 10.368238394574323, "time_between_sampling": 13.462635735724813}, "num_healthy_workers": 1, "actor_manager_num_outstanding_async_reqs": 0, "num_remote_worker_restarts": 0}, "num_env_steps_sampled_lifetime": -9870000.0, "fault_tolerance": {"num_healthy_workers": 0, "num_remote_worker_restarts": 0}, "env_runner_group": {"actor_manager_num_outstanding_async_reqs": 0}, "done": false, "training_iteration": 18, "trial_id": "497a0_00000", "date": "2025-08-11_19-30-00", "timestamp": 1754933400, "time_this_iter_s": 6.135714054107666, "time_total_s": 126.41283917427063, "pid": 19607, "hostname": "Mac", "node_ip": "127.0.0.1", "config": {"exploration_config": {}, "extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "placement_strategy": "PACK", "num_gpus": 0, "_fake_gpus": false, "num_cpus_for_main_process": 2, "eager_tracing": true, "eager_max_retraces": 20, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "torch_compile_learner": false, "torch_compile_learner_what_to_compile": "forward_train", "torch_compile_learner_dynamo_backend": "aot_eager", "torch_compile_learner_dynamo_mode": null, "torch_compile_worker": false, "torch_compile_worker_dynamo_backend": "aot_eager", "torch_compile_worker_dynamo_mode": null, "torch_ddp_kwargs": {}, "torch_skip_nan_gradients": false, "env": "Umbrella", "env_config": {}, "observation_space": null, "action_space": null, "clip_rewards": null, "normalize_actions": true, "clip_actions": false, "_is_atari": null, "disable_env_checking": false, "render_env": false, "action_mask_key": "action_mask", "env_runner_cls": null, "num_env_runners": 0, "create_local_env_runner": true, "num_envs_per_env_runner": 1, "gym_env_vectorize_mode": "SYNC", "num_cpus_per_env_runner": 1, "num_gpus_per_env_runner": 0, "custom_resources_per_env_runner": {}, "validate_env_runners_after_construction": true, "episodes_to_numpy": true, "max_requests_in_flight_per_env_runner": 1, "sample_timeout_s": 60.0, "_env_to_module_connector": null, "add_default_connectors_to_env_to_module_pipeline": true, "_module_to_env_connector": null, "add_default_connectors_to_module_to_env_pipeline": true, "merge_env_runner_states": "training_only", "broadcast_env_runner_states": true, "episode_lookback_horizon": 1, "rollout_fragment_length": "auto", "batch_mode": "complete_episodes", "compress_observations": false, "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "enable_tf1_exec_eagerly": false, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "preprocessor_pref": "deepmind", "observation_filter": "NoFilter", "update_worker_filter_stats": true, "use_worker_filter_stats": true, "sampler_perf_stats_ema_coef": null, "_is_online": true, "num_learners": 0, "num_gpus_per_learner": 0, "num_cpus_per_learner": "auto", "num_aggregator_actors_per_learner": 0, "max_requests_in_flight_per_aggregator_actor": 3, "local_gpu_idx": 0, "max_requests_in_flight_per_learner": 3, "gamma": 1, "lr": 0.0002847858517, "grad_clip": 0.5, "grad_clip_by": "global_norm", "_train_batch_size_per_learner": 5000, "train_batch_size": 4000, "num_epochs": 1, "minibatch_size": 1000, "shuffle_batch_per_epoch": true, "model": {"fcnet_hiddens": [256, 256], "fcnet_activation": "tanh", "fcnet_weights_initializer": null, "fcnet_weights_initializer_config": null, "fcnet_bias_initializer": null, "fcnet_bias_initializer_config": null, "conv_filters": null, "conv_activation": "relu", "conv_kernel_initializer": null, "conv_kernel_initializer_config": null, "conv_bias_initializer": null, "conv_bias_initializer_config": null, "conv_transpose_kernel_initializer": null, "conv_transpose_kernel_initializer_config": null, "conv_transpose_bias_initializer": null, "conv_transpose_bias_initializer_config": null, "post_fcnet_hiddens": [], "post_fcnet_activation": "relu", "post_fcnet_weights_initializer": null, "post_fcnet_weights_initializer_config": null, "post_fcnet_bias_initializer": null, "post_fcnet_bias_initializer_config": null, "free_log_std": false, "log_std_clip_param": 20.0, "no_final_linear": false, "vf_share_layers": false, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "lstm_weights_initializer": null, "lstm_weights_initializer_config": null, "lstm_bias_initializer": null, "lstm_bias_initializer_config": null, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "attention_use_n_prev_actions": 0, "attention_use_n_prev_rewards": 0, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": null, "custom_model_config": {}, "custom_action_dist": null, "custom_preprocessor": null, "encoder_latent_dim": null, "always_check_shapes": false, "lstm_use_prev_action_reward": -1, "_use_default_native_models": -1, "_disable_preprocessor_api": false, "_disable_action_flattening": false}, "_learner_connector": null, "add_default_connectors_to_learner_pipeline": true, "learner_config_dict": {}, "optimizer": {}, "_learner_class": null, "callbacks_on_algorithm_init": null, "callbacks_on_env_runners_recreated": null, "callbacks_on_offline_eval_runners_recreated": null, "callbacks_on_checkpoint_loaded": null, "callbacks_on_environment_created": null, "callbacks_on_episode_created": null, "callbacks_on_episode_start": null, "callbacks_on_episode_step": null, "callbacks_on_episode_end": null, "callbacks_on_evaluate_start": null, "callbacks_on_evaluate_end": null, "callbacks_on_evaluate_offline_start": null, "callbacks_on_evaluate_offline_end": null, "callbacks_on_sample_end": null, "callbacks_on_train_result": null, "explore": true, "enable_rl_module_and_learner": true, "enable_env_runner_and_connector_v2": true, "_prior_exploration_config": {"type": "StochasticSampling"}, "count_steps_by": "env_steps", "policy_map_capacity": 100, "policy_mapping_fn": "<function AlgorithmConfig.DEFAULT_POLICY_MAPPING_FN at 0x3862edb20>", "policies_to_train": null, "policy_states_are_swappable": false, "observation_fn": null, "offline_data_class": null, "input_read_method": "read_parquet", "input_read_method_kwargs": {}, "input_read_schema": {}, "input_read_episodes": false, "input_read_sample_batches": false, "input_read_batch_size": null, "input_filesystem": null, "input_filesystem_kwargs": {}, "input_compress_columns": ["obs", "new_obs"], "input_spaces_jsonable": true, "materialize_data": false, "materialize_mapped_data": true, "map_batches_kwargs": {}, "iter_batches_kwargs": {}, "ignore_final_observation": false, "prelearner_class": null, "prelearner_buffer_class": null, "prelearner_buffer_kwargs": {}, "prelearner_module_synch_period": 10, "dataset_num_iters_per_learner": null, "input_config": {}, "actions_in_input_normalized": false, "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_config": {}, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "output_max_rows_per_file": null, "output_write_remaining_data": false, "output_write_method": "write_parquet", "output_write_method_kwargs": {}, "output_filesystem": null, "output_filesystem_kwargs": {}, "output_write_episodes": true, "offline_sampling": false, "evaluation_interval": 1, "evaluation_duration": 20, "evaluation_duration_unit": "episodes", "evaluation_sample_timeout_s": 120.0, "evaluation_auto_duration_min_env_steps_per_sample": 100, "evaluation_auto_duration_max_env_steps_per_sample": 2000, "evaluation_parallel_to_training": false, "evaluation_force_reset_envs_before_iteration": true, "evaluation_config": null, "off_policy_estimation_methods": {}, "ope_split_batch_by_episode": true, "evaluation_num_env_runners": 1, "in_evaluation": false, "sync_filters_on_rollout_workers_timeout_s": 10.0, "offline_evaluation_interval": null, "num_offline_eval_runners": 0, "offline_loss_for_module_fn": null, "offline_evaluation_duration": 1, "offline_evaluation_parallel_to_training": false, "offline_evaluation_timeout_s": 120.0, "num_cpus_per_offline_eval_runner": 1, "num_gpus_per_offline_eval_runner": 0, "custom_resources_per_offline_eval_runner": {}, "restart_failed_offline_eval_runners": true, "ignore_offline_eval_runner_failures": false, "max_num_offline_eval_runner_restarts": 1000, "offline_eval_runner_restore_timeout_s": 1800.0, "max_requests_in_flight_per_offline_eval_runner": 1, "validate_offline_eval_runners_after_construction": true, "offline_eval_runner_health_probe_timeout_s": 30.0, "offline_eval_rl_module_inference_only": false, "broadcast_offline_eval_runner_states": false, "offline_eval_batch_size_per_runner": 256, "dataset_num_iters_per_eval_runner": 1, "keep_per_episode_custom_metrics": false, "metrics_episode_collection_timeout_s": 60.0, "metrics_num_episodes_for_smoothing": 100, "min_time_s_per_iteration": null, "min_train_timesteps_per_iteration": 0, "min_sample_timesteps_per_iteration": 0, "log_gradients": true, "export_native_model_files": false, "checkpoint_trainable_policies_only": false, "logger_creator": null, "logger_config": null, "log_level": "WARN", "log_sys_usage": true, "fake_sampler": false, "seed": 9, "restart_failed_env_runners": true, "ignore_env_runner_failures": false, "max_num_env_runner_restarts": 1000, "delay_between_env_runner_restarts_s": 60.0, "restart_failed_sub_environments": false, "num_consecutive_env_runner_failures_tolerance": 100, "env_runner_health_probe_timeout_s": 30.0, "env_runner_restore_timeout_s": 1800.0, "_model_config": {}, "_rl_module_spec": "RLModuleSpec(module_class=None, observation_space=None, action_space=None, inference_only=False, learner_only=False, model_config=DefaultModelConfig(fcnet_hiddens=[60, 90], fcnet_activation='tanh', fcnet_kernel_initializer=None, fcnet_kernel_initializer_kwargs=None, fcnet_bias_initializer=None, fcnet_bias_initializer_kwargs=None, conv_filters=None, conv_activation='relu', conv_kernel_initializer=None, conv_kernel_initializer_kwargs=None, conv_bias_initializer=None, conv_bias_initializer_kwargs=None, head_fcnet_hiddens=[], head_fcnet_activation='relu', head_fcnet_kernel_initializer=None, head_fcnet_kernel_initializer_kwargs=None, head_fcnet_bias_initializer=None, head_fcnet_bias_initializer_kwargs=None, free_log_std=False, log_std_clip_param=20.0, vf_share_layers=True, use_lstm=False, max_seq_len=20, lstm_cell_size=256, lstm_use_prev_action=False, lstm_use_prev_reward=False, lstm_kernel_initializer=None, lstm_kernel_initializer_kwargs=None, lstm_bias_initializer=None, lstm_bias_initializer_kwargs=None), catalog_class=None, load_state_path=None, model_config_dict=None)", "algorithm_config_overrides_per_module": {}, "_per_module_overrides": {}, "_validate_config": true, "_use_msgpack_checkpoints": false, "_torch_grad_scaler_class": null, "_torch_lr_scheduler_classes": null, "_tf_policy_handles_more_than_one_loss": false, "_disable_preprocessor_api": false, "_disable_action_flattening": false, "_disable_initialize_loss_from_dummy_batch": false, "_dont_auto_sync_env_runner_states": false, "env_task_fn": -1, "enable_connectors": -1, "simple_optimizer": false, "policy_map_cache": -1, "worker_cls": -1, "synchronize_filters": -1, "enable_async_evaluation": -1, "custom_async_evaluation_function": -1, "_enable_rl_module_api": -1, "auto_wrap_old_gym_envs": -1, "always_attach_evaluation_results": -1, "replay_sequence_length": null, "_disable_execution_plan_api": -1, "use_critic": true, "use_gae": true, "use_kl_loss": true, "kl_coeff": 0.7464963036515, "kl_target": 0.0270990929592, "vf_loss_coeff": 0.6688075857018, "entropy_coeff": 0.0090570820258, "clip_param": 0.1221781641624, "vf_clip_param": 0.1027808522125, "entropy_coeff_schedule": null, "lr_schedule": null, "sgd_minibatch_size": -1, "vf_share_layers": -1, "__stdout_file__": null, "__stderr_file__": null, "lambda": 0.9099046732075, "input": "sampler", "policies": {"default_policy": [null, null, null, null]}, "callbacks": "<class 'ray.rllib.callbacks.callbacks.RLlibCallback'>", "create_env_on_driver": false, "custom_eval_function": null, "framework": "torch"}, "time_since_restore": 126.41283917427063, "iterations_since_restore": 18, "perf": {"cpu_util_percent": 94.13333333333334, "ram_util_percent": 82.69999999999999}}
{"timers": {"training_iteration": 17.075269432158173, "restore_env_runners": 3.211181687360291e-05, "training_step": 17.074465352846172, "env_runner_sampling_timer": 16.012959523937155, "learner_update_timer": 1.0018671661962153, "synch_weights": 0.03863057724201908, "restore_eval_env_runners": 0.00024271602692552317, "evaluation_iteration": 1.8045920382185743, "synch_eval_env_connectors": 0.0013988670256863153, "synch_env_connectors": 2.465173417869545e-05}, "env_runners": {"module_to_env_connector": {"timers": {"connectors": {"un_batch_to_individual_items": 1.497303952842538e-05, "tensor_to_numpy": 4.30110346140873e-05, "normalize_and_clip_actions": 2.7957940130385907e-05, "remove_single_ts_time_rank_from_batch": 1.725877260098013e-06, "listify_data_for_vector_env": 3.3120646795759876e-05, "get_actions": 0.0001513018136394527}}, "connector_pipeline_timer": 0.00034178067510292937}, "time_between_sampling": 0.00495069485093063, "episode_len_max": 20, "num_env_steps_sampled_lifetime": -10487500.0, "env_to_module_sum_episodes_length_in": 10.36823839457432, "sample": 0.016458152628194084, "num_agent_steps_sampled_lifetime": {"default_agent": -10487500.0}, "episode_len_mean": 20.0, "rlmodule_inference_timer": 0.0001058884810314008, "num_episodes_lifetime": -524375.0, "num_module_steps_sampled": {"default_policy": 5000.0}, "env_to_module_connector": {"connector_pipeline_timer": 0.00012532968259480778, "timers": {"connectors": {"add_states_from_episodes_to_batch": 4.211009523233437e-06, "batch_individual_items": 2.1274763462064957e-05, "add_observations_from_episodes_to_batch": 8.796795033429158e-06, "add_time_dim_to_batch_and_zero_pad": 6.9915921144595045e-06, "numpy_to_tensor": 3.186502897117633e-05}}}, "module_episode_returns_mean": {"default_policy": 11.940000000000003}, "num_agent_steps_sampled": {"default_agent": 5000.0}, "num_episodes": 250.0, "episode_len_min": 20, "env_to_module_sum_episodes_length_out": 10.36823839457432, "num_module_steps_sampled_lifetime": {"default_policy": -10487500.0}, "env_reset_timer": 0.00013817385739500033, "episode_duration_sec_mean": 0.014863001501187688, "episode_return_max": 14.5, "weights_seq_no": 18.0, "env_step_timer": 4.9118485440814946e-05, "episode_return_min": -5.5, "agent_episode_returns_mean": {"default_agent": 11.940000000000003}, "num_env_steps_sampled": 5000.0, "episode_return_mean": 11.940000000000003, "num_env_steps_sampled_lifetime_throughput": 1486.9291799782584}, "learners": {"__all_modules__": {"num_non_trainable_parameters": 0, "learner_connector": {"timers": {"connectors": {"add_time_dim_to_batch_and_zero_pad": 0.0001852834460857445, "numpy_to_tensor": 0.00013724252492137783, "general_advantage_estimation": 0.053053827987477556, "add_states_from_episodes_to_batch": 6.59065417322079e-06, "add_one_ts_to_episodes_and_truncate": 0.10228385994510747, "batch_individual_items": 0.3237917609961588, "add_observations_from_episodes_to_batch": 0.004090766747756779, "add_columns_from_episodes_to_train_batch": 0.3010093575799832}}, "connector_pipeline_timer": 0.7851546884373493}, "learner_connector_sum_episodes_length_in": 5000.0, "num_module_steps_trained": 6000, "num_module_steps_trained_lifetime": 114000, "num_env_steps_trained": 31500, "learner_connector_sum_episodes_length_out": 5250.0, "num_trainable_parameters": 6003, "num_env_steps_trained_lifetime": 598500, "num_env_steps_trained_lifetime_throughput": 595931.4209193746, "num_module_steps_trained_throughput": 113830.37795493414, "num_module_steps_trained_lifetime_throughput": 113650.69857672056}, "default_policy": {"module_train_batch_size_mean": 1000.0, "mean_kl_loss": 4.5508480980060995e-05, "curr_entropy_coeff": 0.0090570820258, "weights_seq_no": 19.0, "num_module_steps_trained": 6000, "curr_kl_coeff": 1.423828734914423e-06, "diff_num_grad_updates_vs_sampler_policy": 1.0, "num_module_steps_trained_lifetime": 114000, "vf_loss": 0.10185413807630539, "gradients_default_optimizer_global_norm": 0.04448277875781059, "total_loss": -0.05254727974534035, "policy_loss": -0.11524400860071182, "num_trainable_parameters": 6003, "default_optimizer_learning_rate": 0.0002847858517, "vf_explained_var": 0.0010715723037719727, "entropy": 0.5988801717758179, "vf_loss_unclipped": 38.91197967529297, "num_module_steps_trained_lifetime_throughput": 113866.12457169784}}, "num_training_step_calls_per_iteration": 1, "evaluation": {"env_runners": {"module_to_env_connector": {"connector_pipeline_timer": 0.00017724181564737334, "timers": {"connectors": {"remove_single_ts_time_rank_from_batch": 8.449262878666822e-07, "normalize_and_clip_actions": 1.3994866201303725e-05, "tensor_to_numpy": 2.6871718071869832e-05, "listify_data_for_vector_env": 1.585196169618512e-05, "un_batch_to_individual_items": 8.062489036579712e-06, "get_actions": 7.00059394728774e-05}}}, "env_to_module_connector": {"timers": {"connectors": {"numpy_to_tensor": 1.290091550137135e-05, "add_states_from_episodes_to_batch": 2.059910262297229e-06, "batch_individual_items": 1.1967449007170914e-05, "add_observations_from_episodes_to_batch": 4.048870866943035e-06, "add_time_dim_to_batch_and_zero_pad": 3.790536961514826e-06}}, "connector_pipeline_timer": 6.518434732307963e-05}, "num_episodes": 20, "num_env_steps_sampled": 400, "num_env_steps_sampled_lifetime": 95400, "episode_len_mean": 20.0, "num_module_steps_sampled": {"default_policy": 400}, "episode_return_max": 15.5, "weights_seq_no": 19.0, "episode_len_max": 20, "num_agent_steps_sampled_lifetime": {"default_agent": 7600}, "sample": 1.6438593549748448, "module_episode_returns_mean": {"default_policy": 3.1}, "num_agent_steps_sampled": {"default_agent": 400}, "agent_episode_returns_mean": {"default_agent": 3.1}, "rlmodule_inference_timer": 5.375162377160723e-05, "num_episodes_lifetime": 380, "num_module_steps_sampled_lifetime": {"default_policy": 7600}, "episode_len_min": 20, "env_to_module_sum_episodes_length_out": 10.368238394574323, "env_reset_timer": 0.0158985646294954, "episode_duration_sec_mean": 0.015331930443644524, "env_step_timer": 2.370605902645945e-05, "episode_return_min": -13.5, "episode_return_mean": 3.1, "env_to_module_sum_episodes_length_in": 10.368238394574323, "time_between_sampling": 13.376427552116798}, "num_healthy_workers": 1, "actor_manager_num_outstanding_async_reqs": 0, "num_remote_worker_restarts": 0}, "num_env_steps_sampled_lifetime": -10487500.0, "fault_tolerance": {"num_healthy_workers": 0, "num_remote_worker_restarts": 0}, "env_runner_group": {"actor_manager_num_outstanding_async_reqs": 0}, "done": false, "training_iteration": 19, "trial_id": "497a0_00000", "date": "2025-08-11_19-30-05", "timestamp": 1754933405, "time_this_iter_s": 5.012231826782227, "time_total_s": 131.42507100105286, "pid": 19607, "hostname": "Mac", "node_ip": "127.0.0.1", "config": {"exploration_config": {}, "extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "placement_strategy": "PACK", "num_gpus": 0, "_fake_gpus": false, "num_cpus_for_main_process": 2, "eager_tracing": true, "eager_max_retraces": 20, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "torch_compile_learner": false, "torch_compile_learner_what_to_compile": "forward_train", "torch_compile_learner_dynamo_backend": "aot_eager", "torch_compile_learner_dynamo_mode": null, "torch_compile_worker": false, "torch_compile_worker_dynamo_backend": "aot_eager", "torch_compile_worker_dynamo_mode": null, "torch_ddp_kwargs": {}, "torch_skip_nan_gradients": false, "env": "Umbrella", "env_config": {}, "observation_space": null, "action_space": null, "clip_rewards": null, "normalize_actions": true, "clip_actions": false, "_is_atari": null, "disable_env_checking": false, "render_env": false, "action_mask_key": "action_mask", "env_runner_cls": null, "num_env_runners": 0, "create_local_env_runner": true, "num_envs_per_env_runner": 1, "gym_env_vectorize_mode": "SYNC", "num_cpus_per_env_runner": 1, "num_gpus_per_env_runner": 0, "custom_resources_per_env_runner": {}, "validate_env_runners_after_construction": true, "episodes_to_numpy": true, "max_requests_in_flight_per_env_runner": 1, "sample_timeout_s": 60.0, "_env_to_module_connector": null, "add_default_connectors_to_env_to_module_pipeline": true, "_module_to_env_connector": null, "add_default_connectors_to_module_to_env_pipeline": true, "merge_env_runner_states": "training_only", "broadcast_env_runner_states": true, "episode_lookback_horizon": 1, "rollout_fragment_length": "auto", "batch_mode": "complete_episodes", "compress_observations": false, "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "enable_tf1_exec_eagerly": false, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "preprocessor_pref": "deepmind", "observation_filter": "NoFilter", "update_worker_filter_stats": true, "use_worker_filter_stats": true, "sampler_perf_stats_ema_coef": null, "_is_online": true, "num_learners": 0, "num_gpus_per_learner": 0, "num_cpus_per_learner": "auto", "num_aggregator_actors_per_learner": 0, "max_requests_in_flight_per_aggregator_actor": 3, "local_gpu_idx": 0, "max_requests_in_flight_per_learner": 3, "gamma": 1, "lr": 0.0002847858517, "grad_clip": 0.5, "grad_clip_by": "global_norm", "_train_batch_size_per_learner": 5000, "train_batch_size": 4000, "num_epochs": 1, "minibatch_size": 1000, "shuffle_batch_per_epoch": true, "model": {"fcnet_hiddens": [256, 256], "fcnet_activation": "tanh", "fcnet_weights_initializer": null, "fcnet_weights_initializer_config": null, "fcnet_bias_initializer": null, "fcnet_bias_initializer_config": null, "conv_filters": null, "conv_activation": "relu", "conv_kernel_initializer": null, "conv_kernel_initializer_config": null, "conv_bias_initializer": null, "conv_bias_initializer_config": null, "conv_transpose_kernel_initializer": null, "conv_transpose_kernel_initializer_config": null, "conv_transpose_bias_initializer": null, "conv_transpose_bias_initializer_config": null, "post_fcnet_hiddens": [], "post_fcnet_activation": "relu", "post_fcnet_weights_initializer": null, "post_fcnet_weights_initializer_config": null, "post_fcnet_bias_initializer": null, "post_fcnet_bias_initializer_config": null, "free_log_std": false, "log_std_clip_param": 20.0, "no_final_linear": false, "vf_share_layers": false, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "lstm_weights_initializer": null, "lstm_weights_initializer_config": null, "lstm_bias_initializer": null, "lstm_bias_initializer_config": null, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "attention_use_n_prev_actions": 0, "attention_use_n_prev_rewards": 0, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": null, "custom_model_config": {}, "custom_action_dist": null, "custom_preprocessor": null, "encoder_latent_dim": null, "always_check_shapes": false, "lstm_use_prev_action_reward": -1, "_use_default_native_models": -1, "_disable_preprocessor_api": false, "_disable_action_flattening": false}, "_learner_connector": null, "add_default_connectors_to_learner_pipeline": true, "learner_config_dict": {}, "optimizer": {}, "_learner_class": null, "callbacks_on_algorithm_init": null, "callbacks_on_env_runners_recreated": null, "callbacks_on_offline_eval_runners_recreated": null, "callbacks_on_checkpoint_loaded": null, "callbacks_on_environment_created": null, "callbacks_on_episode_created": null, "callbacks_on_episode_start": null, "callbacks_on_episode_step": null, "callbacks_on_episode_end": null, "callbacks_on_evaluate_start": null, "callbacks_on_evaluate_end": null, "callbacks_on_evaluate_offline_start": null, "callbacks_on_evaluate_offline_end": null, "callbacks_on_sample_end": null, "callbacks_on_train_result": null, "explore": true, "enable_rl_module_and_learner": true, "enable_env_runner_and_connector_v2": true, "_prior_exploration_config": {"type": "StochasticSampling"}, "count_steps_by": "env_steps", "policy_map_capacity": 100, "policy_mapping_fn": "<function AlgorithmConfig.DEFAULT_POLICY_MAPPING_FN at 0x3862edb20>", "policies_to_train": null, "policy_states_are_swappable": false, "observation_fn": null, "offline_data_class": null, "input_read_method": "read_parquet", "input_read_method_kwargs": {}, "input_read_schema": {}, "input_read_episodes": false, "input_read_sample_batches": false, "input_read_batch_size": null, "input_filesystem": null, "input_filesystem_kwargs": {}, "input_compress_columns": ["obs", "new_obs"], "input_spaces_jsonable": true, "materialize_data": false, "materialize_mapped_data": true, "map_batches_kwargs": {}, "iter_batches_kwargs": {}, "ignore_final_observation": false, "prelearner_class": null, "prelearner_buffer_class": null, "prelearner_buffer_kwargs": {}, "prelearner_module_synch_period": 10, "dataset_num_iters_per_learner": null, "input_config": {}, "actions_in_input_normalized": false, "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_config": {}, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "output_max_rows_per_file": null, "output_write_remaining_data": false, "output_write_method": "write_parquet", "output_write_method_kwargs": {}, "output_filesystem": null, "output_filesystem_kwargs": {}, "output_write_episodes": true, "offline_sampling": false, "evaluation_interval": 1, "evaluation_duration": 20, "evaluation_duration_unit": "episodes", "evaluation_sample_timeout_s": 120.0, "evaluation_auto_duration_min_env_steps_per_sample": 100, "evaluation_auto_duration_max_env_steps_per_sample": 2000, "evaluation_parallel_to_training": false, "evaluation_force_reset_envs_before_iteration": true, "evaluation_config": null, "off_policy_estimation_methods": {}, "ope_split_batch_by_episode": true, "evaluation_num_env_runners": 1, "in_evaluation": false, "sync_filters_on_rollout_workers_timeout_s": 10.0, "offline_evaluation_interval": null, "num_offline_eval_runners": 0, "offline_loss_for_module_fn": null, "offline_evaluation_duration": 1, "offline_evaluation_parallel_to_training": false, "offline_evaluation_timeout_s": 120.0, "num_cpus_per_offline_eval_runner": 1, "num_gpus_per_offline_eval_runner": 0, "custom_resources_per_offline_eval_runner": {}, "restart_failed_offline_eval_runners": true, "ignore_offline_eval_runner_failures": false, "max_num_offline_eval_runner_restarts": 1000, "offline_eval_runner_restore_timeout_s": 1800.0, "max_requests_in_flight_per_offline_eval_runner": 1, "validate_offline_eval_runners_after_construction": true, "offline_eval_runner_health_probe_timeout_s": 30.0, "offline_eval_rl_module_inference_only": false, "broadcast_offline_eval_runner_states": false, "offline_eval_batch_size_per_runner": 256, "dataset_num_iters_per_eval_runner": 1, "keep_per_episode_custom_metrics": false, "metrics_episode_collection_timeout_s": 60.0, "metrics_num_episodes_for_smoothing": 100, "min_time_s_per_iteration": null, "min_train_timesteps_per_iteration": 0, "min_sample_timesteps_per_iteration": 0, "log_gradients": true, "export_native_model_files": false, "checkpoint_trainable_policies_only": false, "logger_creator": null, "logger_config": null, "log_level": "WARN", "log_sys_usage": true, "fake_sampler": false, "seed": 9, "restart_failed_env_runners": true, "ignore_env_runner_failures": false, "max_num_env_runner_restarts": 1000, "delay_between_env_runner_restarts_s": 60.0, "restart_failed_sub_environments": false, "num_consecutive_env_runner_failures_tolerance": 100, "env_runner_health_probe_timeout_s": 30.0, "env_runner_restore_timeout_s": 1800.0, "_model_config": {}, "_rl_module_spec": "RLModuleSpec(module_class=None, observation_space=None, action_space=None, inference_only=False, learner_only=False, model_config=DefaultModelConfig(fcnet_hiddens=[60, 90], fcnet_activation='tanh', fcnet_kernel_initializer=None, fcnet_kernel_initializer_kwargs=None, fcnet_bias_initializer=None, fcnet_bias_initializer_kwargs=None, conv_filters=None, conv_activation='relu', conv_kernel_initializer=None, conv_kernel_initializer_kwargs=None, conv_bias_initializer=None, conv_bias_initializer_kwargs=None, head_fcnet_hiddens=[], head_fcnet_activation='relu', head_fcnet_kernel_initializer=None, head_fcnet_kernel_initializer_kwargs=None, head_fcnet_bias_initializer=None, head_fcnet_bias_initializer_kwargs=None, free_log_std=False, log_std_clip_param=20.0, vf_share_layers=True, use_lstm=False, max_seq_len=20, lstm_cell_size=256, lstm_use_prev_action=False, lstm_use_prev_reward=False, lstm_kernel_initializer=None, lstm_kernel_initializer_kwargs=None, lstm_bias_initializer=None, lstm_bias_initializer_kwargs=None), catalog_class=None, load_state_path=None, model_config_dict=None)", "algorithm_config_overrides_per_module": {}, "_per_module_overrides": {}, "_validate_config": true, "_use_msgpack_checkpoints": false, "_torch_grad_scaler_class": null, "_torch_lr_scheduler_classes": null, "_tf_policy_handles_more_than_one_loss": false, "_disable_preprocessor_api": false, "_disable_action_flattening": false, "_disable_initialize_loss_from_dummy_batch": false, "_dont_auto_sync_env_runner_states": false, "env_task_fn": -1, "enable_connectors": -1, "simple_optimizer": false, "policy_map_cache": -1, "worker_cls": -1, "synchronize_filters": -1, "enable_async_evaluation": -1, "custom_async_evaluation_function": -1, "_enable_rl_module_api": -1, "auto_wrap_old_gym_envs": -1, "always_attach_evaluation_results": -1, "replay_sequence_length": null, "_disable_execution_plan_api": -1, "use_critic": true, "use_gae": true, "use_kl_loss": true, "kl_coeff": 0.7464963036515, "kl_target": 0.0270990929592, "vf_loss_coeff": 0.6688075857018, "entropy_coeff": 0.0090570820258, "clip_param": 0.1221781641624, "vf_clip_param": 0.1027808522125, "entropy_coeff_schedule": null, "lr_schedule": null, "sgd_minibatch_size": -1, "vf_share_layers": -1, "__stdout_file__": null, "__stderr_file__": null, "lambda": 0.9099046732075, "input": "sampler", "policies": {"default_policy": [null, null, null, null]}, "callbacks": "<class 'ray.rllib.callbacks.callbacks.RLlibCallback'>", "create_env_on_driver": false, "custom_eval_function": null, "framework": "torch"}, "time_since_restore": 131.42507100105286, "iterations_since_restore": 19, "perf": {"cpu_util_percent": 77.67142857142858, "ram_util_percent": 81.58571428571427}}
{"timers": {"training_iteration": 16.949349313256743, "restore_env_runners": 3.185735811814498e-05, "training_step": 16.94854647223787, "env_runner_sampling_timer": 15.895342465778112, "learner_update_timer": 0.9940799432844977, "synch_weights": 0.03825467729970651, "restore_eval_env_runners": 0.00024043136715925663, "evaluation_iteration": 1.7886928978359913, "synch_eval_env_connectors": 0.0013865054446523452, "synch_env_connectors": 2.445896695514921e-05}, "env_runners": {"module_to_env_connector": {"timers": {"connectors": {"un_batch_to_individual_items": 1.4860659017500401e-05, "tensor_to_numpy": 4.314096985764239e-05, "normalize_and_clip_actions": 2.6735610534723147e-05, "remove_single_ts_time_rank_from_batch": 1.6854274039514183e-06, "listify_data_for_vector_env": 2.885997028454397e-05, "get_actions": 0.00014649425257111249}}, "connector_pipeline_timer": 0.0003284722093744989}, "time_between_sampling": 0.004532709625950949, "episode_len_max": 20, "num_env_steps_sampled_lifetime": -11105000.0, "env_to_module_sum_episodes_length_in": 10.36823839457432, "sample": 0.015940012395220013, "num_agent_steps_sampled_lifetime": {"default_agent": -11105000.0}, "episode_len_mean": 20.0, "rlmodule_inference_timer": 9.932956492183426e-05, "num_episodes_lifetime": -555250.0, "num_module_steps_sampled": {"default_policy": 5000.0}, "env_to_module_connector": {"connector_pipeline_timer": 0.0001217812830923621, "timers": {"connectors": {"add_states_from_episodes_to_batch": 4.687603278426374e-06, "batch_individual_items": 1.9732339247687447e-05, "add_observations_from_episodes_to_batch": 8.228297863668851e-06, "add_time_dim_to_batch_and_zero_pad": 6.749508459040391e-06, "numpy_to_tensor": 3.334116825290723e-05}}}, "module_episode_returns_mean": {"default_policy": 12.5}, "num_agent_steps_sampled": {"default_agent": 5000.0}, "num_episodes": 250.0, "episode_len_min": 20, "env_to_module_sum_episodes_length_out": 10.36823839457432, "num_module_steps_sampled_lifetime": {"default_policy": -11105000.0}, "env_reset_timer": 0.00012063942241689272, "episode_duration_sec_mean": 0.014242088666651397, "episode_return_max": 14.5, "weights_seq_no": 19.0, "env_step_timer": 4.658462779171331e-05, "episode_return_min": -5.5, "agent_episode_returns_mean": {"default_agent": 12.5}, "num_env_steps_sampled": 5000.0, "episode_return_mean": 12.5, "num_env_steps_sampled_lifetime_throughput": 1543.2435894666864}, "learners": {"__all_modules__": {"num_non_trainable_parameters": 0, "learner_connector": {"timers": {"connectors": {"add_time_dim_to_batch_and_zero_pad": 0.00018358728220084852, "numpy_to_tensor": 0.00013653301973738823, "general_advantage_estimation": 0.052608903458455425, "add_states_from_episodes_to_batch": 6.559327638684055e-06, "add_one_ts_to_episodes_and_truncate": 0.10138793467640694, "batch_individual_items": 0.3209751646362298, "add_observations_from_episodes_to_batch": 0.0040802361602447585, "add_columns_from_episodes_to_train_batch": 0.29885000275448836}}, "connector_pipeline_timer": 0.7788209048828784}, "learner_connector_sum_episodes_length_in": 5000.0, "num_module_steps_trained": 6000, "num_module_steps_trained_lifetime": 120000, "num_env_steps_trained": 31500, "learner_connector_sum_episodes_length_out": 5250.0, "num_trainable_parameters": 6003, "num_env_steps_trained_lifetime": 630000, "num_env_steps_trained_lifetime_throughput": 596373.649991511, "num_module_steps_trained_throughput": 113891.85700895995, "num_module_steps_trained_lifetime_throughput": 113719.46731950808}, "default_policy": {"module_train_batch_size_mean": 1000.0, "mean_kl_loss": 8.406594133703038e-05, "curr_entropy_coeff": 0.0090570820258, "weights_seq_no": 20.0, "num_module_steps_trained": 6000, "curr_kl_coeff": 7.119143674572115e-07, "diff_num_grad_updates_vs_sampler_policy": 1.0, "num_module_steps_trained_lifetime": 120000, "vf_loss": 0.10185357928276062, "gradients_default_optimizer_global_norm": 0.03812684118747711, "total_loss": 0.01072325836867094, "policy_loss": -0.05196285992860794, "num_trainable_parameters": 6003, "default_optimizer_learning_rate": 0.0002847858517, "vf_explained_var": 0.0011566877365112305, "entropy": 0.6000101566314697, "vf_loss_unclipped": 38.9202995300293, "num_module_steps_trained_lifetime_throughput": 113923.01620836821}}, "num_training_step_calls_per_iteration": 1, "evaluation": {"env_runners": {"module_to_env_connector": {"connector_pipeline_timer": 0.00022141363183940044, "timers": {"connectors": {"remove_single_ts_time_rank_from_batch": 1.0360918431004791e-06, "normalize_and_clip_actions": 1.7495237165765584e-05, "tensor_to_numpy": 2.425201159570928e-05, "listify_data_for_vector_env": 2.5738436442126105e-05, "un_batch_to_individual_items": 9.793973489598392e-06, "get_actions": 8.970403874340544e-05}}}, "env_to_module_connector": {"timers": {"connectors": {"numpy_to_tensor": 1.8618323129018395e-05, "add_states_from_episodes_to_batch": 2.6584403144337983e-06, "batch_individual_items": 1.2355825737588484e-05, "add_observations_from_episodes_to_batch": 6.127623954223857e-06, "add_time_dim_to_batch_and_zero_pad": 4.379357297436145e-06}}, "connector_pipeline_timer": 8.327325840935044e-05}, "num_episodes": 20, "num_env_steps_sampled": 400, "num_env_steps_sampled_lifetime": 100400, "episode_len_mean": 20.0, "num_module_steps_sampled": {"default_policy": 400}, "episode_return_max": 15.5, "weights_seq_no": 20.0, "episode_len_max": 20, "num_agent_steps_sampled_lifetime": {"default_agent": 8000}, "sample": 1.6296341418445128, "module_episode_returns_mean": {"default_policy": 1.7}, "num_agent_steps_sampled": {"default_agent": 400}, "agent_episode_returns_mean": {"default_agent": 1.7}, "rlmodule_inference_timer": 5.544429183778728e-05, "num_episodes_lifetime": 400, "num_module_steps_sampled_lifetime": {"default_policy": 8000}, "episode_len_min": 20, "env_to_module_sum_episodes_length_out": 10.368238394574323, "env_reset_timer": 0.015740347313847124, "episode_duration_sec_mean": 0.015457067968090996, "env_step_timer": 2.9199303405375388e-05, "episode_return_min": -13.5, "episode_return_mean": 1.7, "env_to_module_sum_episodes_length_in": 10.368238394574323, "time_between_sampling": 13.288427964095826}, "num_healthy_workers": 1, "actor_manager_num_outstanding_async_reqs": 0, "num_remote_worker_restarts": 0}, "num_env_steps_sampled_lifetime": -11105000.0, "fault_tolerance": {"num_healthy_workers": 0, "num_remote_worker_restarts": 0}, "env_runner_group": {"actor_manager_num_outstanding_async_reqs": 0}, "done": true, "training_iteration": 20, "trial_id": "497a0_00000", "date": "2025-08-11_19-30-10", "timestamp": 1754933410, "time_this_iter_s": 4.718301057815552, "time_total_s": 136.1433720588684, "pid": 19607, "hostname": "Mac", "node_ip": "127.0.0.1", "config": {"exploration_config": {}, "extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "placement_strategy": "PACK", "num_gpus": 0, "_fake_gpus": false, "num_cpus_for_main_process": 2, "eager_tracing": true, "eager_max_retraces": 20, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "torch_compile_learner": false, "torch_compile_learner_what_to_compile": "forward_train", "torch_compile_learner_dynamo_backend": "aot_eager", "torch_compile_learner_dynamo_mode": null, "torch_compile_worker": false, "torch_compile_worker_dynamo_backend": "aot_eager", "torch_compile_worker_dynamo_mode": null, "torch_ddp_kwargs": {}, "torch_skip_nan_gradients": false, "env": "Umbrella", "env_config": {}, "observation_space": null, "action_space": null, "clip_rewards": null, "normalize_actions": true, "clip_actions": false, "_is_atari": null, "disable_env_checking": false, "render_env": false, "action_mask_key": "action_mask", "env_runner_cls": null, "num_env_runners": 0, "create_local_env_runner": true, "num_envs_per_env_runner": 1, "gym_env_vectorize_mode": "SYNC", "num_cpus_per_env_runner": 1, "num_gpus_per_env_runner": 0, "custom_resources_per_env_runner": {}, "validate_env_runners_after_construction": true, "episodes_to_numpy": true, "max_requests_in_flight_per_env_runner": 1, "sample_timeout_s": 60.0, "_env_to_module_connector": null, "add_default_connectors_to_env_to_module_pipeline": true, "_module_to_env_connector": null, "add_default_connectors_to_module_to_env_pipeline": true, "merge_env_runner_states": "training_only", "broadcast_env_runner_states": true, "episode_lookback_horizon": 1, "rollout_fragment_length": "auto", "batch_mode": "complete_episodes", "compress_observations": false, "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "enable_tf1_exec_eagerly": false, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "preprocessor_pref": "deepmind", "observation_filter": "NoFilter", "update_worker_filter_stats": true, "use_worker_filter_stats": true, "sampler_perf_stats_ema_coef": null, "_is_online": true, "num_learners": 0, "num_gpus_per_learner": 0, "num_cpus_per_learner": "auto", "num_aggregator_actors_per_learner": 0, "max_requests_in_flight_per_aggregator_actor": 3, "local_gpu_idx": 0, "max_requests_in_flight_per_learner": 3, "gamma": 1, "lr": 0.0002847858517, "grad_clip": 0.5, "grad_clip_by": "global_norm", "_train_batch_size_per_learner": 5000, "train_batch_size": 4000, "num_epochs": 1, "minibatch_size": 1000, "shuffle_batch_per_epoch": true, "model": {"fcnet_hiddens": [256, 256], "fcnet_activation": "tanh", "fcnet_weights_initializer": null, "fcnet_weights_initializer_config": null, "fcnet_bias_initializer": null, "fcnet_bias_initializer_config": null, "conv_filters": null, "conv_activation": "relu", "conv_kernel_initializer": null, "conv_kernel_initializer_config": null, "conv_bias_initializer": null, "conv_bias_initializer_config": null, "conv_transpose_kernel_initializer": null, "conv_transpose_kernel_initializer_config": null, "conv_transpose_bias_initializer": null, "conv_transpose_bias_initializer_config": null, "post_fcnet_hiddens": [], "post_fcnet_activation": "relu", "post_fcnet_weights_initializer": null, "post_fcnet_weights_initializer_config": null, "post_fcnet_bias_initializer": null, "post_fcnet_bias_initializer_config": null, "free_log_std": false, "log_std_clip_param": 20.0, "no_final_linear": false, "vf_share_layers": false, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "lstm_weights_initializer": null, "lstm_weights_initializer_config": null, "lstm_bias_initializer": null, "lstm_bias_initializer_config": null, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "attention_use_n_prev_actions": 0, "attention_use_n_prev_rewards": 0, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": null, "custom_model_config": {}, "custom_action_dist": null, "custom_preprocessor": null, "encoder_latent_dim": null, "always_check_shapes": false, "lstm_use_prev_action_reward": -1, "_use_default_native_models": -1, "_disable_preprocessor_api": false, "_disable_action_flattening": false}, "_learner_connector": null, "add_default_connectors_to_learner_pipeline": true, "learner_config_dict": {}, "optimizer": {}, "_learner_class": null, "callbacks_on_algorithm_init": null, "callbacks_on_env_runners_recreated": null, "callbacks_on_offline_eval_runners_recreated": null, "callbacks_on_checkpoint_loaded": null, "callbacks_on_environment_created": null, "callbacks_on_episode_created": null, "callbacks_on_episode_start": null, "callbacks_on_episode_step": null, "callbacks_on_episode_end": null, "callbacks_on_evaluate_start": null, "callbacks_on_evaluate_end": null, "callbacks_on_evaluate_offline_start": null, "callbacks_on_evaluate_offline_end": null, "callbacks_on_sample_end": null, "callbacks_on_train_result": null, "explore": true, "enable_rl_module_and_learner": true, "enable_env_runner_and_connector_v2": true, "_prior_exploration_config": {"type": "StochasticSampling"}, "count_steps_by": "env_steps", "policy_map_capacity": 100, "policy_mapping_fn": "<function AlgorithmConfig.DEFAULT_POLICY_MAPPING_FN at 0x3862edb20>", "policies_to_train": null, "policy_states_are_swappable": false, "observation_fn": null, "offline_data_class": null, "input_read_method": "read_parquet", "input_read_method_kwargs": {}, "input_read_schema": {}, "input_read_episodes": false, "input_read_sample_batches": false, "input_read_batch_size": null, "input_filesystem": null, "input_filesystem_kwargs": {}, "input_compress_columns": ["obs", "new_obs"], "input_spaces_jsonable": true, "materialize_data": false, "materialize_mapped_data": true, "map_batches_kwargs": {}, "iter_batches_kwargs": {}, "ignore_final_observation": false, "prelearner_class": null, "prelearner_buffer_class": null, "prelearner_buffer_kwargs": {}, "prelearner_module_synch_period": 10, "dataset_num_iters_per_learner": null, "input_config": {}, "actions_in_input_normalized": false, "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_config": {}, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "output_max_rows_per_file": null, "output_write_remaining_data": false, "output_write_method": "write_parquet", "output_write_method_kwargs": {}, "output_filesystem": null, "output_filesystem_kwargs": {}, "output_write_episodes": true, "offline_sampling": false, "evaluation_interval": 1, "evaluation_duration": 20, "evaluation_duration_unit": "episodes", "evaluation_sample_timeout_s": 120.0, "evaluation_auto_duration_min_env_steps_per_sample": 100, "evaluation_auto_duration_max_env_steps_per_sample": 2000, "evaluation_parallel_to_training": false, "evaluation_force_reset_envs_before_iteration": true, "evaluation_config": null, "off_policy_estimation_methods": {}, "ope_split_batch_by_episode": true, "evaluation_num_env_runners": 1, "in_evaluation": false, "sync_filters_on_rollout_workers_timeout_s": 10.0, "offline_evaluation_interval": null, "num_offline_eval_runners": 0, "offline_loss_for_module_fn": null, "offline_evaluation_duration": 1, "offline_evaluation_parallel_to_training": false, "offline_evaluation_timeout_s": 120.0, "num_cpus_per_offline_eval_runner": 1, "num_gpus_per_offline_eval_runner": 0, "custom_resources_per_offline_eval_runner": {}, "restart_failed_offline_eval_runners": true, "ignore_offline_eval_runner_failures": false, "max_num_offline_eval_runner_restarts": 1000, "offline_eval_runner_restore_timeout_s": 1800.0, "max_requests_in_flight_per_offline_eval_runner": 1, "validate_offline_eval_runners_after_construction": true, "offline_eval_runner_health_probe_timeout_s": 30.0, "offline_eval_rl_module_inference_only": false, "broadcast_offline_eval_runner_states": false, "offline_eval_batch_size_per_runner": 256, "dataset_num_iters_per_eval_runner": 1, "keep_per_episode_custom_metrics": false, "metrics_episode_collection_timeout_s": 60.0, "metrics_num_episodes_for_smoothing": 100, "min_time_s_per_iteration": null, "min_train_timesteps_per_iteration": 0, "min_sample_timesteps_per_iteration": 0, "log_gradients": true, "export_native_model_files": false, "checkpoint_trainable_policies_only": false, "logger_creator": null, "logger_config": null, "log_level": "WARN", "log_sys_usage": true, "fake_sampler": false, "seed": 9, "restart_failed_env_runners": true, "ignore_env_runner_failures": false, "max_num_env_runner_restarts": 1000, "delay_between_env_runner_restarts_s": 60.0, "restart_failed_sub_environments": false, "num_consecutive_env_runner_failures_tolerance": 100, "env_runner_health_probe_timeout_s": 30.0, "env_runner_restore_timeout_s": 1800.0, "_model_config": {}, "_rl_module_spec": "RLModuleSpec(module_class=None, observation_space=None, action_space=None, inference_only=False, learner_only=False, model_config=DefaultModelConfig(fcnet_hiddens=[60, 90], fcnet_activation='tanh', fcnet_kernel_initializer=None, fcnet_kernel_initializer_kwargs=None, fcnet_bias_initializer=None, fcnet_bias_initializer_kwargs=None, conv_filters=None, conv_activation='relu', conv_kernel_initializer=None, conv_kernel_initializer_kwargs=None, conv_bias_initializer=None, conv_bias_initializer_kwargs=None, head_fcnet_hiddens=[], head_fcnet_activation='relu', head_fcnet_kernel_initializer=None, head_fcnet_kernel_initializer_kwargs=None, head_fcnet_bias_initializer=None, head_fcnet_bias_initializer_kwargs=None, free_log_std=False, log_std_clip_param=20.0, vf_share_layers=True, use_lstm=False, max_seq_len=20, lstm_cell_size=256, lstm_use_prev_action=False, lstm_use_prev_reward=False, lstm_kernel_initializer=None, lstm_kernel_initializer_kwargs=None, lstm_bias_initializer=None, lstm_bias_initializer_kwargs=None), catalog_class=None, load_state_path=None, model_config_dict=None)", "algorithm_config_overrides_per_module": {}, "_per_module_overrides": {}, "_validate_config": true, "_use_msgpack_checkpoints": false, "_torch_grad_scaler_class": null, "_torch_lr_scheduler_classes": null, "_tf_policy_handles_more_than_one_loss": false, "_disable_preprocessor_api": false, "_disable_action_flattening": false, "_disable_initialize_loss_from_dummy_batch": false, "_dont_auto_sync_env_runner_states": false, "env_task_fn": -1, "enable_connectors": -1, "simple_optimizer": false, "policy_map_cache": -1, "worker_cls": -1, "synchronize_filters": -1, "enable_async_evaluation": -1, "custom_async_evaluation_function": -1, "_enable_rl_module_api": -1, "auto_wrap_old_gym_envs": -1, "always_attach_evaluation_results": -1, "replay_sequence_length": null, "_disable_execution_plan_api": -1, "use_critic": true, "use_gae": true, "use_kl_loss": true, "kl_coeff": 0.7464963036515, "kl_target": 0.0270990929592, "vf_loss_coeff": 0.6688075857018, "entropy_coeff": 0.0090570820258, "clip_param": 0.1221781641624, "vf_clip_param": 0.1027808522125, "entropy_coeff_schedule": null, "lr_schedule": null, "sgd_minibatch_size": -1, "vf_share_layers": -1, "__stdout_file__": null, "__stderr_file__": null, "lambda": 0.9099046732075, "input": "sampler", "policies": {"default_policy": [null, null, null, null]}, "callbacks": "<class 'ray.rllib.callbacks.callbacks.RLlibCallback'>", "create_env_on_driver": false, "custom_eval_function": null, "framework": "torch"}, "time_since_restore": 136.1433720588684, "iterations_since_restore": 20, "perf": {"cpu_util_percent": 92.05714285714285, "ram_util_percent": 81.42857142857143}}
