{"timers": {"training_iteration": 6.841630958020687, "restore_env_runners": 4.754203837364912e-05, "training_step": 6.841091459034942, "env_runner_sampling_timer": 6.522903541917913, "learner_update_timer": 0.30939099995885044, "synch_weights": 0.001812000060454011}, "env_runners": {"module_to_env_connector": {"timers": {"connectors": {"remove_single_ts_time_rank_from_batch": 1.8164502938317911e-06, "listify_data_for_vector_env": 3.772535042787075e-05, "get_actions": 0.0003098588372208978, "normalize_and_clip_actions": 4.438040992016926e-05, "tensor_to_numpy": 5.7649679369365624e-05, "un_batch_to_individual_items": 2.0640696107829655e-05}}, "connector_pipeline_timer": 0.0005849413196117312}, "env_step_timer": 7.661912897556538e-05, "env_to_module_connector": {"timers": {"connectors": {"numpy_to_tensor": 4.340864633077826e-05, "add_time_dim_to_batch_and_zero_pad": 8.142280388776066e-06, "add_observations_from_episodes_to_batch": 9.58345880106877e-06, "batch_individual_items": 3.316659416568641e-05, "add_states_from_episodes_to_batch": 5.321959897172893e-06}}, "connector_pipeline_timer": 0.00018343761866724368}, "num_episodes_lifetime": 31375.0, "time_between_sampling": 0.0013899948774374477, "num_agent_steps_sampled_lifetime": {"default_agent": 627500.0}, "rlmodule_inference_timer": 0.0002071252825578661, "episode_return_mean": -4.459999999999999, "episode_len_mean": 20.0, "env_reset_timer": 0.0004252358746255202, "num_agent_steps_sampled": {"default_agent": 5000.0}, "num_env_steps_sampled_lifetime": 627500.0, "episode_return_max": 6.5, "num_episodes": 250.0, "env_to_module_sum_episodes_length_in": 10.191744832559449, "module_episode_returns_mean": {"default_policy": -4.459999999999999}, "agent_episode_returns_mean": {"default_agent": -4.459999999999999}, "num_module_steps_sampled": {"default_policy": 5000.0}, "num_env_steps_sampled": 5000.0, "episode_duration_sec_mean": 0.022473462333437055, "episode_len_min": 20, "sample": 0.032587239012093046, "episode_return_min": -13.5, "weights_seq_no": 0.0, "env_to_module_sum_episodes_length_out": 10.191744832559449, "num_module_steps_sampled_lifetime": {"default_policy": 627500.0}, "episode_len_max": 20, "num_env_steps_sampled_lifetime_throughput": 1569.3857435203727}, "learners": {"default_policy": {"num_module_steps_trained": 6000, "num_module_steps_trained_lifetime": 6000, "curr_entropy_coeff": 0.0090570820258, "policy_loss": -0.02556947059929371, "total_loss": 0.035620804876089096, "weights_seq_no": 1.0, "default_optimizer_learning_rate": 0.0002847858517, "vf_loss_unclipped": 30.21761131286621, "entropy": 0.6885641813278198, "gradients_default_optimizer_global_norm": 0.01337447576224804, "num_trainable_parameters": 6003, "mean_kl_loss": 0.0003655994951259345, "module_train_batch_size_mean": 1000.0, "vf_loss": 0.1004081591963768, "diff_num_grad_updates_vs_sampler_policy": 1.0, "vf_explained_var": -0.013725519180297852, "curr_kl_coeff": 0.3732481598854065, "num_module_steps_trained_lifetime_throughput": 346860.5154898475}, "__all_modules__": {"learner_connector": {"timers": {"connectors": {"add_columns_from_episodes_to_train_batch": 0.11137325002346188, "add_time_dim_to_batch_and_zero_pad": 1.6166013665497303e-05, "batch_individual_items": 0.046343459049239755, "add_states_from_episodes_to_batch": 4.458008334040642e-06, "numpy_to_tensor": 8.483300916850567e-05, "add_one_ts_to_episodes_and_truncate": 0.02302233304362744, "general_advantage_estimation": 0.008044708985835314, "add_observations_from_episodes_to_batch": 0.001007791026495397}}, "connector_pipeline_timer": 0.19036683393642306}, "num_trainable_parameters": 6003, "learner_connector_sum_episodes_length_in": 5000, "learner_connector_sum_episodes_length_out": 5250, "num_env_steps_trained": 31500, "num_module_steps_trained": 6000, "num_module_steps_trained_lifetime": 6000, "num_non_trainable_parameters": 0, "num_env_steps_trained_lifetime": 31500, "num_env_steps_trained_lifetime_throughput": 1804432.918020745, "num_module_steps_trained_throughput": 345863.5656958355, "num_module_steps_trained_lifetime_throughput": 345093.1773176282}}, "num_training_step_calls_per_iteration": 1, "num_env_steps_sampled_lifetime": 627500.0, "evaluation": {"env_runners": {"env_step_timer": 3.803647919165958e-05, "num_episodes_lifetime": 20, "env_reset_timer": 0.0009470829972997308, "num_env_steps_sampled_lifetime": 5400, "env_to_module_connector": {"timers": {"connectors": {"add_observations_from_episodes_to_batch": 5.5996543251434e-06, "add_states_from_episodes_to_batch": 2.8540722457040914e-06, "numpy_to_tensor": 1.9103724701034574e-05, "batch_individual_items": 1.140917106995379e-05, "add_time_dim_to_batch_and_zero_pad": 4.473412812669209e-06}}, "connector_pipeline_timer": 9.024968119711718e-05}, "num_agent_steps_sampled": {"default_agent": 400}, "episode_len_min": 20, "sample": 0.3306295000948012, "module_to_env_connector": {"timers": {"connectors": {"get_actions": 0.0001580022946899955, "un_batch_to_individual_items": 7.940768009357818e-05, "remove_single_ts_time_rank_from_batch": 1.2159650780981091e-06, "listify_data_for_vector_env": 2.1494050381708694e-05, "tensor_to_numpy": 3.538025562266783e-05, "normalize_and_clip_actions": 1.7827376980360838e-05}}, "connector_pipeline_timer": 0.00038647984806693835}, "episode_return_min": -13.5, "env_to_module_sum_episodes_length_out": 10.216013141322508, "rlmodule_inference_timer": 0.00016839859765203216, "num_agent_steps_sampled_lifetime": {"default_agent": 400}, "episode_duration_sec_mean": 0.015644108259584753, "module_episode_returns_mean": {"default_policy": 0.6}, "agent_episode_returns_mean": {"default_agent": 0.6}, "num_module_steps_sampled": {"default_policy": 400}, "episode_return_max": 13.5, "num_episodes": 20, "env_to_module_sum_episodes_length_in": 10.216013141322508, "num_env_steps_sampled": 400, "weights_seq_no": 1.0, "episode_return_mean": 0.6, "episode_len_mean": 20.0, "num_module_steps_sampled_lifetime": {"default_policy": 400}, "episode_len_max": 20}, "num_healthy_workers": 1, "actor_manager_num_outstanding_async_reqs": 0, "num_remote_worker_restarts": 0}, "fault_tolerance": {"num_healthy_workers": 0, "num_remote_worker_restarts": 0}, "env_runner_group": {"actor_manager_num_outstanding_async_reqs": 0}, "done": false, "training_iteration": 1, "trial_id": "4995b_00000", "date": "2025-08-11_19-25-24", "timestamp": 1754933124, "time_this_iter_s": 7.209979295730591, "time_total_s": 7.209979295730591, "pid": 14987, "hostname": "Mac", "node_ip": "127.0.0.1", "config": {"exploration_config": {}, "extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "placement_strategy": "PACK", "num_gpus": 0, "_fake_gpus": false, "num_cpus_for_main_process": 2, "eager_tracing": true, "eager_max_retraces": 20, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "torch_compile_learner": false, "torch_compile_learner_what_to_compile": "forward_train", "torch_compile_learner_dynamo_backend": "aot_eager", "torch_compile_learner_dynamo_mode": null, "torch_compile_worker": false, "torch_compile_worker_dynamo_backend": "aot_eager", "torch_compile_worker_dynamo_mode": null, "torch_ddp_kwargs": {}, "torch_skip_nan_gradients": false, "env": "Umbrella", "env_config": {}, "observation_space": null, "action_space": null, "clip_rewards": null, "normalize_actions": true, "clip_actions": false, "_is_atari": null, "disable_env_checking": false, "render_env": false, "action_mask_key": "action_mask", "env_runner_cls": null, "num_env_runners": 0, "create_local_env_runner": true, "num_envs_per_env_runner": 1, "gym_env_vectorize_mode": "SYNC", "num_cpus_per_env_runner": 1, "num_gpus_per_env_runner": 0, "custom_resources_per_env_runner": {}, "validate_env_runners_after_construction": true, "episodes_to_numpy": true, "max_requests_in_flight_per_env_runner": 1, "sample_timeout_s": 60.0, "_env_to_module_connector": null, "add_default_connectors_to_env_to_module_pipeline": true, "_module_to_env_connector": null, "add_default_connectors_to_module_to_env_pipeline": true, "merge_env_runner_states": "training_only", "broadcast_env_runner_states": true, "episode_lookback_horizon": 1, "rollout_fragment_length": "auto", "batch_mode": "complete_episodes", "compress_observations": false, "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "enable_tf1_exec_eagerly": false, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "preprocessor_pref": "deepmind", "observation_filter": "NoFilter", "update_worker_filter_stats": true, "use_worker_filter_stats": true, "sampler_perf_stats_ema_coef": null, "_is_online": true, "num_learners": 0, "num_gpus_per_learner": 0, "num_cpus_per_learner": "auto", "num_aggregator_actors_per_learner": 0, "max_requests_in_flight_per_aggregator_actor": 3, "local_gpu_idx": 0, "max_requests_in_flight_per_learner": 3, "gamma": 1, "lr": 0.0002847858517, "grad_clip": 0.5, "grad_clip_by": "global_norm", "_train_batch_size_per_learner": 5000, "train_batch_size": 4000, "num_epochs": 1, "minibatch_size": 1000, "shuffle_batch_per_epoch": true, "model": {"fcnet_hiddens": [256, 256], "fcnet_activation": "tanh", "fcnet_weights_initializer": null, "fcnet_weights_initializer_config": null, "fcnet_bias_initializer": null, "fcnet_bias_initializer_config": null, "conv_filters": null, "conv_activation": "relu", "conv_kernel_initializer": null, "conv_kernel_initializer_config": null, "conv_bias_initializer": null, "conv_bias_initializer_config": null, "conv_transpose_kernel_initializer": null, "conv_transpose_kernel_initializer_config": null, "conv_transpose_bias_initializer": null, "conv_transpose_bias_initializer_config": null, "post_fcnet_hiddens": [], "post_fcnet_activation": "relu", "post_fcnet_weights_initializer": null, "post_fcnet_weights_initializer_config": null, "post_fcnet_bias_initializer": null, "post_fcnet_bias_initializer_config": null, "free_log_std": false, "log_std_clip_param": 20.0, "no_final_linear": false, "vf_share_layers": false, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "lstm_weights_initializer": null, "lstm_weights_initializer_config": null, "lstm_bias_initializer": null, "lstm_bias_initializer_config": null, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "attention_use_n_prev_actions": 0, "attention_use_n_prev_rewards": 0, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": null, "custom_model_config": {}, "custom_action_dist": null, "custom_preprocessor": null, "encoder_latent_dim": null, "always_check_shapes": false, "lstm_use_prev_action_reward": -1, "_use_default_native_models": -1, "_disable_preprocessor_api": false, "_disable_action_flattening": false}, "_learner_connector": null, "add_default_connectors_to_learner_pipeline": true, "learner_config_dict": {}, "optimizer": {}, "_learner_class": null, "callbacks_on_algorithm_init": null, "callbacks_on_env_runners_recreated": null, "callbacks_on_offline_eval_runners_recreated": null, "callbacks_on_checkpoint_loaded": null, "callbacks_on_environment_created": null, "callbacks_on_episode_created": null, "callbacks_on_episode_start": null, "callbacks_on_episode_step": null, "callbacks_on_episode_end": null, "callbacks_on_evaluate_start": null, "callbacks_on_evaluate_end": null, "callbacks_on_evaluate_offline_start": null, "callbacks_on_evaluate_offline_end": null, "callbacks_on_sample_end": null, "callbacks_on_train_result": null, "explore": true, "enable_rl_module_and_learner": true, "enable_env_runner_and_connector_v2": true, "_prior_exploration_config": {"type": "StochasticSampling"}, "count_steps_by": "env_steps", "policy_map_capacity": 100, "policy_mapping_fn": "<function AlgorithmConfig.DEFAULT_POLICY_MAPPING_FN at 0x3867f18a0>", "policies_to_train": null, "policy_states_are_swappable": false, "observation_fn": null, "offline_data_class": null, "input_read_method": "read_parquet", "input_read_method_kwargs": {}, "input_read_schema": {}, "input_read_episodes": false, "input_read_sample_batches": false, "input_read_batch_size": null, "input_filesystem": null, "input_filesystem_kwargs": {}, "input_compress_columns": ["obs", "new_obs"], "input_spaces_jsonable": true, "materialize_data": false, "materialize_mapped_data": true, "map_batches_kwargs": {}, "iter_batches_kwargs": {}, "ignore_final_observation": false, "prelearner_class": null, "prelearner_buffer_class": null, "prelearner_buffer_kwargs": {}, "prelearner_module_synch_period": 10, "dataset_num_iters_per_learner": null, "input_config": {}, "actions_in_input_normalized": false, "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_config": {}, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "output_max_rows_per_file": null, "output_write_remaining_data": false, "output_write_method": "write_parquet", "output_write_method_kwargs": {}, "output_filesystem": null, "output_filesystem_kwargs": {}, "output_write_episodes": true, "offline_sampling": false, "evaluation_interval": 1, "evaluation_duration": 20, "evaluation_duration_unit": "episodes", "evaluation_sample_timeout_s": 120.0, "evaluation_auto_duration_min_env_steps_per_sample": 100, "evaluation_auto_duration_max_env_steps_per_sample": 2000, "evaluation_parallel_to_training": false, "evaluation_force_reset_envs_before_iteration": true, "evaluation_config": null, "off_policy_estimation_methods": {}, "ope_split_batch_by_episode": true, "evaluation_num_env_runners": 1, "in_evaluation": false, "sync_filters_on_rollout_workers_timeout_s": 10.0, "offline_evaluation_interval": null, "num_offline_eval_runners": 0, "offline_loss_for_module_fn": null, "offline_evaluation_duration": 1, "offline_evaluation_parallel_to_training": false, "offline_evaluation_timeout_s": 120.0, "num_cpus_per_offline_eval_runner": 1, "num_gpus_per_offline_eval_runner": 0, "custom_resources_per_offline_eval_runner": {}, "restart_failed_offline_eval_runners": true, "ignore_offline_eval_runner_failures": false, "max_num_offline_eval_runner_restarts": 1000, "offline_eval_runner_restore_timeout_s": 1800.0, "max_requests_in_flight_per_offline_eval_runner": 1, "validate_offline_eval_runners_after_construction": true, "offline_eval_runner_health_probe_timeout_s": 30.0, "offline_eval_rl_module_inference_only": false, "broadcast_offline_eval_runner_states": false, "offline_eval_batch_size_per_runner": 256, "dataset_num_iters_per_eval_runner": 1, "keep_per_episode_custom_metrics": false, "metrics_episode_collection_timeout_s": 60.0, "metrics_num_episodes_for_smoothing": 100, "min_time_s_per_iteration": null, "min_train_timesteps_per_iteration": 0, "min_sample_timesteps_per_iteration": 0, "log_gradients": true, "export_native_model_files": false, "checkpoint_trainable_policies_only": false, "logger_creator": null, "logger_config": null, "log_level": "WARN", "log_sys_usage": true, "fake_sampler": false, "seed": 3, "restart_failed_env_runners": true, "ignore_env_runner_failures": false, "max_num_env_runner_restarts": 1000, "delay_between_env_runner_restarts_s": 60.0, "restart_failed_sub_environments": false, "num_consecutive_env_runner_failures_tolerance": 100, "env_runner_health_probe_timeout_s": 30.0, "env_runner_restore_timeout_s": 1800.0, "_model_config": {}, "_rl_module_spec": "RLModuleSpec(module_class=None, observation_space=None, action_space=None, inference_only=False, learner_only=False, model_config=DefaultModelConfig(fcnet_hiddens=[60, 90], fcnet_activation='tanh', fcnet_kernel_initializer=None, fcnet_kernel_initializer_kwargs=None, fcnet_bias_initializer=None, fcnet_bias_initializer_kwargs=None, conv_filters=None, conv_activation='relu', conv_kernel_initializer=None, conv_kernel_initializer_kwargs=None, conv_bias_initializer=None, conv_bias_initializer_kwargs=None, head_fcnet_hiddens=[], head_fcnet_activation='relu', head_fcnet_kernel_initializer=None, head_fcnet_kernel_initializer_kwargs=None, head_fcnet_bias_initializer=None, head_fcnet_bias_initializer_kwargs=None, free_log_std=False, log_std_clip_param=20.0, vf_share_layers=True, use_lstm=False, max_seq_len=20, lstm_cell_size=256, lstm_use_prev_action=False, lstm_use_prev_reward=False, lstm_kernel_initializer=None, lstm_kernel_initializer_kwargs=None, lstm_bias_initializer=None, lstm_bias_initializer_kwargs=None), catalog_class=None, load_state_path=None, model_config_dict=None)", "algorithm_config_overrides_per_module": {}, "_per_module_overrides": {}, "_validate_config": true, "_use_msgpack_checkpoints": false, "_torch_grad_scaler_class": null, "_torch_lr_scheduler_classes": null, "_tf_policy_handles_more_than_one_loss": false, "_disable_preprocessor_api": false, "_disable_action_flattening": false, "_disable_initialize_loss_from_dummy_batch": false, "_dont_auto_sync_env_runner_states": false, "env_task_fn": -1, "enable_connectors": -1, "simple_optimizer": false, "policy_map_cache": -1, "worker_cls": -1, "synchronize_filters": -1, "enable_async_evaluation": -1, "custom_async_evaluation_function": -1, "_enable_rl_module_api": -1, "auto_wrap_old_gym_envs": -1, "always_attach_evaluation_results": -1, "replay_sequence_length": null, "_disable_execution_plan_api": -1, "use_critic": true, "use_gae": true, "use_kl_loss": true, "kl_coeff": 0.7464963036515, "kl_target": 0.0270990929592, "vf_loss_coeff": 0.6688075857018, "entropy_coeff": 0.0090570820258, "clip_param": 0.1221781641624, "vf_clip_param": 0.1027808522125, "entropy_coeff_schedule": null, "lr_schedule": null, "sgd_minibatch_size": -1, "vf_share_layers": -1, "__stdout_file__": null, "__stderr_file__": null, "lambda": 0.9099046732075, "input": "sampler", "policies": {"default_policy": [null, null, null, null]}, "callbacks": "<class 'ray.rllib.callbacks.callbacks.RLlibCallback'>", "create_env_on_driver": false, "custom_eval_function": null, "framework": "torch"}, "time_since_restore": 7.209979295730591, "iterations_since_restore": 1, "perf": {"cpu_util_percent": 84.87272727272726, "ram_util_percent": 80.25454545454546}}
{"timers": {"training_iteration": 6.833182556770043, "restore_env_runners": 4.713494796305895e-05, "training_step": 6.8326462702744175, "env_runner_sampling_timer": 6.511056881088297, "learner_update_timer": 0.31283813203917815, "synch_weights": 0.001803191310027614, "restore_eval_env_runners": 1.4082994312047958e-05, "evaluation_iteration": 0.3598810830153525, "synch_eval_env_connectors": 0.0005292500136420131, "synch_env_connectors": 1.9249971956014633e-05}, "env_runners": {"module_to_env_connector": {"timers": {"connectors": {"remove_single_ts_time_rank_from_batch": 1.6254069019527116e-06, "listify_data_for_vector_env": 3.799583694204988e-05, "get_actions": 0.00020913196386790112, "normalize_and_clip_actions": 4.367111343909902e-05, "tensor_to_numpy": 4.491958082673592e-05, "un_batch_to_individual_items": 1.9050937455044848e-05}}, "connector_pipeline_timer": 0.00043879142001426854}, "env_step_timer": 5.2386601493182765e-05, "env_to_module_connector": {"timers": {"connectors": {"numpy_to_tensor": 3.9166896629318194e-05, "add_time_dim_to_batch_and_zero_pad": 7.0188990704056535e-06, "add_observations_from_episodes_to_batch": 7.879497975395915e-06, "batch_individual_items": 2.4722953572992288e-05, "add_states_from_episodes_to_batch": 3.720857494792226e-06}}, "connector_pipeline_timer": 0.0001417229073564705}, "num_episodes_lifetime": 500.0, "time_between_sampling": 0.004952676378213684, "num_agent_steps_sampled_lifetime": {"default_agent": 10000.0}, "rlmodule_inference_timer": 0.00013361232582264566, "episode_return_mean": -5.5, "episode_len_mean": 20.0, "env_reset_timer": 0.00024323120215790254, "num_agent_steps_sampled": {"default_agent": 5000.0}, "num_env_steps_sampled_lifetime": 10000.0, "episode_return_max": 6.5, "num_episodes": 250.0, "env_to_module_sum_episodes_length_in": 10.36823839457432, "module_episode_returns_mean": {"default_policy": -5.5}, "agent_episode_returns_mean": {"default_agent": -5.5}, "num_module_steps_sampled": {"default_policy": 5000.0}, "num_env_steps_sampled": 5000.0, "episode_duration_sec_mean": 0.01837789302226156, "episode_len_min": 20, "sample": 0.023085475524522146, "episode_return_min": -13.5, "weights_seq_no": 1.0, "env_to_module_sum_episodes_length_out": 10.36823839457432, "num_module_steps_sampled_lifetime": {"default_policy": 10000.0}, "episode_len_max": 20, "num_env_steps_sampled_lifetime_throughput": 1731.2305975110396}, "learners": {"default_policy": {"num_module_steps_trained": 6000, "num_module_steps_trained_lifetime": 12000, "curr_entropy_coeff": 0.0090570820258, "policy_loss": -0.11839213222265244, "total_loss": -0.05691200867295265, "weights_seq_no": 2.0, "default_optimizer_learning_rate": 0.0002847858517, "vf_loss_unclipped": 30.189531326293945, "entropy": 0.6920790672302246, "gradients_default_optimizer_global_norm": 0.0885528028011322, "num_trainable_parameters": 6003, "mean_kl_loss": 0.0015927486820146441, "module_train_batch_size_mean": 1000.0, "vf_loss": 0.10040832310914993, "diff_num_grad_updates_vs_sampler_policy": 1.0, "vf_explained_var": -0.013575196266174316, "curr_kl_coeff": 0.18662407994270325, "num_module_steps_trained_lifetime_throughput": 344869.06321925274}, "__all_modules__": {"learner_connector": {"timers": {"connectors": {"add_columns_from_episodes_to_train_batch": 0.11189884210238232, "add_time_dim_to_batch_and_zero_pad": 1.63197738584131e-05, "batch_individual_items": 0.05012774111935869, "add_states_from_episodes_to_batch": 4.497598856687545e-06, "numpy_to_tensor": 8.560717920772732e-05, "add_one_ts_to_episodes_and_truncate": 0.022974044302245603, "general_advantage_estimation": 0.008075663566123695, "add_observations_from_episodes_to_batch": 0.0010097872756887228}}, "connector_pipeline_timer": 0.19465998809668236}, "num_trainable_parameters": 6003, "learner_connector_sum_episodes_length_in": 5000.0, "learner_connector_sum_episodes_length_out": 5250.0, "num_env_steps_trained": 31500, "num_module_steps_trained": 6000, "num_module_steps_trained_lifetime": 12000, "num_non_trainable_parameters": 0, "num_env_steps_trained_lifetime": 63000, "num_env_steps_trained_lifetime_throughput": 1794207.9218540464, "num_module_steps_trained_throughput": 343886.86589473515, "num_module_steps_trained_lifetime_throughput": 343126.42252398987}}, "num_training_step_calls_per_iteration": 1, "evaluation": {"env_runners": {"env_step_timer": 3.582349048712994e-05, "num_episodes_lifetime": 40, "env_reset_timer": 0.0009384605078957975, "num_env_steps_sampled_lifetime": 10400, "env_to_module_connector": {"timers": {"connectors": {"add_observations_from_episodes_to_batch": 5.311698135798467e-06, "add_states_from_episodes_to_batch": 2.519185135366401e-06, "numpy_to_tensor": 1.9164799330688192e-05, "batch_individual_items": 1.1468253042734716e-05, "add_time_dim_to_batch_and_zero_pad": 4.3220995941001656e-06}}, "connector_pipeline_timer": 8.249795964414504e-05}, "num_agent_steps_sampled": {"default_agent": 400}, "episode_len_min": 20, "sample": 0.33057842717389574, "module_to_env_connector": {"timers": {"connectors": {"get_actions": 0.00010572265356008362, "un_batch_to_individual_items": 2.1694678169227704e-05, "remove_single_ts_time_rank_from_batch": 1.024188090596261e-06, "listify_data_for_vector_env": 2.8028134764927767e-05, "tensor_to_numpy": 3.291618393800353e-05, "normalize_and_clip_actions": 2.7264525330657466e-05}}, "connector_pipeline_timer": 0.0002697604848422179}, "episode_return_min": -13.5, "env_to_module_sum_episodes_length_out": 10.366003441359926, "rlmodule_inference_timer": 6.38886487229052e-05, "num_agent_steps_sampled_lifetime": {"default_agent": 800}, "episode_duration_sec_mean": 0.015129701019031928, "module_episode_returns_mean": {"default_policy": 0.6}, "agent_episode_returns_mean": {"default_agent": 0.6}, "num_module_steps_sampled": {"default_policy": 400}, "episode_return_max": 13.5, "num_episodes": 20, "env_to_module_sum_episodes_length_in": 10.366003441359926, "num_env_steps_sampled": 400, "weights_seq_no": 2.0, "episode_return_mean": 0.6, "episode_len_mean": 20.0, "num_module_steps_sampled_lifetime": {"default_policy": 800}, "episode_len_max": 20, "time_between_sampling": 6.096240250044502}, "num_healthy_workers": 1, "actor_manager_num_outstanding_async_reqs": 0, "num_remote_worker_restarts": 0}, "num_env_steps_sampled_lifetime": 10000.0, "fault_tolerance": {"num_healthy_workers": 0, "num_remote_worker_restarts": 0}, "env_runner_group": {"actor_manager_num_outstanding_async_reqs": 0}, "done": false, "training_iteration": 2, "trial_id": "4995b_00000", "date": "2025-08-11_19-25-31", "timestamp": 1754933131, "time_this_iter_s": 6.329859972000122, "time_total_s": 13.539839267730713, "pid": 14987, "hostname": "Mac", "node_ip": "127.0.0.1", "config": {"exploration_config": {}, "extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "placement_strategy": "PACK", "num_gpus": 0, "_fake_gpus": false, "num_cpus_for_main_process": 2, "eager_tracing": true, "eager_max_retraces": 20, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "torch_compile_learner": false, "torch_compile_learner_what_to_compile": "forward_train", "torch_compile_learner_dynamo_backend": "aot_eager", "torch_compile_learner_dynamo_mode": null, "torch_compile_worker": false, "torch_compile_worker_dynamo_backend": "aot_eager", "torch_compile_worker_dynamo_mode": null, "torch_ddp_kwargs": {}, "torch_skip_nan_gradients": false, "env": "Umbrella", "env_config": {}, "observation_space": null, "action_space": null, "clip_rewards": null, "normalize_actions": true, "clip_actions": false, "_is_atari": null, "disable_env_checking": false, "render_env": false, "action_mask_key": "action_mask", "env_runner_cls": null, "num_env_runners": 0, "create_local_env_runner": true, "num_envs_per_env_runner": 1, "gym_env_vectorize_mode": "SYNC", "num_cpus_per_env_runner": 1, "num_gpus_per_env_runner": 0, "custom_resources_per_env_runner": {}, "validate_env_runners_after_construction": true, "episodes_to_numpy": true, "max_requests_in_flight_per_env_runner": 1, "sample_timeout_s": 60.0, "_env_to_module_connector": null, "add_default_connectors_to_env_to_module_pipeline": true, "_module_to_env_connector": null, "add_default_connectors_to_module_to_env_pipeline": true, "merge_env_runner_states": "training_only", "broadcast_env_runner_states": true, "episode_lookback_horizon": 1, "rollout_fragment_length": "auto", "batch_mode": "complete_episodes", "compress_observations": false, "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "enable_tf1_exec_eagerly": false, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "preprocessor_pref": "deepmind", "observation_filter": "NoFilter", "update_worker_filter_stats": true, "use_worker_filter_stats": true, "sampler_perf_stats_ema_coef": null, "_is_online": true, "num_learners": 0, "num_gpus_per_learner": 0, "num_cpus_per_learner": "auto", "num_aggregator_actors_per_learner": 0, "max_requests_in_flight_per_aggregator_actor": 3, "local_gpu_idx": 0, "max_requests_in_flight_per_learner": 3, "gamma": 1, "lr": 0.0002847858517, "grad_clip": 0.5, "grad_clip_by": "global_norm", "_train_batch_size_per_learner": 5000, "train_batch_size": 4000, "num_epochs": 1, "minibatch_size": 1000, "shuffle_batch_per_epoch": true, "model": {"fcnet_hiddens": [256, 256], "fcnet_activation": "tanh", "fcnet_weights_initializer": null, "fcnet_weights_initializer_config": null, "fcnet_bias_initializer": null, "fcnet_bias_initializer_config": null, "conv_filters": null, "conv_activation": "relu", "conv_kernel_initializer": null, "conv_kernel_initializer_config": null, "conv_bias_initializer": null, "conv_bias_initializer_config": null, "conv_transpose_kernel_initializer": null, "conv_transpose_kernel_initializer_config": null, "conv_transpose_bias_initializer": null, "conv_transpose_bias_initializer_config": null, "post_fcnet_hiddens": [], "post_fcnet_activation": "relu", "post_fcnet_weights_initializer": null, "post_fcnet_weights_initializer_config": null, "post_fcnet_bias_initializer": null, "post_fcnet_bias_initializer_config": null, "free_log_std": false, "log_std_clip_param": 20.0, "no_final_linear": false, "vf_share_layers": false, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "lstm_weights_initializer": null, "lstm_weights_initializer_config": null, "lstm_bias_initializer": null, "lstm_bias_initializer_config": null, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "attention_use_n_prev_actions": 0, "attention_use_n_prev_rewards": 0, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": null, "custom_model_config": {}, "custom_action_dist": null, "custom_preprocessor": null, "encoder_latent_dim": null, "always_check_shapes": false, "lstm_use_prev_action_reward": -1, "_use_default_native_models": -1, "_disable_preprocessor_api": false, "_disable_action_flattening": false}, "_learner_connector": null, "add_default_connectors_to_learner_pipeline": true, "learner_config_dict": {}, "optimizer": {}, "_learner_class": null, "callbacks_on_algorithm_init": null, "callbacks_on_env_runners_recreated": null, "callbacks_on_offline_eval_runners_recreated": null, "callbacks_on_checkpoint_loaded": null, "callbacks_on_environment_created": null, "callbacks_on_episode_created": null, "callbacks_on_episode_start": null, "callbacks_on_episode_step": null, "callbacks_on_episode_end": null, "callbacks_on_evaluate_start": null, "callbacks_on_evaluate_end": null, "callbacks_on_evaluate_offline_start": null, "callbacks_on_evaluate_offline_end": null, "callbacks_on_sample_end": null, "callbacks_on_train_result": null, "explore": true, "enable_rl_module_and_learner": true, "enable_env_runner_and_connector_v2": true, "_prior_exploration_config": {"type": "StochasticSampling"}, "count_steps_by": "env_steps", "policy_map_capacity": 100, "policy_mapping_fn": "<function AlgorithmConfig.DEFAULT_POLICY_MAPPING_FN at 0x3867f18a0>", "policies_to_train": null, "policy_states_are_swappable": false, "observation_fn": null, "offline_data_class": null, "input_read_method": "read_parquet", "input_read_method_kwargs": {}, "input_read_schema": {}, "input_read_episodes": false, "input_read_sample_batches": false, "input_read_batch_size": null, "input_filesystem": null, "input_filesystem_kwargs": {}, "input_compress_columns": ["obs", "new_obs"], "input_spaces_jsonable": true, "materialize_data": false, "materialize_mapped_data": true, "map_batches_kwargs": {}, "iter_batches_kwargs": {}, "ignore_final_observation": false, "prelearner_class": null, "prelearner_buffer_class": null, "prelearner_buffer_kwargs": {}, "prelearner_module_synch_period": 10, "dataset_num_iters_per_learner": null, "input_config": {}, "actions_in_input_normalized": false, "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_config": {}, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "output_max_rows_per_file": null, "output_write_remaining_data": false, "output_write_method": "write_parquet", "output_write_method_kwargs": {}, "output_filesystem": null, "output_filesystem_kwargs": {}, "output_write_episodes": true, "offline_sampling": false, "evaluation_interval": 1, "evaluation_duration": 20, "evaluation_duration_unit": "episodes", "evaluation_sample_timeout_s": 120.0, "evaluation_auto_duration_min_env_steps_per_sample": 100, "evaluation_auto_duration_max_env_steps_per_sample": 2000, "evaluation_parallel_to_training": false, "evaluation_force_reset_envs_before_iteration": true, "evaluation_config": null, "off_policy_estimation_methods": {}, "ope_split_batch_by_episode": true, "evaluation_num_env_runners": 1, "in_evaluation": false, "sync_filters_on_rollout_workers_timeout_s": 10.0, "offline_evaluation_interval": null, "num_offline_eval_runners": 0, "offline_loss_for_module_fn": null, "offline_evaluation_duration": 1, "offline_evaluation_parallel_to_training": false, "offline_evaluation_timeout_s": 120.0, "num_cpus_per_offline_eval_runner": 1, "num_gpus_per_offline_eval_runner": 0, "custom_resources_per_offline_eval_runner": {}, "restart_failed_offline_eval_runners": true, "ignore_offline_eval_runner_failures": false, "max_num_offline_eval_runner_restarts": 1000, "offline_eval_runner_restore_timeout_s": 1800.0, "max_requests_in_flight_per_offline_eval_runner": 1, "validate_offline_eval_runners_after_construction": true, "offline_eval_runner_health_probe_timeout_s": 30.0, "offline_eval_rl_module_inference_only": false, "broadcast_offline_eval_runner_states": false, "offline_eval_batch_size_per_runner": 256, "dataset_num_iters_per_eval_runner": 1, "keep_per_episode_custom_metrics": false, "metrics_episode_collection_timeout_s": 60.0, "metrics_num_episodes_for_smoothing": 100, "min_time_s_per_iteration": null, "min_train_timesteps_per_iteration": 0, "min_sample_timesteps_per_iteration": 0, "log_gradients": true, "export_native_model_files": false, "checkpoint_trainable_policies_only": false, "logger_creator": null, "logger_config": null, "log_level": "WARN", "log_sys_usage": true, "fake_sampler": false, "seed": 3, "restart_failed_env_runners": true, "ignore_env_runner_failures": false, "max_num_env_runner_restarts": 1000, "delay_between_env_runner_restarts_s": 60.0, "restart_failed_sub_environments": false, "num_consecutive_env_runner_failures_tolerance": 100, "env_runner_health_probe_timeout_s": 30.0, "env_runner_restore_timeout_s": 1800.0, "_model_config": {}, "_rl_module_spec": "RLModuleSpec(module_class=None, observation_space=None, action_space=None, inference_only=False, learner_only=False, model_config=DefaultModelConfig(fcnet_hiddens=[60, 90], fcnet_activation='tanh', fcnet_kernel_initializer=None, fcnet_kernel_initializer_kwargs=None, fcnet_bias_initializer=None, fcnet_bias_initializer_kwargs=None, conv_filters=None, conv_activation='relu', conv_kernel_initializer=None, conv_kernel_initializer_kwargs=None, conv_bias_initializer=None, conv_bias_initializer_kwargs=None, head_fcnet_hiddens=[], head_fcnet_activation='relu', head_fcnet_kernel_initializer=None, head_fcnet_kernel_initializer_kwargs=None, head_fcnet_bias_initializer=None, head_fcnet_bias_initializer_kwargs=None, free_log_std=False, log_std_clip_param=20.0, vf_share_layers=True, use_lstm=False, max_seq_len=20, lstm_cell_size=256, lstm_use_prev_action=False, lstm_use_prev_reward=False, lstm_kernel_initializer=None, lstm_kernel_initializer_kwargs=None, lstm_bias_initializer=None, lstm_bias_initializer_kwargs=None), catalog_class=None, load_state_path=None, model_config_dict=None)", "algorithm_config_overrides_per_module": {}, "_per_module_overrides": {}, "_validate_config": true, "_use_msgpack_checkpoints": false, "_torch_grad_scaler_class": null, "_torch_lr_scheduler_classes": null, "_tf_policy_handles_more_than_one_loss": false, "_disable_preprocessor_api": false, "_disable_action_flattening": false, "_disable_initialize_loss_from_dummy_batch": false, "_dont_auto_sync_env_runner_states": false, "env_task_fn": -1, "enable_connectors": -1, "simple_optimizer": false, "policy_map_cache": -1, "worker_cls": -1, "synchronize_filters": -1, "enable_async_evaluation": -1, "custom_async_evaluation_function": -1, "_enable_rl_module_api": -1, "auto_wrap_old_gym_envs": -1, "always_attach_evaluation_results": -1, "replay_sequence_length": null, "_disable_execution_plan_api": -1, "use_critic": true, "use_gae": true, "use_kl_loss": true, "kl_coeff": 0.7464963036515, "kl_target": 0.0270990929592, "vf_loss_coeff": 0.6688075857018, "entropy_coeff": 0.0090570820258, "clip_param": 0.1221781641624, "vf_clip_param": 0.1027808522125, "entropy_coeff_schedule": null, "lr_schedule": null, "sgd_minibatch_size": -1, "vf_share_layers": -1, "__stdout_file__": null, "__stderr_file__": null, "lambda": 0.9099046732075, "input": "sampler", "policies": {"default_policy": [null, null, null, null]}, "callbacks": "<class 'ray.rllib.callbacks.callbacks.RLlibCallback'>", "create_env_on_driver": false, "custom_eval_function": null, "framework": "torch"}, "time_since_restore": 13.539839267730713, "iterations_since_restore": 2, "perf": {"cpu_util_percent": 93.46666666666665, "ram_util_percent": 80.13333333333334}}
{"timers": {"training_iteration": 6.815815654122446, "restore_env_runners": 4.6830269135534765e-05, "training_step": 6.815279808412387, "env_runner_sampling_timer": 6.4937010172773855, "learner_update_timer": 0.3127741702994099, "synch_weights": 0.0018647589774220248, "restore_eval_env_runners": 1.4032165054231883e-05, "evaluation_iteration": 0.3595918971858919, "synch_eval_env_connectors": 0.0005251187633257358, "synch_env_connectors": 1.9129972206428646e-05}, "env_runners": {"module_to_env_connector": {"timers": {"connectors": {"remove_single_ts_time_rank_from_batch": 1.5002538473557725e-06, "listify_data_for_vector_env": 3.430306191142943e-05, "get_actions": 0.00016501888896811007, "normalize_and_clip_actions": 2.7533610226479823e-05, "tensor_to_numpy": 4.402814831369658e-05, "un_batch_to_individual_items": 1.72247218808168e-05}}, "connector_pipeline_timer": 0.0003684868219936079}, "env_step_timer": 6.430494013231253e-05, "env_to_module_connector": {"timers": {"connectors": {"numpy_to_tensor": 2.9905524001106953e-05, "add_time_dim_to_batch_and_zero_pad": 6.29045870793963e-06, "add_observations_from_episodes_to_batch": 8.687667919665895e-06, "batch_individual_items": 1.964584518166698e-05, "add_states_from_episodes_to_batch": 3.8258486654842205e-06}}, "connector_pipeline_timer": 0.00012429265320703802}, "num_episodes_lifetime": -30375.0, "time_between_sampling": 0.0058111093246280285, "num_agent_steps_sampled_lifetime": {"default_agent": -607500.0}, "rlmodule_inference_timer": 0.00010763172909970247, "episode_return_mean": -3.100000000000002, "episode_len_mean": 20.0, "env_reset_timer": 0.00021706453344258844, "num_agent_steps_sampled": {"default_agent": 5000.0}, "num_env_steps_sampled_lifetime": -607500.0, "episode_return_max": 6.5, "num_episodes": 250.0, "env_to_module_sum_episodes_length_in": 10.36823839457432, "module_episode_returns_mean": {"default_policy": -3.100000000000002}, "agent_episode_returns_mean": {"default_agent": -3.100000000000002}, "num_module_steps_sampled": {"default_policy": 5000.0}, "num_env_steps_sampled": 5000.0, "episode_duration_sec_mean": 0.015760194504167883, "episode_len_min": 20, "sample": 0.01777246467668802, "episode_return_min": -13.5, "weights_seq_no": 2.0, "env_to_module_sum_episodes_length_out": 10.36823839457432, "num_module_steps_sampled_lifetime": {"default_policy": -607500.0}, "episode_len_max": 20, "num_env_steps_sampled_lifetime_throughput": 1893.6099114072708}, "learners": {"default_policy": {"num_module_steps_trained": 6000, "num_module_steps_trained_lifetime": 18000, "curr_entropy_coeff": 0.0090570820258, "policy_loss": -0.07973822951316833, "total_loss": -0.01838073693215847, "weights_seq_no": 3.0, "default_optimizer_learning_rate": 0.0002847858517, "vf_loss_unclipped": 28.8149471282959, "entropy": 0.6908020377159119, "gradients_default_optimizer_global_norm": 0.024950962513685226, "num_trainable_parameters": 6003, "mean_kl_loss": 0.004396282602101564, "module_train_batch_size_mean": 1000.0, "vf_loss": 0.09986981749534607, "diff_num_grad_updates_vs_sampler_policy": 1.0, "vf_explained_var": -0.012913346290588379, "curr_kl_coeff": 0.09331203997135162, "num_module_steps_trained_lifetime_throughput": 340015.5151944127}, "__all_modules__": {"learner_connector": {"timers": {"connectors": {"add_columns_from_episodes_to_train_batch": 0.1112115541012259, "add_time_dim_to_batch_and_zero_pad": 1.632241556653753e-05, "batch_individual_items": 0.0506984603690682, "add_states_from_episodes_to_batch": 4.4913728721439835e-06, "numpy_to_tensor": 8.580526794539766e-05, "add_one_ts_to_episodes_and_truncate": 0.02283070218880894, "general_advantage_estimation": 0.008117887770268136, "add_observations_from_episodes_to_batch": 0.0010085052325739525}}, "connector_pipeline_timer": 0.19443789071586218}, "num_trainable_parameters": 6003, "learner_connector_sum_episodes_length_in": 5000.0, "learner_connector_sum_episodes_length_out": 5250.0, "num_env_steps_trained": 31500, "num_module_steps_trained": 6000, "num_module_steps_trained_lifetime": 18000, "num_non_trainable_parameters": 0, "num_env_steps_trained_lifetime": 94500, "num_env_steps_trained_lifetime_throughput": 1769083.943600993, "num_module_steps_trained_throughput": 339052.53141106234, "num_module_steps_trained_lifetime_throughput": 338308.9773371279}}, "num_training_step_calls_per_iteration": 1, "evaluation": {"env_runners": {"env_step_timer": 0.00011796749241714848, "num_episodes_lifetime": 60, "env_reset_timer": 0.0009308404831914231, "num_env_steps_sampled_lifetime": 15400, "env_to_module_connector": {"timers": {"connectors": {"add_observations_from_episodes_to_batch": 8.366989986073907e-06, "add_states_from_episodes_to_batch": 3.418248836567027e-06, "numpy_to_tensor": 7.575413009115487e-05, "batch_individual_items": 4.279265207841383e-05, "add_time_dim_to_batch_and_zero_pad": 5.344281832736708e-06}}, "connector_pipeline_timer": 0.00022997680955972054}, "num_agent_steps_sampled": {"default_agent": 400}, "episode_len_min": 20, "sample": 0.33491653124225557, "module_to_env_connector": {"timers": {"connectors": {"get_actions": 0.0001465228001560761, "un_batch_to_individual_items": 2.0201046411364632e-05, "remove_single_ts_time_rank_from_batch": 1.6485275239860134e-06, "listify_data_for_vector_env": 3.55001977583406e-05, "tensor_to_numpy": 4.2712857127954536e-05, "normalize_and_clip_actions": 2.4007601707735933e-05}}, "connector_pipeline_timer": 0.0003440519913581741}, "episode_return_min": -13.5, "env_to_module_sum_episodes_length_out": 10.368205581254823, "rlmodule_inference_timer": 9.430772419990603e-05, "num_agent_steps_sampled_lifetime": {"default_agent": 1200}, "episode_duration_sec_mean": 0.022258960461476816, "module_episode_returns_mean": {"default_policy": 1.6}, "agent_episode_returns_mean": {"default_agent": 1.6}, "num_module_steps_sampled": {"default_policy": 400}, "episode_return_max": 13.5, "num_episodes": 20, "env_to_module_sum_episodes_length_in": 10.368205581254823, "num_env_steps_sampled": 400, "weights_seq_no": 3.0, "episode_return_mean": 1.6, "episode_len_mean": 20.0, "num_module_steps_sampled_lifetime": {"default_policy": 1200}, "episode_len_max": 20, "time_between_sampling": 6.086501407963223}, "num_healthy_workers": 1, "actor_manager_num_outstanding_async_reqs": 0, "num_remote_worker_restarts": 0}, "num_env_steps_sampled_lifetime": -607500.0, "fault_tolerance": {"num_healthy_workers": 0, "num_remote_worker_restarts": 0}, "env_runner_group": {"actor_manager_num_outstanding_async_reqs": 0}, "done": false, "training_iteration": 3, "trial_id": "4995b_00000", "date": "2025-08-11_19-25-37", "timestamp": 1754933137, "time_this_iter_s": 5.8734047412872314, "time_total_s": 19.413244009017944, "pid": 14987, "hostname": "Mac", "node_ip": "127.0.0.1", "config": {"exploration_config": {}, "extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "placement_strategy": "PACK", "num_gpus": 0, "_fake_gpus": false, "num_cpus_for_main_process": 2, "eager_tracing": true, "eager_max_retraces": 20, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "torch_compile_learner": false, "torch_compile_learner_what_to_compile": "forward_train", "torch_compile_learner_dynamo_backend": "aot_eager", "torch_compile_learner_dynamo_mode": null, "torch_compile_worker": false, "torch_compile_worker_dynamo_backend": "aot_eager", "torch_compile_worker_dynamo_mode": null, "torch_ddp_kwargs": {}, "torch_skip_nan_gradients": false, "env": "Umbrella", "env_config": {}, "observation_space": null, "action_space": null, "clip_rewards": null, "normalize_actions": true, "clip_actions": false, "_is_atari": null, "disable_env_checking": false, "render_env": false, "action_mask_key": "action_mask", "env_runner_cls": null, "num_env_runners": 0, "create_local_env_runner": true, "num_envs_per_env_runner": 1, "gym_env_vectorize_mode": "SYNC", "num_cpus_per_env_runner": 1, "num_gpus_per_env_runner": 0, "custom_resources_per_env_runner": {}, "validate_env_runners_after_construction": true, "episodes_to_numpy": true, "max_requests_in_flight_per_env_runner": 1, "sample_timeout_s": 60.0, "_env_to_module_connector": null, "add_default_connectors_to_env_to_module_pipeline": true, "_module_to_env_connector": null, "add_default_connectors_to_module_to_env_pipeline": true, "merge_env_runner_states": "training_only", "broadcast_env_runner_states": true, "episode_lookback_horizon": 1, "rollout_fragment_length": "auto", "batch_mode": "complete_episodes", "compress_observations": false, "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "enable_tf1_exec_eagerly": false, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "preprocessor_pref": "deepmind", "observation_filter": "NoFilter", "update_worker_filter_stats": true, "use_worker_filter_stats": true, "sampler_perf_stats_ema_coef": null, "_is_online": true, "num_learners": 0, "num_gpus_per_learner": 0, "num_cpus_per_learner": "auto", "num_aggregator_actors_per_learner": 0, "max_requests_in_flight_per_aggregator_actor": 3, "local_gpu_idx": 0, "max_requests_in_flight_per_learner": 3, "gamma": 1, "lr": 0.0002847858517, "grad_clip": 0.5, "grad_clip_by": "global_norm", "_train_batch_size_per_learner": 5000, "train_batch_size": 4000, "num_epochs": 1, "minibatch_size": 1000, "shuffle_batch_per_epoch": true, "model": {"fcnet_hiddens": [256, 256], "fcnet_activation": "tanh", "fcnet_weights_initializer": null, "fcnet_weights_initializer_config": null, "fcnet_bias_initializer": null, "fcnet_bias_initializer_config": null, "conv_filters": null, "conv_activation": "relu", "conv_kernel_initializer": null, "conv_kernel_initializer_config": null, "conv_bias_initializer": null, "conv_bias_initializer_config": null, "conv_transpose_kernel_initializer": null, "conv_transpose_kernel_initializer_config": null, "conv_transpose_bias_initializer": null, "conv_transpose_bias_initializer_config": null, "post_fcnet_hiddens": [], "post_fcnet_activation": "relu", "post_fcnet_weights_initializer": null, "post_fcnet_weights_initializer_config": null, "post_fcnet_bias_initializer": null, "post_fcnet_bias_initializer_config": null, "free_log_std": false, "log_std_clip_param": 20.0, "no_final_linear": false, "vf_share_layers": false, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "lstm_weights_initializer": null, "lstm_weights_initializer_config": null, "lstm_bias_initializer": null, "lstm_bias_initializer_config": null, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "attention_use_n_prev_actions": 0, "attention_use_n_prev_rewards": 0, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": null, "custom_model_config": {}, "custom_action_dist": null, "custom_preprocessor": null, "encoder_latent_dim": null, "always_check_shapes": false, "lstm_use_prev_action_reward": -1, "_use_default_native_models": -1, "_disable_preprocessor_api": false, "_disable_action_flattening": false}, "_learner_connector": null, "add_default_connectors_to_learner_pipeline": true, "learner_config_dict": {}, "optimizer": {}, "_learner_class": null, "callbacks_on_algorithm_init": null, "callbacks_on_env_runners_recreated": null, "callbacks_on_offline_eval_runners_recreated": null, "callbacks_on_checkpoint_loaded": null, "callbacks_on_environment_created": null, "callbacks_on_episode_created": null, "callbacks_on_episode_start": null, "callbacks_on_episode_step": null, "callbacks_on_episode_end": null, "callbacks_on_evaluate_start": null, "callbacks_on_evaluate_end": null, "callbacks_on_evaluate_offline_start": null, "callbacks_on_evaluate_offline_end": null, "callbacks_on_sample_end": null, "callbacks_on_train_result": null, "explore": true, "enable_rl_module_and_learner": true, "enable_env_runner_and_connector_v2": true, "_prior_exploration_config": {"type": "StochasticSampling"}, "count_steps_by": "env_steps", "policy_map_capacity": 100, "policy_mapping_fn": "<function AlgorithmConfig.DEFAULT_POLICY_MAPPING_FN at 0x3867f18a0>", "policies_to_train": null, "policy_states_are_swappable": false, "observation_fn": null, "offline_data_class": null, "input_read_method": "read_parquet", "input_read_method_kwargs": {}, "input_read_schema": {}, "input_read_episodes": false, "input_read_sample_batches": false, "input_read_batch_size": null, "input_filesystem": null, "input_filesystem_kwargs": {}, "input_compress_columns": ["obs", "new_obs"], "input_spaces_jsonable": true, "materialize_data": false, "materialize_mapped_data": true, "map_batches_kwargs": {}, "iter_batches_kwargs": {}, "ignore_final_observation": false, "prelearner_class": null, "prelearner_buffer_class": null, "prelearner_buffer_kwargs": {}, "prelearner_module_synch_period": 10, "dataset_num_iters_per_learner": null, "input_config": {}, "actions_in_input_normalized": false, "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_config": {}, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "output_max_rows_per_file": null, "output_write_remaining_data": false, "output_write_method": "write_parquet", "output_write_method_kwargs": {}, "output_filesystem": null, "output_filesystem_kwargs": {}, "output_write_episodes": true, "offline_sampling": false, "evaluation_interval": 1, "evaluation_duration": 20, "evaluation_duration_unit": "episodes", "evaluation_sample_timeout_s": 120.0, "evaluation_auto_duration_min_env_steps_per_sample": 100, "evaluation_auto_duration_max_env_steps_per_sample": 2000, "evaluation_parallel_to_training": false, "evaluation_force_reset_envs_before_iteration": true, "evaluation_config": null, "off_policy_estimation_methods": {}, "ope_split_batch_by_episode": true, "evaluation_num_env_runners": 1, "in_evaluation": false, "sync_filters_on_rollout_workers_timeout_s": 10.0, "offline_evaluation_interval": null, "num_offline_eval_runners": 0, "offline_loss_for_module_fn": null, "offline_evaluation_duration": 1, "offline_evaluation_parallel_to_training": false, "offline_evaluation_timeout_s": 120.0, "num_cpus_per_offline_eval_runner": 1, "num_gpus_per_offline_eval_runner": 0, "custom_resources_per_offline_eval_runner": {}, "restart_failed_offline_eval_runners": true, "ignore_offline_eval_runner_failures": false, "max_num_offline_eval_runner_restarts": 1000, "offline_eval_runner_restore_timeout_s": 1800.0, "max_requests_in_flight_per_offline_eval_runner": 1, "validate_offline_eval_runners_after_construction": true, "offline_eval_runner_health_probe_timeout_s": 30.0, "offline_eval_rl_module_inference_only": false, "broadcast_offline_eval_runner_states": false, "offline_eval_batch_size_per_runner": 256, "dataset_num_iters_per_eval_runner": 1, "keep_per_episode_custom_metrics": false, "metrics_episode_collection_timeout_s": 60.0, "metrics_num_episodes_for_smoothing": 100, "min_time_s_per_iteration": null, "min_train_timesteps_per_iteration": 0, "min_sample_timesteps_per_iteration": 0, "log_gradients": true, "export_native_model_files": false, "checkpoint_trainable_policies_only": false, "logger_creator": null, "logger_config": null, "log_level": "WARN", "log_sys_usage": true, "fake_sampler": false, "seed": 3, "restart_failed_env_runners": true, "ignore_env_runner_failures": false, "max_num_env_runner_restarts": 1000, "delay_between_env_runner_restarts_s": 60.0, "restart_failed_sub_environments": false, "num_consecutive_env_runner_failures_tolerance": 100, "env_runner_health_probe_timeout_s": 30.0, "env_runner_restore_timeout_s": 1800.0, "_model_config": {}, "_rl_module_spec": "RLModuleSpec(module_class=None, observation_space=None, action_space=None, inference_only=False, learner_only=False, model_config=DefaultModelConfig(fcnet_hiddens=[60, 90], fcnet_activation='tanh', fcnet_kernel_initializer=None, fcnet_kernel_initializer_kwargs=None, fcnet_bias_initializer=None, fcnet_bias_initializer_kwargs=None, conv_filters=None, conv_activation='relu', conv_kernel_initializer=None, conv_kernel_initializer_kwargs=None, conv_bias_initializer=None, conv_bias_initializer_kwargs=None, head_fcnet_hiddens=[], head_fcnet_activation='relu', head_fcnet_kernel_initializer=None, head_fcnet_kernel_initializer_kwargs=None, head_fcnet_bias_initializer=None, head_fcnet_bias_initializer_kwargs=None, free_log_std=False, log_std_clip_param=20.0, vf_share_layers=True, use_lstm=False, max_seq_len=20, lstm_cell_size=256, lstm_use_prev_action=False, lstm_use_prev_reward=False, lstm_kernel_initializer=None, lstm_kernel_initializer_kwargs=None, lstm_bias_initializer=None, lstm_bias_initializer_kwargs=None), catalog_class=None, load_state_path=None, model_config_dict=None)", "algorithm_config_overrides_per_module": {}, "_per_module_overrides": {}, "_validate_config": true, "_use_msgpack_checkpoints": false, "_torch_grad_scaler_class": null, "_torch_lr_scheduler_classes": null, "_tf_policy_handles_more_than_one_loss": false, "_disable_preprocessor_api": false, "_disable_action_flattening": false, "_disable_initialize_loss_from_dummy_batch": false, "_dont_auto_sync_env_runner_states": false, "env_task_fn": -1, "enable_connectors": -1, "simple_optimizer": false, "policy_map_cache": -1, "worker_cls": -1, "synchronize_filters": -1, "enable_async_evaluation": -1, "custom_async_evaluation_function": -1, "_enable_rl_module_api": -1, "auto_wrap_old_gym_envs": -1, "always_attach_evaluation_results": -1, "replay_sequence_length": null, "_disable_execution_plan_api": -1, "use_critic": true, "use_gae": true, "use_kl_loss": true, "kl_coeff": 0.7464963036515, "kl_target": 0.0270990929592, "vf_loss_coeff": 0.6688075857018, "entropy_coeff": 0.0090570820258, "clip_param": 0.1221781641624, "vf_clip_param": 0.1027808522125, "entropy_coeff_schedule": null, "lr_schedule": null, "sgd_minibatch_size": -1, "vf_share_layers": -1, "__stdout_file__": null, "__stderr_file__": null, "lambda": 0.9099046732075, "input": "sampler", "policies": {"default_policy": [null, null, null, null]}, "callbacks": "<class 'ray.rllib.callbacks.callbacks.RLlibCallback'>", "create_env_on_driver": false, "custom_eval_function": null, "framework": "torch"}, "time_since_restore": 19.413244009017944, "iterations_since_restore": 3, "perf": {"cpu_util_percent": 79.47500000000001, "ram_util_percent": 79.675}}
{"timers": {"training_iteration": 6.806577139251293, "restore_env_runners": 4.646362612396479e-05, "training_step": 6.806044355748022, "env_runner_sampling_timer": 6.4846751150247215, "learner_update_timer": 0.3126085623458039, "synch_weights": 0.0018572522186954736, "restore_eval_env_runners": 1.4034763001836837e-05, "evaluation_iteration": 0.3637399348841981, "synch_eval_env_connectors": 0.0005249354955391025, "synch_env_connectors": 1.904117268277332e-05}, "env_runners": {"module_to_env_connector": {"timers": {"connectors": {"remove_single_ts_time_rank_from_batch": 1.7812350764621045e-06, "listify_data_for_vector_env": 3.656624407129265e-05, "get_actions": 0.00018883301461125918, "normalize_and_clip_actions": 4.268890852320881e-05, "tensor_to_numpy": 5.226803963471323e-05, "un_batch_to_individual_items": 2.085681999472398e-05}}, "connector_pipeline_timer": 0.00043018731170211253}, "env_step_timer": 6.777557836696563e-05, "env_to_module_connector": {"timers": {"connectors": {"numpy_to_tensor": 3.25704120693786e-05, "add_time_dim_to_batch_and_zero_pad": 7.101138094364525e-06, "add_observations_from_episodes_to_batch": 9.070037824465815e-06, "batch_individual_items": 2.035021183292342e-05, "add_states_from_episodes_to_batch": 1.3329646216793466e-05}}, "connector_pipeline_timer": 0.00014307951094814304}, "num_episodes_lifetime": -61250.0, "time_between_sampling": 0.007162518691227877, "num_agent_steps_sampled_lifetime": {"default_agent": -1225000.0}, "rlmodule_inference_timer": 0.0001147910946133387, "episode_return_mean": -1.9799999999999998, "episode_len_mean": 20.0, "env_reset_timer": 0.00016470227246664158, "num_agent_steps_sampled": {"default_agent": 5000.0}, "num_env_steps_sampled_lifetime": -1225000.0, "episode_return_max": 6.5, "num_episodes": 250.0, "env_to_module_sum_episodes_length_in": 10.36823839457432, "module_episode_returns_mean": {"default_policy": -1.9799999999999998}, "agent_episode_returns_mean": {"default_agent": -1.9799999999999998}, "num_module_steps_sampled": {"default_policy": 5000.0}, "num_env_steps_sampled": 5000.0, "episode_duration_sec_mean": 0.018270347675774238, "episode_len_min": 20, "sample": 0.01857288315076304, "episode_return_min": -13.5, "weights_seq_no": 3.0, "env_to_module_sum_episodes_length_out": 10.36823839457432, "num_module_steps_sampled_lifetime": {"default_policy": -1225000.0}, "episode_len_max": 20, "num_env_steps_sampled_lifetime_throughput": 1813.757152635225}, "learners": {"default_policy": {"num_module_steps_trained": 6000, "num_module_steps_trained_lifetime": 24000, "curr_entropy_coeff": 0.0090570820258, "policy_loss": 0.09290732443332672, "total_loss": 0.15422971546649933, "weights_seq_no": 4.0, "default_optimizer_learning_rate": 0.0002847858517, "vf_loss_unclipped": 29.42681121826172, "entropy": 0.6751035451889038, "gradients_default_optimizer_global_norm": 0.022418634966015816, "num_trainable_parameters": 6003, "mean_kl_loss": 0.005344749428331852, "module_train_batch_size_mean": 1000.0, "vf_loss": 0.1000857725739479, "diff_num_grad_updates_vs_sampler_policy": 1.0, "vf_explained_var": -0.01295316219329834, "curr_kl_coeff": 0.04665601998567581, "num_module_steps_trained_lifetime_throughput": 333706.14032878575}, "__all_modules__": {"learner_connector": {"timers": {"connectors": {"add_columns_from_episodes_to_train_batch": 0.11065943481029918, "add_time_dim_to_batch_and_zero_pad": 1.6285021239775232e-05, "batch_individual_items": 0.05109978826490068, "add_states_from_episodes_to_batch": 4.4914594860747455e-06, "numpy_to_tensor": 8.654137525090484e-05, "add_one_ts_to_episodes_and_truncate": 0.02331893808748422, "general_advantage_estimation": 0.008294107232019541, "add_observations_from_episodes_to_batch": 0.0010092843502835602}}, "connector_pipeline_timer": 0.19495003513888726}, "num_trainable_parameters": 6003, "learner_connector_sum_episodes_length_in": 5000.0, "learner_connector_sum_episodes_length_out": 5250.0, "num_env_steps_trained": 31500, "num_module_steps_trained": 6000, "num_module_steps_trained_lifetime": 24000, "num_non_trainable_parameters": 0, "num_env_steps_trained_lifetime": 126000, "num_env_steps_trained_lifetime_throughput": 1736411.9050728634, "num_module_steps_trained_throughput": 332770.130509646, "num_module_steps_trained_lifetime_throughput": 332047.26858179754}}, "num_training_step_calls_per_iteration": 1, "evaluation": {"env_runners": {"env_step_timer": 9.393467466429851e-05, "num_episodes_lifetime": 80, "env_reset_timer": 0.0009242433283405844, "num_env_steps_sampled_lifetime": 20400, "env_to_module_connector": {"timers": {"connectors": {"add_observations_from_episodes_to_batch": 7.0337813518341285e-06, "add_states_from_episodes_to_batch": 3.765077838632717e-06, "numpy_to_tensor": 3.236912096541504e-05, "batch_individual_items": 1.8123970689911594e-05, "add_time_dim_to_batch_and_zero_pad": 7.632069628684482e-06}}, "connector_pipeline_timer": 0.00012228372207798814}, "num_agent_steps_sampled": {"default_agent": 400}, "episode_len_min": 20, "sample": 0.3365637988398078, "module_to_env_connector": {"timers": {"connectors": {"get_actions": 0.000418510066763956, "un_batch_to_individual_items": 1.5042773312368669e-05, "remove_single_ts_time_rank_from_batch": 2.353313981054377e-06, "listify_data_for_vector_env": 3.56132078033196e-05, "tensor_to_numpy": 4.4970146188328666e-05, "normalize_and_clip_actions": 2.4675986815996824e-05}}, "connector_pipeline_timer": 0.000617555147313885}, "episode_return_min": -13.5, "env_to_module_sum_episodes_length_out": 10.368237912813044, "rlmodule_inference_timer": 9.856234782665391e-05, "num_agent_steps_sampled_lifetime": {"default_agent": 1600}, "episode_duration_sec_mean": 0.022657103644451126, "module_episode_returns_mean": {"default_policy": 1.6}, "agent_episode_returns_mean": {"default_agent": 1.6}, "num_module_steps_sampled": {"default_policy": 400}, "episode_return_max": 13.5, "num_episodes": 20, "env_to_module_sum_episodes_length_in": 10.368237912813044, "num_env_steps_sampled": 400, "weights_seq_no": 4.0, "episode_return_mean": 1.6, "episode_len_mean": 20.0, "num_module_steps_sampled_lifetime": {"default_policy": 1600}, "episode_len_max": 20, "time_between_sampling": 6.084858631803049}, "num_healthy_workers": 1, "actor_manager_num_outstanding_async_reqs": 0, "num_remote_worker_restarts": 0}, "num_env_steps_sampled_lifetime": -1225000.0, "fault_tolerance": {"num_healthy_workers": 0, "num_remote_worker_restarts": 0}, "env_runner_group": {"actor_manager_num_outstanding_async_reqs": 0}, "done": false, "training_iteration": 4, "trial_id": "4995b_00000", "date": "2025-08-11_19-25-43", "timestamp": 1754933143, "time_this_iter_s": 6.40409779548645, "time_total_s": 25.817341804504395, "pid": 14987, "hostname": "Mac", "node_ip": "127.0.0.1", "config": {"exploration_config": {}, "extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "placement_strategy": "PACK", "num_gpus": 0, "_fake_gpus": false, "num_cpus_for_main_process": 2, "eager_tracing": true, "eager_max_retraces": 20, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "torch_compile_learner": false, "torch_compile_learner_what_to_compile": "forward_train", "torch_compile_learner_dynamo_backend": "aot_eager", "torch_compile_learner_dynamo_mode": null, "torch_compile_worker": false, "torch_compile_worker_dynamo_backend": "aot_eager", "torch_compile_worker_dynamo_mode": null, "torch_ddp_kwargs": {}, "torch_skip_nan_gradients": false, "env": "Umbrella", "env_config": {}, "observation_space": null, "action_space": null, "clip_rewards": null, "normalize_actions": true, "clip_actions": false, "_is_atari": null, "disable_env_checking": false, "render_env": false, "action_mask_key": "action_mask", "env_runner_cls": null, "num_env_runners": 0, "create_local_env_runner": true, "num_envs_per_env_runner": 1, "gym_env_vectorize_mode": "SYNC", "num_cpus_per_env_runner": 1, "num_gpus_per_env_runner": 0, "custom_resources_per_env_runner": {}, "validate_env_runners_after_construction": true, "episodes_to_numpy": true, "max_requests_in_flight_per_env_runner": 1, "sample_timeout_s": 60.0, "_env_to_module_connector": null, "add_default_connectors_to_env_to_module_pipeline": true, "_module_to_env_connector": null, "add_default_connectors_to_module_to_env_pipeline": true, "merge_env_runner_states": "training_only", "broadcast_env_runner_states": true, "episode_lookback_horizon": 1, "rollout_fragment_length": "auto", "batch_mode": "complete_episodes", "compress_observations": false, "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "enable_tf1_exec_eagerly": false, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "preprocessor_pref": "deepmind", "observation_filter": "NoFilter", "update_worker_filter_stats": true, "use_worker_filter_stats": true, "sampler_perf_stats_ema_coef": null, "_is_online": true, "num_learners": 0, "num_gpus_per_learner": 0, "num_cpus_per_learner": "auto", "num_aggregator_actors_per_learner": 0, "max_requests_in_flight_per_aggregator_actor": 3, "local_gpu_idx": 0, "max_requests_in_flight_per_learner": 3, "gamma": 1, "lr": 0.0002847858517, "grad_clip": 0.5, "grad_clip_by": "global_norm", "_train_batch_size_per_learner": 5000, "train_batch_size": 4000, "num_epochs": 1, "minibatch_size": 1000, "shuffle_batch_per_epoch": true, "model": {"fcnet_hiddens": [256, 256], "fcnet_activation": "tanh", "fcnet_weights_initializer": null, "fcnet_weights_initializer_config": null, "fcnet_bias_initializer": null, "fcnet_bias_initializer_config": null, "conv_filters": null, "conv_activation": "relu", "conv_kernel_initializer": null, "conv_kernel_initializer_config": null, "conv_bias_initializer": null, "conv_bias_initializer_config": null, "conv_transpose_kernel_initializer": null, "conv_transpose_kernel_initializer_config": null, "conv_transpose_bias_initializer": null, "conv_transpose_bias_initializer_config": null, "post_fcnet_hiddens": [], "post_fcnet_activation": "relu", "post_fcnet_weights_initializer": null, "post_fcnet_weights_initializer_config": null, "post_fcnet_bias_initializer": null, "post_fcnet_bias_initializer_config": null, "free_log_std": false, "log_std_clip_param": 20.0, "no_final_linear": false, "vf_share_layers": false, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "lstm_weights_initializer": null, "lstm_weights_initializer_config": null, "lstm_bias_initializer": null, "lstm_bias_initializer_config": null, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "attention_use_n_prev_actions": 0, "attention_use_n_prev_rewards": 0, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": null, "custom_model_config": {}, "custom_action_dist": null, "custom_preprocessor": null, "encoder_latent_dim": null, "always_check_shapes": false, "lstm_use_prev_action_reward": -1, "_use_default_native_models": -1, "_disable_preprocessor_api": false, "_disable_action_flattening": false}, "_learner_connector": null, "add_default_connectors_to_learner_pipeline": true, "learner_config_dict": {}, "optimizer": {}, "_learner_class": null, "callbacks_on_algorithm_init": null, "callbacks_on_env_runners_recreated": null, "callbacks_on_offline_eval_runners_recreated": null, "callbacks_on_checkpoint_loaded": null, "callbacks_on_environment_created": null, "callbacks_on_episode_created": null, "callbacks_on_episode_start": null, "callbacks_on_episode_step": null, "callbacks_on_episode_end": null, "callbacks_on_evaluate_start": null, "callbacks_on_evaluate_end": null, "callbacks_on_evaluate_offline_start": null, "callbacks_on_evaluate_offline_end": null, "callbacks_on_sample_end": null, "callbacks_on_train_result": null, "explore": true, "enable_rl_module_and_learner": true, "enable_env_runner_and_connector_v2": true, "_prior_exploration_config": {"type": "StochasticSampling"}, "count_steps_by": "env_steps", "policy_map_capacity": 100, "policy_mapping_fn": "<function AlgorithmConfig.DEFAULT_POLICY_MAPPING_FN at 0x3867f18a0>", "policies_to_train": null, "policy_states_are_swappable": false, "observation_fn": null, "offline_data_class": null, "input_read_method": "read_parquet", "input_read_method_kwargs": {}, "input_read_schema": {}, "input_read_episodes": false, "input_read_sample_batches": false, "input_read_batch_size": null, "input_filesystem": null, "input_filesystem_kwargs": {}, "input_compress_columns": ["obs", "new_obs"], "input_spaces_jsonable": true, "materialize_data": false, "materialize_mapped_data": true, "map_batches_kwargs": {}, "iter_batches_kwargs": {}, "ignore_final_observation": false, "prelearner_class": null, "prelearner_buffer_class": null, "prelearner_buffer_kwargs": {}, "prelearner_module_synch_period": 10, "dataset_num_iters_per_learner": null, "input_config": {}, "actions_in_input_normalized": false, "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_config": {}, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "output_max_rows_per_file": null, "output_write_remaining_data": false, "output_write_method": "write_parquet", "output_write_method_kwargs": {}, "output_filesystem": null, "output_filesystem_kwargs": {}, "output_write_episodes": true, "offline_sampling": false, "evaluation_interval": 1, "evaluation_duration": 20, "evaluation_duration_unit": "episodes", "evaluation_sample_timeout_s": 120.0, "evaluation_auto_duration_min_env_steps_per_sample": 100, "evaluation_auto_duration_max_env_steps_per_sample": 2000, "evaluation_parallel_to_training": false, "evaluation_force_reset_envs_before_iteration": true, "evaluation_config": null, "off_policy_estimation_methods": {}, "ope_split_batch_by_episode": true, "evaluation_num_env_runners": 1, "in_evaluation": false, "sync_filters_on_rollout_workers_timeout_s": 10.0, "offline_evaluation_interval": null, "num_offline_eval_runners": 0, "offline_loss_for_module_fn": null, "offline_evaluation_duration": 1, "offline_evaluation_parallel_to_training": false, "offline_evaluation_timeout_s": 120.0, "num_cpus_per_offline_eval_runner": 1, "num_gpus_per_offline_eval_runner": 0, "custom_resources_per_offline_eval_runner": {}, "restart_failed_offline_eval_runners": true, "ignore_offline_eval_runner_failures": false, "max_num_offline_eval_runner_restarts": 1000, "offline_eval_runner_restore_timeout_s": 1800.0, "max_requests_in_flight_per_offline_eval_runner": 1, "validate_offline_eval_runners_after_construction": true, "offline_eval_runner_health_probe_timeout_s": 30.0, "offline_eval_rl_module_inference_only": false, "broadcast_offline_eval_runner_states": false, "offline_eval_batch_size_per_runner": 256, "dataset_num_iters_per_eval_runner": 1, "keep_per_episode_custom_metrics": false, "metrics_episode_collection_timeout_s": 60.0, "metrics_num_episodes_for_smoothing": 100, "min_time_s_per_iteration": null, "min_train_timesteps_per_iteration": 0, "min_sample_timesteps_per_iteration": 0, "log_gradients": true, "export_native_model_files": false, "checkpoint_trainable_policies_only": false, "logger_creator": null, "logger_config": null, "log_level": "WARN", "log_sys_usage": true, "fake_sampler": false, "seed": 3, "restart_failed_env_runners": true, "ignore_env_runner_failures": false, "max_num_env_runner_restarts": 1000, "delay_between_env_runner_restarts_s": 60.0, "restart_failed_sub_environments": false, "num_consecutive_env_runner_failures_tolerance": 100, "env_runner_health_probe_timeout_s": 30.0, "env_runner_restore_timeout_s": 1800.0, "_model_config": {}, "_rl_module_spec": "RLModuleSpec(module_class=None, observation_space=None, action_space=None, inference_only=False, learner_only=False, model_config=DefaultModelConfig(fcnet_hiddens=[60, 90], fcnet_activation='tanh', fcnet_kernel_initializer=None, fcnet_kernel_initializer_kwargs=None, fcnet_bias_initializer=None, fcnet_bias_initializer_kwargs=None, conv_filters=None, conv_activation='relu', conv_kernel_initializer=None, conv_kernel_initializer_kwargs=None, conv_bias_initializer=None, conv_bias_initializer_kwargs=None, head_fcnet_hiddens=[], head_fcnet_activation='relu', head_fcnet_kernel_initializer=None, head_fcnet_kernel_initializer_kwargs=None, head_fcnet_bias_initializer=None, head_fcnet_bias_initializer_kwargs=None, free_log_std=False, log_std_clip_param=20.0, vf_share_layers=True, use_lstm=False, max_seq_len=20, lstm_cell_size=256, lstm_use_prev_action=False, lstm_use_prev_reward=False, lstm_kernel_initializer=None, lstm_kernel_initializer_kwargs=None, lstm_bias_initializer=None, lstm_bias_initializer_kwargs=None), catalog_class=None, load_state_path=None, model_config_dict=None)", "algorithm_config_overrides_per_module": {}, "_per_module_overrides": {}, "_validate_config": true, "_use_msgpack_checkpoints": false, "_torch_grad_scaler_class": null, "_torch_lr_scheduler_classes": null, "_tf_policy_handles_more_than_one_loss": false, "_disable_preprocessor_api": false, "_disable_action_flattening": false, "_disable_initialize_loss_from_dummy_batch": false, "_dont_auto_sync_env_runner_states": false, "env_task_fn": -1, "enable_connectors": -1, "simple_optimizer": false, "policy_map_cache": -1, "worker_cls": -1, "synchronize_filters": -1, "enable_async_evaluation": -1, "custom_async_evaluation_function": -1, "_enable_rl_module_api": -1, "auto_wrap_old_gym_envs": -1, "always_attach_evaluation_results": -1, "replay_sequence_length": null, "_disable_execution_plan_api": -1, "use_critic": true, "use_gae": true, "use_kl_loss": true, "kl_coeff": 0.7464963036515, "kl_target": 0.0270990929592, "vf_loss_coeff": 0.6688075857018, "entropy_coeff": 0.0090570820258, "clip_param": 0.1221781641624, "vf_clip_param": 0.1027808522125, "entropy_coeff_schedule": null, "lr_schedule": null, "sgd_minibatch_size": -1, "vf_share_layers": -1, "__stdout_file__": null, "__stderr_file__": null, "lambda": 0.9099046732075, "input": "sampler", "policies": {"default_policy": [null, null, null, null]}, "callbacks": "<class 'ray.rllib.callbacks.callbacks.RLlibCallback'>", "create_env_on_driver": false, "custom_eval_function": null, "framework": "torch"}, "time_since_restore": 25.817341804504395, "iterations_since_restore": 4, "perf": {"cpu_util_percent": 91.61111111111111, "ram_util_percent": 79.87777777777778}}
{"timers": {"training_iteration": 6.8121850441088165, "restore_env_runners": 4.6061079974621535e-05, "training_step": 6.811654007190958, "env_runner_sampling_timer": 6.489846843044287, "learner_update_timer": 0.3129088425525829, "synch_weights": 0.0018559109464574824, "restore_eval_env_runners": 1.4008585042087362e-05, "evaluation_iteration": 0.3652017484549508, "synch_eval_env_connectors": 0.0005219773908591595, "synch_env_connectors": 1.890784171654377e-05}, "env_runners": {"module_to_env_connector": {"timers": {"connectors": {"remove_single_ts_time_rank_from_batch": 2.1498692632249194e-06, "listify_data_for_vector_env": 6.871139211298662e-05, "get_actions": 0.00025481371507992507, "normalize_and_clip_actions": 5.048025229495317e-05, "tensor_to_numpy": 7.013659037609485e-05, "un_batch_to_individual_items": 2.0963563139902388e-05}}, "connector_pipeline_timer": 0.0005596753573182904}, "env_step_timer": 7.858765081418976e-05, "env_to_module_connector": {"timers": {"connectors": {"numpy_to_tensor": 4.4123133825597865e-05, "add_time_dim_to_batch_and_zero_pad": 7.521381659263154e-06, "add_observations_from_episodes_to_batch": 1.1247687158851653e-05, "batch_individual_items": 2.3495822950355134e-05, "add_states_from_episodes_to_batch": 5.774031933794954e-06}}, "connector_pipeline_timer": 0.00016472749418580272}, "num_episodes_lifetime": -92125.0, "time_between_sampling": 0.005662874913073727, "num_agent_steps_sampled_lifetime": {"default_agent": -1842500.0}, "rlmodule_inference_timer": 0.0002898211835108844, "episode_return_mean": -2.6200000000000006, "episode_len_mean": 20.0, "env_reset_timer": 0.0001472834279274528, "num_agent_steps_sampled": {"default_agent": 5000.0}, "num_env_steps_sampled_lifetime": -1842500.0, "episode_return_max": 6.5, "num_episodes": 250.0, "env_to_module_sum_episodes_length_in": 10.36823839457432, "module_episode_returns_mean": {"default_policy": -2.6200000000000006}, "agent_episode_returns_mean": {"default_agent": -2.6200000000000006}, "num_module_steps_sampled": {"default_policy": 5000.0}, "num_env_steps_sampled": 5000.0, "episode_duration_sec_mean": 0.025284730478189896, "episode_len_min": 20, "sample": 0.022948456442535858, "episode_return_min": -13.5, "weights_seq_no": 4.0, "env_to_module_sum_episodes_length_out": 10.36823839457432, "num_module_steps_sampled_lifetime": {"default_policy": -1842500.0}, "episode_len_max": 20, "num_env_steps_sampled_lifetime_throughput": 1660.5711409873172}, "learners": {"default_policy": {"num_module_steps_trained": 6000, "num_module_steps_trained_lifetime": 30000, "curr_entropy_coeff": 0.0090570820258, "policy_loss": -0.08939778804779053, "total_loss": -0.028190553188323975, "weights_seq_no": 5.0, "default_optimizer_learning_rate": 0.0002847858517, "vf_loss_unclipped": 28.310836791992188, "entropy": 0.6418144702911377, "gradients_default_optimizer_global_norm": 0.3873364329338074, "num_trainable_parameters": 6003, "mean_kl_loss": 0.006403516978025436, "module_train_batch_size_mean": 1000.0, "vf_loss": 0.09976178407669067, "diff_num_grad_updates_vs_sampler_policy": 1.0, "vf_explained_var": -0.012333512306213379, "curr_kl_coeff": 0.023328009992837906, "num_module_steps_trained_lifetime_throughput": 326755.3684081434}, "__all_modules__": {"learner_connector": {"timers": {"connectors": {"add_columns_from_episodes_to_train_batch": 0.11020218255208762, "add_time_dim_to_batch_and_zero_pad": 1.6269670404285426e-05, "batch_individual_items": 0.05109157205232658, "add_states_from_episodes_to_batch": 4.485294895237311e-06, "numpy_to_tensor": 8.8935121355803e-05, "add_one_ts_to_episodes_and_truncate": 0.023746331206886462, "general_advantage_estimation": 0.009024584489625552, "add_observations_from_episodes_to_batch": 0.0010258885971419919}}, "connector_pipeline_timer": 0.19565978936683756}, "num_trainable_parameters": 6003, "learner_connector_sum_episodes_length_in": 5000.0, "learner_connector_sum_episodes_length_out": 5250.0, "num_env_steps_trained": 31500, "num_module_steps_trained": 6000, "num_module_steps_trained_lifetime": 30000, "num_non_trainable_parameters": 0, "num_env_steps_trained_lifetime": 157500, "num_env_steps_trained_lifetime_throughput": 1700207.3362166104, "num_module_steps_trained_throughput": 325848.4108196268, "num_module_steps_trained_lifetime_throughput": 325139.9925062927}}, "num_training_step_calls_per_iteration": 1, "evaluation": {"env_runners": {"env_step_timer": 0.00019940344572216823, "num_episodes_lifetime": 100, "env_reset_timer": 0.0009228446451205085, "num_env_steps_sampled_lifetime": 25400, "env_to_module_connector": {"timers": {"connectors": {"add_observations_from_episodes_to_batch": 2.0813993371878806e-05, "add_states_from_episodes_to_batch": 6.032992456079015e-06, "numpy_to_tensor": 7.884153805638779e-05, "batch_individual_items": 3.379470578326154e-05, "add_time_dim_to_batch_and_zero_pad": 1.658823487378026e-05}}, "connector_pipeline_timer": 0.0002988795406393615}, "num_agent_steps_sampled": {"default_agent": 400}, "episode_len_min": 20, "sample": 0.3457093929322791, "module_to_env_connector": {"timers": {"connectors": {"get_actions": 0.0010371180288131375, "un_batch_to_individual_items": 2.9965692951075344e-05, "remove_single_ts_time_rank_from_batch": 1.4743809258928257e-05, "listify_data_for_vector_env": 7.995742334456999e-05, "tensor_to_numpy": 0.00013185071163618299, "normalize_and_clip_actions": 9.850598936521275e-05}}, "connector_pipeline_timer": 0.0016922754887343334}, "episode_return_min": -13.5, "env_to_module_sum_episodes_length_out": 10.368238387501162, "rlmodule_inference_timer": 0.0004330549717012982, "num_agent_steps_sampled_lifetime": {"default_agent": 2000}, "episode_duration_sec_mean": 0.029976122910156847, "module_episode_returns_mean": {"default_policy": 0.6}, "agent_episode_returns_mean": {"default_agent": 0.6}, "num_module_steps_sampled": {"default_policy": 400}, "episode_return_max": 13.5, "num_episodes": 20, "env_to_module_sum_episodes_length_in": 10.368238387501162, "num_env_steps_sampled": 400, "weights_seq_no": 5.0, "episode_return_mean": 0.6, "episode_len_mean": 20.0, "num_module_steps_sampled_lifetime": {"default_policy": 2000}, "episode_len_max": 20, "time_between_sampling": 6.098782607984875}, "num_healthy_workers": 1, "actor_manager_num_outstanding_async_reqs": 0, "num_remote_worker_restarts": 0}, "num_env_steps_sampled_lifetime": -1842500.0, "fault_tolerance": {"num_healthy_workers": 0, "num_remote_worker_restarts": 0}, "env_runner_group": {"actor_manager_num_outstanding_async_reqs": 0}, "done": false, "training_iteration": 5, "trial_id": "4995b_00000", "date": "2025-08-11_19-25-52", "timestamp": 1754933152, "time_this_iter_s": 8.718658208847046, "time_total_s": 34.53600001335144, "pid": 14987, "hostname": "Mac", "node_ip": "127.0.0.1", "config": {"exploration_config": {}, "extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "placement_strategy": "PACK", "num_gpus": 0, "_fake_gpus": false, "num_cpus_for_main_process": 2, "eager_tracing": true, "eager_max_retraces": 20, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "torch_compile_learner": false, "torch_compile_learner_what_to_compile": "forward_train", "torch_compile_learner_dynamo_backend": "aot_eager", "torch_compile_learner_dynamo_mode": null, "torch_compile_worker": false, "torch_compile_worker_dynamo_backend": "aot_eager", "torch_compile_worker_dynamo_mode": null, "torch_ddp_kwargs": {}, "torch_skip_nan_gradients": false, "env": "Umbrella", "env_config": {}, "observation_space": null, "action_space": null, "clip_rewards": null, "normalize_actions": true, "clip_actions": false, "_is_atari": null, "disable_env_checking": false, "render_env": false, "action_mask_key": "action_mask", "env_runner_cls": null, "num_env_runners": 0, "create_local_env_runner": true, "num_envs_per_env_runner": 1, "gym_env_vectorize_mode": "SYNC", "num_cpus_per_env_runner": 1, "num_gpus_per_env_runner": 0, "custom_resources_per_env_runner": {}, "validate_env_runners_after_construction": true, "episodes_to_numpy": true, "max_requests_in_flight_per_env_runner": 1, "sample_timeout_s": 60.0, "_env_to_module_connector": null, "add_default_connectors_to_env_to_module_pipeline": true, "_module_to_env_connector": null, "add_default_connectors_to_module_to_env_pipeline": true, "merge_env_runner_states": "training_only", "broadcast_env_runner_states": true, "episode_lookback_horizon": 1, "rollout_fragment_length": "auto", "batch_mode": "complete_episodes", "compress_observations": false, "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "enable_tf1_exec_eagerly": false, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "preprocessor_pref": "deepmind", "observation_filter": "NoFilter", "update_worker_filter_stats": true, "use_worker_filter_stats": true, "sampler_perf_stats_ema_coef": null, "_is_online": true, "num_learners": 0, "num_gpus_per_learner": 0, "num_cpus_per_learner": "auto", "num_aggregator_actors_per_learner": 0, "max_requests_in_flight_per_aggregator_actor": 3, "local_gpu_idx": 0, "max_requests_in_flight_per_learner": 3, "gamma": 1, "lr": 0.0002847858517, "grad_clip": 0.5, "grad_clip_by": "global_norm", "_train_batch_size_per_learner": 5000, "train_batch_size": 4000, "num_epochs": 1, "minibatch_size": 1000, "shuffle_batch_per_epoch": true, "model": {"fcnet_hiddens": [256, 256], "fcnet_activation": "tanh", "fcnet_weights_initializer": null, "fcnet_weights_initializer_config": null, "fcnet_bias_initializer": null, "fcnet_bias_initializer_config": null, "conv_filters": null, "conv_activation": "relu", "conv_kernel_initializer": null, "conv_kernel_initializer_config": null, "conv_bias_initializer": null, "conv_bias_initializer_config": null, "conv_transpose_kernel_initializer": null, "conv_transpose_kernel_initializer_config": null, "conv_transpose_bias_initializer": null, "conv_transpose_bias_initializer_config": null, "post_fcnet_hiddens": [], "post_fcnet_activation": "relu", "post_fcnet_weights_initializer": null, "post_fcnet_weights_initializer_config": null, "post_fcnet_bias_initializer": null, "post_fcnet_bias_initializer_config": null, "free_log_std": false, "log_std_clip_param": 20.0, "no_final_linear": false, "vf_share_layers": false, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "lstm_weights_initializer": null, "lstm_weights_initializer_config": null, "lstm_bias_initializer": null, "lstm_bias_initializer_config": null, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "attention_use_n_prev_actions": 0, "attention_use_n_prev_rewards": 0, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": null, "custom_model_config": {}, "custom_action_dist": null, "custom_preprocessor": null, "encoder_latent_dim": null, "always_check_shapes": false, "lstm_use_prev_action_reward": -1, "_use_default_native_models": -1, "_disable_preprocessor_api": false, "_disable_action_flattening": false}, "_learner_connector": null, "add_default_connectors_to_learner_pipeline": true, "learner_config_dict": {}, "optimizer": {}, "_learner_class": null, "callbacks_on_algorithm_init": null, "callbacks_on_env_runners_recreated": null, "callbacks_on_offline_eval_runners_recreated": null, "callbacks_on_checkpoint_loaded": null, "callbacks_on_environment_created": null, "callbacks_on_episode_created": null, "callbacks_on_episode_start": null, "callbacks_on_episode_step": null, "callbacks_on_episode_end": null, "callbacks_on_evaluate_start": null, "callbacks_on_evaluate_end": null, "callbacks_on_evaluate_offline_start": null, "callbacks_on_evaluate_offline_end": null, "callbacks_on_sample_end": null, "callbacks_on_train_result": null, "explore": true, "enable_rl_module_and_learner": true, "enable_env_runner_and_connector_v2": true, "_prior_exploration_config": {"type": "StochasticSampling"}, "count_steps_by": "env_steps", "policy_map_capacity": 100, "policy_mapping_fn": "<function AlgorithmConfig.DEFAULT_POLICY_MAPPING_FN at 0x3867f18a0>", "policies_to_train": null, "policy_states_are_swappable": false, "observation_fn": null, "offline_data_class": null, "input_read_method": "read_parquet", "input_read_method_kwargs": {}, "input_read_schema": {}, "input_read_episodes": false, "input_read_sample_batches": false, "input_read_batch_size": null, "input_filesystem": null, "input_filesystem_kwargs": {}, "input_compress_columns": ["obs", "new_obs"], "input_spaces_jsonable": true, "materialize_data": false, "materialize_mapped_data": true, "map_batches_kwargs": {}, "iter_batches_kwargs": {}, "ignore_final_observation": false, "prelearner_class": null, "prelearner_buffer_class": null, "prelearner_buffer_kwargs": {}, "prelearner_module_synch_period": 10, "dataset_num_iters_per_learner": null, "input_config": {}, "actions_in_input_normalized": false, "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_config": {}, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "output_max_rows_per_file": null, "output_write_remaining_data": false, "output_write_method": "write_parquet", "output_write_method_kwargs": {}, "output_filesystem": null, "output_filesystem_kwargs": {}, "output_write_episodes": true, "offline_sampling": false, "evaluation_interval": 1, "evaluation_duration": 20, "evaluation_duration_unit": "episodes", "evaluation_sample_timeout_s": 120.0, "evaluation_auto_duration_min_env_steps_per_sample": 100, "evaluation_auto_duration_max_env_steps_per_sample": 2000, "evaluation_parallel_to_training": false, "evaluation_force_reset_envs_before_iteration": true, "evaluation_config": null, "off_policy_estimation_methods": {}, "ope_split_batch_by_episode": true, "evaluation_num_env_runners": 1, "in_evaluation": false, "sync_filters_on_rollout_workers_timeout_s": 10.0, "offline_evaluation_interval": null, "num_offline_eval_runners": 0, "offline_loss_for_module_fn": null, "offline_evaluation_duration": 1, "offline_evaluation_parallel_to_training": false, "offline_evaluation_timeout_s": 120.0, "num_cpus_per_offline_eval_runner": 1, "num_gpus_per_offline_eval_runner": 0, "custom_resources_per_offline_eval_runner": {}, "restart_failed_offline_eval_runners": true, "ignore_offline_eval_runner_failures": false, "max_num_offline_eval_runner_restarts": 1000, "offline_eval_runner_restore_timeout_s": 1800.0, "max_requests_in_flight_per_offline_eval_runner": 1, "validate_offline_eval_runners_after_construction": true, "offline_eval_runner_health_probe_timeout_s": 30.0, "offline_eval_rl_module_inference_only": false, "broadcast_offline_eval_runner_states": false, "offline_eval_batch_size_per_runner": 256, "dataset_num_iters_per_eval_runner": 1, "keep_per_episode_custom_metrics": false, "metrics_episode_collection_timeout_s": 60.0, "metrics_num_episodes_for_smoothing": 100, "min_time_s_per_iteration": null, "min_train_timesteps_per_iteration": 0, "min_sample_timesteps_per_iteration": 0, "log_gradients": true, "export_native_model_files": false, "checkpoint_trainable_policies_only": false, "logger_creator": null, "logger_config": null, "log_level": "WARN", "log_sys_usage": true, "fake_sampler": false, "seed": 3, "restart_failed_env_runners": true, "ignore_env_runner_failures": false, "max_num_env_runner_restarts": 1000, "delay_between_env_runner_restarts_s": 60.0, "restart_failed_sub_environments": false, "num_consecutive_env_runner_failures_tolerance": 100, "env_runner_health_probe_timeout_s": 30.0, "env_runner_restore_timeout_s": 1800.0, "_model_config": {}, "_rl_module_spec": "RLModuleSpec(module_class=None, observation_space=None, action_space=None, inference_only=False, learner_only=False, model_config=DefaultModelConfig(fcnet_hiddens=[60, 90], fcnet_activation='tanh', fcnet_kernel_initializer=None, fcnet_kernel_initializer_kwargs=None, fcnet_bias_initializer=None, fcnet_bias_initializer_kwargs=None, conv_filters=None, conv_activation='relu', conv_kernel_initializer=None, conv_kernel_initializer_kwargs=None, conv_bias_initializer=None, conv_bias_initializer_kwargs=None, head_fcnet_hiddens=[], head_fcnet_activation='relu', head_fcnet_kernel_initializer=None, head_fcnet_kernel_initializer_kwargs=None, head_fcnet_bias_initializer=None, head_fcnet_bias_initializer_kwargs=None, free_log_std=False, log_std_clip_param=20.0, vf_share_layers=True, use_lstm=False, max_seq_len=20, lstm_cell_size=256, lstm_use_prev_action=False, lstm_use_prev_reward=False, lstm_kernel_initializer=None, lstm_kernel_initializer_kwargs=None, lstm_bias_initializer=None, lstm_bias_initializer_kwargs=None), catalog_class=None, load_state_path=None, model_config_dict=None)", "algorithm_config_overrides_per_module": {}, "_per_module_overrides": {}, "_validate_config": true, "_use_msgpack_checkpoints": false, "_torch_grad_scaler_class": null, "_torch_lr_scheduler_classes": null, "_tf_policy_handles_more_than_one_loss": false, "_disable_preprocessor_api": false, "_disable_action_flattening": false, "_disable_initialize_loss_from_dummy_batch": false, "_dont_auto_sync_env_runner_states": false, "env_task_fn": -1, "enable_connectors": -1, "simple_optimizer": false, "policy_map_cache": -1, "worker_cls": -1, "synchronize_filters": -1, "enable_async_evaluation": -1, "custom_async_evaluation_function": -1, "_enable_rl_module_api": -1, "auto_wrap_old_gym_envs": -1, "always_attach_evaluation_results": -1, "replay_sequence_length": null, "_disable_execution_plan_api": -1, "use_critic": true, "use_gae": true, "use_kl_loss": true, "kl_coeff": 0.7464963036515, "kl_target": 0.0270990929592, "vf_loss_coeff": 0.6688075857018, "entropy_coeff": 0.0090570820258, "clip_param": 0.1221781641624, "vf_clip_param": 0.1027808522125, "entropy_coeff_schedule": null, "lr_schedule": null, "sgd_minibatch_size": -1, "vf_share_layers": -1, "__stdout_file__": null, "__stderr_file__": null, "lambda": 0.9099046732075, "input": "sampler", "policies": {"default_policy": [null, null, null, null]}, "callbacks": "<class 'ray.rllib.callbacks.callbacks.RLlibCallback'>", "create_env_on_driver": false, "custom_eval_function": null, "framework": "torch"}, "time_since_restore": 34.53600001335144, "iterations_since_restore": 5, "perf": {"cpu_util_percent": 94.875, "ram_util_percent": 80.90833333333333}}
{"timers": {"training_iteration": 6.846759552417837, "restore_env_runners": 4.571505910445601e-05, "training_step": 6.846229665448654, "env_runner_sampling_timer": 6.519321735864462, "learner_update_timer": 0.3179970937172489, "synch_weights": 0.001893413507177043, "restore_eval_env_runners": 1.4077659107933287e-05, "evaluation_iteration": 0.3747044718010518, "synch_eval_env_connectors": 0.0005224805371280722, "synch_env_connectors": 1.9097933823334747e-05}, "env_runners": {"module_to_env_connector": {"timers": {"connectors": {"remove_single_ts_time_rank_from_batch": 2.5965350406536364e-06, "listify_data_for_vector_env": 9.090591815319252e-05, "get_actions": 0.00040100623584053696, "normalize_and_clip_actions": 4.476672191642358e-05, "tensor_to_numpy": 9.948402032027191e-05, "un_batch_to_individual_items": 2.5533387833232778e-05}}, "connector_pipeline_timer": 0.0007884832402207152}, "env_step_timer": 0.00010183258259328103, "env_to_module_connector": {"timers": {"connectors": {"numpy_to_tensor": 6.141054206151927e-05, "add_time_dim_to_batch_and_zero_pad": 1.025935883008975e-05, "add_observations_from_episodes_to_batch": 1.6468459720817294e-05, "batch_individual_items": 4.484368685172251e-05, "add_states_from_episodes_to_batch": 5.979045332989959e-06}}, "connector_pipeline_timer": 0.0002464512655085872}, "num_episodes_lifetime": -123000.0, "time_between_sampling": 0.009786174925840762, "num_agent_steps_sampled_lifetime": {"default_agent": -2460000.0}, "rlmodule_inference_timer": 0.0002234045158730451, "episode_return_mean": 0.26, "episode_len_mean": 20.0, "env_reset_timer": 0.00019425787996672883, "num_agent_steps_sampled": {"default_agent": 5000.0}, "num_env_steps_sampled_lifetime": -2460000.0, "episode_return_max": 6.5, "num_episodes": 250.0, "env_to_module_sum_episodes_length_in": 10.36823839457432, "module_episode_returns_mean": {"default_policy": 0.26}, "agent_episode_returns_mean": {"default_agent": 0.26}, "num_module_steps_sampled": {"default_policy": 5000.0}, "num_env_steps_sampled": 5000.0, "episode_duration_sec_mean": 0.031724478683900104, "episode_len_min": 20, "sample": 0.03090745953370741, "episode_return_min": -13.5, "weights_seq_no": 5.0, "env_to_module_sum_episodes_length_out": 10.36823839457432, "num_module_steps_sampled_lifetime": {"default_policy": -2460000.0}, "episode_len_max": 20, "num_env_steps_sampled_lifetime_throughput": 1259.374287056849}, "learners": {"default_policy": {"num_module_steps_trained": 6000, "num_module_steps_trained_lifetime": 36000, "curr_entropy_coeff": 0.0090570820258, "policy_loss": -0.07772266864776611, "total_loss": -0.017150528728961945, "weights_seq_no": 6.0, "default_optimizer_learning_rate": 0.0002847858517, "vf_loss_unclipped": 26.507795333862305, "entropy": 0.6319625973701477, "gradients_default_optimizer_global_norm": 0.12068164348602295, "num_trainable_parameters": 6003, "mean_kl_loss": 0.00032041617669165134, "module_train_batch_size_mean": 1000.0, "vf_loss": 0.0991143062710762, "diff_num_grad_updates_vs_sampler_policy": 1.0, "vf_explained_var": -0.010851740837097168, "curr_kl_coeff": 0.011664004996418953, "num_module_steps_trained_lifetime_throughput": 318594.5608060256}, "__all_modules__": {"learner_connector": {"timers": {"connectors": {"add_columns_from_episodes_to_train_batch": 0.11040003322622453, "add_time_dim_to_batch_and_zero_pad": 1.667197334581845e-05, "batch_individual_items": 0.05586528050138395, "add_states_from_episodes_to_batch": 4.577112369956541e-06, "numpy_to_tensor": 8.941035096349088e-05, "add_one_ts_to_episodes_and_truncate": 0.023710684564250045, "general_advantage_estimation": 0.009197594055556993, "add_observations_from_episodes_to_batch": 0.001117750131367597}}, "connector_pipeline_timer": 0.2008594448126591}, "num_trainable_parameters": 6003, "learner_connector_sum_episodes_length_in": 5000.0, "learner_connector_sum_episodes_length_out": 5250.0, "num_env_steps_trained": 31500, "num_module_steps_trained": 6000, "num_module_steps_trained_lifetime": 36000, "num_non_trainable_parameters": 0, "num_env_steps_trained_lifetime": 189000, "num_env_steps_trained_lifetime_throughput": 1657765.406018315, "num_module_steps_trained_throughput": 317720.7247371571, "num_module_steps_trained_lifetime_throughput": 317031.99003650754}}, "num_training_step_calls_per_iteration": 1, "evaluation": {"env_runners": {"env_step_timer": 5.396615362828005e-05, "num_episodes_lifetime": 120, "env_reset_timer": 0.0009297374483152518, "num_env_steps_sampled_lifetime": 30400, "env_to_module_connector": {"timers": {"connectors": {"add_observations_from_episodes_to_batch": 1.0412480940666034e-05, "add_states_from_episodes_to_batch": 3.2087080160717697e-06, "numpy_to_tensor": 4.7163831635419725e-05, "batch_individual_items": 3.406780628302133e-05, "add_time_dim_to_batch_and_zero_pad": 9.062715735965422e-06}}, "connector_pipeline_timer": 0.0002383560897429616}, "num_agent_steps_sampled": {"default_agent": 400}, "episode_len_min": 20, "sample": 0.348332483583016, "module_to_env_connector": {"timers": {"connectors": {"get_actions": 0.0003063395249026757, "un_batch_to_individual_items": 1.4587198973514981e-05, "remove_single_ts_time_rank_from_batch": 1.728733926900371e-06, "listify_data_for_vector_env": 4.3971118148388476e-05, "tensor_to_numpy": 5.767036025344931e-05, "normalize_and_clip_actions": 2.9469290910881358e-05}}, "connector_pipeline_timer": 0.0005258956765287158}, "episode_return_min": -13.5, "env_to_module_sum_episodes_length_out": 10.368238394470474, "rlmodule_inference_timer": 0.00012486477949563292, "num_agent_steps_sampled_lifetime": {"default_agent": 2400}, "episode_duration_sec_mean": 0.032584860797505825, "module_episode_returns_mean": {"default_policy": 0.8}, "agent_episode_returns_mean": {"default_agent": 0.8}, "num_module_steps_sampled": {"default_policy": 400}, "episode_return_max": 13.5, "num_episodes": 20, "env_to_module_sum_episodes_length_in": 10.368238394470474, "num_env_steps_sampled": 400, "weights_seq_no": 6.0, "episode_return_mean": 0.8, "episode_len_mean": 20.0, "num_module_steps_sampled_lifetime": {"default_policy": 2400}, "episode_len_max": 20, "time_between_sampling": 6.1413125185648765}, "num_healthy_workers": 1, "actor_manager_num_outstanding_async_reqs": 0, "num_remote_worker_restarts": 0}, "num_env_steps_sampled_lifetime": -2460000.0, "fault_tolerance": {"num_healthy_workers": 0, "num_remote_worker_restarts": 0}, "env_runner_group": {"actor_manager_num_outstanding_async_reqs": 0}, "done": false, "training_iteration": 6, "trial_id": "4995b_00000", "date": "2025-08-11_19-26-03", "timestamp": 1754933163, "time_this_iter_s": 10.902854919433594, "time_total_s": 45.438854932785034, "pid": 14987, "hostname": "Mac", "node_ip": "127.0.0.1", "config": {"exploration_config": {}, "extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "placement_strategy": "PACK", "num_gpus": 0, "_fake_gpus": false, "num_cpus_for_main_process": 2, "eager_tracing": true, "eager_max_retraces": 20, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "torch_compile_learner": false, "torch_compile_learner_what_to_compile": "forward_train", "torch_compile_learner_dynamo_backend": "aot_eager", "torch_compile_learner_dynamo_mode": null, "torch_compile_worker": false, "torch_compile_worker_dynamo_backend": "aot_eager", "torch_compile_worker_dynamo_mode": null, "torch_ddp_kwargs": {}, "torch_skip_nan_gradients": false, "env": "Umbrella", "env_config": {}, "observation_space": null, "action_space": null, "clip_rewards": null, "normalize_actions": true, "clip_actions": false, "_is_atari": null, "disable_env_checking": false, "render_env": false, "action_mask_key": "action_mask", "env_runner_cls": null, "num_env_runners": 0, "create_local_env_runner": true, "num_envs_per_env_runner": 1, "gym_env_vectorize_mode": "SYNC", "num_cpus_per_env_runner": 1, "num_gpus_per_env_runner": 0, "custom_resources_per_env_runner": {}, "validate_env_runners_after_construction": true, "episodes_to_numpy": true, "max_requests_in_flight_per_env_runner": 1, "sample_timeout_s": 60.0, "_env_to_module_connector": null, "add_default_connectors_to_env_to_module_pipeline": true, "_module_to_env_connector": null, "add_default_connectors_to_module_to_env_pipeline": true, "merge_env_runner_states": "training_only", "broadcast_env_runner_states": true, "episode_lookback_horizon": 1, "rollout_fragment_length": "auto", "batch_mode": "complete_episodes", "compress_observations": false, "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "enable_tf1_exec_eagerly": false, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "preprocessor_pref": "deepmind", "observation_filter": "NoFilter", "update_worker_filter_stats": true, "use_worker_filter_stats": true, "sampler_perf_stats_ema_coef": null, "_is_online": true, "num_learners": 0, "num_gpus_per_learner": 0, "num_cpus_per_learner": "auto", "num_aggregator_actors_per_learner": 0, "max_requests_in_flight_per_aggregator_actor": 3, "local_gpu_idx": 0, "max_requests_in_flight_per_learner": 3, "gamma": 1, "lr": 0.0002847858517, "grad_clip": 0.5, "grad_clip_by": "global_norm", "_train_batch_size_per_learner": 5000, "train_batch_size": 4000, "num_epochs": 1, "minibatch_size": 1000, "shuffle_batch_per_epoch": true, "model": {"fcnet_hiddens": [256, 256], "fcnet_activation": "tanh", "fcnet_weights_initializer": null, "fcnet_weights_initializer_config": null, "fcnet_bias_initializer": null, "fcnet_bias_initializer_config": null, "conv_filters": null, "conv_activation": "relu", "conv_kernel_initializer": null, "conv_kernel_initializer_config": null, "conv_bias_initializer": null, "conv_bias_initializer_config": null, "conv_transpose_kernel_initializer": null, "conv_transpose_kernel_initializer_config": null, "conv_transpose_bias_initializer": null, "conv_transpose_bias_initializer_config": null, "post_fcnet_hiddens": [], "post_fcnet_activation": "relu", "post_fcnet_weights_initializer": null, "post_fcnet_weights_initializer_config": null, "post_fcnet_bias_initializer": null, "post_fcnet_bias_initializer_config": null, "free_log_std": false, "log_std_clip_param": 20.0, "no_final_linear": false, "vf_share_layers": false, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "lstm_weights_initializer": null, "lstm_weights_initializer_config": null, "lstm_bias_initializer": null, "lstm_bias_initializer_config": null, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "attention_use_n_prev_actions": 0, "attention_use_n_prev_rewards": 0, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": null, "custom_model_config": {}, "custom_action_dist": null, "custom_preprocessor": null, "encoder_latent_dim": null, "always_check_shapes": false, "lstm_use_prev_action_reward": -1, "_use_default_native_models": -1, "_disable_preprocessor_api": false, "_disable_action_flattening": false}, "_learner_connector": null, "add_default_connectors_to_learner_pipeline": true, "learner_config_dict": {}, "optimizer": {}, "_learner_class": null, "callbacks_on_algorithm_init": null, "callbacks_on_env_runners_recreated": null, "callbacks_on_offline_eval_runners_recreated": null, "callbacks_on_checkpoint_loaded": null, "callbacks_on_environment_created": null, "callbacks_on_episode_created": null, "callbacks_on_episode_start": null, "callbacks_on_episode_step": null, "callbacks_on_episode_end": null, "callbacks_on_evaluate_start": null, "callbacks_on_evaluate_end": null, "callbacks_on_evaluate_offline_start": null, "callbacks_on_evaluate_offline_end": null, "callbacks_on_sample_end": null, "callbacks_on_train_result": null, "explore": true, "enable_rl_module_and_learner": true, "enable_env_runner_and_connector_v2": true, "_prior_exploration_config": {"type": "StochasticSampling"}, "count_steps_by": "env_steps", "policy_map_capacity": 100, "policy_mapping_fn": "<function AlgorithmConfig.DEFAULT_POLICY_MAPPING_FN at 0x3867f18a0>", "policies_to_train": null, "policy_states_are_swappable": false, "observation_fn": null, "offline_data_class": null, "input_read_method": "read_parquet", "input_read_method_kwargs": {}, "input_read_schema": {}, "input_read_episodes": false, "input_read_sample_batches": false, "input_read_batch_size": null, "input_filesystem": null, "input_filesystem_kwargs": {}, "input_compress_columns": ["obs", "new_obs"], "input_spaces_jsonable": true, "materialize_data": false, "materialize_mapped_data": true, "map_batches_kwargs": {}, "iter_batches_kwargs": {}, "ignore_final_observation": false, "prelearner_class": null, "prelearner_buffer_class": null, "prelearner_buffer_kwargs": {}, "prelearner_module_synch_period": 10, "dataset_num_iters_per_learner": null, "input_config": {}, "actions_in_input_normalized": false, "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_config": {}, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "output_max_rows_per_file": null, "output_write_remaining_data": false, "output_write_method": "write_parquet", "output_write_method_kwargs": {}, "output_filesystem": null, "output_filesystem_kwargs": {}, "output_write_episodes": true, "offline_sampling": false, "evaluation_interval": 1, "evaluation_duration": 20, "evaluation_duration_unit": "episodes", "evaluation_sample_timeout_s": 120.0, "evaluation_auto_duration_min_env_steps_per_sample": 100, "evaluation_auto_duration_max_env_steps_per_sample": 2000, "evaluation_parallel_to_training": false, "evaluation_force_reset_envs_before_iteration": true, "evaluation_config": null, "off_policy_estimation_methods": {}, "ope_split_batch_by_episode": true, "evaluation_num_env_runners": 1, "in_evaluation": false, "sync_filters_on_rollout_workers_timeout_s": 10.0, "offline_evaluation_interval": null, "num_offline_eval_runners": 0, "offline_loss_for_module_fn": null, "offline_evaluation_duration": 1, "offline_evaluation_parallel_to_training": false, "offline_evaluation_timeout_s": 120.0, "num_cpus_per_offline_eval_runner": 1, "num_gpus_per_offline_eval_runner": 0, "custom_resources_per_offline_eval_runner": {}, "restart_failed_offline_eval_runners": true, "ignore_offline_eval_runner_failures": false, "max_num_offline_eval_runner_restarts": 1000, "offline_eval_runner_restore_timeout_s": 1800.0, "max_requests_in_flight_per_offline_eval_runner": 1, "validate_offline_eval_runners_after_construction": true, "offline_eval_runner_health_probe_timeout_s": 30.0, "offline_eval_rl_module_inference_only": false, "broadcast_offline_eval_runner_states": false, "offline_eval_batch_size_per_runner": 256, "dataset_num_iters_per_eval_runner": 1, "keep_per_episode_custom_metrics": false, "metrics_episode_collection_timeout_s": 60.0, "metrics_num_episodes_for_smoothing": 100, "min_time_s_per_iteration": null, "min_train_timesteps_per_iteration": 0, "min_sample_timesteps_per_iteration": 0, "log_gradients": true, "export_native_model_files": false, "checkpoint_trainable_policies_only": false, "logger_creator": null, "logger_config": null, "log_level": "WARN", "log_sys_usage": true, "fake_sampler": false, "seed": 3, "restart_failed_env_runners": true, "ignore_env_runner_failures": false, "max_num_env_runner_restarts": 1000, "delay_between_env_runner_restarts_s": 60.0, "restart_failed_sub_environments": false, "num_consecutive_env_runner_failures_tolerance": 100, "env_runner_health_probe_timeout_s": 30.0, "env_runner_restore_timeout_s": 1800.0, "_model_config": {}, "_rl_module_spec": "RLModuleSpec(module_class=None, observation_space=None, action_space=None, inference_only=False, learner_only=False, model_config=DefaultModelConfig(fcnet_hiddens=[60, 90], fcnet_activation='tanh', fcnet_kernel_initializer=None, fcnet_kernel_initializer_kwargs=None, fcnet_bias_initializer=None, fcnet_bias_initializer_kwargs=None, conv_filters=None, conv_activation='relu', conv_kernel_initializer=None, conv_kernel_initializer_kwargs=None, conv_bias_initializer=None, conv_bias_initializer_kwargs=None, head_fcnet_hiddens=[], head_fcnet_activation='relu', head_fcnet_kernel_initializer=None, head_fcnet_kernel_initializer_kwargs=None, head_fcnet_bias_initializer=None, head_fcnet_bias_initializer_kwargs=None, free_log_std=False, log_std_clip_param=20.0, vf_share_layers=True, use_lstm=False, max_seq_len=20, lstm_cell_size=256, lstm_use_prev_action=False, lstm_use_prev_reward=False, lstm_kernel_initializer=None, lstm_kernel_initializer_kwargs=None, lstm_bias_initializer=None, lstm_bias_initializer_kwargs=None), catalog_class=None, load_state_path=None, model_config_dict=None)", "algorithm_config_overrides_per_module": {}, "_per_module_overrides": {}, "_validate_config": true, "_use_msgpack_checkpoints": false, "_torch_grad_scaler_class": null, "_torch_lr_scheduler_classes": null, "_tf_policy_handles_more_than_one_loss": false, "_disable_preprocessor_api": false, "_disable_action_flattening": false, "_disable_initialize_loss_from_dummy_batch": false, "_dont_auto_sync_env_runner_states": false, "env_task_fn": -1, "enable_connectors": -1, "simple_optimizer": false, "policy_map_cache": -1, "worker_cls": -1, "synchronize_filters": -1, "enable_async_evaluation": -1, "custom_async_evaluation_function": -1, "_enable_rl_module_api": -1, "auto_wrap_old_gym_envs": -1, "always_attach_evaluation_results": -1, "replay_sequence_length": null, "_disable_execution_plan_api": -1, "use_critic": true, "use_gae": true, "use_kl_loss": true, "kl_coeff": 0.7464963036515, "kl_target": 0.0270990929592, "vf_loss_coeff": 0.6688075857018, "entropy_coeff": 0.0090570820258, "clip_param": 0.1221781641624, "vf_clip_param": 0.1027808522125, "entropy_coeff_schedule": null, "lr_schedule": null, "sgd_minibatch_size": -1, "vf_share_layers": -1, "__stdout_file__": null, "__stderr_file__": null, "lambda": 0.9099046732075, "input": "sampler", "policies": {"default_policy": [null, null, null, null]}, "callbacks": "<class 'ray.rllib.callbacks.callbacks.RLlibCallback'>", "create_env_on_driver": false, "custom_eval_function": null, "framework": "torch"}, "time_since_restore": 45.438854932785034, "iterations_since_restore": 6, "perf": {"cpu_util_percent": 96.73125, "ram_util_percent": 83.63125000000001}}
{"timers": {"training_iteration": 6.866518991054759, "restore_env_runners": 4.539581759610729e-05, "training_step": 6.865987495884047, "env_runner_sampling_timer": 6.5393211197558365, "learner_update_timer": 0.31775088235997706, "synch_weights": 0.0018929952022663226, "restore_eval_env_runners": 1.4068962684385921e-05, "evaluation_iteration": 0.3772512383328208, "synch_eval_env_connectors": 0.0005191482327794582, "synch_env_connectors": 1.9116124878747162e-05}, "env_runners": {"module_to_env_connector": {"timers": {"connectors": {"remove_single_ts_time_rank_from_batch": 1.8924694844872152e-06, "listify_data_for_vector_env": 8.107411615694022e-05, "get_actions": 0.0003149793668609665, "normalize_and_clip_actions": 3.993098177657022e-05, "tensor_to_numpy": 0.00010300055503068939, "un_batch_to_individual_items": 2.8471839819207902e-05}}, "connector_pipeline_timer": 0.0007604900830346593}, "env_step_timer": 9.009062651219335e-05, "env_to_module_connector": {"timers": {"connectors": {"numpy_to_tensor": 5.523934453944686e-05, "add_time_dim_to_batch_and_zero_pad": 1.486780101430358e-05, "add_observations_from_episodes_to_batch": 1.95712686759864e-05, "batch_individual_items": 3.3811367722894e-05, "add_states_from_episodes_to_batch": 6.13471924257814e-06}}, "connector_pipeline_timer": 0.00021414930829860085}, "num_episodes_lifetime": -153875.0, "time_between_sampling": 0.01012465122658503, "num_agent_steps_sampled_lifetime": {"default_agent": -3077500.0}, "rlmodule_inference_timer": 0.00016123640951145847, "episode_return_mean": 0.17999999999999997, "episode_len_mean": 20.0, "env_reset_timer": 0.00024548990863275974, "num_agent_steps_sampled": {"default_agent": 5000.0}, "num_env_steps_sampled_lifetime": -3077500.0, "episode_return_max": 6.5, "num_episodes": 250.0, "env_to_module_sum_episodes_length_in": 10.36823839457432, "module_episode_returns_mean": {"default_policy": 0.17999999999999997}, "agent_episode_returns_mean": {"default_agent": 0.17999999999999997}, "num_module_steps_sampled": {"default_policy": 5000.0}, "num_env_steps_sampled": 5000.0, "episode_duration_sec_mean": 0.028914291670545933, "episode_len_min": 20, "sample": 0.03223006288463129, "episode_return_min": -13.5, "weights_seq_no": 6.0, "env_to_module_sum_episodes_length_out": 10.36823839457432, "num_module_steps_sampled_lifetime": {"default_policy": -3077500.0}, "episode_len_max": 20, "num_env_steps_sampled_lifetime_throughput": 1193.3550339766987}, "learners": {"default_policy": {"num_module_steps_trained": 6000, "num_module_steps_trained_lifetime": 42000, "curr_entropy_coeff": 0.0090570820258, "policy_loss": 0.11239685118198395, "total_loss": 0.1733374446630478, "weights_seq_no": 7.0, "default_optimizer_learning_rate": 0.0002847858517, "vf_loss_unclipped": 27.996871948242188, "entropy": 0.6225767731666565, "gradients_default_optimizer_global_norm": 0.1225818544626236, "num_trainable_parameters": 6003, "mean_kl_loss": 0.00022236791846808046, "module_train_batch_size_mean": 1000.0, "vf_loss": 0.09954539686441422, "diff_num_grad_updates_vs_sampler_policy": 1.0, "vf_explained_var": -0.012020707130432129, "curr_kl_coeff": 0.0058320024982094765, "num_module_steps_trained_lifetime_throughput": 309647.0510493575}, "__all_modules__": {"learner_connector": {"timers": {"connectors": {"add_columns_from_episodes_to_train_batch": 0.11043890872437233, "add_time_dim_to_batch_and_zero_pad": 1.734275475080898e-05, "batch_individual_items": 0.05578282060636148, "add_states_from_episodes_to_batch": 4.70426107283905e-06, "numpy_to_tensor": 8.941041840681682e-05, "add_one_ts_to_episodes_and_truncate": 0.023602902718478275, "general_advantage_estimation": 0.00918740477501328, "add_observations_from_episodes_to_batch": 0.0011158547100448744}}, "connector_pipeline_timer": 0.20069378828454223}, "num_trainable_parameters": 6003, "learner_connector_sum_episodes_length_in": 5000.0, "learner_connector_sum_episodes_length_out": 5250.0, "num_env_steps_trained": 31500, "num_module_steps_trained": 6000, "num_module_steps_trained_lifetime": 42000, "num_non_trainable_parameters": 0, "num_env_steps_trained_lifetime": 220500, "num_env_steps_trained_lifetime_throughput": 1611246.400189528, "num_module_steps_trained_throughput": 308800.44452700234, "num_module_steps_trained_lifetime_throughput": 308133.625519306}}, "num_training_step_calls_per_iteration": 1, "evaluation": {"env_runners": {"env_step_timer": 9.454230155614322e-05, "num_episodes_lifetime": 140, "env_reset_timer": 0.0009387850738215939, "num_env_steps_sampled_lifetime": 35400, "env_to_module_connector": {"timers": {"connectors": {"add_observations_from_episodes_to_batch": 1.6486819693630935e-05, "add_states_from_episodes_to_batch": 6.502660432929069e-06, "numpy_to_tensor": 5.0064431510737705e-05, "batch_individual_items": 2.425787289318019e-05, "add_time_dim_to_batch_and_zero_pad": 1.1887160883754752e-05}}, "connector_pipeline_timer": 0.00017098375827838454}, "num_agent_steps_sampled": {"default_agent": 400}, "episode_len_min": 20, "sample": 0.3494556495773782, "module_to_env_connector": {"timers": {"connectors": {"get_actions": 0.00031387390249286684, "un_batch_to_individual_items": 1.678369676284456e-05, "remove_single_ts_time_rank_from_batch": 3.1949137526741294e-06, "listify_data_for_vector_env": 3.915032591797369e-05, "tensor_to_numpy": 0.000128041881776352, "normalize_and_clip_actions": 7.473524940378871e-05}}, "connector_pipeline_timer": 0.0007004895413054824}, "episode_return_min": -13.5, "env_to_module_sum_episodes_length_out": 10.368238394572801, "rlmodule_inference_timer": 0.00012137794633805951, "num_agent_steps_sampled_lifetime": {"default_agent": 2800}, "episode_duration_sec_mean": 0.03388847787980922, "module_episode_returns_mean": {"default_policy": 1.0}, "agent_episode_returns_mean": {"default_agent": 1.0}, "num_module_steps_sampled": {"default_policy": 400}, "episode_return_max": 13.5, "num_episodes": 20, "env_to_module_sum_episodes_length_in": 10.368238394572801, "num_env_steps_sampled": 400, "weights_seq_no": 7.0, "episode_return_mean": 1.0, "episode_len_mean": 20.0, "num_module_steps_sampled_lifetime": {"default_policy": 2800}, "episode_len_max": 20, "time_between_sampling": 6.169584224628989}, "num_healthy_workers": 1, "actor_manager_num_outstanding_async_reqs": 0, "num_remote_worker_restarts": 0}, "num_env_steps_sampled_lifetime": -3077500.0, "fault_tolerance": {"num_healthy_workers": 0, "num_remote_worker_restarts": 0}, "env_runner_group": {"actor_manager_num_outstanding_async_reqs": 0}, "done": false, "training_iteration": 7, "trial_id": "4995b_00000", "date": "2025-08-11_19-26-12", "timestamp": 1754933172, "time_this_iter_s": 9.382277965545654, "time_total_s": 54.82113289833069, "pid": 14987, "hostname": "Mac", "node_ip": "127.0.0.1", "config": {"exploration_config": {}, "extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "placement_strategy": "PACK", "num_gpus": 0, "_fake_gpus": false, "num_cpus_for_main_process": 2, "eager_tracing": true, "eager_max_retraces": 20, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "torch_compile_learner": false, "torch_compile_learner_what_to_compile": "forward_train", "torch_compile_learner_dynamo_backend": "aot_eager", "torch_compile_learner_dynamo_mode": null, "torch_compile_worker": false, "torch_compile_worker_dynamo_backend": "aot_eager", "torch_compile_worker_dynamo_mode": null, "torch_ddp_kwargs": {}, "torch_skip_nan_gradients": false, "env": "Umbrella", "env_config": {}, "observation_space": null, "action_space": null, "clip_rewards": null, "normalize_actions": true, "clip_actions": false, "_is_atari": null, "disable_env_checking": false, "render_env": false, "action_mask_key": "action_mask", "env_runner_cls": null, "num_env_runners": 0, "create_local_env_runner": true, "num_envs_per_env_runner": 1, "gym_env_vectorize_mode": "SYNC", "num_cpus_per_env_runner": 1, "num_gpus_per_env_runner": 0, "custom_resources_per_env_runner": {}, "validate_env_runners_after_construction": true, "episodes_to_numpy": true, "max_requests_in_flight_per_env_runner": 1, "sample_timeout_s": 60.0, "_env_to_module_connector": null, "add_default_connectors_to_env_to_module_pipeline": true, "_module_to_env_connector": null, "add_default_connectors_to_module_to_env_pipeline": true, "merge_env_runner_states": "training_only", "broadcast_env_runner_states": true, "episode_lookback_horizon": 1, "rollout_fragment_length": "auto", "batch_mode": "complete_episodes", "compress_observations": false, "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "enable_tf1_exec_eagerly": false, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "preprocessor_pref": "deepmind", "observation_filter": "NoFilter", "update_worker_filter_stats": true, "use_worker_filter_stats": true, "sampler_perf_stats_ema_coef": null, "_is_online": true, "num_learners": 0, "num_gpus_per_learner": 0, "num_cpus_per_learner": "auto", "num_aggregator_actors_per_learner": 0, "max_requests_in_flight_per_aggregator_actor": 3, "local_gpu_idx": 0, "max_requests_in_flight_per_learner": 3, "gamma": 1, "lr": 0.0002847858517, "grad_clip": 0.5, "grad_clip_by": "global_norm", "_train_batch_size_per_learner": 5000, "train_batch_size": 4000, "num_epochs": 1, "minibatch_size": 1000, "shuffle_batch_per_epoch": true, "model": {"fcnet_hiddens": [256, 256], "fcnet_activation": "tanh", "fcnet_weights_initializer": null, "fcnet_weights_initializer_config": null, "fcnet_bias_initializer": null, "fcnet_bias_initializer_config": null, "conv_filters": null, "conv_activation": "relu", "conv_kernel_initializer": null, "conv_kernel_initializer_config": null, "conv_bias_initializer": null, "conv_bias_initializer_config": null, "conv_transpose_kernel_initializer": null, "conv_transpose_kernel_initializer_config": null, "conv_transpose_bias_initializer": null, "conv_transpose_bias_initializer_config": null, "post_fcnet_hiddens": [], "post_fcnet_activation": "relu", "post_fcnet_weights_initializer": null, "post_fcnet_weights_initializer_config": null, "post_fcnet_bias_initializer": null, "post_fcnet_bias_initializer_config": null, "free_log_std": false, "log_std_clip_param": 20.0, "no_final_linear": false, "vf_share_layers": false, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "lstm_weights_initializer": null, "lstm_weights_initializer_config": null, "lstm_bias_initializer": null, "lstm_bias_initializer_config": null, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "attention_use_n_prev_actions": 0, "attention_use_n_prev_rewards": 0, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": null, "custom_model_config": {}, "custom_action_dist": null, "custom_preprocessor": null, "encoder_latent_dim": null, "always_check_shapes": false, "lstm_use_prev_action_reward": -1, "_use_default_native_models": -1, "_disable_preprocessor_api": false, "_disable_action_flattening": false}, "_learner_connector": null, "add_default_connectors_to_learner_pipeline": true, "learner_config_dict": {}, "optimizer": {}, "_learner_class": null, "callbacks_on_algorithm_init": null, "callbacks_on_env_runners_recreated": null, "callbacks_on_offline_eval_runners_recreated": null, "callbacks_on_checkpoint_loaded": null, "callbacks_on_environment_created": null, "callbacks_on_episode_created": null, "callbacks_on_episode_start": null, "callbacks_on_episode_step": null, "callbacks_on_episode_end": null, "callbacks_on_evaluate_start": null, "callbacks_on_evaluate_end": null, "callbacks_on_evaluate_offline_start": null, "callbacks_on_evaluate_offline_end": null, "callbacks_on_sample_end": null, "callbacks_on_train_result": null, "explore": true, "enable_rl_module_and_learner": true, "enable_env_runner_and_connector_v2": true, "_prior_exploration_config": {"type": "StochasticSampling"}, "count_steps_by": "env_steps", "policy_map_capacity": 100, "policy_mapping_fn": "<function AlgorithmConfig.DEFAULT_POLICY_MAPPING_FN at 0x3867f18a0>", "policies_to_train": null, "policy_states_are_swappable": false, "observation_fn": null, "offline_data_class": null, "input_read_method": "read_parquet", "input_read_method_kwargs": {}, "input_read_schema": {}, "input_read_episodes": false, "input_read_sample_batches": false, "input_read_batch_size": null, "input_filesystem": null, "input_filesystem_kwargs": {}, "input_compress_columns": ["obs", "new_obs"], "input_spaces_jsonable": true, "materialize_data": false, "materialize_mapped_data": true, "map_batches_kwargs": {}, "iter_batches_kwargs": {}, "ignore_final_observation": false, "prelearner_class": null, "prelearner_buffer_class": null, "prelearner_buffer_kwargs": {}, "prelearner_module_synch_period": 10, "dataset_num_iters_per_learner": null, "input_config": {}, "actions_in_input_normalized": false, "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_config": {}, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "output_max_rows_per_file": null, "output_write_remaining_data": false, "output_write_method": "write_parquet", "output_write_method_kwargs": {}, "output_filesystem": null, "output_filesystem_kwargs": {}, "output_write_episodes": true, "offline_sampling": false, "evaluation_interval": 1, "evaluation_duration": 20, "evaluation_duration_unit": "episodes", "evaluation_sample_timeout_s": 120.0, "evaluation_auto_duration_min_env_steps_per_sample": 100, "evaluation_auto_duration_max_env_steps_per_sample": 2000, "evaluation_parallel_to_training": false, "evaluation_force_reset_envs_before_iteration": true, "evaluation_config": null, "off_policy_estimation_methods": {}, "ope_split_batch_by_episode": true, "evaluation_num_env_runners": 1, "in_evaluation": false, "sync_filters_on_rollout_workers_timeout_s": 10.0, "offline_evaluation_interval": null, "num_offline_eval_runners": 0, "offline_loss_for_module_fn": null, "offline_evaluation_duration": 1, "offline_evaluation_parallel_to_training": false, "offline_evaluation_timeout_s": 120.0, "num_cpus_per_offline_eval_runner": 1, "num_gpus_per_offline_eval_runner": 0, "custom_resources_per_offline_eval_runner": {}, "restart_failed_offline_eval_runners": true, "ignore_offline_eval_runner_failures": false, "max_num_offline_eval_runner_restarts": 1000, "offline_eval_runner_restore_timeout_s": 1800.0, "max_requests_in_flight_per_offline_eval_runner": 1, "validate_offline_eval_runners_after_construction": true, "offline_eval_runner_health_probe_timeout_s": 30.0, "offline_eval_rl_module_inference_only": false, "broadcast_offline_eval_runner_states": false, "offline_eval_batch_size_per_runner": 256, "dataset_num_iters_per_eval_runner": 1, "keep_per_episode_custom_metrics": false, "metrics_episode_collection_timeout_s": 60.0, "metrics_num_episodes_for_smoothing": 100, "min_time_s_per_iteration": null, "min_train_timesteps_per_iteration": 0, "min_sample_timesteps_per_iteration": 0, "log_gradients": true, "export_native_model_files": false, "checkpoint_trainable_policies_only": false, "logger_creator": null, "logger_config": null, "log_level": "WARN", "log_sys_usage": true, "fake_sampler": false, "seed": 3, "restart_failed_env_runners": true, "ignore_env_runner_failures": false, "max_num_env_runner_restarts": 1000, "delay_between_env_runner_restarts_s": 60.0, "restart_failed_sub_environments": false, "num_consecutive_env_runner_failures_tolerance": 100, "env_runner_health_probe_timeout_s": 30.0, "env_runner_restore_timeout_s": 1800.0, "_model_config": {}, "_rl_module_spec": "RLModuleSpec(module_class=None, observation_space=None, action_space=None, inference_only=False, learner_only=False, model_config=DefaultModelConfig(fcnet_hiddens=[60, 90], fcnet_activation='tanh', fcnet_kernel_initializer=None, fcnet_kernel_initializer_kwargs=None, fcnet_bias_initializer=None, fcnet_bias_initializer_kwargs=None, conv_filters=None, conv_activation='relu', conv_kernel_initializer=None, conv_kernel_initializer_kwargs=None, conv_bias_initializer=None, conv_bias_initializer_kwargs=None, head_fcnet_hiddens=[], head_fcnet_activation='relu', head_fcnet_kernel_initializer=None, head_fcnet_kernel_initializer_kwargs=None, head_fcnet_bias_initializer=None, head_fcnet_bias_initializer_kwargs=None, free_log_std=False, log_std_clip_param=20.0, vf_share_layers=True, use_lstm=False, max_seq_len=20, lstm_cell_size=256, lstm_use_prev_action=False, lstm_use_prev_reward=False, lstm_kernel_initializer=None, lstm_kernel_initializer_kwargs=None, lstm_bias_initializer=None, lstm_bias_initializer_kwargs=None), catalog_class=None, load_state_path=None, model_config_dict=None)", "algorithm_config_overrides_per_module": {}, "_per_module_overrides": {}, "_validate_config": true, "_use_msgpack_checkpoints": false, "_torch_grad_scaler_class": null, "_torch_lr_scheduler_classes": null, "_tf_policy_handles_more_than_one_loss": false, "_disable_preprocessor_api": false, "_disable_action_flattening": false, "_disable_initialize_loss_from_dummy_batch": false, "_dont_auto_sync_env_runner_states": false, "env_task_fn": -1, "enable_connectors": -1, "simple_optimizer": false, "policy_map_cache": -1, "worker_cls": -1, "synchronize_filters": -1, "enable_async_evaluation": -1, "custom_async_evaluation_function": -1, "_enable_rl_module_api": -1, "auto_wrap_old_gym_envs": -1, "always_attach_evaluation_results": -1, "replay_sequence_length": null, "_disable_execution_plan_api": -1, "use_critic": true, "use_gae": true, "use_kl_loss": true, "kl_coeff": 0.7464963036515, "kl_target": 0.0270990929592, "vf_loss_coeff": 0.6688075857018, "entropy_coeff": 0.0090570820258, "clip_param": 0.1221781641624, "vf_clip_param": 0.1027808522125, "entropy_coeff_schedule": null, "lr_schedule": null, "sgd_minibatch_size": -1, "vf_share_layers": -1, "__stdout_file__": null, "__stderr_file__": null, "lambda": 0.9099046732075, "input": "sampler", "policies": {"default_policy": [null, null, null, null]}, "callbacks": "<class 'ray.rllib.callbacks.callbacks.RLlibCallback'>", "create_env_on_driver": false, "custom_eval_function": null, "framework": "torch"}, "time_since_restore": 54.82113289833069, "iterations_since_restore": 7, "perf": {"cpu_util_percent": 95.48461538461538, "ram_util_percent": 83.53846153846153}}
{"timers": {"training_iteration": 6.894593483223272, "restore_env_runners": 4.501060965260433e-05, "training_step": 6.894063386344642, "env_runner_sampling_timer": 6.56651705230807, "learner_update_timer": 0.3186129897870431, "synch_weights": 0.0018970894104257628, "restore_eval_env_runners": 1.498327294176004e-05, "evaluation_iteration": 0.37898592054024743, "synch_eval_env_connectors": 0.0005327688308312392, "synch_env_connectors": 1.9902883765442836e-05}, "env_runners": {"module_to_env_connector": {"timers": {"connectors": {"remove_single_ts_time_rank_from_batch": 2.456225984796216e-06, "listify_data_for_vector_env": 8.16105514319239e-05, "get_actions": 0.0003317297537162482, "normalize_and_clip_actions": 4.4436692278678745e-05, "tensor_to_numpy": 7.083472555350536e-05, "un_batch_to_individual_items": 2.189328410814471e-05}}, "connector_pipeline_timer": 0.0006925174037797452}, "env_step_timer": 9.074496326232696e-05, "env_to_module_connector": {"timers": {"connectors": {"numpy_to_tensor": 4.476718391683914e-05, "add_time_dim_to_batch_and_zero_pad": 9.470631578550803e-06, "add_observations_from_episodes_to_batch": 1.8758973324961806e-05, "batch_individual_items": 3.008790650151481e-05, "add_states_from_episodes_to_batch": 5.928244903708232e-06}}, "connector_pipeline_timer": 0.0002046741532291026}, "num_episodes_lifetime": -184750.0, "time_between_sampling": 0.006952083151443921, "num_agent_steps_sampled_lifetime": {"default_agent": -3695000.0}, "rlmodule_inference_timer": 0.0003527713456502624, "episode_return_mean": 1.0600000000000005, "episode_len_mean": 20.0, "env_reset_timer": 0.00020701408164211662, "num_agent_steps_sampled": {"default_agent": 5000.0}, "num_env_steps_sampled_lifetime": -3695000.0, "episode_return_max": 6.5, "num_episodes": 250.0, "env_to_module_sum_episodes_length_in": 10.36823839457432, "module_episode_returns_mean": {"default_policy": 1.0600000000000005}, "agent_episode_returns_mean": {"default_agent": 1.0600000000000005}, "num_module_steps_sampled": {"default_policy": 5000.0}, "num_env_steps_sampled": 5000.0, "episode_duration_sec_mean": 0.032469964283518504, "episode_len_min": 20, "sample": 0.03331626726301854, "episode_return_min": -13.5, "weights_seq_no": 7.0, "env_to_module_sum_episodes_length_out": 10.36823839457432, "num_module_steps_sampled_lifetime": {"default_policy": -3695000.0}, "episode_len_max": 20, "num_env_steps_sampled_lifetime_throughput": 1288.4054248794741}, "learners": {"default_policy": {"num_module_steps_trained": 6000, "num_module_steps_trained_lifetime": 48000, "curr_entropy_coeff": 0.0090570820258, "policy_loss": 0.03571588546037674, "total_loss": 0.09643588215112686, "weights_seq_no": 8.0, "default_optimizer_learning_rate": 0.0002847858517, "vf_loss_unclipped": 26.816692352294922, "entropy": 0.6227813363075256, "gradients_default_optimizer_global_norm": 0.04937148466706276, "num_trainable_parameters": 6003, "mean_kl_loss": 4.653878204408102e-05, "module_train_batch_size_mean": 1000.0, "vf_loss": 0.09922180324792862, "diff_num_grad_updates_vs_sampler_policy": 1.0, "vf_explained_var": -0.011062145233154297, "curr_kl_coeff": 0.0029160012491047382, "num_module_steps_trained_lifetime_throughput": 300452.02513401845}, "__all_modules__": {"learner_connector": {"timers": {"connectors": {"add_columns_from_episodes_to_train_batch": 0.1106519196369539, "add_time_dim_to_batch_and_zero_pad": 1.7402247486752568e-05, "batch_individual_items": 0.05579091990043592, "add_states_from_episodes_to_batch": 4.695968466133973e-06, "numpy_to_tensor": 8.935048355468667e-05, "add_one_ts_to_episodes_and_truncate": 0.023610349941036744, "general_advantage_estimation": 0.009182746556670944, "add_observations_from_episodes_to_batch": 0.0011472203330749168}}, "connector_pipeline_timer": 0.20094867873250793}, "num_trainable_parameters": 6003, "learner_connector_sum_episodes_length_in": 5000.0, "learner_connector_sum_episodes_length_out": 5250.0, "num_env_steps_trained": 31500, "num_module_steps_trained": 6000, "num_module_steps_trained_lifetime": 48000, "num_non_trainable_parameters": 0, "num_env_steps_trained_lifetime": 252000, "num_env_steps_trained_lifetime_throughput": 1563465.730450257, "num_module_steps_trained_throughput": 299635.7245790146, "num_module_steps_trained_lifetime_throughput": 298992.73704565596}}, "num_training_step_calls_per_iteration": 1, "evaluation": {"env_runners": {"env_step_timer": 6.335613945174282e-05, "num_episodes_lifetime": 160, "env_reset_timer": 0.0009343713820298028, "num_env_steps_sampled_lifetime": 40400, "env_to_module_connector": {"timers": {"connectors": {"add_observations_from_episodes_to_batch": 8.696631942397435e-06, "add_states_from_episodes_to_batch": 4.263950680119094e-06, "numpy_to_tensor": 4.421705967893427e-05, "batch_individual_items": 2.188200143720033e-05, "add_time_dim_to_batch_and_zero_pad": 1.1303078738104033e-05}}, "connector_pipeline_timer": 0.00017117167675097505}, "num_agent_steps_sampled": {"default_agent": 400}, "episode_len_min": 20, "sample": 0.35119133183125006, "module_to_env_connector": {"timers": {"connectors": {"get_actions": 0.0002355449305967326, "un_batch_to_individual_items": 3.87783085209807e-05, "remove_single_ts_time_rank_from_batch": 2.4337863097908205e-06, "listify_data_for_vector_env": 3.726698250434714e-05, "tensor_to_numpy": 7.293866932803291e-05, "normalize_and_clip_actions": 6.064242839533888e-05}}, "connector_pipeline_timer": 0.0007577463497769326}, "episode_return_min": -13.5, "env_to_module_sum_episodes_length_out": 10.3682383945743, "rlmodule_inference_timer": 0.0001735215089917102, "num_agent_steps_sampled_lifetime": {"default_agent": 3200}, "episode_duration_sec_mean": 0.03114215364214033, "module_episode_returns_mean": {"default_policy": 0.2}, "agent_episode_returns_mean": {"default_agent": 0.2}, "num_module_steps_sampled": {"default_policy": 400}, "episode_return_max": 13.5, "num_episodes": 20, "env_to_module_sum_episodes_length_in": 10.3682383945743, "num_env_steps_sampled": 400, "weights_seq_no": 8.0, "episode_return_mean": 0.2, "episode_len_mean": 20.0, "num_module_steps_sampled_lifetime": {"default_policy": 3200}, "episode_len_max": 20, "time_between_sampling": 6.206366425712368}, "num_healthy_workers": 1, "actor_manager_num_outstanding_async_reqs": 0, "num_remote_worker_restarts": 0}, "num_env_steps_sampled_lifetime": -3695000.0, "fault_tolerance": {"num_healthy_workers": 0, "num_remote_worker_restarts": 0}, "env_runner_group": {"actor_manager_num_outstanding_async_reqs": 0}, "done": false, "training_iteration": 8, "trial_id": "4995b_00000", "date": "2025-08-11_19-26-23", "timestamp": 1754933183, "time_this_iter_s": 10.228691816329956, "time_total_s": 65.04982471466064, "pid": 14987, "hostname": "Mac", "node_ip": "127.0.0.1", "config": {"exploration_config": {}, "extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "placement_strategy": "PACK", "num_gpus": 0, "_fake_gpus": false, "num_cpus_for_main_process": 2, "eager_tracing": true, "eager_max_retraces": 20, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "torch_compile_learner": false, "torch_compile_learner_what_to_compile": "forward_train", "torch_compile_learner_dynamo_backend": "aot_eager", "torch_compile_learner_dynamo_mode": null, "torch_compile_worker": false, "torch_compile_worker_dynamo_backend": "aot_eager", "torch_compile_worker_dynamo_mode": null, "torch_ddp_kwargs": {}, "torch_skip_nan_gradients": false, "env": "Umbrella", "env_config": {}, "observation_space": null, "action_space": null, "clip_rewards": null, "normalize_actions": true, "clip_actions": false, "_is_atari": null, "disable_env_checking": false, "render_env": false, "action_mask_key": "action_mask", "env_runner_cls": null, "num_env_runners": 0, "create_local_env_runner": true, "num_envs_per_env_runner": 1, "gym_env_vectorize_mode": "SYNC", "num_cpus_per_env_runner": 1, "num_gpus_per_env_runner": 0, "custom_resources_per_env_runner": {}, "validate_env_runners_after_construction": true, "episodes_to_numpy": true, "max_requests_in_flight_per_env_runner": 1, "sample_timeout_s": 60.0, "_env_to_module_connector": null, "add_default_connectors_to_env_to_module_pipeline": true, "_module_to_env_connector": null, "add_default_connectors_to_module_to_env_pipeline": true, "merge_env_runner_states": "training_only", "broadcast_env_runner_states": true, "episode_lookback_horizon": 1, "rollout_fragment_length": "auto", "batch_mode": "complete_episodes", "compress_observations": false, "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "enable_tf1_exec_eagerly": false, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "preprocessor_pref": "deepmind", "observation_filter": "NoFilter", "update_worker_filter_stats": true, "use_worker_filter_stats": true, "sampler_perf_stats_ema_coef": null, "_is_online": true, "num_learners": 0, "num_gpus_per_learner": 0, "num_cpus_per_learner": "auto", "num_aggregator_actors_per_learner": 0, "max_requests_in_flight_per_aggregator_actor": 3, "local_gpu_idx": 0, "max_requests_in_flight_per_learner": 3, "gamma": 1, "lr": 0.0002847858517, "grad_clip": 0.5, "grad_clip_by": "global_norm", "_train_batch_size_per_learner": 5000, "train_batch_size": 4000, "num_epochs": 1, "minibatch_size": 1000, "shuffle_batch_per_epoch": true, "model": {"fcnet_hiddens": [256, 256], "fcnet_activation": "tanh", "fcnet_weights_initializer": null, "fcnet_weights_initializer_config": null, "fcnet_bias_initializer": null, "fcnet_bias_initializer_config": null, "conv_filters": null, "conv_activation": "relu", "conv_kernel_initializer": null, "conv_kernel_initializer_config": null, "conv_bias_initializer": null, "conv_bias_initializer_config": null, "conv_transpose_kernel_initializer": null, "conv_transpose_kernel_initializer_config": null, "conv_transpose_bias_initializer": null, "conv_transpose_bias_initializer_config": null, "post_fcnet_hiddens": [], "post_fcnet_activation": "relu", "post_fcnet_weights_initializer": null, "post_fcnet_weights_initializer_config": null, "post_fcnet_bias_initializer": null, "post_fcnet_bias_initializer_config": null, "free_log_std": false, "log_std_clip_param": 20.0, "no_final_linear": false, "vf_share_layers": false, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "lstm_weights_initializer": null, "lstm_weights_initializer_config": null, "lstm_bias_initializer": null, "lstm_bias_initializer_config": null, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "attention_use_n_prev_actions": 0, "attention_use_n_prev_rewards": 0, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": null, "custom_model_config": {}, "custom_action_dist": null, "custom_preprocessor": null, "encoder_latent_dim": null, "always_check_shapes": false, "lstm_use_prev_action_reward": -1, "_use_default_native_models": -1, "_disable_preprocessor_api": false, "_disable_action_flattening": false}, "_learner_connector": null, "add_default_connectors_to_learner_pipeline": true, "learner_config_dict": {}, "optimizer": {}, "_learner_class": null, "callbacks_on_algorithm_init": null, "callbacks_on_env_runners_recreated": null, "callbacks_on_offline_eval_runners_recreated": null, "callbacks_on_checkpoint_loaded": null, "callbacks_on_environment_created": null, "callbacks_on_episode_created": null, "callbacks_on_episode_start": null, "callbacks_on_episode_step": null, "callbacks_on_episode_end": null, "callbacks_on_evaluate_start": null, "callbacks_on_evaluate_end": null, "callbacks_on_evaluate_offline_start": null, "callbacks_on_evaluate_offline_end": null, "callbacks_on_sample_end": null, "callbacks_on_train_result": null, "explore": true, "enable_rl_module_and_learner": true, "enable_env_runner_and_connector_v2": true, "_prior_exploration_config": {"type": "StochasticSampling"}, "count_steps_by": "env_steps", "policy_map_capacity": 100, "policy_mapping_fn": "<function AlgorithmConfig.DEFAULT_POLICY_MAPPING_FN at 0x3867f18a0>", "policies_to_train": null, "policy_states_are_swappable": false, "observation_fn": null, "offline_data_class": null, "input_read_method": "read_parquet", "input_read_method_kwargs": {}, "input_read_schema": {}, "input_read_episodes": false, "input_read_sample_batches": false, "input_read_batch_size": null, "input_filesystem": null, "input_filesystem_kwargs": {}, "input_compress_columns": ["obs", "new_obs"], "input_spaces_jsonable": true, "materialize_data": false, "materialize_mapped_data": true, "map_batches_kwargs": {}, "iter_batches_kwargs": {}, "ignore_final_observation": false, "prelearner_class": null, "prelearner_buffer_class": null, "prelearner_buffer_kwargs": {}, "prelearner_module_synch_period": 10, "dataset_num_iters_per_learner": null, "input_config": {}, "actions_in_input_normalized": false, "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_config": {}, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "output_max_rows_per_file": null, "output_write_remaining_data": false, "output_write_method": "write_parquet", "output_write_method_kwargs": {}, "output_filesystem": null, "output_filesystem_kwargs": {}, "output_write_episodes": true, "offline_sampling": false, "evaluation_interval": 1, "evaluation_duration": 20, "evaluation_duration_unit": "episodes", "evaluation_sample_timeout_s": 120.0, "evaluation_auto_duration_min_env_steps_per_sample": 100, "evaluation_auto_duration_max_env_steps_per_sample": 2000, "evaluation_parallel_to_training": false, "evaluation_force_reset_envs_before_iteration": true, "evaluation_config": null, "off_policy_estimation_methods": {}, "ope_split_batch_by_episode": true, "evaluation_num_env_runners": 1, "in_evaluation": false, "sync_filters_on_rollout_workers_timeout_s": 10.0, "offline_evaluation_interval": null, "num_offline_eval_runners": 0, "offline_loss_for_module_fn": null, "offline_evaluation_duration": 1, "offline_evaluation_parallel_to_training": false, "offline_evaluation_timeout_s": 120.0, "num_cpus_per_offline_eval_runner": 1, "num_gpus_per_offline_eval_runner": 0, "custom_resources_per_offline_eval_runner": {}, "restart_failed_offline_eval_runners": true, "ignore_offline_eval_runner_failures": false, "max_num_offline_eval_runner_restarts": 1000, "offline_eval_runner_restore_timeout_s": 1800.0, "max_requests_in_flight_per_offline_eval_runner": 1, "validate_offline_eval_runners_after_construction": true, "offline_eval_runner_health_probe_timeout_s": 30.0, "offline_eval_rl_module_inference_only": false, "broadcast_offline_eval_runner_states": false, "offline_eval_batch_size_per_runner": 256, "dataset_num_iters_per_eval_runner": 1, "keep_per_episode_custom_metrics": false, "metrics_episode_collection_timeout_s": 60.0, "metrics_num_episodes_for_smoothing": 100, "min_time_s_per_iteration": null, "min_train_timesteps_per_iteration": 0, "min_sample_timesteps_per_iteration": 0, "log_gradients": true, "export_native_model_files": false, "checkpoint_trainable_policies_only": false, "logger_creator": null, "logger_config": null, "log_level": "WARN", "log_sys_usage": true, "fake_sampler": false, "seed": 3, "restart_failed_env_runners": true, "ignore_env_runner_failures": false, "max_num_env_runner_restarts": 1000, "delay_between_env_runner_restarts_s": 60.0, "restart_failed_sub_environments": false, "num_consecutive_env_runner_failures_tolerance": 100, "env_runner_health_probe_timeout_s": 30.0, "env_runner_restore_timeout_s": 1800.0, "_model_config": {}, "_rl_module_spec": "RLModuleSpec(module_class=None, observation_space=None, action_space=None, inference_only=False, learner_only=False, model_config=DefaultModelConfig(fcnet_hiddens=[60, 90], fcnet_activation='tanh', fcnet_kernel_initializer=None, fcnet_kernel_initializer_kwargs=None, fcnet_bias_initializer=None, fcnet_bias_initializer_kwargs=None, conv_filters=None, conv_activation='relu', conv_kernel_initializer=None, conv_kernel_initializer_kwargs=None, conv_bias_initializer=None, conv_bias_initializer_kwargs=None, head_fcnet_hiddens=[], head_fcnet_activation='relu', head_fcnet_kernel_initializer=None, head_fcnet_kernel_initializer_kwargs=None, head_fcnet_bias_initializer=None, head_fcnet_bias_initializer_kwargs=None, free_log_std=False, log_std_clip_param=20.0, vf_share_layers=True, use_lstm=False, max_seq_len=20, lstm_cell_size=256, lstm_use_prev_action=False, lstm_use_prev_reward=False, lstm_kernel_initializer=None, lstm_kernel_initializer_kwargs=None, lstm_bias_initializer=None, lstm_bias_initializer_kwargs=None), catalog_class=None, load_state_path=None, model_config_dict=None)", "algorithm_config_overrides_per_module": {}, "_per_module_overrides": {}, "_validate_config": true, "_use_msgpack_checkpoints": false, "_torch_grad_scaler_class": null, "_torch_lr_scheduler_classes": null, "_tf_policy_handles_more_than_one_loss": false, "_disable_preprocessor_api": false, "_disable_action_flattening": false, "_disable_initialize_loss_from_dummy_batch": false, "_dont_auto_sync_env_runner_states": false, "env_task_fn": -1, "enable_connectors": -1, "simple_optimizer": false, "policy_map_cache": -1, "worker_cls": -1, "synchronize_filters": -1, "enable_async_evaluation": -1, "custom_async_evaluation_function": -1, "_enable_rl_module_api": -1, "auto_wrap_old_gym_envs": -1, "always_attach_evaluation_results": -1, "replay_sequence_length": null, "_disable_execution_plan_api": -1, "use_critic": true, "use_gae": true, "use_kl_loss": true, "kl_coeff": 0.7464963036515, "kl_target": 0.0270990929592, "vf_loss_coeff": 0.6688075857018, "entropy_coeff": 0.0090570820258, "clip_param": 0.1221781641624, "vf_clip_param": 0.1027808522125, "entropy_coeff_schedule": null, "lr_schedule": null, "sgd_minibatch_size": -1, "vf_share_layers": -1, "__stdout_file__": null, "__stderr_file__": null, "lambda": 0.9099046732075, "input": "sampler", "policies": {"default_policy": [null, null, null, null]}, "callbacks": "<class 'ray.rllib.callbacks.callbacks.RLlibCallback'>", "create_env_on_driver": false, "custom_eval_function": null, "framework": "torch"}, "time_since_restore": 65.04982471466064, "iterations_since_restore": 8, "perf": {"cpu_util_percent": 97.24999999999999, "ram_util_percent": 83.43571428571428}}
{"timers": {"training_iteration": 6.900619859220946, "restore_env_runners": 4.46292537885364e-05, "training_step": 6.900092565400348, "env_runner_sampling_timer": 6.568144141785238, "learner_update_timer": 0.32302857822947456, "synch_weights": 0.0019022643567558626, "restore_eval_env_runners": 1.7344270739513933e-05, "evaluation_iteration": 0.3806556484257265, "synch_eval_env_connectors": 0.0005322794832058357, "synch_env_connectors": 1.9803434265772732e-05}, "env_runners": {"module_to_env_connector": {"timers": {"connectors": {"remove_single_ts_time_rank_from_batch": 1.9022323185468888e-06, "listify_data_for_vector_env": 3.6406269770292026e-05, "get_actions": 0.00024313084389093907, "normalize_and_clip_actions": 3.6923245333423734e-05, "tensor_to_numpy": 0.00010680490716981067, "un_batch_to_individual_items": 1.4408111210065308e-05}}, "connector_pipeline_timer": 0.0005322826601030297}, "env_step_timer": 7.231838225609803e-05, "env_to_module_connector": {"timers": {"connectors": {"numpy_to_tensor": 4.662432833794805e-05, "add_time_dim_to_batch_and_zero_pad": 7.273146763854029e-06, "add_observations_from_episodes_to_batch": 1.2493890113971341e-05, "batch_individual_items": 3.362883347718206e-05, "add_states_from_episodes_to_batch": 1.0080384911587665e-05}}, "connector_pipeline_timer": 0.00019489988838912255}, "num_episodes_lifetime": -215625.0, "time_between_sampling": 0.006612888826649817, "num_agent_steps_sampled_lifetime": {"default_agent": -4312500.0}, "rlmodule_inference_timer": 0.00013046778046709012, "episode_return_mean": 1.5399999999999994, "episode_len_mean": 20.0, "env_reset_timer": 0.00012433145263179905, "num_agent_steps_sampled": {"default_agent": 5000.0}, "num_env_steps_sampled_lifetime": -4312500.0, "episode_return_max": 6.5, "num_episodes": 250.0, "env_to_module_sum_episodes_length_in": 10.36823839457432, "module_episode_returns_mean": {"default_policy": 1.5399999999999994}, "agent_episode_returns_mean": {"default_agent": 1.5399999999999994}, "num_module_steps_sampled": {"default_policy": 5000.0}, "num_env_steps_sampled": 5000.0, "episode_duration_sec_mean": 0.023273440652992573, "episode_len_min": 20, "sample": 0.025640976514922843, "episode_return_min": -13.5, "weights_seq_no": 8.0, "env_to_module_sum_episodes_length_out": 10.36823839457432, "num_module_steps_sampled_lifetime": {"default_policy": -4312500.0}, "episode_len_max": 20, "num_env_steps_sampled_lifetime_throughput": 1615.033715872579}, "learners": {"default_policy": {"num_module_steps_trained": 6000, "num_module_steps_trained_lifetime": 54000, "curr_entropy_coeff": 0.0090570820258, "policy_loss": -0.0015838929684832692, "total_loss": 0.05899802967905998, "weights_seq_no": 9.0, "default_optimizer_learning_rate": 0.0002847858517, "vf_loss_unclipped": 26.217327117919922, "entropy": 0.6220744848251343, "gradients_default_optimizer_global_norm": 0.059552472084760666, "num_trainable_parameters": 6003, "mean_kl_loss": 2.5744730010046624e-05, "module_train_batch_size_mean": 1000.0, "vf_loss": 0.09900609403848648, "diff_num_grad_updates_vs_sampler_policy": 1.0, "vf_explained_var": -0.010414361953735352, "curr_kl_coeff": 0.0014580006245523691, "num_module_steps_trained_lifetime_throughput": 290960.99956528307}, "__all_modules__": {"learner_connector": {"timers": {"connectors": {"add_columns_from_episodes_to_train_batch": 0.11017624211021088, "add_time_dim_to_batch_and_zero_pad": 1.736155547997343e-05, "batch_individual_items": 0.05559202445141659, "add_states_from_episodes_to_batch": 4.690678481767366e-06, "numpy_to_tensor": 0.00011450614912940036, "add_one_ts_to_episodes_and_truncate": 0.02807198644160052, "general_advantage_estimation": 0.009751429921452592, "add_observations_from_episodes_to_batch": 0.0011657073008232669}}, "connector_pipeline_timer": 0.20534559694519897}, "num_trainable_parameters": 6003, "learner_connector_sum_episodes_length_in": 5000.0, "learner_connector_sum_episodes_length_out": 5250.0, "num_env_steps_trained": 31500, "num_module_steps_trained": 6000, "num_module_steps_trained_lifetime": 54000, "num_non_trainable_parameters": 0, "num_env_steps_trained_lifetime": 283500, "num_env_steps_trained_lifetime_throughput": 1514159.0752992625, "num_module_steps_trained_throughput": 290175.4027634873, "num_module_steps_trained_lifetime_throughput": 289557.3465216088}}, "num_training_step_calls_per_iteration": 1, "evaluation": {"env_runners": {"env_step_timer": 3.700999860260719e-05, "num_episodes_lifetime": 180, "env_reset_timer": 0.0010786876682785716, "num_env_steps_sampled_lifetime": 45400, "env_to_module_connector": {"timers": {"connectors": {"add_observations_from_episodes_to_batch": 6.957131021105245e-06, "add_states_from_episodes_to_batch": 5.286457078268288e-06, "numpy_to_tensor": 2.4962998329097507e-05, "batch_individual_items": 2.2306050670534957e-05, "add_time_dim_to_batch_and_zero_pad": 6.9431295724794314e-06}}, "connector_pipeline_timer": 0.00011752525903423308}, "num_agent_steps_sampled": {"default_agent": 400}, "episode_len_min": 20, "sample": 0.3514216830931519, "module_to_env_connector": {"timers": {"connectors": {"get_actions": 0.00011964365449453523, "un_batch_to_individual_items": 1.543450418138367e-05, "remove_single_ts_time_rank_from_batch": 1.9061621963810212e-06, "listify_data_for_vector_env": 2.558718052795142e-05, "tensor_to_numpy": 4.155072053357309e-05, "normalize_and_clip_actions": 2.1838735217116266e-05}}, "connector_pipeline_timer": 0.0002875015630434314}, "episode_return_min": -13.5, "env_to_module_sum_episodes_length_out": 10.368238394574323, "rlmodule_inference_timer": 0.00012039272956338026, "num_agent_steps_sampled_lifetime": {"default_agent": 3600}, "episode_duration_sec_mean": 0.029543142853071913, "module_episode_returns_mean": {"default_policy": -0.2}, "agent_episode_returns_mean": {"default_agent": -0.2}, "num_module_steps_sampled": {"default_policy": 400}, "episode_return_max": 13.5, "num_episodes": 20, "env_to_module_sum_episodes_length_in": 10.368238394574323, "num_env_steps_sampled": 400, "weights_seq_no": 9.0, "episode_return_mean": -0.2, "episode_len_mean": 20.0, "num_module_steps_sampled_lifetime": {"default_policy": 3600}, "episode_len_max": 20, "time_between_sampling": 6.219887168955235}, "num_healthy_workers": 1, "actor_manager_num_outstanding_async_reqs": 0, "num_remote_worker_restarts": 0}, "num_env_steps_sampled_lifetime": -4312500.0, "fault_tolerance": {"num_healthy_workers": 0, "num_remote_worker_restarts": 0}, "env_runner_group": {"actor_manager_num_outstanding_async_reqs": 0}, "done": false, "training_iteration": 9, "trial_id": "4995b_00000", "date": "2025-08-11_19-26-31", "timestamp": 1754933191, "time_this_iter_s": 7.903520822525024, "time_total_s": 72.95334553718567, "pid": 14987, "hostname": "Mac", "node_ip": "127.0.0.1", "config": {"exploration_config": {}, "extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "placement_strategy": "PACK", "num_gpus": 0, "_fake_gpus": false, "num_cpus_for_main_process": 2, "eager_tracing": true, "eager_max_retraces": 20, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "torch_compile_learner": false, "torch_compile_learner_what_to_compile": "forward_train", "torch_compile_learner_dynamo_backend": "aot_eager", "torch_compile_learner_dynamo_mode": null, "torch_compile_worker": false, "torch_compile_worker_dynamo_backend": "aot_eager", "torch_compile_worker_dynamo_mode": null, "torch_ddp_kwargs": {}, "torch_skip_nan_gradients": false, "env": "Umbrella", "env_config": {}, "observation_space": null, "action_space": null, "clip_rewards": null, "normalize_actions": true, "clip_actions": false, "_is_atari": null, "disable_env_checking": false, "render_env": false, "action_mask_key": "action_mask", "env_runner_cls": null, "num_env_runners": 0, "create_local_env_runner": true, "num_envs_per_env_runner": 1, "gym_env_vectorize_mode": "SYNC", "num_cpus_per_env_runner": 1, "num_gpus_per_env_runner": 0, "custom_resources_per_env_runner": {}, "validate_env_runners_after_construction": true, "episodes_to_numpy": true, "max_requests_in_flight_per_env_runner": 1, "sample_timeout_s": 60.0, "_env_to_module_connector": null, "add_default_connectors_to_env_to_module_pipeline": true, "_module_to_env_connector": null, "add_default_connectors_to_module_to_env_pipeline": true, "merge_env_runner_states": "training_only", "broadcast_env_runner_states": true, "episode_lookback_horizon": 1, "rollout_fragment_length": "auto", "batch_mode": "complete_episodes", "compress_observations": false, "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "enable_tf1_exec_eagerly": false, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "preprocessor_pref": "deepmind", "observation_filter": "NoFilter", "update_worker_filter_stats": true, "use_worker_filter_stats": true, "sampler_perf_stats_ema_coef": null, "_is_online": true, "num_learners": 0, "num_gpus_per_learner": 0, "num_cpus_per_learner": "auto", "num_aggregator_actors_per_learner": 0, "max_requests_in_flight_per_aggregator_actor": 3, "local_gpu_idx": 0, "max_requests_in_flight_per_learner": 3, "gamma": 1, "lr": 0.0002847858517, "grad_clip": 0.5, "grad_clip_by": "global_norm", "_train_batch_size_per_learner": 5000, "train_batch_size": 4000, "num_epochs": 1, "minibatch_size": 1000, "shuffle_batch_per_epoch": true, "model": {"fcnet_hiddens": [256, 256], "fcnet_activation": "tanh", "fcnet_weights_initializer": null, "fcnet_weights_initializer_config": null, "fcnet_bias_initializer": null, "fcnet_bias_initializer_config": null, "conv_filters": null, "conv_activation": "relu", "conv_kernel_initializer": null, "conv_kernel_initializer_config": null, "conv_bias_initializer": null, "conv_bias_initializer_config": null, "conv_transpose_kernel_initializer": null, "conv_transpose_kernel_initializer_config": null, "conv_transpose_bias_initializer": null, "conv_transpose_bias_initializer_config": null, "post_fcnet_hiddens": [], "post_fcnet_activation": "relu", "post_fcnet_weights_initializer": null, "post_fcnet_weights_initializer_config": null, "post_fcnet_bias_initializer": null, "post_fcnet_bias_initializer_config": null, "free_log_std": false, "log_std_clip_param": 20.0, "no_final_linear": false, "vf_share_layers": false, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "lstm_weights_initializer": null, "lstm_weights_initializer_config": null, "lstm_bias_initializer": null, "lstm_bias_initializer_config": null, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "attention_use_n_prev_actions": 0, "attention_use_n_prev_rewards": 0, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": null, "custom_model_config": {}, "custom_action_dist": null, "custom_preprocessor": null, "encoder_latent_dim": null, "always_check_shapes": false, "lstm_use_prev_action_reward": -1, "_use_default_native_models": -1, "_disable_preprocessor_api": false, "_disable_action_flattening": false}, "_learner_connector": null, "add_default_connectors_to_learner_pipeline": true, "learner_config_dict": {}, "optimizer": {}, "_learner_class": null, "callbacks_on_algorithm_init": null, "callbacks_on_env_runners_recreated": null, "callbacks_on_offline_eval_runners_recreated": null, "callbacks_on_checkpoint_loaded": null, "callbacks_on_environment_created": null, "callbacks_on_episode_created": null, "callbacks_on_episode_start": null, "callbacks_on_episode_step": null, "callbacks_on_episode_end": null, "callbacks_on_evaluate_start": null, "callbacks_on_evaluate_end": null, "callbacks_on_evaluate_offline_start": null, "callbacks_on_evaluate_offline_end": null, "callbacks_on_sample_end": null, "callbacks_on_train_result": null, "explore": true, "enable_rl_module_and_learner": true, "enable_env_runner_and_connector_v2": true, "_prior_exploration_config": {"type": "StochasticSampling"}, "count_steps_by": "env_steps", "policy_map_capacity": 100, "policy_mapping_fn": "<function AlgorithmConfig.DEFAULT_POLICY_MAPPING_FN at 0x3867f18a0>", "policies_to_train": null, "policy_states_are_swappable": false, "observation_fn": null, "offline_data_class": null, "input_read_method": "read_parquet", "input_read_method_kwargs": {}, "input_read_schema": {}, "input_read_episodes": false, "input_read_sample_batches": false, "input_read_batch_size": null, "input_filesystem": null, "input_filesystem_kwargs": {}, "input_compress_columns": ["obs", "new_obs"], "input_spaces_jsonable": true, "materialize_data": false, "materialize_mapped_data": true, "map_batches_kwargs": {}, "iter_batches_kwargs": {}, "ignore_final_observation": false, "prelearner_class": null, "prelearner_buffer_class": null, "prelearner_buffer_kwargs": {}, "prelearner_module_synch_period": 10, "dataset_num_iters_per_learner": null, "input_config": {}, "actions_in_input_normalized": false, "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_config": {}, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "output_max_rows_per_file": null, "output_write_remaining_data": false, "output_write_method": "write_parquet", "output_write_method_kwargs": {}, "output_filesystem": null, "output_filesystem_kwargs": {}, "output_write_episodes": true, "offline_sampling": false, "evaluation_interval": 1, "evaluation_duration": 20, "evaluation_duration_unit": "episodes", "evaluation_sample_timeout_s": 120.0, "evaluation_auto_duration_min_env_steps_per_sample": 100, "evaluation_auto_duration_max_env_steps_per_sample": 2000, "evaluation_parallel_to_training": false, "evaluation_force_reset_envs_before_iteration": true, "evaluation_config": null, "off_policy_estimation_methods": {}, "ope_split_batch_by_episode": true, "evaluation_num_env_runners": 1, "in_evaluation": false, "sync_filters_on_rollout_workers_timeout_s": 10.0, "offline_evaluation_interval": null, "num_offline_eval_runners": 0, "offline_loss_for_module_fn": null, "offline_evaluation_duration": 1, "offline_evaluation_parallel_to_training": false, "offline_evaluation_timeout_s": 120.0, "num_cpus_per_offline_eval_runner": 1, "num_gpus_per_offline_eval_runner": 0, "custom_resources_per_offline_eval_runner": {}, "restart_failed_offline_eval_runners": true, "ignore_offline_eval_runner_failures": false, "max_num_offline_eval_runner_restarts": 1000, "offline_eval_runner_restore_timeout_s": 1800.0, "max_requests_in_flight_per_offline_eval_runner": 1, "validate_offline_eval_runners_after_construction": true, "offline_eval_runner_health_probe_timeout_s": 30.0, "offline_eval_rl_module_inference_only": false, "broadcast_offline_eval_runner_states": false, "offline_eval_batch_size_per_runner": 256, "dataset_num_iters_per_eval_runner": 1, "keep_per_episode_custom_metrics": false, "metrics_episode_collection_timeout_s": 60.0, "metrics_num_episodes_for_smoothing": 100, "min_time_s_per_iteration": null, "min_train_timesteps_per_iteration": 0, "min_sample_timesteps_per_iteration": 0, "log_gradients": true, "export_native_model_files": false, "checkpoint_trainable_policies_only": false, "logger_creator": null, "logger_config": null, "log_level": "WARN", "log_sys_usage": true, "fake_sampler": false, "seed": 3, "restart_failed_env_runners": true, "ignore_env_runner_failures": false, "max_num_env_runner_restarts": 1000, "delay_between_env_runner_restarts_s": 60.0, "restart_failed_sub_environments": false, "num_consecutive_env_runner_failures_tolerance": 100, "env_runner_health_probe_timeout_s": 30.0, "env_runner_restore_timeout_s": 1800.0, "_model_config": {}, "_rl_module_spec": "RLModuleSpec(module_class=None, observation_space=None, action_space=None, inference_only=False, learner_only=False, model_config=DefaultModelConfig(fcnet_hiddens=[60, 90], fcnet_activation='tanh', fcnet_kernel_initializer=None, fcnet_kernel_initializer_kwargs=None, fcnet_bias_initializer=None, fcnet_bias_initializer_kwargs=None, conv_filters=None, conv_activation='relu', conv_kernel_initializer=None, conv_kernel_initializer_kwargs=None, conv_bias_initializer=None, conv_bias_initializer_kwargs=None, head_fcnet_hiddens=[], head_fcnet_activation='relu', head_fcnet_kernel_initializer=None, head_fcnet_kernel_initializer_kwargs=None, head_fcnet_bias_initializer=None, head_fcnet_bias_initializer_kwargs=None, free_log_std=False, log_std_clip_param=20.0, vf_share_layers=True, use_lstm=False, max_seq_len=20, lstm_cell_size=256, lstm_use_prev_action=False, lstm_use_prev_reward=False, lstm_kernel_initializer=None, lstm_kernel_initializer_kwargs=None, lstm_bias_initializer=None, lstm_bias_initializer_kwargs=None), catalog_class=None, load_state_path=None, model_config_dict=None)", "algorithm_config_overrides_per_module": {}, "_per_module_overrides": {}, "_validate_config": true, "_use_msgpack_checkpoints": false, "_torch_grad_scaler_class": null, "_torch_lr_scheduler_classes": null, "_tf_policy_handles_more_than_one_loss": false, "_disable_preprocessor_api": false, "_disable_action_flattening": false, "_disable_initialize_loss_from_dummy_batch": false, "_dont_auto_sync_env_runner_states": false, "env_task_fn": -1, "enable_connectors": -1, "simple_optimizer": false, "policy_map_cache": -1, "worker_cls": -1, "synchronize_filters": -1, "enable_async_evaluation": -1, "custom_async_evaluation_function": -1, "_enable_rl_module_api": -1, "auto_wrap_old_gym_envs": -1, "always_attach_evaluation_results": -1, "replay_sequence_length": null, "_disable_execution_plan_api": -1, "use_critic": true, "use_gae": true, "use_kl_loss": true, "kl_coeff": 0.7464963036515, "kl_target": 0.0270990929592, "vf_loss_coeff": 0.6688075857018, "entropy_coeff": 0.0090570820258, "clip_param": 0.1221781641624, "vf_clip_param": 0.1027808522125, "entropy_coeff_schedule": null, "lr_schedule": null, "sgd_minibatch_size": -1, "vf_share_layers": -1, "__stdout_file__": null, "__stderr_file__": null, "lambda": 0.9099046732075, "input": "sampler", "policies": {"default_policy": [null, null, null, null]}, "callbacks": "<class 'ray.rllib.callbacks.callbacks.RLlibCallback'>", "create_env_on_driver": false, "custom_eval_function": null, "framework": "torch"}, "time_since_restore": 72.95334553718567, "iterations_since_restore": 9, "perf": {"cpu_util_percent": 92.65454545454547, "ram_util_percent": 82.80909090909091}}
{"timers": {"training_iteration": 6.902366573958952, "restore_env_runners": 4.425004208739415e-05, "training_step": 6.9018409368359865, "env_runner_sampling_timer": 6.56518645994779, "learner_update_timer": 0.3276872328581012, "synch_weights": 0.0019171808831409498, "restore_eval_env_runners": 1.767249774262082e-05, "evaluation_iteration": 0.380878241521052, "synch_eval_env_connectors": 0.0005282750185518146, "synch_env_connectors": 1.9649559747143616e-05}, "env_runners": {"module_to_env_connector": {"timers": {"connectors": {"remove_single_ts_time_rank_from_batch": 1.7532597246677688e-06, "listify_data_for_vector_env": 6.208070794718524e-05, "get_actions": 0.00026818409200251404, "normalize_and_clip_actions": 2.934523615307041e-05, "tensor_to_numpy": 7.553058908903161e-05, "un_batch_to_individual_items": 1.9210327922648163e-05}}, "connector_pipeline_timer": 0.0005544270250961809}, "env_step_timer": 5.630814332849681e-05, "env_to_module_connector": {"timers": {"connectors": {"numpy_to_tensor": 3.4598696741184085e-05, "add_time_dim_to_batch_and_zero_pad": 8.223312393530063e-06, "add_observations_from_episodes_to_batch": 1.728673987735245e-05, "batch_individual_items": 2.51365098965598e-05, "add_states_from_episodes_to_batch": 5.643974864441169e-06}}, "connector_pipeline_timer": 0.0001601187983857834}, "num_episodes_lifetime": -246500.0, "time_between_sampling": 0.007338503071225945, "num_agent_steps_sampled_lifetime": {"default_agent": -4930000.0}, "rlmodule_inference_timer": 0.00016925031707248938, "episode_return_mean": 0.58, "episode_len_mean": 20.0, "env_reset_timer": 0.00013543437806967567, "num_agent_steps_sampled": {"default_agent": 5000.0}, "num_env_steps_sampled_lifetime": -4930000.0, "episode_return_max": 6.5, "num_episodes": 250.0, "env_to_module_sum_episodes_length_in": 10.36823839457432, "module_episode_returns_mean": {"default_policy": 0.58}, "agent_episode_returns_mean": {"default_agent": 0.58}, "num_module_steps_sampled": {"default_policy": 5000.0}, "num_env_steps_sampled": 5000.0, "episode_duration_sec_mean": 0.021859051168896255, "episode_len_min": 20, "sample": 0.024839787019005542, "episode_return_min": -13.5, "weights_seq_no": 9.0, "env_to_module_sum_episodes_length_out": 10.36823839457432, "num_module_steps_sampled_lifetime": {"default_policy": -4930000.0}, "episode_len_max": 20, "num_env_steps_sampled_lifetime_throughput": 1628.5866170716085}, "learners": {"default_policy": {"num_module_steps_trained": 6000, "num_module_steps_trained_lifetime": 60000, "curr_entropy_coeff": 0.0090570820258, "policy_loss": -0.08808911591768265, "total_loss": -0.027369648218154907, "weights_seq_no": 10.0, "default_optimizer_learning_rate": 0.0002847858517, "vf_loss_unclipped": 26.218334197998047, "entropy": 0.6069930195808411, "gradients_default_optimizer_global_norm": 0.019865432754158974, "num_trainable_parameters": 6003, "mean_kl_loss": 0.0007112051243893802, "module_train_batch_size_mean": 1000.0, "vf_loss": 0.09900609403848648, "diff_num_grad_updates_vs_sampler_policy": 1.0, "vf_explained_var": -0.010382890701293945, "curr_kl_coeff": 0.0007290003122761846, "num_module_steps_trained_lifetime_throughput": 281921.3440792575}, "__all_modules__": {"learner_connector": {"timers": {"connectors": {"add_columns_from_episodes_to_train_batch": 0.1096134446894141, "add_time_dim_to_batch_and_zero_pad": 1.7362110052312187e-05, "batch_individual_items": 0.06126897587624702, "add_states_from_episodes_to_batch": 4.6796020047015865e-06, "numpy_to_tensor": 0.00011416358734589459, "add_one_ts_to_episodes_and_truncate": 0.027896852828195633, "general_advantage_estimation": 0.009714742712875825, "add_observations_from_episodes_to_batch": 0.0011639639773422205}}, "connector_pipeline_timer": 0.2102429418055468}, "num_trainable_parameters": 6003, "learner_connector_sum_episodes_length_in": 5000.0, "learner_connector_sum_episodes_length_out": 5250.0, "num_env_steps_trained": 31500, "num_module_steps_trained": 6000, "num_module_steps_trained_lifetime": 60000, "num_non_trainable_parameters": 0, "num_env_steps_trained_lifetime": 315000, "num_env_steps_trained_lifetime_throughput": 1467249.3195674638, "num_module_steps_trained_throughput": 281169.07204900234, "num_module_steps_trained_lifetime_throughput": 280576.511355873}}, "num_training_step_calls_per_iteration": 1, "evaluation": {"env_runners": {"env_step_timer": 6.611136782658197e-05, "num_episodes_lifetime": 200, "env_reset_timer": 0.0010710453720009915, "num_env_steps_sampled_lifetime": 50400, "env_to_module_connector": {"timers": {"connectors": {"add_observations_from_episodes_to_batch": 8.916702475282116e-06, "add_states_from_episodes_to_batch": 3.3868758307717265e-06, "numpy_to_tensor": 0.0003311922163152945, "batch_individual_items": 1.653694317030453e-05, "add_time_dim_to_batch_and_zero_pad": 6.462076726704534e-06}}, "connector_pipeline_timer": 0.0004225093819786003}, "num_agent_steps_sampled": {"default_agent": 400}, "episode_len_min": 20, "sample": 0.35193847167199943, "module_to_env_connector": {"timers": {"connectors": {"get_actions": 0.0002621013958913897, "un_batch_to_individual_items": 1.5503847856032436e-05, "remove_single_ts_time_rank_from_batch": 1.5506047837980612e-06, "listify_data_for_vector_env": 3.2730345394049604e-05, "tensor_to_numpy": 7.724219824546912e-05, "normalize_and_clip_actions": 3.0584449564956196e-05}}, "connector_pipeline_timer": 0.0004970537164038974}, "episode_return_min": -13.5, "env_to_module_sum_episodes_length_out": 10.368238394574323, "rlmodule_inference_timer": 0.00010655842000272594, "num_agent_steps_sampled_lifetime": {"default_agent": 4000}, "episode_duration_sec_mean": 0.021364135787589476, "module_episode_returns_mean": {"default_policy": 1.2}, "agent_episode_returns_mean": {"default_agent": 1.2}, "num_module_steps_sampled": {"default_policy": 400}, "episode_return_max": 13.5, "num_episodes": 20, "env_to_module_sum_episodes_length_in": 10.368238394574323, "num_env_steps_sampled": 400, "weights_seq_no": 10.0, "episode_return_mean": 1.2, "episode_len_mean": 20.0, "num_module_steps_sampled_lifetime": {"default_policy": 4000}, "episode_len_max": 20, "time_between_sampling": 6.229020676015185}, "num_healthy_workers": 1, "actor_manager_num_outstanding_async_reqs": 0, "num_remote_worker_restarts": 0}, "num_env_steps_sampled_lifetime": -4930000.0, "fault_tolerance": {"num_healthy_workers": 0, "num_remote_worker_restarts": 0}, "env_runner_group": {"actor_manager_num_outstanding_async_reqs": 0}, "done": false, "training_iteration": 10, "trial_id": "4995b_00000", "date": "2025-08-11_19-26-38", "timestamp": 1754933198, "time_this_iter_s": 7.503438949584961, "time_total_s": 80.45678448677063, "pid": 14987, "hostname": "Mac", "node_ip": "127.0.0.1", "config": {"exploration_config": {}, "extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "placement_strategy": "PACK", "num_gpus": 0, "_fake_gpus": false, "num_cpus_for_main_process": 2, "eager_tracing": true, "eager_max_retraces": 20, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "torch_compile_learner": false, "torch_compile_learner_what_to_compile": "forward_train", "torch_compile_learner_dynamo_backend": "aot_eager", "torch_compile_learner_dynamo_mode": null, "torch_compile_worker": false, "torch_compile_worker_dynamo_backend": "aot_eager", "torch_compile_worker_dynamo_mode": null, "torch_ddp_kwargs": {}, "torch_skip_nan_gradients": false, "env": "Umbrella", "env_config": {}, "observation_space": null, "action_space": null, "clip_rewards": null, "normalize_actions": true, "clip_actions": false, "_is_atari": null, "disable_env_checking": false, "render_env": false, "action_mask_key": "action_mask", "env_runner_cls": null, "num_env_runners": 0, "create_local_env_runner": true, "num_envs_per_env_runner": 1, "gym_env_vectorize_mode": "SYNC", "num_cpus_per_env_runner": 1, "num_gpus_per_env_runner": 0, "custom_resources_per_env_runner": {}, "validate_env_runners_after_construction": true, "episodes_to_numpy": true, "max_requests_in_flight_per_env_runner": 1, "sample_timeout_s": 60.0, "_env_to_module_connector": null, "add_default_connectors_to_env_to_module_pipeline": true, "_module_to_env_connector": null, "add_default_connectors_to_module_to_env_pipeline": true, "merge_env_runner_states": "training_only", "broadcast_env_runner_states": true, "episode_lookback_horizon": 1, "rollout_fragment_length": "auto", "batch_mode": "complete_episodes", "compress_observations": false, "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "enable_tf1_exec_eagerly": false, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "preprocessor_pref": "deepmind", "observation_filter": "NoFilter", "update_worker_filter_stats": true, "use_worker_filter_stats": true, "sampler_perf_stats_ema_coef": null, "_is_online": true, "num_learners": 0, "num_gpus_per_learner": 0, "num_cpus_per_learner": "auto", "num_aggregator_actors_per_learner": 0, "max_requests_in_flight_per_aggregator_actor": 3, "local_gpu_idx": 0, "max_requests_in_flight_per_learner": 3, "gamma": 1, "lr": 0.0002847858517, "grad_clip": 0.5, "grad_clip_by": "global_norm", "_train_batch_size_per_learner": 5000, "train_batch_size": 4000, "num_epochs": 1, "minibatch_size": 1000, "shuffle_batch_per_epoch": true, "model": {"fcnet_hiddens": [256, 256], "fcnet_activation": "tanh", "fcnet_weights_initializer": null, "fcnet_weights_initializer_config": null, "fcnet_bias_initializer": null, "fcnet_bias_initializer_config": null, "conv_filters": null, "conv_activation": "relu", "conv_kernel_initializer": null, "conv_kernel_initializer_config": null, "conv_bias_initializer": null, "conv_bias_initializer_config": null, "conv_transpose_kernel_initializer": null, "conv_transpose_kernel_initializer_config": null, "conv_transpose_bias_initializer": null, "conv_transpose_bias_initializer_config": null, "post_fcnet_hiddens": [], "post_fcnet_activation": "relu", "post_fcnet_weights_initializer": null, "post_fcnet_weights_initializer_config": null, "post_fcnet_bias_initializer": null, "post_fcnet_bias_initializer_config": null, "free_log_std": false, "log_std_clip_param": 20.0, "no_final_linear": false, "vf_share_layers": false, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "lstm_weights_initializer": null, "lstm_weights_initializer_config": null, "lstm_bias_initializer": null, "lstm_bias_initializer_config": null, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "attention_use_n_prev_actions": 0, "attention_use_n_prev_rewards": 0, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": null, "custom_model_config": {}, "custom_action_dist": null, "custom_preprocessor": null, "encoder_latent_dim": null, "always_check_shapes": false, "lstm_use_prev_action_reward": -1, "_use_default_native_models": -1, "_disable_preprocessor_api": false, "_disable_action_flattening": false}, "_learner_connector": null, "add_default_connectors_to_learner_pipeline": true, "learner_config_dict": {}, "optimizer": {}, "_learner_class": null, "callbacks_on_algorithm_init": null, "callbacks_on_env_runners_recreated": null, "callbacks_on_offline_eval_runners_recreated": null, "callbacks_on_checkpoint_loaded": null, "callbacks_on_environment_created": null, "callbacks_on_episode_created": null, "callbacks_on_episode_start": null, "callbacks_on_episode_step": null, "callbacks_on_episode_end": null, "callbacks_on_evaluate_start": null, "callbacks_on_evaluate_end": null, "callbacks_on_evaluate_offline_start": null, "callbacks_on_evaluate_offline_end": null, "callbacks_on_sample_end": null, "callbacks_on_train_result": null, "explore": true, "enable_rl_module_and_learner": true, "enable_env_runner_and_connector_v2": true, "_prior_exploration_config": {"type": "StochasticSampling"}, "count_steps_by": "env_steps", "policy_map_capacity": 100, "policy_mapping_fn": "<function AlgorithmConfig.DEFAULT_POLICY_MAPPING_FN at 0x3867f18a0>", "policies_to_train": null, "policy_states_are_swappable": false, "observation_fn": null, "offline_data_class": null, "input_read_method": "read_parquet", "input_read_method_kwargs": {}, "input_read_schema": {}, "input_read_episodes": false, "input_read_sample_batches": false, "input_read_batch_size": null, "input_filesystem": null, "input_filesystem_kwargs": {}, "input_compress_columns": ["obs", "new_obs"], "input_spaces_jsonable": true, "materialize_data": false, "materialize_mapped_data": true, "map_batches_kwargs": {}, "iter_batches_kwargs": {}, "ignore_final_observation": false, "prelearner_class": null, "prelearner_buffer_class": null, "prelearner_buffer_kwargs": {}, "prelearner_module_synch_period": 10, "dataset_num_iters_per_learner": null, "input_config": {}, "actions_in_input_normalized": false, "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_config": {}, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "output_max_rows_per_file": null, "output_write_remaining_data": false, "output_write_method": "write_parquet", "output_write_method_kwargs": {}, "output_filesystem": null, "output_filesystem_kwargs": {}, "output_write_episodes": true, "offline_sampling": false, "evaluation_interval": 1, "evaluation_duration": 20, "evaluation_duration_unit": "episodes", "evaluation_sample_timeout_s": 120.0, "evaluation_auto_duration_min_env_steps_per_sample": 100, "evaluation_auto_duration_max_env_steps_per_sample": 2000, "evaluation_parallel_to_training": false, "evaluation_force_reset_envs_before_iteration": true, "evaluation_config": null, "off_policy_estimation_methods": {}, "ope_split_batch_by_episode": true, "evaluation_num_env_runners": 1, "in_evaluation": false, "sync_filters_on_rollout_workers_timeout_s": 10.0, "offline_evaluation_interval": null, "num_offline_eval_runners": 0, "offline_loss_for_module_fn": null, "offline_evaluation_duration": 1, "offline_evaluation_parallel_to_training": false, "offline_evaluation_timeout_s": 120.0, "num_cpus_per_offline_eval_runner": 1, "num_gpus_per_offline_eval_runner": 0, "custom_resources_per_offline_eval_runner": {}, "restart_failed_offline_eval_runners": true, "ignore_offline_eval_runner_failures": false, "max_num_offline_eval_runner_restarts": 1000, "offline_eval_runner_restore_timeout_s": 1800.0, "max_requests_in_flight_per_offline_eval_runner": 1, "validate_offline_eval_runners_after_construction": true, "offline_eval_runner_health_probe_timeout_s": 30.0, "offline_eval_rl_module_inference_only": false, "broadcast_offline_eval_runner_states": false, "offline_eval_batch_size_per_runner": 256, "dataset_num_iters_per_eval_runner": 1, "keep_per_episode_custom_metrics": false, "metrics_episode_collection_timeout_s": 60.0, "metrics_num_episodes_for_smoothing": 100, "min_time_s_per_iteration": null, "min_train_timesteps_per_iteration": 0, "min_sample_timesteps_per_iteration": 0, "log_gradients": true, "export_native_model_files": false, "checkpoint_trainable_policies_only": false, "logger_creator": null, "logger_config": null, "log_level": "WARN", "log_sys_usage": true, "fake_sampler": false, "seed": 3, "restart_failed_env_runners": true, "ignore_env_runner_failures": false, "max_num_env_runner_restarts": 1000, "delay_between_env_runner_restarts_s": 60.0, "restart_failed_sub_environments": false, "num_consecutive_env_runner_failures_tolerance": 100, "env_runner_health_probe_timeout_s": 30.0, "env_runner_restore_timeout_s": 1800.0, "_model_config": {}, "_rl_module_spec": "RLModuleSpec(module_class=None, observation_space=None, action_space=None, inference_only=False, learner_only=False, model_config=DefaultModelConfig(fcnet_hiddens=[60, 90], fcnet_activation='tanh', fcnet_kernel_initializer=None, fcnet_kernel_initializer_kwargs=None, fcnet_bias_initializer=None, fcnet_bias_initializer_kwargs=None, conv_filters=None, conv_activation='relu', conv_kernel_initializer=None, conv_kernel_initializer_kwargs=None, conv_bias_initializer=None, conv_bias_initializer_kwargs=None, head_fcnet_hiddens=[], head_fcnet_activation='relu', head_fcnet_kernel_initializer=None, head_fcnet_kernel_initializer_kwargs=None, head_fcnet_bias_initializer=None, head_fcnet_bias_initializer_kwargs=None, free_log_std=False, log_std_clip_param=20.0, vf_share_layers=True, use_lstm=False, max_seq_len=20, lstm_cell_size=256, lstm_use_prev_action=False, lstm_use_prev_reward=False, lstm_kernel_initializer=None, lstm_kernel_initializer_kwargs=None, lstm_bias_initializer=None, lstm_bias_initializer_kwargs=None), catalog_class=None, load_state_path=None, model_config_dict=None)", "algorithm_config_overrides_per_module": {}, "_per_module_overrides": {}, "_validate_config": true, "_use_msgpack_checkpoints": false, "_torch_grad_scaler_class": null, "_torch_lr_scheduler_classes": null, "_tf_policy_handles_more_than_one_loss": false, "_disable_preprocessor_api": false, "_disable_action_flattening": false, "_disable_initialize_loss_from_dummy_batch": false, "_dont_auto_sync_env_runner_states": false, "env_task_fn": -1, "enable_connectors": -1, "simple_optimizer": false, "policy_map_cache": -1, "worker_cls": -1, "synchronize_filters": -1, "enable_async_evaluation": -1, "custom_async_evaluation_function": -1, "_enable_rl_module_api": -1, "auto_wrap_old_gym_envs": -1, "always_attach_evaluation_results": -1, "replay_sequence_length": null, "_disable_execution_plan_api": -1, "use_critic": true, "use_gae": true, "use_kl_loss": true, "kl_coeff": 0.7464963036515, "kl_target": 0.0270990929592, "vf_loss_coeff": 0.6688075857018, "entropy_coeff": 0.0090570820258, "clip_param": 0.1221781641624, "vf_clip_param": 0.1027808522125, "entropy_coeff_schedule": null, "lr_schedule": null, "sgd_minibatch_size": -1, "vf_share_layers": -1, "__stdout_file__": null, "__stderr_file__": null, "lambda": 0.9099046732075, "input": "sampler", "policies": {"default_policy": [null, null, null, null]}, "callbacks": "<class 'ray.rllib.callbacks.callbacks.RLlibCallback'>", "create_env_on_driver": false, "custom_eval_function": null, "framework": "torch"}, "time_since_restore": 80.45678448677063, "iterations_since_restore": 10, "perf": {"cpu_util_percent": 82.03333333333335, "ram_util_percent": 82.05555555555554}}
{"timers": {"training_iteration": 6.895140543629111, "restore_env_runners": 4.4072541356054515e-05, "training_step": 6.894614024127488, "env_runner_sampling_timer": 6.55802250700807, "learner_update_timer": 0.3276513346896643, "synch_weights": 0.0019108382441733753, "restore_eval_env_runners": 1.7714113193740683e-05, "evaluation_iteration": 0.3812449482758526, "synch_eval_env_connectors": 0.0005245476888246133, "synch_env_connectors": 1.9520564081573873e-05}, "env_runners": {"module_to_env_connector": {"timers": {"connectors": {"remove_single_ts_time_rank_from_batch": 1.7185914653968434e-06, "listify_data_for_vector_env": 5.3459515844697874e-05, "get_actions": 0.00021131211399127493, "normalize_and_clip_actions": 3.8167509645868275e-05, "tensor_to_numpy": 5.7774480837713246e-05, "un_batch_to_individual_items": 2.1045633710208457e-05}}, "connector_pipeline_timer": 0.00047070076527697103}, "env_step_timer": 7.065036237030642e-05, "env_to_module_connector": {"timers": {"connectors": {"numpy_to_tensor": 3.867676131052253e-05, "add_time_dim_to_batch_and_zero_pad": 8.236866267518584e-06, "add_observations_from_episodes_to_batch": 9.480132417320872e-06, "batch_individual_items": 3.005684345674204e-05, "add_states_from_episodes_to_batch": 1.535365675074149e-05}}, "connector_pipeline_timer": 0.00017091806517978753}, "num_episodes_lifetime": -277375.0, "time_between_sampling": 0.00713254685537516, "num_agent_steps_sampled_lifetime": {"default_agent": -5547500.0}, "rlmodule_inference_timer": 0.0001443632912217754, "episode_return_mean": 2.42, "episode_len_mean": 20.0, "env_reset_timer": 0.00012541302916863571, "num_agent_steps_sampled": {"default_agent": 5000.0}, "num_env_steps_sampled_lifetime": -5547500.0, "episode_return_max": 6.5, "num_episodes": 250.0, "env_to_module_sum_episodes_length_in": 10.36823839457432, "module_episode_returns_mean": {"default_policy": 2.42}, "agent_episode_returns_mean": {"default_agent": 2.42}, "num_module_steps_sampled": {"default_policy": 5000.0}, "num_env_steps_sampled": 5000.0, "episode_duration_sec_mean": 0.020423532334621988, "episode_len_min": 20, "sample": 0.021470784147226078, "episode_return_min": -13.5, "weights_seq_no": 10.0, "env_to_module_sum_episodes_length_out": 10.36823839457432, "num_module_steps_sampled_lifetime": {"default_policy": -5547500.0}, "episode_len_max": 20, "num_env_steps_sampled_lifetime_throughput": 1711.084917332955}, "learners": {"default_policy": {"num_module_steps_trained": 6000, "num_module_steps_trained_lifetime": 66000, "curr_entropy_coeff": 0.0090570820258, "policy_loss": -0.04522467032074928, "total_loss": 0.015427875332534313, "weights_seq_no": 11.0, "default_optimizer_learning_rate": 0.0002847858517, "vf_loss_unclipped": 25.318986892700195, "entropy": 0.5904287099838257, "gradients_default_optimizer_global_norm": 0.04201570525765419, "num_trainable_parameters": 6003, "mean_kl_loss": 0.0006328527233563364, "module_train_batch_size_mean": 1000.0, "vf_loss": 0.09868254512548447, "diff_num_grad_updates_vs_sampler_policy": 1.0, "vf_explained_var": -0.009004473686218262, "curr_kl_coeff": 0.0003645001561380923, "num_module_steps_trained_lifetime_throughput": 273578.1406053656}, "__all_modules__": {"learner_connector": {"timers": {"connectors": {"add_columns_from_episodes_to_train_batch": 0.10991443608224137, "add_time_dim_to_batch_and_zero_pad": 1.7898908796625062e-05, "batch_individual_items": 0.06121581236748373, "add_states_from_episodes_to_batch": 4.736135060154939e-06, "numpy_to_tensor": 0.00011398736161743527, "add_one_ts_to_episodes_and_truncate": 0.027698258469542745, "general_advantage_estimation": 0.009716098615538194, "add_observations_from_episodes_to_batch": 0.0011740480873833532}}, "connector_pipeline_timer": 0.21030239280708093}, "num_trainable_parameters": 6003, "learner_connector_sum_episodes_length_in": 5000.0, "learner_connector_sum_episodes_length_out": 5250.0, "num_env_steps_trained": 31500, "num_module_steps_trained": 6000, "num_module_steps_trained_lifetime": 66000, "num_non_trainable_parameters": 0, "num_env_steps_trained_lifetime": 346500, "num_env_steps_trained_lifetime_throughput": 1423935.0583681948, "num_module_steps_trained_throughput": 272857.95145948674, "num_module_steps_trained_lifetime_throughput": 272282.8958828554}}, "num_training_step_calls_per_iteration": 1, "evaluation": {"env_runners": {"env_step_timer": 7.755831499076798e-05, "num_episodes_lifetime": 220, "env_reset_timer": 0.0010612507483045684, "num_env_steps_sampled_lifetime": 55400, "env_to_module_connector": {"timers": {"connectors": {"add_observations_from_episodes_to_batch": 7.837801401315573e-06, "add_states_from_episodes_to_batch": 4.118002510078792e-06, "numpy_to_tensor": 4.7387842513962444e-05, "batch_individual_items": 1.985941405851651e-05, "add_time_dim_to_batch_and_zero_pad": 9.119358666339474e-06}}, "connector_pipeline_timer": 0.0001434786127793026}, "num_agent_steps_sampled": {"default_agent": 400}, "episode_len_min": 20, "sample": 0.3521250286256209, "module_to_env_connector": {"timers": {"connectors": {"get_actions": 0.00015810654222303834, "un_batch_to_individual_items": 1.4847666799661797e-05, "remove_single_ts_time_rank_from_batch": 1.307755807705493e-06, "listify_data_for_vector_env": 3.378471155504435e-05, "tensor_to_numpy": 9.699940587349945e-05, "normalize_and_clip_actions": 3.6720313109021594e-05}}, "connector_pipeline_timer": 0.00040747658851960874}, "episode_return_min": -13.5, "env_to_module_sum_episodes_length_out": 10.368238394574323, "rlmodule_inference_timer": 0.00010541899025055877, "num_agent_steps_sampled_lifetime": {"default_agent": 4400}, "episode_duration_sec_mean": 0.01872883251053281, "module_episode_returns_mean": {"default_policy": 1.6}, "agent_episode_returns_mean": {"default_agent": 1.6}, "num_module_steps_sampled": {"default_policy": 400}, "episode_return_max": 13.5, "num_episodes": 20, "env_to_module_sum_episodes_length_in": 10.368238394574323, "num_env_steps_sampled": 400, "weights_seq_no": 11.0, "episode_return_mean": 1.6, "episode_len_mean": 20.0, "num_module_steps_sampled_lifetime": {"default_policy": 4400}, "episode_len_max": 20, "time_between_sampling": 6.2291371109155245}, "num_healthy_workers": 1, "actor_manager_num_outstanding_async_reqs": 0, "num_remote_worker_restarts": 0}, "num_env_steps_sampled_lifetime": -5547500.0, "fault_tolerance": {"num_healthy_workers": 0, "num_remote_worker_restarts": 0}, "env_runner_group": {"actor_manager_num_outstanding_async_reqs": 0}, "done": false, "training_iteration": 11, "trial_id": "4995b_00000", "date": "2025-08-11_19-26-45", "timestamp": 1754933205, "time_this_iter_s": 6.577343940734863, "time_total_s": 87.0341284275055, "pid": 14987, "hostname": "Mac", "node_ip": "127.0.0.1", "config": {"exploration_config": {}, "extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "placement_strategy": "PACK", "num_gpus": 0, "_fake_gpus": false, "num_cpus_for_main_process": 2, "eager_tracing": true, "eager_max_retraces": 20, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "torch_compile_learner": false, "torch_compile_learner_what_to_compile": "forward_train", "torch_compile_learner_dynamo_backend": "aot_eager", "torch_compile_learner_dynamo_mode": null, "torch_compile_worker": false, "torch_compile_worker_dynamo_backend": "aot_eager", "torch_compile_worker_dynamo_mode": null, "torch_ddp_kwargs": {}, "torch_skip_nan_gradients": false, "env": "Umbrella", "env_config": {}, "observation_space": null, "action_space": null, "clip_rewards": null, "normalize_actions": true, "clip_actions": false, "_is_atari": null, "disable_env_checking": false, "render_env": false, "action_mask_key": "action_mask", "env_runner_cls": null, "num_env_runners": 0, "create_local_env_runner": true, "num_envs_per_env_runner": 1, "gym_env_vectorize_mode": "SYNC", "num_cpus_per_env_runner": 1, "num_gpus_per_env_runner": 0, "custom_resources_per_env_runner": {}, "validate_env_runners_after_construction": true, "episodes_to_numpy": true, "max_requests_in_flight_per_env_runner": 1, "sample_timeout_s": 60.0, "_env_to_module_connector": null, "add_default_connectors_to_env_to_module_pipeline": true, "_module_to_env_connector": null, "add_default_connectors_to_module_to_env_pipeline": true, "merge_env_runner_states": "training_only", "broadcast_env_runner_states": true, "episode_lookback_horizon": 1, "rollout_fragment_length": "auto", "batch_mode": "complete_episodes", "compress_observations": false, "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "enable_tf1_exec_eagerly": false, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "preprocessor_pref": "deepmind", "observation_filter": "NoFilter", "update_worker_filter_stats": true, "use_worker_filter_stats": true, "sampler_perf_stats_ema_coef": null, "_is_online": true, "num_learners": 0, "num_gpus_per_learner": 0, "num_cpus_per_learner": "auto", "num_aggregator_actors_per_learner": 0, "max_requests_in_flight_per_aggregator_actor": 3, "local_gpu_idx": 0, "max_requests_in_flight_per_learner": 3, "gamma": 1, "lr": 0.0002847858517, "grad_clip": 0.5, "grad_clip_by": "global_norm", "_train_batch_size_per_learner": 5000, "train_batch_size": 4000, "num_epochs": 1, "minibatch_size": 1000, "shuffle_batch_per_epoch": true, "model": {"fcnet_hiddens": [256, 256], "fcnet_activation": "tanh", "fcnet_weights_initializer": null, "fcnet_weights_initializer_config": null, "fcnet_bias_initializer": null, "fcnet_bias_initializer_config": null, "conv_filters": null, "conv_activation": "relu", "conv_kernel_initializer": null, "conv_kernel_initializer_config": null, "conv_bias_initializer": null, "conv_bias_initializer_config": null, "conv_transpose_kernel_initializer": null, "conv_transpose_kernel_initializer_config": null, "conv_transpose_bias_initializer": null, "conv_transpose_bias_initializer_config": null, "post_fcnet_hiddens": [], "post_fcnet_activation": "relu", "post_fcnet_weights_initializer": null, "post_fcnet_weights_initializer_config": null, "post_fcnet_bias_initializer": null, "post_fcnet_bias_initializer_config": null, "free_log_std": false, "log_std_clip_param": 20.0, "no_final_linear": false, "vf_share_layers": false, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "lstm_weights_initializer": null, "lstm_weights_initializer_config": null, "lstm_bias_initializer": null, "lstm_bias_initializer_config": null, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "attention_use_n_prev_actions": 0, "attention_use_n_prev_rewards": 0, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": null, "custom_model_config": {}, "custom_action_dist": null, "custom_preprocessor": null, "encoder_latent_dim": null, "always_check_shapes": false, "lstm_use_prev_action_reward": -1, "_use_default_native_models": -1, "_disable_preprocessor_api": false, "_disable_action_flattening": false}, "_learner_connector": null, "add_default_connectors_to_learner_pipeline": true, "learner_config_dict": {}, "optimizer": {}, "_learner_class": null, "callbacks_on_algorithm_init": null, "callbacks_on_env_runners_recreated": null, "callbacks_on_offline_eval_runners_recreated": null, "callbacks_on_checkpoint_loaded": null, "callbacks_on_environment_created": null, "callbacks_on_episode_created": null, "callbacks_on_episode_start": null, "callbacks_on_episode_step": null, "callbacks_on_episode_end": null, "callbacks_on_evaluate_start": null, "callbacks_on_evaluate_end": null, "callbacks_on_evaluate_offline_start": null, "callbacks_on_evaluate_offline_end": null, "callbacks_on_sample_end": null, "callbacks_on_train_result": null, "explore": true, "enable_rl_module_and_learner": true, "enable_env_runner_and_connector_v2": true, "_prior_exploration_config": {"type": "StochasticSampling"}, "count_steps_by": "env_steps", "policy_map_capacity": 100, "policy_mapping_fn": "<function AlgorithmConfig.DEFAULT_POLICY_MAPPING_FN at 0x3867f18a0>", "policies_to_train": null, "policy_states_are_swappable": false, "observation_fn": null, "offline_data_class": null, "input_read_method": "read_parquet", "input_read_method_kwargs": {}, "input_read_schema": {}, "input_read_episodes": false, "input_read_sample_batches": false, "input_read_batch_size": null, "input_filesystem": null, "input_filesystem_kwargs": {}, "input_compress_columns": ["obs", "new_obs"], "input_spaces_jsonable": true, "materialize_data": false, "materialize_mapped_data": true, "map_batches_kwargs": {}, "iter_batches_kwargs": {}, "ignore_final_observation": false, "prelearner_class": null, "prelearner_buffer_class": null, "prelearner_buffer_kwargs": {}, "prelearner_module_synch_period": 10, "dataset_num_iters_per_learner": null, "input_config": {}, "actions_in_input_normalized": false, "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_config": {}, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "output_max_rows_per_file": null, "output_write_remaining_data": false, "output_write_method": "write_parquet", "output_write_method_kwargs": {}, "output_filesystem": null, "output_filesystem_kwargs": {}, "output_write_episodes": true, "offline_sampling": false, "evaluation_interval": 1, "evaluation_duration": 20, "evaluation_duration_unit": "episodes", "evaluation_sample_timeout_s": 120.0, "evaluation_auto_duration_min_env_steps_per_sample": 100, "evaluation_auto_duration_max_env_steps_per_sample": 2000, "evaluation_parallel_to_training": false, "evaluation_force_reset_envs_before_iteration": true, "evaluation_config": null, "off_policy_estimation_methods": {}, "ope_split_batch_by_episode": true, "evaluation_num_env_runners": 1, "in_evaluation": false, "sync_filters_on_rollout_workers_timeout_s": 10.0, "offline_evaluation_interval": null, "num_offline_eval_runners": 0, "offline_loss_for_module_fn": null, "offline_evaluation_duration": 1, "offline_evaluation_parallel_to_training": false, "offline_evaluation_timeout_s": 120.0, "num_cpus_per_offline_eval_runner": 1, "num_gpus_per_offline_eval_runner": 0, "custom_resources_per_offline_eval_runner": {}, "restart_failed_offline_eval_runners": true, "ignore_offline_eval_runner_failures": false, "max_num_offline_eval_runner_restarts": 1000, "offline_eval_runner_restore_timeout_s": 1800.0, "max_requests_in_flight_per_offline_eval_runner": 1, "validate_offline_eval_runners_after_construction": true, "offline_eval_runner_health_probe_timeout_s": 30.0, "offline_eval_rl_module_inference_only": false, "broadcast_offline_eval_runner_states": false, "offline_eval_batch_size_per_runner": 256, "dataset_num_iters_per_eval_runner": 1, "keep_per_episode_custom_metrics": false, "metrics_episode_collection_timeout_s": 60.0, "metrics_num_episodes_for_smoothing": 100, "min_time_s_per_iteration": null, "min_train_timesteps_per_iteration": 0, "min_sample_timesteps_per_iteration": 0, "log_gradients": true, "export_native_model_files": false, "checkpoint_trainable_policies_only": false, "logger_creator": null, "logger_config": null, "log_level": "WARN", "log_sys_usage": true, "fake_sampler": false, "seed": 3, "restart_failed_env_runners": true, "ignore_env_runner_failures": false, "max_num_env_runner_restarts": 1000, "delay_between_env_runner_restarts_s": 60.0, "restart_failed_sub_environments": false, "num_consecutive_env_runner_failures_tolerance": 100, "env_runner_health_probe_timeout_s": 30.0, "env_runner_restore_timeout_s": 1800.0, "_model_config": {}, "_rl_module_spec": "RLModuleSpec(module_class=None, observation_space=None, action_space=None, inference_only=False, learner_only=False, model_config=DefaultModelConfig(fcnet_hiddens=[60, 90], fcnet_activation='tanh', fcnet_kernel_initializer=None, fcnet_kernel_initializer_kwargs=None, fcnet_bias_initializer=None, fcnet_bias_initializer_kwargs=None, conv_filters=None, conv_activation='relu', conv_kernel_initializer=None, conv_kernel_initializer_kwargs=None, conv_bias_initializer=None, conv_bias_initializer_kwargs=None, head_fcnet_hiddens=[], head_fcnet_activation='relu', head_fcnet_kernel_initializer=None, head_fcnet_kernel_initializer_kwargs=None, head_fcnet_bias_initializer=None, head_fcnet_bias_initializer_kwargs=None, free_log_std=False, log_std_clip_param=20.0, vf_share_layers=True, use_lstm=False, max_seq_len=20, lstm_cell_size=256, lstm_use_prev_action=False, lstm_use_prev_reward=False, lstm_kernel_initializer=None, lstm_kernel_initializer_kwargs=None, lstm_bias_initializer=None, lstm_bias_initializer_kwargs=None), catalog_class=None, load_state_path=None, model_config_dict=None)", "algorithm_config_overrides_per_module": {}, "_per_module_overrides": {}, "_validate_config": true, "_use_msgpack_checkpoints": false, "_torch_grad_scaler_class": null, "_torch_lr_scheduler_classes": null, "_tf_policy_handles_more_than_one_loss": false, "_disable_preprocessor_api": false, "_disable_action_flattening": false, "_disable_initialize_loss_from_dummy_batch": false, "_dont_auto_sync_env_runner_states": false, "env_task_fn": -1, "enable_connectors": -1, "simple_optimizer": false, "policy_map_cache": -1, "worker_cls": -1, "synchronize_filters": -1, "enable_async_evaluation": -1, "custom_async_evaluation_function": -1, "_enable_rl_module_api": -1, "auto_wrap_old_gym_envs": -1, "always_attach_evaluation_results": -1, "replay_sequence_length": null, "_disable_execution_plan_api": -1, "use_critic": true, "use_gae": true, "use_kl_loss": true, "kl_coeff": 0.7464963036515, "kl_target": 0.0270990929592, "vf_loss_coeff": 0.6688075857018, "entropy_coeff": 0.0090570820258, "clip_param": 0.1221781641624, "vf_clip_param": 0.1027808522125, "entropy_coeff_schedule": null, "lr_schedule": null, "sgd_minibatch_size": -1, "vf_share_layers": -1, "__stdout_file__": null, "__stderr_file__": null, "lambda": 0.9099046732075, "input": "sampler", "policies": {"default_policy": [null, null, null, null]}, "callbacks": "<class 'ray.rllib.callbacks.callbacks.RLlibCallback'>", "create_env_on_driver": false, "custom_eval_function": null, "framework": "torch"}, "time_since_restore": 87.0341284275055, "iterations_since_restore": 11, "perf": {"cpu_util_percent": 89.38, "ram_util_percent": 82.38}}
{"timers": {"training_iteration": 6.882622013612089, "restore_env_runners": 4.3971395943803483e-05, "training_step": 6.8820961280560145, "env_runner_sampling_timer": 6.546301251107659, "learner_update_timer": 0.3268669767521857, "synch_weights": 0.0019065106925563891, "restore_eval_env_runners": 1.7754892231037554e-05, "evaluation_iteration": 0.38133900463322606, "synch_eval_env_connectors": 0.0005228647117053992, "synch_env_connectors": 1.9376188862727427e-05}, "env_runners": {"module_to_env_connector": {"timers": {"connectors": {"remove_single_ts_time_rank_from_batch": 2.2477978414175487e-06, "listify_data_for_vector_env": 3.549192290137921e-05, "get_actions": 0.00018860231599540905, "normalize_and_clip_actions": 4.463081880596835e-05, "tensor_to_numpy": 5.2580106340007256e-05, "un_batch_to_individual_items": 2.2091628035112806e-05}}, "connector_pipeline_timer": 0.00045854576902120943}, "env_step_timer": 5.486704358972427e-05, "env_to_module_connector": {"timers": {"connectors": {"numpy_to_tensor": 3.247425300551105e-05, "add_time_dim_to_batch_and_zero_pad": 6.5675599993390875e-06, "add_observations_from_episodes_to_batch": 9.447487104189403e-06, "batch_individual_items": 2.1626529646886875e-05, "add_states_from_episodes_to_batch": 3.951129408712457e-06}}, "connector_pipeline_timer": 0.00013189005012628836}, "num_episodes_lifetime": -308250.0, "time_between_sampling": 0.005849047234478693, "num_agent_steps_sampled_lifetime": {"default_agent": -6165000.0}, "rlmodule_inference_timer": 0.00011590223981990888, "episode_return_mean": 1.8600000000000003, "episode_len_mean": 20.0, "env_reset_timer": 0.00014185426189502242, "num_agent_steps_sampled": {"default_agent": 5000.0}, "num_env_steps_sampled_lifetime": -6165000.0, "episode_return_max": 6.5, "num_episodes": 250.0, "env_to_module_sum_episodes_length_in": 10.36823839457432, "module_episode_returns_mean": {"default_policy": 1.8600000000000003}, "agent_episode_returns_mean": {"default_agent": 1.8600000000000003}, "num_module_steps_sampled": {"default_policy": 5000.0}, "num_env_steps_sampled": 5000.0, "episode_duration_sec_mean": 0.017888683133758604, "episode_len_min": 20, "sample": 0.020002110425299292, "episode_return_min": -13.5, "weights_seq_no": 11.0, "env_to_module_sum_episodes_length_out": 10.36823839457432, "num_module_steps_sampled_lifetime": {"default_policy": -6165000.0}, "episode_len_max": 20, "num_env_steps_sampled_lifetime_throughput": 1801.5021664351566}, "learners": {"default_policy": {"num_module_steps_trained": 6000, "num_module_steps_trained_lifetime": 72000, "curr_entropy_coeff": 0.0090570820258, "policy_loss": 0.026909515261650085, "total_loss": 0.0880821943283081, "weights_seq_no": 12.0, "default_optimizer_learning_rate": 0.0002847858517, "vf_loss_unclipped": 26.199382781982422, "entropy": 0.548987865447998, "gradients_default_optimizer_global_norm": 0.22185371816158295, "num_trainable_parameters": 6003, "mean_kl_loss": 0.0027911753859370947, "module_train_batch_size_mean": 1000.0, "vf_loss": 0.09889824688434601, "diff_num_grad_updates_vs_sampler_policy": 1.0, "vf_explained_var": -0.010240793228149414, "curr_kl_coeff": 0.00018225007806904614, "num_module_steps_trained_lifetime_throughput": 265875.08811004326}, "__all_modules__": {"learner_connector": {"timers": {"connectors": {"add_columns_from_episodes_to_train_batch": 0.10932767464155191, "add_time_dim_to_batch_and_zero_pad": 1.8165329386581537e-05, "batch_individual_items": 0.06094491632428272, "add_states_from_episodes_to_batch": 4.823363791423946e-06, "numpy_to_tensor": 0.0001137295668947436, "add_one_ts_to_episodes_and_truncate": 0.02775221047457603, "general_advantage_estimation": 0.00973293387923924, "add_observations_from_episodes_to_batch": 0.0012270488561714123}}, "connector_pipeline_timer": 0.20956687678890037}, "num_trainable_parameters": 6003, "learner_connector_sum_episodes_length_in": 5000.0, "learner_connector_sum_episodes_length_out": 5250.0, "num_env_steps_trained": 31500, "num_module_steps_trained": 6000, "num_module_steps_trained_lifetime": 72000, "num_non_trainable_parameters": 0, "num_env_steps_trained_lifetime": 378000, "num_env_steps_trained_lifetime_throughput": 1383887.6453093365, "num_module_steps_trained_throughput": 265180.26795766625, "num_module_steps_trained_lifetime_throughput": 264612.5902517616}}, "num_training_step_calls_per_iteration": 1, "evaluation": {"env_runners": {"env_step_timer": 0.0001142097495051332, "num_episodes_lifetime": 240, "env_reset_timer": 0.0010658203308133902, "num_env_steps_sampled_lifetime": 60400, "env_to_module_connector": {"timers": {"connectors": {"add_observations_from_episodes_to_batch": 7.709983258531295e-06, "add_states_from_episodes_to_batch": 1.6758291081749766e-05, "numpy_to_tensor": 3.5598078986817385e-05, "batch_individual_items": 1.7199039394729994e-05, "add_time_dim_to_batch_and_zero_pad": 8.067063490963413e-06}}, "connector_pipeline_timer": 0.00015187485445456152}, "num_agent_steps_sampled": {"default_agent": 400}, "episode_len_min": 20, "sample": 0.3525741062498662, "module_to_env_connector": {"timers": {"connectors": {"get_actions": 0.0001984131097878812, "un_batch_to_individual_items": 4.858375518989751e-05, "remove_single_ts_time_rank_from_batch": 1.9900572767048384e-06, "listify_data_for_vector_env": 0.00018031950007529746, "tensor_to_numpy": 7.076382550642976e-05, "normalize_and_clip_actions": 7.13884725596616e-05}}, "connector_pipeline_timer": 0.0006791067573136166}, "episode_return_min": -13.5, "env_to_module_sum_episodes_length_out": 10.368238394574323, "rlmodule_inference_timer": 0.00012331414146643573, "num_agent_steps_sampled_lifetime": {"default_agent": 4800}, "episode_duration_sec_mean": 0.018205718335229902, "module_episode_returns_mean": {"default_policy": 2.0}, "agent_episode_returns_mean": {"default_agent": 2.0}, "num_module_steps_sampled": {"default_policy": 400}, "episode_return_max": 13.5, "num_episodes": 20, "env_to_module_sum_episodes_length_in": 10.368238394574323, "num_env_steps_sampled": 400, "weights_seq_no": 12.0, "episode_return_mean": 2.0, "episode_len_mean": 20.0, "num_module_steps_sampled_lifetime": {"default_policy": 4800}, "episode_len_max": 20, "time_between_sampling": 6.223734218146485}, "num_healthy_workers": 1, "actor_manager_num_outstanding_async_reqs": 0, "num_remote_worker_restarts": 0}, "num_env_steps_sampled_lifetime": -6165000.0, "fault_tolerance": {"num_healthy_workers": 0, "num_remote_worker_restarts": 0}, "env_runner_group": {"actor_manager_num_outstanding_async_reqs": 0}, "done": false, "training_iteration": 12, "trial_id": "4995b_00000", "date": "2025-08-11_19-26-51", "timestamp": 1754933211, "time_this_iter_s": 6.064841032028198, "time_total_s": 93.09896945953369, "pid": 14987, "hostname": "Mac", "node_ip": "127.0.0.1", "config": {"exploration_config": {}, "extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "placement_strategy": "PACK", "num_gpus": 0, "_fake_gpus": false, "num_cpus_for_main_process": 2, "eager_tracing": true, "eager_max_retraces": 20, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "torch_compile_learner": false, "torch_compile_learner_what_to_compile": "forward_train", "torch_compile_learner_dynamo_backend": "aot_eager", "torch_compile_learner_dynamo_mode": null, "torch_compile_worker": false, "torch_compile_worker_dynamo_backend": "aot_eager", "torch_compile_worker_dynamo_mode": null, "torch_ddp_kwargs": {}, "torch_skip_nan_gradients": false, "env": "Umbrella", "env_config": {}, "observation_space": null, "action_space": null, "clip_rewards": null, "normalize_actions": true, "clip_actions": false, "_is_atari": null, "disable_env_checking": false, "render_env": false, "action_mask_key": "action_mask", "env_runner_cls": null, "num_env_runners": 0, "create_local_env_runner": true, "num_envs_per_env_runner": 1, "gym_env_vectorize_mode": "SYNC", "num_cpus_per_env_runner": 1, "num_gpus_per_env_runner": 0, "custom_resources_per_env_runner": {}, "validate_env_runners_after_construction": true, "episodes_to_numpy": true, "max_requests_in_flight_per_env_runner": 1, "sample_timeout_s": 60.0, "_env_to_module_connector": null, "add_default_connectors_to_env_to_module_pipeline": true, "_module_to_env_connector": null, "add_default_connectors_to_module_to_env_pipeline": true, "merge_env_runner_states": "training_only", "broadcast_env_runner_states": true, "episode_lookback_horizon": 1, "rollout_fragment_length": "auto", "batch_mode": "complete_episodes", "compress_observations": false, "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "enable_tf1_exec_eagerly": false, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "preprocessor_pref": "deepmind", "observation_filter": "NoFilter", "update_worker_filter_stats": true, "use_worker_filter_stats": true, "sampler_perf_stats_ema_coef": null, "_is_online": true, "num_learners": 0, "num_gpus_per_learner": 0, "num_cpus_per_learner": "auto", "num_aggregator_actors_per_learner": 0, "max_requests_in_flight_per_aggregator_actor": 3, "local_gpu_idx": 0, "max_requests_in_flight_per_learner": 3, "gamma": 1, "lr": 0.0002847858517, "grad_clip": 0.5, "grad_clip_by": "global_norm", "_train_batch_size_per_learner": 5000, "train_batch_size": 4000, "num_epochs": 1, "minibatch_size": 1000, "shuffle_batch_per_epoch": true, "model": {"fcnet_hiddens": [256, 256], "fcnet_activation": "tanh", "fcnet_weights_initializer": null, "fcnet_weights_initializer_config": null, "fcnet_bias_initializer": null, "fcnet_bias_initializer_config": null, "conv_filters": null, "conv_activation": "relu", "conv_kernel_initializer": null, "conv_kernel_initializer_config": null, "conv_bias_initializer": null, "conv_bias_initializer_config": null, "conv_transpose_kernel_initializer": null, "conv_transpose_kernel_initializer_config": null, "conv_transpose_bias_initializer": null, "conv_transpose_bias_initializer_config": null, "post_fcnet_hiddens": [], "post_fcnet_activation": "relu", "post_fcnet_weights_initializer": null, "post_fcnet_weights_initializer_config": null, "post_fcnet_bias_initializer": null, "post_fcnet_bias_initializer_config": null, "free_log_std": false, "log_std_clip_param": 20.0, "no_final_linear": false, "vf_share_layers": false, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "lstm_weights_initializer": null, "lstm_weights_initializer_config": null, "lstm_bias_initializer": null, "lstm_bias_initializer_config": null, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "attention_use_n_prev_actions": 0, "attention_use_n_prev_rewards": 0, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": null, "custom_model_config": {}, "custom_action_dist": null, "custom_preprocessor": null, "encoder_latent_dim": null, "always_check_shapes": false, "lstm_use_prev_action_reward": -1, "_use_default_native_models": -1, "_disable_preprocessor_api": false, "_disable_action_flattening": false}, "_learner_connector": null, "add_default_connectors_to_learner_pipeline": true, "learner_config_dict": {}, "optimizer": {}, "_learner_class": null, "callbacks_on_algorithm_init": null, "callbacks_on_env_runners_recreated": null, "callbacks_on_offline_eval_runners_recreated": null, "callbacks_on_checkpoint_loaded": null, "callbacks_on_environment_created": null, "callbacks_on_episode_created": null, "callbacks_on_episode_start": null, "callbacks_on_episode_step": null, "callbacks_on_episode_end": null, "callbacks_on_evaluate_start": null, "callbacks_on_evaluate_end": null, "callbacks_on_evaluate_offline_start": null, "callbacks_on_evaluate_offline_end": null, "callbacks_on_sample_end": null, "callbacks_on_train_result": null, "explore": true, "enable_rl_module_and_learner": true, "enable_env_runner_and_connector_v2": true, "_prior_exploration_config": {"type": "StochasticSampling"}, "count_steps_by": "env_steps", "policy_map_capacity": 100, "policy_mapping_fn": "<function AlgorithmConfig.DEFAULT_POLICY_MAPPING_FN at 0x3867f18a0>", "policies_to_train": null, "policy_states_are_swappable": false, "observation_fn": null, "offline_data_class": null, "input_read_method": "read_parquet", "input_read_method_kwargs": {}, "input_read_schema": {}, "input_read_episodes": false, "input_read_sample_batches": false, "input_read_batch_size": null, "input_filesystem": null, "input_filesystem_kwargs": {}, "input_compress_columns": ["obs", "new_obs"], "input_spaces_jsonable": true, "materialize_data": false, "materialize_mapped_data": true, "map_batches_kwargs": {}, "iter_batches_kwargs": {}, "ignore_final_observation": false, "prelearner_class": null, "prelearner_buffer_class": null, "prelearner_buffer_kwargs": {}, "prelearner_module_synch_period": 10, "dataset_num_iters_per_learner": null, "input_config": {}, "actions_in_input_normalized": false, "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_config": {}, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "output_max_rows_per_file": null, "output_write_remaining_data": false, "output_write_method": "write_parquet", "output_write_method_kwargs": {}, "output_filesystem": null, "output_filesystem_kwargs": {}, "output_write_episodes": true, "offline_sampling": false, "evaluation_interval": 1, "evaluation_duration": 20, "evaluation_duration_unit": "episodes", "evaluation_sample_timeout_s": 120.0, "evaluation_auto_duration_min_env_steps_per_sample": 100, "evaluation_auto_duration_max_env_steps_per_sample": 2000, "evaluation_parallel_to_training": false, "evaluation_force_reset_envs_before_iteration": true, "evaluation_config": null, "off_policy_estimation_methods": {}, "ope_split_batch_by_episode": true, "evaluation_num_env_runners": 1, "in_evaluation": false, "sync_filters_on_rollout_workers_timeout_s": 10.0, "offline_evaluation_interval": null, "num_offline_eval_runners": 0, "offline_loss_for_module_fn": null, "offline_evaluation_duration": 1, "offline_evaluation_parallel_to_training": false, "offline_evaluation_timeout_s": 120.0, "num_cpus_per_offline_eval_runner": 1, "num_gpus_per_offline_eval_runner": 0, "custom_resources_per_offline_eval_runner": {}, "restart_failed_offline_eval_runners": true, "ignore_offline_eval_runner_failures": false, "max_num_offline_eval_runner_restarts": 1000, "offline_eval_runner_restore_timeout_s": 1800.0, "max_requests_in_flight_per_offline_eval_runner": 1, "validate_offline_eval_runners_after_construction": true, "offline_eval_runner_health_probe_timeout_s": 30.0, "offline_eval_rl_module_inference_only": false, "broadcast_offline_eval_runner_states": false, "offline_eval_batch_size_per_runner": 256, "dataset_num_iters_per_eval_runner": 1, "keep_per_episode_custom_metrics": false, "metrics_episode_collection_timeout_s": 60.0, "metrics_num_episodes_for_smoothing": 100, "min_time_s_per_iteration": null, "min_train_timesteps_per_iteration": 0, "min_sample_timesteps_per_iteration": 0, "log_gradients": true, "export_native_model_files": false, "checkpoint_trainable_policies_only": false, "logger_creator": null, "logger_config": null, "log_level": "WARN", "log_sys_usage": true, "fake_sampler": false, "seed": 3, "restart_failed_env_runners": true, "ignore_env_runner_failures": false, "max_num_env_runner_restarts": 1000, "delay_between_env_runner_restarts_s": 60.0, "restart_failed_sub_environments": false, "num_consecutive_env_runner_failures_tolerance": 100, "env_runner_health_probe_timeout_s": 30.0, "env_runner_restore_timeout_s": 1800.0, "_model_config": {}, "_rl_module_spec": "RLModuleSpec(module_class=None, observation_space=None, action_space=None, inference_only=False, learner_only=False, model_config=DefaultModelConfig(fcnet_hiddens=[60, 90], fcnet_activation='tanh', fcnet_kernel_initializer=None, fcnet_kernel_initializer_kwargs=None, fcnet_bias_initializer=None, fcnet_bias_initializer_kwargs=None, conv_filters=None, conv_activation='relu', conv_kernel_initializer=None, conv_kernel_initializer_kwargs=None, conv_bias_initializer=None, conv_bias_initializer_kwargs=None, head_fcnet_hiddens=[], head_fcnet_activation='relu', head_fcnet_kernel_initializer=None, head_fcnet_kernel_initializer_kwargs=None, head_fcnet_bias_initializer=None, head_fcnet_bias_initializer_kwargs=None, free_log_std=False, log_std_clip_param=20.0, vf_share_layers=True, use_lstm=False, max_seq_len=20, lstm_cell_size=256, lstm_use_prev_action=False, lstm_use_prev_reward=False, lstm_kernel_initializer=None, lstm_kernel_initializer_kwargs=None, lstm_bias_initializer=None, lstm_bias_initializer_kwargs=None), catalog_class=None, load_state_path=None, model_config_dict=None)", "algorithm_config_overrides_per_module": {}, "_per_module_overrides": {}, "_validate_config": true, "_use_msgpack_checkpoints": false, "_torch_grad_scaler_class": null, "_torch_lr_scheduler_classes": null, "_tf_policy_handles_more_than_one_loss": false, "_disable_preprocessor_api": false, "_disable_action_flattening": false, "_disable_initialize_loss_from_dummy_batch": false, "_dont_auto_sync_env_runner_states": false, "env_task_fn": -1, "enable_connectors": -1, "simple_optimizer": false, "policy_map_cache": -1, "worker_cls": -1, "synchronize_filters": -1, "enable_async_evaluation": -1, "custom_async_evaluation_function": -1, "_enable_rl_module_api": -1, "auto_wrap_old_gym_envs": -1, "always_attach_evaluation_results": -1, "replay_sequence_length": null, "_disable_execution_plan_api": -1, "use_critic": true, "use_gae": true, "use_kl_loss": true, "kl_coeff": 0.7464963036515, "kl_target": 0.0270990929592, "vf_loss_coeff": 0.6688075857018, "entropy_coeff": 0.0090570820258, "clip_param": 0.1221781641624, "vf_clip_param": 0.1027808522125, "entropy_coeff_schedule": null, "lr_schedule": null, "sgd_minibatch_size": -1, "vf_share_layers": -1, "__stdout_file__": null, "__stderr_file__": null, "lambda": 0.9099046732075, "input": "sampler", "policies": {"default_policy": [null, null, null, null]}, "callbacks": "<class 'ray.rllib.callbacks.callbacks.RLlibCallback'>", "create_env_on_driver": false, "custom_eval_function": null, "framework": "torch"}, "time_since_restore": 93.09896945953369, "iterations_since_restore": 12, "perf": {"cpu_util_percent": 78.5125, "ram_util_percent": 82.0875}}
{"timers": {"training_iteration": 6.876790154315915, "restore_env_runners": 4.367293218679772e-05, "training_step": 6.876267089275531, "env_runner_sampling_timer": 6.541549338596772, "learner_update_timer": 0.32581837240492445, "synch_weights": 0.0018980526652336031, "restore_eval_env_runners": 1.7719423552404078e-05, "evaluation_iteration": 0.38167048666696285, "synch_eval_env_connectors": 0.0005218885637906116, "synch_env_connectors": 1.9226177016195933e-05}, "env_runners": {"module_to_env_connector": {"timers": {"connectors": {"remove_single_ts_time_rank_from_batch": 2.7360377429470375e-06, "listify_data_for_vector_env": 5.26074181974866e-05, "get_actions": 0.000207683795596376, "normalize_and_clip_actions": 3.101992664009313e-05, "tensor_to_numpy": 4.9106088348659254e-05, "un_batch_to_individual_items": 1.6024919765393908e-05}}, "connector_pipeline_timer": 0.00044495398044604894}, "env_step_timer": 5.674907226262396e-05, "env_to_module_connector": {"timers": {"connectors": {"numpy_to_tensor": 4.950407196832409e-05, "add_time_dim_to_batch_and_zero_pad": 7.643443279008627e-06, "add_observations_from_episodes_to_batch": 9.235000768584261e-06, "batch_individual_items": 2.4107958081996498e-05, "add_states_from_episodes_to_batch": 4.870683513963931e-06}}, "connector_pipeline_timer": 0.00016954117448578993}, "num_episodes_lifetime": -339125.0, "time_between_sampling": 0.005550438225175074, "num_agent_steps_sampled_lifetime": {"default_agent": -6782500.0}, "rlmodule_inference_timer": 0.00013653812499729082, "episode_return_mean": 2.899999999999998, "episode_len_mean": 20.0, "env_reset_timer": 0.00013674146391795826, "num_agent_steps_sampled": {"default_agent": 5000.0}, "num_env_steps_sampled_lifetime": -6782500.0, "episode_return_max": 6.5, "num_episodes": 250.0, "env_to_module_sum_episodes_length_in": 10.36823839457432, "module_episode_returns_mean": {"default_policy": 2.899999999999998}, "agent_episode_returns_mean": {"default_agent": 2.899999999999998}, "num_module_steps_sampled": {"default_policy": 5000.0}, "num_env_steps_sampled": 5000.0, "episode_duration_sec_mean": 0.019688779351301484, "episode_len_min": 20, "sample": 0.020531687961453358, "episode_return_min": -13.5, "weights_seq_no": 12.0, "env_to_module_sum_episodes_length_out": 10.36823839457432, "num_module_steps_sampled_lifetime": {"default_policy": -6782500.0}, "episode_len_max": 20, "num_env_steps_sampled_lifetime_throughput": 1657.3659293162943}, "learners": {"default_policy": {"num_module_steps_trained": 6000, "num_module_steps_trained_lifetime": 78000, "curr_entropy_coeff": 0.0090570820258, "policy_loss": 0.0031821199227124453, "total_loss": 0.06440390646457672, "weights_seq_no": 13.0, "default_optimizer_learning_rate": 0.0002847858517, "vf_loss_unclipped": 25.324901580810547, "entropy": 0.527543842792511, "gradients_default_optimizer_global_norm": 0.05305613577365875, "num_trainable_parameters": 6003, "mean_kl_loss": 0.000769394391681999, "module_train_batch_size_mean": 1000.0, "vf_loss": 0.09868254512548447, "diff_num_grad_updates_vs_sampler_policy": 1.0, "vf_explained_var": -0.009009599685668945, "curr_kl_coeff": 9.112503903452307e-05, "num_module_steps_trained_lifetime_throughput": 261398.93359346292}, "__all_modules__": {"learner_connector": {"timers": {"connectors": {"add_columns_from_episodes_to_train_batch": 0.10943786497504032, "add_time_dim_to_batch_and_zero_pad": 1.876659590752588e-05, "batch_individual_items": 0.060913122161419204, "add_states_from_episodes_to_batch": 4.8313797087100445e-06, "numpy_to_tensor": 0.00011338018060129981, "add_one_ts_to_episodes_and_truncate": 0.02755550712026017, "general_advantage_estimation": 0.00977093704124175, "add_observations_from_episodes_to_batch": 0.00122342336708026}}, "connector_pipeline_timer": 0.20948005510071682}, "num_trainable_parameters": 6003, "learner_connector_sum_episodes_length_in": 5000.0, "learner_connector_sum_episodes_length_out": 5250.0, "num_env_steps_trained": 31500, "num_module_steps_trained": 6000, "num_module_steps_trained_lifetime": 78000, "num_non_trainable_parameters": 0, "num_env_steps_trained_lifetime": 409500, "num_env_steps_trained_lifetime_throughput": 1360910.7708454882, "num_module_steps_trained_throughput": 260740.73211938786, "num_module_steps_trained_lifetime_throughput": 260185.71937885377}}, "num_training_step_calls_per_iteration": 1, "evaluation": {"env_runners": {"env_step_timer": 4.755744606578611e-05, "num_episodes_lifetime": 260, "env_reset_timer": 0.001056729628381519, "num_env_steps_sampled_lifetime": 65400, "env_to_module_connector": {"timers": {"connectors": {"add_observations_from_episodes_to_batch": 7.259546508451967e-06, "add_states_from_episodes_to_batch": 3.7000936109570764e-06, "numpy_to_tensor": 2.2799930409756725e-05, "batch_individual_items": 2.649333018885819e-05, "add_time_dim_to_batch_and_zero_pad": 8.479585426193995e-06}}, "connector_pipeline_timer": 0.0001255261748529358}, "num_agent_steps_sampled": {"default_agent": 400}, "episode_len_min": 20, "sample": 0.3522662030968369, "module_to_env_connector": {"timers": {"connectors": {"get_actions": 0.00018942352386039889, "un_batch_to_individual_items": 1.635197082268402e-05, "remove_single_ts_time_rank_from_batch": 1.622526069048426e-06, "listify_data_for_vector_env": 3.400182330112389e-05, "tensor_to_numpy": 3.677843055982941e-05, "normalize_and_clip_actions": 2.1661006667981283e-05}}, "connector_pipeline_timer": 0.00038045629881998454}, "episode_return_min": -13.5, "env_to_module_sum_episodes_length_out": 10.368238394574323, "rlmodule_inference_timer": 0.00010621666547699748, "num_agent_steps_sampled_lifetime": {"default_agent": 5200}, "episode_duration_sec_mean": 0.016603872133418917, "module_episode_returns_mean": {"default_policy": 2.8}, "agent_episode_returns_mean": {"default_agent": 2.8}, "num_module_steps_sampled": {"default_policy": 400}, "episode_return_max": 13.5, "num_episodes": 20, "env_to_module_sum_episodes_length_in": 10.368238394574323, "num_env_steps_sampled": 400, "weights_seq_no": 13.0, "episode_return_mean": 2.8, "episode_len_mean": 20.0, "num_module_steps_sampled_lifetime": {"default_policy": 5200}, "episode_len_max": 20, "time_between_sampling": 6.225115419714928}, "num_healthy_workers": 1, "actor_manager_num_outstanding_async_reqs": 0, "num_remote_worker_restarts": 0}, "num_env_steps_sampled_lifetime": -6782500.0, "fault_tolerance": {"num_healthy_workers": 0, "num_remote_worker_restarts": 0}, "env_runner_group": {"actor_manager_num_outstanding_async_reqs": 0}, "done": false, "training_iteration": 13, "trial_id": "4995b_00000", "date": "2025-08-11_19-26-58", "timestamp": 1754933218, "time_this_iter_s": 6.638200998306274, "time_total_s": 99.73717045783997, "pid": 14987, "hostname": "Mac", "node_ip": "127.0.0.1", "config": {"exploration_config": {}, "extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "placement_strategy": "PACK", "num_gpus": 0, "_fake_gpus": false, "num_cpus_for_main_process": 2, "eager_tracing": true, "eager_max_retraces": 20, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "torch_compile_learner": false, "torch_compile_learner_what_to_compile": "forward_train", "torch_compile_learner_dynamo_backend": "aot_eager", "torch_compile_learner_dynamo_mode": null, "torch_compile_worker": false, "torch_compile_worker_dynamo_backend": "aot_eager", "torch_compile_worker_dynamo_mode": null, "torch_ddp_kwargs": {}, "torch_skip_nan_gradients": false, "env": "Umbrella", "env_config": {}, "observation_space": null, "action_space": null, "clip_rewards": null, "normalize_actions": true, "clip_actions": false, "_is_atari": null, "disable_env_checking": false, "render_env": false, "action_mask_key": "action_mask", "env_runner_cls": null, "num_env_runners": 0, "create_local_env_runner": true, "num_envs_per_env_runner": 1, "gym_env_vectorize_mode": "SYNC", "num_cpus_per_env_runner": 1, "num_gpus_per_env_runner": 0, "custom_resources_per_env_runner": {}, "validate_env_runners_after_construction": true, "episodes_to_numpy": true, "max_requests_in_flight_per_env_runner": 1, "sample_timeout_s": 60.0, "_env_to_module_connector": null, "add_default_connectors_to_env_to_module_pipeline": true, "_module_to_env_connector": null, "add_default_connectors_to_module_to_env_pipeline": true, "merge_env_runner_states": "training_only", "broadcast_env_runner_states": true, "episode_lookback_horizon": 1, "rollout_fragment_length": "auto", "batch_mode": "complete_episodes", "compress_observations": false, "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "enable_tf1_exec_eagerly": false, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "preprocessor_pref": "deepmind", "observation_filter": "NoFilter", "update_worker_filter_stats": true, "use_worker_filter_stats": true, "sampler_perf_stats_ema_coef": null, "_is_online": true, "num_learners": 0, "num_gpus_per_learner": 0, "num_cpus_per_learner": "auto", "num_aggregator_actors_per_learner": 0, "max_requests_in_flight_per_aggregator_actor": 3, "local_gpu_idx": 0, "max_requests_in_flight_per_learner": 3, "gamma": 1, "lr": 0.0002847858517, "grad_clip": 0.5, "grad_clip_by": "global_norm", "_train_batch_size_per_learner": 5000, "train_batch_size": 4000, "num_epochs": 1, "minibatch_size": 1000, "shuffle_batch_per_epoch": true, "model": {"fcnet_hiddens": [256, 256], "fcnet_activation": "tanh", "fcnet_weights_initializer": null, "fcnet_weights_initializer_config": null, "fcnet_bias_initializer": null, "fcnet_bias_initializer_config": null, "conv_filters": null, "conv_activation": "relu", "conv_kernel_initializer": null, "conv_kernel_initializer_config": null, "conv_bias_initializer": null, "conv_bias_initializer_config": null, "conv_transpose_kernel_initializer": null, "conv_transpose_kernel_initializer_config": null, "conv_transpose_bias_initializer": null, "conv_transpose_bias_initializer_config": null, "post_fcnet_hiddens": [], "post_fcnet_activation": "relu", "post_fcnet_weights_initializer": null, "post_fcnet_weights_initializer_config": null, "post_fcnet_bias_initializer": null, "post_fcnet_bias_initializer_config": null, "free_log_std": false, "log_std_clip_param": 20.0, "no_final_linear": false, "vf_share_layers": false, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "lstm_weights_initializer": null, "lstm_weights_initializer_config": null, "lstm_bias_initializer": null, "lstm_bias_initializer_config": null, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "attention_use_n_prev_actions": 0, "attention_use_n_prev_rewards": 0, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": null, "custom_model_config": {}, "custom_action_dist": null, "custom_preprocessor": null, "encoder_latent_dim": null, "always_check_shapes": false, "lstm_use_prev_action_reward": -1, "_use_default_native_models": -1, "_disable_preprocessor_api": false, "_disable_action_flattening": false}, "_learner_connector": null, "add_default_connectors_to_learner_pipeline": true, "learner_config_dict": {}, "optimizer": {}, "_learner_class": null, "callbacks_on_algorithm_init": null, "callbacks_on_env_runners_recreated": null, "callbacks_on_offline_eval_runners_recreated": null, "callbacks_on_checkpoint_loaded": null, "callbacks_on_environment_created": null, "callbacks_on_episode_created": null, "callbacks_on_episode_start": null, "callbacks_on_episode_step": null, "callbacks_on_episode_end": null, "callbacks_on_evaluate_start": null, "callbacks_on_evaluate_end": null, "callbacks_on_evaluate_offline_start": null, "callbacks_on_evaluate_offline_end": null, "callbacks_on_sample_end": null, "callbacks_on_train_result": null, "explore": true, "enable_rl_module_and_learner": true, "enable_env_runner_and_connector_v2": true, "_prior_exploration_config": {"type": "StochasticSampling"}, "count_steps_by": "env_steps", "policy_map_capacity": 100, "policy_mapping_fn": "<function AlgorithmConfig.DEFAULT_POLICY_MAPPING_FN at 0x3867f18a0>", "policies_to_train": null, "policy_states_are_swappable": false, "observation_fn": null, "offline_data_class": null, "input_read_method": "read_parquet", "input_read_method_kwargs": {}, "input_read_schema": {}, "input_read_episodes": false, "input_read_sample_batches": false, "input_read_batch_size": null, "input_filesystem": null, "input_filesystem_kwargs": {}, "input_compress_columns": ["obs", "new_obs"], "input_spaces_jsonable": true, "materialize_data": false, "materialize_mapped_data": true, "map_batches_kwargs": {}, "iter_batches_kwargs": {}, "ignore_final_observation": false, "prelearner_class": null, "prelearner_buffer_class": null, "prelearner_buffer_kwargs": {}, "prelearner_module_synch_period": 10, "dataset_num_iters_per_learner": null, "input_config": {}, "actions_in_input_normalized": false, "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_config": {}, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "output_max_rows_per_file": null, "output_write_remaining_data": false, "output_write_method": "write_parquet", "output_write_method_kwargs": {}, "output_filesystem": null, "output_filesystem_kwargs": {}, "output_write_episodes": true, "offline_sampling": false, "evaluation_interval": 1, "evaluation_duration": 20, "evaluation_duration_unit": "episodes", "evaluation_sample_timeout_s": 120.0, "evaluation_auto_duration_min_env_steps_per_sample": 100, "evaluation_auto_duration_max_env_steps_per_sample": 2000, "evaluation_parallel_to_training": false, "evaluation_force_reset_envs_before_iteration": true, "evaluation_config": null, "off_policy_estimation_methods": {}, "ope_split_batch_by_episode": true, "evaluation_num_env_runners": 1, "in_evaluation": false, "sync_filters_on_rollout_workers_timeout_s": 10.0, "offline_evaluation_interval": null, "num_offline_eval_runners": 0, "offline_loss_for_module_fn": null, "offline_evaluation_duration": 1, "offline_evaluation_parallel_to_training": false, "offline_evaluation_timeout_s": 120.0, "num_cpus_per_offline_eval_runner": 1, "num_gpus_per_offline_eval_runner": 0, "custom_resources_per_offline_eval_runner": {}, "restart_failed_offline_eval_runners": true, "ignore_offline_eval_runner_failures": false, "max_num_offline_eval_runner_restarts": 1000, "offline_eval_runner_restore_timeout_s": 1800.0, "max_requests_in_flight_per_offline_eval_runner": 1, "validate_offline_eval_runners_after_construction": true, "offline_eval_runner_health_probe_timeout_s": 30.0, "offline_eval_rl_module_inference_only": false, "broadcast_offline_eval_runner_states": false, "offline_eval_batch_size_per_runner": 256, "dataset_num_iters_per_eval_runner": 1, "keep_per_episode_custom_metrics": false, "metrics_episode_collection_timeout_s": 60.0, "metrics_num_episodes_for_smoothing": 100, "min_time_s_per_iteration": null, "min_train_timesteps_per_iteration": 0, "min_sample_timesteps_per_iteration": 0, "log_gradients": true, "export_native_model_files": false, "checkpoint_trainable_policies_only": false, "logger_creator": null, "logger_config": null, "log_level": "WARN", "log_sys_usage": true, "fake_sampler": false, "seed": 3, "restart_failed_env_runners": true, "ignore_env_runner_failures": false, "max_num_env_runner_restarts": 1000, "delay_between_env_runner_restarts_s": 60.0, "restart_failed_sub_environments": false, "num_consecutive_env_runner_failures_tolerance": 100, "env_runner_health_probe_timeout_s": 30.0, "env_runner_restore_timeout_s": 1800.0, "_model_config": {}, "_rl_module_spec": "RLModuleSpec(module_class=None, observation_space=None, action_space=None, inference_only=False, learner_only=False, model_config=DefaultModelConfig(fcnet_hiddens=[60, 90], fcnet_activation='tanh', fcnet_kernel_initializer=None, fcnet_kernel_initializer_kwargs=None, fcnet_bias_initializer=None, fcnet_bias_initializer_kwargs=None, conv_filters=None, conv_activation='relu', conv_kernel_initializer=None, conv_kernel_initializer_kwargs=None, conv_bias_initializer=None, conv_bias_initializer_kwargs=None, head_fcnet_hiddens=[], head_fcnet_activation='relu', head_fcnet_kernel_initializer=None, head_fcnet_kernel_initializer_kwargs=None, head_fcnet_bias_initializer=None, head_fcnet_bias_initializer_kwargs=None, free_log_std=False, log_std_clip_param=20.0, vf_share_layers=True, use_lstm=False, max_seq_len=20, lstm_cell_size=256, lstm_use_prev_action=False, lstm_use_prev_reward=False, lstm_kernel_initializer=None, lstm_kernel_initializer_kwargs=None, lstm_bias_initializer=None, lstm_bias_initializer_kwargs=None), catalog_class=None, load_state_path=None, model_config_dict=None)", "algorithm_config_overrides_per_module": {}, "_per_module_overrides": {}, "_validate_config": true, "_use_msgpack_checkpoints": false, "_torch_grad_scaler_class": null, "_torch_lr_scheduler_classes": null, "_tf_policy_handles_more_than_one_loss": false, "_disable_preprocessor_api": false, "_disable_action_flattening": false, "_disable_initialize_loss_from_dummy_batch": false, "_dont_auto_sync_env_runner_states": false, "env_task_fn": -1, "enable_connectors": -1, "simple_optimizer": false, "policy_map_cache": -1, "worker_cls": -1, "synchronize_filters": -1, "enable_async_evaluation": -1, "custom_async_evaluation_function": -1, "_enable_rl_module_api": -1, "auto_wrap_old_gym_envs": -1, "always_attach_evaluation_results": -1, "replay_sequence_length": null, "_disable_execution_plan_api": -1, "use_critic": true, "use_gae": true, "use_kl_loss": true, "kl_coeff": 0.7464963036515, "kl_target": 0.0270990929592, "vf_loss_coeff": 0.6688075857018, "entropy_coeff": 0.0090570820258, "clip_param": 0.1221781641624, "vf_clip_param": 0.1027808522125, "entropy_coeff_schedule": null, "lr_schedule": null, "sgd_minibatch_size": -1, "vf_share_layers": -1, "__stdout_file__": null, "__stderr_file__": null, "lambda": 0.9099046732075, "input": "sampler", "policies": {"default_policy": [null, null, null, null]}, "callbacks": "<class 'ray.rllib.callbacks.callbacks.RLlibCallback'>", "create_env_on_driver": false, "custom_eval_function": null, "framework": "torch"}, "time_since_restore": 99.73717045783997, "iterations_since_restore": 13, "perf": {"cpu_util_percent": 90.73333333333333, "ram_util_percent": 82.38888888888889}}
{"timers": {"training_iteration": 6.864250774853684, "restore_env_runners": 4.334078224098654e-05, "training_step": 6.8637298350535625, "env_runner_sampling_timer": 6.527452059790756, "learner_update_timer": 0.32738904827063636, "synch_weights": 0.0018858083877785414, "restore_eval_env_runners": 1.767388922510021e-05, "evaluation_iteration": 0.38121513222045716, "synch_eval_env_connectors": 0.00051782217819726, "synch_env_connectors": 1.9075575633102958e-05}, "env_runners": {"module_to_env_connector": {"timers": {"connectors": {"remove_single_ts_time_rank_from_batch": 1.9684790947767856e-06, "listify_data_for_vector_env": 4.631716624772262e-05, "get_actions": 0.00017826023876909547, "normalize_and_clip_actions": 4.007055655546171e-05, "tensor_to_numpy": 4.806022261433361e-05, "un_batch_to_individual_items": 1.6178062429810192e-05}}, "connector_pipeline_timer": 0.000410875763879781}, "env_step_timer": 5.2415181352796074e-05, "env_to_module_connector": {"timers": {"connectors": {"numpy_to_tensor": 3.570062804923671e-05, "add_time_dim_to_batch_and_zero_pad": 7.17184854306426e-06, "add_observations_from_episodes_to_batch": 8.339101609627373e-06, "batch_individual_items": 1.972120975371893e-05, "add_states_from_episodes_to_batch": 4.044254360477856e-06}}, "connector_pipeline_timer": 0.00013581551075244198}, "num_episodes_lifetime": -370000.0, "time_between_sampling": 0.005219974715031597, "num_agent_steps_sampled_lifetime": {"default_agent": -7400000.0}, "rlmodule_inference_timer": 0.0001223774682081046, "episode_return_mean": 3.9399999999999995, "episode_len_mean": 20.0, "env_reset_timer": 0.0003870220612588542, "num_agent_steps_sampled": {"default_agent": 5000.0}, "num_env_steps_sampled_lifetime": -7400000.0, "episode_return_max": 6.5, "num_episodes": 250.0, "env_to_module_sum_episodes_length_in": 10.36823839457432, "module_episode_returns_mean": {"default_policy": 3.9399999999999995}, "agent_episode_returns_mean": {"default_agent": 3.9399999999999995}, "num_module_steps_sampled": {"default_policy": 5000.0}, "num_env_steps_sampled": 5000.0, "episode_duration_sec_mean": 0.017079303836449983, "episode_len_min": 20, "sample": 0.019459930370137872, "episode_return_min": -13.5, "weights_seq_no": 13.0, "env_to_module_sum_episodes_length_out": 10.36823839457432, "num_module_steps_sampled_lifetime": {"default_policy": -7400000.0}, "episode_len_max": 20, "num_env_steps_sampled_lifetime_throughput": 1769.4185471424885}, "learners": {"default_policy": {"num_module_steps_trained": 6000, "num_module_steps_trained_lifetime": 84000, "curr_entropy_coeff": 0.0090570820258, "policy_loss": -0.02879970334470272, "total_loss": 0.032381489872932434, "weights_seq_no": 14.0, "default_optimizer_learning_rate": 0.0002847858517, "vf_loss_unclipped": 24.430038452148438, "entropy": 0.5081238746643066, "gradients_default_optimizer_global_norm": 0.06801996380090714, "num_trainable_parameters": 6003, "mean_kl_loss": 0.0006089486996643245, "module_train_batch_size_mean": 1000.0, "vf_loss": 0.09835900366306305, "diff_num_grad_updates_vs_sampler_policy": 1.0, "vf_explained_var": -0.007025957107543945, "curr_kl_coeff": 4.5562519517261535e-05, "num_module_steps_trained_lifetime_throughput": 259035.0045235183}, "__all_modules__": {"learner_connector": {"timers": {"connectors": {"add_columns_from_episodes_to_train_batch": 0.10887333673465611, "add_time_dim_to_batch_and_zero_pad": 1.87310195814982e-05, "batch_individual_items": 0.06421747719048122, "add_states_from_episodes_to_batch": 4.819315314533415e-06, "numpy_to_tensor": 0.00011305220914543251, "add_one_ts_to_episodes_and_truncate": 0.02737942746890486, "general_advantage_estimation": 0.009751335170114003, "add_observations_from_episodes_to_batch": 0.001227707883171784}}, "connector_pipeline_timer": 0.212025278720222}, "num_trainable_parameters": 6003, "learner_connector_sum_episodes_length_in": 5000.0, "learner_connector_sum_episodes_length_out": 5250.0, "num_env_steps_trained": 31500, "num_module_steps_trained": 6000, "num_module_steps_trained_lifetime": 84000, "num_non_trainable_parameters": 0, "num_env_steps_trained_lifetime": 441000, "num_env_steps_trained_lifetime_throughput": 1348870.6578101018, "num_module_steps_trained_throughput": 258414.58702361243, "num_module_steps_trained_lifetime_throughput": 257859.66212621387}}, "num_training_step_calls_per_iteration": 1, "evaluation": {"env_runners": {"env_step_timer": 0.00011303183602819071, "num_episodes_lifetime": 280, "env_reset_timer": 0.0010486481717477388, "num_env_steps_sampled_lifetime": 70400, "env_to_module_connector": {"timers": {"connectors": {"add_observations_from_episodes_to_batch": 8.939466978821116e-06, "add_states_from_episodes_to_batch": 1.129927723428614e-05, "numpy_to_tensor": 3.9020322256946824e-05, "batch_individual_items": 2.3731538225252036e-05, "add_time_dim_to_batch_and_zero_pad": 6.373993091260746e-06}}, "connector_pipeline_timer": 0.00015171454116057136}, "num_agent_steps_sampled": {"default_agent": 400}, "episode_len_min": 20, "sample": 0.3540048789754833, "module_to_env_connector": {"timers": {"connectors": {"get_actions": 0.0001706817657554979, "un_batch_to_individual_items": 1.594960381223566e-05, "remove_single_ts_time_rank_from_batch": 1.29605385090138e-06, "listify_data_for_vector_env": 6.013026082910263e-05, "tensor_to_numpy": 4.2501583116824404e-05, "normalize_and_clip_actions": 2.4218780901511075e-05}}, "connector_pipeline_timer": 0.0004056995012842959}, "episode_return_min": -12.5, "env_to_module_sum_episodes_length_out": 10.368238394574323, "rlmodule_inference_timer": 8.868944289683407e-05, "num_agent_steps_sampled_lifetime": {"default_agent": 5600}, "episode_duration_sec_mean": 0.01845235545770265, "module_episode_returns_mean": {"default_policy": 3.6}, "agent_episode_returns_mean": {"default_agent": 3.6}, "num_module_steps_sampled": {"default_policy": 400}, "episode_return_max": 13.5, "num_episodes": 20, "env_to_module_sum_episodes_length_in": 10.368238394574323, "num_env_steps_sampled": 400, "weights_seq_no": 14.0, "episode_return_mean": 3.6, "episode_len_mean": 20.0, "num_module_steps_sampled_lifetime": {"default_policy": 5600}, "episode_len_max": 20, "time_between_sampling": 6.219596434687479}, "num_healthy_workers": 1, "actor_manager_num_outstanding_async_reqs": 0, "num_remote_worker_restarts": 0}, "num_env_steps_sampled_lifetime": -7400000.0, "fault_tolerance": {"num_healthy_workers": 0, "num_remote_worker_restarts": 0}, "env_runner_group": {"actor_manager_num_outstanding_async_reqs": 0}, "done": false, "training_iteration": 14, "trial_id": "4995b_00000", "date": "2025-08-11_19-27-04", "timestamp": 1754933224, "time_this_iter_s": 6.167827844619751, "time_total_s": 105.90499830245972, "pid": 14987, "hostname": "Mac", "node_ip": "127.0.0.1", "config": {"exploration_config": {}, "extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "placement_strategy": "PACK", "num_gpus": 0, "_fake_gpus": false, "num_cpus_for_main_process": 2, "eager_tracing": true, "eager_max_retraces": 20, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "torch_compile_learner": false, "torch_compile_learner_what_to_compile": "forward_train", "torch_compile_learner_dynamo_backend": "aot_eager", "torch_compile_learner_dynamo_mode": null, "torch_compile_worker": false, "torch_compile_worker_dynamo_backend": "aot_eager", "torch_compile_worker_dynamo_mode": null, "torch_ddp_kwargs": {}, "torch_skip_nan_gradients": false, "env": "Umbrella", "env_config": {}, "observation_space": null, "action_space": null, "clip_rewards": null, "normalize_actions": true, "clip_actions": false, "_is_atari": null, "disable_env_checking": false, "render_env": false, "action_mask_key": "action_mask", "env_runner_cls": null, "num_env_runners": 0, "create_local_env_runner": true, "num_envs_per_env_runner": 1, "gym_env_vectorize_mode": "SYNC", "num_cpus_per_env_runner": 1, "num_gpus_per_env_runner": 0, "custom_resources_per_env_runner": {}, "validate_env_runners_after_construction": true, "episodes_to_numpy": true, "max_requests_in_flight_per_env_runner": 1, "sample_timeout_s": 60.0, "_env_to_module_connector": null, "add_default_connectors_to_env_to_module_pipeline": true, "_module_to_env_connector": null, "add_default_connectors_to_module_to_env_pipeline": true, "merge_env_runner_states": "training_only", "broadcast_env_runner_states": true, "episode_lookback_horizon": 1, "rollout_fragment_length": "auto", "batch_mode": "complete_episodes", "compress_observations": false, "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "enable_tf1_exec_eagerly": false, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "preprocessor_pref": "deepmind", "observation_filter": "NoFilter", "update_worker_filter_stats": true, "use_worker_filter_stats": true, "sampler_perf_stats_ema_coef": null, "_is_online": true, "num_learners": 0, "num_gpus_per_learner": 0, "num_cpus_per_learner": "auto", "num_aggregator_actors_per_learner": 0, "max_requests_in_flight_per_aggregator_actor": 3, "local_gpu_idx": 0, "max_requests_in_flight_per_learner": 3, "gamma": 1, "lr": 0.0002847858517, "grad_clip": 0.5, "grad_clip_by": "global_norm", "_train_batch_size_per_learner": 5000, "train_batch_size": 4000, "num_epochs": 1, "minibatch_size": 1000, "shuffle_batch_per_epoch": true, "model": {"fcnet_hiddens": [256, 256], "fcnet_activation": "tanh", "fcnet_weights_initializer": null, "fcnet_weights_initializer_config": null, "fcnet_bias_initializer": null, "fcnet_bias_initializer_config": null, "conv_filters": null, "conv_activation": "relu", "conv_kernel_initializer": null, "conv_kernel_initializer_config": null, "conv_bias_initializer": null, "conv_bias_initializer_config": null, "conv_transpose_kernel_initializer": null, "conv_transpose_kernel_initializer_config": null, "conv_transpose_bias_initializer": null, "conv_transpose_bias_initializer_config": null, "post_fcnet_hiddens": [], "post_fcnet_activation": "relu", "post_fcnet_weights_initializer": null, "post_fcnet_weights_initializer_config": null, "post_fcnet_bias_initializer": null, "post_fcnet_bias_initializer_config": null, "free_log_std": false, "log_std_clip_param": 20.0, "no_final_linear": false, "vf_share_layers": false, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "lstm_weights_initializer": null, "lstm_weights_initializer_config": null, "lstm_bias_initializer": null, "lstm_bias_initializer_config": null, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "attention_use_n_prev_actions": 0, "attention_use_n_prev_rewards": 0, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": null, "custom_model_config": {}, "custom_action_dist": null, "custom_preprocessor": null, "encoder_latent_dim": null, "always_check_shapes": false, "lstm_use_prev_action_reward": -1, "_use_default_native_models": -1, "_disable_preprocessor_api": false, "_disable_action_flattening": false}, "_learner_connector": null, "add_default_connectors_to_learner_pipeline": true, "learner_config_dict": {}, "optimizer": {}, "_learner_class": null, "callbacks_on_algorithm_init": null, "callbacks_on_env_runners_recreated": null, "callbacks_on_offline_eval_runners_recreated": null, "callbacks_on_checkpoint_loaded": null, "callbacks_on_environment_created": null, "callbacks_on_episode_created": null, "callbacks_on_episode_start": null, "callbacks_on_episode_step": null, "callbacks_on_episode_end": null, "callbacks_on_evaluate_start": null, "callbacks_on_evaluate_end": null, "callbacks_on_evaluate_offline_start": null, "callbacks_on_evaluate_offline_end": null, "callbacks_on_sample_end": null, "callbacks_on_train_result": null, "explore": true, "enable_rl_module_and_learner": true, "enable_env_runner_and_connector_v2": true, "_prior_exploration_config": {"type": "StochasticSampling"}, "count_steps_by": "env_steps", "policy_map_capacity": 100, "policy_mapping_fn": "<function AlgorithmConfig.DEFAULT_POLICY_MAPPING_FN at 0x3867f18a0>", "policies_to_train": null, "policy_states_are_swappable": false, "observation_fn": null, "offline_data_class": null, "input_read_method": "read_parquet", "input_read_method_kwargs": {}, "input_read_schema": {}, "input_read_episodes": false, "input_read_sample_batches": false, "input_read_batch_size": null, "input_filesystem": null, "input_filesystem_kwargs": {}, "input_compress_columns": ["obs", "new_obs"], "input_spaces_jsonable": true, "materialize_data": false, "materialize_mapped_data": true, "map_batches_kwargs": {}, "iter_batches_kwargs": {}, "ignore_final_observation": false, "prelearner_class": null, "prelearner_buffer_class": null, "prelearner_buffer_kwargs": {}, "prelearner_module_synch_period": 10, "dataset_num_iters_per_learner": null, "input_config": {}, "actions_in_input_normalized": false, "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_config": {}, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "output_max_rows_per_file": null, "output_write_remaining_data": false, "output_write_method": "write_parquet", "output_write_method_kwargs": {}, "output_filesystem": null, "output_filesystem_kwargs": {}, "output_write_episodes": true, "offline_sampling": false, "evaluation_interval": 1, "evaluation_duration": 20, "evaluation_duration_unit": "episodes", "evaluation_sample_timeout_s": 120.0, "evaluation_auto_duration_min_env_steps_per_sample": 100, "evaluation_auto_duration_max_env_steps_per_sample": 2000, "evaluation_parallel_to_training": false, "evaluation_force_reset_envs_before_iteration": true, "evaluation_config": null, "off_policy_estimation_methods": {}, "ope_split_batch_by_episode": true, "evaluation_num_env_runners": 1, "in_evaluation": false, "sync_filters_on_rollout_workers_timeout_s": 10.0, "offline_evaluation_interval": null, "num_offline_eval_runners": 0, "offline_loss_for_module_fn": null, "offline_evaluation_duration": 1, "offline_evaluation_parallel_to_training": false, "offline_evaluation_timeout_s": 120.0, "num_cpus_per_offline_eval_runner": 1, "num_gpus_per_offline_eval_runner": 0, "custom_resources_per_offline_eval_runner": {}, "restart_failed_offline_eval_runners": true, "ignore_offline_eval_runner_failures": false, "max_num_offline_eval_runner_restarts": 1000, "offline_eval_runner_restore_timeout_s": 1800.0, "max_requests_in_flight_per_offline_eval_runner": 1, "validate_offline_eval_runners_after_construction": true, "offline_eval_runner_health_probe_timeout_s": 30.0, "offline_eval_rl_module_inference_only": false, "broadcast_offline_eval_runner_states": false, "offline_eval_batch_size_per_runner": 256, "dataset_num_iters_per_eval_runner": 1, "keep_per_episode_custom_metrics": false, "metrics_episode_collection_timeout_s": 60.0, "metrics_num_episodes_for_smoothing": 100, "min_time_s_per_iteration": null, "min_train_timesteps_per_iteration": 0, "min_sample_timesteps_per_iteration": 0, "log_gradients": true, "export_native_model_files": false, "checkpoint_trainable_policies_only": false, "logger_creator": null, "logger_config": null, "log_level": "WARN", "log_sys_usage": true, "fake_sampler": false, "seed": 3, "restart_failed_env_runners": true, "ignore_env_runner_failures": false, "max_num_env_runner_restarts": 1000, "delay_between_env_runner_restarts_s": 60.0, "restart_failed_sub_environments": false, "num_consecutive_env_runner_failures_tolerance": 100, "env_runner_health_probe_timeout_s": 30.0, "env_runner_restore_timeout_s": 1800.0, "_model_config": {}, "_rl_module_spec": "RLModuleSpec(module_class=None, observation_space=None, action_space=None, inference_only=False, learner_only=False, model_config=DefaultModelConfig(fcnet_hiddens=[60, 90], fcnet_activation='tanh', fcnet_kernel_initializer=None, fcnet_kernel_initializer_kwargs=None, fcnet_bias_initializer=None, fcnet_bias_initializer_kwargs=None, conv_filters=None, conv_activation='relu', conv_kernel_initializer=None, conv_kernel_initializer_kwargs=None, conv_bias_initializer=None, conv_bias_initializer_kwargs=None, head_fcnet_hiddens=[], head_fcnet_activation='relu', head_fcnet_kernel_initializer=None, head_fcnet_kernel_initializer_kwargs=None, head_fcnet_bias_initializer=None, head_fcnet_bias_initializer_kwargs=None, free_log_std=False, log_std_clip_param=20.0, vf_share_layers=True, use_lstm=False, max_seq_len=20, lstm_cell_size=256, lstm_use_prev_action=False, lstm_use_prev_reward=False, lstm_kernel_initializer=None, lstm_kernel_initializer_kwargs=None, lstm_bias_initializer=None, lstm_bias_initializer_kwargs=None), catalog_class=None, load_state_path=None, model_config_dict=None)", "algorithm_config_overrides_per_module": {}, "_per_module_overrides": {}, "_validate_config": true, "_use_msgpack_checkpoints": false, "_torch_grad_scaler_class": null, "_torch_lr_scheduler_classes": null, "_tf_policy_handles_more_than_one_loss": false, "_disable_preprocessor_api": false, "_disable_action_flattening": false, "_disable_initialize_loss_from_dummy_batch": false, "_dont_auto_sync_env_runner_states": false, "env_task_fn": -1, "enable_connectors": -1, "simple_optimizer": false, "policy_map_cache": -1, "worker_cls": -1, "synchronize_filters": -1, "enable_async_evaluation": -1, "custom_async_evaluation_function": -1, "_enable_rl_module_api": -1, "auto_wrap_old_gym_envs": -1, "always_attach_evaluation_results": -1, "replay_sequence_length": null, "_disable_execution_plan_api": -1, "use_critic": true, "use_gae": true, "use_kl_loss": true, "kl_coeff": 0.7464963036515, "kl_target": 0.0270990929592, "vf_loss_coeff": 0.6688075857018, "entropy_coeff": 0.0090570820258, "clip_param": 0.1221781641624, "vf_clip_param": 0.1027808522125, "entropy_coeff_schedule": null, "lr_schedule": null, "sgd_minibatch_size": -1, "vf_share_layers": -1, "__stdout_file__": null, "__stderr_file__": null, "lambda": 0.9099046732075, "input": "sampler", "policies": {"default_policy": [null, null, null, null]}, "callbacks": "<class 'ray.rllib.callbacks.callbacks.RLlibCallback'>", "create_env_on_driver": false, "custom_eval_function": null, "framework": "torch"}, "time_since_restore": 105.90499830245972, "iterations_since_restore": 14, "perf": {"cpu_util_percent": 88.41111111111111, "ram_util_percent": 82.31111111111112}}
{"timers": {"training_iteration": 6.8549427733555985, "restore_env_runners": 4.303528342512758e-05, "training_step": 6.854421177953057, "env_runner_sampling_timer": 6.517104026273368, "learner_update_timer": 0.32845247195731825, "synch_weights": 0.0018828807139096334, "restore_eval_env_runners": 1.7575070600207626e-05, "evaluation_iteration": 0.3828262996477791, "synch_eval_env_connectors": 0.0005137164558506825, "synch_env_connectors": 1.8933569956940175e-05}, "env_runners": {"module_to_env_connector": {"timers": {"connectors": {"remove_single_ts_time_rank_from_batch": 1.7128601386828093e-06, "listify_data_for_vector_env": 5.1078804205663707e-05, "get_actions": 0.000197932959677703, "normalize_and_clip_actions": 3.4068099175994667e-05, "tensor_to_numpy": 5.8686965305731365e-05, "un_batch_to_individual_items": 1.8981647086061224e-05}}, "connector_pipeline_timer": 0.00043492157862113685}, "env_step_timer": 8.49928475931292e-05, "env_to_module_connector": {"timers": {"connectors": {"numpy_to_tensor": 4.035274172048058e-05, "add_time_dim_to_batch_and_zero_pad": 7.173471605209142e-06, "add_observations_from_episodes_to_batch": 8.492466686188877e-06, "batch_individual_items": 2.47686616532493e-05, "add_states_from_episodes_to_batch": 4.386556887199522e-06}}, "connector_pipeline_timer": 0.00014739559318223145}, "num_episodes_lifetime": -400875.0, "time_between_sampling": 0.006380133587104296, "num_agent_steps_sampled_lifetime": {"default_agent": -8017500.0}, "rlmodule_inference_timer": 0.00012203319144134258, "episode_return_mean": 3.7, "episode_len_mean": 20.0, "env_reset_timer": 0.0002345374820690799, "num_agent_steps_sampled": {"default_agent": 5000.0}, "num_env_steps_sampled_lifetime": -8017500.0, "episode_return_max": 6.5, "num_episodes": 250.0, "env_to_module_sum_episodes_length_in": 10.36823839457432, "module_episode_returns_mean": {"default_policy": 3.7}, "agent_episode_returns_mean": {"default_agent": 3.7}, "num_module_steps_sampled": {"default_policy": 5000.0}, "num_env_steps_sampled": 5000.0, "episode_duration_sec_mean": 0.01848352226894348, "episode_len_min": 20, "sample": 0.0197082668825372, "episode_return_min": -13.5, "weights_seq_no": 14.0, "env_to_module_sum_episodes_length_out": 10.36823839457432, "num_module_steps_sampled_lifetime": {"default_policy": -8017500.0}, "episode_len_max": 20, "num_env_steps_sampled_lifetime_throughput": 1681.3147753574376}, "learners": {"default_policy": {"num_module_steps_trained": 6000, "num_module_steps_trained_lifetime": 90000, "curr_entropy_coeff": 0.0090570820258, "policy_loss": -0.09887556731700897, "total_loss": -0.03771353140473366, "weights_seq_no": 15.0, "default_optimizer_learning_rate": 0.0002847858517, "vf_loss_unclipped": 24.126394271850586, "entropy": 0.5022678375244141, "gradients_default_optimizer_global_norm": 0.09681214392185211, "num_trainable_parameters": 6003, "mean_kl_loss": 3.665469921543263e-05, "module_train_batch_size_mean": 1000.0, "vf_loss": 0.09825114160776138, "diff_num_grad_updates_vs_sampler_policy": 1.0, "vf_explained_var": -0.0060272216796875, "curr_kl_coeff": 2.2781259758630767e-05, "num_module_steps_trained_lifetime_throughput": 255812.35421460672}, "__all_modules__": {"learner_connector": {"timers": {"connectors": {"add_columns_from_episodes_to_train_batch": 0.10823107627800806, "add_time_dim_to_batch_and_zero_pad": 1.8740799361383e-05, "batch_individual_items": 0.0667180490892137, "add_states_from_episodes_to_batch": 4.816952545284908e-06, "numpy_to_tensor": 0.00011453793631167685, "add_one_ts_to_episodes_and_truncate": 0.027263342773432127, "general_advantage_estimation": 0.00977691473823378, "add_observations_from_episodes_to_batch": 0.0012281503843123928}}, "connector_pipeline_timer": 0.2137926346828118}, "num_trainable_parameters": 6003, "learner_connector_sum_episodes_length_in": 5000.0, "learner_connector_sum_episodes_length_out": 5250.0, "num_env_steps_trained": 31500, "num_module_steps_trained": 6000, "num_module_steps_trained_lifetime": 90000, "num_non_trainable_parameters": 0, "num_env_steps_trained_lifetime": 472500, "num_env_steps_trained_lifetime_throughput": 1332385.2948309344, "num_module_steps_trained_throughput": 255228.288323577, "num_module_steps_trained_lifetime_throughput": 254681.70217632994}}, "num_training_step_calls_per_iteration": 1, "evaluation": {"env_runners": {"env_step_timer": 2.630705925521539e-05, "num_episodes_lifetime": 300, "env_reset_timer": 0.0010430087700113797, "num_env_steps_sampled_lifetime": 75400, "env_to_module_connector": {"timers": {"connectors": {"add_observations_from_episodes_to_batch": 4.194832200663883e-06, "add_states_from_episodes_to_batch": 2.37425615063376e-06, "numpy_to_tensor": 1.854375601386606e-05, "batch_individual_items": 1.3166117240159498e-05, "add_time_dim_to_batch_and_zero_pad": 3.6615186274737624e-06}}, "connector_pipeline_timer": 7.86654317099253e-05}, "num_agent_steps_sampled": {"default_agent": 400}, "episode_len_min": 20, "sample": 0.35289806518491756, "module_to_env_connector": {"timers": {"connectors": {"get_actions": 7.442629496661702e-05, "un_batch_to_individual_items": 8.064186324743848e-06, "remove_single_ts_time_rank_from_batch": 3.3506289830947126e-06, "listify_data_for_vector_env": 2.292421283034655e-05, "tensor_to_numpy": 2.217605651708626e-05, "normalize_and_clip_actions": 1.506559762796975e-05}}, "connector_pipeline_timer": 0.00018943726191046118}, "episode_return_min": -12.5, "env_to_module_sum_episodes_length_out": 10.368238394574323, "rlmodule_inference_timer": 4.9488375398812016e-05, "num_agent_steps_sampled_lifetime": {"default_agent": 6000}, "episode_duration_sec_mean": 0.016998027522349732, "module_episode_returns_mean": {"default_policy": 3.4}, "agent_episode_returns_mean": {"default_agent": 3.4}, "num_module_steps_sampled": {"default_policy": 400}, "episode_return_max": 13.5, "num_episodes": 20, "env_to_module_sum_episodes_length_in": 10.368238394574323, "num_env_steps_sampled": 400, "weights_seq_no": 15.0, "episode_return_mean": 3.4, "episode_len_mean": 20.0, "num_module_steps_sampled_lifetime": {"default_policy": 6000}, "episode_len_max": 20, "time_between_sampling": 6.217399800340159}, "num_healthy_workers": 1, "actor_manager_num_outstanding_async_reqs": 0, "num_remote_worker_restarts": 0}, "num_env_steps_sampled_lifetime": -8017500.0, "fault_tolerance": {"num_healthy_workers": 0, "num_remote_worker_restarts": 0}, "env_runner_group": {"actor_manager_num_outstanding_async_reqs": 0}, "done": false, "training_iteration": 15, "trial_id": "4995b_00000", "date": "2025-08-11_19-27-10", "timestamp": 1754933230, "time_this_iter_s": 6.193778038024902, "time_total_s": 112.09877634048462, "pid": 14987, "hostname": "Mac", "node_ip": "127.0.0.1", "config": {"exploration_config": {}, "extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "placement_strategy": "PACK", "num_gpus": 0, "_fake_gpus": false, "num_cpus_for_main_process": 2, "eager_tracing": true, "eager_max_retraces": 20, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "torch_compile_learner": false, "torch_compile_learner_what_to_compile": "forward_train", "torch_compile_learner_dynamo_backend": "aot_eager", "torch_compile_learner_dynamo_mode": null, "torch_compile_worker": false, "torch_compile_worker_dynamo_backend": "aot_eager", "torch_compile_worker_dynamo_mode": null, "torch_ddp_kwargs": {}, "torch_skip_nan_gradients": false, "env": "Umbrella", "env_config": {}, "observation_space": null, "action_space": null, "clip_rewards": null, "normalize_actions": true, "clip_actions": false, "_is_atari": null, "disable_env_checking": false, "render_env": false, "action_mask_key": "action_mask", "env_runner_cls": null, "num_env_runners": 0, "create_local_env_runner": true, "num_envs_per_env_runner": 1, "gym_env_vectorize_mode": "SYNC", "num_cpus_per_env_runner": 1, "num_gpus_per_env_runner": 0, "custom_resources_per_env_runner": {}, "validate_env_runners_after_construction": true, "episodes_to_numpy": true, "max_requests_in_flight_per_env_runner": 1, "sample_timeout_s": 60.0, "_env_to_module_connector": null, "add_default_connectors_to_env_to_module_pipeline": true, "_module_to_env_connector": null, "add_default_connectors_to_module_to_env_pipeline": true, "merge_env_runner_states": "training_only", "broadcast_env_runner_states": true, "episode_lookback_horizon": 1, "rollout_fragment_length": "auto", "batch_mode": "complete_episodes", "compress_observations": false, "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "enable_tf1_exec_eagerly": false, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "preprocessor_pref": "deepmind", "observation_filter": "NoFilter", "update_worker_filter_stats": true, "use_worker_filter_stats": true, "sampler_perf_stats_ema_coef": null, "_is_online": true, "num_learners": 0, "num_gpus_per_learner": 0, "num_cpus_per_learner": "auto", "num_aggregator_actors_per_learner": 0, "max_requests_in_flight_per_aggregator_actor": 3, "local_gpu_idx": 0, "max_requests_in_flight_per_learner": 3, "gamma": 1, "lr": 0.0002847858517, "grad_clip": 0.5, "grad_clip_by": "global_norm", "_train_batch_size_per_learner": 5000, "train_batch_size": 4000, "num_epochs": 1, "minibatch_size": 1000, "shuffle_batch_per_epoch": true, "model": {"fcnet_hiddens": [256, 256], "fcnet_activation": "tanh", "fcnet_weights_initializer": null, "fcnet_weights_initializer_config": null, "fcnet_bias_initializer": null, "fcnet_bias_initializer_config": null, "conv_filters": null, "conv_activation": "relu", "conv_kernel_initializer": null, "conv_kernel_initializer_config": null, "conv_bias_initializer": null, "conv_bias_initializer_config": null, "conv_transpose_kernel_initializer": null, "conv_transpose_kernel_initializer_config": null, "conv_transpose_bias_initializer": null, "conv_transpose_bias_initializer_config": null, "post_fcnet_hiddens": [], "post_fcnet_activation": "relu", "post_fcnet_weights_initializer": null, "post_fcnet_weights_initializer_config": null, "post_fcnet_bias_initializer": null, "post_fcnet_bias_initializer_config": null, "free_log_std": false, "log_std_clip_param": 20.0, "no_final_linear": false, "vf_share_layers": false, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "lstm_weights_initializer": null, "lstm_weights_initializer_config": null, "lstm_bias_initializer": null, "lstm_bias_initializer_config": null, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "attention_use_n_prev_actions": 0, "attention_use_n_prev_rewards": 0, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": null, "custom_model_config": {}, "custom_action_dist": null, "custom_preprocessor": null, "encoder_latent_dim": null, "always_check_shapes": false, "lstm_use_prev_action_reward": -1, "_use_default_native_models": -1, "_disable_preprocessor_api": false, "_disable_action_flattening": false}, "_learner_connector": null, "add_default_connectors_to_learner_pipeline": true, "learner_config_dict": {}, "optimizer": {}, "_learner_class": null, "callbacks_on_algorithm_init": null, "callbacks_on_env_runners_recreated": null, "callbacks_on_offline_eval_runners_recreated": null, "callbacks_on_checkpoint_loaded": null, "callbacks_on_environment_created": null, "callbacks_on_episode_created": null, "callbacks_on_episode_start": null, "callbacks_on_episode_step": null, "callbacks_on_episode_end": null, "callbacks_on_evaluate_start": null, "callbacks_on_evaluate_end": null, "callbacks_on_evaluate_offline_start": null, "callbacks_on_evaluate_offline_end": null, "callbacks_on_sample_end": null, "callbacks_on_train_result": null, "explore": true, "enable_rl_module_and_learner": true, "enable_env_runner_and_connector_v2": true, "_prior_exploration_config": {"type": "StochasticSampling"}, "count_steps_by": "env_steps", "policy_map_capacity": 100, "policy_mapping_fn": "<function AlgorithmConfig.DEFAULT_POLICY_MAPPING_FN at 0x3867f18a0>", "policies_to_train": null, "policy_states_are_swappable": false, "observation_fn": null, "offline_data_class": null, "input_read_method": "read_parquet", "input_read_method_kwargs": {}, "input_read_schema": {}, "input_read_episodes": false, "input_read_sample_batches": false, "input_read_batch_size": null, "input_filesystem": null, "input_filesystem_kwargs": {}, "input_compress_columns": ["obs", "new_obs"], "input_spaces_jsonable": true, "materialize_data": false, "materialize_mapped_data": true, "map_batches_kwargs": {}, "iter_batches_kwargs": {}, "ignore_final_observation": false, "prelearner_class": null, "prelearner_buffer_class": null, "prelearner_buffer_kwargs": {}, "prelearner_module_synch_period": 10, "dataset_num_iters_per_learner": null, "input_config": {}, "actions_in_input_normalized": false, "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_config": {}, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "output_max_rows_per_file": null, "output_write_remaining_data": false, "output_write_method": "write_parquet", "output_write_method_kwargs": {}, "output_filesystem": null, "output_filesystem_kwargs": {}, "output_write_episodes": true, "offline_sampling": false, "evaluation_interval": 1, "evaluation_duration": 20, "evaluation_duration_unit": "episodes", "evaluation_sample_timeout_s": 120.0, "evaluation_auto_duration_min_env_steps_per_sample": 100, "evaluation_auto_duration_max_env_steps_per_sample": 2000, "evaluation_parallel_to_training": false, "evaluation_force_reset_envs_before_iteration": true, "evaluation_config": null, "off_policy_estimation_methods": {}, "ope_split_batch_by_episode": true, "evaluation_num_env_runners": 1, "in_evaluation": false, "sync_filters_on_rollout_workers_timeout_s": 10.0, "offline_evaluation_interval": null, "num_offline_eval_runners": 0, "offline_loss_for_module_fn": null, "offline_evaluation_duration": 1, "offline_evaluation_parallel_to_training": false, "offline_evaluation_timeout_s": 120.0, "num_cpus_per_offline_eval_runner": 1, "num_gpus_per_offline_eval_runner": 0, "custom_resources_per_offline_eval_runner": {}, "restart_failed_offline_eval_runners": true, "ignore_offline_eval_runner_failures": false, "max_num_offline_eval_runner_restarts": 1000, "offline_eval_runner_restore_timeout_s": 1800.0, "max_requests_in_flight_per_offline_eval_runner": 1, "validate_offline_eval_runners_after_construction": true, "offline_eval_runner_health_probe_timeout_s": 30.0, "offline_eval_rl_module_inference_only": false, "broadcast_offline_eval_runner_states": false, "offline_eval_batch_size_per_runner": 256, "dataset_num_iters_per_eval_runner": 1, "keep_per_episode_custom_metrics": false, "metrics_episode_collection_timeout_s": 60.0, "metrics_num_episodes_for_smoothing": 100, "min_time_s_per_iteration": null, "min_train_timesteps_per_iteration": 0, "min_sample_timesteps_per_iteration": 0, "log_gradients": true, "export_native_model_files": false, "checkpoint_trainable_policies_only": false, "logger_creator": null, "logger_config": null, "log_level": "WARN", "log_sys_usage": true, "fake_sampler": false, "seed": 3, "restart_failed_env_runners": true, "ignore_env_runner_failures": false, "max_num_env_runner_restarts": 1000, "delay_between_env_runner_restarts_s": 60.0, "restart_failed_sub_environments": false, "num_consecutive_env_runner_failures_tolerance": 100, "env_runner_health_probe_timeout_s": 30.0, "env_runner_restore_timeout_s": 1800.0, "_model_config": {}, "_rl_module_spec": "RLModuleSpec(module_class=None, observation_space=None, action_space=None, inference_only=False, learner_only=False, model_config=DefaultModelConfig(fcnet_hiddens=[60, 90], fcnet_activation='tanh', fcnet_kernel_initializer=None, fcnet_kernel_initializer_kwargs=None, fcnet_bias_initializer=None, fcnet_bias_initializer_kwargs=None, conv_filters=None, conv_activation='relu', conv_kernel_initializer=None, conv_kernel_initializer_kwargs=None, conv_bias_initializer=None, conv_bias_initializer_kwargs=None, head_fcnet_hiddens=[], head_fcnet_activation='relu', head_fcnet_kernel_initializer=None, head_fcnet_kernel_initializer_kwargs=None, head_fcnet_bias_initializer=None, head_fcnet_bias_initializer_kwargs=None, free_log_std=False, log_std_clip_param=20.0, vf_share_layers=True, use_lstm=False, max_seq_len=20, lstm_cell_size=256, lstm_use_prev_action=False, lstm_use_prev_reward=False, lstm_kernel_initializer=None, lstm_kernel_initializer_kwargs=None, lstm_bias_initializer=None, lstm_bias_initializer_kwargs=None), catalog_class=None, load_state_path=None, model_config_dict=None)", "algorithm_config_overrides_per_module": {}, "_per_module_overrides": {}, "_validate_config": true, "_use_msgpack_checkpoints": false, "_torch_grad_scaler_class": null, "_torch_lr_scheduler_classes": null, "_tf_policy_handles_more_than_one_loss": false, "_disable_preprocessor_api": false, "_disable_action_flattening": false, "_disable_initialize_loss_from_dummy_batch": false, "_dont_auto_sync_env_runner_states": false, "env_task_fn": -1, "enable_connectors": -1, "simple_optimizer": false, "policy_map_cache": -1, "worker_cls": -1, "synchronize_filters": -1, "enable_async_evaluation": -1, "custom_async_evaluation_function": -1, "_enable_rl_module_api": -1, "auto_wrap_old_gym_envs": -1, "always_attach_evaluation_results": -1, "replay_sequence_length": null, "_disable_execution_plan_api": -1, "use_critic": true, "use_gae": true, "use_kl_loss": true, "kl_coeff": 0.7464963036515, "kl_target": 0.0270990929592, "vf_loss_coeff": 0.6688075857018, "entropy_coeff": 0.0090570820258, "clip_param": 0.1221781641624, "vf_clip_param": 0.1027808522125, "entropy_coeff_schedule": null, "lr_schedule": null, "sgd_minibatch_size": -1, "vf_share_layers": -1, "__stdout_file__": null, "__stderr_file__": null, "lambda": 0.9099046732075, "input": "sampler", "policies": {"default_policy": [null, null, null, null]}, "callbacks": "<class 'ray.rllib.callbacks.callbacks.RLlibCallback'>", "create_env_on_driver": false, "custom_eval_function": null, "framework": "torch"}, "time_since_restore": 112.09877634048462, "iterations_since_restore": 15, "perf": {"cpu_util_percent": 90.33333333333333, "ram_util_percent": 82.51111111111112}}
{"timers": {"training_iteration": 6.8359722647824555, "restore_env_runners": 4.2727010682263335e-05, "training_step": 6.835452661174348, "env_runner_sampling_timer": 6.499599131011474, "learner_update_timer": 0.32702658348799885, "synch_weights": 0.0018829719064817527, "restore_eval_env_runners": 1.7518909861858704e-05, "evaluation_iteration": 0.3815564799915413, "synch_eval_env_connectors": 0.00051104345208098, "synch_env_connectors": 1.881090414802784e-05}, "env_runners": {"module_to_env_connector": {"timers": {"connectors": {"remove_single_ts_time_rank_from_batch": 1.5063447735308173e-06, "listify_data_for_vector_env": 3.453416400333608e-05, "get_actions": 0.0001709191080701578, "normalize_and_clip_actions": 2.8080322172699484e-05, "tensor_to_numpy": 4.6863606891753284e-05, "un_batch_to_individual_items": 1.5346801802148203e-05}}, "connector_pipeline_timer": 0.00036981258756144976}, "env_step_timer": 5.723126532530101e-05, "env_to_module_connector": {"timers": {"connectors": {"numpy_to_tensor": 3.3569374554025684e-05, "add_time_dim_to_batch_and_zero_pad": 8.768319397019083e-06, "add_observations_from_episodes_to_batch": 9.51480062107493e-06, "batch_individual_items": 2.051356963196871e-05, "add_states_from_episodes_to_batch": 4.854566350888405e-06}}, "connector_pipeline_timer": 0.00014063433370151994}, "num_episodes_lifetime": -431750.0, "time_between_sampling": 0.005202379465545439, "num_agent_steps_sampled_lifetime": {"default_agent": -8635000.0}, "rlmodule_inference_timer": 0.00012185449494661352, "episode_return_mean": 3.8600000000000008, "episode_len_mean": 20.0, "env_reset_timer": 0.00018842216984244395, "num_agent_steps_sampled": {"default_agent": 5000.0}, "num_env_steps_sampled_lifetime": -8635000.0, "episode_return_max": 6.5, "num_episodes": 250.0, "env_to_module_sum_episodes_length_in": 10.36823839457432, "module_episode_returns_mean": {"default_policy": 3.8600000000000008}, "agent_episode_returns_mean": {"default_agent": 3.8600000000000008}, "num_module_steps_sampled": {"default_policy": 5000.0}, "num_env_steps_sampled": 5000.0, "episode_duration_sec_mean": 0.016451763703022152, "episode_len_min": 20, "sample": 0.017437830574691813, "episode_return_min": -13.5, "weights_seq_no": 15.0, "env_to_module_sum_episodes_length_out": 10.36823839457432, "num_module_steps_sampled_lifetime": {"default_policy": -8635000.0}, "episode_len_max": 20, "num_env_steps_sampled_lifetime_throughput": 1746.034098295431}, "learners": {"default_policy": {"num_module_steps_trained": 6000, "num_module_steps_trained_lifetime": 96000, "curr_entropy_coeff": 0.0090570820258, "policy_loss": 0.05892258882522583, "total_loss": 0.12026922404766083, "weights_seq_no": 16.0, "default_optimizer_learning_rate": 0.0002847858517, "vf_loss_unclipped": 25.01618003845215, "entropy": 0.5057782530784607, "gradients_default_optimizer_global_norm": 0.04237082600593567, "num_trainable_parameters": 6003, "mean_kl_loss": 5.30047582287807e-05, "module_train_batch_size_mean": 1000.0, "vf_loss": 0.098574697971344, "diff_num_grad_updates_vs_sampler_policy": 1.0, "vf_explained_var": -0.00821065902709961, "curr_kl_coeff": 1.1390629879315384e-05, "num_module_steps_trained_lifetime_throughput": 254121.01821850016}, "__all_modules__": {"learner_connector": {"timers": {"connectors": {"add_columns_from_episodes_to_train_batch": 0.10804801676414831, "add_time_dim_to_batch_and_zero_pad": 1.887839151417308e-05, "batch_individual_items": 0.06644610818759177, "add_states_from_episodes_to_batch": 4.944622542685552e-06, "numpy_to_tensor": 0.00011429755685475727, "add_one_ts_to_episodes_and_truncate": 0.027214394345789598, "general_advantage_estimation": 0.009749429760484384, "add_observations_from_episodes_to_batch": 0.001247837630296043}}, "connector_pipeline_timer": 0.2132794262556053}, "num_trainable_parameters": 6003, "learner_connector_sum_episodes_length_in": 5000.0, "learner_connector_sum_episodes_length_out": 5250.0, "num_env_steps_trained": 31500, "num_module_steps_trained": 6000, "num_module_steps_trained_lifetime": 96000, "num_non_trainable_parameters": 0, "num_env_steps_trained_lifetime": 504000, "num_env_steps_trained_lifetime_throughput": 1323950.3987187615, "num_module_steps_trained_throughput": 253575.5048564846, "num_module_steps_trained_lifetime_throughput": 253039.50913805136}}, "num_training_step_calls_per_iteration": 1, "evaluation": {"env_runners": {"env_step_timer": 5.974889585342133e-05, "num_episodes_lifetime": 320, "env_reset_timer": 0.001033492433157205, "num_env_steps_sampled_lifetime": 80400, "env_to_module_connector": {"timers": {"connectors": {"add_observations_from_episodes_to_batch": 7.409693108286921e-06, "add_states_from_episodes_to_batch": 6.093264003852511e-06, "numpy_to_tensor": 2.665893044355457e-05, "batch_individual_items": 1.762687101964441e-05, "add_time_dim_to_batch_and_zero_pad": 7.3719133262224545e-06}}, "connector_pipeline_timer": 0.0001255294030250978}, "num_agent_steps_sampled": {"default_agent": 400}, "episode_len_min": 20, "sample": 0.35285004078363724, "module_to_env_connector": {"timers": {"connectors": {"get_actions": 0.00013877020208948816, "un_batch_to_individual_items": 1.704407887536489e-05, "remove_single_ts_time_rank_from_batch": 2.4424897662753457e-06, "listify_data_for_vector_env": 4.78305613793536e-05, "tensor_to_numpy": 3.962029645375607e-05, "normalize_and_clip_actions": 3.9910604778868846e-05}}, "connector_pipeline_timer": 0.00035959149713133635}, "episode_return_min": -12.5, "env_to_module_sum_episodes_length_out": 10.368238394574323, "rlmodule_inference_timer": 8.88041127725797e-05, "num_agent_steps_sampled_lifetime": {"default_agent": 6400}, "episode_duration_sec_mean": 0.01714080377947539, "module_episode_returns_mean": {"default_policy": 2.8}, "agent_episode_returns_mean": {"default_agent": 2.8}, "num_module_steps_sampled": {"default_policy": 400}, "episode_return_max": 13.5, "num_episodes": 20, "env_to_module_sum_episodes_length_in": 10.368238394574323, "num_env_steps_sampled": 400, "weights_seq_no": 16.0, "episode_return_mean": 2.8, "episode_len_mean": 20.0, "num_module_steps_sampled_lifetime": {"default_policy": 6400}, "episode_len_max": 20, "time_between_sampling": 6.205679352337433}, "num_healthy_workers": 1, "actor_manager_num_outstanding_async_reqs": 0, "num_remote_worker_restarts": 0}, "num_env_steps_sampled_lifetime": -8635000.0, "fault_tolerance": {"num_healthy_workers": 0, "num_remote_worker_restarts": 0}, "env_runner_group": {"actor_manager_num_outstanding_async_reqs": 0}, "done": false, "training_iteration": 16, "trial_id": "4995b_00000", "date": "2025-08-11_19-27-15", "timestamp": 1754933235, "time_this_iter_s": 5.319321870803833, "time_total_s": 117.41809821128845, "pid": 14987, "hostname": "Mac", "node_ip": "127.0.0.1", "config": {"exploration_config": {}, "extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "placement_strategy": "PACK", "num_gpus": 0, "_fake_gpus": false, "num_cpus_for_main_process": 2, "eager_tracing": true, "eager_max_retraces": 20, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "torch_compile_learner": false, "torch_compile_learner_what_to_compile": "forward_train", "torch_compile_learner_dynamo_backend": "aot_eager", "torch_compile_learner_dynamo_mode": null, "torch_compile_worker": false, "torch_compile_worker_dynamo_backend": "aot_eager", "torch_compile_worker_dynamo_mode": null, "torch_ddp_kwargs": {}, "torch_skip_nan_gradients": false, "env": "Umbrella", "env_config": {}, "observation_space": null, "action_space": null, "clip_rewards": null, "normalize_actions": true, "clip_actions": false, "_is_atari": null, "disable_env_checking": false, "render_env": false, "action_mask_key": "action_mask", "env_runner_cls": null, "num_env_runners": 0, "create_local_env_runner": true, "num_envs_per_env_runner": 1, "gym_env_vectorize_mode": "SYNC", "num_cpus_per_env_runner": 1, "num_gpus_per_env_runner": 0, "custom_resources_per_env_runner": {}, "validate_env_runners_after_construction": true, "episodes_to_numpy": true, "max_requests_in_flight_per_env_runner": 1, "sample_timeout_s": 60.0, "_env_to_module_connector": null, "add_default_connectors_to_env_to_module_pipeline": true, "_module_to_env_connector": null, "add_default_connectors_to_module_to_env_pipeline": true, "merge_env_runner_states": "training_only", "broadcast_env_runner_states": true, "episode_lookback_horizon": 1, "rollout_fragment_length": "auto", "batch_mode": "complete_episodes", "compress_observations": false, "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "enable_tf1_exec_eagerly": false, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "preprocessor_pref": "deepmind", "observation_filter": "NoFilter", "update_worker_filter_stats": true, "use_worker_filter_stats": true, "sampler_perf_stats_ema_coef": null, "_is_online": true, "num_learners": 0, "num_gpus_per_learner": 0, "num_cpus_per_learner": "auto", "num_aggregator_actors_per_learner": 0, "max_requests_in_flight_per_aggregator_actor": 3, "local_gpu_idx": 0, "max_requests_in_flight_per_learner": 3, "gamma": 1, "lr": 0.0002847858517, "grad_clip": 0.5, "grad_clip_by": "global_norm", "_train_batch_size_per_learner": 5000, "train_batch_size": 4000, "num_epochs": 1, "minibatch_size": 1000, "shuffle_batch_per_epoch": true, "model": {"fcnet_hiddens": [256, 256], "fcnet_activation": "tanh", "fcnet_weights_initializer": null, "fcnet_weights_initializer_config": null, "fcnet_bias_initializer": null, "fcnet_bias_initializer_config": null, "conv_filters": null, "conv_activation": "relu", "conv_kernel_initializer": null, "conv_kernel_initializer_config": null, "conv_bias_initializer": null, "conv_bias_initializer_config": null, "conv_transpose_kernel_initializer": null, "conv_transpose_kernel_initializer_config": null, "conv_transpose_bias_initializer": null, "conv_transpose_bias_initializer_config": null, "post_fcnet_hiddens": [], "post_fcnet_activation": "relu", "post_fcnet_weights_initializer": null, "post_fcnet_weights_initializer_config": null, "post_fcnet_bias_initializer": null, "post_fcnet_bias_initializer_config": null, "free_log_std": false, "log_std_clip_param": 20.0, "no_final_linear": false, "vf_share_layers": false, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "lstm_weights_initializer": null, "lstm_weights_initializer_config": null, "lstm_bias_initializer": null, "lstm_bias_initializer_config": null, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "attention_use_n_prev_actions": 0, "attention_use_n_prev_rewards": 0, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": null, "custom_model_config": {}, "custom_action_dist": null, "custom_preprocessor": null, "encoder_latent_dim": null, "always_check_shapes": false, "lstm_use_prev_action_reward": -1, "_use_default_native_models": -1, "_disable_preprocessor_api": false, "_disable_action_flattening": false}, "_learner_connector": null, "add_default_connectors_to_learner_pipeline": true, "learner_config_dict": {}, "optimizer": {}, "_learner_class": null, "callbacks_on_algorithm_init": null, "callbacks_on_env_runners_recreated": null, "callbacks_on_offline_eval_runners_recreated": null, "callbacks_on_checkpoint_loaded": null, "callbacks_on_environment_created": null, "callbacks_on_episode_created": null, "callbacks_on_episode_start": null, "callbacks_on_episode_step": null, "callbacks_on_episode_end": null, "callbacks_on_evaluate_start": null, "callbacks_on_evaluate_end": null, "callbacks_on_evaluate_offline_start": null, "callbacks_on_evaluate_offline_end": null, "callbacks_on_sample_end": null, "callbacks_on_train_result": null, "explore": true, "enable_rl_module_and_learner": true, "enable_env_runner_and_connector_v2": true, "_prior_exploration_config": {"type": "StochasticSampling"}, "count_steps_by": "env_steps", "policy_map_capacity": 100, "policy_mapping_fn": "<function AlgorithmConfig.DEFAULT_POLICY_MAPPING_FN at 0x3867f18a0>", "policies_to_train": null, "policy_states_are_swappable": false, "observation_fn": null, "offline_data_class": null, "input_read_method": "read_parquet", "input_read_method_kwargs": {}, "input_read_schema": {}, "input_read_episodes": false, "input_read_sample_batches": false, "input_read_batch_size": null, "input_filesystem": null, "input_filesystem_kwargs": {}, "input_compress_columns": ["obs", "new_obs"], "input_spaces_jsonable": true, "materialize_data": false, "materialize_mapped_data": true, "map_batches_kwargs": {}, "iter_batches_kwargs": {}, "ignore_final_observation": false, "prelearner_class": null, "prelearner_buffer_class": null, "prelearner_buffer_kwargs": {}, "prelearner_module_synch_period": 10, "dataset_num_iters_per_learner": null, "input_config": {}, "actions_in_input_normalized": false, "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_config": {}, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "output_max_rows_per_file": null, "output_write_remaining_data": false, "output_write_method": "write_parquet", "output_write_method_kwargs": {}, "output_filesystem": null, "output_filesystem_kwargs": {}, "output_write_episodes": true, "offline_sampling": false, "evaluation_interval": 1, "evaluation_duration": 20, "evaluation_duration_unit": "episodes", "evaluation_sample_timeout_s": 120.0, "evaluation_auto_duration_min_env_steps_per_sample": 100, "evaluation_auto_duration_max_env_steps_per_sample": 2000, "evaluation_parallel_to_training": false, "evaluation_force_reset_envs_before_iteration": true, "evaluation_config": null, "off_policy_estimation_methods": {}, "ope_split_batch_by_episode": true, "evaluation_num_env_runners": 1, "in_evaluation": false, "sync_filters_on_rollout_workers_timeout_s": 10.0, "offline_evaluation_interval": null, "num_offline_eval_runners": 0, "offline_loss_for_module_fn": null, "offline_evaluation_duration": 1, "offline_evaluation_parallel_to_training": false, "offline_evaluation_timeout_s": 120.0, "num_cpus_per_offline_eval_runner": 1, "num_gpus_per_offline_eval_runner": 0, "custom_resources_per_offline_eval_runner": {}, "restart_failed_offline_eval_runners": true, "ignore_offline_eval_runner_failures": false, "max_num_offline_eval_runner_restarts": 1000, "offline_eval_runner_restore_timeout_s": 1800.0, "max_requests_in_flight_per_offline_eval_runner": 1, "validate_offline_eval_runners_after_construction": true, "offline_eval_runner_health_probe_timeout_s": 30.0, "offline_eval_rl_module_inference_only": false, "broadcast_offline_eval_runner_states": false, "offline_eval_batch_size_per_runner": 256, "dataset_num_iters_per_eval_runner": 1, "keep_per_episode_custom_metrics": false, "metrics_episode_collection_timeout_s": 60.0, "metrics_num_episodes_for_smoothing": 100, "min_time_s_per_iteration": null, "min_train_timesteps_per_iteration": 0, "min_sample_timesteps_per_iteration": 0, "log_gradients": true, "export_native_model_files": false, "checkpoint_trainable_policies_only": false, "logger_creator": null, "logger_config": null, "log_level": "WARN", "log_sys_usage": true, "fake_sampler": false, "seed": 3, "restart_failed_env_runners": true, "ignore_env_runner_failures": false, "max_num_env_runner_restarts": 1000, "delay_between_env_runner_restarts_s": 60.0, "restart_failed_sub_environments": false, "num_consecutive_env_runner_failures_tolerance": 100, "env_runner_health_probe_timeout_s": 30.0, "env_runner_restore_timeout_s": 1800.0, "_model_config": {}, "_rl_module_spec": "RLModuleSpec(module_class=None, observation_space=None, action_space=None, inference_only=False, learner_only=False, model_config=DefaultModelConfig(fcnet_hiddens=[60, 90], fcnet_activation='tanh', fcnet_kernel_initializer=None, fcnet_kernel_initializer_kwargs=None, fcnet_bias_initializer=None, fcnet_bias_initializer_kwargs=None, conv_filters=None, conv_activation='relu', conv_kernel_initializer=None, conv_kernel_initializer_kwargs=None, conv_bias_initializer=None, conv_bias_initializer_kwargs=None, head_fcnet_hiddens=[], head_fcnet_activation='relu', head_fcnet_kernel_initializer=None, head_fcnet_kernel_initializer_kwargs=None, head_fcnet_bias_initializer=None, head_fcnet_bias_initializer_kwargs=None, free_log_std=False, log_std_clip_param=20.0, vf_share_layers=True, use_lstm=False, max_seq_len=20, lstm_cell_size=256, lstm_use_prev_action=False, lstm_use_prev_reward=False, lstm_kernel_initializer=None, lstm_kernel_initializer_kwargs=None, lstm_bias_initializer=None, lstm_bias_initializer_kwargs=None), catalog_class=None, load_state_path=None, model_config_dict=None)", "algorithm_config_overrides_per_module": {}, "_per_module_overrides": {}, "_validate_config": true, "_use_msgpack_checkpoints": false, "_torch_grad_scaler_class": null, "_torch_lr_scheduler_classes": null, "_tf_policy_handles_more_than_one_loss": false, "_disable_preprocessor_api": false, "_disable_action_flattening": false, "_disable_initialize_loss_from_dummy_batch": false, "_dont_auto_sync_env_runner_states": false, "env_task_fn": -1, "enable_connectors": -1, "simple_optimizer": false, "policy_map_cache": -1, "worker_cls": -1, "synchronize_filters": -1, "enable_async_evaluation": -1, "custom_async_evaluation_function": -1, "_enable_rl_module_api": -1, "auto_wrap_old_gym_envs": -1, "always_attach_evaluation_results": -1, "replay_sequence_length": null, "_disable_execution_plan_api": -1, "use_critic": true, "use_gae": true, "use_kl_loss": true, "kl_coeff": 0.7464963036515, "kl_target": 0.0270990929592, "vf_loss_coeff": 0.6688075857018, "entropy_coeff": 0.0090570820258, "clip_param": 0.1221781641624, "vf_clip_param": 0.1027808522125, "entropy_coeff_schedule": null, "lr_schedule": null, "sgd_minibatch_size": -1, "vf_share_layers": -1, "__stdout_file__": null, "__stderr_file__": null, "lambda": 0.9099046732075, "input": "sampler", "policies": {"default_policy": [null, null, null, null]}, "callbacks": "<class 'ray.rllib.callbacks.callbacks.RLlibCallback'>", "create_env_on_driver": false, "custom_eval_function": null, "framework": "torch"}, "time_since_restore": 117.41809821128845, "iterations_since_restore": 16, "perf": {"cpu_util_percent": 87.9875, "ram_util_percent": 82.525}}
{"timers": {"training_iteration": 6.818075674634349, "restore_env_runners": 4.236766076665419e-05, "training_step": 6.817556216232244, "env_runner_sampling_timer": 6.4832648588719906, "learner_update_timer": 0.32545608223381756, "synch_weights": 0.0018804838578332307, "restore_eval_env_runners": 1.769997027448203e-05, "evaluation_iteration": 0.38132903686122566, "synch_eval_env_connectors": 0.0005070080175966781, "synch_env_connectors": 1.8666545148643343e-05}, "env_runners": {"module_to_env_connector": {"timers": {"connectors": {"remove_single_ts_time_rank_from_batch": 1.3655701885342275e-06, "listify_data_for_vector_env": 3.300934667331886e-05, "get_actions": 0.00016019603970129578, "normalize_and_clip_actions": 2.5431674155249506e-05, "tensor_to_numpy": 4.787914955436637e-05, "un_batch_to_individual_items": 2.0444714557026307e-05}}, "connector_pipeline_timer": 0.00035724615030803753}, "env_step_timer": 5.109829299933884e-05, "env_to_module_connector": {"timers": {"connectors": {"numpy_to_tensor": 3.049055621681681e-05, "add_time_dim_to_batch_and_zero_pad": 6.566287320590199e-06, "add_observations_from_episodes_to_batch": 8.043609210451622e-06, "batch_individual_items": 2.9794730853131717e-05, "add_states_from_episodes_to_batch": 3.952890435198952e-06}}, "connector_pipeline_timer": 0.00013220347499023704}, "num_episodes_lifetime": -462625.0, "time_between_sampling": 0.004009689886933654, "num_agent_steps_sampled_lifetime": {"default_agent": -9252500.0}, "rlmodule_inference_timer": 0.00016911023095023394, "episode_return_mean": 3.8600000000000008, "episode_len_mean": 20.0, "env_reset_timer": 0.00019115279657673143, "num_agent_steps_sampled": {"default_agent": 5000.0}, "num_env_steps_sampled_lifetime": -9252500.0, "episode_return_max": 6.5, "num_episodes": 250.0, "env_to_module_sum_episodes_length_in": 10.36823839457432, "module_episode_returns_mean": {"default_policy": 3.8600000000000008}, "agent_episode_returns_mean": {"default_agent": 3.8600000000000008}, "num_module_steps_sampled": {"default_policy": 5000.0}, "num_env_steps_sampled": 5000.0, "episode_duration_sec_mean": 0.01681329785473645, "episode_len_min": 20, "sample": 0.01848283233695855, "episode_return_min": -13.5, "weights_seq_no": 16.0, "env_to_module_sum_episodes_length_out": 10.36823839457432, "num_module_steps_sampled_lifetime": {"default_policy": -9252500.0}, "episode_len_max": 20, "num_env_steps_sampled_lifetime_throughput": 1815.2231012689665}, "learners": {"default_policy": {"num_module_steps_trained": 6000, "num_module_steps_trained_lifetime": 102000, "curr_entropy_coeff": 0.0090570820258, "policy_loss": 0.010529711842536926, "total_loss": 0.07174283266067505, "weights_seq_no": 17.0, "default_optimizer_learning_rate": 0.0002847858517, "vf_loss_unclipped": 24.70703125, "entropy": 0.5125570893287659, "gradients_default_optimizer_global_norm": 0.12520335614681244, "num_trainable_parameters": 6003, "mean_kl_loss": 8.060758409556001e-05, "module_train_batch_size_mean": 1000.0, "vf_loss": 0.09846686571836472, "diff_num_grad_updates_vs_sampler_policy": 1.0, "vf_explained_var": -0.007464289665222168, "curr_kl_coeff": 5.695314939657692e-06, "num_module_steps_trained_lifetime_throughput": 251371.73340639376}, "__all_modules__": {"learner_connector": {"timers": {"connectors": {"add_columns_from_episodes_to_train_batch": 0.10759470367587172, "add_time_dim_to_batch_and_zero_pad": 1.882502772214653e-05, "batch_individual_items": 0.06612091669488294, "add_states_from_episodes_to_batch": 4.93392632128201e-06, "numpy_to_tensor": 0.00011403333186564136, "add_one_ts_to_episodes_and_truncate": 0.02719349581251328, "general_advantage_estimation": 0.009708184623431938, "add_observations_from_episodes_to_batch": 0.0012528150935450677}}, "connector_pipeline_timer": 0.2124414694939493}, "num_trainable_parameters": 6003, "learner_connector_sum_episodes_length_in": 5000.0, "learner_connector_sum_episodes_length_out": 5250.0, "num_env_steps_trained": 31500, "num_module_steps_trained": 6000, "num_module_steps_trained_lifetime": 102000, "num_non_trainable_parameters": 0, "num_env_steps_trained_lifetime": 535500, "num_env_steps_trained_lifetime_throughput": 1309989.7094457427, "num_module_steps_trained_throughput": 250865.2504972355, "num_module_steps_trained_lifetime_throughput": 250344.29413631273}}, "num_training_step_calls_per_iteration": 1, "evaluation": {"env_runners": {"env_step_timer": 4.253762583066646e-05, "num_episodes_lifetime": 340, "env_reset_timer": 0.0010297750085738779, "num_env_steps_sampled_lifetime": 85400, "env_to_module_connector": {"timers": {"connectors": {"add_observations_from_episodes_to_batch": 6.018484012695409e-06, "add_states_from_episodes_to_batch": 2.977020438792945e-06, "numpy_to_tensor": 5.648809978873281e-05, "batch_individual_items": 1.5986697385876422e-05, "add_time_dim_to_batch_and_zero_pad": 1.1440751707117377e-05}}, "connector_pipeline_timer": 0.00014910514040094767}, "num_agent_steps_sampled": {"default_agent": 400}, "episode_len_min": 20, "sample": 0.35173938287594547, "module_to_env_connector": {"timers": {"connectors": {"get_actions": 0.00018878932631745255, "un_batch_to_individual_items": 1.2881964272569366e-05, "remove_single_ts_time_rank_from_batch": 1.0867505305597463e-06, "listify_data_for_vector_env": 6.834923548048627e-05, "tensor_to_numpy": 4.829405742986466e-05, "normalize_and_clip_actions": 1.7975937254911458e-05}}, "connector_pipeline_timer": 0.000457194346777825}, "episode_return_min": -12.5, "env_to_module_sum_episodes_length_out": 10.368238394574323, "rlmodule_inference_timer": 9.466914980017418e-05, "num_agent_steps_sampled_lifetime": {"default_agent": 6800}, "episode_duration_sec_mean": 0.015626031268620864, "module_episode_returns_mean": {"default_policy": 2.2}, "agent_episode_returns_mean": {"default_agent": 2.2}, "num_module_steps_sampled": {"default_policy": 400}, "episode_return_max": 13.5, "num_episodes": 20, "env_to_module_sum_episodes_length_in": 10.368238394574323, "num_env_steps_sampled": 400, "weights_seq_no": 17.0, "episode_return_mean": 2.2, "episode_len_mean": 20.0, "num_module_steps_sampled_lifetime": {"default_policy": 6800}, "episode_len_max": 20, "time_between_sampling": 6.194566597144403}, "num_healthy_workers": 1, "actor_manager_num_outstanding_async_reqs": 0, "num_remote_worker_restarts": 0}, "num_env_steps_sampled_lifetime": -9252500.0, "fault_tolerance": {"num_healthy_workers": 0, "num_remote_worker_restarts": 0}, "env_runner_group": {"actor_manager_num_outstanding_async_reqs": 0}, "done": false, "training_iteration": 17, "trial_id": "4995b_00000", "date": "2025-08-11_19-27-21", "timestamp": 1754933241, "time_this_iter_s": 5.314098358154297, "time_total_s": 122.73219656944275, "pid": 14987, "hostname": "Mac", "node_ip": "127.0.0.1", "config": {"exploration_config": {}, "extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "placement_strategy": "PACK", "num_gpus": 0, "_fake_gpus": false, "num_cpus_for_main_process": 2, "eager_tracing": true, "eager_max_retraces": 20, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "torch_compile_learner": false, "torch_compile_learner_what_to_compile": "forward_train", "torch_compile_learner_dynamo_backend": "aot_eager", "torch_compile_learner_dynamo_mode": null, "torch_compile_worker": false, "torch_compile_worker_dynamo_backend": "aot_eager", "torch_compile_worker_dynamo_mode": null, "torch_ddp_kwargs": {}, "torch_skip_nan_gradients": false, "env": "Umbrella", "env_config": {}, "observation_space": null, "action_space": null, "clip_rewards": null, "normalize_actions": true, "clip_actions": false, "_is_atari": null, "disable_env_checking": false, "render_env": false, "action_mask_key": "action_mask", "env_runner_cls": null, "num_env_runners": 0, "create_local_env_runner": true, "num_envs_per_env_runner": 1, "gym_env_vectorize_mode": "SYNC", "num_cpus_per_env_runner": 1, "num_gpus_per_env_runner": 0, "custom_resources_per_env_runner": {}, "validate_env_runners_after_construction": true, "episodes_to_numpy": true, "max_requests_in_flight_per_env_runner": 1, "sample_timeout_s": 60.0, "_env_to_module_connector": null, "add_default_connectors_to_env_to_module_pipeline": true, "_module_to_env_connector": null, "add_default_connectors_to_module_to_env_pipeline": true, "merge_env_runner_states": "training_only", "broadcast_env_runner_states": true, "episode_lookback_horizon": 1, "rollout_fragment_length": "auto", "batch_mode": "complete_episodes", "compress_observations": false, "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "enable_tf1_exec_eagerly": false, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "preprocessor_pref": "deepmind", "observation_filter": "NoFilter", "update_worker_filter_stats": true, "use_worker_filter_stats": true, "sampler_perf_stats_ema_coef": null, "_is_online": true, "num_learners": 0, "num_gpus_per_learner": 0, "num_cpus_per_learner": "auto", "num_aggregator_actors_per_learner": 0, "max_requests_in_flight_per_aggregator_actor": 3, "local_gpu_idx": 0, "max_requests_in_flight_per_learner": 3, "gamma": 1, "lr": 0.0002847858517, "grad_clip": 0.5, "grad_clip_by": "global_norm", "_train_batch_size_per_learner": 5000, "train_batch_size": 4000, "num_epochs": 1, "minibatch_size": 1000, "shuffle_batch_per_epoch": true, "model": {"fcnet_hiddens": [256, 256], "fcnet_activation": "tanh", "fcnet_weights_initializer": null, "fcnet_weights_initializer_config": null, "fcnet_bias_initializer": null, "fcnet_bias_initializer_config": null, "conv_filters": null, "conv_activation": "relu", "conv_kernel_initializer": null, "conv_kernel_initializer_config": null, "conv_bias_initializer": null, "conv_bias_initializer_config": null, "conv_transpose_kernel_initializer": null, "conv_transpose_kernel_initializer_config": null, "conv_transpose_bias_initializer": null, "conv_transpose_bias_initializer_config": null, "post_fcnet_hiddens": [], "post_fcnet_activation": "relu", "post_fcnet_weights_initializer": null, "post_fcnet_weights_initializer_config": null, "post_fcnet_bias_initializer": null, "post_fcnet_bias_initializer_config": null, "free_log_std": false, "log_std_clip_param": 20.0, "no_final_linear": false, "vf_share_layers": false, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "lstm_weights_initializer": null, "lstm_weights_initializer_config": null, "lstm_bias_initializer": null, "lstm_bias_initializer_config": null, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "attention_use_n_prev_actions": 0, "attention_use_n_prev_rewards": 0, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": null, "custom_model_config": {}, "custom_action_dist": null, "custom_preprocessor": null, "encoder_latent_dim": null, "always_check_shapes": false, "lstm_use_prev_action_reward": -1, "_use_default_native_models": -1, "_disable_preprocessor_api": false, "_disable_action_flattening": false}, "_learner_connector": null, "add_default_connectors_to_learner_pipeline": true, "learner_config_dict": {}, "optimizer": {}, "_learner_class": null, "callbacks_on_algorithm_init": null, "callbacks_on_env_runners_recreated": null, "callbacks_on_offline_eval_runners_recreated": null, "callbacks_on_checkpoint_loaded": null, "callbacks_on_environment_created": null, "callbacks_on_episode_created": null, "callbacks_on_episode_start": null, "callbacks_on_episode_step": null, "callbacks_on_episode_end": null, "callbacks_on_evaluate_start": null, "callbacks_on_evaluate_end": null, "callbacks_on_evaluate_offline_start": null, "callbacks_on_evaluate_offline_end": null, "callbacks_on_sample_end": null, "callbacks_on_train_result": null, "explore": true, "enable_rl_module_and_learner": true, "enable_env_runner_and_connector_v2": true, "_prior_exploration_config": {"type": "StochasticSampling"}, "count_steps_by": "env_steps", "policy_map_capacity": 100, "policy_mapping_fn": "<function AlgorithmConfig.DEFAULT_POLICY_MAPPING_FN at 0x3867f18a0>", "policies_to_train": null, "policy_states_are_swappable": false, "observation_fn": null, "offline_data_class": null, "input_read_method": "read_parquet", "input_read_method_kwargs": {}, "input_read_schema": {}, "input_read_episodes": false, "input_read_sample_batches": false, "input_read_batch_size": null, "input_filesystem": null, "input_filesystem_kwargs": {}, "input_compress_columns": ["obs", "new_obs"], "input_spaces_jsonable": true, "materialize_data": false, "materialize_mapped_data": true, "map_batches_kwargs": {}, "iter_batches_kwargs": {}, "ignore_final_observation": false, "prelearner_class": null, "prelearner_buffer_class": null, "prelearner_buffer_kwargs": {}, "prelearner_module_synch_period": 10, "dataset_num_iters_per_learner": null, "input_config": {}, "actions_in_input_normalized": false, "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_config": {}, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "output_max_rows_per_file": null, "output_write_remaining_data": false, "output_write_method": "write_parquet", "output_write_method_kwargs": {}, "output_filesystem": null, "output_filesystem_kwargs": {}, "output_write_episodes": true, "offline_sampling": false, "evaluation_interval": 1, "evaluation_duration": 20, "evaluation_duration_unit": "episodes", "evaluation_sample_timeout_s": 120.0, "evaluation_auto_duration_min_env_steps_per_sample": 100, "evaluation_auto_duration_max_env_steps_per_sample": 2000, "evaluation_parallel_to_training": false, "evaluation_force_reset_envs_before_iteration": true, "evaluation_config": null, "off_policy_estimation_methods": {}, "ope_split_batch_by_episode": true, "evaluation_num_env_runners": 1, "in_evaluation": false, "sync_filters_on_rollout_workers_timeout_s": 10.0, "offline_evaluation_interval": null, "num_offline_eval_runners": 0, "offline_loss_for_module_fn": null, "offline_evaluation_duration": 1, "offline_evaluation_parallel_to_training": false, "offline_evaluation_timeout_s": 120.0, "num_cpus_per_offline_eval_runner": 1, "num_gpus_per_offline_eval_runner": 0, "custom_resources_per_offline_eval_runner": {}, "restart_failed_offline_eval_runners": true, "ignore_offline_eval_runner_failures": false, "max_num_offline_eval_runner_restarts": 1000, "offline_eval_runner_restore_timeout_s": 1800.0, "max_requests_in_flight_per_offline_eval_runner": 1, "validate_offline_eval_runners_after_construction": true, "offline_eval_runner_health_probe_timeout_s": 30.0, "offline_eval_rl_module_inference_only": false, "broadcast_offline_eval_runner_states": false, "offline_eval_batch_size_per_runner": 256, "dataset_num_iters_per_eval_runner": 1, "keep_per_episode_custom_metrics": false, "metrics_episode_collection_timeout_s": 60.0, "metrics_num_episodes_for_smoothing": 100, "min_time_s_per_iteration": null, "min_train_timesteps_per_iteration": 0, "min_sample_timesteps_per_iteration": 0, "log_gradients": true, "export_native_model_files": false, "checkpoint_trainable_policies_only": false, "logger_creator": null, "logger_config": null, "log_level": "WARN", "log_sys_usage": true, "fake_sampler": false, "seed": 3, "restart_failed_env_runners": true, "ignore_env_runner_failures": false, "max_num_env_runner_restarts": 1000, "delay_between_env_runner_restarts_s": 60.0, "restart_failed_sub_environments": false, "num_consecutive_env_runner_failures_tolerance": 100, "env_runner_health_probe_timeout_s": 30.0, "env_runner_restore_timeout_s": 1800.0, "_model_config": {}, "_rl_module_spec": "RLModuleSpec(module_class=None, observation_space=None, action_space=None, inference_only=False, learner_only=False, model_config=DefaultModelConfig(fcnet_hiddens=[60, 90], fcnet_activation='tanh', fcnet_kernel_initializer=None, fcnet_kernel_initializer_kwargs=None, fcnet_bias_initializer=None, fcnet_bias_initializer_kwargs=None, conv_filters=None, conv_activation='relu', conv_kernel_initializer=None, conv_kernel_initializer_kwargs=None, conv_bias_initializer=None, conv_bias_initializer_kwargs=None, head_fcnet_hiddens=[], head_fcnet_activation='relu', head_fcnet_kernel_initializer=None, head_fcnet_kernel_initializer_kwargs=None, head_fcnet_bias_initializer=None, head_fcnet_bias_initializer_kwargs=None, free_log_std=False, log_std_clip_param=20.0, vf_share_layers=True, use_lstm=False, max_seq_len=20, lstm_cell_size=256, lstm_use_prev_action=False, lstm_use_prev_reward=False, lstm_kernel_initializer=None, lstm_kernel_initializer_kwargs=None, lstm_bias_initializer=None, lstm_bias_initializer_kwargs=None), catalog_class=None, load_state_path=None, model_config_dict=None)", "algorithm_config_overrides_per_module": {}, "_per_module_overrides": {}, "_validate_config": true, "_use_msgpack_checkpoints": false, "_torch_grad_scaler_class": null, "_torch_lr_scheduler_classes": null, "_tf_policy_handles_more_than_one_loss": false, "_disable_preprocessor_api": false, "_disable_action_flattening": false, "_disable_initialize_loss_from_dummy_batch": false, "_dont_auto_sync_env_runner_states": false, "env_task_fn": -1, "enable_connectors": -1, "simple_optimizer": false, "policy_map_cache": -1, "worker_cls": -1, "synchronize_filters": -1, "enable_async_evaluation": -1, "custom_async_evaluation_function": -1, "_enable_rl_module_api": -1, "auto_wrap_old_gym_envs": -1, "always_attach_evaluation_results": -1, "replay_sequence_length": null, "_disable_execution_plan_api": -1, "use_critic": true, "use_gae": true, "use_kl_loss": true, "kl_coeff": 0.7464963036515, "kl_target": 0.0270990929592, "vf_loss_coeff": 0.6688075857018, "entropy_coeff": 0.0090570820258, "clip_param": 0.1221781641624, "vf_clip_param": 0.1027808522125, "entropy_coeff_schedule": null, "lr_schedule": null, "sgd_minibatch_size": -1, "vf_share_layers": -1, "__stdout_file__": null, "__stderr_file__": null, "lambda": 0.9099046732075, "input": "sampler", "policies": {"default_policy": [null, null, null, null]}, "callbacks": "<class 'ray.rllib.callbacks.callbacks.RLlibCallback'>", "create_env_on_driver": false, "custom_eval_function": null, "framework": "torch"}, "time_since_restore": 122.73219656944275, "iterations_since_restore": 17, "perf": {"cpu_util_percent": 75.77142857142857, "ram_util_percent": 82.12857142857145}}
{"timers": {"training_iteration": 6.795198384138193, "restore_env_runners": 4.206564399106289e-05, "training_step": 6.79468063490009, "env_runner_sampling_timer": 6.459670298193731, "learner_update_timer": 0.32621230308170146, "synch_weights": 0.0018753040193927341, "restore_eval_env_runners": 1.761756034902803e-05, "evaluation_iteration": 0.38010713149346437, "synch_eval_env_connectors": 0.0005036604371489141, "synch_env_connectors": 1.8525710081053737e-05}, "env_runners": {"module_to_env_connector": {"timers": {"connectors": {"remove_single_ts_time_rank_from_batch": 1.7004094894190218e-06, "listify_data_for_vector_env": 3.0223249954667263e-05, "get_actions": 0.00013768919535402357, "normalize_and_clip_actions": 2.327960349099388e-05, "tensor_to_numpy": 4.207667426076639e-05, "un_batch_to_individual_items": 1.3655994388167974e-05}}, "connector_pipeline_timer": 0.000318874080599986}, "env_step_timer": 4.5072655402152077e-05, "env_to_module_connector": {"timers": {"connectors": {"numpy_to_tensor": 2.857250856696617e-05, "add_time_dim_to_batch_and_zero_pad": 5.954708101682636e-06, "add_observations_from_episodes_to_batch": 8.23054219267714e-06, "batch_individual_items": 1.7255126058167018e-05, "add_states_from_episodes_to_batch": 4.486017541511353e-06}}, "connector_pipeline_timer": 0.0001117799028981183}, "num_episodes_lifetime": -493500.0, "time_between_sampling": 0.003582925685682212, "num_agent_steps_sampled_lifetime": {"default_agent": -9870000.0}, "rlmodule_inference_timer": 0.00011839087644691436, "episode_return_mean": 2.8199999999999994, "episode_len_mean": 20.0, "env_reset_timer": 0.0001145730062215091, "num_agent_steps_sampled": {"default_agent": 5000.0}, "num_env_steps_sampled_lifetime": -9870000.0, "episode_return_max": 6.5, "num_episodes": 250.0, "env_to_module_sum_episodes_length_in": 10.36823839457432, "module_episode_returns_mean": {"default_policy": 2.8199999999999994}, "agent_episode_returns_mean": {"default_agent": 2.8199999999999994}, "num_module_steps_sampled": {"default_policy": 5000.0}, "num_env_steps_sampled": 5000.0, "episode_duration_sec_mean": 0.014232426937203856, "episode_len_min": 20, "sample": 0.015442341337217343, "episode_return_min": -13.5, "weights_seq_no": 17.0, "env_to_module_sum_episodes_length_out": 10.36823839457432, "num_module_steps_sampled_lifetime": {"default_policy": -9870000.0}, "episode_len_max": 20, "num_env_steps_sampled_lifetime_throughput": 1845.3934059953506}, "learners": {"default_policy": {"num_module_steps_trained": 6000, "num_module_steps_trained_lifetime": 108000, "curr_entropy_coeff": 0.0090570820258, "policy_loss": 0.1711471825838089, "total_loss": 0.23265135288238525, "weights_seq_no": 18.0, "default_optimizer_learning_rate": 0.0002847858517, "vf_loss_unclipped": 26.49570655822754, "entropy": 0.5282083749771118, "gradients_default_optimizer_global_norm": 0.06099133938550949, "num_trainable_parameters": 6003, "mean_kl_loss": 0.0007358924485743046, "module_train_batch_size_mean": 1000.0, "vf_loss": 0.09911397844552994, "diff_num_grad_updates_vs_sampler_policy": 1.0, "vf_explained_var": -0.009949445724487305, "curr_kl_coeff": 2.847657469828846e-06, "num_module_steps_trained_lifetime_throughput": 250126.95965171274}, "__all_modules__": {"learner_connector": {"timers": {"connectors": {"add_columns_from_episodes_to_train_batch": 0.10738752205985906, "add_time_dim_to_batch_and_zero_pad": 1.920260829589879e-05, "batch_individual_items": 0.06785728002740118, "add_states_from_episodes_to_batch": 5.252916987257084e-06, "numpy_to_tensor": 0.00011459924786041393, "add_one_ts_to_episodes_and_truncate": 0.027184709604333834, "general_advantage_estimation": 0.009681696946862746, "add_observations_from_episodes_to_batch": 0.0014312352720098882}}, "connector_pipeline_timer": 0.2141186697985481}, "num_trainable_parameters": 6003, "learner_connector_sum_episodes_length_in": 5000.0, "learner_connector_sum_episodes_length_out": 5250.0, "num_env_steps_trained": 31500, "num_module_steps_trained": 6000, "num_module_steps_trained_lifetime": 108000, "num_non_trainable_parameters": 0, "num_env_steps_trained_lifetime": 567000, "num_env_steps_trained_lifetime_throughput": 1303965.7037338708, "num_module_steps_trained_throughput": 249662.1388379538, "num_module_steps_trained_lifetime_throughput": 249158.85798747808}}, "num_training_step_calls_per_iteration": 1, "evaluation": {"env_runners": {"env_step_timer": 5.146057877487792e-05, "num_episodes_lifetime": 360, "env_reset_timer": 0.0010202197589032108, "num_env_steps_sampled_lifetime": 90400, "env_to_module_connector": {"timers": {"connectors": {"add_observations_from_episodes_to_batch": 1.9150414571408644e-05, "add_states_from_episodes_to_batch": 3.333114619765528e-06, "numpy_to_tensor": 3.2617670790575405e-05, "batch_individual_items": 2.0222850553831245e-05, "add_time_dim_to_batch_and_zero_pad": 5.857597252848211e-06}}, "connector_pipeline_timer": 0.00013557889016901356}, "num_agent_steps_sampled": {"default_agent": 400}, "episode_len_min": 20, "sample": 0.3517574157171729, "module_to_env_connector": {"timers": {"connectors": {"get_actions": 0.00015735710088124737, "un_batch_to_individual_items": 1.682315183169266e-05, "remove_single_ts_time_rank_from_batch": 1.322751854410579e-06, "listify_data_for_vector_env": 4.992659705243044e-05, "tensor_to_numpy": 4.552426445635003e-05, "normalize_and_clip_actions": 2.6203470350185882e-05}}, "connector_pipeline_timer": 0.00037530212367591136}, "episode_return_min": -12.5, "env_to_module_sum_episodes_length_out": 10.368238394574323, "rlmodule_inference_timer": 8.971865773403305e-05, "num_agent_steps_sampled_lifetime": {"default_agent": 7200}, "episode_duration_sec_mean": 0.015787266690749674, "module_episode_returns_mean": {"default_policy": 1.8}, "agent_episode_returns_mean": {"default_agent": 1.8}, "num_module_steps_sampled": {"default_policy": 400}, "episode_return_max": 13.5, "num_episodes": 20, "env_to_module_sum_episodes_length_in": 10.368238394574323, "num_env_steps_sampled": 400, "weights_seq_no": 18.0, "episode_return_mean": 1.8, "episode_len_mean": 20.0, "num_module_steps_sampled_lifetime": {"default_policy": 7200}, "episode_len_max": 20, "time_between_sampling": 6.178407655762958}, "num_healthy_workers": 1, "actor_manager_num_outstanding_async_reqs": 0, "num_remote_worker_restarts": 0}, "num_env_steps_sampled_lifetime": -9870000.0, "fault_tolerance": {"num_healthy_workers": 0, "num_remote_worker_restarts": 0}, "env_runner_group": {"actor_manager_num_outstanding_async_reqs": 0}, "done": false, "training_iteration": 18, "trial_id": "4995b_00000", "date": "2025-08-11_19-27-26", "timestamp": 1754933246, "time_this_iter_s": 4.894515037536621, "time_total_s": 127.62671160697937, "pid": 14987, "hostname": "Mac", "node_ip": "127.0.0.1", "config": {"exploration_config": {}, "extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "placement_strategy": "PACK", "num_gpus": 0, "_fake_gpus": false, "num_cpus_for_main_process": 2, "eager_tracing": true, "eager_max_retraces": 20, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "torch_compile_learner": false, "torch_compile_learner_what_to_compile": "forward_train", "torch_compile_learner_dynamo_backend": "aot_eager", "torch_compile_learner_dynamo_mode": null, "torch_compile_worker": false, "torch_compile_worker_dynamo_backend": "aot_eager", "torch_compile_worker_dynamo_mode": null, "torch_ddp_kwargs": {}, "torch_skip_nan_gradients": false, "env": "Umbrella", "env_config": {}, "observation_space": null, "action_space": null, "clip_rewards": null, "normalize_actions": true, "clip_actions": false, "_is_atari": null, "disable_env_checking": false, "render_env": false, "action_mask_key": "action_mask", "env_runner_cls": null, "num_env_runners": 0, "create_local_env_runner": true, "num_envs_per_env_runner": 1, "gym_env_vectorize_mode": "SYNC", "num_cpus_per_env_runner": 1, "num_gpus_per_env_runner": 0, "custom_resources_per_env_runner": {}, "validate_env_runners_after_construction": true, "episodes_to_numpy": true, "max_requests_in_flight_per_env_runner": 1, "sample_timeout_s": 60.0, "_env_to_module_connector": null, "add_default_connectors_to_env_to_module_pipeline": true, "_module_to_env_connector": null, "add_default_connectors_to_module_to_env_pipeline": true, "merge_env_runner_states": "training_only", "broadcast_env_runner_states": true, "episode_lookback_horizon": 1, "rollout_fragment_length": "auto", "batch_mode": "complete_episodes", "compress_observations": false, "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "enable_tf1_exec_eagerly": false, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "preprocessor_pref": "deepmind", "observation_filter": "NoFilter", "update_worker_filter_stats": true, "use_worker_filter_stats": true, "sampler_perf_stats_ema_coef": null, "_is_online": true, "num_learners": 0, "num_gpus_per_learner": 0, "num_cpus_per_learner": "auto", "num_aggregator_actors_per_learner": 0, "max_requests_in_flight_per_aggregator_actor": 3, "local_gpu_idx": 0, "max_requests_in_flight_per_learner": 3, "gamma": 1, "lr": 0.0002847858517, "grad_clip": 0.5, "grad_clip_by": "global_norm", "_train_batch_size_per_learner": 5000, "train_batch_size": 4000, "num_epochs": 1, "minibatch_size": 1000, "shuffle_batch_per_epoch": true, "model": {"fcnet_hiddens": [256, 256], "fcnet_activation": "tanh", "fcnet_weights_initializer": null, "fcnet_weights_initializer_config": null, "fcnet_bias_initializer": null, "fcnet_bias_initializer_config": null, "conv_filters": null, "conv_activation": "relu", "conv_kernel_initializer": null, "conv_kernel_initializer_config": null, "conv_bias_initializer": null, "conv_bias_initializer_config": null, "conv_transpose_kernel_initializer": null, "conv_transpose_kernel_initializer_config": null, "conv_transpose_bias_initializer": null, "conv_transpose_bias_initializer_config": null, "post_fcnet_hiddens": [], "post_fcnet_activation": "relu", "post_fcnet_weights_initializer": null, "post_fcnet_weights_initializer_config": null, "post_fcnet_bias_initializer": null, "post_fcnet_bias_initializer_config": null, "free_log_std": false, "log_std_clip_param": 20.0, "no_final_linear": false, "vf_share_layers": false, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "lstm_weights_initializer": null, "lstm_weights_initializer_config": null, "lstm_bias_initializer": null, "lstm_bias_initializer_config": null, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "attention_use_n_prev_actions": 0, "attention_use_n_prev_rewards": 0, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": null, "custom_model_config": {}, "custom_action_dist": null, "custom_preprocessor": null, "encoder_latent_dim": null, "always_check_shapes": false, "lstm_use_prev_action_reward": -1, "_use_default_native_models": -1, "_disable_preprocessor_api": false, "_disable_action_flattening": false}, "_learner_connector": null, "add_default_connectors_to_learner_pipeline": true, "learner_config_dict": {}, "optimizer": {}, "_learner_class": null, "callbacks_on_algorithm_init": null, "callbacks_on_env_runners_recreated": null, "callbacks_on_offline_eval_runners_recreated": null, "callbacks_on_checkpoint_loaded": null, "callbacks_on_environment_created": null, "callbacks_on_episode_created": null, "callbacks_on_episode_start": null, "callbacks_on_episode_step": null, "callbacks_on_episode_end": null, "callbacks_on_evaluate_start": null, "callbacks_on_evaluate_end": null, "callbacks_on_evaluate_offline_start": null, "callbacks_on_evaluate_offline_end": null, "callbacks_on_sample_end": null, "callbacks_on_train_result": null, "explore": true, "enable_rl_module_and_learner": true, "enable_env_runner_and_connector_v2": true, "_prior_exploration_config": {"type": "StochasticSampling"}, "count_steps_by": "env_steps", "policy_map_capacity": 100, "policy_mapping_fn": "<function AlgorithmConfig.DEFAULT_POLICY_MAPPING_FN at 0x3867f18a0>", "policies_to_train": null, "policy_states_are_swappable": false, "observation_fn": null, "offline_data_class": null, "input_read_method": "read_parquet", "input_read_method_kwargs": {}, "input_read_schema": {}, "input_read_episodes": false, "input_read_sample_batches": false, "input_read_batch_size": null, "input_filesystem": null, "input_filesystem_kwargs": {}, "input_compress_columns": ["obs", "new_obs"], "input_spaces_jsonable": true, "materialize_data": false, "materialize_mapped_data": true, "map_batches_kwargs": {}, "iter_batches_kwargs": {}, "ignore_final_observation": false, "prelearner_class": null, "prelearner_buffer_class": null, "prelearner_buffer_kwargs": {}, "prelearner_module_synch_period": 10, "dataset_num_iters_per_learner": null, "input_config": {}, "actions_in_input_normalized": false, "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_config": {}, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "output_max_rows_per_file": null, "output_write_remaining_data": false, "output_write_method": "write_parquet", "output_write_method_kwargs": {}, "output_filesystem": null, "output_filesystem_kwargs": {}, "output_write_episodes": true, "offline_sampling": false, "evaluation_interval": 1, "evaluation_duration": 20, "evaluation_duration_unit": "episodes", "evaluation_sample_timeout_s": 120.0, "evaluation_auto_duration_min_env_steps_per_sample": 100, "evaluation_auto_duration_max_env_steps_per_sample": 2000, "evaluation_parallel_to_training": false, "evaluation_force_reset_envs_before_iteration": true, "evaluation_config": null, "off_policy_estimation_methods": {}, "ope_split_batch_by_episode": true, "evaluation_num_env_runners": 1, "in_evaluation": false, "sync_filters_on_rollout_workers_timeout_s": 10.0, "offline_evaluation_interval": null, "num_offline_eval_runners": 0, "offline_loss_for_module_fn": null, "offline_evaluation_duration": 1, "offline_evaluation_parallel_to_training": false, "offline_evaluation_timeout_s": 120.0, "num_cpus_per_offline_eval_runner": 1, "num_gpus_per_offline_eval_runner": 0, "custom_resources_per_offline_eval_runner": {}, "restart_failed_offline_eval_runners": true, "ignore_offline_eval_runner_failures": false, "max_num_offline_eval_runner_restarts": 1000, "offline_eval_runner_restore_timeout_s": 1800.0, "max_requests_in_flight_per_offline_eval_runner": 1, "validate_offline_eval_runners_after_construction": true, "offline_eval_runner_health_probe_timeout_s": 30.0, "offline_eval_rl_module_inference_only": false, "broadcast_offline_eval_runner_states": false, "offline_eval_batch_size_per_runner": 256, "dataset_num_iters_per_eval_runner": 1, "keep_per_episode_custom_metrics": false, "metrics_episode_collection_timeout_s": 60.0, "metrics_num_episodes_for_smoothing": 100, "min_time_s_per_iteration": null, "min_train_timesteps_per_iteration": 0, "min_sample_timesteps_per_iteration": 0, "log_gradients": true, "export_native_model_files": false, "checkpoint_trainable_policies_only": false, "logger_creator": null, "logger_config": null, "log_level": "WARN", "log_sys_usage": true, "fake_sampler": false, "seed": 3, "restart_failed_env_runners": true, "ignore_env_runner_failures": false, "max_num_env_runner_restarts": 1000, "delay_between_env_runner_restarts_s": 60.0, "restart_failed_sub_environments": false, "num_consecutive_env_runner_failures_tolerance": 100, "env_runner_health_probe_timeout_s": 30.0, "env_runner_restore_timeout_s": 1800.0, "_model_config": {}, "_rl_module_spec": "RLModuleSpec(module_class=None, observation_space=None, action_space=None, inference_only=False, learner_only=False, model_config=DefaultModelConfig(fcnet_hiddens=[60, 90], fcnet_activation='tanh', fcnet_kernel_initializer=None, fcnet_kernel_initializer_kwargs=None, fcnet_bias_initializer=None, fcnet_bias_initializer_kwargs=None, conv_filters=None, conv_activation='relu', conv_kernel_initializer=None, conv_kernel_initializer_kwargs=None, conv_bias_initializer=None, conv_bias_initializer_kwargs=None, head_fcnet_hiddens=[], head_fcnet_activation='relu', head_fcnet_kernel_initializer=None, head_fcnet_kernel_initializer_kwargs=None, head_fcnet_bias_initializer=None, head_fcnet_bias_initializer_kwargs=None, free_log_std=False, log_std_clip_param=20.0, vf_share_layers=True, use_lstm=False, max_seq_len=20, lstm_cell_size=256, lstm_use_prev_action=False, lstm_use_prev_reward=False, lstm_kernel_initializer=None, lstm_kernel_initializer_kwargs=None, lstm_bias_initializer=None, lstm_bias_initializer_kwargs=None), catalog_class=None, load_state_path=None, model_config_dict=None)", "algorithm_config_overrides_per_module": {}, "_per_module_overrides": {}, "_validate_config": true, "_use_msgpack_checkpoints": false, "_torch_grad_scaler_class": null, "_torch_lr_scheduler_classes": null, "_tf_policy_handles_more_than_one_loss": false, "_disable_preprocessor_api": false, "_disable_action_flattening": false, "_disable_initialize_loss_from_dummy_batch": false, "_dont_auto_sync_env_runner_states": false, "env_task_fn": -1, "enable_connectors": -1, "simple_optimizer": false, "policy_map_cache": -1, "worker_cls": -1, "synchronize_filters": -1, "enable_async_evaluation": -1, "custom_async_evaluation_function": -1, "_enable_rl_module_api": -1, "auto_wrap_old_gym_envs": -1, "always_attach_evaluation_results": -1, "replay_sequence_length": null, "_disable_execution_plan_api": -1, "use_critic": true, "use_gae": true, "use_kl_loss": true, "kl_coeff": 0.7464963036515, "kl_target": 0.0270990929592, "vf_loss_coeff": 0.6688075857018, "entropy_coeff": 0.0090570820258, "clip_param": 0.1221781641624, "vf_clip_param": 0.1027808522125, "entropy_coeff_schedule": null, "lr_schedule": null, "sgd_minibatch_size": -1, "vf_share_layers": -1, "__stdout_file__": null, "__stderr_file__": null, "lambda": 0.9099046732075, "input": "sampler", "policies": {"default_policy": [null, null, null, null]}, "callbacks": "<class 'ray.rllib.callbacks.callbacks.RLlibCallback'>", "create_env_on_driver": false, "custom_eval_function": null, "framework": "torch"}, "time_since_restore": 127.62671160697937, "iterations_since_restore": 18, "perf": {"cpu_util_percent": 73.98571428571428, "ram_util_percent": 81.75714285714285}}
{"timers": {"training_iteration": 6.7737817332168415, "restore_env_runners": 4.171707773919359e-05, "training_step": 6.773266863970505, "env_runner_sampling_timer": 6.436215942711057, "learner_update_timer": 0.3282859063010803, "synch_weights": 0.001868257638769143, "restore_eval_env_runners": 1.7510133813842643e-05, "evaluation_iteration": 0.37992266017906207, "synch_eval_env_connectors": 0.0005004117532598816, "synch_env_connectors": 1.8377952683710092e-05}, "env_runners": {"module_to_env_connector": {"timers": {"connectors": {"remove_single_ts_time_rank_from_batch": 1.7520069037397866e-06, "listify_data_for_vector_env": 3.324131069114905e-05, "get_actions": 0.00014521991458102038, "normalize_and_clip_actions": 2.2706598282227964e-05, "tensor_to_numpy": 3.744991465806428e-05, "un_batch_to_individual_items": 1.4061940570274174e-05}}, "connector_pipeline_timer": 0.00031981545232131835}, "env_step_timer": 4.28568610437306e-05, "env_to_module_connector": {"timers": {"connectors": {"numpy_to_tensor": 3.525469234984117e-05, "add_time_dim_to_batch_and_zero_pad": 5.916980451594273e-06, "add_observations_from_episodes_to_batch": 1.0092580638507241e-05, "batch_individual_items": 2.165065247669655e-05, "add_states_from_episodes_to_batch": 3.923768389814346e-06}}, "connector_pipeline_timer": 0.0001269844429066865}, "num_episodes_lifetime": -524375.0, "time_between_sampling": 0.004571955939984353, "num_agent_steps_sampled_lifetime": {"default_agent": -10487500.0}, "rlmodule_inference_timer": 9.364608292013805e-05, "episode_return_mean": 3.8600000000000008, "episode_len_mean": 20.0, "env_reset_timer": 0.00010833638210726658, "num_agent_steps_sampled": {"default_agent": 5000.0}, "num_env_steps_sampled_lifetime": -10487500.0, "episode_return_max": 6.5, "num_episodes": 250.0, "env_to_module_sum_episodes_length_in": 10.36823839457432, "module_episode_returns_mean": {"default_policy": 3.8600000000000008}, "agent_episode_returns_mean": {"default_agent": 3.8600000000000008}, "num_module_steps_sampled": {"default_policy": 5000.0}, "num_env_steps_sampled": 5000.0, "episode_duration_sec_mean": 0.013967464297544207, "episode_len_min": 20, "sample": 0.01476880866473822, "episode_return_min": -13.5, "weights_seq_no": 18.0, "env_to_module_sum_episodes_length_out": 10.36823839457432, "num_module_steps_sampled_lifetime": {"default_policy": -10487500.0}, "episode_len_max": 20, "num_env_steps_sampled_lifetime_throughput": 1844.759582635929}, "learners": {"default_policy": {"num_module_steps_trained": 6000, "num_module_steps_trained_lifetime": 114000, "curr_entropy_coeff": 0.0090570820258, "policy_loss": -0.08550427854061127, "total_loss": -0.024771621450781822, "weights_seq_no": 19.0, "default_optimizer_learning_rate": 0.0002847858517, "vf_loss_unclipped": 24.051631927490234, "entropy": 0.5417179465293884, "gradients_default_optimizer_global_norm": 0.11087688058614731, "num_trainable_parameters": 6003, "mean_kl_loss": 3.7580906791845337e-05, "module_train_batch_size_mean": 1000.0, "vf_loss": 0.09814337641000748, "diff_num_grad_updates_vs_sampler_policy": 1.0, "vf_explained_var": -0.005461335182189941, "curr_kl_coeff": 1.423828734914423e-06, "num_module_steps_trained_lifetime_throughput": 247458.5411598662}, "__all_modules__": {"learner_connector": {"timers": {"connectors": {"add_columns_from_episodes_to_train_batch": 0.10699604724955686, "add_time_dim_to_batch_and_zero_pad": 1.9145161817431393e-05, "batch_individual_items": 0.0704769213970448, "add_states_from_episodes_to_batch": 5.237477738918574e-06, "numpy_to_tensor": 0.00011847909574620636, "add_one_ts_to_episodes_and_truncate": 0.02736035125908726, "general_advantage_estimation": 0.009782040398333445, "add_observations_from_episodes_to_batch": 0.0014374874984618494}}, "connector_pipeline_timer": 0.21663443600998938}, "num_trainable_parameters": 6003, "learner_connector_sum_episodes_length_in": 5000.0, "learner_connector_sum_episodes_length_out": 5250.0, "num_env_steps_trained": 31500, "num_module_steps_trained": 6000, "num_module_steps_trained_lifetime": 114000, "num_non_trainable_parameters": 0, "num_env_steps_trained_lifetime": 598500, "num_env_steps_trained_lifetime_throughput": 1290462.7685548174, "num_module_steps_trained_throughput": 247029.95151779527, "num_module_steps_trained_lifetime_throughput": 246542.59716124827}}, "num_training_step_calls_per_iteration": 1, "evaluation": {"env_runners": {"env_step_timer": 3.592870211588339e-05, "num_episodes_lifetime": 380, "env_reset_timer": 0.001011501311843766, "num_env_steps_sampled_lifetime": 95400, "env_to_module_connector": {"timers": {"connectors": {"add_observations_from_episodes_to_batch": 8.447297607747447e-06, "add_states_from_episodes_to_batch": 3.6206921304883915e-06, "numpy_to_tensor": 2.5069554108284745e-05, "batch_individual_items": 3.961464019498726e-05, "add_time_dim_to_batch_and_zero_pad": 5.500561985734748e-06}}, "connector_pipeline_timer": 0.00013761167411838765}, "num_agent_steps_sampled": {"default_agent": 400}, "episode_len_min": 20, "sample": 0.3508690707302714, "module_to_env_connector": {"timers": {"connectors": {"get_actions": 0.00011518648126581234, "un_batch_to_individual_items": 1.4821020634486398e-05, "remove_single_ts_time_rank_from_batch": 1.3002857319002574e-06, "listify_data_for_vector_env": 2.8238184480349016e-05, "tensor_to_numpy": 3.4385041378655666e-05, "normalize_and_clip_actions": 2.1215064712325023e-05}}, "connector_pipeline_timer": 0.00027246968712689614}, "episode_return_min": -12.5, "env_to_module_sum_episodes_length_out": 10.368238394574323, "rlmodule_inference_timer": 8.463878600632474e-05, "num_agent_steps_sampled_lifetime": {"default_agent": 7600}, "episode_duration_sec_mean": 0.013207431256305427, "module_episode_returns_mean": {"default_policy": 1.8}, "agent_episode_returns_mean": {"default_agent": 1.8}, "num_module_steps_sampled": {"default_policy": 400}, "episode_return_max": 13.5, "num_episodes": 20, "env_to_module_sum_episodes_length_in": 10.368238394574323, "num_env_steps_sampled": 400, "weights_seq_no": 19.0, "episode_return_mean": 1.8, "episode_len_mean": 20.0, "num_module_steps_sampled_lifetime": {"default_policy": 7600}, "episode_len_max": 20, "time_between_sampling": 6.1635348442055635}, "num_healthy_workers": 1, "actor_manager_num_outstanding_async_reqs": 0, "num_remote_worker_restarts": 0}, "num_env_steps_sampled_lifetime": -10487500.0, "fault_tolerance": {"num_healthy_workers": 0, "num_remote_worker_restarts": 0}, "env_runner_group": {"actor_manager_num_outstanding_async_reqs": 0}, "done": false, "training_iteration": 19, "trial_id": "4995b_00000", "date": "2025-08-11_19-27-31", "timestamp": 1754933251, "time_this_iter_s": 4.929837226867676, "time_total_s": 132.55654883384705, "pid": 14987, "hostname": "Mac", "node_ip": "127.0.0.1", "config": {"exploration_config": {}, "extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "placement_strategy": "PACK", "num_gpus": 0, "_fake_gpus": false, "num_cpus_for_main_process": 2, "eager_tracing": true, "eager_max_retraces": 20, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "torch_compile_learner": false, "torch_compile_learner_what_to_compile": "forward_train", "torch_compile_learner_dynamo_backend": "aot_eager", "torch_compile_learner_dynamo_mode": null, "torch_compile_worker": false, "torch_compile_worker_dynamo_backend": "aot_eager", "torch_compile_worker_dynamo_mode": null, "torch_ddp_kwargs": {}, "torch_skip_nan_gradients": false, "env": "Umbrella", "env_config": {}, "observation_space": null, "action_space": null, "clip_rewards": null, "normalize_actions": true, "clip_actions": false, "_is_atari": null, "disable_env_checking": false, "render_env": false, "action_mask_key": "action_mask", "env_runner_cls": null, "num_env_runners": 0, "create_local_env_runner": true, "num_envs_per_env_runner": 1, "gym_env_vectorize_mode": "SYNC", "num_cpus_per_env_runner": 1, "num_gpus_per_env_runner": 0, "custom_resources_per_env_runner": {}, "validate_env_runners_after_construction": true, "episodes_to_numpy": true, "max_requests_in_flight_per_env_runner": 1, "sample_timeout_s": 60.0, "_env_to_module_connector": null, "add_default_connectors_to_env_to_module_pipeline": true, "_module_to_env_connector": null, "add_default_connectors_to_module_to_env_pipeline": true, "merge_env_runner_states": "training_only", "broadcast_env_runner_states": true, "episode_lookback_horizon": 1, "rollout_fragment_length": "auto", "batch_mode": "complete_episodes", "compress_observations": false, "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "enable_tf1_exec_eagerly": false, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "preprocessor_pref": "deepmind", "observation_filter": "NoFilter", "update_worker_filter_stats": true, "use_worker_filter_stats": true, "sampler_perf_stats_ema_coef": null, "_is_online": true, "num_learners": 0, "num_gpus_per_learner": 0, "num_cpus_per_learner": "auto", "num_aggregator_actors_per_learner": 0, "max_requests_in_flight_per_aggregator_actor": 3, "local_gpu_idx": 0, "max_requests_in_flight_per_learner": 3, "gamma": 1, "lr": 0.0002847858517, "grad_clip": 0.5, "grad_clip_by": "global_norm", "_train_batch_size_per_learner": 5000, "train_batch_size": 4000, "num_epochs": 1, "minibatch_size": 1000, "shuffle_batch_per_epoch": true, "model": {"fcnet_hiddens": [256, 256], "fcnet_activation": "tanh", "fcnet_weights_initializer": null, "fcnet_weights_initializer_config": null, "fcnet_bias_initializer": null, "fcnet_bias_initializer_config": null, "conv_filters": null, "conv_activation": "relu", "conv_kernel_initializer": null, "conv_kernel_initializer_config": null, "conv_bias_initializer": null, "conv_bias_initializer_config": null, "conv_transpose_kernel_initializer": null, "conv_transpose_kernel_initializer_config": null, "conv_transpose_bias_initializer": null, "conv_transpose_bias_initializer_config": null, "post_fcnet_hiddens": [], "post_fcnet_activation": "relu", "post_fcnet_weights_initializer": null, "post_fcnet_weights_initializer_config": null, "post_fcnet_bias_initializer": null, "post_fcnet_bias_initializer_config": null, "free_log_std": false, "log_std_clip_param": 20.0, "no_final_linear": false, "vf_share_layers": false, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "lstm_weights_initializer": null, "lstm_weights_initializer_config": null, "lstm_bias_initializer": null, "lstm_bias_initializer_config": null, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "attention_use_n_prev_actions": 0, "attention_use_n_prev_rewards": 0, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": null, "custom_model_config": {}, "custom_action_dist": null, "custom_preprocessor": null, "encoder_latent_dim": null, "always_check_shapes": false, "lstm_use_prev_action_reward": -1, "_use_default_native_models": -1, "_disable_preprocessor_api": false, "_disable_action_flattening": false}, "_learner_connector": null, "add_default_connectors_to_learner_pipeline": true, "learner_config_dict": {}, "optimizer": {}, "_learner_class": null, "callbacks_on_algorithm_init": null, "callbacks_on_env_runners_recreated": null, "callbacks_on_offline_eval_runners_recreated": null, "callbacks_on_checkpoint_loaded": null, "callbacks_on_environment_created": null, "callbacks_on_episode_created": null, "callbacks_on_episode_start": null, "callbacks_on_episode_step": null, "callbacks_on_episode_end": null, "callbacks_on_evaluate_start": null, "callbacks_on_evaluate_end": null, "callbacks_on_evaluate_offline_start": null, "callbacks_on_evaluate_offline_end": null, "callbacks_on_sample_end": null, "callbacks_on_train_result": null, "explore": true, "enable_rl_module_and_learner": true, "enable_env_runner_and_connector_v2": true, "_prior_exploration_config": {"type": "StochasticSampling"}, "count_steps_by": "env_steps", "policy_map_capacity": 100, "policy_mapping_fn": "<function AlgorithmConfig.DEFAULT_POLICY_MAPPING_FN at 0x3867f18a0>", "policies_to_train": null, "policy_states_are_swappable": false, "observation_fn": null, "offline_data_class": null, "input_read_method": "read_parquet", "input_read_method_kwargs": {}, "input_read_schema": {}, "input_read_episodes": false, "input_read_sample_batches": false, "input_read_batch_size": null, "input_filesystem": null, "input_filesystem_kwargs": {}, "input_compress_columns": ["obs", "new_obs"], "input_spaces_jsonable": true, "materialize_data": false, "materialize_mapped_data": true, "map_batches_kwargs": {}, "iter_batches_kwargs": {}, "ignore_final_observation": false, "prelearner_class": null, "prelearner_buffer_class": null, "prelearner_buffer_kwargs": {}, "prelearner_module_synch_period": 10, "dataset_num_iters_per_learner": null, "input_config": {}, "actions_in_input_normalized": false, "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_config": {}, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "output_max_rows_per_file": null, "output_write_remaining_data": false, "output_write_method": "write_parquet", "output_write_method_kwargs": {}, "output_filesystem": null, "output_filesystem_kwargs": {}, "output_write_episodes": true, "offline_sampling": false, "evaluation_interval": 1, "evaluation_duration": 20, "evaluation_duration_unit": "episodes", "evaluation_sample_timeout_s": 120.0, "evaluation_auto_duration_min_env_steps_per_sample": 100, "evaluation_auto_duration_max_env_steps_per_sample": 2000, "evaluation_parallel_to_training": false, "evaluation_force_reset_envs_before_iteration": true, "evaluation_config": null, "off_policy_estimation_methods": {}, "ope_split_batch_by_episode": true, "evaluation_num_env_runners": 1, "in_evaluation": false, "sync_filters_on_rollout_workers_timeout_s": 10.0, "offline_evaluation_interval": null, "num_offline_eval_runners": 0, "offline_loss_for_module_fn": null, "offline_evaluation_duration": 1, "offline_evaluation_parallel_to_training": false, "offline_evaluation_timeout_s": 120.0, "num_cpus_per_offline_eval_runner": 1, "num_gpus_per_offline_eval_runner": 0, "custom_resources_per_offline_eval_runner": {}, "restart_failed_offline_eval_runners": true, "ignore_offline_eval_runner_failures": false, "max_num_offline_eval_runner_restarts": 1000, "offline_eval_runner_restore_timeout_s": 1800.0, "max_requests_in_flight_per_offline_eval_runner": 1, "validate_offline_eval_runners_after_construction": true, "offline_eval_runner_health_probe_timeout_s": 30.0, "offline_eval_rl_module_inference_only": false, "broadcast_offline_eval_runner_states": false, "offline_eval_batch_size_per_runner": 256, "dataset_num_iters_per_eval_runner": 1, "keep_per_episode_custom_metrics": false, "metrics_episode_collection_timeout_s": 60.0, "metrics_num_episodes_for_smoothing": 100, "min_time_s_per_iteration": null, "min_train_timesteps_per_iteration": 0, "min_sample_timesteps_per_iteration": 0, "log_gradients": true, "export_native_model_files": false, "checkpoint_trainable_policies_only": false, "logger_creator": null, "logger_config": null, "log_level": "WARN", "log_sys_usage": true, "fake_sampler": false, "seed": 3, "restart_failed_env_runners": true, "ignore_env_runner_failures": false, "max_num_env_runner_restarts": 1000, "delay_between_env_runner_restarts_s": 60.0, "restart_failed_sub_environments": false, "num_consecutive_env_runner_failures_tolerance": 100, "env_runner_health_probe_timeout_s": 30.0, "env_runner_restore_timeout_s": 1800.0, "_model_config": {}, "_rl_module_spec": "RLModuleSpec(module_class=None, observation_space=None, action_space=None, inference_only=False, learner_only=False, model_config=DefaultModelConfig(fcnet_hiddens=[60, 90], fcnet_activation='tanh', fcnet_kernel_initializer=None, fcnet_kernel_initializer_kwargs=None, fcnet_bias_initializer=None, fcnet_bias_initializer_kwargs=None, conv_filters=None, conv_activation='relu', conv_kernel_initializer=None, conv_kernel_initializer_kwargs=None, conv_bias_initializer=None, conv_bias_initializer_kwargs=None, head_fcnet_hiddens=[], head_fcnet_activation='relu', head_fcnet_kernel_initializer=None, head_fcnet_kernel_initializer_kwargs=None, head_fcnet_bias_initializer=None, head_fcnet_bias_initializer_kwargs=None, free_log_std=False, log_std_clip_param=20.0, vf_share_layers=True, use_lstm=False, max_seq_len=20, lstm_cell_size=256, lstm_use_prev_action=False, lstm_use_prev_reward=False, lstm_kernel_initializer=None, lstm_kernel_initializer_kwargs=None, lstm_bias_initializer=None, lstm_bias_initializer_kwargs=None), catalog_class=None, load_state_path=None, model_config_dict=None)", "algorithm_config_overrides_per_module": {}, "_per_module_overrides": {}, "_validate_config": true, "_use_msgpack_checkpoints": false, "_torch_grad_scaler_class": null, "_torch_lr_scheduler_classes": null, "_tf_policy_handles_more_than_one_loss": false, "_disable_preprocessor_api": false, "_disable_action_flattening": false, "_disable_initialize_loss_from_dummy_batch": false, "_dont_auto_sync_env_runner_states": false, "env_task_fn": -1, "enable_connectors": -1, "simple_optimizer": false, "policy_map_cache": -1, "worker_cls": -1, "synchronize_filters": -1, "enable_async_evaluation": -1, "custom_async_evaluation_function": -1, "_enable_rl_module_api": -1, "auto_wrap_old_gym_envs": -1, "always_attach_evaluation_results": -1, "replay_sequence_length": null, "_disable_execution_plan_api": -1, "use_critic": true, "use_gae": true, "use_kl_loss": true, "kl_coeff": 0.7464963036515, "kl_target": 0.0270990929592, "vf_loss_coeff": 0.6688075857018, "entropy_coeff": 0.0090570820258, "clip_param": 0.1221781641624, "vf_clip_param": 0.1027808522125, "entropy_coeff_schedule": null, "lr_schedule": null, "sgd_minibatch_size": -1, "vf_share_layers": -1, "__stdout_file__": null, "__stderr_file__": null, "lambda": 0.9099046732075, "input": "sampler", "policies": {"default_policy": [null, null, null, null]}, "callbacks": "<class 'ray.rllib.callbacks.callbacks.RLlibCallback'>", "create_env_on_driver": false, "custom_eval_function": null, "framework": "torch"}, "time_since_restore": 132.55654883384705, "iterations_since_restore": 19, "perf": {"cpu_util_percent": 85.92857142857143, "ram_util_percent": 81.61428571428573}}
{"timers": {"training_iteration": 6.773083034634927, "restore_env_runners": 4.135698655824662e-05, "training_step": 6.772570777409818, "env_runner_sampling_timer": 6.4368932420337615, "learner_update_timer": 0.3269468813978256, "synch_weights": 0.0018666588117893538, "restore_eval_env_runners": 1.7480442197585368e-05, "evaluation_iteration": 0.37883035732633646, "synch_eval_env_connectors": 0.0004973034662281537, "synch_env_connectors": 1.8235003502697353e-05}, "env_runners": {"module_to_env_connector": {"timers": {"connectors": {"remove_single_ts_time_rank_from_batch": 2.874859448019763e-06, "listify_data_for_vector_env": 5.3787273139858006e-05, "get_actions": 0.0002588242268355697, "normalize_and_clip_actions": 4.0059911560431885e-05, "tensor_to_numpy": 5.520592717054491e-05, "un_batch_to_individual_items": 1.8684794830086313e-05}}, "connector_pipeline_timer": 0.0005271527403173955}, "env_step_timer": 6.240475659030162e-05, "env_to_module_connector": {"timers": {"connectors": {"numpy_to_tensor": 4.331616738128279e-05, "add_time_dim_to_batch_and_zero_pad": 8.56751331803715e-06, "add_observations_from_episodes_to_batch": 1.097904860059054e-05, "batch_individual_items": 2.8611894414576878e-05, "add_states_from_episodes_to_batch": 5.145234605459399e-06}}, "connector_pipeline_timer": 0.0001757315923535166}, "num_episodes_lifetime": -555250.0, "time_between_sampling": 0.005212559392932384, "num_agent_steps_sampled_lifetime": {"default_agent": -11105000.0}, "rlmodule_inference_timer": 0.0001566448377219571, "episode_return_mean": 3.62, "episode_len_mean": 20.0, "env_reset_timer": 0.0001435578574112771, "num_agent_steps_sampled": {"default_agent": 5000.0}, "num_env_steps_sampled_lifetime": -11105000.0, "episode_return_max": 6.5, "num_episodes": 250.0, "env_to_module_sum_episodes_length_in": 10.36823839457432, "module_episode_returns_mean": {"default_policy": 3.62}, "agent_episode_returns_mean": {"default_agent": 3.62}, "num_module_steps_sampled": {"default_policy": 5000.0}, "num_env_steps_sampled": 5000.0, "episode_duration_sec_mean": 0.021307754180859777, "episode_len_min": 20, "sample": 0.017906172856872737, "episode_return_min": -13.5, "weights_seq_no": 19.0, "env_to_module_sum_episodes_length_out": 10.36823839457432, "num_module_steps_sampled_lifetime": {"default_policy": -11105000.0}, "episode_len_max": 20, "num_env_steps_sampled_lifetime_throughput": 1616.6049986344833}, "learners": {"default_policy": {"num_module_steps_trained": 6000, "num_module_steps_trained_lifetime": 120000, "curr_entropy_coeff": 0.0090570820258, "policy_loss": 0.05764909088611603, "total_loss": 0.1188291683793068, "weights_seq_no": 20.0, "default_optimizer_learning_rate": 0.0002847858517, "vf_loss_unclipped": 25.19484519958496, "entropy": 0.5321364998817444, "gradients_default_optimizer_global_norm": 0.08247192203998566, "num_trainable_parameters": 6003, "mean_kl_loss": 3.7657540815416723e-05, "module_train_batch_size_mean": 1000.0, "vf_loss": 0.09868261218070984, "diff_num_grad_updates_vs_sampler_policy": 1.0, "vf_explained_var": -0.007982969284057617, "curr_kl_coeff": 7.119143674572115e-07, "num_module_steps_trained_lifetime_throughput": 244761.46497594382}, "__all_modules__": {"learner_connector": {"timers": {"connectors": {"add_columns_from_episodes_to_train_batch": 0.10658371594751632, "add_time_dim_to_batch_and_zero_pad": 1.9280789523308817e-05, "batch_individual_items": 0.0703732325923255, "add_states_from_episodes_to_batch": 5.229272098783746e-06, "numpy_to_tensor": 0.00011876972463790163, "add_one_ts_to_episodes_and_truncate": 0.02729164899587717, "general_advantage_estimation": 0.009777852084488382, "add_observations_from_episodes_to_batch": 0.0014340738734136028}}, "connector_pipeline_timer": 0.2160402308094329}, "num_trainable_parameters": 6003, "learner_connector_sum_episodes_length_in": 5000.0, "learner_connector_sum_episodes_length_out": 5250.0, "num_env_steps_trained": 31500, "num_module_steps_trained": 6000, "num_module_steps_trained_lifetime": 120000, "num_non_trainable_parameters": 0, "num_env_steps_trained_lifetime": 630000, "num_env_steps_trained_lifetime_throughput": 1276826.6619820069, "num_module_steps_trained_throughput": 244366.64403628962, "num_module_steps_trained_lifetime_throughput": 243897.37971880788}}, "num_training_step_calls_per_iteration": 1, "evaluation": {"env_runners": {"env_step_timer": 3.5822921081901536e-05, "num_episodes_lifetime": 400, "env_reset_timer": 0.0010048275484442178, "num_env_steps_sampled_lifetime": 100400, "env_to_module_connector": {"timers": {"connectors": {"add_observations_from_episodes_to_batch": 5.42842943209509e-06, "add_states_from_episodes_to_batch": 2.7016559752629575e-06, "numpy_to_tensor": 2.3175419476628574e-05, "batch_individual_items": 1.5807951241629326e-05, "add_time_dim_to_batch_and_zero_pad": 4.515910460566966e-06}}, "connector_pipeline_timer": 9.454024606341183e-05}, "num_agent_steps_sampled": {"default_agent": 400}, "episode_len_min": 20, "sample": 0.34994574418286384, "module_to_env_connector": {"timers": {"connectors": {"get_actions": 0.00010320466978945866, "un_batch_to_individual_items": 1.028917946343903e-05, "remove_single_ts_time_rank_from_batch": 1.0391787595594268e-06, "listify_data_for_vector_env": 2.480189855524056e-05, "tensor_to_numpy": 2.9133569734080897e-05, "normalize_and_clip_actions": 2.046204897784135e-05}}, "connector_pipeline_timer": 0.00023987543804297778}, "episode_return_min": -12.5, "env_to_module_sum_episodes_length_out": 10.368238394574323, "rlmodule_inference_timer": 7.535397837215874e-05, "num_agent_steps_sampled_lifetime": {"default_agent": 8000}, "episode_duration_sec_mean": 0.013302472931100056, "module_episode_returns_mean": {"default_policy": 2.0}, "agent_episode_returns_mean": {"default_agent": 2.0}, "num_module_steps_sampled": {"default_policy": 400}, "episode_return_max": 13.5, "num_episodes": 20, "env_to_module_sum_episodes_length_in": 10.368238394574323, "num_env_steps_sampled": 400, "weights_seq_no": 20.0, "episode_return_mean": 2.0, "episode_len_mean": 20.0, "num_module_steps_sampled_lifetime": {"default_policy": 8000}, "episode_len_max": 20, "time_between_sampling": 6.169194761602711}, "num_healthy_workers": 1, "actor_manager_num_outstanding_async_reqs": 0, "num_remote_worker_restarts": 0}, "num_env_steps_sampled_lifetime": -11105000.0, "fault_tolerance": {"num_healthy_workers": 0, "num_remote_worker_restarts": 0}, "env_runner_group": {"actor_manager_num_outstanding_async_reqs": 0}, "done": true, "training_iteration": 20, "trial_id": "4995b_00000", "date": "2025-08-11_19-27-38", "timestamp": 1754933258, "time_this_iter_s": 6.9744651317596436, "time_total_s": 139.5310139656067, "pid": 14987, "hostname": "Mac", "node_ip": "127.0.0.1", "config": {"exploration_config": {}, "extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "placement_strategy": "PACK", "num_gpus": 0, "_fake_gpus": false, "num_cpus_for_main_process": 2, "eager_tracing": true, "eager_max_retraces": 20, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "torch_compile_learner": false, "torch_compile_learner_what_to_compile": "forward_train", "torch_compile_learner_dynamo_backend": "aot_eager", "torch_compile_learner_dynamo_mode": null, "torch_compile_worker": false, "torch_compile_worker_dynamo_backend": "aot_eager", "torch_compile_worker_dynamo_mode": null, "torch_ddp_kwargs": {}, "torch_skip_nan_gradients": false, "env": "Umbrella", "env_config": {}, "observation_space": null, "action_space": null, "clip_rewards": null, "normalize_actions": true, "clip_actions": false, "_is_atari": null, "disable_env_checking": false, "render_env": false, "action_mask_key": "action_mask", "env_runner_cls": null, "num_env_runners": 0, "create_local_env_runner": true, "num_envs_per_env_runner": 1, "gym_env_vectorize_mode": "SYNC", "num_cpus_per_env_runner": 1, "num_gpus_per_env_runner": 0, "custom_resources_per_env_runner": {}, "validate_env_runners_after_construction": true, "episodes_to_numpy": true, "max_requests_in_flight_per_env_runner": 1, "sample_timeout_s": 60.0, "_env_to_module_connector": null, "add_default_connectors_to_env_to_module_pipeline": true, "_module_to_env_connector": null, "add_default_connectors_to_module_to_env_pipeline": true, "merge_env_runner_states": "training_only", "broadcast_env_runner_states": true, "episode_lookback_horizon": 1, "rollout_fragment_length": "auto", "batch_mode": "complete_episodes", "compress_observations": false, "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "enable_tf1_exec_eagerly": false, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "preprocessor_pref": "deepmind", "observation_filter": "NoFilter", "update_worker_filter_stats": true, "use_worker_filter_stats": true, "sampler_perf_stats_ema_coef": null, "_is_online": true, "num_learners": 0, "num_gpus_per_learner": 0, "num_cpus_per_learner": "auto", "num_aggregator_actors_per_learner": 0, "max_requests_in_flight_per_aggregator_actor": 3, "local_gpu_idx": 0, "max_requests_in_flight_per_learner": 3, "gamma": 1, "lr": 0.0002847858517, "grad_clip": 0.5, "grad_clip_by": "global_norm", "_train_batch_size_per_learner": 5000, "train_batch_size": 4000, "num_epochs": 1, "minibatch_size": 1000, "shuffle_batch_per_epoch": true, "model": {"fcnet_hiddens": [256, 256], "fcnet_activation": "tanh", "fcnet_weights_initializer": null, "fcnet_weights_initializer_config": null, "fcnet_bias_initializer": null, "fcnet_bias_initializer_config": null, "conv_filters": null, "conv_activation": "relu", "conv_kernel_initializer": null, "conv_kernel_initializer_config": null, "conv_bias_initializer": null, "conv_bias_initializer_config": null, "conv_transpose_kernel_initializer": null, "conv_transpose_kernel_initializer_config": null, "conv_transpose_bias_initializer": null, "conv_transpose_bias_initializer_config": null, "post_fcnet_hiddens": [], "post_fcnet_activation": "relu", "post_fcnet_weights_initializer": null, "post_fcnet_weights_initializer_config": null, "post_fcnet_bias_initializer": null, "post_fcnet_bias_initializer_config": null, "free_log_std": false, "log_std_clip_param": 20.0, "no_final_linear": false, "vf_share_layers": false, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "lstm_weights_initializer": null, "lstm_weights_initializer_config": null, "lstm_bias_initializer": null, "lstm_bias_initializer_config": null, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "attention_use_n_prev_actions": 0, "attention_use_n_prev_rewards": 0, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": null, "custom_model_config": {}, "custom_action_dist": null, "custom_preprocessor": null, "encoder_latent_dim": null, "always_check_shapes": false, "lstm_use_prev_action_reward": -1, "_use_default_native_models": -1, "_disable_preprocessor_api": false, "_disable_action_flattening": false}, "_learner_connector": null, "add_default_connectors_to_learner_pipeline": true, "learner_config_dict": {}, "optimizer": {}, "_learner_class": null, "callbacks_on_algorithm_init": null, "callbacks_on_env_runners_recreated": null, "callbacks_on_offline_eval_runners_recreated": null, "callbacks_on_checkpoint_loaded": null, "callbacks_on_environment_created": null, "callbacks_on_episode_created": null, "callbacks_on_episode_start": null, "callbacks_on_episode_step": null, "callbacks_on_episode_end": null, "callbacks_on_evaluate_start": null, "callbacks_on_evaluate_end": null, "callbacks_on_evaluate_offline_start": null, "callbacks_on_evaluate_offline_end": null, "callbacks_on_sample_end": null, "callbacks_on_train_result": null, "explore": true, "enable_rl_module_and_learner": true, "enable_env_runner_and_connector_v2": true, "_prior_exploration_config": {"type": "StochasticSampling"}, "count_steps_by": "env_steps", "policy_map_capacity": 100, "policy_mapping_fn": "<function AlgorithmConfig.DEFAULT_POLICY_MAPPING_FN at 0x3867f18a0>", "policies_to_train": null, "policy_states_are_swappable": false, "observation_fn": null, "offline_data_class": null, "input_read_method": "read_parquet", "input_read_method_kwargs": {}, "input_read_schema": {}, "input_read_episodes": false, "input_read_sample_batches": false, "input_read_batch_size": null, "input_filesystem": null, "input_filesystem_kwargs": {}, "input_compress_columns": ["obs", "new_obs"], "input_spaces_jsonable": true, "materialize_data": false, "materialize_mapped_data": true, "map_batches_kwargs": {}, "iter_batches_kwargs": {}, "ignore_final_observation": false, "prelearner_class": null, "prelearner_buffer_class": null, "prelearner_buffer_kwargs": {}, "prelearner_module_synch_period": 10, "dataset_num_iters_per_learner": null, "input_config": {}, "actions_in_input_normalized": false, "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_config": {}, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "output_max_rows_per_file": null, "output_write_remaining_data": false, "output_write_method": "write_parquet", "output_write_method_kwargs": {}, "output_filesystem": null, "output_filesystem_kwargs": {}, "output_write_episodes": true, "offline_sampling": false, "evaluation_interval": 1, "evaluation_duration": 20, "evaluation_duration_unit": "episodes", "evaluation_sample_timeout_s": 120.0, "evaluation_auto_duration_min_env_steps_per_sample": 100, "evaluation_auto_duration_max_env_steps_per_sample": 2000, "evaluation_parallel_to_training": false, "evaluation_force_reset_envs_before_iteration": true, "evaluation_config": null, "off_policy_estimation_methods": {}, "ope_split_batch_by_episode": true, "evaluation_num_env_runners": 1, "in_evaluation": false, "sync_filters_on_rollout_workers_timeout_s": 10.0, "offline_evaluation_interval": null, "num_offline_eval_runners": 0, "offline_loss_for_module_fn": null, "offline_evaluation_duration": 1, "offline_evaluation_parallel_to_training": false, "offline_evaluation_timeout_s": 120.0, "num_cpus_per_offline_eval_runner": 1, "num_gpus_per_offline_eval_runner": 0, "custom_resources_per_offline_eval_runner": {}, "restart_failed_offline_eval_runners": true, "ignore_offline_eval_runner_failures": false, "max_num_offline_eval_runner_restarts": 1000, "offline_eval_runner_restore_timeout_s": 1800.0, "max_requests_in_flight_per_offline_eval_runner": 1, "validate_offline_eval_runners_after_construction": true, "offline_eval_runner_health_probe_timeout_s": 30.0, "offline_eval_rl_module_inference_only": false, "broadcast_offline_eval_runner_states": false, "offline_eval_batch_size_per_runner": 256, "dataset_num_iters_per_eval_runner": 1, "keep_per_episode_custom_metrics": false, "metrics_episode_collection_timeout_s": 60.0, "metrics_num_episodes_for_smoothing": 100, "min_time_s_per_iteration": null, "min_train_timesteps_per_iteration": 0, "min_sample_timesteps_per_iteration": 0, "log_gradients": true, "export_native_model_files": false, "checkpoint_trainable_policies_only": false, "logger_creator": null, "logger_config": null, "log_level": "WARN", "log_sys_usage": true, "fake_sampler": false, "seed": 3, "restart_failed_env_runners": true, "ignore_env_runner_failures": false, "max_num_env_runner_restarts": 1000, "delay_between_env_runner_restarts_s": 60.0, "restart_failed_sub_environments": false, "num_consecutive_env_runner_failures_tolerance": 100, "env_runner_health_probe_timeout_s": 30.0, "env_runner_restore_timeout_s": 1800.0, "_model_config": {}, "_rl_module_spec": "RLModuleSpec(module_class=None, observation_space=None, action_space=None, inference_only=False, learner_only=False, model_config=DefaultModelConfig(fcnet_hiddens=[60, 90], fcnet_activation='tanh', fcnet_kernel_initializer=None, fcnet_kernel_initializer_kwargs=None, fcnet_bias_initializer=None, fcnet_bias_initializer_kwargs=None, conv_filters=None, conv_activation='relu', conv_kernel_initializer=None, conv_kernel_initializer_kwargs=None, conv_bias_initializer=None, conv_bias_initializer_kwargs=None, head_fcnet_hiddens=[], head_fcnet_activation='relu', head_fcnet_kernel_initializer=None, head_fcnet_kernel_initializer_kwargs=None, head_fcnet_bias_initializer=None, head_fcnet_bias_initializer_kwargs=None, free_log_std=False, log_std_clip_param=20.0, vf_share_layers=True, use_lstm=False, max_seq_len=20, lstm_cell_size=256, lstm_use_prev_action=False, lstm_use_prev_reward=False, lstm_kernel_initializer=None, lstm_kernel_initializer_kwargs=None, lstm_bias_initializer=None, lstm_bias_initializer_kwargs=None), catalog_class=None, load_state_path=None, model_config_dict=None)", "algorithm_config_overrides_per_module": {}, "_per_module_overrides": {}, "_validate_config": true, "_use_msgpack_checkpoints": false, "_torch_grad_scaler_class": null, "_torch_lr_scheduler_classes": null, "_tf_policy_handles_more_than_one_loss": false, "_disable_preprocessor_api": false, "_disable_action_flattening": false, "_disable_initialize_loss_from_dummy_batch": false, "_dont_auto_sync_env_runner_states": false, "env_task_fn": -1, "enable_connectors": -1, "simple_optimizer": false, "policy_map_cache": -1, "worker_cls": -1, "synchronize_filters": -1, "enable_async_evaluation": -1, "custom_async_evaluation_function": -1, "_enable_rl_module_api": -1, "auto_wrap_old_gym_envs": -1, "always_attach_evaluation_results": -1, "replay_sequence_length": null, "_disable_execution_plan_api": -1, "use_critic": true, "use_gae": true, "use_kl_loss": true, "kl_coeff": 0.7464963036515, "kl_target": 0.0270990929592, "vf_loss_coeff": 0.6688075857018, "entropy_coeff": 0.0090570820258, "clip_param": 0.1221781641624, "vf_clip_param": 0.1027808522125, "entropy_coeff_schedule": null, "lr_schedule": null, "sgd_minibatch_size": -1, "vf_share_layers": -1, "__stdout_file__": null, "__stderr_file__": null, "lambda": 0.9099046732075, "input": "sampler", "policies": {"default_policy": [null, null, null, null]}, "callbacks": "<class 'ray.rllib.callbacks.callbacks.RLlibCallback'>", "create_env_on_driver": false, "custom_eval_function": null, "framework": "torch"}, "time_since_restore": 139.5310139656067, "iterations_since_restore": 20, "perf": {"cpu_util_percent": 93.30000000000001, "ram_util_percent": 81.71}}
