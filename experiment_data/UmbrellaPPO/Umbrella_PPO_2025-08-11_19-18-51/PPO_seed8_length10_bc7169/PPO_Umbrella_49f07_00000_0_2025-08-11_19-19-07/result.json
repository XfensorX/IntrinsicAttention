{"timers": {"training_iteration": 4.904909875011072, "restore_env_runners": 1.283304300159216e-05, "training_step": 4.9047160419868305, "env_runner_sampling_timer": 4.735862708068453, "learner_update_timer": 0.16425100003834814, "synch_weights": 0.0010871250415220857}, "env_runners": {"episode_duration_sec_mean": 0.016362559311557556, "rlmodule_inference_timer": 0.00017610927898269247, "env_to_module_connector": {"timers": {"connectors": {"numpy_to_tensor": 3.534102060933421e-05, "add_observations_from_episodes_to_batch": 8.486692650985297e-06, "add_time_dim_to_batch_and_zero_pad": 6.551534907351158e-06, "batch_individual_items": 1.9102318993410403e-05, "add_states_from_episodes_to_batch": 3.900054108055704e-06}}, "connector_pipeline_timer": 0.00012542668193514828}, "sample": 0.017124442823635025, "env_reset_timer": 0.00017396238704423967, "module_episode_returns_mean": {"default_policy": -1.5}, "episode_len_min": 20, "episode_len_max": 20, "module_to_env_connector": {"timers": {"connectors": {"tensor_to_numpy": 5.304314158692437e-05, "un_batch_to_individual_items": 1.3920406716997773e-05, "remove_single_ts_time_rank_from_batch": 1.6924632748648063e-06, "listify_data_for_vector_env": 3.217830222747198e-05, "normalize_and_clip_actions": 3.859142890314207e-05, "get_actions": 0.0001842476108260025}}, "connector_pipeline_timer": 0.00039462124525545803}, "num_episodes_lifetime": 31375.0, "num_module_steps_sampled_lifetime": {"default_policy": 627500.0}, "episode_return_mean": -1.5, "num_env_steps_sampled": 5000.0, "episode_return_min": -11.5, "env_to_module_sum_episodes_length_in": 10.191744832559449, "env_step_timer": 5.017609941506187e-05, "env_to_module_sum_episodes_length_out": 10.191744832559449, "weights_seq_no": 0.0, "num_episodes": 250.0, "num_agent_steps_sampled": {"default_agent": 5000.0}, "episode_return_max": 8.5, "time_between_sampling": 0.0011486756834671857, "num_module_steps_sampled": {"default_policy": 5000.0}, "agent_episode_returns_mean": {"default_agent": -1.5}, "num_env_steps_sampled_lifetime": 627500.0, "num_agent_steps_sampled_lifetime": {"default_agent": 627500.0}, "episode_len_mean": 20.0, "num_env_steps_sampled_lifetime_throughput": 1549.5144976548006}, "learners": {"default_policy": {"default_optimizer_learning_rate": 0.0002847858517, "curr_entropy_coeff": 0.0090570820258, "gradients_default_optimizer_global_norm": 0.040778517723083496, "policy_loss": -0.04181544482707977, "num_module_steps_trained_lifetime": 6000, "diff_num_grad_updates_vs_sampler_policy": 1.0, "mean_kl_loss": 0.0005123130395077169, "weights_seq_no": 1.0, "curr_kl_coeff": 0.3732481598854065, "num_trainable_parameters": 6003, "num_module_steps_trained": 6000, "total_loss": 0.02105357125401497, "vf_explained_var": 0.0005095601081848145, "module_train_batch_size_mean": 1000.0, "vf_loss": 0.10278083384037018, "entropy": 0.6905115842819214, "vf_loss_unclipped": 28.887786865234375, "num_module_steps_trained_lifetime_throughput": 338796.49490987713}, "__all_modules__": {"num_module_steps_trained_lifetime": 6000, "learner_connector_sum_episodes_length_in": 5000, "learner_connector": {"timers": {"connectors": {"add_observations_from_episodes_to_batch": 0.001040375092998147, "add_columns_from_episodes_to_train_batch": 0.046205708058550954, "numpy_to_tensor": 7.800001185387373e-05, "add_time_dim_to_batch_and_zero_pad": 1.4083925634622574e-05, "add_states_from_episodes_to_batch": 3.625056706368923e-06, "general_advantage_estimation": 0.008752875030040741, "batch_individual_items": 0.04938524996396154, "add_one_ts_to_episodes_and_truncate": 0.013323958031833172}}, "connector_pipeline_timer": 0.11900420894380659}, "num_non_trainable_parameters": 0, "num_env_steps_trained_lifetime": 31500, "num_trainable_parameters": 6003, "num_module_steps_trained": 6000, "num_env_steps_trained": 31500, "learner_connector_sum_episodes_length_out": 5250, "num_env_steps_trained_lifetime_throughput": 1763995.2792514856, "num_module_steps_trained_throughput": 337953.70696276485, "num_module_steps_trained_lifetime_throughput": 337193.9247114729}}, "num_training_step_calls_per_iteration": 1, "num_env_steps_sampled_lifetime": 627500.0, "evaluation": {"env_runners": {"env_to_module_connector": {"timers": {"connectors": {"numpy_to_tensor": 1.488744140815702e-05, "add_time_dim_to_batch_and_zero_pad": 4.471248416927687e-06, "add_states_from_episodes_to_batch": 2.3770204393374346e-06, "batch_individual_items": 1.0403660307043032e-05, "add_observations_from_episodes_to_batch": 6.398892377253165e-06}}, "connector_pipeline_timer": 7.556682806770569e-05}, "num_env_steps_sampled": 400, "num_episodes": 20, "episode_duration_sec_mean": 0.011415412550559268, "num_agent_steps_sampled": {"default_agent": 400}, "module_to_env_connector": {"timers": {"connectors": {"un_batch_to_individual_items": 8.663025895816309e-06, "listify_data_for_vector_env": 1.5867211259717713e-05, "remove_single_ts_time_rank_from_batch": 1.0676859187309675e-06, "normalize_and_clip_actions": 2.5493149848475996e-05, "get_actions": 8.288368977135223e-05, "tensor_to_numpy": 2.7463660947238188e-05}}, "connector_pipeline_timer": 0.00019986035415751015}, "sample": 0.2510060409549624, "agent_episode_returns_mean": {"default_agent": 1.75}, "episode_return_min": -14.5, "env_step_timer": 3.327154541370739e-05, "env_to_module_sum_episodes_length_in": 10.216013141322508, "env_to_module_sum_episodes_length_out": 10.216013141322508, "weights_seq_no": 1.0, "episode_len_min": 20, "episode_len_max": 20, "num_agent_steps_sampled_lifetime": {"default_agent": 400}, "num_episodes_lifetime": 20, "num_module_steps_sampled_lifetime": {"default_policy": 400}, "episode_len_mean": 20.0, "env_reset_timer": 0.0007506250403821468, "episode_return_max": 14.5, "module_episode_returns_mean": {"default_policy": 1.75}, "num_env_steps_sampled_lifetime": 5400, "rlmodule_inference_timer": 5.7098521765457996e-05, "num_module_steps_sampled": {"default_policy": 400}, "episode_return_mean": 1.75}, "num_healthy_workers": 1, "actor_manager_num_outstanding_async_reqs": 0, "num_remote_worker_restarts": 0}, "fault_tolerance": {"num_healthy_workers": 0, "num_remote_worker_restarts": 0}, "env_runner_group": {"actor_manager_num_outstanding_async_reqs": 0}, "done": false, "training_iteration": 1, "trial_id": "49f07_00000", "date": "2025-08-11_19-31-47", "timestamp": 1754933507, "time_this_iter_s": 5.175344944000244, "time_total_s": 5.175344944000244, "pid": 24465, "hostname": "Mac", "node_ip": "127.0.0.1", "config": {"exploration_config": {}, "extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "placement_strategy": "PACK", "num_gpus": 0, "_fake_gpus": false, "num_cpus_for_main_process": 2, "eager_tracing": true, "eager_max_retraces": 20, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "torch_compile_learner": false, "torch_compile_learner_what_to_compile": "forward_train", "torch_compile_learner_dynamo_backend": "aot_eager", "torch_compile_learner_dynamo_mode": null, "torch_compile_worker": false, "torch_compile_worker_dynamo_backend": "aot_eager", "torch_compile_worker_dynamo_mode": null, "torch_ddp_kwargs": {}, "torch_skip_nan_gradients": false, "env": "Umbrella", "env_config": {}, "observation_space": null, "action_space": null, "clip_rewards": null, "normalize_actions": true, "clip_actions": false, "_is_atari": null, "disable_env_checking": false, "render_env": false, "action_mask_key": "action_mask", "env_runner_cls": null, "num_env_runners": 0, "create_local_env_runner": true, "num_envs_per_env_runner": 1, "gym_env_vectorize_mode": "SYNC", "num_cpus_per_env_runner": 1, "num_gpus_per_env_runner": 0, "custom_resources_per_env_runner": {}, "validate_env_runners_after_construction": true, "episodes_to_numpy": true, "max_requests_in_flight_per_env_runner": 1, "sample_timeout_s": 60.0, "_env_to_module_connector": null, "add_default_connectors_to_env_to_module_pipeline": true, "_module_to_env_connector": null, "add_default_connectors_to_module_to_env_pipeline": true, "merge_env_runner_states": "training_only", "broadcast_env_runner_states": true, "episode_lookback_horizon": 1, "rollout_fragment_length": "auto", "batch_mode": "complete_episodes", "compress_observations": false, "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "enable_tf1_exec_eagerly": false, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "preprocessor_pref": "deepmind", "observation_filter": "NoFilter", "update_worker_filter_stats": true, "use_worker_filter_stats": true, "sampler_perf_stats_ema_coef": null, "_is_online": true, "num_learners": 0, "num_gpus_per_learner": 0, "num_cpus_per_learner": "auto", "num_aggregator_actors_per_learner": 0, "max_requests_in_flight_per_aggregator_actor": 3, "local_gpu_idx": 0, "max_requests_in_flight_per_learner": 3, "gamma": 1, "lr": 0.0002847858517, "grad_clip": 0.5, "grad_clip_by": "global_norm", "_train_batch_size_per_learner": 5000, "train_batch_size": 4000, "num_epochs": 1, "minibatch_size": 1000, "shuffle_batch_per_epoch": true, "model": {"fcnet_hiddens": [256, 256], "fcnet_activation": "tanh", "fcnet_weights_initializer": null, "fcnet_weights_initializer_config": null, "fcnet_bias_initializer": null, "fcnet_bias_initializer_config": null, "conv_filters": null, "conv_activation": "relu", "conv_kernel_initializer": null, "conv_kernel_initializer_config": null, "conv_bias_initializer": null, "conv_bias_initializer_config": null, "conv_transpose_kernel_initializer": null, "conv_transpose_kernel_initializer_config": null, "conv_transpose_bias_initializer": null, "conv_transpose_bias_initializer_config": null, "post_fcnet_hiddens": [], "post_fcnet_activation": "relu", "post_fcnet_weights_initializer": null, "post_fcnet_weights_initializer_config": null, "post_fcnet_bias_initializer": null, "post_fcnet_bias_initializer_config": null, "free_log_std": false, "log_std_clip_param": 20.0, "no_final_linear": false, "vf_share_layers": false, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "lstm_weights_initializer": null, "lstm_weights_initializer_config": null, "lstm_bias_initializer": null, "lstm_bias_initializer_config": null, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "attention_use_n_prev_actions": 0, "attention_use_n_prev_rewards": 0, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": null, "custom_model_config": {}, "custom_action_dist": null, "custom_preprocessor": null, "encoder_latent_dim": null, "always_check_shapes": false, "lstm_use_prev_action_reward": -1, "_use_default_native_models": -1, "_disable_preprocessor_api": false, "_disable_action_flattening": false}, "_learner_connector": null, "add_default_connectors_to_learner_pipeline": true, "learner_config_dict": {}, "optimizer": {}, "_learner_class": null, "callbacks_on_algorithm_init": null, "callbacks_on_env_runners_recreated": null, "callbacks_on_offline_eval_runners_recreated": null, "callbacks_on_checkpoint_loaded": null, "callbacks_on_environment_created": null, "callbacks_on_episode_created": null, "callbacks_on_episode_start": null, "callbacks_on_episode_step": null, "callbacks_on_episode_end": null, "callbacks_on_evaluate_start": null, "callbacks_on_evaluate_end": null, "callbacks_on_evaluate_offline_start": null, "callbacks_on_evaluate_offline_end": null, "callbacks_on_sample_end": null, "callbacks_on_train_result": null, "explore": true, "enable_rl_module_and_learner": true, "enable_env_runner_and_connector_v2": true, "_prior_exploration_config": {"type": "StochasticSampling"}, "count_steps_by": "env_steps", "policy_map_capacity": 100, "policy_mapping_fn": "<function AlgorithmConfig.DEFAULT_POLICY_MAPPING_FN at 0x388c81b20>", "policies_to_train": null, "policy_states_are_swappable": false, "observation_fn": null, "offline_data_class": null, "input_read_method": "read_parquet", "input_read_method_kwargs": {}, "input_read_schema": {}, "input_read_episodes": false, "input_read_sample_batches": false, "input_read_batch_size": null, "input_filesystem": null, "input_filesystem_kwargs": {}, "input_compress_columns": ["obs", "new_obs"], "input_spaces_jsonable": true, "materialize_data": false, "materialize_mapped_data": true, "map_batches_kwargs": {}, "iter_batches_kwargs": {}, "ignore_final_observation": false, "prelearner_class": null, "prelearner_buffer_class": null, "prelearner_buffer_kwargs": {}, "prelearner_module_synch_period": 10, "dataset_num_iters_per_learner": null, "input_config": {}, "actions_in_input_normalized": false, "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_config": {}, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "output_max_rows_per_file": null, "output_write_remaining_data": false, "output_write_method": "write_parquet", "output_write_method_kwargs": {}, "output_filesystem": null, "output_filesystem_kwargs": {}, "output_write_episodes": true, "offline_sampling": false, "evaluation_interval": 1, "evaluation_duration": 20, "evaluation_duration_unit": "episodes", "evaluation_sample_timeout_s": 120.0, "evaluation_auto_duration_min_env_steps_per_sample": 100, "evaluation_auto_duration_max_env_steps_per_sample": 2000, "evaluation_parallel_to_training": false, "evaluation_force_reset_envs_before_iteration": true, "evaluation_config": null, "off_policy_estimation_methods": {}, "ope_split_batch_by_episode": true, "evaluation_num_env_runners": 1, "in_evaluation": false, "sync_filters_on_rollout_workers_timeout_s": 10.0, "offline_evaluation_interval": null, "num_offline_eval_runners": 0, "offline_loss_for_module_fn": null, "offline_evaluation_duration": 1, "offline_evaluation_parallel_to_training": false, "offline_evaluation_timeout_s": 120.0, "num_cpus_per_offline_eval_runner": 1, "num_gpus_per_offline_eval_runner": 0, "custom_resources_per_offline_eval_runner": {}, "restart_failed_offline_eval_runners": true, "ignore_offline_eval_runner_failures": false, "max_num_offline_eval_runner_restarts": 1000, "offline_eval_runner_restore_timeout_s": 1800.0, "max_requests_in_flight_per_offline_eval_runner": 1, "validate_offline_eval_runners_after_construction": true, "offline_eval_runner_health_probe_timeout_s": 30.0, "offline_eval_rl_module_inference_only": false, "broadcast_offline_eval_runner_states": false, "offline_eval_batch_size_per_runner": 256, "dataset_num_iters_per_eval_runner": 1, "keep_per_episode_custom_metrics": false, "metrics_episode_collection_timeout_s": 60.0, "metrics_num_episodes_for_smoothing": 100, "min_time_s_per_iteration": null, "min_train_timesteps_per_iteration": 0, "min_sample_timesteps_per_iteration": 0, "log_gradients": true, "export_native_model_files": false, "checkpoint_trainable_policies_only": false, "logger_creator": null, "logger_config": null, "log_level": "WARN", "log_sys_usage": true, "fake_sampler": false, "seed": 8, "restart_failed_env_runners": true, "ignore_env_runner_failures": false, "max_num_env_runner_restarts": 1000, "delay_between_env_runner_restarts_s": 60.0, "restart_failed_sub_environments": false, "num_consecutive_env_runner_failures_tolerance": 100, "env_runner_health_probe_timeout_s": 30.0, "env_runner_restore_timeout_s": 1800.0, "_model_config": {}, "_rl_module_spec": "RLModuleSpec(module_class=None, observation_space=None, action_space=None, inference_only=False, learner_only=False, model_config=DefaultModelConfig(fcnet_hiddens=[60, 90], fcnet_activation='tanh', fcnet_kernel_initializer=None, fcnet_kernel_initializer_kwargs=None, fcnet_bias_initializer=None, fcnet_bias_initializer_kwargs=None, conv_filters=None, conv_activation='relu', conv_kernel_initializer=None, conv_kernel_initializer_kwargs=None, conv_bias_initializer=None, conv_bias_initializer_kwargs=None, head_fcnet_hiddens=[], head_fcnet_activation='relu', head_fcnet_kernel_initializer=None, head_fcnet_kernel_initializer_kwargs=None, head_fcnet_bias_initializer=None, head_fcnet_bias_initializer_kwargs=None, free_log_std=False, log_std_clip_param=20.0, vf_share_layers=True, use_lstm=False, max_seq_len=20, lstm_cell_size=256, lstm_use_prev_action=False, lstm_use_prev_reward=False, lstm_kernel_initializer=None, lstm_kernel_initializer_kwargs=None, lstm_bias_initializer=None, lstm_bias_initializer_kwargs=None), catalog_class=None, load_state_path=None, model_config_dict=None)", "algorithm_config_overrides_per_module": {}, "_per_module_overrides": {}, "_validate_config": true, "_use_msgpack_checkpoints": false, "_torch_grad_scaler_class": null, "_torch_lr_scheduler_classes": null, "_tf_policy_handles_more_than_one_loss": false, "_disable_preprocessor_api": false, "_disable_action_flattening": false, "_disable_initialize_loss_from_dummy_batch": false, "_dont_auto_sync_env_runner_states": false, "env_task_fn": -1, "enable_connectors": -1, "simple_optimizer": false, "policy_map_cache": -1, "worker_cls": -1, "synchronize_filters": -1, "enable_async_evaluation": -1, "custom_async_evaluation_function": -1, "_enable_rl_module_api": -1, "auto_wrap_old_gym_envs": -1, "always_attach_evaluation_results": -1, "replay_sequence_length": null, "_disable_execution_plan_api": -1, "use_critic": true, "use_gae": true, "use_kl_loss": true, "kl_coeff": 0.7464963036515, "kl_target": 0.0270990929592, "vf_loss_coeff": 0.6688075857018, "entropy_coeff": 0.0090570820258, "clip_param": 0.1221781641624, "vf_clip_param": 0.1027808522125, "entropy_coeff_schedule": null, "lr_schedule": null, "sgd_minibatch_size": -1, "vf_share_layers": -1, "__stdout_file__": null, "__stderr_file__": null, "lambda": 0.9099046732075, "input": "sampler", "policies": {"default_policy": [null, null, null, null]}, "callbacks": "<class 'ray.rllib.callbacks.callbacks.RLlibCallback'>", "create_env_on_driver": false, "custom_eval_function": null, "framework": "torch"}, "time_since_restore": 5.175344944000244, "iterations_since_restore": 1, "perf": {"cpu_util_percent": 65.44999999999999, "ram_util_percent": 80.3}}
{"timers": {"training_iteration": 4.883123342101462, "restore_env_runners": 1.2775543145835398e-05, "training_step": 4.882929199476494, "env_runner_sampling_timer": 4.712661298067542, "learner_update_timer": 0.1656702546274755, "synch_weights": 0.001088757961988449, "restore_eval_env_runners": 6.679201032966375e-05, "evaluation_iteration": 0.26761325006373227, "synch_eval_env_connectors": 0.00044729106593877077, "synch_env_connectors": 5.790963768959045e-06}, "env_runners": {"episode_duration_sec_mean": 0.00805001264763996, "rlmodule_inference_timer": 5.800733660335547e-05, "env_to_module_connector": {"timers": {"connectors": {"numpy_to_tensor": 2.0038036452931535e-05, "add_observations_from_episodes_to_batch": 5.321480409192227e-06, "add_time_dim_to_batch_and_zero_pad": 4.0689502440018455e-06, "batch_individual_items": 1.1529443313866125e-05, "add_states_from_episodes_to_batch": 2.613441648630486e-06}}, "connector_pipeline_timer": 7.693534713946128e-05}, "sample": 0.013282606312316255, "env_reset_timer": 0.0001003260816679314, "module_episode_returns_mean": {"default_policy": 0.17999999999999997}, "episode_len_min": 20, "episode_len_max": 20, "module_to_env_connector": {"timers": {"connectors": {"tensor_to_numpy": 2.500599419429603e-05, "un_batch_to_individual_items": 9.367719124324833e-06, "remove_single_ts_time_rank_from_batch": 9.587742245290963e-07, "listify_data_for_vector_env": 2.017529285428764e-05, "normalize_and_clip_actions": 1.6267679074593976e-05, "get_actions": 8.402060439878071e-05}}, "connector_pipeline_timer": 0.00019989138957519773}, "num_episodes_lifetime": 500.0, "num_module_steps_sampled_lifetime": {"default_policy": 10000.0}, "episode_return_mean": 0.17999999999999997, "num_env_steps_sampled": 5000.0, "episode_return_min": -11.5, "env_to_module_sum_episodes_length_in": 10.36823839457432, "env_step_timer": 2.6205103109448894e-05, "env_to_module_sum_episodes_length_out": 10.36823839457432, "weights_seq_no": 1.0, "num_episodes": 250.0, "num_agent_steps_sampled": {"default_agent": 5000.0}, "episode_return_max": 8.5, "time_between_sampling": 0.0031814767424378195, "num_module_steps_sampled": {"default_policy": 5000.0}, "agent_episode_returns_mean": {"default_agent": 0.17999999999999997}, "num_env_steps_sampled_lifetime": 10000.0, "num_agent_steps_sampled_lifetime": {"default_agent": 10000.0}, "episode_len_mean": 20.0, "num_env_steps_sampled_lifetime_throughput": 2236.4038552142933}, "learners": {"default_policy": {"default_optimizer_learning_rate": 0.0002847858517, "curr_entropy_coeff": 0.0090570820258, "gradients_default_optimizer_global_norm": 0.12324754893779755, "policy_loss": 0.1580778807401657, "num_module_steps_trained_lifetime": 12000, "diff_num_grad_updates_vs_sampler_policy": 1.0, "mean_kl_loss": 5.7608696806710213e-05, "weights_seq_no": 2.0, "curr_kl_coeff": 0.18662407994270325, "num_trainable_parameters": 6003, "num_module_steps_trained": 6000, "total_loss": 0.22059014439582825, "vf_explained_var": 0.0014600753784179688, "module_train_batch_size_mean": 1000.0, "vf_loss": 0.10278083384037018, "entropy": 0.6900495290756226, "vf_loss_unclipped": 28.989748001098633, "num_module_steps_trained_lifetime_throughput": 337269.8705648196}, "__all_modules__": {"num_module_steps_trained_lifetime": 12000, "learner_connector_sum_episodes_length_in": 5000.0, "learner_connector": {"timers": {"connectors": {"add_observations_from_episodes_to_batch": 0.0010387259325943885, "add_columns_from_episodes_to_train_batch": 0.04643087806762196, "numpy_to_tensor": 7.912918226793408e-05, "add_time_dim_to_batch_and_zero_pad": 1.4188506174832582e-05, "add_states_from_episodes_to_batch": 3.665885888040066e-06, "general_advantage_estimation": 0.008746427110163496, "batch_individual_items": 0.05079409913392737, "add_one_ts_to_episodes_and_truncate": 0.013275863871676848}}, "connector_pipeline_timer": 0.12058300935430452}, "num_non_trainable_parameters": 0, "num_env_steps_trained_lifetime": 63000, "num_trainable_parameters": 6003, "num_module_steps_trained": 6000, "num_env_steps_trained": 31500, "learner_connector_sum_episodes_length_out": 5250.0, "num_env_steps_trained_lifetime_throughput": 1756195.134659911, "num_module_steps_trained_throughput": 336448.33217675734, "num_module_steps_trained_lifetime_throughput": 335698.700415707}}, "num_training_step_calls_per_iteration": 1, "evaluation": {"env_runners": {"env_to_module_connector": {"timers": {"connectors": {"numpy_to_tensor": 1.880772396397495e-05, "add_time_dim_to_batch_and_zero_pad": 3.999994302968647e-06, "add_states_from_episodes_to_batch": 2.5342605387156376e-06, "batch_individual_items": 1.38477118201667e-05, "add_observations_from_episodes_to_batch": 4.9918376909759805e-06}}, "connector_pipeline_timer": 7.881177956142449e-05}, "num_env_steps_sampled": 400, "num_episodes": 20, "episode_duration_sec_mean": 0.009226413571741431, "num_agent_steps_sampled": {"default_agent": 400}, "module_to_env_connector": {"timers": {"connectors": {"un_batch_to_individual_items": 9.713250973537027e-06, "listify_data_for_vector_env": 2.2613632551290405e-05, "remove_single_ts_time_rank_from_batch": 9.433747017787214e-07, "normalize_and_clip_actions": 1.826263365807431e-05, "get_actions": 8.221327525283212e-05, "tensor_to_numpy": 2.8815066045111967e-05}}, "connector_pipeline_timer": 0.00021036650122056538}, "sample": 0.25006614554557016, "agent_episode_returns_mean": {"default_agent": 1.25}, "episode_return_min": -14.5, "env_step_timer": 3.644835365238329e-05, "env_to_module_sum_episodes_length_in": 10.366003441359926, "env_to_module_sum_episodes_length_out": 10.366003441359926, "weights_seq_no": 2.0, "episode_len_min": 20, "episode_len_max": 20, "num_agent_steps_sampled_lifetime": {"default_agent": 800}, "num_episodes_lifetime": 40, "num_module_steps_sampled_lifetime": {"default_policy": 800}, "episode_len_mean": 20.0, "env_reset_timer": 0.0007439716998487711, "episode_return_max": 14.5, "module_episode_returns_mean": {"default_policy": 1.25}, "num_env_steps_sampled_lifetime": 10400, "rlmodule_inference_timer": 6.0311510851152164e-05, "num_module_steps_sampled": {"default_policy": 400}, "episode_return_mean": 1.25, "time_between_sampling": 2.7699756249785423}, "num_healthy_workers": 1, "actor_manager_num_outstanding_async_reqs": 0, "num_remote_worker_restarts": 0}, "num_env_steps_sampled_lifetime": 10000.0, "fault_tolerance": {"num_healthy_workers": 0, "num_remote_worker_restarts": 0}, "env_runner_group": {"actor_manager_num_outstanding_async_reqs": 0}, "done": false, "training_iteration": 2, "trial_id": "49f07_00000", "date": "2025-08-11_19-31-50", "timestamp": 1754933510, "time_this_iter_s": 2.8946030139923096, "time_total_s": 8.069947957992554, "pid": 24465, "hostname": "Mac", "node_ip": "127.0.0.1", "config": {"exploration_config": {}, "extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "placement_strategy": "PACK", "num_gpus": 0, "_fake_gpus": false, "num_cpus_for_main_process": 2, "eager_tracing": true, "eager_max_retraces": 20, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "torch_compile_learner": false, "torch_compile_learner_what_to_compile": "forward_train", "torch_compile_learner_dynamo_backend": "aot_eager", "torch_compile_learner_dynamo_mode": null, "torch_compile_worker": false, "torch_compile_worker_dynamo_backend": "aot_eager", "torch_compile_worker_dynamo_mode": null, "torch_ddp_kwargs": {}, "torch_skip_nan_gradients": false, "env": "Umbrella", "env_config": {}, "observation_space": null, "action_space": null, "clip_rewards": null, "normalize_actions": true, "clip_actions": false, "_is_atari": null, "disable_env_checking": false, "render_env": false, "action_mask_key": "action_mask", "env_runner_cls": null, "num_env_runners": 0, "create_local_env_runner": true, "num_envs_per_env_runner": 1, "gym_env_vectorize_mode": "SYNC", "num_cpus_per_env_runner": 1, "num_gpus_per_env_runner": 0, "custom_resources_per_env_runner": {}, "validate_env_runners_after_construction": true, "episodes_to_numpy": true, "max_requests_in_flight_per_env_runner": 1, "sample_timeout_s": 60.0, "_env_to_module_connector": null, "add_default_connectors_to_env_to_module_pipeline": true, "_module_to_env_connector": null, "add_default_connectors_to_module_to_env_pipeline": true, "merge_env_runner_states": "training_only", "broadcast_env_runner_states": true, "episode_lookback_horizon": 1, "rollout_fragment_length": "auto", "batch_mode": "complete_episodes", "compress_observations": false, "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "enable_tf1_exec_eagerly": false, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "preprocessor_pref": "deepmind", "observation_filter": "NoFilter", "update_worker_filter_stats": true, "use_worker_filter_stats": true, "sampler_perf_stats_ema_coef": null, "_is_online": true, "num_learners": 0, "num_gpus_per_learner": 0, "num_cpus_per_learner": "auto", "num_aggregator_actors_per_learner": 0, "max_requests_in_flight_per_aggregator_actor": 3, "local_gpu_idx": 0, "max_requests_in_flight_per_learner": 3, "gamma": 1, "lr": 0.0002847858517, "grad_clip": 0.5, "grad_clip_by": "global_norm", "_train_batch_size_per_learner": 5000, "train_batch_size": 4000, "num_epochs": 1, "minibatch_size": 1000, "shuffle_batch_per_epoch": true, "model": {"fcnet_hiddens": [256, 256], "fcnet_activation": "tanh", "fcnet_weights_initializer": null, "fcnet_weights_initializer_config": null, "fcnet_bias_initializer": null, "fcnet_bias_initializer_config": null, "conv_filters": null, "conv_activation": "relu", "conv_kernel_initializer": null, "conv_kernel_initializer_config": null, "conv_bias_initializer": null, "conv_bias_initializer_config": null, "conv_transpose_kernel_initializer": null, "conv_transpose_kernel_initializer_config": null, "conv_transpose_bias_initializer": null, "conv_transpose_bias_initializer_config": null, "post_fcnet_hiddens": [], "post_fcnet_activation": "relu", "post_fcnet_weights_initializer": null, "post_fcnet_weights_initializer_config": null, "post_fcnet_bias_initializer": null, "post_fcnet_bias_initializer_config": null, "free_log_std": false, "log_std_clip_param": 20.0, "no_final_linear": false, "vf_share_layers": false, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "lstm_weights_initializer": null, "lstm_weights_initializer_config": null, "lstm_bias_initializer": null, "lstm_bias_initializer_config": null, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "attention_use_n_prev_actions": 0, "attention_use_n_prev_rewards": 0, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": null, "custom_model_config": {}, "custom_action_dist": null, "custom_preprocessor": null, "encoder_latent_dim": null, "always_check_shapes": false, "lstm_use_prev_action_reward": -1, "_use_default_native_models": -1, "_disable_preprocessor_api": false, "_disable_action_flattening": false}, "_learner_connector": null, "add_default_connectors_to_learner_pipeline": true, "learner_config_dict": {}, "optimizer": {}, "_learner_class": null, "callbacks_on_algorithm_init": null, "callbacks_on_env_runners_recreated": null, "callbacks_on_offline_eval_runners_recreated": null, "callbacks_on_checkpoint_loaded": null, "callbacks_on_environment_created": null, "callbacks_on_episode_created": null, "callbacks_on_episode_start": null, "callbacks_on_episode_step": null, "callbacks_on_episode_end": null, "callbacks_on_evaluate_start": null, "callbacks_on_evaluate_end": null, "callbacks_on_evaluate_offline_start": null, "callbacks_on_evaluate_offline_end": null, "callbacks_on_sample_end": null, "callbacks_on_train_result": null, "explore": true, "enable_rl_module_and_learner": true, "enable_env_runner_and_connector_v2": true, "_prior_exploration_config": {"type": "StochasticSampling"}, "count_steps_by": "env_steps", "policy_map_capacity": 100, "policy_mapping_fn": "<function AlgorithmConfig.DEFAULT_POLICY_MAPPING_FN at 0x388c81b20>", "policies_to_train": null, "policy_states_are_swappable": false, "observation_fn": null, "offline_data_class": null, "input_read_method": "read_parquet", "input_read_method_kwargs": {}, "input_read_schema": {}, "input_read_episodes": false, "input_read_sample_batches": false, "input_read_batch_size": null, "input_filesystem": null, "input_filesystem_kwargs": {}, "input_compress_columns": ["obs", "new_obs"], "input_spaces_jsonable": true, "materialize_data": false, "materialize_mapped_data": true, "map_batches_kwargs": {}, "iter_batches_kwargs": {}, "ignore_final_observation": false, "prelearner_class": null, "prelearner_buffer_class": null, "prelearner_buffer_kwargs": {}, "prelearner_module_synch_period": 10, "dataset_num_iters_per_learner": null, "input_config": {}, "actions_in_input_normalized": false, "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_config": {}, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "output_max_rows_per_file": null, "output_write_remaining_data": false, "output_write_method": "write_parquet", "output_write_method_kwargs": {}, "output_filesystem": null, "output_filesystem_kwargs": {}, "output_write_episodes": true, "offline_sampling": false, "evaluation_interval": 1, "evaluation_duration": 20, "evaluation_duration_unit": "episodes", "evaluation_sample_timeout_s": 120.0, "evaluation_auto_duration_min_env_steps_per_sample": 100, "evaluation_auto_duration_max_env_steps_per_sample": 2000, "evaluation_parallel_to_training": false, "evaluation_force_reset_envs_before_iteration": true, "evaluation_config": null, "off_policy_estimation_methods": {}, "ope_split_batch_by_episode": true, "evaluation_num_env_runners": 1, "in_evaluation": false, "sync_filters_on_rollout_workers_timeout_s": 10.0, "offline_evaluation_interval": null, "num_offline_eval_runners": 0, "offline_loss_for_module_fn": null, "offline_evaluation_duration": 1, "offline_evaluation_parallel_to_training": false, "offline_evaluation_timeout_s": 120.0, "num_cpus_per_offline_eval_runner": 1, "num_gpus_per_offline_eval_runner": 0, "custom_resources_per_offline_eval_runner": {}, "restart_failed_offline_eval_runners": true, "ignore_offline_eval_runner_failures": false, "max_num_offline_eval_runner_restarts": 1000, "offline_eval_runner_restore_timeout_s": 1800.0, "max_requests_in_flight_per_offline_eval_runner": 1, "validate_offline_eval_runners_after_construction": true, "offline_eval_runner_health_probe_timeout_s": 30.0, "offline_eval_rl_module_inference_only": false, "broadcast_offline_eval_runner_states": false, "offline_eval_batch_size_per_runner": 256, "dataset_num_iters_per_eval_runner": 1, "keep_per_episode_custom_metrics": false, "metrics_episode_collection_timeout_s": 60.0, "metrics_num_episodes_for_smoothing": 100, "min_time_s_per_iteration": null, "min_train_timesteps_per_iteration": 0, "min_sample_timesteps_per_iteration": 0, "log_gradients": true, "export_native_model_files": false, "checkpoint_trainable_policies_only": false, "logger_creator": null, "logger_config": null, "log_level": "WARN", "log_sys_usage": true, "fake_sampler": false, "seed": 8, "restart_failed_env_runners": true, "ignore_env_runner_failures": false, "max_num_env_runner_restarts": 1000, "delay_between_env_runner_restarts_s": 60.0, "restart_failed_sub_environments": false, "num_consecutive_env_runner_failures_tolerance": 100, "env_runner_health_probe_timeout_s": 30.0, "env_runner_restore_timeout_s": 1800.0, "_model_config": {}, "_rl_module_spec": "RLModuleSpec(module_class=None, observation_space=None, action_space=None, inference_only=False, learner_only=False, model_config=DefaultModelConfig(fcnet_hiddens=[60, 90], fcnet_activation='tanh', fcnet_kernel_initializer=None, fcnet_kernel_initializer_kwargs=None, fcnet_bias_initializer=None, fcnet_bias_initializer_kwargs=None, conv_filters=None, conv_activation='relu', conv_kernel_initializer=None, conv_kernel_initializer_kwargs=None, conv_bias_initializer=None, conv_bias_initializer_kwargs=None, head_fcnet_hiddens=[], head_fcnet_activation='relu', head_fcnet_kernel_initializer=None, head_fcnet_kernel_initializer_kwargs=None, head_fcnet_bias_initializer=None, head_fcnet_bias_initializer_kwargs=None, free_log_std=False, log_std_clip_param=20.0, vf_share_layers=True, use_lstm=False, max_seq_len=20, lstm_cell_size=256, lstm_use_prev_action=False, lstm_use_prev_reward=False, lstm_kernel_initializer=None, lstm_kernel_initializer_kwargs=None, lstm_bias_initializer=None, lstm_bias_initializer_kwargs=None), catalog_class=None, load_state_path=None, model_config_dict=None)", "algorithm_config_overrides_per_module": {}, "_per_module_overrides": {}, "_validate_config": true, "_use_msgpack_checkpoints": false, "_torch_grad_scaler_class": null, "_torch_lr_scheduler_classes": null, "_tf_policy_handles_more_than_one_loss": false, "_disable_preprocessor_api": false, "_disable_action_flattening": false, "_disable_initialize_loss_from_dummy_batch": false, "_dont_auto_sync_env_runner_states": false, "env_task_fn": -1, "enable_connectors": -1, "simple_optimizer": false, "policy_map_cache": -1, "worker_cls": -1, "synchronize_filters": -1, "enable_async_evaluation": -1, "custom_async_evaluation_function": -1, "_enable_rl_module_api": -1, "auto_wrap_old_gym_envs": -1, "always_attach_evaluation_results": -1, "replay_sequence_length": null, "_disable_execution_plan_api": -1, "use_critic": true, "use_gae": true, "use_kl_loss": true, "kl_coeff": 0.7464963036515, "kl_target": 0.0270990929592, "vf_loss_coeff": 0.6688075857018, "entropy_coeff": 0.0090570820258, "clip_param": 0.1221781641624, "vf_clip_param": 0.1027808522125, "entropy_coeff_schedule": null, "lr_schedule": null, "sgd_minibatch_size": -1, "vf_share_layers": -1, "__stdout_file__": null, "__stderr_file__": null, "lambda": 0.9099046732075, "input": "sampler", "policies": {"default_policy": [null, null, null, null]}, "callbacks": "<class 'ray.rllib.callbacks.callbacks.RLlibCallback'>", "create_env_on_driver": false, "custom_eval_function": null, "framework": "torch"}, "time_since_restore": 8.069947957992554, "iterations_since_restore": 2, "perf": {"cpu_util_percent": 75.875, "ram_util_percent": 80.6}}
{"timers": {"training_iteration": 4.862613487430708, "restore_env_runners": 1.2724038586020469e-05, "training_step": 4.862416540811688, "env_runner_sampling_timer": 4.692148100507155, "learner_update_timer": 0.16566204874067333, "synch_weights": 0.0010908499724697322, "restore_eval_env_runners": 6.621367996558546e-05, "evaluation_iteration": 0.2665930067328736, "synch_eval_env_connectors": 0.00044500982505269344, "synch_env_connectors": 5.789725109934807e-06}, "env_runners": {"episode_duration_sec_mean": 0.008875964020378891, "rlmodule_inference_timer": 5.721554370383966e-05, "env_to_module_connector": {"timers": {"connectors": {"numpy_to_tensor": 1.833490157099928e-05, "add_observations_from_episodes_to_batch": 5.520730228791355e-06, "add_time_dim_to_batch_and_zero_pad": 4.3340550435688896e-06, "batch_individual_items": 1.215282870975129e-05, "add_states_from_episodes_to_batch": 3.3950689795537145e-06}}, "connector_pipeline_timer": 7.91480044928e-05}, "sample": 0.009328766884249289, "env_reset_timer": 8.347085080675376e-05, "module_episode_returns_mean": {"default_policy": 0.3400000000000001}, "episode_len_min": 20, "episode_len_max": 20, "module_to_env_connector": {"timers": {"connectors": {"tensor_to_numpy": 2.6955976774597443e-05, "un_batch_to_individual_items": 9.441192026701284e-06, "remove_single_ts_time_rank_from_batch": 1.1363446878381211e-06, "listify_data_for_vector_env": 2.0679506393023078e-05, "normalize_and_clip_actions": 1.7003217794604383e-05, "get_actions": 8.750096773463085e-05}}, "connector_pipeline_timer": 0.00020607946475352624}, "num_episodes_lifetime": -30375.0, "num_module_steps_sampled_lifetime": {"default_policy": -607500.0}, "episode_return_mean": 0.3400000000000001, "num_env_steps_sampled": 5000.0, "episode_return_min": -11.5, "env_to_module_sum_episodes_length_in": 10.36823839457432, "env_step_timer": 2.7646629545742975e-05, "env_to_module_sum_episodes_length_out": 10.36823839457432, "weights_seq_no": 2.0, "num_episodes": 250.0, "num_agent_steps_sampled": {"default_agent": 5000.0}, "episode_return_max": 8.5, "time_between_sampling": 0.003058009529307036, "num_module_steps_sampled": {"default_policy": 5000.0}, "agent_episode_returns_mean": {"default_agent": 0.3400000000000001}, "num_env_steps_sampled_lifetime": -607500.0, "num_agent_steps_sampled_lifetime": {"default_agent": -607500.0}, "episode_len_mean": 20.0, "num_env_steps_sampled_lifetime_throughput": 2245.106721810294}, "learners": {"default_policy": {"default_optimizer_learning_rate": 0.0002847858517, "curr_entropy_coeff": 0.0090570820258, "gradients_default_optimizer_global_norm": 0.11024872958660126, "policy_loss": 0.0031105533707886934, "num_module_steps_trained_lifetime": 18000, "diff_num_grad_updates_vs_sampler_policy": 1.0, "mean_kl_loss": 7.996203930815682e-05, "weights_seq_no": 3.0, "curr_kl_coeff": 0.09331203997135162, "num_trainable_parameters": 6003, "num_module_steps_trained": 6000, "total_loss": 0.06561407446861267, "vf_explained_var": 0.001783132553100586, "module_train_batch_size_mean": 1000.0, "vf_loss": 0.10278083384037018, "entropy": 0.6902889013290405, "vf_loss_unclipped": 28.398405075073242, "num_module_steps_trained_lifetime_throughput": 333656.1818289315}, "__all_modules__": {"num_module_steps_trained_lifetime": 18000, "learner_connector_sum_episodes_length_in": 5000.0, "learner_connector": {"timers": {"connectors": {"add_observations_from_episodes_to_batch": 0.00103779367308598, "add_columns_from_episodes_to_train_batch": 0.046350353457208254, "numpy_to_tensor": 7.952497981023043e-05, "add_time_dim_to_batch_and_zero_pad": 1.4226621319539845e-05, "add_states_from_episodes_to_batch": 3.6675579380244017e-06, "general_advantage_estimation": 0.00878113658890361, "batch_individual_items": 0.050797031052387316, "add_one_ts_to_episodes_and_truncate": 0.013245989823120181}}, "connector_pipeline_timer": 0.12050961510131601}, "num_non_trainable_parameters": 0, "num_env_steps_trained_lifetime": 94500, "num_trainable_parameters": 6003, "num_module_steps_trained": 6000, "num_env_steps_trained": 31500, "learner_connector_sum_episodes_length_out": 5250.0, "num_env_steps_trained_lifetime_throughput": 1737612.6299224228, "num_module_steps_trained_throughput": 332860.22458303306, "num_module_steps_trained_lifetime_throughput": 332130.55958480766}}, "num_training_step_calls_per_iteration": 1, "evaluation": {"env_runners": {"env_to_module_connector": {"timers": {"connectors": {"numpy_to_tensor": 1.3080257217338869e-05, "add_time_dim_to_batch_and_zero_pad": 3.189599678655088e-06, "add_states_from_episodes_to_batch": 1.906148901682024e-06, "batch_individual_items": 9.406825523007847e-06, "add_observations_from_episodes_to_batch": 3.7559766970815847e-06}}, "connector_pipeline_timer": 6.038355938365664e-05}, "num_env_steps_sampled": 400, "num_episodes": 20, "episode_duration_sec_mean": 0.008569374329332883, "num_agent_steps_sampled": {"default_agent": 400}, "module_to_env_connector": {"timers": {"connectors": {"un_batch_to_individual_items": 7.069461136022773e-06, "listify_data_for_vector_env": 1.5451646726884107e-05, "remove_single_ts_time_rank_from_batch": 6.805586090483389e-07, "normalize_and_clip_actions": 1.4001380920600601e-05, "get_actions": 5.384313415681984e-05, "tensor_to_numpy": 1.795209243073533e-05}}, "connector_pipeline_timer": 0.00014142721156574681}, "sample": 0.24915081617083631, "agent_episode_returns_mean": {"default_agent": 1.75}, "episode_return_min": -14.5, "env_step_timer": 2.017350975506204e-05, "env_to_module_sum_episodes_length_in": 10.368205581254823, "env_to_module_sum_episodes_length_out": 10.368205581254823, "weights_seq_no": 3.0, "episode_len_min": 20, "episode_len_max": 20, "num_agent_steps_sampled_lifetime": {"default_agent": 1200}, "num_episodes_lifetime": 60, "num_module_steps_sampled_lifetime": {"default_policy": 1200}, "episode_len_mean": 20.0, "env_reset_timer": 0.0007375924018677324, "episode_return_max": 14.5, "module_episode_returns_mean": {"default_policy": 1.75}, "num_env_steps_sampled_lifetime": 15400, "rlmodule_inference_timer": 4.0692757043058005e-05, "num_module_steps_sampled": {"default_policy": 400}, "episode_return_mean": 1.75, "time_between_sampling": 2.7709119337284935}, "num_healthy_workers": 1, "actor_manager_num_outstanding_async_reqs": 0, "num_remote_worker_restarts": 0}, "num_env_steps_sampled_lifetime": -607500.0, "fault_tolerance": {"num_healthy_workers": 0, "num_remote_worker_restarts": 0}, "env_runner_group": {"actor_manager_num_outstanding_async_reqs": 0}, "done": false, "training_iteration": 3, "trial_id": "49f07_00000", "date": "2025-08-11_19-31-53", "timestamp": 1754933513, "time_this_iter_s": 3.0019469261169434, "time_total_s": 11.071894884109497, "pid": 24465, "hostname": "Mac", "node_ip": "127.0.0.1", "config": {"exploration_config": {}, "extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "placement_strategy": "PACK", "num_gpus": 0, "_fake_gpus": false, "num_cpus_for_main_process": 2, "eager_tracing": true, "eager_max_retraces": 20, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "torch_compile_learner": false, "torch_compile_learner_what_to_compile": "forward_train", "torch_compile_learner_dynamo_backend": "aot_eager", "torch_compile_learner_dynamo_mode": null, "torch_compile_worker": false, "torch_compile_worker_dynamo_backend": "aot_eager", "torch_compile_worker_dynamo_mode": null, "torch_ddp_kwargs": {}, "torch_skip_nan_gradients": false, "env": "Umbrella", "env_config": {}, "observation_space": null, "action_space": null, "clip_rewards": null, "normalize_actions": true, "clip_actions": false, "_is_atari": null, "disable_env_checking": false, "render_env": false, "action_mask_key": "action_mask", "env_runner_cls": null, "num_env_runners": 0, "create_local_env_runner": true, "num_envs_per_env_runner": 1, "gym_env_vectorize_mode": "SYNC", "num_cpus_per_env_runner": 1, "num_gpus_per_env_runner": 0, "custom_resources_per_env_runner": {}, "validate_env_runners_after_construction": true, "episodes_to_numpy": true, "max_requests_in_flight_per_env_runner": 1, "sample_timeout_s": 60.0, "_env_to_module_connector": null, "add_default_connectors_to_env_to_module_pipeline": true, "_module_to_env_connector": null, "add_default_connectors_to_module_to_env_pipeline": true, "merge_env_runner_states": "training_only", "broadcast_env_runner_states": true, "episode_lookback_horizon": 1, "rollout_fragment_length": "auto", "batch_mode": "complete_episodes", "compress_observations": false, "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "enable_tf1_exec_eagerly": false, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "preprocessor_pref": "deepmind", "observation_filter": "NoFilter", "update_worker_filter_stats": true, "use_worker_filter_stats": true, "sampler_perf_stats_ema_coef": null, "_is_online": true, "num_learners": 0, "num_gpus_per_learner": 0, "num_cpus_per_learner": "auto", "num_aggregator_actors_per_learner": 0, "max_requests_in_flight_per_aggregator_actor": 3, "local_gpu_idx": 0, "max_requests_in_flight_per_learner": 3, "gamma": 1, "lr": 0.0002847858517, "grad_clip": 0.5, "grad_clip_by": "global_norm", "_train_batch_size_per_learner": 5000, "train_batch_size": 4000, "num_epochs": 1, "minibatch_size": 1000, "shuffle_batch_per_epoch": true, "model": {"fcnet_hiddens": [256, 256], "fcnet_activation": "tanh", "fcnet_weights_initializer": null, "fcnet_weights_initializer_config": null, "fcnet_bias_initializer": null, "fcnet_bias_initializer_config": null, "conv_filters": null, "conv_activation": "relu", "conv_kernel_initializer": null, "conv_kernel_initializer_config": null, "conv_bias_initializer": null, "conv_bias_initializer_config": null, "conv_transpose_kernel_initializer": null, "conv_transpose_kernel_initializer_config": null, "conv_transpose_bias_initializer": null, "conv_transpose_bias_initializer_config": null, "post_fcnet_hiddens": [], "post_fcnet_activation": "relu", "post_fcnet_weights_initializer": null, "post_fcnet_weights_initializer_config": null, "post_fcnet_bias_initializer": null, "post_fcnet_bias_initializer_config": null, "free_log_std": false, "log_std_clip_param": 20.0, "no_final_linear": false, "vf_share_layers": false, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "lstm_weights_initializer": null, "lstm_weights_initializer_config": null, "lstm_bias_initializer": null, "lstm_bias_initializer_config": null, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "attention_use_n_prev_actions": 0, "attention_use_n_prev_rewards": 0, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": null, "custom_model_config": {}, "custom_action_dist": null, "custom_preprocessor": null, "encoder_latent_dim": null, "always_check_shapes": false, "lstm_use_prev_action_reward": -1, "_use_default_native_models": -1, "_disable_preprocessor_api": false, "_disable_action_flattening": false}, "_learner_connector": null, "add_default_connectors_to_learner_pipeline": true, "learner_config_dict": {}, "optimizer": {}, "_learner_class": null, "callbacks_on_algorithm_init": null, "callbacks_on_env_runners_recreated": null, "callbacks_on_offline_eval_runners_recreated": null, "callbacks_on_checkpoint_loaded": null, "callbacks_on_environment_created": null, "callbacks_on_episode_created": null, "callbacks_on_episode_start": null, "callbacks_on_episode_step": null, "callbacks_on_episode_end": null, "callbacks_on_evaluate_start": null, "callbacks_on_evaluate_end": null, "callbacks_on_evaluate_offline_start": null, "callbacks_on_evaluate_offline_end": null, "callbacks_on_sample_end": null, "callbacks_on_train_result": null, "explore": true, "enable_rl_module_and_learner": true, "enable_env_runner_and_connector_v2": true, "_prior_exploration_config": {"type": "StochasticSampling"}, "count_steps_by": "env_steps", "policy_map_capacity": 100, "policy_mapping_fn": "<function AlgorithmConfig.DEFAULT_POLICY_MAPPING_FN at 0x388c81b20>", "policies_to_train": null, "policy_states_are_swappable": false, "observation_fn": null, "offline_data_class": null, "input_read_method": "read_parquet", "input_read_method_kwargs": {}, "input_read_schema": {}, "input_read_episodes": false, "input_read_sample_batches": false, "input_read_batch_size": null, "input_filesystem": null, "input_filesystem_kwargs": {}, "input_compress_columns": ["obs", "new_obs"], "input_spaces_jsonable": true, "materialize_data": false, "materialize_mapped_data": true, "map_batches_kwargs": {}, "iter_batches_kwargs": {}, "ignore_final_observation": false, "prelearner_class": null, "prelearner_buffer_class": null, "prelearner_buffer_kwargs": {}, "prelearner_module_synch_period": 10, "dataset_num_iters_per_learner": null, "input_config": {}, "actions_in_input_normalized": false, "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_config": {}, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "output_max_rows_per_file": null, "output_write_remaining_data": false, "output_write_method": "write_parquet", "output_write_method_kwargs": {}, "output_filesystem": null, "output_filesystem_kwargs": {}, "output_write_episodes": true, "offline_sampling": false, "evaluation_interval": 1, "evaluation_duration": 20, "evaluation_duration_unit": "episodes", "evaluation_sample_timeout_s": 120.0, "evaluation_auto_duration_min_env_steps_per_sample": 100, "evaluation_auto_duration_max_env_steps_per_sample": 2000, "evaluation_parallel_to_training": false, "evaluation_force_reset_envs_before_iteration": true, "evaluation_config": null, "off_policy_estimation_methods": {}, "ope_split_batch_by_episode": true, "evaluation_num_env_runners": 1, "in_evaluation": false, "sync_filters_on_rollout_workers_timeout_s": 10.0, "offline_evaluation_interval": null, "num_offline_eval_runners": 0, "offline_loss_for_module_fn": null, "offline_evaluation_duration": 1, "offline_evaluation_parallel_to_training": false, "offline_evaluation_timeout_s": 120.0, "num_cpus_per_offline_eval_runner": 1, "num_gpus_per_offline_eval_runner": 0, "custom_resources_per_offline_eval_runner": {}, "restart_failed_offline_eval_runners": true, "ignore_offline_eval_runner_failures": false, "max_num_offline_eval_runner_restarts": 1000, "offline_eval_runner_restore_timeout_s": 1800.0, "max_requests_in_flight_per_offline_eval_runner": 1, "validate_offline_eval_runners_after_construction": true, "offline_eval_runner_health_probe_timeout_s": 30.0, "offline_eval_rl_module_inference_only": false, "broadcast_offline_eval_runner_states": false, "offline_eval_batch_size_per_runner": 256, "dataset_num_iters_per_eval_runner": 1, "keep_per_episode_custom_metrics": false, "metrics_episode_collection_timeout_s": 60.0, "metrics_num_episodes_for_smoothing": 100, "min_time_s_per_iteration": null, "min_train_timesteps_per_iteration": 0, "min_sample_timesteps_per_iteration": 0, "log_gradients": true, "export_native_model_files": false, "checkpoint_trainable_policies_only": false, "logger_creator": null, "logger_config": null, "log_level": "WARN", "log_sys_usage": true, "fake_sampler": false, "seed": 8, "restart_failed_env_runners": true, "ignore_env_runner_failures": false, "max_num_env_runner_restarts": 1000, "delay_between_env_runner_restarts_s": 60.0, "restart_failed_sub_environments": false, "num_consecutive_env_runner_failures_tolerance": 100, "env_runner_health_probe_timeout_s": 30.0, "env_runner_restore_timeout_s": 1800.0, "_model_config": {}, "_rl_module_spec": "RLModuleSpec(module_class=None, observation_space=None, action_space=None, inference_only=False, learner_only=False, model_config=DefaultModelConfig(fcnet_hiddens=[60, 90], fcnet_activation='tanh', fcnet_kernel_initializer=None, fcnet_kernel_initializer_kwargs=None, fcnet_bias_initializer=None, fcnet_bias_initializer_kwargs=None, conv_filters=None, conv_activation='relu', conv_kernel_initializer=None, conv_kernel_initializer_kwargs=None, conv_bias_initializer=None, conv_bias_initializer_kwargs=None, head_fcnet_hiddens=[], head_fcnet_activation='relu', head_fcnet_kernel_initializer=None, head_fcnet_kernel_initializer_kwargs=None, head_fcnet_bias_initializer=None, head_fcnet_bias_initializer_kwargs=None, free_log_std=False, log_std_clip_param=20.0, vf_share_layers=True, use_lstm=False, max_seq_len=20, lstm_cell_size=256, lstm_use_prev_action=False, lstm_use_prev_reward=False, lstm_kernel_initializer=None, lstm_kernel_initializer_kwargs=None, lstm_bias_initializer=None, lstm_bias_initializer_kwargs=None), catalog_class=None, load_state_path=None, model_config_dict=None)", "algorithm_config_overrides_per_module": {}, "_per_module_overrides": {}, "_validate_config": true, "_use_msgpack_checkpoints": false, "_torch_grad_scaler_class": null, "_torch_lr_scheduler_classes": null, "_tf_policy_handles_more_than_one_loss": false, "_disable_preprocessor_api": false, "_disable_action_flattening": false, "_disable_initialize_loss_from_dummy_batch": false, "_dont_auto_sync_env_runner_states": false, "env_task_fn": -1, "enable_connectors": -1, "simple_optimizer": false, "policy_map_cache": -1, "worker_cls": -1, "synchronize_filters": -1, "enable_async_evaluation": -1, "custom_async_evaluation_function": -1, "_enable_rl_module_api": -1, "auto_wrap_old_gym_envs": -1, "always_attach_evaluation_results": -1, "replay_sequence_length": null, "_disable_execution_plan_api": -1, "use_critic": true, "use_gae": true, "use_kl_loss": true, "kl_coeff": 0.7464963036515, "kl_target": 0.0270990929592, "vf_loss_coeff": 0.6688075857018, "entropy_coeff": 0.0090570820258, "clip_param": 0.1221781641624, "vf_clip_param": 0.1027808522125, "entropy_coeff_schedule": null, "lr_schedule": null, "sgd_minibatch_size": -1, "vf_share_layers": -1, "__stdout_file__": null, "__stderr_file__": null, "lambda": 0.9099046732075, "input": "sampler", "policies": {"default_policy": [null, null, null, null]}, "callbacks": "<class 'ray.rllib.callbacks.callbacks.RLlibCallback'>", "create_env_on_driver": false, "custom_eval_function": null, "framework": "torch"}, "time_since_restore": 11.071894884109497, "iterations_since_restore": 3, "perf": {"cpu_util_percent": 77.65, "ram_util_percent": 80.57499999999999}}
{"timers": {"training_iteration": 4.8489973283867265, "restore_env_runners": 1.2676378550007938e-05, "training_step": 4.848796674153417, "env_runner_sampling_timer": 4.6785603165824625, "learner_update_timer": 0.16561451159283858, "synch_weights": 0.0010961502224751747, "restore_eval_env_runners": 6.564696298446505e-05, "evaluation_iteration": 0.26558545666569844, "synch_eval_env_connectors": 0.00044429181691957634, "synch_env_connectors": 5.785577977076173e-06}, "env_runners": {"episode_duration_sec_mean": 0.010673115655779839, "rlmodule_inference_timer": 7.034750793972566e-05, "env_to_module_connector": {"timers": {"connectors": {"numpy_to_tensor": 2.1322048584555013e-05, "add_observations_from_episodes_to_batch": 8.05320261101148e-06, "add_time_dim_to_batch_and_zero_pad": 4.806221191804027e-06, "batch_individual_items": 1.3499303830963795e-05, "add_states_from_episodes_to_batch": 2.9271047387024333e-06}}, "connector_pipeline_timer": 8.889894367846849e-05}, "sample": 0.01035257347859074, "env_reset_timer": 9.483847307772679e-05, "module_episode_returns_mean": {"default_policy": -0.3}, "episode_len_min": 20, "episode_len_max": 20, "module_to_env_connector": {"timers": {"connectors": {"tensor_to_numpy": 3.365511917425473e-05, "un_batch_to_individual_items": 1.1753915301286565e-05, "remove_single_ts_time_rank_from_batch": 1.118337039751938e-06, "listify_data_for_vector_env": 2.2870756051682885e-05, "normalize_and_clip_actions": 2.020243388787573e-05, "get_actions": 0.00011269368492524528}}, "connector_pipeline_timer": 0.0002530679097763504}, "num_episodes_lifetime": -61250.0, "num_module_steps_sampled_lifetime": {"default_policy": -1225000.0}, "episode_return_mean": -0.3, "num_env_steps_sampled": 5000.0, "episode_return_min": -11.5, "env_to_module_sum_episodes_length_in": 10.36823839457432, "env_step_timer": 3.5431949180112025e-05, "env_to_module_sum_episodes_length_out": 10.36823839457432, "weights_seq_no": 3.0, "num_episodes": 250.0, "num_agent_steps_sampled": {"default_agent": 5000.0}, "episode_return_max": 8.5, "time_between_sampling": 0.003063631799970517, "num_module_steps_sampled": {"default_policy": 5000.0}, "agent_episode_returns_mean": {"default_agent": -0.3}, "num_env_steps_sampled_lifetime": -1225000.0, "num_agent_steps_sampled_lifetime": {"default_agent": -1225000.0}, "episode_len_mean": 20.0, "num_env_steps_sampled_lifetime_throughput": 2111.9638277773133}, "learners": {"default_policy": {"default_optimizer_learning_rate": 0.0002847858517, "curr_entropy_coeff": 0.0090570820258, "gradients_default_optimizer_global_norm": 0.035478390753269196, "policy_loss": 0.004799160175025463, "num_module_steps_trained_lifetime": 24000, "diff_num_grad_updates_vs_sampler_policy": 1.0, "mean_kl_loss": 0.00018847151659429073, "weights_seq_no": 4.0, "curr_kl_coeff": 0.04665601998567581, "num_trainable_parameters": 6003, "num_module_steps_trained": 6000, "total_loss": 0.06732043623924255, "vf_explained_var": 0.002683281898498535, "module_train_batch_size_mean": 1000.0, "vf_loss": 0.10278083384037018, "entropy": 0.6886228322982788, "vf_loss_unclipped": 28.49736213684082, "num_module_steps_trained_lifetime_throughput": 329181.1683208651}, "__all_modules__": {"num_module_steps_trained_lifetime": 24000, "learner_connector_sum_episodes_length_in": 5000.0, "learner_connector": {"timers": {"connectors": {"add_observations_from_episodes_to_batch": 0.0010429248963578137, "add_columns_from_episodes_to_train_batch": 0.04637494784295151, "numpy_to_tensor": 7.971763974637723e-05, "add_time_dim_to_batch_and_zero_pad": 1.4507685454329476e-05, "add_states_from_episodes_to_batch": 3.6958816894330083e-06, "general_advantage_estimation": 0.008777755643552985, "batch_individual_items": 0.050738179900883924, "add_one_ts_to_episodes_and_truncate": 0.013276419505131315}}, "connector_pipeline_timer": 0.12050826479018735}, "num_non_trainable_parameters": 0, "num_env_steps_trained_lifetime": 126000, "num_trainable_parameters": 6003, "num_module_steps_trained": 6000, "num_env_steps_trained": 31500, "learner_connector_sum_episodes_length_out": 5250.0, "num_env_steps_trained_lifetime_throughput": 1714526.446595201, "num_module_steps_trained_throughput": 328412.7826243335, "num_module_steps_trained_lifetime_throughput": 327703.36769614}}, "num_training_step_calls_per_iteration": 1, "evaluation": {"env_runners": {"env_to_module_connector": {"timers": {"connectors": {"numpy_to_tensor": 2.4629231096951157e-05, "add_time_dim_to_batch_and_zero_pad": 6.211532747890221e-06, "add_states_from_episodes_to_batch": 3.0129326269272435e-06, "batch_individual_items": 1.6281708820514584e-05, "add_observations_from_episodes_to_batch": 6.395947518666395e-06}}, "connector_pipeline_timer": 9.850744873761026e-05}, "num_env_steps_sampled": 400, "num_episodes": 20, "episode_duration_sec_mean": 0.009174268734932411, "num_agent_steps_sampled": {"default_agent": 400}, "module_to_env_connector": {"timers": {"connectors": {"un_batch_to_individual_items": 1.0770949137864371e-05, "listify_data_for_vector_env": 2.5856946650590437e-05, "remove_single_ts_time_rank_from_batch": 1.4653672670097995e-06, "normalize_and_clip_actions": 1.9328697833323436e-05, "get_actions": 9.98602890828011e-05, "tensor_to_numpy": 3.5487997163835405e-05}}, "connector_pipeline_timer": 0.0002508997492344301}, "sample": 0.24906348217935192, "agent_episode_returns_mean": {"default_agent": 1.5}, "episode_return_min": -14.5, "env_step_timer": 3.9910257428504324e-05, "env_to_module_sum_episodes_length_in": 10.368237912813044, "env_to_module_sum_episodes_length_out": 10.368237912813044, "weights_seq_no": 4.0, "episode_len_min": 20, "episode_len_max": 20, "num_agent_steps_sampled_lifetime": {"default_agent": 1600}, "num_episodes_lifetime": 80, "num_module_steps_sampled_lifetime": {"default_policy": 1600}, "episode_len_mean": 20.0, "env_reset_timer": 0.0007317664780099876, "episode_return_max": 14.5, "module_episode_returns_mean": {"default_policy": 1.5}, "num_env_steps_sampled_lifetime": 20400, "rlmodule_inference_timer": 7.078564947335504e-05, "num_module_steps_sampled": {"default_policy": 400}, "episode_return_mean": 1.5, "time_between_sampling": 2.778484913561353}, "num_healthy_workers": 1, "actor_manager_num_outstanding_async_reqs": 0, "num_remote_worker_restarts": 0}, "num_env_steps_sampled_lifetime": -1225000.0, "fault_tolerance": {"num_healthy_workers": 0, "num_remote_worker_restarts": 0}, "env_runner_group": {"actor_manager_num_outstanding_async_reqs": 0}, "done": false, "training_iteration": 4, "trial_id": "49f07_00000", "date": "2025-08-11_19-31-56", "timestamp": 1754933516, "time_this_iter_s": 3.756070137023926, "time_total_s": 14.827965021133423, "pid": 24465, "hostname": "Mac", "node_ip": "127.0.0.1", "config": {"exploration_config": {}, "extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "placement_strategy": "PACK", "num_gpus": 0, "_fake_gpus": false, "num_cpus_for_main_process": 2, "eager_tracing": true, "eager_max_retraces": 20, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "torch_compile_learner": false, "torch_compile_learner_what_to_compile": "forward_train", "torch_compile_learner_dynamo_backend": "aot_eager", "torch_compile_learner_dynamo_mode": null, "torch_compile_worker": false, "torch_compile_worker_dynamo_backend": "aot_eager", "torch_compile_worker_dynamo_mode": null, "torch_ddp_kwargs": {}, "torch_skip_nan_gradients": false, "env": "Umbrella", "env_config": {}, "observation_space": null, "action_space": null, "clip_rewards": null, "normalize_actions": true, "clip_actions": false, "_is_atari": null, "disable_env_checking": false, "render_env": false, "action_mask_key": "action_mask", "env_runner_cls": null, "num_env_runners": 0, "create_local_env_runner": true, "num_envs_per_env_runner": 1, "gym_env_vectorize_mode": "SYNC", "num_cpus_per_env_runner": 1, "num_gpus_per_env_runner": 0, "custom_resources_per_env_runner": {}, "validate_env_runners_after_construction": true, "episodes_to_numpy": true, "max_requests_in_flight_per_env_runner": 1, "sample_timeout_s": 60.0, "_env_to_module_connector": null, "add_default_connectors_to_env_to_module_pipeline": true, "_module_to_env_connector": null, "add_default_connectors_to_module_to_env_pipeline": true, "merge_env_runner_states": "training_only", "broadcast_env_runner_states": true, "episode_lookback_horizon": 1, "rollout_fragment_length": "auto", "batch_mode": "complete_episodes", "compress_observations": false, "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "enable_tf1_exec_eagerly": false, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "preprocessor_pref": "deepmind", "observation_filter": "NoFilter", "update_worker_filter_stats": true, "use_worker_filter_stats": true, "sampler_perf_stats_ema_coef": null, "_is_online": true, "num_learners": 0, "num_gpus_per_learner": 0, "num_cpus_per_learner": "auto", "num_aggregator_actors_per_learner": 0, "max_requests_in_flight_per_aggregator_actor": 3, "local_gpu_idx": 0, "max_requests_in_flight_per_learner": 3, "gamma": 1, "lr": 0.0002847858517, "grad_clip": 0.5, "grad_clip_by": "global_norm", "_train_batch_size_per_learner": 5000, "train_batch_size": 4000, "num_epochs": 1, "minibatch_size": 1000, "shuffle_batch_per_epoch": true, "model": {"fcnet_hiddens": [256, 256], "fcnet_activation": "tanh", "fcnet_weights_initializer": null, "fcnet_weights_initializer_config": null, "fcnet_bias_initializer": null, "fcnet_bias_initializer_config": null, "conv_filters": null, "conv_activation": "relu", "conv_kernel_initializer": null, "conv_kernel_initializer_config": null, "conv_bias_initializer": null, "conv_bias_initializer_config": null, "conv_transpose_kernel_initializer": null, "conv_transpose_kernel_initializer_config": null, "conv_transpose_bias_initializer": null, "conv_transpose_bias_initializer_config": null, "post_fcnet_hiddens": [], "post_fcnet_activation": "relu", "post_fcnet_weights_initializer": null, "post_fcnet_weights_initializer_config": null, "post_fcnet_bias_initializer": null, "post_fcnet_bias_initializer_config": null, "free_log_std": false, "log_std_clip_param": 20.0, "no_final_linear": false, "vf_share_layers": false, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "lstm_weights_initializer": null, "lstm_weights_initializer_config": null, "lstm_bias_initializer": null, "lstm_bias_initializer_config": null, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "attention_use_n_prev_actions": 0, "attention_use_n_prev_rewards": 0, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": null, "custom_model_config": {}, "custom_action_dist": null, "custom_preprocessor": null, "encoder_latent_dim": null, "always_check_shapes": false, "lstm_use_prev_action_reward": -1, "_use_default_native_models": -1, "_disable_preprocessor_api": false, "_disable_action_flattening": false}, "_learner_connector": null, "add_default_connectors_to_learner_pipeline": true, "learner_config_dict": {}, "optimizer": {}, "_learner_class": null, "callbacks_on_algorithm_init": null, "callbacks_on_env_runners_recreated": null, "callbacks_on_offline_eval_runners_recreated": null, "callbacks_on_checkpoint_loaded": null, "callbacks_on_environment_created": null, "callbacks_on_episode_created": null, "callbacks_on_episode_start": null, "callbacks_on_episode_step": null, "callbacks_on_episode_end": null, "callbacks_on_evaluate_start": null, "callbacks_on_evaluate_end": null, "callbacks_on_evaluate_offline_start": null, "callbacks_on_evaluate_offline_end": null, "callbacks_on_sample_end": null, "callbacks_on_train_result": null, "explore": true, "enable_rl_module_and_learner": true, "enable_env_runner_and_connector_v2": true, "_prior_exploration_config": {"type": "StochasticSampling"}, "count_steps_by": "env_steps", "policy_map_capacity": 100, "policy_mapping_fn": "<function AlgorithmConfig.DEFAULT_POLICY_MAPPING_FN at 0x388c81b20>", "policies_to_train": null, "policy_states_are_swappable": false, "observation_fn": null, "offline_data_class": null, "input_read_method": "read_parquet", "input_read_method_kwargs": {}, "input_read_schema": {}, "input_read_episodes": false, "input_read_sample_batches": false, "input_read_batch_size": null, "input_filesystem": null, "input_filesystem_kwargs": {}, "input_compress_columns": ["obs", "new_obs"], "input_spaces_jsonable": true, "materialize_data": false, "materialize_mapped_data": true, "map_batches_kwargs": {}, "iter_batches_kwargs": {}, "ignore_final_observation": false, "prelearner_class": null, "prelearner_buffer_class": null, "prelearner_buffer_kwargs": {}, "prelearner_module_synch_period": 10, "dataset_num_iters_per_learner": null, "input_config": {}, "actions_in_input_normalized": false, "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_config": {}, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "output_max_rows_per_file": null, "output_write_remaining_data": false, "output_write_method": "write_parquet", "output_write_method_kwargs": {}, "output_filesystem": null, "output_filesystem_kwargs": {}, "output_write_episodes": true, "offline_sampling": false, "evaluation_interval": 1, "evaluation_duration": 20, "evaluation_duration_unit": "episodes", "evaluation_sample_timeout_s": 120.0, "evaluation_auto_duration_min_env_steps_per_sample": 100, "evaluation_auto_duration_max_env_steps_per_sample": 2000, "evaluation_parallel_to_training": false, "evaluation_force_reset_envs_before_iteration": true, "evaluation_config": null, "off_policy_estimation_methods": {}, "ope_split_batch_by_episode": true, "evaluation_num_env_runners": 1, "in_evaluation": false, "sync_filters_on_rollout_workers_timeout_s": 10.0, "offline_evaluation_interval": null, "num_offline_eval_runners": 0, "offline_loss_for_module_fn": null, "offline_evaluation_duration": 1, "offline_evaluation_parallel_to_training": false, "offline_evaluation_timeout_s": 120.0, "num_cpus_per_offline_eval_runner": 1, "num_gpus_per_offline_eval_runner": 0, "custom_resources_per_offline_eval_runner": {}, "restart_failed_offline_eval_runners": true, "ignore_offline_eval_runner_failures": false, "max_num_offline_eval_runner_restarts": 1000, "offline_eval_runner_restore_timeout_s": 1800.0, "max_requests_in_flight_per_offline_eval_runner": 1, "validate_offline_eval_runners_after_construction": true, "offline_eval_runner_health_probe_timeout_s": 30.0, "offline_eval_rl_module_inference_only": false, "broadcast_offline_eval_runner_states": false, "offline_eval_batch_size_per_runner": 256, "dataset_num_iters_per_eval_runner": 1, "keep_per_episode_custom_metrics": false, "metrics_episode_collection_timeout_s": 60.0, "metrics_num_episodes_for_smoothing": 100, "min_time_s_per_iteration": null, "min_train_timesteps_per_iteration": 0, "min_sample_timesteps_per_iteration": 0, "log_gradients": true, "export_native_model_files": false, "checkpoint_trainable_policies_only": false, "logger_creator": null, "logger_config": null, "log_level": "WARN", "log_sys_usage": true, "fake_sampler": false, "seed": 8, "restart_failed_env_runners": true, "ignore_env_runner_failures": false, "max_num_env_runner_restarts": 1000, "delay_between_env_runner_restarts_s": 60.0, "restart_failed_sub_environments": false, "num_consecutive_env_runner_failures_tolerance": 100, "env_runner_health_probe_timeout_s": 30.0, "env_runner_restore_timeout_s": 1800.0, "_model_config": {}, "_rl_module_spec": "RLModuleSpec(module_class=None, observation_space=None, action_space=None, inference_only=False, learner_only=False, model_config=DefaultModelConfig(fcnet_hiddens=[60, 90], fcnet_activation='tanh', fcnet_kernel_initializer=None, fcnet_kernel_initializer_kwargs=None, fcnet_bias_initializer=None, fcnet_bias_initializer_kwargs=None, conv_filters=None, conv_activation='relu', conv_kernel_initializer=None, conv_kernel_initializer_kwargs=None, conv_bias_initializer=None, conv_bias_initializer_kwargs=None, head_fcnet_hiddens=[], head_fcnet_activation='relu', head_fcnet_kernel_initializer=None, head_fcnet_kernel_initializer_kwargs=None, head_fcnet_bias_initializer=None, head_fcnet_bias_initializer_kwargs=None, free_log_std=False, log_std_clip_param=20.0, vf_share_layers=True, use_lstm=False, max_seq_len=20, lstm_cell_size=256, lstm_use_prev_action=False, lstm_use_prev_reward=False, lstm_kernel_initializer=None, lstm_kernel_initializer_kwargs=None, lstm_bias_initializer=None, lstm_bias_initializer_kwargs=None), catalog_class=None, load_state_path=None, model_config_dict=None)", "algorithm_config_overrides_per_module": {}, "_per_module_overrides": {}, "_validate_config": true, "_use_msgpack_checkpoints": false, "_torch_grad_scaler_class": null, "_torch_lr_scheduler_classes": null, "_tf_policy_handles_more_than_one_loss": false, "_disable_preprocessor_api": false, "_disable_action_flattening": false, "_disable_initialize_loss_from_dummy_batch": false, "_dont_auto_sync_env_runner_states": false, "env_task_fn": -1, "enable_connectors": -1, "simple_optimizer": false, "policy_map_cache": -1, "worker_cls": -1, "synchronize_filters": -1, "enable_async_evaluation": -1, "custom_async_evaluation_function": -1, "_enable_rl_module_api": -1, "auto_wrap_old_gym_envs": -1, "always_attach_evaluation_results": -1, "replay_sequence_length": null, "_disable_execution_plan_api": -1, "use_critic": true, "use_gae": true, "use_kl_loss": true, "kl_coeff": 0.7464963036515, "kl_target": 0.0270990929592, "vf_loss_coeff": 0.6688075857018, "entropy_coeff": 0.0090570820258, "clip_param": 0.1221781641624, "vf_clip_param": 0.1027808522125, "entropy_coeff_schedule": null, "lr_schedule": null, "sgd_minibatch_size": -1, "vf_share_layers": -1, "__stdout_file__": null, "__stderr_file__": null, "lambda": 0.9099046732075, "input": "sampler", "policies": {"default_policy": [null, null, null, null]}, "callbacks": "<class 'ray.rllib.callbacks.callbacks.RLlibCallback'>", "create_env_on_driver": false, "custom_eval_function": null, "framework": "torch"}, "time_since_restore": 14.827965021133423, "iterations_since_restore": 4, "perf": {"cpu_util_percent": 85.8, "ram_util_percent": 81.22}}
{"timers": {"training_iteration": 4.8315885105133605, "restore_env_runners": 1.283628400204703e-05, "training_step": 4.831383022832001, "env_runner_sampling_timer": 4.6607995554966, "learner_update_timer": 0.16594760064708816, "synch_weights": 0.0010995578913631989, "restore_eval_env_runners": 6.559965398837812e-05, "evaluation_iteration": 0.2654333804281605, "synch_eval_env_connectors": 0.00044257430832704987, "synch_env_connectors": 5.778142837341875e-06}, "env_runners": {"episode_duration_sec_mean": 0.00969037247542292, "rlmodule_inference_timer": 0.00011268683413905835, "env_to_module_connector": {"timers": {"connectors": {"numpy_to_tensor": 1.7417242123212108e-05, "add_observations_from_episodes_to_batch": 5.240512839494314e-06, "add_time_dim_to_batch_and_zero_pad": 4.1189469753513886e-06, "batch_individual_items": 1.1674937300125866e-05, "add_states_from_episodes_to_batch": 2.6029923392572733e-06}}, "connector_pipeline_timer": 7.530544052733549e-05}, "sample": 0.010318487915844995, "env_reset_timer": 8.957018144588054e-05, "module_episode_returns_mean": {"default_policy": -0.14000000000000007}, "episode_len_min": 20, "episode_len_max": 20, "module_to_env_connector": {"timers": {"connectors": {"tensor_to_numpy": 2.4415083620701495e-05, "un_batch_to_individual_items": 9.580042514402389e-06, "remove_single_ts_time_rank_from_batch": 1.0335487734840892e-06, "listify_data_for_vector_env": 1.9946464950617102e-05, "normalize_and_clip_actions": 1.6582140248169826e-05, "get_actions": 8.636903947865288e-05}}, "connector_pipeline_timer": 0.00020007502531975603}, "num_episodes_lifetime": -92125.0, "num_module_steps_sampled_lifetime": {"default_policy": -1842500.0}, "episode_return_mean": -0.14000000000000007, "num_env_steps_sampled": 5000.0, "episode_return_min": -11.5, "env_to_module_sum_episodes_length_in": 10.36823839457432, "env_step_timer": 2.699879536783577e-05, "env_to_module_sum_episodes_length_out": 10.36823839457432, "weights_seq_no": 4.0, "num_episodes": 250.0, "num_agent_steps_sampled": {"default_agent": 5000.0}, "episode_return_max": 8.5, "time_between_sampling": 0.003221766408151738, "num_module_steps_sampled": {"default_policy": 5000.0}, "agent_episode_returns_mean": {"default_agent": -0.14000000000000007}, "num_env_steps_sampled_lifetime": -1842500.0, "num_agent_steps_sampled_lifetime": {"default_agent": -1842500.0}, "episode_len_mean": 20.0, "num_env_steps_sampled_lifetime_throughput": 2288.6690914974492}, "learners": {"default_policy": {"default_optimizer_learning_rate": 0.0002847858517, "curr_entropy_coeff": 0.0090570820258, "gradients_default_optimizer_global_norm": 0.09610242396593094, "policy_loss": 0.03844098374247551, "num_module_steps_trained_lifetime": 30000, "diff_num_grad_updates_vs_sampler_policy": 1.0, "mean_kl_loss": 0.0005214021657593548, "weights_seq_no": 5.0, "curr_kl_coeff": 0.023328009992837906, "num_trainable_parameters": 6003, "num_module_steps_trained": 6000, "total_loss": 0.10100902616977692, "vf_explained_var": 0.003237903118133545, "module_train_batch_size_mean": 1000.0, "vf_loss": 0.10278083384037018, "entropy": 0.6842040419578552, "vf_loss_unclipped": 28.689939498901367, "num_module_steps_trained_lifetime_throughput": 324198.2154725352}, "__all_modules__": {"num_module_steps_trained_lifetime": 30000, "learner_connector_sum_episodes_length_in": 5000.0, "learner_connector": {"timers": {"connectors": {"add_observations_from_episodes_to_batch": 0.0010559568982153639, "add_columns_from_episodes_to_train_batch": 0.04677121044504238, "numpy_to_tensor": 7.964712313114431e-05, "add_time_dim_to_batch_and_zero_pad": 1.4506359403331299e-05, "add_states_from_episodes_to_batch": 3.8072534548444676e-06, "general_advantage_estimation": 0.008782498507556996, "batch_individual_items": 0.05071599310136688, "add_one_ts_to_episodes_and_truncate": 0.013358175309070002}}, "connector_pipeline_timer": 0.12098235089211895}, "num_non_trainable_parameters": 0, "num_env_steps_trained_lifetime": 157500, "num_trainable_parameters": 6003, "num_module_steps_trained": 6000, "num_env_steps_trained": 31500, "learner_connector_sum_episodes_length_out": 5250.0, "num_env_steps_trained_lifetime_throughput": 1688859.2077132314, "num_module_steps_trained_throughput": 323462.5989976182, "num_module_steps_trained_lifetime_throughput": 322777.4284927814}}, "num_training_step_calls_per_iteration": 1, "evaluation": {"env_runners": {"env_to_module_connector": {"timers": {"connectors": {"numpy_to_tensor": 3.094363540021327e-05, "add_time_dim_to_batch_and_zero_pad": 7.966107112351284e-06, "add_states_from_episodes_to_batch": 4.541499765162435e-06, "batch_individual_items": 2.085933074609843e-05, "add_observations_from_episodes_to_batch": 8.796393690190769e-06}}, "connector_pipeline_timer": 0.00012541507883704432}, "num_env_steps_sampled": 400, "num_episodes": 20, "episode_duration_sec_mean": 0.009664881230564788, "num_agent_steps_sampled": {"default_agent": 400}, "module_to_env_connector": {"timers": {"connectors": {"un_batch_to_individual_items": 1.4898511376494602e-05, "listify_data_for_vector_env": 3.571707051283005e-05, "remove_single_ts_time_rank_from_batch": 1.71289131809249e-06, "normalize_and_clip_actions": 2.8521052958738286e-05, "get_actions": 0.0001298259277690635, "tensor_to_numpy": 4.2549809161414544e-05}}, "connector_pipeline_timer": 0.00032604451943342916}, "sample": 0.2491072386077869, "agent_episode_returns_mean": {"default_agent": 1.35}, "episode_return_min": -14.5, "env_step_timer": 5.1407226091669845e-05, "env_to_module_sum_episodes_length_in": 10.368238387501162, "env_to_module_sum_episodes_length_out": 10.368238387501162, "weights_seq_no": 5.0, "episode_len_min": 20, "episode_len_max": 20, "num_agent_steps_sampled_lifetime": {"default_agent": 2000}, "num_episodes_lifetime": 100, "num_module_steps_sampled_lifetime": {"default_policy": 2000}, "episode_len_mean": 20.0, "env_reset_timer": 0.0007257621422056994, "episode_return_max": 14.5, "module_episode_returns_mean": {"default_policy": 1.35}, "num_env_steps_sampled_lifetime": 25400, "rlmodule_inference_timer": 0.00010308641041947616, "num_module_steps_sampled": {"default_policy": 400}, "episode_return_mean": 1.35, "time_between_sampling": 2.7820499598359794}, "num_healthy_workers": 1, "actor_manager_num_outstanding_async_reqs": 0, "num_remote_worker_restarts": 0}, "num_env_steps_sampled_lifetime": -1842500.0, "fault_tolerance": {"num_healthy_workers": 0, "num_remote_worker_restarts": 0}, "env_runner_group": {"actor_manager_num_outstanding_async_reqs": 0}, "done": false, "training_iteration": 5, "trial_id": "49f07_00000", "date": "2025-08-11_19-32-00", "timestamp": 1754933520, "time_this_iter_s": 3.37475323677063, "time_total_s": 18.202718257904053, "pid": 24465, "hostname": "Mac", "node_ip": "127.0.0.1", "config": {"exploration_config": {}, "extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "placement_strategy": "PACK", "num_gpus": 0, "_fake_gpus": false, "num_cpus_for_main_process": 2, "eager_tracing": true, "eager_max_retraces": 20, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "torch_compile_learner": false, "torch_compile_learner_what_to_compile": "forward_train", "torch_compile_learner_dynamo_backend": "aot_eager", "torch_compile_learner_dynamo_mode": null, "torch_compile_worker": false, "torch_compile_worker_dynamo_backend": "aot_eager", "torch_compile_worker_dynamo_mode": null, "torch_ddp_kwargs": {}, "torch_skip_nan_gradients": false, "env": "Umbrella", "env_config": {}, "observation_space": null, "action_space": null, "clip_rewards": null, "normalize_actions": true, "clip_actions": false, "_is_atari": null, "disable_env_checking": false, "render_env": false, "action_mask_key": "action_mask", "env_runner_cls": null, "num_env_runners": 0, "create_local_env_runner": true, "num_envs_per_env_runner": 1, "gym_env_vectorize_mode": "SYNC", "num_cpus_per_env_runner": 1, "num_gpus_per_env_runner": 0, "custom_resources_per_env_runner": {}, "validate_env_runners_after_construction": true, "episodes_to_numpy": true, "max_requests_in_flight_per_env_runner": 1, "sample_timeout_s": 60.0, "_env_to_module_connector": null, "add_default_connectors_to_env_to_module_pipeline": true, "_module_to_env_connector": null, "add_default_connectors_to_module_to_env_pipeline": true, "merge_env_runner_states": "training_only", "broadcast_env_runner_states": true, "episode_lookback_horizon": 1, "rollout_fragment_length": "auto", "batch_mode": "complete_episodes", "compress_observations": false, "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "enable_tf1_exec_eagerly": false, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "preprocessor_pref": "deepmind", "observation_filter": "NoFilter", "update_worker_filter_stats": true, "use_worker_filter_stats": true, "sampler_perf_stats_ema_coef": null, "_is_online": true, "num_learners": 0, "num_gpus_per_learner": 0, "num_cpus_per_learner": "auto", "num_aggregator_actors_per_learner": 0, "max_requests_in_flight_per_aggregator_actor": 3, "local_gpu_idx": 0, "max_requests_in_flight_per_learner": 3, "gamma": 1, "lr": 0.0002847858517, "grad_clip": 0.5, "grad_clip_by": "global_norm", "_train_batch_size_per_learner": 5000, "train_batch_size": 4000, "num_epochs": 1, "minibatch_size": 1000, "shuffle_batch_per_epoch": true, "model": {"fcnet_hiddens": [256, 256], "fcnet_activation": "tanh", "fcnet_weights_initializer": null, "fcnet_weights_initializer_config": null, "fcnet_bias_initializer": null, "fcnet_bias_initializer_config": null, "conv_filters": null, "conv_activation": "relu", "conv_kernel_initializer": null, "conv_kernel_initializer_config": null, "conv_bias_initializer": null, "conv_bias_initializer_config": null, "conv_transpose_kernel_initializer": null, "conv_transpose_kernel_initializer_config": null, "conv_transpose_bias_initializer": null, "conv_transpose_bias_initializer_config": null, "post_fcnet_hiddens": [], "post_fcnet_activation": "relu", "post_fcnet_weights_initializer": null, "post_fcnet_weights_initializer_config": null, "post_fcnet_bias_initializer": null, "post_fcnet_bias_initializer_config": null, "free_log_std": false, "log_std_clip_param": 20.0, "no_final_linear": false, "vf_share_layers": false, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "lstm_weights_initializer": null, "lstm_weights_initializer_config": null, "lstm_bias_initializer": null, "lstm_bias_initializer_config": null, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "attention_use_n_prev_actions": 0, "attention_use_n_prev_rewards": 0, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": null, "custom_model_config": {}, "custom_action_dist": null, "custom_preprocessor": null, "encoder_latent_dim": null, "always_check_shapes": false, "lstm_use_prev_action_reward": -1, "_use_default_native_models": -1, "_disable_preprocessor_api": false, "_disable_action_flattening": false}, "_learner_connector": null, "add_default_connectors_to_learner_pipeline": true, "learner_config_dict": {}, "optimizer": {}, "_learner_class": null, "callbacks_on_algorithm_init": null, "callbacks_on_env_runners_recreated": null, "callbacks_on_offline_eval_runners_recreated": null, "callbacks_on_checkpoint_loaded": null, "callbacks_on_environment_created": null, "callbacks_on_episode_created": null, "callbacks_on_episode_start": null, "callbacks_on_episode_step": null, "callbacks_on_episode_end": null, "callbacks_on_evaluate_start": null, "callbacks_on_evaluate_end": null, "callbacks_on_evaluate_offline_start": null, "callbacks_on_evaluate_offline_end": null, "callbacks_on_sample_end": null, "callbacks_on_train_result": null, "explore": true, "enable_rl_module_and_learner": true, "enable_env_runner_and_connector_v2": true, "_prior_exploration_config": {"type": "StochasticSampling"}, "count_steps_by": "env_steps", "policy_map_capacity": 100, "policy_mapping_fn": "<function AlgorithmConfig.DEFAULT_POLICY_MAPPING_FN at 0x388c81b20>", "policies_to_train": null, "policy_states_are_swappable": false, "observation_fn": null, "offline_data_class": null, "input_read_method": "read_parquet", "input_read_method_kwargs": {}, "input_read_schema": {}, "input_read_episodes": false, "input_read_sample_batches": false, "input_read_batch_size": null, "input_filesystem": null, "input_filesystem_kwargs": {}, "input_compress_columns": ["obs", "new_obs"], "input_spaces_jsonable": true, "materialize_data": false, "materialize_mapped_data": true, "map_batches_kwargs": {}, "iter_batches_kwargs": {}, "ignore_final_observation": false, "prelearner_class": null, "prelearner_buffer_class": null, "prelearner_buffer_kwargs": {}, "prelearner_module_synch_period": 10, "dataset_num_iters_per_learner": null, "input_config": {}, "actions_in_input_normalized": false, "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_config": {}, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "output_max_rows_per_file": null, "output_write_remaining_data": false, "output_write_method": "write_parquet", "output_write_method_kwargs": {}, "output_filesystem": null, "output_filesystem_kwargs": {}, "output_write_episodes": true, "offline_sampling": false, "evaluation_interval": 1, "evaluation_duration": 20, "evaluation_duration_unit": "episodes", "evaluation_sample_timeout_s": 120.0, "evaluation_auto_duration_min_env_steps_per_sample": 100, "evaluation_auto_duration_max_env_steps_per_sample": 2000, "evaluation_parallel_to_training": false, "evaluation_force_reset_envs_before_iteration": true, "evaluation_config": null, "off_policy_estimation_methods": {}, "ope_split_batch_by_episode": true, "evaluation_num_env_runners": 1, "in_evaluation": false, "sync_filters_on_rollout_workers_timeout_s": 10.0, "offline_evaluation_interval": null, "num_offline_eval_runners": 0, "offline_loss_for_module_fn": null, "offline_evaluation_duration": 1, "offline_evaluation_parallel_to_training": false, "offline_evaluation_timeout_s": 120.0, "num_cpus_per_offline_eval_runner": 1, "num_gpus_per_offline_eval_runner": 0, "custom_resources_per_offline_eval_runner": {}, "restart_failed_offline_eval_runners": true, "ignore_offline_eval_runner_failures": false, "max_num_offline_eval_runner_restarts": 1000, "offline_eval_runner_restore_timeout_s": 1800.0, "max_requests_in_flight_per_offline_eval_runner": 1, "validate_offline_eval_runners_after_construction": true, "offline_eval_runner_health_probe_timeout_s": 30.0, "offline_eval_rl_module_inference_only": false, "broadcast_offline_eval_runner_states": false, "offline_eval_batch_size_per_runner": 256, "dataset_num_iters_per_eval_runner": 1, "keep_per_episode_custom_metrics": false, "metrics_episode_collection_timeout_s": 60.0, "metrics_num_episodes_for_smoothing": 100, "min_time_s_per_iteration": null, "min_train_timesteps_per_iteration": 0, "min_sample_timesteps_per_iteration": 0, "log_gradients": true, "export_native_model_files": false, "checkpoint_trainable_policies_only": false, "logger_creator": null, "logger_config": null, "log_level": "WARN", "log_sys_usage": true, "fake_sampler": false, "seed": 8, "restart_failed_env_runners": true, "ignore_env_runner_failures": false, "max_num_env_runner_restarts": 1000, "delay_between_env_runner_restarts_s": 60.0, "restart_failed_sub_environments": false, "num_consecutive_env_runner_failures_tolerance": 100, "env_runner_health_probe_timeout_s": 30.0, "env_runner_restore_timeout_s": 1800.0, "_model_config": {}, "_rl_module_spec": "RLModuleSpec(module_class=None, observation_space=None, action_space=None, inference_only=False, learner_only=False, model_config=DefaultModelConfig(fcnet_hiddens=[60, 90], fcnet_activation='tanh', fcnet_kernel_initializer=None, fcnet_kernel_initializer_kwargs=None, fcnet_bias_initializer=None, fcnet_bias_initializer_kwargs=None, conv_filters=None, conv_activation='relu', conv_kernel_initializer=None, conv_kernel_initializer_kwargs=None, conv_bias_initializer=None, conv_bias_initializer_kwargs=None, head_fcnet_hiddens=[], head_fcnet_activation='relu', head_fcnet_kernel_initializer=None, head_fcnet_kernel_initializer_kwargs=None, head_fcnet_bias_initializer=None, head_fcnet_bias_initializer_kwargs=None, free_log_std=False, log_std_clip_param=20.0, vf_share_layers=True, use_lstm=False, max_seq_len=20, lstm_cell_size=256, lstm_use_prev_action=False, lstm_use_prev_reward=False, lstm_kernel_initializer=None, lstm_kernel_initializer_kwargs=None, lstm_bias_initializer=None, lstm_bias_initializer_kwargs=None), catalog_class=None, load_state_path=None, model_config_dict=None)", "algorithm_config_overrides_per_module": {}, "_per_module_overrides": {}, "_validate_config": true, "_use_msgpack_checkpoints": false, "_torch_grad_scaler_class": null, "_torch_lr_scheduler_classes": null, "_tf_policy_handles_more_than_one_loss": false, "_disable_preprocessor_api": false, "_disable_action_flattening": false, "_disable_initialize_loss_from_dummy_batch": false, "_dont_auto_sync_env_runner_states": false, "env_task_fn": -1, "enable_connectors": -1, "simple_optimizer": false, "policy_map_cache": -1, "worker_cls": -1, "synchronize_filters": -1, "enable_async_evaluation": -1, "custom_async_evaluation_function": -1, "_enable_rl_module_api": -1, "auto_wrap_old_gym_envs": -1, "always_attach_evaluation_results": -1, "replay_sequence_length": null, "_disable_execution_plan_api": -1, "use_critic": true, "use_gae": true, "use_kl_loss": true, "kl_coeff": 0.7464963036515, "kl_target": 0.0270990929592, "vf_loss_coeff": 0.6688075857018, "entropy_coeff": 0.0090570820258, "clip_param": 0.1221781641624, "vf_clip_param": 0.1027808522125, "entropy_coeff_schedule": null, "lr_schedule": null, "sgd_minibatch_size": -1, "vf_share_layers": -1, "__stdout_file__": null, "__stderr_file__": null, "lambda": 0.9099046732075, "input": "sampler", "policies": {"default_policy": [null, null, null, null]}, "callbacks": "<class 'ray.rllib.callbacks.callbacks.RLlibCallback'>", "create_env_on_driver": false, "custom_eval_function": null, "framework": "torch"}, "time_since_restore": 18.202718257904053, "iterations_since_restore": 5, "perf": {"cpu_util_percent": 72.34, "ram_util_percent": 81.53999999999999}}
{"timers": {"training_iteration": 4.816345097068789, "restore_env_runners": 1.3028751311602629e-05, "training_step": 4.816137423853608, "env_runner_sampling_timer": 4.644171632021559, "learner_update_timer": 0.16734027797068074, "synch_weights": 0.0010968681417007518, "restore_eval_env_runners": 6.510948758197716e-05, "evaluation_iteration": 0.2654117257843304, "synch_eval_env_connectors": 0.00043943856458909683, "synch_env_connectors": 5.807441233848222e-06}, "env_runners": {"episode_duration_sec_mean": 0.01015456964960322, "rlmodule_inference_timer": 6.606625356910804e-05, "env_to_module_connector": {"timers": {"connectors": {"numpy_to_tensor": 1.948087266409234e-05, "add_observations_from_episodes_to_batch": 5.898997092140162e-06, "add_time_dim_to_batch_and_zero_pad": 4.757190579444985e-06, "batch_individual_items": 1.2710815824223475e-05, "add_states_from_episodes_to_batch": 2.8849463921368156e-06}}, "connector_pipeline_timer": 8.266525821392639e-05}, "sample": 0.011782419845471704, "env_reset_timer": 8.541680932724563e-05, "module_episode_returns_mean": {"default_policy": 0.58}, "episode_len_min": 20, "episode_len_max": 20, "module_to_env_connector": {"timers": {"connectors": {"tensor_to_numpy": 3.4970214153876035e-05, "un_batch_to_individual_items": 1.0398295688607926e-05, "remove_single_ts_time_rank_from_batch": 1.0588192097468987e-06, "listify_data_for_vector_env": 2.2463899532666854e-05, "normalize_and_clip_actions": 2.164739768130637e-05, "get_actions": 0.00010751133399010256}}, "connector_pipeline_timer": 0.00024628604233432427}, "num_episodes_lifetime": -123000.0, "num_module_steps_sampled_lifetime": {"default_policy": -2460000.0}, "episode_return_mean": 0.58, "num_env_steps_sampled": 5000.0, "episode_return_min": -11.5, "env_to_module_sum_episodes_length_in": 10.36823839457432, "env_step_timer": 3.249630571796585e-05, "env_to_module_sum_episodes_length_out": 10.36823839457432, "weights_seq_no": 5.0, "num_episodes": 250.0, "num_agent_steps_sampled": {"default_agent": 5000.0}, "episode_return_max": 8.5, "time_between_sampling": 0.0033567197334166627, "num_module_steps_sampled": {"default_policy": 5000.0}, "agent_episode_returns_mean": {"default_agent": 0.58}, "num_env_steps_sampled_lifetime": -2460000.0, "num_agent_steps_sampled_lifetime": {"default_agent": -2460000.0}, "episode_len_mean": 20.0, "num_env_steps_sampled_lifetime_throughput": 2152.2049055515527}, "learners": {"default_policy": {"default_optimizer_learning_rate": 0.0002847858517, "curr_entropy_coeff": 0.0090570820258, "gradients_default_optimizer_global_norm": 0.08454997837543488, "policy_loss": -0.08983005583286285, "num_module_steps_trained_lifetime": 36000, "diff_num_grad_updates_vs_sampler_policy": 1.0, "mean_kl_loss": 0.001113722799345851, "weights_seq_no": 6.0, "curr_kl_coeff": 0.011664004996418953, "num_trainable_parameters": 6003, "num_module_steps_trained": 6000, "total_loss": -0.02719425968825817, "vf_explained_var": 0.003413856029510498, "module_train_batch_size_mean": 1000.0, "vf_loss": 0.10278083384037018, "entropy": 0.676906406879425, "vf_loss_unclipped": 27.926227569580078, "num_module_steps_trained_lifetime_throughput": 319559.21405696846}, "__all_modules__": {"num_module_steps_trained_lifetime": 36000, "learner_connector_sum_episodes_length_in": 5000.0, "learner_connector": {"timers": {"connectors": {"add_observations_from_episodes_to_batch": 0.0010541748291306157, "add_columns_from_episodes_to_train_batch": 0.046963839170810005, "numpy_to_tensor": 7.967232288281955e-05, "add_time_dim_to_batch_and_zero_pad": 1.4699625510051078e-05, "add_states_from_episodes_to_batch": 3.8075211423865056e-06, "general_advantage_estimation": 0.008765341022157773, "batch_individual_items": 0.052164408170382266, "add_one_ts_to_episodes_and_truncate": 0.013335963555337733}}, "connector_pipeline_timer": 0.12258183322267113}, "num_non_trainable_parameters": 0, "num_env_steps_trained_lifetime": 189000, "num_trainable_parameters": 6003, "num_module_steps_trained": 6000, "num_env_steps_trained": 31500, "learner_connector_sum_episodes_length_out": 5250.0, "num_env_steps_trained_lifetime_throughput": 1665075.1013603061, "num_module_steps_trained_throughput": 318862.83316957596, "num_module_steps_trained_lifetime_throughput": 318203.9785240299}}, "num_training_step_calls_per_iteration": 1, "evaluation": {"env_runners": {"env_to_module_connector": {"timers": {"connectors": {"numpy_to_tensor": 1.6289099739878096e-05, "add_time_dim_to_batch_and_zero_pad": 4.032910377120892e-06, "add_states_from_episodes_to_batch": 2.455634809853428e-06, "batch_individual_items": 1.0766142302914825e-05, "add_observations_from_episodes_to_batch": 4.3797921550580645e-06}}, "connector_pipeline_timer": 6.973168562358623e-05}, "num_env_steps_sampled": 400, "num_episodes": 20, "episode_duration_sec_mean": 0.009075468718074263, "num_agent_steps_sampled": {"default_agent": 400}, "module_to_env_connector": {"timers": {"connectors": {"un_batch_to_individual_items": 8.77651703134921e-06, "listify_data_for_vector_env": 1.827712305886446e-05, "remove_single_ts_time_rank_from_batch": 9.275954238644341e-07, "normalize_and_clip_actions": 1.4347504544636764e-05, "get_actions": 6.995741525458419e-05, "tensor_to_numpy": 2.3616238431864942e-05}}, "connector_pipeline_timer": 0.00017743090072412413}, "sample": 0.2484769845514419, "agent_episode_returns_mean": {"default_agent": 1.75}, "episode_return_min": -14.5, "env_step_timer": 2.353411763979036e-05, "env_to_module_sum_episodes_length_in": 10.368238394470474, "env_to_module_sum_episodes_length_out": 10.368238394470474, "weights_seq_no": 6.0, "episode_len_min": 20, "episode_len_max": 20, "num_agent_steps_sampled_lifetime": {"default_agent": 2400}, "num_episodes_lifetime": 120, "num_module_steps_sampled_lifetime": {"default_policy": 2400}, "episode_len_mean": 20.0, "env_reset_timer": 0.0007265561909400617, "episode_return_max": 14.5, "module_episode_returns_mean": {"default_policy": 1.75}, "num_env_steps_sampled_lifetime": 30400, "rlmodule_inference_timer": 4.93727787289715e-05, "num_module_steps_sampled": {"default_policy": 400}, "episode_return_mean": 1.75, "time_between_sampling": 2.787643498147444}, "num_healthy_workers": 1, "actor_manager_num_outstanding_async_reqs": 0, "num_remote_worker_restarts": 0}, "num_env_steps_sampled_lifetime": -2460000.0, "fault_tolerance": {"num_healthy_workers": 0, "num_remote_worker_restarts": 0}, "env_runner_group": {"actor_manager_num_outstanding_async_reqs": 0}, "done": false, "training_iteration": 6, "trial_id": "49f07_00000", "date": "2025-08-11_19-32-03", "timestamp": 1754933523, "time_this_iter_s": 3.507368803024292, "time_total_s": 21.710087060928345, "pid": 24465, "hostname": "Mac", "node_ip": "127.0.0.1", "config": {"exploration_config": {}, "extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "placement_strategy": "PACK", "num_gpus": 0, "_fake_gpus": false, "num_cpus_for_main_process": 2, "eager_tracing": true, "eager_max_retraces": 20, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "torch_compile_learner": false, "torch_compile_learner_what_to_compile": "forward_train", "torch_compile_learner_dynamo_backend": "aot_eager", "torch_compile_learner_dynamo_mode": null, "torch_compile_worker": false, "torch_compile_worker_dynamo_backend": "aot_eager", "torch_compile_worker_dynamo_mode": null, "torch_ddp_kwargs": {}, "torch_skip_nan_gradients": false, "env": "Umbrella", "env_config": {}, "observation_space": null, "action_space": null, "clip_rewards": null, "normalize_actions": true, "clip_actions": false, "_is_atari": null, "disable_env_checking": false, "render_env": false, "action_mask_key": "action_mask", "env_runner_cls": null, "num_env_runners": 0, "create_local_env_runner": true, "num_envs_per_env_runner": 1, "gym_env_vectorize_mode": "SYNC", "num_cpus_per_env_runner": 1, "num_gpus_per_env_runner": 0, "custom_resources_per_env_runner": {}, "validate_env_runners_after_construction": true, "episodes_to_numpy": true, "max_requests_in_flight_per_env_runner": 1, "sample_timeout_s": 60.0, "_env_to_module_connector": null, "add_default_connectors_to_env_to_module_pipeline": true, "_module_to_env_connector": null, "add_default_connectors_to_module_to_env_pipeline": true, "merge_env_runner_states": "training_only", "broadcast_env_runner_states": true, "episode_lookback_horizon": 1, "rollout_fragment_length": "auto", "batch_mode": "complete_episodes", "compress_observations": false, "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "enable_tf1_exec_eagerly": false, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "preprocessor_pref": "deepmind", "observation_filter": "NoFilter", "update_worker_filter_stats": true, "use_worker_filter_stats": true, "sampler_perf_stats_ema_coef": null, "_is_online": true, "num_learners": 0, "num_gpus_per_learner": 0, "num_cpus_per_learner": "auto", "num_aggregator_actors_per_learner": 0, "max_requests_in_flight_per_aggregator_actor": 3, "local_gpu_idx": 0, "max_requests_in_flight_per_learner": 3, "gamma": 1, "lr": 0.0002847858517, "grad_clip": 0.5, "grad_clip_by": "global_norm", "_train_batch_size_per_learner": 5000, "train_batch_size": 4000, "num_epochs": 1, "minibatch_size": 1000, "shuffle_batch_per_epoch": true, "model": {"fcnet_hiddens": [256, 256], "fcnet_activation": "tanh", "fcnet_weights_initializer": null, "fcnet_weights_initializer_config": null, "fcnet_bias_initializer": null, "fcnet_bias_initializer_config": null, "conv_filters": null, "conv_activation": "relu", "conv_kernel_initializer": null, "conv_kernel_initializer_config": null, "conv_bias_initializer": null, "conv_bias_initializer_config": null, "conv_transpose_kernel_initializer": null, "conv_transpose_kernel_initializer_config": null, "conv_transpose_bias_initializer": null, "conv_transpose_bias_initializer_config": null, "post_fcnet_hiddens": [], "post_fcnet_activation": "relu", "post_fcnet_weights_initializer": null, "post_fcnet_weights_initializer_config": null, "post_fcnet_bias_initializer": null, "post_fcnet_bias_initializer_config": null, "free_log_std": false, "log_std_clip_param": 20.0, "no_final_linear": false, "vf_share_layers": false, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "lstm_weights_initializer": null, "lstm_weights_initializer_config": null, "lstm_bias_initializer": null, "lstm_bias_initializer_config": null, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "attention_use_n_prev_actions": 0, "attention_use_n_prev_rewards": 0, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": null, "custom_model_config": {}, "custom_action_dist": null, "custom_preprocessor": null, "encoder_latent_dim": null, "always_check_shapes": false, "lstm_use_prev_action_reward": -1, "_use_default_native_models": -1, "_disable_preprocessor_api": false, "_disable_action_flattening": false}, "_learner_connector": null, "add_default_connectors_to_learner_pipeline": true, "learner_config_dict": {}, "optimizer": {}, "_learner_class": null, "callbacks_on_algorithm_init": null, "callbacks_on_env_runners_recreated": null, "callbacks_on_offline_eval_runners_recreated": null, "callbacks_on_checkpoint_loaded": null, "callbacks_on_environment_created": null, "callbacks_on_episode_created": null, "callbacks_on_episode_start": null, "callbacks_on_episode_step": null, "callbacks_on_episode_end": null, "callbacks_on_evaluate_start": null, "callbacks_on_evaluate_end": null, "callbacks_on_evaluate_offline_start": null, "callbacks_on_evaluate_offline_end": null, "callbacks_on_sample_end": null, "callbacks_on_train_result": null, "explore": true, "enable_rl_module_and_learner": true, "enable_env_runner_and_connector_v2": true, "_prior_exploration_config": {"type": "StochasticSampling"}, "count_steps_by": "env_steps", "policy_map_capacity": 100, "policy_mapping_fn": "<function AlgorithmConfig.DEFAULT_POLICY_MAPPING_FN at 0x388c81b20>", "policies_to_train": null, "policy_states_are_swappable": false, "observation_fn": null, "offline_data_class": null, "input_read_method": "read_parquet", "input_read_method_kwargs": {}, "input_read_schema": {}, "input_read_episodes": false, "input_read_sample_batches": false, "input_read_batch_size": null, "input_filesystem": null, "input_filesystem_kwargs": {}, "input_compress_columns": ["obs", "new_obs"], "input_spaces_jsonable": true, "materialize_data": false, "materialize_mapped_data": true, "map_batches_kwargs": {}, "iter_batches_kwargs": {}, "ignore_final_observation": false, "prelearner_class": null, "prelearner_buffer_class": null, "prelearner_buffer_kwargs": {}, "prelearner_module_synch_period": 10, "dataset_num_iters_per_learner": null, "input_config": {}, "actions_in_input_normalized": false, "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_config": {}, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "output_max_rows_per_file": null, "output_write_remaining_data": false, "output_write_method": "write_parquet", "output_write_method_kwargs": {}, "output_filesystem": null, "output_filesystem_kwargs": {}, "output_write_episodes": true, "offline_sampling": false, "evaluation_interval": 1, "evaluation_duration": 20, "evaluation_duration_unit": "episodes", "evaluation_sample_timeout_s": 120.0, "evaluation_auto_duration_min_env_steps_per_sample": 100, "evaluation_auto_duration_max_env_steps_per_sample": 2000, "evaluation_parallel_to_training": false, "evaluation_force_reset_envs_before_iteration": true, "evaluation_config": null, "off_policy_estimation_methods": {}, "ope_split_batch_by_episode": true, "evaluation_num_env_runners": 1, "in_evaluation": false, "sync_filters_on_rollout_workers_timeout_s": 10.0, "offline_evaluation_interval": null, "num_offline_eval_runners": 0, "offline_loss_for_module_fn": null, "offline_evaluation_duration": 1, "offline_evaluation_parallel_to_training": false, "offline_evaluation_timeout_s": 120.0, "num_cpus_per_offline_eval_runner": 1, "num_gpus_per_offline_eval_runner": 0, "custom_resources_per_offline_eval_runner": {}, "restart_failed_offline_eval_runners": true, "ignore_offline_eval_runner_failures": false, "max_num_offline_eval_runner_restarts": 1000, "offline_eval_runner_restore_timeout_s": 1800.0, "max_requests_in_flight_per_offline_eval_runner": 1, "validate_offline_eval_runners_after_construction": true, "offline_eval_runner_health_probe_timeout_s": 30.0, "offline_eval_rl_module_inference_only": false, "broadcast_offline_eval_runner_states": false, "offline_eval_batch_size_per_runner": 256, "dataset_num_iters_per_eval_runner": 1, "keep_per_episode_custom_metrics": false, "metrics_episode_collection_timeout_s": 60.0, "metrics_num_episodes_for_smoothing": 100, "min_time_s_per_iteration": null, "min_train_timesteps_per_iteration": 0, "min_sample_timesteps_per_iteration": 0, "log_gradients": true, "export_native_model_files": false, "checkpoint_trainable_policies_only": false, "logger_creator": null, "logger_config": null, "log_level": "WARN", "log_sys_usage": true, "fake_sampler": false, "seed": 8, "restart_failed_env_runners": true, "ignore_env_runner_failures": false, "max_num_env_runner_restarts": 1000, "delay_between_env_runner_restarts_s": 60.0, "restart_failed_sub_environments": false, "num_consecutive_env_runner_failures_tolerance": 100, "env_runner_health_probe_timeout_s": 30.0, "env_runner_restore_timeout_s": 1800.0, "_model_config": {}, "_rl_module_spec": "RLModuleSpec(module_class=None, observation_space=None, action_space=None, inference_only=False, learner_only=False, model_config=DefaultModelConfig(fcnet_hiddens=[60, 90], fcnet_activation='tanh', fcnet_kernel_initializer=None, fcnet_kernel_initializer_kwargs=None, fcnet_bias_initializer=None, fcnet_bias_initializer_kwargs=None, conv_filters=None, conv_activation='relu', conv_kernel_initializer=None, conv_kernel_initializer_kwargs=None, conv_bias_initializer=None, conv_bias_initializer_kwargs=None, head_fcnet_hiddens=[], head_fcnet_activation='relu', head_fcnet_kernel_initializer=None, head_fcnet_kernel_initializer_kwargs=None, head_fcnet_bias_initializer=None, head_fcnet_bias_initializer_kwargs=None, free_log_std=False, log_std_clip_param=20.0, vf_share_layers=True, use_lstm=False, max_seq_len=20, lstm_cell_size=256, lstm_use_prev_action=False, lstm_use_prev_reward=False, lstm_kernel_initializer=None, lstm_kernel_initializer_kwargs=None, lstm_bias_initializer=None, lstm_bias_initializer_kwargs=None), catalog_class=None, load_state_path=None, model_config_dict=None)", "algorithm_config_overrides_per_module": {}, "_per_module_overrides": {}, "_validate_config": true, "_use_msgpack_checkpoints": false, "_torch_grad_scaler_class": null, "_torch_lr_scheduler_classes": null, "_tf_policy_handles_more_than_one_loss": false, "_disable_preprocessor_api": false, "_disable_action_flattening": false, "_disable_initialize_loss_from_dummy_batch": false, "_dont_auto_sync_env_runner_states": false, "env_task_fn": -1, "enable_connectors": -1, "simple_optimizer": false, "policy_map_cache": -1, "worker_cls": -1, "synchronize_filters": -1, "enable_async_evaluation": -1, "custom_async_evaluation_function": -1, "_enable_rl_module_api": -1, "auto_wrap_old_gym_envs": -1, "always_attach_evaluation_results": -1, "replay_sequence_length": null, "_disable_execution_plan_api": -1, "use_critic": true, "use_gae": true, "use_kl_loss": true, "kl_coeff": 0.7464963036515, "kl_target": 0.0270990929592, "vf_loss_coeff": 0.6688075857018, "entropy_coeff": 0.0090570820258, "clip_param": 0.1221781641624, "vf_clip_param": 0.1027808522125, "entropy_coeff_schedule": null, "lr_schedule": null, "sgd_minibatch_size": -1, "vf_share_layers": -1, "__stdout_file__": null, "__stderr_file__": null, "lambda": 0.9099046732075, "input": "sampler", "policies": {"default_policy": [null, null, null, null]}, "callbacks": "<class 'ray.rllib.callbacks.callbacks.RLlibCallback'>", "create_env_on_driver": false, "custom_eval_function": null, "framework": "torch"}, "time_since_restore": 21.710087060928345, "iterations_since_restore": 6, "perf": {"cpu_util_percent": 70.44, "ram_util_percent": 81.64}}
{"timers": {"training_iteration": 4.798118676098247, "restore_env_runners": 1.3052633773335231e-05, "training_step": 4.7979078991950965, "env_runner_sampling_timer": 4.6257998215309595, "learner_update_timer": 0.16747335394046892, "synch_weights": 0.0010934844598320156, "restore_eval_env_runners": 6.45796427562998e-05, "evaluation_iteration": 0.26473639144711963, "synch_eval_env_connectors": 0.00043609084814699386, "synch_env_connectors": 5.842287203085562e-06}, "env_runners": {"episode_duration_sec_mean": 0.009442477023694665, "rlmodule_inference_timer": 6.36425363760646e-05, "env_to_module_connector": {"timers": {"connectors": {"numpy_to_tensor": 1.8440116741161917e-05, "add_observations_from_episodes_to_batch": 5.512398765541516e-06, "add_time_dim_to_batch_and_zero_pad": 4.431769094135477e-06, "batch_individual_items": 1.242407477458095e-05, "add_states_from_episodes_to_batch": 2.6721675118338527e-06}}, "connector_pipeline_timer": 7.974455598982055e-05}, "sample": 0.010017438937099825, "env_reset_timer": 8.838643294724968e-05, "module_episode_returns_mean": {"default_policy": 2.259999999999999}, "episode_len_min": 20, "episode_len_max": 20, "module_to_env_connector": {"timers": {"connectors": {"tensor_to_numpy": 2.7296159103931592e-05, "un_batch_to_individual_items": 9.580398218012539e-06, "remove_single_ts_time_rank_from_batch": 1.1517006383774793e-06, "listify_data_for_vector_env": 2.1672967342912636e-05, "normalize_and_clip_actions": 1.692060318445797e-05, "get_actions": 9.806437803189777e-05}}, "connector_pipeline_timer": 0.0002215426715867197}, "num_episodes_lifetime": -153875.0, "num_module_steps_sampled_lifetime": {"default_policy": -3077500.0}, "episode_return_mean": 2.259999999999999, "num_env_steps_sampled": 5000.0, "episode_return_min": -11.5, "env_to_module_sum_episodes_length_in": 10.36823839457432, "env_step_timer": 2.9405556716694375e-05, "env_to_module_sum_episodes_length_out": 10.36823839457432, "weights_seq_no": 6.0, "num_episodes": 250.0, "num_agent_steps_sampled": {"default_agent": 5000.0}, "episode_return_max": 8.5, "time_between_sampling": 0.003267961267072069, "num_module_steps_sampled": {"default_policy": 5000.0}, "agent_episode_returns_mean": {"default_agent": 2.259999999999999}, "num_env_steps_sampled_lifetime": -3077500.0, "num_agent_steps_sampled_lifetime": {"default_agent": -3077500.0}, "episode_len_mean": 20.0, "num_env_steps_sampled_lifetime_throughput": 2193.230817370856}, "learners": {"default_policy": {"default_optimizer_learning_rate": 0.0002847858517, "curr_entropy_coeff": 0.0090570820258, "gradients_default_optimizer_global_norm": 0.049868904054164886, "policy_loss": 0.03569741174578667, "num_module_steps_trained_lifetime": 42000, "diff_num_grad_updates_vs_sampler_policy": 1.0, "mean_kl_loss": 0.0023606023751199245, "weights_seq_no": 7.0, "curr_kl_coeff": 0.0058320024982094765, "num_trainable_parameters": 6003, "num_module_steps_trained": 6000, "total_loss": 0.09848138689994812, "vf_explained_var": 0.003434121608734131, "module_train_batch_size_mean": 1000.0, "vf_loss": 0.10278083384037018, "entropy": 0.66071617603302, "vf_loss_unclipped": 27.751880645751953, "num_module_steps_trained_lifetime_throughput": 313671.94087501476}, "__all_modules__": {"num_module_steps_trained_lifetime": 42000, "learner_connector_sum_episodes_length_in": 5000.0, "learner_connector": {"timers": {"connectors": {"add_observations_from_episodes_to_batch": 0.0010729422504614477, "add_columns_from_episodes_to_train_batch": 0.04702110577954455, "numpy_to_tensor": 7.96801901809596e-05, "add_time_dim_to_batch_and_zero_pad": 1.4710548967315241e-05, "add_states_from_episodes_to_batch": 3.815695410018045e-06, "general_advantage_estimation": 0.008781206771538198, "batch_individual_items": 0.05218982575948284, "add_one_ts_to_episodes_and_truncate": 0.0133615555899486}}, "connector_pipeline_timer": 0.12272460531032361}, "num_non_trainable_parameters": 0, "num_env_steps_trained_lifetime": 220500, "num_trainable_parameters": 6003, "num_module_steps_trained": 6000, "num_env_steps_trained": 31500, "learner_connector_sum_episodes_length_out": 5250.0, "num_env_steps_trained_lifetime_throughput": 1634782.3210046708, "num_module_steps_trained_throughput": 313017.1350574979, "num_module_steps_trained_lifetime_throughput": 312387.1934437984}}, "num_training_step_calls_per_iteration": 1, "evaluation": {"env_runners": {"env_to_module_connector": {"timers": {"connectors": {"numpy_to_tensor": 1.0655802065686549e-05, "add_time_dim_to_batch_and_zero_pad": 2.6015332129051947e-06, "add_states_from_episodes_to_batch": 2.2722517447763465e-06, "batch_individual_items": 7.92852392228998e-06, "add_observations_from_episodes_to_batch": 3.412631234732051e-06}}, "connector_pipeline_timer": 5.16787786779055e-05}, "num_env_steps_sampled": 400, "num_episodes": 20, "episode_duration_sec_mean": 0.008936528309714049, "num_agent_steps_sampled": {"default_agent": 400}, "module_to_env_connector": {"timers": {"connectors": {"un_batch_to_individual_items": 6.576176494745846e-06, "listify_data_for_vector_env": 1.332419915624321e-05, "remove_single_ts_time_rank_from_batch": 6.611696512547395e-07, "normalize_and_clip_actions": 1.185362207339219e-05, "get_actions": 4.8446633333213534e-05, "tensor_to_numpy": 1.661597209410834e-05}}, "connector_pipeline_timer": 0.0001278501373205876}, "sample": 0.24738218470536377, "agent_episode_returns_mean": {"default_agent": 1.95}, "episode_return_min": -14.5, "env_step_timer": 1.793258185834675e-05, "env_to_module_sum_episodes_length_in": 10.368238394572801, "env_to_module_sum_episodes_length_out": 10.368238394572801, "weights_seq_no": 7.0, "episode_len_min": 20, "episode_len_max": 20, "num_agent_steps_sampled_lifetime": {"default_agent": 2800}, "num_episodes_lifetime": 140, "num_module_steps_sampled_lifetime": {"default_policy": 2800}, "episode_len_mean": 20.0, "env_reset_timer": 0.0007202318783397686, "episode_return_max": 14.5, "module_episode_returns_mean": {"default_policy": 1.95}, "num_env_steps_sampled_lifetime": 35400, "rlmodule_inference_timer": 3.3863902541705364e-05, "num_module_steps_sampled": {"default_policy": 400}, "episode_return_mean": 1.95, "time_between_sampling": 2.7900908348361972}, "num_healthy_workers": 1, "actor_manager_num_outstanding_async_reqs": 0, "num_remote_worker_restarts": 0}, "num_env_steps_sampled_lifetime": -3077500.0, "fault_tolerance": {"num_healthy_workers": 0, "num_remote_worker_restarts": 0}, "env_runner_group": {"actor_manager_num_outstanding_async_reqs": 0}, "done": false, "training_iteration": 7, "trial_id": "49f07_00000", "date": "2025-08-11_19-32-07", "timestamp": 1754933527, "time_this_iter_s": 3.1438069343566895, "time_total_s": 24.853893995285034, "pid": 24465, "hostname": "Mac", "node_ip": "127.0.0.1", "config": {"exploration_config": {}, "extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "placement_strategy": "PACK", "num_gpus": 0, "_fake_gpus": false, "num_cpus_for_main_process": 2, "eager_tracing": true, "eager_max_retraces": 20, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "torch_compile_learner": false, "torch_compile_learner_what_to_compile": "forward_train", "torch_compile_learner_dynamo_backend": "aot_eager", "torch_compile_learner_dynamo_mode": null, "torch_compile_worker": false, "torch_compile_worker_dynamo_backend": "aot_eager", "torch_compile_worker_dynamo_mode": null, "torch_ddp_kwargs": {}, "torch_skip_nan_gradients": false, "env": "Umbrella", "env_config": {}, "observation_space": null, "action_space": null, "clip_rewards": null, "normalize_actions": true, "clip_actions": false, "_is_atari": null, "disable_env_checking": false, "render_env": false, "action_mask_key": "action_mask", "env_runner_cls": null, "num_env_runners": 0, "create_local_env_runner": true, "num_envs_per_env_runner": 1, "gym_env_vectorize_mode": "SYNC", "num_cpus_per_env_runner": 1, "num_gpus_per_env_runner": 0, "custom_resources_per_env_runner": {}, "validate_env_runners_after_construction": true, "episodes_to_numpy": true, "max_requests_in_flight_per_env_runner": 1, "sample_timeout_s": 60.0, "_env_to_module_connector": null, "add_default_connectors_to_env_to_module_pipeline": true, "_module_to_env_connector": null, "add_default_connectors_to_module_to_env_pipeline": true, "merge_env_runner_states": "training_only", "broadcast_env_runner_states": true, "episode_lookback_horizon": 1, "rollout_fragment_length": "auto", "batch_mode": "complete_episodes", "compress_observations": false, "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "enable_tf1_exec_eagerly": false, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "preprocessor_pref": "deepmind", "observation_filter": "NoFilter", "update_worker_filter_stats": true, "use_worker_filter_stats": true, "sampler_perf_stats_ema_coef": null, "_is_online": true, "num_learners": 0, "num_gpus_per_learner": 0, "num_cpus_per_learner": "auto", "num_aggregator_actors_per_learner": 0, "max_requests_in_flight_per_aggregator_actor": 3, "local_gpu_idx": 0, "max_requests_in_flight_per_learner": 3, "gamma": 1, "lr": 0.0002847858517, "grad_clip": 0.5, "grad_clip_by": "global_norm", "_train_batch_size_per_learner": 5000, "train_batch_size": 4000, "num_epochs": 1, "minibatch_size": 1000, "shuffle_batch_per_epoch": true, "model": {"fcnet_hiddens": [256, 256], "fcnet_activation": "tanh", "fcnet_weights_initializer": null, "fcnet_weights_initializer_config": null, "fcnet_bias_initializer": null, "fcnet_bias_initializer_config": null, "conv_filters": null, "conv_activation": "relu", "conv_kernel_initializer": null, "conv_kernel_initializer_config": null, "conv_bias_initializer": null, "conv_bias_initializer_config": null, "conv_transpose_kernel_initializer": null, "conv_transpose_kernel_initializer_config": null, "conv_transpose_bias_initializer": null, "conv_transpose_bias_initializer_config": null, "post_fcnet_hiddens": [], "post_fcnet_activation": "relu", "post_fcnet_weights_initializer": null, "post_fcnet_weights_initializer_config": null, "post_fcnet_bias_initializer": null, "post_fcnet_bias_initializer_config": null, "free_log_std": false, "log_std_clip_param": 20.0, "no_final_linear": false, "vf_share_layers": false, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "lstm_weights_initializer": null, "lstm_weights_initializer_config": null, "lstm_bias_initializer": null, "lstm_bias_initializer_config": null, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "attention_use_n_prev_actions": 0, "attention_use_n_prev_rewards": 0, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": null, "custom_model_config": {}, "custom_action_dist": null, "custom_preprocessor": null, "encoder_latent_dim": null, "always_check_shapes": false, "lstm_use_prev_action_reward": -1, "_use_default_native_models": -1, "_disable_preprocessor_api": false, "_disable_action_flattening": false}, "_learner_connector": null, "add_default_connectors_to_learner_pipeline": true, "learner_config_dict": {}, "optimizer": {}, "_learner_class": null, "callbacks_on_algorithm_init": null, "callbacks_on_env_runners_recreated": null, "callbacks_on_offline_eval_runners_recreated": null, "callbacks_on_checkpoint_loaded": null, "callbacks_on_environment_created": null, "callbacks_on_episode_created": null, "callbacks_on_episode_start": null, "callbacks_on_episode_step": null, "callbacks_on_episode_end": null, "callbacks_on_evaluate_start": null, "callbacks_on_evaluate_end": null, "callbacks_on_evaluate_offline_start": null, "callbacks_on_evaluate_offline_end": null, "callbacks_on_sample_end": null, "callbacks_on_train_result": null, "explore": true, "enable_rl_module_and_learner": true, "enable_env_runner_and_connector_v2": true, "_prior_exploration_config": {"type": "StochasticSampling"}, "count_steps_by": "env_steps", "policy_map_capacity": 100, "policy_mapping_fn": "<function AlgorithmConfig.DEFAULT_POLICY_MAPPING_FN at 0x388c81b20>", "policies_to_train": null, "policy_states_are_swappable": false, "observation_fn": null, "offline_data_class": null, "input_read_method": "read_parquet", "input_read_method_kwargs": {}, "input_read_schema": {}, "input_read_episodes": false, "input_read_sample_batches": false, "input_read_batch_size": null, "input_filesystem": null, "input_filesystem_kwargs": {}, "input_compress_columns": ["obs", "new_obs"], "input_spaces_jsonable": true, "materialize_data": false, "materialize_mapped_data": true, "map_batches_kwargs": {}, "iter_batches_kwargs": {}, "ignore_final_observation": false, "prelearner_class": null, "prelearner_buffer_class": null, "prelearner_buffer_kwargs": {}, "prelearner_module_synch_period": 10, "dataset_num_iters_per_learner": null, "input_config": {}, "actions_in_input_normalized": false, "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_config": {}, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "output_max_rows_per_file": null, "output_write_remaining_data": false, "output_write_method": "write_parquet", "output_write_method_kwargs": {}, "output_filesystem": null, "output_filesystem_kwargs": {}, "output_write_episodes": true, "offline_sampling": false, "evaluation_interval": 1, "evaluation_duration": 20, "evaluation_duration_unit": "episodes", "evaluation_sample_timeout_s": 120.0, "evaluation_auto_duration_min_env_steps_per_sample": 100, "evaluation_auto_duration_max_env_steps_per_sample": 2000, "evaluation_parallel_to_training": false, "evaluation_force_reset_envs_before_iteration": true, "evaluation_config": null, "off_policy_estimation_methods": {}, "ope_split_batch_by_episode": true, "evaluation_num_env_runners": 1, "in_evaluation": false, "sync_filters_on_rollout_workers_timeout_s": 10.0, "offline_evaluation_interval": null, "num_offline_eval_runners": 0, "offline_loss_for_module_fn": null, "offline_evaluation_duration": 1, "offline_evaluation_parallel_to_training": false, "offline_evaluation_timeout_s": 120.0, "num_cpus_per_offline_eval_runner": 1, "num_gpus_per_offline_eval_runner": 0, "custom_resources_per_offline_eval_runner": {}, "restart_failed_offline_eval_runners": true, "ignore_offline_eval_runner_failures": false, "max_num_offline_eval_runner_restarts": 1000, "offline_eval_runner_restore_timeout_s": 1800.0, "max_requests_in_flight_per_offline_eval_runner": 1, "validate_offline_eval_runners_after_construction": true, "offline_eval_runner_health_probe_timeout_s": 30.0, "offline_eval_rl_module_inference_only": false, "broadcast_offline_eval_runner_states": false, "offline_eval_batch_size_per_runner": 256, "dataset_num_iters_per_eval_runner": 1, "keep_per_episode_custom_metrics": false, "metrics_episode_collection_timeout_s": 60.0, "metrics_num_episodes_for_smoothing": 100, "min_time_s_per_iteration": null, "min_train_timesteps_per_iteration": 0, "min_sample_timesteps_per_iteration": 0, "log_gradients": true, "export_native_model_files": false, "checkpoint_trainable_policies_only": false, "logger_creator": null, "logger_config": null, "log_level": "WARN", "log_sys_usage": true, "fake_sampler": false, "seed": 8, "restart_failed_env_runners": true, "ignore_env_runner_failures": false, "max_num_env_runner_restarts": 1000, "delay_between_env_runner_restarts_s": 60.0, "restart_failed_sub_environments": false, "num_consecutive_env_runner_failures_tolerance": 100, "env_runner_health_probe_timeout_s": 30.0, "env_runner_restore_timeout_s": 1800.0, "_model_config": {}, "_rl_module_spec": "RLModuleSpec(module_class=None, observation_space=None, action_space=None, inference_only=False, learner_only=False, model_config=DefaultModelConfig(fcnet_hiddens=[60, 90], fcnet_activation='tanh', fcnet_kernel_initializer=None, fcnet_kernel_initializer_kwargs=None, fcnet_bias_initializer=None, fcnet_bias_initializer_kwargs=None, conv_filters=None, conv_activation='relu', conv_kernel_initializer=None, conv_kernel_initializer_kwargs=None, conv_bias_initializer=None, conv_bias_initializer_kwargs=None, head_fcnet_hiddens=[], head_fcnet_activation='relu', head_fcnet_kernel_initializer=None, head_fcnet_kernel_initializer_kwargs=None, head_fcnet_bias_initializer=None, head_fcnet_bias_initializer_kwargs=None, free_log_std=False, log_std_clip_param=20.0, vf_share_layers=True, use_lstm=False, max_seq_len=20, lstm_cell_size=256, lstm_use_prev_action=False, lstm_use_prev_reward=False, lstm_kernel_initializer=None, lstm_kernel_initializer_kwargs=None, lstm_bias_initializer=None, lstm_bias_initializer_kwargs=None), catalog_class=None, load_state_path=None, model_config_dict=None)", "algorithm_config_overrides_per_module": {}, "_per_module_overrides": {}, "_validate_config": true, "_use_msgpack_checkpoints": false, "_torch_grad_scaler_class": null, "_torch_lr_scheduler_classes": null, "_tf_policy_handles_more_than_one_loss": false, "_disable_preprocessor_api": false, "_disable_action_flattening": false, "_disable_initialize_loss_from_dummy_batch": false, "_dont_auto_sync_env_runner_states": false, "env_task_fn": -1, "enable_connectors": -1, "simple_optimizer": false, "policy_map_cache": -1, "worker_cls": -1, "synchronize_filters": -1, "enable_async_evaluation": -1, "custom_async_evaluation_function": -1, "_enable_rl_module_api": -1, "auto_wrap_old_gym_envs": -1, "always_attach_evaluation_results": -1, "replay_sequence_length": null, "_disable_execution_plan_api": -1, "use_critic": true, "use_gae": true, "use_kl_loss": true, "kl_coeff": 0.7464963036515, "kl_target": 0.0270990929592, "vf_loss_coeff": 0.6688075857018, "entropy_coeff": 0.0090570820258, "clip_param": 0.1221781641624, "vf_clip_param": 0.1027808522125, "entropy_coeff_schedule": null, "lr_schedule": null, "sgd_minibatch_size": -1, "vf_share_layers": -1, "__stdout_file__": null, "__stderr_file__": null, "lambda": 0.9099046732075, "input": "sampler", "policies": {"default_policy": [null, null, null, null]}, "callbacks": "<class 'ray.rllib.callbacks.callbacks.RLlibCallback'>", "create_env_on_driver": false, "custom_eval_function": null, "framework": "torch"}, "time_since_restore": 24.853893995285034, "iterations_since_restore": 7, "perf": {"cpu_util_percent": 85.46000000000001, "ram_util_percent": 81.44000000000001}}
{"timers": {"training_iteration": 4.782461358086928, "restore_env_runners": 1.2982528151783276e-05, "training_step": 4.7822504518740745, "env_runner_sampling_timer": 4.610414628725249, "learner_update_timer": 0.16720461374136833, "synch_weights": 0.0010902337855021715, "restore_eval_env_runners": 6.408176712910976e-05, "evaluation_iteration": 0.2635781771126596, "synch_eval_env_connectors": 0.0004363974396994986, "synch_env_connectors": 5.832204629290123e-06}, "env_runners": {"episode_duration_sec_mean": 0.010576229195576164, "rlmodule_inference_timer": 8.950092657520669e-05, "env_to_module_connector": {"timers": {"connectors": {"numpy_to_tensor": 2.6122947488656135e-05, "add_observations_from_episodes_to_batch": 5.928969771090949e-06, "add_time_dim_to_batch_and_zero_pad": 4.588641469780861e-06, "batch_individual_items": 1.3399403900224747e-05, "add_states_from_episodes_to_batch": 3.0490444401285586e-06}}, "connector_pipeline_timer": 9.040704982423437e-05}, "sample": 0.010792035439782596, "env_reset_timer": 9.089317468243365e-05, "module_episode_returns_mean": {"default_policy": 1.8600000000000003}, "episode_len_min": 20, "episode_len_max": 20, "module_to_env_connector": {"timers": {"connectors": {"tensor_to_numpy": 2.8566281823007812e-05, "un_batch_to_individual_items": 1.0725419809715975e-05, "remove_single_ts_time_rank_from_batch": 1.2957886290457422e-06, "listify_data_for_vector_env": 2.3207748070262755e-05, "normalize_and_clip_actions": 1.846751570818797e-05, "get_actions": 9.993289410175135e-05}}, "connector_pipeline_timer": 0.00023066989229016742}, "num_episodes_lifetime": -184750.0, "num_module_steps_sampled_lifetime": {"default_policy": -3695000.0}, "episode_return_mean": 1.8600000000000003, "num_env_steps_sampled": 5000.0, "episode_return_min": -11.5, "env_to_module_sum_episodes_length_in": 10.36823839457432, "env_step_timer": 3.135236485361513e-05, "env_to_module_sum_episodes_length_out": 10.36823839457432, "weights_seq_no": 7.0, "num_episodes": 250.0, "num_agent_steps_sampled": {"default_agent": 5000.0}, "episode_return_max": 8.5, "time_between_sampling": 0.00264082417761422, "num_module_steps_sampled": {"default_policy": 5000.0}, "agent_episode_returns_mean": {"default_agent": 1.8600000000000003}, "num_env_steps_sampled_lifetime": -3695000.0, "num_agent_steps_sampled_lifetime": {"default_agent": -3695000.0}, "episode_len_mean": 20.0, "num_env_steps_sampled_lifetime_throughput": 2179.1233962027013}, "learners": {"default_policy": {"default_optimizer_learning_rate": 0.0002847858517, "curr_entropy_coeff": 0.0090570820258, "gradients_default_optimizer_global_norm": 0.022608157247304916, "policy_loss": -0.15572355687618256, "num_module_steps_trained_lifetime": 48000, "diff_num_grad_updates_vs_sampler_policy": 1.0, "mean_kl_loss": 0.002607794012874365, "weights_seq_no": 8.0, "curr_kl_coeff": 0.0029160012491047382, "num_trainable_parameters": 6003, "num_module_steps_trained": 6000, "total_loss": -0.0927489772439003, "vf_explained_var": 0.002962470054626465, "module_train_batch_size_mean": 1000.0, "vf_loss": 0.10278083384037018, "entropy": 0.6383119821548462, "vf_loss_unclipped": 27.20172691345215, "num_module_steps_trained_lifetime_throughput": 309259.9619953919}, "__all_modules__": {"num_module_steps_trained_lifetime": 48000, "learner_connector_sum_episodes_length_in": 5000.0, "learner_connector": {"timers": {"connectors": {"add_observations_from_episodes_to_batch": 0.0010901657486023085, "add_columns_from_episodes_to_train_batch": 0.04703108555158866, "numpy_to_tensor": 8.020796879581618e-05, "add_time_dim_to_batch_and_zero_pad": 1.4945102961179167e-05, "add_states_from_episodes_to_batch": 3.836707707389623e-06, "general_advantage_estimation": 0.00876772137455144, "batch_individual_items": 0.052202931661789305, "add_one_ts_to_episodes_and_truncate": 0.013313973783443232}}, "connector_pipeline_timer": 0.12270449217761038}, "num_non_trainable_parameters": 0, "num_env_steps_trained_lifetime": 252000, "num_trainable_parameters": 6003, "num_module_steps_trained": 6000, "num_env_steps_trained": 31500, "learner_connector_sum_episodes_length_out": 5250.0, "num_env_steps_trained_lifetime_throughput": 1612368.264365176, "num_module_steps_trained_throughput": 308653.4603241577, "num_module_steps_trained_lifetime_throughput": 308056.7942603672}}, "num_training_step_calls_per_iteration": 1, "evaluation": {"env_runners": {"env_to_module_connector": {"timers": {"connectors": {"numpy_to_tensor": 1.2795590327699645e-05, "add_time_dim_to_batch_and_zero_pad": 2.9811907257255227e-06, "add_states_from_episodes_to_batch": 1.8989615674375389e-06, "batch_individual_items": 8.99415962358054e-06, "add_observations_from_episodes_to_batch": 3.492420716432474e-06}}, "connector_pipeline_timer": 5.570302336180557e-05}, "num_env_steps_sampled": 400, "num_episodes": 20, "episode_duration_sec_mean": 0.008736952060135082, "num_agent_steps_sampled": {"default_agent": 400}, "module_to_env_connector": {"timers": {"connectors": {"un_batch_to_individual_items": 6.60736150256958e-06, "listify_data_for_vector_env": 1.3988045681016557e-05, "remove_single_ts_time_rank_from_batch": 7.5718472269433e-07, "normalize_and_clip_actions": 1.1633369815286657e-05, "get_actions": 5.403080027553108e-05, "tensor_to_numpy": 1.828743119291129e-05}}, "connector_pipeline_timer": 0.00013751108327582655}, "sample": 0.24626822035837526, "agent_episode_returns_mean": {"default_agent": 1.35}, "episode_return_min": -14.5, "env_step_timer": 1.9546350465098066e-05, "env_to_module_sum_episodes_length_in": 10.3682383945743, "env_to_module_sum_episodes_length_out": 10.3682383945743, "weights_seq_no": 8.0, "episode_len_min": 20, "episode_len_max": 20, "num_agent_steps_sampled_lifetime": {"default_agent": 3200}, "num_episodes_lifetime": 160, "num_module_steps_sampled_lifetime": {"default_policy": 3200}, "episode_len_mean": 20.0, "env_reset_timer": 0.0007140062189139188, "episode_return_max": 14.5, "module_episode_returns_mean": {"default_policy": 1.35}, "num_env_steps_sampled_lifetime": 40400, "rlmodule_inference_timer": 3.986876731815996e-05, "num_module_steps_sampled": {"default_policy": 400}, "episode_return_mean": 1.35, "time_between_sampling": 2.7947770589871554}, "num_healthy_workers": 1, "actor_manager_num_outstanding_async_reqs": 0, "num_remote_worker_restarts": 0}, "num_env_steps_sampled_lifetime": -3695000.0, "fault_tolerance": {"num_healthy_workers": 0, "num_remote_worker_restarts": 0}, "env_runner_group": {"actor_manager_num_outstanding_async_reqs": 0}, "done": false, "training_iteration": 8, "trial_id": "49f07_00000", "date": "2025-08-11_19-32-10", "timestamp": 1754933530, "time_this_iter_s": 3.373495101928711, "time_total_s": 28.227389097213745, "pid": 24465, "hostname": "Mac", "node_ip": "127.0.0.1", "config": {"exploration_config": {}, "extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "placement_strategy": "PACK", "num_gpus": 0, "_fake_gpus": false, "num_cpus_for_main_process": 2, "eager_tracing": true, "eager_max_retraces": 20, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "torch_compile_learner": false, "torch_compile_learner_what_to_compile": "forward_train", "torch_compile_learner_dynamo_backend": "aot_eager", "torch_compile_learner_dynamo_mode": null, "torch_compile_worker": false, "torch_compile_worker_dynamo_backend": "aot_eager", "torch_compile_worker_dynamo_mode": null, "torch_ddp_kwargs": {}, "torch_skip_nan_gradients": false, "env": "Umbrella", "env_config": {}, "observation_space": null, "action_space": null, "clip_rewards": null, "normalize_actions": true, "clip_actions": false, "_is_atari": null, "disable_env_checking": false, "render_env": false, "action_mask_key": "action_mask", "env_runner_cls": null, "num_env_runners": 0, "create_local_env_runner": true, "num_envs_per_env_runner": 1, "gym_env_vectorize_mode": "SYNC", "num_cpus_per_env_runner": 1, "num_gpus_per_env_runner": 0, "custom_resources_per_env_runner": {}, "validate_env_runners_after_construction": true, "episodes_to_numpy": true, "max_requests_in_flight_per_env_runner": 1, "sample_timeout_s": 60.0, "_env_to_module_connector": null, "add_default_connectors_to_env_to_module_pipeline": true, "_module_to_env_connector": null, "add_default_connectors_to_module_to_env_pipeline": true, "merge_env_runner_states": "training_only", "broadcast_env_runner_states": true, "episode_lookback_horizon": 1, "rollout_fragment_length": "auto", "batch_mode": "complete_episodes", "compress_observations": false, "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "enable_tf1_exec_eagerly": false, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "preprocessor_pref": "deepmind", "observation_filter": "NoFilter", "update_worker_filter_stats": true, "use_worker_filter_stats": true, "sampler_perf_stats_ema_coef": null, "_is_online": true, "num_learners": 0, "num_gpus_per_learner": 0, "num_cpus_per_learner": "auto", "num_aggregator_actors_per_learner": 0, "max_requests_in_flight_per_aggregator_actor": 3, "local_gpu_idx": 0, "max_requests_in_flight_per_learner": 3, "gamma": 1, "lr": 0.0002847858517, "grad_clip": 0.5, "grad_clip_by": "global_norm", "_train_batch_size_per_learner": 5000, "train_batch_size": 4000, "num_epochs": 1, "minibatch_size": 1000, "shuffle_batch_per_epoch": true, "model": {"fcnet_hiddens": [256, 256], "fcnet_activation": "tanh", "fcnet_weights_initializer": null, "fcnet_weights_initializer_config": null, "fcnet_bias_initializer": null, "fcnet_bias_initializer_config": null, "conv_filters": null, "conv_activation": "relu", "conv_kernel_initializer": null, "conv_kernel_initializer_config": null, "conv_bias_initializer": null, "conv_bias_initializer_config": null, "conv_transpose_kernel_initializer": null, "conv_transpose_kernel_initializer_config": null, "conv_transpose_bias_initializer": null, "conv_transpose_bias_initializer_config": null, "post_fcnet_hiddens": [], "post_fcnet_activation": "relu", "post_fcnet_weights_initializer": null, "post_fcnet_weights_initializer_config": null, "post_fcnet_bias_initializer": null, "post_fcnet_bias_initializer_config": null, "free_log_std": false, "log_std_clip_param": 20.0, "no_final_linear": false, "vf_share_layers": false, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "lstm_weights_initializer": null, "lstm_weights_initializer_config": null, "lstm_bias_initializer": null, "lstm_bias_initializer_config": null, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "attention_use_n_prev_actions": 0, "attention_use_n_prev_rewards": 0, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": null, "custom_model_config": {}, "custom_action_dist": null, "custom_preprocessor": null, "encoder_latent_dim": null, "always_check_shapes": false, "lstm_use_prev_action_reward": -1, "_use_default_native_models": -1, "_disable_preprocessor_api": false, "_disable_action_flattening": false}, "_learner_connector": null, "add_default_connectors_to_learner_pipeline": true, "learner_config_dict": {}, "optimizer": {}, "_learner_class": null, "callbacks_on_algorithm_init": null, "callbacks_on_env_runners_recreated": null, "callbacks_on_offline_eval_runners_recreated": null, "callbacks_on_checkpoint_loaded": null, "callbacks_on_environment_created": null, "callbacks_on_episode_created": null, "callbacks_on_episode_start": null, "callbacks_on_episode_step": null, "callbacks_on_episode_end": null, "callbacks_on_evaluate_start": null, "callbacks_on_evaluate_end": null, "callbacks_on_evaluate_offline_start": null, "callbacks_on_evaluate_offline_end": null, "callbacks_on_sample_end": null, "callbacks_on_train_result": null, "explore": true, "enable_rl_module_and_learner": true, "enable_env_runner_and_connector_v2": true, "_prior_exploration_config": {"type": "StochasticSampling"}, "count_steps_by": "env_steps", "policy_map_capacity": 100, "policy_mapping_fn": "<function AlgorithmConfig.DEFAULT_POLICY_MAPPING_FN at 0x388c81b20>", "policies_to_train": null, "policy_states_are_swappable": false, "observation_fn": null, "offline_data_class": null, "input_read_method": "read_parquet", "input_read_method_kwargs": {}, "input_read_schema": {}, "input_read_episodes": false, "input_read_sample_batches": false, "input_read_batch_size": null, "input_filesystem": null, "input_filesystem_kwargs": {}, "input_compress_columns": ["obs", "new_obs"], "input_spaces_jsonable": true, "materialize_data": false, "materialize_mapped_data": true, "map_batches_kwargs": {}, "iter_batches_kwargs": {}, "ignore_final_observation": false, "prelearner_class": null, "prelearner_buffer_class": null, "prelearner_buffer_kwargs": {}, "prelearner_module_synch_period": 10, "dataset_num_iters_per_learner": null, "input_config": {}, "actions_in_input_normalized": false, "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_config": {}, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "output_max_rows_per_file": null, "output_write_remaining_data": false, "output_write_method": "write_parquet", "output_write_method_kwargs": {}, "output_filesystem": null, "output_filesystem_kwargs": {}, "output_write_episodes": true, "offline_sampling": false, "evaluation_interval": 1, "evaluation_duration": 20, "evaluation_duration_unit": "episodes", "evaluation_sample_timeout_s": 120.0, "evaluation_auto_duration_min_env_steps_per_sample": 100, "evaluation_auto_duration_max_env_steps_per_sample": 2000, "evaluation_parallel_to_training": false, "evaluation_force_reset_envs_before_iteration": true, "evaluation_config": null, "off_policy_estimation_methods": {}, "ope_split_batch_by_episode": true, "evaluation_num_env_runners": 1, "in_evaluation": false, "sync_filters_on_rollout_workers_timeout_s": 10.0, "offline_evaluation_interval": null, "num_offline_eval_runners": 0, "offline_loss_for_module_fn": null, "offline_evaluation_duration": 1, "offline_evaluation_parallel_to_training": false, "offline_evaluation_timeout_s": 120.0, "num_cpus_per_offline_eval_runner": 1, "num_gpus_per_offline_eval_runner": 0, "custom_resources_per_offline_eval_runner": {}, "restart_failed_offline_eval_runners": true, "ignore_offline_eval_runner_failures": false, "max_num_offline_eval_runner_restarts": 1000, "offline_eval_runner_restore_timeout_s": 1800.0, "max_requests_in_flight_per_offline_eval_runner": 1, "validate_offline_eval_runners_after_construction": true, "offline_eval_runner_health_probe_timeout_s": 30.0, "offline_eval_rl_module_inference_only": false, "broadcast_offline_eval_runner_states": false, "offline_eval_batch_size_per_runner": 256, "dataset_num_iters_per_eval_runner": 1, "keep_per_episode_custom_metrics": false, "metrics_episode_collection_timeout_s": 60.0, "metrics_num_episodes_for_smoothing": 100, "min_time_s_per_iteration": null, "min_train_timesteps_per_iteration": 0, "min_sample_timesteps_per_iteration": 0, "log_gradients": true, "export_native_model_files": false, "checkpoint_trainable_policies_only": false, "logger_creator": null, "logger_config": null, "log_level": "WARN", "log_sys_usage": true, "fake_sampler": false, "seed": 8, "restart_failed_env_runners": true, "ignore_env_runner_failures": false, "max_num_env_runner_restarts": 1000, "delay_between_env_runner_restarts_s": 60.0, "restart_failed_sub_environments": false, "num_consecutive_env_runner_failures_tolerance": 100, "env_runner_health_probe_timeout_s": 30.0, "env_runner_restore_timeout_s": 1800.0, "_model_config": {}, "_rl_module_spec": "RLModuleSpec(module_class=None, observation_space=None, action_space=None, inference_only=False, learner_only=False, model_config=DefaultModelConfig(fcnet_hiddens=[60, 90], fcnet_activation='tanh', fcnet_kernel_initializer=None, fcnet_kernel_initializer_kwargs=None, fcnet_bias_initializer=None, fcnet_bias_initializer_kwargs=None, conv_filters=None, conv_activation='relu', conv_kernel_initializer=None, conv_kernel_initializer_kwargs=None, conv_bias_initializer=None, conv_bias_initializer_kwargs=None, head_fcnet_hiddens=[], head_fcnet_activation='relu', head_fcnet_kernel_initializer=None, head_fcnet_kernel_initializer_kwargs=None, head_fcnet_bias_initializer=None, head_fcnet_bias_initializer_kwargs=None, free_log_std=False, log_std_clip_param=20.0, vf_share_layers=True, use_lstm=False, max_seq_len=20, lstm_cell_size=256, lstm_use_prev_action=False, lstm_use_prev_reward=False, lstm_kernel_initializer=None, lstm_kernel_initializer_kwargs=None, lstm_bias_initializer=None, lstm_bias_initializer_kwargs=None), catalog_class=None, load_state_path=None, model_config_dict=None)", "algorithm_config_overrides_per_module": {}, "_per_module_overrides": {}, "_validate_config": true, "_use_msgpack_checkpoints": false, "_torch_grad_scaler_class": null, "_torch_lr_scheduler_classes": null, "_tf_policy_handles_more_than_one_loss": false, "_disable_preprocessor_api": false, "_disable_action_flattening": false, "_disable_initialize_loss_from_dummy_batch": false, "_dont_auto_sync_env_runner_states": false, "env_task_fn": -1, "enable_connectors": -1, "simple_optimizer": false, "policy_map_cache": -1, "worker_cls": -1, "synchronize_filters": -1, "enable_async_evaluation": -1, "custom_async_evaluation_function": -1, "_enable_rl_module_api": -1, "auto_wrap_old_gym_envs": -1, "always_attach_evaluation_results": -1, "replay_sequence_length": null, "_disable_execution_plan_api": -1, "use_critic": true, "use_gae": true, "use_kl_loss": true, "kl_coeff": 0.7464963036515, "kl_target": 0.0270990929592, "vf_loss_coeff": 0.6688075857018, "entropy_coeff": 0.0090570820258, "clip_param": 0.1221781641624, "vf_clip_param": 0.1027808522125, "entropy_coeff_schedule": null, "lr_schedule": null, "sgd_minibatch_size": -1, "vf_share_layers": -1, "__stdout_file__": null, "__stderr_file__": null, "lambda": 0.9099046732075, "input": "sampler", "policies": {"default_policy": [null, null, null, null]}, "callbacks": "<class 'ray.rllib.callbacks.callbacks.RLlibCallback'>", "create_env_on_driver": false, "custom_eval_function": null, "framework": "torch"}, "time_since_restore": 28.227389097213745, "iterations_since_restore": 8, "perf": {"cpu_util_percent": 82.8, "ram_util_percent": 80.97999999999999}}
{"timers": {"training_iteration": 4.768326202005481, "restore_env_runners": 1.2917283105895718e-05, "training_step": 4.76811511943456, "env_runner_sampling_timer": 4.594392341597978, "learner_update_timer": 0.16907710552492514, "synch_weights": 0.0010903193671695992, "restore_eval_env_runners": 6.362928965792992e-05, "evaluation_iteration": 0.2623581620018899, "synch_eval_env_connectors": 0.00043390555522679434, "synch_env_connectors": 5.819722280119796e-06}, "env_runners": {"episode_duration_sec_mean": 0.010174659301992503, "rlmodule_inference_timer": 6.923901210766401e-05, "env_to_module_connector": {"timers": {"connectors": {"numpy_to_tensor": 2.079818170861962e-05, "add_observations_from_episodes_to_batch": 6.2673023388537185e-06, "add_time_dim_to_batch_and_zero_pad": 4.884117604251192e-06, "batch_individual_items": 1.4389719691108931e-05, "add_states_from_episodes_to_batch": 3.1069542424129323e-06}}, "connector_pipeline_timer": 8.767309597829706e-05}, "sample": 0.010691862680446208, "env_reset_timer": 9.308895703112835e-05, "module_episode_returns_mean": {"default_policy": 3.4599999999999995}, "episode_len_min": 20, "episode_len_max": 20, "module_to_env_connector": {"timers": {"connectors": {"tensor_to_numpy": 2.9726997314609443e-05, "un_batch_to_individual_items": 1.0367319180053823e-05, "remove_single_ts_time_rank_from_batch": 1.3158747565103847e-06, "listify_data_for_vector_env": 2.2143449514965738e-05, "normalize_and_clip_actions": 1.8517157197876277e-05, "get_actions": 0.00010533739718226121}}, "connector_pipeline_timer": 0.00023699563050549492}, "num_episodes_lifetime": -215625.0, "num_module_steps_sampled_lifetime": {"default_policy": -4312500.0}, "episode_return_mean": 3.4599999999999995, "num_env_steps_sampled": 5000.0, "episode_return_min": -11.5, "env_to_module_sum_episodes_length_in": 10.36823839457432, "env_step_timer": 3.1723761697668204e-05, "env_to_module_sum_episodes_length_out": 10.36823839457432, "weights_seq_no": 8.0, "num_episodes": 250.0, "num_agent_steps_sampled": {"default_agent": 5000.0}, "episode_return_max": 8.5, "time_between_sampling": 0.002378853572075777, "num_module_steps_sampled": {"default_policy": 5000.0}, "agent_episode_returns_mean": {"default_agent": 3.4599999999999995}, "num_env_steps_sampled_lifetime": -4312500.0, "num_agent_steps_sampled_lifetime": {"default_agent": -4312500.0}, "episode_len_mean": 20.0, "num_env_steps_sampled_lifetime_throughput": 2000.483017720178}, "learners": {"default_policy": {"default_optimizer_learning_rate": 0.0002847858517, "curr_entropy_coeff": 0.0090570820258, "gradients_default_optimizer_global_norm": 0.027868833392858505, "policy_loss": -0.11399688571691513, "num_module_steps_trained_lifetime": 54000, "diff_num_grad_updates_vs_sampler_policy": 1.0, "mean_kl_loss": 0.002018766012042761, "weights_seq_no": 9.0, "curr_kl_coeff": 0.0014580006245523691, "num_trainable_parameters": 6003, "num_module_steps_trained": 6000, "total_loss": -0.050800688564777374, "vf_explained_var": 0.002911388874053955, "module_train_batch_size_mean": 1000.0, "vf_loss": 0.10278083384037018, "entropy": 0.6128119826316833, "vf_loss_unclipped": 26.992969512939453, "num_module_steps_trained_lifetime_throughput": 305562.42599059554}, "__all_modules__": {"num_module_steps_trained_lifetime": 54000, "learner_connector_sum_episodes_length_in": 5000.0, "learner_connector": {"timers": {"connectors": {"add_observations_from_episodes_to_batch": 0.0010889507516034902, "add_columns_from_episodes_to_train_batch": 0.04727744636616131, "numpy_to_tensor": 8.098796867487319e-05, "add_time_dim_to_batch_and_zero_pad": 1.4925652921451512e-05, "add_states_from_episodes_to_batch": 3.832500378199404e-06, "general_advantage_estimation": 0.00875325333059235, "batch_individual_items": 0.052163966094441926, "add_one_ts_to_episodes_and_truncate": 0.015223216965071198}}, "connector_pipeline_timer": 0.12480645808632791}, "num_non_trainable_parameters": 0, "num_env_steps_trained_lifetime": 283500, "num_trainable_parameters": 6003, "num_module_steps_trained": 6000, "num_env_steps_trained": 31500, "learner_connector_sum_episodes_length_out": 5250.0, "num_env_steps_trained_lifetime_throughput": 1593647.4220763943, "num_module_steps_trained_throughput": 305002.5275434405, "num_module_steps_trained_lifetime_throughput": 304436.0274147559}}, "num_training_step_calls_per_iteration": 1, "evaluation": {"env_runners": {"env_to_module_connector": {"timers": {"connectors": {"numpy_to_tensor": 1.1954283342973058e-05, "add_time_dim_to_batch_and_zero_pad": 2.606751004443062e-06, "add_states_from_episodes_to_batch": 1.8551212580659117e-06, "batch_individual_items": 8.109802967770042e-06, "add_observations_from_episodes_to_batch": 3.597784339109664e-06}}, "connector_pipeline_timer": 5.286298402585528e-05}, "num_env_steps_sampled": 400, "num_episodes": 20, "episode_duration_sec_mean": 0.007731685838662088, "num_agent_steps_sampled": {"default_agent": 400}, "module_to_env_connector": {"timers": {"connectors": {"un_batch_to_individual_items": 6.252302631662269e-06, "listify_data_for_vector_env": 1.2593277957623499e-05, "remove_single_ts_time_rank_from_batch": 6.207760654027601e-07, "normalize_and_clip_actions": 1.0767435878426464e-05, "get_actions": 4.553606490293833e-05, "tensor_to_numpy": 1.564237959605399e-05}}, "connector_pipeline_timer": 0.00011966726198385996}, "sample": 0.2451264939954294, "agent_episode_returns_mean": {"default_agent": 1.75}, "episode_return_min": -14.5, "env_step_timer": 1.7149427764520286e-05, "env_to_module_sum_episodes_length_in": 10.368238394574323, "env_to_module_sum_episodes_length_out": 10.368238394574323, "weights_seq_no": 9.0, "episode_len_min": 20, "episode_len_max": 20, "num_agent_steps_sampled_lifetime": {"default_agent": 3600}, "num_episodes_lifetime": 180, "num_module_steps_sampled_lifetime": {"default_policy": 3600}, "episode_len_mean": 20.0, "env_reset_timer": 0.0007149649064014989, "episode_return_max": 14.5, "module_episode_returns_mean": {"default_policy": 1.75}, "num_env_steps_sampled_lifetime": 45400, "rlmodule_inference_timer": 3.509774841131474e-05, "num_module_steps_sampled": {"default_policy": 400}, "episode_return_mean": 1.75, "time_between_sampling": 2.800818024647023}, "num_healthy_workers": 1, "actor_manager_num_outstanding_async_reqs": 0, "num_remote_worker_restarts": 0}, "num_env_steps_sampled_lifetime": -4312500.0, "fault_tolerance": {"num_healthy_workers": 0, "num_remote_worker_restarts": 0}, "env_runner_group": {"actor_manager_num_outstanding_async_reqs": 0}, "done": false, "training_iteration": 9, "trial_id": "49f07_00000", "date": "2025-08-11_19-32-13", "timestamp": 1754933533, "time_this_iter_s": 3.518359899520874, "time_total_s": 31.74574899673462, "pid": 24465, "hostname": "Mac", "node_ip": "127.0.0.1", "config": {"exploration_config": {}, "extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "placement_strategy": "PACK", "num_gpus": 0, "_fake_gpus": false, "num_cpus_for_main_process": 2, "eager_tracing": true, "eager_max_retraces": 20, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "torch_compile_learner": false, "torch_compile_learner_what_to_compile": "forward_train", "torch_compile_learner_dynamo_backend": "aot_eager", "torch_compile_learner_dynamo_mode": null, "torch_compile_worker": false, "torch_compile_worker_dynamo_backend": "aot_eager", "torch_compile_worker_dynamo_mode": null, "torch_ddp_kwargs": {}, "torch_skip_nan_gradients": false, "env": "Umbrella", "env_config": {}, "observation_space": null, "action_space": null, "clip_rewards": null, "normalize_actions": true, "clip_actions": false, "_is_atari": null, "disable_env_checking": false, "render_env": false, "action_mask_key": "action_mask", "env_runner_cls": null, "num_env_runners": 0, "create_local_env_runner": true, "num_envs_per_env_runner": 1, "gym_env_vectorize_mode": "SYNC", "num_cpus_per_env_runner": 1, "num_gpus_per_env_runner": 0, "custom_resources_per_env_runner": {}, "validate_env_runners_after_construction": true, "episodes_to_numpy": true, "max_requests_in_flight_per_env_runner": 1, "sample_timeout_s": 60.0, "_env_to_module_connector": null, "add_default_connectors_to_env_to_module_pipeline": true, "_module_to_env_connector": null, "add_default_connectors_to_module_to_env_pipeline": true, "merge_env_runner_states": "training_only", "broadcast_env_runner_states": true, "episode_lookback_horizon": 1, "rollout_fragment_length": "auto", "batch_mode": "complete_episodes", "compress_observations": false, "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "enable_tf1_exec_eagerly": false, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "preprocessor_pref": "deepmind", "observation_filter": "NoFilter", "update_worker_filter_stats": true, "use_worker_filter_stats": true, "sampler_perf_stats_ema_coef": null, "_is_online": true, "num_learners": 0, "num_gpus_per_learner": 0, "num_cpus_per_learner": "auto", "num_aggregator_actors_per_learner": 0, "max_requests_in_flight_per_aggregator_actor": 3, "local_gpu_idx": 0, "max_requests_in_flight_per_learner": 3, "gamma": 1, "lr": 0.0002847858517, "grad_clip": 0.5, "grad_clip_by": "global_norm", "_train_batch_size_per_learner": 5000, "train_batch_size": 4000, "num_epochs": 1, "minibatch_size": 1000, "shuffle_batch_per_epoch": true, "model": {"fcnet_hiddens": [256, 256], "fcnet_activation": "tanh", "fcnet_weights_initializer": null, "fcnet_weights_initializer_config": null, "fcnet_bias_initializer": null, "fcnet_bias_initializer_config": null, "conv_filters": null, "conv_activation": "relu", "conv_kernel_initializer": null, "conv_kernel_initializer_config": null, "conv_bias_initializer": null, "conv_bias_initializer_config": null, "conv_transpose_kernel_initializer": null, "conv_transpose_kernel_initializer_config": null, "conv_transpose_bias_initializer": null, "conv_transpose_bias_initializer_config": null, "post_fcnet_hiddens": [], "post_fcnet_activation": "relu", "post_fcnet_weights_initializer": null, "post_fcnet_weights_initializer_config": null, "post_fcnet_bias_initializer": null, "post_fcnet_bias_initializer_config": null, "free_log_std": false, "log_std_clip_param": 20.0, "no_final_linear": false, "vf_share_layers": false, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "lstm_weights_initializer": null, "lstm_weights_initializer_config": null, "lstm_bias_initializer": null, "lstm_bias_initializer_config": null, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "attention_use_n_prev_actions": 0, "attention_use_n_prev_rewards": 0, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": null, "custom_model_config": {}, "custom_action_dist": null, "custom_preprocessor": null, "encoder_latent_dim": null, "always_check_shapes": false, "lstm_use_prev_action_reward": -1, "_use_default_native_models": -1, "_disable_preprocessor_api": false, "_disable_action_flattening": false}, "_learner_connector": null, "add_default_connectors_to_learner_pipeline": true, "learner_config_dict": {}, "optimizer": {}, "_learner_class": null, "callbacks_on_algorithm_init": null, "callbacks_on_env_runners_recreated": null, "callbacks_on_offline_eval_runners_recreated": null, "callbacks_on_checkpoint_loaded": null, "callbacks_on_environment_created": null, "callbacks_on_episode_created": null, "callbacks_on_episode_start": null, "callbacks_on_episode_step": null, "callbacks_on_episode_end": null, "callbacks_on_evaluate_start": null, "callbacks_on_evaluate_end": null, "callbacks_on_evaluate_offline_start": null, "callbacks_on_evaluate_offline_end": null, "callbacks_on_sample_end": null, "callbacks_on_train_result": null, "explore": true, "enable_rl_module_and_learner": true, "enable_env_runner_and_connector_v2": true, "_prior_exploration_config": {"type": "StochasticSampling"}, "count_steps_by": "env_steps", "policy_map_capacity": 100, "policy_mapping_fn": "<function AlgorithmConfig.DEFAULT_POLICY_MAPPING_FN at 0x388c81b20>", "policies_to_train": null, "policy_states_are_swappable": false, "observation_fn": null, "offline_data_class": null, "input_read_method": "read_parquet", "input_read_method_kwargs": {}, "input_read_schema": {}, "input_read_episodes": false, "input_read_sample_batches": false, "input_read_batch_size": null, "input_filesystem": null, "input_filesystem_kwargs": {}, "input_compress_columns": ["obs", "new_obs"], "input_spaces_jsonable": true, "materialize_data": false, "materialize_mapped_data": true, "map_batches_kwargs": {}, "iter_batches_kwargs": {}, "ignore_final_observation": false, "prelearner_class": null, "prelearner_buffer_class": null, "prelearner_buffer_kwargs": {}, "prelearner_module_synch_period": 10, "dataset_num_iters_per_learner": null, "input_config": {}, "actions_in_input_normalized": false, "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_config": {}, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "output_max_rows_per_file": null, "output_write_remaining_data": false, "output_write_method": "write_parquet", "output_write_method_kwargs": {}, "output_filesystem": null, "output_filesystem_kwargs": {}, "output_write_episodes": true, "offline_sampling": false, "evaluation_interval": 1, "evaluation_duration": 20, "evaluation_duration_unit": "episodes", "evaluation_sample_timeout_s": 120.0, "evaluation_auto_duration_min_env_steps_per_sample": 100, "evaluation_auto_duration_max_env_steps_per_sample": 2000, "evaluation_parallel_to_training": false, "evaluation_force_reset_envs_before_iteration": true, "evaluation_config": null, "off_policy_estimation_methods": {}, "ope_split_batch_by_episode": true, "evaluation_num_env_runners": 1, "in_evaluation": false, "sync_filters_on_rollout_workers_timeout_s": 10.0, "offline_evaluation_interval": null, "num_offline_eval_runners": 0, "offline_loss_for_module_fn": null, "offline_evaluation_duration": 1, "offline_evaluation_parallel_to_training": false, "offline_evaluation_timeout_s": 120.0, "num_cpus_per_offline_eval_runner": 1, "num_gpus_per_offline_eval_runner": 0, "custom_resources_per_offline_eval_runner": {}, "restart_failed_offline_eval_runners": true, "ignore_offline_eval_runner_failures": false, "max_num_offline_eval_runner_restarts": 1000, "offline_eval_runner_restore_timeout_s": 1800.0, "max_requests_in_flight_per_offline_eval_runner": 1, "validate_offline_eval_runners_after_construction": true, "offline_eval_runner_health_probe_timeout_s": 30.0, "offline_eval_rl_module_inference_only": false, "broadcast_offline_eval_runner_states": false, "offline_eval_batch_size_per_runner": 256, "dataset_num_iters_per_eval_runner": 1, "keep_per_episode_custom_metrics": false, "metrics_episode_collection_timeout_s": 60.0, "metrics_num_episodes_for_smoothing": 100, "min_time_s_per_iteration": null, "min_train_timesteps_per_iteration": 0, "min_sample_timesteps_per_iteration": 0, "log_gradients": true, "export_native_model_files": false, "checkpoint_trainable_policies_only": false, "logger_creator": null, "logger_config": null, "log_level": "WARN", "log_sys_usage": true, "fake_sampler": false, "seed": 8, "restart_failed_env_runners": true, "ignore_env_runner_failures": false, "max_num_env_runner_restarts": 1000, "delay_between_env_runner_restarts_s": 60.0, "restart_failed_sub_environments": false, "num_consecutive_env_runner_failures_tolerance": 100, "env_runner_health_probe_timeout_s": 30.0, "env_runner_restore_timeout_s": 1800.0, "_model_config": {}, "_rl_module_spec": "RLModuleSpec(module_class=None, observation_space=None, action_space=None, inference_only=False, learner_only=False, model_config=DefaultModelConfig(fcnet_hiddens=[60, 90], fcnet_activation='tanh', fcnet_kernel_initializer=None, fcnet_kernel_initializer_kwargs=None, fcnet_bias_initializer=None, fcnet_bias_initializer_kwargs=None, conv_filters=None, conv_activation='relu', conv_kernel_initializer=None, conv_kernel_initializer_kwargs=None, conv_bias_initializer=None, conv_bias_initializer_kwargs=None, head_fcnet_hiddens=[], head_fcnet_activation='relu', head_fcnet_kernel_initializer=None, head_fcnet_kernel_initializer_kwargs=None, head_fcnet_bias_initializer=None, head_fcnet_bias_initializer_kwargs=None, free_log_std=False, log_std_clip_param=20.0, vf_share_layers=True, use_lstm=False, max_seq_len=20, lstm_cell_size=256, lstm_use_prev_action=False, lstm_use_prev_reward=False, lstm_kernel_initializer=None, lstm_kernel_initializer_kwargs=None, lstm_bias_initializer=None, lstm_bias_initializer_kwargs=None), catalog_class=None, load_state_path=None, model_config_dict=None)", "algorithm_config_overrides_per_module": {}, "_per_module_overrides": {}, "_validate_config": true, "_use_msgpack_checkpoints": false, "_torch_grad_scaler_class": null, "_torch_lr_scheduler_classes": null, "_tf_policy_handles_more_than_one_loss": false, "_disable_preprocessor_api": false, "_disable_action_flattening": false, "_disable_initialize_loss_from_dummy_batch": false, "_dont_auto_sync_env_runner_states": false, "env_task_fn": -1, "enable_connectors": -1, "simple_optimizer": false, "policy_map_cache": -1, "worker_cls": -1, "synchronize_filters": -1, "enable_async_evaluation": -1, "custom_async_evaluation_function": -1, "_enable_rl_module_api": -1, "auto_wrap_old_gym_envs": -1, "always_attach_evaluation_results": -1, "replay_sequence_length": null, "_disable_execution_plan_api": -1, "use_critic": true, "use_gae": true, "use_kl_loss": true, "kl_coeff": 0.7464963036515, "kl_target": 0.0270990929592, "vf_loss_coeff": 0.6688075857018, "entropy_coeff": 0.0090570820258, "clip_param": 0.1221781641624, "vf_clip_param": 0.1027808522125, "entropy_coeff_schedule": null, "lr_schedule": null, "sgd_minibatch_size": -1, "vf_share_layers": -1, "__stdout_file__": null, "__stderr_file__": null, "lambda": 0.9099046732075, "input": "sampler", "policies": {"default_policy": [null, null, null, null]}, "callbacks": "<class 'ray.rllib.callbacks.callbacks.RLlibCallback'>", "create_env_on_driver": false, "custom_eval_function": null, "framework": "torch"}, "time_since_restore": 31.74574899673462, "iterations_since_restore": 9, "perf": {"cpu_util_percent": 84.44, "ram_util_percent": 81.2}}
{"timers": {"training_iteration": 4.754402442905283, "restore_env_runners": 1.2860610244810922e-05, "training_step": 4.754190918240748, "env_runner_sampling_timer": 4.57912101234184, "learner_update_timer": 0.17042995696993904, "synch_weights": 0.0010889707538175762, "restore_eval_env_runners": 6.313716666005432e-05, "evaluation_iteration": 0.2612181270519316, "synch_eval_env_connectors": 0.00043255899975991005, "synch_env_connectors": 5.809024836930423e-06}, "env_runners": {"episode_duration_sec_mean": 0.01042561882827431, "rlmodule_inference_timer": 6.852512828576302e-05, "env_to_module_connector": {"timers": {"connectors": {"numpy_to_tensor": 2.0522111585823726e-05, "add_observations_from_episodes_to_batch": 6.116131599732694e-06, "add_time_dim_to_batch_and_zero_pad": 4.72782513964444e-06, "batch_individual_items": 1.4353506089283975e-05, "add_states_from_episodes_to_batch": 2.918641041422206e-06}}, "connector_pipeline_timer": 8.741420700554281e-05}, "sample": 0.010992211778623046, "env_reset_timer": 9.021436106313738e-05, "module_episode_returns_mean": {"default_policy": 3.4599999999999995}, "episode_len_min": 20, "episode_len_max": 20, "module_to_env_connector": {"timers": {"connectors": {"tensor_to_numpy": 2.858104655272846e-05, "un_batch_to_individual_items": 1.0310181298852693e-05, "remove_single_ts_time_rank_from_batch": 1.0869685121912974e-06, "listify_data_for_vector_env": 2.5532272760517506e-05, "normalize_and_clip_actions": 1.8374498638077955e-05, "get_actions": 9.888864554542989e-05}}, "connector_pipeline_timer": 0.0002305500663352838}, "num_episodes_lifetime": -246500.0, "num_module_steps_sampled_lifetime": {"default_policy": -4930000.0}, "episode_return_mean": 3.4599999999999995, "num_env_steps_sampled": 5000.0, "episode_return_min": -11.5, "env_to_module_sum_episodes_length_in": 10.36823839457432, "env_step_timer": 3.0354094925750214e-05, "env_to_module_sum_episodes_length_out": 10.36823839457432, "weights_seq_no": 9.0, "num_episodes": 250.0, "num_agent_steps_sampled": {"default_agent": 5000.0}, "episode_return_max": 8.5, "time_between_sampling": 0.0031890621292966735, "num_module_steps_sampled": {"default_policy": 5000.0}, "agent_episode_returns_mean": {"default_agent": 3.4599999999999995}, "num_env_steps_sampled_lifetime": -4930000.0, "num_agent_steps_sampled_lifetime": {"default_agent": -4930000.0}, "episode_len_mean": 20.0, "num_env_steps_sampled_lifetime_throughput": 2107.490150465122}, "learners": {"default_policy": {"default_optimizer_learning_rate": 0.0002847858517, "curr_entropy_coeff": 0.0090570820258, "gradients_default_optimizer_global_norm": 0.09449653327465057, "policy_loss": -0.2596895098686218, "num_module_steps_trained_lifetime": 60000, "diff_num_grad_updates_vs_sampler_policy": 1.0, "mean_kl_loss": 0.0023036045022308826, "weights_seq_no": 10.0, "curr_kl_coeff": 0.0007290003122761846, "num_trainable_parameters": 6003, "num_module_steps_trained": 6000, "total_loss": -0.19621355831623077, "vf_explained_var": 0.002871870994567871, "module_train_batch_size_mean": 1000.0, "vf_loss": 0.10278083384037018, "entropy": 0.581646203994751, "vf_loss_unclipped": 26.41408920288086, "num_module_steps_trained_lifetime_throughput": 301393.5611750233}, "__all_modules__": {"num_module_steps_trained_lifetime": 60000, "learner_connector_sum_episodes_length_in": 5000.0, "learner_connector": {"timers": {"connectors": {"add_observations_from_episodes_to_batch": 0.0010977445732431239, "add_columns_from_episodes_to_train_batch": 0.047545477742386585, "numpy_to_tensor": 8.100142820267292e-05, "add_time_dim_to_batch_and_zero_pad": 1.4912646556596806e-05, "add_states_from_episodes_to_batch": 3.8358450747121425e-06, "general_advantage_estimation": 0.008735104546791932, "batch_individual_items": 0.053438663513219936, "add_one_ts_to_episodes_and_truncate": 0.015196485625310856}}, "connector_pipeline_timer": 0.1263128376757422}, "num_non_trainable_parameters": 0, "num_env_steps_trained_lifetime": 315000, "num_trainable_parameters": 6003, "num_module_steps_trained": 6000, "num_env_steps_trained": 31500, "learner_connector_sum_episodes_length_out": 5250.0, "num_env_steps_trained_lifetime_throughput": 1572398.2361739983, "num_module_steps_trained_throughput": 300876.38870876475, "num_module_steps_trained_lifetime_throughput": 300338.2808341746}}, "num_training_step_calls_per_iteration": 1, "evaluation": {"env_runners": {"env_to_module_connector": {"timers": {"connectors": {"numpy_to_tensor": 1.0992711365929178e-05, "add_time_dim_to_batch_and_zero_pad": 2.7684734441084554e-06, "add_states_from_episodes_to_batch": 1.8951797349931746e-06, "batch_individual_items": 8.08495611207522e-06, "add_observations_from_episodes_to_batch": 3.6946705009871048e-06}}, "connector_pipeline_timer": 5.360736660935775e-05}, "num_env_steps_sampled": 400, "num_episodes": 20, "episode_duration_sec_mean": 0.00688368126633577, "num_agent_steps_sampled": {"default_agent": 400}, "module_to_env_connector": {"timers": {"connectors": {"un_batch_to_individual_items": 7.394046919797347e-06, "listify_data_for_vector_env": 1.3481129388715306e-05, "remove_single_ts_time_rank_from_batch": 7.126189307511794e-07, "normalize_and_clip_actions": 1.1760877313418292e-05, "get_actions": 5.315896294698958e-05, "tensor_to_numpy": 1.7210066058691374e-05}}, "connector_pipeline_timer": 0.0001346325761136505}, "sample": 0.24428876072461125, "agent_episode_returns_mean": {"default_agent": 1.95}, "episode_return_min": -14.5, "env_step_timer": 1.774114892208412e-05, "env_to_module_sum_episodes_length_in": 10.368238394574323, "env_to_module_sum_episodes_length_out": 10.368238394574323, "weights_seq_no": 10.0, "episode_len_min": 20, "episode_len_max": 20, "num_agent_steps_sampled_lifetime": {"default_agent": 4000}, "num_episodes_lifetime": 200, "num_module_steps_sampled_lifetime": {"default_policy": 4000}, "episode_len_mean": 20.0, "env_reset_timer": 0.0007085852573798777, "episode_return_max": 14.5, "module_episode_returns_mean": {"default_policy": 1.95}, "num_env_steps_sampled_lifetime": 50400, "rlmodule_inference_timer": 3.853402060659918e-05, "num_module_steps_sampled": {"default_policy": 400}, "episode_return_mean": 1.95, "time_between_sampling": 2.806891951490478}, "num_healthy_workers": 1, "actor_manager_num_outstanding_async_reqs": 0, "num_remote_worker_restarts": 0}, "num_env_steps_sampled_lifetime": -4930000.0, "fault_tolerance": {"num_healthy_workers": 0, "num_remote_worker_restarts": 0}, "env_runner_group": {"actor_manager_num_outstanding_async_reqs": 0}, "done": false, "training_iteration": 10, "trial_id": "49f07_00000", "date": "2025-08-11_19-32-17", "timestamp": 1754933537, "time_this_iter_s": 3.5458028316497803, "time_total_s": 35.2915518283844, "pid": 24465, "hostname": "Mac", "node_ip": "127.0.0.1", "config": {"exploration_config": {}, "extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "placement_strategy": "PACK", "num_gpus": 0, "_fake_gpus": false, "num_cpus_for_main_process": 2, "eager_tracing": true, "eager_max_retraces": 20, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "torch_compile_learner": false, "torch_compile_learner_what_to_compile": "forward_train", "torch_compile_learner_dynamo_backend": "aot_eager", "torch_compile_learner_dynamo_mode": null, "torch_compile_worker": false, "torch_compile_worker_dynamo_backend": "aot_eager", "torch_compile_worker_dynamo_mode": null, "torch_ddp_kwargs": {}, "torch_skip_nan_gradients": false, "env": "Umbrella", "env_config": {}, "observation_space": null, "action_space": null, "clip_rewards": null, "normalize_actions": true, "clip_actions": false, "_is_atari": null, "disable_env_checking": false, "render_env": false, "action_mask_key": "action_mask", "env_runner_cls": null, "num_env_runners": 0, "create_local_env_runner": true, "num_envs_per_env_runner": 1, "gym_env_vectorize_mode": "SYNC", "num_cpus_per_env_runner": 1, "num_gpus_per_env_runner": 0, "custom_resources_per_env_runner": {}, "validate_env_runners_after_construction": true, "episodes_to_numpy": true, "max_requests_in_flight_per_env_runner": 1, "sample_timeout_s": 60.0, "_env_to_module_connector": null, "add_default_connectors_to_env_to_module_pipeline": true, "_module_to_env_connector": null, "add_default_connectors_to_module_to_env_pipeline": true, "merge_env_runner_states": "training_only", "broadcast_env_runner_states": true, "episode_lookback_horizon": 1, "rollout_fragment_length": "auto", "batch_mode": "complete_episodes", "compress_observations": false, "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "enable_tf1_exec_eagerly": false, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "preprocessor_pref": "deepmind", "observation_filter": "NoFilter", "update_worker_filter_stats": true, "use_worker_filter_stats": true, "sampler_perf_stats_ema_coef": null, "_is_online": true, "num_learners": 0, "num_gpus_per_learner": 0, "num_cpus_per_learner": "auto", "num_aggregator_actors_per_learner": 0, "max_requests_in_flight_per_aggregator_actor": 3, "local_gpu_idx": 0, "max_requests_in_flight_per_learner": 3, "gamma": 1, "lr": 0.0002847858517, "grad_clip": 0.5, "grad_clip_by": "global_norm", "_train_batch_size_per_learner": 5000, "train_batch_size": 4000, "num_epochs": 1, "minibatch_size": 1000, "shuffle_batch_per_epoch": true, "model": {"fcnet_hiddens": [256, 256], "fcnet_activation": "tanh", "fcnet_weights_initializer": null, "fcnet_weights_initializer_config": null, "fcnet_bias_initializer": null, "fcnet_bias_initializer_config": null, "conv_filters": null, "conv_activation": "relu", "conv_kernel_initializer": null, "conv_kernel_initializer_config": null, "conv_bias_initializer": null, "conv_bias_initializer_config": null, "conv_transpose_kernel_initializer": null, "conv_transpose_kernel_initializer_config": null, "conv_transpose_bias_initializer": null, "conv_transpose_bias_initializer_config": null, "post_fcnet_hiddens": [], "post_fcnet_activation": "relu", "post_fcnet_weights_initializer": null, "post_fcnet_weights_initializer_config": null, "post_fcnet_bias_initializer": null, "post_fcnet_bias_initializer_config": null, "free_log_std": false, "log_std_clip_param": 20.0, "no_final_linear": false, "vf_share_layers": false, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "lstm_weights_initializer": null, "lstm_weights_initializer_config": null, "lstm_bias_initializer": null, "lstm_bias_initializer_config": null, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "attention_use_n_prev_actions": 0, "attention_use_n_prev_rewards": 0, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": null, "custom_model_config": {}, "custom_action_dist": null, "custom_preprocessor": null, "encoder_latent_dim": null, "always_check_shapes": false, "lstm_use_prev_action_reward": -1, "_use_default_native_models": -1, "_disable_preprocessor_api": false, "_disable_action_flattening": false}, "_learner_connector": null, "add_default_connectors_to_learner_pipeline": true, "learner_config_dict": {}, "optimizer": {}, "_learner_class": null, "callbacks_on_algorithm_init": null, "callbacks_on_env_runners_recreated": null, "callbacks_on_offline_eval_runners_recreated": null, "callbacks_on_checkpoint_loaded": null, "callbacks_on_environment_created": null, "callbacks_on_episode_created": null, "callbacks_on_episode_start": null, "callbacks_on_episode_step": null, "callbacks_on_episode_end": null, "callbacks_on_evaluate_start": null, "callbacks_on_evaluate_end": null, "callbacks_on_evaluate_offline_start": null, "callbacks_on_evaluate_offline_end": null, "callbacks_on_sample_end": null, "callbacks_on_train_result": null, "explore": true, "enable_rl_module_and_learner": true, "enable_env_runner_and_connector_v2": true, "_prior_exploration_config": {"type": "StochasticSampling"}, "count_steps_by": "env_steps", "policy_map_capacity": 100, "policy_mapping_fn": "<function AlgorithmConfig.DEFAULT_POLICY_MAPPING_FN at 0x388c81b20>", "policies_to_train": null, "policy_states_are_swappable": false, "observation_fn": null, "offline_data_class": null, "input_read_method": "read_parquet", "input_read_method_kwargs": {}, "input_read_schema": {}, "input_read_episodes": false, "input_read_sample_batches": false, "input_read_batch_size": null, "input_filesystem": null, "input_filesystem_kwargs": {}, "input_compress_columns": ["obs", "new_obs"], "input_spaces_jsonable": true, "materialize_data": false, "materialize_mapped_data": true, "map_batches_kwargs": {}, "iter_batches_kwargs": {}, "ignore_final_observation": false, "prelearner_class": null, "prelearner_buffer_class": null, "prelearner_buffer_kwargs": {}, "prelearner_module_synch_period": 10, "dataset_num_iters_per_learner": null, "input_config": {}, "actions_in_input_normalized": false, "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_config": {}, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "output_max_rows_per_file": null, "output_write_remaining_data": false, "output_write_method": "write_parquet", "output_write_method_kwargs": {}, "output_filesystem": null, "output_filesystem_kwargs": {}, "output_write_episodes": true, "offline_sampling": false, "evaluation_interval": 1, "evaluation_duration": 20, "evaluation_duration_unit": "episodes", "evaluation_sample_timeout_s": 120.0, "evaluation_auto_duration_min_env_steps_per_sample": 100, "evaluation_auto_duration_max_env_steps_per_sample": 2000, "evaluation_parallel_to_training": false, "evaluation_force_reset_envs_before_iteration": true, "evaluation_config": null, "off_policy_estimation_methods": {}, "ope_split_batch_by_episode": true, "evaluation_num_env_runners": 1, "in_evaluation": false, "sync_filters_on_rollout_workers_timeout_s": 10.0, "offline_evaluation_interval": null, "num_offline_eval_runners": 0, "offline_loss_for_module_fn": null, "offline_evaluation_duration": 1, "offline_evaluation_parallel_to_training": false, "offline_evaluation_timeout_s": 120.0, "num_cpus_per_offline_eval_runner": 1, "num_gpus_per_offline_eval_runner": 0, "custom_resources_per_offline_eval_runner": {}, "restart_failed_offline_eval_runners": true, "ignore_offline_eval_runner_failures": false, "max_num_offline_eval_runner_restarts": 1000, "offline_eval_runner_restore_timeout_s": 1800.0, "max_requests_in_flight_per_offline_eval_runner": 1, "validate_offline_eval_runners_after_construction": true, "offline_eval_runner_health_probe_timeout_s": 30.0, "offline_eval_rl_module_inference_only": false, "broadcast_offline_eval_runner_states": false, "offline_eval_batch_size_per_runner": 256, "dataset_num_iters_per_eval_runner": 1, "keep_per_episode_custom_metrics": false, "metrics_episode_collection_timeout_s": 60.0, "metrics_num_episodes_for_smoothing": 100, "min_time_s_per_iteration": null, "min_train_timesteps_per_iteration": 0, "min_sample_timesteps_per_iteration": 0, "log_gradients": true, "export_native_model_files": false, "checkpoint_trainable_policies_only": false, "logger_creator": null, "logger_config": null, "log_level": "WARN", "log_sys_usage": true, "fake_sampler": false, "seed": 8, "restart_failed_env_runners": true, "ignore_env_runner_failures": false, "max_num_env_runner_restarts": 1000, "delay_between_env_runner_restarts_s": 60.0, "restart_failed_sub_environments": false, "num_consecutive_env_runner_failures_tolerance": 100, "env_runner_health_probe_timeout_s": 30.0, "env_runner_restore_timeout_s": 1800.0, "_model_config": {}, "_rl_module_spec": "RLModuleSpec(module_class=None, observation_space=None, action_space=None, inference_only=False, learner_only=False, model_config=DefaultModelConfig(fcnet_hiddens=[60, 90], fcnet_activation='tanh', fcnet_kernel_initializer=None, fcnet_kernel_initializer_kwargs=None, fcnet_bias_initializer=None, fcnet_bias_initializer_kwargs=None, conv_filters=None, conv_activation='relu', conv_kernel_initializer=None, conv_kernel_initializer_kwargs=None, conv_bias_initializer=None, conv_bias_initializer_kwargs=None, head_fcnet_hiddens=[], head_fcnet_activation='relu', head_fcnet_kernel_initializer=None, head_fcnet_kernel_initializer_kwargs=None, head_fcnet_bias_initializer=None, head_fcnet_bias_initializer_kwargs=None, free_log_std=False, log_std_clip_param=20.0, vf_share_layers=True, use_lstm=False, max_seq_len=20, lstm_cell_size=256, lstm_use_prev_action=False, lstm_use_prev_reward=False, lstm_kernel_initializer=None, lstm_kernel_initializer_kwargs=None, lstm_bias_initializer=None, lstm_bias_initializer_kwargs=None), catalog_class=None, load_state_path=None, model_config_dict=None)", "algorithm_config_overrides_per_module": {}, "_per_module_overrides": {}, "_validate_config": true, "_use_msgpack_checkpoints": false, "_torch_grad_scaler_class": null, "_torch_lr_scheduler_classes": null, "_tf_policy_handles_more_than_one_loss": false, "_disable_preprocessor_api": false, "_disable_action_flattening": false, "_disable_initialize_loss_from_dummy_batch": false, "_dont_auto_sync_env_runner_states": false, "env_task_fn": -1, "enable_connectors": -1, "simple_optimizer": false, "policy_map_cache": -1, "worker_cls": -1, "synchronize_filters": -1, "enable_async_evaluation": -1, "custom_async_evaluation_function": -1, "_enable_rl_module_api": -1, "auto_wrap_old_gym_envs": -1, "always_attach_evaluation_results": -1, "replay_sequence_length": null, "_disable_execution_plan_api": -1, "use_critic": true, "use_gae": true, "use_kl_loss": true, "kl_coeff": 0.7464963036515, "kl_target": 0.0270990929592, "vf_loss_coeff": 0.6688075857018, "entropy_coeff": 0.0090570820258, "clip_param": 0.1221781641624, "vf_clip_param": 0.1027808522125, "entropy_coeff_schedule": null, "lr_schedule": null, "sgd_minibatch_size": -1, "vf_share_layers": -1, "__stdout_file__": null, "__stderr_file__": null, "lambda": 0.9099046732075, "input": "sampler", "policies": {"default_policy": [null, null, null, null]}, "callbacks": "<class 'ray.rllib.callbacks.callbacks.RLlibCallback'>", "create_env_on_driver": false, "custom_eval_function": null, "framework": "torch"}, "time_since_restore": 35.2915518283844, "iterations_since_restore": 10, "perf": {"cpu_util_percent": 83.68, "ram_util_percent": 81.2}}
{"timers": {"training_iteration": 4.741752735556264, "restore_env_runners": 1.2799505238417725e-05, "training_step": 4.741535966138211, "env_runner_sampling_timer": 4.565717479718213, "learner_update_timer": 0.17101662739997955, "synch_weights": 0.0011099652168824073, "restore_eval_env_runners": 6.258079440038755e-05, "evaluation_iteration": 0.2602975849521614, "synch_eval_env_connectors": 0.0004294759093280166, "synch_env_connectors": 5.830103992322744e-06}, "env_runners": {"episode_duration_sec_mean": 0.010807365030515943, "rlmodule_inference_timer": 7.179178697960264e-05, "env_to_module_connector": {"timers": {"connectors": {"numpy_to_tensor": 2.2239742031561615e-05, "add_observations_from_episodes_to_batch": 6.288551613295739e-06, "add_time_dim_to_batch_and_zero_pad": 4.725241028611512e-06, "batch_individual_items": 1.4186511299238636e-05, "add_states_from_episodes_to_batch": 3.189898757982517e-06}}, "connector_pipeline_timer": 9.066373775255094e-05}, "sample": 0.010987475246784525, "env_reset_timer": 9.087966175110145e-05, "module_episode_returns_mean": {"default_policy": 4.82}, "episode_len_min": 20, "episode_len_max": 20, "module_to_env_connector": {"timers": {"connectors": {"tensor_to_numpy": 3.023719037200055e-05, "un_batch_to_individual_items": 1.1532583599826934e-05, "remove_single_ts_time_rank_from_batch": 1.1917247355314225e-06, "listify_data_for_vector_env": 2.4019822530641174e-05, "normalize_and_clip_actions": 1.917897455769881e-05, "get_actions": 0.00011006283943633434}}, "connector_pipeline_timer": 0.00024992374901213187}, "num_episodes_lifetime": -277375.0, "num_module_steps_sampled_lifetime": {"default_policy": -5547500.0}, "episode_return_mean": 4.82, "num_env_steps_sampled": 5000.0, "episode_return_min": -11.5, "env_to_module_sum_episodes_length_in": 10.36823839457432, "env_step_timer": 3.381476983134512e-05, "env_to_module_sum_episodes_length_out": 10.36823839457432, "weights_seq_no": 10.0, "num_episodes": 250.0, "num_agent_steps_sampled": {"default_agent": 5000.0}, "episode_return_max": 8.5, "time_between_sampling": 0.0031976760284352095, "num_module_steps_sampled": {"default_policy": 5000.0}, "agent_episode_returns_mean": {"default_agent": 4.82}, "num_env_steps_sampled_lifetime": -5547500.0, "num_agent_steps_sampled_lifetime": {"default_agent": -5547500.0}, "episode_len_mean": 20.0, "num_env_steps_sampled_lifetime_throughput": 2007.9517407588103}, "learners": {"default_policy": {"default_optimizer_learning_rate": 0.0002847858517, "curr_entropy_coeff": 0.0090570820258, "gradients_default_optimizer_global_norm": 0.13445432484149933, "policy_loss": -0.054561760276556015, "num_module_steps_trained_lifetime": 66000, "diff_num_grad_updates_vs_sampler_policy": 1.0, "mean_kl_loss": 0.001672356273047626, "weights_seq_no": 11.0, "curr_kl_coeff": 0.0003645001561380923, "num_trainable_parameters": 6003, "num_module_steps_trained": 6000, "total_loss": 0.00922297965735197, "vf_explained_var": 0.0033788084983825684, "module_train_batch_size_mean": 1000.0, "vf_loss": 0.10278083384037018, "entropy": 0.5473174452781677, "vf_loss_unclipped": 26.720659255981445, "num_module_steps_trained_lifetime_throughput": 295676.77861160116}, "__all_modules__": {"num_module_steps_trained_lifetime": 66000, "learner_connector_sum_episodes_length_in": 5000.0, "learner_connector": {"timers": {"connectors": {"add_observations_from_episodes_to_batch": 0.0011010221277890462, "add_columns_from_episodes_to_train_batch": 0.04776691004435621, "numpy_to_tensor": 8.090808410411108e-05, "add_time_dim_to_batch_and_zero_pad": 1.9281850188229324e-05, "add_states_from_episodes_to_batch": 3.863326473377462e-06, "general_advantage_estimation": 0.008869739751577408, "batch_individual_items": 0.05342120687824576, "add_one_ts_to_episodes_and_truncate": 0.01517826826942521}}, "connector_pipeline_timer": 0.1266406697182559}, "num_non_trainable_parameters": 0, "num_env_steps_trained_lifetime": 346500, "num_trainable_parameters": 6003, "num_module_steps_trained": 6000, "num_env_steps_trained": 31500, "learner_connector_sum_episodes_length_out": 5250.0, "num_env_steps_trained_lifetime_throughput": 1542987.4487361968, "num_module_steps_trained_throughput": 295198.78835362615, "num_module_steps_trained_lifetime_throughput": 294688.9252696803}}, "num_training_step_calls_per_iteration": 1, "evaluation": {"env_runners": {"env_to_module_connector": {"timers": {"connectors": {"numpy_to_tensor": 1.3705005600543548e-05, "add_time_dim_to_batch_and_zero_pad": 3.5161137012652506e-06, "add_states_from_episodes_to_batch": 2.172239051847845e-06, "batch_individual_items": 9.051988651188265e-06, "add_observations_from_episodes_to_batch": 3.935529385486822e-06}}, "connector_pipeline_timer": 6.204484804122072e-05}, "num_env_steps_sampled": 400, "num_episodes": 20, "episode_duration_sec_mean": 0.007259635407244787, "num_agent_steps_sampled": {"default_agent": 400}, "module_to_env_connector": {"timers": {"connectors": {"un_batch_to_individual_items": 8.348072264087877e-06, "listify_data_for_vector_env": 1.574932032868305e-05, "remove_single_ts_time_rank_from_batch": 7.455913809752823e-07, "normalize_and_clip_actions": 1.32156680216853e-05, "get_actions": 6.184115734220814e-05, "tensor_to_numpy": 1.9143391659241737e-05}}, "connector_pipeline_timer": 0.00015400182290411932}, "sample": 0.24410709853788112, "agent_episode_returns_mean": {"default_agent": 1.35}, "episode_return_min": -14.5, "env_step_timer": 2.206593347585549e-05, "env_to_module_sum_episodes_length_in": 10.368238394574323, "env_to_module_sum_episodes_length_out": 10.368238394574323, "weights_seq_no": 11.0, "episode_len_min": 20, "episode_len_max": 20, "num_agent_steps_sampled_lifetime": {"default_agent": 4400}, "num_episodes_lifetime": 220, "num_module_steps_sampled_lifetime": {"default_policy": 4400}, "episode_len_mean": 20.0, "env_reset_timer": 0.0007252385646117791, "episode_return_max": 14.5, "module_episode_returns_mean": {"default_policy": 1.35}, "num_env_steps_sampled_lifetime": 55400, "rlmodule_inference_timer": 4.339479661005774e-05, "num_module_steps_sampled": {"default_policy": 400}, "episode_return_mean": 1.35, "time_between_sampling": 2.814303548646078}, "num_healthy_workers": 1, "actor_manager_num_outstanding_async_reqs": 0, "num_remote_worker_restarts": 0}, "num_env_steps_sampled_lifetime": -5547500.0, "fault_tolerance": {"num_healthy_workers": 0, "num_remote_worker_restarts": 0}, "env_runner_group": {"actor_manager_num_outstanding_async_reqs": 0}, "done": false, "training_iteration": 11, "trial_id": "49f07_00000", "date": "2025-08-11_19-32-21", "timestamp": 1754933541, "time_this_iter_s": 3.7524263858795166, "time_total_s": 39.043978214263916, "pid": 24465, "hostname": "Mac", "node_ip": "127.0.0.1", "config": {"exploration_config": {}, "extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "placement_strategy": "PACK", "num_gpus": 0, "_fake_gpus": false, "num_cpus_for_main_process": 2, "eager_tracing": true, "eager_max_retraces": 20, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "torch_compile_learner": false, "torch_compile_learner_what_to_compile": "forward_train", "torch_compile_learner_dynamo_backend": "aot_eager", "torch_compile_learner_dynamo_mode": null, "torch_compile_worker": false, "torch_compile_worker_dynamo_backend": "aot_eager", "torch_compile_worker_dynamo_mode": null, "torch_ddp_kwargs": {}, "torch_skip_nan_gradients": false, "env": "Umbrella", "env_config": {}, "observation_space": null, "action_space": null, "clip_rewards": null, "normalize_actions": true, "clip_actions": false, "_is_atari": null, "disable_env_checking": false, "render_env": false, "action_mask_key": "action_mask", "env_runner_cls": null, "num_env_runners": 0, "create_local_env_runner": true, "num_envs_per_env_runner": 1, "gym_env_vectorize_mode": "SYNC", "num_cpus_per_env_runner": 1, "num_gpus_per_env_runner": 0, "custom_resources_per_env_runner": {}, "validate_env_runners_after_construction": true, "episodes_to_numpy": true, "max_requests_in_flight_per_env_runner": 1, "sample_timeout_s": 60.0, "_env_to_module_connector": null, "add_default_connectors_to_env_to_module_pipeline": true, "_module_to_env_connector": null, "add_default_connectors_to_module_to_env_pipeline": true, "merge_env_runner_states": "training_only", "broadcast_env_runner_states": true, "episode_lookback_horizon": 1, "rollout_fragment_length": "auto", "batch_mode": "complete_episodes", "compress_observations": false, "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "enable_tf1_exec_eagerly": false, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "preprocessor_pref": "deepmind", "observation_filter": "NoFilter", "update_worker_filter_stats": true, "use_worker_filter_stats": true, "sampler_perf_stats_ema_coef": null, "_is_online": true, "num_learners": 0, "num_gpus_per_learner": 0, "num_cpus_per_learner": "auto", "num_aggregator_actors_per_learner": 0, "max_requests_in_flight_per_aggregator_actor": 3, "local_gpu_idx": 0, "max_requests_in_flight_per_learner": 3, "gamma": 1, "lr": 0.0002847858517, "grad_clip": 0.5, "grad_clip_by": "global_norm", "_train_batch_size_per_learner": 5000, "train_batch_size": 4000, "num_epochs": 1, "minibatch_size": 1000, "shuffle_batch_per_epoch": true, "model": {"fcnet_hiddens": [256, 256], "fcnet_activation": "tanh", "fcnet_weights_initializer": null, "fcnet_weights_initializer_config": null, "fcnet_bias_initializer": null, "fcnet_bias_initializer_config": null, "conv_filters": null, "conv_activation": "relu", "conv_kernel_initializer": null, "conv_kernel_initializer_config": null, "conv_bias_initializer": null, "conv_bias_initializer_config": null, "conv_transpose_kernel_initializer": null, "conv_transpose_kernel_initializer_config": null, "conv_transpose_bias_initializer": null, "conv_transpose_bias_initializer_config": null, "post_fcnet_hiddens": [], "post_fcnet_activation": "relu", "post_fcnet_weights_initializer": null, "post_fcnet_weights_initializer_config": null, "post_fcnet_bias_initializer": null, "post_fcnet_bias_initializer_config": null, "free_log_std": false, "log_std_clip_param": 20.0, "no_final_linear": false, "vf_share_layers": false, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "lstm_weights_initializer": null, "lstm_weights_initializer_config": null, "lstm_bias_initializer": null, "lstm_bias_initializer_config": null, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "attention_use_n_prev_actions": 0, "attention_use_n_prev_rewards": 0, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": null, "custom_model_config": {}, "custom_action_dist": null, "custom_preprocessor": null, "encoder_latent_dim": null, "always_check_shapes": false, "lstm_use_prev_action_reward": -1, "_use_default_native_models": -1, "_disable_preprocessor_api": false, "_disable_action_flattening": false}, "_learner_connector": null, "add_default_connectors_to_learner_pipeline": true, "learner_config_dict": {}, "optimizer": {}, "_learner_class": null, "callbacks_on_algorithm_init": null, "callbacks_on_env_runners_recreated": null, "callbacks_on_offline_eval_runners_recreated": null, "callbacks_on_checkpoint_loaded": null, "callbacks_on_environment_created": null, "callbacks_on_episode_created": null, "callbacks_on_episode_start": null, "callbacks_on_episode_step": null, "callbacks_on_episode_end": null, "callbacks_on_evaluate_start": null, "callbacks_on_evaluate_end": null, "callbacks_on_evaluate_offline_start": null, "callbacks_on_evaluate_offline_end": null, "callbacks_on_sample_end": null, "callbacks_on_train_result": null, "explore": true, "enable_rl_module_and_learner": true, "enable_env_runner_and_connector_v2": true, "_prior_exploration_config": {"type": "StochasticSampling"}, "count_steps_by": "env_steps", "policy_map_capacity": 100, "policy_mapping_fn": "<function AlgorithmConfig.DEFAULT_POLICY_MAPPING_FN at 0x388c81b20>", "policies_to_train": null, "policy_states_are_swappable": false, "observation_fn": null, "offline_data_class": null, "input_read_method": "read_parquet", "input_read_method_kwargs": {}, "input_read_schema": {}, "input_read_episodes": false, "input_read_sample_batches": false, "input_read_batch_size": null, "input_filesystem": null, "input_filesystem_kwargs": {}, "input_compress_columns": ["obs", "new_obs"], "input_spaces_jsonable": true, "materialize_data": false, "materialize_mapped_data": true, "map_batches_kwargs": {}, "iter_batches_kwargs": {}, "ignore_final_observation": false, "prelearner_class": null, "prelearner_buffer_class": null, "prelearner_buffer_kwargs": {}, "prelearner_module_synch_period": 10, "dataset_num_iters_per_learner": null, "input_config": {}, "actions_in_input_normalized": false, "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_config": {}, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "output_max_rows_per_file": null, "output_write_remaining_data": false, "output_write_method": "write_parquet", "output_write_method_kwargs": {}, "output_filesystem": null, "output_filesystem_kwargs": {}, "output_write_episodes": true, "offline_sampling": false, "evaluation_interval": 1, "evaluation_duration": 20, "evaluation_duration_unit": "episodes", "evaluation_sample_timeout_s": 120.0, "evaluation_auto_duration_min_env_steps_per_sample": 100, "evaluation_auto_duration_max_env_steps_per_sample": 2000, "evaluation_parallel_to_training": false, "evaluation_force_reset_envs_before_iteration": true, "evaluation_config": null, "off_policy_estimation_methods": {}, "ope_split_batch_by_episode": true, "evaluation_num_env_runners": 1, "in_evaluation": false, "sync_filters_on_rollout_workers_timeout_s": 10.0, "offline_evaluation_interval": null, "num_offline_eval_runners": 0, "offline_loss_for_module_fn": null, "offline_evaluation_duration": 1, "offline_evaluation_parallel_to_training": false, "offline_evaluation_timeout_s": 120.0, "num_cpus_per_offline_eval_runner": 1, "num_gpus_per_offline_eval_runner": 0, "custom_resources_per_offline_eval_runner": {}, "restart_failed_offline_eval_runners": true, "ignore_offline_eval_runner_failures": false, "max_num_offline_eval_runner_restarts": 1000, "offline_eval_runner_restore_timeout_s": 1800.0, "max_requests_in_flight_per_offline_eval_runner": 1, "validate_offline_eval_runners_after_construction": true, "offline_eval_runner_health_probe_timeout_s": 30.0, "offline_eval_rl_module_inference_only": false, "broadcast_offline_eval_runner_states": false, "offline_eval_batch_size_per_runner": 256, "dataset_num_iters_per_eval_runner": 1, "keep_per_episode_custom_metrics": false, "metrics_episode_collection_timeout_s": 60.0, "metrics_num_episodes_for_smoothing": 100, "min_time_s_per_iteration": null, "min_train_timesteps_per_iteration": 0, "min_sample_timesteps_per_iteration": 0, "log_gradients": true, "export_native_model_files": false, "checkpoint_trainable_policies_only": false, "logger_creator": null, "logger_config": null, "log_level": "WARN", "log_sys_usage": true, "fake_sampler": false, "seed": 8, "restart_failed_env_runners": true, "ignore_env_runner_failures": false, "max_num_env_runner_restarts": 1000, "delay_between_env_runner_restarts_s": 60.0, "restart_failed_sub_environments": false, "num_consecutive_env_runner_failures_tolerance": 100, "env_runner_health_probe_timeout_s": 30.0, "env_runner_restore_timeout_s": 1800.0, "_model_config": {}, "_rl_module_spec": "RLModuleSpec(module_class=None, observation_space=None, action_space=None, inference_only=False, learner_only=False, model_config=DefaultModelConfig(fcnet_hiddens=[60, 90], fcnet_activation='tanh', fcnet_kernel_initializer=None, fcnet_kernel_initializer_kwargs=None, fcnet_bias_initializer=None, fcnet_bias_initializer_kwargs=None, conv_filters=None, conv_activation='relu', conv_kernel_initializer=None, conv_kernel_initializer_kwargs=None, conv_bias_initializer=None, conv_bias_initializer_kwargs=None, head_fcnet_hiddens=[], head_fcnet_activation='relu', head_fcnet_kernel_initializer=None, head_fcnet_kernel_initializer_kwargs=None, head_fcnet_bias_initializer=None, head_fcnet_bias_initializer_kwargs=None, free_log_std=False, log_std_clip_param=20.0, vf_share_layers=True, use_lstm=False, max_seq_len=20, lstm_cell_size=256, lstm_use_prev_action=False, lstm_use_prev_reward=False, lstm_kernel_initializer=None, lstm_kernel_initializer_kwargs=None, lstm_bias_initializer=None, lstm_bias_initializer_kwargs=None), catalog_class=None, load_state_path=None, model_config_dict=None)", "algorithm_config_overrides_per_module": {}, "_per_module_overrides": {}, "_validate_config": true, "_use_msgpack_checkpoints": false, "_torch_grad_scaler_class": null, "_torch_lr_scheduler_classes": null, "_tf_policy_handles_more_than_one_loss": false, "_disable_preprocessor_api": false, "_disable_action_flattening": false, "_disable_initialize_loss_from_dummy_batch": false, "_dont_auto_sync_env_runner_states": false, "env_task_fn": -1, "enable_connectors": -1, "simple_optimizer": false, "policy_map_cache": -1, "worker_cls": -1, "synchronize_filters": -1, "enable_async_evaluation": -1, "custom_async_evaluation_function": -1, "_enable_rl_module_api": -1, "auto_wrap_old_gym_envs": -1, "always_attach_evaluation_results": -1, "replay_sequence_length": null, "_disable_execution_plan_api": -1, "use_critic": true, "use_gae": true, "use_kl_loss": true, "kl_coeff": 0.7464963036515, "kl_target": 0.0270990929592, "vf_loss_coeff": 0.6688075857018, "entropy_coeff": 0.0090570820258, "clip_param": 0.1221781641624, "vf_clip_param": 0.1027808522125, "entropy_coeff_schedule": null, "lr_schedule": null, "sgd_minibatch_size": -1, "vf_share_layers": -1, "__stdout_file__": null, "__stderr_file__": null, "lambda": 0.9099046732075, "input": "sampler", "policies": {"default_policy": [null, null, null, null]}, "callbacks": "<class 'ray.rllib.callbacks.callbacks.RLlibCallback'>", "create_env_on_driver": false, "custom_eval_function": null, "framework": "torch"}, "time_since_restore": 39.043978214263916, "iterations_since_restore": 11, "perf": {"cpu_util_percent": 82.8, "ram_util_percent": 81.02}}
{"timers": {"training_iteration": 4.727679559450681, "restore_env_runners": 1.280734009108156e-05, "training_step": 4.727462408567701, "env_runner_sampling_timer": 4.551792038250392, "learner_update_timer": 0.17087245362637993, "synch_weights": 0.00111207931492138, "restore_eval_env_runners": 6.554831649509511e-05, "evaluation_iteration": 0.2602776086927256, "synch_eval_env_connectors": 0.0004311761504816487, "synch_env_connectors": 5.884713008886242e-06}, "env_runners": {"episode_duration_sec_mean": 0.009815705970861016, "rlmodule_inference_timer": 6.658009518750416e-05, "env_to_module_connector": {"timers": {"connectors": {"numpy_to_tensor": 2.0238648382077258e-05, "add_observations_from_episodes_to_batch": 6.151562618382589e-06, "add_time_dim_to_batch_and_zero_pad": 4.95600827240578e-06, "batch_individual_items": 1.3377805892750562e-05, "add_states_from_episodes_to_batch": 2.957104861555131e-06}}, "connector_pipeline_timer": 8.526045563525674e-05}, "sample": 0.010971475289456389, "env_reset_timer": 9.614054569396113e-05, "module_episode_returns_mean": {"default_policy": 5.299999999999998}, "episode_len_min": 20, "episode_len_max": 20, "module_to_env_connector": {"timers": {"connectors": {"tensor_to_numpy": 2.8216739829758263e-05, "un_batch_to_individual_items": 1.02185589061595e-05, "remove_single_ts_time_rank_from_batch": 1.150245323949929e-06, "listify_data_for_vector_env": 2.3721097645279637e-05, "normalize_and_clip_actions": 1.9031446860767042e-05, "get_actions": 0.00010050305516993811}}, "connector_pipeline_timer": 0.00023214140820131715}, "num_episodes_lifetime": -308250.0, "num_module_steps_sampled_lifetime": {"default_policy": -6165000.0}, "episode_return_mean": 5.299999999999998, "num_env_steps_sampled": 5000.0, "episode_return_min": -11.5, "env_to_module_sum_episodes_length_in": 10.36823839457432, "env_step_timer": 3.0847839304348363e-05, "env_to_module_sum_episodes_length_out": 10.36823839457432, "weights_seq_no": 11.0, "num_episodes": 250.0, "num_agent_steps_sampled": {"default_agent": 5000.0}, "episode_return_max": 8.5, "time_between_sampling": 0.0044403235367997795, "num_module_steps_sampled": {"default_policy": 5000.0}, "agent_episode_returns_mean": {"default_agent": 5.299999999999998}, "num_env_steps_sampled_lifetime": -6165000.0, "num_agent_steps_sampled_lifetime": {"default_agent": -6165000.0}, "episode_len_mean": 20.0, "num_env_steps_sampled_lifetime_throughput": 2026.955842160583}, "learners": {"default_policy": {"default_optimizer_learning_rate": 0.0002847858517, "curr_entropy_coeff": 0.0090570820258, "gradients_default_optimizer_global_norm": 0.016193924471735954, "policy_loss": -0.14379438757896423, "num_module_steps_trained_lifetime": 72000, "diff_num_grad_updates_vs_sampler_policy": 1.0, "mean_kl_loss": 0.00010483573714736849, "weights_seq_no": 12.0, "curr_kl_coeff": 0.00018225007806904614, "num_trainable_parameters": 6003, "num_module_steps_trained": 6000, "total_loss": -0.0799412950873375, "vf_explained_var": 0.0036283135414123535, "module_train_batch_size_mean": 1000.0, "vf_loss": 0.10278083384037018, "entropy": 0.5396393537521362, "vf_loss_unclipped": 26.306880950927734, "num_module_steps_trained_lifetime_throughput": 290054.54549631674}, "__all_modules__": {"num_module_steps_trained_lifetime": 72000, "learner_connector_sum_episodes_length_in": 5000.0, "learner_connector": {"timers": {"connectors": {"add_observations_from_episodes_to_batch": 0.0010991681566732059, "add_columns_from_episodes_to_train_batch": 0.04775632844347716, "numpy_to_tensor": 8.23560833132553e-05, "add_time_dim_to_batch_and_zero_pad": 1.9234451885607146e-05, "add_states_from_episodes_to_batch": 3.86385415875305e-06, "general_advantage_estimation": 0.008909996104306907, "batch_individual_items": 0.05337934106014823, "add_one_ts_to_episodes_and_truncate": 0.015144752256764293}}, "connector_pipeline_timer": 0.1265952246905333}, "num_non_trainable_parameters": 0, "num_env_steps_trained_lifetime": 378000, "num_trainable_parameters": 6003, "num_module_steps_trained": 6000, "num_env_steps_trained": 31500, "learner_connector_sum_episodes_length_out": 5250.0, "num_env_steps_trained_lifetime_throughput": 1514067.748383061, "num_module_steps_trained_throughput": 289617.36433859274, "num_module_steps_trained_lifetime_throughput": 289134.8731193496}}, "num_training_step_calls_per_iteration": 1, "evaluation": {"env_runners": {"env_to_module_connector": {"timers": {"connectors": {"numpy_to_tensor": 1.244481129909769e-05, "add_time_dim_to_batch_and_zero_pad": 3.2428067971144508e-06, "add_states_from_episodes_to_batch": 2.1755126668108513e-06, "batch_individual_items": 8.868517603875007e-06, "add_observations_from_episodes_to_batch": 4.4382732544369836e-06}}, "connector_pipeline_timer": 5.8897109564776e-05}, "num_env_steps_sampled": 400, "num_episodes": 20, "episode_duration_sec_mean": 0.007214122897712514, "num_agent_steps_sampled": {"default_agent": 400}, "module_to_env_connector": {"timers": {"connectors": {"un_batch_to_individual_items": 7.73394048785627e-06, "listify_data_for_vector_env": 1.5703832696745058e-05, "remove_single_ts_time_rank_from_batch": 7.075138655271483e-07, "normalize_and_clip_actions": 1.3321091885836904e-05, "get_actions": 5.5777019779263545e-05, "tensor_to_numpy": 1.94662002740459e-05}}, "connector_pipeline_timer": 0.00014856553331658593}, "sample": 0.24300118047213934, "agent_episode_returns_mean": {"default_agent": 0.95}, "episode_return_min": -13.5, "env_step_timer": 2.1227551645284027e-05, "env_to_module_sum_episodes_length_in": 10.368238394574323, "env_to_module_sum_episodes_length_out": 10.368238394574323, "weights_seq_no": 12.0, "episode_len_min": 20, "episode_len_max": 20, "num_agent_steps_sampled_lifetime": {"default_agent": 4800}, "num_episodes_lifetime": 240, "num_module_steps_sampled_lifetime": {"default_policy": 4800}, "episode_len_mean": 20.0, "env_reset_timer": 0.0007188245089812014, "episode_return_max": 14.5, "module_episode_returns_mean": {"default_policy": 0.95}, "num_env_steps_sampled_lifetime": 60400, "rlmodule_inference_timer": 4.00763885292095e-05, "num_module_steps_sampled": {"default_policy": 400}, "episode_return_mean": 0.95, "time_between_sampling": 2.8197986989904043}, "num_healthy_workers": 1, "actor_manager_num_outstanding_async_reqs": 0, "num_remote_worker_restarts": 0}, "num_env_steps_sampled_lifetime": -6165000.0, "fault_tolerance": {"num_healthy_workers": 0, "num_remote_worker_restarts": 0}, "env_runner_group": {"actor_manager_num_outstanding_async_reqs": 0}, "done": false, "training_iteration": 12, "trial_id": "49f07_00000", "date": "2025-08-11_19-32-24", "timestamp": 1754933544, "time_this_iter_s": 3.475766897201538, "time_total_s": 42.519745111465454, "pid": 24465, "hostname": "Mac", "node_ip": "127.0.0.1", "config": {"exploration_config": {}, "extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "placement_strategy": "PACK", "num_gpus": 0, "_fake_gpus": false, "num_cpus_for_main_process": 2, "eager_tracing": true, "eager_max_retraces": 20, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "torch_compile_learner": false, "torch_compile_learner_what_to_compile": "forward_train", "torch_compile_learner_dynamo_backend": "aot_eager", "torch_compile_learner_dynamo_mode": null, "torch_compile_worker": false, "torch_compile_worker_dynamo_backend": "aot_eager", "torch_compile_worker_dynamo_mode": null, "torch_ddp_kwargs": {}, "torch_skip_nan_gradients": false, "env": "Umbrella", "env_config": {}, "observation_space": null, "action_space": null, "clip_rewards": null, "normalize_actions": true, "clip_actions": false, "_is_atari": null, "disable_env_checking": false, "render_env": false, "action_mask_key": "action_mask", "env_runner_cls": null, "num_env_runners": 0, "create_local_env_runner": true, "num_envs_per_env_runner": 1, "gym_env_vectorize_mode": "SYNC", "num_cpus_per_env_runner": 1, "num_gpus_per_env_runner": 0, "custom_resources_per_env_runner": {}, "validate_env_runners_after_construction": true, "episodes_to_numpy": true, "max_requests_in_flight_per_env_runner": 1, "sample_timeout_s": 60.0, "_env_to_module_connector": null, "add_default_connectors_to_env_to_module_pipeline": true, "_module_to_env_connector": null, "add_default_connectors_to_module_to_env_pipeline": true, "merge_env_runner_states": "training_only", "broadcast_env_runner_states": true, "episode_lookback_horizon": 1, "rollout_fragment_length": "auto", "batch_mode": "complete_episodes", "compress_observations": false, "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "enable_tf1_exec_eagerly": false, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "preprocessor_pref": "deepmind", "observation_filter": "NoFilter", "update_worker_filter_stats": true, "use_worker_filter_stats": true, "sampler_perf_stats_ema_coef": null, "_is_online": true, "num_learners": 0, "num_gpus_per_learner": 0, "num_cpus_per_learner": "auto", "num_aggregator_actors_per_learner": 0, "max_requests_in_flight_per_aggregator_actor": 3, "local_gpu_idx": 0, "max_requests_in_flight_per_learner": 3, "gamma": 1, "lr": 0.0002847858517, "grad_clip": 0.5, "grad_clip_by": "global_norm", "_train_batch_size_per_learner": 5000, "train_batch_size": 4000, "num_epochs": 1, "minibatch_size": 1000, "shuffle_batch_per_epoch": true, "model": {"fcnet_hiddens": [256, 256], "fcnet_activation": "tanh", "fcnet_weights_initializer": null, "fcnet_weights_initializer_config": null, "fcnet_bias_initializer": null, "fcnet_bias_initializer_config": null, "conv_filters": null, "conv_activation": "relu", "conv_kernel_initializer": null, "conv_kernel_initializer_config": null, "conv_bias_initializer": null, "conv_bias_initializer_config": null, "conv_transpose_kernel_initializer": null, "conv_transpose_kernel_initializer_config": null, "conv_transpose_bias_initializer": null, "conv_transpose_bias_initializer_config": null, "post_fcnet_hiddens": [], "post_fcnet_activation": "relu", "post_fcnet_weights_initializer": null, "post_fcnet_weights_initializer_config": null, "post_fcnet_bias_initializer": null, "post_fcnet_bias_initializer_config": null, "free_log_std": false, "log_std_clip_param": 20.0, "no_final_linear": false, "vf_share_layers": false, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "lstm_weights_initializer": null, "lstm_weights_initializer_config": null, "lstm_bias_initializer": null, "lstm_bias_initializer_config": null, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "attention_use_n_prev_actions": 0, "attention_use_n_prev_rewards": 0, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": null, "custom_model_config": {}, "custom_action_dist": null, "custom_preprocessor": null, "encoder_latent_dim": null, "always_check_shapes": false, "lstm_use_prev_action_reward": -1, "_use_default_native_models": -1, "_disable_preprocessor_api": false, "_disable_action_flattening": false}, "_learner_connector": null, "add_default_connectors_to_learner_pipeline": true, "learner_config_dict": {}, "optimizer": {}, "_learner_class": null, "callbacks_on_algorithm_init": null, "callbacks_on_env_runners_recreated": null, "callbacks_on_offline_eval_runners_recreated": null, "callbacks_on_checkpoint_loaded": null, "callbacks_on_environment_created": null, "callbacks_on_episode_created": null, "callbacks_on_episode_start": null, "callbacks_on_episode_step": null, "callbacks_on_episode_end": null, "callbacks_on_evaluate_start": null, "callbacks_on_evaluate_end": null, "callbacks_on_evaluate_offline_start": null, "callbacks_on_evaluate_offline_end": null, "callbacks_on_sample_end": null, "callbacks_on_train_result": null, "explore": true, "enable_rl_module_and_learner": true, "enable_env_runner_and_connector_v2": true, "_prior_exploration_config": {"type": "StochasticSampling"}, "count_steps_by": "env_steps", "policy_map_capacity": 100, "policy_mapping_fn": "<function AlgorithmConfig.DEFAULT_POLICY_MAPPING_FN at 0x388c81b20>", "policies_to_train": null, "policy_states_are_swappable": false, "observation_fn": null, "offline_data_class": null, "input_read_method": "read_parquet", "input_read_method_kwargs": {}, "input_read_schema": {}, "input_read_episodes": false, "input_read_sample_batches": false, "input_read_batch_size": null, "input_filesystem": null, "input_filesystem_kwargs": {}, "input_compress_columns": ["obs", "new_obs"], "input_spaces_jsonable": true, "materialize_data": false, "materialize_mapped_data": true, "map_batches_kwargs": {}, "iter_batches_kwargs": {}, "ignore_final_observation": false, "prelearner_class": null, "prelearner_buffer_class": null, "prelearner_buffer_kwargs": {}, "prelearner_module_synch_period": 10, "dataset_num_iters_per_learner": null, "input_config": {}, "actions_in_input_normalized": false, "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_config": {}, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "output_max_rows_per_file": null, "output_write_remaining_data": false, "output_write_method": "write_parquet", "output_write_method_kwargs": {}, "output_filesystem": null, "output_filesystem_kwargs": {}, "output_write_episodes": true, "offline_sampling": false, "evaluation_interval": 1, "evaluation_duration": 20, "evaluation_duration_unit": "episodes", "evaluation_sample_timeout_s": 120.0, "evaluation_auto_duration_min_env_steps_per_sample": 100, "evaluation_auto_duration_max_env_steps_per_sample": 2000, "evaluation_parallel_to_training": false, "evaluation_force_reset_envs_before_iteration": true, "evaluation_config": null, "off_policy_estimation_methods": {}, "ope_split_batch_by_episode": true, "evaluation_num_env_runners": 1, "in_evaluation": false, "sync_filters_on_rollout_workers_timeout_s": 10.0, "offline_evaluation_interval": null, "num_offline_eval_runners": 0, "offline_loss_for_module_fn": null, "offline_evaluation_duration": 1, "offline_evaluation_parallel_to_training": false, "offline_evaluation_timeout_s": 120.0, "num_cpus_per_offline_eval_runner": 1, "num_gpus_per_offline_eval_runner": 0, "custom_resources_per_offline_eval_runner": {}, "restart_failed_offline_eval_runners": true, "ignore_offline_eval_runner_failures": false, "max_num_offline_eval_runner_restarts": 1000, "offline_eval_runner_restore_timeout_s": 1800.0, "max_requests_in_flight_per_offline_eval_runner": 1, "validate_offline_eval_runners_after_construction": true, "offline_eval_runner_health_probe_timeout_s": 30.0, "offline_eval_rl_module_inference_only": false, "broadcast_offline_eval_runner_states": false, "offline_eval_batch_size_per_runner": 256, "dataset_num_iters_per_eval_runner": 1, "keep_per_episode_custom_metrics": false, "metrics_episode_collection_timeout_s": 60.0, "metrics_num_episodes_for_smoothing": 100, "min_time_s_per_iteration": null, "min_train_timesteps_per_iteration": 0, "min_sample_timesteps_per_iteration": 0, "log_gradients": true, "export_native_model_files": false, "checkpoint_trainable_policies_only": false, "logger_creator": null, "logger_config": null, "log_level": "WARN", "log_sys_usage": true, "fake_sampler": false, "seed": 8, "restart_failed_env_runners": true, "ignore_env_runner_failures": false, "max_num_env_runner_restarts": 1000, "delay_between_env_runner_restarts_s": 60.0, "restart_failed_sub_environments": false, "num_consecutive_env_runner_failures_tolerance": 100, "env_runner_health_probe_timeout_s": 30.0, "env_runner_restore_timeout_s": 1800.0, "_model_config": {}, "_rl_module_spec": "RLModuleSpec(module_class=None, observation_space=None, action_space=None, inference_only=False, learner_only=False, model_config=DefaultModelConfig(fcnet_hiddens=[60, 90], fcnet_activation='tanh', fcnet_kernel_initializer=None, fcnet_kernel_initializer_kwargs=None, fcnet_bias_initializer=None, fcnet_bias_initializer_kwargs=None, conv_filters=None, conv_activation='relu', conv_kernel_initializer=None, conv_kernel_initializer_kwargs=None, conv_bias_initializer=None, conv_bias_initializer_kwargs=None, head_fcnet_hiddens=[], head_fcnet_activation='relu', head_fcnet_kernel_initializer=None, head_fcnet_kernel_initializer_kwargs=None, head_fcnet_bias_initializer=None, head_fcnet_bias_initializer_kwargs=None, free_log_std=False, log_std_clip_param=20.0, vf_share_layers=True, use_lstm=False, max_seq_len=20, lstm_cell_size=256, lstm_use_prev_action=False, lstm_use_prev_reward=False, lstm_kernel_initializer=None, lstm_kernel_initializer_kwargs=None, lstm_bias_initializer=None, lstm_bias_initializer_kwargs=None), catalog_class=None, load_state_path=None, model_config_dict=None)", "algorithm_config_overrides_per_module": {}, "_per_module_overrides": {}, "_validate_config": true, "_use_msgpack_checkpoints": false, "_torch_grad_scaler_class": null, "_torch_lr_scheduler_classes": null, "_tf_policy_handles_more_than_one_loss": false, "_disable_preprocessor_api": false, "_disable_action_flattening": false, "_disable_initialize_loss_from_dummy_batch": false, "_dont_auto_sync_env_runner_states": false, "env_task_fn": -1, "enable_connectors": -1, "simple_optimizer": false, "policy_map_cache": -1, "worker_cls": -1, "synchronize_filters": -1, "enable_async_evaluation": -1, "custom_async_evaluation_function": -1, "_enable_rl_module_api": -1, "auto_wrap_old_gym_envs": -1, "always_attach_evaluation_results": -1, "replay_sequence_length": null, "_disable_execution_plan_api": -1, "use_critic": true, "use_gae": true, "use_kl_loss": true, "kl_coeff": 0.7464963036515, "kl_target": 0.0270990929592, "vf_loss_coeff": 0.6688075857018, "entropy_coeff": 0.0090570820258, "clip_param": 0.1221781641624, "vf_clip_param": 0.1027808522125, "entropy_coeff_schedule": null, "lr_schedule": null, "sgd_minibatch_size": -1, "vf_share_layers": -1, "__stdout_file__": null, "__stderr_file__": null, "lambda": 0.9099046732075, "input": "sampler", "policies": {"default_policy": [null, null, null, null]}, "callbacks": "<class 'ray.rllib.callbacks.callbacks.RLlibCallback'>", "create_env_on_driver": false, "custom_eval_function": null, "framework": "torch"}, "time_since_restore": 42.519745111465454, "iterations_since_restore": 12, "perf": {"cpu_util_percent": 82.74000000000001, "ram_util_percent": 80.46}}
{"timers": {"training_iteration": 4.709319114276505, "restore_env_runners": 1.2743426666489225e-05, "training_step": 4.70910106115136, "env_runner_sampling_timer": 4.533967329958414, "learner_update_timer": 0.17032725284026298, "synch_weights": 0.0011106114416066458, "restore_eval_env_runners": 6.496491304080653e-05, "evaluation_iteration": 0.2590723676057947, "synch_eval_env_connectors": 0.0004280943890294333, "synch_env_connectors": 5.8708662214495815e-06}, "env_runners": {"episode_duration_sec_mean": 0.008870648812502626, "rlmodule_inference_timer": 5.69512667632226e-05, "env_to_module_connector": {"timers": {"connectors": {"numpy_to_tensor": 1.715835139052146e-05, "add_observations_from_episodes_to_batch": 5.302232875848276e-06, "add_time_dim_to_batch_and_zero_pad": 4.393014451649094e-06, "batch_individual_items": 1.2097216629204981e-05, "add_states_from_episodes_to_batch": 2.875556428912819e-06}}, "connector_pipeline_timer": 7.774494266427859e-05}, "sample": 0.010235332341826749, "env_reset_timer": 9.101680748877026e-05, "module_episode_returns_mean": {"default_policy": 5.700000000000004}, "episode_len_min": 20, "episode_len_max": 20, "module_to_env_connector": {"timers": {"connectors": {"tensor_to_numpy": 2.5306789805014085e-05, "un_batch_to_individual_items": 9.242806566795868e-06, "remove_single_ts_time_rank_from_batch": 1.00641251814203e-06, "listify_data_for_vector_env": 2.2087234727980915e-05, "normalize_and_clip_actions": 1.7068035032408672e-05, "get_actions": 8.768471763033916e-05}}, "connector_pipeline_timer": 0.00020695958134829944}, "num_episodes_lifetime": -339125.0, "num_module_steps_sampled_lifetime": {"default_policy": -6782500.0}, "episode_return_mean": 5.700000000000004, "num_env_steps_sampled": 5000.0, "episode_return_min": -11.5, "env_to_module_sum_episodes_length_in": 10.36823839457432, "env_step_timer": 2.9098906209653024e-05, "env_to_module_sum_episodes_length_out": 10.36823839457432, "weights_seq_no": 12.0, "num_episodes": 250.0, "num_agent_steps_sampled": {"default_agent": 5000.0}, "episode_return_max": 8.5, "time_between_sampling": 0.0029078439325520736, "num_module_steps_sampled": {"default_policy": 5000.0}, "agent_episode_returns_mean": {"default_agent": 5.700000000000004}, "num_env_steps_sampled_lifetime": -6782500.0, "num_agent_steps_sampled_lifetime": {"default_agent": -6782500.0}, "episode_len_mean": 20.0, "num_env_steps_sampled_lifetime_throughput": 2198.2520064188016}, "learners": {"default_policy": {"default_optimizer_learning_rate": 0.0002847858517, "curr_entropy_coeff": 0.0090570820258, "gradients_default_optimizer_global_norm": 0.05791241675615311, "policy_loss": -0.10556618124246597, "num_module_steps_trained_lifetime": 78000, "diff_num_grad_updates_vs_sampler_policy": 1.0, "mean_kl_loss": 4.6311222831718624e-05, "weights_seq_no": 13.0, "curr_kl_coeff": 9.112503903452307e-05, "num_trainable_parameters": 6003, "num_module_steps_trained": 6000, "total_loss": -0.04169650375843048, "vf_explained_var": 0.004175662994384766, "module_train_batch_size_mean": 1000.0, "vf_loss": 0.10278083384037018, "entropy": 0.5378057956695557, "vf_loss_unclipped": 26.30040740966797, "num_module_steps_trained_lifetime_throughput": 285328.2801717252}, "__all_modules__": {"num_module_steps_trained_lifetime": 78000, "learner_connector_sum_episodes_length_in": 5000.0, "learner_connector": {"timers": {"connectors": {"add_observations_from_episodes_to_batch": 0.0010989673151306023, "add_columns_from_episodes_to_train_batch": 0.047647566819412464, "numpy_to_tensor": 8.223210289434343e-05, "add_time_dim_to_batch_and_zero_pad": 1.915168678088033e-05, "add_states_from_episodes_to_batch": 3.857305500627114e-06, "general_advantage_estimation": 0.008884615723912305, "batch_individual_items": 0.05319374347897548, "add_one_ts_to_episodes_and_truncate": 0.01511422348495959}}, "connector_pipeline_timer": 0.12624431661373378}, "num_non_trainable_parameters": 0, "num_env_steps_trained_lifetime": 409500, "num_trainable_parameters": 6003, "num_module_steps_trained": 6000, "num_env_steps_trained": 31500, "learner_connector_sum_episodes_length_out": 5250.0, "num_env_steps_trained_lifetime_throughput": 1489765.5549442486, "num_module_steps_trained_throughput": 284927.4120095001, "num_module_steps_trained_lifetime_throughput": 284466.7901223033}}, "num_training_step_calls_per_iteration": 1, "evaluation": {"env_runners": {"env_to_module_connector": {"timers": {"connectors": {"numpy_to_tensor": 2.4758696702820065e-05, "add_time_dim_to_batch_and_zero_pad": 6.038539077675808e-06, "add_states_from_episodes_to_batch": 3.0205700074000393e-06, "batch_individual_items": 1.6667867443709868e-05, "add_observations_from_episodes_to_batch": 6.56213617389285e-06}}, "connector_pipeline_timer": 0.00010609207841383813}, "num_env_steps_sampled": 400, "num_episodes": 20, "episode_duration_sec_mean": 0.007769747069105506, "num_agent_steps_sampled": {"default_agent": 400}, "module_to_env_connector": {"timers": {"connectors": {"un_batch_to_individual_items": 1.3708577216185153e-05, "listify_data_for_vector_env": 3.122062877507802e-05, "remove_single_ts_time_rank_from_batch": 2.245493318143216e-06, "normalize_and_clip_actions": 2.254785979307105e-05, "get_actions": 0.00011270222391477055, "tensor_to_numpy": 3.4522230686312106e-05}}, "connector_pipeline_timer": 0.000277800306224231}, "sample": 0.2425082590866508, "agent_episode_returns_mean": {"default_agent": 0.75}, "episode_return_min": -13.5, "env_step_timer": 4.3611572814346763e-05, "env_to_module_sum_episodes_length_in": 10.368238394574323, "env_to_module_sum_episodes_length_out": 10.368238394574323, "weights_seq_no": 13.0, "episode_len_min": 20, "episode_len_max": 20, "num_agent_steps_sampled_lifetime": {"default_agent": 5200}, "num_episodes_lifetime": 260, "num_module_steps_sampled_lifetime": {"default_policy": 5200}, "episode_len_mean": 20.0, "env_reset_timer": 0.0007125991839126551, "episode_return_max": 14.5, "module_episode_returns_mean": {"default_policy": 0.75}, "num_env_steps_sampled_lifetime": 65400, "rlmodule_inference_timer": 7.928516518389946e-05, "num_module_steps_sampled": {"default_policy": 400}, "episode_return_mean": 0.75, "time_between_sampling": 2.8208021924208064}, "num_healthy_workers": 1, "actor_manager_num_outstanding_async_reqs": 0, "num_remote_worker_restarts": 0}, "num_env_steps_sampled_lifetime": -6782500.0, "fault_tolerance": {"num_healthy_workers": 0, "num_remote_worker_restarts": 0}, "env_runner_group": {"actor_manager_num_outstanding_async_reqs": 0}, "done": false, "training_iteration": 13, "trial_id": "49f07_00000", "date": "2025-08-11_19-32-27", "timestamp": 1754933547, "time_this_iter_s": 3.098750114440918, "time_total_s": 45.61849522590637, "pid": 24465, "hostname": "Mac", "node_ip": "127.0.0.1", "config": {"exploration_config": {}, "extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "placement_strategy": "PACK", "num_gpus": 0, "_fake_gpus": false, "num_cpus_for_main_process": 2, "eager_tracing": true, "eager_max_retraces": 20, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "torch_compile_learner": false, "torch_compile_learner_what_to_compile": "forward_train", "torch_compile_learner_dynamo_backend": "aot_eager", "torch_compile_learner_dynamo_mode": null, "torch_compile_worker": false, "torch_compile_worker_dynamo_backend": "aot_eager", "torch_compile_worker_dynamo_mode": null, "torch_ddp_kwargs": {}, "torch_skip_nan_gradients": false, "env": "Umbrella", "env_config": {}, "observation_space": null, "action_space": null, "clip_rewards": null, "normalize_actions": true, "clip_actions": false, "_is_atari": null, "disable_env_checking": false, "render_env": false, "action_mask_key": "action_mask", "env_runner_cls": null, "num_env_runners": 0, "create_local_env_runner": true, "num_envs_per_env_runner": 1, "gym_env_vectorize_mode": "SYNC", "num_cpus_per_env_runner": 1, "num_gpus_per_env_runner": 0, "custom_resources_per_env_runner": {}, "validate_env_runners_after_construction": true, "episodes_to_numpy": true, "max_requests_in_flight_per_env_runner": 1, "sample_timeout_s": 60.0, "_env_to_module_connector": null, "add_default_connectors_to_env_to_module_pipeline": true, "_module_to_env_connector": null, "add_default_connectors_to_module_to_env_pipeline": true, "merge_env_runner_states": "training_only", "broadcast_env_runner_states": true, "episode_lookback_horizon": 1, "rollout_fragment_length": "auto", "batch_mode": "complete_episodes", "compress_observations": false, "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "enable_tf1_exec_eagerly": false, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "preprocessor_pref": "deepmind", "observation_filter": "NoFilter", "update_worker_filter_stats": true, "use_worker_filter_stats": true, "sampler_perf_stats_ema_coef": null, "_is_online": true, "num_learners": 0, "num_gpus_per_learner": 0, "num_cpus_per_learner": "auto", "num_aggregator_actors_per_learner": 0, "max_requests_in_flight_per_aggregator_actor": 3, "local_gpu_idx": 0, "max_requests_in_flight_per_learner": 3, "gamma": 1, "lr": 0.0002847858517, "grad_clip": 0.5, "grad_clip_by": "global_norm", "_train_batch_size_per_learner": 5000, "train_batch_size": 4000, "num_epochs": 1, "minibatch_size": 1000, "shuffle_batch_per_epoch": true, "model": {"fcnet_hiddens": [256, 256], "fcnet_activation": "tanh", "fcnet_weights_initializer": null, "fcnet_weights_initializer_config": null, "fcnet_bias_initializer": null, "fcnet_bias_initializer_config": null, "conv_filters": null, "conv_activation": "relu", "conv_kernel_initializer": null, "conv_kernel_initializer_config": null, "conv_bias_initializer": null, "conv_bias_initializer_config": null, "conv_transpose_kernel_initializer": null, "conv_transpose_kernel_initializer_config": null, "conv_transpose_bias_initializer": null, "conv_transpose_bias_initializer_config": null, "post_fcnet_hiddens": [], "post_fcnet_activation": "relu", "post_fcnet_weights_initializer": null, "post_fcnet_weights_initializer_config": null, "post_fcnet_bias_initializer": null, "post_fcnet_bias_initializer_config": null, "free_log_std": false, "log_std_clip_param": 20.0, "no_final_linear": false, "vf_share_layers": false, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "lstm_weights_initializer": null, "lstm_weights_initializer_config": null, "lstm_bias_initializer": null, "lstm_bias_initializer_config": null, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "attention_use_n_prev_actions": 0, "attention_use_n_prev_rewards": 0, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": null, "custom_model_config": {}, "custom_action_dist": null, "custom_preprocessor": null, "encoder_latent_dim": null, "always_check_shapes": false, "lstm_use_prev_action_reward": -1, "_use_default_native_models": -1, "_disable_preprocessor_api": false, "_disable_action_flattening": false}, "_learner_connector": null, "add_default_connectors_to_learner_pipeline": true, "learner_config_dict": {}, "optimizer": {}, "_learner_class": null, "callbacks_on_algorithm_init": null, "callbacks_on_env_runners_recreated": null, "callbacks_on_offline_eval_runners_recreated": null, "callbacks_on_checkpoint_loaded": null, "callbacks_on_environment_created": null, "callbacks_on_episode_created": null, "callbacks_on_episode_start": null, "callbacks_on_episode_step": null, "callbacks_on_episode_end": null, "callbacks_on_evaluate_start": null, "callbacks_on_evaluate_end": null, "callbacks_on_evaluate_offline_start": null, "callbacks_on_evaluate_offline_end": null, "callbacks_on_sample_end": null, "callbacks_on_train_result": null, "explore": true, "enable_rl_module_and_learner": true, "enable_env_runner_and_connector_v2": true, "_prior_exploration_config": {"type": "StochasticSampling"}, "count_steps_by": "env_steps", "policy_map_capacity": 100, "policy_mapping_fn": "<function AlgorithmConfig.DEFAULT_POLICY_MAPPING_FN at 0x388c81b20>", "policies_to_train": null, "policy_states_are_swappable": false, "observation_fn": null, "offline_data_class": null, "input_read_method": "read_parquet", "input_read_method_kwargs": {}, "input_read_schema": {}, "input_read_episodes": false, "input_read_sample_batches": false, "input_read_batch_size": null, "input_filesystem": null, "input_filesystem_kwargs": {}, "input_compress_columns": ["obs", "new_obs"], "input_spaces_jsonable": true, "materialize_data": false, "materialize_mapped_data": true, "map_batches_kwargs": {}, "iter_batches_kwargs": {}, "ignore_final_observation": false, "prelearner_class": null, "prelearner_buffer_class": null, "prelearner_buffer_kwargs": {}, "prelearner_module_synch_period": 10, "dataset_num_iters_per_learner": null, "input_config": {}, "actions_in_input_normalized": false, "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_config": {}, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "output_max_rows_per_file": null, "output_write_remaining_data": false, "output_write_method": "write_parquet", "output_write_method_kwargs": {}, "output_filesystem": null, "output_filesystem_kwargs": {}, "output_write_episodes": true, "offline_sampling": false, "evaluation_interval": 1, "evaluation_duration": 20, "evaluation_duration_unit": "episodes", "evaluation_sample_timeout_s": 120.0, "evaluation_auto_duration_min_env_steps_per_sample": 100, "evaluation_auto_duration_max_env_steps_per_sample": 2000, "evaluation_parallel_to_training": false, "evaluation_force_reset_envs_before_iteration": true, "evaluation_config": null, "off_policy_estimation_methods": {}, "ope_split_batch_by_episode": true, "evaluation_num_env_runners": 1, "in_evaluation": false, "sync_filters_on_rollout_workers_timeout_s": 10.0, "offline_evaluation_interval": null, "num_offline_eval_runners": 0, "offline_loss_for_module_fn": null, "offline_evaluation_duration": 1, "offline_evaluation_parallel_to_training": false, "offline_evaluation_timeout_s": 120.0, "num_cpus_per_offline_eval_runner": 1, "num_gpus_per_offline_eval_runner": 0, "custom_resources_per_offline_eval_runner": {}, "restart_failed_offline_eval_runners": true, "ignore_offline_eval_runner_failures": false, "max_num_offline_eval_runner_restarts": 1000, "offline_eval_runner_restore_timeout_s": 1800.0, "max_requests_in_flight_per_offline_eval_runner": 1, "validate_offline_eval_runners_after_construction": true, "offline_eval_runner_health_probe_timeout_s": 30.0, "offline_eval_rl_module_inference_only": false, "broadcast_offline_eval_runner_states": false, "offline_eval_batch_size_per_runner": 256, "dataset_num_iters_per_eval_runner": 1, "keep_per_episode_custom_metrics": false, "metrics_episode_collection_timeout_s": 60.0, "metrics_num_episodes_for_smoothing": 100, "min_time_s_per_iteration": null, "min_train_timesteps_per_iteration": 0, "min_sample_timesteps_per_iteration": 0, "log_gradients": true, "export_native_model_files": false, "checkpoint_trainable_policies_only": false, "logger_creator": null, "logger_config": null, "log_level": "WARN", "log_sys_usage": true, "fake_sampler": false, "seed": 8, "restart_failed_env_runners": true, "ignore_env_runner_failures": false, "max_num_env_runner_restarts": 1000, "delay_between_env_runner_restarts_s": 60.0, "restart_failed_sub_environments": false, "num_consecutive_env_runner_failures_tolerance": 100, "env_runner_health_probe_timeout_s": 30.0, "env_runner_restore_timeout_s": 1800.0, "_model_config": {}, "_rl_module_spec": "RLModuleSpec(module_class=None, observation_space=None, action_space=None, inference_only=False, learner_only=False, model_config=DefaultModelConfig(fcnet_hiddens=[60, 90], fcnet_activation='tanh', fcnet_kernel_initializer=None, fcnet_kernel_initializer_kwargs=None, fcnet_bias_initializer=None, fcnet_bias_initializer_kwargs=None, conv_filters=None, conv_activation='relu', conv_kernel_initializer=None, conv_kernel_initializer_kwargs=None, conv_bias_initializer=None, conv_bias_initializer_kwargs=None, head_fcnet_hiddens=[], head_fcnet_activation='relu', head_fcnet_kernel_initializer=None, head_fcnet_kernel_initializer_kwargs=None, head_fcnet_bias_initializer=None, head_fcnet_bias_initializer_kwargs=None, free_log_std=False, log_std_clip_param=20.0, vf_share_layers=True, use_lstm=False, max_seq_len=20, lstm_cell_size=256, lstm_use_prev_action=False, lstm_use_prev_reward=False, lstm_kernel_initializer=None, lstm_kernel_initializer_kwargs=None, lstm_bias_initializer=None, lstm_bias_initializer_kwargs=None), catalog_class=None, load_state_path=None, model_config_dict=None)", "algorithm_config_overrides_per_module": {}, "_per_module_overrides": {}, "_validate_config": true, "_use_msgpack_checkpoints": false, "_torch_grad_scaler_class": null, "_torch_lr_scheduler_classes": null, "_tf_policy_handles_more_than_one_loss": false, "_disable_preprocessor_api": false, "_disable_action_flattening": false, "_disable_initialize_loss_from_dummy_batch": false, "_dont_auto_sync_env_runner_states": false, "env_task_fn": -1, "enable_connectors": -1, "simple_optimizer": false, "policy_map_cache": -1, "worker_cls": -1, "synchronize_filters": -1, "enable_async_evaluation": -1, "custom_async_evaluation_function": -1, "_enable_rl_module_api": -1, "auto_wrap_old_gym_envs": -1, "always_attach_evaluation_results": -1, "replay_sequence_length": null, "_disable_execution_plan_api": -1, "use_critic": true, "use_gae": true, "use_kl_loss": true, "kl_coeff": 0.7464963036515, "kl_target": 0.0270990929592, "vf_loss_coeff": 0.6688075857018, "entropy_coeff": 0.0090570820258, "clip_param": 0.1221781641624, "vf_clip_param": 0.1027808522125, "entropy_coeff_schedule": null, "lr_schedule": null, "sgd_minibatch_size": -1, "vf_share_layers": -1, "__stdout_file__": null, "__stderr_file__": null, "lambda": 0.9099046732075, "input": "sampler", "policies": {"default_policy": [null, null, null, null]}, "callbacks": "<class 'ray.rllib.callbacks.callbacks.RLlibCallback'>", "create_env_on_driver": false, "custom_eval_function": null, "framework": "torch"}, "time_since_restore": 45.61849522590637, "iterations_since_restore": 13, "perf": {"cpu_util_percent": 79.72500000000001, "ram_util_percent": 80.85}}
{"timers": {"training_iteration": 4.6918451014633344, "restore_env_runners": 1.294307172387607e-05, "training_step": 4.691624116790934, "env_runner_sampling_timer": 4.5154196620792595, "learner_update_timer": 0.17137458406290693, "synch_weights": 0.0011169944964492036, "restore_eval_env_runners": 6.440401429514645e-05, "evaluation_iteration": 0.25853155726043886, "synch_eval_env_connectors": 0.0004290863560693553, "synch_env_connectors": 5.891328127149929e-06}, "env_runners": {"episode_duration_sec_mean": 0.008964140501804649, "rlmodule_inference_timer": 5.945894358514204e-05, "env_to_module_connector": {"timers": {"connectors": {"numpy_to_tensor": 1.806729286579703e-05, "add_observations_from_episodes_to_batch": 5.2916783609863546e-06, "add_time_dim_to_batch_and_zero_pad": 4.487096256709455e-06, "batch_individual_items": 1.2260920323735834e-05, "add_states_from_episodes_to_batch": 2.8616335515694616e-06}}, "connector_pipeline_timer": 7.775368148488294e-05}, "sample": 0.009474391153219415, "env_reset_timer": 8.152653363127916e-05, "module_episode_returns_mean": {"default_policy": 5.380000000000001}, "episode_len_min": 20, "episode_len_max": 20, "module_to_env_connector": {"timers": {"connectors": {"tensor_to_numpy": 2.4997578712697814e-05, "un_batch_to_individual_items": 9.441672492958769e-06, "remove_single_ts_time_rank_from_batch": 1.0883844781079692e-06, "listify_data_for_vector_env": 2.1107035285504353e-05, "normalize_and_clip_actions": 1.683301098525315e-05, "get_actions": 8.918777592487318e-05}}, "connector_pipeline_timer": 0.0002068929839348316}, "num_episodes_lifetime": -370000.0, "num_module_steps_sampled_lifetime": {"default_policy": -7400000.0}, "episode_return_mean": 5.380000000000001, "num_env_steps_sampled": 5000.0, "episode_return_min": -11.5, "env_to_module_sum_episodes_length_in": 10.36823839457432, "env_step_timer": 2.7968307889067998e-05, "env_to_module_sum_episodes_length_out": 10.36823839457432, "weights_seq_no": 13.0, "num_episodes": 250.0, "num_agent_steps_sampled": {"default_agent": 5000.0}, "episode_return_max": 8.5, "time_between_sampling": 0.0027809378467472997, "num_module_steps_sampled": {"default_policy": 5000.0}, "agent_episode_returns_mean": {"default_agent": 5.380000000000001}, "num_env_steps_sampled_lifetime": -7400000.0, "num_agent_steps_sampled_lifetime": {"default_agent": -7400000.0}, "episode_len_mean": 20.0, "num_env_steps_sampled_lifetime_throughput": 2225.661099481012}, "learners": {"default_policy": {"default_optimizer_learning_rate": 0.0002847858517, "curr_entropy_coeff": 0.0090570820258, "gradients_default_optimizer_global_norm": 0.035145506262779236, "policy_loss": 0.07163506746292114, "num_module_steps_trained_lifetime": 84000, "diff_num_grad_updates_vs_sampler_policy": 1.0, "mean_kl_loss": 0.00028114247834309936, "weights_seq_no": 14.0, "curr_kl_coeff": 4.5562519517261535e-05, "num_trainable_parameters": 6003, "num_module_steps_trained": 6000, "total_loss": 0.1356709897518158, "vf_explained_var": 0.005130410194396973, "module_train_batch_size_mean": 1000.0, "vf_loss": 0.10278083384037018, "entropy": 0.5194522738456726, "vf_loss_unclipped": 27.039745330810547, "num_module_steps_trained_lifetime_throughput": 280617.4276987336}, "__all_modules__": {"num_module_steps_trained_lifetime": 84000, "learner_connector_sum_episodes_length_in": 5000.0, "learner_connector": {"timers": {"connectors": {"add_observations_from_episodes_to_batch": 0.0010974905619119, "add_columns_from_episodes_to_train_batch": 0.04758640198179469, "numpy_to_tensor": 8.272103166356378e-05, "add_time_dim_to_batch_and_zero_pad": 1.9162249449464815e-05, "add_states_from_episodes_to_batch": 3.857902708955951e-06, "general_advantage_estimation": 0.008915449567607932, "batch_individual_items": 0.05443336021459494, "add_one_ts_to_episodes_and_truncate": 0.015061622079604589}}, "connector_pipeline_timer": 0.127399459286881}, "num_non_trainable_parameters": 0, "num_env_steps_trained_lifetime": 441000, "num_trainable_parameters": 6003, "num_module_steps_trained": 6000, "num_env_steps_trained": 31500, "learner_connector_sum_episodes_length_out": 5250.0, "num_env_steps_trained_lifetime_throughput": 1465528.7691064223, "num_module_steps_trained_throughput": 280251.62644098874, "num_module_steps_trained_lifetime_throughput": 279812.29728132597}}, "num_training_step_calls_per_iteration": 1, "evaluation": {"env_runners": {"env_to_module_connector": {"timers": {"connectors": {"numpy_to_tensor": 1.2234279223660991e-05, "add_time_dim_to_batch_and_zero_pad": 2.847206092222403e-06, "add_states_from_episodes_to_batch": 1.8171086109994847e-06, "batch_individual_items": 8.2137318831324e-06, "add_observations_from_episodes_to_batch": 3.568101938973912e-06}}, "connector_pipeline_timer": 5.467143292247641e-05}, "num_env_steps_sampled": 400, "num_episodes": 20, "episode_duration_sec_mean": 0.00805447667138651, "num_agent_steps_sampled": {"default_agent": 400}, "module_to_env_connector": {"timers": {"connectors": {"un_batch_to_individual_items": 7.1466275242180074e-06, "listify_data_for_vector_env": 1.5242936877359235e-05, "remove_single_ts_time_rank_from_batch": 7.071613637068515e-07, "normalize_and_clip_actions": 1.2790123696646843e-05, "get_actions": 5.416526950283392e-05, "tensor_to_numpy": 1.814780122168655e-05}}, "connector_pipeline_timer": 0.0001409367102505167}, "sample": 0.241693054835589, "agent_episode_returns_mean": {"default_agent": 1.15}, "episode_return_min": -13.5, "env_step_timer": 1.9362527949076172e-05, "env_to_module_sum_episodes_length_in": 10.368238394574323, "env_to_module_sum_episodes_length_out": 10.368238394574323, "weights_seq_no": 14.0, "episode_len_min": 20, "episode_len_max": 20, "num_agent_steps_sampled_lifetime": {"default_agent": 5600}, "num_episodes_lifetime": 280, "num_module_steps_sampled_lifetime": {"default_policy": 5600}, "episode_len_mean": 20.0, "env_reset_timer": 0.0007086219424755619, "episode_return_max": 14.5, "module_episode_returns_mean": {"default_policy": 1.15}, "num_env_steps_sampled_lifetime": 70400, "rlmodule_inference_timer": 3.826324782292521e-05, "num_module_steps_sampled": {"default_policy": 400}, "episode_return_mean": 1.15, "time_between_sampling": 2.8226680796670585}, "num_healthy_workers": 1, "actor_manager_num_outstanding_async_reqs": 0, "num_remote_worker_restarts": 0}, "num_env_steps_sampled_lifetime": -7400000.0, "fault_tolerance": {"num_healthy_workers": 0, "num_remote_worker_restarts": 0}, "env_runner_group": {"actor_manager_num_outstanding_async_reqs": 0}, "done": false, "training_iteration": 14, "trial_id": "49f07_00000", "date": "2025-08-11_19-32-31", "timestamp": 1754933551, "time_this_iter_s": 3.13936185836792, "time_total_s": 48.75785708427429, "pid": 24465, "hostname": "Mac", "node_ip": "127.0.0.1", "config": {"exploration_config": {}, "extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "placement_strategy": "PACK", "num_gpus": 0, "_fake_gpus": false, "num_cpus_for_main_process": 2, "eager_tracing": true, "eager_max_retraces": 20, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "torch_compile_learner": false, "torch_compile_learner_what_to_compile": "forward_train", "torch_compile_learner_dynamo_backend": "aot_eager", "torch_compile_learner_dynamo_mode": null, "torch_compile_worker": false, "torch_compile_worker_dynamo_backend": "aot_eager", "torch_compile_worker_dynamo_mode": null, "torch_ddp_kwargs": {}, "torch_skip_nan_gradients": false, "env": "Umbrella", "env_config": {}, "observation_space": null, "action_space": null, "clip_rewards": null, "normalize_actions": true, "clip_actions": false, "_is_atari": null, "disable_env_checking": false, "render_env": false, "action_mask_key": "action_mask", "env_runner_cls": null, "num_env_runners": 0, "create_local_env_runner": true, "num_envs_per_env_runner": 1, "gym_env_vectorize_mode": "SYNC", "num_cpus_per_env_runner": 1, "num_gpus_per_env_runner": 0, "custom_resources_per_env_runner": {}, "validate_env_runners_after_construction": true, "episodes_to_numpy": true, "max_requests_in_flight_per_env_runner": 1, "sample_timeout_s": 60.0, "_env_to_module_connector": null, "add_default_connectors_to_env_to_module_pipeline": true, "_module_to_env_connector": null, "add_default_connectors_to_module_to_env_pipeline": true, "merge_env_runner_states": "training_only", "broadcast_env_runner_states": true, "episode_lookback_horizon": 1, "rollout_fragment_length": "auto", "batch_mode": "complete_episodes", "compress_observations": false, "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "enable_tf1_exec_eagerly": false, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "preprocessor_pref": "deepmind", "observation_filter": "NoFilter", "update_worker_filter_stats": true, "use_worker_filter_stats": true, "sampler_perf_stats_ema_coef": null, "_is_online": true, "num_learners": 0, "num_gpus_per_learner": 0, "num_cpus_per_learner": "auto", "num_aggregator_actors_per_learner": 0, "max_requests_in_flight_per_aggregator_actor": 3, "local_gpu_idx": 0, "max_requests_in_flight_per_learner": 3, "gamma": 1, "lr": 0.0002847858517, "grad_clip": 0.5, "grad_clip_by": "global_norm", "_train_batch_size_per_learner": 5000, "train_batch_size": 4000, "num_epochs": 1, "minibatch_size": 1000, "shuffle_batch_per_epoch": true, "model": {"fcnet_hiddens": [256, 256], "fcnet_activation": "tanh", "fcnet_weights_initializer": null, "fcnet_weights_initializer_config": null, "fcnet_bias_initializer": null, "fcnet_bias_initializer_config": null, "conv_filters": null, "conv_activation": "relu", "conv_kernel_initializer": null, "conv_kernel_initializer_config": null, "conv_bias_initializer": null, "conv_bias_initializer_config": null, "conv_transpose_kernel_initializer": null, "conv_transpose_kernel_initializer_config": null, "conv_transpose_bias_initializer": null, "conv_transpose_bias_initializer_config": null, "post_fcnet_hiddens": [], "post_fcnet_activation": "relu", "post_fcnet_weights_initializer": null, "post_fcnet_weights_initializer_config": null, "post_fcnet_bias_initializer": null, "post_fcnet_bias_initializer_config": null, "free_log_std": false, "log_std_clip_param": 20.0, "no_final_linear": false, "vf_share_layers": false, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "lstm_weights_initializer": null, "lstm_weights_initializer_config": null, "lstm_bias_initializer": null, "lstm_bias_initializer_config": null, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "attention_use_n_prev_actions": 0, "attention_use_n_prev_rewards": 0, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": null, "custom_model_config": {}, "custom_action_dist": null, "custom_preprocessor": null, "encoder_latent_dim": null, "always_check_shapes": false, "lstm_use_prev_action_reward": -1, "_use_default_native_models": -1, "_disable_preprocessor_api": false, "_disable_action_flattening": false}, "_learner_connector": null, "add_default_connectors_to_learner_pipeline": true, "learner_config_dict": {}, "optimizer": {}, "_learner_class": null, "callbacks_on_algorithm_init": null, "callbacks_on_env_runners_recreated": null, "callbacks_on_offline_eval_runners_recreated": null, "callbacks_on_checkpoint_loaded": null, "callbacks_on_environment_created": null, "callbacks_on_episode_created": null, "callbacks_on_episode_start": null, "callbacks_on_episode_step": null, "callbacks_on_episode_end": null, "callbacks_on_evaluate_start": null, "callbacks_on_evaluate_end": null, "callbacks_on_evaluate_offline_start": null, "callbacks_on_evaluate_offline_end": null, "callbacks_on_sample_end": null, "callbacks_on_train_result": null, "explore": true, "enable_rl_module_and_learner": true, "enable_env_runner_and_connector_v2": true, "_prior_exploration_config": {"type": "StochasticSampling"}, "count_steps_by": "env_steps", "policy_map_capacity": 100, "policy_mapping_fn": "<function AlgorithmConfig.DEFAULT_POLICY_MAPPING_FN at 0x388c81b20>", "policies_to_train": null, "policy_states_are_swappable": false, "observation_fn": null, "offline_data_class": null, "input_read_method": "read_parquet", "input_read_method_kwargs": {}, "input_read_schema": {}, "input_read_episodes": false, "input_read_sample_batches": false, "input_read_batch_size": null, "input_filesystem": null, "input_filesystem_kwargs": {}, "input_compress_columns": ["obs", "new_obs"], "input_spaces_jsonable": true, "materialize_data": false, "materialize_mapped_data": true, "map_batches_kwargs": {}, "iter_batches_kwargs": {}, "ignore_final_observation": false, "prelearner_class": null, "prelearner_buffer_class": null, "prelearner_buffer_kwargs": {}, "prelearner_module_synch_period": 10, "dataset_num_iters_per_learner": null, "input_config": {}, "actions_in_input_normalized": false, "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_config": {}, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "output_max_rows_per_file": null, "output_write_remaining_data": false, "output_write_method": "write_parquet", "output_write_method_kwargs": {}, "output_filesystem": null, "output_filesystem_kwargs": {}, "output_write_episodes": true, "offline_sampling": false, "evaluation_interval": 1, "evaluation_duration": 20, "evaluation_duration_unit": "episodes", "evaluation_sample_timeout_s": 120.0, "evaluation_auto_duration_min_env_steps_per_sample": 100, "evaluation_auto_duration_max_env_steps_per_sample": 2000, "evaluation_parallel_to_training": false, "evaluation_force_reset_envs_before_iteration": true, "evaluation_config": null, "off_policy_estimation_methods": {}, "ope_split_batch_by_episode": true, "evaluation_num_env_runners": 1, "in_evaluation": false, "sync_filters_on_rollout_workers_timeout_s": 10.0, "offline_evaluation_interval": null, "num_offline_eval_runners": 0, "offline_loss_for_module_fn": null, "offline_evaluation_duration": 1, "offline_evaluation_parallel_to_training": false, "offline_evaluation_timeout_s": 120.0, "num_cpus_per_offline_eval_runner": 1, "num_gpus_per_offline_eval_runner": 0, "custom_resources_per_offline_eval_runner": {}, "restart_failed_offline_eval_runners": true, "ignore_offline_eval_runner_failures": false, "max_num_offline_eval_runner_restarts": 1000, "offline_eval_runner_restore_timeout_s": 1800.0, "max_requests_in_flight_per_offline_eval_runner": 1, "validate_offline_eval_runners_after_construction": true, "offline_eval_runner_health_probe_timeout_s": 30.0, "offline_eval_rl_module_inference_only": false, "broadcast_offline_eval_runner_states": false, "offline_eval_batch_size_per_runner": 256, "dataset_num_iters_per_eval_runner": 1, "keep_per_episode_custom_metrics": false, "metrics_episode_collection_timeout_s": 60.0, "metrics_num_episodes_for_smoothing": 100, "min_time_s_per_iteration": null, "min_train_timesteps_per_iteration": 0, "min_sample_timesteps_per_iteration": 0, "log_gradients": true, "export_native_model_files": false, "checkpoint_trainable_policies_only": false, "logger_creator": null, "logger_config": null, "log_level": "WARN", "log_sys_usage": true, "fake_sampler": false, "seed": 8, "restart_failed_env_runners": true, "ignore_env_runner_failures": false, "max_num_env_runner_restarts": 1000, "delay_between_env_runner_restarts_s": 60.0, "restart_failed_sub_environments": false, "num_consecutive_env_runner_failures_tolerance": 100, "env_runner_health_probe_timeout_s": 30.0, "env_runner_restore_timeout_s": 1800.0, "_model_config": {}, "_rl_module_spec": "RLModuleSpec(module_class=None, observation_space=None, action_space=None, inference_only=False, learner_only=False, model_config=DefaultModelConfig(fcnet_hiddens=[60, 90], fcnet_activation='tanh', fcnet_kernel_initializer=None, fcnet_kernel_initializer_kwargs=None, fcnet_bias_initializer=None, fcnet_bias_initializer_kwargs=None, conv_filters=None, conv_activation='relu', conv_kernel_initializer=None, conv_kernel_initializer_kwargs=None, conv_bias_initializer=None, conv_bias_initializer_kwargs=None, head_fcnet_hiddens=[], head_fcnet_activation='relu', head_fcnet_kernel_initializer=None, head_fcnet_kernel_initializer_kwargs=None, head_fcnet_bias_initializer=None, head_fcnet_bias_initializer_kwargs=None, free_log_std=False, log_std_clip_param=20.0, vf_share_layers=True, use_lstm=False, max_seq_len=20, lstm_cell_size=256, lstm_use_prev_action=False, lstm_use_prev_reward=False, lstm_kernel_initializer=None, lstm_kernel_initializer_kwargs=None, lstm_bias_initializer=None, lstm_bias_initializer_kwargs=None), catalog_class=None, load_state_path=None, model_config_dict=None)", "algorithm_config_overrides_per_module": {}, "_per_module_overrides": {}, "_validate_config": true, "_use_msgpack_checkpoints": false, "_torch_grad_scaler_class": null, "_torch_lr_scheduler_classes": null, "_tf_policy_handles_more_than_one_loss": false, "_disable_preprocessor_api": false, "_disable_action_flattening": false, "_disable_initialize_loss_from_dummy_batch": false, "_dont_auto_sync_env_runner_states": false, "env_task_fn": -1, "enable_connectors": -1, "simple_optimizer": false, "policy_map_cache": -1, "worker_cls": -1, "synchronize_filters": -1, "enable_async_evaluation": -1, "custom_async_evaluation_function": -1, "_enable_rl_module_api": -1, "auto_wrap_old_gym_envs": -1, "always_attach_evaluation_results": -1, "replay_sequence_length": null, "_disable_execution_plan_api": -1, "use_critic": true, "use_gae": true, "use_kl_loss": true, "kl_coeff": 0.7464963036515, "kl_target": 0.0270990929592, "vf_loss_coeff": 0.6688075857018, "entropy_coeff": 0.0090570820258, "clip_param": 0.1221781641624, "vf_clip_param": 0.1027808522125, "entropy_coeff_schedule": null, "lr_schedule": null, "sgd_minibatch_size": -1, "vf_share_layers": -1, "__stdout_file__": null, "__stderr_file__": null, "lambda": 0.9099046732075, "input": "sampler", "policies": {"default_policy": [null, null, null, null]}, "callbacks": "<class 'ray.rllib.callbacks.callbacks.RLlibCallback'>", "create_env_on_driver": false, "custom_eval_function": null, "framework": "torch"}, "time_since_restore": 48.75785708427429, "iterations_since_restore": 14, "perf": {"cpu_util_percent": 77.52000000000001, "ram_util_percent": 80.8}}
{"timers": {"training_iteration": 4.6741979150383255, "restore_env_runners": 1.2896971094001029e-05, "training_step": 4.673975462702692, "env_runner_sampling_timer": 4.496865581707641, "learner_update_timer": 0.17227124697217489, "synch_weights": 0.0011175287209313142, "restore_eval_env_runners": 6.518914335814369e-05, "evaluation_iteration": 0.25765654084816597, "synch_eval_env_connectors": 0.00042794215209151506, "synch_env_connectors": 5.884914663562723e-06}, "env_runners": {"episode_duration_sec_mean": 0.008773102541919793, "rlmodule_inference_timer": 5.867174302216266e-05, "env_to_module_connector": {"timers": {"connectors": {"numpy_to_tensor": 1.7870449207737488e-05, "add_observations_from_episodes_to_batch": 5.399912894066032e-06, "add_time_dim_to_batch_and_zero_pad": 4.075102697543467e-06, "batch_individual_items": 1.2192515781272297e-05, "add_states_from_episodes_to_batch": 2.7214915197739716e-06}}, "connector_pipeline_timer": 7.680095786763636e-05}, "sample": 0.009339405974881811, "env_reset_timer": 8.959409385555963e-05, "module_episode_returns_mean": {"default_policy": 5.460000000000001}, "episode_len_min": 20, "episode_len_max": 20, "module_to_env_connector": {"timers": {"connectors": {"tensor_to_numpy": 2.5738142768222374e-05, "un_batch_to_individual_items": 9.25413342547271e-06, "remove_single_ts_time_rank_from_batch": 9.856577894080558e-07, "listify_data_for_vector_env": 2.109024068706354e-05, "normalize_and_clip_actions": 1.710028575398321e-05, "get_actions": 8.835295539861768e-05}}, "connector_pipeline_timer": 0.00020689123137844443}, "num_episodes_lifetime": -400875.0, "num_module_steps_sampled_lifetime": {"default_policy": -8017500.0}, "episode_return_mean": 5.460000000000001, "num_env_steps_sampled": 5000.0, "episode_return_min": -11.5, "env_to_module_sum_episodes_length_in": 10.36823839457432, "env_step_timer": 2.836433088499834e-05, "env_to_module_sum_episodes_length_out": 10.36823839457432, "weights_seq_no": 14.0, "num_episodes": 250.0, "num_agent_steps_sampled": {"default_agent": 5000.0}, "episode_return_max": 8.5, "time_between_sampling": 0.003048384099534915, "num_module_steps_sampled": {"default_policy": 5000.0}, "agent_episode_returns_mean": {"default_agent": 5.460000000000001}, "num_env_steps_sampled_lifetime": -8017500.0, "num_agent_steps_sampled_lifetime": {"default_agent": -8017500.0}, "episode_len_mean": 20.0, "num_env_steps_sampled_lifetime_throughput": 2188.122873080254}, "learners": {"default_policy": {"default_optimizer_learning_rate": 0.0002847858517, "curr_entropy_coeff": 0.0090570820258, "gradients_default_optimizer_global_norm": 0.0580829381942749, "policy_loss": -0.10267102718353271, "num_module_steps_trained_lifetime": 90000, "diff_num_grad_updates_vs_sampler_policy": 1.0, "mean_kl_loss": 0.0002160034200642258, "weights_seq_no": 15.0, "curr_kl_coeff": 2.2781259758630767e-05, "num_trainable_parameters": 6003, "num_module_steps_trained": 6000, "total_loss": -0.03857382386922836, "vf_explained_var": 0.005217373371124268, "module_train_batch_size_mean": 1000.0, "vf_loss": 0.10278083384037018, "entropy": 0.512681782245636, "vf_loss_unclipped": 26.506343841552734, "num_module_steps_trained_lifetime_throughput": 276112.8181726064}, "__all_modules__": {"num_module_steps_trained_lifetime": 90000, "learner_connector_sum_episodes_length_in": 5000.0, "learner_connector": {"timers": {"connectors": {"add_observations_from_episodes_to_batch": 0.0011055623170382976, "add_columns_from_episodes_to_train_batch": 0.04754671630185484, "numpy_to_tensor": 8.265590165497806e-05, "add_time_dim_to_batch_and_zero_pad": 1.9090626704556152e-05, "add_states_from_episodes_to_batch": 3.853073647817239e-06, "general_advantage_estimation": 0.008882901322514115, "batch_individual_items": 0.055556637443076366, "add_one_ts_to_episodes_and_truncate": 0.01504912169860841}}, "connector_pipeline_timer": 0.12844528469456942}, "num_non_trainable_parameters": 0, "num_env_steps_trained_lifetime": 472500, "num_trainable_parameters": 6003, "num_module_steps_trained": 6000, "num_env_steps_trained": 31500, "learner_connector_sum_episodes_length_out": 5250.0, "num_env_steps_trained_lifetime_throughput": 1442390.3046807686, "num_module_steps_trained_throughput": 275782.55250150076, "num_module_steps_trained_lifetime_throughput": 275367.4029187318}}, "num_training_step_calls_per_iteration": 1, "evaluation": {"env_runners": {"env_to_module_connector": {"timers": {"connectors": {"numpy_to_tensor": 1.3493295082202096e-05, "add_time_dim_to_batch_and_zero_pad": 3.3126907384200925e-06, "add_states_from_episodes_to_batch": 2.056367816714364e-06, "batch_individual_items": 9.118585326804881e-06, "add_observations_from_episodes_to_batch": 4.235162146834074e-06}}, "connector_pipeline_timer": 6.0583000007484647e-05}, "num_env_steps_sampled": 400, "num_episodes": 20, "episode_duration_sec_mean": 0.00804751625051722, "num_agent_steps_sampled": {"default_agent": 400}, "module_to_env_connector": {"timers": {"connectors": {"un_batch_to_individual_items": 8.37477987709442e-06, "listify_data_for_vector_env": 1.7783745262000454e-05, "remove_single_ts_time_rank_from_batch": 9.741876296444833e-07, "normalize_and_clip_actions": 1.3681339812085964e-05, "get_actions": 5.9233464047968224e-05, "tensor_to_numpy": 2.402206756999119e-05}}, "connector_pipeline_timer": 0.0001623514207545385}, "sample": 0.2408822392863914, "agent_episode_returns_mean": {"default_agent": 0.95}, "episode_return_min": -14.5, "env_step_timer": 2.2310371803946028e-05, "env_to_module_sum_episodes_length_in": 10.368238394574323, "env_to_module_sum_episodes_length_out": 10.368238394574323, "weights_seq_no": 15.0, "episode_len_min": 20, "episode_len_max": 20, "num_agent_steps_sampled_lifetime": {"default_agent": 6000}, "num_episodes_lifetime": 300, "num_module_steps_sampled_lifetime": {"default_policy": 6000}, "episode_len_mean": 20.0, "env_reset_timer": 0.0007023298920781646, "episode_return_max": 14.5, "module_episode_returns_mean": {"default_policy": 0.95}, "num_env_steps_sampled_lifetime": 75400, "rlmodule_inference_timer": 4.352980071497992e-05, "num_module_steps_sampled": {"default_policy": 400}, "episode_return_mean": 0.95, "time_between_sampling": 2.8240097663695476}, "num_healthy_workers": 1, "actor_manager_num_outstanding_async_reqs": 0, "num_remote_worker_restarts": 0}, "num_env_steps_sampled_lifetime": -8017500.0, "fault_tolerance": {"num_healthy_workers": 0, "num_remote_worker_restarts": 0}, "env_runner_group": {"actor_manager_num_outstanding_async_reqs": 0}, "done": false, "training_iteration": 15, "trial_id": "49f07_00000", "date": "2025-08-11_19-32-34", "timestamp": 1754933554, "time_this_iter_s": 3.0991322994232178, "time_total_s": 51.85698938369751, "pid": 24465, "hostname": "Mac", "node_ip": "127.0.0.1", "config": {"exploration_config": {}, "extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "placement_strategy": "PACK", "num_gpus": 0, "_fake_gpus": false, "num_cpus_for_main_process": 2, "eager_tracing": true, "eager_max_retraces": 20, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "torch_compile_learner": false, "torch_compile_learner_what_to_compile": "forward_train", "torch_compile_learner_dynamo_backend": "aot_eager", "torch_compile_learner_dynamo_mode": null, "torch_compile_worker": false, "torch_compile_worker_dynamo_backend": "aot_eager", "torch_compile_worker_dynamo_mode": null, "torch_ddp_kwargs": {}, "torch_skip_nan_gradients": false, "env": "Umbrella", "env_config": {}, "observation_space": null, "action_space": null, "clip_rewards": null, "normalize_actions": true, "clip_actions": false, "_is_atari": null, "disable_env_checking": false, "render_env": false, "action_mask_key": "action_mask", "env_runner_cls": null, "num_env_runners": 0, "create_local_env_runner": true, "num_envs_per_env_runner": 1, "gym_env_vectorize_mode": "SYNC", "num_cpus_per_env_runner": 1, "num_gpus_per_env_runner": 0, "custom_resources_per_env_runner": {}, "validate_env_runners_after_construction": true, "episodes_to_numpy": true, "max_requests_in_flight_per_env_runner": 1, "sample_timeout_s": 60.0, "_env_to_module_connector": null, "add_default_connectors_to_env_to_module_pipeline": true, "_module_to_env_connector": null, "add_default_connectors_to_module_to_env_pipeline": true, "merge_env_runner_states": "training_only", "broadcast_env_runner_states": true, "episode_lookback_horizon": 1, "rollout_fragment_length": "auto", "batch_mode": "complete_episodes", "compress_observations": false, "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "enable_tf1_exec_eagerly": false, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "preprocessor_pref": "deepmind", "observation_filter": "NoFilter", "update_worker_filter_stats": true, "use_worker_filter_stats": true, "sampler_perf_stats_ema_coef": null, "_is_online": true, "num_learners": 0, "num_gpus_per_learner": 0, "num_cpus_per_learner": "auto", "num_aggregator_actors_per_learner": 0, "max_requests_in_flight_per_aggregator_actor": 3, "local_gpu_idx": 0, "max_requests_in_flight_per_learner": 3, "gamma": 1, "lr": 0.0002847858517, "grad_clip": 0.5, "grad_clip_by": "global_norm", "_train_batch_size_per_learner": 5000, "train_batch_size": 4000, "num_epochs": 1, "minibatch_size": 1000, "shuffle_batch_per_epoch": true, "model": {"fcnet_hiddens": [256, 256], "fcnet_activation": "tanh", "fcnet_weights_initializer": null, "fcnet_weights_initializer_config": null, "fcnet_bias_initializer": null, "fcnet_bias_initializer_config": null, "conv_filters": null, "conv_activation": "relu", "conv_kernel_initializer": null, "conv_kernel_initializer_config": null, "conv_bias_initializer": null, "conv_bias_initializer_config": null, "conv_transpose_kernel_initializer": null, "conv_transpose_kernel_initializer_config": null, "conv_transpose_bias_initializer": null, "conv_transpose_bias_initializer_config": null, "post_fcnet_hiddens": [], "post_fcnet_activation": "relu", "post_fcnet_weights_initializer": null, "post_fcnet_weights_initializer_config": null, "post_fcnet_bias_initializer": null, "post_fcnet_bias_initializer_config": null, "free_log_std": false, "log_std_clip_param": 20.0, "no_final_linear": false, "vf_share_layers": false, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "lstm_weights_initializer": null, "lstm_weights_initializer_config": null, "lstm_bias_initializer": null, "lstm_bias_initializer_config": null, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "attention_use_n_prev_actions": 0, "attention_use_n_prev_rewards": 0, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": null, "custom_model_config": {}, "custom_action_dist": null, "custom_preprocessor": null, "encoder_latent_dim": null, "always_check_shapes": false, "lstm_use_prev_action_reward": -1, "_use_default_native_models": -1, "_disable_preprocessor_api": false, "_disable_action_flattening": false}, "_learner_connector": null, "add_default_connectors_to_learner_pipeline": true, "learner_config_dict": {}, "optimizer": {}, "_learner_class": null, "callbacks_on_algorithm_init": null, "callbacks_on_env_runners_recreated": null, "callbacks_on_offline_eval_runners_recreated": null, "callbacks_on_checkpoint_loaded": null, "callbacks_on_environment_created": null, "callbacks_on_episode_created": null, "callbacks_on_episode_start": null, "callbacks_on_episode_step": null, "callbacks_on_episode_end": null, "callbacks_on_evaluate_start": null, "callbacks_on_evaluate_end": null, "callbacks_on_evaluate_offline_start": null, "callbacks_on_evaluate_offline_end": null, "callbacks_on_sample_end": null, "callbacks_on_train_result": null, "explore": true, "enable_rl_module_and_learner": true, "enable_env_runner_and_connector_v2": true, "_prior_exploration_config": {"type": "StochasticSampling"}, "count_steps_by": "env_steps", "policy_map_capacity": 100, "policy_mapping_fn": "<function AlgorithmConfig.DEFAULT_POLICY_MAPPING_FN at 0x388c81b20>", "policies_to_train": null, "policy_states_are_swappable": false, "observation_fn": null, "offline_data_class": null, "input_read_method": "read_parquet", "input_read_method_kwargs": {}, "input_read_schema": {}, "input_read_episodes": false, "input_read_sample_batches": false, "input_read_batch_size": null, "input_filesystem": null, "input_filesystem_kwargs": {}, "input_compress_columns": ["obs", "new_obs"], "input_spaces_jsonable": true, "materialize_data": false, "materialize_mapped_data": true, "map_batches_kwargs": {}, "iter_batches_kwargs": {}, "ignore_final_observation": false, "prelearner_class": null, "prelearner_buffer_class": null, "prelearner_buffer_kwargs": {}, "prelearner_module_synch_period": 10, "dataset_num_iters_per_learner": null, "input_config": {}, "actions_in_input_normalized": false, "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_config": {}, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "output_max_rows_per_file": null, "output_write_remaining_data": false, "output_write_method": "write_parquet", "output_write_method_kwargs": {}, "output_filesystem": null, "output_filesystem_kwargs": {}, "output_write_episodes": true, "offline_sampling": false, "evaluation_interval": 1, "evaluation_duration": 20, "evaluation_duration_unit": "episodes", "evaluation_sample_timeout_s": 120.0, "evaluation_auto_duration_min_env_steps_per_sample": 100, "evaluation_auto_duration_max_env_steps_per_sample": 2000, "evaluation_parallel_to_training": false, "evaluation_force_reset_envs_before_iteration": true, "evaluation_config": null, "off_policy_estimation_methods": {}, "ope_split_batch_by_episode": true, "evaluation_num_env_runners": 1, "in_evaluation": false, "sync_filters_on_rollout_workers_timeout_s": 10.0, "offline_evaluation_interval": null, "num_offline_eval_runners": 0, "offline_loss_for_module_fn": null, "offline_evaluation_duration": 1, "offline_evaluation_parallel_to_training": false, "offline_evaluation_timeout_s": 120.0, "num_cpus_per_offline_eval_runner": 1, "num_gpus_per_offline_eval_runner": 0, "custom_resources_per_offline_eval_runner": {}, "restart_failed_offline_eval_runners": true, "ignore_offline_eval_runner_failures": false, "max_num_offline_eval_runner_restarts": 1000, "offline_eval_runner_restore_timeout_s": 1800.0, "max_requests_in_flight_per_offline_eval_runner": 1, "validate_offline_eval_runners_after_construction": true, "offline_eval_runner_health_probe_timeout_s": 30.0, "offline_eval_rl_module_inference_only": false, "broadcast_offline_eval_runner_states": false, "offline_eval_batch_size_per_runner": 256, "dataset_num_iters_per_eval_runner": 1, "keep_per_episode_custom_metrics": false, "metrics_episode_collection_timeout_s": 60.0, "metrics_num_episodes_for_smoothing": 100, "min_time_s_per_iteration": null, "min_train_timesteps_per_iteration": 0, "min_sample_timesteps_per_iteration": 0, "log_gradients": true, "export_native_model_files": false, "checkpoint_trainable_policies_only": false, "logger_creator": null, "logger_config": null, "log_level": "WARN", "log_sys_usage": true, "fake_sampler": false, "seed": 8, "restart_failed_env_runners": true, "ignore_env_runner_failures": false, "max_num_env_runner_restarts": 1000, "delay_between_env_runner_restarts_s": 60.0, "restart_failed_sub_environments": false, "num_consecutive_env_runner_failures_tolerance": 100, "env_runner_health_probe_timeout_s": 30.0, "env_runner_restore_timeout_s": 1800.0, "_model_config": {}, "_rl_module_spec": "RLModuleSpec(module_class=None, observation_space=None, action_space=None, inference_only=False, learner_only=False, model_config=DefaultModelConfig(fcnet_hiddens=[60, 90], fcnet_activation='tanh', fcnet_kernel_initializer=None, fcnet_kernel_initializer_kwargs=None, fcnet_bias_initializer=None, fcnet_bias_initializer_kwargs=None, conv_filters=None, conv_activation='relu', conv_kernel_initializer=None, conv_kernel_initializer_kwargs=None, conv_bias_initializer=None, conv_bias_initializer_kwargs=None, head_fcnet_hiddens=[], head_fcnet_activation='relu', head_fcnet_kernel_initializer=None, head_fcnet_kernel_initializer_kwargs=None, head_fcnet_bias_initializer=None, head_fcnet_bias_initializer_kwargs=None, free_log_std=False, log_std_clip_param=20.0, vf_share_layers=True, use_lstm=False, max_seq_len=20, lstm_cell_size=256, lstm_use_prev_action=False, lstm_use_prev_reward=False, lstm_kernel_initializer=None, lstm_kernel_initializer_kwargs=None, lstm_bias_initializer=None, lstm_bias_initializer_kwargs=None), catalog_class=None, load_state_path=None, model_config_dict=None)", "algorithm_config_overrides_per_module": {}, "_per_module_overrides": {}, "_validate_config": true, "_use_msgpack_checkpoints": false, "_torch_grad_scaler_class": null, "_torch_lr_scheduler_classes": null, "_tf_policy_handles_more_than_one_loss": false, "_disable_preprocessor_api": false, "_disable_action_flattening": false, "_disable_initialize_loss_from_dummy_batch": false, "_dont_auto_sync_env_runner_states": false, "env_task_fn": -1, "enable_connectors": -1, "simple_optimizer": false, "policy_map_cache": -1, "worker_cls": -1, "synchronize_filters": -1, "enable_async_evaluation": -1, "custom_async_evaluation_function": -1, "_enable_rl_module_api": -1, "auto_wrap_old_gym_envs": -1, "always_attach_evaluation_results": -1, "replay_sequence_length": null, "_disable_execution_plan_api": -1, "use_critic": true, "use_gae": true, "use_kl_loss": true, "kl_coeff": 0.7464963036515, "kl_target": 0.0270990929592, "vf_loss_coeff": 0.6688075857018, "entropy_coeff": 0.0090570820258, "clip_param": 0.1221781641624, "vf_clip_param": 0.1027808522125, "entropy_coeff_schedule": null, "lr_schedule": null, "sgd_minibatch_size": -1, "vf_share_layers": -1, "__stdout_file__": null, "__stderr_file__": null, "lambda": 0.9099046732075, "input": "sampler", "policies": {"default_policy": [null, null, null, null]}, "callbacks": "<class 'ray.rllib.callbacks.callbacks.RLlibCallback'>", "create_env_on_driver": false, "custom_eval_function": null, "framework": "torch"}, "time_since_restore": 51.85698938369751, "iterations_since_restore": 15, "perf": {"cpu_util_percent": 77.425, "ram_util_percent": 80.675}}
{"timers": {"training_iteration": 4.6539706496369995, "restore_env_runners": 1.2831751577446667e-05, "training_step": 4.653747278075522, "env_runner_sampling_timer": 4.476652101310415, "learner_update_timer": 0.17223544284206904, "synch_weights": 0.0011164571835317878, "restore_eval_env_runners": 6.461517219192067e-05, "evaluation_iteration": 0.25676510543979875, "synch_eval_env_connectors": 0.000424756900718153, "synch_env_connectors": 5.875235856407138e-06}, "env_runners": {"episode_duration_sec_mean": 0.008324926838278773, "rlmodule_inference_timer": 5.3258386453603165e-05, "env_to_module_connector": {"timers": {"connectors": {"numpy_to_tensor": 1.6839904980613335e-05, "add_observations_from_episodes_to_batch": 4.973601637159986e-06, "add_time_dim_to_batch_and_zero_pad": 4.0479685676491805e-06, "batch_individual_items": 1.1433934913866815e-05, "add_states_from_episodes_to_batch": 2.6120722387008353e-06}}, "connector_pipeline_timer": 7.429456772267962e-05}, "sample": 0.00902400546755393, "env_reset_timer": 7.70033178364484e-05, "module_episode_returns_mean": {"default_policy": 5.619999999999999}, "episode_len_min": 20, "episode_len_max": 20, "module_to_env_connector": {"timers": {"connectors": {"tensor_to_numpy": 2.4457763081962022e-05, "un_batch_to_individual_items": 8.96301433746574e-06, "remove_single_ts_time_rank_from_batch": 9.483494616026283e-07, "listify_data_for_vector_env": 1.9747649559611396e-05, "normalize_and_clip_actions": 1.647892316151039e-05, "get_actions": 8.043093262274493e-05}}, "connector_pipeline_timer": 0.00019376756294161297}, "num_episodes_lifetime": -431750.0, "num_module_steps_sampled_lifetime": {"default_policy": -8635000.0}, "episode_return_mean": 5.619999999999999, "num_env_steps_sampled": 5000.0, "episode_return_min": -11.5, "env_to_module_sum_episodes_length_in": 10.36823839457432, "env_step_timer": 2.669724328759398e-05, "env_to_module_sum_episodes_length_out": 10.36823839457432, "weights_seq_no": 15.0, "num_episodes": 250.0, "num_agent_steps_sampled": {"default_agent": 5000.0}, "episode_return_max": 8.5, "time_between_sampling": 0.003040638317159984, "num_module_steps_sampled": {"default_policy": 5000.0}, "agent_episode_returns_mean": {"default_agent": 5.619999999999999}, "num_env_steps_sampled_lifetime": -8635000.0, "num_agent_steps_sampled_lifetime": {"default_agent": -8635000.0}, "episode_len_mean": 20.0, "num_env_steps_sampled_lifetime_throughput": 2384.8803450736928}, "learners": {"default_policy": {"default_optimizer_learning_rate": 0.0002847858517, "curr_entropy_coeff": 0.0090570820258, "gradients_default_optimizer_global_norm": 0.03795118257403374, "policy_loss": -0.2068527191877365, "num_module_steps_trained_lifetime": 96000, "diff_num_grad_updates_vs_sampler_policy": 1.0, "mean_kl_loss": 0.00046676889178343117, "weights_seq_no": 16.0, "curr_kl_coeff": 1.1390629879315384e-05, "num_trainable_parameters": 6003, "num_module_steps_trained": 6000, "total_loss": -0.1426362693309784, "vf_explained_var": 0.004887521266937256, "module_train_batch_size_mean": 1000.0, "vf_loss": 0.10278083384037018, "entropy": 0.49951738119125366, "vf_loss_unclipped": 26.065872192382812, "num_module_steps_trained_lifetime_throughput": 270521.44697112753}, "__all_modules__": {"num_module_steps_trained_lifetime": 96000, "learner_connector_sum_episodes_length_in": 5000.0, "learner_connector": {"timers": {"connectors": {"add_observations_from_episodes_to_batch": 0.0011030904437452035, "add_columns_from_episodes_to_train_batch": 0.047491134968160195, "numpy_to_tensor": 8.298351324285097e-05, "add_time_dim_to_batch_and_zero_pad": 1.9128469559981206e-05, "add_states_from_episodes_to_batch": 3.862883209574483e-06, "general_advantage_estimation": 0.008875015648560443, "batch_individual_items": 0.05540173939890336, "add_one_ts_to_episodes_and_truncate": 0.014997657980713204}}, "connector_pipeline_timer": 0.1281727264373794}, "num_non_trainable_parameters": 0, "num_env_steps_trained_lifetime": 504000, "num_trainable_parameters": 6003, "num_module_steps_trained": 6000, "num_env_steps_trained": 31500, "learner_connector_sum_episodes_length_out": 5250.0, "num_env_steps_trained_lifetime_throughput": 1413530.115572916, "num_module_steps_trained_throughput": 270220.82649880165, "num_module_steps_trained_lifetime_throughput": 269830.3220814092}}, "num_training_step_calls_per_iteration": 1, "evaluation": {"env_runners": {"env_to_module_connector": {"timers": {"connectors": {"numpy_to_tensor": 1.263011479479929e-05, "add_time_dim_to_batch_and_zero_pad": 2.777893170529505e-06, "add_states_from_episodes_to_batch": 2.22684869512063e-06, "batch_individual_items": 8.19012952475969e-06, "add_observations_from_episodes_to_batch": 3.995419608672249e-06}}, "connector_pipeline_timer": 5.6223003656893236e-05}, "num_env_steps_sampled": 400, "num_episodes": 20, "episode_duration_sec_mean": 0.007582949172938242, "num_agent_steps_sampled": {"default_agent": 400}, "module_to_env_connector": {"timers": {"connectors": {"un_batch_to_individual_items": 7.26385741389041e-06, "listify_data_for_vector_env": 1.5495354911142064e-05, "remove_single_ts_time_rank_from_batch": 1.266657905480369e-06, "normalize_and_clip_actions": 1.2749973978871299e-05, "get_actions": 5.4774939459465856e-05, "tensor_to_numpy": 1.7631021588016884e-05}}, "connector_pipeline_timer": 0.00014352357447964688}, "sample": 0.24026736898419318, "agent_episode_returns_mean": {"default_agent": 0.95}, "episode_return_min": -14.5, "env_step_timer": 1.919153723936778e-05, "env_to_module_sum_episodes_length_in": 10.368238394574323, "env_to_module_sum_episodes_length_out": 10.368238394574323, "weights_seq_no": 16.0, "episode_len_min": 20, "episode_len_max": 20, "num_agent_steps_sampled_lifetime": {"default_agent": 6400}, "num_episodes_lifetime": 320, "num_module_steps_sampled_lifetime": {"default_policy": 6400}, "episode_len_mean": 20.0, "env_reset_timer": 0.000696747012740033, "episode_return_max": 14.5, "module_episode_returns_mean": {"default_policy": 0.95}, "num_env_steps_sampled_lifetime": 80400, "rlmodule_inference_timer": 3.938034939539129e-05, "num_module_steps_sampled": {"default_policy": 400}, "episode_return_mean": 0.95, "time_between_sampling": 2.822596469955842}, "num_healthy_workers": 1, "actor_manager_num_outstanding_async_reqs": 0, "num_remote_worker_restarts": 0}, "num_env_steps_sampled_lifetime": -8635000.0, "fault_tolerance": {"num_healthy_workers": 0, "num_remote_worker_restarts": 0}, "env_runner_group": {"actor_manager_num_outstanding_async_reqs": 0}, "done": false, "training_iteration": 16, "trial_id": "49f07_00000", "date": "2025-08-11_19-32-37", "timestamp": 1754933557, "time_this_iter_s": 2.8430521488189697, "time_total_s": 54.70004153251648, "pid": 24465, "hostname": "Mac", "node_ip": "127.0.0.1", "config": {"exploration_config": {}, "extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "placement_strategy": "PACK", "num_gpus": 0, "_fake_gpus": false, "num_cpus_for_main_process": 2, "eager_tracing": true, "eager_max_retraces": 20, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "torch_compile_learner": false, "torch_compile_learner_what_to_compile": "forward_train", "torch_compile_learner_dynamo_backend": "aot_eager", "torch_compile_learner_dynamo_mode": null, "torch_compile_worker": false, "torch_compile_worker_dynamo_backend": "aot_eager", "torch_compile_worker_dynamo_mode": null, "torch_ddp_kwargs": {}, "torch_skip_nan_gradients": false, "env": "Umbrella", "env_config": {}, "observation_space": null, "action_space": null, "clip_rewards": null, "normalize_actions": true, "clip_actions": false, "_is_atari": null, "disable_env_checking": false, "render_env": false, "action_mask_key": "action_mask", "env_runner_cls": null, "num_env_runners": 0, "create_local_env_runner": true, "num_envs_per_env_runner": 1, "gym_env_vectorize_mode": "SYNC", "num_cpus_per_env_runner": 1, "num_gpus_per_env_runner": 0, "custom_resources_per_env_runner": {}, "validate_env_runners_after_construction": true, "episodes_to_numpy": true, "max_requests_in_flight_per_env_runner": 1, "sample_timeout_s": 60.0, "_env_to_module_connector": null, "add_default_connectors_to_env_to_module_pipeline": true, "_module_to_env_connector": null, "add_default_connectors_to_module_to_env_pipeline": true, "merge_env_runner_states": "training_only", "broadcast_env_runner_states": true, "episode_lookback_horizon": 1, "rollout_fragment_length": "auto", "batch_mode": "complete_episodes", "compress_observations": false, "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "enable_tf1_exec_eagerly": false, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "preprocessor_pref": "deepmind", "observation_filter": "NoFilter", "update_worker_filter_stats": true, "use_worker_filter_stats": true, "sampler_perf_stats_ema_coef": null, "_is_online": true, "num_learners": 0, "num_gpus_per_learner": 0, "num_cpus_per_learner": "auto", "num_aggregator_actors_per_learner": 0, "max_requests_in_flight_per_aggregator_actor": 3, "local_gpu_idx": 0, "max_requests_in_flight_per_learner": 3, "gamma": 1, "lr": 0.0002847858517, "grad_clip": 0.5, "grad_clip_by": "global_norm", "_train_batch_size_per_learner": 5000, "train_batch_size": 4000, "num_epochs": 1, "minibatch_size": 1000, "shuffle_batch_per_epoch": true, "model": {"fcnet_hiddens": [256, 256], "fcnet_activation": "tanh", "fcnet_weights_initializer": null, "fcnet_weights_initializer_config": null, "fcnet_bias_initializer": null, "fcnet_bias_initializer_config": null, "conv_filters": null, "conv_activation": "relu", "conv_kernel_initializer": null, "conv_kernel_initializer_config": null, "conv_bias_initializer": null, "conv_bias_initializer_config": null, "conv_transpose_kernel_initializer": null, "conv_transpose_kernel_initializer_config": null, "conv_transpose_bias_initializer": null, "conv_transpose_bias_initializer_config": null, "post_fcnet_hiddens": [], "post_fcnet_activation": "relu", "post_fcnet_weights_initializer": null, "post_fcnet_weights_initializer_config": null, "post_fcnet_bias_initializer": null, "post_fcnet_bias_initializer_config": null, "free_log_std": false, "log_std_clip_param": 20.0, "no_final_linear": false, "vf_share_layers": false, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "lstm_weights_initializer": null, "lstm_weights_initializer_config": null, "lstm_bias_initializer": null, "lstm_bias_initializer_config": null, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "attention_use_n_prev_actions": 0, "attention_use_n_prev_rewards": 0, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": null, "custom_model_config": {}, "custom_action_dist": null, "custom_preprocessor": null, "encoder_latent_dim": null, "always_check_shapes": false, "lstm_use_prev_action_reward": -1, "_use_default_native_models": -1, "_disable_preprocessor_api": false, "_disable_action_flattening": false}, "_learner_connector": null, "add_default_connectors_to_learner_pipeline": true, "learner_config_dict": {}, "optimizer": {}, "_learner_class": null, "callbacks_on_algorithm_init": null, "callbacks_on_env_runners_recreated": null, "callbacks_on_offline_eval_runners_recreated": null, "callbacks_on_checkpoint_loaded": null, "callbacks_on_environment_created": null, "callbacks_on_episode_created": null, "callbacks_on_episode_start": null, "callbacks_on_episode_step": null, "callbacks_on_episode_end": null, "callbacks_on_evaluate_start": null, "callbacks_on_evaluate_end": null, "callbacks_on_evaluate_offline_start": null, "callbacks_on_evaluate_offline_end": null, "callbacks_on_sample_end": null, "callbacks_on_train_result": null, "explore": true, "enable_rl_module_and_learner": true, "enable_env_runner_and_connector_v2": true, "_prior_exploration_config": {"type": "StochasticSampling"}, "count_steps_by": "env_steps", "policy_map_capacity": 100, "policy_mapping_fn": "<function AlgorithmConfig.DEFAULT_POLICY_MAPPING_FN at 0x388c81b20>", "policies_to_train": null, "policy_states_are_swappable": false, "observation_fn": null, "offline_data_class": null, "input_read_method": "read_parquet", "input_read_method_kwargs": {}, "input_read_schema": {}, "input_read_episodes": false, "input_read_sample_batches": false, "input_read_batch_size": null, "input_filesystem": null, "input_filesystem_kwargs": {}, "input_compress_columns": ["obs", "new_obs"], "input_spaces_jsonable": true, "materialize_data": false, "materialize_mapped_data": true, "map_batches_kwargs": {}, "iter_batches_kwargs": {}, "ignore_final_observation": false, "prelearner_class": null, "prelearner_buffer_class": null, "prelearner_buffer_kwargs": {}, "prelearner_module_synch_period": 10, "dataset_num_iters_per_learner": null, "input_config": {}, "actions_in_input_normalized": false, "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_config": {}, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "output_max_rows_per_file": null, "output_write_remaining_data": false, "output_write_method": "write_parquet", "output_write_method_kwargs": {}, "output_filesystem": null, "output_filesystem_kwargs": {}, "output_write_episodes": true, "offline_sampling": false, "evaluation_interval": 1, "evaluation_duration": 20, "evaluation_duration_unit": "episodes", "evaluation_sample_timeout_s": 120.0, "evaluation_auto_duration_min_env_steps_per_sample": 100, "evaluation_auto_duration_max_env_steps_per_sample": 2000, "evaluation_parallel_to_training": false, "evaluation_force_reset_envs_before_iteration": true, "evaluation_config": null, "off_policy_estimation_methods": {}, "ope_split_batch_by_episode": true, "evaluation_num_env_runners": 1, "in_evaluation": false, "sync_filters_on_rollout_workers_timeout_s": 10.0, "offline_evaluation_interval": null, "num_offline_eval_runners": 0, "offline_loss_for_module_fn": null, "offline_evaluation_duration": 1, "offline_evaluation_parallel_to_training": false, "offline_evaluation_timeout_s": 120.0, "num_cpus_per_offline_eval_runner": 1, "num_gpus_per_offline_eval_runner": 0, "custom_resources_per_offline_eval_runner": {}, "restart_failed_offline_eval_runners": true, "ignore_offline_eval_runner_failures": false, "max_num_offline_eval_runner_restarts": 1000, "offline_eval_runner_restore_timeout_s": 1800.0, "max_requests_in_flight_per_offline_eval_runner": 1, "validate_offline_eval_runners_after_construction": true, "offline_eval_runner_health_probe_timeout_s": 30.0, "offline_eval_rl_module_inference_only": false, "broadcast_offline_eval_runner_states": false, "offline_eval_batch_size_per_runner": 256, "dataset_num_iters_per_eval_runner": 1, "keep_per_episode_custom_metrics": false, "metrics_episode_collection_timeout_s": 60.0, "metrics_num_episodes_for_smoothing": 100, "min_time_s_per_iteration": null, "min_train_timesteps_per_iteration": 0, "min_sample_timesteps_per_iteration": 0, "log_gradients": true, "export_native_model_files": false, "checkpoint_trainable_policies_only": false, "logger_creator": null, "logger_config": null, "log_level": "WARN", "log_sys_usage": true, "fake_sampler": false, "seed": 8, "restart_failed_env_runners": true, "ignore_env_runner_failures": false, "max_num_env_runner_restarts": 1000, "delay_between_env_runner_restarts_s": 60.0, "restart_failed_sub_environments": false, "num_consecutive_env_runner_failures_tolerance": 100, "env_runner_health_probe_timeout_s": 30.0, "env_runner_restore_timeout_s": 1800.0, "_model_config": {}, "_rl_module_spec": "RLModuleSpec(module_class=None, observation_space=None, action_space=None, inference_only=False, learner_only=False, model_config=DefaultModelConfig(fcnet_hiddens=[60, 90], fcnet_activation='tanh', fcnet_kernel_initializer=None, fcnet_kernel_initializer_kwargs=None, fcnet_bias_initializer=None, fcnet_bias_initializer_kwargs=None, conv_filters=None, conv_activation='relu', conv_kernel_initializer=None, conv_kernel_initializer_kwargs=None, conv_bias_initializer=None, conv_bias_initializer_kwargs=None, head_fcnet_hiddens=[], head_fcnet_activation='relu', head_fcnet_kernel_initializer=None, head_fcnet_kernel_initializer_kwargs=None, head_fcnet_bias_initializer=None, head_fcnet_bias_initializer_kwargs=None, free_log_std=False, log_std_clip_param=20.0, vf_share_layers=True, use_lstm=False, max_seq_len=20, lstm_cell_size=256, lstm_use_prev_action=False, lstm_use_prev_reward=False, lstm_kernel_initializer=None, lstm_kernel_initializer_kwargs=None, lstm_bias_initializer=None, lstm_bias_initializer_kwargs=None), catalog_class=None, load_state_path=None, model_config_dict=None)", "algorithm_config_overrides_per_module": {}, "_per_module_overrides": {}, "_validate_config": true, "_use_msgpack_checkpoints": false, "_torch_grad_scaler_class": null, "_torch_lr_scheduler_classes": null, "_tf_policy_handles_more_than_one_loss": false, "_disable_preprocessor_api": false, "_disable_action_flattening": false, "_disable_initialize_loss_from_dummy_batch": false, "_dont_auto_sync_env_runner_states": false, "env_task_fn": -1, "enable_connectors": -1, "simple_optimizer": false, "policy_map_cache": -1, "worker_cls": -1, "synchronize_filters": -1, "enable_async_evaluation": -1, "custom_async_evaluation_function": -1, "_enable_rl_module_api": -1, "auto_wrap_old_gym_envs": -1, "always_attach_evaluation_results": -1, "replay_sequence_length": null, "_disable_execution_plan_api": -1, "use_critic": true, "use_gae": true, "use_kl_loss": true, "kl_coeff": 0.7464963036515, "kl_target": 0.0270990929592, "vf_loss_coeff": 0.6688075857018, "entropy_coeff": 0.0090570820258, "clip_param": 0.1221781641624, "vf_clip_param": 0.1027808522125, "entropy_coeff_schedule": null, "lr_schedule": null, "sgd_minibatch_size": -1, "vf_share_layers": -1, "__stdout_file__": null, "__stderr_file__": null, "lambda": 0.9099046732075, "input": "sampler", "policies": {"default_policy": [null, null, null, null]}, "callbacks": "<class 'ray.rllib.callbacks.callbacks.RLlibCallback'>", "create_env_on_driver": false, "custom_eval_function": null, "framework": "torch"}, "time_since_restore": 54.70004153251648, "iterations_since_restore": 16, "perf": {"cpu_util_percent": 75.89999999999999, "ram_util_percent": 80.275}}
{"timers": {"training_iteration": 4.644175719810287, "restore_env_runners": 1.2771354252885688e-05, "training_step": 4.643952391544951, "env_runner_sampling_timer": 4.467314702387884, "learner_update_timer": 0.17177454508412074, "synch_weights": 0.0011173134506090464, "restore_eval_env_runners": 6.4340271259614e-05, "evaluation_iteration": 0.2560638568857098, "synch_eval_env_connectors": 0.00042340100215781435, "synch_env_connectors": 5.863153236210266e-06}, "env_runners": {"episode_duration_sec_mean": 0.012264354175422345, "rlmodule_inference_timer": 0.00011768494382471781, "env_to_module_connector": {"timers": {"connectors": {"numpy_to_tensor": 2.2347390801364846e-05, "add_observations_from_episodes_to_batch": 6.226873300976134e-06, "add_time_dim_to_batch_and_zero_pad": 4.927947826916409e-06, "batch_individual_items": 1.3822433905918375e-05, "add_states_from_episodes_to_batch": 3.0726524425250587e-06}}, "connector_pipeline_timer": 8.957090403980586e-05}, "sample": 0.010815716004382622, "env_reset_timer": 8.385017208029865e-05, "module_episode_returns_mean": {"default_policy": 7.139999999999999}, "episode_len_min": 20, "episode_len_max": 20, "module_to_env_connector": {"timers": {"connectors": {"tensor_to_numpy": 3.048203220310875e-05, "un_batch_to_individual_items": 1.430067555463476e-05, "remove_single_ts_time_rank_from_batch": 1.368759860341546e-06, "listify_data_for_vector_env": 2.4122286357537248e-05, "normalize_and_clip_actions": 1.9756462093971078e-05, "get_actions": 0.00011363437618955485}}, "connector_pipeline_timer": 0.00026420108696357267}, "num_episodes_lifetime": -462625.0, "num_module_steps_sampled_lifetime": {"default_policy": -9252500.0}, "episode_return_mean": 7.139999999999999, "num_env_steps_sampled": 5000.0, "episode_return_min": -11.5, "env_to_module_sum_episodes_length_in": 10.36823839457432, "env_step_timer": 3.2910197307094696e-05, "env_to_module_sum_episodes_length_out": 10.36823839457432, "weights_seq_no": 16.0, "num_episodes": 250.0, "num_agent_steps_sampled": {"default_agent": 5000.0}, "episode_return_max": 8.5, "time_between_sampling": 0.002687804137424443, "num_module_steps_sampled": {"default_policy": 5000.0}, "agent_episode_returns_mean": {"default_agent": 7.139999999999999}, "num_env_steps_sampled_lifetime": -9252500.0, "num_agent_steps_sampled_lifetime": {"default_agent": -9252500.0}, "episode_len_mean": 20.0, "num_env_steps_sampled_lifetime_throughput": 2088.7240047757787}, "learners": {"default_policy": {"default_optimizer_learning_rate": 0.0002847858517, "curr_entropy_coeff": 0.0090570820258, "gradients_default_optimizer_global_norm": 0.10882989317178726, "policy_loss": -0.1093665286898613, "num_module_steps_trained_lifetime": 102000, "diff_num_grad_updates_vs_sampler_policy": 1.0, "mean_kl_loss": 0.0006145501974970102, "weights_seq_no": 17.0, "curr_kl_coeff": 5.695314939657692e-06, "num_trainable_parameters": 6003, "num_module_steps_trained": 6000, "total_loss": -0.044959671795368195, "vf_explained_var": 0.004864335060119629, "module_train_batch_size_mean": 1000.0, "vf_loss": 0.10278083384037018, "entropy": 0.4784937798976898, "vf_loss_unclipped": 25.952669143676758, "num_module_steps_trained_lifetime_throughput": 266609.1858161544}, "__all_modules__": {"num_module_steps_trained_lifetime": 102000, "learner_connector_sum_episodes_length_in": 5000.0, "learner_connector": {"timers": {"connectors": {"add_observations_from_episodes_to_batch": 0.0011052057895836465, "add_columns_from_episodes_to_train_batch": 0.04744175861887362, "numpy_to_tensor": 8.291659777294276e-05, "add_time_dim_to_batch_and_zero_pad": 1.9127594928914745e-05, "add_states_from_episodes_to_batch": 4.024674995535989e-06, "general_advantage_estimation": 0.008888169242403186, "batch_individual_items": 0.05525631741532278, "add_one_ts_to_episodes_and_truncate": 0.014933800980988668}}, "connector_pipeline_timer": 0.1279294854227505}, "num_non_trainable_parameters": 0, "num_env_steps_trained_lifetime": 535500, "num_trainable_parameters": 6003, "num_module_steps_trained": 6000, "num_env_steps_trained": 31500, "learner_connector_sum_episodes_length_out": 5250.0, "num_env_steps_trained_lifetime_throughput": 1393432.6257750911, "num_module_steps_trained_throughput": 266334.62086895254, "num_module_steps_trained_lifetime_throughput": 265964.9732557933}}, "num_training_step_calls_per_iteration": 1, "evaluation": {"env_runners": {"env_to_module_connector": {"timers": {"connectors": {"numpy_to_tensor": 2.3620397905671266e-05, "add_time_dim_to_batch_and_zero_pad": 5.198341017859817e-06, "add_states_from_episodes_to_batch": 2.5192202470090474e-06, "batch_individual_items": 1.397779433020181e-05, "add_observations_from_episodes_to_batch": 5.737105429399913e-06}}, "connector_pipeline_timer": 9.353518059396238e-05}, "num_env_steps_sampled": 400, "num_episodes": 20, "episode_duration_sec_mean": 0.008082617522450163, "num_agent_steps_sampled": {"default_agent": 400}, "module_to_env_connector": {"timers": {"connectors": {"un_batch_to_individual_items": 1.018678473687957e-05, "listify_data_for_vector_env": 2.260486918386905e-05, "remove_single_ts_time_rank_from_batch": 1.0208572020769479e-06, "normalize_and_clip_actions": 1.7726162489179036e-05, "get_actions": 9.975294191825334e-05, "tensor_to_numpy": 3.259060865297651e-05}}, "connector_pipeline_timer": 0.00023670490520631584}, "sample": 0.23973432113468734, "agent_episode_returns_mean": {"default_agent": 1.15}, "episode_return_min": -14.5, "env_step_timer": 3.253627989180578e-05, "env_to_module_sum_episodes_length_in": 10.368238394574323, "env_to_module_sum_episodes_length_out": 10.368238394574323, "weights_seq_no": 17.0, "episode_len_min": 20, "episode_len_max": 20, "num_agent_steps_sampled_lifetime": {"default_agent": 6800}, "num_episodes_lifetime": 340, "num_module_steps_sampled_lifetime": {"default_policy": 6800}, "episode_len_mean": 20.0, "env_reset_timer": 0.0006912620428416636, "episode_return_max": 14.5, "module_episode_returns_mean": {"default_policy": 1.15}, "num_env_steps_sampled_lifetime": 85400, "rlmodule_inference_timer": 6.341666037689545e-05, "num_module_steps_sampled": {"default_policy": 400}, "episode_return_mean": 1.15, "time_between_sampling": 2.8314110269264168}, "num_healthy_workers": 1, "actor_manager_num_outstanding_async_reqs": 0, "num_remote_worker_restarts": 0}, "num_env_steps_sampled_lifetime": -9252500.0, "fault_tolerance": {"num_healthy_workers": 0, "num_remote_worker_restarts": 0}, "env_runner_group": {"actor_manager_num_outstanding_async_reqs": 0}, "done": false, "training_iteration": 17, "trial_id": "49f07_00000", "date": "2025-08-11_19-32-40", "timestamp": 1754933560, "time_this_iter_s": 3.8764851093292236, "time_total_s": 58.5765266418457, "pid": 24465, "hostname": "Mac", "node_ip": "127.0.0.1", "config": {"exploration_config": {}, "extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "placement_strategy": "PACK", "num_gpus": 0, "_fake_gpus": false, "num_cpus_for_main_process": 2, "eager_tracing": true, "eager_max_retraces": 20, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "torch_compile_learner": false, "torch_compile_learner_what_to_compile": "forward_train", "torch_compile_learner_dynamo_backend": "aot_eager", "torch_compile_learner_dynamo_mode": null, "torch_compile_worker": false, "torch_compile_worker_dynamo_backend": "aot_eager", "torch_compile_worker_dynamo_mode": null, "torch_ddp_kwargs": {}, "torch_skip_nan_gradients": false, "env": "Umbrella", "env_config": {}, "observation_space": null, "action_space": null, "clip_rewards": null, "normalize_actions": true, "clip_actions": false, "_is_atari": null, "disable_env_checking": false, "render_env": false, "action_mask_key": "action_mask", "env_runner_cls": null, "num_env_runners": 0, "create_local_env_runner": true, "num_envs_per_env_runner": 1, "gym_env_vectorize_mode": "SYNC", "num_cpus_per_env_runner": 1, "num_gpus_per_env_runner": 0, "custom_resources_per_env_runner": {}, "validate_env_runners_after_construction": true, "episodes_to_numpy": true, "max_requests_in_flight_per_env_runner": 1, "sample_timeout_s": 60.0, "_env_to_module_connector": null, "add_default_connectors_to_env_to_module_pipeline": true, "_module_to_env_connector": null, "add_default_connectors_to_module_to_env_pipeline": true, "merge_env_runner_states": "training_only", "broadcast_env_runner_states": true, "episode_lookback_horizon": 1, "rollout_fragment_length": "auto", "batch_mode": "complete_episodes", "compress_observations": false, "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "enable_tf1_exec_eagerly": false, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "preprocessor_pref": "deepmind", "observation_filter": "NoFilter", "update_worker_filter_stats": true, "use_worker_filter_stats": true, "sampler_perf_stats_ema_coef": null, "_is_online": true, "num_learners": 0, "num_gpus_per_learner": 0, "num_cpus_per_learner": "auto", "num_aggregator_actors_per_learner": 0, "max_requests_in_flight_per_aggregator_actor": 3, "local_gpu_idx": 0, "max_requests_in_flight_per_learner": 3, "gamma": 1, "lr": 0.0002847858517, "grad_clip": 0.5, "grad_clip_by": "global_norm", "_train_batch_size_per_learner": 5000, "train_batch_size": 4000, "num_epochs": 1, "minibatch_size": 1000, "shuffle_batch_per_epoch": true, "model": {"fcnet_hiddens": [256, 256], "fcnet_activation": "tanh", "fcnet_weights_initializer": null, "fcnet_weights_initializer_config": null, "fcnet_bias_initializer": null, "fcnet_bias_initializer_config": null, "conv_filters": null, "conv_activation": "relu", "conv_kernel_initializer": null, "conv_kernel_initializer_config": null, "conv_bias_initializer": null, "conv_bias_initializer_config": null, "conv_transpose_kernel_initializer": null, "conv_transpose_kernel_initializer_config": null, "conv_transpose_bias_initializer": null, "conv_transpose_bias_initializer_config": null, "post_fcnet_hiddens": [], "post_fcnet_activation": "relu", "post_fcnet_weights_initializer": null, "post_fcnet_weights_initializer_config": null, "post_fcnet_bias_initializer": null, "post_fcnet_bias_initializer_config": null, "free_log_std": false, "log_std_clip_param": 20.0, "no_final_linear": false, "vf_share_layers": false, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "lstm_weights_initializer": null, "lstm_weights_initializer_config": null, "lstm_bias_initializer": null, "lstm_bias_initializer_config": null, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "attention_use_n_prev_actions": 0, "attention_use_n_prev_rewards": 0, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": null, "custom_model_config": {}, "custom_action_dist": null, "custom_preprocessor": null, "encoder_latent_dim": null, "always_check_shapes": false, "lstm_use_prev_action_reward": -1, "_use_default_native_models": -1, "_disable_preprocessor_api": false, "_disable_action_flattening": false}, "_learner_connector": null, "add_default_connectors_to_learner_pipeline": true, "learner_config_dict": {}, "optimizer": {}, "_learner_class": null, "callbacks_on_algorithm_init": null, "callbacks_on_env_runners_recreated": null, "callbacks_on_offline_eval_runners_recreated": null, "callbacks_on_checkpoint_loaded": null, "callbacks_on_environment_created": null, "callbacks_on_episode_created": null, "callbacks_on_episode_start": null, "callbacks_on_episode_step": null, "callbacks_on_episode_end": null, "callbacks_on_evaluate_start": null, "callbacks_on_evaluate_end": null, "callbacks_on_evaluate_offline_start": null, "callbacks_on_evaluate_offline_end": null, "callbacks_on_sample_end": null, "callbacks_on_train_result": null, "explore": true, "enable_rl_module_and_learner": true, "enable_env_runner_and_connector_v2": true, "_prior_exploration_config": {"type": "StochasticSampling"}, "count_steps_by": "env_steps", "policy_map_capacity": 100, "policy_mapping_fn": "<function AlgorithmConfig.DEFAULT_POLICY_MAPPING_FN at 0x388c81b20>", "policies_to_train": null, "policy_states_are_swappable": false, "observation_fn": null, "offline_data_class": null, "input_read_method": "read_parquet", "input_read_method_kwargs": {}, "input_read_schema": {}, "input_read_episodes": false, "input_read_sample_batches": false, "input_read_batch_size": null, "input_filesystem": null, "input_filesystem_kwargs": {}, "input_compress_columns": ["obs", "new_obs"], "input_spaces_jsonable": true, "materialize_data": false, "materialize_mapped_data": true, "map_batches_kwargs": {}, "iter_batches_kwargs": {}, "ignore_final_observation": false, "prelearner_class": null, "prelearner_buffer_class": null, "prelearner_buffer_kwargs": {}, "prelearner_module_synch_period": 10, "dataset_num_iters_per_learner": null, "input_config": {}, "actions_in_input_normalized": false, "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_config": {}, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "output_max_rows_per_file": null, "output_write_remaining_data": false, "output_write_method": "write_parquet", "output_write_method_kwargs": {}, "output_filesystem": null, "output_filesystem_kwargs": {}, "output_write_episodes": true, "offline_sampling": false, "evaluation_interval": 1, "evaluation_duration": 20, "evaluation_duration_unit": "episodes", "evaluation_sample_timeout_s": 120.0, "evaluation_auto_duration_min_env_steps_per_sample": 100, "evaluation_auto_duration_max_env_steps_per_sample": 2000, "evaluation_parallel_to_training": false, "evaluation_force_reset_envs_before_iteration": true, "evaluation_config": null, "off_policy_estimation_methods": {}, "ope_split_batch_by_episode": true, "evaluation_num_env_runners": 1, "in_evaluation": false, "sync_filters_on_rollout_workers_timeout_s": 10.0, "offline_evaluation_interval": null, "num_offline_eval_runners": 0, "offline_loss_for_module_fn": null, "offline_evaluation_duration": 1, "offline_evaluation_parallel_to_training": false, "offline_evaluation_timeout_s": 120.0, "num_cpus_per_offline_eval_runner": 1, "num_gpus_per_offline_eval_runner": 0, "custom_resources_per_offline_eval_runner": {}, "restart_failed_offline_eval_runners": true, "ignore_offline_eval_runner_failures": false, "max_num_offline_eval_runner_restarts": 1000, "offline_eval_runner_restore_timeout_s": 1800.0, "max_requests_in_flight_per_offline_eval_runner": 1, "validate_offline_eval_runners_after_construction": true, "offline_eval_runner_health_probe_timeout_s": 30.0, "offline_eval_rl_module_inference_only": false, "broadcast_offline_eval_runner_states": false, "offline_eval_batch_size_per_runner": 256, "dataset_num_iters_per_eval_runner": 1, "keep_per_episode_custom_metrics": false, "metrics_episode_collection_timeout_s": 60.0, "metrics_num_episodes_for_smoothing": 100, "min_time_s_per_iteration": null, "min_train_timesteps_per_iteration": 0, "min_sample_timesteps_per_iteration": 0, "log_gradients": true, "export_native_model_files": false, "checkpoint_trainable_policies_only": false, "logger_creator": null, "logger_config": null, "log_level": "WARN", "log_sys_usage": true, "fake_sampler": false, "seed": 8, "restart_failed_env_runners": true, "ignore_env_runner_failures": false, "max_num_env_runner_restarts": 1000, "delay_between_env_runner_restarts_s": 60.0, "restart_failed_sub_environments": false, "num_consecutive_env_runner_failures_tolerance": 100, "env_runner_health_probe_timeout_s": 30.0, "env_runner_restore_timeout_s": 1800.0, "_model_config": {}, "_rl_module_spec": "RLModuleSpec(module_class=None, observation_space=None, action_space=None, inference_only=False, learner_only=False, model_config=DefaultModelConfig(fcnet_hiddens=[60, 90], fcnet_activation='tanh', fcnet_kernel_initializer=None, fcnet_kernel_initializer_kwargs=None, fcnet_bias_initializer=None, fcnet_bias_initializer_kwargs=None, conv_filters=None, conv_activation='relu', conv_kernel_initializer=None, conv_kernel_initializer_kwargs=None, conv_bias_initializer=None, conv_bias_initializer_kwargs=None, head_fcnet_hiddens=[], head_fcnet_activation='relu', head_fcnet_kernel_initializer=None, head_fcnet_kernel_initializer_kwargs=None, head_fcnet_bias_initializer=None, head_fcnet_bias_initializer_kwargs=None, free_log_std=False, log_std_clip_param=20.0, vf_share_layers=True, use_lstm=False, max_seq_len=20, lstm_cell_size=256, lstm_use_prev_action=False, lstm_use_prev_reward=False, lstm_kernel_initializer=None, lstm_kernel_initializer_kwargs=None, lstm_bias_initializer=None, lstm_bias_initializer_kwargs=None), catalog_class=None, load_state_path=None, model_config_dict=None)", "algorithm_config_overrides_per_module": {}, "_per_module_overrides": {}, "_validate_config": true, "_use_msgpack_checkpoints": false, "_torch_grad_scaler_class": null, "_torch_lr_scheduler_classes": null, "_tf_policy_handles_more_than_one_loss": false, "_disable_preprocessor_api": false, "_disable_action_flattening": false, "_disable_initialize_loss_from_dummy_batch": false, "_dont_auto_sync_env_runner_states": false, "env_task_fn": -1, "enable_connectors": -1, "simple_optimizer": false, "policy_map_cache": -1, "worker_cls": -1, "synchronize_filters": -1, "enable_async_evaluation": -1, "custom_async_evaluation_function": -1, "_enable_rl_module_api": -1, "auto_wrap_old_gym_envs": -1, "always_attach_evaluation_results": -1, "replay_sequence_length": null, "_disable_execution_plan_api": -1, "use_critic": true, "use_gae": true, "use_kl_loss": true, "kl_coeff": 0.7464963036515, "kl_target": 0.0270990929592, "vf_loss_coeff": 0.6688075857018, "entropy_coeff": 0.0090570820258, "clip_param": 0.1221781641624, "vf_clip_param": 0.1027808522125, "entropy_coeff_schedule": null, "lr_schedule": null, "sgd_minibatch_size": -1, "vf_share_layers": -1, "__stdout_file__": null, "__stderr_file__": null, "lambda": 0.9099046732075, "input": "sampler", "policies": {"default_policy": [null, null, null, null]}, "callbacks": "<class 'ray.rllib.callbacks.callbacks.RLlibCallback'>", "create_env_on_driver": false, "custom_eval_function": null, "framework": "torch"}, "time_since_restore": 58.5765266418457, "iterations_since_restore": 17, "perf": {"cpu_util_percent": 70.75, "ram_util_percent": 81.25}}
{"timers": {"training_iteration": 4.629985570952486, "restore_env_runners": 1.2713641243371367e-05, "training_step": 4.629760750960067, "env_runner_sampling_timer": 4.449896017864574, "learner_update_timer": 0.17499891546260574, "synch_weights": 0.0011192611459291768, "restore_eval_env_runners": 6.391769909929781e-05, "evaluation_iteration": 0.2554958533161857, "synch_eval_env_connectors": 0.00043045741221584, "synch_env_connectors": 5.8495220465003654e-06}, "env_runners": {"episode_duration_sec_mean": 0.009004126347601416, "rlmodule_inference_timer": 6.0595550178472264e-05, "env_to_module_connector": {"timers": {"connectors": {"numpy_to_tensor": 1.7839417368182265e-05, "add_observations_from_episodes_to_batch": 5.6011581741151185e-06, "add_time_dim_to_batch_and_zero_pad": 4.275945388173163e-06, "batch_individual_items": 1.1861165300925004e-05, "add_states_from_episodes_to_batch": 3.319941441484303e-06}}, "connector_pipeline_timer": 7.868150721778264e-05}, "sample": 0.011566895539227495, "env_reset_timer": 8.563260995299424e-05, "module_episode_returns_mean": {"default_policy": 7.2200000000000015}, "episode_len_min": 20, "episode_len_max": 20, "module_to_env_connector": {"timers": {"connectors": {"tensor_to_numpy": 3.114404385474252e-05, "un_batch_to_individual_items": 8.873029016737897e-06, "remove_single_ts_time_rank_from_batch": 1.0487862087865874e-06, "listify_data_for_vector_env": 2.0578640102020225e-05, "normalize_and_clip_actions": 1.654314362277288e-05, "get_actions": 8.799387691519027e-05}}, "connector_pipeline_timer": 0.00020980474195091543}, "num_episodes_lifetime": -493500.0, "num_module_steps_sampled_lifetime": {"default_policy": -9870000.0}, "episode_return_mean": 7.2200000000000015, "num_env_steps_sampled": 5000.0, "episode_return_min": -11.5, "env_to_module_sum_episodes_length_in": 10.36823839457432, "env_step_timer": 3.170401984359701e-05, "env_to_module_sum_episodes_length_out": 10.36823839457432, "weights_seq_no": 17.0, "num_episodes": 250.0, "num_agent_steps_sampled": {"default_agent": 5000.0}, "episode_return_max": 8.5, "time_between_sampling": 0.002627981068365087, "num_module_steps_sampled": {"default_policy": 5000.0}, "agent_episode_returns_mean": {"default_agent": 7.2200000000000015}, "num_env_steps_sampled_lifetime": -9870000.0, "num_agent_steps_sampled_lifetime": {"default_agent": -9870000.0}, "episode_len_mean": 20.0, "num_env_steps_sampled_lifetime_throughput": 2220.7519377204817}, "learners": {"default_policy": {"default_optimizer_learning_rate": 0.0002847858517, "curr_entropy_coeff": 0.0090570820258, "gradients_default_optimizer_global_norm": 0.0484977550804615, "policy_loss": -0.044139228761196136, "num_module_steps_trained_lifetime": 108000, "diff_num_grad_updates_vs_sampler_policy": 1.0, "mean_kl_loss": 3.0231125492719002e-05, "weights_seq_no": 18.0, "curr_kl_coeff": 2.847657469828846e-06, "num_trainable_parameters": 6003, "num_module_steps_trained": 6000, "total_loss": 0.0203655194491148, "vf_explained_var": 0.005313515663146973, "module_train_batch_size_mean": 1000.0, "vf_loss": 0.10278083384037018, "entropy": 0.46768543124198914, "vf_loss_unclipped": 26.084064483642578, "num_module_steps_trained_lifetime_throughput": 263721.3107377964}, "__all_modules__": {"num_module_steps_trained_lifetime": 108000, "learner_connector_sum_episodes_length_in": 5000.0, "learner_connector": {"timers": {"connectors": {"add_observations_from_episodes_to_batch": 0.0011203724819690694, "add_columns_from_episodes_to_train_batch": 0.04747903228282473, "numpy_to_tensor": 8.893410092524062e-05, "add_time_dim_to_batch_and_zero_pad": 3.803340851425101e-05, "add_states_from_episodes_to_batch": 4.735678436240986e-06, "general_advantage_estimation": 0.0088681283896464, "batch_individual_items": 0.058480851320606785, "add_one_ts_to_episodes_and_truncate": 0.015080770471863415}}, "connector_pipeline_timer": 0.1313621689085788}, "num_non_trainable_parameters": 0, "num_env_steps_trained_lifetime": 567000, "num_trainable_parameters": 6003, "num_module_steps_trained": 6000, "num_env_steps_trained": 31500, "learner_connector_sum_episodes_length_out": 5250.0, "num_env_steps_trained_lifetime_throughput": 1378693.5492894435, "num_module_steps_trained_throughput": 263476.56098324765, "num_module_steps_trained_lifetime_throughput": 263124.8276730838}}, "num_training_step_calls_per_iteration": 1, "evaluation": {"env_runners": {"env_to_module_connector": {"timers": {"connectors": {"numpy_to_tensor": 1.3353620483552138e-05, "add_time_dim_to_batch_and_zero_pad": 3.320702170985233e-06, "add_states_from_episodes_to_batch": 2.1634293854398118e-06, "batch_individual_items": 1.0088904182285216e-05, "add_observations_from_episodes_to_batch": 3.849022403566126e-06}}, "connector_pipeline_timer": 6.146555623786151e-05}, "num_env_steps_sampled": 400, "num_episodes": 20, "episode_duration_sec_mean": 0.007628288338892162, "num_agent_steps_sampled": {"default_agent": 400}, "module_to_env_connector": {"timers": {"connectors": {"un_batch_to_individual_items": 7.570951156171965e-06, "listify_data_for_vector_env": 1.7463727003668704e-05, "remove_single_ts_time_rank_from_batch": 7.861680983934779e-07, "normalize_and_clip_actions": 1.514591602989831e-05, "get_actions": 6.467686642197284e-05, "tensor_to_numpy": 2.154481566960106e-05}}, "connector_pipeline_timer": 0.00016513685002931923}, "sample": 0.23882370125321237, "agent_episode_returns_mean": {"default_agent": 1.75}, "episode_return_min": -14.5, "env_step_timer": 2.2900342812134912e-05, "env_to_module_sum_episodes_length_in": 10.368238394574323, "env_to_module_sum_episodes_length_out": 10.368238394574323, "weights_seq_no": 18.0, "episode_len_min": 20, "episode_len_max": 20, "num_agent_steps_sampled_lifetime": {"default_agent": 7200}, "num_episodes_lifetime": 360, "num_module_steps_sampled_lifetime": {"default_policy": 7200}, "episode_len_mean": 20.0, "env_reset_timer": 0.0006852331718665978, "episode_return_max": 14.5, "module_episode_returns_mean": {"default_policy": 1.75}, "num_env_steps_sampled_lifetime": 90400, "rlmodule_inference_timer": 4.814160129098708e-05, "num_module_steps_sampled": {"default_policy": 400}, "episode_return_mean": 1.75, "time_between_sampling": 2.8357476337477348}, "num_healthy_workers": 1, "actor_manager_num_outstanding_async_reqs": 0, "num_remote_worker_restarts": 0}, "num_env_steps_sampled_lifetime": -9870000.0, "fault_tolerance": {"num_healthy_workers": 0, "num_remote_worker_restarts": 0}, "env_runner_group": {"actor_manager_num_outstanding_async_reqs": 0}, "done": false, "training_iteration": 18, "trial_id": "49f07_00000", "date": "2025-08-11_19-32-44", "timestamp": 1754933564, "time_this_iter_s": 3.384207248687744, "time_total_s": 61.96073389053345, "pid": 24465, "hostname": "Mac", "node_ip": "127.0.0.1", "config": {"exploration_config": {}, "extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "placement_strategy": "PACK", "num_gpus": 0, "_fake_gpus": false, "num_cpus_for_main_process": 2, "eager_tracing": true, "eager_max_retraces": 20, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "torch_compile_learner": false, "torch_compile_learner_what_to_compile": "forward_train", "torch_compile_learner_dynamo_backend": "aot_eager", "torch_compile_learner_dynamo_mode": null, "torch_compile_worker": false, "torch_compile_worker_dynamo_backend": "aot_eager", "torch_compile_worker_dynamo_mode": null, "torch_ddp_kwargs": {}, "torch_skip_nan_gradients": false, "env": "Umbrella", "env_config": {}, "observation_space": null, "action_space": null, "clip_rewards": null, "normalize_actions": true, "clip_actions": false, "_is_atari": null, "disable_env_checking": false, "render_env": false, "action_mask_key": "action_mask", "env_runner_cls": null, "num_env_runners": 0, "create_local_env_runner": true, "num_envs_per_env_runner": 1, "gym_env_vectorize_mode": "SYNC", "num_cpus_per_env_runner": 1, "num_gpus_per_env_runner": 0, "custom_resources_per_env_runner": {}, "validate_env_runners_after_construction": true, "episodes_to_numpy": true, "max_requests_in_flight_per_env_runner": 1, "sample_timeout_s": 60.0, "_env_to_module_connector": null, "add_default_connectors_to_env_to_module_pipeline": true, "_module_to_env_connector": null, "add_default_connectors_to_module_to_env_pipeline": true, "merge_env_runner_states": "training_only", "broadcast_env_runner_states": true, "episode_lookback_horizon": 1, "rollout_fragment_length": "auto", "batch_mode": "complete_episodes", "compress_observations": false, "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "enable_tf1_exec_eagerly": false, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "preprocessor_pref": "deepmind", "observation_filter": "NoFilter", "update_worker_filter_stats": true, "use_worker_filter_stats": true, "sampler_perf_stats_ema_coef": null, "_is_online": true, "num_learners": 0, "num_gpus_per_learner": 0, "num_cpus_per_learner": "auto", "num_aggregator_actors_per_learner": 0, "max_requests_in_flight_per_aggregator_actor": 3, "local_gpu_idx": 0, "max_requests_in_flight_per_learner": 3, "gamma": 1, "lr": 0.0002847858517, "grad_clip": 0.5, "grad_clip_by": "global_norm", "_train_batch_size_per_learner": 5000, "train_batch_size": 4000, "num_epochs": 1, "minibatch_size": 1000, "shuffle_batch_per_epoch": true, "model": {"fcnet_hiddens": [256, 256], "fcnet_activation": "tanh", "fcnet_weights_initializer": null, "fcnet_weights_initializer_config": null, "fcnet_bias_initializer": null, "fcnet_bias_initializer_config": null, "conv_filters": null, "conv_activation": "relu", "conv_kernel_initializer": null, "conv_kernel_initializer_config": null, "conv_bias_initializer": null, "conv_bias_initializer_config": null, "conv_transpose_kernel_initializer": null, "conv_transpose_kernel_initializer_config": null, "conv_transpose_bias_initializer": null, "conv_transpose_bias_initializer_config": null, "post_fcnet_hiddens": [], "post_fcnet_activation": "relu", "post_fcnet_weights_initializer": null, "post_fcnet_weights_initializer_config": null, "post_fcnet_bias_initializer": null, "post_fcnet_bias_initializer_config": null, "free_log_std": false, "log_std_clip_param": 20.0, "no_final_linear": false, "vf_share_layers": false, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "lstm_weights_initializer": null, "lstm_weights_initializer_config": null, "lstm_bias_initializer": null, "lstm_bias_initializer_config": null, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "attention_use_n_prev_actions": 0, "attention_use_n_prev_rewards": 0, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": null, "custom_model_config": {}, "custom_action_dist": null, "custom_preprocessor": null, "encoder_latent_dim": null, "always_check_shapes": false, "lstm_use_prev_action_reward": -1, "_use_default_native_models": -1, "_disable_preprocessor_api": false, "_disable_action_flattening": false}, "_learner_connector": null, "add_default_connectors_to_learner_pipeline": true, "learner_config_dict": {}, "optimizer": {}, "_learner_class": null, "callbacks_on_algorithm_init": null, "callbacks_on_env_runners_recreated": null, "callbacks_on_offline_eval_runners_recreated": null, "callbacks_on_checkpoint_loaded": null, "callbacks_on_environment_created": null, "callbacks_on_episode_created": null, "callbacks_on_episode_start": null, "callbacks_on_episode_step": null, "callbacks_on_episode_end": null, "callbacks_on_evaluate_start": null, "callbacks_on_evaluate_end": null, "callbacks_on_evaluate_offline_start": null, "callbacks_on_evaluate_offline_end": null, "callbacks_on_sample_end": null, "callbacks_on_train_result": null, "explore": true, "enable_rl_module_and_learner": true, "enable_env_runner_and_connector_v2": true, "_prior_exploration_config": {"type": "StochasticSampling"}, "count_steps_by": "env_steps", "policy_map_capacity": 100, "policy_mapping_fn": "<function AlgorithmConfig.DEFAULT_POLICY_MAPPING_FN at 0x388c81b20>", "policies_to_train": null, "policy_states_are_swappable": false, "observation_fn": null, "offline_data_class": null, "input_read_method": "read_parquet", "input_read_method_kwargs": {}, "input_read_schema": {}, "input_read_episodes": false, "input_read_sample_batches": false, "input_read_batch_size": null, "input_filesystem": null, "input_filesystem_kwargs": {}, "input_compress_columns": ["obs", "new_obs"], "input_spaces_jsonable": true, "materialize_data": false, "materialize_mapped_data": true, "map_batches_kwargs": {}, "iter_batches_kwargs": {}, "ignore_final_observation": false, "prelearner_class": null, "prelearner_buffer_class": null, "prelearner_buffer_kwargs": {}, "prelearner_module_synch_period": 10, "dataset_num_iters_per_learner": null, "input_config": {}, "actions_in_input_normalized": false, "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_config": {}, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "output_max_rows_per_file": null, "output_write_remaining_data": false, "output_write_method": "write_parquet", "output_write_method_kwargs": {}, "output_filesystem": null, "output_filesystem_kwargs": {}, "output_write_episodes": true, "offline_sampling": false, "evaluation_interval": 1, "evaluation_duration": 20, "evaluation_duration_unit": "episodes", "evaluation_sample_timeout_s": 120.0, "evaluation_auto_duration_min_env_steps_per_sample": 100, "evaluation_auto_duration_max_env_steps_per_sample": 2000, "evaluation_parallel_to_training": false, "evaluation_force_reset_envs_before_iteration": true, "evaluation_config": null, "off_policy_estimation_methods": {}, "ope_split_batch_by_episode": true, "evaluation_num_env_runners": 1, "in_evaluation": false, "sync_filters_on_rollout_workers_timeout_s": 10.0, "offline_evaluation_interval": null, "num_offline_eval_runners": 0, "offline_loss_for_module_fn": null, "offline_evaluation_duration": 1, "offline_evaluation_parallel_to_training": false, "offline_evaluation_timeout_s": 120.0, "num_cpus_per_offline_eval_runner": 1, "num_gpus_per_offline_eval_runner": 0, "custom_resources_per_offline_eval_runner": {}, "restart_failed_offline_eval_runners": true, "ignore_offline_eval_runner_failures": false, "max_num_offline_eval_runner_restarts": 1000, "offline_eval_runner_restore_timeout_s": 1800.0, "max_requests_in_flight_per_offline_eval_runner": 1, "validate_offline_eval_runners_after_construction": true, "offline_eval_runner_health_probe_timeout_s": 30.0, "offline_eval_rl_module_inference_only": false, "broadcast_offline_eval_runner_states": false, "offline_eval_batch_size_per_runner": 256, "dataset_num_iters_per_eval_runner": 1, "keep_per_episode_custom_metrics": false, "metrics_episode_collection_timeout_s": 60.0, "metrics_num_episodes_for_smoothing": 100, "min_time_s_per_iteration": null, "min_train_timesteps_per_iteration": 0, "min_sample_timesteps_per_iteration": 0, "log_gradients": true, "export_native_model_files": false, "checkpoint_trainable_policies_only": false, "logger_creator": null, "logger_config": null, "log_level": "WARN", "log_sys_usage": true, "fake_sampler": false, "seed": 8, "restart_failed_env_runners": true, "ignore_env_runner_failures": false, "max_num_env_runner_restarts": 1000, "delay_between_env_runner_restarts_s": 60.0, "restart_failed_sub_environments": false, "num_consecutive_env_runner_failures_tolerance": 100, "env_runner_health_probe_timeout_s": 30.0, "env_runner_restore_timeout_s": 1800.0, "_model_config": {}, "_rl_module_spec": "RLModuleSpec(module_class=None, observation_space=None, action_space=None, inference_only=False, learner_only=False, model_config=DefaultModelConfig(fcnet_hiddens=[60, 90], fcnet_activation='tanh', fcnet_kernel_initializer=None, fcnet_kernel_initializer_kwargs=None, fcnet_bias_initializer=None, fcnet_bias_initializer_kwargs=None, conv_filters=None, conv_activation='relu', conv_kernel_initializer=None, conv_kernel_initializer_kwargs=None, conv_bias_initializer=None, conv_bias_initializer_kwargs=None, head_fcnet_hiddens=[], head_fcnet_activation='relu', head_fcnet_kernel_initializer=None, head_fcnet_kernel_initializer_kwargs=None, head_fcnet_bias_initializer=None, head_fcnet_bias_initializer_kwargs=None, free_log_std=False, log_std_clip_param=20.0, vf_share_layers=True, use_lstm=False, max_seq_len=20, lstm_cell_size=256, lstm_use_prev_action=False, lstm_use_prev_reward=False, lstm_kernel_initializer=None, lstm_kernel_initializer_kwargs=None, lstm_bias_initializer=None, lstm_bias_initializer_kwargs=None), catalog_class=None, load_state_path=None, model_config_dict=None)", "algorithm_config_overrides_per_module": {}, "_per_module_overrides": {}, "_validate_config": true, "_use_msgpack_checkpoints": false, "_torch_grad_scaler_class": null, "_torch_lr_scheduler_classes": null, "_tf_policy_handles_more_than_one_loss": false, "_disable_preprocessor_api": false, "_disable_action_flattening": false, "_disable_initialize_loss_from_dummy_batch": false, "_dont_auto_sync_env_runner_states": false, "env_task_fn": -1, "enable_connectors": -1, "simple_optimizer": false, "policy_map_cache": -1, "worker_cls": -1, "synchronize_filters": -1, "enable_async_evaluation": -1, "custom_async_evaluation_function": -1, "_enable_rl_module_api": -1, "auto_wrap_old_gym_envs": -1, "always_attach_evaluation_results": -1, "replay_sequence_length": null, "_disable_execution_plan_api": -1, "use_critic": true, "use_gae": true, "use_kl_loss": true, "kl_coeff": 0.7464963036515, "kl_target": 0.0270990929592, "vf_loss_coeff": 0.6688075857018, "entropy_coeff": 0.0090570820258, "clip_param": 0.1221781641624, "vf_clip_param": 0.1027808522125, "entropy_coeff_schedule": null, "lr_schedule": null, "sgd_minibatch_size": -1, "vf_share_layers": -1, "__stdout_file__": null, "__stderr_file__": null, "lambda": 0.9099046732075, "input": "sampler", "policies": {"default_policy": [null, null, null, null]}, "callbacks": "<class 'ray.rllib.callbacks.callbacks.RLlibCallback'>", "create_env_on_driver": false, "custom_eval_function": null, "framework": "torch"}, "time_since_restore": 61.96073389053345, "iterations_since_restore": 18, "perf": {"cpu_util_percent": 82.08, "ram_util_percent": 81.97999999999999}}
{"timers": {"training_iteration": 4.6178803144024885, "restore_env_runners": 1.2652335367124347e-05, "training_step": 4.617655303039613, "env_runner_sampling_timer": 4.436190377265607, "learner_update_timer": 0.1765923054783807, "synch_weights": 0.0011185193753975454, "restore_eval_env_runners": 6.340144271831546e-05, "evaluation_iteration": 0.2545066418729407, "synch_eval_env_connectors": 0.00043102283908751457, "synch_env_connectors": 5.8356069093757684e-06}, "env_runners": {"episode_duration_sec_mean": 0.010367029324639591, "rlmodule_inference_timer": 6.66948467796211e-05, "env_to_module_connector": {"timers": {"connectors": {"numpy_to_tensor": 2.180886968266234e-05, "add_observations_from_episodes_to_batch": 6.008697061045515e-06, "add_time_dim_to_batch_and_zero_pad": 4.684078832338861e-06, "batch_individual_items": 1.4765353263997463e-05, "add_states_from_episodes_to_batch": 2.979509606045229e-06}}, "connector_pipeline_timer": 8.892466469031325e-05}, "sample": 0.010418054762980173, "env_reset_timer": 9.142881276075152e-05, "module_episode_returns_mean": {"default_policy": 7.2200000000000015}, "episode_len_min": 20, "episode_len_max": 20, "module_to_env_connector": {"timers": {"connectors": {"tensor_to_numpy": 3.0333878891268776e-05, "un_batch_to_individual_items": 1.0100243686277444e-05, "remove_single_ts_time_rank_from_batch": 1.2880894941309289e-06, "listify_data_for_vector_env": 2.353925365276237e-05, "normalize_and_clip_actions": 2.5619173301645634e-05, "get_actions": 0.0001016847438021535}}, "connector_pipeline_timer": 0.00024735984470063973}, "num_episodes_lifetime": -524375.0, "num_module_steps_sampled_lifetime": {"default_policy": -10487500.0}, "episode_return_mean": 7.2200000000000015, "num_env_steps_sampled": 5000.0, "episode_return_min": -11.5, "env_to_module_sum_episodes_length_in": 10.36823839457432, "env_step_timer": 3.174139876552629e-05, "env_to_module_sum_episodes_length_out": 10.36823839457432, "weights_seq_no": 18.0, "num_episodes": 250.0, "num_agent_steps_sampled": {"default_agent": 5000.0}, "episode_return_max": 8.5, "time_between_sampling": 0.003967652774401298, "num_module_steps_sampled": {"default_policy": 5000.0}, "agent_episode_returns_mean": {"default_agent": 7.2200000000000015}, "num_env_steps_sampled_lifetime": -10487500.0, "num_agent_steps_sampled_lifetime": {"default_agent": -10487500.0}, "episode_len_mean": 20.0, "num_env_steps_sampled_lifetime_throughput": 2213.1123868843083}, "learners": {"default_policy": {"default_optimizer_learning_rate": 0.0002847858517, "curr_entropy_coeff": 0.0090570820258, "gradients_default_optimizer_global_norm": 0.03202617168426514, "policy_loss": -0.044341981410980225, "num_module_steps_trained_lifetime": 114000, "diff_num_grad_updates_vs_sampler_policy": 1.0, "mean_kl_loss": 0.00025957918842323124, "weights_seq_no": 19.0, "curr_kl_coeff": 1.423828734914423e-06, "num_trainable_parameters": 6003, "num_module_steps_trained": 6000, "total_loss": 0.02004677802324295, "vf_explained_var": 0.005652189254760742, "module_train_batch_size_mean": 1000.0, "vf_loss": 0.10278083384037018, "entropy": 0.4804908037185669, "vf_loss_unclipped": 26.0632381439209, "num_module_steps_trained_lifetime_throughput": 260695.59095125075}, "__all_modules__": {"num_module_steps_trained_lifetime": 114000, "learner_connector_sum_episodes_length_in": 5000.0, "learner_connector": {"timers": {"connectors": {"add_observations_from_episodes_to_batch": 0.0011320995871679734, "add_columns_from_episodes_to_train_batch": 0.047536267789885366, "numpy_to_tensor": 8.94997605176971e-05, "add_time_dim_to_batch_and_zero_pad": 3.8028494051395656e-05, "add_states_from_episodes_to_batch": 4.729151997702938e-06, "general_advantage_estimation": 0.008922750015314163, "batch_individual_items": 0.06008446571780418, "add_one_ts_to_episodes_and_truncate": 0.015056332766633597}}, "connector_pipeline_timer": 0.13306669346989}, "num_non_trainable_parameters": 0, "num_env_steps_trained_lifetime": 598500, "num_trainable_parameters": 6003, "num_module_steps_trained": 6000, "num_env_steps_trained": 31500, "learner_connector_sum_episodes_length_out": 5250.0, "num_env_steps_trained_lifetime_throughput": 1363211.5872534588, "num_module_steps_trained_throughput": 260477.37810612132, "num_module_steps_trained_lifetime_throughput": 260142.26992490995}}, "num_training_step_calls_per_iteration": 1, "evaluation": {"env_runners": {"env_to_module_connector": {"timers": {"connectors": {"numpy_to_tensor": 1.4334741830323619e-05, "add_time_dim_to_batch_and_zero_pad": 3.0188457951245875e-06, "add_states_from_episodes_to_batch": 1.944360532215945e-06, "batch_individual_items": 8.757679948444953e-06, "add_observations_from_episodes_to_batch": 3.795622189006776e-06}}, "connector_pipeline_timer": 5.83882323142348e-05}, "num_env_steps_sampled": 400, "num_episodes": 20, "episode_duration_sec_mean": 0.007693929157685488, "num_agent_steps_sampled": {"default_agent": 400}, "module_to_env_connector": {"timers": {"connectors": {"un_batch_to_individual_items": 7.107413681436907e-06, "listify_data_for_vector_env": 1.7048409907778276e-05, "remove_single_ts_time_rank_from_batch": 7.036472504845608e-07, "normalize_and_clip_actions": 1.3577385006686846e-05, "get_actions": 7.427090587481875e-05, "tensor_to_numpy": 1.861013535023437e-05}}, "connector_pipeline_timer": 0.00016614187849654105}, "sample": 0.2381226213202577, "agent_episode_returns_mean": {"default_agent": 0.95}, "episode_return_min": -14.5, "env_step_timer": 1.9817553141850876e-05, "env_to_module_sum_episodes_length_in": 10.368238394574323, "env_to_module_sum_episodes_length_out": 10.368238394574323, "weights_seq_no": 19.0, "episode_len_min": 20, "episode_len_max": 20, "num_agent_steps_sampled_lifetime": {"default_agent": 7600}, "num_episodes_lifetime": 380, "num_module_steps_sampled_lifetime": {"default_policy": 7600}, "episode_len_mean": 20.0, "env_reset_timer": 0.0006826854200727238, "episode_return_max": 14.5, "module_episode_returns_mean": {"default_policy": 0.95}, "num_env_steps_sampled_lifetime": 95400, "rlmodule_inference_timer": 4.3303022590128324e-05, "num_module_steps_sampled": {"default_policy": 400}, "episode_return_mean": 0.95, "time_between_sampling": 2.841989114910678}, "num_healthy_workers": 1, "actor_manager_num_outstanding_async_reqs": 0, "num_remote_worker_restarts": 0}, "num_env_steps_sampled_lifetime": -10487500.0, "fault_tolerance": {"num_healthy_workers": 0, "num_remote_worker_restarts": 0}, "env_runner_group": {"actor_manager_num_outstanding_async_reqs": 0}, "done": false, "training_iteration": 19, "trial_id": "49f07_00000", "date": "2025-08-11_19-32-48", "timestamp": 1754933568, "time_this_iter_s": 3.6051619052886963, "time_total_s": 65.56589579582214, "pid": 24465, "hostname": "Mac", "node_ip": "127.0.0.1", "config": {"exploration_config": {}, "extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "placement_strategy": "PACK", "num_gpus": 0, "_fake_gpus": false, "num_cpus_for_main_process": 2, "eager_tracing": true, "eager_max_retraces": 20, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "torch_compile_learner": false, "torch_compile_learner_what_to_compile": "forward_train", "torch_compile_learner_dynamo_backend": "aot_eager", "torch_compile_learner_dynamo_mode": null, "torch_compile_worker": false, "torch_compile_worker_dynamo_backend": "aot_eager", "torch_compile_worker_dynamo_mode": null, "torch_ddp_kwargs": {}, "torch_skip_nan_gradients": false, "env": "Umbrella", "env_config": {}, "observation_space": null, "action_space": null, "clip_rewards": null, "normalize_actions": true, "clip_actions": false, "_is_atari": null, "disable_env_checking": false, "render_env": false, "action_mask_key": "action_mask", "env_runner_cls": null, "num_env_runners": 0, "create_local_env_runner": true, "num_envs_per_env_runner": 1, "gym_env_vectorize_mode": "SYNC", "num_cpus_per_env_runner": 1, "num_gpus_per_env_runner": 0, "custom_resources_per_env_runner": {}, "validate_env_runners_after_construction": true, "episodes_to_numpy": true, "max_requests_in_flight_per_env_runner": 1, "sample_timeout_s": 60.0, "_env_to_module_connector": null, "add_default_connectors_to_env_to_module_pipeline": true, "_module_to_env_connector": null, "add_default_connectors_to_module_to_env_pipeline": true, "merge_env_runner_states": "training_only", "broadcast_env_runner_states": true, "episode_lookback_horizon": 1, "rollout_fragment_length": "auto", "batch_mode": "complete_episodes", "compress_observations": false, "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "enable_tf1_exec_eagerly": false, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "preprocessor_pref": "deepmind", "observation_filter": "NoFilter", "update_worker_filter_stats": true, "use_worker_filter_stats": true, "sampler_perf_stats_ema_coef": null, "_is_online": true, "num_learners": 0, "num_gpus_per_learner": 0, "num_cpus_per_learner": "auto", "num_aggregator_actors_per_learner": 0, "max_requests_in_flight_per_aggregator_actor": 3, "local_gpu_idx": 0, "max_requests_in_flight_per_learner": 3, "gamma": 1, "lr": 0.0002847858517, "grad_clip": 0.5, "grad_clip_by": "global_norm", "_train_batch_size_per_learner": 5000, "train_batch_size": 4000, "num_epochs": 1, "minibatch_size": 1000, "shuffle_batch_per_epoch": true, "model": {"fcnet_hiddens": [256, 256], "fcnet_activation": "tanh", "fcnet_weights_initializer": null, "fcnet_weights_initializer_config": null, "fcnet_bias_initializer": null, "fcnet_bias_initializer_config": null, "conv_filters": null, "conv_activation": "relu", "conv_kernel_initializer": null, "conv_kernel_initializer_config": null, "conv_bias_initializer": null, "conv_bias_initializer_config": null, "conv_transpose_kernel_initializer": null, "conv_transpose_kernel_initializer_config": null, "conv_transpose_bias_initializer": null, "conv_transpose_bias_initializer_config": null, "post_fcnet_hiddens": [], "post_fcnet_activation": "relu", "post_fcnet_weights_initializer": null, "post_fcnet_weights_initializer_config": null, "post_fcnet_bias_initializer": null, "post_fcnet_bias_initializer_config": null, "free_log_std": false, "log_std_clip_param": 20.0, "no_final_linear": false, "vf_share_layers": false, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "lstm_weights_initializer": null, "lstm_weights_initializer_config": null, "lstm_bias_initializer": null, "lstm_bias_initializer_config": null, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "attention_use_n_prev_actions": 0, "attention_use_n_prev_rewards": 0, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": null, "custom_model_config": {}, "custom_action_dist": null, "custom_preprocessor": null, "encoder_latent_dim": null, "always_check_shapes": false, "lstm_use_prev_action_reward": -1, "_use_default_native_models": -1, "_disable_preprocessor_api": false, "_disable_action_flattening": false}, "_learner_connector": null, "add_default_connectors_to_learner_pipeline": true, "learner_config_dict": {}, "optimizer": {}, "_learner_class": null, "callbacks_on_algorithm_init": null, "callbacks_on_env_runners_recreated": null, "callbacks_on_offline_eval_runners_recreated": null, "callbacks_on_checkpoint_loaded": null, "callbacks_on_environment_created": null, "callbacks_on_episode_created": null, "callbacks_on_episode_start": null, "callbacks_on_episode_step": null, "callbacks_on_episode_end": null, "callbacks_on_evaluate_start": null, "callbacks_on_evaluate_end": null, "callbacks_on_evaluate_offline_start": null, "callbacks_on_evaluate_offline_end": null, "callbacks_on_sample_end": null, "callbacks_on_train_result": null, "explore": true, "enable_rl_module_and_learner": true, "enable_env_runner_and_connector_v2": true, "_prior_exploration_config": {"type": "StochasticSampling"}, "count_steps_by": "env_steps", "policy_map_capacity": 100, "policy_mapping_fn": "<function AlgorithmConfig.DEFAULT_POLICY_MAPPING_FN at 0x388c81b20>", "policies_to_train": null, "policy_states_are_swappable": false, "observation_fn": null, "offline_data_class": null, "input_read_method": "read_parquet", "input_read_method_kwargs": {}, "input_read_schema": {}, "input_read_episodes": false, "input_read_sample_batches": false, "input_read_batch_size": null, "input_filesystem": null, "input_filesystem_kwargs": {}, "input_compress_columns": ["obs", "new_obs"], "input_spaces_jsonable": true, "materialize_data": false, "materialize_mapped_data": true, "map_batches_kwargs": {}, "iter_batches_kwargs": {}, "ignore_final_observation": false, "prelearner_class": null, "prelearner_buffer_class": null, "prelearner_buffer_kwargs": {}, "prelearner_module_synch_period": 10, "dataset_num_iters_per_learner": null, "input_config": {}, "actions_in_input_normalized": false, "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_config": {}, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "output_max_rows_per_file": null, "output_write_remaining_data": false, "output_write_method": "write_parquet", "output_write_method_kwargs": {}, "output_filesystem": null, "output_filesystem_kwargs": {}, "output_write_episodes": true, "offline_sampling": false, "evaluation_interval": 1, "evaluation_duration": 20, "evaluation_duration_unit": "episodes", "evaluation_sample_timeout_s": 120.0, "evaluation_auto_duration_min_env_steps_per_sample": 100, "evaluation_auto_duration_max_env_steps_per_sample": 2000, "evaluation_parallel_to_training": false, "evaluation_force_reset_envs_before_iteration": true, "evaluation_config": null, "off_policy_estimation_methods": {}, "ope_split_batch_by_episode": true, "evaluation_num_env_runners": 1, "in_evaluation": false, "sync_filters_on_rollout_workers_timeout_s": 10.0, "offline_evaluation_interval": null, "num_offline_eval_runners": 0, "offline_loss_for_module_fn": null, "offline_evaluation_duration": 1, "offline_evaluation_parallel_to_training": false, "offline_evaluation_timeout_s": 120.0, "num_cpus_per_offline_eval_runner": 1, "num_gpus_per_offline_eval_runner": 0, "custom_resources_per_offline_eval_runner": {}, "restart_failed_offline_eval_runners": true, "ignore_offline_eval_runner_failures": false, "max_num_offline_eval_runner_restarts": 1000, "offline_eval_runner_restore_timeout_s": 1800.0, "max_requests_in_flight_per_offline_eval_runner": 1, "validate_offline_eval_runners_after_construction": true, "offline_eval_runner_health_probe_timeout_s": 30.0, "offline_eval_rl_module_inference_only": false, "broadcast_offline_eval_runner_states": false, "offline_eval_batch_size_per_runner": 256, "dataset_num_iters_per_eval_runner": 1, "keep_per_episode_custom_metrics": false, "metrics_episode_collection_timeout_s": 60.0, "metrics_num_episodes_for_smoothing": 100, "min_time_s_per_iteration": null, "min_train_timesteps_per_iteration": 0, "min_sample_timesteps_per_iteration": 0, "log_gradients": true, "export_native_model_files": false, "checkpoint_trainable_policies_only": false, "logger_creator": null, "logger_config": null, "log_level": "WARN", "log_sys_usage": true, "fake_sampler": false, "seed": 8, "restart_failed_env_runners": true, "ignore_env_runner_failures": false, "max_num_env_runner_restarts": 1000, "delay_between_env_runner_restarts_s": 60.0, "restart_failed_sub_environments": false, "num_consecutive_env_runner_failures_tolerance": 100, "env_runner_health_probe_timeout_s": 30.0, "env_runner_restore_timeout_s": 1800.0, "_model_config": {}, "_rl_module_spec": "RLModuleSpec(module_class=None, observation_space=None, action_space=None, inference_only=False, learner_only=False, model_config=DefaultModelConfig(fcnet_hiddens=[60, 90], fcnet_activation='tanh', fcnet_kernel_initializer=None, fcnet_kernel_initializer_kwargs=None, fcnet_bias_initializer=None, fcnet_bias_initializer_kwargs=None, conv_filters=None, conv_activation='relu', conv_kernel_initializer=None, conv_kernel_initializer_kwargs=None, conv_bias_initializer=None, conv_bias_initializer_kwargs=None, head_fcnet_hiddens=[], head_fcnet_activation='relu', head_fcnet_kernel_initializer=None, head_fcnet_kernel_initializer_kwargs=None, head_fcnet_bias_initializer=None, head_fcnet_bias_initializer_kwargs=None, free_log_std=False, log_std_clip_param=20.0, vf_share_layers=True, use_lstm=False, max_seq_len=20, lstm_cell_size=256, lstm_use_prev_action=False, lstm_use_prev_reward=False, lstm_kernel_initializer=None, lstm_kernel_initializer_kwargs=None, lstm_bias_initializer=None, lstm_bias_initializer_kwargs=None), catalog_class=None, load_state_path=None, model_config_dict=None)", "algorithm_config_overrides_per_module": {}, "_per_module_overrides": {}, "_validate_config": true, "_use_msgpack_checkpoints": false, "_torch_grad_scaler_class": null, "_torch_lr_scheduler_classes": null, "_tf_policy_handles_more_than_one_loss": false, "_disable_preprocessor_api": false, "_disable_action_flattening": false, "_disable_initialize_loss_from_dummy_batch": false, "_dont_auto_sync_env_runner_states": false, "env_task_fn": -1, "enable_connectors": -1, "simple_optimizer": false, "policy_map_cache": -1, "worker_cls": -1, "synchronize_filters": -1, "enable_async_evaluation": -1, "custom_async_evaluation_function": -1, "_enable_rl_module_api": -1, "auto_wrap_old_gym_envs": -1, "always_attach_evaluation_results": -1, "replay_sequence_length": null, "_disable_execution_plan_api": -1, "use_critic": true, "use_gae": true, "use_kl_loss": true, "kl_coeff": 0.7464963036515, "kl_target": 0.0270990929592, "vf_loss_coeff": 0.6688075857018, "entropy_coeff": 0.0090570820258, "clip_param": 0.1221781641624, "vf_clip_param": 0.1027808522125, "entropy_coeff_schedule": null, "lr_schedule": null, "sgd_minibatch_size": -1, "vf_share_layers": -1, "__stdout_file__": null, "__stderr_file__": null, "lambda": 0.9099046732075, "input": "sampler", "policies": {"default_policy": [null, null, null, null]}, "callbacks": "<class 'ray.rllib.callbacks.callbacks.RLlibCallback'>", "create_env_on_driver": false, "custom_eval_function": null, "framework": "torch"}, "time_since_restore": 65.56589579582214, "iterations_since_restore": 19, "perf": {"cpu_util_percent": 82.32, "ram_util_percent": 82.14}}
{"timers": {"training_iteration": 4.601891407927935, "restore_env_runners": 1.2586642511567331e-05, "training_step": 4.601666097509103, "env_runner_sampling_timer": 4.420118739743211, "learner_update_timer": 0.17668412658323948, "synch_weights": 0.0011160129310800826, "restore_eval_env_runners": 6.297992816298231e-05, "evaluation_iteration": 0.2537755308636636, "synch_eval_env_connectors": 0.00042925552994311925, "synch_env_connectors": 5.8243408379610056e-06}, "env_runners": {"episode_duration_sec_mean": 0.009474037514999508, "rlmodule_inference_timer": 6.37628955505043e-05, "env_to_module_connector": {"timers": {"connectors": {"numpy_to_tensor": 1.9127864085483658e-05, "add_observations_from_episodes_to_batch": 5.6942215427936005e-06, "add_time_dim_to_batch_and_zero_pad": 4.606841381702036e-06, "batch_individual_items": 1.3142718802261311e-05, "add_states_from_episodes_to_batch": 2.765726929644728e-06}}, "connector_pipeline_timer": 8.235474669395237e-05}, "sample": 0.010450705902178717, "env_reset_timer": 8.764566023825601e-05, "module_episode_returns_mean": {"default_policy": 6.580000000000001}, "episode_len_min": 20, "episode_len_max": 20, "module_to_env_connector": {"timers": {"connectors": {"tensor_to_numpy": 2.7398725860610205e-05, "un_batch_to_individual_items": 1.0507476763498836e-05, "remove_single_ts_time_rank_from_batch": 1.1695891422931829e-06, "listify_data_for_vector_env": 2.2461183803512572e-05, "normalize_and_clip_actions": 1.8157188814147496e-05, "get_actions": 9.45452012904168e-05}}, "connector_pipeline_timer": 0.00022274676820711444}, "num_episodes_lifetime": -555250.0, "num_module_steps_sampled_lifetime": {"default_policy": -11105000.0}, "episode_return_mean": 6.580000000000001, "num_env_steps_sampled": 5000.0, "episode_return_min": -11.5, "env_to_module_sum_episodes_length_in": 10.36823839457432, "env_step_timer": 3.018668724028284e-05, "env_to_module_sum_episodes_length_out": 10.36823839457432, "weights_seq_no": 19.0, "num_episodes": 250.0, "num_agent_steps_sampled": {"default_agent": 5000.0}, "episode_return_max": 8.5, "time_between_sampling": 0.0034134497289125243, "num_module_steps_sampled": {"default_policy": 5000.0}, "agent_episode_returns_mean": {"default_agent": 6.580000000000001}, "num_env_steps_sampled_lifetime": -11105000.0, "num_agent_steps_sampled_lifetime": {"default_agent": -11105000.0}, "episode_len_mean": 20.0, "num_env_steps_sampled_lifetime_throughput": 2157.302654567423}, "learners": {"default_policy": {"default_optimizer_learning_rate": 0.0002847858517, "curr_entropy_coeff": 0.0090570820258, "gradients_default_optimizer_global_norm": 0.044757142663002014, "policy_loss": -0.013586264103651047, "num_module_steps_trained_lifetime": 120000, "diff_num_grad_updates_vs_sampler_policy": 1.0, "mean_kl_loss": 0.0006841972935944796, "weights_seq_no": 20.0, "curr_kl_coeff": 7.119143674572115e-07, "num_trainable_parameters": 6003, "num_module_steps_trained": 6000, "total_loss": 0.050652336329221725, "vf_explained_var": 0.006448864936828613, "module_train_batch_size_mean": 1000.0, "vf_loss": 0.10278083384037018, "entropy": 0.4970702528953552, "vf_loss_unclipped": 26.30100440979004, "num_module_steps_trained_lifetime_throughput": 258892.60957460885}, "__all_modules__": {"num_module_steps_trained_lifetime": 120000, "learner_connector_sum_episodes_length_in": 5000.0, "learner_connector": {"timers": {"connectors": {"add_observations_from_episodes_to_batch": 0.0011387165113525772, "add_columns_from_episodes_to_train_batch": 0.04776028553166922, "numpy_to_tensor": 8.959559234304066e-05, "add_time_dim_to_batch_and_zero_pad": 3.7771548816050895e-05, "add_states_from_episodes_to_batch": 4.721440522993848e-06, "general_advantage_estimation": 0.008910177514445096, "batch_individual_items": 0.06013016773109466, "add_one_ts_to_episodes_and_truncate": 0.015123145689042437}}, "connector_pipeline_timer": 0.13339723028560027}, "num_non_trainable_parameters": 0, "num_env_steps_trained_lifetime": 630000, "num_trainable_parameters": 6003, "num_module_steps_trained": 6000, "num_env_steps_trained": 31500, "learner_connector_sum_episodes_length_out": 5250.0, "num_env_steps_trained_lifetime_throughput": 1354043.8489386013, "num_module_steps_trained_throughput": 258699.55903307055, "num_module_steps_trained_lifetime_throughput": 258366.69381697546}}, "num_training_step_calls_per_iteration": 1, "evaluation": {"env_runners": {"env_to_module_connector": {"timers": {"connectors": {"numpy_to_tensor": 2.6658949512898992e-05, "add_time_dim_to_batch_and_zero_pad": 4.701925970805284e-06, "add_states_from_episodes_to_batch": 3.358248534956776e-06, "batch_individual_items": 1.7430663338430867e-05, "add_observations_from_episodes_to_batch": 6.858588768343272e-06}}, "connector_pipeline_timer": 0.00010266323632990609}, "num_env_steps_sampled": 400, "num_episodes": 20, "episode_duration_sec_mean": 0.008255582045530901, "num_agent_steps_sampled": {"default_agent": 400}, "module_to_env_connector": {"timers": {"connectors": {"un_batch_to_individual_items": 1.764679567351255e-05, "listify_data_for_vector_env": 2.829326938433676e-05, "remove_single_ts_time_rank_from_batch": 1.414571941910005e-06, "normalize_and_clip_actions": 2.466547881088553e-05, "get_actions": 0.0001336924338878244, "tensor_to_numpy": 4.1127880058684376e-05}}, "connector_pipeline_timer": 0.0003132382342227259}, "sample": 0.23794519510660694, "agent_episode_returns_mean": {"default_agent": 1.35}, "episode_return_min": -14.5, "env_step_timer": 4.088449764120349e-05, "env_to_module_sum_episodes_length_in": 10.368238394574323, "env_to_module_sum_episodes_length_out": 10.368238394574323, "weights_seq_no": 20.0, "episode_len_min": 20, "episode_len_max": 20, "num_agent_steps_sampled_lifetime": {"default_agent": 8000}, "num_episodes_lifetime": 400, "num_module_steps_sampled_lifetime": {"default_policy": 8000}, "episode_len_mean": 20.0, "env_reset_timer": 0.0006767093965647945, "episode_return_max": 14.5, "module_episode_returns_mean": {"default_policy": 1.35}, "num_env_steps_sampled_lifetime": 100400, "rlmodule_inference_timer": 9.428663008317532e-05, "num_module_steps_sampled": {"default_policy": 400}, "episode_return_mean": 1.35, "time_between_sampling": 2.844027237920802}, "num_healthy_workers": 1, "actor_manager_num_outstanding_async_reqs": 0, "num_remote_worker_restarts": 0}, "num_env_steps_sampled_lifetime": -11105000.0, "fault_tolerance": {"num_healthy_workers": 0, "num_remote_worker_restarts": 0}, "env_runner_group": {"actor_manager_num_outstanding_async_reqs": 0}, "done": true, "training_iteration": 20, "trial_id": "49f07_00000", "date": "2025-08-11_19-32-51", "timestamp": 1754933571, "time_this_iter_s": 3.2525439262390137, "time_total_s": 68.81843972206116, "pid": 24465, "hostname": "Mac", "node_ip": "127.0.0.1", "config": {"exploration_config": {}, "extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "placement_strategy": "PACK", "num_gpus": 0, "_fake_gpus": false, "num_cpus_for_main_process": 2, "eager_tracing": true, "eager_max_retraces": 20, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "torch_compile_learner": false, "torch_compile_learner_what_to_compile": "forward_train", "torch_compile_learner_dynamo_backend": "aot_eager", "torch_compile_learner_dynamo_mode": null, "torch_compile_worker": false, "torch_compile_worker_dynamo_backend": "aot_eager", "torch_compile_worker_dynamo_mode": null, "torch_ddp_kwargs": {}, "torch_skip_nan_gradients": false, "env": "Umbrella", "env_config": {}, "observation_space": null, "action_space": null, "clip_rewards": null, "normalize_actions": true, "clip_actions": false, "_is_atari": null, "disable_env_checking": false, "render_env": false, "action_mask_key": "action_mask", "env_runner_cls": null, "num_env_runners": 0, "create_local_env_runner": true, "num_envs_per_env_runner": 1, "gym_env_vectorize_mode": "SYNC", "num_cpus_per_env_runner": 1, "num_gpus_per_env_runner": 0, "custom_resources_per_env_runner": {}, "validate_env_runners_after_construction": true, "episodes_to_numpy": true, "max_requests_in_flight_per_env_runner": 1, "sample_timeout_s": 60.0, "_env_to_module_connector": null, "add_default_connectors_to_env_to_module_pipeline": true, "_module_to_env_connector": null, "add_default_connectors_to_module_to_env_pipeline": true, "merge_env_runner_states": "training_only", "broadcast_env_runner_states": true, "episode_lookback_horizon": 1, "rollout_fragment_length": "auto", "batch_mode": "complete_episodes", "compress_observations": false, "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "enable_tf1_exec_eagerly": false, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "preprocessor_pref": "deepmind", "observation_filter": "NoFilter", "update_worker_filter_stats": true, "use_worker_filter_stats": true, "sampler_perf_stats_ema_coef": null, "_is_online": true, "num_learners": 0, "num_gpus_per_learner": 0, "num_cpus_per_learner": "auto", "num_aggregator_actors_per_learner": 0, "max_requests_in_flight_per_aggregator_actor": 3, "local_gpu_idx": 0, "max_requests_in_flight_per_learner": 3, "gamma": 1, "lr": 0.0002847858517, "grad_clip": 0.5, "grad_clip_by": "global_norm", "_train_batch_size_per_learner": 5000, "train_batch_size": 4000, "num_epochs": 1, "minibatch_size": 1000, "shuffle_batch_per_epoch": true, "model": {"fcnet_hiddens": [256, 256], "fcnet_activation": "tanh", "fcnet_weights_initializer": null, "fcnet_weights_initializer_config": null, "fcnet_bias_initializer": null, "fcnet_bias_initializer_config": null, "conv_filters": null, "conv_activation": "relu", "conv_kernel_initializer": null, "conv_kernel_initializer_config": null, "conv_bias_initializer": null, "conv_bias_initializer_config": null, "conv_transpose_kernel_initializer": null, "conv_transpose_kernel_initializer_config": null, "conv_transpose_bias_initializer": null, "conv_transpose_bias_initializer_config": null, "post_fcnet_hiddens": [], "post_fcnet_activation": "relu", "post_fcnet_weights_initializer": null, "post_fcnet_weights_initializer_config": null, "post_fcnet_bias_initializer": null, "post_fcnet_bias_initializer_config": null, "free_log_std": false, "log_std_clip_param": 20.0, "no_final_linear": false, "vf_share_layers": false, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "lstm_weights_initializer": null, "lstm_weights_initializer_config": null, "lstm_bias_initializer": null, "lstm_bias_initializer_config": null, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "attention_use_n_prev_actions": 0, "attention_use_n_prev_rewards": 0, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": null, "custom_model_config": {}, "custom_action_dist": null, "custom_preprocessor": null, "encoder_latent_dim": null, "always_check_shapes": false, "lstm_use_prev_action_reward": -1, "_use_default_native_models": -1, "_disable_preprocessor_api": false, "_disable_action_flattening": false}, "_learner_connector": null, "add_default_connectors_to_learner_pipeline": true, "learner_config_dict": {}, "optimizer": {}, "_learner_class": null, "callbacks_on_algorithm_init": null, "callbacks_on_env_runners_recreated": null, "callbacks_on_offline_eval_runners_recreated": null, "callbacks_on_checkpoint_loaded": null, "callbacks_on_environment_created": null, "callbacks_on_episode_created": null, "callbacks_on_episode_start": null, "callbacks_on_episode_step": null, "callbacks_on_episode_end": null, "callbacks_on_evaluate_start": null, "callbacks_on_evaluate_end": null, "callbacks_on_evaluate_offline_start": null, "callbacks_on_evaluate_offline_end": null, "callbacks_on_sample_end": null, "callbacks_on_train_result": null, "explore": true, "enable_rl_module_and_learner": true, "enable_env_runner_and_connector_v2": true, "_prior_exploration_config": {"type": "StochasticSampling"}, "count_steps_by": "env_steps", "policy_map_capacity": 100, "policy_mapping_fn": "<function AlgorithmConfig.DEFAULT_POLICY_MAPPING_FN at 0x388c81b20>", "policies_to_train": null, "policy_states_are_swappable": false, "observation_fn": null, "offline_data_class": null, "input_read_method": "read_parquet", "input_read_method_kwargs": {}, "input_read_schema": {}, "input_read_episodes": false, "input_read_sample_batches": false, "input_read_batch_size": null, "input_filesystem": null, "input_filesystem_kwargs": {}, "input_compress_columns": ["obs", "new_obs"], "input_spaces_jsonable": true, "materialize_data": false, "materialize_mapped_data": true, "map_batches_kwargs": {}, "iter_batches_kwargs": {}, "ignore_final_observation": false, "prelearner_class": null, "prelearner_buffer_class": null, "prelearner_buffer_kwargs": {}, "prelearner_module_synch_period": 10, "dataset_num_iters_per_learner": null, "input_config": {}, "actions_in_input_normalized": false, "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_config": {}, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "output_max_rows_per_file": null, "output_write_remaining_data": false, "output_write_method": "write_parquet", "output_write_method_kwargs": {}, "output_filesystem": null, "output_filesystem_kwargs": {}, "output_write_episodes": true, "offline_sampling": false, "evaluation_interval": 1, "evaluation_duration": 20, "evaluation_duration_unit": "episodes", "evaluation_sample_timeout_s": 120.0, "evaluation_auto_duration_min_env_steps_per_sample": 100, "evaluation_auto_duration_max_env_steps_per_sample": 2000, "evaluation_parallel_to_training": false, "evaluation_force_reset_envs_before_iteration": true, "evaluation_config": null, "off_policy_estimation_methods": {}, "ope_split_batch_by_episode": true, "evaluation_num_env_runners": 1, "in_evaluation": false, "sync_filters_on_rollout_workers_timeout_s": 10.0, "offline_evaluation_interval": null, "num_offline_eval_runners": 0, "offline_loss_for_module_fn": null, "offline_evaluation_duration": 1, "offline_evaluation_parallel_to_training": false, "offline_evaluation_timeout_s": 120.0, "num_cpus_per_offline_eval_runner": 1, "num_gpus_per_offline_eval_runner": 0, "custom_resources_per_offline_eval_runner": {}, "restart_failed_offline_eval_runners": true, "ignore_offline_eval_runner_failures": false, "max_num_offline_eval_runner_restarts": 1000, "offline_eval_runner_restore_timeout_s": 1800.0, "max_requests_in_flight_per_offline_eval_runner": 1, "validate_offline_eval_runners_after_construction": true, "offline_eval_runner_health_probe_timeout_s": 30.0, "offline_eval_rl_module_inference_only": false, "broadcast_offline_eval_runner_states": false, "offline_eval_batch_size_per_runner": 256, "dataset_num_iters_per_eval_runner": 1, "keep_per_episode_custom_metrics": false, "metrics_episode_collection_timeout_s": 60.0, "metrics_num_episodes_for_smoothing": 100, "min_time_s_per_iteration": null, "min_train_timesteps_per_iteration": 0, "min_sample_timesteps_per_iteration": 0, "log_gradients": true, "export_native_model_files": false, "checkpoint_trainable_policies_only": false, "logger_creator": null, "logger_config": null, "log_level": "WARN", "log_sys_usage": true, "fake_sampler": false, "seed": 8, "restart_failed_env_runners": true, "ignore_env_runner_failures": false, "max_num_env_runner_restarts": 1000, "delay_between_env_runner_restarts_s": 60.0, "restart_failed_sub_environments": false, "num_consecutive_env_runner_failures_tolerance": 100, "env_runner_health_probe_timeout_s": 30.0, "env_runner_restore_timeout_s": 1800.0, "_model_config": {}, "_rl_module_spec": "RLModuleSpec(module_class=None, observation_space=None, action_space=None, inference_only=False, learner_only=False, model_config=DefaultModelConfig(fcnet_hiddens=[60, 90], fcnet_activation='tanh', fcnet_kernel_initializer=None, fcnet_kernel_initializer_kwargs=None, fcnet_bias_initializer=None, fcnet_bias_initializer_kwargs=None, conv_filters=None, conv_activation='relu', conv_kernel_initializer=None, conv_kernel_initializer_kwargs=None, conv_bias_initializer=None, conv_bias_initializer_kwargs=None, head_fcnet_hiddens=[], head_fcnet_activation='relu', head_fcnet_kernel_initializer=None, head_fcnet_kernel_initializer_kwargs=None, head_fcnet_bias_initializer=None, head_fcnet_bias_initializer_kwargs=None, free_log_std=False, log_std_clip_param=20.0, vf_share_layers=True, use_lstm=False, max_seq_len=20, lstm_cell_size=256, lstm_use_prev_action=False, lstm_use_prev_reward=False, lstm_kernel_initializer=None, lstm_kernel_initializer_kwargs=None, lstm_bias_initializer=None, lstm_bias_initializer_kwargs=None), catalog_class=None, load_state_path=None, model_config_dict=None)", "algorithm_config_overrides_per_module": {}, "_per_module_overrides": {}, "_validate_config": true, "_use_msgpack_checkpoints": false, "_torch_grad_scaler_class": null, "_torch_lr_scheduler_classes": null, "_tf_policy_handles_more_than_one_loss": false, "_disable_preprocessor_api": false, "_disable_action_flattening": false, "_disable_initialize_loss_from_dummy_batch": false, "_dont_auto_sync_env_runner_states": false, "env_task_fn": -1, "enable_connectors": -1, "simple_optimizer": false, "policy_map_cache": -1, "worker_cls": -1, "synchronize_filters": -1, "enable_async_evaluation": -1, "custom_async_evaluation_function": -1, "_enable_rl_module_api": -1, "auto_wrap_old_gym_envs": -1, "always_attach_evaluation_results": -1, "replay_sequence_length": null, "_disable_execution_plan_api": -1, "use_critic": true, "use_gae": true, "use_kl_loss": true, "kl_coeff": 0.7464963036515, "kl_target": 0.0270990929592, "vf_loss_coeff": 0.6688075857018, "entropy_coeff": 0.0090570820258, "clip_param": 0.1221781641624, "vf_clip_param": 0.1027808522125, "entropy_coeff_schedule": null, "lr_schedule": null, "sgd_minibatch_size": -1, "vf_share_layers": -1, "__stdout_file__": null, "__stderr_file__": null, "lambda": 0.9099046732075, "input": "sampler", "policies": {"default_policy": [null, null, null, null]}, "callbacks": "<class 'ray.rllib.callbacks.callbacks.RLlibCallback'>", "create_env_on_driver": false, "custom_eval_function": null, "framework": "torch"}, "time_since_restore": 68.81843972206116, "iterations_since_restore": 20, "perf": {"cpu_util_percent": 77.2, "ram_util_percent": 81.125}}
