{"timers": {"training_iteration": 3.4634854999603704, "restore_env_runners": 5.4541975259780884e-05, "training_step": 3.463029250036925, "env_runner_sampling_timer": 3.284584040986374, "learner_update_timer": 0.1735220409464091, "synch_weights": 0.0012943749316036701}, "env_runners": {"episode_return_min": -13.5, "module_to_env_connector": {"connector_pipeline_timer": 0.000267734396536636, "timers": {"connectors": {"normalize_and_clip_actions": 2.4458138366336748e-05, "un_batch_to_individual_items": 1.228299709696527e-05, "remove_single_ts_time_rank_from_batch": 1.3563483871890685e-06, "tensor_to_numpy": 3.1973994636509745e-05, "listify_data_for_vector_env": 2.6196077519603995e-05, "get_actions": 0.00011626331965266467}}}, "env_step_timer": 3.776953278909727e-05, "rlmodule_inference_timer": 0.00011190906688575497, "env_reset_timer": 0.00020537412169775498, "agent_episode_returns_mean": {"default_agent": -4.459999999999999}, "num_env_steps_sampled_lifetime": 627500.0, "weights_seq_no": 0.0, "env_to_module_sum_episodes_length_out": 10.191744832559449, "episode_len_max": 20, "env_to_module_connector": {"timers": {"connectors": {"batch_individual_items": 1.4493733649797367e-05, "numpy_to_tensor": 2.2720905368230723e-05, "add_time_dim_to_batch_and_zero_pad": 5.468083615877511e-06, "add_observations_from_episodes_to_batch": 6.577938775874617e-06, "add_states_from_episodes_to_batch": 3.3903051098170312e-06}}, "connector_pipeline_timer": 9.403571325531541e-05}, "env_to_module_sum_episodes_length_in": 10.191744832559449, "sample": 0.01426338966466734, "num_agent_steps_sampled": {"default_agent": 5000.0}, "num_module_steps_sampled": {"default_policy": 5000.0}, "num_episodes_lifetime": 31375.0, "num_module_steps_sampled_lifetime": {"default_policy": 627500.0}, "num_agent_steps_sampled_lifetime": {"default_agent": 627500.0}, "time_between_sampling": 0.001353752495787397, "episode_len_mean": 20.0, "episode_return_mean": -4.459999999999999, "num_episodes": 250.0, "episode_duration_sec_mean": 0.011247909694444391, "episode_len_min": 20, "num_env_steps_sampled": 5000.0, "module_episode_returns_mean": {"default_policy": -4.459999999999999}, "episode_return_max": 6.5, "num_env_steps_sampled_lifetime_throughput": 1804.9253642551087}, "learners": {"__all_modules__": {"learner_connector": {"timers": {"connectors": {"add_columns_from_episodes_to_train_batch": 0.03722195792943239, "add_states_from_episodes_to_batch": 4.749977961182594e-06, "add_one_ts_to_episodes_and_truncate": 0.01181150006595999, "numpy_to_tensor": 0.00021075003314763308, "batch_individual_items": 0.04537991702090949, "add_time_dim_to_batch_and_zero_pad": 1.2959004379808903e-05, "general_advantage_estimation": 0.013777374988421798, "add_observations_from_episodes_to_batch": 0.000856541097164154}}, "connector_pipeline_timer": 0.10967725003138185}, "num_module_steps_trained": 6000, "num_non_trainable_parameters": 0, "num_module_steps_trained_lifetime": 6000, "learner_connector_sum_episodes_length_in": 5000, "learner_connector_sum_episodes_length_out": 5250, "num_env_steps_trained": 31500, "num_trainable_parameters": 6003, "num_env_steps_trained_lifetime": 31500, "num_env_steps_trained_lifetime_throughput": 907848.647944517, "num_module_steps_trained_throughput": 176311.5100432257, "num_module_steps_trained_lifetime_throughput": 176094.49509864982}, "default_policy": {"num_module_steps_trained": 6000, "curr_entropy_coeff": 0.0090570820258, "num_module_steps_trained_lifetime": 6000, "gradients_default_optimizer_global_norm": 0.01337447576224804, "entropy": 0.6885641813278198, "total_loss": 0.035620804876089096, "weights_seq_no": 1.0, "default_optimizer_learning_rate": 0.0002847858517, "curr_kl_coeff": 0.3732481598854065, "policy_loss": -0.02556947059929371, "vf_loss_unclipped": 30.21761131286621, "vf_explained_var": -0.013725519180297852, "mean_kl_loss": 0.0003655994951259345, "num_trainable_parameters": 6003, "module_train_batch_size_mean": 1000.0, "diff_num_grad_updates_vs_sampler_policy": 1.0, "vf_loss": 0.1004081591963768, "num_module_steps_trained_lifetime_throughput": 176888.87467758422}}, "num_training_step_calls_per_iteration": 1, "num_env_steps_sampled_lifetime": 627500.0, "evaluation": {"env_runners": {"num_module_steps_sampled_lifetime": {"default_policy": 400}, "env_step_timer": 2.186697396750027e-05, "episode_duration_sec_mean": 0.008247512608068063, "num_module_steps_sampled": {"default_policy": 400}, "num_agent_steps_sampled_lifetime": {"default_agent": 400}, "rlmodule_inference_timer": 4.85891399911356e-05, "weights_seq_no": 1.0, "env_to_module_sum_episodes_length_out": 10.216013141322508, "sample": 0.18227670795749873, "episode_len_mean": 20.0, "agent_episode_returns_mean": {"default_agent": 4.6}, "env_to_module_connector": {"connector_pipeline_timer": 6.385157854426284e-05, "timers": {"connectors": {"add_observations_from_episodes_to_batch": 5.7373115597557645e-06, "add_states_from_episodes_to_batch": 2.058952732670385e-06, "numpy_to_tensor": 1.2788976984026125e-05, "batch_individual_items": 8.734703939660528e-06, "add_time_dim_to_batch_and_zero_pad": 3.6753701606412715e-06}}}, "episode_return_max": 13.5, "module_to_env_connector": {"timers": {"connectors": {"tensor_to_numpy": 2.1778394907435505e-05, "listify_data_for_vector_env": 1.4566007196166571e-05, "normalize_and_clip_actions": 1.8520655927087414e-05, "un_batch_to_individual_items": 7.831622579669801e-06, "remove_single_ts_time_rank_from_batch": 8.663886277093847e-07, "get_actions": 6.439109246098214e-05}}, "connector_pipeline_timer": 0.0001612149028071385}, "env_to_module_sum_episodes_length_in": 10.216013141322508, "num_episodes_lifetime": 20, "module_episode_returns_mean": {"default_policy": 4.6}, "num_episodes": 20, "episode_len_min": 20, "num_agent_steps_sampled": {"default_agent": 400}, "episode_return_min": -13.5, "env_reset_timer": 0.0005111250793561339, "num_env_steps_sampled_lifetime": 5400, "episode_len_max": 20, "episode_return_mean": 4.6, "num_env_steps_sampled": 400}, "num_healthy_workers": 1, "actor_manager_num_outstanding_async_reqs": 0, "num_remote_worker_restarts": 0}, "fault_tolerance": {"num_healthy_workers": 0, "num_remote_worker_restarts": 0}, "env_runner_group": {"actor_manager_num_outstanding_async_reqs": 0}, "done": false, "training_iteration": 1, "trial_id": "469e6_00000", "date": "2025-08-11_19-33-03", "timestamp": 1754933583, "time_this_iter_s": 3.6605429649353027, "time_total_s": 3.6605429649353027, "pid": 25834, "hostname": "Mac", "node_ip": "127.0.0.1", "config": {"exploration_config": {}, "extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "placement_strategy": "PACK", "num_gpus": 0, "_fake_gpus": false, "num_cpus_for_main_process": 2, "eager_tracing": true, "eager_max_retraces": 20, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "torch_compile_learner": false, "torch_compile_learner_what_to_compile": "forward_train", "torch_compile_learner_dynamo_backend": "aot_eager", "torch_compile_learner_dynamo_mode": null, "torch_compile_worker": false, "torch_compile_worker_dynamo_backend": "aot_eager", "torch_compile_worker_dynamo_mode": null, "torch_ddp_kwargs": {}, "torch_skip_nan_gradients": false, "env": "Umbrella", "env_config": {}, "observation_space": null, "action_space": null, "clip_rewards": null, "normalize_actions": true, "clip_actions": false, "_is_atari": null, "disable_env_checking": false, "render_env": false, "action_mask_key": "action_mask", "env_runner_cls": null, "num_env_runners": 0, "create_local_env_runner": true, "num_envs_per_env_runner": 1, "gym_env_vectorize_mode": "SYNC", "num_cpus_per_env_runner": 1, "num_gpus_per_env_runner": 0, "custom_resources_per_env_runner": {}, "validate_env_runners_after_construction": true, "episodes_to_numpy": true, "max_requests_in_flight_per_env_runner": 1, "sample_timeout_s": 60.0, "_env_to_module_connector": null, "add_default_connectors_to_env_to_module_pipeline": true, "_module_to_env_connector": null, "add_default_connectors_to_module_to_env_pipeline": true, "merge_env_runner_states": "training_only", "broadcast_env_runner_states": true, "episode_lookback_horizon": 1, "rollout_fragment_length": "auto", "batch_mode": "complete_episodes", "compress_observations": false, "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "enable_tf1_exec_eagerly": false, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "preprocessor_pref": "deepmind", "observation_filter": "NoFilter", "update_worker_filter_stats": true, "use_worker_filter_stats": true, "sampler_perf_stats_ema_coef": null, "_is_online": true, "num_learners": 0, "num_gpus_per_learner": 0, "num_cpus_per_learner": "auto", "num_aggregator_actors_per_learner": 0, "max_requests_in_flight_per_aggregator_actor": 3, "local_gpu_idx": 0, "max_requests_in_flight_per_learner": 3, "gamma": 1, "lr": 0.0002847858517, "grad_clip": 0.5, "grad_clip_by": "global_norm", "_train_batch_size_per_learner": 5000, "train_batch_size": 4000, "num_epochs": 1, "minibatch_size": 1000, "shuffle_batch_per_epoch": true, "model": {"fcnet_hiddens": [256, 256], "fcnet_activation": "tanh", "fcnet_weights_initializer": null, "fcnet_weights_initializer_config": null, "fcnet_bias_initializer": null, "fcnet_bias_initializer_config": null, "conv_filters": null, "conv_activation": "relu", "conv_kernel_initializer": null, "conv_kernel_initializer_config": null, "conv_bias_initializer": null, "conv_bias_initializer_config": null, "conv_transpose_kernel_initializer": null, "conv_transpose_kernel_initializer_config": null, "conv_transpose_bias_initializer": null, "conv_transpose_bias_initializer_config": null, "post_fcnet_hiddens": [], "post_fcnet_activation": "relu", "post_fcnet_weights_initializer": null, "post_fcnet_weights_initializer_config": null, "post_fcnet_bias_initializer": null, "post_fcnet_bias_initializer_config": null, "free_log_std": false, "log_std_clip_param": 20.0, "no_final_linear": false, "vf_share_layers": false, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "lstm_weights_initializer": null, "lstm_weights_initializer_config": null, "lstm_bias_initializer": null, "lstm_bias_initializer_config": null, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "attention_use_n_prev_actions": 0, "attention_use_n_prev_rewards": 0, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": null, "custom_model_config": {}, "custom_action_dist": null, "custom_preprocessor": null, "encoder_latent_dim": null, "always_check_shapes": false, "lstm_use_prev_action_reward": -1, "_use_default_native_models": -1, "_disable_preprocessor_api": false, "_disable_action_flattening": false}, "_learner_connector": null, "add_default_connectors_to_learner_pipeline": true, "learner_config_dict": {}, "optimizer": {}, "_learner_class": null, "callbacks_on_algorithm_init": null, "callbacks_on_env_runners_recreated": null, "callbacks_on_offline_eval_runners_recreated": null, "callbacks_on_checkpoint_loaded": null, "callbacks_on_environment_created": null, "callbacks_on_episode_created": null, "callbacks_on_episode_start": null, "callbacks_on_episode_step": null, "callbacks_on_episode_end": null, "callbacks_on_evaluate_start": null, "callbacks_on_evaluate_end": null, "callbacks_on_evaluate_offline_start": null, "callbacks_on_evaluate_offline_end": null, "callbacks_on_sample_end": null, "callbacks_on_train_result": null, "explore": true, "enable_rl_module_and_learner": true, "enable_env_runner_and_connector_v2": true, "_prior_exploration_config": {"type": "StochasticSampling"}, "count_steps_by": "env_steps", "policy_map_capacity": 100, "policy_mapping_fn": "<function AlgorithmConfig.DEFAULT_POLICY_MAPPING_FN at 0x14f2edb20>", "policies_to_train": null, "policy_states_are_swappable": false, "observation_fn": null, "offline_data_class": null, "input_read_method": "read_parquet", "input_read_method_kwargs": {}, "input_read_schema": {}, "input_read_episodes": false, "input_read_sample_batches": false, "input_read_batch_size": null, "input_filesystem": null, "input_filesystem_kwargs": {}, "input_compress_columns": ["obs", "new_obs"], "input_spaces_jsonable": true, "materialize_data": false, "materialize_mapped_data": true, "map_batches_kwargs": {}, "iter_batches_kwargs": {}, "ignore_final_observation": false, "prelearner_class": null, "prelearner_buffer_class": null, "prelearner_buffer_kwargs": {}, "prelearner_module_synch_period": 10, "dataset_num_iters_per_learner": null, "input_config": {}, "actions_in_input_normalized": false, "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_config": {}, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "output_max_rows_per_file": null, "output_write_remaining_data": false, "output_write_method": "write_parquet", "output_write_method_kwargs": {}, "output_filesystem": null, "output_filesystem_kwargs": {}, "output_write_episodes": true, "offline_sampling": false, "evaluation_interval": 1, "evaluation_duration": 20, "evaluation_duration_unit": "episodes", "evaluation_sample_timeout_s": 120.0, "evaluation_auto_duration_min_env_steps_per_sample": 100, "evaluation_auto_duration_max_env_steps_per_sample": 2000, "evaluation_parallel_to_training": false, "evaluation_force_reset_envs_before_iteration": true, "evaluation_config": null, "off_policy_estimation_methods": {}, "ope_split_batch_by_episode": true, "evaluation_num_env_runners": 1, "in_evaluation": false, "sync_filters_on_rollout_workers_timeout_s": 10.0, "offline_evaluation_interval": null, "num_offline_eval_runners": 0, "offline_loss_for_module_fn": null, "offline_evaluation_duration": 1, "offline_evaluation_parallel_to_training": false, "offline_evaluation_timeout_s": 120.0, "num_cpus_per_offline_eval_runner": 1, "num_gpus_per_offline_eval_runner": 0, "custom_resources_per_offline_eval_runner": {}, "restart_failed_offline_eval_runners": true, "ignore_offline_eval_runner_failures": false, "max_num_offline_eval_runner_restarts": 1000, "offline_eval_runner_restore_timeout_s": 1800.0, "max_requests_in_flight_per_offline_eval_runner": 1, "validate_offline_eval_runners_after_construction": true, "offline_eval_runner_health_probe_timeout_s": 30.0, "offline_eval_rl_module_inference_only": false, "broadcast_offline_eval_runner_states": false, "offline_eval_batch_size_per_runner": 256, "dataset_num_iters_per_eval_runner": 1, "keep_per_episode_custom_metrics": false, "metrics_episode_collection_timeout_s": 60.0, "metrics_num_episodes_for_smoothing": 100, "min_time_s_per_iteration": null, "min_train_timesteps_per_iteration": 0, "min_sample_timesteps_per_iteration": 0, "log_gradients": true, "export_native_model_files": false, "checkpoint_trainable_policies_only": false, "logger_creator": null, "logger_config": null, "log_level": "WARN", "log_sys_usage": true, "fake_sampler": false, "seed": 3, "restart_failed_env_runners": true, "ignore_env_runner_failures": false, "max_num_env_runner_restarts": 1000, "delay_between_env_runner_restarts_s": 60.0, "restart_failed_sub_environments": false, "num_consecutive_env_runner_failures_tolerance": 100, "env_runner_health_probe_timeout_s": 30.0, "env_runner_restore_timeout_s": 1800.0, "_model_config": {}, "_rl_module_spec": "RLModuleSpec(module_class=None, observation_space=None, action_space=None, inference_only=False, learner_only=False, model_config=DefaultModelConfig(fcnet_hiddens=[60, 90], fcnet_activation='tanh', fcnet_kernel_initializer=None, fcnet_kernel_initializer_kwargs=None, fcnet_bias_initializer=None, fcnet_bias_initializer_kwargs=None, conv_filters=None, conv_activation='relu', conv_kernel_initializer=None, conv_kernel_initializer_kwargs=None, conv_bias_initializer=None, conv_bias_initializer_kwargs=None, head_fcnet_hiddens=[], head_fcnet_activation='relu', head_fcnet_kernel_initializer=None, head_fcnet_kernel_initializer_kwargs=None, head_fcnet_bias_initializer=None, head_fcnet_bias_initializer_kwargs=None, free_log_std=False, log_std_clip_param=20.0, vf_share_layers=True, use_lstm=False, max_seq_len=20, lstm_cell_size=256, lstm_use_prev_action=False, lstm_use_prev_reward=False, lstm_kernel_initializer=None, lstm_kernel_initializer_kwargs=None, lstm_bias_initializer=None, lstm_bias_initializer_kwargs=None), catalog_class=None, load_state_path=None, model_config_dict=None)", "algorithm_config_overrides_per_module": {}, "_per_module_overrides": {}, "_validate_config": true, "_use_msgpack_checkpoints": false, "_torch_grad_scaler_class": null, "_torch_lr_scheduler_classes": null, "_tf_policy_handles_more_than_one_loss": false, "_disable_preprocessor_api": false, "_disable_action_flattening": false, "_disable_initialize_loss_from_dummy_batch": false, "_dont_auto_sync_env_runner_states": false, "env_task_fn": -1, "enable_connectors": -1, "simple_optimizer": false, "policy_map_cache": -1, "worker_cls": -1, "synchronize_filters": -1, "enable_async_evaluation": -1, "custom_async_evaluation_function": -1, "_enable_rl_module_api": -1, "auto_wrap_old_gym_envs": -1, "always_attach_evaluation_results": -1, "replay_sequence_length": null, "_disable_execution_plan_api": -1, "use_critic": true, "use_gae": true, "use_kl_loss": true, "kl_coeff": 0.7464963036515, "kl_target": 0.0270990929592, "vf_loss_coeff": 0.6688075857018, "entropy_coeff": 0.0090570820258, "clip_param": 0.1221781641624, "vf_clip_param": 0.1027808522125, "entropy_coeff_schedule": null, "lr_schedule": null, "sgd_minibatch_size": -1, "vf_share_layers": -1, "__stdout_file__": null, "__stderr_file__": null, "lambda": 0.9099046732075, "input": "sampler", "policies": {"default_policy": [null, null, null, null]}, "callbacks": "<class 'ray.rllib.callbacks.callbacks.RLlibCallback'>", "create_env_on_driver": false, "custom_eval_function": null, "framework": "torch"}, "time_since_restore": 3.6605429649353027, "iterations_since_restore": 1, "perf": {"cpu_util_percent": 54.666666666666664, "ram_util_percent": 78.33333333333333}}
{"timers": {"training_iteration": 3.455881970380433, "restore_env_runners": 5.4091555066406725e-05, "training_step": 3.455424330455717, "env_runner_sampling_timer": 3.2760275214060672, "learner_update_timer": 0.17443465344724246, "synch_weights": 0.0013023732614237814, "restore_eval_env_runners": 1.0999967344105244e-05, "evaluation_iteration": 0.1932001250097528, "synch_eval_env_connectors": 0.0001978749642148614, "synch_env_connectors": 7.166992872953415e-06}, "env_runners": {"episode_return_min": -13.5, "module_to_env_connector": {"connector_pipeline_timer": 0.0001870569269778216, "timers": {"connectors": {"normalize_and_clip_actions": 1.5485537385932318e-05, "un_batch_to_individual_items": 8.53872181260096e-06, "remove_single_ts_time_rank_from_batch": 9.6411634980318e-07, "tensor_to_numpy": 2.3149829722428e-05, "listify_data_for_vector_env": 1.8728629888005e-05, "get_actions": 7.946816860401071e-05}}}, "env_step_timer": 2.5176506601870355e-05, "rlmodule_inference_timer": 5.3751689127986366e-05, "env_reset_timer": 9.233087698073442e-05, "agent_episode_returns_mean": {"default_agent": -5.5}, "num_env_steps_sampled_lifetime": 10000.0, "weights_seq_no": 1.0, "env_to_module_sum_episodes_length_out": 10.36823839457432, "episode_len_max": 20, "env_to_module_connector": {"timers": {"connectors": {"batch_individual_items": 1.0872500238824561e-05, "numpy_to_tensor": 1.6864093615323186e-05, "add_time_dim_to_batch_and_zero_pad": 4.146200336378445e-06, "add_observations_from_episodes_to_batch": 4.759108060041452e-06, "add_states_from_episodes_to_batch": 2.6333708675682854e-06}}, "connector_pipeline_timer": 7.190970053733298e-05}, "env_to_module_sum_episodes_length_in": 10.36823839457432, "sample": 0.01049652119212409, "num_agent_steps_sampled": {"default_agent": 5000.0}, "num_module_steps_sampled": {"default_policy": 5000.0}, "num_episodes_lifetime": 500.0, "num_module_steps_sampled_lifetime": {"default_policy": 10000.0}, "num_agent_steps_sampled_lifetime": {"default_agent": 10000.0}, "time_between_sampling": 0.0025777881343593935, "episode_len_mean": 20.0, "episode_return_mean": -5.5, "num_episodes": 250.0, "episode_duration_sec_mean": 0.008113612799439576, "episode_len_min": 20, "num_env_steps_sampled": 5000.0, "module_episode_returns_mean": {"default_policy": -5.5}, "episode_return_max": 6.5, "num_env_steps_sampled_lifetime_throughput": 2387.974398084519}, "learners": {"__all_modules__": {"learner_connector": {"timers": {"connectors": {"add_columns_from_episodes_to_train_batch": 0.03727706918027252, "add_states_from_episodes_to_batch": 4.741648444905878e-06, "add_one_ts_to_episodes_and_truncate": 0.011815619225380943, "numpy_to_tensor": 0.00020938544301316142, "batch_individual_items": 0.04646102618076839, "add_time_dim_to_batch_and_zero_pad": 1.2965244241058827e-05, "general_advantage_estimation": 0.01372570164850913, "add_observations_from_episodes_to_batch": 0.0008568231854587793}}, "connector_pipeline_timer": 0.11076217586174608}, "num_module_steps_trained": 6000, "num_non_trainable_parameters": 0, "num_module_steps_trained_lifetime": 12000, "learner_connector_sum_episodes_length_in": 5000.0, "learner_connector_sum_episodes_length_out": 5250.0, "num_env_steps_trained": 31500, "num_trainable_parameters": 6003, "num_env_steps_trained_lifetime": 63000, "num_env_steps_trained_lifetime_throughput": 903955.9499950205, "num_module_steps_trained_throughput": 175529.09107819566, "num_module_steps_trained_lifetime_throughput": 175311.97146679644}, "default_policy": {"num_module_steps_trained": 6000, "curr_entropy_coeff": 0.0090570820258, "num_module_steps_trained_lifetime": 12000, "gradients_default_optimizer_global_norm": 0.0885528028011322, "entropy": 0.6920790672302246, "total_loss": -0.05691200867295265, "weights_seq_no": 2.0, "default_optimizer_learning_rate": 0.0002847858517, "curr_kl_coeff": 0.18662407994270325, "policy_loss": -0.11839213222265244, "vf_loss_unclipped": 30.189531326293945, "vf_explained_var": -0.013575196266174316, "mean_kl_loss": 0.0015927486820146441, "num_trainable_parameters": 6003, "module_train_batch_size_mean": 1000.0, "diff_num_grad_updates_vs_sampler_policy": 1.0, "vf_loss": 0.10040832310914993, "num_module_steps_trained_lifetime_throughput": 176099.29470508406}}, "num_training_step_calls_per_iteration": 1, "evaluation": {"env_runners": {"num_module_steps_sampled_lifetime": {"default_policy": 800}, "env_step_timer": 2.3024940749862595e-05, "episode_duration_sec_mean": 0.008867630257736892, "num_module_steps_sampled": {"default_policy": 400}, "num_agent_steps_sampled_lifetime": {"default_agent": 800}, "rlmodule_inference_timer": 4.443028630220669e-05, "weights_seq_no": 2.0, "env_to_module_sum_episodes_length_out": 10.366003441359926, "sample": 0.18252091087750158, "episode_len_mean": 20.0, "agent_episode_returns_mean": {"default_agent": 3.1}, "env_to_module_connector": {"connector_pipeline_timer": 6.154460602251678e-05, "timers": {"connectors": {"add_observations_from_episodes_to_batch": 4.004892468255542e-06, "add_states_from_episodes_to_batch": 2.0312570882656004e-06, "numpy_to_tensor": 1.3786253907708874e-05, "batch_individual_items": 9.479910335264456e-06, "add_time_dim_to_batch_and_zero_pad": 3.1894197188458065e-06}}}, "episode_return_max": 13.5, "module_to_env_connector": {"timers": {"connectors": {"tensor_to_numpy": 2.0527557057453962e-05, "listify_data_for_vector_env": 1.6094299949431157e-05, "normalize_and_clip_actions": 1.3234762437235738e-05, "un_batch_to_individual_items": 7.639343946527412e-06, "remove_single_ts_time_rank_from_batch": 1.0560781780878877e-06, "get_actions": 6.0903401780613726e-05}}, "connector_pipeline_timer": 0.00015489070602405327}, "env_to_module_sum_episodes_length_in": 10.366003441359926, "num_episodes_lifetime": 40, "module_episode_returns_mean": {"default_policy": 3.1}, "num_episodes": 20, "episode_len_min": 20, "num_agent_steps_sampled": {"default_agent": 400}, "episode_return_min": -13.5, "env_reset_timer": 0.0005076604988425971, "num_env_steps_sampled_lifetime": 10400, "episode_len_max": 20, "episode_return_mean": 3.1, "num_env_steps_sampled": 400, "time_between_sampling": 2.7512744589475915}, "num_healthy_workers": 1, "actor_manager_num_outstanding_async_reqs": 0, "num_remote_worker_restarts": 0}, "num_env_steps_sampled_lifetime": 10000.0, "fault_tolerance": {"num_healthy_workers": 0, "num_remote_worker_restarts": 0}, "env_runner_group": {"actor_manager_num_outstanding_async_reqs": 0}, "done": false, "training_iteration": 2, "trial_id": "469e6_00000", "date": "2025-08-11_19-33-06", "timestamp": 1754933586, "time_this_iter_s": 2.9232959747314453, "time_total_s": 6.583838939666748, "pid": 25834, "hostname": "Mac", "node_ip": "127.0.0.1", "config": {"exploration_config": {}, "extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "placement_strategy": "PACK", "num_gpus": 0, "_fake_gpus": false, "num_cpus_for_main_process": 2, "eager_tracing": true, "eager_max_retraces": 20, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "torch_compile_learner": false, "torch_compile_learner_what_to_compile": "forward_train", "torch_compile_learner_dynamo_backend": "aot_eager", "torch_compile_learner_dynamo_mode": null, "torch_compile_worker": false, "torch_compile_worker_dynamo_backend": "aot_eager", "torch_compile_worker_dynamo_mode": null, "torch_ddp_kwargs": {}, "torch_skip_nan_gradients": false, "env": "Umbrella", "env_config": {}, "observation_space": null, "action_space": null, "clip_rewards": null, "normalize_actions": true, "clip_actions": false, "_is_atari": null, "disable_env_checking": false, "render_env": false, "action_mask_key": "action_mask", "env_runner_cls": null, "num_env_runners": 0, "create_local_env_runner": true, "num_envs_per_env_runner": 1, "gym_env_vectorize_mode": "SYNC", "num_cpus_per_env_runner": 1, "num_gpus_per_env_runner": 0, "custom_resources_per_env_runner": {}, "validate_env_runners_after_construction": true, "episodes_to_numpy": true, "max_requests_in_flight_per_env_runner": 1, "sample_timeout_s": 60.0, "_env_to_module_connector": null, "add_default_connectors_to_env_to_module_pipeline": true, "_module_to_env_connector": null, "add_default_connectors_to_module_to_env_pipeline": true, "merge_env_runner_states": "training_only", "broadcast_env_runner_states": true, "episode_lookback_horizon": 1, "rollout_fragment_length": "auto", "batch_mode": "complete_episodes", "compress_observations": false, "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "enable_tf1_exec_eagerly": false, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "preprocessor_pref": "deepmind", "observation_filter": "NoFilter", "update_worker_filter_stats": true, "use_worker_filter_stats": true, "sampler_perf_stats_ema_coef": null, "_is_online": true, "num_learners": 0, "num_gpus_per_learner": 0, "num_cpus_per_learner": "auto", "num_aggregator_actors_per_learner": 0, "max_requests_in_flight_per_aggregator_actor": 3, "local_gpu_idx": 0, "max_requests_in_flight_per_learner": 3, "gamma": 1, "lr": 0.0002847858517, "grad_clip": 0.5, "grad_clip_by": "global_norm", "_train_batch_size_per_learner": 5000, "train_batch_size": 4000, "num_epochs": 1, "minibatch_size": 1000, "shuffle_batch_per_epoch": true, "model": {"fcnet_hiddens": [256, 256], "fcnet_activation": "tanh", "fcnet_weights_initializer": null, "fcnet_weights_initializer_config": null, "fcnet_bias_initializer": null, "fcnet_bias_initializer_config": null, "conv_filters": null, "conv_activation": "relu", "conv_kernel_initializer": null, "conv_kernel_initializer_config": null, "conv_bias_initializer": null, "conv_bias_initializer_config": null, "conv_transpose_kernel_initializer": null, "conv_transpose_kernel_initializer_config": null, "conv_transpose_bias_initializer": null, "conv_transpose_bias_initializer_config": null, "post_fcnet_hiddens": [], "post_fcnet_activation": "relu", "post_fcnet_weights_initializer": null, "post_fcnet_weights_initializer_config": null, "post_fcnet_bias_initializer": null, "post_fcnet_bias_initializer_config": null, "free_log_std": false, "log_std_clip_param": 20.0, "no_final_linear": false, "vf_share_layers": false, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "lstm_weights_initializer": null, "lstm_weights_initializer_config": null, "lstm_bias_initializer": null, "lstm_bias_initializer_config": null, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "attention_use_n_prev_actions": 0, "attention_use_n_prev_rewards": 0, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": null, "custom_model_config": {}, "custom_action_dist": null, "custom_preprocessor": null, "encoder_latent_dim": null, "always_check_shapes": false, "lstm_use_prev_action_reward": -1, "_use_default_native_models": -1, "_disable_preprocessor_api": false, "_disable_action_flattening": false}, "_learner_connector": null, "add_default_connectors_to_learner_pipeline": true, "learner_config_dict": {}, "optimizer": {}, "_learner_class": null, "callbacks_on_algorithm_init": null, "callbacks_on_env_runners_recreated": null, "callbacks_on_offline_eval_runners_recreated": null, "callbacks_on_checkpoint_loaded": null, "callbacks_on_environment_created": null, "callbacks_on_episode_created": null, "callbacks_on_episode_start": null, "callbacks_on_episode_step": null, "callbacks_on_episode_end": null, "callbacks_on_evaluate_start": null, "callbacks_on_evaluate_end": null, "callbacks_on_evaluate_offline_start": null, "callbacks_on_evaluate_offline_end": null, "callbacks_on_sample_end": null, "callbacks_on_train_result": null, "explore": true, "enable_rl_module_and_learner": true, "enable_env_runner_and_connector_v2": true, "_prior_exploration_config": {"type": "StochasticSampling"}, "count_steps_by": "env_steps", "policy_map_capacity": 100, "policy_mapping_fn": "<function AlgorithmConfig.DEFAULT_POLICY_MAPPING_FN at 0x14f2edb20>", "policies_to_train": null, "policy_states_are_swappable": false, "observation_fn": null, "offline_data_class": null, "input_read_method": "read_parquet", "input_read_method_kwargs": {}, "input_read_schema": {}, "input_read_episodes": false, "input_read_sample_batches": false, "input_read_batch_size": null, "input_filesystem": null, "input_filesystem_kwargs": {}, "input_compress_columns": ["obs", "new_obs"], "input_spaces_jsonable": true, "materialize_data": false, "materialize_mapped_data": true, "map_batches_kwargs": {}, "iter_batches_kwargs": {}, "ignore_final_observation": false, "prelearner_class": null, "prelearner_buffer_class": null, "prelearner_buffer_kwargs": {}, "prelearner_module_synch_period": 10, "dataset_num_iters_per_learner": null, "input_config": {}, "actions_in_input_normalized": false, "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_config": {}, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "output_max_rows_per_file": null, "output_write_remaining_data": false, "output_write_method": "write_parquet", "output_write_method_kwargs": {}, "output_filesystem": null, "output_filesystem_kwargs": {}, "output_write_episodes": true, "offline_sampling": false, "evaluation_interval": 1, "evaluation_duration": 20, "evaluation_duration_unit": "episodes", "evaluation_sample_timeout_s": 120.0, "evaluation_auto_duration_min_env_steps_per_sample": 100, "evaluation_auto_duration_max_env_steps_per_sample": 2000, "evaluation_parallel_to_training": false, "evaluation_force_reset_envs_before_iteration": true, "evaluation_config": null, "off_policy_estimation_methods": {}, "ope_split_batch_by_episode": true, "evaluation_num_env_runners": 1, "in_evaluation": false, "sync_filters_on_rollout_workers_timeout_s": 10.0, "offline_evaluation_interval": null, "num_offline_eval_runners": 0, "offline_loss_for_module_fn": null, "offline_evaluation_duration": 1, "offline_evaluation_parallel_to_training": false, "offline_evaluation_timeout_s": 120.0, "num_cpus_per_offline_eval_runner": 1, "num_gpus_per_offline_eval_runner": 0, "custom_resources_per_offline_eval_runner": {}, "restart_failed_offline_eval_runners": true, "ignore_offline_eval_runner_failures": false, "max_num_offline_eval_runner_restarts": 1000, "offline_eval_runner_restore_timeout_s": 1800.0, "max_requests_in_flight_per_offline_eval_runner": 1, "validate_offline_eval_runners_after_construction": true, "offline_eval_runner_health_probe_timeout_s": 30.0, "offline_eval_rl_module_inference_only": false, "broadcast_offline_eval_runner_states": false, "offline_eval_batch_size_per_runner": 256, "dataset_num_iters_per_eval_runner": 1, "keep_per_episode_custom_metrics": false, "metrics_episode_collection_timeout_s": 60.0, "metrics_num_episodes_for_smoothing": 100, "min_time_s_per_iteration": null, "min_train_timesteps_per_iteration": 0, "min_sample_timesteps_per_iteration": 0, "log_gradients": true, "export_native_model_files": false, "checkpoint_trainable_policies_only": false, "logger_creator": null, "logger_config": null, "log_level": "WARN", "log_sys_usage": true, "fake_sampler": false, "seed": 3, "restart_failed_env_runners": true, "ignore_env_runner_failures": false, "max_num_env_runner_restarts": 1000, "delay_between_env_runner_restarts_s": 60.0, "restart_failed_sub_environments": false, "num_consecutive_env_runner_failures_tolerance": 100, "env_runner_health_probe_timeout_s": 30.0, "env_runner_restore_timeout_s": 1800.0, "_model_config": {}, "_rl_module_spec": "RLModuleSpec(module_class=None, observation_space=None, action_space=None, inference_only=False, learner_only=False, model_config=DefaultModelConfig(fcnet_hiddens=[60, 90], fcnet_activation='tanh', fcnet_kernel_initializer=None, fcnet_kernel_initializer_kwargs=None, fcnet_bias_initializer=None, fcnet_bias_initializer_kwargs=None, conv_filters=None, conv_activation='relu', conv_kernel_initializer=None, conv_kernel_initializer_kwargs=None, conv_bias_initializer=None, conv_bias_initializer_kwargs=None, head_fcnet_hiddens=[], head_fcnet_activation='relu', head_fcnet_kernel_initializer=None, head_fcnet_kernel_initializer_kwargs=None, head_fcnet_bias_initializer=None, head_fcnet_bias_initializer_kwargs=None, free_log_std=False, log_std_clip_param=20.0, vf_share_layers=True, use_lstm=False, max_seq_len=20, lstm_cell_size=256, lstm_use_prev_action=False, lstm_use_prev_reward=False, lstm_kernel_initializer=None, lstm_kernel_initializer_kwargs=None, lstm_bias_initializer=None, lstm_bias_initializer_kwargs=None), catalog_class=None, load_state_path=None, model_config_dict=None)", "algorithm_config_overrides_per_module": {}, "_per_module_overrides": {}, "_validate_config": true, "_use_msgpack_checkpoints": false, "_torch_grad_scaler_class": null, "_torch_lr_scheduler_classes": null, "_tf_policy_handles_more_than_one_loss": false, "_disable_preprocessor_api": false, "_disable_action_flattening": false, "_disable_initialize_loss_from_dummy_batch": false, "_dont_auto_sync_env_runner_states": false, "env_task_fn": -1, "enable_connectors": -1, "simple_optimizer": false, "policy_map_cache": -1, "worker_cls": -1, "synchronize_filters": -1, "enable_async_evaluation": -1, "custom_async_evaluation_function": -1, "_enable_rl_module_api": -1, "auto_wrap_old_gym_envs": -1, "always_attach_evaluation_results": -1, "replay_sequence_length": null, "_disable_execution_plan_api": -1, "use_critic": true, "use_gae": true, "use_kl_loss": true, "kl_coeff": 0.7464963036515, "kl_target": 0.0270990929592, "vf_loss_coeff": 0.6688075857018, "entropy_coeff": 0.0090570820258, "clip_param": 0.1221781641624, "vf_clip_param": 0.1027808522125, "entropy_coeff_schedule": null, "lr_schedule": null, "sgd_minibatch_size": -1, "vf_share_layers": -1, "__stdout_file__": null, "__stderr_file__": null, "lambda": 0.9099046732075, "input": "sampler", "policies": {"default_policy": [null, null, null, null]}, "callbacks": "<class 'ray.rllib.callbacks.callbacks.RLlibCallback'>", "create_env_on_driver": false, "custom_eval_function": null, "framework": "torch"}, "time_since_restore": 6.583838939666748, "iterations_since_restore": 2, "perf": {"cpu_util_percent": 71.22500000000001, "ram_util_percent": 77.975}}
{"timers": {"training_iteration": 3.450603856516257, "restore_env_runners": 5.362064004875719e-05, "training_step": 3.4501481684015363, "env_runner_sampling_timer": 3.2709082599421144, "learner_update_timer": 0.17425460066216766, "synch_weights": 0.0013002720287418924, "restore_eval_env_runners": 1.1202048044651747e-05, "evaluation_iteration": 0.19342215584008954, "synch_eval_env_connectors": 0.00020072329440154135, "synch_env_connectors": 7.141162641346455e-06}, "env_runners": {"episode_return_min": -13.5, "module_to_env_connector": {"connector_pipeline_timer": 0.0002131932613606752, "timers": {"connectors": {"normalize_and_clip_actions": 1.7405277585191812e-05, "un_batch_to_individual_items": 9.849921794910603e-06, "remove_single_ts_time_rank_from_batch": 1.1593726566594e-06, "tensor_to_numpy": 2.6592929642481958e-05, "listify_data_for_vector_env": 2.1281059281772364e-05, "get_actions": 9.139177332420436e-05}}}, "env_step_timer": 2.863441460360435e-05, "rlmodule_inference_timer": 6.129264964798594e-05, "env_reset_timer": 8.180742795901508e-05, "agent_episode_returns_mean": {"default_agent": -3.100000000000002}, "num_env_steps_sampled_lifetime": -607500.0, "weights_seq_no": 2.0, "env_to_module_sum_episodes_length_out": 10.36823839457432, "episode_len_max": 20, "env_to_module_connector": {"timers": {"connectors": {"batch_individual_items": 1.2486467222793483e-05, "numpy_to_tensor": 1.8222701379562613e-05, "add_time_dim_to_batch_and_zero_pad": 4.534829169665414e-06, "add_observations_from_episodes_to_batch": 5.641134073975886e-06, "add_states_from_episodes_to_batch": 2.831844314326687e-06}}, "connector_pipeline_timer": 7.92529661711406e-05}, "env_to_module_sum_episodes_length_in": 10.36823839457432, "sample": 0.009407203355458808, "num_agent_steps_sampled": {"default_agent": 5000.0}, "num_module_steps_sampled": {"default_policy": 5000.0}, "num_episodes_lifetime": -30375.0, "num_module_steps_sampled_lifetime": {"default_policy": -607500.0}, "num_agent_steps_sampled_lifetime": {"default_agent": -607500.0}, "time_between_sampling": 0.003075593593205487, "episode_len_mean": 20.0, "episode_return_mean": -3.100000000000002, "num_episodes": 250.0, "episode_duration_sec_mean": 0.00913073052512482, "episode_len_min": 20, "num_env_steps_sampled": 5000.0, "module_episode_returns_mean": {"default_policy": -3.100000000000002}, "episode_return_max": 6.5, "num_env_steps_sampled_lifetime_throughput": 2137.4309689283045}, "learners": {"__all_modules__": {"learner_connector": {"timers": {"connectors": {"add_columns_from_episodes_to_train_batch": 0.03746257307818159, "add_states_from_episodes_to_batch": 4.7284021857194606e-06, "add_one_ts_to_episodes_and_truncate": 0.01186953428281704, "numpy_to_tensor": 0.00020805408915039152, "batch_individual_items": 0.04639049591849326, "add_time_dim_to_batch_and_zero_pad": 1.297101192176342e-05, "general_advantage_estimation": 0.013672083381807898, "add_observations_from_episodes_to_batch": 0.0008717303640209139}}, "connector_pipeline_timer": 0.11088883785423824}, "num_module_steps_trained": 6000, "num_non_trainable_parameters": 0, "num_module_steps_trained_lifetime": 18000, "learner_connector_sum_episodes_length_in": 5000.0, "learner_connector_sum_episodes_length_out": 5250.0, "num_env_steps_trained": 31500, "num_trainable_parameters": 6003, "num_env_steps_trained_lifetime": 94500, "num_env_steps_trained_lifetime_throughput": 900677.8770369431, "num_module_steps_trained_throughput": 174842.4547799357, "num_module_steps_trained_lifetime_throughput": 174625.28337173918}, "default_policy": {"num_module_steps_trained": 6000, "curr_entropy_coeff": 0.0090570820258, "num_module_steps_trained_lifetime": 18000, "gradients_default_optimizer_global_norm": 0.024950962513685226, "entropy": 0.6908020377159119, "total_loss": -0.01838073693215847, "weights_seq_no": 3.0, "default_optimizer_learning_rate": 0.0002847858517, "curr_kl_coeff": 0.09331203997135162, "policy_loss": -0.07973822951316833, "vf_loss_unclipped": 28.8149471282959, "vf_explained_var": -0.012913346290588379, "mean_kl_loss": 0.004396282602101564, "num_trainable_parameters": 6003, "module_train_batch_size_mean": 1000.0, "diff_num_grad_updates_vs_sampler_policy": 1.0, "vf_loss": 0.09986981749534607, "num_module_steps_trained_lifetime_throughput": 175402.06199279038}}, "num_training_step_calls_per_iteration": 1, "evaluation": {"env_runners": {"num_module_steps_sampled_lifetime": {"default_policy": 1200}, "env_step_timer": 5.005733734721756e-05, "episode_duration_sec_mean": 0.009223835486530637, "num_module_steps_sampled": {"default_policy": 400}, "num_agent_steps_sampled_lifetime": {"default_agent": 1200}, "rlmodule_inference_timer": 7.560944698234052e-05, "weights_seq_no": 3.0, "env_to_module_sum_episodes_length_out": 10.368205581254823, "sample": 0.18285311759902395, "episode_len_mean": 20.0, "agent_episode_returns_mean": {"default_agent": 3.2666666666666666}, "env_to_module_connector": {"connector_pipeline_timer": 9.269957055352839e-05, "timers": {"connectors": {"add_observations_from_episodes_to_batch": 6.627099185397444e-06, "add_states_from_episodes_to_batch": 3.2573861163686495e-06, "numpy_to_tensor": 2.3475021332880986e-05, "batch_individual_items": 1.4983656268711377e-05, "add_time_dim_to_batch_and_zero_pad": 4.898310952725867e-06}}}, "episode_return_max": 13.5, "module_to_env_connector": {"timers": {"connectors": {"tensor_to_numpy": 3.7420675100589334e-05, "listify_data_for_vector_env": 2.325124906877784e-05, "normalize_and_clip_actions": 2.3630446478043585e-05, "un_batch_to_individual_items": 9.469631123724075e-06, "remove_single_ts_time_rank_from_batch": 1.423639595014684e-06, "get_actions": 0.00010158283651993618}}, "connector_pipeline_timer": 0.00024606188412620974}, "env_to_module_sum_episodes_length_in": 10.368205581254823, "num_episodes_lifetime": 60, "module_episode_returns_mean": {"default_policy": 3.2666666666666666}, "num_episodes": 20, "episode_len_min": 20, "num_agent_steps_sampled": {"default_agent": 400}, "episode_return_min": -13.5, "env_reset_timer": 0.000503424724470824, "num_env_steps_sampled_lifetime": 15400, "episode_len_max": 20, "episode_return_mean": 3.2666666666666666, "num_env_steps_sampled": 400, "time_between_sampling": 2.7533326339384074}, "num_healthy_workers": 1, "actor_manager_num_outstanding_async_reqs": 0, "num_remote_worker_restarts": 0}, "num_env_steps_sampled_lifetime": -607500.0, "fault_tolerance": {"num_healthy_workers": 0, "num_remote_worker_restarts": 0}, "env_runner_group": {"actor_manager_num_outstanding_async_reqs": 0}, "done": false, "training_iteration": 3, "trial_id": "469e6_00000", "date": "2025-08-11_19-33-10", "timestamp": 1754933590, "time_this_iter_s": 3.1614432334899902, "time_total_s": 9.745282173156738, "pid": 25834, "hostname": "Mac", "node_ip": "127.0.0.1", "config": {"exploration_config": {}, "extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "placement_strategy": "PACK", "num_gpus": 0, "_fake_gpus": false, "num_cpus_for_main_process": 2, "eager_tracing": true, "eager_max_retraces": 20, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "torch_compile_learner": false, "torch_compile_learner_what_to_compile": "forward_train", "torch_compile_learner_dynamo_backend": "aot_eager", "torch_compile_learner_dynamo_mode": null, "torch_compile_worker": false, "torch_compile_worker_dynamo_backend": "aot_eager", "torch_compile_worker_dynamo_mode": null, "torch_ddp_kwargs": {}, "torch_skip_nan_gradients": false, "env": "Umbrella", "env_config": {}, "observation_space": null, "action_space": null, "clip_rewards": null, "normalize_actions": true, "clip_actions": false, "_is_atari": null, "disable_env_checking": false, "render_env": false, "action_mask_key": "action_mask", "env_runner_cls": null, "num_env_runners": 0, "create_local_env_runner": true, "num_envs_per_env_runner": 1, "gym_env_vectorize_mode": "SYNC", "num_cpus_per_env_runner": 1, "num_gpus_per_env_runner": 0, "custom_resources_per_env_runner": {}, "validate_env_runners_after_construction": true, "episodes_to_numpy": true, "max_requests_in_flight_per_env_runner": 1, "sample_timeout_s": 60.0, "_env_to_module_connector": null, "add_default_connectors_to_env_to_module_pipeline": true, "_module_to_env_connector": null, "add_default_connectors_to_module_to_env_pipeline": true, "merge_env_runner_states": "training_only", "broadcast_env_runner_states": true, "episode_lookback_horizon": 1, "rollout_fragment_length": "auto", "batch_mode": "complete_episodes", "compress_observations": false, "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "enable_tf1_exec_eagerly": false, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "preprocessor_pref": "deepmind", "observation_filter": "NoFilter", "update_worker_filter_stats": true, "use_worker_filter_stats": true, "sampler_perf_stats_ema_coef": null, "_is_online": true, "num_learners": 0, "num_gpus_per_learner": 0, "num_cpus_per_learner": "auto", "num_aggregator_actors_per_learner": 0, "max_requests_in_flight_per_aggregator_actor": 3, "local_gpu_idx": 0, "max_requests_in_flight_per_learner": 3, "gamma": 1, "lr": 0.0002847858517, "grad_clip": 0.5, "grad_clip_by": "global_norm", "_train_batch_size_per_learner": 5000, "train_batch_size": 4000, "num_epochs": 1, "minibatch_size": 1000, "shuffle_batch_per_epoch": true, "model": {"fcnet_hiddens": [256, 256], "fcnet_activation": "tanh", "fcnet_weights_initializer": null, "fcnet_weights_initializer_config": null, "fcnet_bias_initializer": null, "fcnet_bias_initializer_config": null, "conv_filters": null, "conv_activation": "relu", "conv_kernel_initializer": null, "conv_kernel_initializer_config": null, "conv_bias_initializer": null, "conv_bias_initializer_config": null, "conv_transpose_kernel_initializer": null, "conv_transpose_kernel_initializer_config": null, "conv_transpose_bias_initializer": null, "conv_transpose_bias_initializer_config": null, "post_fcnet_hiddens": [], "post_fcnet_activation": "relu", "post_fcnet_weights_initializer": null, "post_fcnet_weights_initializer_config": null, "post_fcnet_bias_initializer": null, "post_fcnet_bias_initializer_config": null, "free_log_std": false, "log_std_clip_param": 20.0, "no_final_linear": false, "vf_share_layers": false, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "lstm_weights_initializer": null, "lstm_weights_initializer_config": null, "lstm_bias_initializer": null, "lstm_bias_initializer_config": null, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "attention_use_n_prev_actions": 0, "attention_use_n_prev_rewards": 0, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": null, "custom_model_config": {}, "custom_action_dist": null, "custom_preprocessor": null, "encoder_latent_dim": null, "always_check_shapes": false, "lstm_use_prev_action_reward": -1, "_use_default_native_models": -1, "_disable_preprocessor_api": false, "_disable_action_flattening": false}, "_learner_connector": null, "add_default_connectors_to_learner_pipeline": true, "learner_config_dict": {}, "optimizer": {}, "_learner_class": null, "callbacks_on_algorithm_init": null, "callbacks_on_env_runners_recreated": null, "callbacks_on_offline_eval_runners_recreated": null, "callbacks_on_checkpoint_loaded": null, "callbacks_on_environment_created": null, "callbacks_on_episode_created": null, "callbacks_on_episode_start": null, "callbacks_on_episode_step": null, "callbacks_on_episode_end": null, "callbacks_on_evaluate_start": null, "callbacks_on_evaluate_end": null, "callbacks_on_evaluate_offline_start": null, "callbacks_on_evaluate_offline_end": null, "callbacks_on_sample_end": null, "callbacks_on_train_result": null, "explore": true, "enable_rl_module_and_learner": true, "enable_env_runner_and_connector_v2": true, "_prior_exploration_config": {"type": "StochasticSampling"}, "count_steps_by": "env_steps", "policy_map_capacity": 100, "policy_mapping_fn": "<function AlgorithmConfig.DEFAULT_POLICY_MAPPING_FN at 0x14f2edb20>", "policies_to_train": null, "policy_states_are_swappable": false, "observation_fn": null, "offline_data_class": null, "input_read_method": "read_parquet", "input_read_method_kwargs": {}, "input_read_schema": {}, "input_read_episodes": false, "input_read_sample_batches": false, "input_read_batch_size": null, "input_filesystem": null, "input_filesystem_kwargs": {}, "input_compress_columns": ["obs", "new_obs"], "input_spaces_jsonable": true, "materialize_data": false, "materialize_mapped_data": true, "map_batches_kwargs": {}, "iter_batches_kwargs": {}, "ignore_final_observation": false, "prelearner_class": null, "prelearner_buffer_class": null, "prelearner_buffer_kwargs": {}, "prelearner_module_synch_period": 10, "dataset_num_iters_per_learner": null, "input_config": {}, "actions_in_input_normalized": false, "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_config": {}, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "output_max_rows_per_file": null, "output_write_remaining_data": false, "output_write_method": "write_parquet", "output_write_method_kwargs": {}, "output_filesystem": null, "output_filesystem_kwargs": {}, "output_write_episodes": true, "offline_sampling": false, "evaluation_interval": 1, "evaluation_duration": 20, "evaluation_duration_unit": "episodes", "evaluation_sample_timeout_s": 120.0, "evaluation_auto_duration_min_env_steps_per_sample": 100, "evaluation_auto_duration_max_env_steps_per_sample": 2000, "evaluation_parallel_to_training": false, "evaluation_force_reset_envs_before_iteration": true, "evaluation_config": null, "off_policy_estimation_methods": {}, "ope_split_batch_by_episode": true, "evaluation_num_env_runners": 1, "in_evaluation": false, "sync_filters_on_rollout_workers_timeout_s": 10.0, "offline_evaluation_interval": null, "num_offline_eval_runners": 0, "offline_loss_for_module_fn": null, "offline_evaluation_duration": 1, "offline_evaluation_parallel_to_training": false, "offline_evaluation_timeout_s": 120.0, "num_cpus_per_offline_eval_runner": 1, "num_gpus_per_offline_eval_runner": 0, "custom_resources_per_offline_eval_runner": {}, "restart_failed_offline_eval_runners": true, "ignore_offline_eval_runner_failures": false, "max_num_offline_eval_runner_restarts": 1000, "offline_eval_runner_restore_timeout_s": 1800.0, "max_requests_in_flight_per_offline_eval_runner": 1, "validate_offline_eval_runners_after_construction": true, "offline_eval_runner_health_probe_timeout_s": 30.0, "offline_eval_rl_module_inference_only": false, "broadcast_offline_eval_runner_states": false, "offline_eval_batch_size_per_runner": 256, "dataset_num_iters_per_eval_runner": 1, "keep_per_episode_custom_metrics": false, "metrics_episode_collection_timeout_s": 60.0, "metrics_num_episodes_for_smoothing": 100, "min_time_s_per_iteration": null, "min_train_timesteps_per_iteration": 0, "min_sample_timesteps_per_iteration": 0, "log_gradients": true, "export_native_model_files": false, "checkpoint_trainable_policies_only": false, "logger_creator": null, "logger_config": null, "log_level": "WARN", "log_sys_usage": true, "fake_sampler": false, "seed": 3, "restart_failed_env_runners": true, "ignore_env_runner_failures": false, "max_num_env_runner_restarts": 1000, "delay_between_env_runner_restarts_s": 60.0, "restart_failed_sub_environments": false, "num_consecutive_env_runner_failures_tolerance": 100, "env_runner_health_probe_timeout_s": 30.0, "env_runner_restore_timeout_s": 1800.0, "_model_config": {}, "_rl_module_spec": "RLModuleSpec(module_class=None, observation_space=None, action_space=None, inference_only=False, learner_only=False, model_config=DefaultModelConfig(fcnet_hiddens=[60, 90], fcnet_activation='tanh', fcnet_kernel_initializer=None, fcnet_kernel_initializer_kwargs=None, fcnet_bias_initializer=None, fcnet_bias_initializer_kwargs=None, conv_filters=None, conv_activation='relu', conv_kernel_initializer=None, conv_kernel_initializer_kwargs=None, conv_bias_initializer=None, conv_bias_initializer_kwargs=None, head_fcnet_hiddens=[], head_fcnet_activation='relu', head_fcnet_kernel_initializer=None, head_fcnet_kernel_initializer_kwargs=None, head_fcnet_bias_initializer=None, head_fcnet_bias_initializer_kwargs=None, free_log_std=False, log_std_clip_param=20.0, vf_share_layers=True, use_lstm=False, max_seq_len=20, lstm_cell_size=256, lstm_use_prev_action=False, lstm_use_prev_reward=False, lstm_kernel_initializer=None, lstm_kernel_initializer_kwargs=None, lstm_bias_initializer=None, lstm_bias_initializer_kwargs=None), catalog_class=None, load_state_path=None, model_config_dict=None)", "algorithm_config_overrides_per_module": {}, "_per_module_overrides": {}, "_validate_config": true, "_use_msgpack_checkpoints": false, "_torch_grad_scaler_class": null, "_torch_lr_scheduler_classes": null, "_tf_policy_handles_more_than_one_loss": false, "_disable_preprocessor_api": false, "_disable_action_flattening": false, "_disable_initialize_loss_from_dummy_batch": false, "_dont_auto_sync_env_runner_states": false, "env_task_fn": -1, "enable_connectors": -1, "simple_optimizer": false, "policy_map_cache": -1, "worker_cls": -1, "synchronize_filters": -1, "enable_async_evaluation": -1, "custom_async_evaluation_function": -1, "_enable_rl_module_api": -1, "auto_wrap_old_gym_envs": -1, "always_attach_evaluation_results": -1, "replay_sequence_length": null, "_disable_execution_plan_api": -1, "use_critic": true, "use_gae": true, "use_kl_loss": true, "kl_coeff": 0.7464963036515, "kl_target": 0.0270990929592, "vf_loss_coeff": 0.6688075857018, "entropy_coeff": 0.0090570820258, "clip_param": 0.1221781641624, "vf_clip_param": 0.1027808522125, "entropy_coeff_schedule": null, "lr_schedule": null, "sgd_minibatch_size": -1, "vf_share_layers": -1, "__stdout_file__": null, "__stderr_file__": null, "lambda": 0.9099046732075, "input": "sampler", "policies": {"default_policy": [null, null, null, null]}, "callbacks": "<class 'ray.rllib.callbacks.callbacks.RLlibCallback'>", "create_env_on_driver": false, "custom_eval_function": null, "framework": "torch"}, "time_since_restore": 9.745282173156738, "iterations_since_restore": 3, "perf": {"cpu_util_percent": 78.65, "ram_util_percent": 77.65}}
{"timers": {"training_iteration": 3.4441870758605453, "restore_env_runners": 5.3158603013958775e-05, "training_step": 3.44373343462765, "env_runner_sampling_timer": 3.2650405785920964, "learner_update_timer": 0.17370372215666216, "synch_weights": 0.0012970701490893262, "restore_eval_env_runners": 1.118586764205247e-05, "evaluation_iteration": 0.19378481511106946, "synch_eval_env_connectors": 0.00020214064166648312, "synch_env_connectors": 7.1701708715409045e-06}, "env_runners": {"episode_return_min": -13.5, "module_to_env_connector": {"connector_pipeline_timer": 0.0002005344348271255, "timers": {"connectors": {"normalize_and_clip_actions": 1.6165864159584557e-05, "un_batch_to_individual_items": 8.888592438902139e-06, "remove_single_ts_time_rank_from_batch": 1.0214606738702965e-06, "tensor_to_numpy": 2.4547326106875025e-05, "listify_data_for_vector_env": 2.0354510211088353e-05, "get_actions": 8.63819145274151e-05}}}, "env_step_timer": 2.7638681059614553e-05, "rlmodule_inference_timer": 5.656689300801785e-05, "env_reset_timer": 8.097193002396854e-05, "agent_episode_returns_mean": {"default_agent": -1.9799999999999998}, "num_env_steps_sampled_lifetime": -1225000.0, "weights_seq_no": 3.0, "env_to_module_sum_episodes_length_out": 10.36823839457432, "episode_len_max": 20, "env_to_module_connector": {"timers": {"connectors": {"batch_individual_items": 1.1705059696304217e-05, "numpy_to_tensor": 1.7400691174322833e-05, "add_time_dim_to_batch_and_zero_pad": 4.326076724859459e-06, "add_observations_from_episodes_to_batch": 5.33008947593258e-06, "add_states_from_episodes_to_batch": 2.7320110856328803e-06}}, "connector_pipeline_timer": 7.617503683145827e-05}, "env_to_module_sum_episodes_length_in": 10.36823839457432, "sample": 0.009311956071871439, "num_agent_steps_sampled": {"default_agent": 5000.0}, "num_module_steps_sampled": {"default_policy": 5000.0}, "num_episodes_lifetime": -61250.0, "num_module_steps_sampled_lifetime": {"default_policy": -1225000.0}, "num_agent_steps_sampled_lifetime": {"default_agent": -1225000.0}, "time_between_sampling": 0.0033190689939051822, "episode_len_mean": 20.0, "episode_return_mean": -1.9799999999999998, "num_episodes": 250.0, "episode_duration_sec_mean": 0.008617177032399921, "episode_len_min": 20, "num_env_steps_sampled": 5000.0, "module_episode_returns_mean": {"default_policy": -1.9799999999999998}, "episode_return_max": 6.5, "num_env_steps_sampled_lifetime_throughput": 2233.6418302396064}, "learners": {"__all_modules__": {"learner_connector": {"timers": {"connectors": {"add_columns_from_episodes_to_train_batch": 0.03751210359806474, "add_states_from_episodes_to_batch": 4.730288503342309e-06, "add_one_ts_to_episodes_and_truncate": 0.011883236440554145, "numpy_to_tensor": 0.00020666646738839333, "batch_individual_items": 0.04626378136966343, "add_time_dim_to_batch_and_zero_pad": 1.2970051327720284e-05, "general_advantage_estimation": 0.013598355467691902, "add_observations_from_episodes_to_batch": 0.0008740163897993044}}, "connector_pipeline_timer": 0.11074980947530039}, "num_module_steps_trained": 6000, "num_non_trainable_parameters": 0, "num_module_steps_trained_lifetime": 24000, "learner_connector_sum_episodes_length_in": 5000.0, "learner_connector_sum_episodes_length_out": 5250.0, "num_env_steps_trained": 31500, "num_trainable_parameters": 6003, "num_env_steps_trained_lifetime": 126000, "num_env_steps_trained_lifetime_throughput": 906052.8420132059, "num_module_steps_trained_throughput": 175801.4869368206, "num_module_steps_trained_lifetime_throughput": 175585.15604477323}, "default_policy": {"num_module_steps_trained": 6000, "curr_entropy_coeff": 0.0090570820258, "num_module_steps_trained_lifetime": 24000, "gradients_default_optimizer_global_norm": 0.022418634966015816, "entropy": 0.6751035451889038, "total_loss": 0.15422971546649933, "weights_seq_no": 4.0, "default_optimizer_learning_rate": 0.0002847858517, "curr_kl_coeff": 0.04665601998567581, "policy_loss": 0.09290732443332672, "vf_loss_unclipped": 29.42681121826172, "vf_explained_var": -0.01295316219329834, "mean_kl_loss": 0.005344749428331852, "num_trainable_parameters": 6003, "module_train_batch_size_mean": 1000.0, "diff_num_grad_updates_vs_sampler_policy": 1.0, "vf_loss": 0.1000857725739479, "num_module_steps_trained_lifetime_throughput": 176337.80739276216}}, "num_training_step_calls_per_iteration": 1, "evaluation": {"env_runners": {"num_module_steps_sampled_lifetime": {"default_policy": 1600}, "env_step_timer": 2.7802305756084834e-05, "episode_duration_sec_mean": 0.00936621725850273, "num_module_steps_sampled": {"default_policy": 400}, "num_agent_steps_sampled_lifetime": {"default_agent": 1600}, "rlmodule_inference_timer": 5.363097510479066e-05, "weights_seq_no": 4.0, "env_to_module_sum_episodes_length_out": 10.368237912813044, "sample": 0.18321830767296612, "episode_len_mean": 20.0, "agent_episode_returns_mean": {"default_agent": 2.35}, "env_to_module_connector": {"connector_pipeline_timer": 7.19169889101895e-05, "timers": {"connectors": {"add_observations_from_episodes_to_batch": 5.104688564373062e-06, "add_states_from_episodes_to_batch": 2.1886957144020745e-06, "numpy_to_tensor": 1.591904906579326e-05, "batch_individual_items": 1.0808412274090528e-05, "add_time_dim_to_batch_and_zero_pad": 3.9930425084020935e-06}}}, "episode_return_max": 13.5, "module_to_env_connector": {"timers": {"connectors": {"tensor_to_numpy": 2.3936739240011215e-05, "listify_data_for_vector_env": 1.953534921006518e-05, "normalize_and_clip_actions": 1.5657506414332014e-05, "un_batch_to_individual_items": 8.527088000433614e-06, "remove_single_ts_time_rank_from_batch": 1.2064201343809262e-06, "get_actions": 7.246287213828885e-05}}, "connector_pipeline_timer": 0.000182806353038831}, "env_to_module_sum_episodes_length_in": 10.368237912813044, "num_episodes_lifetime": 80, "module_episode_returns_mean": {"default_policy": 2.35}, "num_episodes": 20, "episode_len_min": 20, "num_agent_steps_sampled": {"default_agent": 400}, "episode_return_min": -13.5, "env_reset_timer": 0.0005080271478099749, "num_env_steps_sampled_lifetime": 20400, "episode_len_max": 20, "episode_return_mean": 2.35, "num_env_steps_sampled": 400, "time_between_sampling": 2.754282423428318}, "num_healthy_workers": 1, "actor_manager_num_outstanding_async_reqs": 0, "num_remote_worker_restarts": 0}, "num_env_steps_sampled_lifetime": -1225000.0, "fault_tolerance": {"num_healthy_workers": 0, "num_remote_worker_restarts": 0}, "env_runner_group": {"actor_manager_num_outstanding_async_reqs": 0}, "done": false, "training_iteration": 4, "trial_id": "469e6_00000", "date": "2025-08-11_19-33-13", "timestamp": 1754933593, "time_this_iter_s": 3.043519973754883, "time_total_s": 12.788802146911621, "pid": 25834, "hostname": "Mac", "node_ip": "127.0.0.1", "config": {"exploration_config": {}, "extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "placement_strategy": "PACK", "num_gpus": 0, "_fake_gpus": false, "num_cpus_for_main_process": 2, "eager_tracing": true, "eager_max_retraces": 20, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "torch_compile_learner": false, "torch_compile_learner_what_to_compile": "forward_train", "torch_compile_learner_dynamo_backend": "aot_eager", "torch_compile_learner_dynamo_mode": null, "torch_compile_worker": false, "torch_compile_worker_dynamo_backend": "aot_eager", "torch_compile_worker_dynamo_mode": null, "torch_ddp_kwargs": {}, "torch_skip_nan_gradients": false, "env": "Umbrella", "env_config": {}, "observation_space": null, "action_space": null, "clip_rewards": null, "normalize_actions": true, "clip_actions": false, "_is_atari": null, "disable_env_checking": false, "render_env": false, "action_mask_key": "action_mask", "env_runner_cls": null, "num_env_runners": 0, "create_local_env_runner": true, "num_envs_per_env_runner": 1, "gym_env_vectorize_mode": "SYNC", "num_cpus_per_env_runner": 1, "num_gpus_per_env_runner": 0, "custom_resources_per_env_runner": {}, "validate_env_runners_after_construction": true, "episodes_to_numpy": true, "max_requests_in_flight_per_env_runner": 1, "sample_timeout_s": 60.0, "_env_to_module_connector": null, "add_default_connectors_to_env_to_module_pipeline": true, "_module_to_env_connector": null, "add_default_connectors_to_module_to_env_pipeline": true, "merge_env_runner_states": "training_only", "broadcast_env_runner_states": true, "episode_lookback_horizon": 1, "rollout_fragment_length": "auto", "batch_mode": "complete_episodes", "compress_observations": false, "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "enable_tf1_exec_eagerly": false, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "preprocessor_pref": "deepmind", "observation_filter": "NoFilter", "update_worker_filter_stats": true, "use_worker_filter_stats": true, "sampler_perf_stats_ema_coef": null, "_is_online": true, "num_learners": 0, "num_gpus_per_learner": 0, "num_cpus_per_learner": "auto", "num_aggregator_actors_per_learner": 0, "max_requests_in_flight_per_aggregator_actor": 3, "local_gpu_idx": 0, "max_requests_in_flight_per_learner": 3, "gamma": 1, "lr": 0.0002847858517, "grad_clip": 0.5, "grad_clip_by": "global_norm", "_train_batch_size_per_learner": 5000, "train_batch_size": 4000, "num_epochs": 1, "minibatch_size": 1000, "shuffle_batch_per_epoch": true, "model": {"fcnet_hiddens": [256, 256], "fcnet_activation": "tanh", "fcnet_weights_initializer": null, "fcnet_weights_initializer_config": null, "fcnet_bias_initializer": null, "fcnet_bias_initializer_config": null, "conv_filters": null, "conv_activation": "relu", "conv_kernel_initializer": null, "conv_kernel_initializer_config": null, "conv_bias_initializer": null, "conv_bias_initializer_config": null, "conv_transpose_kernel_initializer": null, "conv_transpose_kernel_initializer_config": null, "conv_transpose_bias_initializer": null, "conv_transpose_bias_initializer_config": null, "post_fcnet_hiddens": [], "post_fcnet_activation": "relu", "post_fcnet_weights_initializer": null, "post_fcnet_weights_initializer_config": null, "post_fcnet_bias_initializer": null, "post_fcnet_bias_initializer_config": null, "free_log_std": false, "log_std_clip_param": 20.0, "no_final_linear": false, "vf_share_layers": false, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "lstm_weights_initializer": null, "lstm_weights_initializer_config": null, "lstm_bias_initializer": null, "lstm_bias_initializer_config": null, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "attention_use_n_prev_actions": 0, "attention_use_n_prev_rewards": 0, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": null, "custom_model_config": {}, "custom_action_dist": null, "custom_preprocessor": null, "encoder_latent_dim": null, "always_check_shapes": false, "lstm_use_prev_action_reward": -1, "_use_default_native_models": -1, "_disable_preprocessor_api": false, "_disable_action_flattening": false}, "_learner_connector": null, "add_default_connectors_to_learner_pipeline": true, "learner_config_dict": {}, "optimizer": {}, "_learner_class": null, "callbacks_on_algorithm_init": null, "callbacks_on_env_runners_recreated": null, "callbacks_on_offline_eval_runners_recreated": null, "callbacks_on_checkpoint_loaded": null, "callbacks_on_environment_created": null, "callbacks_on_episode_created": null, "callbacks_on_episode_start": null, "callbacks_on_episode_step": null, "callbacks_on_episode_end": null, "callbacks_on_evaluate_start": null, "callbacks_on_evaluate_end": null, "callbacks_on_evaluate_offline_start": null, "callbacks_on_evaluate_offline_end": null, "callbacks_on_sample_end": null, "callbacks_on_train_result": null, "explore": true, "enable_rl_module_and_learner": true, "enable_env_runner_and_connector_v2": true, "_prior_exploration_config": {"type": "StochasticSampling"}, "count_steps_by": "env_steps", "policy_map_capacity": 100, "policy_mapping_fn": "<function AlgorithmConfig.DEFAULT_POLICY_MAPPING_FN at 0x14f2edb20>", "policies_to_train": null, "policy_states_are_swappable": false, "observation_fn": null, "offline_data_class": null, "input_read_method": "read_parquet", "input_read_method_kwargs": {}, "input_read_schema": {}, "input_read_episodes": false, "input_read_sample_batches": false, "input_read_batch_size": null, "input_filesystem": null, "input_filesystem_kwargs": {}, "input_compress_columns": ["obs", "new_obs"], "input_spaces_jsonable": true, "materialize_data": false, "materialize_mapped_data": true, "map_batches_kwargs": {}, "iter_batches_kwargs": {}, "ignore_final_observation": false, "prelearner_class": null, "prelearner_buffer_class": null, "prelearner_buffer_kwargs": {}, "prelearner_module_synch_period": 10, "dataset_num_iters_per_learner": null, "input_config": {}, "actions_in_input_normalized": false, "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_config": {}, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "output_max_rows_per_file": null, "output_write_remaining_data": false, "output_write_method": "write_parquet", "output_write_method_kwargs": {}, "output_filesystem": null, "output_filesystem_kwargs": {}, "output_write_episodes": true, "offline_sampling": false, "evaluation_interval": 1, "evaluation_duration": 20, "evaluation_duration_unit": "episodes", "evaluation_sample_timeout_s": 120.0, "evaluation_auto_duration_min_env_steps_per_sample": 100, "evaluation_auto_duration_max_env_steps_per_sample": 2000, "evaluation_parallel_to_training": false, "evaluation_force_reset_envs_before_iteration": true, "evaluation_config": null, "off_policy_estimation_methods": {}, "ope_split_batch_by_episode": true, "evaluation_num_env_runners": 1, "in_evaluation": false, "sync_filters_on_rollout_workers_timeout_s": 10.0, "offline_evaluation_interval": null, "num_offline_eval_runners": 0, "offline_loss_for_module_fn": null, "offline_evaluation_duration": 1, "offline_evaluation_parallel_to_training": false, "offline_evaluation_timeout_s": 120.0, "num_cpus_per_offline_eval_runner": 1, "num_gpus_per_offline_eval_runner": 0, "custom_resources_per_offline_eval_runner": {}, "restart_failed_offline_eval_runners": true, "ignore_offline_eval_runner_failures": false, "max_num_offline_eval_runner_restarts": 1000, "offline_eval_runner_restore_timeout_s": 1800.0, "max_requests_in_flight_per_offline_eval_runner": 1, "validate_offline_eval_runners_after_construction": true, "offline_eval_runner_health_probe_timeout_s": 30.0, "offline_eval_rl_module_inference_only": false, "broadcast_offline_eval_runner_states": false, "offline_eval_batch_size_per_runner": 256, "dataset_num_iters_per_eval_runner": 1, "keep_per_episode_custom_metrics": false, "metrics_episode_collection_timeout_s": 60.0, "metrics_num_episodes_for_smoothing": 100, "min_time_s_per_iteration": null, "min_train_timesteps_per_iteration": 0, "min_sample_timesteps_per_iteration": 0, "log_gradients": true, "export_native_model_files": false, "checkpoint_trainable_policies_only": false, "logger_creator": null, "logger_config": null, "log_level": "WARN", "log_sys_usage": true, "fake_sampler": false, "seed": 3, "restart_failed_env_runners": true, "ignore_env_runner_failures": false, "max_num_env_runner_restarts": 1000, "delay_between_env_runner_restarts_s": 60.0, "restart_failed_sub_environments": false, "num_consecutive_env_runner_failures_tolerance": 100, "env_runner_health_probe_timeout_s": 30.0, "env_runner_restore_timeout_s": 1800.0, "_model_config": {}, "_rl_module_spec": "RLModuleSpec(module_class=None, observation_space=None, action_space=None, inference_only=False, learner_only=False, model_config=DefaultModelConfig(fcnet_hiddens=[60, 90], fcnet_activation='tanh', fcnet_kernel_initializer=None, fcnet_kernel_initializer_kwargs=None, fcnet_bias_initializer=None, fcnet_bias_initializer_kwargs=None, conv_filters=None, conv_activation='relu', conv_kernel_initializer=None, conv_kernel_initializer_kwargs=None, conv_bias_initializer=None, conv_bias_initializer_kwargs=None, head_fcnet_hiddens=[], head_fcnet_activation='relu', head_fcnet_kernel_initializer=None, head_fcnet_kernel_initializer_kwargs=None, head_fcnet_bias_initializer=None, head_fcnet_bias_initializer_kwargs=None, free_log_std=False, log_std_clip_param=20.0, vf_share_layers=True, use_lstm=False, max_seq_len=20, lstm_cell_size=256, lstm_use_prev_action=False, lstm_use_prev_reward=False, lstm_kernel_initializer=None, lstm_kernel_initializer_kwargs=None, lstm_bias_initializer=None, lstm_bias_initializer_kwargs=None), catalog_class=None, load_state_path=None, model_config_dict=None)", "algorithm_config_overrides_per_module": {}, "_per_module_overrides": {}, "_validate_config": true, "_use_msgpack_checkpoints": false, "_torch_grad_scaler_class": null, "_torch_lr_scheduler_classes": null, "_tf_policy_handles_more_than_one_loss": false, "_disable_preprocessor_api": false, "_disable_action_flattening": false, "_disable_initialize_loss_from_dummy_batch": false, "_dont_auto_sync_env_runner_states": false, "env_task_fn": -1, "enable_connectors": -1, "simple_optimizer": false, "policy_map_cache": -1, "worker_cls": -1, "synchronize_filters": -1, "enable_async_evaluation": -1, "custom_async_evaluation_function": -1, "_enable_rl_module_api": -1, "auto_wrap_old_gym_envs": -1, "always_attach_evaluation_results": -1, "replay_sequence_length": null, "_disable_execution_plan_api": -1, "use_critic": true, "use_gae": true, "use_kl_loss": true, "kl_coeff": 0.7464963036515, "kl_target": 0.0270990929592, "vf_loss_coeff": 0.6688075857018, "entropy_coeff": 0.0090570820258, "clip_param": 0.1221781641624, "vf_clip_param": 0.1027808522125, "entropy_coeff_schedule": null, "lr_schedule": null, "sgd_minibatch_size": -1, "vf_share_layers": -1, "__stdout_file__": null, "__stderr_file__": null, "lambda": 0.9099046732075, "input": "sampler", "policies": {"default_policy": [null, null, null, null]}, "callbacks": "<class 'ray.rllib.callbacks.callbacks.RLlibCallback'>", "create_env_on_driver": false, "custom_eval_function": null, "framework": "torch"}, "time_since_restore": 12.788802146911621, "iterations_since_restore": 4, "perf": {"cpu_util_percent": 49.739999999999995, "ram_util_percent": 77.74}}
{"timers": {"training_iteration": 3.4415466813511784, "restore_env_runners": 5.268243766192812e-05, "training_step": 3.44109543444096, "env_runner_sampling_timer": 3.261801502385482, "learner_update_timer": 0.17426348743559122, "synch_weights": 0.0013034469476544612, "restore_eval_env_runners": 1.1294009476667268e-05, "evaluation_iteration": 0.19414567986964607, "synch_eval_env_connectors": 0.0002017913248153636, "synch_env_connectors": 7.141389163676649e-06}, "env_runners": {"episode_return_min": -13.5, "module_to_env_connector": {"connector_pipeline_timer": 0.00021735038396518256, "timers": {"connectors": {"normalize_and_clip_actions": 1.763371825596769e-05, "un_batch_to_individual_items": 9.952708299773655e-06, "remove_single_ts_time_rank_from_batch": 1.2381688156206383e-06, "tensor_to_numpy": 2.6609498394778863e-05, "listify_data_for_vector_env": 2.1601155438332912e-05, "get_actions": 9.443198894554327e-05}}}, "env_step_timer": 2.930491307444313e-05, "rlmodule_inference_timer": 9.153729540067635e-05, "env_reset_timer": 8.011741317075909e-05, "agent_episode_returns_mean": {"default_agent": -2.6200000000000006}, "num_env_steps_sampled_lifetime": -1842500.0, "weights_seq_no": 4.0, "env_to_module_sum_episodes_length_out": 10.36823839457432, "episode_len_max": 20, "env_to_module_connector": {"timers": {"connectors": {"batch_individual_items": 1.2271049223997359e-05, "numpy_to_tensor": 1.863201028711933e-05, "add_time_dim_to_batch_and_zero_pad": 4.738397596641983e-06, "add_observations_from_episodes_to_batch": 5.628534914130706e-06, "add_states_from_episodes_to_batch": 2.694457288054256e-06}}, "connector_pipeline_timer": 7.929343721061349e-05}, "env_to_module_sum_episodes_length_in": 10.36823839457432, "sample": 0.009653303092042062, "num_agent_steps_sampled": {"default_agent": 5000.0}, "num_module_steps_sampled": {"default_policy": 5000.0}, "num_episodes_lifetime": -92125.0, "num_module_steps_sampled_lifetime": {"default_policy": -1842500.0}, "num_agent_steps_sampled_lifetime": {"default_agent": -1842500.0}, "time_between_sampling": 0.0027581570079182414, "episode_len_mean": 20.0, "episode_return_mean": -2.6200000000000006, "num_episodes": 250.0, "episode_duration_sec_mean": 0.009915602208580818, "episode_len_min": 20, "num_env_steps_sampled": 5000.0, "module_episode_returns_mean": {"default_policy": -2.6200000000000006}, "episode_return_max": 6.5, "num_env_steps_sampled_lifetime_throughput": 2170.620553384855}, "learners": {"__all_modules__": {"learner_connector": {"timers": {"connectors": {"add_columns_from_episodes_to_train_batch": 0.03774374922185053, "add_states_from_episodes_to_batch": 4.855066090420588e-06, "add_one_ts_to_episodes_and_truncate": 0.011927146996368503, "numpy_to_tensor": 0.00020586772272988919, "batch_individual_items": 0.04623597146647017, "add_time_dim_to_batch_and_zero_pad": 1.299576992569491e-05, "general_advantage_estimation": 0.013575865663119663, "add_observations_from_episodes_to_batch": 0.0008773278869344947}}, "connector_pipeline_timer": 0.1109768417902057}, "num_module_steps_trained": 6000, "num_non_trainable_parameters": 0, "num_module_steps_trained_lifetime": 30000, "learner_connector_sum_episodes_length_in": 5000.0, "learner_connector_sum_episodes_length_out": 5250.0, "num_env_steps_trained": 31500, "num_trainable_parameters": 6003, "num_env_steps_trained_lifetime": 157500, "num_env_steps_trained_lifetime_throughput": 902916.0074509912, "num_module_steps_trained_throughput": 175118.53176290364, "num_module_steps_trained_lifetime_throughput": 174903.70649275556}, "default_policy": {"num_module_steps_trained": 6000, "curr_entropy_coeff": 0.0090570820258, "num_module_steps_trained_lifetime": 30000, "gradients_default_optimizer_global_norm": 0.3873364329338074, "entropy": 0.6418144702911377, "total_loss": -0.028190553188323975, "weights_seq_no": 5.0, "default_optimizer_learning_rate": 0.0002847858517, "curr_kl_coeff": 0.023328009992837906, "policy_loss": -0.08939778804779053, "vf_loss_unclipped": 28.310836791992188, "vf_explained_var": -0.012333512306213379, "mean_kl_loss": 0.006403516978025436, "num_trainable_parameters": 6003, "module_train_batch_size_mean": 1000.0, "diff_num_grad_updates_vs_sampler_policy": 1.0, "vf_loss": 0.09976178407669067, "num_module_steps_trained_lifetime_throughput": 175630.8032735111}}, "num_training_step_calls_per_iteration": 1, "evaluation": {"env_runners": {"num_module_steps_sampled_lifetime": {"default_policy": 2000}, "env_step_timer": 1.991098901181743e-05, "episode_duration_sec_mean": 0.009297169214114546, "num_module_steps_sampled": {"default_policy": 400}, "num_agent_steps_sampled_lifetime": {"default_agent": 2000}, "rlmodule_inference_timer": 4.113647778157788e-05, "weights_seq_no": 5.0, "env_to_module_sum_episodes_length_out": 10.368238387501162, "sample": 0.18334895334532875, "episode_len_mean": 20.0, "agent_episode_returns_mean": {"default_agent": 2.0}, "env_to_module_connector": {"connector_pipeline_timer": 5.445228286343938e-05, "timers": {"connectors": {"add_observations_from_episodes_to_batch": 3.55223667344085e-06, "add_states_from_episodes_to_batch": 1.8595122934794719e-06, "numpy_to_tensor": 1.1754910913900614e-05, "batch_individual_items": 8.402424117097504e-06, "add_time_dim_to_batch_and_zero_pad": 2.7970530319543265e-06}}}, "episode_return_max": 13.5, "module_to_env_connector": {"timers": {"connectors": {"tensor_to_numpy": 2.0755526622979423e-05, "listify_data_for_vector_env": 1.4035956374349163e-05, "normalize_and_clip_actions": 1.2975951997810475e-05, "un_batch_to_individual_items": 7.044454079645667e-06, "remove_single_ts_time_rank_from_batch": 8.41415967565562e-07, "get_actions": 5.677273414510474e-05}}, "connector_pipeline_timer": 0.00014542336896672156}, "env_to_module_sum_episodes_length_in": 10.368238387501162, "num_episodes_lifetime": 100, "module_episode_returns_mean": {"default_policy": 2.0}, "num_episodes": 20, "episode_len_min": 20, "num_agent_steps_sampled": {"default_agent": 400}, "episode_return_min": -13.5, "env_reset_timer": 0.0005048593763426785, "num_env_steps_sampled_lifetime": 25400, "episode_len_max": 20, "episode_return_mean": 2.0, "num_env_steps_sampled": 400, "time_between_sampling": 2.7588283412744126}, "num_healthy_workers": 1, "actor_manager_num_outstanding_async_reqs": 0, "num_remote_worker_restarts": 0}, "num_env_steps_sampled_lifetime": -1842500.0, "fault_tolerance": {"num_healthy_workers": 0, "num_remote_worker_restarts": 0}, "env_runner_group": {"actor_manager_num_outstanding_async_reqs": 0}, "done": false, "training_iteration": 5, "trial_id": "469e6_00000", "date": "2025-08-11_19-33-16", "timestamp": 1754933596, "time_this_iter_s": 3.390737295150757, "time_total_s": 16.179539442062378, "pid": 25834, "hostname": "Mac", "node_ip": "127.0.0.1", "config": {"exploration_config": {}, "extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "placement_strategy": "PACK", "num_gpus": 0, "_fake_gpus": false, "num_cpus_for_main_process": 2, "eager_tracing": true, "eager_max_retraces": 20, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "torch_compile_learner": false, "torch_compile_learner_what_to_compile": "forward_train", "torch_compile_learner_dynamo_backend": "aot_eager", "torch_compile_learner_dynamo_mode": null, "torch_compile_worker": false, "torch_compile_worker_dynamo_backend": "aot_eager", "torch_compile_worker_dynamo_mode": null, "torch_ddp_kwargs": {}, "torch_skip_nan_gradients": false, "env": "Umbrella", "env_config": {}, "observation_space": null, "action_space": null, "clip_rewards": null, "normalize_actions": true, "clip_actions": false, "_is_atari": null, "disable_env_checking": false, "render_env": false, "action_mask_key": "action_mask", "env_runner_cls": null, "num_env_runners": 0, "create_local_env_runner": true, "num_envs_per_env_runner": 1, "gym_env_vectorize_mode": "SYNC", "num_cpus_per_env_runner": 1, "num_gpus_per_env_runner": 0, "custom_resources_per_env_runner": {}, "validate_env_runners_after_construction": true, "episodes_to_numpy": true, "max_requests_in_flight_per_env_runner": 1, "sample_timeout_s": 60.0, "_env_to_module_connector": null, "add_default_connectors_to_env_to_module_pipeline": true, "_module_to_env_connector": null, "add_default_connectors_to_module_to_env_pipeline": true, "merge_env_runner_states": "training_only", "broadcast_env_runner_states": true, "episode_lookback_horizon": 1, "rollout_fragment_length": "auto", "batch_mode": "complete_episodes", "compress_observations": false, "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "enable_tf1_exec_eagerly": false, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "preprocessor_pref": "deepmind", "observation_filter": "NoFilter", "update_worker_filter_stats": true, "use_worker_filter_stats": true, "sampler_perf_stats_ema_coef": null, "_is_online": true, "num_learners": 0, "num_gpus_per_learner": 0, "num_cpus_per_learner": "auto", "num_aggregator_actors_per_learner": 0, "max_requests_in_flight_per_aggregator_actor": 3, "local_gpu_idx": 0, "max_requests_in_flight_per_learner": 3, "gamma": 1, "lr": 0.0002847858517, "grad_clip": 0.5, "grad_clip_by": "global_norm", "_train_batch_size_per_learner": 5000, "train_batch_size": 4000, "num_epochs": 1, "minibatch_size": 1000, "shuffle_batch_per_epoch": true, "model": {"fcnet_hiddens": [256, 256], "fcnet_activation": "tanh", "fcnet_weights_initializer": null, "fcnet_weights_initializer_config": null, "fcnet_bias_initializer": null, "fcnet_bias_initializer_config": null, "conv_filters": null, "conv_activation": "relu", "conv_kernel_initializer": null, "conv_kernel_initializer_config": null, "conv_bias_initializer": null, "conv_bias_initializer_config": null, "conv_transpose_kernel_initializer": null, "conv_transpose_kernel_initializer_config": null, "conv_transpose_bias_initializer": null, "conv_transpose_bias_initializer_config": null, "post_fcnet_hiddens": [], "post_fcnet_activation": "relu", "post_fcnet_weights_initializer": null, "post_fcnet_weights_initializer_config": null, "post_fcnet_bias_initializer": null, "post_fcnet_bias_initializer_config": null, "free_log_std": false, "log_std_clip_param": 20.0, "no_final_linear": false, "vf_share_layers": false, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "lstm_weights_initializer": null, "lstm_weights_initializer_config": null, "lstm_bias_initializer": null, "lstm_bias_initializer_config": null, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "attention_use_n_prev_actions": 0, "attention_use_n_prev_rewards": 0, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": null, "custom_model_config": {}, "custom_action_dist": null, "custom_preprocessor": null, "encoder_latent_dim": null, "always_check_shapes": false, "lstm_use_prev_action_reward": -1, "_use_default_native_models": -1, "_disable_preprocessor_api": false, "_disable_action_flattening": false}, "_learner_connector": null, "add_default_connectors_to_learner_pipeline": true, "learner_config_dict": {}, "optimizer": {}, "_learner_class": null, "callbacks_on_algorithm_init": null, "callbacks_on_env_runners_recreated": null, "callbacks_on_offline_eval_runners_recreated": null, "callbacks_on_checkpoint_loaded": null, "callbacks_on_environment_created": null, "callbacks_on_episode_created": null, "callbacks_on_episode_start": null, "callbacks_on_episode_step": null, "callbacks_on_episode_end": null, "callbacks_on_evaluate_start": null, "callbacks_on_evaluate_end": null, "callbacks_on_evaluate_offline_start": null, "callbacks_on_evaluate_offline_end": null, "callbacks_on_sample_end": null, "callbacks_on_train_result": null, "explore": true, "enable_rl_module_and_learner": true, "enable_env_runner_and_connector_v2": true, "_prior_exploration_config": {"type": "StochasticSampling"}, "count_steps_by": "env_steps", "policy_map_capacity": 100, "policy_mapping_fn": "<function AlgorithmConfig.DEFAULT_POLICY_MAPPING_FN at 0x14f2edb20>", "policies_to_train": null, "policy_states_are_swappable": false, "observation_fn": null, "offline_data_class": null, "input_read_method": "read_parquet", "input_read_method_kwargs": {}, "input_read_schema": {}, "input_read_episodes": false, "input_read_sample_batches": false, "input_read_batch_size": null, "input_filesystem": null, "input_filesystem_kwargs": {}, "input_compress_columns": ["obs", "new_obs"], "input_spaces_jsonable": true, "materialize_data": false, "materialize_mapped_data": true, "map_batches_kwargs": {}, "iter_batches_kwargs": {}, "ignore_final_observation": false, "prelearner_class": null, "prelearner_buffer_class": null, "prelearner_buffer_kwargs": {}, "prelearner_module_synch_period": 10, "dataset_num_iters_per_learner": null, "input_config": {}, "actions_in_input_normalized": false, "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_config": {}, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "output_max_rows_per_file": null, "output_write_remaining_data": false, "output_write_method": "write_parquet", "output_write_method_kwargs": {}, "output_filesystem": null, "output_filesystem_kwargs": {}, "output_write_episodes": true, "offline_sampling": false, "evaluation_interval": 1, "evaluation_duration": 20, "evaluation_duration_unit": "episodes", "evaluation_sample_timeout_s": 120.0, "evaluation_auto_duration_min_env_steps_per_sample": 100, "evaluation_auto_duration_max_env_steps_per_sample": 2000, "evaluation_parallel_to_training": false, "evaluation_force_reset_envs_before_iteration": true, "evaluation_config": null, "off_policy_estimation_methods": {}, "ope_split_batch_by_episode": true, "evaluation_num_env_runners": 1, "in_evaluation": false, "sync_filters_on_rollout_workers_timeout_s": 10.0, "offline_evaluation_interval": null, "num_offline_eval_runners": 0, "offline_loss_for_module_fn": null, "offline_evaluation_duration": 1, "offline_evaluation_parallel_to_training": false, "offline_evaluation_timeout_s": 120.0, "num_cpus_per_offline_eval_runner": 1, "num_gpus_per_offline_eval_runner": 0, "custom_resources_per_offline_eval_runner": {}, "restart_failed_offline_eval_runners": true, "ignore_offline_eval_runner_failures": false, "max_num_offline_eval_runner_restarts": 1000, "offline_eval_runner_restore_timeout_s": 1800.0, "max_requests_in_flight_per_offline_eval_runner": 1, "validate_offline_eval_runners_after_construction": true, "offline_eval_runner_health_probe_timeout_s": 30.0, "offline_eval_rl_module_inference_only": false, "broadcast_offline_eval_runner_states": false, "offline_eval_batch_size_per_runner": 256, "dataset_num_iters_per_eval_runner": 1, "keep_per_episode_custom_metrics": false, "metrics_episode_collection_timeout_s": 60.0, "metrics_num_episodes_for_smoothing": 100, "min_time_s_per_iteration": null, "min_train_timesteps_per_iteration": 0, "min_sample_timesteps_per_iteration": 0, "log_gradients": true, "export_native_model_files": false, "checkpoint_trainable_policies_only": false, "logger_creator": null, "logger_config": null, "log_level": "WARN", "log_sys_usage": true, "fake_sampler": false, "seed": 3, "restart_failed_env_runners": true, "ignore_env_runner_failures": false, "max_num_env_runner_restarts": 1000, "delay_between_env_runner_restarts_s": 60.0, "restart_failed_sub_environments": false, "num_consecutive_env_runner_failures_tolerance": 100, "env_runner_health_probe_timeout_s": 30.0, "env_runner_restore_timeout_s": 1800.0, "_model_config": {}, "_rl_module_spec": "RLModuleSpec(module_class=None, observation_space=None, action_space=None, inference_only=False, learner_only=False, model_config=DefaultModelConfig(fcnet_hiddens=[60, 90], fcnet_activation='tanh', fcnet_kernel_initializer=None, fcnet_kernel_initializer_kwargs=None, fcnet_bias_initializer=None, fcnet_bias_initializer_kwargs=None, conv_filters=None, conv_activation='relu', conv_kernel_initializer=None, conv_kernel_initializer_kwargs=None, conv_bias_initializer=None, conv_bias_initializer_kwargs=None, head_fcnet_hiddens=[], head_fcnet_activation='relu', head_fcnet_kernel_initializer=None, head_fcnet_kernel_initializer_kwargs=None, head_fcnet_bias_initializer=None, head_fcnet_bias_initializer_kwargs=None, free_log_std=False, log_std_clip_param=20.0, vf_share_layers=True, use_lstm=False, max_seq_len=20, lstm_cell_size=256, lstm_use_prev_action=False, lstm_use_prev_reward=False, lstm_kernel_initializer=None, lstm_kernel_initializer_kwargs=None, lstm_bias_initializer=None, lstm_bias_initializer_kwargs=None), catalog_class=None, load_state_path=None, model_config_dict=None)", "algorithm_config_overrides_per_module": {}, "_per_module_overrides": {}, "_validate_config": true, "_use_msgpack_checkpoints": false, "_torch_grad_scaler_class": null, "_torch_lr_scheduler_classes": null, "_tf_policy_handles_more_than_one_loss": false, "_disable_preprocessor_api": false, "_disable_action_flattening": false, "_disable_initialize_loss_from_dummy_batch": false, "_dont_auto_sync_env_runner_states": false, "env_task_fn": -1, "enable_connectors": -1, "simple_optimizer": false, "policy_map_cache": -1, "worker_cls": -1, "synchronize_filters": -1, "enable_async_evaluation": -1, "custom_async_evaluation_function": -1, "_enable_rl_module_api": -1, "auto_wrap_old_gym_envs": -1, "always_attach_evaluation_results": -1, "replay_sequence_length": null, "_disable_execution_plan_api": -1, "use_critic": true, "use_gae": true, "use_kl_loss": true, "kl_coeff": 0.7464963036515, "kl_target": 0.0270990929592, "vf_loss_coeff": 0.6688075857018, "entropy_coeff": 0.0090570820258, "clip_param": 0.1221781641624, "vf_clip_param": 0.1027808522125, "entropy_coeff_schedule": null, "lr_schedule": null, "sgd_minibatch_size": -1, "vf_share_layers": -1, "__stdout_file__": null, "__stderr_file__": null, "lambda": 0.9099046732075, "input": "sampler", "policies": {"default_policy": [null, null, null, null]}, "callbacks": "<class 'ray.rllib.callbacks.callbacks.RLlibCallback'>", "create_env_on_driver": false, "custom_eval_function": null, "framework": "torch"}, "time_since_restore": 16.179539442062378, "iterations_since_restore": 5, "perf": {"cpu_util_percent": 61.36, "ram_util_percent": 78.05999999999999}}
{"timers": {"training_iteration": 3.441663776207724, "restore_env_runners": 5.2216023524111264e-05, "training_step": 3.4412148867664967, "env_runner_sampling_timer": 3.260772235271618, "learner_update_timer": 0.17542329964194062, "synch_weights": 0.0013007324775970693, "restore_eval_env_runners": 1.126149025037186e-05, "evaluation_iteration": 0.1942440722400363, "synch_eval_env_connectors": 0.0002015967514113325, "synch_env_connectors": 7.109135057996027e-06}, "env_runners": {"episode_return_min": -13.5, "module_to_env_connector": {"connector_pipeline_timer": 0.0002533708431288064, "timers": {"connectors": {"normalize_and_clip_actions": 1.9756931489235936e-05, "un_batch_to_individual_items": 1.097412400157206e-05, "remove_single_ts_time_rank_from_batch": 1.3332349411485177e-06, "tensor_to_numpy": 3.138521696723828e-05, "listify_data_for_vector_env": 2.5133513952370888e-05, "get_actions": 0.00010987822346195206}}}, "env_step_timer": 3.454813763112058e-05, "rlmodule_inference_timer": 7.354967801833467e-05, "env_reset_timer": 9.194764676566553e-05, "agent_episode_returns_mean": {"default_agent": 0.26}, "num_env_steps_sampled_lifetime": -2460000.0, "weights_seq_no": 5.0, "env_to_module_sum_episodes_length_out": 10.36823839457432, "episode_len_max": 20, "env_to_module_connector": {"timers": {"connectors": {"batch_individual_items": 1.4961969771316828e-05, "numpy_to_tensor": 2.2461016854257553e-05, "add_time_dim_to_batch_and_zero_pad": 5.144872018438848e-06, "add_observations_from_episodes_to_batch": 6.264012707763597e-06, "add_states_from_episodes_to_batch": 3.2139594621756655e-06}}, "connector_pipeline_timer": 9.188799718774863e-05}, "env_to_module_sum_episodes_length_in": 10.36823839457432, "sample": 0.01153567921579694, "num_agent_steps_sampled": {"default_agent": 5000.0}, "num_module_steps_sampled": {"default_policy": 5000.0}, "num_episodes_lifetime": -123000.0, "num_module_steps_sampled_lifetime": {"default_policy": -2460000.0}, "num_agent_steps_sampled_lifetime": {"default_agent": -2460000.0}, "time_between_sampling": 0.003103559249697926, "episode_len_mean": 20.0, "episode_return_mean": 0.26, "num_episodes": 250.0, "episode_duration_sec_mean": 0.010697942649014294, "episode_len_min": 20, "num_env_steps_sampled": 5000.0, "module_episode_returns_mean": {"default_policy": 0.26}, "episode_return_max": 6.5, "num_env_steps_sampled_lifetime_throughput": 1913.9957496401619}, "learners": {"__all_modules__": {"learner_connector": {"timers": {"connectors": {"add_columns_from_episodes_to_train_batch": 0.03786756255917967, "add_states_from_episodes_to_batch": 4.8448451742279005e-06, "add_one_ts_to_episodes_and_truncate": 0.011924995526472916, "numpy_to_tensor": 0.00020702404437181567, "batch_individual_items": 0.04774675800204411, "add_time_dim_to_batch_and_zero_pad": 1.309998164629284e-05, "general_advantage_estimation": 0.01351751283686804, "add_observations_from_episodes_to_batch": 0.0008831771082314468}}, "connector_pipeline_timer": 0.11255558920239019}, "num_module_steps_trained": 6000, "num_non_trainable_parameters": 0, "num_module_steps_trained_lifetime": 36000, "learner_connector_sum_episodes_length_in": 5000.0, "learner_connector_sum_episodes_length_out": 5250.0, "num_env_steps_trained": 31500, "num_trainable_parameters": 6003, "num_env_steps_trained_lifetime": 189000, "num_env_steps_trained_lifetime_throughput": 906988.646847346, "num_module_steps_trained_throughput": 175796.924060603, "num_module_steps_trained_lifetime_throughput": 175583.33979882766}, "default_policy": {"num_module_steps_trained": 6000, "curr_entropy_coeff": 0.0090570820258, "num_module_steps_trained_lifetime": 36000, "gradients_default_optimizer_global_norm": 0.12068164348602295, "entropy": 0.6319625973701477, "total_loss": -0.017150528728961945, "weights_seq_no": 6.0, "default_optimizer_learning_rate": 0.0002847858517, "curr_kl_coeff": 0.011664004996418953, "policy_loss": -0.07772266864776611, "vf_loss_unclipped": 26.507795333862305, "vf_explained_var": -0.010851740837097168, "mean_kl_loss": 0.00032041617669165134, "num_trainable_parameters": 6003, "module_train_batch_size_mean": 1000.0, "diff_num_grad_updates_vs_sampler_policy": 1.0, "vf_loss": 0.0991143062710762, "num_module_steps_trained_lifetime_throughput": 176275.85448808098}}, "num_training_step_calls_per_iteration": 1, "evaluation": {"env_runners": {"num_module_steps_sampled_lifetime": {"default_policy": 2400}, "env_step_timer": 2.9001370412156326e-05, "episode_duration_sec_mean": 0.009225155841559172, "num_module_steps_sampled": {"default_policy": 400}, "num_agent_steps_sampled_lifetime": {"default_agent": 2400}, "rlmodule_inference_timer": 6.0625132331674315e-05, "weights_seq_no": 6.0, "env_to_module_sum_episodes_length_out": 10.368238394470474, "sample": 0.18323440881219613, "episode_len_mean": 20.0, "agent_episode_returns_mean": {"default_agent": 1.6}, "env_to_module_connector": {"connector_pipeline_timer": 8.282230554593484e-05, "timers": {"connectors": {"add_observations_from_episodes_to_batch": 4.45409514253154e-06, "add_states_from_episodes_to_batch": 3.0036913250225373e-06, "numpy_to_tensor": 1.9568683360795373e-05, "batch_individual_items": 1.4537634062058158e-05, "add_time_dim_to_batch_and_zero_pad": 4.224847901952558e-06}}}, "episode_return_max": 13.5, "module_to_env_connector": {"timers": {"connectors": {"tensor_to_numpy": 2.6826705883191756e-05, "listify_data_for_vector_env": 2.218204079519434e-05, "normalize_and_clip_actions": 1.8502677552514796e-05, "un_batch_to_individual_items": 9.317509163233308e-06, "remove_single_ts_time_rank_from_batch": 1.3453943422571498e-06, "get_actions": 8.30726491937783e-05}}, "connector_pipeline_timer": 0.00020893700985477641}, "env_to_module_sum_episodes_length_in": 10.368238394470474, "num_episodes_lifetime": 120, "module_episode_returns_mean": {"default_policy": 1.6}, "num_episodes": 20, "episode_len_min": 20, "num_agent_steps_sampled": {"default_agent": 400}, "episode_return_min": -13.5, "env_reset_timer": 0.00050114286257095, "num_env_steps_sampled_lifetime": 30400, "episode_len_max": 20, "episode_return_mean": 1.6, "num_env_steps_sampled": 400, "time_between_sampling": 2.7660169403618236}, "num_healthy_workers": 1, "actor_manager_num_outstanding_async_reqs": 0, "num_remote_worker_restarts": 0}, "num_env_steps_sampled_lifetime": -2460000.0, "fault_tolerance": {"num_healthy_workers": 0, "num_remote_worker_restarts": 0}, "env_runner_group": {"actor_manager_num_outstanding_async_reqs": 0}, "done": false, "training_iteration": 6, "trial_id": "469e6_00000", "date": "2025-08-11_19-33-20", "timestamp": 1754933600, "time_this_iter_s": 3.6366629600524902, "time_total_s": 19.816202402114868, "pid": 25834, "hostname": "Mac", "node_ip": "127.0.0.1", "config": {"exploration_config": {}, "extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "placement_strategy": "PACK", "num_gpus": 0, "_fake_gpus": false, "num_cpus_for_main_process": 2, "eager_tracing": true, "eager_max_retraces": 20, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "torch_compile_learner": false, "torch_compile_learner_what_to_compile": "forward_train", "torch_compile_learner_dynamo_backend": "aot_eager", "torch_compile_learner_dynamo_mode": null, "torch_compile_worker": false, "torch_compile_worker_dynamo_backend": "aot_eager", "torch_compile_worker_dynamo_mode": null, "torch_ddp_kwargs": {}, "torch_skip_nan_gradients": false, "env": "Umbrella", "env_config": {}, "observation_space": null, "action_space": null, "clip_rewards": null, "normalize_actions": true, "clip_actions": false, "_is_atari": null, "disable_env_checking": false, "render_env": false, "action_mask_key": "action_mask", "env_runner_cls": null, "num_env_runners": 0, "create_local_env_runner": true, "num_envs_per_env_runner": 1, "gym_env_vectorize_mode": "SYNC", "num_cpus_per_env_runner": 1, "num_gpus_per_env_runner": 0, "custom_resources_per_env_runner": {}, "validate_env_runners_after_construction": true, "episodes_to_numpy": true, "max_requests_in_flight_per_env_runner": 1, "sample_timeout_s": 60.0, "_env_to_module_connector": null, "add_default_connectors_to_env_to_module_pipeline": true, "_module_to_env_connector": null, "add_default_connectors_to_module_to_env_pipeline": true, "merge_env_runner_states": "training_only", "broadcast_env_runner_states": true, "episode_lookback_horizon": 1, "rollout_fragment_length": "auto", "batch_mode": "complete_episodes", "compress_observations": false, "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "enable_tf1_exec_eagerly": false, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "preprocessor_pref": "deepmind", "observation_filter": "NoFilter", "update_worker_filter_stats": true, "use_worker_filter_stats": true, "sampler_perf_stats_ema_coef": null, "_is_online": true, "num_learners": 0, "num_gpus_per_learner": 0, "num_cpus_per_learner": "auto", "num_aggregator_actors_per_learner": 0, "max_requests_in_flight_per_aggregator_actor": 3, "local_gpu_idx": 0, "max_requests_in_flight_per_learner": 3, "gamma": 1, "lr": 0.0002847858517, "grad_clip": 0.5, "grad_clip_by": "global_norm", "_train_batch_size_per_learner": 5000, "train_batch_size": 4000, "num_epochs": 1, "minibatch_size": 1000, "shuffle_batch_per_epoch": true, "model": {"fcnet_hiddens": [256, 256], "fcnet_activation": "tanh", "fcnet_weights_initializer": null, "fcnet_weights_initializer_config": null, "fcnet_bias_initializer": null, "fcnet_bias_initializer_config": null, "conv_filters": null, "conv_activation": "relu", "conv_kernel_initializer": null, "conv_kernel_initializer_config": null, "conv_bias_initializer": null, "conv_bias_initializer_config": null, "conv_transpose_kernel_initializer": null, "conv_transpose_kernel_initializer_config": null, "conv_transpose_bias_initializer": null, "conv_transpose_bias_initializer_config": null, "post_fcnet_hiddens": [], "post_fcnet_activation": "relu", "post_fcnet_weights_initializer": null, "post_fcnet_weights_initializer_config": null, "post_fcnet_bias_initializer": null, "post_fcnet_bias_initializer_config": null, "free_log_std": false, "log_std_clip_param": 20.0, "no_final_linear": false, "vf_share_layers": false, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "lstm_weights_initializer": null, "lstm_weights_initializer_config": null, "lstm_bias_initializer": null, "lstm_bias_initializer_config": null, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "attention_use_n_prev_actions": 0, "attention_use_n_prev_rewards": 0, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": null, "custom_model_config": {}, "custom_action_dist": null, "custom_preprocessor": null, "encoder_latent_dim": null, "always_check_shapes": false, "lstm_use_prev_action_reward": -1, "_use_default_native_models": -1, "_disable_preprocessor_api": false, "_disable_action_flattening": false}, "_learner_connector": null, "add_default_connectors_to_learner_pipeline": true, "learner_config_dict": {}, "optimizer": {}, "_learner_class": null, "callbacks_on_algorithm_init": null, "callbacks_on_env_runners_recreated": null, "callbacks_on_offline_eval_runners_recreated": null, "callbacks_on_checkpoint_loaded": null, "callbacks_on_environment_created": null, "callbacks_on_episode_created": null, "callbacks_on_episode_start": null, "callbacks_on_episode_step": null, "callbacks_on_episode_end": null, "callbacks_on_evaluate_start": null, "callbacks_on_evaluate_end": null, "callbacks_on_evaluate_offline_start": null, "callbacks_on_evaluate_offline_end": null, "callbacks_on_sample_end": null, "callbacks_on_train_result": null, "explore": true, "enable_rl_module_and_learner": true, "enable_env_runner_and_connector_v2": true, "_prior_exploration_config": {"type": "StochasticSampling"}, "count_steps_by": "env_steps", "policy_map_capacity": 100, "policy_mapping_fn": "<function AlgorithmConfig.DEFAULT_POLICY_MAPPING_FN at 0x14f2edb20>", "policies_to_train": null, "policy_states_are_swappable": false, "observation_fn": null, "offline_data_class": null, "input_read_method": "read_parquet", "input_read_method_kwargs": {}, "input_read_schema": {}, "input_read_episodes": false, "input_read_sample_batches": false, "input_read_batch_size": null, "input_filesystem": null, "input_filesystem_kwargs": {}, "input_compress_columns": ["obs", "new_obs"], "input_spaces_jsonable": true, "materialize_data": false, "materialize_mapped_data": true, "map_batches_kwargs": {}, "iter_batches_kwargs": {}, "ignore_final_observation": false, "prelearner_class": null, "prelearner_buffer_class": null, "prelearner_buffer_kwargs": {}, "prelearner_module_synch_period": 10, "dataset_num_iters_per_learner": null, "input_config": {}, "actions_in_input_normalized": false, "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_config": {}, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "output_max_rows_per_file": null, "output_write_remaining_data": false, "output_write_method": "write_parquet", "output_write_method_kwargs": {}, "output_filesystem": null, "output_filesystem_kwargs": {}, "output_write_episodes": true, "offline_sampling": false, "evaluation_interval": 1, "evaluation_duration": 20, "evaluation_duration_unit": "episodes", "evaluation_sample_timeout_s": 120.0, "evaluation_auto_duration_min_env_steps_per_sample": 100, "evaluation_auto_duration_max_env_steps_per_sample": 2000, "evaluation_parallel_to_training": false, "evaluation_force_reset_envs_before_iteration": true, "evaluation_config": null, "off_policy_estimation_methods": {}, "ope_split_batch_by_episode": true, "evaluation_num_env_runners": 1, "in_evaluation": false, "sync_filters_on_rollout_workers_timeout_s": 10.0, "offline_evaluation_interval": null, "num_offline_eval_runners": 0, "offline_loss_for_module_fn": null, "offline_evaluation_duration": 1, "offline_evaluation_parallel_to_training": false, "offline_evaluation_timeout_s": 120.0, "num_cpus_per_offline_eval_runner": 1, "num_gpus_per_offline_eval_runner": 0, "custom_resources_per_offline_eval_runner": {}, "restart_failed_offline_eval_runners": true, "ignore_offline_eval_runner_failures": false, "max_num_offline_eval_runner_restarts": 1000, "offline_eval_runner_restore_timeout_s": 1800.0, "max_requests_in_flight_per_offline_eval_runner": 1, "validate_offline_eval_runners_after_construction": true, "offline_eval_runner_health_probe_timeout_s": 30.0, "offline_eval_rl_module_inference_only": false, "broadcast_offline_eval_runner_states": false, "offline_eval_batch_size_per_runner": 256, "dataset_num_iters_per_eval_runner": 1, "keep_per_episode_custom_metrics": false, "metrics_episode_collection_timeout_s": 60.0, "metrics_num_episodes_for_smoothing": 100, "min_time_s_per_iteration": null, "min_train_timesteps_per_iteration": 0, "min_sample_timesteps_per_iteration": 0, "log_gradients": true, "export_native_model_files": false, "checkpoint_trainable_policies_only": false, "logger_creator": null, "logger_config": null, "log_level": "WARN", "log_sys_usage": true, "fake_sampler": false, "seed": 3, "restart_failed_env_runners": true, "ignore_env_runner_failures": false, "max_num_env_runner_restarts": 1000, "delay_between_env_runner_restarts_s": 60.0, "restart_failed_sub_environments": false, "num_consecutive_env_runner_failures_tolerance": 100, "env_runner_health_probe_timeout_s": 30.0, "env_runner_restore_timeout_s": 1800.0, "_model_config": {}, "_rl_module_spec": "RLModuleSpec(module_class=None, observation_space=None, action_space=None, inference_only=False, learner_only=False, model_config=DefaultModelConfig(fcnet_hiddens=[60, 90], fcnet_activation='tanh', fcnet_kernel_initializer=None, fcnet_kernel_initializer_kwargs=None, fcnet_bias_initializer=None, fcnet_bias_initializer_kwargs=None, conv_filters=None, conv_activation='relu', conv_kernel_initializer=None, conv_kernel_initializer_kwargs=None, conv_bias_initializer=None, conv_bias_initializer_kwargs=None, head_fcnet_hiddens=[], head_fcnet_activation='relu', head_fcnet_kernel_initializer=None, head_fcnet_kernel_initializer_kwargs=None, head_fcnet_bias_initializer=None, head_fcnet_bias_initializer_kwargs=None, free_log_std=False, log_std_clip_param=20.0, vf_share_layers=True, use_lstm=False, max_seq_len=20, lstm_cell_size=256, lstm_use_prev_action=False, lstm_use_prev_reward=False, lstm_kernel_initializer=None, lstm_kernel_initializer_kwargs=None, lstm_bias_initializer=None, lstm_bias_initializer_kwargs=None), catalog_class=None, load_state_path=None, model_config_dict=None)", "algorithm_config_overrides_per_module": {}, "_per_module_overrides": {}, "_validate_config": true, "_use_msgpack_checkpoints": false, "_torch_grad_scaler_class": null, "_torch_lr_scheduler_classes": null, "_tf_policy_handles_more_than_one_loss": false, "_disable_preprocessor_api": false, "_disable_action_flattening": false, "_disable_initialize_loss_from_dummy_batch": false, "_dont_auto_sync_env_runner_states": false, "env_task_fn": -1, "enable_connectors": -1, "simple_optimizer": false, "policy_map_cache": -1, "worker_cls": -1, "synchronize_filters": -1, "enable_async_evaluation": -1, "custom_async_evaluation_function": -1, "_enable_rl_module_api": -1, "auto_wrap_old_gym_envs": -1, "always_attach_evaluation_results": -1, "replay_sequence_length": null, "_disable_execution_plan_api": -1, "use_critic": true, "use_gae": true, "use_kl_loss": true, "kl_coeff": 0.7464963036515, "kl_target": 0.0270990929592, "vf_loss_coeff": 0.6688075857018, "entropy_coeff": 0.0090570820258, "clip_param": 0.1221781641624, "vf_clip_param": 0.1027808522125, "entropy_coeff_schedule": null, "lr_schedule": null, "sgd_minibatch_size": -1, "vf_share_layers": -1, "__stdout_file__": null, "__stderr_file__": null, "lambda": 0.9099046732075, "input": "sampler", "policies": {"default_policy": [null, null, null, null]}, "callbacks": "<class 'ray.rllib.callbacks.callbacks.RLlibCallback'>", "create_env_on_driver": false, "custom_eval_function": null, "framework": "torch"}, "time_since_restore": 19.816202402114868, "iterations_since_restore": 6, "perf": {"cpu_util_percent": 80.04, "ram_util_percent": 78.78}}
{"timers": {"training_iteration": 3.433258738865526, "restore_env_runners": 5.181303416136473e-05, "training_step": 3.4328112083193245, "env_runner_sampling_timer": 3.252586245000002, "learner_update_timer": 0.17521053081596225, "synch_weights": 0.0013021330634605188, "restore_eval_env_runners": 1.1223466137022313e-05, "evaluation_iteration": 0.19411378443839242, "synch_eval_env_connectors": 0.00020089162391345012, "synch_env_connectors": 7.095124468014249e-06}, "env_runners": {"episode_return_min": -13.5, "module_to_env_connector": {"connector_pipeline_timer": 0.00019154877261787608, "timers": {"connectors": {"normalize_and_clip_actions": 1.5777728089865154e-05, "un_batch_to_individual_items": 8.59183302869098e-06, "remove_single_ts_time_rank_from_batch": 1.0920316345034284e-06, "tensor_to_numpy": 2.489607312940033e-05, "listify_data_for_vector_env": 1.9294313101295076e-05, "get_actions": 8.076815429946555e-05}}}, "env_step_timer": 2.5690196495258937e-05, "rlmodule_inference_timer": 5.433596776097818e-05, "env_reset_timer": 8.254775730491707e-05, "agent_episode_returns_mean": {"default_agent": 0.17999999999999997}, "num_env_steps_sampled_lifetime": -3077500.0, "weights_seq_no": 6.0, "env_to_module_sum_episodes_length_out": 10.36823839457432, "episode_len_max": 20, "env_to_module_connector": {"timers": {"connectors": {"batch_individual_items": 1.1073044433515526e-05, "numpy_to_tensor": 1.6513594231726904e-05, "add_time_dim_to_batch_and_zero_pad": 4.190324790023843e-06, "add_observations_from_episodes_to_batch": 5.0058639972860044e-06, "add_states_from_episodes_to_batch": 2.681316206139508e-06}}, "connector_pipeline_timer": 7.198246203784741e-05}, "env_to_module_sum_episodes_length_in": 10.36823839457432, "sample": 0.009607067997574414, "num_agent_steps_sampled": {"default_agent": 5000.0}, "num_module_steps_sampled": {"default_policy": 5000.0}, "num_episodes_lifetime": -153875.0, "num_module_steps_sampled_lifetime": {"default_policy": -3077500.0}, "num_agent_steps_sampled_lifetime": {"default_agent": -3077500.0}, "time_between_sampling": 0.0031312641235877814, "episode_len_mean": 20.0, "episode_return_mean": 0.17999999999999997, "num_episodes": 250.0, "episode_duration_sec_mean": 0.008201033497229216, "episode_len_min": 20, "num_env_steps_sampled": 5000.0, "module_episode_returns_mean": {"default_policy": 0.17999999999999997}, "episode_return_max": 6.5, "num_env_steps_sampled_lifetime_throughput": 2402.888790568389}, "learners": {"__all_modules__": {"learner_connector": {"timers": {"connectors": {"add_columns_from_episodes_to_train_batch": 0.038050931094494096, "add_states_from_episodes_to_batch": 4.829736906503637e-06, "add_one_ts_to_episodes_and_truncate": 0.011926893491352909, "numpy_to_tensor": 0.00020630880376835707, "batch_individual_items": 0.047758793341395836, "add_time_dim_to_batch_and_zero_pad": 1.3093981617488365e-05, "general_advantage_estimation": 0.013471298958648074, "add_observations_from_episodes_to_batch": 0.0008830094974175136}}, "connector_pipeline_timer": 0.11270339122047038}, "num_module_steps_trained": 6000, "num_non_trainable_parameters": 0, "num_module_steps_trained_lifetime": 42000, "learner_connector_sum_episodes_length_in": 5000.0, "learner_connector_sum_episodes_length_out": 5250.0, "num_env_steps_trained": 31500, "num_trainable_parameters": 6003, "num_env_steps_trained_lifetime": 220500, "num_env_steps_trained_lifetime_throughput": 914188.1668936677, "num_module_steps_trained_throughput": 177061.40804849975, "num_module_steps_trained_lifetime_throughput": 176850.64923126827}, "default_policy": {"num_module_steps_trained": 6000, "curr_entropy_coeff": 0.0090570820258, "num_module_steps_trained_lifetime": 42000, "gradients_default_optimizer_global_norm": 0.1225818544626236, "entropy": 0.6225767731666565, "total_loss": 0.1733374446630478, "weights_seq_no": 7.0, "default_optimizer_learning_rate": 0.0002847858517, "curr_kl_coeff": 0.0058320024982094765, "policy_loss": 0.11239685118198395, "vf_loss_unclipped": 27.996871948242188, "vf_explained_var": -0.012020707130432129, "mean_kl_loss": 0.00022236791846808046, "num_trainable_parameters": 6003, "module_train_batch_size_mean": 1000.0, "diff_num_grad_updates_vs_sampler_policy": 1.0, "vf_loss": 0.09954539686441422, "num_module_steps_trained_lifetime_throughput": 177507.26007463736}}, "num_training_step_calls_per_iteration": 1, "evaluation": {"env_runners": {"num_module_steps_sampled_lifetime": {"default_policy": 2800}, "env_step_timer": 2.0606131217932654e-05, "episode_duration_sec_mean": 0.008692579159978777, "num_module_steps_sampled": {"default_policy": 400}, "num_agent_steps_sampled_lifetime": {"default_agent": 2800}, "rlmodule_inference_timer": 3.677175349886431e-05, "weights_seq_no": 7.0, "env_to_module_sum_episodes_length_out": 10.368238394572801, "sample": 0.18291057764361002, "episode_len_mean": 20.0, "agent_episode_returns_mean": {"default_agent": 2.8}, "env_to_module_connector": {"connector_pipeline_timer": 5.433509243192637e-05, "timers": {"connectors": {"add_observations_from_episodes_to_batch": 3.663122535361258e-06, "add_states_from_episodes_to_batch": 1.8698203804145685e-06, "numpy_to_tensor": 1.1432418117940392e-05, "batch_individual_items": 8.288886864204022e-06, "add_time_dim_to_batch_and_zero_pad": 3.0149879256843637e-06}}}, "episode_return_max": 13.5, "module_to_env_connector": {"timers": {"connectors": {"tensor_to_numpy": 1.9655730333565096e-05, "listify_data_for_vector_env": 1.5149675719796381e-05, "normalize_and_clip_actions": 1.2676220762406082e-05, "un_batch_to_individual_items": 7.340008234906208e-06, "remove_single_ts_time_rank_from_batch": 7.870314736883996e-07, "get_actions": 5.436299204301749e-05}}, "connector_pipeline_timer": 0.0001455899078474412}, "env_to_module_sum_episodes_length_in": 10.368238394572801, "num_episodes_lifetime": 140, "module_episode_returns_mean": {"default_policy": 2.8}, "num_episodes": 20, "episode_len_min": 20, "num_agent_steps_sampled": {"default_agent": 400}, "episode_return_min": -13.5, "env_reset_timer": 0.0004981551839300412, "num_env_steps_sampled_lifetime": 35400, "episode_len_max": 20, "episode_return_mean": 2.8, "num_env_steps_sampled": 400, "time_between_sampling": 2.7647217851180246}, "num_healthy_workers": 1, "actor_manager_num_outstanding_async_reqs": 0, "num_remote_worker_restarts": 0}, "num_env_steps_sampled_lifetime": -3077500.0, "fault_tolerance": {"num_healthy_workers": 0, "num_remote_worker_restarts": 0}, "env_runner_group": {"actor_manager_num_outstanding_async_reqs": 0}, "done": false, "training_iteration": 7, "trial_id": "469e6_00000", "date": "2025-08-11_19-33-22", "timestamp": 1754933602, "time_this_iter_s": 2.762269973754883, "time_total_s": 22.57847237586975, "pid": 25834, "hostname": "Mac", "node_ip": "127.0.0.1", "config": {"exploration_config": {}, "extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "placement_strategy": "PACK", "num_gpus": 0, "_fake_gpus": false, "num_cpus_for_main_process": 2, "eager_tracing": true, "eager_max_retraces": 20, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "torch_compile_learner": false, "torch_compile_learner_what_to_compile": "forward_train", "torch_compile_learner_dynamo_backend": "aot_eager", "torch_compile_learner_dynamo_mode": null, "torch_compile_worker": false, "torch_compile_worker_dynamo_backend": "aot_eager", "torch_compile_worker_dynamo_mode": null, "torch_ddp_kwargs": {}, "torch_skip_nan_gradients": false, "env": "Umbrella", "env_config": {}, "observation_space": null, "action_space": null, "clip_rewards": null, "normalize_actions": true, "clip_actions": false, "_is_atari": null, "disable_env_checking": false, "render_env": false, "action_mask_key": "action_mask", "env_runner_cls": null, "num_env_runners": 0, "create_local_env_runner": true, "num_envs_per_env_runner": 1, "gym_env_vectorize_mode": "SYNC", "num_cpus_per_env_runner": 1, "num_gpus_per_env_runner": 0, "custom_resources_per_env_runner": {}, "validate_env_runners_after_construction": true, "episodes_to_numpy": true, "max_requests_in_flight_per_env_runner": 1, "sample_timeout_s": 60.0, "_env_to_module_connector": null, "add_default_connectors_to_env_to_module_pipeline": true, "_module_to_env_connector": null, "add_default_connectors_to_module_to_env_pipeline": true, "merge_env_runner_states": "training_only", "broadcast_env_runner_states": true, "episode_lookback_horizon": 1, "rollout_fragment_length": "auto", "batch_mode": "complete_episodes", "compress_observations": false, "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "enable_tf1_exec_eagerly": false, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "preprocessor_pref": "deepmind", "observation_filter": "NoFilter", "update_worker_filter_stats": true, "use_worker_filter_stats": true, "sampler_perf_stats_ema_coef": null, "_is_online": true, "num_learners": 0, "num_gpus_per_learner": 0, "num_cpus_per_learner": "auto", "num_aggregator_actors_per_learner": 0, "max_requests_in_flight_per_aggregator_actor": 3, "local_gpu_idx": 0, "max_requests_in_flight_per_learner": 3, "gamma": 1, "lr": 0.0002847858517, "grad_clip": 0.5, "grad_clip_by": "global_norm", "_train_batch_size_per_learner": 5000, "train_batch_size": 4000, "num_epochs": 1, "minibatch_size": 1000, "shuffle_batch_per_epoch": true, "model": {"fcnet_hiddens": [256, 256], "fcnet_activation": "tanh", "fcnet_weights_initializer": null, "fcnet_weights_initializer_config": null, "fcnet_bias_initializer": null, "fcnet_bias_initializer_config": null, "conv_filters": null, "conv_activation": "relu", "conv_kernel_initializer": null, "conv_kernel_initializer_config": null, "conv_bias_initializer": null, "conv_bias_initializer_config": null, "conv_transpose_kernel_initializer": null, "conv_transpose_kernel_initializer_config": null, "conv_transpose_bias_initializer": null, "conv_transpose_bias_initializer_config": null, "post_fcnet_hiddens": [], "post_fcnet_activation": "relu", "post_fcnet_weights_initializer": null, "post_fcnet_weights_initializer_config": null, "post_fcnet_bias_initializer": null, "post_fcnet_bias_initializer_config": null, "free_log_std": false, "log_std_clip_param": 20.0, "no_final_linear": false, "vf_share_layers": false, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "lstm_weights_initializer": null, "lstm_weights_initializer_config": null, "lstm_bias_initializer": null, "lstm_bias_initializer_config": null, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "attention_use_n_prev_actions": 0, "attention_use_n_prev_rewards": 0, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": null, "custom_model_config": {}, "custom_action_dist": null, "custom_preprocessor": null, "encoder_latent_dim": null, "always_check_shapes": false, "lstm_use_prev_action_reward": -1, "_use_default_native_models": -1, "_disable_preprocessor_api": false, "_disable_action_flattening": false}, "_learner_connector": null, "add_default_connectors_to_learner_pipeline": true, "learner_config_dict": {}, "optimizer": {}, "_learner_class": null, "callbacks_on_algorithm_init": null, "callbacks_on_env_runners_recreated": null, "callbacks_on_offline_eval_runners_recreated": null, "callbacks_on_checkpoint_loaded": null, "callbacks_on_environment_created": null, "callbacks_on_episode_created": null, "callbacks_on_episode_start": null, "callbacks_on_episode_step": null, "callbacks_on_episode_end": null, "callbacks_on_evaluate_start": null, "callbacks_on_evaluate_end": null, "callbacks_on_evaluate_offline_start": null, "callbacks_on_evaluate_offline_end": null, "callbacks_on_sample_end": null, "callbacks_on_train_result": null, "explore": true, "enable_rl_module_and_learner": true, "enable_env_runner_and_connector_v2": true, "_prior_exploration_config": {"type": "StochasticSampling"}, "count_steps_by": "env_steps", "policy_map_capacity": 100, "policy_mapping_fn": "<function AlgorithmConfig.DEFAULT_POLICY_MAPPING_FN at 0x14f2edb20>", "policies_to_train": null, "policy_states_are_swappable": false, "observation_fn": null, "offline_data_class": null, "input_read_method": "read_parquet", "input_read_method_kwargs": {}, "input_read_schema": {}, "input_read_episodes": false, "input_read_sample_batches": false, "input_read_batch_size": null, "input_filesystem": null, "input_filesystem_kwargs": {}, "input_compress_columns": ["obs", "new_obs"], "input_spaces_jsonable": true, "materialize_data": false, "materialize_mapped_data": true, "map_batches_kwargs": {}, "iter_batches_kwargs": {}, "ignore_final_observation": false, "prelearner_class": null, "prelearner_buffer_class": null, "prelearner_buffer_kwargs": {}, "prelearner_module_synch_period": 10, "dataset_num_iters_per_learner": null, "input_config": {}, "actions_in_input_normalized": false, "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_config": {}, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "output_max_rows_per_file": null, "output_write_remaining_data": false, "output_write_method": "write_parquet", "output_write_method_kwargs": {}, "output_filesystem": null, "output_filesystem_kwargs": {}, "output_write_episodes": true, "offline_sampling": false, "evaluation_interval": 1, "evaluation_duration": 20, "evaluation_duration_unit": "episodes", "evaluation_sample_timeout_s": 120.0, "evaluation_auto_duration_min_env_steps_per_sample": 100, "evaluation_auto_duration_max_env_steps_per_sample": 2000, "evaluation_parallel_to_training": false, "evaluation_force_reset_envs_before_iteration": true, "evaluation_config": null, "off_policy_estimation_methods": {}, "ope_split_batch_by_episode": true, "evaluation_num_env_runners": 1, "in_evaluation": false, "sync_filters_on_rollout_workers_timeout_s": 10.0, "offline_evaluation_interval": null, "num_offline_eval_runners": 0, "offline_loss_for_module_fn": null, "offline_evaluation_duration": 1, "offline_evaluation_parallel_to_training": false, "offline_evaluation_timeout_s": 120.0, "num_cpus_per_offline_eval_runner": 1, "num_gpus_per_offline_eval_runner": 0, "custom_resources_per_offline_eval_runner": {}, "restart_failed_offline_eval_runners": true, "ignore_offline_eval_runner_failures": false, "max_num_offline_eval_runner_restarts": 1000, "offline_eval_runner_restore_timeout_s": 1800.0, "max_requests_in_flight_per_offline_eval_runner": 1, "validate_offline_eval_runners_after_construction": true, "offline_eval_runner_health_probe_timeout_s": 30.0, "offline_eval_rl_module_inference_only": false, "broadcast_offline_eval_runner_states": false, "offline_eval_batch_size_per_runner": 256, "dataset_num_iters_per_eval_runner": 1, "keep_per_episode_custom_metrics": false, "metrics_episode_collection_timeout_s": 60.0, "metrics_num_episodes_for_smoothing": 100, "min_time_s_per_iteration": null, "min_train_timesteps_per_iteration": 0, "min_sample_timesteps_per_iteration": 0, "log_gradients": true, "export_native_model_files": false, "checkpoint_trainable_policies_only": false, "logger_creator": null, "logger_config": null, "log_level": "WARN", "log_sys_usage": true, "fake_sampler": false, "seed": 3, "restart_failed_env_runners": true, "ignore_env_runner_failures": false, "max_num_env_runner_restarts": 1000, "delay_between_env_runner_restarts_s": 60.0, "restart_failed_sub_environments": false, "num_consecutive_env_runner_failures_tolerance": 100, "env_runner_health_probe_timeout_s": 30.0, "env_runner_restore_timeout_s": 1800.0, "_model_config": {}, "_rl_module_spec": "RLModuleSpec(module_class=None, observation_space=None, action_space=None, inference_only=False, learner_only=False, model_config=DefaultModelConfig(fcnet_hiddens=[60, 90], fcnet_activation='tanh', fcnet_kernel_initializer=None, fcnet_kernel_initializer_kwargs=None, fcnet_bias_initializer=None, fcnet_bias_initializer_kwargs=None, conv_filters=None, conv_activation='relu', conv_kernel_initializer=None, conv_kernel_initializer_kwargs=None, conv_bias_initializer=None, conv_bias_initializer_kwargs=None, head_fcnet_hiddens=[], head_fcnet_activation='relu', head_fcnet_kernel_initializer=None, head_fcnet_kernel_initializer_kwargs=None, head_fcnet_bias_initializer=None, head_fcnet_bias_initializer_kwargs=None, free_log_std=False, log_std_clip_param=20.0, vf_share_layers=True, use_lstm=False, max_seq_len=20, lstm_cell_size=256, lstm_use_prev_action=False, lstm_use_prev_reward=False, lstm_kernel_initializer=None, lstm_kernel_initializer_kwargs=None, lstm_bias_initializer=None, lstm_bias_initializer_kwargs=None), catalog_class=None, load_state_path=None, model_config_dict=None)", "algorithm_config_overrides_per_module": {}, "_per_module_overrides": {}, "_validate_config": true, "_use_msgpack_checkpoints": false, "_torch_grad_scaler_class": null, "_torch_lr_scheduler_classes": null, "_tf_policy_handles_more_than_one_loss": false, "_disable_preprocessor_api": false, "_disable_action_flattening": false, "_disable_initialize_loss_from_dummy_batch": false, "_dont_auto_sync_env_runner_states": false, "env_task_fn": -1, "enable_connectors": -1, "simple_optimizer": false, "policy_map_cache": -1, "worker_cls": -1, "synchronize_filters": -1, "enable_async_evaluation": -1, "custom_async_evaluation_function": -1, "_enable_rl_module_api": -1, "auto_wrap_old_gym_envs": -1, "always_attach_evaluation_results": -1, "replay_sequence_length": null, "_disable_execution_plan_api": -1, "use_critic": true, "use_gae": true, "use_kl_loss": true, "kl_coeff": 0.7464963036515, "kl_target": 0.0270990929592, "vf_loss_coeff": 0.6688075857018, "entropy_coeff": 0.0090570820258, "clip_param": 0.1221781641624, "vf_clip_param": 0.1027808522125, "entropy_coeff_schedule": null, "lr_schedule": null, "sgd_minibatch_size": -1, "vf_share_layers": -1, "__stdout_file__": null, "__stderr_file__": null, "lambda": 0.9099046732075, "input": "sampler", "policies": {"default_policy": [null, null, null, null]}, "callbacks": "<class 'ray.rllib.callbacks.callbacks.RLlibCallback'>", "create_env_on_driver": false, "custom_eval_function": null, "framework": "torch"}, "time_since_restore": 22.57847237586975, "iterations_since_restore": 7, "perf": {"cpu_util_percent": 76.7, "ram_util_percent": 79.39999999999999}}
{"timers": {"training_iteration": 3.424619450646523, "restore_env_runners": 5.135656319495672e-05, "training_step": 3.424174128735439, "env_runner_sampling_timer": 3.2445992296299684, "learner_update_timer": 0.1745554871779551, "synch_weights": 0.0012988721528968746, "restore_eval_env_runners": 1.1187481183142295e-05, "evaluation_iteration": 0.1937604095139616, "synch_eval_env_connectors": 0.00020007020798537735, "synch_env_connectors": 7.065003569158468e-06}, "env_runners": {"episode_return_min": -13.5, "module_to_env_connector": {"connector_pipeline_timer": 0.00017977510755706516, "timers": {"connectors": {"normalize_and_clip_actions": 1.4703126033197958e-05, "un_batch_to_individual_items": 8.305309031167165e-06, "remove_single_ts_time_rank_from_batch": 8.96819821895401e-07, "tensor_to_numpy": 2.2113835349088187e-05, "listify_data_for_vector_env": 1.8648049721428667e-05, "get_actions": 7.634548064027656e-05}}}, "env_step_timer": 2.533425805417147e-05, "rlmodule_inference_timer": 7.303288817810385e-05, "env_reset_timer": 7.20648620631637e-05, "agent_episode_returns_mean": {"default_agent": 1.0600000000000005}, "num_env_steps_sampled_lifetime": -3695000.0, "weights_seq_no": 7.0, "env_to_module_sum_episodes_length_out": 10.36823839457432, "episode_len_max": 20, "env_to_module_connector": {"timers": {"connectors": {"batch_individual_items": 1.0813711086714559e-05, "numpy_to_tensor": 1.562558345288876e-05, "add_time_dim_to_batch_and_zero_pad": 3.7823426910026857e-06, "add_observations_from_episodes_to_batch": 4.916881282394657e-06, "add_states_from_episodes_to_batch": 2.3743877844938963e-06}}, "connector_pipeline_timer": 6.890231875246102e-05}, "env_to_module_sum_episodes_length_in": 10.36823839457432, "sample": 0.008827603711949426, "num_agent_steps_sampled": {"default_agent": 5000.0}, "num_module_steps_sampled": {"default_policy": 5000.0}, "num_episodes_lifetime": -184750.0, "num_module_steps_sampled_lifetime": {"default_policy": -3695000.0}, "num_agent_steps_sampled_lifetime": {"default_agent": -3695000.0}, "time_between_sampling": 0.002368355060741035, "episode_len_mean": 20.0, "episode_return_mean": 1.0600000000000005, "num_episodes": 250.0, "episode_duration_sec_mean": 0.008254750347230581, "episode_len_min": 20, "num_env_steps_sampled": 5000.0, "module_episode_returns_mean": {"default_policy": 1.0600000000000005}, "episode_return_max": 6.5, "num_env_steps_sampled_lifetime_throughput": 2430.546913243603}, "learners": {"__all_modules__": {"learner_connector": {"timers": {"connectors": {"add_columns_from_episodes_to_train_batch": 0.0380569676139554, "add_states_from_episodes_to_batch": 4.820189541461914e-06, "add_one_ts_to_episodes_and_truncate": 0.011923306645675013, "numpy_to_tensor": 0.00020494363606240494, "batch_individual_items": 0.04759968790755153, "add_time_dim_to_batch_and_zero_pad": 1.309637226940187e-05, "general_advantage_estimation": 0.013391771808362568, "add_observations_from_episodes_to_batch": 0.0008862835632942061}}, "connector_pipeline_timer": 0.1124664702279986}, "num_module_steps_trained": 6000, "num_non_trainable_parameters": 0, "num_module_steps_trained_lifetime": 48000, "learner_connector_sum_episodes_length_in": 5000.0, "learner_connector_sum_episodes_length_out": 5250.0, "num_env_steps_trained": 31500, "num_trainable_parameters": 6003, "num_env_steps_trained_lifetime": 252000, "num_env_steps_trained_lifetime_throughput": 929800.100638326, "num_module_steps_trained_throughput": 179921.58908314735, "num_module_steps_trained_lifetime_throughput": 179716.11122529214}, "default_policy": {"num_module_steps_trained": 6000, "curr_entropy_coeff": 0.0090570820258, "num_module_steps_trained_lifetime": 48000, "gradients_default_optimizer_global_norm": 0.04937148466706276, "entropy": 0.6227813363075256, "total_loss": 0.09643588215112686, "weights_seq_no": 8.0, "default_optimizer_learning_rate": 0.0002847858517, "curr_kl_coeff": 0.0029160012491047382, "policy_loss": 0.03571588546037674, "vf_loss_unclipped": 26.816692352294922, "vf_explained_var": -0.011062145233154297, "mean_kl_loss": 4.653878204408102e-05, "num_trainable_parameters": 6003, "module_train_batch_size_mean": 1000.0, "diff_num_grad_updates_vs_sampler_policy": 1.0, "vf_loss": 0.09922180324792862, "num_module_steps_trained_lifetime_throughput": 180335.04770081613}}, "num_training_step_calls_per_iteration": 1, "evaluation": {"env_runners": {"num_module_steps_sampled_lifetime": {"default_policy": 3200}, "env_step_timer": 2.225583794417299e-05, "episode_duration_sec_mean": 0.008462015419499948, "num_module_steps_sampled": {"default_policy": 400}, "num_agent_steps_sampled_lifetime": {"default_agent": 3200}, "rlmodule_inference_timer": 4.081127103621091e-05, "weights_seq_no": 8.0, "env_to_module_sum_episodes_length_out": 10.3682383945743, "sample": 0.1829897851965055, "episode_len_mean": 20.0, "agent_episode_returns_mean": {"default_agent": 3.0}, "env_to_module_connector": {"connector_pipeline_timer": 6.195665456311926e-05, "timers": {"connectors": {"add_observations_from_episodes_to_batch": 4.282906069012464e-06, "add_states_from_episodes_to_batch": 1.9822497993702895e-06, "numpy_to_tensor": 1.3784547251023323e-05, "batch_individual_items": 9.448756547422452e-06, "add_time_dim_to_batch_and_zero_pad": 3.3772915367764307e-06}}}, "episode_return_max": 13.5, "module_to_env_connector": {"timers": {"connectors": {"tensor_to_numpy": 2.0253192458527082e-05, "listify_data_for_vector_env": 1.6309548753483472e-05, "normalize_and_clip_actions": 1.3890372587636234e-05, "un_batch_to_individual_items": 7.724218235596297e-06, "remove_single_ts_time_rank_from_batch": 7.792860100494713e-07, "get_actions": 5.770786345436462e-05}}, "connector_pipeline_timer": 0.00015163832181460123}, "env_to_module_sum_episodes_length_in": 10.3682383945743, "num_episodes_lifetime": 160, "module_episode_returns_mean": {"default_policy": 3.0}, "num_episodes": 20, "episode_len_min": 20, "num_agent_steps_sampled": {"default_agent": 400}, "episode_return_min": -13.5, "env_reset_timer": 0.0004947711320312852, "num_env_steps_sampled_lifetime": 40400, "episode_len_max": 20, "episode_return_mean": 3.0, "num_env_steps_sampled": 400, "time_between_sampling": 2.762993693515763}, "num_healthy_workers": 1, "actor_manager_num_outstanding_async_reqs": 0, "num_remote_worker_restarts": 0}, "num_env_steps_sampled_lifetime": -3695000.0, "fault_tolerance": {"num_healthy_workers": 0, "num_remote_worker_restarts": 0}, "env_runner_group": {"actor_manager_num_outstanding_async_reqs": 0}, "done": false, "training_iteration": 8, "trial_id": "469e6_00000", "date": "2025-08-11_19-33-25", "timestamp": 1754933605, "time_this_iter_s": 2.7706351280212402, "time_total_s": 25.34910750389099, "pid": 25834, "hostname": "Mac", "node_ip": "127.0.0.1", "config": {"exploration_config": {}, "extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "placement_strategy": "PACK", "num_gpus": 0, "_fake_gpus": false, "num_cpus_for_main_process": 2, "eager_tracing": true, "eager_max_retraces": 20, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "torch_compile_learner": false, "torch_compile_learner_what_to_compile": "forward_train", "torch_compile_learner_dynamo_backend": "aot_eager", "torch_compile_learner_dynamo_mode": null, "torch_compile_worker": false, "torch_compile_worker_dynamo_backend": "aot_eager", "torch_compile_worker_dynamo_mode": null, "torch_ddp_kwargs": {}, "torch_skip_nan_gradients": false, "env": "Umbrella", "env_config": {}, "observation_space": null, "action_space": null, "clip_rewards": null, "normalize_actions": true, "clip_actions": false, "_is_atari": null, "disable_env_checking": false, "render_env": false, "action_mask_key": "action_mask", "env_runner_cls": null, "num_env_runners": 0, "create_local_env_runner": true, "num_envs_per_env_runner": 1, "gym_env_vectorize_mode": "SYNC", "num_cpus_per_env_runner": 1, "num_gpus_per_env_runner": 0, "custom_resources_per_env_runner": {}, "validate_env_runners_after_construction": true, "episodes_to_numpy": true, "max_requests_in_flight_per_env_runner": 1, "sample_timeout_s": 60.0, "_env_to_module_connector": null, "add_default_connectors_to_env_to_module_pipeline": true, "_module_to_env_connector": null, "add_default_connectors_to_module_to_env_pipeline": true, "merge_env_runner_states": "training_only", "broadcast_env_runner_states": true, "episode_lookback_horizon": 1, "rollout_fragment_length": "auto", "batch_mode": "complete_episodes", "compress_observations": false, "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "enable_tf1_exec_eagerly": false, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "preprocessor_pref": "deepmind", "observation_filter": "NoFilter", "update_worker_filter_stats": true, "use_worker_filter_stats": true, "sampler_perf_stats_ema_coef": null, "_is_online": true, "num_learners": 0, "num_gpus_per_learner": 0, "num_cpus_per_learner": "auto", "num_aggregator_actors_per_learner": 0, "max_requests_in_flight_per_aggregator_actor": 3, "local_gpu_idx": 0, "max_requests_in_flight_per_learner": 3, "gamma": 1, "lr": 0.0002847858517, "grad_clip": 0.5, "grad_clip_by": "global_norm", "_train_batch_size_per_learner": 5000, "train_batch_size": 4000, "num_epochs": 1, "minibatch_size": 1000, "shuffle_batch_per_epoch": true, "model": {"fcnet_hiddens": [256, 256], "fcnet_activation": "tanh", "fcnet_weights_initializer": null, "fcnet_weights_initializer_config": null, "fcnet_bias_initializer": null, "fcnet_bias_initializer_config": null, "conv_filters": null, "conv_activation": "relu", "conv_kernel_initializer": null, "conv_kernel_initializer_config": null, "conv_bias_initializer": null, "conv_bias_initializer_config": null, "conv_transpose_kernel_initializer": null, "conv_transpose_kernel_initializer_config": null, "conv_transpose_bias_initializer": null, "conv_transpose_bias_initializer_config": null, "post_fcnet_hiddens": [], "post_fcnet_activation": "relu", "post_fcnet_weights_initializer": null, "post_fcnet_weights_initializer_config": null, "post_fcnet_bias_initializer": null, "post_fcnet_bias_initializer_config": null, "free_log_std": false, "log_std_clip_param": 20.0, "no_final_linear": false, "vf_share_layers": false, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "lstm_weights_initializer": null, "lstm_weights_initializer_config": null, "lstm_bias_initializer": null, "lstm_bias_initializer_config": null, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "attention_use_n_prev_actions": 0, "attention_use_n_prev_rewards": 0, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": null, "custom_model_config": {}, "custom_action_dist": null, "custom_preprocessor": null, "encoder_latent_dim": null, "always_check_shapes": false, "lstm_use_prev_action_reward": -1, "_use_default_native_models": -1, "_disable_preprocessor_api": false, "_disable_action_flattening": false}, "_learner_connector": null, "add_default_connectors_to_learner_pipeline": true, "learner_config_dict": {}, "optimizer": {}, "_learner_class": null, "callbacks_on_algorithm_init": null, "callbacks_on_env_runners_recreated": null, "callbacks_on_offline_eval_runners_recreated": null, "callbacks_on_checkpoint_loaded": null, "callbacks_on_environment_created": null, "callbacks_on_episode_created": null, "callbacks_on_episode_start": null, "callbacks_on_episode_step": null, "callbacks_on_episode_end": null, "callbacks_on_evaluate_start": null, "callbacks_on_evaluate_end": null, "callbacks_on_evaluate_offline_start": null, "callbacks_on_evaluate_offline_end": null, "callbacks_on_sample_end": null, "callbacks_on_train_result": null, "explore": true, "enable_rl_module_and_learner": true, "enable_env_runner_and_connector_v2": true, "_prior_exploration_config": {"type": "StochasticSampling"}, "count_steps_by": "env_steps", "policy_map_capacity": 100, "policy_mapping_fn": "<function AlgorithmConfig.DEFAULT_POLICY_MAPPING_FN at 0x14f2edb20>", "policies_to_train": null, "policy_states_are_swappable": false, "observation_fn": null, "offline_data_class": null, "input_read_method": "read_parquet", "input_read_method_kwargs": {}, "input_read_schema": {}, "input_read_episodes": false, "input_read_sample_batches": false, "input_read_batch_size": null, "input_filesystem": null, "input_filesystem_kwargs": {}, "input_compress_columns": ["obs", "new_obs"], "input_spaces_jsonable": true, "materialize_data": false, "materialize_mapped_data": true, "map_batches_kwargs": {}, "iter_batches_kwargs": {}, "ignore_final_observation": false, "prelearner_class": null, "prelearner_buffer_class": null, "prelearner_buffer_kwargs": {}, "prelearner_module_synch_period": 10, "dataset_num_iters_per_learner": null, "input_config": {}, "actions_in_input_normalized": false, "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_config": {}, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "output_max_rows_per_file": null, "output_write_remaining_data": false, "output_write_method": "write_parquet", "output_write_method_kwargs": {}, "output_filesystem": null, "output_filesystem_kwargs": {}, "output_write_episodes": true, "offline_sampling": false, "evaluation_interval": 1, "evaluation_duration": 20, "evaluation_duration_unit": "episodes", "evaluation_sample_timeout_s": 120.0, "evaluation_auto_duration_min_env_steps_per_sample": 100, "evaluation_auto_duration_max_env_steps_per_sample": 2000, "evaluation_parallel_to_training": false, "evaluation_force_reset_envs_before_iteration": true, "evaluation_config": null, "off_policy_estimation_methods": {}, "ope_split_batch_by_episode": true, "evaluation_num_env_runners": 1, "in_evaluation": false, "sync_filters_on_rollout_workers_timeout_s": 10.0, "offline_evaluation_interval": null, "num_offline_eval_runners": 0, "offline_loss_for_module_fn": null, "offline_evaluation_duration": 1, "offline_evaluation_parallel_to_training": false, "offline_evaluation_timeout_s": 120.0, "num_cpus_per_offline_eval_runner": 1, "num_gpus_per_offline_eval_runner": 0, "custom_resources_per_offline_eval_runner": {}, "restart_failed_offline_eval_runners": true, "ignore_offline_eval_runner_failures": false, "max_num_offline_eval_runner_restarts": 1000, "offline_eval_runner_restore_timeout_s": 1800.0, "max_requests_in_flight_per_offline_eval_runner": 1, "validate_offline_eval_runners_after_construction": true, "offline_eval_runner_health_probe_timeout_s": 30.0, "offline_eval_rl_module_inference_only": false, "broadcast_offline_eval_runner_states": false, "offline_eval_batch_size_per_runner": 256, "dataset_num_iters_per_eval_runner": 1, "keep_per_episode_custom_metrics": false, "metrics_episode_collection_timeout_s": 60.0, "metrics_num_episodes_for_smoothing": 100, "min_time_s_per_iteration": null, "min_train_timesteps_per_iteration": 0, "min_sample_timesteps_per_iteration": 0, "log_gradients": true, "export_native_model_files": false, "checkpoint_trainable_policies_only": false, "logger_creator": null, "logger_config": null, "log_level": "WARN", "log_sys_usage": true, "fake_sampler": false, "seed": 3, "restart_failed_env_runners": true, "ignore_env_runner_failures": false, "max_num_env_runner_restarts": 1000, "delay_between_env_runner_restarts_s": 60.0, "restart_failed_sub_environments": false, "num_consecutive_env_runner_failures_tolerance": 100, "env_runner_health_probe_timeout_s": 30.0, "env_runner_restore_timeout_s": 1800.0, "_model_config": {}, "_rl_module_spec": "RLModuleSpec(module_class=None, observation_space=None, action_space=None, inference_only=False, learner_only=False, model_config=DefaultModelConfig(fcnet_hiddens=[60, 90], fcnet_activation='tanh', fcnet_kernel_initializer=None, fcnet_kernel_initializer_kwargs=None, fcnet_bias_initializer=None, fcnet_bias_initializer_kwargs=None, conv_filters=None, conv_activation='relu', conv_kernel_initializer=None, conv_kernel_initializer_kwargs=None, conv_bias_initializer=None, conv_bias_initializer_kwargs=None, head_fcnet_hiddens=[], head_fcnet_activation='relu', head_fcnet_kernel_initializer=None, head_fcnet_kernel_initializer_kwargs=None, head_fcnet_bias_initializer=None, head_fcnet_bias_initializer_kwargs=None, free_log_std=False, log_std_clip_param=20.0, vf_share_layers=True, use_lstm=False, max_seq_len=20, lstm_cell_size=256, lstm_use_prev_action=False, lstm_use_prev_reward=False, lstm_kernel_initializer=None, lstm_kernel_initializer_kwargs=None, lstm_bias_initializer=None, lstm_bias_initializer_kwargs=None), catalog_class=None, load_state_path=None, model_config_dict=None)", "algorithm_config_overrides_per_module": {}, "_per_module_overrides": {}, "_validate_config": true, "_use_msgpack_checkpoints": false, "_torch_grad_scaler_class": null, "_torch_lr_scheduler_classes": null, "_tf_policy_handles_more_than_one_loss": false, "_disable_preprocessor_api": false, "_disable_action_flattening": false, "_disable_initialize_loss_from_dummy_batch": false, "_dont_auto_sync_env_runner_states": false, "env_task_fn": -1, "enable_connectors": -1, "simple_optimizer": false, "policy_map_cache": -1, "worker_cls": -1, "synchronize_filters": -1, "enable_async_evaluation": -1, "custom_async_evaluation_function": -1, "_enable_rl_module_api": -1, "auto_wrap_old_gym_envs": -1, "always_attach_evaluation_results": -1, "replay_sequence_length": null, "_disable_execution_plan_api": -1, "use_critic": true, "use_gae": true, "use_kl_loss": true, "kl_coeff": 0.7464963036515, "kl_target": 0.0270990929592, "vf_loss_coeff": 0.6688075857018, "entropy_coeff": 0.0090570820258, "clip_param": 0.1221781641624, "vf_clip_param": 0.1027808522125, "entropy_coeff_schedule": null, "lr_schedule": null, "sgd_minibatch_size": -1, "vf_share_layers": -1, "__stdout_file__": null, "__stderr_file__": null, "lambda": 0.9099046732075, "input": "sampler", "policies": {"default_policy": [null, null, null, null]}, "callbacks": "<class 'ray.rllib.callbacks.callbacks.RLlibCallback'>", "create_env_on_driver": false, "custom_eval_function": null, "framework": "torch"}, "time_since_restore": 25.34910750389099, "iterations_since_restore": 8, "perf": {"cpu_util_percent": 57.925, "ram_util_percent": 79.775}}
{"timers": {"training_iteration": 3.418601941550053, "restore_env_runners": 5.138007732194928e-05, "training_step": 3.4181561436983117, "env_runner_sampling_timer": 3.237775996913815, "learner_update_timer": 0.17537556647648986, "synch_weights": 0.0012926234314668496, "restore_eval_env_runners": 1.1148936382529657e-05, "evaluation_iteration": 0.1938001449990114, "synch_eval_env_connectors": 0.0001998370059763786, "synch_env_connectors": 7.0385238348744585e-06}, "env_runners": {"episode_return_min": -13.5, "module_to_env_connector": {"connector_pipeline_timer": 0.0002008695376048128, "timers": {"connectors": {"normalize_and_clip_actions": 1.5873134845632238e-05, "un_batch_to_individual_items": 8.880901499448552e-06, "remove_single_ts_time_rank_from_batch": 1.0421750505026894e-06, "tensor_to_numpy": 2.5826027351232342e-05, "listify_data_for_vector_env": 1.988977897638802e-05, "get_actions": 8.417975998155212e-05}}}, "env_step_timer": 2.839238205826403e-05, "rlmodule_inference_timer": 5.461200866729093e-05, "env_reset_timer": 9.202758614538576e-05, "agent_episode_returns_mean": {"default_agent": 1.5399999999999994}, "num_env_steps_sampled_lifetime": -4312500.0, "weights_seq_no": 8.0, "env_to_module_sum_episodes_length_out": 10.36823839457432, "episode_len_max": 20, "env_to_module_connector": {"timers": {"connectors": {"batch_individual_items": 1.124651303736103e-05, "numpy_to_tensor": 1.7155768911590456e-05, "add_time_dim_to_batch_and_zero_pad": 4.047237649483246e-06, "add_observations_from_episodes_to_batch": 5.5310541575327235e-06, "add_states_from_episodes_to_batch": 2.570509135579634e-06}}, "connector_pipeline_timer": 7.361506730724011e-05}, "env_to_module_sum_episodes_length_in": 10.36823839457432, "sample": 0.009041154112957549, "num_agent_steps_sampled": {"default_agent": 5000.0}, "num_module_steps_sampled": {"default_policy": 5000.0}, "num_episodes_lifetime": -215625.0, "num_module_steps_sampled_lifetime": {"default_policy": -4312500.0}, "num_agent_steps_sampled_lifetime": {"default_agent": -4312500.0}, "time_between_sampling": 0.0024521587776695714, "episode_len_mean": 20.0, "episode_return_mean": 1.5399999999999994, "num_episodes": 250.0, "episode_duration_sec_mean": 0.008512543517164888, "episode_len_min": 20, "num_env_steps_sampled": 5000.0, "module_episode_returns_mean": {"default_policy": 1.5399999999999994}, "episode_return_max": 6.5, "num_env_steps_sampled_lifetime_throughput": 2318.5578331927477}, "learners": {"__all_modules__": {"learner_connector": {"timers": {"connectors": {"add_columns_from_episodes_to_train_batch": 0.03813244376773967, "add_states_from_episodes_to_batch": 4.874076898370208e-06, "add_one_ts_to_episodes_and_truncate": 0.013132514409329768, "numpy_to_tensor": 0.00020358711999543985, "batch_individual_items": 0.04762236477902929, "add_time_dim_to_batch_and_zero_pad": 1.4767907719916923e-05, "general_advantage_estimation": 0.013316580340705786, "add_observations_from_episodes_to_batch": 0.0008900494780711949}}, "connector_pipeline_timer": 0.11370074968565105}, "num_module_steps_trained": 6000, "num_non_trainable_parameters": 0, "num_module_steps_trained_lifetime": 54000, "learner_connector_sum_episodes_length_in": 5000.0, "learner_connector_sum_episodes_length_out": 5250.0, "num_env_steps_trained": 31500, "num_trainable_parameters": 6003, "num_env_steps_trained_lifetime": 283500, "num_env_steps_trained_lifetime_throughput": 949370.4610369036, "num_module_steps_trained_throughput": 183533.87155215588, "num_module_steps_trained_lifetime_throughput": 183333.57158274367}, "default_policy": {"num_module_steps_trained": 6000, "curr_entropy_coeff": 0.0090570820258, "num_module_steps_trained_lifetime": 54000, "gradients_default_optimizer_global_norm": 0.059552472084760666, "entropy": 0.6220744848251343, "total_loss": 0.05899802967905998, "weights_seq_no": 9.0, "default_optimizer_learning_rate": 0.0002847858517, "curr_kl_coeff": 0.0014580006245523691, "policy_loss": -0.0015838929684832692, "vf_loss_unclipped": 26.217327117919922, "vf_explained_var": -0.010414361953735352, "mean_kl_loss": 2.5744730010046624e-05, "num_trainable_parameters": 6003, "module_train_batch_size_mean": 1000.0, "diff_num_grad_updates_vs_sampler_policy": 1.0, "vf_loss": 0.09900609403848648, "num_module_steps_trained_lifetime_throughput": 183913.53618441243}}, "num_training_step_calls_per_iteration": 1, "evaluation": {"env_runners": {"num_module_steps_sampled_lifetime": {"default_policy": 3600}, "env_step_timer": 2.0072355486650245e-05, "episode_duration_sec_mean": 0.007669890812830999, "num_module_steps_sampled": {"default_policy": 400}, "num_agent_steps_sampled_lifetime": {"default_agent": 3600}, "rlmodule_inference_timer": 3.7626165459845615e-05, "weights_seq_no": 9.0, "env_to_module_sum_episodes_length_out": 10.368238394574323, "sample": 0.1824315615142336, "episode_len_mean": 20.0, "agent_episode_returns_mean": {"default_agent": 3.2}, "env_to_module_connector": {"connector_pipeline_timer": 5.500221239123044e-05, "timers": {"connectors": {"add_observations_from_episodes_to_batch": 3.7623680479408423e-06, "add_states_from_episodes_to_batch": 1.8844925966452538e-06, "numpy_to_tensor": 1.2193806177174286e-05, "batch_individual_items": 7.855354082526878e-06, "add_time_dim_to_batch_and_zero_pad": 3.0367116538030587e-06}}}, "episode_return_max": 13.5, "module_to_env_connector": {"timers": {"connectors": {"tensor_to_numpy": 1.766298295721329e-05, "listify_data_for_vector_env": 1.4421592070466306e-05, "normalize_and_clip_actions": 1.3164742337956328e-05, "un_batch_to_individual_items": 6.9102746565539385e-06, "remove_single_ts_time_rank_from_batch": 7.352362458970703e-07, "get_actions": 5.3474241066913335e-05}}, "connector_pipeline_timer": 0.0001383110313926148}, "env_to_module_sum_episodes_length_in": 10.368238394574323, "num_episodes_lifetime": 180, "module_episode_returns_mean": {"default_policy": 3.2}, "num_episodes": 20, "episode_len_min": 20, "num_agent_steps_sampled": {"default_agent": 400}, "episode_return_min": -12.5, "env_reset_timer": 0.0004906930000913505, "num_env_steps_sampled_lifetime": 45400, "episode_len_max": 20, "episode_return_mean": 3.2, "num_env_steps_sampled": 400, "time_between_sampling": 2.7638054628303284}, "num_healthy_workers": 1, "actor_manager_num_outstanding_async_reqs": 0, "num_remote_worker_restarts": 0}, "num_env_steps_sampled_lifetime": -4312500.0, "fault_tolerance": {"num_healthy_workers": 0, "num_remote_worker_restarts": 0}, "env_runner_group": {"actor_manager_num_outstanding_async_reqs": 0}, "done": false, "training_iteration": 9, "trial_id": "469e6_00000", "date": "2025-08-11_19-33-28", "timestamp": 1754933608, "time_this_iter_s": 2.958651065826416, "time_total_s": 28.307758569717407, "pid": 25834, "hostname": "Mac", "node_ip": "127.0.0.1", "config": {"exploration_config": {}, "extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "placement_strategy": "PACK", "num_gpus": 0, "_fake_gpus": false, "num_cpus_for_main_process": 2, "eager_tracing": true, "eager_max_retraces": 20, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "torch_compile_learner": false, "torch_compile_learner_what_to_compile": "forward_train", "torch_compile_learner_dynamo_backend": "aot_eager", "torch_compile_learner_dynamo_mode": null, "torch_compile_worker": false, "torch_compile_worker_dynamo_backend": "aot_eager", "torch_compile_worker_dynamo_mode": null, "torch_ddp_kwargs": {}, "torch_skip_nan_gradients": false, "env": "Umbrella", "env_config": {}, "observation_space": null, "action_space": null, "clip_rewards": null, "normalize_actions": true, "clip_actions": false, "_is_atari": null, "disable_env_checking": false, "render_env": false, "action_mask_key": "action_mask", "env_runner_cls": null, "num_env_runners": 0, "create_local_env_runner": true, "num_envs_per_env_runner": 1, "gym_env_vectorize_mode": "SYNC", "num_cpus_per_env_runner": 1, "num_gpus_per_env_runner": 0, "custom_resources_per_env_runner": {}, "validate_env_runners_after_construction": true, "episodes_to_numpy": true, "max_requests_in_flight_per_env_runner": 1, "sample_timeout_s": 60.0, "_env_to_module_connector": null, "add_default_connectors_to_env_to_module_pipeline": true, "_module_to_env_connector": null, "add_default_connectors_to_module_to_env_pipeline": true, "merge_env_runner_states": "training_only", "broadcast_env_runner_states": true, "episode_lookback_horizon": 1, "rollout_fragment_length": "auto", "batch_mode": "complete_episodes", "compress_observations": false, "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "enable_tf1_exec_eagerly": false, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "preprocessor_pref": "deepmind", "observation_filter": "NoFilter", "update_worker_filter_stats": true, "use_worker_filter_stats": true, "sampler_perf_stats_ema_coef": null, "_is_online": true, "num_learners": 0, "num_gpus_per_learner": 0, "num_cpus_per_learner": "auto", "num_aggregator_actors_per_learner": 0, "max_requests_in_flight_per_aggregator_actor": 3, "local_gpu_idx": 0, "max_requests_in_flight_per_learner": 3, "gamma": 1, "lr": 0.0002847858517, "grad_clip": 0.5, "grad_clip_by": "global_norm", "_train_batch_size_per_learner": 5000, "train_batch_size": 4000, "num_epochs": 1, "minibatch_size": 1000, "shuffle_batch_per_epoch": true, "model": {"fcnet_hiddens": [256, 256], "fcnet_activation": "tanh", "fcnet_weights_initializer": null, "fcnet_weights_initializer_config": null, "fcnet_bias_initializer": null, "fcnet_bias_initializer_config": null, "conv_filters": null, "conv_activation": "relu", "conv_kernel_initializer": null, "conv_kernel_initializer_config": null, "conv_bias_initializer": null, "conv_bias_initializer_config": null, "conv_transpose_kernel_initializer": null, "conv_transpose_kernel_initializer_config": null, "conv_transpose_bias_initializer": null, "conv_transpose_bias_initializer_config": null, "post_fcnet_hiddens": [], "post_fcnet_activation": "relu", "post_fcnet_weights_initializer": null, "post_fcnet_weights_initializer_config": null, "post_fcnet_bias_initializer": null, "post_fcnet_bias_initializer_config": null, "free_log_std": false, "log_std_clip_param": 20.0, "no_final_linear": false, "vf_share_layers": false, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "lstm_weights_initializer": null, "lstm_weights_initializer_config": null, "lstm_bias_initializer": null, "lstm_bias_initializer_config": null, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "attention_use_n_prev_actions": 0, "attention_use_n_prev_rewards": 0, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": null, "custom_model_config": {}, "custom_action_dist": null, "custom_preprocessor": null, "encoder_latent_dim": null, "always_check_shapes": false, "lstm_use_prev_action_reward": -1, "_use_default_native_models": -1, "_disable_preprocessor_api": false, "_disable_action_flattening": false}, "_learner_connector": null, "add_default_connectors_to_learner_pipeline": true, "learner_config_dict": {}, "optimizer": {}, "_learner_class": null, "callbacks_on_algorithm_init": null, "callbacks_on_env_runners_recreated": null, "callbacks_on_offline_eval_runners_recreated": null, "callbacks_on_checkpoint_loaded": null, "callbacks_on_environment_created": null, "callbacks_on_episode_created": null, "callbacks_on_episode_start": null, "callbacks_on_episode_step": null, "callbacks_on_episode_end": null, "callbacks_on_evaluate_start": null, "callbacks_on_evaluate_end": null, "callbacks_on_evaluate_offline_start": null, "callbacks_on_evaluate_offline_end": null, "callbacks_on_sample_end": null, "callbacks_on_train_result": null, "explore": true, "enable_rl_module_and_learner": true, "enable_env_runner_and_connector_v2": true, "_prior_exploration_config": {"type": "StochasticSampling"}, "count_steps_by": "env_steps", "policy_map_capacity": 100, "policy_mapping_fn": "<function AlgorithmConfig.DEFAULT_POLICY_MAPPING_FN at 0x14f2edb20>", "policies_to_train": null, "policy_states_are_swappable": false, "observation_fn": null, "offline_data_class": null, "input_read_method": "read_parquet", "input_read_method_kwargs": {}, "input_read_schema": {}, "input_read_episodes": false, "input_read_sample_batches": false, "input_read_batch_size": null, "input_filesystem": null, "input_filesystem_kwargs": {}, "input_compress_columns": ["obs", "new_obs"], "input_spaces_jsonable": true, "materialize_data": false, "materialize_mapped_data": true, "map_batches_kwargs": {}, "iter_batches_kwargs": {}, "ignore_final_observation": false, "prelearner_class": null, "prelearner_buffer_class": null, "prelearner_buffer_kwargs": {}, "prelearner_module_synch_period": 10, "dataset_num_iters_per_learner": null, "input_config": {}, "actions_in_input_normalized": false, "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_config": {}, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "output_max_rows_per_file": null, "output_write_remaining_data": false, "output_write_method": "write_parquet", "output_write_method_kwargs": {}, "output_filesystem": null, "output_filesystem_kwargs": {}, "output_write_episodes": true, "offline_sampling": false, "evaluation_interval": 1, "evaluation_duration": 20, "evaluation_duration_unit": "episodes", "evaluation_sample_timeout_s": 120.0, "evaluation_auto_duration_min_env_steps_per_sample": 100, "evaluation_auto_duration_max_env_steps_per_sample": 2000, "evaluation_parallel_to_training": false, "evaluation_force_reset_envs_before_iteration": true, "evaluation_config": null, "off_policy_estimation_methods": {}, "ope_split_batch_by_episode": true, "evaluation_num_env_runners": 1, "in_evaluation": false, "sync_filters_on_rollout_workers_timeout_s": 10.0, "offline_evaluation_interval": null, "num_offline_eval_runners": 0, "offline_loss_for_module_fn": null, "offline_evaluation_duration": 1, "offline_evaluation_parallel_to_training": false, "offline_evaluation_timeout_s": 120.0, "num_cpus_per_offline_eval_runner": 1, "num_gpus_per_offline_eval_runner": 0, "custom_resources_per_offline_eval_runner": {}, "restart_failed_offline_eval_runners": true, "ignore_offline_eval_runner_failures": false, "max_num_offline_eval_runner_restarts": 1000, "offline_eval_runner_restore_timeout_s": 1800.0, "max_requests_in_flight_per_offline_eval_runner": 1, "validate_offline_eval_runners_after_construction": true, "offline_eval_runner_health_probe_timeout_s": 30.0, "offline_eval_rl_module_inference_only": false, "broadcast_offline_eval_runner_states": false, "offline_eval_batch_size_per_runner": 256, "dataset_num_iters_per_eval_runner": 1, "keep_per_episode_custom_metrics": false, "metrics_episode_collection_timeout_s": 60.0, "metrics_num_episodes_for_smoothing": 100, "min_time_s_per_iteration": null, "min_train_timesteps_per_iteration": 0, "min_sample_timesteps_per_iteration": 0, "log_gradients": true, "export_native_model_files": false, "checkpoint_trainable_policies_only": false, "logger_creator": null, "logger_config": null, "log_level": "WARN", "log_sys_usage": true, "fake_sampler": false, "seed": 3, "restart_failed_env_runners": true, "ignore_env_runner_failures": false, "max_num_env_runner_restarts": 1000, "delay_between_env_runner_restarts_s": 60.0, "restart_failed_sub_environments": false, "num_consecutive_env_runner_failures_tolerance": 100, "env_runner_health_probe_timeout_s": 30.0, "env_runner_restore_timeout_s": 1800.0, "_model_config": {}, "_rl_module_spec": "RLModuleSpec(module_class=None, observation_space=None, action_space=None, inference_only=False, learner_only=False, model_config=DefaultModelConfig(fcnet_hiddens=[60, 90], fcnet_activation='tanh', fcnet_kernel_initializer=None, fcnet_kernel_initializer_kwargs=None, fcnet_bias_initializer=None, fcnet_bias_initializer_kwargs=None, conv_filters=None, conv_activation='relu', conv_kernel_initializer=None, conv_kernel_initializer_kwargs=None, conv_bias_initializer=None, conv_bias_initializer_kwargs=None, head_fcnet_hiddens=[], head_fcnet_activation='relu', head_fcnet_kernel_initializer=None, head_fcnet_kernel_initializer_kwargs=None, head_fcnet_bias_initializer=None, head_fcnet_bias_initializer_kwargs=None, free_log_std=False, log_std_clip_param=20.0, vf_share_layers=True, use_lstm=False, max_seq_len=20, lstm_cell_size=256, lstm_use_prev_action=False, lstm_use_prev_reward=False, lstm_kernel_initializer=None, lstm_kernel_initializer_kwargs=None, lstm_bias_initializer=None, lstm_bias_initializer_kwargs=None), catalog_class=None, load_state_path=None, model_config_dict=None)", "algorithm_config_overrides_per_module": {}, "_per_module_overrides": {}, "_validate_config": true, "_use_msgpack_checkpoints": false, "_torch_grad_scaler_class": null, "_torch_lr_scheduler_classes": null, "_tf_policy_handles_more_than_one_loss": false, "_disable_preprocessor_api": false, "_disable_action_flattening": false, "_disable_initialize_loss_from_dummy_batch": false, "_dont_auto_sync_env_runner_states": false, "env_task_fn": -1, "enable_connectors": -1, "simple_optimizer": false, "policy_map_cache": -1, "worker_cls": -1, "synchronize_filters": -1, "enable_async_evaluation": -1, "custom_async_evaluation_function": -1, "_enable_rl_module_api": -1, "auto_wrap_old_gym_envs": -1, "always_attach_evaluation_results": -1, "replay_sequence_length": null, "_disable_execution_plan_api": -1, "use_critic": true, "use_gae": true, "use_kl_loss": true, "kl_coeff": 0.7464963036515, "kl_target": 0.0270990929592, "vf_loss_coeff": 0.6688075857018, "entropy_coeff": 0.0090570820258, "clip_param": 0.1221781641624, "vf_clip_param": 0.1027808522125, "entropy_coeff_schedule": null, "lr_schedule": null, "sgd_minibatch_size": -1, "vf_share_layers": -1, "__stdout_file__": null, "__stderr_file__": null, "lambda": 0.9099046732075, "input": "sampler", "policies": {"default_policy": [null, null, null, null]}, "callbacks": "<class 'ray.rllib.callbacks.callbacks.RLlibCallback'>", "create_env_on_driver": false, "custom_eval_function": null, "framework": "torch"}, "time_since_restore": 28.307758569717407, "iterations_since_restore": 9, "perf": {"cpu_util_percent": 76.89999999999999, "ram_util_percent": 79.125}}
{"timers": {"training_iteration": 3.410679146725355, "restore_env_runners": 5.114627751663471e-05, "training_step": 3.410233967682036, "env_runner_sampling_timer": 3.2292126152742298, "learner_update_timer": 0.1760252049818304, "synch_weights": 0.0012937771972621516, "restore_eval_env_runners": 1.1104946950606054e-05, "evaluation_iteration": 0.19319751854834702, "synch_eval_env_connectors": 0.0001988619754899087, "synch_env_connectors": 7.023979533946439e-06}, "env_runners": {"episode_return_min": -13.5, "module_to_env_connector": {"connector_pipeline_timer": 0.00018078646941097672, "timers": {"connectors": {"normalize_and_clip_actions": 1.4676777299989981e-05, "un_batch_to_individual_items": 8.470970601933698e-06, "remove_single_ts_time_rank_from_batch": 9.365894112283021e-07, "tensor_to_numpy": 2.2175715775170732e-05, "listify_data_for_vector_env": 1.8566893389720927e-05, "get_actions": 7.683066614911838e-05}}}, "env_step_timer": 2.4792095273779692e-05, "rlmodule_inference_timer": 5.11137932205112e-05, "env_reset_timer": 7.615942504750437e-05, "agent_episode_returns_mean": {"default_agent": 0.58}, "num_env_steps_sampled_lifetime": -4930000.0, "weights_seq_no": 9.0, "env_to_module_sum_episodes_length_out": 10.36823839457432, "episode_len_max": 20, "env_to_module_connector": {"timers": {"connectors": {"batch_individual_items": 1.0679944767991605e-05, "numpy_to_tensor": 1.5688126928066347e-05, "add_time_dim_to_batch_and_zero_pad": 3.966661908017631e-06, "add_observations_from_episodes_to_batch": 4.760581729823958e-06, "add_states_from_episodes_to_batch": 2.412966214946756e-06}}, "connector_pipeline_timer": 6.915785617699943e-05}, "env_to_module_sum_episodes_length_in": 10.36823839457432, "sample": 0.008603351262307025, "num_agent_steps_sampled": {"default_agent": 5000.0}, "num_module_steps_sampled": {"default_policy": 5000.0}, "num_episodes_lifetime": -246500.0, "num_module_steps_sampled_lifetime": {"default_policy": -4930000.0}, "num_agent_steps_sampled_lifetime": {"default_agent": -4930000.0}, "time_between_sampling": 0.002691876745204591, "episode_len_mean": 20.0, "episode_return_mean": 0.58, "num_episodes": 250.0, "episode_duration_sec_mean": 0.007822604815941303, "episode_len_min": 20, "num_env_steps_sampled": 5000.0, "module_episode_returns_mean": {"default_policy": 0.58}, "episode_return_max": 6.5, "num_env_steps_sampled_lifetime_throughput": 2421.4942674208173}, "learners": {"__all_modules__": {"learner_connector": {"timers": {"connectors": {"add_columns_from_episodes_to_train_batch": 0.03829537224024788, "add_states_from_episodes_to_batch": 4.9015870010299295e-06, "add_one_ts_to_episodes_and_truncate": 0.013122414685389239, "numpy_to_tensor": 0.0002022504182636201, "batch_individual_items": 0.04863225071138515, "add_time_dim_to_batch_and_zero_pad": 1.4758979408190403e-05, "general_advantage_estimation": 0.013253660367873734, "add_observations_from_episodes_to_batch": 0.000893259813575138}}, "connector_pipeline_timer": 0.11480035176878982}, "num_module_steps_trained": 6000, "num_non_trainable_parameters": 0, "num_module_steps_trained_lifetime": 60000, "learner_connector_sum_episodes_length_in": 5000.0, "learner_connector_sum_episodes_length_out": 5250.0, "num_env_steps_trained": 31500, "num_trainable_parameters": 6003, "num_env_steps_trained_lifetime": 315000, "num_env_steps_trained_lifetime_throughput": 974999.0032326252, "num_module_steps_trained_throughput": 188303.47450305894, "num_module_steps_trained_lifetime_throughput": 188106.4922220276}, "default_policy": {"num_module_steps_trained": 6000, "curr_entropy_coeff": 0.0090570820258, "num_module_steps_trained_lifetime": 60000, "gradients_default_optimizer_global_norm": 0.019865432754158974, "entropy": 0.6069930195808411, "total_loss": -0.027369648218154907, "weights_seq_no": 10.0, "default_optimizer_learning_rate": 0.0002847858517, "curr_kl_coeff": 0.0007290003122761846, "policy_loss": -0.08808911591768265, "vf_loss_unclipped": 26.218334197998047, "vf_explained_var": -0.010382890701293945, "mean_kl_loss": 0.0007112051243893802, "num_trainable_parameters": 6003, "module_train_batch_size_mean": 1000.0, "diff_num_grad_updates_vs_sampler_policy": 1.0, "vf_loss": 0.09900609403848648, "num_module_steps_trained_lifetime_throughput": 188646.51202836342}}, "num_training_step_calls_per_iteration": 1, "evaluation": {"env_runners": {"num_module_steps_sampled_lifetime": {"default_policy": 4000}, "env_step_timer": 2.319388653724761e-05, "episode_duration_sec_mean": 0.007584626247407868, "num_module_steps_sampled": {"default_policy": 400}, "num_agent_steps_sampled_lifetime": {"default_agent": 4000}, "rlmodule_inference_timer": 4.209526871071769e-05, "weights_seq_no": 10.0, "env_to_module_sum_episodes_length_out": 10.368238394574323, "sample": 0.18247837630967306, "episode_len_mean": 20.0, "agent_episode_returns_mean": {"default_agent": 4.8}, "env_to_module_connector": {"connector_pipeline_timer": 6.386223160958435e-05, "timers": {"connectors": {"add_observations_from_episodes_to_batch": 3.893477409634125e-06, "add_states_from_episodes_to_batch": 2.1489792199333335e-06, "numpy_to_tensor": 1.3922320985847278e-05, "batch_individual_items": 1.0418768242887846e-05, "add_time_dim_to_batch_and_zero_pad": 3.17741957581266e-06}}}, "episode_return_max": 13.5, "module_to_env_connector": {"timers": {"connectors": {"tensor_to_numpy": 2.0681520109909098e-05, "listify_data_for_vector_env": 1.708986779559354e-05, "normalize_and_clip_actions": 1.5406893942375004e-05, "un_batch_to_individual_items": 7.939945487725037e-06, "remove_single_ts_time_rank_from_batch": 8.465086694334638e-07, "get_actions": 6.103573135329287e-05}}, "connector_pipeline_timer": 0.00016161379878976547}, "env_to_module_sum_episodes_length_in": 10.368238394574323, "num_episodes_lifetime": 200, "module_episode_returns_mean": {"default_policy": 4.8}, "num_episodes": 20, "episode_len_min": 20, "num_agent_steps_sampled": {"default_agent": 400}, "episode_return_min": -12.5, "env_reset_timer": 0.00048653065084730985, "num_env_steps_sampled_lifetime": 50400, "episode_len_max": 20, "episode_return_mean": 4.8, "num_env_steps_sampled": 400, "time_between_sampling": 2.7627031398713076}, "num_healthy_workers": 1, "actor_manager_num_outstanding_async_reqs": 0, "num_remote_worker_restarts": 0}, "num_env_steps_sampled_lifetime": -4930000.0, "fault_tolerance": {"num_healthy_workers": 0, "num_remote_worker_restarts": 0}, "env_runner_group": {"actor_manager_num_outstanding_async_reqs": 0}, "done": false, "training_iteration": 10, "trial_id": "469e6_00000", "date": "2025-08-11_19-33-31", "timestamp": 1754933611, "time_this_iter_s": 2.822979688644409, "time_total_s": 31.130738258361816, "pid": 25834, "hostname": "Mac", "node_ip": "127.0.0.1", "config": {"exploration_config": {}, "extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "placement_strategy": "PACK", "num_gpus": 0, "_fake_gpus": false, "num_cpus_for_main_process": 2, "eager_tracing": true, "eager_max_retraces": 20, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "torch_compile_learner": false, "torch_compile_learner_what_to_compile": "forward_train", "torch_compile_learner_dynamo_backend": "aot_eager", "torch_compile_learner_dynamo_mode": null, "torch_compile_worker": false, "torch_compile_worker_dynamo_backend": "aot_eager", "torch_compile_worker_dynamo_mode": null, "torch_ddp_kwargs": {}, "torch_skip_nan_gradients": false, "env": "Umbrella", "env_config": {}, "observation_space": null, "action_space": null, "clip_rewards": null, "normalize_actions": true, "clip_actions": false, "_is_atari": null, "disable_env_checking": false, "render_env": false, "action_mask_key": "action_mask", "env_runner_cls": null, "num_env_runners": 0, "create_local_env_runner": true, "num_envs_per_env_runner": 1, "gym_env_vectorize_mode": "SYNC", "num_cpus_per_env_runner": 1, "num_gpus_per_env_runner": 0, "custom_resources_per_env_runner": {}, "validate_env_runners_after_construction": true, "episodes_to_numpy": true, "max_requests_in_flight_per_env_runner": 1, "sample_timeout_s": 60.0, "_env_to_module_connector": null, "add_default_connectors_to_env_to_module_pipeline": true, "_module_to_env_connector": null, "add_default_connectors_to_module_to_env_pipeline": true, "merge_env_runner_states": "training_only", "broadcast_env_runner_states": true, "episode_lookback_horizon": 1, "rollout_fragment_length": "auto", "batch_mode": "complete_episodes", "compress_observations": false, "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "enable_tf1_exec_eagerly": false, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "preprocessor_pref": "deepmind", "observation_filter": "NoFilter", "update_worker_filter_stats": true, "use_worker_filter_stats": true, "sampler_perf_stats_ema_coef": null, "_is_online": true, "num_learners": 0, "num_gpus_per_learner": 0, "num_cpus_per_learner": "auto", "num_aggregator_actors_per_learner": 0, "max_requests_in_flight_per_aggregator_actor": 3, "local_gpu_idx": 0, "max_requests_in_flight_per_learner": 3, "gamma": 1, "lr": 0.0002847858517, "grad_clip": 0.5, "grad_clip_by": "global_norm", "_train_batch_size_per_learner": 5000, "train_batch_size": 4000, "num_epochs": 1, "minibatch_size": 1000, "shuffle_batch_per_epoch": true, "model": {"fcnet_hiddens": [256, 256], "fcnet_activation": "tanh", "fcnet_weights_initializer": null, "fcnet_weights_initializer_config": null, "fcnet_bias_initializer": null, "fcnet_bias_initializer_config": null, "conv_filters": null, "conv_activation": "relu", "conv_kernel_initializer": null, "conv_kernel_initializer_config": null, "conv_bias_initializer": null, "conv_bias_initializer_config": null, "conv_transpose_kernel_initializer": null, "conv_transpose_kernel_initializer_config": null, "conv_transpose_bias_initializer": null, "conv_transpose_bias_initializer_config": null, "post_fcnet_hiddens": [], "post_fcnet_activation": "relu", "post_fcnet_weights_initializer": null, "post_fcnet_weights_initializer_config": null, "post_fcnet_bias_initializer": null, "post_fcnet_bias_initializer_config": null, "free_log_std": false, "log_std_clip_param": 20.0, "no_final_linear": false, "vf_share_layers": false, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "lstm_weights_initializer": null, "lstm_weights_initializer_config": null, "lstm_bias_initializer": null, "lstm_bias_initializer_config": null, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "attention_use_n_prev_actions": 0, "attention_use_n_prev_rewards": 0, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": null, "custom_model_config": {}, "custom_action_dist": null, "custom_preprocessor": null, "encoder_latent_dim": null, "always_check_shapes": false, "lstm_use_prev_action_reward": -1, "_use_default_native_models": -1, "_disable_preprocessor_api": false, "_disable_action_flattening": false}, "_learner_connector": null, "add_default_connectors_to_learner_pipeline": true, "learner_config_dict": {}, "optimizer": {}, "_learner_class": null, "callbacks_on_algorithm_init": null, "callbacks_on_env_runners_recreated": null, "callbacks_on_offline_eval_runners_recreated": null, "callbacks_on_checkpoint_loaded": null, "callbacks_on_environment_created": null, "callbacks_on_episode_created": null, "callbacks_on_episode_start": null, "callbacks_on_episode_step": null, "callbacks_on_episode_end": null, "callbacks_on_evaluate_start": null, "callbacks_on_evaluate_end": null, "callbacks_on_evaluate_offline_start": null, "callbacks_on_evaluate_offline_end": null, "callbacks_on_sample_end": null, "callbacks_on_train_result": null, "explore": true, "enable_rl_module_and_learner": true, "enable_env_runner_and_connector_v2": true, "_prior_exploration_config": {"type": "StochasticSampling"}, "count_steps_by": "env_steps", "policy_map_capacity": 100, "policy_mapping_fn": "<function AlgorithmConfig.DEFAULT_POLICY_MAPPING_FN at 0x14f2edb20>", "policies_to_train": null, "policy_states_are_swappable": false, "observation_fn": null, "offline_data_class": null, "input_read_method": "read_parquet", "input_read_method_kwargs": {}, "input_read_schema": {}, "input_read_episodes": false, "input_read_sample_batches": false, "input_read_batch_size": null, "input_filesystem": null, "input_filesystem_kwargs": {}, "input_compress_columns": ["obs", "new_obs"], "input_spaces_jsonable": true, "materialize_data": false, "materialize_mapped_data": true, "map_batches_kwargs": {}, "iter_batches_kwargs": {}, "ignore_final_observation": false, "prelearner_class": null, "prelearner_buffer_class": null, "prelearner_buffer_kwargs": {}, "prelearner_module_synch_period": 10, "dataset_num_iters_per_learner": null, "input_config": {}, "actions_in_input_normalized": false, "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_config": {}, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "output_max_rows_per_file": null, "output_write_remaining_data": false, "output_write_method": "write_parquet", "output_write_method_kwargs": {}, "output_filesystem": null, "output_filesystem_kwargs": {}, "output_write_episodes": true, "offline_sampling": false, "evaluation_interval": 1, "evaluation_duration": 20, "evaluation_duration_unit": "episodes", "evaluation_sample_timeout_s": 120.0, "evaluation_auto_duration_min_env_steps_per_sample": 100, "evaluation_auto_duration_max_env_steps_per_sample": 2000, "evaluation_parallel_to_training": false, "evaluation_force_reset_envs_before_iteration": true, "evaluation_config": null, "off_policy_estimation_methods": {}, "ope_split_batch_by_episode": true, "evaluation_num_env_runners": 1, "in_evaluation": false, "sync_filters_on_rollout_workers_timeout_s": 10.0, "offline_evaluation_interval": null, "num_offline_eval_runners": 0, "offline_loss_for_module_fn": null, "offline_evaluation_duration": 1, "offline_evaluation_parallel_to_training": false, "offline_evaluation_timeout_s": 120.0, "num_cpus_per_offline_eval_runner": 1, "num_gpus_per_offline_eval_runner": 0, "custom_resources_per_offline_eval_runner": {}, "restart_failed_offline_eval_runners": true, "ignore_offline_eval_runner_failures": false, "max_num_offline_eval_runner_restarts": 1000, "offline_eval_runner_restore_timeout_s": 1800.0, "max_requests_in_flight_per_offline_eval_runner": 1, "validate_offline_eval_runners_after_construction": true, "offline_eval_runner_health_probe_timeout_s": 30.0, "offline_eval_rl_module_inference_only": false, "broadcast_offline_eval_runner_states": false, "offline_eval_batch_size_per_runner": 256, "dataset_num_iters_per_eval_runner": 1, "keep_per_episode_custom_metrics": false, "metrics_episode_collection_timeout_s": 60.0, "metrics_num_episodes_for_smoothing": 100, "min_time_s_per_iteration": null, "min_train_timesteps_per_iteration": 0, "min_sample_timesteps_per_iteration": 0, "log_gradients": true, "export_native_model_files": false, "checkpoint_trainable_policies_only": false, "logger_creator": null, "logger_config": null, "log_level": "WARN", "log_sys_usage": true, "fake_sampler": false, "seed": 3, "restart_failed_env_runners": true, "ignore_env_runner_failures": false, "max_num_env_runner_restarts": 1000, "delay_between_env_runner_restarts_s": 60.0, "restart_failed_sub_environments": false, "num_consecutive_env_runner_failures_tolerance": 100, "env_runner_health_probe_timeout_s": 30.0, "env_runner_restore_timeout_s": 1800.0, "_model_config": {}, "_rl_module_spec": "RLModuleSpec(module_class=None, observation_space=None, action_space=None, inference_only=False, learner_only=False, model_config=DefaultModelConfig(fcnet_hiddens=[60, 90], fcnet_activation='tanh', fcnet_kernel_initializer=None, fcnet_kernel_initializer_kwargs=None, fcnet_bias_initializer=None, fcnet_bias_initializer_kwargs=None, conv_filters=None, conv_activation='relu', conv_kernel_initializer=None, conv_kernel_initializer_kwargs=None, conv_bias_initializer=None, conv_bias_initializer_kwargs=None, head_fcnet_hiddens=[], head_fcnet_activation='relu', head_fcnet_kernel_initializer=None, head_fcnet_kernel_initializer_kwargs=None, head_fcnet_bias_initializer=None, head_fcnet_bias_initializer_kwargs=None, free_log_std=False, log_std_clip_param=20.0, vf_share_layers=True, use_lstm=False, max_seq_len=20, lstm_cell_size=256, lstm_use_prev_action=False, lstm_use_prev_reward=False, lstm_kernel_initializer=None, lstm_kernel_initializer_kwargs=None, lstm_bias_initializer=None, lstm_bias_initializer_kwargs=None), catalog_class=None, load_state_path=None, model_config_dict=None)", "algorithm_config_overrides_per_module": {}, "_per_module_overrides": {}, "_validate_config": true, "_use_msgpack_checkpoints": false, "_torch_grad_scaler_class": null, "_torch_lr_scheduler_classes": null, "_tf_policy_handles_more_than_one_loss": false, "_disable_preprocessor_api": false, "_disable_action_flattening": false, "_disable_initialize_loss_from_dummy_batch": false, "_dont_auto_sync_env_runner_states": false, "env_task_fn": -1, "enable_connectors": -1, "simple_optimizer": false, "policy_map_cache": -1, "worker_cls": -1, "synchronize_filters": -1, "enable_async_evaluation": -1, "custom_async_evaluation_function": -1, "_enable_rl_module_api": -1, "auto_wrap_old_gym_envs": -1, "always_attach_evaluation_results": -1, "replay_sequence_length": null, "_disable_execution_plan_api": -1, "use_critic": true, "use_gae": true, "use_kl_loss": true, "kl_coeff": 0.7464963036515, "kl_target": 0.0270990929592, "vf_loss_coeff": 0.6688075857018, "entropy_coeff": 0.0090570820258, "clip_param": 0.1221781641624, "vf_clip_param": 0.1027808522125, "entropy_coeff_schedule": null, "lr_schedule": null, "sgd_minibatch_size": -1, "vf_share_layers": -1, "__stdout_file__": null, "__stderr_file__": null, "lambda": 0.9099046732075, "input": "sampler", "policies": {"default_policy": [null, null, null, null]}, "callbacks": "<class 'ray.rllib.callbacks.callbacks.RLlibCallback'>", "create_env_on_driver": false, "custom_eval_function": null, "framework": "torch"}, "time_since_restore": 31.130738258361816, "iterations_since_restore": 10, "perf": {"cpu_util_percent": 54.15, "ram_util_percent": 79.525}}
{"timers": {"training_iteration": 3.400786929427702, "restore_env_runners": 5.0699815236410426e-05, "training_step": 3.400342418835182, "env_runner_sampling_timer": 3.2198532174513934, "learner_update_timer": 0.1754435233520277, "synch_weights": 0.001298646514314685, "restore_eval_env_runners": 1.1065147150517733e-05, "evaluation_iteration": 0.19320902295298148, "synch_eval_env_connectors": 0.00019818043553634554, "synch_env_connectors": 6.99499034374313e-06}, "env_runners": {"episode_return_min": -13.5, "module_to_env_connector": {"connector_pipeline_timer": 0.00017824974109690312, "timers": {"connectors": {"normalize_and_clip_actions": 1.4642349076342586e-05, "un_batch_to_individual_items": 8.204120387291212e-06, "remove_single_ts_time_rank_from_batch": 9.722542422396826e-07, "tensor_to_numpy": 2.2247269552345186e-05, "listify_data_for_vector_env": 1.8120035020743757e-05, "get_actions": 7.500778352401066e-05}}}, "env_step_timer": 2.425750940482692e-05, "rlmodule_inference_timer": 5.1209164790896556e-05, "env_reset_timer": 7.284101461169232e-05, "agent_episode_returns_mean": {"default_agent": 2.42}, "num_env_steps_sampled_lifetime": -5547500.0, "weights_seq_no": 10.0, "env_to_module_sum_episodes_length_out": 10.36823839457432, "episode_len_max": 20, "env_to_module_connector": {"timers": {"connectors": {"batch_individual_items": 1.0595528089645426e-05, "numpy_to_tensor": 1.541466576753577e-05, "add_time_dim_to_batch_and_zero_pad": 3.7664506872431266e-06, "add_observations_from_episodes_to_batch": 4.692912347410336e-06, "add_states_from_episodes_to_batch": 2.4724511170828077e-06}}, "connector_pipeline_timer": 6.811383131481738e-05}, "env_to_module_sum_episodes_length_in": 10.36823839457432, "sample": 0.008207168529062793, "num_agent_steps_sampled": {"default_agent": 5000.0}, "num_module_steps_sampled": {"default_policy": 5000.0}, "num_episodes_lifetime": -277375.0, "num_module_steps_sampled_lifetime": {"default_policy": -5547500.0}, "num_agent_steps_sampled_lifetime": {"default_agent": -5547500.0}, "time_between_sampling": 0.0029136019410802316, "episode_len_mean": 20.0, "episode_return_mean": 2.42, "num_episodes": 250.0, "episode_duration_sec_mean": 0.007646114692557603, "episode_len_min": 20, "num_env_steps_sampled": 5000.0, "module_episode_returns_mean": {"default_policy": 2.42}, "episode_return_max": 6.5, "num_env_steps_sampled_lifetime_throughput": 2460.913796162589}, "learners": {"__all_modules__": {"learner_connector": {"timers": {"connectors": {"add_columns_from_episodes_to_train_batch": 0.03831555018816395, "add_states_from_episodes_to_batch": 4.886321096970477e-06, "add_one_ts_to_episodes_and_truncate": 0.013092999288140316, "numpy_to_tensor": 0.00020089374452925374, "batch_individual_items": 0.04845899528425867, "add_time_dim_to_batch_and_zero_pad": 1.4725139025065598e-05, "general_advantage_estimation": 0.013190872095056325, "add_observations_from_episodes_to_batch": 0.0008928167946345433}}, "connector_pipeline_timer": 0.11455056783093269}, "num_module_steps_trained": 6000, "num_non_trainable_parameters": 0, "num_module_steps_trained_lifetime": 66000, "learner_connector_sum_episodes_length_in": 5000.0, "learner_connector_sum_episodes_length_out": 5250.0, "num_env_steps_trained": 31500, "num_trainable_parameters": 6003, "num_env_steps_trained_lifetime": 346500, "num_env_steps_trained_lifetime_throughput": 995360.4127171307, "num_module_steps_trained_throughput": 192070.51052379236, "num_module_steps_trained_lifetime_throughput": 191878.35497573827}, "default_policy": {"num_module_steps_trained": 6000, "curr_entropy_coeff": 0.0090570820258, "num_module_steps_trained_lifetime": 66000, "gradients_default_optimizer_global_norm": 0.04201570525765419, "entropy": 0.5904287099838257, "total_loss": 0.015427875332534313, "weights_seq_no": 11.0, "default_optimizer_learning_rate": 0.0002847858517, "curr_kl_coeff": 0.0003645001561380923, "policy_loss": -0.04522467032074928, "vf_loss_unclipped": 25.318986892700195, "vf_explained_var": -0.009004473686218262, "mean_kl_loss": 0.0006328527233563364, "num_trainable_parameters": 6003, "module_train_batch_size_mean": 1000.0, "diff_num_grad_updates_vs_sampler_policy": 1.0, "vf_loss": 0.09868254512548447, "num_module_steps_trained_lifetime_throughput": 192374.90016347723}}, "num_training_step_calls_per_iteration": 1, "evaluation": {"env_runners": {"num_module_steps_sampled_lifetime": {"default_policy": 4400}, "env_step_timer": 2.5348520002504715e-05, "episode_duration_sec_mean": 0.0075025883631315085, "num_module_steps_sampled": {"default_policy": 400}, "num_agent_steps_sampled_lifetime": {"default_agent": 4400}, "rlmodule_inference_timer": 4.273030336318754e-05, "weights_seq_no": 11.0, "env_to_module_sum_episodes_length_out": 10.368238394574323, "sample": 0.18228168004715228, "episode_len_mean": 20.0, "agent_episode_returns_mean": {"default_agent": 5.0}, "env_to_module_connector": {"connector_pipeline_timer": 7.62220202643036e-05, "timers": {"connectors": {"add_observations_from_episodes_to_batch": 5.132341609256914e-06, "add_states_from_episodes_to_batch": 2.726355361032296e-06, "numpy_to_tensor": 1.4403696393023887e-05, "batch_individual_items": 1.1932388526038641e-05, "add_time_dim_to_batch_and_zero_pad": 4.346670733839998e-06}}}, "episode_return_max": 13.5, "module_to_env_connector": {"timers": {"connectors": {"tensor_to_numpy": 2.2392913035363974e-05, "listify_data_for_vector_env": 2.0323293153870003e-05, "normalize_and_clip_actions": 1.7152463570714917e-05, "un_batch_to_individual_items": 9.728130354901971e-06, "remove_single_ts_time_rank_from_batch": 9.267308952822774e-07, "get_actions": 6.625316617424005e-05}}, "connector_pipeline_timer": 0.00017714456947143912}, "env_to_module_sum_episodes_length_in": 10.368238394574323, "num_episodes_lifetime": 220, "module_episode_returns_mean": {"default_policy": 5.0}, "num_episodes": 20, "episode_len_min": 20, "num_agent_steps_sampled": {"default_agent": 400}, "episode_return_min": -12.5, "env_reset_timer": 0.00048345118447949237, "num_env_steps_sampled_lifetime": 55400, "episode_len_max": 20, "episode_return_mean": 5.0, "num_env_steps_sampled": 400, "time_between_sampling": 2.759576965142214}, "num_healthy_workers": 1, "actor_manager_num_outstanding_async_reqs": 0, "num_remote_worker_restarts": 0}, "num_env_steps_sampled_lifetime": -5547500.0, "fault_tolerance": {"num_healthy_workers": 0, "num_remote_worker_restarts": 0}, "env_runner_group": {"actor_manager_num_outstanding_async_reqs": 0}, "done": false, "training_iteration": 11, "trial_id": "469e6_00000", "date": "2025-08-11_19-33-34", "timestamp": 1754933614, "time_this_iter_s": 2.597633123397827, "time_total_s": 33.728371381759644, "pid": 25834, "hostname": "Mac", "node_ip": "127.0.0.1", "config": {"exploration_config": {}, "extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "placement_strategy": "PACK", "num_gpus": 0, "_fake_gpus": false, "num_cpus_for_main_process": 2, "eager_tracing": true, "eager_max_retraces": 20, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "torch_compile_learner": false, "torch_compile_learner_what_to_compile": "forward_train", "torch_compile_learner_dynamo_backend": "aot_eager", "torch_compile_learner_dynamo_mode": null, "torch_compile_worker": false, "torch_compile_worker_dynamo_backend": "aot_eager", "torch_compile_worker_dynamo_mode": null, "torch_ddp_kwargs": {}, "torch_skip_nan_gradients": false, "env": "Umbrella", "env_config": {}, "observation_space": null, "action_space": null, "clip_rewards": null, "normalize_actions": true, "clip_actions": false, "_is_atari": null, "disable_env_checking": false, "render_env": false, "action_mask_key": "action_mask", "env_runner_cls": null, "num_env_runners": 0, "create_local_env_runner": true, "num_envs_per_env_runner": 1, "gym_env_vectorize_mode": "SYNC", "num_cpus_per_env_runner": 1, "num_gpus_per_env_runner": 0, "custom_resources_per_env_runner": {}, "validate_env_runners_after_construction": true, "episodes_to_numpy": true, "max_requests_in_flight_per_env_runner": 1, "sample_timeout_s": 60.0, "_env_to_module_connector": null, "add_default_connectors_to_env_to_module_pipeline": true, "_module_to_env_connector": null, "add_default_connectors_to_module_to_env_pipeline": true, "merge_env_runner_states": "training_only", "broadcast_env_runner_states": true, "episode_lookback_horizon": 1, "rollout_fragment_length": "auto", "batch_mode": "complete_episodes", "compress_observations": false, "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "enable_tf1_exec_eagerly": false, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "preprocessor_pref": "deepmind", "observation_filter": "NoFilter", "update_worker_filter_stats": true, "use_worker_filter_stats": true, "sampler_perf_stats_ema_coef": null, "_is_online": true, "num_learners": 0, "num_gpus_per_learner": 0, "num_cpus_per_learner": "auto", "num_aggregator_actors_per_learner": 0, "max_requests_in_flight_per_aggregator_actor": 3, "local_gpu_idx": 0, "max_requests_in_flight_per_learner": 3, "gamma": 1, "lr": 0.0002847858517, "grad_clip": 0.5, "grad_clip_by": "global_norm", "_train_batch_size_per_learner": 5000, "train_batch_size": 4000, "num_epochs": 1, "minibatch_size": 1000, "shuffle_batch_per_epoch": true, "model": {"fcnet_hiddens": [256, 256], "fcnet_activation": "tanh", "fcnet_weights_initializer": null, "fcnet_weights_initializer_config": null, "fcnet_bias_initializer": null, "fcnet_bias_initializer_config": null, "conv_filters": null, "conv_activation": "relu", "conv_kernel_initializer": null, "conv_kernel_initializer_config": null, "conv_bias_initializer": null, "conv_bias_initializer_config": null, "conv_transpose_kernel_initializer": null, "conv_transpose_kernel_initializer_config": null, "conv_transpose_bias_initializer": null, "conv_transpose_bias_initializer_config": null, "post_fcnet_hiddens": [], "post_fcnet_activation": "relu", "post_fcnet_weights_initializer": null, "post_fcnet_weights_initializer_config": null, "post_fcnet_bias_initializer": null, "post_fcnet_bias_initializer_config": null, "free_log_std": false, "log_std_clip_param": 20.0, "no_final_linear": false, "vf_share_layers": false, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "lstm_weights_initializer": null, "lstm_weights_initializer_config": null, "lstm_bias_initializer": null, "lstm_bias_initializer_config": null, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "attention_use_n_prev_actions": 0, "attention_use_n_prev_rewards": 0, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": null, "custom_model_config": {}, "custom_action_dist": null, "custom_preprocessor": null, "encoder_latent_dim": null, "always_check_shapes": false, "lstm_use_prev_action_reward": -1, "_use_default_native_models": -1, "_disable_preprocessor_api": false, "_disable_action_flattening": false}, "_learner_connector": null, "add_default_connectors_to_learner_pipeline": true, "learner_config_dict": {}, "optimizer": {}, "_learner_class": null, "callbacks_on_algorithm_init": null, "callbacks_on_env_runners_recreated": null, "callbacks_on_offline_eval_runners_recreated": null, "callbacks_on_checkpoint_loaded": null, "callbacks_on_environment_created": null, "callbacks_on_episode_created": null, "callbacks_on_episode_start": null, "callbacks_on_episode_step": null, "callbacks_on_episode_end": null, "callbacks_on_evaluate_start": null, "callbacks_on_evaluate_end": null, "callbacks_on_evaluate_offline_start": null, "callbacks_on_evaluate_offline_end": null, "callbacks_on_sample_end": null, "callbacks_on_train_result": null, "explore": true, "enable_rl_module_and_learner": true, "enable_env_runner_and_connector_v2": true, "_prior_exploration_config": {"type": "StochasticSampling"}, "count_steps_by": "env_steps", "policy_map_capacity": 100, "policy_mapping_fn": "<function AlgorithmConfig.DEFAULT_POLICY_MAPPING_FN at 0x14f2edb20>", "policies_to_train": null, "policy_states_are_swappable": false, "observation_fn": null, "offline_data_class": null, "input_read_method": "read_parquet", "input_read_method_kwargs": {}, "input_read_schema": {}, "input_read_episodes": false, "input_read_sample_batches": false, "input_read_batch_size": null, "input_filesystem": null, "input_filesystem_kwargs": {}, "input_compress_columns": ["obs", "new_obs"], "input_spaces_jsonable": true, "materialize_data": false, "materialize_mapped_data": true, "map_batches_kwargs": {}, "iter_batches_kwargs": {}, "ignore_final_observation": false, "prelearner_class": null, "prelearner_buffer_class": null, "prelearner_buffer_kwargs": {}, "prelearner_module_synch_period": 10, "dataset_num_iters_per_learner": null, "input_config": {}, "actions_in_input_normalized": false, "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_config": {}, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "output_max_rows_per_file": null, "output_write_remaining_data": false, "output_write_method": "write_parquet", "output_write_method_kwargs": {}, "output_filesystem": null, "output_filesystem_kwargs": {}, "output_write_episodes": true, "offline_sampling": false, "evaluation_interval": 1, "evaluation_duration": 20, "evaluation_duration_unit": "episodes", "evaluation_sample_timeout_s": 120.0, "evaluation_auto_duration_min_env_steps_per_sample": 100, "evaluation_auto_duration_max_env_steps_per_sample": 2000, "evaluation_parallel_to_training": false, "evaluation_force_reset_envs_before_iteration": true, "evaluation_config": null, "off_policy_estimation_methods": {}, "ope_split_batch_by_episode": true, "evaluation_num_env_runners": 1, "in_evaluation": false, "sync_filters_on_rollout_workers_timeout_s": 10.0, "offline_evaluation_interval": null, "num_offline_eval_runners": 0, "offline_loss_for_module_fn": null, "offline_evaluation_duration": 1, "offline_evaluation_parallel_to_training": false, "offline_evaluation_timeout_s": 120.0, "num_cpus_per_offline_eval_runner": 1, "num_gpus_per_offline_eval_runner": 0, "custom_resources_per_offline_eval_runner": {}, "restart_failed_offline_eval_runners": true, "ignore_offline_eval_runner_failures": false, "max_num_offline_eval_runner_restarts": 1000, "offline_eval_runner_restore_timeout_s": 1800.0, "max_requests_in_flight_per_offline_eval_runner": 1, "validate_offline_eval_runners_after_construction": true, "offline_eval_runner_health_probe_timeout_s": 30.0, "offline_eval_rl_module_inference_only": false, "broadcast_offline_eval_runner_states": false, "offline_eval_batch_size_per_runner": 256, "dataset_num_iters_per_eval_runner": 1, "keep_per_episode_custom_metrics": false, "metrics_episode_collection_timeout_s": 60.0, "metrics_num_episodes_for_smoothing": 100, "min_time_s_per_iteration": null, "min_train_timesteps_per_iteration": 0, "min_sample_timesteps_per_iteration": 0, "log_gradients": true, "export_native_model_files": false, "checkpoint_trainable_policies_only": false, "logger_creator": null, "logger_config": null, "log_level": "WARN", "log_sys_usage": true, "fake_sampler": false, "seed": 3, "restart_failed_env_runners": true, "ignore_env_runner_failures": false, "max_num_env_runner_restarts": 1000, "delay_between_env_runner_restarts_s": 60.0, "restart_failed_sub_environments": false, "num_consecutive_env_runner_failures_tolerance": 100, "env_runner_health_probe_timeout_s": 30.0, "env_runner_restore_timeout_s": 1800.0, "_model_config": {}, "_rl_module_spec": "RLModuleSpec(module_class=None, observation_space=None, action_space=None, inference_only=False, learner_only=False, model_config=DefaultModelConfig(fcnet_hiddens=[60, 90], fcnet_activation='tanh', fcnet_kernel_initializer=None, fcnet_kernel_initializer_kwargs=None, fcnet_bias_initializer=None, fcnet_bias_initializer_kwargs=None, conv_filters=None, conv_activation='relu', conv_kernel_initializer=None, conv_kernel_initializer_kwargs=None, conv_bias_initializer=None, conv_bias_initializer_kwargs=None, head_fcnet_hiddens=[], head_fcnet_activation='relu', head_fcnet_kernel_initializer=None, head_fcnet_kernel_initializer_kwargs=None, head_fcnet_bias_initializer=None, head_fcnet_bias_initializer_kwargs=None, free_log_std=False, log_std_clip_param=20.0, vf_share_layers=True, use_lstm=False, max_seq_len=20, lstm_cell_size=256, lstm_use_prev_action=False, lstm_use_prev_reward=False, lstm_kernel_initializer=None, lstm_kernel_initializer_kwargs=None, lstm_bias_initializer=None, lstm_bias_initializer_kwargs=None), catalog_class=None, load_state_path=None, model_config_dict=None)", "algorithm_config_overrides_per_module": {}, "_per_module_overrides": {}, "_validate_config": true, "_use_msgpack_checkpoints": false, "_torch_grad_scaler_class": null, "_torch_lr_scheduler_classes": null, "_tf_policy_handles_more_than_one_loss": false, "_disable_preprocessor_api": false, "_disable_action_flattening": false, "_disable_initialize_loss_from_dummy_batch": false, "_dont_auto_sync_env_runner_states": false, "env_task_fn": -1, "enable_connectors": -1, "simple_optimizer": false, "policy_map_cache": -1, "worker_cls": -1, "synchronize_filters": -1, "enable_async_evaluation": -1, "custom_async_evaluation_function": -1, "_enable_rl_module_api": -1, "auto_wrap_old_gym_envs": -1, "always_attach_evaluation_results": -1, "replay_sequence_length": null, "_disable_execution_plan_api": -1, "use_critic": true, "use_gae": true, "use_kl_loss": true, "kl_coeff": 0.7464963036515, "kl_target": 0.0270990929592, "vf_loss_coeff": 0.6688075857018, "entropy_coeff": 0.0090570820258, "clip_param": 0.1221781641624, "vf_clip_param": 0.1027808522125, "entropy_coeff_schedule": null, "lr_schedule": null, "sgd_minibatch_size": -1, "vf_share_layers": -1, "__stdout_file__": null, "__stderr_file__": null, "lambda": 0.9099046732075, "input": "sampler", "policies": {"default_policy": [null, null, null, null]}, "callbacks": "<class 'ray.rllib.callbacks.callbacks.RLlibCallback'>", "create_env_on_driver": false, "custom_eval_function": null, "framework": "torch"}, "time_since_restore": 33.728371381759644, "iterations_since_restore": 11, "perf": {"cpu_util_percent": 69.975, "ram_util_percent": 79.2}}
{"timers": {"training_iteration": 3.3914042351338263, "restore_env_runners": 5.02569770603648e-05, "training_step": 3.3909600933973336, "env_runner_sampling_timer": 3.210876903196417, "learner_update_timer": 0.17502163394844428, "synch_weights": 0.0012981737987058021, "restore_eval_env_runners": 1.1030745386502761e-05, "evaluation_iteration": 0.1929976010535418, "synch_eval_env_connectors": 0.00019836363136821518, "synch_env_connectors": 6.966710140600432e-06}, "env_runners": {"episode_return_min": -13.5, "module_to_env_connector": {"connector_pipeline_timer": 0.00017100742100846045, "timers": {"connectors": {"normalize_and_clip_actions": 1.4150670797256156e-05, "un_batch_to_individual_items": 8.163889304360901e-06, "remove_single_ts_time_rank_from_batch": 9.170276628231973e-07, "tensor_to_numpy": 2.1359069751090212e-05, "listify_data_for_vector_env": 1.7285127792692618e-05, "get_actions": 7.124068482666868e-05}}}, "env_step_timer": 2.2780516727717027e-05, "rlmodule_inference_timer": 4.77967713804284e-05, "env_reset_timer": 7.007476138657268e-05, "agent_episode_returns_mean": {"default_agent": 1.8600000000000003}, "num_env_steps_sampled_lifetime": -6165000.0, "weights_seq_no": 11.0, "env_to_module_sum_episodes_length_out": 10.36823839457432, "episode_len_max": 20, "env_to_module_connector": {"timers": {"connectors": {"batch_individual_items": 9.991083333142829e-06, "numpy_to_tensor": 1.433486288474836e-05, "add_time_dim_to_batch_and_zero_pad": 3.565052704573883e-06, "add_observations_from_episodes_to_batch": 4.568471439685027e-06, "add_states_from_episodes_to_batch": 2.272998694368509e-06}}, "connector_pipeline_timer": 6.467247634915865e-05}, "env_to_module_sum_episodes_length_in": 10.36823839457432, "sample": 0.007946156640072475, "num_agent_steps_sampled": {"default_agent": 5000.0}, "num_module_steps_sampled": {"default_policy": 5000.0}, "num_episodes_lifetime": -308250.0, "num_module_steps_sampled_lifetime": {"default_policy": -6165000.0}, "num_agent_steps_sampled_lifetime": {"default_agent": -6165000.0}, "time_between_sampling": 0.0027449489391178482, "episode_len_mean": 20.0, "episode_return_mean": 1.8600000000000003, "num_episodes": 250.0, "episode_duration_sec_mean": 0.007313767463434485, "episode_len_min": 20, "num_env_steps_sampled": 5000.0, "module_episode_returns_mean": {"default_policy": 1.8600000000000003}, "episode_return_max": 6.5, "num_env_steps_sampled_lifetime_throughput": 2528.7652321431415}, "learners": {"__all_modules__": {"learner_connector": {"timers": {"connectors": {"add_columns_from_episodes_to_train_batch": 0.03843781385723192, "add_states_from_episodes_to_batch": 4.878297545050879e-06, "add_one_ts_to_episodes_and_truncate": 0.013072022634237724, "numpy_to_tensor": 0.00019959522692879718, "batch_individual_items": 0.048329082420906076, "add_time_dim_to_batch_and_zero_pad": 1.4713726853088701e-05, "general_advantage_estimation": 0.01311710795304879, "add_observations_from_episodes_to_batch": 0.0009091540472424036}}, "connector_pipeline_timer": 0.11446077840318081}, "num_module_steps_trained": 6000, "num_non_trainable_parameters": 0, "num_module_steps_trained_lifetime": 72000, "learner_connector_sum_episodes_length_in": 5000.0, "learner_connector_sum_episodes_length_out": 5250.0, "num_env_steps_trained": 31500, "num_trainable_parameters": 6003, "num_env_steps_trained_lifetime": 378000, "num_env_steps_trained_lifetime_throughput": 1010830.7080564183, "num_module_steps_trained_throughput": 194894.7753864854, "num_module_steps_trained_lifetime_throughput": 194703.68405074158}, "default_policy": {"num_module_steps_trained": 6000, "curr_entropy_coeff": 0.0090570820258, "num_module_steps_trained_lifetime": 72000, "gradients_default_optimizer_global_norm": 0.22185371816158295, "entropy": 0.548987865447998, "total_loss": 0.0880821943283081, "weights_seq_no": 12.0, "default_optimizer_learning_rate": 0.0002847858517, "curr_kl_coeff": 0.00018225007806904614, "policy_loss": 0.026909515261650085, "vf_loss_unclipped": 26.199382781982422, "vf_explained_var": -0.010240793228149414, "mean_kl_loss": 0.0027911753859370947, "num_trainable_parameters": 6003, "module_train_batch_size_mean": 1000.0, "diff_num_grad_updates_vs_sampler_policy": 1.0, "vf_loss": 0.09889824688434601, "num_module_steps_trained_lifetime_throughput": 195170.03350156243}}, "num_training_step_calls_per_iteration": 1, "evaluation": {"env_runners": {"num_module_steps_sampled_lifetime": {"default_policy": 4800}, "env_step_timer": 1.805085348413637e-05, "episode_duration_sec_mean": 0.007341202122624964, "num_module_steps_sampled": {"default_policy": 400}, "num_agent_steps_sampled_lifetime": {"default_agent": 4800}, "rlmodule_inference_timer": 3.3059337423155155e-05, "weights_seq_no": 12.0, "env_to_module_sum_episodes_length_out": 10.368238394574323, "sample": 0.18177229740722808, "episode_len_mean": 20.0, "agent_episode_returns_mean": {"default_agent": 4.4}, "env_to_module_connector": {"connector_pipeline_timer": 5.123446042657552e-05, "timers": {"connectors": {"add_observations_from_episodes_to_batch": 3.3680067054729335e-06, "add_states_from_episodes_to_batch": 1.805723478515905e-06, "numpy_to_tensor": 1.055431369673433e-05, "batch_individual_items": 7.811277047240953e-06, "add_time_dim_to_batch_and_zero_pad": 2.7421172283380485e-06}}}, "episode_return_max": 13.5, "module_to_env_connector": {"timers": {"connectors": {"tensor_to_numpy": 1.550923909044172e-05, "listify_data_for_vector_env": 1.2635971045212775e-05, "normalize_and_clip_actions": 1.0848344008875092e-05, "un_batch_to_individual_items": 6.115289478370267e-06, "remove_single_ts_time_rank_from_batch": 7.05288143067529e-07, "get_actions": 4.618115503282417e-05}}, "connector_pipeline_timer": 0.00012186259869689223}, "env_to_module_sum_episodes_length_in": 10.368238394574323, "num_episodes_lifetime": 240, "module_episode_returns_mean": {"default_policy": 4.4}, "num_episodes": 20, "episode_len_min": 20, "num_agent_steps_sampled": {"default_agent": 400}, "episode_return_min": -12.5, "env_reset_timer": 0.0004796225126568144, "num_env_steps_sampled_lifetime": 60400, "episode_len_max": 20, "episode_return_mean": 4.4, "num_env_steps_sampled": 400, "time_between_sampling": 2.756961845901081}, "num_healthy_workers": 1, "actor_manager_num_outstanding_async_reqs": 0, "num_remote_worker_restarts": 0}, "num_env_steps_sampled_lifetime": -6165000.0, "fault_tolerance": {"num_healthy_workers": 0, "num_remote_worker_restarts": 0}, "env_runner_group": {"actor_manager_num_outstanding_async_reqs": 0}, "done": false, "training_iteration": 12, "trial_id": "469e6_00000", "date": "2025-08-11_19-33-36", "timestamp": 1754933616, "time_this_iter_s": 2.6040151119232178, "time_total_s": 36.33238649368286, "pid": 25834, "hostname": "Mac", "node_ip": "127.0.0.1", "config": {"exploration_config": {}, "extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "placement_strategy": "PACK", "num_gpus": 0, "_fake_gpus": false, "num_cpus_for_main_process": 2, "eager_tracing": true, "eager_max_retraces": 20, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "torch_compile_learner": false, "torch_compile_learner_what_to_compile": "forward_train", "torch_compile_learner_dynamo_backend": "aot_eager", "torch_compile_learner_dynamo_mode": null, "torch_compile_worker": false, "torch_compile_worker_dynamo_backend": "aot_eager", "torch_compile_worker_dynamo_mode": null, "torch_ddp_kwargs": {}, "torch_skip_nan_gradients": false, "env": "Umbrella", "env_config": {}, "observation_space": null, "action_space": null, "clip_rewards": null, "normalize_actions": true, "clip_actions": false, "_is_atari": null, "disable_env_checking": false, "render_env": false, "action_mask_key": "action_mask", "env_runner_cls": null, "num_env_runners": 0, "create_local_env_runner": true, "num_envs_per_env_runner": 1, "gym_env_vectorize_mode": "SYNC", "num_cpus_per_env_runner": 1, "num_gpus_per_env_runner": 0, "custom_resources_per_env_runner": {}, "validate_env_runners_after_construction": true, "episodes_to_numpy": true, "max_requests_in_flight_per_env_runner": 1, "sample_timeout_s": 60.0, "_env_to_module_connector": null, "add_default_connectors_to_env_to_module_pipeline": true, "_module_to_env_connector": null, "add_default_connectors_to_module_to_env_pipeline": true, "merge_env_runner_states": "training_only", "broadcast_env_runner_states": true, "episode_lookback_horizon": 1, "rollout_fragment_length": "auto", "batch_mode": "complete_episodes", "compress_observations": false, "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "enable_tf1_exec_eagerly": false, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "preprocessor_pref": "deepmind", "observation_filter": "NoFilter", "update_worker_filter_stats": true, "use_worker_filter_stats": true, "sampler_perf_stats_ema_coef": null, "_is_online": true, "num_learners": 0, "num_gpus_per_learner": 0, "num_cpus_per_learner": "auto", "num_aggregator_actors_per_learner": 0, "max_requests_in_flight_per_aggregator_actor": 3, "local_gpu_idx": 0, "max_requests_in_flight_per_learner": 3, "gamma": 1, "lr": 0.0002847858517, "grad_clip": 0.5, "grad_clip_by": "global_norm", "_train_batch_size_per_learner": 5000, "train_batch_size": 4000, "num_epochs": 1, "minibatch_size": 1000, "shuffle_batch_per_epoch": true, "model": {"fcnet_hiddens": [256, 256], "fcnet_activation": "tanh", "fcnet_weights_initializer": null, "fcnet_weights_initializer_config": null, "fcnet_bias_initializer": null, "fcnet_bias_initializer_config": null, "conv_filters": null, "conv_activation": "relu", "conv_kernel_initializer": null, "conv_kernel_initializer_config": null, "conv_bias_initializer": null, "conv_bias_initializer_config": null, "conv_transpose_kernel_initializer": null, "conv_transpose_kernel_initializer_config": null, "conv_transpose_bias_initializer": null, "conv_transpose_bias_initializer_config": null, "post_fcnet_hiddens": [], "post_fcnet_activation": "relu", "post_fcnet_weights_initializer": null, "post_fcnet_weights_initializer_config": null, "post_fcnet_bias_initializer": null, "post_fcnet_bias_initializer_config": null, "free_log_std": false, "log_std_clip_param": 20.0, "no_final_linear": false, "vf_share_layers": false, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "lstm_weights_initializer": null, "lstm_weights_initializer_config": null, "lstm_bias_initializer": null, "lstm_bias_initializer_config": null, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "attention_use_n_prev_actions": 0, "attention_use_n_prev_rewards": 0, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": null, "custom_model_config": {}, "custom_action_dist": null, "custom_preprocessor": null, "encoder_latent_dim": null, "always_check_shapes": false, "lstm_use_prev_action_reward": -1, "_use_default_native_models": -1, "_disable_preprocessor_api": false, "_disable_action_flattening": false}, "_learner_connector": null, "add_default_connectors_to_learner_pipeline": true, "learner_config_dict": {}, "optimizer": {}, "_learner_class": null, "callbacks_on_algorithm_init": null, "callbacks_on_env_runners_recreated": null, "callbacks_on_offline_eval_runners_recreated": null, "callbacks_on_checkpoint_loaded": null, "callbacks_on_environment_created": null, "callbacks_on_episode_created": null, "callbacks_on_episode_start": null, "callbacks_on_episode_step": null, "callbacks_on_episode_end": null, "callbacks_on_evaluate_start": null, "callbacks_on_evaluate_end": null, "callbacks_on_evaluate_offline_start": null, "callbacks_on_evaluate_offline_end": null, "callbacks_on_sample_end": null, "callbacks_on_train_result": null, "explore": true, "enable_rl_module_and_learner": true, "enable_env_runner_and_connector_v2": true, "_prior_exploration_config": {"type": "StochasticSampling"}, "count_steps_by": "env_steps", "policy_map_capacity": 100, "policy_mapping_fn": "<function AlgorithmConfig.DEFAULT_POLICY_MAPPING_FN at 0x14f2edb20>", "policies_to_train": null, "policy_states_are_swappable": false, "observation_fn": null, "offline_data_class": null, "input_read_method": "read_parquet", "input_read_method_kwargs": {}, "input_read_schema": {}, "input_read_episodes": false, "input_read_sample_batches": false, "input_read_batch_size": null, "input_filesystem": null, "input_filesystem_kwargs": {}, "input_compress_columns": ["obs", "new_obs"], "input_spaces_jsonable": true, "materialize_data": false, "materialize_mapped_data": true, "map_batches_kwargs": {}, "iter_batches_kwargs": {}, "ignore_final_observation": false, "prelearner_class": null, "prelearner_buffer_class": null, "prelearner_buffer_kwargs": {}, "prelearner_module_synch_period": 10, "dataset_num_iters_per_learner": null, "input_config": {}, "actions_in_input_normalized": false, "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_config": {}, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "output_max_rows_per_file": null, "output_write_remaining_data": false, "output_write_method": "write_parquet", "output_write_method_kwargs": {}, "output_filesystem": null, "output_filesystem_kwargs": {}, "output_write_episodes": true, "offline_sampling": false, "evaluation_interval": 1, "evaluation_duration": 20, "evaluation_duration_unit": "episodes", "evaluation_sample_timeout_s": 120.0, "evaluation_auto_duration_min_env_steps_per_sample": 100, "evaluation_auto_duration_max_env_steps_per_sample": 2000, "evaluation_parallel_to_training": false, "evaluation_force_reset_envs_before_iteration": true, "evaluation_config": null, "off_policy_estimation_methods": {}, "ope_split_batch_by_episode": true, "evaluation_num_env_runners": 1, "in_evaluation": false, "sync_filters_on_rollout_workers_timeout_s": 10.0, "offline_evaluation_interval": null, "num_offline_eval_runners": 0, "offline_loss_for_module_fn": null, "offline_evaluation_duration": 1, "offline_evaluation_parallel_to_training": false, "offline_evaluation_timeout_s": 120.0, "num_cpus_per_offline_eval_runner": 1, "num_gpus_per_offline_eval_runner": 0, "custom_resources_per_offline_eval_runner": {}, "restart_failed_offline_eval_runners": true, "ignore_offline_eval_runner_failures": false, "max_num_offline_eval_runner_restarts": 1000, "offline_eval_runner_restore_timeout_s": 1800.0, "max_requests_in_flight_per_offline_eval_runner": 1, "validate_offline_eval_runners_after_construction": true, "offline_eval_runner_health_probe_timeout_s": 30.0, "offline_eval_rl_module_inference_only": false, "broadcast_offline_eval_runner_states": false, "offline_eval_batch_size_per_runner": 256, "dataset_num_iters_per_eval_runner": 1, "keep_per_episode_custom_metrics": false, "metrics_episode_collection_timeout_s": 60.0, "metrics_num_episodes_for_smoothing": 100, "min_time_s_per_iteration": null, "min_train_timesteps_per_iteration": 0, "min_sample_timesteps_per_iteration": 0, "log_gradients": true, "export_native_model_files": false, "checkpoint_trainable_policies_only": false, "logger_creator": null, "logger_config": null, "log_level": "WARN", "log_sys_usage": true, "fake_sampler": false, "seed": 3, "restart_failed_env_runners": true, "ignore_env_runner_failures": false, "max_num_env_runner_restarts": 1000, "delay_between_env_runner_restarts_s": 60.0, "restart_failed_sub_environments": false, "num_consecutive_env_runner_failures_tolerance": 100, "env_runner_health_probe_timeout_s": 30.0, "env_runner_restore_timeout_s": 1800.0, "_model_config": {}, "_rl_module_spec": "RLModuleSpec(module_class=None, observation_space=None, action_space=None, inference_only=False, learner_only=False, model_config=DefaultModelConfig(fcnet_hiddens=[60, 90], fcnet_activation='tanh', fcnet_kernel_initializer=None, fcnet_kernel_initializer_kwargs=None, fcnet_bias_initializer=None, fcnet_bias_initializer_kwargs=None, conv_filters=None, conv_activation='relu', conv_kernel_initializer=None, conv_kernel_initializer_kwargs=None, conv_bias_initializer=None, conv_bias_initializer_kwargs=None, head_fcnet_hiddens=[], head_fcnet_activation='relu', head_fcnet_kernel_initializer=None, head_fcnet_kernel_initializer_kwargs=None, head_fcnet_bias_initializer=None, head_fcnet_bias_initializer_kwargs=None, free_log_std=False, log_std_clip_param=20.0, vf_share_layers=True, use_lstm=False, max_seq_len=20, lstm_cell_size=256, lstm_use_prev_action=False, lstm_use_prev_reward=False, lstm_kernel_initializer=None, lstm_kernel_initializer_kwargs=None, lstm_bias_initializer=None, lstm_bias_initializer_kwargs=None), catalog_class=None, load_state_path=None, model_config_dict=None)", "algorithm_config_overrides_per_module": {}, "_per_module_overrides": {}, "_validate_config": true, "_use_msgpack_checkpoints": false, "_torch_grad_scaler_class": null, "_torch_lr_scheduler_classes": null, "_tf_policy_handles_more_than_one_loss": false, "_disable_preprocessor_api": false, "_disable_action_flattening": false, "_disable_initialize_loss_from_dummy_batch": false, "_dont_auto_sync_env_runner_states": false, "env_task_fn": -1, "enable_connectors": -1, "simple_optimizer": false, "policy_map_cache": -1, "worker_cls": -1, "synchronize_filters": -1, "enable_async_evaluation": -1, "custom_async_evaluation_function": -1, "_enable_rl_module_api": -1, "auto_wrap_old_gym_envs": -1, "always_attach_evaluation_results": -1, "replay_sequence_length": null, "_disable_execution_plan_api": -1, "use_critic": true, "use_gae": true, "use_kl_loss": true, "kl_coeff": 0.7464963036515, "kl_target": 0.0270990929592, "vf_loss_coeff": 0.6688075857018, "entropy_coeff": 0.0090570820258, "clip_param": 0.1221781641624, "vf_clip_param": 0.1027808522125, "entropy_coeff_schedule": null, "lr_schedule": null, "sgd_minibatch_size": -1, "vf_share_layers": -1, "__stdout_file__": null, "__stderr_file__": null, "lambda": 0.9099046732075, "input": "sampler", "policies": {"default_policy": [null, null, null, null]}, "callbacks": "<class 'ray.rllib.callbacks.callbacks.RLlibCallback'>", "create_env_on_driver": false, "custom_eval_function": null, "framework": "torch"}, "time_since_restore": 36.33238649368286, "iterations_since_restore": 12, "perf": {"cpu_util_percent": 70.03333333333333, "ram_util_percent": 78.89999999999999}}
{"timers": {"training_iteration": 3.382584982782491, "restore_env_runners": 4.986607752307042e-05, "training_step": 3.382143008712639, "env_runner_sampling_timer": 3.2027403291648406, "learner_update_timer": 0.17434854718904036, "synch_weights": 0.0012922220606975845, "restore_eval_env_runners": 1.0994188203168314e-05, "evaluation_iteration": 0.19244341462247608, "synch_eval_env_connectors": 0.00019972458513170971, "synch_env_connectors": 6.937462438932739e-06}, "env_runners": {"episode_return_min": -13.5, "module_to_env_connector": {"connector_pipeline_timer": 0.00017418920859559083, "timers": {"connectors": {"normalize_and_clip_actions": 1.4097129699603699e-05, "un_batch_to_individual_items": 8.140538783756354e-06, "remove_single_ts_time_rank_from_batch": 9.718744073396413e-07, "tensor_to_numpy": 2.175322478780153e-05, "listify_data_for_vector_env": 1.7625760887768205e-05, "get_actions": 7.28457595078132e-05}}}, "env_step_timer": 2.3423447247279717e-05, "rlmodule_inference_timer": 4.9104473019296735e-05, "env_reset_timer": 7.4144815838664e-05, "agent_episode_returns_mean": {"default_agent": 2.899999999999998}, "num_env_steps_sampled_lifetime": -6782500.0, "weights_seq_no": 12.0, "env_to_module_sum_episodes_length_out": 10.36823839457432, "episode_len_max": 20, "env_to_module_connector": {"timers": {"connectors": {"batch_individual_items": 1.0171083474740429e-05, "numpy_to_tensor": 1.5287819635977485e-05, "add_time_dim_to_batch_and_zero_pad": 3.5688337372384833e-06, "add_observations_from_episodes_to_batch": 4.4766027233023885e-06, "add_states_from_episodes_to_batch": 2.3855509437320932e-06}}, "connector_pipeline_timer": 6.627073601345946e-05}, "env_to_module_sum_episodes_length_in": 10.36823839457432, "sample": 0.008008955505008079, "num_agent_steps_sampled": {"default_agent": 5000.0}, "num_module_steps_sampled": {"default_policy": 5000.0}, "num_episodes_lifetime": -339125.0, "num_module_steps_sampled_lifetime": {"default_policy": -6782500.0}, "num_agent_steps_sampled_lifetime": {"default_agent": -6782500.0}, "time_between_sampling": 0.002460246125552755, "episode_len_mean": 20.0, "episode_return_mean": 2.899999999999998, "num_episodes": 250.0, "episode_duration_sec_mean": 0.007526974198408424, "episode_len_min": 20, "num_env_steps_sampled": 5000.0, "module_episode_returns_mean": {"default_policy": 2.899999999999998}, "episode_return_max": 6.5, "num_env_steps_sampled_lifetime_throughput": 2484.5032507796536}, "learners": {"__all_modules__": {"learner_connector": {"timers": {"connectors": {"add_columns_from_episodes_to_train_batch": 0.0384435582177437, "add_states_from_episodes_to_batch": 4.8603448392797974e-06, "add_one_ts_to_episodes_and_truncate": 0.013036722828298007, "numpy_to_tensor": 0.0001988084445185758, "batch_individual_items": 0.048195704516033944, "add_time_dim_to_batch_and_zero_pad": 1.4677839558555288e-05, "general_advantage_estimation": 0.013045835203882679, "add_observations_from_episodes_to_batch": 0.0009137658369571066}}, "connector_pipeline_timer": 0.11422799644810172}, "num_module_steps_trained": 6000, "num_non_trainable_parameters": 0, "num_module_steps_trained_lifetime": 78000, "learner_connector_sum_episodes_length_in": 5000.0, "learner_connector_sum_episodes_length_out": 5250.0, "num_env_steps_trained": 31500, "num_trainable_parameters": 6003, "num_env_steps_trained_lifetime": 409500, "num_env_steps_trained_lifetime_throughput": 1032785.8897106613, "num_module_steps_trained_throughput": 198963.83587313167, "num_module_steps_trained_lifetime_throughput": 198773.6353671295}, "default_policy": {"num_module_steps_trained": 6000, "curr_entropy_coeff": 0.0090570820258, "num_module_steps_trained_lifetime": 78000, "gradients_default_optimizer_global_norm": 0.05305613577365875, "entropy": 0.527543842792511, "total_loss": 0.06440390646457672, "weights_seq_no": 13.0, "default_optimizer_learning_rate": 0.0002847858517, "curr_kl_coeff": 9.112503903452307e-05, "policy_loss": 0.0031821199227124453, "vf_loss_unclipped": 25.324901580810547, "vf_explained_var": -0.009009599685668945, "mean_kl_loss": 0.000769394391681999, "num_trainable_parameters": 6003, "module_train_batch_size_mean": 1000.0, "diff_num_grad_updates_vs_sampler_policy": 1.0, "vf_loss": 0.09868254512548447, "num_module_steps_trained_lifetime_throughput": 199210.27566761218}}, "num_training_step_calls_per_iteration": 1, "evaluation": {"env_runners": {"num_module_steps_sampled_lifetime": {"default_policy": 5200}, "env_step_timer": 3.792105786493921e-05, "episode_duration_sec_mean": 0.007304847097257153, "num_module_steps_sampled": {"default_policy": 400}, "num_agent_steps_sampled_lifetime": {"default_agent": 5200}, "rlmodule_inference_timer": 7.314698564862921e-05, "weights_seq_no": 13.0, "env_to_module_sum_episodes_length_out": 10.368238394574323, "sample": 0.18184425277309535, "episode_len_mean": 20.0, "agent_episode_returns_mean": {"default_agent": 4.2}, "env_to_module_connector": {"connector_pipeline_timer": 0.00010752218833857524, "timers": {"connectors": {"add_observations_from_episodes_to_batch": 6.448113910176337e-06, "add_states_from_episodes_to_batch": 4.281182326531696e-06, "numpy_to_tensor": 2.9465917676876126e-05, "batch_individual_items": 1.7023984242309775e-05, "add_time_dim_to_batch_and_zero_pad": 5.407953211438042e-06}}}, "episode_return_max": 13.5, "module_to_env_connector": {"timers": {"connectors": {"tensor_to_numpy": 3.4895513959380796e-05, "listify_data_for_vector_env": 2.7871333074278053e-05, "normalize_and_clip_actions": 2.2565529744224386e-05, "un_batch_to_individual_items": 1.2226266477021199e-05, "remove_single_ts_time_rank_from_batch": 2.3594666306330033e-06, "get_actions": 0.00011229921475625101}}, "connector_pipeline_timer": 0.0002705794480858739}, "env_to_module_sum_episodes_length_in": 10.368238394574323, "num_episodes_lifetime": 260, "module_episode_returns_mean": {"default_policy": 4.2}, "num_episodes": 20, "episode_len_min": 20, "num_agent_steps_sampled": {"default_agent": 400}, "episode_return_min": -12.5, "env_reset_timer": 0.0004757521176299779, "num_env_steps_sampled_lifetime": 65400, "episode_len_max": 20, "episode_return_mean": 4.2, "num_env_steps_sampled": 400, "time_between_sampling": 2.754702128692364}, "num_healthy_workers": 1, "actor_manager_num_outstanding_async_reqs": 0, "num_remote_worker_restarts": 0}, "num_env_steps_sampled_lifetime": -6782500.0, "fault_tolerance": {"num_healthy_workers": 0, "num_remote_worker_restarts": 0}, "env_runner_group": {"actor_manager_num_outstanding_async_reqs": 0}, "done": false, "training_iteration": 13, "trial_id": "469e6_00000", "date": "2025-08-11_19-33-39", "timestamp": 1754933619, "time_this_iter_s": 2.7103662490844727, "time_total_s": 39.042752742767334, "pid": 25834, "hostname": "Mac", "node_ip": "127.0.0.1", "config": {"exploration_config": {}, "extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "placement_strategy": "PACK", "num_gpus": 0, "_fake_gpus": false, "num_cpus_for_main_process": 2, "eager_tracing": true, "eager_max_retraces": 20, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "torch_compile_learner": false, "torch_compile_learner_what_to_compile": "forward_train", "torch_compile_learner_dynamo_backend": "aot_eager", "torch_compile_learner_dynamo_mode": null, "torch_compile_worker": false, "torch_compile_worker_dynamo_backend": "aot_eager", "torch_compile_worker_dynamo_mode": null, "torch_ddp_kwargs": {}, "torch_skip_nan_gradients": false, "env": "Umbrella", "env_config": {}, "observation_space": null, "action_space": null, "clip_rewards": null, "normalize_actions": true, "clip_actions": false, "_is_atari": null, "disable_env_checking": false, "render_env": false, "action_mask_key": "action_mask", "env_runner_cls": null, "num_env_runners": 0, "create_local_env_runner": true, "num_envs_per_env_runner": 1, "gym_env_vectorize_mode": "SYNC", "num_cpus_per_env_runner": 1, "num_gpus_per_env_runner": 0, "custom_resources_per_env_runner": {}, "validate_env_runners_after_construction": true, "episodes_to_numpy": true, "max_requests_in_flight_per_env_runner": 1, "sample_timeout_s": 60.0, "_env_to_module_connector": null, "add_default_connectors_to_env_to_module_pipeline": true, "_module_to_env_connector": null, "add_default_connectors_to_module_to_env_pipeline": true, "merge_env_runner_states": "training_only", "broadcast_env_runner_states": true, "episode_lookback_horizon": 1, "rollout_fragment_length": "auto", "batch_mode": "complete_episodes", "compress_observations": false, "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "enable_tf1_exec_eagerly": false, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "preprocessor_pref": "deepmind", "observation_filter": "NoFilter", "update_worker_filter_stats": true, "use_worker_filter_stats": true, "sampler_perf_stats_ema_coef": null, "_is_online": true, "num_learners": 0, "num_gpus_per_learner": 0, "num_cpus_per_learner": "auto", "num_aggregator_actors_per_learner": 0, "max_requests_in_flight_per_aggregator_actor": 3, "local_gpu_idx": 0, "max_requests_in_flight_per_learner": 3, "gamma": 1, "lr": 0.0002847858517, "grad_clip": 0.5, "grad_clip_by": "global_norm", "_train_batch_size_per_learner": 5000, "train_batch_size": 4000, "num_epochs": 1, "minibatch_size": 1000, "shuffle_batch_per_epoch": true, "model": {"fcnet_hiddens": [256, 256], "fcnet_activation": "tanh", "fcnet_weights_initializer": null, "fcnet_weights_initializer_config": null, "fcnet_bias_initializer": null, "fcnet_bias_initializer_config": null, "conv_filters": null, "conv_activation": "relu", "conv_kernel_initializer": null, "conv_kernel_initializer_config": null, "conv_bias_initializer": null, "conv_bias_initializer_config": null, "conv_transpose_kernel_initializer": null, "conv_transpose_kernel_initializer_config": null, "conv_transpose_bias_initializer": null, "conv_transpose_bias_initializer_config": null, "post_fcnet_hiddens": [], "post_fcnet_activation": "relu", "post_fcnet_weights_initializer": null, "post_fcnet_weights_initializer_config": null, "post_fcnet_bias_initializer": null, "post_fcnet_bias_initializer_config": null, "free_log_std": false, "log_std_clip_param": 20.0, "no_final_linear": false, "vf_share_layers": false, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "lstm_weights_initializer": null, "lstm_weights_initializer_config": null, "lstm_bias_initializer": null, "lstm_bias_initializer_config": null, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "attention_use_n_prev_actions": 0, "attention_use_n_prev_rewards": 0, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": null, "custom_model_config": {}, "custom_action_dist": null, "custom_preprocessor": null, "encoder_latent_dim": null, "always_check_shapes": false, "lstm_use_prev_action_reward": -1, "_use_default_native_models": -1, "_disable_preprocessor_api": false, "_disable_action_flattening": false}, "_learner_connector": null, "add_default_connectors_to_learner_pipeline": true, "learner_config_dict": {}, "optimizer": {}, "_learner_class": null, "callbacks_on_algorithm_init": null, "callbacks_on_env_runners_recreated": null, "callbacks_on_offline_eval_runners_recreated": null, "callbacks_on_checkpoint_loaded": null, "callbacks_on_environment_created": null, "callbacks_on_episode_created": null, "callbacks_on_episode_start": null, "callbacks_on_episode_step": null, "callbacks_on_episode_end": null, "callbacks_on_evaluate_start": null, "callbacks_on_evaluate_end": null, "callbacks_on_evaluate_offline_start": null, "callbacks_on_evaluate_offline_end": null, "callbacks_on_sample_end": null, "callbacks_on_train_result": null, "explore": true, "enable_rl_module_and_learner": true, "enable_env_runner_and_connector_v2": true, "_prior_exploration_config": {"type": "StochasticSampling"}, "count_steps_by": "env_steps", "policy_map_capacity": 100, "policy_mapping_fn": "<function AlgorithmConfig.DEFAULT_POLICY_MAPPING_FN at 0x14f2edb20>", "policies_to_train": null, "policy_states_are_swappable": false, "observation_fn": null, "offline_data_class": null, "input_read_method": "read_parquet", "input_read_method_kwargs": {}, "input_read_schema": {}, "input_read_episodes": false, "input_read_sample_batches": false, "input_read_batch_size": null, "input_filesystem": null, "input_filesystem_kwargs": {}, "input_compress_columns": ["obs", "new_obs"], "input_spaces_jsonable": true, "materialize_data": false, "materialize_mapped_data": true, "map_batches_kwargs": {}, "iter_batches_kwargs": {}, "ignore_final_observation": false, "prelearner_class": null, "prelearner_buffer_class": null, "prelearner_buffer_kwargs": {}, "prelearner_module_synch_period": 10, "dataset_num_iters_per_learner": null, "input_config": {}, "actions_in_input_normalized": false, "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_config": {}, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "output_max_rows_per_file": null, "output_write_remaining_data": false, "output_write_method": "write_parquet", "output_write_method_kwargs": {}, "output_filesystem": null, "output_filesystem_kwargs": {}, "output_write_episodes": true, "offline_sampling": false, "evaluation_interval": 1, "evaluation_duration": 20, "evaluation_duration_unit": "episodes", "evaluation_sample_timeout_s": 120.0, "evaluation_auto_duration_min_env_steps_per_sample": 100, "evaluation_auto_duration_max_env_steps_per_sample": 2000, "evaluation_parallel_to_training": false, "evaluation_force_reset_envs_before_iteration": true, "evaluation_config": null, "off_policy_estimation_methods": {}, "ope_split_batch_by_episode": true, "evaluation_num_env_runners": 1, "in_evaluation": false, "sync_filters_on_rollout_workers_timeout_s": 10.0, "offline_evaluation_interval": null, "num_offline_eval_runners": 0, "offline_loss_for_module_fn": null, "offline_evaluation_duration": 1, "offline_evaluation_parallel_to_training": false, "offline_evaluation_timeout_s": 120.0, "num_cpus_per_offline_eval_runner": 1, "num_gpus_per_offline_eval_runner": 0, "custom_resources_per_offline_eval_runner": {}, "restart_failed_offline_eval_runners": true, "ignore_offline_eval_runner_failures": false, "max_num_offline_eval_runner_restarts": 1000, "offline_eval_runner_restore_timeout_s": 1800.0, "max_requests_in_flight_per_offline_eval_runner": 1, "validate_offline_eval_runners_after_construction": true, "offline_eval_runner_health_probe_timeout_s": 30.0, "offline_eval_rl_module_inference_only": false, "broadcast_offline_eval_runner_states": false, "offline_eval_batch_size_per_runner": 256, "dataset_num_iters_per_eval_runner": 1, "keep_per_episode_custom_metrics": false, "metrics_episode_collection_timeout_s": 60.0, "metrics_num_episodes_for_smoothing": 100, "min_time_s_per_iteration": null, "min_train_timesteps_per_iteration": 0, "min_sample_timesteps_per_iteration": 0, "log_gradients": true, "export_native_model_files": false, "checkpoint_trainable_policies_only": false, "logger_creator": null, "logger_config": null, "log_level": "WARN", "log_sys_usage": true, "fake_sampler": false, "seed": 3, "restart_failed_env_runners": true, "ignore_env_runner_failures": false, "max_num_env_runner_restarts": 1000, "delay_between_env_runner_restarts_s": 60.0, "restart_failed_sub_environments": false, "num_consecutive_env_runner_failures_tolerance": 100, "env_runner_health_probe_timeout_s": 30.0, "env_runner_restore_timeout_s": 1800.0, "_model_config": {}, "_rl_module_spec": "RLModuleSpec(module_class=None, observation_space=None, action_space=None, inference_only=False, learner_only=False, model_config=DefaultModelConfig(fcnet_hiddens=[60, 90], fcnet_activation='tanh', fcnet_kernel_initializer=None, fcnet_kernel_initializer_kwargs=None, fcnet_bias_initializer=None, fcnet_bias_initializer_kwargs=None, conv_filters=None, conv_activation='relu', conv_kernel_initializer=None, conv_kernel_initializer_kwargs=None, conv_bias_initializer=None, conv_bias_initializer_kwargs=None, head_fcnet_hiddens=[], head_fcnet_activation='relu', head_fcnet_kernel_initializer=None, head_fcnet_kernel_initializer_kwargs=None, head_fcnet_bias_initializer=None, head_fcnet_bias_initializer_kwargs=None, free_log_std=False, log_std_clip_param=20.0, vf_share_layers=True, use_lstm=False, max_seq_len=20, lstm_cell_size=256, lstm_use_prev_action=False, lstm_use_prev_reward=False, lstm_kernel_initializer=None, lstm_kernel_initializer_kwargs=None, lstm_bias_initializer=None, lstm_bias_initializer_kwargs=None), catalog_class=None, load_state_path=None, model_config_dict=None)", "algorithm_config_overrides_per_module": {}, "_per_module_overrides": {}, "_validate_config": true, "_use_msgpack_checkpoints": false, "_torch_grad_scaler_class": null, "_torch_lr_scheduler_classes": null, "_tf_policy_handles_more_than_one_loss": false, "_disable_preprocessor_api": false, "_disable_action_flattening": false, "_disable_initialize_loss_from_dummy_batch": false, "_dont_auto_sync_env_runner_states": false, "env_task_fn": -1, "enable_connectors": -1, "simple_optimizer": false, "policy_map_cache": -1, "worker_cls": -1, "synchronize_filters": -1, "enable_async_evaluation": -1, "custom_async_evaluation_function": -1, "_enable_rl_module_api": -1, "auto_wrap_old_gym_envs": -1, "always_attach_evaluation_results": -1, "replay_sequence_length": null, "_disable_execution_plan_api": -1, "use_critic": true, "use_gae": true, "use_kl_loss": true, "kl_coeff": 0.7464963036515, "kl_target": 0.0270990929592, "vf_loss_coeff": 0.6688075857018, "entropy_coeff": 0.0090570820258, "clip_param": 0.1221781641624, "vf_clip_param": 0.1027808522125, "entropy_coeff_schedule": null, "lr_schedule": null, "sgd_minibatch_size": -1, "vf_share_layers": -1, "__stdout_file__": null, "__stderr_file__": null, "lambda": 0.9099046732075, "input": "sampler", "policies": {"default_policy": [null, null, null, null]}, "callbacks": "<class 'ray.rllib.callbacks.callbacks.RLlibCallback'>", "create_env_on_driver": false, "custom_eval_function": null, "framework": "torch"}, "time_since_restore": 39.042752742767334, "iterations_since_restore": 13, "perf": {"cpu_util_percent": 70.525, "ram_util_percent": 79.025}}
{"timers": {"training_iteration": 3.373207173785569, "restore_env_runners": 4.943324611987319e-05, "training_step": 3.372767255715483, "env_runner_sampling_timer": 3.192818509202877, "learner_update_timer": 0.1749083817177966, "synch_weights": 0.0012893794197512776, "restore_eval_env_runners": 1.0951746253038325e-05, "evaluation_iteration": 0.19249925339542373, "synch_eval_env_connectors": 0.0002006615094687749, "synch_env_connectors": 6.964337674323484e-06}, "env_runners": {"episode_return_min": -13.5, "module_to_env_connector": {"connector_pipeline_timer": 0.000171927872781105, "timers": {"connectors": {"normalize_and_clip_actions": 1.437339600747322e-05, "un_batch_to_individual_items": 8.223892611051763e-06, "remove_single_ts_time_rank_from_batch": 9.04138845423812e-07, "tensor_to_numpy": 2.144509798511722e-05, "listify_data_for_vector_env": 1.7440672487979242e-05, "get_actions": 7.174259370102356e-05}}}, "env_step_timer": 2.243777182031384e-05, "rlmodule_inference_timer": 4.7889447304186375e-05, "env_reset_timer": 7.009049961741099e-05, "agent_episode_returns_mean": {"default_agent": 3.9399999999999995}, "num_env_steps_sampled_lifetime": -7400000.0, "weights_seq_no": 13.0, "env_to_module_sum_episodes_length_out": 10.36823839457432, "episode_len_max": 20, "env_to_module_connector": {"timers": {"connectors": {"batch_individual_items": 1.0281043869195737e-05, "numpy_to_tensor": 1.4670887465691962e-05, "add_time_dim_to_batch_and_zero_pad": 3.7271445773820907e-06, "add_observations_from_episodes_to_batch": 4.547927990229484e-06, "add_states_from_episodes_to_batch": 2.5125207159469226e-06}}, "connector_pipeline_timer": 6.63748123788917e-05}, "env_to_module_sum_episodes_length_in": 10.36823839457432, "sample": 0.007910179387468458, "num_agent_steps_sampled": {"default_agent": 5000.0}, "num_module_steps_sampled": {"default_policy": 5000.0}, "num_episodes_lifetime": -370000.0, "num_module_steps_sampled_lifetime": {"default_policy": -7400000.0}, "num_agent_steps_sampled_lifetime": {"default_agent": -7400000.0}, "time_between_sampling": 0.0025576126808643197, "episode_len_mean": 20.0, "episode_return_mean": 3.9399999999999995, "num_episodes": 250.0, "episode_duration_sec_mean": 0.007349900344386694, "episode_len_min": 20, "num_env_steps_sampled": 5000.0, "module_episode_returns_mean": {"default_policy": 3.9399999999999995}, "episode_return_max": 6.5, "num_env_steps_sampled_lifetime_throughput": 2528.9257079714844}, "learners": {"__all_modules__": {"learner_connector": {"timers": {"connectors": {"add_columns_from_episodes_to_train_batch": 0.038510571385084284, "add_states_from_episodes_to_batch": 4.842161878633596e-06, "add_one_ts_to_episodes_and_truncate": 0.013016108510226708, "numpy_to_tensor": 0.00019760410992944485, "batch_individual_items": 0.049127465381055335, "add_time_dim_to_batch_and_zero_pad": 1.4635651016405489e-05, "general_advantage_estimation": 0.012983096851777468, "add_observations_from_episodes_to_batch": 0.0009152060984805022}}, "connector_pipeline_timer": 0.11514123982327967}, "num_module_steps_trained": 6000, "num_non_trainable_parameters": 0, "num_module_steps_trained_lifetime": 84000, "learner_connector_sum_episodes_length_in": 5000.0, "learner_connector_sum_episodes_length_out": 5250.0, "num_env_steps_trained": 31500, "num_trainable_parameters": 6003, "num_env_steps_trained_lifetime": 441000, "num_env_steps_trained_lifetime_throughput": 1051617.7273506876, "num_module_steps_trained_throughput": 202443.19492544763, "num_module_steps_trained_lifetime_throughput": 202255.57618972266}, "default_policy": {"num_module_steps_trained": 6000, "curr_entropy_coeff": 0.0090570820258, "num_module_steps_trained_lifetime": 84000, "gradients_default_optimizer_global_norm": 0.06801996380090714, "entropy": 0.5081238746643066, "total_loss": 0.032381489872932434, "weights_seq_no": 14.0, "default_optimizer_learning_rate": 0.0002847858517, "curr_kl_coeff": 4.5562519517261535e-05, "policy_loss": -0.02879970334470272, "vf_loss_unclipped": 24.430038452148438, "vf_explained_var": -0.007025957107543945, "mean_kl_loss": 0.0006089486996643245, "num_trainable_parameters": 6003, "module_train_batch_size_mean": 1000.0, "diff_num_grad_updates_vs_sampler_policy": 1.0, "vf_loss": 0.09835900366306305, "num_module_steps_trained_lifetime_throughput": 202662.21507598678}}, "num_training_step_calls_per_iteration": 1, "evaluation": {"env_runners": {"num_module_steps_sampled_lifetime": {"default_policy": 5600}, "env_step_timer": 2.452296889363616e-05, "episode_duration_sec_mean": 0.00793052586959675, "num_module_steps_sampled": {"default_policy": 400}, "num_agent_steps_sampled_lifetime": {"default_agent": 5600}, "rlmodule_inference_timer": 4.810338817099867e-05, "weights_seq_no": 14.0, "env_to_module_sum_episodes_length_out": 10.368238394574323, "sample": 0.18199382149608384, "episode_len_mean": 20.0, "agent_episode_returns_mean": {"default_agent": 4.6}, "env_to_module_connector": {"connector_pipeline_timer": 6.984549933944267e-05, "timers": {"connectors": {"add_observations_from_episodes_to_batch": 4.146747426528814e-06, "add_states_from_episodes_to_batch": 2.171260124641447e-06, "numpy_to_tensor": 1.673200224904163e-05, "batch_individual_items": 1.0783095918034288e-05, "add_time_dim_to_batch_and_zero_pad": 4.114322540291434e-06}}}, "episode_return_max": 13.5, "module_to_env_connector": {"timers": {"connectors": {"tensor_to_numpy": 2.1418998335919275e-05, "listify_data_for_vector_env": 1.9338992753593257e-05, "normalize_and_clip_actions": 1.4863916530307544e-05, "un_batch_to_individual_items": 7.896086698816917e-06, "remove_single_ts_time_rank_from_batch": 9.415841413836846e-07, "get_actions": 6.84909962277769e-05}}, "connector_pipeline_timer": 0.00017384849936143097}, "env_to_module_sum_episodes_length_in": 10.368238394574323, "num_episodes_lifetime": 280, "module_episode_returns_mean": {"default_policy": 4.6}, "num_episodes": 20, "episode_len_min": 20, "num_agent_steps_sampled": {"default_agent": 400}, "episode_return_min": -12.5, "env_reset_timer": 0.0004717541761606152, "num_env_steps_sampled_lifetime": 70400, "episode_len_max": 20, "episode_return_mean": 4.6, "num_env_steps_sampled": 400, "time_between_sampling": 2.7518733015751313}, "num_healthy_workers": 1, "actor_manager_num_outstanding_async_reqs": 0, "num_remote_worker_restarts": 0}, "num_env_steps_sampled_lifetime": -7400000.0, "fault_tolerance": {"num_healthy_workers": 0, "num_remote_worker_restarts": 0}, "env_runner_group": {"actor_manager_num_outstanding_async_reqs": 0}, "done": false, "training_iteration": 14, "trial_id": "469e6_00000", "date": "2025-08-11_19-33-42", "timestamp": 1754933622, "time_this_iter_s": 2.6514499187469482, "time_total_s": 41.69420266151428, "pid": 25834, "hostname": "Mac", "node_ip": "127.0.0.1", "config": {"exploration_config": {}, "extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "placement_strategy": "PACK", "num_gpus": 0, "_fake_gpus": false, "num_cpus_for_main_process": 2, "eager_tracing": true, "eager_max_retraces": 20, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "torch_compile_learner": false, "torch_compile_learner_what_to_compile": "forward_train", "torch_compile_learner_dynamo_backend": "aot_eager", "torch_compile_learner_dynamo_mode": null, "torch_compile_worker": false, "torch_compile_worker_dynamo_backend": "aot_eager", "torch_compile_worker_dynamo_mode": null, "torch_ddp_kwargs": {}, "torch_skip_nan_gradients": false, "env": "Umbrella", "env_config": {}, "observation_space": null, "action_space": null, "clip_rewards": null, "normalize_actions": true, "clip_actions": false, "_is_atari": null, "disable_env_checking": false, "render_env": false, "action_mask_key": "action_mask", "env_runner_cls": null, "num_env_runners": 0, "create_local_env_runner": true, "num_envs_per_env_runner": 1, "gym_env_vectorize_mode": "SYNC", "num_cpus_per_env_runner": 1, "num_gpus_per_env_runner": 0, "custom_resources_per_env_runner": {}, "validate_env_runners_after_construction": true, "episodes_to_numpy": true, "max_requests_in_flight_per_env_runner": 1, "sample_timeout_s": 60.0, "_env_to_module_connector": null, "add_default_connectors_to_env_to_module_pipeline": true, "_module_to_env_connector": null, "add_default_connectors_to_module_to_env_pipeline": true, "merge_env_runner_states": "training_only", "broadcast_env_runner_states": true, "episode_lookback_horizon": 1, "rollout_fragment_length": "auto", "batch_mode": "complete_episodes", "compress_observations": false, "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "enable_tf1_exec_eagerly": false, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "preprocessor_pref": "deepmind", "observation_filter": "NoFilter", "update_worker_filter_stats": true, "use_worker_filter_stats": true, "sampler_perf_stats_ema_coef": null, "_is_online": true, "num_learners": 0, "num_gpus_per_learner": 0, "num_cpus_per_learner": "auto", "num_aggregator_actors_per_learner": 0, "max_requests_in_flight_per_aggregator_actor": 3, "local_gpu_idx": 0, "max_requests_in_flight_per_learner": 3, "gamma": 1, "lr": 0.0002847858517, "grad_clip": 0.5, "grad_clip_by": "global_norm", "_train_batch_size_per_learner": 5000, "train_batch_size": 4000, "num_epochs": 1, "minibatch_size": 1000, "shuffle_batch_per_epoch": true, "model": {"fcnet_hiddens": [256, 256], "fcnet_activation": "tanh", "fcnet_weights_initializer": null, "fcnet_weights_initializer_config": null, "fcnet_bias_initializer": null, "fcnet_bias_initializer_config": null, "conv_filters": null, "conv_activation": "relu", "conv_kernel_initializer": null, "conv_kernel_initializer_config": null, "conv_bias_initializer": null, "conv_bias_initializer_config": null, "conv_transpose_kernel_initializer": null, "conv_transpose_kernel_initializer_config": null, "conv_transpose_bias_initializer": null, "conv_transpose_bias_initializer_config": null, "post_fcnet_hiddens": [], "post_fcnet_activation": "relu", "post_fcnet_weights_initializer": null, "post_fcnet_weights_initializer_config": null, "post_fcnet_bias_initializer": null, "post_fcnet_bias_initializer_config": null, "free_log_std": false, "log_std_clip_param": 20.0, "no_final_linear": false, "vf_share_layers": false, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "lstm_weights_initializer": null, "lstm_weights_initializer_config": null, "lstm_bias_initializer": null, "lstm_bias_initializer_config": null, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "attention_use_n_prev_actions": 0, "attention_use_n_prev_rewards": 0, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": null, "custom_model_config": {}, "custom_action_dist": null, "custom_preprocessor": null, "encoder_latent_dim": null, "always_check_shapes": false, "lstm_use_prev_action_reward": -1, "_use_default_native_models": -1, "_disable_preprocessor_api": false, "_disable_action_flattening": false}, "_learner_connector": null, "add_default_connectors_to_learner_pipeline": true, "learner_config_dict": {}, "optimizer": {}, "_learner_class": null, "callbacks_on_algorithm_init": null, "callbacks_on_env_runners_recreated": null, "callbacks_on_offline_eval_runners_recreated": null, "callbacks_on_checkpoint_loaded": null, "callbacks_on_environment_created": null, "callbacks_on_episode_created": null, "callbacks_on_episode_start": null, "callbacks_on_episode_step": null, "callbacks_on_episode_end": null, "callbacks_on_evaluate_start": null, "callbacks_on_evaluate_end": null, "callbacks_on_evaluate_offline_start": null, "callbacks_on_evaluate_offline_end": null, "callbacks_on_sample_end": null, "callbacks_on_train_result": null, "explore": true, "enable_rl_module_and_learner": true, "enable_env_runner_and_connector_v2": true, "_prior_exploration_config": {"type": "StochasticSampling"}, "count_steps_by": "env_steps", "policy_map_capacity": 100, "policy_mapping_fn": "<function AlgorithmConfig.DEFAULT_POLICY_MAPPING_FN at 0x14f2edb20>", "policies_to_train": null, "policy_states_are_swappable": false, "observation_fn": null, "offline_data_class": null, "input_read_method": "read_parquet", "input_read_method_kwargs": {}, "input_read_schema": {}, "input_read_episodes": false, "input_read_sample_batches": false, "input_read_batch_size": null, "input_filesystem": null, "input_filesystem_kwargs": {}, "input_compress_columns": ["obs", "new_obs"], "input_spaces_jsonable": true, "materialize_data": false, "materialize_mapped_data": true, "map_batches_kwargs": {}, "iter_batches_kwargs": {}, "ignore_final_observation": false, "prelearner_class": null, "prelearner_buffer_class": null, "prelearner_buffer_kwargs": {}, "prelearner_module_synch_period": 10, "dataset_num_iters_per_learner": null, "input_config": {}, "actions_in_input_normalized": false, "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_config": {}, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "output_max_rows_per_file": null, "output_write_remaining_data": false, "output_write_method": "write_parquet", "output_write_method_kwargs": {}, "output_filesystem": null, "output_filesystem_kwargs": {}, "output_write_episodes": true, "offline_sampling": false, "evaluation_interval": 1, "evaluation_duration": 20, "evaluation_duration_unit": "episodes", "evaluation_sample_timeout_s": 120.0, "evaluation_auto_duration_min_env_steps_per_sample": 100, "evaluation_auto_duration_max_env_steps_per_sample": 2000, "evaluation_parallel_to_training": false, "evaluation_force_reset_envs_before_iteration": true, "evaluation_config": null, "off_policy_estimation_methods": {}, "ope_split_batch_by_episode": true, "evaluation_num_env_runners": 1, "in_evaluation": false, "sync_filters_on_rollout_workers_timeout_s": 10.0, "offline_evaluation_interval": null, "num_offline_eval_runners": 0, "offline_loss_for_module_fn": null, "offline_evaluation_duration": 1, "offline_evaluation_parallel_to_training": false, "offline_evaluation_timeout_s": 120.0, "num_cpus_per_offline_eval_runner": 1, "num_gpus_per_offline_eval_runner": 0, "custom_resources_per_offline_eval_runner": {}, "restart_failed_offline_eval_runners": true, "ignore_offline_eval_runner_failures": false, "max_num_offline_eval_runner_restarts": 1000, "offline_eval_runner_restore_timeout_s": 1800.0, "max_requests_in_flight_per_offline_eval_runner": 1, "validate_offline_eval_runners_after_construction": true, "offline_eval_runner_health_probe_timeout_s": 30.0, "offline_eval_rl_module_inference_only": false, "broadcast_offline_eval_runner_states": false, "offline_eval_batch_size_per_runner": 256, "dataset_num_iters_per_eval_runner": 1, "keep_per_episode_custom_metrics": false, "metrics_episode_collection_timeout_s": 60.0, "metrics_num_episodes_for_smoothing": 100, "min_time_s_per_iteration": null, "min_train_timesteps_per_iteration": 0, "min_sample_timesteps_per_iteration": 0, "log_gradients": true, "export_native_model_files": false, "checkpoint_trainable_policies_only": false, "logger_creator": null, "logger_config": null, "log_level": "WARN", "log_sys_usage": true, "fake_sampler": false, "seed": 3, "restart_failed_env_runners": true, "ignore_env_runner_failures": false, "max_num_env_runner_restarts": 1000, "delay_between_env_runner_restarts_s": 60.0, "restart_failed_sub_environments": false, "num_consecutive_env_runner_failures_tolerance": 100, "env_runner_health_probe_timeout_s": 30.0, "env_runner_restore_timeout_s": 1800.0, "_model_config": {}, "_rl_module_spec": "RLModuleSpec(module_class=None, observation_space=None, action_space=None, inference_only=False, learner_only=False, model_config=DefaultModelConfig(fcnet_hiddens=[60, 90], fcnet_activation='tanh', fcnet_kernel_initializer=None, fcnet_kernel_initializer_kwargs=None, fcnet_bias_initializer=None, fcnet_bias_initializer_kwargs=None, conv_filters=None, conv_activation='relu', conv_kernel_initializer=None, conv_kernel_initializer_kwargs=None, conv_bias_initializer=None, conv_bias_initializer_kwargs=None, head_fcnet_hiddens=[], head_fcnet_activation='relu', head_fcnet_kernel_initializer=None, head_fcnet_kernel_initializer_kwargs=None, head_fcnet_bias_initializer=None, head_fcnet_bias_initializer_kwargs=None, free_log_std=False, log_std_clip_param=20.0, vf_share_layers=True, use_lstm=False, max_seq_len=20, lstm_cell_size=256, lstm_use_prev_action=False, lstm_use_prev_reward=False, lstm_kernel_initializer=None, lstm_kernel_initializer_kwargs=None, lstm_bias_initializer=None, lstm_bias_initializer_kwargs=None), catalog_class=None, load_state_path=None, model_config_dict=None)", "algorithm_config_overrides_per_module": {}, "_per_module_overrides": {}, "_validate_config": true, "_use_msgpack_checkpoints": false, "_torch_grad_scaler_class": null, "_torch_lr_scheduler_classes": null, "_tf_policy_handles_more_than_one_loss": false, "_disable_preprocessor_api": false, "_disable_action_flattening": false, "_disable_initialize_loss_from_dummy_batch": false, "_dont_auto_sync_env_runner_states": false, "env_task_fn": -1, "enable_connectors": -1, "simple_optimizer": false, "policy_map_cache": -1, "worker_cls": -1, "synchronize_filters": -1, "enable_async_evaluation": -1, "custom_async_evaluation_function": -1, "_enable_rl_module_api": -1, "auto_wrap_old_gym_envs": -1, "always_attach_evaluation_results": -1, "replay_sequence_length": null, "_disable_execution_plan_api": -1, "use_critic": true, "use_gae": true, "use_kl_loss": true, "kl_coeff": 0.7464963036515, "kl_target": 0.0270990929592, "vf_loss_coeff": 0.6688075857018, "entropy_coeff": 0.0090570820258, "clip_param": 0.1221781641624, "vf_clip_param": 0.1027808522125, "entropy_coeff_schedule": null, "lr_schedule": null, "sgd_minibatch_size": -1, "vf_share_layers": -1, "__stdout_file__": null, "__stderr_file__": null, "lambda": 0.9099046732075, "input": "sampler", "policies": {"default_policy": [null, null, null, null]}, "callbacks": "<class 'ray.rllib.callbacks.callbacks.RLlibCallback'>", "create_env_on_driver": false, "custom_eval_function": null, "framework": "torch"}, "time_since_restore": 41.69420266151428, "iterations_since_restore": 14, "perf": {"cpu_util_percent": 69.55000000000001, "ram_util_percent": 79.2}}
{"timers": {"training_iteration": 3.3663342166380468, "restore_env_runners": 4.906933374371717e-05, "training_step": 3.365894635238101, "env_runner_sampling_timer": 3.185377768700461, "learner_update_timer": 0.17549545165069366, "synch_weights": 0.0012826218760031093, "restore_eval_env_runners": 1.0915558801726726e-05, "evaluation_iteration": 0.1926162667012271, "synch_eval_env_connectors": 0.0002008644839578864, "synch_env_connectors": 6.9388541216088605e-06}, "env_runners": {"episode_return_min": -13.5, "module_to_env_connector": {"connector_pipeline_timer": 0.00019144081163543196, "timers": {"connectors": {"normalize_and_clip_actions": 1.569596714627073e-05, "un_batch_to_individual_items": 8.659096727484778e-06, "remove_single_ts_time_rank_from_batch": 1.00327226682477e-06, "tensor_to_numpy": 2.3848904237528153e-05, "listify_data_for_vector_env": 1.910015488874406e-05, "get_actions": 8.127021563648217e-05}}}, "env_step_timer": 2.6122684551298376e-05, "rlmodule_inference_timer": 5.413008328557067e-05, "env_reset_timer": 7.735943068125958e-05, "agent_episode_returns_mean": {"default_agent": 3.7}, "num_env_steps_sampled_lifetime": -8017500.0, "weights_seq_no": 14.0, "env_to_module_sum_episodes_length_out": 10.36823839457432, "episode_len_max": 20, "env_to_module_connector": {"timers": {"connectors": {"batch_individual_items": 1.1218395096627115e-05, "numpy_to_tensor": 1.6689889368796625e-05, "add_time_dim_to_batch_and_zero_pad": 4.089455466832155e-06, "add_observations_from_episodes_to_batch": 5.028495775910116e-06, "add_states_from_episodes_to_batch": 2.525461887541853e-06}}, "connector_pipeline_timer": 7.226722423678913e-05}, "env_to_module_sum_episodes_length_in": 10.36823839457432, "sample": 0.008591117684714586, "num_agent_steps_sampled": {"default_agent": 5000.0}, "num_module_steps_sampled": {"default_policy": 5000.0}, "num_episodes_lifetime": -400875.0, "num_module_steps_sampled_lifetime": {"default_policy": -8017500.0}, "num_agent_steps_sampled_lifetime": {"default_agent": -8017500.0}, "time_between_sampling": 0.0028502545636891518, "episode_len_mean": 20.0, "episode_return_mean": 3.7, "num_episodes": 250.0, "episode_duration_sec_mean": 0.008224765310529621, "episode_len_min": 20, "num_env_steps_sampled": 5000.0, "module_episode_returns_mean": {"default_policy": 3.7}, "episode_return_max": 6.5, "num_env_steps_sampled_lifetime_throughput": 2368.89637261369}, "learners": {"__all_modules__": {"learner_connector": {"timers": {"connectors": {"add_columns_from_episodes_to_train_batch": 0.03854269817185549, "add_states_from_episodes_to_batch": 4.827069966486312e-06, "add_one_ts_to_episodes_and_truncate": 0.01298566534507202, "numpy_to_tensor": 0.00019630889939263764, "batch_individual_items": 0.05024758656754503, "add_time_dim_to_batch_and_zero_pad": 1.4616793730859512e-05, "general_advantage_estimation": 0.012907827972758778, "add_observations_from_episodes_to_batch": 0.0009156586170319415}}, "connector_pipeline_timer": 0.11618434325495275}, "num_module_steps_trained": 6000, "num_non_trainable_parameters": 0, "num_module_steps_trained_lifetime": 90000, "learner_connector_sum_episodes_length_in": 5000.0, "learner_connector_sum_episodes_length_out": 5250.0, "num_env_steps_trained": 31500, "num_trainable_parameters": 6003, "num_env_steps_trained_lifetime": 472500, "num_env_steps_trained_lifetime_throughput": 1079418.2054967305, "num_module_steps_trained_throughput": 207636.90495020183, "num_module_steps_trained_lifetime_throughput": 207451.74555596677}, "default_policy": {"num_module_steps_trained": 6000, "curr_entropy_coeff": 0.0090570820258, "num_module_steps_trained_lifetime": 90000, "gradients_default_optimizer_global_norm": 0.09681214392185211, "entropy": 0.5022678375244141, "total_loss": -0.03771353140473366, "weights_seq_no": 15.0, "default_optimizer_learning_rate": 0.0002847858517, "curr_kl_coeff": 2.2781259758630767e-05, "policy_loss": -0.09887556731700897, "vf_loss_unclipped": 24.126394271850586, "vf_explained_var": -0.0060272216796875, "mean_kl_loss": 3.665469921543263e-05, "num_trainable_parameters": 6003, "module_train_batch_size_mean": 1000.0, "diff_num_grad_updates_vs_sampler_policy": 1.0, "vf_loss": 0.09825114160776138, "num_module_steps_trained_lifetime_throughput": 207823.1878538227}}, "num_training_step_calls_per_iteration": 1, "evaluation": {"env_runners": {"num_module_steps_sampled_lifetime": {"default_policy": 6000}, "env_step_timer": 2.0269421301473073e-05, "episode_duration_sec_mean": 0.007496787927811966, "num_module_steps_sampled": {"default_policy": 400}, "num_agent_steps_sampled_lifetime": {"default_agent": 6000}, "rlmodule_inference_timer": 4.0078445577056187e-05, "weights_seq_no": 15.0, "env_to_module_sum_episodes_length_out": 10.368238394574323, "sample": 0.1815895278613885, "episode_len_mean": 20.0, "agent_episode_returns_mean": {"default_agent": 3.2}, "env_to_module_connector": {"connector_pipeline_timer": 5.625284096533563e-05, "timers": {"connectors": {"add_observations_from_episodes_to_batch": 3.673438764299643e-06, "add_states_from_episodes_to_batch": 1.8004294863992737e-06, "numpy_to_tensor": 1.2219799920905464e-05, "batch_individual_items": 8.928730309183763e-06, "add_time_dim_to_batch_and_zero_pad": 2.978629384868642e-06}}}, "episode_return_max": 13.5, "module_to_env_connector": {"timers": {"connectors": {"tensor_to_numpy": 1.7614023871773147e-05, "listify_data_for_vector_env": 1.5600199018278674e-05, "normalize_and_clip_actions": 1.2630012588909384e-05, "un_batch_to_individual_items": 6.929659698991568e-06, "remove_single_ts_time_rank_from_batch": 7.344804266277265e-07, "get_actions": 5.4383208990059326e-05}}, "connector_pipeline_timer": 0.00014112701492075482}, "env_to_module_sum_episodes_length_in": 10.368238394574323, "num_episodes_lifetime": 300, "module_episode_returns_mean": {"default_policy": 3.2}, "num_episodes": 20, "episode_len_min": 20, "num_agent_steps_sampled": {"default_agent": 400}, "episode_return_min": -12.5, "env_reset_timer": 0.00046776371444055164, "num_env_steps_sampled_lifetime": 75400, "episode_len_max": 20, "episode_return_mean": 3.2, "num_env_steps_sampled": 400, "time_between_sampling": 2.7515185998090836}, "num_healthy_workers": 1, "actor_manager_num_outstanding_async_reqs": 0, "num_remote_worker_restarts": 0}, "num_env_steps_sampled_lifetime": -8017500.0, "fault_tolerance": {"num_healthy_workers": 0, "num_remote_worker_restarts": 0}, "env_runner_group": {"actor_manager_num_outstanding_async_reqs": 0}, "done": false, "training_iteration": 15, "trial_id": "469e6_00000", "date": "2025-08-11_19-33-45", "timestamp": 1754933625, "time_this_iter_s": 2.836336135864258, "time_total_s": 44.53053879737854, "pid": 25834, "hostname": "Mac", "node_ip": "127.0.0.1", "config": {"exploration_config": {}, "extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "placement_strategy": "PACK", "num_gpus": 0, "_fake_gpus": false, "num_cpus_for_main_process": 2, "eager_tracing": true, "eager_max_retraces": 20, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "torch_compile_learner": false, "torch_compile_learner_what_to_compile": "forward_train", "torch_compile_learner_dynamo_backend": "aot_eager", "torch_compile_learner_dynamo_mode": null, "torch_compile_worker": false, "torch_compile_worker_dynamo_backend": "aot_eager", "torch_compile_worker_dynamo_mode": null, "torch_ddp_kwargs": {}, "torch_skip_nan_gradients": false, "env": "Umbrella", "env_config": {}, "observation_space": null, "action_space": null, "clip_rewards": null, "normalize_actions": true, "clip_actions": false, "_is_atari": null, "disable_env_checking": false, "render_env": false, "action_mask_key": "action_mask", "env_runner_cls": null, "num_env_runners": 0, "create_local_env_runner": true, "num_envs_per_env_runner": 1, "gym_env_vectorize_mode": "SYNC", "num_cpus_per_env_runner": 1, "num_gpus_per_env_runner": 0, "custom_resources_per_env_runner": {}, "validate_env_runners_after_construction": true, "episodes_to_numpy": true, "max_requests_in_flight_per_env_runner": 1, "sample_timeout_s": 60.0, "_env_to_module_connector": null, "add_default_connectors_to_env_to_module_pipeline": true, "_module_to_env_connector": null, "add_default_connectors_to_module_to_env_pipeline": true, "merge_env_runner_states": "training_only", "broadcast_env_runner_states": true, "episode_lookback_horizon": 1, "rollout_fragment_length": "auto", "batch_mode": "complete_episodes", "compress_observations": false, "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "enable_tf1_exec_eagerly": false, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "preprocessor_pref": "deepmind", "observation_filter": "NoFilter", "update_worker_filter_stats": true, "use_worker_filter_stats": true, "sampler_perf_stats_ema_coef": null, "_is_online": true, "num_learners": 0, "num_gpus_per_learner": 0, "num_cpus_per_learner": "auto", "num_aggregator_actors_per_learner": 0, "max_requests_in_flight_per_aggregator_actor": 3, "local_gpu_idx": 0, "max_requests_in_flight_per_learner": 3, "gamma": 1, "lr": 0.0002847858517, "grad_clip": 0.5, "grad_clip_by": "global_norm", "_train_batch_size_per_learner": 5000, "train_batch_size": 4000, "num_epochs": 1, "minibatch_size": 1000, "shuffle_batch_per_epoch": true, "model": {"fcnet_hiddens": [256, 256], "fcnet_activation": "tanh", "fcnet_weights_initializer": null, "fcnet_weights_initializer_config": null, "fcnet_bias_initializer": null, "fcnet_bias_initializer_config": null, "conv_filters": null, "conv_activation": "relu", "conv_kernel_initializer": null, "conv_kernel_initializer_config": null, "conv_bias_initializer": null, "conv_bias_initializer_config": null, "conv_transpose_kernel_initializer": null, "conv_transpose_kernel_initializer_config": null, "conv_transpose_bias_initializer": null, "conv_transpose_bias_initializer_config": null, "post_fcnet_hiddens": [], "post_fcnet_activation": "relu", "post_fcnet_weights_initializer": null, "post_fcnet_weights_initializer_config": null, "post_fcnet_bias_initializer": null, "post_fcnet_bias_initializer_config": null, "free_log_std": false, "log_std_clip_param": 20.0, "no_final_linear": false, "vf_share_layers": false, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "lstm_weights_initializer": null, "lstm_weights_initializer_config": null, "lstm_bias_initializer": null, "lstm_bias_initializer_config": null, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "attention_use_n_prev_actions": 0, "attention_use_n_prev_rewards": 0, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": null, "custom_model_config": {}, "custom_action_dist": null, "custom_preprocessor": null, "encoder_latent_dim": null, "always_check_shapes": false, "lstm_use_prev_action_reward": -1, "_use_default_native_models": -1, "_disable_preprocessor_api": false, "_disable_action_flattening": false}, "_learner_connector": null, "add_default_connectors_to_learner_pipeline": true, "learner_config_dict": {}, "optimizer": {}, "_learner_class": null, "callbacks_on_algorithm_init": null, "callbacks_on_env_runners_recreated": null, "callbacks_on_offline_eval_runners_recreated": null, "callbacks_on_checkpoint_loaded": null, "callbacks_on_environment_created": null, "callbacks_on_episode_created": null, "callbacks_on_episode_start": null, "callbacks_on_episode_step": null, "callbacks_on_episode_end": null, "callbacks_on_evaluate_start": null, "callbacks_on_evaluate_end": null, "callbacks_on_evaluate_offline_start": null, "callbacks_on_evaluate_offline_end": null, "callbacks_on_sample_end": null, "callbacks_on_train_result": null, "explore": true, "enable_rl_module_and_learner": true, "enable_env_runner_and_connector_v2": true, "_prior_exploration_config": {"type": "StochasticSampling"}, "count_steps_by": "env_steps", "policy_map_capacity": 100, "policy_mapping_fn": "<function AlgorithmConfig.DEFAULT_POLICY_MAPPING_FN at 0x14f2edb20>", "policies_to_train": null, "policy_states_are_swappable": false, "observation_fn": null, "offline_data_class": null, "input_read_method": "read_parquet", "input_read_method_kwargs": {}, "input_read_schema": {}, "input_read_episodes": false, "input_read_sample_batches": false, "input_read_batch_size": null, "input_filesystem": null, "input_filesystem_kwargs": {}, "input_compress_columns": ["obs", "new_obs"], "input_spaces_jsonable": true, "materialize_data": false, "materialize_mapped_data": true, "map_batches_kwargs": {}, "iter_batches_kwargs": {}, "ignore_final_observation": false, "prelearner_class": null, "prelearner_buffer_class": null, "prelearner_buffer_kwargs": {}, "prelearner_module_synch_period": 10, "dataset_num_iters_per_learner": null, "input_config": {}, "actions_in_input_normalized": false, "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_config": {}, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "output_max_rows_per_file": null, "output_write_remaining_data": false, "output_write_method": "write_parquet", "output_write_method_kwargs": {}, "output_filesystem": null, "output_filesystem_kwargs": {}, "output_write_episodes": true, "offline_sampling": false, "evaluation_interval": 1, "evaluation_duration": 20, "evaluation_duration_unit": "episodes", "evaluation_sample_timeout_s": 120.0, "evaluation_auto_duration_min_env_steps_per_sample": 100, "evaluation_auto_duration_max_env_steps_per_sample": 2000, "evaluation_parallel_to_training": false, "evaluation_force_reset_envs_before_iteration": true, "evaluation_config": null, "off_policy_estimation_methods": {}, "ope_split_batch_by_episode": true, "evaluation_num_env_runners": 1, "in_evaluation": false, "sync_filters_on_rollout_workers_timeout_s": 10.0, "offline_evaluation_interval": null, "num_offline_eval_runners": 0, "offline_loss_for_module_fn": null, "offline_evaluation_duration": 1, "offline_evaluation_parallel_to_training": false, "offline_evaluation_timeout_s": 120.0, "num_cpus_per_offline_eval_runner": 1, "num_gpus_per_offline_eval_runner": 0, "custom_resources_per_offline_eval_runner": {}, "restart_failed_offline_eval_runners": true, "ignore_offline_eval_runner_failures": false, "max_num_offline_eval_runner_restarts": 1000, "offline_eval_runner_restore_timeout_s": 1800.0, "max_requests_in_flight_per_offline_eval_runner": 1, "validate_offline_eval_runners_after_construction": true, "offline_eval_runner_health_probe_timeout_s": 30.0, "offline_eval_rl_module_inference_only": false, "broadcast_offline_eval_runner_states": false, "offline_eval_batch_size_per_runner": 256, "dataset_num_iters_per_eval_runner": 1, "keep_per_episode_custom_metrics": false, "metrics_episode_collection_timeout_s": 60.0, "metrics_num_episodes_for_smoothing": 100, "min_time_s_per_iteration": null, "min_train_timesteps_per_iteration": 0, "min_sample_timesteps_per_iteration": 0, "log_gradients": true, "export_native_model_files": false, "checkpoint_trainable_policies_only": false, "logger_creator": null, "logger_config": null, "log_level": "WARN", "log_sys_usage": true, "fake_sampler": false, "seed": 3, "restart_failed_env_runners": true, "ignore_env_runner_failures": false, "max_num_env_runner_restarts": 1000, "delay_between_env_runner_restarts_s": 60.0, "restart_failed_sub_environments": false, "num_consecutive_env_runner_failures_tolerance": 100, "env_runner_health_probe_timeout_s": 30.0, "env_runner_restore_timeout_s": 1800.0, "_model_config": {}, "_rl_module_spec": "RLModuleSpec(module_class=None, observation_space=None, action_space=None, inference_only=False, learner_only=False, model_config=DefaultModelConfig(fcnet_hiddens=[60, 90], fcnet_activation='tanh', fcnet_kernel_initializer=None, fcnet_kernel_initializer_kwargs=None, fcnet_bias_initializer=None, fcnet_bias_initializer_kwargs=None, conv_filters=None, conv_activation='relu', conv_kernel_initializer=None, conv_kernel_initializer_kwargs=None, conv_bias_initializer=None, conv_bias_initializer_kwargs=None, head_fcnet_hiddens=[], head_fcnet_activation='relu', head_fcnet_kernel_initializer=None, head_fcnet_kernel_initializer_kwargs=None, head_fcnet_bias_initializer=None, head_fcnet_bias_initializer_kwargs=None, free_log_std=False, log_std_clip_param=20.0, vf_share_layers=True, use_lstm=False, max_seq_len=20, lstm_cell_size=256, lstm_use_prev_action=False, lstm_use_prev_reward=False, lstm_kernel_initializer=None, lstm_kernel_initializer_kwargs=None, lstm_bias_initializer=None, lstm_bias_initializer_kwargs=None), catalog_class=None, load_state_path=None, model_config_dict=None)", "algorithm_config_overrides_per_module": {}, "_per_module_overrides": {}, "_validate_config": true, "_use_msgpack_checkpoints": false, "_torch_grad_scaler_class": null, "_torch_lr_scheduler_classes": null, "_tf_policy_handles_more_than_one_loss": false, "_disable_preprocessor_api": false, "_disable_action_flattening": false, "_disable_initialize_loss_from_dummy_batch": false, "_dont_auto_sync_env_runner_states": false, "env_task_fn": -1, "enable_connectors": -1, "simple_optimizer": false, "policy_map_cache": -1, "worker_cls": -1, "synchronize_filters": -1, "enable_async_evaluation": -1, "custom_async_evaluation_function": -1, "_enable_rl_module_api": -1, "auto_wrap_old_gym_envs": -1, "always_attach_evaluation_results": -1, "replay_sequence_length": null, "_disable_execution_plan_api": -1, "use_critic": true, "use_gae": true, "use_kl_loss": true, "kl_coeff": 0.7464963036515, "kl_target": 0.0270990929592, "vf_loss_coeff": 0.6688075857018, "entropy_coeff": 0.0090570820258, "clip_param": 0.1221781641624, "vf_clip_param": 0.1027808522125, "entropy_coeff_schedule": null, "lr_schedule": null, "sgd_minibatch_size": -1, "vf_share_layers": -1, "__stdout_file__": null, "__stderr_file__": null, "lambda": 0.9099046732075, "input": "sampler", "policies": {"default_policy": [null, null, null, null]}, "callbacks": "<class 'ray.rllib.callbacks.callbacks.RLlibCallback'>", "create_env_on_driver": false, "custom_eval_function": null, "framework": "torch"}, "time_since_restore": 44.53053879737854, "iterations_since_restore": 15, "perf": {"cpu_util_percent": 72.675, "ram_util_percent": 79.475}}
{"timers": {"training_iteration": 3.358579896971939, "restore_env_runners": 4.864863977514132e-05, "training_step": 3.3581419622160493, "env_runner_sampling_timer": 3.177261483933356, "learner_update_timer": 0.17584131213419923, "synch_weights": 0.0012803727366174212, "restore_eval_env_runners": 1.0875152282014356e-05, "evaluation_iteration": 0.19216553028388658, "synch_eval_env_connectors": 0.00020035875859478682, "synch_env_connectors": 6.913635881800347e-06}, "env_runners": {"episode_return_min": -13.5, "module_to_env_connector": {"connector_pipeline_timer": 0.0001852313276979292, "timers": {"connectors": {"normalize_and_clip_actions": 1.4761854612205093e-05, "un_batch_to_individual_items": 8.423248486675947e-06, "remove_single_ts_time_rank_from_batch": 9.811669139594293e-07, "tensor_to_numpy": 2.2678681604903766e-05, "listify_data_for_vector_env": 1.8545348944639378e-05, "get_actions": 7.924317649571946e-05}}}, "env_step_timer": 2.458930011966555e-05, "rlmodule_inference_timer": 5.234492448734103e-05, "env_reset_timer": 7.595305336040294e-05, "agent_episode_returns_mean": {"default_agent": 3.8600000000000008}, "num_env_steps_sampled_lifetime": -8635000.0, "weights_seq_no": 15.0, "env_to_module_sum_episodes_length_out": 10.36823839457432, "episode_len_max": 20, "env_to_module_connector": {"timers": {"connectors": {"batch_individual_items": 1.0410534226105936e-05, "numpy_to_tensor": 1.531456631037146e-05, "add_time_dim_to_batch_and_zero_pad": 3.846894956895386e-06, "add_observations_from_episodes_to_batch": 4.678089839038235e-06, "add_states_from_episodes_to_batch": 2.438578404792864e-06}}, "connector_pipeline_timer": 6.838597711116856e-05}, "env_to_module_sum_episodes_length_in": 10.36823839457432, "sample": 0.008497046152658528, "num_agent_steps_sampled": {"default_agent": 5000.0}, "num_module_steps_sampled": {"default_policy": 5000.0}, "num_episodes_lifetime": -431750.0, "num_module_steps_sampled_lifetime": {"default_policy": -8635000.0}, "num_agent_steps_sampled_lifetime": {"default_agent": -8635000.0}, "time_between_sampling": 0.0025972246537949266, "episode_len_mean": 20.0, "episode_return_mean": 3.8600000000000008, "num_episodes": 250.0, "episode_duration_sec_mean": 0.007876352003309876, "episode_len_min": 20, "num_env_steps_sampled": 5000.0, "module_episode_returns_mean": {"default_policy": 3.8600000000000008}, "episode_return_max": 6.5, "num_env_steps_sampled_lifetime_throughput": 2412.3993565790565}, "learners": {"__all_modules__": {"learner_connector": {"timers": {"connectors": {"add_columns_from_episodes_to_train_batch": 0.03904319244116571, "add_states_from_episodes_to_batch": 4.809209277189081e-06, "add_one_ts_to_episodes_and_truncate": 0.013057304521590945, "numpy_to_tensor": 0.0001955870596638605, "batch_individual_items": 0.05043693611175507, "add_time_dim_to_batch_and_zero_pad": 1.459854527748079e-05, "general_advantage_estimation": 0.012870681352293818, "add_observations_from_episodes_to_batch": 0.0009212528614579349}}, "connector_pipeline_timer": 0.1169121381620382}, "num_module_steps_trained": 6000, "num_non_trainable_parameters": 0, "num_module_steps_trained_lifetime": 96000, "learner_connector_sum_episodes_length_in": 5000.0, "learner_connector_sum_episodes_length_out": 5250.0, "num_env_steps_trained": 31500, "num_trainable_parameters": 6003, "num_env_steps_trained_lifetime": 504000, "num_env_steps_trained_lifetime_throughput": 1105613.768679463, "num_module_steps_trained_throughput": 212530.84933954856, "num_module_steps_trained_lifetime_throughput": 212348.2858214403}, "default_policy": {"num_module_steps_trained": 6000, "curr_entropy_coeff": 0.0090570820258, "num_module_steps_trained_lifetime": 96000, "gradients_default_optimizer_global_norm": 0.04237082600593567, "entropy": 0.5057782530784607, "total_loss": 0.12026922404766083, "weights_seq_no": 16.0, "default_optimizer_learning_rate": 0.0002847858517, "curr_kl_coeff": 1.1390629879315384e-05, "policy_loss": 0.05892258882522583, "vf_loss_unclipped": 25.01618003845215, "vf_explained_var": -0.00821065902709961, "mean_kl_loss": 5.30047582287807e-05, "num_trainable_parameters": 6003, "module_train_batch_size_mean": 1000.0, "diff_num_grad_updates_vs_sampler_policy": 1.0, "vf_loss": 0.098574697971344, "num_module_steps_trained_lifetime_throughput": 212686.2357459597}}, "num_training_step_calls_per_iteration": 1, "evaluation": {"env_runners": {"num_module_steps_sampled_lifetime": {"default_policy": 6400}, "env_step_timer": 1.775266980388928e-05, "episode_duration_sec_mean": 0.0072005141619592905, "num_module_steps_sampled": {"default_policy": 400}, "num_agent_steps_sampled_lifetime": {"default_agent": 6400}, "rlmodule_inference_timer": 3.553581353387774e-05, "weights_seq_no": 16.0, "env_to_module_sum_episodes_length_out": 10.368238394574323, "sample": 0.18108984633258937, "episode_len_mean": 20.0, "agent_episode_returns_mean": {"default_agent": 3.4}, "env_to_module_connector": {"connector_pipeline_timer": 5.050037076650349e-05, "timers": {"connectors": {"add_observations_from_episodes_to_batch": 3.243639945178635e-06, "add_states_from_episodes_to_batch": 1.7164254483178328e-06, "numpy_to_tensor": 1.0583371489351921e-05, "batch_individual_items": 8.4041695154047e-06, "add_time_dim_to_batch_and_zero_pad": 2.6795684607363872e-06}}}, "episode_return_max": 13.5, "module_to_env_connector": {"timers": {"connectors": {"tensor_to_numpy": 1.7208722771650383e-05, "listify_data_for_vector_env": 1.8389587040511924e-05, "normalize_and_clip_actions": 1.193165553654003e-05, "un_batch_to_individual_items": 7.148032672069891e-06, "remove_single_ts_time_rank_from_batch": 6.930498290768917e-07, "get_actions": 5.0580802239837475e-05}}, "connector_pipeline_timer": 0.0001384453100709445}, "env_to_module_sum_episodes_length_in": 10.368238394574323, "num_episodes_lifetime": 320, "module_episode_returns_mean": {"default_policy": 3.4}, "num_episodes": 20, "episode_len_min": 20, "num_agent_steps_sampled": {"default_agent": 400}, "episode_return_min": -12.5, "env_reset_timer": 0.00046523732766971825, "num_env_steps_sampled_lifetime": 80400, "episode_len_max": 20, "episode_return_mean": 3.4, "num_env_steps_sampled": 400, "time_between_sampling": 2.7501734188107236}, "num_healthy_workers": 1, "actor_manager_num_outstanding_async_reqs": 0, "num_remote_worker_restarts": 0}, "num_env_steps_sampled_lifetime": -8635000.0, "fault_tolerance": {"num_healthy_workers": 0, "num_remote_worker_restarts": 0}, "env_runner_group": {"actor_manager_num_outstanding_async_reqs": 0}, "done": false, "training_iteration": 16, "trial_id": "469e6_00000", "date": "2025-08-11_19-33-47", "timestamp": 1754933627, "time_this_iter_s": 2.736815929412842, "time_total_s": 47.26735472679138, "pid": 25834, "hostname": "Mac", "node_ip": "127.0.0.1", "config": {"exploration_config": {}, "extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "placement_strategy": "PACK", "num_gpus": 0, "_fake_gpus": false, "num_cpus_for_main_process": 2, "eager_tracing": true, "eager_max_retraces": 20, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "torch_compile_learner": false, "torch_compile_learner_what_to_compile": "forward_train", "torch_compile_learner_dynamo_backend": "aot_eager", "torch_compile_learner_dynamo_mode": null, "torch_compile_worker": false, "torch_compile_worker_dynamo_backend": "aot_eager", "torch_compile_worker_dynamo_mode": null, "torch_ddp_kwargs": {}, "torch_skip_nan_gradients": false, "env": "Umbrella", "env_config": {}, "observation_space": null, "action_space": null, "clip_rewards": null, "normalize_actions": true, "clip_actions": false, "_is_atari": null, "disable_env_checking": false, "render_env": false, "action_mask_key": "action_mask", "env_runner_cls": null, "num_env_runners": 0, "create_local_env_runner": true, "num_envs_per_env_runner": 1, "gym_env_vectorize_mode": "SYNC", "num_cpus_per_env_runner": 1, "num_gpus_per_env_runner": 0, "custom_resources_per_env_runner": {}, "validate_env_runners_after_construction": true, "episodes_to_numpy": true, "max_requests_in_flight_per_env_runner": 1, "sample_timeout_s": 60.0, "_env_to_module_connector": null, "add_default_connectors_to_env_to_module_pipeline": true, "_module_to_env_connector": null, "add_default_connectors_to_module_to_env_pipeline": true, "merge_env_runner_states": "training_only", "broadcast_env_runner_states": true, "episode_lookback_horizon": 1, "rollout_fragment_length": "auto", "batch_mode": "complete_episodes", "compress_observations": false, "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "enable_tf1_exec_eagerly": false, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "preprocessor_pref": "deepmind", "observation_filter": "NoFilter", "update_worker_filter_stats": true, "use_worker_filter_stats": true, "sampler_perf_stats_ema_coef": null, "_is_online": true, "num_learners": 0, "num_gpus_per_learner": 0, "num_cpus_per_learner": "auto", "num_aggregator_actors_per_learner": 0, "max_requests_in_flight_per_aggregator_actor": 3, "local_gpu_idx": 0, "max_requests_in_flight_per_learner": 3, "gamma": 1, "lr": 0.0002847858517, "grad_clip": 0.5, "grad_clip_by": "global_norm", "_train_batch_size_per_learner": 5000, "train_batch_size": 4000, "num_epochs": 1, "minibatch_size": 1000, "shuffle_batch_per_epoch": true, "model": {"fcnet_hiddens": [256, 256], "fcnet_activation": "tanh", "fcnet_weights_initializer": null, "fcnet_weights_initializer_config": null, "fcnet_bias_initializer": null, "fcnet_bias_initializer_config": null, "conv_filters": null, "conv_activation": "relu", "conv_kernel_initializer": null, "conv_kernel_initializer_config": null, "conv_bias_initializer": null, "conv_bias_initializer_config": null, "conv_transpose_kernel_initializer": null, "conv_transpose_kernel_initializer_config": null, "conv_transpose_bias_initializer": null, "conv_transpose_bias_initializer_config": null, "post_fcnet_hiddens": [], "post_fcnet_activation": "relu", "post_fcnet_weights_initializer": null, "post_fcnet_weights_initializer_config": null, "post_fcnet_bias_initializer": null, "post_fcnet_bias_initializer_config": null, "free_log_std": false, "log_std_clip_param": 20.0, "no_final_linear": false, "vf_share_layers": false, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "lstm_weights_initializer": null, "lstm_weights_initializer_config": null, "lstm_bias_initializer": null, "lstm_bias_initializer_config": null, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "attention_use_n_prev_actions": 0, "attention_use_n_prev_rewards": 0, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": null, "custom_model_config": {}, "custom_action_dist": null, "custom_preprocessor": null, "encoder_latent_dim": null, "always_check_shapes": false, "lstm_use_prev_action_reward": -1, "_use_default_native_models": -1, "_disable_preprocessor_api": false, "_disable_action_flattening": false}, "_learner_connector": null, "add_default_connectors_to_learner_pipeline": true, "learner_config_dict": {}, "optimizer": {}, "_learner_class": null, "callbacks_on_algorithm_init": null, "callbacks_on_env_runners_recreated": null, "callbacks_on_offline_eval_runners_recreated": null, "callbacks_on_checkpoint_loaded": null, "callbacks_on_environment_created": null, "callbacks_on_episode_created": null, "callbacks_on_episode_start": null, "callbacks_on_episode_step": null, "callbacks_on_episode_end": null, "callbacks_on_evaluate_start": null, "callbacks_on_evaluate_end": null, "callbacks_on_evaluate_offline_start": null, "callbacks_on_evaluate_offline_end": null, "callbacks_on_sample_end": null, "callbacks_on_train_result": null, "explore": true, "enable_rl_module_and_learner": true, "enable_env_runner_and_connector_v2": true, "_prior_exploration_config": {"type": "StochasticSampling"}, "count_steps_by": "env_steps", "policy_map_capacity": 100, "policy_mapping_fn": "<function AlgorithmConfig.DEFAULT_POLICY_MAPPING_FN at 0x14f2edb20>", "policies_to_train": null, "policy_states_are_swappable": false, "observation_fn": null, "offline_data_class": null, "input_read_method": "read_parquet", "input_read_method_kwargs": {}, "input_read_schema": {}, "input_read_episodes": false, "input_read_sample_batches": false, "input_read_batch_size": null, "input_filesystem": null, "input_filesystem_kwargs": {}, "input_compress_columns": ["obs", "new_obs"], "input_spaces_jsonable": true, "materialize_data": false, "materialize_mapped_data": true, "map_batches_kwargs": {}, "iter_batches_kwargs": {}, "ignore_final_observation": false, "prelearner_class": null, "prelearner_buffer_class": null, "prelearner_buffer_kwargs": {}, "prelearner_module_synch_period": 10, "dataset_num_iters_per_learner": null, "input_config": {}, "actions_in_input_normalized": false, "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_config": {}, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "output_max_rows_per_file": null, "output_write_remaining_data": false, "output_write_method": "write_parquet", "output_write_method_kwargs": {}, "output_filesystem": null, "output_filesystem_kwargs": {}, "output_write_episodes": true, "offline_sampling": false, "evaluation_interval": 1, "evaluation_duration": 20, "evaluation_duration_unit": "episodes", "evaluation_sample_timeout_s": 120.0, "evaluation_auto_duration_min_env_steps_per_sample": 100, "evaluation_auto_duration_max_env_steps_per_sample": 2000, "evaluation_parallel_to_training": false, "evaluation_force_reset_envs_before_iteration": true, "evaluation_config": null, "off_policy_estimation_methods": {}, "ope_split_batch_by_episode": true, "evaluation_num_env_runners": 1, "in_evaluation": false, "sync_filters_on_rollout_workers_timeout_s": 10.0, "offline_evaluation_interval": null, "num_offline_eval_runners": 0, "offline_loss_for_module_fn": null, "offline_evaluation_duration": 1, "offline_evaluation_parallel_to_training": false, "offline_evaluation_timeout_s": 120.0, "num_cpus_per_offline_eval_runner": 1, "num_gpus_per_offline_eval_runner": 0, "custom_resources_per_offline_eval_runner": {}, "restart_failed_offline_eval_runners": true, "ignore_offline_eval_runner_failures": false, "max_num_offline_eval_runner_restarts": 1000, "offline_eval_runner_restore_timeout_s": 1800.0, "max_requests_in_flight_per_offline_eval_runner": 1, "validate_offline_eval_runners_after_construction": true, "offline_eval_runner_health_probe_timeout_s": 30.0, "offline_eval_rl_module_inference_only": false, "broadcast_offline_eval_runner_states": false, "offline_eval_batch_size_per_runner": 256, "dataset_num_iters_per_eval_runner": 1, "keep_per_episode_custom_metrics": false, "metrics_episode_collection_timeout_s": 60.0, "metrics_num_episodes_for_smoothing": 100, "min_time_s_per_iteration": null, "min_train_timesteps_per_iteration": 0, "min_sample_timesteps_per_iteration": 0, "log_gradients": true, "export_native_model_files": false, "checkpoint_trainable_policies_only": false, "logger_creator": null, "logger_config": null, "log_level": "WARN", "log_sys_usage": true, "fake_sampler": false, "seed": 3, "restart_failed_env_runners": true, "ignore_env_runner_failures": false, "max_num_env_runner_restarts": 1000, "delay_between_env_runner_restarts_s": 60.0, "restart_failed_sub_environments": false, "num_consecutive_env_runner_failures_tolerance": 100, "env_runner_health_probe_timeout_s": 30.0, "env_runner_restore_timeout_s": 1800.0, "_model_config": {}, "_rl_module_spec": "RLModuleSpec(module_class=None, observation_space=None, action_space=None, inference_only=False, learner_only=False, model_config=DefaultModelConfig(fcnet_hiddens=[60, 90], fcnet_activation='tanh', fcnet_kernel_initializer=None, fcnet_kernel_initializer_kwargs=None, fcnet_bias_initializer=None, fcnet_bias_initializer_kwargs=None, conv_filters=None, conv_activation='relu', conv_kernel_initializer=None, conv_kernel_initializer_kwargs=None, conv_bias_initializer=None, conv_bias_initializer_kwargs=None, head_fcnet_hiddens=[], head_fcnet_activation='relu', head_fcnet_kernel_initializer=None, head_fcnet_kernel_initializer_kwargs=None, head_fcnet_bias_initializer=None, head_fcnet_bias_initializer_kwargs=None, free_log_std=False, log_std_clip_param=20.0, vf_share_layers=True, use_lstm=False, max_seq_len=20, lstm_cell_size=256, lstm_use_prev_action=False, lstm_use_prev_reward=False, lstm_kernel_initializer=None, lstm_kernel_initializer_kwargs=None, lstm_bias_initializer=None, lstm_bias_initializer_kwargs=None), catalog_class=None, load_state_path=None, model_config_dict=None)", "algorithm_config_overrides_per_module": {}, "_per_module_overrides": {}, "_validate_config": true, "_use_msgpack_checkpoints": false, "_torch_grad_scaler_class": null, "_torch_lr_scheduler_classes": null, "_tf_policy_handles_more_than_one_loss": false, "_disable_preprocessor_api": false, "_disable_action_flattening": false, "_disable_initialize_loss_from_dummy_batch": false, "_dont_auto_sync_env_runner_states": false, "env_task_fn": -1, "enable_connectors": -1, "simple_optimizer": false, "policy_map_cache": -1, "worker_cls": -1, "synchronize_filters": -1, "enable_async_evaluation": -1, "custom_async_evaluation_function": -1, "_enable_rl_module_api": -1, "auto_wrap_old_gym_envs": -1, "always_attach_evaluation_results": -1, "replay_sequence_length": null, "_disable_execution_plan_api": -1, "use_critic": true, "use_gae": true, "use_kl_loss": true, "kl_coeff": 0.7464963036515, "kl_target": 0.0270990929592, "vf_loss_coeff": 0.6688075857018, "entropy_coeff": 0.0090570820258, "clip_param": 0.1221781641624, "vf_clip_param": 0.1027808522125, "entropy_coeff_schedule": null, "lr_schedule": null, "sgd_minibatch_size": -1, "vf_share_layers": -1, "__stdout_file__": null, "__stderr_file__": null, "lambda": 0.9099046732075, "input": "sampler", "policies": {"default_policy": [null, null, null, null]}, "callbacks": "<class 'ray.rllib.callbacks.callbacks.RLlibCallback'>", "create_env_on_driver": false, "custom_eval_function": null, "framework": "torch"}, "time_since_restore": 47.26735472679138, "iterations_since_restore": 16, "perf": {"cpu_util_percent": 74.575, "ram_util_percent": 79.25}}
{"timers": {"training_iteration": 3.35330119883119, "restore_env_runners": 4.8230903609848016e-05, "training_step": 3.352865585094031, "env_runner_sampling_timer": 3.1723588170136443, "learner_update_timer": 0.17547885901250235, "synch_weights": 0.0012748919183288765, "restore_eval_env_runners": 1.0852650542829352e-05, "evaluation_iteration": 0.19163938331136307, "synch_eval_env_connectors": 0.00020114267069740467, "synch_env_connectors": 6.882419485761032e-06}, "env_runners": {"episode_return_min": -13.5, "module_to_env_connector": {"connector_pipeline_timer": 0.0001947768225711318, "timers": {"connectors": {"normalize_and_clip_actions": 1.5604745459538247e-05, "un_batch_to_individual_items": 8.919714141556251e-06, "remove_single_ts_time_rank_from_batch": 1.0011151878377422e-06, "tensor_to_numpy": 2.4237593111631615e-05, "listify_data_for_vector_env": 1.9539913627156097e-05, "get_actions": 8.338442129404164e-05}}}, "env_step_timer": 2.7654665221602856e-05, "rlmodule_inference_timer": 8.73474958613791e-05, "env_reset_timer": 7.865440310198245e-05, "agent_episode_returns_mean": {"default_agent": 3.8600000000000008}, "num_env_steps_sampled_lifetime": -9252500.0, "weights_seq_no": 16.0, "env_to_module_sum_episodes_length_out": 10.36823839457432, "episode_len_max": 20, "env_to_module_connector": {"timers": {"connectors": {"batch_individual_items": 1.1629431471664363e-05, "numpy_to_tensor": 1.668458058235057e-05, "add_time_dim_to_batch_and_zero_pad": 4.89440195540628e-06, "add_observations_from_episodes_to_batch": 4.901458224813772e-06, "add_states_from_episodes_to_batch": 3.6345215302786104e-06}}, "connector_pipeline_timer": 7.448961962716055e-05}, "env_to_module_sum_episodes_length_in": 10.36823839457432, "sample": 0.009315838268311545, "num_agent_steps_sampled": {"default_agent": 5000.0}, "num_module_steps_sampled": {"default_policy": 5000.0}, "num_episodes_lifetime": -462625.0, "num_module_steps_sampled_lifetime": {"default_policy": -9252500.0}, "num_agent_steps_sampled_lifetime": {"default_agent": -9252500.0}, "time_between_sampling": 0.002634916082016946, "episode_len_mean": 20.0, "episode_return_mean": 3.8600000000000008, "num_episodes": 250.0, "episode_duration_sec_mean": 0.009141617806162686, "episode_len_min": 20, "num_env_steps_sampled": 5000.0, "module_episode_returns_mean": {"default_policy": 3.8600000000000008}, "episode_return_max": 6.5, "num_env_steps_sampled_lifetime_throughput": 2340.2262187639535}, "learners": {"__all_modules__": {"learner_connector": {"timers": {"connectors": {"add_columns_from_episodes_to_train_batch": 0.0391319588570806, "add_states_from_episodes_to_batch": 4.80486722651297e-06, "add_one_ts_to_episodes_and_truncate": 0.013070143556735612, "numpy_to_tensor": 0.00019461160980381787, "batch_individual_items": 0.05041476467142933, "add_time_dim_to_batch_and_zero_pad": 1.4590479384780787e-05, "general_advantage_estimation": 0.012808764538607936, "add_observations_from_episodes_to_batch": 0.0009306690835382712}}, "connector_pipeline_timer": 0.11693608803029026}, "num_module_steps_trained": 6000, "num_non_trainable_parameters": 0, "num_module_steps_trained_lifetime": 102000, "learner_connector_sum_episodes_length_in": 5000.0, "learner_connector_sum_episodes_length_out": 5250.0, "num_env_steps_trained": 31500, "num_trainable_parameters": 6003, "num_env_steps_trained_lifetime": 535500, "num_env_steps_trained_lifetime_throughput": 1129339.8618269823, "num_module_steps_trained_throughput": 216959.2867229077, "num_module_steps_trained_lifetime_throughput": 216779.84184470712}, "default_policy": {"num_module_steps_trained": 6000, "curr_entropy_coeff": 0.0090570820258, "num_module_steps_trained_lifetime": 102000, "gradients_default_optimizer_global_norm": 0.12520335614681244, "entropy": 0.5125570893287659, "total_loss": 0.07174283266067505, "weights_seq_no": 17.0, "default_optimizer_learning_rate": 0.0002847858517, "curr_kl_coeff": 5.695314939657692e-06, "policy_loss": 0.010529711842536926, "vf_loss_unclipped": 24.70703125, "vf_explained_var": -0.007464289665222168, "mean_kl_loss": 8.060758409556001e-05, "num_trainable_parameters": 6003, "module_train_batch_size_mean": 1000.0, "diff_num_grad_updates_vs_sampler_policy": 1.0, "vf_loss": 0.09846686571836472, "num_module_steps_trained_lifetime_throughput": 217087.5788266312}}, "num_training_step_calls_per_iteration": 1, "evaluation": {"env_runners": {"num_module_steps_sampled_lifetime": {"default_policy": 6800}, "env_step_timer": 1.7609888139184325e-05, "episode_duration_sec_mean": 0.0071751679095905276, "num_module_steps_sampled": {"default_policy": 400}, "num_agent_steps_sampled_lifetime": {"default_agent": 6800}, "rlmodule_inference_timer": 3.457477008347207e-05, "weights_seq_no": 17.0, "env_to_module_sum_episodes_length_out": 10.368238394574323, "sample": 0.18056160077913094, "episode_len_mean": 20.0, "agent_episode_returns_mean": {"default_agent": 3.4}, "env_to_module_connector": {"connector_pipeline_timer": 5.056401927726544e-05, "timers": {"connectors": {"add_observations_from_episodes_to_batch": 3.2752006607053644e-06, "add_states_from_episodes_to_batch": 1.8678490592059954e-06, "numpy_to_tensor": 1.039224683087165e-05, "batch_individual_items": 7.528301787642453e-06, "add_time_dim_to_batch_and_zero_pad": 2.7275630557095234e-06}}}, "episode_return_max": 13.5, "module_to_env_connector": {"timers": {"connectors": {"tensor_to_numpy": 1.6412626124266242e-05, "listify_data_for_vector_env": 1.2880058461164148e-05, "normalize_and_clip_actions": 1.0946589355257894e-05, "un_batch_to_individual_items": 6.345771434770809e-06, "remove_single_ts_time_rank_from_batch": 6.419329563635482e-07, "get_actions": 4.6163468901908036e-05}}, "connector_pipeline_timer": 0.0001234389480007037}, "env_to_module_sum_episodes_length_in": 10.368238394574323, "num_episodes_lifetime": 340, "module_episode_returns_mean": {"default_policy": 3.4}, "num_episodes": 20, "episode_len_min": 20, "num_agent_steps_sampled": {"default_agent": 400}, "episode_return_min": -12.5, "env_reset_timer": 0.0004612999540166177, "num_env_steps_sampled_lifetime": 85400, "episode_len_max": 20, "episode_return_mean": 3.4, "num_env_steps_sampled": 400, "time_between_sampling": 2.751304230042585}, "num_healthy_workers": 1, "actor_manager_num_outstanding_async_reqs": 0, "num_remote_worker_restarts": 0}, "num_env_steps_sampled_lifetime": -9252500.0, "fault_tolerance": {"num_healthy_workers": 0, "num_remote_worker_restarts": 0}, "env_runner_group": {"actor_manager_num_outstanding_async_reqs": 0}, "done": false, "training_iteration": 17, "trial_id": "469e6_00000", "date": "2025-08-11_19-33-50", "timestamp": 1754933630, "time_this_iter_s": 2.967986822128296, "time_total_s": 50.23534154891968, "pid": 25834, "hostname": "Mac", "node_ip": "127.0.0.1", "config": {"exploration_config": {}, "extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "placement_strategy": "PACK", "num_gpus": 0, "_fake_gpus": false, "num_cpus_for_main_process": 2, "eager_tracing": true, "eager_max_retraces": 20, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "torch_compile_learner": false, "torch_compile_learner_what_to_compile": "forward_train", "torch_compile_learner_dynamo_backend": "aot_eager", "torch_compile_learner_dynamo_mode": null, "torch_compile_worker": false, "torch_compile_worker_dynamo_backend": "aot_eager", "torch_compile_worker_dynamo_mode": null, "torch_ddp_kwargs": {}, "torch_skip_nan_gradients": false, "env": "Umbrella", "env_config": {}, "observation_space": null, "action_space": null, "clip_rewards": null, "normalize_actions": true, "clip_actions": false, "_is_atari": null, "disable_env_checking": false, "render_env": false, "action_mask_key": "action_mask", "env_runner_cls": null, "num_env_runners": 0, "create_local_env_runner": true, "num_envs_per_env_runner": 1, "gym_env_vectorize_mode": "SYNC", "num_cpus_per_env_runner": 1, "num_gpus_per_env_runner": 0, "custom_resources_per_env_runner": {}, "validate_env_runners_after_construction": true, "episodes_to_numpy": true, "max_requests_in_flight_per_env_runner": 1, "sample_timeout_s": 60.0, "_env_to_module_connector": null, "add_default_connectors_to_env_to_module_pipeline": true, "_module_to_env_connector": null, "add_default_connectors_to_module_to_env_pipeline": true, "merge_env_runner_states": "training_only", "broadcast_env_runner_states": true, "episode_lookback_horizon": 1, "rollout_fragment_length": "auto", "batch_mode": "complete_episodes", "compress_observations": false, "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "enable_tf1_exec_eagerly": false, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "preprocessor_pref": "deepmind", "observation_filter": "NoFilter", "update_worker_filter_stats": true, "use_worker_filter_stats": true, "sampler_perf_stats_ema_coef": null, "_is_online": true, "num_learners": 0, "num_gpus_per_learner": 0, "num_cpus_per_learner": "auto", "num_aggregator_actors_per_learner": 0, "max_requests_in_flight_per_aggregator_actor": 3, "local_gpu_idx": 0, "max_requests_in_flight_per_learner": 3, "gamma": 1, "lr": 0.0002847858517, "grad_clip": 0.5, "grad_clip_by": "global_norm", "_train_batch_size_per_learner": 5000, "train_batch_size": 4000, "num_epochs": 1, "minibatch_size": 1000, "shuffle_batch_per_epoch": true, "model": {"fcnet_hiddens": [256, 256], "fcnet_activation": "tanh", "fcnet_weights_initializer": null, "fcnet_weights_initializer_config": null, "fcnet_bias_initializer": null, "fcnet_bias_initializer_config": null, "conv_filters": null, "conv_activation": "relu", "conv_kernel_initializer": null, "conv_kernel_initializer_config": null, "conv_bias_initializer": null, "conv_bias_initializer_config": null, "conv_transpose_kernel_initializer": null, "conv_transpose_kernel_initializer_config": null, "conv_transpose_bias_initializer": null, "conv_transpose_bias_initializer_config": null, "post_fcnet_hiddens": [], "post_fcnet_activation": "relu", "post_fcnet_weights_initializer": null, "post_fcnet_weights_initializer_config": null, "post_fcnet_bias_initializer": null, "post_fcnet_bias_initializer_config": null, "free_log_std": false, "log_std_clip_param": 20.0, "no_final_linear": false, "vf_share_layers": false, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "lstm_weights_initializer": null, "lstm_weights_initializer_config": null, "lstm_bias_initializer": null, "lstm_bias_initializer_config": null, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "attention_use_n_prev_actions": 0, "attention_use_n_prev_rewards": 0, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": null, "custom_model_config": {}, "custom_action_dist": null, "custom_preprocessor": null, "encoder_latent_dim": null, "always_check_shapes": false, "lstm_use_prev_action_reward": -1, "_use_default_native_models": -1, "_disable_preprocessor_api": false, "_disable_action_flattening": false}, "_learner_connector": null, "add_default_connectors_to_learner_pipeline": true, "learner_config_dict": {}, "optimizer": {}, "_learner_class": null, "callbacks_on_algorithm_init": null, "callbacks_on_env_runners_recreated": null, "callbacks_on_offline_eval_runners_recreated": null, "callbacks_on_checkpoint_loaded": null, "callbacks_on_environment_created": null, "callbacks_on_episode_created": null, "callbacks_on_episode_start": null, "callbacks_on_episode_step": null, "callbacks_on_episode_end": null, "callbacks_on_evaluate_start": null, "callbacks_on_evaluate_end": null, "callbacks_on_evaluate_offline_start": null, "callbacks_on_evaluate_offline_end": null, "callbacks_on_sample_end": null, "callbacks_on_train_result": null, "explore": true, "enable_rl_module_and_learner": true, "enable_env_runner_and_connector_v2": true, "_prior_exploration_config": {"type": "StochasticSampling"}, "count_steps_by": "env_steps", "policy_map_capacity": 100, "policy_mapping_fn": "<function AlgorithmConfig.DEFAULT_POLICY_MAPPING_FN at 0x14f2edb20>", "policies_to_train": null, "policy_states_are_swappable": false, "observation_fn": null, "offline_data_class": null, "input_read_method": "read_parquet", "input_read_method_kwargs": {}, "input_read_schema": {}, "input_read_episodes": false, "input_read_sample_batches": false, "input_read_batch_size": null, "input_filesystem": null, "input_filesystem_kwargs": {}, "input_compress_columns": ["obs", "new_obs"], "input_spaces_jsonable": true, "materialize_data": false, "materialize_mapped_data": true, "map_batches_kwargs": {}, "iter_batches_kwargs": {}, "ignore_final_observation": false, "prelearner_class": null, "prelearner_buffer_class": null, "prelearner_buffer_kwargs": {}, "prelearner_module_synch_period": 10, "dataset_num_iters_per_learner": null, "input_config": {}, "actions_in_input_normalized": false, "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_config": {}, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "output_max_rows_per_file": null, "output_write_remaining_data": false, "output_write_method": "write_parquet", "output_write_method_kwargs": {}, "output_filesystem": null, "output_filesystem_kwargs": {}, "output_write_episodes": true, "offline_sampling": false, "evaluation_interval": 1, "evaluation_duration": 20, "evaluation_duration_unit": "episodes", "evaluation_sample_timeout_s": 120.0, "evaluation_auto_duration_min_env_steps_per_sample": 100, "evaluation_auto_duration_max_env_steps_per_sample": 2000, "evaluation_parallel_to_training": false, "evaluation_force_reset_envs_before_iteration": true, "evaluation_config": null, "off_policy_estimation_methods": {}, "ope_split_batch_by_episode": true, "evaluation_num_env_runners": 1, "in_evaluation": false, "sync_filters_on_rollout_workers_timeout_s": 10.0, "offline_evaluation_interval": null, "num_offline_eval_runners": 0, "offline_loss_for_module_fn": null, "offline_evaluation_duration": 1, "offline_evaluation_parallel_to_training": false, "offline_evaluation_timeout_s": 120.0, "num_cpus_per_offline_eval_runner": 1, "num_gpus_per_offline_eval_runner": 0, "custom_resources_per_offline_eval_runner": {}, "restart_failed_offline_eval_runners": true, "ignore_offline_eval_runner_failures": false, "max_num_offline_eval_runner_restarts": 1000, "offline_eval_runner_restore_timeout_s": 1800.0, "max_requests_in_flight_per_offline_eval_runner": 1, "validate_offline_eval_runners_after_construction": true, "offline_eval_runner_health_probe_timeout_s": 30.0, "offline_eval_rl_module_inference_only": false, "broadcast_offline_eval_runner_states": false, "offline_eval_batch_size_per_runner": 256, "dataset_num_iters_per_eval_runner": 1, "keep_per_episode_custom_metrics": false, "metrics_episode_collection_timeout_s": 60.0, "metrics_num_episodes_for_smoothing": 100, "min_time_s_per_iteration": null, "min_train_timesteps_per_iteration": 0, "min_sample_timesteps_per_iteration": 0, "log_gradients": true, "export_native_model_files": false, "checkpoint_trainable_policies_only": false, "logger_creator": null, "logger_config": null, "log_level": "WARN", "log_sys_usage": true, "fake_sampler": false, "seed": 3, "restart_failed_env_runners": true, "ignore_env_runner_failures": false, "max_num_env_runner_restarts": 1000, "delay_between_env_runner_restarts_s": 60.0, "restart_failed_sub_environments": false, "num_consecutive_env_runner_failures_tolerance": 100, "env_runner_health_probe_timeout_s": 30.0, "env_runner_restore_timeout_s": 1800.0, "_model_config": {}, "_rl_module_spec": "RLModuleSpec(module_class=None, observation_space=None, action_space=None, inference_only=False, learner_only=False, model_config=DefaultModelConfig(fcnet_hiddens=[60, 90], fcnet_activation='tanh', fcnet_kernel_initializer=None, fcnet_kernel_initializer_kwargs=None, fcnet_bias_initializer=None, fcnet_bias_initializer_kwargs=None, conv_filters=None, conv_activation='relu', conv_kernel_initializer=None, conv_kernel_initializer_kwargs=None, conv_bias_initializer=None, conv_bias_initializer_kwargs=None, head_fcnet_hiddens=[], head_fcnet_activation='relu', head_fcnet_kernel_initializer=None, head_fcnet_kernel_initializer_kwargs=None, head_fcnet_bias_initializer=None, head_fcnet_bias_initializer_kwargs=None, free_log_std=False, log_std_clip_param=20.0, vf_share_layers=True, use_lstm=False, max_seq_len=20, lstm_cell_size=256, lstm_use_prev_action=False, lstm_use_prev_reward=False, lstm_kernel_initializer=None, lstm_kernel_initializer_kwargs=None, lstm_bias_initializer=None, lstm_bias_initializer_kwargs=None), catalog_class=None, load_state_path=None, model_config_dict=None)", "algorithm_config_overrides_per_module": {}, "_per_module_overrides": {}, "_validate_config": true, "_use_msgpack_checkpoints": false, "_torch_grad_scaler_class": null, "_torch_lr_scheduler_classes": null, "_tf_policy_handles_more_than_one_loss": false, "_disable_preprocessor_api": false, "_disable_action_flattening": false, "_disable_initialize_loss_from_dummy_batch": false, "_dont_auto_sync_env_runner_states": false, "env_task_fn": -1, "enable_connectors": -1, "simple_optimizer": false, "policy_map_cache": -1, "worker_cls": -1, "synchronize_filters": -1, "enable_async_evaluation": -1, "custom_async_evaluation_function": -1, "_enable_rl_module_api": -1, "auto_wrap_old_gym_envs": -1, "always_attach_evaluation_results": -1, "replay_sequence_length": null, "_disable_execution_plan_api": -1, "use_critic": true, "use_gae": true, "use_kl_loss": true, "kl_coeff": 0.7464963036515, "kl_target": 0.0270990929592, "vf_loss_coeff": 0.6688075857018, "entropy_coeff": 0.0090570820258, "clip_param": 0.1221781641624, "vf_clip_param": 0.1027808522125, "entropy_coeff_schedule": null, "lr_schedule": null, "sgd_minibatch_size": -1, "vf_share_layers": -1, "__stdout_file__": null, "__stderr_file__": null, "lambda": 0.9099046732075, "input": "sampler", "policies": {"default_policy": [null, null, null, null]}, "callbacks": "<class 'ray.rllib.callbacks.callbacks.RLlibCallback'>", "create_env_on_driver": false, "custom_eval_function": null, "framework": "torch"}, "time_since_restore": 50.23534154891968, "iterations_since_restore": 17, "perf": {"cpu_util_percent": 73.44999999999999, "ram_util_percent": 79.575}}
{"timers": {"training_iteration": 3.346306555592776, "restore_env_runners": 4.780817477130734e-05, "training_step": 3.3458734329927573, "env_runner_sampling_timer": 3.164600861762497, "learner_update_timer": 0.1762595083429738, "synch_weights": 0.0012694746684761846, "restore_eval_env_runners": 1.0814124570415595e-05, "evaluation_iteration": 0.19106217656830174, "synch_eval_env_connectors": 0.00020021249320141416, "synch_env_connectors": 6.853595595483156e-06}, "env_runners": {"episode_return_min": -13.5, "module_to_env_connector": {"connector_pipeline_timer": 0.00018269373557100517, "timers": {"connectors": {"normalize_and_clip_actions": 1.504540610207905e-05, "un_batch_to_individual_items": 8.378877575568257e-06, "remove_single_ts_time_rank_from_batch": 9.459655948808458e-07, "tensor_to_numpy": 2.2833541309773664e-05, "listify_data_for_vector_env": 1.8186093098594475e-05, "get_actions": 7.735732997828658e-05}}}, "env_step_timer": 2.4516532696882143e-05, "rlmodule_inference_timer": 5.255538271015535e-05, "env_reset_timer": 7.337730181195851e-05, "agent_episode_returns_mean": {"default_agent": 2.8199999999999994}, "num_env_steps_sampled_lifetime": -9870000.0, "weights_seq_no": 17.0, "env_to_module_sum_episodes_length_out": 10.36823839457432, "episode_len_max": 20, "env_to_module_connector": {"timers": {"connectors": {"batch_individual_items": 1.0745833766449355e-05, "numpy_to_tensor": 1.554855086652305e-05, "add_time_dim_to_batch_and_zero_pad": 3.7822107643420396e-06, "add_observations_from_episodes_to_batch": 4.722213305211965e-06, "add_states_from_episodes_to_batch": 2.4435214414883964e-06}}, "connector_pipeline_timer": 6.888586410061741e-05}, "env_to_module_sum_episodes_length_in": 10.36823839457432, "sample": 0.008607342119104244, "num_agent_steps_sampled": {"default_agent": 5000.0}, "num_module_steps_sampled": {"default_policy": 5000.0}, "num_episodes_lifetime": -493500.0, "num_module_steps_sampled_lifetime": {"default_policy": -9870000.0}, "num_agent_steps_sampled_lifetime": {"default_agent": -9870000.0}, "time_between_sampling": 0.002216656070427548, "episode_len_mean": 20.0, "episode_return_mean": 2.8199999999999994, "num_episodes": 250.0, "episode_duration_sec_mean": 0.007846561996731909, "episode_len_min": 20, "num_env_steps_sampled": 5000.0, "module_episode_returns_mean": {"default_policy": 2.8199999999999994}, "episode_return_max": 6.5, "num_env_steps_sampled_lifetime_throughput": 2396.3214136175657}, "learners": {"__all_modules__": {"learner_connector": {"timers": {"connectors": {"add_columns_from_episodes_to_train_batch": 0.039311674688799064, "add_states_from_episodes_to_batch": 4.788067919085844e-06, "add_one_ts_to_episodes_and_truncate": 0.013080180040305136, "numpy_to_tensor": 0.0001933892442691181, "batch_individual_items": 0.05141475952564084, "add_time_dim_to_batch_and_zero_pad": 1.4585824793365254e-05, "general_advantage_estimation": 0.012751756063087554, "add_observations_from_episodes_to_batch": 0.0009357394730726291}}, "connector_pipeline_timer": 0.11807067297961353}, "num_module_steps_trained": 6000, "num_non_trainable_parameters": 0, "num_module_steps_trained_lifetime": 108000, "learner_connector_sum_episodes_length_in": 5000.0, "learner_connector_sum_episodes_length_out": 5250.0, "num_env_steps_trained": 31500, "num_trainable_parameters": 6003, "num_env_steps_trained_lifetime": 567000, "num_env_steps_trained_lifetime_throughput": 1151400.5653387017, "num_module_steps_trained_throughput": 221068.57531920247, "num_module_steps_trained_lifetime_throughput": 220895.7016834661}, "default_policy": {"num_module_steps_trained": 6000, "curr_entropy_coeff": 0.0090570820258, "num_module_steps_trained_lifetime": 108000, "gradients_default_optimizer_global_norm": 0.06099133938550949, "entropy": 0.5282083749771118, "total_loss": 0.23265135288238525, "weights_seq_no": 18.0, "default_optimizer_learning_rate": 0.0002847858517, "curr_kl_coeff": 2.847657469828846e-06, "policy_loss": 0.1711471825838089, "vf_loss_unclipped": 26.49570655822754, "vf_explained_var": -0.009949445724487305, "mean_kl_loss": 0.0007358924485743046, "num_trainable_parameters": 6003, "module_train_batch_size_mean": 1000.0, "diff_num_grad_updates_vs_sampler_policy": 1.0, "vf_loss": 0.09911397844552994, "num_module_steps_trained_lifetime_throughput": 221164.27672342426}}, "num_training_step_calls_per_iteration": 1, "evaluation": {"env_runners": {"num_module_steps_sampled_lifetime": {"default_policy": 7200}, "env_step_timer": 3.0033274558592633e-05, "episode_duration_sec_mean": 0.00739187917788513, "num_module_steps_sampled": {"default_policy": 400}, "num_agent_steps_sampled_lifetime": {"default_agent": 7200}, "rlmodule_inference_timer": 6.0872681143820616e-05, "weights_seq_no": 18.0, "env_to_module_sum_episodes_length_out": 10.368238394574323, "sample": 0.1808579593517766, "episode_len_mean": 20.0, "agent_episode_returns_mean": {"default_agent": 3.4}, "env_to_module_connector": {"connector_pipeline_timer": 8.229205361321442e-05, "timers": {"connectors": {"add_observations_from_episodes_to_batch": 4.8792499971941304e-06, "add_states_from_episodes_to_batch": 2.916560371156097e-06, "numpy_to_tensor": 1.9035235813599692e-05, "batch_individual_items": 1.379635027044254e-05, "add_time_dim_to_batch_and_zero_pad": 3.889250961500748e-06}}}, "episode_return_max": 13.5, "module_to_env_connector": {"timers": {"connectors": {"tensor_to_numpy": 2.5849440293869902e-05, "listify_data_for_vector_env": 2.1984560931286163e-05, "normalize_and_clip_actions": 1.7826160548344352e-05, "un_batch_to_individual_items": 9.943645105872881e-06, "remove_single_ts_time_rank_from_batch": 9.047727509603812e-07, "get_actions": 7.965982357310567e-05}}, "connector_pipeline_timer": 0.00020108511737832412}, "env_to_module_sum_episodes_length_in": 10.368238394574323, "num_episodes_lifetime": 360, "module_episode_returns_mean": {"default_policy": 3.4}, "num_episodes": 20, "episode_len_min": 20, "num_agent_steps_sampled": {"default_agent": 400}, "episode_return_min": -12.5, "env_reset_timer": 0.0004590686245323625, "num_env_steps_sampled_lifetime": 90400, "episode_len_max": 20, "episode_return_mean": 3.4, "num_env_steps_sampled": 400, "time_between_sampling": 2.750538230241642}, "num_healthy_workers": 1, "actor_manager_num_outstanding_async_reqs": 0, "num_remote_worker_restarts": 0}, "num_env_steps_sampled_lifetime": -9870000.0, "fault_tolerance": {"num_healthy_workers": 0, "num_remote_worker_restarts": 0}, "env_runner_group": {"actor_manager_num_outstanding_async_reqs": 0}, "done": false, "training_iteration": 18, "trial_id": "469e6_00000", "date": "2025-08-11_19-33-53", "timestamp": 1754933633, "time_this_iter_s": 2.8734922409057617, "time_total_s": 53.10883378982544, "pid": 25834, "hostname": "Mac", "node_ip": "127.0.0.1", "config": {"exploration_config": {}, "extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "placement_strategy": "PACK", "num_gpus": 0, "_fake_gpus": false, "num_cpus_for_main_process": 2, "eager_tracing": true, "eager_max_retraces": 20, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "torch_compile_learner": false, "torch_compile_learner_what_to_compile": "forward_train", "torch_compile_learner_dynamo_backend": "aot_eager", "torch_compile_learner_dynamo_mode": null, "torch_compile_worker": false, "torch_compile_worker_dynamo_backend": "aot_eager", "torch_compile_worker_dynamo_mode": null, "torch_ddp_kwargs": {}, "torch_skip_nan_gradients": false, "env": "Umbrella", "env_config": {}, "observation_space": null, "action_space": null, "clip_rewards": null, "normalize_actions": true, "clip_actions": false, "_is_atari": null, "disable_env_checking": false, "render_env": false, "action_mask_key": "action_mask", "env_runner_cls": null, "num_env_runners": 0, "create_local_env_runner": true, "num_envs_per_env_runner": 1, "gym_env_vectorize_mode": "SYNC", "num_cpus_per_env_runner": 1, "num_gpus_per_env_runner": 0, "custom_resources_per_env_runner": {}, "validate_env_runners_after_construction": true, "episodes_to_numpy": true, "max_requests_in_flight_per_env_runner": 1, "sample_timeout_s": 60.0, "_env_to_module_connector": null, "add_default_connectors_to_env_to_module_pipeline": true, "_module_to_env_connector": null, "add_default_connectors_to_module_to_env_pipeline": true, "merge_env_runner_states": "training_only", "broadcast_env_runner_states": true, "episode_lookback_horizon": 1, "rollout_fragment_length": "auto", "batch_mode": "complete_episodes", "compress_observations": false, "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "enable_tf1_exec_eagerly": false, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "preprocessor_pref": "deepmind", "observation_filter": "NoFilter", "update_worker_filter_stats": true, "use_worker_filter_stats": true, "sampler_perf_stats_ema_coef": null, "_is_online": true, "num_learners": 0, "num_gpus_per_learner": 0, "num_cpus_per_learner": "auto", "num_aggregator_actors_per_learner": 0, "max_requests_in_flight_per_aggregator_actor": 3, "local_gpu_idx": 0, "max_requests_in_flight_per_learner": 3, "gamma": 1, "lr": 0.0002847858517, "grad_clip": 0.5, "grad_clip_by": "global_norm", "_train_batch_size_per_learner": 5000, "train_batch_size": 4000, "num_epochs": 1, "minibatch_size": 1000, "shuffle_batch_per_epoch": true, "model": {"fcnet_hiddens": [256, 256], "fcnet_activation": "tanh", "fcnet_weights_initializer": null, "fcnet_weights_initializer_config": null, "fcnet_bias_initializer": null, "fcnet_bias_initializer_config": null, "conv_filters": null, "conv_activation": "relu", "conv_kernel_initializer": null, "conv_kernel_initializer_config": null, "conv_bias_initializer": null, "conv_bias_initializer_config": null, "conv_transpose_kernel_initializer": null, "conv_transpose_kernel_initializer_config": null, "conv_transpose_bias_initializer": null, "conv_transpose_bias_initializer_config": null, "post_fcnet_hiddens": [], "post_fcnet_activation": "relu", "post_fcnet_weights_initializer": null, "post_fcnet_weights_initializer_config": null, "post_fcnet_bias_initializer": null, "post_fcnet_bias_initializer_config": null, "free_log_std": false, "log_std_clip_param": 20.0, "no_final_linear": false, "vf_share_layers": false, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "lstm_weights_initializer": null, "lstm_weights_initializer_config": null, "lstm_bias_initializer": null, "lstm_bias_initializer_config": null, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "attention_use_n_prev_actions": 0, "attention_use_n_prev_rewards": 0, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": null, "custom_model_config": {}, "custom_action_dist": null, "custom_preprocessor": null, "encoder_latent_dim": null, "always_check_shapes": false, "lstm_use_prev_action_reward": -1, "_use_default_native_models": -1, "_disable_preprocessor_api": false, "_disable_action_flattening": false}, "_learner_connector": null, "add_default_connectors_to_learner_pipeline": true, "learner_config_dict": {}, "optimizer": {}, "_learner_class": null, "callbacks_on_algorithm_init": null, "callbacks_on_env_runners_recreated": null, "callbacks_on_offline_eval_runners_recreated": null, "callbacks_on_checkpoint_loaded": null, "callbacks_on_environment_created": null, "callbacks_on_episode_created": null, "callbacks_on_episode_start": null, "callbacks_on_episode_step": null, "callbacks_on_episode_end": null, "callbacks_on_evaluate_start": null, "callbacks_on_evaluate_end": null, "callbacks_on_evaluate_offline_start": null, "callbacks_on_evaluate_offline_end": null, "callbacks_on_sample_end": null, "callbacks_on_train_result": null, "explore": true, "enable_rl_module_and_learner": true, "enable_env_runner_and_connector_v2": true, "_prior_exploration_config": {"type": "StochasticSampling"}, "count_steps_by": "env_steps", "policy_map_capacity": 100, "policy_mapping_fn": "<function AlgorithmConfig.DEFAULT_POLICY_MAPPING_FN at 0x14f2edb20>", "policies_to_train": null, "policy_states_are_swappable": false, "observation_fn": null, "offline_data_class": null, "input_read_method": "read_parquet", "input_read_method_kwargs": {}, "input_read_schema": {}, "input_read_episodes": false, "input_read_sample_batches": false, "input_read_batch_size": null, "input_filesystem": null, "input_filesystem_kwargs": {}, "input_compress_columns": ["obs", "new_obs"], "input_spaces_jsonable": true, "materialize_data": false, "materialize_mapped_data": true, "map_batches_kwargs": {}, "iter_batches_kwargs": {}, "ignore_final_observation": false, "prelearner_class": null, "prelearner_buffer_class": null, "prelearner_buffer_kwargs": {}, "prelearner_module_synch_period": 10, "dataset_num_iters_per_learner": null, "input_config": {}, "actions_in_input_normalized": false, "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_config": {}, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "output_max_rows_per_file": null, "output_write_remaining_data": false, "output_write_method": "write_parquet", "output_write_method_kwargs": {}, "output_filesystem": null, "output_filesystem_kwargs": {}, "output_write_episodes": true, "offline_sampling": false, "evaluation_interval": 1, "evaluation_duration": 20, "evaluation_duration_unit": "episodes", "evaluation_sample_timeout_s": 120.0, "evaluation_auto_duration_min_env_steps_per_sample": 100, "evaluation_auto_duration_max_env_steps_per_sample": 2000, "evaluation_parallel_to_training": false, "evaluation_force_reset_envs_before_iteration": true, "evaluation_config": null, "off_policy_estimation_methods": {}, "ope_split_batch_by_episode": true, "evaluation_num_env_runners": 1, "in_evaluation": false, "sync_filters_on_rollout_workers_timeout_s": 10.0, "offline_evaluation_interval": null, "num_offline_eval_runners": 0, "offline_loss_for_module_fn": null, "offline_evaluation_duration": 1, "offline_evaluation_parallel_to_training": false, "offline_evaluation_timeout_s": 120.0, "num_cpus_per_offline_eval_runner": 1, "num_gpus_per_offline_eval_runner": 0, "custom_resources_per_offline_eval_runner": {}, "restart_failed_offline_eval_runners": true, "ignore_offline_eval_runner_failures": false, "max_num_offline_eval_runner_restarts": 1000, "offline_eval_runner_restore_timeout_s": 1800.0, "max_requests_in_flight_per_offline_eval_runner": 1, "validate_offline_eval_runners_after_construction": true, "offline_eval_runner_health_probe_timeout_s": 30.0, "offline_eval_rl_module_inference_only": false, "broadcast_offline_eval_runner_states": false, "offline_eval_batch_size_per_runner": 256, "dataset_num_iters_per_eval_runner": 1, "keep_per_episode_custom_metrics": false, "metrics_episode_collection_timeout_s": 60.0, "metrics_num_episodes_for_smoothing": 100, "min_time_s_per_iteration": null, "min_train_timesteps_per_iteration": 0, "min_sample_timesteps_per_iteration": 0, "log_gradients": true, "export_native_model_files": false, "checkpoint_trainable_policies_only": false, "logger_creator": null, "logger_config": null, "log_level": "WARN", "log_sys_usage": true, "fake_sampler": false, "seed": 3, "restart_failed_env_runners": true, "ignore_env_runner_failures": false, "max_num_env_runner_restarts": 1000, "delay_between_env_runner_restarts_s": 60.0, "restart_failed_sub_environments": false, "num_consecutive_env_runner_failures_tolerance": 100, "env_runner_health_probe_timeout_s": 30.0, "env_runner_restore_timeout_s": 1800.0, "_model_config": {}, "_rl_module_spec": "RLModuleSpec(module_class=None, observation_space=None, action_space=None, inference_only=False, learner_only=False, model_config=DefaultModelConfig(fcnet_hiddens=[60, 90], fcnet_activation='tanh', fcnet_kernel_initializer=None, fcnet_kernel_initializer_kwargs=None, fcnet_bias_initializer=None, fcnet_bias_initializer_kwargs=None, conv_filters=None, conv_activation='relu', conv_kernel_initializer=None, conv_kernel_initializer_kwargs=None, conv_bias_initializer=None, conv_bias_initializer_kwargs=None, head_fcnet_hiddens=[], head_fcnet_activation='relu', head_fcnet_kernel_initializer=None, head_fcnet_kernel_initializer_kwargs=None, head_fcnet_bias_initializer=None, head_fcnet_bias_initializer_kwargs=None, free_log_std=False, log_std_clip_param=20.0, vf_share_layers=True, use_lstm=False, max_seq_len=20, lstm_cell_size=256, lstm_use_prev_action=False, lstm_use_prev_reward=False, lstm_kernel_initializer=None, lstm_kernel_initializer_kwargs=None, lstm_bias_initializer=None, lstm_bias_initializer_kwargs=None), catalog_class=None, load_state_path=None, model_config_dict=None)", "algorithm_config_overrides_per_module": {}, "_per_module_overrides": {}, "_validate_config": true, "_use_msgpack_checkpoints": false, "_torch_grad_scaler_class": null, "_torch_lr_scheduler_classes": null, "_tf_policy_handles_more_than_one_loss": false, "_disable_preprocessor_api": false, "_disable_action_flattening": false, "_disable_initialize_loss_from_dummy_batch": false, "_dont_auto_sync_env_runner_states": false, "env_task_fn": -1, "enable_connectors": -1, "simple_optimizer": false, "policy_map_cache": -1, "worker_cls": -1, "synchronize_filters": -1, "enable_async_evaluation": -1, "custom_async_evaluation_function": -1, "_enable_rl_module_api": -1, "auto_wrap_old_gym_envs": -1, "always_attach_evaluation_results": -1, "replay_sequence_length": null, "_disable_execution_plan_api": -1, "use_critic": true, "use_gae": true, "use_kl_loss": true, "kl_coeff": 0.7464963036515, "kl_target": 0.0270990929592, "vf_loss_coeff": 0.6688075857018, "entropy_coeff": 0.0090570820258, "clip_param": 0.1221781641624, "vf_clip_param": 0.1027808522125, "entropy_coeff_schedule": null, "lr_schedule": null, "sgd_minibatch_size": -1, "vf_share_layers": -1, "__stdout_file__": null, "__stderr_file__": null, "lambda": 0.9099046732075, "input": "sampler", "policies": {"default_policy": [null, null, null, null]}, "callbacks": "<class 'ray.rllib.callbacks.callbacks.RLlibCallback'>", "create_env_on_driver": false, "custom_eval_function": null, "framework": "torch"}, "time_since_restore": 53.10883378982544, "iterations_since_restore": 18, "perf": {"cpu_util_percent": 53.775, "ram_util_percent": 79.3}}
{"timers": {"training_iteration": 3.3516542171162476, "restore_env_runners": 4.739384321797991e-05, "training_step": 3.351222871583083, "env_runner_sampling_timer": 3.1677668564747337, "learner_update_timer": 0.1784223965899298, "synch_weights": 0.0012690345017154696, "restore_eval_env_runners": 1.077515265232813e-05, "evaluation_iteration": 0.19132390355220977, "synch_eval_env_connectors": 0.0001997345381987256, "synch_env_connectors": 6.824639684796264e-06}, "env_runners": {"episode_return_min": -13.5, "module_to_env_connector": {"connector_pipeline_timer": 0.0002543893336234194, "timers": {"connectors": {"normalize_and_clip_actions": 1.9630801272682685e-05, "un_batch_to_individual_items": 1.1679822344309958e-05, "remove_single_ts_time_rank_from_batch": 1.8558023193123704e-06, "tensor_to_numpy": 3.275068664952946e-05, "listify_data_for_vector_env": 2.6566147144823137e-05, "get_actions": 0.00011015373157915622}}}, "env_step_timer": 3.7309641595553254e-05, "rlmodule_inference_timer": 8.442548515166653e-05, "env_reset_timer": 9.971247563871428e-05, "agent_episode_returns_mean": {"default_agent": 3.8600000000000008}, "num_env_steps_sampled_lifetime": -10487500.0, "weights_seq_no": 18.0, "env_to_module_sum_episodes_length_out": 10.36823839457432, "episode_len_max": 20, "env_to_module_connector": {"timers": {"connectors": {"batch_individual_items": 1.4397000044344402e-05, "numpy_to_tensor": 2.350933826800516e-05, "add_time_dim_to_batch_and_zero_pad": 5.907073046895575e-06, "add_observations_from_episodes_to_batch": 6.147713547070537e-06, "add_states_from_episodes_to_batch": 3.895198328189992e-06}}, "connector_pipeline_timer": 9.534532800571543e-05}, "env_to_module_sum_episodes_length_in": 10.36823839457432, "sample": 0.01101994364543689, "num_agent_steps_sampled": {"default_agent": 5000.0}, "num_module_steps_sampled": {"default_policy": 5000.0}, "num_episodes_lifetime": -524375.0, "num_module_steps_sampled_lifetime": {"default_policy": -10487500.0}, "num_agent_steps_sampled_lifetime": {"default_agent": -10487500.0}, "time_between_sampling": 0.0032793949756881277, "episode_len_mean": 20.0, "episode_return_mean": 3.8600000000000008, "num_episodes": 250.0, "episode_duration_sec_mean": 0.011495635671541089, "episode_len_min": 20, "num_env_steps_sampled": 5000.0, "module_episode_returns_mean": {"default_policy": 3.8600000000000008}, "episode_return_max": 6.5, "num_env_steps_sampled_lifetime_throughput": 2102.7966781080395}, "learners": {"__all_modules__": {"learner_connector": {"timers": {"connectors": {"add_columns_from_episodes_to_train_batch": 0.03944190753227778, "add_states_from_episodes_to_batch": 4.83435792202723e-06, "add_one_ts_to_episodes_and_truncate": 0.013112080739558092, "numpy_to_tensor": 0.0001923511816977238, "batch_individual_items": 0.05369861317970524, "add_time_dim_to_batch_and_zero_pad": 1.877704613561808e-05, "general_advantage_estimation": 0.012726049752662762, "add_observations_from_episodes_to_batch": 0.0009523483284467325}}, "connector_pipeline_timer": 0.12050962249946535}, "num_module_steps_trained": 6000, "num_non_trainable_parameters": 0, "num_module_steps_trained_lifetime": 114000, "learner_connector_sum_episodes_length_in": 5000.0, "learner_connector_sum_episodes_length_out": 5250.0, "num_env_steps_trained": 31500, "num_trainable_parameters": 6003, "num_env_steps_trained_lifetime": 598500, "num_env_steps_trained_lifetime_throughput": 1164550.939175902, "num_module_steps_trained_throughput": 223484.041854055, "num_module_steps_trained_lifetime_throughput": 223316.68485986532}, "default_policy": {"num_module_steps_trained": 6000, "curr_entropy_coeff": 0.0090570820258, "num_module_steps_trained_lifetime": 114000, "gradients_default_optimizer_global_norm": 0.11087688058614731, "entropy": 0.5417179465293884, "total_loss": -0.024771621450781822, "weights_seq_no": 19.0, "default_optimizer_learning_rate": 0.0002847858517, "curr_kl_coeff": 1.423828734914423e-06, "policy_loss": -0.08550427854061127, "vf_loss_unclipped": 24.051631927490234, "vf_explained_var": -0.005461335182189941, "mean_kl_loss": 3.7580906791845337e-05, "num_trainable_parameters": 6003, "module_train_batch_size_mean": 1000.0, "diff_num_grad_updates_vs_sampler_policy": 1.0, "vf_loss": 0.09814337641000748, "num_module_steps_trained_lifetime_throughput": 223551.21573133447}}, "num_training_step_calls_per_iteration": 1, "evaluation": {"env_runners": {"num_module_steps_sampled_lifetime": {"default_policy": 7600}, "env_step_timer": 5.3688605146798094e-05, "episode_duration_sec_mean": 0.008573867499362677, "num_module_steps_sampled": {"default_policy": 400}, "num_agent_steps_sampled_lifetime": {"default_agent": 7600}, "rlmodule_inference_timer": 0.00012195494502764504, "weights_seq_no": 19.0, "env_to_module_sum_episodes_length_out": 10.368238394574323, "sample": 0.18229165600747943, "episode_len_mean": 20.0, "agent_episode_returns_mean": {"default_agent": 3.6}, "env_to_module_connector": {"connector_pipeline_timer": 0.0001390462854962294, "timers": {"connectors": {"add_observations_from_episodes_to_batch": 8.183452299522515e-06, "add_states_from_episodes_to_batch": 6.410127006374174e-06, "numpy_to_tensor": 4.187354826083865e-05, "batch_individual_items": 2.2427854160911066e-05, "add_time_dim_to_batch_and_zero_pad": 7.497737712923515e-06}}}, "episode_return_max": 13.5, "module_to_env_connector": {"timers": {"connectors": {"tensor_to_numpy": 5.47096164240124e-05, "listify_data_for_vector_env": 4.615720100188867e-05, "normalize_and_clip_actions": 2.9160050059756164e-05, "un_batch_to_individual_items": 1.625409328369098e-05, "remove_single_ts_time_rank_from_batch": 1.910375883807803e-06, "get_actions": 0.00016886969769570098}}, "connector_pipeline_timer": 0.000395948268224541}, "env_to_module_sum_episodes_length_in": 10.368238394574323, "num_episodes_lifetime": 380, "module_episode_returns_mean": {"default_policy": 3.6}, "num_episodes": 20, "episode_len_min": 20, "num_agent_steps_sampled": {"default_agent": 400}, "episode_return_min": -12.5, "env_reset_timer": 0.00045581168883860533, "num_env_steps_sampled_lifetime": 95400, "episode_len_max": 20, "episode_return_mean": 3.6, "num_env_steps_sampled": 400, "time_between_sampling": 2.7621448008582727}, "num_healthy_workers": 1, "actor_manager_num_outstanding_async_reqs": 0, "num_remote_worker_restarts": 0}, "num_env_steps_sampled_lifetime": -10487500.0, "fault_tolerance": {"num_healthy_workers": 0, "num_remote_worker_restarts": 0}, "env_runner_group": {"actor_manager_num_outstanding_async_reqs": 0}, "done": false, "training_iteration": 19, "trial_id": "469e6_00000", "date": "2025-08-11_19-33-57", "timestamp": 1754933637, "time_this_iter_s": 4.226954936981201, "time_total_s": 57.33578872680664, "pid": 25834, "hostname": "Mac", "node_ip": "127.0.0.1", "config": {"exploration_config": {}, "extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "placement_strategy": "PACK", "num_gpus": 0, "_fake_gpus": false, "num_cpus_for_main_process": 2, "eager_tracing": true, "eager_max_retraces": 20, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "torch_compile_learner": false, "torch_compile_learner_what_to_compile": "forward_train", "torch_compile_learner_dynamo_backend": "aot_eager", "torch_compile_learner_dynamo_mode": null, "torch_compile_worker": false, "torch_compile_worker_dynamo_backend": "aot_eager", "torch_compile_worker_dynamo_mode": null, "torch_ddp_kwargs": {}, "torch_skip_nan_gradients": false, "env": "Umbrella", "env_config": {}, "observation_space": null, "action_space": null, "clip_rewards": null, "normalize_actions": true, "clip_actions": false, "_is_atari": null, "disable_env_checking": false, "render_env": false, "action_mask_key": "action_mask", "env_runner_cls": null, "num_env_runners": 0, "create_local_env_runner": true, "num_envs_per_env_runner": 1, "gym_env_vectorize_mode": "SYNC", "num_cpus_per_env_runner": 1, "num_gpus_per_env_runner": 0, "custom_resources_per_env_runner": {}, "validate_env_runners_after_construction": true, "episodes_to_numpy": true, "max_requests_in_flight_per_env_runner": 1, "sample_timeout_s": 60.0, "_env_to_module_connector": null, "add_default_connectors_to_env_to_module_pipeline": true, "_module_to_env_connector": null, "add_default_connectors_to_module_to_env_pipeline": true, "merge_env_runner_states": "training_only", "broadcast_env_runner_states": true, "episode_lookback_horizon": 1, "rollout_fragment_length": "auto", "batch_mode": "complete_episodes", "compress_observations": false, "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "enable_tf1_exec_eagerly": false, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "preprocessor_pref": "deepmind", "observation_filter": "NoFilter", "update_worker_filter_stats": true, "use_worker_filter_stats": true, "sampler_perf_stats_ema_coef": null, "_is_online": true, "num_learners": 0, "num_gpus_per_learner": 0, "num_cpus_per_learner": "auto", "num_aggregator_actors_per_learner": 0, "max_requests_in_flight_per_aggregator_actor": 3, "local_gpu_idx": 0, "max_requests_in_flight_per_learner": 3, "gamma": 1, "lr": 0.0002847858517, "grad_clip": 0.5, "grad_clip_by": "global_norm", "_train_batch_size_per_learner": 5000, "train_batch_size": 4000, "num_epochs": 1, "minibatch_size": 1000, "shuffle_batch_per_epoch": true, "model": {"fcnet_hiddens": [256, 256], "fcnet_activation": "tanh", "fcnet_weights_initializer": null, "fcnet_weights_initializer_config": null, "fcnet_bias_initializer": null, "fcnet_bias_initializer_config": null, "conv_filters": null, "conv_activation": "relu", "conv_kernel_initializer": null, "conv_kernel_initializer_config": null, "conv_bias_initializer": null, "conv_bias_initializer_config": null, "conv_transpose_kernel_initializer": null, "conv_transpose_kernel_initializer_config": null, "conv_transpose_bias_initializer": null, "conv_transpose_bias_initializer_config": null, "post_fcnet_hiddens": [], "post_fcnet_activation": "relu", "post_fcnet_weights_initializer": null, "post_fcnet_weights_initializer_config": null, "post_fcnet_bias_initializer": null, "post_fcnet_bias_initializer_config": null, "free_log_std": false, "log_std_clip_param": 20.0, "no_final_linear": false, "vf_share_layers": false, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "lstm_weights_initializer": null, "lstm_weights_initializer_config": null, "lstm_bias_initializer": null, "lstm_bias_initializer_config": null, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "attention_use_n_prev_actions": 0, "attention_use_n_prev_rewards": 0, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": null, "custom_model_config": {}, "custom_action_dist": null, "custom_preprocessor": null, "encoder_latent_dim": null, "always_check_shapes": false, "lstm_use_prev_action_reward": -1, "_use_default_native_models": -1, "_disable_preprocessor_api": false, "_disable_action_flattening": false}, "_learner_connector": null, "add_default_connectors_to_learner_pipeline": true, "learner_config_dict": {}, "optimizer": {}, "_learner_class": null, "callbacks_on_algorithm_init": null, "callbacks_on_env_runners_recreated": null, "callbacks_on_offline_eval_runners_recreated": null, "callbacks_on_checkpoint_loaded": null, "callbacks_on_environment_created": null, "callbacks_on_episode_created": null, "callbacks_on_episode_start": null, "callbacks_on_episode_step": null, "callbacks_on_episode_end": null, "callbacks_on_evaluate_start": null, "callbacks_on_evaluate_end": null, "callbacks_on_evaluate_offline_start": null, "callbacks_on_evaluate_offline_end": null, "callbacks_on_sample_end": null, "callbacks_on_train_result": null, "explore": true, "enable_rl_module_and_learner": true, "enable_env_runner_and_connector_v2": true, "_prior_exploration_config": {"type": "StochasticSampling"}, "count_steps_by": "env_steps", "policy_map_capacity": 100, "policy_mapping_fn": "<function AlgorithmConfig.DEFAULT_POLICY_MAPPING_FN at 0x14f2edb20>", "policies_to_train": null, "policy_states_are_swappable": false, "observation_fn": null, "offline_data_class": null, "input_read_method": "read_parquet", "input_read_method_kwargs": {}, "input_read_schema": {}, "input_read_episodes": false, "input_read_sample_batches": false, "input_read_batch_size": null, "input_filesystem": null, "input_filesystem_kwargs": {}, "input_compress_columns": ["obs", "new_obs"], "input_spaces_jsonable": true, "materialize_data": false, "materialize_mapped_data": true, "map_batches_kwargs": {}, "iter_batches_kwargs": {}, "ignore_final_observation": false, "prelearner_class": null, "prelearner_buffer_class": null, "prelearner_buffer_kwargs": {}, "prelearner_module_synch_period": 10, "dataset_num_iters_per_learner": null, "input_config": {}, "actions_in_input_normalized": false, "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_config": {}, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "output_max_rows_per_file": null, "output_write_remaining_data": false, "output_write_method": "write_parquet", "output_write_method_kwargs": {}, "output_filesystem": null, "output_filesystem_kwargs": {}, "output_write_episodes": true, "offline_sampling": false, "evaluation_interval": 1, "evaluation_duration": 20, "evaluation_duration_unit": "episodes", "evaluation_sample_timeout_s": 120.0, "evaluation_auto_duration_min_env_steps_per_sample": 100, "evaluation_auto_duration_max_env_steps_per_sample": 2000, "evaluation_parallel_to_training": false, "evaluation_force_reset_envs_before_iteration": true, "evaluation_config": null, "off_policy_estimation_methods": {}, "ope_split_batch_by_episode": true, "evaluation_num_env_runners": 1, "in_evaluation": false, "sync_filters_on_rollout_workers_timeout_s": 10.0, "offline_evaluation_interval": null, "num_offline_eval_runners": 0, "offline_loss_for_module_fn": null, "offline_evaluation_duration": 1, "offline_evaluation_parallel_to_training": false, "offline_evaluation_timeout_s": 120.0, "num_cpus_per_offline_eval_runner": 1, "num_gpus_per_offline_eval_runner": 0, "custom_resources_per_offline_eval_runner": {}, "restart_failed_offline_eval_runners": true, "ignore_offline_eval_runner_failures": false, "max_num_offline_eval_runner_restarts": 1000, "offline_eval_runner_restore_timeout_s": 1800.0, "max_requests_in_flight_per_offline_eval_runner": 1, "validate_offline_eval_runners_after_construction": true, "offline_eval_runner_health_probe_timeout_s": 30.0, "offline_eval_rl_module_inference_only": false, "broadcast_offline_eval_runner_states": false, "offline_eval_batch_size_per_runner": 256, "dataset_num_iters_per_eval_runner": 1, "keep_per_episode_custom_metrics": false, "metrics_episode_collection_timeout_s": 60.0, "metrics_num_episodes_for_smoothing": 100, "min_time_s_per_iteration": null, "min_train_timesteps_per_iteration": 0, "min_sample_timesteps_per_iteration": 0, "log_gradients": true, "export_native_model_files": false, "checkpoint_trainable_policies_only": false, "logger_creator": null, "logger_config": null, "log_level": "WARN", "log_sys_usage": true, "fake_sampler": false, "seed": 3, "restart_failed_env_runners": true, "ignore_env_runner_failures": false, "max_num_env_runner_restarts": 1000, "delay_between_env_runner_restarts_s": 60.0, "restart_failed_sub_environments": false, "num_consecutive_env_runner_failures_tolerance": 100, "env_runner_health_probe_timeout_s": 30.0, "env_runner_restore_timeout_s": 1800.0, "_model_config": {}, "_rl_module_spec": "RLModuleSpec(module_class=None, observation_space=None, action_space=None, inference_only=False, learner_only=False, model_config=DefaultModelConfig(fcnet_hiddens=[60, 90], fcnet_activation='tanh', fcnet_kernel_initializer=None, fcnet_kernel_initializer_kwargs=None, fcnet_bias_initializer=None, fcnet_bias_initializer_kwargs=None, conv_filters=None, conv_activation='relu', conv_kernel_initializer=None, conv_kernel_initializer_kwargs=None, conv_bias_initializer=None, conv_bias_initializer_kwargs=None, head_fcnet_hiddens=[], head_fcnet_activation='relu', head_fcnet_kernel_initializer=None, head_fcnet_kernel_initializer_kwargs=None, head_fcnet_bias_initializer=None, head_fcnet_bias_initializer_kwargs=None, free_log_std=False, log_std_clip_param=20.0, vf_share_layers=True, use_lstm=False, max_seq_len=20, lstm_cell_size=256, lstm_use_prev_action=False, lstm_use_prev_reward=False, lstm_kernel_initializer=None, lstm_kernel_initializer_kwargs=None, lstm_bias_initializer=None, lstm_bias_initializer_kwargs=None), catalog_class=None, load_state_path=None, model_config_dict=None)", "algorithm_config_overrides_per_module": {}, "_per_module_overrides": {}, "_validate_config": true, "_use_msgpack_checkpoints": false, "_torch_grad_scaler_class": null, "_torch_lr_scheduler_classes": null, "_tf_policy_handles_more_than_one_loss": false, "_disable_preprocessor_api": false, "_disable_action_flattening": false, "_disable_initialize_loss_from_dummy_batch": false, "_dont_auto_sync_env_runner_states": false, "env_task_fn": -1, "enable_connectors": -1, "simple_optimizer": false, "policy_map_cache": -1, "worker_cls": -1, "synchronize_filters": -1, "enable_async_evaluation": -1, "custom_async_evaluation_function": -1, "_enable_rl_module_api": -1, "auto_wrap_old_gym_envs": -1, "always_attach_evaluation_results": -1, "replay_sequence_length": null, "_disable_execution_plan_api": -1, "use_critic": true, "use_gae": true, "use_kl_loss": true, "kl_coeff": 0.7464963036515, "kl_target": 0.0270990929592, "vf_loss_coeff": 0.6688075857018, "entropy_coeff": 0.0090570820258, "clip_param": 0.1221781641624, "vf_clip_param": 0.1027808522125, "entropy_coeff_schedule": null, "lr_schedule": null, "sgd_minibatch_size": -1, "vf_share_layers": -1, "__stdout_file__": null, "__stderr_file__": null, "lambda": 0.9099046732075, "input": "sampler", "policies": {"default_policy": [null, null, null, null]}, "callbacks": "<class 'ray.rllib.callbacks.callbacks.RLlibCallback'>", "create_env_on_driver": false, "custom_eval_function": null, "framework": "torch"}, "time_since_restore": 57.33578872680664, "iterations_since_restore": 19, "perf": {"cpu_util_percent": 80.11666666666667, "ram_util_percent": 81.23333333333333}}
{"timers": {"training_iteration": 3.3526325836951423, "restore_env_runners": 4.698240467962934e-05, "training_step": 3.352200049957257, "env_runner_sampling_timer": 3.1686874320794804, "learner_update_timer": 0.17848520512469426, "synch_weights": 0.0012658358168648467, "restore_eval_env_runners": 1.0781150536761947e-05, "evaluation_iteration": 0.19283164743632106, "synch_eval_env_connectors": 0.00020240511311002478, "synch_env_connectors": 6.807642805076173e-06}, "env_runners": {"episode_return_min": -13.5, "module_to_env_connector": {"connector_pipeline_timer": 0.0002553067148717086, "timers": {"connectors": {"normalize_and_clip_actions": 1.9614996788831376e-05, "un_batch_to_individual_items": 1.086937498558541e-05, "remove_single_ts_time_rank_from_batch": 1.2464787400070204e-06, "tensor_to_numpy": 3.17282312295866e-05, "listify_data_for_vector_env": 2.5367066803465032e-05, "get_actions": 0.00011449524003738361}}}, "env_step_timer": 3.4028608026516404e-05, "rlmodule_inference_timer": 7.43700313307191e-05, "env_reset_timer": 0.00010119080789956142, "agent_episode_returns_mean": {"default_agent": 3.62}, "num_env_steps_sampled_lifetime": -11105000.0, "weights_seq_no": 19.0, "env_to_module_sum_episodes_length_out": 10.36823839457432, "episode_len_max": 20, "env_to_module_connector": {"timers": {"connectors": {"batch_individual_items": 1.514370012764186e-05, "numpy_to_tensor": 2.2979818978026558e-05, "add_time_dim_to_batch_and_zero_pad": 5.730615048425761e-06, "add_observations_from_episodes_to_batch": 6.9643616263657184e-06, "add_states_from_episodes_to_batch": 3.4473488996743806e-06}}, "connector_pipeline_timer": 9.562760405704368e-05}, "env_to_module_sum_episodes_length_in": 10.36823839457432, "sample": 0.01160676307756829, "num_agent_steps_sampled": {"default_agent": 5000.0}, "num_module_steps_sampled": {"default_policy": 5000.0}, "num_episodes_lifetime": -555250.0, "num_module_steps_sampled_lifetime": {"default_policy": -11105000.0}, "num_agent_steps_sampled_lifetime": {"default_agent": -11105000.0}, "time_between_sampling": 0.004604391157052099, "episode_len_mean": 20.0, "episode_return_mean": 3.62, "num_episodes": 250.0, "episode_duration_sec_mean": 0.0108967710020952, "episode_len_min": 20, "num_env_steps_sampled": 5000.0, "module_episode_returns_mean": {"default_policy": 3.62}, "episode_return_max": 6.5, "num_env_steps_sampled_lifetime_throughput": 1872.3681205731923}, "learners": {"__all_modules__": {"learner_connector": {"timers": {"connectors": {"add_columns_from_episodes_to_train_batch": 0.03968748428708856, "add_states_from_episodes_to_batch": 4.821434868626021e-06, "add_one_ts_to_episodes_and_truncate": 0.013217747852747413, "numpy_to_tensor": 0.0001918430892730343, "batch_individual_items": 0.053711254547330244, "add_time_dim_to_batch_and_zero_pad": 1.871302632551715e-05, "general_advantage_estimation": 0.012709072164726885, "add_observations_from_episodes_to_batch": 0.0009689777649073379}}, "connector_pipeline_timer": 0.12087093919483581}, "num_module_steps_trained": 6000, "num_non_trainable_parameters": 0, "num_module_steps_trained_lifetime": 120000, "learner_connector_sum_episodes_length_in": 5000.0, "learner_connector_sum_episodes_length_out": 5250.0, "num_env_steps_trained": 31500, "num_trainable_parameters": 6003, "num_env_steps_trained_lifetime": 630000, "num_env_steps_trained_lifetime_throughput": 1172567.5668314944, "num_module_steps_trained_throughput": 224938.25652215938, "num_module_steps_trained_lifetime_throughput": 224773.28928409275}, "default_policy": {"num_module_steps_trained": 6000, "curr_entropy_coeff": 0.0090570820258, "num_module_steps_trained_lifetime": 120000, "gradients_default_optimizer_global_norm": 0.08247192203998566, "entropy": 0.5321364998817444, "total_loss": 0.1188291683793068, "weights_seq_no": 20.0, "default_optimizer_learning_rate": 0.0002847858517, "curr_kl_coeff": 7.119143674572115e-07, "policy_loss": 0.05764909088611603, "vf_loss_unclipped": 25.19484519958496, "vf_explained_var": -0.007982969284057617, "mean_kl_loss": 3.7657540815416723e-05, "num_trainable_parameters": 6003, "module_train_batch_size_mean": 1000.0, "diff_num_grad_updates_vs_sampler_policy": 1.0, "vf_loss": 0.09868261218070984, "num_module_steps_trained_lifetime_throughput": 224974.5230885909}}, "num_training_step_calls_per_iteration": 1, "evaluation": {"env_runners": {"num_module_steps_sampled_lifetime": {"default_policy": 8000}, "env_step_timer": 2.3690349601730935e-05, "episode_duration_sec_mean": 0.00877202335977927, "num_module_steps_sampled": {"default_policy": 400}, "num_agent_steps_sampled_lifetime": {"default_agent": 8000}, "rlmodule_inference_timer": 4.8801874686326694e-05, "weights_seq_no": 20.0, "env_to_module_sum_episodes_length_out": 10.368238394574323, "sample": 0.18208543194736074, "episode_len_mean": 20.0, "agent_episode_returns_mean": {"default_agent": 4.2}, "env_to_module_connector": {"connector_pipeline_timer": 6.496226594995449e-05, "timers": {"connectors": {"add_observations_from_episodes_to_batch": 4.666871163782115e-06, "add_states_from_episodes_to_batch": 2.095369936814816e-06, "numpy_to_tensor": 1.3842371340020059e-05, "batch_individual_items": 9.718758375175816e-06, "add_time_dim_to_batch_and_zero_pad": 4.122114002268762e-06}}}, "episode_return_max": 13.5, "module_to_env_connector": {"timers": {"connectors": {"tensor_to_numpy": 2.254868810030345e-05, "listify_data_for_vector_env": 1.79116624799829e-05, "normalize_and_clip_actions": 1.4852294570030028e-05, "un_batch_to_individual_items": 7.78079214393318e-06, "remove_single_ts_time_rank_from_batch": 8.100190307345391e-07, "get_actions": 6.46965386995671e-05}}, "connector_pipeline_timer": 0.00016825485299639986}, "env_to_module_sum_episodes_length_in": 10.368238394574323, "num_episodes_lifetime": 400, "module_episode_returns_mean": {"default_policy": 4.2}, "num_episodes": 20, "episode_len_min": 20, "num_agent_steps_sampled": {"default_agent": 400}, "episode_return_min": -12.5, "env_reset_timer": 0.000454674821516819, "num_env_steps_sampled_lifetime": 100400, "episode_len_max": 20, "episode_return_mean": 4.2, "num_env_steps_sampled": 400, "time_between_sampling": 2.7696615265991276}, "num_healthy_workers": 1, "actor_manager_num_outstanding_async_reqs": 0, "num_remote_worker_restarts": 0}, "num_env_steps_sampled_lifetime": -11105000.0, "fault_tolerance": {"num_healthy_workers": 0, "num_remote_worker_restarts": 0}, "env_runner_group": {"actor_manager_num_outstanding_async_reqs": 0}, "done": true, "training_iteration": 20, "trial_id": "469e6_00000", "date": "2025-08-11_19-34-01", "timestamp": 1754933641, "time_this_iter_s": 3.6248366832733154, "time_total_s": 60.960625410079956, "pid": 25834, "hostname": "Mac", "node_ip": "127.0.0.1", "config": {"exploration_config": {}, "extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "placement_strategy": "PACK", "num_gpus": 0, "_fake_gpus": false, "num_cpus_for_main_process": 2, "eager_tracing": true, "eager_max_retraces": 20, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "torch_compile_learner": false, "torch_compile_learner_what_to_compile": "forward_train", "torch_compile_learner_dynamo_backend": "aot_eager", "torch_compile_learner_dynamo_mode": null, "torch_compile_worker": false, "torch_compile_worker_dynamo_backend": "aot_eager", "torch_compile_worker_dynamo_mode": null, "torch_ddp_kwargs": {}, "torch_skip_nan_gradients": false, "env": "Umbrella", "env_config": {}, "observation_space": null, "action_space": null, "clip_rewards": null, "normalize_actions": true, "clip_actions": false, "_is_atari": null, "disable_env_checking": false, "render_env": false, "action_mask_key": "action_mask", "env_runner_cls": null, "num_env_runners": 0, "create_local_env_runner": true, "num_envs_per_env_runner": 1, "gym_env_vectorize_mode": "SYNC", "num_cpus_per_env_runner": 1, "num_gpus_per_env_runner": 0, "custom_resources_per_env_runner": {}, "validate_env_runners_after_construction": true, "episodes_to_numpy": true, "max_requests_in_flight_per_env_runner": 1, "sample_timeout_s": 60.0, "_env_to_module_connector": null, "add_default_connectors_to_env_to_module_pipeline": true, "_module_to_env_connector": null, "add_default_connectors_to_module_to_env_pipeline": true, "merge_env_runner_states": "training_only", "broadcast_env_runner_states": true, "episode_lookback_horizon": 1, "rollout_fragment_length": "auto", "batch_mode": "complete_episodes", "compress_observations": false, "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "enable_tf1_exec_eagerly": false, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "preprocessor_pref": "deepmind", "observation_filter": "NoFilter", "update_worker_filter_stats": true, "use_worker_filter_stats": true, "sampler_perf_stats_ema_coef": null, "_is_online": true, "num_learners": 0, "num_gpus_per_learner": 0, "num_cpus_per_learner": "auto", "num_aggregator_actors_per_learner": 0, "max_requests_in_flight_per_aggregator_actor": 3, "local_gpu_idx": 0, "max_requests_in_flight_per_learner": 3, "gamma": 1, "lr": 0.0002847858517, "grad_clip": 0.5, "grad_clip_by": "global_norm", "_train_batch_size_per_learner": 5000, "train_batch_size": 4000, "num_epochs": 1, "minibatch_size": 1000, "shuffle_batch_per_epoch": true, "model": {"fcnet_hiddens": [256, 256], "fcnet_activation": "tanh", "fcnet_weights_initializer": null, "fcnet_weights_initializer_config": null, "fcnet_bias_initializer": null, "fcnet_bias_initializer_config": null, "conv_filters": null, "conv_activation": "relu", "conv_kernel_initializer": null, "conv_kernel_initializer_config": null, "conv_bias_initializer": null, "conv_bias_initializer_config": null, "conv_transpose_kernel_initializer": null, "conv_transpose_kernel_initializer_config": null, "conv_transpose_bias_initializer": null, "conv_transpose_bias_initializer_config": null, "post_fcnet_hiddens": [], "post_fcnet_activation": "relu", "post_fcnet_weights_initializer": null, "post_fcnet_weights_initializer_config": null, "post_fcnet_bias_initializer": null, "post_fcnet_bias_initializer_config": null, "free_log_std": false, "log_std_clip_param": 20.0, "no_final_linear": false, "vf_share_layers": false, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "lstm_weights_initializer": null, "lstm_weights_initializer_config": null, "lstm_bias_initializer": null, "lstm_bias_initializer_config": null, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "attention_use_n_prev_actions": 0, "attention_use_n_prev_rewards": 0, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": null, "custom_model_config": {}, "custom_action_dist": null, "custom_preprocessor": null, "encoder_latent_dim": null, "always_check_shapes": false, "lstm_use_prev_action_reward": -1, "_use_default_native_models": -1, "_disable_preprocessor_api": false, "_disable_action_flattening": false}, "_learner_connector": null, "add_default_connectors_to_learner_pipeline": true, "learner_config_dict": {}, "optimizer": {}, "_learner_class": null, "callbacks_on_algorithm_init": null, "callbacks_on_env_runners_recreated": null, "callbacks_on_offline_eval_runners_recreated": null, "callbacks_on_checkpoint_loaded": null, "callbacks_on_environment_created": null, "callbacks_on_episode_created": null, "callbacks_on_episode_start": null, "callbacks_on_episode_step": null, "callbacks_on_episode_end": null, "callbacks_on_evaluate_start": null, "callbacks_on_evaluate_end": null, "callbacks_on_evaluate_offline_start": null, "callbacks_on_evaluate_offline_end": null, "callbacks_on_sample_end": null, "callbacks_on_train_result": null, "explore": true, "enable_rl_module_and_learner": true, "enable_env_runner_and_connector_v2": true, "_prior_exploration_config": {"type": "StochasticSampling"}, "count_steps_by": "env_steps", "policy_map_capacity": 100, "policy_mapping_fn": "<function AlgorithmConfig.DEFAULT_POLICY_MAPPING_FN at 0x14f2edb20>", "policies_to_train": null, "policy_states_are_swappable": false, "observation_fn": null, "offline_data_class": null, "input_read_method": "read_parquet", "input_read_method_kwargs": {}, "input_read_schema": {}, "input_read_episodes": false, "input_read_sample_batches": false, "input_read_batch_size": null, "input_filesystem": null, "input_filesystem_kwargs": {}, "input_compress_columns": ["obs", "new_obs"], "input_spaces_jsonable": true, "materialize_data": false, "materialize_mapped_data": true, "map_batches_kwargs": {}, "iter_batches_kwargs": {}, "ignore_final_observation": false, "prelearner_class": null, "prelearner_buffer_class": null, "prelearner_buffer_kwargs": {}, "prelearner_module_synch_period": 10, "dataset_num_iters_per_learner": null, "input_config": {}, "actions_in_input_normalized": false, "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_config": {}, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "output_max_rows_per_file": null, "output_write_remaining_data": false, "output_write_method": "write_parquet", "output_write_method_kwargs": {}, "output_filesystem": null, "output_filesystem_kwargs": {}, "output_write_episodes": true, "offline_sampling": false, "evaluation_interval": 1, "evaluation_duration": 20, "evaluation_duration_unit": "episodes", "evaluation_sample_timeout_s": 120.0, "evaluation_auto_duration_min_env_steps_per_sample": 100, "evaluation_auto_duration_max_env_steps_per_sample": 2000, "evaluation_parallel_to_training": false, "evaluation_force_reset_envs_before_iteration": true, "evaluation_config": null, "off_policy_estimation_methods": {}, "ope_split_batch_by_episode": true, "evaluation_num_env_runners": 1, "in_evaluation": false, "sync_filters_on_rollout_workers_timeout_s": 10.0, "offline_evaluation_interval": null, "num_offline_eval_runners": 0, "offline_loss_for_module_fn": null, "offline_evaluation_duration": 1, "offline_evaluation_parallel_to_training": false, "offline_evaluation_timeout_s": 120.0, "num_cpus_per_offline_eval_runner": 1, "num_gpus_per_offline_eval_runner": 0, "custom_resources_per_offline_eval_runner": {}, "restart_failed_offline_eval_runners": true, "ignore_offline_eval_runner_failures": false, "max_num_offline_eval_runner_restarts": 1000, "offline_eval_runner_restore_timeout_s": 1800.0, "max_requests_in_flight_per_offline_eval_runner": 1, "validate_offline_eval_runners_after_construction": true, "offline_eval_runner_health_probe_timeout_s": 30.0, "offline_eval_rl_module_inference_only": false, "broadcast_offline_eval_runner_states": false, "offline_eval_batch_size_per_runner": 256, "dataset_num_iters_per_eval_runner": 1, "keep_per_episode_custom_metrics": false, "metrics_episode_collection_timeout_s": 60.0, "metrics_num_episodes_for_smoothing": 100, "min_time_s_per_iteration": null, "min_train_timesteps_per_iteration": 0, "min_sample_timesteps_per_iteration": 0, "log_gradients": true, "export_native_model_files": false, "checkpoint_trainable_policies_only": false, "logger_creator": null, "logger_config": null, "log_level": "WARN", "log_sys_usage": true, "fake_sampler": false, "seed": 3, "restart_failed_env_runners": true, "ignore_env_runner_failures": false, "max_num_env_runner_restarts": 1000, "delay_between_env_runner_restarts_s": 60.0, "restart_failed_sub_environments": false, "num_consecutive_env_runner_failures_tolerance": 100, "env_runner_health_probe_timeout_s": 30.0, "env_runner_restore_timeout_s": 1800.0, "_model_config": {}, "_rl_module_spec": "RLModuleSpec(module_class=None, observation_space=None, action_space=None, inference_only=False, learner_only=False, model_config=DefaultModelConfig(fcnet_hiddens=[60, 90], fcnet_activation='tanh', fcnet_kernel_initializer=None, fcnet_kernel_initializer_kwargs=None, fcnet_bias_initializer=None, fcnet_bias_initializer_kwargs=None, conv_filters=None, conv_activation='relu', conv_kernel_initializer=None, conv_kernel_initializer_kwargs=None, conv_bias_initializer=None, conv_bias_initializer_kwargs=None, head_fcnet_hiddens=[], head_fcnet_activation='relu', head_fcnet_kernel_initializer=None, head_fcnet_kernel_initializer_kwargs=None, head_fcnet_bias_initializer=None, head_fcnet_bias_initializer_kwargs=None, free_log_std=False, log_std_clip_param=20.0, vf_share_layers=True, use_lstm=False, max_seq_len=20, lstm_cell_size=256, lstm_use_prev_action=False, lstm_use_prev_reward=False, lstm_kernel_initializer=None, lstm_kernel_initializer_kwargs=None, lstm_bias_initializer=None, lstm_bias_initializer_kwargs=None), catalog_class=None, load_state_path=None, model_config_dict=None)", "algorithm_config_overrides_per_module": {}, "_per_module_overrides": {}, "_validate_config": true, "_use_msgpack_checkpoints": false, "_torch_grad_scaler_class": null, "_torch_lr_scheduler_classes": null, "_tf_policy_handles_more_than_one_loss": false, "_disable_preprocessor_api": false, "_disable_action_flattening": false, "_disable_initialize_loss_from_dummy_batch": false, "_dont_auto_sync_env_runner_states": false, "env_task_fn": -1, "enable_connectors": -1, "simple_optimizer": false, "policy_map_cache": -1, "worker_cls": -1, "synchronize_filters": -1, "enable_async_evaluation": -1, "custom_async_evaluation_function": -1, "_enable_rl_module_api": -1, "auto_wrap_old_gym_envs": -1, "always_attach_evaluation_results": -1, "replay_sequence_length": null, "_disable_execution_plan_api": -1, "use_critic": true, "use_gae": true, "use_kl_loss": true, "kl_coeff": 0.7464963036515, "kl_target": 0.0270990929592, "vf_loss_coeff": 0.6688075857018, "entropy_coeff": 0.0090570820258, "clip_param": 0.1221781641624, "vf_clip_param": 0.1027808522125, "entropy_coeff_schedule": null, "lr_schedule": null, "sgd_minibatch_size": -1, "vf_share_layers": -1, "__stdout_file__": null, "__stderr_file__": null, "lambda": 0.9099046732075, "input": "sampler", "policies": {"default_policy": [null, null, null, null]}, "callbacks": "<class 'ray.rllib.callbacks.callbacks.RLlibCallback'>", "create_env_on_driver": false, "custom_eval_function": null, "framework": "torch"}, "time_since_restore": 60.960625410079956, "iterations_since_restore": 20, "perf": {"cpu_util_percent": 61.4, "ram_util_percent": 79.56}}
