{"timers": {"training_iteration": 1.5564495000289753, "restore_env_runners": 9.958050213754177e-06, "training_step": 1.5563320409273729, "env_runner_sampling_timer": 1.4481153750093654, "learner_update_timer": 0.10528316593263298, "synch_weights": 0.0005985000170767307}, "env_runners": {"num_episodes_lifetime": 31375.0, "episode_len_mean": 20.0, "env_to_module_connector": {"timers": {"connectors": {"batch_individual_items": 6.416637448871779e-06, "add_observations_from_episodes_to_batch": 3.1418420991376882e-06, "add_states_from_episodes_to_batch": 1.7461321399808539e-06, "numpy_to_tensor": 9.341292731808643e-06, "add_time_dim_to_batch_and_zero_pad": 2.5000799797266703e-06}}, "connector_pipeline_timer": 4.7565959594439306e-05}, "agent_episode_returns_mean": {"default_agent": 2.899999999999998}, "episode_return_max": 12.5, "num_module_steps_sampled_lifetime": {"default_policy": 627500.0}, "env_step_timer": 1.4900450206999972e-05, "module_to_env_connector": {"timers": {"connectors": {"listify_data_for_vector_env": 1.1353809890983509e-05, "remove_single_ts_time_rank_from_batch": 5.971155401276567e-07, "tensor_to_numpy": 1.3592640655690192e-05, "un_batch_to_individual_items": 5.495213303602234e-06, "get_actions": 4.379663450062399e-05, "normalize_and_clip_actions": 1.4170823997543251e-05}}, "connector_pipeline_timer": 0.00011508658058052013}, "module_episode_returns_mean": {"default_policy": 2.899999999999998}, "num_env_steps_sampled_lifetime": 627500.0, "episode_len_min": 20, "episode_return_min": -7.5, "time_between_sampling": 0.0005267427314292494, "num_env_steps_sampled": 5000.0, "num_module_steps_sampled": {"default_policy": 5000.0}, "num_episodes": 250.0, "episode_len_max": 20, "num_agent_steps_sampled": {"default_agent": 5000.0}, "episode_duration_sec_mean": 0.004856127759907396, "env_to_module_sum_episodes_length_in": 10.191744832559449, "num_agent_steps_sampled_lifetime": {"default_agent": 627500.0}, "env_to_module_sum_episodes_length_out": 10.191744832559449, "rlmodule_inference_timer": 4.823156100441752e-05, "episode_return_mean": 2.899999999999998, "sample": 0.0059113392833868164, "env_reset_timer": 9.594290218125334e-05, "weights_seq_no": 0.0, "num_env_steps_sampled_lifetime_throughput": 3532.420593036701}, "learners": {"__all_modules__": {"num_non_trainable_parameters": 0, "learner_connector": {"timers": {"connectors": {"add_time_dim_to_batch_and_zero_pad": 9.874929673969746e-06, "batch_individual_items": 0.029731874936260283, "add_one_ts_to_episodes_and_truncate": 0.007657665992155671, "general_advantage_estimation": 0.007666707970201969, "numpy_to_tensor": 6.737501826137304e-05, "add_observations_from_episodes_to_batch": 0.0008026250870898366, "add_states_from_episodes_to_batch": 3.208988346159458e-06, "add_columns_from_episodes_to_train_batch": 0.03427258296869695}}, "connector_pipeline_timer": 0.08032683411147445}, "num_env_steps_trained_lifetime": 31500, "num_env_steps_trained": 31500, "num_module_steps_trained_lifetime": 6000, "num_module_steps_trained": 6000, "learner_connector_sum_episodes_length_out": 5250, "num_trainable_parameters": 6003, "learner_connector_sum_episodes_length_in": 5000, "num_env_steps_trained_lifetime_throughput": 2698727.330854884, "num_module_steps_trained_throughput": 517303.32363785716, "num_module_steps_trained_lifetime_throughput": 516167.19641187874}, "default_policy": {"diff_num_grad_updates_vs_sampler_policy": 1.0, "vf_loss_unclipped": 28.695228576660156, "num_module_steps_trained": 6000, "total_loss": -0.016456305980682373, "num_trainable_parameters": 6003, "gradients_default_optimizer_global_norm": 0.10145387798547745, "weights_seq_no": 1.0, "mean_kl_loss": 5.3182855481281877e-05, "vf_explained_var": 0.012743055820465088, "vf_loss": 0.10070119053125381, "policy_loss": -0.07757909595966339, "default_optimizer_learning_rate": 0.0002847858517, "entropy": 0.6919029951095581, "num_module_steps_trained_lifetime": 6000, "curr_entropy_coeff": 0.0090570820258, "curr_kl_coeff": 0.3732481598854065, "module_train_batch_size_mean": 1000.0, "num_module_steps_trained_lifetime_throughput": 518819.14997651975}}, "num_training_step_calls_per_iteration": 1, "num_env_steps_sampled_lifetime": 627500.0, "evaluation": {"env_runners": {"num_agent_steps_sampled": {"default_agent": 400}, "num_env_steps_sampled_lifetime": 5400, "env_to_module_connector": {"timers": {"connectors": {"add_states_from_episodes_to_batch": 1.5792262322144018e-06, "batch_individual_items": 6.255488109315023e-06, "numpy_to_tensor": 8.22896912144028e-06, "add_observations_from_episodes_to_batch": 2.923306269196374e-06, "add_time_dim_to_batch_and_zero_pad": 2.2780981770052223e-06}}, "connector_pipeline_timer": 4.4185732584712766e-05}, "episode_return_min": -14.5, "num_episodes": 20, "num_episodes_lifetime": 20, "module_to_env_connector": {"timers": {"connectors": {"un_batch_to_individual_items": 5.313016626086507e-06, "normalize_and_clip_actions": 1.054145519716452e-05, "listify_data_for_vector_env": 1.0905778533524469e-05, "tensor_to_numpy": 1.4442026141193114e-05, "get_actions": 3.8263795999243003e-05, "remove_single_ts_time_rank_from_batch": 5.800725920867268e-07}}, "connector_pipeline_timer": 0.00010543826535921846}, "episode_len_mean": 20.0, "weights_seq_no": 1.0, "episode_return_max": 11.5, "num_agent_steps_sampled_lifetime": {"default_agent": 400}, "episode_len_min": 20, "num_env_steps_sampled": 400, "episode_duration_sec_mean": 0.004448193783173337, "module_episode_returns_mean": {"default_policy": -4.85}, "episode_return_mean": -4.85, "env_reset_timer": 0.00016008294187486172, "env_step_timer": 1.4219610731634995e-05, "num_module_steps_sampled": {"default_policy": 400}, "agent_episode_returns_mean": {"default_agent": -4.85}, "episode_len_max": 20, "env_to_module_sum_episodes_length_in": 10.216013141322508, "num_module_steps_sampled_lifetime": {"default_policy": 400}, "env_to_module_sum_episodes_length_out": 10.216013141322508, "rlmodule_inference_timer": 2.8306789699401133e-05, "sample": 0.09698299993760884}, "num_healthy_workers": 1, "actor_manager_num_outstanding_async_reqs": 0, "num_remote_worker_restarts": 0}, "fault_tolerance": {"num_healthy_workers": 0, "num_remote_worker_restarts": 0}, "env_runner_group": {"actor_manager_num_outstanding_async_reqs": 0}, "done": false, "training_iteration": 1, "trial_id": "49be2_00000", "date": "2025-08-11_19-36-10", "timestamp": 1754933770, "time_this_iter_s": 1.6611969470977783, "time_total_s": 1.6611969470977783, "pid": 28164, "hostname": "Mac", "node_ip": "127.0.0.1", "config": {"exploration_config": {}, "extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "placement_strategy": "PACK", "num_gpus": 0, "_fake_gpus": false, "num_cpus_for_main_process": 2, "eager_tracing": true, "eager_max_retraces": 20, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "torch_compile_learner": false, "torch_compile_learner_what_to_compile": "forward_train", "torch_compile_learner_dynamo_backend": "aot_eager", "torch_compile_learner_dynamo_mode": null, "torch_compile_worker": false, "torch_compile_worker_dynamo_backend": "aot_eager", "torch_compile_worker_dynamo_mode": null, "torch_ddp_kwargs": {}, "torch_skip_nan_gradients": false, "env": "Umbrella", "env_config": {}, "observation_space": null, "action_space": null, "clip_rewards": null, "normalize_actions": true, "clip_actions": false, "_is_atari": null, "disable_env_checking": false, "render_env": false, "action_mask_key": "action_mask", "env_runner_cls": null, "num_env_runners": 0, "create_local_env_runner": true, "num_envs_per_env_runner": 1, "gym_env_vectorize_mode": "SYNC", "num_cpus_per_env_runner": 1, "num_gpus_per_env_runner": 0, "custom_resources_per_env_runner": {}, "validate_env_runners_after_construction": true, "episodes_to_numpy": true, "max_requests_in_flight_per_env_runner": 1, "sample_timeout_s": 60.0, "_env_to_module_connector": null, "add_default_connectors_to_env_to_module_pipeline": true, "_module_to_env_connector": null, "add_default_connectors_to_module_to_env_pipeline": true, "merge_env_runner_states": "training_only", "broadcast_env_runner_states": true, "episode_lookback_horizon": 1, "rollout_fragment_length": "auto", "batch_mode": "complete_episodes", "compress_observations": false, "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "enable_tf1_exec_eagerly": false, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "preprocessor_pref": "deepmind", "observation_filter": "NoFilter", "update_worker_filter_stats": true, "use_worker_filter_stats": true, "sampler_perf_stats_ema_coef": null, "_is_online": true, "num_learners": 0, "num_gpus_per_learner": 0, "num_cpus_per_learner": "auto", "num_aggregator_actors_per_learner": 0, "max_requests_in_flight_per_aggregator_actor": 3, "local_gpu_idx": 0, "max_requests_in_flight_per_learner": 3, "gamma": 1, "lr": 0.0002847858517, "grad_clip": 0.5, "grad_clip_by": "global_norm", "_train_batch_size_per_learner": 5000, "train_batch_size": 4000, "num_epochs": 1, "minibatch_size": 1000, "shuffle_batch_per_epoch": true, "model": {"fcnet_hiddens": [256, 256], "fcnet_activation": "tanh", "fcnet_weights_initializer": null, "fcnet_weights_initializer_config": null, "fcnet_bias_initializer": null, "fcnet_bias_initializer_config": null, "conv_filters": null, "conv_activation": "relu", "conv_kernel_initializer": null, "conv_kernel_initializer_config": null, "conv_bias_initializer": null, "conv_bias_initializer_config": null, "conv_transpose_kernel_initializer": null, "conv_transpose_kernel_initializer_config": null, "conv_transpose_bias_initializer": null, "conv_transpose_bias_initializer_config": null, "post_fcnet_hiddens": [], "post_fcnet_activation": "relu", "post_fcnet_weights_initializer": null, "post_fcnet_weights_initializer_config": null, "post_fcnet_bias_initializer": null, "post_fcnet_bias_initializer_config": null, "free_log_std": false, "log_std_clip_param": 20.0, "no_final_linear": false, "vf_share_layers": false, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "lstm_weights_initializer": null, "lstm_weights_initializer_config": null, "lstm_bias_initializer": null, "lstm_bias_initializer_config": null, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "attention_use_n_prev_actions": 0, "attention_use_n_prev_rewards": 0, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": null, "custom_model_config": {}, "custom_action_dist": null, "custom_preprocessor": null, "encoder_latent_dim": null, "always_check_shapes": false, "lstm_use_prev_action_reward": -1, "_use_default_native_models": -1, "_disable_preprocessor_api": false, "_disable_action_flattening": false}, "_learner_connector": null, "add_default_connectors_to_learner_pipeline": true, "learner_config_dict": {}, "optimizer": {}, "_learner_class": null, "callbacks_on_algorithm_init": null, "callbacks_on_env_runners_recreated": null, "callbacks_on_offline_eval_runners_recreated": null, "callbacks_on_checkpoint_loaded": null, "callbacks_on_environment_created": null, "callbacks_on_episode_created": null, "callbacks_on_episode_start": null, "callbacks_on_episode_step": null, "callbacks_on_episode_end": null, "callbacks_on_evaluate_start": null, "callbacks_on_evaluate_end": null, "callbacks_on_evaluate_offline_start": null, "callbacks_on_evaluate_offline_end": null, "callbacks_on_sample_end": null, "callbacks_on_train_result": null, "explore": true, "enable_rl_module_and_learner": true, "enable_env_runner_and_connector_v2": true, "_prior_exploration_config": {"type": "StochasticSampling"}, "count_steps_by": "env_steps", "policy_map_capacity": 100, "policy_mapping_fn": "<function AlgorithmConfig.DEFAULT_POLICY_MAPPING_FN at 0x145c2d8a0>", "policies_to_train": null, "policy_states_are_swappable": false, "observation_fn": null, "offline_data_class": null, "input_read_method": "read_parquet", "input_read_method_kwargs": {}, "input_read_schema": {}, "input_read_episodes": false, "input_read_sample_batches": false, "input_read_batch_size": null, "input_filesystem": null, "input_filesystem_kwargs": {}, "input_compress_columns": ["obs", "new_obs"], "input_spaces_jsonable": true, "materialize_data": false, "materialize_mapped_data": true, "map_batches_kwargs": {}, "iter_batches_kwargs": {}, "ignore_final_observation": false, "prelearner_class": null, "prelearner_buffer_class": null, "prelearner_buffer_kwargs": {}, "prelearner_module_synch_period": 10, "dataset_num_iters_per_learner": null, "input_config": {}, "actions_in_input_normalized": false, "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_config": {}, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "output_max_rows_per_file": null, "output_write_remaining_data": false, "output_write_method": "write_parquet", "output_write_method_kwargs": {}, "output_filesystem": null, "output_filesystem_kwargs": {}, "output_write_episodes": true, "offline_sampling": false, "evaluation_interval": 1, "evaluation_duration": 20, "evaluation_duration_unit": "episodes", "evaluation_sample_timeout_s": 120.0, "evaluation_auto_duration_min_env_steps_per_sample": 100, "evaluation_auto_duration_max_env_steps_per_sample": 2000, "evaluation_parallel_to_training": false, "evaluation_force_reset_envs_before_iteration": true, "evaluation_config": null, "off_policy_estimation_methods": {}, "ope_split_batch_by_episode": true, "evaluation_num_env_runners": 1, "in_evaluation": false, "sync_filters_on_rollout_workers_timeout_s": 10.0, "offline_evaluation_interval": null, "num_offline_eval_runners": 0, "offline_loss_for_module_fn": null, "offline_evaluation_duration": 1, "offline_evaluation_parallel_to_training": false, "offline_evaluation_timeout_s": 120.0, "num_cpus_per_offline_eval_runner": 1, "num_gpus_per_offline_eval_runner": 0, "custom_resources_per_offline_eval_runner": {}, "restart_failed_offline_eval_runners": true, "ignore_offline_eval_runner_failures": false, "max_num_offline_eval_runner_restarts": 1000, "offline_eval_runner_restore_timeout_s": 1800.0, "max_requests_in_flight_per_offline_eval_runner": 1, "validate_offline_eval_runners_after_construction": true, "offline_eval_runner_health_probe_timeout_s": 30.0, "offline_eval_rl_module_inference_only": false, "broadcast_offline_eval_runner_states": false, "offline_eval_batch_size_per_runner": 256, "dataset_num_iters_per_eval_runner": 1, "keep_per_episode_custom_metrics": false, "metrics_episode_collection_timeout_s": 60.0, "metrics_num_episodes_for_smoothing": 100, "min_time_s_per_iteration": null, "min_train_timesteps_per_iteration": 0, "min_sample_timesteps_per_iteration": 0, "log_gradients": true, "export_native_model_files": false, "checkpoint_trainable_policies_only": false, "logger_creator": null, "logger_config": null, "log_level": "WARN", "log_sys_usage": true, "fake_sampler": false, "seed": 4, "restart_failed_env_runners": true, "ignore_env_runner_failures": false, "max_num_env_runner_restarts": 1000, "delay_between_env_runner_restarts_s": 60.0, "restart_failed_sub_environments": false, "num_consecutive_env_runner_failures_tolerance": 100, "env_runner_health_probe_timeout_s": 30.0, "env_runner_restore_timeout_s": 1800.0, "_model_config": {}, "_rl_module_spec": "RLModuleSpec(module_class=None, observation_space=None, action_space=None, inference_only=False, learner_only=False, model_config=DefaultModelConfig(fcnet_hiddens=[60, 90], fcnet_activation='tanh', fcnet_kernel_initializer=None, fcnet_kernel_initializer_kwargs=None, fcnet_bias_initializer=None, fcnet_bias_initializer_kwargs=None, conv_filters=None, conv_activation='relu', conv_kernel_initializer=None, conv_kernel_initializer_kwargs=None, conv_bias_initializer=None, conv_bias_initializer_kwargs=None, head_fcnet_hiddens=[], head_fcnet_activation='relu', head_fcnet_kernel_initializer=None, head_fcnet_kernel_initializer_kwargs=None, head_fcnet_bias_initializer=None, head_fcnet_bias_initializer_kwargs=None, free_log_std=False, log_std_clip_param=20.0, vf_share_layers=True, use_lstm=False, max_seq_len=20, lstm_cell_size=256, lstm_use_prev_action=False, lstm_use_prev_reward=False, lstm_kernel_initializer=None, lstm_kernel_initializer_kwargs=None, lstm_bias_initializer=None, lstm_bias_initializer_kwargs=None), catalog_class=None, load_state_path=None, model_config_dict=None)", "algorithm_config_overrides_per_module": {}, "_per_module_overrides": {}, "_validate_config": true, "_use_msgpack_checkpoints": false, "_torch_grad_scaler_class": null, "_torch_lr_scheduler_classes": null, "_tf_policy_handles_more_than_one_loss": false, "_disable_preprocessor_api": false, "_disable_action_flattening": false, "_disable_initialize_loss_from_dummy_batch": false, "_dont_auto_sync_env_runner_states": false, "env_task_fn": -1, "enable_connectors": -1, "simple_optimizer": false, "policy_map_cache": -1, "worker_cls": -1, "synchronize_filters": -1, "enable_async_evaluation": -1, "custom_async_evaluation_function": -1, "_enable_rl_module_api": -1, "auto_wrap_old_gym_envs": -1, "always_attach_evaluation_results": -1, "replay_sequence_length": null, "_disable_execution_plan_api": -1, "use_critic": true, "use_gae": true, "use_kl_loss": true, "kl_coeff": 0.7464963036515, "kl_target": 0.0270990929592, "vf_loss_coeff": 0.6688075857018, "entropy_coeff": 0.0090570820258, "clip_param": 0.1221781641624, "vf_clip_param": 0.1027808522125, "entropy_coeff_schedule": null, "lr_schedule": null, "sgd_minibatch_size": -1, "vf_share_layers": -1, "__stdout_file__": null, "__stderr_file__": null, "lambda": 0.9099046732075, "input": "sampler", "policies": {"default_policy": [null, null, null, null]}, "callbacks": "<class 'ray.rllib.callbacks.callbacks.RLlibCallback'>", "create_env_on_driver": false, "custom_eval_function": null, "framework": "torch"}, "time_since_restore": 1.6611969470977783, "iterations_since_restore": 1, "perf": {"cpu_util_percent": 25.0, "ram_util_percent": 74.23333333333333}}
{"timers": {"training_iteration": 1.556151379199, "restore_env_runners": 9.919719304889441e-06, "training_step": 1.5560335367685183, "env_runner_sampling_timer": 1.447100712090032, "learner_update_timer": 0.10599902802263386, "synch_weights": 0.0005981150164734572, "restore_eval_env_runners": 7.750000804662704e-06, "evaluation_iteration": 0.10313254198990762, "synch_eval_env_connectors": 0.00011849997099488974, "synch_env_connectors": 4.542060196399689e-06}, "env_runners": {"num_episodes_lifetime": 500.0, "episode_len_mean": 20.0, "env_to_module_connector": {"timers": {"connectors": {"batch_individual_items": 6.128370345613752e-06, "add_observations_from_episodes_to_batch": 2.8811668025876927e-06, "add_states_from_episodes_to_batch": 1.708598166482272e-06, "numpy_to_tensor": 8.307662842541588e-06, "add_time_dim_to_batch_and_zero_pad": 2.330791862011009e-06}}, "connector_pipeline_timer": 4.266451948685339e-05}, "agent_episode_returns_mean": {"default_agent": 3.1399999999999992}, "episode_return_max": 12.5, "num_module_steps_sampled_lifetime": {"default_policy": 10000.0}, "env_step_timer": 1.3468966993531391e-05, "module_to_env_connector": {"timers": {"connectors": {"listify_data_for_vector_env": 1.089980279307361e-05, "remove_single_ts_time_rank_from_batch": 5.763085318081823e-07, "tensor_to_numpy": 1.2973502346146938e-05, "un_batch_to_individual_items": 5.260351696329562e-06, "get_actions": 3.780376148984979e-05, "normalize_and_clip_actions": 9.28341698582368e-06}}, "connector_pipeline_timer": 0.00010193106108382063}, "module_episode_returns_mean": {"default_policy": 3.1399999999999992}, "num_env_steps_sampled_lifetime": 10000.0, "episode_len_min": 20, "episode_return_min": -7.5, "time_between_sampling": 0.0014361912171461605, "num_env_steps_sampled": 5000.0, "num_module_steps_sampled": {"default_policy": 5000.0}, "num_episodes": 250.0, "episode_len_max": 20, "num_agent_steps_sampled": {"default_agent": 5000.0}, "episode_duration_sec_mean": 0.004444955667946489, "env_to_module_sum_episodes_length_in": 10.36823839457432, "num_agent_steps_sampled_lifetime": {"default_agent": 10000.0}, "env_to_module_sum_episodes_length_out": 10.36823839457432, "rlmodule_inference_timer": 2.7279310297110937e-05, "episode_return_mean": 3.1399999999999992, "sample": 0.005120484457031348, "env_reset_timer": 3.719941852652216e-05, "weights_seq_no": 1.0, "num_env_steps_sampled_lifetime_throughput": 3803.5633495818015}, "learners": {"__all_modules__": {"num_non_trainable_parameters": 0, "learner_connector": {"timers": {"connectors": {"add_time_dim_to_batch_and_zero_pad": 9.877840057015419e-06, "batch_individual_items": 0.030593512437772002, "add_one_ts_to_episodes_and_truncate": 0.007656446412438527, "general_advantage_estimation": 0.007642331719398498, "numpy_to_tensor": 6.734960828907788e-05, "add_observations_from_episodes_to_batch": 0.0008028230059426278, "add_states_from_episodes_to_batch": 3.2118987292051315e-06, "add_columns_from_episodes_to_train_batch": 0.0342760479694698}}, "connector_pipeline_timer": 0.08116620660061016}, "num_env_steps_trained_lifetime": 63000, "num_env_steps_trained": 31500, "num_module_steps_trained_lifetime": 12000, "num_module_steps_trained": 6000, "learner_connector_sum_episodes_length_out": 5250.0, "num_trainable_parameters": 6003, "learner_connector_sum_episodes_length_in": 5000.0, "num_env_steps_trained_lifetime_throughput": 2695798.7343796543, "num_module_steps_trained_throughput": 516705.05393225816, "num_module_steps_trained_lifetime_throughput": 515581.49612121447}, "default_policy": {"diff_num_grad_updates_vs_sampler_policy": 1.0, "vf_loss_unclipped": 28.312942504882812, "num_module_steps_trained": 6000, "total_loss": 0.21512305736541748, "num_trainable_parameters": 6003, "gradients_default_optimizer_global_norm": 0.09580280631780624, "weights_seq_no": 2.0, "mean_kl_loss": 0.00033477909164503217, "vf_explained_var": 0.01552802324295044, "vf_loss": 0.10001108795404434, "policy_loss": 0.15436917543411255, "default_optimizer_learning_rate": 0.0002847858517, "entropy": 0.6910908818244934, "num_module_steps_trained_lifetime": 12000, "curr_entropy_coeff": 0.0090570820258, "curr_kl_coeff": 0.18662407994270325, "module_train_batch_size_mean": 1000.0, "num_module_steps_trained_lifetime_throughput": 518188.7485932709}}, "num_training_step_calls_per_iteration": 1, "evaluation": {"env_runners": {"num_agent_steps_sampled": {"default_agent": 400}, "num_env_steps_sampled_lifetime": 10400, "env_to_module_connector": {"timers": {"connectors": {"add_states_from_episodes_to_batch": 1.5828661313059576e-06, "batch_individual_items": 6.0970304836408354e-06, "numpy_to_tensor": 8.037119307048793e-06, "add_observations_from_episodes_to_batch": 2.7508068371255054e-06, "add_time_dim_to_batch_and_zero_pad": 2.1947361884259952e-06}}, "connector_pipeline_timer": 4.1889936227148573e-05}, "episode_return_min": -14.5, "num_episodes": 20, "num_episodes_lifetime": 40, "module_to_env_connector": {"timers": {"connectors": {"un_batch_to_individual_items": 5.228678596574622e-06, "normalize_and_clip_actions": 9.127423660719836e-06, "listify_data_for_vector_env": 1.0709985040057812e-05, "tensor_to_numpy": 1.2734101039962183e-05, "get_actions": 3.3988912163681774e-05, "remove_single_ts_time_rank_from_batch": 5.781422730757662e-07}}, "connector_pipeline_timer": 9.725304408476902e-05}, "episode_len_mean": 20.0, "weights_seq_no": 2.0, "episode_return_max": 11.5, "num_agent_steps_sampled_lifetime": {"default_agent": 800}, "episode_len_min": 20, "num_env_steps_sampled": 400, "episode_duration_sec_mean": 0.004417399017256685, "module_episode_returns_mean": {"default_policy": -2.35}, "episode_return_mean": -2.35, "env_reset_timer": 0.0001592054427601397, "env_step_timer": 1.356944874351011e-05, "num_module_steps_sampled": {"default_policy": 400}, "agent_episode_returns_mean": {"default_agent": -2.35}, "episode_len_max": 20, "env_to_module_sum_episodes_length_in": 10.366003441359926, "num_module_steps_sampled_lifetime": {"default_policy": 800}, "env_to_module_sum_episodes_length_out": 10.366003441359926, "rlmodule_inference_timer": 2.6544320005452182e-05, "sample": 0.09696835035807454, "time_between_sampling": 1.548818334005773}, "num_healthy_workers": 1, "actor_manager_num_outstanding_async_reqs": 0, "num_remote_worker_restarts": 0}, "num_env_steps_sampled_lifetime": 10000.0, "fault_tolerance": {"num_healthy_workers": 0, "num_remote_worker_restarts": 0}, "env_runner_group": {"actor_manager_num_outstanding_async_reqs": 0}, "done": false, "training_iteration": 2, "trial_id": "49be2_00000", "date": "2025-08-11_19-36-12", "timestamp": 1754933772, "time_this_iter_s": 1.6286516189575195, "time_total_s": 3.289848566055298, "pid": 28164, "hostname": "Mac", "node_ip": "127.0.0.1", "config": {"exploration_config": {}, "extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "placement_strategy": "PACK", "num_gpus": 0, "_fake_gpus": false, "num_cpus_for_main_process": 2, "eager_tracing": true, "eager_max_retraces": 20, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "torch_compile_learner": false, "torch_compile_learner_what_to_compile": "forward_train", "torch_compile_learner_dynamo_backend": "aot_eager", "torch_compile_learner_dynamo_mode": null, "torch_compile_worker": false, "torch_compile_worker_dynamo_backend": "aot_eager", "torch_compile_worker_dynamo_mode": null, "torch_ddp_kwargs": {}, "torch_skip_nan_gradients": false, "env": "Umbrella", "env_config": {}, "observation_space": null, "action_space": null, "clip_rewards": null, "normalize_actions": true, "clip_actions": false, "_is_atari": null, "disable_env_checking": false, "render_env": false, "action_mask_key": "action_mask", "env_runner_cls": null, "num_env_runners": 0, "create_local_env_runner": true, "num_envs_per_env_runner": 1, "gym_env_vectorize_mode": "SYNC", "num_cpus_per_env_runner": 1, "num_gpus_per_env_runner": 0, "custom_resources_per_env_runner": {}, "validate_env_runners_after_construction": true, "episodes_to_numpy": true, "max_requests_in_flight_per_env_runner": 1, "sample_timeout_s": 60.0, "_env_to_module_connector": null, "add_default_connectors_to_env_to_module_pipeline": true, "_module_to_env_connector": null, "add_default_connectors_to_module_to_env_pipeline": true, "merge_env_runner_states": "training_only", "broadcast_env_runner_states": true, "episode_lookback_horizon": 1, "rollout_fragment_length": "auto", "batch_mode": "complete_episodes", "compress_observations": false, "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "enable_tf1_exec_eagerly": false, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "preprocessor_pref": "deepmind", "observation_filter": "NoFilter", "update_worker_filter_stats": true, "use_worker_filter_stats": true, "sampler_perf_stats_ema_coef": null, "_is_online": true, "num_learners": 0, "num_gpus_per_learner": 0, "num_cpus_per_learner": "auto", "num_aggregator_actors_per_learner": 0, "max_requests_in_flight_per_aggregator_actor": 3, "local_gpu_idx": 0, "max_requests_in_flight_per_learner": 3, "gamma": 1, "lr": 0.0002847858517, "grad_clip": 0.5, "grad_clip_by": "global_norm", "_train_batch_size_per_learner": 5000, "train_batch_size": 4000, "num_epochs": 1, "minibatch_size": 1000, "shuffle_batch_per_epoch": true, "model": {"fcnet_hiddens": [256, 256], "fcnet_activation": "tanh", "fcnet_weights_initializer": null, "fcnet_weights_initializer_config": null, "fcnet_bias_initializer": null, "fcnet_bias_initializer_config": null, "conv_filters": null, "conv_activation": "relu", "conv_kernel_initializer": null, "conv_kernel_initializer_config": null, "conv_bias_initializer": null, "conv_bias_initializer_config": null, "conv_transpose_kernel_initializer": null, "conv_transpose_kernel_initializer_config": null, "conv_transpose_bias_initializer": null, "conv_transpose_bias_initializer_config": null, "post_fcnet_hiddens": [], "post_fcnet_activation": "relu", "post_fcnet_weights_initializer": null, "post_fcnet_weights_initializer_config": null, "post_fcnet_bias_initializer": null, "post_fcnet_bias_initializer_config": null, "free_log_std": false, "log_std_clip_param": 20.0, "no_final_linear": false, "vf_share_layers": false, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "lstm_weights_initializer": null, "lstm_weights_initializer_config": null, "lstm_bias_initializer": null, "lstm_bias_initializer_config": null, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "attention_use_n_prev_actions": 0, "attention_use_n_prev_rewards": 0, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": null, "custom_model_config": {}, "custom_action_dist": null, "custom_preprocessor": null, "encoder_latent_dim": null, "always_check_shapes": false, "lstm_use_prev_action_reward": -1, "_use_default_native_models": -1, "_disable_preprocessor_api": false, "_disable_action_flattening": false}, "_learner_connector": null, "add_default_connectors_to_learner_pipeline": true, "learner_config_dict": {}, "optimizer": {}, "_learner_class": null, "callbacks_on_algorithm_init": null, "callbacks_on_env_runners_recreated": null, "callbacks_on_offline_eval_runners_recreated": null, "callbacks_on_checkpoint_loaded": null, "callbacks_on_environment_created": null, "callbacks_on_episode_created": null, "callbacks_on_episode_start": null, "callbacks_on_episode_step": null, "callbacks_on_episode_end": null, "callbacks_on_evaluate_start": null, "callbacks_on_evaluate_end": null, "callbacks_on_evaluate_offline_start": null, "callbacks_on_evaluate_offline_end": null, "callbacks_on_sample_end": null, "callbacks_on_train_result": null, "explore": true, "enable_rl_module_and_learner": true, "enable_env_runner_and_connector_v2": true, "_prior_exploration_config": {"type": "StochasticSampling"}, "count_steps_by": "env_steps", "policy_map_capacity": 100, "policy_mapping_fn": "<function AlgorithmConfig.DEFAULT_POLICY_MAPPING_FN at 0x145c2d8a0>", "policies_to_train": null, "policy_states_are_swappable": false, "observation_fn": null, "offline_data_class": null, "input_read_method": "read_parquet", "input_read_method_kwargs": {}, "input_read_schema": {}, "input_read_episodes": false, "input_read_sample_batches": false, "input_read_batch_size": null, "input_filesystem": null, "input_filesystem_kwargs": {}, "input_compress_columns": ["obs", "new_obs"], "input_spaces_jsonable": true, "materialize_data": false, "materialize_mapped_data": true, "map_batches_kwargs": {}, "iter_batches_kwargs": {}, "ignore_final_observation": false, "prelearner_class": null, "prelearner_buffer_class": null, "prelearner_buffer_kwargs": {}, "prelearner_module_synch_period": 10, "dataset_num_iters_per_learner": null, "input_config": {}, "actions_in_input_normalized": false, "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_config": {}, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "output_max_rows_per_file": null, "output_write_remaining_data": false, "output_write_method": "write_parquet", "output_write_method_kwargs": {}, "output_filesystem": null, "output_filesystem_kwargs": {}, "output_write_episodes": true, "offline_sampling": false, "evaluation_interval": 1, "evaluation_duration": 20, "evaluation_duration_unit": "episodes", "evaluation_sample_timeout_s": 120.0, "evaluation_auto_duration_min_env_steps_per_sample": 100, "evaluation_auto_duration_max_env_steps_per_sample": 2000, "evaluation_parallel_to_training": false, "evaluation_force_reset_envs_before_iteration": true, "evaluation_config": null, "off_policy_estimation_methods": {}, "ope_split_batch_by_episode": true, "evaluation_num_env_runners": 1, "in_evaluation": false, "sync_filters_on_rollout_workers_timeout_s": 10.0, "offline_evaluation_interval": null, "num_offline_eval_runners": 0, "offline_loss_for_module_fn": null, "offline_evaluation_duration": 1, "offline_evaluation_parallel_to_training": false, "offline_evaluation_timeout_s": 120.0, "num_cpus_per_offline_eval_runner": 1, "num_gpus_per_offline_eval_runner": 0, "custom_resources_per_offline_eval_runner": {}, "restart_failed_offline_eval_runners": true, "ignore_offline_eval_runner_failures": false, "max_num_offline_eval_runner_restarts": 1000, "offline_eval_runner_restore_timeout_s": 1800.0, "max_requests_in_flight_per_offline_eval_runner": 1, "validate_offline_eval_runners_after_construction": true, "offline_eval_runner_health_probe_timeout_s": 30.0, "offline_eval_rl_module_inference_only": false, "broadcast_offline_eval_runner_states": false, "offline_eval_batch_size_per_runner": 256, "dataset_num_iters_per_eval_runner": 1, "keep_per_episode_custom_metrics": false, "metrics_episode_collection_timeout_s": 60.0, "metrics_num_episodes_for_smoothing": 100, "min_time_s_per_iteration": null, "min_train_timesteps_per_iteration": 0, "min_sample_timesteps_per_iteration": 0, "log_gradients": true, "export_native_model_files": false, "checkpoint_trainable_policies_only": false, "logger_creator": null, "logger_config": null, "log_level": "WARN", "log_sys_usage": true, "fake_sampler": false, "seed": 4, "restart_failed_env_runners": true, "ignore_env_runner_failures": false, "max_num_env_runner_restarts": 1000, "delay_between_env_runner_restarts_s": 60.0, "restart_failed_sub_environments": false, "num_consecutive_env_runner_failures_tolerance": 100, "env_runner_health_probe_timeout_s": 30.0, "env_runner_restore_timeout_s": 1800.0, "_model_config": {}, "_rl_module_spec": "RLModuleSpec(module_class=None, observation_space=None, action_space=None, inference_only=False, learner_only=False, model_config=DefaultModelConfig(fcnet_hiddens=[60, 90], fcnet_activation='tanh', fcnet_kernel_initializer=None, fcnet_kernel_initializer_kwargs=None, fcnet_bias_initializer=None, fcnet_bias_initializer_kwargs=None, conv_filters=None, conv_activation='relu', conv_kernel_initializer=None, conv_kernel_initializer_kwargs=None, conv_bias_initializer=None, conv_bias_initializer_kwargs=None, head_fcnet_hiddens=[], head_fcnet_activation='relu', head_fcnet_kernel_initializer=None, head_fcnet_kernel_initializer_kwargs=None, head_fcnet_bias_initializer=None, head_fcnet_bias_initializer_kwargs=None, free_log_std=False, log_std_clip_param=20.0, vf_share_layers=True, use_lstm=False, max_seq_len=20, lstm_cell_size=256, lstm_use_prev_action=False, lstm_use_prev_reward=False, lstm_kernel_initializer=None, lstm_kernel_initializer_kwargs=None, lstm_bias_initializer=None, lstm_bias_initializer_kwargs=None), catalog_class=None, load_state_path=None, model_config_dict=None)", "algorithm_config_overrides_per_module": {}, "_per_module_overrides": {}, "_validate_config": true, "_use_msgpack_checkpoints": false, "_torch_grad_scaler_class": null, "_torch_lr_scheduler_classes": null, "_tf_policy_handles_more_than_one_loss": false, "_disable_preprocessor_api": false, "_disable_action_flattening": false, "_disable_initialize_loss_from_dummy_batch": false, "_dont_auto_sync_env_runner_states": false, "env_task_fn": -1, "enable_connectors": -1, "simple_optimizer": false, "policy_map_cache": -1, "worker_cls": -1, "synchronize_filters": -1, "enable_async_evaluation": -1, "custom_async_evaluation_function": -1, "_enable_rl_module_api": -1, "auto_wrap_old_gym_envs": -1, "always_attach_evaluation_results": -1, "replay_sequence_length": null, "_disable_execution_plan_api": -1, "use_critic": true, "use_gae": true, "use_kl_loss": true, "kl_coeff": 0.7464963036515, "kl_target": 0.0270990929592, "vf_loss_coeff": 0.6688075857018, "entropy_coeff": 0.0090570820258, "clip_param": 0.1221781641624, "vf_clip_param": 0.1027808522125, "entropy_coeff_schedule": null, "lr_schedule": null, "sgd_minibatch_size": -1, "vf_share_layers": -1, "__stdout_file__": null, "__stderr_file__": null, "lambda": 0.9099046732075, "input": "sampler", "policies": {"default_policy": [null, null, null, null]}, "callbacks": "<class 'ray.rllib.callbacks.callbacks.RLlibCallback'>", "create_env_on_driver": false, "custom_eval_function": null, "framework": "torch"}, "time_since_restore": 3.289848566055298, "iterations_since_restore": 2, "perf": {"cpu_util_percent": 33.8, "ram_util_percent": 74.55}}
{"timers": {"training_iteration": 1.5562933237366727, "restore_env_runners": 9.87760287243873e-06, "training_step": 1.5561750289008487, "env_runner_sampling_timer": 1.4473797499692416, "learner_update_timer": 0.10585931107223732, "synch_weights": 0.0005984534464427271, "restore_eval_env_runners": 7.748331408947707e-06, "evaluation_iteration": 0.10310203072964214, "synch_eval_env_connectors": 0.00011845497065223753, "synch_env_connectors": 4.548300057649612e-06}, "env_runners": {"num_episodes_lifetime": -30375.0, "episode_len_mean": 20.0, "env_to_module_connector": {"timers": {"connectors": {"batch_individual_items": 6.710299284876452e-06, "add_observations_from_episodes_to_batch": 3.1239918919019075e-06, "add_states_from_episodes_to_batch": 1.8398025252959917e-06, "numpy_to_tensor": 9.172470253835017e-06, "add_time_dim_to_batch_and_zero_pad": 2.6934164214503857e-06}}, "connector_pipeline_timer": 4.605889068157951e-05}, "agent_episode_returns_mean": {"default_agent": 3.06}, "episode_return_max": 12.5, "num_module_steps_sampled_lifetime": {"default_policy": -607500.0}, "env_step_timer": 1.4759918712972667e-05, "module_to_env_connector": {"timers": {"connectors": {"listify_data_for_vector_env": 1.1989246170361163e-05, "remove_single_ts_time_rank_from_batch": 6.201254734562225e-07, "tensor_to_numpy": 1.4177914946775768e-05, "un_batch_to_individual_items": 5.700981895516776e-06, "get_actions": 4.190046943269703e-05, "normalize_and_clip_actions": 1.029999772516499e-05}}, "connector_pipeline_timer": 0.00011164511219241891}, "module_episode_returns_mean": {"default_policy": 3.06}, "num_env_steps_sampled_lifetime": -607500.0, "episode_len_min": 20, "episode_return_min": -7.5, "time_between_sampling": 0.0017880159131222794, "num_env_steps_sampled": 5000.0, "num_module_steps_sampled": {"default_policy": 5000.0}, "num_episodes": 250.0, "episode_len_max": 20, "num_agent_steps_sampled": {"default_agent": 5000.0}, "episode_duration_sec_mean": 0.004878538184799255, "env_to_module_sum_episodes_length_in": 10.36823839457432, "num_agent_steps_sampled_lifetime": {"default_agent": -607500.0}, "env_to_module_sum_episodes_length_out": 10.36823839457432, "rlmodule_inference_timer": 2.964237018313411e-05, "episode_return_mean": 3.06, "sample": 0.004978508413021932, "env_reset_timer": 3.3654449417637674e-05, "weights_seq_no": 2.0, "num_env_steps_sampled_lifetime_throughput": 3659.7405241679453}, "learners": {"__all_modules__": {"num_non_trainable_parameters": 0, "learner_connector": {"timers": {"connectors": {"add_time_dim_to_batch_and_zero_pad": 9.902811143547297e-06, "batch_individual_items": 0.03059288106302265, "add_one_ts_to_episodes_and_truncate": 0.007655941948888358, "general_advantage_estimation": 0.007620966732967644, "numpy_to_tensor": 6.758945210603998e-05, "add_observations_from_episodes_to_batch": 0.0008027997751371004, "add_states_from_episodes_to_batch": 3.2106193248182533e-06, "add_columns_from_episodes_to_train_batch": 0.03428377581977984}}, "connector_pipeline_timer": 0.08115151536443735}, "num_env_steps_trained_lifetime": 94500, "num_env_steps_trained": 31500, "num_module_steps_trained_lifetime": 18000, "num_module_steps_trained": 6000, "learner_connector_sum_episodes_length_out": 5250.0, "num_trainable_parameters": 6003, "learner_connector_sum_episodes_length_in": 5000.0, "num_env_steps_trained_lifetime_throughput": 2691380.0405702875, "num_module_steps_trained_throughput": 515797.4021767367, "num_module_steps_trained_lifetime_throughput": 514694.08940865094}, "default_policy": {"diff_num_grad_updates_vs_sampler_policy": 1.0, "vf_loss_unclipped": 28.33220672607422, "num_module_steps_trained": 6000, "total_loss": 0.13235385715961456, "num_trainable_parameters": 6003, "gradients_default_optimizer_global_norm": 0.10330437868833542, "weights_seq_no": 3.0, "mean_kl_loss": 0.0003109359822701663, "vf_explained_var": 0.01814943552017212, "vf_loss": 0.1000901460647583, "policy_loss": 0.07159475237131119, "default_optimizer_learning_rate": 0.0002847858517, "entropy": 0.6889595985412598, "num_module_steps_trained_lifetime": 18000, "curr_entropy_coeff": 0.0090570820258, "curr_kl_coeff": 0.09331203997135162, "module_train_batch_size_mean": 1000.0, "num_module_steps_trained_lifetime_throughput": 517228.94065314566}}, "num_training_step_calls_per_iteration": 1, "evaluation": {"env_runners": {"num_agent_steps_sampled": {"default_agent": 400}, "num_env_steps_sampled_lifetime": 15400, "env_to_module_connector": {"timers": {"connectors": {"add_states_from_episodes_to_batch": 1.5776086729434512e-06, "batch_individual_items": 6.091802119150835e-06, "numpy_to_tensor": 8.08389174688142e-06, "add_observations_from_episodes_to_batch": 2.7609386959892536e-06, "add_time_dim_to_batch_and_zero_pad": 2.1690301666518917e-06}}, "connector_pipeline_timer": 4.205622313588227e-05}, "episode_return_min": -16.5, "num_episodes": 20, "num_episodes_lifetime": 60, "module_to_env_connector": {"timers": {"connectors": {"un_batch_to_individual_items": 5.213424919743832e-06, "normalize_and_clip_actions": 9.127776606104168e-06, "listify_data_for_vector_env": 1.0692217473277164e-05, "tensor_to_numpy": 1.2732660348616108e-05, "get_actions": 3.405082003988069e-05, "remove_single_ts_time_rank_from_batch": 5.789830531972246e-07}}, "connector_pipeline_timer": 9.736330060378501e-05}, "episode_len_mean": 20.0, "weights_seq_no": 3.0, "episode_return_max": 11.5, "num_agent_steps_sampled_lifetime": {"default_agent": 1200}, "episode_len_min": 20, "num_env_steps_sampled": 400, "episode_duration_sec_mean": 0.004404348629759624, "module_episode_returns_mean": {"default_policy": -1.85}, "episode_return_mean": -1.85, "env_reset_timer": 0.0001583775489823893, "env_step_timer": 1.3565987363441182e-05, "num_module_steps_sampled": {"default_policy": 400}, "agent_episode_returns_mean": {"default_agent": -1.85}, "episode_len_max": 20, "env_to_module_sum_episodes_length_in": 10.368205581254823, "num_module_steps_sampled_lifetime": {"default_policy": 1200}, "env_to_module_sum_episodes_length_out": 10.368205581254823, "rlmodule_inference_timer": 2.6315933804131006e-05, "sample": 0.09695200351407984, "time_between_sampling": 1.54919300941634}, "num_healthy_workers": 1, "actor_manager_num_outstanding_async_reqs": 0, "num_remote_worker_restarts": 0}, "num_env_steps_sampled_lifetime": -607500.0, "fault_tolerance": {"num_healthy_workers": 0, "num_remote_worker_restarts": 0}, "env_runner_group": {"actor_manager_num_outstanding_async_reqs": 0}, "done": false, "training_iteration": 3, "trial_id": "49be2_00000", "date": "2025-08-11_19-36-14", "timestamp": 1754933774, "time_this_iter_s": 1.672485113143921, "time_total_s": 4.962333679199219, "pid": 28164, "hostname": "Mac", "node_ip": "127.0.0.1", "config": {"exploration_config": {}, "extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "placement_strategy": "PACK", "num_gpus": 0, "_fake_gpus": false, "num_cpus_for_main_process": 2, "eager_tracing": true, "eager_max_retraces": 20, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "torch_compile_learner": false, "torch_compile_learner_what_to_compile": "forward_train", "torch_compile_learner_dynamo_backend": "aot_eager", "torch_compile_learner_dynamo_mode": null, "torch_compile_worker": false, "torch_compile_worker_dynamo_backend": "aot_eager", "torch_compile_worker_dynamo_mode": null, "torch_ddp_kwargs": {}, "torch_skip_nan_gradients": false, "env": "Umbrella", "env_config": {}, "observation_space": null, "action_space": null, "clip_rewards": null, "normalize_actions": true, "clip_actions": false, "_is_atari": null, "disable_env_checking": false, "render_env": false, "action_mask_key": "action_mask", "env_runner_cls": null, "num_env_runners": 0, "create_local_env_runner": true, "num_envs_per_env_runner": 1, "gym_env_vectorize_mode": "SYNC", "num_cpus_per_env_runner": 1, "num_gpus_per_env_runner": 0, "custom_resources_per_env_runner": {}, "validate_env_runners_after_construction": true, "episodes_to_numpy": true, "max_requests_in_flight_per_env_runner": 1, "sample_timeout_s": 60.0, "_env_to_module_connector": null, "add_default_connectors_to_env_to_module_pipeline": true, "_module_to_env_connector": null, "add_default_connectors_to_module_to_env_pipeline": true, "merge_env_runner_states": "training_only", "broadcast_env_runner_states": true, "episode_lookback_horizon": 1, "rollout_fragment_length": "auto", "batch_mode": "complete_episodes", "compress_observations": false, "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "enable_tf1_exec_eagerly": false, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "preprocessor_pref": "deepmind", "observation_filter": "NoFilter", "update_worker_filter_stats": true, "use_worker_filter_stats": true, "sampler_perf_stats_ema_coef": null, "_is_online": true, "num_learners": 0, "num_gpus_per_learner": 0, "num_cpus_per_learner": "auto", "num_aggregator_actors_per_learner": 0, "max_requests_in_flight_per_aggregator_actor": 3, "local_gpu_idx": 0, "max_requests_in_flight_per_learner": 3, "gamma": 1, "lr": 0.0002847858517, "grad_clip": 0.5, "grad_clip_by": "global_norm", "_train_batch_size_per_learner": 5000, "train_batch_size": 4000, "num_epochs": 1, "minibatch_size": 1000, "shuffle_batch_per_epoch": true, "model": {"fcnet_hiddens": [256, 256], "fcnet_activation": "tanh", "fcnet_weights_initializer": null, "fcnet_weights_initializer_config": null, "fcnet_bias_initializer": null, "fcnet_bias_initializer_config": null, "conv_filters": null, "conv_activation": "relu", "conv_kernel_initializer": null, "conv_kernel_initializer_config": null, "conv_bias_initializer": null, "conv_bias_initializer_config": null, "conv_transpose_kernel_initializer": null, "conv_transpose_kernel_initializer_config": null, "conv_transpose_bias_initializer": null, "conv_transpose_bias_initializer_config": null, "post_fcnet_hiddens": [], "post_fcnet_activation": "relu", "post_fcnet_weights_initializer": null, "post_fcnet_weights_initializer_config": null, "post_fcnet_bias_initializer": null, "post_fcnet_bias_initializer_config": null, "free_log_std": false, "log_std_clip_param": 20.0, "no_final_linear": false, "vf_share_layers": false, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "lstm_weights_initializer": null, "lstm_weights_initializer_config": null, "lstm_bias_initializer": null, "lstm_bias_initializer_config": null, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "attention_use_n_prev_actions": 0, "attention_use_n_prev_rewards": 0, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": null, "custom_model_config": {}, "custom_action_dist": null, "custom_preprocessor": null, "encoder_latent_dim": null, "always_check_shapes": false, "lstm_use_prev_action_reward": -1, "_use_default_native_models": -1, "_disable_preprocessor_api": false, "_disable_action_flattening": false}, "_learner_connector": null, "add_default_connectors_to_learner_pipeline": true, "learner_config_dict": {}, "optimizer": {}, "_learner_class": null, "callbacks_on_algorithm_init": null, "callbacks_on_env_runners_recreated": null, "callbacks_on_offline_eval_runners_recreated": null, "callbacks_on_checkpoint_loaded": null, "callbacks_on_environment_created": null, "callbacks_on_episode_created": null, "callbacks_on_episode_start": null, "callbacks_on_episode_step": null, "callbacks_on_episode_end": null, "callbacks_on_evaluate_start": null, "callbacks_on_evaluate_end": null, "callbacks_on_evaluate_offline_start": null, "callbacks_on_evaluate_offline_end": null, "callbacks_on_sample_end": null, "callbacks_on_train_result": null, "explore": true, "enable_rl_module_and_learner": true, "enable_env_runner_and_connector_v2": true, "_prior_exploration_config": {"type": "StochasticSampling"}, "count_steps_by": "env_steps", "policy_map_capacity": 100, "policy_mapping_fn": "<function AlgorithmConfig.DEFAULT_POLICY_MAPPING_FN at 0x145c2d8a0>", "policies_to_train": null, "policy_states_are_swappable": false, "observation_fn": null, "offline_data_class": null, "input_read_method": "read_parquet", "input_read_method_kwargs": {}, "input_read_schema": {}, "input_read_episodes": false, "input_read_sample_batches": false, "input_read_batch_size": null, "input_filesystem": null, "input_filesystem_kwargs": {}, "input_compress_columns": ["obs", "new_obs"], "input_spaces_jsonable": true, "materialize_data": false, "materialize_mapped_data": true, "map_batches_kwargs": {}, "iter_batches_kwargs": {}, "ignore_final_observation": false, "prelearner_class": null, "prelearner_buffer_class": null, "prelearner_buffer_kwargs": {}, "prelearner_module_synch_period": 10, "dataset_num_iters_per_learner": null, "input_config": {}, "actions_in_input_normalized": false, "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_config": {}, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "output_max_rows_per_file": null, "output_write_remaining_data": false, "output_write_method": "write_parquet", "output_write_method_kwargs": {}, "output_filesystem": null, "output_filesystem_kwargs": {}, "output_write_episodes": true, "offline_sampling": false, "evaluation_interval": 1, "evaluation_duration": 20, "evaluation_duration_unit": "episodes", "evaluation_sample_timeout_s": 120.0, "evaluation_auto_duration_min_env_steps_per_sample": 100, "evaluation_auto_duration_max_env_steps_per_sample": 2000, "evaluation_parallel_to_training": false, "evaluation_force_reset_envs_before_iteration": true, "evaluation_config": null, "off_policy_estimation_methods": {}, "ope_split_batch_by_episode": true, "evaluation_num_env_runners": 1, "in_evaluation": false, "sync_filters_on_rollout_workers_timeout_s": 10.0, "offline_evaluation_interval": null, "num_offline_eval_runners": 0, "offline_loss_for_module_fn": null, "offline_evaluation_duration": 1, "offline_evaluation_parallel_to_training": false, "offline_evaluation_timeout_s": 120.0, "num_cpus_per_offline_eval_runner": 1, "num_gpus_per_offline_eval_runner": 0, "custom_resources_per_offline_eval_runner": {}, "restart_failed_offline_eval_runners": true, "ignore_offline_eval_runner_failures": false, "max_num_offline_eval_runner_restarts": 1000, "offline_eval_runner_restore_timeout_s": 1800.0, "max_requests_in_flight_per_offline_eval_runner": 1, "validate_offline_eval_runners_after_construction": true, "offline_eval_runner_health_probe_timeout_s": 30.0, "offline_eval_rl_module_inference_only": false, "broadcast_offline_eval_runner_states": false, "offline_eval_batch_size_per_runner": 256, "dataset_num_iters_per_eval_runner": 1, "keep_per_episode_custom_metrics": false, "metrics_episode_collection_timeout_s": 60.0, "metrics_num_episodes_for_smoothing": 100, "min_time_s_per_iteration": null, "min_train_timesteps_per_iteration": 0, "min_sample_timesteps_per_iteration": 0, "log_gradients": true, "export_native_model_files": false, "checkpoint_trainable_policies_only": false, "logger_creator": null, "logger_config": null, "log_level": "WARN", "log_sys_usage": true, "fake_sampler": false, "seed": 4, "restart_failed_env_runners": true, "ignore_env_runner_failures": false, "max_num_env_runner_restarts": 1000, "delay_between_env_runner_restarts_s": 60.0, "restart_failed_sub_environments": false, "num_consecutive_env_runner_failures_tolerance": 100, "env_runner_health_probe_timeout_s": 30.0, "env_runner_restore_timeout_s": 1800.0, "_model_config": {}, "_rl_module_spec": "RLModuleSpec(module_class=None, observation_space=None, action_space=None, inference_only=False, learner_only=False, model_config=DefaultModelConfig(fcnet_hiddens=[60, 90], fcnet_activation='tanh', fcnet_kernel_initializer=None, fcnet_kernel_initializer_kwargs=None, fcnet_bias_initializer=None, fcnet_bias_initializer_kwargs=None, conv_filters=None, conv_activation='relu', conv_kernel_initializer=None, conv_kernel_initializer_kwargs=None, conv_bias_initializer=None, conv_bias_initializer_kwargs=None, head_fcnet_hiddens=[], head_fcnet_activation='relu', head_fcnet_kernel_initializer=None, head_fcnet_kernel_initializer_kwargs=None, head_fcnet_bias_initializer=None, head_fcnet_bias_initializer_kwargs=None, free_log_std=False, log_std_clip_param=20.0, vf_share_layers=True, use_lstm=False, max_seq_len=20, lstm_cell_size=256, lstm_use_prev_action=False, lstm_use_prev_reward=False, lstm_kernel_initializer=None, lstm_kernel_initializer_kwargs=None, lstm_bias_initializer=None, lstm_bias_initializer_kwargs=None), catalog_class=None, load_state_path=None, model_config_dict=None)", "algorithm_config_overrides_per_module": {}, "_per_module_overrides": {}, "_validate_config": true, "_use_msgpack_checkpoints": false, "_torch_grad_scaler_class": null, "_torch_lr_scheduler_classes": null, "_tf_policy_handles_more_than_one_loss": false, "_disable_preprocessor_api": false, "_disable_action_flattening": false, "_disable_initialize_loss_from_dummy_batch": false, "_dont_auto_sync_env_runner_states": false, "env_task_fn": -1, "enable_connectors": -1, "simple_optimizer": false, "policy_map_cache": -1, "worker_cls": -1, "synchronize_filters": -1, "enable_async_evaluation": -1, "custom_async_evaluation_function": -1, "_enable_rl_module_api": -1, "auto_wrap_old_gym_envs": -1, "always_attach_evaluation_results": -1, "replay_sequence_length": null, "_disable_execution_plan_api": -1, "use_critic": true, "use_gae": true, "use_kl_loss": true, "kl_coeff": 0.7464963036515, "kl_target": 0.0270990929592, "vf_loss_coeff": 0.6688075857018, "entropy_coeff": 0.0090570820258, "clip_param": 0.1221781641624, "vf_clip_param": 0.1027808522125, "entropy_coeff_schedule": null, "lr_schedule": null, "sgd_minibatch_size": -1, "vf_share_layers": -1, "__stdout_file__": null, "__stderr_file__": null, "lambda": 0.9099046732075, "input": "sampler", "policies": {"default_policy": [null, null, null, null]}, "callbacks": "<class 'ray.rllib.callbacks.callbacks.RLlibCallback'>", "create_env_on_driver": false, "custom_eval_function": null, "framework": "torch"}, "time_since_restore": 4.962333679199219, "iterations_since_restore": 3, "perf": {"cpu_util_percent": 38.49999999999999, "ram_util_percent": 74.73333333333333}}
{"timers": {"training_iteration": 1.5578026217496554, "restore_env_runners": 9.832156702643263e-06, "training_step": 1.5576838623618685, "env_runner_sampling_timer": 1.449001160799629, "learner_update_timer": 0.10574371171114652, "synch_weights": 0.0005990451622855617, "restore_eval_env_runners": 7.756677619181574e-06, "evaluation_iteration": 0.10307194542224751, "synch_eval_env_connectors": 0.00011829625180689617, "synch_env_connectors": 4.55656717531383e-06}, "env_runners": {"num_episodes_lifetime": -61250.0, "episode_len_mean": 20.0, "env_to_module_connector": {"timers": {"connectors": {"batch_individual_items": 6.681900453684978e-06, "add_observations_from_episodes_to_batch": 3.169946582994574e-06, "add_states_from_episodes_to_batch": 1.8167721783563465e-06, "numpy_to_tensor": 9.292232454769362e-06, "add_time_dim_to_batch_and_zero_pad": 2.703082896827971e-06}}, "connector_pipeline_timer": 4.624686389208513e-05}, "agent_episode_returns_mean": {"default_agent": 3.7799999999999994}, "episode_return_max": 12.5, "num_module_steps_sampled_lifetime": {"default_policy": -1225000.0}, "env_step_timer": 1.4969155070261335e-05, "module_to_env_connector": {"timers": {"connectors": {"listify_data_for_vector_env": 1.1977120148693446e-05, "remove_single_ts_time_rank_from_batch": 6.308846734428455e-07, "tensor_to_numpy": 1.430382658028638e-05, "un_batch_to_individual_items": 5.9998375006560785e-06, "get_actions": 4.3201670501098086e-05, "normalize_and_clip_actions": 9.97968179448849e-06}}, "connector_pipeline_timer": 0.00011288180343038822}, "module_episode_returns_mean": {"default_policy": 3.7799999999999994}, "num_env_steps_sampled_lifetime": -1225000.0, "episode_len_min": 20, "episode_return_min": -7.5, "time_between_sampling": 0.0019255844926457078, "num_env_steps_sampled": 5000.0, "num_module_steps_sampled": {"default_policy": 5000.0}, "num_episodes": 250.0, "episode_len_max": 20, "num_agent_steps_sampled": {"default_agent": 5000.0}, "episode_duration_sec_mean": 0.00491028651688248, "env_to_module_sum_episodes_length_in": 10.36823839457432, "num_agent_steps_sampled_lifetime": {"default_agent": -1225000.0}, "env_to_module_sum_episodes_length_out": 10.36823839457432, "rlmodule_inference_timer": 3.0220726217633963e-05, "episode_return_mean": 3.7799999999999994, "sample": 0.005351041700519476, "env_reset_timer": 3.957003110893948e-05, "weights_seq_no": 3.0, "num_env_steps_sampled_lifetime_throughput": 3538.3507773406395}, "learners": {"__all_modules__": {"num_non_trainable_parameters": 0, "learner_connector": {"timers": {"connectors": {"add_time_dim_to_batch_and_zero_pad": 9.916283306665718e-06, "batch_individual_items": 0.03059240392165701, "add_one_ts_to_episodes_and_truncate": 0.007656280449043145, "general_advantage_estimation": 0.007602717065759933, "numpy_to_tensor": 6.763438845204655e-05, "add_observations_from_episodes_to_batch": 0.0008048559473025381, "add_states_from_episodes_to_batch": 3.2218533917330202e-06, "add_columns_from_episodes_to_train_batch": 0.034288561810985316}}, "connector_pipeline_timer": 0.08113987146084871}, "num_env_steps_trained_lifetime": 126000, "num_env_steps_trained": 31500, "num_module_steps_trained_lifetime": 24000, "num_module_steps_trained": 6000, "learner_connector_sum_episodes_length_out": 5250.0, "num_trainable_parameters": 6003, "learner_connector_sum_episodes_length_in": 5000.0, "num_env_steps_trained_lifetime_throughput": 2681203.6464217235, "num_module_steps_trained_throughput": 513776.4911296568, "num_module_steps_trained_lifetime_throughput": 512698.72174840415}, "default_policy": {"diff_num_grad_updates_vs_sampler_policy": 1.0, "vf_loss_unclipped": 28.318328857421875, "num_module_steps_trained": 6000, "total_loss": 0.23179858922958374, "num_trainable_parameters": 6003, "gradients_default_optimizer_global_norm": 0.026392024010419846, "weights_seq_no": 4.0, "mean_kl_loss": 0.0018568553496152163, "vf_explained_var": 0.01967012882232666, "vf_loss": 0.10008808225393295, "policy_loss": 0.1708587259054184, "default_optimizer_learning_rate": 0.0002847858517, "entropy": 0.6815755367279053, "num_module_steps_trained_lifetime": 24000, "curr_entropy_coeff": 0.0090570820258, "curr_kl_coeff": 0.04665601998567581, "module_train_batch_size_mean": 1000.0, "num_module_steps_trained_lifetime_throughput": 515143.9172682045}}, "num_training_step_calls_per_iteration": 1, "evaluation": {"env_runners": {"num_agent_steps_sampled": {"default_agent": 400}, "num_env_steps_sampled_lifetime": 20400, "env_to_module_connector": {"timers": {"connectors": {"add_states_from_episodes_to_batch": 1.6174571225001038e-06, "batch_individual_items": 6.101368735508174e-06, "numpy_to_tensor": 8.153031051339268e-06, "add_observations_from_episodes_to_batch": 2.76454420782976e-06, "add_time_dim_to_batch_and_zero_pad": 2.281921452960839e-06}}, "connector_pipeline_timer": 4.245357963621061e-05}, "episode_return_min": -16.5, "num_episodes": 20, "num_episodes_lifetime": 80, "module_to_env_connector": {"timers": {"connectors": {"un_batch_to_individual_items": 5.261523207750086e-06, "normalize_and_clip_actions": 9.248993653512128e-06, "listify_data_for_vector_env": 1.0659040408093417e-05, "tensor_to_numpy": 1.2660045629208315e-05, "get_actions": 3.453574224508789e-05, "remove_single_ts_time_rank_from_batch": 5.719030340292334e-07}}, "connector_pipeline_timer": 9.833181930675034e-05}, "episode_len_mean": 20.0, "weights_seq_no": 4.0, "episode_return_max": 12.5, "num_agent_steps_sampled_lifetime": {"default_agent": 1600}, "episode_len_min": 20, "num_env_steps_sampled": 400, "episode_duration_sec_mean": 0.004435049521271139, "module_episode_returns_mean": {"default_policy": -1.35}, "episode_return_mean": -1.35, "env_reset_timer": 0.000162636273160344, "env_step_timer": 1.3507857600538161e-05, "num_module_steps_sampled": {"default_policy": 400}, "agent_episode_returns_mean": {"default_agent": -1.35}, "episode_len_max": 20, "env_to_module_sum_episodes_length_in": 10.368237912813044, "num_module_steps_sampled_lifetime": {"default_policy": 1600}, "env_to_module_sum_episodes_length_out": 10.368237912813044, "rlmodule_inference_timer": 2.636327377623482e-05, "sample": 0.09698388430893037, "time_between_sampling": 1.550956518902362}, "num_healthy_workers": 1, "actor_manager_num_outstanding_async_reqs": 0, "num_remote_worker_restarts": 0}, "num_env_steps_sampled_lifetime": -1225000.0, "fault_tolerance": {"num_healthy_workers": 0, "num_remote_worker_restarts": 0}, "env_runner_group": {"actor_manager_num_outstanding_async_reqs": 0}, "done": false, "training_iteration": 4, "trial_id": "49be2_00000", "date": "2025-08-11_19-36-16", "timestamp": 1754933776, "time_this_iter_s": 1.8167290687561035, "time_total_s": 6.779062747955322, "pid": 28164, "hostname": "Mac", "node_ip": "127.0.0.1", "config": {"exploration_config": {}, "extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "placement_strategy": "PACK", "num_gpus": 0, "_fake_gpus": false, "num_cpus_for_main_process": 2, "eager_tracing": true, "eager_max_retraces": 20, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "torch_compile_learner": false, "torch_compile_learner_what_to_compile": "forward_train", "torch_compile_learner_dynamo_backend": "aot_eager", "torch_compile_learner_dynamo_mode": null, "torch_compile_worker": false, "torch_compile_worker_dynamo_backend": "aot_eager", "torch_compile_worker_dynamo_mode": null, "torch_ddp_kwargs": {}, "torch_skip_nan_gradients": false, "env": "Umbrella", "env_config": {}, "observation_space": null, "action_space": null, "clip_rewards": null, "normalize_actions": true, "clip_actions": false, "_is_atari": null, "disable_env_checking": false, "render_env": false, "action_mask_key": "action_mask", "env_runner_cls": null, "num_env_runners": 0, "create_local_env_runner": true, "num_envs_per_env_runner": 1, "gym_env_vectorize_mode": "SYNC", "num_cpus_per_env_runner": 1, "num_gpus_per_env_runner": 0, "custom_resources_per_env_runner": {}, "validate_env_runners_after_construction": true, "episodes_to_numpy": true, "max_requests_in_flight_per_env_runner": 1, "sample_timeout_s": 60.0, "_env_to_module_connector": null, "add_default_connectors_to_env_to_module_pipeline": true, "_module_to_env_connector": null, "add_default_connectors_to_module_to_env_pipeline": true, "merge_env_runner_states": "training_only", "broadcast_env_runner_states": true, "episode_lookback_horizon": 1, "rollout_fragment_length": "auto", "batch_mode": "complete_episodes", "compress_observations": false, "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "enable_tf1_exec_eagerly": false, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "preprocessor_pref": "deepmind", "observation_filter": "NoFilter", "update_worker_filter_stats": true, "use_worker_filter_stats": true, "sampler_perf_stats_ema_coef": null, "_is_online": true, "num_learners": 0, "num_gpus_per_learner": 0, "num_cpus_per_learner": "auto", "num_aggregator_actors_per_learner": 0, "max_requests_in_flight_per_aggregator_actor": 3, "local_gpu_idx": 0, "max_requests_in_flight_per_learner": 3, "gamma": 1, "lr": 0.0002847858517, "grad_clip": 0.5, "grad_clip_by": "global_norm", "_train_batch_size_per_learner": 5000, "train_batch_size": 4000, "num_epochs": 1, "minibatch_size": 1000, "shuffle_batch_per_epoch": true, "model": {"fcnet_hiddens": [256, 256], "fcnet_activation": "tanh", "fcnet_weights_initializer": null, "fcnet_weights_initializer_config": null, "fcnet_bias_initializer": null, "fcnet_bias_initializer_config": null, "conv_filters": null, "conv_activation": "relu", "conv_kernel_initializer": null, "conv_kernel_initializer_config": null, "conv_bias_initializer": null, "conv_bias_initializer_config": null, "conv_transpose_kernel_initializer": null, "conv_transpose_kernel_initializer_config": null, "conv_transpose_bias_initializer": null, "conv_transpose_bias_initializer_config": null, "post_fcnet_hiddens": [], "post_fcnet_activation": "relu", "post_fcnet_weights_initializer": null, "post_fcnet_weights_initializer_config": null, "post_fcnet_bias_initializer": null, "post_fcnet_bias_initializer_config": null, "free_log_std": false, "log_std_clip_param": 20.0, "no_final_linear": false, "vf_share_layers": false, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "lstm_weights_initializer": null, "lstm_weights_initializer_config": null, "lstm_bias_initializer": null, "lstm_bias_initializer_config": null, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "attention_use_n_prev_actions": 0, "attention_use_n_prev_rewards": 0, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": null, "custom_model_config": {}, "custom_action_dist": null, "custom_preprocessor": null, "encoder_latent_dim": null, "always_check_shapes": false, "lstm_use_prev_action_reward": -1, "_use_default_native_models": -1, "_disable_preprocessor_api": false, "_disable_action_flattening": false}, "_learner_connector": null, "add_default_connectors_to_learner_pipeline": true, "learner_config_dict": {}, "optimizer": {}, "_learner_class": null, "callbacks_on_algorithm_init": null, "callbacks_on_env_runners_recreated": null, "callbacks_on_offline_eval_runners_recreated": null, "callbacks_on_checkpoint_loaded": null, "callbacks_on_environment_created": null, "callbacks_on_episode_created": null, "callbacks_on_episode_start": null, "callbacks_on_episode_step": null, "callbacks_on_episode_end": null, "callbacks_on_evaluate_start": null, "callbacks_on_evaluate_end": null, "callbacks_on_evaluate_offline_start": null, "callbacks_on_evaluate_offline_end": null, "callbacks_on_sample_end": null, "callbacks_on_train_result": null, "explore": true, "enable_rl_module_and_learner": true, "enable_env_runner_and_connector_v2": true, "_prior_exploration_config": {"type": "StochasticSampling"}, "count_steps_by": "env_steps", "policy_map_capacity": 100, "policy_mapping_fn": "<function AlgorithmConfig.DEFAULT_POLICY_MAPPING_FN at 0x145c2d8a0>", "policies_to_train": null, "policy_states_are_swappable": false, "observation_fn": null, "offline_data_class": null, "input_read_method": "read_parquet", "input_read_method_kwargs": {}, "input_read_schema": {}, "input_read_episodes": false, "input_read_sample_batches": false, "input_read_batch_size": null, "input_filesystem": null, "input_filesystem_kwargs": {}, "input_compress_columns": ["obs", "new_obs"], "input_spaces_jsonable": true, "materialize_data": false, "materialize_mapped_data": true, "map_batches_kwargs": {}, "iter_batches_kwargs": {}, "ignore_final_observation": false, "prelearner_class": null, "prelearner_buffer_class": null, "prelearner_buffer_kwargs": {}, "prelearner_module_synch_period": 10, "dataset_num_iters_per_learner": null, "input_config": {}, "actions_in_input_normalized": false, "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_config": {}, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "output_max_rows_per_file": null, "output_write_remaining_data": false, "output_write_method": "write_parquet", "output_write_method_kwargs": {}, "output_filesystem": null, "output_filesystem_kwargs": {}, "output_write_episodes": true, "offline_sampling": false, "evaluation_interval": 1, "evaluation_duration": 20, "evaluation_duration_unit": "episodes", "evaluation_sample_timeout_s": 120.0, "evaluation_auto_duration_min_env_steps_per_sample": 100, "evaluation_auto_duration_max_env_steps_per_sample": 2000, "evaluation_parallel_to_training": false, "evaluation_force_reset_envs_before_iteration": true, "evaluation_config": null, "off_policy_estimation_methods": {}, "ope_split_batch_by_episode": true, "evaluation_num_env_runners": 1, "in_evaluation": false, "sync_filters_on_rollout_workers_timeout_s": 10.0, "offline_evaluation_interval": null, "num_offline_eval_runners": 0, "offline_loss_for_module_fn": null, "offline_evaluation_duration": 1, "offline_evaluation_parallel_to_training": false, "offline_evaluation_timeout_s": 120.0, "num_cpus_per_offline_eval_runner": 1, "num_gpus_per_offline_eval_runner": 0, "custom_resources_per_offline_eval_runner": {}, "restart_failed_offline_eval_runners": true, "ignore_offline_eval_runner_failures": false, "max_num_offline_eval_runner_restarts": 1000, "offline_eval_runner_restore_timeout_s": 1800.0, "max_requests_in_flight_per_offline_eval_runner": 1, "validate_offline_eval_runners_after_construction": true, "offline_eval_runner_health_probe_timeout_s": 30.0, "offline_eval_rl_module_inference_only": false, "broadcast_offline_eval_runner_states": false, "offline_eval_batch_size_per_runner": 256, "dataset_num_iters_per_eval_runner": 1, "keep_per_episode_custom_metrics": false, "metrics_episode_collection_timeout_s": 60.0, "metrics_num_episodes_for_smoothing": 100, "min_time_s_per_iteration": null, "min_train_timesteps_per_iteration": 0, "min_sample_timesteps_per_iteration": 0, "log_gradients": true, "export_native_model_files": false, "checkpoint_trainable_policies_only": false, "logger_creator": null, "logger_config": null, "log_level": "WARN", "log_sys_usage": true, "fake_sampler": false, "seed": 4, "restart_failed_env_runners": true, "ignore_env_runner_failures": false, "max_num_env_runner_restarts": 1000, "delay_between_env_runner_restarts_s": 60.0, "restart_failed_sub_environments": false, "num_consecutive_env_runner_failures_tolerance": 100, "env_runner_health_probe_timeout_s": 30.0, "env_runner_restore_timeout_s": 1800.0, "_model_config": {}, "_rl_module_spec": "RLModuleSpec(module_class=None, observation_space=None, action_space=None, inference_only=False, learner_only=False, model_config=DefaultModelConfig(fcnet_hiddens=[60, 90], fcnet_activation='tanh', fcnet_kernel_initializer=None, fcnet_kernel_initializer_kwargs=None, fcnet_bias_initializer=None, fcnet_bias_initializer_kwargs=None, conv_filters=None, conv_activation='relu', conv_kernel_initializer=None, conv_kernel_initializer_kwargs=None, conv_bias_initializer=None, conv_bias_initializer_kwargs=None, head_fcnet_hiddens=[], head_fcnet_activation='relu', head_fcnet_kernel_initializer=None, head_fcnet_kernel_initializer_kwargs=None, head_fcnet_bias_initializer=None, head_fcnet_bias_initializer_kwargs=None, free_log_std=False, log_std_clip_param=20.0, vf_share_layers=True, use_lstm=False, max_seq_len=20, lstm_cell_size=256, lstm_use_prev_action=False, lstm_use_prev_reward=False, lstm_kernel_initializer=None, lstm_kernel_initializer_kwargs=None, lstm_bias_initializer=None, lstm_bias_initializer_kwargs=None), catalog_class=None, load_state_path=None, model_config_dict=None)", "algorithm_config_overrides_per_module": {}, "_per_module_overrides": {}, "_validate_config": true, "_use_msgpack_checkpoints": false, "_torch_grad_scaler_class": null, "_torch_lr_scheduler_classes": null, "_tf_policy_handles_more_than_one_loss": false, "_disable_preprocessor_api": false, "_disable_action_flattening": false, "_disable_initialize_loss_from_dummy_batch": false, "_dont_auto_sync_env_runner_states": false, "env_task_fn": -1, "enable_connectors": -1, "simple_optimizer": false, "policy_map_cache": -1, "worker_cls": -1, "synchronize_filters": -1, "enable_async_evaluation": -1, "custom_async_evaluation_function": -1, "_enable_rl_module_api": -1, "auto_wrap_old_gym_envs": -1, "always_attach_evaluation_results": -1, "replay_sequence_length": null, "_disable_execution_plan_api": -1, "use_critic": true, "use_gae": true, "use_kl_loss": true, "kl_coeff": 0.7464963036515, "kl_target": 0.0270990929592, "vf_loss_coeff": 0.6688075857018, "entropy_coeff": 0.0090570820258, "clip_param": 0.1221781641624, "vf_clip_param": 0.1027808522125, "entropy_coeff_schedule": null, "lr_schedule": null, "sgd_minibatch_size": -1, "vf_share_layers": -1, "__stdout_file__": null, "__stderr_file__": null, "lambda": 0.9099046732075, "input": "sampler", "policies": {"default_policy": [null, null, null, null]}, "callbacks": "<class 'ray.rllib.callbacks.callbacks.RLlibCallback'>", "create_env_on_driver": false, "custom_eval_function": null, "framework": "torch"}, "time_since_restore": 6.779062747955322, "iterations_since_restore": 4, "perf": {"cpu_util_percent": 44.2, "ram_util_percent": 78.35}}
{"timers": {"training_iteration": 1.5574916376132635, "restore_env_runners": 9.782164956473281e-06, "training_step": 1.5573725062382124, "env_runner_sampling_timer": 1.4488376783615535, "learner_update_timer": 0.1055949295932558, "synch_weights": 0.0005987626307259931, "restore_eval_env_runners": 7.879530296893791e-06, "evaluation_iteration": 0.10311552054863736, "synch_eval_env_connectors": 0.00011816203883441629, "synch_env_connectors": 4.558091501239687e-06}, "env_runners": {"num_episodes_lifetime": -92125.0, "episode_len_mean": 20.0, "env_to_module_connector": {"timers": {"connectors": {"batch_individual_items": 6.0917009379677105e-06, "add_observations_from_episodes_to_batch": 2.889818513707363e-06, "add_states_from_episodes_to_batch": 1.730648945254756e-06, "numpy_to_tensor": 8.288823478899828e-06, "add_time_dim_to_batch_and_zero_pad": 2.3521912960984564e-06}}, "connector_pipeline_timer": 4.263319207818886e-05}, "agent_episode_returns_mean": {"default_agent": 4.5}, "episode_return_max": 12.5, "num_module_steps_sampled_lifetime": {"default_policy": -1842500.0}, "env_step_timer": 1.3484886913751915e-05, "module_to_env_connector": {"timers": {"connectors": {"listify_data_for_vector_env": 1.090836490494617e-05, "remove_single_ts_time_rank_from_batch": 5.787210454146864e-07, "tensor_to_numpy": 1.2968844498487857e-05, "un_batch_to_individual_items": 5.294918859024249e-06, "get_actions": 3.786728875749738e-05, "normalize_and_clip_actions": 9.259150689707283e-06}}, "connector_pipeline_timer": 0.00010202152641003692}, "module_episode_returns_mean": {"default_policy": 4.5}, "num_env_steps_sampled_lifetime": -1842500.0, "episode_len_min": 20, "episode_return_min": -7.5, "time_between_sampling": 0.001637631264710724, "num_env_steps_sampled": 5000.0, "num_module_steps_sampled": {"default_policy": 5000.0}, "num_episodes": 250.0, "episode_len_max": 20, "num_agent_steps_sampled": {"default_agent": 5000.0}, "episode_duration_sec_mean": 0.004793807643931358, "env_to_module_sum_episodes_length_in": 10.36823839457432, "num_agent_steps_sampled_lifetime": {"default_agent": -1842500.0}, "env_to_module_sum_episodes_length_out": 10.36823839457432, "rlmodule_inference_timer": 4.459618024132067e-05, "episode_return_mean": 4.5, "sample": 0.004944204076376104, "env_reset_timer": 3.335909042853778e-05, "weights_seq_no": 4.0, "num_env_steps_sampled_lifetime_throughput": 3790.783267462954}, "learners": {"__all_modules__": {"num_non_trainable_parameters": 0, "learner_connector": {"timers": {"connectors": {"add_time_dim_to_batch_and_zero_pad": 9.892960399156435e-06, "batch_individual_items": 0.030582683212366794, "add_one_ts_to_episodes_and_truncate": 0.007655725144145093, "general_advantage_estimation": 0.007578048644726675, "numpy_to_tensor": 6.745096450243961e-05, "add_observations_from_episodes_to_batch": 0.0008050169776982966, "add_states_from_episodes_to_batch": 3.215044830110855e-06, "add_columns_from_episodes_to_train_batch": 0.03429291161219727}}, "connector_pipeline_timer": 0.081108837326227}, "num_env_steps_trained_lifetime": 157500, "num_env_steps_trained": 31500, "num_module_steps_trained_lifetime": 30000, "num_module_steps_trained": 6000, "learner_connector_sum_episodes_length_out": 5250.0, "num_trainable_parameters": 6003, "learner_connector_sum_episodes_length_in": 5000.0, "num_env_steps_trained_lifetime_throughput": 2669709.1565772267, "num_module_steps_trained_throughput": 511493.2146870121, "num_module_steps_trained_lifetime_throughput": 510444.6861190061}, "default_policy": {"diff_num_grad_updates_vs_sampler_policy": 1.0, "vf_loss_unclipped": 28.426040649414062, "num_module_steps_trained": 6000, "total_loss": 0.16066518425941467, "num_trainable_parameters": 6003, "gradients_default_optimizer_global_norm": 0.055656589567661285, "weights_seq_no": 5.0, "mean_kl_loss": 0.001579137286171317, "vf_explained_var": 0.02140355110168457, "vf_loss": 0.1004083901643753, "policy_loss": 0.09948650747537613, "default_optimizer_learning_rate": 0.0002847858517, "entropy": 0.6678587794303894, "num_module_steps_trained_lifetime": 30000, "curr_entropy_coeff": 0.0090570820258, "curr_kl_coeff": 0.023328009992837906, "module_train_batch_size_mean": 1000.0, "num_module_steps_trained_lifetime_throughput": 512789.85087222804}}, "num_training_step_calls_per_iteration": 1, "evaluation": {"env_runners": {"num_agent_steps_sampled": {"default_agent": 400}, "num_env_steps_sampled_lifetime": 25400, "env_to_module_connector": {"timers": {"connectors": {"add_states_from_episodes_to_batch": 1.5959991359272734e-06, "batch_individual_items": 6.011363429300233e-06, "numpy_to_tensor": 7.914119313873843e-06, "add_observations_from_episodes_to_batch": 2.786138166928038e-06, "add_time_dim_to_batch_and_zero_pad": 2.215560090180058e-06}}, "connector_pipeline_timer": 4.165467821359924e-05}, "episode_return_min": -16.5, "num_episodes": 20, "num_episodes_lifetime": 100, "module_to_env_connector": {"timers": {"connectors": {"un_batch_to_individual_items": 5.151859454083172e-06, "normalize_and_clip_actions": 9.096380881488525e-06, "listify_data_for_vector_env": 1.0680662679680752e-05, "tensor_to_numpy": 1.2608928853349776e-05, "get_actions": 3.374620914421792e-05, "remove_single_ts_time_rank_from_batch": 5.69057867210497e-07}}, "connector_pipeline_timer": 9.673519919707844e-05}, "episode_len_mean": 20.0, "weights_seq_no": 5.0, "episode_return_max": 12.5, "num_agent_steps_sampled_lifetime": {"default_agent": 2000}, "episode_len_min": 20, "num_env_steps_sampled": 400, "episode_duration_sec_mean": 0.004419062125962227, "module_episode_returns_mean": {"default_policy": -0.65}, "episode_return_mean": -0.65, "env_reset_timer": 0.00016171824061854976, "env_step_timer": 1.3446996855086327e-05, "num_module_steps_sampled": {"default_policy": 400}, "agent_episode_returns_mean": {"default_agent": -0.65}, "episode_len_max": 20, "env_to_module_sum_episodes_length_in": 10.368238387501162, "num_module_steps_sampled_lifetime": {"default_policy": 2000}, "env_to_module_sum_episodes_length_out": 10.368238387501162, "rlmodule_inference_timer": 2.6201079812733898e-05, "sample": 0.09696152338582195, "time_between_sampling": 1.5508827624636736}, "num_healthy_workers": 1, "actor_manager_num_outstanding_async_reqs": 0, "num_remote_worker_restarts": 0}, "num_env_steps_sampled_lifetime": -1842500.0, "fault_tolerance": {"num_healthy_workers": 0, "num_remote_worker_restarts": 0}, "env_runner_group": {"actor_manager_num_outstanding_async_reqs": 0}, "done": false, "training_iteration": 5, "trial_id": "49be2_00000", "date": "2025-08-11_19-36-17", "timestamp": 1754933777, "time_this_iter_s": 1.6282401084899902, "time_total_s": 8.407302856445312, "pid": 28164, "hostname": "Mac", "node_ip": "127.0.0.1", "config": {"exploration_config": {}, "extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "placement_strategy": "PACK", "num_gpus": 0, "_fake_gpus": false, "num_cpus_for_main_process": 2, "eager_tracing": true, "eager_max_retraces": 20, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "torch_compile_learner": false, "torch_compile_learner_what_to_compile": "forward_train", "torch_compile_learner_dynamo_backend": "aot_eager", "torch_compile_learner_dynamo_mode": null, "torch_compile_worker": false, "torch_compile_worker_dynamo_backend": "aot_eager", "torch_compile_worker_dynamo_mode": null, "torch_ddp_kwargs": {}, "torch_skip_nan_gradients": false, "env": "Umbrella", "env_config": {}, "observation_space": null, "action_space": null, "clip_rewards": null, "normalize_actions": true, "clip_actions": false, "_is_atari": null, "disable_env_checking": false, "render_env": false, "action_mask_key": "action_mask", "env_runner_cls": null, "num_env_runners": 0, "create_local_env_runner": true, "num_envs_per_env_runner": 1, "gym_env_vectorize_mode": "SYNC", "num_cpus_per_env_runner": 1, "num_gpus_per_env_runner": 0, "custom_resources_per_env_runner": {}, "validate_env_runners_after_construction": true, "episodes_to_numpy": true, "max_requests_in_flight_per_env_runner": 1, "sample_timeout_s": 60.0, "_env_to_module_connector": null, "add_default_connectors_to_env_to_module_pipeline": true, "_module_to_env_connector": null, "add_default_connectors_to_module_to_env_pipeline": true, "merge_env_runner_states": "training_only", "broadcast_env_runner_states": true, "episode_lookback_horizon": 1, "rollout_fragment_length": "auto", "batch_mode": "complete_episodes", "compress_observations": false, "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "enable_tf1_exec_eagerly": false, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "preprocessor_pref": "deepmind", "observation_filter": "NoFilter", "update_worker_filter_stats": true, "use_worker_filter_stats": true, "sampler_perf_stats_ema_coef": null, "_is_online": true, "num_learners": 0, "num_gpus_per_learner": 0, "num_cpus_per_learner": "auto", "num_aggregator_actors_per_learner": 0, "max_requests_in_flight_per_aggregator_actor": 3, "local_gpu_idx": 0, "max_requests_in_flight_per_learner": 3, "gamma": 1, "lr": 0.0002847858517, "grad_clip": 0.5, "grad_clip_by": "global_norm", "_train_batch_size_per_learner": 5000, "train_batch_size": 4000, "num_epochs": 1, "minibatch_size": 1000, "shuffle_batch_per_epoch": true, "model": {"fcnet_hiddens": [256, 256], "fcnet_activation": "tanh", "fcnet_weights_initializer": null, "fcnet_weights_initializer_config": null, "fcnet_bias_initializer": null, "fcnet_bias_initializer_config": null, "conv_filters": null, "conv_activation": "relu", "conv_kernel_initializer": null, "conv_kernel_initializer_config": null, "conv_bias_initializer": null, "conv_bias_initializer_config": null, "conv_transpose_kernel_initializer": null, "conv_transpose_kernel_initializer_config": null, "conv_transpose_bias_initializer": null, "conv_transpose_bias_initializer_config": null, "post_fcnet_hiddens": [], "post_fcnet_activation": "relu", "post_fcnet_weights_initializer": null, "post_fcnet_weights_initializer_config": null, "post_fcnet_bias_initializer": null, "post_fcnet_bias_initializer_config": null, "free_log_std": false, "log_std_clip_param": 20.0, "no_final_linear": false, "vf_share_layers": false, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "lstm_weights_initializer": null, "lstm_weights_initializer_config": null, "lstm_bias_initializer": null, "lstm_bias_initializer_config": null, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "attention_use_n_prev_actions": 0, "attention_use_n_prev_rewards": 0, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": null, "custom_model_config": {}, "custom_action_dist": null, "custom_preprocessor": null, "encoder_latent_dim": null, "always_check_shapes": false, "lstm_use_prev_action_reward": -1, "_use_default_native_models": -1, "_disable_preprocessor_api": false, "_disable_action_flattening": false}, "_learner_connector": null, "add_default_connectors_to_learner_pipeline": true, "learner_config_dict": {}, "optimizer": {}, "_learner_class": null, "callbacks_on_algorithm_init": null, "callbacks_on_env_runners_recreated": null, "callbacks_on_offline_eval_runners_recreated": null, "callbacks_on_checkpoint_loaded": null, "callbacks_on_environment_created": null, "callbacks_on_episode_created": null, "callbacks_on_episode_start": null, "callbacks_on_episode_step": null, "callbacks_on_episode_end": null, "callbacks_on_evaluate_start": null, "callbacks_on_evaluate_end": null, "callbacks_on_evaluate_offline_start": null, "callbacks_on_evaluate_offline_end": null, "callbacks_on_sample_end": null, "callbacks_on_train_result": null, "explore": true, "enable_rl_module_and_learner": true, "enable_env_runner_and_connector_v2": true, "_prior_exploration_config": {"type": "StochasticSampling"}, "count_steps_by": "env_steps", "policy_map_capacity": 100, "policy_mapping_fn": "<function AlgorithmConfig.DEFAULT_POLICY_MAPPING_FN at 0x145c2d8a0>", "policies_to_train": null, "policy_states_are_swappable": false, "observation_fn": null, "offline_data_class": null, "input_read_method": "read_parquet", "input_read_method_kwargs": {}, "input_read_schema": {}, "input_read_episodes": false, "input_read_sample_batches": false, "input_read_batch_size": null, "input_filesystem": null, "input_filesystem_kwargs": {}, "input_compress_columns": ["obs", "new_obs"], "input_spaces_jsonable": true, "materialize_data": false, "materialize_mapped_data": true, "map_batches_kwargs": {}, "iter_batches_kwargs": {}, "ignore_final_observation": false, "prelearner_class": null, "prelearner_buffer_class": null, "prelearner_buffer_kwargs": {}, "prelearner_module_synch_period": 10, "dataset_num_iters_per_learner": null, "input_config": {}, "actions_in_input_normalized": false, "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_config": {}, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "output_max_rows_per_file": null, "output_write_remaining_data": false, "output_write_method": "write_parquet", "output_write_method_kwargs": {}, "output_filesystem": null, "output_filesystem_kwargs": {}, "output_write_episodes": true, "offline_sampling": false, "evaluation_interval": 1, "evaluation_duration": 20, "evaluation_duration_unit": "episodes", "evaluation_sample_timeout_s": 120.0, "evaluation_auto_duration_min_env_steps_per_sample": 100, "evaluation_auto_duration_max_env_steps_per_sample": 2000, "evaluation_parallel_to_training": false, "evaluation_force_reset_envs_before_iteration": true, "evaluation_config": null, "off_policy_estimation_methods": {}, "ope_split_batch_by_episode": true, "evaluation_num_env_runners": 1, "in_evaluation": false, "sync_filters_on_rollout_workers_timeout_s": 10.0, "offline_evaluation_interval": null, "num_offline_eval_runners": 0, "offline_loss_for_module_fn": null, "offline_evaluation_duration": 1, "offline_evaluation_parallel_to_training": false, "offline_evaluation_timeout_s": 120.0, "num_cpus_per_offline_eval_runner": 1, "num_gpus_per_offline_eval_runner": 0, "custom_resources_per_offline_eval_runner": {}, "restart_failed_offline_eval_runners": true, "ignore_offline_eval_runner_failures": false, "max_num_offline_eval_runner_restarts": 1000, "offline_eval_runner_restore_timeout_s": 1800.0, "max_requests_in_flight_per_offline_eval_runner": 1, "validate_offline_eval_runners_after_construction": true, "offline_eval_runner_health_probe_timeout_s": 30.0, "offline_eval_rl_module_inference_only": false, "broadcast_offline_eval_runner_states": false, "offline_eval_batch_size_per_runner": 256, "dataset_num_iters_per_eval_runner": 1, "keep_per_episode_custom_metrics": false, "metrics_episode_collection_timeout_s": 60.0, "metrics_num_episodes_for_smoothing": 100, "min_time_s_per_iteration": null, "min_train_timesteps_per_iteration": 0, "min_sample_timesteps_per_iteration": 0, "log_gradients": true, "export_native_model_files": false, "checkpoint_trainable_policies_only": false, "logger_creator": null, "logger_config": null, "log_level": "WARN", "log_sys_usage": true, "fake_sampler": false, "seed": 4, "restart_failed_env_runners": true, "ignore_env_runner_failures": false, "max_num_env_runner_restarts": 1000, "delay_between_env_runner_restarts_s": 60.0, "restart_failed_sub_environments": false, "num_consecutive_env_runner_failures_tolerance": 100, "env_runner_health_probe_timeout_s": 30.0, "env_runner_restore_timeout_s": 1800.0, "_model_config": {}, "_rl_module_spec": "RLModuleSpec(module_class=None, observation_space=None, action_space=None, inference_only=False, learner_only=False, model_config=DefaultModelConfig(fcnet_hiddens=[60, 90], fcnet_activation='tanh', fcnet_kernel_initializer=None, fcnet_kernel_initializer_kwargs=None, fcnet_bias_initializer=None, fcnet_bias_initializer_kwargs=None, conv_filters=None, conv_activation='relu', conv_kernel_initializer=None, conv_kernel_initializer_kwargs=None, conv_bias_initializer=None, conv_bias_initializer_kwargs=None, head_fcnet_hiddens=[], head_fcnet_activation='relu', head_fcnet_kernel_initializer=None, head_fcnet_kernel_initializer_kwargs=None, head_fcnet_bias_initializer=None, head_fcnet_bias_initializer_kwargs=None, free_log_std=False, log_std_clip_param=20.0, vf_share_layers=True, use_lstm=False, max_seq_len=20, lstm_cell_size=256, lstm_use_prev_action=False, lstm_use_prev_reward=False, lstm_kernel_initializer=None, lstm_kernel_initializer_kwargs=None, lstm_bias_initializer=None, lstm_bias_initializer_kwargs=None), catalog_class=None, load_state_path=None, model_config_dict=None)", "algorithm_config_overrides_per_module": {}, "_per_module_overrides": {}, "_validate_config": true, "_use_msgpack_checkpoints": false, "_torch_grad_scaler_class": null, "_torch_lr_scheduler_classes": null, "_tf_policy_handles_more_than_one_loss": false, "_disable_preprocessor_api": false, "_disable_action_flattening": false, "_disable_initialize_loss_from_dummy_batch": false, "_dont_auto_sync_env_runner_states": false, "env_task_fn": -1, "enable_connectors": -1, "simple_optimizer": false, "policy_map_cache": -1, "worker_cls": -1, "synchronize_filters": -1, "enable_async_evaluation": -1, "custom_async_evaluation_function": -1, "_enable_rl_module_api": -1, "auto_wrap_old_gym_envs": -1, "always_attach_evaluation_results": -1, "replay_sequence_length": null, "_disable_execution_plan_api": -1, "use_critic": true, "use_gae": true, "use_kl_loss": true, "kl_coeff": 0.7464963036515, "kl_target": 0.0270990929592, "vf_loss_coeff": 0.6688075857018, "entropy_coeff": 0.0090570820258, "clip_param": 0.1221781641624, "vf_clip_param": 0.1027808522125, "entropy_coeff_schedule": null, "lr_schedule": null, "sgd_minibatch_size": -1, "vf_share_layers": -1, "__stdout_file__": null, "__stderr_file__": null, "lambda": 0.9099046732075, "input": "sampler", "policies": {"default_policy": [null, null, null, null]}, "callbacks": "<class 'ray.rllib.callbacks.callbacks.RLlibCallback'>", "create_env_on_driver": false, "custom_eval_function": null, "framework": "torch"}, "time_since_restore": 8.407302856445312, "iterations_since_restore": 5, "perf": {"cpu_util_percent": 35.03333333333333, "ram_util_percent": 75.83333333333333}}
{"timers": {"training_iteration": 1.557158057066618, "restore_env_runners": 9.738092260996044e-06, "training_step": 1.557038514515816, "env_runner_sampling_timer": 1.447794895747836, "learner_update_timer": 0.10630359612735725, "synch_weights": 0.0005983116647379274, "restore_eval_env_runners": 7.864485188310501e-06, "evaluation_iteration": 0.10307912201312122, "synch_eval_env_connectors": 0.00011798416881316223, "synch_env_connectors": 4.54835020720493e-06}, "env_runners": {"num_episodes_lifetime": -123000.0, "episode_len_mean": 20.0, "env_to_module_connector": {"timers": {"connectors": {"batch_individual_items": 6.0593781250727094e-06, "add_observations_from_episodes_to_batch": 2.875798301034982e-06, "add_states_from_episodes_to_batch": 1.7186352008355488e-06, "numpy_to_tensor": 8.270411085264e-06, "add_time_dim_to_batch_and_zero_pad": 2.3369215550185453e-06}}, "connector_pipeline_timer": 4.2401670291251014e-05}, "agent_episode_returns_mean": {"default_agent": 6.3400000000000025}, "episode_return_max": 12.5, "num_module_steps_sampled_lifetime": {"default_policy": -2460000.0}, "env_step_timer": 1.3466171260058778e-05, "module_to_env_connector": {"timers": {"connectors": {"listify_data_for_vector_env": 1.0846108637393946e-05, "remove_single_ts_time_rank_from_batch": 5.744831383125134e-07, "tensor_to_numpy": 1.2916155766048832e-05, "un_batch_to_individual_items": 5.257818057675122e-06, "get_actions": 3.799616053916237e-05, "normalize_and_clip_actions": 9.228599156116692e-06}}, "connector_pipeline_timer": 0.00010180126388560572}, "module_episode_returns_mean": {"default_policy": 6.3400000000000025}, "num_env_steps_sampled_lifetime": -2460000.0, "episode_len_min": 20, "episode_return_min": -7.5, "time_between_sampling": 0.0014649184181471176, "num_env_steps_sampled": 5000.0, "num_module_steps_sampled": {"default_policy": 5000.0}, "num_episodes": 250.0, "episode_len_max": 20, "num_agent_steps_sampled": {"default_agent": 5000.0}, "episode_duration_sec_mean": 0.004444873036816718, "env_to_module_sum_episodes_length_in": 10.36823839457432, "num_agent_steps_sampled_lifetime": {"default_agent": -2460000.0}, "env_to_module_sum_episodes_length_out": 10.36823839457432, "rlmodule_inference_timer": 2.7302702723608894e-05, "episode_return_mean": 6.3400000000000025, "sample": 0.005016268799731697, "env_reset_timer": 3.085049493731015e-05, "weights_seq_no": 5.0, "num_env_steps_sampled_lifetime_throughput": 3809.4781868696386}, "learners": {"__all_modules__": {"num_non_trainable_parameters": 0, "learner_connector": {"timers": {"connectors": {"add_time_dim_to_batch_and_zero_pad": 9.871530803211499e-06, "batch_individual_items": 0.0314298784602045, "add_one_ts_to_episodes_and_truncate": 0.007655482892891248, "general_advantage_estimation": 0.007554665658537347, "numpy_to_tensor": 6.728353555207576e-05, "add_observations_from_episodes_to_batch": 0.0008053543083415265, "add_states_from_episodes_to_batch": 3.2074743128602854e-06, "add_columns_from_episodes_to_train_batch": 0.03429862124622237}}, "connector_pipeline_timer": 0.08193794520348352}, "num_env_steps_trained_lifetime": 189000, "num_env_steps_trained": 31500, "num_module_steps_trained_lifetime": 36000, "num_module_steps_trained": 6000, "learner_connector_sum_episodes_length_out": 5250.0, "num_trainable_parameters": 6003, "learner_connector_sum_episodes_length_in": 5000.0, "num_env_steps_trained_lifetime_throughput": 2658995.782024686, "num_module_steps_trained_throughput": 509351.6843836048, "num_module_steps_trained_lifetime_throughput": 508334.3232597117}, "default_policy": {"diff_num_grad_updates_vs_sampler_policy": 1.0, "vf_loss_unclipped": 28.623245239257812, "num_module_steps_trained": 6000, "total_loss": -0.15098221600055695, "num_trainable_parameters": 6003, "gradients_default_optimizer_global_norm": 0.029508594423532486, "weights_seq_no": 6.0, "mean_kl_loss": 0.0009678311762399971, "vf_explained_var": 0.02075040340423584, "vf_loss": 0.10181018710136414, "policy_loss": -0.2132357954978943, "default_optimizer_learning_rate": 0.0002847858517, "entropy": 0.6470538377761841, "num_module_steps_trained_lifetime": 36000, "curr_entropy_coeff": 0.0090570820258, "curr_kl_coeff": 0.011664004996418953, "module_train_batch_size_mean": 1000.0, "num_module_steps_trained_lifetime_throughput": 510570.88862688385}}, "num_training_step_calls_per_iteration": 1, "evaluation": {"env_runners": {"num_agent_steps_sampled": {"default_agent": 400}, "num_env_steps_sampled_lifetime": 30400, "env_to_module_connector": {"timers": {"connectors": {"add_states_from_episodes_to_batch": 1.5935130964493744e-06, "batch_individual_items": 6.078394545054614e-06, "numpy_to_tensor": 8.040076719464638e-06, "add_observations_from_episodes_to_batch": 2.747105213360671e-06, "add_time_dim_to_batch_and_zero_pad": 2.1834605762555245e-06}}, "connector_pipeline_timer": 4.203627598371159e-05}, "episode_return_min": -16.5, "num_episodes": 20, "num_episodes_lifetime": 120, "module_to_env_connector": {"timers": {"connectors": {"un_batch_to_individual_items": 5.140431438492779e-06, "normalize_and_clip_actions": 9.191753641231677e-06, "listify_data_for_vector_env": 1.0616446489868406e-05, "tensor_to_numpy": 1.2562470497676605e-05, "get_actions": 3.377349934518286e-05, "remove_single_ts_time_rank_from_batch": 5.786939533977523e-07}}, "connector_pipeline_timer": 9.686109585385719e-05}, "episode_len_mean": 20.0, "weights_seq_no": 6.0, "episode_return_max": 12.5, "num_agent_steps_sampled_lifetime": {"default_agent": 2400}, "episode_len_min": 20, "num_env_steps_sampled": 400, "episode_duration_sec_mean": 0.00440211126813665, "module_episode_returns_mean": {"default_policy": 0.55}, "episode_return_mean": 0.55, "env_reset_timer": 0.00016078814726255293, "env_step_timer": 1.3531229659913636e-05, "num_module_steps_sampled": {"default_policy": 400}, "agent_episode_returns_mean": {"default_agent": 0.55}, "episode_len_max": 20, "env_to_module_sum_episodes_length_in": 10.368238394470474, "num_module_steps_sampled_lifetime": {"default_policy": 2400}, "env_to_module_sum_episodes_length_out": 10.368238394470474, "rlmodule_inference_timer": 2.5925087414491275e-05, "sample": 0.0969405702323001, "time_between_sampling": 1.550782151508494}, "num_healthy_workers": 1, "actor_manager_num_outstanding_async_reqs": 0, "num_remote_worker_restarts": 0}, "num_env_steps_sampled_lifetime": -2460000.0, "fault_tolerance": {"num_healthy_workers": 0, "num_remote_worker_restarts": 0}, "env_runner_group": {"actor_manager_num_outstanding_async_reqs": 0}, "done": false, "training_iteration": 6, "trial_id": "49be2_00000", "date": "2025-08-11_19-36-19", "timestamp": 1754933779, "time_this_iter_s": 1.6259269714355469, "time_total_s": 10.03322982788086, "pid": 28164, "hostname": "Mac", "node_ip": "127.0.0.1", "config": {"exploration_config": {}, "extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "placement_strategy": "PACK", "num_gpus": 0, "_fake_gpus": false, "num_cpus_for_main_process": 2, "eager_tracing": true, "eager_max_retraces": 20, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "torch_compile_learner": false, "torch_compile_learner_what_to_compile": "forward_train", "torch_compile_learner_dynamo_backend": "aot_eager", "torch_compile_learner_dynamo_mode": null, "torch_compile_worker": false, "torch_compile_worker_dynamo_backend": "aot_eager", "torch_compile_worker_dynamo_mode": null, "torch_ddp_kwargs": {}, "torch_skip_nan_gradients": false, "env": "Umbrella", "env_config": {}, "observation_space": null, "action_space": null, "clip_rewards": null, "normalize_actions": true, "clip_actions": false, "_is_atari": null, "disable_env_checking": false, "render_env": false, "action_mask_key": "action_mask", "env_runner_cls": null, "num_env_runners": 0, "create_local_env_runner": true, "num_envs_per_env_runner": 1, "gym_env_vectorize_mode": "SYNC", "num_cpus_per_env_runner": 1, "num_gpus_per_env_runner": 0, "custom_resources_per_env_runner": {}, "validate_env_runners_after_construction": true, "episodes_to_numpy": true, "max_requests_in_flight_per_env_runner": 1, "sample_timeout_s": 60.0, "_env_to_module_connector": null, "add_default_connectors_to_env_to_module_pipeline": true, "_module_to_env_connector": null, "add_default_connectors_to_module_to_env_pipeline": true, "merge_env_runner_states": "training_only", "broadcast_env_runner_states": true, "episode_lookback_horizon": 1, "rollout_fragment_length": "auto", "batch_mode": "complete_episodes", "compress_observations": false, "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "enable_tf1_exec_eagerly": false, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "preprocessor_pref": "deepmind", "observation_filter": "NoFilter", "update_worker_filter_stats": true, "use_worker_filter_stats": true, "sampler_perf_stats_ema_coef": null, "_is_online": true, "num_learners": 0, "num_gpus_per_learner": 0, "num_cpus_per_learner": "auto", "num_aggregator_actors_per_learner": 0, "max_requests_in_flight_per_aggregator_actor": 3, "local_gpu_idx": 0, "max_requests_in_flight_per_learner": 3, "gamma": 1, "lr": 0.0002847858517, "grad_clip": 0.5, "grad_clip_by": "global_norm", "_train_batch_size_per_learner": 5000, "train_batch_size": 4000, "num_epochs": 1, "minibatch_size": 1000, "shuffle_batch_per_epoch": true, "model": {"fcnet_hiddens": [256, 256], "fcnet_activation": "tanh", "fcnet_weights_initializer": null, "fcnet_weights_initializer_config": null, "fcnet_bias_initializer": null, "fcnet_bias_initializer_config": null, "conv_filters": null, "conv_activation": "relu", "conv_kernel_initializer": null, "conv_kernel_initializer_config": null, "conv_bias_initializer": null, "conv_bias_initializer_config": null, "conv_transpose_kernel_initializer": null, "conv_transpose_kernel_initializer_config": null, "conv_transpose_bias_initializer": null, "conv_transpose_bias_initializer_config": null, "post_fcnet_hiddens": [], "post_fcnet_activation": "relu", "post_fcnet_weights_initializer": null, "post_fcnet_weights_initializer_config": null, "post_fcnet_bias_initializer": null, "post_fcnet_bias_initializer_config": null, "free_log_std": false, "log_std_clip_param": 20.0, "no_final_linear": false, "vf_share_layers": false, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "lstm_weights_initializer": null, "lstm_weights_initializer_config": null, "lstm_bias_initializer": null, "lstm_bias_initializer_config": null, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "attention_use_n_prev_actions": 0, "attention_use_n_prev_rewards": 0, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": null, "custom_model_config": {}, "custom_action_dist": null, "custom_preprocessor": null, "encoder_latent_dim": null, "always_check_shapes": false, "lstm_use_prev_action_reward": -1, "_use_default_native_models": -1, "_disable_preprocessor_api": false, "_disable_action_flattening": false}, "_learner_connector": null, "add_default_connectors_to_learner_pipeline": true, "learner_config_dict": {}, "optimizer": {}, "_learner_class": null, "callbacks_on_algorithm_init": null, "callbacks_on_env_runners_recreated": null, "callbacks_on_offline_eval_runners_recreated": null, "callbacks_on_checkpoint_loaded": null, "callbacks_on_environment_created": null, "callbacks_on_episode_created": null, "callbacks_on_episode_start": null, "callbacks_on_episode_step": null, "callbacks_on_episode_end": null, "callbacks_on_evaluate_start": null, "callbacks_on_evaluate_end": null, "callbacks_on_evaluate_offline_start": null, "callbacks_on_evaluate_offline_end": null, "callbacks_on_sample_end": null, "callbacks_on_train_result": null, "explore": true, "enable_rl_module_and_learner": true, "enable_env_runner_and_connector_v2": true, "_prior_exploration_config": {"type": "StochasticSampling"}, "count_steps_by": "env_steps", "policy_map_capacity": 100, "policy_mapping_fn": "<function AlgorithmConfig.DEFAULT_POLICY_MAPPING_FN at 0x145c2d8a0>", "policies_to_train": null, "policy_states_are_swappable": false, "observation_fn": null, "offline_data_class": null, "input_read_method": "read_parquet", "input_read_method_kwargs": {}, "input_read_schema": {}, "input_read_episodes": false, "input_read_sample_batches": false, "input_read_batch_size": null, "input_filesystem": null, "input_filesystem_kwargs": {}, "input_compress_columns": ["obs", "new_obs"], "input_spaces_jsonable": true, "materialize_data": false, "materialize_mapped_data": true, "map_batches_kwargs": {}, "iter_batches_kwargs": {}, "ignore_final_observation": false, "prelearner_class": null, "prelearner_buffer_class": null, "prelearner_buffer_kwargs": {}, "prelearner_module_synch_period": 10, "dataset_num_iters_per_learner": null, "input_config": {}, "actions_in_input_normalized": false, "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_config": {}, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "output_max_rows_per_file": null, "output_write_remaining_data": false, "output_write_method": "write_parquet", "output_write_method_kwargs": {}, "output_filesystem": null, "output_filesystem_kwargs": {}, "output_write_episodes": true, "offline_sampling": false, "evaluation_interval": 1, "evaluation_duration": 20, "evaluation_duration_unit": "episodes", "evaluation_sample_timeout_s": 120.0, "evaluation_auto_duration_min_env_steps_per_sample": 100, "evaluation_auto_duration_max_env_steps_per_sample": 2000, "evaluation_parallel_to_training": false, "evaluation_force_reset_envs_before_iteration": true, "evaluation_config": null, "off_policy_estimation_methods": {}, "ope_split_batch_by_episode": true, "evaluation_num_env_runners": 1, "in_evaluation": false, "sync_filters_on_rollout_workers_timeout_s": 10.0, "offline_evaluation_interval": null, "num_offline_eval_runners": 0, "offline_loss_for_module_fn": null, "offline_evaluation_duration": 1, "offline_evaluation_parallel_to_training": false, "offline_evaluation_timeout_s": 120.0, "num_cpus_per_offline_eval_runner": 1, "num_gpus_per_offline_eval_runner": 0, "custom_resources_per_offline_eval_runner": {}, "restart_failed_offline_eval_runners": true, "ignore_offline_eval_runner_failures": false, "max_num_offline_eval_runner_restarts": 1000, "offline_eval_runner_restore_timeout_s": 1800.0, "max_requests_in_flight_per_offline_eval_runner": 1, "validate_offline_eval_runners_after_construction": true, "offline_eval_runner_health_probe_timeout_s": 30.0, "offline_eval_rl_module_inference_only": false, "broadcast_offline_eval_runner_states": false, "offline_eval_batch_size_per_runner": 256, "dataset_num_iters_per_eval_runner": 1, "keep_per_episode_custom_metrics": false, "metrics_episode_collection_timeout_s": 60.0, "metrics_num_episodes_for_smoothing": 100, "min_time_s_per_iteration": null, "min_train_timesteps_per_iteration": 0, "min_sample_timesteps_per_iteration": 0, "log_gradients": true, "export_native_model_files": false, "checkpoint_trainable_policies_only": false, "logger_creator": null, "logger_config": null, "log_level": "WARN", "log_sys_usage": true, "fake_sampler": false, "seed": 4, "restart_failed_env_runners": true, "ignore_env_runner_failures": false, "max_num_env_runner_restarts": 1000, "delay_between_env_runner_restarts_s": 60.0, "restart_failed_sub_environments": false, "num_consecutive_env_runner_failures_tolerance": 100, "env_runner_health_probe_timeout_s": 30.0, "env_runner_restore_timeout_s": 1800.0, "_model_config": {}, "_rl_module_spec": "RLModuleSpec(module_class=None, observation_space=None, action_space=None, inference_only=False, learner_only=False, model_config=DefaultModelConfig(fcnet_hiddens=[60, 90], fcnet_activation='tanh', fcnet_kernel_initializer=None, fcnet_kernel_initializer_kwargs=None, fcnet_bias_initializer=None, fcnet_bias_initializer_kwargs=None, conv_filters=None, conv_activation='relu', conv_kernel_initializer=None, conv_kernel_initializer_kwargs=None, conv_bias_initializer=None, conv_bias_initializer_kwargs=None, head_fcnet_hiddens=[], head_fcnet_activation='relu', head_fcnet_kernel_initializer=None, head_fcnet_kernel_initializer_kwargs=None, head_fcnet_bias_initializer=None, head_fcnet_bias_initializer_kwargs=None, free_log_std=False, log_std_clip_param=20.0, vf_share_layers=True, use_lstm=False, max_seq_len=20, lstm_cell_size=256, lstm_use_prev_action=False, lstm_use_prev_reward=False, lstm_kernel_initializer=None, lstm_kernel_initializer_kwargs=None, lstm_bias_initializer=None, lstm_bias_initializer_kwargs=None), catalog_class=None, load_state_path=None, model_config_dict=None)", "algorithm_config_overrides_per_module": {}, "_per_module_overrides": {}, "_validate_config": true, "_use_msgpack_checkpoints": false, "_torch_grad_scaler_class": null, "_torch_lr_scheduler_classes": null, "_tf_policy_handles_more_than_one_loss": false, "_disable_preprocessor_api": false, "_disable_action_flattening": false, "_disable_initialize_loss_from_dummy_batch": false, "_dont_auto_sync_env_runner_states": false, "env_task_fn": -1, "enable_connectors": -1, "simple_optimizer": false, "policy_map_cache": -1, "worker_cls": -1, "synchronize_filters": -1, "enable_async_evaluation": -1, "custom_async_evaluation_function": -1, "_enable_rl_module_api": -1, "auto_wrap_old_gym_envs": -1, "always_attach_evaluation_results": -1, "replay_sequence_length": null, "_disable_execution_plan_api": -1, "use_critic": true, "use_gae": true, "use_kl_loss": true, "kl_coeff": 0.7464963036515, "kl_target": 0.0270990929592, "vf_loss_coeff": 0.6688075857018, "entropy_coeff": 0.0090570820258, "clip_param": 0.1221781641624, "vf_clip_param": 0.1027808522125, "entropy_coeff_schedule": null, "lr_schedule": null, "sgd_minibatch_size": -1, "vf_share_layers": -1, "__stdout_file__": null, "__stderr_file__": null, "lambda": 0.9099046732075, "input": "sampler", "policies": {"default_policy": [null, null, null, null]}, "callbacks": "<class 'ray.rllib.callbacks.callbacks.RLlibCallback'>", "create_env_on_driver": false, "custom_eval_function": null, "framework": "torch"}, "time_since_restore": 10.03322982788086, "iterations_since_restore": 6, "perf": {"cpu_util_percent": 32.8, "ram_util_percent": 75.05}}
{"timers": {"training_iteration": 1.5560380544061738, "restore_env_runners": 9.69154059620216e-06, "training_step": 1.5559182152008342, "env_runner_sampling_timer": 1.4468207272100628, "learner_update_timer": 0.10615626016539748, "synch_weights": 0.000598627298031018, "restore_eval_env_runners": 7.84875117634267e-06, "evaluation_iteration": 0.1030453991336473, "synch_eval_env_connectors": 0.00011772141792655275, "synch_env_connectors": 4.5437075283362064e-06}, "env_runners": {"num_episodes_lifetime": -153875.0, "episode_len_mean": 20.0, "env_to_module_connector": {"timers": {"connectors": {"batch_individual_items": 6.151270389665245e-06, "add_observations_from_episodes_to_batch": 2.918018630989551e-06, "add_states_from_episodes_to_batch": 1.7317271475712373e-06, "numpy_to_tensor": 8.35166148754872e-06, "add_time_dim_to_batch_and_zero_pad": 2.349428278326255e-06}}, "connector_pipeline_timer": 4.2715064843572765e-05}, "agent_episode_returns_mean": {"default_agent": 6.820000000000002}, "episode_return_max": 12.5, "num_module_steps_sampled_lifetime": {"default_policy": -3077500.0}, "env_step_timer": 1.3558160789765221e-05, "module_to_env_connector": {"timers": {"connectors": {"listify_data_for_vector_env": 1.0963134613548759e-05, "remove_single_ts_time_rank_from_batch": 5.765554704024493e-07, "tensor_to_numpy": 1.30838282717479e-05, "un_batch_to_individual_items": 5.308313506468013e-06, "get_actions": 3.7973173202379004e-05, "normalize_and_clip_actions": 9.270387318424472e-06}}, "connector_pipeline_timer": 0.00010223739755719413}, "module_episode_returns_mean": {"default_policy": 6.820000000000002}, "num_env_steps_sampled_lifetime": -3077500.0, "episode_len_min": 20, "episode_return_min": -7.5, "time_between_sampling": 0.001761939787118472, "num_env_steps_sampled": 5000.0, "num_module_steps_sampled": {"default_policy": 5000.0}, "num_episodes": 250.0, "episode_len_max": 20, "num_agent_steps_sampled": {"default_agent": 5000.0}, "episode_duration_sec_mean": 0.0044704541559331115, "env_to_module_sum_episodes_length_in": 10.36823839457432, "num_agent_steps_sampled_lifetime": {"default_agent": -3077500.0}, "env_to_module_sum_episodes_length_out": 10.36823839457432, "rlmodule_inference_timer": 2.720031941178904e-05, "episode_return_mean": 6.820000000000002, "sample": 0.0047760725835699425, "env_reset_timer": 3.0390770504178122e-05, "weights_seq_no": 6.0, "num_env_steps_sampled_lifetime_throughput": 3804.3352051633005}, "learners": {"__all_modules__": {"num_non_trainable_parameters": 0, "learner_connector": {"timers": {"connectors": {"add_time_dim_to_batch_and_zero_pad": 9.847405120180337e-06, "batch_individual_items": 0.03141372925550557, "add_one_ts_to_episodes_and_truncate": 0.007658046404471347, "general_advantage_estimation": 0.007530560671881746, "numpy_to_tensor": 6.709570039712464e-05, "add_observations_from_episodes_to_batch": 0.0008059603550609574, "add_states_from_episodes_to_batch": 3.2016488964972197e-06, "add_columns_from_episodes_to_train_batch": 0.03430732961392768}}, "connector_pipeline_timer": 0.08190900825101365}, "num_env_steps_trained_lifetime": 220500, "num_env_steps_trained": 31500, "num_module_steps_trained_lifetime": 42000, "num_module_steps_trained": 6000, "learner_connector_sum_episodes_length_out": 5250.0, "num_trainable_parameters": 6003, "learner_connector_sum_episodes_length_in": 5000.0, "num_env_steps_trained_lifetime_throughput": 2649148.0635080426, "num_module_steps_trained_throughput": 507372.4994147677, "num_module_steps_trained_lifetime_throughput": 506386.92829751153}, "default_policy": {"diff_num_grad_updates_vs_sampler_policy": 1.0, "vf_loss_unclipped": 28.57539176940918, "num_module_steps_trained": 6000, "total_loss": 0.01327641773968935, "num_trainable_parameters": 6003, "gradients_default_optimizer_global_norm": 0.06353103369474411, "weights_seq_no": 7.0, "mean_kl_loss": 0.0012224273523315787, "vf_explained_var": 0.021754086017608643, "vf_loss": 0.10148672014474869, "policy_loss": -0.04889311641454697, "default_optimizer_learning_rate": 0.0002847858517, "entropy": 0.6315293908119202, "num_module_steps_trained_lifetime": 42000, "curr_entropy_coeff": 0.0090570820258, "curr_kl_coeff": 0.0058320024982094765, "module_train_batch_size_mean": 1000.0, "num_module_steps_trained_lifetime_throughput": 508510.0021968931}}, "num_training_step_calls_per_iteration": 1, "evaluation": {"env_runners": {"num_agent_steps_sampled": {"default_agent": 400}, "num_env_steps_sampled_lifetime": 35400, "env_to_module_connector": {"timers": {"connectors": {"add_states_from_episodes_to_batch": 1.56099502141515e-06, "batch_individual_items": 6.070171264387479e-06, "numpy_to_tensor": 7.967227145341393e-06, "add_observations_from_episodes_to_batch": 2.7606281180960137e-06, "add_time_dim_to_batch_and_zero_pad": 2.1645456250061588e-06}}, "connector_pipeline_timer": 4.1800292360685296e-05}, "episode_return_min": -16.5, "num_episodes": 20, "num_episodes_lifetime": 140, "module_to_env_connector": {"timers": {"connectors": {"un_batch_to_individual_items": 5.185406017995327e-06, "normalize_and_clip_actions": 9.085183304845085e-06, "listify_data_for_vector_env": 1.0761737493019122e-05, "tensor_to_numpy": 1.253707909617565e-05, "get_actions": 3.389000919290288e-05, "remove_single_ts_time_rank_from_batch": 5.595651739604204e-07}}, "connector_pipeline_timer": 9.694878641217542e-05}, "episode_len_mean": 20.0, "weights_seq_no": 7.0, "episode_return_max": 12.5, "num_agent_steps_sampled_lifetime": {"default_agent": 2800}, "episode_len_min": 20, "num_env_steps_sampled": 400, "episode_duration_sec_mean": 0.004396105817286298, "module_episode_returns_mean": {"default_policy": 0.15}, "episode_return_mean": 0.15, "env_reset_timer": 0.0001598965157140805, "env_step_timer": 1.3596982653212381e-05, "num_module_steps_sampled": {"default_policy": 400}, "agent_episode_returns_mean": {"default_agent": 0.15}, "episode_len_max": 20, "env_to_module_sum_episodes_length_in": 10.368238394572801, "num_module_steps_sampled_lifetime": {"default_policy": 2800}, "env_to_module_sum_episodes_length_out": 10.368238394572801, "rlmodule_inference_timer": 2.6171083475507333e-05, "sample": 0.09692014910985876, "time_between_sampling": 1.549883513742826}, "num_healthy_workers": 1, "actor_manager_num_outstanding_async_reqs": 0, "num_remote_worker_restarts": 0}, "num_env_steps_sampled_lifetime": -3077500.0, "fault_tolerance": {"num_healthy_workers": 0, "num_remote_worker_restarts": 0}, "env_runner_group": {"actor_manager_num_outstanding_async_reqs": 0}, "done": false, "training_iteration": 7, "trial_id": "49be2_00000", "date": "2025-08-11_19-36-20", "timestamp": 1754933780, "time_this_iter_s": 1.5466969013214111, "time_total_s": 11.57992672920227, "pid": 28164, "hostname": "Mac", "node_ip": "127.0.0.1", "config": {"exploration_config": {}, "extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "placement_strategy": "PACK", "num_gpus": 0, "_fake_gpus": false, "num_cpus_for_main_process": 2, "eager_tracing": true, "eager_max_retraces": 20, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "torch_compile_learner": false, "torch_compile_learner_what_to_compile": "forward_train", "torch_compile_learner_dynamo_backend": "aot_eager", "torch_compile_learner_dynamo_mode": null, "torch_compile_worker": false, "torch_compile_worker_dynamo_backend": "aot_eager", "torch_compile_worker_dynamo_mode": null, "torch_ddp_kwargs": {}, "torch_skip_nan_gradients": false, "env": "Umbrella", "env_config": {}, "observation_space": null, "action_space": null, "clip_rewards": null, "normalize_actions": true, "clip_actions": false, "_is_atari": null, "disable_env_checking": false, "render_env": false, "action_mask_key": "action_mask", "env_runner_cls": null, "num_env_runners": 0, "create_local_env_runner": true, "num_envs_per_env_runner": 1, "gym_env_vectorize_mode": "SYNC", "num_cpus_per_env_runner": 1, "num_gpus_per_env_runner": 0, "custom_resources_per_env_runner": {}, "validate_env_runners_after_construction": true, "episodes_to_numpy": true, "max_requests_in_flight_per_env_runner": 1, "sample_timeout_s": 60.0, "_env_to_module_connector": null, "add_default_connectors_to_env_to_module_pipeline": true, "_module_to_env_connector": null, "add_default_connectors_to_module_to_env_pipeline": true, "merge_env_runner_states": "training_only", "broadcast_env_runner_states": true, "episode_lookback_horizon": 1, "rollout_fragment_length": "auto", "batch_mode": "complete_episodes", "compress_observations": false, "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "enable_tf1_exec_eagerly": false, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "preprocessor_pref": "deepmind", "observation_filter": "NoFilter", "update_worker_filter_stats": true, "use_worker_filter_stats": true, "sampler_perf_stats_ema_coef": null, "_is_online": true, "num_learners": 0, "num_gpus_per_learner": 0, "num_cpus_per_learner": "auto", "num_aggregator_actors_per_learner": 0, "max_requests_in_flight_per_aggregator_actor": 3, "local_gpu_idx": 0, "max_requests_in_flight_per_learner": 3, "gamma": 1, "lr": 0.0002847858517, "grad_clip": 0.5, "grad_clip_by": "global_norm", "_train_batch_size_per_learner": 5000, "train_batch_size": 4000, "num_epochs": 1, "minibatch_size": 1000, "shuffle_batch_per_epoch": true, "model": {"fcnet_hiddens": [256, 256], "fcnet_activation": "tanh", "fcnet_weights_initializer": null, "fcnet_weights_initializer_config": null, "fcnet_bias_initializer": null, "fcnet_bias_initializer_config": null, "conv_filters": null, "conv_activation": "relu", "conv_kernel_initializer": null, "conv_kernel_initializer_config": null, "conv_bias_initializer": null, "conv_bias_initializer_config": null, "conv_transpose_kernel_initializer": null, "conv_transpose_kernel_initializer_config": null, "conv_transpose_bias_initializer": null, "conv_transpose_bias_initializer_config": null, "post_fcnet_hiddens": [], "post_fcnet_activation": "relu", "post_fcnet_weights_initializer": null, "post_fcnet_weights_initializer_config": null, "post_fcnet_bias_initializer": null, "post_fcnet_bias_initializer_config": null, "free_log_std": false, "log_std_clip_param": 20.0, "no_final_linear": false, "vf_share_layers": false, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "lstm_weights_initializer": null, "lstm_weights_initializer_config": null, "lstm_bias_initializer": null, "lstm_bias_initializer_config": null, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "attention_use_n_prev_actions": 0, "attention_use_n_prev_rewards": 0, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": null, "custom_model_config": {}, "custom_action_dist": null, "custom_preprocessor": null, "encoder_latent_dim": null, "always_check_shapes": false, "lstm_use_prev_action_reward": -1, "_use_default_native_models": -1, "_disable_preprocessor_api": false, "_disable_action_flattening": false}, "_learner_connector": null, "add_default_connectors_to_learner_pipeline": true, "learner_config_dict": {}, "optimizer": {}, "_learner_class": null, "callbacks_on_algorithm_init": null, "callbacks_on_env_runners_recreated": null, "callbacks_on_offline_eval_runners_recreated": null, "callbacks_on_checkpoint_loaded": null, "callbacks_on_environment_created": null, "callbacks_on_episode_created": null, "callbacks_on_episode_start": null, "callbacks_on_episode_step": null, "callbacks_on_episode_end": null, "callbacks_on_evaluate_start": null, "callbacks_on_evaluate_end": null, "callbacks_on_evaluate_offline_start": null, "callbacks_on_evaluate_offline_end": null, "callbacks_on_sample_end": null, "callbacks_on_train_result": null, "explore": true, "enable_rl_module_and_learner": true, "enable_env_runner_and_connector_v2": true, "_prior_exploration_config": {"type": "StochasticSampling"}, "count_steps_by": "env_steps", "policy_map_capacity": 100, "policy_mapping_fn": "<function AlgorithmConfig.DEFAULT_POLICY_MAPPING_FN at 0x145c2d8a0>", "policies_to_train": null, "policy_states_are_swappable": false, "observation_fn": null, "offline_data_class": null, "input_read_method": "read_parquet", "input_read_method_kwargs": {}, "input_read_schema": {}, "input_read_episodes": false, "input_read_sample_batches": false, "input_read_batch_size": null, "input_filesystem": null, "input_filesystem_kwargs": {}, "input_compress_columns": ["obs", "new_obs"], "input_spaces_jsonable": true, "materialize_data": false, "materialize_mapped_data": true, "map_batches_kwargs": {}, "iter_batches_kwargs": {}, "ignore_final_observation": false, "prelearner_class": null, "prelearner_buffer_class": null, "prelearner_buffer_kwargs": {}, "prelearner_module_synch_period": 10, "dataset_num_iters_per_learner": null, "input_config": {}, "actions_in_input_normalized": false, "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_config": {}, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "output_max_rows_per_file": null, "output_write_remaining_data": false, "output_write_method": "write_parquet", "output_write_method_kwargs": {}, "output_filesystem": null, "output_filesystem_kwargs": {}, "output_write_episodes": true, "offline_sampling": false, "evaluation_interval": 1, "evaluation_duration": 20, "evaluation_duration_unit": "episodes", "evaluation_sample_timeout_s": 120.0, "evaluation_auto_duration_min_env_steps_per_sample": 100, "evaluation_auto_duration_max_env_steps_per_sample": 2000, "evaluation_parallel_to_training": false, "evaluation_force_reset_envs_before_iteration": true, "evaluation_config": null, "off_policy_estimation_methods": {}, "ope_split_batch_by_episode": true, "evaluation_num_env_runners": 1, "in_evaluation": false, "sync_filters_on_rollout_workers_timeout_s": 10.0, "offline_evaluation_interval": null, "num_offline_eval_runners": 0, "offline_loss_for_module_fn": null, "offline_evaluation_duration": 1, "offline_evaluation_parallel_to_training": false, "offline_evaluation_timeout_s": 120.0, "num_cpus_per_offline_eval_runner": 1, "num_gpus_per_offline_eval_runner": 0, "custom_resources_per_offline_eval_runner": {}, "restart_failed_offline_eval_runners": true, "ignore_offline_eval_runner_failures": false, "max_num_offline_eval_runner_restarts": 1000, "offline_eval_runner_restore_timeout_s": 1800.0, "max_requests_in_flight_per_offline_eval_runner": 1, "validate_offline_eval_runners_after_construction": true, "offline_eval_runner_health_probe_timeout_s": 30.0, "offline_eval_rl_module_inference_only": false, "broadcast_offline_eval_runner_states": false, "offline_eval_batch_size_per_runner": 256, "dataset_num_iters_per_eval_runner": 1, "keep_per_episode_custom_metrics": false, "metrics_episode_collection_timeout_s": 60.0, "metrics_num_episodes_for_smoothing": 100, "min_time_s_per_iteration": null, "min_train_timesteps_per_iteration": 0, "min_sample_timesteps_per_iteration": 0, "log_gradients": true, "export_native_model_files": false, "checkpoint_trainable_policies_only": false, "logger_creator": null, "logger_config": null, "log_level": "WARN", "log_sys_usage": true, "fake_sampler": false, "seed": 4, "restart_failed_env_runners": true, "ignore_env_runner_failures": false, "max_num_env_runner_restarts": 1000, "delay_between_env_runner_restarts_s": 60.0, "restart_failed_sub_environments": false, "num_consecutive_env_runner_failures_tolerance": 100, "env_runner_health_probe_timeout_s": 30.0, "env_runner_restore_timeout_s": 1800.0, "_model_config": {}, "_rl_module_spec": "RLModuleSpec(module_class=None, observation_space=None, action_space=None, inference_only=False, learner_only=False, model_config=DefaultModelConfig(fcnet_hiddens=[60, 90], fcnet_activation='tanh', fcnet_kernel_initializer=None, fcnet_kernel_initializer_kwargs=None, fcnet_bias_initializer=None, fcnet_bias_initializer_kwargs=None, conv_filters=None, conv_activation='relu', conv_kernel_initializer=None, conv_kernel_initializer_kwargs=None, conv_bias_initializer=None, conv_bias_initializer_kwargs=None, head_fcnet_hiddens=[], head_fcnet_activation='relu', head_fcnet_kernel_initializer=None, head_fcnet_kernel_initializer_kwargs=None, head_fcnet_bias_initializer=None, head_fcnet_bias_initializer_kwargs=None, free_log_std=False, log_std_clip_param=20.0, vf_share_layers=True, use_lstm=False, max_seq_len=20, lstm_cell_size=256, lstm_use_prev_action=False, lstm_use_prev_reward=False, lstm_kernel_initializer=None, lstm_kernel_initializer_kwargs=None, lstm_bias_initializer=None, lstm_bias_initializer_kwargs=None), catalog_class=None, load_state_path=None, model_config_dict=None)", "algorithm_config_overrides_per_module": {}, "_per_module_overrides": {}, "_validate_config": true, "_use_msgpack_checkpoints": false, "_torch_grad_scaler_class": null, "_torch_lr_scheduler_classes": null, "_tf_policy_handles_more_than_one_loss": false, "_disable_preprocessor_api": false, "_disable_action_flattening": false, "_disable_initialize_loss_from_dummy_batch": false, "_dont_auto_sync_env_runner_states": false, "env_task_fn": -1, "enable_connectors": -1, "simple_optimizer": false, "policy_map_cache": -1, "worker_cls": -1, "synchronize_filters": -1, "enable_async_evaluation": -1, "custom_async_evaluation_function": -1, "_enable_rl_module_api": -1, "auto_wrap_old_gym_envs": -1, "always_attach_evaluation_results": -1, "replay_sequence_length": null, "_disable_execution_plan_api": -1, "use_critic": true, "use_gae": true, "use_kl_loss": true, "kl_coeff": 0.7464963036515, "kl_target": 0.0270990929592, "vf_loss_coeff": 0.6688075857018, "entropy_coeff": 0.0090570820258, "clip_param": 0.1221781641624, "vf_clip_param": 0.1027808522125, "entropy_coeff_schedule": null, "lr_schedule": null, "sgd_minibatch_size": -1, "vf_share_layers": -1, "__stdout_file__": null, "__stderr_file__": null, "lambda": 0.9099046732075, "input": "sampler", "policies": {"default_policy": [null, null, null, null]}, "callbacks": "<class 'ray.rllib.callbacks.callbacks.RLlibCallback'>", "create_env_on_driver": false, "custom_eval_function": null, "framework": "torch"}, "time_since_restore": 11.57992672920227, "iterations_since_restore": 7, "perf": {"cpu_util_percent": 33.7, "ram_util_percent": 75.0}}
{"timers": {"training_iteration": 1.5555940722012718, "restore_env_runners": 9.647955049169056e-06, "training_step": 1.5554737884686072, "env_runner_sampling_timer": 1.4465336107781006, "learner_update_timer": 0.10599689964421308, "synch_weights": 0.0005979897759064815, "restore_eval_env_runners": 7.83192303978488e-06, "evaluation_iteration": 0.1030091313923381, "synch_eval_env_connectors": 0.00011751795388594252, "synch_env_connectors": 4.536600197764363e-06}, "env_runners": {"num_episodes_lifetime": -184750.0, "episode_len_mean": 20.0, "env_to_module_connector": {"timers": {"connectors": {"batch_individual_items": 6.082032439101102e-06, "add_observations_from_episodes_to_batch": 2.9705974525620437e-06, "add_states_from_episodes_to_batch": 1.716811181250328e-06, "numpy_to_tensor": 8.254553872442255e-06, "add_time_dim_to_batch_and_zero_pad": 2.325768528101663e-06}}, "connector_pipeline_timer": 4.254379848996102e-05}, "agent_episode_returns_mean": {"default_agent": 7.46}, "episode_return_max": 12.5, "num_module_steps_sampled_lifetime": {"default_policy": -3695000.0}, "env_step_timer": 1.3423874605307578e-05, "module_to_env_connector": {"timers": {"connectors": {"listify_data_for_vector_env": 1.0860800034736753e-05, "remove_single_ts_time_rank_from_batch": 5.780669025506177e-07, "tensor_to_numpy": 1.2931835372753294e-05, "un_batch_to_individual_items": 5.291650825943195e-06, "get_actions": 3.749512810960448e-05, "normalize_and_clip_actions": 9.2198926338143e-06}}, "connector_pipeline_timer": 0.00010139725978987416}, "module_episode_returns_mean": {"default_policy": 7.46}, "num_env_steps_sampled_lifetime": -3695000.0, "episode_len_min": 20, "episode_return_min": -7.5, "time_between_sampling": 0.001470613026405202, "num_env_steps_sampled": 5000.0, "num_module_steps_sampled": {"default_policy": 5000.0}, "num_episodes": 250.0, "episode_len_max": 20, "num_agent_steps_sampled": {"default_agent": 5000.0}, "episode_duration_sec_mean": 0.004761057151015848, "env_to_module_sum_episodes_length_in": 10.36823839457432, "num_agent_steps_sampled_lifetime": {"default_agent": -3695000.0}, "env_to_module_sum_episodes_length_out": 10.36823839457432, "rlmodule_inference_timer": 4.160779825972138e-05, "episode_return_mean": 7.46, "sample": 0.0049998223707010915, "env_reset_timer": 2.968229169432341e-05, "weights_seq_no": 7.0, "num_env_steps_sampled_lifetime_throughput": 3817.313846045724}, "learners": {"__all_modules__": {"num_non_trainable_parameters": 0, "learner_connector": {"timers": {"connectors": {"add_time_dim_to_batch_and_zero_pad": 9.823511380753741e-06, "batch_individual_items": 0.031397451122714415, "add_one_ts_to_episodes_and_truncate": 0.007656918440449581, "general_advantage_estimation": 0.007507005484824331, "numpy_to_tensor": 6.690474355565056e-05, "add_observations_from_episodes_to_batch": 0.0008084224218481142, "add_states_from_episodes_to_batch": 3.19630199360958e-06, "add_columns_from_episodes_to_train_batch": 0.034304932148163804}}, "connector_pipeline_timer": 0.08186747482839013}, "num_env_steps_trained_lifetime": 252000, "num_env_steps_trained": 31500, "num_module_steps_trained_lifetime": 48000, "num_module_steps_trained": 6000, "learner_connector_sum_episodes_length_out": 5250.0, "num_trainable_parameters": 6003, "learner_connector_sum_episodes_length_in": 5000.0, "num_env_steps_trained_lifetime_throughput": 2640521.0471991063, "num_module_steps_trained_throughput": 505624.6380384617, "num_module_steps_trained_lifetime_throughput": 504670.9336435423}, "default_policy": {"diff_num_grad_updates_vs_sampler_policy": 1.0, "vf_loss_unclipped": 28.60869026184082, "num_module_steps_trained": 6000, "total_loss": -0.05461999401450157, "num_trainable_parameters": 6003, "gradients_default_optimizer_global_norm": 0.14886373281478882, "weights_seq_no": 8.0, "mean_kl_loss": 0.0014844421530142426, "vf_explained_var": 0.020945727825164795, "vf_loss": 0.10170264542102814, "policy_loss": -0.1171649619936943, "default_optimizer_learning_rate": 0.0002847858517, "entropy": 0.6054023504257202, "num_module_steps_trained_lifetime": 48000, "curr_entropy_coeff": 0.0090570820258, "curr_kl_coeff": 0.0029160012491047382, "module_train_batch_size_mean": 1000.0, "num_module_steps_trained_lifetime_throughput": 506679.58716019115}}, "num_training_step_calls_per_iteration": 1, "evaluation": {"env_runners": {"num_agent_steps_sampled": {"default_agent": 400}, "num_env_steps_sampled_lifetime": 40400, "env_to_module_connector": {"timers": {"connectors": {"add_states_from_episodes_to_batch": 1.5847338809165182e-06, "batch_individual_items": 6.111517256916124e-06, "numpy_to_tensor": 8.203666336785019e-06, "add_observations_from_episodes_to_batch": 2.786895186409372e-06, "add_time_dim_to_batch_and_zero_pad": 2.1966206464706314e-06}}, "connector_pipeline_timer": 4.219830880974367e-05}, "episode_return_min": -16.5, "num_episodes": 20, "num_episodes_lifetime": 160, "module_to_env_connector": {"timers": {"connectors": {"un_batch_to_individual_items": 5.191795920160058e-06, "normalize_and_clip_actions": 9.255451911510087e-06, "listify_data_for_vector_env": 1.0815547846553584e-05, "tensor_to_numpy": 1.2655051760529163e-05, "get_actions": 3.443936055552557e-05, "remove_single_ts_time_rank_from_batch": 6.3885303856761e-07}}, "connector_pipeline_timer": 9.817089574972055e-05}, "episode_len_mean": 20.0, "weights_seq_no": 8.0, "episode_return_max": 12.5, "num_agent_steps_sampled_lifetime": {"default_agent": 3200}, "episode_len_min": 20, "num_env_steps_sampled": 400, "episode_duration_sec_mean": 0.004408249148400501, "module_episode_returns_mean": {"default_policy": 0.95}, "episode_return_mean": 0.95, "env_reset_timer": 0.00015901297043984815, "env_step_timer": 1.3869729376390498e-05, "num_module_steps_sampled": {"default_policy": 400}, "agent_episode_returns_mean": {"default_agent": 0.95}, "episode_len_max": 20, "env_to_module_sum_episodes_length_in": 10.3682383945743, "num_module_steps_sampled_lifetime": {"default_policy": 3200}, "env_to_module_sum_episodes_length_out": 10.3682383945743, "rlmodule_inference_timer": 2.6625045084704318e-05, "sample": 0.0969214959484022, "time_between_sampling": 1.5496667165154716}, "num_healthy_workers": 1, "actor_manager_num_outstanding_async_reqs": 0, "num_remote_worker_restarts": 0}, "num_env_steps_sampled_lifetime": -3695000.0, "fault_tolerance": {"num_healthy_workers": 0, "num_remote_worker_restarts": 0}, "env_runner_group": {"actor_manager_num_outstanding_async_reqs": 0}, "done": false, "training_iteration": 8, "trial_id": "49be2_00000", "date": "2025-08-11_19-36-22", "timestamp": 1754933782, "time_this_iter_s": 1.6157538890838623, "time_total_s": 13.195680618286133, "pid": 28164, "hostname": "Mac", "node_ip": "127.0.0.1", "config": {"exploration_config": {}, "extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "placement_strategy": "PACK", "num_gpus": 0, "_fake_gpus": false, "num_cpus_for_main_process": 2, "eager_tracing": true, "eager_max_retraces": 20, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "torch_compile_learner": false, "torch_compile_learner_what_to_compile": "forward_train", "torch_compile_learner_dynamo_backend": "aot_eager", "torch_compile_learner_dynamo_mode": null, "torch_compile_worker": false, "torch_compile_worker_dynamo_backend": "aot_eager", "torch_compile_worker_dynamo_mode": null, "torch_ddp_kwargs": {}, "torch_skip_nan_gradients": false, "env": "Umbrella", "env_config": {}, "observation_space": null, "action_space": null, "clip_rewards": null, "normalize_actions": true, "clip_actions": false, "_is_atari": null, "disable_env_checking": false, "render_env": false, "action_mask_key": "action_mask", "env_runner_cls": null, "num_env_runners": 0, "create_local_env_runner": true, "num_envs_per_env_runner": 1, "gym_env_vectorize_mode": "SYNC", "num_cpus_per_env_runner": 1, "num_gpus_per_env_runner": 0, "custom_resources_per_env_runner": {}, "validate_env_runners_after_construction": true, "episodes_to_numpy": true, "max_requests_in_flight_per_env_runner": 1, "sample_timeout_s": 60.0, "_env_to_module_connector": null, "add_default_connectors_to_env_to_module_pipeline": true, "_module_to_env_connector": null, "add_default_connectors_to_module_to_env_pipeline": true, "merge_env_runner_states": "training_only", "broadcast_env_runner_states": true, "episode_lookback_horizon": 1, "rollout_fragment_length": "auto", "batch_mode": "complete_episodes", "compress_observations": false, "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "enable_tf1_exec_eagerly": false, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "preprocessor_pref": "deepmind", "observation_filter": "NoFilter", "update_worker_filter_stats": true, "use_worker_filter_stats": true, "sampler_perf_stats_ema_coef": null, "_is_online": true, "num_learners": 0, "num_gpus_per_learner": 0, "num_cpus_per_learner": "auto", "num_aggregator_actors_per_learner": 0, "max_requests_in_flight_per_aggregator_actor": 3, "local_gpu_idx": 0, "max_requests_in_flight_per_learner": 3, "gamma": 1, "lr": 0.0002847858517, "grad_clip": 0.5, "grad_clip_by": "global_norm", "_train_batch_size_per_learner": 5000, "train_batch_size": 4000, "num_epochs": 1, "minibatch_size": 1000, "shuffle_batch_per_epoch": true, "model": {"fcnet_hiddens": [256, 256], "fcnet_activation": "tanh", "fcnet_weights_initializer": null, "fcnet_weights_initializer_config": null, "fcnet_bias_initializer": null, "fcnet_bias_initializer_config": null, "conv_filters": null, "conv_activation": "relu", "conv_kernel_initializer": null, "conv_kernel_initializer_config": null, "conv_bias_initializer": null, "conv_bias_initializer_config": null, "conv_transpose_kernel_initializer": null, "conv_transpose_kernel_initializer_config": null, "conv_transpose_bias_initializer": null, "conv_transpose_bias_initializer_config": null, "post_fcnet_hiddens": [], "post_fcnet_activation": "relu", "post_fcnet_weights_initializer": null, "post_fcnet_weights_initializer_config": null, "post_fcnet_bias_initializer": null, "post_fcnet_bias_initializer_config": null, "free_log_std": false, "log_std_clip_param": 20.0, "no_final_linear": false, "vf_share_layers": false, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "lstm_weights_initializer": null, "lstm_weights_initializer_config": null, "lstm_bias_initializer": null, "lstm_bias_initializer_config": null, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "attention_use_n_prev_actions": 0, "attention_use_n_prev_rewards": 0, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": null, "custom_model_config": {}, "custom_action_dist": null, "custom_preprocessor": null, "encoder_latent_dim": null, "always_check_shapes": false, "lstm_use_prev_action_reward": -1, "_use_default_native_models": -1, "_disable_preprocessor_api": false, "_disable_action_flattening": false}, "_learner_connector": null, "add_default_connectors_to_learner_pipeline": true, "learner_config_dict": {}, "optimizer": {}, "_learner_class": null, "callbacks_on_algorithm_init": null, "callbacks_on_env_runners_recreated": null, "callbacks_on_offline_eval_runners_recreated": null, "callbacks_on_checkpoint_loaded": null, "callbacks_on_environment_created": null, "callbacks_on_episode_created": null, "callbacks_on_episode_start": null, "callbacks_on_episode_step": null, "callbacks_on_episode_end": null, "callbacks_on_evaluate_start": null, "callbacks_on_evaluate_end": null, "callbacks_on_evaluate_offline_start": null, "callbacks_on_evaluate_offline_end": null, "callbacks_on_sample_end": null, "callbacks_on_train_result": null, "explore": true, "enable_rl_module_and_learner": true, "enable_env_runner_and_connector_v2": true, "_prior_exploration_config": {"type": "StochasticSampling"}, "count_steps_by": "env_steps", "policy_map_capacity": 100, "policy_mapping_fn": "<function AlgorithmConfig.DEFAULT_POLICY_MAPPING_FN at 0x145c2d8a0>", "policies_to_train": null, "policy_states_are_swappable": false, "observation_fn": null, "offline_data_class": null, "input_read_method": "read_parquet", "input_read_method_kwargs": {}, "input_read_schema": {}, "input_read_episodes": false, "input_read_sample_batches": false, "input_read_batch_size": null, "input_filesystem": null, "input_filesystem_kwargs": {}, "input_compress_columns": ["obs", "new_obs"], "input_spaces_jsonable": true, "materialize_data": false, "materialize_mapped_data": true, "map_batches_kwargs": {}, "iter_batches_kwargs": {}, "ignore_final_observation": false, "prelearner_class": null, "prelearner_buffer_class": null, "prelearner_buffer_kwargs": {}, "prelearner_module_synch_period": 10, "dataset_num_iters_per_learner": null, "input_config": {}, "actions_in_input_normalized": false, "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_config": {}, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "output_max_rows_per_file": null, "output_write_remaining_data": false, "output_write_method": "write_parquet", "output_write_method_kwargs": {}, "output_filesystem": null, "output_filesystem_kwargs": {}, "output_write_episodes": true, "offline_sampling": false, "evaluation_interval": 1, "evaluation_duration": 20, "evaluation_duration_unit": "episodes", "evaluation_sample_timeout_s": 120.0, "evaluation_auto_duration_min_env_steps_per_sample": 100, "evaluation_auto_duration_max_env_steps_per_sample": 2000, "evaluation_parallel_to_training": false, "evaluation_force_reset_envs_before_iteration": true, "evaluation_config": null, "off_policy_estimation_methods": {}, "ope_split_batch_by_episode": true, "evaluation_num_env_runners": 1, "in_evaluation": false, "sync_filters_on_rollout_workers_timeout_s": 10.0, "offline_evaluation_interval": null, "num_offline_eval_runners": 0, "offline_loss_for_module_fn": null, "offline_evaluation_duration": 1, "offline_evaluation_parallel_to_training": false, "offline_evaluation_timeout_s": 120.0, "num_cpus_per_offline_eval_runner": 1, "num_gpus_per_offline_eval_runner": 0, "custom_resources_per_offline_eval_runner": {}, "restart_failed_offline_eval_runners": true, "ignore_offline_eval_runner_failures": false, "max_num_offline_eval_runner_restarts": 1000, "offline_eval_runner_restore_timeout_s": 1800.0, "max_requests_in_flight_per_offline_eval_runner": 1, "validate_offline_eval_runners_after_construction": true, "offline_eval_runner_health_probe_timeout_s": 30.0, "offline_eval_rl_module_inference_only": false, "broadcast_offline_eval_runner_states": false, "offline_eval_batch_size_per_runner": 256, "dataset_num_iters_per_eval_runner": 1, "keep_per_episode_custom_metrics": false, "metrics_episode_collection_timeout_s": 60.0, "metrics_num_episodes_for_smoothing": 100, "min_time_s_per_iteration": null, "min_train_timesteps_per_iteration": 0, "min_sample_timesteps_per_iteration": 0, "log_gradients": true, "export_native_model_files": false, "checkpoint_trainable_policies_only": false, "logger_creator": null, "logger_config": null, "log_level": "WARN", "log_sys_usage": true, "fake_sampler": false, "seed": 4, "restart_failed_env_runners": true, "ignore_env_runner_failures": false, "max_num_env_runner_restarts": 1000, "delay_between_env_runner_restarts_s": 60.0, "restart_failed_sub_environments": false, "num_consecutive_env_runner_failures_tolerance": 100, "env_runner_health_probe_timeout_s": 30.0, "env_runner_restore_timeout_s": 1800.0, "_model_config": {}, "_rl_module_spec": "RLModuleSpec(module_class=None, observation_space=None, action_space=None, inference_only=False, learner_only=False, model_config=DefaultModelConfig(fcnet_hiddens=[60, 90], fcnet_activation='tanh', fcnet_kernel_initializer=None, fcnet_kernel_initializer_kwargs=None, fcnet_bias_initializer=None, fcnet_bias_initializer_kwargs=None, conv_filters=None, conv_activation='relu', conv_kernel_initializer=None, conv_kernel_initializer_kwargs=None, conv_bias_initializer=None, conv_bias_initializer_kwargs=None, head_fcnet_hiddens=[], head_fcnet_activation='relu', head_fcnet_kernel_initializer=None, head_fcnet_kernel_initializer_kwargs=None, head_fcnet_bias_initializer=None, head_fcnet_bias_initializer_kwargs=None, free_log_std=False, log_std_clip_param=20.0, vf_share_layers=True, use_lstm=False, max_seq_len=20, lstm_cell_size=256, lstm_use_prev_action=False, lstm_use_prev_reward=False, lstm_kernel_initializer=None, lstm_kernel_initializer_kwargs=None, lstm_bias_initializer=None, lstm_bias_initializer_kwargs=None), catalog_class=None, load_state_path=None, model_config_dict=None)", "algorithm_config_overrides_per_module": {}, "_per_module_overrides": {}, "_validate_config": true, "_use_msgpack_checkpoints": false, "_torch_grad_scaler_class": null, "_torch_lr_scheduler_classes": null, "_tf_policy_handles_more_than_one_loss": false, "_disable_preprocessor_api": false, "_disable_action_flattening": false, "_disable_initialize_loss_from_dummy_batch": false, "_dont_auto_sync_env_runner_states": false, "env_task_fn": -1, "enable_connectors": -1, "simple_optimizer": false, "policy_map_cache": -1, "worker_cls": -1, "synchronize_filters": -1, "enable_async_evaluation": -1, "custom_async_evaluation_function": -1, "_enable_rl_module_api": -1, "auto_wrap_old_gym_envs": -1, "always_attach_evaluation_results": -1, "replay_sequence_length": null, "_disable_execution_plan_api": -1, "use_critic": true, "use_gae": true, "use_kl_loss": true, "kl_coeff": 0.7464963036515, "kl_target": 0.0270990929592, "vf_loss_coeff": 0.6688075857018, "entropy_coeff": 0.0090570820258, "clip_param": 0.1221781641624, "vf_clip_param": 0.1027808522125, "entropy_coeff_schedule": null, "lr_schedule": null, "sgd_minibatch_size": -1, "vf_share_layers": -1, "__stdout_file__": null, "__stderr_file__": null, "lambda": 0.9099046732075, "input": "sampler", "policies": {"default_policy": [null, null, null, null]}, "callbacks": "<class 'ray.rllib.callbacks.callbacks.RLlibCallback'>", "create_env_on_driver": false, "custom_eval_function": null, "framework": "torch"}, "time_since_restore": 13.195680618286133, "iterations_since_restore": 8, "perf": {"cpu_util_percent": 35.05, "ram_util_percent": 74.95}}
{"timers": {"training_iteration": 1.5552008248193576, "restore_env_runners": 9.605645876229876e-06, "training_step": 1.555080224333869, "env_runner_sampling_timer": 1.4454413021700847, "learner_update_timer": 0.10669485481800425, "synch_weights": 0.0005978161272481316, "restore_eval_env_runners": 7.831103817433659e-06, "evaluation_iteration": 0.10299822424870554, "synch_eval_env_connectors": 0.0001173990245318575, "synch_env_connectors": 4.53831371608675e-06}, "env_runners": {"num_episodes_lifetime": -215625.0, "episode_len_mean": 20.0, "env_to_module_connector": {"timers": {"connectors": {"batch_individual_items": 6.053948074335051e-06, "add_observations_from_episodes_to_batch": 2.8730841002527745e-06, "add_states_from_episodes_to_batch": 1.7247467086029286e-06, "numpy_to_tensor": 8.244891006176264e-06, "add_time_dim_to_batch_and_zero_pad": 2.3497794359364178e-06}}, "connector_pipeline_timer": 4.2379108640943086e-05}, "agent_episode_returns_mean": {"default_agent": 8.980000000000004}, "episode_return_max": 12.5, "num_module_steps_sampled_lifetime": {"default_policy": -4312500.0}, "env_step_timer": 1.3402743524988021e-05, "module_to_env_connector": {"timers": {"connectors": {"listify_data_for_vector_env": 1.0833701521436659e-05, "remove_single_ts_time_rank_from_batch": 5.742789094707347e-07, "tensor_to_numpy": 1.2922573466571235e-05, "un_batch_to_individual_items": 5.237627074755788e-06, "get_actions": 3.769493086012314e-05, "normalize_and_clip_actions": 9.213073082185548e-06}}, "connector_pipeline_timer": 0.00010144994495959126}, "module_episode_returns_mean": {"default_policy": 8.980000000000004}, "num_env_steps_sampled_lifetime": -4312500.0, "episode_len_min": 20, "episode_return_min": -7.5, "time_between_sampling": 0.001445359127647477, "num_env_steps_sampled": 5000.0, "num_module_steps_sampled": {"default_policy": 5000.0}, "num_episodes": 250.0, "episode_len_max": 20, "num_agent_steps_sampled": {"default_agent": 5000.0}, "episode_duration_sec_mean": 0.0044367646262980995, "env_to_module_sum_episodes_length_in": 10.36823839457432, "num_agent_steps_sampled_lifetime": {"default_agent": -4312500.0}, "env_to_module_sum_episodes_length_out": 10.36823839457432, "rlmodule_inference_timer": 2.7095488110114905e-05, "episode_return_mean": 8.980000000000004, "sample": 0.004790763512091366, "env_reset_timer": 2.9338584023014932e-05, "weights_seq_no": 8.0, "num_env_steps_sampled_lifetime_throughput": 3837.969062545019}, "learners": {"__all_modules__": {"num_non_trainable_parameters": 0, "learner_connector": {"timers": {"connectors": {"add_time_dim_to_batch_and_zero_pad": 9.817776389210232e-06, "batch_individual_items": 0.03138449661138438, "add_one_ts_to_episodes_and_truncate": 0.008505509256378647, "general_advantage_estimation": 0.007484198760411468, "numpy_to_tensor": 6.679278650870501e-05, "add_observations_from_episodes_to_batch": 0.0008085473567617262, "add_states_from_episodes_to_batch": 3.1910085597508166e-06, "add_columns_from_episodes_to_train_batch": 0.03430528199676982}}, "connector_pipeline_timer": 0.0826804004898524}, "num_env_steps_trained_lifetime": 283500, "num_env_steps_trained": 31500, "num_module_steps_trained_lifetime": 54000, "num_module_steps_trained": 6000, "learner_connector_sum_episodes_length_out": 5250.0, "num_trainable_parameters": 6003, "learner_connector_sum_episodes_length_in": 5000.0, "num_env_steps_trained_lifetime_throughput": 2632012.234639751, "num_module_steps_trained_throughput": 503899.09584065224, "num_module_steps_trained_lifetime_throughput": 502977.4995130495}, "default_policy": {"diff_num_grad_updates_vs_sampler_policy": 1.0, "vf_loss_unclipped": 28.674518585205078, "num_module_steps_trained": 6000, "total_loss": -0.04069652780890465, "num_trainable_parameters": 6003, "gradients_default_optimizer_global_norm": 0.023104187101125717, "weights_seq_no": 9.0, "mean_kl_loss": 0.0018121906323358417, "vf_explained_var": 0.019284963607788086, "vf_loss": 0.10202646255493164, "policy_loss": -0.10377395898103714, "default_optimizer_learning_rate": 0.0002847858517, "entropy": 0.5701533555984497, "num_module_steps_trained_lifetime": 54000, "curr_entropy_coeff": 0.0090570820258, "curr_kl_coeff": 0.0014580006245523691, "module_train_batch_size_mean": 1000.0, "num_module_steps_trained_lifetime_throughput": 504870.4557910309}}, "num_training_step_calls_per_iteration": 1, "evaluation": {"env_runners": {"num_agent_steps_sampled": {"default_agent": 400}, "num_env_steps_sampled_lifetime": 45400, "env_to_module_connector": {"timers": {"connectors": {"add_states_from_episodes_to_batch": 1.585364758001392e-06, "batch_individual_items": 6.1171095160343155e-06, "numpy_to_tensor": 8.206464909663468e-06, "add_observations_from_episodes_to_batch": 2.7599448864666644e-06, "add_time_dim_to_batch_and_zero_pad": 2.190119291585204e-06}}, "connector_pipeline_timer": 4.220976470676376e-05}, "episode_return_min": -16.5, "num_episodes": 20, "num_episodes_lifetime": 180, "module_to_env_connector": {"timers": {"connectors": {"un_batch_to_individual_items": 5.278017417649024e-06, "normalize_and_clip_actions": 9.218783807896345e-06, "listify_data_for_vector_env": 1.0822329619034394e-05, "tensor_to_numpy": 1.2961895802709954e-05, "get_actions": 3.4852100358153114e-05, "remove_single_ts_time_rank_from_batch": 5.732420586808653e-07}}, "connector_pipeline_timer": 9.869914787635569e-05}, "episode_len_mean": 20.0, "weights_seq_no": 9.0, "episode_return_max": 12.5, "num_agent_steps_sampled_lifetime": {"default_agent": 3600}, "episode_len_min": 20, "num_env_steps_sampled": 400, "episode_duration_sec_mean": 0.004383748730178922, "module_episode_returns_mean": {"default_policy": 1.35}, "episode_return_mean": 1.35, "env_reset_timer": 0.00015814326065643062, "env_step_timer": 1.3794690211688371e-05, "num_module_steps_sampled": {"default_policy": 400}, "agent_episode_returns_mean": {"default_agent": 1.35}, "episode_len_max": 20, "env_to_module_sum_episodes_length_in": 10.368238394574323, "num_module_steps_sampled_lifetime": {"default_policy": 3600}, "env_to_module_sum_episodes_length_out": 10.368238394574323, "rlmodule_inference_timer": 2.6537363181333277e-05, "sample": 0.09691025431943269, "time_between_sampling": 1.5494957097601885}, "num_healthy_workers": 1, "actor_manager_num_outstanding_async_reqs": 0, "num_remote_worker_restarts": 0}, "num_env_steps_sampled_lifetime": -4312500.0, "fault_tolerance": {"num_healthy_workers": 0, "num_remote_worker_restarts": 0}, "env_runner_group": {"actor_manager_num_outstanding_async_reqs": 0}, "done": false, "training_iteration": 9, "trial_id": "49be2_00000", "date": "2025-08-11_19-36-24", "timestamp": 1754933784, "time_this_iter_s": 1.618804931640625, "time_total_s": 14.814485549926758, "pid": 28164, "hostname": "Mac", "node_ip": "127.0.0.1", "config": {"exploration_config": {}, "extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "placement_strategy": "PACK", "num_gpus": 0, "_fake_gpus": false, "num_cpus_for_main_process": 2, "eager_tracing": true, "eager_max_retraces": 20, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "torch_compile_learner": false, "torch_compile_learner_what_to_compile": "forward_train", "torch_compile_learner_dynamo_backend": "aot_eager", "torch_compile_learner_dynamo_mode": null, "torch_compile_worker": false, "torch_compile_worker_dynamo_backend": "aot_eager", "torch_compile_worker_dynamo_mode": null, "torch_ddp_kwargs": {}, "torch_skip_nan_gradients": false, "env": "Umbrella", "env_config": {}, "observation_space": null, "action_space": null, "clip_rewards": null, "normalize_actions": true, "clip_actions": false, "_is_atari": null, "disable_env_checking": false, "render_env": false, "action_mask_key": "action_mask", "env_runner_cls": null, "num_env_runners": 0, "create_local_env_runner": true, "num_envs_per_env_runner": 1, "gym_env_vectorize_mode": "SYNC", "num_cpus_per_env_runner": 1, "num_gpus_per_env_runner": 0, "custom_resources_per_env_runner": {}, "validate_env_runners_after_construction": true, "episodes_to_numpy": true, "max_requests_in_flight_per_env_runner": 1, "sample_timeout_s": 60.0, "_env_to_module_connector": null, "add_default_connectors_to_env_to_module_pipeline": true, "_module_to_env_connector": null, "add_default_connectors_to_module_to_env_pipeline": true, "merge_env_runner_states": "training_only", "broadcast_env_runner_states": true, "episode_lookback_horizon": 1, "rollout_fragment_length": "auto", "batch_mode": "complete_episodes", "compress_observations": false, "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "enable_tf1_exec_eagerly": false, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "preprocessor_pref": "deepmind", "observation_filter": "NoFilter", "update_worker_filter_stats": true, "use_worker_filter_stats": true, "sampler_perf_stats_ema_coef": null, "_is_online": true, "num_learners": 0, "num_gpus_per_learner": 0, "num_cpus_per_learner": "auto", "num_aggregator_actors_per_learner": 0, "max_requests_in_flight_per_aggregator_actor": 3, "local_gpu_idx": 0, "max_requests_in_flight_per_learner": 3, "gamma": 1, "lr": 0.0002847858517, "grad_clip": 0.5, "grad_clip_by": "global_norm", "_train_batch_size_per_learner": 5000, "train_batch_size": 4000, "num_epochs": 1, "minibatch_size": 1000, "shuffle_batch_per_epoch": true, "model": {"fcnet_hiddens": [256, 256], "fcnet_activation": "tanh", "fcnet_weights_initializer": null, "fcnet_weights_initializer_config": null, "fcnet_bias_initializer": null, "fcnet_bias_initializer_config": null, "conv_filters": null, "conv_activation": "relu", "conv_kernel_initializer": null, "conv_kernel_initializer_config": null, "conv_bias_initializer": null, "conv_bias_initializer_config": null, "conv_transpose_kernel_initializer": null, "conv_transpose_kernel_initializer_config": null, "conv_transpose_bias_initializer": null, "conv_transpose_bias_initializer_config": null, "post_fcnet_hiddens": [], "post_fcnet_activation": "relu", "post_fcnet_weights_initializer": null, "post_fcnet_weights_initializer_config": null, "post_fcnet_bias_initializer": null, "post_fcnet_bias_initializer_config": null, "free_log_std": false, "log_std_clip_param": 20.0, "no_final_linear": false, "vf_share_layers": false, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "lstm_weights_initializer": null, "lstm_weights_initializer_config": null, "lstm_bias_initializer": null, "lstm_bias_initializer_config": null, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "attention_use_n_prev_actions": 0, "attention_use_n_prev_rewards": 0, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": null, "custom_model_config": {}, "custom_action_dist": null, "custom_preprocessor": null, "encoder_latent_dim": null, "always_check_shapes": false, "lstm_use_prev_action_reward": -1, "_use_default_native_models": -1, "_disable_preprocessor_api": false, "_disable_action_flattening": false}, "_learner_connector": null, "add_default_connectors_to_learner_pipeline": true, "learner_config_dict": {}, "optimizer": {}, "_learner_class": null, "callbacks_on_algorithm_init": null, "callbacks_on_env_runners_recreated": null, "callbacks_on_offline_eval_runners_recreated": null, "callbacks_on_checkpoint_loaded": null, "callbacks_on_environment_created": null, "callbacks_on_episode_created": null, "callbacks_on_episode_start": null, "callbacks_on_episode_step": null, "callbacks_on_episode_end": null, "callbacks_on_evaluate_start": null, "callbacks_on_evaluate_end": null, "callbacks_on_evaluate_offline_start": null, "callbacks_on_evaluate_offline_end": null, "callbacks_on_sample_end": null, "callbacks_on_train_result": null, "explore": true, "enable_rl_module_and_learner": true, "enable_env_runner_and_connector_v2": true, "_prior_exploration_config": {"type": "StochasticSampling"}, "count_steps_by": "env_steps", "policy_map_capacity": 100, "policy_mapping_fn": "<function AlgorithmConfig.DEFAULT_POLICY_MAPPING_FN at 0x145c2d8a0>", "policies_to_train": null, "policy_states_are_swappable": false, "observation_fn": null, "offline_data_class": null, "input_read_method": "read_parquet", "input_read_method_kwargs": {}, "input_read_schema": {}, "input_read_episodes": false, "input_read_sample_batches": false, "input_read_batch_size": null, "input_filesystem": null, "input_filesystem_kwargs": {}, "input_compress_columns": ["obs", "new_obs"], "input_spaces_jsonable": true, "materialize_data": false, "materialize_mapped_data": true, "map_batches_kwargs": {}, "iter_batches_kwargs": {}, "ignore_final_observation": false, "prelearner_class": null, "prelearner_buffer_class": null, "prelearner_buffer_kwargs": {}, "prelearner_module_synch_period": 10, "dataset_num_iters_per_learner": null, "input_config": {}, "actions_in_input_normalized": false, "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_config": {}, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "output_max_rows_per_file": null, "output_write_remaining_data": false, "output_write_method": "write_parquet", "output_write_method_kwargs": {}, "output_filesystem": null, "output_filesystem_kwargs": {}, "output_write_episodes": true, "offline_sampling": false, "evaluation_interval": 1, "evaluation_duration": 20, "evaluation_duration_unit": "episodes", "evaluation_sample_timeout_s": 120.0, "evaluation_auto_duration_min_env_steps_per_sample": 100, "evaluation_auto_duration_max_env_steps_per_sample": 2000, "evaluation_parallel_to_training": false, "evaluation_force_reset_envs_before_iteration": true, "evaluation_config": null, "off_policy_estimation_methods": {}, "ope_split_batch_by_episode": true, "evaluation_num_env_runners": 1, "in_evaluation": false, "sync_filters_on_rollout_workers_timeout_s": 10.0, "offline_evaluation_interval": null, "num_offline_eval_runners": 0, "offline_loss_for_module_fn": null, "offline_evaluation_duration": 1, "offline_evaluation_parallel_to_training": false, "offline_evaluation_timeout_s": 120.0, "num_cpus_per_offline_eval_runner": 1, "num_gpus_per_offline_eval_runner": 0, "custom_resources_per_offline_eval_runner": {}, "restart_failed_offline_eval_runners": true, "ignore_offline_eval_runner_failures": false, "max_num_offline_eval_runner_restarts": 1000, "offline_eval_runner_restore_timeout_s": 1800.0, "max_requests_in_flight_per_offline_eval_runner": 1, "validate_offline_eval_runners_after_construction": true, "offline_eval_runner_health_probe_timeout_s": 30.0, "offline_eval_rl_module_inference_only": false, "broadcast_offline_eval_runner_states": false, "offline_eval_batch_size_per_runner": 256, "dataset_num_iters_per_eval_runner": 1, "keep_per_episode_custom_metrics": false, "metrics_episode_collection_timeout_s": 60.0, "metrics_num_episodes_for_smoothing": 100, "min_time_s_per_iteration": null, "min_train_timesteps_per_iteration": 0, "min_sample_timesteps_per_iteration": 0, "log_gradients": true, "export_native_model_files": false, "checkpoint_trainable_policies_only": false, "logger_creator": null, "logger_config": null, "log_level": "WARN", "log_sys_usage": true, "fake_sampler": false, "seed": 4, "restart_failed_env_runners": true, "ignore_env_runner_failures": false, "max_num_env_runner_restarts": 1000, "delay_between_env_runner_restarts_s": 60.0, "restart_failed_sub_environments": false, "num_consecutive_env_runner_failures_tolerance": 100, "env_runner_health_probe_timeout_s": 30.0, "env_runner_restore_timeout_s": 1800.0, "_model_config": {}, "_rl_module_spec": "RLModuleSpec(module_class=None, observation_space=None, action_space=None, inference_only=False, learner_only=False, model_config=DefaultModelConfig(fcnet_hiddens=[60, 90], fcnet_activation='tanh', fcnet_kernel_initializer=None, fcnet_kernel_initializer_kwargs=None, fcnet_bias_initializer=None, fcnet_bias_initializer_kwargs=None, conv_filters=None, conv_activation='relu', conv_kernel_initializer=None, conv_kernel_initializer_kwargs=None, conv_bias_initializer=None, conv_bias_initializer_kwargs=None, head_fcnet_hiddens=[], head_fcnet_activation='relu', head_fcnet_kernel_initializer=None, head_fcnet_kernel_initializer_kwargs=None, head_fcnet_bias_initializer=None, head_fcnet_bias_initializer_kwargs=None, free_log_std=False, log_std_clip_param=20.0, vf_share_layers=True, use_lstm=False, max_seq_len=20, lstm_cell_size=256, lstm_use_prev_action=False, lstm_use_prev_reward=False, lstm_kernel_initializer=None, lstm_kernel_initializer_kwargs=None, lstm_bias_initializer=None, lstm_bias_initializer_kwargs=None), catalog_class=None, load_state_path=None, model_config_dict=None)", "algorithm_config_overrides_per_module": {}, "_per_module_overrides": {}, "_validate_config": true, "_use_msgpack_checkpoints": false, "_torch_grad_scaler_class": null, "_torch_lr_scheduler_classes": null, "_tf_policy_handles_more_than_one_loss": false, "_disable_preprocessor_api": false, "_disable_action_flattening": false, "_disable_initialize_loss_from_dummy_batch": false, "_dont_auto_sync_env_runner_states": false, "env_task_fn": -1, "enable_connectors": -1, "simple_optimizer": false, "policy_map_cache": -1, "worker_cls": -1, "synchronize_filters": -1, "enable_async_evaluation": -1, "custom_async_evaluation_function": -1, "_enable_rl_module_api": -1, "auto_wrap_old_gym_envs": -1, "always_attach_evaluation_results": -1, "replay_sequence_length": null, "_disable_execution_plan_api": -1, "use_critic": true, "use_gae": true, "use_kl_loss": true, "kl_coeff": 0.7464963036515, "kl_target": 0.0270990929592, "vf_loss_coeff": 0.6688075857018, "entropy_coeff": 0.0090570820258, "clip_param": 0.1221781641624, "vf_clip_param": 0.1027808522125, "entropy_coeff_schedule": null, "lr_schedule": null, "sgd_minibatch_size": -1, "vf_share_layers": -1, "__stdout_file__": null, "__stderr_file__": null, "lambda": 0.9099046732075, "input": "sampler", "policies": {"default_policy": [null, null, null, null]}, "callbacks": "<class 'ray.rllib.callbacks.callbacks.RLlibCallback'>", "create_env_on_driver": false, "custom_eval_function": null, "framework": "torch"}, "time_since_restore": 14.814485549926758, "iterations_since_restore": 9, "perf": {"cpu_util_percent": 34.333333333333336, "ram_util_percent": 75.0}}
{"timers": {"training_iteration": 1.5748926299014716, "restore_env_runners": 9.560838934595448e-06, "training_step": 1.5747700325000584, "env_runner_sampling_timer": 1.4444433791486282, "learner_update_timer": 0.12727881127010293, "synch_weights": 0.0006326842164612791, "restore_eval_env_runners": 7.817792110048172e-06, "evaluation_iteration": 0.10297217825714541, "synch_eval_env_connectors": 0.00011739544482835646, "synch_env_connectors": 4.531270801016365e-06}, "env_runners": {"num_episodes_lifetime": -246500.0, "episode_len_mean": 20.0, "env_to_module_connector": {"timers": {"connectors": {"batch_individual_items": 6.090839653662995e-06, "add_observations_from_episodes_to_batch": 2.930903227327518e-06, "add_states_from_episodes_to_batch": 1.715796767748016e-06, "numpy_to_tensor": 8.287871959288285e-06, "add_time_dim_to_batch_and_zero_pad": 2.3371556870843345e-06}}, "connector_pipeline_timer": 4.255984656410816e-05}, "agent_episode_returns_mean": {"default_agent": 8.260000000000002}, "episode_return_max": 12.5, "num_module_steps_sampled_lifetime": {"default_policy": -4930000.0}, "env_step_timer": 1.3491293224118313e-05, "module_to_env_connector": {"timers": {"connectors": {"listify_data_for_vector_env": 1.0868046336504973e-05, "remove_single_ts_time_rank_from_batch": 5.748478327043073e-07, "tensor_to_numpy": 1.2990964086039755e-05, "un_batch_to_individual_items": 5.251114535600516e-06, "get_actions": 3.787773093896411e-05, "normalize_and_clip_actions": 9.24324609791002e-06}}, "connector_pipeline_timer": 0.00010188644120881833}, "module_episode_returns_mean": {"default_policy": 8.260000000000002}, "num_env_steps_sampled_lifetime": -4930000.0, "episode_len_min": 20, "episode_return_min": -7.5, "time_between_sampling": 0.0017496557927656818, "num_env_steps_sampled": 5000.0, "num_module_steps_sampled": {"default_policy": 5000.0}, "num_episodes": 250.0, "episode_len_max": 20, "num_agent_steps_sampled": {"default_agent": 5000.0}, "episode_duration_sec_mean": 0.00445206631347537, "env_to_module_sum_episodes_length_in": 10.36823839457432, "num_agent_steps_sampled_lifetime": {"default_agent": -4930000.0}, "env_to_module_sum_episodes_length_out": 10.36823839457432, "rlmodule_inference_timer": 2.6886421871289997e-05, "episode_return_mean": 8.260000000000002, "sample": 0.004750392110647934, "env_reset_timer": 3.0069909942613168e-05, "weights_seq_no": 9.0, "num_env_steps_sampled_lifetime_throughput": 3816.9347843168125}, "learners": {"__all_modules__": {"num_non_trainable_parameters": 0, "learner_connector": {"timers": {"connectors": {"add_time_dim_to_batch_and_zero_pad": 9.835428378076275e-06, "batch_individual_items": 0.03247450330570469, "add_one_ts_to_episodes_and_truncate": 0.008499130003864841, "general_advantage_estimation": 0.007559219692741447, "numpy_to_tensor": 6.687818917607938e-05, "add_observations_from_episodes_to_batch": 0.0008090443839349947, "add_states_from_episodes_to_batch": 3.195769300528793e-06, "add_columns_from_episodes_to_train_batch": 0.034448079596884104}}, "connector_pipeline_timer": 0.083982899405029}, "num_env_steps_trained_lifetime": 315000, "num_env_steps_trained": 31500, "num_module_steps_trained_lifetime": 60000, "num_module_steps_trained": 6000, "learner_connector_sum_episodes_length_out": 5250.0, "num_trainable_parameters": 6003, "learner_connector_sum_episodes_length_in": 5000.0, "num_env_steps_trained_lifetime_throughput": 2593226.173796574, "num_module_steps_trained_throughput": 496402.55730799836, "num_module_steps_trained_lifetime_throughput": 495518.1845353639}, "default_policy": {"diff_num_grad_updates_vs_sampler_policy": 1.0, "vf_loss_unclipped": 28.66448402404785, "num_module_steps_trained": 6000, "total_loss": -0.06608772277832031, "num_trainable_parameters": 6003, "gradients_default_optimizer_global_norm": 0.07620148360729218, "weights_seq_no": 10.0, "mean_kl_loss": 0.0017268538940697908, "vf_explained_var": 0.019550085067749023, "vf_loss": 0.10191888362169266, "policy_loss": -0.12937036156654358, "default_optimizer_learning_rate": 0.0002847858517, "entropy": 0.5392490029335022, "num_module_steps_trained_lifetime": 60000, "curr_entropy_coeff": 0.0090570820258, "curr_kl_coeff": 0.0007290003122761846, "module_train_batch_size_mean": 1000.0, "num_module_steps_trained_lifetime_throughput": 497293.2690446095}}, "num_training_step_calls_per_iteration": 1, "evaluation": {"env_runners": {"num_agent_steps_sampled": {"default_agent": 400}, "num_env_steps_sampled_lifetime": 50400, "env_to_module_connector": {"timers": {"connectors": {"add_states_from_episodes_to_batch": 4.4652870239006115e-06, "batch_individual_items": 2.95764433371523e-05, "numpy_to_tensor": 3.262471375938284e-05, "add_observations_from_episodes_to_batch": 7.995554954566698e-06, "add_time_dim_to_batch_and_zero_pad": 6.285863914810543e-06}}, "connector_pipeline_timer": 0.00015204978213744034}, "episode_return_min": -16.5, "num_episodes": 20, "num_episodes_lifetime": 200, "module_to_env_connector": {"timers": {"connectors": {"un_batch_to_individual_items": 2.311804070558554e-05, "normalize_and_clip_actions": 7.332078897913675e-05, "listify_data_for_vector_env": 4.055009816053575e-05, "tensor_to_numpy": 5.122009390509177e-05, "get_actions": 0.00017290858956360556, "remove_single_ts_time_rank_from_batch": 3.7028242131507685e-06}}, "connector_pipeline_timer": 0.00047240469811340655}, "episode_len_mean": 20.0, "weights_seq_no": 10.0, "episode_return_max": 12.5, "num_agent_steps_sampled_lifetime": {"default_agent": 4000}, "episode_len_min": 20, "num_env_steps_sampled": 400, "episode_duration_sec_mean": 0.009342572460882366, "module_episode_returns_mean": {"default_policy": 0.95}, "episode_return_mean": 0.95, "env_reset_timer": 0.00016181390762239493, "env_step_timer": 6.0527644723664116e-05, "num_module_steps_sampled": {"default_policy": 400}, "agent_episode_returns_mean": {"default_agent": 0.95}, "episode_len_max": 20, "env_to_module_sum_episodes_length_in": 10.368238394574323, "num_module_steps_sampled_lifetime": {"default_policy": 4000}, "env_to_module_sum_episodes_length_out": 10.368238394574323, "rlmodule_inference_timer": 0.00014348075004872485, "sample": 0.10213003093714734, "time_between_sampling": 1.5695225930726606}, "num_healthy_workers": 1, "actor_manager_num_outstanding_async_reqs": 0, "num_remote_worker_restarts": 0}, "num_env_steps_sampled_lifetime": -4930000.0, "fault_tolerance": {"num_healthy_workers": 0, "num_remote_worker_restarts": 0}, "env_runner_group": {"actor_manager_num_outstanding_async_reqs": 0}, "done": false, "training_iteration": 10, "trial_id": "49be2_00000", "date": "2025-08-11_19-36-28", "timestamp": 1754933788, "time_this_iter_s": 4.1756367683410645, "time_total_s": 18.990122318267822, "pid": 28164, "hostname": "Mac", "node_ip": "127.0.0.1", "config": {"exploration_config": {}, "extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "placement_strategy": "PACK", "num_gpus": 0, "_fake_gpus": false, "num_cpus_for_main_process": 2, "eager_tracing": true, "eager_max_retraces": 20, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "torch_compile_learner": false, "torch_compile_learner_what_to_compile": "forward_train", "torch_compile_learner_dynamo_backend": "aot_eager", "torch_compile_learner_dynamo_mode": null, "torch_compile_worker": false, "torch_compile_worker_dynamo_backend": "aot_eager", "torch_compile_worker_dynamo_mode": null, "torch_ddp_kwargs": {}, "torch_skip_nan_gradients": false, "env": "Umbrella", "env_config": {}, "observation_space": null, "action_space": null, "clip_rewards": null, "normalize_actions": true, "clip_actions": false, "_is_atari": null, "disable_env_checking": false, "render_env": false, "action_mask_key": "action_mask", "env_runner_cls": null, "num_env_runners": 0, "create_local_env_runner": true, "num_envs_per_env_runner": 1, "gym_env_vectorize_mode": "SYNC", "num_cpus_per_env_runner": 1, "num_gpus_per_env_runner": 0, "custom_resources_per_env_runner": {}, "validate_env_runners_after_construction": true, "episodes_to_numpy": true, "max_requests_in_flight_per_env_runner": 1, "sample_timeout_s": 60.0, "_env_to_module_connector": null, "add_default_connectors_to_env_to_module_pipeline": true, "_module_to_env_connector": null, "add_default_connectors_to_module_to_env_pipeline": true, "merge_env_runner_states": "training_only", "broadcast_env_runner_states": true, "episode_lookback_horizon": 1, "rollout_fragment_length": "auto", "batch_mode": "complete_episodes", "compress_observations": false, "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "enable_tf1_exec_eagerly": false, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "preprocessor_pref": "deepmind", "observation_filter": "NoFilter", "update_worker_filter_stats": true, "use_worker_filter_stats": true, "sampler_perf_stats_ema_coef": null, "_is_online": true, "num_learners": 0, "num_gpus_per_learner": 0, "num_cpus_per_learner": "auto", "num_aggregator_actors_per_learner": 0, "max_requests_in_flight_per_aggregator_actor": 3, "local_gpu_idx": 0, "max_requests_in_flight_per_learner": 3, "gamma": 1, "lr": 0.0002847858517, "grad_clip": 0.5, "grad_clip_by": "global_norm", "_train_batch_size_per_learner": 5000, "train_batch_size": 4000, "num_epochs": 1, "minibatch_size": 1000, "shuffle_batch_per_epoch": true, "model": {"fcnet_hiddens": [256, 256], "fcnet_activation": "tanh", "fcnet_weights_initializer": null, "fcnet_weights_initializer_config": null, "fcnet_bias_initializer": null, "fcnet_bias_initializer_config": null, "conv_filters": null, "conv_activation": "relu", "conv_kernel_initializer": null, "conv_kernel_initializer_config": null, "conv_bias_initializer": null, "conv_bias_initializer_config": null, "conv_transpose_kernel_initializer": null, "conv_transpose_kernel_initializer_config": null, "conv_transpose_bias_initializer": null, "conv_transpose_bias_initializer_config": null, "post_fcnet_hiddens": [], "post_fcnet_activation": "relu", "post_fcnet_weights_initializer": null, "post_fcnet_weights_initializer_config": null, "post_fcnet_bias_initializer": null, "post_fcnet_bias_initializer_config": null, "free_log_std": false, "log_std_clip_param": 20.0, "no_final_linear": false, "vf_share_layers": false, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "lstm_weights_initializer": null, "lstm_weights_initializer_config": null, "lstm_bias_initializer": null, "lstm_bias_initializer_config": null, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "attention_use_n_prev_actions": 0, "attention_use_n_prev_rewards": 0, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": null, "custom_model_config": {}, "custom_action_dist": null, "custom_preprocessor": null, "encoder_latent_dim": null, "always_check_shapes": false, "lstm_use_prev_action_reward": -1, "_use_default_native_models": -1, "_disable_preprocessor_api": false, "_disable_action_flattening": false}, "_learner_connector": null, "add_default_connectors_to_learner_pipeline": true, "learner_config_dict": {}, "optimizer": {}, "_learner_class": null, "callbacks_on_algorithm_init": null, "callbacks_on_env_runners_recreated": null, "callbacks_on_offline_eval_runners_recreated": null, "callbacks_on_checkpoint_loaded": null, "callbacks_on_environment_created": null, "callbacks_on_episode_created": null, "callbacks_on_episode_start": null, "callbacks_on_episode_step": null, "callbacks_on_episode_end": null, "callbacks_on_evaluate_start": null, "callbacks_on_evaluate_end": null, "callbacks_on_evaluate_offline_start": null, "callbacks_on_evaluate_offline_end": null, "callbacks_on_sample_end": null, "callbacks_on_train_result": null, "explore": true, "enable_rl_module_and_learner": true, "enable_env_runner_and_connector_v2": true, "_prior_exploration_config": {"type": "StochasticSampling"}, "count_steps_by": "env_steps", "policy_map_capacity": 100, "policy_mapping_fn": "<function AlgorithmConfig.DEFAULT_POLICY_MAPPING_FN at 0x145c2d8a0>", "policies_to_train": null, "policy_states_are_swappable": false, "observation_fn": null, "offline_data_class": null, "input_read_method": "read_parquet", "input_read_method_kwargs": {}, "input_read_schema": {}, "input_read_episodes": false, "input_read_sample_batches": false, "input_read_batch_size": null, "input_filesystem": null, "input_filesystem_kwargs": {}, "input_compress_columns": ["obs", "new_obs"], "input_spaces_jsonable": true, "materialize_data": false, "materialize_mapped_data": true, "map_batches_kwargs": {}, "iter_batches_kwargs": {}, "ignore_final_observation": false, "prelearner_class": null, "prelearner_buffer_class": null, "prelearner_buffer_kwargs": {}, "prelearner_module_synch_period": 10, "dataset_num_iters_per_learner": null, "input_config": {}, "actions_in_input_normalized": false, "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_config": {}, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "output_max_rows_per_file": null, "output_write_remaining_data": false, "output_write_method": "write_parquet", "output_write_method_kwargs": {}, "output_filesystem": null, "output_filesystem_kwargs": {}, "output_write_episodes": true, "offline_sampling": false, "evaluation_interval": 1, "evaluation_duration": 20, "evaluation_duration_unit": "episodes", "evaluation_sample_timeout_s": 120.0, "evaluation_auto_duration_min_env_steps_per_sample": 100, "evaluation_auto_duration_max_env_steps_per_sample": 2000, "evaluation_parallel_to_training": false, "evaluation_force_reset_envs_before_iteration": true, "evaluation_config": null, "off_policy_estimation_methods": {}, "ope_split_batch_by_episode": true, "evaluation_num_env_runners": 1, "in_evaluation": false, "sync_filters_on_rollout_workers_timeout_s": 10.0, "offline_evaluation_interval": null, "num_offline_eval_runners": 0, "offline_loss_for_module_fn": null, "offline_evaluation_duration": 1, "offline_evaluation_parallel_to_training": false, "offline_evaluation_timeout_s": 120.0, "num_cpus_per_offline_eval_runner": 1, "num_gpus_per_offline_eval_runner": 0, "custom_resources_per_offline_eval_runner": {}, "restart_failed_offline_eval_runners": true, "ignore_offline_eval_runner_failures": false, "max_num_offline_eval_runner_restarts": 1000, "offline_eval_runner_restore_timeout_s": 1800.0, "max_requests_in_flight_per_offline_eval_runner": 1, "validate_offline_eval_runners_after_construction": true, "offline_eval_runner_health_probe_timeout_s": 30.0, "offline_eval_rl_module_inference_only": false, "broadcast_offline_eval_runner_states": false, "offline_eval_batch_size_per_runner": 256, "dataset_num_iters_per_eval_runner": 1, "keep_per_episode_custom_metrics": false, "metrics_episode_collection_timeout_s": 60.0, "metrics_num_episodes_for_smoothing": 100, "min_time_s_per_iteration": null, "min_train_timesteps_per_iteration": 0, "min_sample_timesteps_per_iteration": 0, "log_gradients": true, "export_native_model_files": false, "checkpoint_trainable_policies_only": false, "logger_creator": null, "logger_config": null, "log_level": "WARN", "log_sys_usage": true, "fake_sampler": false, "seed": 4, "restart_failed_env_runners": true, "ignore_env_runner_failures": false, "max_num_env_runner_restarts": 1000, "delay_between_env_runner_restarts_s": 60.0, "restart_failed_sub_environments": false, "num_consecutive_env_runner_failures_tolerance": 100, "env_runner_health_probe_timeout_s": 30.0, "env_runner_restore_timeout_s": 1800.0, "_model_config": {}, "_rl_module_spec": "RLModuleSpec(module_class=None, observation_space=None, action_space=None, inference_only=False, learner_only=False, model_config=DefaultModelConfig(fcnet_hiddens=[60, 90], fcnet_activation='tanh', fcnet_kernel_initializer=None, fcnet_kernel_initializer_kwargs=None, fcnet_bias_initializer=None, fcnet_bias_initializer_kwargs=None, conv_filters=None, conv_activation='relu', conv_kernel_initializer=None, conv_kernel_initializer_kwargs=None, conv_bias_initializer=None, conv_bias_initializer_kwargs=None, head_fcnet_hiddens=[], head_fcnet_activation='relu', head_fcnet_kernel_initializer=None, head_fcnet_kernel_initializer_kwargs=None, head_fcnet_bias_initializer=None, head_fcnet_bias_initializer_kwargs=None, free_log_std=False, log_std_clip_param=20.0, vf_share_layers=True, use_lstm=False, max_seq_len=20, lstm_cell_size=256, lstm_use_prev_action=False, lstm_use_prev_reward=False, lstm_kernel_initializer=None, lstm_kernel_initializer_kwargs=None, lstm_bias_initializer=None, lstm_bias_initializer_kwargs=None), catalog_class=None, load_state_path=None, model_config_dict=None)", "algorithm_config_overrides_per_module": {}, "_per_module_overrides": {}, "_validate_config": true, "_use_msgpack_checkpoints": false, "_torch_grad_scaler_class": null, "_torch_lr_scheduler_classes": null, "_tf_policy_handles_more_than_one_loss": false, "_disable_preprocessor_api": false, "_disable_action_flattening": false, "_disable_initialize_loss_from_dummy_batch": false, "_dont_auto_sync_env_runner_states": false, "env_task_fn": -1, "enable_connectors": -1, "simple_optimizer": false, "policy_map_cache": -1, "worker_cls": -1, "synchronize_filters": -1, "enable_async_evaluation": -1, "custom_async_evaluation_function": -1, "_enable_rl_module_api": -1, "auto_wrap_old_gym_envs": -1, "always_attach_evaluation_results": -1, "replay_sequence_length": null, "_disable_execution_plan_api": -1, "use_critic": true, "use_gae": true, "use_kl_loss": true, "kl_coeff": 0.7464963036515, "kl_target": 0.0270990929592, "vf_loss_coeff": 0.6688075857018, "entropy_coeff": 0.0090570820258, "clip_param": 0.1221781641624, "vf_clip_param": 0.1027808522125, "entropy_coeff_schedule": null, "lr_schedule": null, "sgd_minibatch_size": -1, "vf_share_layers": -1, "__stdout_file__": null, "__stderr_file__": null, "lambda": 0.9099046732075, "input": "sampler", "policies": {"default_policy": [null, null, null, null]}, "callbacks": "<class 'ray.rllib.callbacks.callbacks.RLlibCallback'>", "create_env_on_driver": false, "custom_eval_function": null, "framework": "torch"}, "time_since_restore": 18.990122318267822, "iterations_since_restore": 10, "perf": {"cpu_util_percent": 68.06, "ram_util_percent": 80.28}}
{"timers": {"training_iteration": 1.6022592323533889, "restore_env_runners": 9.623981463012012e-06, "training_step": 1.6021346300946366, "env_runner_sampling_timer": 1.4720083153570107, "learner_update_timer": 0.12704955857714167, "synch_weights": 0.0006420702937088472, "restore_eval_env_runners": 1.1502114316725148e-05, "evaluation_iteration": 0.1083946752250657, "synch_eval_env_connectors": 0.00012091858086054952, "synch_env_connectors": 4.740537447083779e-06}, "env_runners": {"num_episodes_lifetime": -277375.0, "episode_len_mean": 20.0, "env_to_module_connector": {"timers": {"connectors": {"batch_individual_items": 1.052441056155281e-05, "add_observations_from_episodes_to_batch": 4.894895690455974e-06, "add_states_from_episodes_to_batch": 2.1768116038891914e-06, "numpy_to_tensor": 1.9809308666498034e-05, "add_time_dim_to_batch_and_zero_pad": 1.5562054046930456e-05}}, "connector_pipeline_timer": 8.834512662220492e-05}, "agent_episode_returns_mean": {"default_agent": 8.980000000000004}, "episode_return_max": 12.5, "num_module_steps_sampled_lifetime": {"default_policy": -5547500.0}, "env_step_timer": 2.2300236239072937e-05, "module_to_env_connector": {"timers": {"connectors": {"listify_data_for_vector_env": 1.684034113590914e-05, "remove_single_ts_time_rank_from_batch": 1.0218107037792206e-06, "tensor_to_numpy": 9.139451203430639e-05, "un_batch_to_individual_items": 3.283396166021386e-05, "get_actions": 7.019831628577559e-05, "normalize_and_clip_actions": 7.476214711246727e-05}}, "connector_pipeline_timer": 0.0004707212271712974}, "module_episode_returns_mean": {"default_policy": 8.980000000000004}, "num_env_steps_sampled_lifetime": -5547500.0, "episode_len_min": 20, "episode_return_min": -7.5, "time_between_sampling": 0.012497253157076067, "num_env_steps_sampled": 5000.0, "num_module_steps_sampled": {"default_policy": 5000.0}, "num_episodes": 250.0, "episode_len_max": 20, "num_agent_steps_sampled": {"default_agent": 5000.0}, "episode_duration_sec_mean": 0.014144557843916114, "env_to_module_sum_episodes_length_in": 10.36823839457432, "num_agent_steps_sampled_lifetime": {"default_agent": -5547500.0}, "env_to_module_sum_episodes_length_out": 10.36823839457432, "rlmodule_inference_timer": 4.994319958552101e-05, "episode_return_mean": 8.980000000000004, "sample": 0.01328239251334302, "env_reset_timer": 8.7729574719003e-05, "weights_seq_no": 10.0, "num_env_steps_sampled_lifetime_throughput": 3070.1769795848954}, "learners": {"__all_modules__": {"num_non_trainable_parameters": 0, "learner_connector": {"timers": {"connectors": {"add_time_dim_to_batch_and_zero_pad": 1.004832442703844e-05, "batch_individual_items": 0.032468263272970706, "add_one_ts_to_episodes_and_truncate": 0.008507246203241248, "general_advantage_estimation": 0.007548546245081268, "numpy_to_tensor": 6.717232730558433e-05, "add_observations_from_episodes_to_batch": 0.0008103560198361839, "add_states_from_episodes_to_batch": 3.200062174587194e-06, "add_columns_from_episodes_to_train_batch": 0.03447999046087169}}, "connector_pipeline_timer": 0.08400799083155087}, "num_env_steps_trained_lifetime": 346500, "num_env_steps_trained": 31500, "num_module_steps_trained_lifetime": 66000, "num_module_steps_trained": 6000, "learner_connector_sum_episodes_length_out": 5250.0, "num_trainable_parameters": 6003, "learner_connector_sum_episodes_length_in": 5000.0, "num_env_steps_trained_lifetime_throughput": 2557372.4559102743, "num_module_steps_trained_throughput": 489464.73438142706, "num_module_steps_trained_lifetime_throughput": 488615.77081243554}, "default_policy": {"diff_num_grad_updates_vs_sampler_policy": 1.0, "vf_loss_unclipped": 28.64272689819336, "num_module_steps_trained": 6000, "total_loss": 0.05192509666085243, "num_trainable_parameters": 6003, "gradients_default_optimizer_global_norm": 0.041982702910900116, "weights_seq_no": 11.0, "mean_kl_loss": 0.0015682962257415056, "vf_explained_var": 0.019914567470550537, "vf_loss": 0.10181104391813278, "policy_loss": -0.011589430272579193, "default_optimizer_learning_rate": 0.0002847858517, "entropy": 0.5055301785469055, "num_module_steps_trained_lifetime": 66000, "curr_entropy_coeff": 0.0090570820258, "curr_kl_coeff": 0.0003645001561380923, "module_train_batch_size_mean": 1000.0, "num_module_steps_trained_lifetime_throughput": 490278.5232830449}}, "num_training_step_calls_per_iteration": 1, "evaluation": {"env_runners": {"num_agent_steps_sampled": {"default_agent": 400}, "num_env_steps_sampled_lifetime": 55400, "env_to_module_connector": {"timers": {"connectors": {"add_states_from_episodes_to_batch": 1.6352023236978312e-06, "batch_individual_items": 6.431450419012148e-06, "numpy_to_tensor": 8.549868481558344e-06, "add_observations_from_episodes_to_batch": 2.8769715746485657e-06, "add_time_dim_to_batch_and_zero_pad": 2.2678184211339336e-06}}, "connector_pipeline_timer": 4.364528990625613e-05}, "episode_return_min": -16.5, "num_episodes": 20, "num_episodes_lifetime": 220, "module_to_env_connector": {"timers": {"connectors": {"un_batch_to_individual_items": 5.4979376500532965e-06, "normalize_and_clip_actions": 1.0149350979003797e-05, "listify_data_for_vector_env": 1.1238091375664037e-05, "tensor_to_numpy": 1.3377449835907877e-05, "get_actions": 3.7066512905771925e-05, "remove_single_ts_time_rank_from_batch": 6.227649064581916e-07}}, "connector_pipeline_timer": 0.00010445380636283041}, "episode_len_mean": 20.0, "weights_seq_no": 11.0, "episode_return_max": 12.5, "num_agent_steps_sampled_lifetime": {"default_agent": 4400}, "episode_len_min": 20, "num_env_steps_sampled": 400, "episode_duration_sec_mean": 0.009372477509314194, "module_episode_returns_mean": {"default_policy": 1.15}, "episode_return_mean": 1.15, "env_reset_timer": 0.00016376535800830225, "env_step_timer": 1.4433194167442267e-05, "num_module_steps_sampled": {"default_policy": 400}, "agent_episode_returns_mean": {"default_agent": 1.15}, "episode_len_max": 20, "env_to_module_sum_episodes_length_in": 10.368238394574323, "num_module_steps_sampled_lifetime": {"default_policy": 4400}, "env_to_module_sum_episodes_length_out": 10.368238394574323, "rlmodule_inference_timer": 2.84652457869263e-05, "sample": 0.10210087520800784, "time_between_sampling": 1.5986566396417077}, "num_healthy_workers": 1, "actor_manager_num_outstanding_async_reqs": 0, "num_remote_worker_restarts": 0}, "num_env_steps_sampled_lifetime": -5547500.0, "fault_tolerance": {"num_healthy_workers": 0, "num_remote_worker_restarts": 0}, "env_runner_group": {"actor_manager_num_outstanding_async_reqs": 0}, "done": false, "training_iteration": 11, "trial_id": "49be2_00000", "date": "2025-08-11_19-36-32", "timestamp": 1754933792, "time_this_iter_s": 4.4224183559417725, "time_total_s": 23.412540674209595, "pid": 28164, "hostname": "Mac", "node_ip": "127.0.0.1", "config": {"exploration_config": {}, "extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "placement_strategy": "PACK", "num_gpus": 0, "_fake_gpus": false, "num_cpus_for_main_process": 2, "eager_tracing": true, "eager_max_retraces": 20, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "torch_compile_learner": false, "torch_compile_learner_what_to_compile": "forward_train", "torch_compile_learner_dynamo_backend": "aot_eager", "torch_compile_learner_dynamo_mode": null, "torch_compile_worker": false, "torch_compile_worker_dynamo_backend": "aot_eager", "torch_compile_worker_dynamo_mode": null, "torch_ddp_kwargs": {}, "torch_skip_nan_gradients": false, "env": "Umbrella", "env_config": {}, "observation_space": null, "action_space": null, "clip_rewards": null, "normalize_actions": true, "clip_actions": false, "_is_atari": null, "disable_env_checking": false, "render_env": false, "action_mask_key": "action_mask", "env_runner_cls": null, "num_env_runners": 0, "create_local_env_runner": true, "num_envs_per_env_runner": 1, "gym_env_vectorize_mode": "SYNC", "num_cpus_per_env_runner": 1, "num_gpus_per_env_runner": 0, "custom_resources_per_env_runner": {}, "validate_env_runners_after_construction": true, "episodes_to_numpy": true, "max_requests_in_flight_per_env_runner": 1, "sample_timeout_s": 60.0, "_env_to_module_connector": null, "add_default_connectors_to_env_to_module_pipeline": true, "_module_to_env_connector": null, "add_default_connectors_to_module_to_env_pipeline": true, "merge_env_runner_states": "training_only", "broadcast_env_runner_states": true, "episode_lookback_horizon": 1, "rollout_fragment_length": "auto", "batch_mode": "complete_episodes", "compress_observations": false, "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "enable_tf1_exec_eagerly": false, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "preprocessor_pref": "deepmind", "observation_filter": "NoFilter", "update_worker_filter_stats": true, "use_worker_filter_stats": true, "sampler_perf_stats_ema_coef": null, "_is_online": true, "num_learners": 0, "num_gpus_per_learner": 0, "num_cpus_per_learner": "auto", "num_aggregator_actors_per_learner": 0, "max_requests_in_flight_per_aggregator_actor": 3, "local_gpu_idx": 0, "max_requests_in_flight_per_learner": 3, "gamma": 1, "lr": 0.0002847858517, "grad_clip": 0.5, "grad_clip_by": "global_norm", "_train_batch_size_per_learner": 5000, "train_batch_size": 4000, "num_epochs": 1, "minibatch_size": 1000, "shuffle_batch_per_epoch": true, "model": {"fcnet_hiddens": [256, 256], "fcnet_activation": "tanh", "fcnet_weights_initializer": null, "fcnet_weights_initializer_config": null, "fcnet_bias_initializer": null, "fcnet_bias_initializer_config": null, "conv_filters": null, "conv_activation": "relu", "conv_kernel_initializer": null, "conv_kernel_initializer_config": null, "conv_bias_initializer": null, "conv_bias_initializer_config": null, "conv_transpose_kernel_initializer": null, "conv_transpose_kernel_initializer_config": null, "conv_transpose_bias_initializer": null, "conv_transpose_bias_initializer_config": null, "post_fcnet_hiddens": [], "post_fcnet_activation": "relu", "post_fcnet_weights_initializer": null, "post_fcnet_weights_initializer_config": null, "post_fcnet_bias_initializer": null, "post_fcnet_bias_initializer_config": null, "free_log_std": false, "log_std_clip_param": 20.0, "no_final_linear": false, "vf_share_layers": false, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "lstm_weights_initializer": null, "lstm_weights_initializer_config": null, "lstm_bias_initializer": null, "lstm_bias_initializer_config": null, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "attention_use_n_prev_actions": 0, "attention_use_n_prev_rewards": 0, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": null, "custom_model_config": {}, "custom_action_dist": null, "custom_preprocessor": null, "encoder_latent_dim": null, "always_check_shapes": false, "lstm_use_prev_action_reward": -1, "_use_default_native_models": -1, "_disable_preprocessor_api": false, "_disable_action_flattening": false}, "_learner_connector": null, "add_default_connectors_to_learner_pipeline": true, "learner_config_dict": {}, "optimizer": {}, "_learner_class": null, "callbacks_on_algorithm_init": null, "callbacks_on_env_runners_recreated": null, "callbacks_on_offline_eval_runners_recreated": null, "callbacks_on_checkpoint_loaded": null, "callbacks_on_environment_created": null, "callbacks_on_episode_created": null, "callbacks_on_episode_start": null, "callbacks_on_episode_step": null, "callbacks_on_episode_end": null, "callbacks_on_evaluate_start": null, "callbacks_on_evaluate_end": null, "callbacks_on_evaluate_offline_start": null, "callbacks_on_evaluate_offline_end": null, "callbacks_on_sample_end": null, "callbacks_on_train_result": null, "explore": true, "enable_rl_module_and_learner": true, "enable_env_runner_and_connector_v2": true, "_prior_exploration_config": {"type": "StochasticSampling"}, "count_steps_by": "env_steps", "policy_map_capacity": 100, "policy_mapping_fn": "<function AlgorithmConfig.DEFAULT_POLICY_MAPPING_FN at 0x145c2d8a0>", "policies_to_train": null, "policy_states_are_swappable": false, "observation_fn": null, "offline_data_class": null, "input_read_method": "read_parquet", "input_read_method_kwargs": {}, "input_read_schema": {}, "input_read_episodes": false, "input_read_sample_batches": false, "input_read_batch_size": null, "input_filesystem": null, "input_filesystem_kwargs": {}, "input_compress_columns": ["obs", "new_obs"], "input_spaces_jsonable": true, "materialize_data": false, "materialize_mapped_data": true, "map_batches_kwargs": {}, "iter_batches_kwargs": {}, "ignore_final_observation": false, "prelearner_class": null, "prelearner_buffer_class": null, "prelearner_buffer_kwargs": {}, "prelearner_module_synch_period": 10, "dataset_num_iters_per_learner": null, "input_config": {}, "actions_in_input_normalized": false, "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_config": {}, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "output_max_rows_per_file": null, "output_write_remaining_data": false, "output_write_method": "write_parquet", "output_write_method_kwargs": {}, "output_filesystem": null, "output_filesystem_kwargs": {}, "output_write_episodes": true, "offline_sampling": false, "evaluation_interval": 1, "evaluation_duration": 20, "evaluation_duration_unit": "episodes", "evaluation_sample_timeout_s": 120.0, "evaluation_auto_duration_min_env_steps_per_sample": 100, "evaluation_auto_duration_max_env_steps_per_sample": 2000, "evaluation_parallel_to_training": false, "evaluation_force_reset_envs_before_iteration": true, "evaluation_config": null, "off_policy_estimation_methods": {}, "ope_split_batch_by_episode": true, "evaluation_num_env_runners": 1, "in_evaluation": false, "sync_filters_on_rollout_workers_timeout_s": 10.0, "offline_evaluation_interval": null, "num_offline_eval_runners": 0, "offline_loss_for_module_fn": null, "offline_evaluation_duration": 1, "offline_evaluation_parallel_to_training": false, "offline_evaluation_timeout_s": 120.0, "num_cpus_per_offline_eval_runner": 1, "num_gpus_per_offline_eval_runner": 0, "custom_resources_per_offline_eval_runner": {}, "restart_failed_offline_eval_runners": true, "ignore_offline_eval_runner_failures": false, "max_num_offline_eval_runner_restarts": 1000, "offline_eval_runner_restore_timeout_s": 1800.0, "max_requests_in_flight_per_offline_eval_runner": 1, "validate_offline_eval_runners_after_construction": true, "offline_eval_runner_health_probe_timeout_s": 30.0, "offline_eval_rl_module_inference_only": false, "broadcast_offline_eval_runner_states": false, "offline_eval_batch_size_per_runner": 256, "dataset_num_iters_per_eval_runner": 1, "keep_per_episode_custom_metrics": false, "metrics_episode_collection_timeout_s": 60.0, "metrics_num_episodes_for_smoothing": 100, "min_time_s_per_iteration": null, "min_train_timesteps_per_iteration": 0, "min_sample_timesteps_per_iteration": 0, "log_gradients": true, "export_native_model_files": false, "checkpoint_trainable_policies_only": false, "logger_creator": null, "logger_config": null, "log_level": "WARN", "log_sys_usage": true, "fake_sampler": false, "seed": 4, "restart_failed_env_runners": true, "ignore_env_runner_failures": false, "max_num_env_runner_restarts": 1000, "delay_between_env_runner_restarts_s": 60.0, "restart_failed_sub_environments": false, "num_consecutive_env_runner_failures_tolerance": 100, "env_runner_health_probe_timeout_s": 30.0, "env_runner_restore_timeout_s": 1800.0, "_model_config": {}, "_rl_module_spec": "RLModuleSpec(module_class=None, observation_space=None, action_space=None, inference_only=False, learner_only=False, model_config=DefaultModelConfig(fcnet_hiddens=[60, 90], fcnet_activation='tanh', fcnet_kernel_initializer=None, fcnet_kernel_initializer_kwargs=None, fcnet_bias_initializer=None, fcnet_bias_initializer_kwargs=None, conv_filters=None, conv_activation='relu', conv_kernel_initializer=None, conv_kernel_initializer_kwargs=None, conv_bias_initializer=None, conv_bias_initializer_kwargs=None, head_fcnet_hiddens=[], head_fcnet_activation='relu', head_fcnet_kernel_initializer=None, head_fcnet_kernel_initializer_kwargs=None, head_fcnet_bias_initializer=None, head_fcnet_bias_initializer_kwargs=None, free_log_std=False, log_std_clip_param=20.0, vf_share_layers=True, use_lstm=False, max_seq_len=20, lstm_cell_size=256, lstm_use_prev_action=False, lstm_use_prev_reward=False, lstm_kernel_initializer=None, lstm_kernel_initializer_kwargs=None, lstm_bias_initializer=None, lstm_bias_initializer_kwargs=None), catalog_class=None, load_state_path=None, model_config_dict=None)", "algorithm_config_overrides_per_module": {}, "_per_module_overrides": {}, "_validate_config": true, "_use_msgpack_checkpoints": false, "_torch_grad_scaler_class": null, "_torch_lr_scheduler_classes": null, "_tf_policy_handles_more_than_one_loss": false, "_disable_preprocessor_api": false, "_disable_action_flattening": false, "_disable_initialize_loss_from_dummy_batch": false, "_dont_auto_sync_env_runner_states": false, "env_task_fn": -1, "enable_connectors": -1, "simple_optimizer": false, "policy_map_cache": -1, "worker_cls": -1, "synchronize_filters": -1, "enable_async_evaluation": -1, "custom_async_evaluation_function": -1, "_enable_rl_module_api": -1, "auto_wrap_old_gym_envs": -1, "always_attach_evaluation_results": -1, "replay_sequence_length": null, "_disable_execution_plan_api": -1, "use_critic": true, "use_gae": true, "use_kl_loss": true, "kl_coeff": 0.7464963036515, "kl_target": 0.0270990929592, "vf_loss_coeff": 0.6688075857018, "entropy_coeff": 0.0090570820258, "clip_param": 0.1221781641624, "vf_clip_param": 0.1027808522125, "entropy_coeff_schedule": null, "lr_schedule": null, "sgd_minibatch_size": -1, "vf_share_layers": -1, "__stdout_file__": null, "__stderr_file__": null, "lambda": 0.9099046732075, "input": "sampler", "policies": {"default_policy": [null, null, null, null]}, "callbacks": "<class 'ray.rllib.callbacks.callbacks.RLlibCallback'>", "create_env_on_driver": false, "custom_eval_function": null, "framework": "torch"}, "time_since_restore": 23.412540674209595, "iterations_since_restore": 11, "perf": {"cpu_util_percent": 85.61666666666667, "ram_util_percent": 82.18333333333332}}
{"timers": {"training_iteration": 1.6138549971103555, "restore_env_runners": 9.664412072053496e-06, "training_step": 1.6137292792136004, "env_runner_sampling_timer": 1.483211575953623, "learner_update_timer": 0.12738814466038234, "synch_weights": 0.0006609291709215584, "restore_eval_env_runners": 1.1900423042694111e-05, "evaluation_iteration": 0.10839369055248718, "synch_eval_env_connectors": 0.00012112231500727212, "synch_env_connectors": 4.812711562887132e-06}, "env_runners": {"num_episodes_lifetime": -308250.0, "episode_len_mean": 20.0, "env_to_module_connector": {"timers": {"connectors": {"batch_individual_items": 8.359998135174995e-06, "add_observations_from_episodes_to_batch": 3.696447050549231e-06, "add_states_from_episodes_to_batch": 2.0794776161044183e-06, "numpy_to_tensor": 1.1824338553086031e-05, "add_time_dim_to_batch_and_zero_pad": 2.8792563934712495e-06}}, "connector_pipeline_timer": 8.570093084515227e-05}, "agent_episode_returns_mean": {"default_agent": 9.700000000000003}, "episode_return_max": 12.5, "num_module_steps_sampled_lifetime": {"default_policy": -6165000.0}, "env_step_timer": 2.0462166634635044e-05, "module_to_env_connector": {"timers": {"connectors": {"listify_data_for_vector_env": 1.4634965751587661e-05, "remove_single_ts_time_rank_from_batch": 7.021989168542729e-07, "tensor_to_numpy": 1.8570024284085786e-05, "un_batch_to_individual_items": 6.7068383110630155e-06, "get_actions": 0.00011302930540272829, "normalize_and_clip_actions": 1.3885304697539291e-05}}, "connector_pipeline_timer": 0.0002001893958099822}, "module_episode_returns_mean": {"default_policy": 9.700000000000003}, "num_env_steps_sampled_lifetime": -6165000.0, "episode_len_min": 20, "episode_return_min": -7.5, "time_between_sampling": 0.0032581024493306163, "num_env_steps_sampled": 5000.0, "num_module_steps_sampled": {"default_policy": 5000.0}, "num_episodes": 250.0, "episode_len_max": 20, "num_agent_steps_sampled": {"default_agent": 5000.0}, "episode_duration_sec_mean": 0.00832547955354676, "env_to_module_sum_episodes_length_in": 10.36823839457432, "num_agent_steps_sampled_lifetime": {"default_agent": -6165000.0}, "env_to_module_sum_episodes_length_out": 10.36823839457432, "rlmodule_inference_timer": 5.5196616967382556e-05, "episode_return_mean": 9.700000000000003, "sample": 0.007774191291498087, "env_reset_timer": 5.216647525438982e-05, "weights_seq_no": 11.0, "num_env_steps_sampled_lifetime_throughput": 3319.9553258152646}, "learners": {"__all_modules__": {"num_non_trainable_parameters": 0, "learner_connector": {"timers": {"connectors": {"add_time_dim_to_batch_and_zero_pad": 1.1879921086549471e-05, "batch_individual_items": 0.03257855939007686, "add_one_ts_to_episodes_and_truncate": 0.008534453321416377, "general_advantage_estimation": 0.007549433282673818, "numpy_to_tensor": 6.740685423928209e-05, "add_observations_from_episodes_to_batch": 0.0008282645401265486, "add_states_from_episodes_to_batch": 3.2047312150635883e-06, "add_columns_from_episodes_to_train_batch": 0.03470900139698701}}, "connector_pipeline_timer": 0.0843957438336073}, "num_env_steps_trained_lifetime": 378000, "num_env_steps_trained": 31500, "num_module_steps_trained_lifetime": 72000, "num_module_steps_trained": 6000, "learner_connector_sum_episodes_length_out": 5250.0, "num_trainable_parameters": 6003, "learner_connector_sum_episodes_length_in": 5000.0, "num_env_steps_trained_lifetime_throughput": 2510208.312278595, "num_module_steps_trained_throughput": 480373.25166007783, "num_module_steps_trained_lifetime_throughput": 479559.58021606837}, "default_policy": {"diff_num_grad_updates_vs_sampler_policy": 1.0, "vf_loss_unclipped": 28.63893699645996, "num_module_steps_trained": 6000, "total_loss": 0.03486289083957672, "num_trainable_parameters": 6003, "gradients_default_optimizer_global_norm": 0.05857674777507782, "weights_seq_no": 12.0, "mean_kl_loss": 0.00028911055414937437, "vf_explained_var": 0.01924508810043335, "vf_loss": 0.1020260602235794, "policy_loss": -0.02900618687272072, "default_optimizer_learning_rate": 0.0002847858517, "entropy": 0.4821460247039795, "num_module_steps_trained_lifetime": 72000, "curr_entropy_coeff": 0.0090570820258, "curr_kl_coeff": 0.00018225007806904614, "module_train_batch_size_mean": 1000.0, "num_module_steps_trained_lifetime_throughput": 481108.40644690854}}, "num_training_step_calls_per_iteration": 1, "evaluation": {"env_runners": {"num_agent_steps_sampled": {"default_agent": 400}, "num_env_steps_sampled_lifetime": 60400, "env_to_module_connector": {"timers": {"connectors": {"add_states_from_episodes_to_batch": 1.8613936312792822e-06, "batch_individual_items": 8.564478924666665e-06, "numpy_to_tensor": 1.317603792538863e-05, "add_observations_from_episodes_to_batch": 4.072206236538945e-06, "add_time_dim_to_batch_and_zero_pad": 3.331026410974616e-06}}, "connector_pipeline_timer": 5.881102890948744e-05}, "episode_return_min": -16.5, "num_episodes": 20, "num_episodes_lifetime": 240, "module_to_env_connector": {"timers": {"connectors": {"un_batch_to_individual_items": 6.9400822452285665e-06, "normalize_and_clip_actions": 1.1633017290690474e-05, "listify_data_for_vector_env": 1.43836938389095e-05, "tensor_to_numpy": 1.698929690294591e-05, "get_actions": 5.392928346877762e-05, "remove_single_ts_time_rank_from_batch": 7.30117596926725e-07}}, "connector_pipeline_timer": 0.00013887608525211062}, "episode_len_mean": 20.0, "weights_seq_no": 12.0, "episode_return_max": 12.5, "num_agent_steps_sampled_lifetime": {"default_agent": 4800}, "episode_len_min": 20, "num_env_steps_sampled": 400, "episode_duration_sec_mean": 0.009701425433158875, "module_episode_returns_mean": {"default_policy": 1.95}, "episode_return_mean": 1.95, "env_reset_timer": 0.0001659539535862291, "env_step_timer": 1.9553463197757775e-05, "num_module_steps_sampled": {"default_policy": 400}, "agent_episode_returns_mean": {"default_agent": 1.95}, "episode_len_max": 20, "env_to_module_sum_episodes_length_in": 10.368238394574323, "num_module_steps_sampled_lifetime": {"default_policy": 4800}, "env_to_module_sum_episodes_length_out": 10.368238394574323, "rlmodule_inference_timer": 4.2226409241047414e-05, "sample": 0.10239366104646054, "time_between_sampling": 1.6105918136649875}, "num_healthy_workers": 1, "actor_manager_num_outstanding_async_reqs": 0, "num_remote_worker_restarts": 0}, "num_env_steps_sampled_lifetime": -6165000.0, "fault_tolerance": {"num_healthy_workers": 0, "num_remote_worker_restarts": 0}, "env_runner_group": {"actor_manager_num_outstanding_async_reqs": 0}, "done": false, "training_iteration": 12, "trial_id": "49be2_00000", "date": "2025-08-11_19-36-35", "timestamp": 1754933795, "time_this_iter_s": 2.909234046936035, "time_total_s": 26.32177472114563, "pid": 28164, "hostname": "Mac", "node_ip": "127.0.0.1", "config": {"exploration_config": {}, "extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "placement_strategy": "PACK", "num_gpus": 0, "_fake_gpus": false, "num_cpus_for_main_process": 2, "eager_tracing": true, "eager_max_retraces": 20, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "torch_compile_learner": false, "torch_compile_learner_what_to_compile": "forward_train", "torch_compile_learner_dynamo_backend": "aot_eager", "torch_compile_learner_dynamo_mode": null, "torch_compile_worker": false, "torch_compile_worker_dynamo_backend": "aot_eager", "torch_compile_worker_dynamo_mode": null, "torch_ddp_kwargs": {}, "torch_skip_nan_gradients": false, "env": "Umbrella", "env_config": {}, "observation_space": null, "action_space": null, "clip_rewards": null, "normalize_actions": true, "clip_actions": false, "_is_atari": null, "disable_env_checking": false, "render_env": false, "action_mask_key": "action_mask", "env_runner_cls": null, "num_env_runners": 0, "create_local_env_runner": true, "num_envs_per_env_runner": 1, "gym_env_vectorize_mode": "SYNC", "num_cpus_per_env_runner": 1, "num_gpus_per_env_runner": 0, "custom_resources_per_env_runner": {}, "validate_env_runners_after_construction": true, "episodes_to_numpy": true, "max_requests_in_flight_per_env_runner": 1, "sample_timeout_s": 60.0, "_env_to_module_connector": null, "add_default_connectors_to_env_to_module_pipeline": true, "_module_to_env_connector": null, "add_default_connectors_to_module_to_env_pipeline": true, "merge_env_runner_states": "training_only", "broadcast_env_runner_states": true, "episode_lookback_horizon": 1, "rollout_fragment_length": "auto", "batch_mode": "complete_episodes", "compress_observations": false, "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "enable_tf1_exec_eagerly": false, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "preprocessor_pref": "deepmind", "observation_filter": "NoFilter", "update_worker_filter_stats": true, "use_worker_filter_stats": true, "sampler_perf_stats_ema_coef": null, "_is_online": true, "num_learners": 0, "num_gpus_per_learner": 0, "num_cpus_per_learner": "auto", "num_aggregator_actors_per_learner": 0, "max_requests_in_flight_per_aggregator_actor": 3, "local_gpu_idx": 0, "max_requests_in_flight_per_learner": 3, "gamma": 1, "lr": 0.0002847858517, "grad_clip": 0.5, "grad_clip_by": "global_norm", "_train_batch_size_per_learner": 5000, "train_batch_size": 4000, "num_epochs": 1, "minibatch_size": 1000, "shuffle_batch_per_epoch": true, "model": {"fcnet_hiddens": [256, 256], "fcnet_activation": "tanh", "fcnet_weights_initializer": null, "fcnet_weights_initializer_config": null, "fcnet_bias_initializer": null, "fcnet_bias_initializer_config": null, "conv_filters": null, "conv_activation": "relu", "conv_kernel_initializer": null, "conv_kernel_initializer_config": null, "conv_bias_initializer": null, "conv_bias_initializer_config": null, "conv_transpose_kernel_initializer": null, "conv_transpose_kernel_initializer_config": null, "conv_transpose_bias_initializer": null, "conv_transpose_bias_initializer_config": null, "post_fcnet_hiddens": [], "post_fcnet_activation": "relu", "post_fcnet_weights_initializer": null, "post_fcnet_weights_initializer_config": null, "post_fcnet_bias_initializer": null, "post_fcnet_bias_initializer_config": null, "free_log_std": false, "log_std_clip_param": 20.0, "no_final_linear": false, "vf_share_layers": false, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "lstm_weights_initializer": null, "lstm_weights_initializer_config": null, "lstm_bias_initializer": null, "lstm_bias_initializer_config": null, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "attention_use_n_prev_actions": 0, "attention_use_n_prev_rewards": 0, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": null, "custom_model_config": {}, "custom_action_dist": null, "custom_preprocessor": null, "encoder_latent_dim": null, "always_check_shapes": false, "lstm_use_prev_action_reward": -1, "_use_default_native_models": -1, "_disable_preprocessor_api": false, "_disable_action_flattening": false}, "_learner_connector": null, "add_default_connectors_to_learner_pipeline": true, "learner_config_dict": {}, "optimizer": {}, "_learner_class": null, "callbacks_on_algorithm_init": null, "callbacks_on_env_runners_recreated": null, "callbacks_on_offline_eval_runners_recreated": null, "callbacks_on_checkpoint_loaded": null, "callbacks_on_environment_created": null, "callbacks_on_episode_created": null, "callbacks_on_episode_start": null, "callbacks_on_episode_step": null, "callbacks_on_episode_end": null, "callbacks_on_evaluate_start": null, "callbacks_on_evaluate_end": null, "callbacks_on_evaluate_offline_start": null, "callbacks_on_evaluate_offline_end": null, "callbacks_on_sample_end": null, "callbacks_on_train_result": null, "explore": true, "enable_rl_module_and_learner": true, "enable_env_runner_and_connector_v2": true, "_prior_exploration_config": {"type": "StochasticSampling"}, "count_steps_by": "env_steps", "policy_map_capacity": 100, "policy_mapping_fn": "<function AlgorithmConfig.DEFAULT_POLICY_MAPPING_FN at 0x145c2d8a0>", "policies_to_train": null, "policy_states_are_swappable": false, "observation_fn": null, "offline_data_class": null, "input_read_method": "read_parquet", "input_read_method_kwargs": {}, "input_read_schema": {}, "input_read_episodes": false, "input_read_sample_batches": false, "input_read_batch_size": null, "input_filesystem": null, "input_filesystem_kwargs": {}, "input_compress_columns": ["obs", "new_obs"], "input_spaces_jsonable": true, "materialize_data": false, "materialize_mapped_data": true, "map_batches_kwargs": {}, "iter_batches_kwargs": {}, "ignore_final_observation": false, "prelearner_class": null, "prelearner_buffer_class": null, "prelearner_buffer_kwargs": {}, "prelearner_module_synch_period": 10, "dataset_num_iters_per_learner": null, "input_config": {}, "actions_in_input_normalized": false, "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_config": {}, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "output_max_rows_per_file": null, "output_write_remaining_data": false, "output_write_method": "write_parquet", "output_write_method_kwargs": {}, "output_filesystem": null, "output_filesystem_kwargs": {}, "output_write_episodes": true, "offline_sampling": false, "evaluation_interval": 1, "evaluation_duration": 20, "evaluation_duration_unit": "episodes", "evaluation_sample_timeout_s": 120.0, "evaluation_auto_duration_min_env_steps_per_sample": 100, "evaluation_auto_duration_max_env_steps_per_sample": 2000, "evaluation_parallel_to_training": false, "evaluation_force_reset_envs_before_iteration": true, "evaluation_config": null, "off_policy_estimation_methods": {}, "ope_split_batch_by_episode": true, "evaluation_num_env_runners": 1, "in_evaluation": false, "sync_filters_on_rollout_workers_timeout_s": 10.0, "offline_evaluation_interval": null, "num_offline_eval_runners": 0, "offline_loss_for_module_fn": null, "offline_evaluation_duration": 1, "offline_evaluation_parallel_to_training": false, "offline_evaluation_timeout_s": 120.0, "num_cpus_per_offline_eval_runner": 1, "num_gpus_per_offline_eval_runner": 0, "custom_resources_per_offline_eval_runner": {}, "restart_failed_offline_eval_runners": true, "ignore_offline_eval_runner_failures": false, "max_num_offline_eval_runner_restarts": 1000, "offline_eval_runner_restore_timeout_s": 1800.0, "max_requests_in_flight_per_offline_eval_runner": 1, "validate_offline_eval_runners_after_construction": true, "offline_eval_runner_health_probe_timeout_s": 30.0, "offline_eval_rl_module_inference_only": false, "broadcast_offline_eval_runner_states": false, "offline_eval_batch_size_per_runner": 256, "dataset_num_iters_per_eval_runner": 1, "keep_per_episode_custom_metrics": false, "metrics_episode_collection_timeout_s": 60.0, "metrics_num_episodes_for_smoothing": 100, "min_time_s_per_iteration": null, "min_train_timesteps_per_iteration": 0, "min_sample_timesteps_per_iteration": 0, "log_gradients": true, "export_native_model_files": false, "checkpoint_trainable_policies_only": false, "logger_creator": null, "logger_config": null, "log_level": "WARN", "log_sys_usage": true, "fake_sampler": false, "seed": 4, "restart_failed_env_runners": true, "ignore_env_runner_failures": false, "max_num_env_runner_restarts": 1000, "delay_between_env_runner_restarts_s": 60.0, "restart_failed_sub_environments": false, "num_consecutive_env_runner_failures_tolerance": 100, "env_runner_health_probe_timeout_s": 30.0, "env_runner_restore_timeout_s": 1800.0, "_model_config": {}, "_rl_module_spec": "RLModuleSpec(module_class=None, observation_space=None, action_space=None, inference_only=False, learner_only=False, model_config=DefaultModelConfig(fcnet_hiddens=[60, 90], fcnet_activation='tanh', fcnet_kernel_initializer=None, fcnet_kernel_initializer_kwargs=None, fcnet_bias_initializer=None, fcnet_bias_initializer_kwargs=None, conv_filters=None, conv_activation='relu', conv_kernel_initializer=None, conv_kernel_initializer_kwargs=None, conv_bias_initializer=None, conv_bias_initializer_kwargs=None, head_fcnet_hiddens=[], head_fcnet_activation='relu', head_fcnet_kernel_initializer=None, head_fcnet_kernel_initializer_kwargs=None, head_fcnet_bias_initializer=None, head_fcnet_bias_initializer_kwargs=None, free_log_std=False, log_std_clip_param=20.0, vf_share_layers=True, use_lstm=False, max_seq_len=20, lstm_cell_size=256, lstm_use_prev_action=False, lstm_use_prev_reward=False, lstm_kernel_initializer=None, lstm_kernel_initializer_kwargs=None, lstm_bias_initializer=None, lstm_bias_initializer_kwargs=None), catalog_class=None, load_state_path=None, model_config_dict=None)", "algorithm_config_overrides_per_module": {}, "_per_module_overrides": {}, "_validate_config": true, "_use_msgpack_checkpoints": false, "_torch_grad_scaler_class": null, "_torch_lr_scheduler_classes": null, "_tf_policy_handles_more_than_one_loss": false, "_disable_preprocessor_api": false, "_disable_action_flattening": false, "_disable_initialize_loss_from_dummy_batch": false, "_dont_auto_sync_env_runner_states": false, "env_task_fn": -1, "enable_connectors": -1, "simple_optimizer": false, "policy_map_cache": -1, "worker_cls": -1, "synchronize_filters": -1, "enable_async_evaluation": -1, "custom_async_evaluation_function": -1, "_enable_rl_module_api": -1, "auto_wrap_old_gym_envs": -1, "always_attach_evaluation_results": -1, "replay_sequence_length": null, "_disable_execution_plan_api": -1, "use_critic": true, "use_gae": true, "use_kl_loss": true, "kl_coeff": 0.7464963036515, "kl_target": 0.0270990929592, "vf_loss_coeff": 0.6688075857018, "entropy_coeff": 0.0090570820258, "clip_param": 0.1221781641624, "vf_clip_param": 0.1027808522125, "entropy_coeff_schedule": null, "lr_schedule": null, "sgd_minibatch_size": -1, "vf_share_layers": -1, "__stdout_file__": null, "__stderr_file__": null, "lambda": 0.9099046732075, "input": "sampler", "policies": {"default_policy": [null, null, null, null]}, "callbacks": "<class 'ray.rllib.callbacks.callbacks.RLlibCallback'>", "create_env_on_driver": false, "custom_eval_function": null, "framework": "torch"}, "time_since_restore": 26.32177472114563, "iterations_since_restore": 12, "perf": {"cpu_util_percent": 72.275, "ram_util_percent": 78.225}}
{"timers": {"training_iteration": 1.6187792933893856, "restore_env_runners": 9.746106911146078e-06, "training_step": 1.618652815581734, "env_runner_sampling_timer": 1.4884972576940751, "learner_update_timer": 0.12702643612337175, "synch_weights": 0.0006597623793267837, "restore_eval_env_runners": 1.2307248194507943e-05, "evaluation_iteration": 0.1087533636473864, "synch_eval_env_connectors": 0.00012137525201642964, "synch_env_connectors": 4.891253630631712e-06}, "env_runners": {"num_episodes_lifetime": -339125.0, "episode_len_mean": 20.0, "env_to_module_connector": {"timers": {"connectors": {"batch_individual_items": 8.220437762023889e-06, "add_observations_from_episodes_to_batch": 3.6309832081924596e-06, "add_states_from_episodes_to_batch": 2.0441164651365357e-06, "numpy_to_tensor": 1.1677943233896368e-05, "add_time_dim_to_batch_and_zero_pad": 3.0585437221193084e-06}}, "connector_pipeline_timer": 5.48859907815499e-05}, "agent_episode_returns_mean": {"default_agent": 9.700000000000003}, "episode_return_max": 12.5, "num_module_steps_sampled_lifetime": {"default_policy": -6782500.0}, "env_step_timer": 2.0080321138978038e-05, "module_to_env_connector": {"timers": {"connectors": {"listify_data_for_vector_env": 1.5286049349738274e-05, "remove_single_ts_time_rank_from_batch": 8.720306163149324e-07, "tensor_to_numpy": 1.747765236820719e-05, "un_batch_to_individual_items": 6.6719999961263996e-06, "get_actions": 5.5747791810099563e-05, "normalize_and_clip_actions": 1.219773259230408e-05}}, "connector_pipeline_timer": 0.0001399873873684489}, "module_episode_returns_mean": {"default_policy": 9.700000000000003}, "num_env_steps_sampled_lifetime": -6782500.0, "episode_len_min": 20, "episode_return_min": -7.5, "time_between_sampling": 0.0027528504152075067, "num_env_steps_sampled": 5000.0, "num_module_steps_sampled": {"default_policy": 5000.0}, "num_episodes": 250.0, "episode_len_max": 20, "num_agent_steps_sampled": {"default_agent": 5000.0}, "episode_duration_sec_mean": 0.00605351200373843, "env_to_module_sum_episodes_length_in": 10.36823839457432, "num_agent_steps_sampled_lifetime": {"default_agent": -6782500.0}, "env_to_module_sum_episodes_length_out": 10.36823839457432, "rlmodule_inference_timer": 3.859832745716522e-05, "episode_return_mean": 9.700000000000003, "sample": 0.008551251808894296, "env_reset_timer": 6.124132730827471e-05, "weights_seq_no": 12.0, "num_env_steps_sampled_lifetime_throughput": 2931.5849927666172}, "learners": {"__all_modules__": {"num_non_trainable_parameters": 0, "learner_connector": {"timers": {"connectors": {"add_time_dim_to_batch_and_zero_pad": 1.1842791880558443e-05, "batch_individual_items": 0.03255325420523576, "add_one_ts_to_episodes_and_truncate": 0.00852482962787028, "general_advantage_estimation": 0.007527108949584372, "numpy_to_tensor": 6.733819542897773e-05, "add_observations_from_episodes_to_batch": 0.0008282573046528749, "add_states_from_episodes_to_batch": 3.1989332296784896e-06, "add_columns_from_episodes_to_train_batch": 0.03470436596267595}}, "connector_pipeline_timer": 0.08433342639591258}, "num_env_steps_trained_lifetime": 409500, "num_env_steps_trained": 31500, "num_module_steps_trained_lifetime": 78000, "num_module_steps_trained": 6000, "learner_connector_sum_episodes_length_out": 5250.0, "num_trainable_parameters": 6003, "learner_connector_sum_episodes_length_in": 5000.0, "num_env_steps_trained_lifetime_throughput": 2475427.7239680826, "num_module_steps_trained_throughput": 473648.37650083005, "num_module_steps_trained_lifetime_throughput": 472866.94441012945}, "default_policy": {"diff_num_grad_updates_vs_sampler_policy": 1.0, "vf_loss_unclipped": 28.627490997314453, "num_module_steps_trained": 6000, "total_loss": 0.03346370533108711, "num_trainable_parameters": 6003, "gradients_default_optimizer_global_norm": 0.049361228942871094, "weights_seq_no": 13.0, "mean_kl_loss": 0.0008334144367836416, "vf_explained_var": 0.019546985626220703, "vf_loss": 0.10202598571777344, "policy_loss": -0.030638419091701508, "default_optimizer_learning_rate": 0.0002847858517, "entropy": 0.45641592144966125, "num_module_steps_trained_lifetime": 78000, "curr_entropy_coeff": 0.0090570820258, "curr_kl_coeff": 9.112503903452307e-05, "module_train_batch_size_mean": 1000.0, "num_module_steps_trained_lifetime_throughput": 474308.5693631276}}, "num_training_step_calls_per_iteration": 1, "evaluation": {"env_runners": {"num_agent_steps_sampled": {"default_agent": 400}, "num_env_steps_sampled_lifetime": 65400, "env_to_module_connector": {"timers": {"connectors": {"add_states_from_episodes_to_batch": 1.5755485742194004e-06, "batch_individual_items": 6.117346907247323e-06, "numpy_to_tensor": 8.0386536082457e-06, "add_observations_from_episodes_to_batch": 2.7764816657228976e-06, "add_time_dim_to_batch_and_zero_pad": 2.181152756452369e-06}}, "connector_pipeline_timer": 4.214299702906304e-05}, "episode_return_min": -16.5, "num_episodes": 20, "num_episodes_lifetime": 260, "module_to_env_connector": {"timers": {"connectors": {"un_batch_to_individual_items": 5.208495332540085e-06, "normalize_and_clip_actions": 9.106293958839841e-06, "listify_data_for_vector_env": 1.074493279562231e-05, "tensor_to_numpy": 1.2693817004234602e-05, "get_actions": 3.447247290481948e-05, "remove_single_ts_time_rank_from_batch": 5.882517314620817e-07}}, "connector_pipeline_timer": 9.796499488749274e-05}, "episode_len_mean": 20.0, "weights_seq_no": 13.0, "episode_return_max": 12.5, "num_agent_steps_sampled_lifetime": {"default_agent": 5200}, "episode_len_min": 20, "num_env_steps_sampled": 400, "episode_duration_sec_mean": 0.009690062940353527, "module_episode_returns_mean": {"default_policy": 1.95}, "episode_return_mean": 1.95, "env_reset_timer": 0.00016511733300560348, "env_step_timer": 1.3746434214699307e-05, "num_module_steps_sampled": {"default_policy": 400}, "agent_episode_returns_mean": {"default_agent": 1.95}, "episode_len_max": 20, "env_to_module_sum_episodes_length_in": 10.368238394574323, "num_module_steps_sampled_lifetime": {"default_policy": 5200}, "env_to_module_sum_episodes_length_out": 10.368238394574323, "rlmodule_inference_timer": 2.62762977975178e-05, "sample": 0.1023221923450787, "time_between_sampling": 1.6158711805281887}, "num_healthy_workers": 1, "actor_manager_num_outstanding_async_reqs": 0, "num_remote_worker_restarts": 0}, "num_env_steps_sampled_lifetime": -6782500.0, "fault_tolerance": {"num_healthy_workers": 0, "num_remote_worker_restarts": 0}, "env_runner_group": {"actor_manager_num_outstanding_async_reqs": 0}, "done": false, "training_iteration": 13, "trial_id": "49be2_00000", "date": "2025-08-11_19-36-38", "timestamp": 1754933798, "time_this_iter_s": 2.2085070610046387, "time_total_s": 28.53028178215027, "pid": 28164, "hostname": "Mac", "node_ip": "127.0.0.1", "config": {"exploration_config": {}, "extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "placement_strategy": "PACK", "num_gpus": 0, "_fake_gpus": false, "num_cpus_for_main_process": 2, "eager_tracing": true, "eager_max_retraces": 20, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "torch_compile_learner": false, "torch_compile_learner_what_to_compile": "forward_train", "torch_compile_learner_dynamo_backend": "aot_eager", "torch_compile_learner_dynamo_mode": null, "torch_compile_worker": false, "torch_compile_worker_dynamo_backend": "aot_eager", "torch_compile_worker_dynamo_mode": null, "torch_ddp_kwargs": {}, "torch_skip_nan_gradients": false, "env": "Umbrella", "env_config": {}, "observation_space": null, "action_space": null, "clip_rewards": null, "normalize_actions": true, "clip_actions": false, "_is_atari": null, "disable_env_checking": false, "render_env": false, "action_mask_key": "action_mask", "env_runner_cls": null, "num_env_runners": 0, "create_local_env_runner": true, "num_envs_per_env_runner": 1, "gym_env_vectorize_mode": "SYNC", "num_cpus_per_env_runner": 1, "num_gpus_per_env_runner": 0, "custom_resources_per_env_runner": {}, "validate_env_runners_after_construction": true, "episodes_to_numpy": true, "max_requests_in_flight_per_env_runner": 1, "sample_timeout_s": 60.0, "_env_to_module_connector": null, "add_default_connectors_to_env_to_module_pipeline": true, "_module_to_env_connector": null, "add_default_connectors_to_module_to_env_pipeline": true, "merge_env_runner_states": "training_only", "broadcast_env_runner_states": true, "episode_lookback_horizon": 1, "rollout_fragment_length": "auto", "batch_mode": "complete_episodes", "compress_observations": false, "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "enable_tf1_exec_eagerly": false, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "preprocessor_pref": "deepmind", "observation_filter": "NoFilter", "update_worker_filter_stats": true, "use_worker_filter_stats": true, "sampler_perf_stats_ema_coef": null, "_is_online": true, "num_learners": 0, "num_gpus_per_learner": 0, "num_cpus_per_learner": "auto", "num_aggregator_actors_per_learner": 0, "max_requests_in_flight_per_aggregator_actor": 3, "local_gpu_idx": 0, "max_requests_in_flight_per_learner": 3, "gamma": 1, "lr": 0.0002847858517, "grad_clip": 0.5, "grad_clip_by": "global_norm", "_train_batch_size_per_learner": 5000, "train_batch_size": 4000, "num_epochs": 1, "minibatch_size": 1000, "shuffle_batch_per_epoch": true, "model": {"fcnet_hiddens": [256, 256], "fcnet_activation": "tanh", "fcnet_weights_initializer": null, "fcnet_weights_initializer_config": null, "fcnet_bias_initializer": null, "fcnet_bias_initializer_config": null, "conv_filters": null, "conv_activation": "relu", "conv_kernel_initializer": null, "conv_kernel_initializer_config": null, "conv_bias_initializer": null, "conv_bias_initializer_config": null, "conv_transpose_kernel_initializer": null, "conv_transpose_kernel_initializer_config": null, "conv_transpose_bias_initializer": null, "conv_transpose_bias_initializer_config": null, "post_fcnet_hiddens": [], "post_fcnet_activation": "relu", "post_fcnet_weights_initializer": null, "post_fcnet_weights_initializer_config": null, "post_fcnet_bias_initializer": null, "post_fcnet_bias_initializer_config": null, "free_log_std": false, "log_std_clip_param": 20.0, "no_final_linear": false, "vf_share_layers": false, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "lstm_weights_initializer": null, "lstm_weights_initializer_config": null, "lstm_bias_initializer": null, "lstm_bias_initializer_config": null, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "attention_use_n_prev_actions": 0, "attention_use_n_prev_rewards": 0, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": null, "custom_model_config": {}, "custom_action_dist": null, "custom_preprocessor": null, "encoder_latent_dim": null, "always_check_shapes": false, "lstm_use_prev_action_reward": -1, "_use_default_native_models": -1, "_disable_preprocessor_api": false, "_disable_action_flattening": false}, "_learner_connector": null, "add_default_connectors_to_learner_pipeline": true, "learner_config_dict": {}, "optimizer": {}, "_learner_class": null, "callbacks_on_algorithm_init": null, "callbacks_on_env_runners_recreated": null, "callbacks_on_offline_eval_runners_recreated": null, "callbacks_on_checkpoint_loaded": null, "callbacks_on_environment_created": null, "callbacks_on_episode_created": null, "callbacks_on_episode_start": null, "callbacks_on_episode_step": null, "callbacks_on_episode_end": null, "callbacks_on_evaluate_start": null, "callbacks_on_evaluate_end": null, "callbacks_on_evaluate_offline_start": null, "callbacks_on_evaluate_offline_end": null, "callbacks_on_sample_end": null, "callbacks_on_train_result": null, "explore": true, "enable_rl_module_and_learner": true, "enable_env_runner_and_connector_v2": true, "_prior_exploration_config": {"type": "StochasticSampling"}, "count_steps_by": "env_steps", "policy_map_capacity": 100, "policy_mapping_fn": "<function AlgorithmConfig.DEFAULT_POLICY_MAPPING_FN at 0x145c2d8a0>", "policies_to_train": null, "policy_states_are_swappable": false, "observation_fn": null, "offline_data_class": null, "input_read_method": "read_parquet", "input_read_method_kwargs": {}, "input_read_schema": {}, "input_read_episodes": false, "input_read_sample_batches": false, "input_read_batch_size": null, "input_filesystem": null, "input_filesystem_kwargs": {}, "input_compress_columns": ["obs", "new_obs"], "input_spaces_jsonable": true, "materialize_data": false, "materialize_mapped_data": true, "map_batches_kwargs": {}, "iter_batches_kwargs": {}, "ignore_final_observation": false, "prelearner_class": null, "prelearner_buffer_class": null, "prelearner_buffer_kwargs": {}, "prelearner_module_synch_period": 10, "dataset_num_iters_per_learner": null, "input_config": {}, "actions_in_input_normalized": false, "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_config": {}, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "output_max_rows_per_file": null, "output_write_remaining_data": false, "output_write_method": "write_parquet", "output_write_method_kwargs": {}, "output_filesystem": null, "output_filesystem_kwargs": {}, "output_write_episodes": true, "offline_sampling": false, "evaluation_interval": 1, "evaluation_duration": 20, "evaluation_duration_unit": "episodes", "evaluation_sample_timeout_s": 120.0, "evaluation_auto_duration_min_env_steps_per_sample": 100, "evaluation_auto_duration_max_env_steps_per_sample": 2000, "evaluation_parallel_to_training": false, "evaluation_force_reset_envs_before_iteration": true, "evaluation_config": null, "off_policy_estimation_methods": {}, "ope_split_batch_by_episode": true, "evaluation_num_env_runners": 1, "in_evaluation": false, "sync_filters_on_rollout_workers_timeout_s": 10.0, "offline_evaluation_interval": null, "num_offline_eval_runners": 0, "offline_loss_for_module_fn": null, "offline_evaluation_duration": 1, "offline_evaluation_parallel_to_training": false, "offline_evaluation_timeout_s": 120.0, "num_cpus_per_offline_eval_runner": 1, "num_gpus_per_offline_eval_runner": 0, "custom_resources_per_offline_eval_runner": {}, "restart_failed_offline_eval_runners": true, "ignore_offline_eval_runner_failures": false, "max_num_offline_eval_runner_restarts": 1000, "offline_eval_runner_restore_timeout_s": 1800.0, "max_requests_in_flight_per_offline_eval_runner": 1, "validate_offline_eval_runners_after_construction": true, "offline_eval_runner_health_probe_timeout_s": 30.0, "offline_eval_rl_module_inference_only": false, "broadcast_offline_eval_runner_states": false, "offline_eval_batch_size_per_runner": 256, "dataset_num_iters_per_eval_runner": 1, "keep_per_episode_custom_metrics": false, "metrics_episode_collection_timeout_s": 60.0, "metrics_num_episodes_for_smoothing": 100, "min_time_s_per_iteration": null, "min_train_timesteps_per_iteration": 0, "min_sample_timesteps_per_iteration": 0, "log_gradients": true, "export_native_model_files": false, "checkpoint_trainable_policies_only": false, "logger_creator": null, "logger_config": null, "log_level": "WARN", "log_sys_usage": true, "fake_sampler": false, "seed": 4, "restart_failed_env_runners": true, "ignore_env_runner_failures": false, "max_num_env_runner_restarts": 1000, "delay_between_env_runner_restarts_s": 60.0, "restart_failed_sub_environments": false, "num_consecutive_env_runner_failures_tolerance": 100, "env_runner_health_probe_timeout_s": 30.0, "env_runner_restore_timeout_s": 1800.0, "_model_config": {}, "_rl_module_spec": "RLModuleSpec(module_class=None, observation_space=None, action_space=None, inference_only=False, learner_only=False, model_config=DefaultModelConfig(fcnet_hiddens=[60, 90], fcnet_activation='tanh', fcnet_kernel_initializer=None, fcnet_kernel_initializer_kwargs=None, fcnet_bias_initializer=None, fcnet_bias_initializer_kwargs=None, conv_filters=None, conv_activation='relu', conv_kernel_initializer=None, conv_kernel_initializer_kwargs=None, conv_bias_initializer=None, conv_bias_initializer_kwargs=None, head_fcnet_hiddens=[], head_fcnet_activation='relu', head_fcnet_kernel_initializer=None, head_fcnet_kernel_initializer_kwargs=None, head_fcnet_bias_initializer=None, head_fcnet_bias_initializer_kwargs=None, free_log_std=False, log_std_clip_param=20.0, vf_share_layers=True, use_lstm=False, max_seq_len=20, lstm_cell_size=256, lstm_use_prev_action=False, lstm_use_prev_reward=False, lstm_kernel_initializer=None, lstm_kernel_initializer_kwargs=None, lstm_bias_initializer=None, lstm_bias_initializer_kwargs=None), catalog_class=None, load_state_path=None, model_config_dict=None)", "algorithm_config_overrides_per_module": {}, "_per_module_overrides": {}, "_validate_config": true, "_use_msgpack_checkpoints": false, "_torch_grad_scaler_class": null, "_torch_lr_scheduler_classes": null, "_tf_policy_handles_more_than_one_loss": false, "_disable_preprocessor_api": false, "_disable_action_flattening": false, "_disable_initialize_loss_from_dummy_batch": false, "_dont_auto_sync_env_runner_states": false, "env_task_fn": -1, "enable_connectors": -1, "simple_optimizer": false, "policy_map_cache": -1, "worker_cls": -1, "synchronize_filters": -1, "enable_async_evaluation": -1, "custom_async_evaluation_function": -1, "_enable_rl_module_api": -1, "auto_wrap_old_gym_envs": -1, "always_attach_evaluation_results": -1, "replay_sequence_length": null, "_disable_execution_plan_api": -1, "use_critic": true, "use_gae": true, "use_kl_loss": true, "kl_coeff": 0.7464963036515, "kl_target": 0.0270990929592, "vf_loss_coeff": 0.6688075857018, "entropy_coeff": 0.0090570820258, "clip_param": 0.1221781641624, "vf_clip_param": 0.1027808522125, "entropy_coeff_schedule": null, "lr_schedule": null, "sgd_minibatch_size": -1, "vf_share_layers": -1, "__stdout_file__": null, "__stderr_file__": null, "lambda": 0.9099046732075, "input": "sampler", "policies": {"default_policy": [null, null, null, null]}, "callbacks": "<class 'ray.rllib.callbacks.callbacks.RLlibCallback'>", "create_env_on_driver": false, "custom_eval_function": null, "framework": "torch"}, "time_since_restore": 28.53028178215027, "iterations_since_restore": 13, "perf": {"cpu_util_percent": 74.13333333333334, "ram_util_percent": 79.56666666666668}}
{"timers": {"training_iteration": 1.6240318929552815, "restore_env_runners": 9.701985014189281e-06, "training_step": 1.6239048678350745, "env_runner_sampling_timer": 1.4928726580370963, "learner_update_timer": 0.1278965026020402, "synch_weights": 0.0006633668355448837, "restore_eval_env_runners": 1.2248335688881342e-05, "evaluation_iteration": 0.10866514835124012, "synch_eval_env_connectors": 0.00012104942011059731, "synch_env_connectors": 4.880261057104083e-06}, "env_runners": {"num_episodes_lifetime": -370000.0, "episode_len_mean": 20.0, "env_to_module_connector": {"timers": {"connectors": {"batch_individual_items": 8.414679494903623e-06, "add_observations_from_episodes_to_batch": 3.823753858447919e-06, "add_states_from_episodes_to_batch": 2.072925901080004e-06, "numpy_to_tensor": 1.21995814482167e-05, "add_time_dim_to_batch_and_zero_pad": 3.2015129876369556e-06}}, "connector_pipeline_timer": 5.662191499277997e-05}, "agent_episode_returns_mean": {"default_agent": 10.42}, "episode_return_max": 12.5, "num_module_steps_sampled_lifetime": {"default_policy": -7400000.0}, "env_step_timer": 2.0377999041026354e-05, "module_to_env_connector": {"timers": {"connectors": {"listify_data_for_vector_env": 1.4985668273895402e-05, "remove_single_ts_time_rank_from_batch": 7.624284419488615e-07, "tensor_to_numpy": 1.8023177990844265e-05, "un_batch_to_individual_items": 6.73491659221467e-06, "get_actions": 5.8023054470497174e-05, "normalize_and_clip_actions": 1.2393104156391204e-05}}, "connector_pipeline_timer": 0.00014292867173398756}, "module_episode_returns_mean": {"default_policy": 10.42}, "num_env_steps_sampled_lifetime": -7400000.0, "episode_len_min": 20, "episode_return_min": -7.5, "time_between_sampling": 0.002117964202870988, "num_env_steps_sampled": 5000.0, "num_module_steps_sampled": {"default_policy": 5000.0}, "num_episodes": 250.0, "episode_len_max": 20, "num_agent_steps_sampled": {"default_agent": 5000.0}, "episode_duration_sec_mean": 0.006265035379212347, "env_to_module_sum_episodes_length_in": 10.36823839457432, "num_agent_steps_sampled_lifetime": {"default_agent": -7400000.0}, "env_to_module_sum_episodes_length_out": 10.36823839457432, "rlmodule_inference_timer": 4.0220637240185164e-05, "episode_return_mean": 10.42, "sample": 0.006666083451163688, "env_reset_timer": 6.156146405463852e-05, "weights_seq_no": 13.0, "num_env_steps_sampled_lifetime_throughput": 2967.063651862477}, "learners": {"__all_modules__": {"num_non_trainable_parameters": 0, "learner_connector": {"timers": {"connectors": {"add_time_dim_to_batch_and_zero_pad": 1.1840613973822799e-05, "batch_individual_items": 0.03366871124318881, "add_one_ts_to_episodes_and_truncate": 0.008519922581295938, "general_advantage_estimation": 0.007524644940666588, "numpy_to_tensor": 6.767315293376446e-05, "add_observations_from_episodes_to_batch": 0.0008286151512981472, "add_states_from_episodes_to_batch": 3.198604208305758e-06, "add_columns_from_episodes_to_train_batch": 0.03473107313381686}}, "connector_pipeline_timer": 0.08546898672165512}, "num_env_steps_trained_lifetime": 441000, "num_env_steps_trained": 31500, "num_module_steps_trained_lifetime": 84000, "num_module_steps_trained": 6000, "learner_connector_sum_episodes_length_out": 5250.0, "num_trainable_parameters": 6003, "learner_connector_sum_episodes_length_in": 5000.0, "num_env_steps_trained_lifetime_throughput": 2444737.157869266, "num_module_steps_trained_throughput": 467705.5910132658, "num_module_steps_trained_lifetime_throughput": 466955.8174440621}, "default_policy": {"diff_num_grad_updates_vs_sampler_policy": 1.0, "vf_loss_unclipped": 28.65528678894043, "num_module_steps_trained": 6000, "total_loss": -0.04048038646578789, "num_trainable_parameters": 6003, "gradients_default_optimizer_global_norm": 0.06715603172779083, "weights_seq_no": 14.0, "mean_kl_loss": 0.0003316231013741344, "vf_explained_var": 0.01694488525390625, "vf_loss": 0.10234943777322769, "policy_loss": -0.10505218803882599, "default_optimizer_learning_rate": 0.0002847858517, "entropy": 0.42842739820480347, "num_module_steps_trained_lifetime": 84000, "curr_entropy_coeff": 0.0090570820258, "curr_kl_coeff": 4.5562519517261535e-05, "module_train_batch_size_mean": 1000.0, "num_module_steps_trained_lifetime_throughput": 468295.285794614}}, "num_training_step_calls_per_iteration": 1, "evaluation": {"env_runners": {"num_agent_steps_sampled": {"default_agent": 400}, "num_env_steps_sampled_lifetime": 70400, "env_to_module_connector": {"timers": {"connectors": {"add_states_from_episodes_to_batch": 1.6650659449081782e-06, "batch_individual_items": 7.00617541372933e-06, "numpy_to_tensor": 9.436646158090901e-06, "add_observations_from_episodes_to_batch": 2.931800343185021e-06, "add_time_dim_to_batch_and_zero_pad": 2.429197645029702e-06}}, "connector_pipeline_timer": 4.609927138451559e-05}, "episode_return_min": -16.5, "num_episodes": 20, "num_episodes_lifetime": 280, "module_to_env_connector": {"timers": {"connectors": {"un_batch_to_individual_items": 5.637269405890172e-06, "normalize_and_clip_actions": 1.0087107567732687e-05, "listify_data_for_vector_env": 1.1702084742055366e-05, "tensor_to_numpy": 1.4760867962610641e-05, "get_actions": 4.09333517016868e-05, "remove_single_ts_time_rank_from_batch": 6.003219932883629e-07}}, "connector_pipeline_timer": 0.0001107410656808843}, "episode_len_mean": 20.0, "weights_seq_no": 14.0, "episode_return_max": 12.5, "num_agent_steps_sampled_lifetime": {"default_agent": 5600}, "episode_len_min": 20, "num_env_steps_sampled": 400, "episode_duration_sec_mean": 0.009792882908368484, "module_episode_returns_mean": {"default_policy": 1.35}, "episode_return_mean": 1.35, "env_reset_timer": 0.0001641528203173518, "env_step_timer": 1.593799587119675e-05, "num_module_steps_sampled": {"default_policy": 400}, "agent_episode_returns_mean": {"default_agent": 1.35}, "episode_len_max": 20, "env_to_module_sum_episodes_length_in": 10.368238394574323, "num_module_steps_sampled_lifetime": {"default_policy": 5600}, "env_to_module_sum_episodes_length_out": 10.368238394574323, "rlmodule_inference_timer": 3.014188177235165e-05, "sample": 0.10237329751238301, "time_between_sampling": 1.6213224308025806}, "num_healthy_workers": 1, "actor_manager_num_outstanding_async_reqs": 0, "num_remote_worker_restarts": 0}, "num_env_steps_sampled_lifetime": -7400000.0, "fault_tolerance": {"num_healthy_workers": 0, "num_remote_worker_restarts": 0}, "env_runner_group": {"actor_manager_num_outstanding_async_reqs": 0}, "done": false, "training_iteration": 14, "trial_id": "49be2_00000", "date": "2025-08-11_19-36-40", "timestamp": 1754933800, "time_this_iter_s": 2.2587149143218994, "time_total_s": 30.788996696472168, "pid": 28164, "hostname": "Mac", "node_ip": "127.0.0.1", "config": {"exploration_config": {}, "extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "placement_strategy": "PACK", "num_gpus": 0, "_fake_gpus": false, "num_cpus_for_main_process": 2, "eager_tracing": true, "eager_max_retraces": 20, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "torch_compile_learner": false, "torch_compile_learner_what_to_compile": "forward_train", "torch_compile_learner_dynamo_backend": "aot_eager", "torch_compile_learner_dynamo_mode": null, "torch_compile_worker": false, "torch_compile_worker_dynamo_backend": "aot_eager", "torch_compile_worker_dynamo_mode": null, "torch_ddp_kwargs": {}, "torch_skip_nan_gradients": false, "env": "Umbrella", "env_config": {}, "observation_space": null, "action_space": null, "clip_rewards": null, "normalize_actions": true, "clip_actions": false, "_is_atari": null, "disable_env_checking": false, "render_env": false, "action_mask_key": "action_mask", "env_runner_cls": null, "num_env_runners": 0, "create_local_env_runner": true, "num_envs_per_env_runner": 1, "gym_env_vectorize_mode": "SYNC", "num_cpus_per_env_runner": 1, "num_gpus_per_env_runner": 0, "custom_resources_per_env_runner": {}, "validate_env_runners_after_construction": true, "episodes_to_numpy": true, "max_requests_in_flight_per_env_runner": 1, "sample_timeout_s": 60.0, "_env_to_module_connector": null, "add_default_connectors_to_env_to_module_pipeline": true, "_module_to_env_connector": null, "add_default_connectors_to_module_to_env_pipeline": true, "merge_env_runner_states": "training_only", "broadcast_env_runner_states": true, "episode_lookback_horizon": 1, "rollout_fragment_length": "auto", "batch_mode": "complete_episodes", "compress_observations": false, "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "enable_tf1_exec_eagerly": false, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "preprocessor_pref": "deepmind", "observation_filter": "NoFilter", "update_worker_filter_stats": true, "use_worker_filter_stats": true, "sampler_perf_stats_ema_coef": null, "_is_online": true, "num_learners": 0, "num_gpus_per_learner": 0, "num_cpus_per_learner": "auto", "num_aggregator_actors_per_learner": 0, "max_requests_in_flight_per_aggregator_actor": 3, "local_gpu_idx": 0, "max_requests_in_flight_per_learner": 3, "gamma": 1, "lr": 0.0002847858517, "grad_clip": 0.5, "grad_clip_by": "global_norm", "_train_batch_size_per_learner": 5000, "train_batch_size": 4000, "num_epochs": 1, "minibatch_size": 1000, "shuffle_batch_per_epoch": true, "model": {"fcnet_hiddens": [256, 256], "fcnet_activation": "tanh", "fcnet_weights_initializer": null, "fcnet_weights_initializer_config": null, "fcnet_bias_initializer": null, "fcnet_bias_initializer_config": null, "conv_filters": null, "conv_activation": "relu", "conv_kernel_initializer": null, "conv_kernel_initializer_config": null, "conv_bias_initializer": null, "conv_bias_initializer_config": null, "conv_transpose_kernel_initializer": null, "conv_transpose_kernel_initializer_config": null, "conv_transpose_bias_initializer": null, "conv_transpose_bias_initializer_config": null, "post_fcnet_hiddens": [], "post_fcnet_activation": "relu", "post_fcnet_weights_initializer": null, "post_fcnet_weights_initializer_config": null, "post_fcnet_bias_initializer": null, "post_fcnet_bias_initializer_config": null, "free_log_std": false, "log_std_clip_param": 20.0, "no_final_linear": false, "vf_share_layers": false, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "lstm_weights_initializer": null, "lstm_weights_initializer_config": null, "lstm_bias_initializer": null, "lstm_bias_initializer_config": null, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "attention_use_n_prev_actions": 0, "attention_use_n_prev_rewards": 0, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": null, "custom_model_config": {}, "custom_action_dist": null, "custom_preprocessor": null, "encoder_latent_dim": null, "always_check_shapes": false, "lstm_use_prev_action_reward": -1, "_use_default_native_models": -1, "_disable_preprocessor_api": false, "_disable_action_flattening": false}, "_learner_connector": null, "add_default_connectors_to_learner_pipeline": true, "learner_config_dict": {}, "optimizer": {}, "_learner_class": null, "callbacks_on_algorithm_init": null, "callbacks_on_env_runners_recreated": null, "callbacks_on_offline_eval_runners_recreated": null, "callbacks_on_checkpoint_loaded": null, "callbacks_on_environment_created": null, "callbacks_on_episode_created": null, "callbacks_on_episode_start": null, "callbacks_on_episode_step": null, "callbacks_on_episode_end": null, "callbacks_on_evaluate_start": null, "callbacks_on_evaluate_end": null, "callbacks_on_evaluate_offline_start": null, "callbacks_on_evaluate_offline_end": null, "callbacks_on_sample_end": null, "callbacks_on_train_result": null, "explore": true, "enable_rl_module_and_learner": true, "enable_env_runner_and_connector_v2": true, "_prior_exploration_config": {"type": "StochasticSampling"}, "count_steps_by": "env_steps", "policy_map_capacity": 100, "policy_mapping_fn": "<function AlgorithmConfig.DEFAULT_POLICY_MAPPING_FN at 0x145c2d8a0>", "policies_to_train": null, "policy_states_are_swappable": false, "observation_fn": null, "offline_data_class": null, "input_read_method": "read_parquet", "input_read_method_kwargs": {}, "input_read_schema": {}, "input_read_episodes": false, "input_read_sample_batches": false, "input_read_batch_size": null, "input_filesystem": null, "input_filesystem_kwargs": {}, "input_compress_columns": ["obs", "new_obs"], "input_spaces_jsonable": true, "materialize_data": false, "materialize_mapped_data": true, "map_batches_kwargs": {}, "iter_batches_kwargs": {}, "ignore_final_observation": false, "prelearner_class": null, "prelearner_buffer_class": null, "prelearner_buffer_kwargs": {}, "prelearner_module_synch_period": 10, "dataset_num_iters_per_learner": null, "input_config": {}, "actions_in_input_normalized": false, "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_config": {}, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "output_max_rows_per_file": null, "output_write_remaining_data": false, "output_write_method": "write_parquet", "output_write_method_kwargs": {}, "output_filesystem": null, "output_filesystem_kwargs": {}, "output_write_episodes": true, "offline_sampling": false, "evaluation_interval": 1, "evaluation_duration": 20, "evaluation_duration_unit": "episodes", "evaluation_sample_timeout_s": 120.0, "evaluation_auto_duration_min_env_steps_per_sample": 100, "evaluation_auto_duration_max_env_steps_per_sample": 2000, "evaluation_parallel_to_training": false, "evaluation_force_reset_envs_before_iteration": true, "evaluation_config": null, "off_policy_estimation_methods": {}, "ope_split_batch_by_episode": true, "evaluation_num_env_runners": 1, "in_evaluation": false, "sync_filters_on_rollout_workers_timeout_s": 10.0, "offline_evaluation_interval": null, "num_offline_eval_runners": 0, "offline_loss_for_module_fn": null, "offline_evaluation_duration": 1, "offline_evaluation_parallel_to_training": false, "offline_evaluation_timeout_s": 120.0, "num_cpus_per_offline_eval_runner": 1, "num_gpus_per_offline_eval_runner": 0, "custom_resources_per_offline_eval_runner": {}, "restart_failed_offline_eval_runners": true, "ignore_offline_eval_runner_failures": false, "max_num_offline_eval_runner_restarts": 1000, "offline_eval_runner_restore_timeout_s": 1800.0, "max_requests_in_flight_per_offline_eval_runner": 1, "validate_offline_eval_runners_after_construction": true, "offline_eval_runner_health_probe_timeout_s": 30.0, "offline_eval_rl_module_inference_only": false, "broadcast_offline_eval_runner_states": false, "offline_eval_batch_size_per_runner": 256, "dataset_num_iters_per_eval_runner": 1, "keep_per_episode_custom_metrics": false, "metrics_episode_collection_timeout_s": 60.0, "metrics_num_episodes_for_smoothing": 100, "min_time_s_per_iteration": null, "min_train_timesteps_per_iteration": 0, "min_sample_timesteps_per_iteration": 0, "log_gradients": true, "export_native_model_files": false, "checkpoint_trainable_policies_only": false, "logger_creator": null, "logger_config": null, "log_level": "WARN", "log_sys_usage": true, "fake_sampler": false, "seed": 4, "restart_failed_env_runners": true, "ignore_env_runner_failures": false, "max_num_env_runner_restarts": 1000, "delay_between_env_runner_restarts_s": 60.0, "restart_failed_sub_environments": false, "num_consecutive_env_runner_failures_tolerance": 100, "env_runner_health_probe_timeout_s": 30.0, "env_runner_restore_timeout_s": 1800.0, "_model_config": {}, "_rl_module_spec": "RLModuleSpec(module_class=None, observation_space=None, action_space=None, inference_only=False, learner_only=False, model_config=DefaultModelConfig(fcnet_hiddens=[60, 90], fcnet_activation='tanh', fcnet_kernel_initializer=None, fcnet_kernel_initializer_kwargs=None, fcnet_bias_initializer=None, fcnet_bias_initializer_kwargs=None, conv_filters=None, conv_activation='relu', conv_kernel_initializer=None, conv_kernel_initializer_kwargs=None, conv_bias_initializer=None, conv_bias_initializer_kwargs=None, head_fcnet_hiddens=[], head_fcnet_activation='relu', head_fcnet_kernel_initializer=None, head_fcnet_kernel_initializer_kwargs=None, head_fcnet_bias_initializer=None, head_fcnet_bias_initializer_kwargs=None, free_log_std=False, log_std_clip_param=20.0, vf_share_layers=True, use_lstm=False, max_seq_len=20, lstm_cell_size=256, lstm_use_prev_action=False, lstm_use_prev_reward=False, lstm_kernel_initializer=None, lstm_kernel_initializer_kwargs=None, lstm_bias_initializer=None, lstm_bias_initializer_kwargs=None), catalog_class=None, load_state_path=None, model_config_dict=None)", "algorithm_config_overrides_per_module": {}, "_per_module_overrides": {}, "_validate_config": true, "_use_msgpack_checkpoints": false, "_torch_grad_scaler_class": null, "_torch_lr_scheduler_classes": null, "_tf_policy_handles_more_than_one_loss": false, "_disable_preprocessor_api": false, "_disable_action_flattening": false, "_disable_initialize_loss_from_dummy_batch": false, "_dont_auto_sync_env_runner_states": false, "env_task_fn": -1, "enable_connectors": -1, "simple_optimizer": false, "policy_map_cache": -1, "worker_cls": -1, "synchronize_filters": -1, "enable_async_evaluation": -1, "custom_async_evaluation_function": -1, "_enable_rl_module_api": -1, "auto_wrap_old_gym_envs": -1, "always_attach_evaluation_results": -1, "replay_sequence_length": null, "_disable_execution_plan_api": -1, "use_critic": true, "use_gae": true, "use_kl_loss": true, "kl_coeff": 0.7464963036515, "kl_target": 0.0270990929592, "vf_loss_coeff": 0.6688075857018, "entropy_coeff": 0.0090570820258, "clip_param": 0.1221781641624, "vf_clip_param": 0.1027808522125, "entropy_coeff_schedule": null, "lr_schedule": null, "sgd_minibatch_size": -1, "vf_share_layers": -1, "__stdout_file__": null, "__stderr_file__": null, "lambda": 0.9099046732075, "input": "sampler", "policies": {"default_policy": [null, null, null, null]}, "callbacks": "<class 'ray.rllib.callbacks.callbacks.RLlibCallback'>", "create_env_on_driver": false, "custom_eval_function": null, "framework": "torch"}, "time_since_restore": 30.788996696472168, "iterations_since_restore": 14, "perf": {"cpu_util_percent": 80.8, "ram_util_percent": 78.83333333333333}}
{"timers": {"training_iteration": 1.6232052465260187, "restore_env_runners": 9.670794536080865e-06, "training_step": 1.623077599155991, "env_runner_sampling_timer": 1.4915142664565475, "learner_update_timer": 0.12842909798586186, "synch_weights": 0.0006625456677929319, "restore_eval_env_runners": 1.2198352301966689e-05, "evaluation_iteration": 0.10870217145763547, "synch_eval_env_connectors": 0.00012092684688256875, "synch_env_connectors": 4.876049007252412e-06}, "env_runners": {"num_episodes_lifetime": -400875.0, "episode_len_mean": 20.0, "env_to_module_connector": {"timers": {"connectors": {"batch_individual_items": 6.151513708374514e-06, "add_observations_from_episodes_to_batch": 2.9932511865559585e-06, "add_states_from_episodes_to_batch": 1.7444077356516237e-06, "numpy_to_tensor": 8.371464701179277e-06, "add_time_dim_to_batch_and_zero_pad": 2.3782766532595416e-06}}, "connector_pipeline_timer": 4.3099398223947994e-05}, "agent_episode_returns_mean": {"default_agent": 10.18}, "episode_return_max": 12.5, "num_module_steps_sampled_lifetime": {"default_policy": -8017500.0}, "env_step_timer": 1.3695898438030197e-05, "module_to_env_connector": {"timers": {"connectors": {"listify_data_for_vector_env": 1.1059693046178193e-05, "remove_single_ts_time_rank_from_batch": 5.812844401482633e-07, "tensor_to_numpy": 1.3073539732228576e-05, "un_batch_to_individual_items": 5.3426440229904146e-06, "get_actions": 3.834689937083574e-05, "normalize_and_clip_actions": 9.321286416654543e-06}}, "connector_pipeline_timer": 0.00010312342347291608}, "module_episode_returns_mean": {"default_policy": 10.18}, "num_env_steps_sampled_lifetime": -8017500.0, "episode_len_min": 20, "episode_return_min": -7.5, "time_between_sampling": 0.002211783073521631, "num_env_steps_sampled": 5000.0, "num_module_steps_sampled": {"default_policy": 5000.0}, "num_episodes": 250.0, "episode_len_max": 20, "num_agent_steps_sampled": {"default_agent": 5000.0}, "episode_duration_sec_mean": 0.0044772976650856436, "env_to_module_sum_episodes_length_in": 10.36823839457432, "num_agent_steps_sampled_lifetime": {"default_agent": -8017500.0}, "env_to_module_sum_episodes_length_out": 10.36823839457432, "rlmodule_inference_timer": 2.7278317872325716e-05, "episode_return_mean": 10.18, "sample": 0.005496145127956586, "env_reset_timer": 4.3790770231750815e-05, "weights_seq_no": 14.0, "num_env_steps_sampled_lifetime_throughput": 3706.6131721761813}, "learners": {"__all_modules__": {"num_non_trainable_parameters": 0, "learner_connector": {"timers": {"connectors": {"add_time_dim_to_batch_and_zero_pad": 1.1802208443244041e-05, "batch_individual_items": 0.034531716211019976, "add_one_ts_to_episodes_and_truncate": 0.008510804605345887, "general_advantage_estimation": 0.007501311401099224, "numpy_to_tensor": 6.762559150370015e-05, "add_observations_from_episodes_to_batch": 0.0008286844196351426, "add_states_from_episodes_to_batch": 3.192447233676442e-06, "add_columns_from_episodes_to_train_batch": 0.03473339573295796}}, "connector_pipeline_timer": 0.08630159518421844}, "num_env_steps_trained_lifetime": 472500, "num_env_steps_trained": 31500, "num_module_steps_trained_lifetime": 90000, "num_module_steps_trained": 6000, "learner_connector_sum_episodes_length_out": 5250.0, "num_trainable_parameters": 6003, "learner_connector_sum_episodes_length_in": 5000.0, "num_env_steps_trained_lifetime_throughput": 2423793.2022580304, "num_module_steps_trained_throughput": 463625.80361924955, "num_module_steps_trained_lifetime_throughput": 462904.8265327425}, "default_policy": {"diff_num_grad_updates_vs_sampler_policy": 1.0, "vf_loss_unclipped": 28.625947952270508, "num_module_steps_trained": 6000, "total_loss": 0.0381966270506382, "num_trainable_parameters": 6003, "gradients_default_optimizer_global_norm": 0.008220300078392029, "weights_seq_no": 15.0, "mean_kl_loss": 0.00024917605333030224, "vf_explained_var": 0.019069373607635498, "vf_loss": 0.10213375091552734, "policy_loss": -0.02631792053580284, "default_optimizer_learning_rate": 0.0002847858517, "entropy": 0.4188220798969269, "num_module_steps_trained_lifetime": 90000, "curr_entropy_coeff": 0.0090570820258, "curr_kl_coeff": 2.2781259758630767e-05, "module_train_batch_size_mean": 1000.0, "num_module_steps_trained_lifetime_throughput": 464148.90824476985}}, "num_training_step_calls_per_iteration": 1, "evaluation": {"env_runners": {"num_agent_steps_sampled": {"default_agent": 400}, "num_env_steps_sampled_lifetime": 75400, "env_to_module_connector": {"timers": {"connectors": {"add_states_from_episodes_to_batch": 1.5733050176050743e-06, "batch_individual_items": 6.048047051060033e-06, "numpy_to_tensor": 8.026844799695692e-06, "add_observations_from_episodes_to_batch": 2.725965610986367e-06, "add_time_dim_to_batch_and_zero_pad": 2.168708511641393e-06}}, "connector_pipeline_timer": 4.170569947081992e-05}, "episode_return_min": -16.5, "num_episodes": 20, "num_episodes_lifetime": 300, "module_to_env_connector": {"timers": {"connectors": {"un_batch_to_individual_items": 5.194848915295189e-06, "normalize_and_clip_actions": 9.136765770583136e-06, "listify_data_for_vector_env": 1.0726697702549184e-05, "tensor_to_numpy": 1.2683184708491299e-05, "get_actions": 3.406739139836022e-05, "remove_single_ts_time_rank_from_batch": 6.352172535114035e-07}}, "connector_pipeline_timer": 9.723532863828075e-05}, "episode_len_mean": 20.0, "weights_seq_no": 15.0, "episode_return_max": 12.5, "num_agent_steps_sampled_lifetime": {"default_agent": 6000}, "episode_len_min": 20, "num_env_steps_sampled": 400, "episode_duration_sec_mean": 0.004835652889451012, "module_episode_returns_mean": {"default_policy": 1.55}, "episode_return_mean": 1.55, "env_reset_timer": 0.00016326379144124183, "env_step_timer": 1.366349469897483e-05, "num_module_steps_sampled": {"default_policy": 400}, "agent_episode_returns_mean": {"default_agent": 1.55}, "episode_len_max": 20, "env_to_module_sum_episodes_length_in": 10.368238394574323, "num_module_steps_sampled_lifetime": {"default_policy": 6000}, "env_to_module_sum_episodes_length_out": 10.368238394574323, "rlmodule_inference_timer": 2.635618507756822e-05, "sample": 0.10229825120800398, "time_between_sampling": 1.6206999485841078}, "num_healthy_workers": 1, "actor_manager_num_outstanding_async_reqs": 0, "num_remote_worker_restarts": 0}, "num_env_steps_sampled_lifetime": -8017500.0, "fault_tolerance": {"num_healthy_workers": 0, "num_remote_worker_restarts": 0}, "env_runner_group": {"actor_manager_num_outstanding_async_reqs": 0}, "done": false, "training_iteration": 15, "trial_id": "49be2_00000", "date": "2025-08-11_19-36-41", "timestamp": 1754933801, "time_this_iter_s": 1.6434500217437744, "time_total_s": 32.43244671821594, "pid": 28164, "hostname": "Mac", "node_ip": "127.0.0.1", "config": {"exploration_config": {}, "extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "placement_strategy": "PACK", "num_gpus": 0, "_fake_gpus": false, "num_cpus_for_main_process": 2, "eager_tracing": true, "eager_max_retraces": 20, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "torch_compile_learner": false, "torch_compile_learner_what_to_compile": "forward_train", "torch_compile_learner_dynamo_backend": "aot_eager", "torch_compile_learner_dynamo_mode": null, "torch_compile_worker": false, "torch_compile_worker_dynamo_backend": "aot_eager", "torch_compile_worker_dynamo_mode": null, "torch_ddp_kwargs": {}, "torch_skip_nan_gradients": false, "env": "Umbrella", "env_config": {}, "observation_space": null, "action_space": null, "clip_rewards": null, "normalize_actions": true, "clip_actions": false, "_is_atari": null, "disable_env_checking": false, "render_env": false, "action_mask_key": "action_mask", "env_runner_cls": null, "num_env_runners": 0, "create_local_env_runner": true, "num_envs_per_env_runner": 1, "gym_env_vectorize_mode": "SYNC", "num_cpus_per_env_runner": 1, "num_gpus_per_env_runner": 0, "custom_resources_per_env_runner": {}, "validate_env_runners_after_construction": true, "episodes_to_numpy": true, "max_requests_in_flight_per_env_runner": 1, "sample_timeout_s": 60.0, "_env_to_module_connector": null, "add_default_connectors_to_env_to_module_pipeline": true, "_module_to_env_connector": null, "add_default_connectors_to_module_to_env_pipeline": true, "merge_env_runner_states": "training_only", "broadcast_env_runner_states": true, "episode_lookback_horizon": 1, "rollout_fragment_length": "auto", "batch_mode": "complete_episodes", "compress_observations": false, "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "enable_tf1_exec_eagerly": false, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "preprocessor_pref": "deepmind", "observation_filter": "NoFilter", "update_worker_filter_stats": true, "use_worker_filter_stats": true, "sampler_perf_stats_ema_coef": null, "_is_online": true, "num_learners": 0, "num_gpus_per_learner": 0, "num_cpus_per_learner": "auto", "num_aggregator_actors_per_learner": 0, "max_requests_in_flight_per_aggregator_actor": 3, "local_gpu_idx": 0, "max_requests_in_flight_per_learner": 3, "gamma": 1, "lr": 0.0002847858517, "grad_clip": 0.5, "grad_clip_by": "global_norm", "_train_batch_size_per_learner": 5000, "train_batch_size": 4000, "num_epochs": 1, "minibatch_size": 1000, "shuffle_batch_per_epoch": true, "model": {"fcnet_hiddens": [256, 256], "fcnet_activation": "tanh", "fcnet_weights_initializer": null, "fcnet_weights_initializer_config": null, "fcnet_bias_initializer": null, "fcnet_bias_initializer_config": null, "conv_filters": null, "conv_activation": "relu", "conv_kernel_initializer": null, "conv_kernel_initializer_config": null, "conv_bias_initializer": null, "conv_bias_initializer_config": null, "conv_transpose_kernel_initializer": null, "conv_transpose_kernel_initializer_config": null, "conv_transpose_bias_initializer": null, "conv_transpose_bias_initializer_config": null, "post_fcnet_hiddens": [], "post_fcnet_activation": "relu", "post_fcnet_weights_initializer": null, "post_fcnet_weights_initializer_config": null, "post_fcnet_bias_initializer": null, "post_fcnet_bias_initializer_config": null, "free_log_std": false, "log_std_clip_param": 20.0, "no_final_linear": false, "vf_share_layers": false, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "lstm_weights_initializer": null, "lstm_weights_initializer_config": null, "lstm_bias_initializer": null, "lstm_bias_initializer_config": null, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "attention_use_n_prev_actions": 0, "attention_use_n_prev_rewards": 0, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": null, "custom_model_config": {}, "custom_action_dist": null, "custom_preprocessor": null, "encoder_latent_dim": null, "always_check_shapes": false, "lstm_use_prev_action_reward": -1, "_use_default_native_models": -1, "_disable_preprocessor_api": false, "_disable_action_flattening": false}, "_learner_connector": null, "add_default_connectors_to_learner_pipeline": true, "learner_config_dict": {}, "optimizer": {}, "_learner_class": null, "callbacks_on_algorithm_init": null, "callbacks_on_env_runners_recreated": null, "callbacks_on_offline_eval_runners_recreated": null, "callbacks_on_checkpoint_loaded": null, "callbacks_on_environment_created": null, "callbacks_on_episode_created": null, "callbacks_on_episode_start": null, "callbacks_on_episode_step": null, "callbacks_on_episode_end": null, "callbacks_on_evaluate_start": null, "callbacks_on_evaluate_end": null, "callbacks_on_evaluate_offline_start": null, "callbacks_on_evaluate_offline_end": null, "callbacks_on_sample_end": null, "callbacks_on_train_result": null, "explore": true, "enable_rl_module_and_learner": true, "enable_env_runner_and_connector_v2": true, "_prior_exploration_config": {"type": "StochasticSampling"}, "count_steps_by": "env_steps", "policy_map_capacity": 100, "policy_mapping_fn": "<function AlgorithmConfig.DEFAULT_POLICY_MAPPING_FN at 0x145c2d8a0>", "policies_to_train": null, "policy_states_are_swappable": false, "observation_fn": null, "offline_data_class": null, "input_read_method": "read_parquet", "input_read_method_kwargs": {}, "input_read_schema": {}, "input_read_episodes": false, "input_read_sample_batches": false, "input_read_batch_size": null, "input_filesystem": null, "input_filesystem_kwargs": {}, "input_compress_columns": ["obs", "new_obs"], "input_spaces_jsonable": true, "materialize_data": false, "materialize_mapped_data": true, "map_batches_kwargs": {}, "iter_batches_kwargs": {}, "ignore_final_observation": false, "prelearner_class": null, "prelearner_buffer_class": null, "prelearner_buffer_kwargs": {}, "prelearner_module_synch_period": 10, "dataset_num_iters_per_learner": null, "input_config": {}, "actions_in_input_normalized": false, "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_config": {}, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "output_max_rows_per_file": null, "output_write_remaining_data": false, "output_write_method": "write_parquet", "output_write_method_kwargs": {}, "output_filesystem": null, "output_filesystem_kwargs": {}, "output_write_episodes": true, "offline_sampling": false, "evaluation_interval": 1, "evaluation_duration": 20, "evaluation_duration_unit": "episodes", "evaluation_sample_timeout_s": 120.0, "evaluation_auto_duration_min_env_steps_per_sample": 100, "evaluation_auto_duration_max_env_steps_per_sample": 2000, "evaluation_parallel_to_training": false, "evaluation_force_reset_envs_before_iteration": true, "evaluation_config": null, "off_policy_estimation_methods": {}, "ope_split_batch_by_episode": true, "evaluation_num_env_runners": 1, "in_evaluation": false, "sync_filters_on_rollout_workers_timeout_s": 10.0, "offline_evaluation_interval": null, "num_offline_eval_runners": 0, "offline_loss_for_module_fn": null, "offline_evaluation_duration": 1, "offline_evaluation_parallel_to_training": false, "offline_evaluation_timeout_s": 120.0, "num_cpus_per_offline_eval_runner": 1, "num_gpus_per_offline_eval_runner": 0, "custom_resources_per_offline_eval_runner": {}, "restart_failed_offline_eval_runners": true, "ignore_offline_eval_runner_failures": false, "max_num_offline_eval_runner_restarts": 1000, "offline_eval_runner_restore_timeout_s": 1800.0, "max_requests_in_flight_per_offline_eval_runner": 1, "validate_offline_eval_runners_after_construction": true, "offline_eval_runner_health_probe_timeout_s": 30.0, "offline_eval_rl_module_inference_only": false, "broadcast_offline_eval_runner_states": false, "offline_eval_batch_size_per_runner": 256, "dataset_num_iters_per_eval_runner": 1, "keep_per_episode_custom_metrics": false, "metrics_episode_collection_timeout_s": 60.0, "metrics_num_episodes_for_smoothing": 100, "min_time_s_per_iteration": null, "min_train_timesteps_per_iteration": 0, "min_sample_timesteps_per_iteration": 0, "log_gradients": true, "export_native_model_files": false, "checkpoint_trainable_policies_only": false, "logger_creator": null, "logger_config": null, "log_level": "WARN", "log_sys_usage": true, "fake_sampler": false, "seed": 4, "restart_failed_env_runners": true, "ignore_env_runner_failures": false, "max_num_env_runner_restarts": 1000, "delay_between_env_runner_restarts_s": 60.0, "restart_failed_sub_environments": false, "num_consecutive_env_runner_failures_tolerance": 100, "env_runner_health_probe_timeout_s": 30.0, "env_runner_restore_timeout_s": 1800.0, "_model_config": {}, "_rl_module_spec": "RLModuleSpec(module_class=None, observation_space=None, action_space=None, inference_only=False, learner_only=False, model_config=DefaultModelConfig(fcnet_hiddens=[60, 90], fcnet_activation='tanh', fcnet_kernel_initializer=None, fcnet_kernel_initializer_kwargs=None, fcnet_bias_initializer=None, fcnet_bias_initializer_kwargs=None, conv_filters=None, conv_activation='relu', conv_kernel_initializer=None, conv_kernel_initializer_kwargs=None, conv_bias_initializer=None, conv_bias_initializer_kwargs=None, head_fcnet_hiddens=[], head_fcnet_activation='relu', head_fcnet_kernel_initializer=None, head_fcnet_kernel_initializer_kwargs=None, head_fcnet_bias_initializer=None, head_fcnet_bias_initializer_kwargs=None, free_log_std=False, log_std_clip_param=20.0, vf_share_layers=True, use_lstm=False, max_seq_len=20, lstm_cell_size=256, lstm_use_prev_action=False, lstm_use_prev_reward=False, lstm_kernel_initializer=None, lstm_kernel_initializer_kwargs=None, lstm_bias_initializer=None, lstm_bias_initializer_kwargs=None), catalog_class=None, load_state_path=None, model_config_dict=None)", "algorithm_config_overrides_per_module": {}, "_per_module_overrides": {}, "_validate_config": true, "_use_msgpack_checkpoints": false, "_torch_grad_scaler_class": null, "_torch_lr_scheduler_classes": null, "_tf_policy_handles_more_than_one_loss": false, "_disable_preprocessor_api": false, "_disable_action_flattening": false, "_disable_initialize_loss_from_dummy_batch": false, "_dont_auto_sync_env_runner_states": false, "env_task_fn": -1, "enable_connectors": -1, "simple_optimizer": false, "policy_map_cache": -1, "worker_cls": -1, "synchronize_filters": -1, "enable_async_evaluation": -1, "custom_async_evaluation_function": -1, "_enable_rl_module_api": -1, "auto_wrap_old_gym_envs": -1, "always_attach_evaluation_results": -1, "replay_sequence_length": null, "_disable_execution_plan_api": -1, "use_critic": true, "use_gae": true, "use_kl_loss": true, "kl_coeff": 0.7464963036515, "kl_target": 0.0270990929592, "vf_loss_coeff": 0.6688075857018, "entropy_coeff": 0.0090570820258, "clip_param": 0.1221781641624, "vf_clip_param": 0.1027808522125, "entropy_coeff_schedule": null, "lr_schedule": null, "sgd_minibatch_size": -1, "vf_share_layers": -1, "__stdout_file__": null, "__stderr_file__": null, "lambda": 0.9099046732075, "input": "sampler", "policies": {"default_policy": [null, null, null, null]}, "callbacks": "<class 'ray.rllib.callbacks.callbacks.RLlibCallback'>", "create_env_on_driver": false, "custom_eval_function": null, "framework": "torch"}, "time_since_restore": 32.43244671821594, "iterations_since_restore": 15, "perf": {"cpu_util_percent": 68.75, "ram_util_percent": 79.2}}
{"timers": {"training_iteration": 1.621467899900074, "restore_env_runners": 9.622006629643678e-06, "training_step": 1.6213400648249607, "env_runner_sampling_timer": 1.490148720042505, "learner_update_timer": 0.12805705658556324, "synch_weights": 0.0006615039614318758, "restore_eval_env_runners": 1.2148868748921183e-05, "evaluation_iteration": 0.10861268932246178, "synch_eval_env_connectors": 0.00012065466820340186, "synch_env_connectors": 4.867698603692454e-06}, "env_runners": {"num_episodes_lifetime": -431750.0, "episode_len_mean": 20.0, "env_to_module_connector": {"timers": {"connectors": {"batch_individual_items": 6.118471340196398e-06, "add_observations_from_episodes_to_batch": 2.9116533424391857e-06, "add_states_from_episodes_to_batch": 1.7308368246889473e-06, "numpy_to_tensor": 8.321836104357861e-06, "add_time_dim_to_batch_and_zero_pad": 2.356215809926083e-06}}, "connector_pipeline_timer": 4.27001849585339e-05}, "agent_episode_returns_mean": {"default_agent": 11.059999999999997}, "episode_return_max": 12.5, "num_module_steps_sampled_lifetime": {"default_policy": -8635000.0}, "env_step_timer": 1.3634879729971103e-05, "module_to_env_connector": {"timers": {"connectors": {"listify_data_for_vector_env": 1.0981444080357877e-05, "remove_single_ts_time_rank_from_batch": 5.771708970236226e-07, "tensor_to_numpy": 1.30459167778698e-05, "un_batch_to_individual_items": 5.288018982827065e-06, "get_actions": 3.815721582405598e-05, "normalize_and_clip_actions": 9.314699821328577e-06}}, "connector_pipeline_timer": 0.00010252055218361989}, "module_episode_returns_mean": {"default_policy": 11.059999999999997}, "num_env_steps_sampled_lifetime": -8635000.0, "episode_len_min": 20, "episode_return_min": -7.5, "time_between_sampling": 0.0018540629437668503, "num_env_steps_sampled": 5000.0, "num_module_steps_sampled": {"default_policy": 5000.0}, "num_episodes": 250.0, "episode_len_max": 20, "num_agent_steps_sampled": {"default_agent": 5000.0}, "episode_duration_sec_mean": 0.004481635659467428, "env_to_module_sum_episodes_length_in": 10.36823839457432, "num_agent_steps_sampled_lifetime": {"default_agent": -8635000.0}, "env_to_module_sum_episodes_length_out": 10.36823839457432, "rlmodule_inference_timer": 2.7102280055924027e-05, "episode_return_mean": 11.059999999999997, "sample": 0.004827776382213591, "env_reset_timer": 3.195678399468473e-05, "weights_seq_no": 15.0, "num_env_steps_sampled_lifetime_throughput": 3792.448532644766}, "learners": {"__all_modules__": {"num_non_trainable_parameters": 0, "learner_connector": {"timers": {"connectors": {"add_time_dim_to_batch_and_zero_pad": 1.1765436104374272e-05, "batch_individual_items": 0.03448828862935142, "add_one_ts_to_episodes_and_truncate": 0.008504015729571856, "general_advantage_estimation": 0.007478827447254391, "numpy_to_tensor": 6.751141553796761e-05, "add_observations_from_episodes_to_batch": 0.0008286934057779845, "add_states_from_episodes_to_batch": 3.18719234741701e-06, "add_columns_from_episodes_to_train_batch": 0.0347314896957389}}, "connector_pipeline_timer": 0.08622656131274085}, "num_env_steps_trained_lifetime": 504000, "num_env_steps_trained": 31500, "num_module_steps_trained_lifetime": 96000, "num_module_steps_trained": 6000, "learner_connector_sum_episodes_length_out": 5250.0, "num_trainable_parameters": 6003, "learner_connector_sum_episodes_length_in": 5000.0, "num_env_steps_trained_lifetime_throughput": 2409520.9429276492, "num_module_steps_trained_throughput": 460822.8620821518, "num_module_steps_trained_lifetime_throughput": 460128.4114822352}, "default_policy": {"diff_num_grad_updates_vs_sampler_policy": 1.0, "vf_loss_unclipped": 28.66145133972168, "num_module_steps_trained": 6000, "total_loss": -0.02420705370604992, "num_trainable_parameters": 6003, "gradients_default_optimizer_global_norm": 0.06402754038572311, "weights_seq_no": 16.0, "mean_kl_loss": 6.365888111758977e-05, "vf_explained_var": 0.015397906303405762, "vf_loss": 0.10245729237794876, "policy_loss": -0.08910641074180603, "default_optimizer_learning_rate": 0.0002847858517, "entropy": 0.4002242386341095, "num_module_steps_trained_lifetime": 96000, "curr_entropy_coeff": 0.0090570820258, "curr_kl_coeff": 1.1390629879315384e-05, "module_train_batch_size_mean": 1000.0, "num_module_steps_trained_lifetime_throughput": 461282.4808131808}}, "num_training_step_calls_per_iteration": 1, "evaluation": {"env_runners": {"num_agent_steps_sampled": {"default_agent": 400}, "num_env_steps_sampled_lifetime": 80400, "env_to_module_connector": {"timers": {"connectors": {"add_states_from_episodes_to_batch": 1.5432595701796413e-06, "batch_individual_items": 6.091965767592747e-06, "numpy_to_tensor": 8.000948633495722e-06, "add_observations_from_episodes_to_batch": 2.7307576872884237e-06, "add_time_dim_to_batch_and_zero_pad": 2.1677531745064173e-06}}, "connector_pipeline_timer": 4.171262927514296e-05}, "episode_return_min": -16.5, "num_episodes": 20, "num_episodes_lifetime": 320, "module_to_env_connector": {"timers": {"connectors": {"un_batch_to_individual_items": 5.165015104443201e-06, "normalize_and_clip_actions": 9.181446994230267e-06, "listify_data_for_vector_env": 1.0676737782286847e-05, "tensor_to_numpy": 1.2612560045348291e-05, "get_actions": 3.3858019407119995e-05, "remove_single_ts_time_rank_from_batch": 6.201516466437617e-07}}, "connector_pipeline_timer": 9.71082055975907e-05}, "episode_len_mean": 20.0, "weights_seq_no": 16.0, "episode_return_max": 12.5, "num_agent_steps_sampled_lifetime": {"default_agent": 6400}, "episode_len_min": 20, "num_env_steps_sampled": 400, "episode_duration_sec_mean": 0.004802624931326136, "module_episode_returns_mean": {"default_policy": 1.15}, "episode_return_mean": 1.15, "env_reset_timer": 0.00016234615315042608, "env_step_timer": 1.3480240150560125e-05, "num_module_steps_sampled": {"default_policy": 400}, "agent_episode_returns_mean": {"default_agent": 1.15}, "episode_len_max": 20, "env_to_module_sum_episodes_length_in": 10.368238394574323, "num_module_steps_sampled_lifetime": {"default_policy": 6400}, "env_to_module_sum_episodes_length_out": 10.368238394574323, "rlmodule_inference_timer": 2.6159416277484313e-05, "sample": 0.10222096328684266, "time_between_sampling": 1.6191588261780907}, "num_healthy_workers": 1, "actor_manager_num_outstanding_async_reqs": 0, "num_remote_worker_restarts": 0}, "num_env_steps_sampled_lifetime": -8635000.0, "fault_tolerance": {"num_healthy_workers": 0, "num_remote_worker_restarts": 0}, "env_runner_group": {"actor_manager_num_outstanding_async_reqs": 0}, "done": false, "training_iteration": 16, "trial_id": "49be2_00000", "date": "2025-08-11_19-36-43", "timestamp": 1754933803, "time_this_iter_s": 1.5509421825408936, "time_total_s": 33.983388900756836, "pid": 28164, "hostname": "Mac", "node_ip": "127.0.0.1", "config": {"exploration_config": {}, "extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "placement_strategy": "PACK", "num_gpus": 0, "_fake_gpus": false, "num_cpus_for_main_process": 2, "eager_tracing": true, "eager_max_retraces": 20, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "torch_compile_learner": false, "torch_compile_learner_what_to_compile": "forward_train", "torch_compile_learner_dynamo_backend": "aot_eager", "torch_compile_learner_dynamo_mode": null, "torch_compile_worker": false, "torch_compile_worker_dynamo_backend": "aot_eager", "torch_compile_worker_dynamo_mode": null, "torch_ddp_kwargs": {}, "torch_skip_nan_gradients": false, "env": "Umbrella", "env_config": {}, "observation_space": null, "action_space": null, "clip_rewards": null, "normalize_actions": true, "clip_actions": false, "_is_atari": null, "disable_env_checking": false, "render_env": false, "action_mask_key": "action_mask", "env_runner_cls": null, "num_env_runners": 0, "create_local_env_runner": true, "num_envs_per_env_runner": 1, "gym_env_vectorize_mode": "SYNC", "num_cpus_per_env_runner": 1, "num_gpus_per_env_runner": 0, "custom_resources_per_env_runner": {}, "validate_env_runners_after_construction": true, "episodes_to_numpy": true, "max_requests_in_flight_per_env_runner": 1, "sample_timeout_s": 60.0, "_env_to_module_connector": null, "add_default_connectors_to_env_to_module_pipeline": true, "_module_to_env_connector": null, "add_default_connectors_to_module_to_env_pipeline": true, "merge_env_runner_states": "training_only", "broadcast_env_runner_states": true, "episode_lookback_horizon": 1, "rollout_fragment_length": "auto", "batch_mode": "complete_episodes", "compress_observations": false, "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "enable_tf1_exec_eagerly": false, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "preprocessor_pref": "deepmind", "observation_filter": "NoFilter", "update_worker_filter_stats": true, "use_worker_filter_stats": true, "sampler_perf_stats_ema_coef": null, "_is_online": true, "num_learners": 0, "num_gpus_per_learner": 0, "num_cpus_per_learner": "auto", "num_aggregator_actors_per_learner": 0, "max_requests_in_flight_per_aggregator_actor": 3, "local_gpu_idx": 0, "max_requests_in_flight_per_learner": 3, "gamma": 1, "lr": 0.0002847858517, "grad_clip": 0.5, "grad_clip_by": "global_norm", "_train_batch_size_per_learner": 5000, "train_batch_size": 4000, "num_epochs": 1, "minibatch_size": 1000, "shuffle_batch_per_epoch": true, "model": {"fcnet_hiddens": [256, 256], "fcnet_activation": "tanh", "fcnet_weights_initializer": null, "fcnet_weights_initializer_config": null, "fcnet_bias_initializer": null, "fcnet_bias_initializer_config": null, "conv_filters": null, "conv_activation": "relu", "conv_kernel_initializer": null, "conv_kernel_initializer_config": null, "conv_bias_initializer": null, "conv_bias_initializer_config": null, "conv_transpose_kernel_initializer": null, "conv_transpose_kernel_initializer_config": null, "conv_transpose_bias_initializer": null, "conv_transpose_bias_initializer_config": null, "post_fcnet_hiddens": [], "post_fcnet_activation": "relu", "post_fcnet_weights_initializer": null, "post_fcnet_weights_initializer_config": null, "post_fcnet_bias_initializer": null, "post_fcnet_bias_initializer_config": null, "free_log_std": false, "log_std_clip_param": 20.0, "no_final_linear": false, "vf_share_layers": false, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "lstm_weights_initializer": null, "lstm_weights_initializer_config": null, "lstm_bias_initializer": null, "lstm_bias_initializer_config": null, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "attention_use_n_prev_actions": 0, "attention_use_n_prev_rewards": 0, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": null, "custom_model_config": {}, "custom_action_dist": null, "custom_preprocessor": null, "encoder_latent_dim": null, "always_check_shapes": false, "lstm_use_prev_action_reward": -1, "_use_default_native_models": -1, "_disable_preprocessor_api": false, "_disable_action_flattening": false}, "_learner_connector": null, "add_default_connectors_to_learner_pipeline": true, "learner_config_dict": {}, "optimizer": {}, "_learner_class": null, "callbacks_on_algorithm_init": null, "callbacks_on_env_runners_recreated": null, "callbacks_on_offline_eval_runners_recreated": null, "callbacks_on_checkpoint_loaded": null, "callbacks_on_environment_created": null, "callbacks_on_episode_created": null, "callbacks_on_episode_start": null, "callbacks_on_episode_step": null, "callbacks_on_episode_end": null, "callbacks_on_evaluate_start": null, "callbacks_on_evaluate_end": null, "callbacks_on_evaluate_offline_start": null, "callbacks_on_evaluate_offline_end": null, "callbacks_on_sample_end": null, "callbacks_on_train_result": null, "explore": true, "enable_rl_module_and_learner": true, "enable_env_runner_and_connector_v2": true, "_prior_exploration_config": {"type": "StochasticSampling"}, "count_steps_by": "env_steps", "policy_map_capacity": 100, "policy_mapping_fn": "<function AlgorithmConfig.DEFAULT_POLICY_MAPPING_FN at 0x145c2d8a0>", "policies_to_train": null, "policy_states_are_swappable": false, "observation_fn": null, "offline_data_class": null, "input_read_method": "read_parquet", "input_read_method_kwargs": {}, "input_read_schema": {}, "input_read_episodes": false, "input_read_sample_batches": false, "input_read_batch_size": null, "input_filesystem": null, "input_filesystem_kwargs": {}, "input_compress_columns": ["obs", "new_obs"], "input_spaces_jsonable": true, "materialize_data": false, "materialize_mapped_data": true, "map_batches_kwargs": {}, "iter_batches_kwargs": {}, "ignore_final_observation": false, "prelearner_class": null, "prelearner_buffer_class": null, "prelearner_buffer_kwargs": {}, "prelearner_module_synch_period": 10, "dataset_num_iters_per_learner": null, "input_config": {}, "actions_in_input_normalized": false, "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_config": {}, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "output_max_rows_per_file": null, "output_write_remaining_data": false, "output_write_method": "write_parquet", "output_write_method_kwargs": {}, "output_filesystem": null, "output_filesystem_kwargs": {}, "output_write_episodes": true, "offline_sampling": false, "evaluation_interval": 1, "evaluation_duration": 20, "evaluation_duration_unit": "episodes", "evaluation_sample_timeout_s": 120.0, "evaluation_auto_duration_min_env_steps_per_sample": 100, "evaluation_auto_duration_max_env_steps_per_sample": 2000, "evaluation_parallel_to_training": false, "evaluation_force_reset_envs_before_iteration": true, "evaluation_config": null, "off_policy_estimation_methods": {}, "ope_split_batch_by_episode": true, "evaluation_num_env_runners": 1, "in_evaluation": false, "sync_filters_on_rollout_workers_timeout_s": 10.0, "offline_evaluation_interval": null, "num_offline_eval_runners": 0, "offline_loss_for_module_fn": null, "offline_evaluation_duration": 1, "offline_evaluation_parallel_to_training": false, "offline_evaluation_timeout_s": 120.0, "num_cpus_per_offline_eval_runner": 1, "num_gpus_per_offline_eval_runner": 0, "custom_resources_per_offline_eval_runner": {}, "restart_failed_offline_eval_runners": true, "ignore_offline_eval_runner_failures": false, "max_num_offline_eval_runner_restarts": 1000, "offline_eval_runner_restore_timeout_s": 1800.0, "max_requests_in_flight_per_offline_eval_runner": 1, "validate_offline_eval_runners_after_construction": true, "offline_eval_runner_health_probe_timeout_s": 30.0, "offline_eval_rl_module_inference_only": false, "broadcast_offline_eval_runner_states": false, "offline_eval_batch_size_per_runner": 256, "dataset_num_iters_per_eval_runner": 1, "keep_per_episode_custom_metrics": false, "metrics_episode_collection_timeout_s": 60.0, "metrics_num_episodes_for_smoothing": 100, "min_time_s_per_iteration": null, "min_train_timesteps_per_iteration": 0, "min_sample_timesteps_per_iteration": 0, "log_gradients": true, "export_native_model_files": false, "checkpoint_trainable_policies_only": false, "logger_creator": null, "logger_config": null, "log_level": "WARN", "log_sys_usage": true, "fake_sampler": false, "seed": 4, "restart_failed_env_runners": true, "ignore_env_runner_failures": false, "max_num_env_runner_restarts": 1000, "delay_between_env_runner_restarts_s": 60.0, "restart_failed_sub_environments": false, "num_consecutive_env_runner_failures_tolerance": 100, "env_runner_health_probe_timeout_s": 30.0, "env_runner_restore_timeout_s": 1800.0, "_model_config": {}, "_rl_module_spec": "RLModuleSpec(module_class=None, observation_space=None, action_space=None, inference_only=False, learner_only=False, model_config=DefaultModelConfig(fcnet_hiddens=[60, 90], fcnet_activation='tanh', fcnet_kernel_initializer=None, fcnet_kernel_initializer_kwargs=None, fcnet_bias_initializer=None, fcnet_bias_initializer_kwargs=None, conv_filters=None, conv_activation='relu', conv_kernel_initializer=None, conv_kernel_initializer_kwargs=None, conv_bias_initializer=None, conv_bias_initializer_kwargs=None, head_fcnet_hiddens=[], head_fcnet_activation='relu', head_fcnet_kernel_initializer=None, head_fcnet_kernel_initializer_kwargs=None, head_fcnet_bias_initializer=None, head_fcnet_bias_initializer_kwargs=None, free_log_std=False, log_std_clip_param=20.0, vf_share_layers=True, use_lstm=False, max_seq_len=20, lstm_cell_size=256, lstm_use_prev_action=False, lstm_use_prev_reward=False, lstm_kernel_initializer=None, lstm_kernel_initializer_kwargs=None, lstm_bias_initializer=None, lstm_bias_initializer_kwargs=None), catalog_class=None, load_state_path=None, model_config_dict=None)", "algorithm_config_overrides_per_module": {}, "_per_module_overrides": {}, "_validate_config": true, "_use_msgpack_checkpoints": false, "_torch_grad_scaler_class": null, "_torch_lr_scheduler_classes": null, "_tf_policy_handles_more_than_one_loss": false, "_disable_preprocessor_api": false, "_disable_action_flattening": false, "_disable_initialize_loss_from_dummy_batch": false, "_dont_auto_sync_env_runner_states": false, "env_task_fn": -1, "enable_connectors": -1, "simple_optimizer": false, "policy_map_cache": -1, "worker_cls": -1, "synchronize_filters": -1, "enable_async_evaluation": -1, "custom_async_evaluation_function": -1, "_enable_rl_module_api": -1, "auto_wrap_old_gym_envs": -1, "always_attach_evaluation_results": -1, "replay_sequence_length": null, "_disable_execution_plan_api": -1, "use_critic": true, "use_gae": true, "use_kl_loss": true, "kl_coeff": 0.7464963036515, "kl_target": 0.0270990929592, "vf_loss_coeff": 0.6688075857018, "entropy_coeff": 0.0090570820258, "clip_param": 0.1221781641624, "vf_clip_param": 0.1027808522125, "entropy_coeff_schedule": null, "lr_schedule": null, "sgd_minibatch_size": -1, "vf_share_layers": -1, "__stdout_file__": null, "__stderr_file__": null, "lambda": 0.9099046732075, "input": "sampler", "policies": {"default_policy": [null, null, null, null]}, "callbacks": "<class 'ray.rllib.callbacks.callbacks.RLlibCallback'>", "create_env_on_driver": false, "custom_eval_function": null, "framework": "torch"}, "time_since_restore": 33.983388900756836, "iterations_since_restore": 16, "perf": {"cpu_util_percent": 55.13333333333333, "ram_util_percent": 79.03333333333333}}
{"timers": {"training_iteration": 1.6206888313204453, "restore_env_runners": 9.57703724462833e-06, "training_step": 1.6205607504273178, "env_runner_sampling_timer": 1.4897414374214666, "learner_update_timer": 0.12768659017897338, "synch_weights": 0.000660457251760901, "restore_eval_env_runners": 1.2096130293890085e-05, "evaluation_iteration": 0.10851796367901283, "synch_eval_env_connectors": 0.00012035812146563749, "synch_env_connectors": 4.865680878643765e-06}, "env_runners": {"num_episodes_lifetime": -462625.0, "episode_len_mean": 20.0, "env_to_module_connector": {"timers": {"connectors": {"batch_individual_items": 6.225642899069094e-06, "add_observations_from_episodes_to_batch": 3.0225895864978527e-06, "add_states_from_episodes_to_batch": 1.756838261795226e-06, "numpy_to_tensor": 8.4292528857432e-06, "add_time_dim_to_batch_and_zero_pad": 2.391363296094232e-06}}, "connector_pipeline_timer": 4.33756333161439e-05}, "agent_episode_returns_mean": {"default_agent": 10.5}, "episode_return_max": 12.5, "num_module_steps_sampled_lifetime": {"default_policy": -9252500.0}, "env_step_timer": 1.3740034880943635e-05, "module_to_env_connector": {"timers": {"connectors": {"listify_data_for_vector_env": 1.1087293387271025e-05, "remove_single_ts_time_rank_from_batch": 5.898683081701405e-07, "tensor_to_numpy": 1.317684278891654e-05, "un_batch_to_individual_items": 5.373810086845314e-06, "get_actions": 3.826430299181724e-05, "normalize_and_clip_actions": 9.415064677201876e-06}}, "connector_pipeline_timer": 0.00010336846982790418}, "module_episode_returns_mean": {"default_policy": 10.5}, "num_env_steps_sampled_lifetime": -9252500.0, "episode_len_min": 20, "episode_return_min": -7.5, "time_between_sampling": 0.0014824443409255, "num_env_steps_sampled": 5000.0, "num_module_steps_sampled": {"default_policy": 5000.0}, "num_episodes": 250.0, "episode_len_max": 20, "num_agent_steps_sampled": {"default_agent": 5000.0}, "episode_duration_sec_mean": 0.004866743828169999, "env_to_module_sum_episodes_length_in": 10.36823839457432, "num_agent_steps_sampled_lifetime": {"default_agent": -9252500.0}, "env_to_module_sum_episodes_length_out": 10.36823839457432, "rlmodule_inference_timer": 4.300542857167711e-05, "episode_return_mean": 10.5, "sample": 0.005030250938508872, "env_reset_timer": 3.070190988955534e-05, "weights_seq_no": 16.0, "num_env_steps_sampled_lifetime_throughput": 3750.01138132314}, "learners": {"__all_modules__": {"num_non_trainable_parameters": 0, "learner_connector": {"timers": {"connectors": {"add_time_dim_to_batch_and_zero_pad": 1.1736952387390307e-05, "batch_individual_items": 0.034440832822698234, "add_one_ts_to_episodes_and_truncate": 0.008496707651938521, "general_advantage_estimation": 0.007457130833156623, "numpy_to_tensor": 6.734255203600386e-05, "add_observations_from_episodes_to_batch": 0.0008310698020423361, "add_states_from_episodes_to_batch": 3.1807408736169693e-06, "add_columns_from_episodes_to_train_batch": 0.0347293306295094}}, "connector_pipeline_timer": 0.08614980445031849}, "num_env_steps_trained_lifetime": 535500, "num_env_steps_trained": 31500, "num_module_steps_trained_lifetime": 102000, "num_module_steps_trained": 6000, "learner_connector_sum_episodes_length_out": 5250.0, "num_trainable_parameters": 6003, "learner_connector_sum_episodes_length_in": 5000.0, "num_env_steps_trained_lifetime_throughput": 2400552.278826401, "num_module_steps_trained_throughput": 459034.7805520356, "num_module_steps_trained_lifetime_throughput": 458365.0419826323}, "default_policy": {"diff_num_grad_updates_vs_sampler_policy": 1.0, "vf_loss_unclipped": 28.645084381103516, "num_module_steps_trained": 6000, "total_loss": -0.03301073610782623, "num_trainable_parameters": 6003, "gradients_default_optimizer_global_norm": 0.12811815738677979, "weights_seq_no": 17.0, "mean_kl_loss": 0.00011660082236630842, "vf_explained_var": 0.01704394817352295, "vf_loss": 0.10234946012496948, "policy_loss": -0.09787576645612717, "default_optimizer_learning_rate": 0.0002847858517, "entropy": 0.3960508704185486, "num_module_steps_trained_lifetime": 102000, "curr_entropy_coeff": 0.0090570820258, "curr_kl_coeff": 5.695314939657692e-06, "module_train_batch_size_mean": 1000.0, "num_module_steps_trained_lifetime_throughput": 459434.00318775605}}, "num_training_step_calls_per_iteration": 1, "evaluation": {"env_runners": {"num_agent_steps_sampled": {"default_agent": 400}, "num_env_steps_sampled_lifetime": 85400, "env_to_module_connector": {"timers": {"connectors": {"add_states_from_episodes_to_batch": 1.6076568424394005e-06, "batch_individual_items": 6.194086820851652e-06, "numpy_to_tensor": 8.507440338404752e-06, "add_observations_from_episodes_to_batch": 2.8162728515417186e-06, "add_time_dim_to_batch_and_zero_pad": 2.240598577587767e-06}}, "connector_pipeline_timer": 4.2827992010694416e-05}, "episode_return_min": -16.5, "num_episodes": 20, "num_episodes_lifetime": 340, "module_to_env_connector": {"timers": {"connectors": {"un_batch_to_individual_items": 5.356443832833476e-06, "normalize_and_clip_actions": 9.257023629315018e-06, "listify_data_for_vector_env": 1.095358709599589e-05, "tensor_to_numpy": 1.3077248285830548e-05, "get_actions": 3.583453612994961e-05, "remove_single_ts_time_rank_from_batch": 6.332048897631984e-07}}, "connector_pipeline_timer": 0.0001005356806933549}, "episode_len_mean": 20.0, "weights_seq_no": 17.0, "episode_return_max": 12.5, "num_agent_steps_sampled_lifetime": {"default_agent": 6800}, "episode_len_min": 20, "num_env_steps_sampled": 400, "episode_duration_sec_mean": 0.004496964951977133, "module_episode_returns_mean": {"default_policy": 1.15}, "episode_return_mean": 1.15, "env_reset_timer": 0.00016139102150415128, "env_step_timer": 1.4040398746098307e-05, "num_module_steps_sampled": {"default_policy": 400}, "agent_episode_returns_mean": {"default_agent": 1.15}, "episode_len_max": 20, "env_to_module_sum_episodes_length_in": 10.368238394574323, "num_module_steps_sampled_lifetime": {"default_policy": 6800}, "env_to_module_sum_episodes_length_out": 10.368238394574323, "rlmodule_inference_timer": 2.706750797301332e-05, "sample": 0.10217526240385598, "time_between_sampling": 1.61856675750576}, "num_healthy_workers": 1, "actor_manager_num_outstanding_async_reqs": 0, "num_remote_worker_restarts": 0}, "num_env_steps_sampled_lifetime": -9252500.0, "fault_tolerance": {"num_healthy_workers": 0, "num_remote_worker_restarts": 0}, "env_runner_group": {"actor_manager_num_outstanding_async_reqs": 0}, "done": false, "training_iteration": 17, "trial_id": "49be2_00000", "date": "2025-08-11_19-36-45", "timestamp": 1754933805, "time_this_iter_s": 1.648155927658081, "time_total_s": 35.63154482841492, "pid": 28164, "hostname": "Mac", "node_ip": "127.0.0.1", "config": {"exploration_config": {}, "extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "placement_strategy": "PACK", "num_gpus": 0, "_fake_gpus": false, "num_cpus_for_main_process": 2, "eager_tracing": true, "eager_max_retraces": 20, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "torch_compile_learner": false, "torch_compile_learner_what_to_compile": "forward_train", "torch_compile_learner_dynamo_backend": "aot_eager", "torch_compile_learner_dynamo_mode": null, "torch_compile_worker": false, "torch_compile_worker_dynamo_backend": "aot_eager", "torch_compile_worker_dynamo_mode": null, "torch_ddp_kwargs": {}, "torch_skip_nan_gradients": false, "env": "Umbrella", "env_config": {}, "observation_space": null, "action_space": null, "clip_rewards": null, "normalize_actions": true, "clip_actions": false, "_is_atari": null, "disable_env_checking": false, "render_env": false, "action_mask_key": "action_mask", "env_runner_cls": null, "num_env_runners": 0, "create_local_env_runner": true, "num_envs_per_env_runner": 1, "gym_env_vectorize_mode": "SYNC", "num_cpus_per_env_runner": 1, "num_gpus_per_env_runner": 0, "custom_resources_per_env_runner": {}, "validate_env_runners_after_construction": true, "episodes_to_numpy": true, "max_requests_in_flight_per_env_runner": 1, "sample_timeout_s": 60.0, "_env_to_module_connector": null, "add_default_connectors_to_env_to_module_pipeline": true, "_module_to_env_connector": null, "add_default_connectors_to_module_to_env_pipeline": true, "merge_env_runner_states": "training_only", "broadcast_env_runner_states": true, "episode_lookback_horizon": 1, "rollout_fragment_length": "auto", "batch_mode": "complete_episodes", "compress_observations": false, "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "enable_tf1_exec_eagerly": false, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "preprocessor_pref": "deepmind", "observation_filter": "NoFilter", "update_worker_filter_stats": true, "use_worker_filter_stats": true, "sampler_perf_stats_ema_coef": null, "_is_online": true, "num_learners": 0, "num_gpus_per_learner": 0, "num_cpus_per_learner": "auto", "num_aggregator_actors_per_learner": 0, "max_requests_in_flight_per_aggregator_actor": 3, "local_gpu_idx": 0, "max_requests_in_flight_per_learner": 3, "gamma": 1, "lr": 0.0002847858517, "grad_clip": 0.5, "grad_clip_by": "global_norm", "_train_batch_size_per_learner": 5000, "train_batch_size": 4000, "num_epochs": 1, "minibatch_size": 1000, "shuffle_batch_per_epoch": true, "model": {"fcnet_hiddens": [256, 256], "fcnet_activation": "tanh", "fcnet_weights_initializer": null, "fcnet_weights_initializer_config": null, "fcnet_bias_initializer": null, "fcnet_bias_initializer_config": null, "conv_filters": null, "conv_activation": "relu", "conv_kernel_initializer": null, "conv_kernel_initializer_config": null, "conv_bias_initializer": null, "conv_bias_initializer_config": null, "conv_transpose_kernel_initializer": null, "conv_transpose_kernel_initializer_config": null, "conv_transpose_bias_initializer": null, "conv_transpose_bias_initializer_config": null, "post_fcnet_hiddens": [], "post_fcnet_activation": "relu", "post_fcnet_weights_initializer": null, "post_fcnet_weights_initializer_config": null, "post_fcnet_bias_initializer": null, "post_fcnet_bias_initializer_config": null, "free_log_std": false, "log_std_clip_param": 20.0, "no_final_linear": false, "vf_share_layers": false, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "lstm_weights_initializer": null, "lstm_weights_initializer_config": null, "lstm_bias_initializer": null, "lstm_bias_initializer_config": null, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "attention_use_n_prev_actions": 0, "attention_use_n_prev_rewards": 0, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": null, "custom_model_config": {}, "custom_action_dist": null, "custom_preprocessor": null, "encoder_latent_dim": null, "always_check_shapes": false, "lstm_use_prev_action_reward": -1, "_use_default_native_models": -1, "_disable_preprocessor_api": false, "_disable_action_flattening": false}, "_learner_connector": null, "add_default_connectors_to_learner_pipeline": true, "learner_config_dict": {}, "optimizer": {}, "_learner_class": null, "callbacks_on_algorithm_init": null, "callbacks_on_env_runners_recreated": null, "callbacks_on_offline_eval_runners_recreated": null, "callbacks_on_checkpoint_loaded": null, "callbacks_on_environment_created": null, "callbacks_on_episode_created": null, "callbacks_on_episode_start": null, "callbacks_on_episode_step": null, "callbacks_on_episode_end": null, "callbacks_on_evaluate_start": null, "callbacks_on_evaluate_end": null, "callbacks_on_evaluate_offline_start": null, "callbacks_on_evaluate_offline_end": null, "callbacks_on_sample_end": null, "callbacks_on_train_result": null, "explore": true, "enable_rl_module_and_learner": true, "enable_env_runner_and_connector_v2": true, "_prior_exploration_config": {"type": "StochasticSampling"}, "count_steps_by": "env_steps", "policy_map_capacity": 100, "policy_mapping_fn": "<function AlgorithmConfig.DEFAULT_POLICY_MAPPING_FN at 0x145c2d8a0>", "policies_to_train": null, "policy_states_are_swappable": false, "observation_fn": null, "offline_data_class": null, "input_read_method": "read_parquet", "input_read_method_kwargs": {}, "input_read_schema": {}, "input_read_episodes": false, "input_read_sample_batches": false, "input_read_batch_size": null, "input_filesystem": null, "input_filesystem_kwargs": {}, "input_compress_columns": ["obs", "new_obs"], "input_spaces_jsonable": true, "materialize_data": false, "materialize_mapped_data": true, "map_batches_kwargs": {}, "iter_batches_kwargs": {}, "ignore_final_observation": false, "prelearner_class": null, "prelearner_buffer_class": null, "prelearner_buffer_kwargs": {}, "prelearner_module_synch_period": 10, "dataset_num_iters_per_learner": null, "input_config": {}, "actions_in_input_normalized": false, "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_config": {}, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "output_max_rows_per_file": null, "output_write_remaining_data": false, "output_write_method": "write_parquet", "output_write_method_kwargs": {}, "output_filesystem": null, "output_filesystem_kwargs": {}, "output_write_episodes": true, "offline_sampling": false, "evaluation_interval": 1, "evaluation_duration": 20, "evaluation_duration_unit": "episodes", "evaluation_sample_timeout_s": 120.0, "evaluation_auto_duration_min_env_steps_per_sample": 100, "evaluation_auto_duration_max_env_steps_per_sample": 2000, "evaluation_parallel_to_training": false, "evaluation_force_reset_envs_before_iteration": true, "evaluation_config": null, "off_policy_estimation_methods": {}, "ope_split_batch_by_episode": true, "evaluation_num_env_runners": 1, "in_evaluation": false, "sync_filters_on_rollout_workers_timeout_s": 10.0, "offline_evaluation_interval": null, "num_offline_eval_runners": 0, "offline_loss_for_module_fn": null, "offline_evaluation_duration": 1, "offline_evaluation_parallel_to_training": false, "offline_evaluation_timeout_s": 120.0, "num_cpus_per_offline_eval_runner": 1, "num_gpus_per_offline_eval_runner": 0, "custom_resources_per_offline_eval_runner": {}, "restart_failed_offline_eval_runners": true, "ignore_offline_eval_runner_failures": false, "max_num_offline_eval_runner_restarts": 1000, "offline_eval_runner_restore_timeout_s": 1800.0, "max_requests_in_flight_per_offline_eval_runner": 1, "validate_offline_eval_runners_after_construction": true, "offline_eval_runner_health_probe_timeout_s": 30.0, "offline_eval_rl_module_inference_only": false, "broadcast_offline_eval_runner_states": false, "offline_eval_batch_size_per_runner": 256, "dataset_num_iters_per_eval_runner": 1, "keep_per_episode_custom_metrics": false, "metrics_episode_collection_timeout_s": 60.0, "metrics_num_episodes_for_smoothing": 100, "min_time_s_per_iteration": null, "min_train_timesteps_per_iteration": 0, "min_sample_timesteps_per_iteration": 0, "log_gradients": true, "export_native_model_files": false, "checkpoint_trainable_policies_only": false, "logger_creator": null, "logger_config": null, "log_level": "WARN", "log_sys_usage": true, "fake_sampler": false, "seed": 4, "restart_failed_env_runners": true, "ignore_env_runner_failures": false, "max_num_env_runner_restarts": 1000, "delay_between_env_runner_restarts_s": 60.0, "restart_failed_sub_environments": false, "num_consecutive_env_runner_failures_tolerance": 100, "env_runner_health_probe_timeout_s": 30.0, "env_runner_restore_timeout_s": 1800.0, "_model_config": {}, "_rl_module_spec": "RLModuleSpec(module_class=None, observation_space=None, action_space=None, inference_only=False, learner_only=False, model_config=DefaultModelConfig(fcnet_hiddens=[60, 90], fcnet_activation='tanh', fcnet_kernel_initializer=None, fcnet_kernel_initializer_kwargs=None, fcnet_bias_initializer=None, fcnet_bias_initializer_kwargs=None, conv_filters=None, conv_activation='relu', conv_kernel_initializer=None, conv_kernel_initializer_kwargs=None, conv_bias_initializer=None, conv_bias_initializer_kwargs=None, head_fcnet_hiddens=[], head_fcnet_activation='relu', head_fcnet_kernel_initializer=None, head_fcnet_kernel_initializer_kwargs=None, head_fcnet_bias_initializer=None, head_fcnet_bias_initializer_kwargs=None, free_log_std=False, log_std_clip_param=20.0, vf_share_layers=True, use_lstm=False, max_seq_len=20, lstm_cell_size=256, lstm_use_prev_action=False, lstm_use_prev_reward=False, lstm_kernel_initializer=None, lstm_kernel_initializer_kwargs=None, lstm_bias_initializer=None, lstm_bias_initializer_kwargs=None), catalog_class=None, load_state_path=None, model_config_dict=None)", "algorithm_config_overrides_per_module": {}, "_per_module_overrides": {}, "_validate_config": true, "_use_msgpack_checkpoints": false, "_torch_grad_scaler_class": null, "_torch_lr_scheduler_classes": null, "_tf_policy_handles_more_than_one_loss": false, "_disable_preprocessor_api": false, "_disable_action_flattening": false, "_disable_initialize_loss_from_dummy_batch": false, "_dont_auto_sync_env_runner_states": false, "env_task_fn": -1, "enable_connectors": -1, "simple_optimizer": false, "policy_map_cache": -1, "worker_cls": -1, "synchronize_filters": -1, "enable_async_evaluation": -1, "custom_async_evaluation_function": -1, "_enable_rl_module_api": -1, "auto_wrap_old_gym_envs": -1, "always_attach_evaluation_results": -1, "replay_sequence_length": null, "_disable_execution_plan_api": -1, "use_critic": true, "use_gae": true, "use_kl_loss": true, "kl_coeff": 0.7464963036515, "kl_target": 0.0270990929592, "vf_loss_coeff": 0.6688075857018, "entropy_coeff": 0.0090570820258, "clip_param": 0.1221781641624, "vf_clip_param": 0.1027808522125, "entropy_coeff_schedule": null, "lr_schedule": null, "sgd_minibatch_size": -1, "vf_share_layers": -1, "__stdout_file__": null, "__stderr_file__": null, "lambda": 0.9099046732075, "input": "sampler", "policies": {"default_policy": [null, null, null, null]}, "callbacks": "<class 'ray.rllib.callbacks.callbacks.RLlibCallback'>", "create_env_on_driver": false, "custom_eval_function": null, "framework": "torch"}, "time_since_restore": 35.63154482841492, "iterations_since_restore": 17, "perf": {"cpu_util_percent": 51.0, "ram_util_percent": 78.80000000000001}}
{"timers": {"training_iteration": 1.620806469677164, "restore_env_runners": 9.529596693038498e-06, "training_step": 1.620677924173391, "env_runner_sampling_timer": 1.4893079376369756, "learner_update_timer": 0.12823729635725753, "synch_weights": 0.0006596618492044315, "restore_eval_env_runners": 1.2057669037070278e-05, "evaluation_iteration": 0.1084556336222629, "synch_eval_env_connectors": 0.00012001912075743998, "synch_env_connectors": 4.859104716238109e-06}, "env_runners": {"num_episodes_lifetime": -493500.0, "episode_len_mean": 20.0, "env_to_module_connector": {"timers": {"connectors": {"batch_individual_items": 6.48413745378867e-06, "add_observations_from_episodes_to_batch": 3.023308085683833e-06, "add_states_from_episodes_to_batch": 1.7474951568036166e-06, "numpy_to_tensor": 9.132936937895637e-06, "add_time_dim_to_batch_and_zero_pad": 2.492945040813682e-06}}, "connector_pipeline_timer": 4.51188018158518e-05}, "agent_episode_returns_mean": {"default_agent": 10.980000000000002}, "episode_return_max": 12.5, "num_module_steps_sampled_lifetime": {"default_policy": -9870000.0}, "env_step_timer": 1.428077436698237e-05, "module_to_env_connector": {"timers": {"connectors": {"listify_data_for_vector_env": 1.146815953742834e-05, "remove_single_ts_time_rank_from_batch": 6.020738815170066e-07, "tensor_to_numpy": 1.3716454358601618e-05, "un_batch_to_individual_items": 5.539212861750955e-06, "get_actions": 4.070637194698189e-05, "normalize_and_clip_actions": 9.721553470148973e-06}}, "connector_pipeline_timer": 0.00010775764813219297}, "module_episode_returns_mean": {"default_policy": 10.980000000000002}, "num_env_steps_sampled_lifetime": -9870000.0, "episode_len_min": 20, "episode_return_min": -7.5, "time_between_sampling": 0.0014709527262305522, "num_env_steps_sampled": 5000.0, "num_module_steps_sampled": {"default_policy": 5000.0}, "num_episodes": 250.0, "episode_len_max": 20, "num_agent_steps_sampled": {"default_agent": 5000.0}, "episode_duration_sec_mean": 0.004762635640334338, "env_to_module_sum_episodes_length_in": 10.36823839457432, "num_agent_steps_sampled_lifetime": {"default_agent": -9870000.0}, "env_to_module_sum_episodes_length_out": 10.36823839457432, "rlmodule_inference_timer": 2.9110744498016463e-05, "episode_return_mean": 10.980000000000002, "sample": 0.005013268223556869, "env_reset_timer": 3.450963129841494e-05, "weights_seq_no": 17.0, "num_env_steps_sampled_lifetime_throughput": 3710.939052168778}, "learners": {"__all_modules__": {"num_non_trainable_parameters": 0, "learner_connector": {"timers": {"connectors": {"add_time_dim_to_batch_and_zero_pad": 1.1765003062776519e-05, "batch_individual_items": 0.03527555199439809, "add_one_ts_to_episodes_and_truncate": 0.008492001825678492, "general_advantage_estimation": 0.007433825364545201, "numpy_to_tensor": 6.729620695989035e-05, "add_observations_from_episodes_to_batch": 0.0008313924340206146, "add_states_from_episodes_to_batch": 3.182683430831646e-06, "add_columns_from_episodes_to_train_batch": 0.03475018524286729}}, "connector_pipeline_timer": 0.08697758181584161}, "num_env_steps_trained_lifetime": 567000, "num_env_steps_trained": 31500, "num_module_steps_trained_lifetime": 108000, "num_module_steps_trained": 6000, "learner_connector_sum_episodes_length_out": 5250.0, "num_trainable_parameters": 6003, "learner_connector_sum_episodes_length_in": 5000.0, "num_env_steps_trained_lifetime_throughput": 2391127.7428700137, "num_module_steps_trained_throughput": 457164.1261616484, "num_module_steps_trained_lifetime_throughput": 456517.54492566513}, "default_policy": {"diff_num_grad_updates_vs_sampler_policy": 1.0, "vf_loss_unclipped": 28.66659927368164, "num_module_steps_trained": 6000, "total_loss": -0.03549296036362648, "num_trainable_parameters": 6003, "gradients_default_optimizer_global_norm": 0.10874442011117935, "weights_seq_no": 18.0, "mean_kl_loss": 0.0005068923346698284, "vf_explained_var": 0.015502631664276123, "vf_loss": 0.10245733708143234, "policy_loss": -0.10068020969629288, "default_optimizer_learning_rate": 0.0002847858517, "entropy": 0.36843931674957275, "num_module_steps_trained_lifetime": 108000, "curr_entropy_coeff": 0.0090570820258, "curr_kl_coeff": 2.847657469828846e-06, "module_train_batch_size_mean": 1000.0, "num_module_steps_trained_lifetime_throughput": 457508.08059489727}}, "num_training_step_calls_per_iteration": 1, "evaluation": {"env_runners": {"num_agent_steps_sampled": {"default_agent": 400}, "num_env_steps_sampled_lifetime": 90400, "env_to_module_connector": {"timers": {"connectors": {"add_states_from_episodes_to_batch": 1.570258280685714e-06, "batch_individual_items": 6.140927086670994e-06, "numpy_to_tensor": 8.25326120411407e-06, "add_observations_from_episodes_to_batch": 2.7134263232169713e-06, "add_time_dim_to_batch_and_zero_pad": 2.160724428892311e-06}}, "connector_pipeline_timer": 4.201893601223974e-05}, "episode_return_min": -16.5, "num_episodes": 20, "num_episodes_lifetime": 360, "module_to_env_connector": {"timers": {"connectors": {"un_batch_to_individual_items": 5.176618376627471e-06, "normalize_and_clip_actions": 9.190553951227318e-06, "listify_data_for_vector_env": 1.0892516495934462e-05, "tensor_to_numpy": 1.28159924721606e-05, "get_actions": 3.4553905478846666e-05, "remove_single_ts_time_rank_from_batch": 6.286687032848e-07}}, "connector_pipeline_timer": 9.826847032997541e-05}, "episode_len_mean": 20.0, "weights_seq_no": 18.0, "episode_return_max": 12.5, "num_agent_steps_sampled_lifetime": {"default_agent": 7200}, "episode_len_min": 20, "num_env_steps_sampled": 400, "episode_duration_sec_mean": 0.004504785402677953, "module_episode_returns_mean": {"default_policy": 0.35}, "episode_return_mean": 0.35, "env_reset_timer": 0.0001604804414408465, "env_step_timer": 1.3803559753102657e-05, "num_module_steps_sampled": {"default_policy": 400}, "agent_episode_returns_mean": {"default_agent": 0.35}, "episode_len_max": 20, "env_to_module_sum_episodes_length_in": 10.368238394574323, "num_module_steps_sampled_lifetime": {"default_policy": 7200}, "env_to_module_sum_episodes_length_out": 10.368238394574323, "rlmodule_inference_timer": 2.6372350246302153e-05, "sample": 0.10211424269013386, "time_between_sampling": 1.618867490759865}, "num_healthy_workers": 1, "actor_manager_num_outstanding_async_reqs": 0, "num_remote_worker_restarts": 0}, "num_env_steps_sampled_lifetime": -9870000.0, "fault_tolerance": {"num_healthy_workers": 0, "num_remote_worker_restarts": 0}, "env_runner_group": {"actor_manager_num_outstanding_async_reqs": 0}, "done": false, "training_iteration": 18, "trial_id": "49be2_00000", "date": "2025-08-11_19-36-46", "timestamp": 1754933806, "time_this_iter_s": 1.7356700897216797, "time_total_s": 37.3672149181366, "pid": 28164, "hostname": "Mac", "node_ip": "127.0.0.1", "config": {"exploration_config": {}, "extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "placement_strategy": "PACK", "num_gpus": 0, "_fake_gpus": false, "num_cpus_for_main_process": 2, "eager_tracing": true, "eager_max_retraces": 20, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "torch_compile_learner": false, "torch_compile_learner_what_to_compile": "forward_train", "torch_compile_learner_dynamo_backend": "aot_eager", "torch_compile_learner_dynamo_mode": null, "torch_compile_worker": false, "torch_compile_worker_dynamo_backend": "aot_eager", "torch_compile_worker_dynamo_mode": null, "torch_ddp_kwargs": {}, "torch_skip_nan_gradients": false, "env": "Umbrella", "env_config": {}, "observation_space": null, "action_space": null, "clip_rewards": null, "normalize_actions": true, "clip_actions": false, "_is_atari": null, "disable_env_checking": false, "render_env": false, "action_mask_key": "action_mask", "env_runner_cls": null, "num_env_runners": 0, "create_local_env_runner": true, "num_envs_per_env_runner": 1, "gym_env_vectorize_mode": "SYNC", "num_cpus_per_env_runner": 1, "num_gpus_per_env_runner": 0, "custom_resources_per_env_runner": {}, "validate_env_runners_after_construction": true, "episodes_to_numpy": true, "max_requests_in_flight_per_env_runner": 1, "sample_timeout_s": 60.0, "_env_to_module_connector": null, "add_default_connectors_to_env_to_module_pipeline": true, "_module_to_env_connector": null, "add_default_connectors_to_module_to_env_pipeline": true, "merge_env_runner_states": "training_only", "broadcast_env_runner_states": true, "episode_lookback_horizon": 1, "rollout_fragment_length": "auto", "batch_mode": "complete_episodes", "compress_observations": false, "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "enable_tf1_exec_eagerly": false, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "preprocessor_pref": "deepmind", "observation_filter": "NoFilter", "update_worker_filter_stats": true, "use_worker_filter_stats": true, "sampler_perf_stats_ema_coef": null, "_is_online": true, "num_learners": 0, "num_gpus_per_learner": 0, "num_cpus_per_learner": "auto", "num_aggregator_actors_per_learner": 0, "max_requests_in_flight_per_aggregator_actor": 3, "local_gpu_idx": 0, "max_requests_in_flight_per_learner": 3, "gamma": 1, "lr": 0.0002847858517, "grad_clip": 0.5, "grad_clip_by": "global_norm", "_train_batch_size_per_learner": 5000, "train_batch_size": 4000, "num_epochs": 1, "minibatch_size": 1000, "shuffle_batch_per_epoch": true, "model": {"fcnet_hiddens": [256, 256], "fcnet_activation": "tanh", "fcnet_weights_initializer": null, "fcnet_weights_initializer_config": null, "fcnet_bias_initializer": null, "fcnet_bias_initializer_config": null, "conv_filters": null, "conv_activation": "relu", "conv_kernel_initializer": null, "conv_kernel_initializer_config": null, "conv_bias_initializer": null, "conv_bias_initializer_config": null, "conv_transpose_kernel_initializer": null, "conv_transpose_kernel_initializer_config": null, "conv_transpose_bias_initializer": null, "conv_transpose_bias_initializer_config": null, "post_fcnet_hiddens": [], "post_fcnet_activation": "relu", "post_fcnet_weights_initializer": null, "post_fcnet_weights_initializer_config": null, "post_fcnet_bias_initializer": null, "post_fcnet_bias_initializer_config": null, "free_log_std": false, "log_std_clip_param": 20.0, "no_final_linear": false, "vf_share_layers": false, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "lstm_weights_initializer": null, "lstm_weights_initializer_config": null, "lstm_bias_initializer": null, "lstm_bias_initializer_config": null, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "attention_use_n_prev_actions": 0, "attention_use_n_prev_rewards": 0, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": null, "custom_model_config": {}, "custom_action_dist": null, "custom_preprocessor": null, "encoder_latent_dim": null, "always_check_shapes": false, "lstm_use_prev_action_reward": -1, "_use_default_native_models": -1, "_disable_preprocessor_api": false, "_disable_action_flattening": false}, "_learner_connector": null, "add_default_connectors_to_learner_pipeline": true, "learner_config_dict": {}, "optimizer": {}, "_learner_class": null, "callbacks_on_algorithm_init": null, "callbacks_on_env_runners_recreated": null, "callbacks_on_offline_eval_runners_recreated": null, "callbacks_on_checkpoint_loaded": null, "callbacks_on_environment_created": null, "callbacks_on_episode_created": null, "callbacks_on_episode_start": null, "callbacks_on_episode_step": null, "callbacks_on_episode_end": null, "callbacks_on_evaluate_start": null, "callbacks_on_evaluate_end": null, "callbacks_on_evaluate_offline_start": null, "callbacks_on_evaluate_offline_end": null, "callbacks_on_sample_end": null, "callbacks_on_train_result": null, "explore": true, "enable_rl_module_and_learner": true, "enable_env_runner_and_connector_v2": true, "_prior_exploration_config": {"type": "StochasticSampling"}, "count_steps_by": "env_steps", "policy_map_capacity": 100, "policy_mapping_fn": "<function AlgorithmConfig.DEFAULT_POLICY_MAPPING_FN at 0x145c2d8a0>", "policies_to_train": null, "policy_states_are_swappable": false, "observation_fn": null, "offline_data_class": null, "input_read_method": "read_parquet", "input_read_method_kwargs": {}, "input_read_schema": {}, "input_read_episodes": false, "input_read_sample_batches": false, "input_read_batch_size": null, "input_filesystem": null, "input_filesystem_kwargs": {}, "input_compress_columns": ["obs", "new_obs"], "input_spaces_jsonable": true, "materialize_data": false, "materialize_mapped_data": true, "map_batches_kwargs": {}, "iter_batches_kwargs": {}, "ignore_final_observation": false, "prelearner_class": null, "prelearner_buffer_class": null, "prelearner_buffer_kwargs": {}, "prelearner_module_synch_period": 10, "dataset_num_iters_per_learner": null, "input_config": {}, "actions_in_input_normalized": false, "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_config": {}, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "output_max_rows_per_file": null, "output_write_remaining_data": false, "output_write_method": "write_parquet", "output_write_method_kwargs": {}, "output_filesystem": null, "output_filesystem_kwargs": {}, "output_write_episodes": true, "offline_sampling": false, "evaluation_interval": 1, "evaluation_duration": 20, "evaluation_duration_unit": "episodes", "evaluation_sample_timeout_s": 120.0, "evaluation_auto_duration_min_env_steps_per_sample": 100, "evaluation_auto_duration_max_env_steps_per_sample": 2000, "evaluation_parallel_to_training": false, "evaluation_force_reset_envs_before_iteration": true, "evaluation_config": null, "off_policy_estimation_methods": {}, "ope_split_batch_by_episode": true, "evaluation_num_env_runners": 1, "in_evaluation": false, "sync_filters_on_rollout_workers_timeout_s": 10.0, "offline_evaluation_interval": null, "num_offline_eval_runners": 0, "offline_loss_for_module_fn": null, "offline_evaluation_duration": 1, "offline_evaluation_parallel_to_training": false, "offline_evaluation_timeout_s": 120.0, "num_cpus_per_offline_eval_runner": 1, "num_gpus_per_offline_eval_runner": 0, "custom_resources_per_offline_eval_runner": {}, "restart_failed_offline_eval_runners": true, "ignore_offline_eval_runner_failures": false, "max_num_offline_eval_runner_restarts": 1000, "offline_eval_runner_restore_timeout_s": 1800.0, "max_requests_in_flight_per_offline_eval_runner": 1, "validate_offline_eval_runners_after_construction": true, "offline_eval_runner_health_probe_timeout_s": 30.0, "offline_eval_rl_module_inference_only": false, "broadcast_offline_eval_runner_states": false, "offline_eval_batch_size_per_runner": 256, "dataset_num_iters_per_eval_runner": 1, "keep_per_episode_custom_metrics": false, "metrics_episode_collection_timeout_s": 60.0, "metrics_num_episodes_for_smoothing": 100, "min_time_s_per_iteration": null, "min_train_timesteps_per_iteration": 0, "min_sample_timesteps_per_iteration": 0, "log_gradients": true, "export_native_model_files": false, "checkpoint_trainable_policies_only": false, "logger_creator": null, "logger_config": null, "log_level": "WARN", "log_sys_usage": true, "fake_sampler": false, "seed": 4, "restart_failed_env_runners": true, "ignore_env_runner_failures": false, "max_num_env_runner_restarts": 1000, "delay_between_env_runner_restarts_s": 60.0, "restart_failed_sub_environments": false, "num_consecutive_env_runner_failures_tolerance": 100, "env_runner_health_probe_timeout_s": 30.0, "env_runner_restore_timeout_s": 1800.0, "_model_config": {}, "_rl_module_spec": "RLModuleSpec(module_class=None, observation_space=None, action_space=None, inference_only=False, learner_only=False, model_config=DefaultModelConfig(fcnet_hiddens=[60, 90], fcnet_activation='tanh', fcnet_kernel_initializer=None, fcnet_kernel_initializer_kwargs=None, fcnet_bias_initializer=None, fcnet_bias_initializer_kwargs=None, conv_filters=None, conv_activation='relu', conv_kernel_initializer=None, conv_kernel_initializer_kwargs=None, conv_bias_initializer=None, conv_bias_initializer_kwargs=None, head_fcnet_hiddens=[], head_fcnet_activation='relu', head_fcnet_kernel_initializer=None, head_fcnet_kernel_initializer_kwargs=None, head_fcnet_bias_initializer=None, head_fcnet_bias_initializer_kwargs=None, free_log_std=False, log_std_clip_param=20.0, vf_share_layers=True, use_lstm=False, max_seq_len=20, lstm_cell_size=256, lstm_use_prev_action=False, lstm_use_prev_reward=False, lstm_kernel_initializer=None, lstm_kernel_initializer_kwargs=None, lstm_bias_initializer=None, lstm_bias_initializer_kwargs=None), catalog_class=None, load_state_path=None, model_config_dict=None)", "algorithm_config_overrides_per_module": {}, "_per_module_overrides": {}, "_validate_config": true, "_use_msgpack_checkpoints": false, "_torch_grad_scaler_class": null, "_torch_lr_scheduler_classes": null, "_tf_policy_handles_more_than_one_loss": false, "_disable_preprocessor_api": false, "_disable_action_flattening": false, "_disable_initialize_loss_from_dummy_batch": false, "_dont_auto_sync_env_runner_states": false, "env_task_fn": -1, "enable_connectors": -1, "simple_optimizer": false, "policy_map_cache": -1, "worker_cls": -1, "synchronize_filters": -1, "enable_async_evaluation": -1, "custom_async_evaluation_function": -1, "_enable_rl_module_api": -1, "auto_wrap_old_gym_envs": -1, "always_attach_evaluation_results": -1, "replay_sequence_length": null, "_disable_execution_plan_api": -1, "use_critic": true, "use_gae": true, "use_kl_loss": true, "kl_coeff": 0.7464963036515, "kl_target": 0.0270990929592, "vf_loss_coeff": 0.6688075857018, "entropy_coeff": 0.0090570820258, "clip_param": 0.1221781641624, "vf_clip_param": 0.1027808522125, "entropy_coeff_schedule": null, "lr_schedule": null, "sgd_minibatch_size": -1, "vf_share_layers": -1, "__stdout_file__": null, "__stderr_file__": null, "lambda": 0.9099046732075, "input": "sampler", "policies": {"default_policy": [null, null, null, null]}, "callbacks": "<class 'ray.rllib.callbacks.callbacks.RLlibCallback'>", "create_env_on_driver": false, "custom_eval_function": null, "framework": "torch"}, "time_since_restore": 37.3672149181366, "iterations_since_restore": 18, "perf": {"cpu_util_percent": 48.46666666666667, "ram_util_percent": 78.06666666666666}}
{"timers": {"training_iteration": 1.6199346383205961, "restore_env_runners": 9.487210325725238e-06, "training_step": 1.6198057715925722, "env_runner_sampling_timer": 1.4879279570108692, "learner_update_timer": 0.12874637339312167, "synch_weights": 0.0006588081405648024, "restore_eval_env_runners": 1.2011262876541951e-05, "evaluation_iteration": 0.10837927436568574, "synch_eval_env_connectors": 0.00011973017979469165, "synch_env_connectors": 4.852603628682256e-06}, "env_runners": {"num_episodes_lifetime": -524375.0, "episode_len_mean": 20.0, "env_to_module_connector": {"timers": {"connectors": {"batch_individual_items": 6.222300122002894e-06, "add_observations_from_episodes_to_batch": 2.9391576310782475e-06, "add_states_from_episodes_to_batch": 1.7403252331259147e-06, "numpy_to_tensor": 8.54408590259459e-06, "add_time_dim_to_batch_and_zero_pad": 2.3908564326238963e-06}}, "connector_pipeline_timer": 4.329733650686567e-05}, "agent_episode_returns_mean": {"default_agent": 10.66}, "episode_return_max": 12.5, "num_module_steps_sampled_lifetime": {"default_policy": -10487500.0}, "env_step_timer": 1.3701032242270846e-05, "module_to_env_connector": {"timers": {"connectors": {"listify_data_for_vector_env": 1.1088843687144759e-05, "remove_single_ts_time_rank_from_batch": 5.850869743859058e-07, "tensor_to_numpy": 1.313407448145442e-05, "un_batch_to_individual_items": 5.466207843902792e-06, "get_actions": 3.836553553741783e-05, "normalize_and_clip_actions": 9.418820776776663e-06}}, "connector_pipeline_timer": 0.00010336075393288505}, "module_episode_returns_mean": {"default_policy": 10.66}, "num_env_steps_sampled_lifetime": -10487500.0, "episode_len_min": 20, "episode_return_min": -7.5, "time_between_sampling": 0.0018300659418401927, "num_env_steps_sampled": 5000.0, "num_module_steps_sampled": {"default_policy": 5000.0}, "num_episodes": 250.0, "episode_len_max": 20, "num_agent_steps_sampled": {"default_agent": 5000.0}, "episode_duration_sec_mean": 0.004481481349095701, "env_to_module_sum_episodes_length_in": 10.36823839457432, "num_agent_steps_sampled_lifetime": {"default_agent": -10487500.0}, "env_to_module_sum_episodes_length_out": 10.36823839457432, "rlmodule_inference_timer": 2.7903415551778047e-05, "episode_return_mean": 10.66, "sample": 0.004983952160729199, "env_reset_timer": 3.508990979465876e-05, "weights_seq_no": 18.0, "num_env_steps_sampled_lifetime_throughput": 3742.8861430970483}, "learners": {"__all_modules__": {"num_non_trainable_parameters": 0, "learner_connector": {"timers": {"connectors": {"add_time_dim_to_batch_and_zero_pad": 1.1759853306702648e-05, "batch_individual_items": 0.03610367897493869, "add_one_ts_to_episodes_and_truncate": 0.008482838897656836, "general_advantage_estimation": 0.007411209200892585, "numpy_to_tensor": 6.728157469937597e-05, "add_observations_from_episodes_to_batch": 0.000831196840414259, "add_states_from_episodes_to_batch": 3.1862771223423924e-06, "add_columns_from_episodes_to_train_batch": 0.03475126214012882}}, "connector_pipeline_timer": 0.08777457141791517}, "num_env_steps_trained_lifetime": 598500, "num_env_steps_trained": 31500, "num_module_steps_trained_lifetime": 114000, "num_module_steps_trained": 6000, "learner_connector_sum_episodes_length_out": 5250.0, "num_trainable_parameters": 6003, "learner_connector_sum_episodes_length_in": 5000.0, "num_env_steps_trained_lifetime_throughput": 2385829.1904614097, "num_module_steps_trained_throughput": 456083.8945929683, "num_module_steps_trained_lifetime_throughput": 455458.5871004132}, "default_policy": {"diff_num_grad_updates_vs_sampler_policy": 1.0, "vf_loss_unclipped": 28.553913116455078, "num_module_steps_trained": 6000, "total_loss": 0.01614151895046234, "num_trainable_parameters": 6003, "gradients_default_optimizer_global_norm": 0.07589247077703476, "weights_seq_no": 19.0, "mean_kl_loss": 0.0003655123873613775, "vf_explained_var": 0.018101215362548828, "vf_loss": 0.10224167257547379, "policy_loss": -0.04904314875602722, "default_optimizer_learning_rate": 0.0002847858517, "entropy": 0.352801650762558, "num_module_steps_trained_lifetime": 114000, "curr_entropy_coeff": 0.0090570820258, "curr_kl_coeff": 1.423828734914423e-06, "module_train_batch_size_mean": 1000.0, "num_module_steps_trained_lifetime_throughput": 456373.5855046867}}, "num_training_step_calls_per_iteration": 1, "evaluation": {"env_runners": {"num_agent_steps_sampled": {"default_agent": 400}, "num_env_steps_sampled_lifetime": 95400, "env_to_module_connector": {"timers": {"connectors": {"add_states_from_episodes_to_batch": 1.552292243936256e-06, "batch_individual_items": 5.992589908126837e-06, "numpy_to_tensor": 7.974673258250706e-06, "add_observations_from_episodes_to_batch": 2.7455730595211656e-06, "add_time_dim_to_batch_and_zero_pad": 2.1680505351029622e-06}}, "connector_pipeline_timer": 4.154340781939118e-05}, "episode_return_min": -16.5, "num_episodes": 20, "num_episodes_lifetime": 380, "module_to_env_connector": {"timers": {"connectors": {"un_batch_to_individual_items": 5.2043955378175536e-06, "normalize_and_clip_actions": 9.116076620608403e-06, "listify_data_for_vector_env": 1.067287604885302e-05, "tensor_to_numpy": 1.2635715480974799e-05, "get_actions": 3.396485727245233e-05, "remove_single_ts_time_rank_from_batch": 6.346236554626073e-07}}, "connector_pipeline_timer": 9.710520667664607e-05}, "episode_len_mean": 20.0, "weights_seq_no": 19.0, "episode_return_max": 12.5, "num_agent_steps_sampled_lifetime": {"default_agent": 7600}, "episode_len_min": 20, "num_env_steps_sampled": 400, "episode_duration_sec_mean": 0.004394061262719334, "module_episode_returns_mean": {"default_policy": 0.95}, "episode_return_mean": 0.95, "env_reset_timer": 0.0001599577174428194, "env_step_timer": 1.3438330152817385e-05, "num_module_steps_sampled": {"default_policy": 400}, "agent_episode_returns_mean": {"default_agent": 0.95}, "episode_len_max": 20, "env_to_module_sum_episodes_length_in": 10.368238394574323, "num_module_steps_sampled_lifetime": {"default_policy": 7600}, "env_to_module_sum_episodes_length_out": 10.368238394574323, "rlmodule_inference_timer": 2.59737776377555e-05, "sample": 0.10204383609277026, "time_between_sampling": 1.6181867891823618}, "num_healthy_workers": 1, "actor_manager_num_outstanding_async_reqs": 0, "num_remote_worker_restarts": 0}, "num_env_steps_sampled_lifetime": -10487500.0, "fault_tolerance": {"num_healthy_workers": 0, "num_remote_worker_restarts": 0}, "env_runner_group": {"actor_manager_num_outstanding_async_reqs": 0}, "done": false, "training_iteration": 19, "trial_id": "49be2_00000", "date": "2025-08-11_19-36-48", "timestamp": 1754933808, "time_this_iter_s": 1.6364669799804688, "time_total_s": 39.003681898117065, "pid": 28164, "hostname": "Mac", "node_ip": "127.0.0.1", "config": {"exploration_config": {}, "extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "placement_strategy": "PACK", "num_gpus": 0, "_fake_gpus": false, "num_cpus_for_main_process": 2, "eager_tracing": true, "eager_max_retraces": 20, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "torch_compile_learner": false, "torch_compile_learner_what_to_compile": "forward_train", "torch_compile_learner_dynamo_backend": "aot_eager", "torch_compile_learner_dynamo_mode": null, "torch_compile_worker": false, "torch_compile_worker_dynamo_backend": "aot_eager", "torch_compile_worker_dynamo_mode": null, "torch_ddp_kwargs": {}, "torch_skip_nan_gradients": false, "env": "Umbrella", "env_config": {}, "observation_space": null, "action_space": null, "clip_rewards": null, "normalize_actions": true, "clip_actions": false, "_is_atari": null, "disable_env_checking": false, "render_env": false, "action_mask_key": "action_mask", "env_runner_cls": null, "num_env_runners": 0, "create_local_env_runner": true, "num_envs_per_env_runner": 1, "gym_env_vectorize_mode": "SYNC", "num_cpus_per_env_runner": 1, "num_gpus_per_env_runner": 0, "custom_resources_per_env_runner": {}, "validate_env_runners_after_construction": true, "episodes_to_numpy": true, "max_requests_in_flight_per_env_runner": 1, "sample_timeout_s": 60.0, "_env_to_module_connector": null, "add_default_connectors_to_env_to_module_pipeline": true, "_module_to_env_connector": null, "add_default_connectors_to_module_to_env_pipeline": true, "merge_env_runner_states": "training_only", "broadcast_env_runner_states": true, "episode_lookback_horizon": 1, "rollout_fragment_length": "auto", "batch_mode": "complete_episodes", "compress_observations": false, "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "enable_tf1_exec_eagerly": false, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "preprocessor_pref": "deepmind", "observation_filter": "NoFilter", "update_worker_filter_stats": true, "use_worker_filter_stats": true, "sampler_perf_stats_ema_coef": null, "_is_online": true, "num_learners": 0, "num_gpus_per_learner": 0, "num_cpus_per_learner": "auto", "num_aggregator_actors_per_learner": 0, "max_requests_in_flight_per_aggregator_actor": 3, "local_gpu_idx": 0, "max_requests_in_flight_per_learner": 3, "gamma": 1, "lr": 0.0002847858517, "grad_clip": 0.5, "grad_clip_by": "global_norm", "_train_batch_size_per_learner": 5000, "train_batch_size": 4000, "num_epochs": 1, "minibatch_size": 1000, "shuffle_batch_per_epoch": true, "model": {"fcnet_hiddens": [256, 256], "fcnet_activation": "tanh", "fcnet_weights_initializer": null, "fcnet_weights_initializer_config": null, "fcnet_bias_initializer": null, "fcnet_bias_initializer_config": null, "conv_filters": null, "conv_activation": "relu", "conv_kernel_initializer": null, "conv_kernel_initializer_config": null, "conv_bias_initializer": null, "conv_bias_initializer_config": null, "conv_transpose_kernel_initializer": null, "conv_transpose_kernel_initializer_config": null, "conv_transpose_bias_initializer": null, "conv_transpose_bias_initializer_config": null, "post_fcnet_hiddens": [], "post_fcnet_activation": "relu", "post_fcnet_weights_initializer": null, "post_fcnet_weights_initializer_config": null, "post_fcnet_bias_initializer": null, "post_fcnet_bias_initializer_config": null, "free_log_std": false, "log_std_clip_param": 20.0, "no_final_linear": false, "vf_share_layers": false, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "lstm_weights_initializer": null, "lstm_weights_initializer_config": null, "lstm_bias_initializer": null, "lstm_bias_initializer_config": null, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "attention_use_n_prev_actions": 0, "attention_use_n_prev_rewards": 0, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": null, "custom_model_config": {}, "custom_action_dist": null, "custom_preprocessor": null, "encoder_latent_dim": null, "always_check_shapes": false, "lstm_use_prev_action_reward": -1, "_use_default_native_models": -1, "_disable_preprocessor_api": false, "_disable_action_flattening": false}, "_learner_connector": null, "add_default_connectors_to_learner_pipeline": true, "learner_config_dict": {}, "optimizer": {}, "_learner_class": null, "callbacks_on_algorithm_init": null, "callbacks_on_env_runners_recreated": null, "callbacks_on_offline_eval_runners_recreated": null, "callbacks_on_checkpoint_loaded": null, "callbacks_on_environment_created": null, "callbacks_on_episode_created": null, "callbacks_on_episode_start": null, "callbacks_on_episode_step": null, "callbacks_on_episode_end": null, "callbacks_on_evaluate_start": null, "callbacks_on_evaluate_end": null, "callbacks_on_evaluate_offline_start": null, "callbacks_on_evaluate_offline_end": null, "callbacks_on_sample_end": null, "callbacks_on_train_result": null, "explore": true, "enable_rl_module_and_learner": true, "enable_env_runner_and_connector_v2": true, "_prior_exploration_config": {"type": "StochasticSampling"}, "count_steps_by": "env_steps", "policy_map_capacity": 100, "policy_mapping_fn": "<function AlgorithmConfig.DEFAULT_POLICY_MAPPING_FN at 0x145c2d8a0>", "policies_to_train": null, "policy_states_are_swappable": false, "observation_fn": null, "offline_data_class": null, "input_read_method": "read_parquet", "input_read_method_kwargs": {}, "input_read_schema": {}, "input_read_episodes": false, "input_read_sample_batches": false, "input_read_batch_size": null, "input_filesystem": null, "input_filesystem_kwargs": {}, "input_compress_columns": ["obs", "new_obs"], "input_spaces_jsonable": true, "materialize_data": false, "materialize_mapped_data": true, "map_batches_kwargs": {}, "iter_batches_kwargs": {}, "ignore_final_observation": false, "prelearner_class": null, "prelearner_buffer_class": null, "prelearner_buffer_kwargs": {}, "prelearner_module_synch_period": 10, "dataset_num_iters_per_learner": null, "input_config": {}, "actions_in_input_normalized": false, "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_config": {}, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "output_max_rows_per_file": null, "output_write_remaining_data": false, "output_write_method": "write_parquet", "output_write_method_kwargs": {}, "output_filesystem": null, "output_filesystem_kwargs": {}, "output_write_episodes": true, "offline_sampling": false, "evaluation_interval": 1, "evaluation_duration": 20, "evaluation_duration_unit": "episodes", "evaluation_sample_timeout_s": 120.0, "evaluation_auto_duration_min_env_steps_per_sample": 100, "evaluation_auto_duration_max_env_steps_per_sample": 2000, "evaluation_parallel_to_training": false, "evaluation_force_reset_envs_before_iteration": true, "evaluation_config": null, "off_policy_estimation_methods": {}, "ope_split_batch_by_episode": true, "evaluation_num_env_runners": 1, "in_evaluation": false, "sync_filters_on_rollout_workers_timeout_s": 10.0, "offline_evaluation_interval": null, "num_offline_eval_runners": 0, "offline_loss_for_module_fn": null, "offline_evaluation_duration": 1, "offline_evaluation_parallel_to_training": false, "offline_evaluation_timeout_s": 120.0, "num_cpus_per_offline_eval_runner": 1, "num_gpus_per_offline_eval_runner": 0, "custom_resources_per_offline_eval_runner": {}, "restart_failed_offline_eval_runners": true, "ignore_offline_eval_runner_failures": false, "max_num_offline_eval_runner_restarts": 1000, "offline_eval_runner_restore_timeout_s": 1800.0, "max_requests_in_flight_per_offline_eval_runner": 1, "validate_offline_eval_runners_after_construction": true, "offline_eval_runner_health_probe_timeout_s": 30.0, "offline_eval_rl_module_inference_only": false, "broadcast_offline_eval_runner_states": false, "offline_eval_batch_size_per_runner": 256, "dataset_num_iters_per_eval_runner": 1, "keep_per_episode_custom_metrics": false, "metrics_episode_collection_timeout_s": 60.0, "metrics_num_episodes_for_smoothing": 100, "min_time_s_per_iteration": null, "min_train_timesteps_per_iteration": 0, "min_sample_timesteps_per_iteration": 0, "log_gradients": true, "export_native_model_files": false, "checkpoint_trainable_policies_only": false, "logger_creator": null, "logger_config": null, "log_level": "WARN", "log_sys_usage": true, "fake_sampler": false, "seed": 4, "restart_failed_env_runners": true, "ignore_env_runner_failures": false, "max_num_env_runner_restarts": 1000, "delay_between_env_runner_restarts_s": 60.0, "restart_failed_sub_environments": false, "num_consecutive_env_runner_failures_tolerance": 100, "env_runner_health_probe_timeout_s": 30.0, "env_runner_restore_timeout_s": 1800.0, "_model_config": {}, "_rl_module_spec": "RLModuleSpec(module_class=None, observation_space=None, action_space=None, inference_only=False, learner_only=False, model_config=DefaultModelConfig(fcnet_hiddens=[60, 90], fcnet_activation='tanh', fcnet_kernel_initializer=None, fcnet_kernel_initializer_kwargs=None, fcnet_bias_initializer=None, fcnet_bias_initializer_kwargs=None, conv_filters=None, conv_activation='relu', conv_kernel_initializer=None, conv_kernel_initializer_kwargs=None, conv_bias_initializer=None, conv_bias_initializer_kwargs=None, head_fcnet_hiddens=[], head_fcnet_activation='relu', head_fcnet_kernel_initializer=None, head_fcnet_kernel_initializer_kwargs=None, head_fcnet_bias_initializer=None, head_fcnet_bias_initializer_kwargs=None, free_log_std=False, log_std_clip_param=20.0, vf_share_layers=True, use_lstm=False, max_seq_len=20, lstm_cell_size=256, lstm_use_prev_action=False, lstm_use_prev_reward=False, lstm_kernel_initializer=None, lstm_kernel_initializer_kwargs=None, lstm_bias_initializer=None, lstm_bias_initializer_kwargs=None), catalog_class=None, load_state_path=None, model_config_dict=None)", "algorithm_config_overrides_per_module": {}, "_per_module_overrides": {}, "_validate_config": true, "_use_msgpack_checkpoints": false, "_torch_grad_scaler_class": null, "_torch_lr_scheduler_classes": null, "_tf_policy_handles_more_than_one_loss": false, "_disable_preprocessor_api": false, "_disable_action_flattening": false, "_disable_initialize_loss_from_dummy_batch": false, "_dont_auto_sync_env_runner_states": false, "env_task_fn": -1, "enable_connectors": -1, "simple_optimizer": false, "policy_map_cache": -1, "worker_cls": -1, "synchronize_filters": -1, "enable_async_evaluation": -1, "custom_async_evaluation_function": -1, "_enable_rl_module_api": -1, "auto_wrap_old_gym_envs": -1, "always_attach_evaluation_results": -1, "replay_sequence_length": null, "_disable_execution_plan_api": -1, "use_critic": true, "use_gae": true, "use_kl_loss": true, "kl_coeff": 0.7464963036515, "kl_target": 0.0270990929592, "vf_loss_coeff": 0.6688075857018, "entropy_coeff": 0.0090570820258, "clip_param": 0.1221781641624, "vf_clip_param": 0.1027808522125, "entropy_coeff_schedule": null, "lr_schedule": null, "sgd_minibatch_size": -1, "vf_share_layers": -1, "__stdout_file__": null, "__stderr_file__": null, "lambda": 0.9099046732075, "input": "sampler", "policies": {"default_policy": [null, null, null, null]}, "callbacks": "<class 'ray.rllib.callbacks.callbacks.RLlibCallback'>", "create_env_on_driver": false, "custom_eval_function": null, "framework": "torch"}, "time_since_restore": 39.003681898117065, "iterations_since_restore": 19, "perf": {"cpu_util_percent": 40.25, "ram_util_percent": 78.3}}
{"timers": {"training_iteration": 1.6181735786067097, "restore_env_runners": 9.43858770152339e-06, "training_step": 1.6180444605470454, "env_runner_sampling_timer": 1.4865515566102974, "learner_update_timer": 0.12836246757885478, "synch_weights": 0.0006581579693322427, "restore_eval_env_runners": 1.195448949607613e-05, "evaluation_iteration": 0.10830044287261159, "synch_eval_env_connectors": 0.00011939745850320361, "synch_env_connectors": 4.842407337106952e-06}, "env_runners": {"num_episodes_lifetime": -555250.0, "episode_len_mean": 20.0, "env_to_module_connector": {"timers": {"connectors": {"batch_individual_items": 6.142539942419672e-06, "add_observations_from_episodes_to_batch": 2.9178406600495463e-06, "add_states_from_episodes_to_batch": 1.7224376571180041e-06, "numpy_to_tensor": 8.296100945412946e-06, "add_time_dim_to_batch_and_zero_pad": 2.3445157922984947e-06}}, "connector_pipeline_timer": 4.2631575110824326e-05}, "agent_episode_returns_mean": {"default_agent": 10.66}, "episode_return_max": 12.5, "num_module_steps_sampled_lifetime": {"default_policy": -11105000.0}, "env_step_timer": 1.356881884680002e-05, "module_to_env_connector": {"timers": {"connectors": {"listify_data_for_vector_env": 1.0963823063530107e-05, "remove_single_ts_time_rank_from_batch": 5.760275818552615e-07, "tensor_to_numpy": 1.3036199013237998e-05, "un_batch_to_individual_items": 5.325152038364114e-06, "get_actions": 3.791629221168237e-05, "normalize_and_clip_actions": 9.300815963834637e-06}}, "connector_pipeline_timer": 0.00010225827855360628}, "module_episode_returns_mean": {"default_policy": 10.66}, "num_env_steps_sampled_lifetime": -11105000.0, "episode_len_min": 20, "episode_return_min": -7.5, "time_between_sampling": 0.0018053521248647421, "num_env_steps_sampled": 5000.0, "num_module_steps_sampled": {"default_policy": 5000.0}, "num_episodes": 250.0, "episode_len_max": 20, "num_agent_steps_sampled": {"default_agent": 5000.0}, "episode_duration_sec_mean": 0.004469916536472737, "env_to_module_sum_episodes_length_in": 10.36823839457432, "num_agent_steps_sampled_lifetime": {"default_agent": -11105000.0}, "env_to_module_sum_episodes_length_out": 10.36823839457432, "rlmodule_inference_timer": 2.7175965069128327e-05, "episode_return_mean": 10.66, "sample": 0.00478817111821607, "env_reset_timer": 3.090745270356058e-05, "weights_seq_no": 19.0, "num_env_steps_sampled_lifetime_throughput": 3801.7087229618646}, "learners": {"__all_modules__": {"num_non_trainable_parameters": 0, "learner_connector": {"timers": {"connectors": {"add_time_dim_to_batch_and_zero_pad": 1.172016456361508e-05, "batch_individual_items": 0.03604078426445323, "add_one_ts_to_episodes_and_truncate": 0.008473848008142335, "general_advantage_estimation": 0.0073879596090948825, "numpy_to_tensor": 6.707334921872916e-05, "add_observations_from_episodes_to_batch": 0.000831079461764683, "add_states_from_episodes_to_batch": 3.1823342377527226e-06, "add_columns_from_episodes_to_train_batch": 0.03474968451953272}}, "connector_pipeline_timer": 0.08767709028412551}, "num_env_steps_trained_lifetime": 630000, "num_env_steps_trained": 31500, "num_module_steps_trained_lifetime": 120000, "num_module_steps_trained": 6000, "learner_connector_sum_episodes_length_out": 5250.0, "num_trainable_parameters": 6003, "learner_connector_sum_episodes_length_in": 5000.0, "num_env_steps_trained_lifetime_throughput": 2383525.534852161, "num_module_steps_trained_throughput": 455579.36292619124, "num_module_steps_trained_lifetime_throughput": 454973.9030057252}, "default_policy": {"diff_num_grad_updates_vs_sampler_policy": 1.0, "vf_loss_unclipped": 28.65300178527832, "num_module_steps_trained": 6000, "total_loss": 0.03985561802983284, "num_trainable_parameters": 6003, "gradients_default_optimizer_global_norm": 0.03212713077664375, "weights_seq_no": 20.0, "mean_kl_loss": 0.00021589340758509934, "vf_explained_var": 0.018335282802581787, "vf_loss": 0.10234948992729187, "policy_loss": -0.025547273457050323, "default_optimizer_learning_rate": 0.0002847858517, "entropy": 0.33666831254959106, "num_module_steps_trained_lifetime": 120000, "curr_entropy_coeff": 0.0090570820258, "curr_kl_coeff": 7.119143674572115e-07, "module_train_batch_size_mean": 1000.0, "num_module_steps_trained_lifetime_throughput": 455819.8150208246}}, "num_training_step_calls_per_iteration": 1, "evaluation": {"env_runners": {"num_agent_steps_sampled": {"default_agent": 400}, "num_env_steps_sampled_lifetime": 100400, "env_to_module_connector": {"timers": {"connectors": {"add_states_from_episodes_to_batch": 1.5898022774892351e-06, "batch_individual_items": 6.036965657023941e-06, "numpy_to_tensor": 7.988472804809395e-06, "add_observations_from_episodes_to_batch": 2.7338447033522256e-06, "add_time_dim_to_batch_and_zero_pad": 2.188518987004263e-06}}, "connector_pipeline_timer": 4.1627019719090164e-05}, "episode_return_min": -16.5, "num_episodes": 20, "num_episodes_lifetime": 400, "module_to_env_connector": {"timers": {"connectors": {"un_batch_to_individual_items": 5.170279543372256e-06, "normalize_and_clip_actions": 9.041656857210848e-06, "listify_data_for_vector_env": 1.0592736590431957e-05, "tensor_to_numpy": 1.2573450699429529e-05, "get_actions": 3.3651245918345665e-05, "remove_single_ts_time_rank_from_batch": 6.280256891159449e-07}}, "connector_pipeline_timer": 9.644700948370331e-05}, "episode_len_mean": 20.0, "weights_seq_no": 20.0, "episode_return_max": 12.5, "num_agent_steps_sampled_lifetime": {"default_agent": 8000}, "episode_len_min": 20, "num_env_steps_sampled": 400, "episode_duration_sec_mean": 0.004391352123348042, "module_episode_returns_mean": {"default_policy": 1.35}, "episode_return_mean": 1.35, "env_reset_timer": 0.0001590456402646659, "env_step_timer": 1.3517465141040322e-05, "num_module_steps_sampled": {"default_policy": 400}, "agent_episode_returns_mean": {"default_agent": 1.35}, "episode_len_max": 20, "env_to_module_sum_episodes_length_in": 10.368238394574323, "num_module_steps_sampled_lifetime": {"default_policy": 8000}, "env_to_module_sum_episodes_length_out": 10.368238394574323, "rlmodule_inference_timer": 2.607317667273776e-05, "sample": 0.10196839564108857, "time_between_sampling": 1.61661613338136}, "num_healthy_workers": 1, "actor_manager_num_outstanding_async_reqs": 0, "num_remote_worker_restarts": 0}, "num_env_steps_sampled_lifetime": -11105000.0, "fault_tolerance": {"num_healthy_workers": 0, "num_remote_worker_restarts": 0}, "env_runner_group": {"actor_manager_num_outstanding_async_reqs": 0}, "done": true, "training_iteration": 20, "trial_id": "49be2_00000", "date": "2025-08-11_19-36-50", "timestamp": 1754933810, "time_this_iter_s": 1.5454668998718262, "time_total_s": 40.54914879798889, "pid": 28164, "hostname": "Mac", "node_ip": "127.0.0.1", "config": {"exploration_config": {}, "extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "placement_strategy": "PACK", "num_gpus": 0, "_fake_gpus": false, "num_cpus_for_main_process": 2, "eager_tracing": true, "eager_max_retraces": 20, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "torch_compile_learner": false, "torch_compile_learner_what_to_compile": "forward_train", "torch_compile_learner_dynamo_backend": "aot_eager", "torch_compile_learner_dynamo_mode": null, "torch_compile_worker": false, "torch_compile_worker_dynamo_backend": "aot_eager", "torch_compile_worker_dynamo_mode": null, "torch_ddp_kwargs": {}, "torch_skip_nan_gradients": false, "env": "Umbrella", "env_config": {}, "observation_space": null, "action_space": null, "clip_rewards": null, "normalize_actions": true, "clip_actions": false, "_is_atari": null, "disable_env_checking": false, "render_env": false, "action_mask_key": "action_mask", "env_runner_cls": null, "num_env_runners": 0, "create_local_env_runner": true, "num_envs_per_env_runner": 1, "gym_env_vectorize_mode": "SYNC", "num_cpus_per_env_runner": 1, "num_gpus_per_env_runner": 0, "custom_resources_per_env_runner": {}, "validate_env_runners_after_construction": true, "episodes_to_numpy": true, "max_requests_in_flight_per_env_runner": 1, "sample_timeout_s": 60.0, "_env_to_module_connector": null, "add_default_connectors_to_env_to_module_pipeline": true, "_module_to_env_connector": null, "add_default_connectors_to_module_to_env_pipeline": true, "merge_env_runner_states": "training_only", "broadcast_env_runner_states": true, "episode_lookback_horizon": 1, "rollout_fragment_length": "auto", "batch_mode": "complete_episodes", "compress_observations": false, "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "enable_tf1_exec_eagerly": false, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "preprocessor_pref": "deepmind", "observation_filter": "NoFilter", "update_worker_filter_stats": true, "use_worker_filter_stats": true, "sampler_perf_stats_ema_coef": null, "_is_online": true, "num_learners": 0, "num_gpus_per_learner": 0, "num_cpus_per_learner": "auto", "num_aggregator_actors_per_learner": 0, "max_requests_in_flight_per_aggregator_actor": 3, "local_gpu_idx": 0, "max_requests_in_flight_per_learner": 3, "gamma": 1, "lr": 0.0002847858517, "grad_clip": 0.5, "grad_clip_by": "global_norm", "_train_batch_size_per_learner": 5000, "train_batch_size": 4000, "num_epochs": 1, "minibatch_size": 1000, "shuffle_batch_per_epoch": true, "model": {"fcnet_hiddens": [256, 256], "fcnet_activation": "tanh", "fcnet_weights_initializer": null, "fcnet_weights_initializer_config": null, "fcnet_bias_initializer": null, "fcnet_bias_initializer_config": null, "conv_filters": null, "conv_activation": "relu", "conv_kernel_initializer": null, "conv_kernel_initializer_config": null, "conv_bias_initializer": null, "conv_bias_initializer_config": null, "conv_transpose_kernel_initializer": null, "conv_transpose_kernel_initializer_config": null, "conv_transpose_bias_initializer": null, "conv_transpose_bias_initializer_config": null, "post_fcnet_hiddens": [], "post_fcnet_activation": "relu", "post_fcnet_weights_initializer": null, "post_fcnet_weights_initializer_config": null, "post_fcnet_bias_initializer": null, "post_fcnet_bias_initializer_config": null, "free_log_std": false, "log_std_clip_param": 20.0, "no_final_linear": false, "vf_share_layers": false, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "lstm_weights_initializer": null, "lstm_weights_initializer_config": null, "lstm_bias_initializer": null, "lstm_bias_initializer_config": null, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "attention_use_n_prev_actions": 0, "attention_use_n_prev_rewards": 0, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": null, "custom_model_config": {}, "custom_action_dist": null, "custom_preprocessor": null, "encoder_latent_dim": null, "always_check_shapes": false, "lstm_use_prev_action_reward": -1, "_use_default_native_models": -1, "_disable_preprocessor_api": false, "_disable_action_flattening": false}, "_learner_connector": null, "add_default_connectors_to_learner_pipeline": true, "learner_config_dict": {}, "optimizer": {}, "_learner_class": null, "callbacks_on_algorithm_init": null, "callbacks_on_env_runners_recreated": null, "callbacks_on_offline_eval_runners_recreated": null, "callbacks_on_checkpoint_loaded": null, "callbacks_on_environment_created": null, "callbacks_on_episode_created": null, "callbacks_on_episode_start": null, "callbacks_on_episode_step": null, "callbacks_on_episode_end": null, "callbacks_on_evaluate_start": null, "callbacks_on_evaluate_end": null, "callbacks_on_evaluate_offline_start": null, "callbacks_on_evaluate_offline_end": null, "callbacks_on_sample_end": null, "callbacks_on_train_result": null, "explore": true, "enable_rl_module_and_learner": true, "enable_env_runner_and_connector_v2": true, "_prior_exploration_config": {"type": "StochasticSampling"}, "count_steps_by": "env_steps", "policy_map_capacity": 100, "policy_mapping_fn": "<function AlgorithmConfig.DEFAULT_POLICY_MAPPING_FN at 0x145c2d8a0>", "policies_to_train": null, "policy_states_are_swappable": false, "observation_fn": null, "offline_data_class": null, "input_read_method": "read_parquet", "input_read_method_kwargs": {}, "input_read_schema": {}, "input_read_episodes": false, "input_read_sample_batches": false, "input_read_batch_size": null, "input_filesystem": null, "input_filesystem_kwargs": {}, "input_compress_columns": ["obs", "new_obs"], "input_spaces_jsonable": true, "materialize_data": false, "materialize_mapped_data": true, "map_batches_kwargs": {}, "iter_batches_kwargs": {}, "ignore_final_observation": false, "prelearner_class": null, "prelearner_buffer_class": null, "prelearner_buffer_kwargs": {}, "prelearner_module_synch_period": 10, "dataset_num_iters_per_learner": null, "input_config": {}, "actions_in_input_normalized": false, "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_config": {}, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "output_max_rows_per_file": null, "output_write_remaining_data": false, "output_write_method": "write_parquet", "output_write_method_kwargs": {}, "output_filesystem": null, "output_filesystem_kwargs": {}, "output_write_episodes": true, "offline_sampling": false, "evaluation_interval": 1, "evaluation_duration": 20, "evaluation_duration_unit": "episodes", "evaluation_sample_timeout_s": 120.0, "evaluation_auto_duration_min_env_steps_per_sample": 100, "evaluation_auto_duration_max_env_steps_per_sample": 2000, "evaluation_parallel_to_training": false, "evaluation_force_reset_envs_before_iteration": true, "evaluation_config": null, "off_policy_estimation_methods": {}, "ope_split_batch_by_episode": true, "evaluation_num_env_runners": 1, "in_evaluation": false, "sync_filters_on_rollout_workers_timeout_s": 10.0, "offline_evaluation_interval": null, "num_offline_eval_runners": 0, "offline_loss_for_module_fn": null, "offline_evaluation_duration": 1, "offline_evaluation_parallel_to_training": false, "offline_evaluation_timeout_s": 120.0, "num_cpus_per_offline_eval_runner": 1, "num_gpus_per_offline_eval_runner": 0, "custom_resources_per_offline_eval_runner": {}, "restart_failed_offline_eval_runners": true, "ignore_offline_eval_runner_failures": false, "max_num_offline_eval_runner_restarts": 1000, "offline_eval_runner_restore_timeout_s": 1800.0, "max_requests_in_flight_per_offline_eval_runner": 1, "validate_offline_eval_runners_after_construction": true, "offline_eval_runner_health_probe_timeout_s": 30.0, "offline_eval_rl_module_inference_only": false, "broadcast_offline_eval_runner_states": false, "offline_eval_batch_size_per_runner": 256, "dataset_num_iters_per_eval_runner": 1, "keep_per_episode_custom_metrics": false, "metrics_episode_collection_timeout_s": 60.0, "metrics_num_episodes_for_smoothing": 100, "min_time_s_per_iteration": null, "min_train_timesteps_per_iteration": 0, "min_sample_timesteps_per_iteration": 0, "log_gradients": true, "export_native_model_files": false, "checkpoint_trainable_policies_only": false, "logger_creator": null, "logger_config": null, "log_level": "WARN", "log_sys_usage": true, "fake_sampler": false, "seed": 4, "restart_failed_env_runners": true, "ignore_env_runner_failures": false, "max_num_env_runner_restarts": 1000, "delay_between_env_runner_restarts_s": 60.0, "restart_failed_sub_environments": false, "num_consecutive_env_runner_failures_tolerance": 100, "env_runner_health_probe_timeout_s": 30.0, "env_runner_restore_timeout_s": 1800.0, "_model_config": {}, "_rl_module_spec": "RLModuleSpec(module_class=None, observation_space=None, action_space=None, inference_only=False, learner_only=False, model_config=DefaultModelConfig(fcnet_hiddens=[60, 90], fcnet_activation='tanh', fcnet_kernel_initializer=None, fcnet_kernel_initializer_kwargs=None, fcnet_bias_initializer=None, fcnet_bias_initializer_kwargs=None, conv_filters=None, conv_activation='relu', conv_kernel_initializer=None, conv_kernel_initializer_kwargs=None, conv_bias_initializer=None, conv_bias_initializer_kwargs=None, head_fcnet_hiddens=[], head_fcnet_activation='relu', head_fcnet_kernel_initializer=None, head_fcnet_kernel_initializer_kwargs=None, head_fcnet_bias_initializer=None, head_fcnet_bias_initializer_kwargs=None, free_log_std=False, log_std_clip_param=20.0, vf_share_layers=True, use_lstm=False, max_seq_len=20, lstm_cell_size=256, lstm_use_prev_action=False, lstm_use_prev_reward=False, lstm_kernel_initializer=None, lstm_kernel_initializer_kwargs=None, lstm_bias_initializer=None, lstm_bias_initializer_kwargs=None), catalog_class=None, load_state_path=None, model_config_dict=None)", "algorithm_config_overrides_per_module": {}, "_per_module_overrides": {}, "_validate_config": true, "_use_msgpack_checkpoints": false, "_torch_grad_scaler_class": null, "_torch_lr_scheduler_classes": null, "_tf_policy_handles_more_than_one_loss": false, "_disable_preprocessor_api": false, "_disable_action_flattening": false, "_disable_initialize_loss_from_dummy_batch": false, "_dont_auto_sync_env_runner_states": false, "env_task_fn": -1, "enable_connectors": -1, "simple_optimizer": false, "policy_map_cache": -1, "worker_cls": -1, "synchronize_filters": -1, "enable_async_evaluation": -1, "custom_async_evaluation_function": -1, "_enable_rl_module_api": -1, "auto_wrap_old_gym_envs": -1, "always_attach_evaluation_results": -1, "replay_sequence_length": null, "_disable_execution_plan_api": -1, "use_critic": true, "use_gae": true, "use_kl_loss": true, "kl_coeff": 0.7464963036515, "kl_target": 0.0270990929592, "vf_loss_coeff": 0.6688075857018, "entropy_coeff": 0.0090570820258, "clip_param": 0.1221781641624, "vf_clip_param": 0.1027808522125, "entropy_coeff_schedule": null, "lr_schedule": null, "sgd_minibatch_size": -1, "vf_share_layers": -1, "__stdout_file__": null, "__stderr_file__": null, "lambda": 0.9099046732075, "input": "sampler", "policies": {"default_policy": [null, null, null, null]}, "callbacks": "<class 'ray.rllib.callbacks.callbacks.RLlibCallback'>", "create_env_on_driver": false, "custom_eval_function": null, "framework": "torch"}, "time_since_restore": 40.54914879798889, "iterations_since_restore": 20, "perf": {"cpu_util_percent": 36.45, "ram_util_percent": 77.9}}
