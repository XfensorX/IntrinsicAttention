{"timers": {"training_iteration": 4.605924417031929, "restore_env_runners": 1.4708028174936771e-05, "training_step": 4.6055674579693004, "env_runner_sampling_timer": 4.4062952500535175, "learner_update_timer": 0.19025550002697855, "synch_weights": 0.002312875003553927}, "env_runners": {"weights_seq_no": 0.0, "env_to_module_connector": {"timers": {"connectors": {"add_states_from_episodes_to_batch": 3.674474446084209e-06, "batch_individual_items": 1.9418783340156625e-05, "add_observations_from_episodes_to_batch": 9.888988888476701e-06, "add_time_dim_to_batch_and_zero_pad": 6.763418159710221e-06, "numpy_to_tensor": 2.9276867666010352e-05}}, "connector_pipeline_timer": 0.0001206789142733924}, "num_env_steps_sampled": 5000.0, "module_episode_returns_mean": {"default_policy": -2.0200000000000005}, "sample": 0.0176280287632294, "num_module_steps_sampled": {"default_policy": 5000.0}, "num_episodes": 250.0, "module_to_env_connector": {"connector_pipeline_timer": 0.0003723582714991333, "timers": {"connectors": {"tensor_to_numpy": 4.0739695229780264e-05, "get_actions": 0.00017848691419763542, "un_batch_to_individual_items": 1.4072893006481133e-05, "normalize_and_clip_actions": 2.8904705500134346e-05, "listify_data_for_vector_env": 3.2708782773625465e-05, "remove_single_ts_time_rank_from_batch": 1.4337618812688322e-06}}}, "time_between_sampling": 0.0012519814000195937, "num_env_steps_sampled_lifetime": 627500.0, "episode_return_mean": -2.0200000000000005, "episode_return_min": -10.5, "agent_episode_returns_mean": {"default_agent": -2.0200000000000005}, "episode_duration_sec_mean": 0.015223303702659903, "env_to_module_sum_episodes_length_out": 10.191744832559449, "episode_len_mean": 20.0, "env_reset_timer": 0.00027135027441889, "num_agent_steps_sampled_lifetime": {"default_agent": 627500.0}, "num_episodes_lifetime": 31375.0, "episode_len_max": 20, "rlmodule_inference_timer": 0.00014273451991278434, "env_to_module_sum_episodes_length_in": 10.191744832559449, "num_agent_steps_sampled": {"default_agent": 5000.0}, "episode_return_max": 9.5, "episode_len_min": 20, "env_step_timer": 4.630862665345123e-05, "num_module_steps_sampled_lifetime": {"default_policy": 627500.0}, "num_env_steps_sampled_lifetime_throughput": 1498.2871320361294}, "learners": {"__all_modules__": {"learner_connector": {"timers": {"connectors": {"add_time_dim_to_batch_and_zero_pad": 1.6583013348281384e-05, "add_observations_from_episodes_to_batch": 0.0008814169559627771, "add_states_from_episodes_to_batch": 3.958935849368572e-06, "add_columns_from_episodes_to_train_batch": 0.04913695901632309, "batch_individual_items": 0.0466907499358058, "add_one_ts_to_episodes_and_truncate": 0.010674334014765918, "numpy_to_tensor": 0.00012412492651492357, "general_advantage_estimation": 0.008670791052281857}}, "connector_pipeline_timer": 0.11643883306533098}, "num_env_steps_trained_lifetime": 31500, "num_module_steps_trained": 6000, "num_trainable_parameters": 6003, "learner_connector_sum_episodes_length_in": 5000, "num_non_trainable_parameters": 0, "learner_connector_sum_episodes_length_out": 5250, "num_env_steps_trained": 31500, "num_module_steps_trained_lifetime": 6000, "num_env_steps_trained_lifetime_throughput": 817085.425256033, "num_module_steps_trained_throughput": 156079.73426613782, "num_module_steps_trained_lifetime_throughput": 155902.82604949686}, "default_policy": {"gradients_default_optimizer_global_norm": 0.10005132108926773, "entropy": 0.6901261210441589, "vf_explained_var": -0.009449124336242676, "mean_kl_loss": 0.0005800133803859353, "num_module_steps_trained_lifetime": 6000, "vf_loss": 0.10278083384037018, "default_optimizer_learning_rate": 0.0002847858517, "curr_kl_coeff": 0.3732481598854065, "module_train_batch_size_mean": 1000.0, "num_module_steps_trained": 6000, "num_trainable_parameters": 6003, "weights_seq_no": 1.0, "policy_loss": 0.05304957553744316, "diff_num_grad_updates_vs_sampler_policy": 1.0, "vf_loss_unclipped": 28.793254852294922, "curr_entropy_coeff": 0.0090570820258, "total_loss": 0.11597263813018799, "num_module_steps_trained_lifetime_throughput": 156365.9277712254}}, "num_training_step_calls_per_iteration": 1, "num_env_steps_sampled_lifetime": 627500.0, "evaluation": {"env_runners": {"episode_len_min": 20, "episode_return_max": 12.5, "num_env_steps_sampled": 400, "sample": 0.1901260829763487, "env_to_module_connector": {"timers": {"connectors": {"add_observations_from_episodes_to_batch": 5.059057227718129e-06, "add_states_from_episodes_to_batch": 2.070357329729938e-06, "batch_individual_items": 9.55617828742336e-06, "numpy_to_tensor": 1.3044095966715898e-05, "add_time_dim_to_batch_and_zero_pad": 3.4048090195452014e-06}}, "connector_pipeline_timer": 6.479101169286076e-05}, "num_episodes": 20, "num_env_steps_sampled_lifetime": 5400, "episode_len_max": 20, "module_to_env_connector": {"timers": {"connectors": {"tensor_to_numpy": 2.2224730538804745e-05, "get_actions": 7.189659614512795e-05, "un_batch_to_individual_items": 7.194826218229716e-06, "normalize_and_clip_actions": 1.467388229043191e-05, "listify_data_for_vector_env": 1.5819887200653674e-05, "remove_single_ts_time_rank_from_batch": 8.496299650426292e-07}}, "connector_pipeline_timer": 0.00016683597421099933}, "episode_return_min": -12.5, "env_to_module_sum_episodes_length_out": 10.216013141322508, "num_agent_steps_sampled": {"default_agent": 400}, "module_episode_returns_mean": {"default_policy": -2.55}, "rlmodule_inference_timer": 4.931059522511029e-05, "env_to_module_sum_episodes_length_in": 10.216013141322508, "env_step_timer": 2.2093633158466425e-05, "num_agent_steps_sampled_lifetime": {"default_agent": 400}, "episode_len_mean": 20.0, "env_reset_timer": 0.0007374580018222332, "num_module_steps_sampled_lifetime": {"default_policy": 400}, "num_episodes_lifetime": 20, "num_module_steps_sampled": {"default_policy": 400}, "agent_episode_returns_mean": {"default_agent": -2.55}, "weights_seq_no": 1.0, "episode_return_mean": -2.55, "episode_duration_sec_mean": 0.008695614687167109}, "num_healthy_workers": 1, "actor_manager_num_outstanding_async_reqs": 0, "num_remote_worker_restarts": 0}, "fault_tolerance": {"num_healthy_workers": 0, "num_remote_worker_restarts": 0}, "env_runner_group": {"actor_manager_num_outstanding_async_reqs": 0}, "done": false, "training_iteration": 1, "trial_id": "49ef3_00000", "date": "2025-08-11_19-30-34", "timestamp": 1754933434, "time_this_iter_s": 4.816421747207642, "time_total_s": 4.816421747207642, "pid": 23180, "hostname": "Mac", "node_ip": "127.0.0.1", "config": {"exploration_config": {}, "extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "placement_strategy": "PACK", "num_gpus": 0, "_fake_gpus": false, "num_cpus_for_main_process": 2, "eager_tracing": true, "eager_max_retraces": 20, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "torch_compile_learner": false, "torch_compile_learner_what_to_compile": "forward_train", "torch_compile_learner_dynamo_backend": "aot_eager", "torch_compile_learner_dynamo_mode": null, "torch_compile_worker": false, "torch_compile_worker_dynamo_backend": "aot_eager", "torch_compile_worker_dynamo_mode": null, "torch_ddp_kwargs": {}, "torch_skip_nan_gradients": false, "env": "Umbrella", "env_config": {}, "observation_space": null, "action_space": null, "clip_rewards": null, "normalize_actions": true, "clip_actions": false, "_is_atari": null, "disable_env_checking": false, "render_env": false, "action_mask_key": "action_mask", "env_runner_cls": null, "num_env_runners": 0, "create_local_env_runner": true, "num_envs_per_env_runner": 1, "gym_env_vectorize_mode": "SYNC", "num_cpus_per_env_runner": 1, "num_gpus_per_env_runner": 0, "custom_resources_per_env_runner": {}, "validate_env_runners_after_construction": true, "episodes_to_numpy": true, "max_requests_in_flight_per_env_runner": 1, "sample_timeout_s": 60.0, "_env_to_module_connector": null, "add_default_connectors_to_env_to_module_pipeline": true, "_module_to_env_connector": null, "add_default_connectors_to_module_to_env_pipeline": true, "merge_env_runner_states": "training_only", "broadcast_env_runner_states": true, "episode_lookback_horizon": 1, "rollout_fragment_length": "auto", "batch_mode": "complete_episodes", "compress_observations": false, "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "enable_tf1_exec_eagerly": false, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "preprocessor_pref": "deepmind", "observation_filter": "NoFilter", "update_worker_filter_stats": true, "use_worker_filter_stats": true, "sampler_perf_stats_ema_coef": null, "_is_online": true, "num_learners": 0, "num_gpus_per_learner": 0, "num_cpus_per_learner": "auto", "num_aggregator_actors_per_learner": 0, "max_requests_in_flight_per_aggregator_actor": 3, "local_gpu_idx": 0, "max_requests_in_flight_per_learner": 3, "gamma": 1, "lr": 0.0002847858517, "grad_clip": 0.5, "grad_clip_by": "global_norm", "_train_batch_size_per_learner": 5000, "train_batch_size": 4000, "num_epochs": 1, "minibatch_size": 1000, "shuffle_batch_per_epoch": true, "model": {"fcnet_hiddens": [256, 256], "fcnet_activation": "tanh", "fcnet_weights_initializer": null, "fcnet_weights_initializer_config": null, "fcnet_bias_initializer": null, "fcnet_bias_initializer_config": null, "conv_filters": null, "conv_activation": "relu", "conv_kernel_initializer": null, "conv_kernel_initializer_config": null, "conv_bias_initializer": null, "conv_bias_initializer_config": null, "conv_transpose_kernel_initializer": null, "conv_transpose_kernel_initializer_config": null, "conv_transpose_bias_initializer": null, "conv_transpose_bias_initializer_config": null, "post_fcnet_hiddens": [], "post_fcnet_activation": "relu", "post_fcnet_weights_initializer": null, "post_fcnet_weights_initializer_config": null, "post_fcnet_bias_initializer": null, "post_fcnet_bias_initializer_config": null, "free_log_std": false, "log_std_clip_param": 20.0, "no_final_linear": false, "vf_share_layers": false, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "lstm_weights_initializer": null, "lstm_weights_initializer_config": null, "lstm_bias_initializer": null, "lstm_bias_initializer_config": null, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "attention_use_n_prev_actions": 0, "attention_use_n_prev_rewards": 0, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": null, "custom_model_config": {}, "custom_action_dist": null, "custom_preprocessor": null, "encoder_latent_dim": null, "always_check_shapes": false, "lstm_use_prev_action_reward": -1, "_use_default_native_models": -1, "_disable_preprocessor_api": false, "_disable_action_flattening": false}, "_learner_connector": null, "add_default_connectors_to_learner_pipeline": true, "learner_config_dict": {}, "optimizer": {}, "_learner_class": null, "callbacks_on_algorithm_init": null, "callbacks_on_env_runners_recreated": null, "callbacks_on_offline_eval_runners_recreated": null, "callbacks_on_checkpoint_loaded": null, "callbacks_on_environment_created": null, "callbacks_on_episode_created": null, "callbacks_on_episode_start": null, "callbacks_on_episode_step": null, "callbacks_on_episode_end": null, "callbacks_on_evaluate_start": null, "callbacks_on_evaluate_end": null, "callbacks_on_evaluate_offline_start": null, "callbacks_on_evaluate_offline_end": null, "callbacks_on_sample_end": null, "callbacks_on_train_result": null, "explore": true, "enable_rl_module_and_learner": true, "enable_env_runner_and_connector_v2": true, "_prior_exploration_config": {"type": "StochasticSampling"}, "count_steps_by": "env_steps", "policy_map_capacity": 100, "policy_mapping_fn": "<function AlgorithmConfig.DEFAULT_POLICY_MAPPING_FN at 0x13e6b9b20>", "policies_to_train": null, "policy_states_are_swappable": false, "observation_fn": null, "offline_data_class": null, "input_read_method": "read_parquet", "input_read_method_kwargs": {}, "input_read_schema": {}, "input_read_episodes": false, "input_read_sample_batches": false, "input_read_batch_size": null, "input_filesystem": null, "input_filesystem_kwargs": {}, "input_compress_columns": ["obs", "new_obs"], "input_spaces_jsonable": true, "materialize_data": false, "materialize_mapped_data": true, "map_batches_kwargs": {}, "iter_batches_kwargs": {}, "ignore_final_observation": false, "prelearner_class": null, "prelearner_buffer_class": null, "prelearner_buffer_kwargs": {}, "prelearner_module_synch_period": 10, "dataset_num_iters_per_learner": null, "input_config": {}, "actions_in_input_normalized": false, "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_config": {}, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "output_max_rows_per_file": null, "output_write_remaining_data": false, "output_write_method": "write_parquet", "output_write_method_kwargs": {}, "output_filesystem": null, "output_filesystem_kwargs": {}, "output_write_episodes": true, "offline_sampling": false, "evaluation_interval": 1, "evaluation_duration": 20, "evaluation_duration_unit": "episodes", "evaluation_sample_timeout_s": 120.0, "evaluation_auto_duration_min_env_steps_per_sample": 100, "evaluation_auto_duration_max_env_steps_per_sample": 2000, "evaluation_parallel_to_training": false, "evaluation_force_reset_envs_before_iteration": true, "evaluation_config": null, "off_policy_estimation_methods": {}, "ope_split_batch_by_episode": true, "evaluation_num_env_runners": 1, "in_evaluation": false, "sync_filters_on_rollout_workers_timeout_s": 10.0, "offline_evaluation_interval": null, "num_offline_eval_runners": 0, "offline_loss_for_module_fn": null, "offline_evaluation_duration": 1, "offline_evaluation_parallel_to_training": false, "offline_evaluation_timeout_s": 120.0, "num_cpus_per_offline_eval_runner": 1, "num_gpus_per_offline_eval_runner": 0, "custom_resources_per_offline_eval_runner": {}, "restart_failed_offline_eval_runners": true, "ignore_offline_eval_runner_failures": false, "max_num_offline_eval_runner_restarts": 1000, "offline_eval_runner_restore_timeout_s": 1800.0, "max_requests_in_flight_per_offline_eval_runner": 1, "validate_offline_eval_runners_after_construction": true, "offline_eval_runner_health_probe_timeout_s": 30.0, "offline_eval_rl_module_inference_only": false, "broadcast_offline_eval_runner_states": false, "offline_eval_batch_size_per_runner": 256, "dataset_num_iters_per_eval_runner": 1, "keep_per_episode_custom_metrics": false, "metrics_episode_collection_timeout_s": 60.0, "metrics_num_episodes_for_smoothing": 100, "min_time_s_per_iteration": null, "min_train_timesteps_per_iteration": 0, "min_sample_timesteps_per_iteration": 0, "log_gradients": true, "export_native_model_files": false, "checkpoint_trainable_policies_only": false, "logger_creator": null, "logger_config": null, "log_level": "WARN", "log_sys_usage": true, "fake_sampler": false, "seed": 10, "restart_failed_env_runners": true, "ignore_env_runner_failures": false, "max_num_env_runner_restarts": 1000, "delay_between_env_runner_restarts_s": 60.0, "restart_failed_sub_environments": false, "num_consecutive_env_runner_failures_tolerance": 100, "env_runner_health_probe_timeout_s": 30.0, "env_runner_restore_timeout_s": 1800.0, "_model_config": {}, "_rl_module_spec": "RLModuleSpec(module_class=None, observation_space=None, action_space=None, inference_only=False, learner_only=False, model_config=DefaultModelConfig(fcnet_hiddens=[60, 90], fcnet_activation='tanh', fcnet_kernel_initializer=None, fcnet_kernel_initializer_kwargs=None, fcnet_bias_initializer=None, fcnet_bias_initializer_kwargs=None, conv_filters=None, conv_activation='relu', conv_kernel_initializer=None, conv_kernel_initializer_kwargs=None, conv_bias_initializer=None, conv_bias_initializer_kwargs=None, head_fcnet_hiddens=[], head_fcnet_activation='relu', head_fcnet_kernel_initializer=None, head_fcnet_kernel_initializer_kwargs=None, head_fcnet_bias_initializer=None, head_fcnet_bias_initializer_kwargs=None, free_log_std=False, log_std_clip_param=20.0, vf_share_layers=True, use_lstm=False, max_seq_len=20, lstm_cell_size=256, lstm_use_prev_action=False, lstm_use_prev_reward=False, lstm_kernel_initializer=None, lstm_kernel_initializer_kwargs=None, lstm_bias_initializer=None, lstm_bias_initializer_kwargs=None), catalog_class=None, load_state_path=None, model_config_dict=None)", "algorithm_config_overrides_per_module": {}, "_per_module_overrides": {}, "_validate_config": true, "_use_msgpack_checkpoints": false, "_torch_grad_scaler_class": null, "_torch_lr_scheduler_classes": null, "_tf_policy_handles_more_than_one_loss": false, "_disable_preprocessor_api": false, "_disable_action_flattening": false, "_disable_initialize_loss_from_dummy_batch": false, "_dont_auto_sync_env_runner_states": false, "env_task_fn": -1, "enable_connectors": -1, "simple_optimizer": false, "policy_map_cache": -1, "worker_cls": -1, "synchronize_filters": -1, "enable_async_evaluation": -1, "custom_async_evaluation_function": -1, "_enable_rl_module_api": -1, "auto_wrap_old_gym_envs": -1, "always_attach_evaluation_results": -1, "replay_sequence_length": null, "_disable_execution_plan_api": -1, "use_critic": true, "use_gae": true, "use_kl_loss": true, "kl_coeff": 0.7464963036515, "kl_target": 0.0270990929592, "vf_loss_coeff": 0.6688075857018, "entropy_coeff": 0.0090570820258, "clip_param": 0.1221781641624, "vf_clip_param": 0.1027808522125, "entropy_coeff_schedule": null, "lr_schedule": null, "sgd_minibatch_size": -1, "vf_share_layers": -1, "__stdout_file__": null, "__stderr_file__": null, "lambda": 0.9099046732075, "input": "sampler", "policies": {"default_policy": [null, null, null, null]}, "callbacks": "<class 'ray.rllib.callbacks.callbacks.RLlibCallback'>", "create_env_on_driver": false, "custom_eval_function": null, "framework": "torch"}, "time_since_restore": 4.816421747207642, "iterations_since_restore": 1, "perf": {"cpu_util_percent": 50.57142857142857, "ram_util_percent": 81.55714285714285}}
{"timers": {"training_iteration": 4.588776356191374, "restore_env_runners": 1.4645118499174714e-05, "training_step": 4.588420724639436, "env_runner_sampling_timer": 4.388199835052946, "learner_update_timer": 0.19125674627604894, "synch_weights": 0.002298415834084153, "restore_eval_env_runners": 1.8666964024305344e-05, "evaluation_iteration": 0.20605004101525992, "synch_eval_env_connectors": 0.0002531670033931732, "synch_env_connectors": 4.542060196399689e-06}, "env_runners": {"weights_seq_no": 1.0, "env_to_module_connector": {"timers": {"connectors": {"add_states_from_episodes_to_batch": 2.6539297785926185e-06, "batch_individual_items": 1.2280053303542757e-05, "add_observations_from_episodes_to_batch": 4.90318584034855e-06, "add_time_dim_to_batch_and_zero_pad": 3.87645405899303e-06, "numpy_to_tensor": 1.7985260964131274e-05}}, "connector_pipeline_timer": 7.575874507366967e-05}, "num_env_steps_sampled": 5000.0, "module_episode_returns_mean": {"default_policy": -1.3799999999999994}, "sample": 0.012013703610139788, "num_module_steps_sampled": {"default_policy": 5000.0}, "num_episodes": 250.0, "module_to_env_connector": {"connector_pipeline_timer": 0.0002005378223220386, "timers": {"connectors": {"tensor_to_numpy": 2.5291135583124686e-05, "get_actions": 8.483831113408249e-05, "un_batch_to_individual_items": 9.721111845731733e-06, "normalize_and_clip_actions": 1.6344752093896992e-05, "listify_data_for_vector_env": 2.0444097920512335e-05, "remove_single_ts_time_rank_from_batch": 1.006431756922892e-06}}}, "time_between_sampling": 0.0028431882407652957, "num_env_steps_sampled_lifetime": 10000.0, "episode_return_mean": -1.3799999999999994, "episode_return_min": -10.5, "agent_episode_returns_mean": {"default_agent": -1.3799999999999994}, "episode_duration_sec_mean": 0.008549901321996, "env_to_module_sum_episodes_length_out": 10.36823839457432, "episode_len_mean": 20.0, "env_reset_timer": 0.00011031788102298142, "num_agent_steps_sampled_lifetime": {"default_agent": 10000.0}, "num_episodes_lifetime": 500.0, "episode_len_max": 20, "rlmodule_inference_timer": 5.731887710199182e-05, "env_to_module_sum_episodes_length_in": 10.36823839457432, "num_agent_steps_sampled": {"default_agent": 5000.0}, "episode_return_max": 9.5, "episode_len_min": 20, "env_step_timer": 2.71051269221468e-05, "num_module_steps_sampled_lifetime": {"default_policy": 10000.0}, "num_env_steps_sampled_lifetime_throughput": 2299.104129028081}, "learners": {"__all_modules__": {"learner_connector": {"timers": {"connectors": {"add_time_dim_to_batch_and_zero_pad": 1.6588433645665645e-05, "add_observations_from_episodes_to_batch": 0.0008950906968675554, "add_states_from_episodes_to_batch": 3.964756615459919e-06, "add_columns_from_episodes_to_train_batch": 0.049153567766770725, "batch_individual_items": 0.04808338327682577, "add_one_ts_to_episodes_and_truncate": 0.010758444843813776, "numpy_to_tensor": 0.00012369367643259467, "general_advantage_estimation": 0.008662146892165766}}, "connector_pipeline_timer": 0.11793657723465002}, "num_env_steps_trained_lifetime": 63000, "num_module_steps_trained": 6000, "num_trainable_parameters": 6003, "learner_connector_sum_episodes_length_in": 5000.0, "num_non_trainable_parameters": 0, "learner_connector_sum_episodes_length_out": 5250.0, "num_env_steps_trained": 31500, "num_module_steps_trained_lifetime": 12000, "num_env_steps_trained_lifetime_throughput": 823250.481041226, "num_module_steps_trained_throughput": 157251.91835481758, "num_module_steps_trained_lifetime_throughput": 157074.3479435839}, "default_policy": {"gradients_default_optimizer_global_norm": 0.09314917027950287, "entropy": 0.691680371761322, "vf_explained_var": -0.009900569915771484, "mean_kl_loss": 0.0005508643225766718, "num_module_steps_trained_lifetime": 12000, "vf_loss": 0.10278083384037018, "default_optimizer_learning_rate": 0.0002847858517, "curr_kl_coeff": 0.18662407994270325, "module_train_batch_size_mean": 1000.0, "num_module_steps_trained": 6000, "num_trainable_parameters": 6003, "weights_seq_no": 2.0, "policy_loss": -0.00450977822765708, "diff_num_grad_updates_vs_sampler_policy": 1.0, "vf_loss_unclipped": 28.727876663208008, "curr_entropy_coeff": 0.0090570820258, "total_loss": 0.05817184969782829, "num_module_steps_trained_lifetime_throughput": 157528.79349511268}}, "num_training_step_calls_per_iteration": 1, "evaluation": {"env_runners": {"episode_len_min": 20, "episode_return_max": 13.5, "num_env_steps_sampled": 400, "sample": 0.18958342714700846, "env_to_module_connector": {"timers": {"connectors": {"add_observations_from_episodes_to_batch": 3.38369694005528e-06, "add_states_from_episodes_to_batch": 1.843158888085891e-06, "batch_individual_items": 8.176180681394638e-06, "numpy_to_tensor": 1.2461110608343842e-05, "add_time_dim_to_batch_and_zero_pad": 3.0053008480777186e-06}}, "connector_pipeline_timer": 5.494717525514614e-05}, "num_episodes": 20, "num_env_steps_sampled_lifetime": 10400, "episode_len_max": 20, "module_to_env_connector": {"timers": {"connectors": {"tensor_to_numpy": 1.7326859004936206e-05, "get_actions": 5.3875006442719474e-05, "un_batch_to_individual_items": 6.82798653753307e-06, "normalize_and_clip_actions": 1.2740259435238275e-05, "listify_data_for_vector_env": 1.4257178799073682e-05, "remove_single_ts_time_rank_from_batch": 1.0011891684250984e-06}}, "connector_pipeline_timer": 0.00013774282309618032}, "episode_return_min": -12.5, "env_to_module_sum_episodes_length_out": 10.366003441359926, "num_agent_steps_sampled": {"default_agent": 400}, "module_episode_returns_mean": {"default_policy": -2.55}, "rlmodule_inference_timer": 3.8211439198278065e-05, "env_to_module_sum_episodes_length_in": 10.366003441359926, "env_step_timer": 2.016638789521856e-05, "num_agent_steps_sampled_lifetime": {"default_agent": 800}, "episode_len_mean": 20.0, "env_reset_timer": 0.0007310625910758972, "num_module_steps_sampled_lifetime": {"default_policy": 800}, "num_episodes_lifetime": 40, "num_module_steps_sampled": {"default_policy": 400}, "agent_episode_returns_mean": {"default_agent": -2.55}, "weights_seq_no": 2.0, "episode_return_mean": -2.55, "episode_duration_sec_mean": 0.0074404677638085556, "time_between_sampling": 2.9267677089665085}, "num_healthy_workers": 1, "actor_manager_num_outstanding_async_reqs": 0, "num_remote_worker_restarts": 0}, "num_env_steps_sampled_lifetime": 10000.0, "fault_tolerance": {"num_healthy_workers": 0, "num_remote_worker_restarts": 0}, "env_runner_group": {"actor_manager_num_outstanding_async_reqs": 0}, "done": false, "training_iteration": 2, "trial_id": "49ef3_00000", "date": "2025-08-11_19-30-37", "timestamp": 1754933437, "time_this_iter_s": 3.036165237426758, "time_total_s": 7.852586984634399, "pid": 23180, "hostname": "Mac", "node_ip": "127.0.0.1", "config": {"exploration_config": {}, "extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "placement_strategy": "PACK", "num_gpus": 0, "_fake_gpus": false, "num_cpus_for_main_process": 2, "eager_tracing": true, "eager_max_retraces": 20, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "torch_compile_learner": false, "torch_compile_learner_what_to_compile": "forward_train", "torch_compile_learner_dynamo_backend": "aot_eager", "torch_compile_learner_dynamo_mode": null, "torch_compile_worker": false, "torch_compile_worker_dynamo_backend": "aot_eager", "torch_compile_worker_dynamo_mode": null, "torch_ddp_kwargs": {}, "torch_skip_nan_gradients": false, "env": "Umbrella", "env_config": {}, "observation_space": null, "action_space": null, "clip_rewards": null, "normalize_actions": true, "clip_actions": false, "_is_atari": null, "disable_env_checking": false, "render_env": false, "action_mask_key": "action_mask", "env_runner_cls": null, "num_env_runners": 0, "create_local_env_runner": true, "num_envs_per_env_runner": 1, "gym_env_vectorize_mode": "SYNC", "num_cpus_per_env_runner": 1, "num_gpus_per_env_runner": 0, "custom_resources_per_env_runner": {}, "validate_env_runners_after_construction": true, "episodes_to_numpy": true, "max_requests_in_flight_per_env_runner": 1, "sample_timeout_s": 60.0, "_env_to_module_connector": null, "add_default_connectors_to_env_to_module_pipeline": true, "_module_to_env_connector": null, "add_default_connectors_to_module_to_env_pipeline": true, "merge_env_runner_states": "training_only", "broadcast_env_runner_states": true, "episode_lookback_horizon": 1, "rollout_fragment_length": "auto", "batch_mode": "complete_episodes", "compress_observations": false, "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "enable_tf1_exec_eagerly": false, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "preprocessor_pref": "deepmind", "observation_filter": "NoFilter", "update_worker_filter_stats": true, "use_worker_filter_stats": true, "sampler_perf_stats_ema_coef": null, "_is_online": true, "num_learners": 0, "num_gpus_per_learner": 0, "num_cpus_per_learner": "auto", "num_aggregator_actors_per_learner": 0, "max_requests_in_flight_per_aggregator_actor": 3, "local_gpu_idx": 0, "max_requests_in_flight_per_learner": 3, "gamma": 1, "lr": 0.0002847858517, "grad_clip": 0.5, "grad_clip_by": "global_norm", "_train_batch_size_per_learner": 5000, "train_batch_size": 4000, "num_epochs": 1, "minibatch_size": 1000, "shuffle_batch_per_epoch": true, "model": {"fcnet_hiddens": [256, 256], "fcnet_activation": "tanh", "fcnet_weights_initializer": null, "fcnet_weights_initializer_config": null, "fcnet_bias_initializer": null, "fcnet_bias_initializer_config": null, "conv_filters": null, "conv_activation": "relu", "conv_kernel_initializer": null, "conv_kernel_initializer_config": null, "conv_bias_initializer": null, "conv_bias_initializer_config": null, "conv_transpose_kernel_initializer": null, "conv_transpose_kernel_initializer_config": null, "conv_transpose_bias_initializer": null, "conv_transpose_bias_initializer_config": null, "post_fcnet_hiddens": [], "post_fcnet_activation": "relu", "post_fcnet_weights_initializer": null, "post_fcnet_weights_initializer_config": null, "post_fcnet_bias_initializer": null, "post_fcnet_bias_initializer_config": null, "free_log_std": false, "log_std_clip_param": 20.0, "no_final_linear": false, "vf_share_layers": false, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "lstm_weights_initializer": null, "lstm_weights_initializer_config": null, "lstm_bias_initializer": null, "lstm_bias_initializer_config": null, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "attention_use_n_prev_actions": 0, "attention_use_n_prev_rewards": 0, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": null, "custom_model_config": {}, "custom_action_dist": null, "custom_preprocessor": null, "encoder_latent_dim": null, "always_check_shapes": false, "lstm_use_prev_action_reward": -1, "_use_default_native_models": -1, "_disable_preprocessor_api": false, "_disable_action_flattening": false}, "_learner_connector": null, "add_default_connectors_to_learner_pipeline": true, "learner_config_dict": {}, "optimizer": {}, "_learner_class": null, "callbacks_on_algorithm_init": null, "callbacks_on_env_runners_recreated": null, "callbacks_on_offline_eval_runners_recreated": null, "callbacks_on_checkpoint_loaded": null, "callbacks_on_environment_created": null, "callbacks_on_episode_created": null, "callbacks_on_episode_start": null, "callbacks_on_episode_step": null, "callbacks_on_episode_end": null, "callbacks_on_evaluate_start": null, "callbacks_on_evaluate_end": null, "callbacks_on_evaluate_offline_start": null, "callbacks_on_evaluate_offline_end": null, "callbacks_on_sample_end": null, "callbacks_on_train_result": null, "explore": true, "enable_rl_module_and_learner": true, "enable_env_runner_and_connector_v2": true, "_prior_exploration_config": {"type": "StochasticSampling"}, "count_steps_by": "env_steps", "policy_map_capacity": 100, "policy_mapping_fn": "<function AlgorithmConfig.DEFAULT_POLICY_MAPPING_FN at 0x13e6b9b20>", "policies_to_train": null, "policy_states_are_swappable": false, "observation_fn": null, "offline_data_class": null, "input_read_method": "read_parquet", "input_read_method_kwargs": {}, "input_read_schema": {}, "input_read_episodes": false, "input_read_sample_batches": false, "input_read_batch_size": null, "input_filesystem": null, "input_filesystem_kwargs": {}, "input_compress_columns": ["obs", "new_obs"], "input_spaces_jsonable": true, "materialize_data": false, "materialize_mapped_data": true, "map_batches_kwargs": {}, "iter_batches_kwargs": {}, "ignore_final_observation": false, "prelearner_class": null, "prelearner_buffer_class": null, "prelearner_buffer_kwargs": {}, "prelearner_module_synch_period": 10, "dataset_num_iters_per_learner": null, "input_config": {}, "actions_in_input_normalized": false, "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_config": {}, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "output_max_rows_per_file": null, "output_write_remaining_data": false, "output_write_method": "write_parquet", "output_write_method_kwargs": {}, "output_filesystem": null, "output_filesystem_kwargs": {}, "output_write_episodes": true, "offline_sampling": false, "evaluation_interval": 1, "evaluation_duration": 20, "evaluation_duration_unit": "episodes", "evaluation_sample_timeout_s": 120.0, "evaluation_auto_duration_min_env_steps_per_sample": 100, "evaluation_auto_duration_max_env_steps_per_sample": 2000, "evaluation_parallel_to_training": false, "evaluation_force_reset_envs_before_iteration": true, "evaluation_config": null, "off_policy_estimation_methods": {}, "ope_split_batch_by_episode": true, "evaluation_num_env_runners": 1, "in_evaluation": false, "sync_filters_on_rollout_workers_timeout_s": 10.0, "offline_evaluation_interval": null, "num_offline_eval_runners": 0, "offline_loss_for_module_fn": null, "offline_evaluation_duration": 1, "offline_evaluation_parallel_to_training": false, "offline_evaluation_timeout_s": 120.0, "num_cpus_per_offline_eval_runner": 1, "num_gpus_per_offline_eval_runner": 0, "custom_resources_per_offline_eval_runner": {}, "restart_failed_offline_eval_runners": true, "ignore_offline_eval_runner_failures": false, "max_num_offline_eval_runner_restarts": 1000, "offline_eval_runner_restore_timeout_s": 1800.0, "max_requests_in_flight_per_offline_eval_runner": 1, "validate_offline_eval_runners_after_construction": true, "offline_eval_runner_health_probe_timeout_s": 30.0, "offline_eval_rl_module_inference_only": false, "broadcast_offline_eval_runner_states": false, "offline_eval_batch_size_per_runner": 256, "dataset_num_iters_per_eval_runner": 1, "keep_per_episode_custom_metrics": false, "metrics_episode_collection_timeout_s": 60.0, "metrics_num_episodes_for_smoothing": 100, "min_time_s_per_iteration": null, "min_train_timesteps_per_iteration": 0, "min_sample_timesteps_per_iteration": 0, "log_gradients": true, "export_native_model_files": false, "checkpoint_trainable_policies_only": false, "logger_creator": null, "logger_config": null, "log_level": "WARN", "log_sys_usage": true, "fake_sampler": false, "seed": 10, "restart_failed_env_runners": true, "ignore_env_runner_failures": false, "max_num_env_runner_restarts": 1000, "delay_between_env_runner_restarts_s": 60.0, "restart_failed_sub_environments": false, "num_consecutive_env_runner_failures_tolerance": 100, "env_runner_health_probe_timeout_s": 30.0, "env_runner_restore_timeout_s": 1800.0, "_model_config": {}, "_rl_module_spec": "RLModuleSpec(module_class=None, observation_space=None, action_space=None, inference_only=False, learner_only=False, model_config=DefaultModelConfig(fcnet_hiddens=[60, 90], fcnet_activation='tanh', fcnet_kernel_initializer=None, fcnet_kernel_initializer_kwargs=None, fcnet_bias_initializer=None, fcnet_bias_initializer_kwargs=None, conv_filters=None, conv_activation='relu', conv_kernel_initializer=None, conv_kernel_initializer_kwargs=None, conv_bias_initializer=None, conv_bias_initializer_kwargs=None, head_fcnet_hiddens=[], head_fcnet_activation='relu', head_fcnet_kernel_initializer=None, head_fcnet_kernel_initializer_kwargs=None, head_fcnet_bias_initializer=None, head_fcnet_bias_initializer_kwargs=None, free_log_std=False, log_std_clip_param=20.0, vf_share_layers=True, use_lstm=False, max_seq_len=20, lstm_cell_size=256, lstm_use_prev_action=False, lstm_use_prev_reward=False, lstm_kernel_initializer=None, lstm_kernel_initializer_kwargs=None, lstm_bias_initializer=None, lstm_bias_initializer_kwargs=None), catalog_class=None, load_state_path=None, model_config_dict=None)", "algorithm_config_overrides_per_module": {}, "_per_module_overrides": {}, "_validate_config": true, "_use_msgpack_checkpoints": false, "_torch_grad_scaler_class": null, "_torch_lr_scheduler_classes": null, "_tf_policy_handles_more_than_one_loss": false, "_disable_preprocessor_api": false, "_disable_action_flattening": false, "_disable_initialize_loss_from_dummy_batch": false, "_dont_auto_sync_env_runner_states": false, "env_task_fn": -1, "enable_connectors": -1, "simple_optimizer": false, "policy_map_cache": -1, "worker_cls": -1, "synchronize_filters": -1, "enable_async_evaluation": -1, "custom_async_evaluation_function": -1, "_enable_rl_module_api": -1, "auto_wrap_old_gym_envs": -1, "always_attach_evaluation_results": -1, "replay_sequence_length": null, "_disable_execution_plan_api": -1, "use_critic": true, "use_gae": true, "use_kl_loss": true, "kl_coeff": 0.7464963036515, "kl_target": 0.0270990929592, "vf_loss_coeff": 0.6688075857018, "entropy_coeff": 0.0090570820258, "clip_param": 0.1221781641624, "vf_clip_param": 0.1027808522125, "entropy_coeff_schedule": null, "lr_schedule": null, "sgd_minibatch_size": -1, "vf_share_layers": -1, "__stdout_file__": null, "__stderr_file__": null, "lambda": 0.9099046732075, "input": "sampler", "policies": {"default_policy": [null, null, null, null]}, "callbacks": "<class 'ray.rllib.callbacks.callbacks.RLlibCallback'>", "create_env_on_driver": false, "custom_eval_function": null, "framework": "torch"}, "time_since_restore": 7.852586984634399, "iterations_since_restore": 2, "perf": {"cpu_util_percent": 62.419999999999995, "ram_util_percent": 80.28}}
{"timers": {"training_iteration": 4.579849801380187, "restore_env_runners": 1.4562417508568615e-05, "training_step": 4.579495464473462, "env_runner_sampling_timer": 4.379634514622471, "learner_update_timer": 0.19094777173387117, "synch_weights": 0.0022826629252173007, "restore_eval_env_runners": 1.8572794506326317e-05, "evaluation_iteration": 0.20541194477467797, "synch_eval_env_connectors": 0.00025221324409358204, "synch_env_connectors": 4.5441405382007355e-06}, "env_runners": {"weights_seq_no": 2.0, "env_to_module_connector": {"timers": {"connectors": {"add_states_from_episodes_to_batch": 3.557831353617842e-06, "batch_individual_items": 1.5744688924908783e-05, "add_observations_from_episodes_to_batch": 7.2950766979128486e-06, "add_time_dim_to_batch_and_zero_pad": 5.32276542913844e-06, "numpy_to_tensor": 2.496008279582636e-05}}, "connector_pipeline_timer": 0.00010151695048754115}, "num_env_steps_sampled": 5000.0, "module_episode_returns_mean": {"default_policy": -1.1400000000000001}, "sample": 0.011793723715310761, "num_module_steps_sampled": {"default_policy": 5000.0}, "num_episodes": 250.0, "module_to_env_connector": {"connector_pipeline_timer": 0.0002746557200840054, "timers": {"connectors": {"tensor_to_numpy": 3.372921723510845e-05, "get_actions": 0.00012205797531131482, "un_batch_to_individual_items": 1.2214286385382941e-05, "normalize_and_clip_actions": 2.2167668343428238e-05, "listify_data_for_vector_env": 2.7246772751182145e-05, "remove_single_ts_time_rank_from_batch": 1.2867086887439574e-06}}}, "time_between_sampling": 0.003175413089392244, "num_env_steps_sampled_lifetime": -607500.0, "episode_return_mean": -1.1400000000000001, "episode_return_min": -10.5, "agent_episode_returns_mean": {"default_agent": -1.1400000000000001}, "episode_duration_sec_mean": 0.011961370998527851, "env_to_module_sum_episodes_length_out": 10.36823839457432, "episode_len_mean": 20.0, "env_reset_timer": 9.326037754561968e-05, "num_agent_steps_sampled_lifetime": {"default_agent": -607500.0}, "num_episodes_lifetime": -30375.0, "episode_len_max": 20, "rlmodule_inference_timer": 8.08874299822239e-05, "env_to_module_sum_episodes_length_in": 10.36823839457432, "num_agent_steps_sampled": {"default_agent": 5000.0}, "episode_return_max": 9.5, "episode_len_min": 20, "env_step_timer": 3.840250148345576e-05, "num_module_steps_sampled_lifetime": {"default_policy": -607500.0}, "num_env_steps_sampled_lifetime_throughput": 1993.0598542465923}, "learners": {"__all_modules__": {"learner_connector": {"timers": {"connectors": {"add_time_dim_to_batch_and_zero_pad": 1.6599629819393156e-05, "add_observations_from_episodes_to_batch": 0.0008957802102202549, "add_states_from_episodes_to_batch": 3.965939395129681e-06, "add_columns_from_episodes_to_train_batch": 0.049406509179295975, "batch_individual_items": 0.04813266944453353, "add_one_ts_to_episodes_and_truncate": 0.010744745395472273, "numpy_to_tensor": 0.0001231713190325536, "general_advantage_estimation": 0.008636585833469873}}, "connector_pipeline_timer": 0.11819890271237816}, "num_env_steps_trained_lifetime": 94500, "num_module_steps_trained": 6000, "num_trainable_parameters": 6003, "learner_connector_sum_episodes_length_in": 5000.0, "num_non_trainable_parameters": 0, "learner_connector_sum_episodes_length_out": 5250.0, "num_env_steps_trained": 31500, "num_module_steps_trained_lifetime": 18000, "num_env_steps_trained_lifetime_throughput": 841906.1917393773, "num_module_steps_trained_throughput": 160798.22163060913, "num_module_steps_trained_lifetime_throughput": 160620.59372736912}, "default_policy": {"gradients_default_optimizer_global_norm": 0.03816163167357445, "entropy": 0.6914566159248352, "vf_explained_var": -0.010045528411865234, "mean_kl_loss": 0.0010828013764694333, "num_module_steps_trained_lifetime": 18000, "vf_loss": 0.10278083384037018, "default_optimizer_learning_rate": 0.0002847858517, "curr_kl_coeff": 0.09331203997135162, "module_train_batch_size_mean": 1000.0, "num_module_steps_trained": 6000, "num_trainable_parameters": 6003, "weights_seq_no": 3.0, "policy_loss": -0.007170871365815401, "diff_num_grad_updates_vs_sampler_policy": 1.0, "vf_loss_unclipped": 28.677812576293945, "curr_entropy_coeff": 0.0090570820258, "total_loss": 0.05550922453403473, "num_module_steps_trained_lifetime_throughput": 161056.55575098025}}, "num_training_step_calls_per_iteration": 1, "evaluation": {"env_runners": {"episode_len_min": 20, "episode_return_max": 13.5, "num_env_steps_sampled": 400, "sample": 0.18934248287589286, "env_to_module_connector": {"timers": {"connectors": {"add_observations_from_episodes_to_batch": 4.32996651029958e-06, "add_states_from_episodes_to_batch": 2.139940922182006e-06, "batch_individual_items": 1.0385713947137325e-05, "numpy_to_tensor": 1.3702903992310169e-05, "add_time_dim_to_batch_and_zero_pad": 3.9091984835173545e-06}}, "connector_pipeline_timer": 6.397580145740496e-05}, "num_episodes": 20, "num_env_steps_sampled_lifetime": 15400, "episode_len_max": 20, "module_to_env_connector": {"timers": {"connectors": {"tensor_to_numpy": 2.195586427781288e-05, "get_actions": 6.88732399990297e-05, "un_batch_to_individual_items": 8.613421648954374e-06, "normalize_and_clip_actions": 1.4200442255258155e-05, "listify_data_for_vector_env": 1.803189973137471e-05, "remove_single_ts_time_rank_from_batch": 9.449979406844004e-07}}, "connector_pipeline_timer": 0.0001698528719121484}, "episode_return_min": -14.5, "env_to_module_sum_episodes_length_out": 10.368205581254823, "num_agent_steps_sampled": {"default_agent": 400}, "module_episode_returns_mean": {"default_policy": -2.55}, "rlmodule_inference_timer": 4.895759968190445e-05, "env_to_module_sum_episodes_length_in": 10.368205581254823, "env_step_timer": 2.324200658772595e-05, "num_agent_steps_sampled_lifetime": {"default_agent": 1200}, "episode_len_mean": 20.0, "env_reset_timer": 0.0007248973848298192, "num_module_steps_sampled_lifetime": {"default_policy": 1200}, "num_episodes_lifetime": 60, "num_module_steps_sampled": {"default_policy": 400}, "agent_episode_returns_mean": {"default_agent": -2.55}, "weights_seq_no": 3.0, "episode_return_mean": -2.55, "episode_duration_sec_mean": 0.007490070111816749, "time_between_sampling": 2.934706772706704}, "num_healthy_workers": 1, "actor_manager_num_outstanding_async_reqs": 0, "num_remote_worker_restarts": 0}, "num_env_steps_sampled_lifetime": -607500.0, "fault_tolerance": {"num_healthy_workers": 0, "num_remote_worker_restarts": 0}, "env_runner_group": {"actor_manager_num_outstanding_async_reqs": 0}, "done": false, "training_iteration": 3, "trial_id": "49ef3_00000", "date": "2025-08-11_19-30-41", "timestamp": 1754933441, "time_this_iter_s": 3.8722448348999023, "time_total_s": 11.724831819534302, "pid": 23180, "hostname": "Mac", "node_ip": "127.0.0.1", "config": {"exploration_config": {}, "extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "placement_strategy": "PACK", "num_gpus": 0, "_fake_gpus": false, "num_cpus_for_main_process": 2, "eager_tracing": true, "eager_max_retraces": 20, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "torch_compile_learner": false, "torch_compile_learner_what_to_compile": "forward_train", "torch_compile_learner_dynamo_backend": "aot_eager", "torch_compile_learner_dynamo_mode": null, "torch_compile_worker": false, "torch_compile_worker_dynamo_backend": "aot_eager", "torch_compile_worker_dynamo_mode": null, "torch_ddp_kwargs": {}, "torch_skip_nan_gradients": false, "env": "Umbrella", "env_config": {}, "observation_space": null, "action_space": null, "clip_rewards": null, "normalize_actions": true, "clip_actions": false, "_is_atari": null, "disable_env_checking": false, "render_env": false, "action_mask_key": "action_mask", "env_runner_cls": null, "num_env_runners": 0, "create_local_env_runner": true, "num_envs_per_env_runner": 1, "gym_env_vectorize_mode": "SYNC", "num_cpus_per_env_runner": 1, "num_gpus_per_env_runner": 0, "custom_resources_per_env_runner": {}, "validate_env_runners_after_construction": true, "episodes_to_numpy": true, "max_requests_in_flight_per_env_runner": 1, "sample_timeout_s": 60.0, "_env_to_module_connector": null, "add_default_connectors_to_env_to_module_pipeline": true, "_module_to_env_connector": null, "add_default_connectors_to_module_to_env_pipeline": true, "merge_env_runner_states": "training_only", "broadcast_env_runner_states": true, "episode_lookback_horizon": 1, "rollout_fragment_length": "auto", "batch_mode": "complete_episodes", "compress_observations": false, "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "enable_tf1_exec_eagerly": false, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "preprocessor_pref": "deepmind", "observation_filter": "NoFilter", "update_worker_filter_stats": true, "use_worker_filter_stats": true, "sampler_perf_stats_ema_coef": null, "_is_online": true, "num_learners": 0, "num_gpus_per_learner": 0, "num_cpus_per_learner": "auto", "num_aggregator_actors_per_learner": 0, "max_requests_in_flight_per_aggregator_actor": 3, "local_gpu_idx": 0, "max_requests_in_flight_per_learner": 3, "gamma": 1, "lr": 0.0002847858517, "grad_clip": 0.5, "grad_clip_by": "global_norm", "_train_batch_size_per_learner": 5000, "train_batch_size": 4000, "num_epochs": 1, "minibatch_size": 1000, "shuffle_batch_per_epoch": true, "model": {"fcnet_hiddens": [256, 256], "fcnet_activation": "tanh", "fcnet_weights_initializer": null, "fcnet_weights_initializer_config": null, "fcnet_bias_initializer": null, "fcnet_bias_initializer_config": null, "conv_filters": null, "conv_activation": "relu", "conv_kernel_initializer": null, "conv_kernel_initializer_config": null, "conv_bias_initializer": null, "conv_bias_initializer_config": null, "conv_transpose_kernel_initializer": null, "conv_transpose_kernel_initializer_config": null, "conv_transpose_bias_initializer": null, "conv_transpose_bias_initializer_config": null, "post_fcnet_hiddens": [], "post_fcnet_activation": "relu", "post_fcnet_weights_initializer": null, "post_fcnet_weights_initializer_config": null, "post_fcnet_bias_initializer": null, "post_fcnet_bias_initializer_config": null, "free_log_std": false, "log_std_clip_param": 20.0, "no_final_linear": false, "vf_share_layers": false, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "lstm_weights_initializer": null, "lstm_weights_initializer_config": null, "lstm_bias_initializer": null, "lstm_bias_initializer_config": null, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "attention_use_n_prev_actions": 0, "attention_use_n_prev_rewards": 0, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": null, "custom_model_config": {}, "custom_action_dist": null, "custom_preprocessor": null, "encoder_latent_dim": null, "always_check_shapes": false, "lstm_use_prev_action_reward": -1, "_use_default_native_models": -1, "_disable_preprocessor_api": false, "_disable_action_flattening": false}, "_learner_connector": null, "add_default_connectors_to_learner_pipeline": true, "learner_config_dict": {}, "optimizer": {}, "_learner_class": null, "callbacks_on_algorithm_init": null, "callbacks_on_env_runners_recreated": null, "callbacks_on_offline_eval_runners_recreated": null, "callbacks_on_checkpoint_loaded": null, "callbacks_on_environment_created": null, "callbacks_on_episode_created": null, "callbacks_on_episode_start": null, "callbacks_on_episode_step": null, "callbacks_on_episode_end": null, "callbacks_on_evaluate_start": null, "callbacks_on_evaluate_end": null, "callbacks_on_evaluate_offline_start": null, "callbacks_on_evaluate_offline_end": null, "callbacks_on_sample_end": null, "callbacks_on_train_result": null, "explore": true, "enable_rl_module_and_learner": true, "enable_env_runner_and_connector_v2": true, "_prior_exploration_config": {"type": "StochasticSampling"}, "count_steps_by": "env_steps", "policy_map_capacity": 100, "policy_mapping_fn": "<function AlgorithmConfig.DEFAULT_POLICY_MAPPING_FN at 0x13e6b9b20>", "policies_to_train": null, "policy_states_are_swappable": false, "observation_fn": null, "offline_data_class": null, "input_read_method": "read_parquet", "input_read_method_kwargs": {}, "input_read_schema": {}, "input_read_episodes": false, "input_read_sample_batches": false, "input_read_batch_size": null, "input_filesystem": null, "input_filesystem_kwargs": {}, "input_compress_columns": ["obs", "new_obs"], "input_spaces_jsonable": true, "materialize_data": false, "materialize_mapped_data": true, "map_batches_kwargs": {}, "iter_batches_kwargs": {}, "ignore_final_observation": false, "prelearner_class": null, "prelearner_buffer_class": null, "prelearner_buffer_kwargs": {}, "prelearner_module_synch_period": 10, "dataset_num_iters_per_learner": null, "input_config": {}, "actions_in_input_normalized": false, "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_config": {}, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "output_max_rows_per_file": null, "output_write_remaining_data": false, "output_write_method": "write_parquet", "output_write_method_kwargs": {}, "output_filesystem": null, "output_filesystem_kwargs": {}, "output_write_episodes": true, "offline_sampling": false, "evaluation_interval": 1, "evaluation_duration": 20, "evaluation_duration_unit": "episodes", "evaluation_sample_timeout_s": 120.0, "evaluation_auto_duration_min_env_steps_per_sample": 100, "evaluation_auto_duration_max_env_steps_per_sample": 2000, "evaluation_parallel_to_training": false, "evaluation_force_reset_envs_before_iteration": true, "evaluation_config": null, "off_policy_estimation_methods": {}, "ope_split_batch_by_episode": true, "evaluation_num_env_runners": 1, "in_evaluation": false, "sync_filters_on_rollout_workers_timeout_s": 10.0, "offline_evaluation_interval": null, "num_offline_eval_runners": 0, "offline_loss_for_module_fn": null, "offline_evaluation_duration": 1, "offline_evaluation_parallel_to_training": false, "offline_evaluation_timeout_s": 120.0, "num_cpus_per_offline_eval_runner": 1, "num_gpus_per_offline_eval_runner": 0, "custom_resources_per_offline_eval_runner": {}, "restart_failed_offline_eval_runners": true, "ignore_offline_eval_runner_failures": false, "max_num_offline_eval_runner_restarts": 1000, "offline_eval_runner_restore_timeout_s": 1800.0, "max_requests_in_flight_per_offline_eval_runner": 1, "validate_offline_eval_runners_after_construction": true, "offline_eval_runner_health_probe_timeout_s": 30.0, "offline_eval_rl_module_inference_only": false, "broadcast_offline_eval_runner_states": false, "offline_eval_batch_size_per_runner": 256, "dataset_num_iters_per_eval_runner": 1, "keep_per_episode_custom_metrics": false, "metrics_episode_collection_timeout_s": 60.0, "metrics_num_episodes_for_smoothing": 100, "min_time_s_per_iteration": null, "min_train_timesteps_per_iteration": 0, "min_sample_timesteps_per_iteration": 0, "log_gradients": true, "export_native_model_files": false, "checkpoint_trainable_policies_only": false, "logger_creator": null, "logger_config": null, "log_level": "WARN", "log_sys_usage": true, "fake_sampler": false, "seed": 10, "restart_failed_env_runners": true, "ignore_env_runner_failures": false, "max_num_env_runner_restarts": 1000, "delay_between_env_runner_restarts_s": 60.0, "restart_failed_sub_environments": false, "num_consecutive_env_runner_failures_tolerance": 100, "env_runner_health_probe_timeout_s": 30.0, "env_runner_restore_timeout_s": 1800.0, "_model_config": {}, "_rl_module_spec": "RLModuleSpec(module_class=None, observation_space=None, action_space=None, inference_only=False, learner_only=False, model_config=DefaultModelConfig(fcnet_hiddens=[60, 90], fcnet_activation='tanh', fcnet_kernel_initializer=None, fcnet_kernel_initializer_kwargs=None, fcnet_bias_initializer=None, fcnet_bias_initializer_kwargs=None, conv_filters=None, conv_activation='relu', conv_kernel_initializer=None, conv_kernel_initializer_kwargs=None, conv_bias_initializer=None, conv_bias_initializer_kwargs=None, head_fcnet_hiddens=[], head_fcnet_activation='relu', head_fcnet_kernel_initializer=None, head_fcnet_kernel_initializer_kwargs=None, head_fcnet_bias_initializer=None, head_fcnet_bias_initializer_kwargs=None, free_log_std=False, log_std_clip_param=20.0, vf_share_layers=True, use_lstm=False, max_seq_len=20, lstm_cell_size=256, lstm_use_prev_action=False, lstm_use_prev_reward=False, lstm_kernel_initializer=None, lstm_kernel_initializer_kwargs=None, lstm_bias_initializer=None, lstm_bias_initializer_kwargs=None), catalog_class=None, load_state_path=None, model_config_dict=None)", "algorithm_config_overrides_per_module": {}, "_per_module_overrides": {}, "_validate_config": true, "_use_msgpack_checkpoints": false, "_torch_grad_scaler_class": null, "_torch_lr_scheduler_classes": null, "_tf_policy_handles_more_than_one_loss": false, "_disable_preprocessor_api": false, "_disable_action_flattening": false, "_disable_initialize_loss_from_dummy_batch": false, "_dont_auto_sync_env_runner_states": false, "env_task_fn": -1, "enable_connectors": -1, "simple_optimizer": false, "policy_map_cache": -1, "worker_cls": -1, "synchronize_filters": -1, "enable_async_evaluation": -1, "custom_async_evaluation_function": -1, "_enable_rl_module_api": -1, "auto_wrap_old_gym_envs": -1, "always_attach_evaluation_results": -1, "replay_sequence_length": null, "_disable_execution_plan_api": -1, "use_critic": true, "use_gae": true, "use_kl_loss": true, "kl_coeff": 0.7464963036515, "kl_target": 0.0270990929592, "vf_loss_coeff": 0.6688075857018, "entropy_coeff": 0.0090570820258, "clip_param": 0.1221781641624, "vf_clip_param": 0.1027808522125, "entropy_coeff_schedule": null, "lr_schedule": null, "sgd_minibatch_size": -1, "vf_share_layers": -1, "__stdout_file__": null, "__stderr_file__": null, "lambda": 0.9099046732075, "input": "sampler", "policies": {"default_policy": [null, null, null, null]}, "callbacks": "<class 'ray.rllib.callbacks.callbacks.RLlibCallback'>", "create_env_on_driver": false, "custom_eval_function": null, "framework": "torch"}, "time_since_restore": 11.724831819534302, "iterations_since_restore": 3, "perf": {"cpu_util_percent": 66.26, "ram_util_percent": 80.7}}
{"timers": {"training_iteration": 4.562129704616917, "restore_env_runners": 1.448970308538992e-05, "training_step": 4.561776830238037, "env_runner_sampling_timer": 4.362588379475983, "learner_update_timer": 0.19032664526548224, "synch_weights": 0.0022681196361044424, "restore_eval_env_runners": 1.8546227260958402e-05, "evaluation_iteration": 0.20509611699726665, "synch_eval_env_connectors": 0.000254589022055734, "synch_env_connectors": 4.560358508024364e-06}, "env_runners": {"weights_seq_no": 3.0, "env_to_module_connector": {"timers": {"connectors": {"add_states_from_episodes_to_batch": 2.6611884623923837e-06, "batch_individual_items": 1.1920369286310576e-05, "add_observations_from_episodes_to_batch": 5.124436740813585e-06, "add_time_dim_to_batch_and_zero_pad": 4.502846538156973e-06, "numpy_to_tensor": 1.8947781007118546e-05}}, "connector_pipeline_timer": 7.761928636960518e-05}, "num_env_steps_sampled": 5000.0, "module_episode_returns_mean": {"default_policy": -0.3400000000000001}, "sample": 0.010151592528781197, "num_module_steps_sampled": {"default_policy": 5000.0}, "num_episodes": 250.0, "module_to_env_connector": {"connector_pipeline_timer": 0.00020020076849481017, "timers": {"connectors": {"tensor_to_numpy": 2.480034601954404e-05, "get_actions": 8.39819939590937e-05, "un_batch_to_individual_items": 9.517791098567717e-06, "normalize_and_clip_actions": 1.6111826353954426e-05, "listify_data_for_vector_env": 2.0204967793325597e-05, "remove_single_ts_time_rank_from_batch": 1.0107662905499129e-06}}}, "time_between_sampling": 0.0030299158003215857, "num_env_steps_sampled_lifetime": -1225000.0, "episode_return_mean": -0.3400000000000001, "episode_return_min": -10.5, "agent_episode_returns_mean": {"default_agent": -0.3400000000000001}, "episode_duration_sec_mean": 0.008530447509605436, "env_to_module_sum_episodes_length_out": 10.36823839457432, "episode_len_mean": 20.0, "env_reset_timer": 8.594152900208616e-05, "num_agent_steps_sampled_lifetime": {"default_agent": -1225000.0}, "num_episodes_lifetime": -61250.0, "episode_len_max": 20, "rlmodule_inference_timer": 5.6465717314868544e-05, "env_to_module_sum_episodes_length_in": 10.36823839457432, "num_agent_steps_sampled": {"default_agent": 5000.0}, "episode_return_max": 9.5, "episode_len_min": 20, "env_step_timer": 2.7007683880296686e-05, "num_module_steps_sampled_lifetime": {"default_policy": -1225000.0}, "num_env_steps_sampled_lifetime_throughput": 2286.890887815895}, "learners": {"__all_modules__": {"learner_connector": {"timers": {"connectors": {"add_time_dim_to_batch_and_zero_pad": 1.6575713764876125e-05, "add_observations_from_episodes_to_batch": 0.0008954490779961925, "add_states_from_episodes_to_batch": 3.976690163835883e-06, "add_columns_from_episodes_to_train_batch": 0.04931261325680046, "batch_individual_items": 0.04812506691019877, "add_one_ts_to_episodes_and_truncate": 0.010721587110689376, "numpy_to_tensor": 0.00012266918532073033, "general_advantage_estimation": 0.00863429122530192}}, "connector_pipeline_timer": 0.11806998910545893}, "num_env_steps_trained_lifetime": 126000, "num_module_steps_trained": 6000, "num_trainable_parameters": 6003, "learner_connector_sum_episodes_length_in": 5000.0, "num_non_trainable_parameters": 0, "learner_connector_sum_episodes_length_out": 5250.0, "num_env_steps_trained": 31500, "num_module_steps_trained_lifetime": 24000, "num_env_steps_trained_lifetime_throughput": 860159.281550514, "num_module_steps_trained_throughput": 164260.72976165052, "num_module_steps_trained_lifetime_throughput": 164086.60300422617}, "default_policy": {"gradients_default_optimizer_global_norm": 0.021336890757083893, "entropy": 0.6889801025390625, "vf_explained_var": -0.010156989097595215, "mean_kl_loss": 0.0008237484726123512, "num_module_steps_trained_lifetime": 24000, "vf_loss": 0.10278083384037018, "default_optimizer_learning_rate": 0.0002847858517, "curr_kl_coeff": 0.04665601998567581, "module_train_batch_size_mean": 1000.0, "num_module_steps_trained": 6000, "num_trainable_parameters": 6003, "weights_seq_no": 4.0, "policy_loss": 0.04596720635890961, "diff_num_grad_updates_vs_sampler_policy": 1.0, "vf_loss_unclipped": 28.70688247680664, "curr_entropy_coeff": 0.0090570820258, "total_loss": 0.10854453593492508, "num_module_steps_trained_lifetime_throughput": 164498.9050933576}}, "num_training_step_calls_per_iteration": 1, "evaluation": {"env_runners": {"episode_len_min": 20, "episode_return_max": 13.5, "num_env_steps_sampled": 400, "sample": 0.1890727242975137, "env_to_module_connector": {"timers": {"connectors": {"add_observations_from_episodes_to_batch": 3.543977579954013e-06, "add_states_from_episodes_to_batch": 1.9831286621751487e-06, "batch_individual_items": 8.26900931499053e-06, "numpy_to_tensor": 1.2155277832452177e-05, "add_time_dim_to_batch_and_zero_pad": 3.2360113734768657e-06}}, "connector_pipeline_timer": 5.6276444870648906e-05}, "num_episodes": 20, "num_env_steps_sampled_lifetime": 20400, "episode_len_max": 20, "module_to_env_connector": {"timers": {"connectors": {"tensor_to_numpy": 1.9016799579868315e-05, "get_actions": 5.6609519931145277e-05, "un_batch_to_individual_items": 6.8258252260338675e-06, "normalize_and_clip_actions": 1.2251246445312306e-05, "listify_data_for_vector_env": 1.4655882798691993e-05, "remove_single_ts_time_rank_from_batch": 7.263360813519005e-07}}, "connector_pipeline_timer": 0.00014231791619009654}, "episode_return_min": -14.5, "env_to_module_sum_episodes_length_out": 10.368237912813044, "num_agent_steps_sampled": {"default_agent": 400}, "module_episode_returns_mean": {"default_policy": -1.3}, "rlmodule_inference_timer": 4.0690521396871674e-05, "env_to_module_sum_episodes_length_in": 10.368237912813044, "env_step_timer": 1.9441443340233884e-05, "num_agent_steps_sampled_lifetime": {"default_agent": 1600}, "episode_len_mean": 20.0, "env_reset_timer": 0.0007188521617073566, "num_module_steps_sampled_lifetime": {"default_policy": 1600}, "num_episodes_lifetime": 80, "num_module_steps_sampled": {"default_policy": 400}, "agent_episode_returns_mean": {"default_agent": -1.3}, "weights_seq_no": 4.0, "episode_return_mean": -1.3, "episode_duration_sec_mean": 0.007485050518880598, "time_between_sampling": 2.9336561454003096}, "num_healthy_workers": 1, "actor_manager_num_outstanding_async_reqs": 0, "num_remote_worker_restarts": 0}, "num_env_steps_sampled_lifetime": -1225000.0, "fault_tolerance": {"num_healthy_workers": 0, "num_remote_worker_restarts": 0}, "env_runner_group": {"actor_manager_num_outstanding_async_reqs": 0}, "done": false, "training_iteration": 4, "trial_id": "49ef3_00000", "date": "2025-08-11_19-30-44", "timestamp": 1754933444, "time_this_iter_s": 2.979224920272827, "time_total_s": 14.704056739807129, "pid": 23180, "hostname": "Mac", "node_ip": "127.0.0.1", "config": {"exploration_config": {}, "extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "placement_strategy": "PACK", "num_gpus": 0, "_fake_gpus": false, "num_cpus_for_main_process": 2, "eager_tracing": true, "eager_max_retraces": 20, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "torch_compile_learner": false, "torch_compile_learner_what_to_compile": "forward_train", "torch_compile_learner_dynamo_backend": "aot_eager", "torch_compile_learner_dynamo_mode": null, "torch_compile_worker": false, "torch_compile_worker_dynamo_backend": "aot_eager", "torch_compile_worker_dynamo_mode": null, "torch_ddp_kwargs": {}, "torch_skip_nan_gradients": false, "env": "Umbrella", "env_config": {}, "observation_space": null, "action_space": null, "clip_rewards": null, "normalize_actions": true, "clip_actions": false, "_is_atari": null, "disable_env_checking": false, "render_env": false, "action_mask_key": "action_mask", "env_runner_cls": null, "num_env_runners": 0, "create_local_env_runner": true, "num_envs_per_env_runner": 1, "gym_env_vectorize_mode": "SYNC", "num_cpus_per_env_runner": 1, "num_gpus_per_env_runner": 0, "custom_resources_per_env_runner": {}, "validate_env_runners_after_construction": true, "episodes_to_numpy": true, "max_requests_in_flight_per_env_runner": 1, "sample_timeout_s": 60.0, "_env_to_module_connector": null, "add_default_connectors_to_env_to_module_pipeline": true, "_module_to_env_connector": null, "add_default_connectors_to_module_to_env_pipeline": true, "merge_env_runner_states": "training_only", "broadcast_env_runner_states": true, "episode_lookback_horizon": 1, "rollout_fragment_length": "auto", "batch_mode": "complete_episodes", "compress_observations": false, "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "enable_tf1_exec_eagerly": false, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "preprocessor_pref": "deepmind", "observation_filter": "NoFilter", "update_worker_filter_stats": true, "use_worker_filter_stats": true, "sampler_perf_stats_ema_coef": null, "_is_online": true, "num_learners": 0, "num_gpus_per_learner": 0, "num_cpus_per_learner": "auto", "num_aggregator_actors_per_learner": 0, "max_requests_in_flight_per_aggregator_actor": 3, "local_gpu_idx": 0, "max_requests_in_flight_per_learner": 3, "gamma": 1, "lr": 0.0002847858517, "grad_clip": 0.5, "grad_clip_by": "global_norm", "_train_batch_size_per_learner": 5000, "train_batch_size": 4000, "num_epochs": 1, "minibatch_size": 1000, "shuffle_batch_per_epoch": true, "model": {"fcnet_hiddens": [256, 256], "fcnet_activation": "tanh", "fcnet_weights_initializer": null, "fcnet_weights_initializer_config": null, "fcnet_bias_initializer": null, "fcnet_bias_initializer_config": null, "conv_filters": null, "conv_activation": "relu", "conv_kernel_initializer": null, "conv_kernel_initializer_config": null, "conv_bias_initializer": null, "conv_bias_initializer_config": null, "conv_transpose_kernel_initializer": null, "conv_transpose_kernel_initializer_config": null, "conv_transpose_bias_initializer": null, "conv_transpose_bias_initializer_config": null, "post_fcnet_hiddens": [], "post_fcnet_activation": "relu", "post_fcnet_weights_initializer": null, "post_fcnet_weights_initializer_config": null, "post_fcnet_bias_initializer": null, "post_fcnet_bias_initializer_config": null, "free_log_std": false, "log_std_clip_param": 20.0, "no_final_linear": false, "vf_share_layers": false, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "lstm_weights_initializer": null, "lstm_weights_initializer_config": null, "lstm_bias_initializer": null, "lstm_bias_initializer_config": null, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "attention_use_n_prev_actions": 0, "attention_use_n_prev_rewards": 0, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": null, "custom_model_config": {}, "custom_action_dist": null, "custom_preprocessor": null, "encoder_latent_dim": null, "always_check_shapes": false, "lstm_use_prev_action_reward": -1, "_use_default_native_models": -1, "_disable_preprocessor_api": false, "_disable_action_flattening": false}, "_learner_connector": null, "add_default_connectors_to_learner_pipeline": true, "learner_config_dict": {}, "optimizer": {}, "_learner_class": null, "callbacks_on_algorithm_init": null, "callbacks_on_env_runners_recreated": null, "callbacks_on_offline_eval_runners_recreated": null, "callbacks_on_checkpoint_loaded": null, "callbacks_on_environment_created": null, "callbacks_on_episode_created": null, "callbacks_on_episode_start": null, "callbacks_on_episode_step": null, "callbacks_on_episode_end": null, "callbacks_on_evaluate_start": null, "callbacks_on_evaluate_end": null, "callbacks_on_evaluate_offline_start": null, "callbacks_on_evaluate_offline_end": null, "callbacks_on_sample_end": null, "callbacks_on_train_result": null, "explore": true, "enable_rl_module_and_learner": true, "enable_env_runner_and_connector_v2": true, "_prior_exploration_config": {"type": "StochasticSampling"}, "count_steps_by": "env_steps", "policy_map_capacity": 100, "policy_mapping_fn": "<function AlgorithmConfig.DEFAULT_POLICY_MAPPING_FN at 0x13e6b9b20>", "policies_to_train": null, "policy_states_are_swappable": false, "observation_fn": null, "offline_data_class": null, "input_read_method": "read_parquet", "input_read_method_kwargs": {}, "input_read_schema": {}, "input_read_episodes": false, "input_read_sample_batches": false, "input_read_batch_size": null, "input_filesystem": null, "input_filesystem_kwargs": {}, "input_compress_columns": ["obs", "new_obs"], "input_spaces_jsonable": true, "materialize_data": false, "materialize_mapped_data": true, "map_batches_kwargs": {}, "iter_batches_kwargs": {}, "ignore_final_observation": false, "prelearner_class": null, "prelearner_buffer_class": null, "prelearner_buffer_kwargs": {}, "prelearner_module_synch_period": 10, "dataset_num_iters_per_learner": null, "input_config": {}, "actions_in_input_normalized": false, "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_config": {}, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "output_max_rows_per_file": null, "output_write_remaining_data": false, "output_write_method": "write_parquet", "output_write_method_kwargs": {}, "output_filesystem": null, "output_filesystem_kwargs": {}, "output_write_episodes": true, "offline_sampling": false, "evaluation_interval": 1, "evaluation_duration": 20, "evaluation_duration_unit": "episodes", "evaluation_sample_timeout_s": 120.0, "evaluation_auto_duration_min_env_steps_per_sample": 100, "evaluation_auto_duration_max_env_steps_per_sample": 2000, "evaluation_parallel_to_training": false, "evaluation_force_reset_envs_before_iteration": true, "evaluation_config": null, "off_policy_estimation_methods": {}, "ope_split_batch_by_episode": true, "evaluation_num_env_runners": 1, "in_evaluation": false, "sync_filters_on_rollout_workers_timeout_s": 10.0, "offline_evaluation_interval": null, "num_offline_eval_runners": 0, "offline_loss_for_module_fn": null, "offline_evaluation_duration": 1, "offline_evaluation_parallel_to_training": false, "offline_evaluation_timeout_s": 120.0, "num_cpus_per_offline_eval_runner": 1, "num_gpus_per_offline_eval_runner": 0, "custom_resources_per_offline_eval_runner": {}, "restart_failed_offline_eval_runners": true, "ignore_offline_eval_runner_failures": false, "max_num_offline_eval_runner_restarts": 1000, "offline_eval_runner_restore_timeout_s": 1800.0, "max_requests_in_flight_per_offline_eval_runner": 1, "validate_offline_eval_runners_after_construction": true, "offline_eval_runner_health_probe_timeout_s": 30.0, "offline_eval_rl_module_inference_only": false, "broadcast_offline_eval_runner_states": false, "offline_eval_batch_size_per_runner": 256, "dataset_num_iters_per_eval_runner": 1, "keep_per_episode_custom_metrics": false, "metrics_episode_collection_timeout_s": 60.0, "metrics_num_episodes_for_smoothing": 100, "min_time_s_per_iteration": null, "min_train_timesteps_per_iteration": 0, "min_sample_timesteps_per_iteration": 0, "log_gradients": true, "export_native_model_files": false, "checkpoint_trainable_policies_only": false, "logger_creator": null, "logger_config": null, "log_level": "WARN", "log_sys_usage": true, "fake_sampler": false, "seed": 10, "restart_failed_env_runners": true, "ignore_env_runner_failures": false, "max_num_env_runner_restarts": 1000, "delay_between_env_runner_restarts_s": 60.0, "restart_failed_sub_environments": false, "num_consecutive_env_runner_failures_tolerance": 100, "env_runner_health_probe_timeout_s": 30.0, "env_runner_restore_timeout_s": 1800.0, "_model_config": {}, "_rl_module_spec": "RLModuleSpec(module_class=None, observation_space=None, action_space=None, inference_only=False, learner_only=False, model_config=DefaultModelConfig(fcnet_hiddens=[60, 90], fcnet_activation='tanh', fcnet_kernel_initializer=None, fcnet_kernel_initializer_kwargs=None, fcnet_bias_initializer=None, fcnet_bias_initializer_kwargs=None, conv_filters=None, conv_activation='relu', conv_kernel_initializer=None, conv_kernel_initializer_kwargs=None, conv_bias_initializer=None, conv_bias_initializer_kwargs=None, head_fcnet_hiddens=[], head_fcnet_activation='relu', head_fcnet_kernel_initializer=None, head_fcnet_kernel_initializer_kwargs=None, head_fcnet_bias_initializer=None, head_fcnet_bias_initializer_kwargs=None, free_log_std=False, log_std_clip_param=20.0, vf_share_layers=True, use_lstm=False, max_seq_len=20, lstm_cell_size=256, lstm_use_prev_action=False, lstm_use_prev_reward=False, lstm_kernel_initializer=None, lstm_kernel_initializer_kwargs=None, lstm_bias_initializer=None, lstm_bias_initializer_kwargs=None), catalog_class=None, load_state_path=None, model_config_dict=None)", "algorithm_config_overrides_per_module": {}, "_per_module_overrides": {}, "_validate_config": true, "_use_msgpack_checkpoints": false, "_torch_grad_scaler_class": null, "_torch_lr_scheduler_classes": null, "_tf_policy_handles_more_than_one_loss": false, "_disable_preprocessor_api": false, "_disable_action_flattening": false, "_disable_initialize_loss_from_dummy_batch": false, "_dont_auto_sync_env_runner_states": false, "env_task_fn": -1, "enable_connectors": -1, "simple_optimizer": false, "policy_map_cache": -1, "worker_cls": -1, "synchronize_filters": -1, "enable_async_evaluation": -1, "custom_async_evaluation_function": -1, "_enable_rl_module_api": -1, "auto_wrap_old_gym_envs": -1, "always_attach_evaluation_results": -1, "replay_sequence_length": null, "_disable_execution_plan_api": -1, "use_critic": true, "use_gae": true, "use_kl_loss": true, "kl_coeff": 0.7464963036515, "kl_target": 0.0270990929592, "vf_loss_coeff": 0.6688075857018, "entropy_coeff": 0.0090570820258, "clip_param": 0.1221781641624, "vf_clip_param": 0.1027808522125, "entropy_coeff_schedule": null, "lr_schedule": null, "sgd_minibatch_size": -1, "vf_share_layers": -1, "__stdout_file__": null, "__stderr_file__": null, "lambda": 0.9099046732075, "input": "sampler", "policies": {"default_policy": [null, null, null, null]}, "callbacks": "<class 'ray.rllib.callbacks.callbacks.RLlibCallback'>", "create_env_on_driver": false, "custom_eval_function": null, "framework": "torch"}, "time_since_restore": 14.704056739807129, "iterations_since_restore": 4, "perf": {"cpu_util_percent": 75.64, "ram_util_percent": 79.64000000000001}}
{"timers": {"training_iteration": 4.544889255490946, "restore_env_runners": 1.441064706810168e-05, "training_step": 4.54453768610551, "env_runner_sampling_timer": 4.345786114430846, "learner_update_timer": 0.189938981732799, "synch_weights": 0.002251434279344781, "restore_eval_env_runners": 1.8480764737934805e-05, "evaluation_iteration": 0.20472588666701957, "synch_eval_env_connectors": 0.0002544006317419699, "synch_env_connectors": 4.560595784219913e-06}, "env_runners": {"weights_seq_no": 4.0, "env_to_module_connector": {"timers": {"connectors": {"add_states_from_episodes_to_batch": 2.68303139595215e-06, "batch_individual_items": 1.1888646788173166e-05, "add_observations_from_episodes_to_batch": 5.197697189465097e-06, "add_time_dim_to_batch_and_zero_pad": 4.109090410335221e-06, "numpy_to_tensor": 1.7267977112298597e-05}}, "connector_pipeline_timer": 7.494636865639412e-05}, "num_env_steps_sampled": 5000.0, "module_episode_returns_mean": {"default_policy": -1.1400000000000001}, "sample": 0.009310175473313663, "num_module_steps_sampled": {"default_policy": 5000.0}, "num_episodes": 250.0, "module_to_env_connector": {"connector_pipeline_timer": 0.0001978103422712198, "timers": {"connectors": {"tensor_to_numpy": 2.5243456431515642e-05, "get_actions": 8.227703705247155e-05, "un_batch_to_individual_items": 9.488455748103845e-06, "normalize_and_clip_actions": 1.628654542826678e-05, "listify_data_for_vector_env": 2.052876598234737e-05, "remove_single_ts_time_rank_from_batch": 1.125873092422485e-06}}}, "time_between_sampling": 0.002548800436346413, "num_env_steps_sampled_lifetime": -1842500.0, "episode_return_mean": -1.1400000000000001, "episode_return_min": -10.5, "agent_episode_returns_mean": {"default_agent": -1.1400000000000001}, "episode_duration_sec_mean": 0.008966911505907772, "env_to_module_sum_episodes_length_out": 10.36823839457432, "episode_len_mean": 20.0, "env_reset_timer": 8.582201143968067e-05, "num_agent_steps_sampled_lifetime": {"default_agent": -1842500.0}, "num_episodes_lifetime": -92125.0, "episode_len_max": 20, "rlmodule_inference_timer": 8.337974045976563e-05, "env_to_module_sum_episodes_length_in": 10.36823839457432, "num_agent_steps_sampled": {"default_agent": 5000.0}, "episode_return_max": 9.5, "episode_len_min": 20, "env_step_timer": 2.66983481761513e-05, "num_module_steps_sampled_lifetime": {"default_policy": -1842500.0}, "num_env_steps_sampled_lifetime_throughput": 2284.72472226988}, "learners": {"__all_modules__": {"learner_connector": {"timers": {"connectors": {"add_time_dim_to_batch_and_zero_pad": 1.651911694619804e-05, "add_observations_from_episodes_to_batch": 0.0008954708371718251, "add_states_from_episodes_to_batch": 4.094422715250403e-06, "add_columns_from_episodes_to_train_batch": 0.04950457128488261, "batch_individual_items": 0.04803888624118276, "add_one_ts_to_episodes_and_truncate": 0.010743208319556373, "numpy_to_tensor": 0.0001229062438448204, "general_advantage_estimation": 0.008648715392324003}}, "connector_pipeline_timer": 0.11821225504473602}, "num_env_steps_trained_lifetime": 157500, "num_module_steps_trained": 6000, "num_trainable_parameters": 6003, "learner_connector_sum_episodes_length_in": 5000.0, "num_non_trainable_parameters": 0, "learner_connector_sum_episodes_length_out": 5250.0, "num_env_steps_trained": 31500, "num_module_steps_trained_lifetime": 30000, "num_env_steps_trained_lifetime_throughput": 884741.6449895193, "num_module_steps_trained_throughput": 168930.3377243626, "num_module_steps_trained_lifetime_throughput": 168758.91829131934}, "default_policy": {"gradients_default_optimizer_global_norm": 0.02561800181865692, "entropy": 0.6833857297897339, "vf_explained_var": -0.010284781455993652, "mean_kl_loss": 0.0012158984318375587, "num_module_steps_trained_lifetime": 30000, "vf_loss": 0.10278083384037018, "default_optimizer_learning_rate": 0.0002847858517, "curr_kl_coeff": 0.023328009992837906, "module_train_batch_size_mean": 1000.0, "num_module_steps_trained": 6000, "num_trainable_parameters": 6003, "weights_seq_no": 5.0, "policy_loss": -0.005832438822835684, "diff_num_grad_updates_vs_sampler_policy": 1.0, "vf_loss_unclipped": 28.676191329956055, "curr_entropy_coeff": 0.0090570820258, "total_loss": 0.05677541345357895, "num_module_steps_trained_lifetime_throughput": 169144.0725859488}}, "num_training_step_calls_per_iteration": 1, "evaluation": {"env_runners": {"episode_len_min": 20, "episode_return_max": 13.5, "num_env_steps_sampled": 400, "sample": 0.18858281455450027, "env_to_module_connector": {"timers": {"connectors": {"add_observations_from_episodes_to_batch": 3.6107617899978273e-06, "add_states_from_episodes_to_batch": 1.9671998032619354e-06, "batch_individual_items": 8.873182278627674e-06, "numpy_to_tensor": 1.120492468385487e-05, "add_time_dim_to_batch_and_zero_pad": 3.367086174828672e-06}}, "connector_pipeline_timer": 5.6227992445461995e-05}, "num_episodes": 20, "num_env_steps_sampled_lifetime": 25400, "episode_len_max": 20, "module_to_env_connector": {"timers": {"connectors": {"tensor_to_numpy": 2.790908233570161e-05, "get_actions": 6.547266077361215e-05, "un_batch_to_individual_items": 6.827729967132174e-06, "normalize_and_clip_actions": 1.1550789298964901e-05, "listify_data_for_vector_env": 1.8691280485035623e-05, "remove_single_ts_time_rank_from_batch": 7.019533643233772e-07}}, "connector_pipeline_timer": 0.0001680608672887539}, "episode_return_min": -14.5, "env_to_module_sum_episodes_length_out": 10.368238387501162, "num_agent_steps_sampled": {"default_agent": 400}, "module_episode_returns_mean": {"default_policy": -0.75}, "rlmodule_inference_timer": 4.0041997177607134e-05, "env_to_module_sum_episodes_length_in": 10.368238387501162, "env_step_timer": 2.4193360337402556e-05, "num_agent_steps_sampled_lifetime": {"default_agent": 2000}, "episode_len_mean": 20.0, "env_reset_timer": 0.0007124198903190158, "num_module_steps_sampled_lifetime": {"default_policy": 2000}, "num_episodes_lifetime": 100, "num_module_steps_sampled": {"default_policy": 400}, "agent_episode_returns_mean": {"default_agent": -0.75}, "weights_seq_no": 5.0, "episode_return_mean": -0.75, "episode_duration_sec_mean": 0.007264224148821085, "time_between_sampling": 2.9329077981160285}, "num_healthy_workers": 1, "actor_manager_num_outstanding_async_reqs": 0, "num_remote_worker_restarts": 0}, "num_env_steps_sampled_lifetime": -1842500.0, "fault_tolerance": {"num_healthy_workers": 0, "num_remote_worker_restarts": 0}, "env_runner_group": {"actor_manager_num_outstanding_async_reqs": 0}, "done": false, "training_iteration": 5, "trial_id": "49ef3_00000", "date": "2025-08-11_19-30-47", "timestamp": 1754933447, "time_this_iter_s": 2.9906749725341797, "time_total_s": 17.69473171234131, "pid": 23180, "hostname": "Mac", "node_ip": "127.0.0.1", "config": {"exploration_config": {}, "extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "placement_strategy": "PACK", "num_gpus": 0, "_fake_gpus": false, "num_cpus_for_main_process": 2, "eager_tracing": true, "eager_max_retraces": 20, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "torch_compile_learner": false, "torch_compile_learner_what_to_compile": "forward_train", "torch_compile_learner_dynamo_backend": "aot_eager", "torch_compile_learner_dynamo_mode": null, "torch_compile_worker": false, "torch_compile_worker_dynamo_backend": "aot_eager", "torch_compile_worker_dynamo_mode": null, "torch_ddp_kwargs": {}, "torch_skip_nan_gradients": false, "env": "Umbrella", "env_config": {}, "observation_space": null, "action_space": null, "clip_rewards": null, "normalize_actions": true, "clip_actions": false, "_is_atari": null, "disable_env_checking": false, "render_env": false, "action_mask_key": "action_mask", "env_runner_cls": null, "num_env_runners": 0, "create_local_env_runner": true, "num_envs_per_env_runner": 1, "gym_env_vectorize_mode": "SYNC", "num_cpus_per_env_runner": 1, "num_gpus_per_env_runner": 0, "custom_resources_per_env_runner": {}, "validate_env_runners_after_construction": true, "episodes_to_numpy": true, "max_requests_in_flight_per_env_runner": 1, "sample_timeout_s": 60.0, "_env_to_module_connector": null, "add_default_connectors_to_env_to_module_pipeline": true, "_module_to_env_connector": null, "add_default_connectors_to_module_to_env_pipeline": true, "merge_env_runner_states": "training_only", "broadcast_env_runner_states": true, "episode_lookback_horizon": 1, "rollout_fragment_length": "auto", "batch_mode": "complete_episodes", "compress_observations": false, "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "enable_tf1_exec_eagerly": false, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "preprocessor_pref": "deepmind", "observation_filter": "NoFilter", "update_worker_filter_stats": true, "use_worker_filter_stats": true, "sampler_perf_stats_ema_coef": null, "_is_online": true, "num_learners": 0, "num_gpus_per_learner": 0, "num_cpus_per_learner": "auto", "num_aggregator_actors_per_learner": 0, "max_requests_in_flight_per_aggregator_actor": 3, "local_gpu_idx": 0, "max_requests_in_flight_per_learner": 3, "gamma": 1, "lr": 0.0002847858517, "grad_clip": 0.5, "grad_clip_by": "global_norm", "_train_batch_size_per_learner": 5000, "train_batch_size": 4000, "num_epochs": 1, "minibatch_size": 1000, "shuffle_batch_per_epoch": true, "model": {"fcnet_hiddens": [256, 256], "fcnet_activation": "tanh", "fcnet_weights_initializer": null, "fcnet_weights_initializer_config": null, "fcnet_bias_initializer": null, "fcnet_bias_initializer_config": null, "conv_filters": null, "conv_activation": "relu", "conv_kernel_initializer": null, "conv_kernel_initializer_config": null, "conv_bias_initializer": null, "conv_bias_initializer_config": null, "conv_transpose_kernel_initializer": null, "conv_transpose_kernel_initializer_config": null, "conv_transpose_bias_initializer": null, "conv_transpose_bias_initializer_config": null, "post_fcnet_hiddens": [], "post_fcnet_activation": "relu", "post_fcnet_weights_initializer": null, "post_fcnet_weights_initializer_config": null, "post_fcnet_bias_initializer": null, "post_fcnet_bias_initializer_config": null, "free_log_std": false, "log_std_clip_param": 20.0, "no_final_linear": false, "vf_share_layers": false, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "lstm_weights_initializer": null, "lstm_weights_initializer_config": null, "lstm_bias_initializer": null, "lstm_bias_initializer_config": null, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "attention_use_n_prev_actions": 0, "attention_use_n_prev_rewards": 0, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": null, "custom_model_config": {}, "custom_action_dist": null, "custom_preprocessor": null, "encoder_latent_dim": null, "always_check_shapes": false, "lstm_use_prev_action_reward": -1, "_use_default_native_models": -1, "_disable_preprocessor_api": false, "_disable_action_flattening": false}, "_learner_connector": null, "add_default_connectors_to_learner_pipeline": true, "learner_config_dict": {}, "optimizer": {}, "_learner_class": null, "callbacks_on_algorithm_init": null, "callbacks_on_env_runners_recreated": null, "callbacks_on_offline_eval_runners_recreated": null, "callbacks_on_checkpoint_loaded": null, "callbacks_on_environment_created": null, "callbacks_on_episode_created": null, "callbacks_on_episode_start": null, "callbacks_on_episode_step": null, "callbacks_on_episode_end": null, "callbacks_on_evaluate_start": null, "callbacks_on_evaluate_end": null, "callbacks_on_evaluate_offline_start": null, "callbacks_on_evaluate_offline_end": null, "callbacks_on_sample_end": null, "callbacks_on_train_result": null, "explore": true, "enable_rl_module_and_learner": true, "enable_env_runner_and_connector_v2": true, "_prior_exploration_config": {"type": "StochasticSampling"}, "count_steps_by": "env_steps", "policy_map_capacity": 100, "policy_mapping_fn": "<function AlgorithmConfig.DEFAULT_POLICY_MAPPING_FN at 0x13e6b9b20>", "policies_to_train": null, "policy_states_are_swappable": false, "observation_fn": null, "offline_data_class": null, "input_read_method": "read_parquet", "input_read_method_kwargs": {}, "input_read_schema": {}, "input_read_episodes": false, "input_read_sample_batches": false, "input_read_batch_size": null, "input_filesystem": null, "input_filesystem_kwargs": {}, "input_compress_columns": ["obs", "new_obs"], "input_spaces_jsonable": true, "materialize_data": false, "materialize_mapped_data": true, "map_batches_kwargs": {}, "iter_batches_kwargs": {}, "ignore_final_observation": false, "prelearner_class": null, "prelearner_buffer_class": null, "prelearner_buffer_kwargs": {}, "prelearner_module_synch_period": 10, "dataset_num_iters_per_learner": null, "input_config": {}, "actions_in_input_normalized": false, "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_config": {}, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "output_max_rows_per_file": null, "output_write_remaining_data": false, "output_write_method": "write_parquet", "output_write_method_kwargs": {}, "output_filesystem": null, "output_filesystem_kwargs": {}, "output_write_episodes": true, "offline_sampling": false, "evaluation_interval": 1, "evaluation_duration": 20, "evaluation_duration_unit": "episodes", "evaluation_sample_timeout_s": 120.0, "evaluation_auto_duration_min_env_steps_per_sample": 100, "evaluation_auto_duration_max_env_steps_per_sample": 2000, "evaluation_parallel_to_training": false, "evaluation_force_reset_envs_before_iteration": true, "evaluation_config": null, "off_policy_estimation_methods": {}, "ope_split_batch_by_episode": true, "evaluation_num_env_runners": 1, "in_evaluation": false, "sync_filters_on_rollout_workers_timeout_s": 10.0, "offline_evaluation_interval": null, "num_offline_eval_runners": 0, "offline_loss_for_module_fn": null, "offline_evaluation_duration": 1, "offline_evaluation_parallel_to_training": false, "offline_evaluation_timeout_s": 120.0, "num_cpus_per_offline_eval_runner": 1, "num_gpus_per_offline_eval_runner": 0, "custom_resources_per_offline_eval_runner": {}, "restart_failed_offline_eval_runners": true, "ignore_offline_eval_runner_failures": false, "max_num_offline_eval_runner_restarts": 1000, "offline_eval_runner_restore_timeout_s": 1800.0, "max_requests_in_flight_per_offline_eval_runner": 1, "validate_offline_eval_runners_after_construction": true, "offline_eval_runner_health_probe_timeout_s": 30.0, "offline_eval_rl_module_inference_only": false, "broadcast_offline_eval_runner_states": false, "offline_eval_batch_size_per_runner": 256, "dataset_num_iters_per_eval_runner": 1, "keep_per_episode_custom_metrics": false, "metrics_episode_collection_timeout_s": 60.0, "metrics_num_episodes_for_smoothing": 100, "min_time_s_per_iteration": null, "min_train_timesteps_per_iteration": 0, "min_sample_timesteps_per_iteration": 0, "log_gradients": true, "export_native_model_files": false, "checkpoint_trainable_policies_only": false, "logger_creator": null, "logger_config": null, "log_level": "WARN", "log_sys_usage": true, "fake_sampler": false, "seed": 10, "restart_failed_env_runners": true, "ignore_env_runner_failures": false, "max_num_env_runner_restarts": 1000, "delay_between_env_runner_restarts_s": 60.0, "restart_failed_sub_environments": false, "num_consecutive_env_runner_failures_tolerance": 100, "env_runner_health_probe_timeout_s": 30.0, "env_runner_restore_timeout_s": 1800.0, "_model_config": {}, "_rl_module_spec": "RLModuleSpec(module_class=None, observation_space=None, action_space=None, inference_only=False, learner_only=False, model_config=DefaultModelConfig(fcnet_hiddens=[60, 90], fcnet_activation='tanh', fcnet_kernel_initializer=None, fcnet_kernel_initializer_kwargs=None, fcnet_bias_initializer=None, fcnet_bias_initializer_kwargs=None, conv_filters=None, conv_activation='relu', conv_kernel_initializer=None, conv_kernel_initializer_kwargs=None, conv_bias_initializer=None, conv_bias_initializer_kwargs=None, head_fcnet_hiddens=[], head_fcnet_activation='relu', head_fcnet_kernel_initializer=None, head_fcnet_kernel_initializer_kwargs=None, head_fcnet_bias_initializer=None, head_fcnet_bias_initializer_kwargs=None, free_log_std=False, log_std_clip_param=20.0, vf_share_layers=True, use_lstm=False, max_seq_len=20, lstm_cell_size=256, lstm_use_prev_action=False, lstm_use_prev_reward=False, lstm_kernel_initializer=None, lstm_kernel_initializer_kwargs=None, lstm_bias_initializer=None, lstm_bias_initializer_kwargs=None), catalog_class=None, load_state_path=None, model_config_dict=None)", "algorithm_config_overrides_per_module": {}, "_per_module_overrides": {}, "_validate_config": true, "_use_msgpack_checkpoints": false, "_torch_grad_scaler_class": null, "_torch_lr_scheduler_classes": null, "_tf_policy_handles_more_than_one_loss": false, "_disable_preprocessor_api": false, "_disable_action_flattening": false, "_disable_initialize_loss_from_dummy_batch": false, "_dont_auto_sync_env_runner_states": false, "env_task_fn": -1, "enable_connectors": -1, "simple_optimizer": false, "policy_map_cache": -1, "worker_cls": -1, "synchronize_filters": -1, "enable_async_evaluation": -1, "custom_async_evaluation_function": -1, "_enable_rl_module_api": -1, "auto_wrap_old_gym_envs": -1, "always_attach_evaluation_results": -1, "replay_sequence_length": null, "_disable_execution_plan_api": -1, "use_critic": true, "use_gae": true, "use_kl_loss": true, "kl_coeff": 0.7464963036515, "kl_target": 0.0270990929592, "vf_loss_coeff": 0.6688075857018, "entropy_coeff": 0.0090570820258, "clip_param": 0.1221781641624, "vf_clip_param": 0.1027808522125, "entropy_coeff_schedule": null, "lr_schedule": null, "sgd_minibatch_size": -1, "vf_share_layers": -1, "__stdout_file__": null, "__stderr_file__": null, "lambda": 0.9099046732075, "input": "sampler", "policies": {"default_policy": [null, null, null, null]}, "callbacks": "<class 'ray.rllib.callbacks.callbacks.RLlibCallback'>", "create_env_on_driver": false, "custom_eval_function": null, "framework": "torch"}, "time_since_restore": 17.69473171234131, "iterations_since_restore": 5, "perf": {"cpu_util_percent": 81.375, "ram_util_percent": 79.6}}
{"timers": {"training_iteration": 4.52763312335537, "restore_env_runners": 1.4352790381055803e-05, "training_step": 4.5272800567443605, "env_runner_sampling_timer": 4.327537583696535, "learner_update_timer": 0.19095058691458172, "synch_weights": 0.0022417003470217743, "restore_eval_env_runners": 1.8366367405502824e-05, "evaluation_iteration": 0.20417930739015736, "synch_eval_env_connectors": 0.00025374329520374655, "synch_env_connectors": 4.57040002710768e-06}, "env_runners": {"weights_seq_no": 5.0, "env_to_module_connector": {"timers": {"connectors": {"add_states_from_episodes_to_batch": 2.5598011456584286e-06, "batch_individual_items": 1.1499647175259104e-05, "add_observations_from_episodes_to_batch": 5.033066504333812e-06, "add_time_dim_to_batch_and_zero_pad": 3.9828069244750384e-06, "numpy_to_tensor": 1.727880439935123e-05}}, "connector_pipeline_timer": 7.416973635785498e-05}, "num_env_steps_sampled": 5000.0, "module_episode_returns_mean": {"default_policy": 0.54}, "sample": 0.009372817878326958, "num_module_steps_sampled": {"default_policy": 5000.0}, "num_episodes": 250.0, "module_to_env_connector": {"connector_pipeline_timer": 0.00019373952614817295, "timers": {"connectors": {"tensor_to_numpy": 2.4919523869856037e-05, "get_actions": 8.067366552216889e-05, "un_batch_to_individual_items": 9.204720510545717e-06, "normalize_and_clip_actions": 1.5948079496355998e-05, "listify_data_for_vector_env": 1.958763835545431e-05, "remove_single_ts_time_rank_from_batch": 9.51113303241664e-07}}}, "time_between_sampling": 0.002409576101314041, "num_env_steps_sampled_lifetime": -2460000.0, "episode_return_mean": 0.54, "episode_return_min": -10.5, "agent_episode_returns_mean": {"default_agent": 0.54}, "episode_duration_sec_mean": 0.008393543979618695, "env_to_module_sum_episodes_length_out": 10.36823839457432, "episode_len_mean": 20.0, "env_reset_timer": 8.717312746631746e-05, "num_agent_steps_sampled_lifetime": {"default_agent": -2460000.0}, "num_episodes_lifetime": -123000.0, "episode_len_max": 20, "rlmodule_inference_timer": 5.47971372159218e-05, "env_to_module_sum_episodes_length_in": 10.36823839457432, "num_agent_steps_sampled": {"default_agent": 5000.0}, "episode_return_max": 9.5, "episode_len_min": 20, "env_step_timer": 2.6628237944463733e-05, "num_module_steps_sampled_lifetime": {"default_policy": -2460000.0}, "num_env_steps_sampled_lifetime_throughput": 2355.2676169721303}, "learners": {"__all_modules__": {"learner_connector": {"timers": {"connectors": {"add_time_dim_to_batch_and_zero_pad": 1.651892586897425e-05, "add_observations_from_episodes_to_batch": 0.0008976086288627662, "add_states_from_episodes_to_batch": 4.097647625352256e-06, "add_columns_from_episodes_to_train_batch": 0.04954392182160187, "batch_individual_items": 0.04937376154789768, "add_one_ts_to_episodes_and_truncate": 0.010771590816495856, "numpy_to_tensor": 0.0001234992709499383, "general_advantage_estimation": 0.008657512408639064}}, "connector_pipeline_timer": 0.11962629416480584}, "num_env_steps_trained_lifetime": 189000, "num_module_steps_trained": 6000, "num_trainable_parameters": 6003, "learner_connector_sum_episodes_length_in": 5000.0, "num_non_trainable_parameters": 0, "learner_connector_sum_episodes_length_out": 5250.0, "num_env_steps_trained": 31500, "num_module_steps_trained_lifetime": 36000, "num_env_steps_trained_lifetime_throughput": 902869.3492867971, "num_module_steps_trained_throughput": 172373.98087343053, "num_module_steps_trained_lifetime_throughput": 172203.19909280288}, "default_policy": {"gradients_default_optimizer_global_norm": 0.013501612469553947, "entropy": 0.6760303974151611, "vf_explained_var": -0.010419487953186035, "mean_kl_loss": 0.0007163780392147601, "num_module_steps_trained_lifetime": 36000, "vf_loss": 0.10278083384037018, "default_optimizer_learning_rate": 0.0002847858517, "curr_kl_coeff": 0.011664004996418953, "module_train_batch_size_mean": 1000.0, "num_module_steps_trained": 6000, "num_trainable_parameters": 6003, "weights_seq_no": 6.0, "policy_loss": 0.13901302218437195, "diff_num_grad_updates_vs_sampler_policy": 1.0, "vf_loss_unclipped": 28.676469802856445, "curr_entropy_coeff": 0.0090570820258, "total_loss": 0.20164747536182404, "num_module_steps_trained_lifetime_throughput": 172578.61520601445}}, "num_training_step_calls_per_iteration": 1, "evaluation": {"env_runners": {"episode_len_min": 20, "episode_return_max": 13.5, "num_env_steps_sampled": 400, "sample": 0.1882722076583233, "env_to_module_connector": {"timers": {"connectors": {"add_observations_from_episodes_to_batch": 3.4286070110745777e-06, "add_states_from_episodes_to_batch": 1.7781679945192694e-06, "batch_individual_items": 7.771478664708395e-06, "numpy_to_tensor": 1.108881554556505e-05, "add_time_dim_to_batch_and_zero_pad": 2.6360833979493904e-06}}, "connector_pipeline_timer": 5.186420470775051e-05}, "num_episodes": 20, "num_env_steps_sampled_lifetime": 30400, "episode_len_max": 20, "module_to_env_connector": {"timers": {"connectors": {"tensor_to_numpy": 1.8432272225720955e-05, "get_actions": 5.130849038384209e-05, "un_batch_to_individual_items": 6.426438583104996e-06, "normalize_and_clip_actions": 1.1283944741945152e-05, "listify_data_for_vector_env": 1.4774169937679e-05, "remove_single_ts_time_rank_from_batch": 7.227974506986919e-07}}, "connector_pipeline_timer": 0.00013535442344015446}, "episode_return_min": -14.5, "env_to_module_sum_episodes_length_out": 10.368238394470474, "num_agent_steps_sampled": {"default_agent": 400}, "module_episode_returns_mean": {"default_policy": 0.45}, "rlmodule_inference_timer": 3.7249248961699315e-05, "env_to_module_sum_episodes_length_in": 10.368238394470474, "env_step_timer": 1.8660839486387446e-05, "num_agent_steps_sampled_lifetime": {"default_agent": 2400}, "episode_len_mean": 20.0, "env_reset_timer": 0.0007078536014632972, "num_module_steps_sampled_lifetime": {"default_policy": 2400}, "num_episodes_lifetime": 120, "num_module_steps_sampled": {"default_policy": 400}, "agent_episode_returns_mean": {"default_agent": 0.45}, "weights_seq_no": 6.0, "episode_return_mean": 0.45, "episode_duration_sec_mean": 0.00698106745374389, "time_between_sampling": 2.9321276622151013}, "num_healthy_workers": 1, "actor_manager_num_outstanding_async_reqs": 0, "num_remote_worker_restarts": 0}, "num_env_steps_sampled_lifetime": -2460000.0, "fault_tolerance": {"num_healthy_workers": 0, "num_remote_worker_restarts": 0}, "env_runner_group": {"actor_manager_num_outstanding_async_reqs": 0}, "done": false, "training_iteration": 6, "trial_id": "49ef3_00000", "date": "2025-08-11_19-30-50", "timestamp": 1754933450, "time_this_iter_s": 2.9875059127807617, "time_total_s": 20.68223762512207, "pid": 23180, "hostname": "Mac", "node_ip": "127.0.0.1", "config": {"exploration_config": {}, "extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "placement_strategy": "PACK", "num_gpus": 0, "_fake_gpus": false, "num_cpus_for_main_process": 2, "eager_tracing": true, "eager_max_retraces": 20, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "torch_compile_learner": false, "torch_compile_learner_what_to_compile": "forward_train", "torch_compile_learner_dynamo_backend": "aot_eager", "torch_compile_learner_dynamo_mode": null, "torch_compile_worker": false, "torch_compile_worker_dynamo_backend": "aot_eager", "torch_compile_worker_dynamo_mode": null, "torch_ddp_kwargs": {}, "torch_skip_nan_gradients": false, "env": "Umbrella", "env_config": {}, "observation_space": null, "action_space": null, "clip_rewards": null, "normalize_actions": true, "clip_actions": false, "_is_atari": null, "disable_env_checking": false, "render_env": false, "action_mask_key": "action_mask", "env_runner_cls": null, "num_env_runners": 0, "create_local_env_runner": true, "num_envs_per_env_runner": 1, "gym_env_vectorize_mode": "SYNC", "num_cpus_per_env_runner": 1, "num_gpus_per_env_runner": 0, "custom_resources_per_env_runner": {}, "validate_env_runners_after_construction": true, "episodes_to_numpy": true, "max_requests_in_flight_per_env_runner": 1, "sample_timeout_s": 60.0, "_env_to_module_connector": null, "add_default_connectors_to_env_to_module_pipeline": true, "_module_to_env_connector": null, "add_default_connectors_to_module_to_env_pipeline": true, "merge_env_runner_states": "training_only", "broadcast_env_runner_states": true, "episode_lookback_horizon": 1, "rollout_fragment_length": "auto", "batch_mode": "complete_episodes", "compress_observations": false, "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "enable_tf1_exec_eagerly": false, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "preprocessor_pref": "deepmind", "observation_filter": "NoFilter", "update_worker_filter_stats": true, "use_worker_filter_stats": true, "sampler_perf_stats_ema_coef": null, "_is_online": true, "num_learners": 0, "num_gpus_per_learner": 0, "num_cpus_per_learner": "auto", "num_aggregator_actors_per_learner": 0, "max_requests_in_flight_per_aggregator_actor": 3, "local_gpu_idx": 0, "max_requests_in_flight_per_learner": 3, "gamma": 1, "lr": 0.0002847858517, "grad_clip": 0.5, "grad_clip_by": "global_norm", "_train_batch_size_per_learner": 5000, "train_batch_size": 4000, "num_epochs": 1, "minibatch_size": 1000, "shuffle_batch_per_epoch": true, "model": {"fcnet_hiddens": [256, 256], "fcnet_activation": "tanh", "fcnet_weights_initializer": null, "fcnet_weights_initializer_config": null, "fcnet_bias_initializer": null, "fcnet_bias_initializer_config": null, "conv_filters": null, "conv_activation": "relu", "conv_kernel_initializer": null, "conv_kernel_initializer_config": null, "conv_bias_initializer": null, "conv_bias_initializer_config": null, "conv_transpose_kernel_initializer": null, "conv_transpose_kernel_initializer_config": null, "conv_transpose_bias_initializer": null, "conv_transpose_bias_initializer_config": null, "post_fcnet_hiddens": [], "post_fcnet_activation": "relu", "post_fcnet_weights_initializer": null, "post_fcnet_weights_initializer_config": null, "post_fcnet_bias_initializer": null, "post_fcnet_bias_initializer_config": null, "free_log_std": false, "log_std_clip_param": 20.0, "no_final_linear": false, "vf_share_layers": false, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "lstm_weights_initializer": null, "lstm_weights_initializer_config": null, "lstm_bias_initializer": null, "lstm_bias_initializer_config": null, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "attention_use_n_prev_actions": 0, "attention_use_n_prev_rewards": 0, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": null, "custom_model_config": {}, "custom_action_dist": null, "custom_preprocessor": null, "encoder_latent_dim": null, "always_check_shapes": false, "lstm_use_prev_action_reward": -1, "_use_default_native_models": -1, "_disable_preprocessor_api": false, "_disable_action_flattening": false}, "_learner_connector": null, "add_default_connectors_to_learner_pipeline": true, "learner_config_dict": {}, "optimizer": {}, "_learner_class": null, "callbacks_on_algorithm_init": null, "callbacks_on_env_runners_recreated": null, "callbacks_on_offline_eval_runners_recreated": null, "callbacks_on_checkpoint_loaded": null, "callbacks_on_environment_created": null, "callbacks_on_episode_created": null, "callbacks_on_episode_start": null, "callbacks_on_episode_step": null, "callbacks_on_episode_end": null, "callbacks_on_evaluate_start": null, "callbacks_on_evaluate_end": null, "callbacks_on_evaluate_offline_start": null, "callbacks_on_evaluate_offline_end": null, "callbacks_on_sample_end": null, "callbacks_on_train_result": null, "explore": true, "enable_rl_module_and_learner": true, "enable_env_runner_and_connector_v2": true, "_prior_exploration_config": {"type": "StochasticSampling"}, "count_steps_by": "env_steps", "policy_map_capacity": 100, "policy_mapping_fn": "<function AlgorithmConfig.DEFAULT_POLICY_MAPPING_FN at 0x13e6b9b20>", "policies_to_train": null, "policy_states_are_swappable": false, "observation_fn": null, "offline_data_class": null, "input_read_method": "read_parquet", "input_read_method_kwargs": {}, "input_read_schema": {}, "input_read_episodes": false, "input_read_sample_batches": false, "input_read_batch_size": null, "input_filesystem": null, "input_filesystem_kwargs": {}, "input_compress_columns": ["obs", "new_obs"], "input_spaces_jsonable": true, "materialize_data": false, "materialize_mapped_data": true, "map_batches_kwargs": {}, "iter_batches_kwargs": {}, "ignore_final_observation": false, "prelearner_class": null, "prelearner_buffer_class": null, "prelearner_buffer_kwargs": {}, "prelearner_module_synch_period": 10, "dataset_num_iters_per_learner": null, "input_config": {}, "actions_in_input_normalized": false, "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_config": {}, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "output_max_rows_per_file": null, "output_write_remaining_data": false, "output_write_method": "write_parquet", "output_write_method_kwargs": {}, "output_filesystem": null, "output_filesystem_kwargs": {}, "output_write_episodes": true, "offline_sampling": false, "evaluation_interval": 1, "evaluation_duration": 20, "evaluation_duration_unit": "episodes", "evaluation_sample_timeout_s": 120.0, "evaluation_auto_duration_min_env_steps_per_sample": 100, "evaluation_auto_duration_max_env_steps_per_sample": 2000, "evaluation_parallel_to_training": false, "evaluation_force_reset_envs_before_iteration": true, "evaluation_config": null, "off_policy_estimation_methods": {}, "ope_split_batch_by_episode": true, "evaluation_num_env_runners": 1, "in_evaluation": false, "sync_filters_on_rollout_workers_timeout_s": 10.0, "offline_evaluation_interval": null, "num_offline_eval_runners": 0, "offline_loss_for_module_fn": null, "offline_evaluation_duration": 1, "offline_evaluation_parallel_to_training": false, "offline_evaluation_timeout_s": 120.0, "num_cpus_per_offline_eval_runner": 1, "num_gpus_per_offline_eval_runner": 0, "custom_resources_per_offline_eval_runner": {}, "restart_failed_offline_eval_runners": true, "ignore_offline_eval_runner_failures": false, "max_num_offline_eval_runner_restarts": 1000, "offline_eval_runner_restore_timeout_s": 1800.0, "max_requests_in_flight_per_offline_eval_runner": 1, "validate_offline_eval_runners_after_construction": true, "offline_eval_runner_health_probe_timeout_s": 30.0, "offline_eval_rl_module_inference_only": false, "broadcast_offline_eval_runner_states": false, "offline_eval_batch_size_per_runner": 256, "dataset_num_iters_per_eval_runner": 1, "keep_per_episode_custom_metrics": false, "metrics_episode_collection_timeout_s": 60.0, "metrics_num_episodes_for_smoothing": 100, "min_time_s_per_iteration": null, "min_train_timesteps_per_iteration": 0, "min_sample_timesteps_per_iteration": 0, "log_gradients": true, "export_native_model_files": false, "checkpoint_trainable_policies_only": false, "logger_creator": null, "logger_config": null, "log_level": "WARN", "log_sys_usage": true, "fake_sampler": false, "seed": 10, "restart_failed_env_runners": true, "ignore_env_runner_failures": false, "max_num_env_runner_restarts": 1000, "delay_between_env_runner_restarts_s": 60.0, "restart_failed_sub_environments": false, "num_consecutive_env_runner_failures_tolerance": 100, "env_runner_health_probe_timeout_s": 30.0, "env_runner_restore_timeout_s": 1800.0, "_model_config": {}, "_rl_module_spec": "RLModuleSpec(module_class=None, observation_space=None, action_space=None, inference_only=False, learner_only=False, model_config=DefaultModelConfig(fcnet_hiddens=[60, 90], fcnet_activation='tanh', fcnet_kernel_initializer=None, fcnet_kernel_initializer_kwargs=None, fcnet_bias_initializer=None, fcnet_bias_initializer_kwargs=None, conv_filters=None, conv_activation='relu', conv_kernel_initializer=None, conv_kernel_initializer_kwargs=None, conv_bias_initializer=None, conv_bias_initializer_kwargs=None, head_fcnet_hiddens=[], head_fcnet_activation='relu', head_fcnet_kernel_initializer=None, head_fcnet_kernel_initializer_kwargs=None, head_fcnet_bias_initializer=None, head_fcnet_bias_initializer_kwargs=None, free_log_std=False, log_std_clip_param=20.0, vf_share_layers=True, use_lstm=False, max_seq_len=20, lstm_cell_size=256, lstm_use_prev_action=False, lstm_use_prev_reward=False, lstm_kernel_initializer=None, lstm_kernel_initializer_kwargs=None, lstm_bias_initializer=None, lstm_bias_initializer_kwargs=None), catalog_class=None, load_state_path=None, model_config_dict=None)", "algorithm_config_overrides_per_module": {}, "_per_module_overrides": {}, "_validate_config": true, "_use_msgpack_checkpoints": false, "_torch_grad_scaler_class": null, "_torch_lr_scheduler_classes": null, "_tf_policy_handles_more_than_one_loss": false, "_disable_preprocessor_api": false, "_disable_action_flattening": false, "_disable_initialize_loss_from_dummy_batch": false, "_dont_auto_sync_env_runner_states": false, "env_task_fn": -1, "enable_connectors": -1, "simple_optimizer": false, "policy_map_cache": -1, "worker_cls": -1, "synchronize_filters": -1, "enable_async_evaluation": -1, "custom_async_evaluation_function": -1, "_enable_rl_module_api": -1, "auto_wrap_old_gym_envs": -1, "always_attach_evaluation_results": -1, "replay_sequence_length": null, "_disable_execution_plan_api": -1, "use_critic": true, "use_gae": true, "use_kl_loss": true, "kl_coeff": 0.7464963036515, "kl_target": 0.0270990929592, "vf_loss_coeff": 0.6688075857018, "entropy_coeff": 0.0090570820258, "clip_param": 0.1221781641624, "vf_clip_param": 0.1027808522125, "entropy_coeff_schedule": null, "lr_schedule": null, "sgd_minibatch_size": -1, "vf_share_layers": -1, "__stdout_file__": null, "__stderr_file__": null, "lambda": 0.9099046732075, "input": "sampler", "policies": {"default_policy": [null, null, null, null]}, "callbacks": "<class 'ray.rllib.callbacks.callbacks.RLlibCallback'>", "create_env_on_driver": false, "custom_eval_function": null, "framework": "torch"}, "time_since_restore": 20.68223762512207, "iterations_since_restore": 6, "perf": {"cpu_util_percent": 53.375, "ram_util_percent": 79.27499999999999}}
{"timers": {"training_iteration": 4.508938043791957, "restore_env_runners": 1.4273852026101265e-05, "training_step": 4.50858654117667, "env_runner_sampling_timer": 4.309657453689865, "learner_update_timer": 0.19019059145488607, "synch_weights": 0.002225925424395005, "restore_eval_env_runners": 1.8254793919489126e-05, "evaluation_iteration": 0.20377905639657992, "synch_eval_env_connectors": 0.0002525112714931768, "synch_env_connectors": 4.573025847693055e-06}, "env_runners": {"weights_seq_no": 6.0, "env_to_module_connector": {"timers": {"connectors": {"add_states_from_episodes_to_batch": 2.6053507074635063e-06, "batch_individual_items": 1.1819128034677048e-05, "add_observations_from_episodes_to_batch": 5.094030544575452e-06, "add_time_dim_to_batch_and_zero_pad": 4.182900231513897e-06, "numpy_to_tensor": 1.715161731035908e-05}}, "connector_pipeline_timer": 7.622828914459123e-05}, "num_env_steps_sampled": 5000.0, "module_episode_returns_mean": {"default_policy": 2.0599999999999996}, "sample": 0.009052282415781135, "num_module_steps_sampled": {"default_policy": 5000.0}, "num_episodes": 250.0, "module_to_env_connector": {"connector_pipeline_timer": 0.0001954088878318444, "timers": {"connectors": {"tensor_to_numpy": 2.437734396249662e-05, "get_actions": 8.256348133246057e-05, "un_batch_to_individual_items": 9.628502366678703e-06, "normalize_and_clip_actions": 1.6225641506736832e-05, "listify_data_for_vector_env": 1.934459903249315e-05, "remove_single_ts_time_rank_from_batch": 9.889748402703663e-07}}}, "time_between_sampling": 0.0030135182190746974, "num_env_steps_sampled_lifetime": -3077500.0, "episode_return_mean": 2.0599999999999996, "episode_return_min": -10.5, "agent_episode_returns_mean": {"default_agent": 2.0599999999999996}, "episode_duration_sec_mean": 0.008446013011969625, "env_to_module_sum_episodes_length_out": 10.36823839457432, "episode_len_mean": 20.0, "env_reset_timer": 8.24860513420142e-05, "num_agent_steps_sampled_lifetime": {"default_agent": -3077500.0}, "num_episodes_lifetime": -153875.0, "episode_len_max": 20, "rlmodule_inference_timer": 5.496569080377517e-05, "env_to_module_sum_episodes_length_in": 10.36823839457432, "num_agent_steps_sampled": {"default_agent": 5000.0}, "episode_return_max": 9.5, "episode_len_min": 20, "env_step_timer": 2.645215327691649e-05, "num_module_steps_sampled_lifetime": {"default_policy": -3077500.0}, "num_env_steps_sampled_lifetime_throughput": 2337.172755994607}, "learners": {"__all_modules__": {"learner_connector": {"timers": {"connectors": {"add_time_dim_to_batch_and_zero_pad": 1.6489156733399687e-05, "add_observations_from_episodes_to_batch": 0.0008983604525023263, "add_states_from_episodes_to_batch": 4.098761108705262e-06, "add_columns_from_episodes_to_train_batch": 0.04948673469362947, "batch_individual_items": 0.04924507393325578, "add_one_ts_to_episodes_and_truncate": 0.01075514323891052, "numpy_to_tensor": 0.00012299427797825296, "general_advantage_estimation": 0.008634994364860649}}, "connector_pipeline_timer": 0.11940071664348281}, "num_env_steps_trained_lifetime": 220500, "num_module_steps_trained": 6000, "num_trainable_parameters": 6003, "learner_connector_sum_episodes_length_in": 5000.0, "num_non_trainable_parameters": 0, "learner_connector_sum_episodes_length_out": 5250.0, "num_env_steps_trained": 31500, "num_module_steps_trained_lifetime": 42000, "num_env_steps_trained_lifetime_throughput": 925900.668198225, "num_module_steps_trained_throughput": 176752.225308742, "num_module_steps_trained_lifetime_throughput": 176582.17489683875}, "default_policy": {"gradients_default_optimizer_global_norm": 0.058202605694532394, "entropy": 0.6714522838592529, "vf_explained_var": -0.010401129722595215, "mean_kl_loss": 0.00041595392394810915, "num_module_steps_trained_lifetime": 42000, "vf_loss": 0.10278083384037018, "default_optimizer_learning_rate": 0.0002847858517, "curr_kl_coeff": 0.0058320024982094765, "module_train_batch_size_mean": 1000.0, "num_module_steps_trained": 6000, "num_trainable_parameters": 6003, "weights_seq_no": 7.0, "policy_loss": -0.034859273582696915, "diff_num_grad_updates_vs_sampler_policy": 1.0, "vf_loss_unclipped": 28.562328338623047, "curr_entropy_coeff": 0.0090570820258, "total_loss": 0.027804788202047348, "num_module_steps_trained_lifetime_throughput": 176937.8064882469}}, "num_training_step_calls_per_iteration": 1, "evaluation": {"env_runners": {"episode_len_min": 20, "episode_return_max": 13.5, "num_env_steps_sampled": 400, "sample": 0.18849324683119476, "env_to_module_connector": {"timers": {"connectors": {"add_observations_from_episodes_to_batch": 4.150175807390185e-06, "add_states_from_episodes_to_batch": 2.2590112226914793e-06, "batch_individual_items": 9.79639526653555e-06, "numpy_to_tensor": 1.438297426060333e-05, "add_time_dim_to_batch_and_zero_pad": 3.10943240884756e-06}}, "connector_pipeline_timer": 6.354435006671505e-05}, "num_episodes": 20, "num_env_steps_sampled_lifetime": 35400, "episode_len_max": 20, "module_to_env_connector": {"timers": {"connectors": {"tensor_to_numpy": 2.0316397134423633e-05, "get_actions": 6.922944202456735e-05, "un_batch_to_individual_items": 8.171803795662756e-06, "normalize_and_clip_actions": 1.3294215808072276e-05, "listify_data_for_vector_env": 1.9304548551580265e-05, "remove_single_ts_time_rank_from_batch": 7.684920145365846e-07}}, "connector_pipeline_timer": 0.00016833678365255246}, "episode_return_min": -14.5, "env_to_module_sum_episodes_length_out": 10.368238394572801, "num_agent_steps_sampled": {"default_agent": 400}, "module_episode_returns_mean": {"default_policy": 0.45}, "rlmodule_inference_timer": 4.869066782569173e-05, "env_to_module_sum_episodes_length_in": 10.368238394572801, "env_step_timer": 2.321172169507274e-05, "num_agent_steps_sampled_lifetime": {"default_agent": 2800}, "episode_len_mean": 20.0, "env_reset_timer": 0.0007016663155412005, "num_module_steps_sampled_lifetime": {"default_policy": 2800}, "num_episodes_lifetime": 140, "num_module_steps_sampled": {"default_policy": 400}, "agent_episode_returns_mean": {"default_agent": 0.45}, "weights_seq_no": 7.0, "episode_return_mean": 0.45, "episode_duration_sec_mean": 0.0076737470261286946, "time_between_sampling": 2.929716936012657}, "num_healthy_workers": 1, "actor_manager_num_outstanding_async_reqs": 0, "num_remote_worker_restarts": 0}, "num_env_steps_sampled_lifetime": -3077500.0, "fault_tolerance": {"num_healthy_workers": 0, "num_remote_worker_restarts": 0}, "env_runner_group": {"actor_manager_num_outstanding_async_reqs": 0}, "done": false, "training_iteration": 7, "trial_id": "49ef3_00000", "date": "2025-08-11_19-30-53", "timestamp": 1754933453, "time_this_iter_s": 2.8796849250793457, "time_total_s": 23.561922550201416, "pid": 23180, "hostname": "Mac", "node_ip": "127.0.0.1", "config": {"exploration_config": {}, "extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "placement_strategy": "PACK", "num_gpus": 0, "_fake_gpus": false, "num_cpus_for_main_process": 2, "eager_tracing": true, "eager_max_retraces": 20, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "torch_compile_learner": false, "torch_compile_learner_what_to_compile": "forward_train", "torch_compile_learner_dynamo_backend": "aot_eager", "torch_compile_learner_dynamo_mode": null, "torch_compile_worker": false, "torch_compile_worker_dynamo_backend": "aot_eager", "torch_compile_worker_dynamo_mode": null, "torch_ddp_kwargs": {}, "torch_skip_nan_gradients": false, "env": "Umbrella", "env_config": {}, "observation_space": null, "action_space": null, "clip_rewards": null, "normalize_actions": true, "clip_actions": false, "_is_atari": null, "disable_env_checking": false, "render_env": false, "action_mask_key": "action_mask", "env_runner_cls": null, "num_env_runners": 0, "create_local_env_runner": true, "num_envs_per_env_runner": 1, "gym_env_vectorize_mode": "SYNC", "num_cpus_per_env_runner": 1, "num_gpus_per_env_runner": 0, "custom_resources_per_env_runner": {}, "validate_env_runners_after_construction": true, "episodes_to_numpy": true, "max_requests_in_flight_per_env_runner": 1, "sample_timeout_s": 60.0, "_env_to_module_connector": null, "add_default_connectors_to_env_to_module_pipeline": true, "_module_to_env_connector": null, "add_default_connectors_to_module_to_env_pipeline": true, "merge_env_runner_states": "training_only", "broadcast_env_runner_states": true, "episode_lookback_horizon": 1, "rollout_fragment_length": "auto", "batch_mode": "complete_episodes", "compress_observations": false, "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "enable_tf1_exec_eagerly": false, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "preprocessor_pref": "deepmind", "observation_filter": "NoFilter", "update_worker_filter_stats": true, "use_worker_filter_stats": true, "sampler_perf_stats_ema_coef": null, "_is_online": true, "num_learners": 0, "num_gpus_per_learner": 0, "num_cpus_per_learner": "auto", "num_aggregator_actors_per_learner": 0, "max_requests_in_flight_per_aggregator_actor": 3, "local_gpu_idx": 0, "max_requests_in_flight_per_learner": 3, "gamma": 1, "lr": 0.0002847858517, "grad_clip": 0.5, "grad_clip_by": "global_norm", "_train_batch_size_per_learner": 5000, "train_batch_size": 4000, "num_epochs": 1, "minibatch_size": 1000, "shuffle_batch_per_epoch": true, "model": {"fcnet_hiddens": [256, 256], "fcnet_activation": "tanh", "fcnet_weights_initializer": null, "fcnet_weights_initializer_config": null, "fcnet_bias_initializer": null, "fcnet_bias_initializer_config": null, "conv_filters": null, "conv_activation": "relu", "conv_kernel_initializer": null, "conv_kernel_initializer_config": null, "conv_bias_initializer": null, "conv_bias_initializer_config": null, "conv_transpose_kernel_initializer": null, "conv_transpose_kernel_initializer_config": null, "conv_transpose_bias_initializer": null, "conv_transpose_bias_initializer_config": null, "post_fcnet_hiddens": [], "post_fcnet_activation": "relu", "post_fcnet_weights_initializer": null, "post_fcnet_weights_initializer_config": null, "post_fcnet_bias_initializer": null, "post_fcnet_bias_initializer_config": null, "free_log_std": false, "log_std_clip_param": 20.0, "no_final_linear": false, "vf_share_layers": false, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "lstm_weights_initializer": null, "lstm_weights_initializer_config": null, "lstm_bias_initializer": null, "lstm_bias_initializer_config": null, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "attention_use_n_prev_actions": 0, "attention_use_n_prev_rewards": 0, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": null, "custom_model_config": {}, "custom_action_dist": null, "custom_preprocessor": null, "encoder_latent_dim": null, "always_check_shapes": false, "lstm_use_prev_action_reward": -1, "_use_default_native_models": -1, "_disable_preprocessor_api": false, "_disable_action_flattening": false}, "_learner_connector": null, "add_default_connectors_to_learner_pipeline": true, "learner_config_dict": {}, "optimizer": {}, "_learner_class": null, "callbacks_on_algorithm_init": null, "callbacks_on_env_runners_recreated": null, "callbacks_on_offline_eval_runners_recreated": null, "callbacks_on_checkpoint_loaded": null, "callbacks_on_environment_created": null, "callbacks_on_episode_created": null, "callbacks_on_episode_start": null, "callbacks_on_episode_step": null, "callbacks_on_episode_end": null, "callbacks_on_evaluate_start": null, "callbacks_on_evaluate_end": null, "callbacks_on_evaluate_offline_start": null, "callbacks_on_evaluate_offline_end": null, "callbacks_on_sample_end": null, "callbacks_on_train_result": null, "explore": true, "enable_rl_module_and_learner": true, "enable_env_runner_and_connector_v2": true, "_prior_exploration_config": {"type": "StochasticSampling"}, "count_steps_by": "env_steps", "policy_map_capacity": 100, "policy_mapping_fn": "<function AlgorithmConfig.DEFAULT_POLICY_MAPPING_FN at 0x13e6b9b20>", "policies_to_train": null, "policy_states_are_swappable": false, "observation_fn": null, "offline_data_class": null, "input_read_method": "read_parquet", "input_read_method_kwargs": {}, "input_read_schema": {}, "input_read_episodes": false, "input_read_sample_batches": false, "input_read_batch_size": null, "input_filesystem": null, "input_filesystem_kwargs": {}, "input_compress_columns": ["obs", "new_obs"], "input_spaces_jsonable": true, "materialize_data": false, "materialize_mapped_data": true, "map_batches_kwargs": {}, "iter_batches_kwargs": {}, "ignore_final_observation": false, "prelearner_class": null, "prelearner_buffer_class": null, "prelearner_buffer_kwargs": {}, "prelearner_module_synch_period": 10, "dataset_num_iters_per_learner": null, "input_config": {}, "actions_in_input_normalized": false, "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_config": {}, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "output_max_rows_per_file": null, "output_write_remaining_data": false, "output_write_method": "write_parquet", "output_write_method_kwargs": {}, "output_filesystem": null, "output_filesystem_kwargs": {}, "output_write_episodes": true, "offline_sampling": false, "evaluation_interval": 1, "evaluation_duration": 20, "evaluation_duration_unit": "episodes", "evaluation_sample_timeout_s": 120.0, "evaluation_auto_duration_min_env_steps_per_sample": 100, "evaluation_auto_duration_max_env_steps_per_sample": 2000, "evaluation_parallel_to_training": false, "evaluation_force_reset_envs_before_iteration": true, "evaluation_config": null, "off_policy_estimation_methods": {}, "ope_split_batch_by_episode": true, "evaluation_num_env_runners": 1, "in_evaluation": false, "sync_filters_on_rollout_workers_timeout_s": 10.0, "offline_evaluation_interval": null, "num_offline_eval_runners": 0, "offline_loss_for_module_fn": null, "offline_evaluation_duration": 1, "offline_evaluation_parallel_to_training": false, "offline_evaluation_timeout_s": 120.0, "num_cpus_per_offline_eval_runner": 1, "num_gpus_per_offline_eval_runner": 0, "custom_resources_per_offline_eval_runner": {}, "restart_failed_offline_eval_runners": true, "ignore_offline_eval_runner_failures": false, "max_num_offline_eval_runner_restarts": 1000, "offline_eval_runner_restore_timeout_s": 1800.0, "max_requests_in_flight_per_offline_eval_runner": 1, "validate_offline_eval_runners_after_construction": true, "offline_eval_runner_health_probe_timeout_s": 30.0, "offline_eval_rl_module_inference_only": false, "broadcast_offline_eval_runner_states": false, "offline_eval_batch_size_per_runner": 256, "dataset_num_iters_per_eval_runner": 1, "keep_per_episode_custom_metrics": false, "metrics_episode_collection_timeout_s": 60.0, "metrics_num_episodes_for_smoothing": 100, "min_time_s_per_iteration": null, "min_train_timesteps_per_iteration": 0, "min_sample_timesteps_per_iteration": 0, "log_gradients": true, "export_native_model_files": false, "checkpoint_trainable_policies_only": false, "logger_creator": null, "logger_config": null, "log_level": "WARN", "log_sys_usage": true, "fake_sampler": false, "seed": 10, "restart_failed_env_runners": true, "ignore_env_runner_failures": false, "max_num_env_runner_restarts": 1000, "delay_between_env_runner_restarts_s": 60.0, "restart_failed_sub_environments": false, "num_consecutive_env_runner_failures_tolerance": 100, "env_runner_health_probe_timeout_s": 30.0, "env_runner_restore_timeout_s": 1800.0, "_model_config": {}, "_rl_module_spec": "RLModuleSpec(module_class=None, observation_space=None, action_space=None, inference_only=False, learner_only=False, model_config=DefaultModelConfig(fcnet_hiddens=[60, 90], fcnet_activation='tanh', fcnet_kernel_initializer=None, fcnet_kernel_initializer_kwargs=None, fcnet_bias_initializer=None, fcnet_bias_initializer_kwargs=None, conv_filters=None, conv_activation='relu', conv_kernel_initializer=None, conv_kernel_initializer_kwargs=None, conv_bias_initializer=None, conv_bias_initializer_kwargs=None, head_fcnet_hiddens=[], head_fcnet_activation='relu', head_fcnet_kernel_initializer=None, head_fcnet_kernel_initializer_kwargs=None, head_fcnet_bias_initializer=None, head_fcnet_bias_initializer_kwargs=None, free_log_std=False, log_std_clip_param=20.0, vf_share_layers=True, use_lstm=False, max_seq_len=20, lstm_cell_size=256, lstm_use_prev_action=False, lstm_use_prev_reward=False, lstm_kernel_initializer=None, lstm_kernel_initializer_kwargs=None, lstm_bias_initializer=None, lstm_bias_initializer_kwargs=None), catalog_class=None, load_state_path=None, model_config_dict=None)", "algorithm_config_overrides_per_module": {}, "_per_module_overrides": {}, "_validate_config": true, "_use_msgpack_checkpoints": false, "_torch_grad_scaler_class": null, "_torch_lr_scheduler_classes": null, "_tf_policy_handles_more_than_one_loss": false, "_disable_preprocessor_api": false, "_disable_action_flattening": false, "_disable_initialize_loss_from_dummy_batch": false, "_dont_auto_sync_env_runner_states": false, "env_task_fn": -1, "enable_connectors": -1, "simple_optimizer": false, "policy_map_cache": -1, "worker_cls": -1, "synchronize_filters": -1, "enable_async_evaluation": -1, "custom_async_evaluation_function": -1, "_enable_rl_module_api": -1, "auto_wrap_old_gym_envs": -1, "always_attach_evaluation_results": -1, "replay_sequence_length": null, "_disable_execution_plan_api": -1, "use_critic": true, "use_gae": true, "use_kl_loss": true, "kl_coeff": 0.7464963036515, "kl_target": 0.0270990929592, "vf_loss_coeff": 0.6688075857018, "entropy_coeff": 0.0090570820258, "clip_param": 0.1221781641624, "vf_clip_param": 0.1027808522125, "entropy_coeff_schedule": null, "lr_schedule": null, "sgd_minibatch_size": -1, "vf_share_layers": -1, "__stdout_file__": null, "__stderr_file__": null, "lambda": 0.9099046732075, "input": "sampler", "policies": {"default_policy": [null, null, null, null]}, "callbacks": "<class 'ray.rllib.callbacks.callbacks.RLlibCallback'>", "create_env_on_driver": false, "custom_eval_function": null, "framework": "torch"}, "time_since_restore": 23.561922550201416, "iterations_since_restore": 7, "perf": {"cpu_util_percent": 74.675, "ram_util_percent": 79.15}}
{"timers": {"training_iteration": 4.491216783773598, "restore_env_runners": 1.419778339649732e-05, "training_step": 4.490866617845408, "env_runner_sampling_timer": 4.292149681232404, "learner_update_timer": 0.190029595121177, "synch_weights": 0.002210042829881504, "restore_eval_env_runners": 1.8205166666449792e-05, "evaluation_iteration": 0.2039273512525763, "synch_eval_env_connectors": 0.00025203157831105074, "synch_env_connectors": 4.586045745529305e-06}, "env_runners": {"weights_seq_no": 7.0, "env_to_module_connector": {"timers": {"connectors": {"add_states_from_episodes_to_batch": 2.5250933526625113e-06, "batch_individual_items": 1.1366163044746154e-05, "add_observations_from_episodes_to_batch": 5.260938862986544e-06, "add_time_dim_to_batch_and_zero_pad": 4.042926093342395e-06, "numpy_to_tensor": 1.6456873864335212e-05}}, "connector_pipeline_timer": 7.287136043570212e-05}, "num_env_steps_sampled": 5000.0, "module_episode_returns_mean": {"default_policy": 1.6599999999999997}, "sample": 0.009216757612811382, "num_module_steps_sampled": {"default_policy": 5000.0}, "num_episodes": 250.0, "module_to_env_connector": {"connector_pipeline_timer": 0.0001868093163049357, "timers": {"connectors": {"tensor_to_numpy": 2.338111234887402e-05, "get_actions": 7.800887695186515e-05, "un_batch_to_individual_items": 8.698519657375652e-06, "normalize_and_clip_actions": 1.530817167924688e-05, "listify_data_for_vector_env": 1.8944004928081337e-05, "remove_single_ts_time_rank_from_batch": 1.0405678863013466e-06}}}, "time_between_sampling": 0.00261103809697791, "num_env_steps_sampled_lifetime": -3695000.0, "episode_return_mean": 1.6599999999999997, "episode_return_min": -10.5, "agent_episode_returns_mean": {"default_agent": 1.6599999999999997}, "episode_duration_sec_mean": 0.008588774166069929, "env_to_module_sum_episodes_length_out": 10.36823839457432, "episode_len_mean": 20.0, "env_reset_timer": 7.574158613848736e-05, "num_agent_steps_sampled_lifetime": {"default_agent": -3695000.0}, "num_episodes_lifetime": -184750.0, "episode_len_max": 20, "rlmodule_inference_timer": 7.452692835948083e-05, "env_to_module_sum_episodes_length_in": 10.36823839457432, "num_agent_steps_sampled": {"default_agent": 5000.0}, "episode_return_max": 9.5, "episode_len_min": 20, "env_step_timer": 2.632857719335815e-05, "num_module_steps_sampled_lifetime": {"default_policy": -3695000.0}, "num_env_steps_sampled_lifetime_throughput": 2354.6820037094026}, "learners": {"__all_modules__": {"learner_connector": {"timers": {"connectors": {"add_time_dim_to_batch_and_zero_pad": 2.3304264764181373e-05, "add_observations_from_episodes_to_batch": 0.0009150618479778245, "add_states_from_episodes_to_batch": 4.326113142735731e-06, "add_columns_from_episodes_to_train_batch": 0.04974471901636978, "batch_individual_items": 0.04927709735397047, "add_one_ts_to_episodes_and_truncate": 0.010769883886717036, "numpy_to_tensor": 0.00012369600532031902, "general_advantage_estimation": 0.008625465670888911}}, "connector_pipeline_timer": 0.11972125072653739}, "num_env_steps_trained_lifetime": 252000, "num_module_steps_trained": 6000, "num_trainable_parameters": 6003, "learner_connector_sum_episodes_length_in": 5000.0, "num_non_trainable_parameters": 0, "learner_connector_sum_episodes_length_out": 5250.0, "num_env_steps_trained": 31500, "num_module_steps_trained_lifetime": 48000, "num_env_steps_trained_lifetime_throughput": 949163.7490995283, "num_module_steps_trained_throughput": 181172.97579649897, "num_module_steps_trained_lifetime_throughput": 181005.44049116157}, "default_policy": {"gradients_default_optimizer_global_norm": 0.019486667588353157, "entropy": 0.6594521403312683, "vf_explained_var": -0.010833382606506348, "mean_kl_loss": 0.0010036317398771644, "num_module_steps_trained_lifetime": 48000, "vf_loss": 0.10278083384037018, "default_optimizer_learning_rate": 0.0002847858517, "curr_kl_coeff": 0.0029160012491047382, "module_train_batch_size_mean": 1000.0, "num_module_steps_trained": 6000, "num_trainable_parameters": 6003, "weights_seq_no": 8.0, "policy_loss": 0.006612226366996765, "diff_num_grad_updates_vs_sampler_policy": 1.0, "vf_loss_unclipped": 28.607404708862305, "curr_entropy_coeff": 0.0090570820258, "total_loss": 0.06938596069812775, "num_module_steps_trained_lifetime_throughput": 181334.4461488677}}, "num_training_step_calls_per_iteration": 1, "evaluation": {"env_runners": {"episode_len_min": 20, "episode_return_max": 13.5, "num_env_steps_sampled": 400, "sample": 0.18798884811235328, "env_to_module_connector": {"timers": {"connectors": {"add_observations_from_episodes_to_batch": 3.4092114816854825e-06, "add_states_from_episodes_to_batch": 2.1110388139067626e-06, "batch_individual_items": 7.5577344660301476e-06, "numpy_to_tensor": 1.0767768847169963e-05, "add_time_dim_to_batch_and_zero_pad": 2.677830004832608e-06}}, "connector_pipeline_timer": 5.22780513565018e-05}, "num_episodes": 20, "num_env_steps_sampled_lifetime": 40400, "episode_len_max": 20, "module_to_env_connector": {"timers": {"connectors": {"tensor_to_numpy": 1.645650815096664e-05, "get_actions": 5.374867372704951e-05, "un_batch_to_individual_items": 6.474617358668596e-06, "normalize_and_clip_actions": 1.146886116368032e-05, "listify_data_for_vector_env": 1.4146030633298034e-05, "remove_single_ts_time_rank_from_batch": 6.778763293710339e-07}}, "connector_pipeline_timer": 0.00013264479214476402}, "episode_return_min": -14.5, "env_to_module_sum_episodes_length_out": 10.3682383945743, "num_agent_steps_sampled": {"default_agent": 400}, "module_episode_returns_mean": {"default_policy": 1.45}, "rlmodule_inference_timer": 3.838402883079025e-05, "env_to_module_sum_episodes_length_in": 10.3682383945743, "env_step_timer": 1.7689231399412574e-05, "num_agent_steps_sampled_lifetime": {"default_agent": 3200}, "episode_len_mean": 20.0, "env_reset_timer": 0.0006954000725352042, "num_module_steps_sampled_lifetime": {"default_policy": 3200}, "num_episodes_lifetime": 160, "num_module_steps_sampled": {"default_policy": 400}, "agent_episode_returns_mean": {"default_agent": 1.45}, "weights_seq_no": 8.0, "episode_return_mean": 1.45, "episode_duration_sec_mean": 0.007404669994721189, "time_between_sampling": 2.928059204562933}, "num_healthy_workers": 1, "actor_manager_num_outstanding_async_reqs": 0, "num_remote_worker_restarts": 0}, "num_env_steps_sampled_lifetime": -3695000.0, "fault_tolerance": {"num_healthy_workers": 0, "num_remote_worker_restarts": 0}, "env_runner_group": {"actor_manager_num_outstanding_async_reqs": 0}, "done": false, "training_iteration": 8, "trial_id": "49ef3_00000", "date": "2025-08-11_19-30-56", "timestamp": 1754933456, "time_this_iter_s": 2.8844408988952637, "time_total_s": 26.44636344909668, "pid": 23180, "hostname": "Mac", "node_ip": "127.0.0.1", "config": {"exploration_config": {}, "extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "placement_strategy": "PACK", "num_gpus": 0, "_fake_gpus": false, "num_cpus_for_main_process": 2, "eager_tracing": true, "eager_max_retraces": 20, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "torch_compile_learner": false, "torch_compile_learner_what_to_compile": "forward_train", "torch_compile_learner_dynamo_backend": "aot_eager", "torch_compile_learner_dynamo_mode": null, "torch_compile_worker": false, "torch_compile_worker_dynamo_backend": "aot_eager", "torch_compile_worker_dynamo_mode": null, "torch_ddp_kwargs": {}, "torch_skip_nan_gradients": false, "env": "Umbrella", "env_config": {}, "observation_space": null, "action_space": null, "clip_rewards": null, "normalize_actions": true, "clip_actions": false, "_is_atari": null, "disable_env_checking": false, "render_env": false, "action_mask_key": "action_mask", "env_runner_cls": null, "num_env_runners": 0, "create_local_env_runner": true, "num_envs_per_env_runner": 1, "gym_env_vectorize_mode": "SYNC", "num_cpus_per_env_runner": 1, "num_gpus_per_env_runner": 0, "custom_resources_per_env_runner": {}, "validate_env_runners_after_construction": true, "episodes_to_numpy": true, "max_requests_in_flight_per_env_runner": 1, "sample_timeout_s": 60.0, "_env_to_module_connector": null, "add_default_connectors_to_env_to_module_pipeline": true, "_module_to_env_connector": null, "add_default_connectors_to_module_to_env_pipeline": true, "merge_env_runner_states": "training_only", "broadcast_env_runner_states": true, "episode_lookback_horizon": 1, "rollout_fragment_length": "auto", "batch_mode": "complete_episodes", "compress_observations": false, "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "enable_tf1_exec_eagerly": false, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "preprocessor_pref": "deepmind", "observation_filter": "NoFilter", "update_worker_filter_stats": true, "use_worker_filter_stats": true, "sampler_perf_stats_ema_coef": null, "_is_online": true, "num_learners": 0, "num_gpus_per_learner": 0, "num_cpus_per_learner": "auto", "num_aggregator_actors_per_learner": 0, "max_requests_in_flight_per_aggregator_actor": 3, "local_gpu_idx": 0, "max_requests_in_flight_per_learner": 3, "gamma": 1, "lr": 0.0002847858517, "grad_clip": 0.5, "grad_clip_by": "global_norm", "_train_batch_size_per_learner": 5000, "train_batch_size": 4000, "num_epochs": 1, "minibatch_size": 1000, "shuffle_batch_per_epoch": true, "model": {"fcnet_hiddens": [256, 256], "fcnet_activation": "tanh", "fcnet_weights_initializer": null, "fcnet_weights_initializer_config": null, "fcnet_bias_initializer": null, "fcnet_bias_initializer_config": null, "conv_filters": null, "conv_activation": "relu", "conv_kernel_initializer": null, "conv_kernel_initializer_config": null, "conv_bias_initializer": null, "conv_bias_initializer_config": null, "conv_transpose_kernel_initializer": null, "conv_transpose_kernel_initializer_config": null, "conv_transpose_bias_initializer": null, "conv_transpose_bias_initializer_config": null, "post_fcnet_hiddens": [], "post_fcnet_activation": "relu", "post_fcnet_weights_initializer": null, "post_fcnet_weights_initializer_config": null, "post_fcnet_bias_initializer": null, "post_fcnet_bias_initializer_config": null, "free_log_std": false, "log_std_clip_param": 20.0, "no_final_linear": false, "vf_share_layers": false, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "lstm_weights_initializer": null, "lstm_weights_initializer_config": null, "lstm_bias_initializer": null, "lstm_bias_initializer_config": null, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "attention_use_n_prev_actions": 0, "attention_use_n_prev_rewards": 0, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": null, "custom_model_config": {}, "custom_action_dist": null, "custom_preprocessor": null, "encoder_latent_dim": null, "always_check_shapes": false, "lstm_use_prev_action_reward": -1, "_use_default_native_models": -1, "_disable_preprocessor_api": false, "_disable_action_flattening": false}, "_learner_connector": null, "add_default_connectors_to_learner_pipeline": true, "learner_config_dict": {}, "optimizer": {}, "_learner_class": null, "callbacks_on_algorithm_init": null, "callbacks_on_env_runners_recreated": null, "callbacks_on_offline_eval_runners_recreated": null, "callbacks_on_checkpoint_loaded": null, "callbacks_on_environment_created": null, "callbacks_on_episode_created": null, "callbacks_on_episode_start": null, "callbacks_on_episode_step": null, "callbacks_on_episode_end": null, "callbacks_on_evaluate_start": null, "callbacks_on_evaluate_end": null, "callbacks_on_evaluate_offline_start": null, "callbacks_on_evaluate_offline_end": null, "callbacks_on_sample_end": null, "callbacks_on_train_result": null, "explore": true, "enable_rl_module_and_learner": true, "enable_env_runner_and_connector_v2": true, "_prior_exploration_config": {"type": "StochasticSampling"}, "count_steps_by": "env_steps", "policy_map_capacity": 100, "policy_mapping_fn": "<function AlgorithmConfig.DEFAULT_POLICY_MAPPING_FN at 0x13e6b9b20>", "policies_to_train": null, "policy_states_are_swappable": false, "observation_fn": null, "offline_data_class": null, "input_read_method": "read_parquet", "input_read_method_kwargs": {}, "input_read_schema": {}, "input_read_episodes": false, "input_read_sample_batches": false, "input_read_batch_size": null, "input_filesystem": null, "input_filesystem_kwargs": {}, "input_compress_columns": ["obs", "new_obs"], "input_spaces_jsonable": true, "materialize_data": false, "materialize_mapped_data": true, "map_batches_kwargs": {}, "iter_batches_kwargs": {}, "ignore_final_observation": false, "prelearner_class": null, "prelearner_buffer_class": null, "prelearner_buffer_kwargs": {}, "prelearner_module_synch_period": 10, "dataset_num_iters_per_learner": null, "input_config": {}, "actions_in_input_normalized": false, "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_config": {}, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "output_max_rows_per_file": null, "output_write_remaining_data": false, "output_write_method": "write_parquet", "output_write_method_kwargs": {}, "output_filesystem": null, "output_filesystem_kwargs": {}, "output_write_episodes": true, "offline_sampling": false, "evaluation_interval": 1, "evaluation_duration": 20, "evaluation_duration_unit": "episodes", "evaluation_sample_timeout_s": 120.0, "evaluation_auto_duration_min_env_steps_per_sample": 100, "evaluation_auto_duration_max_env_steps_per_sample": 2000, "evaluation_parallel_to_training": false, "evaluation_force_reset_envs_before_iteration": true, "evaluation_config": null, "off_policy_estimation_methods": {}, "ope_split_batch_by_episode": true, "evaluation_num_env_runners": 1, "in_evaluation": false, "sync_filters_on_rollout_workers_timeout_s": 10.0, "offline_evaluation_interval": null, "num_offline_eval_runners": 0, "offline_loss_for_module_fn": null, "offline_evaluation_duration": 1, "offline_evaluation_parallel_to_training": false, "offline_evaluation_timeout_s": 120.0, "num_cpus_per_offline_eval_runner": 1, "num_gpus_per_offline_eval_runner": 0, "custom_resources_per_offline_eval_runner": {}, "restart_failed_offline_eval_runners": true, "ignore_offline_eval_runner_failures": false, "max_num_offline_eval_runner_restarts": 1000, "offline_eval_runner_restore_timeout_s": 1800.0, "max_requests_in_flight_per_offline_eval_runner": 1, "validate_offline_eval_runners_after_construction": true, "offline_eval_runner_health_probe_timeout_s": 30.0, "offline_eval_rl_module_inference_only": false, "broadcast_offline_eval_runner_states": false, "offline_eval_batch_size_per_runner": 256, "dataset_num_iters_per_eval_runner": 1, "keep_per_episode_custom_metrics": false, "metrics_episode_collection_timeout_s": 60.0, "metrics_num_episodes_for_smoothing": 100, "min_time_s_per_iteration": null, "min_train_timesteps_per_iteration": 0, "min_sample_timesteps_per_iteration": 0, "log_gradients": true, "export_native_model_files": false, "checkpoint_trainable_policies_only": false, "logger_creator": null, "logger_config": null, "log_level": "WARN", "log_sys_usage": true, "fake_sampler": false, "seed": 10, "restart_failed_env_runners": true, "ignore_env_runner_failures": false, "max_num_env_runner_restarts": 1000, "delay_between_env_runner_restarts_s": 60.0, "restart_failed_sub_environments": false, "num_consecutive_env_runner_failures_tolerance": 100, "env_runner_health_probe_timeout_s": 30.0, "env_runner_restore_timeout_s": 1800.0, "_model_config": {}, "_rl_module_spec": "RLModuleSpec(module_class=None, observation_space=None, action_space=None, inference_only=False, learner_only=False, model_config=DefaultModelConfig(fcnet_hiddens=[60, 90], fcnet_activation='tanh', fcnet_kernel_initializer=None, fcnet_kernel_initializer_kwargs=None, fcnet_bias_initializer=None, fcnet_bias_initializer_kwargs=None, conv_filters=None, conv_activation='relu', conv_kernel_initializer=None, conv_kernel_initializer_kwargs=None, conv_bias_initializer=None, conv_bias_initializer_kwargs=None, head_fcnet_hiddens=[], head_fcnet_activation='relu', head_fcnet_kernel_initializer=None, head_fcnet_kernel_initializer_kwargs=None, head_fcnet_bias_initializer=None, head_fcnet_bias_initializer_kwargs=None, free_log_std=False, log_std_clip_param=20.0, vf_share_layers=True, use_lstm=False, max_seq_len=20, lstm_cell_size=256, lstm_use_prev_action=False, lstm_use_prev_reward=False, lstm_kernel_initializer=None, lstm_kernel_initializer_kwargs=None, lstm_bias_initializer=None, lstm_bias_initializer_kwargs=None), catalog_class=None, load_state_path=None, model_config_dict=None)", "algorithm_config_overrides_per_module": {}, "_per_module_overrides": {}, "_validate_config": true, "_use_msgpack_checkpoints": false, "_torch_grad_scaler_class": null, "_torch_lr_scheduler_classes": null, "_tf_policy_handles_more_than_one_loss": false, "_disable_preprocessor_api": false, "_disable_action_flattening": false, "_disable_initialize_loss_from_dummy_batch": false, "_dont_auto_sync_env_runner_states": false, "env_task_fn": -1, "enable_connectors": -1, "simple_optimizer": false, "policy_map_cache": -1, "worker_cls": -1, "synchronize_filters": -1, "enable_async_evaluation": -1, "custom_async_evaluation_function": -1, "_enable_rl_module_api": -1, "auto_wrap_old_gym_envs": -1, "always_attach_evaluation_results": -1, "replay_sequence_length": null, "_disable_execution_plan_api": -1, "use_critic": true, "use_gae": true, "use_kl_loss": true, "kl_coeff": 0.7464963036515, "kl_target": 0.0270990929592, "vf_loss_coeff": 0.6688075857018, "entropy_coeff": 0.0090570820258, "clip_param": 0.1221781641624, "vf_clip_param": 0.1027808522125, "entropy_coeff_schedule": null, "lr_schedule": null, "sgd_minibatch_size": -1, "vf_share_layers": -1, "__stdout_file__": null, "__stderr_file__": null, "lambda": 0.9099046732075, "input": "sampler", "policies": {"default_policy": [null, null, null, null]}, "callbacks": "<class 'ray.rllib.callbacks.callbacks.RLlibCallback'>", "create_env_on_driver": false, "custom_eval_function": null, "framework": "torch"}, "time_since_restore": 26.44636344909668, "iterations_since_restore": 8, "perf": {"cpu_util_percent": 73.85000000000001, "ram_util_percent": 79.225}}
{"timers": {"training_iteration": 4.474013025106016, "restore_env_runners": 1.4123724589592617e-05, "training_step": 4.473664127497635, "env_runner_sampling_timer": 4.2742683831697095, "learner_update_timer": 0.190753840010008, "synch_weights": 0.0021953640611212114, "restore_eval_env_runners": 1.8088115494727365e-05, "evaluation_iteration": 0.20334017232079588, "synch_eval_env_connectors": 0.0002505700133138275, "synch_env_connectors": 4.583515070857997e-06}, "env_runners": {"weights_seq_no": 8.0, "env_to_module_connector": {"timers": {"connectors": {"add_states_from_episodes_to_batch": 2.5784976934074148e-06, "batch_individual_items": 1.1500606041267497e-05, "add_observations_from_episodes_to_batch": 4.949426863549309e-06, "add_time_dim_to_batch_and_zero_pad": 4.087336301541509e-06, "numpy_to_tensor": 1.680932142943799e-05}}, "connector_pipeline_timer": 7.357273419689696e-05}, "num_env_steps_sampled": 5000.0, "module_episode_returns_mean": {"default_policy": 2.379999999999999}, "sample": 0.00890225216861305, "num_module_steps_sampled": {"default_policy": 5000.0}, "num_episodes": 250.0, "module_to_env_connector": {"connector_pipeline_timer": 0.00019091497181380855, "timers": {"connectors": {"tensor_to_numpy": 2.417624154993838e-05, "get_actions": 7.99160940502926e-05, "un_batch_to_individual_items": 8.747558191066082e-06, "normalize_and_clip_actions": 1.584273234409351e-05, "listify_data_for_vector_env": 1.922517802781956e-05, "remove_single_ts_time_rank_from_batch": 9.603269523677233e-07}}}, "time_between_sampling": 0.0024663439588763305, "num_env_steps_sampled_lifetime": -4312500.0, "episode_return_mean": 2.379999999999999, "episode_return_min": -10.5, "agent_episode_returns_mean": {"default_agent": 2.379999999999999}, "episode_duration_sec_mean": 0.008234691387973727, "env_to_module_sum_episodes_length_out": 10.36823839457432, "episode_len_mean": 20.0, "env_reset_timer": 7.716846814771226e-05, "num_agent_steps_sampled_lifetime": {"default_agent": -4312500.0}, "num_episodes_lifetime": -215625.0, "episode_len_max": 20, "rlmodule_inference_timer": 5.3634243013733345e-05, "env_to_module_sum_episodes_length_in": 10.36823839457432, "num_agent_steps_sampled": {"default_agent": 5000.0}, "episode_return_max": 9.5, "episode_len_min": 20, "env_step_timer": 2.625838861238326e-05, "num_module_steps_sampled_lifetime": {"default_policy": -4312500.0}, "num_env_steps_sampled_lifetime_throughput": 2373.8518630919634}, "learners": {"__all_modules__": {"learner_connector": {"timers": {"connectors": {"add_time_dim_to_batch_and_zero_pad": 2.317872118886777e-05, "add_observations_from_episodes_to_batch": 0.0009168695690513726, "add_states_from_episodes_to_batch": 4.315771936014594e-06, "add_columns_from_episodes_to_train_batch": 0.049635920996260206, "batch_individual_items": 0.04922175013025761, "add_one_ts_to_episodes_and_truncate": 0.012019527128295826, "numpy_to_tensor": 0.00012419029477090716, "general_advantage_estimation": 0.00863567059383406}}, "connector_pipeline_timer": 0.12081860821964857}, "num_env_steps_trained_lifetime": 283500, "num_module_steps_trained": 6000, "num_trainable_parameters": 6003, "learner_connector_sum_episodes_length_in": 5000.0, "num_non_trainable_parameters": 0, "learner_connector_sum_episodes_length_out": 5250.0, "num_env_steps_trained": 31500, "num_module_steps_trained_lifetime": 54000, "num_env_steps_trained_lifetime_throughput": 964442.521537208, "num_module_steps_trained_throughput": 184066.6659010243, "num_module_steps_trained_lifetime_throughput": 183904.72599461174}, "default_policy": {"gradients_default_optimizer_global_norm": 0.05511411279439926, "entropy": 0.6498231291770935, "vf_explained_var": -0.010897278785705566, "mean_kl_loss": 0.000535716419108212, "num_module_steps_trained_lifetime": 54000, "vf_loss": 0.10278083384037018, "default_optimizer_learning_rate": 0.0002847858517, "curr_kl_coeff": 0.0014580006245523691, "module_train_batch_size_mean": 1000.0, "num_module_steps_trained": 6000, "num_trainable_parameters": 6003, "weights_seq_no": 9.0, "policy_loss": -0.08469157665967941, "diff_num_grad_updates_vs_sampler_policy": 1.0, "vf_loss_unclipped": 28.564573287963867, "curr_entropy_coeff": 0.0090570820258, "total_loss": -0.021834900602698326, "num_module_steps_trained_lifetime_throughput": 184205.57804085469}}, "num_training_step_calls_per_iteration": 1, "evaluation": {"env_runners": {"episode_len_min": 20, "episode_return_max": 13.5, "num_env_steps_sampled": 400, "sample": 0.18780875255091023, "env_to_module_connector": {"timers": {"connectors": {"add_observations_from_episodes_to_batch": 4.069366017673025e-06, "add_states_from_episodes_to_batch": 2.0311989089370907e-06, "batch_individual_items": 9.329082940013076e-06, "numpy_to_tensor": 1.3925726175569483e-05, "add_time_dim_to_batch_and_zero_pad": 3.4641778122955347e-06}}, "connector_pipeline_timer": 6.171935967686683e-05}, "num_episodes": 20, "num_env_steps_sampled_lifetime": 45400, "episode_len_max": 20, "module_to_env_connector": {"timers": {"connectors": {"tensor_to_numpy": 2.1537213704972295e-05, "get_actions": 7.060330176248142e-05, "un_batch_to_individual_items": 7.89376852631822e-06, "normalize_and_clip_actions": 1.2917169967476103e-05, "listify_data_for_vector_env": 1.536865676745278e-05, "remove_single_ts_time_rank_from_batch": 7.676263795825744e-07}}, "connector_pipeline_timer": 0.00016595433046613967}, "episode_return_min": -14.5, "env_to_module_sum_episodes_length_out": 10.368238394574323, "num_agent_steps_sampled": {"default_agent": 400}, "module_episode_returns_mean": {"default_policy": 0.85}, "rlmodule_inference_timer": 4.4640599216826284e-05, "env_to_module_sum_episodes_length_in": 10.368238394574323, "env_step_timer": 2.325160254579269e-05, "num_agent_steps_sampled_lifetime": {"default_agent": 3600}, "episode_len_mean": 20.0, "env_reset_timer": 0.0006894748223673046, "num_module_steps_sampled_lifetime": {"default_policy": 3600}, "num_episodes_lifetime": 180, "num_module_steps_sampled": {"default_policy": 400}, "agent_episode_returns_mean": {"default_agent": 0.85}, "weights_seq_no": 9.0, "episode_return_mean": 0.85, "episode_duration_sec_mean": 0.007470025814836845, "time_between_sampling": 2.9268899583469787}, "num_healthy_workers": 1, "actor_manager_num_outstanding_async_reqs": 0, "num_remote_worker_restarts": 0}, "num_env_steps_sampled_lifetime": -4312500.0, "fault_tolerance": {"num_healthy_workers": 0, "num_remote_worker_restarts": 0}, "env_runner_group": {"actor_manager_num_outstanding_async_reqs": 0}, "done": false, "training_iteration": 9, "trial_id": "49ef3_00000", "date": "2025-08-11_19-30-59", "timestamp": 1754933459, "time_this_iter_s": 2.9506070613861084, "time_total_s": 29.396970510482788, "pid": 23180, "hostname": "Mac", "node_ip": "127.0.0.1", "config": {"exploration_config": {}, "extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "placement_strategy": "PACK", "num_gpus": 0, "_fake_gpus": false, "num_cpus_for_main_process": 2, "eager_tracing": true, "eager_max_retraces": 20, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "torch_compile_learner": false, "torch_compile_learner_what_to_compile": "forward_train", "torch_compile_learner_dynamo_backend": "aot_eager", "torch_compile_learner_dynamo_mode": null, "torch_compile_worker": false, "torch_compile_worker_dynamo_backend": "aot_eager", "torch_compile_worker_dynamo_mode": null, "torch_ddp_kwargs": {}, "torch_skip_nan_gradients": false, "env": "Umbrella", "env_config": {}, "observation_space": null, "action_space": null, "clip_rewards": null, "normalize_actions": true, "clip_actions": false, "_is_atari": null, "disable_env_checking": false, "render_env": false, "action_mask_key": "action_mask", "env_runner_cls": null, "num_env_runners": 0, "create_local_env_runner": true, "num_envs_per_env_runner": 1, "gym_env_vectorize_mode": "SYNC", "num_cpus_per_env_runner": 1, "num_gpus_per_env_runner": 0, "custom_resources_per_env_runner": {}, "validate_env_runners_after_construction": true, "episodes_to_numpy": true, "max_requests_in_flight_per_env_runner": 1, "sample_timeout_s": 60.0, "_env_to_module_connector": null, "add_default_connectors_to_env_to_module_pipeline": true, "_module_to_env_connector": null, "add_default_connectors_to_module_to_env_pipeline": true, "merge_env_runner_states": "training_only", "broadcast_env_runner_states": true, "episode_lookback_horizon": 1, "rollout_fragment_length": "auto", "batch_mode": "complete_episodes", "compress_observations": false, "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "enable_tf1_exec_eagerly": false, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "preprocessor_pref": "deepmind", "observation_filter": "NoFilter", "update_worker_filter_stats": true, "use_worker_filter_stats": true, "sampler_perf_stats_ema_coef": null, "_is_online": true, "num_learners": 0, "num_gpus_per_learner": 0, "num_cpus_per_learner": "auto", "num_aggregator_actors_per_learner": 0, "max_requests_in_flight_per_aggregator_actor": 3, "local_gpu_idx": 0, "max_requests_in_flight_per_learner": 3, "gamma": 1, "lr": 0.0002847858517, "grad_clip": 0.5, "grad_clip_by": "global_norm", "_train_batch_size_per_learner": 5000, "train_batch_size": 4000, "num_epochs": 1, "minibatch_size": 1000, "shuffle_batch_per_epoch": true, "model": {"fcnet_hiddens": [256, 256], "fcnet_activation": "tanh", "fcnet_weights_initializer": null, "fcnet_weights_initializer_config": null, "fcnet_bias_initializer": null, "fcnet_bias_initializer_config": null, "conv_filters": null, "conv_activation": "relu", "conv_kernel_initializer": null, "conv_kernel_initializer_config": null, "conv_bias_initializer": null, "conv_bias_initializer_config": null, "conv_transpose_kernel_initializer": null, "conv_transpose_kernel_initializer_config": null, "conv_transpose_bias_initializer": null, "conv_transpose_bias_initializer_config": null, "post_fcnet_hiddens": [], "post_fcnet_activation": "relu", "post_fcnet_weights_initializer": null, "post_fcnet_weights_initializer_config": null, "post_fcnet_bias_initializer": null, "post_fcnet_bias_initializer_config": null, "free_log_std": false, "log_std_clip_param": 20.0, "no_final_linear": false, "vf_share_layers": false, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "lstm_weights_initializer": null, "lstm_weights_initializer_config": null, "lstm_bias_initializer": null, "lstm_bias_initializer_config": null, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "attention_use_n_prev_actions": 0, "attention_use_n_prev_rewards": 0, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": null, "custom_model_config": {}, "custom_action_dist": null, "custom_preprocessor": null, "encoder_latent_dim": null, "always_check_shapes": false, "lstm_use_prev_action_reward": -1, "_use_default_native_models": -1, "_disable_preprocessor_api": false, "_disable_action_flattening": false}, "_learner_connector": null, "add_default_connectors_to_learner_pipeline": true, "learner_config_dict": {}, "optimizer": {}, "_learner_class": null, "callbacks_on_algorithm_init": null, "callbacks_on_env_runners_recreated": null, "callbacks_on_offline_eval_runners_recreated": null, "callbacks_on_checkpoint_loaded": null, "callbacks_on_environment_created": null, "callbacks_on_episode_created": null, "callbacks_on_episode_start": null, "callbacks_on_episode_step": null, "callbacks_on_episode_end": null, "callbacks_on_evaluate_start": null, "callbacks_on_evaluate_end": null, "callbacks_on_evaluate_offline_start": null, "callbacks_on_evaluate_offline_end": null, "callbacks_on_sample_end": null, "callbacks_on_train_result": null, "explore": true, "enable_rl_module_and_learner": true, "enable_env_runner_and_connector_v2": true, "_prior_exploration_config": {"type": "StochasticSampling"}, "count_steps_by": "env_steps", "policy_map_capacity": 100, "policy_mapping_fn": "<function AlgorithmConfig.DEFAULT_POLICY_MAPPING_FN at 0x13e6b9b20>", "policies_to_train": null, "policy_states_are_swappable": false, "observation_fn": null, "offline_data_class": null, "input_read_method": "read_parquet", "input_read_method_kwargs": {}, "input_read_schema": {}, "input_read_episodes": false, "input_read_sample_batches": false, "input_read_batch_size": null, "input_filesystem": null, "input_filesystem_kwargs": {}, "input_compress_columns": ["obs", "new_obs"], "input_spaces_jsonable": true, "materialize_data": false, "materialize_mapped_data": true, "map_batches_kwargs": {}, "iter_batches_kwargs": {}, "ignore_final_observation": false, "prelearner_class": null, "prelearner_buffer_class": null, "prelearner_buffer_kwargs": {}, "prelearner_module_synch_period": 10, "dataset_num_iters_per_learner": null, "input_config": {}, "actions_in_input_normalized": false, "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_config": {}, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "output_max_rows_per_file": null, "output_write_remaining_data": false, "output_write_method": "write_parquet", "output_write_method_kwargs": {}, "output_filesystem": null, "output_filesystem_kwargs": {}, "output_write_episodes": true, "offline_sampling": false, "evaluation_interval": 1, "evaluation_duration": 20, "evaluation_duration_unit": "episodes", "evaluation_sample_timeout_s": 120.0, "evaluation_auto_duration_min_env_steps_per_sample": 100, "evaluation_auto_duration_max_env_steps_per_sample": 2000, "evaluation_parallel_to_training": false, "evaluation_force_reset_envs_before_iteration": true, "evaluation_config": null, "off_policy_estimation_methods": {}, "ope_split_batch_by_episode": true, "evaluation_num_env_runners": 1, "in_evaluation": false, "sync_filters_on_rollout_workers_timeout_s": 10.0, "offline_evaluation_interval": null, "num_offline_eval_runners": 0, "offline_loss_for_module_fn": null, "offline_evaluation_duration": 1, "offline_evaluation_parallel_to_training": false, "offline_evaluation_timeout_s": 120.0, "num_cpus_per_offline_eval_runner": 1, "num_gpus_per_offline_eval_runner": 0, "custom_resources_per_offline_eval_runner": {}, "restart_failed_offline_eval_runners": true, "ignore_offline_eval_runner_failures": false, "max_num_offline_eval_runner_restarts": 1000, "offline_eval_runner_restore_timeout_s": 1800.0, "max_requests_in_flight_per_offline_eval_runner": 1, "validate_offline_eval_runners_after_construction": true, "offline_eval_runner_health_probe_timeout_s": 30.0, "offline_eval_rl_module_inference_only": false, "broadcast_offline_eval_runner_states": false, "offline_eval_batch_size_per_runner": 256, "dataset_num_iters_per_eval_runner": 1, "keep_per_episode_custom_metrics": false, "metrics_episode_collection_timeout_s": 60.0, "metrics_num_episodes_for_smoothing": 100, "min_time_s_per_iteration": null, "min_train_timesteps_per_iteration": 0, "min_sample_timesteps_per_iteration": 0, "log_gradients": true, "export_native_model_files": false, "checkpoint_trainable_policies_only": false, "logger_creator": null, "logger_config": null, "log_level": "WARN", "log_sys_usage": true, "fake_sampler": false, "seed": 10, "restart_failed_env_runners": true, "ignore_env_runner_failures": false, "max_num_env_runner_restarts": 1000, "delay_between_env_runner_restarts_s": 60.0, "restart_failed_sub_environments": false, "num_consecutive_env_runner_failures_tolerance": 100, "env_runner_health_probe_timeout_s": 30.0, "env_runner_restore_timeout_s": 1800.0, "_model_config": {}, "_rl_module_spec": "RLModuleSpec(module_class=None, observation_space=None, action_space=None, inference_only=False, learner_only=False, model_config=DefaultModelConfig(fcnet_hiddens=[60, 90], fcnet_activation='tanh', fcnet_kernel_initializer=None, fcnet_kernel_initializer_kwargs=None, fcnet_bias_initializer=None, fcnet_bias_initializer_kwargs=None, conv_filters=None, conv_activation='relu', conv_kernel_initializer=None, conv_kernel_initializer_kwargs=None, conv_bias_initializer=None, conv_bias_initializer_kwargs=None, head_fcnet_hiddens=[], head_fcnet_activation='relu', head_fcnet_kernel_initializer=None, head_fcnet_kernel_initializer_kwargs=None, head_fcnet_bias_initializer=None, head_fcnet_bias_initializer_kwargs=None, free_log_std=False, log_std_clip_param=20.0, vf_share_layers=True, use_lstm=False, max_seq_len=20, lstm_cell_size=256, lstm_use_prev_action=False, lstm_use_prev_reward=False, lstm_kernel_initializer=None, lstm_kernel_initializer_kwargs=None, lstm_bias_initializer=None, lstm_bias_initializer_kwargs=None), catalog_class=None, load_state_path=None, model_config_dict=None)", "algorithm_config_overrides_per_module": {}, "_per_module_overrides": {}, "_validate_config": true, "_use_msgpack_checkpoints": false, "_torch_grad_scaler_class": null, "_torch_lr_scheduler_classes": null, "_tf_policy_handles_more_than_one_loss": false, "_disable_preprocessor_api": false, "_disable_action_flattening": false, "_disable_initialize_loss_from_dummy_batch": false, "_dont_auto_sync_env_runner_states": false, "env_task_fn": -1, "enable_connectors": -1, "simple_optimizer": false, "policy_map_cache": -1, "worker_cls": -1, "synchronize_filters": -1, "enable_async_evaluation": -1, "custom_async_evaluation_function": -1, "_enable_rl_module_api": -1, "auto_wrap_old_gym_envs": -1, "always_attach_evaluation_results": -1, "replay_sequence_length": null, "_disable_execution_plan_api": -1, "use_critic": true, "use_gae": true, "use_kl_loss": true, "kl_coeff": 0.7464963036515, "kl_target": 0.0270990929592, "vf_loss_coeff": 0.6688075857018, "entropy_coeff": 0.0090570820258, "clip_param": 0.1221781641624, "vf_clip_param": 0.1027808522125, "entropy_coeff_schedule": null, "lr_schedule": null, "sgd_minibatch_size": -1, "vf_share_layers": -1, "__stdout_file__": null, "__stderr_file__": null, "lambda": 0.9099046732075, "input": "sampler", "policies": {"default_policy": [null, null, null, null]}, "callbacks": "<class 'ray.rllib.callbacks.callbacks.RLlibCallback'>", "create_env_on_driver": false, "custom_eval_function": null, "framework": "torch"}, "time_since_restore": 29.396970510482788, "iterations_since_restore": 9, "perf": {"cpu_util_percent": 72.6, "ram_util_percent": 79.3}}
{"timers": {"training_iteration": 4.457903911104957, "restore_env_runners": 1.411957686252687e-05, "training_step": 4.457555805392752, "env_runner_sampling_timer": 4.257151350177659, "learner_update_timer": 0.19180501702942576, "synch_weights": 0.002180839999782866, "restore_eval_env_runners": 1.7988484085342762e-05, "evaluation_iteration": 0.2030658343469292, "synch_eval_env_connectors": 0.0002493534731715363, "synch_env_connectors": 4.582679098648401e-06}, "env_runners": {"weights_seq_no": 9.0, "env_to_module_connector": {"timers": {"connectors": {"add_states_from_episodes_to_batch": 2.586754839780549e-06, "batch_individual_items": 1.1770799442684555e-05, "add_observations_from_episodes_to_batch": 5.374331757784219e-06, "add_time_dim_to_batch_and_zero_pad": 4.0248832881020486e-06, "numpy_to_tensor": 1.7491294960212087e-05}}, "connector_pipeline_timer": 7.626419622643319e-05}, "num_env_steps_sampled": 5000.0, "module_episode_returns_mean": {"default_policy": 2.460000000000001}, "sample": 0.008993622078876492, "num_module_steps_sampled": {"default_policy": 5000.0}, "num_episodes": 250.0, "module_to_env_connector": {"connector_pipeline_timer": 0.00019854222628900716, "timers": {"connectors": {"tensor_to_numpy": 2.4966215601211046e-05, "get_actions": 8.399321335634505e-05, "un_batch_to_individual_items": 9.862357335437737e-06, "normalize_and_clip_actions": 1.6207948309952682e-05, "listify_data_for_vector_env": 1.9655738621924156e-05, "remove_single_ts_time_rank_from_batch": 1.0484293975723016e-06}}}, "time_between_sampling": 0.0030279874588181777, "num_env_steps_sampled_lifetime": -4930000.0, "episode_return_mean": 2.460000000000001, "episode_return_min": -10.5, "agent_episode_returns_mean": {"default_agent": 2.460000000000001}, "episode_duration_sec_mean": 0.008579510662239043, "env_to_module_sum_episodes_length_out": 10.36823839457432, "episode_len_mean": 20.0, "env_reset_timer": 7.999909461225372e-05, "num_agent_steps_sampled_lifetime": {"default_agent": -4930000.0}, "num_episodes_lifetime": -246500.0, "episode_len_max": 20, "rlmodule_inference_timer": 5.5225923202776935e-05, "env_to_module_sum_episodes_length_in": 10.36823839457432, "num_agent_steps_sampled": {"default_agent": 5000.0}, "episode_return_max": 9.5, "episode_len_min": 20, "env_step_timer": 2.7080590000386964e-05, "num_module_steps_sampled_lifetime": {"default_policy": -4930000.0}, "num_env_steps_sampled_lifetime_throughput": 2291.6811584814386}, "learners": {"__all_modules__": {"learner_connector": {"timers": {"connectors": {"add_time_dim_to_batch_and_zero_pad": 2.3130683920950726e-05, "add_observations_from_episodes_to_batch": 0.0009187133728143588, "add_states_from_episodes_to_batch": 4.34344479091361e-06, "add_columns_from_episodes_to_train_batch": 0.0499181022068764, "batch_individual_items": 0.05052062970835873, "add_one_ts_to_episodes_and_truncate": 0.012026053107139006, "numpy_to_tensor": 0.0001237046420519309, "general_advantage_estimation": 0.008603724727116228}}, "connector_pipeline_timer": 0.12237502505679408}, "num_env_steps_trained_lifetime": 315000, "num_module_steps_trained": 6000, "num_trainable_parameters": 6003, "learner_connector_sum_episodes_length_in": 5000.0, "num_non_trainable_parameters": 0, "learner_connector_sum_episodes_length_out": 5250.0, "num_env_steps_trained": 31500, "num_module_steps_trained_lifetime": 60000, "num_env_steps_trained_lifetime_throughput": 986763.6592278013, "num_module_steps_trained_throughput": 188303.70412904216, "num_module_steps_trained_lifetime_throughput": 188146.60636848214}, "default_policy": {"gradients_default_optimizer_global_norm": 0.012517706491053104, "entropy": 0.6338445544242859, "vf_explained_var": -0.010891318321228027, "mean_kl_loss": 0.0009032915695570409, "num_module_steps_trained_lifetime": 60000, "vf_loss": 0.10278083384037018, "default_optimizer_learning_rate": 0.0002847858517, "curr_kl_coeff": 0.0007290003122761846, "module_train_batch_size_mean": 1000.0, "num_module_steps_trained": 6000, "num_trainable_parameters": 6003, "weights_seq_no": 10.0, "policy_loss": -0.15532250702381134, "diff_num_grad_updates_vs_sampler_policy": 1.0, "vf_loss_unclipped": 28.557741165161133, "curr_entropy_coeff": 0.0090570820258, "total_loss": -0.09232137352228165, "num_module_steps_trained_lifetime_throughput": 188416.00215370013}}, "num_training_step_calls_per_iteration": 1, "evaluation": {"env_runners": {"episode_len_min": 20, "episode_return_max": 13.5, "num_env_steps_sampled": 400, "sample": 0.18770901127546766, "env_to_module_connector": {"timers": {"connectors": {"add_observations_from_episodes_to_batch": 4.221461140932546e-06, "add_states_from_episodes_to_batch": 2.0817692326342522e-06, "batch_individual_items": 8.613273536758194e-06, "numpy_to_tensor": 1.2505255526917115e-05, "add_time_dim_to_batch_and_zero_pad": 2.9999136815850883e-06}}, "connector_pipeline_timer": 5.848314770334574e-05}, "num_episodes": 20, "num_env_steps_sampled_lifetime": 50400, "episode_len_max": 20, "module_to_env_connector": {"timers": {"connectors": {"tensor_to_numpy": 1.8594936191854252e-05, "get_actions": 5.842065511828638e-05, "un_batch_to_individual_items": 7.676141942929223e-06, "normalize_and_clip_actions": 1.3230092343009867e-05, "listify_data_for_vector_env": 1.614670759738122e-05, "remove_single_ts_time_rank_from_batch": 8.20556494339394e-07}}, "connector_pipeline_timer": 0.0001498165112840461}, "episode_return_min": -14.5, "env_to_module_sum_episodes_length_out": 10.368238394574323, "num_agent_steps_sampled": {"default_agent": 400}, "module_episode_returns_mean": {"default_policy": 0.85}, "rlmodule_inference_timer": 4.069243400103455e-05, "env_to_module_sum_episodes_length_in": 10.368238394574323, "env_step_timer": 2.1181163560900246e-05, "num_agent_steps_sampled_lifetime": {"default_agent": 4000}, "episode_len_mean": 20.0, "env_reset_timer": 0.0006834500737833215, "num_module_steps_sampled_lifetime": {"default_policy": 4000}, "num_episodes_lifetime": 200, "num_module_steps_sampled": {"default_policy": 400}, "agent_episode_returns_mean": {"default_agent": 0.85}, "weights_seq_no": 10.0, "episode_return_mean": 0.85, "episode_duration_sec_mean": 0.007846629589330405, "time_between_sampling": 2.9264746891730846}, "num_healthy_workers": 1, "actor_manager_num_outstanding_async_reqs": 0, "num_remote_worker_restarts": 0}, "num_env_steps_sampled_lifetime": -4930000.0, "fault_tolerance": {"num_healthy_workers": 0, "num_remote_worker_restarts": 0}, "env_runner_group": {"actor_manager_num_outstanding_async_reqs": 0}, "done": false, "training_iteration": 10, "trial_id": "49ef3_00000", "date": "2025-08-11_19-31-02", "timestamp": 1754933462, "time_this_iter_s": 3.0542197227478027, "time_total_s": 32.45119023323059, "pid": 23180, "hostname": "Mac", "node_ip": "127.0.0.1", "config": {"exploration_config": {}, "extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "placement_strategy": "PACK", "num_gpus": 0, "_fake_gpus": false, "num_cpus_for_main_process": 2, "eager_tracing": true, "eager_max_retraces": 20, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "torch_compile_learner": false, "torch_compile_learner_what_to_compile": "forward_train", "torch_compile_learner_dynamo_backend": "aot_eager", "torch_compile_learner_dynamo_mode": null, "torch_compile_worker": false, "torch_compile_worker_dynamo_backend": "aot_eager", "torch_compile_worker_dynamo_mode": null, "torch_ddp_kwargs": {}, "torch_skip_nan_gradients": false, "env": "Umbrella", "env_config": {}, "observation_space": null, "action_space": null, "clip_rewards": null, "normalize_actions": true, "clip_actions": false, "_is_atari": null, "disable_env_checking": false, "render_env": false, "action_mask_key": "action_mask", "env_runner_cls": null, "num_env_runners": 0, "create_local_env_runner": true, "num_envs_per_env_runner": 1, "gym_env_vectorize_mode": "SYNC", "num_cpus_per_env_runner": 1, "num_gpus_per_env_runner": 0, "custom_resources_per_env_runner": {}, "validate_env_runners_after_construction": true, "episodes_to_numpy": true, "max_requests_in_flight_per_env_runner": 1, "sample_timeout_s": 60.0, "_env_to_module_connector": null, "add_default_connectors_to_env_to_module_pipeline": true, "_module_to_env_connector": null, "add_default_connectors_to_module_to_env_pipeline": true, "merge_env_runner_states": "training_only", "broadcast_env_runner_states": true, "episode_lookback_horizon": 1, "rollout_fragment_length": "auto", "batch_mode": "complete_episodes", "compress_observations": false, "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "enable_tf1_exec_eagerly": false, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "preprocessor_pref": "deepmind", "observation_filter": "NoFilter", "update_worker_filter_stats": true, "use_worker_filter_stats": true, "sampler_perf_stats_ema_coef": null, "_is_online": true, "num_learners": 0, "num_gpus_per_learner": 0, "num_cpus_per_learner": "auto", "num_aggregator_actors_per_learner": 0, "max_requests_in_flight_per_aggregator_actor": 3, "local_gpu_idx": 0, "max_requests_in_flight_per_learner": 3, "gamma": 1, "lr": 0.0002847858517, "grad_clip": 0.5, "grad_clip_by": "global_norm", "_train_batch_size_per_learner": 5000, "train_batch_size": 4000, "num_epochs": 1, "minibatch_size": 1000, "shuffle_batch_per_epoch": true, "model": {"fcnet_hiddens": [256, 256], "fcnet_activation": "tanh", "fcnet_weights_initializer": null, "fcnet_weights_initializer_config": null, "fcnet_bias_initializer": null, "fcnet_bias_initializer_config": null, "conv_filters": null, "conv_activation": "relu", "conv_kernel_initializer": null, "conv_kernel_initializer_config": null, "conv_bias_initializer": null, "conv_bias_initializer_config": null, "conv_transpose_kernel_initializer": null, "conv_transpose_kernel_initializer_config": null, "conv_transpose_bias_initializer": null, "conv_transpose_bias_initializer_config": null, "post_fcnet_hiddens": [], "post_fcnet_activation": "relu", "post_fcnet_weights_initializer": null, "post_fcnet_weights_initializer_config": null, "post_fcnet_bias_initializer": null, "post_fcnet_bias_initializer_config": null, "free_log_std": false, "log_std_clip_param": 20.0, "no_final_linear": false, "vf_share_layers": false, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "lstm_weights_initializer": null, "lstm_weights_initializer_config": null, "lstm_bias_initializer": null, "lstm_bias_initializer_config": null, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "attention_use_n_prev_actions": 0, "attention_use_n_prev_rewards": 0, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": null, "custom_model_config": {}, "custom_action_dist": null, "custom_preprocessor": null, "encoder_latent_dim": null, "always_check_shapes": false, "lstm_use_prev_action_reward": -1, "_use_default_native_models": -1, "_disable_preprocessor_api": false, "_disable_action_flattening": false}, "_learner_connector": null, "add_default_connectors_to_learner_pipeline": true, "learner_config_dict": {}, "optimizer": {}, "_learner_class": null, "callbacks_on_algorithm_init": null, "callbacks_on_env_runners_recreated": null, "callbacks_on_offline_eval_runners_recreated": null, "callbacks_on_checkpoint_loaded": null, "callbacks_on_environment_created": null, "callbacks_on_episode_created": null, "callbacks_on_episode_start": null, "callbacks_on_episode_step": null, "callbacks_on_episode_end": null, "callbacks_on_evaluate_start": null, "callbacks_on_evaluate_end": null, "callbacks_on_evaluate_offline_start": null, "callbacks_on_evaluate_offline_end": null, "callbacks_on_sample_end": null, "callbacks_on_train_result": null, "explore": true, "enable_rl_module_and_learner": true, "enable_env_runner_and_connector_v2": true, "_prior_exploration_config": {"type": "StochasticSampling"}, "count_steps_by": "env_steps", "policy_map_capacity": 100, "policy_mapping_fn": "<function AlgorithmConfig.DEFAULT_POLICY_MAPPING_FN at 0x13e6b9b20>", "policies_to_train": null, "policy_states_are_swappable": false, "observation_fn": null, "offline_data_class": null, "input_read_method": "read_parquet", "input_read_method_kwargs": {}, "input_read_schema": {}, "input_read_episodes": false, "input_read_sample_batches": false, "input_read_batch_size": null, "input_filesystem": null, "input_filesystem_kwargs": {}, "input_compress_columns": ["obs", "new_obs"], "input_spaces_jsonable": true, "materialize_data": false, "materialize_mapped_data": true, "map_batches_kwargs": {}, "iter_batches_kwargs": {}, "ignore_final_observation": false, "prelearner_class": null, "prelearner_buffer_class": null, "prelearner_buffer_kwargs": {}, "prelearner_module_synch_period": 10, "dataset_num_iters_per_learner": null, "input_config": {}, "actions_in_input_normalized": false, "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_config": {}, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "output_max_rows_per_file": null, "output_write_remaining_data": false, "output_write_method": "write_parquet", "output_write_method_kwargs": {}, "output_filesystem": null, "output_filesystem_kwargs": {}, "output_write_episodes": true, "offline_sampling": false, "evaluation_interval": 1, "evaluation_duration": 20, "evaluation_duration_unit": "episodes", "evaluation_sample_timeout_s": 120.0, "evaluation_auto_duration_min_env_steps_per_sample": 100, "evaluation_auto_duration_max_env_steps_per_sample": 2000, "evaluation_parallel_to_training": false, "evaluation_force_reset_envs_before_iteration": true, "evaluation_config": null, "off_policy_estimation_methods": {}, "ope_split_batch_by_episode": true, "evaluation_num_env_runners": 1, "in_evaluation": false, "sync_filters_on_rollout_workers_timeout_s": 10.0, "offline_evaluation_interval": null, "num_offline_eval_runners": 0, "offline_loss_for_module_fn": null, "offline_evaluation_duration": 1, "offline_evaluation_parallel_to_training": false, "offline_evaluation_timeout_s": 120.0, "num_cpus_per_offline_eval_runner": 1, "num_gpus_per_offline_eval_runner": 0, "custom_resources_per_offline_eval_runner": {}, "restart_failed_offline_eval_runners": true, "ignore_offline_eval_runner_failures": false, "max_num_offline_eval_runner_restarts": 1000, "offline_eval_runner_restore_timeout_s": 1800.0, "max_requests_in_flight_per_offline_eval_runner": 1, "validate_offline_eval_runners_after_construction": true, "offline_eval_runner_health_probe_timeout_s": 30.0, "offline_eval_rl_module_inference_only": false, "broadcast_offline_eval_runner_states": false, "offline_eval_batch_size_per_runner": 256, "dataset_num_iters_per_eval_runner": 1, "keep_per_episode_custom_metrics": false, "metrics_episode_collection_timeout_s": 60.0, "metrics_num_episodes_for_smoothing": 100, "min_time_s_per_iteration": null, "min_train_timesteps_per_iteration": 0, "min_sample_timesteps_per_iteration": 0, "log_gradients": true, "export_native_model_files": false, "checkpoint_trainable_policies_only": false, "logger_creator": null, "logger_config": null, "log_level": "WARN", "log_sys_usage": true, "fake_sampler": false, "seed": 10, "restart_failed_env_runners": true, "ignore_env_runner_failures": false, "max_num_env_runner_restarts": 1000, "delay_between_env_runner_restarts_s": 60.0, "restart_failed_sub_environments": false, "num_consecutive_env_runner_failures_tolerance": 100, "env_runner_health_probe_timeout_s": 30.0, "env_runner_restore_timeout_s": 1800.0, "_model_config": {}, "_rl_module_spec": "RLModuleSpec(module_class=None, observation_space=None, action_space=None, inference_only=False, learner_only=False, model_config=DefaultModelConfig(fcnet_hiddens=[60, 90], fcnet_activation='tanh', fcnet_kernel_initializer=None, fcnet_kernel_initializer_kwargs=None, fcnet_bias_initializer=None, fcnet_bias_initializer_kwargs=None, conv_filters=None, conv_activation='relu', conv_kernel_initializer=None, conv_kernel_initializer_kwargs=None, conv_bias_initializer=None, conv_bias_initializer_kwargs=None, head_fcnet_hiddens=[], head_fcnet_activation='relu', head_fcnet_kernel_initializer=None, head_fcnet_kernel_initializer_kwargs=None, head_fcnet_bias_initializer=None, head_fcnet_bias_initializer_kwargs=None, free_log_std=False, log_std_clip_param=20.0, vf_share_layers=True, use_lstm=False, max_seq_len=20, lstm_cell_size=256, lstm_use_prev_action=False, lstm_use_prev_reward=False, lstm_kernel_initializer=None, lstm_kernel_initializer_kwargs=None, lstm_bias_initializer=None, lstm_bias_initializer_kwargs=None), catalog_class=None, load_state_path=None, model_config_dict=None)", "algorithm_config_overrides_per_module": {}, "_per_module_overrides": {}, "_validate_config": true, "_use_msgpack_checkpoints": false, "_torch_grad_scaler_class": null, "_torch_lr_scheduler_classes": null, "_tf_policy_handles_more_than_one_loss": false, "_disable_preprocessor_api": false, "_disable_action_flattening": false, "_disable_initialize_loss_from_dummy_batch": false, "_dont_auto_sync_env_runner_states": false, "env_task_fn": -1, "enable_connectors": -1, "simple_optimizer": false, "policy_map_cache": -1, "worker_cls": -1, "synchronize_filters": -1, "enable_async_evaluation": -1, "custom_async_evaluation_function": -1, "_enable_rl_module_api": -1, "auto_wrap_old_gym_envs": -1, "always_attach_evaluation_results": -1, "replay_sequence_length": null, "_disable_execution_plan_api": -1, "use_critic": true, "use_gae": true, "use_kl_loss": true, "kl_coeff": 0.7464963036515, "kl_target": 0.0270990929592, "vf_loss_coeff": 0.6688075857018, "entropy_coeff": 0.0090570820258, "clip_param": 0.1221781641624, "vf_clip_param": 0.1027808522125, "entropy_coeff_schedule": null, "lr_schedule": null, "sgd_minibatch_size": -1, "vf_share_layers": -1, "__stdout_file__": null, "__stderr_file__": null, "lambda": 0.9099046732075, "input": "sampler", "policies": {"default_policy": [null, null, null, null]}, "callbacks": "<class 'ray.rllib.callbacks.callbacks.RLlibCallback'>", "create_env_on_driver": false, "custom_eval_function": null, "framework": "torch"}, "time_since_restore": 32.45119023323059, "iterations_since_restore": 10, "perf": {"cpu_util_percent": 57.25, "ram_util_percent": 79.375}}
{"timers": {"training_iteration": 4.439314953663205, "restore_env_runners": 1.4039630687174407e-05, "training_step": 4.438967628589422, "env_runner_sampling_timer": 4.238894360835881, "learner_update_timer": 0.19148080810941887, "synch_weights": 0.0021719682698853535, "restore_eval_env_runners": 1.7891939809232022e-05, "evaluation_iteration": 0.20290655559288903, "synch_eval_env_connectors": 0.00025100951834851977, "synch_env_connectors": 4.61851183515742e-06}, "env_runners": {"weights_seq_no": 10.0, "env_to_module_connector": {"timers": {"connectors": {"add_states_from_episodes_to_batch": 2.541512883671134e-06, "batch_individual_items": 1.144762841055816e-05, "add_observations_from_episodes_to_batch": 4.882279258770424e-06, "add_time_dim_to_batch_and_zero_pad": 3.81496483754982e-06, "numpy_to_tensor": 1.653920583640827e-05}}, "connector_pipeline_timer": 7.274941707447378e-05}, "num_env_steps_sampled": 5000.0, "module_episode_returns_mean": {"default_policy": 2.8600000000000008}, "sample": 0.008820729235682574, "num_module_steps_sampled": {"default_policy": 5000.0}, "num_episodes": 250.0, "module_to_env_connector": {"connector_pipeline_timer": 0.00018834598772351658, "timers": {"connectors": {"tensor_to_numpy": 2.3369879379254493e-05, "get_actions": 7.963665159229227e-05, "un_batch_to_individual_items": 9.148411055465898e-06, "normalize_and_clip_actions": 1.5233744628320678e-05, "listify_data_for_vector_env": 1.8718717667648107e-05, "remove_single_ts_time_rank_from_batch": 9.785247909736802e-07}}}, "time_between_sampling": 0.0030270316621262157, "num_env_steps_sampled_lifetime": -5547500.0, "episode_return_mean": 2.8600000000000008, "episode_return_min": -10.5, "agent_episode_returns_mean": {"default_agent": 2.8600000000000008}, "episode_duration_sec_mean": 0.008149582490324974, "env_to_module_sum_episodes_length_out": 10.36823839457432, "episode_len_mean": 20.0, "env_reset_timer": 7.826966964040902e-05, "num_agent_steps_sampled_lifetime": {"default_agent": -5547500.0}, "num_episodes_lifetime": -277375.0, "episode_len_max": 20, "rlmodule_inference_timer": 5.295942101854277e-05, "env_to_module_sum_episodes_length_in": 10.36823839457432, "num_agent_steps_sampled": {"default_agent": 5000.0}, "episode_return_max": 9.5, "episode_len_min": 20, "env_step_timer": 2.5575617285197226e-05, "num_module_steps_sampled_lifetime": {"default_policy": -5547500.0}, "num_env_steps_sampled_lifetime_throughput": 2375.0674198427337}, "learners": {"__all_modules__": {"learner_connector": {"timers": {"connectors": {"add_time_dim_to_batch_and_zero_pad": 2.3042716939200285e-05, "add_observations_from_episodes_to_batch": 0.000919405398128827, "add_states_from_episodes_to_batch": 4.339590388272413e-06, "add_columns_from_episodes_to_train_batch": 0.04981664493501893, "batch_individual_items": 0.050503271740632946, "add_one_ts_to_episodes_and_truncate": 0.012009038405299653, "numpy_to_tensor": 0.00012450301508807235, "general_advantage_estimation": 0.008618294979325314}}, "connector_pipeline_timer": 0.12225450480623404}, "num_env_steps_trained_lifetime": 346500, "num_module_steps_trained": 6000, "num_trainable_parameters": 6003, "learner_connector_sum_episodes_length_in": 5000.0, "num_non_trainable_parameters": 0, "learner_connector_sum_episodes_length_out": 5250.0, "num_env_steps_trained": 31500, "num_module_steps_trained_lifetime": 66000, "num_env_steps_trained_lifetime_throughput": 997041.8230404234, "num_module_steps_trained_throughput": 190251.50483320886, "num_module_steps_trained_lifetime_throughput": 190099.12968134676}, "default_policy": {"gradients_default_optimizer_global_norm": 0.01735222153365612, "entropy": 0.6183834671974182, "vf_explained_var": -0.0113600492477417, "mean_kl_loss": 0.0006507525686174631, "num_module_steps_trained_lifetime": 66000, "vf_loss": 0.10278083384037018, "default_optimizer_learning_rate": 0.0002847858517, "curr_kl_coeff": 0.0003645001561380923, "module_train_batch_size_mean": 1000.0, "num_module_steps_trained": 6000, "num_trainable_parameters": 6003, "weights_seq_no": 11.0, "policy_loss": -0.020069513469934464, "diff_num_grad_updates_vs_sampler_policy": 1.0, "vf_loss_unclipped": 28.637535095214844, "curr_entropy_coeff": 0.0090570820258, "total_loss": 0.04307083040475845, "num_module_steps_trained_lifetime_throughput": 190344.42224901763}}, "num_training_step_calls_per_iteration": 1, "evaluation": {"env_runners": {"episode_len_min": 20, "episode_return_max": 13.5, "num_env_steps_sampled": 400, "sample": 0.1874453032428172, "env_to_module_connector": {"timers": {"connectors": {"add_observations_from_episodes_to_batch": 3.5817849070568683e-06, "add_states_from_episodes_to_batch": 2.002983569170063e-06, "batch_individual_items": 9.152530385715165e-06, "numpy_to_tensor": 1.1983406529537642e-05, "add_time_dim_to_batch_and_zero_pad": 2.9209166749750425e-06}}, "connector_pipeline_timer": 5.634894335695213e-05}, "num_episodes": 20, "num_env_steps_sampled_lifetime": 55400, "episode_len_max": 20, "module_to_env_connector": {"timers": {"connectors": {"tensor_to_numpy": 1.6759403388298303e-05, "get_actions": 5.327126629592226e-05, "un_batch_to_individual_items": 6.605937391720014e-06, "normalize_and_clip_actions": 1.1241753047497833e-05, "listify_data_for_vector_env": 1.3989496801487802e-05, "remove_single_ts_time_rank_from_batch": 7.064497184038705e-07}}, "connector_pipeline_timer": 0.00013374232371091057}, "episode_return_min": -14.5, "env_to_module_sum_episodes_length_out": 10.368238394574323, "num_agent_steps_sampled": {"default_agent": 400}, "module_episode_returns_mean": {"default_policy": 0.05}, "rlmodule_inference_timer": 3.841590135587945e-05, "env_to_module_sum_episodes_length_in": 10.368238394574323, "env_step_timer": 1.8996746208765158e-05, "num_agent_steps_sampled_lifetime": {"default_agent": 4400}, "episode_len_mean": 20.0, "env_reset_timer": 0.0006779876638191453, "num_module_steps_sampled_lifetime": {"default_policy": 4400}, "num_episodes_lifetime": 220, "num_module_steps_sampled": {"default_policy": 400}, "agent_episode_returns_mean": {"default_agent": 0.05}, "weights_seq_no": 11.0, "episode_return_mean": 0.05, "episode_duration_sec_mean": 0.00788152750930749, "time_between_sampling": 2.9235083018614585}, "num_healthy_workers": 1, "actor_manager_num_outstanding_async_reqs": 0, "num_remote_worker_restarts": 0}, "num_env_steps_sampled_lifetime": -5547500.0, "fault_tolerance": {"num_healthy_workers": 0, "num_remote_worker_restarts": 0}, "env_runner_group": {"actor_manager_num_outstanding_async_reqs": 0}, "done": false, "training_iteration": 11, "trial_id": "49ef3_00000", "date": "2025-08-11_19-31-05", "timestamp": 1754933465, "time_this_iter_s": 2.771583080291748, "time_total_s": 35.22277331352234, "pid": 23180, "hostname": "Mac", "node_ip": "127.0.0.1", "config": {"exploration_config": {}, "extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "placement_strategy": "PACK", "num_gpus": 0, "_fake_gpus": false, "num_cpus_for_main_process": 2, "eager_tracing": true, "eager_max_retraces": 20, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "torch_compile_learner": false, "torch_compile_learner_what_to_compile": "forward_train", "torch_compile_learner_dynamo_backend": "aot_eager", "torch_compile_learner_dynamo_mode": null, "torch_compile_worker": false, "torch_compile_worker_dynamo_backend": "aot_eager", "torch_compile_worker_dynamo_mode": null, "torch_ddp_kwargs": {}, "torch_skip_nan_gradients": false, "env": "Umbrella", "env_config": {}, "observation_space": null, "action_space": null, "clip_rewards": null, "normalize_actions": true, "clip_actions": false, "_is_atari": null, "disable_env_checking": false, "render_env": false, "action_mask_key": "action_mask", "env_runner_cls": null, "num_env_runners": 0, "create_local_env_runner": true, "num_envs_per_env_runner": 1, "gym_env_vectorize_mode": "SYNC", "num_cpus_per_env_runner": 1, "num_gpus_per_env_runner": 0, "custom_resources_per_env_runner": {}, "validate_env_runners_after_construction": true, "episodes_to_numpy": true, "max_requests_in_flight_per_env_runner": 1, "sample_timeout_s": 60.0, "_env_to_module_connector": null, "add_default_connectors_to_env_to_module_pipeline": true, "_module_to_env_connector": null, "add_default_connectors_to_module_to_env_pipeline": true, "merge_env_runner_states": "training_only", "broadcast_env_runner_states": true, "episode_lookback_horizon": 1, "rollout_fragment_length": "auto", "batch_mode": "complete_episodes", "compress_observations": false, "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "enable_tf1_exec_eagerly": false, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "preprocessor_pref": "deepmind", "observation_filter": "NoFilter", "update_worker_filter_stats": true, "use_worker_filter_stats": true, "sampler_perf_stats_ema_coef": null, "_is_online": true, "num_learners": 0, "num_gpus_per_learner": 0, "num_cpus_per_learner": "auto", "num_aggregator_actors_per_learner": 0, "max_requests_in_flight_per_aggregator_actor": 3, "local_gpu_idx": 0, "max_requests_in_flight_per_learner": 3, "gamma": 1, "lr": 0.0002847858517, "grad_clip": 0.5, "grad_clip_by": "global_norm", "_train_batch_size_per_learner": 5000, "train_batch_size": 4000, "num_epochs": 1, "minibatch_size": 1000, "shuffle_batch_per_epoch": true, "model": {"fcnet_hiddens": [256, 256], "fcnet_activation": "tanh", "fcnet_weights_initializer": null, "fcnet_weights_initializer_config": null, "fcnet_bias_initializer": null, "fcnet_bias_initializer_config": null, "conv_filters": null, "conv_activation": "relu", "conv_kernel_initializer": null, "conv_kernel_initializer_config": null, "conv_bias_initializer": null, "conv_bias_initializer_config": null, "conv_transpose_kernel_initializer": null, "conv_transpose_kernel_initializer_config": null, "conv_transpose_bias_initializer": null, "conv_transpose_bias_initializer_config": null, "post_fcnet_hiddens": [], "post_fcnet_activation": "relu", "post_fcnet_weights_initializer": null, "post_fcnet_weights_initializer_config": null, "post_fcnet_bias_initializer": null, "post_fcnet_bias_initializer_config": null, "free_log_std": false, "log_std_clip_param": 20.0, "no_final_linear": false, "vf_share_layers": false, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "lstm_weights_initializer": null, "lstm_weights_initializer_config": null, "lstm_bias_initializer": null, "lstm_bias_initializer_config": null, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "attention_use_n_prev_actions": 0, "attention_use_n_prev_rewards": 0, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": null, "custom_model_config": {}, "custom_action_dist": null, "custom_preprocessor": null, "encoder_latent_dim": null, "always_check_shapes": false, "lstm_use_prev_action_reward": -1, "_use_default_native_models": -1, "_disable_preprocessor_api": false, "_disable_action_flattening": false}, "_learner_connector": null, "add_default_connectors_to_learner_pipeline": true, "learner_config_dict": {}, "optimizer": {}, "_learner_class": null, "callbacks_on_algorithm_init": null, "callbacks_on_env_runners_recreated": null, "callbacks_on_offline_eval_runners_recreated": null, "callbacks_on_checkpoint_loaded": null, "callbacks_on_environment_created": null, "callbacks_on_episode_created": null, "callbacks_on_episode_start": null, "callbacks_on_episode_step": null, "callbacks_on_episode_end": null, "callbacks_on_evaluate_start": null, "callbacks_on_evaluate_end": null, "callbacks_on_evaluate_offline_start": null, "callbacks_on_evaluate_offline_end": null, "callbacks_on_sample_end": null, "callbacks_on_train_result": null, "explore": true, "enable_rl_module_and_learner": true, "enable_env_runner_and_connector_v2": true, "_prior_exploration_config": {"type": "StochasticSampling"}, "count_steps_by": "env_steps", "policy_map_capacity": 100, "policy_mapping_fn": "<function AlgorithmConfig.DEFAULT_POLICY_MAPPING_FN at 0x13e6b9b20>", "policies_to_train": null, "policy_states_are_swappable": false, "observation_fn": null, "offline_data_class": null, "input_read_method": "read_parquet", "input_read_method_kwargs": {}, "input_read_schema": {}, "input_read_episodes": false, "input_read_sample_batches": false, "input_read_batch_size": null, "input_filesystem": null, "input_filesystem_kwargs": {}, "input_compress_columns": ["obs", "new_obs"], "input_spaces_jsonable": true, "materialize_data": false, "materialize_mapped_data": true, "map_batches_kwargs": {}, "iter_batches_kwargs": {}, "ignore_final_observation": false, "prelearner_class": null, "prelearner_buffer_class": null, "prelearner_buffer_kwargs": {}, "prelearner_module_synch_period": 10, "dataset_num_iters_per_learner": null, "input_config": {}, "actions_in_input_normalized": false, "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_config": {}, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "output_max_rows_per_file": null, "output_write_remaining_data": false, "output_write_method": "write_parquet", "output_write_method_kwargs": {}, "output_filesystem": null, "output_filesystem_kwargs": {}, "output_write_episodes": true, "offline_sampling": false, "evaluation_interval": 1, "evaluation_duration": 20, "evaluation_duration_unit": "episodes", "evaluation_sample_timeout_s": 120.0, "evaluation_auto_duration_min_env_steps_per_sample": 100, "evaluation_auto_duration_max_env_steps_per_sample": 2000, "evaluation_parallel_to_training": false, "evaluation_force_reset_envs_before_iteration": true, "evaluation_config": null, "off_policy_estimation_methods": {}, "ope_split_batch_by_episode": true, "evaluation_num_env_runners": 1, "in_evaluation": false, "sync_filters_on_rollout_workers_timeout_s": 10.0, "offline_evaluation_interval": null, "num_offline_eval_runners": 0, "offline_loss_for_module_fn": null, "offline_evaluation_duration": 1, "offline_evaluation_parallel_to_training": false, "offline_evaluation_timeout_s": 120.0, "num_cpus_per_offline_eval_runner": 1, "num_gpus_per_offline_eval_runner": 0, "custom_resources_per_offline_eval_runner": {}, "restart_failed_offline_eval_runners": true, "ignore_offline_eval_runner_failures": false, "max_num_offline_eval_runner_restarts": 1000, "offline_eval_runner_restore_timeout_s": 1800.0, "max_requests_in_flight_per_offline_eval_runner": 1, "validate_offline_eval_runners_after_construction": true, "offline_eval_runner_health_probe_timeout_s": 30.0, "offline_eval_rl_module_inference_only": false, "broadcast_offline_eval_runner_states": false, "offline_eval_batch_size_per_runner": 256, "dataset_num_iters_per_eval_runner": 1, "keep_per_episode_custom_metrics": false, "metrics_episode_collection_timeout_s": 60.0, "metrics_num_episodes_for_smoothing": 100, "min_time_s_per_iteration": null, "min_train_timesteps_per_iteration": 0, "min_sample_timesteps_per_iteration": 0, "log_gradients": true, "export_native_model_files": false, "checkpoint_trainable_policies_only": false, "logger_creator": null, "logger_config": null, "log_level": "WARN", "log_sys_usage": true, "fake_sampler": false, "seed": 10, "restart_failed_env_runners": true, "ignore_env_runner_failures": false, "max_num_env_runner_restarts": 1000, "delay_between_env_runner_restarts_s": 60.0, "restart_failed_sub_environments": false, "num_consecutive_env_runner_failures_tolerance": 100, "env_runner_health_probe_timeout_s": 30.0, "env_runner_restore_timeout_s": 1800.0, "_model_config": {}, "_rl_module_spec": "RLModuleSpec(module_class=None, observation_space=None, action_space=None, inference_only=False, learner_only=False, model_config=DefaultModelConfig(fcnet_hiddens=[60, 90], fcnet_activation='tanh', fcnet_kernel_initializer=None, fcnet_kernel_initializer_kwargs=None, fcnet_bias_initializer=None, fcnet_bias_initializer_kwargs=None, conv_filters=None, conv_activation='relu', conv_kernel_initializer=None, conv_kernel_initializer_kwargs=None, conv_bias_initializer=None, conv_bias_initializer_kwargs=None, head_fcnet_hiddens=[], head_fcnet_activation='relu', head_fcnet_kernel_initializer=None, head_fcnet_kernel_initializer_kwargs=None, head_fcnet_bias_initializer=None, head_fcnet_bias_initializer_kwargs=None, free_log_std=False, log_std_clip_param=20.0, vf_share_layers=True, use_lstm=False, max_seq_len=20, lstm_cell_size=256, lstm_use_prev_action=False, lstm_use_prev_reward=False, lstm_kernel_initializer=None, lstm_kernel_initializer_kwargs=None, lstm_bias_initializer=None, lstm_bias_initializer_kwargs=None), catalog_class=None, load_state_path=None, model_config_dict=None)", "algorithm_config_overrides_per_module": {}, "_per_module_overrides": {}, "_validate_config": true, "_use_msgpack_checkpoints": false, "_torch_grad_scaler_class": null, "_torch_lr_scheduler_classes": null, "_tf_policy_handles_more_than_one_loss": false, "_disable_preprocessor_api": false, "_disable_action_flattening": false, "_disable_initialize_loss_from_dummy_batch": false, "_dont_auto_sync_env_runner_states": false, "env_task_fn": -1, "enable_connectors": -1, "simple_optimizer": false, "policy_map_cache": -1, "worker_cls": -1, "synchronize_filters": -1, "enable_async_evaluation": -1, "custom_async_evaluation_function": -1, "_enable_rl_module_api": -1, "auto_wrap_old_gym_envs": -1, "always_attach_evaluation_results": -1, "replay_sequence_length": null, "_disable_execution_plan_api": -1, "use_critic": true, "use_gae": true, "use_kl_loss": true, "kl_coeff": 0.7464963036515, "kl_target": 0.0270990929592, "vf_loss_coeff": 0.6688075857018, "entropy_coeff": 0.0090570820258, "clip_param": 0.1221781641624, "vf_clip_param": 0.1027808522125, "entropy_coeff_schedule": null, "lr_schedule": null, "sgd_minibatch_size": -1, "vf_share_layers": -1, "__stdout_file__": null, "__stderr_file__": null, "lambda": 0.9099046732075, "input": "sampler", "policies": {"default_policy": [null, null, null, null]}, "callbacks": "<class 'ray.rllib.callbacks.callbacks.RLlibCallback'>", "create_env_on_driver": false, "custom_eval_function": null, "framework": "torch"}, "time_since_restore": 35.22277331352234, "iterations_since_restore": 11, "perf": {"cpu_util_percent": 75.825, "ram_util_percent": 79.125}}
{"timers": {"training_iteration": 4.422387918706738, "restore_env_runners": 1.3960074191642637e-05, "training_step": 4.422041836884175, "env_runner_sampling_timer": 4.22231343806699, "learner_update_timer": 0.19118462710762155, "synch_weights": 0.0021566194180017853, "restore_eval_env_runners": 1.7853850354260182e-05, "evaluation_iteration": 0.20255540045707246, "synch_eval_env_connectors": 0.00025109526365266373, "synch_env_connectors": 4.6114958159877365e-06}, "env_runners": {"weights_seq_no": 11.0, "env_to_module_connector": {"timers": {"connectors": {"add_states_from_episodes_to_batch": 2.5232377481300115e-06, "batch_individual_items": 1.132423717622216e-05, "add_observations_from_episodes_to_batch": 5.1708248472105586e-06, "add_time_dim_to_batch_and_zero_pad": 3.8152017508464994e-06, "numpy_to_tensor": 1.6823349455907057e-05}}, "connector_pipeline_timer": 7.292296785530761e-05}, "num_env_steps_sampled": 5000.0, "module_episode_returns_mean": {"default_policy": 4.380000000000001}, "sample": 0.00877775221508715, "num_module_steps_sampled": {"default_policy": 5000.0}, "num_episodes": 250.0, "module_to_env_connector": {"connector_pipeline_timer": 0.00019241778011430623, "timers": {"connectors": {"tensor_to_numpy": 2.4075809298229966e-05, "get_actions": 8.103513149446779e-05, "un_batch_to_individual_items": 9.227223958319504e-06, "normalize_and_clip_actions": 1.5815737499202977e-05, "listify_data_for_vector_env": 1.904392672491819e-05, "remove_single_ts_time_rank_from_batch": 1.0382750677642085e-06}}}, "time_between_sampling": 0.0028810628211702665, "num_env_steps_sampled_lifetime": -6165000.0, "episode_return_mean": 4.380000000000001, "episode_return_min": -10.5, "agent_episode_returns_mean": {"default_agent": 4.380000000000001}, "episode_duration_sec_mean": 0.008247507474850863, "env_to_module_sum_episodes_length_out": 10.36823839457432, "episode_len_mean": 20.0, "env_reset_timer": 8.74209026233785e-05, "num_agent_steps_sampled_lifetime": {"default_agent": -6165000.0}, "num_episodes_lifetime": -308250.0, "episode_len_max": 20, "rlmodule_inference_timer": 5.3563832372214105e-05, "env_to_module_sum_episodes_length_in": 10.36823839457432, "num_agent_steps_sampled": {"default_agent": 5000.0}, "episode_return_max": 9.5, "episode_len_min": 20, "env_step_timer": 2.5675597131709138e-05, "num_module_steps_sampled_lifetime": {"default_policy": -6165000.0}, "num_env_steps_sampled_lifetime_throughput": 2364.413847752636}, "learners": {"__all_modules__": {"learner_connector": {"timers": {"connectors": {"add_time_dim_to_batch_and_zero_pad": 2.2929790082434644e-05, "add_observations_from_episodes_to_batch": 0.0009317159351338352, "add_states_from_episodes_to_batch": 4.329944450340536e-06, "add_columns_from_episodes_to_train_batch": 0.05007432473577253, "batch_individual_items": 0.05039852652287793, "add_one_ts_to_episodes_and_truncate": 0.011988356771203294, "numpy_to_tensor": 0.00012395840587003593, "general_advantage_estimation": 0.008627432030078113}}, "connector_pipeline_timer": 0.12240650766811695}, "num_env_steps_trained_lifetime": 378000, "num_module_steps_trained": 6000, "num_trainable_parameters": 6003, "learner_connector_sum_episodes_length_in": 5000.0, "num_non_trainable_parameters": 0, "learner_connector_sum_episodes_length_out": 5250.0, "num_env_steps_trained": 31500, "num_module_steps_trained_lifetime": 72000, "num_env_steps_trained_lifetime_throughput": 1008491.4288492493, "num_module_steps_trained_throughput": 192400.3265430633, "num_module_steps_trained_lifetime_throughput": 192259.1879106675}, "default_policy": {"gradients_default_optimizer_global_norm": 0.02542821504175663, "entropy": 0.6033130884170532, "vf_explained_var": -0.01087331771850586, "mean_kl_loss": 0.0004655509255826473, "num_module_steps_trained_lifetime": 72000, "vf_loss": 0.10278083384037018, "default_optimizer_learning_rate": 0.0002847858517, "curr_kl_coeff": 0.00018225007806904614, "module_train_batch_size_mean": 1000.0, "num_module_steps_trained": 6000, "num_trainable_parameters": 6003, "weights_seq_no": 12.0, "policy_loss": -0.04556255415081978, "diff_num_grad_updates_vs_sampler_policy": 1.0, "vf_loss_unclipped": 28.60890007019043, "curr_entropy_coeff": 0.0090570820258, "total_loss": 0.01771397329866886, "num_module_steps_trained_lifetime_throughput": 192460.4255514596}}, "num_training_step_calls_per_iteration": 1, "evaluation": {"env_runners": {"episode_len_min": 20, "episode_return_max": 13.5, "num_env_steps_sampled": 400, "sample": 0.18691039270943394, "env_to_module_connector": {"timers": {"connectors": {"add_observations_from_episodes_to_batch": 3.2937039351886633e-06, "add_states_from_episodes_to_batch": 1.7573033835559371e-06, "batch_individual_items": 7.482870589538301e-06, "numpy_to_tensor": 1.1481439587928308e-05, "add_time_dim_to_batch_and_zero_pad": 2.609871915732985e-06}}, "connector_pipeline_timer": 5.1589514877588844e-05}, "num_episodes": 20, "num_env_steps_sampled_lifetime": 60400, "episode_len_max": 20, "module_to_env_connector": {"timers": {"connectors": {"tensor_to_numpy": 1.6055295769130722e-05, "get_actions": 4.8718049514330085e-05, "un_batch_to_individual_items": 6.893219847512914e-06, "normalize_and_clip_actions": 1.2411192769906371e-05, "listify_data_for_vector_env": 1.3500361941092743e-05, "remove_single_ts_time_rank_from_batch": 6.707639350611983e-07}}, "connector_pipeline_timer": 0.00012915041689227276}, "episode_return_min": -14.5, "env_to_module_sum_episodes_length_out": 10.368238394574323, "num_agent_steps_sampled": {"default_agent": 400}, "module_episode_returns_mean": {"default_policy": 0.45}, "rlmodule_inference_timer": 3.552257653353513e-05, "env_to_module_sum_episodes_length_in": 10.368238394574323, "env_step_timer": 1.7382801463943898e-05, "num_agent_steps_sampled_lifetime": {"default_agent": 4800}, "episode_len_mean": 20.0, "env_reset_timer": 0.0006719523667736735, "num_module_steps_sampled_lifetime": {"default_policy": 4800}, "num_episodes_lifetime": 240, "num_module_steps_sampled": {"default_policy": 400}, "agent_episode_returns_mean": {"default_agent": 0.45}, "weights_seq_no": 12.0, "episode_return_mean": 0.45, "episode_duration_sec_mean": 0.00716121251694858, "time_between_sampling": 2.9219398859326415}, "num_healthy_workers": 1, "actor_manager_num_outstanding_async_reqs": 0, "num_remote_worker_restarts": 0}, "num_env_steps_sampled_lifetime": -6165000.0, "fault_tolerance": {"num_healthy_workers": 0, "num_remote_worker_restarts": 0}, "env_runner_group": {"actor_manager_num_outstanding_async_reqs": 0}, "done": false, "training_iteration": 12, "trial_id": "49ef3_00000", "date": "2025-08-11_19-31-08", "timestamp": 1754933468, "time_this_iter_s": 2.888577938079834, "time_total_s": 38.11135125160217, "pid": 23180, "hostname": "Mac", "node_ip": "127.0.0.1", "config": {"exploration_config": {}, "extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "placement_strategy": "PACK", "num_gpus": 0, "_fake_gpus": false, "num_cpus_for_main_process": 2, "eager_tracing": true, "eager_max_retraces": 20, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "torch_compile_learner": false, "torch_compile_learner_what_to_compile": "forward_train", "torch_compile_learner_dynamo_backend": "aot_eager", "torch_compile_learner_dynamo_mode": null, "torch_compile_worker": false, "torch_compile_worker_dynamo_backend": "aot_eager", "torch_compile_worker_dynamo_mode": null, "torch_ddp_kwargs": {}, "torch_skip_nan_gradients": false, "env": "Umbrella", "env_config": {}, "observation_space": null, "action_space": null, "clip_rewards": null, "normalize_actions": true, "clip_actions": false, "_is_atari": null, "disable_env_checking": false, "render_env": false, "action_mask_key": "action_mask", "env_runner_cls": null, "num_env_runners": 0, "create_local_env_runner": true, "num_envs_per_env_runner": 1, "gym_env_vectorize_mode": "SYNC", "num_cpus_per_env_runner": 1, "num_gpus_per_env_runner": 0, "custom_resources_per_env_runner": {}, "validate_env_runners_after_construction": true, "episodes_to_numpy": true, "max_requests_in_flight_per_env_runner": 1, "sample_timeout_s": 60.0, "_env_to_module_connector": null, "add_default_connectors_to_env_to_module_pipeline": true, "_module_to_env_connector": null, "add_default_connectors_to_module_to_env_pipeline": true, "merge_env_runner_states": "training_only", "broadcast_env_runner_states": true, "episode_lookback_horizon": 1, "rollout_fragment_length": "auto", "batch_mode": "complete_episodes", "compress_observations": false, "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "enable_tf1_exec_eagerly": false, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "preprocessor_pref": "deepmind", "observation_filter": "NoFilter", "update_worker_filter_stats": true, "use_worker_filter_stats": true, "sampler_perf_stats_ema_coef": null, "_is_online": true, "num_learners": 0, "num_gpus_per_learner": 0, "num_cpus_per_learner": "auto", "num_aggregator_actors_per_learner": 0, "max_requests_in_flight_per_aggregator_actor": 3, "local_gpu_idx": 0, "max_requests_in_flight_per_learner": 3, "gamma": 1, "lr": 0.0002847858517, "grad_clip": 0.5, "grad_clip_by": "global_norm", "_train_batch_size_per_learner": 5000, "train_batch_size": 4000, "num_epochs": 1, "minibatch_size": 1000, "shuffle_batch_per_epoch": true, "model": {"fcnet_hiddens": [256, 256], "fcnet_activation": "tanh", "fcnet_weights_initializer": null, "fcnet_weights_initializer_config": null, "fcnet_bias_initializer": null, "fcnet_bias_initializer_config": null, "conv_filters": null, "conv_activation": "relu", "conv_kernel_initializer": null, "conv_kernel_initializer_config": null, "conv_bias_initializer": null, "conv_bias_initializer_config": null, "conv_transpose_kernel_initializer": null, "conv_transpose_kernel_initializer_config": null, "conv_transpose_bias_initializer": null, "conv_transpose_bias_initializer_config": null, "post_fcnet_hiddens": [], "post_fcnet_activation": "relu", "post_fcnet_weights_initializer": null, "post_fcnet_weights_initializer_config": null, "post_fcnet_bias_initializer": null, "post_fcnet_bias_initializer_config": null, "free_log_std": false, "log_std_clip_param": 20.0, "no_final_linear": false, "vf_share_layers": false, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "lstm_weights_initializer": null, "lstm_weights_initializer_config": null, "lstm_bias_initializer": null, "lstm_bias_initializer_config": null, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "attention_use_n_prev_actions": 0, "attention_use_n_prev_rewards": 0, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": null, "custom_model_config": {}, "custom_action_dist": null, "custom_preprocessor": null, "encoder_latent_dim": null, "always_check_shapes": false, "lstm_use_prev_action_reward": -1, "_use_default_native_models": -1, "_disable_preprocessor_api": false, "_disable_action_flattening": false}, "_learner_connector": null, "add_default_connectors_to_learner_pipeline": true, "learner_config_dict": {}, "optimizer": {}, "_learner_class": null, "callbacks_on_algorithm_init": null, "callbacks_on_env_runners_recreated": null, "callbacks_on_offline_eval_runners_recreated": null, "callbacks_on_checkpoint_loaded": null, "callbacks_on_environment_created": null, "callbacks_on_episode_created": null, "callbacks_on_episode_start": null, "callbacks_on_episode_step": null, "callbacks_on_episode_end": null, "callbacks_on_evaluate_start": null, "callbacks_on_evaluate_end": null, "callbacks_on_evaluate_offline_start": null, "callbacks_on_evaluate_offline_end": null, "callbacks_on_sample_end": null, "callbacks_on_train_result": null, "explore": true, "enable_rl_module_and_learner": true, "enable_env_runner_and_connector_v2": true, "_prior_exploration_config": {"type": "StochasticSampling"}, "count_steps_by": "env_steps", "policy_map_capacity": 100, "policy_mapping_fn": "<function AlgorithmConfig.DEFAULT_POLICY_MAPPING_FN at 0x13e6b9b20>", "policies_to_train": null, "policy_states_are_swappable": false, "observation_fn": null, "offline_data_class": null, "input_read_method": "read_parquet", "input_read_method_kwargs": {}, "input_read_schema": {}, "input_read_episodes": false, "input_read_sample_batches": false, "input_read_batch_size": null, "input_filesystem": null, "input_filesystem_kwargs": {}, "input_compress_columns": ["obs", "new_obs"], "input_spaces_jsonable": true, "materialize_data": false, "materialize_mapped_data": true, "map_batches_kwargs": {}, "iter_batches_kwargs": {}, "ignore_final_observation": false, "prelearner_class": null, "prelearner_buffer_class": null, "prelearner_buffer_kwargs": {}, "prelearner_module_synch_period": 10, "dataset_num_iters_per_learner": null, "input_config": {}, "actions_in_input_normalized": false, "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_config": {}, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "output_max_rows_per_file": null, "output_write_remaining_data": false, "output_write_method": "write_parquet", "output_write_method_kwargs": {}, "output_filesystem": null, "output_filesystem_kwargs": {}, "output_write_episodes": true, "offline_sampling": false, "evaluation_interval": 1, "evaluation_duration": 20, "evaluation_duration_unit": "episodes", "evaluation_sample_timeout_s": 120.0, "evaluation_auto_duration_min_env_steps_per_sample": 100, "evaluation_auto_duration_max_env_steps_per_sample": 2000, "evaluation_parallel_to_training": false, "evaluation_force_reset_envs_before_iteration": true, "evaluation_config": null, "off_policy_estimation_methods": {}, "ope_split_batch_by_episode": true, "evaluation_num_env_runners": 1, "in_evaluation": false, "sync_filters_on_rollout_workers_timeout_s": 10.0, "offline_evaluation_interval": null, "num_offline_eval_runners": 0, "offline_loss_for_module_fn": null, "offline_evaluation_duration": 1, "offline_evaluation_parallel_to_training": false, "offline_evaluation_timeout_s": 120.0, "num_cpus_per_offline_eval_runner": 1, "num_gpus_per_offline_eval_runner": 0, "custom_resources_per_offline_eval_runner": {}, "restart_failed_offline_eval_runners": true, "ignore_offline_eval_runner_failures": false, "max_num_offline_eval_runner_restarts": 1000, "offline_eval_runner_restore_timeout_s": 1800.0, "max_requests_in_flight_per_offline_eval_runner": 1, "validate_offline_eval_runners_after_construction": true, "offline_eval_runner_health_probe_timeout_s": 30.0, "offline_eval_rl_module_inference_only": false, "broadcast_offline_eval_runner_states": false, "offline_eval_batch_size_per_runner": 256, "dataset_num_iters_per_eval_runner": 1, "keep_per_episode_custom_metrics": false, "metrics_episode_collection_timeout_s": 60.0, "metrics_num_episodes_for_smoothing": 100, "min_time_s_per_iteration": null, "min_train_timesteps_per_iteration": 0, "min_sample_timesteps_per_iteration": 0, "log_gradients": true, "export_native_model_files": false, "checkpoint_trainable_policies_only": false, "logger_creator": null, "logger_config": null, "log_level": "WARN", "log_sys_usage": true, "fake_sampler": false, "seed": 10, "restart_failed_env_runners": true, "ignore_env_runner_failures": false, "max_num_env_runner_restarts": 1000, "delay_between_env_runner_restarts_s": 60.0, "restart_failed_sub_environments": false, "num_consecutive_env_runner_failures_tolerance": 100, "env_runner_health_probe_timeout_s": 30.0, "env_runner_restore_timeout_s": 1800.0, "_model_config": {}, "_rl_module_spec": "RLModuleSpec(module_class=None, observation_space=None, action_space=None, inference_only=False, learner_only=False, model_config=DefaultModelConfig(fcnet_hiddens=[60, 90], fcnet_activation='tanh', fcnet_kernel_initializer=None, fcnet_kernel_initializer_kwargs=None, fcnet_bias_initializer=None, fcnet_bias_initializer_kwargs=None, conv_filters=None, conv_activation='relu', conv_kernel_initializer=None, conv_kernel_initializer_kwargs=None, conv_bias_initializer=None, conv_bias_initializer_kwargs=None, head_fcnet_hiddens=[], head_fcnet_activation='relu', head_fcnet_kernel_initializer=None, head_fcnet_kernel_initializer_kwargs=None, head_fcnet_bias_initializer=None, head_fcnet_bias_initializer_kwargs=None, free_log_std=False, log_std_clip_param=20.0, vf_share_layers=True, use_lstm=False, max_seq_len=20, lstm_cell_size=256, lstm_use_prev_action=False, lstm_use_prev_reward=False, lstm_kernel_initializer=None, lstm_kernel_initializer_kwargs=None, lstm_bias_initializer=None, lstm_bias_initializer_kwargs=None), catalog_class=None, load_state_path=None, model_config_dict=None)", "algorithm_config_overrides_per_module": {}, "_per_module_overrides": {}, "_validate_config": true, "_use_msgpack_checkpoints": false, "_torch_grad_scaler_class": null, "_torch_lr_scheduler_classes": null, "_tf_policy_handles_more_than_one_loss": false, "_disable_preprocessor_api": false, "_disable_action_flattening": false, "_disable_initialize_loss_from_dummy_batch": false, "_dont_auto_sync_env_runner_states": false, "env_task_fn": -1, "enable_connectors": -1, "simple_optimizer": false, "policy_map_cache": -1, "worker_cls": -1, "synchronize_filters": -1, "enable_async_evaluation": -1, "custom_async_evaluation_function": -1, "_enable_rl_module_api": -1, "auto_wrap_old_gym_envs": -1, "always_attach_evaluation_results": -1, "replay_sequence_length": null, "_disable_execution_plan_api": -1, "use_critic": true, "use_gae": true, "use_kl_loss": true, "kl_coeff": 0.7464963036515, "kl_target": 0.0270990929592, "vf_loss_coeff": 0.6688075857018, "entropy_coeff": 0.0090570820258, "clip_param": 0.1221781641624, "vf_clip_param": 0.1027808522125, "entropy_coeff_schedule": null, "lr_schedule": null, "sgd_minibatch_size": -1, "vf_share_layers": -1, "__stdout_file__": null, "__stderr_file__": null, "lambda": 0.9099046732075, "input": "sampler", "policies": {"default_policy": [null, null, null, null]}, "callbacks": "<class 'ray.rllib.callbacks.callbacks.RLlibCallback'>", "create_env_on_driver": false, "custom_eval_function": null, "framework": "torch"}, "time_since_restore": 38.11135125160217, "iterations_since_restore": 12, "perf": {"cpu_util_percent": 77.25, "ram_util_percent": 79.55000000000001}}
{"timers": {"training_iteration": 4.4069459361897865, "restore_env_runners": 1.3888393640939697e-05, "training_step": 4.406601189346213, "env_runner_sampling_timer": 4.207434642435856, "learner_update_timer": 0.19067307083656493, "synch_weights": 0.0021422282237405564, "restore_eval_env_runners": 1.7743641823863902e-05, "evaluation_iteration": 0.20192350395265887, "synch_eval_env_connectors": 0.0002495359701833225, "synch_env_connectors": 4.607880599367218e-06}, "env_runners": {"weights_seq_no": 12.0, "env_to_module_connector": {"timers": {"connectors": {"add_states_from_episodes_to_batch": 2.6938415821594982e-06, "batch_individual_items": 1.1885400892614302e-05, "add_observations_from_episodes_to_batch": 5.164056885653358e-06, "add_time_dim_to_batch_and_zero_pad": 4.08162718518963e-06, "numpy_to_tensor": 1.744033695216975e-05}}, "connector_pipeline_timer": 7.588390406008286e-05}, "num_env_steps_sampled": 5000.0, "module_episode_returns_mean": {"default_policy": 3.339999999999999}, "sample": 0.009193024195051728, "num_module_steps_sampled": {"default_policy": 5000.0}, "num_episodes": 250.0, "module_to_env_connector": {"connector_pipeline_timer": 0.00020456505550515362, "timers": {"connectors": {"tensor_to_numpy": 2.5655852894870473e-05, "get_actions": 8.627886454753843e-05, "un_batch_to_individual_items": 9.524974288630334e-06, "normalize_and_clip_actions": 1.7095552663994038e-05, "listify_data_for_vector_env": 2.1275339864537716e-05, "remove_single_ts_time_rank_from_batch": 9.693830644245657e-07}}}, "time_between_sampling": 0.0025993682320674836, "num_env_steps_sampled_lifetime": -6782500.0, "episode_return_mean": 3.339999999999999, "episode_return_min": -10.5, "agent_episode_returns_mean": {"default_agent": 3.339999999999999}, "episode_duration_sec_mean": 0.008769178848247976, "env_to_module_sum_episodes_length_out": 10.36823839457432, "episode_len_mean": 20.0, "env_reset_timer": 8.273695109196333e-05, "num_agent_steps_sampled_lifetime": {"default_agent": -6782500.0}, "num_episodes_lifetime": -339125.0, "episode_len_max": 20, "rlmodule_inference_timer": 5.785932815608674e-05, "env_to_module_sum_episodes_length_in": 10.36823839457432, "num_agent_steps_sampled": {"default_agent": 5000.0}, "episode_return_max": 9.5, "episode_len_min": 20, "env_step_timer": 2.763525396343685e-05, "num_module_steps_sampled_lifetime": {"default_policy": -6782500.0}, "num_env_steps_sampled_lifetime_throughput": 2302.335396570294}, "learners": {"__all_modules__": {"learner_connector": {"timers": {"connectors": {"add_time_dim_to_batch_and_zero_pad": 2.296465135252101e-05, "add_observations_from_episodes_to_batch": 0.0009308512755334985, "add_states_from_episodes_to_batch": 4.482065585821915e-06, "add_columns_from_episodes_to_train_batch": 0.04998382814888205, "batch_individual_items": 0.050345582508138795, "add_one_ts_to_episodes_and_truncate": 0.011948289453854627, "numpy_to_tensor": 0.00012359923130910325, "general_advantage_estimation": 0.008635761870181164}}, "connector_pipeline_timer": 0.12223122634101057}, "num_env_steps_trained_lifetime": 409500, "num_module_steps_trained": 6000, "num_trainable_parameters": 6003, "learner_connector_sum_episodes_length_in": 5000.0, "num_non_trainable_parameters": 0, "learner_connector_sum_episodes_length_out": 5250.0, "num_env_steps_trained": 31500, "num_module_steps_trained_lifetime": 78000, "num_env_steps_trained_lifetime_throughput": 1015258.7565135042, "num_module_steps_trained_throughput": 193661.54920323426, "num_module_steps_trained_lifetime_throughput": 193530.74722273237}, "default_policy": {"gradients_default_optimizer_global_norm": 0.02619677409529686, "entropy": 0.5803787112236023, "vf_explained_var": -0.011479973793029785, "mean_kl_loss": 0.0013015683507546782, "num_module_steps_trained_lifetime": 78000, "vf_loss": 0.10278083384037018, "default_optimizer_learning_rate": 0.0002847858517, "curr_kl_coeff": 9.112503903452307e-05, "module_train_batch_size_mean": 1000.0, "num_module_steps_trained": 6000, "num_trainable_parameters": 6003, "weights_seq_no": 13.0, "policy_loss": -0.039517566561698914, "diff_num_grad_updates_vs_sampler_policy": 1.0, "vf_loss_unclipped": 28.610172271728516, "curr_entropy_coeff": 0.0090570820258, "total_loss": 0.023966753855347633, "num_module_steps_trained_lifetime_throughput": 193692.6720867855}}, "num_training_step_calls_per_iteration": 1, "evaluation": {"env_runners": {"episode_len_min": 20, "episode_return_max": 13.5, "num_env_steps_sampled": 400, "sample": 0.1864623950328306, "env_to_module_connector": {"timers": {"connectors": {"add_observations_from_episodes_to_batch": 3.693940631687743e-06, "add_states_from_episodes_to_batch": 2.084519577569336e-06, "batch_individual_items": 7.998659863690072e-06, "numpy_to_tensor": 1.1404925781086589e-05, "add_time_dim_to_batch_and_zero_pad": 2.7481455034829418e-06}}, "connector_pipeline_timer": 5.5039036770036905e-05}, "num_episodes": 20, "num_env_steps_sampled_lifetime": 65400, "episode_len_max": 20, "module_to_env_connector": {"timers": {"connectors": {"tensor_to_numpy": 1.865619494942954e-05, "get_actions": 5.9429636889383717e-05, "un_batch_to_individual_items": 7.271331353817677e-06, "normalize_and_clip_actions": 1.2993274349734573e-05, "listify_data_for_vector_env": 1.5089843249622834e-05, "remove_single_ts_time_rank_from_batch": 9.241726426716412e-07}}, "connector_pipeline_timer": 0.00014881151500410509}, "episode_return_min": -14.5, "env_to_module_sum_episodes_length_out": 10.368238394574323, "num_agent_steps_sampled": {"default_agent": 400}, "module_episode_returns_mean": {"default_policy": 0.05}, "rlmodule_inference_timer": 3.8719199188628726e-05, "env_to_module_sum_episodes_length_in": 10.368238394574323, "env_step_timer": 2.0420639030474815e-05, "num_agent_steps_sampled_lifetime": {"default_agent": 5200}, "episode_len_mean": 20.0, "env_reset_timer": 0.0006659486832481569, "num_module_steps_sampled_lifetime": {"default_policy": 5200}, "num_episodes_lifetime": 260, "num_module_steps_sampled": {"default_policy": 400}, "agent_episode_returns_mean": {"default_agent": 0.05}, "weights_seq_no": 13.0, "episode_return_mean": 0.05, "episode_duration_sec_mean": 0.007201865416718647, "time_between_sampling": 2.9217006641624215}, "num_healthy_workers": 1, "actor_manager_num_outstanding_async_reqs": 0, "num_remote_worker_restarts": 0}, "num_env_steps_sampled_lifetime": -6782500.0, "fault_tolerance": {"num_healthy_workers": 0, "num_remote_worker_restarts": 0}, "env_runner_group": {"actor_manager_num_outstanding_async_reqs": 0}, "done": false, "training_iteration": 13, "trial_id": "49ef3_00000", "date": "2025-08-11_19-31-11", "timestamp": 1754933471, "time_this_iter_s": 3.0290110111236572, "time_total_s": 41.14036226272583, "pid": 23180, "hostname": "Mac", "node_ip": "127.0.0.1", "config": {"exploration_config": {}, "extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "placement_strategy": "PACK", "num_gpus": 0, "_fake_gpus": false, "num_cpus_for_main_process": 2, "eager_tracing": true, "eager_max_retraces": 20, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "torch_compile_learner": false, "torch_compile_learner_what_to_compile": "forward_train", "torch_compile_learner_dynamo_backend": "aot_eager", "torch_compile_learner_dynamo_mode": null, "torch_compile_worker": false, "torch_compile_worker_dynamo_backend": "aot_eager", "torch_compile_worker_dynamo_mode": null, "torch_ddp_kwargs": {}, "torch_skip_nan_gradients": false, "env": "Umbrella", "env_config": {}, "observation_space": null, "action_space": null, "clip_rewards": null, "normalize_actions": true, "clip_actions": false, "_is_atari": null, "disable_env_checking": false, "render_env": false, "action_mask_key": "action_mask", "env_runner_cls": null, "num_env_runners": 0, "create_local_env_runner": true, "num_envs_per_env_runner": 1, "gym_env_vectorize_mode": "SYNC", "num_cpus_per_env_runner": 1, "num_gpus_per_env_runner": 0, "custom_resources_per_env_runner": {}, "validate_env_runners_after_construction": true, "episodes_to_numpy": true, "max_requests_in_flight_per_env_runner": 1, "sample_timeout_s": 60.0, "_env_to_module_connector": null, "add_default_connectors_to_env_to_module_pipeline": true, "_module_to_env_connector": null, "add_default_connectors_to_module_to_env_pipeline": true, "merge_env_runner_states": "training_only", "broadcast_env_runner_states": true, "episode_lookback_horizon": 1, "rollout_fragment_length": "auto", "batch_mode": "complete_episodes", "compress_observations": false, "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "enable_tf1_exec_eagerly": false, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "preprocessor_pref": "deepmind", "observation_filter": "NoFilter", "update_worker_filter_stats": true, "use_worker_filter_stats": true, "sampler_perf_stats_ema_coef": null, "_is_online": true, "num_learners": 0, "num_gpus_per_learner": 0, "num_cpus_per_learner": "auto", "num_aggregator_actors_per_learner": 0, "max_requests_in_flight_per_aggregator_actor": 3, "local_gpu_idx": 0, "max_requests_in_flight_per_learner": 3, "gamma": 1, "lr": 0.0002847858517, "grad_clip": 0.5, "grad_clip_by": "global_norm", "_train_batch_size_per_learner": 5000, "train_batch_size": 4000, "num_epochs": 1, "minibatch_size": 1000, "shuffle_batch_per_epoch": true, "model": {"fcnet_hiddens": [256, 256], "fcnet_activation": "tanh", "fcnet_weights_initializer": null, "fcnet_weights_initializer_config": null, "fcnet_bias_initializer": null, "fcnet_bias_initializer_config": null, "conv_filters": null, "conv_activation": "relu", "conv_kernel_initializer": null, "conv_kernel_initializer_config": null, "conv_bias_initializer": null, "conv_bias_initializer_config": null, "conv_transpose_kernel_initializer": null, "conv_transpose_kernel_initializer_config": null, "conv_transpose_bias_initializer": null, "conv_transpose_bias_initializer_config": null, "post_fcnet_hiddens": [], "post_fcnet_activation": "relu", "post_fcnet_weights_initializer": null, "post_fcnet_weights_initializer_config": null, "post_fcnet_bias_initializer": null, "post_fcnet_bias_initializer_config": null, "free_log_std": false, "log_std_clip_param": 20.0, "no_final_linear": false, "vf_share_layers": false, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "lstm_weights_initializer": null, "lstm_weights_initializer_config": null, "lstm_bias_initializer": null, "lstm_bias_initializer_config": null, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "attention_use_n_prev_actions": 0, "attention_use_n_prev_rewards": 0, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": null, "custom_model_config": {}, "custom_action_dist": null, "custom_preprocessor": null, "encoder_latent_dim": null, "always_check_shapes": false, "lstm_use_prev_action_reward": -1, "_use_default_native_models": -1, "_disable_preprocessor_api": false, "_disable_action_flattening": false}, "_learner_connector": null, "add_default_connectors_to_learner_pipeline": true, "learner_config_dict": {}, "optimizer": {}, "_learner_class": null, "callbacks_on_algorithm_init": null, "callbacks_on_env_runners_recreated": null, "callbacks_on_offline_eval_runners_recreated": null, "callbacks_on_checkpoint_loaded": null, "callbacks_on_environment_created": null, "callbacks_on_episode_created": null, "callbacks_on_episode_start": null, "callbacks_on_episode_step": null, "callbacks_on_episode_end": null, "callbacks_on_evaluate_start": null, "callbacks_on_evaluate_end": null, "callbacks_on_evaluate_offline_start": null, "callbacks_on_evaluate_offline_end": null, "callbacks_on_sample_end": null, "callbacks_on_train_result": null, "explore": true, "enable_rl_module_and_learner": true, "enable_env_runner_and_connector_v2": true, "_prior_exploration_config": {"type": "StochasticSampling"}, "count_steps_by": "env_steps", "policy_map_capacity": 100, "policy_mapping_fn": "<function AlgorithmConfig.DEFAULT_POLICY_MAPPING_FN at 0x13e6b9b20>", "policies_to_train": null, "policy_states_are_swappable": false, "observation_fn": null, "offline_data_class": null, "input_read_method": "read_parquet", "input_read_method_kwargs": {}, "input_read_schema": {}, "input_read_episodes": false, "input_read_sample_batches": false, "input_read_batch_size": null, "input_filesystem": null, "input_filesystem_kwargs": {}, "input_compress_columns": ["obs", "new_obs"], "input_spaces_jsonable": true, "materialize_data": false, "materialize_mapped_data": true, "map_batches_kwargs": {}, "iter_batches_kwargs": {}, "ignore_final_observation": false, "prelearner_class": null, "prelearner_buffer_class": null, "prelearner_buffer_kwargs": {}, "prelearner_module_synch_period": 10, "dataset_num_iters_per_learner": null, "input_config": {}, "actions_in_input_normalized": false, "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_config": {}, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "output_max_rows_per_file": null, "output_write_remaining_data": false, "output_write_method": "write_parquet", "output_write_method_kwargs": {}, "output_filesystem": null, "output_filesystem_kwargs": {}, "output_write_episodes": true, "offline_sampling": false, "evaluation_interval": 1, "evaluation_duration": 20, "evaluation_duration_unit": "episodes", "evaluation_sample_timeout_s": 120.0, "evaluation_auto_duration_min_env_steps_per_sample": 100, "evaluation_auto_duration_max_env_steps_per_sample": 2000, "evaluation_parallel_to_training": false, "evaluation_force_reset_envs_before_iteration": true, "evaluation_config": null, "off_policy_estimation_methods": {}, "ope_split_batch_by_episode": true, "evaluation_num_env_runners": 1, "in_evaluation": false, "sync_filters_on_rollout_workers_timeout_s": 10.0, "offline_evaluation_interval": null, "num_offline_eval_runners": 0, "offline_loss_for_module_fn": null, "offline_evaluation_duration": 1, "offline_evaluation_parallel_to_training": false, "offline_evaluation_timeout_s": 120.0, "num_cpus_per_offline_eval_runner": 1, "num_gpus_per_offline_eval_runner": 0, "custom_resources_per_offline_eval_runner": {}, "restart_failed_offline_eval_runners": true, "ignore_offline_eval_runner_failures": false, "max_num_offline_eval_runner_restarts": 1000, "offline_eval_runner_restore_timeout_s": 1800.0, "max_requests_in_flight_per_offline_eval_runner": 1, "validate_offline_eval_runners_after_construction": true, "offline_eval_runner_health_probe_timeout_s": 30.0, "offline_eval_rl_module_inference_only": false, "broadcast_offline_eval_runner_states": false, "offline_eval_batch_size_per_runner": 256, "dataset_num_iters_per_eval_runner": 1, "keep_per_episode_custom_metrics": false, "metrics_episode_collection_timeout_s": 60.0, "metrics_num_episodes_for_smoothing": 100, "min_time_s_per_iteration": null, "min_train_timesteps_per_iteration": 0, "min_sample_timesteps_per_iteration": 0, "log_gradients": true, "export_native_model_files": false, "checkpoint_trainable_policies_only": false, "logger_creator": null, "logger_config": null, "log_level": "WARN", "log_sys_usage": true, "fake_sampler": false, "seed": 10, "restart_failed_env_runners": true, "ignore_env_runner_failures": false, "max_num_env_runner_restarts": 1000, "delay_between_env_runner_restarts_s": 60.0, "restart_failed_sub_environments": false, "num_consecutive_env_runner_failures_tolerance": 100, "env_runner_health_probe_timeout_s": 30.0, "env_runner_restore_timeout_s": 1800.0, "_model_config": {}, "_rl_module_spec": "RLModuleSpec(module_class=None, observation_space=None, action_space=None, inference_only=False, learner_only=False, model_config=DefaultModelConfig(fcnet_hiddens=[60, 90], fcnet_activation='tanh', fcnet_kernel_initializer=None, fcnet_kernel_initializer_kwargs=None, fcnet_bias_initializer=None, fcnet_bias_initializer_kwargs=None, conv_filters=None, conv_activation='relu', conv_kernel_initializer=None, conv_kernel_initializer_kwargs=None, conv_bias_initializer=None, conv_bias_initializer_kwargs=None, head_fcnet_hiddens=[], head_fcnet_activation='relu', head_fcnet_kernel_initializer=None, head_fcnet_kernel_initializer_kwargs=None, head_fcnet_bias_initializer=None, head_fcnet_bias_initializer_kwargs=None, free_log_std=False, log_std_clip_param=20.0, vf_share_layers=True, use_lstm=False, max_seq_len=20, lstm_cell_size=256, lstm_use_prev_action=False, lstm_use_prev_reward=False, lstm_kernel_initializer=None, lstm_kernel_initializer_kwargs=None, lstm_bias_initializer=None, lstm_bias_initializer_kwargs=None), catalog_class=None, load_state_path=None, model_config_dict=None)", "algorithm_config_overrides_per_module": {}, "_per_module_overrides": {}, "_validate_config": true, "_use_msgpack_checkpoints": false, "_torch_grad_scaler_class": null, "_torch_lr_scheduler_classes": null, "_tf_policy_handles_more_than_one_loss": false, "_disable_preprocessor_api": false, "_disable_action_flattening": false, "_disable_initialize_loss_from_dummy_batch": false, "_dont_auto_sync_env_runner_states": false, "env_task_fn": -1, "enable_connectors": -1, "simple_optimizer": false, "policy_map_cache": -1, "worker_cls": -1, "synchronize_filters": -1, "enable_async_evaluation": -1, "custom_async_evaluation_function": -1, "_enable_rl_module_api": -1, "auto_wrap_old_gym_envs": -1, "always_attach_evaluation_results": -1, "replay_sequence_length": null, "_disable_execution_plan_api": -1, "use_critic": true, "use_gae": true, "use_kl_loss": true, "kl_coeff": 0.7464963036515, "kl_target": 0.0270990929592, "vf_loss_coeff": 0.6688075857018, "entropy_coeff": 0.0090570820258, "clip_param": 0.1221781641624, "vf_clip_param": 0.1027808522125, "entropy_coeff_schedule": null, "lr_schedule": null, "sgd_minibatch_size": -1, "vf_share_layers": -1, "__stdout_file__": null, "__stderr_file__": null, "lambda": 0.9099046732075, "input": "sampler", "policies": {"default_policy": [null, null, null, null]}, "callbacks": "<class 'ray.rllib.callbacks.callbacks.RLlibCallback'>", "create_env_on_driver": false, "custom_eval_function": null, "framework": "torch"}, "time_since_restore": 41.14036226272583, "iterations_since_restore": 13, "perf": {"cpu_util_percent": 74.3, "ram_util_percent": 78.9}}
{"timers": {"training_iteration": 4.390645380578582, "restore_env_runners": 1.3876169574678005e-05, "training_step": 4.390300643292517, "env_runner_sampling_timer": 4.190119509761282, "learner_update_timer": 0.1917308655477195, "synch_weights": 0.0021317767712563562, "restore_eval_env_runners": 1.7634535378771583e-05, "evaluation_iteration": 0.20138862558237572, "synch_eval_env_connectors": 0.0002481026907455808, "synch_env_connectors": 4.600142015464028e-06}, "env_runners": {"weights_seq_no": 13.0, "env_to_module_connector": {"timers": {"connectors": {"add_states_from_episodes_to_batch": 2.584468737127356e-06, "batch_individual_items": 1.1378466124721324e-05, "add_observations_from_episodes_to_batch": 4.892416549250301e-06, "add_time_dim_to_batch_and_zero_pad": 3.848665990545535e-06, "numpy_to_tensor": 1.6672772144740977e-05}}, "connector_pipeline_timer": 7.301885256358616e-05}, "num_env_steps_sampled": 5000.0, "module_episode_returns_mean": {"default_policy": 5.019999999999998}, "sample": 0.00900152742056708, "num_module_steps_sampled": {"default_policy": 5000.0}, "num_episodes": 250.0, "module_to_env_connector": {"connector_pipeline_timer": 0.00019209181073481248, "timers": {"connectors": {"tensor_to_numpy": 2.376461665883916e-05, "get_actions": 8.008195718004099e-05, "un_batch_to_individual_items": 9.361335597931205e-06, "normalize_and_clip_actions": 1.5522847160504576e-05, "listify_data_for_vector_env": 1.9466325491484212e-05, "remove_single_ts_time_rank_from_batch": 1.1055365326937422e-06}}}, "time_between_sampling": 0.00259653923291782, "num_env_steps_sampled_lifetime": -7400000.0, "episode_return_mean": 5.019999999999998, "episode_return_min": -10.5, "agent_episode_returns_mean": {"default_agent": 5.019999999999998}, "episode_duration_sec_mean": 0.008249707365408542, "env_to_module_sum_episodes_length_out": 10.36823839457432, "episode_len_mean": 20.0, "env_reset_timer": 8.12280483228662e-05, "num_agent_steps_sampled_lifetime": {"default_agent": -7400000.0}, "num_episodes_lifetime": -370000.0, "episode_len_max": 20, "rlmodule_inference_timer": 5.349929933722993e-05, "env_to_module_sum_episodes_length_in": 10.36823839457432, "num_agent_steps_sampled": {"default_agent": 5000.0}, "episode_return_max": 9.5, "episode_len_min": 20, "env_step_timer": 2.569617523880845e-05, "num_module_steps_sampled_lifetime": {"default_policy": -7400000.0}, "num_env_steps_sampled_lifetime_throughput": 2334.7519657379958}, "learners": {"__all_modules__": {"learner_connector": {"timers": {"connectors": {"add_time_dim_to_batch_and_zero_pad": 2.2853754288025363e-05, "add_observations_from_episodes_to_batch": 0.0009315540124656862, "add_states_from_episodes_to_batch": 4.471824937159169e-06, "add_columns_from_episodes_to_train_batch": 0.04991239111662127, "batch_individual_items": 0.05184611335322739, "add_one_ts_to_episodes_and_truncate": 0.01194401780911089, "numpy_to_tensor": 0.00012363198905263663, "general_advantage_estimation": 0.008629085091032827}}, "connector_pipeline_timer": 0.12364996657771245}, "num_env_steps_trained_lifetime": 441000, "num_module_steps_trained": 6000, "num_trainable_parameters": 6003, "learner_connector_sum_episodes_length_in": 5000.0, "num_non_trainable_parameters": 0, "learner_connector_sum_episodes_length_out": 5250.0, "num_env_steps_trained": 31500, "num_module_steps_trained_lifetime": 84000, "num_env_steps_trained_lifetime_throughput": 1018537.531070651, "num_module_steps_trained_throughput": 194265.2856970548, "num_module_steps_trained_lifetime_throughput": 194143.9247659308}, "default_policy": {"gradients_default_optimizer_global_norm": 0.035518303513526917, "entropy": 0.5491995215415955, "vf_explained_var": -0.00948035717010498, "mean_kl_loss": 0.001021185191348195, "num_module_steps_trained_lifetime": 84000, "vf_loss": 0.10278083384037018, "default_optimizer_learning_rate": 0.0002847858517, "curr_kl_coeff": 4.5562519517261535e-05, "module_train_batch_size_mean": 1000.0, "num_module_steps_trained": 6000, "num_trainable_parameters": 6003, "weights_seq_no": 14.0, "policy_loss": -0.19703388214111328, "diff_num_grad_updates_vs_sampler_policy": 1.0, "vf_loss_unclipped": 28.610187530517578, "curr_entropy_coeff": 0.0090570820258, "total_loss": -0.1332673281431198, "num_module_steps_trained_lifetime_throughput": 194272.39986045717}}, "num_training_step_calls_per_iteration": 1, "evaluation": {"env_runners": {"episode_len_min": 20, "episode_return_max": 13.5, "num_env_steps_sampled": 400, "sample": 0.18591455483200073, "env_to_module_connector": {"timers": {"connectors": {"add_observations_from_episodes_to_batch": 3.782371416725104e-06, "add_states_from_episodes_to_batch": 2.1282344560101833e-06, "batch_individual_items": 7.944924898697022e-06, "numpy_to_tensor": 1.076864326041632e-05, "add_time_dim_to_batch_and_zero_pad": 3.1535250792335913e-06}}, "connector_pipeline_timer": 5.5111100202541876e-05}, "num_episodes": 20, "num_env_steps_sampled_lifetime": 70400, "episode_len_max": 20, "module_to_env_connector": {"timers": {"connectors": {"tensor_to_numpy": 1.7043122600296752e-05, "get_actions": 5.3472135614044014e-05, "un_batch_to_individual_items": 6.8524458747477725e-06, "normalize_and_clip_actions": 1.1725311881464384e-05, "listify_data_for_vector_env": 1.436137486370274e-05, "remove_single_ts_time_rank_from_batch": 7.082092501022172e-07}}, "connector_pipeline_timer": 0.00013632247630171546}, "episode_return_min": -14.5, "env_to_module_sum_episodes_length_out": 10.368238394574323, "num_agent_steps_sampled": {"default_agent": 400}, "module_episode_returns_mean": {"default_policy": 0.45}, "rlmodule_inference_timer": 3.5984422794821275e-05, "env_to_module_sum_episodes_length_in": 10.368238394574323, "env_step_timer": 2.0606583107254453e-05, "num_agent_steps_sampled_lifetime": {"default_agent": 5600}, "episode_len_mean": 20.0, "env_reset_timer": 0.0006603454466004498, "num_module_steps_sampled_lifetime": {"default_policy": 5600}, "num_episodes_lifetime": 280, "num_module_steps_sampled": {"default_policy": 400}, "agent_episode_returns_mean": {"default_agent": 0.45}, "weights_seq_no": 14.0, "episode_return_mean": 0.45, "episode_duration_sec_mean": 0.0068362274987157435, "time_between_sampling": 2.920497140441157}, "num_healthy_workers": 1, "actor_manager_num_outstanding_async_reqs": 0, "num_remote_worker_restarts": 0}, "num_env_steps_sampled_lifetime": -7400000.0, "fault_tolerance": {"num_healthy_workers": 0, "num_remote_worker_restarts": 0}, "env_runner_group": {"actor_manager_num_outstanding_async_reqs": 0}, "done": false, "training_iteration": 14, "trial_id": "49ef3_00000", "date": "2025-08-11_19-31-14", "timestamp": 1754933474, "time_this_iter_s": 2.9163448810577393, "time_total_s": 44.05670714378357, "pid": 23180, "hostname": "Mac", "node_ip": "127.0.0.1", "config": {"exploration_config": {}, "extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "placement_strategy": "PACK", "num_gpus": 0, "_fake_gpus": false, "num_cpus_for_main_process": 2, "eager_tracing": true, "eager_max_retraces": 20, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "torch_compile_learner": false, "torch_compile_learner_what_to_compile": "forward_train", "torch_compile_learner_dynamo_backend": "aot_eager", "torch_compile_learner_dynamo_mode": null, "torch_compile_worker": false, "torch_compile_worker_dynamo_backend": "aot_eager", "torch_compile_worker_dynamo_mode": null, "torch_ddp_kwargs": {}, "torch_skip_nan_gradients": false, "env": "Umbrella", "env_config": {}, "observation_space": null, "action_space": null, "clip_rewards": null, "normalize_actions": true, "clip_actions": false, "_is_atari": null, "disable_env_checking": false, "render_env": false, "action_mask_key": "action_mask", "env_runner_cls": null, "num_env_runners": 0, "create_local_env_runner": true, "num_envs_per_env_runner": 1, "gym_env_vectorize_mode": "SYNC", "num_cpus_per_env_runner": 1, "num_gpus_per_env_runner": 0, "custom_resources_per_env_runner": {}, "validate_env_runners_after_construction": true, "episodes_to_numpy": true, "max_requests_in_flight_per_env_runner": 1, "sample_timeout_s": 60.0, "_env_to_module_connector": null, "add_default_connectors_to_env_to_module_pipeline": true, "_module_to_env_connector": null, "add_default_connectors_to_module_to_env_pipeline": true, "merge_env_runner_states": "training_only", "broadcast_env_runner_states": true, "episode_lookback_horizon": 1, "rollout_fragment_length": "auto", "batch_mode": "complete_episodes", "compress_observations": false, "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "enable_tf1_exec_eagerly": false, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "preprocessor_pref": "deepmind", "observation_filter": "NoFilter", "update_worker_filter_stats": true, "use_worker_filter_stats": true, "sampler_perf_stats_ema_coef": null, "_is_online": true, "num_learners": 0, "num_gpus_per_learner": 0, "num_cpus_per_learner": "auto", "num_aggregator_actors_per_learner": 0, "max_requests_in_flight_per_aggregator_actor": 3, "local_gpu_idx": 0, "max_requests_in_flight_per_learner": 3, "gamma": 1, "lr": 0.0002847858517, "grad_clip": 0.5, "grad_clip_by": "global_norm", "_train_batch_size_per_learner": 5000, "train_batch_size": 4000, "num_epochs": 1, "minibatch_size": 1000, "shuffle_batch_per_epoch": true, "model": {"fcnet_hiddens": [256, 256], "fcnet_activation": "tanh", "fcnet_weights_initializer": null, "fcnet_weights_initializer_config": null, "fcnet_bias_initializer": null, "fcnet_bias_initializer_config": null, "conv_filters": null, "conv_activation": "relu", "conv_kernel_initializer": null, "conv_kernel_initializer_config": null, "conv_bias_initializer": null, "conv_bias_initializer_config": null, "conv_transpose_kernel_initializer": null, "conv_transpose_kernel_initializer_config": null, "conv_transpose_bias_initializer": null, "conv_transpose_bias_initializer_config": null, "post_fcnet_hiddens": [], "post_fcnet_activation": "relu", "post_fcnet_weights_initializer": null, "post_fcnet_weights_initializer_config": null, "post_fcnet_bias_initializer": null, "post_fcnet_bias_initializer_config": null, "free_log_std": false, "log_std_clip_param": 20.0, "no_final_linear": false, "vf_share_layers": false, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "lstm_weights_initializer": null, "lstm_weights_initializer_config": null, "lstm_bias_initializer": null, "lstm_bias_initializer_config": null, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "attention_use_n_prev_actions": 0, "attention_use_n_prev_rewards": 0, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": null, "custom_model_config": {}, "custom_action_dist": null, "custom_preprocessor": null, "encoder_latent_dim": null, "always_check_shapes": false, "lstm_use_prev_action_reward": -1, "_use_default_native_models": -1, "_disable_preprocessor_api": false, "_disable_action_flattening": false}, "_learner_connector": null, "add_default_connectors_to_learner_pipeline": true, "learner_config_dict": {}, "optimizer": {}, "_learner_class": null, "callbacks_on_algorithm_init": null, "callbacks_on_env_runners_recreated": null, "callbacks_on_offline_eval_runners_recreated": null, "callbacks_on_checkpoint_loaded": null, "callbacks_on_environment_created": null, "callbacks_on_episode_created": null, "callbacks_on_episode_start": null, "callbacks_on_episode_step": null, "callbacks_on_episode_end": null, "callbacks_on_evaluate_start": null, "callbacks_on_evaluate_end": null, "callbacks_on_evaluate_offline_start": null, "callbacks_on_evaluate_offline_end": null, "callbacks_on_sample_end": null, "callbacks_on_train_result": null, "explore": true, "enable_rl_module_and_learner": true, "enable_env_runner_and_connector_v2": true, "_prior_exploration_config": {"type": "StochasticSampling"}, "count_steps_by": "env_steps", "policy_map_capacity": 100, "policy_mapping_fn": "<function AlgorithmConfig.DEFAULT_POLICY_MAPPING_FN at 0x13e6b9b20>", "policies_to_train": null, "policy_states_are_swappable": false, "observation_fn": null, "offline_data_class": null, "input_read_method": "read_parquet", "input_read_method_kwargs": {}, "input_read_schema": {}, "input_read_episodes": false, "input_read_sample_batches": false, "input_read_batch_size": null, "input_filesystem": null, "input_filesystem_kwargs": {}, "input_compress_columns": ["obs", "new_obs"], "input_spaces_jsonable": true, "materialize_data": false, "materialize_mapped_data": true, "map_batches_kwargs": {}, "iter_batches_kwargs": {}, "ignore_final_observation": false, "prelearner_class": null, "prelearner_buffer_class": null, "prelearner_buffer_kwargs": {}, "prelearner_module_synch_period": 10, "dataset_num_iters_per_learner": null, "input_config": {}, "actions_in_input_normalized": false, "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_config": {}, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "output_max_rows_per_file": null, "output_write_remaining_data": false, "output_write_method": "write_parquet", "output_write_method_kwargs": {}, "output_filesystem": null, "output_filesystem_kwargs": {}, "output_write_episodes": true, "offline_sampling": false, "evaluation_interval": 1, "evaluation_duration": 20, "evaluation_duration_unit": "episodes", "evaluation_sample_timeout_s": 120.0, "evaluation_auto_duration_min_env_steps_per_sample": 100, "evaluation_auto_duration_max_env_steps_per_sample": 2000, "evaluation_parallel_to_training": false, "evaluation_force_reset_envs_before_iteration": true, "evaluation_config": null, "off_policy_estimation_methods": {}, "ope_split_batch_by_episode": true, "evaluation_num_env_runners": 1, "in_evaluation": false, "sync_filters_on_rollout_workers_timeout_s": 10.0, "offline_evaluation_interval": null, "num_offline_eval_runners": 0, "offline_loss_for_module_fn": null, "offline_evaluation_duration": 1, "offline_evaluation_parallel_to_training": false, "offline_evaluation_timeout_s": 120.0, "num_cpus_per_offline_eval_runner": 1, "num_gpus_per_offline_eval_runner": 0, "custom_resources_per_offline_eval_runner": {}, "restart_failed_offline_eval_runners": true, "ignore_offline_eval_runner_failures": false, "max_num_offline_eval_runner_restarts": 1000, "offline_eval_runner_restore_timeout_s": 1800.0, "max_requests_in_flight_per_offline_eval_runner": 1, "validate_offline_eval_runners_after_construction": true, "offline_eval_runner_health_probe_timeout_s": 30.0, "offline_eval_rl_module_inference_only": false, "broadcast_offline_eval_runner_states": false, "offline_eval_batch_size_per_runner": 256, "dataset_num_iters_per_eval_runner": 1, "keep_per_episode_custom_metrics": false, "metrics_episode_collection_timeout_s": 60.0, "metrics_num_episodes_for_smoothing": 100, "min_time_s_per_iteration": null, "min_train_timesteps_per_iteration": 0, "min_sample_timesteps_per_iteration": 0, "log_gradients": true, "export_native_model_files": false, "checkpoint_trainable_policies_only": false, "logger_creator": null, "logger_config": null, "log_level": "WARN", "log_sys_usage": true, "fake_sampler": false, "seed": 10, "restart_failed_env_runners": true, "ignore_env_runner_failures": false, "max_num_env_runner_restarts": 1000, "delay_between_env_runner_restarts_s": 60.0, "restart_failed_sub_environments": false, "num_consecutive_env_runner_failures_tolerance": 100, "env_runner_health_probe_timeout_s": 30.0, "env_runner_restore_timeout_s": 1800.0, "_model_config": {}, "_rl_module_spec": "RLModuleSpec(module_class=None, observation_space=None, action_space=None, inference_only=False, learner_only=False, model_config=DefaultModelConfig(fcnet_hiddens=[60, 90], fcnet_activation='tanh', fcnet_kernel_initializer=None, fcnet_kernel_initializer_kwargs=None, fcnet_bias_initializer=None, fcnet_bias_initializer_kwargs=None, conv_filters=None, conv_activation='relu', conv_kernel_initializer=None, conv_kernel_initializer_kwargs=None, conv_bias_initializer=None, conv_bias_initializer_kwargs=None, head_fcnet_hiddens=[], head_fcnet_activation='relu', head_fcnet_kernel_initializer=None, head_fcnet_kernel_initializer_kwargs=None, head_fcnet_bias_initializer=None, head_fcnet_bias_initializer_kwargs=None, free_log_std=False, log_std_clip_param=20.0, vf_share_layers=True, use_lstm=False, max_seq_len=20, lstm_cell_size=256, lstm_use_prev_action=False, lstm_use_prev_reward=False, lstm_kernel_initializer=None, lstm_kernel_initializer_kwargs=None, lstm_bias_initializer=None, lstm_bias_initializer_kwargs=None), catalog_class=None, load_state_path=None, model_config_dict=None)", "algorithm_config_overrides_per_module": {}, "_per_module_overrides": {}, "_validate_config": true, "_use_msgpack_checkpoints": false, "_torch_grad_scaler_class": null, "_torch_lr_scheduler_classes": null, "_tf_policy_handles_more_than_one_loss": false, "_disable_preprocessor_api": false, "_disable_action_flattening": false, "_disable_initialize_loss_from_dummy_batch": false, "_dont_auto_sync_env_runner_states": false, "env_task_fn": -1, "enable_connectors": -1, "simple_optimizer": false, "policy_map_cache": -1, "worker_cls": -1, "synchronize_filters": -1, "enable_async_evaluation": -1, "custom_async_evaluation_function": -1, "_enable_rl_module_api": -1, "auto_wrap_old_gym_envs": -1, "always_attach_evaluation_results": -1, "replay_sequence_length": null, "_disable_execution_plan_api": -1, "use_critic": true, "use_gae": true, "use_kl_loss": true, "kl_coeff": 0.7464963036515, "kl_target": 0.0270990929592, "vf_loss_coeff": 0.6688075857018, "entropy_coeff": 0.0090570820258, "clip_param": 0.1221781641624, "vf_clip_param": 0.1027808522125, "entropy_coeff_schedule": null, "lr_schedule": null, "sgd_minibatch_size": -1, "vf_share_layers": -1, "__stdout_file__": null, "__stderr_file__": null, "lambda": 0.9099046732075, "input": "sampler", "policies": {"default_policy": [null, null, null, null]}, "callbacks": "<class 'ray.rllib.callbacks.callbacks.RLlibCallback'>", "create_env_on_driver": false, "custom_eval_function": null, "framework": "torch"}, "time_since_restore": 44.05670714378357, "iterations_since_restore": 14, "perf": {"cpu_util_percent": 72.275, "ram_util_percent": 78.775}}
{"timers": {"training_iteration": 4.376259649272379, "restore_env_runners": 1.3794497952755153e-05, "training_step": 4.3759153414398035, "env_runner_sampling_timer": 4.174827369242836, "learner_update_timer": 0.19266613147328981, "synch_weights": 0.002124196913738115, "restore_eval_env_runners": 1.752443965632914e-05, "evaluation_iteration": 0.20074522932666952, "synch_eval_env_connectors": 0.00024811875386486124, "synch_env_connectors": 4.601640374921214e-06}, "env_runners": {"weights_seq_no": 14.0, "env_to_module_connector": {"timers": {"connectors": {"add_states_from_episodes_to_batch": 2.663401985761353e-06, "batch_individual_items": 1.250986278666485e-05, "add_observations_from_episodes_to_batch": 5.477262104569261e-06, "add_time_dim_to_batch_and_zero_pad": 4.228565239564353e-06, "numpy_to_tensor": 1.824865269396556e-05}}, "connector_pipeline_timer": 7.828997026198654e-05}, "num_env_steps_sampled": 5000.0, "module_episode_returns_mean": {"default_policy": 4.14}, "sample": 0.009199220727194164, "num_module_steps_sampled": {"default_policy": 5000.0}, "num_episodes": 250.0, "module_to_env_connector": {"connector_pipeline_timer": 0.0002061743183105581, "timers": {"connectors": {"tensor_to_numpy": 2.6195369659793236e-05, "get_actions": 8.846842784129769e-05, "un_batch_to_individual_items": 9.707508073723649e-06, "normalize_and_clip_actions": 1.6821771526268932e-05, "listify_data_for_vector_env": 1.9876806418606182e-05, "remove_single_ts_time_rank_from_batch": 1.0701987778622444e-06}}}, "time_between_sampling": 0.0028727975956136568, "num_env_steps_sampled_lifetime": -8017500.0, "episode_return_mean": 4.14, "episode_return_min": -10.5, "agent_episode_returns_mean": {"default_agent": 4.14}, "episode_duration_sec_mean": 0.008862543629948053, "env_to_module_sum_episodes_length_out": 10.36823839457432, "episode_len_mean": 20.0, "env_reset_timer": 8.03459205469494e-05, "num_agent_steps_sampled_lifetime": {"default_agent": -8017500.0}, "num_episodes_lifetime": -400875.0, "episode_len_max": 20, "rlmodule_inference_timer": 5.808912866347731e-05, "env_to_module_sum_episodes_length_in": 10.36823839457432, "num_agent_steps_sampled": {"default_agent": 5000.0}, "episode_return_max": 9.5, "episode_len_min": 20, "env_step_timer": 2.7606175487530892e-05, "num_module_steps_sampled_lifetime": {"default_policy": -8017500.0}, "num_env_steps_sampled_lifetime_throughput": 2235.721941356237}, "learners": {"__all_modules__": {"learner_connector": {"timers": {"connectors": {"add_time_dim_to_batch_and_zero_pad": 2.2791046878627925e-05, "add_observations_from_episodes_to_batch": 0.0009407993016805782, "add_states_from_episodes_to_batch": 4.462526049453422e-06, "add_columns_from_episodes_to_train_batch": 0.050017186375553434, "batch_individual_items": 0.053001203048986464, "add_one_ts_to_episodes_and_truncate": 0.012026833460955674, "numpy_to_tensor": 0.0001230856685953446, "general_advantage_estimation": 0.008598471739744606}}, "connector_pipeline_timer": 0.1249697173321015}, "num_env_steps_trained_lifetime": 472500, "num_module_steps_trained": 6000, "num_trainable_parameters": 6003, "learner_connector_sum_episodes_length_in": 5000.0, "num_non_trainable_parameters": 0, "learner_connector_sum_episodes_length_out": 5250.0, "num_env_steps_trained": 31500, "num_module_steps_trained_lifetime": 90000, "num_env_steps_trained_lifetime_throughput": 1020392.3576073723, "num_module_steps_trained_throughput": 194614.1233491256, "num_module_steps_trained_lifetime_throughput": 194495.09915819523}, "default_policy": {"gradients_default_optimizer_global_norm": 0.1371627002954483, "entropy": 0.5368001461029053, "vf_explained_var": -0.012212872505187988, "mean_kl_loss": 0.0006800030241720378, "num_module_steps_trained_lifetime": 90000, "vf_loss": 0.10278083384037018, "default_optimizer_learning_rate": 0.0002847858517, "curr_kl_coeff": 2.2781259758630767e-05, "module_train_batch_size_mean": 1000.0, "num_module_steps_trained": 6000, "num_trainable_parameters": 6003, "weights_seq_no": 15.0, "policy_loss": 0.13732679188251495, "diff_num_grad_updates_vs_sampler_policy": 1.0, "vf_loss_unclipped": 28.692230224609375, "curr_entropy_coeff": 0.0090570820258, "total_loss": 0.2012055665254593, "num_module_steps_trained_lifetime_throughput": 194604.07424572782}}, "num_training_step_calls_per_iteration": 1, "evaluation": {"env_runners": {"episode_len_min": 20, "episode_return_max": 13.5, "num_env_steps_sampled": 400, "sample": 0.18572855345329817, "env_to_module_connector": {"timers": {"connectors": {"add_observations_from_episodes_to_batch": 4.161192464694554e-06, "add_states_from_episodes_to_batch": 2.2250455677516122e-06, "batch_individual_items": 9.93483842968566e-06, "numpy_to_tensor": 1.3476509150968602e-05, "add_time_dim_to_batch_and_zero_pad": 3.2641230019515023e-06}}, "connector_pipeline_timer": 6.147384449881529e-05}, "num_episodes": 20, "num_env_steps_sampled_lifetime": 75400, "episode_len_max": 20, "module_to_env_connector": {"timers": {"connectors": {"tensor_to_numpy": 1.9891124462054564e-05, "get_actions": 6.2907568801503e-05, "un_batch_to_individual_items": 7.697251237122228e-06, "normalize_and_clip_actions": 1.3085418085718536e-05, "listify_data_for_vector_env": 1.5024965578468897e-05, "remove_single_ts_time_rank_from_batch": 8.156490980837222e-07}}, "connector_pipeline_timer": 0.00015580866556632662}, "episode_return_min": -14.5, "env_to_module_sum_episodes_length_out": 10.368238394574323, "num_agent_steps_sampled": {"default_agent": 400}, "module_episode_returns_mean": {"default_policy": 0.25}, "rlmodule_inference_timer": 4.5251097875181326e-05, "env_to_module_sum_episodes_length_in": 10.368238394574323, "env_step_timer": 2.216241163114639e-05, "num_agent_steps_sampled_lifetime": {"default_agent": 6000}, "episode_len_mean": 20.0, "env_reset_timer": 0.0006572199115155571, "num_module_steps_sampled_lifetime": {"default_policy": 6000}, "num_episodes_lifetime": 300, "num_module_steps_sampled": {"default_policy": 400}, "agent_episode_returns_mean": {"default_agent": 0.25}, "weights_seq_no": 15.0, "episode_return_mean": 0.25, "episode_duration_sec_mean": 0.006716560419881716, "time_between_sampling": 2.9210899794471277}, "num_healthy_workers": 1, "actor_manager_num_outstanding_async_reqs": 0, "num_remote_worker_restarts": 0}, "num_env_steps_sampled_lifetime": -8017500.0, "fault_tolerance": {"num_healthy_workers": 0, "num_remote_worker_restarts": 0}, "env_runner_group": {"actor_manager_num_outstanding_async_reqs": 0}, "done": false, "training_iteration": 15, "trial_id": "49ef3_00000", "date": "2025-08-11_19-31-17", "timestamp": 1754933477, "time_this_iter_s": 3.1323959827423096, "time_total_s": 47.18910312652588, "pid": 23180, "hostname": "Mac", "node_ip": "127.0.0.1", "config": {"exploration_config": {}, "extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "placement_strategy": "PACK", "num_gpus": 0, "_fake_gpus": false, "num_cpus_for_main_process": 2, "eager_tracing": true, "eager_max_retraces": 20, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "torch_compile_learner": false, "torch_compile_learner_what_to_compile": "forward_train", "torch_compile_learner_dynamo_backend": "aot_eager", "torch_compile_learner_dynamo_mode": null, "torch_compile_worker": false, "torch_compile_worker_dynamo_backend": "aot_eager", "torch_compile_worker_dynamo_mode": null, "torch_ddp_kwargs": {}, "torch_skip_nan_gradients": false, "env": "Umbrella", "env_config": {}, "observation_space": null, "action_space": null, "clip_rewards": null, "normalize_actions": true, "clip_actions": false, "_is_atari": null, "disable_env_checking": false, "render_env": false, "action_mask_key": "action_mask", "env_runner_cls": null, "num_env_runners": 0, "create_local_env_runner": true, "num_envs_per_env_runner": 1, "gym_env_vectorize_mode": "SYNC", "num_cpus_per_env_runner": 1, "num_gpus_per_env_runner": 0, "custom_resources_per_env_runner": {}, "validate_env_runners_after_construction": true, "episodes_to_numpy": true, "max_requests_in_flight_per_env_runner": 1, "sample_timeout_s": 60.0, "_env_to_module_connector": null, "add_default_connectors_to_env_to_module_pipeline": true, "_module_to_env_connector": null, "add_default_connectors_to_module_to_env_pipeline": true, "merge_env_runner_states": "training_only", "broadcast_env_runner_states": true, "episode_lookback_horizon": 1, "rollout_fragment_length": "auto", "batch_mode": "complete_episodes", "compress_observations": false, "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "enable_tf1_exec_eagerly": false, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "preprocessor_pref": "deepmind", "observation_filter": "NoFilter", "update_worker_filter_stats": true, "use_worker_filter_stats": true, "sampler_perf_stats_ema_coef": null, "_is_online": true, "num_learners": 0, "num_gpus_per_learner": 0, "num_cpus_per_learner": "auto", "num_aggregator_actors_per_learner": 0, "max_requests_in_flight_per_aggregator_actor": 3, "local_gpu_idx": 0, "max_requests_in_flight_per_learner": 3, "gamma": 1, "lr": 0.0002847858517, "grad_clip": 0.5, "grad_clip_by": "global_norm", "_train_batch_size_per_learner": 5000, "train_batch_size": 4000, "num_epochs": 1, "minibatch_size": 1000, "shuffle_batch_per_epoch": true, "model": {"fcnet_hiddens": [256, 256], "fcnet_activation": "tanh", "fcnet_weights_initializer": null, "fcnet_weights_initializer_config": null, "fcnet_bias_initializer": null, "fcnet_bias_initializer_config": null, "conv_filters": null, "conv_activation": "relu", "conv_kernel_initializer": null, "conv_kernel_initializer_config": null, "conv_bias_initializer": null, "conv_bias_initializer_config": null, "conv_transpose_kernel_initializer": null, "conv_transpose_kernel_initializer_config": null, "conv_transpose_bias_initializer": null, "conv_transpose_bias_initializer_config": null, "post_fcnet_hiddens": [], "post_fcnet_activation": "relu", "post_fcnet_weights_initializer": null, "post_fcnet_weights_initializer_config": null, "post_fcnet_bias_initializer": null, "post_fcnet_bias_initializer_config": null, "free_log_std": false, "log_std_clip_param": 20.0, "no_final_linear": false, "vf_share_layers": false, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "lstm_weights_initializer": null, "lstm_weights_initializer_config": null, "lstm_bias_initializer": null, "lstm_bias_initializer_config": null, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "attention_use_n_prev_actions": 0, "attention_use_n_prev_rewards": 0, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": null, "custom_model_config": {}, "custom_action_dist": null, "custom_preprocessor": null, "encoder_latent_dim": null, "always_check_shapes": false, "lstm_use_prev_action_reward": -1, "_use_default_native_models": -1, "_disable_preprocessor_api": false, "_disable_action_flattening": false}, "_learner_connector": null, "add_default_connectors_to_learner_pipeline": true, "learner_config_dict": {}, "optimizer": {}, "_learner_class": null, "callbacks_on_algorithm_init": null, "callbacks_on_env_runners_recreated": null, "callbacks_on_offline_eval_runners_recreated": null, "callbacks_on_checkpoint_loaded": null, "callbacks_on_environment_created": null, "callbacks_on_episode_created": null, "callbacks_on_episode_start": null, "callbacks_on_episode_step": null, "callbacks_on_episode_end": null, "callbacks_on_evaluate_start": null, "callbacks_on_evaluate_end": null, "callbacks_on_evaluate_offline_start": null, "callbacks_on_evaluate_offline_end": null, "callbacks_on_sample_end": null, "callbacks_on_train_result": null, "explore": true, "enable_rl_module_and_learner": true, "enable_env_runner_and_connector_v2": true, "_prior_exploration_config": {"type": "StochasticSampling"}, "count_steps_by": "env_steps", "policy_map_capacity": 100, "policy_mapping_fn": "<function AlgorithmConfig.DEFAULT_POLICY_MAPPING_FN at 0x13e6b9b20>", "policies_to_train": null, "policy_states_are_swappable": false, "observation_fn": null, "offline_data_class": null, "input_read_method": "read_parquet", "input_read_method_kwargs": {}, "input_read_schema": {}, "input_read_episodes": false, "input_read_sample_batches": false, "input_read_batch_size": null, "input_filesystem": null, "input_filesystem_kwargs": {}, "input_compress_columns": ["obs", "new_obs"], "input_spaces_jsonable": true, "materialize_data": false, "materialize_mapped_data": true, "map_batches_kwargs": {}, "iter_batches_kwargs": {}, "ignore_final_observation": false, "prelearner_class": null, "prelearner_buffer_class": null, "prelearner_buffer_kwargs": {}, "prelearner_module_synch_period": 10, "dataset_num_iters_per_learner": null, "input_config": {}, "actions_in_input_normalized": false, "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_config": {}, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "output_max_rows_per_file": null, "output_write_remaining_data": false, "output_write_method": "write_parquet", "output_write_method_kwargs": {}, "output_filesystem": null, "output_filesystem_kwargs": {}, "output_write_episodes": true, "offline_sampling": false, "evaluation_interval": 1, "evaluation_duration": 20, "evaluation_duration_unit": "episodes", "evaluation_sample_timeout_s": 120.0, "evaluation_auto_duration_min_env_steps_per_sample": 100, "evaluation_auto_duration_max_env_steps_per_sample": 2000, "evaluation_parallel_to_training": false, "evaluation_force_reset_envs_before_iteration": true, "evaluation_config": null, "off_policy_estimation_methods": {}, "ope_split_batch_by_episode": true, "evaluation_num_env_runners": 1, "in_evaluation": false, "sync_filters_on_rollout_workers_timeout_s": 10.0, "offline_evaluation_interval": null, "num_offline_eval_runners": 0, "offline_loss_for_module_fn": null, "offline_evaluation_duration": 1, "offline_evaluation_parallel_to_training": false, "offline_evaluation_timeout_s": 120.0, "num_cpus_per_offline_eval_runner": 1, "num_gpus_per_offline_eval_runner": 0, "custom_resources_per_offline_eval_runner": {}, "restart_failed_offline_eval_runners": true, "ignore_offline_eval_runner_failures": false, "max_num_offline_eval_runner_restarts": 1000, "offline_eval_runner_restore_timeout_s": 1800.0, "max_requests_in_flight_per_offline_eval_runner": 1, "validate_offline_eval_runners_after_construction": true, "offline_eval_runner_health_probe_timeout_s": 30.0, "offline_eval_rl_module_inference_only": false, "broadcast_offline_eval_runner_states": false, "offline_eval_batch_size_per_runner": 256, "dataset_num_iters_per_eval_runner": 1, "keep_per_episode_custom_metrics": false, "metrics_episode_collection_timeout_s": 60.0, "metrics_num_episodes_for_smoothing": 100, "min_time_s_per_iteration": null, "min_train_timesteps_per_iteration": 0, "min_sample_timesteps_per_iteration": 0, "log_gradients": true, "export_native_model_files": false, "checkpoint_trainable_policies_only": false, "logger_creator": null, "logger_config": null, "log_level": "WARN", "log_sys_usage": true, "fake_sampler": false, "seed": 10, "restart_failed_env_runners": true, "ignore_env_runner_failures": false, "max_num_env_runner_restarts": 1000, "delay_between_env_runner_restarts_s": 60.0, "restart_failed_sub_environments": false, "num_consecutive_env_runner_failures_tolerance": 100, "env_runner_health_probe_timeout_s": 30.0, "env_runner_restore_timeout_s": 1800.0, "_model_config": {}, "_rl_module_spec": "RLModuleSpec(module_class=None, observation_space=None, action_space=None, inference_only=False, learner_only=False, model_config=DefaultModelConfig(fcnet_hiddens=[60, 90], fcnet_activation='tanh', fcnet_kernel_initializer=None, fcnet_kernel_initializer_kwargs=None, fcnet_bias_initializer=None, fcnet_bias_initializer_kwargs=None, conv_filters=None, conv_activation='relu', conv_kernel_initializer=None, conv_kernel_initializer_kwargs=None, conv_bias_initializer=None, conv_bias_initializer_kwargs=None, head_fcnet_hiddens=[], head_fcnet_activation='relu', head_fcnet_kernel_initializer=None, head_fcnet_kernel_initializer_kwargs=None, head_fcnet_bias_initializer=None, head_fcnet_bias_initializer_kwargs=None, free_log_std=False, log_std_clip_param=20.0, vf_share_layers=True, use_lstm=False, max_seq_len=20, lstm_cell_size=256, lstm_use_prev_action=False, lstm_use_prev_reward=False, lstm_kernel_initializer=None, lstm_kernel_initializer_kwargs=None, lstm_bias_initializer=None, lstm_bias_initializer_kwargs=None), catalog_class=None, load_state_path=None, model_config_dict=None)", "algorithm_config_overrides_per_module": {}, "_per_module_overrides": {}, "_validate_config": true, "_use_msgpack_checkpoints": false, "_torch_grad_scaler_class": null, "_torch_lr_scheduler_classes": null, "_tf_policy_handles_more_than_one_loss": false, "_disable_preprocessor_api": false, "_disable_action_flattening": false, "_disable_initialize_loss_from_dummy_batch": false, "_dont_auto_sync_env_runner_states": false, "env_task_fn": -1, "enable_connectors": -1, "simple_optimizer": false, "policy_map_cache": -1, "worker_cls": -1, "synchronize_filters": -1, "enable_async_evaluation": -1, "custom_async_evaluation_function": -1, "_enable_rl_module_api": -1, "auto_wrap_old_gym_envs": -1, "always_attach_evaluation_results": -1, "replay_sequence_length": null, "_disable_execution_plan_api": -1, "use_critic": true, "use_gae": true, "use_kl_loss": true, "kl_coeff": 0.7464963036515, "kl_target": 0.0270990929592, "vf_loss_coeff": 0.6688075857018, "entropy_coeff": 0.0090570820258, "clip_param": 0.1221781641624, "vf_clip_param": 0.1027808522125, "entropy_coeff_schedule": null, "lr_schedule": null, "sgd_minibatch_size": -1, "vf_share_layers": -1, "__stdout_file__": null, "__stderr_file__": null, "lambda": 0.9099046732075, "input": "sampler", "policies": {"default_policy": [null, null, null, null]}, "callbacks": "<class 'ray.rllib.callbacks.callbacks.RLlibCallback'>", "create_env_on_driver": false, "custom_eval_function": null, "framework": "torch"}, "time_since_restore": 47.18910312652588, "iterations_since_restore": 15, "perf": {"cpu_util_percent": 76.62, "ram_util_percent": 79.08}}
{"timers": {"training_iteration": 4.364425038609189, "restore_env_runners": 1.3747382535623413e-05, "training_step": 4.364079666365437, "env_runner_sampling_timer": 4.162101572220041, "learner_update_timer": 0.1932856189092551, "synch_weights": 0.0023646103548867732, "restore_eval_env_runners": 1.7422525270984633e-05, "evaluation_iteration": 0.20049117203294414, "synch_eval_env_connectors": 0.0002468050664849845, "synch_env_connectors": 4.602283232160238e-06}, "env_runners": {"weights_seq_no": 15.0, "env_to_module_connector": {"timers": {"connectors": {"add_states_from_episodes_to_batch": 2.7113913281153797e-06, "batch_individual_items": 1.1616170166706345e-05, "add_observations_from_episodes_to_batch": 5.199029043905294e-06, "add_time_dim_to_batch_and_zero_pad": 4.215804060677092e-06, "numpy_to_tensor": 1.763924328136565e-05}}, "connector_pipeline_timer": 7.592658545330186e-05}, "num_env_steps_sampled": 5000.0, "module_episode_returns_mean": {"default_policy": 6.62}, "sample": 0.009652701302142644, "num_module_steps_sampled": {"default_policy": 5000.0}, "num_episodes": 250.0, "module_to_env_connector": {"connector_pipeline_timer": 0.00020724107994975284, "timers": {"connectors": {"tensor_to_numpy": 2.6620973288459087e-05, "get_actions": 8.76806088295132e-05, "un_batch_to_individual_items": 9.342885723963125e-06, "normalize_and_clip_actions": 1.7258320124443067e-05, "listify_data_for_vector_env": 2.054024699247186e-05, "remove_single_ts_time_rank_from_batch": 1.0446994844618483e-06}}}, "time_between_sampling": 0.003142672037291398, "num_env_steps_sampled_lifetime": -8635000.0, "episode_return_mean": 6.62, "episode_return_min": -10.5, "agent_episode_returns_mean": {"default_agent": 6.62}, "episode_duration_sec_mean": 0.00890170232951641, "env_to_module_sum_episodes_length_out": 10.36823839457432, "episode_len_mean": 20.0, "env_reset_timer": 8.943468124364179e-05, "num_agent_steps_sampled_lifetime": {"default_agent": -8635000.0}, "num_episodes_lifetime": -431750.0, "episode_len_max": 20, "rlmodule_inference_timer": 5.8432384260077756e-05, "env_to_module_sum_episodes_length_in": 10.36823839457432, "num_agent_steps_sampled": {"default_agent": 5000.0}, "episode_return_max": 9.5, "episode_len_min": 20, "env_step_timer": 2.9159221794043184e-05, "num_module_steps_sampled_lifetime": {"default_policy": -8635000.0}, "num_env_steps_sampled_lifetime_throughput": 2226.485307888161}, "learners": {"__all_modules__": {"learner_connector": {"timers": {"connectors": {"add_time_dim_to_batch_and_zero_pad": 2.4241886095948685e-05, "add_observations_from_episodes_to_batch": 0.0009525679786432403, "add_states_from_episodes_to_batch": 4.554980994563322e-06, "add_columns_from_episodes_to_train_batch": 0.050423804091692295, "batch_individual_items": 0.05309506476777881, "add_one_ts_to_episodes_and_truncate": 0.01228040970637246, "numpy_to_tensor": 0.0001247044017098533, "general_advantage_estimation": 0.008625908272481867}}, "connector_pipeline_timer": 0.12577102599954765}, "num_env_steps_trained_lifetime": 504000, "num_module_steps_trained": 6000, "num_trainable_parameters": 6003, "learner_connector_sum_episodes_length_in": 5000.0, "num_non_trainable_parameters": 0, "learner_connector_sum_episodes_length_out": 5250.0, "num_env_steps_trained": 31500, "num_module_steps_trained_lifetime": 96000, "num_env_steps_trained_lifetime_throughput": 1018595.4447283817, "num_module_steps_trained_throughput": 194261.63299372114, "num_module_steps_trained_lifetime_throughput": 194145.28571385695}, "default_policy": {"gradients_default_optimizer_global_norm": 0.06061369180679321, "entropy": 0.4997800886631012, "vf_explained_var": -0.011586427688598633, "mean_kl_loss": 0.0011202433379366994, "num_module_steps_trained_lifetime": 96000, "vf_loss": 0.10278083384037018, "default_optimizer_learning_rate": 0.0002847858517, "curr_kl_coeff": 1.1390629879315384e-05, "module_train_batch_size_mean": 1000.0, "num_module_steps_trained": 6000, "num_trainable_parameters": 6003, "weights_seq_no": 16.0, "policy_loss": 0.2098601907491684, "diff_num_grad_updates_vs_sampler_policy": 1.0, "vf_loss_unclipped": 28.64261817932129, "curr_entropy_coeff": 0.0090570820258, "total_loss": 0.2740742564201355, "num_module_steps_trained_lifetime_throughput": 194236.40340880764}}, "num_training_step_calls_per_iteration": 1, "evaluation": {"env_runners": {"episode_len_min": 20, "episode_return_max": 13.5, "num_env_steps_sampled": 400, "sample": 0.1861553558393266, "env_to_module_connector": {"timers": {"connectors": {"add_observations_from_episodes_to_batch": 5.72819498012011e-06, "add_states_from_episodes_to_batch": 2.8844962462791103e-06, "batch_individual_items": 1.4327008982133664e-05, "numpy_to_tensor": 1.79085806075401e-05, "add_time_dim_to_batch_and_zero_pad": 7.463307963156723e-06}}, "connector_pipeline_timer": 9.046563084115397e-05}, "num_episodes": 20, "num_env_steps_sampled_lifetime": 80400, "episode_len_max": 20, "module_to_env_connector": {"timers": {"connectors": {"tensor_to_numpy": 2.705932474003627e-05, "get_actions": 9.39689467081903e-05, "un_batch_to_individual_items": 9.269623366841028e-06, "normalize_and_clip_actions": 1.6485927824197984e-05, "listify_data_for_vector_env": 2.052110036145371e-05, "remove_single_ts_time_rank_from_batch": 1.121196113375948e-06}}, "connector_pipeline_timer": 0.00021390643634613856}, "episode_return_min": -14.5, "env_to_module_sum_episodes_length_out": 10.368238394574323, "num_agent_steps_sampled": {"default_agent": 400}, "module_episode_returns_mean": {"default_policy": 0.05}, "rlmodule_inference_timer": 7.833715204339669e-05, "env_to_module_sum_episodes_length_in": 10.368238394574323, "env_step_timer": 3.178517030808105e-05, "num_agent_steps_sampled_lifetime": {"default_agent": 6400}, "episode_len_mean": 20.0, "env_reset_timer": 0.000676413121627862, "num_module_steps_sampled_lifetime": {"default_policy": 6400}, "num_episodes_lifetime": 320, "num_module_steps_sampled": {"default_policy": 400}, "agent_episode_returns_mean": {"default_agent": 0.05}, "weights_seq_no": 16.0, "episode_return_mean": 0.05, "episode_duration_sec_mean": 0.007293436249019578, "time_between_sampling": 2.9242255896527176}, "num_healthy_workers": 1, "actor_manager_num_outstanding_async_reqs": 0, "num_remote_worker_restarts": 0}, "num_env_steps_sampled_lifetime": -8635000.0, "fault_tolerance": {"num_healthy_workers": 0, "num_remote_worker_restarts": 0}, "env_runner_group": {"actor_manager_num_outstanding_async_reqs": 0}, "done": false, "training_iteration": 16, "trial_id": "49ef3_00000", "date": "2025-08-11_19-31-20", "timestamp": 1754933480, "time_this_iter_s": 3.4434170722961426, "time_total_s": 50.63252019882202, "pid": 23180, "hostname": "Mac", "node_ip": "127.0.0.1", "config": {"exploration_config": {}, "extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "placement_strategy": "PACK", "num_gpus": 0, "_fake_gpus": false, "num_cpus_for_main_process": 2, "eager_tracing": true, "eager_max_retraces": 20, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "torch_compile_learner": false, "torch_compile_learner_what_to_compile": "forward_train", "torch_compile_learner_dynamo_backend": "aot_eager", "torch_compile_learner_dynamo_mode": null, "torch_compile_worker": false, "torch_compile_worker_dynamo_backend": "aot_eager", "torch_compile_worker_dynamo_mode": null, "torch_ddp_kwargs": {}, "torch_skip_nan_gradients": false, "env": "Umbrella", "env_config": {}, "observation_space": null, "action_space": null, "clip_rewards": null, "normalize_actions": true, "clip_actions": false, "_is_atari": null, "disable_env_checking": false, "render_env": false, "action_mask_key": "action_mask", "env_runner_cls": null, "num_env_runners": 0, "create_local_env_runner": true, "num_envs_per_env_runner": 1, "gym_env_vectorize_mode": "SYNC", "num_cpus_per_env_runner": 1, "num_gpus_per_env_runner": 0, "custom_resources_per_env_runner": {}, "validate_env_runners_after_construction": true, "episodes_to_numpy": true, "max_requests_in_flight_per_env_runner": 1, "sample_timeout_s": 60.0, "_env_to_module_connector": null, "add_default_connectors_to_env_to_module_pipeline": true, "_module_to_env_connector": null, "add_default_connectors_to_module_to_env_pipeline": true, "merge_env_runner_states": "training_only", "broadcast_env_runner_states": true, "episode_lookback_horizon": 1, "rollout_fragment_length": "auto", "batch_mode": "complete_episodes", "compress_observations": false, "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "enable_tf1_exec_eagerly": false, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "preprocessor_pref": "deepmind", "observation_filter": "NoFilter", "update_worker_filter_stats": true, "use_worker_filter_stats": true, "sampler_perf_stats_ema_coef": null, "_is_online": true, "num_learners": 0, "num_gpus_per_learner": 0, "num_cpus_per_learner": "auto", "num_aggregator_actors_per_learner": 0, "max_requests_in_flight_per_aggregator_actor": 3, "local_gpu_idx": 0, "max_requests_in_flight_per_learner": 3, "gamma": 1, "lr": 0.0002847858517, "grad_clip": 0.5, "grad_clip_by": "global_norm", "_train_batch_size_per_learner": 5000, "train_batch_size": 4000, "num_epochs": 1, "minibatch_size": 1000, "shuffle_batch_per_epoch": true, "model": {"fcnet_hiddens": [256, 256], "fcnet_activation": "tanh", "fcnet_weights_initializer": null, "fcnet_weights_initializer_config": null, "fcnet_bias_initializer": null, "fcnet_bias_initializer_config": null, "conv_filters": null, "conv_activation": "relu", "conv_kernel_initializer": null, "conv_kernel_initializer_config": null, "conv_bias_initializer": null, "conv_bias_initializer_config": null, "conv_transpose_kernel_initializer": null, "conv_transpose_kernel_initializer_config": null, "conv_transpose_bias_initializer": null, "conv_transpose_bias_initializer_config": null, "post_fcnet_hiddens": [], "post_fcnet_activation": "relu", "post_fcnet_weights_initializer": null, "post_fcnet_weights_initializer_config": null, "post_fcnet_bias_initializer": null, "post_fcnet_bias_initializer_config": null, "free_log_std": false, "log_std_clip_param": 20.0, "no_final_linear": false, "vf_share_layers": false, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "lstm_weights_initializer": null, "lstm_weights_initializer_config": null, "lstm_bias_initializer": null, "lstm_bias_initializer_config": null, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "attention_use_n_prev_actions": 0, "attention_use_n_prev_rewards": 0, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": null, "custom_model_config": {}, "custom_action_dist": null, "custom_preprocessor": null, "encoder_latent_dim": null, "always_check_shapes": false, "lstm_use_prev_action_reward": -1, "_use_default_native_models": -1, "_disable_preprocessor_api": false, "_disable_action_flattening": false}, "_learner_connector": null, "add_default_connectors_to_learner_pipeline": true, "learner_config_dict": {}, "optimizer": {}, "_learner_class": null, "callbacks_on_algorithm_init": null, "callbacks_on_env_runners_recreated": null, "callbacks_on_offline_eval_runners_recreated": null, "callbacks_on_checkpoint_loaded": null, "callbacks_on_environment_created": null, "callbacks_on_episode_created": null, "callbacks_on_episode_start": null, "callbacks_on_episode_step": null, "callbacks_on_episode_end": null, "callbacks_on_evaluate_start": null, "callbacks_on_evaluate_end": null, "callbacks_on_evaluate_offline_start": null, "callbacks_on_evaluate_offline_end": null, "callbacks_on_sample_end": null, "callbacks_on_train_result": null, "explore": true, "enable_rl_module_and_learner": true, "enable_env_runner_and_connector_v2": true, "_prior_exploration_config": {"type": "StochasticSampling"}, "count_steps_by": "env_steps", "policy_map_capacity": 100, "policy_mapping_fn": "<function AlgorithmConfig.DEFAULT_POLICY_MAPPING_FN at 0x13e6b9b20>", "policies_to_train": null, "policy_states_are_swappable": false, "observation_fn": null, "offline_data_class": null, "input_read_method": "read_parquet", "input_read_method_kwargs": {}, "input_read_schema": {}, "input_read_episodes": false, "input_read_sample_batches": false, "input_read_batch_size": null, "input_filesystem": null, "input_filesystem_kwargs": {}, "input_compress_columns": ["obs", "new_obs"], "input_spaces_jsonable": true, "materialize_data": false, "materialize_mapped_data": true, "map_batches_kwargs": {}, "iter_batches_kwargs": {}, "ignore_final_observation": false, "prelearner_class": null, "prelearner_buffer_class": null, "prelearner_buffer_kwargs": {}, "prelearner_module_synch_period": 10, "dataset_num_iters_per_learner": null, "input_config": {}, "actions_in_input_normalized": false, "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_config": {}, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "output_max_rows_per_file": null, "output_write_remaining_data": false, "output_write_method": "write_parquet", "output_write_method_kwargs": {}, "output_filesystem": null, "output_filesystem_kwargs": {}, "output_write_episodes": true, "offline_sampling": false, "evaluation_interval": 1, "evaluation_duration": 20, "evaluation_duration_unit": "episodes", "evaluation_sample_timeout_s": 120.0, "evaluation_auto_duration_min_env_steps_per_sample": 100, "evaluation_auto_duration_max_env_steps_per_sample": 2000, "evaluation_parallel_to_training": false, "evaluation_force_reset_envs_before_iteration": true, "evaluation_config": null, "off_policy_estimation_methods": {}, "ope_split_batch_by_episode": true, "evaluation_num_env_runners": 1, "in_evaluation": false, "sync_filters_on_rollout_workers_timeout_s": 10.0, "offline_evaluation_interval": null, "num_offline_eval_runners": 0, "offline_loss_for_module_fn": null, "offline_evaluation_duration": 1, "offline_evaluation_parallel_to_training": false, "offline_evaluation_timeout_s": 120.0, "num_cpus_per_offline_eval_runner": 1, "num_gpus_per_offline_eval_runner": 0, "custom_resources_per_offline_eval_runner": {}, "restart_failed_offline_eval_runners": true, "ignore_offline_eval_runner_failures": false, "max_num_offline_eval_runner_restarts": 1000, "offline_eval_runner_restore_timeout_s": 1800.0, "max_requests_in_flight_per_offline_eval_runner": 1, "validate_offline_eval_runners_after_construction": true, "offline_eval_runner_health_probe_timeout_s": 30.0, "offline_eval_rl_module_inference_only": false, "broadcast_offline_eval_runner_states": false, "offline_eval_batch_size_per_runner": 256, "dataset_num_iters_per_eval_runner": 1, "keep_per_episode_custom_metrics": false, "metrics_episode_collection_timeout_s": 60.0, "metrics_num_episodes_for_smoothing": 100, "min_time_s_per_iteration": null, "min_train_timesteps_per_iteration": 0, "min_sample_timesteps_per_iteration": 0, "log_gradients": true, "export_native_model_files": false, "checkpoint_trainable_policies_only": false, "logger_creator": null, "logger_config": null, "log_level": "WARN", "log_sys_usage": true, "fake_sampler": false, "seed": 10, "restart_failed_env_runners": true, "ignore_env_runner_failures": false, "max_num_env_runner_restarts": 1000, "delay_between_env_runner_restarts_s": 60.0, "restart_failed_sub_environments": false, "num_consecutive_env_runner_failures_tolerance": 100, "env_runner_health_probe_timeout_s": 30.0, "env_runner_restore_timeout_s": 1800.0, "_model_config": {}, "_rl_module_spec": "RLModuleSpec(module_class=None, observation_space=None, action_space=None, inference_only=False, learner_only=False, model_config=DefaultModelConfig(fcnet_hiddens=[60, 90], fcnet_activation='tanh', fcnet_kernel_initializer=None, fcnet_kernel_initializer_kwargs=None, fcnet_bias_initializer=None, fcnet_bias_initializer_kwargs=None, conv_filters=None, conv_activation='relu', conv_kernel_initializer=None, conv_kernel_initializer_kwargs=None, conv_bias_initializer=None, conv_bias_initializer_kwargs=None, head_fcnet_hiddens=[], head_fcnet_activation='relu', head_fcnet_kernel_initializer=None, head_fcnet_kernel_initializer_kwargs=None, head_fcnet_bias_initializer=None, head_fcnet_bias_initializer_kwargs=None, free_log_std=False, log_std_clip_param=20.0, vf_share_layers=True, use_lstm=False, max_seq_len=20, lstm_cell_size=256, lstm_use_prev_action=False, lstm_use_prev_reward=False, lstm_kernel_initializer=None, lstm_kernel_initializer_kwargs=None, lstm_bias_initializer=None, lstm_bias_initializer_kwargs=None), catalog_class=None, load_state_path=None, model_config_dict=None)", "algorithm_config_overrides_per_module": {}, "_per_module_overrides": {}, "_validate_config": true, "_use_msgpack_checkpoints": false, "_torch_grad_scaler_class": null, "_torch_lr_scheduler_classes": null, "_tf_policy_handles_more_than_one_loss": false, "_disable_preprocessor_api": false, "_disable_action_flattening": false, "_disable_initialize_loss_from_dummy_batch": false, "_dont_auto_sync_env_runner_states": false, "env_task_fn": -1, "enable_connectors": -1, "simple_optimizer": false, "policy_map_cache": -1, "worker_cls": -1, "synchronize_filters": -1, "enable_async_evaluation": -1, "custom_async_evaluation_function": -1, "_enable_rl_module_api": -1, "auto_wrap_old_gym_envs": -1, "always_attach_evaluation_results": -1, "replay_sequence_length": null, "_disable_execution_plan_api": -1, "use_critic": true, "use_gae": true, "use_kl_loss": true, "kl_coeff": 0.7464963036515, "kl_target": 0.0270990929592, "vf_loss_coeff": 0.6688075857018, "entropy_coeff": 0.0090570820258, "clip_param": 0.1221781641624, "vf_clip_param": 0.1027808522125, "entropy_coeff_schedule": null, "lr_schedule": null, "sgd_minibatch_size": -1, "vf_share_layers": -1, "__stdout_file__": null, "__stderr_file__": null, "lambda": 0.9099046732075, "input": "sampler", "policies": {"default_policy": [null, null, null, null]}, "callbacks": "<class 'ray.rllib.callbacks.callbacks.RLlibCallback'>", "create_env_on_driver": false, "custom_eval_function": null, "framework": "torch"}, "time_since_restore": 50.63252019882202, "iterations_since_restore": 16, "perf": {"cpu_util_percent": 80.08000000000001, "ram_util_percent": 80.17999999999999}}
{"timers": {"training_iteration": 4.35121116614279, "restore_env_runners": 1.37399085359981e-05, "training_step": 4.350863350110911, "env_runner_sampling_timer": 4.149703962328402, "learner_update_timer": 0.19251803231014547, "synch_weights": 0.002349268001411443, "restore_eval_env_runners": 1.7618300507330896e-05, "evaluation_iteration": 0.20095804364258027, "synch_eval_env_connectors": 0.0002470915955839942, "synch_env_connectors": 4.658760598247597e-06}, "env_runners": {"weights_seq_no": 16.0, "env_to_module_connector": {"timers": {"connectors": {"add_states_from_episodes_to_batch": 2.77140406904526e-06, "batch_individual_items": 1.2571943236223574e-05, "add_observations_from_episodes_to_batch": 6.027836586104677e-06, "add_time_dim_to_batch_and_zero_pad": 4.3998291408570475e-06, "numpy_to_tensor": 1.8411915992424706e-05}}, "connector_pipeline_timer": 8.031325923374442e-05}, "num_env_steps_sampled": 5000.0, "module_episode_returns_mean": {"default_policy": 7.18}, "sample": 0.01017210206190679, "num_module_steps_sampled": {"default_policy": 5000.0}, "num_episodes": 250.0, "module_to_env_connector": {"connector_pipeline_timer": 0.0002118102383114824, "timers": {"connectors": {"tensor_to_numpy": 2.7322400553843986e-05, "get_actions": 8.870249860503595e-05, "un_batch_to_individual_items": 1.0123545120865163e-05, "normalize_and_clip_actions": 1.7519022981680726e-05, "listify_data_for_vector_env": 2.1288731063740984e-05, "remove_single_ts_time_rank_from_batch": 1.0110573350442472e-06}}}, "time_between_sampling": 0.004299136676120671, "num_env_steps_sampled_lifetime": -9252500.0, "episode_return_mean": 7.18, "episode_return_min": -10.5, "agent_episode_returns_mean": {"default_agent": 7.18}, "episode_duration_sec_mean": 0.00987365066120401, "env_to_module_sum_episodes_length_out": 10.36823839457432, "episode_len_mean": 20.0, "env_reset_timer": 9.253947819538116e-05, "num_agent_steps_sampled_lifetime": {"default_agent": -9252500.0}, "num_episodes_lifetime": -462625.0, "episode_len_max": 20, "rlmodule_inference_timer": 9.15200539998322e-05, "env_to_module_sum_episodes_length_in": 10.36823839457432, "num_agent_steps_sampled": {"default_agent": 5000.0}, "episode_return_max": 9.5, "episode_len_min": 20, "env_step_timer": 2.8592413012898438e-05, "num_module_steps_sampled_lifetime": {"default_policy": -9252500.0}, "num_env_steps_sampled_lifetime_throughput": 2148.5952317270476}, "learners": {"__all_modules__": {"learner_connector": {"timers": {"connectors": {"add_time_dim_to_batch_and_zero_pad": 2.414029717810968e-05, "add_observations_from_episodes_to_batch": 0.0009556197985854579, "add_states_from_episodes_to_batch": 4.549011229885628e-06, "add_columns_from_episodes_to_train_batch": 0.050333601470010376, "batch_individual_items": 0.05293936204026586, "add_one_ts_to_episodes_and_truncate": 0.012243394779424922, "numpy_to_tensor": 0.00012490027787651767, "general_advantage_estimation": 0.008612549609811842}}, "connector_pipeline_timer": 0.12547724866026513}, "num_env_steps_trained_lifetime": 535500, "num_module_steps_trained": 6000, "num_trainable_parameters": 6003, "learner_connector_sum_episodes_length_in": 5000.0, "num_non_trainable_parameters": 0, "learner_connector_sum_episodes_length_out": 5250.0, "num_env_steps_trained": 31500, "num_module_steps_trained_lifetime": 102000, "num_env_steps_trained_lifetime_throughput": 1026010.1294576083, "num_module_steps_trained_throughput": 195661.36932714438, "num_module_steps_trained_lifetime_throughput": 195548.17545903378}, "default_policy": {"gradients_default_optimizer_global_norm": 0.09873435646295547, "entropy": 0.4579978883266449, "vf_explained_var": -0.01027071475982666, "mean_kl_loss": 0.0014901324175298214, "num_module_steps_trained_lifetime": 102000, "vf_loss": 0.10278083384037018, "default_optimizer_learning_rate": 0.0002847858517, "curr_kl_coeff": 5.695314939657692e-06, "module_train_batch_size_mean": 1000.0, "num_module_steps_trained": 6000, "num_trainable_parameters": 6003, "weights_seq_no": 17.0, "policy_loss": 0.08273464441299438, "diff_num_grad_updates_vs_sampler_policy": 1.0, "vf_loss_unclipped": 28.64337730407715, "curr_entropy_coeff": 0.0090570820258, "total_loss": 0.14732712507247925, "num_module_steps_trained_lifetime_throughput": 195612.50286113977}}, "num_training_step_calls_per_iteration": 1, "evaluation": {"env_runners": {"episode_len_min": 20, "episode_return_max": 13.5, "num_env_steps_sampled": 400, "sample": 0.18691558728159846, "env_to_module_connector": {"timers": {"connectors": {"add_observations_from_episodes_to_batch": 2.0696358720637223e-05, "add_states_from_episodes_to_batch": 2.5813525515994184e-06, "batch_individual_items": 1.5772615303782498e-05, "numpy_to_tensor": 2.387059089014128e-05, "add_time_dim_to_batch_and_zero_pad": 4.273188622740142e-06}}, "connector_pipeline_timer": 0.00010846659745404612}, "num_episodes": 20, "num_env_steps_sampled_lifetime": 85400, "episode_len_max": 20, "module_to_env_connector": {"timers": {"connectors": {"tensor_to_numpy": 3.3855039710336846e-05, "get_actions": 0.00010202864290623959, "un_batch_to_individual_items": 9.363941725779296e-06, "normalize_and_clip_actions": 2.1377978889755904e-05, "listify_data_for_vector_env": 2.4700422660295127e-05, "remove_single_ts_time_rank_from_batch": 9.893638193057981e-07}}, "connector_pipeline_timer": 0.00023745858376310693}, "episode_return_min": -14.5, "env_to_module_sum_episodes_length_out": 10.368238394574323, "num_agent_steps_sampled": {"default_agent": 400}, "module_episode_returns_mean": {"default_policy": 0.25}, "rlmodule_inference_timer": 6.833775709948444e-05, "env_to_module_sum_episodes_length_in": 10.368238394574323, "env_step_timer": 3.9043510358783526e-05, "num_agent_steps_sampled_lifetime": {"default_agent": 6800}, "episode_len_mean": 20.0, "env_reset_timer": 0.0006703860798424967, "num_module_steps_sampled_lifetime": {"default_policy": 6800}, "num_episodes_lifetime": 340, "num_module_steps_sampled": {"default_policy": 400}, "agent_episode_returns_mean": {"default_agent": 0.25}, "weights_seq_no": 17.0, "episode_return_mean": 0.25, "episode_duration_sec_mean": 0.00852151250001043, "time_between_sampling": 2.9259379741660996}, "num_healthy_workers": 1, "actor_manager_num_outstanding_async_reqs": 0, "num_remote_worker_restarts": 0}, "num_env_steps_sampled_lifetime": -9252500.0, "fault_tolerance": {"num_healthy_workers": 0, "num_remote_worker_restarts": 0}, "env_runner_group": {"actor_manager_num_outstanding_async_reqs": 0}, "done": false, "training_iteration": 17, "trial_id": "49ef3_00000", "date": "2025-08-11_19-31-24", "timestamp": 1754933484, "time_this_iter_s": 3.315061092376709, "time_total_s": 53.94758129119873, "pid": 23180, "hostname": "Mac", "node_ip": "127.0.0.1", "config": {"exploration_config": {}, "extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "placement_strategy": "PACK", "num_gpus": 0, "_fake_gpus": false, "num_cpus_for_main_process": 2, "eager_tracing": true, "eager_max_retraces": 20, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "torch_compile_learner": false, "torch_compile_learner_what_to_compile": "forward_train", "torch_compile_learner_dynamo_backend": "aot_eager", "torch_compile_learner_dynamo_mode": null, "torch_compile_worker": false, "torch_compile_worker_dynamo_backend": "aot_eager", "torch_compile_worker_dynamo_mode": null, "torch_ddp_kwargs": {}, "torch_skip_nan_gradients": false, "env": "Umbrella", "env_config": {}, "observation_space": null, "action_space": null, "clip_rewards": null, "normalize_actions": true, "clip_actions": false, "_is_atari": null, "disable_env_checking": false, "render_env": false, "action_mask_key": "action_mask", "env_runner_cls": null, "num_env_runners": 0, "create_local_env_runner": true, "num_envs_per_env_runner": 1, "gym_env_vectorize_mode": "SYNC", "num_cpus_per_env_runner": 1, "num_gpus_per_env_runner": 0, "custom_resources_per_env_runner": {}, "validate_env_runners_after_construction": true, "episodes_to_numpy": true, "max_requests_in_flight_per_env_runner": 1, "sample_timeout_s": 60.0, "_env_to_module_connector": null, "add_default_connectors_to_env_to_module_pipeline": true, "_module_to_env_connector": null, "add_default_connectors_to_module_to_env_pipeline": true, "merge_env_runner_states": "training_only", "broadcast_env_runner_states": true, "episode_lookback_horizon": 1, "rollout_fragment_length": "auto", "batch_mode": "complete_episodes", "compress_observations": false, "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "enable_tf1_exec_eagerly": false, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "preprocessor_pref": "deepmind", "observation_filter": "NoFilter", "update_worker_filter_stats": true, "use_worker_filter_stats": true, "sampler_perf_stats_ema_coef": null, "_is_online": true, "num_learners": 0, "num_gpus_per_learner": 0, "num_cpus_per_learner": "auto", "num_aggregator_actors_per_learner": 0, "max_requests_in_flight_per_aggregator_actor": 3, "local_gpu_idx": 0, "max_requests_in_flight_per_learner": 3, "gamma": 1, "lr": 0.0002847858517, "grad_clip": 0.5, "grad_clip_by": "global_norm", "_train_batch_size_per_learner": 5000, "train_batch_size": 4000, "num_epochs": 1, "minibatch_size": 1000, "shuffle_batch_per_epoch": true, "model": {"fcnet_hiddens": [256, 256], "fcnet_activation": "tanh", "fcnet_weights_initializer": null, "fcnet_weights_initializer_config": null, "fcnet_bias_initializer": null, "fcnet_bias_initializer_config": null, "conv_filters": null, "conv_activation": "relu", "conv_kernel_initializer": null, "conv_kernel_initializer_config": null, "conv_bias_initializer": null, "conv_bias_initializer_config": null, "conv_transpose_kernel_initializer": null, "conv_transpose_kernel_initializer_config": null, "conv_transpose_bias_initializer": null, "conv_transpose_bias_initializer_config": null, "post_fcnet_hiddens": [], "post_fcnet_activation": "relu", "post_fcnet_weights_initializer": null, "post_fcnet_weights_initializer_config": null, "post_fcnet_bias_initializer": null, "post_fcnet_bias_initializer_config": null, "free_log_std": false, "log_std_clip_param": 20.0, "no_final_linear": false, "vf_share_layers": false, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "lstm_weights_initializer": null, "lstm_weights_initializer_config": null, "lstm_bias_initializer": null, "lstm_bias_initializer_config": null, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "attention_use_n_prev_actions": 0, "attention_use_n_prev_rewards": 0, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": null, "custom_model_config": {}, "custom_action_dist": null, "custom_preprocessor": null, "encoder_latent_dim": null, "always_check_shapes": false, "lstm_use_prev_action_reward": -1, "_use_default_native_models": -1, "_disable_preprocessor_api": false, "_disable_action_flattening": false}, "_learner_connector": null, "add_default_connectors_to_learner_pipeline": true, "learner_config_dict": {}, "optimizer": {}, "_learner_class": null, "callbacks_on_algorithm_init": null, "callbacks_on_env_runners_recreated": null, "callbacks_on_offline_eval_runners_recreated": null, "callbacks_on_checkpoint_loaded": null, "callbacks_on_environment_created": null, "callbacks_on_episode_created": null, "callbacks_on_episode_start": null, "callbacks_on_episode_step": null, "callbacks_on_episode_end": null, "callbacks_on_evaluate_start": null, "callbacks_on_evaluate_end": null, "callbacks_on_evaluate_offline_start": null, "callbacks_on_evaluate_offline_end": null, "callbacks_on_sample_end": null, "callbacks_on_train_result": null, "explore": true, "enable_rl_module_and_learner": true, "enable_env_runner_and_connector_v2": true, "_prior_exploration_config": {"type": "StochasticSampling"}, "count_steps_by": "env_steps", "policy_map_capacity": 100, "policy_mapping_fn": "<function AlgorithmConfig.DEFAULT_POLICY_MAPPING_FN at 0x13e6b9b20>", "policies_to_train": null, "policy_states_are_swappable": false, "observation_fn": null, "offline_data_class": null, "input_read_method": "read_parquet", "input_read_method_kwargs": {}, "input_read_schema": {}, "input_read_episodes": false, "input_read_sample_batches": false, "input_read_batch_size": null, "input_filesystem": null, "input_filesystem_kwargs": {}, "input_compress_columns": ["obs", "new_obs"], "input_spaces_jsonable": true, "materialize_data": false, "materialize_mapped_data": true, "map_batches_kwargs": {}, "iter_batches_kwargs": {}, "ignore_final_observation": false, "prelearner_class": null, "prelearner_buffer_class": null, "prelearner_buffer_kwargs": {}, "prelearner_module_synch_period": 10, "dataset_num_iters_per_learner": null, "input_config": {}, "actions_in_input_normalized": false, "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_config": {}, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "output_max_rows_per_file": null, "output_write_remaining_data": false, "output_write_method": "write_parquet", "output_write_method_kwargs": {}, "output_filesystem": null, "output_filesystem_kwargs": {}, "output_write_episodes": true, "offline_sampling": false, "evaluation_interval": 1, "evaluation_duration": 20, "evaluation_duration_unit": "episodes", "evaluation_sample_timeout_s": 120.0, "evaluation_auto_duration_min_env_steps_per_sample": 100, "evaluation_auto_duration_max_env_steps_per_sample": 2000, "evaluation_parallel_to_training": false, "evaluation_force_reset_envs_before_iteration": true, "evaluation_config": null, "off_policy_estimation_methods": {}, "ope_split_batch_by_episode": true, "evaluation_num_env_runners": 1, "in_evaluation": false, "sync_filters_on_rollout_workers_timeout_s": 10.0, "offline_evaluation_interval": null, "num_offline_eval_runners": 0, "offline_loss_for_module_fn": null, "offline_evaluation_duration": 1, "offline_evaluation_parallel_to_training": false, "offline_evaluation_timeout_s": 120.0, "num_cpus_per_offline_eval_runner": 1, "num_gpus_per_offline_eval_runner": 0, "custom_resources_per_offline_eval_runner": {}, "restart_failed_offline_eval_runners": true, "ignore_offline_eval_runner_failures": false, "max_num_offline_eval_runner_restarts": 1000, "offline_eval_runner_restore_timeout_s": 1800.0, "max_requests_in_flight_per_offline_eval_runner": 1, "validate_offline_eval_runners_after_construction": true, "offline_eval_runner_health_probe_timeout_s": 30.0, "offline_eval_rl_module_inference_only": false, "broadcast_offline_eval_runner_states": false, "offline_eval_batch_size_per_runner": 256, "dataset_num_iters_per_eval_runner": 1, "keep_per_episode_custom_metrics": false, "metrics_episode_collection_timeout_s": 60.0, "metrics_num_episodes_for_smoothing": 100, "min_time_s_per_iteration": null, "min_train_timesteps_per_iteration": 0, "min_sample_timesteps_per_iteration": 0, "log_gradients": true, "export_native_model_files": false, "checkpoint_trainable_policies_only": false, "logger_creator": null, "logger_config": null, "log_level": "WARN", "log_sys_usage": true, "fake_sampler": false, "seed": 10, "restart_failed_env_runners": true, "ignore_env_runner_failures": false, "max_num_env_runner_restarts": 1000, "delay_between_env_runner_restarts_s": 60.0, "restart_failed_sub_environments": false, "num_consecutive_env_runner_failures_tolerance": 100, "env_runner_health_probe_timeout_s": 30.0, "env_runner_restore_timeout_s": 1800.0, "_model_config": {}, "_rl_module_spec": "RLModuleSpec(module_class=None, observation_space=None, action_space=None, inference_only=False, learner_only=False, model_config=DefaultModelConfig(fcnet_hiddens=[60, 90], fcnet_activation='tanh', fcnet_kernel_initializer=None, fcnet_kernel_initializer_kwargs=None, fcnet_bias_initializer=None, fcnet_bias_initializer_kwargs=None, conv_filters=None, conv_activation='relu', conv_kernel_initializer=None, conv_kernel_initializer_kwargs=None, conv_bias_initializer=None, conv_bias_initializer_kwargs=None, head_fcnet_hiddens=[], head_fcnet_activation='relu', head_fcnet_kernel_initializer=None, head_fcnet_kernel_initializer_kwargs=None, head_fcnet_bias_initializer=None, head_fcnet_bias_initializer_kwargs=None, free_log_std=False, log_std_clip_param=20.0, vf_share_layers=True, use_lstm=False, max_seq_len=20, lstm_cell_size=256, lstm_use_prev_action=False, lstm_use_prev_reward=False, lstm_kernel_initializer=None, lstm_kernel_initializer_kwargs=None, lstm_bias_initializer=None, lstm_bias_initializer_kwargs=None), catalog_class=None, load_state_path=None, model_config_dict=None)", "algorithm_config_overrides_per_module": {}, "_per_module_overrides": {}, "_validate_config": true, "_use_msgpack_checkpoints": false, "_torch_grad_scaler_class": null, "_torch_lr_scheduler_classes": null, "_tf_policy_handles_more_than_one_loss": false, "_disable_preprocessor_api": false, "_disable_action_flattening": false, "_disable_initialize_loss_from_dummy_batch": false, "_dont_auto_sync_env_runner_states": false, "env_task_fn": -1, "enable_connectors": -1, "simple_optimizer": false, "policy_map_cache": -1, "worker_cls": -1, "synchronize_filters": -1, "enable_async_evaluation": -1, "custom_async_evaluation_function": -1, "_enable_rl_module_api": -1, "auto_wrap_old_gym_envs": -1, "always_attach_evaluation_results": -1, "replay_sequence_length": null, "_disable_execution_plan_api": -1, "use_critic": true, "use_gae": true, "use_kl_loss": true, "kl_coeff": 0.7464963036515, "kl_target": 0.0270990929592, "vf_loss_coeff": 0.6688075857018, "entropy_coeff": 0.0090570820258, "clip_param": 0.1221781641624, "vf_clip_param": 0.1027808522125, "entropy_coeff_schedule": null, "lr_schedule": null, "sgd_minibatch_size": -1, "vf_share_layers": -1, "__stdout_file__": null, "__stderr_file__": null, "lambda": 0.9099046732075, "input": "sampler", "policies": {"default_policy": [null, null, null, null]}, "callbacks": "<class 'ray.rllib.callbacks.callbacks.RLlibCallback'>", "create_env_on_driver": false, "custom_eval_function": null, "framework": "torch"}, "time_since_restore": 53.94758129119873, "iterations_since_restore": 17, "perf": {"cpu_util_percent": 78.75, "ram_util_percent": 82.05}}
{"timers": {"training_iteration": 4.334776508651574, "restore_env_runners": 1.3665009344467344e-05, "training_step": 4.334428732859774, "env_runner_sampling_timer": 4.132498430615357, "learner_update_timer": 0.19328868740720737, "synch_weights": 0.0023372715707508417, "restore_eval_env_runners": 1.7508787392914656e-05, "evaluation_iteration": 0.20164455695657357, "synch_eval_env_connectors": 0.0002455690093171354, "synch_env_connectors": 4.6559230343609005e-06}, "env_runners": {"weights_seq_no": 17.0, "env_to_module_connector": {"timers": {"connectors": {"add_states_from_episodes_to_batch": 2.526214116896917e-06, "batch_individual_items": 1.0972013389508358e-05, "add_observations_from_episodes_to_batch": 4.824214839693814e-06, "add_time_dim_to_batch_and_zero_pad": 3.984546991397925e-06, "numpy_to_tensor": 1.633271040422927e-05}}, "connector_pipeline_timer": 7.162338273141011e-05}, "num_env_steps_sampled": 5000.0, "module_episode_returns_mean": {"default_policy": 6.700000000000004}, "sample": 0.009219735265337634, "num_module_steps_sampled": {"default_policy": 5000.0}, "num_episodes": 250.0, "module_to_env_connector": {"connector_pipeline_timer": 0.00019051648923997693, "timers": {"connectors": {"tensor_to_numpy": 2.431608249035513e-05, "get_actions": 7.91215654492537e-05, "un_batch_to_individual_items": 8.900062445310466e-06, "normalize_and_clip_actions": 1.590115006232705e-05, "listify_data_for_vector_env": 1.940446761923605e-05, "remove_single_ts_time_rank_from_batch": 9.588519686926763e-07}}}, "time_between_sampling": 0.00287955725282794, "num_env_steps_sampled_lifetime": -9870000.0, "episode_return_mean": 6.700000000000004, "episode_return_min": -10.5, "agent_episode_returns_mean": {"default_agent": 6.700000000000004}, "episode_duration_sec_mean": 0.00811979102063924, "env_to_module_sum_episodes_length_out": 10.36823839457432, "episode_len_mean": 20.0, "env_reset_timer": 8.67701252461256e-05, "num_agent_steps_sampled_lifetime": {"default_agent": -9870000.0}, "num_episodes_lifetime": -493500.0, "episode_len_max": 20, "rlmodule_inference_timer": 5.288744496896047e-05, "env_to_module_sum_episodes_length_in": 10.36823839457432, "num_agent_steps_sampled": {"default_agent": 5000.0}, "episode_return_max": 9.5, "episode_len_min": 20, "env_step_timer": 2.565119073451498e-05, "num_module_steps_sampled_lifetime": {"default_policy": -9870000.0}, "num_env_steps_sampled_lifetime_throughput": 2366.8091590689455}, "learners": {"__all_modules__": {"learner_connector": {"timers": {"connectors": {"add_time_dim_to_batch_and_zero_pad": 2.4210974580316138e-05, "add_observations_from_episodes_to_batch": 0.0009543123502543433, "add_states_from_episodes_to_batch": 4.587690559420864e-06, "add_columns_from_episodes_to_train_batch": 0.05037596420537591, "batch_individual_items": 0.05403625633979804, "add_one_ts_to_episodes_and_truncate": 0.01219902541091449, "numpy_to_tensor": 0.0001248958550052592, "general_advantage_estimation": 0.008613263703935368}}, "connector_pipeline_timer": 0.12657107242360235}, "num_env_steps_trained_lifetime": 567000, "num_module_steps_trained": 6000, "num_trainable_parameters": 6003, "learner_connector_sum_episodes_length_in": 5000.0, "num_non_trainable_parameters": 0, "learner_connector_sum_episodes_length_out": 5250.0, "num_env_steps_trained": 31500, "num_module_steps_trained_lifetime": 108000, "num_env_steps_trained_lifetime_throughput": 1030782.5095572977, "num_module_steps_trained_throughput": 196567.4352414179, "num_module_steps_trained_lifetime_throughput": 196452.82412131512}, "default_policy": {"gradients_default_optimizer_global_norm": 0.05914563685655594, "entropy": 0.43784546852111816, "vf_explained_var": -0.008368968963623047, "mean_kl_loss": 0.00018082500901073217, "num_module_steps_trained_lifetime": 108000, "vf_loss": 0.10278083384037018, "default_optimizer_learning_rate": 0.0002847858517, "curr_kl_coeff": 2.847657469828846e-06, "module_train_batch_size_mean": 1000.0, "num_module_steps_trained": 6000, "num_trainable_parameters": 6003, "weights_seq_no": 18.0, "policy_loss": -0.11194947361946106, "diff_num_grad_updates_vs_sampler_policy": 1.0, "vf_loss_unclipped": 28.636436462402344, "curr_entropy_coeff": 0.0090570820258, "total_loss": -0.04717446491122246, "num_module_steps_trained_lifetime_throughput": 196500.91413281622}}, "num_training_step_calls_per_iteration": 1, "evaluation": {"env_runners": {"episode_len_min": 20, "episode_return_max": 13.5, "num_env_steps_sampled": 400, "sample": 0.18672303806809426, "env_to_module_connector": {"timers": {"connectors": {"add_observations_from_episodes_to_batch": 3.8025927790652342e-06, "add_states_from_episodes_to_batch": 1.977535921743452e-06, "batch_individual_items": 8.47279364527301e-06, "numpy_to_tensor": 1.2456628089920545e-05, "add_time_dim_to_batch_and_zero_pad": 2.90853208202555e-06}}, "connector_pipeline_timer": 5.6670930046953146e-05}, "num_episodes": 20, "num_env_steps_sampled_lifetime": 90400, "episode_len_max": 20, "module_to_env_connector": {"timers": {"connectors": {"tensor_to_numpy": 1.894049969082824e-05, "get_actions": 5.764344810688231e-05, "un_batch_to_individual_items": 7.214059617409178e-06, "normalize_and_clip_actions": 1.2971904079112213e-05, "listify_data_for_vector_env": 1.458021200834373e-05, "remove_single_ts_time_rank_from_batch": 7.213051555214513e-07}}, "connector_pipeline_timer": 0.00014564117035335304}, "episode_return_min": -14.5, "env_to_module_sum_episodes_length_out": 10.368238394574323, "num_agent_steps_sampled": {"default_agent": 400}, "module_episode_returns_mean": {"default_policy": 0.05}, "rlmodule_inference_timer": 4.174500627054684e-05, "env_to_module_sum_episodes_length_in": 10.368238394574323, "env_step_timer": 2.0142149617815744e-05, "num_agent_steps_sampled_lifetime": {"default_agent": 7200}, "episode_len_mean": 20.0, "env_reset_timer": 0.0006654380589562925, "num_module_steps_sampled_lifetime": {"default_policy": 7200}, "num_episodes_lifetime": 360, "num_module_steps_sampled": {"default_policy": 400}, "agent_episode_returns_mean": {"default_agent": 0.05}, "weights_seq_no": 18.0, "episode_return_mean": 0.05, "episode_duration_sec_mean": 0.008768322902033105, "time_between_sampling": 2.9241654627540177}, "num_healthy_workers": 1, "actor_manager_num_outstanding_async_reqs": 0, "num_remote_worker_restarts": 0}, "num_env_steps_sampled_lifetime": -9870000.0, "fault_tolerance": {"num_healthy_workers": 0, "num_remote_worker_restarts": 0}, "env_runner_group": {"actor_manager_num_outstanding_async_reqs": 0}, "done": false, "training_iteration": 18, "trial_id": "49ef3_00000", "date": "2025-08-11_19-31-27", "timestamp": 1754933487, "time_this_iter_s": 2.895109176635742, "time_total_s": 56.84269046783447, "pid": 23180, "hostname": "Mac", "node_ip": "127.0.0.1", "config": {"exploration_config": {}, "extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "placement_strategy": "PACK", "num_gpus": 0, "_fake_gpus": false, "num_cpus_for_main_process": 2, "eager_tracing": true, "eager_max_retraces": 20, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "torch_compile_learner": false, "torch_compile_learner_what_to_compile": "forward_train", "torch_compile_learner_dynamo_backend": "aot_eager", "torch_compile_learner_dynamo_mode": null, "torch_compile_worker": false, "torch_compile_worker_dynamo_backend": "aot_eager", "torch_compile_worker_dynamo_mode": null, "torch_ddp_kwargs": {}, "torch_skip_nan_gradients": false, "env": "Umbrella", "env_config": {}, "observation_space": null, "action_space": null, "clip_rewards": null, "normalize_actions": true, "clip_actions": false, "_is_atari": null, "disable_env_checking": false, "render_env": false, "action_mask_key": "action_mask", "env_runner_cls": null, "num_env_runners": 0, "create_local_env_runner": true, "num_envs_per_env_runner": 1, "gym_env_vectorize_mode": "SYNC", "num_cpus_per_env_runner": 1, "num_gpus_per_env_runner": 0, "custom_resources_per_env_runner": {}, "validate_env_runners_after_construction": true, "episodes_to_numpy": true, "max_requests_in_flight_per_env_runner": 1, "sample_timeout_s": 60.0, "_env_to_module_connector": null, "add_default_connectors_to_env_to_module_pipeline": true, "_module_to_env_connector": null, "add_default_connectors_to_module_to_env_pipeline": true, "merge_env_runner_states": "training_only", "broadcast_env_runner_states": true, "episode_lookback_horizon": 1, "rollout_fragment_length": "auto", "batch_mode": "complete_episodes", "compress_observations": false, "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "enable_tf1_exec_eagerly": false, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "preprocessor_pref": "deepmind", "observation_filter": "NoFilter", "update_worker_filter_stats": true, "use_worker_filter_stats": true, "sampler_perf_stats_ema_coef": null, "_is_online": true, "num_learners": 0, "num_gpus_per_learner": 0, "num_cpus_per_learner": "auto", "num_aggregator_actors_per_learner": 0, "max_requests_in_flight_per_aggregator_actor": 3, "local_gpu_idx": 0, "max_requests_in_flight_per_learner": 3, "gamma": 1, "lr": 0.0002847858517, "grad_clip": 0.5, "grad_clip_by": "global_norm", "_train_batch_size_per_learner": 5000, "train_batch_size": 4000, "num_epochs": 1, "minibatch_size": 1000, "shuffle_batch_per_epoch": true, "model": {"fcnet_hiddens": [256, 256], "fcnet_activation": "tanh", "fcnet_weights_initializer": null, "fcnet_weights_initializer_config": null, "fcnet_bias_initializer": null, "fcnet_bias_initializer_config": null, "conv_filters": null, "conv_activation": "relu", "conv_kernel_initializer": null, "conv_kernel_initializer_config": null, "conv_bias_initializer": null, "conv_bias_initializer_config": null, "conv_transpose_kernel_initializer": null, "conv_transpose_kernel_initializer_config": null, "conv_transpose_bias_initializer": null, "conv_transpose_bias_initializer_config": null, "post_fcnet_hiddens": [], "post_fcnet_activation": "relu", "post_fcnet_weights_initializer": null, "post_fcnet_weights_initializer_config": null, "post_fcnet_bias_initializer": null, "post_fcnet_bias_initializer_config": null, "free_log_std": false, "log_std_clip_param": 20.0, "no_final_linear": false, "vf_share_layers": false, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "lstm_weights_initializer": null, "lstm_weights_initializer_config": null, "lstm_bias_initializer": null, "lstm_bias_initializer_config": null, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "attention_use_n_prev_actions": 0, "attention_use_n_prev_rewards": 0, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": null, "custom_model_config": {}, "custom_action_dist": null, "custom_preprocessor": null, "encoder_latent_dim": null, "always_check_shapes": false, "lstm_use_prev_action_reward": -1, "_use_default_native_models": -1, "_disable_preprocessor_api": false, "_disable_action_flattening": false}, "_learner_connector": null, "add_default_connectors_to_learner_pipeline": true, "learner_config_dict": {}, "optimizer": {}, "_learner_class": null, "callbacks_on_algorithm_init": null, "callbacks_on_env_runners_recreated": null, "callbacks_on_offline_eval_runners_recreated": null, "callbacks_on_checkpoint_loaded": null, "callbacks_on_environment_created": null, "callbacks_on_episode_created": null, "callbacks_on_episode_start": null, "callbacks_on_episode_step": null, "callbacks_on_episode_end": null, "callbacks_on_evaluate_start": null, "callbacks_on_evaluate_end": null, "callbacks_on_evaluate_offline_start": null, "callbacks_on_evaluate_offline_end": null, "callbacks_on_sample_end": null, "callbacks_on_train_result": null, "explore": true, "enable_rl_module_and_learner": true, "enable_env_runner_and_connector_v2": true, "_prior_exploration_config": {"type": "StochasticSampling"}, "count_steps_by": "env_steps", "policy_map_capacity": 100, "policy_mapping_fn": "<function AlgorithmConfig.DEFAULT_POLICY_MAPPING_FN at 0x13e6b9b20>", "policies_to_train": null, "policy_states_are_swappable": false, "observation_fn": null, "offline_data_class": null, "input_read_method": "read_parquet", "input_read_method_kwargs": {}, "input_read_schema": {}, "input_read_episodes": false, "input_read_sample_batches": false, "input_read_batch_size": null, "input_filesystem": null, "input_filesystem_kwargs": {}, "input_compress_columns": ["obs", "new_obs"], "input_spaces_jsonable": true, "materialize_data": false, "materialize_mapped_data": true, "map_batches_kwargs": {}, "iter_batches_kwargs": {}, "ignore_final_observation": false, "prelearner_class": null, "prelearner_buffer_class": null, "prelearner_buffer_kwargs": {}, "prelearner_module_synch_period": 10, "dataset_num_iters_per_learner": null, "input_config": {}, "actions_in_input_normalized": false, "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_config": {}, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "output_max_rows_per_file": null, "output_write_remaining_data": false, "output_write_method": "write_parquet", "output_write_method_kwargs": {}, "output_filesystem": null, "output_filesystem_kwargs": {}, "output_write_episodes": true, "offline_sampling": false, "evaluation_interval": 1, "evaluation_duration": 20, "evaluation_duration_unit": "episodes", "evaluation_sample_timeout_s": 120.0, "evaluation_auto_duration_min_env_steps_per_sample": 100, "evaluation_auto_duration_max_env_steps_per_sample": 2000, "evaluation_parallel_to_training": false, "evaluation_force_reset_envs_before_iteration": true, "evaluation_config": null, "off_policy_estimation_methods": {}, "ope_split_batch_by_episode": true, "evaluation_num_env_runners": 1, "in_evaluation": false, "sync_filters_on_rollout_workers_timeout_s": 10.0, "offline_evaluation_interval": null, "num_offline_eval_runners": 0, "offline_loss_for_module_fn": null, "offline_evaluation_duration": 1, "offline_evaluation_parallel_to_training": false, "offline_evaluation_timeout_s": 120.0, "num_cpus_per_offline_eval_runner": 1, "num_gpus_per_offline_eval_runner": 0, "custom_resources_per_offline_eval_runner": {}, "restart_failed_offline_eval_runners": true, "ignore_offline_eval_runner_failures": false, "max_num_offline_eval_runner_restarts": 1000, "offline_eval_runner_restore_timeout_s": 1800.0, "max_requests_in_flight_per_offline_eval_runner": 1, "validate_offline_eval_runners_after_construction": true, "offline_eval_runner_health_probe_timeout_s": 30.0, "offline_eval_rl_module_inference_only": false, "broadcast_offline_eval_runner_states": false, "offline_eval_batch_size_per_runner": 256, "dataset_num_iters_per_eval_runner": 1, "keep_per_episode_custom_metrics": false, "metrics_episode_collection_timeout_s": 60.0, "metrics_num_episodes_for_smoothing": 100, "min_time_s_per_iteration": null, "min_train_timesteps_per_iteration": 0, "min_sample_timesteps_per_iteration": 0, "log_gradients": true, "export_native_model_files": false, "checkpoint_trainable_policies_only": false, "logger_creator": null, "logger_config": null, "log_level": "WARN", "log_sys_usage": true, "fake_sampler": false, "seed": 10, "restart_failed_env_runners": true, "ignore_env_runner_failures": false, "max_num_env_runner_restarts": 1000, "delay_between_env_runner_restarts_s": 60.0, "restart_failed_sub_environments": false, "num_consecutive_env_runner_failures_tolerance": 100, "env_runner_health_probe_timeout_s": 30.0, "env_runner_restore_timeout_s": 1800.0, "_model_config": {}, "_rl_module_spec": "RLModuleSpec(module_class=None, observation_space=None, action_space=None, inference_only=False, learner_only=False, model_config=DefaultModelConfig(fcnet_hiddens=[60, 90], fcnet_activation='tanh', fcnet_kernel_initializer=None, fcnet_kernel_initializer_kwargs=None, fcnet_bias_initializer=None, fcnet_bias_initializer_kwargs=None, conv_filters=None, conv_activation='relu', conv_kernel_initializer=None, conv_kernel_initializer_kwargs=None, conv_bias_initializer=None, conv_bias_initializer_kwargs=None, head_fcnet_hiddens=[], head_fcnet_activation='relu', head_fcnet_kernel_initializer=None, head_fcnet_kernel_initializer_kwargs=None, head_fcnet_bias_initializer=None, head_fcnet_bias_initializer_kwargs=None, free_log_std=False, log_std_clip_param=20.0, vf_share_layers=True, use_lstm=False, max_seq_len=20, lstm_cell_size=256, lstm_use_prev_action=False, lstm_use_prev_reward=False, lstm_kernel_initializer=None, lstm_kernel_initializer_kwargs=None, lstm_bias_initializer=None, lstm_bias_initializer_kwargs=None), catalog_class=None, load_state_path=None, model_config_dict=None)", "algorithm_config_overrides_per_module": {}, "_per_module_overrides": {}, "_validate_config": true, "_use_msgpack_checkpoints": false, "_torch_grad_scaler_class": null, "_torch_lr_scheduler_classes": null, "_tf_policy_handles_more_than_one_loss": false, "_disable_preprocessor_api": false, "_disable_action_flattening": false, "_disable_initialize_loss_from_dummy_batch": false, "_dont_auto_sync_env_runner_states": false, "env_task_fn": -1, "enable_connectors": -1, "simple_optimizer": false, "policy_map_cache": -1, "worker_cls": -1, "synchronize_filters": -1, "enable_async_evaluation": -1, "custom_async_evaluation_function": -1, "_enable_rl_module_api": -1, "auto_wrap_old_gym_envs": -1, "always_attach_evaluation_results": -1, "replay_sequence_length": null, "_disable_execution_plan_api": -1, "use_critic": true, "use_gae": true, "use_kl_loss": true, "kl_coeff": 0.7464963036515, "kl_target": 0.0270990929592, "vf_loss_coeff": 0.6688075857018, "entropy_coeff": 0.0090570820258, "clip_param": 0.1221781641624, "vf_clip_param": 0.1027808522125, "entropy_coeff_schedule": null, "lr_schedule": null, "sgd_minibatch_size": -1, "vf_share_layers": -1, "__stdout_file__": null, "__stderr_file__": null, "lambda": 0.9099046732075, "input": "sampler", "policies": {"default_policy": [null, null, null, null]}, "callbacks": "<class 'ray.rllib.callbacks.callbacks.RLlibCallback'>", "create_env_on_driver": false, "custom_eval_function": null, "framework": "torch"}, "time_since_restore": 56.84269046783447, "iterations_since_restore": 18, "perf": {"cpu_util_percent": 76.46, "ram_util_percent": 81.04}}
{"timers": {"training_iteration": 4.318964997725863, "restore_env_runners": 1.3615439075902436e-05, "training_step": 4.318618489280505, "env_runner_sampling_timer": 4.115726017558863, "learner_update_timer": 0.1943007701238886, "synch_weights": 0.002321471775337812, "restore_eval_env_runners": 1.74970302155087e-05, "evaluation_iteration": 0.20139332221691586, "synch_eval_env_connectors": 0.00024699623936063925, "synch_env_connectors": 4.654773928602324e-06}, "env_runners": {"weights_seq_no": 18.0, "env_to_module_connector": {"timers": {"connectors": {"add_states_from_episodes_to_batch": 2.54471600574157e-06, "batch_individual_items": 1.1917006677361536e-05, "add_observations_from_episodes_to_batch": 4.8920143509578305e-06, "add_time_dim_to_batch_and_zero_pad": 4.024706288993523e-06, "numpy_to_tensor": 1.671896841129492e-05}}, "connector_pipeline_timer": 7.33961231436715e-05}, "num_env_steps_sampled": 5000.0, "module_episode_returns_mean": {"default_policy": 7.659999999999997}, "sample": 0.008856134507073076, "num_module_steps_sampled": {"default_policy": 5000.0}, "num_episodes": 250.0, "module_to_env_connector": {"connector_pipeline_timer": 0.0001900212840461181, "timers": {"connectors": {"tensor_to_numpy": 2.342720062049087e-05, "get_actions": 7.997397198294418e-05, "un_batch_to_individual_items": 8.836445977774502e-06, "normalize_and_clip_actions": 1.5585463926282543e-05, "listify_data_for_vector_env": 1.9221026959639207e-05, "remove_single_ts_time_rank_from_batch": 1.044111390939027e-06}}}, "time_between_sampling": 0.0028955202902129465, "num_env_steps_sampled_lifetime": -10487500.0, "episode_return_mean": 7.659999999999997, "episode_return_min": -10.5, "agent_episode_returns_mean": {"default_agent": 7.659999999999997}, "episode_duration_sec_mean": 0.008237839483190332, "env_to_module_sum_episodes_length_out": 10.36823839457432, "episode_len_mean": 20.0, "env_reset_timer": 8.084057952857725e-05, "num_agent_steps_sampled_lifetime": {"default_agent": -10487500.0}, "num_episodes_lifetime": -524375.0, "episode_len_max": 20, "rlmodule_inference_timer": 5.4947727481056685e-05, "env_to_module_sum_episodes_length_in": 10.36823839457432, "num_agent_steps_sampled": {"default_agent": 5000.0}, "episode_return_max": 9.5, "episode_len_min": 20, "env_step_timer": 2.7863094585421785e-05, "num_module_steps_sampled_lifetime": {"default_policy": -10487500.0}, "num_env_steps_sampled_lifetime_throughput": 2363.6696641061503}, "learners": {"__all_modules__": {"learner_connector": {"timers": {"connectors": {"add_time_dim_to_batch_and_zero_pad": 2.4091365185211803e-05, "add_observations_from_episodes_to_batch": 0.0009897146365060912, "add_states_from_episodes_to_batch": 4.575983879089297e-06, "add_columns_from_episodes_to_train_batch": 0.0504247204025487, "batch_individual_items": 0.055307362526638475, "add_one_ts_to_episodes_and_truncate": 0.012309258487336614, "numpy_to_tensor": 0.00012448272586963388, "general_advantage_estimation": 0.008603847316937512}}, "connector_pipeline_timer": 0.12802606919948695}, "num_env_steps_trained_lifetime": 598500, "num_module_steps_trained": 6000, "num_trainable_parameters": 6003, "learner_connector_sum_episodes_length_in": 5000.0, "num_non_trainable_parameters": 0, "learner_connector_sum_episodes_length_out": 5250.0, "num_env_steps_trained": 31500, "num_module_steps_trained_lifetime": 114000, "num_env_steps_trained_lifetime_throughput": 1039159.4244849535, "num_module_steps_trained_throughput": 198149.94077763704, "num_module_steps_trained_lifetime_throughput": 198037.50524412445}, "default_policy": {"gradients_default_optimizer_global_norm": 0.0536673404276371, "entropy": 0.44391682744026184, "vf_explained_var": -0.009635567665100098, "mean_kl_loss": 1.3710978237213567e-05, "num_module_steps_trained_lifetime": 114000, "vf_loss": 0.10278083384037018, "default_optimizer_learning_rate": 0.0002847858517, "curr_kl_coeff": 1.423828734914423e-06, "module_train_batch_size_mean": 1000.0, "num_module_steps_trained": 6000, "num_trainable_parameters": 6003, "weights_seq_no": 19.0, "policy_loss": 0.09650514274835587, "diff_num_grad_updates_vs_sampler_policy": 1.0, "vf_loss_unclipped": 28.636056900024414, "curr_entropy_coeff": 0.0090570820258, "total_loss": 0.16122514009475708, "num_module_steps_trained_lifetime_throughput": 198062.81547840225}}, "num_training_step_calls_per_iteration": 1, "evaluation": {"env_runners": {"episode_len_min": 20, "episode_return_max": 13.5, "num_env_steps_sampled": 400, "sample": 0.18686275518804452, "env_to_module_connector": {"timers": {"connectors": {"add_observations_from_episodes_to_batch": 5.003471377705434e-06, "add_states_from_episodes_to_batch": 2.2138605773695564e-06, "batch_individual_items": 1.2238257857933646e-05, "numpy_to_tensor": 1.5492122083679957e-05, "add_time_dim_to_batch_and_zero_pad": 3.6076597767374103e-06}}, "connector_pipeline_timer": 7.300268622664685e-05}, "num_episodes": 20, "num_env_steps_sampled_lifetime": 95400, "episode_len_max": 20, "module_to_env_connector": {"timers": {"connectors": {"tensor_to_numpy": 2.439131997301849e-05, "get_actions": 8.194326431108537e-05, "un_batch_to_individual_items": 9.163220926140966e-06, "normalize_and_clip_actions": 1.5877120090513076e-05, "listify_data_for_vector_env": 1.9784789165982822e-05, "remove_single_ts_time_rank_from_batch": 9.341048217262486e-07}}, "connector_pipeline_timer": 0.00019596970299868557}, "episode_return_min": -14.5, "env_to_module_sum_episodes_length_out": 10.368238394574323, "num_agent_steps_sampled": {"default_agent": 400}, "module_episode_returns_mean": {"default_policy": -0.55}, "rlmodule_inference_timer": 5.4153592467675534e-05, "env_to_module_sum_episodes_length_in": 10.368238394574323, "env_step_timer": 2.818820822009277e-05, "num_agent_steps_sampled_lifetime": {"default_agent": 7600}, "episode_len_mean": 20.0, "env_reset_timer": 0.0006595232683987558, "num_module_steps_sampled_lifetime": {"default_policy": 7600}, "num_episodes_lifetime": 380, "num_module_steps_sampled": {"default_policy": 400}, "agent_episode_returns_mean": {"default_agent": -0.55}, "weights_seq_no": 19.0, "episode_return_mean": -0.55, "episode_duration_sec_mean": 0.009399622472701595, "time_between_sampling": 2.92271963228588}, "num_healthy_workers": 1, "actor_manager_num_outstanding_async_reqs": 0, "num_remote_worker_restarts": 0}, "num_env_steps_sampled_lifetime": -10487500.0, "fault_tolerance": {"num_healthy_workers": 0, "num_remote_worker_restarts": 0}, "env_runner_group": {"actor_manager_num_outstanding_async_reqs": 0}, "done": false, "training_iteration": 19, "trial_id": "49ef3_00000", "date": "2025-08-11_19-31-30", "timestamp": 1754933490, "time_this_iter_s": 2.9623639583587646, "time_total_s": 59.80505442619324, "pid": 23180, "hostname": "Mac", "node_ip": "127.0.0.1", "config": {"exploration_config": {}, "extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "placement_strategy": "PACK", "num_gpus": 0, "_fake_gpus": false, "num_cpus_for_main_process": 2, "eager_tracing": true, "eager_max_retraces": 20, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "torch_compile_learner": false, "torch_compile_learner_what_to_compile": "forward_train", "torch_compile_learner_dynamo_backend": "aot_eager", "torch_compile_learner_dynamo_mode": null, "torch_compile_worker": false, "torch_compile_worker_dynamo_backend": "aot_eager", "torch_compile_worker_dynamo_mode": null, "torch_ddp_kwargs": {}, "torch_skip_nan_gradients": false, "env": "Umbrella", "env_config": {}, "observation_space": null, "action_space": null, "clip_rewards": null, "normalize_actions": true, "clip_actions": false, "_is_atari": null, "disable_env_checking": false, "render_env": false, "action_mask_key": "action_mask", "env_runner_cls": null, "num_env_runners": 0, "create_local_env_runner": true, "num_envs_per_env_runner": 1, "gym_env_vectorize_mode": "SYNC", "num_cpus_per_env_runner": 1, "num_gpus_per_env_runner": 0, "custom_resources_per_env_runner": {}, "validate_env_runners_after_construction": true, "episodes_to_numpy": true, "max_requests_in_flight_per_env_runner": 1, "sample_timeout_s": 60.0, "_env_to_module_connector": null, "add_default_connectors_to_env_to_module_pipeline": true, "_module_to_env_connector": null, "add_default_connectors_to_module_to_env_pipeline": true, "merge_env_runner_states": "training_only", "broadcast_env_runner_states": true, "episode_lookback_horizon": 1, "rollout_fragment_length": "auto", "batch_mode": "complete_episodes", "compress_observations": false, "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "enable_tf1_exec_eagerly": false, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "preprocessor_pref": "deepmind", "observation_filter": "NoFilter", "update_worker_filter_stats": true, "use_worker_filter_stats": true, "sampler_perf_stats_ema_coef": null, "_is_online": true, "num_learners": 0, "num_gpus_per_learner": 0, "num_cpus_per_learner": "auto", "num_aggregator_actors_per_learner": 0, "max_requests_in_flight_per_aggregator_actor": 3, "local_gpu_idx": 0, "max_requests_in_flight_per_learner": 3, "gamma": 1, "lr": 0.0002847858517, "grad_clip": 0.5, "grad_clip_by": "global_norm", "_train_batch_size_per_learner": 5000, "train_batch_size": 4000, "num_epochs": 1, "minibatch_size": 1000, "shuffle_batch_per_epoch": true, "model": {"fcnet_hiddens": [256, 256], "fcnet_activation": "tanh", "fcnet_weights_initializer": null, "fcnet_weights_initializer_config": null, "fcnet_bias_initializer": null, "fcnet_bias_initializer_config": null, "conv_filters": null, "conv_activation": "relu", "conv_kernel_initializer": null, "conv_kernel_initializer_config": null, "conv_bias_initializer": null, "conv_bias_initializer_config": null, "conv_transpose_kernel_initializer": null, "conv_transpose_kernel_initializer_config": null, "conv_transpose_bias_initializer": null, "conv_transpose_bias_initializer_config": null, "post_fcnet_hiddens": [], "post_fcnet_activation": "relu", "post_fcnet_weights_initializer": null, "post_fcnet_weights_initializer_config": null, "post_fcnet_bias_initializer": null, "post_fcnet_bias_initializer_config": null, "free_log_std": false, "log_std_clip_param": 20.0, "no_final_linear": false, "vf_share_layers": false, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "lstm_weights_initializer": null, "lstm_weights_initializer_config": null, "lstm_bias_initializer": null, "lstm_bias_initializer_config": null, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "attention_use_n_prev_actions": 0, "attention_use_n_prev_rewards": 0, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": null, "custom_model_config": {}, "custom_action_dist": null, "custom_preprocessor": null, "encoder_latent_dim": null, "always_check_shapes": false, "lstm_use_prev_action_reward": -1, "_use_default_native_models": -1, "_disable_preprocessor_api": false, "_disable_action_flattening": false}, "_learner_connector": null, "add_default_connectors_to_learner_pipeline": true, "learner_config_dict": {}, "optimizer": {}, "_learner_class": null, "callbacks_on_algorithm_init": null, "callbacks_on_env_runners_recreated": null, "callbacks_on_offline_eval_runners_recreated": null, "callbacks_on_checkpoint_loaded": null, "callbacks_on_environment_created": null, "callbacks_on_episode_created": null, "callbacks_on_episode_start": null, "callbacks_on_episode_step": null, "callbacks_on_episode_end": null, "callbacks_on_evaluate_start": null, "callbacks_on_evaluate_end": null, "callbacks_on_evaluate_offline_start": null, "callbacks_on_evaluate_offline_end": null, "callbacks_on_sample_end": null, "callbacks_on_train_result": null, "explore": true, "enable_rl_module_and_learner": true, "enable_env_runner_and_connector_v2": true, "_prior_exploration_config": {"type": "StochasticSampling"}, "count_steps_by": "env_steps", "policy_map_capacity": 100, "policy_mapping_fn": "<function AlgorithmConfig.DEFAULT_POLICY_MAPPING_FN at 0x13e6b9b20>", "policies_to_train": null, "policy_states_are_swappable": false, "observation_fn": null, "offline_data_class": null, "input_read_method": "read_parquet", "input_read_method_kwargs": {}, "input_read_schema": {}, "input_read_episodes": false, "input_read_sample_batches": false, "input_read_batch_size": null, "input_filesystem": null, "input_filesystem_kwargs": {}, "input_compress_columns": ["obs", "new_obs"], "input_spaces_jsonable": true, "materialize_data": false, "materialize_mapped_data": true, "map_batches_kwargs": {}, "iter_batches_kwargs": {}, "ignore_final_observation": false, "prelearner_class": null, "prelearner_buffer_class": null, "prelearner_buffer_kwargs": {}, "prelearner_module_synch_period": 10, "dataset_num_iters_per_learner": null, "input_config": {}, "actions_in_input_normalized": false, "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_config": {}, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "output_max_rows_per_file": null, "output_write_remaining_data": false, "output_write_method": "write_parquet", "output_write_method_kwargs": {}, "output_filesystem": null, "output_filesystem_kwargs": {}, "output_write_episodes": true, "offline_sampling": false, "evaluation_interval": 1, "evaluation_duration": 20, "evaluation_duration_unit": "episodes", "evaluation_sample_timeout_s": 120.0, "evaluation_auto_duration_min_env_steps_per_sample": 100, "evaluation_auto_duration_max_env_steps_per_sample": 2000, "evaluation_parallel_to_training": false, "evaluation_force_reset_envs_before_iteration": true, "evaluation_config": null, "off_policy_estimation_methods": {}, "ope_split_batch_by_episode": true, "evaluation_num_env_runners": 1, "in_evaluation": false, "sync_filters_on_rollout_workers_timeout_s": 10.0, "offline_evaluation_interval": null, "num_offline_eval_runners": 0, "offline_loss_for_module_fn": null, "offline_evaluation_duration": 1, "offline_evaluation_parallel_to_training": false, "offline_evaluation_timeout_s": 120.0, "num_cpus_per_offline_eval_runner": 1, "num_gpus_per_offline_eval_runner": 0, "custom_resources_per_offline_eval_runner": {}, "restart_failed_offline_eval_runners": true, "ignore_offline_eval_runner_failures": false, "max_num_offline_eval_runner_restarts": 1000, "offline_eval_runner_restore_timeout_s": 1800.0, "max_requests_in_flight_per_offline_eval_runner": 1, "validate_offline_eval_runners_after_construction": true, "offline_eval_runner_health_probe_timeout_s": 30.0, "offline_eval_rl_module_inference_only": false, "broadcast_offline_eval_runner_states": false, "offline_eval_batch_size_per_runner": 256, "dataset_num_iters_per_eval_runner": 1, "keep_per_episode_custom_metrics": false, "metrics_episode_collection_timeout_s": 60.0, "metrics_num_episodes_for_smoothing": 100, "min_time_s_per_iteration": null, "min_train_timesteps_per_iteration": 0, "min_sample_timesteps_per_iteration": 0, "log_gradients": true, "export_native_model_files": false, "checkpoint_trainable_policies_only": false, "logger_creator": null, "logger_config": null, "log_level": "WARN", "log_sys_usage": true, "fake_sampler": false, "seed": 10, "restart_failed_env_runners": true, "ignore_env_runner_failures": false, "max_num_env_runner_restarts": 1000, "delay_between_env_runner_restarts_s": 60.0, "restart_failed_sub_environments": false, "num_consecutive_env_runner_failures_tolerance": 100, "env_runner_health_probe_timeout_s": 30.0, "env_runner_restore_timeout_s": 1800.0, "_model_config": {}, "_rl_module_spec": "RLModuleSpec(module_class=None, observation_space=None, action_space=None, inference_only=False, learner_only=False, model_config=DefaultModelConfig(fcnet_hiddens=[60, 90], fcnet_activation='tanh', fcnet_kernel_initializer=None, fcnet_kernel_initializer_kwargs=None, fcnet_bias_initializer=None, fcnet_bias_initializer_kwargs=None, conv_filters=None, conv_activation='relu', conv_kernel_initializer=None, conv_kernel_initializer_kwargs=None, conv_bias_initializer=None, conv_bias_initializer_kwargs=None, head_fcnet_hiddens=[], head_fcnet_activation='relu', head_fcnet_kernel_initializer=None, head_fcnet_kernel_initializer_kwargs=None, head_fcnet_bias_initializer=None, head_fcnet_bias_initializer_kwargs=None, free_log_std=False, log_std_clip_param=20.0, vf_share_layers=True, use_lstm=False, max_seq_len=20, lstm_cell_size=256, lstm_use_prev_action=False, lstm_use_prev_reward=False, lstm_kernel_initializer=None, lstm_kernel_initializer_kwargs=None, lstm_bias_initializer=None, lstm_bias_initializer_kwargs=None), catalog_class=None, load_state_path=None, model_config_dict=None)", "algorithm_config_overrides_per_module": {}, "_per_module_overrides": {}, "_validate_config": true, "_use_msgpack_checkpoints": false, "_torch_grad_scaler_class": null, "_torch_lr_scheduler_classes": null, "_tf_policy_handles_more_than_one_loss": false, "_disable_preprocessor_api": false, "_disable_action_flattening": false, "_disable_initialize_loss_from_dummy_batch": false, "_dont_auto_sync_env_runner_states": false, "env_task_fn": -1, "enable_connectors": -1, "simple_optimizer": false, "policy_map_cache": -1, "worker_cls": -1, "synchronize_filters": -1, "enable_async_evaluation": -1, "custom_async_evaluation_function": -1, "_enable_rl_module_api": -1, "auto_wrap_old_gym_envs": -1, "always_attach_evaluation_results": -1, "replay_sequence_length": null, "_disable_execution_plan_api": -1, "use_critic": true, "use_gae": true, "use_kl_loss": true, "kl_coeff": 0.7464963036515, "kl_target": 0.0270990929592, "vf_loss_coeff": 0.6688075857018, "entropy_coeff": 0.0090570820258, "clip_param": 0.1221781641624, "vf_clip_param": 0.1027808522125, "entropy_coeff_schedule": null, "lr_schedule": null, "sgd_minibatch_size": -1, "vf_share_layers": -1, "__stdout_file__": null, "__stderr_file__": null, "lambda": 0.9099046732075, "input": "sampler", "policies": {"default_policy": [null, null, null, null]}, "callbacks": "<class 'ray.rllib.callbacks.callbacks.RLlibCallback'>", "create_env_on_driver": false, "custom_eval_function": null, "framework": "torch"}, "time_since_restore": 59.80505442619324, "iterations_since_restore": 19, "perf": {"cpu_util_percent": 75.05, "ram_util_percent": 80.625}}
{"timers": {"training_iteration": 4.301294761917853, "restore_env_runners": 1.3539693759792627e-05, "training_step": 4.3009478848083145, "env_runner_sampling_timer": 4.098705871133022, "learner_update_timer": 0.19364240367245353, "synch_weights": 0.0023144574673209183, "restore_eval_env_runners": 1.739622927904277e-05, "evaluation_iteration": 0.2014411160754737, "synch_eval_env_connectors": 0.0002462154469885966, "synch_env_connectors": 4.646146152094988e-06}, "env_runners": {"weights_seq_no": 19.0, "env_to_module_connector": {"timers": {"connectors": {"add_states_from_episodes_to_batch": 2.8701871265031225e-06, "batch_individual_items": 1.1017420307222164e-05, "add_observations_from_episodes_to_batch": 4.8452115732270685e-06, "add_time_dim_to_batch_and_zero_pad": 3.634616792226768e-06, "numpy_to_tensor": 1.6112158562338024e-05}}, "connector_pipeline_timer": 7.128577758862782e-05}, "num_env_steps_sampled": 5000.0, "module_episode_returns_mean": {"default_policy": 6.2200000000000015}, "sample": 0.008616583348993767, "num_module_steps_sampled": {"default_policy": 5000.0}, "num_episodes": 250.0, "module_to_env_connector": {"connector_pipeline_timer": 0.00018433401950352236, "timers": {"connectors": {"tensor_to_numpy": 2.3870363193652155e-05, "get_actions": 7.722148956185388e-05, "un_batch_to_individual_items": 8.85990308279288e-06, "normalize_and_clip_actions": 1.4841024037621363e-05, "listify_data_for_vector_env": 1.8364891018580016e-05, "remove_single_ts_time_rank_from_batch": 9.546971653415422e-07}}}, "time_between_sampling": 0.003112467451065079, "num_env_steps_sampled_lifetime": -11105000.0, "episode_return_mean": 6.2200000000000015, "episode_return_min": -10.5, "agent_episode_returns_mean": {"default_agent": 6.2200000000000015}, "episode_duration_sec_mean": 0.007955362695734948, "env_to_module_sum_episodes_length_out": 10.36823839457432, "episode_len_mean": 20.0, "env_reset_timer": 7.665265248431621e-05, "num_agent_steps_sampled_lifetime": {"default_agent": -11105000.0}, "num_episodes_lifetime": -555250.0, "episode_len_max": 20, "rlmodule_inference_timer": 5.0790147503388274e-05, "env_to_module_sum_episodes_length_in": 10.36823839457432, "num_agent_steps_sampled": {"default_agent": 5000.0}, "episode_return_max": 9.5, "episode_len_min": 20, "env_step_timer": 2.601992535099993e-05, "num_module_steps_sampled_lifetime": {"default_policy": -11105000.0}, "num_env_steps_sampled_lifetime_throughput": 2436.910521298895}, "learners": {"__all_modules__": {"learner_connector": {"timers": {"connectors": {"add_time_dim_to_batch_and_zero_pad": 2.395670146928469e-05, "add_observations_from_episodes_to_batch": 0.0009892349902550987, "add_states_from_episodes_to_batch": 4.567313961832465e-06, "add_columns_from_episodes_to_train_batch": 0.05032017569837666, "batch_individual_items": 0.05524919140085785, "add_one_ts_to_episodes_and_truncate": 0.012310745902291958, "numpy_to_tensor": 0.00012421456961001748, "general_advantage_estimation": 0.008577745514354604}}, "connector_pipeline_timer": 0.12783715100720455}, "num_env_steps_trained_lifetime": 630000, "num_module_steps_trained": 6000, "num_trainable_parameters": 6003, "learner_connector_sum_episodes_length_in": 5000.0, "num_non_trainable_parameters": 0, "learner_connector_sum_episodes_length_out": 5250.0, "num_env_steps_trained": 31500, "num_module_steps_trained_lifetime": 120000, "num_env_steps_trained_lifetime_throughput": 1054032.0705515875, "num_module_steps_trained_throughput": 200975.45732543635, "num_module_steps_trained_lifetime_throughput": 200862.7635171085}, "default_policy": {"gradients_default_optimizer_global_norm": 0.05579276755452156, "entropy": 0.4487060010433197, "vf_explained_var": -0.01161646842956543, "mean_kl_loss": 2.8233316697878763e-05, "num_module_steps_trained_lifetime": 120000, "vf_loss": 0.10278083384037018, "default_optimizer_learning_rate": 0.0002847858517, "curr_kl_coeff": 7.119143674572115e-07, "module_train_batch_size_mean": 1000.0, "num_module_steps_trained": 6000, "num_trainable_parameters": 6003, "weights_seq_no": 20.0, "policy_loss": 0.16226932406425476, "diff_num_grad_updates_vs_sampler_policy": 1.0, "vf_loss_unclipped": 28.659807205200195, "curr_entropy_coeff": 0.0090570820258, "total_loss": 0.2269459366798401, "num_module_steps_trained_lifetime_throughput": 200868.27019667168}}, "num_training_step_calls_per_iteration": 1, "evaluation": {"env_runners": {"episode_len_min": 20, "episode_return_max": 13.5, "num_env_steps_sampled": 400, "sample": 0.1864815338862535, "env_to_module_connector": {"timers": {"connectors": {"add_observations_from_episodes_to_batch": 4.593478572080023e-06, "add_states_from_episodes_to_batch": 2.9534334403173406e-06, "batch_individual_items": 1.2576392907208746e-05, "numpy_to_tensor": 1.55951634919936e-05, "add_time_dim_to_batch_and_zero_pad": 4.47475989861548e-06}}, "connector_pipeline_timer": 7.619521394670504e-05}, "num_episodes": 20, "num_env_steps_sampled_lifetime": 100400, "episode_len_max": 20, "module_to_env_connector": {"timers": {"connectors": {"tensor_to_numpy": 2.7045124945567645e-05, "get_actions": 8.203668752031642e-05, "un_batch_to_individual_items": 1.067936694493316e-05, "normalize_and_clip_actions": 1.6764420435880203e-05, "listify_data_for_vector_env": 2.171292478078726e-05, "remove_single_ts_time_rank_from_batch": 1.0650260856018087e-06}}, "connector_pipeline_timer": 0.00020467978494217897}, "episode_return_min": -14.5, "env_to_module_sum_episodes_length_out": 10.368238394574323, "num_agent_steps_sampled": {"default_agent": 400}, "module_episode_returns_mean": {"default_policy": -0.75}, "rlmodule_inference_timer": 5.9881792846870023e-05, "env_to_module_sum_episodes_length_in": 10.368238394574323, "env_step_timer": 2.8654382510855683e-05, "num_agent_steps_sampled_lifetime": {"default_agent": 8000}, "episode_len_mean": 20.0, "env_reset_timer": 0.0006539138662713694, "num_module_steps_sampled_lifetime": {"default_policy": 8000}, "num_episodes_lifetime": 400, "num_module_steps_sampled": {"default_policy": 400}, "agent_episode_returns_mean": {"default_agent": -0.75}, "weights_seq_no": 20.0, "episode_return_mean": -0.75, "episode_duration_sec_mean": 0.009230472480412573, "time_between_sampling": 2.9192511505422996}, "num_healthy_workers": 1, "actor_manager_num_outstanding_async_reqs": 0, "num_remote_worker_restarts": 0}, "num_env_steps_sampled_lifetime": -11105000.0, "fault_tolerance": {"num_healthy_workers": 0, "num_remote_worker_restarts": 0}, "env_runner_group": {"actor_manager_num_outstanding_async_reqs": 0}, "done": true, "training_iteration": 20, "trial_id": "49ef3_00000", "date": "2025-08-11_19-31-32", "timestamp": 1754933492, "time_this_iter_s": 2.7146358489990234, "time_total_s": 62.51969027519226, "pid": 23180, "hostname": "Mac", "node_ip": "127.0.0.1", "config": {"exploration_config": {}, "extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "placement_strategy": "PACK", "num_gpus": 0, "_fake_gpus": false, "num_cpus_for_main_process": 2, "eager_tracing": true, "eager_max_retraces": 20, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "torch_compile_learner": false, "torch_compile_learner_what_to_compile": "forward_train", "torch_compile_learner_dynamo_backend": "aot_eager", "torch_compile_learner_dynamo_mode": null, "torch_compile_worker": false, "torch_compile_worker_dynamo_backend": "aot_eager", "torch_compile_worker_dynamo_mode": null, "torch_ddp_kwargs": {}, "torch_skip_nan_gradients": false, "env": "Umbrella", "env_config": {}, "observation_space": null, "action_space": null, "clip_rewards": null, "normalize_actions": true, "clip_actions": false, "_is_atari": null, "disable_env_checking": false, "render_env": false, "action_mask_key": "action_mask", "env_runner_cls": null, "num_env_runners": 0, "create_local_env_runner": true, "num_envs_per_env_runner": 1, "gym_env_vectorize_mode": "SYNC", "num_cpus_per_env_runner": 1, "num_gpus_per_env_runner": 0, "custom_resources_per_env_runner": {}, "validate_env_runners_after_construction": true, "episodes_to_numpy": true, "max_requests_in_flight_per_env_runner": 1, "sample_timeout_s": 60.0, "_env_to_module_connector": null, "add_default_connectors_to_env_to_module_pipeline": true, "_module_to_env_connector": null, "add_default_connectors_to_module_to_env_pipeline": true, "merge_env_runner_states": "training_only", "broadcast_env_runner_states": true, "episode_lookback_horizon": 1, "rollout_fragment_length": "auto", "batch_mode": "complete_episodes", "compress_observations": false, "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "enable_tf1_exec_eagerly": false, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "preprocessor_pref": "deepmind", "observation_filter": "NoFilter", "update_worker_filter_stats": true, "use_worker_filter_stats": true, "sampler_perf_stats_ema_coef": null, "_is_online": true, "num_learners": 0, "num_gpus_per_learner": 0, "num_cpus_per_learner": "auto", "num_aggregator_actors_per_learner": 0, "max_requests_in_flight_per_aggregator_actor": 3, "local_gpu_idx": 0, "max_requests_in_flight_per_learner": 3, "gamma": 1, "lr": 0.0002847858517, "grad_clip": 0.5, "grad_clip_by": "global_norm", "_train_batch_size_per_learner": 5000, "train_batch_size": 4000, "num_epochs": 1, "minibatch_size": 1000, "shuffle_batch_per_epoch": true, "model": {"fcnet_hiddens": [256, 256], "fcnet_activation": "tanh", "fcnet_weights_initializer": null, "fcnet_weights_initializer_config": null, "fcnet_bias_initializer": null, "fcnet_bias_initializer_config": null, "conv_filters": null, "conv_activation": "relu", "conv_kernel_initializer": null, "conv_kernel_initializer_config": null, "conv_bias_initializer": null, "conv_bias_initializer_config": null, "conv_transpose_kernel_initializer": null, "conv_transpose_kernel_initializer_config": null, "conv_transpose_bias_initializer": null, "conv_transpose_bias_initializer_config": null, "post_fcnet_hiddens": [], "post_fcnet_activation": "relu", "post_fcnet_weights_initializer": null, "post_fcnet_weights_initializer_config": null, "post_fcnet_bias_initializer": null, "post_fcnet_bias_initializer_config": null, "free_log_std": false, "log_std_clip_param": 20.0, "no_final_linear": false, "vf_share_layers": false, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "lstm_weights_initializer": null, "lstm_weights_initializer_config": null, "lstm_bias_initializer": null, "lstm_bias_initializer_config": null, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "attention_use_n_prev_actions": 0, "attention_use_n_prev_rewards": 0, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": null, "custom_model_config": {}, "custom_action_dist": null, "custom_preprocessor": null, "encoder_latent_dim": null, "always_check_shapes": false, "lstm_use_prev_action_reward": -1, "_use_default_native_models": -1, "_disable_preprocessor_api": false, "_disable_action_flattening": false}, "_learner_connector": null, "add_default_connectors_to_learner_pipeline": true, "learner_config_dict": {}, "optimizer": {}, "_learner_class": null, "callbacks_on_algorithm_init": null, "callbacks_on_env_runners_recreated": null, "callbacks_on_offline_eval_runners_recreated": null, "callbacks_on_checkpoint_loaded": null, "callbacks_on_environment_created": null, "callbacks_on_episode_created": null, "callbacks_on_episode_start": null, "callbacks_on_episode_step": null, "callbacks_on_episode_end": null, "callbacks_on_evaluate_start": null, "callbacks_on_evaluate_end": null, "callbacks_on_evaluate_offline_start": null, "callbacks_on_evaluate_offline_end": null, "callbacks_on_sample_end": null, "callbacks_on_train_result": null, "explore": true, "enable_rl_module_and_learner": true, "enable_env_runner_and_connector_v2": true, "_prior_exploration_config": {"type": "StochasticSampling"}, "count_steps_by": "env_steps", "policy_map_capacity": 100, "policy_mapping_fn": "<function AlgorithmConfig.DEFAULT_POLICY_MAPPING_FN at 0x13e6b9b20>", "policies_to_train": null, "policy_states_are_swappable": false, "observation_fn": null, "offline_data_class": null, "input_read_method": "read_parquet", "input_read_method_kwargs": {}, "input_read_schema": {}, "input_read_episodes": false, "input_read_sample_batches": false, "input_read_batch_size": null, "input_filesystem": null, "input_filesystem_kwargs": {}, "input_compress_columns": ["obs", "new_obs"], "input_spaces_jsonable": true, "materialize_data": false, "materialize_mapped_data": true, "map_batches_kwargs": {}, "iter_batches_kwargs": {}, "ignore_final_observation": false, "prelearner_class": null, "prelearner_buffer_class": null, "prelearner_buffer_kwargs": {}, "prelearner_module_synch_period": 10, "dataset_num_iters_per_learner": null, "input_config": {}, "actions_in_input_normalized": false, "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_config": {}, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "output_max_rows_per_file": null, "output_write_remaining_data": false, "output_write_method": "write_parquet", "output_write_method_kwargs": {}, "output_filesystem": null, "output_filesystem_kwargs": {}, "output_write_episodes": true, "offline_sampling": false, "evaluation_interval": 1, "evaluation_duration": 20, "evaluation_duration_unit": "episodes", "evaluation_sample_timeout_s": 120.0, "evaluation_auto_duration_min_env_steps_per_sample": 100, "evaluation_auto_duration_max_env_steps_per_sample": 2000, "evaluation_parallel_to_training": false, "evaluation_force_reset_envs_before_iteration": true, "evaluation_config": null, "off_policy_estimation_methods": {}, "ope_split_batch_by_episode": true, "evaluation_num_env_runners": 1, "in_evaluation": false, "sync_filters_on_rollout_workers_timeout_s": 10.0, "offline_evaluation_interval": null, "num_offline_eval_runners": 0, "offline_loss_for_module_fn": null, "offline_evaluation_duration": 1, "offline_evaluation_parallel_to_training": false, "offline_evaluation_timeout_s": 120.0, "num_cpus_per_offline_eval_runner": 1, "num_gpus_per_offline_eval_runner": 0, "custom_resources_per_offline_eval_runner": {}, "restart_failed_offline_eval_runners": true, "ignore_offline_eval_runner_failures": false, "max_num_offline_eval_runner_restarts": 1000, "offline_eval_runner_restore_timeout_s": 1800.0, "max_requests_in_flight_per_offline_eval_runner": 1, "validate_offline_eval_runners_after_construction": true, "offline_eval_runner_health_probe_timeout_s": 30.0, "offline_eval_rl_module_inference_only": false, "broadcast_offline_eval_runner_states": false, "offline_eval_batch_size_per_runner": 256, "dataset_num_iters_per_eval_runner": 1, "keep_per_episode_custom_metrics": false, "metrics_episode_collection_timeout_s": 60.0, "metrics_num_episodes_for_smoothing": 100, "min_time_s_per_iteration": null, "min_train_timesteps_per_iteration": 0, "min_sample_timesteps_per_iteration": 0, "log_gradients": true, "export_native_model_files": false, "checkpoint_trainable_policies_only": false, "logger_creator": null, "logger_config": null, "log_level": "WARN", "log_sys_usage": true, "fake_sampler": false, "seed": 10, "restart_failed_env_runners": true, "ignore_env_runner_failures": false, "max_num_env_runner_restarts": 1000, "delay_between_env_runner_restarts_s": 60.0, "restart_failed_sub_environments": false, "num_consecutive_env_runner_failures_tolerance": 100, "env_runner_health_probe_timeout_s": 30.0, "env_runner_restore_timeout_s": 1800.0, "_model_config": {}, "_rl_module_spec": "RLModuleSpec(module_class=None, observation_space=None, action_space=None, inference_only=False, learner_only=False, model_config=DefaultModelConfig(fcnet_hiddens=[60, 90], fcnet_activation='tanh', fcnet_kernel_initializer=None, fcnet_kernel_initializer_kwargs=None, fcnet_bias_initializer=None, fcnet_bias_initializer_kwargs=None, conv_filters=None, conv_activation='relu', conv_kernel_initializer=None, conv_kernel_initializer_kwargs=None, conv_bias_initializer=None, conv_bias_initializer_kwargs=None, head_fcnet_hiddens=[], head_fcnet_activation='relu', head_fcnet_kernel_initializer=None, head_fcnet_kernel_initializer_kwargs=None, head_fcnet_bias_initializer=None, head_fcnet_bias_initializer_kwargs=None, free_log_std=False, log_std_clip_param=20.0, vf_share_layers=True, use_lstm=False, max_seq_len=20, lstm_cell_size=256, lstm_use_prev_action=False, lstm_use_prev_reward=False, lstm_kernel_initializer=None, lstm_kernel_initializer_kwargs=None, lstm_bias_initializer=None, lstm_bias_initializer_kwargs=None), catalog_class=None, load_state_path=None, model_config_dict=None)", "algorithm_config_overrides_per_module": {}, "_per_module_overrides": {}, "_validate_config": true, "_use_msgpack_checkpoints": false, "_torch_grad_scaler_class": null, "_torch_lr_scheduler_classes": null, "_tf_policy_handles_more_than_one_loss": false, "_disable_preprocessor_api": false, "_disable_action_flattening": false, "_disable_initialize_loss_from_dummy_batch": false, "_dont_auto_sync_env_runner_states": false, "env_task_fn": -1, "enable_connectors": -1, "simple_optimizer": false, "policy_map_cache": -1, "worker_cls": -1, "synchronize_filters": -1, "enable_async_evaluation": -1, "custom_async_evaluation_function": -1, "_enable_rl_module_api": -1, "auto_wrap_old_gym_envs": -1, "always_attach_evaluation_results": -1, "replay_sequence_length": null, "_disable_execution_plan_api": -1, "use_critic": true, "use_gae": true, "use_kl_loss": true, "kl_coeff": 0.7464963036515, "kl_target": 0.0270990929592, "vf_loss_coeff": 0.6688075857018, "entropy_coeff": 0.0090570820258, "clip_param": 0.1221781641624, "vf_clip_param": 0.1027808522125, "entropy_coeff_schedule": null, "lr_schedule": null, "sgd_minibatch_size": -1, "vf_share_layers": -1, "__stdout_file__": null, "__stderr_file__": null, "lambda": 0.9099046732075, "input": "sampler", "policies": {"default_policy": [null, null, null, null]}, "callbacks": "<class 'ray.rllib.callbacks.callbacks.RLlibCallback'>", "create_env_on_driver": false, "custom_eval_function": null, "framework": "torch"}, "time_since_restore": 62.51969027519226, "iterations_since_restore": 20, "perf": {"cpu_util_percent": 72.925, "ram_util_percent": 79.80000000000001}}
