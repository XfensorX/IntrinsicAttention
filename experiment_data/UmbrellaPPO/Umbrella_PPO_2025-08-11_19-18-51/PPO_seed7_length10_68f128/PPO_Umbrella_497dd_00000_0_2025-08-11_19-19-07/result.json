{"timers": {"training_iteration": 3.4224810829618946, "restore_env_runners": 3.074994310736656e-05, "training_step": 3.422215541009791, "env_runner_sampling_timer": 3.26713466597721, "learner_update_timer": 0.1491537499241531, "synch_weights": 0.0013662080746144056}, "env_runners": {"module_to_env_connector": {"timers": {"connectors": {"tensor_to_numpy": 3.161270972784937e-05, "listify_data_for_vector_env": 2.5146878662275808e-05, "remove_single_ts_time_rank_from_batch": 1.3268416621536728e-06, "get_actions": 0.00011249266276144793, "normalize_and_clip_actions": 3.032134536780348e-05, "un_batch_to_individual_items": 1.215809896077739e-05}}, "connector_pipeline_timer": 0.00026684711567761805}, "time_between_sampling": 0.0011230603376780137, "num_env_steps_sampled_lifetime": 627500.0, "env_to_module_connector": {"timers": {"connectors": {"add_observations_from_episodes_to_batch": 6.660104278627895e-06, "add_time_dim_to_batch_and_zero_pad": 5.725304249931715e-06, "batch_individual_items": 1.4718217042001744e-05, "numpy_to_tensor": 2.2149425745439328e-05, "add_states_from_episodes_to_batch": 3.033952160822819e-06}}, "connector_pipeline_timer": 9.627145579612098e-05}, "num_module_steps_sampled_lifetime": {"default_policy": 627500.0}, "episode_return_min": -9.5, "weights_seq_no": 0.0, "num_episodes": 250.0, "env_reset_timer": 0.00014042554408722854, "env_to_module_sum_episodes_length_out": 10.191744832559449, "num_env_steps_sampled": 5000.0, "env_step_timer": 3.6261250700251544e-05, "episode_return_mean": 0.17999999999999997, "episode_return_max": 10.5, "episode_len_min": 20, "num_agent_steps_sampled_lifetime": {"default_agent": 627500.0}, "rlmodule_inference_timer": 9.827317522655532e-05, "module_episode_returns_mean": {"default_policy": 0.17999999999999997}, "agent_episode_returns_mean": {"default_agent": 0.17999999999999997}, "num_episodes_lifetime": 31375.0, "num_module_steps_sampled": {"default_policy": 5000.0}, "num_agent_steps_sampled": {"default_agent": 5000.0}, "episode_duration_sec_mean": 0.011054603334981948, "env_to_module_sum_episodes_length_in": 10.191744832559449, "episode_len_max": 20, "episode_len_mean": 20.0, "sample": 0.014957003974600864, "num_env_steps_sampled_lifetime_throughput": 1871.5512600953462}, "learners": {"__all_modules__": {"learner_connector": {"timers": {"connectors": {"numpy_to_tensor": 7.937499321997166e-05, "add_states_from_episodes_to_batch": 3.875000402331352e-06, "add_one_ts_to_episodes_and_truncate": 0.012527834041975439, "general_advantage_estimation": 0.009022917016409338, "batch_individual_items": 0.04303329100366682, "add_columns_from_episodes_to_train_batch": 0.04933662503026426, "add_observations_from_episodes_to_batch": 0.0010477920295670629, "add_time_dim_to_batch_and_zero_pad": 1.2916047126054764e-05}}, "connector_pipeline_timer": 0.11528329201973975}, "num_module_steps_trained_lifetime": 6000, "num_module_steps_trained": 6000, "num_env_steps_trained": 31500, "learner_connector_sum_episodes_length_out": 5250, "learner_connector_sum_episodes_length_in": 5000, "num_env_steps_trained_lifetime": 31500, "num_trainable_parameters": 6003, "num_non_trainable_parameters": 0, "num_env_steps_trained_lifetime_throughput": 1851497.175173276, "num_module_steps_trained_throughput": 354447.4892820906, "num_module_steps_trained_lifetime_throughput": 353807.18321983994}, "default_policy": {"module_train_batch_size_mean": 1000.0, "total_loss": 0.12544988095760345, "vf_explained_var": -0.010670661926269531, "mean_kl_loss": 0.001026108511723578, "num_module_steps_trained_lifetime": 6000, "num_module_steps_trained": 6000, "weights_seq_no": 1.0, "diff_num_grad_updates_vs_sampler_policy": 1.0, "vf_loss": 0.10278083384037018, "curr_kl_coeff": 0.3732481598854065, "curr_entropy_coeff": 0.0090570820258, "vf_loss_unclipped": 28.942136764526367, "default_optimizer_learning_rate": 0.0002847858517, "num_trainable_parameters": 6003, "entropy": 0.6878411173820496, "gradients_default_optimizer_global_norm": 0.12170831859111786, "policy_loss": 0.06217312067747116, "num_module_steps_trained_lifetime_throughput": 355338.38230020925}}, "num_training_step_calls_per_iteration": 1, "num_env_steps_sampled_lifetime": 627500.0, "evaluation": {"env_runners": {"agent_episode_returns_mean": {"default_agent": -2.95}, "episode_len_mean": 20.0, "sample": 0.20152316708117723, "num_env_steps_sampled_lifetime": 5400, "env_reset_timer": 0.00014520797412842512, "env_step_timer": 2.1684191593090054e-05, "rlmodule_inference_timer": 4.5226706589492615e-05, "module_to_env_connector": {"timers": {"connectors": {"remove_single_ts_time_rank_from_batch": 9.676303400379212e-07, "normalize_and_clip_actions": 1.4784664788197723e-05, "tensor_to_numpy": 2.139858324645807e-05, "listify_data_for_vector_env": 1.5641759181336504e-05, "un_batch_to_individual_items": 7.414316763535668e-06, "get_actions": 6.621535517100277e-05}}, "connector_pipeline_timer": 0.00016193534221177423}, "env_to_module_sum_episodes_length_in": 10.216013141322508, "num_agent_steps_sampled": {"default_agent": 400}, "env_to_module_sum_episodes_length_out": 10.216013141322508, "episode_return_mean": -2.95, "episode_len_min": 20, "episode_duration_sec_mean": 0.009187733312137425, "num_module_steps_sampled": {"default_policy": 400}, "env_to_module_connector": {"timers": {"connectors": {"batch_individual_items": 9.096065222393947e-06, "add_observations_from_episodes_to_batch": 3.8106986884023967e-06, "add_time_dim_to_batch_and_zero_pad": 3.3787033471947468e-06, "numpy_to_tensor": 1.4482043695896527e-05, "add_states_from_episodes_to_batch": 2.1022657379601795e-06}}, "connector_pipeline_timer": 6.213405024422932e-05}, "episode_return_min": -11.5, "num_module_steps_sampled_lifetime": {"default_policy": 400}, "weights_seq_no": 1.0, "num_episodes": 20, "num_episodes_lifetime": 20, "episode_len_max": 20, "num_env_steps_sampled": 400, "episode_return_max": 12.5, "num_agent_steps_sampled_lifetime": {"default_agent": 400}, "module_episode_returns_mean": {"default_policy": -2.95}}, "num_healthy_workers": 1, "actor_manager_num_outstanding_async_reqs": 0, "num_remote_worker_restarts": 0}, "fault_tolerance": {"num_healthy_workers": 0, "num_remote_worker_restarts": 0}, "env_runner_group": {"actor_manager_num_outstanding_async_reqs": 0}, "done": false, "training_iteration": 1, "trial_id": "497dd_00000", "date": "2025-08-11_19-33-04", "timestamp": 1754933584, "time_this_iter_s": 3.633349895477295, "time_total_s": 3.633349895477295, "pid": 25863, "hostname": "Mac", "node_ip": "127.0.0.1", "config": {"exploration_config": {}, "extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "placement_strategy": "PACK", "num_gpus": 0, "_fake_gpus": false, "num_cpus_for_main_process": 2, "eager_tracing": true, "eager_max_retraces": 20, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "torch_compile_learner": false, "torch_compile_learner_what_to_compile": "forward_train", "torch_compile_learner_dynamo_backend": "aot_eager", "torch_compile_learner_dynamo_mode": null, "torch_compile_worker": false, "torch_compile_worker_dynamo_backend": "aot_eager", "torch_compile_worker_dynamo_mode": null, "torch_ddp_kwargs": {}, "torch_skip_nan_gradients": false, "env": "Umbrella", "env_config": {}, "observation_space": null, "action_space": null, "clip_rewards": null, "normalize_actions": true, "clip_actions": false, "_is_atari": null, "disable_env_checking": false, "render_env": false, "action_mask_key": "action_mask", "env_runner_cls": null, "num_env_runners": 0, "create_local_env_runner": true, "num_envs_per_env_runner": 1, "gym_env_vectorize_mode": "SYNC", "num_cpus_per_env_runner": 1, "num_gpus_per_env_runner": 0, "custom_resources_per_env_runner": {}, "validate_env_runners_after_construction": true, "episodes_to_numpy": true, "max_requests_in_flight_per_env_runner": 1, "sample_timeout_s": 60.0, "_env_to_module_connector": null, "add_default_connectors_to_env_to_module_pipeline": true, "_module_to_env_connector": null, "add_default_connectors_to_module_to_env_pipeline": true, "merge_env_runner_states": "training_only", "broadcast_env_runner_states": true, "episode_lookback_horizon": 1, "rollout_fragment_length": "auto", "batch_mode": "complete_episodes", "compress_observations": false, "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "enable_tf1_exec_eagerly": false, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "preprocessor_pref": "deepmind", "observation_filter": "NoFilter", "update_worker_filter_stats": true, "use_worker_filter_stats": true, "sampler_perf_stats_ema_coef": null, "_is_online": true, "num_learners": 0, "num_gpus_per_learner": 0, "num_cpus_per_learner": "auto", "num_aggregator_actors_per_learner": 0, "max_requests_in_flight_per_aggregator_actor": 3, "local_gpu_idx": 0, "max_requests_in_flight_per_learner": 3, "gamma": 1, "lr": 0.0002847858517, "grad_clip": 0.5, "grad_clip_by": "global_norm", "_train_batch_size_per_learner": 5000, "train_batch_size": 4000, "num_epochs": 1, "minibatch_size": 1000, "shuffle_batch_per_epoch": true, "model": {"fcnet_hiddens": [256, 256], "fcnet_activation": "tanh", "fcnet_weights_initializer": null, "fcnet_weights_initializer_config": null, "fcnet_bias_initializer": null, "fcnet_bias_initializer_config": null, "conv_filters": null, "conv_activation": "relu", "conv_kernel_initializer": null, "conv_kernel_initializer_config": null, "conv_bias_initializer": null, "conv_bias_initializer_config": null, "conv_transpose_kernel_initializer": null, "conv_transpose_kernel_initializer_config": null, "conv_transpose_bias_initializer": null, "conv_transpose_bias_initializer_config": null, "post_fcnet_hiddens": [], "post_fcnet_activation": "relu", "post_fcnet_weights_initializer": null, "post_fcnet_weights_initializer_config": null, "post_fcnet_bias_initializer": null, "post_fcnet_bias_initializer_config": null, "free_log_std": false, "log_std_clip_param": 20.0, "no_final_linear": false, "vf_share_layers": false, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "lstm_weights_initializer": null, "lstm_weights_initializer_config": null, "lstm_bias_initializer": null, "lstm_bias_initializer_config": null, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "attention_use_n_prev_actions": 0, "attention_use_n_prev_rewards": 0, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": null, "custom_model_config": {}, "custom_action_dist": null, "custom_preprocessor": null, "encoder_latent_dim": null, "always_check_shapes": false, "lstm_use_prev_action_reward": -1, "_use_default_native_models": -1, "_disable_preprocessor_api": false, "_disable_action_flattening": false}, "_learner_connector": null, "add_default_connectors_to_learner_pipeline": true, "learner_config_dict": {}, "optimizer": {}, "_learner_class": null, "callbacks_on_algorithm_init": null, "callbacks_on_env_runners_recreated": null, "callbacks_on_offline_eval_runners_recreated": null, "callbacks_on_checkpoint_loaded": null, "callbacks_on_environment_created": null, "callbacks_on_episode_created": null, "callbacks_on_episode_start": null, "callbacks_on_episode_step": null, "callbacks_on_episode_end": null, "callbacks_on_evaluate_start": null, "callbacks_on_evaluate_end": null, "callbacks_on_evaluate_offline_start": null, "callbacks_on_evaluate_offline_end": null, "callbacks_on_sample_end": null, "callbacks_on_train_result": null, "explore": true, "enable_rl_module_and_learner": true, "enable_env_runner_and_connector_v2": true, "_prior_exploration_config": {"type": "StochasticSampling"}, "count_steps_by": "env_steps", "policy_map_capacity": 100, "policy_mapping_fn": "<function AlgorithmConfig.DEFAULT_POLICY_MAPPING_FN at 0x14ff39b20>", "policies_to_train": null, "policy_states_are_swappable": false, "observation_fn": null, "offline_data_class": null, "input_read_method": "read_parquet", "input_read_method_kwargs": {}, "input_read_schema": {}, "input_read_episodes": false, "input_read_sample_batches": false, "input_read_batch_size": null, "input_filesystem": null, "input_filesystem_kwargs": {}, "input_compress_columns": ["obs", "new_obs"], "input_spaces_jsonable": true, "materialize_data": false, "materialize_mapped_data": true, "map_batches_kwargs": {}, "iter_batches_kwargs": {}, "ignore_final_observation": false, "prelearner_class": null, "prelearner_buffer_class": null, "prelearner_buffer_kwargs": {}, "prelearner_module_synch_period": 10, "dataset_num_iters_per_learner": null, "input_config": {}, "actions_in_input_normalized": false, "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_config": {}, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "output_max_rows_per_file": null, "output_write_remaining_data": false, "output_write_method": "write_parquet", "output_write_method_kwargs": {}, "output_filesystem": null, "output_filesystem_kwargs": {}, "output_write_episodes": true, "offline_sampling": false, "evaluation_interval": 1, "evaluation_duration": 20, "evaluation_duration_unit": "episodes", "evaluation_sample_timeout_s": 120.0, "evaluation_auto_duration_min_env_steps_per_sample": 100, "evaluation_auto_duration_max_env_steps_per_sample": 2000, "evaluation_parallel_to_training": false, "evaluation_force_reset_envs_before_iteration": true, "evaluation_config": null, "off_policy_estimation_methods": {}, "ope_split_batch_by_episode": true, "evaluation_num_env_runners": 1, "in_evaluation": false, "sync_filters_on_rollout_workers_timeout_s": 10.0, "offline_evaluation_interval": null, "num_offline_eval_runners": 0, "offline_loss_for_module_fn": null, "offline_evaluation_duration": 1, "offline_evaluation_parallel_to_training": false, "offline_evaluation_timeout_s": 120.0, "num_cpus_per_offline_eval_runner": 1, "num_gpus_per_offline_eval_runner": 0, "custom_resources_per_offline_eval_runner": {}, "restart_failed_offline_eval_runners": true, "ignore_offline_eval_runner_failures": false, "max_num_offline_eval_runner_restarts": 1000, "offline_eval_runner_restore_timeout_s": 1800.0, "max_requests_in_flight_per_offline_eval_runner": 1, "validate_offline_eval_runners_after_construction": true, "offline_eval_runner_health_probe_timeout_s": 30.0, "offline_eval_rl_module_inference_only": false, "broadcast_offline_eval_runner_states": false, "offline_eval_batch_size_per_runner": 256, "dataset_num_iters_per_eval_runner": 1, "keep_per_episode_custom_metrics": false, "metrics_episode_collection_timeout_s": 60.0, "metrics_num_episodes_for_smoothing": 100, "min_time_s_per_iteration": null, "min_train_timesteps_per_iteration": 0, "min_sample_timesteps_per_iteration": 0, "log_gradients": true, "export_native_model_files": false, "checkpoint_trainable_policies_only": false, "logger_creator": null, "logger_config": null, "log_level": "WARN", "log_sys_usage": true, "fake_sampler": false, "seed": 7, "restart_failed_env_runners": true, "ignore_env_runner_failures": false, "max_num_env_runner_restarts": 1000, "delay_between_env_runner_restarts_s": 60.0, "restart_failed_sub_environments": false, "num_consecutive_env_runner_failures_tolerance": 100, "env_runner_health_probe_timeout_s": 30.0, "env_runner_restore_timeout_s": 1800.0, "_model_config": {}, "_rl_module_spec": "RLModuleSpec(module_class=None, observation_space=None, action_space=None, inference_only=False, learner_only=False, model_config=DefaultModelConfig(fcnet_hiddens=[60, 90], fcnet_activation='tanh', fcnet_kernel_initializer=None, fcnet_kernel_initializer_kwargs=None, fcnet_bias_initializer=None, fcnet_bias_initializer_kwargs=None, conv_filters=None, conv_activation='relu', conv_kernel_initializer=None, conv_kernel_initializer_kwargs=None, conv_bias_initializer=None, conv_bias_initializer_kwargs=None, head_fcnet_hiddens=[], head_fcnet_activation='relu', head_fcnet_kernel_initializer=None, head_fcnet_kernel_initializer_kwargs=None, head_fcnet_bias_initializer=None, head_fcnet_bias_initializer_kwargs=None, free_log_std=False, log_std_clip_param=20.0, vf_share_layers=True, use_lstm=False, max_seq_len=20, lstm_cell_size=256, lstm_use_prev_action=False, lstm_use_prev_reward=False, lstm_kernel_initializer=None, lstm_kernel_initializer_kwargs=None, lstm_bias_initializer=None, lstm_bias_initializer_kwargs=None), catalog_class=None, load_state_path=None, model_config_dict=None)", "algorithm_config_overrides_per_module": {}, "_per_module_overrides": {}, "_validate_config": true, "_use_msgpack_checkpoints": false, "_torch_grad_scaler_class": null, "_torch_lr_scheduler_classes": null, "_tf_policy_handles_more_than_one_loss": false, "_disable_preprocessor_api": false, "_disable_action_flattening": false, "_disable_initialize_loss_from_dummy_batch": false, "_dont_auto_sync_env_runner_states": false, "env_task_fn": -1, "enable_connectors": -1, "simple_optimizer": false, "policy_map_cache": -1, "worker_cls": -1, "synchronize_filters": -1, "enable_async_evaluation": -1, "custom_async_evaluation_function": -1, "_enable_rl_module_api": -1, "auto_wrap_old_gym_envs": -1, "always_attach_evaluation_results": -1, "replay_sequence_length": null, "_disable_execution_plan_api": -1, "use_critic": true, "use_gae": true, "use_kl_loss": true, "kl_coeff": 0.7464963036515, "kl_target": 0.0270990929592, "vf_loss_coeff": 0.6688075857018, "entropy_coeff": 0.0090570820258, "clip_param": 0.1221781641624, "vf_clip_param": 0.1027808522125, "entropy_coeff_schedule": null, "lr_schedule": null, "sgd_minibatch_size": -1, "vf_share_layers": -1, "__stdout_file__": null, "__stderr_file__": null, "lambda": 0.9099046732075, "input": "sampler", "policies": {"default_policy": [null, null, null, null]}, "callbacks": "<class 'ray.rllib.callbacks.callbacks.RLlibCallback'>", "create_env_on_driver": false, "custom_eval_function": null, "framework": "torch"}, "time_since_restore": 3.633349895477295, "iterations_since_restore": 1, "perf": {"cpu_util_percent": 66.06666666666666, "ram_util_percent": 78.2}}
{"timers": {"training_iteration": 3.414495625052368, "restore_env_runners": 3.0692443251609804e-05, "training_step": 3.4142291251791175, "env_runner_sampling_timer": 3.2576957968168427, "learner_update_timer": 0.15062943117460237, "synch_weights": 0.0013595976633951068, "restore_eval_env_runners": 1.0791001841425896e-05, "evaluation_iteration": 0.20912912499625236, "synch_eval_env_connectors": 0.00015729200094938278, "synch_env_connectors": 5.624955520033836e-06}, "env_runners": {"module_to_env_connector": {"timers": {"connectors": {"tensor_to_numpy": 2.2770422885778577e-05, "listify_data_for_vector_env": 1.8460920446367142e-05, "remove_single_ts_time_rank_from_batch": 9.071169960463284e-07, "get_actions": 7.598903881051361e-05, "normalize_and_clip_actions": 1.530577909818287e-05, "un_batch_to_individual_items": 8.65227054638358e-06}}, "connector_pipeline_timer": 0.00018268669506936352}, "time_between_sampling": 0.0026357358073566288, "num_env_steps_sampled_lifetime": 10000.0, "env_to_module_connector": {"timers": {"connectors": {"add_observations_from_episodes_to_batch": 4.660331236805907e-06, "add_time_dim_to_batch_and_zero_pad": 3.990561178684904e-06, "batch_individual_items": 1.1083432743923507e-05, "numpy_to_tensor": 1.580081575426403e-05, "add_states_from_episodes_to_batch": 2.5711747906997346e-06}}, "connector_pipeline_timer": 7.032853511725951e-05}, "num_module_steps_sampled_lifetime": {"default_policy": 10000.0}, "episode_return_min": -9.5, "weights_seq_no": 1.0, "num_episodes": 250.0, "env_reset_timer": 8.49138012368447e-05, "env_to_module_sum_episodes_length_out": 10.36823839457432, "num_env_steps_sampled": 5000.0, "env_step_timer": 2.4679405741258065e-05, "episode_return_mean": 0.3400000000000001, "episode_return_max": 10.5, "episode_len_min": 20, "num_agent_steps_sampled_lifetime": {"default_agent": 10000.0}, "rlmodule_inference_timer": 5.1229562122109094e-05, "module_episode_returns_mean": {"default_policy": 0.3400000000000001}, "agent_episode_returns_mean": {"default_agent": 0.3400000000000001}, "num_episodes_lifetime": 500.0, "num_module_steps_sampled": {"default_policy": 5000.0}, "num_agent_steps_sampled": {"default_agent": 5000.0}, "episode_duration_sec_mean": 0.00771156498650089, "env_to_module_sum_episodes_length_in": 10.36823839457432, "episode_len_max": 20, "episode_len_mean": 20.0, "sample": 0.009747483135528345, "num_env_steps_sampled_lifetime_throughput": 2431.38747925009}, "learners": {"__all_modules__": {"learner_connector": {"timers": {"connectors": {"numpy_to_tensor": 7.938666269183159e-05, "add_states_from_episodes_to_batch": 3.877499839290977e-06, "add_one_ts_to_episodes_and_truncate": 0.012556481951614842, "general_advantage_estimation": 0.00901468742522411, "batch_individual_items": 0.04453925600391812, "add_columns_from_episodes_to_train_batch": 0.04942371878074482, "add_observations_from_episodes_to_batch": 0.0010536874399986117, "add_time_dim_to_batch_and_zero_pad": 1.292772707529366e-05}}, "connector_pipeline_timer": 0.11690272117964924}, "num_module_steps_trained_lifetime": 12000, "num_module_steps_trained": 6000, "num_env_steps_trained": 31500, "learner_connector_sum_episodes_length_out": 5250.0, "learner_connector_sum_episodes_length_in": 5000.0, "num_env_steps_trained_lifetime": 63000, "num_trainable_parameters": 6003, "num_non_trainable_parameters": 0, "num_env_steps_trained_lifetime_throughput": 1847933.1368626347, "num_module_steps_trained_throughput": 353746.2423710417, "num_module_steps_trained_lifetime_throughput": 353113.4367408595}, "default_policy": {"module_train_batch_size_mean": 1000.0, "total_loss": 0.060141224414110184, "vf_explained_var": -0.010760307312011719, "mean_kl_loss": 4.524777614278719e-05, "num_module_steps_trained_lifetime": 12000, "num_module_steps_trained": 6000, "weights_seq_no": 2.0, "diff_num_grad_updates_vs_sampler_policy": 1.0, "vf_loss": 0.10278083384037018, "curr_kl_coeff": 0.18662407994270325, "curr_entropy_coeff": 0.0090570820258, "vf_loss_unclipped": 28.860502243041992, "default_optimizer_learning_rate": 0.0002847858517, "num_trainable_parameters": 6003, "entropy": 0.6892082095146179, "gradients_default_optimizer_global_norm": 0.019594253972172737, "policy_loss": -0.0023740576580166817, "num_module_steps_trained_lifetime_throughput": 354619.17556661856}}, "num_training_step_calls_per_iteration": 1, "evaluation": {"env_runners": {"agent_episode_returns_mean": {"default_agent": -1.45}, "episode_len_mean": 20.0, "sample": 0.20197459041024557, "num_env_steps_sampled_lifetime": 10400, "env_reset_timer": 0.00014473506482318044, "env_step_timer": 2.9066064108631014e-05, "rlmodule_inference_timer": 6.206617316322996e-05, "module_to_env_connector": {"timers": {"connectors": {"remove_single_ts_time_rank_from_batch": 1.0124647974825167e-06, "normalize_and_clip_actions": 1.6680317725420643e-05, "tensor_to_numpy": 2.649162771956988e-05, "listify_data_for_vector_env": 2.0176405094481374e-05, "un_batch_to_individual_items": 1.035235691051142e-05, "get_actions": 8.523695015514899e-05}}, "connector_pipeline_timer": 0.00020495482189372946}, "env_to_module_sum_episodes_length_in": 10.366003441359926, "num_agent_steps_sampled": {"default_agent": 400}, "env_to_module_sum_episodes_length_out": 10.366003441359926, "episode_return_mean": -1.45, "episode_len_min": 20, "episode_duration_sec_mean": 0.010273684380808844, "num_module_steps_sampled": {"default_policy": 400}, "env_to_module_connector": {"timers": {"connectors": {"batch_individual_items": 1.165963527305094e-05, "add_observations_from_episodes_to_batch": 5.463202547321754e-06, "add_time_dim_to_batch_and_zero_pad": 4.3696091382900465e-06, "numpy_to_tensor": 1.843647642982563e-05, "add_states_from_episodes_to_batch": 2.882882466882715e-06}}, "connector_pipeline_timer": 7.859891202795038e-05}, "episode_return_min": -11.5, "num_module_steps_sampled_lifetime": {"default_policy": 800}, "weights_seq_no": 2.0, "num_episodes": 20, "num_episodes_lifetime": 40, "episode_len_max": 20, "num_env_steps_sampled": 400, "episode_return_max": 12.5, "num_agent_steps_sampled_lifetime": {"default_agent": 800}, "module_episode_returns_mean": {"default_policy": -1.45}, "time_between_sampling": 2.6615120000205934}, "num_healthy_workers": 1, "actor_manager_num_outstanding_async_reqs": 0, "num_remote_worker_restarts": 0}, "num_env_steps_sampled_lifetime": 10000.0, "fault_tolerance": {"num_healthy_workers": 0, "num_remote_worker_restarts": 0}, "env_runner_group": {"actor_manager_num_outstanding_async_reqs": 0}, "done": false, "training_iteration": 2, "trial_id": "497dd_00000", "date": "2025-08-11_19-33-07", "timestamp": 1754933587, "time_this_iter_s": 2.878077268600464, "time_total_s": 6.511427164077759, "pid": 25863, "hostname": "Mac", "node_ip": "127.0.0.1", "config": {"exploration_config": {}, "extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "placement_strategy": "PACK", "num_gpus": 0, "_fake_gpus": false, "num_cpus_for_main_process": 2, "eager_tracing": true, "eager_max_retraces": 20, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "torch_compile_learner": false, "torch_compile_learner_what_to_compile": "forward_train", "torch_compile_learner_dynamo_backend": "aot_eager", "torch_compile_learner_dynamo_mode": null, "torch_compile_worker": false, "torch_compile_worker_dynamo_backend": "aot_eager", "torch_compile_worker_dynamo_mode": null, "torch_ddp_kwargs": {}, "torch_skip_nan_gradients": false, "env": "Umbrella", "env_config": {}, "observation_space": null, "action_space": null, "clip_rewards": null, "normalize_actions": true, "clip_actions": false, "_is_atari": null, "disable_env_checking": false, "render_env": false, "action_mask_key": "action_mask", "env_runner_cls": null, "num_env_runners": 0, "create_local_env_runner": true, "num_envs_per_env_runner": 1, "gym_env_vectorize_mode": "SYNC", "num_cpus_per_env_runner": 1, "num_gpus_per_env_runner": 0, "custom_resources_per_env_runner": {}, "validate_env_runners_after_construction": true, "episodes_to_numpy": true, "max_requests_in_flight_per_env_runner": 1, "sample_timeout_s": 60.0, "_env_to_module_connector": null, "add_default_connectors_to_env_to_module_pipeline": true, "_module_to_env_connector": null, "add_default_connectors_to_module_to_env_pipeline": true, "merge_env_runner_states": "training_only", "broadcast_env_runner_states": true, "episode_lookback_horizon": 1, "rollout_fragment_length": "auto", "batch_mode": "complete_episodes", "compress_observations": false, "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "enable_tf1_exec_eagerly": false, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "preprocessor_pref": "deepmind", "observation_filter": "NoFilter", "update_worker_filter_stats": true, "use_worker_filter_stats": true, "sampler_perf_stats_ema_coef": null, "_is_online": true, "num_learners": 0, "num_gpus_per_learner": 0, "num_cpus_per_learner": "auto", "num_aggregator_actors_per_learner": 0, "max_requests_in_flight_per_aggregator_actor": 3, "local_gpu_idx": 0, "max_requests_in_flight_per_learner": 3, "gamma": 1, "lr": 0.0002847858517, "grad_clip": 0.5, "grad_clip_by": "global_norm", "_train_batch_size_per_learner": 5000, "train_batch_size": 4000, "num_epochs": 1, "minibatch_size": 1000, "shuffle_batch_per_epoch": true, "model": {"fcnet_hiddens": [256, 256], "fcnet_activation": "tanh", "fcnet_weights_initializer": null, "fcnet_weights_initializer_config": null, "fcnet_bias_initializer": null, "fcnet_bias_initializer_config": null, "conv_filters": null, "conv_activation": "relu", "conv_kernel_initializer": null, "conv_kernel_initializer_config": null, "conv_bias_initializer": null, "conv_bias_initializer_config": null, "conv_transpose_kernel_initializer": null, "conv_transpose_kernel_initializer_config": null, "conv_transpose_bias_initializer": null, "conv_transpose_bias_initializer_config": null, "post_fcnet_hiddens": [], "post_fcnet_activation": "relu", "post_fcnet_weights_initializer": null, "post_fcnet_weights_initializer_config": null, "post_fcnet_bias_initializer": null, "post_fcnet_bias_initializer_config": null, "free_log_std": false, "log_std_clip_param": 20.0, "no_final_linear": false, "vf_share_layers": false, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "lstm_weights_initializer": null, "lstm_weights_initializer_config": null, "lstm_bias_initializer": null, "lstm_bias_initializer_config": null, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "attention_use_n_prev_actions": 0, "attention_use_n_prev_rewards": 0, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": null, "custom_model_config": {}, "custom_action_dist": null, "custom_preprocessor": null, "encoder_latent_dim": null, "always_check_shapes": false, "lstm_use_prev_action_reward": -1, "_use_default_native_models": -1, "_disable_preprocessor_api": false, "_disable_action_flattening": false}, "_learner_connector": null, "add_default_connectors_to_learner_pipeline": true, "learner_config_dict": {}, "optimizer": {}, "_learner_class": null, "callbacks_on_algorithm_init": null, "callbacks_on_env_runners_recreated": null, "callbacks_on_offline_eval_runners_recreated": null, "callbacks_on_checkpoint_loaded": null, "callbacks_on_environment_created": null, "callbacks_on_episode_created": null, "callbacks_on_episode_start": null, "callbacks_on_episode_step": null, "callbacks_on_episode_end": null, "callbacks_on_evaluate_start": null, "callbacks_on_evaluate_end": null, "callbacks_on_evaluate_offline_start": null, "callbacks_on_evaluate_offline_end": null, "callbacks_on_sample_end": null, "callbacks_on_train_result": null, "explore": true, "enable_rl_module_and_learner": true, "enable_env_runner_and_connector_v2": true, "_prior_exploration_config": {"type": "StochasticSampling"}, "count_steps_by": "env_steps", "policy_map_capacity": 100, "policy_mapping_fn": "<function AlgorithmConfig.DEFAULT_POLICY_MAPPING_FN at 0x14ff39b20>", "policies_to_train": null, "policy_states_are_swappable": false, "observation_fn": null, "offline_data_class": null, "input_read_method": "read_parquet", "input_read_method_kwargs": {}, "input_read_schema": {}, "input_read_episodes": false, "input_read_sample_batches": false, "input_read_batch_size": null, "input_filesystem": null, "input_filesystem_kwargs": {}, "input_compress_columns": ["obs", "new_obs"], "input_spaces_jsonable": true, "materialize_data": false, "materialize_mapped_data": true, "map_batches_kwargs": {}, "iter_batches_kwargs": {}, "ignore_final_observation": false, "prelearner_class": null, "prelearner_buffer_class": null, "prelearner_buffer_kwargs": {}, "prelearner_module_synch_period": 10, "dataset_num_iters_per_learner": null, "input_config": {}, "actions_in_input_normalized": false, "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_config": {}, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "output_max_rows_per_file": null, "output_write_remaining_data": false, "output_write_method": "write_parquet", "output_write_method_kwargs": {}, "output_filesystem": null, "output_filesystem_kwargs": {}, "output_write_episodes": true, "offline_sampling": false, "evaluation_interval": 1, "evaluation_duration": 20, "evaluation_duration_unit": "episodes", "evaluation_sample_timeout_s": 120.0, "evaluation_auto_duration_min_env_steps_per_sample": 100, "evaluation_auto_duration_max_env_steps_per_sample": 2000, "evaluation_parallel_to_training": false, "evaluation_force_reset_envs_before_iteration": true, "evaluation_config": null, "off_policy_estimation_methods": {}, "ope_split_batch_by_episode": true, "evaluation_num_env_runners": 1, "in_evaluation": false, "sync_filters_on_rollout_workers_timeout_s": 10.0, "offline_evaluation_interval": null, "num_offline_eval_runners": 0, "offline_loss_for_module_fn": null, "offline_evaluation_duration": 1, "offline_evaluation_parallel_to_training": false, "offline_evaluation_timeout_s": 120.0, "num_cpus_per_offline_eval_runner": 1, "num_gpus_per_offline_eval_runner": 0, "custom_resources_per_offline_eval_runner": {}, "restart_failed_offline_eval_runners": true, "ignore_offline_eval_runner_failures": false, "max_num_offline_eval_runner_restarts": 1000, "offline_eval_runner_restore_timeout_s": 1800.0, "max_requests_in_flight_per_offline_eval_runner": 1, "validate_offline_eval_runners_after_construction": true, "offline_eval_runner_health_probe_timeout_s": 30.0, "offline_eval_rl_module_inference_only": false, "broadcast_offline_eval_runner_states": false, "offline_eval_batch_size_per_runner": 256, "dataset_num_iters_per_eval_runner": 1, "keep_per_episode_custom_metrics": false, "metrics_episode_collection_timeout_s": 60.0, "metrics_num_episodes_for_smoothing": 100, "min_time_s_per_iteration": null, "min_train_timesteps_per_iteration": 0, "min_sample_timesteps_per_iteration": 0, "log_gradients": true, "export_native_model_files": false, "checkpoint_trainable_policies_only": false, "logger_creator": null, "logger_config": null, "log_level": "WARN", "log_sys_usage": true, "fake_sampler": false, "seed": 7, "restart_failed_env_runners": true, "ignore_env_runner_failures": false, "max_num_env_runner_restarts": 1000, "delay_between_env_runner_restarts_s": 60.0, "restart_failed_sub_environments": false, "num_consecutive_env_runner_failures_tolerance": 100, "env_runner_health_probe_timeout_s": 30.0, "env_runner_restore_timeout_s": 1800.0, "_model_config": {}, "_rl_module_spec": "RLModuleSpec(module_class=None, observation_space=None, action_space=None, inference_only=False, learner_only=False, model_config=DefaultModelConfig(fcnet_hiddens=[60, 90], fcnet_activation='tanh', fcnet_kernel_initializer=None, fcnet_kernel_initializer_kwargs=None, fcnet_bias_initializer=None, fcnet_bias_initializer_kwargs=None, conv_filters=None, conv_activation='relu', conv_kernel_initializer=None, conv_kernel_initializer_kwargs=None, conv_bias_initializer=None, conv_bias_initializer_kwargs=None, head_fcnet_hiddens=[], head_fcnet_activation='relu', head_fcnet_kernel_initializer=None, head_fcnet_kernel_initializer_kwargs=None, head_fcnet_bias_initializer=None, head_fcnet_bias_initializer_kwargs=None, free_log_std=False, log_std_clip_param=20.0, vf_share_layers=True, use_lstm=False, max_seq_len=20, lstm_cell_size=256, lstm_use_prev_action=False, lstm_use_prev_reward=False, lstm_kernel_initializer=None, lstm_kernel_initializer_kwargs=None, lstm_bias_initializer=None, lstm_bias_initializer_kwargs=None), catalog_class=None, load_state_path=None, model_config_dict=None)", "algorithm_config_overrides_per_module": {}, "_per_module_overrides": {}, "_validate_config": true, "_use_msgpack_checkpoints": false, "_torch_grad_scaler_class": null, "_torch_lr_scheduler_classes": null, "_tf_policy_handles_more_than_one_loss": false, "_disable_preprocessor_api": false, "_disable_action_flattening": false, "_disable_initialize_loss_from_dummy_batch": false, "_dont_auto_sync_env_runner_states": false, "env_task_fn": -1, "enable_connectors": -1, "simple_optimizer": false, "policy_map_cache": -1, "worker_cls": -1, "synchronize_filters": -1, "enable_async_evaluation": -1, "custom_async_evaluation_function": -1, "_enable_rl_module_api": -1, "auto_wrap_old_gym_envs": -1, "always_attach_evaluation_results": -1, "replay_sequence_length": null, "_disable_execution_plan_api": -1, "use_critic": true, "use_gae": true, "use_kl_loss": true, "kl_coeff": 0.7464963036515, "kl_target": 0.0270990929592, "vf_loss_coeff": 0.6688075857018, "entropy_coeff": 0.0090570820258, "clip_param": 0.1221781641624, "vf_clip_param": 0.1027808522125, "entropy_coeff_schedule": null, "lr_schedule": null, "sgd_minibatch_size": -1, "vf_share_layers": -1, "__stdout_file__": null, "__stderr_file__": null, "lambda": 0.9099046732075, "input": "sampler", "policies": {"default_policy": [null, null, null, null]}, "callbacks": "<class 'ray.rllib.callbacks.callbacks.RLlibCallback'>", "create_env_on_driver": false, "custom_eval_function": null, "framework": "torch"}, "time_since_restore": 6.511427164077759, "iterations_since_restore": 2, "perf": {"cpu_util_percent": 71.60000000000001, "ram_util_percent": 77.825}}
{"timers": {"training_iteration": 3.4098649700523005, "restore_env_runners": 3.0468439124524595e-05, "training_step": 3.4095981539269093, "env_runner_sampling_timer": 3.2531103109285584, "learner_update_timer": 0.15058863478314596, "synch_weights": 0.0013579779362771658, "restore_eval_env_runners": 1.0777672287076712e-05, "evaluation_iteration": 0.20955899874679745, "synch_eval_env_connectors": 0.0001569465803913772, "synch_env_connectors": 5.631205858662725e-06}, "env_runners": {"module_to_env_connector": {"timers": {"connectors": {"tensor_to_numpy": 2.7458881461683582e-05, "listify_data_for_vector_env": 2.1694282386412193e-05, "remove_single_ts_time_rank_from_batch": 1.0043152372393158e-06, "get_actions": 9.144448323752586e-05, "normalize_and_clip_actions": 1.824836512503525e-05, "un_batch_to_individual_items": 9.940349747459211e-06}}, "connector_pipeline_timer": 0.00021672457710286363}, "time_between_sampling": 0.003304717756126771, "num_env_steps_sampled_lifetime": -607500.0, "env_to_module_connector": {"timers": {"connectors": {"add_observations_from_episodes_to_batch": 5.439016879474404e-06, "add_time_dim_to_batch_and_zero_pad": 4.7185309725883626e-06, "batch_individual_items": 1.325655736045516e-05, "numpy_to_tensor": 1.861365841781773e-05, "add_states_from_episodes_to_batch": 2.8914947499179064e-06}}, "connector_pipeline_timer": 8.145918689115261e-05}, "num_module_steps_sampled_lifetime": {"default_policy": -607500.0}, "episode_return_min": -9.5, "weights_seq_no": 2.0, "num_episodes": 250.0, "env_reset_timer": 8.63508701762947e-05, "env_to_module_sum_episodes_length_out": 10.36823839457432, "num_env_steps_sampled": 5000.0, "env_step_timer": 2.912341016706067e-05, "episode_return_mean": 1.3000000000000003, "episode_return_max": 10.5, "episode_len_min": 20, "num_agent_steps_sampled_lifetime": {"default_agent": -607500.0}, "rlmodule_inference_timer": 5.931680990402085e-05, "module_episode_returns_mean": {"default_policy": 1.3000000000000003}, "agent_episode_returns_mean": {"default_agent": 1.3000000000000003}, "num_episodes_lifetime": -30375.0, "num_module_steps_sampled": {"default_policy": 5000.0}, "num_agent_steps_sampled": {"default_agent": 5000.0}, "episode_duration_sec_mean": 0.009260239029303192, "env_to_module_sum_episodes_length_in": 10.36823839457432, "episode_len_max": 20, "episode_len_mean": 20.0, "sample": 0.009482334064643376, "num_env_steps_sampled_lifetime_throughput": 2094.1841074145677}, "learners": {"__all_modules__": {"learner_connector": {"timers": {"connectors": {"numpy_to_tensor": 7.998196613043547e-05, "add_states_from_episodes_to_batch": 3.874974243808538e-06, "add_one_ts_to_episodes_and_truncate": 0.012594943382230122, "general_advantage_estimation": 0.009015904301370028, "batch_individual_items": 0.04453945511387428, "add_columns_from_episodes_to_train_batch": 0.04945460117349867, "add_observations_from_episodes_to_batch": 0.0010544963947148062, "add_time_dim_to_batch_and_zero_pad": 1.293344966834411e-05}}, "connector_pipeline_timer": 0.1169742497981526}, "num_module_steps_trained_lifetime": 18000, "num_module_steps_trained": 6000, "num_env_steps_trained": 31500, "learner_connector_sum_episodes_length_out": 5250.0, "learner_connector_sum_episodes_length_in": 5000.0, "num_env_steps_trained_lifetime": 94500, "num_trainable_parameters": 6003, "num_non_trainable_parameters": 0, "num_env_steps_trained_lifetime_throughput": 1841277.0376542762, "num_module_steps_trained_throughput": 352432.73601221945, "num_module_steps_trained_lifetime_throughput": 351814.5579656579}, "default_policy": {"module_train_batch_size_mean": 1000.0, "total_loss": 0.3532428741455078, "vf_explained_var": -0.010493040084838867, "mean_kl_loss": 0.0007080155191943049, "num_module_steps_trained_lifetime": 18000, "num_module_steps_trained": 6000, "weights_seq_no": 3.0, "diff_num_grad_updates_vs_sampler_policy": 1.0, "vf_loss": 0.10278083384037018, "curr_kl_coeff": 0.09331203997135162, "curr_entropy_coeff": 0.0090570820258, "vf_loss_unclipped": 29.159080505371094, "default_optimizer_learning_rate": 0.0002847858517, "num_trainable_parameters": 6003, "entropy": 0.684884786605835, "gradients_default_optimizer_global_norm": 0.044358815997838974, "policy_loss": 0.29057320952415466, "num_module_steps_trained_lifetime_throughput": 353264.1175153917}}, "num_training_step_calls_per_iteration": 1, "evaluation": {"env_runners": {"agent_episode_returns_mean": {"default_agent": -0.95}, "episode_len_mean": 20.0, "sample": 0.2018941045065061, "num_env_steps_sampled_lifetime": 15400, "env_reset_timer": 0.000144127714750357, "env_step_timer": 3.974278858012713e-05, "rlmodule_inference_timer": 6.362178477695392e-05, "module_to_env_connector": {"timers": {"connectors": {"remove_single_ts_time_rank_from_batch": 1.3200280028865413e-06, "normalize_and_clip_actions": 2.1929952510448414e-05, "tensor_to_numpy": 2.716378408140379e-05, "listify_data_for_vector_env": 2.65569832373543e-05, "un_batch_to_individual_items": 1.122565031421125e-05, "get_actions": 9.764366623425742e-05}}, "connector_pipeline_timer": 0.00023817343436572817}, "env_to_module_sum_episodes_length_in": 10.368205581254823, "num_agent_steps_sampled": {"default_agent": 400}, "env_to_module_sum_episodes_length_out": 10.368205581254823, "episode_return_mean": -0.95, "episode_len_min": 20, "episode_duration_sec_mean": 0.009819801388463627, "num_module_steps_sampled": {"default_policy": 400}, "env_to_module_connector": {"timers": {"connectors": {"batch_individual_items": 1.3330705697175099e-05, "add_observations_from_episodes_to_batch": 6.036320391773863e-06, "add_time_dim_to_batch_and_zero_pad": 4.534482938085694e-06, "numpy_to_tensor": 1.9103003154682024e-05, "add_states_from_episodes_to_batch": 2.6349301798694982e-06}}, "connector_pipeline_timer": 8.563904837694981e-05}, "episode_return_min": -12.5, "num_module_steps_sampled_lifetime": {"default_policy": 1200}, "weights_seq_no": 3.0, "num_episodes": 20, "num_episodes_lifetime": 60, "episode_len_max": 20, "num_env_steps_sampled": 400, "episode_return_max": 14.5, "num_agent_steps_sampled_lifetime": {"default_agent": 1200}, "module_episode_returns_mean": {"default_policy": -0.95}, "time_between_sampling": 2.66462305668043}, "num_healthy_workers": 1, "actor_manager_num_outstanding_async_reqs": 0, "num_remote_worker_restarts": 0}, "num_env_steps_sampled_lifetime": -607500.0, "fault_tolerance": {"num_healthy_workers": 0, "num_remote_worker_restarts": 0}, "env_runner_group": {"actor_manager_num_outstanding_async_reqs": 0}, "done": false, "training_iteration": 3, "trial_id": "497dd_00000", "date": "2025-08-11_19-33-10", "timestamp": 1754933590, "time_this_iter_s": 3.1553659439086914, "time_total_s": 9.66679310798645, "pid": 25863, "hostname": "Mac", "node_ip": "127.0.0.1", "config": {"exploration_config": {}, "extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "placement_strategy": "PACK", "num_gpus": 0, "_fake_gpus": false, "num_cpus_for_main_process": 2, "eager_tracing": true, "eager_max_retraces": 20, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "torch_compile_learner": false, "torch_compile_learner_what_to_compile": "forward_train", "torch_compile_learner_dynamo_backend": "aot_eager", "torch_compile_learner_dynamo_mode": null, "torch_compile_worker": false, "torch_compile_worker_dynamo_backend": "aot_eager", "torch_compile_worker_dynamo_mode": null, "torch_ddp_kwargs": {}, "torch_skip_nan_gradients": false, "env": "Umbrella", "env_config": {}, "observation_space": null, "action_space": null, "clip_rewards": null, "normalize_actions": true, "clip_actions": false, "_is_atari": null, "disable_env_checking": false, "render_env": false, "action_mask_key": "action_mask", "env_runner_cls": null, "num_env_runners": 0, "create_local_env_runner": true, "num_envs_per_env_runner": 1, "gym_env_vectorize_mode": "SYNC", "num_cpus_per_env_runner": 1, "num_gpus_per_env_runner": 0, "custom_resources_per_env_runner": {}, "validate_env_runners_after_construction": true, "episodes_to_numpy": true, "max_requests_in_flight_per_env_runner": 1, "sample_timeout_s": 60.0, "_env_to_module_connector": null, "add_default_connectors_to_env_to_module_pipeline": true, "_module_to_env_connector": null, "add_default_connectors_to_module_to_env_pipeline": true, "merge_env_runner_states": "training_only", "broadcast_env_runner_states": true, "episode_lookback_horizon": 1, "rollout_fragment_length": "auto", "batch_mode": "complete_episodes", "compress_observations": false, "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "enable_tf1_exec_eagerly": false, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "preprocessor_pref": "deepmind", "observation_filter": "NoFilter", "update_worker_filter_stats": true, "use_worker_filter_stats": true, "sampler_perf_stats_ema_coef": null, "_is_online": true, "num_learners": 0, "num_gpus_per_learner": 0, "num_cpus_per_learner": "auto", "num_aggregator_actors_per_learner": 0, "max_requests_in_flight_per_aggregator_actor": 3, "local_gpu_idx": 0, "max_requests_in_flight_per_learner": 3, "gamma": 1, "lr": 0.0002847858517, "grad_clip": 0.5, "grad_clip_by": "global_norm", "_train_batch_size_per_learner": 5000, "train_batch_size": 4000, "num_epochs": 1, "minibatch_size": 1000, "shuffle_batch_per_epoch": true, "model": {"fcnet_hiddens": [256, 256], "fcnet_activation": "tanh", "fcnet_weights_initializer": null, "fcnet_weights_initializer_config": null, "fcnet_bias_initializer": null, "fcnet_bias_initializer_config": null, "conv_filters": null, "conv_activation": "relu", "conv_kernel_initializer": null, "conv_kernel_initializer_config": null, "conv_bias_initializer": null, "conv_bias_initializer_config": null, "conv_transpose_kernel_initializer": null, "conv_transpose_kernel_initializer_config": null, "conv_transpose_bias_initializer": null, "conv_transpose_bias_initializer_config": null, "post_fcnet_hiddens": [], "post_fcnet_activation": "relu", "post_fcnet_weights_initializer": null, "post_fcnet_weights_initializer_config": null, "post_fcnet_bias_initializer": null, "post_fcnet_bias_initializer_config": null, "free_log_std": false, "log_std_clip_param": 20.0, "no_final_linear": false, "vf_share_layers": false, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "lstm_weights_initializer": null, "lstm_weights_initializer_config": null, "lstm_bias_initializer": null, "lstm_bias_initializer_config": null, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "attention_use_n_prev_actions": 0, "attention_use_n_prev_rewards": 0, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": null, "custom_model_config": {}, "custom_action_dist": null, "custom_preprocessor": null, "encoder_latent_dim": null, "always_check_shapes": false, "lstm_use_prev_action_reward": -1, "_use_default_native_models": -1, "_disable_preprocessor_api": false, "_disable_action_flattening": false}, "_learner_connector": null, "add_default_connectors_to_learner_pipeline": true, "learner_config_dict": {}, "optimizer": {}, "_learner_class": null, "callbacks_on_algorithm_init": null, "callbacks_on_env_runners_recreated": null, "callbacks_on_offline_eval_runners_recreated": null, "callbacks_on_checkpoint_loaded": null, "callbacks_on_environment_created": null, "callbacks_on_episode_created": null, "callbacks_on_episode_start": null, "callbacks_on_episode_step": null, "callbacks_on_episode_end": null, "callbacks_on_evaluate_start": null, "callbacks_on_evaluate_end": null, "callbacks_on_evaluate_offline_start": null, "callbacks_on_evaluate_offline_end": null, "callbacks_on_sample_end": null, "callbacks_on_train_result": null, "explore": true, "enable_rl_module_and_learner": true, "enable_env_runner_and_connector_v2": true, "_prior_exploration_config": {"type": "StochasticSampling"}, "count_steps_by": "env_steps", "policy_map_capacity": 100, "policy_mapping_fn": "<function AlgorithmConfig.DEFAULT_POLICY_MAPPING_FN at 0x14ff39b20>", "policies_to_train": null, "policy_states_are_swappable": false, "observation_fn": null, "offline_data_class": null, "input_read_method": "read_parquet", "input_read_method_kwargs": {}, "input_read_schema": {}, "input_read_episodes": false, "input_read_sample_batches": false, "input_read_batch_size": null, "input_filesystem": null, "input_filesystem_kwargs": {}, "input_compress_columns": ["obs", "new_obs"], "input_spaces_jsonable": true, "materialize_data": false, "materialize_mapped_data": true, "map_batches_kwargs": {}, "iter_batches_kwargs": {}, "ignore_final_observation": false, "prelearner_class": null, "prelearner_buffer_class": null, "prelearner_buffer_kwargs": {}, "prelearner_module_synch_period": 10, "dataset_num_iters_per_learner": null, "input_config": {}, "actions_in_input_normalized": false, "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_config": {}, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "output_max_rows_per_file": null, "output_write_remaining_data": false, "output_write_method": "write_parquet", "output_write_method_kwargs": {}, "output_filesystem": null, "output_filesystem_kwargs": {}, "output_write_episodes": true, "offline_sampling": false, "evaluation_interval": 1, "evaluation_duration": 20, "evaluation_duration_unit": "episodes", "evaluation_sample_timeout_s": 120.0, "evaluation_auto_duration_min_env_steps_per_sample": 100, "evaluation_auto_duration_max_env_steps_per_sample": 2000, "evaluation_parallel_to_training": false, "evaluation_force_reset_envs_before_iteration": true, "evaluation_config": null, "off_policy_estimation_methods": {}, "ope_split_batch_by_episode": true, "evaluation_num_env_runners": 1, "in_evaluation": false, "sync_filters_on_rollout_workers_timeout_s": 10.0, "offline_evaluation_interval": null, "num_offline_eval_runners": 0, "offline_loss_for_module_fn": null, "offline_evaluation_duration": 1, "offline_evaluation_parallel_to_training": false, "offline_evaluation_timeout_s": 120.0, "num_cpus_per_offline_eval_runner": 1, "num_gpus_per_offline_eval_runner": 0, "custom_resources_per_offline_eval_runner": {}, "restart_failed_offline_eval_runners": true, "ignore_offline_eval_runner_failures": false, "max_num_offline_eval_runner_restarts": 1000, "offline_eval_runner_restore_timeout_s": 1800.0, "max_requests_in_flight_per_offline_eval_runner": 1, "validate_offline_eval_runners_after_construction": true, "offline_eval_runner_health_probe_timeout_s": 30.0, "offline_eval_rl_module_inference_only": false, "broadcast_offline_eval_runner_states": false, "offline_eval_batch_size_per_runner": 256, "dataset_num_iters_per_eval_runner": 1, "keep_per_episode_custom_metrics": false, "metrics_episode_collection_timeout_s": 60.0, "metrics_num_episodes_for_smoothing": 100, "min_time_s_per_iteration": null, "min_train_timesteps_per_iteration": 0, "min_sample_timesteps_per_iteration": 0, "log_gradients": true, "export_native_model_files": false, "checkpoint_trainable_policies_only": false, "logger_creator": null, "logger_config": null, "log_level": "WARN", "log_sys_usage": true, "fake_sampler": false, "seed": 7, "restart_failed_env_runners": true, "ignore_env_runner_failures": false, "max_num_env_runner_restarts": 1000, "delay_between_env_runner_restarts_s": 60.0, "restart_failed_sub_environments": false, "num_consecutive_env_runner_failures_tolerance": 100, "env_runner_health_probe_timeout_s": 30.0, "env_runner_restore_timeout_s": 1800.0, "_model_config": {}, "_rl_module_spec": "RLModuleSpec(module_class=None, observation_space=None, action_space=None, inference_only=False, learner_only=False, model_config=DefaultModelConfig(fcnet_hiddens=[60, 90], fcnet_activation='tanh', fcnet_kernel_initializer=None, fcnet_kernel_initializer_kwargs=None, fcnet_bias_initializer=None, fcnet_bias_initializer_kwargs=None, conv_filters=None, conv_activation='relu', conv_kernel_initializer=None, conv_kernel_initializer_kwargs=None, conv_bias_initializer=None, conv_bias_initializer_kwargs=None, head_fcnet_hiddens=[], head_fcnet_activation='relu', head_fcnet_kernel_initializer=None, head_fcnet_kernel_initializer_kwargs=None, head_fcnet_bias_initializer=None, head_fcnet_bias_initializer_kwargs=None, free_log_std=False, log_std_clip_param=20.0, vf_share_layers=True, use_lstm=False, max_seq_len=20, lstm_cell_size=256, lstm_use_prev_action=False, lstm_use_prev_reward=False, lstm_kernel_initializer=None, lstm_kernel_initializer_kwargs=None, lstm_bias_initializer=None, lstm_bias_initializer_kwargs=None), catalog_class=None, load_state_path=None, model_config_dict=None)", "algorithm_config_overrides_per_module": {}, "_per_module_overrides": {}, "_validate_config": true, "_use_msgpack_checkpoints": false, "_torch_grad_scaler_class": null, "_torch_lr_scheduler_classes": null, "_tf_policy_handles_more_than_one_loss": false, "_disable_preprocessor_api": false, "_disable_action_flattening": false, "_disable_initialize_loss_from_dummy_batch": false, "_dont_auto_sync_env_runner_states": false, "env_task_fn": -1, "enable_connectors": -1, "simple_optimizer": false, "policy_map_cache": -1, "worker_cls": -1, "synchronize_filters": -1, "enable_async_evaluation": -1, "custom_async_evaluation_function": -1, "_enable_rl_module_api": -1, "auto_wrap_old_gym_envs": -1, "always_attach_evaluation_results": -1, "replay_sequence_length": null, "_disable_execution_plan_api": -1, "use_critic": true, "use_gae": true, "use_kl_loss": true, "kl_coeff": 0.7464963036515, "kl_target": 0.0270990929592, "vf_loss_coeff": 0.6688075857018, "entropy_coeff": 0.0090570820258, "clip_param": 0.1221781641624, "vf_clip_param": 0.1027808522125, "entropy_coeff_schedule": null, "lr_schedule": null, "sgd_minibatch_size": -1, "vf_share_layers": -1, "__stdout_file__": null, "__stderr_file__": null, "lambda": 0.9099046732075, "input": "sampler", "policies": {"default_policy": [null, null, null, null]}, "callbacks": "<class 'ray.rllib.callbacks.callbacks.RLlibCallback'>", "create_env_on_driver": false, "custom_eval_function": null, "framework": "torch"}, "time_since_restore": 9.66679310798645, "iterations_since_restore": 3, "perf": {"cpu_util_percent": 79.8, "ram_util_percent": 77.75}}
{"timers": {"training_iteration": 3.4035725686813576, "restore_env_runners": 3.023875414021313e-05, "training_step": 3.4033054498866826, "env_runner_sampling_timer": 3.246861526149177, "learner_update_timer": 0.15055562593566044, "synch_weights": 0.0013545235774363388, "restore_eval_env_runners": 1.0785305057652295e-05, "evaluation_iteration": 0.20947322916891425, "synch_eval_env_connectors": 0.00015761752396356314, "synch_env_connectors": 5.636974598746747e-06}, "env_runners": {"module_to_env_connector": {"timers": {"connectors": {"tensor_to_numpy": 2.451718958726386e-05, "listify_data_for_vector_env": 1.952200613654273e-05, "remove_single_ts_time_rank_from_batch": 9.282516332022354e-07, "get_actions": 8.077756636071437e-05, "normalize_and_clip_actions": 1.6089587132333293e-05, "un_batch_to_individual_items": 9.02267002406753e-06}}, "connector_pipeline_timer": 0.00019338721865612657}, "time_between_sampling": 0.003138583466343572, "num_env_steps_sampled_lifetime": -1225000.0, "env_to_module_connector": {"timers": {"connectors": {"add_observations_from_episodes_to_batch": 5.080860290812152e-06, "add_time_dim_to_batch_and_zero_pad": 4.119889030359829e-06, "batch_individual_items": 1.2011086003202062e-05, "numpy_to_tensor": 1.6643606307163157e-05, "add_states_from_episodes_to_batch": 2.666294177585149e-06}}, "connector_pipeline_timer": 7.42999717445246e-05}, "num_module_steps_sampled_lifetime": {"default_policy": -1225000.0}, "episode_return_min": -9.5, "weights_seq_no": 3.0, "num_episodes": 250.0, "env_reset_timer": 8.3548926241998e-05, "env_to_module_sum_episodes_length_out": 10.36823839457432, "num_env_steps_sampled": 5000.0, "env_step_timer": 2.6277493134895768e-05, "episode_return_mean": 2.259999999999999, "episode_return_max": 10.5, "episode_len_min": 20, "num_agent_steps_sampled_lifetime": {"default_agent": -1225000.0}, "rlmodule_inference_timer": 5.4563494801551415e-05, "module_episode_returns_mean": {"default_policy": 2.259999999999999}, "agent_episode_returns_mean": {"default_agent": 2.259999999999999}, "num_episodes_lifetime": -61250.0, "num_module_steps_sampled": {"default_policy": 5000.0}, "num_agent_steps_sampled": {"default_agent": 5000.0}, "episode_duration_sec_mean": 0.008344758167862893, "env_to_module_sum_episodes_length_in": 10.36823839457432, "episode_len_max": 20, "episode_len_mean": 20.0, "sample": 0.009294301638412541, "num_env_steps_sampled_lifetime_throughput": 2277.8713898324377}, "learners": {"__all_modules__": {"learner_connector": {"timers": {"connectors": {"numpy_to_tensor": 7.989089691825211e-05, "add_states_from_episodes_to_batch": 3.883725445135496e-06, "add_one_ts_to_episodes_and_truncate": 0.012618534368796624, "general_advantage_estimation": 0.009000271088925075, "batch_individual_items": 0.044567246392786614, "add_columns_from_episodes_to_train_batch": 0.04948498891087505, "add_observations_from_episodes_to_batch": 0.0010644297706334618, "add_time_dim_to_batch_and_zero_pad": 1.2932034655590542e-05}}, "connector_pipeline_timer": 0.11705032480033767}, "num_module_steps_trained_lifetime": 24000, "num_module_steps_trained": 6000, "num_env_steps_trained": 31500, "learner_connector_sum_episodes_length_out": 5250.0, "learner_connector_sum_episodes_length_in": 5000.0, "num_env_steps_trained_lifetime": 126000, "num_trainable_parameters": 6003, "num_non_trainable_parameters": 0, "num_env_steps_trained_lifetime_throughput": 1830147.4119962833, "num_module_steps_trained_throughput": 350254.151382784, "num_module_steps_trained_lifetime_throughput": 349654.82935628085}, "default_policy": {"module_train_batch_size_mean": 1000.0, "total_loss": 0.15174606442451477, "vf_explained_var": -0.010841846466064453, "mean_kl_loss": 0.0009349097963422537, "num_module_steps_trained_lifetime": 24000, "num_module_steps_trained": 6000, "weights_seq_no": 4.0, "diff_num_grad_updates_vs_sampler_policy": 1.0, "vf_loss": 0.10278083384037018, "curr_kl_coeff": 0.04665601998567581, "curr_entropy_coeff": 0.0090570820258, "vf_loss_unclipped": 28.754053115844727, "default_optimizer_learning_rate": 0.0002847858517, "num_trainable_parameters": 6003, "entropy": 0.6782488226890564, "gradients_default_optimizer_global_norm": 0.05304211378097534, "policy_loss": 0.0890611782670021, "num_module_steps_trained_lifetime_throughput": 351039.0220835231}}, "num_training_step_calls_per_iteration": 1, "evaluation": {"env_runners": {"agent_episode_returns_mean": {"default_agent": -0.7}, "episode_len_mean": 20.0, "sample": 0.2014382063712793, "num_env_steps_sampled_lifetime": 20400, "env_reset_timer": 0.0001453793579915073, "env_step_timer": 2.7773437831328284e-05, "rlmodule_inference_timer": 5.988797928001956e-05, "module_to_env_connector": {"timers": {"connectors": {"remove_single_ts_time_rank_from_batch": 7.707184047169833e-07, "normalize_and_clip_actions": 1.4530563239237068e-05, "tensor_to_numpy": 1.973895659298835e-05, "listify_data_for_vector_env": 1.6068185634688013e-05, "un_batch_to_individual_items": 8.75717087605441e-06, "get_actions": 7.512506211714187e-05}}, "connector_pipeline_timer": 0.0001744240357787096}, "env_to_module_sum_episodes_length_in": 10.368237912813044, "num_agent_steps_sampled": {"default_agent": 400}, "env_to_module_sum_episodes_length_out": 10.368237912813044, "episode_return_mean": -0.7, "episode_len_min": 20, "episode_duration_sec_mean": 0.00914414424187271, "num_module_steps_sampled": {"default_policy": 400}, "env_to_module_connector": {"timers": {"connectors": {"batch_individual_items": 1.2220378143936282e-05, "add_observations_from_episodes_to_batch": 3.988943186961179e-06, "add_time_dim_to_batch_and_zero_pad": 4.044793141641777e-06, "numpy_to_tensor": 1.548620802905855e-05, "add_states_from_episodes_to_batch": 3.0560125270295397e-06}}, "connector_pipeline_timer": 7.240707985926003e-05}, "episode_return_min": -12.5, "num_module_steps_sampled_lifetime": {"default_policy": 1600}, "weights_seq_no": 4.0, "num_episodes": 20, "num_episodes_lifetime": 80, "episode_len_max": 20, "num_env_steps_sampled": 400, "episode_return_max": 14.5, "num_agent_steps_sampled_lifetime": {"default_agent": 1600}, "module_episode_returns_mean": {"default_policy": -0.7}, "time_between_sampling": 2.666088236113754}, "num_healthy_workers": 1, "actor_manager_num_outstanding_async_reqs": 0, "num_remote_worker_restarts": 0}, "num_env_steps_sampled_lifetime": -1225000.0, "fault_tolerance": {"num_healthy_workers": 0, "num_remote_worker_restarts": 0}, "env_runner_group": {"actor_manager_num_outstanding_async_reqs": 0}, "done": false, "training_iteration": 4, "trial_id": "497dd_00000", "date": "2025-08-11_19-33-13", "timestamp": 1754933593, "time_this_iter_s": 2.9515106678009033, "time_total_s": 12.618303775787354, "pid": 25863, "hostname": "Mac", "node_ip": "127.0.0.1", "config": {"exploration_config": {}, "extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "placement_strategy": "PACK", "num_gpus": 0, "_fake_gpus": false, "num_cpus_for_main_process": 2, "eager_tracing": true, "eager_max_retraces": 20, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "torch_compile_learner": false, "torch_compile_learner_what_to_compile": "forward_train", "torch_compile_learner_dynamo_backend": "aot_eager", "torch_compile_learner_dynamo_mode": null, "torch_compile_worker": false, "torch_compile_worker_dynamo_backend": "aot_eager", "torch_compile_worker_dynamo_mode": null, "torch_ddp_kwargs": {}, "torch_skip_nan_gradients": false, "env": "Umbrella", "env_config": {}, "observation_space": null, "action_space": null, "clip_rewards": null, "normalize_actions": true, "clip_actions": false, "_is_atari": null, "disable_env_checking": false, "render_env": false, "action_mask_key": "action_mask", "env_runner_cls": null, "num_env_runners": 0, "create_local_env_runner": true, "num_envs_per_env_runner": 1, "gym_env_vectorize_mode": "SYNC", "num_cpus_per_env_runner": 1, "num_gpus_per_env_runner": 0, "custom_resources_per_env_runner": {}, "validate_env_runners_after_construction": true, "episodes_to_numpy": true, "max_requests_in_flight_per_env_runner": 1, "sample_timeout_s": 60.0, "_env_to_module_connector": null, "add_default_connectors_to_env_to_module_pipeline": true, "_module_to_env_connector": null, "add_default_connectors_to_module_to_env_pipeline": true, "merge_env_runner_states": "training_only", "broadcast_env_runner_states": true, "episode_lookback_horizon": 1, "rollout_fragment_length": "auto", "batch_mode": "complete_episodes", "compress_observations": false, "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "enable_tf1_exec_eagerly": false, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "preprocessor_pref": "deepmind", "observation_filter": "NoFilter", "update_worker_filter_stats": true, "use_worker_filter_stats": true, "sampler_perf_stats_ema_coef": null, "_is_online": true, "num_learners": 0, "num_gpus_per_learner": 0, "num_cpus_per_learner": "auto", "num_aggregator_actors_per_learner": 0, "max_requests_in_flight_per_aggregator_actor": 3, "local_gpu_idx": 0, "max_requests_in_flight_per_learner": 3, "gamma": 1, "lr": 0.0002847858517, "grad_clip": 0.5, "grad_clip_by": "global_norm", "_train_batch_size_per_learner": 5000, "train_batch_size": 4000, "num_epochs": 1, "minibatch_size": 1000, "shuffle_batch_per_epoch": true, "model": {"fcnet_hiddens": [256, 256], "fcnet_activation": "tanh", "fcnet_weights_initializer": null, "fcnet_weights_initializer_config": null, "fcnet_bias_initializer": null, "fcnet_bias_initializer_config": null, "conv_filters": null, "conv_activation": "relu", "conv_kernel_initializer": null, "conv_kernel_initializer_config": null, "conv_bias_initializer": null, "conv_bias_initializer_config": null, "conv_transpose_kernel_initializer": null, "conv_transpose_kernel_initializer_config": null, "conv_transpose_bias_initializer": null, "conv_transpose_bias_initializer_config": null, "post_fcnet_hiddens": [], "post_fcnet_activation": "relu", "post_fcnet_weights_initializer": null, "post_fcnet_weights_initializer_config": null, "post_fcnet_bias_initializer": null, "post_fcnet_bias_initializer_config": null, "free_log_std": false, "log_std_clip_param": 20.0, "no_final_linear": false, "vf_share_layers": false, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "lstm_weights_initializer": null, "lstm_weights_initializer_config": null, "lstm_bias_initializer": null, "lstm_bias_initializer_config": null, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "attention_use_n_prev_actions": 0, "attention_use_n_prev_rewards": 0, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": null, "custom_model_config": {}, "custom_action_dist": null, "custom_preprocessor": null, "encoder_latent_dim": null, "always_check_shapes": false, "lstm_use_prev_action_reward": -1, "_use_default_native_models": -1, "_disable_preprocessor_api": false, "_disable_action_flattening": false}, "_learner_connector": null, "add_default_connectors_to_learner_pipeline": true, "learner_config_dict": {}, "optimizer": {}, "_learner_class": null, "callbacks_on_algorithm_init": null, "callbacks_on_env_runners_recreated": null, "callbacks_on_offline_eval_runners_recreated": null, "callbacks_on_checkpoint_loaded": null, "callbacks_on_environment_created": null, "callbacks_on_episode_created": null, "callbacks_on_episode_start": null, "callbacks_on_episode_step": null, "callbacks_on_episode_end": null, "callbacks_on_evaluate_start": null, "callbacks_on_evaluate_end": null, "callbacks_on_evaluate_offline_start": null, "callbacks_on_evaluate_offline_end": null, "callbacks_on_sample_end": null, "callbacks_on_train_result": null, "explore": true, "enable_rl_module_and_learner": true, "enable_env_runner_and_connector_v2": true, "_prior_exploration_config": {"type": "StochasticSampling"}, "count_steps_by": "env_steps", "policy_map_capacity": 100, "policy_mapping_fn": "<function AlgorithmConfig.DEFAULT_POLICY_MAPPING_FN at 0x14ff39b20>", "policies_to_train": null, "policy_states_are_swappable": false, "observation_fn": null, "offline_data_class": null, "input_read_method": "read_parquet", "input_read_method_kwargs": {}, "input_read_schema": {}, "input_read_episodes": false, "input_read_sample_batches": false, "input_read_batch_size": null, "input_filesystem": null, "input_filesystem_kwargs": {}, "input_compress_columns": ["obs", "new_obs"], "input_spaces_jsonable": true, "materialize_data": false, "materialize_mapped_data": true, "map_batches_kwargs": {}, "iter_batches_kwargs": {}, "ignore_final_observation": false, "prelearner_class": null, "prelearner_buffer_class": null, "prelearner_buffer_kwargs": {}, "prelearner_module_synch_period": 10, "dataset_num_iters_per_learner": null, "input_config": {}, "actions_in_input_normalized": false, "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_config": {}, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "output_max_rows_per_file": null, "output_write_remaining_data": false, "output_write_method": "write_parquet", "output_write_method_kwargs": {}, "output_filesystem": null, "output_filesystem_kwargs": {}, "output_write_episodes": true, "offline_sampling": false, "evaluation_interval": 1, "evaluation_duration": 20, "evaluation_duration_unit": "episodes", "evaluation_sample_timeout_s": 120.0, "evaluation_auto_duration_min_env_steps_per_sample": 100, "evaluation_auto_duration_max_env_steps_per_sample": 2000, "evaluation_parallel_to_training": false, "evaluation_force_reset_envs_before_iteration": true, "evaluation_config": null, "off_policy_estimation_methods": {}, "ope_split_batch_by_episode": true, "evaluation_num_env_runners": 1, "in_evaluation": false, "sync_filters_on_rollout_workers_timeout_s": 10.0, "offline_evaluation_interval": null, "num_offline_eval_runners": 0, "offline_loss_for_module_fn": null, "offline_evaluation_duration": 1, "offline_evaluation_parallel_to_training": false, "offline_evaluation_timeout_s": 120.0, "num_cpus_per_offline_eval_runner": 1, "num_gpus_per_offline_eval_runner": 0, "custom_resources_per_offline_eval_runner": {}, "restart_failed_offline_eval_runners": true, "ignore_offline_eval_runner_failures": false, "max_num_offline_eval_runner_restarts": 1000, "offline_eval_runner_restore_timeout_s": 1800.0, "max_requests_in_flight_per_offline_eval_runner": 1, "validate_offline_eval_runners_after_construction": true, "offline_eval_runner_health_probe_timeout_s": 30.0, "offline_eval_rl_module_inference_only": false, "broadcast_offline_eval_runner_states": false, "offline_eval_batch_size_per_runner": 256, "dataset_num_iters_per_eval_runner": 1, "keep_per_episode_custom_metrics": false, "metrics_episode_collection_timeout_s": 60.0, "metrics_num_episodes_for_smoothing": 100, "min_time_s_per_iteration": null, "min_train_timesteps_per_iteration": 0, "min_sample_timesteps_per_iteration": 0, "log_gradients": true, "export_native_model_files": false, "checkpoint_trainable_policies_only": false, "logger_creator": null, "logger_config": null, "log_level": "WARN", "log_sys_usage": true, "fake_sampler": false, "seed": 7, "restart_failed_env_runners": true, "ignore_env_runner_failures": false, "max_num_env_runner_restarts": 1000, "delay_between_env_runner_restarts_s": 60.0, "restart_failed_sub_environments": false, "num_consecutive_env_runner_failures_tolerance": 100, "env_runner_health_probe_timeout_s": 30.0, "env_runner_restore_timeout_s": 1800.0, "_model_config": {}, "_rl_module_spec": "RLModuleSpec(module_class=None, observation_space=None, action_space=None, inference_only=False, learner_only=False, model_config=DefaultModelConfig(fcnet_hiddens=[60, 90], fcnet_activation='tanh', fcnet_kernel_initializer=None, fcnet_kernel_initializer_kwargs=None, fcnet_bias_initializer=None, fcnet_bias_initializer_kwargs=None, conv_filters=None, conv_activation='relu', conv_kernel_initializer=None, conv_kernel_initializer_kwargs=None, conv_bias_initializer=None, conv_bias_initializer_kwargs=None, head_fcnet_hiddens=[], head_fcnet_activation='relu', head_fcnet_kernel_initializer=None, head_fcnet_kernel_initializer_kwargs=None, head_fcnet_bias_initializer=None, head_fcnet_bias_initializer_kwargs=None, free_log_std=False, log_std_clip_param=20.0, vf_share_layers=True, use_lstm=False, max_seq_len=20, lstm_cell_size=256, lstm_use_prev_action=False, lstm_use_prev_reward=False, lstm_kernel_initializer=None, lstm_kernel_initializer_kwargs=None, lstm_bias_initializer=None, lstm_bias_initializer_kwargs=None), catalog_class=None, load_state_path=None, model_config_dict=None)", "algorithm_config_overrides_per_module": {}, "_per_module_overrides": {}, "_validate_config": true, "_use_msgpack_checkpoints": false, "_torch_grad_scaler_class": null, "_torch_lr_scheduler_classes": null, "_tf_policy_handles_more_than_one_loss": false, "_disable_preprocessor_api": false, "_disable_action_flattening": false, "_disable_initialize_loss_from_dummy_batch": false, "_dont_auto_sync_env_runner_states": false, "env_task_fn": -1, "enable_connectors": -1, "simple_optimizer": false, "policy_map_cache": -1, "worker_cls": -1, "synchronize_filters": -1, "enable_async_evaluation": -1, "custom_async_evaluation_function": -1, "_enable_rl_module_api": -1, "auto_wrap_old_gym_envs": -1, "always_attach_evaluation_results": -1, "replay_sequence_length": null, "_disable_execution_plan_api": -1, "use_critic": true, "use_gae": true, "use_kl_loss": true, "kl_coeff": 0.7464963036515, "kl_target": 0.0270990929592, "vf_loss_coeff": 0.6688075857018, "entropy_coeff": 0.0090570820258, "clip_param": 0.1221781641624, "vf_clip_param": 0.1027808522125, "entropy_coeff_schedule": null, "lr_schedule": null, "sgd_minibatch_size": -1, "vf_share_layers": -1, "__stdout_file__": null, "__stderr_file__": null, "lambda": 0.9099046732075, "input": "sampler", "policies": {"default_policy": [null, null, null, null]}, "callbacks": "<class 'ray.rllib.callbacks.callbacks.RLlibCallback'>", "create_env_on_driver": false, "custom_eval_function": null, "framework": "torch"}, "time_since_restore": 12.618303775787354, "iterations_since_restore": 4, "perf": {"cpu_util_percent": 74.32, "ram_util_percent": 77.74}}
{"timers": {"training_iteration": 3.401324875914411, "restore_env_runners": 3.0076366500686853e-05, "training_step": 3.4010551362173285, "env_runner_sampling_timer": 3.244576785468229, "learner_update_timer": 0.15058990050601917, "synch_weights": 0.0013573608424240953, "restore_eval_env_runners": 1.078787193982862e-05, "evaluation_iteration": 0.20905835896644742, "synch_eval_env_connectors": 0.00015946426885039543, "synch_env_connectors": 5.636444626026787e-06}, "env_runners": {"module_to_env_connector": {"timers": {"connectors": {"tensor_to_numpy": 2.811915725386776e-05, "listify_data_for_vector_env": 2.13910877529241e-05, "remove_single_ts_time_rank_from_batch": 1.1303038743539663e-06, "get_actions": 9.495684966822268e-05, "normalize_and_clip_actions": 1.7813740434134877e-05, "un_batch_to_individual_items": 9.976745561168162e-06}}, "connector_pipeline_timer": 0.00022031788423592185}, "time_between_sampling": 0.002738497998584698, "num_env_steps_sampled_lifetime": -1842500.0, "env_to_module_connector": {"timers": {"connectors": {"add_observations_from_episodes_to_batch": 5.741869352865789e-06, "add_time_dim_to_batch_and_zero_pad": 4.7419110558337416e-06, "batch_individual_items": 1.3633501029321225e-05, "numpy_to_tensor": 1.9882853700844463e-05, "add_states_from_episodes_to_batch": 3.0853988029963558e-06}}, "connector_pipeline_timer": 8.532812351161732e-05}, "num_module_steps_sampled_lifetime": {"default_policy": -1842500.0}, "episode_return_min": -9.5, "weights_seq_no": 4.0, "num_episodes": 250.0, "env_reset_timer": 8.544961108599721e-05, "env_to_module_sum_episodes_length_out": 10.36823839457432, "num_env_steps_sampled": 5000.0, "env_step_timer": 3.0684026503262495e-05, "episode_return_mean": 1.1400000000000001, "episode_return_max": 10.5, "episode_len_min": 20, "num_agent_steps_sampled_lifetime": {"default_agent": -1842500.0}, "rlmodule_inference_timer": 9.613005893894205e-05, "module_episode_returns_mean": {"default_policy": 1.1400000000000001}, "agent_episode_returns_mean": {"default_agent": 1.1400000000000001}, "num_episodes_lifetime": -92125.0, "num_module_steps_sampled": {"default_policy": 5000.0}, "num_agent_steps_sampled": {"default_agent": 5000.0}, "episode_duration_sec_mean": 0.01016146904882044, "env_to_module_sum_episodes_length_in": 10.36823839457432, "episode_len_max": 20, "episode_len_mean": 20.0, "sample": 0.00976162682563564, "num_env_steps_sampled_lifetime_throughput": 2132.860817382817}, "learners": {"__all_modules__": {"learner_connector": {"timers": {"connectors": {"numpy_to_tensor": 7.980906791446731e-05, "add_states_from_episodes_to_batch": 3.877387856078566e-06, "add_one_ts_to_episodes_and_truncate": 0.012593239445253082, "general_advantage_estimation": 0.008991522128285568, "batch_individual_items": 0.044531524348420684, "add_columns_from_episodes_to_train_batch": 0.049547519441689294, "add_observations_from_episodes_to_batch": 0.0010628213030802794, "add_time_dim_to_batch_and_zero_pad": 1.2908134203715018e-05}}, "connector_pipeline_timer": 0.1170404848825633}, "num_module_steps_trained_lifetime": 30000, "num_module_steps_trained": 6000, "num_env_steps_trained": 31500, "learner_connector_sum_episodes_length_out": 5250.0, "learner_connector_sum_episodes_length_in": 5000.0, "num_env_steps_trained_lifetime": 157500, "num_trainable_parameters": 6003, "num_non_trainable_parameters": 0, "num_env_steps_trained_lifetime_throughput": 1810289.8610333477, "num_module_steps_trained_throughput": 346409.0257022257, "num_module_steps_trained_lifetime_throughput": 345830.5795969785}, "default_policy": {"module_train_batch_size_mean": 1000.0, "total_loss": 0.2631865441799164, "vf_explained_var": -0.010644197463989258, "mean_kl_loss": 0.0014776266179978848, "num_module_steps_trained_lifetime": 30000, "num_module_steps_trained": 6000, "weights_seq_no": 5.0, "diff_num_grad_updates_vs_sampler_policy": 1.0, "vf_loss": 0.10278083384037018, "curr_kl_coeff": 0.023328009992837906, "curr_entropy_coeff": 0.0090570820258, "vf_loss_unclipped": 29.06502914428711, "default_optimizer_learning_rate": 0.0002847858517, "num_trainable_parameters": 6003, "entropy": 0.6661638617515564, "gradients_default_optimizer_global_norm": 0.051883306354284286, "policy_loss": 0.20041051506996155, "num_module_steps_trained_lifetime_throughput": 347147.1911166733}}, "num_training_step_calls_per_iteration": 1, "evaluation": {"env_runners": {"agent_episode_returns_mean": {"default_agent": -0.15}, "episode_len_mean": 20.0, "sample": 0.2014409422174208, "num_env_steps_sampled_lifetime": 25400, "env_reset_timer": 0.00014493597489924405, "env_step_timer": 5.501533929564548e-05, "rlmodule_inference_timer": 9.257394227966449e-05, "module_to_env_connector": {"timers": {"connectors": {"remove_single_ts_time_rank_from_batch": 1.578639823227632e-06, "normalize_and_clip_actions": 2.5155153469561036e-05, "tensor_to_numpy": 4.075623317431294e-05, "listify_data_for_vector_env": 3.443549097876851e-05, "un_batch_to_individual_items": 1.6186015517152474e-05, "get_actions": 0.00014181284254105524}}, "connector_pipeline_timer": 0.00032736125675723074}, "env_to_module_sum_episodes_length_in": 10.368238387501162, "num_agent_steps_sampled": {"default_agent": 400}, "env_to_module_sum_episodes_length_out": 10.368238387501162, "episode_return_mean": -0.15, "episode_len_min": 20, "episode_duration_sec_mean": 0.009157361636171117, "num_module_steps_sampled": {"default_policy": 400}, "env_to_module_connector": {"timers": {"connectors": {"batch_individual_items": 2.2318099764988058e-05, "add_observations_from_episodes_to_batch": 7.870619340963929e-06, "add_time_dim_to_batch_and_zero_pad": 9.384671972836236e-06, "numpy_to_tensor": 2.6687902146113554e-05, "add_states_from_episodes_to_batch": 3.8067638898703017e-06}}, "connector_pipeline_timer": 0.00012452584641598426}, "episode_return_min": -12.5, "num_module_steps_sampled_lifetime": {"default_policy": 2000}, "weights_seq_no": 5.0, "num_episodes": 20, "num_episodes_lifetime": 100, "episode_len_max": 20, "num_env_steps_sampled": 400, "episode_return_max": 14.5, "num_agent_steps_sampled_lifetime": {"default_agent": 2000}, "module_episode_returns_mean": {"default_policy": -0.15}, "time_between_sampling": 2.67170691083309}, "num_healthy_workers": 1, "actor_manager_num_outstanding_async_reqs": 0, "num_remote_worker_restarts": 0}, "num_env_steps_sampled_lifetime": -1842500.0, "fault_tolerance": {"num_healthy_workers": 0, "num_remote_worker_restarts": 0}, "env_runner_group": {"actor_manager_num_outstanding_async_reqs": 0}, "done": false, "training_iteration": 5, "trial_id": "497dd_00000", "date": "2025-08-11_19-33-17", "timestamp": 1754933597, "time_this_iter_s": 3.3970601558685303, "time_total_s": 16.015363931655884, "pid": 25863, "hostname": "Mac", "node_ip": "127.0.0.1", "config": {"exploration_config": {}, "extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "placement_strategy": "PACK", "num_gpus": 0, "_fake_gpus": false, "num_cpus_for_main_process": 2, "eager_tracing": true, "eager_max_retraces": 20, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "torch_compile_learner": false, "torch_compile_learner_what_to_compile": "forward_train", "torch_compile_learner_dynamo_backend": "aot_eager", "torch_compile_learner_dynamo_mode": null, "torch_compile_worker": false, "torch_compile_worker_dynamo_backend": "aot_eager", "torch_compile_worker_dynamo_mode": null, "torch_ddp_kwargs": {}, "torch_skip_nan_gradients": false, "env": "Umbrella", "env_config": {}, "observation_space": null, "action_space": null, "clip_rewards": null, "normalize_actions": true, "clip_actions": false, "_is_atari": null, "disable_env_checking": false, "render_env": false, "action_mask_key": "action_mask", "env_runner_cls": null, "num_env_runners": 0, "create_local_env_runner": true, "num_envs_per_env_runner": 1, "gym_env_vectorize_mode": "SYNC", "num_cpus_per_env_runner": 1, "num_gpus_per_env_runner": 0, "custom_resources_per_env_runner": {}, "validate_env_runners_after_construction": true, "episodes_to_numpy": true, "max_requests_in_flight_per_env_runner": 1, "sample_timeout_s": 60.0, "_env_to_module_connector": null, "add_default_connectors_to_env_to_module_pipeline": true, "_module_to_env_connector": null, "add_default_connectors_to_module_to_env_pipeline": true, "merge_env_runner_states": "training_only", "broadcast_env_runner_states": true, "episode_lookback_horizon": 1, "rollout_fragment_length": "auto", "batch_mode": "complete_episodes", "compress_observations": false, "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "enable_tf1_exec_eagerly": false, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "preprocessor_pref": "deepmind", "observation_filter": "NoFilter", "update_worker_filter_stats": true, "use_worker_filter_stats": true, "sampler_perf_stats_ema_coef": null, "_is_online": true, "num_learners": 0, "num_gpus_per_learner": 0, "num_cpus_per_learner": "auto", "num_aggregator_actors_per_learner": 0, "max_requests_in_flight_per_aggregator_actor": 3, "local_gpu_idx": 0, "max_requests_in_flight_per_learner": 3, "gamma": 1, "lr": 0.0002847858517, "grad_clip": 0.5, "grad_clip_by": "global_norm", "_train_batch_size_per_learner": 5000, "train_batch_size": 4000, "num_epochs": 1, "minibatch_size": 1000, "shuffle_batch_per_epoch": true, "model": {"fcnet_hiddens": [256, 256], "fcnet_activation": "tanh", "fcnet_weights_initializer": null, "fcnet_weights_initializer_config": null, "fcnet_bias_initializer": null, "fcnet_bias_initializer_config": null, "conv_filters": null, "conv_activation": "relu", "conv_kernel_initializer": null, "conv_kernel_initializer_config": null, "conv_bias_initializer": null, "conv_bias_initializer_config": null, "conv_transpose_kernel_initializer": null, "conv_transpose_kernel_initializer_config": null, "conv_transpose_bias_initializer": null, "conv_transpose_bias_initializer_config": null, "post_fcnet_hiddens": [], "post_fcnet_activation": "relu", "post_fcnet_weights_initializer": null, "post_fcnet_weights_initializer_config": null, "post_fcnet_bias_initializer": null, "post_fcnet_bias_initializer_config": null, "free_log_std": false, "log_std_clip_param": 20.0, "no_final_linear": false, "vf_share_layers": false, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "lstm_weights_initializer": null, "lstm_weights_initializer_config": null, "lstm_bias_initializer": null, "lstm_bias_initializer_config": null, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "attention_use_n_prev_actions": 0, "attention_use_n_prev_rewards": 0, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": null, "custom_model_config": {}, "custom_action_dist": null, "custom_preprocessor": null, "encoder_latent_dim": null, "always_check_shapes": false, "lstm_use_prev_action_reward": -1, "_use_default_native_models": -1, "_disable_preprocessor_api": false, "_disable_action_flattening": false}, "_learner_connector": null, "add_default_connectors_to_learner_pipeline": true, "learner_config_dict": {}, "optimizer": {}, "_learner_class": null, "callbacks_on_algorithm_init": null, "callbacks_on_env_runners_recreated": null, "callbacks_on_offline_eval_runners_recreated": null, "callbacks_on_checkpoint_loaded": null, "callbacks_on_environment_created": null, "callbacks_on_episode_created": null, "callbacks_on_episode_start": null, "callbacks_on_episode_step": null, "callbacks_on_episode_end": null, "callbacks_on_evaluate_start": null, "callbacks_on_evaluate_end": null, "callbacks_on_evaluate_offline_start": null, "callbacks_on_evaluate_offline_end": null, "callbacks_on_sample_end": null, "callbacks_on_train_result": null, "explore": true, "enable_rl_module_and_learner": true, "enable_env_runner_and_connector_v2": true, "_prior_exploration_config": {"type": "StochasticSampling"}, "count_steps_by": "env_steps", "policy_map_capacity": 100, "policy_mapping_fn": "<function AlgorithmConfig.DEFAULT_POLICY_MAPPING_FN at 0x14ff39b20>", "policies_to_train": null, "policy_states_are_swappable": false, "observation_fn": null, "offline_data_class": null, "input_read_method": "read_parquet", "input_read_method_kwargs": {}, "input_read_schema": {}, "input_read_episodes": false, "input_read_sample_batches": false, "input_read_batch_size": null, "input_filesystem": null, "input_filesystem_kwargs": {}, "input_compress_columns": ["obs", "new_obs"], "input_spaces_jsonable": true, "materialize_data": false, "materialize_mapped_data": true, "map_batches_kwargs": {}, "iter_batches_kwargs": {}, "ignore_final_observation": false, "prelearner_class": null, "prelearner_buffer_class": null, "prelearner_buffer_kwargs": {}, "prelearner_module_synch_period": 10, "dataset_num_iters_per_learner": null, "input_config": {}, "actions_in_input_normalized": false, "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_config": {}, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "output_max_rows_per_file": null, "output_write_remaining_data": false, "output_write_method": "write_parquet", "output_write_method_kwargs": {}, "output_filesystem": null, "output_filesystem_kwargs": {}, "output_write_episodes": true, "offline_sampling": false, "evaluation_interval": 1, "evaluation_duration": 20, "evaluation_duration_unit": "episodes", "evaluation_sample_timeout_s": 120.0, "evaluation_auto_duration_min_env_steps_per_sample": 100, "evaluation_auto_duration_max_env_steps_per_sample": 2000, "evaluation_parallel_to_training": false, "evaluation_force_reset_envs_before_iteration": true, "evaluation_config": null, "off_policy_estimation_methods": {}, "ope_split_batch_by_episode": true, "evaluation_num_env_runners": 1, "in_evaluation": false, "sync_filters_on_rollout_workers_timeout_s": 10.0, "offline_evaluation_interval": null, "num_offline_eval_runners": 0, "offline_loss_for_module_fn": null, "offline_evaluation_duration": 1, "offline_evaluation_parallel_to_training": false, "offline_evaluation_timeout_s": 120.0, "num_cpus_per_offline_eval_runner": 1, "num_gpus_per_offline_eval_runner": 0, "custom_resources_per_offline_eval_runner": {}, "restart_failed_offline_eval_runners": true, "ignore_offline_eval_runner_failures": false, "max_num_offline_eval_runner_restarts": 1000, "offline_eval_runner_restore_timeout_s": 1800.0, "max_requests_in_flight_per_offline_eval_runner": 1, "validate_offline_eval_runners_after_construction": true, "offline_eval_runner_health_probe_timeout_s": 30.0, "offline_eval_rl_module_inference_only": false, "broadcast_offline_eval_runner_states": false, "offline_eval_batch_size_per_runner": 256, "dataset_num_iters_per_eval_runner": 1, "keep_per_episode_custom_metrics": false, "metrics_episode_collection_timeout_s": 60.0, "metrics_num_episodes_for_smoothing": 100, "min_time_s_per_iteration": null, "min_train_timesteps_per_iteration": 0, "min_sample_timesteps_per_iteration": 0, "log_gradients": true, "export_native_model_files": false, "checkpoint_trainable_policies_only": false, "logger_creator": null, "logger_config": null, "log_level": "WARN", "log_sys_usage": true, "fake_sampler": false, "seed": 7, "restart_failed_env_runners": true, "ignore_env_runner_failures": false, "max_num_env_runner_restarts": 1000, "delay_between_env_runner_restarts_s": 60.0, "restart_failed_sub_environments": false, "num_consecutive_env_runner_failures_tolerance": 100, "env_runner_health_probe_timeout_s": 30.0, "env_runner_restore_timeout_s": 1800.0, "_model_config": {}, "_rl_module_spec": "RLModuleSpec(module_class=None, observation_space=None, action_space=None, inference_only=False, learner_only=False, model_config=DefaultModelConfig(fcnet_hiddens=[60, 90], fcnet_activation='tanh', fcnet_kernel_initializer=None, fcnet_kernel_initializer_kwargs=None, fcnet_bias_initializer=None, fcnet_bias_initializer_kwargs=None, conv_filters=None, conv_activation='relu', conv_kernel_initializer=None, conv_kernel_initializer_kwargs=None, conv_bias_initializer=None, conv_bias_initializer_kwargs=None, head_fcnet_hiddens=[], head_fcnet_activation='relu', head_fcnet_kernel_initializer=None, head_fcnet_kernel_initializer_kwargs=None, head_fcnet_bias_initializer=None, head_fcnet_bias_initializer_kwargs=None, free_log_std=False, log_std_clip_param=20.0, vf_share_layers=True, use_lstm=False, max_seq_len=20, lstm_cell_size=256, lstm_use_prev_action=False, lstm_use_prev_reward=False, lstm_kernel_initializer=None, lstm_kernel_initializer_kwargs=None, lstm_bias_initializer=None, lstm_bias_initializer_kwargs=None), catalog_class=None, load_state_path=None, model_config_dict=None)", "algorithm_config_overrides_per_module": {}, "_per_module_overrides": {}, "_validate_config": true, "_use_msgpack_checkpoints": false, "_torch_grad_scaler_class": null, "_torch_lr_scheduler_classes": null, "_tf_policy_handles_more_than_one_loss": false, "_disable_preprocessor_api": false, "_disable_action_flattening": false, "_disable_initialize_loss_from_dummy_batch": false, "_dont_auto_sync_env_runner_states": false, "env_task_fn": -1, "enable_connectors": -1, "simple_optimizer": false, "policy_map_cache": -1, "worker_cls": -1, "synchronize_filters": -1, "enable_async_evaluation": -1, "custom_async_evaluation_function": -1, "_enable_rl_module_api": -1, "auto_wrap_old_gym_envs": -1, "always_attach_evaluation_results": -1, "replay_sequence_length": null, "_disable_execution_plan_api": -1, "use_critic": true, "use_gae": true, "use_kl_loss": true, "kl_coeff": 0.7464963036515, "kl_target": 0.0270990929592, "vf_loss_coeff": 0.6688075857018, "entropy_coeff": 0.0090570820258, "clip_param": 0.1221781641624, "vf_clip_param": 0.1027808522125, "entropy_coeff_schedule": null, "lr_schedule": null, "sgd_minibatch_size": -1, "vf_share_layers": -1, "__stdout_file__": null, "__stderr_file__": null, "lambda": 0.9099046732075, "input": "sampler", "policies": {"default_policy": [null, null, null, null]}, "callbacks": "<class 'ray.rllib.callbacks.callbacks.RLlibCallback'>", "create_env_on_driver": false, "custom_eval_function": null, "framework": "torch"}, "time_since_restore": 16.015363931655884, "iterations_since_restore": 5, "perf": {"cpu_util_percent": 81.25, "ram_util_percent": 78.15}}
{"timers": {"training_iteration": 3.400262517575737, "restore_env_runners": 2.984352302689347e-05, "training_step": 3.3999930736054176, "env_runner_sampling_timer": 3.2422440922033005, "learner_update_timer": 0.15188264484131564, "synch_weights": 0.0013533459831522017, "restore_eval_env_runners": 1.0769162700336893e-05, "evaluation_iteration": 0.20912108287661263, "synch_eval_env_connectors": 0.00015917295622571136, "synch_env_connectors": 5.872579496622785e-06}, "env_runners": {"module_to_env_connector": {"timers": {"connectors": {"tensor_to_numpy": 2.8723742576404246e-05, "listify_data_for_vector_env": 2.367551036187481e-05, "remove_single_ts_time_rank_from_batch": 1.1288505151857711e-06, "get_actions": 0.0001033589301794017, "normalize_and_clip_actions": 1.9873201895171653e-05, "un_batch_to_individual_items": 1.0963165426802497e-05}}, "connector_pipeline_timer": 0.00023720252973189216}, "time_between_sampling": 0.002915626178403122, "num_env_steps_sampled_lifetime": -2460000.0, "env_to_module_connector": {"timers": {"connectors": {"add_observations_from_episodes_to_batch": 5.936865607183599e-06, "add_time_dim_to_batch_and_zero_pad": 5.0906890932527135e-06, "batch_individual_items": 1.4689614511799849e-05, "numpy_to_tensor": 2.0763939700596227e-05, "add_states_from_episodes_to_batch": 3.196664569090926e-06}}, "connector_pipeline_timer": 8.909055963157235e-05}, "num_module_steps_sampled_lifetime": {"default_policy": -2460000.0}, "episode_return_min": -9.5, "weights_seq_no": 5.0, "num_episodes": 250.0, "env_reset_timer": 9.255385828089704e-05, "env_to_module_sum_episodes_length_out": 10.36823839457432, "num_env_steps_sampled": 5000.0, "env_step_timer": 3.20548304549675e-05, "episode_return_mean": 2.58, "episode_return_max": 10.5, "episode_len_min": 20, "num_agent_steps_sampled_lifetime": {"default_agent": -2460000.0}, "rlmodule_inference_timer": 6.857771669007483e-05, "module_episode_returns_mean": {"default_policy": 2.58}, "agent_episode_returns_mean": {"default_agent": 2.58}, "num_episodes_lifetime": -123000.0, "num_module_steps_sampled": {"default_policy": 5000.0}, "num_agent_steps_sampled": {"default_agent": 5000.0}, "episode_duration_sec_mean": 0.010158359519671646, "env_to_module_sum_episodes_length_in": 10.36823839457432, "episode_len_max": 20, "episode_len_mean": 20.0, "sample": 0.011597824581696333, "num_env_steps_sampled_lifetime_throughput": 2015.0778482119679}, "learners": {"__all_modules__": {"learner_connector": {"timers": {"connectors": {"numpy_to_tensor": 7.97343180167282e-05, "add_states_from_episodes_to_batch": 3.879024064030346e-06, "add_one_ts_to_episodes_and_truncate": 0.012664831640985464, "general_advantage_estimation": 0.008971891067322428, "batch_individual_items": 0.04589425077436483, "add_columns_from_episodes_to_train_batch": 0.04958554716640615, "add_observations_from_episodes_to_batch": 0.0010694276799540234, "add_time_dim_to_batch_and_zero_pad": 1.2945303254472476e-05}}, "connector_pipeline_timer": 0.11849965961412663}, "num_module_steps_trained_lifetime": 36000, "num_module_steps_trained": 6000, "num_env_steps_trained": 31500, "learner_connector_sum_episodes_length_out": 5250.0, "learner_connector_sum_episodes_length_in": 5000.0, "num_env_steps_trained_lifetime": 189000, "num_trainable_parameters": 6003, "num_non_trainable_parameters": 0, "num_env_steps_trained_lifetime_throughput": 1799346.7786823213, "num_module_steps_trained_throughput": 344263.5353791049, "num_module_steps_trained_lifetime_throughput": 343704.8290155311}, "default_policy": {"module_train_batch_size_mean": 1000.0, "total_loss": 0.0240169670432806, "vf_explained_var": -0.010707616806030273, "mean_kl_loss": 0.0018115785205736756, "num_module_steps_trained_lifetime": 36000, "num_module_steps_trained": 6000, "weights_seq_no": 6.0, "diff_num_grad_updates_vs_sampler_policy": 1.0, "vf_loss": 0.10278083384037018, "curr_kl_coeff": 0.011664004996418953, "curr_entropy_coeff": 0.0090570820258, "vf_loss_unclipped": 28.573688507080078, "default_optimizer_learning_rate": 0.0002847858517, "num_trainable_parameters": 6003, "entropy": 0.6465494632720947, "gradients_default_optimizer_global_norm": 0.05181848257780075, "policy_loss": -0.03891005367040634, "num_module_steps_trained_lifetime_throughput": 344952.9438434677}}, "num_training_step_calls_per_iteration": 1, "evaluation": {"env_runners": {"agent_episode_returns_mean": {"default_agent": 0.05}, "episode_len_mean": 20.0, "sample": 0.20126740237471077, "num_env_steps_sampled_lifetime": 30400, "env_reset_timer": 0.00014466661482212805, "env_step_timer": 2.9954399795796988e-05, "rlmodule_inference_timer": 5.5473971026081525e-05, "module_to_env_connector": {"timers": {"connectors": {"remove_single_ts_time_rank_from_batch": 1.1088086305196414e-06, "normalize_and_clip_actions": 1.5036668910210984e-05, "tensor_to_numpy": 2.2328379789075413e-05, "listify_data_for_vector_env": 1.8351185824747585e-05, "un_batch_to_individual_items": 8.381954638656248e-06, "get_actions": 7.596686408443683e-05}}, "connector_pipeline_timer": 0.00018543815091841463}, "env_to_module_sum_episodes_length_in": 10.368238394470474, "num_agent_steps_sampled": {"default_agent": 400}, "env_to_module_sum_episodes_length_out": 10.368238394470474, "episode_return_mean": 0.05, "episode_len_min": 20, "episode_duration_sec_mean": 0.008990322893951089, "num_module_steps_sampled": {"default_policy": 400}, "env_to_module_connector": {"timers": {"connectors": {"batch_individual_items": 1.612598619378981e-05, "add_observations_from_episodes_to_batch": 4.874329082720331e-06, "add_time_dim_to_batch_and_zero_pad": 5.624016152898489e-06, "numpy_to_tensor": 1.6883071912540868e-05, "add_states_from_episodes_to_batch": 2.9715642403978314e-06}}, "connector_pipeline_timer": 8.31291758817557e-05}, "episode_return_min": -12.5, "num_module_steps_sampled_lifetime": {"default_policy": 2400}, "weights_seq_no": 6.0, "num_episodes": 20, "num_episodes_lifetime": 120, "episode_len_max": 20, "num_env_steps_sampled": 400, "episode_return_max": 14.5, "num_agent_steps_sampled_lifetime": {"default_agent": 2400}, "module_episode_returns_mean": {"default_policy": 0.05}, "time_between_sampling": 2.678392125065452}, "num_healthy_workers": 1, "actor_manager_num_outstanding_async_reqs": 0, "num_remote_worker_restarts": 0}, "num_env_steps_sampled_lifetime": -2460000.0, "fault_tolerance": {"num_healthy_workers": 0, "num_remote_worker_restarts": 0}, "env_runner_group": {"actor_manager_num_outstanding_async_reqs": 0}, "done": false, "training_iteration": 6, "trial_id": "497dd_00000", "date": "2025-08-11_19-33-20", "timestamp": 1754933600, "time_this_iter_s": 3.4874610900878906, "time_total_s": 19.502825021743774, "pid": 25863, "hostname": "Mac", "node_ip": "127.0.0.1", "config": {"exploration_config": {}, "extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "placement_strategy": "PACK", "num_gpus": 0, "_fake_gpus": false, "num_cpus_for_main_process": 2, "eager_tracing": true, "eager_max_retraces": 20, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "torch_compile_learner": false, "torch_compile_learner_what_to_compile": "forward_train", "torch_compile_learner_dynamo_backend": "aot_eager", "torch_compile_learner_dynamo_mode": null, "torch_compile_worker": false, "torch_compile_worker_dynamo_backend": "aot_eager", "torch_compile_worker_dynamo_mode": null, "torch_ddp_kwargs": {}, "torch_skip_nan_gradients": false, "env": "Umbrella", "env_config": {}, "observation_space": null, "action_space": null, "clip_rewards": null, "normalize_actions": true, "clip_actions": false, "_is_atari": null, "disable_env_checking": false, "render_env": false, "action_mask_key": "action_mask", "env_runner_cls": null, "num_env_runners": 0, "create_local_env_runner": true, "num_envs_per_env_runner": 1, "gym_env_vectorize_mode": "SYNC", "num_cpus_per_env_runner": 1, "num_gpus_per_env_runner": 0, "custom_resources_per_env_runner": {}, "validate_env_runners_after_construction": true, "episodes_to_numpy": true, "max_requests_in_flight_per_env_runner": 1, "sample_timeout_s": 60.0, "_env_to_module_connector": null, "add_default_connectors_to_env_to_module_pipeline": true, "_module_to_env_connector": null, "add_default_connectors_to_module_to_env_pipeline": true, "merge_env_runner_states": "training_only", "broadcast_env_runner_states": true, "episode_lookback_horizon": 1, "rollout_fragment_length": "auto", "batch_mode": "complete_episodes", "compress_observations": false, "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "enable_tf1_exec_eagerly": false, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "preprocessor_pref": "deepmind", "observation_filter": "NoFilter", "update_worker_filter_stats": true, "use_worker_filter_stats": true, "sampler_perf_stats_ema_coef": null, "_is_online": true, "num_learners": 0, "num_gpus_per_learner": 0, "num_cpus_per_learner": "auto", "num_aggregator_actors_per_learner": 0, "max_requests_in_flight_per_aggregator_actor": 3, "local_gpu_idx": 0, "max_requests_in_flight_per_learner": 3, "gamma": 1, "lr": 0.0002847858517, "grad_clip": 0.5, "grad_clip_by": "global_norm", "_train_batch_size_per_learner": 5000, "train_batch_size": 4000, "num_epochs": 1, "minibatch_size": 1000, "shuffle_batch_per_epoch": true, "model": {"fcnet_hiddens": [256, 256], "fcnet_activation": "tanh", "fcnet_weights_initializer": null, "fcnet_weights_initializer_config": null, "fcnet_bias_initializer": null, "fcnet_bias_initializer_config": null, "conv_filters": null, "conv_activation": "relu", "conv_kernel_initializer": null, "conv_kernel_initializer_config": null, "conv_bias_initializer": null, "conv_bias_initializer_config": null, "conv_transpose_kernel_initializer": null, "conv_transpose_kernel_initializer_config": null, "conv_transpose_bias_initializer": null, "conv_transpose_bias_initializer_config": null, "post_fcnet_hiddens": [], "post_fcnet_activation": "relu", "post_fcnet_weights_initializer": null, "post_fcnet_weights_initializer_config": null, "post_fcnet_bias_initializer": null, "post_fcnet_bias_initializer_config": null, "free_log_std": false, "log_std_clip_param": 20.0, "no_final_linear": false, "vf_share_layers": false, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "lstm_weights_initializer": null, "lstm_weights_initializer_config": null, "lstm_bias_initializer": null, "lstm_bias_initializer_config": null, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "attention_use_n_prev_actions": 0, "attention_use_n_prev_rewards": 0, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": null, "custom_model_config": {}, "custom_action_dist": null, "custom_preprocessor": null, "encoder_latent_dim": null, "always_check_shapes": false, "lstm_use_prev_action_reward": -1, "_use_default_native_models": -1, "_disable_preprocessor_api": false, "_disable_action_flattening": false}, "_learner_connector": null, "add_default_connectors_to_learner_pipeline": true, "learner_config_dict": {}, "optimizer": {}, "_learner_class": null, "callbacks_on_algorithm_init": null, "callbacks_on_env_runners_recreated": null, "callbacks_on_offline_eval_runners_recreated": null, "callbacks_on_checkpoint_loaded": null, "callbacks_on_environment_created": null, "callbacks_on_episode_created": null, "callbacks_on_episode_start": null, "callbacks_on_episode_step": null, "callbacks_on_episode_end": null, "callbacks_on_evaluate_start": null, "callbacks_on_evaluate_end": null, "callbacks_on_evaluate_offline_start": null, "callbacks_on_evaluate_offline_end": null, "callbacks_on_sample_end": null, "callbacks_on_train_result": null, "explore": true, "enable_rl_module_and_learner": true, "enable_env_runner_and_connector_v2": true, "_prior_exploration_config": {"type": "StochasticSampling"}, "count_steps_by": "env_steps", "policy_map_capacity": 100, "policy_mapping_fn": "<function AlgorithmConfig.DEFAULT_POLICY_MAPPING_FN at 0x14ff39b20>", "policies_to_train": null, "policy_states_are_swappable": false, "observation_fn": null, "offline_data_class": null, "input_read_method": "read_parquet", "input_read_method_kwargs": {}, "input_read_schema": {}, "input_read_episodes": false, "input_read_sample_batches": false, "input_read_batch_size": null, "input_filesystem": null, "input_filesystem_kwargs": {}, "input_compress_columns": ["obs", "new_obs"], "input_spaces_jsonable": true, "materialize_data": false, "materialize_mapped_data": true, "map_batches_kwargs": {}, "iter_batches_kwargs": {}, "ignore_final_observation": false, "prelearner_class": null, "prelearner_buffer_class": null, "prelearner_buffer_kwargs": {}, "prelearner_module_synch_period": 10, "dataset_num_iters_per_learner": null, "input_config": {}, "actions_in_input_normalized": false, "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_config": {}, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "output_max_rows_per_file": null, "output_write_remaining_data": false, "output_write_method": "write_parquet", "output_write_method_kwargs": {}, "output_filesystem": null, "output_filesystem_kwargs": {}, "output_write_episodes": true, "offline_sampling": false, "evaluation_interval": 1, "evaluation_duration": 20, "evaluation_duration_unit": "episodes", "evaluation_sample_timeout_s": 120.0, "evaluation_auto_duration_min_env_steps_per_sample": 100, "evaluation_auto_duration_max_env_steps_per_sample": 2000, "evaluation_parallel_to_training": false, "evaluation_force_reset_envs_before_iteration": true, "evaluation_config": null, "off_policy_estimation_methods": {}, "ope_split_batch_by_episode": true, "evaluation_num_env_runners": 1, "in_evaluation": false, "sync_filters_on_rollout_workers_timeout_s": 10.0, "offline_evaluation_interval": null, "num_offline_eval_runners": 0, "offline_loss_for_module_fn": null, "offline_evaluation_duration": 1, "offline_evaluation_parallel_to_training": false, "offline_evaluation_timeout_s": 120.0, "num_cpus_per_offline_eval_runner": 1, "num_gpus_per_offline_eval_runner": 0, "custom_resources_per_offline_eval_runner": {}, "restart_failed_offline_eval_runners": true, "ignore_offline_eval_runner_failures": false, "max_num_offline_eval_runner_restarts": 1000, "offline_eval_runner_restore_timeout_s": 1800.0, "max_requests_in_flight_per_offline_eval_runner": 1, "validate_offline_eval_runners_after_construction": true, "offline_eval_runner_health_probe_timeout_s": 30.0, "offline_eval_rl_module_inference_only": false, "broadcast_offline_eval_runner_states": false, "offline_eval_batch_size_per_runner": 256, "dataset_num_iters_per_eval_runner": 1, "keep_per_episode_custom_metrics": false, "metrics_episode_collection_timeout_s": 60.0, "metrics_num_episodes_for_smoothing": 100, "min_time_s_per_iteration": null, "min_train_timesteps_per_iteration": 0, "min_sample_timesteps_per_iteration": 0, "log_gradients": true, "export_native_model_files": false, "checkpoint_trainable_policies_only": false, "logger_creator": null, "logger_config": null, "log_level": "WARN", "log_sys_usage": true, "fake_sampler": false, "seed": 7, "restart_failed_env_runners": true, "ignore_env_runner_failures": false, "max_num_env_runner_restarts": 1000, "delay_between_env_runner_restarts_s": 60.0, "restart_failed_sub_environments": false, "num_consecutive_env_runner_failures_tolerance": 100, "env_runner_health_probe_timeout_s": 30.0, "env_runner_restore_timeout_s": 1800.0, "_model_config": {}, "_rl_module_spec": "RLModuleSpec(module_class=None, observation_space=None, action_space=None, inference_only=False, learner_only=False, model_config=DefaultModelConfig(fcnet_hiddens=[60, 90], fcnet_activation='tanh', fcnet_kernel_initializer=None, fcnet_kernel_initializer_kwargs=None, fcnet_bias_initializer=None, fcnet_bias_initializer_kwargs=None, conv_filters=None, conv_activation='relu', conv_kernel_initializer=None, conv_kernel_initializer_kwargs=None, conv_bias_initializer=None, conv_bias_initializer_kwargs=None, head_fcnet_hiddens=[], head_fcnet_activation='relu', head_fcnet_kernel_initializer=None, head_fcnet_kernel_initializer_kwargs=None, head_fcnet_bias_initializer=None, head_fcnet_bias_initializer_kwargs=None, free_log_std=False, log_std_clip_param=20.0, vf_share_layers=True, use_lstm=False, max_seq_len=20, lstm_cell_size=256, lstm_use_prev_action=False, lstm_use_prev_reward=False, lstm_kernel_initializer=None, lstm_kernel_initializer_kwargs=None, lstm_bias_initializer=None, lstm_bias_initializer_kwargs=None), catalog_class=None, load_state_path=None, model_config_dict=None)", "algorithm_config_overrides_per_module": {}, "_per_module_overrides": {}, "_validate_config": true, "_use_msgpack_checkpoints": false, "_torch_grad_scaler_class": null, "_torch_lr_scheduler_classes": null, "_tf_policy_handles_more_than_one_loss": false, "_disable_preprocessor_api": false, "_disable_action_flattening": false, "_disable_initialize_loss_from_dummy_batch": false, "_dont_auto_sync_env_runner_states": false, "env_task_fn": -1, "enable_connectors": -1, "simple_optimizer": false, "policy_map_cache": -1, "worker_cls": -1, "synchronize_filters": -1, "enable_async_evaluation": -1, "custom_async_evaluation_function": -1, "_enable_rl_module_api": -1, "auto_wrap_old_gym_envs": -1, "always_attach_evaluation_results": -1, "replay_sequence_length": null, "_disable_execution_plan_api": -1, "use_critic": true, "use_gae": true, "use_kl_loss": true, "kl_coeff": 0.7464963036515, "kl_target": 0.0270990929592, "vf_loss_coeff": 0.6688075857018, "entropy_coeff": 0.0090570820258, "clip_param": 0.1221781641624, "vf_clip_param": 0.1027808522125, "entropy_coeff_schedule": null, "lr_schedule": null, "sgd_minibatch_size": -1, "vf_share_layers": -1, "__stdout_file__": null, "__stderr_file__": null, "lambda": 0.9099046732075, "input": "sampler", "policies": {"default_policy": [null, null, null, null]}, "callbacks": "<class 'ray.rllib.callbacks.callbacks.RLlibCallback'>", "create_env_on_driver": false, "custom_eval_function": null, "framework": "torch"}, "time_since_restore": 19.502825021743774, "iterations_since_restore": 6, "perf": {"cpu_util_percent": 80.08, "ram_util_percent": 78.76}}
{"timers": {"training_iteration": 3.3923317482297755, "restore_env_runners": 2.9611757687281604e-05, "training_step": 3.392062092869117, "env_runner_sampling_timer": 3.23457853212039, "learner_update_timer": 0.15162681798315591, "synch_weights": 0.001347060863728066, "restore_eval_env_runners": 1.0730221305791639e-05, "evaluation_iteration": 0.20893211537752424, "synch_eval_env_connectors": 0.000159177896562754, "synch_env_connectors": 5.8801033330018295e-06}, "env_runners": {"module_to_env_connector": {"timers": {"connectors": {"tensor_to_numpy": 2.3997074811005688e-05, "listify_data_for_vector_env": 1.914918402776857e-05, "remove_single_ts_time_rank_from_batch": 9.668740654188254e-07, "get_actions": 7.903316027587165e-05, "normalize_and_clip_actions": 1.5806188892538605e-05, "un_batch_to_individual_items": 8.778960567556917e-06}}, "connector_pipeline_timer": 0.00019006252798633297}, "time_between_sampling": 0.0030466949830919407, "num_env_steps_sampled_lifetime": -3077500.0, "env_to_module_connector": {"timers": {"connectors": {"add_observations_from_episodes_to_batch": 4.687326176247299e-06, "add_time_dim_to_batch_and_zero_pad": 4.158059158269523e-06, "batch_individual_items": 1.1506496833256268e-05, "numpy_to_tensor": 1.7266134323950407e-05, "add_states_from_episodes_to_batch": 2.8787841385203304e-06}}, "connector_pipeline_timer": 7.384509568933692e-05}, "num_module_steps_sampled_lifetime": {"default_policy": -3077500.0}, "episode_return_min": -9.5, "weights_seq_no": 6.0, "num_episodes": 250.0, "env_reset_timer": 8.267160776955703e-05, "env_to_module_sum_episodes_length_out": 10.36823839457432, "num_env_steps_sampled": 5000.0, "env_step_timer": 2.6043543308933187e-05, "episode_return_mean": 3.7, "episode_return_max": 10.5, "episode_len_min": 20, "num_agent_steps_sampled_lifetime": {"default_agent": -3077500.0}, "rlmodule_inference_timer": 5.327660755407673e-05, "module_episode_returns_mean": {"default_policy": 3.7}, "agent_episode_returns_mean": {"default_agent": 3.7}, "num_episodes_lifetime": -153875.0, "num_module_steps_sampled": {"default_policy": 5000.0}, "num_agent_steps_sampled": {"default_agent": 5000.0}, "episode_duration_sec_mean": 0.00821823369106278, "env_to_module_sum_episodes_length_in": 10.36823839457432, "episode_len_max": 20, "episode_len_mean": 20.0, "sample": 0.009244209966893947, "num_env_steps_sampled_lifetime_throughput": 2378.2037436399787}, "learners": {"__all_modules__": {"learner_connector": {"timers": {"connectors": {"numpy_to_tensor": 7.958739422452733e-05, "add_states_from_episodes_to_batch": 3.876073444367683e-06, "add_one_ts_to_episodes_and_truncate": 0.012725380405388958, "general_advantage_estimation": 0.008943362155754612, "batch_individual_items": 0.045821359517010024, "add_columns_from_episodes_to_train_batch": 0.049529005024731176, "add_observations_from_episodes_to_batch": 0.0010714325627152082, "add_time_dim_to_batch_and_zero_pad": 1.2922930199097385e-05}}, "connector_pipeline_timer": 0.11840375176712586}, "num_module_steps_trained_lifetime": 42000, "num_module_steps_trained": 6000, "num_env_steps_trained": 31500, "learner_connector_sum_episodes_length_out": 5250.0, "learner_connector_sum_episodes_length_in": 5000.0, "num_env_steps_trained_lifetime": 220500, "num_trainable_parameters": 6003, "num_non_trainable_parameters": 0, "num_env_steps_trained_lifetime_throughput": 1791735.3369755566, "num_module_steps_trained_throughput": 342752.74737286463, "num_module_steps_trained_lifetime_throughput": 342213.75638199796}, "default_policy": {"module_train_batch_size_mean": 1000.0, "total_loss": 0.24163073301315308, "vf_explained_var": -0.010732293128967285, "mean_kl_loss": 0.00035054117324762046, "num_module_steps_trained_lifetime": 42000, "num_module_steps_trained": 6000, "weights_seq_no": 7.0, "diff_num_grad_updates_vs_sampler_policy": 1.0, "vf_loss": 0.10278083384037018, "curr_kl_coeff": 0.0058320024982094765, "curr_entropy_coeff": 0.0090570820258, "vf_loss_unclipped": 28.70351791381836, "default_optimizer_learning_rate": 0.0002847858517, "num_trainable_parameters": 6003, "entropy": 0.6365110874176025, "gradients_default_optimizer_global_norm": 0.12011439353227615, "policy_loss": 0.17865099012851715, "num_module_steps_trained_lifetime_throughput": 343395.81353615137}}, "num_training_step_calls_per_iteration": 1, "evaluation": {"env_runners": {"agent_episode_returns_mean": {"default_agent": -0.35}, "episode_len_mean": 20.0, "sample": 0.20050416669127366, "num_env_steps_sampled_lifetime": 35400, "env_reset_timer": 0.00014437744875653373, "env_step_timer": 1.810955828111444e-05, "rlmodule_inference_timer": 3.2559361152575115e-05, "module_to_env_connector": {"timers": {"connectors": {"remove_single_ts_time_rank_from_batch": 6.4770898183453e-07, "normalize_and_clip_actions": 1.0851080171384907e-05, "tensor_to_numpy": 1.5239901704825554e-05, "listify_data_for_vector_env": 1.2883052641840734e-05, "un_batch_to_individual_items": 6.591947163702755e-06, "get_actions": 4.79424762665537e-05}}, "connector_pipeline_timer": 0.00012260912186253385}, "env_to_module_sum_episodes_length_in": 10.368238394572801, "num_agent_steps_sampled": {"default_agent": 400}, "env_to_module_sum_episodes_length_out": 10.368238394572801, "episode_return_mean": -0.35, "episode_len_min": 20, "episode_duration_sec_mean": 0.007855623317882419, "num_module_steps_sampled": {"default_policy": 400}, "env_to_module_connector": {"timers": {"connectors": {"batch_individual_items": 7.996487727371812e-06, "add_observations_from_episodes_to_batch": 3.4695387366088734e-06, "add_time_dim_to_batch_and_zero_pad": 3.037955454669364e-06, "numpy_to_tensor": 1.0181529864280508e-05, "add_states_from_episodes_to_batch": 1.978979144845982e-06}}, "connector_pipeline_timer": 5.1588827417901855e-05}, "episode_return_min": -12.5, "num_module_steps_sampled_lifetime": {"default_policy": 2800}, "weights_seq_no": 7.0, "num_episodes": 20, "num_episodes_lifetime": 140, "episode_len_max": 20, "num_env_steps_sampled": 400, "episode_return_max": 14.5, "num_agent_steps_sampled_lifetime": {"default_agent": 2800}, "module_episode_returns_mean": {"default_policy": -0.35}, "time_between_sampling": 2.677887321314741}, "num_healthy_workers": 1, "actor_manager_num_outstanding_async_reqs": 0, "num_remote_worker_restarts": 0}, "num_env_steps_sampled_lifetime": -3077500.0, "fault_tolerance": {"num_healthy_workers": 0, "num_remote_worker_restarts": 0}, "env_runner_group": {"actor_manager_num_outstanding_async_reqs": 0}, "done": false, "training_iteration": 7, "trial_id": "497dd_00000", "date": "2025-08-11_19-33-23", "timestamp": 1754933603, "time_this_iter_s": 2.740386962890625, "time_total_s": 22.2432119846344, "pid": 25863, "hostname": "Mac", "node_ip": "127.0.0.1", "config": {"exploration_config": {}, "extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "placement_strategy": "PACK", "num_gpus": 0, "_fake_gpus": false, "num_cpus_for_main_process": 2, "eager_tracing": true, "eager_max_retraces": 20, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "torch_compile_learner": false, "torch_compile_learner_what_to_compile": "forward_train", "torch_compile_learner_dynamo_backend": "aot_eager", "torch_compile_learner_dynamo_mode": null, "torch_compile_worker": false, "torch_compile_worker_dynamo_backend": "aot_eager", "torch_compile_worker_dynamo_mode": null, "torch_ddp_kwargs": {}, "torch_skip_nan_gradients": false, "env": "Umbrella", "env_config": {}, "observation_space": null, "action_space": null, "clip_rewards": null, "normalize_actions": true, "clip_actions": false, "_is_atari": null, "disable_env_checking": false, "render_env": false, "action_mask_key": "action_mask", "env_runner_cls": null, "num_env_runners": 0, "create_local_env_runner": true, "num_envs_per_env_runner": 1, "gym_env_vectorize_mode": "SYNC", "num_cpus_per_env_runner": 1, "num_gpus_per_env_runner": 0, "custom_resources_per_env_runner": {}, "validate_env_runners_after_construction": true, "episodes_to_numpy": true, "max_requests_in_flight_per_env_runner": 1, "sample_timeout_s": 60.0, "_env_to_module_connector": null, "add_default_connectors_to_env_to_module_pipeline": true, "_module_to_env_connector": null, "add_default_connectors_to_module_to_env_pipeline": true, "merge_env_runner_states": "training_only", "broadcast_env_runner_states": true, "episode_lookback_horizon": 1, "rollout_fragment_length": "auto", "batch_mode": "complete_episodes", "compress_observations": false, "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "enable_tf1_exec_eagerly": false, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "preprocessor_pref": "deepmind", "observation_filter": "NoFilter", "update_worker_filter_stats": true, "use_worker_filter_stats": true, "sampler_perf_stats_ema_coef": null, "_is_online": true, "num_learners": 0, "num_gpus_per_learner": 0, "num_cpus_per_learner": "auto", "num_aggregator_actors_per_learner": 0, "max_requests_in_flight_per_aggregator_actor": 3, "local_gpu_idx": 0, "max_requests_in_flight_per_learner": 3, "gamma": 1, "lr": 0.0002847858517, "grad_clip": 0.5, "grad_clip_by": "global_norm", "_train_batch_size_per_learner": 5000, "train_batch_size": 4000, "num_epochs": 1, "minibatch_size": 1000, "shuffle_batch_per_epoch": true, "model": {"fcnet_hiddens": [256, 256], "fcnet_activation": "tanh", "fcnet_weights_initializer": null, "fcnet_weights_initializer_config": null, "fcnet_bias_initializer": null, "fcnet_bias_initializer_config": null, "conv_filters": null, "conv_activation": "relu", "conv_kernel_initializer": null, "conv_kernel_initializer_config": null, "conv_bias_initializer": null, "conv_bias_initializer_config": null, "conv_transpose_kernel_initializer": null, "conv_transpose_kernel_initializer_config": null, "conv_transpose_bias_initializer": null, "conv_transpose_bias_initializer_config": null, "post_fcnet_hiddens": [], "post_fcnet_activation": "relu", "post_fcnet_weights_initializer": null, "post_fcnet_weights_initializer_config": null, "post_fcnet_bias_initializer": null, "post_fcnet_bias_initializer_config": null, "free_log_std": false, "log_std_clip_param": 20.0, "no_final_linear": false, "vf_share_layers": false, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "lstm_weights_initializer": null, "lstm_weights_initializer_config": null, "lstm_bias_initializer": null, "lstm_bias_initializer_config": null, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "attention_use_n_prev_actions": 0, "attention_use_n_prev_rewards": 0, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": null, "custom_model_config": {}, "custom_action_dist": null, "custom_preprocessor": null, "encoder_latent_dim": null, "always_check_shapes": false, "lstm_use_prev_action_reward": -1, "_use_default_native_models": -1, "_disable_preprocessor_api": false, "_disable_action_flattening": false}, "_learner_connector": null, "add_default_connectors_to_learner_pipeline": true, "learner_config_dict": {}, "optimizer": {}, "_learner_class": null, "callbacks_on_algorithm_init": null, "callbacks_on_env_runners_recreated": null, "callbacks_on_offline_eval_runners_recreated": null, "callbacks_on_checkpoint_loaded": null, "callbacks_on_environment_created": null, "callbacks_on_episode_created": null, "callbacks_on_episode_start": null, "callbacks_on_episode_step": null, "callbacks_on_episode_end": null, "callbacks_on_evaluate_start": null, "callbacks_on_evaluate_end": null, "callbacks_on_evaluate_offline_start": null, "callbacks_on_evaluate_offline_end": null, "callbacks_on_sample_end": null, "callbacks_on_train_result": null, "explore": true, "enable_rl_module_and_learner": true, "enable_env_runner_and_connector_v2": true, "_prior_exploration_config": {"type": "StochasticSampling"}, "count_steps_by": "env_steps", "policy_map_capacity": 100, "policy_mapping_fn": "<function AlgorithmConfig.DEFAULT_POLICY_MAPPING_FN at 0x14ff39b20>", "policies_to_train": null, "policy_states_are_swappable": false, "observation_fn": null, "offline_data_class": null, "input_read_method": "read_parquet", "input_read_method_kwargs": {}, "input_read_schema": {}, "input_read_episodes": false, "input_read_sample_batches": false, "input_read_batch_size": null, "input_filesystem": null, "input_filesystem_kwargs": {}, "input_compress_columns": ["obs", "new_obs"], "input_spaces_jsonable": true, "materialize_data": false, "materialize_mapped_data": true, "map_batches_kwargs": {}, "iter_batches_kwargs": {}, "ignore_final_observation": false, "prelearner_class": null, "prelearner_buffer_class": null, "prelearner_buffer_kwargs": {}, "prelearner_module_synch_period": 10, "dataset_num_iters_per_learner": null, "input_config": {}, "actions_in_input_normalized": false, "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_config": {}, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "output_max_rows_per_file": null, "output_write_remaining_data": false, "output_write_method": "write_parquet", "output_write_method_kwargs": {}, "output_filesystem": null, "output_filesystem_kwargs": {}, "output_write_episodes": true, "offline_sampling": false, "evaluation_interval": 1, "evaluation_duration": 20, "evaluation_duration_unit": "episodes", "evaluation_sample_timeout_s": 120.0, "evaluation_auto_duration_min_env_steps_per_sample": 100, "evaluation_auto_duration_max_env_steps_per_sample": 2000, "evaluation_parallel_to_training": false, "evaluation_force_reset_envs_before_iteration": true, "evaluation_config": null, "off_policy_estimation_methods": {}, "ope_split_batch_by_episode": true, "evaluation_num_env_runners": 1, "in_evaluation": false, "sync_filters_on_rollout_workers_timeout_s": 10.0, "offline_evaluation_interval": null, "num_offline_eval_runners": 0, "offline_loss_for_module_fn": null, "offline_evaluation_duration": 1, "offline_evaluation_parallel_to_training": false, "offline_evaluation_timeout_s": 120.0, "num_cpus_per_offline_eval_runner": 1, "num_gpus_per_offline_eval_runner": 0, "custom_resources_per_offline_eval_runner": {}, "restart_failed_offline_eval_runners": true, "ignore_offline_eval_runner_failures": false, "max_num_offline_eval_runner_restarts": 1000, "offline_eval_runner_restore_timeout_s": 1800.0, "max_requests_in_flight_per_offline_eval_runner": 1, "validate_offline_eval_runners_after_construction": true, "offline_eval_runner_health_probe_timeout_s": 30.0, "offline_eval_rl_module_inference_only": false, "broadcast_offline_eval_runner_states": false, "offline_eval_batch_size_per_runner": 256, "dataset_num_iters_per_eval_runner": 1, "keep_per_episode_custom_metrics": false, "metrics_episode_collection_timeout_s": 60.0, "metrics_num_episodes_for_smoothing": 100, "min_time_s_per_iteration": null, "min_train_timesteps_per_iteration": 0, "min_sample_timesteps_per_iteration": 0, "log_gradients": true, "export_native_model_files": false, "checkpoint_trainable_policies_only": false, "logger_creator": null, "logger_config": null, "log_level": "WARN", "log_sys_usage": true, "fake_sampler": false, "seed": 7, "restart_failed_env_runners": true, "ignore_env_runner_failures": false, "max_num_env_runner_restarts": 1000, "delay_between_env_runner_restarts_s": 60.0, "restart_failed_sub_environments": false, "num_consecutive_env_runner_failures_tolerance": 100, "env_runner_health_probe_timeout_s": 30.0, "env_runner_restore_timeout_s": 1800.0, "_model_config": {}, "_rl_module_spec": "RLModuleSpec(module_class=None, observation_space=None, action_space=None, inference_only=False, learner_only=False, model_config=DefaultModelConfig(fcnet_hiddens=[60, 90], fcnet_activation='tanh', fcnet_kernel_initializer=None, fcnet_kernel_initializer_kwargs=None, fcnet_bias_initializer=None, fcnet_bias_initializer_kwargs=None, conv_filters=None, conv_activation='relu', conv_kernel_initializer=None, conv_kernel_initializer_kwargs=None, conv_bias_initializer=None, conv_bias_initializer_kwargs=None, head_fcnet_hiddens=[], head_fcnet_activation='relu', head_fcnet_kernel_initializer=None, head_fcnet_kernel_initializer_kwargs=None, head_fcnet_bias_initializer=None, head_fcnet_bias_initializer_kwargs=None, free_log_std=False, log_std_clip_param=20.0, vf_share_layers=True, use_lstm=False, max_seq_len=20, lstm_cell_size=256, lstm_use_prev_action=False, lstm_use_prev_reward=False, lstm_kernel_initializer=None, lstm_kernel_initializer_kwargs=None, lstm_bias_initializer=None, lstm_bias_initializer_kwargs=None), catalog_class=None, load_state_path=None, model_config_dict=None)", "algorithm_config_overrides_per_module": {}, "_per_module_overrides": {}, "_validate_config": true, "_use_msgpack_checkpoints": false, "_torch_grad_scaler_class": null, "_torch_lr_scheduler_classes": null, "_tf_policy_handles_more_than_one_loss": false, "_disable_preprocessor_api": false, "_disable_action_flattening": false, "_disable_initialize_loss_from_dummy_batch": false, "_dont_auto_sync_env_runner_states": false, "env_task_fn": -1, "enable_connectors": -1, "simple_optimizer": false, "policy_map_cache": -1, "worker_cls": -1, "synchronize_filters": -1, "enable_async_evaluation": -1, "custom_async_evaluation_function": -1, "_enable_rl_module_api": -1, "auto_wrap_old_gym_envs": -1, "always_attach_evaluation_results": -1, "replay_sequence_length": null, "_disable_execution_plan_api": -1, "use_critic": true, "use_gae": true, "use_kl_loss": true, "kl_coeff": 0.7464963036515, "kl_target": 0.0270990929592, "vf_loss_coeff": 0.6688075857018, "entropy_coeff": 0.0090570820258, "clip_param": 0.1221781641624, "vf_clip_param": 0.1027808522125, "entropy_coeff_schedule": null, "lr_schedule": null, "sgd_minibatch_size": -1, "vf_share_layers": -1, "__stdout_file__": null, "__stderr_file__": null, "lambda": 0.9099046732075, "input": "sampler", "policies": {"default_policy": [null, null, null, null]}, "callbacks": "<class 'ray.rllib.callbacks.callbacks.RLlibCallback'>", "create_env_on_driver": false, "custom_eval_function": null, "framework": "torch"}, "time_since_restore": 22.2432119846344, "iterations_since_restore": 7, "perf": {"cpu_util_percent": 76.79999999999998, "ram_util_percent": 79.425}}
{"timers": {"training_iteration": 3.3846966044979863, "restore_env_runners": 2.937980939995301e-05, "training_step": 3.38442750027064, "env_runner_sampling_timer": 3.2270836334588826, "learner_update_timer": 0.15150661355346845, "synch_weights": 0.0013421235854921912, "restore_eval_env_runners": 1.0689578506011826e-05, "evaluation_iteration": 0.20814802255347828, "synch_eval_env_connectors": 0.00015867819692549952, "synch_env_connectors": 5.874641471826476e-06}, "env_runners": {"module_to_env_connector": {"timers": {"connectors": {"tensor_to_numpy": 2.250925297175211e-05, "listify_data_for_vector_env": 1.8323674494523243e-05, "remove_single_ts_time_rank_from_batch": 9.856872939622132e-07, "get_actions": 7.564758906392499e-05, "normalize_and_clip_actions": 1.548963837630584e-05, "un_batch_to_individual_items": 8.54894104873237e-06}}, "connector_pipeline_timer": 0.00018158410437948773}, "time_between_sampling": 0.0022591640933493848, "num_env_steps_sampled_lifetime": -3695000.0, "env_to_module_connector": {"timers": {"connectors": {"add_observations_from_episodes_to_batch": 4.865473685051319e-06, "add_time_dim_to_batch_and_zero_pad": 4.190417346595606e-06, "batch_individual_items": 1.1318766474755597e-05, "numpy_to_tensor": 1.6152784778969678e-05, "add_states_from_episodes_to_batch": 2.6382793486839925e-06}}, "connector_pipeline_timer": 7.196078156300859e-05}, "num_module_steps_sampled_lifetime": {"default_policy": -3695000.0}, "episode_return_min": -9.5, "weights_seq_no": 7.0, "num_episodes": 250.0, "env_reset_timer": 7.713652976027155e-05, "env_to_module_sum_episodes_length_out": 10.36823839457432, "num_env_steps_sampled": 5000.0, "env_step_timer": 2.5582830548514353e-05, "episode_return_mean": 5.14, "episode_return_max": 10.5, "episode_len_min": 20, "num_agent_steps_sampled_lifetime": {"default_agent": -3695000.0}, "rlmodule_inference_timer": 7.171252724431884e-05, "module_episode_returns_mean": {"default_policy": 5.14}, "agent_episode_returns_mean": {"default_agent": 5.14}, "num_episodes_lifetime": -184750.0, "num_module_steps_sampled": {"default_policy": 5000.0}, "num_agent_steps_sampled": {"default_agent": 5000.0}, "episode_duration_sec_mean": 0.008389513874426484, "env_to_module_sum_episodes_length_in": 10.36823839457432, "episode_len_max": 20, "episode_len_mean": 20.0, "sample": 0.008870360382159586, "num_env_steps_sampled_lifetime_throughput": 2403.871029892144}, "learners": {"__all_modules__": {"learner_connector": {"timers": {"connectors": {"numpy_to_tensor": 7.954235952685637e-05, "add_states_from_episodes_to_batch": 3.877313014503741e-06, "add_one_ts_to_episodes_and_truncate": 0.012677216601698136, "general_advantage_estimation": 0.008975481033673885, "batch_individual_items": 0.04582469342229381, "add_columns_from_episodes_to_train_batch": 0.04942968164495976, "add_observations_from_episodes_to_batch": 0.0010718382367780374, "add_time_dim_to_batch_and_zero_pad": 1.2922031327122333e-05}}, "connector_pipeline_timer": 0.11829138007896782}, "num_module_steps_trained_lifetime": 48000, "num_module_steps_trained": 6000, "num_env_steps_trained": 31500, "learner_connector_sum_episodes_length_out": 5250.0, "learner_connector_sum_episodes_length_in": 5000.0, "num_env_steps_trained_lifetime": 252000, "num_trainable_parameters": 6003, "num_non_trainable_parameters": 0, "num_env_steps_trained_lifetime_throughput": 1776138.6923327711, "num_module_steps_trained_throughput": 339713.50359680207, "num_module_steps_trained_lifetime_throughput": 339198.089296786}, "default_policy": {"module_train_batch_size_mean": 1000.0, "total_loss": -0.16482774913311005, "vf_explained_var": -0.009645938873291016, "mean_kl_loss": 0.0007228472968563437, "num_module_steps_trained_lifetime": 48000, "num_module_steps_trained": 6000, "weights_seq_no": 8.0, "diff_num_grad_updates_vs_sampler_policy": 1.0, "vf_loss": 0.10278083384037018, "curr_kl_coeff": 0.0029160012491047382, "curr_entropy_coeff": 0.0090570820258, "vf_loss_unclipped": 28.108274459838867, "default_optimizer_learning_rate": 0.0002847858517, "num_trainable_parameters": 6003, "entropy": 0.6174891591072083, "gradients_default_optimizer_global_norm": 0.016537001356482506, "policy_loss": -0.22797994315624237, "num_module_steps_trained_lifetime_throughput": 340305.4956325026}}, "num_training_step_calls_per_iteration": 1, "evaluation": {"env_runners": {"agent_episode_returns_mean": {"default_agent": -0.15}, "episode_len_mean": 20.0, "sample": 0.19994351210520728, "num_env_steps_sampled_lifetime": 40400, "env_reset_timer": 0.0001444678442744389, "env_step_timer": 1.893327992154253e-05, "rlmodule_inference_timer": 3.6924042598679244e-05, "module_to_env_connector": {"timers": {"connectors": {"remove_single_ts_time_rank_from_batch": 8.407833705009549e-07, "normalize_and_clip_actions": 1.2132099657497373e-05, "tensor_to_numpy": 1.799914283705895e-05, "listify_data_for_vector_env": 1.3917458352545858e-05, "un_batch_to_individual_items": 6.633176204063334e-06, "get_actions": 5.131076704369249e-05}}, "connector_pipeline_timer": 0.00013463709073705562}, "env_to_module_sum_episodes_length_in": 10.3682383945743, "num_agent_steps_sampled": {"default_agent": 400}, "env_to_module_sum_episodes_length_out": 10.3682383945743, "episode_return_mean": -0.15, "episode_len_min": 20, "episode_duration_sec_mean": 0.007390681256074458, "num_module_steps_sampled": {"default_policy": 400}, "env_to_module_connector": {"timers": {"connectors": {"batch_individual_items": 8.196116719355656e-06, "add_observations_from_episodes_to_batch": 3.846402670500318e-06, "add_time_dim_to_batch_and_zero_pad": 2.9590262664717094e-06, "numpy_to_tensor": 1.2437787327683533e-05, "add_states_from_episodes_to_batch": 2.0987982461064334e-06}}, "connector_pipeline_timer": 5.6239426535426975e-05}, "episode_return_min": -12.5, "num_module_steps_sampled_lifetime": {"default_policy": 3200}, "weights_seq_no": 8.0, "num_episodes": 20, "num_episodes_lifetime": 160, "episode_len_max": 20, "num_env_steps_sampled": 400, "episode_return_max": 14.5, "num_agent_steps_sampled_lifetime": {"default_agent": 3200}, "module_episode_returns_mean": {"default_policy": -0.15}, "time_between_sampling": 2.6776088472713386}, "num_healthy_workers": 1, "actor_manager_num_outstanding_async_reqs": 0, "num_remote_worker_restarts": 0}, "num_env_steps_sampled_lifetime": -3695000.0, "fault_tolerance": {"num_healthy_workers": 0, "num_remote_worker_restarts": 0}, "env_runner_group": {"actor_manager_num_outstanding_async_reqs": 0}, "done": false, "training_iteration": 8, "trial_id": "497dd_00000", "date": "2025-08-11_19-33-26", "timestamp": 1754933606, "time_this_iter_s": 2.78383207321167, "time_total_s": 25.02704405784607, "pid": 25863, "hostname": "Mac", "node_ip": "127.0.0.1", "config": {"exploration_config": {}, "extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "placement_strategy": "PACK", "num_gpus": 0, "_fake_gpus": false, "num_cpus_for_main_process": 2, "eager_tracing": true, "eager_max_retraces": 20, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "torch_compile_learner": false, "torch_compile_learner_what_to_compile": "forward_train", "torch_compile_learner_dynamo_backend": "aot_eager", "torch_compile_learner_dynamo_mode": null, "torch_compile_worker": false, "torch_compile_worker_dynamo_backend": "aot_eager", "torch_compile_worker_dynamo_mode": null, "torch_ddp_kwargs": {}, "torch_skip_nan_gradients": false, "env": "Umbrella", "env_config": {}, "observation_space": null, "action_space": null, "clip_rewards": null, "normalize_actions": true, "clip_actions": false, "_is_atari": null, "disable_env_checking": false, "render_env": false, "action_mask_key": "action_mask", "env_runner_cls": null, "num_env_runners": 0, "create_local_env_runner": true, "num_envs_per_env_runner": 1, "gym_env_vectorize_mode": "SYNC", "num_cpus_per_env_runner": 1, "num_gpus_per_env_runner": 0, "custom_resources_per_env_runner": {}, "validate_env_runners_after_construction": true, "episodes_to_numpy": true, "max_requests_in_flight_per_env_runner": 1, "sample_timeout_s": 60.0, "_env_to_module_connector": null, "add_default_connectors_to_env_to_module_pipeline": true, "_module_to_env_connector": null, "add_default_connectors_to_module_to_env_pipeline": true, "merge_env_runner_states": "training_only", "broadcast_env_runner_states": true, "episode_lookback_horizon": 1, "rollout_fragment_length": "auto", "batch_mode": "complete_episodes", "compress_observations": false, "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "enable_tf1_exec_eagerly": false, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "preprocessor_pref": "deepmind", "observation_filter": "NoFilter", "update_worker_filter_stats": true, "use_worker_filter_stats": true, "sampler_perf_stats_ema_coef": null, "_is_online": true, "num_learners": 0, "num_gpus_per_learner": 0, "num_cpus_per_learner": "auto", "num_aggregator_actors_per_learner": 0, "max_requests_in_flight_per_aggregator_actor": 3, "local_gpu_idx": 0, "max_requests_in_flight_per_learner": 3, "gamma": 1, "lr": 0.0002847858517, "grad_clip": 0.5, "grad_clip_by": "global_norm", "_train_batch_size_per_learner": 5000, "train_batch_size": 4000, "num_epochs": 1, "minibatch_size": 1000, "shuffle_batch_per_epoch": true, "model": {"fcnet_hiddens": [256, 256], "fcnet_activation": "tanh", "fcnet_weights_initializer": null, "fcnet_weights_initializer_config": null, "fcnet_bias_initializer": null, "fcnet_bias_initializer_config": null, "conv_filters": null, "conv_activation": "relu", "conv_kernel_initializer": null, "conv_kernel_initializer_config": null, "conv_bias_initializer": null, "conv_bias_initializer_config": null, "conv_transpose_kernel_initializer": null, "conv_transpose_kernel_initializer_config": null, "conv_transpose_bias_initializer": null, "conv_transpose_bias_initializer_config": null, "post_fcnet_hiddens": [], "post_fcnet_activation": "relu", "post_fcnet_weights_initializer": null, "post_fcnet_weights_initializer_config": null, "post_fcnet_bias_initializer": null, "post_fcnet_bias_initializer_config": null, "free_log_std": false, "log_std_clip_param": 20.0, "no_final_linear": false, "vf_share_layers": false, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "lstm_weights_initializer": null, "lstm_weights_initializer_config": null, "lstm_bias_initializer": null, "lstm_bias_initializer_config": null, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "attention_use_n_prev_actions": 0, "attention_use_n_prev_rewards": 0, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": null, "custom_model_config": {}, "custom_action_dist": null, "custom_preprocessor": null, "encoder_latent_dim": null, "always_check_shapes": false, "lstm_use_prev_action_reward": -1, "_use_default_native_models": -1, "_disable_preprocessor_api": false, "_disable_action_flattening": false}, "_learner_connector": null, "add_default_connectors_to_learner_pipeline": true, "learner_config_dict": {}, "optimizer": {}, "_learner_class": null, "callbacks_on_algorithm_init": null, "callbacks_on_env_runners_recreated": null, "callbacks_on_offline_eval_runners_recreated": null, "callbacks_on_checkpoint_loaded": null, "callbacks_on_environment_created": null, "callbacks_on_episode_created": null, "callbacks_on_episode_start": null, "callbacks_on_episode_step": null, "callbacks_on_episode_end": null, "callbacks_on_evaluate_start": null, "callbacks_on_evaluate_end": null, "callbacks_on_evaluate_offline_start": null, "callbacks_on_evaluate_offline_end": null, "callbacks_on_sample_end": null, "callbacks_on_train_result": null, "explore": true, "enable_rl_module_and_learner": true, "enable_env_runner_and_connector_v2": true, "_prior_exploration_config": {"type": "StochasticSampling"}, "count_steps_by": "env_steps", "policy_map_capacity": 100, "policy_mapping_fn": "<function AlgorithmConfig.DEFAULT_POLICY_MAPPING_FN at 0x14ff39b20>", "policies_to_train": null, "policy_states_are_swappable": false, "observation_fn": null, "offline_data_class": null, "input_read_method": "read_parquet", "input_read_method_kwargs": {}, "input_read_schema": {}, "input_read_episodes": false, "input_read_sample_batches": false, "input_read_batch_size": null, "input_filesystem": null, "input_filesystem_kwargs": {}, "input_compress_columns": ["obs", "new_obs"], "input_spaces_jsonable": true, "materialize_data": false, "materialize_mapped_data": true, "map_batches_kwargs": {}, "iter_batches_kwargs": {}, "ignore_final_observation": false, "prelearner_class": null, "prelearner_buffer_class": null, "prelearner_buffer_kwargs": {}, "prelearner_module_synch_period": 10, "dataset_num_iters_per_learner": null, "input_config": {}, "actions_in_input_normalized": false, "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_config": {}, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "output_max_rows_per_file": null, "output_write_remaining_data": false, "output_write_method": "write_parquet", "output_write_method_kwargs": {}, "output_filesystem": null, "output_filesystem_kwargs": {}, "output_write_episodes": true, "offline_sampling": false, "evaluation_interval": 1, "evaluation_duration": 20, "evaluation_duration_unit": "episodes", "evaluation_sample_timeout_s": 120.0, "evaluation_auto_duration_min_env_steps_per_sample": 100, "evaluation_auto_duration_max_env_steps_per_sample": 2000, "evaluation_parallel_to_training": false, "evaluation_force_reset_envs_before_iteration": true, "evaluation_config": null, "off_policy_estimation_methods": {}, "ope_split_batch_by_episode": true, "evaluation_num_env_runners": 1, "in_evaluation": false, "sync_filters_on_rollout_workers_timeout_s": 10.0, "offline_evaluation_interval": null, "num_offline_eval_runners": 0, "offline_loss_for_module_fn": null, "offline_evaluation_duration": 1, "offline_evaluation_parallel_to_training": false, "offline_evaluation_timeout_s": 120.0, "num_cpus_per_offline_eval_runner": 1, "num_gpus_per_offline_eval_runner": 0, "custom_resources_per_offline_eval_runner": {}, "restart_failed_offline_eval_runners": true, "ignore_offline_eval_runner_failures": false, "max_num_offline_eval_runner_restarts": 1000, "offline_eval_runner_restore_timeout_s": 1800.0, "max_requests_in_flight_per_offline_eval_runner": 1, "validate_offline_eval_runners_after_construction": true, "offline_eval_runner_health_probe_timeout_s": 30.0, "offline_eval_rl_module_inference_only": false, "broadcast_offline_eval_runner_states": false, "offline_eval_batch_size_per_runner": 256, "dataset_num_iters_per_eval_runner": 1, "keep_per_episode_custom_metrics": false, "metrics_episode_collection_timeout_s": 60.0, "metrics_num_episodes_for_smoothing": 100, "min_time_s_per_iteration": null, "min_train_timesteps_per_iteration": 0, "min_sample_timesteps_per_iteration": 0, "log_gradients": true, "export_native_model_files": false, "checkpoint_trainable_policies_only": false, "logger_creator": null, "logger_config": null, "log_level": "WARN", "log_sys_usage": true, "fake_sampler": false, "seed": 7, "restart_failed_env_runners": true, "ignore_env_runner_failures": false, "max_num_env_runner_restarts": 1000, "delay_between_env_runner_restarts_s": 60.0, "restart_failed_sub_environments": false, "num_consecutive_env_runner_failures_tolerance": 100, "env_runner_health_probe_timeout_s": 30.0, "env_runner_restore_timeout_s": 1800.0, "_model_config": {}, "_rl_module_spec": "RLModuleSpec(module_class=None, observation_space=None, action_space=None, inference_only=False, learner_only=False, model_config=DefaultModelConfig(fcnet_hiddens=[60, 90], fcnet_activation='tanh', fcnet_kernel_initializer=None, fcnet_kernel_initializer_kwargs=None, fcnet_bias_initializer=None, fcnet_bias_initializer_kwargs=None, conv_filters=None, conv_activation='relu', conv_kernel_initializer=None, conv_kernel_initializer_kwargs=None, conv_bias_initializer=None, conv_bias_initializer_kwargs=None, head_fcnet_hiddens=[], head_fcnet_activation='relu', head_fcnet_kernel_initializer=None, head_fcnet_kernel_initializer_kwargs=None, head_fcnet_bias_initializer=None, head_fcnet_bias_initializer_kwargs=None, free_log_std=False, log_std_clip_param=20.0, vf_share_layers=True, use_lstm=False, max_seq_len=20, lstm_cell_size=256, lstm_use_prev_action=False, lstm_use_prev_reward=False, lstm_kernel_initializer=None, lstm_kernel_initializer_kwargs=None, lstm_bias_initializer=None, lstm_bias_initializer_kwargs=None), catalog_class=None, load_state_path=None, model_config_dict=None)", "algorithm_config_overrides_per_module": {}, "_per_module_overrides": {}, "_validate_config": true, "_use_msgpack_checkpoints": false, "_torch_grad_scaler_class": null, "_torch_lr_scheduler_classes": null, "_tf_policy_handles_more_than_one_loss": false, "_disable_preprocessor_api": false, "_disable_action_flattening": false, "_disable_initialize_loss_from_dummy_batch": false, "_dont_auto_sync_env_runner_states": false, "env_task_fn": -1, "enable_connectors": -1, "simple_optimizer": false, "policy_map_cache": -1, "worker_cls": -1, "synchronize_filters": -1, "enable_async_evaluation": -1, "custom_async_evaluation_function": -1, "_enable_rl_module_api": -1, "auto_wrap_old_gym_envs": -1, "always_attach_evaluation_results": -1, "replay_sequence_length": null, "_disable_execution_plan_api": -1, "use_critic": true, "use_gae": true, "use_kl_loss": true, "kl_coeff": 0.7464963036515, "kl_target": 0.0270990929592, "vf_loss_coeff": 0.6688075857018, "entropy_coeff": 0.0090570820258, "clip_param": 0.1221781641624, "vf_clip_param": 0.1027808522125, "entropy_coeff_schedule": null, "lr_schedule": null, "sgd_minibatch_size": -1, "vf_share_layers": -1, "__stdout_file__": null, "__stderr_file__": null, "lambda": 0.9099046732075, "input": "sampler", "policies": {"default_policy": [null, null, null, null]}, "callbacks": "<class 'ray.rllib.callbacks.callbacks.RLlibCallback'>", "create_env_on_driver": false, "custom_eval_function": null, "framework": "torch"}, "time_since_restore": 25.02704405784607, "iterations_since_restore": 8, "perf": {"cpu_util_percent": 35.95, "ram_util_percent": 79.825}}
{"timers": {"training_iteration": 3.3786391297038842, "restore_env_runners": 2.9153931497166968e-05, "training_step": 3.378370644848788, "env_runner_sampling_timer": 3.2198321600447235, "learner_update_timer": 0.15272251824882319, "synch_weights": 0.001335853188720166, "restore_eval_env_runners": 1.0688102615632088e-05, "evaluation_iteration": 0.2075885273279429, "synch_eval_env_connectors": 0.00015859641477452486, "synch_env_connectors": 5.869645175348926e-06}, "env_runners": {"module_to_env_connector": {"timers": {"connectors": {"tensor_to_numpy": 2.4303896994879054e-05, "listify_data_for_vector_env": 1.9134747261852596e-05, "remove_single_ts_time_rank_from_batch": 9.453015747652002e-07, "get_actions": 8.104357254379493e-05, "normalize_and_clip_actions": 1.6111869522291326e-05, "un_batch_to_individual_items": 8.831590482413662e-06}}, "connector_pipeline_timer": 0.00019204038471816427}, "time_between_sampling": 0.002286614829722578, "num_env_steps_sampled_lifetime": -4312500.0, "env_to_module_connector": {"timers": {"connectors": {"add_observations_from_episodes_to_batch": 4.910575855085226e-06, "add_time_dim_to_batch_and_zero_pad": 4.1490933572661294e-06, "batch_individual_items": 1.1832260730488477e-05, "numpy_to_tensor": 1.6910013748164065e-05, "add_states_from_episodes_to_batch": 2.61387087522485e-06}}, "connector_pipeline_timer": 7.787707150777099e-05}, "num_module_steps_sampled_lifetime": {"default_policy": -4312500.0}, "episode_return_min": -9.5, "weights_seq_no": 8.0, "num_episodes": 250.0, "env_reset_timer": 8.622932776424045e-05, "env_to_module_sum_episodes_length_out": 10.36823839457432, "num_env_steps_sampled": 5000.0, "env_step_timer": 2.6389631022066703e-05, "episode_return_mean": 5.460000000000001, "episode_return_max": 10.5, "episode_len_min": 20, "num_agent_steps_sampled_lifetime": {"default_agent": -4312500.0}, "rlmodule_inference_timer": 5.501700245249462e-05, "module_episode_returns_mean": {"default_policy": 5.460000000000001}, "agent_episode_returns_mean": {"default_agent": 5.460000000000001}, "num_episodes_lifetime": -215625.0, "num_module_steps_sampled": {"default_policy": 5000.0}, "num_agent_steps_sampled": {"default_agent": 5000.0}, "episode_duration_sec_mean": 0.00839283946203068, "env_to_module_sum_episodes_length_in": 10.36823839457432, "episode_len_max": 20, "episode_len_mean": 20.0, "sample": 0.009033928970857297, "num_env_steps_sampled_lifetime_throughput": 2341.3159996601244}, "learners": {"__all_modules__": {"learner_connector": {"timers": {"connectors": {"numpy_to_tensor": 7.949026638790427e-05, "add_states_from_episodes_to_batch": 3.873129204779922e-06, "add_one_ts_to_episodes_and_truncate": 0.013848822774951284, "general_advantage_estimation": 0.008993256633505838, "batch_individual_items": 0.045835737738990794, "add_columns_from_episodes_to_train_batch": 0.04944147690912376, "add_observations_from_episodes_to_batch": 0.001074506104185324, "add_time_dim_to_batch_and_zero_pad": 1.2914900418463889e-05}}, "connector_pipeline_timer": 0.11950572252843854}, "num_module_steps_trained_lifetime": 54000, "num_module_steps_trained": 6000, "num_env_steps_trained": 31500, "learner_connector_sum_episodes_length_out": 5250.0, "learner_connector_sum_episodes_length_in": 5000.0, "num_env_steps_trained_lifetime": 283500, "num_trainable_parameters": 6003, "num_non_trainable_parameters": 0, "num_env_steps_trained_lifetime_throughput": 1754876.4709963817, "num_module_steps_trained_throughput": 335597.7285426329, "num_module_steps_trained_lifetime_throughput": 335106.1561568121}, "default_policy": {"module_train_batch_size_mean": 1000.0, "total_loss": -0.11885840445756912, "vf_explained_var": -0.009606122970581055, "mean_kl_loss": 0.00022714240185450763, "num_module_steps_trained_lifetime": 54000, "num_module_steps_trained": 6000, "weights_seq_no": 9.0, "diff_num_grad_updates_vs_sampler_policy": 1.0, "vf_loss": 0.10278083384037018, "curr_kl_coeff": 0.0014580006245523691, "curr_entropy_coeff": 0.0090570820258, "vf_loss_unclipped": 28.079132080078125, "default_optimizer_learning_rate": 0.0002847858517, "num_trainable_parameters": 6003, "entropy": 0.6061604619026184, "gradients_default_optimizer_global_norm": 0.059866879135370255, "policy_loss": -0.18210962414741516, "num_module_steps_trained_lifetime_throughput": 336148.3374742146}}, "num_training_step_calls_per_iteration": 1, "evaluation": {"env_runners": {"agent_episode_returns_mean": {"default_agent": 0.25}, "episode_len_mean": 20.0, "sample": 0.1991484669837758, "num_env_steps_sampled_lifetime": 45400, "env_reset_timer": 0.00014378482588043264, "env_step_timer": 1.6669087962627043e-05, "rlmodule_inference_timer": 3.1518688347343344e-05, "module_to_env_connector": {"timers": {"connectors": {"remove_single_ts_time_rank_from_batch": 6.401576705872435e-07, "normalize_and_clip_actions": 1.0670806983453418e-05, "tensor_to_numpy": 1.5842610386261685e-05, "listify_data_for_vector_env": 1.3172334964583162e-05, "un_batch_to_individual_items": 6.319625357330991e-06, "get_actions": 4.629289078549591e-05}}, "connector_pipeline_timer": 0.0001221585793345724}, "env_to_module_sum_episodes_length_in": 10.368238394574323, "num_agent_steps_sampled": {"default_agent": 400}, "env_to_module_sum_episodes_length_out": 10.368238394574323, "episode_return_mean": 0.25, "episode_len_min": 20, "episode_duration_sec_mean": 0.007068311256589368, "num_module_steps_sampled": {"default_policy": 400}, "env_to_module_connector": {"timers": {"connectors": {"batch_individual_items": 6.969724696972537e-06, "add_observations_from_episodes_to_batch": 3.3742045303248426e-06, "add_time_dim_to_batch_and_zero_pad": 2.652605223261201e-06, "numpy_to_tensor": 9.834604871681735e-06, "add_states_from_episodes_to_batch": 1.946325064361915e-06}}, "connector_pipeline_timer": 4.7996266446781494e-05}, "episode_return_min": -12.5, "num_module_steps_sampled_lifetime": {"default_policy": 3600}, "weights_seq_no": 9.0, "num_episodes": 20, "num_episodes_lifetime": 180, "episode_len_max": 20, "num_env_steps_sampled": 400, "episode_return_max": 14.5, "num_agent_steps_sampled_lifetime": {"default_agent": 3600}, "module_episode_returns_mean": {"default_policy": 0.25}, "time_between_sampling": 2.6788474850485917}, "num_healthy_workers": 1, "actor_manager_num_outstanding_async_reqs": 0, "num_remote_worker_restarts": 0}, "num_env_steps_sampled_lifetime": -4312500.0, "fault_tolerance": {"num_healthy_workers": 0, "num_remote_worker_restarts": 0}, "env_runner_group": {"actor_manager_num_outstanding_async_reqs": 0}, "done": false, "training_iteration": 9, "trial_id": "497dd_00000", "date": "2025-08-11_19-33-29", "timestamp": 1754933609, "time_this_iter_s": 2.907517194747925, "time_total_s": 27.934561252593994, "pid": 25863, "hostname": "Mac", "node_ip": "127.0.0.1", "config": {"exploration_config": {}, "extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "placement_strategy": "PACK", "num_gpus": 0, "_fake_gpus": false, "num_cpus_for_main_process": 2, "eager_tracing": true, "eager_max_retraces": 20, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "torch_compile_learner": false, "torch_compile_learner_what_to_compile": "forward_train", "torch_compile_learner_dynamo_backend": "aot_eager", "torch_compile_learner_dynamo_mode": null, "torch_compile_worker": false, "torch_compile_worker_dynamo_backend": "aot_eager", "torch_compile_worker_dynamo_mode": null, "torch_ddp_kwargs": {}, "torch_skip_nan_gradients": false, "env": "Umbrella", "env_config": {}, "observation_space": null, "action_space": null, "clip_rewards": null, "normalize_actions": true, "clip_actions": false, "_is_atari": null, "disable_env_checking": false, "render_env": false, "action_mask_key": "action_mask", "env_runner_cls": null, "num_env_runners": 0, "create_local_env_runner": true, "num_envs_per_env_runner": 1, "gym_env_vectorize_mode": "SYNC", "num_cpus_per_env_runner": 1, "num_gpus_per_env_runner": 0, "custom_resources_per_env_runner": {}, "validate_env_runners_after_construction": true, "episodes_to_numpy": true, "max_requests_in_flight_per_env_runner": 1, "sample_timeout_s": 60.0, "_env_to_module_connector": null, "add_default_connectors_to_env_to_module_pipeline": true, "_module_to_env_connector": null, "add_default_connectors_to_module_to_env_pipeline": true, "merge_env_runner_states": "training_only", "broadcast_env_runner_states": true, "episode_lookback_horizon": 1, "rollout_fragment_length": "auto", "batch_mode": "complete_episodes", "compress_observations": false, "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "enable_tf1_exec_eagerly": false, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "preprocessor_pref": "deepmind", "observation_filter": "NoFilter", "update_worker_filter_stats": true, "use_worker_filter_stats": true, "sampler_perf_stats_ema_coef": null, "_is_online": true, "num_learners": 0, "num_gpus_per_learner": 0, "num_cpus_per_learner": "auto", "num_aggregator_actors_per_learner": 0, "max_requests_in_flight_per_aggregator_actor": 3, "local_gpu_idx": 0, "max_requests_in_flight_per_learner": 3, "gamma": 1, "lr": 0.0002847858517, "grad_clip": 0.5, "grad_clip_by": "global_norm", "_train_batch_size_per_learner": 5000, "train_batch_size": 4000, "num_epochs": 1, "minibatch_size": 1000, "shuffle_batch_per_epoch": true, "model": {"fcnet_hiddens": [256, 256], "fcnet_activation": "tanh", "fcnet_weights_initializer": null, "fcnet_weights_initializer_config": null, "fcnet_bias_initializer": null, "fcnet_bias_initializer_config": null, "conv_filters": null, "conv_activation": "relu", "conv_kernel_initializer": null, "conv_kernel_initializer_config": null, "conv_bias_initializer": null, "conv_bias_initializer_config": null, "conv_transpose_kernel_initializer": null, "conv_transpose_kernel_initializer_config": null, "conv_transpose_bias_initializer": null, "conv_transpose_bias_initializer_config": null, "post_fcnet_hiddens": [], "post_fcnet_activation": "relu", "post_fcnet_weights_initializer": null, "post_fcnet_weights_initializer_config": null, "post_fcnet_bias_initializer": null, "post_fcnet_bias_initializer_config": null, "free_log_std": false, "log_std_clip_param": 20.0, "no_final_linear": false, "vf_share_layers": false, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "lstm_weights_initializer": null, "lstm_weights_initializer_config": null, "lstm_bias_initializer": null, "lstm_bias_initializer_config": null, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "attention_use_n_prev_actions": 0, "attention_use_n_prev_rewards": 0, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": null, "custom_model_config": {}, "custom_action_dist": null, "custom_preprocessor": null, "encoder_latent_dim": null, "always_check_shapes": false, "lstm_use_prev_action_reward": -1, "_use_default_native_models": -1, "_disable_preprocessor_api": false, "_disable_action_flattening": false}, "_learner_connector": null, "add_default_connectors_to_learner_pipeline": true, "learner_config_dict": {}, "optimizer": {}, "_learner_class": null, "callbacks_on_algorithm_init": null, "callbacks_on_env_runners_recreated": null, "callbacks_on_offline_eval_runners_recreated": null, "callbacks_on_checkpoint_loaded": null, "callbacks_on_environment_created": null, "callbacks_on_episode_created": null, "callbacks_on_episode_start": null, "callbacks_on_episode_step": null, "callbacks_on_episode_end": null, "callbacks_on_evaluate_start": null, "callbacks_on_evaluate_end": null, "callbacks_on_evaluate_offline_start": null, "callbacks_on_evaluate_offline_end": null, "callbacks_on_sample_end": null, "callbacks_on_train_result": null, "explore": true, "enable_rl_module_and_learner": true, "enable_env_runner_and_connector_v2": true, "_prior_exploration_config": {"type": "StochasticSampling"}, "count_steps_by": "env_steps", "policy_map_capacity": 100, "policy_mapping_fn": "<function AlgorithmConfig.DEFAULT_POLICY_MAPPING_FN at 0x14ff39b20>", "policies_to_train": null, "policy_states_are_swappable": false, "observation_fn": null, "offline_data_class": null, "input_read_method": "read_parquet", "input_read_method_kwargs": {}, "input_read_schema": {}, "input_read_episodes": false, "input_read_sample_batches": false, "input_read_batch_size": null, "input_filesystem": null, "input_filesystem_kwargs": {}, "input_compress_columns": ["obs", "new_obs"], "input_spaces_jsonable": true, "materialize_data": false, "materialize_mapped_data": true, "map_batches_kwargs": {}, "iter_batches_kwargs": {}, "ignore_final_observation": false, "prelearner_class": null, "prelearner_buffer_class": null, "prelearner_buffer_kwargs": {}, "prelearner_module_synch_period": 10, "dataset_num_iters_per_learner": null, "input_config": {}, "actions_in_input_normalized": false, "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_config": {}, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "output_max_rows_per_file": null, "output_write_remaining_data": false, "output_write_method": "write_parquet", "output_write_method_kwargs": {}, "output_filesystem": null, "output_filesystem_kwargs": {}, "output_write_episodes": true, "offline_sampling": false, "evaluation_interval": 1, "evaluation_duration": 20, "evaluation_duration_unit": "episodes", "evaluation_sample_timeout_s": 120.0, "evaluation_auto_duration_min_env_steps_per_sample": 100, "evaluation_auto_duration_max_env_steps_per_sample": 2000, "evaluation_parallel_to_training": false, "evaluation_force_reset_envs_before_iteration": true, "evaluation_config": null, "off_policy_estimation_methods": {}, "ope_split_batch_by_episode": true, "evaluation_num_env_runners": 1, "in_evaluation": false, "sync_filters_on_rollout_workers_timeout_s": 10.0, "offline_evaluation_interval": null, "num_offline_eval_runners": 0, "offline_loss_for_module_fn": null, "offline_evaluation_duration": 1, "offline_evaluation_parallel_to_training": false, "offline_evaluation_timeout_s": 120.0, "num_cpus_per_offline_eval_runner": 1, "num_gpus_per_offline_eval_runner": 0, "custom_resources_per_offline_eval_runner": {}, "restart_failed_offline_eval_runners": true, "ignore_offline_eval_runner_failures": false, "max_num_offline_eval_runner_restarts": 1000, "offline_eval_runner_restore_timeout_s": 1800.0, "max_requests_in_flight_per_offline_eval_runner": 1, "validate_offline_eval_runners_after_construction": true, "offline_eval_runner_health_probe_timeout_s": 30.0, "offline_eval_rl_module_inference_only": false, "broadcast_offline_eval_runner_states": false, "offline_eval_batch_size_per_runner": 256, "dataset_num_iters_per_eval_runner": 1, "keep_per_episode_custom_metrics": false, "metrics_episode_collection_timeout_s": 60.0, "metrics_num_episodes_for_smoothing": 100, "min_time_s_per_iteration": null, "min_train_timesteps_per_iteration": 0, "min_sample_timesteps_per_iteration": 0, "log_gradients": true, "export_native_model_files": false, "checkpoint_trainable_policies_only": false, "logger_creator": null, "logger_config": null, "log_level": "WARN", "log_sys_usage": true, "fake_sampler": false, "seed": 7, "restart_failed_env_runners": true, "ignore_env_runner_failures": false, "max_num_env_runner_restarts": 1000, "delay_between_env_runner_restarts_s": 60.0, "restart_failed_sub_environments": false, "num_consecutive_env_runner_failures_tolerance": 100, "env_runner_health_probe_timeout_s": 30.0, "env_runner_restore_timeout_s": 1800.0, "_model_config": {}, "_rl_module_spec": "RLModuleSpec(module_class=None, observation_space=None, action_space=None, inference_only=False, learner_only=False, model_config=DefaultModelConfig(fcnet_hiddens=[60, 90], fcnet_activation='tanh', fcnet_kernel_initializer=None, fcnet_kernel_initializer_kwargs=None, fcnet_bias_initializer=None, fcnet_bias_initializer_kwargs=None, conv_filters=None, conv_activation='relu', conv_kernel_initializer=None, conv_kernel_initializer_kwargs=None, conv_bias_initializer=None, conv_bias_initializer_kwargs=None, head_fcnet_hiddens=[], head_fcnet_activation='relu', head_fcnet_kernel_initializer=None, head_fcnet_kernel_initializer_kwargs=None, head_fcnet_bias_initializer=None, head_fcnet_bias_initializer_kwargs=None, free_log_std=False, log_std_clip_param=20.0, vf_share_layers=True, use_lstm=False, max_seq_len=20, lstm_cell_size=256, lstm_use_prev_action=False, lstm_use_prev_reward=False, lstm_kernel_initializer=None, lstm_kernel_initializer_kwargs=None, lstm_bias_initializer=None, lstm_bias_initializer_kwargs=None), catalog_class=None, load_state_path=None, model_config_dict=None)", "algorithm_config_overrides_per_module": {}, "_per_module_overrides": {}, "_validate_config": true, "_use_msgpack_checkpoints": false, "_torch_grad_scaler_class": null, "_torch_lr_scheduler_classes": null, "_tf_policy_handles_more_than_one_loss": false, "_disable_preprocessor_api": false, "_disable_action_flattening": false, "_disable_initialize_loss_from_dummy_batch": false, "_dont_auto_sync_env_runner_states": false, "env_task_fn": -1, "enable_connectors": -1, "simple_optimizer": false, "policy_map_cache": -1, "worker_cls": -1, "synchronize_filters": -1, "enable_async_evaluation": -1, "custom_async_evaluation_function": -1, "_enable_rl_module_api": -1, "auto_wrap_old_gym_envs": -1, "always_attach_evaluation_results": -1, "replay_sequence_length": null, "_disable_execution_plan_api": -1, "use_critic": true, "use_gae": true, "use_kl_loss": true, "kl_coeff": 0.7464963036515, "kl_target": 0.0270990929592, "vf_loss_coeff": 0.6688075857018, "entropy_coeff": 0.0090570820258, "clip_param": 0.1221781641624, "vf_clip_param": 0.1027808522125, "entropy_coeff_schedule": null, "lr_schedule": null, "sgd_minibatch_size": -1, "vf_share_layers": -1, "__stdout_file__": null, "__stderr_file__": null, "lambda": 0.9099046732075, "input": "sampler", "policies": {"default_policy": [null, null, null, null]}, "callbacks": "<class 'ray.rllib.callbacks.callbacks.RLlibCallback'>", "create_env_on_driver": false, "custom_eval_function": null, "framework": "torch"}, "time_since_restore": 27.934561252593994, "iterations_since_restore": 9, "perf": {"cpu_util_percent": 56.075, "ram_util_percent": 79.10000000000001}}
{"timers": {"training_iteration": 3.3711149300759295, "restore_env_runners": 2.8924892076024524e-05, "training_step": 3.370847145490827, "env_runner_sampling_timer": 3.2115173101043593, "learner_update_timer": 0.1535374634862049, "synch_weights": 0.0013301384065375489, "restore_eval_env_runners": 1.0662061553105609e-05, "evaluation_iteration": 0.20677083914501915, "synch_eval_env_connectors": 0.00015934961046377223, "synch_env_connectors": 5.853448465134796e-06}, "env_runners": {"module_to_env_connector": {"timers": {"connectors": {"tensor_to_numpy": 2.3169240264272715e-05, "listify_data_for_vector_env": 1.7959535313878367e-05, "remove_single_ts_time_rank_from_batch": 9.136062462711068e-07, "get_actions": 7.588917982933204e-05, "normalize_and_clip_actions": 1.5379467927350272e-05, "un_batch_to_individual_items": 8.658940347308373e-06}}, "connector_pipeline_timer": 0.0001825990424891534}, "time_between_sampling": 0.0026292752201137223, "num_env_steps_sampled_lifetime": -4930000.0, "env_to_module_connector": {"timers": {"connectors": {"add_observations_from_episodes_to_batch": 4.650522429189989e-06, "add_time_dim_to_batch_and_zero_pad": 3.934250315307057e-06, "batch_individual_items": 1.0833906361966961e-05, "numpy_to_tensor": 1.553980309913597e-05, "add_states_from_episodes_to_batch": 2.5073986798242836e-06}}, "connector_pipeline_timer": 6.966366448718579e-05}, "num_module_steps_sampled_lifetime": {"default_policy": -4930000.0}, "episode_return_min": -9.5, "weights_seq_no": 9.0, "num_episodes": 250.0, "env_reset_timer": 8.12393399457719e-05, "env_to_module_sum_episodes_length_out": 10.36823839457432, "num_env_steps_sampled": 5000.0, "env_step_timer": 2.5057364019189467e-05, "episode_return_mean": 6.179999999999998, "episode_return_max": 10.5, "episode_len_min": 20, "num_agent_steps_sampled_lifetime": {"default_agent": -4930000.0}, "rlmodule_inference_timer": 5.060297688712401e-05, "module_episode_returns_mean": {"default_policy": 6.179999999999998}, "agent_episode_returns_mean": {"default_agent": 6.179999999999998}, "num_episodes_lifetime": -246500.0, "num_module_steps_sampled": {"default_policy": 5000.0}, "num_agent_steps_sampled": {"default_agent": 5000.0}, "episode_duration_sec_mean": 0.007855469342321161, "env_to_module_sum_episodes_length_in": 10.36823839457432, "episode_len_max": 20, "episode_len_mean": 20.0, "sample": 0.008525811022418341, "num_env_steps_sampled_lifetime_throughput": 2402.505408848328}, "learners": {"__all_modules__": {"learner_connector": {"timers": {"connectors": {"numpy_to_tensor": 7.959994337091063e-05, "add_states_from_episodes_to_batch": 4.221067911720632e-06, "add_one_ts_to_episodes_and_truncate": 0.013812111206923279, "general_advantage_estimation": 0.008964464067059617, "batch_individual_items": 0.046841570771352495, "add_columns_from_episodes_to_train_batch": 0.04941745506057503, "add_observations_from_episodes_to_batch": 0.0010743002025550353, "add_time_dim_to_batch_and_zero_pad": 1.2904502027462033e-05}}, "connector_pipeline_timer": 0.1204220873839336}, "num_module_steps_trained_lifetime": 60000, "num_module_steps_trained": 6000, "num_env_steps_trained": 31500, "learner_connector_sum_episodes_length_out": 5250.0, "learner_connector_sum_episodes_length_in": 5000.0, "num_env_steps_trained_lifetime": 315000, "num_trainable_parameters": 6003, "num_non_trainable_parameters": 0, "num_env_steps_trained_lifetime_throughput": 1732796.183561862, "num_module_steps_trained_throughput": 331329.364016021, "num_module_steps_trained_lifetime_throughput": 330860.21802011295}, "default_policy": {"module_train_batch_size_mean": 1000.0, "total_loss": -0.14074070751667023, "vf_explained_var": -0.009058833122253418, "mean_kl_loss": 0.00011014497431460768, "num_module_steps_trained_lifetime": 60000, "num_module_steps_trained": 6000, "weights_seq_no": 10.0, "diff_num_grad_updates_vs_sampler_policy": 1.0, "vf_loss": 0.10278083384037018, "curr_kl_coeff": 0.0007290003122761846, "curr_entropy_coeff": 0.0090570820258, "vf_loss_unclipped": 27.982223510742188, "default_optimizer_learning_rate": 0.0002847858517, "num_trainable_parameters": 6003, "entropy": 0.5978839993476868, "gradients_default_optimizer_global_norm": 0.0812729150056839, "policy_loss": -0.20406639575958252, "num_module_steps_trained_lifetime_throughput": 331841.14847802004}}, "num_training_step_calls_per_iteration": 1, "evaluation": {"env_runners": {"agent_episode_returns_mean": {"default_agent": -0.55}, "episode_len_mean": 20.0, "sample": 0.19913176606325766, "num_env_steps_sampled_lifetime": 50400, "env_reset_timer": 0.00014313656687022592, "env_step_timer": 3.251715363685759e-05, "rlmodule_inference_timer": 6.197904104002404e-05, "module_to_env_connector": {"timers": {"connectors": {"remove_single_ts_time_rank_from_batch": 9.929166216198444e-07, "normalize_and_clip_actions": 1.8248511874019065e-05, "tensor_to_numpy": 2.908983829535944e-05, "listify_data_for_vector_env": 2.3839856366822107e-05, "un_batch_to_individual_items": 1.0090600593039579e-05, "get_actions": 9.035313788578998e-05}}, "connector_pipeline_timer": 0.00022377518184055485}, "env_to_module_sum_episodes_length_in": 10.368238394574323, "num_agent_steps_sampled": {"default_agent": 400}, "env_to_module_sum_episodes_length_out": 10.368238394574323, "episode_return_mean": -0.55, "episode_len_min": 20, "episode_duration_sec_mean": 0.007046311233425513, "num_module_steps_sampled": {"default_policy": 400}, "env_to_module_connector": {"timers": {"connectors": {"batch_individual_items": 1.4496346248670336e-05, "add_observations_from_episodes_to_batch": 5.623544396370108e-06, "add_time_dim_to_batch_and_zero_pad": 4.3230714306993545e-06, "numpy_to_tensor": 2.20192077280384e-05, "add_states_from_episodes_to_batch": 3.2468550731100895e-06}}, "connector_pipeline_timer": 8.902446190198e-05}, "episode_return_min": -12.5, "num_module_steps_sampled_lifetime": {"default_policy": 4000}, "weights_seq_no": 10.0, "num_episodes": 20, "num_episodes_lifetime": 200, "episode_len_max": 20, "num_env_steps_sampled": 400, "episode_return_max": 14.5, "num_agent_steps_sampled_lifetime": {"default_agent": 4000}, "module_episode_returns_mean": {"default_policy": -0.55}, "time_between_sampling": 2.6785168826982835}, "num_healthy_workers": 1, "actor_manager_num_outstanding_async_reqs": 0, "num_remote_worker_restarts": 0}, "num_env_steps_sampled_lifetime": -4930000.0, "fault_tolerance": {"num_healthy_workers": 0, "num_remote_worker_restarts": 0}, "env_runner_group": {"actor_manager_num_outstanding_async_reqs": 0}, "done": false, "training_iteration": 10, "trial_id": "497dd_00000", "date": "2025-08-11_19-33-31", "timestamp": 1754933611, "time_this_iter_s": 2.833919048309326, "time_total_s": 30.76848030090332, "pid": 25863, "hostname": "Mac", "node_ip": "127.0.0.1", "config": {"exploration_config": {}, "extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "placement_strategy": "PACK", "num_gpus": 0, "_fake_gpus": false, "num_cpus_for_main_process": 2, "eager_tracing": true, "eager_max_retraces": 20, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "torch_compile_learner": false, "torch_compile_learner_what_to_compile": "forward_train", "torch_compile_learner_dynamo_backend": "aot_eager", "torch_compile_learner_dynamo_mode": null, "torch_compile_worker": false, "torch_compile_worker_dynamo_backend": "aot_eager", "torch_compile_worker_dynamo_mode": null, "torch_ddp_kwargs": {}, "torch_skip_nan_gradients": false, "env": "Umbrella", "env_config": {}, "observation_space": null, "action_space": null, "clip_rewards": null, "normalize_actions": true, "clip_actions": false, "_is_atari": null, "disable_env_checking": false, "render_env": false, "action_mask_key": "action_mask", "env_runner_cls": null, "num_env_runners": 0, "create_local_env_runner": true, "num_envs_per_env_runner": 1, "gym_env_vectorize_mode": "SYNC", "num_cpus_per_env_runner": 1, "num_gpus_per_env_runner": 0, "custom_resources_per_env_runner": {}, "validate_env_runners_after_construction": true, "episodes_to_numpy": true, "max_requests_in_flight_per_env_runner": 1, "sample_timeout_s": 60.0, "_env_to_module_connector": null, "add_default_connectors_to_env_to_module_pipeline": true, "_module_to_env_connector": null, "add_default_connectors_to_module_to_env_pipeline": true, "merge_env_runner_states": "training_only", "broadcast_env_runner_states": true, "episode_lookback_horizon": 1, "rollout_fragment_length": "auto", "batch_mode": "complete_episodes", "compress_observations": false, "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "enable_tf1_exec_eagerly": false, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "preprocessor_pref": "deepmind", "observation_filter": "NoFilter", "update_worker_filter_stats": true, "use_worker_filter_stats": true, "sampler_perf_stats_ema_coef": null, "_is_online": true, "num_learners": 0, "num_gpus_per_learner": 0, "num_cpus_per_learner": "auto", "num_aggregator_actors_per_learner": 0, "max_requests_in_flight_per_aggregator_actor": 3, "local_gpu_idx": 0, "max_requests_in_flight_per_learner": 3, "gamma": 1, "lr": 0.0002847858517, "grad_clip": 0.5, "grad_clip_by": "global_norm", "_train_batch_size_per_learner": 5000, "train_batch_size": 4000, "num_epochs": 1, "minibatch_size": 1000, "shuffle_batch_per_epoch": true, "model": {"fcnet_hiddens": [256, 256], "fcnet_activation": "tanh", "fcnet_weights_initializer": null, "fcnet_weights_initializer_config": null, "fcnet_bias_initializer": null, "fcnet_bias_initializer_config": null, "conv_filters": null, "conv_activation": "relu", "conv_kernel_initializer": null, "conv_kernel_initializer_config": null, "conv_bias_initializer": null, "conv_bias_initializer_config": null, "conv_transpose_kernel_initializer": null, "conv_transpose_kernel_initializer_config": null, "conv_transpose_bias_initializer": null, "conv_transpose_bias_initializer_config": null, "post_fcnet_hiddens": [], "post_fcnet_activation": "relu", "post_fcnet_weights_initializer": null, "post_fcnet_weights_initializer_config": null, "post_fcnet_bias_initializer": null, "post_fcnet_bias_initializer_config": null, "free_log_std": false, "log_std_clip_param": 20.0, "no_final_linear": false, "vf_share_layers": false, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "lstm_weights_initializer": null, "lstm_weights_initializer_config": null, "lstm_bias_initializer": null, "lstm_bias_initializer_config": null, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "attention_use_n_prev_actions": 0, "attention_use_n_prev_rewards": 0, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": null, "custom_model_config": {}, "custom_action_dist": null, "custom_preprocessor": null, "encoder_latent_dim": null, "always_check_shapes": false, "lstm_use_prev_action_reward": -1, "_use_default_native_models": -1, "_disable_preprocessor_api": false, "_disable_action_flattening": false}, "_learner_connector": null, "add_default_connectors_to_learner_pipeline": true, "learner_config_dict": {}, "optimizer": {}, "_learner_class": null, "callbacks_on_algorithm_init": null, "callbacks_on_env_runners_recreated": null, "callbacks_on_offline_eval_runners_recreated": null, "callbacks_on_checkpoint_loaded": null, "callbacks_on_environment_created": null, "callbacks_on_episode_created": null, "callbacks_on_episode_start": null, "callbacks_on_episode_step": null, "callbacks_on_episode_end": null, "callbacks_on_evaluate_start": null, "callbacks_on_evaluate_end": null, "callbacks_on_evaluate_offline_start": null, "callbacks_on_evaluate_offline_end": null, "callbacks_on_sample_end": null, "callbacks_on_train_result": null, "explore": true, "enable_rl_module_and_learner": true, "enable_env_runner_and_connector_v2": true, "_prior_exploration_config": {"type": "StochasticSampling"}, "count_steps_by": "env_steps", "policy_map_capacity": 100, "policy_mapping_fn": "<function AlgorithmConfig.DEFAULT_POLICY_MAPPING_FN at 0x14ff39b20>", "policies_to_train": null, "policy_states_are_swappable": false, "observation_fn": null, "offline_data_class": null, "input_read_method": "read_parquet", "input_read_method_kwargs": {}, "input_read_schema": {}, "input_read_episodes": false, "input_read_sample_batches": false, "input_read_batch_size": null, "input_filesystem": null, "input_filesystem_kwargs": {}, "input_compress_columns": ["obs", "new_obs"], "input_spaces_jsonable": true, "materialize_data": false, "materialize_mapped_data": true, "map_batches_kwargs": {}, "iter_batches_kwargs": {}, "ignore_final_observation": false, "prelearner_class": null, "prelearner_buffer_class": null, "prelearner_buffer_kwargs": {}, "prelearner_module_synch_period": 10, "dataset_num_iters_per_learner": null, "input_config": {}, "actions_in_input_normalized": false, "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_config": {}, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "output_max_rows_per_file": null, "output_write_remaining_data": false, "output_write_method": "write_parquet", "output_write_method_kwargs": {}, "output_filesystem": null, "output_filesystem_kwargs": {}, "output_write_episodes": true, "offline_sampling": false, "evaluation_interval": 1, "evaluation_duration": 20, "evaluation_duration_unit": "episodes", "evaluation_sample_timeout_s": 120.0, "evaluation_auto_duration_min_env_steps_per_sample": 100, "evaluation_auto_duration_max_env_steps_per_sample": 2000, "evaluation_parallel_to_training": false, "evaluation_force_reset_envs_before_iteration": true, "evaluation_config": null, "off_policy_estimation_methods": {}, "ope_split_batch_by_episode": true, "evaluation_num_env_runners": 1, "in_evaluation": false, "sync_filters_on_rollout_workers_timeout_s": 10.0, "offline_evaluation_interval": null, "num_offline_eval_runners": 0, "offline_loss_for_module_fn": null, "offline_evaluation_duration": 1, "offline_evaluation_parallel_to_training": false, "offline_evaluation_timeout_s": 120.0, "num_cpus_per_offline_eval_runner": 1, "num_gpus_per_offline_eval_runner": 0, "custom_resources_per_offline_eval_runner": {}, "restart_failed_offline_eval_runners": true, "ignore_offline_eval_runner_failures": false, "max_num_offline_eval_runner_restarts": 1000, "offline_eval_runner_restore_timeout_s": 1800.0, "max_requests_in_flight_per_offline_eval_runner": 1, "validate_offline_eval_runners_after_construction": true, "offline_eval_runner_health_probe_timeout_s": 30.0, "offline_eval_rl_module_inference_only": false, "broadcast_offline_eval_runner_states": false, "offline_eval_batch_size_per_runner": 256, "dataset_num_iters_per_eval_runner": 1, "keep_per_episode_custom_metrics": false, "metrics_episode_collection_timeout_s": 60.0, "metrics_num_episodes_for_smoothing": 100, "min_time_s_per_iteration": null, "min_train_timesteps_per_iteration": 0, "min_sample_timesteps_per_iteration": 0, "log_gradients": true, "export_native_model_files": false, "checkpoint_trainable_policies_only": false, "logger_creator": null, "logger_config": null, "log_level": "WARN", "log_sys_usage": true, "fake_sampler": false, "seed": 7, "restart_failed_env_runners": true, "ignore_env_runner_failures": false, "max_num_env_runner_restarts": 1000, "delay_between_env_runner_restarts_s": 60.0, "restart_failed_sub_environments": false, "num_consecutive_env_runner_failures_tolerance": 100, "env_runner_health_probe_timeout_s": 30.0, "env_runner_restore_timeout_s": 1800.0, "_model_config": {}, "_rl_module_spec": "RLModuleSpec(module_class=None, observation_space=None, action_space=None, inference_only=False, learner_only=False, model_config=DefaultModelConfig(fcnet_hiddens=[60, 90], fcnet_activation='tanh', fcnet_kernel_initializer=None, fcnet_kernel_initializer_kwargs=None, fcnet_bias_initializer=None, fcnet_bias_initializer_kwargs=None, conv_filters=None, conv_activation='relu', conv_kernel_initializer=None, conv_kernel_initializer_kwargs=None, conv_bias_initializer=None, conv_bias_initializer_kwargs=None, head_fcnet_hiddens=[], head_fcnet_activation='relu', head_fcnet_kernel_initializer=None, head_fcnet_kernel_initializer_kwargs=None, head_fcnet_bias_initializer=None, head_fcnet_bias_initializer_kwargs=None, free_log_std=False, log_std_clip_param=20.0, vf_share_layers=True, use_lstm=False, max_seq_len=20, lstm_cell_size=256, lstm_use_prev_action=False, lstm_use_prev_reward=False, lstm_kernel_initializer=None, lstm_kernel_initializer_kwargs=None, lstm_bias_initializer=None, lstm_bias_initializer_kwargs=None), catalog_class=None, load_state_path=None, model_config_dict=None)", "algorithm_config_overrides_per_module": {}, "_per_module_overrides": {}, "_validate_config": true, "_use_msgpack_checkpoints": false, "_torch_grad_scaler_class": null, "_torch_lr_scheduler_classes": null, "_tf_policy_handles_more_than_one_loss": false, "_disable_preprocessor_api": false, "_disable_action_flattening": false, "_disable_initialize_loss_from_dummy_batch": false, "_dont_auto_sync_env_runner_states": false, "env_task_fn": -1, "enable_connectors": -1, "simple_optimizer": false, "policy_map_cache": -1, "worker_cls": -1, "synchronize_filters": -1, "enable_async_evaluation": -1, "custom_async_evaluation_function": -1, "_enable_rl_module_api": -1, "auto_wrap_old_gym_envs": -1, "always_attach_evaluation_results": -1, "replay_sequence_length": null, "_disable_execution_plan_api": -1, "use_critic": true, "use_gae": true, "use_kl_loss": true, "kl_coeff": 0.7464963036515, "kl_target": 0.0270990929592, "vf_loss_coeff": 0.6688075857018, "entropy_coeff": 0.0090570820258, "clip_param": 0.1221781641624, "vf_clip_param": 0.1027808522125, "entropy_coeff_schedule": null, "lr_schedule": null, "sgd_minibatch_size": -1, "vf_share_layers": -1, "__stdout_file__": null, "__stderr_file__": null, "lambda": 0.9099046732075, "input": "sampler", "policies": {"default_policy": [null, null, null, null]}, "callbacks": "<class 'ray.rllib.callbacks.callbacks.RLlibCallback'>", "create_env_on_driver": false, "custom_eval_function": null, "framework": "torch"}, "time_since_restore": 30.76848030090332, "iterations_since_restore": 10, "perf": {"cpu_util_percent": 76.94999999999999, "ram_util_percent": 79.525}}
{"timers": {"training_iteration": 3.3612303603559526, "restore_env_runners": 2.8988553875076196e-05, "training_step": 3.3609627961253454, "env_runner_sampling_timer": 3.201895138674125, "learner_update_timer": 0.15329492760128427, "synch_weights": 0.0013252632717322562, "restore_eval_env_runners": 1.0628770948793338e-05, "evaluation_iteration": 0.20675650909319299, "synch_eval_env_connectors": 0.00015870486430742748, "synch_env_connectors": 5.833244889348185e-06}, "env_runners": {"module_to_env_connector": {"timers": {"connectors": {"tensor_to_numpy": 2.1569231075868248e-05, "listify_data_for_vector_env": 1.7527680788187763e-05, "remove_single_ts_time_rank_from_batch": 8.488646477087235e-07, "get_actions": 7.0195653322933e-05, "normalize_and_clip_actions": 1.4814525573712847e-05, "un_batch_to_individual_items": 8.245340895600988e-06}}, "connector_pipeline_timer": 0.00017158124131010332}, "time_between_sampling": 0.0029109645366017316, "num_env_steps_sampled_lifetime": -5547500.0, "env_to_module_connector": {"timers": {"connectors": {"add_observations_from_episodes_to_batch": 4.446310551337828e-06, "add_time_dim_to_batch_and_zero_pad": 3.702988934306828e-06, "batch_individual_items": 1.05415635873224e-05, "numpy_to_tensor": 1.4839330294742579e-05, "add_states_from_episodes_to_batch": 2.3613194576193487e-06}}, "connector_pipeline_timer": 6.706789686683427e-05}, "num_module_steps_sampled_lifetime": {"default_policy": -5547500.0}, "episode_return_min": -9.5, "weights_seq_no": 10.0, "num_episodes": 250.0, "env_reset_timer": 7.477513376131125e-05, "env_to_module_sum_episodes_length_out": 10.36823839457432, "num_env_steps_sampled": 5000.0, "env_step_timer": 2.3739470757717324e-05, "episode_return_mean": 4.740000000000002, "episode_return_max": 10.5, "episode_len_min": 20, "num_agent_steps_sampled_lifetime": {"default_agent": -5547500.0}, "rlmodule_inference_timer": 4.87902899989463e-05, "module_episode_returns_mean": {"default_policy": 4.740000000000002}, "agent_episode_returns_mean": {"default_agent": 4.740000000000002}, "num_episodes_lifetime": -277375.0, "num_module_steps_sampled": {"default_policy": 5000.0}, "num_agent_steps_sampled": {"default_agent": 5000.0}, "episode_duration_sec_mean": 0.007452010703273119, "env_to_module_sum_episodes_length_in": 10.36823839457432, "episode_len_max": 20, "episode_len_mean": 20.0, "sample": 0.008079879199696266, "num_env_steps_sampled_lifetime_throughput": 2525.6766819407435}, "learners": {"__all_modules__": {"learner_connector": {"timers": {"connectors": {"numpy_to_tensor": 7.952811359569848e-05, "add_states_from_episodes_to_batch": 4.265946370708937e-06, "add_one_ts_to_episodes_and_truncate": 0.01385089634527128, "general_advantage_estimation": 0.008937223176296409, "batch_individual_items": 0.04677401006353697, "add_columns_from_episodes_to_train_batch": 0.04933239550989872, "add_observations_from_episodes_to_batch": 0.001073386370832904, "add_time_dim_to_batch_and_zero_pad": 1.2894626715528773e-05}}, "connector_pipeline_timer": 0.12027935651008703}, "num_module_steps_trained_lifetime": 66000, "num_module_steps_trained": 6000, "num_env_steps_trained": 31500, "learner_connector_sum_episodes_length_out": 5250.0, "learner_connector_sum_episodes_length_in": 5000.0, "num_env_steps_trained_lifetime": 346500, "num_trainable_parameters": 6003, "num_non_trainable_parameters": 0, "num_env_steps_trained_lifetime_throughput": 1711102.1945756448, "num_module_steps_trained_throughput": 327147.01401942933, "num_module_steps_trained_lifetime_throughput": 326696.887004196}, "default_policy": {"module_train_batch_size_mean": 1000.0, "total_loss": -0.018643252551555634, "vf_explained_var": -0.010197997093200684, "mean_kl_loss": 0.0002990176435559988, "num_module_steps_trained_lifetime": 66000, "num_module_steps_trained": 6000, "weights_seq_no": 11.0, "diff_num_grad_updates_vs_sampler_policy": 1.0, "vf_loss": 0.10278083384037018, "curr_kl_coeff": 0.0003645001561380923, "curr_entropy_coeff": 0.0090570820258, "vf_loss_unclipped": 28.26639175415039, "default_optimizer_learning_rate": 0.0002847858517, "num_trainable_parameters": 6003, "entropy": 0.5904799699783325, "gradients_default_optimizer_global_norm": 0.032687243074178696, "policy_loss": -0.08203604817390442, "num_module_steps_trained_lifetime_throughput": 327623.9143260467}}, "num_training_step_calls_per_iteration": 1, "evaluation": {"env_runners": {"agent_episode_returns_mean": {"default_agent": 0.05}, "episode_len_mean": 20.0, "sample": 0.19868274257356539, "num_env_steps_sampled_lifetime": 55400, "env_reset_timer": 0.00014367312072628274, "env_step_timer": 3.055356209963527e-05, "rlmodule_inference_timer": 5.370381003260063e-05, "module_to_env_connector": {"timers": {"connectors": {"remove_single_ts_time_rank_from_batch": 1.0235227576468974e-06, "normalize_and_clip_actions": 1.711780447623541e-05, "tensor_to_numpy": 2.5865766037643804e-05, "listify_data_for_vector_env": 2.0798685372113043e-05, "un_batch_to_individual_items": 9.971776554599213e-06, "get_actions": 8.656827639477252e-05}}, "connector_pipeline_timer": 0.0002062976320710486}, "env_to_module_sum_episodes_length_in": 10.368238394574323, "num_agent_steps_sampled": {"default_agent": 400}, "env_to_module_sum_episodes_length_out": 10.368238394574323, "episode_return_mean": 0.05, "episode_len_min": 20, "episode_duration_sec_mean": 0.006787892462452874, "num_module_steps_sampled": {"default_policy": 400}, "env_to_module_connector": {"timers": {"connectors": {"batch_individual_items": 1.216601599476582e-05, "add_observations_from_episodes_to_batch": 5.018052898802303e-06, "add_time_dim_to_batch_and_zero_pad": 4.250722180944681e-06, "numpy_to_tensor": 1.841793793814208e-05, "add_states_from_episodes_to_batch": 3.0459390605593104e-06}}, "connector_pipeline_timer": 7.982754816441625e-05}, "episode_return_min": -12.5, "num_module_steps_sampled_lifetime": {"default_policy": 4400}, "weights_seq_no": 11.0, "num_episodes": 20, "num_episodes_lifetime": 220, "episode_len_max": 20, "num_env_steps_sampled": 400, "episode_return_max": 14.5, "num_agent_steps_sampled_lifetime": {"default_agent": 4400}, "module_episode_returns_mean": {"default_policy": 0.05}, "time_between_sampling": 2.6758124072007523}, "num_healthy_workers": 1, "actor_manager_num_outstanding_async_reqs": 0, "num_remote_worker_restarts": 0}, "num_env_steps_sampled_lifetime": -5547500.0, "fault_tolerance": {"num_healthy_workers": 0, "num_remote_worker_restarts": 0}, "env_runner_group": {"actor_manager_num_outstanding_async_reqs": 0}, "done": false, "training_iteration": 11, "trial_id": "497dd_00000", "date": "2025-08-11_19-33-34", "timestamp": 1754933614, "time_this_iter_s": 2.548099994659424, "time_total_s": 33.316580295562744, "pid": 25863, "hostname": "Mac", "node_ip": "127.0.0.1", "config": {"exploration_config": {}, "extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "placement_strategy": "PACK", "num_gpus": 0, "_fake_gpus": false, "num_cpus_for_main_process": 2, "eager_tracing": true, "eager_max_retraces": 20, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "torch_compile_learner": false, "torch_compile_learner_what_to_compile": "forward_train", "torch_compile_learner_dynamo_backend": "aot_eager", "torch_compile_learner_dynamo_mode": null, "torch_compile_worker": false, "torch_compile_worker_dynamo_backend": "aot_eager", "torch_compile_worker_dynamo_mode": null, "torch_ddp_kwargs": {}, "torch_skip_nan_gradients": false, "env": "Umbrella", "env_config": {}, "observation_space": null, "action_space": null, "clip_rewards": null, "normalize_actions": true, "clip_actions": false, "_is_atari": null, "disable_env_checking": false, "render_env": false, "action_mask_key": "action_mask", "env_runner_cls": null, "num_env_runners": 0, "create_local_env_runner": true, "num_envs_per_env_runner": 1, "gym_env_vectorize_mode": "SYNC", "num_cpus_per_env_runner": 1, "num_gpus_per_env_runner": 0, "custom_resources_per_env_runner": {}, "validate_env_runners_after_construction": true, "episodes_to_numpy": true, "max_requests_in_flight_per_env_runner": 1, "sample_timeout_s": 60.0, "_env_to_module_connector": null, "add_default_connectors_to_env_to_module_pipeline": true, "_module_to_env_connector": null, "add_default_connectors_to_module_to_env_pipeline": true, "merge_env_runner_states": "training_only", "broadcast_env_runner_states": true, "episode_lookback_horizon": 1, "rollout_fragment_length": "auto", "batch_mode": "complete_episodes", "compress_observations": false, "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "enable_tf1_exec_eagerly": false, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "preprocessor_pref": "deepmind", "observation_filter": "NoFilter", "update_worker_filter_stats": true, "use_worker_filter_stats": true, "sampler_perf_stats_ema_coef": null, "_is_online": true, "num_learners": 0, "num_gpus_per_learner": 0, "num_cpus_per_learner": "auto", "num_aggregator_actors_per_learner": 0, "max_requests_in_flight_per_aggregator_actor": 3, "local_gpu_idx": 0, "max_requests_in_flight_per_learner": 3, "gamma": 1, "lr": 0.0002847858517, "grad_clip": 0.5, "grad_clip_by": "global_norm", "_train_batch_size_per_learner": 5000, "train_batch_size": 4000, "num_epochs": 1, "minibatch_size": 1000, "shuffle_batch_per_epoch": true, "model": {"fcnet_hiddens": [256, 256], "fcnet_activation": "tanh", "fcnet_weights_initializer": null, "fcnet_weights_initializer_config": null, "fcnet_bias_initializer": null, "fcnet_bias_initializer_config": null, "conv_filters": null, "conv_activation": "relu", "conv_kernel_initializer": null, "conv_kernel_initializer_config": null, "conv_bias_initializer": null, "conv_bias_initializer_config": null, "conv_transpose_kernel_initializer": null, "conv_transpose_kernel_initializer_config": null, "conv_transpose_bias_initializer": null, "conv_transpose_bias_initializer_config": null, "post_fcnet_hiddens": [], "post_fcnet_activation": "relu", "post_fcnet_weights_initializer": null, "post_fcnet_weights_initializer_config": null, "post_fcnet_bias_initializer": null, "post_fcnet_bias_initializer_config": null, "free_log_std": false, "log_std_clip_param": 20.0, "no_final_linear": false, "vf_share_layers": false, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "lstm_weights_initializer": null, "lstm_weights_initializer_config": null, "lstm_bias_initializer": null, "lstm_bias_initializer_config": null, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "attention_use_n_prev_actions": 0, "attention_use_n_prev_rewards": 0, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": null, "custom_model_config": {}, "custom_action_dist": null, "custom_preprocessor": null, "encoder_latent_dim": null, "always_check_shapes": false, "lstm_use_prev_action_reward": -1, "_use_default_native_models": -1, "_disable_preprocessor_api": false, "_disable_action_flattening": false}, "_learner_connector": null, "add_default_connectors_to_learner_pipeline": true, "learner_config_dict": {}, "optimizer": {}, "_learner_class": null, "callbacks_on_algorithm_init": null, "callbacks_on_env_runners_recreated": null, "callbacks_on_offline_eval_runners_recreated": null, "callbacks_on_checkpoint_loaded": null, "callbacks_on_environment_created": null, "callbacks_on_episode_created": null, "callbacks_on_episode_start": null, "callbacks_on_episode_step": null, "callbacks_on_episode_end": null, "callbacks_on_evaluate_start": null, "callbacks_on_evaluate_end": null, "callbacks_on_evaluate_offline_start": null, "callbacks_on_evaluate_offline_end": null, "callbacks_on_sample_end": null, "callbacks_on_train_result": null, "explore": true, "enable_rl_module_and_learner": true, "enable_env_runner_and_connector_v2": true, "_prior_exploration_config": {"type": "StochasticSampling"}, "count_steps_by": "env_steps", "policy_map_capacity": 100, "policy_mapping_fn": "<function AlgorithmConfig.DEFAULT_POLICY_MAPPING_FN at 0x14ff39b20>", "policies_to_train": null, "policy_states_are_swappable": false, "observation_fn": null, "offline_data_class": null, "input_read_method": "read_parquet", "input_read_method_kwargs": {}, "input_read_schema": {}, "input_read_episodes": false, "input_read_sample_batches": false, "input_read_batch_size": null, "input_filesystem": null, "input_filesystem_kwargs": {}, "input_compress_columns": ["obs", "new_obs"], "input_spaces_jsonable": true, "materialize_data": false, "materialize_mapped_data": true, "map_batches_kwargs": {}, "iter_batches_kwargs": {}, "ignore_final_observation": false, "prelearner_class": null, "prelearner_buffer_class": null, "prelearner_buffer_kwargs": {}, "prelearner_module_synch_period": 10, "dataset_num_iters_per_learner": null, "input_config": {}, "actions_in_input_normalized": false, "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_config": {}, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "output_max_rows_per_file": null, "output_write_remaining_data": false, "output_write_method": "write_parquet", "output_write_method_kwargs": {}, "output_filesystem": null, "output_filesystem_kwargs": {}, "output_write_episodes": true, "offline_sampling": false, "evaluation_interval": 1, "evaluation_duration": 20, "evaluation_duration_unit": "episodes", "evaluation_sample_timeout_s": 120.0, "evaluation_auto_duration_min_env_steps_per_sample": 100, "evaluation_auto_duration_max_env_steps_per_sample": 2000, "evaluation_parallel_to_training": false, "evaluation_force_reset_envs_before_iteration": true, "evaluation_config": null, "off_policy_estimation_methods": {}, "ope_split_batch_by_episode": true, "evaluation_num_env_runners": 1, "in_evaluation": false, "sync_filters_on_rollout_workers_timeout_s": 10.0, "offline_evaluation_interval": null, "num_offline_eval_runners": 0, "offline_loss_for_module_fn": null, "offline_evaluation_duration": 1, "offline_evaluation_parallel_to_training": false, "offline_evaluation_timeout_s": 120.0, "num_cpus_per_offline_eval_runner": 1, "num_gpus_per_offline_eval_runner": 0, "custom_resources_per_offline_eval_runner": {}, "restart_failed_offline_eval_runners": true, "ignore_offline_eval_runner_failures": false, "max_num_offline_eval_runner_restarts": 1000, "offline_eval_runner_restore_timeout_s": 1800.0, "max_requests_in_flight_per_offline_eval_runner": 1, "validate_offline_eval_runners_after_construction": true, "offline_eval_runner_health_probe_timeout_s": 30.0, "offline_eval_rl_module_inference_only": false, "broadcast_offline_eval_runner_states": false, "offline_eval_batch_size_per_runner": 256, "dataset_num_iters_per_eval_runner": 1, "keep_per_episode_custom_metrics": false, "metrics_episode_collection_timeout_s": 60.0, "metrics_num_episodes_for_smoothing": 100, "min_time_s_per_iteration": null, "min_train_timesteps_per_iteration": 0, "min_sample_timesteps_per_iteration": 0, "log_gradients": true, "export_native_model_files": false, "checkpoint_trainable_policies_only": false, "logger_creator": null, "logger_config": null, "log_level": "WARN", "log_sys_usage": true, "fake_sampler": false, "seed": 7, "restart_failed_env_runners": true, "ignore_env_runner_failures": false, "max_num_env_runner_restarts": 1000, "delay_between_env_runner_restarts_s": 60.0, "restart_failed_sub_environments": false, "num_consecutive_env_runner_failures_tolerance": 100, "env_runner_health_probe_timeout_s": 30.0, "env_runner_restore_timeout_s": 1800.0, "_model_config": {}, "_rl_module_spec": "RLModuleSpec(module_class=None, observation_space=None, action_space=None, inference_only=False, learner_only=False, model_config=DefaultModelConfig(fcnet_hiddens=[60, 90], fcnet_activation='tanh', fcnet_kernel_initializer=None, fcnet_kernel_initializer_kwargs=None, fcnet_bias_initializer=None, fcnet_bias_initializer_kwargs=None, conv_filters=None, conv_activation='relu', conv_kernel_initializer=None, conv_kernel_initializer_kwargs=None, conv_bias_initializer=None, conv_bias_initializer_kwargs=None, head_fcnet_hiddens=[], head_fcnet_activation='relu', head_fcnet_kernel_initializer=None, head_fcnet_kernel_initializer_kwargs=None, head_fcnet_bias_initializer=None, head_fcnet_bias_initializer_kwargs=None, free_log_std=False, log_std_clip_param=20.0, vf_share_layers=True, use_lstm=False, max_seq_len=20, lstm_cell_size=256, lstm_use_prev_action=False, lstm_use_prev_reward=False, lstm_kernel_initializer=None, lstm_kernel_initializer_kwargs=None, lstm_bias_initializer=None, lstm_bias_initializer_kwargs=None), catalog_class=None, load_state_path=None, model_config_dict=None)", "algorithm_config_overrides_per_module": {}, "_per_module_overrides": {}, "_validate_config": true, "_use_msgpack_checkpoints": false, "_torch_grad_scaler_class": null, "_torch_lr_scheduler_classes": null, "_tf_policy_handles_more_than_one_loss": false, "_disable_preprocessor_api": false, "_disable_action_flattening": false, "_disable_initialize_loss_from_dummy_batch": false, "_dont_auto_sync_env_runner_states": false, "env_task_fn": -1, "enable_connectors": -1, "simple_optimizer": false, "policy_map_cache": -1, "worker_cls": -1, "synchronize_filters": -1, "enable_async_evaluation": -1, "custom_async_evaluation_function": -1, "_enable_rl_module_api": -1, "auto_wrap_old_gym_envs": -1, "always_attach_evaluation_results": -1, "replay_sequence_length": null, "_disable_execution_plan_api": -1, "use_critic": true, "use_gae": true, "use_kl_loss": true, "kl_coeff": 0.7464963036515, "kl_target": 0.0270990929592, "vf_loss_coeff": 0.6688075857018, "entropy_coeff": 0.0090570820258, "clip_param": 0.1221781641624, "vf_clip_param": 0.1027808522125, "entropy_coeff_schedule": null, "lr_schedule": null, "sgd_minibatch_size": -1, "vf_share_layers": -1, "__stdout_file__": null, "__stderr_file__": null, "lambda": 0.9099046732075, "input": "sampler", "policies": {"default_policy": [null, null, null, null]}, "callbacks": "<class 'ray.rllib.callbacks.callbacks.RLlibCallback'>", "create_env_on_driver": false, "custom_eval_function": null, "framework": "torch"}, "time_since_restore": 33.316580295562744, "iterations_since_restore": 11, "perf": {"cpu_util_percent": 70.2, "ram_util_percent": 79.15}}
{"timers": {"training_iteration": 3.3525949838328177, "restore_env_runners": 2.8763668831267502e-05, "training_step": 3.3523279740036847, "env_runner_sampling_timer": 3.1931842952078404, "learner_update_timer": 0.15337095790503116, "synch_weights": 0.0013252235591814856, "restore_eval_env_runners": 1.060539306735733e-05, "evaluation_iteration": 0.20631604483292593, "synch_eval_env_connectors": 0.0001582336448825322, "synch_env_connectors": 5.816163045590859e-06}, "env_runners": {"module_to_env_connector": {"timers": {"connectors": {"tensor_to_numpy": 2.1524292037646665e-05, "listify_data_for_vector_env": 1.7291333748024406e-05, "remove_single_ts_time_rank_from_batch": 8.908706889613626e-07, "get_actions": 7.074503031615478e-05, "normalize_and_clip_actions": 1.5014928252130484e-05, "un_batch_to_individual_items": 7.96580802412427e-06}}, "connector_pipeline_timer": 0.0001721913965721825}, "time_between_sampling": 0.0026473184789337517, "num_env_steps_sampled_lifetime": -6165000.0, "env_to_module_connector": {"timers": {"connectors": {"add_observations_from_episodes_to_batch": 4.7138272201524165e-06, "add_time_dim_to_batch_and_zero_pad": 3.7296727621330254e-06, "batch_individual_items": 1.0628312707183502e-05, "numpy_to_tensor": 1.465189950504724e-05, "add_states_from_episodes_to_batch": 2.426580077484659e-06}}, "connector_pipeline_timer": 6.690062076948997e-05}, "num_module_steps_sampled_lifetime": {"default_policy": -6165000.0}, "episode_return_min": -9.5, "weights_seq_no": 11.0, "num_episodes": 250.0, "env_reset_timer": 7.119490170591197e-05, "env_to_module_sum_episodes_length_out": 10.36823839457432, "num_env_steps_sampled": 5000.0, "env_step_timer": 2.4509669006976538e-05, "episode_return_mean": 5.619999999999999, "episode_return_max": 10.5, "episode_len_min": 20, "num_agent_steps_sampled_lifetime": {"default_agent": -6165000.0}, "rlmodule_inference_timer": 4.721807361162385e-05, "module_episode_returns_mean": {"default_policy": 5.619999999999999}, "agent_episode_returns_mean": {"default_agent": 5.619999999999999}, "num_episodes_lifetime": -308250.0, "num_module_steps_sampled": {"default_policy": 5000.0}, "num_agent_steps_sampled": {"default_agent": 5000.0}, "episode_duration_sec_mean": 0.007451605843380093, "env_to_module_sum_episodes_length_in": 10.36823839457432, "episode_len_max": 20, "episode_len_mean": 20.0, "sample": 0.0079804238046277, "num_env_steps_sampled_lifetime_throughput": 2508.587074050186}, "learners": {"__all_modules__": {"learner_connector": {"timers": {"connectors": {"numpy_to_tensor": 7.942533249408868e-05, "add_states_from_episodes_to_batch": 4.3087066493923616e-06, "add_one_ts_to_episodes_and_truncate": 0.0137978740513776, "general_advantage_estimation": 0.008932999694173657, "batch_individual_items": 0.046856942463295886, "add_columns_from_episodes_to_train_batch": 0.04938822821478097, "add_observations_from_episodes_to_batch": 0.0010820837563631257, "add_time_dim_to_batch_and_zero_pad": 1.3293180390482474e-05}}, "connector_pipeline_timer": 0.12036987586501077}, "num_module_steps_trained_lifetime": 72000, "num_module_steps_trained": 6000, "num_env_steps_trained": 31500, "learner_connector_sum_episodes_length_out": 5250.0, "learner_connector_sum_episodes_length_in": 5000.0, "num_env_steps_trained_lifetime": 378000, "num_trainable_parameters": 6003, "num_non_trainable_parameters": 0, "num_env_steps_trained_lifetime_throughput": 1686460.85030868, "num_module_steps_trained_throughput": 322362.07668667525, "num_module_steps_trained_lifetime_throughput": 321947.60836468555}, "default_policy": {"module_train_batch_size_mean": 1000.0, "total_loss": 0.02147681638598442, "vf_explained_var": -0.009987235069274902, "mean_kl_loss": 0.0009873730596154928, "num_module_steps_trained_lifetime": 72000, "num_module_steps_trained": 6000, "weights_seq_no": 12.0, "diff_num_grad_updates_vs_sampler_policy": 1.0, "vf_loss": 0.10278083384037018, "curr_kl_coeff": 0.00018225007806904614, "curr_entropy_coeff": 0.0090570820258, "vf_loss_unclipped": 28.210323333740234, "default_optimizer_learning_rate": 0.0002847858517, "num_trainable_parameters": 6003, "entropy": 0.5664700865745544, "gradients_default_optimizer_global_norm": 0.07592751830816269, "policy_loss": -0.04213358461856842, "num_module_steps_trained_lifetime_throughput": 322804.73057817423}}, "num_training_step_calls_per_iteration": 1, "evaluation": {"env_runners": {"agent_episode_returns_mean": {"default_agent": 0.65}, "episode_len_mean": 20.0, "sample": 0.19811179680789812, "num_env_steps_sampled_lifetime": 60400, "env_reset_timer": 0.0001441393085488369, "env_step_timer": 2.0870986880009443e-05, "rlmodule_inference_timer": 3.871418933293457e-05, "module_to_env_connector": {"timers": {"connectors": {"remove_single_ts_time_rank_from_batch": 7.501786694053651e-07, "normalize_and_clip_actions": 1.2682756843250804e-05, "tensor_to_numpy": 1.840902645955547e-05, "listify_data_for_vector_env": 1.4671028448230637e-05, "un_batch_to_individual_items": 8.61510566992985e-06, "get_actions": 5.824161370452954e-05}}, "connector_pipeline_timer": 0.00014741360859259734}, "env_to_module_sum_episodes_length_in": 10.368238394574323, "num_agent_steps_sampled": {"default_agent": 400}, "env_to_module_sum_episodes_length_out": 10.368238394574323, "episode_return_mean": 0.65, "episode_len_min": 20, "episode_duration_sec_mean": 0.006948939934372902, "num_module_steps_sampled": {"default_policy": 400}, "env_to_module_connector": {"timers": {"connectors": {"batch_individual_items": 9.329086178018367e-06, "add_observations_from_episodes_to_batch": 4.206900847126089e-06, "add_time_dim_to_batch_and_zero_pad": 3.084609868652924e-06, "numpy_to_tensor": 1.2433772466240674e-05, "add_states_from_episodes_to_batch": 2.139870788862445e-06}}, "connector_pipeline_timer": 5.9731180455199355e-05}, "episode_return_min": -12.5, "num_module_steps_sampled_lifetime": {"default_policy": 4800}, "weights_seq_no": 12.0, "num_episodes": 20, "num_episodes_lifetime": 240, "episode_len_max": 20, "num_env_steps_sampled": 400, "episode_return_max": 14.5, "num_agent_steps_sampled_lifetime": {"default_agent": 4800}, "module_episode_returns_mean": {"default_policy": 0.65}, "time_between_sampling": 2.6743133514681094}, "num_healthy_workers": 1, "actor_manager_num_outstanding_async_reqs": 0, "num_remote_worker_restarts": 0}, "num_env_steps_sampled_lifetime": -6165000.0, "fault_tolerance": {"num_healthy_workers": 0, "num_remote_worker_restarts": 0}, "env_runner_group": {"actor_manager_num_outstanding_async_reqs": 0}, "done": false, "training_iteration": 12, "trial_id": "497dd_00000", "date": "2025-08-11_19-33-37", "timestamp": 1754933617, "time_this_iter_s": 2.6516191959381104, "time_total_s": 35.968199491500854, "pid": 25863, "hostname": "Mac", "node_ip": "127.0.0.1", "config": {"exploration_config": {}, "extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "placement_strategy": "PACK", "num_gpus": 0, "_fake_gpus": false, "num_cpus_for_main_process": 2, "eager_tracing": true, "eager_max_retraces": 20, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "torch_compile_learner": false, "torch_compile_learner_what_to_compile": "forward_train", "torch_compile_learner_dynamo_backend": "aot_eager", "torch_compile_learner_dynamo_mode": null, "torch_compile_worker": false, "torch_compile_worker_dynamo_backend": "aot_eager", "torch_compile_worker_dynamo_mode": null, "torch_ddp_kwargs": {}, "torch_skip_nan_gradients": false, "env": "Umbrella", "env_config": {}, "observation_space": null, "action_space": null, "clip_rewards": null, "normalize_actions": true, "clip_actions": false, "_is_atari": null, "disable_env_checking": false, "render_env": false, "action_mask_key": "action_mask", "env_runner_cls": null, "num_env_runners": 0, "create_local_env_runner": true, "num_envs_per_env_runner": 1, "gym_env_vectorize_mode": "SYNC", "num_cpus_per_env_runner": 1, "num_gpus_per_env_runner": 0, "custom_resources_per_env_runner": {}, "validate_env_runners_after_construction": true, "episodes_to_numpy": true, "max_requests_in_flight_per_env_runner": 1, "sample_timeout_s": 60.0, "_env_to_module_connector": null, "add_default_connectors_to_env_to_module_pipeline": true, "_module_to_env_connector": null, "add_default_connectors_to_module_to_env_pipeline": true, "merge_env_runner_states": "training_only", "broadcast_env_runner_states": true, "episode_lookback_horizon": 1, "rollout_fragment_length": "auto", "batch_mode": "complete_episodes", "compress_observations": false, "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "enable_tf1_exec_eagerly": false, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "preprocessor_pref": "deepmind", "observation_filter": "NoFilter", "update_worker_filter_stats": true, "use_worker_filter_stats": true, "sampler_perf_stats_ema_coef": null, "_is_online": true, "num_learners": 0, "num_gpus_per_learner": 0, "num_cpus_per_learner": "auto", "num_aggregator_actors_per_learner": 0, "max_requests_in_flight_per_aggregator_actor": 3, "local_gpu_idx": 0, "max_requests_in_flight_per_learner": 3, "gamma": 1, "lr": 0.0002847858517, "grad_clip": 0.5, "grad_clip_by": "global_norm", "_train_batch_size_per_learner": 5000, "train_batch_size": 4000, "num_epochs": 1, "minibatch_size": 1000, "shuffle_batch_per_epoch": true, "model": {"fcnet_hiddens": [256, 256], "fcnet_activation": "tanh", "fcnet_weights_initializer": null, "fcnet_weights_initializer_config": null, "fcnet_bias_initializer": null, "fcnet_bias_initializer_config": null, "conv_filters": null, "conv_activation": "relu", "conv_kernel_initializer": null, "conv_kernel_initializer_config": null, "conv_bias_initializer": null, "conv_bias_initializer_config": null, "conv_transpose_kernel_initializer": null, "conv_transpose_kernel_initializer_config": null, "conv_transpose_bias_initializer": null, "conv_transpose_bias_initializer_config": null, "post_fcnet_hiddens": [], "post_fcnet_activation": "relu", "post_fcnet_weights_initializer": null, "post_fcnet_weights_initializer_config": null, "post_fcnet_bias_initializer": null, "post_fcnet_bias_initializer_config": null, "free_log_std": false, "log_std_clip_param": 20.0, "no_final_linear": false, "vf_share_layers": false, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "lstm_weights_initializer": null, "lstm_weights_initializer_config": null, "lstm_bias_initializer": null, "lstm_bias_initializer_config": null, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "attention_use_n_prev_actions": 0, "attention_use_n_prev_rewards": 0, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": null, "custom_model_config": {}, "custom_action_dist": null, "custom_preprocessor": null, "encoder_latent_dim": null, "always_check_shapes": false, "lstm_use_prev_action_reward": -1, "_use_default_native_models": -1, "_disable_preprocessor_api": false, "_disable_action_flattening": false}, "_learner_connector": null, "add_default_connectors_to_learner_pipeline": true, "learner_config_dict": {}, "optimizer": {}, "_learner_class": null, "callbacks_on_algorithm_init": null, "callbacks_on_env_runners_recreated": null, "callbacks_on_offline_eval_runners_recreated": null, "callbacks_on_checkpoint_loaded": null, "callbacks_on_environment_created": null, "callbacks_on_episode_created": null, "callbacks_on_episode_start": null, "callbacks_on_episode_step": null, "callbacks_on_episode_end": null, "callbacks_on_evaluate_start": null, "callbacks_on_evaluate_end": null, "callbacks_on_evaluate_offline_start": null, "callbacks_on_evaluate_offline_end": null, "callbacks_on_sample_end": null, "callbacks_on_train_result": null, "explore": true, "enable_rl_module_and_learner": true, "enable_env_runner_and_connector_v2": true, "_prior_exploration_config": {"type": "StochasticSampling"}, "count_steps_by": "env_steps", "policy_map_capacity": 100, "policy_mapping_fn": "<function AlgorithmConfig.DEFAULT_POLICY_MAPPING_FN at 0x14ff39b20>", "policies_to_train": null, "policy_states_are_swappable": false, "observation_fn": null, "offline_data_class": null, "input_read_method": "read_parquet", "input_read_method_kwargs": {}, "input_read_schema": {}, "input_read_episodes": false, "input_read_sample_batches": false, "input_read_batch_size": null, "input_filesystem": null, "input_filesystem_kwargs": {}, "input_compress_columns": ["obs", "new_obs"], "input_spaces_jsonable": true, "materialize_data": false, "materialize_mapped_data": true, "map_batches_kwargs": {}, "iter_batches_kwargs": {}, "ignore_final_observation": false, "prelearner_class": null, "prelearner_buffer_class": null, "prelearner_buffer_kwargs": {}, "prelearner_module_synch_period": 10, "dataset_num_iters_per_learner": null, "input_config": {}, "actions_in_input_normalized": false, "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_config": {}, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "output_max_rows_per_file": null, "output_write_remaining_data": false, "output_write_method": "write_parquet", "output_write_method_kwargs": {}, "output_filesystem": null, "output_filesystem_kwargs": {}, "output_write_episodes": true, "offline_sampling": false, "evaluation_interval": 1, "evaluation_duration": 20, "evaluation_duration_unit": "episodes", "evaluation_sample_timeout_s": 120.0, "evaluation_auto_duration_min_env_steps_per_sample": 100, "evaluation_auto_duration_max_env_steps_per_sample": 2000, "evaluation_parallel_to_training": false, "evaluation_force_reset_envs_before_iteration": true, "evaluation_config": null, "off_policy_estimation_methods": {}, "ope_split_batch_by_episode": true, "evaluation_num_env_runners": 1, "in_evaluation": false, "sync_filters_on_rollout_workers_timeout_s": 10.0, "offline_evaluation_interval": null, "num_offline_eval_runners": 0, "offline_loss_for_module_fn": null, "offline_evaluation_duration": 1, "offline_evaluation_parallel_to_training": false, "offline_evaluation_timeout_s": 120.0, "num_cpus_per_offline_eval_runner": 1, "num_gpus_per_offline_eval_runner": 0, "custom_resources_per_offline_eval_runner": {}, "restart_failed_offline_eval_runners": true, "ignore_offline_eval_runner_failures": false, "max_num_offline_eval_runner_restarts": 1000, "offline_eval_runner_restore_timeout_s": 1800.0, "max_requests_in_flight_per_offline_eval_runner": 1, "validate_offline_eval_runners_after_construction": true, "offline_eval_runner_health_probe_timeout_s": 30.0, "offline_eval_rl_module_inference_only": false, "broadcast_offline_eval_runner_states": false, "offline_eval_batch_size_per_runner": 256, "dataset_num_iters_per_eval_runner": 1, "keep_per_episode_custom_metrics": false, "metrics_episode_collection_timeout_s": 60.0, "metrics_num_episodes_for_smoothing": 100, "min_time_s_per_iteration": null, "min_train_timesteps_per_iteration": 0, "min_sample_timesteps_per_iteration": 0, "log_gradients": true, "export_native_model_files": false, "checkpoint_trainable_policies_only": false, "logger_creator": null, "logger_config": null, "log_level": "WARN", "log_sys_usage": true, "fake_sampler": false, "seed": 7, "restart_failed_env_runners": true, "ignore_env_runner_failures": false, "max_num_env_runner_restarts": 1000, "delay_between_env_runner_restarts_s": 60.0, "restart_failed_sub_environments": false, "num_consecutive_env_runner_failures_tolerance": 100, "env_runner_health_probe_timeout_s": 30.0, "env_runner_restore_timeout_s": 1800.0, "_model_config": {}, "_rl_module_spec": "RLModuleSpec(module_class=None, observation_space=None, action_space=None, inference_only=False, learner_only=False, model_config=DefaultModelConfig(fcnet_hiddens=[60, 90], fcnet_activation='tanh', fcnet_kernel_initializer=None, fcnet_kernel_initializer_kwargs=None, fcnet_bias_initializer=None, fcnet_bias_initializer_kwargs=None, conv_filters=None, conv_activation='relu', conv_kernel_initializer=None, conv_kernel_initializer_kwargs=None, conv_bias_initializer=None, conv_bias_initializer_kwargs=None, head_fcnet_hiddens=[], head_fcnet_activation='relu', head_fcnet_kernel_initializer=None, head_fcnet_kernel_initializer_kwargs=None, head_fcnet_bias_initializer=None, head_fcnet_bias_initializer_kwargs=None, free_log_std=False, log_std_clip_param=20.0, vf_share_layers=True, use_lstm=False, max_seq_len=20, lstm_cell_size=256, lstm_use_prev_action=False, lstm_use_prev_reward=False, lstm_kernel_initializer=None, lstm_kernel_initializer_kwargs=None, lstm_bias_initializer=None, lstm_bias_initializer_kwargs=None), catalog_class=None, load_state_path=None, model_config_dict=None)", "algorithm_config_overrides_per_module": {}, "_per_module_overrides": {}, "_validate_config": true, "_use_msgpack_checkpoints": false, "_torch_grad_scaler_class": null, "_torch_lr_scheduler_classes": null, "_tf_policy_handles_more_than_one_loss": false, "_disable_preprocessor_api": false, "_disable_action_flattening": false, "_disable_initialize_loss_from_dummy_batch": false, "_dont_auto_sync_env_runner_states": false, "env_task_fn": -1, "enable_connectors": -1, "simple_optimizer": false, "policy_map_cache": -1, "worker_cls": -1, "synchronize_filters": -1, "enable_async_evaluation": -1, "custom_async_evaluation_function": -1, "_enable_rl_module_api": -1, "auto_wrap_old_gym_envs": -1, "always_attach_evaluation_results": -1, "replay_sequence_length": null, "_disable_execution_plan_api": -1, "use_critic": true, "use_gae": true, "use_kl_loss": true, "kl_coeff": 0.7464963036515, "kl_target": 0.0270990929592, "vf_loss_coeff": 0.6688075857018, "entropy_coeff": 0.0090570820258, "clip_param": 0.1221781641624, "vf_clip_param": 0.1027808522125, "entropy_coeff_schedule": null, "lr_schedule": null, "sgd_minibatch_size": -1, "vf_share_layers": -1, "__stdout_file__": null, "__stderr_file__": null, "lambda": 0.9099046732075, "input": "sampler", "policies": {"default_policy": [null, null, null, null]}, "callbacks": "<class 'ray.rllib.callbacks.callbacks.RLlibCallback'>", "create_env_on_driver": false, "custom_eval_function": null, "framework": "torch"}, "time_since_restore": 35.968199491500854, "iterations_since_restore": 12, "perf": {"cpu_util_percent": 69.775, "ram_util_percent": 78.825}}
{"timers": {"training_iteration": 3.3437733564951095, "restore_env_runners": 2.85556124928025e-05, "training_step": 3.343506059264449, "env_runner_sampling_timer": 3.18442633475603, "learner_update_timer": 0.15332503166625241, "synch_weights": 0.0013178125729568929, "restore_eval_env_runners": 1.0583089483359272e-05, "evaluation_iteration": 0.20574208730494412, "synch_eval_env_connectors": 0.0001616488086521579, "synch_env_connectors": 5.7971612010910945e-06}, "env_runners": {"module_to_env_connector": {"timers": {"connectors": {"tensor_to_numpy": 2.1312976642340505e-05, "listify_data_for_vector_env": 1.7148696736795705e-05, "remove_single_ts_time_rank_from_batch": 8.115062889475002e-07, "get_actions": 6.961952333995285e-05, "normalize_and_clip_actions": 1.4420728483271645e-05, "un_batch_to_individual_items": 7.782751613281499e-06}}, "connector_pipeline_timer": 0.00016852444727047982}, "time_between_sampling": 0.00252438266240939, "num_env_steps_sampled_lifetime": -6782500.0, "env_to_module_connector": {"timers": {"connectors": {"add_observations_from_episodes_to_batch": 4.415637778765799e-06, "add_time_dim_to_batch_and_zero_pad": 3.7369558725246048e-06, "batch_individual_items": 1.0195530478696884e-05, "numpy_to_tensor": 1.4420236836877452e-05, "add_states_from_episodes_to_batch": 2.363383493695845e-06}}, "connector_pipeline_timer": 6.605801825546875e-05}, "num_module_steps_sampled_lifetime": {"default_policy": -6782500.0}, "episode_return_min": -9.5, "weights_seq_no": 12.0, "num_episodes": 250.0, "env_reset_timer": 7.055502048563903e-05, "env_to_module_sum_episodes_length_out": 10.36823839457432, "num_env_steps_sampled": 5000.0, "env_step_timer": 2.2577351787303786e-05, "episode_return_mean": 6.419999999999999, "episode_return_max": 10.5, "episode_len_min": 20, "num_agent_steps_sampled_lifetime": {"default_agent": -6782500.0}, "rlmodule_inference_timer": 4.6361198290121456e-05, "module_episode_returns_mean": {"default_policy": 6.419999999999999}, "agent_episode_returns_mean": {"default_agent": 6.419999999999999}, "num_episodes_lifetime": -339125.0, "num_module_steps_sampled": {"default_policy": 5000.0}, "num_agent_steps_sampled": {"default_agent": 5000.0}, "episode_duration_sec_mean": 0.007258321858011189, "env_to_module_sum_episodes_length_in": 10.36823839457432, "episode_len_max": 20, "episode_len_mean": 20.0, "sample": 0.00784575878248607, "num_env_steps_sampled_lifetime_throughput": 2509.6521905654968}, "learners": {"__all_modules__": {"learner_connector": {"timers": {"connectors": {"numpy_to_tensor": 7.93410799188252e-05, "add_states_from_episodes_to_batch": 4.528528453252733e-06, "add_one_ts_to_episodes_and_truncate": 0.013884560731692211, "general_advantage_estimation": 0.008914842617520439, "batch_individual_items": 0.046850783868158566, "add_columns_from_episodes_to_train_batch": 0.0494391325930995, "add_observations_from_episodes_to_batch": 0.0010834937488337355, "add_time_dim_to_batch_and_zero_pad": 1.3490658552986855e-05}}, "connector_pipeline_timer": 0.12048480543567869}, "num_module_steps_trained_lifetime": 78000, "num_module_steps_trained": 6000, "num_env_steps_trained": 31500, "learner_connector_sum_episodes_length_out": 5250.0, "learner_connector_sum_episodes_length_in": 5000.0, "num_env_steps_trained_lifetime": 409500, "num_trainable_parameters": 6003, "num_non_trainable_parameters": 0, "num_env_steps_trained_lifetime_throughput": 1669709.1403746917, "num_module_steps_trained_throughput": 319096.96428333654, "num_module_steps_trained_lifetime_throughput": 318710.9665787016}, "default_policy": {"module_train_batch_size_mean": 1000.0, "total_loss": 0.0764087438583374, "vf_explained_var": -0.010016202926635742, "mean_kl_loss": 0.00015232563600875437, "num_module_steps_trained_lifetime": 78000, "num_module_steps_trained": 6000, "weights_seq_no": 13.0, "diff_num_grad_updates_vs_sampler_policy": 1.0, "vf_loss": 0.10278083384037018, "curr_kl_coeff": 9.112503903452307e-05, "curr_entropy_coeff": 0.0090570820258, "vf_loss_unclipped": 28.251325607299805, "default_optimizer_learning_rate": 0.0002847858517, "num_trainable_parameters": 6003, "entropy": 0.5557562112808228, "gradients_default_optimizer_global_norm": 0.03824322298169136, "policy_loss": 0.012701627798378468, "num_module_steps_trained_lifetime_throughput": 319503.77516670834}}, "num_training_step_calls_per_iteration": 1, "evaluation": {"env_runners": {"agent_episode_returns_mean": {"default_agent": 0.25}, "episode_len_mean": 20.0, "sample": 0.19739828758973219, "num_env_steps_sampled_lifetime": 65400, "env_reset_timer": 0.000143395825317701, "env_step_timer": 1.8371050242158796e-05, "rlmodule_inference_timer": 3.5479102401024865e-05, "module_to_env_connector": {"timers": {"connectors": {"remove_single_ts_time_rank_from_batch": 7.078772742358298e-07, "normalize_and_clip_actions": 1.1813890807932908e-05, "tensor_to_numpy": 1.694286316518657e-05, "listify_data_for_vector_env": 1.3395133001459745e-05, "un_batch_to_individual_items": 7.145010049842506e-06, "get_actions": 4.9935561523906585e-05}}, "connector_pipeline_timer": 0.00013048494308461484}, "env_to_module_sum_episodes_length_in": 10.368238394574323, "num_agent_steps_sampled": {"default_agent": 400}, "env_to_module_sum_episodes_length_out": 10.368238394574323, "episode_return_mean": 0.25, "episode_len_min": 20, "episode_duration_sec_mean": 0.00678907451685518, "num_module_steps_sampled": {"default_policy": 400}, "env_to_module_connector": {"timers": {"connectors": {"batch_individual_items": 8.437828991220009e-06, "add_observations_from_episodes_to_batch": 3.2617706829435193e-06, "add_time_dim_to_batch_and_zero_pad": 2.6735747665004104e-06, "numpy_to_tensor": 1.0469386789558028e-05, "add_states_from_episodes_to_batch": 2.0388696345996077e-06}}, "connector_pipeline_timer": 5.190326626486442e-05}, "episode_return_min": -12.5, "num_module_steps_sampled_lifetime": {"default_policy": 5200}, "weights_seq_no": 13.0, "num_episodes": 20, "num_episodes_lifetime": 260, "episode_len_max": 20, "num_env_steps_sampled": 400, "episode_return_max": 14.5, "num_agent_steps_sampled_lifetime": {"default_agent": 5200}, "module_episode_returns_mean": {"default_policy": 0.25}, "time_between_sampling": 2.672473978373121}, "num_healthy_workers": 1, "actor_manager_num_outstanding_async_reqs": 0, "num_remote_worker_restarts": 0}, "num_env_steps_sampled_lifetime": -6782500.0, "fault_tolerance": {"num_healthy_workers": 0, "num_remote_worker_restarts": 0}, "env_runner_group": {"actor_manager_num_outstanding_async_reqs": 0}, "done": false, "training_iteration": 13, "trial_id": "497dd_00000", "date": "2025-08-11_19-33-39", "timestamp": 1754933619, "time_this_iter_s": 2.6053881645202637, "time_total_s": 38.57358765602112, "pid": 25863, "hostname": "Mac", "node_ip": "127.0.0.1", "config": {"exploration_config": {}, "extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "placement_strategy": "PACK", "num_gpus": 0, "_fake_gpus": false, "num_cpus_for_main_process": 2, "eager_tracing": true, "eager_max_retraces": 20, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "torch_compile_learner": false, "torch_compile_learner_what_to_compile": "forward_train", "torch_compile_learner_dynamo_backend": "aot_eager", "torch_compile_learner_dynamo_mode": null, "torch_compile_worker": false, "torch_compile_worker_dynamo_backend": "aot_eager", "torch_compile_worker_dynamo_mode": null, "torch_ddp_kwargs": {}, "torch_skip_nan_gradients": false, "env": "Umbrella", "env_config": {}, "observation_space": null, "action_space": null, "clip_rewards": null, "normalize_actions": true, "clip_actions": false, "_is_atari": null, "disable_env_checking": false, "render_env": false, "action_mask_key": "action_mask", "env_runner_cls": null, "num_env_runners": 0, "create_local_env_runner": true, "num_envs_per_env_runner": 1, "gym_env_vectorize_mode": "SYNC", "num_cpus_per_env_runner": 1, "num_gpus_per_env_runner": 0, "custom_resources_per_env_runner": {}, "validate_env_runners_after_construction": true, "episodes_to_numpy": true, "max_requests_in_flight_per_env_runner": 1, "sample_timeout_s": 60.0, "_env_to_module_connector": null, "add_default_connectors_to_env_to_module_pipeline": true, "_module_to_env_connector": null, "add_default_connectors_to_module_to_env_pipeline": true, "merge_env_runner_states": "training_only", "broadcast_env_runner_states": true, "episode_lookback_horizon": 1, "rollout_fragment_length": "auto", "batch_mode": "complete_episodes", "compress_observations": false, "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "enable_tf1_exec_eagerly": false, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "preprocessor_pref": "deepmind", "observation_filter": "NoFilter", "update_worker_filter_stats": true, "use_worker_filter_stats": true, "sampler_perf_stats_ema_coef": null, "_is_online": true, "num_learners": 0, "num_gpus_per_learner": 0, "num_cpus_per_learner": "auto", "num_aggregator_actors_per_learner": 0, "max_requests_in_flight_per_aggregator_actor": 3, "local_gpu_idx": 0, "max_requests_in_flight_per_learner": 3, "gamma": 1, "lr": 0.0002847858517, "grad_clip": 0.5, "grad_clip_by": "global_norm", "_train_batch_size_per_learner": 5000, "train_batch_size": 4000, "num_epochs": 1, "minibatch_size": 1000, "shuffle_batch_per_epoch": true, "model": {"fcnet_hiddens": [256, 256], "fcnet_activation": "tanh", "fcnet_weights_initializer": null, "fcnet_weights_initializer_config": null, "fcnet_bias_initializer": null, "fcnet_bias_initializer_config": null, "conv_filters": null, "conv_activation": "relu", "conv_kernel_initializer": null, "conv_kernel_initializer_config": null, "conv_bias_initializer": null, "conv_bias_initializer_config": null, "conv_transpose_kernel_initializer": null, "conv_transpose_kernel_initializer_config": null, "conv_transpose_bias_initializer": null, "conv_transpose_bias_initializer_config": null, "post_fcnet_hiddens": [], "post_fcnet_activation": "relu", "post_fcnet_weights_initializer": null, "post_fcnet_weights_initializer_config": null, "post_fcnet_bias_initializer": null, "post_fcnet_bias_initializer_config": null, "free_log_std": false, "log_std_clip_param": 20.0, "no_final_linear": false, "vf_share_layers": false, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "lstm_weights_initializer": null, "lstm_weights_initializer_config": null, "lstm_bias_initializer": null, "lstm_bias_initializer_config": null, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "attention_use_n_prev_actions": 0, "attention_use_n_prev_rewards": 0, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": null, "custom_model_config": {}, "custom_action_dist": null, "custom_preprocessor": null, "encoder_latent_dim": null, "always_check_shapes": false, "lstm_use_prev_action_reward": -1, "_use_default_native_models": -1, "_disable_preprocessor_api": false, "_disable_action_flattening": false}, "_learner_connector": null, "add_default_connectors_to_learner_pipeline": true, "learner_config_dict": {}, "optimizer": {}, "_learner_class": null, "callbacks_on_algorithm_init": null, "callbacks_on_env_runners_recreated": null, "callbacks_on_offline_eval_runners_recreated": null, "callbacks_on_checkpoint_loaded": null, "callbacks_on_environment_created": null, "callbacks_on_episode_created": null, "callbacks_on_episode_start": null, "callbacks_on_episode_step": null, "callbacks_on_episode_end": null, "callbacks_on_evaluate_start": null, "callbacks_on_evaluate_end": null, "callbacks_on_evaluate_offline_start": null, "callbacks_on_evaluate_offline_end": null, "callbacks_on_sample_end": null, "callbacks_on_train_result": null, "explore": true, "enable_rl_module_and_learner": true, "enable_env_runner_and_connector_v2": true, "_prior_exploration_config": {"type": "StochasticSampling"}, "count_steps_by": "env_steps", "policy_map_capacity": 100, "policy_mapping_fn": "<function AlgorithmConfig.DEFAULT_POLICY_MAPPING_FN at 0x14ff39b20>", "policies_to_train": null, "policy_states_are_swappable": false, "observation_fn": null, "offline_data_class": null, "input_read_method": "read_parquet", "input_read_method_kwargs": {}, "input_read_schema": {}, "input_read_episodes": false, "input_read_sample_batches": false, "input_read_batch_size": null, "input_filesystem": null, "input_filesystem_kwargs": {}, "input_compress_columns": ["obs", "new_obs"], "input_spaces_jsonable": true, "materialize_data": false, "materialize_mapped_data": true, "map_batches_kwargs": {}, "iter_batches_kwargs": {}, "ignore_final_observation": false, "prelearner_class": null, "prelearner_buffer_class": null, "prelearner_buffer_kwargs": {}, "prelearner_module_synch_period": 10, "dataset_num_iters_per_learner": null, "input_config": {}, "actions_in_input_normalized": false, "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_config": {}, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "output_max_rows_per_file": null, "output_write_remaining_data": false, "output_write_method": "write_parquet", "output_write_method_kwargs": {}, "output_filesystem": null, "output_filesystem_kwargs": {}, "output_write_episodes": true, "offline_sampling": false, "evaluation_interval": 1, "evaluation_duration": 20, "evaluation_duration_unit": "episodes", "evaluation_sample_timeout_s": 120.0, "evaluation_auto_duration_min_env_steps_per_sample": 100, "evaluation_auto_duration_max_env_steps_per_sample": 2000, "evaluation_parallel_to_training": false, "evaluation_force_reset_envs_before_iteration": true, "evaluation_config": null, "off_policy_estimation_methods": {}, "ope_split_batch_by_episode": true, "evaluation_num_env_runners": 1, "in_evaluation": false, "sync_filters_on_rollout_workers_timeout_s": 10.0, "offline_evaluation_interval": null, "num_offline_eval_runners": 0, "offline_loss_for_module_fn": null, "offline_evaluation_duration": 1, "offline_evaluation_parallel_to_training": false, "offline_evaluation_timeout_s": 120.0, "num_cpus_per_offline_eval_runner": 1, "num_gpus_per_offline_eval_runner": 0, "custom_resources_per_offline_eval_runner": {}, "restart_failed_offline_eval_runners": true, "ignore_offline_eval_runner_failures": false, "max_num_offline_eval_runner_restarts": 1000, "offline_eval_runner_restore_timeout_s": 1800.0, "max_requests_in_flight_per_offline_eval_runner": 1, "validate_offline_eval_runners_after_construction": true, "offline_eval_runner_health_probe_timeout_s": 30.0, "offline_eval_rl_module_inference_only": false, "broadcast_offline_eval_runner_states": false, "offline_eval_batch_size_per_runner": 256, "dataset_num_iters_per_eval_runner": 1, "keep_per_episode_custom_metrics": false, "metrics_episode_collection_timeout_s": 60.0, "metrics_num_episodes_for_smoothing": 100, "min_time_s_per_iteration": null, "min_train_timesteps_per_iteration": 0, "min_sample_timesteps_per_iteration": 0, "log_gradients": true, "export_native_model_files": false, "checkpoint_trainable_policies_only": false, "logger_creator": null, "logger_config": null, "log_level": "WARN", "log_sys_usage": true, "fake_sampler": false, "seed": 7, "restart_failed_env_runners": true, "ignore_env_runner_failures": false, "max_num_env_runner_restarts": 1000, "delay_between_env_runner_restarts_s": 60.0, "restart_failed_sub_environments": false, "num_consecutive_env_runner_failures_tolerance": 100, "env_runner_health_probe_timeout_s": 30.0, "env_runner_restore_timeout_s": 1800.0, "_model_config": {}, "_rl_module_spec": "RLModuleSpec(module_class=None, observation_space=None, action_space=None, inference_only=False, learner_only=False, model_config=DefaultModelConfig(fcnet_hiddens=[60, 90], fcnet_activation='tanh', fcnet_kernel_initializer=None, fcnet_kernel_initializer_kwargs=None, fcnet_bias_initializer=None, fcnet_bias_initializer_kwargs=None, conv_filters=None, conv_activation='relu', conv_kernel_initializer=None, conv_kernel_initializer_kwargs=None, conv_bias_initializer=None, conv_bias_initializer_kwargs=None, head_fcnet_hiddens=[], head_fcnet_activation='relu', head_fcnet_kernel_initializer=None, head_fcnet_kernel_initializer_kwargs=None, head_fcnet_bias_initializer=None, head_fcnet_bias_initializer_kwargs=None, free_log_std=False, log_std_clip_param=20.0, vf_share_layers=True, use_lstm=False, max_seq_len=20, lstm_cell_size=256, lstm_use_prev_action=False, lstm_use_prev_reward=False, lstm_kernel_initializer=None, lstm_kernel_initializer_kwargs=None, lstm_bias_initializer=None, lstm_bias_initializer_kwargs=None), catalog_class=None, load_state_path=None, model_config_dict=None)", "algorithm_config_overrides_per_module": {}, "_per_module_overrides": {}, "_validate_config": true, "_use_msgpack_checkpoints": false, "_torch_grad_scaler_class": null, "_torch_lr_scheduler_classes": null, "_tf_policy_handles_more_than_one_loss": false, "_disable_preprocessor_api": false, "_disable_action_flattening": false, "_disable_initialize_loss_from_dummy_batch": false, "_dont_auto_sync_env_runner_states": false, "env_task_fn": -1, "enable_connectors": -1, "simple_optimizer": false, "policy_map_cache": -1, "worker_cls": -1, "synchronize_filters": -1, "enable_async_evaluation": -1, "custom_async_evaluation_function": -1, "_enable_rl_module_api": -1, "auto_wrap_old_gym_envs": -1, "always_attach_evaluation_results": -1, "replay_sequence_length": null, "_disable_execution_plan_api": -1, "use_critic": true, "use_gae": true, "use_kl_loss": true, "kl_coeff": 0.7464963036515, "kl_target": 0.0270990929592, "vf_loss_coeff": 0.6688075857018, "entropy_coeff": 0.0090570820258, "clip_param": 0.1221781641624, "vf_clip_param": 0.1027808522125, "entropy_coeff_schedule": null, "lr_schedule": null, "sgd_minibatch_size": -1, "vf_share_layers": -1, "__stdout_file__": null, "__stderr_file__": null, "lambda": 0.9099046732075, "input": "sampler", "policies": {"default_policy": [null, null, null, null]}, "callbacks": "<class 'ray.rllib.callbacks.callbacks.RLlibCallback'>", "create_env_on_driver": false, "custom_eval_function": null, "framework": "torch"}, "time_since_restore": 38.57358765602112, "iterations_since_restore": 13, "perf": {"cpu_util_percent": 70.5, "ram_util_percent": 79.0}}
{"timers": {"training_iteration": 3.3355566341799725, "restore_env_runners": 2.8323386226803394e-05, "training_step": 3.33528866617206, "env_runner_sampling_timer": 3.1746229830687667, "learner_update_timer": 0.15489945301973992, "synch_weights": 0.0013208069475545536, "restore_eval_env_runners": 1.053892844111028e-05, "evaluation_iteration": 0.20500817435250074, "synch_eval_env_connectors": 0.00016121732143973845, "synch_env_connectors": 5.786270273533433e-06}, "env_runners": {"module_to_env_connector": {"timers": {"connectors": {"tensor_to_numpy": 2.101354050978383e-05, "listify_data_for_vector_env": 1.756614139589212e-05, "remove_single_ts_time_rank_from_batch": 8.365062214546432e-07, "get_actions": 6.897194591203871e-05, "normalize_and_clip_actions": 1.4651692816377828e-05, "un_batch_to_individual_items": 7.812716607980886e-06}}, "connector_pipeline_timer": 0.0001686999129900822}, "time_between_sampling": 0.0025056791837033796, "num_env_steps_sampled_lifetime": -7400000.0, "env_to_module_connector": {"timers": {"connectors": {"add_observations_from_episodes_to_batch": 4.323028822171207e-06, "add_time_dim_to_batch_and_zero_pad": 3.829365832407866e-06, "batch_individual_items": 1.0254196386481794e-05, "numpy_to_tensor": 1.434209462742679e-05, "add_states_from_episodes_to_batch": 2.4868994541618487e-06}}, "connector_pipeline_timer": 6.658107370748458e-05}, "num_module_steps_sampled_lifetime": {"default_policy": -7400000.0}, "episode_return_min": -9.5, "weights_seq_no": 13.0, "num_episodes": 250.0, "env_reset_timer": 7.399261129344285e-05, "env_to_module_sum_episodes_length_out": 10.36823839457432, "num_env_steps_sampled": 5000.0, "env_step_timer": 2.2862672495105564e-05, "episode_return_mean": 6.74, "episode_return_max": 10.5, "episode_len_min": 20, "num_agent_steps_sampled_lifetime": {"default_agent": -7400000.0}, "rlmodule_inference_timer": 4.685018744988527e-05, "module_episode_returns_mean": {"default_policy": 6.74}, "agent_episode_returns_mean": {"default_agent": 6.74}, "num_episodes_lifetime": -370000.0, "num_module_steps_sampled": {"default_policy": 5000.0}, "num_agent_steps_sampled": {"default_agent": 5000.0}, "episode_duration_sec_mean": 0.007305440488737075, "env_to_module_sum_episodes_length_in": 10.36823839457432, "episode_len_max": 20, "episode_len_mean": 20.0, "sample": 0.007837596131780426, "num_env_steps_sampled_lifetime_throughput": 2548.462567335847}, "learners": {"__all_modules__": {"learner_connector": {"timers": {"connectors": {"numpy_to_tensor": 8.034516825477356e-05, "add_states_from_episodes_to_batch": 4.834072382577856e-06, "add_one_ts_to_episodes_and_truncate": 0.013864626374404047, "general_advantage_estimation": 0.008930380861583386, "batch_individual_items": 0.04850841394989946, "add_columns_from_episodes_to_train_batch": 0.049304196687571314, "add_observations_from_episodes_to_batch": 0.0010816663106658307, "add_time_dim_to_batch_and_zero_pad": 1.3474501416486551e-05}}, "connector_pipeline_timer": 0.12200305238157776}, "num_module_steps_trained_lifetime": 84000, "num_module_steps_trained": 6000, "num_env_steps_trained": 31500, "learner_connector_sum_episodes_length_out": 5250.0, "learner_connector_sum_episodes_length_in": 5000.0, "num_env_steps_trained_lifetime": 441000, "num_trainable_parameters": 6003, "num_non_trainable_parameters": 0, "num_env_steps_trained_lifetime_throughput": 1646020.3440626648, "num_module_steps_trained_throughput": 314516.27131723094, "num_module_steps_trained_lifetime_throughput": 314156.1588546763}, "default_policy": {"module_train_batch_size_mean": 1000.0, "total_loss": -0.13544487953186035, "vf_explained_var": -0.008661389350891113, "mean_kl_loss": 5.350949504645541e-05, "num_module_steps_trained_lifetime": 84000, "num_module_steps_trained": 6000, "weights_seq_no": 14.0, "diff_num_grad_updates_vs_sampler_policy": 1.0, "vf_loss": 0.10278083384037018, "curr_kl_coeff": 4.5562519517261535e-05, "curr_entropy_coeff": 0.0090570820258, "vf_loss_unclipped": 27.92440414428711, "default_optimizer_learning_rate": 0.0002847858517, "num_trainable_parameters": 6003, "entropy": 0.5543418526649475, "gradients_default_optimizer_global_norm": 0.028520269319415092, "policy_loss": -0.1991647630929947, "num_module_steps_trained_lifetime_throughput": 314884.8435911666}}, "num_training_step_calls_per_iteration": 1, "evaluation": {"env_runners": {"agent_episode_returns_mean": {"default_agent": 0.25}, "episode_len_mean": 20.0, "sample": 0.1969607192940217, "num_env_steps_sampled_lifetime": 70400, "env_reset_timer": 0.0001428922874203953, "env_step_timer": 1.910088122683296e-05, "rlmodule_inference_timer": 3.7642995500620655e-05, "module_to_env_connector": {"timers": {"connectors": {"remove_single_ts_time_rank_from_batch": 8.039619396375398e-07, "normalize_and_clip_actions": 1.2343008485650108e-05, "tensor_to_numpy": 2.2738986099366863e-05, "listify_data_for_vector_env": 1.6097863060059518e-05, "un_batch_to_individual_items": 6.5442398847038075e-06, "get_actions": 5.6264467454974884e-05}}, "connector_pipeline_timer": 0.0001466624364921177}, "env_to_module_sum_episodes_length_in": 10.368238394574323, "num_agent_steps_sampled": {"default_agent": 400}, "env_to_module_sum_episodes_length_out": 10.368238394574323, "episode_return_mean": 0.25, "episode_len_min": 20, "episode_duration_sec_mean": 0.007091531229671091, "num_module_steps_sampled": {"default_policy": 400}, "env_to_module_connector": {"timers": {"connectors": {"batch_individual_items": 7.848505405112062e-06, "add_observations_from_episodes_to_batch": 3.5233420366857666e-06, "add_time_dim_to_batch_and_zero_pad": 2.854850073931617e-06, "numpy_to_tensor": 1.1421523442209917e-05, "add_states_from_episodes_to_batch": 2.0607951517677576e-06}}, "connector_pipeline_timer": 5.2948674204654374e-05}, "episode_return_min": -12.5, "num_module_steps_sampled_lifetime": {"default_policy": 5600}, "weights_seq_no": 14.0, "num_episodes": 20, "num_episodes_lifetime": 280, "episode_len_max": 20, "num_env_steps_sampled": 400, "episode_return_max": 14.5, "num_agent_steps_sampled_lifetime": {"default_agent": 5600}, "module_episode_returns_mean": {"default_policy": 0.25}, "time_between_sampling": 2.6712826060895645}, "num_healthy_workers": 1, "actor_manager_num_outstanding_async_reqs": 0, "num_remote_worker_restarts": 0}, "num_env_steps_sampled_lifetime": -7400000.0, "fault_tolerance": {"num_healthy_workers": 0, "num_remote_worker_restarts": 0}, "env_runner_group": {"actor_manager_num_outstanding_async_reqs": 0}, "done": false, "training_iteration": 14, "trial_id": "497dd_00000", "date": "2025-08-11_19-33-42", "timestamp": 1754933622, "time_this_iter_s": 2.6949729919433594, "time_total_s": 41.26856064796448, "pid": 25863, "hostname": "Mac", "node_ip": "127.0.0.1", "config": {"exploration_config": {}, "extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "placement_strategy": "PACK", "num_gpus": 0, "_fake_gpus": false, "num_cpus_for_main_process": 2, "eager_tracing": true, "eager_max_retraces": 20, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "torch_compile_learner": false, "torch_compile_learner_what_to_compile": "forward_train", "torch_compile_learner_dynamo_backend": "aot_eager", "torch_compile_learner_dynamo_mode": null, "torch_compile_worker": false, "torch_compile_worker_dynamo_backend": "aot_eager", "torch_compile_worker_dynamo_mode": null, "torch_ddp_kwargs": {}, "torch_skip_nan_gradients": false, "env": "Umbrella", "env_config": {}, "observation_space": null, "action_space": null, "clip_rewards": null, "normalize_actions": true, "clip_actions": false, "_is_atari": null, "disable_env_checking": false, "render_env": false, "action_mask_key": "action_mask", "env_runner_cls": null, "num_env_runners": 0, "create_local_env_runner": true, "num_envs_per_env_runner": 1, "gym_env_vectorize_mode": "SYNC", "num_cpus_per_env_runner": 1, "num_gpus_per_env_runner": 0, "custom_resources_per_env_runner": {}, "validate_env_runners_after_construction": true, "episodes_to_numpy": true, "max_requests_in_flight_per_env_runner": 1, "sample_timeout_s": 60.0, "_env_to_module_connector": null, "add_default_connectors_to_env_to_module_pipeline": true, "_module_to_env_connector": null, "add_default_connectors_to_module_to_env_pipeline": true, "merge_env_runner_states": "training_only", "broadcast_env_runner_states": true, "episode_lookback_horizon": 1, "rollout_fragment_length": "auto", "batch_mode": "complete_episodes", "compress_observations": false, "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "enable_tf1_exec_eagerly": false, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "preprocessor_pref": "deepmind", "observation_filter": "NoFilter", "update_worker_filter_stats": true, "use_worker_filter_stats": true, "sampler_perf_stats_ema_coef": null, "_is_online": true, "num_learners": 0, "num_gpus_per_learner": 0, "num_cpus_per_learner": "auto", "num_aggregator_actors_per_learner": 0, "max_requests_in_flight_per_aggregator_actor": 3, "local_gpu_idx": 0, "max_requests_in_flight_per_learner": 3, "gamma": 1, "lr": 0.0002847858517, "grad_clip": 0.5, "grad_clip_by": "global_norm", "_train_batch_size_per_learner": 5000, "train_batch_size": 4000, "num_epochs": 1, "minibatch_size": 1000, "shuffle_batch_per_epoch": true, "model": {"fcnet_hiddens": [256, 256], "fcnet_activation": "tanh", "fcnet_weights_initializer": null, "fcnet_weights_initializer_config": null, "fcnet_bias_initializer": null, "fcnet_bias_initializer_config": null, "conv_filters": null, "conv_activation": "relu", "conv_kernel_initializer": null, "conv_kernel_initializer_config": null, "conv_bias_initializer": null, "conv_bias_initializer_config": null, "conv_transpose_kernel_initializer": null, "conv_transpose_kernel_initializer_config": null, "conv_transpose_bias_initializer": null, "conv_transpose_bias_initializer_config": null, "post_fcnet_hiddens": [], "post_fcnet_activation": "relu", "post_fcnet_weights_initializer": null, "post_fcnet_weights_initializer_config": null, "post_fcnet_bias_initializer": null, "post_fcnet_bias_initializer_config": null, "free_log_std": false, "log_std_clip_param": 20.0, "no_final_linear": false, "vf_share_layers": false, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "lstm_weights_initializer": null, "lstm_weights_initializer_config": null, "lstm_bias_initializer": null, "lstm_bias_initializer_config": null, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "attention_use_n_prev_actions": 0, "attention_use_n_prev_rewards": 0, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": null, "custom_model_config": {}, "custom_action_dist": null, "custom_preprocessor": null, "encoder_latent_dim": null, "always_check_shapes": false, "lstm_use_prev_action_reward": -1, "_use_default_native_models": -1, "_disable_preprocessor_api": false, "_disable_action_flattening": false}, "_learner_connector": null, "add_default_connectors_to_learner_pipeline": true, "learner_config_dict": {}, "optimizer": {}, "_learner_class": null, "callbacks_on_algorithm_init": null, "callbacks_on_env_runners_recreated": null, "callbacks_on_offline_eval_runners_recreated": null, "callbacks_on_checkpoint_loaded": null, "callbacks_on_environment_created": null, "callbacks_on_episode_created": null, "callbacks_on_episode_start": null, "callbacks_on_episode_step": null, "callbacks_on_episode_end": null, "callbacks_on_evaluate_start": null, "callbacks_on_evaluate_end": null, "callbacks_on_evaluate_offline_start": null, "callbacks_on_evaluate_offline_end": null, "callbacks_on_sample_end": null, "callbacks_on_train_result": null, "explore": true, "enable_rl_module_and_learner": true, "enable_env_runner_and_connector_v2": true, "_prior_exploration_config": {"type": "StochasticSampling"}, "count_steps_by": "env_steps", "policy_map_capacity": 100, "policy_mapping_fn": "<function AlgorithmConfig.DEFAULT_POLICY_MAPPING_FN at 0x14ff39b20>", "policies_to_train": null, "policy_states_are_swappable": false, "observation_fn": null, "offline_data_class": null, "input_read_method": "read_parquet", "input_read_method_kwargs": {}, "input_read_schema": {}, "input_read_episodes": false, "input_read_sample_batches": false, "input_read_batch_size": null, "input_filesystem": null, "input_filesystem_kwargs": {}, "input_compress_columns": ["obs", "new_obs"], "input_spaces_jsonable": true, "materialize_data": false, "materialize_mapped_data": true, "map_batches_kwargs": {}, "iter_batches_kwargs": {}, "ignore_final_observation": false, "prelearner_class": null, "prelearner_buffer_class": null, "prelearner_buffer_kwargs": {}, "prelearner_module_synch_period": 10, "dataset_num_iters_per_learner": null, "input_config": {}, "actions_in_input_normalized": false, "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_config": {}, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "output_max_rows_per_file": null, "output_write_remaining_data": false, "output_write_method": "write_parquet", "output_write_method_kwargs": {}, "output_filesystem": null, "output_filesystem_kwargs": {}, "output_write_episodes": true, "offline_sampling": false, "evaluation_interval": 1, "evaluation_duration": 20, "evaluation_duration_unit": "episodes", "evaluation_sample_timeout_s": 120.0, "evaluation_auto_duration_min_env_steps_per_sample": 100, "evaluation_auto_duration_max_env_steps_per_sample": 2000, "evaluation_parallel_to_training": false, "evaluation_force_reset_envs_before_iteration": true, "evaluation_config": null, "off_policy_estimation_methods": {}, "ope_split_batch_by_episode": true, "evaluation_num_env_runners": 1, "in_evaluation": false, "sync_filters_on_rollout_workers_timeout_s": 10.0, "offline_evaluation_interval": null, "num_offline_eval_runners": 0, "offline_loss_for_module_fn": null, "offline_evaluation_duration": 1, "offline_evaluation_parallel_to_training": false, "offline_evaluation_timeout_s": 120.0, "num_cpus_per_offline_eval_runner": 1, "num_gpus_per_offline_eval_runner": 0, "custom_resources_per_offline_eval_runner": {}, "restart_failed_offline_eval_runners": true, "ignore_offline_eval_runner_failures": false, "max_num_offline_eval_runner_restarts": 1000, "offline_eval_runner_restore_timeout_s": 1800.0, "max_requests_in_flight_per_offline_eval_runner": 1, "validate_offline_eval_runners_after_construction": true, "offline_eval_runner_health_probe_timeout_s": 30.0, "offline_eval_rl_module_inference_only": false, "broadcast_offline_eval_runner_states": false, "offline_eval_batch_size_per_runner": 256, "dataset_num_iters_per_eval_runner": 1, "keep_per_episode_custom_metrics": false, "metrics_episode_collection_timeout_s": 60.0, "metrics_num_episodes_for_smoothing": 100, "min_time_s_per_iteration": null, "min_train_timesteps_per_iteration": 0, "min_sample_timesteps_per_iteration": 0, "log_gradients": true, "export_native_model_files": false, "checkpoint_trainable_policies_only": false, "logger_creator": null, "logger_config": null, "log_level": "WARN", "log_sys_usage": true, "fake_sampler": false, "seed": 7, "restart_failed_env_runners": true, "ignore_env_runner_failures": false, "max_num_env_runner_restarts": 1000, "delay_between_env_runner_restarts_s": 60.0, "restart_failed_sub_environments": false, "num_consecutive_env_runner_failures_tolerance": 100, "env_runner_health_probe_timeout_s": 30.0, "env_runner_restore_timeout_s": 1800.0, "_model_config": {}, "_rl_module_spec": "RLModuleSpec(module_class=None, observation_space=None, action_space=None, inference_only=False, learner_only=False, model_config=DefaultModelConfig(fcnet_hiddens=[60, 90], fcnet_activation='tanh', fcnet_kernel_initializer=None, fcnet_kernel_initializer_kwargs=None, fcnet_bias_initializer=None, fcnet_bias_initializer_kwargs=None, conv_filters=None, conv_activation='relu', conv_kernel_initializer=None, conv_kernel_initializer_kwargs=None, conv_bias_initializer=None, conv_bias_initializer_kwargs=None, head_fcnet_hiddens=[], head_fcnet_activation='relu', head_fcnet_kernel_initializer=None, head_fcnet_kernel_initializer_kwargs=None, head_fcnet_bias_initializer=None, head_fcnet_bias_initializer_kwargs=None, free_log_std=False, log_std_clip_param=20.0, vf_share_layers=True, use_lstm=False, max_seq_len=20, lstm_cell_size=256, lstm_use_prev_action=False, lstm_use_prev_reward=False, lstm_kernel_initializer=None, lstm_kernel_initializer_kwargs=None, lstm_bias_initializer=None, lstm_bias_initializer_kwargs=None), catalog_class=None, load_state_path=None, model_config_dict=None)", "algorithm_config_overrides_per_module": {}, "_per_module_overrides": {}, "_validate_config": true, "_use_msgpack_checkpoints": false, "_torch_grad_scaler_class": null, "_torch_lr_scheduler_classes": null, "_tf_policy_handles_more_than_one_loss": false, "_disable_preprocessor_api": false, "_disable_action_flattening": false, "_disable_initialize_loss_from_dummy_batch": false, "_dont_auto_sync_env_runner_states": false, "env_task_fn": -1, "enable_connectors": -1, "simple_optimizer": false, "policy_map_cache": -1, "worker_cls": -1, "synchronize_filters": -1, "enable_async_evaluation": -1, "custom_async_evaluation_function": -1, "_enable_rl_module_api": -1, "auto_wrap_old_gym_envs": -1, "always_attach_evaluation_results": -1, "replay_sequence_length": null, "_disable_execution_plan_api": -1, "use_critic": true, "use_gae": true, "use_kl_loss": true, "kl_coeff": 0.7464963036515, "kl_target": 0.0270990929592, "vf_loss_coeff": 0.6688075857018, "entropy_coeff": 0.0090570820258, "clip_param": 0.1221781641624, "vf_clip_param": 0.1027808522125, "entropy_coeff_schedule": null, "lr_schedule": null, "sgd_minibatch_size": -1, "vf_share_layers": -1, "__stdout_file__": null, "__stderr_file__": null, "lambda": 0.9099046732075, "input": "sampler", "policies": {"default_policy": [null, null, null, null]}, "callbacks": "<class 'ray.rllib.callbacks.callbacks.RLlibCallback'>", "create_env_on_driver": false, "custom_eval_function": null, "framework": "torch"}, "time_since_restore": 41.26856064796448, "iterations_since_restore": 14, "perf": {"cpu_util_percent": 69.86666666666666, "ram_util_percent": 79.16666666666667}}
{"timers": {"training_iteration": 3.3282988653381422, "restore_env_runners": 2.8108902596993473e-05, "training_step": 3.3280313945105706, "env_runner_sampling_timer": 3.166731008237975, "learner_update_timer": 0.1555491243196164, "synch_weights": 0.0013167722075329235, "restore_eval_env_runners": 1.1554788672262427e-05, "evaluation_iteration": 0.2045828442785633, "synch_eval_env_connectors": 0.0001632538977780082, "synch_env_connectors": 5.766737315509617e-06}, "env_runners": {"module_to_env_connector": {"timers": {"connectors": {"tensor_to_numpy": 2.254646920725744e-05, "listify_data_for_vector_env": 1.888936653329698e-05, "remove_single_ts_time_rank_from_batch": 9.432132490027707e-07, "get_actions": 7.56583191581984e-05, "normalize_and_clip_actions": 1.5301702197015776e-05, "un_batch_to_individual_items": 8.314157993894535e-06}}, "connector_pipeline_timer": 0.00018159001793962318}, "time_between_sampling": 0.0030101936906123663, "num_env_steps_sampled_lifetime": -8017500.0, "env_to_module_connector": {"timers": {"connectors": {"add_observations_from_episodes_to_batch": 4.841914265387806e-06, "add_time_dim_to_batch_and_zero_pad": 4.5877147306991656e-06, "batch_individual_items": 1.0739196888300478e-05, "numpy_to_tensor": 1.570486159209976e-05, "add_states_from_episodes_to_batch": 2.6377260889844674e-06}}, "connector_pipeline_timer": 7.031665655521956e-05}, "num_module_steps_sampled_lifetime": {"default_policy": -8017500.0}, "episode_return_min": -9.5, "weights_seq_no": 14.0, "num_episodes": 250.0, "env_reset_timer": 7.83317339931034e-05, "env_to_module_sum_episodes_length_out": 10.36823839457432, "num_env_steps_sampled": 5000.0, "env_step_timer": 2.482043109351493e-05, "episode_return_mean": 5.299999999999998, "episode_return_max": 10.5, "episode_len_min": 20, "num_agent_steps_sampled_lifetime": {"default_agent": -8017500.0}, "rlmodule_inference_timer": 5.0653943496473695e-05, "module_episode_returns_mean": {"default_policy": 5.299999999999998}, "agent_episode_returns_mean": {"default_agent": 5.299999999999998}, "num_episodes_lifetime": -400875.0, "num_module_steps_sampled": {"default_policy": 5000.0}, "num_agent_steps_sampled": {"default_agent": 5000.0}, "episode_duration_sec_mean": 0.007857333815656602, "env_to_module_sum_episodes_length_in": 10.36823839457432, "episode_len_max": 20, "episode_len_mean": 20.0, "sample": 0.008346900500885487, "num_env_steps_sampled_lifetime_throughput": 2430.6437416521467}, "learners": {"__all_modules__": {"learner_connector": {"timers": {"connectors": {"numpy_to_tensor": 8.033671680498196e-05, "add_states_from_episodes_to_batch": 4.818231324146502e-06, "add_one_ts_to_episodes_and_truncate": 0.013803701769986932, "general_advantage_estimation": 0.00890134080287807, "batch_individual_items": 0.049515557310239385, "add_columns_from_episodes_to_train_batch": 0.04917051722071684, "add_observations_from_episodes_to_batch": 0.001079117558011732, "add_time_dim_to_batch_and_zero_pad": 1.3445596556313862e-05}}, "connector_pipeline_timer": 0.12278299602822886}, "num_module_steps_trained_lifetime": 90000, "num_module_steps_trained": 6000, "num_env_steps_trained": 31500, "learner_connector_sum_episodes_length_out": 5250.0, "learner_connector_sum_episodes_length_in": 5000.0, "num_env_steps_trained_lifetime": 472500, "num_trainable_parameters": 6003, "num_non_trainable_parameters": 0, "num_env_steps_trained_lifetime_throughput": 1628089.8308572494, "num_module_steps_trained_throughput": 311041.40137246234, "num_module_steps_trained_lifetime_throughput": 310702.2406618002}, "default_policy": {"module_train_batch_size_mean": 1000.0, "total_loss": 0.11288011074066162, "vf_explained_var": -0.010147690773010254, "mean_kl_loss": 8.566788892494515e-05, "num_module_steps_trained_lifetime": 90000, "num_module_steps_trained": 6000, "weights_seq_no": 15.0, "diff_num_grad_updates_vs_sampler_policy": 1.0, "vf_loss": 0.10278083384037018, "curr_kl_coeff": 2.2781259758630767e-05, "curr_entropy_coeff": 0.0090570820258, "vf_loss_unclipped": 28.36760139465332, "default_optimizer_learning_rate": 0.0002847858517, "num_trainable_parameters": 6003, "entropy": 0.5600871443748474, "gradients_default_optimizer_global_norm": 0.03713970631361008, "policy_loss": 0.049212247133255005, "num_module_steps_trained_lifetime_throughput": 311368.4749990598}}, "num_training_step_calls_per_iteration": 1, "evaluation": {"env_runners": {"agent_episode_returns_mean": {"default_agent": 0.45}, "episode_len_mean": 20.0, "sample": 0.1967814508510788, "num_env_steps_sampled_lifetime": 75400, "env_reset_timer": 0.00014227253485192025, "env_step_timer": 4.247905929856894e-05, "rlmodule_inference_timer": 6.993761428163166e-05, "module_to_env_connector": {"timers": {"connectors": {"remove_single_ts_time_rank_from_batch": 1.6886193629490997e-06, "normalize_and_clip_actions": 2.1622663797752886e-05, "tensor_to_numpy": 3.2071280224748156e-05, "listify_data_for_vector_env": 2.7538238148973994e-05, "un_batch_to_individual_items": 1.530752581965016e-05, "get_actions": 9.707855147223543e-05}}, "connector_pipeline_timer": 0.00024856851210692393}, "env_to_module_sum_episodes_length_in": 10.368238394574323, "num_agent_steps_sampled": {"default_agent": 400}, "env_to_module_sum_episodes_length_out": 10.368238394574323, "episode_return_mean": 0.45, "episode_len_min": 20, "episode_duration_sec_mean": 0.006920989175559953, "num_module_steps_sampled": {"default_policy": 400}, "env_to_module_connector": {"timers": {"connectors": {"batch_individual_items": 1.7045480202388944e-05, "add_observations_from_episodes_to_batch": 6.055314566094753e-06, "add_time_dim_to_batch_and_zero_pad": 5.332308627542585e-06, "numpy_to_tensor": 2.0404922997395002e-05, "add_states_from_episodes_to_batch": 3.2516084705660877e-06}}, "connector_pipeline_timer": 9.308153107501324e-05}, "episode_return_min": -12.5, "num_module_steps_sampled_lifetime": {"default_policy": 6000}, "weights_seq_no": 15.0, "num_episodes": 20, "num_episodes_lifetime": 300, "episode_len_max": 20, "num_env_steps_sampled": 400, "episode_return_max": 14.5, "num_agent_steps_sampled_lifetime": {"default_agent": 6000}, "module_episode_returns_mean": {"default_policy": 0.45}, "time_between_sampling": 2.6709484466987305}, "num_healthy_workers": 1, "actor_manager_num_outstanding_async_reqs": 0, "num_remote_worker_restarts": 0}, "num_env_steps_sampled_lifetime": -8017500.0, "fault_tolerance": {"num_healthy_workers": 0, "num_remote_worker_restarts": 0}, "env_runner_group": {"actor_manager_num_outstanding_async_reqs": 0}, "done": false, "training_iteration": 15, "trial_id": "497dd_00000", "date": "2025-08-11_19-33-45", "timestamp": 1754933625, "time_this_iter_s": 2.7986512184143066, "time_total_s": 44.067211866378784, "pid": 25863, "hostname": "Mac", "node_ip": "127.0.0.1", "config": {"exploration_config": {}, "extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "placement_strategy": "PACK", "num_gpus": 0, "_fake_gpus": false, "num_cpus_for_main_process": 2, "eager_tracing": true, "eager_max_retraces": 20, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "torch_compile_learner": false, "torch_compile_learner_what_to_compile": "forward_train", "torch_compile_learner_dynamo_backend": "aot_eager", "torch_compile_learner_dynamo_mode": null, "torch_compile_worker": false, "torch_compile_worker_dynamo_backend": "aot_eager", "torch_compile_worker_dynamo_mode": null, "torch_ddp_kwargs": {}, "torch_skip_nan_gradients": false, "env": "Umbrella", "env_config": {}, "observation_space": null, "action_space": null, "clip_rewards": null, "normalize_actions": true, "clip_actions": false, "_is_atari": null, "disable_env_checking": false, "render_env": false, "action_mask_key": "action_mask", "env_runner_cls": null, "num_env_runners": 0, "create_local_env_runner": true, "num_envs_per_env_runner": 1, "gym_env_vectorize_mode": "SYNC", "num_cpus_per_env_runner": 1, "num_gpus_per_env_runner": 0, "custom_resources_per_env_runner": {}, "validate_env_runners_after_construction": true, "episodes_to_numpy": true, "max_requests_in_flight_per_env_runner": 1, "sample_timeout_s": 60.0, "_env_to_module_connector": null, "add_default_connectors_to_env_to_module_pipeline": true, "_module_to_env_connector": null, "add_default_connectors_to_module_to_env_pipeline": true, "merge_env_runner_states": "training_only", "broadcast_env_runner_states": true, "episode_lookback_horizon": 1, "rollout_fragment_length": "auto", "batch_mode": "complete_episodes", "compress_observations": false, "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "enable_tf1_exec_eagerly": false, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "preprocessor_pref": "deepmind", "observation_filter": "NoFilter", "update_worker_filter_stats": true, "use_worker_filter_stats": true, "sampler_perf_stats_ema_coef": null, "_is_online": true, "num_learners": 0, "num_gpus_per_learner": 0, "num_cpus_per_learner": "auto", "num_aggregator_actors_per_learner": 0, "max_requests_in_flight_per_aggregator_actor": 3, "local_gpu_idx": 0, "max_requests_in_flight_per_learner": 3, "gamma": 1, "lr": 0.0002847858517, "grad_clip": 0.5, "grad_clip_by": "global_norm", "_train_batch_size_per_learner": 5000, "train_batch_size": 4000, "num_epochs": 1, "minibatch_size": 1000, "shuffle_batch_per_epoch": true, "model": {"fcnet_hiddens": [256, 256], "fcnet_activation": "tanh", "fcnet_weights_initializer": null, "fcnet_weights_initializer_config": null, "fcnet_bias_initializer": null, "fcnet_bias_initializer_config": null, "conv_filters": null, "conv_activation": "relu", "conv_kernel_initializer": null, "conv_kernel_initializer_config": null, "conv_bias_initializer": null, "conv_bias_initializer_config": null, "conv_transpose_kernel_initializer": null, "conv_transpose_kernel_initializer_config": null, "conv_transpose_bias_initializer": null, "conv_transpose_bias_initializer_config": null, "post_fcnet_hiddens": [], "post_fcnet_activation": "relu", "post_fcnet_weights_initializer": null, "post_fcnet_weights_initializer_config": null, "post_fcnet_bias_initializer": null, "post_fcnet_bias_initializer_config": null, "free_log_std": false, "log_std_clip_param": 20.0, "no_final_linear": false, "vf_share_layers": false, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "lstm_weights_initializer": null, "lstm_weights_initializer_config": null, "lstm_bias_initializer": null, "lstm_bias_initializer_config": null, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "attention_use_n_prev_actions": 0, "attention_use_n_prev_rewards": 0, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": null, "custom_model_config": {}, "custom_action_dist": null, "custom_preprocessor": null, "encoder_latent_dim": null, "always_check_shapes": false, "lstm_use_prev_action_reward": -1, "_use_default_native_models": -1, "_disable_preprocessor_api": false, "_disable_action_flattening": false}, "_learner_connector": null, "add_default_connectors_to_learner_pipeline": true, "learner_config_dict": {}, "optimizer": {}, "_learner_class": null, "callbacks_on_algorithm_init": null, "callbacks_on_env_runners_recreated": null, "callbacks_on_offline_eval_runners_recreated": null, "callbacks_on_checkpoint_loaded": null, "callbacks_on_environment_created": null, "callbacks_on_episode_created": null, "callbacks_on_episode_start": null, "callbacks_on_episode_step": null, "callbacks_on_episode_end": null, "callbacks_on_evaluate_start": null, "callbacks_on_evaluate_end": null, "callbacks_on_evaluate_offline_start": null, "callbacks_on_evaluate_offline_end": null, "callbacks_on_sample_end": null, "callbacks_on_train_result": null, "explore": true, "enable_rl_module_and_learner": true, "enable_env_runner_and_connector_v2": true, "_prior_exploration_config": {"type": "StochasticSampling"}, "count_steps_by": "env_steps", "policy_map_capacity": 100, "policy_mapping_fn": "<function AlgorithmConfig.DEFAULT_POLICY_MAPPING_FN at 0x14ff39b20>", "policies_to_train": null, "policy_states_are_swappable": false, "observation_fn": null, "offline_data_class": null, "input_read_method": "read_parquet", "input_read_method_kwargs": {}, "input_read_schema": {}, "input_read_episodes": false, "input_read_sample_batches": false, "input_read_batch_size": null, "input_filesystem": null, "input_filesystem_kwargs": {}, "input_compress_columns": ["obs", "new_obs"], "input_spaces_jsonable": true, "materialize_data": false, "materialize_mapped_data": true, "map_batches_kwargs": {}, "iter_batches_kwargs": {}, "ignore_final_observation": false, "prelearner_class": null, "prelearner_buffer_class": null, "prelearner_buffer_kwargs": {}, "prelearner_module_synch_period": 10, "dataset_num_iters_per_learner": null, "input_config": {}, "actions_in_input_normalized": false, "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_config": {}, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "output_max_rows_per_file": null, "output_write_remaining_data": false, "output_write_method": "write_parquet", "output_write_method_kwargs": {}, "output_filesystem": null, "output_filesystem_kwargs": {}, "output_write_episodes": true, "offline_sampling": false, "evaluation_interval": 1, "evaluation_duration": 20, "evaluation_duration_unit": "episodes", "evaluation_sample_timeout_s": 120.0, "evaluation_auto_duration_min_env_steps_per_sample": 100, "evaluation_auto_duration_max_env_steps_per_sample": 2000, "evaluation_parallel_to_training": false, "evaluation_force_reset_envs_before_iteration": true, "evaluation_config": null, "off_policy_estimation_methods": {}, "ope_split_batch_by_episode": true, "evaluation_num_env_runners": 1, "in_evaluation": false, "sync_filters_on_rollout_workers_timeout_s": 10.0, "offline_evaluation_interval": null, "num_offline_eval_runners": 0, "offline_loss_for_module_fn": null, "offline_evaluation_duration": 1, "offline_evaluation_parallel_to_training": false, "offline_evaluation_timeout_s": 120.0, "num_cpus_per_offline_eval_runner": 1, "num_gpus_per_offline_eval_runner": 0, "custom_resources_per_offline_eval_runner": {}, "restart_failed_offline_eval_runners": true, "ignore_offline_eval_runner_failures": false, "max_num_offline_eval_runner_restarts": 1000, "offline_eval_runner_restore_timeout_s": 1800.0, "max_requests_in_flight_per_offline_eval_runner": 1, "validate_offline_eval_runners_after_construction": true, "offline_eval_runner_health_probe_timeout_s": 30.0, "offline_eval_rl_module_inference_only": false, "broadcast_offline_eval_runner_states": false, "offline_eval_batch_size_per_runner": 256, "dataset_num_iters_per_eval_runner": 1, "keep_per_episode_custom_metrics": false, "metrics_episode_collection_timeout_s": 60.0, "metrics_num_episodes_for_smoothing": 100, "min_time_s_per_iteration": null, "min_train_timesteps_per_iteration": 0, "min_sample_timesteps_per_iteration": 0, "log_gradients": true, "export_native_model_files": false, "checkpoint_trainable_policies_only": false, "logger_creator": null, "logger_config": null, "log_level": "WARN", "log_sys_usage": true, "fake_sampler": false, "seed": 7, "restart_failed_env_runners": true, "ignore_env_runner_failures": false, "max_num_env_runner_restarts": 1000, "delay_between_env_runner_restarts_s": 60.0, "restart_failed_sub_environments": false, "num_consecutive_env_runner_failures_tolerance": 100, "env_runner_health_probe_timeout_s": 30.0, "env_runner_restore_timeout_s": 1800.0, "_model_config": {}, "_rl_module_spec": "RLModuleSpec(module_class=None, observation_space=None, action_space=None, inference_only=False, learner_only=False, model_config=DefaultModelConfig(fcnet_hiddens=[60, 90], fcnet_activation='tanh', fcnet_kernel_initializer=None, fcnet_kernel_initializer_kwargs=None, fcnet_bias_initializer=None, fcnet_bias_initializer_kwargs=None, conv_filters=None, conv_activation='relu', conv_kernel_initializer=None, conv_kernel_initializer_kwargs=None, conv_bias_initializer=None, conv_bias_initializer_kwargs=None, head_fcnet_hiddens=[], head_fcnet_activation='relu', head_fcnet_kernel_initializer=None, head_fcnet_kernel_initializer_kwargs=None, head_fcnet_bias_initializer=None, head_fcnet_bias_initializer_kwargs=None, free_log_std=False, log_std_clip_param=20.0, vf_share_layers=True, use_lstm=False, max_seq_len=20, lstm_cell_size=256, lstm_use_prev_action=False, lstm_use_prev_reward=False, lstm_kernel_initializer=None, lstm_kernel_initializer_kwargs=None, lstm_bias_initializer=None, lstm_bias_initializer_kwargs=None), catalog_class=None, load_state_path=None, model_config_dict=None)", "algorithm_config_overrides_per_module": {}, "_per_module_overrides": {}, "_validate_config": true, "_use_msgpack_checkpoints": false, "_torch_grad_scaler_class": null, "_torch_lr_scheduler_classes": null, "_tf_policy_handles_more_than_one_loss": false, "_disable_preprocessor_api": false, "_disable_action_flattening": false, "_disable_initialize_loss_from_dummy_batch": false, "_dont_auto_sync_env_runner_states": false, "env_task_fn": -1, "enable_connectors": -1, "simple_optimizer": false, "policy_map_cache": -1, "worker_cls": -1, "synchronize_filters": -1, "enable_async_evaluation": -1, "custom_async_evaluation_function": -1, "_enable_rl_module_api": -1, "auto_wrap_old_gym_envs": -1, "always_attach_evaluation_results": -1, "replay_sequence_length": null, "_disable_execution_plan_api": -1, "use_critic": true, "use_gae": true, "use_kl_loss": true, "kl_coeff": 0.7464963036515, "kl_target": 0.0270990929592, "vf_loss_coeff": 0.6688075857018, "entropy_coeff": 0.0090570820258, "clip_param": 0.1221781641624, "vf_clip_param": 0.1027808522125, "entropy_coeff_schedule": null, "lr_schedule": null, "sgd_minibatch_size": -1, "vf_share_layers": -1, "__stdout_file__": null, "__stderr_file__": null, "lambda": 0.9099046732075, "input": "sampler", "policies": {"default_policy": [null, null, null, null]}, "callbacks": "<class 'ray.rllib.callbacks.callbacks.RLlibCallback'>", "create_env_on_driver": false, "custom_eval_function": null, "framework": "torch"}, "time_since_restore": 44.067211866378784, "iterations_since_restore": 15, "perf": {"cpu_util_percent": 72.4, "ram_util_percent": 79.5}}
{"timers": {"training_iteration": 3.320994536264757, "restore_env_runners": 2.7949063621165945e-05, "training_step": 3.320726656406031, "env_runner_sampling_timer": 3.1596915723255594, "learner_update_timer": 0.15530904807626472, "synch_weights": 0.0013094665754957299, "restore_eval_env_runners": 1.1505490416885076e-05, "evaluation_iteration": 0.20439557708546033, "synch_eval_env_connectors": 0.0001638967684428351, "synch_env_connectors": 5.753650025694927e-06}, "env_runners": {"module_to_env_connector": {"timers": {"connectors": {"tensor_to_numpy": 2.3881388574946878e-05, "listify_data_for_vector_env": 1.8814167285380426e-05, "remove_single_ts_time_rank_from_batch": 9.590644795940094e-07, "get_actions": 8.087200994638776e-05, "normalize_and_clip_actions": 1.6017862841666005e-05, "un_batch_to_individual_items": 8.798200941410112e-06}}, "connector_pipeline_timer": 0.0001913829061506356}, "time_between_sampling": 0.0028425679224944015, "num_env_steps_sampled_lifetime": -8635000.0, "env_to_module_connector": {"timers": {"connectors": {"add_observations_from_episodes_to_batch": 4.781580413819981e-06, "add_time_dim_to_batch_and_zero_pad": 4.054045882232851e-06, "batch_individual_items": 1.1575406409254305e-05, "numpy_to_tensor": 1.654788156382094e-05, "add_states_from_episodes_to_batch": 2.5956070501358752e-06}}, "connector_pipeline_timer": 7.258168366022133e-05}, "num_module_steps_sampled_lifetime": {"default_policy": -8635000.0}, "episode_return_min": -9.5, "weights_seq_no": 15.0, "num_episodes": 250.0, "env_reset_timer": 7.570173352721893e-05, "env_to_module_sum_episodes_length_out": 10.36823839457432, "num_env_steps_sampled": 5000.0, "env_step_timer": 2.538233807712157e-05, "episode_return_mean": 7.2200000000000015, "episode_return_max": 10.5, "episode_len_min": 20, "num_agent_steps_sampled_lifetime": {"default_agent": -8635000.0}, "rlmodule_inference_timer": 5.258883296325294e-05, "module_episode_returns_mean": {"default_policy": 7.2200000000000015}, "agent_episode_returns_mean": {"default_agent": 7.2200000000000015}, "num_episodes_lifetime": -431750.0, "num_module_steps_sampled": {"default_policy": 5000.0}, "num_agent_steps_sampled": {"default_agent": 5000.0}, "episode_duration_sec_mean": 0.008236531818285583, "env_to_module_sum_episodes_length_in": 10.36823839457432, "episode_len_max": 20, "episode_len_mean": 20.0, "sample": 0.00829960351310299, "num_env_steps_sampled_lifetime_throughput": 2427.5329317871156}, "learners": {"__all_modules__": {"learner_connector": {"timers": {"connectors": {"numpy_to_tensor": 8.022460053487612e-05, "add_states_from_episodes_to_batch": 4.8392183385217295e-06, "add_one_ts_to_episodes_and_truncate": 0.013762906002619507, "general_advantage_estimation": 0.008890216554869566, "batch_individual_items": 0.049532238407476094, "add_columns_from_episodes_to_train_batch": 0.049133810378024306, "add_observations_from_episodes_to_batch": 0.0010769701327657732, "add_time_dim_to_batch_and_zero_pad": 1.3543640614890605e-05}}, "connector_pipeline_timer": 0.12270844023713828}, "num_module_steps_trained_lifetime": 96000, "num_module_steps_trained": 6000, "num_env_steps_trained": 31500, "learner_connector_sum_episodes_length_out": 5250.0, "learner_connector_sum_episodes_length_in": 5000.0, "num_env_steps_trained_lifetime": 504000, "num_trainable_parameters": 6003, "num_non_trainable_parameters": 0, "num_env_steps_trained_lifetime_throughput": 1620670.12470305, "num_module_steps_trained_throughput": 309578.8824422437, "num_module_steps_trained_lifetime_throughput": 309255.9898152864}, "default_policy": {"module_train_batch_size_mean": 1000.0, "total_loss": 0.11603890359401703, "vf_explained_var": -0.009708046913146973, "mean_kl_loss": 0.0002683716011233628, "num_module_steps_trained_lifetime": 96000, "num_module_steps_trained": 6000, "weights_seq_no": 16.0, "diff_num_grad_updates_vs_sampler_policy": 1.0, "vf_loss": 0.10278083384037018, "curr_kl_coeff": 1.1390629879315384e-05, "curr_entropy_coeff": 0.0090570820258, "vf_loss_unclipped": 28.182588577270508, "default_optimizer_learning_rate": 0.0002847858517, "num_trainable_parameters": 6003, "entropy": 0.5402327179908752, "gradients_default_optimizer_global_norm": 0.02891549840569496, "policy_loss": 0.05219123512506485, "num_module_steps_trained_lifetime_throughput": 309866.08498027275}}, "num_training_step_calls_per_iteration": 1, "evaluation": {"env_runners": {"agent_episode_returns_mean": {"default_agent": 0.45}, "episode_len_mean": 20.0, "sample": 0.196299948841605, "num_env_steps_sampled_lifetime": 80400, "env_reset_timer": 0.00014245063892214966, "env_step_timer": 2.1484588170103218e-05, "rlmodule_inference_timer": 3.953251492798331e-05, "module_to_env_connector": {"timers": {"connectors": {"remove_single_ts_time_rank_from_batch": 9.883474056261323e-07, "normalize_and_clip_actions": 1.2380639278622372e-05, "tensor_to_numpy": 1.897618171212666e-05, "listify_data_for_vector_env": 1.5114040273198779e-05, "un_batch_to_individual_items": 7.852999020067272e-06, "get_actions": 5.58547687695926e-05}}, "connector_pipeline_timer": 0.00014497575478263634}, "env_to_module_sum_episodes_length_in": 10.368238394574323, "num_agent_steps_sampled": {"default_agent": 400}, "env_to_module_sum_episodes_length_out": 10.368238394574323, "episode_return_mean": 0.45, "episode_len_min": 20, "episode_duration_sec_mean": 0.006873160005779937, "num_module_steps_sampled": {"default_policy": 400}, "env_to_module_connector": {"timers": {"connectors": {"batch_individual_items": 8.437928659435625e-06, "add_observations_from_episodes_to_batch": 3.824333598062178e-06, "add_time_dim_to_batch_and_zero_pad": 3.6323598851160924e-06, "numpy_to_tensor": 1.2005842158937912e-05, "add_states_from_episodes_to_batch": 2.210535050874334e-06}}, "connector_pipeline_timer": 5.778966930751052e-05}, "episode_return_min": -12.5, "num_module_steps_sampled_lifetime": {"default_policy": 6400}, "weights_seq_no": 16.0, "num_episodes": 20, "num_episodes_lifetime": 320, "episode_len_max": 20, "num_env_steps_sampled": 400, "episode_return_max": 14.5, "num_agent_steps_sampled_lifetime": {"default_agent": 6400}, "module_episode_returns_mean": {"default_policy": 0.45}, "time_between_sampling": 2.670518263070685}, "num_healthy_workers": 1, "actor_manager_num_outstanding_async_reqs": 0, "num_remote_worker_restarts": 0}, "num_env_steps_sampled_lifetime": -8635000.0, "fault_tolerance": {"num_healthy_workers": 0, "num_remote_worker_restarts": 0}, "env_runner_group": {"actor_manager_num_outstanding_async_reqs": 0}, "done": false, "training_iteration": 16, "trial_id": "497dd_00000", "date": "2025-08-11_19-33-48", "timestamp": 1754933628, "time_this_iter_s": 2.758843183517456, "time_total_s": 46.82605504989624, "pid": 25863, "hostname": "Mac", "node_ip": "127.0.0.1", "config": {"exploration_config": {}, "extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "placement_strategy": "PACK", "num_gpus": 0, "_fake_gpus": false, "num_cpus_for_main_process": 2, "eager_tracing": true, "eager_max_retraces": 20, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "torch_compile_learner": false, "torch_compile_learner_what_to_compile": "forward_train", "torch_compile_learner_dynamo_backend": "aot_eager", "torch_compile_learner_dynamo_mode": null, "torch_compile_worker": false, "torch_compile_worker_dynamo_backend": "aot_eager", "torch_compile_worker_dynamo_mode": null, "torch_ddp_kwargs": {}, "torch_skip_nan_gradients": false, "env": "Umbrella", "env_config": {}, "observation_space": null, "action_space": null, "clip_rewards": null, "normalize_actions": true, "clip_actions": false, "_is_atari": null, "disable_env_checking": false, "render_env": false, "action_mask_key": "action_mask", "env_runner_cls": null, "num_env_runners": 0, "create_local_env_runner": true, "num_envs_per_env_runner": 1, "gym_env_vectorize_mode": "SYNC", "num_cpus_per_env_runner": 1, "num_gpus_per_env_runner": 0, "custom_resources_per_env_runner": {}, "validate_env_runners_after_construction": true, "episodes_to_numpy": true, "max_requests_in_flight_per_env_runner": 1, "sample_timeout_s": 60.0, "_env_to_module_connector": null, "add_default_connectors_to_env_to_module_pipeline": true, "_module_to_env_connector": null, "add_default_connectors_to_module_to_env_pipeline": true, "merge_env_runner_states": "training_only", "broadcast_env_runner_states": true, "episode_lookback_horizon": 1, "rollout_fragment_length": "auto", "batch_mode": "complete_episodes", "compress_observations": false, "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "enable_tf1_exec_eagerly": false, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "preprocessor_pref": "deepmind", "observation_filter": "NoFilter", "update_worker_filter_stats": true, "use_worker_filter_stats": true, "sampler_perf_stats_ema_coef": null, "_is_online": true, "num_learners": 0, "num_gpus_per_learner": 0, "num_cpus_per_learner": "auto", "num_aggregator_actors_per_learner": 0, "max_requests_in_flight_per_aggregator_actor": 3, "local_gpu_idx": 0, "max_requests_in_flight_per_learner": 3, "gamma": 1, "lr": 0.0002847858517, "grad_clip": 0.5, "grad_clip_by": "global_norm", "_train_batch_size_per_learner": 5000, "train_batch_size": 4000, "num_epochs": 1, "minibatch_size": 1000, "shuffle_batch_per_epoch": true, "model": {"fcnet_hiddens": [256, 256], "fcnet_activation": "tanh", "fcnet_weights_initializer": null, "fcnet_weights_initializer_config": null, "fcnet_bias_initializer": null, "fcnet_bias_initializer_config": null, "conv_filters": null, "conv_activation": "relu", "conv_kernel_initializer": null, "conv_kernel_initializer_config": null, "conv_bias_initializer": null, "conv_bias_initializer_config": null, "conv_transpose_kernel_initializer": null, "conv_transpose_kernel_initializer_config": null, "conv_transpose_bias_initializer": null, "conv_transpose_bias_initializer_config": null, "post_fcnet_hiddens": [], "post_fcnet_activation": "relu", "post_fcnet_weights_initializer": null, "post_fcnet_weights_initializer_config": null, "post_fcnet_bias_initializer": null, "post_fcnet_bias_initializer_config": null, "free_log_std": false, "log_std_clip_param": 20.0, "no_final_linear": false, "vf_share_layers": false, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "lstm_weights_initializer": null, "lstm_weights_initializer_config": null, "lstm_bias_initializer": null, "lstm_bias_initializer_config": null, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "attention_use_n_prev_actions": 0, "attention_use_n_prev_rewards": 0, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": null, "custom_model_config": {}, "custom_action_dist": null, "custom_preprocessor": null, "encoder_latent_dim": null, "always_check_shapes": false, "lstm_use_prev_action_reward": -1, "_use_default_native_models": -1, "_disable_preprocessor_api": false, "_disable_action_flattening": false}, "_learner_connector": null, "add_default_connectors_to_learner_pipeline": true, "learner_config_dict": {}, "optimizer": {}, "_learner_class": null, "callbacks_on_algorithm_init": null, "callbacks_on_env_runners_recreated": null, "callbacks_on_offline_eval_runners_recreated": null, "callbacks_on_checkpoint_loaded": null, "callbacks_on_environment_created": null, "callbacks_on_episode_created": null, "callbacks_on_episode_start": null, "callbacks_on_episode_step": null, "callbacks_on_episode_end": null, "callbacks_on_evaluate_start": null, "callbacks_on_evaluate_end": null, "callbacks_on_evaluate_offline_start": null, "callbacks_on_evaluate_offline_end": null, "callbacks_on_sample_end": null, "callbacks_on_train_result": null, "explore": true, "enable_rl_module_and_learner": true, "enable_env_runner_and_connector_v2": true, "_prior_exploration_config": {"type": "StochasticSampling"}, "count_steps_by": "env_steps", "policy_map_capacity": 100, "policy_mapping_fn": "<function AlgorithmConfig.DEFAULT_POLICY_MAPPING_FN at 0x14ff39b20>", "policies_to_train": null, "policy_states_are_swappable": false, "observation_fn": null, "offline_data_class": null, "input_read_method": "read_parquet", "input_read_method_kwargs": {}, "input_read_schema": {}, "input_read_episodes": false, "input_read_sample_batches": false, "input_read_batch_size": null, "input_filesystem": null, "input_filesystem_kwargs": {}, "input_compress_columns": ["obs", "new_obs"], "input_spaces_jsonable": true, "materialize_data": false, "materialize_mapped_data": true, "map_batches_kwargs": {}, "iter_batches_kwargs": {}, "ignore_final_observation": false, "prelearner_class": null, "prelearner_buffer_class": null, "prelearner_buffer_kwargs": {}, "prelearner_module_synch_period": 10, "dataset_num_iters_per_learner": null, "input_config": {}, "actions_in_input_normalized": false, "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_config": {}, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "output_max_rows_per_file": null, "output_write_remaining_data": false, "output_write_method": "write_parquet", "output_write_method_kwargs": {}, "output_filesystem": null, "output_filesystem_kwargs": {}, "output_write_episodes": true, "offline_sampling": false, "evaluation_interval": 1, "evaluation_duration": 20, "evaluation_duration_unit": "episodes", "evaluation_sample_timeout_s": 120.0, "evaluation_auto_duration_min_env_steps_per_sample": 100, "evaluation_auto_duration_max_env_steps_per_sample": 2000, "evaluation_parallel_to_training": false, "evaluation_force_reset_envs_before_iteration": true, "evaluation_config": null, "off_policy_estimation_methods": {}, "ope_split_batch_by_episode": true, "evaluation_num_env_runners": 1, "in_evaluation": false, "sync_filters_on_rollout_workers_timeout_s": 10.0, "offline_evaluation_interval": null, "num_offline_eval_runners": 0, "offline_loss_for_module_fn": null, "offline_evaluation_duration": 1, "offline_evaluation_parallel_to_training": false, "offline_evaluation_timeout_s": 120.0, "num_cpus_per_offline_eval_runner": 1, "num_gpus_per_offline_eval_runner": 0, "custom_resources_per_offline_eval_runner": {}, "restart_failed_offline_eval_runners": true, "ignore_offline_eval_runner_failures": false, "max_num_offline_eval_runner_restarts": 1000, "offline_eval_runner_restore_timeout_s": 1800.0, "max_requests_in_flight_per_offline_eval_runner": 1, "validate_offline_eval_runners_after_construction": true, "offline_eval_runner_health_probe_timeout_s": 30.0, "offline_eval_rl_module_inference_only": false, "broadcast_offline_eval_runner_states": false, "offline_eval_batch_size_per_runner": 256, "dataset_num_iters_per_eval_runner": 1, "keep_per_episode_custom_metrics": false, "metrics_episode_collection_timeout_s": 60.0, "metrics_num_episodes_for_smoothing": 100, "min_time_s_per_iteration": null, "min_train_timesteps_per_iteration": 0, "min_sample_timesteps_per_iteration": 0, "log_gradients": true, "export_native_model_files": false, "checkpoint_trainable_policies_only": false, "logger_creator": null, "logger_config": null, "log_level": "WARN", "log_sys_usage": true, "fake_sampler": false, "seed": 7, "restart_failed_env_runners": true, "ignore_env_runner_failures": false, "max_num_env_runner_restarts": 1000, "delay_between_env_runner_restarts_s": 60.0, "restart_failed_sub_environments": false, "num_consecutive_env_runner_failures_tolerance": 100, "env_runner_health_probe_timeout_s": 30.0, "env_runner_restore_timeout_s": 1800.0, "_model_config": {}, "_rl_module_spec": "RLModuleSpec(module_class=None, observation_space=None, action_space=None, inference_only=False, learner_only=False, model_config=DefaultModelConfig(fcnet_hiddens=[60, 90], fcnet_activation='tanh', fcnet_kernel_initializer=None, fcnet_kernel_initializer_kwargs=None, fcnet_bias_initializer=None, fcnet_bias_initializer_kwargs=None, conv_filters=None, conv_activation='relu', conv_kernel_initializer=None, conv_kernel_initializer_kwargs=None, conv_bias_initializer=None, conv_bias_initializer_kwargs=None, head_fcnet_hiddens=[], head_fcnet_activation='relu', head_fcnet_kernel_initializer=None, head_fcnet_kernel_initializer_kwargs=None, head_fcnet_bias_initializer=None, head_fcnet_bias_initializer_kwargs=None, free_log_std=False, log_std_clip_param=20.0, vf_share_layers=True, use_lstm=False, max_seq_len=20, lstm_cell_size=256, lstm_use_prev_action=False, lstm_use_prev_reward=False, lstm_kernel_initializer=None, lstm_kernel_initializer_kwargs=None, lstm_bias_initializer=None, lstm_bias_initializer_kwargs=None), catalog_class=None, load_state_path=None, model_config_dict=None)", "algorithm_config_overrides_per_module": {}, "_per_module_overrides": {}, "_validate_config": true, "_use_msgpack_checkpoints": false, "_torch_grad_scaler_class": null, "_torch_lr_scheduler_classes": null, "_tf_policy_handles_more_than_one_loss": false, "_disable_preprocessor_api": false, "_disable_action_flattening": false, "_disable_initialize_loss_from_dummy_batch": false, "_dont_auto_sync_env_runner_states": false, "env_task_fn": -1, "enable_connectors": -1, "simple_optimizer": false, "policy_map_cache": -1, "worker_cls": -1, "synchronize_filters": -1, "enable_async_evaluation": -1, "custom_async_evaluation_function": -1, "_enable_rl_module_api": -1, "auto_wrap_old_gym_envs": -1, "always_attach_evaluation_results": -1, "replay_sequence_length": null, "_disable_execution_plan_api": -1, "use_critic": true, "use_gae": true, "use_kl_loss": true, "kl_coeff": 0.7464963036515, "kl_target": 0.0270990929592, "vf_loss_coeff": 0.6688075857018, "entropy_coeff": 0.0090570820258, "clip_param": 0.1221781641624, "vf_clip_param": 0.1027808522125, "entropy_coeff_schedule": null, "lr_schedule": null, "sgd_minibatch_size": -1, "vf_share_layers": -1, "__stdout_file__": null, "__stderr_file__": null, "lambda": 0.9099046732075, "input": "sampler", "policies": {"default_policy": [null, null, null, null]}, "callbacks": "<class 'ray.rllib.callbacks.callbacks.RLlibCallback'>", "create_env_on_driver": false, "custom_eval_function": null, "framework": "torch"}, "time_since_restore": 46.82605504989624, "iterations_since_restore": 16, "perf": {"cpu_util_percent": 73.825, "ram_util_percent": 79.25}}
{"timers": {"training_iteration": 3.31570887007222, "restore_env_runners": 2.7724572239598203e-05, "training_step": 3.3154415923420197, "env_runner_sampling_timer": 3.154946544102683, "learner_update_timer": 0.15479265009584933, "synch_weights": 0.0013026827505765674, "restore_eval_env_runners": 1.1793345449099592e-05, "evaluation_iteration": 0.20391860506469572, "synch_eval_env_connectors": 0.0001647948806123438, "synch_env_connectors": 5.746953260633018e-06}, "env_runners": {"module_to_env_connector": {"timers": {"connectors": {"tensor_to_numpy": 2.595699253327344e-05, "listify_data_for_vector_env": 1.9872504871340876e-05, "remove_single_ts_time_rank_from_batch": 1.1904393157236995e-06, "get_actions": 8.314563821744236e-05, "normalize_and_clip_actions": 1.742280967974682e-05, "un_batch_to_individual_items": 1.1009637964263047e-05}}, "connector_pipeline_timer": 0.00020324936853739284}, "time_between_sampling": 0.002361840555925137, "num_env_steps_sampled_lifetime": -9252500.0, "env_to_module_connector": {"timers": {"connectors": {"add_observations_from_episodes_to_batch": 5.517794422170627e-06, "add_time_dim_to_batch_and_zero_pad": 4.165744958199341e-06, "batch_individual_items": 1.228954787012544e-05, "numpy_to_tensor": 1.718392801111091e-05, "add_states_from_episodes_to_batch": 2.6794680460401636e-06}}, "connector_pipeline_timer": 7.744668568521196e-05}, "num_module_steps_sampled_lifetime": {"default_policy": -9252500.0}, "episode_return_min": -9.5, "weights_seq_no": 16.0, "num_episodes": 250.0, "env_reset_timer": 7.928416384865559e-05, "env_to_module_sum_episodes_length_out": 10.36823839457432, "num_env_steps_sampled": 5000.0, "env_step_timer": 2.675333348572932e-05, "episode_return_mean": 7.299999999999996, "episode_return_max": 10.5, "episode_len_min": 20, "num_agent_steps_sampled_lifetime": {"default_agent": -9252500.0}, "rlmodule_inference_timer": 7.618365338893718e-05, "module_episode_returns_mean": {"default_policy": 7.299999999999996}, "agent_episode_returns_mean": {"default_agent": 7.299999999999996}, "num_episodes_lifetime": -462625.0, "num_module_steps_sampled": {"default_policy": 5000.0}, "num_agent_steps_sampled": {"default_agent": 5000.0}, "episode_duration_sec_mean": 0.00911239230493084, "env_to_module_sum_episodes_length_in": 10.36823839457432, "episode_len_max": 20, "episode_len_mean": 20.0, "sample": 0.009671550703164186, "num_env_steps_sampled_lifetime_throughput": 2276.788449954046}, "learners": {"__all_modules__": {"learner_connector": {"timers": {"connectors": {"numpy_to_tensor": 8.042444481412821e-05, "add_states_from_episodes_to_batch": 4.822076684127735e-06, "add_one_ts_to_episodes_and_truncate": 0.01371180236278594, "general_advantage_estimation": 0.00886687271970961, "batch_individual_items": 0.049375223942847705, "add_columns_from_episodes_to_train_batch": 0.04901567102397443, "add_observations_from_episodes_to_batch": 0.001078851681437296, "add_time_dim_to_batch_and_zero_pad": 1.3522373879010593e-05}}, "connector_pipeline_timer": 0.12236006333470871}, "num_module_steps_trained_lifetime": 102000, "num_module_steps_trained": 6000, "num_env_steps_trained": 31500, "learner_connector_sum_episodes_length_out": 5250.0, "learner_connector_sum_episodes_length_in": 5000.0, "num_env_steps_trained_lifetime": 535500, "num_trainable_parameters": 6003, "num_non_trainable_parameters": 0, "num_env_steps_trained_lifetime_throughput": 1619803.1454672457, "num_module_steps_trained_throughput": 309370.0665752892, "num_module_steps_trained_lifetime_throughput": 309060.86249600194}, "default_policy": {"module_train_batch_size_mean": 1000.0, "total_loss": 0.005944760516285896, "vf_explained_var": -0.00909113883972168, "mean_kl_loss": 1.595735375303775e-05, "num_module_steps_trained_lifetime": 102000, "num_module_steps_trained": 6000, "weights_seq_no": 17.0, "diff_num_grad_updates_vs_sampler_policy": 1.0, "vf_loss": 0.10278083384037018, "curr_kl_coeff": 5.695314939657692e-06, "curr_entropy_coeff": 0.0090570820258, "vf_loss_unclipped": 28.024700164794922, "default_optimizer_learning_rate": 0.0002847858517, "num_trainable_parameters": 6003, "entropy": 0.5353696346282959, "gradients_default_optimizer_global_norm": 0.05952993407845497, "policy_loss": -0.057946957647800446, "num_module_steps_trained_lifetime_throughput": 309616.82122235897}}, "num_training_step_calls_per_iteration": 1, "evaluation": {"env_runners": {"agent_episode_returns_mean": {"default_agent": 0.25}, "episode_len_mean": 20.0, "sample": 0.1962356326825346, "num_env_steps_sampled_lifetime": 85400, "env_reset_timer": 0.00014364280204993862, "env_step_timer": 2.5919789823462052e-05, "rlmodule_inference_timer": 4.949027524063794e-05, "module_to_env_connector": {"timers": {"connectors": {"remove_single_ts_time_rank_from_batch": 1.0247203825301242e-06, "normalize_and_clip_actions": 1.4700469326508085e-05, "tensor_to_numpy": 2.2018409019970825e-05, "listify_data_for_vector_env": 1.7546594226023633e-05, "un_batch_to_individual_items": 8.058652654591952e-06, "get_actions": 7.019260357813842e-05}}, "connector_pipeline_timer": 0.00017334568165026197}, "env_to_module_sum_episodes_length_in": 10.368238394574323, "num_agent_steps_sampled": {"default_agent": 400}, "env_to_module_sum_episodes_length_out": 10.368238394574323, "episode_return_mean": 0.25, "episode_len_min": 20, "episode_duration_sec_mean": 0.007317000002367422, "num_module_steps_sampled": {"default_policy": 400}, "env_to_module_connector": {"timers": {"connectors": {"batch_individual_items": 1.1888097070598262e-05, "add_observations_from_episodes_to_batch": 4.337376706394615e-06, "add_time_dim_to_batch_and_zero_pad": 3.7220797572514774e-06, "numpy_to_tensor": 1.511935748713489e-05, "add_states_from_episodes_to_batch": 2.273351153743103e-06}}, "connector_pipeline_timer": 6.657882188521315e-05}, "episode_return_min": -12.5, "num_module_steps_sampled_lifetime": {"default_policy": 6800}, "weights_seq_no": 17.0, "num_episodes": 20, "num_episodes_lifetime": 340, "episode_len_max": 20, "num_env_steps_sampled": 400, "episode_return_max": 14.5, "num_agent_steps_sampled_lifetime": {"default_agent": 6800}, "module_episode_returns_mean": {"default_policy": 0.25}, "time_between_sampling": 2.671990707109618}, "num_healthy_workers": 1, "actor_manager_num_outstanding_async_reqs": 0, "num_remote_worker_restarts": 0}, "num_env_steps_sampled_lifetime": -9252500.0, "fault_tolerance": {"num_healthy_workers": 0, "num_remote_worker_restarts": 0}, "env_runner_group": {"actor_manager_num_outstanding_async_reqs": 0}, "done": false, "training_iteration": 17, "trial_id": "497dd_00000", "date": "2025-08-11_19-33-51", "timestamp": 1754933631, "time_this_iter_s": 2.991485357284546, "time_total_s": 49.817540407180786, "pid": 25863, "hostname": "Mac", "node_ip": "127.0.0.1", "config": {"exploration_config": {}, "extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "placement_strategy": "PACK", "num_gpus": 0, "_fake_gpus": false, "num_cpus_for_main_process": 2, "eager_tracing": true, "eager_max_retraces": 20, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "torch_compile_learner": false, "torch_compile_learner_what_to_compile": "forward_train", "torch_compile_learner_dynamo_backend": "aot_eager", "torch_compile_learner_dynamo_mode": null, "torch_compile_worker": false, "torch_compile_worker_dynamo_backend": "aot_eager", "torch_compile_worker_dynamo_mode": null, "torch_ddp_kwargs": {}, "torch_skip_nan_gradients": false, "env": "Umbrella", "env_config": {}, "observation_space": null, "action_space": null, "clip_rewards": null, "normalize_actions": true, "clip_actions": false, "_is_atari": null, "disable_env_checking": false, "render_env": false, "action_mask_key": "action_mask", "env_runner_cls": null, "num_env_runners": 0, "create_local_env_runner": true, "num_envs_per_env_runner": 1, "gym_env_vectorize_mode": "SYNC", "num_cpus_per_env_runner": 1, "num_gpus_per_env_runner": 0, "custom_resources_per_env_runner": {}, "validate_env_runners_after_construction": true, "episodes_to_numpy": true, "max_requests_in_flight_per_env_runner": 1, "sample_timeout_s": 60.0, "_env_to_module_connector": null, "add_default_connectors_to_env_to_module_pipeline": true, "_module_to_env_connector": null, "add_default_connectors_to_module_to_env_pipeline": true, "merge_env_runner_states": "training_only", "broadcast_env_runner_states": true, "episode_lookback_horizon": 1, "rollout_fragment_length": "auto", "batch_mode": "complete_episodes", "compress_observations": false, "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "enable_tf1_exec_eagerly": false, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "preprocessor_pref": "deepmind", "observation_filter": "NoFilter", "update_worker_filter_stats": true, "use_worker_filter_stats": true, "sampler_perf_stats_ema_coef": null, "_is_online": true, "num_learners": 0, "num_gpus_per_learner": 0, "num_cpus_per_learner": "auto", "num_aggregator_actors_per_learner": 0, "max_requests_in_flight_per_aggregator_actor": 3, "local_gpu_idx": 0, "max_requests_in_flight_per_learner": 3, "gamma": 1, "lr": 0.0002847858517, "grad_clip": 0.5, "grad_clip_by": "global_norm", "_train_batch_size_per_learner": 5000, "train_batch_size": 4000, "num_epochs": 1, "minibatch_size": 1000, "shuffle_batch_per_epoch": true, "model": {"fcnet_hiddens": [256, 256], "fcnet_activation": "tanh", "fcnet_weights_initializer": null, "fcnet_weights_initializer_config": null, "fcnet_bias_initializer": null, "fcnet_bias_initializer_config": null, "conv_filters": null, "conv_activation": "relu", "conv_kernel_initializer": null, "conv_kernel_initializer_config": null, "conv_bias_initializer": null, "conv_bias_initializer_config": null, "conv_transpose_kernel_initializer": null, "conv_transpose_kernel_initializer_config": null, "conv_transpose_bias_initializer": null, "conv_transpose_bias_initializer_config": null, "post_fcnet_hiddens": [], "post_fcnet_activation": "relu", "post_fcnet_weights_initializer": null, "post_fcnet_weights_initializer_config": null, "post_fcnet_bias_initializer": null, "post_fcnet_bias_initializer_config": null, "free_log_std": false, "log_std_clip_param": 20.0, "no_final_linear": false, "vf_share_layers": false, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "lstm_weights_initializer": null, "lstm_weights_initializer_config": null, "lstm_bias_initializer": null, "lstm_bias_initializer_config": null, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "attention_use_n_prev_actions": 0, "attention_use_n_prev_rewards": 0, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": null, "custom_model_config": {}, "custom_action_dist": null, "custom_preprocessor": null, "encoder_latent_dim": null, "always_check_shapes": false, "lstm_use_prev_action_reward": -1, "_use_default_native_models": -1, "_disable_preprocessor_api": false, "_disable_action_flattening": false}, "_learner_connector": null, "add_default_connectors_to_learner_pipeline": true, "learner_config_dict": {}, "optimizer": {}, "_learner_class": null, "callbacks_on_algorithm_init": null, "callbacks_on_env_runners_recreated": null, "callbacks_on_offline_eval_runners_recreated": null, "callbacks_on_checkpoint_loaded": null, "callbacks_on_environment_created": null, "callbacks_on_episode_created": null, "callbacks_on_episode_start": null, "callbacks_on_episode_step": null, "callbacks_on_episode_end": null, "callbacks_on_evaluate_start": null, "callbacks_on_evaluate_end": null, "callbacks_on_evaluate_offline_start": null, "callbacks_on_evaluate_offline_end": null, "callbacks_on_sample_end": null, "callbacks_on_train_result": null, "explore": true, "enable_rl_module_and_learner": true, "enable_env_runner_and_connector_v2": true, "_prior_exploration_config": {"type": "StochasticSampling"}, "count_steps_by": "env_steps", "policy_map_capacity": 100, "policy_mapping_fn": "<function AlgorithmConfig.DEFAULT_POLICY_MAPPING_FN at 0x14ff39b20>", "policies_to_train": null, "policy_states_are_swappable": false, "observation_fn": null, "offline_data_class": null, "input_read_method": "read_parquet", "input_read_method_kwargs": {}, "input_read_schema": {}, "input_read_episodes": false, "input_read_sample_batches": false, "input_read_batch_size": null, "input_filesystem": null, "input_filesystem_kwargs": {}, "input_compress_columns": ["obs", "new_obs"], "input_spaces_jsonable": true, "materialize_data": false, "materialize_mapped_data": true, "map_batches_kwargs": {}, "iter_batches_kwargs": {}, "ignore_final_observation": false, "prelearner_class": null, "prelearner_buffer_class": null, "prelearner_buffer_kwargs": {}, "prelearner_module_synch_period": 10, "dataset_num_iters_per_learner": null, "input_config": {}, "actions_in_input_normalized": false, "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_config": {}, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "output_max_rows_per_file": null, "output_write_remaining_data": false, "output_write_method": "write_parquet", "output_write_method_kwargs": {}, "output_filesystem": null, "output_filesystem_kwargs": {}, "output_write_episodes": true, "offline_sampling": false, "evaluation_interval": 1, "evaluation_duration": 20, "evaluation_duration_unit": "episodes", "evaluation_sample_timeout_s": 120.0, "evaluation_auto_duration_min_env_steps_per_sample": 100, "evaluation_auto_duration_max_env_steps_per_sample": 2000, "evaluation_parallel_to_training": false, "evaluation_force_reset_envs_before_iteration": true, "evaluation_config": null, "off_policy_estimation_methods": {}, "ope_split_batch_by_episode": true, "evaluation_num_env_runners": 1, "in_evaluation": false, "sync_filters_on_rollout_workers_timeout_s": 10.0, "offline_evaluation_interval": null, "num_offline_eval_runners": 0, "offline_loss_for_module_fn": null, "offline_evaluation_duration": 1, "offline_evaluation_parallel_to_training": false, "offline_evaluation_timeout_s": 120.0, "num_cpus_per_offline_eval_runner": 1, "num_gpus_per_offline_eval_runner": 0, "custom_resources_per_offline_eval_runner": {}, "restart_failed_offline_eval_runners": true, "ignore_offline_eval_runner_failures": false, "max_num_offline_eval_runner_restarts": 1000, "offline_eval_runner_restore_timeout_s": 1800.0, "max_requests_in_flight_per_offline_eval_runner": 1, "validate_offline_eval_runners_after_construction": true, "offline_eval_runner_health_probe_timeout_s": 30.0, "offline_eval_rl_module_inference_only": false, "broadcast_offline_eval_runner_states": false, "offline_eval_batch_size_per_runner": 256, "dataset_num_iters_per_eval_runner": 1, "keep_per_episode_custom_metrics": false, "metrics_episode_collection_timeout_s": 60.0, "metrics_num_episodes_for_smoothing": 100, "min_time_s_per_iteration": null, "min_train_timesteps_per_iteration": 0, "min_sample_timesteps_per_iteration": 0, "log_gradients": true, "export_native_model_files": false, "checkpoint_trainable_policies_only": false, "logger_creator": null, "logger_config": null, "log_level": "WARN", "log_sys_usage": true, "fake_sampler": false, "seed": 7, "restart_failed_env_runners": true, "ignore_env_runner_failures": false, "max_num_env_runner_restarts": 1000, "delay_between_env_runner_restarts_s": 60.0, "restart_failed_sub_environments": false, "num_consecutive_env_runner_failures_tolerance": 100, "env_runner_health_probe_timeout_s": 30.0, "env_runner_restore_timeout_s": 1800.0, "_model_config": {}, "_rl_module_spec": "RLModuleSpec(module_class=None, observation_space=None, action_space=None, inference_only=False, learner_only=False, model_config=DefaultModelConfig(fcnet_hiddens=[60, 90], fcnet_activation='tanh', fcnet_kernel_initializer=None, fcnet_kernel_initializer_kwargs=None, fcnet_bias_initializer=None, fcnet_bias_initializer_kwargs=None, conv_filters=None, conv_activation='relu', conv_kernel_initializer=None, conv_kernel_initializer_kwargs=None, conv_bias_initializer=None, conv_bias_initializer_kwargs=None, head_fcnet_hiddens=[], head_fcnet_activation='relu', head_fcnet_kernel_initializer=None, head_fcnet_kernel_initializer_kwargs=None, head_fcnet_bias_initializer=None, head_fcnet_bias_initializer_kwargs=None, free_log_std=False, log_std_clip_param=20.0, vf_share_layers=True, use_lstm=False, max_seq_len=20, lstm_cell_size=256, lstm_use_prev_action=False, lstm_use_prev_reward=False, lstm_kernel_initializer=None, lstm_kernel_initializer_kwargs=None, lstm_bias_initializer=None, lstm_bias_initializer_kwargs=None), catalog_class=None, load_state_path=None, model_config_dict=None)", "algorithm_config_overrides_per_module": {}, "_per_module_overrides": {}, "_validate_config": true, "_use_msgpack_checkpoints": false, "_torch_grad_scaler_class": null, "_torch_lr_scheduler_classes": null, "_tf_policy_handles_more_than_one_loss": false, "_disable_preprocessor_api": false, "_disable_action_flattening": false, "_disable_initialize_loss_from_dummy_batch": false, "_dont_auto_sync_env_runner_states": false, "env_task_fn": -1, "enable_connectors": -1, "simple_optimizer": false, "policy_map_cache": -1, "worker_cls": -1, "synchronize_filters": -1, "enable_async_evaluation": -1, "custom_async_evaluation_function": -1, "_enable_rl_module_api": -1, "auto_wrap_old_gym_envs": -1, "always_attach_evaluation_results": -1, "replay_sequence_length": null, "_disable_execution_plan_api": -1, "use_critic": true, "use_gae": true, "use_kl_loss": true, "kl_coeff": 0.7464963036515, "kl_target": 0.0270990929592, "vf_loss_coeff": 0.6688075857018, "entropy_coeff": 0.0090570820258, "clip_param": 0.1221781641624, "vf_clip_param": 0.1027808522125, "entropy_coeff_schedule": null, "lr_schedule": null, "sgd_minibatch_size": -1, "vf_share_layers": -1, "__stdout_file__": null, "__stderr_file__": null, "lambda": 0.9099046732075, "input": "sampler", "policies": {"default_policy": [null, null, null, null]}, "callbacks": "<class 'ray.rllib.callbacks.callbacks.RLlibCallback'>", "create_env_on_driver": false, "custom_eval_function": null, "framework": "torch"}, "time_since_restore": 49.817540407180786, "iterations_since_restore": 17, "perf": {"cpu_util_percent": 73.02, "ram_util_percent": 79.5}}
{"timers": {"training_iteration": 3.3091212226210915, "restore_env_runners": 2.751357614854749e-05, "training_step": 3.3088529822493595, "env_runner_sampling_timer": 3.147124813662086, "learner_update_timer": 0.15603448400497802, "synch_weights": 0.001298404263258396, "restore_eval_env_runners": 1.1762912078800156e-05, "evaluation_iteration": 0.20384498193413486, "synch_eval_env_connectors": 0.00016806693201662474, "synch_env_connectors": 5.7278134727382055e-06}, "env_runners": {"module_to_env_connector": {"timers": {"connectors": {"tensor_to_numpy": 2.3292147341367656e-05, "listify_data_for_vector_env": 1.8806158217497073e-05, "remove_single_ts_time_rank_from_batch": 9.517865323097158e-07, "get_actions": 7.680417334926046e-05, "normalize_and_clip_actions": 1.556702299666488e-05, "un_batch_to_individual_items": 8.468398897132308e-06}}, "connector_pipeline_timer": 0.00018438894747090136}, "time_between_sampling": 0.0023133968237306667, "num_env_steps_sampled_lifetime": -9870000.0, "env_to_module_connector": {"timers": {"connectors": {"add_observations_from_episodes_to_batch": 4.845901307857304e-06, "add_time_dim_to_batch_and_zero_pad": 4.060738646409481e-06, "batch_individual_items": 1.1305393115156285e-05, "numpy_to_tensor": 1.576549517337722e-05, "add_states_from_episodes_to_batch": 2.5142041003715506e-06}}, "connector_pipeline_timer": 7.093387243149926e-05}, "num_module_steps_sampled_lifetime": {"default_policy": -9870000.0}, "episode_return_min": -9.5, "weights_seq_no": 17.0, "num_episodes": 250.0, "env_reset_timer": 7.467604864715324e-05, "env_to_module_sum_episodes_length_out": 10.36823839457432, "num_env_steps_sampled": 5000.0, "env_step_timer": 2.4841621919285773e-05, "episode_return_mean": 6.980000000000003, "episode_return_max": 10.5, "episode_len_min": 20, "num_agent_steps_sampled_lifetime": {"default_agent": -9870000.0}, "rlmodule_inference_timer": 5.1470863452796215e-05, "module_episode_returns_mean": {"default_policy": 6.980000000000003}, "agent_episode_returns_mean": {"default_agent": 6.980000000000003}, "num_episodes_lifetime": -493500.0, "num_module_steps_sampled": {"default_policy": 5000.0}, "num_agent_steps_sampled": {"default_agent": 5000.0}, "episode_duration_sec_mean": 0.007937158687505871, "env_to_module_sum_episodes_length_in": 10.36823839457432, "episode_len_max": 20, "episode_len_mean": 20.0, "sample": 0.008602662421848609, "num_env_steps_sampled_lifetime_throughput": 2380.1645206716976}, "learners": {"__all_modules__": {"learner_connector": {"timers": {"connectors": {"numpy_to_tensor": 8.038562062962007e-05, "add_states_from_episodes_to_batch": 4.809276443105521e-06, "add_one_ts_to_episodes_and_truncate": 0.01367970141936264, "general_advantage_estimation": 0.008847110242456635, "batch_individual_items": 0.05077237170341774, "add_columns_from_episodes_to_train_batch": 0.04906347389311305, "add_observations_from_episodes_to_batch": 0.0010768440044759116, "add_time_dim_to_batch_and_zero_pad": 1.3521729744712078e-05}}, "connector_pipeline_timer": 0.12375051729159244}, "num_module_steps_trained_lifetime": 108000, "num_module_steps_trained": 6000, "num_env_steps_trained": 31500, "learner_connector_sum_episodes_length_out": 5250.0, "learner_connector_sum_episodes_length_in": 5000.0, "num_env_steps_trained_lifetime": 567000, "num_trainable_parameters": 6003, "num_non_trainable_parameters": 0, "num_env_steps_trained_lifetime_throughput": 1620454.5334421878, "num_module_steps_trained_throughput": 309455.42740524205, "num_module_steps_trained_lifetime_throughput": 309158.11568180716}, "default_policy": {"module_train_batch_size_mean": 1000.0, "total_loss": 0.06610782444477081, "vf_explained_var": -0.009521961212158203, "mean_kl_loss": 2.4402635972364806e-05, "num_module_steps_trained_lifetime": 108000, "num_module_steps_trained": 6000, "weights_seq_no": 18.0, "diff_num_grad_updates_vs_sampler_policy": 1.0, "vf_loss": 0.10278083384037018, "curr_kl_coeff": 2.847657469828846e-06, "curr_entropy_coeff": 0.0090570820258, "vf_loss_unclipped": 28.1092586517334, "default_optimizer_learning_rate": 0.0002847858517, "num_trainable_parameters": 6003, "entropy": 0.5365307331085205, "gradients_default_optimizer_global_norm": 0.08836914598941803, "policy_loss": 0.00222662091255188, "num_module_steps_trained_lifetime_throughput": 309664.5521606605}}, "num_training_step_calls_per_iteration": 1, "evaluation": {"env_runners": {"agent_episode_returns_mean": {"default_agent": -0.15}, "episode_len_mean": 20.0, "sample": 0.20079741802637963, "num_env_steps_sampled_lifetime": 90400, "env_reset_timer": 0.0001429617930527742, "env_step_timer": 8.902087647723679e-05, "rlmodule_inference_timer": 0.0003992056036623918, "module_to_env_connector": {"timers": {"connectors": {"remove_single_ts_time_rank_from_batch": 1.2646662477973745e-05, "normalize_and_clip_actions": 9.050844080875175e-05, "tensor_to_numpy": 9.978151668171052e-05, "listify_data_for_vector_env": 9.801025975755122e-05, "un_batch_to_individual_items": 4.0994918432057255e-05, "get_actions": 0.00029725768478097784}}, "connector_pipeline_timer": 0.0007648158960547269}, "env_to_module_sum_episodes_length_in": 10.368238394574323, "num_agent_steps_sampled": {"default_agent": 400}, "env_to_module_sum_episodes_length_out": 10.368238394574323, "episode_return_mean": -0.15, "episode_len_min": 20, "episode_duration_sec_mean": 0.012221716272179037, "num_module_steps_sampled": {"default_policy": 400}, "env_to_module_connector": {"timers": {"connectors": {"batch_individual_items": 2.8056385365644662e-05, "add_observations_from_episodes_to_batch": 1.2076485245925382e-05, "add_time_dim_to_batch_and_zero_pad": 1.528496387382419e-05, "numpy_to_tensor": 0.0003895520646198285, "add_states_from_episodes_to_batch": 6.369189147170208e-06}}, "connector_pipeline_timer": 0.000709241061671274}, "episode_return_min": -12.5, "num_module_steps_sampled_lifetime": {"default_policy": 7200}, "weights_seq_no": 18.0, "num_episodes": 20, "num_episodes_lifetime": 360, "episode_len_max": 20, "num_env_steps_sampled": 400, "episode_return_max": 14.5, "num_agent_steps_sampled_lifetime": {"default_agent": 7200}, "module_episode_returns_mean": {"default_policy": -0.15}, "time_between_sampling": 2.672142784618588}, "num_healthy_workers": 1, "actor_manager_num_outstanding_async_reqs": 0, "num_remote_worker_restarts": 0}, "num_env_steps_sampled_lifetime": -9870000.0, "fault_tolerance": {"num_healthy_workers": 0, "num_remote_worker_restarts": 0}, "env_runner_group": {"actor_manager_num_outstanding_async_reqs": 0}, "done": false, "training_iteration": 18, "trial_id": "497dd_00000", "date": "2025-08-11_19-33-54", "timestamp": 1754933634, "time_this_iter_s": 3.350728988647461, "time_total_s": 53.16826939582825, "pid": 25863, "hostname": "Mac", "node_ip": "127.0.0.1", "config": {"exploration_config": {}, "extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "placement_strategy": "PACK", "num_gpus": 0, "_fake_gpus": false, "num_cpus_for_main_process": 2, "eager_tracing": true, "eager_max_retraces": 20, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "torch_compile_learner": false, "torch_compile_learner_what_to_compile": "forward_train", "torch_compile_learner_dynamo_backend": "aot_eager", "torch_compile_learner_dynamo_mode": null, "torch_compile_worker": false, "torch_compile_worker_dynamo_backend": "aot_eager", "torch_compile_worker_dynamo_mode": null, "torch_ddp_kwargs": {}, "torch_skip_nan_gradients": false, "env": "Umbrella", "env_config": {}, "observation_space": null, "action_space": null, "clip_rewards": null, "normalize_actions": true, "clip_actions": false, "_is_atari": null, "disable_env_checking": false, "render_env": false, "action_mask_key": "action_mask", "env_runner_cls": null, "num_env_runners": 0, "create_local_env_runner": true, "num_envs_per_env_runner": 1, "gym_env_vectorize_mode": "SYNC", "num_cpus_per_env_runner": 1, "num_gpus_per_env_runner": 0, "custom_resources_per_env_runner": {}, "validate_env_runners_after_construction": true, "episodes_to_numpy": true, "max_requests_in_flight_per_env_runner": 1, "sample_timeout_s": 60.0, "_env_to_module_connector": null, "add_default_connectors_to_env_to_module_pipeline": true, "_module_to_env_connector": null, "add_default_connectors_to_module_to_env_pipeline": true, "merge_env_runner_states": "training_only", "broadcast_env_runner_states": true, "episode_lookback_horizon": 1, "rollout_fragment_length": "auto", "batch_mode": "complete_episodes", "compress_observations": false, "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "enable_tf1_exec_eagerly": false, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "preprocessor_pref": "deepmind", "observation_filter": "NoFilter", "update_worker_filter_stats": true, "use_worker_filter_stats": true, "sampler_perf_stats_ema_coef": null, "_is_online": true, "num_learners": 0, "num_gpus_per_learner": 0, "num_cpus_per_learner": "auto", "num_aggregator_actors_per_learner": 0, "max_requests_in_flight_per_aggregator_actor": 3, "local_gpu_idx": 0, "max_requests_in_flight_per_learner": 3, "gamma": 1, "lr": 0.0002847858517, "grad_clip": 0.5, "grad_clip_by": "global_norm", "_train_batch_size_per_learner": 5000, "train_batch_size": 4000, "num_epochs": 1, "minibatch_size": 1000, "shuffle_batch_per_epoch": true, "model": {"fcnet_hiddens": [256, 256], "fcnet_activation": "tanh", "fcnet_weights_initializer": null, "fcnet_weights_initializer_config": null, "fcnet_bias_initializer": null, "fcnet_bias_initializer_config": null, "conv_filters": null, "conv_activation": "relu", "conv_kernel_initializer": null, "conv_kernel_initializer_config": null, "conv_bias_initializer": null, "conv_bias_initializer_config": null, "conv_transpose_kernel_initializer": null, "conv_transpose_kernel_initializer_config": null, "conv_transpose_bias_initializer": null, "conv_transpose_bias_initializer_config": null, "post_fcnet_hiddens": [], "post_fcnet_activation": "relu", "post_fcnet_weights_initializer": null, "post_fcnet_weights_initializer_config": null, "post_fcnet_bias_initializer": null, "post_fcnet_bias_initializer_config": null, "free_log_std": false, "log_std_clip_param": 20.0, "no_final_linear": false, "vf_share_layers": false, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "lstm_weights_initializer": null, "lstm_weights_initializer_config": null, "lstm_bias_initializer": null, "lstm_bias_initializer_config": null, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "attention_use_n_prev_actions": 0, "attention_use_n_prev_rewards": 0, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": null, "custom_model_config": {}, "custom_action_dist": null, "custom_preprocessor": null, "encoder_latent_dim": null, "always_check_shapes": false, "lstm_use_prev_action_reward": -1, "_use_default_native_models": -1, "_disable_preprocessor_api": false, "_disable_action_flattening": false}, "_learner_connector": null, "add_default_connectors_to_learner_pipeline": true, "learner_config_dict": {}, "optimizer": {}, "_learner_class": null, "callbacks_on_algorithm_init": null, "callbacks_on_env_runners_recreated": null, "callbacks_on_offline_eval_runners_recreated": null, "callbacks_on_checkpoint_loaded": null, "callbacks_on_environment_created": null, "callbacks_on_episode_created": null, "callbacks_on_episode_start": null, "callbacks_on_episode_step": null, "callbacks_on_episode_end": null, "callbacks_on_evaluate_start": null, "callbacks_on_evaluate_end": null, "callbacks_on_evaluate_offline_start": null, "callbacks_on_evaluate_offline_end": null, "callbacks_on_sample_end": null, "callbacks_on_train_result": null, "explore": true, "enable_rl_module_and_learner": true, "enable_env_runner_and_connector_v2": true, "_prior_exploration_config": {"type": "StochasticSampling"}, "count_steps_by": "env_steps", "policy_map_capacity": 100, "policy_mapping_fn": "<function AlgorithmConfig.DEFAULT_POLICY_MAPPING_FN at 0x14ff39b20>", "policies_to_train": null, "policy_states_are_swappable": false, "observation_fn": null, "offline_data_class": null, "input_read_method": "read_parquet", "input_read_method_kwargs": {}, "input_read_schema": {}, "input_read_episodes": false, "input_read_sample_batches": false, "input_read_batch_size": null, "input_filesystem": null, "input_filesystem_kwargs": {}, "input_compress_columns": ["obs", "new_obs"], "input_spaces_jsonable": true, "materialize_data": false, "materialize_mapped_data": true, "map_batches_kwargs": {}, "iter_batches_kwargs": {}, "ignore_final_observation": false, "prelearner_class": null, "prelearner_buffer_class": null, "prelearner_buffer_kwargs": {}, "prelearner_module_synch_period": 10, "dataset_num_iters_per_learner": null, "input_config": {}, "actions_in_input_normalized": false, "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_config": {}, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "output_max_rows_per_file": null, "output_write_remaining_data": false, "output_write_method": "write_parquet", "output_write_method_kwargs": {}, "output_filesystem": null, "output_filesystem_kwargs": {}, "output_write_episodes": true, "offline_sampling": false, "evaluation_interval": 1, "evaluation_duration": 20, "evaluation_duration_unit": "episodes", "evaluation_sample_timeout_s": 120.0, "evaluation_auto_duration_min_env_steps_per_sample": 100, "evaluation_auto_duration_max_env_steps_per_sample": 2000, "evaluation_parallel_to_training": false, "evaluation_force_reset_envs_before_iteration": true, "evaluation_config": null, "off_policy_estimation_methods": {}, "ope_split_batch_by_episode": true, "evaluation_num_env_runners": 1, "in_evaluation": false, "sync_filters_on_rollout_workers_timeout_s": 10.0, "offline_evaluation_interval": null, "num_offline_eval_runners": 0, "offline_loss_for_module_fn": null, "offline_evaluation_duration": 1, "offline_evaluation_parallel_to_training": false, "offline_evaluation_timeout_s": 120.0, "num_cpus_per_offline_eval_runner": 1, "num_gpus_per_offline_eval_runner": 0, "custom_resources_per_offline_eval_runner": {}, "restart_failed_offline_eval_runners": true, "ignore_offline_eval_runner_failures": false, "max_num_offline_eval_runner_restarts": 1000, "offline_eval_runner_restore_timeout_s": 1800.0, "max_requests_in_flight_per_offline_eval_runner": 1, "validate_offline_eval_runners_after_construction": true, "offline_eval_runner_health_probe_timeout_s": 30.0, "offline_eval_rl_module_inference_only": false, "broadcast_offline_eval_runner_states": false, "offline_eval_batch_size_per_runner": 256, "dataset_num_iters_per_eval_runner": 1, "keep_per_episode_custom_metrics": false, "metrics_episode_collection_timeout_s": 60.0, "metrics_num_episodes_for_smoothing": 100, "min_time_s_per_iteration": null, "min_train_timesteps_per_iteration": 0, "min_sample_timesteps_per_iteration": 0, "log_gradients": true, "export_native_model_files": false, "checkpoint_trainable_policies_only": false, "logger_creator": null, "logger_config": null, "log_level": "WARN", "log_sys_usage": true, "fake_sampler": false, "seed": 7, "restart_failed_env_runners": true, "ignore_env_runner_failures": false, "max_num_env_runner_restarts": 1000, "delay_between_env_runner_restarts_s": 60.0, "restart_failed_sub_environments": false, "num_consecutive_env_runner_failures_tolerance": 100, "env_runner_health_probe_timeout_s": 30.0, "env_runner_restore_timeout_s": 1800.0, "_model_config": {}, "_rl_module_spec": "RLModuleSpec(module_class=None, observation_space=None, action_space=None, inference_only=False, learner_only=False, model_config=DefaultModelConfig(fcnet_hiddens=[60, 90], fcnet_activation='tanh', fcnet_kernel_initializer=None, fcnet_kernel_initializer_kwargs=None, fcnet_bias_initializer=None, fcnet_bias_initializer_kwargs=None, conv_filters=None, conv_activation='relu', conv_kernel_initializer=None, conv_kernel_initializer_kwargs=None, conv_bias_initializer=None, conv_bias_initializer_kwargs=None, head_fcnet_hiddens=[], head_fcnet_activation='relu', head_fcnet_kernel_initializer=None, head_fcnet_kernel_initializer_kwargs=None, head_fcnet_bias_initializer=None, head_fcnet_bias_initializer_kwargs=None, free_log_std=False, log_std_clip_param=20.0, vf_share_layers=True, use_lstm=False, max_seq_len=20, lstm_cell_size=256, lstm_use_prev_action=False, lstm_use_prev_reward=False, lstm_kernel_initializer=None, lstm_kernel_initializer_kwargs=None, lstm_bias_initializer=None, lstm_bias_initializer_kwargs=None), catalog_class=None, load_state_path=None, model_config_dict=None)", "algorithm_config_overrides_per_module": {}, "_per_module_overrides": {}, "_validate_config": true, "_use_msgpack_checkpoints": false, "_torch_grad_scaler_class": null, "_torch_lr_scheduler_classes": null, "_tf_policy_handles_more_than_one_loss": false, "_disable_preprocessor_api": false, "_disable_action_flattening": false, "_disable_initialize_loss_from_dummy_batch": false, "_dont_auto_sync_env_runner_states": false, "env_task_fn": -1, "enable_connectors": -1, "simple_optimizer": false, "policy_map_cache": -1, "worker_cls": -1, "synchronize_filters": -1, "enable_async_evaluation": -1, "custom_async_evaluation_function": -1, "_enable_rl_module_api": -1, "auto_wrap_old_gym_envs": -1, "always_attach_evaluation_results": -1, "replay_sequence_length": null, "_disable_execution_plan_api": -1, "use_critic": true, "use_gae": true, "use_kl_loss": true, "kl_coeff": 0.7464963036515, "kl_target": 0.0270990929592, "vf_loss_coeff": 0.6688075857018, "entropy_coeff": 0.0090570820258, "clip_param": 0.1221781641624, "vf_clip_param": 0.1027808522125, "entropy_coeff_schedule": null, "lr_schedule": null, "sgd_minibatch_size": -1, "vf_share_layers": -1, "__stdout_file__": null, "__stderr_file__": null, "lambda": 0.9099046732075, "input": "sampler", "policies": {"default_policy": [null, null, null, null]}, "callbacks": "<class 'ray.rllib.callbacks.callbacks.RLlibCallback'>", "create_env_on_driver": false, "custom_eval_function": null, "framework": "torch"}, "time_since_restore": 53.16826939582825, "iterations_since_restore": 18, "perf": {"cpu_util_percent": 72.5, "ram_util_percent": 79.475}}
{"timers": {"training_iteration": 3.3109804158158487, "restore_env_runners": 2.763677054468471e-05, "training_step": 3.310705876596676, "env_runner_sampling_timer": 3.1458918234456017, "learner_update_timer": 0.15910582124514494, "synch_weights": 0.0012948960506368816, "restore_eval_env_runners": 1.1720283529099156e-05, "evaluation_iteration": 0.20870848044455328, "synch_eval_env_connectors": 0.00016858501284964245, "synch_env_connectors": 6.760535488736069e-06}, "env_runners": {"module_to_env_connector": {"timers": {"connectors": {"tensor_to_numpy": 2.8520821477586626e-05, "listify_data_for_vector_env": 2.248078858168863e-05, "remove_single_ts_time_rank_from_batch": 1.1196759443429457e-06, "get_actions": 0.00010200853736188412, "normalize_and_clip_actions": 1.912964679412672e-05, "un_batch_to_individual_items": 1.0529715644734328e-05}}, "connector_pipeline_timer": 0.0002318072631304642}, "time_between_sampling": 0.00501978255685734, "num_env_steps_sampled_lifetime": -10487500.0, "env_to_module_connector": {"timers": {"connectors": {"add_observations_from_episodes_to_batch": 6.183460607127601e-06, "add_time_dim_to_batch_and_zero_pad": 5.1928456552155154e-06, "batch_individual_items": 1.3824735225637604e-05, "numpy_to_tensor": 2.4318128772220348e-05, "add_states_from_episodes_to_batch": 4.146174413701593e-06}}, "connector_pipeline_timer": 9.209260523127089e-05}, "num_module_steps_sampled_lifetime": {"default_policy": -10487500.0}, "episode_return_min": -9.5, "weights_seq_no": 18.0, "num_episodes": 250.0, "env_reset_timer": 8.646318557745536e-05, "env_to_module_sum_episodes_length_out": 10.36823839457432, "num_env_steps_sampled": 5000.0, "env_step_timer": 3.339185572459938e-05, "episode_return_mean": 7.2200000000000015, "episode_return_max": 10.5, "episode_len_min": 20, "num_agent_steps_sampled_lifetime": {"default_agent": -10487500.0}, "rlmodule_inference_timer": 6.673135701336507e-05, "module_episode_returns_mean": {"default_policy": 7.2200000000000015}, "agent_episode_returns_mean": {"default_agent": 7.2200000000000015}, "num_episodes_lifetime": -524375.0, "num_module_steps_sampled": {"default_policy": 5000.0}, "num_agent_steps_sampled": {"default_agent": 5000.0}, "episode_duration_sec_mean": 0.010235713328234853, "env_to_module_sum_episodes_length_in": 10.36823839457432, "episode_len_max": 20, "episode_len_mean": 20.0, "sample": 0.00962514388313943, "num_env_steps_sampled_lifetime_throughput": 2118.9438474711046}, "learners": {"__all_modules__": {"learner_connector": {"timers": {"connectors": {"numpy_to_tensor": 8.17580138231051e-05, "add_states_from_episodes_to_batch": 4.809933758842713e-06, "add_one_ts_to_episodes_and_truncate": 0.013676391904720862, "general_advantage_estimation": 0.0088887670598699, "batch_individual_items": 0.053762668826726645, "add_columns_from_episodes_to_train_batch": 0.04911020540424615, "add_observations_from_episodes_to_batch": 0.001076085154036186, "add_time_dim_to_batch_and_zero_pad": 1.3611103214439917e-05}}, "connector_pipeline_timer": 0.12682686502793042}, "num_module_steps_trained_lifetime": 114000, "num_module_steps_trained": 6000, "num_env_steps_trained": 31500, "learner_connector_sum_episodes_length_out": 5250.0, "learner_connector_sum_episodes_length_in": 5000.0, "num_env_steps_trained_lifetime": 598500, "num_trainable_parameters": 6003, "num_non_trainable_parameters": 0, "num_env_steps_trained_lifetime_throughput": 1614951.042507939, "num_module_steps_trained_throughput": 308357.07272868545, "num_module_steps_trained_lifetime_throughput": 308081.0749362915}, "default_policy": {"module_train_batch_size_mean": 1000.0, "total_loss": -0.04619554802775383, "vf_explained_var": -0.008934259414672852, "mean_kl_loss": 2.036566183960531e-05, "num_module_steps_trained_lifetime": 114000, "num_module_steps_trained": 6000, "weights_seq_no": 19.0, "diff_num_grad_updates_vs_sampler_policy": 1.0, "vf_loss": 0.10278083384037018, "curr_kl_coeff": 1.423828734914423e-06, "curr_entropy_coeff": 0.0090570820258, "vf_loss_unclipped": 27.963809967041016, "default_optimizer_learning_rate": 0.0002847858517, "num_trainable_parameters": 6003, "entropy": 0.5288645625114441, "gradients_default_optimizer_global_norm": 0.020102325826883316, "policy_loss": -0.1101461872458458, "num_module_steps_trained_lifetime_throughput": 308529.65652578656}}, "num_training_step_calls_per_iteration": 1, "evaluation": {"env_runners": {"agent_episode_returns_mean": {"default_agent": -0.35}, "episode_len_mean": 20.0, "sample": 0.20008726426612025, "num_env_steps_sampled_lifetime": 95400, "env_reset_timer": 0.00014305050565902922, "env_step_timer": 1.851569712181149e-05, "rlmodule_inference_timer": 3.8122907267926916e-05, "module_to_env_connector": {"timers": {"connectors": {"remove_single_ts_time_rank_from_batch": 8.236781060116607e-07, "normalize_and_clip_actions": 1.2243386826703183e-05, "tensor_to_numpy": 1.7212065529223473e-05, "listify_data_for_vector_env": 1.3990530249463978e-05, "un_batch_to_individual_items": 7.047998363480365e-06, "get_actions": 4.805339343165101e-05}}, "connector_pipeline_timer": 0.00012967364627554322}, "env_to_module_sum_episodes_length_in": 10.368238394574323, "num_agent_steps_sampled": {"default_agent": 400}, "env_to_module_sum_episodes_length_out": 10.368238394574323, "episode_return_mean": -0.35, "episode_len_min": 20, "episode_duration_sec_mean": 0.012008330018725246, "num_module_steps_sampled": {"default_policy": 400}, "env_to_module_connector": {"timers": {"connectors": {"batch_individual_items": 7.816806466118927e-06, "add_observations_from_episodes_to_batch": 3.3058327516943837e-06, "add_time_dim_to_batch_and_zero_pad": 2.72779214105261e-06, "numpy_to_tensor": 1.5930142428071363e-05, "add_states_from_episodes_to_batch": 1.947500095388499e-06}}, "connector_pipeline_timer": 5.890720115026776e-05}, "episode_return_min": -12.5, "num_module_steps_sampled_lifetime": {"default_policy": 7600}, "weights_seq_no": 19.0, "num_episodes": 20, "num_episodes_lifetime": 380, "episode_len_max": 20, "num_env_steps_sampled": 400, "episode_return_max": 14.5, "num_agent_steps_sampled_lifetime": {"default_agent": 7600}, "module_episode_returns_mean": {"default_policy": -0.35}, "time_between_sampling": 2.681481095522739}, "num_healthy_workers": 1, "actor_manager_num_outstanding_async_reqs": 0, "num_remote_worker_restarts": 0}, "num_env_steps_sampled_lifetime": -10487500.0, "fault_tolerance": {"num_healthy_workers": 0, "num_remote_worker_restarts": 0}, "env_runner_group": {"actor_manager_num_outstanding_async_reqs": 0}, "done": false, "training_iteration": 19, "trial_id": "497dd_00000", "date": "2025-08-11_19-33-58", "timestamp": 1754933638, "time_this_iter_s": 3.6385810375213623, "time_total_s": 56.80685043334961, "pid": 25863, "hostname": "Mac", "node_ip": "127.0.0.1", "config": {"exploration_config": {}, "extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "placement_strategy": "PACK", "num_gpus": 0, "_fake_gpus": false, "num_cpus_for_main_process": 2, "eager_tracing": true, "eager_max_retraces": 20, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "torch_compile_learner": false, "torch_compile_learner_what_to_compile": "forward_train", "torch_compile_learner_dynamo_backend": "aot_eager", "torch_compile_learner_dynamo_mode": null, "torch_compile_worker": false, "torch_compile_worker_dynamo_backend": "aot_eager", "torch_compile_worker_dynamo_mode": null, "torch_ddp_kwargs": {}, "torch_skip_nan_gradients": false, "env": "Umbrella", "env_config": {}, "observation_space": null, "action_space": null, "clip_rewards": null, "normalize_actions": true, "clip_actions": false, "_is_atari": null, "disable_env_checking": false, "render_env": false, "action_mask_key": "action_mask", "env_runner_cls": null, "num_env_runners": 0, "create_local_env_runner": true, "num_envs_per_env_runner": 1, "gym_env_vectorize_mode": "SYNC", "num_cpus_per_env_runner": 1, "num_gpus_per_env_runner": 0, "custom_resources_per_env_runner": {}, "validate_env_runners_after_construction": true, "episodes_to_numpy": true, "max_requests_in_flight_per_env_runner": 1, "sample_timeout_s": 60.0, "_env_to_module_connector": null, "add_default_connectors_to_env_to_module_pipeline": true, "_module_to_env_connector": null, "add_default_connectors_to_module_to_env_pipeline": true, "merge_env_runner_states": "training_only", "broadcast_env_runner_states": true, "episode_lookback_horizon": 1, "rollout_fragment_length": "auto", "batch_mode": "complete_episodes", "compress_observations": false, "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "enable_tf1_exec_eagerly": false, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "preprocessor_pref": "deepmind", "observation_filter": "NoFilter", "update_worker_filter_stats": true, "use_worker_filter_stats": true, "sampler_perf_stats_ema_coef": null, "_is_online": true, "num_learners": 0, "num_gpus_per_learner": 0, "num_cpus_per_learner": "auto", "num_aggregator_actors_per_learner": 0, "max_requests_in_flight_per_aggregator_actor": 3, "local_gpu_idx": 0, "max_requests_in_flight_per_learner": 3, "gamma": 1, "lr": 0.0002847858517, "grad_clip": 0.5, "grad_clip_by": "global_norm", "_train_batch_size_per_learner": 5000, "train_batch_size": 4000, "num_epochs": 1, "minibatch_size": 1000, "shuffle_batch_per_epoch": true, "model": {"fcnet_hiddens": [256, 256], "fcnet_activation": "tanh", "fcnet_weights_initializer": null, "fcnet_weights_initializer_config": null, "fcnet_bias_initializer": null, "fcnet_bias_initializer_config": null, "conv_filters": null, "conv_activation": "relu", "conv_kernel_initializer": null, "conv_kernel_initializer_config": null, "conv_bias_initializer": null, "conv_bias_initializer_config": null, "conv_transpose_kernel_initializer": null, "conv_transpose_kernel_initializer_config": null, "conv_transpose_bias_initializer": null, "conv_transpose_bias_initializer_config": null, "post_fcnet_hiddens": [], "post_fcnet_activation": "relu", "post_fcnet_weights_initializer": null, "post_fcnet_weights_initializer_config": null, "post_fcnet_bias_initializer": null, "post_fcnet_bias_initializer_config": null, "free_log_std": false, "log_std_clip_param": 20.0, "no_final_linear": false, "vf_share_layers": false, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "lstm_weights_initializer": null, "lstm_weights_initializer_config": null, "lstm_bias_initializer": null, "lstm_bias_initializer_config": null, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "attention_use_n_prev_actions": 0, "attention_use_n_prev_rewards": 0, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": null, "custom_model_config": {}, "custom_action_dist": null, "custom_preprocessor": null, "encoder_latent_dim": null, "always_check_shapes": false, "lstm_use_prev_action_reward": -1, "_use_default_native_models": -1, "_disable_preprocessor_api": false, "_disable_action_flattening": false}, "_learner_connector": null, "add_default_connectors_to_learner_pipeline": true, "learner_config_dict": {}, "optimizer": {}, "_learner_class": null, "callbacks_on_algorithm_init": null, "callbacks_on_env_runners_recreated": null, "callbacks_on_offline_eval_runners_recreated": null, "callbacks_on_checkpoint_loaded": null, "callbacks_on_environment_created": null, "callbacks_on_episode_created": null, "callbacks_on_episode_start": null, "callbacks_on_episode_step": null, "callbacks_on_episode_end": null, "callbacks_on_evaluate_start": null, "callbacks_on_evaluate_end": null, "callbacks_on_evaluate_offline_start": null, "callbacks_on_evaluate_offline_end": null, "callbacks_on_sample_end": null, "callbacks_on_train_result": null, "explore": true, "enable_rl_module_and_learner": true, "enable_env_runner_and_connector_v2": true, "_prior_exploration_config": {"type": "StochasticSampling"}, "count_steps_by": "env_steps", "policy_map_capacity": 100, "policy_mapping_fn": "<function AlgorithmConfig.DEFAULT_POLICY_MAPPING_FN at 0x14ff39b20>", "policies_to_train": null, "policy_states_are_swappable": false, "observation_fn": null, "offline_data_class": null, "input_read_method": "read_parquet", "input_read_method_kwargs": {}, "input_read_schema": {}, "input_read_episodes": false, "input_read_sample_batches": false, "input_read_batch_size": null, "input_filesystem": null, "input_filesystem_kwargs": {}, "input_compress_columns": ["obs", "new_obs"], "input_spaces_jsonable": true, "materialize_data": false, "materialize_mapped_data": true, "map_batches_kwargs": {}, "iter_batches_kwargs": {}, "ignore_final_observation": false, "prelearner_class": null, "prelearner_buffer_class": null, "prelearner_buffer_kwargs": {}, "prelearner_module_synch_period": 10, "dataset_num_iters_per_learner": null, "input_config": {}, "actions_in_input_normalized": false, "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_config": {}, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "output_max_rows_per_file": null, "output_write_remaining_data": false, "output_write_method": "write_parquet", "output_write_method_kwargs": {}, "output_filesystem": null, "output_filesystem_kwargs": {}, "output_write_episodes": true, "offline_sampling": false, "evaluation_interval": 1, "evaluation_duration": 20, "evaluation_duration_unit": "episodes", "evaluation_sample_timeout_s": 120.0, "evaluation_auto_duration_min_env_steps_per_sample": 100, "evaluation_auto_duration_max_env_steps_per_sample": 2000, "evaluation_parallel_to_training": false, "evaluation_force_reset_envs_before_iteration": true, "evaluation_config": null, "off_policy_estimation_methods": {}, "ope_split_batch_by_episode": true, "evaluation_num_env_runners": 1, "in_evaluation": false, "sync_filters_on_rollout_workers_timeout_s": 10.0, "offline_evaluation_interval": null, "num_offline_eval_runners": 0, "offline_loss_for_module_fn": null, "offline_evaluation_duration": 1, "offline_evaluation_parallel_to_training": false, "offline_evaluation_timeout_s": 120.0, "num_cpus_per_offline_eval_runner": 1, "num_gpus_per_offline_eval_runner": 0, "custom_resources_per_offline_eval_runner": {}, "restart_failed_offline_eval_runners": true, "ignore_offline_eval_runner_failures": false, "max_num_offline_eval_runner_restarts": 1000, "offline_eval_runner_restore_timeout_s": 1800.0, "max_requests_in_flight_per_offline_eval_runner": 1, "validate_offline_eval_runners_after_construction": true, "offline_eval_runner_health_probe_timeout_s": 30.0, "offline_eval_rl_module_inference_only": false, "broadcast_offline_eval_runner_states": false, "offline_eval_batch_size_per_runner": 256, "dataset_num_iters_per_eval_runner": 1, "keep_per_episode_custom_metrics": false, "metrics_episode_collection_timeout_s": 60.0, "metrics_num_episodes_for_smoothing": 100, "min_time_s_per_iteration": null, "min_train_timesteps_per_iteration": 0, "min_sample_timesteps_per_iteration": 0, "log_gradients": true, "export_native_model_files": false, "checkpoint_trainable_policies_only": false, "logger_creator": null, "logger_config": null, "log_level": "WARN", "log_sys_usage": true, "fake_sampler": false, "seed": 7, "restart_failed_env_runners": true, "ignore_env_runner_failures": false, "max_num_env_runner_restarts": 1000, "delay_between_env_runner_restarts_s": 60.0, "restart_failed_sub_environments": false, "num_consecutive_env_runner_failures_tolerance": 100, "env_runner_health_probe_timeout_s": 30.0, "env_runner_restore_timeout_s": 1800.0, "_model_config": {}, "_rl_module_spec": "RLModuleSpec(module_class=None, observation_space=None, action_space=None, inference_only=False, learner_only=False, model_config=DefaultModelConfig(fcnet_hiddens=[60, 90], fcnet_activation='tanh', fcnet_kernel_initializer=None, fcnet_kernel_initializer_kwargs=None, fcnet_bias_initializer=None, fcnet_bias_initializer_kwargs=None, conv_filters=None, conv_activation='relu', conv_kernel_initializer=None, conv_kernel_initializer_kwargs=None, conv_bias_initializer=None, conv_bias_initializer_kwargs=None, head_fcnet_hiddens=[], head_fcnet_activation='relu', head_fcnet_kernel_initializer=None, head_fcnet_kernel_initializer_kwargs=None, head_fcnet_bias_initializer=None, head_fcnet_bias_initializer_kwargs=None, free_log_std=False, log_std_clip_param=20.0, vf_share_layers=True, use_lstm=False, max_seq_len=20, lstm_cell_size=256, lstm_use_prev_action=False, lstm_use_prev_reward=False, lstm_kernel_initializer=None, lstm_kernel_initializer_kwargs=None, lstm_bias_initializer=None, lstm_bias_initializer_kwargs=None), catalog_class=None, load_state_path=None, model_config_dict=None)", "algorithm_config_overrides_per_module": {}, "_per_module_overrides": {}, "_validate_config": true, "_use_msgpack_checkpoints": false, "_torch_grad_scaler_class": null, "_torch_lr_scheduler_classes": null, "_tf_policy_handles_more_than_one_loss": false, "_disable_preprocessor_api": false, "_disable_action_flattening": false, "_disable_initialize_loss_from_dummy_batch": false, "_dont_auto_sync_env_runner_states": false, "env_task_fn": -1, "enable_connectors": -1, "simple_optimizer": false, "policy_map_cache": -1, "worker_cls": -1, "synchronize_filters": -1, "enable_async_evaluation": -1, "custom_async_evaluation_function": -1, "_enable_rl_module_api": -1, "auto_wrap_old_gym_envs": -1, "always_attach_evaluation_results": -1, "replay_sequence_length": null, "_disable_execution_plan_api": -1, "use_critic": true, "use_gae": true, "use_kl_loss": true, "kl_coeff": 0.7464963036515, "kl_target": 0.0270990929592, "vf_loss_coeff": 0.6688075857018, "entropy_coeff": 0.0090570820258, "clip_param": 0.1221781641624, "vf_clip_param": 0.1027808522125, "entropy_coeff_schedule": null, "lr_schedule": null, "sgd_minibatch_size": -1, "vf_share_layers": -1, "__stdout_file__": null, "__stderr_file__": null, "lambda": 0.9099046732075, "input": "sampler", "policies": {"default_policy": [null, null, null, null]}, "callbacks": "<class 'ray.rllib.callbacks.callbacks.RLlibCallback'>", "create_env_on_driver": false, "custom_eval_function": null, "framework": "torch"}, "time_since_restore": 56.80685043334961, "iterations_since_restore": 19, "perf": {"cpu_util_percent": 80.71666666666668, "ram_util_percent": 80.85}}
{"timers": {"training_iteration": 3.3123648337377927, "restore_env_runners": 2.7428732812384185e-05, "training_step": 3.3120906795005216, "env_runner_sampling_timer": 3.147620180211528, "learner_update_timer": 0.1587762380327583, "synch_weights": 0.0012895774998033691, "restore_eval_env_runners": 1.1668081188750234e-05, "evaluation_iteration": 0.20801815064114978, "synch_eval_env_connectors": 0.00016931333360660462, "synch_env_connectors": 6.7312703559391905e-06}, "env_runners": {"module_to_env_connector": {"timers": {"connectors": {"tensor_to_numpy": 3.2437602335841945e-05, "listify_data_for_vector_env": 2.4988796470143465e-05, "remove_single_ts_time_rank_from_batch": 1.3949049954297892e-06, "get_actions": 0.00011518305908880359, "normalize_and_clip_actions": 2.092412192864843e-05, "un_batch_to_individual_items": 1.1898346267284677e-05}}, "connector_pipeline_timer": 0.0002611160714322479}, "time_between_sampling": 0.0038814380059485573, "num_env_steps_sampled_lifetime": -11105000.0, "env_to_module_connector": {"timers": {"connectors": {"add_observations_from_episodes_to_batch": 6.394454167670595e-06, "add_time_dim_to_batch_and_zero_pad": 5.653796888004908e-06, "batch_individual_items": 1.5648338959242815e-05, "numpy_to_tensor": 2.564145589172697e-05, "add_states_from_episodes_to_batch": 3.440636053115213e-06}}, "connector_pipeline_timer": 0.00010023289947017128}, "num_module_steps_sampled_lifetime": {"default_policy": -11105000.0}, "episode_return_min": -9.5, "weights_seq_no": 19.0, "num_episodes": 250.0, "env_reset_timer": 0.00010141063466580825, "env_to_module_sum_episodes_length_out": 10.36823839457432, "num_env_steps_sampled": 5000.0, "env_step_timer": 3.470828236050723e-05, "episode_return_mean": 6.980000000000003, "episode_return_max": 10.5, "episode_len_min": 20, "num_agent_steps_sampled_lifetime": {"default_agent": -11105000.0}, "rlmodule_inference_timer": 7.40804461061869e-05, "module_episode_returns_mean": {"default_policy": 6.980000000000003}, "agent_episode_returns_mean": {"default_agent": 6.980000000000003}, "num_episodes_lifetime": -555250.0, "num_module_steps_sampled": {"default_policy": 5000.0}, "num_agent_steps_sampled": {"default_agent": 5000.0}, "episode_duration_sec_mean": 0.011250400508288294, "env_to_module_sum_episodes_length_in": 10.36823839457432, "episode_len_max": 20, "episode_len_mean": 20.0, "sample": 0.011876349428755286, "num_env_steps_sampled_lifetime_throughput": 1814.5844919666786}, "learners": {"__all_modules__": {"learner_connector": {"timers": {"connectors": {"numpy_to_tensor": 8.179252399145411e-05, "add_states_from_episodes_to_batch": 4.794334086648711e-06, "add_one_ts_to_episodes_and_truncate": 0.01364786215556662, "general_advantage_estimation": 0.00887456021985604, "batch_individual_items": 0.053695857558144475, "add_columns_from_episodes_to_train_batch": 0.04899760169092772, "add_observations_from_episodes_to_batch": 0.0010802455523176062, "add_time_dim_to_batch_and_zero_pad": 1.358957279865046e-05}}, "connector_pipeline_timer": 0.12660840303839083}, "num_module_steps_trained_lifetime": 120000, "num_module_steps_trained": 6000, "num_env_steps_trained": 31500, "learner_connector_sum_episodes_length_out": 5250.0, "learner_connector_sum_episodes_length_in": 5000.0, "num_env_steps_trained_lifetime": 630000, "num_trainable_parameters": 6003, "num_non_trainable_parameters": 0, "num_env_steps_trained_lifetime_throughput": 1608807.8546723265, "num_module_steps_trained_throughput": 307145.85591524845, "num_module_steps_trained_lifetime_throughput": 306885.90637321194}, "default_policy": {"module_train_batch_size_mean": 1000.0, "total_loss": 0.06485634297132492, "vf_explained_var": -0.009521126747131348, "mean_kl_loss": 0.0004883734509348869, "num_module_steps_trained_lifetime": 120000, "num_module_steps_trained": 6000, "weights_seq_no": 20.0, "diff_num_grad_updates_vs_sampler_policy": 1.0, "vf_loss": 0.10278083384037018, "curr_kl_coeff": 7.119143674572115e-07, "curr_entropy_coeff": 0.0090570820258, "vf_loss_unclipped": 28.101835250854492, "default_optimizer_learning_rate": 0.0002847858517, "num_trainable_parameters": 6003, "entropy": 0.5163688063621521, "gradients_default_optimizer_global_norm": 0.08865606784820557, "policy_loss": 0.0007925351383164525, "num_module_steps_trained_lifetime_throughput": 307294.2229688015}}, "num_training_step_calls_per_iteration": 1, "evaluation": {"env_runners": {"agent_episode_returns_mean": {"default_agent": -0.95}, "episode_len_mean": 20.0, "sample": 0.19964534828332367, "num_env_steps_sampled_lifetime": 100400, "env_reset_timer": 0.00014391166997304548, "env_step_timer": 1.9269753783091766e-05, "rlmodule_inference_timer": 3.807032478026605e-05, "module_to_env_connector": {"timers": {"connectors": {"remove_single_ts_time_rank_from_batch": 7.597597653485774e-07, "normalize_and_clip_actions": 1.2340267219341991e-05, "tensor_to_numpy": 1.944048056845677e-05, "listify_data_for_vector_env": 1.4998732857417158e-05, "un_batch_to_individual_items": 7.389189132186049e-06, "get_actions": 6.542095055936545e-05}}, "connector_pipeline_timer": 0.0001533997495808329}, "env_to_module_sum_episodes_length_in": 10.368238394574323, "num_agent_steps_sampled": {"default_agent": 400}, "env_to_module_sum_episodes_length_out": 10.368238394574323, "episode_return_mean": -0.95, "episode_len_min": 20, "episode_duration_sec_mean": 0.011789240052457899, "num_module_steps_sampled": {"default_policy": 400}, "env_to_module_connector": {"timers": {"connectors": {"batch_individual_items": 8.09809332533676e-06, "add_observations_from_episodes_to_batch": 3.7731524175618702e-06, "add_time_dim_to_batch_and_zero_pad": 2.876933831955309e-06, "numpy_to_tensor": 1.1500571906136347e-05, "add_states_from_episodes_to_batch": 2.0441801290642484e-06}}, "connector_pipeline_timer": 5.456042464454951e-05}, "episode_return_min": -12.5, "num_module_steps_sampled_lifetime": {"default_policy": 8000}, "weights_seq_no": 20.0, "num_episodes": 20, "num_episodes_lifetime": 400, "episode_len_max": 20, "num_env_steps_sampled": 400, "episode_return_max": 14.5, "num_agent_steps_sampled_lifetime": {"default_agent": 8000}, "module_episode_returns_mean": {"default_policy": -0.95}, "time_between_sampling": 2.6894322016465693}, "num_healthy_workers": 1, "actor_manager_num_outstanding_async_reqs": 0, "num_remote_worker_restarts": 0}, "num_env_steps_sampled_lifetime": -11105000.0, "fault_tolerance": {"num_healthy_workers": 0, "num_remote_worker_restarts": 0}, "env_runner_group": {"actor_manager_num_outstanding_async_reqs": 0}, "done": true, "training_iteration": 20, "trial_id": "497dd_00000", "date": "2025-08-11_19-34-01", "timestamp": 1754933641, "time_this_iter_s": 3.6198208332061768, "time_total_s": 60.426671266555786, "pid": 25863, "hostname": "Mac", "node_ip": "127.0.0.1", "config": {"exploration_config": {}, "extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "placement_strategy": "PACK", "num_gpus": 0, "_fake_gpus": false, "num_cpus_for_main_process": 2, "eager_tracing": true, "eager_max_retraces": 20, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "torch_compile_learner": false, "torch_compile_learner_what_to_compile": "forward_train", "torch_compile_learner_dynamo_backend": "aot_eager", "torch_compile_learner_dynamo_mode": null, "torch_compile_worker": false, "torch_compile_worker_dynamo_backend": "aot_eager", "torch_compile_worker_dynamo_mode": null, "torch_ddp_kwargs": {}, "torch_skip_nan_gradients": false, "env": "Umbrella", "env_config": {}, "observation_space": null, "action_space": null, "clip_rewards": null, "normalize_actions": true, "clip_actions": false, "_is_atari": null, "disable_env_checking": false, "render_env": false, "action_mask_key": "action_mask", "env_runner_cls": null, "num_env_runners": 0, "create_local_env_runner": true, "num_envs_per_env_runner": 1, "gym_env_vectorize_mode": "SYNC", "num_cpus_per_env_runner": 1, "num_gpus_per_env_runner": 0, "custom_resources_per_env_runner": {}, "validate_env_runners_after_construction": true, "episodes_to_numpy": true, "max_requests_in_flight_per_env_runner": 1, "sample_timeout_s": 60.0, "_env_to_module_connector": null, "add_default_connectors_to_env_to_module_pipeline": true, "_module_to_env_connector": null, "add_default_connectors_to_module_to_env_pipeline": true, "merge_env_runner_states": "training_only", "broadcast_env_runner_states": true, "episode_lookback_horizon": 1, "rollout_fragment_length": "auto", "batch_mode": "complete_episodes", "compress_observations": false, "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "enable_tf1_exec_eagerly": false, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "preprocessor_pref": "deepmind", "observation_filter": "NoFilter", "update_worker_filter_stats": true, "use_worker_filter_stats": true, "sampler_perf_stats_ema_coef": null, "_is_online": true, "num_learners": 0, "num_gpus_per_learner": 0, "num_cpus_per_learner": "auto", "num_aggregator_actors_per_learner": 0, "max_requests_in_flight_per_aggregator_actor": 3, "local_gpu_idx": 0, "max_requests_in_flight_per_learner": 3, "gamma": 1, "lr": 0.0002847858517, "grad_clip": 0.5, "grad_clip_by": "global_norm", "_train_batch_size_per_learner": 5000, "train_batch_size": 4000, "num_epochs": 1, "minibatch_size": 1000, "shuffle_batch_per_epoch": true, "model": {"fcnet_hiddens": [256, 256], "fcnet_activation": "tanh", "fcnet_weights_initializer": null, "fcnet_weights_initializer_config": null, "fcnet_bias_initializer": null, "fcnet_bias_initializer_config": null, "conv_filters": null, "conv_activation": "relu", "conv_kernel_initializer": null, "conv_kernel_initializer_config": null, "conv_bias_initializer": null, "conv_bias_initializer_config": null, "conv_transpose_kernel_initializer": null, "conv_transpose_kernel_initializer_config": null, "conv_transpose_bias_initializer": null, "conv_transpose_bias_initializer_config": null, "post_fcnet_hiddens": [], "post_fcnet_activation": "relu", "post_fcnet_weights_initializer": null, "post_fcnet_weights_initializer_config": null, "post_fcnet_bias_initializer": null, "post_fcnet_bias_initializer_config": null, "free_log_std": false, "log_std_clip_param": 20.0, "no_final_linear": false, "vf_share_layers": false, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "lstm_weights_initializer": null, "lstm_weights_initializer_config": null, "lstm_bias_initializer": null, "lstm_bias_initializer_config": null, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "attention_use_n_prev_actions": 0, "attention_use_n_prev_rewards": 0, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": null, "custom_model_config": {}, "custom_action_dist": null, "custom_preprocessor": null, "encoder_latent_dim": null, "always_check_shapes": false, "lstm_use_prev_action_reward": -1, "_use_default_native_models": -1, "_disable_preprocessor_api": false, "_disable_action_flattening": false}, "_learner_connector": null, "add_default_connectors_to_learner_pipeline": true, "learner_config_dict": {}, "optimizer": {}, "_learner_class": null, "callbacks_on_algorithm_init": null, "callbacks_on_env_runners_recreated": null, "callbacks_on_offline_eval_runners_recreated": null, "callbacks_on_checkpoint_loaded": null, "callbacks_on_environment_created": null, "callbacks_on_episode_created": null, "callbacks_on_episode_start": null, "callbacks_on_episode_step": null, "callbacks_on_episode_end": null, "callbacks_on_evaluate_start": null, "callbacks_on_evaluate_end": null, "callbacks_on_evaluate_offline_start": null, "callbacks_on_evaluate_offline_end": null, "callbacks_on_sample_end": null, "callbacks_on_train_result": null, "explore": true, "enable_rl_module_and_learner": true, "enable_env_runner_and_connector_v2": true, "_prior_exploration_config": {"type": "StochasticSampling"}, "count_steps_by": "env_steps", "policy_map_capacity": 100, "policy_mapping_fn": "<function AlgorithmConfig.DEFAULT_POLICY_MAPPING_FN at 0x14ff39b20>", "policies_to_train": null, "policy_states_are_swappable": false, "observation_fn": null, "offline_data_class": null, "input_read_method": "read_parquet", "input_read_method_kwargs": {}, "input_read_schema": {}, "input_read_episodes": false, "input_read_sample_batches": false, "input_read_batch_size": null, "input_filesystem": null, "input_filesystem_kwargs": {}, "input_compress_columns": ["obs", "new_obs"], "input_spaces_jsonable": true, "materialize_data": false, "materialize_mapped_data": true, "map_batches_kwargs": {}, "iter_batches_kwargs": {}, "ignore_final_observation": false, "prelearner_class": null, "prelearner_buffer_class": null, "prelearner_buffer_kwargs": {}, "prelearner_module_synch_period": 10, "dataset_num_iters_per_learner": null, "input_config": {}, "actions_in_input_normalized": false, "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_config": {}, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "output_max_rows_per_file": null, "output_write_remaining_data": false, "output_write_method": "write_parquet", "output_write_method_kwargs": {}, "output_filesystem": null, "output_filesystem_kwargs": {}, "output_write_episodes": true, "offline_sampling": false, "evaluation_interval": 1, "evaluation_duration": 20, "evaluation_duration_unit": "episodes", "evaluation_sample_timeout_s": 120.0, "evaluation_auto_duration_min_env_steps_per_sample": 100, "evaluation_auto_duration_max_env_steps_per_sample": 2000, "evaluation_parallel_to_training": false, "evaluation_force_reset_envs_before_iteration": true, "evaluation_config": null, "off_policy_estimation_methods": {}, "ope_split_batch_by_episode": true, "evaluation_num_env_runners": 1, "in_evaluation": false, "sync_filters_on_rollout_workers_timeout_s": 10.0, "offline_evaluation_interval": null, "num_offline_eval_runners": 0, "offline_loss_for_module_fn": null, "offline_evaluation_duration": 1, "offline_evaluation_parallel_to_training": false, "offline_evaluation_timeout_s": 120.0, "num_cpus_per_offline_eval_runner": 1, "num_gpus_per_offline_eval_runner": 0, "custom_resources_per_offline_eval_runner": {}, "restart_failed_offline_eval_runners": true, "ignore_offline_eval_runner_failures": false, "max_num_offline_eval_runner_restarts": 1000, "offline_eval_runner_restore_timeout_s": 1800.0, "max_requests_in_flight_per_offline_eval_runner": 1, "validate_offline_eval_runners_after_construction": true, "offline_eval_runner_health_probe_timeout_s": 30.0, "offline_eval_rl_module_inference_only": false, "broadcast_offline_eval_runner_states": false, "offline_eval_batch_size_per_runner": 256, "dataset_num_iters_per_eval_runner": 1, "keep_per_episode_custom_metrics": false, "metrics_episode_collection_timeout_s": 60.0, "metrics_num_episodes_for_smoothing": 100, "min_time_s_per_iteration": null, "min_train_timesteps_per_iteration": 0, "min_sample_timesteps_per_iteration": 0, "log_gradients": true, "export_native_model_files": false, "checkpoint_trainable_policies_only": false, "logger_creator": null, "logger_config": null, "log_level": "WARN", "log_sys_usage": true, "fake_sampler": false, "seed": 7, "restart_failed_env_runners": true, "ignore_env_runner_failures": false, "max_num_env_runner_restarts": 1000, "delay_between_env_runner_restarts_s": 60.0, "restart_failed_sub_environments": false, "num_consecutive_env_runner_failures_tolerance": 100, "env_runner_health_probe_timeout_s": 30.0, "env_runner_restore_timeout_s": 1800.0, "_model_config": {}, "_rl_module_spec": "RLModuleSpec(module_class=None, observation_space=None, action_space=None, inference_only=False, learner_only=False, model_config=DefaultModelConfig(fcnet_hiddens=[60, 90], fcnet_activation='tanh', fcnet_kernel_initializer=None, fcnet_kernel_initializer_kwargs=None, fcnet_bias_initializer=None, fcnet_bias_initializer_kwargs=None, conv_filters=None, conv_activation='relu', conv_kernel_initializer=None, conv_kernel_initializer_kwargs=None, conv_bias_initializer=None, conv_bias_initializer_kwargs=None, head_fcnet_hiddens=[], head_fcnet_activation='relu', head_fcnet_kernel_initializer=None, head_fcnet_kernel_initializer_kwargs=None, head_fcnet_bias_initializer=None, head_fcnet_bias_initializer_kwargs=None, free_log_std=False, log_std_clip_param=20.0, vf_share_layers=True, use_lstm=False, max_seq_len=20, lstm_cell_size=256, lstm_use_prev_action=False, lstm_use_prev_reward=False, lstm_kernel_initializer=None, lstm_kernel_initializer_kwargs=None, lstm_bias_initializer=None, lstm_bias_initializer_kwargs=None), catalog_class=None, load_state_path=None, model_config_dict=None)", "algorithm_config_overrides_per_module": {}, "_per_module_overrides": {}, "_validate_config": true, "_use_msgpack_checkpoints": false, "_torch_grad_scaler_class": null, "_torch_lr_scheduler_classes": null, "_tf_policy_handles_more_than_one_loss": false, "_disable_preprocessor_api": false, "_disable_action_flattening": false, "_disable_initialize_loss_from_dummy_batch": false, "_dont_auto_sync_env_runner_states": false, "env_task_fn": -1, "enable_connectors": -1, "simple_optimizer": false, "policy_map_cache": -1, "worker_cls": -1, "synchronize_filters": -1, "enable_async_evaluation": -1, "custom_async_evaluation_function": -1, "_enable_rl_module_api": -1, "auto_wrap_old_gym_envs": -1, "always_attach_evaluation_results": -1, "replay_sequence_length": null, "_disable_execution_plan_api": -1, "use_critic": true, "use_gae": true, "use_kl_loss": true, "kl_coeff": 0.7464963036515, "kl_target": 0.0270990929592, "vf_loss_coeff": 0.6688075857018, "entropy_coeff": 0.0090570820258, "clip_param": 0.1221781641624, "vf_clip_param": 0.1027808522125, "entropy_coeff_schedule": null, "lr_schedule": null, "sgd_minibatch_size": -1, "vf_share_layers": -1, "__stdout_file__": null, "__stderr_file__": null, "lambda": 0.9099046732075, "input": "sampler", "policies": {"default_policy": [null, null, null, null]}, "callbacks": "<class 'ray.rllib.callbacks.callbacks.RLlibCallback'>", "create_env_on_driver": false, "custom_eval_function": null, "framework": "torch"}, "time_since_restore": 60.426671266555786, "iterations_since_restore": 20, "perf": {"cpu_util_percent": 76.74, "ram_util_percent": 79.34}}
